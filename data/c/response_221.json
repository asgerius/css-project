[{"tags": ["c++", "c", "ssl", "ssl-certificate", "mongoose-web-server"], "answers": [{"comments": [{"owner": {"reputation": 6899, "user_id": 1212012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gmBY7.png?s=128&g=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1212012/mathieu"}, "edited": false, "score": 0, "creation_date": 1574688371, "post_id": 59031166, "comment_id": 104309174, "body": "While this link may answer the question, it is better to include the essential parts of the answer here and provide the link for reference.  Link-only answers can become invalid if the linked page changes. - <a href=\"/review/low-quality-posts/24679387\">From Review</a>"}, {"owner": {"reputation": 168, "user_id": 3585651, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1ac692b98befc4a8231752bc9956c58d?s=128&d=identicon&r=PG&f=1", "display_name": "larslars", "link": "https://stackoverflow.com/users/3585651/larslars"}, "reply_to_user": {"reputation": 6899, "user_id": 1212012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gmBY7.png?s=128&g=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1212012/mathieu"}, "edited": false, "score": 0, "creation_date": 1578311564, "post_id": 59031166, "comment_id": 105386323, "body": "Thanks Mathieu, I see how my comment can be misunderstood. Tried to rectify now."}], "tags": [], "owner": {"reputation": 168, "user_id": 3585651, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1ac692b98befc4a8231752bc9956c58d?s=128&d=identicon&r=PG&f=1", "display_name": "larslars", "link": "https://stackoverflow.com/users/3585651/larslars"}, "is_accepted": false, "score": 0, "last_activity_date": 1578311538, "last_edit_date": 1578311538, "creation_date": 1574682538, "answer_id": 59031166, "question_id": 55505946, "link": "https://stackoverflow.com/questions/55505946/hello-world-example-for-a-mongoose-webserver-with-ssl-in-c/59031166#59031166", "title": "hello world example for a mongoose webserver with SSL in C", "body": "<p>Firstly, I believe you should not have to handle other events than MG_NEW_REQUEST in your event handler. </p>\n\n<p>I would also debug using openssl:</p>\n\n<pre><code>openssl s_client -connect &lt;hostname:port&gt;\n</code></pre>\n\n<p>to see that the SSL connection gets set up properly.</p>\n\n<p>In any case, Cesanta does provide a complete working example for you to use:</p>\n\n<p><a href=\"https://github.com/cesanta/mongoose/tree/master/examples/simplest_web_server_ssl\" rel=\"nofollow noreferrer\">https://github.com/cesanta/mongoose/tree/master/examples/simplest_web_server_ssl</a></p>\n"}], "owner": {"reputation": 1, "user_id": 11308495, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-dlf6NBq-N10/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-iDm1IfrEaLPds_basTLEurbzbZfg/mo/photo.jpg?sz=128", "display_name": "Shubham Singla", "link": "https://stackoverflow.com/users/11308495/shubham-singla"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 501, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1578311538, "creation_date": 1554335824, "question_id": 55505946, "link": "https://stackoverflow.com/questions/55505946/hello-world-example-for-a-mongoose-webserver-with-ssl-in-c", "title": "hello world example for a mongoose webserver with SSL in C", "body": "<p>I am trying to set a mongoose web server v3.3 with a self-signed SSL certificate. I know how to do it without SSL but I want to implement HTTPS.</p>\n\n<p>I have implemented something like this:</p>\n\n<pre><code>void *event_handler(enum mg_event event,\nstruct mg_connection *conn) {\n\nconst struct mg_request_info *request_info = mg_get_request_info(conn);\n\nstatic void* done = \"done\";\n\nif (event == MG_NEW_REQUEST) {\n    if (strcmp(request_info-&gt;uri, \"/hello\") == 0) {\n        // handle c[renderer] request\n        if(strcmp(request_info-&gt;request_method, \"GET\") != 0) {\n            // send error (we only care about HTTP GET)\n            mg_printf(conn, \"HTTP/1.1 %d Error (%s)\\r\\n\\r\\n%s\",\n                500,\n                \"we only care about HTTP GET\",\n                \"we only care about HTTP GET\");\n            // return not null means we handled the request\n            return done;\n        }\n\n        // handle your GET request to /hello\n        char* content = \"Hello World!\";\n        char* mimeType = \"text/plain\";\n        int contentLength = strlen(content);\n\n        mg_printf(conn,\n            \"HTTP/1.1 200 OK\\r\\n\"\n            \"Cache: no-cache\\r\\n\"\n            \"Content-Type: %s\\r\\n\"\n            \"Content-Length: %d\\r\\n\"\n            \"\\r\\n\",\n            mimeType,\n            contentLength);\n        mg_write(conn, content, contentLength);\n        return done;\n        }\n    }\n    // in this example i only handle /hello\n    mg_printf(conn, \"HTTP/1.1 %d Error (%s)\\r\\n\\r\\n%s\",\n        500, /* This the error code you want to send back*/\n        \"Invalid Request.\",\n        \"Invalid Request.\");\n    return done;\n}\n\n// No suitable handler found, mark as not processed. Mongoose will\n// try to serve the request.\nreturn NULL;\n}\n\nint main(int argc, char **argv) {\n\nconst char *options[] = {\n    \"ssl_certificate\", \"cert.pem\",\n    \"listening_ports\", \"443s\",\n    \"num_threads\", \"10\",\n    NULL\n};\n\nstatic struct mg_context *ctx;\n\nctx = mg_start(&amp;event_handler, options);\nif(ctx == NULL) {\n    exit(EXIT_FAILURE);\n}\n\nputs(\"Server running, press enter to exit\\n\");\ngetchar();\nmg_stop(ctx);\n\nreturn EXIT_SUCCESS;\n}\n</code></pre>\n\n<p>The problem is I am not able to access my server from the web browser. I think the problem is that the first event my callback receives is MG_INIT_SSL but I do not know how to handle or process it. Could anybody please help?</p>\n"}, {"tags": ["c", "assembly", "makefile", "cygwin", "nasm"], "comments": [{"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 1, "creation_date": 1554335803, "post_id": 55505916, "comment_id": 97717657, "body": "Did you try debugging it at all?"}, {"owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 3, "creation_date": 1554335926, "post_id": 55505916, "comment_id": 97717691, "body": "<code>int 80h</code> will not work under cygwin. It only emulates the posix functions via a library, not the syscall interface."}], "owner": {"reputation": 17456, "user_id": 159072, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/217605bccd955128d5ffc2c6e3d8267e?s=128&d=identicon&r=PG&f=1", "display_name": "user366312", "link": "https://stackoverflow.com/users/159072/user366312"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "closed_date": 1554356823, "answer_count": 0, "score": 0, "last_activity_date": 1554356865, "creation_date": 1554335540, "last_edit_date": 1554356865, "question_id": 55505916, "link": "https://stackoverflow.com/questions/55505916/using-linux-int-80h-system-calls-under-cygwin", "closed_reason": "Duplicate", "title": "Using Linux int 80h system calls under Cygwin?", "body": "<p>I am using <strong>Cygwin 32-bit</strong> under Win7 in a 64-bit machine.</p>\n\n<p>The following program </p>\n\n<h2>makefile</h2>\n\n<pre><code>runme:  main.cpp    asm.o\n    g++     main.cpp    asm.o   -o  executable\n\nasm.o:  asm.asm\n    nasm    -f   elf    asm.asm     -o  asm.o\n</code></pre>\n\n<h2>asm.asm</h2>\n\n<pre><code>    section .data\n    hello:     db 'Hello world!',10\n    helloLen:  equ $-hello\nsection .bss\nsection .text\n    global _GetValueFromASM, _HelloWorld\n\n_GetValueFromASM:\n    mov eax, 9\n    ret\n\n_HelloWorld:\n    mov eax,4            ; 'write' system call = 4\n    mov ebx,1            ; file descriptor 1 = STDOUT\n    mov ecx,hello        ; string to write\n    mov edx,helloLen     ; length of string to write\n    int 80h              ; call the kernel\n    ret\n</code></pre>\n\n<h2>main.cpp</h2>\n\n<pre><code>#include &lt;iostream&gt;\n\nusing namespace std;\n\nextern \"C\" int GetValueFromASM();\nextern \"C\" int HelloWorld();\n\nint main()\n{\n    HelloWorld();\n    cout&lt;&lt;\"GetValueFromASM() returned = \"&lt;&lt;GetValueFromASM()&lt;&lt;endl;\n\n    return 0;\n} \n</code></pre>\n\n<p>is giving me the following error:</p>\n\n<pre><code>me@my-PC ~/nasm/test of Intel syntax\n$ make\nnasm    -f      elf             asm.asm         -o      asm.o\ng++       main.cpp        asm.o   -o      executable\n\nme@my-PC ~/nasm/test of Intel syntax\n$ ./executable\nSegmentation fault (core dumped)\n</code></pre>\n\n<p>I am not understanding why this error is being generated. </p>\n\n<p>How can I get rid of this issue?</p>\n"}, {"tags": ["c", "ffmpeg", "h.264", "libavcodec"], "comments": [{"owner": {"reputation": 12687, "user_id": 2809095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/705cfb2d48f12159ebae7d0275355a3f?s=128&d=identicon&r=PG&f=1", "display_name": "Iwillnotexist Idonotexist", "link": "https://stackoverflow.com/users/2809095/iwillnotexist-idonotexist"}, "edited": false, "score": 2, "creation_date": 1554335657, "post_id": 55505899, "comment_id": 97717627, "body": "You\u2019re gonna have to read up on \u201cAVCC\u201d vs \u201cAnnex B\u201d."}, {"owner": {"reputation": 348, "user_id": 1593842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5fcd52fd9bf86b11c2df92f6ce3c011?s=128&d=identicon&r=PG", "display_name": "user1593842", "link": "https://stackoverflow.com/users/1593842/user1593842"}, "reply_to_user": {"reputation": 12687, "user_id": 2809095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/705cfb2d48f12159ebae7d0275355a3f?s=128&d=identicon&r=PG&f=1", "display_name": "Iwillnotexist Idonotexist", "link": "https://stackoverflow.com/users/2809095/iwillnotexist-idonotexist"}, "edited": false, "score": 0, "creation_date": 1554384427, "post_id": 55505899, "comment_id": 97738949, "body": "By that you mean that simply telling ffmpeg to read back the same packet it extracted from the original file won&#39;t work?"}, {"owner": {"reputation": 348, "user_id": 1593842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5fcd52fd9bf86b11c2df92f6ce3c011?s=128&d=identicon&r=PG", "display_name": "user1593842", "link": "https://stackoverflow.com/users/1593842/user1593842"}, "reply_to_user": {"reputation": 12687, "user_id": 2809095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/705cfb2d48f12159ebae7d0275355a3f?s=128&d=identicon&r=PG&f=1", "display_name": "Iwillnotexist Idonotexist", "link": "https://stackoverflow.com/users/2809095/iwillnotexist-idonotexist"}, "edited": false, "score": 0, "creation_date": 1554385512, "post_id": 55505899, "comment_id": 97739758, "body": "Following your advice I found <a href=\"https://stackoverflow.com/a/24890903/1593842\">stackoverflow.com/a/24890903/1593842</a>, which seems to be a very nice explanation and also tells me that the data ffmpeg gave me is on AVCC, but without the &quot;header&quot; or &quot;extra data&quot; or &quot;sequence reader&quot;. So I assume that, without it, ffmpeg does not know how to interpret the data stream. Am I close?"}, {"owner": {"reputation": 12687, "user_id": 2809095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/705cfb2d48f12159ebae7d0275355a3f?s=128&d=identicon&r=PG&f=1", "display_name": "Iwillnotexist Idonotexist", "link": "https://stackoverflow.com/users/2809095/iwillnotexist-idonotexist"}, "edited": false, "score": 0, "creation_date": 1554385689, "post_id": 55505899, "comment_id": 97739862, "body": "They are the two most common ways by which H.264 NALUs can be framed, and AVCC also places SPS/PPS NALUs \u201cout-of-line\u201d, in FFmpeg this is called \u201cextradata\u201d. You\u2019re broadly correct."}, {"owner": {"reputation": 348, "user_id": 1593842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5fcd52fd9bf86b11c2df92f6ce3c011?s=128&d=identicon&r=PG", "display_name": "user1593842", "link": "https://stackoverflow.com/users/1593842/user1593842"}, "reply_to_user": {"reputation": 12687, "user_id": 2809095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/705cfb2d48f12159ebae7d0275355a3f?s=128&d=identicon&r=PG&f=1", "display_name": "Iwillnotexist Idonotexist", "link": "https://stackoverflow.com/users/2809095/iwillnotexist-idonotexist"}, "edited": false, "score": 0, "creation_date": 1554391373, "post_id": 55505899, "comment_id": 97743851, "body": "care to post this as an answer so I can accept it? You pretty much gave me all the info I needed to go on."}], "answers": [{"comments": [{"owner": {"reputation": 348, "user_id": 1593842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5fcd52fd9bf86b11c2df92f6ce3c011?s=128&d=identicon&r=PG", "display_name": "user1593842", "link": "https://stackoverflow.com/users/1593842/user1593842"}, "edited": false, "score": 1, "creation_date": 1554464825, "post_id": 55521057, "comment_id": 97772465, "body": "Thank you. During my googling I became aware of that ffmpeg filter. Although that filter is not what I need (I&#39;m actually working with a truncated mp4 that lost the <b>moov</b> atom) , you basically taught me that, when the <b>SPS/PPS</b> data is stored somewhere else (i.e. <b>AVCC</b>) I am going to have to figure out a way to generate it and pass it to the codec. The code I was using had worked in the past, but only because I was lucky and was feeding it a stream where the configuration data came right before the video data NALU (i.e., <b>Annex B</b>)."}], "tags": [], "owner": {"reputation": 12687, "user_id": 2809095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/705cfb2d48f12159ebae7d0275355a3f?s=128&d=identicon&r=PG&f=1", "display_name": "Iwillnotexist Idonotexist", "link": "https://stackoverflow.com/users/2809095/iwillnotexist-idonotexist"}, "is_accepted": true, "score": 3, "last_activity_date": 1554420678, "last_edit_date": 1554420678, "creation_date": 1554395938, "answer_id": 55521057, "question_id": 55505899, "link": "https://stackoverflow.com/questions/55505899/decode-a-single-h264-packet-dumped-by-ffmpeg-from-a-mp4-file/55521057#55521057", "title": "Decode a single (H264) packet dumped by ffmpeg from a mp4 file", "body": "<h1>ITU-T Rec. H.264 &amp; Annex B</h1>\n\n<p>Recommendation H.264 is a video codec standard defined by the International Telecommunication Union, <strong>T</strong>elecommunications Standardization Sector (ITU-<strong>T</strong>). It is available <strong>free of charge</strong> and <a href=\"https://www.itu.int/itu-t/recommendations/rec.aspx?rec=13189\" rel=\"nofollow noreferrer\">can be downloaded from their website</a>.</p>\n\n<p>The standard defines a bytestream format, whose lowest level of abstraction is the NALU (Network Layer Abstraction Unit).</p>\n\n<p>32 types of NALUs can exist, although about 11 are reserved or unused. Some carry video slice data, some don\u2019t. <em>Two NALU types will be important later in this discussion: SPS (Sequence Parameter Set) and PPS (Picture Parameter Set). Both are required to decode a video slice, and provide important information about the stream, such as its size and interpretation of the raw data.</em></p>\n\n<p>H.264 leaves undefined how these NALUs are transported and framed. However, it does describe one possible scheme, in the Standard\u2019s own Annex B. This scheme, for want of a better name, is generally referred to as <strong>Annex B</strong>.</p>\n\n<p>The scheme consists in prefixing the NALUs with an easy-to-synchronize-to start code that cannot occur within a NALU: A 3- or 4-byte pattern <code>00 00 01</code> or <code>00 00 00 01</code>. The rest of the NALU then follows. This scheme is popular in hardware and/or streaming situations because it allows acquiring bit-lock and byte-alignment easily, sends the SPS/PPS \u201cin-band\u201d periodically and thus allows one to tune into the stream at a random point to begin decoding, and has the interesting property that between NALUs one can validly send an arbitrary number of 0 bits or bytes.</p>\n\n<h1>ISO/IEC 14496 MPEG-4 &amp; AVCC</h1>\n\n<p>MPEG-4 is a family in multiple \u201cparts\u201d of standards for Audio-Video coding and storage made by a joint group of the International Standards Organization (ISO) and International Electrotechnical Commission (IEC) called the Moving Pictures Expert Group (MPEG). A few parts only of the MPEG-4 family are relevant:</p>\n\n<ul>\n<li>MPEG-4 Part 10 / Advanced Video Coding (AVC), technically identical to ITU-T H.264. <strong>Free of charge</strong>.</li>\n<li>MPEG-4 Part 12, ISO Base Media File Format (BMFF), defines a generic binary container file format that can be specialized. <strong>Free of charge</strong>.</li>\n<li>MPEG-4 Part 14 (MP4), which specializes Part 12 for video in general and defines the <code>.mp4</code> file extension and format. This part is <strong>very</strong> expensive (<strong>88 Swiss francs</strong>) and not available to the public.</li>\n<li>MPEG-4 Part 15, which defines how NALU-structured video data such as Part 10/H.264 video is stored in the Part 12 ISO BMFF. This part is <strong>extremely</strong> expensive (<strong>198 Swiss francs</strong>), and not available to the public, but it, Part 14, 12 and 10 are the basis of the commonly-used <code>.mp4</code> container with H.264-coded video.</li>\n</ul>\n\n<h2>AVCC</h2>\n\n<p>Unfortunately, Part 15 is also the part that defines a new scheme for framing of NALUs. This scheme proposes to extract all SPS/PPS NALUs into an \u201cout-of-band\u201d structure called <strong>AVCC</strong>, and also strips and replaces the start code prefixes in front of NALUs by an (almost-always) 4-byte number representing the size, in bytes, of the following NALU.</p>\n\n<p>This scheme is popular for fast- and random-seeking through video data, and by gathering all video decoder configuration data (SPS/PPS) in one standardized place, one can configure the video decoder once at the beginning and thereafter not worry about unexpected surprises like a dynamic change in the size of the video frame (which Annex B allows).</p>\n\n<p>Fortunately, hints about AVCC\u2019s structure exist online, as does code to translate between AVCC and Annex B.</p>\n\n<h1>Your needs</h1>\n\n<p>You seem to need AVCC -> Annex B conversion. This can be done with FFmpeg\u2019s bitstream filter, <a href=\"https://ffmpeg.org/ffmpeg-bitstream-filters.html#h264_005fmp4toannexb\" rel=\"nofollow noreferrer\"><code>h264_mp4toannexb</code></a>:</p>\n\n<pre><code>ffmpeg -i INPUT.mp4 -codec copy -bsf:v h264_mp4toannexb OUTPUT.ts\n</code></pre>\n"}], "owner": {"reputation": 348, "user_id": 1593842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5fcd52fd9bf86b11c2df92f6ce3c011?s=128&d=identicon&r=PG", "display_name": "user1593842", "link": "https://stackoverflow.com/users/1593842/user1593842"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1787, "favorite_count": 4, "accepted_answer_id": 55521057, "answer_count": 1, "score": 1, "last_activity_date": 1554420678, "creation_date": 1554335442, "last_edit_date": 1554400148, "question_id": 55505899, "link": "https://stackoverflow.com/questions/55505899/decode-a-single-h264-packet-dumped-by-ffmpeg-from-a-mp4-file", "title": "Decode a single (H264) packet dumped by ffmpeg from a mp4 file", "body": "<p>I used ffmpeg to dump a packet representing a single frame from an h264 video inside a mp4</p>\n\n<p><code>ffmpeg -i video.mp4 -c copy -vframes 1 -map 0:v:0 -f data frame.bin</code></p>\n\n<p>The data inside <code>frame.bin</code> seems to be fine and seems to be composed of exactly the same bytes as the first chunk/packet (I'm not sure what is the correct term) from the <code>mdat</code> atom.</p>\n\n<p>Now I want to decode that frame. Since I know the codec that was used to create that packet (h264), I thought I could simply prepare a codec context, load all that data into a packet and the use traditional <code>avcodec_send_packet(codecContext, packet)</code> followed by <code>avcodec_receive_frame()</code> combo. </p>\n\n<p>Unfortunately the call to <code>avcodec_send_packet</code>fails and I receive the following error</p>\n\n<p><code>(-1094995529) Invalid data found when processing input</code></p>\n\n<p>Since the first 4 bytes of the packet data is the size of the packet itself, I tried skipping those bytes before passing the buffer to the packet, but that also failed.</p>\n\n<p>Am I skipping some step or doing something wrong? Is what I am trying to do even possible? (please say yes :)</p>\n"}, {"tags": ["c", "segmentation-fault", "user-input", "dynamic-memory-allocation"], "comments": [{"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1554334372, "post_id": 55505716, "comment_id": 97717337, "body": "<code>uniq stream = { malloc(DEFAULT_SIZE * sizeof(char)), 0 };</code>&lt;&lt; -- maybe you want <code>sizeof (char*)</code>? <code>if (i == sizeof(stream.linesArray))</code> &lt;&lt;-- This is the size of a pointer."}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1554334475, "post_id": 55505716, "comment_id": 97717360, "body": "<code>size_t * size = 0</code> <code>getdelim( ... size ...</code>) you pass a null pointer as the second argument. Do you understand how &quot;returning a value from a function through a pointer&quot; works? Probably it fails with <code>EINVAL</code>."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1554334680, "post_id": 55505716, "comment_id": 97717409, "body": "Read <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\"><i>How to debug small programs</i></a>"}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1554334813, "post_id": 55505716, "comment_id": 97717441, "body": "<a href=\"https://stackoverflow.com/a/25823469/841108\">stackoverflow.com/a/25823469/841108</a> is relevant"}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1554336202, "post_id": 55505716, "comment_id": 97717753, "body": "Remember that <code>-1</code> is true in C. Your loop should be along the lines of <code>while (getdelim(...) &gt; 1) {}</code> if you want it to end on an empty line, end of input, etc."}], "answers": [{"tags": [], "owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "is_accepted": false, "score": 0, "last_activity_date": 1554335926, "creation_date": 1554335926, "answer_id": 55505960, "question_id": 55505716, "link": "https://stackoverflow.com/questions/55505716/how-should-i-fix-this-interesting-getdelim-getline-dynamic-memory-allocation/55505960#55505960", "title": "How should I fix this interesting getdelim / getline (dynamic memory allocation) bug?", "body": "<p>Ok, so the intent is clear - use <code>getdelim</code> to store the lines inside an array. <code>getline</code> itself uses dynamic allocation. The <a href=\"http://man7.org/linux/man-pages/man3/getline.3.html\" rel=\"nofollow noreferrer\">manual</a> is quite clear about it:</p>\n\n<blockquote>\n  <p>getline() reads an entire line from stream, storing the address of the\n  buffer containing the text into *lineptr. The buffer is\n  null-terminated and includes the newline character, if one was found.</p>\n</blockquote>\n\n<p>The <code>getline()</code> \"stores the address of the buffer into *lineptr\". So <code>lineptr</code> has to be a valid pointer to a <code>char *</code> variable (read that twice). </p>\n\n<blockquote>\n  <p>*lineptr and *n will be updated\n  to reflect the buffer address and allocated size respectively.</p>\n</blockquote>\n\n<p>Also <code>n</code> needs to be a valid(!) pointer to a <code>size_t</code> variable, so the function can update it.</p>\n\n<p>Also note that the <code>lineptr</code> buffer:</p>\n\n<blockquote>\n  <p>This buffer should be freed by the user program even if getline() failed.</p>\n</blockquote>\n\n<p>So what do we do? We need to have an array of pointers to an array of strings. Because I don't like becoming a three star programmer, I use structs. I somewhat modified your code a bit, added some checks. You have the excuse me, I don't like typedefs, so I don't use them. Renamed the <code>uniq</code> to <code>struct lines_s</code>:</p>\n\n<pre><code>#define _GNU_SOURCE\n#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n\nstruct line_s {\n    char *line;\n    size_t len;\n};\n\nstruct lines_s {\n    struct line_s *lines;\n    size_t cnt;\n};\n\n\nint main() {\n    struct lines_s lines = { NULL, 0 };\n\n    // loop breaks on error of feof(stdin)\n    while (1) {\n\n        char *line = NULL;\n        size_t size = 0;\n        // we pass a pointer to a `char*` variable\n        // and a pointer to `size_t` variable\n        // `getdelim` will update the variables inside it\n        // the initial values are NULL and 0\n        ssize_t ret = getdelim(&amp;line, &amp;size, '\\n', stdin);\n        if (ret &lt; 0) {\n            // check for EOF\n            if (feof(stdin)) {\n                // EOF found - break\n                break;\n            }\n            fprintf(stderr, \"getdelim error %zd!\\n\", ret);\n            abort();\n        }\n\n        // new line was read - add it to out container \"lines\"\n        // always handle realloc separately\n        void *ptr = realloc(lines.lines, sizeof(*lines.lines) * (lines.cnt + 1));\n        if (ptr == NULL) {\n            // note that lines.lines is still a valid pointer here\n            fprintf(stderr, \"Out of memory\\n\");\n            abort();\n        }\n        lines.lines = ptr;\n        lines.lines[lines.cnt].line = line;\n        lines.lines[lines.cnt].len = size;\n        lines.cnt += 1;\n\n\n        // break if the line is \"stop\"\n        if (strcmp(\"stop\\n\", lines.lines[lines.cnt - 1].line) == 0) {\n            break;\n        }\n    }\n\n    // iterate over lines\n    for (size_t i = 0; i &lt; lines.cnt; ++i) {\n        // note that the line has a newline in it\n        // so no additional is needed in this printf\n        printf(\"line %zu is %s\", i, lines.lines[i].line);\n    }\n\n    // getdelim returns dynamically allocated strings\n    // we need to free them\n    for (size_t i = 0; i &lt; lines.cnt; ++i) {\n         free(lines.lines[i].line);\n    }\n    free(lines.lines);\n}\n</code></pre>\n\n<p>For such input:</p>\n\n<pre><code> line1 line1\n line2 line2\n stop\n</code></pre>\n\n<p>will output:</p>\n\n<pre><code> line 0 is line1 line1\n line 1 is line2 line2\n line 2 is stop \n</code></pre>\n\n<p>Tested on <a href=\"https://onlinegdb.com/H1InuTfKE\" rel=\"nofollow noreferrer\">onlinegdb</a>.</p>\n\n<p>Notes:</p>\n\n<ol>\n<li><p><code>if (i == sizeof(stream.linesArray))</code> <code>sizeof</code> does not magically store the size of an array. <code>sizeof(stream.linesArray)</code> is just <code>sizeof(char**)</code> is just a sizeof of a pointer. It's usually 4 or 8 bytes, depending if on the 32bit or 64bit architecture.</p></li>\n<li><p><code>uniq stream = { malloc(DEFAULT_SIZE * sizeof(char)),</code> - <code>stream.linesArray</code> is a <code>char**</code> variable. So if you want to have an array of pointers to <code>char</code>, you should allocate the memory for pointers <code>malloc(DEFAULT_SIZE * sizeof(char*))</code>.</p></li>\n<li><code>typedef unsigned long long int ull_int;</code> The <code>size_t</code> type if the type to represent array size or sizeof(variable). The <code>ssize_t</code> is sometimes used in posix api to return the size and an error status. Use those variables, no need to type <code>unsigned long long</code>.</li>\n<li><code>ull_int cap</code> <code>cap = getdelim</code> - cap is unsigned, it will never be <code>cap != 1</code>.</li>\n</ol>\n"}], "owner": {"reputation": 31, "user_id": 6058742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/493848fe64e371cce740b87e030b8cdb?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmet Emre Harsa", "link": "https://stackoverflow.com/users/6058742/ahmet-emre-harsa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 424, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1554335926, "creation_date": 1554334048, "question_id": 55505716, "link": "https://stackoverflow.com/questions/55505716/how-should-i-fix-this-interesting-getdelim-getline-dynamic-memory-allocation", "title": "How should I fix this interesting getdelim / getline (dynamic memory allocation) bug?", "body": "<p>I have this C assignment I am a bit struggling at this specific point. I have some background in C, but pointers and dynamic memory management still elude me very much.</p>\n\n<p>The assignment asks us to write a program which would simulate the behaviour of the \"uniq\" command / filter in UNIX. </p>\n\n<p>But the problem I am having is with the C library functions getline or getdelim (we need to use those functions according to the implementation specifications). </p>\n\n<p>According to the specification, the user input might contain arbitrary amount of lines and each line might be of arbitrary length (unknown at compile-time).</p>\n\n<p>The problem is, the following line for the while-loop\n    while (cap = getdelim(stream.linesArray, size, '\\n', stdin))</p>\n\n<p>compiles and \"works\" somehow when I leave it like that. What I mean by this is that, when I execute the program, I enter arbitrary amount of lines of arbitrary length per each line and the program does not crash - but it keeps looping unless I stop the program execution (whether the lines are correctly stored in \" char **linesArray; \" are a different story I am not sure about.</p>\n\n<p>I would like to be able to do is something like\n    while ((cap = getdelim(stream.linesArray, size, '\\n', stdin)) &amp;&amp; (cap != -1))</p>\n\n<p>so that when getdelim does not read any characters at some line (besides EOF or \\n) - aka the very first time when user enters an empty line -, the program would stop taking more lines from stdin.\n(and then print the lines that were stored in stream.linesArray by getdelim).</p>\n\n<p>The problem is, when I execute the program if I make the change I mentioned above, the program gives me \"Segmentation Fault\" and frankly I don't know why and how should I fix this (I have tried to do something about it so many times to no avail).</p>\n\n<p>For reference:</p>\n\n<p><a href=\"https://pubs.opengroup.org/onlinepubs/9699919799/functions/getdelim.html\" rel=\"nofollow noreferrer\">https://pubs.opengroup.org/onlinepubs/9699919799/functions/getdelim.html</a></p>\n\n<p><a href=\"https://en.cppreference.com/w/c/experimental/dynamic/getline\" rel=\"nofollow noreferrer\">https://en.cppreference.com/w/c/experimental/dynamic/getline</a></p>\n\n<p><a href=\"http://man7.org/linux/man-pages/man3/getline.3.html\" rel=\"nofollow noreferrer\">http://man7.org/linux/man-pages/man3/getline.3.html</a></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\n#define DEFAULT_SIZE 20\n\ntypedef unsigned long long int ull_int;\n\ntypedef struct uniqStream\n{\n    char **linesArray;\n    ull_int lineIndex;\n\n}   uniq;\n\nint main()\n{\n    uniq stream = { malloc(DEFAULT_SIZE * sizeof(char)), 0 };\n\n    ull_int cap, i = 0;  \n    size_t *size = 0;\n\n    while ((cap = getdelim(stream.linesArray, size, '\\n', stdin))) //&amp;&amp; (cap != -1))\n    {\n        stream.lineIndex = i;\n\n        //if (cap == -1) { break; }\n        //print(\"%s\", stream.linesArray[i]);    \n\n        ++i;\n        if (i == sizeof(stream.linesArray))\n        {\n            stream.linesArray = realloc(stream.linesArray, (2 * sizeof(stream.linesArray)));\n        }\n    }\n\n    ull_int j;\n    for (j = 0; j &lt; i; ++j)\n    {\n        printf(\"%s\\n\", stream.linesArray[j]);    \n    }\n\n    free(stream.linesArray);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "sorting", "mergesort"], "comments": [{"owner": {"reputation": 3298, "user_id": 8928024, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/75f4b1f5d87975964979ce2718af1ae9?s=128&d=identicon&r=PG&f=1", "display_name": "ZF007", "link": "https://stackoverflow.com/users/8928024/zf007"}, "edited": false, "score": 0, "creation_date": 1554332333, "post_id": 55505258, "comment_id": 97716887, "body": "fix your image view by using !, brackets [image name] and quotation (url\\image.png) marks."}, {"owner": {"reputation": 22874, "user_id": 3282056, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/IXonK.jpg?s=128&g=1", "display_name": "rcgldr", "link": "https://stackoverflow.com/users/3282056/rcgldr"}, "edited": false, "score": 0, "creation_date": 1554335659, "post_id": 55505258, "comment_id": 97717629, "body": "Please include all of the code from the image in your question. Without the context of the rest of the code, the question may not be clear to others reading this. Also at the end of the code, add a line showing how mergesort is called, such as mergesort(A, 0, size-1)."}, {"owner": {"reputation": 22874, "user_id": 3282056, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/IXonK.jpg?s=128&g=1", "display_name": "rcgldr", "link": "https://stackoverflow.com/users/3282056/rcgldr"}, "edited": false, "score": 1, "creation_date": 1554335936, "post_id": 55505258, "comment_id": 97717694, "body": "I edited the tags to include sorting and to remove &quot;boundary&quot; which is normally used with a different meaning here at Stack Overflow."}, {"owner": {"reputation": 15, "user_id": 11299806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fac66c15ed0b2ed6ed38d136f3892782?s=128&d=identicon&r=PG&f=1", "display_name": "meow", "link": "https://stackoverflow.com/users/11299806/meow"}, "edited": false, "score": 0, "creation_date": 1555141683, "post_id": 55505258, "comment_id": 98013878, "body": "okay okay thanks, I will once I have 15 reputations^^"}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 11299806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fac66c15ed0b2ed6ed38d136f3892782?s=128&d=identicon&r=PG&f=1", "display_name": "meow", "link": "https://stackoverflow.com/users/11299806/meow"}, "edited": false, "score": 0, "creation_date": 1554533711, "post_id": 55505704, "comment_id": 97795507, "body": "Thank you^^&#39;adding 1 to the maximum value will wrap around to the smallest value.&#39; you mean this line right? tmpL = (int*)malloc(sizeof(int)*(n1+1));"}, {"owner": {"reputation": 15, "user_id": 11299806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fac66c15ed0b2ed6ed38d136f3892782?s=128&d=identicon&r=PG&f=1", "display_name": "meow", "link": "https://stackoverflow.com/users/11299806/meow"}, "edited": false, "score": 0, "creation_date": 1554533942, "post_id": 55505704, "comment_id": 97795554, "body": "can I just use two while loops like if left array (sorted) elements all bigger than my right array(sorted) so I &#39;append &#39; all of them in the end of  newly merged array ? like python code? I learned datastructure in python, switched to C code I feel very confusing and hard to adapt.."}, {"owner": {"reputation": 22874, "user_id": 3282056, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/IXonK.jpg?s=128&g=1", "display_name": "rcgldr", "link": "https://stackoverflow.com/users/3282056/rcgldr"}, "reply_to_user": {"reputation": 15, "user_id": 11299806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fac66c15ed0b2ed6ed38d136f3892782?s=128&d=identicon&r=PG&f=1", "display_name": "meow", "link": "https://stackoverflow.com/users/11299806/meow"}, "edited": false, "score": 0, "creation_date": 1554539059, "post_id": 55505704, "comment_id": 97796494, "body": "@meow - &quot;append at end of newly merged array?&quot; - yes, this is how merge is normally implemented. When the end of either left or right is reached, then the remainder of right or left is appended to the already merged data. Although in java, this <a href=\"https://stackoverflow.com/questions/48822461/why-is-recursive-merge-sort-function-displaying-on2-time-complexity/48841850#48841850\">optimized top down merge sort</a> has a typical merge function. The alternating top down ...atob and btoa functions are used to avoid having to copy data by changing the direction merge for each level of recursion."}, {"owner": {"reputation": 22874, "user_id": 3282056, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/IXonK.jpg?s=128&g=1", "display_name": "rcgldr", "link": "https://stackoverflow.com/users/3282056/rcgldr"}, "reply_to_user": {"reputation": 15, "user_id": 11299806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fac66c15ed0b2ed6ed38d136f3892782?s=128&d=identicon&r=PG&f=1", "display_name": "meow", "link": "https://stackoverflow.com/users/11299806/meow"}, "edited": false, "score": 0, "creation_date": 1554539210, "post_id": 55505704, "comment_id": 97796530, "body": "@meow - in my last comment, I included a link to a typical merge function that works as you asked. However, the question you posted is about a different implementation that relies on using a value greater than any value in A[] as a &quot;sentinel&quot; to avoid having to check to see if the end of left or right was reached, which won&#39;t work if one or more values in A[] are the maximum possible value. It&#39;s not a method that is normally used."}, {"owner": {"reputation": 15, "user_id": 11299806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fac66c15ed0b2ed6ed38d136f3892782?s=128&d=identicon&r=PG&f=1", "display_name": "meow", "link": "https://stackoverflow.com/users/11299806/meow"}, "edited": false, "score": 0, "creation_date": 1554815376, "post_id": 55505704, "comment_id": 97883849, "body": "Thank you very much!! I  read all of them, very helpful, thank you!"}, {"owner": {"reputation": 15, "user_id": 11299806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fac66c15ed0b2ed6ed38d136f3892782?s=128&d=identicon&r=PG&f=1", "display_name": "meow", "link": "https://stackoverflow.com/users/11299806/meow"}, "edited": false, "score": 0, "creation_date": 1554819946, "post_id": 55505704, "comment_id": 97886832, "body": "I read other implementations online, it is fine just not to use a pointer like a python code.  <a href=\"https://www.geeksforgeeks.org/merge-sort/\" rel=\"nofollow noreferrer\">geeksforgeeks.org/merge-sort</a>.  much better than the text code"}, {"owner": {"reputation": 22874, "user_id": 3282056, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/IXonK.jpg?s=128&g=1", "display_name": "rcgldr", "link": "https://stackoverflow.com/users/3282056/rcgldr"}, "reply_to_user": {"reputation": 15, "user_id": 11299806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fac66c15ed0b2ed6ed38d136f3892782?s=128&d=identicon&r=PG&f=1", "display_name": "meow", "link": "https://stackoverflow.com/users/11299806/meow"}, "edited": false, "score": 0, "creation_date": 1554821248, "post_id": 55505704, "comment_id": 97887622, "body": "@meow -  I found an example of <a href=\"https://stackoverflow.com/questions/41665863/mergesort-implementation-is-slow/41668335#41668335\">optimized top down merge sort in C</a> . After the quicksort in this old answer, here is <a href=\"https://stackoverflow.com/questions/34844613/optimized-merge-sort-faster-than-quicksort/34845789#34845789\">optimized bottom up merge sort and 4 way merge sort</a> . In these examples, b[] is a temp working array passed by the caller. The data to be sorted is in a[]."}], "tags": [], "owner": {"reputation": 22874, "user_id": 3282056, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/IXonK.jpg?s=128&g=1", "display_name": "rcgldr", "link": "https://stackoverflow.com/users/3282056/rcgldr"}, "is_accepted": false, "score": 0, "last_activity_date": 1554338750, "last_edit_date": 1554338750, "creation_date": 1554333933, "answer_id": 55505704, "question_id": 55505258, "link": "https://stackoverflow.com/questions/55505258/crls-merge-sort-boundary-code-understanding-in-c-code/55505704#55505704", "title": "CRLS merge sort boundary code understanding in C code", "body": "<p>merge() is supposed to merge two already sorted runs in A, from A[p] to A[q], and from A[q+1] to A[r] (inclusive). TmpL and TmpR are created, each with space for 1 extra element at the end to be used as a sentinel value that is greater than any value in either TmpL or TmpR. The ternary statement sets boundary to the greater of the last values in TmpL and TmpR, then adds 1 to this value to create a sentinel value that is stored at the end of TmpL and TmpR. This eliminates the need to check the indexes \"i\" or \"j\" to see if the end of TmpL or TmpR has been reached, in which case the rest of TmpR or TmpL would be copied back to A[].</p>\n\n<p>For most programming languages, instead of using the ternary statement, the code could have just set boundary to INT_MAX or one of the other max values from the include file limits.h (or for C++, climits):</p>\n\n<p><a href=\"http://www.cplusplus.com/reference/climits\" rel=\"nofollow noreferrer\">http://www.cplusplus.com/reference/climits</a></p>\n\n<p>If sorting floats or doubles, boundary can be set to infinity.</p>\n\n<p>The reason for the segmentation fault is that without the sentinel value, the code may run beyond the end of either TmpL or TmpR causing the fault.</p>\n\n<p>A problem with this method for sorting is that A[] may already contain the maximum possible value, in which case this approach will fail. In the case of integers, adding 1 to the maximum value will wrap around to the smallest value. </p>\n"}, {"tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": true, "score": 0, "last_activity_date": 1554543064, "last_edit_date": 1554543064, "creation_date": 1554542023, "answer_id": 55547575, "question_id": 55505258, "link": "https://stackoverflow.com/questions/55505258/crls-merge-sort-boundary-code-understanding-in-c-code/55547575#55547575", "title": "CRLS merge sort boundary code understanding in C code", "body": "<p>The code uses a common approach for <code>mergesort</code> where copies are made of both subarrays with an extra element at the end, set to a value greater than the maximum value of both arrays.</p>\n\n<p>The statement <code>boundary = tmpL[n1 - 1] &gt; tmpR[n2 - 1] ? tmpL[n1 - 1] + 1 : tmpR[n2 - 1] + 1;</code> attempts to compute the value <code>boundary</code> as 1 plus the maximum value of <code>tmpL</code> or <code>tmpR</code> depending on which is greater. It uses a ternary expression which is roughly equivalent to writing:</p>\n\n<pre><code>    if (tmpL[n1 - 1] &gt; tmpR[n2 - 1])\n        boundary = tmpL[n1 - 1] + 1;\n    else\n        boundary = tmpR[n2 - 1] + 1;\n</code></pre>\n\n<p>The merging loop can then use a single test <code>k &lt;= r</code> to stop the loop and <code>i</code> will equal <code>n1</code> and <code>j</code> will equal <code>n2</code> when <code>k</code> reaches <code>r + 1</code>.</p>\n\n<p>This approach is broken in many respects:</p>\n\n<ul>\n<li>if either subarray contains the maximum value <code>INT_MAX</code>, the computation of <code>boundary</code> will overflow and cause undefined behavior. Even if the overflow does not cause a fatal side-effect, the value of <code>boundary</code> will be meaningless, causing incorrect results or other undefined behavior.</li>\n<li>testing for array boundaries is simple, much simpler than this incomplete work-around.</li>\n<li>this method requires both arrays to be allocated and copied, whereas the right half would not require saving because <code>merge</code> would not overwrite values that have not already been copied.</li>\n</ul>\n\n<p>In my opinion, this method should not be taught at all.</p>\n\n<p>Here is an alternative implementation without these shortcomings:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>void merge(int A[], int p, int q, int r) {\n    int *tmpL;\n    int n1, n2;\n    int i, j, k;\n\n    // It is much simpler to consider q to point to the first element of\n    // the second subarray and r to point after the last element of that array.\n    q++;\n    r++;\n\n    n1 = q - p;  // number of elements in the left sorted subarray\n    n2 = r - q;  // number of elements in the right sorted subarray\n\n    tmpL = (int *)malloc(sizeof(int) * n1);\n    if (tmpL == NULL) {\n        // Report this fatal error or fall back to a different \n        // algorithm that does not require allocation, such as\n        // heapsort or insertion sort.\n        return;\n    }\n    // Make a copy of the left subarray as elements may be overwritten in the loop.\n    for (i = 0; i &lt; n1; i++) {\n        tmpL[i] = A[p + i];\n    }\n\n    // Merge the elements of the subarrays:\n    // - if all elements of the left array have been merged, \n    //   the remaining elements of the right subarray are already in place\n    // - if k has reached r, all elements have been sorted\n    for (i = j = 0, k = p; i &lt; n1 &amp;&amp; k &lt; r; k++) {\n        if (j &gt;= n2 || tmpL[i] &lt;= A[q + j]) {\n            // Take the element from tmpL if the right subarray is empty\n            //    or if it is no greater than the next one from the right subarray.\n            A[k] = tmpL[i];\n            i++;\n        } else {\n            // Otherwise take the element from the right subarray.\n            A[k] = a[q + j];\n            j++;\n        }\n    }\n    free(tmpL);\n}\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 11299806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fac66c15ed0b2ed6ed38d136f3892782?s=128&d=identicon&r=PG&f=1", "display_name": "meow", "link": "https://stackoverflow.com/users/11299806/meow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 1, "accepted_answer_id": 55547575, "answer_count": 2, "score": 1, "last_activity_date": 1554817135, "creation_date": 1554330581, "last_edit_date": 1554817135, "question_id": 55505258, "link": "https://stackoverflow.com/questions/55505258/crls-merge-sort-boundary-code-understanding-in-c-code", "title": "CRLS merge sort boundary code understanding in C code", "body": "<pre class=\"lang-c prettyprint-override\"><code>void merge(int A[], int p, int q, int r) {\n    int *tmpL, *tmpR;\n    int boundary;\n    int n1, n2;\n    int i, j, k;\n\n    n1 = q - p + 1;\n    n2 = r - q;\n\n    tmpL = (int *)malloc(sizeof(int) * (n1 + 1));\n    tmpR = (int *)malloc(sizeof(int) * (n2 + 1));\n\n    for (i = 0; i &lt; n1; i++)\n        tmpL[i] = A[p + i];\n    for (j = 0; j &lt; n2; j++)\n        tmpR[j] = A[q + j + 1];\n\n    boundary = tmpL[n1 - 1] &gt; tmpR[n2 - 1] ? tmpL[n1 - 1] + 1 : tmpR[n2 - 1] + 1;\n    tmpL[n1] = boundary;\n    tmpR[n2] = boundary;\n\n    i = 0;\n    j = 0;\n\n    for (k = p; k &lt;= r; k++) {\n        if (tmpL[i] &lt;= tmpR[j]) {\n            A[k] = tmpL[i];\n            i++;\n        } else {\n            A[k] = tmpR[j];\n            j++;\n        }\n    }\n\n    free(tmpL);\n    free(tmpR);\n}\nvoid merge_sort(int A[], int p, int r) {\n    int q;\n\n    if (p &lt; r) {\n        q = (p + r) / 2;\n        merge_sort(A, p, q);\n        merge_sort(A, q + 1, r);\n        merge(A, p, q, r);\n    }\n}\n</code></pre>\n\n<p>I could not understand this infinite boundary code exactly <code>boundary = tmpL[n1 - 1] &gt; tmpR[n2 - 1] ? tmpL[n1 - 1] + 1 : tmpR[n2 - 1] + 1;</code></p>\n\n<p>Thanks\n<a href=\"https://i.stack.imgur.com/UmyUg.png\" rel=\"nofollow noreferrer\">https://i.stack.imgur.com/UmyUg.png</a>     (circled in blue)</p>\n\n<p>This is a conditional statement, <code>A&gt; B? C:D</code>. \nIf <code>A&gt; B</code> is true then evaluate C, else evaluate D.\nBut I still do not understand the boundary part. \nIs this the same as adding two while loops to deal with when one half of them have remaining elements and append them to the end of new arrays?</p>\n\n<p>If I don't initialize them as infinite boundary they may give me a segmentation fault.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 804, "user_id": 5893772, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/EATNh.png?s=128&g=1", "display_name": "Reticulated Spline", "link": "https://stackoverflow.com/users/5893772/reticulated-spline"}, "edited": false, "score": 2, "creation_date": 1554327731, "post_id": 55504647, "comment_id": 97715439, "body": "Is this the full code? Where are variables <code>stop</code> and <code>r</code> declared?"}, {"owner": {"reputation": 57967, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "edited": false, "score": 2, "creation_date": 1554327937, "post_id": 55504647, "comment_id": 97715515, "body": "while it might be ok to use this kind of program to get a glimpse at what&#39;s happening under the hood, please be aware that this program exhibits Undefined Behavior."}, {"owner": {"reputation": 83, "user_id": 8245121, "user_type": "registered", "profile_image": "https://graph.facebook.com/1521841947854530/picture?type=large", "display_name": "William &#197;kerman", "link": "https://stackoverflow.com/users/8245121/william-%c3%85kerman"}, "reply_to_user": {"reputation": 57967, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "edited": false, "score": 0, "creation_date": 1554328022, "post_id": 55504647, "comment_id": 97715538, "body": "@bolov What kind of Undefined Behavior?"}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 3, "creation_date": 1554328321, "post_id": 55504647, "comment_id": 97715648, "body": "You&#39;re dereferencing pointers out of the scope of the object they point to and also doing pointer arithmetic that goes beyond one past the last element in the array being pointed to.  Each of these result in undefined behavior."}, {"owner": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 0, "creation_date": 1554330602, "post_id": 55504647, "comment_id": 97716374, "body": "what do you think would happen if <code>p</code> were optimized into a register?"}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "reply_to_user": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1554336221, "post_id": 55504647, "comment_id": 97717756, "body": "@ChristianGibbons This project is <i>obviously</i> an attempt to investigate platform specific behaviour. Of course it&#39;s not defined by the C language, that&#39;s the point. Your comment should be more like bolov&#39;s."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "reply_to_user": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 0, "creation_date": 1554336232, "post_id": 55504647, "comment_id": 97717760, "body": "@bruceg well it can&#39;t be because its address is taken."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 1, "creation_date": 1554336335, "post_id": 55504647, "comment_id": 97717785, "body": "You could look at the assembly code to see exactly what&#39;s going on. I suspect 0x7fffffffdd70 is the variable <code>i</code> and 0x1ac4447e35ba0000 is a <a href=\"https://en.wikipedia.org/wiki/Stack_buffer_overflow#Stack_canaries\" rel=\"nofollow noreferrer\">stack canary</a>."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "reply_to_user": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 1, "creation_date": 1554389851, "post_id": 55504647, "comment_id": 97742805, "body": "@immibis The OP asked about what undefined behavior bolov was referring to, so I gave a couple examples."}], "owner": {"reputation": 83, "user_id": 8245121, "user_type": "registered", "profile_image": "https://graph.facebook.com/1521841947854530/picture?type=large", "display_name": "William &#197;kerman", "link": "https://stackoverflow.com/users/8245121/william-%c3%85kerman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 71, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1554328384, "creation_date": 1554327280, "last_edit_date": 1554328384, "question_id": 55504647, "link": "https://stackoverflow.com/questions/55504647/meaning-of-call-stack-in-simple-program", "title": "Meaning of call stack in simple program", "body": "<p>I've read about the call stack, so as a test I tried to run a program that prints the call stack of the current program. But I can't understand some values. Below you can see my small test program.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nvoid foo(unsigned long *last_out_of_stack){\n    unsigned long first_out_of_stack = 0x3;\n    unsigned long *i;\n    int j = 1;\n    printf(\"Line: Address          Value \\n\");\n    for(i = &amp;first_out_of_stack; i &lt;= last_out_of_stack; i++){\n        printf(\"%d:    %p   0x%lx\\n\", j, i, *i);\n        j++;\n    }\n}\n\nint main(){\n    unsigned long p = 0x1;\n    foo(&amp;p);\n    back:\n    printf(\"\\n  p:    %p \\n\", &amp;p);\n    printf(\"  back: %p \\n\", &amp;&amp;back);\n    return 0;\n}\n</code></pre>\n\n<p>When executing it prints this:</p>\n\n<pre><code>Line: Address          Value \n1:    0x7fffffffdd68   0x3\n2:    0x7fffffffdd70   0x7fffffffdd70\n3:    0x7fffffffdd78   0x1ac4447e35ba0000\n4:    0x7fffffffdd80   0x7fffffffdda0\n5:    0x7fffffffdd88   0x5555555547b0\n6:    0x7fffffffdd90   0x1\n\n  p:    0x7fffffffdd90 \n  back: 0x5555555547b0\n</code></pre>\n\n<p>Line really means in which order it stored in the stack. <br>\nLine 1 are the <code>first_out_of_stack</code> variable's data, the 4th line is from my understanding the Previous stack base pointer (EBP), line 5 is the return address from foo and line 6 is from my understanding the data from the variable <code>p</code>.</p>\n\n<p>Are my assumptions correct and what does line 2 and 3 mean?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 5338, "user_id": 4594973, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/USV9e.jpg?s=128&g=1", "display_name": "code_dredd", "link": "https://stackoverflow.com/users/4594973/code-dredd"}, "edited": false, "score": 2, "creation_date": 1554326839, "post_id": 55504517, "comment_id": 97715121, "body": "Did you look at this (i.e. <code>__FILE__</code> macro) before posting? <a href=\"https://stackoverflow.com/questions/8487986/file-macro-shows-full-path\" title=\"file macro shows full path\">stackoverflow.com/questions/8487986/file-macro-shows-full-pa&zwnj;&#8203;th</a>"}, {"owner": {"reputation": 15, "user_id": 9559846, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c778fd67bca5d41bee77a404e77dac44?s=128&d=identicon&r=PG&f=1", "display_name": "Gillen Brown", "link": "https://stackoverflow.com/users/9559846/gillen-brown"}, "reply_to_user": {"reputation": 5338, "user_id": 4594973, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/USV9e.jpg?s=128&g=1", "display_name": "code_dredd", "link": "https://stackoverflow.com/users/4594973/code-dredd"}, "edited": false, "score": 0, "creation_date": 1554327128, "post_id": 55504517, "comment_id": 97715223, "body": "Yes I did, although not that specific question. I have the opposite problem as that question when using <code>__FILE__</code>, as it only gives me the filename and not the full path."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 3, "creation_date": 1554327295, "post_id": 55504517, "comment_id": 97715283, "body": "As soon as anyone else has to use your program, that\u2019s no longer appropriate.  Locating config files or configuration information is a black art. Unix classically used an environment variable; Windows classically used the registry. Both have positive points and negative ones. But requiring users to have the source on their machine is usually not considered a good idea."}, {"owner": {"reputation": 15, "user_id": 9559846, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c778fd67bca5d41bee77a404e77dac44?s=128&d=identicon&r=PG&f=1", "display_name": "Gillen Brown", "link": "https://stackoverflow.com/users/9559846/gillen-brown"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1554327770, "post_id": 55504517, "comment_id": 97715447, "body": "@JonathanLeffler The code in my case is a scientific simulation code I&#39;ve inherited. Only a handful of folks use it, and they will most likely be modifying it themselves. While it may not be best practice it works well for our purposes."}, {"owner": {"reputation": 5338, "user_id": 4594973, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/USV9e.jpg?s=128&g=1", "display_name": "code_dredd", "link": "https://stackoverflow.com/users/4594973/code-dredd"}, "edited": false, "score": 0, "creation_date": 1554328099, "post_id": 55504517, "comment_id": 97715568, "body": "@GillenBrown You may be better off creating a pre-determined location where config files and other program resources can be found, independent of the program&#39;s installation location. In GNU+Linux, it could be <code>&#47;etc&#47;&lt;your-program&gt;&#47;[...]</code>. In Windows, it could be the location stored in the <code>%APPDATA%</code> env variable. Have you considered this? If so, why not go down this road instead?"}, {"owner": {"reputation": 15, "user_id": 9559846, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c778fd67bca5d41bee77a404e77dac44?s=128&d=identicon&r=PG&f=1", "display_name": "Gillen Brown", "link": "https://stackoverflow.com/users/9559846/gillen-brown"}, "reply_to_user": {"reputation": 5338, "user_id": 4594973, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/USV9e.jpg?s=128&g=1", "display_name": "code_dredd", "link": "https://stackoverflow.com/users/4594973/code-dredd"}, "edited": false, "score": 0, "creation_date": 1554328640, "post_id": 55504517, "comment_id": 97715761, "body": "@code_dredd  The reason we have it set up this way is that having multiple configuration setups is essential to how we use the code. It&#39;s compiled and run multiple times with various sets of configuration files, which set various parameters used in the simulation. Having the configuration files in the same directory as the outputs is helpful for understanding how the outputs change with the parameters."}, {"owner": {"reputation": 5338, "user_id": 4594973, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/USV9e.jpg?s=128&g=1", "display_name": "code_dredd", "link": "https://stackoverflow.com/users/4594973/code-dredd"}, "edited": false, "score": 1, "creation_date": 1554329499, "post_id": 55504517, "comment_id": 97716038, "body": "@GillenBrown There&#39;s nothing wrong with having multiple config files in the same <code>&#47;etc&#47;[...]</code> location. You could have the program use a default config when nothing else is specified or a config file passed in as an argument (e.g. <code>.&#47;your-program --config &lt;path-to-your-personal-config&gt;</code>). Also, did you try the <a href=\"https://stackoverflow.com/questions/229012/getting-absolute-path-of-a-file\"><code>GetFullPathName</code> function in Window or the <code>realpath</code> function in GNU+Linux</a>?"}, {"owner": {"reputation": 5338, "user_id": 4594973, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/USV9e.jpg?s=128&g=1", "display_name": "code_dredd", "link": "https://stackoverflow.com/users/4594973/code-dredd"}, "edited": false, "score": 0, "creation_date": 1554329548, "post_id": 55504517, "comment_id": 97716055, "body": "BTW, it&#39;d be helpful if you specify the platform and compiler you&#39;re using (i.e. versions, etc)."}, {"owner": {"reputation": 5338, "user_id": 4594973, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/USV9e.jpg?s=128&g=1", "display_name": "code_dredd", "link": "https://stackoverflow.com/users/4594973/code-dredd"}, "edited": false, "score": 1, "creation_date": 1554329663, "post_id": 55504517, "comment_id": 97716094, "body": "Also, <b><i>if you&#39;re completely sure</i></b> about the program <b><i>always</i></b> being placed in the same directory <b><i>for everyone</i></b>, then you can set the absolute path shown by the <code>__FILE__</code> macro if you send the full path when compiling; e.g. <code>gcc $(pwd)&#47;your-file.c</code>, when it prints <code>__FILE__</code> will show the full path it had <b><i>at compile time</i></b>, not run-time. Did you consider this? (Can&#39;t add enough disclaimers here, though.)"}, {"owner": {"reputation": 15, "user_id": 9559846, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c778fd67bca5d41bee77a404e77dac44?s=128&d=identicon&r=PG&f=1", "display_name": "Gillen Brown", "link": "https://stackoverflow.com/users/9559846/gillen-brown"}, "reply_to_user": {"reputation": 5338, "user_id": 4594973, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/USV9e.jpg?s=128&g=1", "display_name": "code_dredd", "link": "https://stackoverflow.com/users/4594973/code-dredd"}, "edited": false, "score": 0, "creation_date": 1554486518, "post_id": 55504517, "comment_id": 97785037, "body": "@code_dredd Ah, thanks for the tip to add send the full path when compiling. I think that solution actually will work. As long as the user doesn&#39;t move the source code after compiling it should work, no? It seems to work in my testing."}, {"owner": {"reputation": 5338, "user_id": 4594973, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/USV9e.jpg?s=128&g=1", "display_name": "code_dredd", "link": "https://stackoverflow.com/users/4594973/code-dredd"}, "edited": false, "score": 0, "creation_date": 1554487967, "post_id": 55504517, "comment_id": 97785668, "body": "@GillenBrown I&#39;ve added a more elaborate version of my previous comments as an answer. Please take a look at it and let me know if it was useful or if something&#39;s not entirely clear and can be improved."}, {"owner": {"reputation": 15, "user_id": 9559846, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c778fd67bca5d41bee77a404e77dac44?s=128&d=identicon&r=PG&f=1", "display_name": "Gillen Brown", "link": "https://stackoverflow.com/users/9559846/gillen-brown"}, "reply_to_user": {"reputation": 5338, "user_id": 4594973, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/USV9e.jpg?s=128&g=1", "display_name": "code_dredd", "link": "https://stackoverflow.com/users/4594973/code-dredd"}, "edited": false, "score": 1, "creation_date": 1554490445, "post_id": 55504517, "comment_id": 97786708, "body": "@code_dredd Yes, that is very helpful. Thanks so much!"}], "answers": [{"tags": [], "owner": {"reputation": 5338, "user_id": 4594973, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/USV9e.jpg?s=128&g=1", "display_name": "code_dredd", "link": "https://stackoverflow.com/users/4594973/code-dredd"}, "is_accepted": true, "score": 1, "last_activity_date": 1554488989, "last_edit_date": 1554488989, "creation_date": 1554487919, "answer_id": 55541192, "question_id": 55504517, "link": "https://stackoverflow.com/questions/55504517/how-to-open-file-with-path-relative-to-c-file-not-working-directory/55541192#55541192", "title": "How to open file with path relative to c file, not working directory", "body": "<p>Based on our conversation in the comments, you have several alternatives, which I'll list below from, IMHO, most to least desirable.</p>\n\n<p>You never specified if you were in Windows, GNU+Linux, or were doing cross-platform development, but I'm sure you can adapt the suggestions to your platform.</p>\n\n<h3>Multiple and Custom Config Files (Recommended)</h3>\n\n<p>You could modify your program to look at your platform's standard location for program data and/or configuration files. For example, you could have it look for a standard config at <code>/etc/&lt;your-program&gt;/default.conf</code> in GNU+Linux or <code>%APPDATA%\\&lt;your-program&gt;\\default.conf</code> in Windows.</p>\n\n<p>If different users need to use their own personal configs, the program could also be made to accept a config file path as an argument. For example:</p>\n\n<p>GNU+Linux:</p>\n\n<pre><code>$ ./your-program --config ${HOME}/.your-program/my.conf\n</code></pre>\n\n<p>Windows:</p>\n\n<pre><code>&gt; your-program.exe --config %userprofile%\\your-program\\my.conf\n</code></pre>\n\n<p>Note that the use of <code>%userprofile%</code> may change based on Windows versions and/or shells used (e.g. standard cmd.exe vs powershell).</p>\n\n<h3>Compiling in the Path (Not Recommended)</h3>\n\n<p>Based on your comments, a <strong><em>short-term workaround</em></strong> could be to compile the absolute path into it for the <code>__FILE__</code> macro to give that back to you at runtime. As I said in my comment:</p>\n\n<blockquote>\n  <p><strong><em>if you're completely</em></strong> sure about the program <strong><em>always</em></strong> being placed in the same directory <strong><em>for everyone</em></strong>, then you can set the absolute path shown by the <code>__FILE__</code> macro if you send the full path when compiling; e.g. <code>gcc $(pwd)/your-file.c</code>, when it prints <code>__FILE__</code> will show the full path it had at <strong><em>compile time</em></strong>, not run-time. (Can't add enough disclaimers here, though)</p>\n</blockquote>\n\n<p>Please note that there're many reasons to <strong><em>not</em></strong> use this approach. I'm simply suggesting it as a short-term workaround to pull out of an existing crisis-level situation you may have, while you (hopefully) take a closer look at the more desirable approach to handle configurations and path-finding.</p>\n"}], "owner": {"reputation": 15, "user_id": 9559846, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c778fd67bca5d41bee77a404e77dac44?s=128&d=identicon&r=PG&f=1", "display_name": "Gillen Brown", "link": "https://stackoverflow.com/users/9559846/gillen-brown"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 542, "favorite_count": 0, "accepted_answer_id": 55541192, "answer_count": 1, "score": 1, "last_activity_date": 1554488989, "creation_date": 1554326646, "question_id": 55504517, "link": "https://stackoverflow.com/questions/55504517/how-to-open-file-with-path-relative-to-c-file-not-working-directory", "title": "How to open file with path relative to c file, not working directory", "body": "<p>I'm modifying a large codebase written in C. This code is designed to be compiled and ran from an arbitrary working directory. This is so configuration files can be read and output written to/from the working directory, making it easier to organize the setup and outputs of the code. </p>\n\n<p>The additions I've made to this code need to read data from a few data files. I would like to place these in the same directory as the <code>.c</code> file where they are read, with a directory structure as follows:</p>\n\n<pre><code>big_project/\n|-- models/\n|   |-- my_file.c\n|   |-- my_data.txt\n</code></pre>\n\n<p>My problem comes in when trying to open this data file using relative paths. Typically relative paths are relative to the working directory, which would not work in my case since the working directory can be arbitrary. From inside <code>my_file.c</code>, how can I open <code>my_data.txt</code> for reading using relative paths?</p>\n"}, {"tags": ["c", "stream"], "owner": {"reputation": 57, "user_id": 10973306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be526854750b6c5bf046ca2b55e48f97?s=128&d=identicon&r=PG&f=1", "display_name": "br34k", "link": "https://stackoverflow.com/users/10973306/br34k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 0, "closed_date": 1554327463, "answer_count": 0, "score": 1, "last_activity_date": 1554329708, "creation_date": 1554326534, "last_edit_date": 1554329708, "question_id": 55504494, "link": "https://stackoverflow.com/questions/55504494/how-do-i-go-about-reading-a-text-file-like-a-log-that-is-constantly-updated", "closed_reason": "Duplicate", "title": "How do I go about reading a text file (like a .log) that is constantly updated? Is this called a stream?", "body": "<p>I'm making a program in C that will read a log file and constantly look for a certain string. It isn't complete obviously. Right now, i have it where it will get a number of all the lines in the .log, start at a certain line number from a .txt file, and go to EOF or until it finds a certain string. Further down the road, if i do it this way, i would have to constantly update my line number in the text file for a starting point.</p>\n\n<p>I'm told there's a way to have my program read the \"stream\" of the .log while looking for a certain string and then i can get it to do what i want. How do i go about doing this? I'm not very advanced so comments and explanations of methods are greatly appreciated. Forgive my coding if it is a little messy. Will definitely fix it up once I'm able to get what I want in it's final form.</p>\n\n<p>I need a better understanding and explanation than the question that is apparently the same as another that has been asked before.</p>\n\n<pre><code>\n    #define MAX_LENGTH 500\n    #define _CRT_SECURE_NO_WARNINGS\n    #include &lt;stdio.h&gt;\n    #include &lt;stdlib.h&gt; //for exit();\n    #include &lt;string.h&gt;\n\n\n    int main() {\n        char errorCheck[MAX_LENGTH] = {\"ERROR: Problem Accessing System Db! - bIsRunning, 1\"}; //this will be the string the program searches for.\n        char ec_processLog[MAX_LENGTH];\n        char oldLineNumberFile[MAX_LENGTH]; //might change\n        long int newLineNumberFile[MAX_LENGTH]; //might change\n        long int oldLineNumber, newLineNumber;\n        char line[MAX_LENGTH];\n        int resultOfCompare, lineCount = 1, found = 0;\n\n        FILE *fp1; //used to open ec_process.log\n        FILE *fp2; //used as our line starting point\n        FILE *fp3; //will be our error log file\n        fp1 = fopen(\"C:/Script testing/ec_process.log\", \"r\");\n        fp2 = fopen(\"C:/Script testing/Fix/lineNumber.txt\", \"r\");\n        fp3 = fopen(\"C:/Script testing/Fix/returnityFixErrors.txt\", \"w\");\n\n        if (fp1 == NULL || fp2 == NULL) {\n            fprintf(fp3, \"ERROR with ec_process.log file and/or lineNumber file\");\n            exit(1);\n        }\n\n\n        while (fgets(oldLineNumberFile, sizeof oldLineNumberFile, fp2)) {\n\n            oldLineNumber = atoi(oldLineNumberFile);  //atoi() converts string to integer\n        }\n\n        while (fgets(line, sizeof line, fp1) != NULL) { //This lets me go line by line in a file, reading each line one-by-one\n            //In doing so, i can use a IF loop to where once my line++ goes to a certain number, that's where i will start my\n            //FOR loop\n            line[strcspn(line, \"\\n\")] = '\\0';  // Lop off potential \\n\n\n\n            if (lineCount &gt;= oldLineNumber) {\n\n                resultOfCompare = strcmp(errorCheck, line);\n\n                if (resultOfCompare == 0) {\n                    printf(\"FOUND %s\\n ON LINE: %ld\", line, lineCount);\n                    found++;\n                    break;\n                }\n                else {\n                    lineCount++;\n                    continue;\n                }\n\n            }else {\n                lineCount++;\n            }\n\n        }\n\n\n        getchar();\n        getchar();\n\n        return 0;\n\n    }\n\n</code></pre>\n"}, {"tags": ["c", "arrays", "struct"], "comments": [{"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 2, "creation_date": 1554325797, "post_id": 55504288, "comment_id": 97714761, "body": "If you mean that the array is passed in as an argument to a function, you are correct that it will not work.  The array will decay to a pointer.  You will have to have another argument in the function that you can explicitly pass the size of the array to."}, {"owner": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 1, "creation_date": 1554325920, "post_id": 55504288, "comment_id": 97714805, "body": "<code>sizeof(*array_member)</code> is the same things as <code>sizeof(array_member[0]) </code>, so 1 is the only possible result for <code>sizeof(*array_member) &#47; sizeof(array_member[0])</code>"}, {"owner": {"reputation": 19, "user_id": 11057650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/94qCI.jpg?s=128&g=1", "display_name": "Lester Crest", "link": "https://stackoverflow.com/users/11057650/lester-crest"}, "edited": false, "score": 0, "creation_date": 1554325970, "post_id": 55504288, "comment_id": 97714830, "body": "Oh, that didn&#39;t even come to my mind XD, I was dealing with all the errors xDD. So is it possible that i write some like --&gt; nrofpatients = calculatenrofpatients(); and then write a function &quot;void calculatenrofpatients&quot; which deals with the calculation?@ChristianGibbons"}, {"owner": {"reputation": 19, "user_id": 11057650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/94qCI.jpg?s=128&g=1", "display_name": "Lester Crest", "link": "https://stackoverflow.com/users/11057650/lester-crest"}, "reply_to_user": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 0, "creation_date": 1554326007, "post_id": 55504288, "comment_id": 97714848, "body": "Aha I see, ty for info @UnholySheep"}, {"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1554326746, "post_id": 55504288, "comment_id": 97715094, "body": "Passing the size of an array is pretty common. If you don&#39;t like this approach you could mark the last element with a special value. This is comparable with strings which should always end with a termination character (<code>&#39;\\0&#39;</code>). With the end marked you can count the elements until you reach the marked element."}, {"owner": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "edited": false, "score": 0, "creation_date": 1554329504, "post_id": 55504288, "comment_id": 97716040, "body": "The basic problem is that you can&#39;t use an array type as a parameter type -- if you try to declare a function argument as an array, the compiler silently turns it into a pointer behind your back and you just have a pointer.  So all information about the size of the array is lost."}, {"owner": {"reputation": 538, "user_id": 10443568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8c1364c6ab0f7ad2840ed8abf37d09b?s=128&d=identicon&r=PG", "display_name": "Parkofadown", "link": "https://stackoverflow.com/users/10443568/parkofadown"}, "edited": false, "score": 0, "creation_date": 1554345771, "post_id": 55504288, "comment_id": 97719751, "body": "couldn&#39;t you do a for loop, or a while loop if unknown to print out the values of the array at each element."}], "answers": [{"comments": [{"owner": {"reputation": 410, "user_id": 7359826, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/296abdf6cd8afe02350eb81859885105?s=128&d=identicon&r=PG&f=1", "display_name": "Mini", "link": "https://stackoverflow.com/users/7359826/mini"}, "edited": false, "score": 0, "creation_date": 1554326123, "post_id": 55504379, "comment_id": 97714892, "body": "To add to this, when just passing the array to a function, you are essentially passing the pointer to the first element, which is why you should pass the &#39;size&#39; of the array as well (like P_J says)."}], "tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": true, "score": 1, "last_activity_date": 1554326250, "last_edit_date": 1554326250, "creation_date": 1554326051, "answer_id": 55504379, "question_id": 55504288, "link": "https://stackoverflow.com/questions/55504288/how-to-find-out-the-amount-of-elements-in-array-created-for-a-struct/55504379#55504379", "title": "How to find out the amount of elements in array created for a struct?", "body": "<p>If you have the pointer you cant use this simple compile time method. You need to pass the size of the array to the function</p>\n\n<p>In C you always pass the pointer even if your declaration is <code>... foo(Member arr[])</code> or <code>... foo(Member arr[100])</code></p>\n\n<pre><code>struct members\n{\n\nchar name[32];\nintmax_t personalID;\n\n}typedef struct members Member;\n\nMember array_member[100];\n\n\nint foo(Member *arr, size_t size)\n{\n    /* .... */\n}\n\nint main()\n{\n    /* correct */\n    foo(array_member, sizeof(array_member) / sizeof(array_member[0]));\n    printf(\"Hello World\");\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 11057650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/94qCI.jpg?s=128&g=1", "display_name": "Lester Crest", "link": "https://stackoverflow.com/users/11057650/lester-crest"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 55504379, "answer_count": 1, "score": 0, "last_activity_date": 1554326250, "creation_date": 1554325645, "question_id": 55504288, "link": "https://stackoverflow.com/questions/55504288/how-to-find-out-the-amount-of-elements-in-array-created-for-a-struct", "title": "How to find out the amount of elements in array created for a struct?", "body": "<p>I created a certain struct and then I went on to create an array for the struct in the following manner:</p>\n\n<pre><code>struct members\n{\n\nchar name[32];\nintmax_t personalID;\n\n}typedef struct members Member;\n\nMember array_member[100];\n</code></pre>\n\n<p>Later on, I want to know how many elements there are in the array, according to some answers I have read, this should be enough</p>\n\n<pre><code>int nrofmembers = sizeof(array_member) / sizeof(array_member[0]);\n</code></pre>\n\n<p>But due to my experience, I know that this is not possible if the array itself is a parameter. So I tried this:</p>\n\n<pre><code>int nrofmembers =  sizeof(*array_member) / sizeof(array_member[0]);\n</code></pre>\n\n<p>Unfortunately, this has turned out to be wrong. The value of nrofmembers after this is 1, but that's not true.</p>\n\n<p>Any advice on how to do this?</p>\n"}, {"tags": ["c", "format", "ls", "stat"], "comments": [{"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 2, "creation_date": 1554325537, "post_id": 55504146, "comment_id": 97714674, "body": "How the number is calculated is explained in the section on <code>-l</code> here: <a href=\"https://www.gnu.org/software/coreutils/manual/html_node/What-information-is-listed.html\" rel=\"nofollow noreferrer\">gnu.org/software/coreutils/manual/html_node/&hellip;</a>"}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1554325711, "post_id": 55504146, "comment_id": 97714728, "body": "For adjusting field width and alignment, read up on printf."}, {"owner": {"reputation": 293, "user_id": 7177271, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-8EkKHDl-kgU/AAAAAAAAAAI/AAAAAAAAABY/x2USaUE1k-o/photo.jpg?sz=128", "display_name": "Bret Hasel", "link": "https://stackoverflow.com/users/7177271/bret-hasel"}, "reply_to_user": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1554325766, "post_id": 55504146, "comment_id": 97714752, "body": "ahhhhh okay so its the total amount of blocks set aside for disk allocation. But how using stat can i get this number?"}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1554326125, "post_id": 55504146, "comment_id": 97714894, "body": "<code>struct stat</code> has a field that will probably be helpful. Just remember to take the difference between the block size it counts and the block size that is displayed into account - you already touched on that in your question, though the math was wrong."}], "owner": {"reputation": 293, "user_id": 7177271, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-8EkKHDl-kgU/AAAAAAAAAAI/AAAAAAAAABY/x2USaUE1k-o/photo.jpg?sz=128", "display_name": "Bret Hasel", "link": "https://stackoverflow.com/users/7177271/bret-hasel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 332, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1554385924, "creation_date": 1554325052, "last_edit_date": 1554326288, "question_id": 55504146, "link": "https://stackoverflow.com/questions/55504146/what-is-total-from-ls-al", "title": "What is &quot;total&quot; from ls -al?", "body": "<p>I have been tasked to mimic the command <code>ls -alU --time-style=long-iso</code>. While i have it nearly down i don't quite understand what that first like of total is. I understand its the total amount of blocks used *2 or something similar but i'm not understanding where that number is coming from and where to find it using stat?</p>\n\n<p><strong>CODE</strong></p>\n\n<pre><code>#include &lt;sys/types.h&gt;\n#include &lt;sys/stat.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;dirent.h&gt;\n#include &lt;grp.h&gt;\n#include &lt;time.h&gt;\n#include &lt;pwd.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;string.h&gt;\n\nint main(void)\n{\n    DIR *mydir;\n    struct dirent *myfile;\n    struct stat myStat;\n    struct passwd *pwd;\n    int s;\n    struct tm lt;\n    char buf[1024];\n    struct group *gf;\n    mydir = opendir(\"./\");\n\n    while((myfile = readdir(mydir)) != NULL)\n    {\n        stat(myfile-&gt;d_name, &amp;myStat);\n        if((stat(myfile-&gt;d_name, &amp;myStat) ) == 0){\n            pwd = getpwuid(myStat.st_uid);\n        }\n        gf = getgrgid(myStat.st_gid);\n        time_t t = myStat.st_mtime;\n        localtime_r(&amp;t, &amp;lt);\n        char timebuf[80];\n        char timebuf2[80];\n\n        strftime(timebuf, sizeof(timebuf), \"%F\", &amp;lt);\n        strftime(timebuf2, sizeof(timebuf2), \"%R\", &amp;lt);\n        printf( (S_ISDIR(myStat.st_mode)) ? \"d\" : \"-\");\n        printf( (myStat.st_mode &amp; S_IRUSR) ? \"r\" : \"-\");\n        printf( (myStat.st_mode &amp; S_IWUSR) ? \"w\" : \"-\");\n        printf( (myStat.st_mode &amp; S_IXUSR) ? \"x\" : \"-\");\n        printf( (myStat.st_mode &amp; S_IRGRP) ? \"r\" : \"-\");\n        printf( (myStat.st_mode &amp; S_IWGRP) ? \"w\" : \"-\");\n        printf( (myStat.st_mode &amp; S_IXGRP) ? \"x\" : \"-\");\n        printf( (myStat.st_mode &amp; S_IROTH) ? \"r\" : \"-\");\n        printf( (myStat.st_mode &amp; S_IWOTH) ? \"w\" : \"-\");\n        printf( (myStat.st_mode &amp; S_IXOTH) ? \"x\" : \"-\");\n        printf(\" \");\n        printf(\"%ld \", myStat.st_nlink);\n        if(pwd != 0){\n            printf(\"%s %s %ld\\t%s %s %s\\n\", pwd-&gt;pw_name, gf-&gt;gr_name, (long)myStat.st_size, timebuf, timebuf2, myfile-&gt;d_name);\n        }else  {\n\n            printf(\"%d %s %ld\\t%s %s %s\\n\", myStat.st_uid, gf-&gt;gr_name, (long)myStat.st_size, timebuf, timebuf2, myfile-&gt;d_name);\n            printf(\"\\n\");\n        } \n    }\n    closedir(mydir);\n}\n</code></pre>\n\n<p><strong>CURRENT OUTPUT</strong></p>\n\n<pre><code>drwxr-xr-x 3 user user    46 2019-04-03 21:17 .\ndrwxr-xr-x 3 user root    19 2019-04-03 18:33 ..\ndrwxr-xr-x 2 user user     6 2019-04-03 18:34 .che\n-rw-r--r-- 1 user user  1895 2019-04-03 21:17 lsdir.c\n-rwxr-xr-x 1 user user 13304 2019-04-03 21:17 lsdir\n</code></pre>\n\n<p><strong>DESIRED OUTPUT</strong></p>\n\n<pre><code>total 20\ndrwxr-xr-x 3 user user    46 2019-04-03 21:17 .\ndrwxr-xr-x 3 user root    19 2019-04-03 18:33 ..\ndrwxr-xr-x 2 user user     6 2019-04-03 18:34 .che\n-rw-r--r-- 1 user user  1895 2019-04-03 21:17 lsdir.c\n-rwxr-xr-x 1 user user 13304 2019-04-03 21:17 lsdir\n</code></pre>\n"}, {"tags": ["c", "assembly"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1554322277, "post_id": 55503513, "comment_id": 97713289, "body": "<a href=\"https://godbolt.org/z/OChzXd\" rel=\"nofollow noreferrer\">godbolt.org/z/OChzXd</a>"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 7, "creation_date": 1554322299, "post_id": 55503513, "comment_id": 97713297, "body": "C code is converted (translated) to assembly by a program commonly called a C compiler."}, {"owner": {"reputation": 4946, "user_id": 354010, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/ScLoS.png?s=128&g=1", "display_name": "zakishaheen", "link": "https://stackoverflow.com/users/354010/zakishaheen"}, "edited": false, "score": 0, "creation_date": 1554322430, "post_id": 55503513, "comment_id": 97713360, "body": "It depends on a: why do you need this? and b: which architecture you want the assembly to be in?   If you are new to C and ASM - I&#39;d recommend first learning those things before tacking this complicated challenge."}, {"owner": {"reputation": 59348, "user_id": 522663, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/OKOEw.png?s=128&g=1", "display_name": "Jonathan Wood", "link": "https://stackoverflow.com/users/522663/jonathan-wood"}, "edited": false, "score": 0, "creation_date": 1554322647, "post_id": 55503513, "comment_id": 97713471, "body": "I would start by learning assembly language. In addition, some compilers have options to generate assembly language for you from the C code when they compile."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1554323332, "post_id": 55503513, "comment_id": 97713759, "body": "Do you also need to write <code>scanf</code> &amp; <code>printf</code> in assembly language?"}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1554329261, "post_id": 55503513, "comment_id": 97715964, "body": "What architecture are you programming for?"}], "answers": [{"tags": [], "owner": {"reputation": 181, "user_id": 8598112, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AOh14Gg-gN2-mT-8olkhAPjq6VQqQkIRgWjwnwgMJ7-dFA=k-s128", "display_name": "Hamza Ince", "link": "https://stackoverflow.com/users/8598112/hamza-ince"}, "is_accepted": false, "score": 0, "last_activity_date": 1554323554, "creation_date": 1554323554, "answer_id": 55503812, "question_id": 55503513, "link": "https://stackoverflow.com/questions/55503513/i-need-to-convert-my-code-written-in-c-c-to-assembly-asm-i-am-very-new-to-w/55503812#55503812", "title": "I need to convert my code written in C(.c) to assembly(.asm). I am very new to writing in C and now I need to learn how to write in assembly", "body": "<p>As Antti Haapala said the usual gcc does the trick. You will get a compiled binaty file that you can read with the command :</p>\n\n<pre><code>objdump -d file\n</code></pre>\n\n<p>You have lot of tools, to help you read the binary file, such as gdb, xxd, objdump, ... <br>There is also Ghidra, which is new, but I am not sure about this one.</p>\n"}, {"tags": [], "owner": {"reputation": 43, "user_id": 9382003, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "MarcinS", "link": "https://stackoverflow.com/users/9382003/marcins"}, "is_accepted": false, "score": 1, "last_activity_date": 1554323982, "creation_date": 1554323982, "answer_id": 55503896, "question_id": 55503513, "link": "https://stackoverflow.com/questions/55503513/i-need-to-convert-my-code-written-in-c-c-to-assembly-asm-i-am-very-new-to-w/55503896#55503896", "title": "I need to convert my code written in C(.c) to assembly(.asm). I am very new to writing in C and now I need to learn how to write in assembly", "body": "<p>Well you theoretically can just compile it using gcc and order it to generate asm listing (which will be assembler), so you could just change it's extension to .asm (<a href=\"https://www.systutorials.com/240/generate-a-mixed-source-and-assembly-listing-using-gcc/\" rel=\"nofollow noreferrer\">https://www.systutorials.com/240/generate-a-mixed-source-and-assembly-listing-using-gcc/</a>)</p>\n\n<p>Generally speaking though, it's bad idea to include scanf and printf in assembly, or any library function for that matter (since they can be really long in asm, specially system calls e.g. read/write/open,printf).</p>\n\n<p>And just in case if you someone on university asked you to write something in ASM they will know it's not written by you.</p>\n\n<p>Also judging by title, staring learning ASM with C listings isn't way to go (due to for example stack operations on procedure call). </p>\n"}, {"tags": [], "owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "is_accepted": false, "score": 0, "last_activity_date": 1554324299, "last_edit_date": 1592644375, "creation_date": 1554324299, "answer_id": 55503976, "question_id": 55503513, "link": "https://stackoverflow.com/questions/55503513/i-need-to-convert-my-code-written-in-c-c-to-assembly-asm-i-am-very-new-to-w/55503976#55503976", "title": "I need to convert my code written in C(.c) to assembly(.asm). I am very new to writing in C and now I need to learn how to write in assembly", "body": "<p>If you want to compile directly to assembly with <code>gcc</code>, you can use the <code>-S</code> option.  From the gcc manpage:</p>\n<blockquote>\n<p><strong>-S</strong> Stop after the stage of compilation proper; do not assemble.  The output is in the form of an assembler code file for each non-assembler input file specified.</p>\n<p>By default, the assembler file name for a source file is made by replacing the suffix .c, .i, etc., with .s.</p>\n<p>Input files that don't require compilation are ignored.</p>\n</blockquote>\n"}], "owner": {"reputation": 1, "user_id": 11307870, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Kf7TpHwXcM4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcqUATY6EDvk85ECtkg1mZSTUuWFQ/mo/photo.jpg?sz=128", "display_name": "Mariana Meza", "link": "https://stackoverflow.com/users/11307870/mariana-meza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1554325443, "creation_date": 1554322195, "question_id": 55503513, "link": "https://stackoverflow.com/questions/55503513/i-need-to-convert-my-code-written-in-c-c-to-assembly-asm-i-am-very-new-to-w", "title": "I need to convert my code written in C(.c) to assembly(.asm). I am very new to writing in C and now I need to learn how to write in assembly", "body": "<p>I need to convert my C code into assembly</p>\n\n<p>here is my C code that needs to be converted into assembly(.asm)</p>\n\n<pre><code>int main()\n{\n   //Variables that stores the numbers\n   int num1, num2, num3;\n   // Variable that stores the result\n   int result;\n   // Asking the user to input the value of num1\n   printf(\"Enter the first number:\");\n   scanf(\"%d\",&amp;num1);\n   // Asking the user to input the value of num2\n   printf(\"Enter the second number:\");\n   scanf(\"%d\",&amp;num2);\n   // Asking the user to input the value of num3\n   printf(\"Enter the third number: \");\n   scanf(\"%d\",&amp;num3);\n   //Performing the operation\n   result = num3 - (num1 + num2);\n   //Printing the result\n   printf(\"The value of result is: %d\",result);\n   return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "suse"], "comments": [{"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 2, "creation_date": 1554319809, "post_id": 55502812, "comment_id": 97712027, "body": "Any reason you&#39;re not using <code>clock_gettime</code>?"}, {"owner": {"reputation": 49, "user_id": 2410302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3016a52c801510a14d418e7b00f57aeb?s=128&d=identicon&r=PG", "display_name": "First Last", "link": "https://stackoverflow.com/users/2410302/first-last"}, "reply_to_user": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1554320410, "post_id": 55502812, "comment_id": 97712352, "body": "I suppose mainly because the code has been this way for years, if not decades.  But I will take a close look at <code>clock_gettime</code> as a possible fix.  Thanks."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 1, "creation_date": 1554324153, "post_id": 55502812, "comment_id": 97714107, "body": "I can&#39;t reproduce this problem, but I don&#39;t have SuSE handy and I don&#39;t even know which version of SuSE you&#39;re using. With Ubuntu 18.04, and having fixed the warnings produced by your code (for example, by adding <code>#include &lt;sys&#47;times.h&gt;</code>, which might make a difference), I get consistent results but they&#39;re quite different from either of the values you show."}, {"owner": {"reputation": 49, "user_id": 2410302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3016a52c801510a14d418e7b00f57aeb?s=128&d=identicon&r=PG", "display_name": "First Last", "link": "https://stackoverflow.com/users/2410302/first-last"}, "edited": false, "score": 0, "creation_date": 1554381161, "post_id": 55502812, "comment_id": 97736763, "body": "It&#39;s SuSE 11.4.  I updated the question to reflect that."}], "owner": {"reputation": 49, "user_id": 2410302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3016a52c801510a14d418e7b00f57aeb?s=128&d=identicon&r=PG", "display_name": "First Last", "link": "https://stackoverflow.com/users/2410302/first-last"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 97, "favorite_count": 2, "answer_count": 0, "score": 4, "last_activity_date": 1554381119, "creation_date": 1554319344, "last_edit_date": 1554381119, "question_id": 55502812, "link": "https://stackoverflow.com/questions/55502812/should-there-be-different-starting-points-for-the-c-times-function-in-32-and", "title": "Should there be different starting points for the C times() function in 32- and 64-bit processes?", "body": "<p>The following refers to SuSE 11.4 Linux.</p>\n\n<p>When my multi-process software starts on a server, the returned value of the C <em>times()</em> function is saved as an integer in shared memory.\u00a0 (This is OK, because we\u2019re pre-C11.)\u00a0 Later, calls to <em>times()</em> are made to get the starting and ending times for tasks.\u00a0 For example, a start time is computed as the amount of time since the original call to <em>times()</em>, and an end time is computed the same way.\u00a0 Later, the difference can be taken between the starting and ending time, to compute a task\u2019s duration.</p>\n\n<p>Previously, we only used 32-bit processes.\u00a0 For the next release, we\u2019re planning on having both 32- and 64-bit processes running on the same server.\u00a0 However, there seems to be clashing results from <em>times()</em>.</p>\n\n<p>According to the documentation, <em>times()</em> returns the duration since an arbitrary point in the past.\u00a0 What I\u2019m finding is that the initial point in the past differs depending on if the process was built as a 32- or 64-bit executable.</p>\n\n<p>Consider the following code:</p>\n\n<pre><code>#include &lt;time.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdint.h&gt;\n#include &lt;inttypes.h&gt;\n#include &lt;unistd.h&gt;\n\nclock_t getTimes()\n{\n\u00a0\u00a0\u00a0 clock_t c = times(0);\n\u00a0\u00a0\u00a0 int64_t c_int64_t = (int64_t)c &amp; 0x00000000FFFFFFFF;\n\u00a0\u00a0\u00a0 printf(\"c_int64_t is [%\" PRId64 \"]\\n\", c_int64_t);\n\u00a0\u00a0\u00a0 return c;\n}\n\nint main(void)\n{\n\u00a0\u00a0\u00a0 printf(\"sizeof(clock_t) is [%d]\\n\", sizeof(clock_t));\n\n\u00a0\u00a0\u00a0 clock_t c1 = getTimes();\n\u00a0\u00a0\u00a0 printf(\"sleeping for 2 seconds...\\n\");\n\u00a0\u00a0\u00a0 sleep(2);\n\u00a0\u00a0\u00a0 clock_t c2 = getTimes();\n\n\u00a0\u00a0\u00a0 double elapsedTime = ((double) (c2 - c1)) / (double)sysconf(_SC_CLK_TCK);\n\u00a0\u00a0\u00a0 printf(\"elapsedTime is [%f]\\n\", elapsedTime);\n\u00a0\u00a0\u00a0 return 0;\n}\n</code></pre>\n\n<p>I compile it as follows:</p>\n\n<pre><code>$ gcc -m32 -oa.32.out clock.c\n$ gcc \u2013m64 -oa.64.out clock.c\n</code></pre>\n\n<p>Note what happens when I run it 4 times:</p>\n\n<pre><code>$ for i in a.32.out a.64.out a.32.out a.64.out\n&gt; do\n&gt; echo \" \"\n&gt; ./${i}\n&gt; done\n\nsizeof(clock_t) is [4]\nc_int64_t is [2286152112]\nsleeping for 2 seconds...\nc_int64_t is [2286152312]\nelapsedTime is [2.000000]\n\nsizeof(clock_t) is [8]\nc_int64_t is [2286295196]\nsleeping for 2 seconds...\nc_int64_t is [2286295396]\nelapsedTime is [2.000000]\n\nsizeof(clock_t) is [4]\nc_int64_t is [2286152512]\nsleeping for 2 seconds...\nc_int64_t is [2286152712]\nelapsedTime is [2.000000]\n\nsizeof(clock_t) is [8]\nc_int64_t is [2286295597]\nsleeping for 2 seconds...\nc_int64_t is [2286295797]\nelapsedTime is [2.000000]\n</code></pre>\n\n<p>As I hope is clear from the results, the 32-bit and 64-bit processes are each consistent amongst themselves.\u00a0 But they differ between each other by about 142,885 units (or 1429 seconds).\u00a0 The result of this is that my software can\u2019t share a \u201cbase time\u201d between 64- and 32-bit processes.</p>\n\n<p><strong>Is this behaviour of <em>times()</em> normal and expected?</strong></p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 28120, "user_id": 492773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4c30dea4ed3e1c2efc5e877f1f3c971?s=128&d=identicon&r=PG", "display_name": "kichik", "link": "https://stackoverflow.com/users/492773/kichik"}, "edited": false, "score": 1, "creation_date": 1554319213, "post_id": 55502742, "comment_id": 97711746, "body": "Is that the whole code? Where are you trying to read it? Do you close the file before that?"}, {"owner": {"reputation": 11, "user_id": 11307659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbece6e6db98a9f2621751ed2e39b3ed?s=128&d=identicon&r=PG&f=1", "display_name": "Robertf", "link": "https://stackoverflow.com/users/11307659/robertf"}, "reply_to_user": {"reputation": 28120, "user_id": 492773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4c30dea4ed3e1c2efc5e877f1f3c971?s=128&d=identicon&r=PG", "display_name": "kichik", "link": "https://stackoverflow.com/users/492773/kichik"}, "edited": false, "score": 0, "creation_date": 1554319716, "post_id": 55502742, "comment_id": 97711973, "body": "Edited to add the full main function, i only close the files at the very end and both txt files open successfully"}, {"owner": {"reputation": 11, "user_id": 11307659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbece6e6db98a9f2621751ed2e39b3ed?s=128&d=identicon&r=PG&f=1", "display_name": "Robertf", "link": "https://stackoverflow.com/users/11307659/robertf"}, "reply_to_user": {"reputation": 28120, "user_id": 492773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4c30dea4ed3e1c2efc5e877f1f3c971?s=128&d=identicon&r=PG", "display_name": "kichik", "link": "https://stackoverflow.com/users/492773/kichik"}, "edited": false, "score": 0, "creation_date": 1554319836, "post_id": 55502742, "comment_id": 97712039, "body": "All other functions work properly, the arr is sorted correctly and the outFile pointer doesn&#39;t equal NULL. The only portions of the code that seem to not work are the   fprintf(outFile, &quot;%d\\n&quot;, n);    And        for (int i = 0; i&lt;n; i++){     fprintf(outFile, &quot;%d %d\\n&quot;, arr[i].x, arr[i].y); }"}, {"owner": {"reputation": 1975, "user_id": 6070341, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YHHZU.png?s=128&g=1", "display_name": "Costantino Grana", "link": "https://stackoverflow.com/users/6070341/costantino-grana"}, "edited": false, "score": 2, "creation_date": 1554323394, "post_id": 55502742, "comment_id": 97713789, "body": "Make a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. Substitute <code>outFile</code> with <code>stdout</code> and run your program with a debugger. Execute a line at a time and check on the console."}, {"owner": {"reputation": 11, "user_id": 11307659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbece6e6db98a9f2621751ed2e39b3ed?s=128&d=identicon&r=PG&f=1", "display_name": "Robertf", "link": "https://stackoverflow.com/users/11307659/robertf"}, "edited": false, "score": 0, "creation_date": 1554323972, "post_id": 55502742, "comment_id": 97714018, "body": "All of the scanfs work, when i print the array to the console it prints fine. Its only the fprintfs that arent working."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 11307659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbece6e6db98a9f2621751ed2e39b3ed?s=128&d=identicon&r=PG&f=1", "display_name": "Robertf", "link": "https://stackoverflow.com/users/11307659/robertf"}, "edited": false, "score": 0, "creation_date": 1554319987, "post_id": 55502936, "comment_id": 97712126, "body": "Ok seriously starting to think its an issue with my compiler, just tried it with my mergeSort commented out and it didn&#39;t work"}, {"owner": {"reputation": 9388, "user_id": 450708, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NIgMI.jpg?s=128&g=1", "display_name": "EricS", "link": "https://stackoverflow.com/users/450708/erics"}, "reply_to_user": {"reputation": 11, "user_id": 11307659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbece6e6db98a9f2621751ed2e39b3ed?s=128&d=identicon&r=PG&f=1", "display_name": "Robertf", "link": "https://stackoverflow.com/users/11307659/robertf"}, "edited": false, "score": 0, "creation_date": 1554320062, "post_id": 55502936, "comment_id": 97712164, "body": "Has the program terminated on your system? Maybe the data just isn&#39;t getting flushed out. Try closing the file?"}, {"owner": {"reputation": 11, "user_id": 11307659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbece6e6db98a9f2621751ed2e39b3ed?s=128&d=identicon&r=PG&f=1", "display_name": "Robertf", "link": "https://stackoverflow.com/users/11307659/robertf"}, "edited": false, "score": 0, "creation_date": 1554320844, "post_id": 55502936, "comment_id": 97712569, "body": "Just restarted my entire comp, still nothing"}, {"owner": {"reputation": 11, "user_id": 11307659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbece6e6db98a9f2621751ed2e39b3ed?s=128&d=identicon&r=PG&f=1", "display_name": "Robertf", "link": "https://stackoverflow.com/users/11307659/robertf"}, "edited": false, "score": 0, "creation_date": 1554320903, "post_id": 55502936, "comment_id": 97712598, "body": "Yah i am on windows, whats carriage returns?"}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "reply_to_user": {"reputation": 11, "user_id": 11307659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbece6e6db98a9f2621751ed2e39b3ed?s=128&d=identicon&r=PG&f=1", "display_name": "Robertf", "link": "https://stackoverflow.com/users/11307659/robertf"}, "edited": false, "score": 0, "creation_date": 1554321722, "post_id": 55502936, "comment_id": 97713021, "body": "@Robertf pursuit of carriage returns is pointless for this exercise. You&#39;re (hopefully) writing data. Checking the result of the <code>fprintf</code> to ensure its actually writing the data would probably be a worthy endeavor. And check your CWD (though I expect it is valid, otherwise <code>in.txt</code> wouldn&#39;t be opening either unless the one you&#39;re opening isn&#39;t the one you think it is). Are you running this in some IDE (like Visual Studio, where the CWD at debug-time is the same folder as the <i>project</i> file by default?)"}, {"owner": {"reputation": 11, "user_id": 11307659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbece6e6db98a9f2621751ed2e39b3ed?s=128&d=identicon&r=PG&f=1", "display_name": "Robertf", "link": "https://stackoverflow.com/users/11307659/robertf"}, "edited": false, "score": 0, "creation_date": 1554323515, "post_id": 55502936, "comment_id": 97713844, "body": "I am running this in code blocks. The only issue is that this code was working fine about 2 hours ago. I stepped away and came back to it after an hour of rest to test it more and it all of a sudden wasn&#39;t working."}], "tags": [], "owner": {"reputation": 9388, "user_id": 450708, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NIgMI.jpg?s=128&g=1", "display_name": "EricS", "link": "https://stackoverflow.com/users/450708/erics"}, "is_accepted": false, "score": 0, "last_activity_date": 1554319851, "creation_date": 1554319851, "answer_id": 55502936, "question_id": 55502742, "link": "https://stackoverflow.com/questions/55502742/fprintf-is-not-printing-data-to-the-file/55502936#55502936", "title": "Fprintf is not printing data to the file", "body": "<p>That code runs fine here on my Mac, at least with the mergeSort commented out. You're not running on Windows, are you? If so the file may look empty because it's missing carriage returns. </p>\n"}], "owner": {"reputation": 11, "user_id": 11307659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbece6e6db98a9f2621751ed2e39b3ed?s=128&d=identicon&r=PG&f=1", "display_name": "Robertf", "link": "https://stackoverflow.com/users/11307659/robertf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1554320199, "creation_date": 1554319075, "last_edit_date": 1554320199, "question_id": 55502742, "link": "https://stackoverflow.com/questions/55502742/fprintf-is-not-printing-data-to-the-file", "title": "Fprintf is not printing data to the file", "body": "<p>I am trying to get the data in my arr array to print to the file \"out.txt\". The program was able to do it before but for some reason will now not print at all and even after undoing to a previous version nothing will print. </p>\n\n<p>I have code in place that proves both that the File is successfully opened and the data is correct in the array. All other functions work properly.</p>\n\n<pre><code>int main () {\n\n    FILE *inFile;\n    FILE *outFile;\n    int n = 0;\n\n    inFile = fopen(\"in.txt\", \"r\");\n\n    if (inFile == NULL) {\n        printf(\"File failed to open\");\n    }\n    outFile = fopen(\"out.txt\", \"w\");\n\n    if (outFile == NULL) {\n        printf(\"outFile failed to open\");\n    }\n\n    fscanf(inFile, \"%d\", &amp;n);\n\n    struct Point* arr;\n    arr = (struct Point*) malloc (n * sizeof(struct Point));\n    int i = 0;\n\n\n    while (i&lt;n){\n        fscanf(inFile, \"%d %d\", &amp;arr[i].x, &amp;arr[i].y);\n        i++;\n    }\n\n    mergeSort(arr, 0, n-1);\n\n    fprintf(outFile, \"%d\\n\", n);\n\n    for (int i = 0; i&lt;n; i++){\n        printf(\"%d %d\\n\", arr[i].x, arr[i].y);\n    }\n\n    for (int i = 0; i&lt;n; i++){\n        fprintf(outFile, \"%d %d\\n\", arr[i].x, arr[i].y);\n    }\n\n    printf(\"\\nSorted and output written to File\\n\");\n\n    int searchx, searchy;\n\n    printf(\"Please enter a point to search for:  \");\n    scanf(\"%d %d\", &amp;searchx, &amp;searchy);\n\n    int result = 0;\n\n    result = binarySearch(arr, searchx, searchy,0, n);\n\n    if (result == -1) {\n        printf(\"Point not found\");\n        return 0;\n    }\n    else {\n        printf(\"Point found in element %d\", result);\n    }\n    fclose(inFile);\n    fclose(outFile);\n}\n</code></pre>\n\n<p>expected results with sample input.\nIn.txt:</p>\n\n<pre><code>5\n6 3\n4 6\n2 5\n2 7\n5 2 \n</code></pre>\n\n<p>out.txt:</p>\n\n<pre><code>5\n2 5\n2 7\n4 6\n5 2\n6 3\n</code></pre>\n\n<p>Actual results:\nout.txt:</p>\n\n<pre><code>//Blank\n</code></pre>\n"}, {"tags": ["c", "language-lawyer", "flexible-array-member"], "comments": [{"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1554318941, "post_id": 55502617, "comment_id": 97711630, "body": "What&#39;s wrong with <code>struct test *myText = malloc(size * sizeof (*myText))</code> ?"}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1554319091, "post_id": 55502617, "comment_id": 97711686, "body": "Or more to the point, what is the actual problem you&#39;re trying to solve?"}, {"owner": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "reply_to_user": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1554319137, "post_id": 55502617, "comment_id": 97711711, "body": "@Broman That&#39;s okay. But how about this:  <code>struct test *myStruct = myText + 1;</code>"}, {"owner": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "reply_to_user": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1554320191, "post_id": 55502617, "comment_id": 97712245, "body": "@Broman reading from <code>inotify</code> file descriptor files supplied buffer with <code>struct inotify_event</code> which contains flexible array member."}], "answers": [{"comments": [{"owner": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "edited": false, "score": 0, "creation_date": 1554319246, "post_id": 55502737, "comment_id": 97711767, "body": "So sinnce <code>malloc</code> allocates for either an object or array of the objects there is no pedantic way. Correct?"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "edited": false, "score": 1, "creation_date": 1554319342, "post_id": 55502737, "comment_id": 97711822, "body": "@SomeName It&#39;s not about <code>malloc</code> so much as it&#39;s about pointer arithmetic.  Because each struct can have a different size, the array can&#39;t be indexed normally."}, {"owner": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "edited": false, "score": 0, "creation_date": 1554320386, "post_id": 55502737, "comment_id": 97712340, "body": "agree, since pointer arithmetic is well defined  only on elements of the same array, thanks."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 3, "last_activity_date": 1554319249, "last_edit_date": 1554319249, "creation_date": 1554319054, "answer_id": 55502737, "question_id": 55502617, "link": "https://stackoverflow.com/questions/55502617/how-to-allocate-an-array-of-structs-with-flexible-array-members-comformingly/55502737#55502737", "title": "How to allocate an array of structs with flexible array members comformingly?", "body": "<p>A <code>struct</code> with a flexible array member can't be a member of an array, as dictated by the quote you gave.</p>\n\n<p>The best way to handle this is to change the flexible array member to a pointer and allocate space for it separately.</p>\n\n<pre><code>struct test {\n    size_t sz;\n    char *str;\n};\n\n...\n\nstruct test *arr = malloc(100 * sizeof(struct test));\n\narr[0].sz = 2;\narr[0].str = malloc(2);\narr[0].str[0] = 'a';\narr[0].str[1] = 'b';\n\narr[1].sz = 3;\narr[1].str = malloc(3);\narr[1].str[0] = 'c';\narr[1].str[1] = 'd';\narr[1].str[2] = 'e';\n</code></pre>\n\n<p>Also, it's generally not a good idea to have <code>const</code> members of a struct.</p>\n"}, {"comments": [{"owner": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "edited": false, "score": 0, "creation_date": 1554533305, "post_id": 55542743, "comment_id": 97795432, "body": "I would argue about disabling strict aliasing to access a common initiail sequence of non-compatible struct types. Putting both of the types as union members and accessing their common initial sequence from anywhere where the <code>union</code> declaration is visible is a conforming way, isn&#39;t?"}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "edited": false, "score": 1, "creation_date": 1554598090, "post_id": 55542743, "comment_id": 97810528, "body": "@SomeName: Under the gcc/clang interpretation, operations that take the addresses of union members and use the resulting pointers are unsupported *even in cases where nothing else accesses the storage between the time the address is taken and the pointer is used.  Even something like <code>*(someUnion.memberOfArrayType+index)</code> can fail.  The Standard doesn&#39;t forbid such behavior because the authors expected that compiler writers would limit application of the rule to cases involving aliasing of seemingly-unrelated objects.  More generally, the Standard deliberately allows..."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "edited": false, "score": 1, "creation_date": 1554598257, "post_id": 55542743, "comment_id": 97810551, "body": "...implementations specialized for narrow purposes to behave in ways that would benefit those purposes, even when that would make them unsuitable for many others. As a consequence of that, it makes no attempt to pass judgment as to what behaviors might render an implementation unsuitable for almost any purpose."}], "tags": [], "owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "is_accepted": false, "score": 1, "last_activity_date": 1554495251, "creation_date": 1554495251, "answer_id": 55542743, "question_id": 55502617, "link": "https://stackoverflow.com/questions/55502617/how-to-allocate-an-array-of-structs-with-flexible-array-members-comformingly/55542743#55542743", "title": "How to allocate an array of structs with flexible array members comformingly?", "body": "<p>A \"popular extension\" which most implementations can be configured to support (if they don't always do so) is to allow the address of structure type to be converted to the address of another which shares a Common Initial Sequence, and be used to access members of that sequence, until the structure is accessed via means other than the converted pointer, or execution enters a function or loop wherein that would occur.</p>\n\n<p>On implementations that support that extension, the requested semantics can be achieved by declaring a structure whose layout which matches that of the structure with the Flexible Array Member.  For example:</p>\n\n<pre><code>struct POINT { int x, y; };\nstruct POLYGON { int sides; struct POINT coords[]; };\nstruct TRIANGLE { int sides; struct POINT coords[3]; };\n\nvoid draw_polygon(struct POLYGON const *p);\nvoid test(void)\n{\n  struct TRIANGLE my_triangle = {3, {{1,2}, {3,4], {5,6}};\n  draw_polygon((struct POLYGON*)&amp;my_triangle);\n}\n</code></pre>\n\n<p>Some compilers like icc and MSVC are sophisticated enough to support this extension even when type-based aliasing is enabled.  Others like gcc and clang can only support this extension via the use of the <code>-fno-strict-aliasing</code> option.</p>\n\n<p>Although code using this extension is not strictly conforming, the Standards Committee has said in the published Rationale that they did not want to make the language usable only for writing portable programs.  Instead, they expected that quality implementations would support a variety of \"popular extensions\" by processing some constructs in ways that would be useful to their customers even when the Standard would allow them to do otherwise.  The ability to convert pointers among structure types has been a fundamental part of the language the Standard was written to describe since 1974, and nearly all implementations can be configured to support it.  Code like the above should thus be recognized as more portable than code which relies upon non-standard syntactical extensions to achieve similar semantics.</p>\n"}], "owner": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "accepted_answer_id": 55502737, "answer_count": 2, "score": 2, "last_activity_date": 1554495251, "creation_date": 1554318603, "last_edit_date": 1554319891, "question_id": 55502617, "link": "https://stackoverflow.com/questions/55502617/how-to-allocate-an-array-of-structs-with-flexible-array-members-comformingly", "title": "How to allocate an array of structs with flexible array members comformingly?", "body": "<p>I have the following struct with a flexible array member:</p>\n\n<pre><code>struct test {\n    size_t sz;\n    const char str[];\n};\n</code></pre>\n\n<p>Now I want to allocate some memory to put this struct continuously (like in array). The problem is a declaration like <code>struct test test_arr[]</code> is undefined behavior. <code>6.7.2.1(p3)</code>:</p>\n\n<blockquote>\n  <p>the last member of a structure with more than one named member\n  may have incomplete array type; such a structure (and any union \n  containing, possibly recursively, a member that is such a structure)\n  shall not be a member of a structure or an element of an array.</p>\n</blockquote>\n\n<p>We know that pointer returned by <code>malloc</code> can be converted to a pointer to any objecut type with fundamental alignment. Consider the following code:</p>\n\n<pre><code>void *obj= malloc(100 * sizeof(struct test)); //enough memory\nstruct test *t1 = obj;\nt1 -&gt; sz = 2;\nt1 -&gt; str = {'a', 'b'};\nstruct test *t2 = (void *) (((char *) obj) + sizeof(struct test) + sizeof(char[2])); // non conforming \n</code></pre>\n\n<p>What is the conforming way of doing so?</p>\n"}, {"tags": ["c", "linux", "security", "gdb", "ctf"], "comments": [{"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1554319478, "post_id": 55502579, "comment_id": 97711874, "body": "I don&#39;t think this is a real question: <i>&quot;... is this code seems to be unbreakable?&quot;</i> Or maybe, it is not a good fit at Stack Overflow. You should probably use another site on the <a href=\"https://stackexchange.com/sites\">Stack Exchange network</a> for this question."}, {"owner": {"reputation": 100758, "user_id": 1899640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47374ccb28e4b0d2454b64f7b975bc66?s=128&d=identicon&r=PG", "display_name": "that other guy", "link": "https://stackoverflow.com/users/1899640/that-other-guy"}, "edited": false, "score": 1, "creation_date": 1554319517, "post_id": 55502579, "comment_id": 97711885, "body": "Plenty of ways. <code>&#47;bin&#47;ls\\nsh</code> and <code>&#47;bin&#47;ls $(sh &#47;tmp&#47;myscript)</code> are a few"}, {"owner": {"reputation": 9, "user_id": 11307571, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-jnO9ge2VK2Q/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re-s-0yBV6VCJId8jgsYO0Uzw_3tA/mo/photo.jpg?sz=128", "display_name": "Xarath", "link": "https://stackoverflow.com/users/11307571/xarath"}, "reply_to_user": {"reputation": 100758, "user_id": 1899640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47374ccb28e4b0d2454b64f7b975bc66?s=128&d=identicon&r=PG", "display_name": "that other guy", "link": "https://stackoverflow.com/users/1899640/that-other-guy"}, "edited": false, "score": 0, "creation_date": 1554322028, "post_id": 55502579, "comment_id": 97713167, "body": "@thatotherguy thanks for your reply. I tried both your comment, afraid not work:( The vulnerable program has permission -r-xr-sr-x 1 user levX, where levX is the privileged group name with &#39;s&#39; flag enabled (but &#39;user&#39; is not one of this group). So when I run the vulnerable program, s flag could temporarily set my gid to levX then run sh. But if I use $, the program would be like run sh in cmd line, which is only under my uid and gid. And &quot;/bin/ls\\nsh&quot; doesn&#39;t work as well, output: &quot;/bin/ls: cannot access sh: No such file or directory&quot;."}, {"owner": {"reputation": 100758, "user_id": 1899640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47374ccb28e4b0d2454b64f7b975bc66?s=128&d=identicon&r=PG", "display_name": "that other guy", "link": "https://stackoverflow.com/users/1899640/that-other-guy"}, "edited": false, "score": 0, "creation_date": 1554322825, "post_id": 55502579, "comment_id": 97713546, "body": "@Xarath <code>system(..)</code> will invoke a shell with the privileges of the current process, and that includes any <code>$(..)</code>s. You need to make sure you pass them unexpanded though. As for <code>&#47;bin&#47;ls\\nsh</code>, you are somehow instead running <code>&#47;bin&#47;ls sh</code>. I don&#39;t know if this is because the program filters <code>\\n</code> in addition to the list you provided, or because the linefeed got mangled by your invocation or something else. Please give the exact commands you use to test."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1554324757, "post_id": 55502579, "comment_id": 97714377, "body": "Try: <code>&#47;bin&#47;ls $(exec &#47;bin&#47;sh)</code>. This worked for me on a network router."}, {"owner": {"reputation": 9, "user_id": 11307571, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-jnO9ge2VK2Q/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re-s-0yBV6VCJId8jgsYO0Uzw_3tA/mo/photo.jpg?sz=128", "display_name": "Xarath", "link": "https://stackoverflow.com/users/11307571/xarath"}, "reply_to_user": {"reputation": 100758, "user_id": 1899640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47374ccb28e4b0d2454b64f7b975bc66?s=128&d=identicon&r=PG", "display_name": "that other guy", "link": "https://stackoverflow.com/users/1899640/that-other-guy"}, "edited": false, "score": 0, "creation_date": 1554332430, "post_id": 55502579, "comment_id": 97716915, "body": "@thatotherguy I use <code>.&#47;program `perl -e &#39;print &quot;\\nsh&quot;&#39;`</code>, and also tried <code>.&#47;program \\\\nsh</code>, <code>.&#47;program \\nsh</code>"}, {"owner": {"reputation": 100758, "user_id": 1899640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47374ccb28e4b0d2454b64f7b975bc66?s=128&d=identicon&r=PG", "display_name": "that other guy", "link": "https://stackoverflow.com/users/1899640/that-other-guy"}, "edited": false, "score": 0, "creation_date": 1554332688, "post_id": 55502579, "comment_id": 97716969, "body": "@Xarath That won&#39;t work because the lack of quotes is causing the linefeed to be stripped. You can use <code>.&#47;program &quot;`perl -e &#39;print &quot;\\nsh&quot;&#39;`&quot;</code> or more directly <code>.&#47;program $&#39;\\nsh&#39;</code> in bash (but not in dash), or alternatively, write <code>.&#47;program &#39;foo</code>, then press enter on the prompt to insert a literal linefeed and continue the command on the next line, then <code>sh&#39;</code>"}, {"owner": {"reputation": 9, "user_id": 11307571, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-jnO9ge2VK2Q/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re-s-0yBV6VCJId8jgsYO0Uzw_3tA/mo/photo.jpg?sz=128", "display_name": "Xarath", "link": "https://stackoverflow.com/users/11307571/xarath"}, "reply_to_user": {"reputation": 100758, "user_id": 1899640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47374ccb28e4b0d2454b64f7b975bc66?s=128&d=identicon&r=PG", "display_name": "that other guy", "link": "https://stackoverflow.com/users/1899640/that-other-guy"}, "edited": false, "score": 0, "creation_date": 1554337154, "post_id": 55502579, "comment_id": 97717981, "body": "@thatotherguy ohhhhh yeas! man, thank you so much!!"}], "owner": {"reputation": 9, "user_id": 11307571, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-jnO9ge2VK2Q/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re-s-0yBV6VCJId8jgsYO0Uzw_3tA/mo/photo.jpg?sz=128", "display_name": "Xarath", "link": "https://stackoverflow.com/users/11307571/xarath"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1554340926, "creation_date": 1554318454, "last_edit_date": 1554340926, "question_id": 55502579, "link": "https://stackoverflow.com/questions/55502579/does-this-code-that-contains-system-bin-ls-seems-unbreakable", "title": "Does this code that contains system(&quot;/bin/ls&quot;) seems unbreakable?", "body": "<p>I'm doing some ctf-like homework. It's to make a privileged program run /bin/sh. There's no source code, only works on binary assembly.</p>\n\n<p>The program normally pass <code>\"/bin/ls %s\"</code> (stored at 0x804868f) to snprintf with argv[1]. \nSo the output of snprintf (@main+222) would be sth like <code>/bin/ls ~/</code>. \nThen pass \"<code>/bin/ls ~/</code>\" to a system call (@main+236), like system(<code>/bin/ls ~/</code>).</p>\n\n<p>The program filtered out some cmd line symbol by using strchr(e.g. @main+85), which are <code>&amp;</code>, <code>|</code> and <code>;</code>. </p>\n\n<p>So I think you can't make the command become <code>/bin/ls ;sh</code> since it contains <strong>;</strong>, for example.</p>\n\n<p>My question is:\nIs this code seems to be unbreakable? Or how can we change the input to make the program run 'sh'. </p>\n\n<p>Thanks in advance.</p>\n\n<p>(also, I have no permission to modify /bin/ls)</p>\n\n<p>Here's the code:</p>\n\n<pre><code>  0x08048454 &lt;+0&gt;: push   %ebp\n  0x08048455 &lt;+1&gt;: mov    %esp,%ebp\n  0x08048457 &lt;+3&gt;: sub    $0x428,%esp\n  0x0804845d &lt;+9&gt;: and    $0xfffffff0,%esp\n  0x08048460 &lt;+12&gt;:    mov    $0x0,%eax\n  0x08048465 &lt;+17&gt;:    sub    %eax,%esp\n  0x08048467 &lt;+19&gt;:    mov    0xc(%ebp),%eax\n  0x0804846a &lt;+22&gt;:    add    $0x4,%eax\n  0x0804846d &lt;+25&gt;:    cmpl   $0x0,(%eax)\n  0x08048470 &lt;+28&gt;:    jne    0x8048496 &lt;main+66&gt;\n  0x08048472 &lt;+30&gt;:    movl   $0x8048674,0x4(%esp)\n  0x0804847a &lt;+38&gt;:    mov    0x80497ac,%eax\n  0x0804847f &lt;+43&gt;:    mov    %eax,(%esp)\n  0x08048482 &lt;+46&gt;:    call   0x8048348 &lt;fprintf@plt&gt;\n  0x08048487 &lt;+51&gt;:    movl   $0xffffffff,-0x40c(%ebp)\n  0x08048491 &lt;+61&gt;:    jmp    0x804854f &lt;main+251&gt;\n  0x08048496 &lt;+66&gt;:    mov    0xc(%ebp),%eax\n  0x08048499 &lt;+69&gt;:    add    $0x4,%eax\n  0x0804849c &lt;+72&gt;:    movl   $0x3b,0x4(%esp)\n  0x080484a4 &lt;+80&gt;:    mov    (%eax),%eax\n  0x080484a6 &lt;+82&gt;:    mov    %eax,(%esp)\n  0x080484a9 &lt;+85&gt;:    call   0x8048338 &lt;strchr@plt&gt;\n  0x080484ae &lt;+90&gt;:    test   %eax,%eax\n  0x080484b0 &lt;+92&gt;:    jne    0x80484ec &lt;main+152&gt;\n  0x080484b2 &lt;+94&gt;:    mov    0xc(%ebp),%eax\n  0x080484b5 &lt;+97&gt;:    add    $0x4,%eax\n  0x080484b8 &lt;+100&gt;:   movl   $0x7c,0x4(%esp)\n  0x080484c0 &lt;+108&gt;:   mov    (%eax),%eax\n  0x080484c2 &lt;+110&gt;:   mov    %eax,(%esp)\n  0x080484c5 &lt;+113&gt;:   call   0x8048338 &lt;strchr@plt&gt;\n  0x080484ca &lt;+118&gt;:   test   %eax,%eax\n  0x080484cc &lt;+120&gt;:   jne    0x80484ec &lt;main+152&gt;\n  0x080484ce &lt;+122&gt;:   mov    0xc(%ebp),%eax\n  0x080484d1 &lt;+125&gt;:   add    $0x4,%eax\n  0x080484d4 &lt;+128&gt;:   movl   $0x26,0x4(%esp)\n  0x080484dc &lt;+136&gt;:   mov    (%eax),%eax\n  0x080484de &lt;+138&gt;:   mov    %eax,(%esp)\n  0x080484e1 &lt;+141&gt;:   call   0x8048338 &lt;strchr@plt&gt;\n  0x080484e6 &lt;+146&gt;:   test   %eax,%eax\n  0x080484e8 &lt;+148&gt;:   jne    0x80484ec &lt;main+152&gt;\n  0x080484ea &lt;+150&gt;:   jmp    0x804850d &lt;main+185&gt;\n  0x080484ec &lt;+152&gt;:   movl   $0x804867c,0x4(%esp)\n  0x080484f4 &lt;+160&gt;:   mov    0x80497ac,%eax\n  0x080484f9 &lt;+165&gt;:   mov    %eax,(%esp)\n  0x080484fc &lt;+168&gt;:   call   0x8048348 &lt;fprintf@plt&gt;\n  0x08048501 &lt;+173&gt;:   movl   $0xffffffff,-0x40c(%ebp)\n  0x0804850b &lt;+183&gt;:   jmp    0x804854f &lt;main+251&gt;\n  0x0804850d &lt;+185&gt;:   mov    0xc(%ebp),%eax\n  0x08048510 &lt;+188&gt;:   add    $0x4,%eax\n  0x08048513 &lt;+191&gt;:   mov    (%eax),%eax\n  0x08048515 &lt;+193&gt;:   mov    %eax,0xc(%esp)\n  0x08048519 &lt;+197&gt;:   movl   $0x804868f,0x8(%esp)\n  0x08048521 &lt;+205&gt;:   movl   $0x400,0x4(%esp)\n  0x08048529 &lt;+213&gt;:   lea    -0x408(%ebp),%eax\n  0x0804852f &lt;+219&gt;:   mov    %eax,(%esp)\n  0x08048532 &lt;+222&gt;:   call   0x8048378 &lt;snprintf@plt&gt;\n  0x08048537 &lt;+227&gt;:   lea    -0x408(%ebp),%eax\n  0x0804853d &lt;+233&gt;:   mov    %eax,(%esp)\n  0x08048540 &lt;+236&gt;:   call   0x8048358 &lt;system@plt&gt;\n  0x08048545 &lt;+241&gt;:   movl   $0x0,-0x40c(%ebp)\n  0x0804854f &lt;+251&gt;:   mov    -0x40c(%ebp),%eax\n  0x08048555 &lt;+257&gt;:   leave  \n  0x08048556 &lt;+258&gt;:   ret  \n</code></pre>\n"}, {"tags": ["c", "multithreading", "semaphore"], "answers": [{"comments": [{"owner": {"reputation": 138, "user_id": 9430751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ea1e5ff3981867a51794ec334c0cd8c?s=128&d=identicon&r=PG&f=1", "display_name": "Atizs", "link": "https://stackoverflow.com/users/9430751/atizs"}, "edited": false, "score": 0, "creation_date": 1554318891, "post_id": 55502618, "comment_id": 97711605, "body": "You are right, my bad. Santa should release them. But how do I release 2 out of 3?"}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "reply_to_user": {"reputation": 138, "user_id": 9430751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ea1e5ff3981867a51794ec334c0cd8c?s=128&d=identicon&r=PG&f=1", "display_name": "Atizs", "link": "https://stackoverflow.com/users/9430751/atizs"}, "edited": false, "score": 0, "creation_date": 1554326029, "post_id": 55502618, "comment_id": 97714853, "body": "@Atizs ah sure that change the bahavior ;-) Can you add the rest of code ? How much <i>collectingElf</i> threads there are ? Why the second parameter in <code>void *collectingElf(void *arg, int semaphoreIndex)</code> ? How much elves, 9 ?"}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "reply_to_user": {"reputation": 138, "user_id": 9430751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ea1e5ff3981867a51794ec334c0cd8c?s=128&d=identicon&r=PG&f=1", "display_name": "Atizs", "link": "https://stackoverflow.com/users/9430751/atizs"}, "edited": false, "score": 0, "creation_date": 1554326651, "post_id": 55502618, "comment_id": 97715063, "body": "@Atizs where <i>collectingElveCount</i> is modified ? I think you need to post all your code ... (and me to sleep)"}], "tags": [], "owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "is_accepted": false, "score": 0, "last_activity_date": 1554318605, "creation_date": 1554318605, "answer_id": 55502618, "question_id": 55502461, "link": "https://stackoverflow.com/questions/55502461/unique-semaphore-for-each-thread/55502618#55502618", "title": "Unique semaphore for each thread", "body": "<p>I do not understand your management of semaphore</p>\n\n<p>In</p>\n\n<pre><code>void *collectingElf(void *arg, int semaphoreIndex) {\n    while (1) {\n        ...\n        sem_wait(&amp;collectingElveSem);\n    }\n}\n</code></pre>\n\n<p>that gets but never releases <code>collectingElveSem</code>, and that in an infinite loop ?</p>\n\n<p>In</p>\n\n<pre><code>void *workingElf(void *arg)                             //same as collecting elf\n{\n    while (1) {\n        sem_wait(&amp;elveCountMutex);\n        ...\n        sem_wait(&amp;workElfSem);\n    }\n}\n</code></pre>\n\n<p>that get but never release <code>elveCountMutex</code> and <code>workElfSem</code>, and that in an infinite loop. <code>collectingElf</code> also (try to) get <code>elveCountMutex</code> but I will not able to do after one turn in <code>workingElf</code></p>\n\n<p>If your semaphore are not recursive <code>workingElf</code> will also be blocked after one turn because not able to get again the semaphores. If the semaphore are recursive this cannot be for an infinite deep and <code>workingElf</code> will block itself after enough loops</p>\n"}], "owner": {"reputation": 138, "user_id": 9430751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ea1e5ff3981867a51794ec334c0cd8c?s=128&d=identicon&r=PG&f=1", "display_name": "Atizs", "link": "https://stackoverflow.com/users/9430751/atizs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 122, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1554324619, "creation_date": 1554317912, "last_edit_date": 1554324619, "question_id": 55502461, "link": "https://stackoverflow.com/questions/55502461/unique-semaphore-for-each-thread", "title": "Unique semaphore for each thread", "body": "<p>I have been assigned a modified version of the \"Santa Claus\" semaphore problem.\n<strong>Santa Claus</strong> is a thread that randomly wakes up to check how many and what kind of threads are waiting to report to him (<strong>Work elves</strong> and <strong>Collecting elves</strong>)</p>\n\n<p>What I have made are <strong>work elf</strong> and <strong>collecting elf</strong> threads:</p>\n\n<pre><code>void *collectingElf(void *arg, int semaphoreIndex) {\n    while (1) {\n        sem_wait(&amp;elveCountMutex);                          //semaphore for critical section, the number of elves\n        printf(\"\\nCollecting! %d\\n\", (int) pthread_self()); // thread is collecting stuff\n        sleep((unsigned int) (rand() % 4));                           // thread sleeps for a random amount of time\n\n        printf(\"Done collecting! %d\\n\", (int) pthread_self());    // Print process ID, just for easier tracking\n        sem_post(&amp;elveCountMutex);                            // Release the elve count semaphore\n        sem_wait(&amp;collectingElveSem);\n\n    }\n}\n\nvoid *workingElf(void *arg)                             //same as collecting elf\n{\n    while (1) {\n        sem_wait(&amp;elveCountMutex);\n        printf(\"\\nWorking! %d\\n\", pthread_self());\n        sleep(1);\n        workingElveCount++;\n        printf(\"Done working! %d\\n\", pthread_self());\n        sem_wait(&amp;workElfSem);\n        sem_post(&amp;elveCountMutex);\n    }\n}\n</code></pre>\n\n<p>So here the elve counts are protected, since the threads can only access the counters when <strong>elveCountMutex</strong> is locked. This I can understand and this seems logical. Afterwards the thread should block and wait for <strong>Santa</strong> to unblock it. \nSo, from what I read, once semaphore reaches value 0, thread will block. Anything above 0 will not block it, and negative value indicates how many threads are waiting for the semaphore to be unlocked.</p>\n\n<p>So, once the threads running are finished, they decrement the semaphore, and block.</p>\n\n<p>However, what I cannot seem to grasp is this part of the assignment:</p>\n\n<p>For a collecting meeting to start, at least one <strong>work elf</strong> and three <strong>collecting elves</strong> are necessary. \u2022 If enough elves are present that both meetings could start, the collecting-meeting\nalways has priority, and <strong>all work-elves not needed anymore resume their work</strong>.</p>\n\n<p>Say if I have 3 work elves, and I need only 1, how do I release the remaining 2 threads? Do I need a separate semaphore for each thread? Or am I missing something?</p>\n\n<p>Edit: My bad, I completely forgot to tell about the <strong>Santa</strong> implementation.\n<strong>Santa</strong> wakes up and releases the semaphores, in this way:</p>\n\n<pre><code>void* Santa(void *arg)\n{\n   while (1) {\n      sleep((unsigned)rand() % 4);                                  //Santa sleeps randomly between 0 and 3 seconds;\n      sem_wait(&amp;elveCountMutex);                                      //access both elf counters\n      if(workingElveCount&gt;=2 &amp;&amp; collectingElveCount &gt;= 3)            //decide which meeting should commence\n      {\n         int releaseWorkElveCount = workingElveCount-1;\n         for(int i = 0;i&lt;releaseWorkElveCount;i++)\n         {\n            sem_post(&amp;workElfSem);\n         }\n         sleep(5);\n         collectingMeeting(&amp;collectingMeetingThread);                //This just prints that we are in a collecting meeting \n         pthread_join(collectingMeetingThread,0);\n         sem_wait(&amp;elveCountMutex);\n         for(int i=0;i&lt;workingElveCount;i++)\n         {\n             sem_post(&amp;workElfSem);\n         }\n         for(int i=0;i&lt;collectingElveCount;i++)\n         {\n             sem_post(&amp;collectingElveSem);\n         }\n         workingElveCount=0;\n         collectingElveCount=0;\n      }\n   }\n</code></pre>\n"}, {"tags": ["c", "linux", "pipe", "fork", "execvp"], "comments": [{"owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 2, "creation_date": 1554316823, "post_id": 55502099, "comment_id": 97710603, "body": "<code>I read here on stack overflow that &quot;Open file descriptors are preserved across a call to exec.&quot;</code> Thats true, but this doesn&#39;t mean your variable <code>writerfp</code> magically appears in a completely unrelated program. The easiest way would be to dup the handle to stdout."}], "answers": [{"comments": [{"owner": {"reputation": 117, "user_id": 7358864, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211730363637488/picture?type=large", "display_name": "Viktor Karsakov", "link": "https://stackoverflow.com/users/7358864/viktor-karsakov"}, "edited": false, "score": 0, "creation_date": 1554317609, "post_id": 55502228, "comment_id": 97711022, "body": "got it, thanks! I will also read about dup in the man page. thanks again :-)"}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 4, "last_activity_date": 1554317091, "creation_date": 1554317091, "answer_id": 55502228, "question_id": 55502099, "link": "https://stackoverflow.com/questions/55502099/how-to-use-a-file-descriptor-in-a-child-process-after-execvp/55502228#55502228", "title": "how to use a file descriptor in a child process after execvp?", "body": "<p>Open file descriptors are preserved when you call an <code>exec</code> function.  What is <em>not</em> preserved are the names of any variables used to store them.</p>\n\n<p>You need to duplicate the file descriptor to a known file descriptor number that the other program can reference.  Since the child process is writing, you should copy the child end of the pipe to file descriptor 1, which is stdout:</p>\n\n<pre><code>int pipefds[2];\npipe(pipefds);\nint readerfd = pipefds[0];\nint writerfd = pipefds[1];\n\nif(pid == 0){\n    // Child\n        close(readerfd);\n        dup2(writerfd, 1);\n        execvp(\"./proc2\",NULL);\n}\n</code></pre>\n\n<p>Then proc2 can write to file descriptor 1:</p>\n\n<pre><code>write(1, msg, msg_len);\n</code></pre>\n\n<p>Or, if the message is a string, just use <code>printf</code></p>\n\n<pre><code>printf(\"%s\", msg);\nfflush(stdout);\n</code></pre>\n"}], "owner": {"reputation": 117, "user_id": 7358864, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211730363637488/picture?type=large", "display_name": "Viktor Karsakov", "link": "https://stackoverflow.com/users/7358864/viktor-karsakov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 755, "favorite_count": 0, "accepted_answer_id": 55502228, "answer_count": 1, "score": 2, "last_activity_date": 1554317091, "creation_date": 1554316649, "last_edit_date": 1554316919, "question_id": 55502099, "link": "https://stackoverflow.com/questions/55502099/how-to-use-a-file-descriptor-in-a-child-process-after-execvp", "title": "how to use a file descriptor in a child process after execvp?", "body": "<p>I am trying to open a child process using fork(), and then execvp()-ing into another program.\nI also want the parent process and the child process to communicate with each other using a pipe.</p>\n\n<p>here is the parent process - </p>\n\n<pre><code>int pipefds[2];\npipe(pipefds); // In original code I check for errors...\nint readerfd = pipefds[0];\nint writerfd = pipefds[1];\n\nif(pid == 0){\n    // Child\n    close(readerfd);\n        execvp(\"./proc2\",NULL);\n}\n\n\n</code></pre>\n\n<p>in the program 'proc2' I am trying to access the writerfd in the following way-</p>\n\n<pre><code>write(writerfd, msg, msg_len);\n\n</code></pre>\n\n<p>but instead, I get a compilation time error -\n\"error: \u2018writerfd\u2019 undeclared (first use in this function);\"</p>\n\n<p>why is that? I read here on stack overflow that \"Open file descriptors are preserved across a call to exec.\" <a href=\"https://stackoverflow.com/questions/22241000/does-exec-preserve-file-descriptors\">link</a>. should't I be able to reach writerfd if that is so?</p>\n\n<p>how can I write to that file descriptor on the child process after using execvp? what is the correct way to do this and where can I read about the answer (I looked but I didn't find..)?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1554316302, "post_id": 55501953, "comment_id": 97710338, "body": "They do it with a cast: <a href=\"https://opensource.apple.com/source/BerkeleyDB/BerkeleyDB-18/db/clib/strchr.c.auto.html\" rel=\"nofollow noreferrer\">opensource.apple.com/source/BerkeleyDB/BerkeleyDB-18/db/clib&zwnj;&#8203;/&hellip;</a>"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1554316560, "post_id": 55501953, "comment_id": 97710484, "body": "Why is <code>strchr</code> defined this way?  If it returns a pointer to an element of <code>str</code> it <i>should</i> return a <code>const char *</code>.  It looks like it&#39;s been this way since at least C89."}], "answers": [{"tags": [], "owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "is_accepted": true, "score": 0, "last_activity_date": 1554316940, "creation_date": 1554316940, "answer_id": 55502185, "question_id": 55501953, "link": "https://stackoverflow.com/questions/55501953/how-to-fix-return-discards-const-qualifier-from-pointer-target-type-in-c/55502185#55502185", "title": "How to fix &#39;return discards \u2018const\u2019 qualifier from pointer target type&#39; in C", "body": "<p>A few notes:</p>\n\n<ol>\n<li>Since you can't change the prototype you must cast away the const in the <code>return</code>: <code>return (char *) &amp;str[idx];</code>.</li>\n<li>Your implementation has a bug, consider happens if <code>strchr(\"\", 'a')</code> is called. You increment <code>idx</code> inside the body of the loop, before NUL-checking so it will step beyond the end of the string.</li>\n</ol>\n"}], "owner": {"reputation": 11, "user_id": 11155415, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-2S3OBpGv6QQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rebHVb8w-WMk2rEcyGwo391CwFZoA/mo/photo.jpg?sz=128", "display_name": "Ben deVries", "link": "https://stackoverflow.com/users/11155415/ben-devries"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "accepted_answer_id": 55502185, "answer_count": 1, "score": -1, "last_activity_date": 1554316940, "creation_date": 1554316126, "question_id": 55501953, "link": "https://stackoverflow.com/questions/55501953/how-to-fix-return-discards-const-qualifier-from-pointer-target-type-in-c", "title": "How to fix &#39;return discards \u2018const\u2019 qualifier from pointer target type&#39; in C", "body": "<p>Working to re-write the strchr method defined in string.h.\nAnd i am getting \"return discards \u2018const\u2019 qualifier from pointer target type\"</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>char* strchr(const char* str, int character){\n        int idx = 0;\n        do{\n                if (str[idx] == character){\n                        return &amp;str[idx]; // This line has the error\n                }\n                idx++;\n        } while (str[idx] != '\\0');\n\n        return NULL;\n} // any help would be great, thanks.\n</code></pre>\n"}, {"tags": ["c"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11307345, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-BNGL5cqJSDk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re-7OX8Pg6HguGpKMcEQ1R6NOMcGg/mo/photo.jpg?sz=128", "display_name": "AstroBoy", "link": "https://stackoverflow.com/users/11307345/astroboy"}, "edited": false, "score": 0, "creation_date": 1554317741, "post_id": 55501882, "comment_id": 97711067, "body": "what about the first line where n is given? and don&#39;t i need some sort of a cycle to store each row of every column to an element of the array?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 1, "user_id": 11307345, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-BNGL5cqJSDk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re-7OX8Pg6HguGpKMcEQ1R6NOMcGg/mo/photo.jpg?sz=128", "display_name": "AstroBoy", "link": "https://stackoverflow.com/users/11307345/astroboy"}, "edited": false, "score": 0, "creation_date": 1554317795, "post_id": 55501882, "comment_id": 97711085, "body": "I am not providing complete code for you, but showing you how to read using <code>fscanf</code>. You can use a different loop to suit the task conditions."}, {"owner": {"reputation": 1, "user_id": 11307345, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-BNGL5cqJSDk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re-7OX8Pg6HguGpKMcEQ1R6NOMcGg/mo/photo.jpg?sz=128", "display_name": "AstroBoy", "link": "https://stackoverflow.com/users/11307345/astroboy"}, "edited": false, "score": 0, "creation_date": 1554317947, "post_id": 55501882, "comment_id": 97711147, "body": "thank you really but that is my main problem is that I don&#39;t seem to understand how to write a code for specifically this situation"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 1, "user_id": 11307345, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-BNGL5cqJSDk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re-7OX8Pg6HguGpKMcEQ1R6NOMcGg/mo/photo.jpg?sz=128", "display_name": "AstroBoy", "link": "https://stackoverflow.com/users/11307345/astroboy"}, "edited": false, "score": 0, "creation_date": 1554318025, "post_id": 55501882, "comment_id": 97711186, "body": "I&#39;m sorry, you must best consult a C tutorial course. That&#39;s not the aim of this site. You might benefit by reading the <a href=\"https://stackoverflow.com/tour\">tour</a> and <a href=\"https://stackoverflow.com/help/how-to-ask\">How do I ask a good question?</a>"}, {"owner": {"reputation": 1, "user_id": 11307345, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-BNGL5cqJSDk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re-7OX8Pg6HguGpKMcEQ1R6NOMcGg/mo/photo.jpg?sz=128", "display_name": "AstroBoy", "link": "https://stackoverflow.com/users/11307345/astroboy"}, "edited": false, "score": 0, "creation_date": 1554318159, "post_id": 55501882, "comment_id": 97711263, "body": "yeah sorry first timer here! I will check some tutorials and thanks for the help!"}], "tags": [], "owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "is_accepted": false, "score": 0, "last_activity_date": 1554315940, "creation_date": 1554315940, "answer_id": 55501882, "question_id": 55501714, "link": "https://stackoverflow.com/questions/55501714/how-to-read-tables-from-dat-file-in-c/55501882#55501882", "title": "How to read tables from .dat file in C", "body": "<p>If the advice is to use <code>fscanf</code> you can open the file and then use a loop such as </p>\n\n<pre><code>double varA, varB, varC;\nwhile(fscanf(fil, \"%lf%lf%lf\", &amp;varA, &amp;varB, &amp;varC) == 3) {\n    // ...\n}\n</code></pre>\n\n<p>Another way preferred by some is</p>\n\n<pre><code>char str[100];\ndouble varA, varB, varC;\nwhile(fgets(str, sizeof str, fil) != NULL) {\n    if (sscanf(str, \"%lf%lf%lf\", &amp;varA, &amp;varB, &amp;varC) != 3) {\n        break;\n    }\n    // ...\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11307345, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-BNGL5cqJSDk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re-7OX8Pg6HguGpKMcEQ1R6NOMcGg/mo/photo.jpg?sz=128", "display_name": "AstroBoy", "link": "https://stackoverflow.com/users/11307345/astroboy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 149, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1554315940, "creation_date": 1554315382, "question_id": 55501714, "link": "https://stackoverflow.com/questions/55501714/how-to-read-tables-from-dat-file-in-c", "title": "How to read tables from .dat file in C", "body": "<p>I need to read a table from a .dat (ASCII) file that contains 3 columns with the number of rows being the first line in the .dat file and then store each column in separate array. I was advised to use fscanf but i dont know how!</p>\n\n<pre><code>//this is the .dat file (ASCII format)\ninname.dat \n</code></pre>\n\n<pre><code>//n -this is the first line in the .dat file and it represents number of rows in the table\n2000 \n</code></pre>\n\n<pre><code>//these are the different columns, each of which should be stored in\n//a separate  array x[n],y[n],y[n]\n</code></pre>\n\n<pre><code>-0.9210340500E+01  -0.1642608881E+01   0.1000000000E+01\n-0.9204236984E+01  -0.1645367146E+01   0.1000000000E+01\n-0.9198134422E+01  -0.1648124933E+01   0.1000000000E+01\n-0.9192030907E+01  -0.1650882006E+01   0.1000000000E+01\n-0.9185928345E+01  -0.1653640866E+01   0.1000000000E+01\n-0.9179824829E+01  -0.1656393051E+01   0.1000000000E+01\n-0.9173722267E+01  -0.1659148812E+01   0.1000000000E+01\n-0.9167618752E+01  -0.1661900759E+01   0.1000000000E+01\n-0.9161516190E+01  -0.1664654970E+01   0.1000000000E+01\n-0.9155412674E+01  -0.1667405009E+01   0.1000000000E+01\n-0.9149310112E+01  -0.1670155764E+01   0.1000000000E+01\n-0.9143207550E+01  -0.1672905326E+01   0.1000000000E+01\n-0.9137104034E+01  -0.1675654054E+01   0.1000000000E+01\n</code></pre>\n"}, {"tags": ["c", "sqlite"], "comments": [{"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1554312768, "post_id": 55500839, "comment_id": 97708601, "body": "Yes, its expected, there is no direct correlation between the actual size of the data itself and the size of the file on disk. Deleting a row will mark that region of the file as &quot;free&quot; for use in the future - if this were not the case the file would need to be reorganized &amp; rewritten on every change. The <a href=\"https://www.sqlite.org/lang_vacuum.html\" rel=\"nofollow noreferrer\">vacuum</a> command explains this further. (That&#39;s not to say you should vacuum to mitigate this)"}, {"owner": {"reputation": 9, "user_id": 10026150, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-VUjX6_ANWs0/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7rzXtEmq_YmMdQqODYyKhbdXNAVMg/mo/photo.jpg?sz=128", "display_name": "michbens", "link": "https://stackoverflow.com/users/10026150/michbens"}, "reply_to_user": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1554356655, "post_id": 55500839, "comment_id": 97722434, "body": "I&#39;m not talking about the file size. I&#39;m saying that to add a new row in the database, let&#39;s say 100 bytes, when the DB is full, some times removing 100 bytes is enough, but sometimes I have to remove 3000 or 5000 bytes."}, {"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1554373578, "post_id": 55500839, "comment_id": 97731919, "body": "But by &quot;DB is full&quot; you mean its file size is at some upper limit?"}, {"owner": {"reputation": 9, "user_id": 10026150, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-VUjX6_ANWs0/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7rzXtEmq_YmMdQqODYyKhbdXNAVMg/mo/photo.jpg?sz=128", "display_name": "michbens", "link": "https://stackoverflow.com/users/10026150/michbens"}, "reply_to_user": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1554629322, "post_id": 55500839, "comment_id": 97815505, "body": "Yes I limited the file size with pragma max_page_count"}], "owner": {"reputation": 9, "user_id": 10026150, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-VUjX6_ANWs0/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7rzXtEmq_YmMdQqODYyKhbdXNAVMg/mo/photo.jpg?sz=128", "display_name": "michbens", "link": "https://stackoverflow.com/users/10026150/michbens"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1554312085, "creation_date": 1554312085, "question_id": 55500839, "link": "https://stackoverflow.com/questions/55500839/sqlite-need-to-delete-more-than-one-row-to-add-a-new-row-when-database-is-full", "title": "sqlite - need to delete more than one row to add a new row when database is full", "body": "<p>When I try to insert new data to a full SQLite database, I need to remove much more than really needed.\nI'm doing the following:</p>\n\n<pre><code>while(1) {\n    do {\n        status = insert_1_row_to_db();\n        if (status == full) {\n            remove_one_row_from_db();\n        }\n    } while (status == full);\n}\n</code></pre>\n\n<p>The inserted data has always the same size.\nWhen the database is full, removing only one row is enough to insert the new one. But after a while, I need to remove 30, 40 and even more the 100 rows to be able to insert one new row.\nIs it the correct behavior of SQLite?\nIs there a way to remove only what is needed and no more?\nThanks</p>\n"}, {"tags": ["c", "linux"], "comments": [{"owner": {"reputation": 596, "user_id": 789371, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a6a8d60cf810d14224154d35a1854aaf?s=128&d=identicon&r=PG", "display_name": "nulleight", "link": "https://stackoverflow.com/users/789371/nulleight"}, "edited": false, "score": 0, "creation_date": 1554310514, "post_id": 55500369, "comment_id": 97707518, "body": "You could use socketpair to send the child the pointer to array, where it has to build its subtree. See <a href=\"https://gist.github.com/yinyin/0682a957450f7abb7f76603da2d3b8d5\" rel=\"nofollow noreferrer\">gist.github.com/yinyin/0682a957450f7abb7f76603da2d3b8d5</a> for socketpair example.  Then if you are the parent, send the child the pointer of the &amp;nums[childOffset] and remaining length (size of array - childOffset)."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 1, "creation_date": 1554311661, "post_id": 55500369, "comment_id": 97708083, "body": "Did the compiler warn you about excess initializers in <code>int nums[6] = { 2,1,3,0,0,0,0 };</code>?"}, {"owner": {"reputation": 45158, "user_id": 391531, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/04bbaf6d73be76d81b13f2e150017691?s=128&d=identicon&r=PG", "display_name": "nmichaels", "link": "https://stackoverflow.com/users/391531/nmichaels"}, "edited": false, "score": 1, "creation_date": 1554312397, "post_id": 55500369, "comment_id": 97708453, "body": "Start by clearing out the warnings. Compile with <code>-Wall -Wextra -Werror</code> for less frustration in life."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1554313238, "post_id": 55500369, "comment_id": 97708795, "body": "The code is going to have to step through the <code>nums</code> array carefully, with each process determining which entry it is processing.  The original parent needs to create two processes, and the first needs to know that it is supposed to process <code>nums[1]</code> and the second that it is supposed to process <code>nums[2]</code>.  With more elaborate process hierarchies (<code>int nums[] = { 2, 1, 3, 2, 1, 3, 2, 0, 0, 0, 0, 0, 0, 0, 0 };</code> for example), the third level processes need to know where to find their own entry and how to tell their children to find their entries.  I&#39;ve not worked out the algorithm, but \u2026"}], "answers": [{"tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": false, "score": 2, "last_activity_date": 1554588605, "last_edit_date": 1554588605, "creation_date": 1554588026, "answer_id": 55553844, "question_id": 55500369, "link": "https://stackoverflow.com/questions/55500369/is-there-a-way-to-route-processes-better/55553844#55553844", "title": "Is there a way to route processes better?", "body": "<p>What we need to do is keep track of what process we are within the list and where the children are within the list. The following code shows how to do this.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n#include &lt;unistd.h&gt;\n\n\n#define NumberOf(a) (sizeof (a) / sizeof *(a))\n\n\n/*  Create children for process p.\n\n    In a child, return the number of that child process.\n    In the parent, return -1.\n*/\nstatic int CreateChildren(int NumberOfChildren[], int FirstChild[], int p)\n{\n    //  Create children for process p.\n    printf(\"Process %d has pid %u and parent %u.\\n\",\n        p, (unsigned) getpid(), (unsigned) getppid());\n\n    for (int i = 0; i &lt; NumberOfChildren[p]; ++i)\n    {\n        pid_t pid = fork();\n        if (pid == -1)\n        {\n            perror(\"fork\");\n            exit(EXIT_FAILURE);\n        }\n        if (pid == 0)\n            /*  This is a child process, and it is child i of process p, so\n                its process number is FirstChild[p] + i.  Return that.\n            */\n            return p = FirstChild[p] + i;\n    }\n\n    //  Wait for children to finish.\n    for (int i = 0; i &lt; NumberOfChildren[p]; ++i)\n        wait(0);\n\n    //  Tell caller the parent finished.\n    return -1;\n}\n\n\nint main(void)\n{\n    int NumberOfChildren[] = { 2, 1, 3, 0, 0, 0, 0 };\n\n    size_t N = NumberOf(NumberOfChildren);\n\n    // Check the NumberOfChildren array for consistency.    \n    {\n        int sum = 0;\n        for (size_t n = 0; n &lt; N; ++n)\n        {\n            if (NumberOfChildren[n] &lt; 0)\n            {\n                fprintf(stderr,\n                    \"Error, number of children cannot be negative but is %d.\\n\",\n                    NumberOfChildren[n]);\n                exit(EXIT_FAILURE);\n            }\n            sum += NumberOfChildren[n];\n        }\n\n        if (sum != N-1)\n        {\n            fprintf(stderr,\n                \"Error, the numbers of children sum to %d desecendants \"\n                \"of the root, but array has %zu elements after the root \"\n                \"element.\\n\",\n                sum, N-1);\n            exit(EXIT_FAILURE);\n        }\n    }\n\n    /*  Compile information about the children -- set FirstChild[n] to the\n        index of the element in NumberOfChildren that is for the first child\n        of process n.\n    */\n    int FirstChild[N];\n    {\n        int NextChild = 1;\n        for (int n = 0; n &lt; N; ++n)\n        {\n            FirstChild[n] = NextChild;\n            NextChild += NumberOfChildren[n];\n        }\n    }\n\n    //  This is the root process.  Set p to its index.\n    int p = 0;\n\n    /*  Create children for process p.  When a child is created, it will\n        return its process number, and we will loop to create children for it.\n    */\n    while (p &gt;= 0)\n        p = CreateChildren(NumberOfChildren, FirstChild, p);\n}\n</code></pre>\n\n<p>Sample output:</p>\n\n<pre>\nProcess 0 has pid 2648 and parent 2641.\nProcess 1 has pid 2649 and parent 2648.\nProcess 2 has pid 2650 and parent 2648.\nProcess 3 has pid 2651 and parent 2649.\nProcess 4 has pid 2652 and parent 2650.\nProcess 5 has pid 2653 and parent 2650.\nProcess 6 has pid 2654 and parent 2650.\n</pre>\n"}], "owner": {"reputation": 59, "user_id": 8007970, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/SX18w.jpg?s=128&g=1", "display_name": "monkey.D.Ganga", "link": "https://stackoverflow.com/users/8007970/monkey-d-ganga"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1554588605, "creation_date": 1554310301, "last_edit_date": 1554314142, "question_id": 55500369, "link": "https://stackoverflow.com/questions/55500369/is-there-a-way-to-route-processes-better", "title": "Is there a way to route processes better?", "body": "<p>I try to create a process tree with fork() so that the number of children per parent is in a given array, for example if the array is {2,1,3,0,0,0,0} the tree will look like this:</p>\n\n<pre><code>                |   a   |\n                /       \\\n             | b |     |  c  |\n             /         /  |  \\                 \n          | d |   | e | | f | | g |\n</code></pre>\n\n<p>I am able to create processes and separate the parent process from the child process by checking whether the value returned from fork() is 0.\nAnd I managed to create a process tree, but the tree I manage to create is symmetrical, and not what I really want to build.\nI can not figure out the part of routing processes between siblings,</p>\n\n<p>How can I check for each process separately how many children should create for it, and create for it without creating for the other sibling processes?</p>\n\n<p>This is what i got so far:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>int main() {\n    int nums[7] = { 2,1,3,0,0,0,0 };\n    int pid, pid2;\n    size_t len = sizeof(nums)/sizeof(int);\n    int childs2;\n        printf(\"\\nProcess number %d has pid= %d\\n\", 0, getpid());\n        int childs = 1;\n        while( childs &lt;= nums[0] ) {\n            pid = fork();\n            if (pid == 0 ) {\n                printf(\"Process number %d has pid= %d\\n\", childs, getpid());\n                printf(\"I am Process with pid=%d and my parent pid=%d\\n\", getpid(), getppid());\n                waitpid(getppid());\n                for (int i=1; i&lt;len; i++) {\n                    childs2 = 0;\n                    if (childs2 &lt; nums[i]) {\n                        pid2 = fork();\n                        if (pid2 == 0) {\n                            printf(\"Process number %d has pid= %d\\n\", childs, getpid());\n                            printf(\"I am Process with pid=%d and my parent pid=%d\\n\", getpid(), getppid());\n                            waitpid(getppid());\n                            break;\n                        } else {\n                            wait(NULL);\n                            childs2++;\n                        }\n                    } else {\n                        childs2++;\n                    }\n                }\n                break;\n            } else {\n            wait(NULL);\n            childs++;\n            }\n        }\n    return 0;\n}\n\n</code></pre>\n\n<p>I have to differentiate between the processes to know which process is a leaf and which process is a parent. To do this I need to perform a different action in each process and I can not think of a way to do it, </p>\n\n<p>my output is :</p>\n\n<pre><code>Process number 0 has pid= 98431\nProcess number 1 has pid= 98432\nI am Process with pid=98432 and my parent pid=98431\nProcess number 1 has pid= 98433\nI am Process with pid=98433 and my parent pid=98432\nProcess number 1 has pid= 98434\nI am Process with pid=98434 and my parent pid=98432\nProcess number 2 has pid= 98435\nI am Process with pid=98435 and my parent pid=98431\nProcess number 2 has pid= 98436\nI am Process with pid=98436 and my parent pid=98435\nProcess number 2 has pid= 98437\nI am Process with pid=98437 and my parent pid=98435\n</code></pre>\n\n<p>and the tree is look like:</p>\n\n<pre><code>                |   a   |\n                /       \\\n             | b |      | c |\n             /   \\      /   \\                 \n          | d | | e || f | | g |\n</code></pre>\n\n<p>but i want the output to be:</p>\n\n<pre><code>Process number 0 has pid= 98431\nProcess number 1 has pid= 98432\nI am Process with pid=98432 and my parent pid=98431\nProcess number 2 has pid= 98433\nI am Process with pid=98433 and my parent pid=98431\nProcess number 3 has pid= 98434\nI am Process with pid=98434 and my parent pid=98432\nProcess number 4 has pid= 98435\nI am Process with pid=98435 and my parent pid=98433\nProcess number 5 has pid= 98436\nI am Process with pid=98436 and my parent pid=98433\nProcess number 6 has pid= 98437\nI am Process with pid=98437 and my parent pid=98433\n\n</code></pre>\n\n<p>so the tree will look like:</p>\n\n<pre><code>                |   a   |\n                /       \\\n             | b |     |  c  |\n             /         /  |  \\                 \n          | d |   | e | | f | | g | \n</code></pre>\n\n<p>.</p>\n"}, {"tags": ["python", "c", "gdb"], "answers": [{"comments": [{"owner": {"reputation": 7894, "user_id": 1020139, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e6b113d9e9ab23110a4e5b611bcaad61?s=128&d=identicon&r=PG", "display_name": "Shuzheng", "link": "https://stackoverflow.com/users/1020139/shuzheng"}, "edited": false, "score": 0, "creation_date": 1554316994, "post_id": 55500490, "comment_id": 97710705, "body": "Say, I attach to the process. How would I then send input to the process?"}, {"owner": {"reputation": 45158, "user_id": 391531, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/04bbaf6d73be76d81b13f2e150017691?s=128&d=identicon&r=PG", "display_name": "nmichaels", "link": "https://stackoverflow.com/users/391531/nmichaels"}, "reply_to_user": {"reputation": 7894, "user_id": 1020139, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e6b113d9e9ab23110a4e5b611bcaad61?s=128&d=identicon&r=PG", "display_name": "Shuzheng", "link": "https://stackoverflow.com/users/1020139/shuzheng"}, "edited": false, "score": 0, "creation_date": 1554343643, "post_id": 55500490, "comment_id": 97719282, "body": "If you run something like <code>python generate_lots_of_data.py | .&#47;process-to-debug</code> it&#39;s already got input going to it. If you only want to send input to the process when you&#39;re ready for it, use the fifo approach."}, {"owner": {"reputation": 7894, "user_id": 1020139, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e6b113d9e9ab23110a4e5b611bcaad61?s=128&d=identicon&r=PG", "display_name": "Shuzheng", "link": "https://stackoverflow.com/users/1020139/shuzheng"}, "edited": false, "score": 0, "creation_date": 1554353853, "post_id": 55500490, "comment_id": 97721584, "body": "Thank you - so you cannot interact with the application unless you use a FIFO? (I.e. send input at different points in the execution)"}, {"owner": {"reputation": 45158, "user_id": 391531, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/04bbaf6d73be76d81b13f2e150017691?s=128&d=identicon&r=PG", "display_name": "nmichaels", "link": "https://stackoverflow.com/users/391531/nmichaels"}, "reply_to_user": {"reputation": 7894, "user_id": 1020139, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e6b113d9e9ab23110a4e5b611bcaad61?s=128&d=identicon&r=PG", "display_name": "Shuzheng", "link": "https://stackoverflow.com/users/1020139/shuzheng"}, "edited": false, "score": 0, "creation_date": 1555526224, "post_id": 55500490, "comment_id": 98146495, "body": "If you interact with it directly, you can attach gdb to the running process. For example, you could run <code>cat</code> in one terminal and attach gdb to it in another. Since <code>cat</code> is just sitting there waiting for input, you can manually send it something and watch it get processed. For programmatic output, though, you&#39;ll want a FIFO."}], "tags": [], "owner": {"reputation": 45158, "user_id": 391531, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/04bbaf6d73be76d81b13f2e150017691?s=128&d=identicon&r=PG", "display_name": "nmichaels", "link": "https://stackoverflow.com/users/391531/nmichaels"}, "is_accepted": false, "score": 1, "last_activity_date": 1554310730, "creation_date": 1554310730, "answer_id": 55500490, "question_id": 55500271, "link": "https://stackoverflow.com/questions/55500271/how-to-redirect-stdout-of-a-program-to-stdin-of-a-gdb-debugged-program/55500490#55500490", "title": "How to redirect STDOUT of a program to STDIN of a GDB-debugged program?", "body": "<p>One way is to attach gdb to your already-running process. Find its pid with <code>ps</code> or <code>top</code>. Let's say that it's 37. Then run</p>\n\n<pre><code>(gdb) attach 37\n</code></pre>\n\n<p>That probably won't work for your case with very short run time though. Another approach is to use a <a href=\"https://linux.die.net/man/1/mkfifo\" rel=\"nofollow noreferrer\">fifo</a>.</p>\n\n<pre><code>mkfifo fifo\npython -c 'print(\"Hello World\")' &gt; fifo &amp;\ngdb myprog\nrun &lt; fifo\n</code></pre>\n"}], "owner": {"reputation": 7894, "user_id": 1020139, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e6b113d9e9ab23110a4e5b611bcaad61?s=128&d=identicon&r=PG", "display_name": "Shuzheng", "link": "https://stackoverflow.com/users/1020139/shuzheng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1554318115, "creation_date": 1554309860, "last_edit_date": 1554318115, "question_id": 55500271, "link": "https://stackoverflow.com/questions/55500271/how-to-redirect-stdout-of-a-program-to-stdin-of-a-gdb-debugged-program", "title": "How to redirect STDOUT of a program to STDIN of a GDB-debugged program?", "body": "<p>I normally redirect STDOUT to another program using:</p>\n\n<p><code>python -c 'print(\"HelloWorld\")' | ./myprog</code></p>\n\n<p>I know that I can supply the contents of a file as STDIN for a debugged program in GDB:</p>\n\n<p><code>(gdb) run myprog &lt; input.txt</code></p>\n\n<p>However, how can I do something like:</p>\n\n<p><code>(gdb) run mypprog &lt; python -c 'print(\"HelloWorld\")'</code></p>\n\n<p>without first having to create a file with the output of <code>python -c '...'</code>?</p>\n"}, {"tags": ["c", "opengl", "bresenham", "dda"], "comments": [{"owner": {"reputation": 480272, "user_id": 1968, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd630f72eef3790bfb4ef38d08c7f85?s=128&d=identicon&r=PG", "display_name": "Konrad Rudolph", "link": "https://stackoverflow.com/users/1968/konrad-rudolph"}, "edited": false, "score": 3, "creation_date": 1554310702, "post_id": 55500195, "comment_id": 97707604, "body": "Is there a reason why you\u2019re writing in woefully outdated K&amp;R style instead of a modern style of C?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8704383"}, "reply_to_user": {"reputation": 480272, "user_id": 1968, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd630f72eef3790bfb4ef38d08c7f85?s=128&d=identicon&r=PG", "display_name": "Konrad Rudolph", "link": "https://stackoverflow.com/users/1968/konrad-rudolph"}, "edited": false, "score": 1, "creation_date": 1554311755, "post_id": 55500195, "comment_id": 97708145, "body": "No reason. I am used to that style since I learned c from the first edition of Ritchie&#39;s book"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8704383"}, "edited": false, "score": 0, "creation_date": 1554312060, "post_id": 55500195, "comment_id": 97708290, "body": "I don&#39;t feel that, it should be an issue, because of the way that it has been implemented. I gave int values only, when running the program"}, {"owner": {"reputation": 60686, "user_id": 277176, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2678da280c230bccef9781b8e5fbaf80?s=128&d=identicon&r=PG", "display_name": "Yakov Galka", "link": "https://stackoverflow.com/users/277176/yakov-galka"}, "edited": false, "score": 1, "creation_date": 1554313060, "post_id": 55500195, "comment_id": 97708721, "body": "Why do you say that &quot;there is no difference in the code&quot; if they are clearly not identical?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8704383"}, "reply_to_user": {"reputation": 60686, "user_id": 277176, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2678da280c230bccef9781b8e5fbaf80?s=128&d=identicon&r=PG", "display_name": "Yakov Galka", "link": "https://stackoverflow.com/users/277176/yakov-galka"}, "edited": false, "score": 0, "creation_date": 1554313936, "post_id": 55500195, "comment_id": 97709135, "body": "@ybungalobill, What I meant was, there was no logical difference. I didn&#39;t know that using GL_LINES instead of GL_POINTS will cause so big a difference, of course till you pointed it out. Thanks for your help"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8704383"}, "edited": false, "score": 0, "creation_date": 1554313788, "post_id": 55501066, "comment_id": 97709058, "body": "Nice bro. Thanks. However, if I write GL_LINES, do I need to write x += xInc and y += yInc?"}, {"owner": {"reputation": 60686, "user_id": 277176, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2678da280c230bccef9781b8e5fbaf80?s=128&d=identicon&r=PG", "display_name": "Yakov Galka", "link": "https://stackoverflow.com/users/277176/yakov-galka"}, "edited": false, "score": 0, "creation_date": 1554314113, "post_id": 55501066, "comment_id": 97709202, "body": "@kesarling: I don&#39;t understand your question. You already wrote GL_LINES, so what do you mean? Just replace your <code>dda</code> function with the one In my answer and see for yourself."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8704383"}, "edited": false, "score": 0, "creation_date": 1554315008, "post_id": 55501066, "comment_id": 97709659, "body": "Thanks. Do consider including glFlush() after glEnd()"}, {"owner": {"reputation": 60686, "user_id": 277176, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2678da280c230bccef9781b8e5fbaf80?s=128&d=identicon&r=PG", "display_name": "Yakov Galka", "link": "https://stackoverflow.com/users/277176/yakov-galka"}, "edited": false, "score": 0, "creation_date": 1554318818, "post_id": 55501066, "comment_id": 97711566, "body": "@kesarling:  <code>glFlush</code> shall be at the end of the frame rendering code in <code>renderFunction</code>, not in <code>dda</code>."}], "tags": [], "owner": {"reputation": 60686, "user_id": 277176, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2678da280c230bccef9781b8e5fbaf80?s=128&d=identicon&r=PG", "display_name": "Yakov Galka", "link": "https://stackoverflow.com/users/277176/yakov-galka"}, "is_accepted": true, "score": 3, "last_activity_date": 1554312883, "creation_date": 1554312883, "answer_id": 55501066, "question_id": 55500195, "link": "https://stackoverflow.com/questions/55500195/whats-the-basic-difference-between-the-following-two-implementations/55501066#55501066", "title": "What&#39;s the basic difference between the following two implementations?", "body": "<p>The difference is that your code uses <code>GL_LINES</code> whereas the other code uses <code>GL_POINTS</code>.</p>\n\n<p>When you draw <code>GL_POINTS</code> then each drawn vertex fills one pixel (when point size is 1).</p>\n\n<p>When you draw <code>GL_LINES</code> then every pair of vertices draws a line between them. In your code it essentially means that vertices 0 and 1 fill the 0th pixel, vertices 2 and 3 fill the 2nd pixel, etc... no pairs fill the odd pixels.</p>\n\n<p>Possible solutions:</p>\n\n<ul>\n<li>Use <code>GL_POINTS</code> <strong>as in the original code</strong>.</li>\n<li>Use <code>GL_LINE_STRIP</code>.</li>\n<li><p>Or the best of all, just use the OpenGL functionality of rasterizing the line for you:</p>\n\n<pre><code>void dda(float x0, float y0, float x1, float y1)\n{\n    glBegin(GL_LINES);\n    glVertex2f(x0, y0);\n    glVertex2f(x1, y1);\n    glEnd();\n}\n</code></pre></li>\n</ul>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user8704383"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 55501066, "answer_count": 1, "score": 3, "last_activity_date": 1554318186, "creation_date": 1554309580, "last_edit_date": 1554318186, "question_id": 55500195, "link": "https://stackoverflow.com/questions/55500195/whats-the-basic-difference-between-the-following-two-implementations", "title": "What&#39;s the basic difference between the following two implementations?", "body": "<p>I was trying to use opengl using c. The code which I wrote leaves gaps within the lines i.e. draws dotted lined whereas the one which I found on the net draws perfectly. I don't get that, if there is no difference in the code which I wrote and the one I found on the net, Why does this happen?</p>\n\n<p>I tried surfing through the sites. I also read <a href=\"https://stackoverflow.com/questions/31806853/dda-line-drawing-algoruthm-have-errors/31807298#31807298\">DDA Line Drawing Algoruthm have errors</a>\nhowever, couldn't find the solution</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;math.h&gt;\n//comment the following line when not on windows\n//#include &lt;windows.h&gt;\n#include &lt;GL/gl.h&gt;\n#include &lt;GL/glut.h&gt;\n\nvoid Init(void);                //used to initialize the stuff such as ortho2D and matrix mode;\nvoid renderFunction(void);          //this function is called in the glutDisplayFunc\nvoid drawAxes(void);                //used to draw the axes\nvoid dda(const float, const float, const float, const float);       //the actual implementation of the algorithm\n\nmain(argc, argv)\nchar** argv;\n{\n    glutInit(&amp;argc, argv);\n    glutInitDisplayMode(GLUT_SINGLE | GLUT_RGB);\n    glutInitWindowSize(300,300);\n    glutInitWindowPosition(100,100);\n    glutCreateWindow(argv[1]);\n    Init();\n    glutDisplayFunc(renderFunction);\n    glutMainLoop();\nreturn EXIT_FAILURE;\n}\n\nvoid Init(void) {\n    glClear(GL_COLOR_BUFFER_BIT);\n    glColor3f(1.0, 1.0, 1.0);\n    glMatrixMode(GL_PROJECTION);\n    glLoadIdentity();\n    gluOrtho2D(-500, 500, -500, 500);\n}\n\nvoid renderFunction(void) {\n    drawAxes();\n    int x0, y0, x1, y1;\n    while(1) {\n        printf(\"ENTER THE CO-ORDINATES OF THE FIRST POINT: \");\n        scanf(\"%d %d\",&amp;x0 ,&amp;y0);\n        printf(\"ENTER THE CO-ORDINATES OF THE SECOND POINT: \");\n        scanf(\"%d %d\",&amp;x1 ,&amp;y1);\n        dda(x0, y0, x1, y1);\n    }\n}\n\nvoid drawAxes(void) {\n    dda(-500, 0, 500, 0);\n    dda(0, -500, 0, 500);\n}\n\nvoid dda(x0, y0, x1, y1)\nconst float x0, y0, x1, y1;\n{\n    float dx = x1 - x0;\n    float dy = y1 - y0;\n    int steps = abs(dx) &gt; abs(dy) ? abs(dx) : abs(dy);\n    float xInc = dx/(float)steps;\n    float yInc = dy/(float)steps;\n    float x = x0;\n    float y = y0;\n    glBegin(GL_LINES);\n        int i = 0;\n        for(i = 0; i &lt; steps; i++) {\n            glVertex2i((int)x, (int)y);\n            x += xInc;\n            y += yInc;\n        }\n    glEnd();\n    glFlush();\n}\n</code></pre>\n\n<p>The code which I found on the net:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;math.h&gt;\n#include&lt;GL/freeglut.h&gt;\n#include&lt;GL/gl.h&gt;\n\nvoid dda(int x0, int y0, int x1, int y1){\n    int steps;\n    float Xinc; float Yinc; float X,Y;\n//DDA Calculation start\n    int dx = x1-x0;\n    int dy = y1-y0;\n    steps = abs(dx) &gt; abs(dy) ? abs(dx) : abs(dy);\n    Xinc = dx/(float)steps;\n    Yinc = dy/(float)steps;\n    X=x0;\n    Y=y0;\n//DDA Calculation end\n    int i;\n    glColor3f(0.0, 0.0, 0.0);\n//  glOrtho(-1.0,1.0,-1.0, 1.0,1.0,-1.0);\n    glBegin(GL_POINTS);\n    for(i=0 ; i&lt;steps ; i++){\n        glVertex2i((int)X,(int)Y);\n        X+=Xinc;\n        Y+=Yinc;\n    }\n    glEnd();\n}\n\nvoid axis(){\n    dda(-750,0,750,0);\n    dda(0,-750,0,750);\n}\n\nvoid renderF(void){\n    gluOrtho2D(750,-750,750,-750);\n    axis();\n\n    //Diagonal Vertex 1\n    int x1 = 500;\n    int y1 = 500;\n    //Diagonal Vertex 2\n    int x2 = -500;\n    int y2 = -500;\n\n    int v = x1;\n    int u = v/2;\n\n    dda(-v,v,-v,-v);\n\n\n    glFlush();\n}\n\nint main(int argc, char** argv){\n    glutInit(&amp;argc, argv);\n    glutInitDisplayMode(GLUT_SINGLE | GLUT_RGB);\n    glutInitWindowSize(500,500);\n    glutInitWindowPosition(100,100);\n    glutCreateWindow(\"Hello\");\n\n    glClearColor(1.0, 1.0, 1.0, 0.0);\n    glClear(GL_COLOR_BUFFER_BIT);\n    glutDisplayFunc(renderF);\n\n    glutMainLoop();\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["java", "c", "kotlin", "codepoint", "imgui"], "comments": [{"owner": {"reputation": 31408, "user_id": 243245, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/aed5c13647d581ae231f019a886e05a8?s=128&d=identicon&r=PG", "display_name": "Rup", "link": "https://stackoverflow.com/users/243245/rup"}, "edited": false, "score": 1, "creation_date": 1554309920, "post_id": 55500127, "comment_id": 97707211, "body": "Try <code>L&quot;\u2013&quot;</code> in C, which creates UTF-16 strings on Windows. (You can also just do L&#39;\u2013&#39; without having to create a string then read a character from it.)"}, {"owner": {"reputation": 5577, "user_id": 1047713, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/6bd4a6e80c7c52685a465ef6fd4ebde3?s=128&d=identicon&r=PG", "display_name": "elect", "link": "https://stackoverflow.com/users/1047713/elect"}, "reply_to_user": {"reputation": 31408, "user_id": 243245, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/aed5c13647d581ae231f019a886e05a8?s=128&d=identicon&r=PG", "display_name": "Rup", "link": "https://stackoverflow.com/users/243245/rup"}, "edited": false, "score": 0, "creation_date": 1554310122, "post_id": 55500127, "comment_id": 97707308, "body": "I can&#39;t see the point to that, anyway, with <code>char* a = L&quot;\u2013&quot;;</code>I get the following <code>error C2440: &#39;initializing&#39;: cannot convert from &#39;const wchar_t [2]&#39; to &#39;char *&#39;</code>"}, {"owner": {"reputation": 31408, "user_id": 243245, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/aed5c13647d581ae231f019a886e05a8?s=128&d=identicon&r=PG", "display_name": "Rup", "link": "https://stackoverflow.com/users/243245/rup"}, "edited": false, "score": 0, "creation_date": 1554310192, "post_id": 55500127, "comment_id": 97707344, "body": "It should work with <code>ImWchar*</code>, which is what you want isn&#39;t it? Maybe that would need a cast, but it would be the correct data."}, {"owner": {"reputation": 5577, "user_id": 1047713, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/6bd4a6e80c7c52685a465ef6fd4ebde3?s=128&d=identicon&r=PG", "display_name": "elect", "link": "https://stackoverflow.com/users/1047713/elect"}, "reply_to_user": {"reputation": 31408, "user_id": 243245, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/aed5c13647d581ae231f019a886e05a8?s=128&d=identicon&r=PG", "display_name": "Rup", "link": "https://stackoverflow.com/users/243245/rup"}, "edited": false, "score": 0, "creation_date": 1554310420, "post_id": 55500127, "comment_id": 97707483, "body": "It wanted the cast indeed. And it&#39;s actually <code>8211</code> in this case"}, {"owner": {"reputation": 31408, "user_id": 243245, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/aed5c13647d581ae231f019a886e05a8?s=128&d=identicon&r=PG", "display_name": "Rup", "link": "https://stackoverflow.com/users/243245/rup"}, "edited": false, "score": 0, "creation_date": 1554310655, "post_id": 55500127, "comment_id": 97707583, "body": "8211 is 0x2013 in decimal."}, {"owner": {"reputation": 5577, "user_id": 1047713, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/6bd4a6e80c7c52685a465ef6fd4ebde3?s=128&d=identicon&r=PG", "display_name": "elect", "link": "https://stackoverflow.com/users/1047713/elect"}, "reply_to_user": {"reputation": 31408, "user_id": 243245, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/aed5c13647d581ae231f019a886e05a8?s=128&d=identicon&r=PG", "display_name": "Rup", "link": "https://stackoverflow.com/users/243245/rup"}, "edited": false, "score": 0, "creation_date": 1554310741, "post_id": 55500127, "comment_id": 97707621, "body": "yeah, but what is going then without <code>L</code>?"}, {"owner": {"reputation": 31408, "user_id": 243245, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/aed5c13647d581ae231f019a886e05a8?s=128&d=identicon&r=PG", "display_name": "Rup", "link": "https://stackoverflow.com/users/243245/rup"}, "edited": false, "score": 2, "creation_date": 1554311055, "post_id": 55500127, "comment_id": 97707786, "body": "Like you said, it\u2019s a CP1252 string. You can convert that to wide chars using <a href=\"https://docs.microsoft.com/en-us/windows/desktop/api/stringapiset/nf-stringapiset-multibytetowidechar\" rel=\"nofollow noreferrer\">MultiByteToWideChar</a>."}, {"owner": {"reputation": 18759, "user_id": 2226988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c6fbec3a71b2e95e4a6e41478deb379?s=128&d=identicon&r=PG", "display_name": "Tom Blodget", "link": "https://stackoverflow.com/users/2226988/tom-blodget"}, "edited": false, "score": 1, "creation_date": 1554311415, "post_id": 55500127, "comment_id": 97707973, "body": "&quot;Extended Ascii&quot;: There are only two interpretations of it. 1) One very specific character encoding (in which case there is no reason to call it &quot;Extended Ascii&quot;, just say which is it). 2) Adaptive to the user&#39;s system&#39;s current settings followed up by optional locale changes within the program (which is rarely but sometimes exactly what you want)."}, {"owner": {"reputation": 9417, "user_id": 10134209, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XvJ8z.png?s=128&g=1", "display_name": "gidds", "link": "https://stackoverflow.com/users/10134209/gidds"}, "edited": false, "score": 1, "creation_date": 1554311677, "post_id": 55500127, "comment_id": 97708092, "body": "In practice, I think \u2018extended ASCII\u2019 usually refers to Windows Latin-1 AKA CP1252.  (That&#39;s mostly the same as ISO Latin-1 AKA ISO 8859-1 (which matches the first 256 Unicode chars) except that it has things like curly quotes and long dashes in chars 128\u2013159 where ISO Latin-1 has control characters.)"}, {"owner": {"reputation": 23625, "user_id": 2868801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ec5567811049b7ce8192be0bc0246d1?s=128&d=identicon&r=PG&f=1", "display_name": "dave_thompson_085", "link": "https://stackoverflow.com/users/2868801/dave-thompson-085"}, "edited": false, "score": 0, "creation_date": 1554314632, "post_id": 55500127, "comment_id": 97709464, "body": "<b>Which C++</b> and with what options? Your claimed &#39;C&#39; is actually C++, although you can have the same issue in C. The Java standard defines it to use UTF-16, plus there is one dominant implementation (Sun-now-Oracle), but the C++ and C standards make (source and execution) character encodings implementation-dependent and there are many thousands of C and C++ implementations which make many different choices in this area; some compilers support multiple options."}, {"owner": {"reputation": 5577, "user_id": 1047713, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/6bd4a6e80c7c52685a465ef6fd4ebde3?s=128&d=identicon&r=PG", "display_name": "elect", "link": "https://stackoverflow.com/users/1047713/elect"}, "reply_to_user": {"reputation": 23625, "user_id": 2868801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ec5567811049b7ce8192be0bc0246d1?s=128&d=identicon&r=PG&f=1", "display_name": "dave_thompson_085", "link": "https://stackoverflow.com/users/2868801/dave-thompson-085"}, "edited": false, "score": 0, "creation_date": 1554796833, "post_id": 55500127, "comment_id": 97872740, "body": "@dave_thompson_085, sorry but I have no idea about which options exactly you refer (I just cloned it and opened in VS). Anyway, I kind of found a solution for the moment"}], "answers": [{"tags": [], "owner": {"reputation": 5577, "user_id": 1047713, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/6bd4a6e80c7c52685a465ef6fd4ebde3?s=128&d=identicon&r=PG", "display_name": "elect", "link": "https://stackoverflow.com/users/1047713/elect"}, "is_accepted": true, "score": 1, "last_activity_date": 1554797459, "creation_date": 1554797459, "answer_id": 55587979, "question_id": 55500127, "link": "https://stackoverflow.com/questions/55500127/codepoint-mismatch-between-java-and-c/55587979#55587979", "title": "Codepoint mismatch between Java and C", "body": "<p>At the moment I solved like <a href=\"https://github.com/kotlin-graphics/imgui/blob/master/src/main/kotlin/imgui/internal/helpers.kt#L418-L457\" rel=\"nofollow noreferrer\">this</a> on Windows, I inserted this function before retrieving the char codepoint.\nIt basically remaps all those chars which differs from ISO-8859-1. You can see them in this <a href=\"https://en.wikipedia.org/wiki/Windows-1252#Character_set\" rel=\"nofollow noreferrer\">table</a>, they are all those with that light grey border.</p>\n\n<pre><code>internal fun Char.remapCodepointIfProblematic(): Int {\n    val i = toInt()\n    return when (Platform.get()) {\n        /*  https://en.wikipedia.org/wiki/Windows-1252#Character_set\n         *  manually remap the difference from  ISO-8859-1 */\n        Platform.WINDOWS -&gt; when (i) {\n            // 8_128\n            0x20AC -&gt; 128 // \u20ac\n            0x201A -&gt; 130 // \u201a\n            0x0192 -&gt; 131 // \u0192\n            0x201E -&gt; 132 // \u201e\n            0x2026 -&gt; 133 // \u2026\n            0x2020 -&gt; 134 // \u2020\n            0x2021 -&gt; 135 // \u2021\n            0x02C6 -&gt; 136 // \u02c6\n            0x2030 -&gt; 137 // \u2030\n            0x0160 -&gt; 138 // \u0160\n            0x2039 -&gt; 139 // \u2039\n            0x0152 -&gt; 140 // \u0152\n            0x017D -&gt; 142 // \u017d\n            // 9_144\n            0x2018 -&gt; 145 // \u2018\n            0x2019 -&gt; 146 // \u2019\n            0x201C -&gt; 147 // \u201c\n            0x201D -&gt; 148 // \u201d\n            0x2022 -&gt; 149 // \u2022\n            0x2013 -&gt; 150 // \u2013\n            0x2014 -&gt; 151 // \u2014\n            0x02DC -&gt; 152 // \u02dc\n            0x2122 -&gt; 153 // \u2122\n            0x0161 -&gt; 154 // \u0161\n            0x203A -&gt; 155 // \u203a\n            0x0153 -&gt; 156 // \u0153\n            0x017E -&gt; 158 // \u017e\n            0x0178 -&gt; 159 // \u0178\n            else -&gt; i\n        }\n        else -&gt; i // TODO\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 5577, "user_id": 1047713, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/6bd4a6e80c7c52685a465ef6fd4ebde3?s=128&d=identicon&r=PG", "display_name": "elect", "link": "https://stackoverflow.com/users/1047713/elect"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "accepted_answer_id": 55587979, "answer_count": 1, "score": 1, "last_activity_date": 1554797459, "creation_date": 1554309297, "last_edit_date": 1554309762, "question_id": 55500127, "link": "https://stackoverflow.com/questions/55500127/codepoint-mismatch-between-java-and-c", "title": "Codepoint mismatch between Java and C", "body": "<p>So, I'm having some problems with the following char <code>\u2013</code> in a port of imgui to <a href=\"https://github.com/kotlin-graphics/imgui\" rel=\"nofollow noreferrer\">kotlin</a></p>\n\n<p>After digging the whole day into Charsets and encodings, I came down to my only hope: rely on the unicode codepoints.</p>\n\n<p>That char on the jvm </p>\n\n<p><code>\"\u2013\"[0].toInt() // same as codePointAt()</code></p>\n\n<p>returns codepoint <a href=\"https://unicode-table.com/en/2013/\" rel=\"nofollow noreferrer\">u2013</a></p>\n\n<p>On C, I'm not sure, but since this is what is being <a href=\"https://github.com/ocornut/imgui/blob/master/imgui_draw.cpp#L2538-L2546\" rel=\"nofollow noreferrer\">done</a>:</p>\n\n<pre><code>const ImFontGlyph* ImFont::FindGlyph(ImWchar c) const\n{\n    if (c &gt;= IndexLookup.Size)\n        return FallbackGlyph;\n    const ImWchar i = IndexLookup.Data[c];\n    if (i == (ImWchar)-1)\n        return FallbackGlyph;\n    return &amp;Glyphs.Data[i];\n}\n</code></pre>\n\n<p>Where </p>\n\n<p><code>typedef unsigned short ImWchar</code></p>\n\n<p>and</p>\n\n<p><code>ImVector&lt;ImWchar&gt; IndexLookup; // Sparse. Index glyphs by Unicode code-point.</code></p>\n\n<p>So, doing this</p>\n\n<pre><code>char* a = \"\u2013\";\nint b = a[0];\n</code></pre>\n\n<p>returns codepoint <a href=\"https://unicode-table.com/en/0096/\" rel=\"nofollow noreferrer\">u0096</a></p>\n\n<p>As far as I read, it look like over <code>127</code>(<code>0x7F</code>) we are in the \"Extended Ascii\" territory, which is bad, because it appears there are different versions/interpretation of it.</p>\n\n<p>For example, this <a href=\"http://www.asciitable.com/\" rel=\"nofollow noreferrer\">encoding table</a> doesn't match my codepoint, but the <a href=\"https://en.wikipedia.org/wiki/Windows-1252\" rel=\"nofollow noreferrer\">Cp1252 encoding</a> does, so I'm inclined to think that this is what is actually being used on C.</p>\n\n<p>In the table at the bottom of the link just mentioned, you can actually see that <code>150</code> (decimal, count from the right column with the given number) corresponds indeed to <code>2013</code> (hex, I find it a little incoherent, but anyway).</p>\n\n<p>To solve this, I tried to convert my <code>String</code>s on Kotlin to the same encoding (ignoring for the moment that this is of course platform-specific), so for every <code>c: Char</code></p>\n\n<p><code>\"$c\".toByteArray(Charset.forName(\"Cp1252\"))[0].toUnsignedInt</code></p>\n\n<p>This works, but breaks rendering for foreign fonts, such as chinese, japanese, etc..</p>\n\n<p>So, my question is: why the difference between <code>u2013</code> on JVM and <code>u0096</code> on C? </p>\n\n<p>Which is the right way to deal with this?</p>\n"}, {"tags": ["c", "matlab", "matlab-coder"], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 2510337, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1519d72fe24ba6acdb278300097e8e65?s=128&d=identicon&r=PG", "display_name": "Nathan Schaaf", "link": "https://stackoverflow.com/users/2510337/nathan-schaaf"}, "is_accepted": false, "score": 1, "last_activity_date": 1554320212, "creation_date": 1554320212, "answer_id": 55503038, "question_id": 55499737, "link": "https://stackoverflow.com/questions/55499737/converting-a-c-char-array-into-a-matlab-string-matlab-coder/55503038#55503038", "title": "Converting a C char array into a Matlab String [Matlab Coder]", "body": "<p>What exactly is going wrong with the code you have written? Do you see any error messages, or get answers different than you expect?</p>\n\n<p>I think that you might run into problems with your 'buffer' variable in MATLAB not being large enough to store everything that you are printing into it in your C code. I would recommend initializing it with 'buffer = blanks(10)' to make sure it can hold at least 10 characters (which is the number I think you are reading). Another good option might be to just use 'fread' instead of your custom C code (if that is possible), as that function is supported for MATLAB Coder.</p>\n"}], "owner": {"reputation": 1, "user_id": 11245008, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-uxA_e2cBiTk/AAAAAAAAAAI/AAAAAAAAAcg/6g1pcgg3Qyw/photo.jpg?sz=128", "display_name": "bereware", "link": "https://stackoverflow.com/users/11245008/bereware"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1554320212, "creation_date": 1554308007, "last_edit_date": 1554309677, "question_id": 55499737, "link": "https://stackoverflow.com/questions/55499737/converting-a-c-char-array-into-a-matlab-string-matlab-coder", "title": "Converting a C char array into a Matlab String [Matlab Coder]", "body": "<p>My intention is to show for the output of Matlab System a string the type char_T data[ ], that I receive a function in C through coder.ceval</p>\n\n<p>I want to show more specifically the buffer variable, as it would have to declare the buffer variable</p>\n\n<pre><code>matlab\nfunction data = stepImpl(obj)\n        buffer = \u00bf\u00bf ??;\n\n        if coder.target ('Rtw')\n            coder.cinclude('File_Wrapper.h');\n            coder.ceval('function',obj.port, coder.wref(buffer)); \n            data = \u00bf\u00bf\u00bf string(buffer) ???;\n        end\nend\n</code></pre>\n\n<p>this would be the function sent to me by char_T data[ ], I use coder.wref to fill the variable in the following method</p>\n\n<pre><code>void function(uint8_T uartPort, char_T data[])\n{\n    char buffer[30];\n    if (uartPort == 1)\n    {\n        fgets(buffer, 10, uart1);\n    }\n    else if (uartPort == 2)\n    {\n        fgets(buffer, 10, uart2);\n    }\n\n    snprintf (data, sizeof(buffer), \"%s\", buffer);\n}\n</code></pre>\n\n<p>This post dont work for me:\n<a href=\"https://stackoverflow.com/questions/39000799/converting-a-c-char-array-into-a-matlab-string-using-matlab-coder\">Converting a C char array into a Matlab String using Matlab Coder</a></p>\n"}, {"tags": ["c", "string", "loops", "char", "palindrome"], "comments": [{"owner": {"reputation": 19358, "user_id": 3049655, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ZLzeP.jpg?s=128&g=1", "display_name": "Spikatrix", "link": "https://stackoverflow.com/users/3049655/spikatrix"}, "edited": false, "score": 0, "creation_date": 1554307955, "post_id": 55499606, "comment_id": 97706202, "body": "What is the input for the first example?"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1554308233, "post_id": 55499606, "comment_id": 97706361, "body": "Presumably you need the longest palindrome in the string? And does the middle of the palindrome need to be in the middle of the string? I&#39;m also not convinced as to the reason why you feel the need to ask a new question."}, {"owner": {"reputation": 19, "user_id": 11277499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcb2689e8ae0b0a8d72d40c7e4b85f09?s=128&d=identicon&r=PG&f=1", "display_name": "serene", "link": "https://stackoverflow.com/users/11277499/serene"}, "reply_to_user": {"reputation": 19358, "user_id": 3049655, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ZLzeP.jpg?s=128&g=1", "display_name": "Spikatrix", "link": "https://stackoverflow.com/users/3049655/spikatrix"}, "edited": false, "score": 0, "creation_date": 1554308452, "post_id": 55499606, "comment_id": 97706479, "body": "@Spikatrix sorry. It was abcbae"}, {"owner": {"reputation": 19, "user_id": 11277499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcb2689e8ae0b0a8d72d40c7e4b85f09?s=128&d=identicon&r=PG&f=1", "display_name": "serene", "link": "https://stackoverflow.com/users/11277499/serene"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1554308973, "post_id": 55499606, "comment_id": 97706748, "body": "@Bathsheba because the old code was heavily edited so if I tried to edit there it would look really messy. I&#39;m also not convinced as to the reason why you feel the need to ask this when I already explained why. I cut of the string in the middle because the for a palindrome there&#39;s no point in comparing the chars after the middle because they will be the same. I do need the longest palindrome in string but first I need to find the palindrome first which is what I am checking right now."}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1554309285, "post_id": 55499606, "comment_id": 97706889, "body": "serene not sure to be (a little) aggressive with @Bathsheba is a good way to receive help ..."}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1554309426, "post_id": 55499606, "comment_id": 97706958, "body": "Why do you pass in values for <code>i</code> and <code>j</code> and then overwrite them?"}, {"owner": {"reputation": 19, "user_id": 11277499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcb2689e8ae0b0a8d72d40c7e4b85f09?s=128&d=identicon&r=PG&f=1", "display_name": "serene", "link": "https://stackoverflow.com/users/11277499/serene"}, "reply_to_user": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1554309517, "post_id": 55499606, "comment_id": 97706997, "body": "@bruno I am just really frustrated right now and I need help with my code. Not get judged about my questions. I spend a lot of time editing my questions and code before posting it."}, {"owner": {"reputation": 19, "user_id": 11277499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcb2689e8ae0b0a8d72d40c7e4b85f09?s=128&d=identicon&r=PG&f=1", "display_name": "serene", "link": "https://stackoverflow.com/users/11277499/serene"}, "reply_to_user": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1554309591, "post_id": 55499606, "comment_id": 97707032, "body": "@ChrisTurner where?"}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1554309591, "post_id": 55499606, "comment_id": 97707033, "body": "@serene ok but understand we spend a lot of time to help, and we do not need to help, while you need to receive help ;-)"}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1554309674, "post_id": 55499606, "comment_id": 97707069, "body": "@serene well they&#39;re part of the function call, but they get set again (admittedly to the same values) about 3 lines into the function"}, {"owner": {"reputation": 19, "user_id": 11277499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcb2689e8ae0b0a8d72d40c7e4b85f09?s=128&d=identicon&r=PG&f=1", "display_name": "serene", "link": "https://stackoverflow.com/users/11277499/serene"}, "reply_to_user": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1554309733, "post_id": 55499606, "comment_id": 97707109, "body": "@bruno just asking why doesn&#39;t really help"}, {"owner": {"reputation": 19, "user_id": 11277499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcb2689e8ae0b0a8d72d40c7e4b85f09?s=128&d=identicon&r=PG&f=1", "display_name": "serene", "link": "https://stackoverflow.com/users/11277499/serene"}, "reply_to_user": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1554309982, "post_id": 55499606, "comment_id": 97707238, "body": "@ChrisTurner I removed it but it didn&#39;t change the output."}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1554312982, "post_id": 55499606, "comment_id": 97708696, "body": "@serene I put some remarks and a proposal to find all the (sub)palindromes in the input string, see my answer. As you can see Bathsheba was right about the middle ..."}], "answers": [{"tags": [], "owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "is_accepted": false, "score": -1, "last_activity_date": 1554310800, "creation_date": 1554310800, "answer_id": 55500514, "question_id": 55499606, "link": "https://stackoverflow.com/questions/55499606/in-c-my-code-to-find-the-palindrome-is-either-not-printing-out-all-the-chars-m/55500514#55500514", "title": "In C, my code to find the palindrome is either not printing out all the chars, missing a single char, or repeating chars?", "body": "<p>Your code is doing exactly what you've asked of it.</p>\n\n<p>You're scanning through the string and then scanning backwards from the other end to find any matching characters and not yet checking for palindromes. The reason why your code is giving you odd results when doing this is because of the inner loop.</p>\n\n<pre><code>for(j=len-1;j&gt;=(len/2)-1 ;j--)\n</code></pre>\n\n<p>You stop <code>j</code> from going beyond the middle of the string, but allow <code>i</code> to traverse all of it. This means that you get points where <code>i</code> is more than <code>j</code> like in this example bit of output:</p>\n\n<blockquote>\n  <p>if: i=4 j=2 str[4]=c str[2]=c</p>\n</blockquote>\n\n<p>Or sometimes the matching end character could be before the middle of the string.</p>\n\n<p>You want to constrain <code>j</code> so that it is always more than <code>i</code> like so...</p>\n\n<pre><code>for(j=len-1;j&gt;i ;j--)\n</code></pre>\n\n<p>...or maybe make it <code>j&gt;=i</code> if you're happy to match the same character with itself.</p>\n"}, {"comments": [{"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1554313156, "post_id": 55500532, "comment_id": 97708762, "body": "sorry but you do not answer to the question, you check if all the string is a palindrome, you do not search for them, and you do than in an expensive way making the reverse of the initial string ..."}, {"owner": {"reputation": 196, "user_id": 11139937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fb20157f20488d087487a13a9544987?s=128&d=identicon&r=PG&f=1", "display_name": "Vaibhav", "link": "https://stackoverflow.com/users/11139937/vaibhav"}, "reply_to_user": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1554318833, "post_id": 55500532, "comment_id": 97711575, "body": "@bruno I did what I undestand about the problem statement. Other thing is check the output console he provided. If the input string is \u201cracecar\u201d, than that string is palindrome. Other there is function called \u201cstrrev() \u201c in c that will reverse the string. If you are looking for better answer please provide clarity on what you are looking for thanks"}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1554319037, "post_id": 55500532, "comment_id": 97711663, "body": "the questions says <i>my assignment is to find the palindrome in the string</i> and if you look at the examples there are also <i>dabae</i> for which the expected result is <i>aba</i> etc. (I am not the downvoter ;-) )"}, {"owner": {"reputation": 196, "user_id": 11139937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fb20157f20488d087487a13a9544987?s=128&d=identicon&r=PG&f=1", "display_name": "Vaibhav", "link": "https://stackoverflow.com/users/11139937/vaibhav"}, "reply_to_user": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1554319223, "post_id": 55500532, "comment_id": 97711752, "body": "That does make sense"}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1554319381, "post_id": 55500532, "comment_id": 97711843, "body": "it is not always easy to understand the request, we all make mistakes from time to time, we only human, have fun"}, {"owner": {"reputation": 196, "user_id": 11139937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fb20157f20488d087487a13a9544987?s=128&d=identicon&r=PG&f=1", "display_name": "Vaibhav", "link": "https://stackoverflow.com/users/11139937/vaibhav"}, "reply_to_user": {"reputation": 19, "user_id": 11277499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcb2689e8ae0b0a8d72d40c7e4b85f09?s=128&d=identicon&r=PG&f=1", "display_name": "serene", "link": "https://stackoverflow.com/users/11277499/serene"}, "edited": false, "score": 0, "creation_date": 1554356089, "post_id": 55500532, "comment_id": 97722250, "body": "@serene did you find what you are looking for?"}], "tags": [], "owner": {"reputation": 196, "user_id": 11139937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fb20157f20488d087487a13a9544987?s=128&d=identicon&r=PG&f=1", "display_name": "Vaibhav", "link": "https://stackoverflow.com/users/11139937/vaibhav"}, "is_accepted": false, "score": -1, "last_activity_date": 1554310871, "creation_date": 1554310871, "answer_id": 55500532, "question_id": 55499606, "link": "https://stackoverflow.com/questions/55499606/in-c-my-code-to-find-the-palindrome-is-either-not-printing-out-all-the-chars-m/55500532#55500532", "title": "In C, my code to find the palindrome is either not printing out all the chars, missing a single char, or repeating chars?", "body": "<p>You made a simple program into complex code. As far as i understand you need to check whether the input string is palindrome or not.Here is the simple sample code for that in c</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n   char s[1000], r[1000];\n   int begin, end, count = 0;\n\n   printf(\"Input a string\\n\");\n   fgets(s,sizeof(s),stdin);\n\n   // Calculating string length\n\n   while (s[count] != '\\0')\n      count++;\n\n   end = count - 1;\n\n   for (begin = 0; begin &lt; count; begin++) {\n      r[begin] = s[end];\n      end--;\n   }\n\n   r[begin] = '\\0';\n\n   printf(\"%s\\n\", r);\n if(strcmp(s,r)==0)\n{\nprintf(\"panlindrome\");\n}\nelse\n{\nprintf(\"not palindrome\");\n}\n   return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 11277499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcb2689e8ae0b0a8d72d40c7e4b85f09?s=128&d=identicon&r=PG&f=1", "display_name": "serene", "link": "https://stackoverflow.com/users/11277499/serene"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 78, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1556812127, "creation_date": 1554307576, "last_edit_date": 1554309944, "question_id": 55499606, "link": "https://stackoverflow.com/questions/55499606/in-c-my-code-to-find-the-palindrome-is-either-not-printing-out-all-the-chars-m", "title": "In C, my code to find the palindrome is either not printing out all the chars, missing a single char, or repeating chars?", "body": "<p>I am working on homework and my assignment is to find the palindrome in the string. My code is not printing out all the chars or missing a char, or repeatedly printing chars. I tried to post as many details as possible on my code. I hope someone can help me through this code.\n*I have posted this question before but this question has new updated code which is very different from what I had before.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt; \nint palindromelength(char *str, int i, int j);\nchar str[100];  \nint main()\n{\n    int i,j,len,n;\n    printf(\"Enter a string \");      \n    fgets(str,sizeof(str),stdin);//takes user input\n    str[strcspn(str, \"\\n\")] = 0;\n    len=strlen(str);\n    palindromelength(str, 0, len-1);//function call\n    return 0;       \n}\nint palindromelength(char *str, int i, int j) \n{       \n    int len=strlen(str),n;\n    printf(\"length is %d\\n\", len);\n    while(i&lt;len-1)\n    {       \n    printf(\"i=%d\\n\",i);\n        for(j=len-1;j&gt;=(len/2)-1 ;j--)\n        {           \n            printf(\"%c%c\\n\",str[i],str[j]);           \n            if(str[i]==str[j])//if letters aren't same\n            {\n               printf(\"if: i=%d j=%d str[%d]=%c str[%d]=%c\\n\",i,j,i,str[i],j,str[j]);\n            // printf(\"%c%c\",str[i]);/***in my final code I will print this statement \n           //and all the other printfs will be removed. So there won't be new line.***/\n            }                               \n        }\n        i++;    \n    }\n    return 0;   \n}\n</code></pre>\n\n<pre><code>***only str[i] will be printed in final code***\nOutput:        expected:abcba\nEnter a string abcbae\nlength is 6\ni=0\nae\naa\nif: i=0 j=4 str[0]=a str[4]=a\nab\nac\ni=1\nbe\nba\nbb\nif: i=1 j=3 str[1]=b str[3]=b\nbc\ni=2\nce\nca\ncb\ncc\nif: i=2 j=2 str[2]=c str[2]=c\ni=3\nbe\nba\nbb\nif: i=3 j=3 str[3]=b str[3]=b\nbc\ni=4\nae\naa\nif: i=4 j=4 str[4]=a str[4]=a\nab\nac\n</code></pre>\n\n<pre><code>output 2:                       expected:aba \nEnter a string dabae\nlength is 5\ni=0\nde\nda\ndb\nda\ni=1\nae\naa\nif: i=1 j=3 str[1]=a str[3]=a\nab\naa\nif: i=1 j=1 str[1]=a str[1]=a\ni=2\nbe\nba\nbb\nif: i=2 j=2 str[2]=b str[2]=b\nba\ni=3\nae\naa\nif: i=3 j=3 str[3]=a str[3]=a\nab\naa\nif: i=3 j=1 str[3]=a str[1]=a\n</code></pre>\n\n<pre><code>output 3:                    expected:racecar\nEnter a string racecar\nlength is 7\ni=0\nrr\nif: i=0 j=6 str[0]=r str[6]=r\nra\nrc\nre\nrc\ni=1\nar\naa\nif: i=1 j=5 str[1]=a str[5]=a\nac\nae\nac\ni=2\ncr\nca\ncc\nif: i=2 j=4 str[2]=c str[4]=c\nce\ncc\nif: i=2 j=2 str[2]=c str[2]=c\ni=3\ner\nea\nec\nee\nif: i=3 j=3 str[3]=e str[3]=e\nec\ni=4\ncr\nca\ncc\nif: i=4 j=4 str[4]=c str[4]=c\nce\ncc\nif: i=4 j=2 str[4]=c str[2]=c\ni=5\nar\naa\nif: i=5 j=5 str[5]=a str[5]=a\nac\nae\nac\n</code></pre>\n"}, {"tags": ["c", "arrays", "pointers", "struct", "pthreads"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1554308457, "post_id": 55499529, "comment_id": 97706481, "body": "Observation: if you&#39;re going to use <code>struct motor</code> and <code>struct argstruct</code> in the code, there&#39;s no reason to use <code>typedef</code>.  However, that&#39;s 100% tangential to your main question."}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1554308607, "post_id": 55499529, "comment_id": 97706552, "body": "you need a <code>struct motor **</code> rather than a <code>struct motor *</code>, see my answer"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 2164962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c14e30cf64fda4cdc18ac61108e87f0f?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/2164962/max"}, "edited": false, "score": 0, "creation_date": 1554317040, "post_id": 55499682, "comment_id": 97710728, "body": "That worked perfectly! Thanks for the quick response."}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "reply_to_user": {"reputation": 3, "user_id": 2164962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c14e30cf64fda4cdc18ac61108e87f0f?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/2164962/max"}, "edited": false, "score": 0, "creation_date": 1554317565, "post_id": 55499682, "comment_id": 97710993, "body": "@Max you welcome. I encourage you to ask for the max level of warnings when you compile, like I did ( <code>-pedantic -Wextra -Wall</code> for gcc, search how to do if you use an other compiler )"}], "tags": [], "owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "is_accepted": true, "score": 1, "last_activity_date": 1554308445, "last_edit_date": 1554308445, "creation_date": 1554307781, "answer_id": 55499682, "question_id": 55499529, "link": "https://stackoverflow.com/questions/55499529/issue-with-feeding-arrays-of-structs-as-arguments-into-pthread-create/55499682#55499682", "title": "Issue with feeding arrays of structs as arguments into pthread_create", "body": "<p>warning the assignment</p>\n\n<blockquote>\n<pre><code> motors_and_a.allmotors = all_motors;\n</code></pre>\n</blockquote>\n\n<p>is invalid because <code>all_motors</code> is a <code>motor* [2]</code> not a <code>motor*</code> as expected by <code>motors_and_a.allmotors</code>, so the uses after have undefined behavior.</p>\n\n<p>You have to give only one <em>motor*</em> rather than an array of <em>motor*</em>, or to change the definition of <em>argstruct</em> to have <code>struct motor **allmotors;</code> and of course its use</p>\n\n<p>Because</p>\n\n<blockquote>\n<pre><code>// HERE I GET STUCK\nstruct motor *motors = arguments-&gt;allmotors;\n// set test_motor2 status to 1\n</code></pre>\n</blockquote>\n\n<p>I suppose you want :</p>\n\n<pre><code>typedef struct argstruct{\n    int *vect;\n    struct motor ** allmotors; /* MODIFIED */\n} args;\n\nvoid *test(void *arg){\n\n    struct argstruct *arguments = arg;\n    int *a_array = arguments-&gt;vect;\n    a_array[0] = 80;\n\n    struct motor ** motors = arguments-&gt;allmotors; /* MODIFIED */\n\n    motors[1]-&gt;motor_status = 1; /* MODIFIED */\n\n    return 0;\n}\n</code></pre>\n\n<p>The rest is unchanged.</p>\n\n<p>Compilation and execution :</p>\n\n<pre><code>pi@raspberrypi:~ $ gcc -g -pedantic -Wextra -Wall m.c -lpthread\npi@raspberrypi:~ $ ./a.out\na[0]: 80\nStatus of test_motor2: 1\n</code></pre>\n\n<p>execution under <em>valgrind</em> :</p>\n\n<pre><code>pi@raspberrypi:~ $ valgrind ./a.out\n==4083== Memcheck, a memory error detector\n==4083== Copyright (C) 2002-2017, and GNU GPL'd, by Julian Seward et al.\n==4083== Using Valgrind-3.13.0 and LibVEX; rerun with -h for copyright info\n==4083== Command: ./a.out\n==4083== \na[0]: 80\nStatus of test_motor2: 1\n==4083== \n==4083== HEAP SUMMARY:\n==4083==     in use at exit: 0 bytes in 0 blocks\n==4083==   total heap usage: 2 allocs, 2 frees, 1,160 bytes allocated\n==4083== \n==4083== All heap blocks were freed -- no leaks are possible\n==4083== \n==4083== For counts of detected and suppressed errors, rerun with: -v\n==4083== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 6 from 3)\n</code></pre>\n\n<hr>\n\n<p>A return is also missing in <em>test</em> </p>\n"}], "owner": {"reputation": 3, "user_id": 2164962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c14e30cf64fda4cdc18ac61108e87f0f?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/2164962/max"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 19, "favorite_count": 0, "accepted_answer_id": 55499682, "answer_count": 1, "score": 0, "last_activity_date": 1554308445, "creation_date": 1554307348, "question_id": 55499529, "link": "https://stackoverflow.com/questions/55499529/issue-with-feeding-arrays-of-structs-as-arguments-into-pthread-create", "title": "Issue with feeding arrays of structs as arguments into pthread_create", "body": "<p>I am writing a small stepper motor control program for which I need a separate thread that checks if any of the motors requires an update. </p>\n\n<p>I keep getting stuck in passing my data structure into pthread_create() and modifying the status value of test_motor2. The following code should give an idea of what I am trying to accomplish:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;pthread.h&gt;\n\ntypedef struct motor{\n    int motor_status; \n} motor;\n\ntypedef struct argstruct{\n    int *vect;\n    struct motor *allmotors;\n} args;\n\nvoid *test(void *arg){\n\n    struct argstruct *arguments = arg;\n    int *a_array = arguments-&gt;vect;\n    a_array[0] = 80;\n\n    // HERE I GET STUCK\n    struct motor *motors = arguments-&gt;allmotors;\n    // set test_motor2 status to 1\n\n}\n\nint main(){\n\n    pthread_t sidethread;\n\n    struct motor test_motor;\n    struct motor test_motor2;\n    test_motor.motor_status = 0;\n    test_motor2.motor_status = 0;\n\n    int a[3];\n    a[0] = 8; a[1] = 3; a[2] = 2;\n\n    struct motor *all_motors[2];\n    all_motors[0] = &amp;test_motor;\n    all_motors[1] = &amp;test_motor2;\n\n    struct argstruct motors_and_a;\n    motors_and_a.allmotors = all_motors;\n    motors_and_a.vect = a;\n\n    if (pthread_create(&amp;sidethread, NULL, test, (void *)&amp;motors_and_a)){\n        printf(\"Thread could not be started\\n\");\n    }\n\n    pthread_join(sidethread, NULL);\n\n    // Check that a[0] has been set to 80\n    printf(\"a[0]: %d\\n\", a[0]);\n    // Check that test_motor2 status is now 1\n    printf(\"Status of test_motor2: %d\\n\", test_motor2.motor_status);\n\n}\n</code></pre>\n\n<p>The example works for array a but I am unable to get it working for the motors. </p>\n\n<p>Could you please help me with finding a solution?</p>\n\n<p>Thanks!</p>\n\n<p>Max</p>\n"}, {"tags": ["c", "raspberry-pi3", "can-bus", "socketcan"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1554360490, "post_id": 55499470, "comment_id": 97724187, "body": "It is important here to illuminate that whoever wrote this library uses very weird and incorrect terms. There is nothing called &quot;EFF&quot; in a CAN frame. If there was, it could only stand for End of Frame Field, a 7 bit recessive sequence sent at the end of each frame, which has absolutely nothing to do with extended and standard identifiers. So it the mask you are looking for should not be called EFF. The formal and correct name for the bit is IDE, identifier extension. This terms are all 100% formally standardized, make sure to use the correct ones."}, {"owner": {"reputation": 7093, "user_id": 5811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/591cd705ab4ddd63ab93dc407ea888f5?s=128&d=identicon&r=PG&f=1", "display_name": "Andreas Magnusson", "link": "https://stackoverflow.com/users/5811/andreas-magnusson"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1612291833, "post_id": 55499470, "comment_id": 116719604, "body": "@Lundin SocketCAN <i>is</i> the standard when it comes to dealing with CAN in Linux and SocketCAN calls it Extended Frame Format, hence <code>EFF_</code>,"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 7093, "user_id": 5811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/591cd705ab4ddd63ab93dc407ea888f5?s=128&d=identicon&r=PG&f=1", "display_name": "Andreas Magnusson", "link": "https://stackoverflow.com/users/5811/andreas-magnusson"}, "edited": false, "score": 0, "creation_date": 1612339812, "post_id": 55499470, "comment_id": 116732642, "body": "@AndreasMagnusson Oh it got standardized? The CAN standard is called ISO 11898-2. What ISO number has &quot;SocketCAN&quot; gotten?"}, {"owner": {"reputation": 7093, "user_id": 5811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/591cd705ab4ddd63ab93dc407ea888f5?s=128&d=identicon&r=PG&f=1", "display_name": "Andreas Magnusson", "link": "https://stackoverflow.com/users/5811/andreas-magnusson"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1612355021, "post_id": 55499470, "comment_id": 116739613, "body": "@Lundin Ok, so de-facto standard if you&#39;re feeling nit-picky today :)"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 7093, "user_id": 5811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/591cd705ab4ddd63ab93dc407ea888f5?s=128&d=identicon&r=PG&f=1", "display_name": "Andreas Magnusson", "link": "https://stackoverflow.com/users/5811/andreas-magnusson"}, "edited": false, "score": 0, "creation_date": 1612449426, "post_id": 55499470, "comment_id": 116774821, "body": "@AndreasMagnusson The point here is that when using something that&#39;s already properly standardized since several decades back, you stick to the standardized terms instead of inventing your own 3 letter abbreviations out of the blue."}, {"owner": {"reputation": 7093, "user_id": 5811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/591cd705ab4ddd63ab93dc407ea888f5?s=128&d=identicon&r=PG&f=1", "display_name": "Andreas Magnusson", "link": "https://stackoverflow.com/users/5811/andreas-magnusson"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1612514785, "post_id": 55499470, "comment_id": 116795785, "body": "@Lundin While that <i>is</i> a valid point, none of the people involved in this question on SO has had any influence whatsoever on the design of SocketCAN, so it&#39;s useless to make in this context. This question was tagged with <code>socketcan</code> so it doesn&#39;t matter what we would <i>like</i> things to be called but what they are <i>actually</i> called in SocketCAN."}, {"owner": {"reputation": 7093, "user_id": 5811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/591cd705ab4ddd63ab93dc407ea888f5?s=128&d=identicon&r=PG&f=1", "display_name": "Andreas Magnusson", "link": "https://stackoverflow.com/users/5811/andreas-magnusson"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1613471612, "post_id": 55499470, "comment_id": 117078875, "body": "@Lundin Funnily enough I had a work related reason to read ISO11898-1, the Data link layer part of the CAN standard. As it turns out, the CAN standard calls 29 bit IDs for <i>Extended Format</i> IDs, so it seems SocketCAN isn&#39;t that far off after all."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 7093, "user_id": 5811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/591cd705ab4ddd63ab93dc407ea888f5?s=128&d=identicon&r=PG&f=1", "display_name": "Andreas Magnusson", "link": "https://stackoverflow.com/users/5811/andreas-magnusson"}, "edited": false, "score": 0, "creation_date": 1613472675, "post_id": 55499470, "comment_id": 117079374, "body": "@AndreasMagnusson Yes it is called the extended format or extended identifier. I think the argument here was about inventing new TLA that nobody understands. The individual bits of the arbitration field apart from the identifier are named SOF, RTR/SRR and IDE in the standard."}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 11306664, "user_type": "registered", "profile_image": "https://graph.facebook.com/2614449011916892/picture?type=large", "display_name": "Mantas Serpetauskis", "link": "https://stackoverflow.com/users/11306664/mantas-serpetauskis"}, "edited": false, "score": 0, "creation_date": 1554307759, "post_id": 55499568, "comment_id": 97706095, "body": "can you explain where to put it? sorry if thats a stupid question, but i am really new  to this and my english is bad so ith hard to understand."}, {"owner": {"reputation": 17, "user_id": 11306664, "user_type": "registered", "profile_image": "https://graph.facebook.com/2614449011916892/picture?type=large", "display_name": "Mantas Serpetauskis", "link": "https://stackoverflow.com/users/11306664/mantas-serpetauskis"}, "edited": false, "score": 0, "creation_date": 1554308124, "post_id": 55499568, "comment_id": 97706295, "body": "thanks!! :)  i am going to try that now, see if it works"}], "tags": [], "owner": {"reputation": 596, "user_id": 789371, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a6a8d60cf810d14224154d35a1854aaf?s=128&d=identicon&r=PG", "display_name": "nulleight", "link": "https://stackoverflow.com/users/789371/nulleight"}, "is_accepted": true, "score": 2, "last_activity_date": 1554307890, "last_edit_date": 1554307890, "creation_date": 1554307444, "answer_id": 55499568, "question_id": 55499470, "link": "https://stackoverflow.com/questions/55499470/problems-with-sending-eff-29bit-id-message-over-socketcan/55499568#55499568", "title": "Problems with sending EFF 29bit ID message over socketCAN", "body": "<p>You need to add correct flag after setting can_id:</p>\n\n<pre><code>frame.can_id |= CAN_EFF_FLAG;\n</code></pre>\n\n<p>Or for example:\ninstead of</p>\n\n<pre><code>frame.can_id = 0x0000FEE9\n</code></pre>\n\n<p>use</p>\n\n<pre><code>frame.can_id = 0x0000FEE9U | CAN_EFF_FLAG ;\n</code></pre>\n\n<p>Here U signifies, that your integer literal is unsigned.\nAlso see <a href=\"https://github.com/linux-can/can-utils/blob/master/include/linux/can.h\" rel=\"nofollow noreferrer\">https://github.com/linux-can/can-utils/blob/master/include/linux/can.h</a></p>\n"}], "owner": {"reputation": 17, "user_id": 11306664, "user_type": "registered", "profile_image": "https://graph.facebook.com/2614449011916892/picture?type=large", "display_name": "Mantas Serpetauskis", "link": "https://stackoverflow.com/users/11306664/mantas-serpetauskis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 752, "favorite_count": 0, "accepted_answer_id": 55499568, "answer_count": 1, "score": 0, "last_activity_date": 1554307890, "creation_date": 1554307149, "question_id": 55499470, "link": "https://stackoverflow.com/questions/55499470/problems-with-sending-eff-29bit-id-message-over-socketcan", "title": "Problems with sending EFF 29bit ID message over socketCAN", "body": "<p>I am trying to  send 29bit EFF CAN messages over socket can, but for some reason it sends them with 11bit identifier cutting off 5 bytes from ID. Using loopback mode, through candump i can see that messages are received as 11bit. </p>\n\n<p>I get no errors, nothing, thats why i am confused</p>\n\n<p>I am using raspberry pi 3b+ if that makes any difference. And Can-utils library.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;string.h&gt;\n#include &lt;time.h&gt;\n#include &lt;net/if.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;sys/ioctl.h&gt;\n\n#include &lt;linux/can.h&gt;\n#include &lt;linux/can/raw.h&gt;\n\n#include &lt;/home/pi/can-utils/lib.h&gt;\n\nint main(int argc, char **argv)\n{\nint s,loop = 1;\nint nbytes;\nstruct sockaddr_can addr;\nstruct can_frame frame;\nstruct ifreq ifr;\n\n//can interface \n\nif((s=socket(PF_CAN, SOCK_RAW, CAN_RAW))&lt;0){\n    perror(\"socket\");\n    return 1;\n    }\n\n\nstrcpy(ifr.ifr_name, \"can0\");\nif(ioctl(s, SIOCGIFINDEX, &amp;ifr) &lt; 0){\n    perror(\"SIOCGIFINDEX\");\n    return 1;\n    }\n\n\naddr.can_family = AF_CAN;\naddr.can_ifindex = ifr.ifr_ifindex;\n\n\nif(bind(s,(struct sockaddr *)&amp;addr, sizeof(addr)) &lt; 0){\n    perror(\"bind\");\n    return 1;\n    }\n\n//data send loop\n\nwhile(loop){\n    int g;\n\nfor (int e = 0; e &lt; 1020; e++){\nif(e &lt; 10) {g = 0;}\n    else if (e%100 == 0){ g = 1;}\n        else if (e%50 == 0){ g = 2;}\n            else if (e%20 == 0) {g = 3;}\n\nif (g==0){  \nswitch(e){\n\n    case 1:                 //TOTAL FUEL USED 5-8\nframe.can_id = 0x0000FEE9;\n    printf(\"value %X\",frame.can_id);\nframe.can_dlc = 8;\nframe.data[0] = 0x00;\nframe.data[1] = 0x00;\nframe.data[2] = 0x00;\nframe.data[3] = 0x00;\nframe.data[4] = 0xF5;       //0.5L/BIT\nframe.data[5] = 0x06;       //0.5L/BIT\nframe.data[6] = 0x07;       //0.5L/BIT\nframe.data[7] = 0x08;       //0.5L/BIT\nbreak;\n\n    case 2:                 //FUEL LEVEL 2\nframe.can_id = 0x0000FEFC;\nframe.can_dlc = 8;\nframe.data[0] = 0x00;\nframe.data[1] = 0x88;       //0.4%/BIT\nframe.data[2] = 0x00;\nframe.data[3] = 0x00;\nframe.data[4] = 0x00;\nframe.data[5] = 0x00;\nframe.data[6] = 0x00;\nframe.data[7] = 0x00;\nbreak;\n\n    case 3:                 //TOTAL ENGINE HOURS 1-4\nframe.can_id = 0x0000FEE5;  \nframe.can_dlc = 8;\nframe.data[0] = 0x11;       //0.05h/BIT\nframe.data[1] = 0x22;       //0.05h/BIT\nframe.data[2] = 0x33;       //0.05h/BIT\nframe.data[3] = 0x44;       //0.05h/BIT\nframe.data[4] = 0x00;\nframe.data[5] = 0x00;\nframe.data[6] = 0x00;\nframe.data[7] = 0x00;\nbreak;\n\n    case 4:                 //MILLEAGE 1-4\nframe.can_id = 0x0000FEC1;  \nframe.can_dlc = 8;\nframe.data[0] = 0x44;       //5M/BIT\nframe.data[1] = 0x33;       //5M/BIT\nframe.data[2] = 0x22;       //5M/BIT\nframe.data[3] = 0x11;       //5M/BIT\nframe.data[4] = 0x00;\nframe.data[5] = 0x00;\nframe.data[6] = 0x00;\nframe.data[7] = 0x00;\nbreak;\n\n    case 5:\nframe.can_id = 0x0000FEEE;  //ENGINE TEMPERATURE 1\nframe.can_dlc = 8;\nframe.data[0] = 0xCC;       //1C/BIT -40C OFFSET\nframe.data[1] = 0x00;\nframe.data[2] = 0x00;\nframe.data[3] = 0x00;\nframe.data[4] = 0x00;\nframe.data[5] = 0x00;\nframe.data[6] = 0x00;\nframe.data[7] = 0x00;\nbreak;\n\n    case 6:\nframe.can_id = 0x0000FEF5;  //AMBIENT TEMPERATURE 4-5\nframe.can_dlc = 8;\nframe.data[0] = 0x00;\nframe.data[1] = 0x00;\nframe.data[2] = 0x00;\nframe.data[3] = 0xE4;       //0.03125C/BIT -273C OFFSET\nframe.data[4] = 0xF2;       //0.03125C/BIT -273C OFFSET\nframe.data[5] = 0x00;\nframe.data[6] = 0x00;\nframe.data[7] = 0x00;\nbreak;\n\n    case 7:                 //HIGH RES FUEL 5-8\nframe.can_id = 0x0000FD09;  \nframe.can_dlc = 8;\nframe.data[0] = 0x00;       \nframe.data[1] = 0x00;\nframe.data[2] = 0x00;\nframe.data[3] = 0x00;\nframe.data[4] = 0x01;       //0.001L/BIT\nframe.data[5] = 0x02;       //0.001L/BIT\nframe.data[6] = 0x03;       //0.001L/BIT\nframe.data[7] = 0x04;       //0.001L/BIT\nbreak;\n\n    case 8:             //VEHICLE WEIGHT 2-3\nframe.can_id = 0x0000FEEA;  \nframe.can_dlc = 8;\nframe.data[0] = 0x00;\nframe.data[1] = 0x05;       //0.5KG/BIT\nframe.data[2] = 0xFF;       //0.5KG/BIT\nframe.data[3] = 0x00;\nframe.data[4] = 0x00;\nframe.data[5] = 0x00;\nframe.data[6] = 0x00;\nframe.data[7] = 0x00;\nbreak;\n\n    case 9:             //DISTANCE BEFORE SERVICE 2-3\nframe.can_id = 0x0000FEC0;  \nframe.can_dlc = 8;\nframe.data[0] = 0x00;\nframe.data[1] = 0xEF;       //5KM/BIT -160 635 KM OFFSET\nframe.data[2] = 0xCD;       //5KM/BIT -160 635 KM OFFSET\nframe.data[3] = 0x00;\nframe.data[4] = 0x00;\nframe.data[5] = 0x00;\nframe.data[6] = 0x00;\nframe.data[7] = 0x00;\nbreak;\n    default:    \n    break;\n}\n\nfor(int i = 0; i &lt;1; i++){\n    if ((nbytes = write(s, &amp;frame, sizeof(struct can_frame))) != sizeof(frame)){\n        }\n    }\n}\n\nif (g == 1){\n    for(int l = 1; l &lt; 5; l++){\n        switch(l){\n    case 1:                 //EEC 3-5\nframe.can_id = 0x000CF004;\nframe.can_dlc = 8;\nframe.data[0] = 0x00;\nframe.data[1] = 0x00;\nframe.data[2] = 0xEE;       //TORQUE 1%/BIT -125% OFFSET\nframe.data[3] = 0xEF;       //RPM 0.125/BIT\nframe.data[4] = 0x12;       //RPM 0.125/BIT\nframe.data[5] = 0x00;\nframe.data[6] = 0x00;\nframe.data[7] = 0x00;\nbreak;\n\n    case 2:                 //FUEL ECONOMY 1-4\nframe.can_id = 0x0000FEF2;  \nframe.can_dlc = 8;\nframe.data[0] = 0xEC;       //FUEL RATE (0.05L/h)/BIT \nframe.data[1] = 0xFF;       //FUEL RATE (0.05L/h)/BIT \nframe.data[2] = 0x15;       //CURRENT FUEL (1/512KM/L)/BIT \nframe.data[3] = 0xE5;       //CURRENT FUEL (1/512KM/L)/BIT \nframe.data[4] = 0x00;\nframe.data[5] = 0x00;\nframe.data[6] = 0x00;\nframe.data[7] = 0x00;\nbreak;  \n\n    case 3:                 //WHEEL SPEED 2-3\nframe.can_id = 0x0000FEF1;  \nframe.can_dlc = 8;\nframe.data[0] = 0x00;       \nframe.data[1] = 0x01;       //(1/256KM/h)/BIT\nframe.data[2] = 0x99;       //(1/256KM/h)/BIT\nframe.data[3] = 0x00;\nframe.data[4] = 0x00;\nframe.data[5] = 0x00;\nframe.data[6] = 0x00;\nframe.data[7] = 0x00;\nbreak;\n\n    case 4:             //EEC2 2-3\nframe.can_id = 0x0000F003;\nframe.can_dlc = 8;\nframe.data[0] = 0x00;       \nframe.data[1] = 0x03;       //0.4%/BIT CCELERATOR POSITION \nframe.data[2] = 0x55;       //1%/BIT ENGINE LOAD\nframe.data[3] = 0x00;\nframe.data[4] = 0x00;\nframe.data[5] = 0x00;\nframe.data[6] = 0x00;\nframe.data[7] = 0x00;\nbreak;  \n}\n        for(int i = 0; i &lt;1; i++){\n    if ((nbytes = write(s, &amp;frame, sizeof(struct can_frame))) != sizeof(frame)){\n        }\n    }\n    if(l&lt;5) usleep(1000);\n}\n\n}\nelse if (g == 2){\n\nframe.can_id = 0x0000F003;\nframe.can_dlc = 8;\nframe.data[0] = 0x00;       \nframe.data[1] = 0x03;       //0.4%/BIT CCELERATOR POSITION \nframe.data[2] = 0x55;       //1%/BIT ENGINE LOAD\nframe.data[3] = 0x00;\nframe.data[4] = 0x00;\nframe.data[5] = 0x00;\nframe.data[6] = 0x00;\nframe.data[7] = 0x00;\n\nfor(int i = 0; i &lt;1; i++){\n    if ((nbytes = write(s, &amp;frame, sizeof(struct can_frame))) != sizeof(frame)){\n        }\n    }\n    }\nelse if (g == 3){\n\nframe.can_id = 0x0000F004;\nframe.can_dlc = 8;\nframe.data[0] = 0x00;\nframe.data[1] = 0x00;\nframe.data[2] = 0xEE;       //TORQUE 1%/BIT -125% OFFSET\nframe.data[3] = 0xEF;       //RPM 0.125/BIT\nframe.data[4] = 0x12;       //RPM 0.125/BIT\nframe.data[5] = 0x00;\nframe.data[6] = 0x00;\nframe.data[7] = 0x00;\n\nfor(int i = 0; i &lt;1; i++){\n    if ((nbytes = write(s, &amp;frame, sizeof(struct can_frame))) != sizeof(frame)){\n        }\n    }\n    }\nusleep(10000);\ng = 5;\nif(e==900) e = 0;\n}\n}                   \n\nclose(s);\nreturn 0; \n}\n</code></pre>\n"}, {"tags": ["c"], "answers": [{"tags": [], "owner": {"reputation": 45158, "user_id": 391531, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/04bbaf6d73be76d81b13f2e150017691?s=128&d=identicon&r=PG", "display_name": "nmichaels", "link": "https://stackoverflow.com/users/391531/nmichaels"}, "is_accepted": false, "score": 1, "last_activity_date": 1554310184, "creation_date": 1554310184, "answer_id": 55500336, "question_id": 55499452, "link": "https://stackoverflow.com/questions/55499452/creating-a-queue-message-returns-zero-in-id/55500336#55500336", "title": "creating a queue message returns zero in id", "body": "<p><code>==</code> binds more tightly than <code>=</code>. Try putting parentheses around the assignment of <code>queue_id</code>, or put it on its own line:</p>\n\n<pre><code>queue_id = msgget(IPC_PRIVATE, IPC_CREAT | IPC_EXCL | 0600);\nif(queue_id == -1) {\n         perror(\"queue\");\n         return -1;\n}\n</code></pre>\n\n<p>Running your compiler with <code>-Wall -Wextra -Werror</code> will help with this kind of thing.</p>\n"}], "owner": {"reputation": 11, "user_id": 11306596, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-7fsN78bIsIQ/AAAAAAAAAAI/AAAAAAAAABQ/F5etLqTLuv8/photo.jpg?sz=128", "display_name": "Silvio ", "link": "https://stackoverflow.com/users/11306596/silvio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1554319663, "creation_date": 1554307098, "last_edit_date": 1554319663, "question_id": 55499452, "link": "https://stackoverflow.com/questions/55499452/creating-a-queue-message-returns-zero-in-id", "title": "creating a queue message returns zero in id", "body": "<p>I can't figure out what I missed. The first time that I run this <code>msgget() retuns 0</code> but <code>msgctl()</code> can remove it. The second time still having <code>0</code> and <code>msgctl()</code> aborts with invalid argument error. </p>\n\n<p>Already tried to use some key instead of <code>IPC_PRIVATE</code></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;string.h&gt;\n#include &lt;signal.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/wait.h&gt;\n#include &lt;sys/ipc.h&gt;\n#include &lt;sys/shm.h&gt;\n#include &lt;sys/sem.h&gt;\n#include &lt;sys/msg.h&gt;\n#include &lt;time.h&gt;\n\n#define DEBUG\n\nint main(){\n    int queue_id;\n\n    if(queue_id = msgget(IPC_PRIVATE, IPC_CREAT | IPC_EXCL | 0600) == -1){\n         perror(\"queue\");\n         return -1;\n    }\n\n    if(msgctl(queue_id, IPC_RMID, NULL) == -1) {\n         perror(\"queue rmid:\");\n    }\n\n             return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "global-variables", "declaration"], "answers": [{"comments": [{"owner": {"reputation": 183, "user_id": 7938987, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZFuHh.png?s=128&g=1", "display_name": "Foobie Bletch", "link": "https://stackoverflow.com/users/7938987/foobie-bletch"}, "edited": false, "score": 0, "creation_date": 1554307488, "post_id": 55499465, "comment_id": 97705950, "body": "This is less than optimal because it relies on the order of the literals.  In my actual project, I&#39;m using <code>enum</code> subscripts.  Is it possible to symbolically reference individual cells of the array during initialization? If not, what options do I have other than an <code>extern const</code> array? I want the items to be static and global, and I want to be able to reference them symbolically, preferably by <code>enum</code>."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 183, "user_id": 7938987, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZFuHh.png?s=128&g=1", "display_name": "Foobie Bletch", "link": "https://stackoverflow.com/users/7938987/foobie-bletch"}, "edited": false, "score": 0, "creation_date": 1554310080, "post_id": 55499465, "comment_id": 97707289, "body": "@FoobieBletch See my edit.  You can do this with designated initializers."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1554311489, "post_id": 55499465, "comment_id": 97708006, "body": "Given their use of designated initializers, they might leave the array length out of the definition and let the compiler figure it from the initializers. Depends on what they are doing."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 0, "last_activity_date": 1554310057, "last_edit_date": 1554310057, "creation_date": 1554307135, "answer_id": 55499465, "question_id": 55499412, "link": "https://stackoverflow.com/questions/55499412/extern-const-array-declaration-initialization-error-invalid-initializer-conlfic/55499465#55499465", "title": "extern const Array Declaration/Initialization Error (invalid initializer/conlficting types)", "body": "<p>Each of these:</p>\n\n<pre><code>const int foo[0] = 0;\nconst int foo[1] = 42;\nconst int foo[2] = 69;\nconst int foo[3] = 420;\nconst int foo[4] = 9001;\n</code></pre>\n\n<p>Are separate definitions of an array variable named <code>foo</code>, each with a different size.  You're also trying to initialize these arrays with a single value.  That's why you're getting the errors.</p>\n\n<p>If you want to initialize an array, you do so as follows:</p>\n\n<pre><code>const int foo[5] = { 0, 42, 69, 420, 9001 };\n</code></pre>\n\n<p>If you need to initialize particular indexes based on enum values, you can use designated initializers to do this:</p>\n\n<pre><code>enum {\n    E1, E2, E3, E4, E5\n};\nconst int foo[5] = { \n    [E1] = 0, \n    [E2] = 42, \n    [E3] = 69, \n    [E4] = 420, \n    [E5] = 9001 \n};\n</code></pre>\n"}], "owner": {"reputation": 183, "user_id": 7938987, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZFuHh.png?s=128&g=1", "display_name": "Foobie Bletch", "link": "https://stackoverflow.com/users/7938987/foobie-bletch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 98, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1554310057, "creation_date": 1554306972, "last_edit_date": 1554307596, "question_id": 55499412, "link": "https://stackoverflow.com/questions/55499412/extern-const-array-declaration-initialization-error-invalid-initializer-conlfic", "title": "extern const Array Declaration/Initialization Error (invalid initializer/conlficting types)", "body": "<p>For a project I'm working on, I want a statically-initialized, immutable, global array--specifically an array, <i>not</i> an <code>enum</code>.  To my knowledge, the best way to do this is with an <code>extern const</code> array.  However, when I try to initialize and declare any array <code>foo</code>, I get two different but apparently related compiler errors:</p>\n\n<pre><code>error: conflicting types for `foo'\nerror: invalid initializer\n</code></pre>\n\n<p>These are repeated for every initialization in the outer scope of my <code>.c</code> file.  The former of these errors  is always followed by a note reading \"<code>previous declaration of `foo' was here</code>\" and pointing to the declaration of the array in the header file.</p>\n\n<p>In the following example...</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#ifndef __MWE__\n#define __MWE__\n\nextern const int foo[8];\n\n#endif /* MWE */\n</code></pre>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include \"mwe.h\"\nconst int foo[0] = 0;\nconst int foo[1] = 42;\nconst int foo[2] = 69;\nconst int foo[3] = 420;\nconst int foo[4] = 9001;\n\n\nint main(int argc,char**argv){return 0;}\n</code></pre>\n\n<p>...I get the following errors...</p>\n\n<pre><code>mwe.c:3:11: error: conflicting types for \u2018foo\u2019\n const int foo[0] = 0;\n           ^~~\nIn file included from mwe.c:1:0:\nmwe.h:4:18: note: previous declaration of \u2018foo\u2019 was here\n extern const int foo[5];\n                  ^~~\nmwe.c:3:20: error: invalid initializer\n const int foo[0] = 0;\n                    ^\nmwe.c:4:11: error: conflicting types for \u2018foo\u2019\n const int foo[1] = 42;\n           ^~~\nIn file included from mwe.c:1:0:\nmwe.h:4:18: note: previous declaration of \u2018foo\u2019 was here\n extern const int foo[5];\n                  ^~~\nmwe.c:4:20: error: invalid initializer\n const int foo[1] = 42;\n                    ^~\nmwe.c:5:11: error: conflicting types for \u2018foo\u2019\n const int foo[2] = 69;\n           ^~~\nIn file included from mwe.c:1:0:\nmwe.h:4:18: note: previous declaration of \u2018foo\u2019 was here\n extern const int foo[5];\n                  ^~~\nmwe.c:5:20: error: invalid initializer\n const int foo[2] = 69;\n                    ^~\nmwe.c:6:11: error: conflicting types for \u2018foo\u2019\n const int foo[3] = 420;\n           ^~~\nIn file included from mwe.c:1:0:\nmwe.h:4:18: note: previous declaration of \u2018foo\u2019 was here\n extern const int foo[5];\n                  ^~~\nmwe.c:6:20: error: invalid initializer\n const int foo[3] = 420;\n                    ^~~\nmwe.c:7:11: error: conflicting types for \u2018foo\u2019\n const int foo[4] = 9001;\n           ^~~\nIn file included from mwe.c:1:0:\nmwe.h:4:18: note: previous declaration of \u2018foo\u2019 was here\n extern const int foo[5];\n                  ^~~\nmwe.c:7:20: error: invalid initializer\n const int foo[4] = 9001;\n</code></pre>\n\n<p>What is the proper way to declare and intialize <code>extern const</code> arrays, and what is it about this way that is invalid? Where is the type conflict, and why is an integer literal an invalid initializer for an element of an integer array?</p>\n"}, {"tags": ["c", "assembly", "x86-64", "disassembly"], "comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1554314306, "post_id": 55499148, "comment_id": 97709291, "body": "Are you sure you correctly simplified the original lines of code?  Did one of them have a memory operand?  Obviously <code>test (mem),(mem)</code> can&#39;t work, so you have to use <code>cmpq $0, (mem)</code>, or load into a register.  Or maybe there was some other difference, because yes, the linked duplicate is correct that they set FLAGS identically except for AF, and <code>jle</code> doesn&#39;t look at AF.  (In fact there are no JCC instructions that look at AF, and with <code>AAA</code>, <code>DAA</code> and other BCD instructions not available in 64-bit mode, I think the only way it&#39;s observable is with <code>pushf</code> to store RFLAGS.)"}], "owner": {"reputation": 59, "user_id": 11306427, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hbemB.png?s=128&g=1", "display_name": "k0zm0tis", "link": "https://stackoverflow.com/users/11306427/k0zm0tis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 673, "favorite_count": 0, "closed_date": 1554312269, "answer_count": 0, "score": 1, "last_activity_date": 1554319674, "creation_date": 1554306135, "last_edit_date": 1554319674, "question_id": 55499148, "link": "https://stackoverflow.com/questions/55499148/what-is-the-difference-between-cmpq-0-r-and-testq-r-r", "closed_reason": "Duplicate", "title": "What is the difference between cmpq 0,R and testq R,R?", "body": "<p>(This is my first post ever on stack overflow, please lmk if I've done something wrong)<br>\nI'm currently brushing up on <code>assembly</code> code for <code>C</code> and doing some sample problems to test my understanding. One multiple-choice practice problem gives a description of the code in <code>C</code> and asks you to pick the corresponding <code>assembly</code> code. Answers <code>A</code> and <code>C</code> are clearly wrong. Answers <code>B</code> and <code>D</code> are identical (I ran them through a text comparison thing to make sure I wasn't missing anything, that's how sure I am that they're identical) except for the following two (greatly simplified) lines:</p>\n\n<pre><code># Answer B\n...\n6   testq %rax, %rax\n7   jle .L3\n...\n</code></pre>\n\n<pre><code># Answer D\n...\n6   cmpq $0, %rax\n7   jle .L3\n...\n</code></pre>\n\n<p>According to the practice problem, <code>D</code> is correct and <code>B</code> is wrong.</p>\n\n<p>But from what I understand, shouldn't they calculate the same thing? Here's my reasoning, can anyone tell me where I went wrong?<p>\n1. Both <code>testq</code> and <code>cmpq</code> alter condition codes but not the registers themselves, so nothing but the condition codes should make a difference.<br>\n2. <code>testq S1 S2</code> will set condition codes according to the calculation <code>S1&amp;S2</code>. If <code>S1==S2</code> (both <code>%rax</code> here), <code>testq</code> should set condition codes according to whatever is currently in <code>%rax</code>.<br>\n3. <code>cmpq S1 S2</code> will set condition codes according to the calculation <code>S2-S1</code>. If <code>S1==0</code>, then <code>cmpq</code> should set condition codes according to <code>%rax-0 = %rax</code>.<p>\nSo they're both setting condition codes according to the same thing, the contents of <code>%rax</code>. That was enough to really confuse me. I thought maybe looking at the problem at a lower level, specifically in terms of condition codes, might clear things up, but that didn't really help either.<p>\n4. This specific jump (jle/jng if you prefer) will jump to <code>.L3</code> if <code>(SF^OF)|ZF</code> is true.<br>\n5. <code>%rax</code> is not going to overflow on something&amp;something or something-0, so <code>OF=0</code>. Therefore it will jump if SF=1 or ZF=1.<br>\n6a. If <code>%rax</code> is negative, <code>%rax &amp; %rax</code> will still yield a negative, so SF is set and jump occurs. If <code>%rax</code> is negative, <code>%rax-$0</code> will still yield a negative, so SF is set and jump occurs.<br>\n6b. If <code>%rax</code> is 0, <code>%rax&amp;%rax</code> is 0, so ZF is set and jump occurs. If <code>%rax</code>is<code>0, %rax-0 = 0-0 = 0</code>, so <code>ZF</code> is set and jump occurs.<br>\n6c. If <code>%rax</code> is positive (and non-zero), <code>%rax&amp;%rax</code> will yield a positive (non-zero), so <code>SF=0</code> and <code>ZF=0</code> and the jump doesn't happen. If <code>%rax</code> is positive (non-zero), <code>%rax-0</code> will yield a positive (non-zero), so <code>SF=0</code> and <code>ZF=0</code> and the jump doesn't happen. <p>\nWhere did I go wrong? From what I understand after thinking about the problem, shouldn't it always be true that</p>\n\n<pre><code>testq R,R\n</code></pre>\n\n<p>has the <em>same logical outcome</em> as</p>\n\n<pre><code>cmpq $0,R\n</code></pre>\n\n<p>(Note: I know almost nothing about efficiency. It's possible one instruction is shorter or more efficient than the other, but I'm primarily concerned with the logical/condition code outcomes here. For real code and not just textbook problems, the computer/gcc will decide which one it thinks is faster later, when it optimizes it to the point of being unreadable.)</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["c", "image", "ppm", "pixelate"], "comments": [{"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 1, "creation_date": 1554307610, "post_id": 55499099, "comment_id": 97706010, "body": "You&#39;re reading a P6 ppm but outputting a P3 one, btw. Need to adjust the header appropriately. And it&#39;d be nice to add error checking and handling. Plus your code will break for images with a max color field &gt; 255 if that&#39;s a possibility for your data..."}, {"owner": {"reputation": 401, "user_id": 5551849, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/NssaZ.jpg?s=128&g=1", "display_name": "p.luck", "link": "https://stackoverflow.com/users/5551849/p-luck"}, "reply_to_user": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1554308102, "post_id": 55499099, "comment_id": 97706284, "body": "Thanks for the heads up @Shawn , I have added error checking and handling, and also changed the output fopen function to:  <code>fprintf(f_output, &quot;P6\\n%d %d\\n255\\n&quot;, w, h);</code> . I am only using images with max colour field less than or equal to 255. Do you have any idea why my output image is one solid colour?"}], "answers": [{"tags": [], "owner": {"reputation": 5371, "user_id": 7019311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2981ebd25241785e1495e511caa61a?s=128&d=identicon&r=PG&f=1", "display_name": "hidefromkgb", "link": "https://stackoverflow.com/users/7019311/hidefromkgb"}, "is_accepted": true, "score": 2, "last_activity_date": 1554682620, "last_edit_date": 1554682620, "creation_date": 1554581227, "answer_id": 55553025, "question_id": 55499099, "link": "https://stackoverflow.com/questions/55499099/how-to-pixelate-an-image/55553025#55553025", "title": "How to pixelate an image", "body": "<p>Your main mistake is that you assume to be reading and writing 4\u00d74 blocks of pixels while actually accessing pixel data linearly; your suspicion is correct.</p>\n\n<p>Consider the following example. Let there be a 12\u00d74 1-channel image:</p>\n\n<pre><code>01 02 03 04 05 06 07 08 09 10 11 12\n13 14 15 16 17 18 19 20 21 22 23 24\n25 26 27 28 29 30 31 32 33 34 35 36\n37 38 39 40 41 42 43 44 45 46 47 48\n</code></pre>\n\n<p>Each of the pixels has the color that equals its position in a PPM file.</p>\n\n<p>Now these are the pixels which you are expecting to read when pixelating the first 4\u00d74 block:</p>\n\n<pre><code>01 02 03 04\n13 14 15 16\n25 26 27 28\n37 38 39 40\n</code></pre>\n\n<p>And these are the pixels which are actually being read by sequentially executing <code>fread()</code>:</p>\n\n<pre><code>01 02 03 04 05 06 07 08 09 10 11 12\n13 14 15 16\n</code></pre>\n\n<p>So eventually you are treating the input image as if it looked like that:</p>\n\n<pre><code>01 02 03 04 05 06 07 08 09 10 11 12\n13 14 15 16                                 01 02 03 04   17 18 19 20   33 34 35 36\n            17 18 19 20 21 22 23 24   --&gt;   05 06 07 08   21 22 23 24   37 38 39 40\n25 26 27 28 29 30 31 32                     09 10 11 12   25 26 27 28   41 42 43 44\n                        33 34 35 36         13 14 15 16   29 30 31 32   45 46 47 48\n37 38 39 40 41 42 43 44 45 46 47 48\n</code></pre>\n\n<p>instead of:</p>\n\n<pre><code>01 02 03 04   05 06 07 08   09 10 11 12\n13 14 15 16   17 18 19 20   21 22 23 24\n25 26 27 28   29 30 31 32   33 34 35 36\n37 38 39 40   41 42 43 44   45 46 47 48\n</code></pre>\n\n<p>One of the simpler methods of resolving that issue is to allocate an array into which the data is to be read. Once you have that array filled with your data, you will be able to access its elements in any order, instead of the strictly linear order <code>fread()</code> implies.</p>\n"}], "owner": {"reputation": 401, "user_id": 5551849, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/NssaZ.jpg?s=128&g=1", "display_name": "p.luck", "link": "https://stackoverflow.com/users/5551849/p-luck"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 472, "favorite_count": 0, "accepted_answer_id": 55553025, "answer_count": 1, "score": 2, "last_activity_date": 1555282481, "creation_date": 1554306007, "last_edit_date": 1555282481, "question_id": 55499099, "link": "https://stackoverflow.com/questions/55499099/how-to-pixelate-an-image", "title": "How to pixelate an image", "body": "<p>I am attempting to pixelate a P6 PPM format image via the following steps: </p>\n\n<ol>\n<li>Read a PPM image in grids of 4x4 </li>\n<li>Find the average RGB colour value of each 4x4 grid </li>\n<li>Write to a <strong>new file</strong> by setting each 4x4 grid of pixels in the new image to have the average RGB colour value. </li>\n</ol>\n\n<p>The PPM file begins in the following format: </p>\n\n<pre><code>P6 \n# ignores comments in header \nwidth \nheight \nmax colour value\n</code></pre>\n\n<p><strong>My problem:</strong> \nThe output PPM image file (which I am opening using GIMP image editor, and can also be opened in any text editor like Notepad to view the raw data) consists of one flat colour block, when instead it should resemble a sort of mosaic. </p>\n\n<p><strong>Note:</strong> The 4x4 grid can be varied i.e. the higher the value of the grid dimensions, the more pixelated the output image becomes. My code has mostly been influenced from another Stack Overflow question where the user attempted a similar implementation in C#. The link to this question: \n<a href=\"https://codereview.stackexchange.com/questions/140162/pixelate-image-with-average-cell-color\">https://codereview.stackexchange.com/questions/140162/pixelate-image-with-average-cell-color</a></p>\n\n<p><strong>UPDATE:</strong> The output now seems to pixelate the first 1/5 of the image, but the rest of the output image remains one colour block. I think my issue lies in that I am treating the cells as the pixels in linear order. </p>\n\n<p>My attempt: </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;assert.h&gt;\n\n//Struct to store RGB values \ntypedef struct {\n    unsigned char r, g, b;\n} pixel;\n\nint main()\n{\n    int y, x;               //Loop iteration variables\n    int yy = 0;             //Loop iteration variables\n    int xx = 0;             //Loop iteration variables\n    char magic_number[10];  //Variable which reads P6 in the header \n    int w, h, m;            //Image dimension variables\n    pixel currentPix;       //Current pixel variable \n    int avR;                //Red declaration\n    int avG;                //Green declaration \n    int avB;                //Blue declarataion \n    int total;              //Loop iteration counter declaration \n\n    //Input file \n    FILE* f;\n    f = fopen(\"Dog2048x2048.ppm\", \"r\"); //Read PPM file \n    if (f == NULL)                      //Error notifiaction if file cannot be found \n    {\n        fprintf(stderr, \"ERROR: cannot open input file\");\n        getchar();\n        exit(1);\n    }\n    //Scan the header of the PPM file to get the magic number (P6), width\n    //height and max colour value \n    fscanf(f, \"%s %d %d %d\", &amp;magic_number, &amp;w, &amp;h, &amp;m);\n\n    //initialize file for writing (open and header)\n    FILE* f_output;\n    f_output = fopen(\"some_file.ppm\", \"w\");\n    //fprintf(f_output, \"%s %d %d %d\", magic_number, w, h, m);\n    fprintf(f_output, \"P6\\n%d %d\\n255\\n\", w, h);\n    if (f_output == NULL)                       //Error notifiaction if file cannot be found \n    {\n        fprintf(stderr, \"ERROR: cannot open output file\");\n        getchar();\n        exit(1);\n    }\n\n    // Loop through the image in 4x4 cells.\n    for (int yy = 0; yy &lt; h &amp;&amp; yy &lt; h; yy += 4)\n    {\n        for (int xx = 0; xx &lt; w &amp;&amp; xx &lt; w; xx += 4)\n        {\n            avR = 0;\n            avG = 0;\n            avB = 0;\n            total = 0;\n\n            // Store each color from the 4x4 cell into cellColors.\n            for (int y = yy; y &lt; yy + 4 &amp;&amp; y &lt; h; y++)\n            {\n                for (int x = xx; x &lt; xx + 4 &amp;&amp; x &lt; w; x++)\n                {\n                    //Reads input file stream \n                    fread(&amp;currentPix, 3, 1, f);\n\n                    //Current pixels \n                    avR += currentPix.r;\n                    avG += currentPix.g;\n                    avB += currentPix.b;\n\n                    //Counts loop iterations for later use in colour averaging\n                    total++;\n\n                }\n            }\n            //Average RGB values\n            avR /= total; \n            avG /= total;\n            avB /= total;\n\n            // Go BACK over the 4x4 cell and set each pixel to the average color.\n            for (int y = yy; y &lt; yy + 4 &amp;&amp; y &lt; h; y++)\n            {\n                for (int x = xx; x &lt; xx + 4 &amp;&amp; x &lt; w; x++)\n                {\n                    //Print out to new file \n                    fprintf(f_output, \"%i %i %i\\t\", avR, avG, avB);\n                }\n            }\n        }\n        fprintf(f_output, \"\\n\");\n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c"], "answers": [{"comments": [{"owner": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "edited": false, "score": 0, "creation_date": 1554306856, "post_id": 55499186, "comment_id": 97705628, "body": "Why do I have the feeling that you are a high reputation user who has created a new account? :)"}, {"owner": {"reputation": 804, "user_id": 5893772, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/EATNh.png?s=128&g=1", "display_name": "Reticulated Spline", "link": "https://stackoverflow.com/users/5893772/reticulated-spline"}, "edited": false, "score": 0, "creation_date": 1554307415, "post_id": 55499186, "comment_id": 97705923, "body": "Is there a benefit to smurfing accounts on SO?"}, {"owner": {"reputation": 61, "user_id": 4918601, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/90848e9bd71a6ca3d2f274496c2e3e36?s=128&d=identicon&r=PG&f=1", "display_name": "Frank", "link": "https://stackoverflow.com/users/4918601/frank"}, "edited": false, "score": 0, "creation_date": 1554307547, "post_id": 55499186, "comment_id": 97705972, "body": "thanks. now i know why it not works and got working code. :)"}, {"owner": {"reputation": 276, "user_id": 6524191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f45f1a420dfcb0039c6c180a1aae5013?s=128&d=identicon&r=PG&f=1", "display_name": "Graeme Cole", "link": "https://stackoverflow.com/users/6524191/graeme-cole"}, "reply_to_user": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "edited": false, "score": 0, "creation_date": 1554308692, "post_id": 55499186, "comment_id": 97706587, "body": "@machine_1: I don&#39;t know, but I haven&#39;t."}], "tags": [], "owner": {"reputation": 276, "user_id": 6524191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f45f1a420dfcb0039c6c180a1aae5013?s=128&d=identicon&r=PG&f=1", "display_name": "Graeme Cole", "link": "https://stackoverflow.com/users/6524191/graeme-cole"}, "is_accepted": true, "score": 4, "last_activity_date": 1554306266, "creation_date": 1554306266, "answer_id": 55499186, "question_id": 55499061, "link": "https://stackoverflow.com/questions/55499061/how-to-fix-a-print-error-about-an-array-pointer-in-c-segmentation-fault/55499186#55499186", "title": "How to fix a print error about an array pointer in C (Segmentation fault)?", "body": "<p>This is to do with operator precedence. <code>[]</code> binds more tightly than <code>*</code>, so <code>**ppp[3]</code> means <code>**(ppp[3])</code>, which won't do what you want.</p>\n\n<p>I think you want <code>(**ppp)[3]</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 45158, "user_id": 391531, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/04bbaf6d73be76d81b13f2e150017691?s=128&d=identicon&r=PG", "display_name": "nmichaels", "link": "https://stackoverflow.com/users/391531/nmichaels"}, "is_accepted": false, "score": 1, "last_activity_date": 1554312168, "creation_date": 1554312168, "answer_id": 55500868, "question_id": 55499061, "link": "https://stackoverflow.com/questions/55499061/how-to-fix-a-print-error-about-an-array-pointer-in-c-segmentation-fault/55500868#55500868", "title": "How to fix a print error about an array pointer in C (Segmentation fault)?", "body": "<p>Other people have given you what went wrong, this is how to figure it out for next time:</p>\n\n<pre><code>$ gcc -Wall -Werror -std=gnu11 -Wextra -g -O0 -o program program.c\n$ gdb ./program\n(gdb) run\nProgram received signal SIGSEGV, Segmentation fault.\nmain () at program:23\n23          printf(\" 9. %d\\n\", **ppp[3]);\n(gdb) p ppp[3]\n$1 = (int **) 0x7fffffffe2d8\n(gdb) p **ppp[3]\nCannot access memory at address 0x280000001e\n</code></pre>\n\n<p>That shows that trying to dereference <code>*ppp[3]</code> is what caused your segfault. From there, a bit of thinking and playing with it ought to get you to what went wrong. From there to trying a <code>p (**ppp)[3]</code> and seeing that it prints the result you expect shouldn't be too big a step.</p>\n"}], "owner": {"reputation": 61, "user_id": 4918601, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/90848e9bd71a6ca3d2f274496c2e3e36?s=128&d=identicon&r=PG&f=1", "display_name": "Frank", "link": "https://stackoverflow.com/users/4918601/frank"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 55499186, "answer_count": 2, "score": 0, "last_activity_date": 1554316959, "creation_date": 1554305866, "last_edit_date": 1554307320, "question_id": 55499061, "link": "https://stackoverflow.com/questions/55499061/how-to-fix-a-print-error-about-an-array-pointer-in-c-segmentation-fault", "title": "How to fix a print error about an array pointer in C (Segmentation fault)?", "body": "<p>I just started learning pointers in C. I found something special and got an error about these code, can you help me find out why the No.9 making \"Segmentation fault\" error?</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\nint main() {\n    int a[] = {10, 20, 30, 40, 50};\n    int *p[] = {a, a+1, a+2, a+3, a+4};\n    int **pp = p;\n    int ***ppp = &amp;pp;\n\n    printf(\"\\n === Part1 === \\n\\n\");\n    printf(\" 0. %p\\n\", a);\n    printf(\" 1. %p\\n\", *p);\n    printf(\" 2. %p\\n\", *pp);\n    printf(\" 3. %p\\n\", **ppp);\n\n    printf(\"\\n === Part2 === \\n\\n\");\n    printf(\" 4. %d\\n\", *p[0]);\n    printf(\" 5. %d\\n\", *pp[0]);\n    printf(\" 6. %d\\n\", **ppp[0]);\n\n    printf(\"\\n === Part3 === \\n\\n\");\n    printf(\" 7. %d\\n\", *p[3]);\n    printf(\" 8. %d\\n\", *pp[3]);\n    printf(\" 9. %d\\n\", **ppp[3]);\n\n    printf(\"\\n\");\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "linux-kernel"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1554306000, "post_id": 55498975, "comment_id": 97705076, "body": "After <code>syscall</code> fails, have you checked <code>errno</code>?"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1554306019, "post_id": 55498975, "comment_id": 97705091, "body": "This has already been asked (but not yet answered) here: <a href=\"https://stackoverflow.com/questions/55492440/why-is-my-linux-syscall-returning-a-1-in-userspace\" title=\"why is my linux syscall returning a 1 in userspace\">stackoverflow.com/questions/55492440/&hellip;</a>"}], "owner": {"reputation": 1, "user_id": 11305136, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cb64c09e9ef89a5a55054430ebb1172?s=128&d=identicon&r=PG&f=1", "display_name": "JDoe3898", "link": "https://stackoverflow.com/users/11305136/jdoe3898"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 189, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1554305601, "creation_date": 1554305601, "question_id": 55498975, "link": "https://stackoverflow.com/questions/55498975/what-is-missing-in-my-syscall-implementation", "title": "What is missing in my syscall implementation?", "body": "<p>I tried many guides and for some reason, my syscall isnt implementing correctly. ERRNO is 38 (function not implemented).  Here are my steps to creating a basic one for me as a beginner: </p>\n\n<p>I am doing this on a raspberry pi 64 bit. with linux 4.14.93</p>\n\n<p>inside \"/linux/\" folder: \nI created a folder called \"mycall\" with files mycall.c, mycall.h, &amp; Makefile</p>\n\n<p>mycall.c:</p>\n\n<pre><code>#include &lt;linux/kernel.h&gt;\n#include &lt;linux/init.h&gt;\n#include &lt;sched.h&gt;\n#include &lt;syscalls.h&gt;\n#include &lt;linux/unistd.h&gt;\n#include \"mycall.h\"\n\nasmlinkage long sys_mysyscall(int *id, int username, int *size)\n{\n printk(\"hello\");\n return 0;\n}\n</code></pre>\n\n<p>mycall.h:</p>\n\n<pre><code>asmlinkage long sys_mysyscall(int *id, int username, int *size);\n</code></pre>\n\n<p>Makefile:</p>\n\n<pre><code>obj-y := mycall.o\n</code></pre>\n\n<p>then I went into all of the places where I THOUGHT i should declare the syscall. </p>\n\n<pre><code>// inside of /linux/include/linux/syscalls.h\nasmlinkage long sys_mysyscall(int __user *myid, int username, int __user *size);\n</code></pre>\n\n<p>then to </p>\n\n<pre><code>// inside of /linux/arch/arm/tools/syscall.tbl\n398    common  mysyscall      sys_mysyscall\n</code></pre>\n\n<p>finally i added </p>\n\n<pre><code>// inside of /linux/Makefile\ncore-y    += kernel/ certs/ mm/ fs/ ipc/ security/ crypt/ block/ mycall/\n</code></pre>\n\n<p>thats my set up. then the final thing I do is make a userspace in /linux directory\nuserspace.c:</p>\n\n<pre><code>#include &lt;linux/kernel.h&gt;\n#include &lt;sys/syscall.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;pwd.h&gt;\n\nint main () \n{\nint id = 0;\nint username = 7;\nint size = 2;\nint ret_val = syscall(398, &amp;id, username, &amp;size);\nprintf(\"%d\\n\", ret_val);\nreturn 0;\n}\n// recompiling &amp; copying . then I run the userspace again\ncd ~/linux\nKERNEL=kernel7\nmake bcm2709_defconfig\nmake -j4 zImage modules dtbs\nsudo make INSTALL_MOD_PATH=/root modules_install\n\nsudo cp arch/arm/boot/dts/*.dtb /boot/\nsudo cp arch/arm/boot/dts/overlays/*.dtb* /boot/overlays/\nsudo cp arch/arm/boot/dts/overlays/README /boot/overlays/\nsudo cp arch/arm/boot/zImage /boot/$KERNEL.img\n</code></pre>\n\n<p>the return value is -1 so this doesn't work. </p>\n\n<p>please let me know what I'm doing wrong. I have read several implementation guides and have no idea how I'm implementing this wrong. </p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 1, "creation_date": 1554306433, "post_id": 55498959, "comment_id": 97705365, "body": "if <code>n</code> is smaller than 64(or 32) you could use a bitmask for the exclusion. When larger, you could use an array of bitmasks."}], "answers": [{"comments": [{"owner": {"reputation": 97, "user_id": 8196386, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155757235758455/picture?type=large", "display_name": "Ash", "link": "https://stackoverflow.com/users/8196386/ash"}, "edited": false, "score": 0, "creation_date": 1554318485, "post_id": 55499827, "comment_id": 97711418, "body": "I tried your code and it did not work. ind_col[0,..,n]=(0,1,...,n) all the time."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "reply_to_user": {"reputation": 97, "user_id": 8196386, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155757235758455/picture?type=large", "display_name": "Ash", "link": "https://stackoverflow.com/users/8196386/ash"}, "edited": false, "score": 0, "creation_date": 1554318777, "post_id": 55499827, "comment_id": 97711545, "body": "I could not test it, because the code in your question is not complete and compilable   &amp; testable. So, there could be bug in my answer."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "reply_to_user": {"reputation": 97, "user_id": 8196386, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155757235758455/picture?type=large", "display_name": "Ash", "link": "https://stackoverflow.com/users/8196386/ash"}, "edited": false, "score": 0, "creation_date": 1554319275, "post_id": 55499827, "comment_id": 97711789, "body": "Wait: I have to <b>unset</b> the bit (from the previous max) it if a maximum is found for the second time. BRB"}, {"owner": {"reputation": 97, "user_id": 8196386, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155757235758455/picture?type=large", "display_name": "Ash", "link": "https://stackoverflow.com/users/8196386/ash"}, "edited": false, "score": 0, "creation_date": 1554319904, "post_id": 55499827, "comment_id": 97712074, "body": "Thank you very much. I have also edited your code so that it can be tested. Correct output should be 2,1,0 in this case."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "reply_to_user": {"reputation": 97, "user_id": 8196386, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155757235758455/picture?type=large", "display_name": "Ash", "link": "https://stackoverflow.com/users/8196386/ash"}, "edited": false, "score": 1, "creation_date": 1554320329, "post_id": 55499827, "comment_id": 97712305, "body": "I&#39;ll update the answer with an (improved?) version."}, {"owner": {"reputation": 97, "user_id": 8196386, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155757235758455/picture?type=large", "display_name": "Ash", "link": "https://stackoverflow.com/users/8196386/ash"}, "edited": false, "score": 0, "creation_date": 1554321242, "post_id": 55499827, "comment_id": 97712771, "body": "Your improved code is producing wrong output. I will fix yours and will update my original question to make it testable."}], "tags": [], "owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "is_accepted": true, "score": 1, "last_activity_date": 1554324854, "last_edit_date": 1554324854, "creation_date": 1554308277, "answer_id": 55499827, "question_id": 55498959, "link": "https://stackoverflow.com/questions/55498959/efficient-c-code-to-find-the-column-index-of-maximum-number-in-each-matrix-row/55499827#55499827", "title": "Efficient C code to find the column index of maximum number in each matrix row", "body": "<p>Use a bitmask to mark the numbers of the used columns:</p>\n\n<p>[you could also use a plain indicator array of chars or ints]</p>\n\n<hr>\n\n<pre><code>#define ZBITS (CHAR_BIT*sizeof zzz[0])\n\n#define ZTEST(z) (zzz[z/ZBITS] &amp; (1u&lt;&lt; (z%ZBITS)))\n#define ZSET(z) zzz[z/ZBITS] |= (1u&lt;&lt; (z%ZBITS))\n\n// size of A is nxn\n\n/* ind_col is 1xn array that contains the column index of abs. max number for each row */\nint *ind_col ; \nind_col = calloc(n,sizeof *ind_col);    \n\n\n/* max_val is 1xn array that contains the abs. max number for each row */\ndouble *max_val ;  \nunsigned *zzz;\n\nmax_val = calloc(n,sizeof  *max_val);\nzzz = calloc(1+n/ZBITS, sizeof *zzz);               \n\nint i,j;\n\nfor(i=0; i&lt;n; i++){ \n  for(j=0; j&lt;n; j++) { \n    double zabs;\n\n    zabs = fabs(A[i*n+j]) ;\n    if ( zabs &lt; max_val[i]) continue;  // no new max is found\n    if (ZTEST(j)) continue; // check if the same column index was previously used\n\n    ZSET(j); // close the door ...\n    max_val[i] = zabs;             \n    ind_col[i] = j;\n    }\n\n  }\n\nfree(zzz);\n\n#undef ZBITS\n#undef ZTEST\n#undef ZSET\n</code></pre>\n\n<hr>\n\n<p>UPDATE(2):</p>\n\n<p><em>improved?</em> version using a <em>mark</em> array for the exclusion:</p>\n\n<hr>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;math.h&gt;\n\nunsigned *ihaveaname(double *A,unsigned n)\n{\n\nunsigned *ind_col ;\ndouble *max_val ;\nunsigned *mark;\nunsigned irow,jcol;\n\nind_col = calloc(n,sizeof *ind_col);\nmax_val = calloc(n,sizeof  *max_val);\nmark = calloc(n, sizeof *mark);\n\nfor(jcol=0; jcol&lt;n; jcol++) { ind_col[jcol] = n; } // sentinel\nfor(jcol=0; jcol&lt;n; jcol++) { mark[jcol] = n; } // sentinel\nfor(jcol=0; jcol&lt;n; jcol++) { max_val[jcol] = 0.0; }\n\nfor(irow=0; irow&lt;n; irow++){\n  for(jcol=0; jcol&lt;n; jcol++) {\n    double zabs;\n\n    zabs = fabs(A[irow*n+jcol]) ;\n    if (zabs &lt; max_val[irow]) continue;  // no new max is found\n    if (mark[jcol] &lt; irow) { // check if the same column index was used by a previous row\n                // fprintf(stderr,\"[Skip col%u row%u]\", jcol,irow);\n                continue;\n                }\n    if (jcol &gt; 0) { //undo previous submax\n                unsigned ocol;\n                ocol = ind_col[irow] ;\n                if (ocol &lt;jcol) {\n                        mark[ocol] = n; // reset sentinel ...\n                        // fprintf(stderr,\"[Undo ocol%u]\", ocol);\n                        }\n                }\n\n    // fprintf(stderr,\"[Mark col%u &lt;- row%u]\", jcol,irow);\n    mark[jcol] = irow; // mark our row index in here ...\n\n    max_val[irow] = zabs;\n    ind_col[irow] = jcol;\n    }\n\n    // fprintf(stderr,\"Max[%u] = %f\\n\", irow,max_val[irow]);\n  }\nfree(mark);\nfree(max_val);\nreturn ind_col;\n}\n\nint main(void)\n{\nunsigned uu, *uuu;\n\ndouble array[9]={\n        1,2,3,\n        2,3,1,\n        3,1,2};\n\nuuu = ihaveaname(array, 3);\n\nfor (uu=0;uu &lt; 3;uu++){\n        printf(\"%u:=%u\\n\", uu, uuu[uu]);\n        }\nreturn 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 97, "user_id": 8196386, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155757235758455/picture?type=large", "display_name": "Ash", "link": "https://stackoverflow.com/users/8196386/ash"}, "is_accepted": false, "score": 1, "last_activity_date": 1554341668, "creation_date": 1554341668, "answer_id": 55506611, "question_id": 55498959, "link": "https://stackoverflow.com/questions/55498959/efficient-c-code-to-find-the-column-index-of-maximum-number-in-each-matrix-row/55506611#55506611", "title": "Efficient C code to find the column index of maximum number in each matrix row", "body": "<p>This is the final code.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdint.h&gt;\n#include &lt;math.h&gt;\n#include &lt;limits.h&gt;\n\n\n\nunsigned *Find_Pivot(double *A,unsigned n)\n{\n\nunsigned *ind_col ;\nunsigned *mark;\nunsigned irow,jcol;\n\nind_col = calloc(n,sizeof *ind_col);\nmark = calloc(n, sizeof *mark);\n\nfor(jcol=0; jcol&lt;n; jcol++) { ind_col[jcol] = n; } // sentinel\nfor(jcol=0; jcol&lt;n; jcol++) { mark[jcol] = n; } // sentinel\n\ndouble max = 0;\ndouble zabs = 0;\n\nfor(irow=0; irow&lt;n; irow++){   \n  max = 0;\n  for(jcol=0; jcol&lt;n; jcol++) {         \n    zabs = fabs(A[irow*n+jcol]) ;\n    if (zabs &lt; max) continue;  // no new max is found\n    if (mark[jcol] &lt; irow)  continue;// check if the same column index was used by a previous row\n\n    if (jcol &gt; 0) {          //undo previous submax        \n        unsigned ocol = ind_col[irow] ;\n        if (ocol &lt;jcol) mark[ocol] = n; // reset sentinel ...                           \n    }\n\n    mark[jcol] = irow; // mark our row index in here ...    \n    max = zabs;\n    ind_col[irow] = jcol;\n  }\n}\n\nfree(mark);\nreturn ind_col;\n\n}\n\n\n\nint main ( unsigned long int argc, char *argv[] )\n{\n\n\nunsigned *ind_col;\n\nint n = 3;\ndouble A[9] = {6,3,2,9,8,8,10,8,9};\n\n\nind_col = Find_Pivot(A, n);\n\nint i;\nfor (i=0;i &lt; n;i++) printf(\"%i:=%i\\n\", i, ind_col[i]);\n\nreturn 0;\n\n\n}\n\n\n</code></pre>\n"}], "owner": {"reputation": 97, "user_id": 8196386, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155757235758455/picture?type=large", "display_name": "Ash", "link": "https://stackoverflow.com/users/8196386/ash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 55499827, "answer_count": 2, "score": 1, "last_activity_date": 1554341668, "creation_date": 1554305569, "last_edit_date": 1554322941, "question_id": 55498959, "link": "https://stackoverflow.com/questions/55498959/efficient-c-code-to-find-the-column-index-of-maximum-number-in-each-matrix-row", "title": "Efficient C code to find the column index of maximum number in each matrix row", "body": "<p>I have written a C code to find the column index of maximum number (absolute max) in each row of a nxn matrix. However, there is a condition! If the column index of max number in the current row is the same as one of the previous rows, the program should skip that index and find the next max in that row. </p>\n\n<p>My code works fine but performance is the main issue. Unfortunately, I have been unsuccessful so far in parallelize the code using OpenMP due to the dependencies. I really appreciate if you can help improve the performance of my code. Thank you in advance.</p>\n\n<p>Here is the code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdint.h&gt;\n#include &lt;math.h&gt;\n#include &lt;limits.h&gt;\n\nint main ( unsigned long int argc, char *argv[] )\n{\n\n    int n = 3;      \n    //double A[9] = {1,2,3,4,5,6,7,8,9}; //output: ind_col[1,..,3] = 2,1,0  max_val[1,..,3] = 3,5,7\n    double A[9] = {1,3,2,4,6,5,7,8,9}; //output: ind_col[1,..,3] = 1,2,0    max_val[1,..,3] = 3,5,7\n\n    /* ind_col is 1xn array that contains the column index of abs. max number for each row */\n    int *ind_col = NULL; \n    ind_col = (int*) calloc(n,sizeof(int)); \n\n\n    /* max_val is 1xn array that contains the abs. max number for each row */\n    double *max_val = NULL;  \n    max_val = (double*) calloc(n,sizeof(double)); \n\n    int i,j,k,rep = 0;      \n\n    for(i=0; i&lt;n; i++){       \n        for(j=0; j&lt;n; j++) {         \n\n            if ( (fabs(A[i*n+j]) &lt; max_val[i]) ) continue;  // if a new max is found, do...                      \n\n            for(k=0; k&lt;i; k++) if (ind_col[k] == j) rep = 1; // check if the same column index was not previously used\n\n            if (rep != 1) {    // if this is a new column index save it              \n                max_val[i] = fabs(A[i*n+j]);              \n                ind_col[i] = j;\n            }\n\n            rep = 0;\n        }   \n    }       \n\n    for(i=0; i&lt;n; i++) printf(\"ind_col[%i] = %i , val = %f\\n\", i, ind_col[i], A[i*n+ind_col[i]]);}            \n\n}\n</code></pre>\n"}, {"tags": ["c", "sockets"], "comments": [{"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1554305419, "post_id": 55498758, "comment_id": 97704722, "body": "Please post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> so we can reproduce the problem and help you debug it.   Note: in general, a server should have a single point where is performs a <code>accept(), start thread, and loop back to accept()</code> loop.  Then each new connection to the server starts another thread.  That single thread performs all the communication with a single client via the socket returned from <code>accept()</code>.   A single server, using a thread pool, etc can handle thousand of client connections"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1554305872, "post_id": 55498758, "comment_id": 97705000, "body": "the server thread is calling <code>accept()</code> it should not do so, that call should be in a loop, back in the main line of the server"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1554306046, "post_id": 55498758, "comment_id": 97705109, "body": "the server code is working in &#39;series&#39; rather than passing a socket, returned by <code>accept()</code> to a thread, where the thread then performs all the communication for that one connection.  One result is that the thread has no need for polling,  Just call <code>recv()</code>"}, {"owner": {"reputation": 103, "user_id": 7507867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95162ef2b1e5b5a85f0f83b257297405?s=128&d=identicon&r=PG&f=1", "display_name": "olivierhsta", "link": "https://stackoverflow.com/users/7507867/olivierhsta"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1554306357, "post_id": 55498758, "comment_id": 97705304, "body": "The reason why I don&#39;t have a thread that sole purpose is to listen to connection is because I want it to work even with just one server thread.  Also, the number of server thread may be different from the number of client thread."}, {"owner": {"reputation": 103, "user_id": 7507867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95162ef2b1e5b5a85f0f83b257297405?s=128&d=identicon&r=PG&f=1", "display_name": "olivierhsta", "link": "https://stackoverflow.com/users/7507867/olivierhsta"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1554306799, "post_id": 55498758, "comment_id": 97705593, "body": "@user3629249 (forgot to tag)"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1554328077, "post_id": 55498758, "comment_id": 97715563, "body": "You would know a LOT more info about what is going on if the code actually checked for error conditions for each of the calls to C library functions and reported those errors via <code>perror()</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1554328157, "post_id": 55498758, "comment_id": 97715585, "body": "What is the last parameter on the call to <code>listen()</code>?  Please post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> so we can help you debug the code"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1554328336, "post_id": 55498758, "comment_id": 97715655, "body": "the posted code fails to check for when <code>poll()</code> returns 0"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1554328593, "post_id": 55498758, "comment_id": 97715741, "body": "regarding: <code>return ret;</code> in the function: <code>read_socket()</code>  All that is returning is the returned status from the last call to <code>recv()</code> not very useful for the caller of that function."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1554328680, "post_id": 55498758, "comment_id": 97715774, "body": "Due to the code layout, the server is performing everything in series.  That is not fast enough to keep up with a few hundred client communications.  Strongly suggest researching how to properly handle the clients in parallel"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1554329088, "post_id": 55498758, "comment_id": 97715902, "body": "regarding: <code>socket_fd = accept(socket_fd, (struct sockaddr *)&amp;thread_addr, &amp;socket_len);     if (socket_fd&gt; 0) {</code>    1) the call to <code>accept()</code> does not change the value in the variable: <code>socket_fd</code>.  2) it does return the socket that should be used to communicate with the client.  3) The returned value from <code>accept()</code> needs to be checked to assure no error occurred,  4) a NEW socket is returned. for the server to communicate with the client.  Do NOT modify the &#39;master&#39; socket that the server uses to &#39;listen()` and <code>accept()</code> client connections"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1554380381, "post_id": 55498758, "comment_id": 97736273, "body": "What @user3629249 says: you are destroying the listening socket by overwriting it with the accept() return:("}], "owner": {"reputation": 103, "user_id": 7507867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95162ef2b1e5b5a85f0f83b257297405?s=128&d=identicon&r=PG&f=1", "display_name": "olivierhsta", "link": "https://stackoverflow.com/users/7507867/olivierhsta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 24, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1554304962, "creation_date": 1554304962, "question_id": 55498758, "link": "https://stackoverflow.com/questions/55498758/only-first-few-multithreaded-clients-can-read-response-from-socket", "title": "Only first few multithreaded clients can read response from socket", "body": "<p>I am building a client-server program in C using sockets.  Both my client and my server use a fixed number of threads to operate.  I tested with very few client and server threads at first (5 and 3) and everything seemed to work fine.  But now I tried to up the number of client threads to 500 (while the number of server thread stays at 3), but everything breaks.  The first hundred or so client can send their request and receive a response, but the others don't receive anything from the server.  </p>\n\n<p>I'm working on a Debian Windows Subsystem if that changes anything.</p>\n\n<p>I have also tried upping the number of server thread to 300 but the problem still happens.</p>\n\n<p>Here is my (very) simplified code.</p>\n\n<h2>Client thread</h2>\n\n<pre><code>  int client_socket= socket(AF_INET, SOCK_STREAM, 0);\n  struct sockaddr_in addr;\n  addr.sin_family = AF_INET;\n  addr.sin_port = htons(2018);\n  addr.sin_addr.s_addr = htonl(INADDR_LOOPBACK);\n  memset(&amp;addr.sin_zero, 0, sizeof(addr.sin_zero));\n  connect(client_socket, (struct sockaddr *) &amp;addr, sizeof(addr));\n\n  int response;\n  int cid = 1;\n\n  send(client_socket, &amp;cid, sizeof(int), 0);\n\n  int len = read_socket(socket, &amp;response, sizeof(int), 1000);\n  if (len == 0) {\n      printf(\"No response\");\n  } else {\n      printf(\"Response\");\n  }\n  close(client_socket);\n</code></pre>\n\n<h2>Server thread</h2>\n\n<pre><code>int socket_fd, cid, len;\nwhile (1)\n  {\n    socket_fd =\n        accept(socket_fd, (struct sockaddr *)&amp;thread_addr, &amp;socket_len);\n    if (socket_fd&gt; 0) {\n        int cid;\n        int len = read_socket(socket_fd, &amp;cid, sizeof(cid), 1000);\n        if (len == 0) {\n          printf(\"Nothing\");\n        }\n        send(socket_fd, &amp;cid, sizeof(int),0);\n        close(socket_fd);\n    }\n  }\n</code></pre>\n\n<p>And here is my helper function <code>read_socket()</code></p>\n\n<pre class=\"lang-c prettyprint-override\"><code>ssize_t read_socket(int sockfd, void *buf, size_t obj_sz, int timeout) {\n  int ret;\n  int len = 0;\n\n  struct pollfd fds[1];\n  fds-&gt;fd = sockfd;\n  fds-&gt;events = POLLIN;\n  fds-&gt;revents = 0;\n\n  do {\n    // wait for data or timeout\n    ret = poll(fds, 1, timeout);\n\n    if (ret &gt; 0) {\n      if (fds-&gt;revents &amp; POLLIN) {\n          ret = recv(sockfd, (char*)buf + len, obj_sz - len, 0);\n          if (ret &lt; 0) {\n            // abort connection\n            perror(\"recv()\");\n            return -1;\n          }\n          len += ret;\n      }\n    } else {\n      // TCP error or timeout\n      if (ret &lt; 0) {\n        perror(\"poll()\");\n      }\n      break;\n    }\n  } while (ret != 0 &amp;&amp; len &lt; obj_sz);\n  return ret;\n}\n</code></pre>\n\n<p>Like I said, some client can complete their execution with no problem, but a lot of them don't receive a response from the server.</p>\n"}, {"tags": ["c", "realloc", "calloc"], "comments": [{"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1554305204, "post_id": 55498729, "comment_id": 97704583, "body": "You&#39;re reducing the size of <code>newStr</code> with your <code>realloc()</code>s. After <code>newStr = realloc(newStr, strlen(&quot;&#47;&quot;));</code> the object has space just for the <code>&#39;\\0&#39;</code> string terminator"}, {"owner": {"reputation": 651, "user_id": 6119503, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c823ba11dd321ef4f4964185f9941a5c?s=128&d=identicon&r=PG&f=1", "display_name": "JC1", "link": "https://stackoverflow.com/users/6119503/jc1"}, "reply_to_user": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1554305294, "post_id": 55498729, "comment_id": 97704646, "body": "@pmg Would the correction be <code>realloc(newStr, strlen(newStr) + strlen(&quot;&#47;&quot;));</code>? Can&#39;t believe I missed that error. Thank you!"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1554305303, "post_id": 55498729, "comment_id": 97704651, "body": "You&#39;re forgetting that <code>char</code> strings in C are really called <b><i>null-terminated</b> byte strings</i>. You need to allocate space for the null-terminator as well."}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 1, "creation_date": 1554305414, "post_id": 55498729, "comment_id": 97704720, "body": "Also <code>strlen(&quot;&#47;&quot;)</code>, for me, is much more difficult to parse than <code>1</code> :)"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1554305670, "post_id": 55498729, "comment_id": 97704867, "body": "@JCI no, that is not sufficient. See my answer"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1554305836, "post_id": 55498729, "comment_id": 97704974, "body": "@pmg <i>Also <code>strlen(&quot;&#47;&quot;)</code>, for me, is much more difficult to parse than <code>1</code></i>  I&#39;ll grant that <code>strlen(&quot;&#47;&quot;)</code> certainly indicates the intent of the code better than <code>1</code> does, however."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1554329899, "post_id": 55498729, "comment_id": 97716156, "body": "regarding: <code>char *newStr = calloc(1, strlen(cdupSplit));</code>  The function: <code>strlen()</code> returns the OFFSET to the trailing NUL byte (assuming there is such a byte)  So to allocated enough room for the string, must add 1 to the value returned from <code>strlen()</code>"}], "answers": [{"comments": [{"owner": {"reputation": 651, "user_id": 6119503, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c823ba11dd321ef4f4964185f9941a5c?s=128&d=identicon&r=PG&f=1", "display_name": "JC1", "link": "https://stackoverflow.com/users/6119503/jc1"}, "edited": false, "score": 0, "creation_date": 1554305817, "post_id": 55498976, "comment_id": 97704960, "body": "Thanks, so the corrections would be to include the current size of the variable into realloc plus the new size and at also somewhere add 1 byte for the termination \\0 ?"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "reply_to_user": {"reputation": 651, "user_id": 6119503, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c823ba11dd321ef4f4964185f9941a5c?s=128&d=identicon&r=PG&f=1", "display_name": "JC1", "link": "https://stackoverflow.com/users/6119503/jc1"}, "edited": false, "score": 0, "creation_date": 1554305864, "post_id": 55498976, "comment_id": 97704992, "body": "Correct. I added <code>2</code> to include the <code>&#39;&#47;&#39;</code> character as well."}], "tags": [], "owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "is_accepted": true, "score": 3, "last_activity_date": 1554305603, "creation_date": 1554305603, "answer_id": 55498976, "question_id": 55498729, "link": "https://stackoverflow.com/questions/55498729/realloc-invalid-next-size-in-strtok-operation/55498976#55498976", "title": "realloc(): invalid next size in strtok operation", "body": "<p>This part does not make much sense:</p>\n\n<pre><code>             if (cdupAccumulator != NULL) {\n                    newStr = realloc(newStr, strlen(\"/\"));\n                    newStr = realloc(newStr, strlen(cdupAccumulator));\n                    strcat(newStr, \"/\");\n                    strcat(newStr, cdupAccumulator);\n                }\n</code></pre>\n\n<p>You keep adding new stuff to the string but resize it again and again to only hold the last part.</p>\n\n<p>You seem to assume that <code>realloc</code> increases the size be the given parameter. This is not the case. (Even then there is no space for terminating \\0)\nYou need to keep track of the current size and add to this size accordingly.</p>\n\n<p>For example like this:</p>\n\n<pre><code>if (cdupAccumulator != NULL) {\n                newStr = realloc(newStr, strlen(newStr) + strlen(cdupAccumulator) + 2);\n                strcat(newStr, \"/\");\n                strcat(newStr, cdupAccumulator);\n            }\n</code></pre>\n"}], "owner": {"reputation": 651, "user_id": 6119503, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c823ba11dd321ef4f4964185f9941a5c?s=128&d=identicon&r=PG&f=1", "display_name": "JC1", "link": "https://stackoverflow.com/users/6119503/jc1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 55498976, "answer_count": 1, "score": 0, "last_activity_date": 1554305603, "creation_date": 1554304872, "question_id": 55498729, "link": "https://stackoverflow.com/questions/55498729/realloc-invalid-next-size-in-strtok-operation", "title": "realloc(): invalid next size in strtok operation", "body": "<p>in this part of my program, I am trying to mimic the CDUP operation in ftp servers. First I get the current directory the client is at (<code>ptr2</code> and <code>buf3</code>) and then I attempt to strip off the last string separated by <code>/</code> in order to determine what the path would be if we went up a directory. However I am getting a realloc error only when I go in another directory, come back out, and attempt to CDUP again (i.e go upwards from the root directory)</p>\n\n<pre><code>                char *ptr2;\n                char buf3[255];\n                // Get current directory of application, store in buf3\n                if ((ptr2 = getcwd(buf3, sizeof(buf3))) != NULL) {\n                    printf(\"Current working dir CDUP: %s\\n\", buf3);\n                } else {\n                    perror(\"getcwd() error\");\n                }\n\n                // Strip current directory off buf3 \n                char *cdupSplit = strtok(buf3, \"/\");\n                char *cdupAccumulator = NULL;\n                char *newStr = calloc(1, strlen(cdupSplit));\n                while (cdupSplit != NULL) {\n                    if (cdupAccumulator != NULL) {\n                        newStr = realloc(newStr, strlen(\"/\"));\n                        newStr = realloc(newStr, strlen(cdupAccumulator));\n                        strcat(newStr, \"/\");\n                        strcat(newStr, cdupAccumulator);\n                    }\n                    cdupAccumulator = cdupSplit;\n                    cdupSplit = strtok(NULL, \"/\");\n                }\n                ...\n                free(newStr);\n</code></pre>\n\n<p>The error says <code>realloc(): invalid next size: 0x0000000001ac0a20 ***</code></p>\n\n<p>I'm not sure where I am going wrong, as I am freeing the <code>newStr</code> variable and it is not being passed into the next issue of the command.</p>\n"}, {"tags": ["c", "macros", "c-preprocessor", "variadic-macros"], "comments": [{"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1554305700, "post_id": 55498641, "comment_id": 97704886, "body": "Wouldn&#39;t variadic templates be a lot better suited for this since you&#39;re using C++? Example a bit like what you want at the bottom: <a href=\"https://en.cppreference.com/w/cpp/language/parameter_pack\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/language/parameter_pack</a>"}, {"owner": {"reputation": 167, "user_id": 6361537, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-IQ8bt_bPPlE/AAAAAAAAAAI/AAAAAAAAABI/37pRDRZFI9g/photo.jpg?sz=128", "display_name": "Grigorii Alekseev", "link": "https://stackoverflow.com/users/6361537/grigorii-alekseev"}, "reply_to_user": {"reputation": 2336, "user_id": 3936002, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/utGjG.png?s=128&g=1", "display_name": "H Walters", "link": "https://stackoverflow.com/users/3936002/h-walters"}, "edited": false, "score": 0, "creation_date": 1554306413, "post_id": 55498641, "comment_id": 97705349, "body": "@HWalters I change it from throwing exception to print. Now it fits to <code>c</code> tag?"}, {"owner": {"reputation": 1928, "user_id": 10734452, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ps1ig8rG6G8/AAAAAAAAAAI/AAAAAAAAAS8/yVuRLo3SyCM/photo.jpg?sz=128", "display_name": "Guillaume D", "link": "https://stackoverflow.com/users/10734452/guillaume-d"}, "edited": false, "score": 0, "creation_date": 1554307385, "post_id": 55498641, "comment_id": 97705903, "body": "Start by looking how to get the number of argument in a variadic macro <a href=\"https://stackoverflow.com/questions/2124339/c-preprocessor-va-args-number-of-arguments\">here</a>"}], "answers": [{"comments": [{"owner": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "edited": false, "score": 0, "creation_date": 1554320989, "post_id": 55498852, "comment_id": 97712639, "body": "It&#39;s actually very hard to have &quot;get the number of arguments&quot; return 0 as you can&#39;t actually call a macro with 0 arguments -- you can only call with an empty argument which will generally show up as one (empty) argument.  With a lot of work, you can write a macro that returns 0 if called with a single empty argument and the number of arguments otherwise, but the OP doesn&#39;t actually need it -- he just needs to know the difference between 1 and 2 or more arguments."}], "tags": [], "owner": {"reputation": 1928, "user_id": 10734452, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ps1ig8rG6G8/AAAAAAAAAAI/AAAAAAAAAS8/yVuRLo3SyCM/photo.jpg?sz=128", "display_name": "Guillaume D", "link": "https://stackoverflow.com/users/10734452/guillaume-d"}, "is_accepted": false, "score": 1, "last_activity_date": 1554325311, "last_edit_date": 1554325311, "creation_date": 1554305209, "answer_id": 55498852, "question_id": 55498641, "link": "https://stackoverflow.com/questions/55498641/how-to-create-macro-with-different-behavior-depending-on-parameters-number/55498852#55498852", "title": "How to create macro with different behavior depending on parameters number?", "body": "<ol>\n<li>Start by looking how to <strong>get the number of argument</strong> in a variadic\nmacro <a href=\"https://stackoverflow.com/questions/2124339/c-preprocessor-va-args-number-of-arguments\">here</a> </li>\n<li>Then when you know how to get the number of argument, you can easily\n<strong>check if this number is 0</strong>.</li>\n</ol>\n\n<p>And this snippet returns the number of argument event if this is 0:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#define PRINT(...)  (printf(\"%d\\n\", sizeof((int[]){__VA_ARGS__})/sizeof(int)))\n\nint main(void)\n{\n    PRINT();\n    PRINT(1,1);\n    PRINT(1,1,1,1);\n    return 0;\n}\n</code></pre>\n\n<p>so easily, this second snippet does the job</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#define PRINT(...)  (((sizeof((int[]){__VA_ARGS__})/sizeof(int))==0)?printf(\"do A\\n\"):printf(\"do B\\n\"))\n\nint main(void)\n{\n    PRINT();\n    PRINT(1,1);\n    PRINT(1,1,1,1);\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 167, "user_id": 6361537, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-IQ8bt_bPPlE/AAAAAAAAAAI/AAAAAAAAABI/37pRDRZFI9g/photo.jpg?sz=128", "display_name": "Grigorii Alekseev", "link": "https://stackoverflow.com/users/6361537/grigorii-alekseev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1563553960, "creation_date": 1554304629, "last_edit_date": 1563553960, "question_id": 55498641, "link": "https://stackoverflow.com/questions/55498641/how-to-create-macro-with-different-behavior-depending-on-parameters-number", "title": "How to create macro with different behavior depending on parameters number?", "body": "<p>I want to create one macro that will work differently in case when it HAS parameters or NOT. </p>\n\n<p>For example: there are two different implementation of printing error:</p>\n\n<pre><code>// 1. Print message = check code\n#define PRINT_IF(wasError) \\\n    do { if (wasError) printf(#wasError); } while(false)\n\n// 2. Throws an exception with formatted message\n#define PRINT_TEXT_IF(wasError, format, ...) \\\n    do { if (wasError) printf(format, ##__VA_ARGS__); } while(false)\n</code></pre>\n\n<p>And I'd like to have one macro for both cases.</p>\n\n<p>What I've tried is create a global macro that checks if it has parameter or not, based on approach from <a href=\"https://stackoverflow.com/questions/4421681/how-to-count-the-number-of-arguments-passed-to-a-function-that-accepts-a-variabl\">How to count the number of arguments passed to a function that accepts a variable number of arguments?</a>. </p>\n\n<pre><code>#define RANDOM_GUID \"5c300a82-2fe8-4bd3-ad12-ef13fa7b4a82\"\n#define FIRST_ARG(a1, ...) a1\n#define HAS_ARGS(...) FIRST_ARG(##__VA_ARGS__, RANDOM_GUID)\n\n#define GLOBAL_PRINT_IF(wasError, ...)             \\\n    do {                                           \\ \n      if (wasError) {                              \\\n        if (HAS_ARGS(##__VA_ARGS__)==RANDOM_GUID ) \\\n          PRINT_IF(wasError);                      \\\n        else                                       \\\n          PRINT_TEXT_IF(wasError, __VA_ARGS__);    \\\n      }                                            \\\n    } while(false)\n</code></pre>\n\n<p>I assume that because <code>FIRST_ARG</code> always return first argument, it will return <code>RANDOM_GUID</code> if <code>##__VA_ARGS__</code> are empty.</p>\n\n<p>But this code doesn't compile with  <a href=\"https://stackoverflow.com/questions/13216423/error-pasting-and-red-does-not-give-a-valid-preprocessing-token\">error: pasting &quot;.&quot; and &quot;red&quot; does not give a valid preprocessing token</a>.\nI've tried to play with <code>##</code> before <code>__VA_ARGS__</code>, but it fails with <code>expected primary-expression before \u2018==\u2019 token</code>\nin line</p>\n\n<pre><code>if (HAS_ARGS(__VA_ARGS__)==RANDOM_GUID )\n</code></pre>\n\n<p>So, what am I doing wrong? How to deal with it properly?</p>\n"}, {"tags": ["c", "linux", "struct", "kernel"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1554304601, "post_id": 55498367, "comment_id": 97704196, "body": "How is it related to kernel?"}, {"owner": {"reputation": 1, "user_id": 5600868, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e8267e38350bce2c7352d8bc4778ad1?s=128&d=identicon&r=PG&f=1", "display_name": "Boobster", "link": "https://stackoverflow.com/users/5600868/boobster"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1554304903, "post_id": 55498367, "comment_id": 97704398, "body": "This is a kernel module. I want to write something in kernel (in linux)"}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1554305994, "post_id": 55498367, "comment_id": 97705069, "body": "Please, in the population code make identificators to be consistent. <code>second_list</code> seems to be a <code>sec_list</code>, but what is <code>my_first_list</code> in the <code>list_add()</code> call? Field <code>.my_list</code> is a pointer to something which should be allocated, but I see no call to allocation function before you set <code>sec_list-&gt;my_list-&gt;variable_a = 1;</code>. Also note, that you cannot add the <b>same element</b> into the list more than once, as you do in <code>list_add(&amp;sec_list-&gt;my_list-&gt;children, &amp;my_first_list);</code>."}, {"owner": {"reputation": 1, "user_id": 5600868, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e8267e38350bce2c7352d8bc4778ad1?s=128&d=identicon&r=PG&f=1", "display_name": "Boobster", "link": "https://stackoverflow.com/users/5600868/boobster"}, "edited": false, "score": 0, "creation_date": 1554310443, "post_id": 55498367, "comment_id": 97707491, "body": "This is not exactly the code I used. In my source code I allocated and initialized everything. Also, in my source code i don&#39;t use a for to do this, I call the function that adds elements to my list with different parameters.  So this is a example to simply the explanations to get to the problem that i struggle. Thank you!"}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1554321939, "post_id": 55498367, "comment_id": 97713129, "body": "You expect us to understand what do you want from the structures definitions <b>without any comment</b> and with very <b>imprecise code</b>. But things are not so clear as you think. In the Linux kernel every double linked list consists from the <b>head</b> (of plain type <code>struct list_head</code>) and from the field of type <code>struct list_head</code> <b>embedded</b> into each element. Assuming <code>.children</code> field is that embedded field (note, in that case the field&#39;s name is quite <i>misleading</i>), what are the <b>heads</b> for your lists? How can we iterate over your lists without knowing their heads?"}], "owner": {"reputation": 1, "user_id": 5600868, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e8267e38350bce2c7352d8bc4778ad1?s=128&d=identicon&r=PG&f=1", "display_name": "Boobster", "link": "https://stackoverflow.com/users/5600868/boobster"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 249, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1554644952, "creation_date": 1554303837, "last_edit_date": 1554644952, "question_id": 55498367, "link": "https://stackoverflow.com/questions/55498367/how-could-i-iterate-through-a-list-of-list-in-kernel", "title": "How could I iterate through a list of list in kernel?", "body": "<p>I have a list implemented into another list, but I don't know how to iterate through it. Could you, please, help me with this?</p>\n\n<pre><code>LIST_HEAD(first_list);\nLIST_HEAD(second_list);\n\nstruct my_first_list {\n\n  struct list_head next;\n\n  int variable_a;\n\n}\n\n\nstruct my_second_list {\n\n  struct list_head next;\n\n  int variable_b;\n\n  struct my_first_list *my_list;\n\n}\n</code></pre>\n\n<p>I populated my_first_list like this:</p>\n\n<pre><code>struct my_second_list *sec_list_element;\n\nlist_for_each(p, &amp;second_list) {\n\n  sec_list_element = list_entry(p, struct my_second_list, next);\n\n  for(int i = 0; i &lt; 10; i++) {\n\n    sec_list-&gt;my_list-&gt;variable_a = 1;\n\n    list_add(&amp;sec_list_element-&gt;my_list-&gt;next, &amp;first_list);\n\n  }\n\n}\n</code></pre>\n\n<p>Now, I don't know how to take my elements back..\nI tried to do something like:</p>\n\n<pre><code>my_first_list *first_list_element;\nmy_second_list *sec_list_element;\nlist_for_each(p, &amp;second_list) {\n\n  sec_list_element = list_entry(p, struct my_second_list, next);\n\n  list_for_each(q, &amp;first_list) {\n\n    first_list_element = list_entry ... // and here i'm not sure what to do\n\n  }\n\n}\n</code></pre>\n\n<p>Thanks!</p>\n"}, {"tags": ["c", "git", "libgit2"], "answers": [{"tags": [], "owner": {"reputation": 324088, "user_id": 1256452, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fa1648baa6108c85886312af93bb32c0?s=128&d=identicon&r=PG", "display_name": "torek", "link": "https://stackoverflow.com/users/1256452/torek"}, "is_accepted": false, "score": 0, "last_activity_date": 1554310742, "creation_date": 1554310742, "answer_id": 55500494, "question_id": 55498059, "link": "https://stackoverflow.com/questions/55498059/what-does-git-sysdir-find-in-dirlist-in-libgit2-do/55500494#55500494", "title": "What does git_sysdir_find_in_dirlist() in libgit2 do?", "body": "<p>This is not looking at a directory <em>tree</em> but rather at delimited string containing a list of <em>directories</em>.  For instance (though this clearly isn't aimed at this particular case), as <a href=\"https://git-scm.com/docs/git/\" rel=\"nofollow noreferrer\">the top level documentation</a> says:</p>\n\n<blockquote>\n  <p><strong>GIT_ALTERNATE_OBJECT_DIRECTORIES</strong><br>\n  Due to the immutable nature of Git objects, old objects can be\n   archived into shared, read-only directories. This variable\n   specifies a \":\" separated (on Windows \";\" separated) list of Git\n   object directories which can be used to search for Git objects. New\n   objects will not be written to these directories.</p>\n  \n  <p>Entries that begin with \" (double-quote) will be interpreted as\n   C-style quoted paths, removing leading and trailing double-quotes\n   and respecting backslash escapes. E.g., the value\n   <strong>\"path-with-\\\"-and-:-in-it\":vanilla-path</strong> has two paths:\n   <strong>path-with-\"-and-:-in-it</strong> and <strong>vanilla-path</strong>.</p>\n</blockquote>\n\n<p>The function is obviously scanning a character-separated path list (whatever that character is\u2014probably colon or semicolon as above), checking for backslash prefixes, so that you can write <code>/a:C\\:/a</code> to allow the thing to look into either <code>/a</code> or <code>C:/a</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 407, "user_id": 444323, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b9d6086e0608c5bf16fb9cee9eb548ca?s=128&d=identicon&r=PG", "display_name": "tiennou", "link": "https://stackoverflow.com/users/444323/tiennou"}, "is_accepted": false, "score": 0, "last_activity_date": 1554366498, "creation_date": 1554366498, "answer_id": 55511222, "question_id": 55498059, "link": "https://stackoverflow.com/questions/55498059/what-does-git-sysdir-find-in-dirlist-in-libgit2-do/55511222#55511222", "title": "What does git_sysdir_find_in_dirlist() in libgit2 do?", "body": "<p>This function is tasked with locating the file <code>name</code> inside a \"configuration level\", (ie. <code>~/.git/</code>, <code>/etc/git</code>, see <a href=\"https://github.com/libgit2/libgit2/blob/master/src/sysdir.h#L78\" rel=\"nofollow noreferrer\">git_sysdir_t</a> for a list of known locations). As those levels are stored as a bunch of static (\"readonly\") <code>/</code> (or <code>\\</code>)-separated C strings, and we can't modify that at runtime, we have to jump through hoops to what amounts to a foreach-string loop.</p>\n"}], "owner": {"reputation": 1256, "user_id": 4949938, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7586b74526dc4ef59eb6f8b6d4cb6a94?s=128&d=identicon&r=PG", "display_name": "mxplusb", "link": "https://stackoverflow.com/users/4949938/mxplusb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 22, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1554366498, "creation_date": 1554302964, "question_id": 55498059, "link": "https://stackoverflow.com/questions/55498059/what-does-git-sysdir-find-in-dirlist-in-libgit2-do", "title": "What does git_sysdir_find_in_dirlist() in libgit2 do?", "body": "<p>I'm working on porting some logic from libgit2 into Go, but not a 1:1 port as Go works differently. I think this function scans a directory tree, but I'm not sure.</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>static int git_sysdir_find_in_dirlist(\n    git_buf *path,\n    const char *name,\n    git_sysdir_t which,\n    const char *label)\n{\n    // allocations\n    size_t len;\n    const char *scan, *next = NULL;\n    const git_buf *syspath;\n\n    // check the path to make sure it exists?\n    GIT_ERROR_CHECK_ERROR(git_sysdir_get(&amp;syspath, which));\n    if (!syspath || !git_buf_len(syspath))\n        goto done;\n\n    // this is the part I don't understand\n    for (scan = git_buf_cstr(syspath); scan; scan = next) {\n        /* find unescaped separator or end of string */\n        for (next = scan; *next; ++next) {\n            if (*next == GIT_PATH_LIST_SEPARATOR &amp;&amp;\n                (next &lt;= scan || next[-1] != '\\\\'))\n                break;\n        }\n\n        len = (size_t)(next - scan);\n        next = (*next ? next + 1 : NULL);\n        if (!len)\n            continue;\n\n        GIT_ERROR_CHECK_ERROR(git_buf_set(path, scan, len));\n        if (name)\n            GIT_ERROR_CHECK_ERROR(git_buf_joinpath(path, path-&gt;ptr, name));\n\n        if (git_path_exists(path-&gt;ptr))\n            return 0;\n    }\n\ndone:\n    git_buf_dispose(path);\n    git_error_set(GIT_ERROR_OS, \"the %s file '%s' doesn't exist\", label, name);\n    return GIT_ENOTFOUND;\n}\n</code></pre>\n\n<p>It's the for loop that's confusing me. <code>for (scan = git_buf_cstr(syspath); scan; scan = next) { ... }</code> looks like it's iterating/scanning <code>syspath</code>, and then I get totally lost at <code>for (scan = git_buf_cstr(syspath); scan; scan = next) { ... }</code>.</p>\n\n<p>What does this function specifically do?</p>\n"}, {"tags": ["c", "recursion"], "comments": [{"owner": {"reputation": 22777, "user_id": 133203, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Fp3hB.jpg?s=128&g=1", "display_name": "Federico klez Culloca", "link": "https://stackoverflow.com/users/133203/federico-klez-culloca"}, "edited": false, "score": 1, "creation_date": 1554302320, "post_id": 55497769, "comment_id": 97702548, "body": "&quot;it didn&#39;t worked well&quot; meaning what, exactly?"}, {"owner": {"reputation": 26552, "user_id": 448932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QgLLl.png?s=128&g=1", "display_name": "500 - Internal Server Error", "link": "https://stackoverflow.com/users/448932/500-internal-server-error"}, "edited": false, "score": 2, "creation_date": 1554302346, "post_id": 55497769, "comment_id": 97702568, "body": "You should not <code>return 1</code> for the child searches but rather what the inner calls to <code>searchTree</code> return."}, {"owner": {"reputation": 343, "user_id": 10905279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c67005ead86ba8a7ad9d464e879fbb5e?s=128&d=identicon&r=PG&f=1", "display_name": "Liu", "link": "https://stackoverflow.com/users/10905279/liu"}, "edited": false, "score": 0, "creation_date": 1554302498, "post_id": 55497769, "comment_id": 97702673, "body": "&quot;It didn&#39;t work well&quot; means when I use searchTree to insert an array with a for loop, only the first element  of the array is inserted."}, {"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 1, "creation_date": 1554302763, "post_id": 55497769, "comment_id": 97702873, "body": "You aren&#39;t using the return value from searchTree"}, {"owner": {"reputation": 343, "user_id": 10905279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c67005ead86ba8a7ad9d464e879fbb5e?s=128&d=identicon&r=PG&f=1", "display_name": "Liu", "link": "https://stackoverflow.com/users/10905279/liu"}, "edited": false, "score": 0, "creation_date": 1554302839, "post_id": 55497769, "comment_id": 97702921, "body": "Could you explain why should I use return value from search Tree?"}, {"owner": {"reputation": 344, "user_id": 8877217, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec886d4b5b1bdafa8b9ef5d452ba932e?s=128&d=identicon&r=PG&f=1", "display_name": "Sharad Khanna", "link": "https://stackoverflow.com/users/8877217/sharad-khanna"}, "edited": false, "score": 0, "creation_date": 1554302970, "post_id": 55497769, "comment_id": 97703020, "body": "Im confused about what the purpose of p and T1 are"}, {"owner": {"reputation": 804, "user_id": 5893772, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/EATNh.png?s=128&g=1", "display_name": "Reticulated Spline", "link": "https://stackoverflow.com/users/5893772/reticulated-spline"}, "edited": false, "score": 0, "creation_date": 1554302996, "post_id": 55497769, "comment_id": 97703035, "body": "If you don&#39;t use the return value your function will only ever return 1 or 0..."}, {"owner": {"reputation": 343, "user_id": 10905279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c67005ead86ba8a7ad9d464e879fbb5e?s=128&d=identicon&r=PG&f=1", "display_name": "Liu", "link": "https://stackoverflow.com/users/10905279/liu"}, "edited": false, "score": 0, "creation_date": 1554303472, "post_id": 55497769, "comment_id": 97703433, "body": "Thank you guys, I figured out."}], "answers": [{"comments": [{"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1554303514, "post_id": 55498199, "comment_id": 97703466, "body": "Hello  Liu, again  ;-)"}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "reply_to_user": {"reputation": 343, "user_id": 10905279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c67005ead86ba8a7ad9d464e879fbb5e?s=128&d=identicon&r=PG&f=1", "display_name": "Liu", "link": "https://stackoverflow.com/users/10905279/liu"}, "edited": false, "score": 0, "creation_date": 1554303759, "post_id": 55498199, "comment_id": 97703660, "body": "that depends on the case, here it is just an <i>int</i> so the value can be returned in a register, else it is in the stack"}, {"owner": {"reputation": 343, "user_id": 10905279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c67005ead86ba8a7ad9d464e879fbb5e?s=128&d=identicon&r=PG&f=1", "display_name": "Liu", "link": "https://stackoverflow.com/users/10905279/liu"}, "edited": false, "score": 0, "creation_date": 1554303799, "post_id": 55498199, "comment_id": 97703686, "body": "there you go we have a chat link"}], "tags": [], "owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "is_accepted": true, "score": 1, "last_activity_date": 1554303364, "creation_date": 1554303364, "answer_id": 55498199, "question_id": 55497769, "link": "https://stackoverflow.com/questions/55497769/what-is-wrong-with-the-recursion-in-c/55498199#55498199", "title": "What is wrong with the recursion in C", "body": "<p>you missed to return the value of the recursive call</p>\n\n<p>if you need to do a recursive call this is not for nothing ;-)</p>\n\n<pre><code>int searchTree(treeNode *T, int key, treeNode *T1, treeNode** p)\n{\n    if(!T)\n    {\n        *p=T1;\n        return 0;\n    }\n    else if(T-&gt;val==key)\n    {\n        *p=T;\n        return 1;\n    }\n    else if(T-&gt;val&lt;key)\n    {\n        return searchTree(T-&gt;right,key,T,p);\n    }\n    else\n    {\n        return searchTree(T-&gt;left,key,T,p);\n    }\n}\n</code></pre>\n\n<p>Note that because the recursion is <em>terminal</em> the compiler can remove it and produce a loop ...and you can do that by yourself too ;-)</p>\n"}], "owner": {"reputation": 343, "user_id": 10905279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c67005ead86ba8a7ad9d464e879fbb5e?s=128&d=identicon&r=PG&f=1", "display_name": "Liu", "link": "https://stackoverflow.com/users/10905279/liu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "accepted_answer_id": 55498199, "answer_count": 1, "score": -2, "last_activity_date": 1554303364, "creation_date": 1554302161, "question_id": 55497769, "link": "https://stackoverflow.com/questions/55497769/what-is-wrong-with-the-recursion-in-c", "title": "What is wrong with the recursion in C", "body": "<p>I tried to search a tree node with a specific value in a binary search tree.<br/>\nSo I used recursion, but it didn't worked well. <br/>\nI want to know what is wrong with the function. <br/> </p>\n\n<p>Someone said I should return the function when I call it in itself.<br/>\nIt actually worked, but I don't understand why. Can someone explain to me how <br/> recursion really works and what if the return type is void?\nThank you!</p>\n\n<pre><code>typedef struct node\n{\n    struct node* left;\n    struct node* right;\n    int val;\n}treeNode;\nint searchTree(treeNode *T, int key, treeNode *T1, treeNode** p)\n{\n    if(!T)\n    {\n        *p=T1;\n        return 0;\n    }\n    else if(T-&gt;val==key)\n    {\n        *p=T;\n        return 1;\n    }\n    else if(T-&gt;val&lt;key)\n    {\n        searchTree(T-&gt;right,key,T,p);\n    }\n    else\n    {\n        searchTree(T-&gt;left,key,T,p);\n    }\n    return 1;\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 168120, "user_id": 102937, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1233ec65168f4aae4d939ae8fe6cde1e?s=128&d=identicon&r=PG", "display_name": "Robert Harvey", "link": "https://stackoverflow.com/users/102937/robert-harvey"}, "edited": false, "score": 2, "creation_date": 1554301741, "post_id": 55497526, "comment_id": 97702149, "body": "You&#39;d be better off using ordinary array notation here, as in <code>intArr[i]</code> in your <code>scanf</code> loop.  There&#39;s no good reason to do pointer arithmetic here."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 2, "creation_date": 1554301764, "post_id": 55497526, "comment_id": 97702168, "body": "At which line do you expect the content of intarr to change? Where do you think that you initialise it?"}, {"owner": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "edited": false, "score": 0, "creation_date": 1554301802, "post_id": 55497526, "comment_id": 97702198, "body": "You probably meant <code>int * intArr = p;</code> <b>after</b> <code>malloc</code>."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 4, "creation_date": 1554301810, "post_id": 55497526, "comment_id": 97702207, "body": "<code>int intArr[]</code> declares an array of size 0 which is not possible in C. This code does not compile. Please post the code you&#39;re having problems with and not some made up fake code."}, {"owner": {"reputation": 168120, "user_id": 102937, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1233ec65168f4aae4d939ae8fe6cde1e?s=128&d=identicon&r=PG", "display_name": "Robert Harvey", "link": "https://stackoverflow.com/users/102937/robert-harvey"}, "edited": false, "score": 0, "creation_date": 1554302286, "post_id": 55497526, "comment_id": 97702532, "body": "<a href=\"https://repl.it/repls/CheapLightgreyDominspector\" rel=\"nofollow noreferrer\">repl.it/repls/CheapLightgreyDominspector</a> - Notice that <code>intArr</code> is just declared as a pointer (to the first element in the array)."}], "answers": [{"tags": [], "owner": {"reputation": 346, "user_id": 11298380, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-qDMJ2feSns4/AAAAAAAAAAI/AAAAAAAAGiA/pHTe4HDDerI/photo.jpg?sz=128", "display_name": "The Coding Penguin", "link": "https://stackoverflow.com/users/11298380/the-coding-penguin"}, "is_accepted": false, "score": 0, "last_activity_date": 1554301864, "creation_date": 1554301864, "answer_id": 55497654, "question_id": 55497526, "link": "https://stackoverflow.com/questions/55497526/confuse-about-pointer-and-arrays/55497654#55497654", "title": "Confuse about pointer and arrays", "body": "<p>Your <code>intArr[]</code> is never initialized. <code>malloc()</code> gives <code>p</code> a new value which is the address of the memory slot it allocated for it on line 5 : </p>\n\n<pre><code>p=intArr;                       // This is overridden\np=(int *)malloc(n*sizeof(int)); // by this\n</code></pre>\n\n<p>So, any further call to <code>intArray</code> will produce unpredictable output.</p>\n"}, {"comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 1, "creation_date": 1554302115, "post_id": 55497668, "comment_id": 97702409, "body": "This reads like recommending to mix arrays and pointer arithmetic or at least tolerating it. One step further towards the source of the problem would probably be more helpful in the long run. (Downvote not by me.)"}], "tags": [], "owner": {"reputation": 6899, "user_id": 1212012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gmBY7.png?s=128&g=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1212012/mathieu"}, "is_accepted": false, "score": 0, "last_activity_date": 1554302320, "last_edit_date": 1554302320, "creation_date": 1554301906, "answer_id": 55497668, "question_id": 55497526, "link": "https://stackoverflow.com/questions/55497526/confuse-about-pointer-and-arrays/55497668#55497668", "title": "Confuse about pointer and arrays", "body": "<p>The problem comes from :</p>\n\n<pre><code>p = intArr;\np = malloc(...);\n</code></pre>\n\n<p>Doing this, the value of <code>p</code> is lost on the second line.</p>\n\n<p>You should have written </p>\n\n<pre><code>p = malloc(...);\nintArr = p;\n</code></pre>\n\n<p>or </p>\n\n<pre><code>intArr = malloc(...);\np = intArr;\n</code></pre>\n\n<p>Note:</p>\n\n<ol>\n<li>Writting <code>int intArr[];</code> does not compile (at least on gcc 8.3) I assume you wrote <code>int *intArr;</code> </li>\n<li>A compiler should have warn you about the problem : with option <strong><code>-Wall</code></strong>, gcc says: \n\n<blockquote>\n  <p>warning: \u2018intArr\u2019 is used uninitialized in this function [-Wuninitialized]</p>\n</blockquote></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "is_accepted": false, "score": 1, "last_activity_date": 1554302036, "creation_date": 1554302036, "answer_id": 55497727, "question_id": 55497526, "link": "https://stackoverflow.com/questions/55497526/confuse-about-pointer-and-arrays/55497727#55497727", "title": "Confuse about pointer and arrays", "body": "<p>Perhaps your intent was to use a variable sized array, initializing it after reading <code>n</code>:</p>\n\n<pre><code>// read 'n'\nint n;\nscanf(\"%d\",&amp;n);\n\n// create an automatic (temporary) array of size 'n'\n// which will be deallocated once it leaves scope\nint intArr[n];\n\n// this part is just making it harder for compiler to \n// do static analysis - why not simply use `intArr`?\nint * p = intArr;\n</code></pre>\n\n<p>But since you are using <code>malloc</code>, you don't need the temporary array at all and could have just used:</p>\n\n<pre><code>// read 'n'\nint n;\nscanf(\"%d\",&amp;n);\n\n// allocate an array of size 'n'\nint * p = malloc(n * sizeof *p);\n\n...\n\n// release the memory \nfree(p);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 168120, "user_id": 102937, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1233ec65168f4aae4d939ae8fe6cde1e?s=128&d=identicon&r=PG", "display_name": "Robert Harvey", "link": "https://stackoverflow.com/users/102937/robert-harvey"}, "edited": false, "score": 1, "creation_date": 1554305112, "post_id": 55498635, "comment_id": 97704528, "body": "Well, sure.  But they don&#39;t have to be using pointer arithmetic either."}, {"owner": {"reputation": 1928, "user_id": 10734452, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ps1ig8rG6G8/AAAAAAAAAAI/AAAAAAAAAS8/yVuRLo3SyCM/photo.jpg?sz=128", "display_name": "Guillaume D", "link": "https://stackoverflow.com/users/10734452/guillaume-d"}, "reply_to_user": {"reputation": 168120, "user_id": 102937, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1233ec65168f4aae4d939ae8fe6cde1e?s=128&d=identicon&r=PG", "display_name": "Robert Harvey", "link": "https://stackoverflow.com/users/102937/robert-harvey"}, "edited": false, "score": 0, "creation_date": 1554306052, "post_id": 55498635, "comment_id": 97705113, "body": "well, agreed. :)"}], "tags": [], "owner": {"reputation": 1928, "user_id": 10734452, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ps1ig8rG6G8/AAAAAAAAAAI/AAAAAAAAAS8/yVuRLo3SyCM/photo.jpg?sz=128", "display_name": "Guillaume D", "link": "https://stackoverflow.com/users/10734452/guillaume-d"}, "is_accepted": false, "score": 0, "last_activity_date": 1554304602, "creation_date": 1554304602, "answer_id": 55498635, "question_id": 55497526, "link": "https://stackoverflow.com/questions/55497526/confuse-about-pointer-and-arrays/55498635#55498635", "title": "Confuse about pointer and arrays", "body": "<p>look at this correction:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main()\n{ \n    int *p,i,n;\n    scanf(\"%d\",&amp;n);\n    p=(int *)malloc(n*sizeof(int));\n    for(i=0;i&lt;n;i++)\n    {\n        scanf(\"%d\",p+i);\n    }\n    for(i=0;i&lt;n;i++)\n    {\n        printf(\"%d\\n\",*(p+i));\n\n    }\n    return 0;\n}\n</code></pre>\n\n<p>See that this works and there is no purpose of using intArray</p>\n"}], "owner": {"reputation": 17, "user_id": 10599500, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-9RRotyHgoVM/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbBEkgZVLqe2KaIb45LZOHx4erqxpQ/mo/photo.jpg?sz=128", "display_name": "Aman Agrawal", "link": "https://stackoverflow.com/users/10599500/aman-agrawal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "answer_count": 4, "score": -2, "last_activity_date": 1554304602, "creation_date": 1554301518, "last_edit_date": 1554301654, "question_id": 55497526, "link": "https://stackoverflow.com/questions/55497526/confuse-about-pointer-and-arrays", "title": "Confuse about pointer and arrays", "body": "<p>I have problem regarding the last printf statement why cant we use intarr to print the array it is showing some junk value.</p>\n\n<pre><code>int main() { \n    int intArr[],*p,i,n;\n    scanf(\"%d\",&amp;n);\n    p=intArr;\n    p=(int *)malloc(n*sizeof(int));\n    for(i=0;i&lt;n;i++)\n    {\n        scanf(\"%d\",p+i);\n    }\n    for(i=0;i&lt;n;i++)\n    {\n        printf(\"%d\",intArr[i]);\n\n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "gcc", "assembly", "cygwin", "nasm"], "comments": [{"owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 2, "creation_date": 1554301452, "post_id": 55497459, "comment_id": 97701970, "body": "You need to tell g++ as well that you want 32 bit output. Add <code>-m32</code> option."}, {"owner": {"reputation": 17456, "user_id": 159072, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/217605bccd955128d5ffc2c6e3d8267e?s=128&d=identicon&r=PG&f=1", "display_name": "user366312", "link": "https://stackoverflow.com/users/159072/user366312"}, "reply_to_user": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 0, "creation_date": 1554301657, "post_id": 55497459, "comment_id": 97702106, "body": "@Jester, adding <code>-m32</code> is giving even bigger error."}, {"owner": {"reputation": 14659, "user_id": 2705055, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b1d5dfaf239229501a184c8858fbc954?s=128&d=identicon&r=PG&f=1", "display_name": "Martin Rosenau", "link": "https://stackoverflow.com/users/2705055/martin-rosenau"}, "edited": false, "score": 1, "creation_date": 1554302471, "post_id": 55497459, "comment_id": 97702650, "body": "64-bit MINGW does not support generating 32-bit executable files that simply. A lot of library files are missing..."}, {"owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 1, "creation_date": 1554302895, "post_id": 55497459, "comment_id": 97702967, "body": "You will need to install the 32 bit cygwin stuff."}, {"owner": {"reputation": 596, "user_id": 789371, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a6a8d60cf810d14224154d35a1854aaf?s=128&d=identicon&r=PG", "display_name": "nulleight", "link": "https://stackoverflow.com/users/789371/nulleight"}, "edited": false, "score": 0, "creation_date": 1554304916, "post_id": 55497459, "comment_id": 97704408, "body": "If you want to get the libraries the easy way, here is my suggestion:  Remove cygwin and Install msys2 from msys2.org run in msys2 shell: &quot;pacman -S base-devel mingw-w64-i686-toolchain mingw-w64-x86_64-toolchain  mingw-w64-x86_64-nasm&quot; Add the following to path: &quot;C:\\msys64\\usr\\bin&quot; and depending on which you want default &quot;C:\\msys64\\mingw64\\bin&quot;  or &quot;C:\\msys64\\mingw32\\bin&quot; Also it is easy to update, just run &quot;pacman -Syu&quot; from time to time."}, {"owner": {"reputation": 17456, "user_id": 159072, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/217605bccd955128d5ffc2c6e3d8267e?s=128&d=identicon&r=PG&f=1", "display_name": "user366312", "link": "https://stackoverflow.com/users/159072/user366312"}, "reply_to_user": {"reputation": 596, "user_id": 789371, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a6a8d60cf810d14224154d35a1854aaf?s=128&d=identicon&r=PG", "display_name": "nulleight", "link": "https://stackoverflow.com/users/789371/nulleight"}, "edited": false, "score": 0, "creation_date": 1554305838, "post_id": 55497459, "comment_id": 97704979, "body": "@nulleight, hmmm....good info. Let me try."}, {"owner": {"reputation": 596, "user_id": 789371, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a6a8d60cf810d14224154d35a1854aaf?s=128&d=identicon&r=PG", "display_name": "nulleight", "link": "https://stackoverflow.com/users/789371/nulleight"}, "edited": false, "score": 0, "creation_date": 1554308763, "post_id": 55497459, "comment_id": 97706630, "body": "You can search packages and libs to install with &quot;pacman -Ss &lt;libname&gt;&quot; You can also install nano editor or mc (midnight commander) if you are a linux user and have to use windows. Also when you install make, you have to call it with &quot;mingw32-make&quot; instead of just make. There are also alot of libraries and tools like python with both 64 and 32 bit installable side by side."}, {"owner": {"reputation": 28355, "user_id": 4788546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2jWn.jpg?s=128&g=1", "display_name": "CristiFati", "link": "https://stackoverflow.com/users/4788546/cristifati"}, "edited": false, "score": 0, "creation_date": 1554315790, "post_id": 55497459, "comment_id": 97710045, "body": "Where did you get <i>nasm</i>? What about installing <i>32bit</i> <i>Cygwin</i> as well? Check <a href=\"https://stackoverflow.com/questions/54206577/can-you-run-a-32-bit-cygwin-application-in-a-64-bit-installation/54216105#54216105\" title=\"can you run a 32 bit cygwin application in a 64 bit installation\">stackoverflow.com/questions/54206577/&hellip;</a>."}, {"owner": {"reputation": 17456, "user_id": 159072, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/217605bccd955128d5ffc2c6e3d8267e?s=128&d=identicon&r=PG&f=1", "display_name": "user366312", "link": "https://stackoverflow.com/users/159072/user366312"}, "reply_to_user": {"reputation": 28355, "user_id": 4788546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2jWn.jpg?s=128&g=1", "display_name": "CristiFati", "link": "https://stackoverflow.com/users/4788546/cristifati"}, "edited": false, "score": 0, "creation_date": 1554315838, "post_id": 55497459, "comment_id": 97710071, "body": "@CristiFati, In Cygwin64."}, {"owner": {"reputation": 28355, "user_id": 4788546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2jWn.jpg?s=128&g=1", "display_name": "CristiFati", "link": "https://stackoverflow.com/users/4788546/cristifati"}, "edited": false, "score": 0, "creation_date": 1554315981, "post_id": 55497459, "comment_id": 97710152, "body": "Sure, I&#39;ve also checked <i>setup.exe</i> (should have done it before posting the comment)."}], "answers": [{"tags": [], "owner": {"reputation": 28355, "user_id": 4788546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2jWn.jpg?s=128&g=1", "display_name": "CristiFati", "link": "https://stackoverflow.com/users/4788546/cristifati"}, "is_accepted": true, "score": 2, "last_activity_date": 1554341493, "last_edit_date": 1554341493, "creation_date": 1554341003, "answer_id": 55506553, "question_id": 55497459, "link": "https://stackoverflow.com/questions/55497459/how-can-i-compile-a-hybrid-asm-c-source-code-into-a-32bit-program/55506553#55506553", "title": "How can I compile a hybrid (asm, C) source code into a 32bit program?", "body": "<p>As I pointed it out in the comment, <a href=\"https://stackoverflow.com/questions/54206577/can-you-run-a-32-bit-cygwin-application-in-a-64-bit-installation/54216105#54216105\">[SO]: Can you run a 32 bit Cygwin application in a 64 bit installation? (@CristiFati's answer)</a> contains lots of useful info.</p>\n\n<p>I want to start with 2 observations:</p>\n\n<ul>\n<li><em>gcc</em> <em>64bit</em> needs the <em>-m32</em> flag (and viceversa: <em>gcc</em> <em>32bit</em> needs <em>-m64</em>), otherwise they will generate binaries that match their <em>CPU</em> architecture. <em>32bit</em> and <em>64bit</em> object (<em>.o</em>) files are incompatible (when passed to the linker) and it will fail</li>\n<li><em>Cygwin</em> (including <em>gcc</em>) <strong>uses <em>Win</em> executables format or <em>PE</em></strong> (<a href=\"https://en.wikipedia.org/wiki/Portable_Executable\" rel=\"nofollow noreferrer\">[Wikipedia]: Portable Executable</a>). <em>nasm</em>'s output formats (<em>elf32</em> and <em>elf64</em>) <strong>generate <em>ELF</em>s</strong> (<a href=\"https://en.wikipedia.org/wiki/Executable_and_Linkable_Format\" rel=\"nofollow noreferrer\">[Wikipedia]: Executable and Linkable Format</a>). I don't know how this works (well obviously, somewhere a format conversion takes place, but I don't know where exactly). For rigorousity's sake, I'll be using their <em>Win</em> counterparts (<em>win32</em> and <em>win64</em>) which work as well (check <code>nasm -hf</code>)</li>\n</ul>\n\n<p>I too encountered the same behavior on <em>Cygwin 32</em> (before you edited the question):</p>\n\n\n\n<pre class=\"lang-bash prettyprint-override\"><code>[cfati@cfati-5510-0:/cygdrive/e/Work/Dev/StackOverflow/q055497459]&gt; ~/sopr.sh\n*** Set shorter prompt to better fit when pasted in StackOverflow (or other) pages ***\n\n[prompt]&gt; uname -a\nCYGWIN_NT-10.0-WOW cfati-5510-0 2.11.2(0.329/5/3) 2018-11-08 14:30 i686 Cygwin\n[prompt]&gt;\n[prompt]&gt; ls\nasm.asm  asm.o  builds  main.cpp  Makefile\n[prompt]&gt; make\nMAKE Version 5.2  Copyright (c) 1987, 1998 Inprise Corp.\n        g++  -o main.o -c  main.cpp\n        g++   -o executable main.o asm.o -lstdc++\nmain.o:main.cpp:(.text+0x5a): undefined reference to `GetValueFromASM'\ncollect2: error: ld returned 1 exit status\n\n** error 1 ** deleting executable\n</code></pre>\n\n<p>I must mention that I don't have <em>nasm</em> installed here, so I've built (the <em>32bit</em>) <em>asm.o</em> on <em>Cygwin 64</em>. Since switching between terminals is annoying, I completely switched to <em>Cygwin 64</em>, where I have the <em>32bit</em> <em>gcc</em> (<em>i686-pc-cygwin-gcc</em>) installed.</p>\n\n<p>I've also modified 2 of your files (<em>Makefile</em> can be improved a lot, but that's not the main focus now).</p>\n\n<p><em>main.cpp</em>:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include &lt;iostream&gt;\n\nusing namespace std;\n\nextern \"C\" int GetValueFromASM();\n\n\nint main() {\n    cout &lt;&lt; \"sizeof(void*): \" &lt;&lt; sizeof(void*) &lt;&lt; endl;\n    cout &lt;&lt; \"GetValueFromASM() returned: \" &lt;&lt; GetValueFromASM() &lt;&lt; endl;\n\n    return 0;\n}\n</code></pre>\n\n<p><em>Makefile</em>:</p>\n\n<pre class=\"lang-bash prettyprint-override\"><code>.PHONY: all clean executable\n\nobjects = main.o asm.o\ncpp = g++\ncpp = i686-pc-cygwin-gcc\n#m32_flag = -m32\nasm_out_format = win32\n#link_verbose_flag = -v\n\nall: executable\n\nclean:\n    rm -f $(objects) executable\n\nexecutable: $(objects)\n    $(cpp) $(link_verbose_flag) $(m32_flag) -o $@ $(objects) -lstdc++\n\nasm.o: asm.asm\n    nasm -f $(asm_out_format) -o $@ $?\n\nmain.o: main.cpp\n    $(cpp) $(m32_flag) -o $@ -c $?\n</code></pre>\n\n<p>After a few attempts, I identified the cause of the problem:</p>\n\n<pre class=\"lang-bash prettyprint-override\"><code>[cfati@cfati-5510-0:/cygdrive/e/Work/Dev/StackOverflow/q055497459]&gt; ~/sopr.sh\n*** Set shorter prompt to better fit when pasted in StackOverflow (or other) pages ***\n\n[prompt]&gt; uname -a\nCYGWIN_NT-10.0 cfati-5510-0 3.0.5(0.338/5/3) 2019-03-31 11:17 x86_64 Cygwin\n[prompt]&gt;\n[prompt]&gt; ls\nasm.asm  builds  main.cpp  Makefile\n[prompt]&gt; make\ni686-pc-cygwin-gcc  -o main.o -c main.cpp\nnasm -f win32 -o asm.o asm.asm\ni686-pc-cygwin-gcc   -o executable main.o asm.o -lstdc++\nmain.o:main.cpp:(.text+0x5a): undefined reference to `GetValueFromASM'\ncollect2: error: ld returned 1 exit status\nmake: *** [Makefile:17: executable] Error 1\n[prompt]&gt;\n[prompt]&gt; nm -S asm.o | grep GetValueFromASM\n00000000 T GetValueFromASM\n[prompt]&gt;\n[prompt]&gt; nm -S main.o | grep GetValueFromASM\n         U _GetValueFromASM\n</code></pre>\n\n<p>So (notice the <em>GetValueFromASM</em> <em>vs.</em> <strong><em>_</strong>GetValueFromASM</em> mismatch), it's a matter of <em>name mangling</em> (although the error message is not very helpful) that happens on <em>Win</em> (<strong><em>32bit</em> only</strong>). <br><a href=\"https://stackoverflow.com/questions/1034852/adding-leading-underscores-to-assembly-symbols-with-gcc-on-win32/1035937#1035937\">[SO]: Adding leading underscores to assembly symbols with GCC on Win32? (@ephemient's answer)</a> did the trick (there are other solutions, but they don't look very nice). All you need to do is <strong>changing <em>GetValueFromASM</em>'s declaration to</strong>:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>extern \"C\" int GetValueFromASM() asm (\"GetValueFromASM\");\n</code></pre>\n\n<p>and after building (on <em>Cygwin 64</em>):</p>\n\n<blockquote>\n<pre class=\"lang-bash prettyprint-override\"><code>[prompt]&gt; uname -a\nCYGWIN_NT-10.0-WOW cfati-5510-0 2.11.2(0.329/5/3) 2018-11-08 14:30 i686 Cygwin\n[prompt]&gt;\n[prompt]&gt; file executable.exe\nexecutable.exe: PE32 executable (console) Intel 80386, for MS Windows\n[prompt]&gt; ./executable.exe\nsizeof(void*): 4\nGetValueFromASM() returned: 9\n</code></pre>\n</blockquote>\n"}], "owner": {"reputation": 17456, "user_id": 159072, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/217605bccd955128d5ffc2c6e3d8267e?s=128&d=identicon&r=PG&f=1", "display_name": "user366312", "link": "https://stackoverflow.com/users/159072/user366312"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "accepted_answer_id": 55506553, "answer_count": 1, "score": 1, "last_activity_date": 1554341493, "creation_date": 1554301365, "last_edit_date": 1554341197, "question_id": 55497459, "link": "https://stackoverflow.com/questions/55497459/how-can-i-compile-a-hybrid-asm-c-source-code-into-a-32bit-program", "title": "How can I compile a hybrid (asm, C) source code into a 32bit program?", "body": "<p>I am using Cygwin under Win7 in a 64-bit machine.</p>\n\n<p>The following program compiles in 64-bit mode without any issue.</p>\n\n<h2>makefile</h2>\n\n<pre><code>runme: main.cpp asm.o\n    g++ main.cpp asm.o -o executable\n\nasm.o: asm.asm\n    nasm -f elf64 asm.asm -o asm.o\n</code></pre>\n\n<h2>asm.asm</h2>\n\n<pre><code>section .data\nsection .bss\nsection .text\n    global GetValueFromASM\n\nGetValueFromASM:\n    mov eax, 9\n    ret\n</code></pre>\n\n<h2>main.cpp</h2>\n\n<pre><code>#include &lt;iostream&gt;\n\nusing namespace std;\n\nextern \"C\" int GetValueFromASM();\n\nint main()\n{\n    cout&lt;&lt;\"GetValueFromASM() returned = \"&lt;&lt;GetValueFromASM()&lt;&lt;endl;\n\n    return 0;\n} \n</code></pre>\n\n<p>But, I want to compile it in 32-bit mode. So, I changed <code>elf64</code> to <code>elf</code> and my new makefile looks like the following:</p>\n\n<h2>makefile</h2>\n\n<pre><code>runme: main.cpp asm.o\n    g++ main.cpp asm.o -o executable\n\nasm.o: asm.asm\n    nasm -f elf asm.asm -o asm.o\n</code></pre>\n\n<p>But, I am getting the following error:</p>\n\n<pre><code>$ make\nnasm -f elf asm.asm -o asm.o\ng++ main.cpp asm.o -o executable\n/usr/lib/gcc/x86_64-pc-cygwin/7.4.0/../../../../x86_64-pc-cygwin/bin/ld: i386 \narchitecture of input file `asm.o' is incompatible with i386:x86-64 output\ncollect2: error: ld returned 1 exit status\nmake: *** [makefile:4: runme] Error 1\n</code></pre>\n\n<p>What could be the reason?</p>\n\n<p>How can I get around this issue?</p>\n\n<p><strong>Edit-1</strong>: I have added <code>-m32</code> option in <code>g++</code>. Now, the error is as follows:</p>\n\n<pre><code>$ make\ng++ -m32 main.cpp asm.o -o executable\n/usr/lib/gcc/x86_64-pc-cygwin/7.4.0/../../../../x86_64-pc-cygwin/bin/ld: skipping incompatible /usr/lib/gcc/x86_64-pc-cygwin/7.4.0//libstdc++.dll.a when searching for -lstdc++\n/usr/lib/gcc/x86_64-pc-cygwin/7.4.0/../../../../x86_64-pc-cygwin/bin/ld: skipping incompatible /usr/lib/gcc/x86_64-pc-cygwin/7.4.0//libstdc++.a when searching for -lstdc++\n/usr/lib/gcc/x86_64-pc-cygwin/7.4.0/../../../../x86_64-pc-cygwin/bin/ld: skipping incompatible /usr/lib/gcc/x86_64-pc-cygwin/7.4.0//libstdc++.a when searching for -lstdc++\n/usr/lib/gcc/x86_64-pc-cygwin/7.4.0/../../../../x86_64-pc-cygwin/bin/ld: skipping incompatible /usr/lib/gcc/x86_64-pc-cygwin/7.4.0/libstdc++.dll.a when searching for -lstdc++\n/usr/lib/gcc/x86_64-pc-cygwin/7.4.0/../../../../x86_64-pc-cygwin/bin/ld: skipping incompatible /usr/lib/gcc/x86_64-pc-cygwin/7.4.0/libstdc++.a when searching for -lstdc++\n/usr/lib/gcc/x86_64-pc-cygwin/7.4.0/../../../../x86_64-pc-cygwin/bin/ld: skipping incompatible /usr/lib/gcc/x86_64-pc-cygwin/7.4.0/libstdc++.a when searching for -lstdc++\n/usr/lib/gcc/x86_64-pc-cygwin/7.4.0/../../../../x86_64-pc-cygwin/bin/ld: skipping incompatible /usr/lib/gcc/x86_64-pc-cygwin/7.4.0//libstdc++.dll.a when searching for -lstdc++\n/usr/lib/gcc/x86_64-pc-cygwin/7.4.0/../../../../x86_64-pc-cygwin/bin/ld: skipping incompatible /usr/lib/gcc/x86_64-pc-cygwin/7.4.0//libstdc++.a when searching for -lstdc++\n/usr/lib/gcc/x86_64-pc-cygwin/7.4.0/../../../../x86_64-pc-cygwin/bin/ld: skipping incompatible /usr/lib/gcc/x86_64-pc-cygwin/7.4.0/libstdc++.dll.a when searching for -lstdc++\n/usr/lib/gcc/x86_64-pc-cygwin/7.4.0/../../../../x86_64-pc-cygwin/bin/ld: skipping incompatible /usr/lib/gcc/x86_64-pc-cygwin/7.4.0/libstdc++.a when searching for -lstdc++\n/usr/lib/gcc/x86_64-pc-cygwin/7.4.0/../../../../x86_64-pc-cygwin/bin/ld: cannot find -lstdc++\n/usr/lib/gcc/x86_64-pc-cygwin/7.4.0/../../../../x86_64-pc-cygwin/bin/ld: skipping incompatible /usr/lib/gcc/x86_64-pc-cygwin/7.4.0//libgcc_s.dll.a when searching for -lgcc_s\n/usr/lib/gcc/x86_64-pc-cygwin/7.4.0/../../../../x86_64-pc-cygwin/bin/ld: skipping incompatible /usr/lib/gcc/x86_64-pc-cygwin/7.4.0/libgcc_s.dll.a when searching for -lgcc_s\n/usr/lib/gcc/x86_64-pc-cygwin/7.4.0/../../../../x86_64-pc-cygwin/bin/ld: skipping incompatible /usr/lib/gcc/x86_64-pc-cygwin/7.4.0//libgcc_s.dll.a when searching for -lgcc_s\n/usr/lib/gcc/x86_64-pc-cygwin/7.4.0/../../../../x86_64-pc-cygwin/bin/ld: skipping incompatible /usr/lib/gcc/x86_64-pc-cygwin/7.4.0/libgcc_s.dll.a when searching for -lgcc_s\n/usr/lib/gcc/x86_64-pc-cygwin/7.4.0/../../../../x86_64-pc-cygwin/bin/ld: cannot find -lgcc_s\n/usr/lib/gcc/x86_64-pc-cygwin/7.4.0/../../../../x86_64-pc-cygwin/bin/ld: skipping incompatible /usr/lib/gcc/x86_64-pc-cygwin/7.4.0//libgcc.a when searching for -lgcc\n/usr/lib/gcc/x86_64-pc-cygwin/7.4.0/../../../../x86_64-pc-cygwin/bin/ld: skipping incompatible /usr/lib/gcc/x86_64-pc-cygwin/7.4.0//libgcc.a when searching for -lgcc\n/usr/lib/gcc/x86_64-pc-cygwin/7.4.0/../../../../x86_64-pc-cygwin/bin/ld: skipping incompatible /usr/lib/gcc/x86_64-pc-cygwin/7.4.0/libgcc.a when searching for -lgcc\n/usr/lib/gcc/x86_64-pc-cygwin/7.4.0/../../../../x86_64-pc-cygwin/bin/ld: skipping incompatible /usr/lib/gcc/x86_64-pc-cygwin/7.4.0/libgcc.a when searching for -lgcc\n/usr/lib/gcc/x86_64-pc-cygwin/7.4.0/../../../../x86_64-pc-cygwin/bin/ld: skipping incompatible /usr/lib/gcc/x86_64-pc-cygwin/7.4.0//libgcc.a when searching for -lgcc\n/usr/lib/gcc/x86_64-pc-cygwin/7.4.0/../../../../x86_64-pc-cygwin/bin/ld: skipping incompatible /usr/lib/gcc/x86_64-pc-cygwin/7.4.0/libgcc.a when searching for -lgcc\n/usr/lib/gcc/x86_64-pc-cygwin/7.4.0/../../../../x86_64-pc-cygwin/bin/ld: cannot find -lgcc\n/usr/lib/gcc/x86_64-pc-cygwin/7.4.0/../../../../x86_64-pc-cygwin/bin/ld: skipping incompatible /usr/lib/gcc/x86_64-pc-cygwin/7.4.0/../../../libcygwin.a when searching for -lcygwin\n/usr/lib/gcc/x86_64-pc-cygwin/7.4.0/../../../../x86_64-pc-cygwin/bin/ld: skipping incompatible /usr/lib/gcc/x86_64-pc-cygwin/7.4.0/../../../libcygwin.a when searching for -lcygwin\n/usr/lib/gcc/x86_64-pc-cygwin/7.4.0/../../../../x86_64-pc-cygwin/bin/ld: skipping incompatible /usr/lib/gcc/x86_64-pc-cygwin/7.4.0/../../../libcygwin.a when searching for -lcygwin\n/usr/lib/gcc/x86_64-pc-cygwin/7.4.0/../../../../x86_64-pc-cygwin/bin/ld: cannot find -lcygwin\n/usr/lib/gcc/x86_64-pc-cygwin/7.4.0/../../../../x86_64-pc-cygwin/bin/ld: cannot find -ladvapi32\n/usr/lib/gcc/x86_64-pc-cygwin/7.4.0/../../../../x86_64-pc-cygwin/bin/ld: cannot find -lshell32\n/usr/lib/gcc/x86_64-pc-cygwin/7.4.0/../../../../x86_64-pc-cygwin/bin/ld: cannot find -luser32\n/usr/lib/gcc/x86_64-pc-cygwin/7.4.0/../../../../x86_64-pc-cygwin/bin/ld: cannot find -lkernel32\n/usr/lib/gcc/x86_64-pc-cygwin/7.4.0/../../../../x86_64-pc-cygwin/bin/ld: skipping incompatible /usr/lib/gcc/x86_64-pc-cygwin/7.4.0//libgcc_s.dll.a when searching for -lgcc_s\n/usr/lib/gcc/x86_64-pc-cygwin/7.4.0/../../../../x86_64-pc-cygwin/bin/ld: skipping incompatible /usr/lib/gcc/x86_64-pc-cygwin/7.4.0/libgcc_s.dll.a when searching for -lgcc_s\n/usr/lib/gcc/x86_64-pc-cygwin/7.4.0/../../../../x86_64-pc-cygwin/bin/ld: skipping incompatible /usr/lib/gcc/x86_64-pc-cygwin/7.4.0//libgcc_s.dll.a when searching for -lgcc_s\n/usr/lib/gcc/x86_64-pc-cygwin/7.4.0/../../../../x86_64-pc-cygwin/bin/ld: skipping incompatible /usr/lib/gcc/x86_64-pc-cygwin/7.4.0/libgcc_s.dll.a when searching for -lgcc_s\n/usr/lib/gcc/x86_64-pc-cygwin/7.4.0/../../../../x86_64-pc-cygwin/bin/ld: cannot find -lgcc_s\n/usr/lib/gcc/x86_64-pc-cygwin/7.4.0/../../../../x86_64-pc-cygwin/bin/ld: skipping incompatible /usr/lib/gcc/x86_64-pc-cygwin/7.4.0//libgcc.a when searching for -lgcc\n/usr/lib/gcc/x86_64-pc-cygwin/7.4.0/../../../../x86_64-pc-cygwin/bin/ld: skipping incompatible /usr/lib/gcc/x86_64-pc-cygwin/7.4.0//libgcc.a when searching for -lgcc\n/usr/lib/gcc/x86_64-pc-cygwin/7.4.0/../../../../x86_64-pc-cygwin/bin/ld: skipping incompatible /usr/lib/gcc/x86_64-pc-cygwin/7.4.0/libgcc.a when searching for -lgcc\n/usr/lib/gcc/x86_64-pc-cygwin/7.4.0/../../../../x86_64-pc-cygwin/bin/ld: skipping incompatible /usr/lib/gcc/x86_64-pc-cygwin/7.4.0/libgcc.a when searching for -lgcc\n/usr/lib/gcc/x86_64-pc-cygwin/7.4.0/../../../../x86_64-pc-cygwin/bin/ld: skipping incompatible /usr/lib/gcc/x86_64-pc-cygwin/7.4.0//libgcc.a when searching for -lgcc\n/usr/lib/gcc/x86_64-pc-cygwin/7.4.0/../../../../x86_64-pc-cygwin/bin/ld: skipping incompatible /usr/lib/gcc/x86_64-pc-cygwin/7.4.0/libgcc.a when searching for -lgcc\n/usr/lib/gcc/x86_64-pc-cygwin/7.4.0/../../../../x86_64-pc-cygwin/bin/ld: cannot find -lgcc\ncollect2: error: ld returned 1 exit status\nmake: *** [makefile:4: runme] Error 1\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1554301464, "post_id": 55497456, "comment_id": 97701975, "body": "There were days, when you couldn&#39;t specify parameters in function declaration."}, {"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "edited": false, "score": 0, "creation_date": 1554305602, "post_id": 55497456, "comment_id": 97704822, "body": "The <i>most likely</i> explanation is that this is a mistake that wasn&#39;t caught in review.  As long as the code calling <code>A_Pain</code> passes the right argument type, there won&#39;t be any runtime issues.  Depending on the compiler and the warning levels, no diagnostic may have been issued, or it may have been &quot;just&quot; a warning which was ignored."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1554379113, "post_id": 55497456, "comment_id": 97735458, "body": "@KamilCuk: Doom <i>is</i> old, but not <i>that</i> old."}], "answers": [{"comments": [{"owner": {"reputation": 810, "user_id": 10219898, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-GjlxDE0oils/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oewkIiJSLyayzx-5toA0pVXvS9QQ/mo/photo.jpg?sz=128", "display_name": "Marvin Irwin", "link": "https://stackoverflow.com/users/10219898/marvin-irwin"}, "edited": false, "score": 0, "creation_date": 1554301663, "post_id": 55497500, "comment_id": 97702109, "body": "The rest of the program is written with headers, except this part.  Is there any conceivable advantage to this approach?"}, {"owner": {"reputation": 10151, "user_id": 1153165, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fee10843adffc656f32cdfa67aa425c5?s=128&d=identicon&r=PG", "display_name": "CS Pei", "link": "https://stackoverflow.com/users/1153165/cs-pei"}, "reply_to_user": {"reputation": 810, "user_id": 10219898, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-GjlxDE0oils/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oewkIiJSLyayzx-5toA0pVXvS9QQ/mo/photo.jpg?sz=128", "display_name": "Marvin Irwin", "link": "https://stackoverflow.com/users/10219898/marvin-irwin"}, "edited": false, "score": 0, "creation_date": 1554301917, "post_id": 55497500, "comment_id": 97702284, "body": "One advantage I could think of is that if the signature of A_Pain changed, you just need to change enemy.C but you don&#39; t need to change info.C. That being said that you still need to recompile both."}, {"owner": {"reputation": 22777, "user_id": 133203, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Fp3hB.jpg?s=128&g=1", "display_name": "Federico klez Culloca", "link": "https://stackoverflow.com/users/133203/federico-klez-culloca"}, "reply_to_user": {"reputation": 810, "user_id": 10219898, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-GjlxDE0oils/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oewkIiJSLyayzx-5toA0pVXvS9QQ/mo/photo.jpg?sz=128", "display_name": "Marvin Irwin", "link": "https://stackoverflow.com/users/10219898/marvin-irwin"}, "edited": false, "score": 0, "creation_date": 1554301919, "post_id": 55497500, "comment_id": 97702286, "body": "@MarvinIrwin you <i>would</i> expect consistency inside a codebase, but you would be wrong most of the time :)"}], "tags": [], "owner": {"reputation": 10151, "user_id": 1153165, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fee10843adffc656f32cdfa67aa425c5?s=128&d=identicon&r=PG", "display_name": "CS Pei", "link": "https://stackoverflow.com/users/1153165/cs-pei"}, "is_accepted": true, "score": 3, "last_activity_date": 1554301481, "creation_date": 1554301481, "answer_id": 55497500, "question_id": 55497456, "link": "https://stackoverflow.com/questions/55497456/why-define-a-function-in-a-source-file-then-declare-it-in-another-before-using/55497500#55497500", "title": "Why define a function in a source file, then declare it in another before using its reference?", "body": "<p>This is not good practice I think. But based on my understanding of the C standard, when you declare a function like <code>void A_Pain();</code> basically that function can take any number of parameters, which is different from C++. So in C you need to use <code>void A_Pain(void);</code> to say it has no parameter.</p>\n\n<p>But in C++, <code>void A_Pain();</code> means that it takes no parameters.</p>\n"}, {"tags": [], "owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "is_accepted": false, "score": 0, "last_activity_date": 1554301681, "creation_date": 1554301681, "answer_id": 55497584, "question_id": 55497456, "link": "https://stackoverflow.com/questions/55497456/why-define-a-function-in-a-source-file-then-declare-it-in-another-before-using/55497584#55497584", "title": "Why define a function in a source file, then declare it in another before using its reference?", "body": "<p>In C, the declaration <code>T f()</code> does not declare a function <code>f</code> returning <code>T</code> and taking zero parameters; it declares a function <code>f</code> returning <code>T</code> and accepting an unspecified number of parameters.</p>\n\n<p>You can put function declarations in a source file even if the function definition is in a translation unit that your source file is not aware of, since joining it all together is done by the linker, not the compiler.</p>\n"}, {"tags": [], "owner": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "is_accepted": false, "score": 0, "last_activity_date": 1554302352, "creation_date": 1554302352, "answer_id": 55497831, "question_id": 55497456, "link": "https://stackoverflow.com/questions/55497456/why-define-a-function-in-a-source-file-then-declare-it-in-another-before-using/55497831#55497831", "title": "Why define a function in a source file, then declare it in another before using its reference?", "body": "<blockquote>\n  <p>Why wouldn't a header file be used?</p>\n</blockquote>\n\n<p>It doesn't make a real difference, header files are just textual inclusion anyway. It <em>makes sense</em> to put declarations in header files, especially if they're used in several places, but it's not <em>required</em>. As long as every compilation unit agrees on what the name means, things will work fine.</p>\n\n<blockquote>\n  <p>Why declare the functions in a different source file with different signatures?</p>\n</blockquote>\n\n<p>They don't have <em>different</em> signatures; if they did, there would be a problem. But the declaration in <code>info.c</code> has <em>no</em> parameter list. This is allowed as long as \"the parameter list <em>[in the definition]</em> shall not have an ellipsis terminator and the type of each parameter shall be compatible with the type that results from the default argument promotions\" (N1256 6.7.5.3, which is probably the wrong version of the spec for application to Doom, but it doesn't really matter). In other words, if a function is declared without a signature, the number and types of its parameters will be inferred from how it's called. As long as this inference is <em>correct</em>, you have a valid program that will work correctly. It's just old-fashioned, and because of the lack of explicitness, a bit harder to maintain.</p>\n"}], "owner": {"reputation": 810, "user_id": 10219898, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-GjlxDE0oils/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oewkIiJSLyayzx-5toA0pVXvS9QQ/mo/photo.jpg?sz=128", "display_name": "Marvin Irwin", "link": "https://stackoverflow.com/users/10219898/marvin-irwin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 137, "favorite_count": 0, "accepted_answer_id": 55497500, "answer_count": 3, "score": 2, "last_activity_date": 1554302352, "creation_date": 1554301360, "last_edit_date": 1554301896, "question_id": 55497456, "link": "https://stackoverflow.com/questions/55497456/why-define-a-function-in-a-source-file-then-declare-it-in-another-before-using", "title": "Why define a function in a source file, then declare it in another before using its reference?", "body": "<p>I found the following pattern in the DOOM source and I'm not sure what to make of it.</p>\n\n<p><a href=\"https://github.com/id-Software/DOOM/blob/master/linuxdoom-1.10/p_enemy.c\" rel=\"nofollow noreferrer\">The definition .c file</a></p>\n\n<p><a href=\"https://github.com/id-Software/DOOM/blob/master/linuxdoom-1.10/info.c\" rel=\"nofollow noreferrer\">The declaration and use .c file</a></p>\n\n<p><code>enemy.c</code></p>\n\n<pre><code>// A nice definition, but there is no corresponding header file, kind of weird\nvoid A_Pain (mobj_t* actor)\n{\n    if (actor-&gt;info-&gt;painsound)\n    S_StartSound (actor, actor-&gt;info-&gt;painsound);   \n}\n\n</code></pre>\n\n<p><code>info.c</code></p>\n\n<pre><code>// Now it's redeclared, but without a parameter?\nvoid A_Pain();\n// ...\nstate_t states[NUMSTATES] = {\n// ...\n    {SPR_PLAY,6,4,{A_Pain},S_PLAY,0,0}, // S_PLAY_PAIN2\n// ...\n}\n</code></pre>\n\n<p>Why wouldn't a header file be used, when the rest of the code base uses them?  Is there an advantage to this method?</p>\n\n<p>Why declare the functions in a different source file with different signatures?</p>\n"}, {"tags": ["c", "graph", "controls", "preprocessor", "flow"], "comments": [{"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 1, "creation_date": 1554301370, "post_id": 55497414, "comment_id": 97701921, "body": "What about <code>#define pi do{ if (external_function()) { abort(); } printf(&quot; I am in macro!\\n&quot;); another_external_function(); }while(0)</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 346, "user_id": 11298380, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-qDMJ2feSns4/AAAAAAAAAAI/AAAAAAAAGiA/pHTe4HDDerI/photo.jpg?sz=128", "display_name": "The Coding Penguin", "link": "https://stackoverflow.com/users/11298380/the-coding-penguin"}, "is_accepted": false, "score": 1, "last_activity_date": 1554301599, "creation_date": 1554301599, "answer_id": 55497548, "question_id": 55497414, "link": "https://stackoverflow.com/questions/55497414/do-i-have-to-consider-preprocessor-directives-in-a-control-flow-graph/55497548#55497548", "title": "Do I have to consider preprocessor directives in a control flow graph?", "body": "<p>As explained <a href=\"https://www.geeksforgeeks.org/preprocessor-works-c/\" rel=\"nofollow noreferrer\">here</a> and as you said it yourself, preprocessor doesn't change runtime. Each instruction is executed before your program is compiled, therefore you don't need to consider them in your graph since each preprocessor instruction will be a constant at runtime.</p>\n\n<p>You could make an exception for macros, though, because it defines some behavior that could be used during the runtime, like functions.</p>\n"}, {"comments": [{"owner": {"reputation": 69, "user_id": 6898991, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c172b686f89f7aac8033fac286335a2?s=128&d=identicon&r=PG&f=1", "display_name": "cspecial", "link": "https://stackoverflow.com/users/6898991/cspecial"}, "edited": false, "score": 0, "creation_date": 1554302301, "post_id": 55497640, "comment_id": 97702535, "body": "Thank your for the example. The consideration of definitions of constants shoulnd&#39;t be bothered about in a control flow graph though, right? If I want to define a function which I am going to use during runtime then it&#39;s a different story. I understood now."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 69, "user_id": 6898991, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c172b686f89f7aac8033fac286335a2?s=128&d=identicon&r=PG&f=1", "display_name": "cspecial", "link": "https://stackoverflow.com/users/6898991/cspecial"}, "edited": false, "score": 0, "creation_date": 1554303607, "post_id": 55497640, "comment_id": 97703534, "body": "If you say <code>#define almostPi 3.14158</code>, then everyplace code uses <code>almostPi</code> will substitute the characters <code>3.14158</code>.  If code uses e.g. <code>if (almostPi &gt; 3.0) doSomething(); else doSomethingElse();</code>, that will have the same implicatons for control flow as if code used <code>if (3.14158 &gt; 3.0) doSomething(); else doSomethingElse();</code>."}], "tags": [], "owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "is_accepted": false, "score": 1, "last_activity_date": 1554301836, "creation_date": 1554301836, "answer_id": 55497640, "question_id": 55497414, "link": "https://stackoverflow.com/questions/55497414/do-i-have-to-consider-preprocessor-directives-in-a-control-flow-graph/55497640#55497640", "title": "Do I have to consider preprocessor directives in a control flow graph?", "body": "<p>What matters for a control-flow graph is the output of the preprocessor.  If one performs something like <code>#define woozle(x,y,z) (x() ? y() : z())</code>, and then later uses <code>woozle(f1,f2,f3)</code> then when drawing a control-flow graph one should treat it as one would <code>(f1() ? f2() : f3())</code>, without regard for how that combination of tokens came to be represented in the preprocessor's output.</p>\n"}], "owner": {"reputation": 69, "user_id": 6898991, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c172b686f89f7aac8033fac286335a2?s=128&d=identicon&r=PG&f=1", "display_name": "cspecial", "link": "https://stackoverflow.com/users/6898991/cspecial"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1554304170, "creation_date": 1554301256, "last_edit_date": 1554304170, "question_id": 55497414, "link": "https://stackoverflow.com/questions/55497414/do-i-have-to-consider-preprocessor-directives-in-a-control-flow-graph", "title": "Do I have to consider preprocessor directives in a control flow graph?", "body": "<p>Do I have to consider preprocessor directives when converting a C-code into a control flow graph?</p>\n\n<p>For example: </p>\n\n<pre><code>#define pi 3.14\n</code></pre>\n\n<p>From my perspective, there is no need to treat them as commands since they aren't processed during runtime.</p>\n"}, {"tags": ["c", "linux", "multithreading", "assembly", "shared-memory"], "comments": [{"owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 4, "creation_date": 1554301007, "post_id": 55497324, "comment_id": 97701671, "body": "Yes, shared memory has no overhead after you have set it up."}, {"owner": {"reputation": 19779, "user_id": 878532, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/5fbebb625a289267abd098c0e676c760?s=128&d=identicon&r=PG", "display_name": "Klaus", "link": "https://stackoverflow.com/users/878532/klaus"}, "edited": false, "score": 0, "creation_date": 1554301358, "post_id": 55497324, "comment_id": 97701912, "body": "how do you want to notify the other process? Remember that sharing memory across processes which running on different cores on the same cpu or if present running on multiple cpus have a lot of latency as memory has to be in sync over the cores. Think about several levels of caches and other hardware dependent isues."}, {"owner": {"reputation": 522, "user_id": 2079418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5f71ffcff2882c688d067a128c31c0?s=128&d=identicon&r=PG", "display_name": "avatli", "link": "https://stackoverflow.com/users/2079418/avatli"}, "reply_to_user": {"reputation": 19779, "user_id": 878532, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/5fbebb625a289267abd098c0e676c760?s=128&d=identicon&r=PG", "display_name": "Klaus", "link": "https://stackoverflow.com/users/878532/klaus"}, "edited": false, "score": 0, "creation_date": 1554301597, "post_id": 55497324, "comment_id": 97702065, "body": "@Klaus, I did not mention for the sake of simplicity but I&#39;m using seqlock and also there are a few variables, but the case is performance overhead for the question."}, {"owner": {"reputation": 522, "user_id": 2079418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5f71ffcff2882c688d067a128c31c0?s=128&d=identicon&r=PG", "display_name": "avatli", "link": "https://stackoverflow.com/users/2079418/avatli"}, "reply_to_user": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 0, "creation_date": 1554301810, "post_id": 55497324, "comment_id": 97702208, "body": "@Jester, how can I make sure this is so, I don&#39;t want to do trial and error. Do you know any document, paper etc?"}, {"owner": {"reputation": 19779, "user_id": 878532, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/5fbebb625a289267abd098c0e676c760?s=128&d=identicon&r=PG", "display_name": "Klaus", "link": "https://stackoverflow.com/users/878532/klaus"}, "edited": false, "score": 0, "creation_date": 1554301978, "post_id": 55497324, "comment_id": 97702322, "body": "@AliVolkanATLI: I can&#39;t catch your point. Using memory over different cores increase latency / drop performance. So the answer to your question is simply &quot;No&quot; if there are different cores involved. Maybe it is not relevant cause the locks take much more time, but that is not your question. If latency of memory access is relevant, you have to deal with it"}, {"owner": {"reputation": 522, "user_id": 2079418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5f71ffcff2882c688d067a128c31c0?s=128&d=identicon&r=PG", "display_name": "avatli", "link": "https://stackoverflow.com/users/2079418/avatli"}, "reply_to_user": {"reputation": 19779, "user_id": 878532, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/5fbebb625a289267abd098c0e676c760?s=128&d=identicon&r=PG", "display_name": "Klaus", "link": "https://stackoverflow.com/users/878532/klaus"}, "edited": false, "score": 0, "creation_date": 1554302273, "post_id": 55497324, "comment_id": 97702523, "body": "@Klaus, in both case, multi-thread or multi-process, the writer and readers are pinning different CPUs."}, {"owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 4, "creation_date": 1554303008, "post_id": 55497324, "comment_id": 97703044, "body": "It&#39;s unclear what you want documented. Shared memory just means the same page is mapped into multiple process address spaces. It does not incur any additional overhead, especially since the cpu has no notion of processes. It just sees a memory mapping and that&#39;s that."}, {"owner": {"reputation": 19267, "user_id": 801894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67f2ccd17aa6fd622152ad88fc2ae784?s=128&d=identicon&r=PG", "display_name": "Solomon Slow", "link": "https://stackoverflow.com/users/801894/solomon-slow"}, "reply_to_user": {"reputation": 19779, "user_id": 878532, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/5fbebb625a289267abd098c0e676c760?s=128&d=identicon&r=PG", "display_name": "Klaus", "link": "https://stackoverflow.com/users/878532/klaus"}, "edited": false, "score": 3, "creation_date": 1554308195, "post_id": 55497324, "comment_id": 97706337, "body": "@Klaus, After the shared region has been mapped, why would you expect any difference in performace between accesses from threads in different processes vs. accesses from threads in the same process?  Threads in the same process also could run on different CPUs."}], "owner": {"reputation": 522, "user_id": 2079418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5f71ffcff2882c688d067a128c31c0?s=128&d=identicon&r=PG", "display_name": "avatli", "link": "https://stackoverflow.com/users/2079418/avatli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 1, "closed_date": 1554317067, "answer_count": 0, "score": 2, "last_activity_date": 1554300965, "creation_date": 1554300965, "question_id": 55497324, "link": "https://stackoverflow.com/questions/55497324/is-it-possible-to-share-memory-between-user-processes-without-latency-penalty-li", "closed_reason": "Duplicate", "title": "Is it possible to share memory between user processes without latency penalty like threads", "body": "<p>I wrote a code to pass a 64-bit value from a writer thread to reader threads using a global variable. (not mentioned any locking for the sake of simplicity)</p>\n\n<pre><code>uint64_t g_x;\n\nwriter_thread()\n{\n    g_x = new_value;\n}\n\nreader_thread()\n{\n    uint64_t curr_value;\n    curr_value = g_x;\n}\n</code></pre>\n\n<p>Now, I want to separate writer and reader threads into different processes without extra latency, system calls etc? </p>\n\n<p>How can I do this in Linux? Is it possible? How can I get the g_x variable into the address space of both processes? </p>\n\n<p>If I use shmget/shmat, mmap (or etc),  can I achieve the same performance?</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 22777, "user_id": 133203, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Fp3hB.jpg?s=128&g=1", "display_name": "Federico klez Culloca", "link": "https://stackoverflow.com/users/133203/federico-klez-culloca"}, "edited": false, "score": 2, "creation_date": 1554300815, "post_id": 55497237, "comment_id": 97701542, "body": "I highly doubt there&#39;s a portable (across CPUs) way to do this. Also, you must convince the Operating System, not the compiler."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1554300839, "post_id": 55497237, "comment_id": 97701552, "body": "Which register? Depending on platform, the usage of (some) registers is regulated by ABI, and you can&#39;t change that."}, {"owner": {"reputation": 31408, "user_id": 243245, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/aed5c13647d581ae231f019a886e05a8?s=128&d=identicon&r=PG", "display_name": "Rup", "link": "https://stackoverflow.com/users/243245/rup"}, "edited": false, "score": 1, "creation_date": 1554300957, "post_id": 55497237, "comment_id": 97701634, "body": "Yes, you can customise the ABI definitions in GCC then build your own compiler. I expect it&#39;s easy enough in Clang too."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 31408, "user_id": 243245, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/aed5c13647d581ae231f019a886e05a8?s=128&d=identicon&r=PG", "display_name": "Rup", "link": "https://stackoverflow.com/users/243245/rup"}, "edited": false, "score": 0, "creation_date": 1554301424, "post_id": 55497237, "comment_id": 97701952, "body": "@Rup ..and build all of the libraries the program might be using with that compiler. And of course there is no point in either of these if this thing is supposed to run under some common OS not built by the same compiler."}, {"owner": {"reputation": 27031, "user_id": 1968972, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/bfdd4ec8dff5c7635520fe98348524ec?s=128&d=identicon&r=PG", "display_name": "exebook", "link": "https://stackoverflow.com/users/1968972/exebook"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1554301638, "post_id": 55497237, "comment_id": 97702095, "body": "@EugeneSh. not sure I understand your point, isn&#39;t it easy to just spill the register when calling to the third party libraries using <code>push</code>/<code>pop</code>?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1554301721, "post_id": 55497237, "comment_id": 97702140, "body": "@exebook Do you want the register not to be used at all, or you want to guarantee it&#39;s value preserved during execution of specific blocks of code?"}, {"owner": {"reputation": 27031, "user_id": 1968972, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/bfdd4ec8dff5c7635520fe98348524ec?s=128&d=identicon&r=PG", "display_name": "exebook", "link": "https://stackoverflow.com/users/1968972/exebook"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1554369047, "post_id": 55497237, "comment_id": 97729055, "body": "@EugeneSh. what was on my mind is to store something in the register that is used basically in every VM instruction, theoretically this could speed up the VM pretty much."}], "owner": {"reputation": 27031, "user_id": 1968972, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/bfdd4ec8dff5c7635520fe98348524ec?s=128&d=identicon&r=PG", "display_name": "exebook", "link": "https://stackoverflow.com/users/1968972/exebook"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1554300713, "creation_date": 1554300713, "question_id": 55497237, "link": "https://stackoverflow.com/questions/55497237/globally-reserving-a-cpu-register", "title": "Globally reserving a CPU register", "body": "<p>I am writing a VM, and I need one CPU register for my own use globally, in other words I need to tell the C compiler not to use this register in any way. And probably the compiler must preserve this register when calling third party libraries (when there is no guarantees about the register user). Is this possible, if yes, how?\nDoes not matter if it's Clang or GCC or something else, I will choose the compiler that can do this.</p>\n"}, {"tags": ["c", "timer", "stm32", "pwm"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user9652118"}, "edited": false, "score": 0, "creation_date": 1554302074, "post_id": 55497421, "comment_id": 97702381, "body": "Thank you for answer! I did it in CubeMX, I can show code was generated by Cube and all timers are working (TIM1_CH1, TIM2_CH1, TIM3_CH1, TIM4_CH1), but I can not to fix that problem in SPL"}, {"owner": {"reputation": 1928, "user_id": 10734452, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ps1ig8rG6G8/AAAAAAAAAAI/AAAAAAAAAS8/yVuRLo3SyCM/photo.jpg?sz=128", "display_name": "Guillaume D", "link": "https://stackoverflow.com/users/10734452/guillaume-d"}, "edited": false, "score": 0, "creation_date": 1554401865, "post_id": 55497421, "comment_id": 97749369, "body": "i&#39;m glad if this could help you or somebody else. You can upvote my answer if you want :)"}], "tags": [], "owner": {"reputation": 1928, "user_id": 10734452, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ps1ig8rG6G8/AAAAAAAAAAI/AAAAAAAAAS8/yVuRLo3SyCM/photo.jpg?sz=128", "display_name": "Guillaume D", "link": "https://stackoverflow.com/users/10734452/guillaume-d"}, "is_accepted": false, "score": 0, "last_activity_date": 1554301268, "creation_date": 1554301268, "answer_id": 55497421, "question_id": 55497192, "link": "https://stackoverflow.com/questions/55497192/there-is-a-problem-with-tim2-ch1-on-stm32f103c8t6/55497421#55497421", "title": "There is a problem with TIM2_CH1 on stm32f103c8t6", "body": "<p>As an alternative answer, I recommend you to try <a href=\"https://www.st.com/en/development-tools/stm32cubemx.html\" rel=\"nofollow noreferrer\">CubeMX</a>. \nIt's a code generator for STM32 that can help you quickly write STM32 low level driver.</p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user9652118"}, "edited": false, "score": 0, "creation_date": 1554304513, "post_id": 55497791, "comment_id": 97704142, "body": "Thank you for answer I&#39;ll try"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9652118"}, "edited": false, "score": 0, "creation_date": 1554362746, "post_id": 55497791, "comment_id": 97725394, "body": "Thank you for answer! I checked and all timers are working. Problem was in case of working all timers together/ I didn&#39;t solve it yet"}, {"owner": {"reputation": 26, "user_id": 3636663, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/60Kmu.png?s=128&g=1", "display_name": "Amir H. Rassafi", "link": "https://stackoverflow.com/users/3636663/amir-h-rassafi"}, "edited": false, "score": 0, "creation_date": 1554363065, "post_id": 55497791, "comment_id": 97725560, "body": "Are you sure about health of hardware? Is it possible to Interrupt can&#39;t handle this?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9652118"}, "edited": false, "score": 0, "creation_date": 1554365108, "post_id": 55497791, "comment_id": 97726716, "body": "For example now dont work tim4. In first place it capture signal but after that it dont change value.(when I turn levers on transmitter) All interrupts are same for 3 timers"}], "tags": [], "owner": {"reputation": 26, "user_id": 3636663, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/60Kmu.png?s=128&g=1", "display_name": "Amir H. Rassafi", "link": "https://stackoverflow.com/users/3636663/amir-h-rassafi"}, "is_accepted": true, "score": 0, "last_activity_date": 1554302240, "creation_date": 1554302240, "answer_id": 55497791, "question_id": 55497192, "link": "https://stackoverflow.com/questions/55497192/there-is-a-problem-with-tim2-ch1-on-stm32f103c8t6/55497791#55497791", "title": "There is a problem with TIM2_CH1 on stm32f103c8t6", "body": "<p>Sorry I cann't add comment.You can check your setting register values in debug mode and check different between your work and CubeMx setting to find problem</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9652118"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 176, "favorite_count": 0, "accepted_answer_id": 55497791, "answer_count": 2, "score": 0, "last_activity_date": 1554302240, "creation_date": 1554300587, "question_id": 55497192, "link": "https://stackoverflow.com/questions/55497192/there-is-a-problem-with-tim2-ch1-on-stm32f103c8t6", "title": "There is a problem with TIM2_CH1 on stm32f103c8t6", "body": "<p>I capture input PWM signal from AURORA9x using 3 timers (TIM4_CH1, TIM3_CH1, TIM2_CH1). All works great except TIM2_CH1. I can't to fix that issue for 3 days. May be some of You came across to this problem.\n Here code for three timers. Configuration for all timers are same, but TIM2 doesn't work</p>\n\n<pre><code>#include \"stm32f10x.h\"\n#include \"stm32f10x_rcc.h\"\n#include \"can.h\"\n#include \"main.h\"\n\nvoid TIM4_Config(void);\nvoid TIM3_Config(void);\nvoid TIM2_Config(void);\n\n\nuint32_t   DataCapture_TIM4=0,\n           DataCapture_TIM3=0,\n           DataCapture_TIM2=0;\n</code></pre>\n\n<p>Timer Configuration for capturing mode for TIM4_CH1</p>\n\n<pre><code>void TIM4_Config(void)\n{ \n    TIM_TimeBaseInitTypeDef     TIM_Time_user;\n    GPIO_InitTypeDef            port;\n    TIM_ICInitTypeDef           TIM_ICInit_user;\n    NVIC_InitTypeDef NVIC_InitStructure2;\n// TIM4 clock enable\nRCC_APB1PeriphClockCmd(RCC_APB1Periph_TIM4, ENABLE);\n// GPIOB clock enable\nRCC_APB2PeriphClockCmd(RCC_APB2Periph_GPIOB, ENABLE);\n// TIM4 channel_1 configuration : PB6\nport.GPIO_Pin   = GPIO_Pin_6;\nport.GPIO_Mode  = GPIO_Mode_IN_FLOATING;\nport.GPIO_Speed = GPIO_Speed_2MHz;\n\nGPIO_Init(GPIOB, &amp;port);\n// Connect TIM pin to AF2\n\n// Enable the TIM4 global Ymtirrupt\nNVIC_InitStructure2.NVIC_IRQChannel = TIM4_IRQn;\nNVIC_InitStructure2.NVIC_IRQChannelPreemptionPriority = 1;\nNVIC_InitStructure2.NVIC_IRQChannelSubPriority = 1;\nNVIC_InitStructure2.NVIC_IRQChannelCmd = ENABLE;\nNVIC_Init(&amp;NVIC_InitStructure2);\n\n// Time base configuration\nTIM_Time_user.TIM_Period = PERIOD;\nTIM_Time_user.TIM_Prescaler = PRESCALER;\nTIM_Time_user.TIM_ClockDivision = TIM_CKD_DIV1;\nTIM_Time_user.TIM_CounterMode = TIM_CounterMode_Up;\nTIM_TimeBaseInit(TIM4, &amp;TIM_Time_user);\n\n//Capture configuration\nTIM_ICInit_user.TIM_Channel = TIM_Channel_1;\nTIM_ICInit_user.TIM_ICPolarity = TIM_ICPolarity_Rising;\nTIM_ICInit_user.TIM_ICSelection = TIM_ICSelection_DirectTI;\nTIM_ICInit_user.TIM_ICPrescaler = TIM_ICPSC_DIV1;\nTIM_ICInit_user.TIM_ICFilter = 0x0;\n\n//Inicialize our structure for capture signal\nTIM_PWMIConfig(TIM4, &amp;TIM_ICInit_user);\n//input trigger\nTIM_SelectInputTrigger(TIM4, TIM_TS_TI1FP1);\n\n  TIM_SelectSlaveMode(TIM4, TIM_SlaveMode_Reset);\n    // Select the slave Mode: Reset Mode\n   TIM_SelectMasterSlaveMode(TIM4,TIM_MasterSlaveMode_Enable);\n\n// Enable the TIM4 Counter\nTIM4-&gt;CR1 |= TIM_CR1_CEN;\n\n// Enable the CC1 Interrupt request\nTIM4-&gt;DIER |= TIM_IT_CC1;\n}\n</code></pre>\n\n<p>Interrupt handler for TIM4_CH1</p>\n\n<pre><code>void TIM4_IRQHandler(void)\n{\n\nif (TIM4-&gt;SR &amp; TIM_SR_CC1IF )\n    {\n\n        DataCapture_TIM4 = TIM4-&gt;CCR2;\n    }\n\n}\n</code></pre>\n\n<p>Capture mode for TIM3_Ch1</p>\n\n<pre><code>void TIM3_Config(void)\n{ \n\n    TIM_TimeBaseInitTypeDef     TIM_Time_user;\n    GPIO_InitTypeDef            port;\n    TIM_ICInitTypeDef           TIM_ICInit_user1;\n    NVIC_InitTypeDef NVIC_InitStructure1;\n// TIM4 clock enable\nRCC_APB1PeriphClockCmd(RCC_APB1Periph_TIM3, ENABLE);\n// GPIOB clock enable\nRCC_APB2PeriphClockCmd(RCC_APB2Periph_GPIOA, ENABLE);\n// TIM channel1 confikurotion : PA6\nport.GPIO_Pin   = GPIO_Pin_6;\nport.GPIO_Mode  = GPIO_Mode_IN_FLOATING;///////////////////////////////\nport.GPIO_Speed = GPIO_Speed_2MHz;\n\nGPIO_Init(GPIOA, &amp;port);\n\n// Enable the TIM3 global interrupt\nNVIC_InitStructure1.NVIC_IRQChannel = TIM3_IRQn;\nNVIC_InitStructure1.NVIC_IRQChannelPreemptionPriority = 1;\nNVIC_InitStructure1.NVIC_IRQChannelSubPriority = 1;\nNVIC_InitStructure1.NVIC_IRQChannelCmd = ENABLE;\nNVIC_Init(&amp;NVIC_InitStructure1);\n// Time base configuration\nTIM_Time_user.TIM_Period = PERIOD;\nTIM_Time_user.TIM_Prescaler = PRESCALER;\nTIM_Time_user.TIM_ClockDivision = TIM_CKD_DIV1;\nTIM_Time_user.TIM_CounterMode = TIM_CounterMode_Up;\nTIM_TimeBaseInit(TIM3, &amp;TIM_Time_user);\n//\nTIM_ICInit_user1.TIM_Channel = TIM_Channel_1;\nTIM_ICInit_user1.TIM_ICPolarity = TIM_ICPolarity_Rising;\nTIM_ICInit_user1.TIM_ICSelection = TIM_ICSelection_DirectTI;\nTIM_ICInit_user1.TIM_ICPrescaler = TIM_ICPSC_DIV1;\nTIM_ICInit_user1.TIM_ICFilter = 0x0;\n//\nTIM_PWMIConfig(TIM3, &amp;TIM_ICInit_user1);\n//input trigger\nTIM_SelectInputTrigger(TIM3, TIM_TS_TI1FP1);\n\n  TIM_SelectSlaveMode(TIM3, TIM_SlaveMode_Reset);\n    // Select the slave Mode: Reset Mode\n   TIM_SelectMasterSlaveMode(TIM3,TIM_MasterSlaveMode_Enable);\n// Enable the TIM3 Counter\nTIM3-&gt;CR1 |= TIM_CR1_CEN;\n\n// Enable the CC1 Intirrupt Request\nTIM3-&gt;DIER |= TIM_IT_CC1;\n}\n\n\nInterrupt handler for TIM3_CH1\n\nvoid TIM3_IRQHandler(void)\n{\n if (TIM3-&gt;SR &amp; TIM_SR_CC1IF )\n    {\n\n        DataCapture_TIM3 = TIM3-&gt;CCR2;\n    }\n\n}\n</code></pre>\n\n<p>A problem is HERE for Capturing mode for TIM2_Ch1</p>\n\n<pre><code>void TIM2_Config(void)\n{ \n    TIM_TimeBaseInitTypeDef     TIM_Time_user;\n    GPIO_InitTypeDef            port;\n    TIM_ICInitTypeDef           TIM_ICInit_user;\n    NVIC_InitTypeDef NVIC_InitStructure2;\n// TIM4 clock enable\nRCC_APB1PeriphClockCmd(RCC_APB1Periph_TIM2, ENABLE);\n// GPIOB clock enable\nRCC_APB2PeriphClockCmd(RCC_APB2Periph_GPIOA, ENABLE);\n// TIM2 channel_1 configuration : PA0\nport.GPIO_Pin   = GPIO_Pin_0;\nport.GPIO_Mode  = GPIO_Mode_IN_FLOATING;\nport.GPIO_Speed = GPIO_Speed_2MHz;\n\nGPIO_Init(GPIOA, &amp;port);\n\n// Enable the TIM2 global Interrupt\nNVIC_InitStructure2.NVIC_IRQChannel = TIM2_IRQn;\nNVIC_InitStructure2.NVIC_IRQChannelPreemptionPriority = 1;\nNVIC_InitStructure2.NVIC_IRQChannelSubPriority = 1;\nNVIC_InitStructure2.NVIC_IRQChannelCmd = ENABLE;\nNVIC_Init(&amp;NVIC_InitStructure2);\n\n// Time base configuration\nTIM_Time_user.TIM_Period = PERIOD;\nTIM_Time_user.TIM_Prescaler = PRESCALER;\nTIM_Time_user.TIM_ClockDivision = TIM_CKD_DIV1;\nTIM_Time_user.TIM_CounterMode = TIM_CounterMode_Up;\nTIM_TimeBaseInit(TIM2, &amp;TIM_Time_user);\n//\nTIM_ICInit_user.TIM_Channel = TIM_Channel_1;\nTIM_ICInit_user.TIM_ICPolarity = TIM_ICPolarity_Rising;\nTIM_ICInit_user.TIM_ICSelection = TIM_ICSelection_DirectTI;\nTIM_ICInit_user.TIM_ICPrescaler = TIM_ICPSC_DIV1;\nTIM_ICInit_user.TIM_ICFilter = 0x0;\n//\nTIM_PWMIConfig(TIM2, &amp;TIM_ICInit_user);\n//input trigger\nTIM_SelectInputTrigger(TIM2, TIM_TS_TI1FP1);\n\n  TIM_SelectSlaveMode(TIM2, TIM_SlaveMode_Reset);\n    // Select the slave Mode: Reset Mode\n   TIM_SelectMasterSlaveMode(TIM2,TIM_MasterSlaveMode_Enable);\n// Enable the TIM2 Counter\nTIM2-&gt;CR1 |= TIM_CR1_CEN;\n// Enable the CC1 Interrupt Request\nTIM2-&gt;DIER |= TIM_IT_CC1;\n}\n</code></pre>\n\n<p>Interrupt handler for TIM2_CH1</p>\n\n<pre><code>void TIM2_IRQHandler(void)\n{\n  if (TIM2-&gt;SR &amp; TIM_SR_CC1IF )\n    {\n\n        DataCapture_TIM2 = TIM2-&gt;CCR2;\n    }\n\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "char"], "comments": [{"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 2, "creation_date": 1554300465, "post_id": 55497110, "comment_id": 97701321, "body": "Why don&#39;t you declare the array as <code>char letters[] = &quot;gyucne&quot;;</code>?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 2, "creation_date": 1554300535, "post_id": 55497110, "comment_id": 97701369, "body": "C strings are null-terminated, meaning that they contain a byte with value 0 to mark the end of the string data.  A <code>char</code> array that does not contain such a terminator is not a string, and attempting to use it as if it were produces undefined behavior.  The result you present demonstrates one of the innumerable possible manifestations of UB."}, {"owner": {"reputation": 35, "user_id": 9663664, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-owNmJuQqdqw/AAAAAAAAAAI/AAAAAAAAAJI/EYBtPciYqLY/photo.jpg?sz=128", "display_name": "&#214;mer Faruk Sar\u0131\u0131\u015f\u0131k", "link": "https://stackoverflow.com/users/9663664/%c3%96mer-faruk-sar%c4%b1%c4%b1%c5%9f%c4%b1k"}, "edited": false, "score": 0, "creation_date": 1554300718, "post_id": 55497110, "comment_id": 97701470, "body": "What is the difference ?"}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1554300908, "post_id": 55497110, "comment_id": 97701599, "body": "Difference between <code>char letters1[] = {&#39;a&#39;, &#39;b&#39;, &#39;c&#39;};</code> and <code>char letters2[] = &quot;abc&quot;;</code> is that letters1 has 3 elements and letters2 has 4 elements, the 4th element being <code>letters2[3] == &#39;\\0&#39;</code>."}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 1, "creation_date": 1554305647, "post_id": 55497110, "comment_id": 97704855, "body": "Don&#39;t change questions after they have been answered (rolled back)!! <b>And don&#39;t forget the <code>&#39;\\0&#39;</code> string terminator.</b>"}, {"owner": {"reputation": 35, "user_id": 9663664, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-owNmJuQqdqw/AAAAAAAAAAI/AAAAAAAAAJI/EYBtPciYqLY/photo.jpg?sz=128", "display_name": "&#214;mer Faruk Sar\u0131\u0131\u015f\u0131k", "link": "https://stackoverflow.com/users/9663664/%c3%96mer-faruk-sar%c4%b1%c4%b1%c5%9f%c4%b1k"}, "edited": false, "score": 0, "creation_date": 1554305722, "post_id": 55497110, "comment_id": 97704901, "body": "I tried to add a new question. It warned me like improve your other questions."}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1554305761, "post_id": 55497110, "comment_id": 97704926, "body": "It is a new question, not an improvement of this one."}], "answers": [{"comments": [{"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "reply_to_user": {"reputation": 35, "user_id": 9663664, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-owNmJuQqdqw/AAAAAAAAAAI/AAAAAAAAAJI/EYBtPciYqLY/photo.jpg?sz=128", "display_name": "&#214;mer Faruk Sar\u0131\u0131\u015f\u0131k", "link": "https://stackoverflow.com/users/9663664/%c3%96mer-faruk-sar%c4%b1%c4%b1%c5%9f%c4%b1k"}, "edited": false, "score": 3, "creation_date": 1554300699, "post_id": 55497163, "comment_id": 97701462, "body": "Kind of: it would print a byte with <code>0</code> value which might show up with some fancy character. With <code>char letters[] = &quot;gyucne&quot;;</code> you have a proper string. It would be easier to print with <code>printf(&quot;%s\\n&quot;, letters);</code>"}], "tags": [], "owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "is_accepted": true, "score": 1, "last_activity_date": 1554300643, "last_edit_date": 1554300643, "creation_date": 1554300491, "answer_id": 55497163, "question_id": 55497110, "link": "https://stackoverflow.com/questions/55497110/how-to-print-char-array-in-c-like-arrays-tostringarray-of-java/55497163#55497163", "title": "How to print char array in C, like &#39;Arrays.ToString(array)&#39; of Java?", "body": "<p>Print each letter on its own. You do not have a string. You cannot call most functions from <code>&lt;string.h&gt;</code> or <code>printf()</code> or a bunch of others that expect a <em>string</em>.</p>\n\n<pre><code>char letters[] = {'g', 'y', 'u', 'c', 'n', 'e'}; // ATTENTION: letters is not a string!\nfor (int i = 0; i &lt; sizeof letters; i++) {\n    putchar(letters[i]);\n}\nputchar('\\n'); // end with a newline\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "is_accepted": false, "score": 0, "last_activity_date": 1554306747, "creation_date": 1554306747, "answer_id": 55499345, "question_id": 55497110, "link": "https://stackoverflow.com/questions/55497110/how-to-print-char-array-in-c-like-arrays-tostringarray-of-java/55499345#55499345", "title": "How to print char array in C, like &#39;Arrays.ToString(array)&#39; of Java?", "body": "<blockquote>\n  <p>I declared a char array:  <code>char letters[] = {'g','y','u','c','n','e'};</code></p>\n</blockquote>\n\n<p>But that is <em>not</em> a C string (since it is <em>not</em> <kbd>NUL</kbd> terminated ! ). You should have coded instead:</p>\n\n<pre><code>const char letters[] = {'g','y','u','c','n','e',(char)0};\n</code></pre>\n\n<p>(or use <code>'\\0'</code> instead of <code>(char)0\u00a0</code>....) or better yet:</p>\n\n<pre><code>const char letters[] = \"gyucne\";\n</code></pre>\n\n<p>and both are <em>exactly</em> equivalent.</p>\n\n<p>Then you can code something like <code>printf(\"letters are %s\\n\", letters);</code> since your <code>letters</code> are now a C string.</p>\n\n<p>NB. Please read also <a href=\"http://utf8everywhere.org/\" rel=\"nofollow noreferrer\">http://utf8everywhere.org/</a> &amp; <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\"><em>How to debug small programs</em></a> - both are practically very relevant for your case. See also at least some <a href=\"https://en.cppreference.com/w/c\" rel=\"nofollow noreferrer\">C reference</a> site.</p>\n"}], "owner": {"reputation": 35, "user_id": 9663664, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-owNmJuQqdqw/AAAAAAAAAAI/AAAAAAAAAJI/EYBtPciYqLY/photo.jpg?sz=128", "display_name": "&#214;mer Faruk Sar\u0131\u0131\u015f\u0131k", "link": "https://stackoverflow.com/users/9663664/%c3%96mer-faruk-sar%c4%b1%c4%b1%c5%9f%c4%b1k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 492, "favorite_count": 0, "accepted_answer_id": 55497163, "answer_count": 2, "score": 0, "last_activity_date": 1554306747, "creation_date": 1554300342, "last_edit_date": 1554305700, "question_id": 55497110, "link": "https://stackoverflow.com/questions/55497110/how-to-print-char-array-in-c-like-arrays-tostringarray-of-java", "title": "How to print char array in C, like &#39;Arrays.ToString(array)&#39; of Java?", "body": "<p>I want to print char array in C like <code>Arrays.ToString(array);</code> of Java does. It prints what I want but puts some characters at the end. I guess it's because of the special character <code>\\0</code>.</p>\n\n<p>I declared a char array <code>char letters[] = {'g','y','u','c','n','e'};</code></p>\n\n<p>And tried to print: <code>printf(\"\\n [%s]:\", letters);</code></p>\n\n<p>The output is: <code>[gyucne\u00c7_=]</code></p>\n\n<p>Here is the Java code:</p>\n\n<pre><code>    char[] letters= {'g','y','u','c','n','e'};\n    System.out.print( Arrays.toString(letters) );\n</code></pre>\n\n<p>The output is:</p>\n\n<p><code>[g, y, u, c, n, e]</code></p>\n\n<p>I wanted to have the output of Java code. I wonder if I want it to contain commas too, do I have to print the characters one by one or can I print it at once ? </p>\n\n<p>And of course my priority is to remove the special character that is printed at the end of C code.</p>\n"}, {"tags": ["c", "multidimensional-array", "dynamic-memory-allocation"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 8, "creation_date": 1554300142, "post_id": 55497018, "comment_id": 97701123, "body": "This is a first time  in my life I am seeing a 5-star program."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1554300287, "post_id": 55497018, "comment_id": 97701225, "body": "You have one extra star in each <code>sizeof</code>."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 2, "creation_date": 1554300452, "post_id": 55497018, "comment_id": 97701311, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/42094465/correctly-allocating-multi-dimensional-arrays\">Correctly allocating multi-dimensional arrays</a>, which also addresses how to get rid of multiple levels of indirection."}, {"owner": {"reputation": 276, "user_id": 6524191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f45f1a420dfcb0039c6c180a1aae5013?s=128&d=identicon&r=PG&f=1", "display_name": "Graeme Cole", "link": "https://stackoverflow.com/users/6524191/graeme-cole"}, "edited": false, "score": 0, "creation_date": 1554300596, "post_id": 55497018, "comment_id": 97701401, "body": "What&#39;s your value of <code>NN</code>? If this program compiles but crashes, you might be running out of memory. For a 5D array like this, the memory usage will be enormous unless <code>NN</code> is reasonably small."}, {"owner": {"reputation": 12144, "user_id": 72882, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9d17e71eae127205da470fffa2dba899?s=128&d=identicon&r=PG", "display_name": "dandan78", "link": "https://stackoverflow.com/users/72882/dandan78"}, "edited": false, "score": 0, "creation_date": 1554300894, "post_id": 55497018, "comment_id": 97701591, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/42094465/correctly-allocating-multi-dimensional-arrays\">Correctly allocating multi-dimensional arrays</a>"}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 0, "creation_date": 1554301118, "post_id": 55497018, "comment_id": 97701752, "body": "<a href=\"http://wiki.c2.com/?ThreeStarProgrammer\" rel=\"nofollow noreferrer\">Obligatoy *** joke</a>."}], "answers": [{"tags": [], "owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "is_accepted": false, "score": 3, "last_activity_date": 1554301627, "last_edit_date": 1554301627, "creation_date": 1554300405, "answer_id": 55497139, "question_id": 55497018, "link": "https://stackoverflow.com/questions/55497018/define-5d-object-with-memory-allocation/55497139#55497139", "title": "define 5D object with memory allocation", "body": "<p>You forgot to declare the type of <code>I_object</code>. Also, you need to declare <code>i</code>, <code>j</code>, <code>k</code> and <code>l</code>. Also, I wouldn't <a href=\"https://stackoverflow.com/help/mcve\">cast the result of malloc in C</a>. Furthermore, the indirection levels are wrong in your <code>sizeof()</code> calls, which causes a problem in the last one, where there might be a difference between the sizes of a <code>double</code> and a <code>double*</code>.</p>\n\n<p>With those changes, it looks like this:</p>\n\n<pre><code>#define N_GROUPS 3\n#define NN 3\nint main() {\n    double *****I_object = malloc(sizeof(double ****)*N_GROUPS);\n    for (size_t i = 0; i &lt; N_GROUPS; i++) {\n        I_object[i] = malloc(sizeof(double***)*NN);\n        for (size_t j = 0; j &lt; NN; j++) {\n            I_object[i][j] = malloc(sizeof(double**)*NN);\n            for (size_t k = 0; k &lt; NN; k++) {\n                I_object[i][j][k] = malloc(sizeof(double*)*NN);\n                for (size_t l = 0; l &lt; NN; l++) {\n                    I_object[i][j][k][l] = malloc(sizeof(double)*NN);\n                }\n            }\n        }\n    }\n}\n</code></pre>\n\n<hr>\n\n<p>Also, for future questions, I would recommend posting a <a href=\"https://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a>. This way, people are much more willing (and capable) to help. For instance, I had to make assumptions about <code>N_GROUPS</code> and <code>NN</code>. Even with low values such as <code>100</code> for <code>NN</code>, the memory consumption would already be so high that it will likely cause problems, but without a MCVE, it's hard to tell.</p>\n"}, {"tags": [], "owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "is_accepted": false, "score": 1, "last_activity_date": 1554301548, "last_edit_date": 1554301548, "creation_date": 1554300935, "answer_id": 55497316, "question_id": 55497018, "link": "https://stackoverflow.com/questions/55497018/define-5d-object-with-memory-allocation/55497316#55497316", "title": "define 5D object with memory allocation", "body": "<p>Instead of having array of some pointer to other arrays of some pointers to other arrays of ....\nsimply use a <strong>pointer to array[nn][nn][nn][nn] of doubles</strong>.</p>\n\n<p>Something like:</p>\n\n<pre><code>#define NN 2\n#define N_GROUPS 4\n\nint main(int argc, char* argv[])\n{\n  double (*I_object)[NN][NN][NN][NN];              // Define pointer\n  I_object = calloc(N_GROUPS, sizeof * I_object);  // Allocate and zero-init memory\n  I_object[3][1][1][1][1] = 42;                    // Use as 5D matrix\n  printf(\"%f\\n\", I_object[3][1][1][1][1]);\n\n  free(I_object);                                  // Free memory\n  return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11306018, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/529cc1671b3bb563aa920bbdbe59f37b?s=128&d=identicon&r=PG&f=1", "display_name": "Ania", "link": "https://stackoverflow.com/users/11306018/ania"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1571651166, "creation_date": 1554300081, "last_edit_date": 1571651166, "question_id": 55497018, "link": "https://stackoverflow.com/questions/55497018/define-5d-object-with-memory-allocation", "title": "define 5D object with memory allocation", "body": "<p>I need to clear memory of 5D object, so first I need to define it with memory allocation.\nMy previous object definition was:</p>\n\n<pre><code>   double I_object[N_GROUPS][NN][NN][NN][NN]={0};\n</code></pre>\n\n<p>I replaced it by code below and c file compiles but c program crashes :( </p>\n\n<pre><code> I_object=(double *****) malloc(sizeof(double *****)*N_GROUPS);\n  for(i = 0; i &lt; N_GROUPS; i++){\n      I_object[i]=(double ****) malloc(sizeof(double****)*NN);\n      for(j = 0; j &lt; NN; j++){\n         I_object[i][j]=(double ***) malloc(sizeof(double***)*NN); \n         for(k = 0; k &lt; NN; k++){\n            I_object[i][j][k]=(double **) malloc(sizeof(double**)*NN); \n            for(l = 0; l &lt; NN; l++){\n                I_object[i][j][k][l]=(double *) malloc(sizeof(double*)*NN); \n            }\n         }\n      }\n  }\n</code></pre>\n\n<p>Please let me know if this 5D object definition is wrong or where I can find how to define 5D object using malloc.</p>\n"}, {"tags": ["c", "linux", "pthreads"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1554300244, "post_id": 55497000, "comment_id": 97701186, "body": "Think about what the <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/pthread_join.html\" rel=\"nofollow noreferrer\"><code>pthread_join</code></a> function does. You&#39;re not running your thread in parallel, it&#39;s all done serially."}, {"owner": {"reputation": 1805, "user_id": 6284997, "user_type": "registered", "accept_rate": 45, "profile_image": "https://graph.facebook.com/1376431542382698/picture?type=large", "display_name": "MayurK", "link": "https://stackoverflow.com/users/6284997/mayurk"}, "edited": false, "score": 0, "creation_date": 1554311160, "post_id": 55497000, "comment_id": 97707845, "body": "One more issue is in consumer thread. Mutex unlock is inside the for loop. It should be outside."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 11305907, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Ok0cj1mR_eY/AAAAAAAAAAI/AAAAAAAAAh0/3aOIWuFPBJI/photo.jpg?sz=128", "display_name": "Devanshu Tripathi", "link": "https://stackoverflow.com/users/11305907/devanshu-tripathi"}, "edited": false, "score": 0, "creation_date": 1554352944, "post_id": 55501170, "comment_id": 97721304, "body": "I tried all the things you mentioned but again not able to get the array after the 1st element. Any idea why?   @MayurK"}, {"owner": {"reputation": 1805, "user_id": 6284997, "user_type": "registered", "accept_rate": 45, "profile_image": "https://graph.facebook.com/1376431542382698/picture?type=large", "display_name": "MayurK", "link": "https://stackoverflow.com/users/6284997/mayurk"}, "reply_to_user": {"reputation": 15, "user_id": 11305907, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Ok0cj1mR_eY/AAAAAAAAAAI/AAAAAAAAAh0/3aOIWuFPBJI/photo.jpg?sz=128", "display_name": "Devanshu Tripathi", "link": "https://stackoverflow.com/users/11305907/devanshu-tripathi"}, "edited": false, "score": 0, "creation_date": 1554353252, "post_id": 55501170, "comment_id": 97721388, "body": "@DevanshuTripathi I have added an update in my answer for this."}, {"owner": {"reputation": 15, "user_id": 11305907, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Ok0cj1mR_eY/AAAAAAAAAAI/AAAAAAAAAh0/3aOIWuFPBJI/photo.jpg?sz=128", "display_name": "Devanshu Tripathi", "link": "https://stackoverflow.com/users/11305907/devanshu-tripathi"}, "edited": false, "score": 0, "creation_date": 1554353782, "post_id": 55501170, "comment_id": 97721559, "body": "Still the same after giving the first element of the array it gets stuck and I have to forcefully terminate the program."}, {"owner": {"reputation": 15, "user_id": 11305907, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Ok0cj1mR_eY/AAAAAAAAAAI/AAAAAAAAAh0/3aOIWuFPBJI/photo.jpg?sz=128", "display_name": "Devanshu Tripathi", "link": "https://stackoverflow.com/users/11305907/devanshu-tripathi"}, "edited": false, "score": 0, "creation_date": 1554354621, "post_id": 55501170, "comment_id": 97721807, "body": "After putting scanf above the lock it&#39;s taking only two elements as input for any value of n greater than 2."}, {"owner": {"reputation": 1805, "user_id": 6284997, "user_type": "registered", "accept_rate": 45, "profile_image": "https://graph.facebook.com/1376431542382698/picture?type=large", "display_name": "MayurK", "link": "https://stackoverflow.com/users/6284997/mayurk"}, "reply_to_user": {"reputation": 15, "user_id": 11305907, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Ok0cj1mR_eY/AAAAAAAAAAI/AAAAAAAAAh0/3aOIWuFPBJI/photo.jpg?sz=128", "display_name": "Devanshu Tripathi", "link": "https://stackoverflow.com/users/11305907/devanshu-tripathi"}, "edited": false, "score": 0, "creation_date": 1554359760, "post_id": 55501170, "comment_id": 97723807, "body": "@DevanshuTripathi Remove &quot;\\n&quot; in &quot;scanf(&quot; %d\\n&quot;,&amp;buffer[i]);&quot; --&gt; scanf(&quot; %d&quot;,&amp;buffer[i]); Now it is working for me. I have updated it in Update-1."}], "tags": [], "owner": {"reputation": 1805, "user_id": 6284997, "user_type": "registered", "accept_rate": 45, "profile_image": "https://graph.facebook.com/1376431542382698/picture?type=large", "display_name": "MayurK", "link": "https://stackoverflow.com/users/6284997/mayurk"}, "is_accepted": true, "score": 0, "last_activity_date": 1554359663, "last_edit_date": 1554359663, "creation_date": 1554313239, "answer_id": 55501170, "question_id": 55497000, "link": "https://stackoverflow.com/questions/55497000/not-able-to-figure-out-why-am-i-not-getting-the-array-that-i-took-as-input-from/55501170#55501170", "title": "Not able to figure out why am i not getting the array that i took as input from one thread and trying to print it using another", "body": "<p>Answer to your question is you are doing pthread_join() for a thread before creating new thread. It means, you are exiting the first thread before starting new thread. So all operations are completely serial.</p>\n\n<p>You should start both the threads and then join them as below.</p>\n\n<pre><code>pthread_create(&amp;pThread, 0, producer, 0); //Check return value and handle error\npthread_create(&amp;cThread, 0, consumer,0);  //Check return value and handle error  \npthread_join(pThread,NULL);\npthread_join(cThread, NULL);\n</code></pre>\n\n<p>But there is one more issue in you code. In consumer() function you are unlocking mutex inside for loop. I assume, you want user to read one input from user in producer thread and print that input value in consumer thread. In that case you have to move mutex unlock call outside the loop. Please note that, pthread_cond_wait() will internally unlock the mutex during wait. Also, you need to print value after <code>pthread_cond_wait()</code> to ensure that user has entered an input value.</p>\n\n<pre><code>pthread_mutex_lock(&amp;mutex);\nfor (i = 0; i &lt; n; i++) \n{\n    pthread_cond_wait(&amp;cond, &amp;mutex);\n    printf(\"%d\\n\",buffer[i]);    \n}\npthread_mutex_unlock(&amp;mutex);\n</code></pre>\n\n<p><strong>I have written this answer just for the interesting part below!</strong></p>\n\n<p>Calling pthread_create(); for a thread does not mean that the thread starts running immediately. Multiple threads can run in a random (should be assumed) order.</p>\n\n<p>So.. If consumer thread starts very late i.e. if it starts after two or more <code>pthread_cond_signal(&amp;cond);</code> from producer thread, then consumer thread will enter deadlock situation as it does exact n number of <code>pthread_cond_wait()</code> calls. Please note that, a <code>pthread_cond_signal()</code> is missed if no thread is doing <code>pthread_cond_wait()</code> at that exact time instant.</p>\n\n<p>So.. you need to ensure that consumer thread has started before start reading input from producer thread.</p>\n\n<p>There are multiple ways to achieve this. One way is to poll using a global flag and mutex. (You can use another mutex-condition-signal combination for this.)</p>\n\n<pre><code>void *producer(void *arg) { \n    while(1) {\n        pthread_mutex_lock(&amp;mutex);\n        if(1 == consumerStartedFlag) {\n            pthread_mutex_unlock(&amp;mutex);\n            break;\n        }\n        pthread_mutex_unlock(&amp;mutex);\n        usleep(1000); //Sleep for 1ms to prevent this thread from consuming large CPU\n    }\n\n    //Rest of the producer functionality\n}\n\n\nvoid *consumer(void *arg) {  // For printing the input array\n\n    pthread_mutex_lock(&amp;mutex);\n    consumerStartedFlag = 1; //Global flag, intialize it to zero in main before starting threads.\n    pthread_mutex_unlock(&amp;mutex);\n\n    //Rest of the consumer functionality\n}\n</code></pre>\n\n<p>Now, if producer starts first, it will wait in <code>while</code> loop. If consumer starts first, it will wait in <code>pthread_cond_wait()</code>.</p>\n\n<p><strong>Update 1</strong> Based on a comment below.</p>\n\n<p>In producer(), scanf() is inside mutex lock. It will block the consumer indefinately. So you may not get the output properly. So Put scanf() outside lock as below.</p>\n\n<pre><code> scanf(\" %d\",&amp;buffer[i]); //Remove '\\n' from scanf() as it will block your scanf call.\n pthread_mutex_lock(&amp;mutex);\n pthread_cond_signal(&amp;cond);\n pthread_mutex_unlock(&amp;mutex);\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 11305907, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Ok0cj1mR_eY/AAAAAAAAAAI/AAAAAAAAAh0/3aOIWuFPBJI/photo.jpg?sz=128", "display_name": "Devanshu Tripathi", "link": "https://stackoverflow.com/users/11305907/devanshu-tripathi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 55501170, "answer_count": 1, "score": 1, "last_activity_date": 1554958148, "creation_date": 1554300017, "last_edit_date": 1554300162, "question_id": 55497000, "link": "https://stackoverflow.com/questions/55497000/not-able-to-figure-out-why-am-i-not-getting-the-array-that-i-took-as-input-from", "title": "Not able to figure out why am i not getting the array that i took as input from one thread and trying to print it using another", "body": "<pre><code>#include &lt;pthread.h&gt;\n#include &lt;stdio.h&gt;\n\npthread_mutex_t mutex;\npthread_cond_t cond;\nvoid *producer(void *arg);\nvoid *consumer(void *arg);\nint buffer[100];\nstatic int n;\n\nvoid *producer(void *arg) {   //`For taking user input`\nint i;\nprintf(\"\\n Enter the Array of %d terms\",n);\n\nfor (i = 0; i &lt; n; i++) \n{\n pthread_mutex_lock(&amp;mutex);\n scanf(\" %d\\n\",&amp;buffer[i]);\n\n pthread_cond_signal(&amp;cond);\n pthread_mutex_unlock(&amp;mutex);\n}\n}\n\nvoid *consumer(void *arg) {  // For printing the input array\nint i;\n\nprintf(\"\\nConsumer Function\"); \npthread_mutex_lock(&amp;mutex);\nfor (i = 0; i &lt; n; i++) \n{\n\nprintf(\"%d\\n\",buffer[i]);         \npthread_cond_wait(&amp;cond, &amp;mutex);\npthread_mutex_unlock(&amp;mutex);\n\n}\n}\n\nint main()\n{\nint i=0;\npthread_mutex_init(&amp;mutex, 0);\npthread_cond_init(&amp;cond, 0);\n\npthread_t pThread, cThread;\n\nprintf(\"\\n Enter no of terms\");\nscanf(\"%d\",&amp;n);\n\npthread_create(&amp;pThread, 0, producer, 0);\npthread_join(pThread,NULL);  \npthread_create(&amp;cThread, 0, consumer,0);   \npthread_join(cThread, NULL);\npthread_mutex_destroy(&amp;mutex);\npthread_cond_destroy(&amp;cond);\nreturn 0;\n}\n</code></pre>\n\n<p>In the producer function with the help of thread (pThread) I took user input for an array and then I tried to print the same array in the consumer function with the help of cThread. But I am only able to print just the first element of the array. What are the changes that I need to make so that I can get the whole array as output?</p>\n"}, {"tags": ["c++", "c", "visual-studio-2012", "avx2", "gcc7"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1554298531, "post_id": 55496389, "comment_id": 97700075, "body": "Struct padding of <code>MD5_AVX2_CTX</code>? Print its size on both OS respectively."}, {"owner": {"reputation": 13, "user_id": 3231972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f15516e83d0cff6b55d5a406bae730?s=128&d=identicon&r=PG&f=1", "display_name": "Nathan S", "link": "https://stackoverflow.com/users/3231972/nathan-s"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1554303896, "post_id": 55496389, "comment_id": 97703749, "body": "on both compiler the size of <b>MD5_AVX2_CTX</b> is 800"}, {"owner": {"reputation": 13, "user_id": 3231972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f15516e83d0cff6b55d5a406bae730?s=128&d=identicon&r=PG&f=1", "display_name": "Nathan S", "link": "https://stackoverflow.com/users/3231972/nathan-s"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1554307248, "post_id": 55496389, "comment_id": 97705836, "body": "@nulleight i did change the types to <code>uint_*</code> infact this was the issue. Thank you so much for the help."}], "answers": [{"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1554308293, "post_id": 55499260, "comment_id": 97706392, "body": "All the versions look quite fishy. Be aware of pointer aliasing issues."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1554314521, "post_id": 55499260, "comment_id": 97709413, "body": "Yes, Windows x64&#39;s ABI uses 32-bit <code>long</code> (LLP64 model), while x86-64 System V uses 64-bit <code>long</code> (LP64 model).  GCC targeting Windows of course uses 32-bit <code>long</code>, so the OP&#39;s question is actually Windows vs. Linux as far as that issue, and would happen even without MSVC."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1554314680, "post_id": 55499260, "comment_id": 97709487, "body": "@Lundin: MSVC makes pointer-casting for type-punning well defined.  Other compilers (except <code>gcc -fno-strict-aliasing</code>) leave it undefined like ISO C++.  So yes, that&#39;s a bug in the source, whether it manifests in the compiled code or not."}], "tags": [], "owner": {"reputation": 596, "user_id": 789371, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a6a8d60cf810d14224154d35a1854aaf?s=128&d=identicon&r=PG", "display_name": "nulleight", "link": "https://stackoverflow.com/users/789371/nulleight"}, "is_accepted": true, "score": 3, "last_activity_date": 1554309364, "last_edit_date": 1554309364, "creation_date": 1554306514, "answer_id": 55499260, "question_id": 55496389, "link": "https://stackoverflow.com/questions/55496389/same-avx2-program-yields-different-result-in-gcc-msvc/55499260#55499260", "title": "Same AVX2 program yields different result in gcc &amp; msvc", "body": "<p>I bet sizeof(long int) is different. It is a good idea to use uint64_t, uint32_t, uint8_t and so on instead of long int, or unsigned char. Especially if you use it to manipulate addresses. I think the error is here:</p>\n\n<pre><code>encode(&amp;digests[i][j*4], &amp;((unsigned long int *) &amp;context-&gt;state[j])[i], 4);\n</code></pre>\n\n<p>On Windows it is </p>\n\n<pre><code>encode(&amp;digests[i][j*4], &amp;((uint32_t*) &amp;context-&gt;state[j])[i], 4);\n</code></pre>\n\n<p>On Linux</p>\n\n<pre><code>encode(&amp;digests[i][j*4], &amp;((uint64_t*) &amp;context-&gt;state[j])[i], 4);\n</code></pre>\n\n<p>So you address past source array for i >= 2</p>\n\n<p>EDIT:</p>\n\n<p>also I wouldn't convert to uint64_t* directly.\nSee: <a href=\"https://stackoverflow.com/questions/2958633/gcc-strict-aliasing-and-horror-stories\">gcc, strict-aliasing, and horror stories</a></p>\n\n<p>Instead I would use memcpy to copy context->state[j] </p>\n\n<pre class=\"lang-c prettyprint-override\"><code>union\n{\n   uint32_t elem[4];\n   uint8_t buff[sizeof(elem)];\n} u;\nmemcpy (u.buff, &amp;context-&gt;state[j], sizeof(u.buff));\n</code></pre>\n\n<p>and then use</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>encode(&amp;digests[i][j*4], &amp;u.elem[i], 4);\n</code></pre>\n\n<p>Dont forget to</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdint.h&gt;\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 3231972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f15516e83d0cff6b55d5a406bae730?s=128&d=identicon&r=PG&f=1", "display_name": "Nathan S", "link": "https://stackoverflow.com/users/3231972/nathan-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "accepted_answer_id": 55499260, "answer_count": 1, "score": 1, "last_activity_date": 1554309364, "creation_date": 1554298113, "question_id": 55496389, "link": "https://stackoverflow.com/questions/55496389/same-avx2-program-yields-different-result-in-gcc-msvc", "title": "Same AVX2 program yields different result in gcc &amp; msvc", "body": "<p>I'm trying to increase throughput of md5 hash using AVX2. I have used simd_md5 library provided by a github user..</p>\n\n<p>On msvc2013 i get desired result for all 8 buffers but on linux when i run the same code only for first 4 buffers the result match &amp; next four buffer somehow the result is shifted.</p>\n\n<p>I have attached code of the same here with example</p>\n\n<pre><code>#ifndef MD5_AVX2_H\n#define MD5_AVX2_H\n\n#include &lt;immintrin.h&gt;\n#include \"md5_common.h\"\n\ntypedef struct {\n    __m256i state[8]; /* state (ABCD) */\n    unsigned long int count[2]; /* number of bits, modulo 2^64 (lsb first) */\n    unsigned char buffer1[64];\n    unsigned char buffer2[64];\n    unsigned char buffer3[64];\n    unsigned char buffer4[64];\n    unsigned char buffer5[64];\n    unsigned char buffer6[64];\n    unsigned char buffer7[64];\n    unsigned char buffer8[64];\n} MD5_AVX2_CTX;\n\n#define AVX2_ROTATE_LEFT(x, n) _mm256_or_si256(_mm256_slli_epi32((x), (n)), _mm256_srli_epi32((x), (32-(n))))\n\n#define AVX2_F(x, y, z) _mm256_or_si256(_mm256_and_si256((x), (y)), _mm256_andnot_si256((x), (z)))\n#define AVX2_G(x, y, z) _mm256_or_si256(_mm256_and_si256((x), (z)), _mm256_andnot_si256((z), (y)))\n#define AVX2_H(x, y, z) _mm256_xor_si256((x), _mm256_xor_si256((y), (z)))\n#define AVX2_I(x, y, z) _mm256_xor_si256((y), _mm256_or_si256((x), _mm256_andnot_si256((z), _mm256_cmpeq_epi32((z), (z)))))\n\n#define AVX2_STEP(f, a, b, c, d, x, s, ac) \\\n{ \\\n    (a) = _mm256_add_epi32((a), _mm256_add_epi32(_mm256_add_epi32(f((b), (c), (d)), (x)),(ac))); \\\n    (a) = AVX2_ROTATE_LEFT((a), (s)); \\\n    (a) = _mm256_add_epi32((a), (b)); \\\n}\n\nvoid md5_avx2_init(MD5_AVX2_CTX *context);\nvoid md5_avx2_update1(MD5_AVX2_CTX *context, unsigned char *input, unsigned int inputLen);\nvoid md5_avx2_update8(MD5_AVX2_CTX *context, unsigned char *input1, unsigned char *input2, unsigned char *input3, unsigned char *input4, unsigned char *input5, unsigned char *input6, unsigned char *input7, unsigned char *input8, unsigned int inputLen);\nvoid md5_avx2_final(unsigned char digests[8][16], MD5_AVX2_CTX *context);\n\n#endif\n</code></pre>\n\n<h1>c file</h1>\n\n<pre><code>\n#include \"md5_common.h\"\n#include \"md5_avx2.h\"\n\nstatic void avx2_decode(__m256i *output, unsigned char *input1, unsigned char *input2, unsigned char *input3, unsigned char *input4, unsigned char *input5, unsigned char *input6, unsigned char *input7, unsigned char *input8, unsigned int len)\n{\n    unsigned int i, j;\n    for (i = 0, j = 0; j &lt; len; i++, j += 4)\n    {\n        output[i] = _mm256_set_epi32(\n            ((unsigned long int)input8[j]) | (((unsigned long int)input8[j+1]) &lt;&lt; 8) | (((unsigned long int)input8[j+2]) &lt;&lt; 16) | (((unsigned long int)input8[j+3]) &lt;&lt; 24),\n            ((unsigned long int)input7[j]) | (((unsigned long int)input7[j+1]) &lt;&lt; 8) | (((unsigned long int)input7[j+2]) &lt;&lt; 16) | (((unsigned long int)input7[j+3]) &lt;&lt; 24),\n            ((unsigned long int)input6[j]) | (((unsigned long int)input6[j+1]) &lt;&lt; 8) | (((unsigned long int)input6[j+2]) &lt;&lt; 16) | (((unsigned long int)input6[j+3]) &lt;&lt; 24),\n            ((unsigned long int)input5[j]) | (((unsigned long int)input5[j+1]) &lt;&lt; 8) | (((unsigned long int)input5[j+2]) &lt;&lt; 16) | (((unsigned long int)input5[j+3]) &lt;&lt; 24),\n            ((unsigned long int)input4[j]) | (((unsigned long int)input4[j+1]) &lt;&lt; 8) | (((unsigned long int)input4[j+2]) &lt;&lt; 16) | (((unsigned long int)input4[j+3]) &lt;&lt; 24),\n            ((unsigned long int)input3[j]) | (((unsigned long int)input3[j+1]) &lt;&lt; 8) | (((unsigned long int)input3[j+2]) &lt;&lt; 16) | (((unsigned long int)input3[j+3]) &lt;&lt; 24),\n            ((unsigned long int)input2[j]) | (((unsigned long int)input2[j+1]) &lt;&lt; 8) | (((unsigned long int)input2[j+2]) &lt;&lt; 16) | (((unsigned long int)input2[j+3]) &lt;&lt; 24),\n            ((unsigned long int)input1[j]) | (((unsigned long int)input1[j+1]) &lt;&lt; 8) | (((unsigned long int)input1[j+2]) &lt;&lt; 16) | (((unsigned long int)input1[j+3]) &lt;&lt; 24)\n            );\n    }\n}\n\nstatic void md5_avx2_transform(__m256i *state, unsigned char block1[64], unsigned char block2[64], unsigned char block3[64], unsigned char block4[64], unsigned char block5[64], unsigned char block6[64], unsigned char block7[64], unsigned char block8[64])\n{\n    __m256i a = state[0], b = state[1], c = state[2], d = state[3], x[16];\n\n    avx2_decode(x, block1, block2, block3, block4, block5, block6, block7, block8, 64);\n\n    /* Round 1 */\n    AVX2_STEP(AVX2_F, a, b, c, d, x[ 0], S11, _mm256_set1_epi32(0xd76aa478)); /* 1 */\n    AVX2_STEP(AVX2_F, d, a, b, c, x[ 1], S12, _mm256_set1_epi32(0xe8c7b756)); /* 2 */\n    AVX2_STEP(AVX2_F, c, d, a, b, x[ 2], S13, _mm256_set1_epi32(0x242070db)); /* 3 */\n    AVX2_STEP(AVX2_F, b, c, d, a, x[ 3], S14, _mm256_set1_epi32(0xc1bdceee)); /* 4 */\n    AVX2_STEP(AVX2_F, a, b, c, d, x[ 4], S11, _mm256_set1_epi32(0xf57c0faf)); /* 5 */\n    AVX2_STEP(AVX2_F, d, a, b, c, x[ 5], S12, _mm256_set1_epi32(0x4787c62a)); /* 6 */\n    AVX2_STEP(AVX2_F, c, d, a, b, x[ 6], S13, _mm256_set1_epi32(0xa8304613)); /* 7 */\n    AVX2_STEP(AVX2_F, b, c, d, a, x[ 7], S14, _mm256_set1_epi32(0xfd469501)); /* 8 */\n    AVX2_STEP(AVX2_F, a, b, c, d, x[ 8], S11, _mm256_set1_epi32(0x698098d8)); /* 9 */\n    AVX2_STEP(AVX2_F, d, a, b, c, x[ 9], S12, _mm256_set1_epi32(0x8b44f7af)); /* 10 */\n    AVX2_STEP(AVX2_F, c, d, a, b, x[10], S13, _mm256_set1_epi32(0xffff5bb1)); /* 11 */\n    AVX2_STEP(AVX2_F, b, c, d, a, x[11], S14, _mm256_set1_epi32(0x895cd7be)); /* 12 */\n    AVX2_STEP(AVX2_F, a, b, c, d, x[12], S11, _mm256_set1_epi32(0x6b901122)); /* 13 */\n    AVX2_STEP(AVX2_F, d, a, b, c, x[13], S12, _mm256_set1_epi32(0xfd987193)); /* 14 */\n    AVX2_STEP(AVX2_F, c, d, a, b, x[14], S13, _mm256_set1_epi32(0xa679438e)); /* 15 */\n    AVX2_STEP(AVX2_F, b, c, d, a, x[15], S14, _mm256_set1_epi32(0x49b40821)); /* 16 */\n\n    /* Round 2 */\n    AVX2_STEP(AVX2_G, a, b, c, d, x[ 1], S21, _mm256_set1_epi32(0xf61e2562)); /* 17 */\n    AVX2_STEP(AVX2_G, d, a, b, c, x[ 6], S22, _mm256_set1_epi32(0xc040b340)); /* 18 */\n    AVX2_STEP(AVX2_G, c, d, a, b, x[11], S23, _mm256_set1_epi32(0x265e5a51)); /* 19 */\n    AVX2_STEP(AVX2_G, b, c, d, a, x[ 0], S24, _mm256_set1_epi32(0xe9b6c7aa)); /* 20 */\n    AVX2_STEP(AVX2_G, a, b, c, d, x[ 5], S21, _mm256_set1_epi32(0xd62f105d)); /* 21 */\n    AVX2_STEP(AVX2_G, d, a, b, c, x[10], S22, _mm256_set1_epi32( 0x2441453)); /* 22 */\n    AVX2_STEP(AVX2_G, c, d, a, b, x[15], S23, _mm256_set1_epi32(0xd8a1e681)); /* 23 */\n    AVX2_STEP(AVX2_G, b, c, d, a, x[ 4], S24, _mm256_set1_epi32(0xe7d3fbc8)); /* 24 */\n    AVX2_STEP(AVX2_G, a, b, c, d, x[ 9], S21, _mm256_set1_epi32(0x21e1cde6)); /* 25 */\n    AVX2_STEP(AVX2_G, d, a, b, c, x[14], S22, _mm256_set1_epi32(0xc33707d6)); /* 26 */\n    AVX2_STEP(AVX2_G, c, d, a, b, x[ 3], S23, _mm256_set1_epi32(0xf4d50d87)); /* 27 */\n    AVX2_STEP(AVX2_G, b, c, d, a, x[ 8], S24, _mm256_set1_epi32(0x455a14ed)); /* 28 */\n    AVX2_STEP(AVX2_G, a, b, c, d, x[13], S21, _mm256_set1_epi32(0xa9e3e905)); /* 29 */\n    AVX2_STEP(AVX2_G, d, a, b, c, x[ 2], S22, _mm256_set1_epi32(0xfcefa3f8)); /* 30 */\n    AVX2_STEP(AVX2_G, c, d, a, b, x[ 7], S23, _mm256_set1_epi32(0x676f02d9)); /* 31 */\n    AVX2_STEP(AVX2_G, b, c, d, a, x[12], S24, _mm256_set1_epi32(0x8d2a4c8a)); /* 32 */\n\n    /* Round 3 */\n    AVX2_STEP(AVX2_H, a, b, c, d, x[ 5], S31, _mm256_set1_epi32(0xfffa3942)); /* 33 */\n    AVX2_STEP(AVX2_H, d, a, b, c, x[ 8], S32, _mm256_set1_epi32(0x8771f681)); /* 34 */\n    AVX2_STEP(AVX2_H, c, d, a, b, x[11], S33, _mm256_set1_epi32(0x6d9d6122)); /* 35 */\n    AVX2_STEP(AVX2_H, b, c, d, a, x[14], S34, _mm256_set1_epi32(0xfde5380c)); /* 36 */\n    AVX2_STEP(AVX2_H, a, b, c, d, x[ 1], S31, _mm256_set1_epi32(0xa4beea44)); /* 37 */\n    AVX2_STEP(AVX2_H, d, a, b, c, x[ 4], S32, _mm256_set1_epi32(0x4bdecfa9)); /* 38 */\n    AVX2_STEP(AVX2_H, c, d, a, b, x[ 7], S33, _mm256_set1_epi32(0xf6bb4b60)); /* 39 */\n    AVX2_STEP(AVX2_H, b, c, d, a, x[10], S34, _mm256_set1_epi32(0xbebfbc70)); /* 40 */\n    AVX2_STEP(AVX2_H, a, b, c, d, x[13], S31, _mm256_set1_epi32(0x289b7ec6)); /* 41 */\n    AVX2_STEP(AVX2_H, d, a, b, c, x[ 0], S32, _mm256_set1_epi32(0xeaa127fa)); /* 42 */\n    AVX2_STEP(AVX2_H, c, d, a, b, x[ 3], S33, _mm256_set1_epi32(0xd4ef3085)); /* 43 */\n    AVX2_STEP(AVX2_H, b, c, d, a, x[ 6], S34, _mm256_set1_epi32( 0x4881d05)); /* 44 */\n    AVX2_STEP(AVX2_H, a, b, c, d, x[ 9], S31, _mm256_set1_epi32(0xd9d4d039)); /* 45 */\n    AVX2_STEP(AVX2_H, d, a, b, c, x[12], S32, _mm256_set1_epi32(0xe6db99e5)); /* 46 */\n    AVX2_STEP(AVX2_H, c, d, a, b, x[15], S33, _mm256_set1_epi32(0x1fa27cf8)); /* 47 */\n    AVX2_STEP(AVX2_H, b, c, d, a, x[ 2], S34, _mm256_set1_epi32(0xc4ac5665)); /* 48 */\n\n    /* Round 4 */\n    AVX2_STEP(AVX2_I, a, b, c, d, x[ 0], S41, _mm256_set1_epi32(0xf4292244)); /* 49 */\n    AVX2_STEP(AVX2_I, d, a, b, c, x[ 7], S42, _mm256_set1_epi32(0x432aff97)); /* 50 */\n    AVX2_STEP(AVX2_I, c, d, a, b, x[14], S43, _mm256_set1_epi32(0xab9423a7)); /* 51 */\n    AVX2_STEP(AVX2_I, b, c, d, a, x[ 5], S44, _mm256_set1_epi32(0xfc93a039)); /* 52 */\n    AVX2_STEP(AVX2_I, a, b, c, d, x[12], S41, _mm256_set1_epi32(0x655b59c3)); /* 53 */\n    AVX2_STEP(AVX2_I, d, a, b, c, x[ 3], S42, _mm256_set1_epi32(0x8f0ccc92)); /* 54 */\n    AVX2_STEP(AVX2_I, c, d, a, b, x[10], S43, _mm256_set1_epi32(0xffeff47d)); /* 55 */\n    AVX2_STEP(AVX2_I, b, c, d, a, x[ 1], S44, _mm256_set1_epi32(0x85845dd1)); /* 56 */\n    AVX2_STEP(AVX2_I, a, b, c, d, x[ 8], S41, _mm256_set1_epi32(0x6fa87e4f)); /* 57 */\n    AVX2_STEP(AVX2_I, d, a, b, c, x[15], S42, _mm256_set1_epi32(0xfe2ce6e0)); /* 58 */\n    AVX2_STEP(AVX2_I, c, d, a, b, x[ 6], S43, _mm256_set1_epi32(0xa3014314)); /* 59 */\n    AVX2_STEP(AVX2_I, b, c, d, a, x[13], S44, _mm256_set1_epi32(0x4e0811a1)); /* 60 */\n    AVX2_STEP(AVX2_I, a, b, c, d, x[ 4], S41, _mm256_set1_epi32(0xf7537e82)); /* 61 */\n    AVX2_STEP(AVX2_I, d, a, b, c, x[11], S42, _mm256_set1_epi32(0xbd3af235)); /* 62 */\n    AVX2_STEP(AVX2_I, c, d, a, b, x[ 2], S43, _mm256_set1_epi32(0x2ad7d2bb)); /* 63 */\n    AVX2_STEP(AVX2_I, b, c, d, a, x[ 9], S44, _mm256_set1_epi32(0xeb86d391)); /* 64 */\n\n    state[0] = _mm256_add_epi32(state[0], a);\n    state[1] = _mm256_add_epi32(state[1], b);\n    state[2] = _mm256_add_epi32(state[2], c);\n    state[3] = _mm256_add_epi32(state[3], d);\n\n    /* Zeroize sensitive information.\n     */\n    //memset((unsigned char *)x, 0, sizeof (x));\n}\n\nvoid md5_avx2_init(MD5_AVX2_CTX *context)\n{\n    context-&gt;count[0] = context-&gt;count[1] = 0;\n    /* Load magic initialization constants. */\n    context-&gt;state[0] = _mm256_set1_epi32(0x67452301);\n    context-&gt;state[1] = _mm256_set1_epi32(0xefcdab89);\n    context-&gt;state[2] = _mm256_set1_epi32(0x98badcfe);\n    context-&gt;state[3] = _mm256_set1_epi32(0x10325476);\n}\n\nvoid md5_avx2_update1(MD5_AVX2_CTX *context, unsigned char *input, unsigned int inputLen)\n{\n    md5_avx2_update8(context, input, input, input, input, input, input, input, input, inputLen);\n}\n\nvoid md5_avx2_update8(MD5_AVX2_CTX *context, unsigned char *input1, unsigned char *input2, unsigned char *input3, unsigned char *input4, unsigned char *input5, unsigned char *input6, unsigned char *input7, unsigned char *input8, unsigned int inputLen)\n{\n    unsigned int i, index, partLen;\n\n    /* Compute number of bytes mod 64 */\n    index = (unsigned int)((context-&gt;count[0] &gt;&gt; 3) &amp; 0x3F);\n\n    /* Update number of bits */\n    if ((context-&gt;count[0] += ((unsigned long int)inputLen &lt;&lt; 3)) &lt; ((unsigned long int)inputLen &lt;&lt; 3))\n        context-&gt;count[1]++;\n\n    context-&gt;count[1] += ((unsigned long int)inputLen &gt;&gt; 29);\n\n    partLen = 64 - index;\n\n    /* Transform as many times as possible. */\n    if (inputLen &gt;= partLen)\n    {\n        memcpy((unsigned char *)&amp;context-&gt;buffer1[index], (unsigned char *)input1, partLen);\n        memcpy((unsigned char *)&amp;context-&gt;buffer2[index], (unsigned char *)input2, partLen);\n        memcpy((unsigned char *)&amp;context-&gt;buffer3[index], (unsigned char *)input3, partLen);\n        memcpy((unsigned char *)&amp;context-&gt;buffer4[index], (unsigned char *)input4, partLen);\n        memcpy((unsigned char *)&amp;context-&gt;buffer5[index], (unsigned char *)input5, partLen);\n        memcpy((unsigned char *)&amp;context-&gt;buffer6[index], (unsigned char *)input6, partLen);\n        memcpy((unsigned char *)&amp;context-&gt;buffer7[index], (unsigned char *)input7, partLen);\n        memcpy((unsigned char *)&amp;context-&gt;buffer8[index], (unsigned char *)input8, partLen);\n\n        md5_avx2_transform(context-&gt;state, context-&gt;buffer1, context-&gt;buffer2, context-&gt;buffer3, context-&gt;buffer4, context-&gt;buffer5, context-&gt;buffer6, context-&gt;buffer7, context-&gt;buffer8);\n\n        for (i = partLen; i + 63 &lt; inputLen; i += 64)\n            md5_avx2_transform(context-&gt;state, &amp;input1[i], &amp;input2[i], &amp;input3[i], &amp;input4[i], &amp;input5[i], &amp;input6[i], &amp;input7[i], &amp;input8[i]);\n\n        index = 0;\n    }\n    else\n    {\n        i = 0;\n    }\n\n    /* Buffer remaining input */\n    memcpy((unsigned char *)&amp;context-&gt;buffer1[index], (unsigned char *)&amp;input1[i], inputLen-i);\n    memcpy((unsigned char *)&amp;context-&gt;buffer2[index], (unsigned char *)&amp;input2[i], inputLen-i);\n    memcpy((unsigned char *)&amp;context-&gt;buffer3[index], (unsigned char *)&amp;input3[i], inputLen-i);\n    memcpy((unsigned char *)&amp;context-&gt;buffer4[index], (unsigned char *)&amp;input4[i], inputLen-i);\n    memcpy((unsigned char *)&amp;context-&gt;buffer5[index], (unsigned char *)&amp;input5[i], inputLen-i);\n    memcpy((unsigned char *)&amp;context-&gt;buffer6[index], (unsigned char *)&amp;input6[i], inputLen-i);\n    memcpy((unsigned char *)&amp;context-&gt;buffer7[index], (unsigned char *)&amp;input7[i], inputLen-i);\n    memcpy((unsigned char *)&amp;context-&gt;buffer8[index], (unsigned char *)&amp;input8[i], inputLen-i);\n}\n\nvoid md5_avx2_final(unsigned char digests[8][16], MD5_AVX2_CTX *context)\n{\n    unsigned char bits[8];\n    unsigned int index, padLen;\n    int i, j;\n\n    /* Save number of bits */\n    encode(bits, context-&gt;count, 8);\n\n    /* Pad out to 56 mod 64. */\n    index = (unsigned int)((context-&gt;count[0] &gt;&gt; 3) &amp; 0x3f);\n    padLen = (index &lt; 56) ? (56 - index) : (120 - index);\n    md5_avx2_update1(context, PADDING, padLen);\n\n    /* Append length (before padding) */\n    md5_avx2_update1(context, bits, 8);\n\n    /* Store state in digest */\n    for (i = 0; i &lt; 8; i++)\n        for (j = 0; j &lt; 4; j++)\n            encode(&amp;digests[i][j*4], &amp;((unsigned long int *) &amp;context-&gt;state[j])[i], 4);\n\n    /* Zeroize sensitive information. */\n    //memset((unsigned char *)context, 0, sizeof (*context));\n}\n</code></pre>\n\n<p>md5_common.h</p>\n\n<pre><code>#ifndef MD5_COMMON_H\n#define MD5_COMMON_H\n\n#define S11 7\n#define S12 12\n#define S13 17\n#define S14 22\n#define S21 5\n#define S22 9\n#define S23 14\n#define S24 20\n#define S31 4\n#define S32 11\n#define S33 16\n#define S34 23\n#define S41 6\n#define S42 10\n#define S43 15\n#define S44 21\n\nstatic unsigned char PADDING[64] =\n{\n    0x80, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,\n    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,\n    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0\n};\n\nvoid encode(unsigned char *output, unsigned long int *input, unsigned int len);\n\n#endif\n</code></pre>\n\n<p>main file</p>\n\n<pre><code>int main(int argc, char *argv[])\n{\n    char *string = \"abcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyz\";\n    int len = strlen(string);\n\n    /* Test strings. */\n    printf(\"TEST STRINGS\\n\");\n\n        unsigned char digest[8][16];\n    int i, j;\n\n    MD5_AVX2_CTX context;       \n    md5_avx2_init(&amp;context);\n    md5_avx2_update1(&amp;context, string, len);\n    md5_avx2_final(digest, &amp;context);\n\n    printf(\"AVX2 (\\\"%s\\\") = \", string);\n    for (i = 0; i &lt; 8; i++)\n    {\n        for (j = 0; j &lt; 16; j++)\n            printf (\"%02x\", digest[i][j]);\n        printf(\"\\n\");\n    }\n}\n</code></pre>\n\n<p>44077f4856c7d6c519fce5dfc0fb1fcf </p>\n\n<p>44077f4856c7d6c519fce5dfc0fb1fcf </p>\n\n<p>44077f4856c7d6c519fce5dfc0fb1fcf </p>\n\n<p>44077f4856c7d6c519fce5dfc0fb1fcf </p>\n\n<p>44077f4856c7d6c519fce5dfc0fb1fcf </p>\n\n<p>44077f4856c7d6c519fce5dfc0fb1fcf </p>\n\n<p>44077f4856c7d6c519fce5dfc0fb1fcf </p>\n\n<p>44077f4856c7d6c519fce5dfc0fb1fcf </p>\n\n<p>this working properly with MSVC 2013 v120 c compiler</p>\n\n<h1>but with gcc 7.2 compiler i get</h1>\n\n<p>44077f4856c7d6c519fce5dfc0fb1fcf</p>\n\n<p>44077f4856c7d6c519fce5dfc0fb1fcf</p>\n\n<p>44077f4856c7d6c519fce5dfc0fb1fcf</p>\n\n<p>44077f4856c7d6c519fce5dfc0fb1fcf</p>\n\n<p>56c7d6c519fce5dfc0fb1fcf00000000</p>\n\n<p>56c7d6c519fce5dfc0fb1fcf00000000</p>\n\n<p>56c7d6c519fce5dfc0fb1fcf00000000</p>\n\n<p>56c7d6c519fce5dfc0fb1fcf00000000</p>\n\n<p>Can some expert please help me why the same code behaves different with compilers.. no optimizations enabled..</p>\n"}, {"tags": ["c", "stdin", "fgets", "strtok"], "comments": [{"owner": {"reputation": 19358, "user_id": 3049655, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ZLzeP.jpg?s=128&g=1", "display_name": "Spikatrix", "link": "https://stackoverflow.com/users/3049655/spikatrix"}, "edited": false, "score": 1, "creation_date": 1554297101, "post_id": 55496044, "comment_id": 97699154, "body": "<code>buf</code> or <code>line</code>?"}, {"owner": {"reputation": 41, "user_id": 6475718, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209494978600809/picture?type=large", "display_name": "Gideon Mooijen", "link": "https://stackoverflow.com/users/6475718/gideon-mooijen"}, "reply_to_user": {"reputation": 19358, "user_id": 3049655, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ZLzeP.jpg?s=128&g=1", "display_name": "Spikatrix", "link": "https://stackoverflow.com/users/3049655/spikatrix"}, "edited": false, "score": 0, "creation_date": 1554297333, "post_id": 55496044, "comment_id": 97699317, "body": "Sorry, this was not clear.   buf is the input. Line is where I want to store the tokens"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1554297421, "post_id": 55496044, "comment_id": 97699377, "body": "That&#39;s why it&#39;s so important to create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> to show us. Please edit your question to include one. Also please read about <a href=\"http://stackoverflow.com/help/how-to-ask\">how to ask good questions</a>, as well as <a href=\"https://codeblog.jonskeet.uk/2012/11/24/stack-overflow-question-checklist/\" rel=\"nofollow noreferrer\">this question checklist</a>."}, {"owner": {"reputation": 5181, "user_id": 8866606, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Ao_wuU1YCUE/AAAAAAAAAAI/AAAAAAAAAtc/Nc6ExTtKE_A/photo.jpg?sz=128", "display_name": "Stefan Becker", "link": "https://stackoverflow.com/users/8866606/stefan-becker"}, "edited": false, "score": 2, "creation_date": 1554297501, "post_id": 55496044, "comment_id": 97699426, "body": "<code>man 3 strtok</code> maybe? &quot;the  <code>strtok()</code>  function breaks a string into a sequence of zero or more        nonempty tokens.  On the first call  to  <code>strtok()</code>,  the  string  to  be        parsed should be specified in str.  In each subsequent call that should        parse the same string, str must be <code>NULL</code>.&quot;. I don&#39;t see a loop for <code>strtok()</code> results."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1554398799, "post_id": 55496044, "comment_id": 97747898, "body": "the first thing that is wrong is the posted code does not compile!"}], "answers": [{"tags": [], "owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "is_accepted": true, "score": 5, "last_activity_date": 1554297294, "creation_date": 1554297294, "answer_id": 55496124, "question_id": 55496044, "link": "https://stackoverflow.com/questions/55496044/using-fgets-in-combination-with-strtok-to-transform-input-to-tokens/55496124#55496124", "title": "Using fgets in combination with strtok to transform input to tokens", "body": "<p>You need to have <code>loop</code> to process all the tokens. <code>strtok</code> will return <code>NULL</code> once all the tokens are over.</p>\n\n<p><strong>Example:</strong></p>\n\n<pre><code>while (fgets(buf, BUF_SIZE, stdin)) {\n    token = strtok(buf,\" \\n\");\n\n    while (token != NULL) { \n        printf(\"%s\", token);\n        token = strtok(NULL,\" \\n\");\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 6475718, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209494978600809/picture?type=large", "display_name": "Gideon Mooijen", "link": "https://stackoverflow.com/users/6475718/gideon-mooijen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 196, "favorite_count": 0, "accepted_answer_id": 55496124, "answer_count": 1, "score": 3, "last_activity_date": 1554297294, "creation_date": 1554297034, "question_id": 55496044, "link": "https://stackoverflow.com/questions/55496044/using-fgets-in-combination-with-strtok-to-transform-input-to-tokens", "title": "Using fgets in combination with strtok to transform input to tokens", "body": "<p>I am reading input from different text files. These text files are integers that are either separated by a space, a new line, or a combination of spaces and new lines. I want to convert these strings to integers, and use these integers for a sorting algorithm.</p>\n\n<pre><code>char *line = malloc(BUF_SIZE);\nchar *token;\n\nstruct list* l = list_init();\n\nwhile (fgets(buf, BUF_SIZE, stdin)) {\n    token = strtok(buf,\" \\n\");\n    printf(\"%s\", token);\n}\n\nlist_cleanup(l);\n\nreturn 0;\n</code></pre>\n\n<p>What is wrong with this, it that it just prints the first element of each line. It doesn't handle multiple elements per line.</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["c", "assembly", "visual-studio-code"], "comments": [{"owner": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "edited": false, "score": 0, "creation_date": 1554297599, "post_id": 55495795, "comment_id": 97699503, "body": "Please copy&amp;paste the exact error messages or warnings to your question. Which compiler do you use?"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1554300888, "post_id": 55495795, "comment_id": 97701586, "body": "That asm source file looks like MASM syntax, I think.  Definitely not GNU assembler directives or anything, so if you tried to build the asm with <code>g++</code> then yeah it will definitely fail.  But without a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>, we don&#39;t know how you tried to build this or what errors you got."}, {"owner": {"reputation": 22874, "user_id": 3282056, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/IXonK.jpg?s=128&g=1", "display_name": "rcgldr", "link": "https://stackoverflow.com/users/3282056/rcgldr"}, "edited": false, "score": 0, "creation_date": 1554310171, "post_id": 55495795, "comment_id": 97707333, "body": "The question is tagged with Visual Studio, but asks about g++. For Visual Studio, it may take a default to assemble .asm files in a project, but to avoid issues, I create an empty project, then &quot;add existing files&quot; to the project, and then for each .asm file, I click on properties, to include the file in the build, and add custom build steps to invoke the assmbler (ML.EXE or ML64.EXE). Command line for &quot;x.asm&quot; is &quot;ml64 /c /Zi /Fo$(OutDir)\\x.obj x.asm&quot; (/Zi only for debug build). Output is &quot;$(OutDir)\\x.obj&quot; ."}, {"owner": {"reputation": 7, "user_id": 2527297, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79b80311cfcd789990e46975746555d5?s=128&d=identicon&r=PG", "display_name": "Daniel Ruiz Molina", "link": "https://stackoverflow.com/users/2527297/daniel-ruiz-molina"}, "edited": false, "score": 0, "creation_date": 1554373962, "post_id": 55495795, "comment_id": 97732157, "body": "No, it is tagged with &quot;visual studio code&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 2527297, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79b80311cfcd789990e46975746555d5?s=128&d=identicon&r=PG", "display_name": "Daniel Ruiz Molina", "link": "https://stackoverflow.com/users/2527297/daniel-ruiz-molina"}, "edited": false, "score": 0, "creation_date": 1554727181, "post_id": 55516291, "comment_id": 97846002, "body": "I have copied your simple sample and I have tried to compile it from Visual Studio Code. When I run my &quot;gcc build active file&quot; tasks, I receive this error:"}], "tags": [], "owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "is_accepted": false, "score": 1, "last_activity_date": 1554381758, "creation_date": 1554381758, "answer_id": 55516291, "question_id": 55495795, "link": "https://stackoverflow.com/questions/55495795/how-i-can-add-assembly-code-in-c-project/55516291#55516291", "title": "How I can add assembly code in C project?", "body": "<p>hmm</p>\n\n<p>so.c</p>\n\n<pre><code>extern \"C\" int fun ( void );\nint x;\nint main()\n{\n    x=fun();\n    return x;\n}\n</code></pre>\n\n<p>fun.c</p>\n\n<pre><code>int fun ( void )\n{\n    return(5);\n}\n</code></pre>\n\n<p>build</p>\n\n<pre><code>gcc fun.c -O2 -c -o fun.o\ng++ -O2 so.cpp fun.o -o so\n</code></pre>\n\n<p>No errors</p>\n\n<pre><code>00000000004003e0 &lt;main&gt;:\n  4003e0:   48 83 ec 08             sub    $0x8,%rsp\n  4003e4:   e8 17 01 00 00          callq  400500 &lt;fun&gt;\n  4003e9:   89 05 45 0c 20 00       mov    %eax,0x200c45(%rip)        # 601034 &lt;x&gt;\n  4003ef:   48 83 c4 08             add    $0x8,%rsp\n  4003f3:   c3                      retq   \n\n\n0000000000400500 &lt;fun&gt;:\n  400500:   b8 05 00 00 00          mov    $0x5,%eax\n  400505:   c3                      retq   \n</code></pre>\n\n<p>okay so</p>\n\n<p>morefun.s</p>\n\n<pre><code>.globl fun\nfun:\n    mov $0x5,%eax\n    retq\n</code></pre>\n\n<p>build</p>\n\n<pre><code>as morefun.s -o morefun.o\ng++ -O2 so.cpp morefun.o -o so\n</code></pre>\n\n<p>no errors,</p>\n\n<p>examine</p>\n\n<pre><code>00000000004003e0 &lt;main&gt;:\n  4003e0:   48 83 ec 08             sub    $0x8,%rsp\n  4003e4:   e8 0d 01 00 00          callq  4004f6 &lt;fun&gt;\n  4003e9:   89 05 45 0c 20 00       mov    %eax,0x200c45(%rip)        # 601034 &lt;x&gt;\n  4003ef:   48 83 c4 08             add    $0x8,%rsp\n  4003f3:   c3                      retq   \n\n0000000004004f6 &lt;fun&gt;:\n  4004f6:   b8 05 00 00 00          mov    $0x5,%eax\n  4004fb:   c3                      retq   \n</code></pre>\n\n<p>Still looks good, no problem adding assembly to a C++ project by making it look like a C function.</p>\n\n<p>Other path</p>\n\n<pre><code>int fun ( void )\n{\n    return(5);\n}\n</code></pre>\n\n<p>gnu and most other sane compilers compile to asm then call the assembler so you can just see how they do it and repeat that</p>\n\n<pre><code>gcc -O2 -S fun.c -o fun.s\nas fun.s -o fun.o\n</code></pre>\n\n<p>cat fun.s</p>\n\n<pre><code>    .file   \"fun.c\"\n    .section    .text.unlikely,\"ax\",@progbits\n.LCOLDB0:\n    .text\n.LHOTB0:\n    .p2align 4,,15\n    .globl  fun\n    .type   fun, @function\nfun:\n.LFB0:\n    .cfi_startproc\n    movl    $5, %eax\n    ret\n    .cfi_endproc\n.LFE0:\n    .size   fun, .-fun\n    .section    .text.unlikely\n.LCOLDE0:\n    .text\n.LHOTE0:\n    .ident  \"GCC: (Ubuntu 5.4.0-6ubuntu1~16.04.11) 5.4.0 20160609\"\n    .section    .note.GNU-stack,\"\",@progbits\n</code></pre>\n\n<p>or use save-temps.</p>\n\n<pre><code>gcc -O2 -c -save-temps fun.c -o fun.o\n</code></pre>\n\n<p>to see the asm generated by the compiler</p>\n\n<p>It is generally more painful to try to use compiled assembly as a starting point as is, cutting and pasting sure but there is a lot of overhead and the machine generated labels that you would want to clean up rather than start from scratch. (I prefer to disassemble and work from that than to use the compiler output directly)</p>\n"}, {"comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1554766198, "post_id": 55573799, "comment_id": 97864300, "body": "This is a separate question, not an <i>answer</i> to this question.  Post it as a such.  (Are you sure <code>cwd</code> should be /usr/bin?  Normally on Unix/Linux you compile files with CWD = the directory containing the source file, or the project root directory, definitely not the directory containing the compiler.)"}], "tags": [], "owner": {"reputation": 7, "user_id": 2527297, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79b80311cfcd789990e46975746555d5?s=128&d=identicon&r=PG", "display_name": "Daniel Ruiz Molina", "link": "https://stackoverflow.com/users/2527297/daniel-ruiz-molina"}, "is_accepted": false, "score": 0, "last_activity_date": 1554727426, "creation_date": 1554727426, "answer_id": 55573799, "question_id": 55495795, "link": "https://stackoverflow.com/questions/55495795/how-i-can-add-assembly-code-in-c-project/55573799#55573799", "title": "How I can add assembly code in C project?", "body": "<p>I have copied your simple sample and I have tried to compile it from Visual Studio Code. When I run my \"gcc build active file\" tasks, I receive this error: </p>\n\n<blockquote>\n  <p>/root/C-foro/so.c:1:8: error: expected identifier or \u2018(\u2019 before string\n  constant  extern \"C\" int fun (void);</p>\n</blockquote>\n\n<p>My gcc build task is configured in this way inside Visual Studio Code:</p>\n\n<pre><code>{\n    // See https://go.microsoft.com/fwlink/?LinkId=733558 \n    // for the documentation about the tasks.json format\n    \"version\": \"2.0.0\",\n    \"tasks\": [\n        {\n            \"type\": \"shell\",\n            \"label\": \"gcc build active file\",\n            \"command\": \"/usr/bin/gcc\",\n            \"args\": [\n                \"-O2\",\n                \"-c\",\n                \"${file}\",\n                \"-o\",\n                \"${fileDirname}/${fileBasenameNoExtension}\"\n            ],\n            \"options\": {\n                \"cwd\": \"/usr/bin\"\n            },\n            \"problemMatcher\": [\n                \"$gcc\"\n            ]\n        }\n    ]\n</code></pre>\n\n<p>so I suppose my problem is ONLY in my tasks.json file in Visual Studio Code, because if I run in a console \"gcc fun.c -O2 -c -o fun.o\" all runs OK...</p>\n\n<p>where is my problem?</p>\n\n<p>Thanks!</p>\n"}], "owner": {"reputation": 7, "user_id": 2527297, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79b80311cfcd789990e46975746555d5?s=128&d=identicon&r=PG", "display_name": "Daniel Ruiz Molina", "link": "https://stackoverflow.com/users/2527297/daniel-ruiz-molina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1269, "favorite_count": 2, "answer_count": 2, "score": 0, "last_activity_date": 1554727426, "creation_date": 1554296300, "question_id": 55495795, "link": "https://stackoverflow.com/questions/55495795/how-i-can-add-assembly-code-in-c-project", "title": "How I can add assembly code in C project?", "body": "<p>I would like to compile a simple C project that has some externals functions defined in a ASM file. My main file is a C++ that calls some \"extern \"C\"\" functions that are defined in a assembly file.</p>\n\n<p>When I run task \"g++ build active file\", I receive some warnings about the \"extern\" and some errors about functions defined in asm file telling \"reference to my_funcions not defined\".</p>\n\n<p>My C++ file contains a \"extern\" like this:</p>\n\n<pre><code>[...]\nextern \"C\" {\n    // Subrutines en ASM\n    void posCurScreenP1();\n    void moveCursorP1();\n    void openP1();\n    void getMoveP1();\n    void movContinuoP1();\n    void openContinuousP1();\n    void printChar_C(char c);\n    int clearscreen_C();\n    int printMenu_C();\n    int gotoxy_C(int row_num, int col_num);\n    char getch_C();\n    int printBoard_C(int tries);\n    void continue_C();\n}\n[...]\n</code></pre>\n\n<p>and my asm file contains this:</p>\n\n<pre><code>.586\n.MODEL FLAT, C\n; Funcions definides en C\nprintChar_C PROTO C, value:SDWORD\nprintInt_C PROTO C, value:SDWORD\nclearscreen_C PROTO C\nclearArea_C PROTO C, value:SDWORD, value1: SDWORD\nprintMenu_C PROTO C\ngotoxy_C PROTO C, value:SDWORD, value1: SDWORD\ngetch_C PROTO C\nprintBoard_C PROTO C, value: DWORD\ninitialPosition_C PROTO C\n.code   \n[...]\n</code></pre>\n\n<p>Sure I'm doing some things wrong. Could you help me?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["c", "linux"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1554296374, "post_id": 55495712, "comment_id": 97698678, "body": "You need to build the object files in the <i>library</i> with <code>-fPIC</code>."}, {"owner": {"reputation": 587, "user_id": 2665842, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QFnS8.png?s=128&g=1", "display_name": "Server Fault", "link": "https://stackoverflow.com/users/2665842/server-fault"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1554296928, "post_id": 55495712, "comment_id": 97699029, "body": "Added <code>-fPIC</code> but getting the same <code>libduo.a is not portable</code> error building the module (maybe I have some stray edits in there yet..).   build for the library is now this: <code>gcc -g -O2 -Wall -D_FORTIFY_SOURCE=2 -fstack-protector -fPIC -I. -I.   -DDUODIR=\\&quot;&#47;usr&#47;local&#47;duo&#47;libduo&#47;etc\\&quot; -DHAVE_CONFIG_H -c urlenc.c &#47;usr&#47;bin&#47;ar rv libduo.a duo.o http_parser.o https.o match.o parson.o urlenc.o &#47;usr&#47;bin&#47;ar: creating libduo.a</code>. Do I need to modify the <code>ar</code> or <code>ranlib</code> commands maybe?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1554297033, "post_id": 55495712, "comment_id": 97699109, "body": "Don&#39;t mix <code>-shared</code> and <code>-static</code>, that&#39;s not possible. But if you build all the object files in the library with <code>-fPIC</code> then the first problem you have should be solved."}, {"owner": {"reputation": 587, "user_id": 2665842, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QFnS8.png?s=128&g=1", "display_name": "Server Fault", "link": "https://stackoverflow.com/users/2665842/server-fault"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1554297181, "post_id": 55495712, "comment_id": 97699218, "body": "Gotcha. Not sure where that <code>-static</code> stuff is happening yet. Still looking.."}, {"owner": {"reputation": 587, "user_id": 2665842, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QFnS8.png?s=128&g=1", "display_name": "Server Fault", "link": "https://stackoverflow.com/users/2665842/server-fault"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1554303925, "post_id": 55495712, "comment_id": 97703762, "body": "@Someprogrammerdude - Thanks! compiled and working. I owe you a beverage :)"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1554305056, "post_id": 55495712, "comment_id": 97704493, "body": "I&#39;ll hold you to that! ;)"}], "owner": {"reputation": 587, "user_id": 2665842, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QFnS8.png?s=128&g=1", "display_name": "Server Fault", "link": "https://stackoverflow.com/users/2665842/server-fault"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1554304148, "creation_date": 1554296050, "last_edit_date": 1554304148, "question_id": 55495712, "link": "https://stackoverflow.com/questions/55495712/building-a-c-application-against-an-external-library-on-linux", "title": "Building a C application against an external library on linux", "body": "<p>I'm working on a Linux project in <code>C</code> consisting of two different open source applications. \"Project A\" (<a href=\"https://github.com/duosecurity/libduo\" rel=\"nofollow noreferrer\">libduo</a>) creates an archive used for linking a couple test programs and creates the library like this:</p>\n\n<pre><code>/usr/bin/ar rv libduo.a duo.o http_parser.o https.o match.o parson.o urlenc.o\n/usr/bin/ar: creating libduo.a\na - duo.o\na - http_parser.o\na - https.o\na - match.o\na - parson.o\na - urlenc.o\nranlib libduo.a\n</code></pre>\n\n<p>One of the <code>libduo</code> test programs is built like this:</p>\n\n<pre><code>gcc -g -O2 -Wall -D_FORTIFY_SOURCE=2 -fstack-protector -I. -I.   -DDUODIR=\\\"/usr/local/duo/libduo/etc\\\" -DHAVE_CONFIG_H -c test-duologin.c\ngcc -o test-duologin test-duologin.o -L.   -lduo -lssl -lcrypto \n</code></pre>\n\n<p>\"Project B\" is an <a href=\"http://www.openldap.org/\" rel=\"nofollow noreferrer\">OpenLDAP</a> module which I've built with <code>-lduo</code> and a few options to tell it where to find things:</p>\n\n<pre><code>(cd .libs &amp;&amp; rm -f pw-apr1.la &amp;&amp; ln -s ../pw-apr1.la pw-apr1.la)\n../../../libtool --mode=compile gcc -g -O2 -Wall  -I../../../include -I../../../include -I../../../servers/slapd -I../../../contrib/slapd-modules/passwd/libduo -c pw-duo.c\n gcc -g -O2 -Wall -I../../../include -I../../../include -I../../../servers/slapd -I../../../contrib/slapd-modules/passwd/libduo -c pw-duo.c  -fPIC -DPIC -o .libs/pw-duo.o\n gcc -g -O2 -Wall -I../../../include -I../../../include -I../../../servers/slapd -I../../../contrib/slapd-modules/passwd/libduo -c pw-duo.c -o pw-duo.o &gt;/dev/null 2&gt;&amp;1\n../../../libtool --mode=link gcc -g -O2 -Wall -version-info 0:0:0 \\\n-rpath /usr/local/libexec/openldap -module -o pw-duo.la pw-duo.lo libduo.a -lduo\n\n*** Warning: Linking the shared library pw-duo.la against the\n*** static library libduo.a is not portable!\ncc -shared  .libs/pw-duo.o  libduo.a -lduo  -Wl,-soname -Wl,pw-duo.so.0 -o .libs/pw-duo.so.0.0.0\n/usr/bin/ld: libduo.a(duo.o): relocation R_X86_64_32 against `.rodata.str1.1' can not be used when making a shared object; recompile with -fPIC\nlibduo.a: error adding symbols: Bad value\ncollect2: error: ld returned 1 exit status\nMakefile:51: recipe for target 'pw-duo.la' failed\nmake: *** [pw-duo.la] Error 1\n</code></pre>\n\n<p>The Makefile I'm using is the same one distributed with the OpenLDAP project. I've just added a section in the Makefile to build my module, using the same options for the other modules already there but adding <code>-lduo</code> to my section along with the paths to the <code>libduo</code> includes and <code>libduo.a</code>.  </p>\n\n<p>As <code>make</code> suggests above, I've recompiled by adding <code>-fPIC</code> after the <code>-Wall</code> option but it the same error was repeated. As a last resort, I tried adding <code>-static</code> to the module build but <code>make</code> was having none of that either:</p>\n\n<pre><code>*** Warning: Linking the shared library pw-duo.la against the\n*** static library libduo.a is not portable!\n</code></pre>\n\n<p>This is the first time I've tried to build a <code>C</code> application against a lib not in the standard Linux locations so not exactly sure what's going on. I suspect <code>libduo</code> is built intended to be statically linked into everything, but the OpenLDAP modules are designed to use shared libraries. Can anyone elucidate?</p>\n\n<p>Update: with help of comments below and this <a href=\"https://stackoverflow.com/questions/655163/convert-a-static-library-to-a-shared-library\">link</a> I created a shared library from the <code>.o</code> files and distributed/built against that.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "edited": false, "score": 8, "creation_date": 1554295453, "post_id": 55495511, "comment_id": 97698064, "body": "<code>command = scanf(&quot;%c&quot;,&amp;command);</code> --&gt;<code>scanf(&quot;%c&quot;,&amp;command);</code> As of now you are overwriting user inputted value with the <code>scanf</code> return value."}, {"owner": {"reputation": 11, "user_id": 11305641, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-sIf4tZSQ55A/AAAAAAAAAAI/AAAAAAAAD0A/OsDSfdoDol8/photo.jpg?sz=128", "display_name": "abishek bajgain", "link": "https://stackoverflow.com/users/11305641/abishek-bajgain"}, "reply_to_user": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "edited": false, "score": 0, "creation_date": 1554295644, "post_id": 55495511, "comment_id": 97698178, "body": "still cannot loop the code. Appreciate the help"}, {"owner": {"reputation": 11, "user_id": 11305641, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-sIf4tZSQ55A/AAAAAAAAAAI/AAAAAAAAD0A/OsDSfdoDol8/photo.jpg?sz=128", "display_name": "abishek bajgain", "link": "https://stackoverflow.com/users/11305641/abishek-bajgain"}, "edited": false, "score": 1, "creation_date": 1554296152, "post_id": 55495511, "comment_id": 97698535, "body": "Got it to work. Thanks a lot. Learned a new thing today. cheers"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1554297415, "post_id": 55495511, "comment_id": 97699369, "body": "<a href=\"https://stackoverflow.com/questions/35178520/how-to-read-parse-input-in-c-the-faq\">How to read / parse input in C? The FAQ</a>"}], "answers": [{"tags": [], "owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "is_accepted": true, "score": 2, "last_activity_date": 1554297288, "last_edit_date": 1554297288, "creation_date": 1554296081, "answer_id": 55495721, "question_id": 55495511, "link": "https://stackoverflow.com/questions/55495511/i-want-to-loop-this-code-until-user-wants/55495721#55495721", "title": "I want to loop this code until user wants", "body": "<p><code>scanf(\"%c\",&amp;command);</code> returns 1 if you read a character, 0 on end of file, so it cannot be 'y'</p>\n\n<p>warning also with the newline you will read doing char by char (without a space before the <em>%c</em> in the format)</p>\n\n<p>you can do :</p>\n\n<pre><code>char command[4];\n\ndo{\n    ...\n    printf(\"Do you want to run the program Again? \\n Type y or n \\n\");\n    if (scanf(\"%3s\",command) != 1) {\n      /* EOF */\n      break;\n    } \n} while(*command == 'y');\n</code></pre>\n\n<p>As you can see in the <em>scanf</em> I limit the length of the read string to 3 (allowing yes/no in case ;-) ), that allows to not take the risk to write out of <em>command</em> having size 3+1 to be able to memorize the null char.</p>\n"}], "owner": {"reputation": 11, "user_id": 11305641, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-sIf4tZSQ55A/AAAAAAAAAAI/AAAAAAAAD0A/OsDSfdoDol8/photo.jpg?sz=128", "display_name": "abishek bajgain", "link": "https://stackoverflow.com/users/11305641/abishek-bajgain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 55495721, "answer_count": 1, "score": -1, "last_activity_date": 1554297288, "creation_date": 1554295369, "question_id": 55495511, "link": "https://stackoverflow.com/questions/55495511/i-want-to-loop-this-code-until-user-wants", "title": "I want to loop this code until user wants", "body": "<p>I am trying to run this program until user wants but unable to. </p>\n\n<p>I have tried using do-while loop but couldn't achieve the desired output</p>\n\n<pre><code>float water_level;\nchar command;\n\ndo{\n    printf(\"Enter the water level sensor readout in meters : \\n\");\n    scanf(\"%f\",&amp;water_level);\n\n    printf(\"The water level is: %f \\n\",water_level);\n\n    if(water_level &lt;= 0.5)\n    {\n        printf(\"The output valve is turned OFF \\n\");\n    }\n    else\n         printf(\"The output valve is turned ON \\n\");\n\n    if(water_level &lt; 3.0)\n        {\n           printf(\"The water pump is turned ON \\n\");\n        }\n    else\n        printf(\"The water pump is turned OFF \\n\");\n\n    printf(\"Do you want to run the program Again? \\n Type y or n \\n\");\n    command = scanf(\"%c\",&amp;command);\n\n    } while(command == 'y');\n\n}\n</code></pre>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 14, "creation_date": 1554294357, "post_id": 55495127, "comment_id": 97697368, "body": "If your teacher couldn&#39;t explain why <code>&amp;i</code> has the same value twice they should not be teaching C."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 7, "creation_date": 1554294734, "post_id": 55495127, "comment_id": 97697597, "body": "If you write down your home address on a piece of paper and I change the house number on that paper, do you have a new home?"}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "reply_to_user": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1554295062, "post_id": 55495127, "comment_id": 97697795, "body": "@molbdnilo I was thinking about that way to move from my small apart into a castle (more appropriate for my DB9), that doesn&#39;t work ? you killed my dream, bad boy ^^"}], "answers": [{"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 2, "last_activity_date": 1554294921, "last_edit_date": 1554294921, "creation_date": 1554294483, "answer_id": 55495211, "question_id": 55495127, "link": "https://stackoverflow.com/questions/55495127/creation-of-a-variable-and-subsequently-increasing-its-memory-address-by-1/55495211#55495211", "title": "Creation of a variable and subsequently increasing its memory address by 1", "body": "<p>The address of a variable never changes during its lifetime.  Just because <code>x</code> starts out containing the value of that address and you then increment the value of <code>x</code> doesn't mean that the address of <code>i</code> changes.</p>\n\n<p>Taking an analogy from the comments, suppose you write the address of your house on a piece of paper.  Now suppose you increment the value of the house number on that sheet of paper.  Your home is not in a different place, you just changed the house number you wrote down.</p>\n\n<p>So <code>&amp;i</code> will always have the same value, regardless of whatever value <code>x</code> may contain.</p>\n"}, {"comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1554295131, "post_id": 55495213, "comment_id": 97697834, "body": "<code>Every object in a C program has a unique fixed address during its existence.</code> - True, but how is that related to this context? Even if it wouldn&#39;t, the result here would not change"}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1554295312, "post_id": 55495213, "comment_id": 97697967, "body": "@SouravGhosh - To dissolve any expectation that it <i>may</i> change, and educate the OP a bit on a broader context."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1554295775, "post_id": 55495213, "comment_id": 97698279, "body": "@StoryTeller TBH, whether the address of a variable can be changed during run-time or not is of little importance here. What OP needs to know is that the statements never even attempted to change the value of <code>&amp;i</code>, in first place. I tried to cover that in my answer. Not saying yours is wrong, but maybe you can consider re-wording."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1554295896, "post_id": 55495213, "comment_id": 97698361, "body": "@SouravGhosh - With all due respect, I don&#39;t agree. I do consider it pertinent to the OP&#39;s misunderstanding. And I did touch on manipulating a copy. I&#39;ll keep it as is, thanks."}], "tags": [], "owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "is_accepted": false, "score": 5, "last_activity_date": 1554294491, "creation_date": 1554294491, "answer_id": 55495213, "question_id": 55495127, "link": "https://stackoverflow.com/questions/55495127/creation-of-a-variable-and-subsequently-increasing-its-memory-address-by-1/55495213#55495213", "title": "Creation of a variable and subsequently increasing its memory address by 1", "body": "<p>Every object in a <code>C</code> program has a unique <strong>fixed</strong> address during its existence. You store a copy of <code>i</code>'s address into <code>x</code>. Then you manipulate <code>x</code> to change the value it holds, it now contains another address. But the manipulation of the value in <code>x</code> does not move <code>i</code>. The object named <code>i</code> is still in the same spot.</p>\n"}, {"tags": [], "owner": {"reputation": 196, "user_id": 11139937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fb20157f20488d087487a13a9544987?s=128&d=identicon&r=PG&f=1", "display_name": "Vaibhav", "link": "https://stackoverflow.com/users/11139937/vaibhav"}, "is_accepted": false, "score": 1, "last_activity_date": 1554294568, "creation_date": 1554294568, "answer_id": 55495242, "question_id": 55495127, "link": "https://stackoverflow.com/questions/55495127/creation-of-a-variable-and-subsequently-increasing-its-memory-address-by-1/55495242#55495242", "title": "Creation of a variable and subsequently increasing its memory address by 1", "body": "<p>Because the pointer value is incremented but the address of the variable <code>i</code> remain same. Pointer variable is also a variable that holds the address of variable <code>i</code>, changing its value won't effect the address of <code>i</code> variable.</p>\n"}, {"tags": [], "owner": {"reputation": 302, "user_id": 4801152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/119d66f25434b0432e67887ad8b4f64c?s=128&d=identicon&r=PG&f=1", "display_name": "Naliwe", "link": "https://stackoverflow.com/users/4801152/naliwe"}, "is_accepted": false, "score": 1, "last_activity_date": 1554294765, "creation_date": 1554294765, "answer_id": 55495308, "question_id": 55495127, "link": "https://stackoverflow.com/questions/55495127/creation-of-a-variable-and-subsequently-increasing-its-memory-address-by-1/55495308#55495308", "title": "Creation of a variable and subsequently increasing its memory address by 1", "body": "<p>The piece of code <code>x = &amp;i</code> <strong>copies</strong> <code>i</code>'s address into the <code>x</code> pointer. It's a copy, so modifying it only modifies the value stored in <code>x</code>, never will it change <code>i</code>'s address.</p>\n\n<p>I'm not sure what you are trying to achieve though. You can't change the address of a variable.</p>\n"}, {"tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 0, "last_activity_date": 1554295602, "last_edit_date": 1592644375, "creation_date": 1554294853, "answer_id": 55495338, "question_id": 55495127, "link": "https://stackoverflow.com/questions/55495127/creation-of-a-variable-and-subsequently-increasing-its-memory-address-by-1/55495338#55495338", "title": "Creation of a variable and subsequently increasing its memory address by 1", "body": "<p>This has nothing to do with pointers and memory address, specifically. Check the below program</p>\n<pre><code>int x = 5;\nint y = x;\n\nprintf (&quot; x= %d, y = %d\\n&quot;, x, y);\ny++;\nprintf (&quot; x= %d, y = %d\\n&quot;, x, y);\n</code></pre>\n<p>Output:</p>\n<blockquote>\n<p>x= 5, y = 5</p>\n<p>x= 5, y = 6</p>\n</blockquote>\n<p>Changing <code>y</code> does not affect the value of <code>x</code>. Same is applicable in your case, too.</p>\n<p>Simply put, <code>x</code> and <code>i</code> are two different variables, they have their own values. Now, given the fact that <code>x</code> is a pointer and assigned with the value of the address of <code>i</code>, you can use <code>x</code> to get the value stored at <code>i</code>. But that's it.</p>\n<p>This does not somehow &quot;link&quot; the two variables together, they still can be modified independent of each other. Only thing, after modifying the value of <code>x</code>, you can no longer use that to access the value stored in <code>i</code>, because it does not point to the address of <code>i</code> anymore.</p>\n"}], "owner": {"reputation": 21, "user_id": 11057069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4380cbe00e43482af6f78bd417d2247a?s=128&d=identicon&r=PG&f=1", "display_name": "adithya", "link": "https://stackoverflow.com/users/11057069/adithya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 1, "answer_count": 5, "score": 1, "last_activity_date": 1554296052, "creation_date": 1554294249, "last_edit_date": 1554296052, "question_id": 55495127, "link": "https://stackoverflow.com/questions/55495127/creation-of-a-variable-and-subsequently-increasing-its-memory-address-by-1", "title": "Creation of a variable and subsequently increasing its memory address by 1", "body": "<p>I created a variable and then I printed its location number. I then incremented the memory location by 1. I got the desired results in two cases while one case is giving an answer which could not be explained properly by my teachers. It would be really helpful if somebody told me why the second <code>printf(\"%p\\n\",&amp;i)</code> is giving the same output that was given first time.   </p>\n\n<pre><code>int main()\n{\n    int i=3,*x;\n    x=&amp;i;\n    printf(\"%p\\n\",x);\n    printf(\"%p\\n\",&amp;i);\n    printf(\"%p\\n\",&amp;(*x));\n    x++;\n    printf(\"\\n\");\n    printf(\"%p\\n\",x);\n    printf(\"%p\\n\",&amp;i);\n    printf(\"%p\\n\",&amp;(*x));\n}\n\n\n\n0x7ffce5dc5208\n0x7ffce5dc5208\n0x7ffce5dc5208\n\n0x7ffce5dc520c\n0x7ffce5dc5208\n0x7ffce5dc520c\n</code></pre>\n"}, {"tags": ["c", "linux", "sockets", "server"], "answers": [{"tags": [], "owner": {"reputation": 51, "user_id": 7712237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc9e7e840168e83d3ddf443d82795f57?s=128&d=identicon&r=PG&f=1", "display_name": "UKeeySDis", "link": "https://stackoverflow.com/users/7712237/ukeeysdis"}, "is_accepted": true, "score": 0, "last_activity_date": 1554632102, "creation_date": 1554632102, "answer_id": 55557832, "question_id": 55494963, "link": "https://stackoverflow.com/questions/55494963/how-to-understand-so-reuseport-can-simplify-the-task-of-conducting-stateful-conv/55557832#55557832", "title": "How to understand SO_REUSEPORT can simplify the task of conducting stateful conversations between the client and server?", "body": "<p>I got it, for examples, reverse proxy server.</p>\n"}], "owner": {"reputation": 51, "user_id": 7712237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc9e7e840168e83d3ddf443d82795f57?s=128&d=identicon&r=PG&f=1", "display_name": "UKeeySDis", "link": "https://stackoverflow.com/users/7712237/ukeeysdis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28, "favorite_count": 0, "accepted_answer_id": 55557832, "answer_count": 1, "score": 0, "last_activity_date": 1554632102, "creation_date": 1554293737, "last_edit_date": 1554378950, "question_id": 55494963, "link": "https://stackoverflow.com/questions/55494963/how-to-understand-so-reuseport-can-simplify-the-task-of-conducting-stateful-conv", "title": "How to understand SO_REUSEPORT can simplify the task of conducting stateful conversations between the client and server?", "body": "<p>I'm learning about SO_REUSEPORT socket option, and when I read \"<a href=\"https://lwn.net/Articles/542629/\" rel=\"nofollow noreferrer\">https://lwn.net/Articles/542629/</a>\", I have a confusion about this sentence:\"This eases the task of conducting stateful conversations between the client and server.\" in the article.</p>\n\n<p>As far as I understand, the SO_REUSEPORT option works on the same machine, and the stateful task between the server and the client is for multiple servers. Why does SO_REUSERPORT have a simplified effect?</p>\n\n<p>What dose \"task of conducting stateful conversations between the client and server\" mean?Please give some specific examples,thanks.</p>\n"}, {"tags": ["c", "pointers", "realloc"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 2, "creation_date": 1554293624, "post_id": 55494899, "comment_id": 97696866, "body": "You understand the concepts: call-by-value and call-by-reference?"}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1554293884, "post_id": 55494899, "comment_id": 97697062, "body": "You modify a <i>local</i> variable, not the caller&#39;s variable. So the caller cannot see the change. Lookup  call-by-value and call-by-reference as Sourav Gosh suggests."}, {"owner": {"reputation": 23, "user_id": 11156037, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DcL8aDODbwA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdwmVbG2V_XS3ZFfV63mFv2T-9zQQ/mo/photo.jpg?sz=128", "display_name": "BlindRob", "link": "https://stackoverflow.com/users/11156037/blindrob"}, "edited": false, "score": 0, "creation_date": 1554294002, "post_id": 55494899, "comment_id": 97697140, "body": "call-by-reference means for me if after the function the var is still in the changed state"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1554294043, "post_id": 55494899, "comment_id": 97697171, "body": "<i>call-by-reference means for me if after the function the var is still in the changed state</i>  And how does C pass variables..."}, {"owner": {"reputation": 23, "user_id": 11156037, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DcL8aDODbwA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdwmVbG2V_XS3ZFfV63mFv2T-9zQQ/mo/photo.jpg?sz=128", "display_name": "BlindRob", "link": "https://stackoverflow.com/users/11156037/blindrob"}, "edited": false, "score": 0, "creation_date": 1554294386, "post_id": 55494899, "comment_id": 97697389, "body": "generally always by value and if you use a pointer its by reference! :-)"}], "answers": [{"comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1554296742, "post_id": 55494978, "comment_id": 97698911, "body": "That looks good to me."}], "tags": [], "owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "is_accepted": true, "score": 1, "last_activity_date": 1554294046, "last_edit_date": 1554294046, "creation_date": 1554293786, "answer_id": 55494978, "question_id": 55494899, "link": "https://stackoverflow.com/questions/55494899/function-can-not-allocate-memory-for-a-pointer-in-c/55494978#55494978", "title": "Function can not allocate memory for a pointer in C", "body": "<p><code>visitorPtr</code> is passed as value to <code>getMoreSpace</code> function. Thus any changes done to <code>ptr</code> within the function will not update the <code>vistorPtr</code> in main.</p>\n\n<p>What you need is call the function by reference as below.</p>\n\n<pre><code>void getMoreSpace(void **ptr, unsigned int counter)\n{\n    counter++;\n    *ptr = realloc(*ptr, counter * sizeof(visitor));\n\n    if (*ptr == NULL)\n    {\n        printf(\"\\n Error allocating memory! \\n\");\n    }\n}\n</code></pre>\n\n<p>And from <code>main</code> you call as below.</p>\n\n<pre><code>getMoreSpace(&amp;visitorPtr, visitorCounter);\nif (visitorPtr)\n   ...do stuff....\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 11156037, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DcL8aDODbwA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdwmVbG2V_XS3ZFfV63mFv2T-9zQQ/mo/photo.jpg?sz=128", "display_name": "BlindRob", "link": "https://stackoverflow.com/users/11156037/blindrob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "closed_date": 1554293892, "accepted_answer_id": 55494978, "answer_count": 1, "score": -2, "last_activity_date": 1554294046, "creation_date": 1554293560, "question_id": 55494899, "link": "https://stackoverflow.com/questions/55494899/function-can-not-allocate-memory-for-a-pointer-in-c", "closed_reason": "Duplicate", "title": "Function can not allocate memory for a pointer in C", "body": "<p>I have a struct which is called \"visitor\" and I want to write function which allocates the memory for my pointer to this struct ... </p>\n\n<p>this Codes works:</p>\n\n<pre><code>visitor *visitorPtr = NULL;\nint visitorCounter = 0;\nvisitorPtr = realloc(visitorPtr, ((visitorCounter++) * sizeof(visitor)));\n</code></pre>\n\n<p>but now I wanted to put this functionality to a function</p>\n\n<pre><code>void getMoreSpace(void *ptr, unsigned int counter)\n{\n    counter++;\n    ptr = realloc(ptr, counter * sizeof(visitor));\n\n    if (ptr == NULL)\n    {\n        printf(\"\\n Error allocating memory! \\n\");\n        return EXIT_FAILURE;\n    }\n}\n\n//Call in MAIN:\ngetMoreSpace(visitorPtr, visitorCounter);\n</code></pre>\n\n<p>Unfortunately it seems not to work because I cant create data for this pointer and get this Error when I make that for that struct:\nException thrown at 0x0FDAE559 (ucrtbased.dll) in My-C-Project.exe: 0xC0000005: Access violation writing location 0x00000000.</p>\n"}, {"tags": ["c", "linux", "embedded", "qemu"], "comments": [{"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1554313230, "post_id": 55494551, "comment_id": 97708793, "body": "Please show the code and/or state the errors. Please don&#39;t use links to images. The text is missing from the question. The text on the picture is too small for some people to read. The text on the image cannot be indexed by search engines for future visitors. Also see <a href=\"https://meta.stackoverflow.com/q/285551/608639\">Why not upload images of code on SO when asking a question?</a>"}, {"owner": {"reputation": 741, "user_id": 10376824, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-QJhJZUD1UCw/AAAAAAAAAAI/AAAAAAAADbA/_BZuute3iuE/photo.jpg?sz=128", "display_name": "Chandrika Joshi", "link": "https://stackoverflow.com/users/10376824/chandrika-joshi"}, "reply_to_user": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1554373791, "post_id": 55494551, "comment_id": 97732051, "body": "I have actually added the image not a link , I dont know why it is showing error.  I will update. Thanks for pointing it out."}], "answers": [{"comments": [{"owner": {"reputation": 741, "user_id": 10376824, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-QJhJZUD1UCw/AAAAAAAAAAI/AAAAAAAADbA/_BZuute3iuE/photo.jpg?sz=128", "display_name": "Chandrika Joshi", "link": "https://stackoverflow.com/users/10376824/chandrika-joshi"}, "edited": false, "score": 0, "creation_date": 1554377457, "post_id": 55514467, "comment_id": 97734321, "body": "Both obj-y and obj-$(CONFIG_ARM_V7M) += armv7m.o stm32f407ve_scu.o worked thank you.  Without adding CONFIG_STM32F407VE_SCU=y  in the .mak file obj-y worked , does that mean it takes any default value? that is CONFIG_ARM_V7M?  And what is the difference between adding CONFIG_ARM_V7M and custom name?"}, {"owner": {"reputation": 827, "user_id": 3507543, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/I6dwv.jpg?s=128&g=1", "display_name": "Guillaume", "link": "https://stackoverflow.com/users/3507543/guillaume"}, "reply_to_user": {"reputation": 741, "user_id": 10376824, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-QJhJZUD1UCw/AAAAAAAAAAI/AAAAAAAADbA/_BZuute3iuE/photo.jpg?sz=128", "display_name": "Chandrika Joshi", "link": "https://stackoverflow.com/users/10376824/chandrika-joshi"}, "edited": false, "score": 1, "creation_date": 1554378896, "post_id": 55514467, "comment_id": 97735303, "body": "Yes, <code>CONFIG_ARM_V7M</code> is enabled by default when you build QEMU with arm-softmmu support."}], "tags": [], "owner": {"reputation": 827, "user_id": 3507543, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/I6dwv.jpg?s=128&g=1", "display_name": "Guillaume", "link": "https://stackoverflow.com/users/3507543/guillaume"}, "is_accepted": true, "score": 1, "last_activity_date": 1554376230, "creation_date": 1554376230, "answer_id": 55514467, "question_id": 55494551, "link": "https://stackoverflow.com/questions/55494551/qemu-is-not-configured-correctly-when-custom-machine-is-added/55514467#55514467", "title": "Qemu is not configured correctly when custom machine is added", "body": "<p>If you're using <code>obj-$(CONFIG_STM32F407VE_SCU) += stm32f407ve_scu.o</code>, you need to enable <code>CONFIG_STM32F407VE_SCU</code> somewhere to build this file. This can be done in the <code>configure</code> file or editing <code>default-configs/arm-softmmu.mak</code> and adding <code>CONFIG_STM32F407VE_SCU=y</code>.</p>\n\n<p>If you only need to build this extra file, you could just edit <code>Makefile.objs</code> like that:</p>\n\n<pre><code>obj-$(CONFIG_ARM_V7M) += armv7m.o stm32f407ve_scu.o\n</code></pre>\n\n<p>As you're using ARMv7m (Cortex M4), your file will be built (<code>CONFIG_ARM_V7M</code> will be equal to <code>y</code>)</p>\n"}], "owner": {"reputation": 741, "user_id": 10376824, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-QJhJZUD1UCw/AAAAAAAAAAI/AAAAAAAADbA/_BZuute3iuE/photo.jpg?sz=128", "display_name": "Chandrika Joshi", "link": "https://stackoverflow.com/users/10376824/chandrika-joshi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 164, "favorite_count": 0, "accepted_answer_id": 55514467, "answer_count": 1, "score": 1, "last_activity_date": 1554376230, "creation_date": 1554292505, "last_edit_date": 1554375233, "question_id": 55494551, "link": "https://stackoverflow.com/questions/55494551/qemu-is-not-configured-correctly-when-custom-machine-is-added", "title": "Qemu is not configured correctly when custom machine is added", "body": "<p>I have been trying to develop a custom machine in <strong>QEMU</strong> : <strong>STM32F407</strong>. I have written initial script to add the machine name to the list of machines supported in QEMU when we do <code>-machine help</code> with  machine description like defining <strong>SRAM</strong>, <strong>cpu-type</strong> etc.  I have added the file in the path <code>~/qemu/hw/arm</code> as <code>stm32f407ve_scu.c</code></p>\n\n<p>I have also added the line <code>obj-$(CONFIG_STM32F407VE_SCU) += stm32f407ve_scu.o</code> in <strong>makefile.objs</strong> file.</p>\n\n<p>The .c file has the below code :</p>\n\n<pre><code>struct stm32f407ve_scu {\n    DeviceState *soc;\n    struct arm_boot_info boot_info;\n\n};\n\nstatic void stm32f407ve_scu_init(MachineState *machine) { //create a space for the machine kernel\n    struct stm32f407ve_scu *s =g_new0(struct stm32f407ve_scu, 1);\n\n    if (!machine-&gt;kernel_filename){\n        fprintf(stderr,\" Guest image is missing (use -kernel)\\n\");\n        exit(1);\n    }\n\n    s-&gt;soc = qdev_create(NULL, \"stm32f407-soc\");\n    qdev_prop_set_string (s-&gt;soc, \"cpu-type\", ARM_CPU_TYPE_NAME(\"cortex-m4\")); // assign cortex-m4 as the processor\n    object_property_set_bool(OBJECT(s-&gt;soc), true, \"realized\", &amp;error_fatal);\n\n    MemoryRegion *sram =g_new(MemoryRegion,1); //creates new memory region\n    memory_region_init_ram(sram, NULL, \"scu.sram\", 1024 * 1024 * 128, &amp;error_fatal); // ram area defined with size\n    vmstate_register_ram_global(sram);\n\n    //loads kernel of maximum size 2MB\n    armv7m_load_kernel(ARM_CPU(first_cpu), machine-&gt;kernel_filename, 2 * 1024 * 1024);      \n\n}\nstatic void stm32f407ve_scu_machine_init(MachineClass *mc) //defines the machine init struct and description\n{\n    mc-&gt;desc = \"STM32F407 board with RAM\";\n    mc-&gt;init = stm32f407ve_scu_init;\n}\nDEFINE_MACHINE(\"stm32f407ve_scu\", stm32f407ve_scu_machine_init) //machine is defined with initialization clas\n</code></pre>\n\n<p>When I try to configure and make <strong>QEMU</strong> , I get no error but the <code>stm32f407ve_scu.o</code> and <code>stm32f407ve_scu.d</code> are not generated.</p>\n\n<p>Why are the .o and .d files are not being generated? But when I see other .c files, they have been generated into .o and .c . </p>\n\n<p>What am I missing here? I added all the header files as like other files and used the same syntax to write my machine description.</p>\n"}, {"tags": ["c", "variables"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 2, "creation_date": 1554292402, "post_id": 55494484, "comment_id": 97696079, "body": "Define &quot;Can&#39;t use&quot;"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1554292415, "post_id": 55494484, "comment_id": 97696091, "body": "When you call your function <code>regmember</code>, you do save the result it returns in some variable? As in <code>int var = regmember(argument);</code>? Then you can just pass the variable (<code>var</code> in my example) to the other functions that need it."}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 1, "creation_date": 1554292576, "post_id": 55494484, "comment_id": 97696184, "body": "you do not return the variable, you return its value"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1554292580, "post_id": 55494484, "comment_id": 97696186, "body": "Where did you declare <code>wow</code>?"}, {"owner": {"reputation": 19, "user_id": 11057650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/94qCI.jpg?s=128&g=1", "display_name": "Lester Crest", "link": "https://stackoverflow.com/users/11057650/lester-crest"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1554292615, "post_id": 55494484, "comment_id": 97696208, "body": "@Someprogrammerdude The calling of the function regmember occurs in another &quot;menu&quot; function with a switch command. The user is prompted to choose a certain operation and then the switch command calls regmember. The calling of the function for the menu located in int main, alongside with the creation and opening of a file + fclose and the end. I hope this give a little but more understanding."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1554292669, "post_id": 55494484, "comment_id": 97696247, "body": "It sounds that you need to start reading your C text book, I suppose there are some fundamental concepts, not even specific to the C language, you didn&#39;t understand"}, {"owner": {"reputation": 19, "user_id": 11057650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/94qCI.jpg?s=128&g=1", "display_name": "Lester Crest", "link": "https://stackoverflow.com/users/11057650/lester-crest"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1554292741, "post_id": 55494484, "comment_id": 97696279, "body": "@Jabberwocky, sorry, forget to add the declarations, see edited version."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1554292882, "post_id": 55494484, "comment_id": 97696372, "body": "For better understanding, please edit your question to include a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1554292992, "post_id": 55494484, "comment_id": 97696438, "body": "your variable can be a parameter and its value returned, or it can be an input-output parameter, see my answer"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1554293173, "post_id": 55494484, "comment_id": 97696562, "body": "About the <code>&#47;&#47;registration</code> part: I suppose you stripped some code out of here? Please confirm, because otherwise your function doesn&#39;t make much sense."}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1554293363, "post_id": 55494484, "comment_id": 97696691, "body": "@Jabberwocky visibly it is not the original code, there is no &#39;,&#39; after <code>i++</code> etc ;-)"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1554293405, "post_id": 55494484, "comment_id": 97696717, "body": "Shouldn&#39;t it be <code>int regmember</code> instead of <code>char regmember</code>? But anyway your question is pretty unclear. You need to read this: <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> and you need to provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 11057650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/94qCI.jpg?s=128&g=1", "display_name": "Lester Crest", "link": "https://stackoverflow.com/users/11057650/lester-crest"}, "edited": false, "score": 0, "creation_date": 1554293111, "post_id": 55494624, "comment_id": 97696522, "body": "Want to use and modify I, so tried the first example. But the second function which calls regmember says &quot; i undeclared ( first use in this function)&quot;, Am I supposed to declare int i = 0; in this function as well, if yes, do you mind explaining why?"}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "reply_to_user": {"reputation": 19, "user_id": 11057650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/94qCI.jpg?s=128&g=1", "display_name": "Lester Crest", "link": "https://stackoverflow.com/users/11057650/lester-crest"}, "edited": false, "score": 0, "creation_date": 1554293266, "post_id": 55494624, "comment_id": 97696629, "body": "it is not mandatory to name the variable <i>i</i> both in the caller and <i>regmember</i> I did to simplify. Where do you have ` i undeclared` ? In my code I define it on both sides. Did you forget to add it in parameter ?"}, {"owner": {"reputation": 19, "user_id": 11057650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/94qCI.jpg?s=128&g=1", "display_name": "Lester Crest", "link": "https://stackoverflow.com/users/11057650/lester-crest"}, "edited": false, "score": 0, "creation_date": 1554293393, "post_id": 55494624, "comment_id": 97696707, "body": "Ahaa I see now, thanks for the explanation. I have the error in the function that calls for regmember();. regmember looks like this in that function -- regmember(a, i);"}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "reply_to_user": {"reputation": 19, "user_id": 11057650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/94qCI.jpg?s=128&g=1", "display_name": "Lester Crest", "link": "https://stackoverflow.com/users/11057650/lester-crest"}, "edited": false, "score": 0, "creation_date": 1554293528, "post_id": 55494624, "comment_id": 97696788, "body": "@LesterCrest of course you need also to define the var on the caller side, and don&#39;t forget to initialize it to 0  on the caller side."}, {"owner": {"reputation": 19, "user_id": 11057650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/94qCI.jpg?s=128&g=1", "display_name": "Lester Crest", "link": "https://stackoverflow.com/users/11057650/lester-crest"}, "edited": false, "score": 1, "creation_date": 1554293730, "post_id": 55494624, "comment_id": 97696940, "body": "oh, almost forgot. Thanks so much @bruno"}], "tags": [], "owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "is_accepted": true, "score": 0, "last_activity_date": 1554292736, "creation_date": 1554292736, "answer_id": 55494624, "question_id": 55494484, "link": "https://stackoverflow.com/questions/55494484/how-do-i-use-the-value-of-a-variable-in-a-function-else-where/55494624#55494624", "title": "How do I use the value of a variable in a function else where?", "body": "<p>you need both to get <em>i</em> in parameter and to return the new value, you can do</p>\n\n<pre><code>int regmember (struct member a[], int i)\n{\n    ... use and modify i\n\n    return i;\n}\n</code></pre>\n\n<p>or using it as an input-output variable</p>\n\n<pre><code>void regmember (struct member a[], int * i)\n{\n    ... use and modify *i\n}\n</code></pre>\n\n<p>In the first case the caller do for instance :</p>\n\n<pre><code>int i = 0;\n\nfor (...) {\n  ...\n  i = regmember(..., i);\n  ...\n}\n</code></pre>\n\n<p>and in the second case :</p>\n\n<pre><code>int i = 0;\n\nfor (...) {\n  ...\n  regmember(..., &amp;i);\n  ...\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "is_accepted": false, "score": 0, "last_activity_date": 1554293120, "creation_date": 1554293120, "answer_id": 55494743, "question_id": 55494484, "link": "https://stackoverflow.com/questions/55494484/how-do-i-use-the-value-of-a-variable-in-a-function-else-where/55494743#55494743", "title": "How do I use the value of a variable in a function else where?", "body": "<p>Suppose you keep the members in a global array, then you can manage how many members are in your array also as a global variable, for example</p>\n\n<pre><code>struct member gMembers[MAX_MEMBERS];\nint gnMembers;\n</code></pre>\n\n<p>Your function can now operate on this array directly:</p>\n\n<pre><code>int regmember (void)\n{\n    if (gnMembers &lt; MAX_MEMBERS)\n    {\n        // add member\n        if (scanf(\"%s\",gMembers[gnMembers].name)==1\n        &amp;&amp;  scanf(\"%d\",&amp;gMembers[gnMembers].ID)==1) {\n            gnMembers++;\n            return 1; // success\n        }\n    }\n    return 0; // array full or scanf error\n}\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 11057650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/94qCI.jpg?s=128&g=1", "display_name": "Lester Crest", "link": "https://stackoverflow.com/users/11057650/lester-crest"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 55494624, "answer_count": 2, "score": -1, "last_activity_date": 1554293120, "creation_date": 1554292287, "last_edit_date": 1554292688, "question_id": 55494484, "link": "https://stackoverflow.com/questions/55494484/how-do-i-use-the-value-of-a-variable-in-a-function-else-where", "title": "How do I use the value of a variable in a function else where?", "body": "<p>I have a certain program that lets you register members and save their name and birthdate into arrays. The particular function that does this registration uses the following code;</p>\n\n<pre><code>char regmember (struct member a[])\n{\n\n    int i = 0;\n    char wow;\n    do\n    {\n        //registration\n        printf(\"\\n Do you want to add someone else (y/n):\");\n        scanf(\" %c\",&amp;wow);\n        i++\n    }while(wow != 'n');\n\n    int nrofmembers = i;\n    return nrofmembers;\n}\n</code></pre>\n\n<p>-> I save the user input by using</p>\n\n<p><code>scanf(\"%s\",a[i].name)</code> and <code>scanf(\"%d\",&amp;a[i].ID);</code></p>\n\n<p>which is why I am using <code>i++</code>. As you realize, the int variable <code>i</code>, will hold the number of members who have been registered. I want to utilize this info in order to use it in loops in other functions, so I went on to save the value of <code>i</code> in another int variable...</p>\n\n<pre><code>int nrofmembers = i;\n</code></pre>\n\n<hr>\n\n<p>My problem is, I can't use that variable (<code>nrofmembers</code>) else where, even though I tried returning it, any advice?</p>\n"}, {"tags": ["c", "bit-manipulation", "bit-shift"], "comments": [{"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 1, "creation_date": 1554290732, "post_id": 55493979, "comment_id": 97695032, "body": "<code>highest bit</code> - the bits are most significant and least significant, see <a href=\"https://en.wikipedia.org/wiki/Bit_numbering#Most_significant_bit\" rel=\"nofollow noreferrer\">wiki</a>. All bits have the same &quot;height&quot;."}, {"owner": {"reputation": 24693, "user_id": 10190237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f95f50f67af8a9658c5d76df263b323?s=128&d=identicon&r=PG&f=1", "display_name": "P.W", "link": "https://stackoverflow.com/users/10190237/p-w"}, "edited": false, "score": 0, "creation_date": 1554291065, "post_id": 55493979, "comment_id": 97695247, "body": "@JL2210: You want the MSB or most significant <b>set</b> bit"}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 1, "creation_date": 1554291127, "post_id": 55493979, "comment_id": 97695287, "body": "No, I want the most significant bit, whether it&#39;s a 1 or a 0. Getting the most significant set bit would be pointless."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1554291294, "post_id": 55493979, "comment_id": 97695401, "body": "A byte has 8 bits. The MSB is bit 7. Thus if you right shift it 7 times, it will end up at bit 0."}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 0, "creation_date": 1554291387, "post_id": 55493979, "comment_id": 97695449, "body": "Is bit 0 the &quot;signed&quot; bit? I&#39;m trying to figure out signed integer emulation (for my Z80 emulator) right now."}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1554291698, "post_id": 55493979, "comment_id": 97695627, "body": "There is no &quot;signed&quot; bit in a <code>uint8_t</code> variable, the variable is unsigned. The &quot;signed&quot; bit inside a signed variable that uses <a href=\"https://en.wikipedia.org/wiki/Two%27s_complement\" rel=\"nofollow noreferrer\">twos-complementary</a> format is the MSB, because the negative numbers have the MSB set."}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 0, "creation_date": 1554293529, "post_id": 55493979, "comment_id": 97696789, "body": "Which is why I asked."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 2, "creation_date": 1554293698, "post_id": 55493979, "comment_id": 97696918, "body": "Why did you write <code>6</code> (in <code>*var &gt;&gt;6</code>) in first place??"}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 0, "creation_date": 1554294828, "post_id": 55493979, "comment_id": 97697646, "body": "I thought shifting it 7 bits would shift past the bounds of <code>uint8_t</code>."}], "answers": [{"tags": [], "owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "is_accepted": true, "score": 6, "last_activity_date": 1554290779, "creation_date": 1554290779, "answer_id": 55494041, "question_id": 55493979, "link": "https://stackoverflow.com/questions/55493979/how-to-get-the-most-significant-bit-of-an-unsigned-8-bit-type-in-c/55494041#55494041", "title": "How to get the most significant bit of an unsigned 8-bit type in C", "body": "<p>To get the most significant bit from a memory pointed to by <code>uint8_t</code> pointer, you need to shift by 7 bits.</p>\n\n<pre><code>(*var &gt;&gt; 7) &amp; 1\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "is_accepted": false, "score": 2, "last_activity_date": 1554292003, "last_edit_date": 1554292003, "creation_date": 1554291198, "answer_id": 55494162, "question_id": 55493979, "link": "https://stackoverflow.com/questions/55493979/how-to-get-the-most-significant-bit-of-an-unsigned-8-bit-type-in-c/55494162#55494162", "title": "How to get the most significant bit of an unsigned 8-bit type in C", "body": "<p>Another option is to simply apply a bit mask and check the resulting value:</p>\n\n<pre><code>*var &amp; 0x80u // 1000 0000\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 6, "last_activity_date": 1554291657, "creation_date": 1554291657, "answer_id": 55494309, "question_id": 55493979, "link": "https://stackoverflow.com/questions/55493979/how-to-get-the-most-significant-bit-of-an-unsigned-8-bit-type-in-c/55494309#55494309", "title": "How to get the most significant bit of an unsigned 8-bit type in C", "body": "<p>The most standard/correct way of masking bits is to use a readable bit mask of the form <code>1u &lt;&lt; bit</code>. Any C programmer spotting <code>1u &lt;&lt; n</code> in code will know that it is a bit mask - so it is self-documenting code.</p>\n\n<p>So if you want bit number 7, you would write</p>\n\n<pre><code>*var &amp; (1u &lt;&lt; 7)\n</code></pre>\n\n<p>The <code>u</code> suffix is important for rugged code, since you want to avoid accidental implicit promotions to signed types.</p>\n"}], "owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 326, "favorite_count": 0, "accepted_answer_id": 55494041, "answer_count": 3, "score": -1, "last_activity_date": 1554292003, "creation_date": 1554290582, "last_edit_date": 1554291000, "question_id": 55493979, "link": "https://stackoverflow.com/questions/55493979/how-to-get-the-most-significant-bit-of-an-unsigned-8-bit-type-in-c", "title": "How to get the most significant bit of an unsigned 8-bit type in C", "body": "<p>I'm trying to get the most significant bit of an unsigned 8-bit type in C.</p>\n\n<p>This is what I'm trying to do right now:</p>\n\n<pre><code>uint8_t *var = ...;\n...\n(*var &gt;&gt; 6) &amp; 1\n</code></pre>\n\n<p>Is this right? If it's not, what would be?</p>\n"}, {"tags": ["c", "optimization", "language-lawyer", "volatile"], "comments": [{"owner": {"reputation": 188064, "user_id": 635608, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIJia.png?s=128&g=1", "display_name": "Mat", "link": "https://stackoverflow.com/users/635608/mat"}, "edited": false, "score": 2, "creation_date": 1554290822, "post_id": 55493929, "comment_id": 97695093, "body": "You <i>are</i> using the fetched value."}, {"owner": {"reputation": 3510, "user_id": 2162550, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f74689baa9af8a44163fa395c457212f?s=128&d=identicon&r=PG", "display_name": "user2162550", "link": "https://stackoverflow.com/users/2162550/user2162550"}, "reply_to_user": {"reputation": 188064, "user_id": 635608, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIJia.png?s=128&g=1", "display_name": "Mat", "link": "https://stackoverflow.com/users/635608/mat"}, "edited": false, "score": 0, "creation_date": 1554290991, "post_id": 55493929, "comment_id": 97695197, "body": "@Mat I&#39;ve edited the question"}, {"owner": {"reputation": 26552, "user_id": 448932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QgLLl.png?s=128&g=1", "display_name": "500 - Internal Server Error", "link": "https://stackoverflow.com/users/448932/500-internal-server-error"}, "edited": false, "score": 2, "creation_date": 1554291070, "post_id": 55493929, "comment_id": 97695252, "body": "The body of the <code>while</code> loop is empty, but the loop as a whole is not."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 1, "creation_date": 1554292292, "post_id": 55493929, "comment_id": 97696008, "body": "Observable behavior cannot be optimized out, and access to objects of volatile-qualified types is part of the observable behavior (although what constitutes access to an object of volatile-qualified type is implementation defined)."}], "answers": [{"comments": [{"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1554291614, "post_id": 55494115, "comment_id": 97695579, "body": "AFAIK, the C standard has nothing to say about caching for volatile objects."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 1, "creation_date": 1554291986, "post_id": 55494115, "comment_id": 97695820, "body": "@IanAbbott Obviously it says nothing about memories or hardware at all, but if the CPU would cache volatile objects, everything would break. The C standard just says &quot;Accesses to volatile objects are evaluated strictly according to the rules of the abstract machine&quot; which can be interpreted as no re-ordering of any kind allowed. Pre-fetch caching is a form of re-ordering, where values are read in advance. It is then arguably the compiler&#39;s job to ensure this doesn&#39;t happen. Or if it is beyond the compiler to do that, the hardware might not be suitable for running C programs."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1554293833, "post_id": 55494115, "comment_id": 97697021, "body": "Presumably, my PC with its GCC C compiler is unsuitable for running C programs."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1554296197, "post_id": 55494115, "comment_id": 97698567, "body": "@IanAbbott If it performs caching of volatile-qualified variables, then indeed. The problem here is to make the C committee/gcc people/PC programmers understand how important volatile is in hardware-related programming. If I point at a memory-mapped I/O register, it can&#39;t run off to store that register value in cache."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 1, "creation_date": 1554299203, "post_id": 55494115, "comment_id": 97700507, "body": "Memory-mapped I/O registers are generally mapped to non-cached regions, but that has nothing to do with the compiler. More relevant is the use of volatile-qualified objects in multi-processor systems. A PC has cache coherency between the processors, so writes to cacheable memory by one processor will eventually be seen when read by the other processors, although they will not necessarily be seen in the same order as they are written unless the compiler gives &quot;acquire semantics&quot; to volatile reads. (I understand that Microsoft C compilers do that by default except on ARM processors.)"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1554299628, "post_id": 55494115, "comment_id": 97700766, "body": "@IanAbbott Compiler vendors try to put the burden of using memory barriers on the programmers. But if you read the standard strictly, then volatile access must act as a memory barrier, since &quot;In the abstract machine, all expressions are evaluated as specified by the semantics&quot;. The C standard concept of sequenced before/after applies to all manner of multi-processing."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1554302612, "post_id": 55494115, "comment_id": 97702759, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/191170/discussion-between-ian-abbott-and-lundin\">continue this discussion in chat</a>."}, {"owner": {"reputation": 3510, "user_id": 2162550, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f74689baa9af8a44163fa395c457212f?s=128&d=identicon&r=PG", "display_name": "user2162550", "link": "https://stackoverflow.com/users/2162550/user2162550"}, "edited": false, "score": 0, "creation_date": 1554395519, "post_id": 55494115, "comment_id": 97746230, "body": "is it true to say that the bold text in section 4 is not abstract machine rule (as it is talking about optimization) therefore have nothing to do with the requirement that volatiles should be evaluated strictly according to abstract machine rules?"}, {"owner": {"reputation": 3510, "user_id": 2162550, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f74689baa9af8a44163fa395c457212f?s=128&d=identicon&r=PG", "display_name": "user2162550", "link": "https://stackoverflow.com/users/2162550/user2162550"}, "edited": false, "score": 0, "creation_date": 1554395822, "post_id": 55494115, "comment_id": 97746387, "body": "also, so what is the possible volatile optimization the standard says is allowed in the bold text in section 4 then?"}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": true, "score": 3, "last_activity_date": 1554291069, "creation_date": 1554291069, "answer_id": 55494115, "question_id": 55493929, "link": "https://stackoverflow.com/questions/55493929/can-this-volatile-access-be-optimized-out/55494115#55494115", "title": "Can this volatile access be optimized out?", "body": "<blockquote>\n  <p>So if I read a volatile (which is a side effect) without using the value I read, this access is actually not needed and can be optimized out.</p>\n</blockquote>\n\n<p>No. The text says <em>\"its value is not used <strong>and</strong> that no needed side effects are produced\"</em>. It does not say \"<strong>or</strong>\". Regardless if you are using the value, there is a side effect present - an access to a volatile variable.</p>\n\n<blockquote>\n  <p>So the read access (without further using the fetched value) can be optimized out.</p>\n</blockquote>\n\n<p>No.</p>\n\n<blockquote>\n  <p>Now, can this while loop be optimized out?</p>\n</blockquote>\n\n<p>No. The data pointed at is volatile-qualified. At each lap in the loop it must read <code>*timer_reg</code> directly from memory. It may not optimize away the read. It may not re-order it. It may not cache it/pre-fetch it.</p>\n"}], "owner": {"reputation": 3510, "user_id": 2162550, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f74689baa9af8a44163fa395c457212f?s=128&d=identicon&r=PG", "display_name": "user2162550", "link": "https://stackoverflow.com/users/2162550/user2162550"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "accepted_answer_id": 55494115, "answer_count": 1, "score": 0, "last_activity_date": 1554291069, "creation_date": 1554290394, "last_edit_date": 1592644375, "question_id": 55493929, "link": "https://stackoverflow.com/questions/55493929/can-this-volatile-access-be-optimized-out", "title": "Can this volatile access be optimized out?", "body": "<p>From <em>ISO/IEC 9899:201x</em> section <em>5.1.2.3 Program execution:</em></p>\n<blockquote>\n<p>2 <strong>Accessing a volatile object</strong>, modifying an object, modifying a file,\nor calling a function that does any of those operations <strong>are</strong> all <strong>side\neffects</strong>, which are changes in the state of the execution\nenvironment. Evaluation of an expression in general includes both\nvalue computations and initiation of side effects. Value computation\nfor an lvalue expression includes determining the identity of the\ndesignated object.</p>\n</blockquote>\n<p>So, accessing (read\\write) a volatile is called a side effect.\nLets continue:</p>\n<blockquote>\n<p>4 In the abstract machine, all expressions are evaluated as specified\nby the semantics. <strong>An actual implementation need not evaluate part of\nan expression if it can deduce that its value is not used and that no\nneeded side effects are produced (including any caused by calling a\nfunction or accessing a volatile object)</strong>.</p>\n</blockquote>\n<p>So if I read a volatile (which is a side effect) but doing nothing with the fetched value I read, this access is actually not needed and can be optimized out.</p>\n<p>OK, also:</p>\n<blockquote>\n<p>6 The least requirements on a conforming implementation are:</p>\n<ul>\n<li><p><strong>Accesses to volatile objects are evaluated strictly according to the\nrules of the abstract machine</strong>.</p>\n</li>\n<li><p>At program termination, all data\nwritten into files shall be identical to the result that execution of\nthe program according to the abstract semantics would have produced.</p>\n</li>\n<li><p>The input and output dynamics of interactive devices shall take place\nas specified in 7.21.3. The intent of these requirements is that\nunbuffered or line-buffered output appear as soon as possible, to\nensure that prompting messages actually appear prior to a program\nwaiting for input. This is the observable behavior of the program.</p>\n</li>\n</ul>\n</blockquote>\n<p>So, to my understanding, section <em>4</em> is a rule of the abstract machine, and section <em>6</em> says that volatiles needs to be evaluated strictly according to the abstract machine rules (which section <em>4</em> is). So the read access (without further using the fetched value) can be optimized out.</p>\n<p>So, take a look at this code:</p>\n<pre><code>volatile int *timer_reg = REGISTER_ADDRESS_CONST;\nwhile (*timer_reg  == 0) {/*empty loop*/}\n</code></pre>\n<p>This code, blocks the execution until the HW raises a bit at the address pointed by <code>timer_reg</code>. This register acts as a kind of timer which was configured to raise a bit after certain time period elapsed. When the timer elapses the busy wait ends and execution continues.</p>\n<p>Now, can this <code>while</code> loop be optimized out? I have tried this with many compilers online with different optimization levels, and it seems that it does not.\nIs there something I'm missing here? to my understanding, standard says explicitly it can be optimized.</p>\n<p><strong>EDIT:</strong> My point is that because of the fact that the while loop is empty, maybe the compiler can consider the fetched volatile value as unneeded .</p>\n"}, {"tags": ["c", "class", "c-preprocessor"], "comments": [{"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 3, "creation_date": 1554290911, "post_id": 55493869, "comment_id": 97695139, "body": "Sorry if this sounds blunt, but trying to invent OO features on top of C has been done numerious times before, and it has never been pretty. You can do basic OO with C, but anything more complex like inheritance and polymorphism simple won&#39;t ever be practical to use. If you need advanced OO features, you should consider using language that has already solved most those problems."}, {"owner": {"reputation": 9, "user_id": 11305094, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/310ac7c89a4c4354acf4fd36c1a45a69?s=128&d=identicon&r=PG&f=1", "display_name": "diingus", "link": "https://stackoverflow.com/users/11305094/diingus"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1554291683, "post_id": 55493869, "comment_id": 97695617, "body": "@Someprogrammerdude single <code>_</code> are OK, double ones are reserved for implementation"}, {"owner": {"reputation": 1928, "user_id": 10734452, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ps1ig8rG6G8/AAAAAAAAAAI/AAAAAAAAAS8/yVuRLo3SyCM/photo.jpg?sz=128", "display_name": "Guillaume D", "link": "https://stackoverflow.com/users/10734452/guillaume-d"}, "edited": false, "score": 0, "creation_date": 1554293703, "post_id": 55493869, "comment_id": 97696926, "body": "if you want to use polymorphism you can look at <a href=\"https://stackoverflow.com/questions/524033/how-can-i-simulate-oo-style-polymorphism-in-c\">this answer</a> see also <a href=\"https://stackoverflow.com/questions/351733/can-you-write-object-oriented-code-in-c\">Can you write OO in C</a> and <a href=\"https://stackoverflow.com/questions/415452/object-orientation-in-c\">Oriented Object in C</a>"}, {"owner": {"reputation": 804, "user_id": 1971526, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/df133c7bcd9876ba2fb29f7c89487ab2?s=128&d=identicon&r=PG&f=1", "display_name": "Josu Go&#241;i", "link": "https://stackoverflow.com/users/1971526/josu-go%c3%b1i"}, "edited": false, "score": 0, "creation_date": 1554362441, "post_id": 55493869, "comment_id": 97725225, "body": "In order to polish the user experience you may just use C++ :P Jokes aside, you might be interested in the gcc <code>__attribute__((packed))</code> since it is safer than your <code>#pragma pack</code>, which could be ignored by the compiler. You might also check this related <a href=\"https://stackoverflow.com/questions/28968515/is-it-safe-to-cast-a-c-struct-to-another-with-less-elements\">question</a>."}], "owner": {"reputation": 9, "user_id": 11305094, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/310ac7c89a4c4354acf4fd36c1a45a69?s=128&d=identicon&r=PG&f=1", "display_name": "diingus", "link": "https://stackoverflow.com/users/11305094/diingus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1554362012, "creation_date": 1554290180, "last_edit_date": 1554362012, "question_id": 55493869, "link": "https://stackoverflow.com/questions/55493869/modding-classes-and-inheritance-into-c", "title": "Modding classes and inheritance into C", "body": "<p>I've recently took it upon myself to implement classes (polymorphism and all) into C. That is -- implement a data structure that has its own methods, can inherit other such structures and (because of its inheritance) can be type targeted as one of its ancestors.</p>\n\n<p>As you might've guessed, I'm using <code>structs</code> as <code>classes</code>. I'm using function pointers to emulate methods, though they still require manually passing <code>this</code> to them. In order to emulate inheritance, I've decided to <code>#pragma pack(8)</code> all my classes and then copy-paste the inherited class' fields into the child class:</p>\n\n<pre><code>#define _Entity_Content int id;\\\n                        char *name;\n#define inherits(x) _ ## x ## _Content\n</code></pre>\n\n<p>Let <code>Y</code> inherit <code>X</code>. When passing <code>this</code> to a method of <code>X</code>, from <code>Y</code>, I would pass a pointer to <code>Y</code>. With the <code>#pragma pack(8)</code>, this would work once, as any subsequent inheriting would break the simple <code>&amp;myclass</code> notation. A solution would be to calculate offsets for the beginnings of each class (perhaps with <code>pack(1)</code>).</p>\n\n<p>Another, and more important issue, is that, while all this would be possible, would be inconvinient for the user, as well as just plain ugly (having to <code>#define</code> the contents of each <code>struct</code>, etc.)</p>\n\n<p>This what I have currently:</p>\n\n<pre><code>#define _Person_ char *name;\\\n                 int age;\\\n                 char *(*getName)(struct Person *);\\\n                 void (*incrementAge)(struct Person *);\n#define superclass(identifier) _ ## identifier ## _\n\n#pragma pack(8)\nstruct Person {\n    superclass(Person);\n};\n\n#pragma pack(8)\nstruct Man {\n    superclass(Person);\n    struct Person *family;\n};\n\n// let man be struct Man\nman.incrementAge(&amp;man);\n</code></pre>\n\n<p>And in an ideal world:</p>\n\n<pre><code>#pragma pack(8)\nclass(Person, char *name;\n              int age;\n              etc.\n     );\n\n#pragma pack(8)\nsuperclass(Person)\nclass(Man, struct Person *family;);\n</code></pre>\n\n<p>What are some tricks I can use to further polish the user experience, as this is what the main goal of my project is?</p>\n"}, {"tags": ["c", "cs50", "vigenere"], "comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 1, "creation_date": 1554288099, "post_id": 55493081, "comment_id": 97693425, "body": "Out of bounds access, undefined behavior."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11304856, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-raKN-V9TuL0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reBN18R1zz2V-OEhu5B5hqZLYEKVg/mo/photo.jpg?sz=128", "display_name": "Ilias Timaev", "link": "https://stackoverflow.com/users/11304856/ilias-timaev"}, "edited": false, "score": 0, "creation_date": 1554419815, "post_id": 55493238, "comment_id": 97756460, "body": "Hello! Thank you for the answer, it helped me out alot. I noticed that i could make the code work properly if i replaced <code>if (isupper(k[j]))</code> by <code>if(isupper(k[j % strlen(k)])</code>, but i went with the way you told me to. I wanted to ask about the <i>strlen</i> function. Wouldn&#39;t it be better (memory wise) to declare an integer that holds the <code>strlen(k)</code> value instead of calling it over and over again?"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 3, "user_id": 11304856, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-raKN-V9TuL0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reBN18R1zz2V-OEhu5B5hqZLYEKVg/mo/photo.jpg?sz=128", "display_name": "Ilias Timaev", "link": "https://stackoverflow.com/users/11304856/ilias-timaev"}, "edited": false, "score": 0, "creation_date": 1554422343, "post_id": 55493238, "comment_id": 97757070, "body": "@IliasTimaev: Sure, it is good to evaluate <code>strlen(k)</code> once and cache it for later use. Compilers are good enough these days that they might recognize <code>k</code> is not changed in a loop (and they know what <code>strlen</code> does), so they might do that for you when optimization is enabled. But it is good to put it in the code explicitly."}], "tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": true, "score": 1, "last_activity_date": 1554288522, "last_edit_date": 1554288522, "creation_date": 1554288198, "answer_id": 55493238, "question_id": 55493081, "link": "https://stackoverflow.com/questions/55493081/cs50-vig%c3%a8nere-problem-out-of-bounds-access-undefined-behavior/55493238#55493238", "title": "CS50 Vig&#232;nere problem. Out of bounds access, undefined behavior", "body": "<p>After <code>strlen(k)</code> iterations, <code>isupper(k[j])</code> uses an index beyond the end of <code>k</code>.</p>\n\n<p>You could change:</p>\n\n<pre><code>if (isupper(k[j]))\n{\n ci = 65;\n}\nelse\n{\n ci = 97;\n}\n\nK = k[j % strlen(k)] - ci;\n</code></pre>\n\n<p>to:</p>\n\n<pre><code>K = toupper(k[j % strlen(k)]) - 'A';\n</code></pre>\n\n<p>(Note this relies on a property not guaranteed by the C standard, that the character codes for letters are consecutive and in alphabetical order.)</p>\n"}], "owner": {"reputation": 3, "user_id": 11304856, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-raKN-V9TuL0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reBN18R1zz2V-OEhu5B5hqZLYEKVg/mo/photo.jpg?sz=128", "display_name": "Ilias Timaev", "link": "https://stackoverflow.com/users/11304856/ilias-timaev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 55493238, "answer_count": 1, "score": -1, "last_activity_date": 1555567867, "creation_date": 1554287741, "last_edit_date": 1555567867, "question_id": 55493081, "link": "https://stackoverflow.com/questions/55493081/cs50-vig%c3%a8nere-problem-out-of-bounds-access-undefined-behavior", "title": "CS50 Vig&#232;nere problem. Out of bounds access, undefined behavior", "body": "<p>So the this is the solution i came with for the CS50 Vigen\u00e8re problem; I'm fairly new to programming, like only a few  weeks so i'm sorry in advance for the form of my code.</p>\n\n<p>The problem here is that the output isn't what i expect it to be.</p>\n\n<p>examples:</p>\n\n<p>./vigenere ABC</p>\n\n<p>input: hello</p>\n\n<p>output: hfnLp</p>\n\n<p>./vigenere ABC</p>\n\n<p>input: HELLO</p>\n\n<p>output: HFN,P</p>\n\n<p>./vigenere BACON</p>\n\n<p>input: Meet me at the park at eleven am</p>\n\n<p>output: Neg zF av uf pCx bT gzrwEP OZ</p>\n\n<p>(it's supposed to be \"Negh zf av huf pcfx bt gzrwep oz\")</p>\n\n<p>i'm clueless, because it seems to be working a little bit, but somethings off.</p>\n\n<p>I checked almost every single integer that i'm using, all of them act as i intended them to. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;cs50.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;ctype.h&gt;\n\nint main (int argc, string argv[])\n{\n    string k = argv[1]; //key\n    string p; //plaintext\n    int j = 0; //the counter for key index\n    int ci; // the variable for reaching the right shifting value on both uppercase and lowercase letters\n    int K;//the value of the key index shift\n\n    if (argc != 2)\n    {\n        printf(\"input error\\n\");\n    }\n    else\n    {\n       p = get_string();\n\n       for (int i = 0, n = strlen(p); i &lt; n; i++)\n       {\n           if (isupper(k[j]))\n           {\n            ci = 65;\n           }\n           else\n           {\n            ci = 97;\n           }\n\n           K = k[j % strlen(k)] - ci;\n\n           if (isalpha (p[i]))\n           {\n                printf(\"%c\", p[i] + K);\n                j++;\n           }\n           else\n           {\n            printf(\"%c\", p[i]);\n           }\n       }\n       printf(\"\\n\");\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "linked-list"], "comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1554288553, "post_id": 55493073, "comment_id": 97693691, "body": "Read <a href=\"https://stackoverflow.com/questions/5431941/why-is-while-feoffile-always-wrong\"><b>Why is \u201cwhile (!feof(file))\u201d always wrong?</b></a>"}], "answers": [{"tags": [], "owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "is_accepted": true, "score": 1, "last_activity_date": 1554289743, "last_edit_date": 1554289743, "creation_date": 1554288609, "answer_id": 55493368, "question_id": 55493073, "link": "https://stackoverflow.com/questions/55493073/first-node-reassigned-new-data-is-read-in/55493368#55493368", "title": "First node reassigned new data is read in", "body": "<blockquote>\n  <p>First node reassigned new data is read in</p>\n</blockquote>\n\n<p>you allocate only one <em>Employee</em>, so you rewrite all the time in it, you need a to allocate one for each cell</p>\n\n<pre><code>Employee *pNewStruct = (Employee *)malloc(sizeof(Employee));\n</code></pre>\n\n<p>must be moved in the <em>while</em>, for instance just after</p>\n\n<pre><code>read_string(pFile, \"Name: \", Name, MAX_NAME_LENGTH);\n</code></pre>\n\n<p>You will add the cells at the end of the list to respect the order, for that add a var pointing to the last cell (e.g. <em>pLastCell</em>)</p>\n\n<p>In</p>\n\n<blockquote>\n<pre><code>       if (pFirstNode-&gt;name == NULL) {\n           fprintf(stderr, \"a new node is created\\n\\n\");\n           pNewStruct-&gt;next = NULL;\n           pNewStruct-&gt;prev = NULL;\n           pFirstNode = pNewStruct;\n       }\n</code></pre>\n</blockquote>\n\n<p>add <code>pLastCell = pNewStruct;</code></p>\n\n<p>In</p>\n\n<blockquote>\n<pre><code>        else {\n           fprintf(stderr, \"Else statement run\\n\\n\");\n       }\n</code></pre>\n</blockquote>\n\n<p>you need to link the other cells :</p>\n\n<pre><code>  pLastCell-&gt;next = pNewStruct;\n  pNewStruct-&gt;prev = pLastCell;\n  pLastCell = pNewStruct;\n  pNewStruct-&gt;next = NULL;\n</code></pre>\n\n<hr>\n\n<p>Do not use <em>feof</em>, detect the end of the file in <code>read_string</code>, also manage the case where the file is invalid and some fields are missing</p>\n\n<p>For instance :</p>\n\n<pre><code>while (read_string(pFile, \"Name: \", Name, MAX_NAME_LENGTH))\n</code></pre>\n\n<p>and <code>read_string</code> returns 0 on EOF/error</p>\n\n<p>Remove <code>fprintf(stderr, \"\\nFirst node name %s\\n\\n\", pFirstNode-&gt;name);</code> it has no sense</p>\n"}], "owner": {"reputation": 94, "user_id": 9274393, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcc63c594a4f016ed14b2fa86c388133?s=128&d=identicon&r=PG&f=1", "display_name": "Sam lemonts", "link": "https://stackoverflow.com/users/9274393/sam-lemonts"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 1, "accepted_answer_id": 55493368, "answer_count": 1, "score": 0, "last_activity_date": 1554326743, "creation_date": 1554287714, "last_edit_date": 1554326743, "question_id": 55493073, "link": "https://stackoverflow.com/questions/55493073/first-node-reassigned-new-data-is-read-in", "title": "First node reassigned new data is read in", "body": "<p>I have created a <code>linked list</code>, now I am trying to read data in from a file however every time a new entry is read and assigned to the structure the first node is reassigned and removes the data from the previous entry. I would like to find out why my code is doing this.</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>/* read file containing database of employees */\nstatic void read_employee_database(char *file_name)\n{\n    char Name[MAX_NAME_LENGTH] = \"\\0\";\n    int Age;\n    char Sex;\n    char Job[MAX_JOB_LENGTH] = \"\\0\";\n    char ptr[10];\n    char temp[100];\n    int test = 0, count = 0;\n    /*assigns enough memory*/\n    Employee *pNewStruct = (Employee *)malloc(sizeof(Employee));\n\n\n\n    FILE *pFile;    \n\n    pFile = fopen(file_name, \"r\");\n    while (feof(pFile) == 0) {\n        fprintf(stderr, \"\\nFirst node name %s\\n\\n\", pFirstNode-&gt;name);\n\n\n        read_string(pFile, \"Name: \", Name, MAX_NAME_LENGTH);\n        strcpy(pNewStruct-&gt;name, Name);\n        read_string(pFile, \"Sex: \", temp, 4);\n        Sex = temp[0];\n        pNewStruct-&gt;sex = Sex;\n        read_string(pFile, \"Age: \", temp, 100);\n        Age = atoi(temp);\n        pNewStruct-&gt;age = Age;\n        read_string(pFile, \"Job: \", Job, MAX_JOB_LENGTH);\n        strcpy(pNewStruct-&gt;job, Job);\n\n        fprintf(stderr, \"The name is: %s \\n\", Name);\n        fprintf(stderr, \"The Age is: %i \\n\", Age);\n        fprintf(stderr, \"The Sex is: %c \\n\", Sex);\n        fprintf(stderr, \"The Job is: %s \\n\", Job);\n        fprintf(stderr, \"\\n\");\n\n        fgetc(pFile);\n        /*Test all data for given entry*/\n        test = checkName(&amp;pNewStruct-&gt;name);\n        if (test == 0) {\n            fprintf(stderr, \"Name is issue\");\n            exit(-1);\n        }\n        else if (pNewStruct-&gt;sex != 'M' &amp;&amp; pNewStruct-&gt;sex != 'F') {\n            fprintf(stderr, \"Sex is issue\");\n            exit(-1);\n        }\n        else if (pNewStruct-&gt;age &lt;= 0) {\n            fprintf(stderr, \"Age is issue\");\n            exit(-1);\n        }\n        else if (strlen(pNewStruct-&gt;job) == 0) {\n            fprintf(stderr, \"Job is issue\");\n            exit(-1);\n        }\n        else {\n\n            if (pFirstNode-&gt;name == NULL) {\n                fprintf(stderr, \"a new node is created\\n\\n\");\n                pNewStruct-&gt;next = NULL;\n                pNewStruct-&gt;prev = NULL;\n                pFirstNode = pNewStruct;\n            }\n            else {\n                fprintf(stderr, \"Else statement run\\n\\n\");\n            }\n        }\n    }\n\n    fclose(pFile);\n}\n</code></pre>\n\n<p>At this point in the code I only expect that the first node will be assigned given \"<code>pFirstNode</code>\" is a <code>public variable</code> that is <code>NULL</code>. However the newest entry that is read in automatically is set as <code>pFirstNode</code> even though the <code>if</code> statement condition is not met.</p>\n\n<p>The Actual output:</p>\n\n<pre><code>\nFirst node name (null)\n\nThe name is: Graham, Billy\nThe Age is: 63\nThe Sex is: M\nThe Job is: Evangelist\n\na new node is created\n\n\nFirst node name Graham, Billy\n\nThe name is: Karula, Roger\nThe Age is: 23\nThe Sex is: M\nThe Job is: Engineer\n\nElse statement run\n\n\nFirst node name Karula, Roger\n\nThe name is: Smart, Lisa\nThe Age is: 18\nThe Sex is: F\nThe Job is: Trainee engineer\n\nElse statement run\n\n</code></pre>\n\n<p>I am using Ubuntu if that is important.</p>\n"}, {"tags": ["c", "gcc", "c-preprocessor", "preprocessor-directive"], "answers": [{"comments": [{"owner": {"reputation": 38, "user_id": 5308641, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-MpjZENISvdY/AAAAAAAAAAI/AAAAAAAAAxs/Qky-71eK-hQ/photo.jpg?sz=128", "display_name": "Bobby Dilley", "link": "https://stackoverflow.com/users/5308641/bobby-dilley"}, "edited": false, "score": 0, "creation_date": 1554288624, "post_id": 55493169, "comment_id": 97693728, "body": "Thank you for your answer, what do you mean by &#39;proper sources&#39; in the Makefile?"}, {"owner": {"reputation": 652, "user_id": 11224588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2898ec4197f20a99d75710d96ad85c3?s=128&d=identicon&r=PG&f=1", "display_name": "Diodacus", "link": "https://stackoverflow.com/users/11224588/diodacus"}, "reply_to_user": {"reputation": 38, "user_id": 5308641, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-MpjZENISvdY/AAAAAAAAAAI/AAAAAAAAAxs/Qky-71eK-hQ/photo.jpg?sz=128", "display_name": "Bobby Dilley", "link": "https://stackoverflow.com/users/5308641/bobby-dilley"}, "edited": false, "score": 1, "creation_date": 1554293022, "post_id": 55493169, "comment_id": 97696464, "body": "Well, assuming platform1_source.c includes implementation for specific platform, it should not be included into building process on other platform. E.g. Windows-specific set of functions will never build on Linux and should not be included."}], "tags": [], "owner": {"reputation": 652, "user_id": 11224588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2898ec4197f20a99d75710d96ad85c3?s=128&d=identicon&r=PG&f=1", "display_name": "Diodacus", "link": "https://stackoverflow.com/users/11224588/diodacus"}, "is_accepted": false, "score": 2, "last_activity_date": 1554287975, "creation_date": 1554287975, "answer_id": 55493169, "question_id": 55493062, "link": "https://stackoverflow.com/questions/55493062/how-to-include-remove-c-code-functionality-for-different-purposes-architectures/55493169#55493169", "title": "How to include/remove C code functionality for different purposes/architectures?", "body": "<p>Do it rather opposite way: if <code>platform1_header.h</code> contains functionality in question for the platform, in source file there should be:</p>\n\n<pre><code>#if defined PLATFORM1\n#include \"platform1_header.h\"\n#elif defined PLATFORM2\n#include \"platform2_header.h\"\n#endif\n</code></pre>\n\n<p>And add proper sources into Makefile or any other building script.</p>\n"}, {"comments": [{"owner": {"reputation": 38, "user_id": 5308641, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-MpjZENISvdY/AAAAAAAAAAI/AAAAAAAAAxs/Qky-71eK-hQ/photo.jpg?sz=128", "display_name": "Bobby Dilley", "link": "https://stackoverflow.com/users/5308641/bobby-dilley"}, "edited": false, "score": 0, "creation_date": 1554302653, "post_id": 55493251, "comment_id": 97702799, "body": "Thank you for the answer. This is the approach I&#39;ve gone with, and used the <code>-Dinclude_something_code</code> command line flag to define constants so that code that is included can be changed in the makefile!"}], "tags": [], "owner": {"reputation": 8084, "user_id": 2896626, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4cd83959d7fe39c658d2e49cfecfe4b6?s=128&d=identicon&r=PG&f=1", "display_name": "Paul92", "link": "https://stackoverflow.com/users/2896626/paul92"}, "is_accepted": true, "score": 3, "last_activity_date": 1554288247, "creation_date": 1554288247, "answer_id": 55493251, "question_id": 55493062, "link": "https://stackoverflow.com/questions/55493062/how-to-include-remove-c-code-functionality-for-different-purposes-architectures/55493251#55493251", "title": "How to include/remove C code functionality for different purposes/architectures?", "body": "<p>You seem to have a very good structure in your mind. Indeed, it is rather common practice to use <code>#ifdef</code>s to conditionally remove code at compile time. Just make sure they are robust enough and there isn't some combination of constants that produces an unusable executable.</p>\n\n<p>Keep in mind that the compiler helps a lot, defining for you a bunch of constants so you can use them. <a href=\"https://stackoverflow.com/questions/2421499/listing-c-constants-macros\">This</a> is how you can find what has been defined. And <a href=\"https://gcc.gnu.org/onlinedocs/cpp/Predefined-Macros.html#Predefined-Macros\" rel=\"nofollow noreferrer\">here</a> are the docs. Moreover, each library may introduce some of its own constants. Feel free to use them.</p>\n\n<p>The idea is to automate as much as possible the process. Use the constants defined by libraries to check if they are loaded, constants defined by the compiler to get information about the environment and so on. </p>\n\n<p>Also, too many preprocessor checks can lead to cluttered code. Consider separating, where it makes sense, the code for different conditions.</p>\n\n<p>And finally, think about a build system that would make it easy for the user to select the options he wants and make sure they are well documented.</p>\n"}], "owner": {"reputation": 38, "user_id": 5308641, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-MpjZENISvdY/AAAAAAAAAAI/AAAAAAAAAxs/Qky-71eK-hQ/photo.jpg?sz=128", "display_name": "Bobby Dilley", "link": "https://stackoverflow.com/users/5308641/bobby-dilley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 2, "accepted_answer_id": 55493251, "answer_count": 2, "score": 1, "last_activity_date": 1554288247, "creation_date": 1554287683, "question_id": 55493062, "link": "https://stackoverflow.com/questions/55493062/how-to-include-remove-c-code-functionality-for-different-purposes-architectures", "title": "How to include/remove C code functionality for different purposes/architectures?", "body": "<p>I'm writing a C program, which includes a lot of functionality, some of which will only be required on certain machines by certain people. Some of the functionality requires certain libraries to be installed and without those installed the program will not compile.</p>\n\n<p>What I want is to be able to turn on and off specific bits of functionality, so that it can compile without the extra libraries needed for some bits.</p>\n\n<p>I was wondering if there was an agreed way of doing this in C, and how you might go about it?</p>\n\n<p>My thoughts is that I would use a <code>#define INCLUDE_BOOT_FUNCTIONALITY</code>, and then inside <code>BootFunctionality.c</code> I would use a <code>#ifdef INCLUDE_BOOT_FUNCTIONALITY</code> at the top to only include the code inside it before compilation, if it was defined. I would also then go around to each bit of code where <code>BootFunctionality.c</code> is used, and wrap it in the #ifdef pre-processor command.</p>\n\n<p>Is this an acceptable way of doing things, or is there a better one?</p>\n\n<p>For context, my code is written in a modular form where each module, for example <code>BootFunctionality.c</code> runs in its own thread, and is simply started at the start of the program and calls functions available in the <code>Main.c</code> to talk back. To remove it, all I have to do is remove where it is included in <code>Main.h</code> and remove the line in <code>Main.c</code> which starts that thread.</p>\n"}, {"tags": ["c++", "c", "gdb"], "comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 3, "creation_date": 1554287423, "post_id": 55492810, "comment_id": 97693034, "body": "Install debuginfo for the c library"}, {"owner": {"reputation": 1246, "user_id": 6556709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6389fba1f75367a547c52d9779902b20?s=128&d=identicon&r=PG&f=1", "display_name": "user6556709", "link": "https://stackoverflow.com/users/6556709/user6556709"}, "edited": false, "score": 2, "creation_date": 1554287624, "post_id": 55492810, "comment_id": 97693150, "body": "Depending on your system you need either to link the against debug-library or link against a library with debug symbols."}, {"owner": {"reputation": 29251, "user_id": 72178, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/M3OuM.png?s=128&g=1", "display_name": "ks1322", "link": "https://stackoverflow.com/users/72178/ks1322"}, "edited": false, "score": 0, "creation_date": 1554288685, "post_id": 55492810, "comment_id": 97693770, "body": "What is your OS? Installing libc debug symbols should be enough for what you want."}, {"owner": {"reputation": 31, "user_id": 10203890, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eQjbD.jpg?s=128&g=1", "display_name": "theoreticalboypf94", "link": "https://stackoverflow.com/users/10203890/theoreticalboypf94"}, "edited": false, "score": 0, "creation_date": 1554308080, "post_id": 55492810, "comment_id": 97706272, "body": "I use Linux, Ubuntu."}, {"owner": {"reputation": 7668, "user_id": 2554472, "user_type": "registered", "profile_image": "https://graph.facebook.com/1119155584/picture?type=large", "display_name": "Mark Plotnick", "link": "https://stackoverflow.com/users/2554472/mark-plotnick"}, "edited": false, "score": 0, "creation_date": 1554345112, "post_id": 55492810, "comment_id": 97719619, "body": "Since you&#39;re using Ubuntu, you likely already have debuginfo installed, but not the C library&#39;s source code. See <a href=\"https://stackoverflow.com/questions/48278881/gdb-complaining-about-missing-raise-c/48287761#48287761\" title=\"gdb complaining about missing raise c\">stackoverflow.com/questions/48278881/&hellip;</a> for how to install that."}], "answers": [{"tags": [], "owner": {"reputation": 24693, "user_id": 10190237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f95f50f67af8a9658c5d76df263b323?s=128&d=identicon&r=PG&f=1", "display_name": "P.W", "link": "https://stackoverflow.com/users/10190237/p-w"}, "is_accepted": false, "score": 3, "last_activity_date": 1554287859, "creation_date": 1554287859, "answer_id": 55493130, "question_id": 55492810, "link": "https://stackoverflow.com/questions/55492810/how-to-make-gdb-step-into-operation-in-standard-library-c-c-function/55493130#55493130", "title": "How to make gdb step-into operation in standard library C/C++ function?", "body": "<p>You have to:</p>\n\n<ul>\n<li>Install the debug versions of the standard C and C++ libraries</li>\n<li>Tell the compiler to link against those versions</li>\n</ul>\n\n<p>If you are on Linux and have GCC as your compiler, you can look up <a href=\"https://stackoverflow.com/questions/3162513/how-do-i-tell-gcc-or-ld-to-link-against-debug-versions-of-the-standard-c-and-c\">this post</a> about how to do the second bullet above.</p>\n"}], "owner": {"reputation": 31, "user_id": 10203890, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eQjbD.jpg?s=128&g=1", "display_name": "theoreticalboypf94", "link": "https://stackoverflow.com/users/10203890/theoreticalboypf94"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 251, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1554288291, "creation_date": 1554286901, "last_edit_date": 1554288291, "question_id": 55492810, "link": "https://stackoverflow.com/questions/55492810/how-to-make-gdb-step-into-operation-in-standard-library-c-c-function", "title": "How to make gdb step-into operation in standard library C/C++ function?", "body": "<p>Recently I have faced an interesting problem. When I use gdb for code search, I can move inside any function which I defined, by step-into. But when I try to do it for standard C function (e.g printf() ) I see only binary form of source code.</p>\n\n<p>How can I ask gdb to show human-readable source code? I am very interested in the work of standard functions.Thank you! </p>\n"}, {"tags": ["c", "linux", "linux-kernel", "linux-device-driver", "irq"], "comments": [{"owner": {"reputation": 33092, "user_id": 5801661, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D8ENZ.jpg?s=128&g=1", "display_name": "Margaret Bloom", "link": "https://stackoverflow.com/users/5801661/margaret-bloom"}, "edited": false, "score": 0, "creation_date": 1554287117, "post_id": 55492762, "comment_id": 97692839, "body": "IIRC Each device should have a pointer to a custom structure where you can store additional data. What if you use it to store the information of the IRQ allocated? Then you could allocated it lazily and just once (be careful of multi-threading issues)."}, {"owner": {"reputation": 489, "user_id": 7684979, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/55dee8eaddd0b1bef61d118334acefb9?s=128&d=identicon&r=PG&f=1", "display_name": "xMutzelx", "link": "https://stackoverflow.com/users/7684979/xmutzelx"}, "reply_to_user": {"reputation": 33092, "user_id": 5801661, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D8ENZ.jpg?s=128&g=1", "display_name": "Margaret Bloom", "link": "https://stackoverflow.com/users/5801661/margaret-bloom"}, "edited": false, "score": 0, "creation_date": 1554288649, "post_id": 55492762, "comment_id": 97693742, "body": "@MargaretBloom Mhm, I also though about that because e.g. driver for sja1000 is also using this method. I am not sure if I get something wrong, but the custom structure is created for every &quot;channel&quot; therefor if we up it, it also creates a new interrupt-line, or am I wrong here?"}, {"owner": {"reputation": 33092, "user_id": 5801661, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D8ENZ.jpg?s=128&g=1", "display_name": "Margaret Bloom", "link": "https://stackoverflow.com/users/5801661/margaret-bloom"}, "edited": false, "score": 0, "creation_date": 1554304901, "post_id": 55492762, "comment_id": 97704394, "body": "I believe you can use a global variable for anything that must be scoped module wise. That way you&#39;ll have a single IRQ allocated the first time open is called."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1554307277, "post_id": 55492762, "comment_id": 97705846, "body": "Since it&#39;s a PCI device, you are going to need to call <code>irq_request</code> with the <code>IRQF_SHARED</code> flag. There is no particular reason why you can&#39;t request the same IRQ number for the same PCI device multiple times. Your interrupt handler needs to determine from the context pointer whether its channel is interrupting and return <code>IRQ_NONE</code> if it is not."}, {"owner": {"reputation": 3561, "user_id": 2511795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30c869f55cbcf82a7bc4536d563daa0a?s=128&d=identicon&r=PG", "display_name": "0andriy", "link": "https://stackoverflow.com/users/2511795/0andriy"}, "edited": false, "score": 0, "creation_date": 1554361364, "post_id": 55492762, "comment_id": 97724652, "body": "It depends how many IRQ lines device provides, i.o.w. does it have MSI/MSI-x support? If not, you may not call <i>request_irq()</i> multiple times. I guess you missed the fact that <i>request_irq()</i> does not allocate an interrupt. It\u2019s done by <i>pci_alloc_irq_vectors()</i>."}, {"owner": {"reputation": 3561, "user_id": 2511795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30c869f55cbcf82a7bc4536d563daa0a?s=128&d=identicon&r=PG", "display_name": "0andriy", "link": "https://stackoverflow.com/users/2511795/0andriy"}, "edited": false, "score": 0, "creation_date": 1554361914, "post_id": 55492762, "comment_id": 97724964, "body": "Yeah, and the example of good handling small amount of interrupt lines is thunderbolt driver."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "reply_to_user": {"reputation": 3561, "user_id": 2511795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30c869f55cbcf82a7bc4536d563daa0a?s=128&d=identicon&r=PG", "display_name": "0andriy", "link": "https://stackoverflow.com/users/2511795/0andriy"}, "edited": false, "score": 0, "creation_date": 1554371289, "post_id": 55492762, "comment_id": 97730476, "body": "@0andriy I don&#39;t think there is anything stopping you calling <code>request_irq()</code> multiple times for the same PCI device as long as the calls have a unique <code>dev</code> context pointer. The context is completely opaque to <code>request_irq()</code>. But for performance, it is better to have a single IRQ handler for the PCI device and let it figure out which channels are interrupting."}], "owner": {"reputation": 489, "user_id": 7684979, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/55dee8eaddd0b1bef61d118334acefb9?s=128&d=identicon&r=PG&f=1", "display_name": "xMutzelx", "link": "https://stackoverflow.com/users/7684979/xmutzelx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 128, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1554286742, "creation_date": 1554286742, "question_id": 55492762, "link": "https://stackoverflow.com/questions/55492762/requesting-irq-for-a-multi-channel-device", "title": "Requesting irq for a multi channel device", "body": "<p>Assume a pci-driver for the linux-kernel. This device can have multiple channels that can be \"up'ed\" or \"down'ed\" individually. <br>\nEach \"up\" calls the function <code>.ndo_open</code> and each \"down\" calls <code>.ndo_stop</code>.\n<br>\nThis device needs only one interrupt-line which can be requested with <code>request_irq ()</code>. Each request will create one interrupt-line.\nImportant to note here is, that interrupt-lines are rare and they should not be created mindless.\nMy question to this situation is, where should I use <code>request_irq()</code>? <br><br>\nIn my opinion I have two possible solutions for this. <br></p>\n\n<ol>\n<li>Right in the <code>probe()</code>. This will only create one interrupt-line but it will always be created when the pc is turned on. So it might be unused.</li>\n<li>In <code>.ndo_open</code>. This will create the interrupt-line only when it is needed, but a multichannel device can create mutliple calls of <code>.ndo_open</code> which will result in multiple calls of <code>request_irq()</code></li>\n</ol>\n\n<p>I was not able to find any information about this situation in the kernel docs. If there is some guideline for this, can you please explain/show it to me? I also checked other pci-drivers from the <a href=\"https://github.com/torvalds/linux/tree/master/drivers/net/can\" rel=\"nofollow noreferrer\">git-repo</a> but none (or at least the ones I checked) had this problem.</p>\n"}, {"tags": ["c", "linux", "linux-kernel"], "comments": [{"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 1, "creation_date": 1554286021, "post_id": 55492440, "comment_id": 97692151, "body": "What is the <code>errno</code> value?"}, {"owner": {"reputation": 19779, "user_id": 878532, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/5fbebb625a289267abd098c0e676c760?s=128&d=identicon&r=PG", "display_name": "Klaus", "link": "https://stackoverflow.com/users/878532/klaus"}, "edited": false, "score": 1, "creation_date": 1554286025, "post_id": 55492440, "comment_id": 97692156, "body": "have you looked for errno, have you used strace command, what are the results"}, {"owner": {"reputation": 111, "user_id": 10599548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68e5192d114e5dffec1c1baac2945752?s=128&d=identicon&r=PG&f=1", "display_name": "GioPoe", "link": "https://stackoverflow.com/users/10599548/giopoe"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1554286796, "post_id": 55492440, "comment_id": 97692629, "body": "@KamilCuk could you help me where I would check the errno value? (Haven&#39;t used that before). Am googling what it is."}, {"owner": {"reputation": 144, "user_id": 6268689, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c046808ca5e03e9dcffdcde33f81b37a?s=128&d=identicon&r=PG&f=1", "display_name": "AdamTL", "link": "https://stackoverflow.com/users/6268689/adamtl"}, "edited": false, "score": 0, "creation_date": 1554287245, "post_id": 55492440, "comment_id": 97692928, "body": "<code>#include &lt;errno.h&gt;</code>   <code>#include &lt;string.h&gt;</code>   (...) <code>printf(&quot;ERROR: %s\\n&quot;, strerror(errno));</code>"}, {"owner": {"reputation": 111, "user_id": 10599548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68e5192d114e5dffec1c1baac2945752?s=128&d=identicon&r=PG&f=1", "display_name": "GioPoe", "link": "https://stackoverflow.com/users/10599548/giopoe"}, "reply_to_user": {"reputation": 144, "user_id": 6268689, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c046808ca5e03e9dcffdcde33f81b37a?s=128&d=identicon&r=PG&f=1", "display_name": "AdamTL", "link": "https://stackoverflow.com/users/6268689/adamtl"}, "edited": false, "score": 0, "creation_date": 1554287437, "post_id": 55492440, "comment_id": 97693041, "body": "@AdamTL thank you ! I have updated my post to show the errno"}, {"owner": {"reputation": 22422, "user_id": 634919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f4a87fe094961af20263d8e7ff445b2?s=128&d=identicon&r=PG", "display_name": "Nate Eldredge", "link": "https://stackoverflow.com/users/634919/nate-eldredge"}, "edited": false, "score": 1, "creation_date": 1554296721, "post_id": 55492440, "comment_id": 97698896, "body": "errno 38 is ENOSYS.  Your system call hasn&#39;t made it into the kernel&#39;s table of system calls, so you&#39;ve apparently missed something.  You did recompile and reboot?  You&#39;re sure you are running the modified kernel?  Are you in fact running on ARM?"}, {"owner": {"reputation": 22422, "user_id": 634919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f4a87fe094961af20263d8e7ff445b2?s=128&d=identicon&r=PG", "display_name": "Nate Eldredge", "link": "https://stackoverflow.com/users/634919/nate-eldredge"}, "edited": false, "score": 1, "creation_date": 1554296841, "post_id": 55492440, "comment_id": 97698975, "body": "Not to be rude, but it may be premature to try to get into kernel hacking before you have a pretty good comfort level with userspace Unix programming.  Knowing about <code>errno</code> is pretty fundamental."}, {"owner": {"reputation": 111, "user_id": 10599548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68e5192d114e5dffec1c1baac2945752?s=128&d=identicon&r=PG&f=1", "display_name": "GioPoe", "link": "https://stackoverflow.com/users/10599548/giopoe"}, "reply_to_user": {"reputation": 22422, "user_id": 634919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f4a87fe094961af20263d8e7ff445b2?s=128&d=identicon&r=PG", "display_name": "Nate Eldredge", "link": "https://stackoverflow.com/users/634919/nate-eldredge"}, "edited": false, "score": 0, "creation_date": 1554304243, "post_id": 55492440, "comment_id": 97703973, "body": "@NateEldredge Thanks, I&#39;ll investigate further. &amp; It&#39;s not rude. I should&#39;ve had mentioned that this is a small part of coursework &amp; we&#39;re being used as guinea pigs so yes I&#39;m barely learning everything from scratch. No other course I&#39;ve taken before taught me kernel hacking."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 1, "creation_date": 1554306505, "post_id": 55492440, "comment_id": 97705412, "body": "This may be a silly question, but are you actually running the updated kernel?"}], "owner": {"reputation": 111, "user_id": 10599548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68e5192d114e5dffec1c1baac2945752?s=128&d=identicon&r=PG&f=1", "display_name": "GioPoe", "link": "https://stackoverflow.com/users/10599548/giopoe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 269, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1554287466, "creation_date": 1554285877, "last_edit_date": 1554287466, "question_id": 55492440, "link": "https://stackoverflow.com/questions/55492440/why-is-my-linux-syscall-returning-a-1-in-userspace", "title": "Why is my linux syscall returning a -1 in userspace?", "body": "<p>I tried many guides and for some reason, my syscall isn't even returning a 0 as it should. Where am I going wrong? Here are my steps to creating one: </p>\n\n<p>inside \"/linux/\" folder: \nI created a folder called \"mycall\" with files mycall.c, mycall.h, &amp; Makefile</p>\n\n<p>mycall.c:</p>\n\n<pre><code>#include &lt;linux/kernel.h&gt;\n#include &lt;linux/init.h&gt;\n#include &lt;sched.h&gt;\n#include &lt;syscalls.h&gt;\n#include &lt;linux/unistd.h&gt;\n#include \"mycall.h\"\n\nasmlinkage long sys_mysyscall(int *id, int username, int *size)\n{\n printk(\"hello\");\n return 0;\n}\n</code></pre>\n\n<p>mycall.h:</p>\n\n<pre><code>asmlinkage long sys_mysyscall(int *id, int username, int *size);\n</code></pre>\n\n<p>Makefile:</p>\n\n<pre><code>obj-y := mycall.o\n</code></pre>\n\n<p>then I went into all of the places where I THOUGHT i should declare the syscall. </p>\n\n<pre><code>// inside of /linux/include/linux/syscalls.h\nasmlinkage long sys_mysyscall(int __user *myid, int username, int __user *size);\n</code></pre>\n\n<p>then to </p>\n\n<pre><code>// inside of /linux/arch/arm/tools/syscall.tbl\n398    common  mysyscall      sys_mysyscall\n</code></pre>\n\n<p>finally i added </p>\n\n<pre><code>// inside of /linux/Makefile\ncore-y    += kernel/ certs/ mm/ fs/ ipc/ security/ crypt/ block/ mycall/\n</code></pre>\n\n<p>thats my set up. then the final thing I do is make a userspace in /linux directory\nuserspace.c:</p>\n\n<pre><code>#include &lt;linux/kernel.h&gt;\n#include &lt;sys/syscall.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;pwd.h&gt;\n\nint main () \n{\nint id = 0;\nint username = 7;\nint size = 2;\nint ret_val = syscall(398, &amp;id, username, &amp;size);\nprintf(\"%d\\n\", ret_val);\nreturn 0;\n}\n</code></pre>\n\n<p>the return value is -1 so this doesn't work. please let me know what I'm doing wrong. I have read several implementation guides. </p>\n\n<p>ERRNO is 38 . Function not implemented. </p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1554287471, "post_id": 55492304, "comment_id": 97693063, "body": "Keil is the IDE not the programming language"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 1953472, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ce642b38bee36ca6f98c1dd7a0d383a?s=128&d=identicon&r=PG", "display_name": "sajad", "link": "https://stackoverflow.com/users/1953472/sajad"}, "edited": false, "score": 0, "creation_date": 1554290219, "post_id": 55493059, "comment_id": 97694698, "body": "Thanks P__J__. 1. I don&#39;t understand  &quot;if(TIM8 -&gt; SR &amp; TIM_SR_UIF) TIM8 -&gt; SR = ~(TIM_SR_UIF);&quot; what dose it mean? 2.Could you explain how can I use interrupt of this timer to blink a led please?"}], "tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": true, "score": 0, "last_activity_date": 1554287676, "creation_date": 1554287676, "answer_id": 55493059, "question_id": 55492304, "link": "https://stackoverflow.com/questions/55492304/how-to-config-timer-in-tim-base-for-stm32f746ng-discovery-by-keil/55493059#55493059", "title": "How to config TIMER in TIM_BASE for stm32f746NG_Discovery by Keil?", "body": "<p>Tim 8 configure update interrupt</p>\n\n<pre><code>__HAL_RCC_TIM8_CLK_ENABLE();\n\nTIM8 -&gt; PSC = 999;\nTIM8 -&gt; ARR = SystemCoreClock / ((TIM8 -&gt; PSC + 1) * freq) - 1;\nTIM8 -&gt; EGR |= TIM_EGR_UG;\nif(TIM8 -&gt; SR &amp; TIM_SR_UIF) TIM8 -&gt; SR = ~(TIM_SR_UIF);\nTIM8 -&gt; DIER |= TIM_DIER_UIE;\nTIM8 -&gt; CR1 = TIM_CR1_CEN;\n\nNVIC_EnableIRQ(TIM8_TRG_COM_TIM14_IRQn);\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 1953472, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ce642b38bee36ca6f98c1dd7a0d383a?s=128&d=identicon&r=PG", "display_name": "sajad", "link": "https://stackoverflow.com/users/1953472/sajad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "accepted_answer_id": 55493059, "answer_count": 1, "score": 0, "last_activity_date": 1554287676, "creation_date": 1554285466, "question_id": 55492304, "link": "https://stackoverflow.com/questions/55492304/how-to-config-timer-in-tim-base-for-stm32f746ng-discovery-by-keil", "title": "How to config TIMER in TIM_BASE for stm32f746NG_Discovery by Keil?", "body": "<p>I want to use timer8 of stm32f746NG_Discovery board, but I don't know how can config it.Does anyone have a simple code in keil,please?</p>\n"}, {"tags": ["c++", "c", "file"], "comments": [{"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 0, "creation_date": 1554289045, "post_id": 55492293, "comment_id": 97694024, "body": "Would <code>fseek(fd, offset, SEEK_CUR)</code> help? You need to calculate what the <code>offset</code> should be."}], "answers": [{"tags": [], "owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "is_accepted": false, "score": 0, "last_activity_date": 1554290764, "creation_date": 1554290764, "answer_id": 55494035, "question_id": 55492293, "link": "https://stackoverflow.com/questions/55492293/replacing-character-next-to-it-after-find-the-string-in-file/55494035#55494035", "title": "Replacing character next to it after find the string in file", "body": "<p>Well it is not very clear to me, what are you trying there, but If this is not what you need, please let me know:</p>\n\n<pre><code>#include &lt;string.h&gt;\n#include &lt;stdio.h&gt;\n\nint findFOO( const char *const ptr, const char *const substr );\nint search( const char *const src, const char *str );\n\nsize_t findOCC ( char *const src, const char *substr );\n\nint main ( void )\n{\n    char arr[] = \"FOO,val1=0,val2=0\" ;\n\n    printf(\"Before: %s\\n\", arr );\n\n    size_t len = findOCC( arr, \"var1\" );\n    arr[len] = '1';\n\n    printf(\"After:  %s\\n \" , arr );\n\n}\n\nint findFOO( const char *const ptr, const char *const substr )\n{\n    char *ret = strstr( ptr, substr );\n    if ( ret == NULL )\n    {\n        return 0;\n    }\n    return 1;\n}\n\n\nint search( const char *const src, const char *const str )\n{\n    int i, j, firstOcc;\n    i = 0, j = 0;\n\n    while (src[i] != '\\0')\n    {\n\n        while (src[i] != str[0] &amp;&amp; src[i] != '\\0')\n            i++;\n\n        if (src[i] == '\\0')\n            return (-1);\n\n        firstOcc = i;\n\n        while (src[i] == str[j] &amp;&amp; src[i] != '\\0' &amp;&amp; str[j] != '\\0')\n        {\n            i++;\n            j++;\n        }\n\n        if (str[j] == '\\0')\n            return ( firstOcc );\n        if (src[i] == '\\0')\n            return (-1);\n\n        i = firstOcc + 1;\n        j = 0;\n    }\n    return 0;\n}\n\nsize_t findOCC ( char *const src, const char *substr )\n{\n    char buffer[strlen( src) + 1 ];\n    strcpy( buffer, src );\n    if ( findFOO ( src, \"FOO\" ) )   /// Search if there is a Line containing FOO\n    {\n\n        int ret = search( buffer, substr );\n        if ( ret ) /// found a Match\n        {\n            char *tmp = strtok( buffer, \"=\" );\n            return strlen( tmp ) + 1; /// return the index\n        }\n\n    }\n    return 0;\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>Before: FOO,val1=0,val2=0\nAfter:  FOO,val1=1,val2=0\n</code></pre>\n\n<p>I was not searching in a file, because you need a way to modify your buffer, so I will let you to do the rest of the Job here.</p>\n\n<p>Of course there are a lot of error checking needed here, but I am sure that you can figure out what you need to do.</p>\n"}], "owner": {"reputation": 175, "user_id": 4468433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e363965af81d82c5f9a8b710631666c2?s=128&d=identicon&r=PG&f=1", "display_name": "pari", "link": "https://stackoverflow.com/users/4468433/pari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1554290764, "creation_date": 1554285437, "last_edit_date": 1554285884, "question_id": 55492293, "link": "https://stackoverflow.com/questions/55492293/replacing-character-next-to-it-after-find-the-string-in-file", "title": "Replacing character next to it after find the string in file", "body": "<p>My code is to accept the values from the  command line args and search for string and replace the next character after the string found in the line where the keyword in each line is separated by separots.</p>\n\n<p>Basically after finding the character position from the buffer string which corresponds to file pointer position of that string, then update the character at fp+X. I want to know is there a way to do it?</p>\n\n<p>I am ok with C++ too.                     </p>\n\n<p>I have the file.txt like below</p>\n\n<p>\n</p>\n\n<pre><code>FOO,val1=0,val2=0\nBAR,val1=0,val2=0\nTOO,val1=0,val2=0\n</code></pre>\n\n\n\n<p>Command line</p>\n\n<p>\n</p>\n\n<pre><code>#./a.out FOO val1 1\n</code></pre>\n\n\n\n<p>mycode.c</p>\n\n<pre><code>char        buffer[kKEYWORD_SIZE];\nFILE*       fd;\n\nif ((fd = fopen(file.txt, \"r+\")) != NULL)\n{\n    do\n    {\n        memset(buffer, 0x0, kKEYWORD_SIZE);\n        if (fgets(buffer, kKEYWORD_SIZE, fd) != NULL)\n        {\n           //storing the entire line into pointer to character array.\n            for (index = 0, token = strtok_r(buffer, sep, &amp;last); token; token = strtok_r(NULL, sep, &amp;last), index++)\n                strcpy(*(keyword + index), token);\n\n\n           // the first keyword found and search for 2nd keyword and replaces its value   \n            if (strcmp(*(keyword + 0), key1) == 0)\n            {\n               if ( ( find = strstr(buffer, key2 )) != NULL )\n                {\n                      // I want fp pointers to move it to find+5\n                      fputs(fp,argv[3]);\n                }\n</code></pre>\n\n<p>it would be greatly appreciated if any one throw a light on this</p>\n"}, {"tags": ["c", "parallel-processing", "mpi"], "comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 2, "creation_date": 1554285037, "post_id": 55492001, "comment_id": 97691502, "body": "<code>stdout</code> is line buffered by default."}, {"owner": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "edited": false, "score": 0, "creation_date": 1554286928, "post_id": 55492001, "comment_id": 97692726, "body": "Please try to be more clear in your problem description. &quot;Something strange happening&quot; is a really vague title."}, {"owner": {"reputation": 310, "user_id": 6941400, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/srsn4.jpg?s=128&g=1", "display_name": "Anshuman Kumar", "link": "https://stackoverflow.com/users/6941400/anshuman-kumar"}, "reply_to_user": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "edited": false, "score": 0, "creation_date": 1554287756, "post_id": 55492001, "comment_id": 97693224, "body": "@Zulan, thanks for your input.  I will keep it in mind."}, {"owner": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "edited": false, "score": 0, "creation_date": 1554288341, "post_id": 55492001, "comment_id": 97693556, "body": "tag C, but mpic++ (which is the C++ driver)????"}, {"owner": {"reputation": 310, "user_id": 6941400, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/srsn4.jpg?s=128&g=1", "display_name": "Anshuman Kumar", "link": "https://stackoverflow.com/users/6941400/anshuman-kumar"}, "edited": false, "score": 0, "creation_date": 1554291123, "post_id": 55492001, "comment_id": 97695284, "body": "I couldn&#39;t find one for mpic, so I improvised."}], "answers": [{"comments": [{"owner": {"reputation": 310, "user_id": 6941400, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/srsn4.jpg?s=128&g=1", "display_name": "Anshuman Kumar", "link": "https://stackoverflow.com/users/6941400/anshuman-kumar"}, "edited": false, "score": 0, "creation_date": 1554285345, "post_id": 55492156, "comment_id": 97691703, "body": "[pappuyadav:28670] *** Process received signal *** [pappuyadav:28670] Signal: Segmentation fault (11) [pappuyadav:28670] Signal code: Address not mapped (1) [pappuyadav:28670] Failing at address: 0x7fff31a8b000 [pappuyadav:28670] [ 0] /lib/x86_64-linux-gnu/libc.so.6(+0x3ef20)[0x7f7bcc028f20] [pappuyadav:28670] [ 1] ./q4(+0xfd4)[0x560f23a80fd4] [pappuyadav:28670] [ 2] /lib/x86_64-linux-gnu/libc.so.6(__libc_start_main+0xe7)[0x7f&zwnj;&#8203;7bcc00bb97] [pappuyadav:28670] [ 3] ./q4(+0xb5a)[0x560f23a80b5a] [pappuyadav:28670] *** End of error message ***"}, {"owner": {"reputation": 310, "user_id": 6941400, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/srsn4.jpg?s=128&g=1", "display_name": "Anshuman Kumar", "link": "https://stackoverflow.com/users/6941400/anshuman-kumar"}, "edited": false, "score": 0, "creation_date": 1554285545, "post_id": 55492156, "comment_id": 97691837, "body": "That is what I got."}, {"owner": {"reputation": 310, "user_id": 6941400, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/srsn4.jpg?s=128&g=1", "display_name": "Anshuman Kumar", "link": "https://stackoverflow.com/users/6941400/anshuman-kumar"}, "edited": false, "score": 0, "creation_date": 1554286906, "post_id": 55492156, "comment_id": 97692712, "body": "I am sorry. I got it."}, {"owner": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "edited": false, "score": 0, "creation_date": 1554288421, "post_id": 55492156, "comment_id": 97693607, "body": "Even with a flush, that doesn&#39;t mean that MPI has to flush its IO as well, does it?"}, {"owner": {"reputation": 6899, "user_id": 1212012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gmBY7.png?s=128&g=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1212012/mathieu"}, "edited": false, "score": 0, "creation_date": 1554290422, "post_id": 55492156, "comment_id": 97694838, "body": "<a href=\"https://linux.die.net/man/3/fflush\" rel=\"nofollow noreferrer\"><code>fflush(stdout);</code></a> will only flush the standard output. Other MPI I/O won&#39;t be affected."}], "tags": [], "owner": {"reputation": 6899, "user_id": 1212012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gmBY7.png?s=128&g=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1212012/mathieu"}, "is_accepted": true, "score": 2, "last_activity_date": 1554285552, "last_edit_date": 1554285552, "creation_date": 1554285044, "answer_id": 55492156, "question_id": 55492001, "link": "https://stackoverflow.com/questions/55492001/while-running-my-code-in-mpi-the-root-process-never-executes-despite-following/55492156#55492156", "title": "While running my code in MPI, the root process never executes despite following the correct syntax", "body": "<p>You need to add some <code>fflush(stdout);</code> after the last <code>printf</code> to force the text refresh.</p>\n\n<p>When there is no <code>\\n</code> in <code>printf</code> text, the text is not displayed immediately.</p>\n\n<p>So you should write:</p>\n\n<pre><code>printf(\"Enter a length for the string that is divisible by the number of processes \");\nfflush(stdout);\nscanf(\"%d\",&amp;m);\n....\n</code></pre>\n\n<p>Or simpler:</p>\n\n<pre><code>puts(\"Enter a length for the string that is divisible by the number of processes \");\nscanf(\"%d\",&amp;m);\n....\n</code></pre>\n\n<p>The <code>puts</code> is to print a message on a line (it creates a new line). And it's not buffered.</p>\n"}, {"tags": [], "owner": {"reputation": 310, "user_id": 6941400, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/srsn4.jpg?s=128&g=1", "display_name": "Anshuman Kumar", "link": "https://stackoverflow.com/users/6941400/anshuman-kumar"}, "is_accepted": false, "score": -1, "last_activity_date": 1554287439, "creation_date": 1554287439, "answer_id": 55492972, "question_id": 55492001, "link": "https://stackoverflow.com/questions/55492001/while-running-my-code-in-mpi-the-root-process-never-executes-despite-following/55492972#55492972", "title": "While running my code in MPI, the root process never executes despite following the correct syntax", "body": "<p>In case anyone ever reads this in the future, this is to add to what Matthieu said.\nThe code should be like this </p>\n\n<pre><code> if (rank == 0 )\n {\n  printf(\"Enter a length for the string that is divisible by the number of processes \\n\");\n    fflush(stdout);\n.\n.\n.\n</code></pre>\n"}], "owner": {"reputation": 310, "user_id": 6941400, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/srsn4.jpg?s=128&g=1", "display_name": "Anshuman Kumar", "link": "https://stackoverflow.com/users/6941400/anshuman-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 55492156, "answer_count": 2, "score": -2, "last_activity_date": 1563427366, "creation_date": 1554284587, "last_edit_date": 1563427366, "question_id": 55492001, "link": "https://stackoverflow.com/questions/55492001/while-running-my-code-in-mpi-the-root-process-never-executes-despite-following", "title": "While running my code in MPI, the root process never executes despite following the correct syntax", "body": "<p>While trying to execute my code written in C using the MPI Library, I encountered something very odd happening.\nMy code generates no syntax error yet when I try</p>\n\n<pre><code> mpirun -n 3 ./q4\n</code></pre>\n\n<p>I get this</p>\n\n<pre><code>hello\nhello\nhello\nfrom the other side.\nfrom the other side.\nfrom the other side.\n</code></pre>\n\n<p>It seems to never enter the rank 0 process. I have no idea why this is happening. This code is structurally identical to some other samples that I have writtten (I can provide the entire code if need be)\nHowever, if I were to type in any two random things after the sixth line, I get this</p>\n\n<pre><code>1213\n123\nEnter a length for the string that is divisible by the number of processes Number of vowels 27 \n\n</code></pre>\n\n<p>I don't really know what to do to fix it except that I checked my code for logically errors, which there are none and even if they are, they are much later which means that at least the the code under the first if case should execute.</p>\n\n<pre><code>int main(int argc, char * argv[])\n{\n printf(\"hello\\n\");\n int rank,m,size,num;\n MPI_Init(&amp;argc,&amp;argv);\n MPI_Comm_rank(MPI_COMM_WORLD,&amp;rank);\n MPI_Comm_size(MPI_COMM_WORLD,&amp;size);\n printf(\"from the other side.\\n\");\n char str[100];\n if (rank == 0 )\n {\n  printf(\"Enter a length for the string that is divisible by the number of processes \");\n  scanf(\"%d\",&amp;m);\n  scanf(\"%s\",str);\n }\n.\n.\n</code></pre>\n\n<p>In case it is relevant, I am running Ubuntu 18.04.</p>\n"}, {"tags": ["c", "multithreading", "sockets"], "comments": [{"owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 2, "creation_date": 1554283731, "post_id": 55491658, "comment_id": 97690683, "body": "If you spawn a new thread for the client, that thread can just wait/block until there&#39;s data available by calling read()/recv() or similar.on the socket."}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1554284786, "post_id": 55491658, "comment_id": 97691354, "body": "Why? When I/O is possible, and specifically when there is data to be read, it will complete without blocking. What do you need a thread for?"}, {"owner": {"reputation": 55, "user_id": 9448756, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Svtyros", "link": "https://stackoverflow.com/users/9448756/svtyros"}, "reply_to_user": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1554285158, "post_id": 55491658, "comment_id": 97691569, "body": "@user207421 I updated the question. The client thread can&#39;t block on read since it may get called at any time by worker/main thread"}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 1, "creation_date": 1554286211, "post_id": 55491658, "comment_id": 97692283, "body": "Read what I wrote, and try to make sense yourself. If you&#39;re using non-blocking mode, the client thread cannot block <i>at all</i>, by definition, and you don&#39;t <i>need</i> a client thread if you are using non-blocking mode <i>at all,</i> and <i>particularly</i> if you are driving your I/O off &#39;there&#39;s data to be read&#39;. You also need to clarify what you think &#39;calling&#39; a thread from another thread actually means."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1554289307, "post_id": 55491658, "comment_id": 97694173, "body": "A thread cannot be called from another thread, only signalled.  Call/return does not change thread context.  Your concerns are unclear:("}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1554296194, "post_id": 55491658, "comment_id": 97698564, "body": "What does each thread do when it&#39;s not doing IO?  If it would simply be waiting for a signal that it needs to do IO, drop the non-blocking sockets and just have each thread wait for input via <code>read()</code> or <code>recv()</code>.  Because there&#39;s no point in blocking while waiting for a signal from another thread to perform IO when the thread that needs to do IO can just access a normal, blocking descriptor."}, {"owner": {"reputation": 55, "user_id": 9448756, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Svtyros", "link": "https://stackoverflow.com/users/9448756/svtyros"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1554305008, "post_id": 55491658, "comment_id": 97704462, "body": "@Andrew the client thread is awaiting for the main thread to fire a signal to it"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1554305283, "post_id": 55491658, "comment_id": 97704637, "body": "<i>the client thread is awaiting for the main thread to fire a signal to it</i>  A signal that means what?  &quot;You have IO waiting on your socket&quot;?  Again - that&#39;s pointless.  Just use a blocking socket and have the thread block in <code>recv()</code> or <code>read()</code> and get its data directly.  You&#39;re adding needless complexity.  If you&#39;re creating a thread per client socket, there&#39;s no need to have the main thread poll all the sockets - there is already client thread that can do its own work.  That architecture doesn&#39;t scale as well, but I seriously doubt you need to address that problem"}, {"owner": {"reputation": 861, "user_id": 743414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4865c7841b624ea4f967e6d1806bbbb0?s=128&d=identicon&r=PG", "display_name": "user743414", "link": "https://stackoverflow.com/users/743414/user743414"}, "edited": false, "score": 0, "creation_date": 1554384206, "post_id": 55491658, "comment_id": 97738806, "body": "One thread per connection is always a bad design (google for context switch). You should think about using a threadpool to communicate with clients or just use a single thread apporach when it&#39;s fast enough."}, {"owner": {"reputation": 55, "user_id": 9448756, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Svtyros", "link": "https://stackoverflow.com/users/9448756/svtyros"}, "reply_to_user": {"reputation": 861, "user_id": 743414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4865c7841b624ea4f967e6d1806bbbb0?s=128&d=identicon&r=PG", "display_name": "user743414", "link": "https://stackoverflow.com/users/743414/user743414"}, "edited": false, "score": 1, "creation_date": 1554473589, "post_id": 55491658, "comment_id": 97778160, "body": "@user743414 In fact, I dont create the threads when the client connects. I allocate the memory at the start of the game-server on an <code>int8_t[0x44C0000]</code> and when a new client thread is started I just assign it a part of this memory (0x44C) with <code>pthread_attr_setstack</code>. This way I can manage up to 1100 simultaneous connections and avoid the <code>pthread_create</code> overhead"}], "answers": [{"tags": [], "owner": {"reputation": 81656, "user_id": 8446, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8f9c683775bfbe76ed4855a19b73dc81?s=128&d=identicon&r=PG", "display_name": "Roger Lipscombe", "link": "https://stackoverflow.com/users/8446/roger-lipscombe"}, "is_accepted": false, "score": 1, "last_activity_date": 1554285242, "creation_date": 1554285242, "answer_id": 55492229, "question_id": 55491658, "link": "https://stackoverflow.com/questions/55491658/notify-a-thread-when-i-o-is-possible-on-a-socket/55492229#55492229", "title": "Notify a thread when I/O is possible on a socket", "body": "<p>Use <code>select()</code> or <code>epoll()</code> (on Linux) or <code>kqueue</code> (on BSD).</p>\n"}, {"comments": [{"owner": {"reputation": 55, "user_id": 9448756, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Svtyros", "link": "https://stackoverflow.com/users/9448756/svtyros"}, "edited": false, "score": 0, "creation_date": 1554304704, "post_id": 55495676, "comment_id": 97704266, "body": "Would it make sense to use epoll on my worker thread and have it fire a SIGIO to the client thread with pthread_kill when I/O is possible?"}, {"owner": {"reputation": 13, "user_id": 9264129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e855fa0b285cd051409e498c33af4c3b?s=128&d=identicon&r=PG&f=1", "display_name": "Mohan Grewis", "link": "https://stackoverflow.com/users/9264129/mohan-grewis"}, "reply_to_user": {"reputation": 55, "user_id": 9448756, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Svtyros", "link": "https://stackoverflow.com/users/9448756/svtyros"}, "edited": false, "score": 0, "creation_date": 1554387870, "post_id": 55495676, "comment_id": 97741375, "body": "Not really you should use epoll on your main thread and maybe start a new thread when there is data to read on a socket. But I don&#39;t recommand using thread in your situation."}], "tags": [], "owner": {"reputation": 13, "user_id": 9264129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e855fa0b285cd051409e498c33af4c3b?s=128&d=identicon&r=PG&f=1", "display_name": "Mohan Grewis", "link": "https://stackoverflow.com/users/9264129/mohan-grewis"}, "is_accepted": false, "score": 1, "last_activity_date": 1554295937, "creation_date": 1554295937, "answer_id": 55495676, "question_id": 55491658, "link": "https://stackoverflow.com/questions/55491658/notify-a-thread-when-i-o-is-possible-on-a-socket/55495676#55495676", "title": "Notify a thread when I/O is possible on a socket", "body": "<p>Assuming you are on Linux.\nI recommend you to just drop thread and start using epoll. Epoll can take multiple file descriptor and watch over all of them.</p>\n\n<p>You can start here : <a href=\"https://kovyrin.net/2006/04/13/epoll-asynchronous-network-programming/\" rel=\"nofollow noreferrer\">https://kovyrin.net/2006/04/13/epoll-asynchronous-network-programming/</a>\nOr here : <a href=\"http://man7.org/linux/man-pages/man7/epoll.7.html\" rel=\"nofollow noreferrer\">http://man7.org/linux/man-pages/man7/epoll.7.html</a></p>\n"}], "owner": {"reputation": 55, "user_id": 9448756, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Svtyros", "link": "https://stackoverflow.com/users/9448756/svtyros"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 176, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1554295937, "creation_date": 1554283602, "last_edit_date": 1554285017, "question_id": 55491658, "link": "https://stackoverflow.com/questions/55491658/notify-a-thread-when-i-o-is-possible-on-a-socket", "title": "Notify a thread when I/O is possible on a socket", "body": "<p>I am building an online multi-player game server. Currently the networking architecture is quite simple: the acceptor thread is an infinite loop that just sits waiting on accept(). If it gets a connection then it sets everything up and spawns a thread to handle communication with that client.</p>\n\n<p>My problem arises after I get the login packet, because the thread should just wait until there's any data to read (a new packet like \"attack this creature\", arrives). I know the flag O_ASYNC will make system fire a SIGIO, but since threads have the same PID on linux the signal is caught by the whole process.</p>\n\n<p>Is there an efficient way to get the thread notified when there's data to read so it knows when to parse the packet and eventually call worker thread to handle the command?</p>\n\n<p>Edit: forgot to mention that I set socket to O_NONBLOCK so read() does not block, because the client thread may get called at any time by another thread.</p>\n"}, {"tags": ["c", "linux", "daemon"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 3, "creation_date": 1554279812, "post_id": 55490346, "comment_id": 97688366, "body": "Error checking! You don&#39;t have any. You need to add it. My guess is that <code>stat</code> returns <code>-1</code> with <code>errno == ENOENT</code>."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 3, "creation_date": 1554279844, "post_id": 55490346, "comment_id": 97688395, "body": "And a hint about what I think is the problem: <code>file-&gt;d_name</code> is just the file-name, not a full path."}, {"owner": {"reputation": 51, "user_id": 11301535, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c993b703d9117602376a9b1005b5207?s=128&d=identicon&r=PG&f=1", "display_name": "kamilm758", "link": "https://stackoverflow.com/users/11301535/kamilm758"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1554280108, "post_id": 55490346, "comment_id": 97688547, "body": "How can i get a full path?"}, {"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "edited": false, "score": 1, "creation_date": 1554280583, "post_id": 55490346, "comment_id": 97688796, "body": "@kamilm758 You have to build it by concatenating the directory name and the file name, with <code>&#47;</code> inbetween of course. Another way is to enter the directory being scanned, with <code>chdir()</code>."}], "answers": [{"comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 1, "creation_date": 1554282725, "post_id": 55491253, "comment_id": 97690104, "body": "Ad a check that <code>opendir</code> succeeded?"}, {"owner": {"reputation": 51, "user_id": 11301535, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c993b703d9117602376a9b1005b5207?s=128&d=identicon&r=PG&f=1", "display_name": "kamilm758", "link": "https://stackoverflow.com/users/11301535/kamilm758"}, "edited": false, "score": 0, "creation_date": 1554284110, "post_id": 55491253, "comment_id": 97690930, "body": "If date of modification is bigger then file was modified later?"}], "tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 0, "last_activity_date": 1554306033, "last_edit_date": 1554306033, "creation_date": 1554282414, "answer_id": 55491253, "question_id": 55490346, "link": "https://stackoverflow.com/questions/55490346/checking-the-modification-date-does-not-work/55491253#55491253", "title": "Checking the modification date does not work", "body": "<p>You must construct the path to the directory entry ans pass it to <code>stat</code>. You currently pass the entry name, which only works if you are enumerating from the current directory.</p>\n\n<p>Furthermore, you should test the return value of <code>stat</code> to detect any problem. This would have shown that <code>stat</code> fails with the current code.</p>\n\n<p>Here is a modified version:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;errno.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;string.h&gt;\n\n...\n\nchar path[1024];\nwhile (1) {\n    source = opendir(argv[1]);\n    if (source == NULL)\n        break;\n    while ((file = readdir(source)) != NULL) {\n        if (file-&gt;d_type != DT_REG)\n            continue; \n        snprintf(path, sizeof path, \"%s/%s\", path, file-&gt;d_name);\n        if (!stat(path, &amp;file_details))\n            fprintf(stderr, \"Name: %s, Last modify: %ld\\n\", path, file_details.st_mtime);\n        else\n            fprintf(stderr, \"Cannot stat %s; %s\\n\", path, strerror(errno));\n    }\n    closedir(source);\n    sleep(5);\n}\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 11301535, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c993b703d9117602376a9b1005b5207?s=128&d=identicon&r=PG&f=1", "display_name": "kamilm758", "link": "https://stackoverflow.com/users/11301535/kamilm758"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "closed_date": 1554283284, "answer_count": 1, "score": 0, "last_activity_date": 1554306033, "creation_date": 1554279681, "last_edit_date": 1554281816, "question_id": 55490346, "link": "https://stackoverflow.com/questions/55490346/checking-the-modification-date-does-not-work", "closed_reason": "Duplicate", "title": "Checking the modification date does not work", "body": "<p>I have a problem with checking the modification date.\nfprintf prints in the console for every file in the folder the same number equal zero.</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>while (1) {\n    source = opendir(argv[1]);\n    while ((file = readdir(source)) != NULL) {\n        if (file-&gt;d_type != DT_REG)\n            continue; \n        stat(file-&gt;d_name, &amp;file_details);\n        fprintf(stderr, \"Name: %s, Last modify: %ld  \\n\", file-&gt;d_name, file_details.st_mtime);\n    }\n    closedir(source);\n    sleep(5);\n}\n</code></pre>\n"}, {"tags": ["c", "timer"], "comments": [{"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 2, "creation_date": 1554279294, "post_id": 55490162, "comment_id": 97688070, "body": "Your <code>while</code> body has 1 single statement. Try adding a block <code>{ ... }</code> with the 3 statements. Of course that will still be too fast, but maybe you can see what happens with your debugger."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 3, "creation_date": 1554280016, "post_id": 55490162, "comment_id": 97688493, "body": "This is really too broad. You will need some manner of system-dependent timer. Then either poll it or execute something from a callback when the timer fires. Then update graphics accordingly. In a professional application this will be executed by different threads - you wouldn&#39;t have application logic in the thread handling graphic updates."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 11139757, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-aOrm1QmXCk4/AAAAAAAAAAI/AAAAAAAAABE/UeWQAvcXS8g/photo.jpg?sz=128", "display_name": "Big cick", "link": "https://stackoverflow.com/users/11139757/big-cick"}, "edited": false, "score": 0, "creation_date": 1554281588, "post_id": 55490304, "comment_id": 97689396, "body": "Thank you, is there any chance you could give an example of a timer code or a link to one? (also i&#39;m just using straight c in a bash shell"}, {"owner": {"reputation": 43, "user_id": 10607992, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CXJL3.jpg?s=128&g=1", "display_name": "GigaJoules", "link": "https://stackoverflow.com/users/10607992/gigajoules"}, "reply_to_user": {"reputation": 21, "user_id": 11139757, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-aOrm1QmXCk4/AAAAAAAAAAI/AAAAAAAAABE/UeWQAvcXS8g/photo.jpg?sz=128", "display_name": "Big cick", "link": "https://stackoverflow.com/users/11139757/big-cick"}, "edited": false, "score": 0, "creation_date": 1554295780, "post_id": 55490304, "comment_id": 97698282, "body": "<a href=\"https://unix.stackexchange.com/questions/53841/how-to-use-a-timer-in-bash\" title=\"how to use a timer in bash\">unix.stackexchange.com/questions/53841/&hellip;</a>"}], "tags": [], "owner": {"reputation": 43, "user_id": 10607992, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CXJL3.jpg?s=128&g=1", "display_name": "GigaJoules", "link": "https://stackoverflow.com/users/10607992/gigajoules"}, "is_accepted": false, "score": 0, "last_activity_date": 1554284165, "last_edit_date": 1554284165, "creation_date": 1554279557, "answer_id": 55490304, "question_id": 55490162, "link": "https://stackoverflow.com/questions/55490162/how-to-create-a-timer-that-counts-down-from-99-to-0-reducing-by-1-every-secon/55490304#55490304", "title": "How to create a timer that counts down from 99% to 0% reducing by 1% every second", "body": "<p>You are missing brackets from your while loop so it's not going to work for a start!</p>\n\n<p>You really need to implement a timer so that you can actually tell when a second has passed as your code could vary in operation speed, and definitely will when you make any changes. \nHow you do this is totally up to the system you are writing on and you haven't given enough information for us to help you. \nMost often hardware running C has hardware timers and specific registers you need to target.</p>\n"}, {"tags": [], "owner": {"reputation": 144, "user_id": 6268689, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c046808ca5e03e9dcffdcde33f81b37a?s=128&d=identicon&r=PG&f=1", "display_name": "AdamTL", "link": "https://stackoverflow.com/users/6268689/adamtl"}, "is_accepted": false, "score": 0, "last_activity_date": 1554279826, "creation_date": 1554279826, "answer_id": 55490392, "question_id": 55490162, "link": "https://stackoverflow.com/questions/55490162/how-to-create-a-timer-that-counts-down-from-99-to-0-reducing-by-1-every-secon/55490392#55490392", "title": "How to create a timer that counts down from 99% to 0% reducing by 1% every second", "body": "<p>A couple things:</p>\n\n<ul>\n<li>Your while does nothing. If you don't put your code inside brackets, it only executes the next line in a loop.</li>\n<li>You're not waiting for a second anywhere.</li>\n<li>You should probably rethink your approach - if you fix the above problems, when you call the function everything else in your program will freeze for 99 seconds except for the battery text changing.</li>\n</ul>\n\n<p>Maybe a better approach would be to write a function that has a <code>static int y = 99</code>, and each time you call it draw the battery text and decrease <code>y</code> by 1 (static more or less means the value is remembered between calls).</p>\n\n<p>Then, in your main game loop, you can check if a second has passed, and if so, execute that function.</p>\n"}, {"tags": [], "owner": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "is_accepted": false, "score": 1, "last_activity_date": 1554282052, "last_edit_date": 1554282052, "creation_date": 1554281704, "answer_id": 55491000, "question_id": 55490162, "link": "https://stackoverflow.com/questions/55490162/how-to-create-a-timer-that-counts-down-from-99-to-0-reducing-by-1-every-secon/55491000#55491000", "title": "How to create a timer that counts down from 99% to 0% reducing by 1% every second", "body": "<p>It's a rather broad question, but here are several general approaches, which all need to:</p>\n\n<ol>\n<li>Separate the game logic from rendering, and</li>\n<li>Using a state machine for updating game state, instead of pausing the execution.</li>\n</ol>\n\n<p>Here are two different approaches:</p>\n\n<ol>\n<li><p><strong>Game loop</strong></p>\n\n<p>Since you are designing a game, it's likely you will have a <a href=\"https://en.wikipedia.org/wiki/Game_programming#Game_structure\" rel=\"nofollow noreferrer\">game loop</a> of some sort, i.e.:</p>\n\n<pre><code>while (!ending)\n{\n    process_input();\n    update_state();\n    draw();\n}\n</code></pre>\n\n<p>And your <code>update_state</code> and <code>draw</code> functions should have different responsibilities, similar to:</p>\n\n<pre><code>static int current_percentage = 100;\nvoid update_state(void)\n{\n    // keep the time of last update\n    static timestamp last_update_time = 0;\n\n    // decrease 'current_percentage' when needed\n    timestamp now = get_current_game_time();\n    if (seconds_elapsed(now, last_update_time) &gt;= 1)\n    {\n        last_update_time = now;\n        current_percentage--;\n    }\n}\n\nvoid draw(void)\n{\n    // just handle the drawing\n    draw_percentage(current_percentage);\n}\n</code></pre></li>\n<li><p><strong>Multiple threads</strong></p>\n\n<p>On the other hand, if you are using multiple threads, you would likely end up with a rather different approach:</p>\n\n<pre><code>static atomic_int current_percentage = 100;\nvoid decrease_percentage(void)\n{\n     atomic_fetch_sub(&amp;current_percentage, 1);\n}\n\nvoid draw(void)\n{\n    // just handle the drawing\n    int percentage = atomic_load(&amp;current_percentage);\n    draw_percentage(percentage);\n}\n\n// no game loop - we will need to configure function callbacks\n// for different events\nvoid on_game_start(void)\n{\n    // one thread should update the timer\n    call_periodically(1000 /* period in ms */, decrease_percentage /* what to call */);\n\n    // this should run at max possible fps\n    call_when_idle(draw /* what to call when idle */);\n}\n</code></pre></li>\n</ol>\n\n<p>The latter approach is slightly shorter, although the main reason for this is because a lot of functionality is hidden inside the functions which configure the callbacks. The former one is simpler to reason about and doesn't have issues which arise with multithreaded code (deadlocks, race conditions - note the use of the <code>atomic_int</code> to ensure atomic updates), which is why a game loop is preferred if possible.</p>\n\n<p>If your game needs to utilize multiple cores, then you will need to involve some sort of threading, which comes with its additional complexity. The implementation of the second approach would also depend on your platform, since timers are not a part of the C standard.</p>\n\n<p>Finally, if you are using a game engine/framework (libgdx, Unity), you will likely have to implement the <code>update</code> and <code>draw</code> callbacks only, with the framework taking care of calling these functions when needed.</p>\n"}, {"comments": [{"owner": {"reputation": 2083, "user_id": 9638051, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/699e59e6a363089ae0059a22a8279a9e?s=128&d=identicon&r=PG&f=1", "display_name": "Immorality", "link": "https://stackoverflow.com/users/9638051/immorality"}, "edited": false, "score": 0, "creation_date": 1554293761, "post_id": 55493810, "comment_id": 97696962, "body": "The OP never mentions Unity and has tagged  &quot;C&quot;, not &quot;C#&quot;."}], "tags": [], "owner": {"reputation": 11, "user_id": 10922107, "user_type": "registered", "profile_image": "https://graph.facebook.com/1537581053199471/picture?type=large", "display_name": "Keeves Dev", "link": "https://stackoverflow.com/users/10922107/keeves-dev"}, "is_accepted": false, "score": -1, "last_activity_date": 1554290025, "creation_date": 1554290025, "answer_id": 55493810, "question_id": 55490162, "link": "https://stackoverflow.com/questions/55490162/how-to-create-a-timer-that-counts-down-from-99-to-0-reducing-by-1-every-secon/55493810#55493810", "title": "How to create a timer that counts down from 99% to 0% reducing by 1% every second", "body": "<p>If you are using unity, You can simply use a coroutine to countdown percentage per seconds.</p>\n\n<pre><code>void countDown()\n{\n    int percent = 99;\n    StartCoroutine(CountDownToZero(percent));\n}\n\n\nIEnumerator CountDownToZero(int percentage)\n{\n    WaitForSeconds wait1sec = new WaitForSeconds(1f);\n    while(percentage &gt; 0)\n    {\n        percentText.text = percentage.ToString()+\"%\";\n        yield return wait1sec;\n        percentage= percentage- 1;\n    }\n    percentText.text = \"0%\";\n}\n</code></pre>\n\n<p>In case of other engines, they also provide scheduler to schedule the execution of functions.</p>\n"}], "owner": {"reputation": 21, "user_id": 11139757, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-aOrm1QmXCk4/AAAAAAAAAAI/AAAAAAAAABE/UeWQAvcXS8g/photo.jpg?sz=128", "display_name": "Big cick", "link": "https://stackoverflow.com/users/11139757/big-cick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 0, "closed_date": 1554301016, "answer_count": 4, "score": 0, "last_activity_date": 1554290025, "creation_date": 1554279158, "last_edit_date": 1554287405, "question_id": 55490162, "link": "https://stackoverflow.com/questions/55490162/how-to-create-a-timer-that-counts-down-from-99-to-0-reducing-by-1-every-secon", "closed_reason": "Needs more focus", "title": "How to create a timer that counts down from 99% to 0% reducing by 1% every second", "body": "<p>I'm trying to create a timer to display in the top right hand corner of a game that counts from 99% down to 0% with 1% being dropped every second and the counter refreshing on the screen. ps (i'm new to coding so sorry if this is a dumb question) </p>\n\n<p>I've tried using a simple countdown loop but it decreases all at once, and doesn't save the counter as a variable, which i need so i can print it at a specific point on the screen </p>\n\n<pre><code>void battery_life(){\n     int w, h;\n    get_screen_size(&amp;w, &amp;h);\n\n    int y=99;\n    while (y !=0)\n    y--;\n    draw_int (2*w/3+5,h-h+2,y);\n    draw_char(2*w/3+7,h-h+2,'%');\n}\n\n</code></pre>\n\n<p>I expect that when i run this counter it -1% every second but it just counts down all at once and displays 0%</p>\n"}, {"tags": ["c", "string", "addition"], "comments": [{"owner": {"reputation": 527, "user_id": 689106, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/22ef5ea2bedfb2a3575ac22fe06d6c72?s=128&d=identicon&r=PG", "display_name": "Melon", "link": "https://stackoverflow.com/users/689106/melon"}, "edited": false, "score": 1, "creation_date": 1554279015, "post_id": 55490065, "comment_id": 97687907, "body": "What hapens when you add: 9 + 9, 9 + 99, 99 + 9, 99 + 99"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 3, "creation_date": 1554279286, "post_id": 55490065, "comment_id": 97688061, "body": "This seems to be the perfect time to <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">learn how to debug your programs</a>."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1554279431, "post_id": 55490065, "comment_id": 97688148, "body": "I also recommend that in the future you don&#39;t write full programs before doing basic testing like this. Instead write a very small piece of code, build (with extra warnings enabled) and fix possible errors and warnings, then test the small piece of code. Then you write another small little piece of code, build (and fix problems) and test. And so on. That way, it will be much easier to solve problems, debug code, and limit your searching for bugs to the last little piece of code you&#39;ve added."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1554279556, "post_id": 55490065, "comment_id": 97688220, "body": "And be wary of code that you copy-paste. If you need to do the same thing multiple times, instead of copy-paste the code and make small changes (that sometimes are forgotten or wrong), put common code into functions. Even if it&#39;s just a couple of lines. Functions are also much easier to test and debug in isolation."}, {"owner": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "edited": false, "score": 1, "creation_date": 1554282843, "post_id": 55490065, "comment_id": 97690179, "body": "@Kira: You are adding the digits from left to right, which cannot possibly work, i.e. if you enter <code>1000</code> and <code>34</code>, your function will first add <code>1</code> and <code>3</code>. I believe you also don&#39;t terminate the <code>sum</code> variable with <code>\\0</code> after reversing it. So start by reversing your inputs, terminate the sum, and learn how to step through your code using a debugger using simpler inputs which are have obvious results."}, {"owner": {"reputation": 83, "user_id": 3933837, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/bMYN1.png?s=128&g=1", "display_name": "BCLC", "link": "https://stackoverflow.com/users/3933837/bclc"}, "edited": false, "score": 0, "creation_date": 1585129024, "post_id": 55490065, "comment_id": 107652250, "body": "so kira are any of these answers helpful?"}], "answers": [{"comments": [{"owner": {"reputation": 295, "user_id": 11084304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e976564aeaeb377f5e74d844f8e4cfbb?s=128&d=identicon&r=PG&f=1", "display_name": "Kira", "link": "https://stackoverflow.com/users/11084304/kira"}, "edited": false, "score": 0, "creation_date": 1554350704, "post_id": 55492317, "comment_id": 97720751, "body": "I forgot to mention that I can only use the &lt;stdio.h&gt; header for this program."}, {"owner": {"reputation": 81, "user_id": 11061405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f2a40681b8f7f5ec2119ec5b876b720?s=128&d=identicon&r=PG&f=1", "display_name": "oWWo", "link": "https://stackoverflow.com/users/11061405/owwo"}, "reply_to_user": {"reputation": 295, "user_id": 11084304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e976564aeaeb377f5e74d844f8e4cfbb?s=128&d=identicon&r=PG&f=1", "display_name": "Kira", "link": "https://stackoverflow.com/users/11084304/kira"}, "edited": false, "score": 0, "creation_date": 1554359407, "post_id": 55492317, "comment_id": 97723665, "body": "Just need to re-write the <code>strlen()</code> function."}], "tags": [], "owner": {"reputation": 81, "user_id": 11061405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f2a40681b8f7f5ec2119ec5b876b720?s=128&d=identicon&r=PG&f=1", "display_name": "oWWo", "link": "https://stackoverflow.com/users/11061405/owwo"}, "is_accepted": false, "score": 2, "last_activity_date": 1554359448, "last_edit_date": 1554359448, "creation_date": 1554285506, "answer_id": 55492317, "question_id": 55490065, "link": "https://stackoverflow.com/questions/55490065/how-do-i-add-two-large-non-negative-integers-using-char-array-in-c/55492317#55492317", "title": "How do I add two large non-negative integers using char array in C?", "body": "<p>Your function add the two integers from left to right. Try this method, It's an algorithm that add from the back to the front (Array parameters are usually degraded to pointers, So <code>char *bigN</code> is equal to <code>char bigN[]</code> here):</p>\n\n<pre><code>void AddTwoBigNumbers(char *bigN, char *bigM, char* sum)\n{\n    int add = 0;\n    int index = 0;\n    int count = 0;\n    int nbigN = strlen(bigN)-1;\n    int nbigM = strlen(bigM)-1;\n    while (nbigN &gt;= 0 || nbigM &gt;= 0)\n    {\n        int N = 0, M = 0;\n        if (nbigN &gt;= 0)\n        {\n            N = bigN[nbigN] - '0';\n            nbigN--;\n        }\n        if (nbigM &gt;= 0)\n        {\n            M = bigM[nbigM] - '0';\n            nbigM--;\n        }\n        add = N + M + count;\n        sum[index++] = add % 10 + '0';\n        count = add / 10;\n    }\n    if (count)\n        sum[index++] = count + '0';\n    sum[index] = 0;\n    int nsum = strlen(sum);\n    for (int i = 0, j = nsum - 1; i &lt; j; i++, j--)\n    {\n        char c = sum[i];\n        sum[i] = sum[j];\n        sum[j] = c;\n    }\n}\n</code></pre>\n\n<p>EDIT:</p>\n\n<pre><code>int strlen(char* buf)\n{\n    int len = 0;\n    if (buf == NULL)\n        return len;\n    while (*buf++)\n        len++;\n    return len;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 295, "user_id": 11084304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e976564aeaeb377f5e74d844f8e4cfbb?s=128&d=identicon&r=PG&f=1", "display_name": "Kira", "link": "https://stackoverflow.com/users/11084304/kira"}, "edited": false, "score": 0, "creation_date": 1554350716, "post_id": 55492419, "comment_id": 97720754, "body": "I forgot to mention that I can only use the &lt;stdio.h&gt; header for this program."}], "tags": [], "owner": {"reputation": 4703, "user_id": 5375464, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3292ca87ff6c766b75dbe4b2ea0831da?s=128&d=identicon&r=PG&f=1", "display_name": "J...S", "link": "https://stackoverflow.com/users/5375464/j-s"}, "is_accepted": false, "score": 2, "last_activity_date": 1554287362, "last_edit_date": 1554287362, "creation_date": 1554285812, "answer_id": 55492419, "question_id": 55490065, "link": "https://stackoverflow.com/questions/55490065/how-do-i-add-two-large-non-negative-integers-using-char-array-in-c/55492419#55492419", "title": "How do I add two large non-negative integers using char array in C?", "body": "<p>In the program that you posted you are considering the most significant digits first. </p>\n\n<p>Try considering the Least significant digits first and then work your way towards the more significant digits.</p>\n\n<p>Take into account the carry values that may be generated and add them to the next set of values and reset the value of carry accordingly.</p>\n\n<p>Bear in mind that the numbers are being treated as characters. Subtract <code>'0'</code> from the character when you need the integer value and convert them back to character form by adding <code>'0'</code>.</p>\n\n<p>Adjust for cases where the lengths of <code>bigM</code> and <code>bigN</code> are not the same as well.</p>\n\n<p>If all digits of <code>bigM</code> are over use the values of <code>bigN</code> and carry value, if any, to calculate all the remaining digits of <code>sum</code> and the other way around.</p>\n\n<p>And finally, after all the digits of both the input numbers are exhausted, check if there is any carry remaining and add that to <code>sum</code> as well.</p>\n\n<p>You may calculate and insert values to <code>sum</code> in the reverse fashion and reverse the string later if you like.</p>\n\n<p>Don't forget to nul (<code>'\\0'</code>) terminate <code>sum</code> at the end.</p>\n\n<hr>\n\n<p>You could do something like</p>\n\n<pre><code>void AddTwoBigNumbers(char bigN[], char bigM[], char sum[])\n{\n    int i=strlen(bigM)-1, j=strlen(bigN)-1, k, carry=0;\n    for(k=0; i&gt;=0 &amp;&amp; j&gt;=0; --i, --j, ++k)\n    {\n        sum[k] = (bigM[i]-'0' + bigN[j]-'0' + carry)%10 + '0';\n        carry = (bigM[i]-'0' + bigN[j]-'0' + carry)/10;\n    }\n\n    for(; i&gt;=0; --i, ++k)\n    {\n        sum[k] = (bigM[i]-'0' + carry)%10 + '0'; \n        carry = (bigM[i]-'0' + carry)/10;\n    }\n    for(; j&gt;=0; --j, ++k)\n    {\n        sum[k] = (bigN[j]-'0' + carry)%10 + '0'; \n        carry = (bigN[j]-'0' + carry)/10;\n    }\n    if(carry!=0)\n    {\n        sum[k++]=carry+'0';\n    }\n    sum[k]=0;\n\n    //Reversing string\n    for(int t=0; t&lt;n/2; ++t)\n    {\n        char temp=sum[t];\n        sum[t]=sum[n-1-t];\n        sum[n-1-t]=temp;\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 295, "user_id": 11084304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e976564aeaeb377f5e74d844f8e4cfbb?s=128&d=identicon&r=PG&f=1", "display_name": "Kira", "link": "https://stackoverflow.com/users/11084304/kira"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1121, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1554359448, "creation_date": 1554278853, "last_edit_date": 1554306339, "question_id": 55490065, "link": "https://stackoverflow.com/questions/55490065/how-do-i-add-two-large-non-negative-integers-using-char-array-in-c", "title": "How do I add two large non-negative integers using char array in C?", "body": "<p>I am making a program to add two large non-negative integers (each large integer contains at most 100 digits). In my program, however, it is giving out wrong outputs for most cases. </p>\n\n<p>I've completed the <code>main()</code> function, but I believe the problem with my code is within the <code>AddTwoBigNumbers()</code> function.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nconst int MAX_INT_LENGTH = 100;\n\nvoid AddTwoBigNumbers(char bigN[], char bigM[], char sum[]) {\n    int i = 0;\n    int index = 0;\n    int count = 0;\n    int index2 = 0;\n    while (1) {\n        int sum1 = count;\n        if (bigM[index]) {\n            sum1 += bigM[index] - '0';\n            index++;\n        }\n        if (bigN[index2]) {\n            sum1 += bigN[index2] - '0';\n            index2++;\n        }\n        sum[i] = sum1 % 10 + '0';\n        i++;\n        count = sum1 / 10;\n        if (bigM[index] == 0 &amp;&amp; bigN[index2] == 0) {\n            break;\n        }\n    }\n    if (count) {\n        sum[i] = count + '0';\n        i++;\n    }\n    sum[i] = 0;\n\n    int x, len = 0;\n    for (x = 0; sum[x]; ++x) {\n        ++len;\n    }\n\n    for (x = 0; x &lt; len / 2; ++x) {\n        sum[len] = sum[x];\n        sum[x] = sum[len - x - 1];\n        sum[len - x - 1] = sum[len];\n    }\n}\n\nint main() {\n    char bignum[2][MAX_INT_LENGTH]; // bignum[0] and bignum[1] are to store the digits of the two input number\n    char sum[MAX_INT_LENGTH + 1];     // to store the sum of the two big numbers\n\n    // read in two numbers\n    scanf(\"%s\", bignum[0]);\n    scanf(\"%s\", bignum[1]);\n\n    // calculate sum of the two numbers\n    AddTwoBigNumbers(bignum[0], bignum[1], sum);\n\n    // display the sum on screen\n    printf(\"%s\\n\", sum);\n\n    return 0;\n}\n</code></pre>\n\n<p>Sample cases are as follows:</p>\n\n<p>Input:</p>\n\n<pre><code>1\n999999999999999999999999999\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>1000000000000000000000000000\n</code></pre>\n\n<p>My output:</p>\n\n<pre><code>1000000000000000000000000000\n</code></pre>\n\n<p>Input:</p>\n\n<pre><code>999999999999999999999999999\n999999999999999999999999999\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>1999999999999999999999999998\n</code></pre>\n\n<p>My output:</p>\n\n<pre><code>1999999999999999999999999989\n</code></pre>\n"}, {"tags": ["c", "pointers", "strtok"], "comments": [{"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 2, "creation_date": 1554277822, "post_id": 55489646, "comment_id": 97687204, "body": "<code>strtok_r()</code> changes its input string in such a way that you cannot reuse it in a loop (<code>&quot;foo bar&quot;</code> ==&gt; <code>&quot;foo\\0bar&quot;</code>). Inside the loop copy <code>argv[i]</code> and use the copy instead."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1554280367, "post_id": 55489646, "comment_id": 97688682, "body": "If your school is teaching you to use conio.h, consider dropping out."}], "answers": [{"tags": [], "owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "is_accepted": false, "score": 0, "last_activity_date": 1554280503, "last_edit_date": 1554280503, "creation_date": 1554280091, "answer_id": 55490489, "question_id": 55489646, "link": "https://stackoverflow.com/questions/55489646/swap-words-in-sentence-in-c/55490489#55490489", "title": "Swap words in sentence in &quot;C&quot;", "body": "<p>As said i a remark <code>strtok_r</code> modify its first argument, you need to first save the words from <em>argv</em></p>\n\n<p>I also encourage you to not modify the <em>argv</em>, and to check the arguments are correct checking the result of <code>strtok</code> or <code>strtok_r</code></p>\n\n<hr>\n\n<p>You can do for instance :</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main(int argc, char *argv[])\n{\n  char ** first = malloc((argc - 1) * sizeof(char *));\n  char ** second = malloc((argc - 1) * sizeof(char *));\n  int i;\n\n  for (i = 1; i != argc; ++i) {\n    char * s = strdup(argv[i]);\n\n    if (((first[i - 1] = strtok(s, \"/\")) == NULL) ||\n        ((second[i - 1] = strtok(NULL, \"/\")) == NULL)) {\n      fprintf(stderr, \"invalid argument '%s'\\n\", argv[i]);\n      return -1;\n    }\n    /* debug */\n    else\n      printf(\"first[%d]='%s' second[%d]='%s'\\n\", i-1, first[i-1], i-1, second[i-1]);\n\n  }\n\n  /*\n  here you read sentences and do the substitutions\n  */\n\n  /* free resources */\n  for (i = 0; i != argc - 1; ++i) {\n    free(first[i]);\n  }\n  free(first);\n  free(second);\n\n  return(0);\n}\n</code></pre>\n\n<p>Compilation and execution:</p>\n\n<pre><code>/tmp % gcc -g -pedantic -Wall -Wextra c.c\n/tmp % ./a.out hi/hello how/good no/yet\nfirst[0]='hi' second[0]='hello'\nfirst[1]='how' second[1]='good'\nfirst[2]='no' second[2]='yet'\n</code></pre>\n\n<p>Execution under <em>valgrind</em> :</p>\n\n<pre><code>/tmp % valgrind ./a.out hi/hello how/good no/yet\n==29457== Memcheck, a memory error detector\n==29457== Copyright (C) 2002-2012, and GNU GPL'd, by Julian Seward et al.\n==29457== Using Valgrind-3.8.1 and LibVEX; rerun with -h for copyright info\n==29457== Command: ./a.out hi/hello how/good no/yet\n==29457== \nfirst[0]='hi' second[0]='hello'\nfirst[1]='how' second[1]='good'\nfirst[2]='no' second[2]='yet'\n==29457== \n==29457== HEAP SUMMARY:\n==29457==     in use at exit: 0 bytes in 0 blocks\n==29457==   total heap usage: 5 allocs, 5 frees, 73 bytes allocated\n==29457== \n==29457== All heap blocks were freed -- no leaks are possible\n==29457== \n==29457== For counts of detected and suppressed errors, rerun with: -v\n==29457== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 6 from 6)\n</code></pre>\n\n<hr>\n\n<p>Note it is possible do do</p>\n\n<pre><code>  char * first[argc - 1];\n  char * second[argc - 1];\n</code></pre>\n\n<p>rather that to allocate <em>first</em> and <em>second</em> in the heap, but there arrays have an unknown size in the stack at compile time and I encourage you to not use that way</p>\n"}], "owner": {"reputation": 45, "user_id": 10618241, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-B42rtqssdjs/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbDFoSnpsn_I2TT6R7IWbhbr7EVm_w/mo/photo.jpg?sz=128", "display_name": "Luk&#225;\u0161 Haspr&#250;n", "link": "https://stackoverflow.com/users/10618241/luk%c3%a1%c5%a1-haspr%c3%ban"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1324, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1554281655, "creation_date": 1554277366, "last_edit_date": 1554281655, "question_id": 55489646, "link": "https://stackoverflow.com/questions/55489646/swap-words-in-sentence-in-c", "title": "Swap words in sentence in &quot;C&quot;", "body": "<p>I've got an assignment from school in which I have to make a project which takes arguments from CMD, every argument has two words in it separated by <code>/</code>, we then insert the sentence and the program should find all occurrences of the first word and replace it with the second, I'm just trying to make it work using <code>strtok_r</code>. </p>\n\n<p>Here is my code:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;conio.h&gt;\n\nint main(int args, char *argv[]) {\n    char *token;\n    char *token2;\n    char veta[1000];\n    int i, j, k;\n    int err;\n    char *saveptr1, *saveptr2;\n\n    if (fgets(veta, 1000, stdin)) {\n        token = strtok_r(veta, \" \\n\", &amp;saveptr1);\n        k = 1;\n        while (token != NULL) {\n            printf(\"Cycle %d: \\n\", k++);\n            printf(\"%s\\n\", token);\n            for (i = 1; i &lt; args; i++) {\n                token2 = strtok_r(argv[i], \"/\", &amp;saveptr2);\n                printf(\"%s \", token2);\n                token2 = strtok_r(NULL, \"/\", &amp;saveptr2);    \n                printf(\"%s \\n\", token2);\n            }   \n            token = strtok_r(NULL, \" \\n\", &amp;saveptr1);\n        }   \n    }\n    return(0);\n}\n</code></pre>\n\n<p>when I type arguments into the CMD and insert sentence with for example four words, 4 cycles are executed but the output is not as I want it to be... For example when I give these arguments : <code>hi/hello how/good no/yet</code> and insert sentence the output is: </p>\n\n<pre><code>Cycle1: \n(first word of sentence)\nhi hello\nhow good\nno yet\nCycle4: \n(second word of sentence)\nhi (null)\nhow (null)\nno (null)\nCycle4: \n(third word of sentence)\nhi (null)\nhow (null)\nno (null)\nCycle4: \n(fourth word of sentence)\nhi (null)\nhow (null)\nno (null)\n</code></pre>\n\n<p>when it should be this:</p>\n\n<pre><code>Cycle1: \n(first word of sentence)\nhi hello\nhow good\nno yet\nCycle4: \n(second word of sentence)\nhi hello\nhow good\nno yet\nCycle4: \n(third word of sentence)\nhi hello\nhow good\nno yet\nCycle4: \n(fourth word of sentence)\nhi hello\nhow good\nno yet\n</code></pre>\n\n<p>I may not be able to fix it, can you help me?</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["c", "valgrind", "fftw"], "answers": [{"comments": [{"owner": {"reputation": 331, "user_id": 5265303, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0d8925719ed62d72c967f95a12577e90?s=128&d=identicon&r=PG&f=1", "display_name": "lock", "link": "https://stackoverflow.com/users/5265303/lock"}, "edited": false, "score": 0, "creation_date": 1554318538, "post_id": 55501322, "comment_id": 97711445, "body": "Thank you. I did follow your recommendation. However memory error is always here and the final image is not exactly like the original one. But if I choose the Regular view, it is ok. Is there an error in change_symmetry?"}, {"owner": {"reputation": 8727, "user_id": 2999346, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dQ1wB.png?s=128&g=1", "display_name": "francis", "link": "https://stackoverflow.com/users/2999346/francis"}, "reply_to_user": {"reputation": 331, "user_id": 5265303, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0d8925719ed62d72c967f95a12577e90?s=128&d=identicon&r=PG&f=1", "display_name": "lock", "link": "https://stackoverflow.com/users/5265303/lock"}, "edited": false, "score": 0, "creation_date": 1554323698, "post_id": 55501322, "comment_id": 97713913, "body": "You&#39;re welcome! You can try to apply <code>change_symmetry()</code> twice, something like <code>change_symmetry(fit, i, j, &amp;x, &amp;y);change_symmetry(fit, x, y, &amp;ii, &amp;jj);</code> and test for differences <code>if(ii !=  i || jj!= j){...}</code> and test for bound infrigments <code>if(x&gt;=width){...}</code> This function looks right, but it mixes unsigned and signed integers."}, {"owner": {"reputation": 331, "user_id": 5265303, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0d8925719ed62d72c967f95a12577e90?s=128&d=identicon&r=PG&f=1", "display_name": "lock", "link": "https://stackoverflow.com/users/5265303/lock"}, "edited": false, "score": 0, "creation_date": 1554327763, "post_id": 55501322, "comment_id": 97715443, "body": "Ok thanks. One question though: when my input image is non square. What is the best way to make padding  ?  I&#39;m wondering if my issue is not because of it."}, {"owner": {"reputation": 8727, "user_id": 2999346, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dQ1wB.png?s=128&g=1", "display_name": "francis", "link": "https://stackoverflow.com/users/2999346/francis"}, "reply_to_user": {"reputation": 331, "user_id": 5265303, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0d8925719ed62d72c967f95a12577e90?s=128&d=identicon&r=PG&f=1", "display_name": "lock", "link": "https://stackoverflow.com/users/5265303/lock"}, "edited": false, "score": 0, "creation_date": 1554329558, "post_id": 55501322, "comment_id": 97716058, "body": "The inverse DFT of the DFT of the padded image is to be identical to the padded image. Nevertheless, padding likely affect the computed magnitude and phases. If an uniform image is padded with zeros, spurous frequencies appears due to the artificial discontinuity on the padded image. If you are interrested by the magnitude of the different frequencies, <a href=\"https://en.wikipedia.org/wiki/Window_function\" rel=\"nofollow noreferrer\">applying a 2D window</a> such as the Tukey window could limit the consequences of <a href=\"https://en.wikipedia.org/wiki/Spectral_leakage\" rel=\"nofollow noreferrer\">spectral leakage</a>."}, {"owner": {"reputation": 8727, "user_id": 2999346, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dQ1wB.png?s=128&g=1", "display_name": "francis", "link": "https://stackoverflow.com/users/2999346/francis"}, "reply_to_user": {"reputation": 331, "user_id": 5265303, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0d8925719ed62d72c967f95a12577e90?s=128&d=identicon&r=PG&f=1", "display_name": "lock", "link": "https://stackoverflow.com/users/5265303/lock"}, "edited": false, "score": 0, "creation_date": 1554330078, "post_id": 55501322, "comment_id": 97716217, "body": "Spectral leakage occurs as soon as the image is not a periodic pattern. If you periodize a smooth image like <a href=\"https://en.wikipedia.org/wiki/File:Grey_icon.svg\" rel=\"nofollow noreferrer\">this one</a>, the white part on top is right next the dark part near the bottom. This sharp edge induces large magnitude for high frequencies. A 2D window would smoothly turn all edges to dark and avoid such sharp edges."}, {"owner": {"reputation": 331, "user_id": 5265303, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0d8925719ed62d72c967f95a12577e90?s=128&d=identicon&r=PG&f=1", "display_name": "lock", "link": "https://stackoverflow.com/users/5265303/lock"}, "edited": false, "score": 0, "creation_date": 1554364174, "post_id": 55501322, "comment_id": 97726188, "body": "Many thanks for your explanation. Can I work with non square image and get a non square magnitude image ? It seems ok with Octave but not with my code."}, {"owner": {"reputation": 331, "user_id": 5265303, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0d8925719ed62d72c967f95a12577e90?s=128&d=identicon&r=PG&f=1", "display_name": "lock", "link": "https://stackoverflow.com/users/5265303/lock"}, "edited": false, "score": 0, "creation_date": 1554365549, "post_id": 55501322, "comment_id": 97726977, "body": "no more valgrind error but always my issue in centered FFT"}, {"owner": {"reputation": 8727, "user_id": 2999346, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dQ1wB.png?s=128&g=1", "display_name": "francis", "link": "https://stackoverflow.com/users/2999346/francis"}, "reply_to_user": {"reputation": 331, "user_id": 5265303, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0d8925719ed62d72c967f95a12577e90?s=128&d=identicon&r=PG&f=1", "display_name": "lock", "link": "https://stackoverflow.com/users/5265303/lock"}, "edited": false, "score": 0, "creation_date": 1554389988, "post_id": 55501322, "comment_id": 97742900, "body": "Thanks for the images. Indeed, you don&#39;t have to pad the image to perform the treatment and the magnitude will not be impaired by spectral leakage as your image decreases to zero near all boundaries.  It looks like the mean value is ok, the high frequencies are ok, but low frequencies are cleared or reduced. It could be triggered by an overflow here <code>abuf[i] = round_to_WORD((modulus[i] &#47; w &#47; h));</code>. Despite the scaling by w*h, the first frequencies likely display magnitudes higher than <code>USHRT_MAX_DOUBLE</code>."}, {"owner": {"reputation": 331, "user_id": 5265303, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0d8925719ed62d72c967f95a12577e90?s=128&d=identicon&r=PG&f=1", "display_name": "lock", "link": "https://stackoverflow.com/users/5265303/lock"}, "edited": false, "score": 0, "creation_date": 1554390676, "post_id": 55501322, "comment_id": 97743378, "body": "My image dimension is 569x261 pixels. If I crop one pixel to have 568x260 pixels it works .... Do you understand why ? Again, with no &quot;centering&quot; it works all the time"}, {"owner": {"reputation": 8727, "user_id": 2999346, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dQ1wB.png?s=128&g=1", "display_name": "francis", "link": "https://stackoverflow.com/users/2999346/francis"}, "reply_to_user": {"reputation": 331, "user_id": 5265303, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0d8925719ed62d72c967f95a12577e90?s=128&d=identicon&r=PG&f=1", "display_name": "lock", "link": "https://stackoverflow.com/users/5265303/lock"}, "edited": false, "score": 0, "creation_date": 1554391854, "post_id": 55501322, "comment_id": 97744130, "body": "Indeed, if you do what <code>change_symmetry</code> does for odd number like 7,  the index 3 is affected twice and index 6 is never affected... The shift must be identical for all frequencies, it is +width/2-width if above width. It&#39;s different from -width/2 for odd numbers! And the reverse shift is not identical to the forward shift for odd numbers, because width/2+width/2 !=width  !!!"}, {"owner": {"reputation": 331, "user_id": 5265303, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0d8925719ed62d72c967f95a12577e90?s=128&d=identicon&r=PG&f=1", "display_name": "lock", "link": "https://stackoverflow.com/users/5265303/lock"}, "edited": false, "score": 0, "creation_date": 1554394518, "post_id": 55501322, "comment_id": 97745700, "body": "Any idea of what I can do ?"}, {"owner": {"reputation": 8727, "user_id": 2999346, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dQ1wB.png?s=128&g=1", "display_name": "francis", "link": "https://stackoverflow.com/users/2999346/francis"}, "reply_to_user": {"reputation": 331, "user_id": 5265303, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0d8925719ed62d72c967f95a12577e90?s=128&d=identicon&r=PG&f=1", "display_name": "lock", "link": "https://stackoverflow.com/users/5265303/lock"}, "edited": false, "score": 0, "creation_date": 1554394749, "post_id": 55501322, "comment_id": 97745812, "body": "I added to the answer an hint showing how it could be implemented."}, {"owner": {"reputation": 331, "user_id": 5265303, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0d8925719ed62d72c967f95a12577e90?s=128&d=identicon&r=PG&f=1", "display_name": "lock", "link": "https://stackoverflow.com/users/5265303/lock"}, "edited": false, "score": 0, "creation_date": 1554396203, "post_id": 55501322, "comment_id": 97746583, "body": "Last question. Do you think my normalisation is bad and lead to overflow as you said before ? should I normalize by the max value of frequency ?"}, {"owner": {"reputation": 8727, "user_id": 2999346, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dQ1wB.png?s=128&g=1", "display_name": "francis", "link": "https://stackoverflow.com/users/2999346/francis"}, "reply_to_user": {"reputation": 331, "user_id": 5265303, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0d8925719ed62d72c967f95a12577e90?s=128&d=identicon&r=PG&f=1", "display_name": "lock", "link": "https://stackoverflow.com/users/5265303/lock"}, "edited": false, "score": 0, "creation_date": 1554397637, "post_id": 55501322, "comment_id": 97747265, "body": "The overflow is possible, take a look at <code>cos(x)-0.2*cos(3*x)</code> for instance. This function remains strickly between -1 and 1, but its first frequency is of magniude 1.Indeed, normalizing by the max amplitude solves it and improves the accuracy, but the normalization factor is to be stored somewhere."}], "tags": [], "owner": {"reputation": 8727, "user_id": 2999346, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dQ1wB.png?s=128&g=1", "display_name": "francis", "link": "https://stackoverflow.com/users/2999346/francis"}, "is_accepted": true, "score": 2, "last_activity_date": 1554394689, "last_edit_date": 1592644375, "creation_date": 1554313842, "answer_id": 55501322, "question_id": 55489620, "link": "https://stackoverflow.com/questions/55489620/cannot-retrieve-original-image-using-fft-with-fftw/55501322#55501322", "title": "Cannot retrieve original image using FFT with FFTW", "body": "<p>The plan is created using the flag <code>FFTW_MEASURE</code>. Hence, several DFT are computed and the input array is likely overwritten. Here is the start of the description of planner flags in the <a href=\"http://www.fftw.org/fftw3_doc/Planner-Flags.html\" rel=\"nofollow noreferrer\">documentation of FFTW</a>:</p>\n<blockquote>\n<ul>\n<li><p><code>FFTW_ESTIMATE</code> specifies that, instead of actual measurements of different algorithms, a simple heuristic is used to pick a (probably sub-optimal) plan quickly. <strong>With this flag, the input/output arrays are not overwritten during planning.</strong></p>\n</li>\n<li><p><code>FFTW_MEASURE</code> tells FFTW to find an optimized plan by actually computing several FFTs and measuring their execution time. Depending on your machine, this can take some time (often a few seconds). FFTW_MEASURE is the default planning option.</p>\n</li>\n</ul>\n</blockquote>\n<p>Either switch to <code>FFTW_ESTIMATE</code> or create the plan before populating the input array:</p>\n<pre><code>/* we run the Fourier Transform */\nfftw_plan p = fftw_plan_dft_2d(width, height, spatial_repr, frequency_repr,\n        FFTW_FORWARD, FFTW_MEASURE);\n\n/* copying image selection into the fftw data */\n#ifdef _OPENMP\n#pragma omp parallel for num_threads(com.max_thread) private(i) schedule(static) if(nbdata &gt; 15000)\n#endif\nfor (i = 0; i &lt; nbdata; i++) {\n    spatial_repr[i] = (double) gbuf[i];\n}\n</code></pre>\n<p>If you intend to a single image, using <code>FFTW_ESTIMATE</code> is the way to go. On the contrary, if you consider treating multiple images, creating the plan once using <code>FFTW_MEASURE</code> and storing it is a good option. Then you may use <a href=\"http://www.fftw.org/fftw3_doc/New_002darray-Execute-Functions.html#New_002darray-Execute-Functions\" rel=\"nofollow noreferrer\">New-array Execute Functions</a> each time a FFT is to be performed:</p>\n<pre><code>fftw_execute_dft(p, spatial_repr, frequency_repr);\n</code></pre>\n<p>You can test the return value of <code>malloc()</code> or <code>fftw_malloc()</code> to check if the allocations went right. If not, it returns <code>NULL</code>. <code>fftw_malloc()</code> is implemented as function <code>*X(kernel_malloc)(size_t n)</code> in fftw-3.3.6-pl2/kernel/kalloc.c . It calls functions like <a href=\"https://linux.die.net/man/3/memalign\" rel=\"nofollow noreferrer\"><code>memalign()</code></a> or <a href=\"https://docs.microsoft.com/fr-fr/cpp/c-runtime-library/reference/aligned-malloc?view=vs-2019\" rel=\"nofollow noreferrer\"><code>_aligned_malloc()</code></a> among others. Both these two return <code>NULL</code> just like <code>malloc()</code> in case of failure. Finally, I did not spotted a critical issue regarding memory allocation of deallocation in the piece of code you provided.</p>\n<p>The argument <code>double nbdata</code> in <code>fft_to_spectra()</code> should likely be an integer. Valgrind might have considered it as strange...</p>\n<p>EDIT : the <code>change_symmetry()</code> is to be modified for odd sizes. Something like:</p>\n<pre><code>void change_symmetry_forward(unsigned int width, unsigned int height, unsigned int i, unsigned int j, unsigned int *x,\n    unsigned int *y) {\n     *x = i + width / 2;\n     if (*x&gt;=width){\n           *x=*x-width;\n     }\n     *y = j + height / 2;\n     if(*y&gt;=height){\n          *y =*y-height;\n     }\n}\n</code></pre>\n<p>and</p>\n<pre><code>void change_symmetry_backward(unsigned int width, unsigned int height, unsigned int i, unsigned int j, unsigned int *x,\n    unsigned int *y) {\n     *x = i +width- width / 2;\n     if (*x&gt;=width){\n           *x=*x-width;\n     }\n     *y = j +height- height / 2;\n     if(*y&gt;=height){\n          *y =*y-height;\n     }\n}\n</code></pre>\n"}], "owner": {"reputation": 331, "user_id": 5265303, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0d8925719ed62d72c967f95a12577e90?s=128&d=identicon&r=PG&f=1", "display_name": "lock", "link": "https://stackoverflow.com/users/5265303/lock"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 175, "favorite_count": 0, "accepted_answer_id": 55501322, "answer_count": 1, "score": 2, "last_activity_date": 1554394689, "creation_date": 1554277283, "last_edit_date": 1554385622, "question_id": 55489620, "link": "https://stackoverflow.com/questions/55489620/cannot-retrieve-original-image-using-fft-with-fftw", "title": "Cannot retrieve original image using FFT with FFTW", "body": "<p>I'm using FFTW in my C code and I have some issue.\nFirst, I can transform an original image to two images (mag+phase) and get back the original image with the inverse transform.\nHowever, If I want to get a mag file centered in frequency it does not work anymore: the final image has some issues.</p>\n\n<p>Here some pieces of my code. Can someone help me to find the error in my code?</p>\n\n<p>EDIT: I've fixed the code to follow @francis recommandation, but my issues is always here.</p>\n\n<pre><code>\nenum {\n    TYPE_CENTERED,\n    TYPE_REGULAR\n};\n\nstatic void fft_to_spectra(fits* fit, fftw_complex *frequency_repr, double *as,\n        double *ps, int nbdata) {\n    unsigned int i;\n\n    for (i = 0; i &lt; nbdata; i++) {\n        double r = creal(frequency_repr[i]);\n        double im = cimag(frequency_repr[i]);\n        as[i] = hypot(r, im);\n        ps[i] = atan2(im, r);\n    }\n}\n\nstatic void fft_to_freq(fits* fit, fftw_complex *frequency_repr, double *as, double *ps, int nbdata) {\n    unsigned int i;\n\n    for (i = 0; i &lt; nbdata; i++) {\n        frequency_repr[i] = as[i] * (cos(ps[i]) + I * sin(ps[i]));\n    }\n}\n\nvoid change_symmetry(unsigned int width, unsigned int height, unsigned int i, unsigned int j, unsigned int *x,\n        unsigned int *y) {\n\n    if (i &lt; width / 2 &amp;&amp; j &lt; height / 2) {\n        *x = i + width / 2;\n        *y = j + height / 2;\n    }\n    if (i &gt;= width / 2 &amp;&amp; j &lt; height / 2) {\n        *x = i - width / 2;\n        *y = j + height / 2;\n    }\n    if (i &lt; width / 2 &amp;&amp; j &gt;= height / 2) {\n        *x = i + width / 2;\n        *y = j - height / 2;\n    }\n    if (i &gt;= width / 2 &amp;&amp; j &gt;= height / 2) {\n        *x = i - width / 2;\n        *y = j - height / 2;\n    }\n}\n\nstatic void centered(WORD *buf, unsigned int width,\n        unsigned int height) {\n    unsigned int i, j;\n\n    WORD *temp = malloc(width * height * sizeof(WORD));\n    for (j = 0; j &lt; height; j++) {\n        for (i = 0; i &lt; width; i++) {\n            unsigned int x = i;\n            unsigned int y = j;\n            change_symmetry(width, height, i, j, &amp;x, &amp;y);\n\n            temp[j * width + i] = buf[y * width + x];\n        }\n    }\n\n    memcpy(buf, temp, sizeof(WORD) * width * height);\n    free(temp);\n}\n\nstatic void normalisation_spectra(unsigned int w, unsigned int h, double *modulus, double *phase,\n        WORD *abuf, WORD *pbuf) {\n    unsigned int i;\n\n    for (i = 0; i &lt; h * w; i++) {\n        pbuf[i] = round_to_WORD(((phase[i] + M_PI) * USHRT_MAX_DOUBLE / (2 * M_PI)));\n        abuf[i] = round_to_WORD((modulus[i] / w / h));\n    }\n}\n\nstatic void save_dft_information_in_gfit(fits *fit) {\n    strcpy(gfit.dft.ord, fit-&gt;dft.type);\n    strcpy(gfit.dft.ord, fit-&gt;dft.ord);\n}\n\nstatic void FFTD(fits *fit, fits *x, fits *y, int type_order, int layer) {\n    WORD *xbuf = x-&gt;pdata[layer];\n    WORD *ybuf = y-&gt;pdata[layer];\n    WORD *gbuf = fit-&gt;pdata[layer];\n    unsigned int i;\n    unsigned int width = fit-&gt;rx, height = fit-&gt;ry;\n    int nbdata = width * height;\n\n    fftw_complex *spatial_repr = fftw_malloc(sizeof(fftw_complex) * nbdata);\n    if (!spatial_repr) {\n        return;\n    }\n    fftw_complex *frequency_repr = fftw_malloc(sizeof(fftw_complex) * nbdata);\n    if (!frequency_repr) {\n        fftw_free(spatial_repr);\n        return;\n    }\n\n    /* copying image selection into the fftw data */\n#ifdef _OPENMP\n#pragma omp parallel for num_threads(com.max_thread) private(i) schedule(static) if(nbdata &gt; 15000)\n#endif\n    for (i = 0; i &lt; nbdata; i++) {\n        spatial_repr[i] = (double) gbuf[i];\n    }\n\n    /* we run the Fourier Transform */\n    fftw_plan p = fftw_plan_dft_2d(height, width, spatial_repr, frequency_repr,\n            FFTW_FORWARD, FFTW_ESTIMATE);\n    fftw_execute(p);\n\n    /* we compute modulus and phase */\n    double *modulus = malloc(nbdata * sizeof(double));\n    double *phase = malloc(nbdata * sizeof(double));\n\n    fft_to_spectra(fit, frequency_repr, modulus, phase, nbdata);\n\n    //We normalize the modulus and the phase\n    normalisation_spectra(width, height, modulus, phase, xbuf, ybuf);\n    if (type_order == TYPE_CENTERED) {\n        strcpy(x-&gt;dft.ord, \"CENTERED\");\n        centered(xbuf, width, height);\n        centered(ybuf, width, height);\n    }\n\n    free(modulus);\n    free(phase);\n    fftw_destroy_plan(p);\n    fftw_free(spatial_repr);\n    fftw_free(frequency_repr);\n}\n\nstatic void FFTI(fits *fit, fits *xfit, fits *yfit, int type_order, int layer) {\n    WORD *xbuf = xfit-&gt;pdata[layer];\n    WORD *ybuf = yfit-&gt;pdata[layer];\n    WORD *gbuf = fit-&gt;pdata[layer];\n    unsigned int i;\n    unsigned int width = xfit-&gt;rx;\n    unsigned int height = xfit-&gt;ry;\n    int nbdata = width * height;\n\n    double *modulus = calloc(1, nbdata * sizeof(double));\n    double *phase = calloc(1, nbdata * sizeof(double));\n\n    if (type_order == TYPE_CENTERED) {\n        centered(xbuf, width, height);\n        centered(ybuf, width, height);\n    }\n\n    for (i = 0; i &lt; height * width; i++) {\n        modulus[i] = (double) xbuf[i] * (width * height);\n        phase[i] = (double) ybuf[i] * (2 * M_PI / USHRT_MAX_DOUBLE);\n        phase[i] -= M_PI;\n    }\n\n    fftw_complex* spatial_repr = fftw_malloc(sizeof(fftw_complex) * nbdata);\n    if (!spatial_repr) {\n        return;\n    }\n\n    fftw_complex* frequency_repr = fftw_malloc(sizeof(fftw_complex) * nbdata);\n    if (!frequency_repr) {\n        fftw_free(spatial_repr);\n        return;\n    }\n\n    fft_to_freq(fit, frequency_repr, modulus, phase, nbdata);\n\n    fftw_plan p = fftw_plan_dft_2d(height, width, frequency_repr, spatial_repr,\n            FFTW_BACKWARD, FFTW_ESTIMATE);\n    fftw_execute(p);\n\n    for (i = 0; i &lt; nbdata; i++) {\n        double pxl = creal(spatial_repr[i]) / nbdata;\n        gbuf[i] = round_to_WORD(pxl);\n    }\n\n    free(modulus);\n    free(phase);\n    fftw_destroy_plan(p);\n    fftw_free(spatial_repr);\n    fftw_free(frequency_repr);\n}\n</code></pre>\n\n<p>Here my images, the original one and the FFTD(centered)->FFTI result\n<a href=\"https://i.stack.imgur.com/IK3kF.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/IK3kF.png\" alt=\"enter image description here\"></a>\n<a href=\"https://i.stack.imgur.com/Uef6X.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Uef6X.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c++", "c"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 3, "creation_date": 1554277340, "post_id": 55489528, "comment_id": 97686943, "body": "The standard libraries are usually highly optimized and because of that the code is convoluted and very hard to read and understand. If you want to learn the principals behind the functions, try to find an idealized and clear implementation that shows the principles instead."}, {"owner": {"reputation": 486140, "user_id": 1187415, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/LpTRB.png?s=128&g=1", "display_name": "Martin R", "link": "https://stackoverflow.com/users/1187415/martin-r"}, "edited": false, "score": 1, "creation_date": 1554277341, "post_id": 55489528, "comment_id": 97686944, "body": "Compare <a href=\"https://stackoverflow.com/questions/49048673/where-are-the-vs2015-ucrt-source-files\">Where are the VS2015 UCRT Source files?</a>"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 4, "creation_date": 1554277432, "post_id": 55489528, "comment_id": 97687001, "body": "As for your problem, create a program that uses the function. Make a debug build, and use the debugger to step into the function. For Visual Studio that should take you to the source (if it&#39;s installed, which it usually is)."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1554278937, "post_id": 55489528, "comment_id": 97687854, "body": "@Jeff: you need to understand that a compiler and an IDE are two very different things."}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 10688541, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-GAid4jF4XHs/AAAAAAAAAAI/AAAAAAAAAAg/FpIUCoVICQY/photo.jpg?sz=128", "display_name": "Jeff_", "link": "https://stackoverflow.com/users/10688541/jeff"}, "edited": false, "score": 0, "creation_date": 1554278501, "post_id": 55489624, "comment_id": 97687601, "body": "Thank you brother, I thought I could use the IDE directly to save the trouble in the root directory. It seems that I need to understand the relationship between IDE and source code, how to implement the compilation process."}], "tags": [], "owner": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "is_accepted": false, "score": 2, "last_activity_date": 1554277294, "creation_date": 1554277294, "answer_id": 55489624, "question_id": 55489528, "link": "https://stackoverflow.com/questions/55489528/can-the-ide-directly-read-the-c-library-source-code-how-to-find-the-source-code/55489624#55489624", "title": "Can the IDE directly read the C library source code? How to find the source code needed", "body": "<p>Most library functions are visible to your project just as prototypes, as they have been already compiled into a static (or dynamic) library. As far as functionality is concerned, the compiler could ship without those sources, as they are not necessary to compile your program. It's pretty much the same e.g. for OS APIs: you invoke them all the time, but you don't have the Windows sources. </p>\n\n<p>On the other hand, Visual C++ traditionally shipped with the sources of (most of) its C runtime to aid debugging; they are usually found somewhere under your VC++ installation directory.</p>\n\n<p><em>edit</em> better indications in <a href=\"https://stackoverflow.com/questions/49048673/where-are-the-vs2015-ucrt-source-files\">this answer</a>; thanks <em>@Martin R</em> for digging it out </p>\n"}, {"tags": [], "owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "is_accepted": true, "score": 2, "last_activity_date": 1554277308, "creation_date": 1554277308, "answer_id": 55489629, "question_id": 55489528, "link": "https://stackoverflow.com/questions/55489528/can-the-ide-directly-read-the-c-library-source-code-how-to-find-the-source-code/55489629#55489629", "title": "Can the IDE directly read the C library source code? How to find the source code needed", "body": "<p>In general, for C, no.</p>\n\n<p>C code can be shipped in pre-compiled form, when you get:</p>\n\n<ul>\n<li>A header file (<code>mylibrary.h</code>) that provides declarations of contents of a particular module of code.</li>\n<li>A library (<code>mylibrary.lib</code>, <code>mylibrary.dll</code>, <code>mylibrary.so</code> and so on, depending on the exact type of library and the platform), this contains the code and data that are needed for the module.</li>\n</ul>\n\n<p>These two files are enough; the compiler reads the header when you <code>#include</code> it in your code, and the linker \"glues in\" the necessary code and data from the library.</p>\n\n<p>Note that there is no source code available.</p>\n\n<p>The <code>floor()</code> function is part of the C runtime library and shipped with the compiler implementation; I'm not sure whether Microsoft provides the source for theirs. Of course there are open source implementations, <a href=\"https://git.musl-libc.org/cgit/musl/tree/src/math/floor.c\" rel=\"nofollow noreferrer\">here is the code from the \"musl\" implementation of the C standard library, for instance</a>.</p>\n"}], "owner": {"reputation": 9, "user_id": 10688541, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-GAid4jF4XHs/AAAAAAAAAAI/AAAAAAAAAAg/FpIUCoVICQY/photo.jpg?sz=128", "display_name": "Jeff_", "link": "https://stackoverflow.com/users/10688541/jeff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "closed_date": 1554282724, "accepted_answer_id": 55489629, "answer_count": 2, "score": -3, "last_activity_date": 1554299019, "creation_date": 1554276980, "last_edit_date": 1554299019, "question_id": 55489528, "link": "https://stackoverflow.com/questions/55489528/can-the-ide-directly-read-the-c-library-source-code-how-to-find-the-source-code", "closed_reason": "Needs details or clarity", "title": "Can the IDE directly read the C library source code? How to find the source code needed", "body": "<p>I want to learn the source code of floor() in c Function library, so I use the  Vs quick lookup definition function to find in VS, and then </p>\n\n<p>I find that <code>_Check_return_ _ACRTIMP double    __cdecl floor(_In_ double _X);</code>   statement\u3002</p>\n\n<p>I don't know what to do next.<a href=\"https://i.stack.imgur.com/UOGrL.png\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n\n<p>Because there seems to be only a macro definition, no function definition\u3002\nIs it that I should not use the IDE to view the source code, I am a newbie\u3002</p>\n"}, {"tags": ["c", "gstreamer", "frame-rate"], "comments": [{"owner": {"reputation": 4392, "user_id": 5215131, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-2C8rv6T-3m8/AAAAAAAAAAI/AAAAAAAAAP0/ALwPPtWwxac/photo.jpg?sz=128", "display_name": "Florian Zwoch", "link": "https://stackoverflow.com/users/5215131/florian-zwoch"}, "edited": false, "score": 0, "creation_date": 1554278048, "post_id": 55489497, "comment_id": 97687340, "body": "Your sample works correct. It plays a 30 fps video as 3 fps for me. Read on however what <code>videorate</code> exactly does. It repeats or throws away frames. It does not do a frame rate conversion. So you cannot fix sync issues that way."}, {"owner": {"reputation": 21, "user_id": 11302501, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-zF2w0X6Ict4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd_6Aj2fXU2ujWEEv8KSo0krNEw1Q/mo/photo.jpg?sz=128", "display_name": "fanelena", "link": "https://stackoverflow.com/users/11302501/fanelena"}, "reply_to_user": {"reputation": 4392, "user_id": 5215131, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-2C8rv6T-3m8/AAAAAAAAAAI/AAAAAAAAAP0/ALwPPtWwxac/photo.jpg?sz=128", "display_name": "Florian Zwoch", "link": "https://stackoverflow.com/users/5215131/florian-zwoch"}, "edited": false, "score": 0, "creation_date": 1554456907, "post_id": 55489497, "comment_id": 97768016, "body": "I would like to control final output framerate rather than filtering by dropping or duplicating frames to achieve the given rate."}], "owner": {"reputation": 21, "user_id": 11302501, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-zF2w0X6Ict4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd_6Aj2fXU2ujWEEv8KSo0krNEw1Q/mo/photo.jpg?sz=128", "display_name": "fanelena", "link": "https://stackoverflow.com/users/11302501/fanelena"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 234, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1554279446, "creation_date": 1554276885, "last_edit_date": 1554279446, "question_id": 55489497, "link": "https://stackoverflow.com/questions/55489497/how-to-fix-output-framerate-in-playbin", "title": "How to fix output framerate in playbin?", "body": "<p>What I need is to use <code>gstream</code> playbin to play the video at a different frame rate than the original video framerate.\nFor example, the actual framerate of a video recorded with the camera's 30 fps setting is 30000/1001, but I would like to force play to 30 fps.</p>\n\n<pre><code>gst-launch-1.0 -v playbin uri=http://media.w3.org/2010/05/video/movie_300.mp4 video-sink=\"videorate ! capsfilter caps=video/x-raw,framerate=3000/1000 ! videoconvert ! autovideosink\"\n</code></pre>\n\n<p>I tried above thing and i can see internal framerate of videorate element path is changed to \"framerate=(fraction)3/1\"\nBut remaining elements are still keep original framerate after videorate.</p>\n\n<p>Is there a way to reset the caps of all paths or to override the framerate value of the original source when parsing?</p>\n"}, {"tags": ["c", "cortex-m", "cppcheck"], "comments": [{"owner": {"reputation": 965, "user_id": 7772356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6749606abf1529e3bf62e4ae18104d43?s=128&d=identicon&r=PG", "display_name": "AndreyKarpov", "link": "https://stackoverflow.com/users/7772356/andreykarpov"}, "edited": false, "score": 0, "creation_date": 1554299359, "post_id": 55489479, "comment_id": 97700595, "body": "Try out a more advanced static code analyzer, for example, PVS-Studio :)."}, {"owner": {"reputation": 1095, "user_id": 13501674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21c01e5dc07ebbf5f191d177303accdf?s=128&d=identicon&r=PG&f=1", "display_name": "Eric Backus", "link": "https://stackoverflow.com/users/13501674/eric-backus"}, "edited": false, "score": 0, "creation_date": 1599852977, "post_id": 55489479, "comment_id": 112914125, "body": "Must be some strange kind of incorrect configuration. I use <code>cppcheck</code> version 1.82 on Windows Subsystem for Linux (WSL) regularly, and results are 100% reproducible."}], "owner": {"reputation": 81, "user_id": 2114461, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a08f853af23259bf37df7a451a3fae5?s=128&d=identicon&r=PG", "display_name": "viper1209", "link": "https://stackoverflow.com/users/2114461/viper1209"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 111, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1554296483, "creation_date": 1554276809, "last_edit_date": 1554296483, "question_id": 55489479, "link": "https://stackoverflow.com/questions/55489479/cppcheck-is-returning-different-results-on-each-scan", "title": "Cppcheck is returning different results on each scan", "body": "<p>I'm trying to check embedded C code using Cppcheck (running on Windows 7, using GUI) but every time I click on \"Reanalyze all files\" I get different results.\nThe code is meaned to get build using GCC and running on a cortex M4 controller (STM32F4)</p>\n\n<p>I set the Paths and include paths (here only the root folder of our code, the includes are in several sub directories) and copied the global defines from our project. I tried different platforms (Windows-XX, Unix-XX, Unix-XX-Unsigned as I could not find one more fitting to cortex M4) all with the same result.</p>\n\n<p>Is this some kind of missconfiguration? I tried this with an older version about a year ago and got frustrated about the exact same error so stopped using it back then but want to give it a try again.</p>\n\n<p>Here are parts of <code>statistics.txt</code>: (all I did here is clicking \"Reanalyze all files\" over and over again)</p>\n\n<pre><code>[03.04.2019]\n1554274191556\ncppcheck-error:0\ncppcheck-warning:1\ncppcheck-style:173\ncppcheck-performance:0\ncppcheck-portability:0\n[03.04.2019]\n1554274506334\ncppcheck-error:0\ncppcheck-warning:0\ncppcheck-style:3\ncppcheck-performance:0\ncppcheck-portability:0\n[03.04.2019]\n1554274517988\ncppcheck-error:0\ncppcheck-warning:0\ncppcheck-style:25\ncppcheck-performance:0\ncppcheck-portability:0\n[03.04.2019]\n1554274520320  //not a single error found here, so nothing got logged\n[03.04.2019]\n1554274523893\ncppcheck-error:0\ncppcheck-warning:1\ncppcheck-style:3\ncppcheck-performance:0\ncppcheck-portability:0\n[03.04.2019]\n1554274524825\ncppcheck-error:0\ncppcheck-warning:2\ncppcheck-style:36\ncppcheck-performance:0\ncppcheck-portability:0\n[03.04.2019]\n1554274526116  //not a single error found here, so nothing got logged\n</code></pre>\n"}, {"tags": ["c++", "c", "msgpack"], "comments": [{"owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "edited": false, "score": 1, "creation_date": 1554277014, "post_id": 55489435, "comment_id": 97686765, "body": "<code>data</code> is the area of memory where you are going to pack your data. It&#39;s pretty fundamental to what CWPack is about so I&#39;m wondering how good your understanding of CWPack is."}, {"owner": {"reputation": 43, "user_id": 10927122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1359c961b315b6feb023c3a9d7c4b4d6?s=128&d=identicon&r=PG&f=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/10927122/mark"}, "reply_to_user": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "edited": false, "score": 0, "creation_date": 1554277566, "post_id": 55489435, "comment_id": 97687066, "body": "@john to be honest, I&#39;m rookie in topic of CWPack, and in compression of data at all."}, {"owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "edited": false, "score": 1, "creation_date": 1554277910, "post_id": 55489435, "comment_id": 97687260, "body": "Well you can see from the example that they use a buffer of twenty bytes (the <code>data</code> array) and pack four values (not variables), a string, a bool, another string and an unsigned integer into it. They then unpack the same four values and check that they are correct."}, {"owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "edited": false, "score": 1, "creation_date": 1554277993, "post_id": 55489435, "comment_id": 97687309, "body": "And also CWPack is about <i>serialization</i> not compression. If you want compression then you should look elsewhere, zlib for instance. Though sometimes serialization would be the first step before compression takes place, so they can be related. Nevertheless CWPack isn&#39;t doing any compression."}, {"owner": {"reputation": 43, "user_id": 10927122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1359c961b315b6feb023c3a9d7c4b4d6?s=128&d=identicon&r=PG&f=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/10927122/mark"}, "reply_to_user": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "edited": false, "score": 0, "creation_date": 1554279386, "post_id": 55489435, "comment_id": 97688124, "body": "@john now everything starts making sense. thanks!"}, {"owner": {"reputation": 43, "user_id": 10927122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1359c961b315b6feb023c3a9d7c4b4d6?s=128&d=identicon&r=PG&f=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/10927122/mark"}, "reply_to_user": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "edited": false, "score": 0, "creation_date": 1554290623, "post_id": 55489435, "comment_id": 97694963, "body": "@john make your comment as an answer so I will be able to mark it as solved problem"}], "owner": {"reputation": 43, "user_id": 10927122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1359c961b315b6feb023c3a9d7c4b4d6?s=128&d=identicon&r=PG&f=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/10927122/mark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1554276667, "creation_date": 1554276667, "question_id": 55489435, "link": "https://stackoverflow.com/questions/55489435/cwpack-what-is-a-data-in-cw-pack-context-init", "title": "CWPack - What is a &quot;data&quot; in cw_pack_context_init?", "body": "<p>I want to implement CWPack in my project, and I have hard time to understand it. If I understand it well, I have to make my variables to be cw_pack variables, and of course then make my functions and methods fit them. But I can't understand it here, where there is initiation of cw_pack object. </p>\n\n<p><code>int cw_pack_context_init (cw_pack_context* pack_context, void* data, unsigned long length, pack_overflow_handler hpo)</code></p>\n\n<p>As I know what void* is, i don't know what is the data I should give to this function. Anyone could help me or give some material to make me understand this by myself? Example from github in CWPack project doesn't help me.</p>\n"}, {"tags": ["c", "printf", "warnings", "bit-fields", "gcc-warning"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1554284142, "post_id": 55489210, "comment_id": 97690943, "body": "Since you are wildly mixing types and using non-standard bit-field types, the compiler is free to store <code>m</code>, <code>st</code> and <code>reserved</code> in one 32 bit variable and then <code>mid</code> in a separate <code>uint64_t</code> variable. So your &quot;optimization&quot; can lead to significantly increased memory use, in addition to turning the code completely non-portable. It would have been wiser to drop bit-fields and simply use a single <code>uint64_t</code> variable instead."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1554284510, "post_id": 55489210, "comment_id": 97691200, "body": "Note that <code>sizeof(self)</code> is the size of the <b>pointer</b> <code>gn_addr *self</code> and not the size of the structure."}], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 8040888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc16379f21d8bc2c6963b7a33386391f?s=128&d=identicon&r=PG&f=1", "display_name": "Joshua", "link": "https://stackoverflow.com/users/8040888/joshua"}, "edited": false, "score": 1, "creation_date": 1554276801, "post_id": 55489312, "comment_id": 97686644, "body": "I&#39;m still getting the same warning. I&#39;ve also did <code>printf(&quot;%s\\n&quot;, PRIu64)</code> and it outputs <code>lu</code>"}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 2, "last_activity_date": 1554277323, "last_edit_date": 1554277323, "creation_date": 1554276218, "answer_id": 55489312, "question_id": 55489210, "link": "https://stackoverflow.com/questions/55489210/are-there-better-ways-to-ease-this-warning/55489312#55489312", "title": "Are there better ways to ease this warning?", "body": "<p>First, use proper format specifier for <code>uint64_t</code> and <code>size_t</code> types, use <code>PRIu64</code> macro, as defined in <code>inttypes.h</code> and <code>%zu</code>.</p>\n\n<p>That said, for the bit field variables, </p>\n\n<ul>\n<li>you can either use a cast, like <code>(uint64_t)self-&gt;mid</code></li>\n<li><p>or you can use an intermediate variable of type <code>uint64_t</code>, assign the member variable value to the new intermediate variable, and pass that to <code>printf()</code> as the corresponding argument to the format specifier, like</p>\n\n<pre><code>uint64_t temp = self-&gt;mid;\nprintf(\"%\"PRIu64 \"\\n\", temp);\n</code></pre></li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 57, "user_id": 8040888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc16379f21d8bc2c6963b7a33386391f?s=128&d=identicon&r=PG&f=1", "display_name": "Joshua", "link": "https://stackoverflow.com/users/8040888/joshua"}, "edited": false, "score": 0, "creation_date": 1554277271, "post_id": 55489544, "comment_id": 97686903, "body": "It works perfectly. Thank you by sharing your knowledge!"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1554284374, "post_id": 55489544, "comment_id": 97691098, "body": "In fact C doesn&#39;t have built-in standard support for <code>uint64_t</code> bit-fields, so what will happen is up to the compiler entirely."}], "tags": [], "owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "is_accepted": true, "score": 2, "last_activity_date": 1554282936, "last_edit_date": 1554282936, "creation_date": 1554277020, "answer_id": 55489544, "question_id": 55489210, "link": "https://stackoverflow.com/questions/55489210/are-there-better-ways-to-ease-this-warning/55489544#55489544", "title": "Are there better ways to ease this warning?", "body": "<p>While you should definitely apply the fixes in the other answers to get portable format specifiers, the warning will persist. The reason is that extra arguments to a variadic function like <code>printf</code> undergo argument promotions. Argument promotions include integer promotion. </p>\n\n<p>The rules for integer promotions will convert any integer with a conversion rank less than <code>int</code>/<code>unsigned</code>, as well as bit-fields, into the an <code>int</code>/<code>unsigned</code>. So for your initial bit-fields, you get <code>int</code> automatically.</p>\n\n<p>For integers with a higher conversion rank than <code>int</code>/<code>unsigned</code>, no promotion occurs. So your bit-field is not promoted to an <code>uint64_t</code>, and you get a warning about argument mismatch. You need a cast. </p>\n\n<pre><code>(uint64_t)self-&gt;mid\n</code></pre>\n\n<hr>\n\n<p>Btw, since nobody mentioned, the portable format specifier for a <code>size_t</code> (the type of the <code>sizeof</code> operator) is <code>%zu</code>. You should use that instead of <code>%ld</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 7405, "user_id": 5735010, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/znAEN.jpg?s=128&g=1", "display_name": "abhiarora", "link": "https://stackoverflow.com/users/5735010/abhiarora"}, "is_accepted": false, "score": 0, "last_activity_date": 1554279417, "creation_date": 1554279417, "answer_id": 55490258, "question_id": 55489210, "link": "https://stackoverflow.com/questions/55489210/are-there-better-ways-to-ease-this-warning/55490258#55490258", "title": "Are there better ways to ease this warning?", "body": "<p>Functions like <code>printf</code> are being examined by compilers (not all). The compiler checks if format specifier matches with the type of argument passed. You need to make explicit conversion to make that <code>Warning</code> go away. As mentioned in other answers that there are some implicit integer promotion rules and you need to be aware of them (Thanks to @storyTeller).</p>\n\n<blockquote>\n  <p>The rules for integer promotions will convert any integer with a conversion rank less than  int/unsigned,as well as bit-fields, into the an int/unsigned. So for your initial bit-fields, you get unsigned int automatically.</p>\n  \n  <p>For integers with a higher conversion rank than int/unsigned, no promotion occurs. So your bit-field is not promoted to an uint64_t, and you get a warning about argument mismatch. You need a cast.</p>\n</blockquote>\n\n<p>Try this:</p>\n\n<pre><code>(uint64_t)self-&gt;mid\n</code></pre>\n\n<blockquote>\n  <p>I have already tried to supress this warning by typing while compiling -Wno-format. I'm wondering if there are a better way to do it.</p>\n</blockquote>\n\n<p>It's not a good idea to suppress your warnings. They are generated for a reason. I would recommend to use warning flags like <code>-Wall</code>, <code>-Wshadow</code>, <code>-Wextra</code> and other important flags. They can help you with deploying code with lesser number of bugs.</p>\n\n<p>Regarding your assumption:</p>\n\n<blockquote>\n  <p>I have a struct where I use bitfields to optimize memory.</p>\n</blockquote>\n\n<p>I would like to point out that your struct with bitfields won't be that much memory optimized as you might be considering it. There is something called <code>Padding</code> and <code>Data Alignment</code> which may help you further in reducing the memory footprint.</p>\n\n<p>Check this <a href=\"https://stackoverflow.com/questions/4306186/structure-padding-and-packing\">question</a>.</p>\n"}], "owner": {"reputation": 57, "user_id": 8040888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc16379f21d8bc2c6963b7a33386391f?s=128&d=identicon&r=PG&f=1", "display_name": "Joshua", "link": "https://stackoverflow.com/users/8040888/joshua"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 166, "favorite_count": 0, "accepted_answer_id": 55489544, "answer_count": 3, "score": 3, "last_activity_date": 1554282936, "creation_date": 1554275882, "last_edit_date": 1554278659, "question_id": 55489210, "link": "https://stackoverflow.com/questions/55489210/are-there-better-ways-to-ease-this-warning", "title": "Are there better ways to ease this warning?", "body": "<p>I have a struct where I use bitfields to optimize memory. I have a <code>uint64_t</code> type and I want to print its value. When compiled it shows me this warning: <code>format \u2018%lu\u2019 expects argument of type \u2018long unsigned int\u2019, but argument 5 has type \u2018long unsigned int:48\u2019 [-Wformat=]</code>                                                                                  </p>\n\n<p>I have already tried to supress this warning by typing while compiling <code>-Wno-format</code>. I'm wondering if there are a better way to do it.</p>\n\n<p>Here some code:</p>\n\n<pre><code>#include &lt;stdint.h&gt;\n#include &lt;stdio.h&gt;\n\ntypedef struct gn_addr \n{\n    unsigned int m:1;\n    unsigned int st:5;\n    unsigned int reserved:10;\n    uint64_t mid:48;\n} gn_addr ;\n\nvoid gn_addr__print(gn_addr *self)                                                                                                                                                                         \n{                                                                                                                                                                                                          \n    printf(\"M=&gt;%d\\nST=&gt;%d\\nReserved=&gt;%d\\nMID=&gt;%lu\\nTotal size %ld bytes\\n\",                                                                                                                                \n         self-&gt;m, self-&gt;st, self-&gt;reserved, self-&gt;mid, sizeof(self));                                                                                                                                   \n} \n</code></pre>\n"}, {"tags": ["c", "string", "newline", "fgets"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 2, "creation_date": 1554275919, "post_id": 55489206, "comment_id": 97686210, "body": "<a href=\"https://stackoverflow.com/q/1694036/2173917\">Why is the gets function so dangerous that it should not be used?</a>"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1554276027, "post_id": 55489206, "comment_id": 97686253, "body": "I suggest you read more about <a href=\"https://en.cppreference.com/w/c/io/fgets\" rel=\"nofollow noreferrer\"><code>fgets</code></a>, and learn how it&#39;s different from e.g. <code>gets</code>. Incidentally, if you use <code>fgets</code> to read input from <code>stdin</code> as well, then it would have worked."}, {"owner": {"reputation": 1, "user_id": 11109296, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xssSauCBAp0/AAAAAAAAAAI/AAAAAAAAABU/4Cs_HXEWLFo/photo.jpg?sz=128", "display_name": "Mohammad Tahsin Kamal", "link": "https://stackoverflow.com/users/11109296/mohammad-tahsin-kamal"}, "edited": false, "score": 1, "creation_date": 1554276448, "post_id": 55489206, "comment_id": 97686457, "body": "i can&#39;t understand the \\n thing and how to solve it."}], "answers": [{"comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1554276302, "post_id": 55489264, "comment_id": 97686380, "body": "Or, if using <code>fgets</code> to read the input from <code>stdin</code>, do nothing. :)"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1554276372, "post_id": 55489264, "comment_id": 97686422, "body": "@Someprogrammerdude True, but I&#39;d like to have my inputs <i>sanitized</i> before I use them. :)"}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 2, "last_activity_date": 1554276421, "last_edit_date": 1554276421, "creation_date": 1554276061, "answer_id": 55489264, "question_id": 55489206, "link": "https://stackoverflow.com/questions/55489206/why-i-cant-compare-those-arrays-in-files-and-that-i-read-to-create-a-login-syst/55489264#55489264", "title": "why i can&#39;t compare those arrays in files and that i read to create a login system?", "body": "<p>First of all, <a href=\"https://stackoverflow.com/q/1694036/2173917\">never use <code>gets()</code></a>, use <a href=\"https://linux.die.net/man/3/fgets\" rel=\"nofollow noreferrer\"><code>fgets()</code></a> always.</p>\n\n<p>That said, <code>fgets()</code>, reads and stores the trailing newline into the target buffer.</p>\n\n<p>From <code>C11</code>, chapter 7.21.7.2</p>\n\n<blockquote>\n  <p>The <code>fgets</code> function reads at most one less than the number of characters specified by n from the stream pointed to by stream into the array pointed to by s. No additional characters are read after a new-line character <strong>(which is retained)</strong> or after end-of-file. A null character is written immediately after the last character read into the array.</p>\n</blockquote>\n\n<p>You should get rid of that newline before making use of the scanned value. <a href=\"https://stackoverflow.com/a/30261047/2173917\">Here's one way to have that accomplished</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 4703, "user_id": 5375464, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3292ca87ff6c766b75dbe4b2ea0831da?s=128&d=identicon&r=PG&f=1", "display_name": "J...S", "link": "https://stackoverflow.com/users/5375464/j-s"}, "is_accepted": false, "score": 0, "last_activity_date": 1554277757, "creation_date": 1554277757, "answer_id": 55489755, "question_id": 55489206, "link": "https://stackoverflow.com/questions/55489206/why-i-cant-compare-those-arrays-in-files-and-that-i-read-to-create-a-login-syst/55489755#55489755", "title": "why i can&#39;t compare those arrays in files and that i read to create a login system?", "body": "<p>You should check if the <code>fopen()</code> was successful before accessing the file that the program attempted to open.</p>\n\n<p><code>fopen()</code> returns <code>NULL</code> on error. So do something like</p>\n\n<pre><code>pass=fopen(\"password.txt\",\"r\");         \nif( pass==NULL )\n{\n    perror(\"Unable to open input file.\");       \n}\nelse\n{\n    // Use the file \n}\n</code></pre>\n\n<p>And <code>gets()</code> is known to severe security concerns. See <a href=\"https://stackoverflow.com/questions/1694036/why-is-the-gets-function-so-dangerous-that-it-should-not-be-used\">this</a>. </p>\n\n<p>It is advisable to use a <code>fgets()</code> instead with <code>stdin</code> as an argument. So instead of </p>\n\n<pre><code>gets(id);            \n</code></pre>\n\n<p>try</p>\n\n<pre><code>if( fgets(id, sizeof(id), stdin)!=NULL )\n{\n    id[ strlen(id)-1 ] = '\\0';\n    // Use `id` \n}   \n</code></pre>\n\n<p>The value returned by <code>fgets()</code> is also checked to see that <code>fgets()</code> was successful. It returns <code>NULL</code> on error.</p>\n\n<p>It should be noted that <code>fgets()</code> would read in the trailing <code>\\n</code> from stdin as well.</p>\n\n<p>You may remove this extra <code>\\n</code> with the help of a  function like <code>strlen()</code>. See a discussion on removing the extra newline <a href=\"https://stackoverflow.com/questions/2693776/removing-trailing-newline-character-from-fgets-input\">here</a>.</p>\n\n<p>Use the same while reading into <code>pw</code> as well.</p>\n\n<p>Assuming that your input file has the id in one line and the corresponding password in the line after that, you could do something like</p>\n\n<pre><code>char flag=0;\nwhile(fgets(str, sizeof str, pass)!=NULL &amp;&amp; fgets(str2, sizeof str2, pass)!=NULL)\n{\n    str[ strlen(str)-1 ] = '\\0';\n    str2[ strlen(str2)-1 ] = '\\0';\n    if( strcmp(str, id)==0 )\n    {\n        flag=1;\n        if( strcmp(str2, pw)==0 )\n        {\n            printf(\"ACCEPTED\\n\");            \n        }\n        else \n        {\n            printf(\"wrong password.\");\n        }\n        break;\n    }\n}\nif(flag==0) \n{\n    printf(\"Wrong id.\");    \n}\n</code></pre>\n\n<p>Read two lines at once and check if both are successful before each iteration of the loop to ensure that proper values have been read.</p>\n\n<p>You may want to break out of the loop once you find the password to be wrong.</p>\n\n<p>You could also use a flag variable to see if the id that was input was valid and print the corresponding message at the end.</p>\n"}], "owner": {"reputation": 1, "user_id": 11109296, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xssSauCBAp0/AAAAAAAAAAI/AAAAAAAAABU/4Cs_HXEWLFo/photo.jpg?sz=128", "display_name": "Mohammad Tahsin Kamal", "link": "https://stackoverflow.com/users/11109296/mohammad-tahsin-kamal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1554288839, "creation_date": 1554275874, "last_edit_date": 1554288839, "question_id": 55489206, "link": "https://stackoverflow.com/questions/55489206/why-i-cant-compare-those-arrays-in-files-and-that-i-read-to-create-a-login-syst", "title": "why i can&#39;t compare those arrays in files and that i read to create a login system?", "body": "<p>The <code>strcmp()</code> function is not working. The username I am reading from console doesn't match the one i Have in the file. So, the output is wrong id.\nWhat is the solution?</p>\n\n<pre><code>  #include&lt;stdio.h&gt;       \n  #include&lt;stdlib.h&gt;        \n  #include&lt;string.h&gt;       \n  int main()         \n  {    \n   FILE *pass;     \n   char str[100],str2[100];     \n   char id[100],pw[100];        \n   pass=fopen(\"password.txt\",\"r\");         \n   printf(\"ENTER USER NAME AND PASSWORD:\\n\");        \n   printf(\"USERNAME: \");       \n   gets(id);            \n   printf(\"\\nPASSWORD: \");         \n   gets(pw);       \n   while(fgets(str,100,pass)!=NULL);            \n   {        \n    fgets(str2,100,pass);      \n    if(strcmp(id,str)==0)       \n    {       \n      if(strcmp(pw,str2)==0)         \n      {       \n        printf(\"ACCEPTED\\n\");            \n      }       \n      else       \n      {        \n        printf(\"wrong password\");          \n       }        \n   }        \n   else         \n    {          \n      printf(\"wrong id\");           \n    }           \n    }    \n    fclose(pass);    \n   }          \n</code></pre>\n"}, {"tags": ["c", "embedded", "gpio"], "answers": [{"tags": [], "owner": {"reputation": 66, "user_id": 10922110, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-VhAzRYbxCbg/AAAAAAAAAAI/AAAAAAAAAgs/19fESmV8AEg/photo.jpg?sz=128", "display_name": "Wizzard", "link": "https://stackoverflow.com/users/10922110/wizzard"}, "is_accepted": false, "score": 1, "last_activity_date": 1554276368, "creation_date": 1554276368, "answer_id": 55489348, "question_id": 55489106, "link": "https://stackoverflow.com/questions/55489106/checking-gpio-state-in-embedded-c-programming/55489348#55489348", "title": "Checking GPIO State in Embedded C Programming", "body": "<p>Normally the state of an GPIO is saved in a register variable. You either need a definition of this variable or a vector pointing to its adress to read (or manipulate) it directly. Do you have documentation of the method WriteLED? It could give you a hint. </p>\n\n<p>If you don't find anything you could still implement a flag to indicate which LED you switched on most recently.</p>\n\n<p>Generally the Embedded Programming depends highly on the Chip you are working with and the corresponding compiler. \nSo to give you a better answer, you should first provide important information like the Hardware and Software you are using and libraries you want to implement.</p>\n"}, {"tags": [], "owner": {"reputation": 43, "user_id": 10607992, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CXJL3.jpg?s=128&g=1", "display_name": "GigaJoules", "link": "https://stackoverflow.com/users/10607992/gigajoules"}, "is_accepted": false, "score": 1, "last_activity_date": 1554279337, "creation_date": 1554279337, "answer_id": 55490216, "question_id": 55489106, "link": "https://stackoverflow.com/questions/55489106/checking-gpio-state-in-embedded-c-programming/55490216#55490216", "title": "Checking GPIO State in Embedded C Programming", "body": "<p>You likely want to put a delay in your main loop.\nUnless your joystick function locks the code until it sees a change, that toggle on your top LED is going to happen so fast that you are likely to see a dim glow or perhaps even nothing at all depending on the rise time of your hardware. \nLike Wizzard said you should be able to find the status of your LED by looking in a register. How this is done is totally down to your hardware. \nIt would also most likely be suitable to use a few static booleans so you can save the state of the LEDs and check these to get your LED values, but this is not a perfect implementation. Register checks are better.</p>\n"}, {"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1554280895, "post_id": 55490428, "comment_id": 97688990, "body": "Who mentioned STM? Are you assuming this based on the function calls in the OP?"}, {"owner": {"reputation": 940, "user_id": 5840652, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ELL15.png?s=128&g=1", "display_name": "Vinci", "link": "https://stackoverflow.com/users/5840652/vinci"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1554281239, "post_id": 55490428, "comment_id": 97689198, "body": "Yes. As far as I know only STM libraries have functions with this very specific name and &quot;HAL_&quot; prefix."}], "tags": [], "owner": {"reputation": 940, "user_id": 5840652, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ELL15.png?s=128&g=1", "display_name": "Vinci", "link": "https://stackoverflow.com/users/5840652/vinci"}, "is_accepted": false, "score": 2, "last_activity_date": 1554279932, "creation_date": 1554279932, "answer_id": 55490428, "question_id": 55489106, "link": "https://stackoverflow.com/questions/55489106/checking-gpio-state-in-embedded-c-programming/55490428#55490428", "title": "Checking GPIO State in Embedded C Programming", "body": "<p>STM's HAL library offers a ReadPin function analog to the WritePin function you already used.</p>\n\n<p>It's declaration looks as follows:</p>\n\n<pre><code>GPIO_PinState HAL_GPIO_ReadPin(GPIO_TypeDef* GPIOx, uint16_t GPIO_Pin)\n</code></pre>\n\n<p>Which means you could read the state of a certain pin like this:</p>\n\n<pre><code>GPIO_PinState ld6_state = HAL_GPIO_ReadPin(LD6_GPIO_Port, LD6_Pin);\n</code></pre>\n\n<p>GPIO_PinState is an enumeration:</p>\n\n<pre><code>typedef enum\n{\n  GPIO_PIN_RESET = 0,\n  GPIO_PIN_SET\n}GPIO_PinState;\n</code></pre>\n\n<p>All that's left is comparing the return value of the read function (ld6_state) to either of the enumeration values. As mentioned by the first answer you'll most likely experience some bouncing of your inputs which is caused by the mechanical construction of your buttons. I guess figuring out how to solve that is part of the assignment so I'll leave that up to you. Keywords to look for: debounce or debouncing</p>\n"}, {"tags": [], "owner": {"reputation": 528, "user_id": 2081408, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dRwXo.png?s=128&g=1", "display_name": "Simon Jenkins", "link": "https://stackoverflow.com/users/2081408/simon-jenkins"}, "is_accepted": false, "score": 3, "last_activity_date": 1554282480, "creation_date": 1554282480, "answer_id": 55491276, "question_id": 55489106, "link": "https://stackoverflow.com/questions/55489106/checking-gpio-state-in-embedded-c-programming/55491276#55491276", "title": "Checking GPIO State in Embedded C Programming", "body": "<p>If the assignment is specifically asking for a \"state machine\" then the software should somehow have different internal \"states\" corresponding to the different LED output requirements. There are lots of ways to represent a state machine -- (were you shown one?) -- For example:</p>\n\n<pre><code>// enumeration of the required states\nenum OutputState {\n    stateAllOff, // I'm *guessing* this is the required initial state?\n    stateLeftLED,\n    stateRightLED,\n    // ... any other states that are specified.\n    // ... but *not* random combinations of LEDs that are not part of the specification.\n};\n\nenum OutputState currentState = stateAllOff; // or whatever initial state is required\n\n// [...] I'm not going to do the actual assignment here\n</code></pre>\n\n<p>A state machine doesn't have to read the LED states, it just \"remembers\" them in the <code>currentState</code> variable. Now the rest of the code becomes a straightforward implementation of the conditions you were given so...</p>\n\n<blockquote>\n  <p>\"if Left LED is on and Down is Pressed Change to Right LED\"</p>\n</blockquote>\n\n<pre><code>    if (currentState == stateLeftLED) {\n        if (Joystick == \"D\") {\n            WriteLED ('R', LED_ON);\n            WriteLED ('L', LED_OFF);\n            currentState = stateRightLED;\n        }\n    }\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9526668, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "saber112", "link": "https://stackoverflow.com/users/9526668/saber112"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 590, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1554286455, "creation_date": 1554275517, "last_edit_date": 1554286455, "question_id": 55489106, "link": "https://stackoverflow.com/questions/55489106/checking-gpio-state-in-embedded-c-programming", "title": "Checking GPIO State in Embedded C Programming", "body": "<p>We have an embedded C programming assignment where we have to implement a state machine that changes a series of LED's depending on a Joystick Input. Two of the conditions are: \"if Left LED is on and Down is Pressed Change to Right LED\" and \"if Right LED is on and Down is Pressed Change to Left LED\". I know how to turn on certain LED's on button presses but I have no idea how to check the state of a GPIO pin/LED and change another LED based on the state when the joystick is used. I basically just want to know how to \"call\" the state of an LED.</p>\n\n<p>This is the state machine sample code so far:</p>\n\n<pre><code>void\nStateMachine ()\n{\n  // REPLACE THE FOLLOW CODE WITH YOUR SOLUTION\n  // This code just toggles top LED and set left or right LED.\n  //\n  // Solution.\n\n  uint8_t Joystick;\n  uint8_t Toggle = 0;\n\n  while (1)\n  {\n    Joystick = GetJoystick();\n\n    if (Joystick == 'L')\n    {\n      WriteLED ('L', LED_ON);\n      WriteLED ('R', LED_OFF);\n    }\n    else if (Joystick == 'R')\n    {\n      WriteLED ('L', LED_OFF);\n      WriteLED ('R', LED_ON);\n    }\n\n    if (Toggle == 0)\n    {\n      WriteLED ('T', LED_ON);\n      Toggle = 1;\n    }\n    else\n    {\n      WriteLED ('T', LED_OFF);\n      Toggle = 0;\n    }\n  }\n}\n</code></pre>\n\n<p>Update: This is my <code>WriteLED</code> method</p>\n\n<pre><code>void\nWriteLED (uint8_t LED, uint8_t State)\n{\n  // Check for correct state\n  if ((State != LED_OFF) &amp;&amp; (State != LED_ON))\n  {\n    return;\n  }\n\n  // Turn on/off the LED\n  switch (LED)\n    {\n    case 'L':\n      HAL_GPIO_WritePin (LD4_GPIO_Port, LD4_Pin, State);\n      break;\n    case 'T':\n      HAL_GPIO_WritePin (LD3_GPIO_Port, LD3_Pin, State);\n      break;\n    case 'B':\n      HAL_GPIO_WritePin (LD6_GPIO_Port, LD6_Pin, State);\n      break;\n    case 'R':\n      HAL_GPIO_WritePin (LD5_GPIO_Port, LD5_Pin, State);\n      break;\n    }\n\n  return;\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "linux-kernel", "linux-device-driver"], "answers": [{"tags": [], "owner": {"reputation": 47, "user_id": 11255236, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Ze3Osq6WSGM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3ren-_LLIDEBhEfmDW5thgNg7Va6cg/mo/photo.jpg?sz=128", "display_name": "Funniest", "link": "https://stackoverflow.com/users/11255236/funniest"}, "is_accepted": true, "score": 0, "last_activity_date": 1554339473, "creation_date": 1554339473, "answer_id": 55506357, "question_id": 55489068, "link": "https://stackoverflow.com/questions/55489068/is-there-a-multi-function-that-call-child-folder-of-a-dev-path/55506357#55506357", "title": "Is there a multi function that call child folder of a dev path?", "body": "<p>I found \"sysfs\"! Using this lib i can implement this example.</p>\n\n<p><a href=\"https://www.kernel.org/doc/Documentation/filesystems/sysfs.txt\" rel=\"nofollow noreferrer\">https://www.kernel.org/doc/Documentation/filesystems/sysfs.txt</a></p>\n"}], "owner": {"reputation": 47, "user_id": 11255236, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Ze3Osq6WSGM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3ren-_LLIDEBhEfmDW5thgNg7Va6cg/mo/photo.jpg?sz=128", "display_name": "Funniest", "link": "https://stackoverflow.com/users/11255236/funniest"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 55506357, "answer_count": 1, "score": 0, "last_activity_date": 1554339473, "creation_date": 1554275387, "last_edit_date": 1554278028, "question_id": 55489068, "link": "https://stackoverflow.com/questions/55489068/is-there-a-multi-function-that-call-child-folder-of-a-dev-path", "title": "Is there a multi function that call child folder of a dev path?", "body": "<p>How to implement this example in kernel driver?\nI looked in 'cdev'. but, the result is not convincing for this function using this example struct.</p>\n\n<p>For example:</p>\n\n<pre><code>dev/test/on // this function is change status in test module\n\ndev/test/changed \"hello\" // this function is change char value\n</code></pre>\n\n<p>I Looked \"cdev\" and some github. But, it is \"/dev/test\" one file.</p>\n"}, {"tags": ["c", "bluetooth-lowenergy"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1554274634, "post_id": 55488874, "comment_id": 97685606, "body": "Check the line number 343 in utils.c code..the problem is there."}, {"owner": {"reputation": 565, "user_id": 4717188, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/056e17c34d8c2d1a5e4e894f6563aa05?s=128&d=identicon&r=PG&f=1", "display_name": "maze", "link": "https://stackoverflow.com/users/4717188/maze"}, "edited": false, "score": 0, "creation_date": 1554278082, "post_id": 55488874, "comment_id": 97687361, "body": "Ciould you please dump some sample code, how you actually write the array to the gatt service? It looks like there might be a length field which is not used corretly."}, {"owner": {"reputation": 11, "user_id": 10984196, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0495774f7081901a305bfe11990fffe2?s=128&d=identicon&r=PG&f=1", "display_name": "T.Nirupama", "link": "https://stackoverflow.com/users/10984196/t-nirupama"}, "edited": false, "score": 0, "creation_date": 1554299477, "post_id": 55488874, "comment_id": 97700672, "body": "please find the sample code"}], "owner": {"reputation": 11, "user_id": 10984196, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0495774f7081901a305bfe11990fffe2?s=128&d=identicon&r=PG&f=1", "display_name": "T.Nirupama", "link": "https://stackoverflow.com/users/10984196/t-nirupama"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1554299452, "creation_date": 1554274539, "last_edit_date": 1554299452, "question_id": 55488874, "link": "https://stackoverflow.com/questions/55488874/getting-junk-values-along-with-actual-data-while-performing-read-operation-in-bl", "title": "Getting junk values along with actual data while performing read operation in BLE scanner app", "body": "<p>I am working on <strong>nrf52832 in segger embedded studio</strong>. Using <strong>ble scanner app</strong>, I am writing and reading some values. While reading the values, i am getting some junk data randomly. I'm writing data  to some arrays. </p>\n\n<p>Consider  there are <code>A[2], B[4], C[45]</code>. To array  A and B, I'm writing complete data. so while reading them back, I'm getting the data. For <code>C[45],</code> I am not writing the complete data.</p>\n\n<p>For example, its <strong>size is 45</strong>, i am only writing 5 bytes of data,so while reading them back,  i am getting <strong>5 bytes of data along with 40 bytes of junk data</strong>. \nMy data is <strong>12345</strong>, Junk value is <strong>12345!?M</strong> .</p>\n\n<p>What could be the issue?</p>\n\n<pre><code>static void on_write(ble_cus_t * p_cus, ble_evt_t const * p_ble_evt)\n{\n    ble_gatts_evt_write_t * p_evt_write = &amp;p_ble_evt-&gt;evt.gatts_evt.params.write;\n\n     Custom Value Characteristic Written to.\n    if (p_evt_write-&gt;handle == p_cus-&gt;custom_value_handles.value_handle)\n    {\n        nrf_gpio_pin_toggle(LED_4);\n    }\n\n    // Check if the Custom value CCCD is written to and that the value is the appropriate length, i.e 2 bytes.\n    if ((p_evt_write-&gt;handle == p_cus-&gt;custom_value_handles.cccd_handle)\n        &amp;&amp; (p_evt_write-&gt;len == 2)\n       )\n    {\n\n        NRF_LOG_INFO(\"on_write: len %d, p_evt_write-&gt;data[0]: %d, p_evt_write-&gt;data[1]: %d.\",\n                     p_evt_write-&gt;len,\n                     p_evt_write-&gt;data[0],\n                     p_evt_write-&gt;data[1]);\n\n        // CCCD written, call application event handler\n        if (p_cus-&gt;evt_handler != NULL)\n        {\n            ble_cus_evt_t evt;\n\n            if (ble_srv_is_notification_enabled(p_evt_write-&gt;data))\n            {\n                evt.evt_type = BLE_CUS_EVT_NOTIFICATION_ENABLED;\n            }\n            else\n            {\n                evt.evt_type = BLE_CUS_EVT_NOTIFICATION_DISABLED;\n            }\n            // Call the application event handler.\n            p_cus-&gt;evt_handler(p_cus, &amp;evt);\n        }\n    }\n\n}\n</code></pre>\n"}, {"tags": ["c", "fftw"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1554274554, "post_id": 55488831, "comment_id": 97685570, "body": "Have you tried to <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">debug your program</a>?"}, {"owner": {"reputation": 23, "user_id": 8186970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18ba89760747bbb4d9b99e8841e75345?s=128&d=identicon&r=PG&f=1", "display_name": "donggun", "link": "https://stackoverflow.com/users/8186970/donggun"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1554274706, "post_id": 55488831, "comment_id": 97685639, "body": "It gives me no error messages... Does it give you the errors?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1554274821, "post_id": 55488831, "comment_id": 97685703, "body": "And how do you call this function? How do you initialize the data you pass to your function? How do you print the result? Please create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> to show us (hard-coded &quot;input&quot; is fine, it&#39;s actually better for testing). Also please take some time to read about <a href=\"http://stackoverflow.com/help/how-to-ask\">how to ask good questions</a>, as well as <a href=\"https://codeblog.jonskeet.uk/2012/11/24/stack-overflow-question-checklist/\" rel=\"nofollow noreferrer\">this question checklist</a>."}, {"owner": {"reputation": 23, "user_id": 8186970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18ba89760747bbb4d9b99e8841e75345?s=128&d=identicon&r=PG&f=1", "display_name": "donggun", "link": "https://stackoverflow.com/users/8186970/donggun"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1554274953, "post_id": 55488831, "comment_id": 97685754, "body": "Okay sorry.. this is my second time to ask questions. I will rewrite my code"}, {"owner": {"reputation": 2782, "user_id": 104453, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/69dcd277799bf98a2cd1c39dc48a82a3?s=128&d=identicon&r=PG", "display_name": "marcin", "link": "https://stackoverflow.com/users/104453/marcin"}, "edited": false, "score": 0, "creation_date": 1554276282, "post_id": 55488831, "comment_id": 97686366, "body": "if numpy.fft was too slow try <code>pip install mkl-fft</code> -- it makes numpy.fft 5-10x faster (MKL FFT tends to be even faster than FFTW)."}, {"owner": {"reputation": 23, "user_id": 8186970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18ba89760747bbb4d9b99e8841e75345?s=128&d=identicon&r=PG&f=1", "display_name": "donggun", "link": "https://stackoverflow.com/users/8186970/donggun"}, "edited": false, "score": 0, "creation_date": 1554276421, "post_id": 55488831, "comment_id": 97686444, "body": "Thanks for your advice, but I have to do some other things too so the only option for me is to use C language. Anyway thank you very much"}, {"owner": {"reputation": 23, "user_id": 8186970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18ba89760747bbb4d9b99e8841e75345?s=128&d=identicon&r=PG&f=1", "display_name": "donggun", "link": "https://stackoverflow.com/users/8186970/donggun"}, "edited": false, "score": 0, "creation_date": 1554277567, "post_id": 55488831, "comment_id": 97687067, "body": "I reuploaded my code which gives me no errors. Still, the problem is not solved..."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 8186970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18ba89760747bbb4d9b99e8841e75345?s=128&d=identicon&r=PG&f=1", "display_name": "donggun", "link": "https://stackoverflow.com/users/8186970/donggun"}, "edited": false, "score": 0, "creation_date": 1554341203, "post_id": 55504187, "comment_id": 97718825, "body": "Thank you very much! It solves the problem. It is a huge relief... Also, thanks for the kind explanation about FFTW_RESERVE_INPUT."}], "tags": [], "owner": {"reputation": 8727, "user_id": 2999346, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dQ1wB.png?s=128&g=1", "display_name": "francis", "link": "https://stackoverflow.com/users/2999346/francis"}, "is_accepted": true, "score": 2, "last_activity_date": 1554330628, "last_edit_date": 1554330628, "creation_date": 1554325232, "answer_id": 55504187, "question_id": 55488831, "link": "https://stackoverflow.com/questions/55488831/1d-real-fft-and-ifft-of-a-3d-array/55504187#55504187", "title": "1D real FFT and IFFT of a 3D array", "body": "<p>For <code>fftw_plan_many_dft_c2r()</code>: <code>nbz</code>, the size of the transform, is to be set to <code>Nz</code>, the size of the <strong>real output</strong> array. It is likely similar for <code>fftw_plan_dft_c2r_1d()</code>.</p>\n\n<pre><code>// Set backward FFTz parameters\nint rankbz = 1;\nint nbz[1] = {(Nz)}; // here !!!\nconst int *inembedbz = NULL, *onembedbz = NULL;\n//int inembedbz[1]={Nz/2+1};\n//int onembedbz[1]={Nz};\nint istridebz = 1, ostridebz = 1;\nint idistbz = (Nz/2+1), odistbz = (Nz);\nint howmanybz = (Nx*Ny);\n\n// Setup Backward plans.\nfftw_plan FFTz_bak_plan = fftw_plan_many_dft_c2r(rankbz, nbz, howmanybz, FFTz, inembedbz, istridebz, idistbz, output, onembedbz, ostridebz, odistbz, FFTW_ESTIMATE);\n</code></pre>\n\n<p>As the <code>input</code> and <code>output</code> array are used by FFTW transforms, it is advised to allocate them using <code>fftw_malloc()</code> or a similar function, as you did for <code>FFTz</code>. These functions ensure that requirements regarding memory alignment are met. See function <code>*X(kernel_malloc)(size_t n)</code> in fftw-3.3.6-pl2/kernel/kalloc.c . It calls functions like <a href=\"https://linux.die.net/man/3/memalign\" rel=\"nofollow noreferrer\"><code>memalign()</code></a> or <a href=\"https://docs.microsoft.com/fr-fr/cpp/c-runtime-library/reference/aligned-malloc?view=vs-2019\" rel=\"nofollow noreferrer\"><code>_aligned_malloc()</code></a> among others. Both these two return <code>NULL</code> just like <code>malloc()</code> in case of failure. </p>\n\n<p>There is a difference of scale. Indeed, chaining a forward and backward FFTW transforms of length <code>Nz</code> results in a scaling by <code>Nz</code>.</p>\n\n<p>Fianlly, some FFTW transforms, such as c2r, are allowed to overwrite their input arrays, except if the <a href=\"http://www.fftw.org/fftw3_doc/Planner-Flags.html\" rel=\"nofollow noreferrer\">flag FFTW_PRESERVE_INPUT</a> is added:</p>\n\n<blockquote>\n  <p>FFTW_PRESERVE_INPUT specifies that an out-of-place transform must not change its input array. This is ordinarily the default, except for c2r and hc2r (i.e. complex-to-real) transforms for which FFTW_DESTROY_INPUT is the default. In the latter cases, passing FFTW_PRESERVE_INPUT will attempt to use algorithms that do not destroy the input, at the expense of worse performance; for multi-dimensional c2r transforms, however, no input-preserving algorithms are implemented and the planner will return NULL if one is requested.</p>\n</blockquote>\n"}], "owner": {"reputation": 23, "user_id": 8186970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18ba89760747bbb4d9b99e8841e75345?s=128&d=identicon&r=PG&f=1", "display_name": "donggun", "link": "https://stackoverflow.com/users/8186970/donggun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 134, "favorite_count": 0, "accepted_answer_id": 55504187, "answer_count": 1, "score": 2, "last_activity_date": 1554330628, "creation_date": 1554274373, "last_edit_date": 1554277652, "question_id": 55488831, "link": "https://stackoverflow.com/questions/55488831/1d-real-fft-and-ifft-of-a-3d-array", "title": "1D real FFT and IFFT of a 3D array", "body": "<p>I have a 3D array which has a dimension (Nx, Ny, Nz).</p>\n\n<p>I want to apply real FFT and IFFT along z-axis using FFTW3 library.</p>\n\n<p>Here, 'z' is the fastest varying index.</p>\n\n<p>I already write the same functional code with python using</p>\n\n<p>numpy.fft.rfft and numpy.fft.irfft. It works exactly as I expected.</p>\n\n<p>But it was too slow. So I tried to write code with C language.</p>\n\n<p>I tried to compare the result of IFFT(FFT(f)) and f, where f is an arbitrary array.</p>\n\n<p>I used the fft_plan_many_dft_r2c / fft_plan_many_dft_c2r for forward / backward FFT.</p>\n\n<p>Here is my code.</p>\n\n<p>(Compiled in Ubuntu 16.04 with gcc and -lfftw3 -lm options)</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;fftw3.h&gt;\n\nvoid rfft_1d_of_3d(int Nx, int Ny, int Nz, double* input, double* output);\n\nint main(){\n\n    double* input;\n    double* output;\n\n    int Nx=2, Ny=4, Nz=8;\n    int i,j,k,idx;\n\n    input  = (double*) malloc(Nx*Ny*Nz*sizeof(double));\n    output = (double*) malloc(Nx*Ny*Nz*sizeof(double));\n\n    for(i=0; i&lt;Nx; i++){\n        for(j=0; j&lt;Ny; j++){\n            for(k=0; k&lt;Nz; k++){\n\n                idx = k + j*Nz + i*Nz*Ny;\n                input[idx] = idx;\n                output[idx] = 0.;\n            }\n        }   \n    }   \n\n    rfft_1d_of_3d(Nx, Ny, Nz, input, output);\n\n    for(i=0; i&lt;Nx; i++){\n        for(j=0; j&lt;Ny; j++){\n            for(k=0; k&lt;Nz; k++){\n                idx = k + j*Nz + i*Nz*Ny;\n                printf(\"%f, %f\\n\", input[idx], output[idx]);\n            }\n        }\n    }   \n\n    return 0;\n}\n\nvoid rfft_1d_of_3d(int Nx, int Ny, int Nz, double* input, double* output){\n\n    int i,j,k,idx;\n\n    // Allocate memory space.\n    fftw_complex *FFTz = fftw_alloc_complex(Nx*Ny*(Nz/2+1));\n\n    // Set forward FFTz parameters\n    int rankz = 1;\n    int nz[] = {Nz};\n    const int *inembedz = NULL, *onembedz = NULL;\n    int istridez = 1, ostridez = 1;\n    int idistz = Nz, odistz= (Nz+2)/2;\n    int howmanyz = (Nx*Ny);\n\n    // Setup Forward plans.\n    fftw_plan FFTz_for_plan = fftw_plan_many_dft_r2c(rankz, nz, howmanyz, input, inembedz, istridez, idistz, FFTz, onembedz, ostridez, odistz, FFTW_ESTIMATE);\n\n    // Set backward FFTz parameters\n    int rankbz = 1;\n    int nbz[] = {(Nz+2)/2};\n    const int *inembedbz = NULL, *onembedbz = NULL;\n    int istridebz = 1, ostridebz = 1;\n    int idistbz = (Nz+2)/2, odistbz = Nz;\n    int howmanybz = (Nx*Ny);\n\n    // Setup Backward plans.\n    fftw_plan FFTz_bak_plan = fftw_plan_many_dft_c2r(rankbz, nbz, howmanybz, FFTz, inembedbz, istridebz, idistbz, output, onembedbz, ostridebz, odistbz, FFTW_ESTIMATE);\n\n    fftw_execute(FFTz_for_plan);\n    fftw_execute(FFTz_bak_plan);\n    fftw_free(FFTz);\n\n    return;\n}\n</code></pre>\n\n<p>the input and output result is supposed to be the same, but it does not.</p>\n\n<p>The input array was a 3D array (Nx=2, Ny=4, Nz=8),</p>\n\n<pre><code>[[[  0.   1.   2.   3.   4.   5.   6.   7.]\n  [  8.   9.  10.  11.  12.  13.  14.  15.]\n  [ 16.  17.  18.  19.  20.  21.  22.  23.]\n  [ 24.  25.  26.  27.  28.  29.  30.  31.]]\n\n [[ 32.  33.  34.  35.  36.  37.  38.  39.]\n  [ 40.  41.  42.  43.  44.  45.  46.  47.]\n  [ 48.  49.  50.  51.  52.  53.  54.  55.]\n  [ 56.  57.  58.  59.  60.  61.  62.  63.]]]\n</code></pre>\n\n<p>and I flattened it as,</p>\n\n<pre><code>[  0.   1.   2.   3.   4.   5.   6.   7.  8.   9.  10.  11.  12.  13.  14.  15. 16.  17.  18.  19.  20.  21.  22.  23. 24.  25.  26.  27.  28.  29.  30.  31. 32.  33.  34.  35.  36.  37.  38.  39. 40.  41.  42.  43.  44.  45.  46.  47. 48.  49.  50.  51.  52.  53.  54.  55. 56.  57.  58.  59.  60.  61.  62.  63.]\n</code></pre>\n\n<p>I expected the output would be the same as the input but the actual result was</p>\n\n<pre><code>0.000000, 12.000000\n1.000000, 8.929290\n2.000000, 28.256139\n3.000000, 35.743861\n4.000000, 55.070710\n5.000000, 0.000000\n6.000000, 0.000000\n7.000000, 0.000000\n8.000000, 76.000000\n9.000000, 72.929290\n10.000000, 92.256139\n11.000000, 99.743861\n12.000000, 119.070710\n13.000000, 0.000000\n14.000000, 0.000000\n15.000000, 0.000000\n16.000000, 140.000000\n17.000000, 136.929290\n18.000000, 156.256139\n19.000000, 163.743861\n20.000000, 183.070710\n21.000000, 0.000000\n22.000000, 0.000000\n23.000000, 0.000000\n24.000000, 204.000000\n25.000000, 200.929290\n26.000000, 220.256139\n27.000000, 227.743861\n28.000000, 247.070710\n29.000000, 0.000000\n30.000000, 0.000000\n31.000000, 0.000000\n32.000000, 268.000000\n33.000000, 264.929290\n34.000000, 284.256139\n35.000000, 291.743861\n36.000000, 311.070710\n37.000000, 0.000000\n38.000000, 0.000000\n39.000000, 0.000000\n40.000000, 332.000000\n41.000000, 328.929290\n42.000000, 348.256139\n43.000000, 355.743861\n44.000000, 375.070710\n45.000000, 0.000000\n46.000000, 0.000000\n47.000000, 0.000000\n48.000000, 396.000000\n49.000000, 392.929290\n50.000000, 412.256139\n51.000000, 419.743861\n52.000000, 439.070710\n53.000000, 0.000000\n54.000000, 0.000000\n55.000000, 0.000000\n56.000000, 460.000000\n57.000000, 456.929290\n58.000000, 476.256139\n59.000000, 483.743861\n60.000000, 503.070710\n61.000000, 0.000000\n62.000000, 0.000000\n63.000000, 0.000000\n</code></pre>\n\n<p>The left one is the elements of the input array and the right one is that of the output.</p>\n\n<p>Where did I make a mistake?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 1, "creation_date": 1554274454, "post_id": 55488733, "comment_id": 97685538, "body": "You make yourself a good coffee and start reading the source code."}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 1, "creation_date": 1554276072, "post_id": 55488733, "comment_id": 97686275, "body": "<code>unresolved external symbol</code> sounds to me like you compiled successfully, but linking failed. That means, any used header could be found. IMHO there are chances that accompanying libraries are also there. So, try to find the <code>unresolved external symbol</code>s in man, google them, or (if nothing else helps) <code>find</code>/<code>nm</code> (or something similar) might be an option as well."}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 10393129, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-tfHVGOJoiSg/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaNGvM4MXjVLMxhem4sz_oQn9h-dJA/mo/photo.jpg?sz=128", "display_name": "Kalyan Kumar", "link": "https://stackoverflow.com/users/10393129/kalyan-kumar"}, "edited": false, "score": 0, "creation_date": 1554309031, "post_id": 55490298, "comment_id": 97706777, "body": "I am looking from what are the thirdy party modules required to be included to avoid depedency issues"}], "tags": [], "owner": {"reputation": 810, "user_id": 6758890, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/230924dab4bae855003750ae34a3978a?s=128&d=identicon&r=PG&f=1", "display_name": "PintoDoido", "link": "https://stackoverflow.com/users/6758890/pintodoido"}, "is_accepted": false, "score": 1, "last_activity_date": 1554279529, "creation_date": 1554279529, "answer_id": 55490298, "question_id": 55488733, "link": "https://stackoverflow.com/questions/55488733/how-to-know-from-where-to-get-header-files-used-in-a-c-program/55490298#55490298", "title": "How to know from where to get header files used in a c program?", "body": "<p>To have an overview of how the header files are organized in a project, take a look at <a href=\"https://www.flourish.org/cinclude2dot/\" rel=\"nofollow noreferrer\"><strong>cinclude2dot</strong></a></p>\n\n<p>it will plot an #include <strong>dependency graph</strong> for your project.</p>\n"}], "owner": {"reputation": 29, "user_id": 10393129, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-tfHVGOJoiSg/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaNGvM4MXjVLMxhem4sz_oQn9h-dJA/mo/photo.jpg?sz=128", "display_name": "Kalyan Kumar", "link": "https://stackoverflow.com/users/10393129/kalyan-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1554279529, "creation_date": 1554274022, "last_edit_date": 1554278525, "question_id": 55488733, "link": "https://stackoverflow.com/questions/55488733/how-to-know-from-where-to-get-header-files-used-in-a-c-program", "title": "How to know from where to get header files used in a c program?", "body": "<p>I have a project which was implemented in C language some 10 years ago. As it's been a long time, I dont know about dependency libraries required to compile that project so I am getting all 'unresolved external symbol' errors.</p>\n\n<p>How do I know if I have a C file, it has plenty of header files, and then which header file belongs to which library? What are all softwares to be installed for those included header files?</p>\n"}, {"tags": ["c", "pointers", "linked-list"], "comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 2, "creation_date": 1554271850, "post_id": 55488170, "comment_id": 97684453, "body": "If you don&#39;t use a double pointer you&#39;ll be asking <i>this</i> question <a href=\"https://stackoverflow.com/questions/766893/how-do-i-modify-a-pointer-that-has-been-passed-into-a-function-in-c\" title=\"how do i modify a pointer that has been passed into a function in c\">stackoverflow.com/questions/766893/&hellip;</a>"}, {"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 1, "creation_date": 1554271945, "post_id": 55488170, "comment_id": 97684484, "body": "The question is not a duplicate <i>per se</i>, but the answer would be. ;-) So I closed the question as such."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 2, "creation_date": 1554271985, "post_id": 55488170, "comment_id": 97684497, "body": "@DevSolar - I edited another posts into the dupe list. All bases should be covered now."}, {"owner": {"reputation": 4703, "user_id": 5375464, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3292ca87ff6c766b75dbe4b2ea0831da?s=128&d=identicon&r=PG&f=1", "display_name": "J...S", "link": "https://stackoverflow.com/users/5375464/j-s"}, "edited": false, "score": 1, "creation_date": 1554272093, "post_id": 55488170, "comment_id": 97684538, "body": "If you haven&#39;t already, please see what happens when a double pointer is not used. That should give some idea."}], "owner": {"reputation": 125, "user_id": 7312795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/951de39043e83846af694a1b498ed3dc?s=128&d=identicon&r=PG", "display_name": "raven39", "link": "https://stackoverflow.com/users/7312795/raven39"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "closed_date": 1554271910, "answer_count": 0, "score": 2, "last_activity_date": 1554271958, "creation_date": 1554271744, "question_id": 55488170, "link": "https://stackoverflow.com/questions/55488170/why-use-double-pointer-when-inserting-node-to-the-head-linkedlist", "closed_reason": "Duplicate", "title": "Why use double pointer when inserting node to the head (linkedlist)?", "body": "<pre><code>int list_insert_head(node **phead, int data){\n  node *newnode = malloc(sizeof(node));\n  if(newnode == 0)\n    return 0; /*memory allocation failed*/\n  newnode -&gt; data = data;\n  newnode -&gt; next = *phead;\n  *phead = newnode; /* what is this?*/\n  return 1;\n\n}\n</code></pre>\n\n<p>So I'm not quite sure why you have to pass in double pointer **phead,\nand only use a single pointer *phead inside the function. \nI assume you use double pointer b/c you're manipulating actual head, which itself is a single pointer. \nInside the function by the way, if you were going to do this,</p>\n\n<pre><code>*phead = newnode;\n</code></pre>\n\n<p>why don't you just pass in *phead in the function parameter? </p>\n\n<p>Thank you.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 539, "user_id": 2805824, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tBgwo.gif?s=128&g=1", "display_name": "Gaurav Pathak", "link": "https://stackoverflow.com/users/2805824/gaurav-pathak"}, "edited": false, "score": 1, "creation_date": 1554270513, "post_id": 55487858, "comment_id": 97683997, "body": "Please take a look at this: <a href=\"https://stackoverflow.com/questions/15765289/what-is-the-difference-between-0-2lf-and-2lf-as-printf-placeholders\" title=\"what is the difference between 0 2lf and 2lf as printf placeholders\">stackoverflow.com/questions/15765289/&hellip;</a>"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1554270658, "post_id": 55487858, "comment_id": 97684054, "body": "A double doesn&#39;t remember what string it was scanned from."}, {"owner": {"reputation": 4703, "user_id": 5375464, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3292ca87ff6c766b75dbe4b2ea0831da?s=128&d=identicon&r=PG&f=1", "display_name": "J...S", "link": "https://stackoverflow.com/users/5375464/j-s"}, "edited": false, "score": 1, "creation_date": 1554271816, "post_id": 55487858, "comment_id": 97684441, "body": "Use <code>%g</code> format specifier."}, {"owner": {"reputation": 5754, "user_id": 2867061, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/cd59dfa471d99e7c625b5dcb191ec8ae?s=128&d=identicon&r=PG&f=1", "display_name": "user31264", "link": "https://stackoverflow.com/users/2867061/user31264"}, "edited": false, "score": 0, "creation_date": 1554273539, "post_id": 55487858, "comment_id": 97685113, "body": "For double, use %lg to remove trailing zeros."}], "owner": {"reputation": 11, "user_id": 11168580, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-fWD5quamIzc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcA6ZiqP5FNaOrMb_b9lpgzOO4fJQ/mo/photo.jpg?sz=128", "display_name": "LSD Gaga", "link": "https://stackoverflow.com/users/11168580/lsd-gaga"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "closed_date": 1554273026, "answer_count": 0, "score": 0, "last_activity_date": 1554272844, "creation_date": 1554270403, "question_id": 55487858, "link": "https://stackoverflow.com/questions/55487858/printing-correct-amount-of-digits-for-double-in-c", "closed_reason": "Duplicate", "title": "Printing correct amount of digits for double in C", "body": "<p>In C, is it possible to enter the correct amount of digits entered by user for a double? For instance, say I have the following code in the main body:</p>\n\n<pre><code>double num;\n\nscanf(\"%lf\", &amp;num); // User inputs 3.41\n\nprintf(\"%lf\", num); // required to display 3.41 instead of 3.410000\n</code></pre>\n\n<p>As I mentioned above, is there any way to display no more than the number of digits that the user entered?</p>\n"}, {"tags": ["c", "string", "initialization", "c-strings"], "answers": [{"comments": [{"owner": {"reputation": 704, "user_id": 8801881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1053cd1123d3bf1c159b18b97cf9c45b?s=128&d=identicon&r=PG&f=1", "display_name": "Hemil", "link": "https://stackoverflow.com/users/8801881/hemil"}, "edited": false, "score": 0, "creation_date": 1554270111, "post_id": 55487779, "comment_id": 97683876, "body": "Oh so others are set to 0 which is the same as &#39;\\0&#39;? And hence it works?"}, {"owner": {"reputation": 131156, "user_id": 235698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KjvlE.png?s=128&g=1", "display_name": "Mark Tolonen", "link": "https://stackoverflow.com/users/235698/mark-tolonen"}, "reply_to_user": {"reputation": 704, "user_id": 8801881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1053cd1123d3bf1c159b18b97cf9c45b?s=128&d=identicon&r=PG&f=1", "display_name": "Hemil", "link": "https://stackoverflow.com/users/8801881/hemil"}, "edited": false, "score": 0, "creation_date": 1554270142, "post_id": 55487779, "comment_id": 97683887, "body": "@Hemil Yes, exactly."}, {"owner": {"reputation": 1780, "user_id": 10988580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9885afb3fe782ac4c8e89a3b5904b8f6?s=128&d=identicon&r=PG&f=1", "display_name": "virolino", "link": "https://stackoverflow.com/users/10988580/virolino"}, "edited": false, "score": 0, "creation_date": 1554270347, "post_id": 55487779, "comment_id": 97683936, "body": "Depending on the implementation (and configuration), the remaining 99 chars might be random numbers, null or non-null."}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "reply_to_user": {"reputation": 1780, "user_id": 10988580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9885afb3fe782ac4c8e89a3b5904b8f6?s=128&d=identicon&r=PG&f=1", "display_name": "virolino", "link": "https://stackoverflow.com/users/10988580/virolino"}, "edited": false, "score": 1, "creation_date": 1554270484, "post_id": 55487779, "comment_id": 97683983, "body": "@virolino No. The array is initialized."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 1780, "user_id": 10988580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9885afb3fe782ac4c8e89a3b5904b8f6?s=128&d=identicon&r=PG&f=1", "display_name": "virolino", "link": "https://stackoverflow.com/users/10988580/virolino"}, "edited": false, "score": 1, "creation_date": 1554270484, "post_id": 55487779, "comment_id": 97683984, "body": "@virolino nope, they will be <code>0</code>, for sure. See my answer for the reason."}, {"owner": {"reputation": 131156, "user_id": 235698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KjvlE.png?s=128&g=1", "display_name": "Mark Tolonen", "link": "https://stackoverflow.com/users/235698/mark-tolonen"}, "reply_to_user": {"reputation": 1780, "user_id": 10988580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9885afb3fe782ac4c8e89a3b5904b8f6?s=128&d=identicon&r=PG&f=1", "display_name": "virolino", "link": "https://stackoverflow.com/users/10988580/virolino"}, "edited": false, "score": 0, "creation_date": 1554270686, "post_id": 55487779, "comment_id": 97684065, "body": "@virolino The standard says otherwise."}, {"owner": {"reputation": 1780, "user_id": 10988580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9885afb3fe782ac4c8e89a3b5904b8f6?s=128&d=identicon&r=PG&f=1", "display_name": "virolino", "link": "https://stackoverflow.com/users/10988580/virolino"}, "edited": false, "score": 0, "creation_date": 1554271000, "post_id": 55487779, "comment_id": 97684170, "body": "hmm... I was not aware of that specification. Thank you all."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1554273336, "post_id": 55487779, "comment_id": 97685027, "body": "AFAIK, <code>C89</code> is now obsolete, the correct one to quote would be the <code>C11</code>."}, {"owner": {"reputation": 131156, "user_id": 235698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KjvlE.png?s=128&g=1", "display_name": "Mark Tolonen", "link": "https://stackoverflow.com/users/235698/mark-tolonen"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1554273451, "post_id": 55487779, "comment_id": 97685074, "body": "@SouravGhosh Just pointing out it&#39;s been part of the standard all along, since virolino mentioned &quot;depending on the implementation&quot;.  Even old implementations do it."}], "tags": [], "owner": {"reputation": 131156, "user_id": 235698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KjvlE.png?s=128&g=1", "display_name": "Mark Tolonen", "link": "https://stackoverflow.com/users/235698/mark-tolonen"}, "is_accepted": true, "score": 8, "last_activity_date": 1554270867, "last_edit_date": 1554270867, "creation_date": 1554270008, "answer_id": 55487779, "question_id": 55487736, "link": "https://stackoverflow.com/questions/55487736/why-is-this-non-null-terminated-string-printed-correctly/55487779#55487779", "title": "Why is this non-null terminated string printed correctly", "body": "<p><code>str2[100] = {'a'};</code> does not fill <code>str2</code> with 100 repeated a.  It just sets str[0] to 'a' and the rest to zero.</p>\n\n<p>As far back as C89:</p>\n\n<blockquote>\n  <p>3.5.7 Initialization</p>\n  \n  <p>...</p>\n  \n  <p>Semantics</p>\n  \n  <p>...</p>\n  \n  <p>If an object that has static storage duration is not initialized\n  explicitly, it is initialized implicitly as if every member that has\n  arithmetic type were assigned 0 and every member that has pointer type\n  were assigned a null pointer constant.  If an object that has\n  automatic storage duration is not initialized explicitly, its value is\n  indeterminate./65/</p>\n  \n  <p>...</p>\n  \n  <p>If there are fewer initializers in a list than there are members of\n  an aggregate, the remainder of the aggregate shall be initialized\n  implicitly the same as objects that have static storage duration.</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1554273457, "post_id": 55487904, "comment_id": 97685078, "body": "You might want to point out that arrays are &quot;aggregates&quot; since the emphasis doesn&#39;t make sense by itself. An array is an aggregate and so every member is initialized (recursively), according to the rules above. If the element is a pointer, then to null, if it is an arithmetic type, then to zero."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1554273699, "post_id": 55487904, "comment_id": 97685178, "body": "@Lundin Right sir, added a note."}, {"owner": {"reputation": 704, "user_id": 8801881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1053cd1123d3bf1c159b18b97cf9c45b?s=128&d=identicon&r=PG&f=1", "display_name": "Hemil", "link": "https://stackoverflow.com/users/8801881/hemil"}, "edited": false, "score": 0, "creation_date": 1554342711, "post_id": 55487904, "comment_id": 97719103, "body": "I am sorry. I could only mark one answer as correct :("}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 3, "last_activity_date": 1554273679, "last_edit_date": 1592644375, "creation_date": 1554270595, "answer_id": 55487904, "question_id": 55487736, "link": "https://stackoverflow.com/questions/55487736/why-is-this-non-null-terminated-string-printed-correctly/55487904#55487904", "title": "Why is this non-null terminated string printed correctly", "body": "<p>First, the rule of initialization for aggregate types<sup>[1]</sup>, quoting <code>C11</code>, chapter 6.7.9 (<em>emphasis mine</em>)</p>\n<blockquote>\n<p>The initialization shall occur in initializer list order, each initializer provided for a particular subobject overriding any previously listed initializer for the same subobject;151) <strong>all subobjects that are not initialized explicitly shall be initialized implicitly the same as objects that have static storage duration.</strong></p>\n</blockquote>\n<p>and,</p>\n<blockquote>\n<p>If an object that has static or thread storage duration is not initialized explicitly, then:</p>\n<ul>\n<li><p>if it has pointer type, it is initialized to a null pointer;</p>\n</li>\n<li><p><strong>if it has arithmetic type, it is initialized to (positive or unsigned) zero;</strong></p>\n</li>\n<li><p>if it is an aggregate, every member is initialized (recursively) according to these rules, and any padding is initialized to zero bits;</p>\n</li>\n<li><p>if it is a union, the first named member is initialized (recursively) according to these rules, and any padding is initialized to zero bits;</p>\n</li>\n</ul>\n</blockquote>\n<p>Now, an initialization statement like</p>\n<pre><code>char str2[100] = {'a'};\n</code></pre>\n<p>will initialize <code>str2[0]</code> to <code>'a'</code>, and <code>str2[1]</code> through <code>str2[99]</code> with <code>0</code>, according to the above rule. That <code>0</code> value is the null-terminator for <em>strings</em>.</p>\n<p>Thus, any value you store there, lesser than the length of the array, up to the <code>length-1</code> element, is automatically going to be terminated by a null.</p>\n<p>So, you're okay to use the array as <em>string</em> and get the expected behavior of that of a string.</p>\n<hr />\n<p>[1]: Aggregate types:</p>\n<p>According to chapter 6.2.5/P21</p>\n<blockquote>\n<p><em>[...] Array and structure types are collectively called aggregate types.</em></p>\n</blockquote>\n"}], "owner": {"reputation": 704, "user_id": 8801881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1053cd1123d3bf1c159b18b97cf9c45b?s=128&d=identicon&r=PG&f=1", "display_name": "Hemil", "link": "https://stackoverflow.com/users/8801881/hemil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 55487779, "answer_count": 2, "score": 6, "last_activity_date": 1554273679, "creation_date": 1554269794, "last_edit_date": 1554273288, "question_id": 55487736, "link": "https://stackoverflow.com/questions/55487736/why-is-this-non-null-terminated-string-printed-correctly", "title": "Why is this non-null terminated string printed correctly", "body": "<p>Yesterday, I had my Unit Test. One of the programs was to copy strings and find out its length without the string functions. This was the code I wrote:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(){\n    char str1[100], str2[100] = {'a'};\n\n    printf(\"Enter a string\\n\");\n    fgets(str1, sizeof(str1), stdin);\n\n    int i;\n    for(i = 0; str1[i] != '\\0'; i++){\n        str2[i] = str1[i];\n    }   \n\n    str2[i] = '\\0';\n\n    printf(\"Copied string = %s\", str2);\n\n    printf(\"Length of string = %d\", i-1);\n}\n</code></pre>\n\n<p>I had a rather surprising observation! Even if a commented <code>str2[i] = '\\0'</code>, the string would be printed correctly i.e., without the extra <code>'a'</code>s in the initialization which should not be overwritten as per my knowledge.</p>\n\n<p>After commenting <code>str2[i] = '\\0'</code>, i expected to see this output:</p>\n\n<pre><code>test\nCopied string = testaaaaaaaaaaaaaaaaaaaaaaaaaaa....\nLength of string = 4\n</code></pre>\n\n<p>This is the output:</p>\n\n<pre><code>test\nCopied string = test\nLength of string = 4\n</code></pre>\n\n<p>How is <code>str2</code> printed correctly? Is it the fact that the compiler recognized the copying of the string and silently added the null termination? I am using gcc but clang also produces similar output.</p>\n"}, {"tags": ["python", "c", "numpy", "swig"], "comments": [{"owner": {"reputation": 131156, "user_id": 235698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KjvlE.png?s=128&g=1", "display_name": "Mark Tolonen", "link": "https://stackoverflow.com/users/235698/mark-tolonen"}, "edited": false, "score": 0, "creation_date": 1554275927, "post_id": 55487704, "comment_id": 97686214, "body": "Can you make a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> illustrating the problem?"}], "answers": [{"tags": [], "owner": {"reputation": 131156, "user_id": 235698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KjvlE.png?s=128&g=1", "display_name": "Mark Tolonen", "link": "https://stackoverflow.com/users/235698/mark-tolonen"}, "is_accepted": true, "score": 2, "last_activity_date": 1554276207, "creation_date": 1554276207, "answer_id": 55489308, "question_id": 55487704, "link": "https://stackoverflow.com/questions/55487704/do-i-need-a-swig-typemap-to-have-a-c-function-return-a-float-to-python/55489308#55489308", "title": "Do I need a SWIG typemap to have a c function return a float to python?", "body": "<p>Returning <code>float</code> \"just works\".  You don't need additional typemaps:</p>\n\n<p><strong>test.i</strong></p>\n\n<pre><code>%module test\n\n%inline %{\n    float func(void) { return 1.5; }\n%}\n</code></pre>\n\n<p>After running swig and compiling the result:</p>\n\n<pre><code>&gt;&gt;&gt; import test\n&gt;&gt;&gt; test.func()\n1.5\n</code></pre>\n"}], "owner": {"reputation": 2669, "user_id": 379360, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/f15f76b1c0a34c351fe5ba148faaacde?s=128&d=identicon&r=PG", "display_name": "EMiller", "link": "https://stackoverflow.com/users/379360/emiller"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 55489308, "answer_count": 1, "score": 2, "last_activity_date": 1554300336, "creation_date": 1554269641, "last_edit_date": 1554300336, "question_id": 55487704, "link": "https://stackoverflow.com/questions/55487704/do-i-need-a-swig-typemap-to-have-a-c-function-return-a-float-to-python", "title": "Do I need a SWIG typemap to have a c function return a float to python?", "body": "<p>I'm trying to call a C function from python. This function takes a number of arrays as input and returns a float.</p>\n\n<p>Do I need a SWIG typemap to do this? One concern is that python doesn't make a distinction between <code>floats</code>, <code>double</code>, etc and I'm specifically interested in returning only c-type <code>float</code>.</p>\n"}, {"tags": ["c", "algorithm", "sorting"], "comments": [{"owner": {"reputation": 720, "user_id": 10696884, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-TZLhm3qAv5U/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-gTJ8AUH3mkzlYyEQgF0K4AqDVXLw/mo/photo.jpg?sz=128", "display_name": "Thomas Lang", "link": "https://stackoverflow.com/users/10696884/thomas-lang"}, "edited": false, "score": 0, "creation_date": 1554268968, "post_id": 55487570, "comment_id": 97683539, "body": "Please note that this is <i>not</i> bubble sorting, since bubble sorting needs a comparison against all succeeding elements and thus is quadratic in runtime."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 4, "creation_date": 1554269009, "post_id": 55487570, "comment_id": 97683547, "body": "Maybe you just count the number of -1s, 0s and 1. Then reproduce an array with the correct number of each starting at -1 first.."}, {"owner": {"reputation": 1370, "user_id": 4682302, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/4187c619fda650f970566c5f47f3fe75?s=128&d=identicon&r=PG&f=1", "display_name": "JKLM", "link": "https://stackoverflow.com/users/4682302/jklm"}, "edited": false, "score": 0, "creation_date": 1554269019, "post_id": 55487570, "comment_id": 97683549, "body": "I dont need any specific algorithm I just need to verify complexity of the algorithm I wrote"}, {"owner": {"reputation": 17343, "user_id": 445976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c82b2b9bdcf1baaf4677238d59cf745f?s=128&d=identicon&r=PG", "display_name": "Blastfurnace", "link": "https://stackoverflow.com/users/445976/blastfurnace"}, "edited": false, "score": 3, "creation_date": 1554270313, "post_id": 55487570, "comment_id": 97683927, "body": "<a href=\"https://en.wikipedia.org/wiki/Dutch_national_flag_problem\" rel=\"nofollow noreferrer\">Dutch national flag problem</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1370, "user_id": 4682302, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/4187c619fda650f970566c5f47f3fe75?s=128&d=identicon&r=PG&f=1", "display_name": "JKLM", "link": "https://stackoverflow.com/users/4682302/jklm"}, "edited": false, "score": 0, "creation_date": 1554269215, "post_id": 55487614, "comment_id": 97683601, "body": "is it possible to improve it to O(n)?"}, {"owner": {"reputation": 2933, "user_id": 6350858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bfeae5d1ddef3ed5e81e88bdd30063f?s=128&d=identicon&r=PG&f=1", "display_name": "Ap31", "link": "https://stackoverflow.com/users/6350858/ap31"}, "edited": false, "score": 1, "creation_date": 1554269291, "post_id": 55487614, "comment_id": 97683628, "body": "it is definitely possible to do it in O(n), you can check out how quicksort works, it can give you a general idea"}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 1370, "user_id": 4682302, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/4187c619fda650f970566c5f47f3fe75?s=128&d=identicon&r=PG&f=1", "display_name": "JKLM", "link": "https://stackoverflow.com/users/4682302/jklm"}, "edited": false, "score": 1, "creation_date": 1554269292, "post_id": 55487614, "comment_id": 97683629, "body": "@JKLM, I don&#39;t know of any sorting algorithm that can perform better than O(N.log(N)). If there is any, I will be glad to educate myself."}, {"owner": {"reputation": 2933, "user_id": 6350858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bfeae5d1ddef3ed5e81e88bdd30063f?s=128&d=identicon&r=PG&f=1", "display_name": "Ap31", "link": "https://stackoverflow.com/users/6350858/ap31"}, "edited": false, "score": 2, "creation_date": 1554269358, "post_id": 55487614, "comment_id": 97683658, "body": "the trick is, with elements only being of 3 different values, it&#39;s more of a &quot;partition&quot; than a &quot;sort&quot;"}, {"owner": {"reputation": 5181, "user_id": 5529197, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6af647bacfb3f0b596c73b0e3b0dc4b1?s=128&d=identicon&r=PG&f=1", "display_name": "Afshin", "link": "https://stackoverflow.com/users/5529197/afshin"}, "edited": false, "score": 0, "creation_date": 1554269404, "post_id": 55487614, "comment_id": 97683676, "body": "radix sort maybe?"}, {"owner": {"reputation": 1370, "user_id": 4682302, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/4187c619fda650f970566c5f47f3fe75?s=128&d=identicon&r=PG&f=1", "display_name": "JKLM", "link": "https://stackoverflow.com/users/4682302/jklm"}, "reply_to_user": {"reputation": 5181, "user_id": 5529197, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6af647bacfb3f0b596c73b0e3b0dc4b1?s=128&d=identicon&r=PG&f=1", "display_name": "Afshin", "link": "https://stackoverflow.com/users/5529197/afshin"}, "edited": false, "score": 0, "creation_date": 1554269411, "post_id": 55487614, "comment_id": 97683678, "body": "@Afshin the main limitation is I need to use only swapping I&#39;m not sure about counting sort"}, {"owner": {"reputation": 15921, "user_id": 1542723, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8a969ba62fc77da0a20654caffbe234?s=128&d=identicon&r=PG", "display_name": "Ferrybig", "link": "https://stackoverflow.com/users/1542723/ferrybig"}, "edited": false, "score": 0, "creation_date": 1554273269, "post_id": 55487614, "comment_id": 97685004, "body": "@RSahu what about using binary search to insert an item at specific place in a linked list? While the last item has a cost of <code>log(n)</code>, the item before that has a cost of <code>log(n-1)</code> and so on, for a total cost lower than <code>O(n.log(n))</code>. Or am I misunderstanding the big O notation?"}], "tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": false, "score": 5, "last_activity_date": 1554269076, "creation_date": 1554269076, "answer_id": 55487614, "question_id": 55487570, "link": "https://stackoverflow.com/questions/55487570/sorting-in-on-without-any-temp-variable/55487614#55487614", "title": "Sorting in O(n) without any temp variable", "body": "<p>The algorithm is definitely not O(n).<br>\nYou are setting <code>i</code> to <code>0</code> when you do a swap. At worst, it is O(n^2).</p>\n"}, {"comments": [{"owner": {"reputation": 1370, "user_id": 4682302, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/4187c619fda650f970566c5f47f3fe75?s=128&d=identicon&r=PG&f=1", "display_name": "JKLM", "link": "https://stackoverflow.com/users/4682302/jklm"}, "edited": false, "score": 0, "creation_date": 1554307708, "post_id": 55493880, "comment_id": 97706059, "body": "Thank you @fjardon"}], "tags": [], "owner": {"reputation": 7450, "user_id": 657700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb044bd9a9f6548b9a9bae44617c97c7?s=128&d=identicon&r=PG", "display_name": "fjardon", "link": "https://stackoverflow.com/users/657700/fjardon"}, "is_accepted": true, "score": 1, "last_activity_date": 1554290210, "creation_date": 1554290210, "answer_id": 55493880, "question_id": 55487570, "link": "https://stackoverflow.com/questions/55487570/sorting-in-on-without-any-temp-variable/55493880#55493880", "title": "Sorting in O(n) without any temp variable", "body": "<p>The reason why your algorithm has been stated correctly by @RSahu, you are resetting the counter to 0 which means you can do as much as <code>1+2+...+n</code> iterations.</p>\n\n<p>Here is a small example exhibiting linear time to process the array:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;array&gt;\n\nusing namespace std;\n\nint main() {\n    array&lt;int,10&gt; A{-1, 0, -1, 0, 1, 1, 0, 1, 0, -1};\n\n    int i=0,j=0, k=9;\n    while(j!=k) {\n        if(A[j] == 0) {\n            ++j;\n        }\n        else if(A[j] == -1) {\n            swap(A[i], A[j]);\n            ++i; ++j;\n        }\n        else {\n            swap(A[j], A[k]);\n            --k;\n        }\n    }\n\n    for(auto ai : A)\n        cout &lt;&lt; ai &lt;&lt; \" \";\n    cout &lt;&lt; endl;\n}\n</code></pre>\n\n<p>You can see it live <a href=\"https://coliru.stacked-crooked.com/a/82c7cee92159c026\" rel=\"nofollow noreferrer\">there</a>.</p>\n\n<p>How does it work ? We maintain three counters <code>i</code>, <code>j</code> and <code>k</code> with the invariants that:</p>\n\n<ul>\n<li>all items in the range: <code>[0, i)</code> are <code>-1</code></li>\n<li>all items in the range: <code>[i, j)</code> are <code>0</code></li>\n<li>all items in the range: <code>(k, n-1)</code> are <code>+1</code></li>\n</ul>\n\n<p>Where <code>[</code> means an inclusive bound, and <code>)</code> or <code>(</code> means an exclusive bound.</p>\n\n<p><strong>Initially</strong></p>\n\n<p><code>i=j=0</code> and 'k=n-1`. The invariants are respected.</p>\n\n<p><strong>First case</strong></p>\n\n<pre><code>if(A[j] == 0) {\n    ++j;\n}\n</code></pre>\n\n<p>The value of <code>A[j]</code> is 0, so we can increment <code>j</code> and the invariants still hold.</p>\n\n<p><strong>Second case</strong></p>\n\n<pre><code>else if(A[j] == -1) {\n    swap(A[i], A[j]);\n    ++i; ++j;\n}\n</code></pre>\n\n<p>As <code>i</code> is an exclusive bound, we are adding a <code>-1</code> to the previous range of <code>-1</code> and the increment of <code>i</code> is needed. If the range <code>[i, j)</code> was not empty, a <code>0</code> has been copied to position <code>j</code> and we must increment <code>j</code>. If the range was empty, then we had <code>i==j</code>, and as we increment <code>i</code> we must also increment <code>j</code> to keep the invariant. We can conclude that the invariants still hold after this step.</p>\n\n<p><strong>Third case</strong></p>\n\n<pre><code>else {\n    swap(A[j], A[k]);\n    --k;\n}\n</code></pre>\n\n<p><code>A[j]</code> is <code>0</code> we can swap it with the value at <code>A[k]</code> and decrement <code>k</code> and the invariants will hold.</p>\n\n<p><strong>Termination and correctness</strong></p>\n\n<p>The final point is proving the program will terminate. Each step either:\n - increment <code>j</code>\n - decrement <code>k</code>\nSo the distance between <code>j</code> and <code>k</code> will decrease by 1 every step.</p>\n\n<p>The distance between <code>j</code> and <code>k</code> is initially <code>n-1</code>, and decreases by one every step. So there will be at most <code>n-1</code> steps. Each step does one swap. There will be at most <code>n-1</code> swaps.</p>\n\n<p>At the end of the program the invariants will hold:</p>\n\n<ul>\n<li>from <code>0</code> to <code>i</code> excluded, all <code>-1</code></li>\n<li>from <code>i</code> to <code>j==k</code> excluded, all <code>0</code></li>\n<li>from <code>j==k</code> to <code>n-1</code> excluded, all <code>+1</code></li>\n</ul>\n"}], "owner": {"reputation": 1370, "user_id": 4682302, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/4187c619fda650f970566c5f47f3fe75?s=128&d=identicon&r=PG&f=1", "display_name": "JKLM", "link": "https://stackoverflow.com/users/4682302/jklm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 161, "favorite_count": 0, "accepted_answer_id": 55493880, "answer_count": 2, "score": 1, "last_activity_date": 1554290210, "creation_date": 1554268831, "last_edit_date": 1554270309, "question_id": 55487570, "link": "https://stackoverflow.com/questions/55487570/sorting-in-on-without-any-temp-variable", "title": "Sorting in O(n) without any temp variable", "body": "<p>I need to design an algorithm which will sort an array which contains numbers -1,0,1 only, without using any temp variable or array and by using only swapping I have come up with the following method I'm not sure if it is O(n).</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdio.h&gt;\n#define MAXSIZE 10\n\nint main()\n{\n    int array[MAXSIZE];\n    int i, j, num = 8, temp;\n\n    int list[] = {-1,0,-1,0,1,1,0,1};\n\n    int size = sizeof(list)/sizeof(list[0]);\n    for (int i = 1; i &lt; size; i++) {\n\n        if (list[i] &lt; list[i - 1]) {\n            list[i] = list[i] + list[i - 1];\n            list[i - 1] = list[i] - list[i - 1];\n            list[i] = list[i] - list[i - 1];\n            i = 0;\n        }\n    }\n\n    printf(\"Sorted array is...\\n\");\n    for (int i = 0; i &lt; size; i++)\n    {\n        printf(\"%d\\n\", list[i]);\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "sensors", "arduino-uno"], "comments": [{"owner": {"reputation": 539, "user_id": 2805824, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tBgwo.gif?s=128&g=1", "display_name": "Gaurav Pathak", "link": "https://stackoverflow.com/users/2805824/gaurav-pathak"}, "edited": false, "score": 0, "creation_date": 1554269899, "post_id": 55487130, "comment_id": 97683817, "body": "There can be an issue with the sound sensor itself, or there might be a possibility that the Arduino is picking up some spike from the sensor on Digital pin. Try connecting a 0.1uF ceramic capacitor across Digital Input pin and Ground and let us know if it works! Also, try printing the value of <code>SensorData</code> variable on serial console after <code>SensorData=digitalRead(soundSensor);</code> to debug what actually is happening."}, {"owner": {"reputation": 1, "user_id": 8241945, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/827d326e1ce0847da54f3fda9dcef8ed?s=128&d=identicon&r=PG&f=1", "display_name": "Roger Dessal", "link": "https://stackoverflow.com/users/8241945/roger-dessal"}, "reply_to_user": {"reputation": 539, "user_id": 2805824, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tBgwo.gif?s=128&g=1", "display_name": "Gaurav Pathak", "link": "https://stackoverflow.com/users/2805824/gaurav-pathak"}, "edited": false, "score": 0, "creation_date": 1554272823, "post_id": 55487130, "comment_id": 97684816, "body": "Hi! , Thank you for your answer. I did a quick reading of the SoundSensor and the value is 2 when i place it at the end of the if, as i set inside the If statement.  Therefore i suspected a problem with the code but i still do not understand why on the first 2 cases it works and not on the 3rd and 4th :(. I will Try connecting a 0.1uF ceramic capacitor as you said and see what happens. Thanks!"}], "owner": {"reputation": 1, "user_id": 8241945, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/827d326e1ce0847da54f3fda9dcef8ed?s=128&d=identicon&r=PG&f=1", "display_name": "Roger Dessal", "link": "https://stackoverflow.com/users/8241945/roger-dessal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1554266014, "creation_date": 1554266014, "question_id": 55487130, "link": "https://stackoverflow.com/questions/55487130/sound-sensor-for-arduino-uno", "title": "Sound sensor for Arduino Uno", "body": "<p>I got a short time ago an Arduino Kit, and i am trying a little project. Using a Sound sensor i want to sequentially turn on 3 leds. Meaning one clap turns LED1, then a second one the second one and so on. Problem is that this happens only for LED 1 and LED2, and without waiting for the third clap the third LED turns on and without a 4th clap the lights go off, even though i am counting them and resetting the value from the sensor. \nI cannot understand why this code works for the first and second Leds but the 3rd and 4th stages are going automatically .\nThanks!</p>\n\n<p>I tried the following code, but it works only for the first and second LED, when the counter is 0 and 1, when it reaches 2, or 3 it activates even though i am not activating the sensor.</p>\n\n<pre><code>\nint soundSensor=2;\nint LED1=4;\nint LED2=5;\nint LED3=6;\nint counter =0;\n int SensorData=0;\n\nvoid setup() {\n  Serial.begin(9600);\n pinMode(soundSensor,INPUT);\n pinMode(LED1,OUTPUT);\n  pinMode(LED2,OUTPUT);\n   pinMode(LED3,OUTPUT);\n counter = 0;\n\n\n}\n\nvoid loop() {\n\n\n  SensorData=digitalRead(soundSensor); \n\n\n  if(SensorData==1 &amp;&amp; counter == 0){    \n        digitalWrite(LED1,HIGH);\n        counter++;\n        SensorData=2;\n        delay(1000);\n  }\n  if(SensorData==1 &amp;&amp; counter == 1){\n        digitalWrite(LED2,HIGH);\n        counter++;\n        SensorData=2;\n        delay(1000);\n  }\n    if(SensorData==1 &amp;&amp; counter == 2){\n        digitalWrite(LED3,HIGH);\n        counter++;\n        SensorData=2;\n        delay(1000);  \n     }\n      if(SensorData==1 &amp;&amp; counter == 3){\n        digitalWrite(LED1,LOW);\n        digitalWrite(LED2,LOW);\n        digitalWrite(LED3,LOW);\n        counter++;\n        SensorData=2;\n        delay(1000);\n         counter =0;\n     }\n\n  }\n\n</code></pre>\n"}, {"tags": ["c++", "c", "mips", "system-calls", "google-breakpad"], "owner": {"reputation": 35, "user_id": 11146640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66dfea8d465f42de9ec9e1a952f35f16?s=128&d=identicon&r=PG&f=1", "display_name": "Hongyu.Zhang", "link": "https://stackoverflow.com/users/11146640/hongyu-zhang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 125, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1554265671, "creation_date": 1554265671, "question_id": 55487080, "link": "https://stackoverflow.com/questions/55487080/google-breakpad-threadentry-function-crash-on-mips-architecture", "title": "Google breakpad ThreadEntry function crash on MIPS architecture", "body": "<p>I had download Google breakpad source to do some testing, the demo can work normal on X64 and ARM64, but on MIPS64 it does not generate minidump file and child thread will crash after sys_clone under ExceptionHandler::GenerateDump();\nI checked the input address of the child thread, found the address is reduced by 16 bytes, my kernel revision is :</p>\n\n<pre><code>[root@neo7 breakpad-master]# uname -r\n3.10.0-514.26.2.ns7.030.mips64el\n</code></pre>\n\n<p>My test code is :</p>\n\n<pre><code>#include \"../src/client/linux/handler/exception_handler.h\"\n#include &lt;pthread.h&gt;\n#include &lt;iostream&gt;\nusing namespace std;\n\nstatic bool dumpCallback(const google_breakpad::MinidumpDescriptor &amp;descriptor,\n                     void *context,\n                     bool succeeded)\n{\n   printf(\"Dump path: %s\\n\", descriptor.path());\n    char cmd[512] = {0};\n    snprintf(cmd, sizeof(cmd), \"echo %s &gt; dump_name\", descriptor.path());\n    system(cmd);\n    return succeeded;\n}\n\nvoid *TestThread(void* arg)\n{\n    int input = *(int*)arg;\n    int *a = (int *)(NULL);\n    *a = 1;\n}\n\nint main(int argc, char *argv[])\n{\n    google_breakpad::MinidumpDescriptor descriptor(\"/tmp\");\n    google_breakpad::ExceptionHandler eh(descriptor,\n                     NULL,\n                     dumpCallback,\n                     NULL,\n                     true,\n                     -1);\n    //crashHare();\n    pthread_t threadId;\n    int input = 12;\n    int ret = pthread_create(&amp;threadId, NULL, TestThread, (void*)&amp;input);\n    if(ret != 0)\n    {\n        cout&lt;&lt; \"create thread error\"&lt;&lt;endl;\n    }\n\n    cout&lt;&lt;\"main thread running\"&lt;&lt;endl;\n    pthread_join(threadId,NULL);\n    return 0;\n}\n</code></pre>\n\n<p>I add some printf in ./src/client/linux/handler/exception_handler.cc, before sys_clone and after ThreadEntry, the log is :</p>\n\n<pre><code>struct ThreadArgument {\n  pid_t pid;  // the crashing process\n  const MinidumpDescriptor* minidump_descriptor;\n  ExceptionHandler* handler;\n  const void* context;  // a CrashContext structure\n  size_t context_size;\n};\nThreadArgument thread_arg;\nthread_arg.handler = this;\nthread_arg.minidump_descriptor = &amp;minidump_descriptor_;\nthread_arg.pid = getpid();\nthread_arg.context = context;\nthread_arg.context_size = sizeof(*context);\n\nzzzzzzz &amp;thread_arg:f10ee460  (before sys_clone)\nconst pid_t child = sys_clone(\n  ThreadEntry, stack, CLONE_FS | CLONE_UNTRACED, &amp;thread_arg, NULL, NULL,\n  NULL);\nzzzzzzz child 23889\n\nint ExceptionHandler::ThreadEntry(void *arg) {\nzzzzzzz ThreadEntry \nzzzzzzz arg:f10ee450  (child thread)\n</code></pre>\n\n<p>if the type of thread_arg is a int *, there is no address offset problem. If add prefix static for thread_arg, there is no address offset problem too.</p>\n\n<pre><code>static ThreadArgument thread_arg;  /* The same goes for malloc, but malloc is not safe */\nzzzzzzz &amp;thread_arg:20030060  (before sys_clone)\nconst pid_t child = sys_clone(\n  ThreadEntry, stack, CLONE_FS | CLONE_UNTRACED, &amp;thread_arg, NULL, NULL,\n  NULL);\nzzzzzzz child 22399\n\nint ExceptionHandler::ThreadEntry(void *arg) {\nzzzzzzz ThreadEntry \nzzzzzzz arg:20030060  (child thread)\n</code></pre>\n\n<p>And I write an another code to test sys_clone under signal processing function:</p>\n\n<pre><code>#include &lt;errno.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;linux/limits.h&gt;\n#include &lt;pthread.h&gt;\n#include &lt;sched.h&gt;\n#include &lt;signal.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;sys/mman.h&gt;\n#include &lt;sys/prctl.h&gt;\n#include &lt;sys/syscall.h&gt;\n#include &lt;sys/wait.h&gt;\n#include &lt;unistd.h&gt;\n\n#include &lt;sys/signal.h&gt;\n#include &lt;sys/ucontext.h&gt;\n#include &lt;sys/user.h&gt;\n#include &lt;ucontext.h&gt;\n\n#include &lt;algorithm&gt;\n#include &lt;utility&gt;\n#include &lt;vector&gt;\n\n#include \"src/third_party/lss/linux_syscall_support.h\"\n#include \"src/common/memory_allocator.h\"\nusing namespace google_breakpad;\nunsigned char *stack = NULL;\n\nvoid my_memset(void* ip, char c, size_t len) {\n  char* p = (char *) ip;\n  while (len--)\n    *p++ = c;\n}\n\nstruct ThreadArgument {\n  pid_t pid;  // the crashing process\n  const void* minidump_descriptor;\n  void* handler;\n  const void* context;  // a CrashContext structure\n  size_t context_size;\n};\n\nint ThreadEntry(void *arg) {\n  printf(\"arg:%x\\n\", arg);\n  const ThreadArgument *thread_arg = reinterpret_cast&lt;ThreadArgument*&gt;(arg);\n  printf(\"thread_arg:%x\\n\", thread_arg);\n  return 0;\n}\nvoid GenerateDump(int signo) {\n  static const unsigned kChildStackSize = 16000;\n  PageAllocator allocator;\n  uint8_t* stack = reinterpret_cast&lt;uint8_t*&gt;(allocator.Alloc(kChildStackSize));\n  if (!stack)\n    return ;\n  stack += kChildStackSize;\n  my_memset(stack - 16, 0, 16);\n\n  ThreadArgument thread_arg;\n  thread_arg.handler = (void *) NULL;\n  thread_arg.minidump_descriptor = (void *) NULL;\n  thread_arg.pid = getpid();\n  thread_arg.context = (void *) NULL;\n  thread_arg.context_size = sizeof(void *);\n  printf(\"thread_arg:%x\\n\", &amp;thread_arg);\n  const pid_t child = sys_clone(\n  ThreadEntry, stack, CLONE_FS | CLONE_UNTRACED, &amp;thread_arg, NULL, NULL,\n  NULL);\n  printf(\"child:%d\\n\", child);\n  sleep(1);\n  return ;\n}\n\nint main(void)\n{\n    signal(SIGSEGV, GenerateDump);\n    int *a = (int *)NULL;\n    *a = 1;\n\n    return 0;\n}\n</code></pre>\n\n<p>It works normal: </p>\n\n<pre><code>thread_arg:ffcb9030\nchild:8447\narg:ffcb9030\nthread_arg:ffcb9030\n</code></pre>\n\n<p>I wonder why passing the contents of the stack as parameters causes this \n address mismatch problem in breakpad.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 1, "creation_date": 1554266479, "post_id": 55487055, "comment_id": 97682831, "body": "the correct fix is to use <code>struct channel *channel</code> since that&#39;s what it is. If you really <i>insist</i> it should be this <code>void *</code>, then you should know the precedence of casts: <code>((struct channel *)channel)-&gt;</code>. Easier to <i>assign</i> to a temporary of type <code>struct channel *</code> anyway though."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1554267683, "post_id": 55487055, "comment_id": 97683185, "body": "OT: <code>makeChannel()</code> misses to initialise <code>qhead</code> and <code>qtail</code>. You probably want to set them to <code>NULL</code>."}], "answers": [{"tags": [], "owner": {"reputation": 1220, "user_id": 796375, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kYKRy.jpg?s=128&g=1", "display_name": "cfillion", "link": "https://stackoverflow.com/users/796375/cfillion"}, "is_accepted": false, "score": 3, "last_activity_date": 1554266287, "creation_date": 1554266287, "answer_id": 55487171, "question_id": 55487055, "link": "https://stackoverflow.com/questions/55487055/how-to-access-struct-members-from-pointer/55487171#55487171", "title": "How to access struct members from pointer", "body": "<p>The operator <code>-&gt;</code> has lower precedence and so is evaluated first. <code>channel</code> is a void pointer so, when <code>channel-&gt;</code> de-references it, you obtain a value of type <code>void</code> instead of the expected <code>struct channel</code>.</p>\n\n<p>Add parenthesis around the cast and <code>channel</code> (or pass <code>channel</code> around as a <code>struct channel *</code> rather than <code>void*</code> to avoid repeated casting):</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>((struct channel *)channel)-&gt;qtail-&gt;next = head;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 12260, "user_id": 1730895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6abb0b52473d614852289b49ccf3c3c?s=128&d=identicon&r=PG", "display_name": "Kingsley", "link": "https://stackoverflow.com/users/1730895/kingsley"}, "is_accepted": true, "score": 3, "last_activity_date": 1554266291, "creation_date": 1554266291, "answer_id": 55487172, "question_id": 55487055, "link": "https://stackoverflow.com/questions/55487055/how-to-access-struct-members-from-pointer/55487172#55487172", "title": "How to access struct members from pointer", "body": "<p>It's not valid to de-reference a <code>void*</code> pointer.  The de-referencing is basically a numerical off-set from the base-pointer.  If the compiler does not know what type the pointer is, how can it know the offset amount, nor is it able to decide whether the member reference is actually valid.</p>\n\n<p>In your function it is cast,   It looks like there's a stray <code>&amp;</code>.</p>\n\n<pre><code>void sendChannel(void *channel, void *fetchAddress)\n{\n    struct channel *chan = (struct channel *)channel;\n\n    if( capChannel( chan ) == lenChannel( chan ) )\n    {\n        chan-&gt;qtail-&gt;next = head;\n    }\n}\n</code></pre>\n\n<p>But your cast is not applied to anything.  I prefer to make the cast explicit, by assigning it to a temporary local variable.  I feel this makes the resultant code more readable, as it's not full of type-casts here &amp; there.</p>\n"}], "owner": {"reputation": 69, "user_id": 10481656, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-d8segTocgrk/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVBRrjI7rdT0vl10Bg1OEx_HklxiQ/mo/photo.jpg?sz=128", "display_name": "Jordan Felt", "link": "https://stackoverflow.com/users/10481656/jordan-felt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "closed_date": 1554273091, "accepted_answer_id": 55487172, "answer_count": 2, "score": 1, "last_activity_date": 1554266291, "creation_date": 1554265544, "question_id": 55487055, "link": "https://stackoverflow.com/questions/55487055/how-to-access-struct-members-from-pointer", "closed_reason": "Duplicate", "title": "How to access struct members from pointer", "body": "<p>I'm having trouble accessing a struct's members when passed a void* pointer to that structure's base address. Can anyone offer a solution or explain the error to me? Right now I get the message \"goroutines.c:142:31: error: request for member \u2018qtail\u2019 in something not a structure or union\"</p>\n\n<pre><code>    //Channel struct\nstruct channel{\n    int magicnumber;\n    int length;\n    int capacity;\n\n    struct gcb* qhead; //head of the queue\n    struct gcb* qtail; //tail of the queue\n};\n\n\nvoid *makeChannel(int dataLength, int capacity){\n  if( dataLength &lt;= 0){\n    panic( \"data length must be greater than zero\" );\n  }\n  if( capacity &lt; 0){\n    panic( \"capacity must be non-negative\" );\n  }\n  struct channel* ch = (struct channel* )malloc( dataLength * capacity );\n  ch-&gt;magicnumber = 0x1ca91ac3;\n  ch-&gt;capacity = capacity;\n  ch-&gt;length = 0;\n  return ch;\n}\n\nvoid sendChannel(void *channel, void *fetchAddress){\n  if( capChannel( channel ) == lenChannel( channel ) ){\n\n    (struct channel* )&amp;channel-&gt;qtail-&gt;next = head;\n  }\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "string", "char"], "comments": [{"owner": {"reputation": 1805, "user_id": 6284997, "user_type": "registered", "accept_rate": 45, "profile_image": "https://graph.facebook.com/1376431542382698/picture?type=large", "display_name": "MayurK", "link": "https://stackoverflow.com/users/6284997/mayurk"}, "edited": false, "score": 0, "creation_date": 1554264705, "post_id": 55486920, "comment_id": 97682454, "body": "That is becase you are printing letters while finding out palindrome in palindromelength(). There are multiple ways, one approach is to find out the largest palindrome first and then print."}, {"owner": {"reputation": 19, "user_id": 11277499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcb2689e8ae0b0a8d72d40c7e4b85f09?s=128&d=identicon&r=PG&f=1", "display_name": "serene", "link": "https://stackoverflow.com/users/11277499/serene"}, "reply_to_user": {"reputation": 1805, "user_id": 6284997, "user_type": "registered", "accept_rate": 45, "profile_image": "https://graph.facebook.com/1376431542382698/picture?type=large", "display_name": "MayurK", "link": "https://stackoverflow.com/users/6284997/mayurk"}, "edited": false, "score": 0, "creation_date": 1554264956, "post_id": 55486920, "comment_id": 97682499, "body": "@MayurK I thought that was what I was doing? what would be the algorithm of what you are talking about?"}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 11277499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcb2689e8ae0b0a8d72d40c7e4b85f09?s=128&d=identicon&r=PG&f=1", "display_name": "serene", "link": "https://stackoverflow.com/users/11277499/serene"}, "edited": false, "score": 0, "creation_date": 1554296941, "post_id": 55487025, "comment_id": 97699039, "body": "I am not sure what you mean by i=i_initial. Since I am starting from 0 for this particular code i would mean 0 right?  in str[i]=str[j], if I print both of them it just prints the letters twice. I added printf statements in my original code to show the i and j values that gets printed. It&#39;s edited in my code here. Also thatnk you for pointing out about the palindrome length!"}, {"owner": {"reputation": 1805, "user_id": 6284997, "user_type": "registered", "accept_rate": 45, "profile_image": "https://graph.facebook.com/1376431542382698/picture?type=large", "display_name": "MayurK", "link": "https://stackoverflow.com/users/6284997/mayurk"}, "reply_to_user": {"reputation": 19, "user_id": 11277499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcb2689e8ae0b0a8d72d40c7e4b85f09?s=128&d=identicon&r=PG&f=1", "display_name": "serene", "link": "https://stackoverflow.com/users/11277499/serene"}, "edited": false, "score": 0, "creation_date": 1554297278, "post_id": 55487025, "comment_id": 97699276, "body": "I mean at the beginning of palindromelength() save the original i value (int i_initial=i;) Whenever you find that str[i]!=str[j], you need to restart the search. For example, take this string and try to analyze the logic. - &quot;abcbaxyzba&quot; The output should be &quot;abcba&quot; right? See whether your function is returning it."}, {"owner": {"reputation": 1805, "user_id": 6284997, "user_type": "registered", "accept_rate": 45, "profile_image": "https://graph.facebook.com/1376431542382698/picture?type=large", "display_name": "MayurK", "link": "https://stackoverflow.com/users/6284997/mayurk"}, "reply_to_user": {"reputation": 19, "user_id": 11277499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcb2689e8ae0b0a8d72d40c7e4b85f09?s=128&d=identicon&r=PG&f=1", "display_name": "serene", "link": "https://stackoverflow.com/users/11277499/serene"}, "edited": false, "score": 0, "creation_date": 1554297416, "post_id": 55487025, "comment_id": 97699370, "body": "One more example: Assume string is &quot;123abcbaxyzba&quot;. When i=3, the palindrome string should be &quot;abcba&quot;. Is your current logic capable of finding this?"}, {"owner": {"reputation": 19, "user_id": 11277499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcb2689e8ae0b0a8d72d40c7e4b85f09?s=128&d=identicon&r=PG&f=1", "display_name": "serene", "link": "https://stackoverflow.com/users/11277499/serene"}, "edited": false, "score": 0, "creation_date": 1554298847, "post_id": 55487025, "comment_id": 97700283, "body": "I did some more edits. Before finding the palindrome length I have to find the palindrome first right? but my code isn&#39;t even working right now. I understand what you mean by i_initial now. I can do that part but for now I am checking using small palindromes first. Thank you for explaining!"}, {"owner": {"reputation": 1805, "user_id": 6284997, "user_type": "registered", "accept_rate": 45, "profile_image": "https://graph.facebook.com/1376431542382698/picture?type=large", "display_name": "MayurK", "link": "https://stackoverflow.com/users/6284997/mayurk"}, "reply_to_user": {"reputation": 19, "user_id": 11277499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcb2689e8ae0b0a8d72d40c7e4b85f09?s=128&d=identicon&r=PG&f=1", "display_name": "serene", "link": "https://stackoverflow.com/users/11277499/serene"}, "edited": false, "score": 0, "creation_date": 1554310526, "post_id": 55487025, "comment_id": 97707525, "body": "@serene Again you are porinting inside if statements. At that stage you are still in the process of searching palindrome and hence you may not be able to print properly. So one thing you can do. You can have a variable to store length of palindrome. In str[i]==str[j] case, increment length by 2 since two characters are part of palindorme, in  str[i]!=str[j] case reset length to zero. Outside while loop, print str[i_initial] to str[i_initial+length-1] characters. That is your palindrome."}], "tags": [], "owner": {"reputation": 1805, "user_id": 6284997, "user_type": "registered", "accept_rate": 45, "profile_image": "https://graph.facebook.com/1376431542382698/picture?type=large", "display_name": "MayurK", "link": "https://stackoverflow.com/users/6284997/mayurk"}, "is_accepted": false, "score": 0, "last_activity_date": 1554266791, "last_edit_date": 1554266791, "creation_date": 1554265293, "answer_id": 55487025, "question_id": 55486920, "link": "https://stackoverflow.com/questions/55486920/in-c-my-code-to-print-the-largest-palindrome-in-a-string-is-not-printing-the-wh/55487025#55487025", "title": "In C, my code to print the largest palindrome in a string is not printing the whole palindrome string?", "body": "<p>It is not printing complete palindrome because you have put your printf inside the check.</p>\n\n<pre><code>   if(str[i]==str[j])//if letters are same\n    {           \n        printf(\"%c\",str[i]);//print palindrome letter\n                            /*is there a way I can store all the palindrome \n                             characters in a string and print that string?*/\n        i++;//increment i\n        j--;//decrement j               \n    }\n</code></pre>\n\n<p>As you can see, index \"i\" and \"j\" are part of the palindrome but you are printing only \"i\". So only first half of the palindrome will get printed.</p>\n\n<p>Apart from this, I think you need to handle many other cases like there are multiple palindromes and you need to choose the largest one.\nFor example: <code>abcxyzyxdefabcdedcbaxyz</code></p>\n\n<p>So my suggestion is,</p>\n\n<p>1) Implement a function which returns a largest palindrome from\n    index i of the string, if present.  </p>\n\n<p>2) Call this function in a loop\n    from index i=0 to length-2 of the original string. </p>\n\n<p>3) Store the\n    current largest palindrome index and length. Update it in each loop.</p>\n\n<p>4) At the end, print the largest palindrome.</p>\n\n<p>The function palindromelength() is doing the whatever I mentioned in step #1. But instead of printing the letters, you should return the length of the largest palindrome from it.</p>\n\n<p>In main(), call palindromelength() in a loop with updated index as below.</p>\n\n<pre><code>for(i=0; i&lt;(len-1); i++)\n{\n    palinrdomeLen = palindromelength(str, i, len-1);\n    if(palinrdomeLen &gt; largestPalindromeLen)\n    {\n        largestPalindromeLen = palinrdomeLen;\n        largestPalindromeIdx = i;\n    }\n}\n</code></pre>\n\n<p>Apart from this in palindromelength(), </p>\n\n<p>1) You need to update the function to return the length of the palindrome.</p>\n\n<p>2) The search for palindrome should restart from index initial \"i\" when a <code>str[i]!=str[j]</code>. </p>\n\n<pre><code>if(str[i]!=str[j])//if letters aren't same\n{\n    i = i_initial; //i_initial is the \"i\" value passed to palindromelength()\n    j--;//only decrement j              \n}\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 11277499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcb2689e8ae0b0a8d72d40c7e4b85f09?s=128&d=identicon&r=PG&f=1", "display_name": "serene", "link": "https://stackoverflow.com/users/11277499/serene"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1554298673, "creation_date": 1554264404, "last_edit_date": 1554298673, "question_id": 55486920, "link": "https://stackoverflow.com/questions/55486920/in-c-my-code-to-print-the-largest-palindrome-in-a-string-is-not-printing-the-wh", "title": "In C, my code to print the largest palindrome in a string is not printing the whole palindrome string?", "body": "<p>I am doing an assignment that says to:\nFind the largest palindrome in a string. A palindrome is a\nsequence that reads the same backward as forward. racecar, eve, kayak are some examples.\nMy problem is that my string isn't printing the whole output. I am still pretty new at this so I don't know much but I think there's something wrong with printing. I will be really glad if someone could help me.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt; \nint palindromelength(char *str, int i, int j);\nchar str[100];  \nint main()\n{\n    int i,j,len,n;\n    printf(\"Enter a string \");      \n    fgets(str,sizeof(str),stdin);//takes user input\n    str[strcspn(str, \"\\n\")] = 0;\n    len=strlen(str);\n    palindromelength(str, 0, len-1);//function call\n    return 0;       \n}\nint palindromelength(char *str, int i, int j)//compare \n{       \n    int len=strlen(str);\n    i=0,j=len-1;//i starts from first letter and j starts from the last letter\n    while(i&lt;=j &amp;&amp; j!=0)//edit:&amp;&amp; j!=0 because i=0-&gt;str[0] and j=0-&gt;str[0] is the same first letter\n    {       \n        if(str[i]==str[j])\n        {           \n            printf(\"%c%c\\n\",str[i],str[j]);//edit:added str[j] but it just prints a letter twice\n            printf(\"if: i=%d j=%d str[i]=%c str[j]=%c\\n\",i,j,str[i],str[j]);/*edit:new                          \n             printf to check the i and j values and the corresponding letters under if*/\n            i++;//increment i\n            j--;//decrement j               \n        }           \n        if(str[i]!=str[j])//if letters aren't same\n        {\n            printf(\"if: i=%d j=%d str[i]=%c str[j]=%c\\n\",i,j,str[i],str[j]);/*edit:new \n             printf to check the i and j values and the corresponding letters under the other if statement*/\n            i=0;//i_initial?\n            j--;//only decrement j              \n        }\n    }   \n    return 0;   \n}\n</code></pre>\n\n<pre><code>output//edit to print the new printf statements\nEnter a string abcbade //expected:abcba\nlength is 7\nif: i=0 j=6 str[i]=a str[j]=e\nif: i=0 j=5 str[i]=a str[j]=d\naa\nif: i=0 j=4 str[i]=a str[j]=a\nbb\nif: i=1 j=3 str[i]=b str[j]=b\ncc\nif: i=2 j=2 str[i]=c str[j]=c\n</code></pre>\n\n<pre><code>output 2:\nEnter a string dabae   //expected:aba\nlength is 5\nif: i=0 j=4 str[i]=d str[j]=e\nif: i=0 j=3 str[i]=d str[j]=a\nif: i=0 j=2 str[i]=d str[j]=b\nif: i=0 j=1 str[i]=d str[j]=a\n</code></pre>\n\n<pre><code>output 3:\nEnter a string abcbacdcbaab //expected:abcba\nlength is 12\nif: i=0 j=11 str[i]=a str[j]=b\naa\nif: i=0 j=10 str[i]=a str[j]=a\nif: i=1 j=9 str[i]=b str[j]=a\nif: i=0 j=8 str[i]=a str[j]=b\nif: i=0 j=7 str[i]=a str[j]=c\nif: i=0 j=6 str[i]=a str[j]=d\nif: i=0 j=5 str[i]=a str[j]=c\naa\nif: i=0 j=4 str[i]=a str[j]=a\nbb\nif: i=1 j=3 str[i]=b str[j]=b\ncc\nif: i=2 j=2 str[i]=c str[j]=c\n</code></pre>\n"}, {"tags": ["c", "memory-management", "linux-kernel"], "comments": [{"owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 1, "creation_date": 1554263696, "post_id": 55486806, "comment_id": 97682267, "body": "<a href=\"https://www.kernel.org/doc/gorman/html/understand/understand023.html\" rel=\"nofollow noreferrer\">kernel.org/doc/gorman/html/understand/understand023.html</a>"}], "answers": [{"tags": [], "owner": {"reputation": 22422, "user_id": 634919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f4a87fe094961af20263d8e7ff445b2?s=128&d=identicon&r=PG", "display_name": "Nate Eldredge", "link": "https://stackoverflow.com/users/634919/nate-eldredge"}, "is_accepted": false, "score": 1, "last_activity_date": 1554264125, "creation_date": 1554264125, "answer_id": 55486879, "question_id": 55486806, "link": "https://stackoverflow.com/questions/55486806/what-is-the-unsigned-int-order-in-the-function-struct-page-alloc-pages/55486879#55486879", "title": "What is the unsigned int order in the function struct page* alloc_pages()", "body": "<p>From <a href=\"https://www.kernel.org/doc/gorman/html/understand/understand023.html\" rel=\"nofollow noreferrer\">the link provided by tkausl</a>:</p>\n\n<blockquote>\n  <p>The order is the power of two number of pages to allocate</p>\n</blockquote>\n\n<p>So <code>alloc_pages(gfp_mask, 3)</code> will allocate 8 pages.  <code>alloc_pages(gfp_mask, 4)</code> will allocate 16 pages, and so on.</p>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 11239422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22419ce9993a737592ce8be0b448d69c?s=128&d=identicon&r=PG&f=1", "display_name": "Mohit Verma", "link": "https://stackoverflow.com/users/11239422/mohit-verma"}, "edited": false, "score": 0, "creation_date": 1554274540, "post_id": 55487329, "comment_id": 97685567, "body": "free_pages() also take argument of unsigned int order.Therefore, we can not free the remaining 7 pages."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "reply_to_user": {"reputation": 13, "user_id": 11239422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22419ce9993a737592ce8be0b448d69c?s=128&d=identicon&r=PG&f=1", "display_name": "Mohit Verma", "link": "https://stackoverflow.com/users/11239422/mohit-verma"}, "edited": false, "score": 0, "creation_date": 1554274637, "post_id": 55487329, "comment_id": 97685607, "body": "Yes you can. You&#39;d free just order=1 pages 7 times"}, {"owner": {"reputation": 13, "user_id": 11239422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22419ce9993a737592ce8be0b448d69c?s=128&d=identicon&r=PG&f=1", "display_name": "Mohit Verma", "link": "https://stackoverflow.com/users/11239422/mohit-verma"}, "edited": false, "score": 0, "creation_date": 1554276916, "post_id": 55487329, "comment_id": 97686705, "body": "That would be very annoying thing to do. Why the allocation is on the basis of 2^order? Why they didn&#39;t take no. of pages directly?"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "reply_to_user": {"reputation": 13, "user_id": 11239422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22419ce9993a737592ce8be0b448d69c?s=128&d=identicon&r=PG&f=1", "display_name": "Mohit Verma", "link": "https://stackoverflow.com/users/11239422/mohit-verma"}, "edited": false, "score": 0, "creation_date": 1554278639, "post_id": 55487329, "comment_id": 97687678, "body": "Because of how the allocator works and how you&#39;re supposed to use it"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "reply_to_user": {"reputation": 13, "user_id": 11239422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22419ce9993a737592ce8be0b448d69c?s=128&d=identicon&r=PG&f=1", "display_name": "Mohit Verma", "link": "https://stackoverflow.com/users/11239422/mohit-verma"}, "edited": false, "score": 0, "creation_date": 1554278745, "post_id": 55487329, "comment_id": 97687743, "body": "@MohitVerma I repeat it is very unusual to actually need 9 continuous pages. Why do you think you need them"}, {"owner": {"reputation": 13, "user_id": 11239422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22419ce9993a737592ce8be0b448d69c?s=128&d=identicon&r=PG&f=1", "display_name": "Mohit Verma", "link": "https://stackoverflow.com/users/11239422/mohit-verma"}, "edited": false, "score": 0, "creation_date": 1554283200, "post_id": 55487329, "comment_id": 97690382, "body": "I was going through the concept of memory management.So it stuck with me.I thought the slab allocation is used but as you say it uses buddy allocator algorithm. Thanks for clearing the doubts.mate."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "reply_to_user": {"reputation": 13, "user_id": 11239422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22419ce9993a737592ce8be0b448d69c?s=128&d=identicon&r=PG&f=1", "display_name": "Mohit Verma", "link": "https://stackoverflow.com/users/11239422/mohit-verma"}, "edited": false, "score": 0, "creation_date": 1554284090, "post_id": 55487329, "comment_id": 97690916, "body": "The slab allocator is a frontend to this."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1554373489, "post_id": 55487329, "comment_id": 97731860, "body": "@AnttiHaapala I think you meant order=0, not order=1."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "reply_to_user": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1554373506, "post_id": 55487329, "comment_id": 97731874, "body": "@IanAbbott indeed :D"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1554374347, "post_id": 55487329, "comment_id": 97732372, "body": "@AnttiHaapala I don&#39;t think you can free partial allocations that way unless you call <code>split_page()</code> first. But it is easier to call <code>alloc_pages_exact()</code> which effectively does all that for you."}], "tags": [], "owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "is_accepted": true, "score": 0, "last_activity_date": 1554373539, "last_edit_date": 1554373539, "creation_date": 1554267217, "answer_id": 55487329, "question_id": 55486806, "link": "https://stackoverflow.com/questions/55486806/what-is-the-unsigned-int-order-in-the-function-struct-page-alloc-pages/55487329#55487329", "title": "What is the unsigned int order in the function struct page* alloc_pages()", "body": "<p><code>alloc_pages</code> allocates <a href=\"https://cs.stackexchange.com/questions/11667/what-is-the-difference-between-a-page-of-memory-and-a-frame-of-memory\"><em>continuous page <strong>frames</em></strong></a> from the physical memory. Linux kernel has this ill-named, of course.</p>\n\n<p>I believe it is using the <a href=\"https://en.wikipedia.org/wiki/Buddy_memory_allocation\" rel=\"nofollow noreferrer\"><em>buddy allocator</em></a>. </p>\n\n<p>Most of the time you don't even <strong>need</strong> continuous page frames. This is only mostly needed for hardware that does DMA transfers or similar. Very unlikely that you'd need 9 continuous frames. If you really do, you'll allocate 16 pages and free the remaining 7, for example <code>order=0</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "is_accepted": false, "score": 0, "last_activity_date": 1554376245, "last_edit_date": 1554376245, "creation_date": 1554375006, "answer_id": 55514044, "question_id": 55486806, "link": "https://stackoverflow.com/questions/55486806/what-is-the-unsigned-int-order-in-the-function-struct-page-alloc-pages/55514044#55514044", "title": "What is the unsigned int order in the function struct page* alloc_pages()", "body": "<p>If you want an exact number of pages, call <code>alloc_pages_exact()</code>. It takes the desired size in bytes and the GFP flags, and returns a page-aligned address.  Call <code>free_pages_exact()</code> with the same size that was passed to <code>alloc_pages_exact()</code> to free the memory.</p>\n\n<pre><code>#define MY_BUF_SIZE 20000 /* size in bytes */\n</code></pre>\n\n<p>...</p>\n\n<pre><code>        mydev-&gt;buf = alloc_pages_exact(MY_BUF_SIZE, GFP_KERNEL);\n</code></pre>\n\n<p>...</p>\n\n<pre><code>        if (mydev-&gt;buf)\n                free_pages_exact(mydev-&gt;buf, MY_BUF_SIZE);\n</code></pre>\n\n<p>Note that the implementation of <code>alloc_pages_exact()</code> is as follows:</p>\n\n<ol>\n<li>Use the specified size in bytes to determine the power of two \"page order\" for the allocation.</li>\n<li>Call <code>alloc_page()</code> (via <code>__get_free_pages()</code>) to allocate a single \"compound page\" of the determined page order, which consists of a power of two number of single pages.</li>\n<li>Call <code>split_page()</code> to split the compound page into single pages.</li>\n<li>Call <code>free_page()</code> on any unneeded pages at the end of the allocation.</li>\n</ol>\n\n<p>The implementation of <code>free_pages_exact()</code> uses the specified size (which ought to match the size passed to <code>alloc_pages_exact()</code>) to determine the number of individual pages to free and frees that many contiguous pages (by calling <code>free_page()</code>) starting from the specified virtual address.</p>\n"}], "owner": {"reputation": 13, "user_id": 11239422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22419ce9993a737592ce8be0b448d69c?s=128&d=identicon&r=PG&f=1", "display_name": "Mohit Verma", "link": "https://stackoverflow.com/users/11239422/mohit-verma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 183, "favorite_count": 0, "accepted_answer_id": 55487329, "answer_count": 3, "score": 0, "last_activity_date": 1554376245, "creation_date": 1554263626, "last_edit_date": 1554264498, "question_id": 55486806, "link": "https://stackoverflow.com/questions/55486806/what-is-the-unsigned-int-order-in-the-function-struct-page-alloc-pages", "title": "What is the unsigned int order in the function struct page* alloc_pages()", "body": "<p><code>struct page* alloc_pages(gfp_t gfp_mask, unsigned int order)</code> is the function used to allocate page in kernel. So this will allocate 2^order contiguous physical pages.\nSo this means the pages will allocate in the manner of 1,2,4,8,16 and so on.\nWhat if only 3 pages are needed or 5 ,9 and so on.</p>\n"}]