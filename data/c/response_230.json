[{"tags": ["c++", "c", "wrapper"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1559779219, "post_id": 56469366, "comment_id": 99530142, "body": "Instead of <code>char</code> with seemingly arbitrary lengths, where 30 characters is bound to be way too small in many cases, use <code>char*</code>. You may find that bridging C <code>char[]</code> or <code>char*</code> to C++ <code>std::string</code> isn&#39;t possible without C++."}, {"owner": {"reputation": 1570, "user_id": 1544015, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/5GvtW.jpg?s=128&g=1", "display_name": "Vlad Novakovsky", "link": "https://stackoverflow.com/users/1544015/vlad-novakovsky"}, "edited": false, "score": 0, "creation_date": 1559779756, "post_id": 56469366, "comment_id": 99530229, "body": "Why do you pass confGlobal_wpr  - method requires confGlobal"}, {"owner": {"reputation": 1570, "user_id": 1544015, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/5GvtW.jpg?s=128&g=1", "display_name": "Vlad Novakovsky", "link": "https://stackoverflow.com/users/1544015/vlad-novakovsky"}, "edited": false, "score": 0, "creation_date": 1559779952, "post_id": 56469366, "comment_id": 99530262, "body": "To use c++ code you need define wrapper functions with C calling convention,( extern C) and call them in your C project. Inside those exported functions you can use C++ code."}, {"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 0, "creation_date": 1559781998, "post_id": 56469366, "comment_id": 99530551, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/31903005/how-to-mix-c-and-c-correctly\" title=\"how to mix c and c correctly\">stackoverflow.com/questions/31903005/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 50273, "user_id": 167958, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0defa74609a4ce5d51f2467b69c509be?s=128&d=identicon&r=PG", "display_name": "Omnifarious", "link": "https://stackoverflow.com/users/167958/omnifarious"}, "is_accepted": false, "score": 1, "last_activity_date": 1559779368, "creation_date": 1559779368, "answer_id": 56469476, "question_id": 56469366, "link": "https://stackoverflow.com/questions/56469366/how-to-create-wrapper-for-using-c-code-in-c/56469476#56469476", "title": "How to create wrapper for using C++ code in C?", "body": "<p>Structs that contain anything other than primitive data types common to C and C++ largely can't be wrapped in the way you want. In this particular case, you have <code>::std::string</code>s in your struct. And they definitely can't be accessed reasonably from C at all.</p>\n\n<p>Additionally, the structs contain <code>bool</code> and I don't know if newer versions of the C standard have <code>bool</code> or define it in such a way that it will result in layout compatible structs with C++ implementations on the same platform.</p>\n\n<p>There are solutions to this problem. But they involve using opaque pointers to the struct in C, and always calling functions to access its methods. I will try to whip up an example of how this might work for a really simple struct.</p>\n\n<p>Looking more carefully at your code, it looks like you need a sort of thunk layer that takes the C struct and (in C++) hand-converts it to the C++ struct and returns a pointer to a dynamically allocated C++ struct that you can then pass to other C++ functions that have been exposed to C.</p>\n"}, {"comments": [{"owner": {"reputation": 327, "user_id": 1490798, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/026c4f962ea7482ef15032805d0d46d4?s=128&d=identicon&r=PG", "display_name": "crossmax", "link": "https://stackoverflow.com/users/1490798/crossmax"}, "edited": false, "score": 0, "creation_date": 1559814999, "post_id": 56469585, "comment_id": 99540606, "body": "Thanks so much. I&#39;ve made your modifications in my code and, for the moment, works great. Now, I understand a little bit the wrapper facts and I need to wrap many another struct and methods. One more question: how I destroy the pointer wrapped struct (confGlobal) and pointer wrapper class (ct_api_wpr)? I&#39;m adding destroy methods on my original ask."}, {"owner": {"reputation": 50273, "user_id": 167958, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0defa74609a4ce5d51f2467b69c509be?s=128&d=identicon&r=PG", "display_name": "Omnifarious", "link": "https://stackoverflow.com/users/167958/omnifarious"}, "edited": false, "score": 0, "creation_date": 1559832291, "post_id": 56469585, "comment_id": 99550403, "body": "I didn&#39;t realize you could use <code>extern &quot;C&quot;</code> on structs. Do you have to? Does it even do anything? I suspect it doesn&#39;t."}, {"owner": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "reply_to_user": {"reputation": 327, "user_id": 1490798, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/026c4f962ea7482ef15032805d0d46d4?s=128&d=identicon&r=PG", "display_name": "crossmax", "link": "https://stackoverflow.com/users/1490798/crossmax"}, "edited": false, "score": 1, "creation_date": 1559853035, "post_id": 56469585, "comment_id": 99559631, "body": "@crossmax well, it&#39;s weird for the API itself because it&#39;s actually a singleton.  So technically, <code>my_api_create</code> could simply be <code>my_api_initialize</code> and return no pointer.  For the <code>confGlobal_wpr</code> your destroy function would simply be <code>void confGlobal_destroy(confGlobal_wpr* confGlobal) { delete confGlobal; }</code> and similar for <code>confPartner_wpr</code>."}, {"owner": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "reply_to_user": {"reputation": 50273, "user_id": 167958, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0defa74609a4ce5d51f2467b69c509be?s=128&d=identicon&r=PG", "display_name": "Omnifarious", "link": "https://stackoverflow.com/users/167958/omnifarious"}, "edited": false, "score": 0, "creation_date": 1559853365, "post_id": 56469585, "comment_id": 99559745, "body": "@Omnifarious I&#39;m not 100% sure actually, since the structs are already forward-declared as <code>extern &quot;C&quot;</code> in the header.  What I did was basically the same as wrapping the definitions in <code>extern &quot;C&quot;</code>.  But it might not be required, and so this might be wrong.  Certainly in the traditional use of <code>extern</code>, it&#39;s only required on the declaration to my knowledge.  I haven&#39;t needed to write a C++ library wrapper in C for about 20 years ;)  If you find the answer, please drop a note back in here."}], "tags": [], "owner": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "is_accepted": true, "score": 2, "last_activity_date": 1559780591, "creation_date": 1559780591, "answer_id": 56469585, "question_id": 56469366, "link": "https://stackoverflow.com/questions/56469366/how-to-create-wrapper-for-using-c-code-in-c/56469585#56469585", "title": "How to create wrapper for using C++ code in C?", "body": "<p>You're forgetting that <code>CT_API::Instance</code> doesn't understand the \"handle\" types that you have created in C to wrap the C++ structures.  This is precisely what the error message is telling you, if you read it.  You must translate those back to the appropriate C++ types.</p>\n\n<p>Firstly, since you are using \"create\"-style routines to build the structures and return them as a pointer, you should consider making your <code>my_api_create</code> function accept pointers instead.  Particularly because the resulting handle types are forward-declared structs with no definition visible in C and it will not be possible for your C client to dereference them.</p>\n\n<p>That highlights another issue. You are also not using these handles correctly from C++.</p>\n\n<p>So, one thing at a time...</p>\n\n<p>Your creation routine in C should be declared as:</p>\n\n<pre><code>my_api_wpr *my_api_create(struct confGlobal_wpr* cGlobal, struct confPartner_wpr* cPartner);\n</code></pre>\n\n<p>On the C++ side, you need to actually <em>define</em> your handle types.  Something like:</p>\n\n<pre><code>extern \"C\" struct confGlobal_wpr {\n    struct confGlobal instance;\n};\n\nextern \"C\" struct confPartner_wpr {\n    struct confPartner instance;\n};\n\nextern \"C\" struct my_api_wpr {\n    my_API *ptr;\n};\n</code></pre>\n\n<p>Now, your creation:</p>\n\n<pre><code>confGlobal_wpr *confGlobal_create(unsigned int device,\n                                  char *name,\n                                  int number,\n                                  char *uid,\n                                  char *message,\n                                  unsigned char mode)\n{\n    confGlobal_wpr *cg = new confGlobal_wpr;\n    struct confGlobal&amp; cGlobal = cg-&gt;instance; //&lt;-- note the reference\n    // TODO: populate cGlobal as usual\n    return cg;\n}\n\nconfPartner_wpr *confPartner_create(product_wpr tableProducts_wpr[],\n                                    unsigned char numProducts,\n                                    category_wpr tableCategories_wpr[],\n                                    unsigned char numCategories,\n                                    subCategory_wpr tableSubCategories_wpr[],\n                                    unsigned char numSubCategories)\n{\n    confPartner_wpr *cc = new confPartner_wpr;\n    struct confPartner&amp; cPartner = cc-&gt;instance; //&lt;-- note the reference\n    // TODO: populate cPartner as usual\n    return cc;\n}\n\nmy_api_wpr *my_api_create(struct confGlobal_wpr* cGlobal, struct confPartner_wpr* cPartner)\n{\n    my_api_wpr *my_api = new my_api_wpr;\n    my_api-&gt;ptr = CT_API::Instance(cGlobal-&gt;instance, cPartner-&gt;instance);\n    return my_api;\n}\n</code></pre>\n\n<p>You should also add corresponding <code>_destroy</code> methods for all the above.</p>\n"}, {"tags": [], "owner": {"reputation": 1570, "user_id": 1544015, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/5GvtW.jpg?s=128&g=1", "display_name": "Vlad Novakovsky", "link": "https://stackoverflow.com/users/1544015/vlad-novakovsky"}, "is_accepted": false, "score": 1, "last_activity_date": 1559785067, "last_edit_date": 1559785067, "creation_date": 1559781016, "answer_id": 56469619, "question_id": 56469366, "link": "https://stackoverflow.com/questions/56469366/how-to-create-wrapper-for-using-c-code-in-c/56469619#56469619", "title": "How to create wrapper for using C++ code in C?", "body": "<p>To use C++ code in C project you need define wrapper functions with C calling convention - extern \"C\"(turning off C++ name mangling/decoration) , and call them and only them in your C project. Inside those C functions you can use C++ code. Pass to C wrapper functions only types that C understands. You can create intermediate structures for passing data to C wrapper functions. Then you need copy data to types that C++ class expects. In you particular case you incorrectly pass confGlobal_wpr wrapper struct but C++ method requires confGlobal, and compiler complains on this directly.</p>\n\n<p>Below is observable snippet how to use C++ code from C code:\nFoo.h</p>\n\n<pre><code>#include &lt;string&gt;\n\nclass Bar\n{\npublic:\n    Bar(std::string s) : s_(s)\n    {\n    }\n    std::string s_;\n};\n\nclass Foo\n{\npublic:\n    Foo(Bar) {}\n};\n</code></pre>\n\n<p>CWrappers.h // include this header to C project</p>\n\n<pre><code>struct BarWrapper\n{\n    char data[100] = \"\";\n};\n\n#ifdef __cplusplus\nextern \"C\" {\n#endif\n\nBarWrapper createFoo(char *c);\n\n#ifdef __cplusplus\n}\n#endif\n</code></pre>\n\n<p>Wrapper.cpp</p>\n\n<pre><code>#include &lt;algorithm&gt;\n\n#include \"Foo.h\"\n#include \"CWrappers.h\"\n\n// input and output to this C function should be understandable for C\nBarWrapper createFoo(char *c)\n{\n    // inside you can use C++\n    std::string data(c);\n    Bar bar(data);\n    Foo * foo = new Foo(bar);\n    BarWrapper barWrapper;\n    std::copy(data.begin(), data.end(), barWrapper.data);\n    return barWrapper; // pack data to C struct wrapper (that has no C++ specific)\n}\n</code></pre>\n\n<p>C Project</p>\n\n<pre><code>        #include \"CWrappers.h\"\n\n        int main()\n        {\n            BarWrapper barWrapper = createFoo((char *)\"test\");\n        }\n</code></pre>\n"}], "owner": {"reputation": 327, "user_id": 1490798, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/026c4f962ea7482ef15032805d0d46d4?s=128&d=identicon&r=PG", "display_name": "crossmax", "link": "https://stackoverflow.com/users/1490798/crossmax"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 789, "favorite_count": 0, "accepted_answer_id": 56469585, "answer_count": 3, "score": 3, "last_activity_date": 1559815495, "creation_date": 1559778191, "last_edit_date": 1559815495, "question_id": 56469366, "link": "https://stackoverflow.com/questions/56469366/how-to-create-wrapper-for-using-c-code-in-c", "title": "How to create wrapper for using C++ code in C?", "body": "<p>I'm trying to do a C wrapper for a C++ third-party library because I need to use it in my C project.\nI've seen examples of a C++ class wrapper but I don't undertood the process and I can't wrapper a C++ struct.</p>\n\n<p>struct I want to wrapper:</p>\n\n<pre><code>struct confGlobal{\n    long int device;\n    string name;\n    int number;\n    string uid;\n    string message;\n    bool mode;\n\n    confiGlobal():device{LONG_MAX}, number{INT_MAX}{}\n};\n\nstruct product{\n    string id;\n    string name;\n};\nstruct category{\n    unsigned char id;\n    string name;\n    string description;\n\n    category():id{UCHAR_MAX}{}\n};\nstruct subCategory{\n    unsigned char id;\n    string name;\n    string description;\n    unsigned char idRoot;\n\n    subCategory():id{UCHAR_MAX}, idRoot{UCHAR_MAX}{}\n};\nstruct confPartner{\n    vector&lt;struct product&gt; tableProduct;\n    vector&lt;struct category&gt; tableCategory;\n    vector&lt;struct subCategory&gt; tableSubCategory;\n};\n</code></pre>\n\n<p>For call to this method:</p>\n\n<pre><code>class my_API {\npublic:\n    static my_API* Instance(struct confGlobal cGlobal,\n                        struct confPartner cPartner);\n   ... another methods ...\nprivate:\n    virtual ~my_API();\n    struct confGlobal cGlobal;\n    struct confPertner cPartner;\n};\n</code></pre>\n\n<p>I need to fill this structs and call <code>my_API::Instance()</code> from C but my attempts have been unsuccessful.</p>\n\n<p>wrapper.h</p>\n\n<pre><code>#ifdef __cplusplus\nextern \"C\" {\n#endif\nstruct confGlobal_wpr; // An opaque type that we'll use as a handle\ntypedef struct confGlobal_wpr confGlobal_wpr;\nconfGlobal_wpr *confGlobal_create(unsigned int device,\n                     char *name,\n                     int number,\n                     char *uid,\n                     char *message,\n                     unsigned char mode);\n\nstruct product_wpr{\n    char id[4];\n    char name[30];\n};\ntypedef struct product_wpr product_wpr;\n\nstruct category_wpr{\n    unsigned char id;\n    char name[3];\n    char description[30];\n};\ntypedef struct category_wpr category_wpr;\n\nstruct subcategory_wpr{\n    unsigned char id;\n    char name[3];\n    char description[30];\n    unsigned char idRoot;\n};\ntypedef struct subCategory_wpr subCategory_wpr;\nstruct confPartner_wpr; // An opaque type that we'll use as a handle\ntypedef struct confPartner_wpr confPartner_wpr;\nconfPartner_wpr *confPartner_create(Product_wpr tableProducts[],\n                     unsigned char numProducts,\n                     Category_wpr tableCategories[],\n                     unsigned char numCategories,\n                     SubCategory_wpr tableSubCategories[],\n                     unsigned char numSubCategories);\n\nstruct my_api_wpr;\ntypedef struct my_api_wpr my_api_wpr;\n\nmy_api_wpr *my_api_create(struct confGlobal_wpr cGlobal,\n                     struct confPartner_wpr cPartner);\n\n#ifdef __cplusplus\n}\n#endif\n</code></pre>\n\n<p>wrapper.cpp</p>\n\n<pre><code>confGlobal_wpr *confGlobal_create(unsigned int device,\n                     char *name,\n                     int number,\n                     char *uid,\n                     char *message,\n                     unsigned char mode)\n{\n    confGlobal_wpr *cg;\n    struct confGlobal confiGlobal;\n    confiGlobal.name = name;\n    confiGlobal.device = device;\n    confiGlobal.number = number;\n    confiGlobal.uid = uid;\n    confiGlobal.message = message;\n    if (mode == 0)\n        confiGlobal.mode = false;\n    else\n        confiGlobal.mode = true;\n    return cg;\n}\nvoid confGlobal_destroy(confGlobal_wpr *cg)\n{\n    if (cg == NULL)\n        return;\n    delete static_cast&lt;confGlobal_wpr *&gt;(cg-&gt;instance); // ERROR: invalid static_cast from type \u2018confGlobal\u2019 to type \u2018confGlobal_wpr*\u2019\n    free(cg);\n}\n\nconfPartner_wpr *confPartner_create(product_wpr tableProducts_wpr[],\n                     unsigned char numProducts,\n                     category_wpr tableCategories_wpr[],\n                     unsigned char numCategories,\n                     subCategory_wpr tableSubCategories_wpr[], \n                     unsigned char numSubCategories)\n{\n    unsigned char i=0;\n\n    confPartner_wpr *cc;\n    struct confPartner cPartner;\n    vector&lt; struct product&gt; tableProduct;\n    vector&lt; struct category&gt; tableCategory;\n    vector&lt; struct subCategory&gt; tableSubCategory;\n\n    for (i=0; i&lt;numProducts; i++)\n    {\n        struct product p;\n        p.id = tableProducts_wpr[i].id;\n        p.name = tableProducts_wpr[i].name;\n        tableProduct.push_back(p);\n    }\n    cPartner.tableProduct = tableProducts;\n\n    for (i=0; i&lt;numCategories; i++)\n    {       \n        struct category c;\n        c.id = tableCategories_wpr[i].id;\n        c.nombre = tableCategories_wpr[i].name;\n        c.descripcion = tableCategories_wpr[i].description;\n        tableCategory.push_back(c);\n    }\n    cPartner.tableCategory = tableCategory;\n\n    for (i=0; i&lt;numSubCategories; i++)\n    {\n        struct subZona sc;\n        sc.id = tableSubCategories_wpr[i].id;\n        sc.name = tableSubCategories_wpr[i].name;\n        sc.description = tableSubCategories_wpr[i].description;\n        sc.idRoot = tableSubCategories_wpr[i].idRoot;\n        tableSubCategory.push_back(sc);     \n    }\n    cPartner.tableSubCategory = tableSubCategory;\n    return cc;\n\n}\n\nmy_api_wpr *my_api_create(struct confGlobal_wpr confiGlobal_wpr,\n                      struct confPartner_wpr confiPartner_wpr)\n{\n    my_api_wpr *my_api;\n    my_API *obj;\n    my_api = (typeof(my_api))malloc(sizeof(*my_api));\n    obj    = my_API::Instance(confiGlobal_wpr, confiConsorcio_wpr);\n    /* With this compile and linked OK\n    confGlobal cg;\n    confPartner cc;\n    obj    = my_API::Instance(cg, cc);\n    */\n    my_api-&gt;obj = obj;\n\n    return my_api;\n}\nvoid my_api_destroy(ct_api_wpr *my_api)\n{\n    if (my_api == NULL)\n        return;\n    delete static_cast&lt;my_API *&gt;(my_api-&gt;ptr_api); // ERROR: \u2018virtual my_API::~my_API()\u2019 is private within this context\n    free(my_api);\n}\n</code></pre>\n\n<p>The output error when compile and linked with:</p>\n\n<pre><code>g++ -shared -o libwrapper.so *.cpp wrapper.h -l:libthird-party.a -L. -ldl -lrt -Wl,-rpath /usr/local/lib -lc\n</code></pre>\n\n<pre><code>In function \u2018my_api_wpr* my_api_create(confGlobal_wpr, confPartner_wpr)\u2019:\nerror: no matching function for call to \u2018my_API::Instance(confGlobal_wpr&amp;, confPartner_wpr&amp;)\u2019\n  obj    = my_API::Instance(confiGlobal_wpr, confiConsorcio_wpr);\n                                                               ^\nmy_API.h:30:20: note: candidate: static my_API* my_API::Instance(confGlobal, confPartner)\n     static my_API* Instance(struct confGlobal cGlobal, struct confiPartner cPartner);\n                    ^~~~~~~~\nmy_API.h:30:20: note:   no known conversion for argument 1 from \u2018confGlobal_wpr\u2019 to \u2018confGlobal\u2019\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 4, "creation_date": 1559775936, "post_id": 56469071, "comment_id": 99529568, "body": "When you ask what is wrong with code, always include a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. It should be a <b>complete</b> example that other people can compile. You should test that by compiling in a directory separate from your usual work. In the code posted in the question, <code>#include &quot;read_lines.h&quot;</code> will not work for other people because they do not have that file, and the <code>read_lines</code> function is missing a <code>}</code>."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 2, "creation_date": 1559775990, "post_id": 56469071, "comment_id": 99529580, "body": "In order for <code>lines</code> to change from <code>NULL</code>, something has to assign a value other than <code>NULL</code> to it. Nothing in the code posted does that. Something would need to allocate memory, as by calling <code>malloc</code>, and assign the return value from <code>malloc</code> to <code>lines</code>."}, {"owner": {"reputation": 351, "user_id": 4604759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6de599df6671db42349c8b438ec7a350?s=128&d=identicon&r=PG&f=1", "display_name": "MiCo", "link": "https://stackoverflow.com/users/4604759/mico"}, "edited": false, "score": 0, "creation_date": 1559777225, "post_id": 56469071, "comment_id": 99529813, "body": "You need to allocate memory for the &quot;line-table&quot; which contains pointers to the starts of the lines and also for each contents of the lines. In the shown code it should be done in the function read_lines. But it is not the best style to use triple-pointers though it should work."}, {"owner": {"reputation": 61, "user_id": 11421862, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-EqThchVQMkA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfn5w8m9qWDvZCFQnQBbJCnDu_S0w/mo/photo.jpg?sz=128", "display_name": "Christina", "link": "https://stackoverflow.com/users/11421862/christina"}, "reply_to_user": {"reputation": 351, "user_id": 4604759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6de599df6671db42349c8b438ec7a350?s=128&d=identicon&r=PG&f=1", "display_name": "MiCo", "link": "https://stackoverflow.com/users/4604759/mico"}, "edited": false, "score": 0, "creation_date": 1559777814, "post_id": 56469071, "comment_id": 99529916, "body": "@MiCo I added malloc but I don&#39;t believe I did it correctly because nothing is printing."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1559858892, "post_id": 56469071, "comment_id": 99561394, "body": "Note:three-star programmer."}], "answers": [{"comments": [{"owner": {"reputation": 351, "user_id": 4604759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6de599df6671db42349c8b438ec7a350?s=128&d=identicon&r=PG&f=1", "display_name": "MiCo", "link": "https://stackoverflow.com/users/4604759/mico"}, "edited": false, "score": 0, "creation_date": 1559858922, "post_id": 56485648, "comment_id": 99561403, "body": "By the way: There is no need to pass num_lines as pointer to function read_lines. You can elimante one level of (de-)referencing for the lines variable if the read_lines functions returns a double-pointer to char (instead of passing a triple-pointer by argument to it)."}, {"owner": {"reputation": 61, "user_id": 11421862, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-EqThchVQMkA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfn5w8m9qWDvZCFQnQBbJCnDu_S0w/mo/photo.jpg?sz=128", "display_name": "Christina", "link": "https://stackoverflow.com/users/11421862/christina"}, "edited": false, "score": 0, "creation_date": 1559869773, "post_id": 56485648, "comment_id": 99563391, "body": "I posted my updated code &amp; my new output!  I am not sure why an extra line is being printed."}, {"owner": {"reputation": 61, "user_id": 11421862, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-EqThchVQMkA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfn5w8m9qWDvZCFQnQBbJCnDu_S0w/mo/photo.jpg?sz=128", "display_name": "Christina", "link": "https://stackoverflow.com/users/11421862/christina"}, "edited": false, "score": 0, "creation_date": 1559869864, "post_id": 56485648, "comment_id": 99563409, "body": "Sorry just realized there was an extra empty line in my text file! Thank you!"}, {"owner": {"reputation": 351, "user_id": 4604759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6de599df6671db42349c8b438ec7a350?s=128&d=identicon&r=PG&f=1", "display_name": "MiCo", "link": "https://stackoverflow.com/users/4604759/mico"}, "reply_to_user": {"reputation": 61, "user_id": 11421862, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-EqThchVQMkA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfn5w8m9qWDvZCFQnQBbJCnDu_S0w/mo/photo.jpg?sz=128", "display_name": "Christina", "link": "https://stackoverflow.com/users/11421862/christina"}, "edited": false, "score": 0, "creation_date": 1559938990, "post_id": 56485648, "comment_id": 99590809, "body": "You&#39;re welcome. - If my answer was useful for you, you may want up-vote it with the small arrow on the left. ;-)"}], "tags": [], "owner": {"reputation": 351, "user_id": 4604759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6de599df6671db42349c8b438ec7a350?s=128&d=identicon&r=PG&f=1", "display_name": "MiCo", "link": "https://stackoverflow.com/users/4604759/mico"}, "is_accepted": true, "score": 1, "last_activity_date": 1559858670, "creation_date": 1559858670, "answer_id": 56485648, "question_id": 56469071, "link": "https://stackoverflow.com/questions/56469071/how-to-allocate-memory-for-lines-of-a-file-in-c/56485648#56485648", "title": "How to allocate memory for lines of a file in C?", "body": "<p>In the following code I added the <code>rewind</code> command (mentioned by xing) and the memory allocation for <strong>each</strong> line and the \"line table\". Further improvements were performed in the code for counting the lines and the error handling.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint findnum_lines(FILE* fp){\n\n  int num_lines = 0;\n  int c;\n\n  c = getc(fp);\n  if (c != EOF) {\n    num_lines++;\n    do {\n        if (c == '\\n') {\n            num_lines = num_lines + 1;\n        }\n        c = getc(fp);\n    }\n    while (c != EOF);\n  }\n  rewind(fp);\n  return num_lines;\n}\n\nvoid read_lines(FILE* fp, char*** lines, int* num_lines){\n\n  int i;\n\n  // allocate memory for pointers to start of lines\n  (*lines) = malloc(*num_lines * sizeof(char*));\n\n  for (i=0; i &lt; *num_lines; i++)\n  {\n    (*lines)[i] = malloc(1000);\n    (*lines)[i][0] = '\\0'; // terminate for the case that last line does not contain characters\n    fgets((*lines)[i], 1000, fp); // read up to 999 characters and terminate string\n  }\n\n}\n\nvoid print_lines(char** lines, int num_lines){\n    int i;\n    for(i = 0 ; i &lt; num_lines; ++i){\n        printf(\"%d. %s\", i+1, lines[i]);\n    }\n    printf(\"\\n\");\n}\n\nvoid free_lines(char** lines, int num_lines){\n    int i;\n    for (i = 0 ; i &lt; num_lines; ++i) {\n        if (lines[i]!=NULL) {\n            free(lines[i]);\n        }\n    }\n    if (lines != NULL){\n        free(lines);\n    }\n}\n\nFILE* validate_input(int argc, char* argv[]){\n\n    FILE* fp = NULL;\n\n    if (argc &lt; 2){\n        printf(\"Not enough arguments entered.\\n\");\n    }\n    else if (argc &gt; 2){\n        printf(\"Too many arguments entered.\\n\");\n    }\n    else {\n        fp = fopen(argv[1], \"r\");\n        if (fp == NULL){\n            printf(\"Unable to open file: %s\\n\", argv[1]);\n        }\n    }\n    return fp;\n}\n\n\nint main(int argc, char* argv[]){\n    char** lines = NULL;\n    int num_lines = 0;\n    FILE* fp = validate_input(argc, argv);\n    if (fp != NULL)\n    {\n        num_lines = findnum_lines(fp);\n        read_lines(fp, &amp;lines, &amp;num_lines);\n        print_lines(lines, num_lines);\n        free_lines(lines, num_lines);\n        fclose(fp);\n    }\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 11421862, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-EqThchVQMkA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfn5w8m9qWDvZCFQnQBbJCnDu_S0w/mo/photo.jpg?sz=128", "display_name": "Christina", "link": "https://stackoverflow.com/users/11421862/christina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 179, "favorite_count": 0, "accepted_answer_id": 56485648, "answer_count": 1, "score": 0, "last_activity_date": 1559869715, "creation_date": 1559775552, "last_edit_date": 1559869715, "question_id": 56469071, "link": "https://stackoverflow.com/questions/56469071/how-to-allocate-memory-for-lines-of-a-file-in-c", "title": "How to allocate memory for lines of a file in C?", "body": "<p>I have created functions that are supposed to find the number of lines in a file (find_numlines()) and a function to read the lines of the file into char*** lines (read_lines()).  The rest of the functions in my main were provided so the problems are not in those functions.</p>\n\n<p>read_lines.c (UPDATED): </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include \"read_lines.h\"\n\n\nint findnum_lines(FILE* fp){\n\n  int num_lines = 0;\n  int line;\n\n  line = getc(fp);\n  if (line != EOF) {\n    num_lines++;\n    do {\n      if (line == '\\n') {\n        num_lines = num_lines + 1;\n      }\n      line = getc(fp);\n    }\n    while (line != EOF);\n  }\n  rewind(fp);\n  return num_lines;\n}\n\n\nvoid read_lines(FILE* fp, char*** lines, int* num_lines){\n\n  int i;\n\n  (*lines) = malloc(*num_lines * sizeof(char*));\n\n  for (i=0; i &lt; *num_lines; i++)\n  {\n    (*lines)[i] = malloc(1000);\n    (*lines)[i][0] = '\\0';\n    fgets((*lines)[i], 1000, fp);\n  }\n}\n</code></pre>\n\n<p>main.c :</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;errno.h&gt;\n#include \"read_lines.h\"\n\n\nvoid print_lines(char** lines, int num_lines){\n    int i;\n    for(i = 0 ; i &lt; num_lines; ++i){\n        printf(\"%d. %s\", i+1, lines[i]);\n    }\n}\n\nvoid free_lines(char** lines, int num_lines){\n    int i;\n\n    for(i = 0 ; i &lt; num_lines; ++i){\n        free(lines[i]);\n    }\n\n    if(lines != NULL &amp;&amp; num_lines &gt; 0){\n        free(lines);\n    }\n\n}\n\nFILE* validate_input(int argc, char* argv[]){\n\n    FILE* fp = NULL;\n\n    if(argc &lt; 2){\n        printf(\"Not enough arguments entered.\\nEnding program.\\n\");\n        exit(0);\n    }\n    else if(argc &gt; 2){\n        printf(\"Too many arguments entered.\\nEnding program.\\n\");\n        exit(0);\n    }\n\n    fp = fopen(argv[1], \"r\");\n\n    if(fp == NULL){\n        perror(\"fopen\");\n        printf(\"Unable to open file: %s\\nEnding program.\\n\", argv[1]);\n        //fprintf(stderr, \"Unable to open file %s: %s\\n\", argv[1], strerror(errno));\n        exit(0);\n    }\n\n    return fp;\n\n}\n\n\nint main(int argc, char* argv[]){\n    char** lines = NULL;\n    int num_lines = 0;\n    FILE* fp = validate_input(argc, argv);\n\n    num_lines = findnum_lines(fp);\n    read_lines(fp, &amp;lines, &amp;num_lines);\n    print_lines(lines, num_lines);\n    free_lines(lines, num_lines);\n    fclose(fp);\n\n    return 0;\n}\n</code></pre>\n\n<p>read_lines.h :</p>\n\n<pre><code>#ifndef READ_LINES\n    #define READ_LINES\n    #include &lt;stdio.h&gt;\n    void read_lines(FILE* fp, char*** lines, int* num_lines);\n    int findnum_lines(FILE* fp);\n#endif\n</code></pre>\n\n<p>Whenever I input a file the <code>find_numlines()</code> returns the correct number of lines but something goes wrong in the <code>read_lines()</code> because <code>lines</code> is still <code>NULL</code>.</p>\n\n<p>The example file is <code>normal.txt</code> :</p>\n\n<pre><code>Hello Class\nThis is what I would call a normal file\nIt isn't very special\nBut it still is important\n</code></pre>\n\n<p>The ouptut should be:</p>\n\n<pre><code>1. Hello Class\n2. This is what I would call a normal file\n3. It isn't very special\n4. But it still is important\n</code></pre>\n"}, {"tags": ["c", "linux-kernel", "linux-device-driver", "polling", "gpio"], "comments": [{"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 1, "creation_date": 1559779125, "post_id": 56469011, "comment_id": 99530130, "body": "Call for <code>wake_up_interruptible(&amp;gpio_driver_wait)</code> shouldn&#39;t be in the kernel&#39;s poll function: this function needs just to call <code>poll_wait</code> for proper waitqueue and/or return the mask of available actions. Note, that the waiting is perform <b>after</b> the <code>.poll</code> function is called. <code>wake_up</code> should be called from the place, which makes the reading available (that is, when the pin is set). Unfortunately, I don&#39;t very aware of gpio and cannot suggest where exactly <code>wake_up</code> should be called. But this is definitely not a <code>.poll</code> function."}, {"owner": {"reputation": 65, "user_id": 4958288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/347887884f7ca31f185ef15a08e09ba0?s=128&d=identicon&r=PG&f=1", "display_name": "A6SE", "link": "https://stackoverflow.com/users/4958288/a6se"}, "reply_to_user": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1559780772, "post_id": 56469011, "comment_id": 99530373, "body": "@Tsyvarev Does poll function from user space repeatedly call read from kernel space? If it does, I will try to put <code>wake_up_interruptible(&amp;gpio_driver_wait)</code> in read function."}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1559781105, "post_id": 56469011, "comment_id": 99530416, "body": "&quot;Does poll function from user space repeatedly call read from kernel space&quot; - No, <code>poll()</code> from user space calls only the <code>.poll</code> function of your driver."}, {"owner": {"reputation": 65, "user_id": 4958288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/347887884f7ca31f185ef15a08e09ba0?s=128&d=identicon&r=PG&f=1", "display_name": "A6SE", "link": "https://stackoverflow.com/users/4958288/a6se"}, "reply_to_user": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1559781522, "post_id": 56469011, "comment_id": 99530474, "body": "@Tsyvarev What kind of mechanism can I then use to repeatedly check for some condition, in my case, the state of my GPIO pin being 1? If read is never called by poll from user space, then it doesn&#39;t make sense to put wake_up_interruptible in read."}, {"owner": {"reputation": 3561, "user_id": 2511795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30c869f55cbcf82a7bc4536d563daa0a?s=128&d=identicon&r=PG", "display_name": "0andriy", "link": "https://stackoverflow.com/users/2511795/0andriy"}, "reply_to_user": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1559796920, "post_id": 56469011, "comment_id": 99533026, "body": "If it\u2019s not an educational purpose, don\u2019t reinvent the wheel. GPIO library provides a character device with such functionality. @Tsyvarev, JFYI."}, {"owner": {"reputation": 65, "user_id": 4958288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/347887884f7ca31f185ef15a08e09ba0?s=128&d=identicon&r=PG&f=1", "display_name": "A6SE", "link": "https://stackoverflow.com/users/4958288/a6se"}, "edited": false, "score": 0, "creation_date": 1559822133, "post_id": 56469011, "comment_id": 99544376, "body": "The accepted solution in this thread <a href=\"https://stackoverflow.com/a/25417953/4958288\">stackoverflow.com/a/25417953/4958288</a> is what I think will help me with this. I&#39;ll try and get back with results."}, {"owner": {"reputation": 65, "user_id": 4958288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/347887884f7ca31f185ef15a08e09ba0?s=128&d=identicon&r=PG&f=1", "display_name": "A6SE", "link": "https://stackoverflow.com/users/4958288/a6se"}, "edited": false, "score": 0, "creation_date": 1559830982, "post_id": 56469011, "comment_id": 99549741, "body": "As I thought, the answer on that thread helped me clear my confusion. What I did is create a thread in user space program that constantly calls driver read and checks for state of GPIO pin. If the state is high, wake_up is called and the driver poll function executes again, this time returning the correct flag."}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1559832406, "post_id": 56469011, "comment_id": 99550472, "body": "&quot;What I did is create a thread in user space program that constantly calls driver read and checks for state of GPIO pin.&quot; - This eliminates the whole purpose of polling as a way for <b>blocking</b> wait, when the waiting thread doesn&#39;t consume resources of CPU.  Repeated calls to <code>read</code> implements <b>busy</b> waiting, when the thread consumes CPU while waits. In that case, there is no needs in <code>poll</code> - just repeatedly call <code>read</code> until it reads some bytes."}, {"owner": {"reputation": 65, "user_id": 4958288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/347887884f7ca31f185ef15a08e09ba0?s=128&d=identicon&r=PG&f=1", "display_name": "A6SE", "link": "https://stackoverflow.com/users/4958288/a6se"}, "reply_to_user": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1559832790, "post_id": 56469011, "comment_id": 99550706, "body": "@Tsyvarev I see. So, are you implying that I should implement interrupts and call wake_up from an ISR?"}, {"owner": {"reputation": 65, "user_id": 4958288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/347887884f7ca31f185ef15a08e09ba0?s=128&d=identicon&r=PG&f=1", "display_name": "A6SE", "link": "https://stackoverflow.com/users/4958288/a6se"}, "reply_to_user": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1559833006, "post_id": 56469011, "comment_id": 99550837, "body": "@Tsyvarev But then again, I guess I wouldn&#39;t need poll at all if I have interrupts implemented. From where should I then call wake_up?"}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "reply_to_user": {"reputation": 3561, "user_id": 2511795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30c869f55cbcf82a7bc4536d563daa0a?s=128&d=identicon&r=PG", "display_name": "0andriy", "link": "https://stackoverflow.com/users/2511795/0andriy"}, "edited": false, "score": 0, "creation_date": 1559835476, "post_id": 56469011, "comment_id": 99552200, "body": "As I said in the first comment, I am not very familiar with GPIO and its interrupts, and I don&#39;t know the true place of <code>wake_up</code>. As @0andriy said, there is ready-made character device provided by GPIO. You may inspect its sources and find where it calls <code>wake_up</code>."}, {"owner": {"reputation": 65, "user_id": 4958288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/347887884f7ca31f185ef15a08e09ba0?s=128&d=identicon&r=PG&f=1", "display_name": "A6SE", "link": "https://stackoverflow.com/users/4958288/a6se"}, "reply_to_user": {"reputation": 3561, "user_id": 2511795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30c869f55cbcf82a7bc4536d563daa0a?s=128&d=identicon&r=PG", "display_name": "0andriy", "link": "https://stackoverflow.com/users/2511795/0andriy"}, "edited": false, "score": 0, "creation_date": 1559855956, "post_id": 56469011, "comment_id": 99560552, "body": "@0andriy Could you point me to the source of that character device? I can&#39;t seem to find it."}, {"owner": {"reputation": 3561, "user_id": 2511795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30c869f55cbcf82a7bc4536d563daa0a?s=128&d=identicon&r=PG", "display_name": "0andriy", "link": "https://stackoverflow.com/users/2511795/0andriy"}, "edited": false, "score": 0, "creation_date": 1559949174, "post_id": 56469011, "comment_id": 99593142, "body": "<i>drivers/gpio/gpiolib.c</i> \u2014 there is the implementation of the character device."}], "owner": {"reputation": 65, "user_id": 4958288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/347887884f7ca31f185ef15a08e09ba0?s=128&d=identicon&r=PG&f=1", "display_name": "A6SE", "link": "https://stackoverflow.com/users/4958288/a6se"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 657, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1559830558, "creation_date": 1559775074, "last_edit_date": 1559830558, "question_id": 56469011, "link": "https://stackoverflow.com/questions/56469011/how-to-implement-poll-function-into-linux-kernel-module", "title": "How to implement poll function into Linux kernel module?", "body": "<p>I'm trying to implement polling functionality into my simple Linux kernel module called gpio_driver for my Raspberry Pi which should notify the user space poll function about the change of state of one of the GPIO pins (button push).</p>\n\n<p>What I did in my gpio_driver is set the internal pull down on my GPIO_04 pin and direction to input, so when I press the button connected to the pin on one side and +5V on the other, it should generate a pulse which should notify the user space poll function that the button push happened and end the user space program.</p>\n\n<p>The user space program code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/time.h&gt;\n#include &lt;poll.h&gt;\n\nint main(int argc, char *argv[])\n{\n   char str[256];\n   struct pollfd pfd;\n   int fd, gpio;\n   char buf[8];\n\n   sprintf(str, \"/dev/gpio_driver\");\n\n   if ((fd = open(str, O_RDONLY)) &lt; 0)\n   {\n      fprintf(stderr, \"Failed, gpio %d not exported.\\n\", gpio);\n      exit(1);\n   }\n\n   pfd.fd = fd;\n\n   pfd.events = POLLPRI;\n\n   lseek(fd, 0, SEEK_SET);    /* consume any prior interrupt */\n   read(fd, buf, sizeof buf);\n\n   poll(&amp;pfd, 1, -1);         /* wait for interrupt */\n\n   lseek(fd, 0, SEEK_SET);    /* consume interrupt */\n   read(fd, buf, sizeof buf);\n\n   exit(0);\n}\n</code></pre>\n\n<p>Complete driver code (poll function implementation at the end of file):</p>\n\n<pre><code>#include &lt;linux/init.h&gt;\n#include &lt;linux/module.h&gt;\n#include &lt;linux/kernel.h&gt;\n#include &lt;linux/slab.h&gt;\n#include &lt;linux/fs.h&gt;\n#include &lt;linux/errno.h&gt;\n#include &lt;linux/types.h&gt;\n#include &lt;linux/fcntl.h&gt;\n#include &lt;linux/proc_fs.h&gt;\n#include &lt;linux/string.h&gt;\n#include &lt;linux/ioport.h&gt;\n#include &lt;linux/ktime.h&gt;\n#include &lt;linux/hrtimer.h&gt;\n#include &lt;asm/io.h&gt;\n#include &lt;asm/uaccess.h&gt;\n#include &lt;linux/uaccess.h&gt;\n#include &lt;linux/ioctl.h&gt; \n#include &lt;linux/poll.h&gt;\n\nMODULE_LICENSE(\"Dual BSD/GPL\");\n\n/* if defined, timer callback will implement LED0 flashing and\n   SW0 reading after each interval */\n#define TEST\n\n// timer interval defined as (TIMER_SEC + TIMER_NANO_SEC)\n#define TIMER_SEC    0\n#define TIMER_NANO_SEC  250*1000*1000 /* 250ms */\n\n// NOTE: Check Broadcom BCM8325 datasheet, page 91+\n// NOTE: GPIO Base address is set to 0x7E200000,\n//       but it is VC CPU BUS address, while the\n//       ARM physical address is 0x3F200000, what\n//       can be seen in pages 5-7 of Broadcom\n//       BCM8325 datasheet, having in mind that\n//       total system ram is 0x3F000000 (1GB - 16MB)\n//       instead of 0x20000000 (512 MB)\n\n/* GPIO registers base address. */\n#define BCM2708_PERI_BASE   (0x3F000000)\n#define GPIO_BASE           (BCM2708_PERI_BASE + 0x200000)\n#define GPIO_ADDR_SPACE_LEN (0xB4)\n//--\n\n//Handle GPIO: 0-9\n/* GPIO Function Select 0. */\n#define GPFSEL0_OFFSET (0x00000000)\n\n//Handle GPIO: 10-19\n/* GPIO Function Select 1. */\n#define GPFSEL1_OFFSET (0x00000004)\n\n//Handle GPIO: 20-29\n/* GPIO Function Select 2. */\n#define GPFSEL2_OFFSET (0x00000008)\n\n//Handle GPIO: 30-39\n/* GPIO Function Select 3. */\n#define GPFSEL3_OFFSET (0x0000000C)\n\n//Handle GPIO: 40-49\n/* GPIO Function Select 4. */\n#define GPFSEL4_OFFSET (0x00000010)\n\n//Handle GPIO: 50-53\n/* GPIO Function Select 5. */\n#define GPFSEL5_OFFSET (0x00000014)\n//--\n\n//GPIO: 0-31\n/* GPIO Pin Output Set 0. */\n#define GPSET0_OFFSET (0x0000001C)\n\n//GPIO: 32-53\n/* GPIO Pin Output Set 1. */\n#define GPSET1_OFFSET (0x00000020)\n//--\n\n//GPIO: 0-31\n/* GPIO Pin Output Clear 0. */\n#define GPCLR0_OFFSET (0x00000028)\n\n//GPIO: 32-53\n/* GPIO Pin Output Clear 1. */\n#define GPCLR1_OFFSET (0x0000002C)\n//--\n\n//GPIO: 0-31\n/* GPIO Pin Level 0. */\n#define GPLEV0_OFFSET (0x00000034)\n\n//GPIO: 32-53\n/* GPIO Pin Level 1. */\n#define GPLEV1_OFFSET (0x00000038)\n//--\n\n//GPIO: 0-53\n/* GPIO Pin Pull-up/down Enable. */\n#define GPPUD_OFFSET (0x00000094)\n\n//GPIO: 0-31\n/* GPIO Pull-up/down Clock Register 0. */\n#define GPPUDCLK0_OFFSET (0x00000098)\n\n//GPIO: 32-53\n/* GPIO Pull-up/down Clock Register 1. */\n#define GPPUDCLK1_OFFSET (0x0000009C)\n//--\n\n/* PUD - GPIO Pin Pull-up/down */\ntypedef enum {PULL_NONE = 0, PULL_DOWN = 1, PULL_UP = 2} PUD;\n//--\n\n//000 = GPIO Pin 'x' is an input\n//001 = GPIO Pin 'x' is an output\n// By default GPIO pin is being used as an input\ntypedef enum {GPIO_DIRECTION_IN = 0, GPIO_DIRECTION_OUT = 1} DIRECTION;\n//--\n\n/* GPIO pins available on connector p1. */\n#define GPIO_02 (2)\n#define GPIO_03 (3)\n#define GPIO_04 (4)\n#define GPIO_05 (5)\n#define GPIO_06 (6)\n#define GPIO_07 (7)\n#define GPIO_08 (8)\n#define GPIO_09 (9)\n#define GPIO_10 (10)\n#define GPIO_11 (11)\n#define GPIO_12 (12)\n#define GPIO_13 (13)\n#define GPIO_14 (14)\n#define GPIO_15 (15)\n#define GPIO_16 (16)\n#define GPIO_17 (17)\n#define GPIO_18 (18)\n#define GPIO_19 (19)\n#define GPIO_20 (20)\n#define GPIO_21 (21)\n#define GPIO_22 (22)\n#define GPIO_23 (23)\n#define GPIO_24 (24)\n#define GPIO_25 (25)\n#define GPIO_26 (26)\n#define GPIO_27 (27)\n\n/* Declaration of gpio_driver.c functions */\nint gpio_driver_init(void);\nvoid gpio_driver_exit(void);\nstatic int gpio_driver_open(struct inode *, struct file *);\nstatic int gpio_driver_release(struct inode *, struct file *);\nstatic ssize_t gpio_driver_read(struct file *, char *buf, size_t , loff_t *);\nstatic ssize_t gpio_driver_write(struct file *, const char *buf, size_t , loff_t *);\nstatic unsigned int gpio_driver_poll(struct file *, poll_table *);\n\n/* Structure that declares the usual file access functions. */\nstruct file_operations gpio_driver_fops =\n{\n    open            :   gpio_driver_open,\n    release         :   gpio_driver_release,\n    read            :   gpio_driver_read,\n    write           :   gpio_driver_write,\n    poll            :   gpio_driver_poll\n};\n\nstatic DECLARE_WAIT_QUEUE_HEAD(gpio_driver_wait);\n\n/* Declaration of the init and exit functions. */\nmodule_init(gpio_driver_init);\nmodule_exit(gpio_driver_exit);\n\n/* Major number. */\nint gpio_driver_major;\n\n/* Buffer to store data. */\n#define BUF_LEN 80\nchar* gpio_driver_buffer;\n\n/* Virtual address where the physical GPIO address is mapped */\nvoid* virt_gpio_base;\n\n/*\n * GetGPFSELReg function\n *  Parameters:\n *   pin    - number of GPIO pin;\n *\n *   return - GPFSELn offset from GPIO base address, for containing desired pin control\n *  Operation:\n *   Based on the passed GPIO pin number, finds the corresponding GPFSELn reg and\n *   returns its offset from GPIO base address.\n */\nunsigned int GetGPFSELReg(char pin)\n{\n    unsigned int addr;\n\n    if(pin &gt;= 0 &amp;&amp; pin &lt;10)\n        addr = GPFSEL0_OFFSET;\n    else if(pin &gt;= 10 &amp;&amp; pin &lt;20)\n        addr = GPFSEL1_OFFSET;\n    else if(pin &gt;= 20 &amp;&amp; pin &lt;30)\n        addr = GPFSEL2_OFFSET;\n    else if(pin &gt;= 30 &amp;&amp; pin &lt;40)\n        addr = GPFSEL3_OFFSET;\n    else if(pin &gt;= 40 &amp;&amp; pin &lt;50)\n        addr = GPFSEL4_OFFSET;\n    else /*if(pin &gt;= 50 &amp;&amp; pin &lt;53) */\n        addr = GPFSEL5_OFFSET;\n\n  return addr;\n}\n\n/*\n * GetGPIOPinOffset function\n *  Parameters:\n *   pin    - number of GPIO pin;\n *\n *   return - offset of the pin control bit, position in control registers\n *  Operation:\n *   Based on the passed GPIO pin number, finds the position of its control bit\n *   in corresponding control registers.\n */\nchar GetGPIOPinOffset(char pin)\n{\n    if(pin &gt;= 0 &amp;&amp; pin &lt;10)\n        pin = pin;\n    else if(pin &gt;= 10 &amp;&amp; pin &lt;20)\n        pin -= 10;\n    else if(pin &gt;= 20 &amp;&amp; pin &lt;30)\n        pin -= 20;\n    else if(pin &gt;= 30 &amp;&amp; pin &lt;40)\n        pin -= 30;\n    else if(pin &gt;= 40 &amp;&amp; pin &lt;50)\n        pin -= 40;\n    else /*if(pin &gt;= 50 &amp;&amp; pin &lt;53) */\n        pin -= 50;\n\n    return pin;\n}\n\n/*\n * SetInternalPullUpDown function\n *  Parameters:\n *   pin    - number of GPIO pin;\n *   pull   - set internal pull up/down/none if PULL_UP/PULL_DOWN/PULL_NONE selected\n *  Operation:\n *   Sets to use internal pull-up or pull-down resistor, or not to use it if pull-none\n *   selected for desired GPIO pin.\n */\nvoid SetInternalPullUpDown(char pin, PUD pull)\n{\n    unsigned int gppud_offset;\n    unsigned int gppudclk_offset;\n    unsigned int tmp;\n    unsigned int mask;\n\n    /* Get the offset of GPIO Pull-up/down Register (GPPUD) from GPIO base address. */\n    gppud_offset = GPPUD_OFFSET;\n\n    /* Get the offset of GPIO Pull-up/down Clock Register (GPPUDCLK) from GPIO base address. */\n    gppudclk_offset = (pin &lt; 32) ? GPPUDCLK0_OFFSET : GPPUDCLK1_OFFSET;\n\n    /* Get pin offset in register . */\n    pin = (pin &lt; 32) ? pin : pin - 32;\n\n    /* Write to GPPUD to set the required control signal (i.e. Pull-up or Pull-Down or neither\n       to remove the current Pull-up/down). */\n    iowrite32(pull, virt_gpio_base + gppud_offset);\n\n    /* Wait 150 cycles \u2013 this provides the required set-up time for the control signal */\n\n    /* Write to GPPUDCLK0/1 to clock the control signal into the GPIO pads you wish to\n       modify \u2013 NOTE only the pads which receive a clock will be modified, all others will\n       retain their previous state. */\n    tmp = ioread32(virt_gpio_base + gppudclk_offset);\n    mask = 0x1 &lt;&lt; pin;\n    tmp |= mask;\n    iowrite32(tmp, virt_gpio_base + gppudclk_offset);\n\n    /* Wait 150 cycles \u2013 this provides the required hold time for the control signal */\n\n    /* Write to GPPUD to remove the control signal. */\n    iowrite32(PULL_NONE, virt_gpio_base + gppud_offset);\n\n    /* Write to GPPUDCLK0/1 to remove the clock. */\n    tmp = ioread32(virt_gpio_base + gppudclk_offset);\n    mask = 0x1 &lt;&lt; pin;\n    tmp &amp;= (~mask);\n    iowrite32(tmp, virt_gpio_base + gppudclk_offset);\n}\n\n/*\n * SetGpioPinDirection function\n *  Parameters:\n *   pin       - number of GPIO pin;\n *   direction - GPIO_DIRECTION_IN or GPIO_DIRECTION_OUT\n *  Operation:\n *   Sets the desired GPIO pin to be used as input or output based on the direcation value.\n */\nvoid SetGpioPinDirection(char pin, DIRECTION direction)\n{\n    unsigned int GPFSELReg_offset;\n    unsigned int tmp;\n    unsigned int mask;\n\n    /* Get base address of function selection register. */\n    GPFSELReg_offset = GetGPFSELReg(pin);\n\n    /* Calculate gpio pin offset. */\n    pin = GetGPIOPinOffset(pin);\n\n    /* Set gpio pin direction. */\n    tmp = ioread32(virt_gpio_base + GPFSELReg_offset);\n    if(direction)\n    { //set as output: set 1\n      mask = 0x1 &lt;&lt; (pin*3);\n      tmp |= mask;\n    }\n    else\n    { //set as input: set 0\n      mask = ~(0x1 &lt;&lt; (pin*3));\n      tmp &amp;= mask;\n    }\n    iowrite32(tmp, virt_gpio_base + GPFSELReg_offset);\n}\n\n/*\n * GetGpioPinDirection function\n *  Parameters:\n *   pin       - number of GPIO pin;\n *  Operation:\n *   Gets the desired GPIO pin's direction and returns 0 for IN and 1 for OUT.\n */\nint  GetGpioPinDirection(char pin)\n{\n    unsigned int GPFSELReg_offset;\n    unsigned int tmp;\n    unsigned int mask;\n\n    /* Get base address of function selection register. */\n    GPFSELReg_offset = GetGPFSELReg(pin);\n\n    /* Calculate gpio pin offset. */\n    pin = GetGPIOPinOffset(pin);\n\n    /* Get gpio pin direction. */\n    tmp = ioread32(virt_gpio_base + GPFSELReg_offset);\n\n    mask = 0x1 &lt;&lt; (pin*3);\n    tmp &amp;= mask;\n    tmp=tmp&gt;&gt;(pin*3);\n    return tmp;\n }\n\n/*\n * SetGpioPin function\n *  Parameters:\n *   pin       - number of GPIO pin;\n *  Operation:\n *   Sets the desired GPIO pin to HIGH level. The pin should previously be defined as output.\n */\nvoid SetGpioPin(char pin)\n{\n    unsigned int GPSETreg_offset;\n    unsigned int tmp;\n\n    /* Get base address of gpio set register. */\n    GPSETreg_offset = (pin &lt; 32) ? GPSET0_OFFSET : GPSET1_OFFSET;\n    pin = (pin &lt; 32) ? pin : pin - 32;\n\n    /* Set gpio. */\n    tmp = 0x1 &lt;&lt; pin;\n    iowrite32(tmp, virt_gpio_base + GPSETreg_offset);\n}\n\n/*\n * ClearGpioPin function\n *  Parameters:\n *   pin       - number of GPIO pin;\n *  Operation:\n *   Sets the desired GPIO pin to LOW level. The pin should previously be defined as output.\n */\nvoid ClearGpioPin(char pin)\n{\n    unsigned int GPCLRreg_offset;\n    unsigned int tmp;\n\n    /* Get base address of gpio clear register. */\n    GPCLRreg_offset = (pin &lt; 32) ? GPCLR0_OFFSET : GPCLR1_OFFSET;\n    pin = (pin &lt; 32) ? pin : pin - 32;\n\n    /* Clear gpio. */\n    tmp = 0x1 &lt;&lt; pin;\n    iowrite32(tmp, virt_gpio_base + GPCLRreg_offset);\n}\n\n/*\n * GetGpioPinValue function\n *  Parameters:\n *   pin       - number of GPIO pin;\n *\n *   return    - the level read from desired GPIO pin\n *  Operation:\n *   Reads the level from the desired GPIO pin and returns the read value.\n */\nchar GetGpioPinValue(char pin)\n{\n    unsigned int GPLEVreg_offset;\n    unsigned int tmp;\n    unsigned int mask;\n\n    /* Get base address of gpio level register. */\n    GPLEVreg_offset = (pin &lt; 32) ?  GPLEV0_OFFSET : GPLEV1_OFFSET;\n    pin = (pin &lt; 32) ? pin : pin - 32;\n\n    /* Read gpio pin level. */\n    tmp = ioread32(virt_gpio_base + GPLEVreg_offset);\n    mask = 0x1 &lt;&lt; pin;\n    tmp &amp;= mask;\n\n    return (tmp &gt;&gt; pin);\n}\n\n/*\n * Initialization:\n *  1. Register device driver\n *  2. Allocate buffer\n *  3. Initialize buffer\n *  4. Map GPIO Physical address space to virtual address\n *  5. Initialize GPIO pin\n */\nint gpio_driver_init(void)\n{\n    int result = -1;\n\n    printk(KERN_INFO \"Inserting gpio_driver module\\n\");\n\n    /* Registering device. */\n    result = register_chrdev(0, \"gpio_driver\", &amp;gpio_driver_fops);\n    if (result &lt; 0)\n    {\n        printk(KERN_INFO \"gpio_driver: cannot obtain major number %d\\n\", gpio_driver_major);\n        return result;\n    }\n\n    gpio_driver_major = result;\n    printk(KERN_INFO \"gpio_driver major number is %d\\n\", gpio_driver_major);\n\n    /* Allocating memory for the buffer. */\n    gpio_driver_buffer = kmalloc(BUF_LEN, GFP_KERNEL);\n    if (!gpio_driver_buffer)\n    {\n        result = -ENOMEM;\n        goto fail_no_mem;\n    }\n\n    /* Initialize data buffer. */\n    memset(gpio_driver_buffer, 0, BUF_LEN);\n\n    /* map the GPIO register space from PHYSICAL address space to virtual address space */\n    virt_gpio_base = ioremap(GPIO_BASE, GPIO_ADDR_SPACE_LEN);\n    if(!virt_gpio_base)\n    {\n        result = -ENOMEM;\n        goto fail_no_virt_mem;\n    }\n\n    /* Initialize GPIO pin. */\n    SetGpioPinDirection(GPIO_04, GPIO_DIRECTION_IN);\n    SetInternalPullUpDown(GPIO_04, PULL_DOWN); // rising edge\n\n    return 0;\n\nfail_no_virt_mem:\n    /* Freeing buffer gpio_driver_buffer. */\n    if (gpio_driver_buffer)\n    {\n        kfree(gpio_driver_buffer);\n    }\nfail_no_mem:\n    /* Freeing the major number. */\n    unregister_chrdev(gpio_driver_major, \"gpio_driver\");\n\n    return result;\n}\n\n/*\n * Cleanup:\n *  1. stop the timer\n *  2. release GPIO pins (clear all outputs, set all as inputs and pull-none to minimize the power consumption)\n *  3. Unmap GPIO Physical address space from virtual address\n *  4. Free buffer\n *  5. Unregister device driver\n */\nvoid gpio_driver_exit(void)\n{\n    printk(KERN_INFO \"Removing gpio_driver module..\\n\");\n\n    /* Clear GPIO pins. */\n    ClearGpioPin(GPIO_04);\n\n    /* Set GPIO pins as inputs and disable pull-ups. */\n    SetGpioPinDirection(GPIO_04, GPIO_DIRECTION_IN);\n    SetInternalPullUpDown(GPIO_04, PULL_NONE);\n\n    /* Unmap GPIO Physical address space. */\n    if (virt_gpio_base)\n    {\n        iounmap(virt_gpio_base);\n    }\n\n    /* Freeing buffer gpio_driver_buffer. */\n    if (gpio_driver_buffer)\n    {\n        kfree(gpio_driver_buffer);\n    }\n\n    /* Freeing the major number. */\n    unregister_chrdev(gpio_driver_major, \"gpio_driver\");\n}\n\n/* File open function. */\nstatic int gpio_driver_open(struct inode *inode, struct file *filp)\n{\n    /* Success. */\n    return 0;\n}\n\n/* File close function. */\nstatic int gpio_driver_release(struct inode *inode, struct file *filp)\n{\n    /* Success. */\n    return 0;\n}\n\n/* File read function */\nstatic ssize_t gpio_driver_read(struct file *filp, char *buf, size_t len, loff_t *f_pos)\n{\n    /* Size of valid data in gpio_driver - data to send in user space. */\n    int data_size = 0;\n\n    /* Copy GPIO pin state to user space. */\n    gpio_driver_buffer[0]=GetGpioPinValue(GPIO_04);\n\n    /* TODO: fill gpio_driver_buffer here. */\n\n    if (*f_pos == 0)\n    {\n        /* Get size of valid data. */\n        data_size = strlen(gpio_driver_buffer);\n\n        /* Send data to user space. */\n        if (copy_to_user(buf, gpio_driver_buffer, data_size) != 0)\n        {\n            return -EFAULT;\n        }\n        else\n        {\n            (*f_pos) += data_size;\n\n            return data_size;\n        }\n    }\n    else\n    {\n        return 0;\n    }\n}\n\n/* File write function */\nstatic ssize_t gpio_driver_write(struct file *filp, const char *buf, size_t len, loff_t *f_pos)\n{\n    printk(KERN_ALERT \"Sorry, this operation isn't supported.\\n\");\n\n    return -EPERM; // Operation not permitted error\n}\n\nstatic unsigned int gpio_driver_poll(struct file *filp, poll_table *wait)\n{\n    unsigned int mask = 0;\n    poll_wait(filp, &amp;gpio_driver_wait, wait);\n    if(GetGpioPinValue(GPIO_04)!=0)\n        gpio_driver_buffer[0] = 1;\n    if(gpio_driver_buffer[0] == 1)\n    {\n        mask |= POLLIN | POLLPRI;\n        wake_up_interruptible(&amp;gpio_driver_wait);\n    }\n    gpio_driver_buffer[0] = 0;\n    return mask;\n}\n</code></pre>\n\n<p>However, when I run my user space program, it doesn't react to my button pushes and it never exits. I'm pretty new to polling all the code written in the driver related to polling and user program I picked up online from different sources and some books (mainly Linux Device Drivers, 3rd edition, chapter 6). What am I doing wrong?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1559775247, "post_id": 56468974, "comment_id": 99529442, "body": "what? <code>%s</code> is even less right than <code>scanf (&quot;%[^\\n]%*c&quot;, string);</code>"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1559775329, "post_id": 56468974, "comment_id": 99529460, "body": "Also your code formatting is horrible, hence it is hard to se if it is right or not, and you&#39;re not null-terminating the resulting string correctly."}, {"owner": {"reputation": 11277, "user_id": 3657941, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/304d8d4cceca5f9ce2383ff97b53e36b?s=128&d=identicon&r=PG&f=1", "display_name": "David Cullen", "link": "https://stackoverflow.com/users/3657941/david-cullen"}, "edited": false, "score": 0, "creation_date": 1559780383, "post_id": 56468974, "comment_id": 99530317, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/1247989/how-do-you-allow-spaces-to-be-entered-using-scanf\">How do you allow spaces to be entered using scanf?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 10752058, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-NDZzlrys9qY/AAAAAAAAAAI/AAAAAAAADzA/GAOIT3R2P4g/photo.jpg?sz=128", "display_name": "ian ferraz", "link": "https://stackoverflow.com/users/10752058/ian-ferraz"}, "edited": false, "score": 1, "creation_date": 1559780394, "post_id": 56469541, "comment_id": 99530321, "body": "I\u2019m just getting started at my computer science, so all of this is kind of new for me.... \ud83d\ude05. But thanks to people like you I can move forwards even when reaching a problem for which I\u2019m not yet prepared to solve. Anyway, thanks for answering my question and also for the tips on how making my code less complicated, truly helpful \ud83d\ude4f"}], "tags": [], "owner": {"reputation": 2311, "user_id": 6032010, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-cCbzrdp-8HI/AAAAAAAAAAI/AAAAAAAAAAA/g1GQeurueXA/photo.jpg?sz=128", "display_name": "SHG", "link": "https://stackoverflow.com/users/6032010/shg"}, "is_accepted": true, "score": 1, "last_activity_date": 1559780052, "creation_date": 1559780052, "answer_id": 56469541, "question_id": 56468974, "link": "https://stackoverflow.com/questions/56468974/reading-space-character-into-string-with-size-determined-by-str-size/56469541#56469541", "title": "reading space character into string with size determined by str_size", "body": "<p><code>scanf</code> is not the way to go, especially if your input might contain white-spaces on which <code>scanf</code> would stop reading more inputs and wouldn't store spaces for instance.</p>\n\n<p>You should use <code>fgets</code> which lets you limit the input data according to the buffer this data is stored in. So something like:</p>\n\n<pre><code>fgets(string, STR_SIZE, stdin)\n</code></pre>\n\n<p>should work.</p>\n\n<p>About the size - you should have some limitation about the maximum size of the string and then STR_SIZE should be set to this number. It should be part of your program requirements or just a size that makes sense if you're making the requirements. It must be defined before you're reading input from the user because the buffer memory is allocated <strong>before</strong> reading to it.</p>\n\n<hr>\n\n<p>A comment about style, unrelated to your question - always try to decrease code duplication to 0. The line <code>alfanumerico[count2] = string[count]; count2++;</code> appears 4 times in your code. A more elegant minimal <code>if</code> statement with exactly the same functionality would be:</p>\n\n<pre><code>if ((string[count] &gt;= '0' &amp;&amp; string[count] &lt;= '9') ||\n    (string[count] &gt;= 'a' &amp;&amp; string[count] &lt;= 'z') ||\n    (string[count] &gt;= 'A' &amp;&amp; string[count] &lt;= 'Z') || \n    (string[count] == ' '))\n{\n    alfanumerico[count2] = string[count];\n    count2++;\n}\n</code></pre>\n\n<p>and to be even more minimal:</p>\n\n<pre><code>char c = string[count];\nif ((c &gt;= '0' &amp;&amp; c &lt;= '9') ||\n    (c &gt;= 'a' &amp;&amp; c &lt;= 'z') ||\n    (c &gt;= 'A' &amp;&amp; c &lt;= 'Z') || \n    (c == ' '))\n{\n    alfanumerico[count2] = c;\n    count2++;\n}\n</code></pre>\n\n<p>It's also more readable and more maintainable - if you want to change the variable <code>count</code> to <code>i</code> you do it in one place instead of 8.</p>\n\n<p>Also, always close a scope in a new line.</p>\n"}], "owner": {"reputation": 13, "user_id": 10752058, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-NDZzlrys9qY/AAAAAAAAAAI/AAAAAAAADzA/GAOIT3R2P4g/photo.jpg?sz=128", "display_name": "ian ferraz", "link": "https://stackoverflow.com/users/10752058/ian-ferraz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "accepted_answer_id": 56469541, "answer_count": 1, "score": 0, "last_activity_date": 1559781066, "creation_date": 1559774706, "last_edit_date": 1559781066, "question_id": 56468974, "link": "https://stackoverflow.com/questions/56468974/reading-space-character-into-string-with-size-determined-by-str-size", "title": "reading space character into string with size determined by str_size", "body": "<p>I'm trying to make this program such that the user could type any given string of characters, and the program would separate alphanumerical characters from the rest, print them into a second string, and finally print the final result into the screen.</p>\n\n<p>I've already tried using <code>scanf (\"%[^\\n]%*c\", string);</code>, but it doesn't seem to work since the size of the string is not specified beforehand, and is rather defined by <code>STR_SIZE</code>.</p>\n\n<pre><code>char string[STR_SIZE];\n\nprintf(\"please type in a string \\n\");\nscanf(\"%s\", string);\nprintf(\"string: \\n %s \\n\", string);\nint size = (strlen(string));\nchar alfanumerico[STR_SIZE];\nint count = 0;\nint count2 = 0;\n\nwhile(count &lt;= size)\n{\n    if(string[count] &gt;= '0' &amp;&amp; string[count] &lt;= '9')\n    {\n        alfanumerico[count2] = string[count];\n        count2++;\n    }\n    if(string[count] &gt;= 'a' &amp;&amp; string[count] &lt;= 'z')\n    {\n        alfanumerico[count2] = string[count];\n        count2++;\n    }\n    if(string[count] &gt;= 'A' &amp;&amp; string[count] &lt;= 'Z')\n    {\n        alfanumerico[count2] = string[count];\n        count2++;\n    }\n    if(string[count] ==' ')\n    {\n        alfanumerico[count2] = string[count];\n        count2++;\n    }\n    count++;\n}\n\nprintf(\"alphanumerical characters typed: \\n %s \\n\", alfanumerico);\n</code></pre>\n\n<p>Given the user typed a string such as: <code>-=-=[[][][]}}Hello 123 ```//././.</code></p>\n\n<p>I expect the output to be: <code>Hello 123</code></p>\n"}, {"tags": ["c", "cmake", "clion", "glib"], "comments": [{"owner": {"reputation": 11727, "user_id": 3987854, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/OV64v.jpg?s=128&g=1", "display_name": "squareskittles", "link": "https://stackoverflow.com/users/3987854/squareskittles"}, "edited": false, "score": 1, "creation_date": 1559775275, "post_id": 56468938, "comment_id": 99529449, "body": "That is not a CMake error you posted, but a linker error. However, it likely caused by your CMake because the linker cannot find the definitions for these <code>g_notification_*</code> calls you are making."}, {"owner": {"reputation": 11727, "user_id": 3987854, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/OV64v.jpg?s=128&g=1", "display_name": "squareskittles", "link": "https://stackoverflow.com/users/3987854/squareskittles"}, "edited": false, "score": 1, "creation_date": 1559775505, "post_id": 56468938, "comment_id": 99529494, "body": "You can try adding <code>message(STATUS ${GLIB_LIBRARIES})</code> to your CMakeLists to see if CMake found the libraries correctly. Also I suggest looking at this <a href=\"https://stackoverflow.com/questions/29191855/what-is-the-proper-way-to-use-pkg-config-from-cmake\">post</a>, and consider using <code>find_package()</code> instead."}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1559778322, "post_id": 56468938, "comment_id": 99530007, "body": "Welcome to Stack Overflow! Here we expect the error message to be in the question post (as <b>text</b>), not linked as <i>image</i>. Please, <a href=\"https://stackoverflow.com/posts/56468938/edit\">edit</a> your question post and copy paste the error message into it. After the pasting, you may format that message as a code."}, {"owner": {"reputation": 11, "user_id": 11606409, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oLUCObaE-vo/AAAAAAAAAAI/AAAAAAAAAa0/O9UZMfPlBlA/photo.jpg?sz=128", "display_name": "Gao XiangShuai", "link": "https://stackoverflow.com/users/11606409/gao-xiangshuai"}, "edited": false, "score": 0, "creation_date": 1559779255, "post_id": 56468938, "comment_id": 99530146, "body": "I still get the same error. message(STATUS ${GLIB_LIBRARIES}) doesn&#39;t seem to tell me any more info except the same old undefined errors."}, {"owner": {"reputation": 253, "user_id": 6130067, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7eeb56375d9f625d01a18313c9a076f1?s=128&d=identicon&r=PG&f=1", "display_name": "Badr El Hiouel", "link": "https://stackoverflow.com/users/6130067/badr-el-hiouel"}, "edited": false, "score": 0, "creation_date": 1559804720, "post_id": 56468938, "comment_id": 99535525, "body": "Try adding in your target_link_libraries ${GLIB _LDFLAGS}"}, {"owner": {"reputation": 3822, "user_id": 792456, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/6706944a2a8b4e2d37b330dd64cf9c69?s=128&d=identicon&r=PG", "display_name": "arved", "link": "https://stackoverflow.com/users/792456/arved"}, "edited": false, "score": 0, "creation_date": 1559808323, "post_id": 56468938, "comment_id": 99537212, "body": "Use VERBOSE=1 to see the actual compiler output"}, {"owner": {"reputation": 11, "user_id": 11606409, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oLUCObaE-vo/AAAAAAAAAAI/AAAAAAAAAa0/O9UZMfPlBlA/photo.jpg?sz=128", "display_name": "Gao XiangShuai", "link": "https://stackoverflow.com/users/11606409/gao-xiangshuai"}, "edited": false, "score": 0, "creation_date": 1559844644, "post_id": 56468938, "comment_id": 99556256, "body": "Verbose throw the same error as in clion. I tried just compiling using gcc, without the cmake and make files. It throws the same linkage error. I am thinking issue lies elsewhere. It is a bit frustrating."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 9844932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtPsm.jpg?s=128&g=1", "display_name": "A.Emami", "link": "https://stackoverflow.com/users/9844932/a-emami"}, "is_accepted": false, "score": 0, "last_activity_date": 1613165471, "creation_date": 1613165471, "answer_id": 66179299, "question_id": 56468938, "link": "https://stackoverflow.com/questions/56468938/undefined-references-when-included-glib-in-clion-using-cmake/66179299#66179299", "title": "Undefined references when included GLIB in clion using cmake", "body": "<p>Try this:</p>\n<pre><code>gcc -o note `pkg-config --cflags --libs gio-2.0` note.c\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4022, "user_id": 2931197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31e3379958588750196bc49f6925ab62?s=128&d=identicon&r=PG&f=1", "display_name": "Philip Withnall", "link": "https://stackoverflow.com/users/2931197/philip-withnall"}, "is_accepted": false, "score": 1, "last_activity_date": 1613302748, "creation_date": 1613302748, "answer_id": 66195036, "question_id": 56468938, "link": "https://stackoverflow.com/questions/56468938/undefined-references-when-included-glib-in-clion-using-cmake/66195036#66195036", "title": "Undefined references when included GLIB in clion using cmake", "body": "<p>You need something like</p>\n<pre><code>pkg_check_modules(GLIB glib-2.0 gio-2.0 REQUIRED)\n</code></pre>\n<p>or additionally</p>\n<pre><code>pkg_check_modules(GIO gio-2.0 REQUIRED)\n</code></pre>\n<p>because <code>GNotification</code> is provided by <code>libgio</code>, which is a separate library from <code>libglib</code>, even though they both come from the same source tree.</p>\n"}], "owner": {"reputation": 11, "user_id": 11606409, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oLUCObaE-vo/AAAAAAAAAAI/AAAAAAAAAa0/O9UZMfPlBlA/photo.jpg?sz=128", "display_name": "Gao XiangShuai", "link": "https://stackoverflow.com/users/11606409/gao-xiangshuai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 234, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1613302748, "creation_date": 1559774347, "last_edit_date": 1559778574, "question_id": 56468938, "link": "https://stackoverflow.com/questions/56468938/undefined-references-when-included-glib-in-clion-using-cmake", "title": "Undefined references when included GLIB in clion using cmake", "body": "<p>I am trying to write a notification service for gnome but cmake keeps outputting undefined reference errors when building. I am using clion IDE and glib2.0 libraries and running on Fedora workstation 30. </p>\n\n<p>What I have tried so far is searching lots of stack overflow threads and googling for hours. </p>\n\n<p>My <code>CMakeLists.txt</code> file, which is copied from another StackOverflow thread, is here:</p>\n\n<pre><code>cmake_minimum_required(VERSION 3.14)\nproject(gnome_notification C)\n\nset(CMAKE_C_STANDARD 99)\n\ninclude(FindPkgConfig)\npkg_check_modules(GLIB glib-2.0 REQUIRED)\ninclude_directories(${GLIB_INCLUDE_DIRS})\n\nset(SOURCE_FILES main.c)\n\nadd_executable(${PROJECT_NAME} ${SOURCE_FILES})\ntarget_link_libraries(${PROJECT_NAME} ${GLIB_LIBRARIES})\n</code></pre>\n\n<p>My main.c file is here:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;gio/gio.h&gt;\nint main() {\n    GApplication* application = g_application_new (\"Test\", G_APPLICATION_FLAGS_NONE);\n    GNotification* notification = g_notification_new(\"Test Title\");\n    g_notification_set_body(notification, \"Test body\");\n    g_notification_set_priority(notification, G_NOTIFICATION_PRIORITY_NORMAL);\n    g_application_send_notification(application, \"Test Id\", notification);\n    return 0;\n}\n</code></pre>\n\n<p>The build yields undefined reference error:</p>\n\n<pre><code>/home/xgao/bin/Clion/bin/cmake/linux/bin/cmake --build /home/xgao/Desktop/gnome_notification/cmake-build-debug --target gnome_notification -- -j 4\n-- Configuring done\n-- Generating done\n-- Build files have been written to: /home/xgao/Desktop/gnome_notification/cmake-build-debug\n[ 50%] Linking C executable gnome_notification\n/usr/bin/ld: CMakeFiles/gnome_notification.dir/main.c.o: in function `main':\n/home/xgao/Desktop/gnome_notification/main.c:4: undefined reference to `g_application_new'\n/usr/bin/ld: /home/xgao/Desktop/gnome_notification/main.c:5: undefined reference to `g_notification_new'\n/usr/bin/ld: /home/xgao/Desktop/gnome_notification/main.c:6: undefined reference to `g_notification_set_body'\n/usr/bin/ld: /home/xgao/Desktop/gnome_notification/main.c:7: undefined reference to `g_notification_set_priority'\n/usr/bin/ld: /home/xgao/Desktop/gnome_notification/main.c:8: undefined reference to `g_application_send_notification'\ncollect2: error: ld returned 1 exit status\ngmake[3]: *** [CMakeFiles/gnome_notification.dir/build.make:84: gnome_notification] Error 1\ngmake[2]: *** [CMakeFiles/Makefile2:73: CMakeFiles/gnome_notification.dir/all] Error 2\ngmake[1]: *** [CMakeFiles/Makefile2:85: CMakeFiles/gnome_notification.dir/rule] Error 2\ngmake: *** [Makefile:118: gnome_notification] Error 2\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 351, "user_id": 4604759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6de599df6671db42349c8b438ec7a350?s=128&d=identicon&r=PG&f=1", "display_name": "MiCo", "link": "https://stackoverflow.com/users/4604759/mico"}, "edited": false, "score": 0, "creation_date": 1559774261, "post_id": 56468790, "comment_id": 99529245, "body": "It is not clear to me what you actually want do. If you print the C string &quot;\\\\x41\\\\x41\\\\x41\\\\x41&quot; it shows \\x41\\x41\\41\\x41 because the double back-slash means a single back-slash, see <a href=\"https://en.wikipedia.org/wiki/Escape_sequences_in_C#Table_of_escape_sequences\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/&hellip;</a>. If you print the C string &quot;\\x41\\x41\\x41\\x41&quot; it shows AAAA because \\x followed by two hexadecimal digits shows the relating ASCII charachter."}, {"owner": {"reputation": 29, "user_id": 11606380, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65b3f7503fec9fd81e10c5d1d4c9f832?s=128&d=identicon&r=PG&f=1", "display_name": "creepy", "link": "https://stackoverflow.com/users/11606380/creepy"}, "reply_to_user": {"reputation": 351, "user_id": 4604759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6de599df6671db42349c8b438ec7a350?s=128&d=identicon&r=PG&f=1", "display_name": "MiCo", "link": "https://stackoverflow.com/users/4604759/mico"}, "edited": false, "score": 0, "creation_date": 1559774715, "post_id": 56468790, "comment_id": 99529346, "body": "it would show as <code>AAAA</code> but if you had <code>\\x41</code> but when you have <code>\\\\x41</code> the first backslash is escaped"}, {"owner": {"reputation": 8506, "user_id": 10808674, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j1tGB.jpg?s=128&g=1", "display_name": "Alain Merigot", "link": "https://stackoverflow.com/users/10808674/alain-merigot"}, "edited": false, "score": 0, "creation_date": 1559775145, "post_id": 56468790, "comment_id": 99529425, "body": "Your explanation is not clear, but I think you want to replace all \\x41 in the string by the corresponding char. In that case, you can try split the string with strtok() with the &#39;\\&#39; as delimiters, prepend a 0 on the chunks and use strtol() on the remaining 0x41 to convert them to chars. Then you sprintf() %c all the chars together."}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 11606380, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65b3f7503fec9fd81e10c5d1d4c9f832?s=128&d=identicon&r=PG&f=1", "display_name": "creepy", "link": "https://stackoverflow.com/users/11606380/creepy"}, "edited": false, "score": 0, "creation_date": 1559777736, "post_id": 56469147, "comment_id": 99529900, "body": "your answer worked as well, but unfortunately I can accept only one answer, but thank you anyway"}], "tags": [], "owner": {"reputation": 351, "user_id": 4604759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6de599df6671db42349c8b438ec7a350?s=128&d=identicon&r=PG&f=1", "display_name": "MiCo", "link": "https://stackoverflow.com/users/4604759/mico"}, "is_accepted": true, "score": 1, "last_activity_date": 1559776207, "creation_date": 1559776207, "answer_id": 56469147, "question_id": 56468790, "link": "https://stackoverflow.com/questions/56468790/how-to-convert-x41-to-x41-in-c/56469147#56469147", "title": "How to convert &#39;\\\\x41&#39; to &#39;\\x41&#39; in c?", "body": "<p>Try this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;ctype.h&gt;\n\nvoid parseCstring(const char buf[], char con[])\n{\n    int i=0, j=0;\n    unsigned char x;\n    while ( (x = buf[i]) != '\\0')\n    {\n        if ( (x=='\\\\') &amp;&amp; (buf[i+1]=='x') &amp;&amp; (isxdigit(buf[i+2])) &amp;&amp; (isxdigit(buf[i+3])) )\n        {\n            unsigned int val;\n            sscanf(&amp;(buf[i+2]),\"%2x\", &amp;val);\n            x=(unsigned char)val;\n            i+=3;\n        }\n        con[j++]=x;\n        i++;\n    }\n}\n\nint main()\n{\n    char buf[] = \"\\\\x41\\\\x42\\\\x42\\\\x41 was great\\\\x21\";\n    char con[40];\n    printf(\"%s\\n\",buf);\n    parseCstring(buf, con);\n    printf(\"%s\\n\",con);\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 11606380, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65b3f7503fec9fd81e10c5d1d4c9f832?s=128&d=identicon&r=PG&f=1", "display_name": "creepy", "link": "https://stackoverflow.com/users/11606380/creepy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 183, "favorite_count": 0, "accepted_answer_id": 56469147, "answer_count": 1, "score": 0, "last_activity_date": 1559780884, "creation_date": 1559773237, "question_id": 56468790, "link": "https://stackoverflow.com/questions/56468790/how-to-convert-x41-to-x41-in-c", "title": "How to convert &#39;\\\\x41&#39; to &#39;\\x41&#39; in c?", "body": "<p>Probably the question has already been answered, but unfortunately many many attempts didn't work for me :(</p>\n\n<p>Precisely said, let's assume I have:</p>\n\n<pre><code>char buf[] = \"\\\\x41\\\\x41\\\\x41\\\\x41\"\n</code></pre>\n\n<p>Basically I want to convert it into</p>\n\n<pre><code>char con[] = \"\\x41\\x41\\x41\\x41\"\n</code></pre>\n\n<p>I tried by splitting the buf into arrays like:</p>\n\n<pre><code>buf1[]=\"41\",buf2[]=\"41\", buf3[]=\"41\", buf4[]=\"41\"\nchar newbuf[30];\nsprintf(newbuf, \"%2x%2x%2x%2x\", buf1,buf2,buf3,buf4);\nprintf(\"%s:%llx:%p:%d\",newbuf,newbuf,newbuf, strlen(newbuf))\n</code></pre>\n\n<p>and the output I get is: <code>ffffe3f0ffffe410ffffe430ffffe450ffffe470ffffe490:7fffffffe3b0:0x7fffffffe3b0:48</code></p>\n\n<p>But the output I wish to see is <code>AAAA</code></p>\n\n<p>So is there something I am missing or doing wrong?</p>\n"}, {"tags": ["c", "arrays", "string", "char"], "comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 1, "creation_date": 1559770711, "post_id": 56468292, "comment_id": 99528190, "body": "Please read up on the difference of <code>%c</code> and <code>%s</code> for scanf. E.g. <a href=\"https://en.cppreference.com/w/c/io/fscanf\" rel=\"nofollow noreferrer\">en.cppreference.com/w/c/io/fscanf</a> then let us know whether your problem (which is not very clear to me) persists. If yes, please make a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> to demonstrate, naming sample input and describing result. For that your program should be changed to actually have a result, e.g. change to print what was read first, before trying to go all the way. This matches the idea <a href=\"https://ericlippert.com/2014/03/21/find-a-simpler-problem/\" rel=\"nofollow noreferrer\">ericlippert.com/2014/03/21/find-a-simpler-problem</a> and also some parts of   <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">ericlippert.com/2014/03/05/how-to-debug-small-programs</a>"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 1, "creation_date": 1559770788, "post_id": 56468292, "comment_id": 99528226, "body": "Also, scanf cannot be used by guessing. Find help here <a href=\"http://sekrit.de/webdocs/c/beginners-guide-away-from-scanf.html\" rel=\"nofollow noreferrer\">sekrit.de/webdocs/c/beginners-guide-away-from-scanf.html</a>"}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 2, "creation_date": 1559771090, "post_id": 56468292, "comment_id": 99528340, "body": "<code>scanf(&quot;%s&quot;, &amp;array)</code> ==&gt; <code>scanf(&quot;%99s&quot;, array)</code> to input a <i>word</i> (no spaces) into <code>array</code>"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 3, "creation_date": 1559771362, "post_id": 56468292, "comment_id": 99528439, "body": "And ALWAYS validate the return, e.g. <code>if (scanf(&quot;%99s&quot;, array) != 1) { &#47;* handle error *&#47; }</code> (or better yet, include <code>string.h</code> and use <code>if (fgets (array, 100, stdin)) { array[strcspn (array, &quot;\\n&quot;)] = 0; ... }</code>)"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1559793849, "post_id": 56468292, "comment_id": 99532465, "body": "Note that a string is an array of characters terminated by a null byte.  It isn&#39;t clear that you need to split it up after you&#39;ve read it; it already is in a character array."}], "owner": {"reputation": 13, "user_id": 11127375, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-twP-UJmFK8U/AAAAAAAAAAI/AAAAAAAAAMo/Wtzb5O2ry-o/photo.jpg?sz=128", "display_name": "Tim Pavic", "link": "https://stackoverflow.com/users/11127375/tim-pavic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 128, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1559770304, "creation_date": 1559770304, "question_id": 56468292, "link": "https://stackoverflow.com/questions/56468292/how-to-input-a-string-using-scanf-and-convert-it-into-a-character-array", "title": "How to input a string using scanf() and convert it into a character array", "body": "<p>So im trying to to have a user input a string using scanf() and then convert that string into an array of characters which i can then convert into an array of values depending on the character input.</p>\n\n<p>ive tried inputing a string into an array directly and inputing a string into a variable and then converting that variable into an array</p>\n\n<pre><code>int main() {\n    char array[100];\n    scanf(\"%s\", &amp;array);\n}\n\n\nint main() {\n    char input, array[100];\n    scanf(\"%s\", &amp;input);\n    array[100]=input;\n}\n</code></pre>\n\n<p>What i expected was an array of characters which i can access with</p>\n\n<pre><code>if(array[6]=='2'){\n          ...\n}\n</code></pre>\n\n<p>I didnt get any errors but the code under if statements didnt run</p>\n"}, {"tags": ["c", "memory-leaks", "pthreads"], "answers": [{"comments": [{"owner": {"reputation": 501, "user_id": 4508962, "user_type": "registered", "profile_image": "https://graph.facebook.com/1257600928/picture?type=large", "display_name": "Jerem Lachkar", "link": "https://stackoverflow.com/users/4508962/jerem-lachkar"}, "edited": false, "score": 0, "creation_date": 1559776018, "post_id": 56468345, "comment_id": 99529584, "body": "Thanks that was pthread_detach() :) actually my php script contains : (1) retrieve all pending-marked notification from db and mark them as sent in db (2) send them to Apple via TCP. I want that if any of the php scripts is doing (1), a mutex in my c program blocks any new thread creation (if there are 100K pending notif to send at once, read/write operation in db can take up to 5 minutes.., and if new scripts r called from C in this case, 2 scripts can retrieve same notif and send it twice to Apple). For part (2), it\u2019s ok to let new thread creation. This behavior can be done without thread ?"}, {"owner": {"reputation": 284, "user_id": 11562467, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dVLZx.png?s=128&g=1", "display_name": "rjg", "link": "https://stackoverflow.com/users/11562467/rjg"}, "reply_to_user": {"reputation": 501, "user_id": 4508962, "user_type": "registered", "profile_image": "https://graph.facebook.com/1257600928/picture?type=large", "display_name": "Jerem Lachkar", "link": "https://stackoverflow.com/users/4508962/jerem-lachkar"}, "edited": false, "score": 0, "creation_date": 1559813065, "post_id": 56468345, "comment_id": 99539550, "body": "That depends on how you intend to check that case (1) is happening. How would you check that condition when using threads, does the php script print something to stdout? If that&#39;s the case you can use exec and use a pipe to redirect the output to your c program (take a look at how to use <code>dup2</code>). I&#39;m wondering though, why don&#39;t you extend the php script to check condition (1) periodically and poll if new notifications are pending, that would probably be the most straight forward solution."}, {"owner": {"reputation": 501, "user_id": 4508962, "user_type": "registered", "profile_image": "https://graph.facebook.com/1257600928/picture?type=large", "display_name": "Jerem Lachkar", "link": "https://stackoverflow.com/users/4508962/jerem-lachkar"}, "edited": false, "score": 0, "creation_date": 1559814945, "post_id": 56468345, "comment_id": 99540577, "body": "I wanted to use only a php script executed by cron but cron is not available to launch second-periodic tasks (minutes is the shortest unit of cron). Php script produce output but this is English more intended for developer that want to see what\u2019s going on with journalctl.. I could also produce an extra file containing one bit  (1/0) but that\u2019s not a very convinient solution.. I thought about signals, are they intended for that ? I could launch a signal from php to C parent process that continually fork to prevent it from creating any new fork until it receive a &#171; continue &#187; signal ?"}, {"owner": {"reputation": 284, "user_id": 11562467, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dVLZx.png?s=128&g=1", "display_name": "rjg", "link": "https://stackoverflow.com/users/11562467/rjg"}, "reply_to_user": {"reputation": 501, "user_id": 4508962, "user_type": "registered", "profile_image": "https://graph.facebook.com/1257600928/picture?type=large", "display_name": "Jerem Lachkar", "link": "https://stackoverflow.com/users/4508962/jerem-lachkar"}, "edited": false, "score": 0, "creation_date": 1559815674, "post_id": 56468345, "comment_id": 99540965, "body": "I feel like you&#39;re trying to solve this in a really complicated way. Why don&#39;t you extend the php script to run indefinitely and check within the php script once in a while if new data has to be processed. Then you would only need to start the script once to run in the background with something like <code>nohup php script.php &amp;</code>."}, {"owner": {"reputation": 501, "user_id": 4508962, "user_type": "registered", "profile_image": "https://graph.facebook.com/1257600928/picture?type=large", "display_name": "Jerem Lachkar", "link": "https://stackoverflow.com/users/4508962/jerem-lachkar"}, "edited": false, "score": 0, "creation_date": 1559816418, "post_id": 56468345, "comment_id": 99541367, "body": "I wanted to make my push notification able to send a important amount of notification at once, sometimes. Sending like 100K notifications to Apple via TCP can take about 15 min. Meanwhile, new pending notif can come, and I need to send them immediately, so I need to poll db and create new TCP con every single second even if there is another process currently sending a important amount of other notif. That\u2019s why I created this complicated solution but I\u2019m not very used to all this (system programming) so if you have better solution for this flexible purpose I would really appreciate"}, {"owner": {"reputation": 284, "user_id": 11562467, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dVLZx.png?s=128&g=1", "display_name": "rjg", "link": "https://stackoverflow.com/users/11562467/rjg"}, "reply_to_user": {"reputation": 501, "user_id": 4508962, "user_type": "registered", "profile_image": "https://graph.facebook.com/1257600928/picture?type=large", "display_name": "Jerem Lachkar", "link": "https://stackoverflow.com/users/4508962/jerem-lachkar"}, "edited": false, "score": 0, "creation_date": 1559817048, "post_id": 56468345, "comment_id": 99541680, "body": "Creating new TCP connections for every push notification shouldn&#39;t speed up anything, in fact you&#39;re creating a lot of unnecessary round trips. Is there any particular reason why you can&#39;t keep a single TCP connection open and send the notification through that one instead of creating a new one every time?"}, {"owner": {"reputation": 501, "user_id": 4508962, "user_type": "registered", "profile_image": "https://graph.facebook.com/1257600928/picture?type=large", "display_name": "Jerem Lachkar", "link": "https://stackoverflow.com/users/4508962/jerem-lachkar"}, "edited": false, "score": 0, "creation_date": 1559817733, "post_id": 56468345, "comment_id": 99542015, "body": "I create a new tcp con for each script, but one script holds all new pending notif that were pushed to db the last second, and mark them as &#171; sending &#187; in db so the following script doesn\u2019t take them to send. Actually that\u2019s true maybe I could keep the same tcp con for each poll, but what I really need is that, if a script discover new 100k notif to send to all users for exemple at 12am (let\u2019s say an ad notif not important), if a user sends a message at 12.01am, this notif much more important must be delivered in real time (I can\u2019t wait that all the ad notif are sent before sending new notif)"}, {"owner": {"reputation": 501, "user_id": 4508962, "user_type": "registered", "profile_image": "https://graph.facebook.com/1257600928/picture?type=large", "display_name": "Jerem Lachkar", "link": "https://stackoverflow.com/users/4508962/jerem-lachkar"}, "edited": false, "score": 0, "creation_date": 1559817980, "post_id": 56468345, "comment_id": 99542175, "body": "That\u2019s why I did these parallel tcp con, because I can send big groups of notif to Apple at once, while keeping sending new notification that would occur meanwhile. If I only have one tcp con all notifs are fifo queued and if I send 100k ad notif to Apple, &#171; new message &#187; notif much more important coming after would have to wait until all ad notif are sent.."}, {"owner": {"reputation": 284, "user_id": 11562467, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dVLZx.png?s=128&g=1", "display_name": "rjg", "link": "https://stackoverflow.com/users/11562467/rjg"}, "reply_to_user": {"reputation": 501, "user_id": 4508962, "user_type": "registered", "profile_image": "https://graph.facebook.com/1257600928/picture?type=large", "display_name": "Jerem Lachkar", "link": "https://stackoverflow.com/users/4508962/jerem-lachkar"}, "edited": false, "score": 0, "creation_date": 1559818181, "post_id": 56468345, "comment_id": 99542297, "body": "Ok there are two problem. 1) Currently your performance is bad because you call the script every second and create new TCP connections. Instead modify the script, call it once, keep the TCP connection open and poll the DB frequently for the low priority messages within the script. 2) You need to prioritize notifications. You could either use a datastructure that allows to insert them in front of the message queue of notifs you&#39;re trying to send and use the very same TCP connection and polling mechanism or have a separate script only handling the high priority notifs on a separate connection."}, {"owner": {"reputation": 501, "user_id": 4508962, "user_type": "registered", "profile_image": "https://graph.facebook.com/1257600928/picture?type=large", "display_name": "Jerem Lachkar", "link": "https://stackoverflow.com/users/4508962/jerem-lachkar"}, "edited": false, "score": 0, "creation_date": 1559819007, "post_id": 56468345, "comment_id": 99542703, "body": "Ok the solution of polling while sending and put high priority notif in front of queue looks good, but how can I poll while sending ? Let\u2019s say a poll find 100k notif, it will take time to send them through TCP, and as php is procedural it will block my poll loop. so maybe I need to create one other PHP thread to poll every second and have the notif queue shared between the &#171; sending thread &#187; and the &#171; polling thread &#187; ?"}, {"owner": {"reputation": 284, "user_id": 11562467, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dVLZx.png?s=128&g=1", "display_name": "rjg", "link": "https://stackoverflow.com/users/11562467/rjg"}, "reply_to_user": {"reputation": 501, "user_id": 4508962, "user_type": "registered", "profile_image": "https://graph.facebook.com/1257600928/picture?type=large", "display_name": "Jerem Lachkar", "link": "https://stackoverflow.com/users/4508962/jerem-lachkar"}, "edited": false, "score": 0, "creation_date": 1559819376, "post_id": 56468345, "comment_id": 99542900, "body": "I&#39;m not very familiar with PHP it&#39;s probably best to post another question for this. You can certainly create an event loop that alternates between sending a single (or small group of) notification(s) and checking the db. If you can write an actual multithreaded PHP script (<a href=\"https://stackoverflow.com/questions/70855/how-can-one-use-multi-threading-in-php-applications\" title=\"how can one use multi threading in php applications\">stackoverflow.com/questions/70855/&hellip;</a>) then indeed you could create one thread for polling that fills the queue and on thread for sending that takes notifications from the queue (producer-consumer pattern)."}, {"owner": {"reputation": 501, "user_id": 4508962, "user_type": "registered", "profile_image": "https://graph.facebook.com/1257600928/picture?type=large", "display_name": "Jerem Lachkar", "link": "https://stackoverflow.com/users/4508962/jerem-lachkar"}, "edited": false, "score": 0, "creation_date": 1559821545, "post_id": 56468345, "comment_id": 99544077, "body": "I will try to implement that this afternoon yes :) And create a discution about that on Stackverflow. thank you for all your answer!!"}], "tags": [], "owner": {"reputation": 284, "user_id": 11562467, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dVLZx.png?s=128&g=1", "display_name": "rjg", "link": "https://stackoverflow.com/users/11562467/rjg"}, "is_accepted": true, "score": 4, "last_activity_date": 1559771309, "last_edit_date": 1559771309, "creation_date": 1559770552, "answer_id": 56468345, "question_id": 56468176, "link": "https://stackoverflow.com/questions/56468176/c-program-causes-memory-leak/56468345#56468345", "title": "C program causes memory leak?", "body": "<p>You aren't calling <a href=\"http://man7.org/linux/man-pages/man3/pthread_join.3.html\" rel=\"nofollow noreferrer\"><code>pthread_join()</code></a> nor use <a href=\"http://man7.org/linux/man-pages/man3/pthread_detach.3.html\" rel=\"nofollow noreferrer\"><code>pthread_detach()</code></a>, so the resources allocated for the thread aren't freed. Namely each thread has it's own stack, which is probably what causes the rising memory consumption.</p>\n\n<p>Some remarks about your implementation: Since you plan on executing a PHP script with <code>system()</code> and don't actually need to work on shared variables or file descriptors, it's better to use <code>fork()</code> and one of the variants of <code>exec()</code>. This will spawn a new process without the intermediate step of creating a thread. It's also not recommended to use <code>system()</code> because it often allows to exploit the program when the input isn't properly sanitized. In this case it might be fine, if you only call it manually.</p>\n"}], "owner": {"reputation": 501, "user_id": 4508962, "user_type": "registered", "profile_image": "https://graph.facebook.com/1257600928/picture?type=large", "display_name": "Jerem Lachkar", "link": "https://stackoverflow.com/users/4508962/jerem-lachkar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 56468345, "answer_count": 1, "score": 2, "last_activity_date": 1580269352, "creation_date": 1559769637, "last_edit_date": 1580269352, "question_id": 56468176, "link": "https://stackoverflow.com/questions/56468176/c-program-causes-memory-leak", "title": "C program causes memory leak?", "body": "<p>I use that very simple C program to execute a system call to php each second, in order to run a php script that sends pending push notification in my database to APNS (Apple notification service). </p>\n\n<p>Anyway, this program causes a memory overflow after about 10 hours, so I reduced sleep time between thread creation from 1s to 10000us, and I could see in real time with <code>htop</code> that memory were increasing without never lower. Here is the program : </p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;pthread.h&gt;\n#include &lt;unistd.h&gt;\n\ntypedef struct {\n    char* script_path ;\n} arg_for_script ;\n\nstatic void *start_instance(void *_args)\n{\n    int id = abs(pthread_self());\n    arg_for_script* args = _args ;\n\n    printf(\"[SERVICE] start php script on thread %d\\n\",id);\n    fflush(stdout);\n    char cmd[200] ;\n\n    sprintf(cmd, \"php -f %s %d\", args-&gt;script_path, id );\n\n    system(cmd);\n\n    printf(\"[SERVICE] end of script on thread %d\\n\", id);\n    fflush(stdout);\n\n\n\n    pthread_exit(NULL);\n}\n\nint main(int argc, char* argv[])\n{\n\n\n    if(argc &lt; 2)\n    {\n        fprintf(stderr, \"[SERVICE] Path of php notification script must be filled\\n\");\n        fflush(stderr);\n        return EXIT_FAILURE;\n    }\n\n    arg_for_script args ;\n\n    args.script_path = argv[1];\n\n    pthread_attr_t tattr ;\n    struct sched_param param;\n    param.sched_priority = 1 ;\n\n    pthread_attr_init(&amp;tattr);\n\n    pthread_attr_setinheritsched(&amp;tattr, PTHREAD_EXPLICIT_SCHED);\n    pthread_attr_setschedpolicy(&amp;tattr, SCHED_FIFO);\n    pthread_attr_setschedparam(&amp;tattr, &amp;param);\n\n\n\n    while(1) {\n        pthread_t thrd;\n\n      //  if(pthread_create(&amp;thrd, &amp;tattr, start_instance, (void *)&amp;args) == -1) {\n        if(pthread_create(&amp;thrd, NULL, start_instance, (void *)&amp;args) == -1)\n        {\n            fprintf(stderr, \"[SERVICE] Unable to create thread\\n\");\n            fflush(stderr);\n            return EXIT_FAILURE;\n        }\n\n        usleep( 10000);\n    }\n\n  //  pthread_attr_destroy(&amp;tattr);\n    return EXIT_SUCCESS ;\n\n}\n</code></pre>\n\n<p>Here, I don't dynamically allocate any RAM with <code>malloc</code>. Why would this program increases memory usage ? What pointer should I <code>free</code> here ? </p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1559768978, "post_id": 56468044, "comment_id": 99527549, "body": "Of course there is an error and it is unrelated to <code>foo</code> but your <code>#include</code> line at the very least."}, {"owner": {"reputation": 90101, "user_id": 2509, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/79ed928ca8b1ab9a637720bf0fb20732?s=128&d=identicon&r=PG&f=1", "display_name": "dmckee --- ex-moderator kitten", "link": "https://stackoverflow.com/users/2509/dmckee-ex-moderator-kitten"}, "edited": false, "score": 1, "creation_date": 1559769076, "post_id": 56468044, "comment_id": 99527595, "body": "<i>&quot;//it showed compile time error.&quot;</i> What error? Compilers give non-trivial diagnostic output, debugging is easier when you read it."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1559769586, "post_id": 56468044, "comment_id": 99527786, "body": "You&#39;re actually lucky that your code doesn&#39;t build, because you would otherwise dereference an invalid pointer and have <i>undefined behavior</i>. See <a href=\"https://stackoverflow.com/questions/6441218/can-a-local-variables-memory-be-accessed-outside-its-scope\">Can a local variable&#39;s memory be accessed outside its scope?</a> for details."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1559772987, "post_id": 56468044, "comment_id": 99528929, "body": "Is your question as in the title, or rather about why the code does not compile?  They appear to be two different and unrelated questions.  The argument type <code>int *const *</code> <i>pointer-to-const-pointer-to-int</i> takes some thinking about, but is valid."}, {"owner": {"reputation": 3, "user_id": 10748096, "user_type": "registered", "profile_image": "https://graph.facebook.com/991785957675941/picture?type=large", "display_name": "Jaya Pandey", "link": "https://stackoverflow.com/users/10748096/jaya-pandey"}, "edited": false, "score": 0, "creation_date": 1559821390, "post_id": 56468044, "comment_id": 99543988, "body": "Initially &quot; int *const * &quot; seemed to be the reason of error. I want to know, why the code didn&#39;t compile?"}], "answers": [{"tags": [], "owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "is_accepted": true, "score": 4, "last_activity_date": 1559769174, "creation_date": 1559769174, "answer_id": 56468094, "question_id": 56468044, "link": "https://stackoverflow.com/questions/56468044/does-anything-like-void-fooint-const-p-really-exist/56468094#56468094", "title": "does anything like &quot;void foo(int *const *p) &quot;really exist?", "body": "<blockquote>\n<pre><code>int *const *p\n</code></pre>\n</blockquote>\n\n<p><code>p</code> is a pointer to a <strong>constant</strong> pointer to <code>int</code>.</p>\n\n<p>You can change <code>p</code> itself;<br>\nYou cannot change <code>*p</code>;<br>\nYou can change <code>**p</code>.</p>\n\n<pre><code>void foo(int *const *p) \n{ int j = 10;\n*p = &amp;j; // nope\nprintf(\"%d \", **p);\n}\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user9643348"}, "is_accepted": false, "score": 1, "last_activity_date": 1559769471, "creation_date": 1559769471, "answer_id": 56468141, "question_id": 56468044, "link": "https://stackoverflow.com/questions/56468044/does-anything-like-void-fooint-const-p-really-exist/56468141#56468141", "title": "does anything like &quot;void foo(int *const *p) &quot;really exist?", "body": "<p>In your code you defined the method after calling it, so you should place it before <code>main()</code></p>\n"}], "owner": {"reputation": 3, "user_id": 10748096, "user_type": "registered", "profile_image": "https://graph.facebook.com/991785957675941/picture?type=large", "display_name": "Jaya Pandey", "link": "https://stackoverflow.com/users/10748096/jaya-pandey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 1, "accepted_answer_id": 56468094, "answer_count": 2, "score": -2, "last_activity_date": 1559803186, "creation_date": 1559768897, "last_edit_date": 1559803186, "question_id": 56468044, "link": "https://stackoverflow.com/questions/56468044/does-anything-like-void-fooint-const-p-really-exist", "title": "does anything like &quot;void foo(int *const *p) &quot;really exist?", "body": "<pre><code>#include&lt;stdio.h&gt;\nint main() \n{ \nint i = 11; \nint *p = &amp;i; \nfoo(&amp;p); \nprintf(\"%d \", *p);\n} \nvoid foo(int *const *p) \n{ int j = 10;\n*p = &amp;j;\nprintf(\"%d \", **p);\n} \n</code></pre>\n\n<p>//it showed compile time error. Can anyone please explain</p>\n"}, {"tags": ["c", "assembly", "x86", "sse", "avx"], "comments": [{"owner": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "edited": false, "score": 3, "creation_date": 1559832158, "post_id": 56467971, "comment_id": 99550332, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/37313982/select-spans-of-set-bits-in-a-bitmask-that-overlap-with-a-1-bit-in-a-selector-bi\">Select spans of set bits in a bitmask that overlap with a 1-bit in a selector bitmap</a>"}, {"owner": {"reputation": 40613, "user_id": 4099593, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zweIW.png?s=128&g=1", "display_name": "Bhargav Rao", "link": "https://stackoverflow.com/users/4099593/bhargav-rao"}, "edited": false, "score": 0, "creation_date": 1559872052, "post_id": 56467971, "comment_id": 99563789, "body": "Comments are not for extended discussion; this conversation has been <a href=\"https://chat.stackoverflow.com/rooms/194570/discussion-on-question-by-muusbolla-fastest-way-to-expand-bits-in-a-field-to-all\">moved to chat</a>."}], "answers": [{"comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1559826886, "post_id": 56477252, "comment_id": 99547070, "body": "You can isolate the lowest set bit in fewer operations, just <code>(-n) &amp; n</code>.  x86 BMI1 has an instruction for that (which compilers know how to use when optimizing that expression): <a href=\"https://www.felixcloutier.com/x86/blsi\" rel=\"nofollow noreferrer\"><code>blsi</code></a>.  Single-cycle latency on Intel CPUs, 2 uops / 2 cycle latency on AMD Ryzen.  (Down from 3 for <code>mov</code> / <code>neg</code> / <code>and</code> without BMI1).  BMI1 <code>andn</code> (and not) also implement <code>(~d) &amp; a</code>, so again super helpful here."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1559828879, "post_id": 56477252, "comment_id": 99548409, "body": "Or <i>if</i> the mask groups can avoid crossing 64-bit boundaries, this can vectorize with SSE2 or AVX2 like the OP was hoping, using <code>(v)paddq</code> for the <code>-n</code> and <code>a+c</code> operations to clear the lowest group.  (And then the run time scales with the number of groups per element, not total.)"}, {"owner": {"reputation": 8984, "user_id": 2485966, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dZj6A.jpg?s=128&g=1", "display_name": "Ruud Helderman", "link": "https://stackoverflow.com/users/2485966/ruud-helderman"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1559836826, "post_id": 56477252, "comment_id": 99552885, "body": "@PeterCordes I updated my answer according to your comment. Thanks, very clever!"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1559837074, "post_id": 56477252, "comment_id": 99552995, "body": "Heh, I only know that there&#39;s a trick for lowest-set isolate because of the BMI1 instruction set.  When I want to remember the bithack for it, I look up the Operation section of <a href=\"https://www.felixcloutier.com/x86/blsi\" rel=\"nofollow noreferrer\"><code>blsi</code></a>, Bit Lowest Set Isolate. :P  I can normally remember the BLSR Bit Lowest Set: Reset trick <code>n &amp; (n-1)</code> though; that&#39;s certainly the more well-known and easier to grok one."}, {"owner": {"reputation": 537, "user_id": 100443, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/32235212517ca884dea1aa8d17a9d8af?s=128&d=identicon&r=PG", "display_name": "muusbolla", "link": "https://stackoverflow.com/users/100443/muusbolla"}, "edited": false, "score": 1, "creation_date": 1560221367, "post_id": 56477252, "comment_id": 99654247, "body": "MSVC with /O2 and /arch:AVX2 does generate blsi and andn for those parts of this algorithm."}, {"owner": {"reputation": 8984, "user_id": 2485966, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dZj6A.jpg?s=128&g=1", "display_name": "Ruud Helderman", "link": "https://stackoverflow.com/users/2485966/ruud-helderman"}, "edited": false, "score": 0, "creation_date": 1560247883, "post_id": 56477252, "comment_id": 99664275, "body": "So Microsoft did their homework on this one. Thank you for the follow-up!"}], "tags": [], "owner": {"reputation": 8984, "user_id": 2485966, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dZj6A.jpg?s=128&g=1", "display_name": "Ruud Helderman", "link": "https://stackoverflow.com/users/2485966/ruud-helderman"}, "is_accepted": false, "score": 8, "last_activity_date": 1559909145, "last_edit_date": 1559909145, "creation_date": 1559822754, "answer_id": 56477252, "question_id": 56467971, "link": "https://stackoverflow.com/questions/56467971/fastest-way-to-expand-bits-in-a-field-to-all-overlapping-adjacent-set-bits-i/56477252#56477252", "title": "Fastest way to expand bits in a field to all (overlapping + adjacent) set bits in a mask?", "body": "<p>The following approach needs only a single loop, with the number of iterations equal to the number of 'groups' found.\nI don't know if it will be more efficient than your approach; there's 6 arith/bitwise operations in each iteration.</p>\n\n<p>In pseudo code (C-like):</p>\n\n<pre><code>OUT = 0;\na = MASK;\nwhile (a)\n{\n    e = a &amp; ~(a + (a &amp; (-a)));\n    if (e &amp; IN) OUT |= e;\n    a ^= e;\n}\n</code></pre>\n\n<p>Here's how it works, step by step, using 11010111 as an example mask:</p>\n\n<pre><code>OUT = 0\n\na = MASK        11010111\nc = a &amp; (-a)    00000001   keeps rightmost one only\nd = a + c       11011000   clears rightmost group (and set the bit to its immediate left)\ne = a &amp; ~d      00000111   keeps rightmost group only\n\nif (e &amp; IN) OUT |= e;      adds group to OUT\n\na = a ^ e       11010000   clears rightmost group, so we can proceed with the next group\nc = a &amp; (-a)    00010000\nd = a + c       11100000\ne = a &amp; ~d      00010000\n\nif (e &amp; IN) OUT |= e;\n\na = a ^ e       11000000\nc = a &amp; (-a)    01000000\nd = a + c       00000000   (ignoring carry when adding)\ne = a &amp; ~d      11000000\n\nif (e &amp; IN) OUT |= e;\n\na = a ^ e       00000000   done\n</code></pre>\n\n<p>As pointed out @PeterCordes, some operations could be optimized using x86 BMI1 instructions:</p>\n\n<ul>\n<li><code>c = a &amp; (-a)</code>: <a href=\"https://www.felixcloutier.com/x86/blsi\" rel=\"nofollow noreferrer\">blsi</a></li>\n<li><code>e = a &amp; ~d</code>: <a href=\"https://www.felixcloutier.com/x86/andn\" rel=\"nofollow noreferrer\">andn</a></li>\n</ul>\n\n<p>This approach is good for processor architectures that do not support bitwise reversal. On architectures that do have a dedicated instruction to reverse the order of bits in an integer, <a href=\"https://stackoverflow.com/a/56478996/\">wim's answer</a> is more efficient.</p>\n"}, {"comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1559829053, "post_id": 56478996, "comment_id": 99548519, "body": "Too bad there isn&#39;t a <code>pavgq</code>, only <a href=\"https://www.felixcloutier.com/x86/pavgb:pavgw\" rel=\"nofollow noreferrer\"><code>pavgb&#47;w</code></a>"}, {"owner": {"reputation": 3352, "user_id": 2439725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/428ff617402eb64c48ed6dfc153617f9?s=128&d=identicon&r=PG", "display_name": "wim", "link": "https://stackoverflow.com/users/2439725/wim"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1559829555, "post_id": 56478996, "comment_id": 99548839, "body": "@PeterCordes: Right. Although the rounding behavior of <code>pavgb&#47;w</code> is different from the one used here. In general I would prefer <code>average = (a &#47; 2) + (b &#47; 2) + (a &amp; b &amp; 1)</code>."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1559829884, "post_id": 56478996, "comment_id": 99549032, "body": "Oh, I see, yours always rounds the average down, instead of to even with <code>(a+b+1) &gt;&gt; 1</code>.  So yours is like <code>(a+b) &gt;&gt; 1</code> with an extra bit for the sum."}, {"owner": {"reputation": 3352, "user_id": 2439725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/428ff617402eb64c48ed6dfc153617f9?s=128&d=identicon&r=PG", "display_name": "wim", "link": "https://stackoverflow.com/users/2439725/wim"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1559832912, "post_id": 56478996, "comment_id": 99550776, "body": "@PeterCordes: Yes. With two <code>uint64_t</code> as inputs it rounds down (truncates) the result. Moreover, it cannot overflow. (With <code>(a+b) &gt;&gt; 1</code> you may lose the carry bit.) Probably <code>pavgb&#47;w</code> was easier to implement by Intel as it is, or it was designed for some specific use case."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1559833176, "post_id": 56478996, "comment_id": 99550960, "body": "Given the 2 sizes available and that they date back to Pentium 3&#39;s new MMX instructions (before the SSE2 XMM versions), I think the obvious use-cases were 50/50 mixing linear PCM audio or 50/50 blending pixels.  When I wrote <code>(a+b)&gt;&gt;1</code> I was of course still talking about doing <code>a+b</code> with an extra bit of precision, like <code>pavgw</code> does.  (They document it as a 17-bit sum before the right shift, because that&#39;s the easy way to think about it when you aren&#39;t constrained by fixed-width types or registers.  But it makes it hard to describe with normal notation.)"}, {"owner": {"reputation": 3352, "user_id": 2439725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/428ff617402eb64c48ed6dfc153617f9?s=128&d=identicon&r=PG", "display_name": "wim", "link": "https://stackoverflow.com/users/2439725/wim"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1559833746, "post_id": 56478996, "comment_id": 99551255, "body": "@PeterCordes: Indeed it is quite likely that they had audio and video applications in mind with <code>pavgb&#47;w</code>, interesting."}, {"owner": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "edited": false, "score": 0, "creation_date": 1559846122, "post_id": 56478996, "comment_id": 99556854, "body": "There&#39;s also <code>(a&amp;b)+((a^b)&gt;&gt;1)</code> for the average (and for b/w, <code>~pavgb(~a, ~b)</code>)"}, {"owner": {"reputation": 8984, "user_id": 2485966, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dZj6A.jpg?s=128&g=1", "display_name": "Ruud Helderman", "link": "https://stackoverflow.com/users/2485966/ruud-helderman"}, "edited": false, "score": 0, "creation_date": 1559853666, "post_id": 56478996, "comment_id": 99559826, "body": "Being branchless and loopless, makes this the superior answer. Chapeau! My own answer is only interesting on architectures that do not have a dedicated instruction for bitwise reversal."}, {"owner": {"reputation": 3352, "user_id": 2439725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/428ff617402eb64c48ed6dfc153617f9?s=128&d=identicon&r=PG", "display_name": "wim", "link": "https://stackoverflow.com/users/2439725/wim"}, "reply_to_user": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "edited": false, "score": 0, "creation_date": 1559906983, "post_id": 56478996, "comment_id": 99575610, "body": "@harold: Nice formula, quite advanced. I had not seen it before. Thanks!"}], "tags": [], "owner": {"reputation": 3352, "user_id": 2439725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/428ff617402eb64c48ed6dfc153617f9?s=128&d=identicon&r=PG", "display_name": "wim", "link": "https://stackoverflow.com/users/2439725/wim"}, "is_accepted": true, "score": 8, "last_activity_date": 1559910390, "last_edit_date": 1559910390, "creation_date": 1559828876, "answer_id": 56478996, "question_id": 56467971, "link": "https://stackoverflow.com/questions/56467971/fastest-way-to-expand-bits-in-a-field-to-all-overlapping-adjacent-set-bits-i/56478996#56478996", "title": "Fastest way to expand bits in a field to all (overlapping + adjacent) set bits in a mask?", "body": "<p>I guess @fuz comment was on the right track.\nThe following example shows how the SSE and AVX2 code below works.\nThe algorithm starts with <code>IN_reduced = IN &amp; MASK</code> because we are not interested \nin <code>IN</code> bits at positions where <code>MASK</code> is <code>0</code>. </p>\n\n<pre class=\"lang-none prettyprint-override\"><code>IN                                  = . . . 0 0 0 0 . . . . p q r s . . .\nMASK                                = . . 0 1 1 1 1 0 . . 0 1 1 1 1 0 . . \nIN_reduced = IN &amp; MASK              = . . 0 0 0 0 0 0 . . 0 p q r s 0 . .\n</code></pre>\n\n<p>If any of the <code>p q r s</code> bits is <code>1</code>, then <code>IN_reduced + MASK</code> has a carry bit <code>1</code> \nat position <code>X</code>, which is right left to the \nrequested contiguous bits.</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>MASK                                = . . 0 1 1 1 1 0 . . 0 1 1 1 1 0 . . \nIN_reduced                          = . . 0 0 0 0 0 0 . . 0 p q r s 0 . .\nIN_reduced + MASK                   = . . 0 1 1 1 1 . . . 1 . . . . . .\n                                                          X\n(IN_reduced + MASK) &gt;&gt;1             = . . . 0 1 1 1 1 . . . 1 . . . . . .\n</code></pre>\n\n<p>With <code>&gt;&gt; 1</code> this carry bit <code>1</code> is shifted to the same column as bit <code>p</code> \n(the first bit of the contiguous bits).\nNow, <code>(IN_reduced + MASK) &gt;&gt;1</code> is actually an average of <code>IN_reduced</code> and <code>MASK</code>. \nIn order to avoid possible overflow of addition we use the following\naverage: <code>avg(a, b) = (a &amp; b) + ((a ^ b) &gt;&gt; 1)</code> (See @Harold's comment,\nsee also <a href=\"https://stackoverflow.com/a/14884757\">here</a> and <a href=\"https://stackoverflow.com/a/10470235\">here</a>.)\nWith <code>average = avg(IN_reduced, MASK)</code> we get</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>MASK                                = . . 0 1 1 1 1 0 . . 0 1 1 1 1 0 . . \nIN_reduced                          = . . 0 0 0 0 0 0 . . 0 p q r s 0 . .\naverage                             = . . . 0 1 1 1 1 . . . 1 . . . . . .\nMASK &gt;&gt; 1                           = . . . 0 1 1 1 1 0 . . 0 1 1 1 1 0 .  \nleading_bits = (~(MASK&gt;&gt;1))&amp;average = . . . 0 0 0 0 0 . . . 1 0 0 0 0 . .  \n</code></pre>\n\n<p>We can isolate the leading carry bits with\n<code>leading_bits = (~(MASK&gt;&gt;1) ) &amp; average</code> because <code>MASK&gt;&gt;1</code> is zero at the positions \nof the carry bits \nthat we are interested in. </p>\n\n<p>With normal addition the carry propagates from right to left. Here we use a\nreverse addition: with a carry from left to right.\nReverse adding <code>MASK</code> and <code>leading_bits</code>: \n<code>rev_added = bit_swap(bit_swap(MASK) + bit_swap(leading_bits))</code>,\nThis zeros the bits at \nthe wanted positions.\nWith <code>OUT = (~rev_added) &amp; MASK</code> we get the result.</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>MASK                                = . . 0 1 1 1 1 0 . . 0 1 1 1 1 0 . . \nleading_bits                        = . . . 0 0 0 0 0 . . . 1 0 0 0 0 . .  \nrev_added (MASK,leading_bits)       = . . . 1 1 1 1 0 . . . 0 0 0 0 1 . .\nOUT = ~rev_added &amp; MASK             = . . 0 0 0 0 0 0 . . . 1 1 1 1 0 . .\n</code></pre>\n\n<p>The algorithm was not thoroughly tested, but the output looks ok.</p>\n\n<hr/>\n\n<p>The code block below contains two separate codes:\nThe upper half is the SSE code, \nand the lower half is the AVX2 code. \n(In order to avoid \nbloating the answer too much with two large code blocks.) \nThe SSE algorithm works with 2 x 64-bit elements and the AVX2 version works with 4 x 64-bit elements. </p>\n\n<p>With gcc 9.1, the algorithm <a href=\"https://godbolt.org/z/KWeNzc\" rel=\"nofollow noreferrer\">compiles to about 29 instructions</a>,\naside from 4 <code>vmovdqa</code>-s for loading some constants, which are likely \nhoisted out of the loop in a real world application (after inlining).\nThese 29 instructions are a good mix of  9 shuffles (<code>vpshufb</code>) that execute \non port 5 (p5) on Intel Skylake, and many other instructions that often may \nexecute on p0, p1 or p5. </p>\n\n<p>Therefore, a performance of about 3 instructions per cycle might be possible. \nIn that case the throughput would be about 1 function call (inlined) \nper 10 cycles. In the AVX2 case this means 4 <code>uint64_t</code> <code>OUT</code> results per \nabout 10 cycles.</p>\n\n<p>Note that the performance is independent of the data(!), which is a great \nbenefit of this answer I think. The solution is branchless, and loopless, and\ncannot suffer from failing branch prediction.</p>\n\n<p><br/></p>\n\n<pre class=\"lang-c prettyprint-override\"><code>/*  gcc -O3 -m64 -Wall -march=skylake select_bits.c    */\n#include &lt;immintrin.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdint.h&gt;\n\nint print_sse_128_bin(__m128i x);\n__m128i bit_128_k(unsigned int k);\n__m128i mm_bitreverse_epi64(__m128i x);\n__m128i mm_revadd_epi64(__m128i x, __m128i y);\n\n\n/* Select specific pieces of contiguous bits from `MASK` based on selector `IN`  */\n__m128i mm_select_bits_epi64(__m128i IN, __m128i MASK){\n    __m128i IN_reduced   = _mm_and_si128(IN, MASK);\n    /* Compute the average of IN_reduced and MASK with avg(a,b)=(a&amp;b)+((a^b)&gt;&gt;1)  */\n    /* (IN_reduced &amp; MASK) + ((IN_reduced ^ MASK) &gt;&gt;1) =                          */\n    /* ((IN &amp; MASK) &amp; MASK) + ((IN_reduced ^ MASK) &gt;&gt;1) =                         */\n    /* IN_reduced + ((IN_reduced ^ MASK) &gt;&gt;1)                                     */\n    __m128i tmp          = _mm_xor_si128(IN_reduced, MASK);\n    __m128i tmp_div2     = _mm_srli_epi64(tmp, 1);\n    __m128i average      = _mm_add_epi64(IN_reduced, tmp_div2);   /* average is the average */\n    __m128i MASK_div2    = _mm_srli_epi64(MASK, 1);\n    __m128i leading_bits = _mm_andnot_si128(MASK_div2, average);\n    __m128i rev_added    = mm_revadd_epi64(MASK, leading_bits);\n    __m128i OUT          = _mm_andnot_si128(rev_added, MASK);\n    /* Uncomment the next lines to check the arithmetic */ /*   \n    printf(\"IN           \");print_sse_128_bin(IN           );       \n    printf(\"MASK         \");print_sse_128_bin(MASK         ); \n    printf(\"IN_reduced   \");print_sse_128_bin(IN_reduced   );       \n    printf(\"tmp          \");print_sse_128_bin(tmp          );       \n    printf(\"tmp_div2     \");print_sse_128_bin(tmp_div2     );       \n    printf(\"average      \");print_sse_128_bin(average      );       \n    printf(\"MASK_div2    \");print_sse_128_bin(MASK_div2    );       \n    printf(\"leading_bits \");print_sse_128_bin(leading_bits );       \n    printf(\"rev_added    \");print_sse_128_bin(rev_added    );       \n    printf(\"OUT          \");print_sse_128_bin(OUT          );       \n    printf(\"\\n\");*/\n    return OUT;       \n}\n\n\nint main(){\n    __m128i IN   = _mm_set_epi64x(0b11111110011010110, 0b1100010010010100);\n    __m128i MASK = _mm_set_epi64x(0b01011011001111110, 0b0001111010111011);\n    __m128i OUT;    \n\n    printf(\"Example 1 \\n\");\n    OUT = mm_select_bits_epi64(IN, MASK);\n    printf(\"IN           \");print_sse_128_bin(IN);\n    printf(\"MASK         \");print_sse_128_bin(MASK);\n    printf(\"OUT          \");print_sse_128_bin(OUT);\n    printf(\"\\n\\n\");\n\n                      /*  0b7654321076543210765432107654321076543210765432107654321076543210  */\n    IN   = _mm_set_epi64x(0b1000001001001010000010000000100000010000000000100000000111100011, \n                          0b11111110011010111);\n    MASK = _mm_set_epi64x(0b1110011110101110111111000000000111011111101101111100011111000001, \n                          0b01011011001111111);\n\n    printf(\"Example 2 \\n\");\n    OUT = mm_select_bits_epi64(IN, MASK);\n    printf(\"IN           \");print_sse_128_bin(IN);\n    printf(\"MASK         \");print_sse_128_bin(MASK);\n    printf(\"OUT          \");print_sse_128_bin(OUT);\n    printf(\"\\n\\n\");\n\n    return 0;\n}\n\n\nint print_sse_128_bin(__m128i x){\n    for (int i = 127; i &gt;= 0; i--){\n        printf(\"%1u\", _mm_testnzc_si128(bit_128_k(i), x));\n        if (((i &amp; 7) == 0) &amp;&amp; (i &gt; 0)) printf(\" \");\n    }\n    printf(\"\\n\");\n    return 0;\n}\n\n\n/* From my answer here https://stackoverflow.com/a/39595704/2439725, adapted to 128-bit */\ninline __m128i bit_128_k(unsigned int k){\n  __m128i  indices     = _mm_set_epi32(96, 64, 32, 0);\n  __m128i  one         = _mm_set1_epi32(1);\n\n  __m128i  kvec        = _mm_set1_epi32(k);  \n  __m128i  shiftcounts = _mm_sub_epi32(kvec, indices);\n  __m128i  kbit        = _mm_sllv_epi32(one, shiftcounts);   \n  return kbit;                             \n}\n\n\n/* Copied from Harold's answer https://stackoverflow.com/a/46318399/2439725         */\n/* Adapted to epi64 and __m128i: bit reverse two 64 bit elements                    */\ninline __m128i mm_bitreverse_epi64(__m128i x){\n    __m128i shufbytes = _mm_setr_epi8(7, 6, 5, 4, 3, 2, 1, 0, 15, 14, 13, 12, 11, 10, 9, 8); \n    __m128i luthigh = _mm_setr_epi8(0, 8, 4, 12, 2, 10, 6, 14, 1, 9, 5, 13, 3, 11, 7, 15);\n    __m128i lutlow = _mm_slli_epi16(luthigh, 4);\n    __m128i lowmask = _mm_set1_epi8(15);\n    __m128i rbytes = _mm_shuffle_epi8(x, shufbytes);\n    __m128i high = _mm_shuffle_epi8(lutlow, _mm_and_si128(rbytes, lowmask));\n    __m128i low = _mm_shuffle_epi8(luthigh, _mm_and_si128(_mm_srli_epi16(rbytes, 4), lowmask));\n    return _mm_or_si128(low, high);\n}\n\n\n/* Add in the reverse direction: With a carry from left to */\n/* right, instead of right to left                         */\ninline __m128i mm_revadd_epi64(__m128i x, __m128i y){\n    x = mm_bitreverse_epi64(x);\n    y = mm_bitreverse_epi64(y);\n    __m128i sum = _mm_add_epi64(x, y);\n    return mm_bitreverse_epi64(sum);\n}\n/* End of SSE code */\n\n\n/************* AVX2 code starts here ********************************************/\n\n/*  gcc -O3 -m64 -Wall -march=skylake select_bits256.c    */\n#include &lt;immintrin.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdint.h&gt;\n\nint print_avx_256_bin(__m256i x);\n__m256i bit_256_k(unsigned int k);\n__m256i mm256_bitreverse_epi64(__m256i x);\n__m256i mm256_revadd_epi64(__m256i x, __m256i y);\n\n\n/* Select specific pieces of contiguous bits from `MASK` based on selector `IN`  */\n__m256i mm256_select_bits_epi64(__m256i IN, __m256i MASK){\n    __m256i IN_reduced   = _mm256_and_si256(IN, MASK);\n    /* Compute the average of IN_reduced and MASK with avg(a,b)=(a&amp;b)+((a^b)&gt;&gt;1)  */\n    /* (IN_reduced &amp; MASK) + ((IN_reduced ^ MASK) &gt;&gt;1) =                          */\n    /* ((IN &amp; MASK) &amp; MASK) + ((IN_reduced ^ MASK) &gt;&gt;1) =                         */\n    /* IN_reduced + ((IN_reduced ^ MASK) &gt;&gt;1)                                     */\n    __m256i tmp          = _mm256_xor_si256(IN_reduced, MASK);\n    __m256i tmp_div2     = _mm256_srli_epi64(tmp, 1);\n    __m256i average      = _mm256_add_epi64(IN_reduced, tmp_div2);   /* average is the average */\n    __m256i MASK_div2    = _mm256_srli_epi64(MASK, 1);\n    __m256i leading_bits = _mm256_andnot_si256(MASK_div2, average);\n    __m256i rev_added    = mm256_revadd_epi64(MASK, leading_bits);\n    __m256i OUT          = _mm256_andnot_si256(rev_added, MASK);\n    /* Uncomment the next lines to check the arithmetic */ /*   \n    printf(\"IN           \");print_avx_256_bin(IN           );       \n    printf(\"MASK         \");print_avx_256_bin(MASK         ); \n    printf(\"IN_reduced   \");print_avx_256_bin(IN_reduced   );       \n    printf(\"tmp          \");print_avx_256_bin(tmp          );       \n    printf(\"tmp_div2     \");print_avx_256_bin(tmp_div2     );       \n    printf(\"average      \");print_avx_256_bin(average      );       \n    printf(\"MASK_div2    \");print_avx_256_bin(MASK_div2    );       \n    printf(\"leading_bits \");print_avx_256_bin(leading_bits );       \n    printf(\"rev_added    \");print_avx_256_bin(rev_added    );       \n    printf(\"OUT          \");print_avx_256_bin(OUT          );       \n    printf(\"\\n\");*/\n    return OUT;       \n}\n\n\nint main(){\n    __m256i IN   = _mm256_set_epi64x(0b11111110011010110, \n                                     0b1100010010010100,\n                                     0b1000001001001010000010000000100000010000000000100000000111100011, \n                                     0b11111110011010111\n    );\n    __m256i MASK = _mm256_set_epi64x(0b01011011001111110, \n                                     0b0001111010111011,\n                                     0b1110011110101110111111000000000111011111101101111100011111000001, \n                                     0b01011011001111111);\n    __m256i OUT;    \n\n    printf(\"Example \\n\");\n    OUT = mm256_select_bits_epi64(IN, MASK);\n    printf(\"IN           \");print_avx_256_bin(IN);\n    printf(\"MASK         \");print_avx_256_bin(MASK);\n    printf(\"OUT          \");print_avx_256_bin(OUT);\n    printf(\"\\n\");\n\n    return 0;\n}\n\n\nint print_avx_256_bin(__m256i x){\n    for (int i=255;i&gt;=0;i--){\n        printf(\"%1u\",_mm256_testnzc_si256(bit_256_k(i),x));\n        if (((i&amp;7) ==0)&amp;&amp;(i&gt;0)) printf(\" \");\n    }\n    printf(\"\\n\");\n    return 0;\n}\n\n\n/* From my answer here https://stackoverflow.com/a/39595704/2439725 */\ninline __m256i bit_256_k(unsigned int k){\n  __m256i  indices     = _mm256_set_epi32(224,192,160,128,96,64,32,0);\n  __m256i  one         = _mm256_set1_epi32(1);\n\n  __m256i  kvec        = _mm256_set1_epi32(k);  \n  __m256i  shiftcounts = _mm256_sub_epi32(kvec, indices);\n  __m256i  kbit        = _mm256_sllv_epi32(one, shiftcounts);   \n  return kbit;                             \n}\n\n\n/* Copied from Harold's answer https://stackoverflow.com/a/46318399/2439725         */\n/* Adapted to epi64: bit reverse four 64 bit elements                    */\ninline __m256i mm256_bitreverse_epi64(__m256i x){\n    __m256i shufbytes = _mm256_setr_epi8(7, 6, 5, 4, 3, 2, 1, 0, 15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 0, 15, 14, 13, 12, 11, 10, 9, 8);\n    __m256i luthigh = _mm256_setr_epi8(0, 8, 4, 12, 2, 10, 6, 14, 1, 9, 5, 13, 3, 11, 7, 15, 0, 8, 4, 12, 2, 10, 6, 14, 1, 9, 5, 13, 3, 11, 7, 15);\n    __m256i lutlow = _mm256_slli_epi16(luthigh, 4);\n    __m256i lowmask = _mm256_set1_epi8(15);\n    __m256i rbytes = _mm256_shuffle_epi8(x, shufbytes);\n    __m256i high = _mm256_shuffle_epi8(lutlow, _mm256_and_si256(rbytes, lowmask));\n    __m256i low = _mm256_shuffle_epi8(luthigh, _mm256_and_si256(_mm256_srli_epi16(rbytes, 4), lowmask));\n    return _mm256_or_si256(low, high);\n}\n\n\n/* Add in the reverse direction: With a carry from left to */\n/* right, instead of right to left                         */\ninline __m256i mm256_revadd_epi64(__m256i x, __m256i y){\n    x = mm256_bitreverse_epi64(x);\n    y = mm256_bitreverse_epi64(y);\n    __m256i sum = _mm256_add_epi64(x, y);\n    return mm256_bitreverse_epi64(sum);\n}\n</code></pre>\n\n<p><br/></p>\n\n<p>Output of the SSE code with an uncommented debugging section:</p>\n\n<pre><code>Example 1 \nIN           00000000 00000000 00000000 00000000 00000000 00000001 11111100 11010110 00000000 00000000 00000000 00000000 00000000 00000000 11000100 10010100\nMASK         00000000 00000000 00000000 00000000 00000000 00000000 10110110 01111110 00000000 00000000 00000000 00000000 00000000 00000000 00011110 10111011\nIN_reduced   00000000 00000000 00000000 00000000 00000000 00000000 10110100 01010110 00000000 00000000 00000000 00000000 00000000 00000000 00000100 10010000\ntmp          00000000 00000000 00000000 00000000 00000000 00000000 00000010 00101000 00000000 00000000 00000000 00000000 00000000 00000000 00011010 00101011\ntmp_div2     00000000 00000000 00000000 00000000 00000000 00000000 00000001 00010100 00000000 00000000 00000000 00000000 00000000 00000000 00001101 00010101\naverage      00000000 00000000 00000000 00000000 00000000 00000000 10110101 01101010 00000000 00000000 00000000 00000000 00000000 00000000 00010001 10100101\nMASK_div2    00000000 00000000 00000000 00000000 00000000 00000000 01011011 00111111 00000000 00000000 00000000 00000000 00000000 00000000 00001111 01011101\nleading_bits 00000000 00000000 00000000 00000000 00000000 00000000 10100100 01000000 00000000 00000000 00000000 00000000 00000000 00000000 00010000 10100000\nrev_added    00000000 00000000 00000000 00000000 00000000 00000000 01001001 00000001 00000000 00000000 00000000 00000000 00000000 00000000 00000001 01000111\nOUT          00000000 00000000 00000000 00000000 00000000 00000000 10110110 01111110 00000000 00000000 00000000 00000000 00000000 00000000 00011110 10111000\n\nIN           00000000 00000000 00000000 00000000 00000000 00000001 11111100 11010110 00000000 00000000 00000000 00000000 00000000 00000000 11000100 10010100\nMASK         00000000 00000000 00000000 00000000 00000000 00000000 10110110 01111110 00000000 00000000 00000000 00000000 00000000 00000000 00011110 10111011\nOUT          00000000 00000000 00000000 00000000 00000000 00000000 10110110 01111110 00000000 00000000 00000000 00000000 00000000 00000000 00011110 10111000\n\n\nExample 2 \nIN           10000010 01001010 00001000 00001000 00010000 00000010 00000001 11100011 00000000 00000000 00000000 00000000 00000000 00000001 11111100 11010111\nMASK         11100111 10101110 11111100 00000001 11011111 10110111 11000111 11000001 00000000 00000000 00000000 00000000 00000000 00000000 10110110 01111111\nIN_reduced   10000010 00001010 00001000 00000000 00010000 00000010 00000001 11000001 00000000 00000000 00000000 00000000 00000000 00000000 10110100 01010111\ntmp          01100101 10100100 11110100 00000001 11001111 10110101 11000110 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000010 00101000\ntmp_div2     00110010 11010010 01111010 00000000 11100111 11011010 11100011 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000001 00010100\naverage      10110100 11011100 10000010 00000000 11110111 11011100 11100100 11000001 00000000 00000000 00000000 00000000 00000000 00000000 10110101 01101011\nMASK_div2    01110011 11010111 01111110 00000000 11101111 11011011 11100011 11100000 00000000 00000000 00000000 00000000 00000000 00000000 01011011 00111111\nleading_bits 10000100 00001000 10000000 00000000 00010000 00000100 00000100 00000001 00000000 00000000 00000000 00000000 00000000 00000000 10100100 01000000\nrev_added    00010000 01100001 00000010 00000001 11000000 01110000 00100000 00100000 00000000 00000000 00000000 00000000 00000000 00000000 01001001 00000000\nOUT          11100111 10001110 11111100 00000000 00011111 10000111 11000111 11000001 00000000 00000000 00000000 00000000 00000000 00000000 10110110 01111111\n\nIN           10000010 01001010 00001000 00001000 00010000 00000010 00000001 11100011 00000000 00000000 00000000 00000000 00000000 00000001 11111100 11010111\nMASK         11100111 10101110 11111100 00000001 11011111 10110111 11000111 11000001 00000000 00000000 00000000 00000000 00000000 00000000 10110110 01111111\nOUT          11100111 10001110 11111100 00000000 00011111 10000111 11000111 11000001 00000000 00000000 00000000 00000000 00000000 00000000 10110110 01111111\n</code></pre>\n"}], "owner": {"reputation": 537, "user_id": 100443, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/32235212517ca884dea1aa8d17a9d8af?s=128&d=identicon&r=PG", "display_name": "muusbolla", "link": "https://stackoverflow.com/users/100443/muusbolla"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 375, "favorite_count": 2, "accepted_answer_id": 56478996, "answer_count": 2, "score": 12, "last_activity_date": 1559910390, "creation_date": 1559768574, "last_edit_date": 1559772084, "question_id": 56467971, "link": "https://stackoverflow.com/questions/56467971/fastest-way-to-expand-bits-in-a-field-to-all-overlapping-adjacent-set-bits-i", "title": "Fastest way to expand bits in a field to all (overlapping + adjacent) set bits in a mask?", "body": "<p>Say I have 2 binary inputs named IN and MASK. Actual field size could be 32 to 256 bits depending on what instruction set is used to accomplish the task. Both inputs change every call.</p>\n\n<pre><code>Inputs:\nIN   = ...1100010010010100...\nMASK = ...0001111010111011...\nOutput:\nOUT  = ...0001111010111000...\n</code></pre>\n\n<p>edit: another example result from some comment discussion</p>\n\n<pre><code>IN   = ...11111110011010110...\nMASK = ...01011011001111110...\nOutput:\nOUT  = ...01011011001111110...\n</code></pre>\n\n<p>I want to get the contiguous adjacent 1 bits of MASK that a 1 bit of IN is within. (Is there a general term for this kind of operation? Maybe I'm not phrasing my searches properly.) I'm trying to find a way to do this that is a bit faster. I'm open to using any x86 or x86 SIMD extensions that can get this done in minimum cpu cycles. A wider data type SIMD is preferred as it will allow me to process more data at once.</p>\n\n<p>The best naive solution I've come up with is the following pseudocode, which manually shifts left until there are no more matching bits, then repeats shifting right:</p>\n\n<pre><code>// (using the variables above)\ntestL = testR = OUT = (IN &amp; MASK);\n\nLoopL:\ntestL = (testL &lt;&lt; 1) &amp; MASK;\nif (testL != 0) {\n    OUT = OUT | testL;\n    goto LoopL;\n}\n\nLoopR:\ntestR = (testR &gt;&gt; 1) &amp; MASK;\nif (testR != 0) {\n    OUT = OUT | testR;\n    goto LoopR;\n}\n\nreturn OUT;\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 2, "creation_date": 1559767660, "post_id": 56467763, "comment_id": 99527082, "body": "Shouldn&#39;t <code>&#39;n&#39;</code> be <code>&#39;\\n&#39;</code>, although the absence of the letter <code>n</code> in a text file is an oddity in itself."}, {"owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "edited": false, "score": 1, "creation_date": 1559767668, "post_id": 56467763, "comment_id": 99527083, "body": "You are counting the occurrences of the character <code>&#39;n&#39;</code>, not <code>&#39;\\n&#39;</code> which is the escape sequence for a line break"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1559767755, "post_id": 56467763, "comment_id": 99527122, "body": "@EricPostpischil: I would have answered if I was confident this was the <i>only</i> issue."}, {"owner": {"reputation": 61, "user_id": 11421862, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-EqThchVQMkA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfn5w8m9qWDvZCFQnQBbJCnDu_S0w/mo/photo.jpg?sz=128", "display_name": "Christina", "link": "https://stackoverflow.com/users/11421862/christina"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1559768001, "post_id": 56467763, "comment_id": 99527206, "body": "@Bathsheba: sorry that was a typo! I fixed it but my function still returns 0."}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1559768404, "post_id": 56467763, "comment_id": 99527346, "body": "@Christina are you sure you was able to open the file ? print an error if <i>fp</i> is NULL, currently there is no check about that"}, {"owner": {"reputation": 61, "user_id": 11421862, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-EqThchVQMkA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfn5w8m9qWDvZCFQnQBbJCnDu_S0w/mo/photo.jpg?sz=128", "display_name": "Christina", "link": "https://stackoverflow.com/users/11421862/christina"}, "reply_to_user": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1559769130, "post_id": 56467763, "comment_id": 99527619, "body": "@bruno I do check for that in my validate_input() function in main()."}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1559770093, "post_id": 56467763, "comment_id": 99527973, "body": "@Christina so I suppose you <code>exit(&lt;n&gt;)</code> in case of error because, again, you get the result of <code>validate_input</code> as a FILE * without visible test and continue the execution"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1559773336, "post_id": 56467763, "comment_id": 99529028, "body": "\u201cNothing is returned\u201d does not make sense. A function that has a non-void return type returns a value, unless it terminates its execution in an abnormal way (such as program execute or a <code>longjmp</code>, neither of which appears in the source code). Do you mean nothing is printed? In any case, this is a different question, so, if you want to ask it, you should post it as a new question, with a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 61, "user_id": 11421862, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-EqThchVQMkA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfn5w8m9qWDvZCFQnQBbJCnDu_S0w/mo/photo.jpg?sz=128", "display_name": "Christina", "link": "https://stackoverflow.com/users/11421862/christina"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1559775719, "post_id": 56467763, "comment_id": 99529532, "body": "@EricPostpischil Thank you for letting me know! I will post it as another question."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1559796692, "post_id": 56467763, "comment_id": 99532983, "body": "Christina is the file consisted of only 3 characters <code>&quot;abc&quot;</code>, would you consider that a file of 1 or 0 lines?"}], "answers": [{"tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": true, "score": 3, "last_activity_date": 1559768105, "last_edit_date": 1559768105, "creation_date": 1559767996, "answer_id": 56467849, "question_id": 56467763, "link": "https://stackoverflow.com/questions/56467763/how-to-count-number-of-lines-in-a-file-in-c/56467849#56467849", "title": "How to count number of lines in a file in C?", "body": "<p><code>ftell</code> reports the current position in the file. For a file that has just been opened, the position is the start, and <code>ftell</code> returns zero. Then, since <code>size</code> is zero, the loop in <code>findnum_lines</code> processes zero characters and reports no lines were found.</p>\n\n<p>Generally, you do not want to get the file size and then loop on that. One reason is that the file can change while you read it\u2014other processes may write more data to it or may truncate it. Another reason is that it is unnecessary. Just read characters until you get <code>EOF</code>, using a <code>while</code> loop (or a <code>do \u2026 while</code> loop).</p>\n\n<p>Additionally, <code>char line;</code> should be <code>int line;</code> because it is used to hold the result of <code>getc</code>, which may be either a character or <code>EOF</code>, and a <code>char</code> is inadequate to hold <code>EOF</code>. (Also, <code>getc</code> returns the character\u2019s value as an <code>unsigned char</code> converted to an <code>int</code>, so, in an implementation where <code>char</code> is signed, <code>char</code> cannot even properly represent all characters.)</p>\n"}, {"tags": [], "owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "is_accepted": false, "score": 1, "last_activity_date": 1559768001, "creation_date": 1559768001, "answer_id": 56467851, "question_id": 56467763, "link": "https://stackoverflow.com/questions/56467763/how-to-count-number-of-lines-in-a-file-in-c/56467851#56467851", "title": "How to count number of lines in a file in C?", "body": "<p>One problem is the call to <code>ftell()</code> is done with the file offset still at zero:</p>\n\n<pre><code>int findnum_lines(FILE* fp){\n\n  int num_lines = 0;\n  int line; // changed char to int\n  int size;\n\n  size = ftell(fp);\n  line = getc(fp);\n  if(size != 0){\n    while(line != EOF){\n      if(line == '\\n'){\n        num_lines = num_lines + 1;\n      }\n      line = getc(fp);\n    }\n  } else {\n    num_lines = 0;\n  }\n  printf(\"%d\", num_lines);\n  return num_lines;\n}\n</code></pre>\n\n<p>If <code>findnum_lines()</code> is called right after the file is opened, the file's current offset returned by <code>ftell()</code> will be at the start of the file - or zero.</p>\n\n<p>So <code>num_lines</code> is set to zero, and zero is returned.</p>\n\n<p>Note that checking the file size is not needed - since you're counting newline characters - <code>'\\n'</code> - a zero length file will have zero newline characters in it to count.</p>\n"}], "owner": {"reputation": 61, "user_id": 11421862, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-EqThchVQMkA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfn5w8m9qWDvZCFQnQBbJCnDu_S0w/mo/photo.jpg?sz=128", "display_name": "Christina", "link": "https://stackoverflow.com/users/11421862/christina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "accepted_answer_id": 56467849, "answer_count": 2, "score": 1, "last_activity_date": 1559775625, "creation_date": 1559767512, "last_edit_date": 1559775625, "question_id": 56467763, "link": "https://stackoverflow.com/questions/56467763/how-to-count-number-of-lines-in-a-file-in-c", "title": "How to count number of lines in a file in C?", "body": "<p>I have a function that is supposed to count the number of lines in a file inputted by the user.  However, whenever I input a file my function keeps returning 0 lines.</p>\n\n<pre><code>int findnum_lines(FILE* fp){\n\n  int num_lines = 0;\n  char line;\n  int size;\n\n  size = ftell(fp);\n  line = getc(fp);\n  if(size != 0){\n    while(line != EOF){\n      if(line == '\\n'){\n        num_lines = num_lines + 1;\n      }\n      line = getc(fp);\n    }\n  } else {\n    num_lines = 0;\n  }\n  printf(\"%d\", num_lines);\n  return num_lines;\n}\n\nint main(int argc, char* argv[]){\n    char** lines = NULL;\n    int num_lines = 0;\n    FILE* fp = validate_input(argc, argv);\n\n    num_lines = findnum_lines(fp);\n    read_lines(fp, &amp;lines, &amp;num_lines);\n    print_lines(lines, num_lines);\n    free_lines(lines, num_lines);\n    fclose(fp);\n\n    return 0;\n}\n</code></pre>\n\n<p>My example file is:</p>\n\n<pre><code>Hello Class\nThis is what I would call a normal file\nIt isn't very special\nBut it still is important\n</code></pre>\n\n<p>So my function should return 4 lines, not 0.</p>\n\n<p>UPDATED:</p>\n\n<pre><code>int findnum_lines(FILE* fp){\n\n  int num_lines = 0;\n  int line;\n\n  line = getc(fp);\n\n  while(line != EOF){\n    if(line == '\\n'){\n      num_lines = num_lines + 1;\n      }\n    line = getc(fp);\n    }\n  printf(\"%d\", num_lines);\n  return num_lines;\n}\n\nint main(int argc, char* argv[]){\n    char** lines = NULL;\n    int num_lines = 0;\n    FILE* fp = validate_input(argc, argv);\n\n    num_lines = findnum_lines(fp);\n    read_lines(fp, &amp;lines, &amp;num_lines);\n    print_lines(lines, num_lines);\n    free_lines(lines, num_lines);\n    fclose(fp);\n\n    return 0;\n}\n</code></pre>\n\n<p>With this updated code no num_lines is printed.</p>\n"}, {"tags": ["c", "compilation", "linker", "linker-errors"], "owner": {"reputation": 131, "user_id": 1012863, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f4fd5509633dabfeb6dbfbc9fdeb394?s=128&d=identicon&r=PG", "display_name": "corning", "link": "https://stackoverflow.com/users/1012863/corning"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1559766164, "creation_date": 1559766164, "question_id": 56467483, "link": "https://stackoverflow.com/questions/56467483/error-lnk2001-unresolved-external-symbol-clock", "title": "error LNK2001: unresolved external symbol clock()", "body": "<p>I have added #include  in component.c file and created variables with  clock_t type and clock(), which is compiling successfully.</p>\n\n<pre><code>clock_t start_t, end_t, total_t;\nstart_t = clock();\n</code></pre>\n\n<p>When i build the driver file(.sys) there is a linker which tries to find clock() but it cannot find and throws error.</p>\n\n<p>component.lib(comp.obj) : error LNK2001: unresolved external symbol clock\ndriver.sys : fatal error LNK1120: 1 unresolved externals</p>\n\n<p>I have tried reading other solutions for similar linker error.\nMost of them has mentioned about Microsoft visual c++ compiler.</p>\n\n<pre><code>clock_t start_t, end_t, total_t;\nstart_t = clock();\n</code></pre>\n\n<p>I have tried adding extern in the component.c file. But it doesn't help.</p>\n\n<pre><code>extern clock(void);\n</code></pre>\n"}, {"tags": ["c", "linux", "serial-port"], "answers": [{"tags": [], "owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "is_accepted": false, "score": 0, "last_activity_date": 1559767103, "last_edit_date": 1592644375, "creation_date": 1559767103, "answer_id": 56467679, "question_id": 56467422, "link": "https://stackoverflow.com/questions/56467422/is-there-a-way-to-set-minimum-characters-per-read-using-fcntl/56467679#56467679", "title": "Is there a way to set minimum characters per read using fcntl()?", "body": "<p>Assuming you mean <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/read.html\" rel=\"nofollow noreferrer\">the POSIX <code>ssize_t read(int fildes, void *buf, size_t nbyte)</code></a>, no.  There is no standard way to set a minimum number of bytes to be <code>read()</code>. (I can't rule out some implementations providing the capability, but I'm not aware of any, nor for the reasons to follow do I see a point in providing such a capability to <code>read()</code> in general.)</p>\n<p>And for a very good reason:  what happens if the bytes run out before the number requested is met?  The other end of the pipe gets closed, the socket you're reading from gets shut down, or you hit the end of the file you're reading from before reaching the requested number of bytes.</p>\n<p>What should <code>read()</code> do then?  Block forever waiting for bytes that either might never or can never arrive?  In that case, the only sensible action is for <code>read()</code> to return the number of bytes that have been read.</p>\n<p>So in general you must handle partial <code>read()</code> results anyway, making the &quot;read a minimum number of bytes&quot; setting pointless.</p>\n"}, {"comments": [{"owner": {"reputation": 305, "user_id": 6268413, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/df85b09ddfc4573596aa796a052a1173?s=128&d=identicon&r=PG&f=1", "display_name": "Arun Kuttiyara Varghese", "link": "https://stackoverflow.com/users/6268413/arun-kuttiyara-varghese"}, "edited": false, "score": 0, "creation_date": 1559830544, "post_id": 56474079, "comment_id": 99549431, "body": "I realized that I can not use fcntl() to set VMIn and VTIME. So the alternative option is termios and it works. Thanks."}], "tags": [], "owner": {"reputation": 13673, "user_id": 1599004, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df9d2a02744f666e97375e05fdc54255?s=128&d=identicon&r=PG", "display_name": "sawdust", "link": "https://stackoverflow.com/users/1599004/sawdust"}, "is_accepted": true, "score": 2, "last_activity_date": 1559812999, "last_edit_date": 1559812999, "creation_date": 1559811247, "answer_id": 56474079, "question_id": 56467422, "link": "https://stackoverflow.com/questions/56467422/is-there-a-way-to-set-minimum-characters-per-read-using-fcntl/56474079#56474079", "title": "Is there a way to set minimum characters per read using fcntl()?", "body": "<blockquote>\n  <p>In Linux command <code>stty</code> we can set the N characters minimum for a completed read using the option min. </p>\n  \n  <p>Is there a way to set these options [ min and time] using fcntl() or any C API's.</p>\n</blockquote>\n\n<p>The <code>stty</code> command is merely a command that accesses the termios interface (of a serial terminal).<br>\nProgrammatically you can use <strong>tcgetattr()</strong> and <strong>tcsetattr()</strong>.  </p>\n\n<p>See <a href=\"http://www.chemie.fu-berlin.de/chemnet/use/info/libc/libc_12.html#SEC237\" rel=\"nofollow noreferrer\">Setting Terminal Modes Properly</a>\nand <a href=\"http://www.cmrr.umn.edu/~strupp/serial.html\" rel=\"nofollow noreferrer\">Serial Programming Guide for POSIX Operating Systems</a></p>\n\n<hr>\n\n<p>Sample C code that sets the deciseconds and minimum-count for a raw read of an open serial terminal:  </p>\n\n<pre><code>int set_time_and_min(int fd, int time, int min)\n{\n  struct termios settings;\n  int result;\n\n  result = tcgetattr(fd, &amp;settings);\n  if (result &lt; 0) {\n      perror(\"error in tcgetattr\");\n      return -1;\n  }\n  settings.c_cc[VTIME] = time;\n  settings.c_cc[VMIN] = min;\n  result = tcsetattr(fd, TCSANOW, &amp;settings);\n  if (result &lt; 0) {\n      perror(\"error in tcsetattr\");\n      return -2;\n  }\n  return 0;\n}\n</code></pre>\n\n<hr>\n\n<blockquote>\n  <p>I checked the fcntl() and open() man , but couldn't find a matching flag. </p>\n</blockquote>\n\n<p>The man page to reference is termios(3).</p>\n\n<hr>\n\n<p>Of course the VMIN and VTIME values are only effective when using blocking noncanonical I/O.  See <a href=\"https://stackoverflow.com/questions/25996171/linux-blocking-vs-non-blocking-serial-read/26006680#26006680\">Linux Blocking vs. non Blocking Serial Read</a></p>\n"}], "owner": {"reputation": 305, "user_id": 6268413, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/df85b09ddfc4573596aa796a052a1173?s=128&d=identicon&r=PG&f=1", "display_name": "Arun Kuttiyara Varghese", "link": "https://stackoverflow.com/users/6268413/arun-kuttiyara-varghese"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 0, "accepted_answer_id": 56474079, "answer_count": 2, "score": 1, "last_activity_date": 1559812999, "creation_date": 1559765907, "last_edit_date": 1559771272, "question_id": 56467422, "link": "https://stackoverflow.com/questions/56467422/is-there-a-way-to-set-minimum-characters-per-read-using-fcntl", "title": "Is there a way to set minimum characters per read using fcntl()?", "body": "<p>In Linux command <code>stty</code> we can set the N characters minimum for a completed read using the option <code>min</code>.</p>\n\n<p>From stty man </p>\n\n<pre><code>min N\n    with -icanon, set N characters minimum for a completed read \ntime N\n    with -icanon, set read timeout of N tenths of a second\n</code></pre>\n\n<p>Is there a way to set these options [ <code>min</code> and <code>time</code>] using <code>fcntl()</code> or any <code>C</code> <code>API</code>'s. I checked the <code>fcntl()</code> and <code>open()</code> man , but couldn't find a matching flag.  </p>\n"}, {"tags": ["c++", "c", "pointers"], "comments": [{"owner": {"reputation": 91345, "user_id": 481267, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/DMvoo.png?s=128&g=1", "display_name": "Brian Bi", "link": "https://stackoverflow.com/users/481267/brian-bi"}, "edited": false, "score": 0, "creation_date": 1559761282, "post_id": 56466498, "comment_id": 99524420, "body": "That code shouldn&#39;t compile. The line <code>int *p=&amp;a;</code> is not correctly typed."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 1, "creation_date": 1559761388, "post_id": 56466498, "comment_id": 99524460, "body": "If you want to print a pointer, you need format specifier <code>%p</code>, otherwise you invoke undefined behaviour. Until fixed, <i>anything</i> could happen..."}, {"owner": {"reputation": 33, "user_id": 10852641, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Q_0Ee9_ZX-k/AAAAAAAAAAI/AAAAAAAAARA/WG9XqlOP9-Y/photo.jpg?sz=128", "display_name": "gokul goku", "link": "https://stackoverflow.com/users/10852641/gokul-goku"}, "reply_to_user": {"reputation": 91345, "user_id": 481267, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/DMvoo.png?s=128&g=1", "display_name": "Brian Bi", "link": "https://stackoverflow.com/users/481267/brian-bi"}, "edited": false, "score": 0, "creation_date": 1559761500, "post_id": 56466498, "comment_id": 99524501, "body": "the code is giving me the following output ...it runs  @Brian"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1559761542, "post_id": 56466498, "comment_id": 99524518, "body": "<code>int *p=a;</code> Why? <code>&amp;a</code> is a <i>pointer-to-int</i> <code>[5]</code>, not <i>pointer-to-int</i>. See: <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.3.2.1p3\" rel=\"nofollow noreferrer\">C11 Standard - 6.3.2.1 Other Operands - Lvalues, arrays, and function designators(p3)</a>"}, {"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "edited": false, "score": 4, "creation_date": 1559761572, "post_id": 56466498, "comment_id": 99524530, "body": "@gokulgoku: just because it runs with no <i>apparent</i> errors doesn&#39;t mean it&#39;s correct. You should have gotten at least a couple of warnings."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1559761644, "post_id": 56466498, "comment_id": 99524564, "body": "Still it contains undefined behaviour. On modern systems, it is pretty likely that pointer size is larger than unsigned int \u2013 so in best case, you&#39;re just cutting off part of address. In worst case, some part of the address might be interpreted as next argument. As said already, you invoke UB, anything could happen, your programme might crash, give bad output or even silently ignore and go on."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 2, "creation_date": 1559761881, "post_id": 56466498, "comment_id": 99524665, "body": "Arrays decay automatically to pointers when needed: <code>int* p = a;</code> is all you need. Taking the address of <code>a</code> results in another pointer type: <code>int(*p)[5] = &amp;a;</code> would be the correct one..."}, {"owner": {"reputation": 33, "user_id": 10852641, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Q_0Ee9_ZX-k/AAAAAAAAAAI/AAAAAAAAARA/WG9XqlOP9-Y/photo.jpg?sz=128", "display_name": "gokul goku", "link": "https://stackoverflow.com/users/10852641/gokul-goku"}, "reply_to_user": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1559761999, "post_id": 56466498, "comment_id": 99524714, "body": "@Aconcagua  i just cut off some part of the address for simplicity ...i didn&#39;t know there can some logic there too ...:)"}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1559762138, "post_id": 56466498, "comment_id": 99524786, "body": "@gokulgoku If you <i>want</i> to cut off, then do a cast: <code>printf(&quot;%u&quot;, (unsigned int)p);</code> and you are on the safe side."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1559762811, "post_id": 56466498, "comment_id": 99525055, "body": "Rolled back. Changing <code>int *p=&amp;a;</code> to <code>int *p=a;</code> defeats the comments and attempts to answer your own question."}, {"owner": {"reputation": 33, "user_id": 10852641, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Q_0Ee9_ZX-k/AAAAAAAAAAI/AAAAAAAAARA/WG9XqlOP9-Y/photo.jpg?sz=128", "display_name": "gokul goku", "link": "https://stackoverflow.com/users/10852641/gokul-goku"}, "reply_to_user": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1559763076, "post_id": 56466498, "comment_id": 99525176, "body": "@Aconcagua   thanks i got it...i have another doubt when we had 1 to &amp;a we reach to address after the end of the array ..so &amp;a+1 gives an address after the array a but why *(&amp;a+1) also give the same address"}, {"owner": {"reputation": 33, "user_id": 10852641, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Q_0Ee9_ZX-k/AAAAAAAAAAI/AAAAAAAAARA/WG9XqlOP9-Y/photo.jpg?sz=128", "display_name": "gokul goku", "link": "https://stackoverflow.com/users/10852641/gokul-goku"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1559763271, "post_id": 56466498, "comment_id": 99525235, "body": "@WeatherVane actually i wanted answer for *p=a;  .. but i didn&#39;t notice that i wrote the code wrong until i got answers related to it ....that&#39;s why i edited it"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1559764859, "post_id": 56466498, "comment_id": 99525898, "body": "See also <a href=\"https://stackoverflow.com/questions/31087537/why-does-a-b-have-the-same-behavior-as-a-b/31088592#31088592\" title=\"why does a b have the same behavior as a b\">stackoverflow.com/questions/31087537/&hellip;</a> ."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1559767806, "post_id": 56466498, "comment_id": 99527145, "body": "@gokulgoku <code>&amp;a + 1</code> results in the same address as <code>(char*)a + sizeof(a)</code>, just because this is the nature of incrementing a pointer by 1. Then with <code>&amp;a+1</code>, you get a pointer to an array of size 5. If you now dereference this pointer, you get (as the array decays!) a pointer to this arrays&#39; first element. But the address of the array itself and the address of its first element are always the same (similarly as in C \u2013 but not in C++ \u2013 the first member of a struct has always the same address as the struct itself)."}, {"owner": {"reputation": 12572, "user_id": 8534008, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8f2af9937cac66f08b6ee6e4219cc0d?s=128&d=identicon&r=PG&f=1", "display_name": "GBlodgett", "link": "https://stackoverflow.com/users/8534008/gblodgett"}, "edited": false, "score": 0, "creation_date": 1559775314, "post_id": 56466498, "comment_id": 99529458, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/4445706/post-increment-and-pre-increment-concept\">Post-increment and Pre-increment concept?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 10852641, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Q_0Ee9_ZX-k/AAAAAAAAAAI/AAAAAAAAARA/WG9XqlOP9-Y/photo.jpg?sz=128", "display_name": "gokul goku", "link": "https://stackoverflow.com/users/10852641/gokul-goku"}, "edited": false, "score": 0, "creation_date": 1559761668, "post_id": 56466533, "comment_id": 99524576, "body": "even if i change it to int *p=a;   why am i getting the same output?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 33, "user_id": 10852641, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Q_0Ee9_ZX-k/AAAAAAAAAAI/AAAAAAAAARA/WG9XqlOP9-Y/photo.jpg?sz=128", "display_name": "gokul goku", "link": "https://stackoverflow.com/users/10852641/gokul-goku"}, "edited": false, "score": 0, "creation_date": 1559761806, "post_id": 56466533, "comment_id": 99524632, "body": "@gokulgoku Added a paragraph in the answer explaining it."}, {"owner": {"reputation": 33, "user_id": 10852641, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Q_0Ee9_ZX-k/AAAAAAAAAAI/AAAAAAAAARA/WG9XqlOP9-Y/photo.jpg?sz=128", "display_name": "gokul goku", "link": "https://stackoverflow.com/users/10852641/gokul-goku"}, "edited": false, "score": 0, "creation_date": 1559762828, "post_id": 56466533, "comment_id": 99525064, "body": "thanks i got it...i have another doubt when we had 1 to &amp;a we reach to address after the end of the array ..so &amp;a+1 gives an address after the array a but why *(&amp;a+1) also give the same address"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 33, "user_id": 10852641, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Q_0Ee9_ZX-k/AAAAAAAAAAI/AAAAAAAAARA/WG9XqlOP9-Y/photo.jpg?sz=128", "display_name": "gokul goku", "link": "https://stackoverflow.com/users/10852641/gokul-goku"}, "edited": false, "score": 0, "creation_date": 1559763073, "post_id": 56466533, "comment_id": 99525173, "body": "@gokulgoku That&#39;s because <code>*(&amp;a + 1)</code> is equal to <code>(&amp;a)[1]</code>, and the type of that is an array (of five <code>int</code>). And as any array it <i>decay</i> to a pointer to its first element. It&#39;s the same decay that happens for <code>a</code>."}, {"owner": {"reputation": 33, "user_id": 10852641, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Q_0Ee9_ZX-k/AAAAAAAAAAI/AAAAAAAAARA/WG9XqlOP9-Y/photo.jpg?sz=128", "display_name": "gokul goku", "link": "https://stackoverflow.com/users/10852641/gokul-goku"}, "edited": false, "score": 0, "creation_date": 1559764089, "post_id": 56466533, "comment_id": 99525566, "body": "well i tried hard but i couldn&#39;t understand it can you please help me to understand it better ...thanks!!"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 33, "user_id": 10852641, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Q_0Ee9_ZX-k/AAAAAAAAAAI/AAAAAAAAARA/WG9XqlOP9-Y/photo.jpg?sz=128", "display_name": "gokul goku", "link": "https://stackoverflow.com/users/10852641/gokul-goku"}, "edited": false, "score": 0, "creation_date": 1559765072, "post_id": 56466533, "comment_id": 99525989, "body": "@gokulgoku I feel it&#39;s starting to get off-topic for this question now, but I&#39;ve updated with more information that hopefully should help you understand what&#39;s going on."}], "tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": true, "score": 4, "last_activity_date": 1559765025, "last_edit_date": 1559765025, "creation_date": 1559761290, "answer_id": 56466533, "question_id": 56466498, "link": "https://stackoverflow.com/questions/56466498/why-a-pointer-value-is-assigned-before-the-increment-operation-is-performed/56466533#56466533", "title": "why a pointer value is assigned before the increment operation is performed", "body": "<p>There seems to be some misunderstanding in how pointers and arrays work together.</p>\n\n<p>The expression <code>&amp;a</code> is a pointer to the array itself, and has the type <code>int (*)[5]</code>.</p>\n\n<p>What you seem to expect is to get a pointer to the first element, which would be <code>&amp;a[0]</code>, or plain <code>a</code> (as that decays to a pointer to the arrays first element):</p>\n\n<pre><code>int *p = a;\n</code></pre>\n\n<p>That it works is not a coincidence, because a pointer to the array just happens to point to the same address as the location of the first element. The addresses are equal, but the types of <code>&amp;a</code> and <code>&amp;a[0]</code> are different. This semantic difference really is crucial.</p>\n\n<hr>\n\n<p>Regarding the issue about the <code>++</code> operator, it's simply how it works.</p>\n\n<p>The result of the suffix increase or decrease operators is the <em>old</em> value. So when you do <code>p++</code> you get the <em>old</em> pointer, before the increase.</p>\n\n<p>If we take</p>\n\n<pre><code>i = *p++;\n</code></pre>\n\n<p>it's (somewhat simplified) equivalent to</p>\n\n<pre><code>int *temporary_old_p = p;\np = p + 1;\ni = *temporary_old_p;\n</code></pre>\n\n<hr>\n\n<p>Furthermore, the <code>\"%u\"</code> format for a pointer is invalid. To print a <code>void *</code> pointer (a cast is really needed to be correct) you should use the <code>\"%p\"</code> format specifier.</p>\n\n<p>Mismatching format-specifier and argument type leads to <em>undefined behavior</em>.</p>\n\n<hr>\n\n<p>Regarding the problem with <code>*(&amp;a + 1)</code>, lets draw the array <code>a</code> how it looks in memory, with a few arrows to show pointers:</p>\n\n<pre>\n+------+------+------+------+------+------\n| a[0] | a[1] | a[2] | a[3] | a[4] | ....\n+------+------+------+------+------+------\n^                                  ^\n|                                  |\n&a[0]                              |\n|                                  |\n&a                                 &a + 1\n</pre>\n\n<p>Since the type of <code>&amp;a</code> is <code>int (*)[5]</code>, then it follows that the type of <code>&amp;a + 1</code> should also be <code>int (*)[5]</code>.</p>\n\n<p>If we dereference the pointer <code>&amp;a</code> (as in <code>*(&amp;a)</code>) then we get the actual array <code>a</code>. Arrays, like <code>a</code>, decay to a pointer to its first element, <code>&amp;a[0]</code>. This pointer is pointing to the same location as <code>&amp;a</code> (as shown in the \"drawing\" above).</p>\n\n<p>If we change <code>&amp;a</code> to <code>&amp;a + 1</code>, then we get <code>*(&amp;a + 1)</code> in the dereference. It's the \"second\" array (is it existed). Just like <code>*(&amp;a)</code> is an array of five <code>int</code>, so is <code>*(&amp;a + 1)</code>. This array decays to a pointer to its first element <code>&amp;(*(&amp;a + 1))[0]</code>.</p>\n\n<p>Or perhaps think that <code>&amp;a</code> is equal to <code>&amp;a + 0</code>. Then it would be easy to see that <code>*(&amp;a)</code> would be equal to <code>*(&amp;a + 0)</code>. And we know that <code>*(&amp;a)</code> is equal to <code>a</code> which is equal to <code>&amp;a[0]</code>, which also means that <code>*(&amp;a + 0)</code> have to be equal to <code>&amp;(*(&amp;a + 0))[0]</code>. That should make it easy to see what <code>&amp;(*(&amp;a + 1))[0]</code> might be.</p>\n"}, {"tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": false, "score": 8, "last_activity_date": 1559761414, "creation_date": 1559761414, "answer_id": 56466555, "question_id": 56466498, "link": "https://stackoverflow.com/questions/56466498/why-a-pointer-value-is-assigned-before-the-increment-operation-is-performed/56466555#56466555", "title": "why a pointer value is assigned before the increment operation is performed", "body": "<p>The semantics of the postfix <code>++</code> operator are that the expression <code>p++</code> evaluates to the <em>current</em> value of <code>p</code>, and as a <em>side effect</em> <code>p</code> is incremented.  Effectively, <code>i = *p++;</code> is the same as</p>\n\n<pre><code>i = *p;\np++;\n</code></pre>\n\n<p>The semantics of the <em>prefix</em> <code>++</code> operator are that the expression evaluates to the current value of <code>p</code> <em>plus one</em>, and as a side effect <code>p</code> is incremented.  <code>i = *++p;</code> would effectively be the same as</p>\n\n<pre><code>i = *(p + 1);\np++;\n</code></pre>\n\n<p>Precedence <em>does not</em> control order of evaluation - it only controls parsing (which operators are grouped with which operands).  </p>\n"}], "owner": {"reputation": 33, "user_id": 10852641, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Q_0Ee9_ZX-k/AAAAAAAAAAI/AAAAAAAAARA/WG9XqlOP9-Y/photo.jpg?sz=128", "display_name": "gokul goku", "link": "https://stackoverflow.com/users/10852641/gokul-goku"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 0, "accepted_answer_id": 56466533, "answer_count": 2, "score": 0, "last_activity_date": 1559765078, "creation_date": 1559761108, "last_edit_date": 1559765078, "question_id": 56466498, "link": "https://stackoverflow.com/questions/56466498/why-a-pointer-value-is-assigned-before-the-increment-operation-is-performed", "title": "why a pointer value is assigned before the increment operation is performed", "body": "<p>Why does <code>*p++</code> first assign the value to <code>i</code> and then increment the <code>p</code> pointer, even though <code>++</code> post-increment has a higher precedence, and associativity is from Right-to-Left?</p>\n\n<pre><code>int main()\n{\n    int a[]={55,66,25,35,45};\n    int i;\n    int *p=&amp;a;\n    printf(\"%u \\n\",p);\n    i=*p++;\n    printf(\" %u  %d\",p,i);\n    printf(\"\\n %d\",*p);\n\n    return 0;\n}\n</code></pre>\n\n<pre>\n4056\n4060 55\n66\n</pre>\n"}, {"tags": ["c", "xamarin", "xamarin.android"], "answers": [{"tags": [], "owner": {"reputation": 10280, "user_id": 10504796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vqBUa.png?s=128&g=1", "display_name": "Junior Jiang", "link": "https://stackoverflow.com/users/10504796/junior-jiang"}, "is_accepted": false, "score": 0, "last_activity_date": 1559803276, "creation_date": 1559803276, "answer_id": 56472113, "question_id": 56466466, "link": "https://stackoverflow.com/questions/56466466/how-to-hide-close-softkeyboard-in-xamarin-android/56472113#56472113", "title": "How to Hide/Close SoftKeyboard in Xamarin Android?", "body": "<p><a href=\"https://docs.microsoft.com/en-us/xamarin/xamarin-forms/app-fundamentals/custom-renderer/entry#creating-the-custom-renderer-on-android\" rel=\"nofollow noreferrer\">Customizing an Entry</a> in Native android can do this:</p>\n\n<p>First, creating a <em>MyEntry</em></p>\n\n<pre><code>public class MyEntry : Entry\n{\n}\n</code></pre>\n\n<p>Second ,using in <em>Xaml</em>:</p>\n\n<pre><code>&lt;ContentPage ...\n    xmlns:local=\"clr-namespace:CustomRenderer;assembly=CustomRenderer\"\n    ...&gt;\n    ...\n    &lt;local:MyEntry Text=\"In Shared Code\" /&gt;\n    ...\n&lt;/ContentPage&gt;\n</code></pre>\n\n<p>Third, modify in Renderer on Android</p>\n\n<pre><code>using Xamarin.Forms.Platform.Android;\n\n[assembly: ExportRenderer(typeof(MyEntry), typeof(MyEntryRenderer))]\nnamespace CustomRenderer.Android\n{\n    class MyEntryRenderer : EntryRenderer\n    {\n        public MyEntryRenderer(Context context) : base(context)\n        {\n        }\n\n        protected override void OnElementChanged(ElementChangedEventArgs&lt;Entry&gt; e)\n        {\n            base.OnElementChanged(e);\n\n            if (Control != null)\n            {\n                Control.InputType = Android.Text.InputTypes.Null;\n                //Set input type be null, keyboard will never appear,even when click the Entry.If need show keyboard, this way also can be used.\n                //Control.InputType = Android.Text.InputTypes.ClassText;\n            }\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11605701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74d12e6c5002020bd9f1b4deac0e7668?s=128&d=identicon&r=PG&f=1", "display_name": "Marcelo Bittar", "link": "https://stackoverflow.com/users/11605701/marcelo-bittar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1559803276, "creation_date": 1559760970, "last_edit_date": 1559762499, "question_id": 56466466, "link": "https://stackoverflow.com/questions/56466466/how-to-hide-close-softkeyboard-in-xamarin-android", "title": "How to Hide/Close SoftKeyboard in Xamarin Android?", "body": "<p>In my program there is a standard keyboard that I use for the \"Entry\"</p>\n\n<p>However I'm testing some things and I ended up putting IsEnabled = True, but when the program goes into Focus on that Entry, the default Android Softkeyboard appears, and I do not want it to appear when I click on Entry.</p>\n\n<p>How do I not display the SoftKeyboard in Entry?</p>\n\n<pre><code>        &lt;Label Text=\"C\u00d3D VENDEDOR:\"\n               FontSize=\"Large\"\n               FontAttributes=\"Bold\"\n               TextColor=\"Black\"/&gt;\n\n        &lt;Entry Placeholder=\"000000000000000\"\n               Text=\"{Binding codVend}\"\n               Keyboard=\"numeric\"\n               MaxLength=\"15\"\n               FontSize=\"Large\"\n               FontAttributes=\"Bold\"\n               IsEnabled=\"True\"\n               TextColor=\"Black\"\n               InputTransparent=\"False\"/&gt;\n\n        &lt;Label Text=\"N L\u00d3GICO:\"\n               FontSize=\"Large\"\n               FontAttributes=\"Bold\"\n               TextColor=\"Black\"/&gt;\n\n        &lt;Entry Placeholder=\"00000000\"\n               Text=\"{Binding codTrn}\"\n               Keyboard=\"Numeric\"\n               MaxLength=\"8\"\n               IsEnabled=\"True\"\n               FontSize=\"Large\"\n               FontAttributes=\"Bold\"\n               TextColor=\"Black\"\n               InputTransparent=\"False\"/&gt;\n\n        &lt;StackLayout Padding=\"2\"\n                 HorizontalOptions=\"Center\"\n                 VerticalOptions=\"Center\"&gt;\n\n            &lt;ActivityIndicator IsVisible=\"{Binding IsBusy}\"\n                               IsRunning=\"{Binding IsBusy}\"\n                               Color=\"Blue\"/&gt;\n            &lt;!-- Place new controls here --&gt;\n\n            &lt;StackLayout HorizontalOptions=\"Center\"\n                     VerticalOptions=\"Center\"\n                     Padding=\"5\"&gt;\n\n                &lt;Grid HorizontalOptions=\"Center\"\n                  VerticalOptions=\"Center\"&gt;\n\n                    &lt;Grid.ColumnDefinitions&gt;\n                        &lt;ColumnDefinition Width=\"60\"/&gt;\n                        &lt;ColumnDefinition Width=\"60\"/&gt;\n                        &lt;ColumnDefinition Width=\"60\"/&gt;\n                        &lt;ColumnDefinition Width=\"60\"/&gt;\n                    &lt;/Grid.ColumnDefinitions&gt;\n                    &lt;!--Row 1--&gt;\n                    &lt;Button Text=\"1\"\n                        BackgroundColor=\"Blue\"\n                        TextColor=\"White\"\n                        BorderRadius=\"10\"\n                        Grid.Column=\"0\"\n                        Grid.Row=\"0\"\n                        HeightRequest=\"60\"\n                        FontSize=\"Large\"\n                        FontAttributes=\"Bold\"\n                        HorizontalOptions=\"Center\"\n                        VerticalOptions=\"Center\"\n                        Command=\"{Binding NumericCommand}\"\n                        CommandParameter=\"1\"/&gt;\n                    &lt;Button Text=\"2\"\n                        BackgroundColor=\"Blue\"\n                        TextColor=\"White\"\n                        BorderRadius=\"10\"\n                        Grid.Column=\"1\"\n                        Grid.Row=\"0\"\n                        HeightRequest=\"60\"\n                        FontSize=\"Large\"\n                        FontAttributes=\"Bold\"\n                        HorizontalOptions=\"Center\"\n                        VerticalOptions=\"Center\"\n                        Command=\"{Binding NumericCommand}\"\n                        CommandParameter=\"2\"/&gt;\n                    &lt;Button Text=\"3\"\n                        BackgroundColor=\"Blue\"\n                        TextColor=\"White\"\n                        BorderRadius=\"10\"\n                        Grid.Column=\"2\"\n                        Grid.Row=\"0\"\n                        HeightRequest=\"60\"\n                        FontSize=\"Large\"\n                        FontAttributes=\"Bold\"\n                        HorizontalOptions=\"Center\"\n                        VerticalOptions=\"Center\"\n                        Command=\"{Binding NumericCommand}\"\n                        CommandParameter=\"3\"/&gt;\n                    &lt;Button Text=\"OK\"\n                        BackgroundColor=\"Green\"\n                        TextColor=\"White\"\n                        BorderRadius=\"10\"\n                        Grid.Column=\"3\"\n                        Grid.Row=\"0\"\n                        HeightRequest=\"60\"\n                        FontSize=\"Large\"\n                        FontAttributes=\"Bold\"\n                        HorizontalOptions=\"Center\"\n                        Grid.RowSpan=\"4\"\n                        Command=\"{Binding SaveCommand}\"/&gt;\n                    &lt;!--Row 2--&gt;\n                    &lt;Button Text=\"4\"\n                        BackgroundColor=\"Blue\"\n                        TextColor=\"White\"\n                        BorderRadius=\"10\"\n                        Grid.Column=\"0\"\n                        Grid.Row=\"1\"\n                        HeightRequest=\"60\"\n                        FontSize=\"Large\"\n                        FontAttributes=\"Bold\"\n                        HorizontalOptions=\"Center\"\n                        VerticalOptions=\"Center\"\n                        Command=\"{Binding NumericCommand}\"\n                        CommandParameter=\"4\"/&gt;\n                    &lt;Button Text=\"5\"\n                        BackgroundColor=\"Blue\"\n                        TextColor=\"White\"\n                        BorderRadius=\"10\"\n                        Grid.Column=\"1\"\n                        Grid.Row=\"1\"\n                        HeightRequest=\"60\"\n                        FontSize=\"Large\"\n                        FontAttributes=\"Bold\"\n                        HorizontalOptions=\"Center\"\n                        VerticalOptions=\"Center\"\n                        Command=\"{Binding NumericCommand}\"\n                        CommandParameter=\"5\"/&gt;\n                    &lt;Button Text=\"6\"\n                        BackgroundColor=\"Blue\"\n                        TextColor=\"White\"\n                        BorderRadius=\"10\"\n                        Grid.Column=\"2\"\n                        Grid.Row=\"1\"\n                        HeightRequest=\"60\"\n                        FontSize=\"Large\"\n                        FontAttributes=\"Bold\"\n                        HorizontalOptions=\"Center\"\n                        VerticalOptions=\"Center\"\n                        Command=\"{Binding NumericCommand}\"\n                        CommandParameter=\"6\"/&gt;\n                    &lt;!--Row 3--&gt;\n                    &lt;Button Text=\"7\"\n                        BackgroundColor=\"Blue\"\n                        TextColor=\"White\"\n                        BorderRadius=\"10\"\n                        Grid.Column=\"0\"\n                        Grid.Row=\"2\"\n                        HeightRequest=\"60\"\n                        FontSize=\"Large\"\n                        FontAttributes=\"Bold\"\n                        HorizontalOptions=\"Center\"\n                        VerticalOptions=\"Center\"\n                        Command=\"{Binding NumericCommand}\"\n                        CommandParameter=\"7\"/&gt;\n                    &lt;Button Text=\"8\"\n                        BackgroundColor=\"Blue\"\n                        TextColor=\"White\"\n                        BorderRadius=\"10\"\n                        Grid.Column=\"1\"\n                        Grid.Row=\"2\"\n                        HeightRequest=\"60\"\n                        FontSize=\"Large\"\n                        FontAttributes=\"Bold\"\n                        HorizontalOptions=\"Center\"\n                        VerticalOptions=\"Center\"\n                        Command=\"{Binding NumericCommand}\"\n                        CommandParameter=\"8\"/&gt;\n                    &lt;Button Text=\"9\"\n                        BackgroundColor=\"Blue\"\n                        TextColor=\"White\"\n                        BorderRadius=\"10\"\n                        Grid.Column=\"2\"\n                        Grid.Row=\"2\"\n                        HeightRequest=\"60\"\n                        FontSize=\"Large\"\n                        FontAttributes=\"Bold\"\n                        HorizontalOptions=\"Center\"\n                        VerticalOptions=\"Center\"\n                        Command=\"{Binding NumericCommand}\"\n                        CommandParameter=\"9\"/&gt;\n                    &lt;!--Row 4--&gt;\n                    &lt;Button Text=\"X\"\n                        BackgroundColor=\"Red\"\n                        TextColor=\"White\"\n                        BorderRadius=\"10\"\n                        Grid.Column=\"0\"\n                        Grid.Row=\"3\"\n                        HeightRequest=\"60\"\n                        FontSize=\"Large\"\n                        FontAttributes=\"Bold\"\n                        HorizontalOptions=\"Center\"\n                        VerticalOptions=\"Center\"\n                        Command=\"{Binding ClearAllCommand}\"/&gt;\n                    &lt;Button Text=\"0\"\n                        BackgroundColor=\"Blue\"\n                        TextColor=\"White\"\n                        BorderRadius=\"10\"\n                        Grid.Column=\"1\"\n                        Grid.Row=\"3\"\n                        HeightRequest=\"60\"\n                        FontSize=\"Large\"\n                        FontAttributes=\"Bold\"\n                        VerticalOptions=\"Center\"\n                        Command=\"{Binding NumericCommand}\"\n                        CommandParameter=\"0\"/&gt;\n                    &lt;Button Text=\"C\"\n                        BackgroundColor=\"Yellow\"\n                        TextColor=\"White\"\n                        BorderRadius=\"10\"\n                        Grid.Column=\"2\"\n                        Grid.Row=\"3\"\n                        HeightRequest=\"60\"\n                        FontSize=\"Large\"\n                        FontAttributes=\"Bold\"\n                        HorizontalOptions=\"Center\"\n                        Command=\"{Binding ClearCommand}\"/&gt;\n                &lt;/Grid&gt;\n            &lt;/StackLayout&gt;\n        &lt;/StackLayout&gt;\n    &lt;/StackLayout&gt;\n&lt;/ContentPage.Content&gt;\n</code></pre>\n\n<p></p>\n"}, {"tags": ["c++", "c", "eclipse", "eclipse-cdt", "stdio"], "comments": [{"owner": {"reputation": 6058, "user_id": 3871028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfbe44ff5c56628e85683c8918602c96?s=128&d=identicon&r=PG&f=1", "display_name": "Ripi2", "link": "https://stackoverflow.com/users/3871028/ripi2"}, "edited": false, "score": 0, "creation_date": 1559760157, "post_id": 56466264, "comment_id": 99523926, "body": "Look into the folder where the compiler is installed. Then, add that folder to Eclipse &quot;include list&quot;."}, {"owner": {"reputation": 191, "user_id": 11369664, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-j3pOKhSdLp4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfz0reuFZPBqvHnAgjvTXcWBoIr2A/mo/photo.jpg?sz=128", "display_name": "George Xavier", "link": "https://stackoverflow.com/users/11369664/george-xavier"}, "reply_to_user": {"reputation": 6058, "user_id": 3871028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfbe44ff5c56628e85683c8918602c96?s=128&d=identicon&r=PG&f=1", "display_name": "Ripi2", "link": "https://stackoverflow.com/users/3871028/ripi2"}, "edited": false, "score": 0, "creation_date": 1559760345, "post_id": 56466264, "comment_id": 99524016, "body": "@Ripi2 it does not contain an &quot;include&quot; folder. Only ones I have that have &quot;include&quot; are related to java."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 2, "creation_date": 1559760462, "post_id": 56466264, "comment_id": 99524052, "body": "Have you installed a compiler as well? CDT does not come with its own compiler, but requires another one, e. g. MinGW or MinGW64. Then you need to make sure CDT finds the compiler, it should then find the include directories as well."}, {"owner": {"reputation": 6058, "user_id": 3871028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfbe44ff5c56628e85683c8918602c96?s=128&d=identicon&r=PG&f=1", "display_name": "Ripi2", "link": "https://stackoverflow.com/users/3871028/ripi2"}, "edited": false, "score": 0, "creation_date": 1559760655, "post_id": 56466264, "comment_id": 99524153, "body": "<i>&quot;it does not contain an &quot;include&quot; folder&quot;</i> See <a href=\"https://help.eclipse.org/2019-03/topic/org.eclipse.cdt.doc.user/reference/cdt_u_prop_general_pns_inc.htm\" rel=\"nofollow noreferrer\">C/C++ Project Properties, Paths and Symbols, Includes</a>."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "reply_to_user": {"reputation": 6058, "user_id": 3871028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfbe44ff5c56628e85683c8918602c96?s=128&d=identicon&r=PG&f=1", "display_name": "Ripi2", "link": "https://stackoverflow.com/users/3871028/ripi2"}, "edited": false, "score": 0, "creation_date": 1559760747, "post_id": 56466264, "comment_id": 99524192, "body": "@Ripi2 That&#39;s for the non-standard headers. If you need to include the standard header files there, you&#39;ve obviously done something wrong."}, {"owner": {"reputation": 191, "user_id": 11369664, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-j3pOKhSdLp4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfz0reuFZPBqvHnAgjvTXcWBoIr2A/mo/photo.jpg?sz=128", "display_name": "George Xavier", "link": "https://stackoverflow.com/users/11369664/george-xavier"}, "reply_to_user": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1559760839, "post_id": 56466264, "comment_id": 99524238, "body": "@Aconcagua can I still used Eclipse while having MinGW&#39;s include folder?"}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 1, "creation_date": 1559761179, "post_id": 56466264, "comment_id": 99524380, "body": "@GeorgeXavier Not sure what exactly you mean... At first, you will have to install MinGW. Then easiest is including the path to gcc.exe (directory only) in windows&#39; PATH variable. Normally, CDT should find the rest then by itself. If you opt for MinGW 64, earlier you additionally needed to rename one of the exe-files. Not sure any more which one it was \u2013 and if if that problem yet persists at all. Might with your outdated eclipse version, though."}, {"owner": {"reputation": 191, "user_id": 11369664, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-j3pOKhSdLp4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfz0reuFZPBqvHnAgjvTXcWBoIr2A/mo/photo.jpg?sz=128", "display_name": "George Xavier", "link": "https://stackoverflow.com/users/11369664/george-xavier"}, "reply_to_user": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1559761376, "post_id": 56466264, "comment_id": 99524451, "body": "@Aconcagua ok I have the includes folder, now how do I link it to eclipse? I already put the path in the environmental variables."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1559761475, "post_id": 56466264, "comment_id": 99524488, "body": "@GeorgeXavier The standard libraries should get linked automatically, too. Did you get a linker error? That would surprise me now..."}, {"owner": {"reputation": 191, "user_id": 11369664, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-j3pOKhSdLp4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfz0reuFZPBqvHnAgjvTXcWBoIr2A/mo/photo.jpg?sz=128", "display_name": "George Xavier", "link": "https://stackoverflow.com/users/11369664/george-xavier"}, "reply_to_user": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1559761528, "post_id": 56466264, "comment_id": 99524511, "body": "@Aconcagua nvm the most recent comment, it can find it now. Now I think a completely unassociated binary-not-found error, so header problem solved. Thanks."}], "answers": [{"comments": [{"owner": {"reputation": 191, "user_id": 11369664, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-j3pOKhSdLp4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfz0reuFZPBqvHnAgjvTXcWBoIr2A/mo/photo.jpg?sz=128", "display_name": "George Xavier", "link": "https://stackoverflow.com/users/11369664/george-xavier"}, "edited": false, "score": 1, "creation_date": 1559767919, "post_id": 56467774, "comment_id": 99527183, "body": "It was not having the minGW &quot;include&quot; folder, Then attaching it to the path I got it working."}], "tags": [], "owner": {"reputation": 689, "user_id": 10894713, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-1ZLMy80urgE/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcZNWEGF20lE4QqIHv3k4pakqRon-A/mo/photo.jpg?sz=128", "display_name": "Mehdi", "link": "https://stackoverflow.com/users/10894713/mehdi"}, "is_accepted": true, "score": 2, "last_activity_date": 1559767575, "creation_date": 1559767575, "answer_id": 56467774, "question_id": 56466264, "link": "https://stackoverflow.com/questions/56466264/eclipse-cdt-include-folder/56467774#56467774", "title": "Eclipse CDT Include Folder", "body": "<p>Go to project properties, C/C++ General -> Paths and Symbols and for Language GNU C you should see the compiler default include folders.</p>\n\n<p>If not, you might have a path problem.</p>\n\n<p>And i think <a href=\"https://codeyarns.com/2015/10/01/unresolved-inclusion-warning-in-eclipse/\" rel=\"nofollow noreferrer\">This</a> helps you! </p>\n"}], "owner": {"reputation": 191, "user_id": 11369664, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-j3pOKhSdLp4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfz0reuFZPBqvHnAgjvTXcWBoIr2A/mo/photo.jpg?sz=128", "display_name": "George Xavier", "link": "https://stackoverflow.com/users/11369664/george-xavier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1160, "favorite_count": 0, "accepted_answer_id": 56467774, "answer_count": 1, "score": 2, "last_activity_date": 1581760275, "creation_date": 1559760006, "last_edit_date": 1581760275, "question_id": 56466264, "link": "https://stackoverflow.com/questions/56466264/eclipse-cdt-include-folder", "title": "Eclipse CDT Include Folder", "body": "<p>I am a C++ newb. I have the Eclipse Luna IDE for Windows 10 and downloaded the Eclipse C/C++ IDE CDT 9.4 plugin. I have some code which has </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n</code></pre>\n\n<p>which is giving me \"unresolved inclusion\". Based on my research it means I do not have some include folder. I cannot find it on my Windows machine and all the help I've found is with ubuntu or Linux-based operating systems. So how do I get this to work? How do I get the folder?</p>\n"}, {"tags": ["c", "linux", "linux-kernel", "linux-device-driver"], "comments": [{"owner": {"reputation": 3561, "user_id": 2511795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30c869f55cbcf82a7bc4536d563daa0a?s=128&d=identicon&r=PG", "display_name": "0andriy", "link": "https://stackoverflow.com/users/2511795/0andriy"}, "edited": false, "score": 0, "creation_date": 1559797036, "post_id": 56465996, "comment_id": 99533049, "body": "So, have you look at any conversion example inside the kernel?"}], "answers": [{"tags": [], "owner": {"reputation": 215710, "user_id": 134633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc6be45ddcfd038ba5e1e5fca319c7fa?s=128&d=identicon&r=PG", "display_name": "caf", "link": "https://stackoverflow.com/users/134633/caf"}, "is_accepted": true, "score": 1, "last_activity_date": 1559797023, "creation_date": 1559797023, "answer_id": 56471092, "question_id": 56465996, "link": "https://stackoverflow.com/questions/56465996/conversion-of-old-init-timer-in-new-linux-kernel/56471092#56471092", "title": "Conversion of old init_timer in new linux kernel", "body": "<p>You first need to change the member that stores the <code>struct timer_list</code> to be of the correct type instead of using an array of bytes:</p>\n\n<pre><code>typedef struct\n{\n    struct timer_list Timer;\n    OS_TIMER_FNC  Function;\n    OS_VOID*      Data;\n    OS_UINT32     Period;\n} OS_TIMER;\n</code></pre>\n\n<p>(and <code>lTimer</code> is just set to <code>&amp;aTimer-&gt;Timer</code>).</p>\n\n<p>In the old code the <code>data</code> member is just set to a pointer to the <code>OS_TIMER</code> structure that contains the timer.  In the new code, the callback can instead get this pointer using the <code>from_timer</code> macro, eg if in the old callback you had this:</p>\n\n<pre><code>OS_TIMER *aTimer = lTimer-&gt;data;\n</code></pre>\n\n<p>then in the new code you would instead have:</p>\n\n<pre><code>OS_TIMER *aTimer = from_timer(aTimer, lTimer, Timer);\n</code></pre>\n\n<p>(where the last parameter <code>Timer</code> is the name of the <code>struct timer_list</code> field in <code>OS_TIMER</code>).</p>\n"}], "owner": {"reputation": 65, "user_id": 8864361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2a541865c0779ecd5ef45232339af17?s=128&d=identicon&r=PG&f=1", "display_name": "roo_saa", "link": "https://stackoverflow.com/users/8864361/roo-saa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1434, "favorite_count": 1, "accepted_answer_id": 56471092, "answer_count": 1, "score": 2, "last_activity_date": 1559797023, "creation_date": 1559758734, "question_id": 56465996, "link": "https://stackoverflow.com/questions/56465996/conversion-of-old-init-timer-in-new-linux-kernel", "title": "Conversion of old init_timer in new linux kernel", "body": "<p>I am trying to build a SDK driver (with no documentation or support from the manufacturer). The original driver uses init_timer() and passes in a pointer to the timer_list structure. And it uses the 'data' element. Now I know that some of the timer functions are deprecated in the newer Linux kernels. Currently I am using kernel version 4.15.</p>\n\n<p>What is the best way to access the 'data' element?</p>\n\n<p>Current function looks like this -</p>\n\n<pre><code>OS_RESULT OS_TimerCreate(OS_DRV_CONTEXT* aContext, OS_TIMER* aTimer, OS_UINT32 aPeriodic, OS_TIMER_FNC aFunction, \n            OS_VOID* aData, OS_UINT32 aPeriod)\n{\n    struct timer_list* lTimer = (struct timer_list*) aTimer-&gt;Space;\n    unsigned long lJiffies = jiffies;\n    unsigned long lPeriod = msecs_to_jiffies(aPeriod);\n\n    OS_UNREFERENCED_PARAMETER(aContext);\n    OS_ASSERT( OS_TIMER_SIZE &gt;= sizeof(timer_list));\n\n    init_timer(lTimer);\n\n    lTimer-&gt;expires = lJiffies + lPeriod;\n    lTimer-&gt;data = (unsigned long) aTimer;\n    aTimer-&gt;Function = aFunction;\n    aTimer-&gt;Data = aData;   \n    aTimer-&gt;Period = lPeriod;\n    if (aPeriodic)\n    {\n        lTimer-&gt;function = OS_TimerPeriodicInternalFunc; \n    }\n    else\n    {\n        lTimer-&gt;function = OS_TimerInternalFunc; \n    }\n\n    add_timer(lTimer);\n\n    return OS_RESULT_OK;\n}\n</code></pre>\n\n<p>Declaration for reference -</p>\n\n<pre><code>typedef struct\n{\n    OS_UINT8      Space[OS_TIMER_SIZE];\n    OS_TIMER_FNC  Function;\n    OS_VOID*      Data;\n    OS_UINT32     Period;\n} OS_TIMER;\n\nOS_DECL_EXTERN OS_RESULT OS_TimerCreate(OS_DRV_CONTEXT* aContext, OS_TIMER* aTimer, OS_UINT32 aPeriodic, OS_TIMER_FNC aFunction, OS_VOID* aData, OS_UINT32 aPeriod /* ms */);\n</code></pre>\n\n<p>Any help will be appreciated.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 8506, "user_id": 10808674, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j1tGB.jpg?s=128&g=1", "display_name": "Alain Merigot", "link": "https://stackoverflow.com/users/10808674/alain-merigot"}, "edited": false, "score": 1, "creation_date": 1559758560, "post_id": 56465913, "comment_id": 99523249, "body": "Does this really compile? Most probably your compile generates a warning and drops the second initializer (97)."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 4, "creation_date": 1559758565, "post_id": 56465913, "comment_id": 99523251, "body": "You do know that the members of a union <i>share</i> the memory? Modifying a single member, could (depending on type-size and byte-order) change <i>all</i> members."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1559760538, "post_id": 56465913, "comment_id": 99524091, "body": "Perhaps the keyword you&#39;re looking for is <code>struct</code>."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1559761235, "post_id": 56465913, "comment_id": 99524408, "body": "MSVC says &quot;error C2078: too many initializers.&quot; That is because there is only one member."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1559763758, "post_id": 56465913, "comment_id": 99525429, "body": "@WeatherVane: There are quite clearly two members in the union. The reason there should be only one initializer is C 2018 6.7.9 17: \u201cWhen no designations are present, subobjects of the current object are initialized in order according to the type of the current object: \u2026 the first named member of a union.\u201d"}], "answers": [{"tags": [], "owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "is_accepted": false, "score": 3, "last_activity_date": 1559768081, "last_edit_date": 1559768081, "creation_date": 1559759537, "answer_id": 56466170, "question_id": 56465913, "link": "https://stackoverflow.com/questions/56465913/how-is-the-variable-of-union-accessing-the-members/56466170#56466170", "title": "How is the variable of union accessing the members?", "body": "<p>The first member of the initializer is put into the first named member of the union, therefore changing the value of all members, as all members of the union share the same memory. Then, reading from <code>y</code> reads from the value stored in the union, or <code>1</code>.</p>\n\n<p>The second member of the initializer is ignored in practice, but should issue a compiler diagnostic for compliant compilers.</p>\n\n<p>For GCC, this diagnostic should look roughly like this:</p>\n\n<pre><code>test.c:7:11: warning: excess elements in union initializer\n } k = {1, 97};\n           ^~\ntest.c:7:11: note: (near initialization for \u2018k\u2019)\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10748096, "user_type": "registered", "profile_image": "https://graph.facebook.com/991785957675941/picture?type=large", "display_name": "Jaya Pandey", "link": "https://stackoverflow.com/users/10748096/jaya-pandey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1559771490, "creation_date": 1559758345, "last_edit_date": 1559771490, "question_id": 56465913, "link": "https://stackoverflow.com/questions/56465913/how-is-the-variable-of-union-accessing-the-members", "title": "How is the variable of union accessing the members?", "body": "<pre><code>#include &lt;stdio.h&gt;\n\nunion p\n{\n    int x;\n    char y;\n} k = {1, 97};\n\nint main()\n{\n    printf(\"%d\\n\", k.y);\n}\n</code></pre>\n\n<p>The answer is 1 and I don't understand how. Can anyone please explain?</p>\n"}, {"tags": ["c", "makefile"], "comments": [{"owner": {"reputation": 9720, "user_id": 6371123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f90991c1b06c79ae4c6e79fb616d608?s=128&d=identicon&r=PG", "display_name": "G.M.", "link": "https://stackoverflow.com/users/6371123/g-m"}, "edited": false, "score": 0, "creation_date": 1559758639, "post_id": 56465894, "comment_id": 99523283, "body": "Please edit your question to include the full error message verbatim (it should reference the line number at which the error occurred)."}, {"owner": {"reputation": 609, "user_id": 11171682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80b4b97bc5566dbe16f0e5f8eeaeb6d5?s=128&d=identicon&r=PG&f=1", "display_name": "hkj447", "link": "https://stackoverflow.com/users/11171682/hkj447"}, "reply_to_user": {"reputation": 9720, "user_id": 6371123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f90991c1b06c79ae4c6e79fb616d608?s=128&d=identicon&r=PG", "display_name": "G.M.", "link": "https://stackoverflow.com/users/6371123/g-m"}, "edited": false, "score": 0, "creation_date": 1559758868, "post_id": 56465894, "comment_id": 99523373, "body": "@G.M. hopefully that suffices, it doesn&#39;t seem to give me the line for the error"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 4, "creation_date": 1559758957, "post_id": 56465894, "comment_id": 99523419, "body": "It does: &quot;depend:1&quot;. That means the error is on the first line in the <code>depend</code> file that you <code>include</code>."}, {"owner": {"reputation": 609, "user_id": 11171682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80b4b97bc5566dbe16f0e5f8eeaeb6d5?s=128&d=identicon&r=PG&f=1", "display_name": "hkj447", "link": "https://stackoverflow.com/users/11171682/hkj447"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1559759205, "post_id": 56465894, "comment_id": 99523528, "body": "@Someprogrammerdude thank you for pointing that out! I made an additional edit."}, {"owner": {"reputation": 168, "user_id": 2207905, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/3sfKK.jpg?s=128&g=1", "display_name": "fassn", "link": "https://stackoverflow.com/users/2207905/fassn"}, "edited": false, "score": 1, "creation_date": 1559759388, "post_id": 56465894, "comment_id": 99523614, "body": "Does it work if you remove the comments?"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1559759412, "post_id": 56465894, "comment_id": 99523624, "body": "Comment out the <code>include depend</code>. Then run <code>make depend</code> to generate a new dependency file."}, {"owner": {"reputation": 609, "user_id": 11171682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80b4b97bc5566dbe16f0e5f8eeaeb6d5?s=128&d=identicon&r=PG&f=1", "display_name": "hkj447", "link": "https://stackoverflow.com/users/11171682/hkj447"}, "edited": false, "score": 0, "creation_date": 1559759456, "post_id": 56465894, "comment_id": 99523645, "body": "I think that worked!"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1559759589, "post_id": 56465894, "comment_id": 99523706, "body": "The quotes are in the <code>depend</code> file."}, {"owner": {"reputation": 609, "user_id": 11171682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80b4b97bc5566dbe16f0e5f8eeaeb6d5?s=128&d=identicon&r=PG&f=1", "display_name": "hkj447", "link": "https://stackoverflow.com/users/11171682/hkj447"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1559760148, "post_id": 56465894, "comment_id": 99523921, "body": "@Someprogrammerdude That fixed the separator issue, but it appears to give Powershell a bunch more to complain about. However, WSL is happy and it compiles just fine"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1559760271, "post_id": 56465894, "comment_id": 99523989, "body": "Have you tried using double quotes <code>&quot;</code> in the <code>Makefile</code>?"}, {"owner": {"reputation": 609, "user_id": 11171682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80b4b97bc5566dbe16f0e5f8eeaeb6d5?s=128&d=identicon&r=PG&f=1", "display_name": "hkj447", "link": "https://stackoverflow.com/users/11171682/hkj447"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1559760393, "post_id": 56465894, "comment_id": 99524030, "body": "@Someprogrammerdude Doing that yielded the same error it seems."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 3, "creation_date": 1559762054, "post_id": 56465894, "comment_id": 99524746, "body": "\ud83d\udeab\ud83d\udcf8 Please post code, errors, sample data or textual output here as plain-text, not as images that can be hard to read, can\u2019t be copy-pasted to help test code or use in answers, and are barrier to those who depend on screen readers. You can edit your question to add the code in the body of your question. For easy formatting use the <code>{}</code> button to mark blocks of code, or indent with four spaces for the same effect. The contents of a <b>screenshot can\u2019t be searched, run as code, or copied and edited to create a solution.</b>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1559790722, "post_id": 56465894, "comment_id": 99531952, "body": "regarding: <code>all : $(TARGETS)     touch all</code>   This is not correct.  Suggest: &#39;.PHONY: all` newline  <code>all: $(TARGETS)</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1559791209, "post_id": 56465894, "comment_id": 99532038, "body": "Apply my comment about: <code>all : $(TARGETS)</code> to <code>install</code> and <code>clean</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1559791570, "post_id": 56465894, "comment_id": 99532103, "body": "regarding the definition of: <code>WARN := `   It is missing the main warnings:  </code>-Wextra -Wconversion -pedantic -std=gnu11`"}, {"owner": {"reputation": 609, "user_id": 11171682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80b4b97bc5566dbe16f0e5f8eeaeb6d5?s=128&d=identicon&r=PG&f=1", "display_name": "hkj447", "link": "https://stackoverflow.com/users/11171682/hkj447"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1559827844, "post_id": 56465894, "comment_id": 99547691, "body": "@user3629249 Assuming I implemented your code correctly, this did not work either unfortunately and threw the same error."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1559827959, "post_id": 56465894, "comment_id": 99547765, "body": "Well, it says it can&#39;t find gcc. Can you run e.g. <code>gcc --version</code> manually? Did you install gcc on Windows?"}, {"owner": {"reputation": 609, "user_id": 11171682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80b4b97bc5566dbe16f0e5f8eeaeb6d5?s=128&d=identicon&r=PG&f=1", "display_name": "hkj447", "link": "https://stackoverflow.com/users/11171682/hkj447"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1559828120, "post_id": 56465894, "comment_id": 99547877, "body": "@melpomene I install it via this link: <a href=\"https://stackoverflow.com/questions/32127524/how-to-install-and-use-make-in-windows\" title=\"how to install and use make in windows\">stackoverflow.com/questions/32127524/&hellip;</a> by using Vasantha&#39;s solution. Powershell says it didn&#39;t recognize gcc as a cmdlet."}, {"owner": {"reputation": 609, "user_id": 11171682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80b4b97bc5566dbe16f0e5f8eeaeb6d5?s=128&d=identicon&r=PG&f=1", "display_name": "hkj447", "link": "https://stackoverflow.com/users/11171682/hkj447"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1559839242, "post_id": 56465894, "comment_id": 99553967, "body": "@tadman I updated the post."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1559882224, "post_id": 56465894, "comment_id": 99565401, "body": "when writing macros, like: <code>RM = rm -f</code>  do not use &#39;=&#39;  as that results in the macro being re-evaluated every time it is referenced.   Instead, use &#39;:=&#39; as the macro will only be evaluated once"}], "owner": {"reputation": 609, "user_id": 11171682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80b4b97bc5566dbe16f0e5f8eeaeb6d5?s=128&d=identicon&r=PG&f=1", "display_name": "hkj447", "link": "https://stackoverflow.com/users/11171682/hkj447"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 96, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1559837989, "creation_date": 1559758264, "last_edit_date": 1559837989, "question_id": 56465894, "link": "https://stackoverflow.com/questions/56465894/running-make-in-powershell-cmd-gives-error2", "title": "running make in Powershell/CMD gives Error2", "body": "<p>UPDATE: The tabulation error has been fixed.\nso I am changing the scope of this issue to focus on error 2. I would like to keep this same post as there has been some valuable discussion. </p>\n\n<p>I am attempting to run this Makefile on Windows, but it gives the error \"missing separator\". I did some googling, and it seems like this issue stems from having spaces instead of a tab. I opened up the file in notepad++ and it seems like all the tabs are placed correctly. Is there another syntax issue that would throw this error? It should be noted that this compiles perfectly fine on Ubuntu 18.04, therefore I am not entirely sure what the issue may be.</p>\n\n<p>Code here:</p>\n\n<pre><code>#  where the executables should be installed:\nBIN = $HOME/bin\n\n# define your compiler here:\nCC = gcc\n\n# define your copy command here:\nCOPY = cp\n\n# define your remove (or delete) command here:\nRM = rm -f\n\n# suffix of object files?  (o for unix, obj for MSDOS):\nO = o\n\n# suffix for executable files? (empty for unix, .exe for dos):\nE =\n\n# command line arguments for C compiler\nWARN := \\\n -Wall \\\n -Wcast-align \\\n -Wcast-qual \\\n -Wmissing-declarations \\\n -Wmissing-prototypes \\\n -Wpointer-arith \\\n -Wstrict-prototypes \\\n -Wno-unused-parameter \\\n -Wno-unused-function \\\n -Wshadow \\\n -Wundef \\\n -Wwrite-strings\nOPT1 = -DNDEBUG\n#OPT2 = -O\nCFLAGS = -g $(WARN) $(OPT1) $(OPT2)\n\n#\n# There should be no need to make changes below this line\n#\nTARGETS = abcml$(E) abcsim$(E) tabcfg$(E) mau2cfg$(E) cplcfg$(E) gnaw$(E) \\\n  wgtcfg$(E)\n\n#make all targets\nall : $(TARGETS)\n    touch all\n\n#target wgtcfg: Weight the configurations in a .cfg file\nWGTCFG = wgtcfg.$(O) getcic.$(O) io.$(O) header.$(O) misc.$(O) zeroin.$(O)\nwgtcfg$(E) : $(WGTCFG)\n    $(CC) $(CFLAGS) -o $@ $(WGTCFG) -lm\n\n#target gnaw: subject an assemblage to attrition\nGNAW = gnaw.$(O)  getcic.$(O) io.$(O) header.$(O) misc.$(O) zeroin.$(O) \\\n  unirand.$(O)\ngnaw$(E) : $(GNAW)\n    $(CC) $(CFLAGS) -o $@ $(GNAW) -lm\n\n#target cplcfg: Calculate complement of .cfg file\nCPLCFG = cplcfg.$(O) getcic.$(O) io.$(O) header.$(O) misc.$(O) zeroin.$(O)\ncplcfg$(E) : $(CPLCFG)\n    $(CC) $(CFLAGS) -o $@ $(CPLCFG) -lm\n\n#target mau2cfg: convert .mau format to .cfg format\nMAU2CFG = mau2cfg.$(O) getcic.$(O) misc.$(O) io.$(O) header.$(O) zeroin.$(O)\nmau2cfg$(E) : $(MAU2CFG)\n    $(CC) $(CFLAGS) -o $@ $(MAU2CFG) -lm\n\n#target abcsim: simulation program\nABCSIM = abcsim.$(O) getcic.$(O) zeroin.$(O) misc.$(O) io.$(O) unirand.$(O) \\\n  header.$(O)\nabcsim$(E) : $(ABCSIM) \n    $(CC) $(CFLAGS) -o $@ $(ABCSIM) -lm\n\n#target abcml: estimation program\nABCML = abcml.$(O) io.$(O) getcic.$(O) zeroin.$(O) misc.$(O) likelihood.$(O) \\\n  prlike.$(O) chol.$(O) amoeba.$(O)  symeig.$(O) unirand.$(O) header.$(O) \\\n  ninfomat.$(O)\nabcml$(E) : $(ABCML) \n    $(CC) $(CFLAGS) -o $@ $(ABCML) -lm\n\n#target tabcfg: tabulate configurations\nTABCFG = tabcfg.$(O) getcic.$(O) misc.$(O) io.$(O) header.$(O) zeroin.$(O)\ntabcfg$(E) : $(TABCFG) \n    $(CC) $(CFLAGS) -o $@ $(TABCFG) -lm\n\ninstall : all\n    $(COPY) $(TARGETS) $(BIN)\n\nclean : \n    $(RM) *.$(O) *~ all bone junk* core abcmlsrc.zip try depend $(TARGETS)\n\nabcmlsrc.zip :\n    zip -l abcmlsrc LICENSE Makefile.dos Makefile.unix *.c *.h -x try.*\n\ndepend :\n    echo '#Automatically generated dependency info' &gt; depend\n    $(CC) -M *.c &gt;&gt; depend\n\ninclude depend\n</code></pre>\n\n<p>EDIT: Whew, ok, so fixing the error in the depend file leads to another wonderful error which can be pictured here below (The bit of mandarin states: \n\"The system can not find the file specified\"). Fixing the depend file now allows it to compile properly using WSL, but PowerShell is still not happy. Should I try to use a different compiler? My goal is to get the executable file from running make so I can do stuff with it.</p>\n\n<pre><code>gcc -g -Wall -Wcast-align -Wcast-qual -Wmissing-declarations -Wmissing-prototypes -Wpointer-arith -Wstrict-prototypes -Wno-unused-parameter -Wno-unused-function -Wshadow -Wundef -Wwrite-strings -DNDEBUG    -c -o wgtcfg.o wgtcfg.c\nprocess_begin: CreateProcess(NULL, gcc -g -Wall -Wcast-align -Wcast-qual -Wmissing-declarations -Wmissing-prototypes -Wpointer-arith -Wstrict-prototypes -Wno-unused-parameter -Wno-unused-function -Wshadow -Wundef -Wwrite-strings -DNDEBUG -c -o wgtcfg.o wgtcfg.c, ...) failed.\nmake (e=2): \u7cfb\u7edf\u627e\u4e0d\u5230\u6307\u5b9a\u7684\u6587\u4ef6\u3002\nmake: *** [&lt;builtin&gt;: wgtcfg.o] Error 2\n</code></pre>\n"}, {"tags": ["c", "linux", "pthreads"], "comments": [{"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1559757705, "post_id": 56465727, "comment_id": 99522900, "body": "Did you initialize the semaphores? See <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 51, "user_id": 11301535, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c993b703d9117602376a9b1005b5207?s=128&d=identicon&r=PG&f=1", "display_name": "kamilm758", "link": "https://stackoverflow.com/users/11301535/kamilm758"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1559758323, "post_id": 56465727, "comment_id": 99523159, "body": "yes, i initialize in  main."}], "owner": {"reputation": 51, "user_id": 11301535, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c993b703d9117602376a9b1005b5207?s=128&d=identicon&r=PG&f=1", "display_name": "kamilm758", "link": "https://stackoverflow.com/users/11301535/kamilm758"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1559757459, "creation_date": 1559757459, "question_id": 56465727, "link": "https://stackoverflow.com/questions/56465727/readers-and-writers-writers-starvation", "title": "Readers and writers- writers starvation", "body": "<p>I'm writing a program that simulates the \"readers-writers\" problem. Why when I start a program with, for example, 10 readers and 10 writers, only 1 reader is entered in the reading room. Where's my mistake?</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>int READERS;\nint READERS_WORKING = 0;\nint WRITERS;\nint WRITERS_WORKING = 0;\nsem_t resource, reader;\n\nvoid PrintStatus(){\n    printf(\"Outside: %d readers and %d writers, Inside: %d readers and %d writers\\n\", (READERS-READERS_WORKING), (WRITERS-WRITERS_WORKING), READERS_WORKING, WRITERS_WORKING);\n}\n\nvoid *readersWork(void *arg) {\n    while (1) {\n        sem_wait(&amp;reader);\n        READERS_WORKING++; \n\n        if (READERS_WORKING == 1) {\n            sem_wait(&amp;resource);\n        }\n    PrintStatus();\n        sem_post(&amp;reader);\n\n        sleep(2); //Working\n\n        sem_wait(&amp;reader);\n    READERS_WORKING--;\n\n        if (READERS_WORKING == 0) { // Last reader inside\n            sem_post(&amp;resource);\n        }\n        sem_post(&amp;reader);\n    PrintStatus();\n\n\n    }\n    return 0;\n}\n\nvoid *writersWork(void *arg) {\n    while (1) {\n        sem_wait(&amp;resource);\n    PrintStatus();\n    WRITERS_WORKING++;\n        sleep(2);\n        sem_post(&amp;resource);\n    WRITERS_WORKING--;\n    //PrintStatus();\n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "bitwise-operators", "bit-shift"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1559757217, "post_id": 56465629, "comment_id": 99522724, "body": "The relevant quote from the standard should be the one about shifting more than the number of bits of the left-hand operand."}, {"owner": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "edited": false, "score": 0, "creation_date": 1559757265, "post_id": 56465629, "comment_id": 99522742, "body": "There&#39;s not a lot of magic there, in some other languages this behaviour is even <i>mandatory</i>"}], "answers": [{"comments": [{"owner": {"reputation": 1469, "user_id": 2397118, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/7241c07b5e6a92c24c2e3e2af011153b?s=128&d=identicon&r=PG", "display_name": "Swiss Frank", "link": "https://stackoverflow.com/users/2397118/swiss-frank"}, "edited": false, "score": 1, "creation_date": 1559789008, "post_id": 56465677, "comment_id": 99531674, "body": "OK, then, that&#39;s a horrible spec, though, to make an unqualified statement about what the value is (that I quoted), then have a qualification in another paragraph.  Why the heck didn&#39;t they just put a table of situations and results, I wonder."}, {"owner": {"reputation": 14588, "user_id": 6870253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c7ce91530d2dddae7b9fc2bd828ed78?s=128&d=identicon&r=PG&f=1", "display_name": "chtz", "link": "https://stackoverflow.com/users/6870253/chtz"}, "reply_to_user": {"reputation": 1469, "user_id": 2397118, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/7241c07b5e6a92c24c2e3e2af011153b?s=128&d=identicon&r=PG", "display_name": "Swiss Frank", "link": "https://stackoverflow.com/users/2397118/swiss-frank"}, "edited": false, "score": 1, "creation_date": 1559823580, "post_id": 56465677, "comment_id": 99545171, "body": "@SwissFrank The (or a) reason is because different CPUs have different behavior, e.g., on x86-32bit only the last 5bits of the shift count are used. That means it would require some additional comparison/branching/masking, if this was to be implemented platform-independent. Since C (and C++) seeks to be a zero-overhead language, things like this are rather left undefined (or implementation defined)."}], "tags": [], "owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "is_accepted": true, "score": 11, "last_activity_date": 1559757834, "last_edit_date": 1559757834, "creation_date": 1559757197, "answer_id": 56465677, "question_id": 56465629, "link": "https://stackoverflow.com/questions/56465629/bitwise-shift-operator-seems-to-wrap/56465677#56465677", "title": "bitwise shift operator seems to wrap?", "body": "<p><a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.5.7p3\" rel=\"noreferrer\">6.5.7p3</a></p>\n\n<blockquote>\n  <p>... If the value of the right operand is negative or is <strong>greater than\n  or equal to the width of the promoted left operand</strong>, the behavior is\n  <strong>undefined</strong>.</p>\n</blockquote>\n\n<p>With clang, gcc, and icc, you'll <a href=\"https://gcc.godbolt.org/z/CHEHPG\" rel=\"noreferrer\">get a warning</a> if you attempt to shift by a constant that's greater or equal to the width of the shifted value, and you don't even need any extra command-line flags.</p>\n"}], "owner": {"reputation": 1469, "user_id": 2397118, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/7241c07b5e6a92c24c2e3e2af011153b?s=128&d=identicon&r=PG", "display_name": "Swiss Frank", "link": "https://stackoverflow.com/users/2397118/swiss-frank"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 305, "favorite_count": 0, "accepted_answer_id": 56465677, "answer_count": 1, "score": 4, "last_activity_date": 1559757834, "creation_date": 1559757012, "question_id": 56465629, "link": "https://stackoverflow.com/questions/56465629/bitwise-shift-operator-seems-to-wrap", "title": "bitwise shift operator seems to wrap?", "body": "<p>This is Windows 7 32-bit, Visual Studio 2017, in a C file.</p>\n\n<pre><code>int i = 65536;\n</code></pre>\n\n<p>As expected,</p>\n\n<pre><code>i &gt;&gt; 0 = 65536\ni &gt;&gt; 1 = 32768\n  :\n  :\ni &gt;&gt; 16 = 1\ni &gt;&gt; 17 to 31 = 0.\n</code></pre>\n\n<p>i >> 32 is magically 65536 again though.  How is that legal?</p>\n\n<p>ISO/IEC 9899:TC2 says the following and I assume C++ specs are the same?</p>\n\n<blockquote>\n  <p>The result of E1 >> E2 is E1 right-shifted E2 bit positions. <strong>If E1 has\n  an unsigned type or if E1 has a signed type and a nonnegative value,\n  the value of the result is the integral part of the quotient of E1 /\n  2^E2.</strong> If E1 has a signed type and a negative value, the resulting value\n  is implementation-defined.</p>\n</blockquote>\n"}, {"tags": ["c", "assembly", "x86", "nasm"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 4, "creation_date": 1559756229, "post_id": 56465415, "comment_id": 99522385, "body": "Remember the order you push the arguments..."}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 3, "creation_date": 1559757402, "post_id": 56465415, "comment_id": 99522789, "body": "NULL doesn&#39;t point to zero, it IS zero, which doesn&#39;t point anywhere. But as already pointed out, the issue is your order of arguments."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 11605123, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-A7ehkQtHw6c/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbDBuQ_47mwGRR500GYavB4MwPpXuA/mo/photo.jpg?sz=128", "display_name": "Carlos Carral", "link": "https://stackoverflow.com/users/11605123/carlos-carral"}, "edited": false, "score": 0, "creation_date": 1559759166, "post_id": 56465593, "comment_id": 99523509, "body": "Thank you, i hadn&#39;t noticed. However, after making this change and recompiling still no change. Does this have to do with calling strtok from outside a compiled c program? Or could NULL be anything else? Perhaps it has to do that I&#39;m compiling my program for a 32 bit architecture but my C implementation is for 64 bit arch?"}, {"owner": {"reputation": 28846, "user_id": 327083, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/i8ttM.png?s=128&g=1", "display_name": "J...", "link": "https://stackoverflow.com/users/327083/j"}, "reply_to_user": {"reputation": 11, "user_id": 11605123, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-A7ehkQtHw6c/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbDBuQ_47mwGRR500GYavB4MwPpXuA/mo/photo.jpg?sz=128", "display_name": "Carlos Carral", "link": "https://stackoverflow.com/users/11605123/carlos-carral"}, "edited": false, "score": 1, "creation_date": 1559764232, "post_id": 56465593, "comment_id": 99525628, "body": "@CarlosCarral Maybe, maybe, and maybe. You haven&#39;t told us much about your environment, operating system, etc.  A <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> and a second question might be the best way forward."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 11, "user_id": 11605123, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-A7ehkQtHw6c/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbDBuQ_47mwGRR500GYavB4MwPpXuA/mo/photo.jpg?sz=128", "display_name": "Carlos Carral", "link": "https://stackoverflow.com/users/11605123/carlos-carral"}, "edited": false, "score": 0, "creation_date": 1559788720, "post_id": 56465593, "comment_id": 99531645, "body": "@CarlosCarral: In all x86 calling conventions / ABIs, the asm bit-pattern for <code>NULL</code> pointers is integer <code>0</code>.  So <code>push 0</code> is always safe <i>on x86</i>.  The C standard allows it to be different because <i>some</i> hardware might want to use something else, e.g. a bit-pattern that always faulted.  This is not done on x86.  (Despite that fact that some OSes, notably Windows 95, mapped the zero page in the address space of user-space processes, so the undefined behaviour of NULL-pointer dereference could be corrupting the whole machine state, instead of just faulting that process!)"}], "tags": [], "owner": {"reputation": 28846, "user_id": 327083, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/i8ttM.png?s=128&g=1", "display_name": "J...", "link": "https://stackoverflow.com/users/327083/j"}, "is_accepted": false, "score": 5, "last_activity_date": 1559757293, "last_edit_date": 1559757293, "creation_date": 1559756867, "answer_id": 56465593, "question_id": 56465415, "link": "https://stackoverflow.com/questions/56465415/how-do-i-push-the-equivalent-of-null-in-c-to-the-stack-in-assembly/56465593#56465593", "title": "How do I push the equivalent of NULL in C to the stack in assembly?", "body": "<pre><code> push NULL \n push string \n call strtok\n</code></pre>\n\n<p>this is calling <code>strtok(string, NULL)</code>.  You want <code>strtok(NULL, \" \")</code>, so presuming that <code>delim</code> contains <code>\" \"</code> :</p>\n\n<pre><code> push delim\n push NULL\n call strtok\n</code></pre>\n\n<p>Parameters go onto the stack in reverse (right-to-left) order in the <code>cdecl</code> calling convention.</p>\n\n<hr>\n\n<p>For the other part of your question (is NULL always zero), see : <a href=\"https://stackoverflow.com/q/9894013/327083\">Is NULL always zero in C?</a></p>\n"}, {"comments": [{"owner": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 1, "creation_date": 1559797720, "post_id": 56470467, "comment_id": 99533198, "body": "Win32 progs had first 64KiB mapped but couldn&#39;t address it without a fault. Win16 near pointers were relative to the beginning of a 64kb segment that of course wasn&#39;t the first 64KiB of physical memory. Win16 far pointers were selector:offset. Selector 0 causes a fault accessing NULL descriptor Win32 would fault because data selectors were expand down. The real problem was code running in a MS-DOS compatibility session could clobber the first 1MiB of memory. There were of course things a Win16 and Win32 process could do to circumvent the limited protection."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 1, "creation_date": 1559799948, "post_id": 56470467, "comment_id": 99533804, "body": "@MichaelPetch: oh, that&#39;s a lot less insane than I thought, for &quot;normal&quot; code.  And IIRC, it wasn&#39;t NULL deref but rather array-overrun bugs that I remember leading to system-wide lockups on Win9x back in the summer of 2000 (MinGW or Cygwin for a command-line test program that just used scanf/printf and some math library functions to test the function I would call from Excel once I had it working.)  So zero-page stuff doesn&#39;t explain it."}, {"owner": {"reputation": 28846, "user_id": 327083, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/i8ttM.png?s=128&g=1", "display_name": "J...", "link": "https://stackoverflow.com/users/327083/j"}, "edited": false, "score": 0, "creation_date": 1559812243, "post_id": 56470467, "comment_id": 99539113, "body": "Personally, I was waiting for OP to drop the <i>&quot;Oh, it&#39;s (insert esoteric real-time embedded x86 platform) with a prototype C implementation, nightly build...&quot;</i>.  Nice answer, in any case."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 28846, "user_id": 327083, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/i8ttM.png?s=128&g=1", "display_name": "J...", "link": "https://stackoverflow.com/users/327083/j"}, "edited": false, "score": 0, "creation_date": 1559813442, "post_id": 56470467, "comment_id": 99539771, "body": "@J...: heh, if that was the case I hope they&#39;d choose a less bad calling convention than stack args!  At least a couple register args are probably a win for code-size for optimized code that normally keeps things in registers anyway.  And certainly a win for overall performance.  Maybe &quot;Oh, it&#39;s a DeathStation 9000 nightly build&quot; for maximal C gotchas including NULL not having an all-zero bit-pattern.  :P"}, {"owner": {"reputation": 28846, "user_id": 327083, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/i8ttM.png?s=128&g=1", "display_name": "J...", "link": "https://stackoverflow.com/users/327083/j"}, "edited": false, "score": 0, "creation_date": 1559822564, "post_id": 56470467, "comment_id": 99544620, "body": "@PeterCordes Aye, the latter!  Really I was just hoping OP would edit in some of their platform details so we didn&#39;t have to guess."}], "tags": [], "owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "is_accepted": false, "score": 3, "last_activity_date": 1559877147, "last_edit_date": 1592644375, "creation_date": 1559790787, "answer_id": 56470467, "question_id": 56465415, "link": "https://stackoverflow.com/questions/56465415/how-do-i-push-the-equivalent-of-null-in-c-to-the-stack-in-assembly/56470467#56470467", "title": "How do I push the equivalent of NULL in C to the stack in assembly?", "body": "<blockquote>\n<p>I've read that in &quot;most implementations&quot; NULL points to 0, whatever that means.</p>\n</blockquote>\n<p>No, it <em>is</em> 0; it's not a pointer <em>to</em> anything.</p>\n<p>In C source, <code>(void*)0</code> is always NULL, but implementations are allowed to internally use a different non-zero bit-pattern for the object-representation of <code>int *p = NULL;</code>.  Implementations that choose a non-zero bit-pattern need to translate at compile time.  (And the translation <em>only</em> works at compile time for compile-time integer constant expressions with value zero that appear in a pointer context, not for <code>memset</code> or whatever.)  <strong>The C++ FAQ has a whole section on <a href=\"http://www.c-faq.com/null/index.html\" rel=\"nofollow noreferrer\">NULL pointers</a></strong>.  (Which also applies to C in this case.)</p>\n<p>(It's legal in C to access the bit-pattern of an object with memcpy into an integer, or with <code>(char*)</code> aliasing onto it, so it is possible to detect this in a well-formed program that's free from undefined behaviour.  Or of course by looking at the asm or memory contents with a debugger!  In practice you can easily check that the right asm for a NULL is by compiling <code>int*foo(){return NULL;}</code> )</p>\n<p>See also <a href=\"https://stackoverflow.com/questions/2759845/why-is-address-zero-used-for-the-null-pointer\">Why is address zero used for the null pointer?</a> for some more background.</p>\n<blockquote>\n<p>Why is there ambiguity? What is the equivalent to NULL in x86 instruction set?</p>\n</blockquote>\n<p><strong>In all x86 calling conventions / ABIs, the asm bit-pattern for NULL pointers is integer 0</strong>.</p>\n<p><strong>So <code>push 0</code> or <code>xor edi,edi</code> (RDI=0) is always what you want on x86 / x86-64.</strong>  (Modern calling conventions, including all x86-64 conventions, pass args in registers.)</p>\n<p>@J...'s answer shows how to <strong>push args in right-to-left order for the calling convention you're using</strong>, resulting in the first (left-most) arg at the lowest address.</p>\n<p>Really you can store them to the stack however you like (e.g. with <code>mov</code>) as long as they end up in the right place when <code>call</code> runs.</p>\n<hr />\n<p>The C standard allows it to be different because C implementations on some hardware might want to use something else, e.g. a special bit-pattern that always faults when dereferenced, regardless of context.  Or if <code>0</code> was a valid address value in real programs, it's better if <code>p==NULL</code> is always false for valid pointers.  Or any other arcane hardware-specific reason.</p>\n<p>So yes there <em>could</em> have been some C implementations for x86 where <code>(void*)0</code> in the C source turns into a non-zero integer in the asm.  But in practice there aren't.  (And most programmers are happy that <code>memset(array_of_pointers, 0, size)</code> actually sets them to NULL, which relies on the bit-pattern being <code>0</code>, because some code makes that assumption without thinking about the fact that it's not guaranteed to be portable).</p>\n<p>This is not done on x86 in any of the standard C ABIs.  (An ABI is a set of implementation choices that compilers all follow so their code can call each other, e.g. agreeing on struct layout, calling conventions, and what <code>p == NULL</code> means.)</p>\n<p>I'm not aware of any modern C implementations that use non-zero <code>NULL</code> on other 32 or 64-bit CPUs either; virtual memory makes it easy to avoid address 0.</p>\n<p><a href=\"http://c-faq.com/null/machexamp.html\" rel=\"nofollow noreferrer\">http://c-faq.com/null/machexamp.html</a> has some historical examples:</p>\n<blockquote>\n<p>The Prime 50 series used segment <code>07777</code>, offset <code>0</code> for the null pointer, at least for PL/I. Later models used segment <code>0</code>, offset 0 for null pointers in C, necessitating new instructions such as <code>TCNP</code> (Test C Null Pointer), evidently as a sop to [footnote] all the extant poorly-written C code which made incorrect assumptions. Older, word-addressed Prime machines were also notorious for requiring larger byte pointers (<code>char *</code>) than word pointers (<code>int *</code>).</p>\n<p>... see <a href=\"http://c-faq.com/null/machexamp.html\" rel=\"nofollow noreferrer\">the link</a> for more machines, and the footnote from this paragraph.</p>\n</blockquote>\n<p><a href=\"https://www.quora.com/On-which-actual-architectures-is-Cs-null-pointer-not-a-binary-zero-all-bits-zero\" rel=\"nofollow noreferrer\">https://www.quora.com/On-which-actual-architectures-is-Cs-null-pointer-not-a-binary-zero-all-bits-zero</a> reports finding a non-zero NULL on 286 Xenix, I guess using segmented pointers.</p>\n<hr />\n<p>Modern x86 OSes make sure processes <em>can't</em> map anything into the lowest page of virtual address space, so NULL pointer dereference always faults noisily to make debugging easier.</p>\n<p>e.g. Linux by default reserves the low 64kiB of address space.  This helps whether it came from a NULL pointer in the source, or whether some other bug zeroed a pointer with integer zeros.  64k instead of just the low 4k page catches indexing a pointer as an array, like <code>p[i]</code> with small to medium <code>i</code> values.</p>\n<p>Fun fact: Windows 95 mapped the lowest pages of user-space virtual address space to the first 64kiB of physical memory to work around a 386 B1 stepping erratum.  But fortunately it was able to set things up so access from a normal 32-bit process did fault.  Still, 16-bit code running in DOS compat mode could trash the whole machine very easily.</p>\n<p>See <a href=\"https://devblogs.microsoft.com/oldnewthing/20141003-00/?p=43923\" rel=\"nofollow noreferrer\">https://devblogs.microsoft.com/oldnewthing/20141003-00/?p=43923</a> and <a href=\"https://news.ycombinator.com/item?id=13263976\" rel=\"nofollow noreferrer\">https://news.ycombinator.com/item?id=13263976</a></p>\n"}, {"comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1559808761, "post_id": 56472209, "comment_id": 99537420, "body": "This is NASM syntax, <code>NULL equ 0</code> plus <code>push NULL</code> boils down to <code>push 0</code>.  In AT&amp;T syntax, that would be <code>push $0</code>.  This answer isn&#39;t helpful.  <code>NULL equ 0</code>  correctly defines <code>NULL</code> as an assemble-time constant with <i>value</i> 0, just like <code>.equ NULL, 0</code> would in GAS.  That&#39;s how you use assemble-time named constants."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1559809086, "post_id": 56472209, "comment_id": 99537559, "body": "In literally all ISO C compilers, <code>(void *)0</code> is a NULL pointer constant.  The <code>NULL</code> macro doesn&#39;t <i>have</i> to be defined that way, but an integer <code>0</code> in a pointer context is required to compile to whatever bit-pattern is used to represent a NULL pointer, whether or not that&#39;s all-zero.  On a machine that used all-ones as its NULL, <code>(void *)0xFFFFFFFF</code> might <i>also</i> be a valid definition of NULL, but your phrasing is confusing and implies that <code>(void*)0</code> wouldn&#39;t be NULL on such a machine."}, {"owner": {"reputation": 14659, "user_id": 2705055, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b1d5dfaf239229501a184c8858fbc954?s=128&d=identicon&r=PG&f=1", "display_name": "Martin Rosenau", "link": "https://stackoverflow.com/users/2705055/martin-rosenau"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1559813446, "post_id": 56472209, "comment_id": 99539775, "body": "@PeterCordes There are a lot of different assemblers which have a very similar syntax but interpret some instructions differently, so one assembler interprets <code>push xyz</code> as <code>push [xyz]</code> (NASM?) and the other one interprets the same source line as <code>push offset xyz</code> (as early Microsoft assemblers did). I just checked GAS (version 2.24), AT&amp;T style: <code>.equ NULL, 0</code> followed by <code>push NULL</code> will generate the same code as <code>push 0</code> which is <code>push [ds:0]</code> in Intel syntax; to push the value 0, you&#39;ll have to write <code>push $NULL</code>, not <code>push NULL</code>. (I&#39;m not sure if this changed in newer GAS versions)."}, {"owner": {"reputation": 14659, "user_id": 2705055, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b1d5dfaf239229501a184c8858fbc954?s=128&d=identicon&r=PG&f=1", "display_name": "Martin Rosenau", "link": "https://stackoverflow.com/users/2705055/martin-rosenau"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1559813771, "post_id": 56472209, "comment_id": 99539930, "body": "@PeterCordes I was talking about C compilers from the 1970s. ANSI C and ISO C started to exist in 1989. I doubt that the C compilers that defined <code>NULL</code> as <code>*(void *)0xFFFFFFFF</code> are ISO or ANSI compliant. And as far as I remember there was even a compiler mentioned that used a &quot;special&quot; pattern like <code>#define NULL (void *)0xEF000000</code>. This makes only sense if <code>(void *)0</code> and <code>(void *)0xFFFFFFFF</code> are <b>valid</b>, non-NULL pointers on the machine and OS."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1559814053, "post_id": 56472209, "comment_id": 99540072, "body": "Yes, I&#39;m well aware of how GAS&#39;s MASM-like <code>.intel_syntax</code>  works, and AT&amp;T syntax.  But this question is fairly unambiguously NASM (from the <code>push dword [stdin]</code> not <code>dword ptr</code>), so I meant that your answer is confusing at best to someone learning NASM.  Yes in GAS <code>.intel_syntax</code> a <code>push NULL</code> would be a memory operand with absolute address <code>0</code>, and you would need <code>push OFFSET NULL</code> to get the constant value (aka symbol address) rather than implicitly dereferencing it to get the pointed-to value."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1559814223, "post_id": 56472209, "comment_id": 99540186, "body": "And BTW &quot;defines a variable&quot; implies reserving space, as well as labeling an address.  It definitely does not do that."}, {"owner": {"reputation": 14659, "user_id": 2705055, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b1d5dfaf239229501a184c8858fbc954?s=128&d=identicon&r=PG&f=1", "display_name": "Martin Rosenau", "link": "https://stackoverflow.com/users/2705055/martin-rosenau"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1559814625, "post_id": 56472209, "comment_id": 99540386, "body": "@PeterCordes I edited my answer completely and removed a lot of confusing text."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1559815386, "post_id": 56472209, "comment_id": 99540832, "body": "<i>&quot;Most&quot; mean that before the introduction of ISO C and ANSI C in the late 1980s, there were C compilers that defined NULL in a different way.</i>  No, that&#39;s not what it means.  Modern ISO C doesn&#39;t specify the object-representation of <code>(void*)0</code>.  The examples in <a href=\"http://c-faq.com/null/machexamp.html\" rel=\"nofollow noreferrer\">c-faq.com/null/machexamp.html</a> could all be valid with modern C11 compilers.  <code>int *p = 0;</code> and then <code>memcpy</code> or otherwise using a <code>char*</code> to inspect the object representation lets you see if the bit-pattern is non-zero.  See also <a href=\"//stackoverflow.com/q/9894013\">Is NULL always zero in C?</a>"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1559815414, "post_id": 56472209, "comment_id": 99540846, "body": "What you say about historical implementations is presumably <i>true</i>, but I don&#39;t think that&#39;s what the OP was reading about."}], "tags": [], "owner": {"reputation": 14659, "user_id": 2705055, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b1d5dfaf239229501a184c8858fbc954?s=128&d=identicon&r=PG&f=1", "display_name": "Martin Rosenau", "link": "https://stackoverflow.com/users/2705055/martin-rosenau"}, "is_accepted": false, "score": 1, "last_activity_date": 1559814552, "last_edit_date": 1559814552, "creation_date": 1559803742, "answer_id": 56472209, "question_id": 56465415, "link": "https://stackoverflow.com/questions/56465415/how-do-i-push-the-equivalent-of-null-in-c-to-the-stack-in-assembly/56472209#56472209", "title": "How do I push the equivalent of NULL in C to the stack in assembly?", "body": "<p>You are actually asking two questions:</p>\n\n<p><strong>Question 1</strong></p>\n\n<blockquote>\n  <p>I've read that ... NULL points to 0, whatever that means.</p>\n</blockquote>\n\n<p>This means that nearly all C compilers define <code>NULL</code> as <code>(void *)0</code>.</p>\n\n<p>This means that a <code>NULL</code> pointer is a pointer to the memory location with the address zero.</p>\n\n<blockquote>\n  <p>I've read that in \"most implementations\" ...</p>\n</blockquote>\n\n<p>\"Most\" mean that <strong>before</strong> the introduction of ISO C and ANSI C in the late <strong>1980s</strong>, there were C compilers that defined <code>NULL</code> in a different way.</p>\n\n<p>Maybe a <em>few non-standard</em> C compilers still exist that do not recognize the address 0 as <code>NULL</code>.</p>\n\n<p>However, you can assume that your C compiler and the C library you use in your assembly project defines <code>NULL</code> as pointer to the address 0.</p>\n\n<p><strong>Question 2</strong></p>\n\n<blockquote>\n  <p>How do I push the equivalent of <code>NULL</code> in C to the stack in assembly?</p>\n</blockquote>\n\n<p>A pointer is an address.</p>\n\n<p>(Unlike some other CPUs), x86 CPUs don't distinguish between integers and addresses:</p>\n\n<p>You push a <code>NULL</code> pointer by pushing the integer value 0.</p>\n\n<blockquote>\n<pre><code>NULL equ 0\n\npush NULL\n</code></pre>\n</blockquote>\n\n<p>Unfortunately, you did not write which assembler you use. (Other users assume it is NASM.)</p>\n\n<p>In this context, the instruction <code>push NULL</code> may be interpreted in two different ways by different assemblers:</p>\n\n<ul>\n<li><p>Some assemblers would interpret this as: \"<em>Push the value 0</em>\".</p>\n\n<p>This would be correct.</p></li>\n<li><p>Other assemblers would interpret this as: \"<em>Read the memory at memory location 0 and push that value</em>\"</p>\n\n<p>This would be equal to <code>someFunction(*(int *)NULL)</code> in C and therefore cause an exception (<code>NULL</code> pointer access).</p></li>\n</ul>\n"}], "owner": {"reputation": 11, "user_id": 11605123, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-A7ehkQtHw6c/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbDBuQ_47mwGRR500GYavB4MwPpXuA/mo/photo.jpg?sz=128", "display_name": "Carlos Carral", "link": "https://stackoverflow.com/users/11605123/carlos-carral"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1305, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1559877147, "creation_date": 1559756013, "last_edit_date": 1559813772, "question_id": 56465415, "link": "https://stackoverflow.com/questions/56465415/how-do-i-push-the-equivalent-of-null-in-c-to-the-stack-in-assembly", "title": "How do I push the equivalent of NULL in C to the stack in assembly?", "body": "<p>I'm writing a bubble sort for string sorting in assembly language and I'm using strtok() to tokenize the string. However, after the first call strtok(str,\" \"), I need to pass NULL as a parameter, i.e strtok(NULL,\" \")</p>\n\n<p>I've tried NULL equ 0 in  the .bss segment but this doesn't do anything.</p>\n\n<pre><code>[SECTION .data]\n\n[SECTION .bss]\n\nstring resb 64\nNULL equ 0\n\n[SECTION .text]\n\nextern fscanf\nextern stdin\nextern strtok\n\nglobal main\n\nmain:\n\n    push ebp        ; Set up stack frame for debugger\n    mov ebp,esp\n    push ebx        ; Program must preserve ebp, ebx, esi, &amp; edi\n    push esi\n    push edi\n\n    push cadena\n    push frmt\n    push dword [stdin]      ;Read string from stdin\n    call fscanf\n    add esp,12              ;clean stack\n\n    push delim\n    push string             ;this works\n    call strtok\n    add esp,8               ;clean stack\n\n    ;after this step, the return value in eax points to the first word \n\n    push string             ;this does not\n    push NULL\n    call strtok\n    add esp,8               ;clean stack\n\n    ;after this step, eax points to 0x0\n\n    pop edi         ; Restore saved registers\n    pop esi\n    pop ebx\n    mov esp,ebp     ; Destroy stack frame before returning\n    pop ebp\n    ret         ;return control to linux\n</code></pre>\n\n<p>I've read that in \"most implementations\" NULL points to 0, whatever that means. Why is there ambiguity? What is the equivalent to NULL in x86 instruction set?</p>\n"}, {"tags": ["c", "windows", "winapi", "printing"], "comments": [{"owner": {"reputation": 33827, "user_id": 506413, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1a474f3be606bcc6f964913b523626e9?s=128&d=identicon&r=PG", "display_name": "Jonathan Potter", "link": "https://stackoverflow.com/users/506413/jonathan-potter"}, "edited": false, "score": 0, "creation_date": 1559759308, "post_id": 56465355, "comment_id": 99523573, "body": "Is <a href=\"https://stackoverflow.com/questions/41437023/trying-to-determine-printer-status-always-returns-0-for-offline-online-printer/41483350\" title=\"trying to determine printer status always returns 0 for offline online printer\">stackoverflow.com/questions/41437023/&hellip;</a> relevant? (i.e. are you trying to determine online/offline status?)"}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1559759577, "post_id": 56465355, "comment_id": 99523699, "body": "Those HeapFree calls are somewhat pointless. Also, why do you ignore return value of GetPrinter? The documentation is pretty clear on that matter."}, {"owner": {"reputation": 1221, "user_id": 6210312, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/kWA1n.png?s=128&g=1", "display_name": "Lacobus", "link": "https://stackoverflow.com/users/6210312/lacobus"}, "reply_to_user": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1559760030, "post_id": 56465355, "comment_id": 99523872, "body": "@DavidHeffernan: I&#39;m trying to determine toner and paper status (<code>PRINTER_STATUS_PAPER_OUT</code> and <code>PRINTER_STATUS_NO_TONER</code>). I&#39;m ignoring the value returned by <code>GetPrinter()</code> function because it is calculating the size of the buffer needed to store <code>PRINTER_INFO_6</code> data. (will always fail in this case)."}, {"owner": {"reputation": 33827, "user_id": 506413, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1a474f3be606bcc6f964913b523626e9?s=128&d=identicon&r=PG", "display_name": "Jonathan Potter", "link": "https://stackoverflow.com/users/506413/jonathan-potter"}, "edited": false, "score": 1, "creation_date": 1559762102, "post_id": 56465355, "comment_id": 99524765, "body": "See <a href=\"https://support.microsoft.com/en-au/help/160129/how-to-get-the-status-of-a-printer-and-a-print-job\" rel=\"nofollow noreferrer\">How to get the status of a printer and a print job</a>. It sounds like you have to check both the printer (as you are doing) and the job queue as well."}, {"owner": {"reputation": 6168, "user_id": 10611792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r727s.jpg?s=128&g=1", "display_name": "Drake Wu", "link": "https://stackoverflow.com/users/10611792/drake-wu"}, "edited": false, "score": 0, "creation_date": 1559791263, "post_id": 56465355, "comment_id": 99532051, "body": "If you try to use <code>PRINTER_INFO_2</code> instead of <code>PRINTER_INFO_6</code>. Is the value of <code>PRINTER_INFO_2.Status</code> also 0 always?"}, {"owner": {"reputation": 1221, "user_id": 6210312, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/kWA1n.png?s=128&g=1", "display_name": "Lacobus", "link": "https://stackoverflow.com/users/6210312/lacobus"}, "reply_to_user": {"reputation": 6168, "user_id": 10611792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r727s.jpg?s=128&g=1", "display_name": "Drake Wu", "link": "https://stackoverflow.com/users/10611792/drake-wu"}, "edited": false, "score": 0, "creation_date": 1559825522, "post_id": 56465355, "comment_id": 99546258, "body": "@DrakeWu-MSFT: same results, zero always!"}, {"owner": {"reputation": 6168, "user_id": 10611792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r727s.jpg?s=128&g=1", "display_name": "Drake Wu", "link": "https://stackoverflow.com/users/10611792/drake-wu"}, "edited": false, "score": 0, "creation_date": 1560391594, "post_id": 56465355, "comment_id": 99723380, "body": "What printer driver is being used? What printer port?  Also, if you remove all the paper, do you get the right status?"}, {"owner": {"reputation": 1221, "user_id": 6210312, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/kWA1n.png?s=128&g=1", "display_name": "Lacobus", "link": "https://stackoverflow.com/users/6210312/lacobus"}, "reply_to_user": {"reputation": 6168, "user_id": 10611792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r727s.jpg?s=128&g=1", "display_name": "Drake Wu", "link": "https://stackoverflow.com/users/10611792/drake-wu"}, "edited": false, "score": 0, "creation_date": 1560458382, "post_id": 56465355, "comment_id": 99754314, "body": "@DrakeWu-MSFT: regardless of printer state (tonner and paper completely removed) the status stills the same. I&#39;m using an USB port. Same bahaviour when using a <code>PRINTER_INFO_2</code> structure. The <a href=\"http://support.lexmark.com/index?docLocale=en_US&amp;page=content&amp;segType=recommendedSegmentOS&amp;id=DR23661&amp;locale=EN&amp;userlocale=EN_US\" rel=\"nofollow noreferrer\">driver</a>. The printer is a Lexmark MS610dn on a windows 7 64-bit machine."}, {"owner": {"reputation": 6168, "user_id": 10611792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r727s.jpg?s=128&g=1", "display_name": "Drake Wu", "link": "https://stackoverflow.com/users/10611792/drake-wu"}, "edited": false, "score": 0, "creation_date": 1560821681, "post_id": 56465355, "comment_id": 99852172, "body": "Hi,@Lacobus,1. To see the status of the printer, you must be doing something with the printer.  For example, you attempt to print.  At this point you can check on the status.  If the printer isn\u2019t doing anything, the status will be zero. 2. A better way to know what the printer is doing is for the application to register for notifications."}], "answers": [{"tags": [], "owner": {"reputation": 6168, "user_id": 10611792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r727s.jpg?s=128&g=1", "display_name": "Drake Wu", "link": "https://stackoverflow.com/users/10611792/drake-wu"}, "is_accepted": false, "score": 0, "last_activity_date": 1560150670, "last_edit_date": 1560150670, "creation_date": 1560145921, "answer_id": 56521115, "question_id": 56465355, "link": "https://stackoverflow.com/questions/56465355/windows-spooler-api-getprinter-is-not-returning-struct-printer-info-6-properly/56521115#56521115", "title": "Windows spooler API GetPrinter() is not returning struct PRINTER_INFO_6 properly filled", "body": "<blockquote>\n  <p>My goal is to determine paper status (<code>PRINTER_STATUS_PAPER_JAM</code>,\n  <code>PRINTER_STATUS_PAPER_OUT</code>, <code>PRINTER_STATUS_PAPER_PROBLEM</code>) and toner\n  status (<code>PRINTER_STATUS_TONER_LOW</code>, <code>PRINTER_STATUS_NO_TONER</code>).</p>\n</blockquote>\n\n<p>Print status is changed to the above value only when the printer has the issue above. <code>Status = 0</code> means that the printer is currently idle/ready. If you Google the keyword \"Printer Status Codes\", you will see Status Code = 0 means Printer ready. Seem that it hasn't been documented, or defined as a macro.</p>\n\n<p>Paper and toner issue status is like \"runtime status\", if you do not start to print, then no such issue status code will be set. For example,\nYou have to call <code>GetLastError()</code> after an api but not before. </p>\n"}], "owner": {"reputation": 1221, "user_id": 6210312, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/kWA1n.png?s=128&g=1", "display_name": "Lacobus", "link": "https://stackoverflow.com/users/6210312/lacobus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 473, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1560150670, "creation_date": 1559755752, "last_edit_date": 1559760630, "question_id": 56465355, "link": "https://stackoverflow.com/questions/56465355/windows-spooler-api-getprinter-is-not-returning-struct-printer-info-6-properly", "title": "Windows spooler API GetPrinter() is not returning struct PRINTER_INFO_6 properly filled", "body": "<p>I'm using <a href=\"https://docs.microsoft.com/en-us/windows/desktop/printdocs/printing-and-print-spooler-functions\" rel=\"nofollow noreferrer\">Printer Spooling API</a> to retrive the printer status information <a href=\"https://docs.microsoft.com/en-us/windows/desktop/printdocs/printer-info-6\" rel=\"nofollow noreferrer\"><code>PRINTER_INFO_6</code></a> using <a href=\"https://docs.microsoft.com/en-us/windows/desktop/printdocs/getprinter\" rel=\"nofollow noreferrer\"><code>GetPrinter()</code></a> function.</p>\n\n<p>My goal is to determine paper status (<code>PRINTER_STATUS_PAPER_JAM</code>, <code>PRINTER_STATUS_PAPER_OUT</code>, <code>PRINTER_STATUS_PAPER_PROBLEM</code>) and toner status (<code>PRINTER_STATUS_TONER_LOW</code>, <code>PRINTER_STATUS_NO_TONER</code>).</p>\n\n<p>Strangely, regardless of printer state, <code>dwStatus</code> member is always zero.</p>\n\n<p>The following code retrieves the printer status information from the default printer and displays it on the screen:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;windows.h&gt;\n\n\nint main( void )\n{\n    HANDLE hPrinter = INVALID_HANDLE_VALUE;\n    PPRINTER_INFO_6 pInfo = NULL;\n    DWORD dwNeeded = 0L;\n    CHAR szPrinterName[ MAX_PATH + 1 ] = {0};\n    DWORD dwLength = MAX_PATH;\n    BOOL ret = FALSE;\n\n\n    ret = GetDefaultPrinter( szPrinterName, &amp;dwLength );\n\n    if( ret == FALSE )\n    {\n        fprintf(stderr, \"[FATAL] GetDefaultPrinter() failed: %lu\\n\", GetLastError() );\n        return EXIT_FAILURE;\n    }\n\n    ret = OpenPrinter( szPrinterName, &amp;hPrinter, NULL );\n\n    if( ret == FALSE )\n    {\n        fprintf(stderr, \"[FATAL] OpenPrinter( '%s' ) failed: %lu\\n\", szPrinterName, GetLastError() );\n        return EXIT_FAILURE;\n    }\n\n    GetPrinter( hPrinter, 6, NULL, 0, &amp;dwNeeded );\n\n    if(!dwNeeded)\n    {\n        fprintf(stderr, \"[FATAL] GetPrinter() failed: %lu\\n\", GetLastError() );\n        ClosePrinter( hPrinter );\n        return EXIT_FAILURE;\n    }\n\n    pInfo = (PRINTER_INFO_6*) HeapAlloc( GetProcessHeap(), HEAP_ZERO_MEMORY, dwNeeded );\n\n    if( pInfo == NULL )\n    {\n        fprintf(stderr, \"[FATAL] HeapAlloc() failed: %lu\\n\", GetLastError() );\n        ClosePrinter( hPrinter );\n        return EXIT_FAILURE;\n    }\n\n    ret = GetPrinter( hPrinter, 6, (LPBYTE) pInfo, dwNeeded, &amp;dwNeeded );\n\n    if( ret == FALSE )\n    {\n        fprintf(stderr, \"[FATAL] GetPrinter() failed: %lu\\n\", GetLastError() );\n        HeapFree( GetProcessHeap(), 0, pInfo );\n        ClosePrinter( hPrinter );\n        return EXIT_FAILURE;\n    }\n\n    fprintf( stdout, \"pInfo-&gt;dwStatus: 0x%08lX\\n\", pInfo-&gt;dwStatus );\n\n    HeapFree( GetProcessHeap(), 0, pInfo );\n    ClosePrinter( hPrinter );\n    return EXIT_SUCCESS;\n}\n</code></pre>\n\n<p>In the code above, <code>pInfo-&gt;dwStatus</code> is <strong>always</strong> <code>0x00000000</code>.</p>\n\n<p>Could someone tell me what's wrong? Clues?</p>\n"}, {"tags": ["c", "c-preprocessor", "language-lawyer", "predefined-macro"], "comments": [{"owner": {"reputation": 90101, "user_id": 2509, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/79ed928ca8b1ab9a637720bf0fb20732?s=128&d=identicon&r=PG&f=1", "display_name": "dmckee --- ex-moderator kitten", "link": "https://stackoverflow.com/users/2509/dmckee-ex-moderator-kitten"}, "edited": false, "score": 0, "creation_date": 1559755946, "post_id": 56465101, "comment_id": 99522267, "body": "Interesting. the ways I&#39;ve used <code>__LINE__</code> in the past would be insensitive to this change (I&#39;ve needed human readability sometimes (and humans are flexible) and a guarantee that the lines numbers reported have the correct <i>sequence relationships</i> (which should be preserved under this change)). Is it breaking something for you?"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1559755978, "post_id": 56465101, "comment_id": 99522281, "body": "Take a look at the preprocessor output (using the <code>-E</code> option) to see the results of the macro substitution. With the compiler I&#39;m using, the <code>printf</code> ends up as a single line, including the trailing <code>);</code>"}, {"owner": {"reputation": 4227, "user_id": 525010, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rSzer.jpg?s=128&g=1", "display_name": "Philip Kendall", "link": "https://stackoverflow.com/users/525010/philip-kendall"}, "reply_to_user": {"reputation": 90101, "user_id": 2509, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/79ed928ca8b1ab9a637720bf0fb20732?s=128&d=identicon&r=PG&f=1", "display_name": "dmckee --- ex-moderator kitten", "link": "https://stackoverflow.com/users/2509/dmckee-ex-moderator-kitten"}, "edited": false, "score": 3, "creation_date": 1559760232, "post_id": 56465101, "comment_id": 99523963, "body": "@dmckee It wouldn&#39;t be a <a href=\"https://stackoverflow.com/questions/tagged/language-lawyer\">language-lawyer</a> question if it had an actual use case ;-)"}, {"owner": {"reputation": 6600, "user_id": 1173674, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/364e5d67e6deec7330fdd25dc205e945?s=128&d=identicon&r=PG", "display_name": "anol", "link": "https://stackoverflow.com/users/1173674/anol"}, "reply_to_user": {"reputation": 90101, "user_id": 2509, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/79ed928ca8b1ab9a637720bf0fb20732?s=128&d=identicon&r=PG&f=1", "display_name": "dmckee --- ex-moderator kitten", "link": "https://stackoverflow.com/users/2509/dmckee-ex-moderator-kitten"}, "edited": false, "score": 0, "creation_date": 1559803776, "post_id": 56465101, "comment_id": 99535093, "body": "@dmckee we have some test oracles that store the preprocessed C code, and software such as Hiredis contains a few <code>assert</code>s spanning multiple lines. Because of this change, developers with older GCC versions or using Clang will obtain different oracles, which is how I noticed the difference."}], "answers": [{"tags": [], "owner": {"reputation": 2223, "user_id": 325181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26de4aa17ab84757b1233714af5fec84?s=128&d=identicon&r=PG", "display_name": "Clarus", "link": "https://stackoverflow.com/users/325181/clarus"}, "is_accepted": false, "score": 1, "last_activity_date": 1559759804, "last_edit_date": 1559759804, "creation_date": 1559757401, "answer_id": 56465719, "question_id": 56465101, "link": "https://stackoverflow.com/questions/56465101/are-there-any-guarantees-about-consistency-of-line-directives/56465719#56465719", "title": "Are there any guarantees about consistency of __LINE__ directives?", "body": "<p>While the general case of finding a line number from a specific instruction is hard, i.e. GDB trying to come up with a line number from some code that crashed, the printf <code>__LINE__</code> instruction is relatively straight forward as the compiler generates the number as a static for a specific location.</p>\n\n<p>The C11 standard itself is just saying that the line number should not change while you are in a macro, i.e. <code>__LINE__</code> should reflect where you are in a program after the macro has been expanded, not what line of code the macro is located on. This allows you to do things like provide the line number of the callee of your function, by creating a macro that printed the line number and then called your function. For example:</p>\n\n<pre><code>#define f(x) ({ printf(\"called f(x) at line=%d\\n\", __LINE__); f__real(x); })\n</code></pre>\n\n<p>As to the exact line number that is presented, that is compiler dependent and is not apart of any standard. I.e. your example could be rewritten as:</p>\n\n<pre><code>int main() {\n  printf(\"%d\\n\", \n         __LINE__);\n}\n</code></pre>\n\n<p>and in this case a valid response could be either 2 or 3. </p>\n\n<p>If you are trying to determine the line number dynamically, that is provided through system backtrace libraries. i.e. backtrace() on linux. </p>\n"}], "owner": {"reputation": 6600, "user_id": 1173674, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/364e5d67e6deec7330fdd25dc205e945?s=128&d=identicon&r=PG", "display_name": "anol", "link": "https://stackoverflow.com/users/1173674/anol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 153, "favorite_count": 1, "answer_count": 1, "score": 11, "last_activity_date": 1559777455, "creation_date": 1559754644, "last_edit_date": 1559777455, "question_id": 56465101, "link": "https://stackoverflow.com/questions/56465101/are-there-any-guarantees-about-consistency-of-line-directives", "title": "Are there any guarantees about consistency of __LINE__ directives?", "body": "<p>GCC 9 has recently changed the behavior of the <code>__LINE__</code> directive in some cases. The program below illustrates the change:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#define expand() __LINE__\nint main() {\n  printf(\"%d\\n\",expand(\n                ));\n  return 0;\n}\n</code></pre>\n\n<p>Because the macro <code>expand()</code> (which expands to <code>__LINE__</code>) spans more than one line, GCC up to 8.3 (and Clang up to 8.0) considers the number of the last line of the expansion, printing <code>5</code>. But GCC 9 considers the <em>first</em> line, and prints 4.</p>\n\n<p>(Godbolt link: <a href=\"https://godbolt.org/z/3Nk2al\" rel=\"noreferrer\">https://godbolt.org/z/3Nk2al</a>)</p>\n\n<p>The C11 standard is not very precise about the exact behavior of <code>__LINE__</code>, other than:</p>\n\n<blockquote>\n  <p><strong>6.10.8 Predefined macro names</strong></p>\n  \n  <p>The values of the predefined macros listed in the following subclauses (except for <code>__FILE__</code> and <code>__LINE__</code>) remain constant throughout the translation unit.</p>\n  \n  <p>(...)</p>\n  \n  <p><strong>6.8.10.1 Mandatory macros</strong></p>\n  \n  <p>The following macro names shall be defined by the implementation:</p>\n  \n  <p>(...)</p>\n  \n  <p><code>__LINE__</code> The presumed line number (within the current source file) of the current source line (an integer constant).</p>\n</blockquote>\n\n<p>I assume this means that the exact value is implementation-defined, and therefore one cannot expect its value to remain constant across different compiler versions, or different compilers. Or is there some argument to that effect elsewhere in the standard?</p>\n\n<p>For instance, could one argue that the <em>presumed line number of the current source line</em> should be stable as long as the source itself did not change?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 3, "creation_date": 1559754350, "post_id": 56464964, "comment_id": 99521609, "body": "Is <a href=\"https://stackoverflow.com/questions/679979\">this</a> what you&#39;re looking for?"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1559755368, "post_id": 56464964, "comment_id": 99522053, "body": "Note that if <code>dothat</code> is a function with a fixed number of parameters (say 4), then you can write the macro as <code>#define dothis(x,y,z) dothat(EXTRA,(x),(y),(z))</code>"}, {"owner": {"reputation": 3759, "user_id": 5362795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50680477fe78fb526c5f28ea7f7dfad5?s=128&d=identicon&r=PG&f=1", "display_name": "Nagev", "link": "https://stackoverflow.com/users/5362795/nagev"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1559818946, "post_id": 56464964, "comment_id": 99542668, "body": "Didn&#39;t see a relevant answer there @user3386109 thanks. The other function does take a variable number of arguments."}], "answers": [{"comments": [{"owner": {"reputation": 3759, "user_id": 5362795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50680477fe78fb526c5f28ea7f7dfad5?s=128&d=identicon&r=PG&f=1", "display_name": "Nagev", "link": "https://stackoverflow.com/users/5362795/nagev"}, "edited": false, "score": 0, "creation_date": 1559818821, "post_id": 56465763, "comment_id": 99542598, "body": "And here&#39;s the documentation which has an example that covers exactly what I was after. Didn&#39;t read the right section at first! <a href=\"https://gcc.gnu.org/onlinedocs/cpp/Variadic-Macros.html\" rel=\"nofollow noreferrer\">gcc.gnu.org/onlinedocs/cpp/Variadic-Macros.html</a>"}], "tags": [], "owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "is_accepted": true, "score": 3, "last_activity_date": 1559757636, "creation_date": 1559757636, "answer_id": 56465763, "question_id": 56464964, "link": "https://stackoverflow.com/questions/56464964/c-wrapper-macro-to-add-extra-arguments-to-function/56465763#56465763", "title": "C wrapper macro to add extra arguments to function", "body": "<pre><code>#define callx(...) call(EXTRA, __VA_ARGS__)\n</code></pre>\n"}], "owner": {"reputation": 3759, "user_id": 5362795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50680477fe78fb526c5f28ea7f7dfad5?s=128&d=identicon&r=PG&f=1", "display_name": "Nagev", "link": "https://stackoverflow.com/users/5362795/nagev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 56465763, "answer_count": 1, "score": 0, "last_activity_date": 1559757636, "creation_date": 1559754063, "question_id": 56464964, "link": "https://stackoverflow.com/questions/56464964/c-wrapper-macro-to-add-extra-arguments-to-function", "title": "C wrapper macro to add extra arguments to function", "body": "<p>I want a C macro that will expand into a function with an extra parameter based on a condition.</p>\n\n<p>Something like this:</p>\n\n<pre><code>#define EXTRA 7\n#ifdef ADD_ONE_MORE_ARG\n#define dothis(...) dothat(EXTRA,...)\n#endif\n</code></pre>\n\n<p>Such that <code>dothis(5);</code> is expanded into <code>dothat(EXTRA, 5);</code> but I can't remember the syntax. The <a href=\"https://stackoverflow.com/questions/12954830/wrapper-for-a-function-with-variable-arguments-in-c\">answer</a> I found here didn't help. Thanks.</p>\n"}, {"tags": ["c", "sorting", "mergesort"], "comments": [{"owner": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 1, "creation_date": 1559752772, "post_id": 56464627, "comment_id": 99520986, "body": "That&#39;s an infinite loop, you&#39;re never updating <code>j</code>."}, {"owner": {"reputation": 183, "user_id": 9785313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/R0msl.png?s=128&g=1", "display_name": "S. Sharma", "link": "https://stackoverflow.com/users/9785313/s-sharma"}, "reply_to_user": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 0, "creation_date": 1559752798, "post_id": 56464627, "comment_id": 99520997, "body": "Looks like that wasn&#39;t copy-pasted over. I&#39;ll fix that."}, {"owner": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 2, "creation_date": 1559752853, "post_id": 56464627, "comment_id": 99521016, "body": "No, Don&#39;t fix it because then we don&#39;t know what else &quot;wasn&#39;t copy-pasted&quot;. Instead, create a minimal example which you <b>tested</b> and post that. See <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 1, "creation_date": 1559752904, "post_id": 56464627, "comment_id": 99521034, "body": "what is the first code, a sub part of the definition of <i>merge</i> ? why do you not give all the definition of <i>merge</i> ? we cannot see how you initialize <i>j</i> etc"}, {"owner": {"reputation": 183, "user_id": 9785313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/R0msl.png?s=128&g=1", "display_name": "S. Sharma", "link": "https://stackoverflow.com/users/9785313/s-sharma"}, "edited": false, "score": 0, "creation_date": 1559753150, "post_id": 56464627, "comment_id": 99521142, "body": "I use cmp in <code>merge()</code> in <code>cmp(left + i*width, right + k*width)</code>"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 1, "creation_date": 1559753736, "post_id": 56464627, "comment_id": 99521337, "body": "<code>if (i == leftsz)</code> should probably be <code>if (i &gt;= leftsz)</code>, and similarly for <code>k</code> and <code>rightsz</code>. Also, arithmetic on <code>void *</code> is not standard C - it&#39;s a GNU extension."}, {"owner": {"reputation": 183, "user_id": 9785313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/R0msl.png?s=128&g=1", "display_name": "S. Sharma", "link": "https://stackoverflow.com/users/9785313/s-sharma"}, "reply_to_user": {"reputation": 28248, "user_id": 2415684, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/e0fb12778bde5d0dddddd3b8b619681b?s=128&d=identicon&r=PG", "display_name": "Rorschach", "link": "https://stackoverflow.com/users/2415684/rorschach"}, "edited": false, "score": 0, "creation_date": 1559753878, "post_id": 56464627, "comment_id": 99521390, "body": "@jenesaisquoi How would I assign <code>void *</code> to each other? As far as I know, this isn&#39;t really that safe to do in C, right?"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1559754111, "post_id": 56464627, "comment_id": 99521500, "body": "Also, in the <code>if (i == leftsz)</code> part, you copy from position <code>k</code> of <code>right</code>, but increment <code>i</code>. Shouldn&#39;t it increment <code>k</code>? Similarly, shouldn&#39;t <code>if (k == rightsz)</code> part increment <code>i</code> instead of <code>k</code>? These changes will prevent <code>i</code> becoming greater than <code>leftsz</code> and <code>k</code> becoming greater than <code>rightsz</code>, so my earlier comment about replacing <code>if (i == leftsz)</code> with <code>if (i &gt;= leftsz)</code> no longer applies."}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "reply_to_user": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1559754276, "post_id": 56464627, "comment_id": 99521578, "body": "@IanAbbott can you do an answer rather than remarks ? that allows to give the full corrected code, and also allow the OP to accept it to mark the question solved"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "reply_to_user": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1559754395, "post_id": 56464627, "comment_id": 99521625, "body": "@bruno: I&#39;ve only been eyeballing the code so far. I&#39;d like to run it before answering properly, but there is no <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "reply_to_user": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1559754430, "post_id": 56464627, "comment_id": 99521648, "body": "@IanAbbott I just needed to add few lines to be able to run it ;-)"}], "answers": [{"comments": [{"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1559754085, "post_id": 56464965, "comment_id": 99521491, "body": "yes but this is not enough to work well, with <code>{ &quot;asdfasfd&quot;, &quot;werwar&quot;, &quot;13234&quot;, &quot;asdfasfd&quot;, &quot;oioj&quot; }</code> that produces <code>{ &quot;asdfasfd&quot;, &quot;asdfasfd&quot;, &quot;werwar&quot;, &quot;13234&quot;, &quot;13234&quot;}</code>"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1559754181, "post_id": 56464965, "comment_id": 99521529, "body": "See my later comment on your question. I think it is incrementing the wrong variables."}], "tags": [], "owner": {"reputation": 183, "user_id": 9785313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/R0msl.png?s=128&g=1", "display_name": "S. Sharma", "link": "https://stackoverflow.com/users/9785313/s-sharma"}, "is_accepted": false, "score": 0, "last_activity_date": 1559754186, "last_edit_date": 1559754186, "creation_date": 1559754063, "answer_id": 56464965, "question_id": 56464627, "link": "https://stackoverflow.com/questions/56464627/implementing-merge-sort-generally-in-c/56464965#56464965", "title": "Implementing Merge Sort Generally in C", "body": "<p>Ok, so looks like I was wrong as to why merge sort was failing.</p>\n\n<p>As Ian Abbott said, <code>if (i == leftsz)</code> should be <code>if (i &gt;= leftsz)</code> and the same should've went for <code>(k == rightsz)</code>. This prevents copying data past the end of the array. Thanks a lot!</p>\n\n<p>Edit:</p>\n\n<p>Additionally, I added in the following before the <code>j</code> loop:</p>\n\n<pre><code>for (int t = 0; t &lt; sz; t++) {\n    char *ptr = res + t*width;\n    ptr = calloc(1, width);\n    check_mem(ptr);\n}\n</code></pre>\n\n<p>Without this section of code, the above doesn't work.</p>\n"}], "owner": {"reputation": 183, "user_id": 9785313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/R0msl.png?s=128&g=1", "display_name": "S. Sharma", "link": "https://stackoverflow.com/users/9785313/s-sharma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 70, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1559754781, "creation_date": 1559752433, "last_edit_date": 1559754781, "question_id": 56464627, "link": "https://stackoverflow.com/questions/56464627/implementing-merge-sort-generally-in-c", "title": "Implementing Merge Sort Generally in C", "body": "<p>I'm trying to create a general merge sort implementation. I 99% sure the issue has to do with the fact that I'm using <code>memcpy</code> incorrectly.</p>\n\n<p>Here's the code I have for merging 2 arrays:</p>\n\n<pre><code>static inline void * merge(void *left, void *right,\n          size_t leftsz, size_t rightsz, size_t width, DArray_compare cmp)\n{\n  size_t i = 0, k = 0, j = 0;\n  size_t sz = leftsz + rightsz;\n  void *res = NULL;\n\n  res = calloc(sz, width);\n  check_mem(res);\n\n  while (j &lt; sz) {\n    if (i == leftsz) {\n      memcpy(res + j*width, right + k*width, width);\n      ++i;\n    } else if (k == rightsz) {\n      memcpy(res + j*width, left + i*width, width);\n      ++k;\n    } else if (cmp(left + i*width, right + k*width) &lt; 0) {\n      debug(\"Here\");\n      memcpy(res + j*width, left + i*width, width);\n      ++i;\n    } else {\n      memcpy(res + j*width, right + k*width, width);\n      ++k;\n    }\n\n    debug(\"------PRINTING RES------\\n\");\n    for (int t = 0; t &lt; j; t++) {\n      debug(\"%s\\n\", * (char **) res + t);\n    }\n    debug(\"----FINISHED PRINTING RES----\\n\");\n\n    ++j;\n  }\n\n  return res;\n\nerror:\n  return NULL;\n}\n</code></pre>\n\n<p>where <code>sz</code> is the size of final merged array, <code>leftsz</code> is the size of the left half, and <code>rightsz</code> is the size of the right half. <code>width</code> refers to how large each element is.</p>\n\n<p>Whenever I run this over the array <code>{ \"asdfasfd\", \"werwar\", \"13234\", \"asdfasfd\", \"oioj\" }</code>, it says that the array wasn't sorted correctly. </p>\n\n<p>Here's the main merge sort code:</p>\n\n<pre><code>int merge_sort(void *arr, size_t size,\n      size_t width, DArray_compare cmp)\n{\n  if (size &lt;= 1)\n    return 0;\n\n  size_t lsize = size / 2, rsize = size - (size / 2);\n  void *left = NULL, *right = NULL, *res = NULL;\n\n  left = calloc(lsize, width);\n  check_mem(left);\n\n  right = calloc(rsize, width);\n  check_mem(right);\n\n  memcpy(left, arr, lsize*width);\n  memcpy(right, arr + lsize*width, rsize*width);\n\n  debug(\"Looping over right array.\");\n  for (int i = lsize; i &lt; size; i++) {\n    debug(\"%s\", * ((char **) right + (i-lsize)));\n  }\n\n  merge_sort(left, lsize, width, cmp);\n  merge_sort(right, rsize, width, cmp);\n\n\n  res = merge(left, right, lsize, rsize, width, cmp);\n  check_mem(res);\n\n  free(left);\n  free(right);\n\n  memcpy(arr, res, size*width);\n  free(res);\n\n  return 0;\n\nerror:\n  if (left) free(left);\n  if (right) free(right);\n  if (res) free(res);\n  return -1;\n}\n</code></pre>\n\n<p>Again, I'm sure that my implementation is screwing up because of <code>memcpy</code>. However, I'm not sure exactly how I'm using it wrong.</p>\n\n<p>I ran the <code>merge_sort</code> function over the array <code>{ \"asdfasfd\", \"werwar\", \"13234\", \"asdfasfd\", \"oioj\" }</code> like so:</p>\n\n<pre><code>int rc = merge_sort(words-&gt;contents, words-&gt;end,\n        sizeof(void *), (DArray_compare) testcmp);\n...\n</code></pre>\n\n<p><code>words-&gt;contents</code> is a <code>void **</code> array and <code>words-&gt;end</code> is the size of the array. <code>words</code> itself is a structure that represents a dynamic array. I know that the array was correctly built, so I don't think that's the root of the problem.</p>\n\n<p>Feel free to ask me for more information if necessary.</p>\n\n<p>Thanks.</p>\n\n<p>Edit: </p>\n\n<p>Here's an example:</p>\n\n<pre><code>int main(int argc, char *argv[])\n{\n  char *words[] = { \"asdfasfd\",\n      \"werwar\", \"13234\", \"asdfasfd\", \"oioj\"};\n  merge_sort((void **)&amp;words, 5,\n        sizeof(void *), testcmp);\n  for (int i = 0; i &lt; 4; i++) {\n      if (strcmp(words[i], words[i+1]) &gt; 0) {\n          printf(\"NOT SORTED\\n\");\n          return 1;\n      }\n  }\n  return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "linux"], "comments": [{"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 10, "creation_date": 1559751908, "post_id": 56464458, "comment_id": 99520541, "body": "Don&#39;t describe the code, show the code. See <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1559751940, "post_id": 56464458, "comment_id": 99520555, "body": "Welcome to Stack Overflow. Please read <a href=\"http://stackoverflow.com/help\">the help pages</a>, take <a href=\"http://stackoverflow.com/tour\">the SO tour</a>, read about <a href=\"http://stackoverflow.com/help/how-to-ask\">how to ask good questions</a>, as well as <a href=\"https://codeblog.jonskeet.uk/2012/11/24/stack-overflow-question-checklist/\" rel=\"nofollow noreferrer\">this question checklist</a>. And as mentioned, please try to create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> to show us."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 3, "creation_date": 1559752676, "post_id": 56464458, "comment_id": 99520939, "body": "A C compiler wouldn&#39;t combine calls to <code>usleep()</code>. Something else must be the cause."}, {"owner": {"reputation": 1, "user_id": 8179764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06318ae382c66077e7392a1b812b62f0?s=128&d=identicon&r=PG&f=1", "display_name": "ab91", "link": "https://stackoverflow.com/users/8179764/ab91"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1559756513, "post_id": 56464458, "comment_id": 99522474, "body": "Here you go, an example @user3386109   char arr[6] = {&#39;h&#39;,&#39;e&#39;,&#39;l&#39;,&#39;l&#39;,&#39;o&#39;,&#39;!&#39;}; for(int x=0; x&lt;6 ; x++){     printf(&quot;%c&quot;,arr[x]);     usleep(1000000); }"}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 4, "creation_date": 1559756985, "post_id": 56464458, "comment_id": 99522639, "body": "Add <code>fflush(stdout);</code> after <code>printf</code>."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1559757294, "post_id": 56464458, "comment_id": 99522757, "body": "That&#39;s just output buffering. Duplicate of <a href=\"https://stackoverflow.com/questions/4201083/sleep-delays-output-until-end\" title=\"sleep delays output until end\">stackoverflow.com/questions/4201083/&hellip;</a>."}, {"owner": {"reputation": 1, "user_id": 8179764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06318ae382c66077e7392a1b812b62f0?s=128&d=identicon&r=PG&f=1", "display_name": "ab91", "link": "https://stackoverflow.com/users/8179764/ab91"}, "reply_to_user": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 0, "creation_date": 1559757717, "post_id": 56464458, "comment_id": 99522905, "body": "@HolyBlackCat TY! Looked into <a href=\"https://stackoverflow.com/questions/22901901/what-does-fflushstdin-do-in-c-programing\" title=\"what does fflushstdin do in c programing\">stackoverflow.com/questions/22901901/&hellip;</a>"}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1559793787, "post_id": 56464458, "comment_id": 99532451, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/q/7876660/608639\">How to turn off buffering of stdout in C</a>, <a href=\"https://stackoverflow.com/q/4201083/608639\">sleep() delays output until end</a>, etc"}], "answers": [{"comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1559797820, "post_id": 56470870, "comment_id": 99533223, "body": "&quot;<i>On systems where that is considered an error.</i>&quot; Which systems are those?"}, {"owner": {"reputation": 33990, "user_id": 14768, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/b6aMa.png?s=128&g=1", "display_name": "Joshua", "link": "https://stackoverflow.com/users/14768/joshua"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1559827504, "post_id": 56470870, "comment_id": 99547478, "body": "@melpomome: I encountered it on Linux a long time ago and switched to select with no handles."}], "tags": [], "owner": {"reputation": 33990, "user_id": 14768, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/b6aMa.png?s=128&g=1", "display_name": "Joshua", "link": "https://stackoverflow.com/users/14768/joshua"}, "is_accepted": false, "score": 0, "last_activity_date": 1559795072, "creation_date": 1559795072, "answer_id": 56470870, "question_id": 56464458, "link": "https://stackoverflow.com/questions/56464458/interleaved-usleep-functions-being-executed-together-is-this-compiler-optimiz/56470870#56470870", "title": "Interleaved usleep() functions being executed together. Is this compiler optimization?", "body": "<p>You are using <code>usleep()</code> wrong. Use <code>sleep(1)</code> instead.</p>\n\n<p>From <code>man usleep</code>:</p>\n\n<blockquote>\n  <p>EINVAL usec is greater than or equal to 1000000.  (On systems where that is considered an error.)</p>\n</blockquote>\n\n<p>Once you fix that you should do <code>fflush()</code> after <code>printf()</code> to avoid another surprise with output buffering.</p>\n"}], "owner": {"reputation": 1, "user_id": 8179764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06318ae382c66077e7392a1b812b62f0?s=128&d=identicon&r=PG&f=1", "display_name": "ab91", "link": "https://stackoverflow.com/users/8179764/ab91"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 70, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1559795072, "creation_date": 1559751762, "last_edit_date": 1559793858, "question_id": 56464458, "link": "https://stackoverflow.com/questions/56464458/interleaved-usleep-functions-being-executed-together-is-this-compiler-optimiz", "title": "Interleaved usleep() functions being executed together. Is this compiler optimization?", "body": "<p>I have a code that does something similar to the following repeatedly over a loop:</p>\n\n<pre><code>$ cat test.c\n#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n\nint main()\n{\n    char arr[6] = {'h','e','l','l','o','!'};\n    for(int x=0; x&lt;6 ; x++){\n        printf(\"%c\",arr[x]);\n        usleep(1000000);\n        printf(\"%c\",arr[x]);\n        usleep(1000000);\n    }\n    printf(\"\\n\");\n\n    return 0;\n}\n</code></pre>\n\n<p>I see that <code>printf()</code> executes one after the other WITHOUT any delay (due to <code>usleep</code>), and then the program sleeps for the total <code>usleep</code> time at the end before the next iteration. Seems like all the <code>usleep()</code> calls happen together in the end.</p>\n\n<p>I tried <code>-O0</code> flag in gcc, because I suspected its the effect of compiler optimization. But I guess <code>-O0</code> flag does not disable whatever optimization category this case falls under (if my guess is correct about the compiler being the reason for this behavior). </p>\n\n<p>I am trying to understand the reason for this behavior and how to achieve the desired behavior from my program.</p>\n\n<p>Note: I know it might be possible to replace <code>usleep()</code> with some compute-heavy function call that take an equivalent amount of time, but that is not the solution I am looking for.</p>\n"}, {"tags": ["c", "assembly", "gdb", "exploit", "objdump"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1559751787, "post_id": 56464411, "comment_id": 99520484, "body": "What there probably is is some kind of <code>ret</code> instruction. Which pops the return address from the stack. Which is how you make the program jump to your exploit: By overwriting the stack so the return address on the stack is what you put there."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1559751844, "post_id": 56464411, "comment_id": 99520514, "body": "Put that in a function you call."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 1, "creation_date": 1559752279, "post_id": 56464411, "comment_id": 99520741, "body": "There is no x86 machine instruction whose assembly notation is literally <code>jmp esp</code>.  There is an instruction whose assembly notation is <code>jmp dword ptr [esp]</code> in Intel-ese (encoded as 0xFF 0x24 0x24), and your <code>grep</code> would have found that if it had been generated, but I cannot think of any circumstances where a C compiler would ever generate that instruction.  Where did you read or hear that you should look for this instruction?"}, {"owner": {"reputation": 63, "user_id": 11347176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6c9895839952c77b196a8ba07897a9f?s=128&d=identicon&r=PG&f=1", "display_name": "microman", "link": "https://stackoverflow.com/users/11347176/microman"}, "edited": false, "score": 0, "creation_date": 1559752378, "post_id": 56464411, "comment_id": 99520797, "body": "I read it in a book. In other bof applications this worked..."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 1, "creation_date": 1559752406, "post_id": 56464411, "comment_id": 99520813, "body": "@bitfriends What is the name of this book, who wrote it, and what is its publication date?"}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1559752491, "post_id": 56464411, "comment_id": 99520855, "body": "@tadman In the code shown, the return from <code>main</code> would be exploitable, assuming no compiler mitigations (e.g. stack canaries)."}, {"owner": {"reputation": 63, "user_id": 11347176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6c9895839952c77b196a8ba07897a9f?s=128&d=identicon&r=PG&f=1", "display_name": "microman", "link": "https://stackoverflow.com/users/11347176/microman"}, "edited": false, "score": 0, "creation_date": 1559752518, "post_id": 56464411, "comment_id": 99520866, "body": "Its a book in german: Hacking und Security by Rheinwerk verlag. Its from 2018"}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 1, "creation_date": 1559752729, "post_id": 56464411, "comment_id": 99520957, "body": "@bitfriends This book: <a href=\"https://www.rheinwerk-verlag.de/hacking-security_4382/\" rel=\"nofollow noreferrer\">rheinwerk-verlag.de/hacking-security_4382</a> ?"}, {"owner": {"reputation": 63, "user_id": 11347176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6c9895839952c77b196a8ba07897a9f?s=128&d=identicon&r=PG&f=1", "display_name": "microman", "link": "https://stackoverflow.com/users/11347176/microman"}, "edited": false, "score": 0, "creation_date": 1559752768, "post_id": 56464411, "comment_id": 99520981, "body": "Yes, this book."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 1, "creation_date": 1559752952, "post_id": 56464411, "comment_id": 99521050, "body": "Thanks.  I regret to say I cannot afford to pay \u20ac 44,90 just to find out whether the book really says buffer overflows involve a <code>jmp esp</code> instruction.  My guess, though, is that you are taking its description of how function returns work on x86 a little too literally.  The instruction you should be looking for is spelled <code>ret</code>."}, {"owner": {"reputation": 63, "user_id": 11347176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6c9895839952c77b196a8ba07897a9f?s=128&d=identicon&r=PG&f=1", "display_name": "microman", "link": "https://stackoverflow.com/users/11347176/microman"}, "edited": false, "score": 0, "creation_date": 1559753146, "post_id": 56464411, "comment_id": 99521139, "body": "Ok. So the payload will look like this: <code>send = &quot;\\x41&quot;*65 + ret adress + payload</code> Or am i wrong?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1559753473, "post_id": 56464411, "comment_id": 99521266, "body": "If you really want to learn how to make exploits like this, you first of all need to learn the assembly language of the target platform."}, {"owner": {"reputation": 63, "user_id": 11347176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6c9895839952c77b196a8ba07897a9f?s=128&d=identicon&r=PG&f=1", "display_name": "microman", "link": "https://stackoverflow.com/users/11347176/microman"}, "edited": false, "score": 0, "creation_date": 1559753650, "post_id": 56464411, "comment_id": 99521307, "body": "Ok, i will do that. But can you help me nevertheless?"}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "reply_to_user": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 1, "creation_date": 1559766790, "post_id": 56464411, "comment_id": 99526695, "body": "@MichaelPetch I believe you are talking about the difference between the machine instruction 0xFF 0x24 0x24 and the machine instruction 0xFF 0x2C 0x24.  On my computer, the former disassembles as <code>jmp dword ptr [esp]</code> and the latter as <code>jmp fword ptr [esp]</code>.  <code>jmp esp</code> is actually accepted without complaint by my assembler, but produces the machine instruction 0xE9 0xFC 0xFF 0xFF 0xFF with a relocation for <code>esp</code> -- that is, near relative jump to the <i>symbol</i> <code>esp</code>.  I didn&#39;t mention that earlier because I thought it would just confuse OP even further."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1559781202, "post_id": 56464411, "comment_id": 99530435, "body": "@zwol: The OP is looking for a byte-sequence that in AT&amp;T syntax is <code>jmp *%esp</code>, to use as a target for an overwritten return-address (to defeat stack ASLR for an executable payload on the stack, assuming an executable stack).  Aka a &quot;ROP gadget&quot;.  See my answer on <a href=\"//security.stackexchange.com/q/157478\">Why JMP ESP instead of directly jumping into the stack</a> on security.SE.  The regex <code>jmp.*esp</code>  does match AT&amp;T <code>jmp *%esp</code> or Intel-syntax <code>jmp esp</code>.  But it misses the possibility of finding this <code>ff e4</code> 2-byte instruction inside the bytes that decode as a different instruction."}], "answers": [{"comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 63, "user_id": 11347176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6c9895839952c77b196a8ba07897a9f?s=128&d=identicon&r=PG&f=1", "display_name": "microman", "link": "https://stackoverflow.com/users/11347176/microman"}, "edited": false, "score": 0, "creation_date": 1559825392, "post_id": 56469745, "comment_id": 99546186, "body": "@bitfriends: that&#39;s a gcc option.  I said <i>compile</i> with, not debug with.  Also, my desktop has GDB version 8.2.1.  What kind of ancient system are you using with GDB 3?  But anyway, if your GCC + <code>ld</code> aren&#39;t from the last year or so, <code>.section .rodata</code> already gets linked into the (executable) text segment.  But you would still need <code>-z execstack</code> for the stack itself to be executable for your actual payload to run, not just the ret2reg gadget."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 63, "user_id": 11347176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6c9895839952c77b196a8ba07897a9f?s=128&d=identicon&r=PG&f=1", "display_name": "microman", "link": "https://stackoverflow.com/users/11347176/microman"}, "edited": false, "score": 0, "creation_date": 1559831946, "post_id": 56469745, "comment_id": 99550224, "body": "@bitfriends: That&#39;s a really ancient gcc version.  gcc4.x was current for a long time, but 3 is very old.  Anyway, if your linker is as old as your compiler, you don&#39;t need <code>-z execstack</code> to make a <code>const</code> array executable, it already is.  (But your stack normally won&#39;t be.)"}], "tags": [], "owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "is_accepted": false, "score": 1, "last_activity_date": 1559832053, "last_edit_date": 1559832053, "creation_date": 1559782509, "answer_id": 56469745, "question_id": 56464411, "link": "https://stackoverflow.com/questions/56464411/why-doesnt-my-c-program-have-a-jmp-esp-instruction-in-the-binary/56469745#56469745", "title": "Why doesn&#39;t my C program have a jmp esp instruction in the binary?", "body": "<p><strong>AT&amp;T <code>jmp *%esp</code>  /  Intel <code>jmp esp</code> has machine code <code>ff e4</code></strong>.  You should be looking for that byte sequence at any offset.<br>\n(I assembled a .s with that instruction and used <code>objdump -d</code> to get the machine code.)</p>\n\n<p>There is a lot of discussion in comments from people who thought you were talking about<br>\n<code>jmp *(%esp)</code> as a <code>ret</code> without pop.  For future readers, see <a href=\"https://security.stackexchange.com/questions/157478/why-jmp-esp-instead-of-directly-jumping-into-the-stack\">Why JMP ESP instead of directly jumping into the stack</a> on security.SE for more about this <strong>ret2reg</strong> technique to defeat stack ASLR when trying to return to your executable payload.  (But not defeating non-executable stacks, so this is rarely useful on its own in modern systems.)  It's a special case of a ROP gadget.</p>\n\n<hr>\n\n<p><strong>Compilers are never going to use that instruction intentionally, so you'll only ever find it as part of the bytes for another instruction, or in a non-code section.  Or not at all if no data happens to include it.</strong></p>\n\n<p>Also, your search method could miss it if it did occur.</p>\n\n<p><code>objdump | grep 'jmp.*esp'</code> is not good here.  That will miss <code>ff e4</code> as part of <code>mov eax, 0x1234e4ff</code> for example.  And disassembly of data sections similarly will only \"check\" bytes where objdump decides that an instruction starts.  (It doesn't do overlapping disassembly starting from every possible byte address; it gets to the end of one instruction and assumes the next instruction starts there.)</p>\n\n<hr>\n\n<p>But even so, I compiled your code with gcc8.2 with optimization disabled (<code>gcc -m32 foo.c</code>) and searched for <code>e4</code> bytes in the output of <code>hexdump -C</code>.  None of them were preceded by an <code>ff</code> byte.  (I tried again with <code>gcc -m32 -no-pie -fno-pie foo.c</code>, still no ff e4)</p>\n\n<p><strong>There's no reason to <em>expect</em> that to appear in a tiny executable</strong>.</p>\n\n<p>You could introduce one with a global <code>const unsigned char jmp_esp[] = { 0xff, 0xe4 };</code></p>\n\n<p>But note that modern toolchains (like late 2018 / 2019) put even the <code>.rodata</code> section in a non-executable segment.  So you'd need to compile with <code>-zexecstack</code> for byte sequences in non-code sections to be useful as gadgets.</p>\n\n<p>But you probably need <code>-z execstack</code> or something else to make the stack itself executable, for your payload itself to be in an executable page, not just a <code>jmp esp</code> in a <code>const</code> array.</p>\n\n<hr>\n\n<p>If you disabled library ASLR, then you could use an <code>ff e4</code> at a known address somewhere in libc.  But with normal randomization of library mapping addresses, it's probably just as easy to try to guess the stack address of your buffer directly, +- some bytes you fill with a NOP slide.  (Unless you can get the program you're attacking to leak a library address, defeating ASLR).</p>\n"}], "owner": {"reputation": 63, "user_id": 11347176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6c9895839952c77b196a8ba07897a9f?s=128&d=identicon&r=PG&f=1", "display_name": "microman", "link": "https://stackoverflow.com/users/11347176/microman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 816, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1568744234, "creation_date": 1559751571, "last_edit_date": 1568744234, "question_id": 56464411, "link": "https://stackoverflow.com/questions/56464411/why-doesnt-my-c-program-have-a-jmp-esp-instruction-in-the-binary", "title": "Why doesn&#39;t my C program have a jmp esp instruction in the binary?", "body": "<p>Why can you find <code>jmp esp</code> only in big applications? </p>\n\n<p>In this little program you cant find <code>jmp esp</code>. But why? \nThis is the source code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(int argc, char **argv)\n{\n    char buffer[64];\n\n    printf(\"Type in something: \");\n    gets(buffer);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "gcc", "x86", "callstack", "abi"], "comments": [{"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1559754069, "post_id": 56464391, "comment_id": 99521483, "body": "You seem to be confused about which way is <b>up</b> on the stack. But either way, EBP points to the middle. Function parameters are one direction, and local variables are the other direction relative to EBP. (That assumes of course that the function parameters are even on the stack, they could be passed in registers.) And yes, stack alignment is maintained by keeping the value in ESP aligned."}, {"owner": {"reputation": 513, "user_id": 6615337, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/Icgqz.jpg?s=128&g=1", "display_name": "Anthony O", "link": "https://stackoverflow.com/users/6615337/anthony-o"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1559754523, "post_id": 56464391, "comment_id": 99521692, "body": "I understand that the stack grows toward lower addresses, and I am referring to the lowest address on the stack as the top of the stack. How is the offset for the arguments being passed to the called function accounted for? The size of the argument region could be different every time. Are these arguments part of the previous stack frame? Where is the padding inserted on the stack?"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1559755128, "post_id": 56464391, "comment_id": 99521947, "body": "For functions with a fixed number of arguments, the offsets are computed at compile time. For functions with a variable number of arguments, the offsets are managed at runtime, see <code>man stdarg</code>. The arguments are at lower addresses than the local variables of the previous stack frame, and at higher addresses than the return address. So I&#39;d say they&#39;re between the two stack frames. The compiler reserves space for local variables in the new stack frame by subtracting some multiple of the alignment from ESP. The local variables are located (with padding as needed) within that reserved space."}, {"owner": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 0, "creation_date": 1559756108, "post_id": 56464391, "comment_id": 99522332, "body": "If the calling convention (for a 32-bit program) says that there is at least 16-byte alignment then the compiler (ie: GCC) will enforce it in code generation. The ABI has a stipulation that at the point just before doing a <i>CALL</i> instruction the stack must be 16-byte aligned. This includes to the function <code>main</code>. Right after the CALL instruction executes the stack is misaligned by 4 bytes (CALL instruction puts the 4-byte return address on the stack)."}, {"owner": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 0, "creation_date": 1559756258, "post_id": 56464391, "comment_id": 99522396, "body": "If you know that at the first instruction of a function that the stack is 4 byte misaligned (and was 16-byte aligned before the CALL) you can compute alignment of variables on the stack. If you have no stack frame in your function (don&#39;t do the traditional PUSH EBP, MOV EBP, ESP) you can subtract 12 from ESP to be aligned once again. If you push EBP that subtracts 4 so to get realigned you would need to subtract an additional 8."}, {"owner": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 0, "creation_date": 1559756407, "post_id": 56464391, "comment_id": 99522446, "body": "If you have local variables on the stack you can adjust the stack for those too. The compiler can compute the locations on the stack to properly align data. It is all based on the knowledge that you are guaranteed to be 4-byte misaligned when your function is executed and that before the CALL to your function it was aligned on a 16 byte boundary. This is all easy for a compiler to do, just more tedious for an assembly developer to do it by hand."}], "owner": {"reputation": 513, "user_id": 6615337, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/Icgqz.jpg?s=128&g=1", "display_name": "Anthony O", "link": "https://stackoverflow.com/users/6615337/anthony-o"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 79, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1559751485, "creation_date": 1559751485, "question_id": 56464391, "link": "https://stackoverflow.com/questions/56464391/how-are-ebp-esp-and-the-region-between-the-previous-esp-and-current-ebp-aligne", "title": "How are EBP, ESP, and the region between the previous ESP and current EBP aligned on the call stack by gcc?", "body": "<p>My understanding is that, to accomodate the x86 extension Streaming SIM Extensions (SSE) gcc aligns the stack on 16 byte boundaries. Consider ubuntu 16.04 (32-bit x86) with gcc version 4.8.4. What sections of the stack get aligned to a 16-byte boundary? </p>\n\n<p>My question as a whole is about data-alignment on the stack and how the stack is aligned by gcc. There are 3 positions I am curious about, EBP, ESP, and the region between the previous ESP and new EBP.</p>\n\n<p>From textbooks I know that EBP points to an address where the previous frame pointer is stored. Is EBP considered the bottom of the stack? Is there padding inserted before or after pushing the previous frame pointer to the stack? </p>\n\n<p>I also know that ESP points to the top of the stack. Must ESP also be 16 byte aligned? Is there padding placed at the top of the stack to align ESP to a 16 byte boundary?</p>\n\n<p>With most confusion, what about the regions of data between the new EBP and previous ESP. This is the place where function arguments and the return address in the caller are pushed. Are these considered to be part of the previous stack frame or current stack frame? How must this section of data be aligned?</p>\n\n<p>This is a grey area for me. I have analyzed the stack using gdb but it is not clear to me <strong>how</strong> the stack is aligned and <strong>why</strong> it is done that way. I hope that someone on SO can shed some light on the design of the call stack by gcc. </p>\n\n<p>In textbooks, the common description of the stack, is implementation agnostic and typically leaves out a discussion of alignment, padding, and the hard boundaries of the call stack. I have an image to include but am too new to the site to be allowed to post images.</p>\n"}, {"tags": ["c", "multidimensional-array", "pass-by-reference"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1559749307, "post_id": 56463756, "comment_id": 99519208, "body": "In C, all arrays are passed as a pointer of some sort \u2014 so the called function can modify the array in the calling function (unless there are <code>const</code> qualifiers on the declaration in the function to prevent such modifications).  Arrays are not copied in bulk."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1559749308, "post_id": 56463756, "comment_id": 99519209, "body": "FYI, the &quot;value&quot; of an array id in an expression (such as an argument to a function) is the base address of the first element. Think about that. If you want to really pass an array by value, bury it in a structure."}, {"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "edited": false, "score": 1, "creation_date": 1559751253, "post_id": 56463756, "comment_id": 99520202, "body": "Array expressions &quot;decay&quot; to pointer expressions unless they&#39;re the operands of the <code>sizeof</code> or unary <code>&amp;</code> operators - when you pass <code>a</code> to <code>elem</code>, it is implicitly converted to a pointer (<code>int (*a)[10]</code>) to the first element (<code>&amp;a[0]</code>) when the argument list is evaluated, so all <code>elem</code> receives is a pointer value.  It is not possible to pass an array expression as a parameter and have it interpreted as an array in the called function."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 1, "creation_date": 1559751806, "post_id": 56463756, "comment_id": 99520493, "body": "There is a bug in the <code>if</code> condition <code>if((--p&lt;m)&amp;&amp;(--q&lt;n))</code>. <code>q</code> is being compared (after decrementing) to the number of columns <code>n</code> instead of the number of rows <code>m</code>. Also, since you are checking the range of <code>p</code> and <code>q</code>, you ought to check for negative values too."}, {"owner": {"reputation": 177, "user_id": 6455667, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-1JxPIUTo54w/AAAAAAAAAAI/AAAAAAAAAbk/ZEp5-K4d0JI/photo.jpg?sz=128", "display_name": "Anchith Acharya", "link": "https://stackoverflow.com/users/6455667/anchith-acharya"}, "reply_to_user": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1559758679, "post_id": 56463756, "comment_id": 99523300, "body": "@Ian Abbot Indeed! I had only executed the program with square matrices until now, so I had never noticed the bug. Thanks for pointing it out!"}], "answers": [{"comments": [{"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1559751363, "post_id": 56463808, "comment_id": 99520263, "body": "Shouldn&#39;t that be <code>float c[10][10];</code>? Another option is to use a 1-D array <code>char row[10]</code>to store the matrix row indices instead of copying the whole matrix."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "reply_to_user": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1559753676, "post_id": 56463808, "comment_id": 99521316, "body": "@IanAbbott You&#39;re absolutely correct. Fixed it."}, {"owner": {"reputation": 177, "user_id": 6455667, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-1JxPIUTo54w/AAAAAAAAAAI/AAAAAAAAAbk/ZEp5-K4d0JI/photo.jpg?sz=128", "display_name": "Anchith Acharya", "link": "https://stackoverflow.com/users/6455667/anchith-acharya"}, "edited": false, "score": 0, "creation_date": 1559758305, "post_id": 56463808, "comment_id": 99523152, "body": "Thank you. I will try this this tomorrow and update the results, although I cannot use const because in my main program, the array needs to be manipulated quite a few times. I will try adding the temporary array though."}], "tags": [], "owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "is_accepted": true, "score": 5, "last_activity_date": 1559753662, "last_edit_date": 1559753662, "creation_date": 1559749280, "answer_id": 56463808, "question_id": 56463756, "link": "https://stackoverflow.com/questions/56463756/multidimensional-array-values-getting-modified-even-though-passed-by-value/56463808#56463808", "title": "Multidimensional array values getting modified even though passed by value", "body": "<blockquote>\n  <p>Why is this so?</p>\n</blockquote>\n\n<p>Yes, you ARE passing it \"by value\", but you have to understand what that means in C. When you pass an array to a function, it will <em>decay</em> to a pointer. That pointer is then passed by value, but the value is the address to the first element in the array.</p>\n\n<blockquote>\n  <p>and what can I do to make the array in main() remain unchanged?</p>\n</blockquote>\n\n<p>A few different things, depending on what you want. You could create a temporary array in the function and then copy all the values. Replace the start with:</p>\n\n<pre><code>void interchange(const float arr[10][10],int m,int n) {\n    float c[10][10];\n    for(int i=0; i&lt;10; i++)\n        for(int j=0; j&lt;10; j++)\n            c[i][j]=arr[i][j];\n</code></pre>\n\n<p>and your code would work the way you want, provided that there's no other bugs. The addition of <code>const</code> has the effect that you would get a compiler error if you tried to assign an element in <code>arr</code> to something.</p>\n"}, {"comments": [{"owner": {"reputation": 177, "user_id": 6455667, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-1JxPIUTo54w/AAAAAAAAAAI/AAAAAAAAAbk/ZEp5-K4d0JI/photo.jpg?sz=128", "display_name": "Anchith Acharya", "link": "https://stackoverflow.com/users/6455667/anchith-acharya"}, "edited": false, "score": 0, "creation_date": 1559758398, "post_id": 56463810, "comment_id": 99523182, "body": "Thank you. These things are very confusing!"}], "tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": false, "score": 6, "last_activity_date": 1559749285, "creation_date": 1559749285, "answer_id": 56463810, "question_id": 56463756, "link": "https://stackoverflow.com/questions/56463756/multidimensional-array-values-getting-modified-even-though-passed-by-value/56463810#56463810", "title": "Multidimensional array values getting modified even though passed by value", "body": "<p>For function arguments, you <em>can't</em> pass arrays \"by value\".</p>\n\n<p>When the compiler sees the argument declaration <code>float c[10][10]</code>, it translates it as <code>float (*c)[10]</code>.</p>\n\n<p>So what is passed is a <em>pointer</em> (to the first element of the array). You modify the memory that the pointer is pointing to, which reflect back in the calling function.</p>\n"}], "owner": {"reputation": 177, "user_id": 6455667, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-1JxPIUTo54w/AAAAAAAAAAI/AAAAAAAAAbk/ZEp5-K4d0JI/photo.jpg?sz=128", "display_name": "Anchith Acharya", "link": "https://stackoverflow.com/users/6455667/anchith-acharya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "closed_date": 1559749896, "accepted_answer_id": 56463808, "answer_count": 2, "score": 0, "last_activity_date": 1559753662, "creation_date": 1559749101, "last_edit_date": 1559750203, "question_id": 56463756, "link": "https://stackoverflow.com/questions/56463756/multidimensional-array-values-getting-modified-even-though-passed-by-value", "closed_reason": "Duplicate", "title": "Multidimensional array values getting modified even though passed by value", "body": "<p>I have passed a 2D array normally (by value) to a function \"elem\", which further passes it on to another function \"interchange\", which performs a row-interchange operation and displays it. But the problem is, after I return from interchange back to main(), the value of the array has been changed to the resultant array from interchange, even though technically they must be three different variables for three different functions (main, elem and interchange). Why is this so, and what can I do to make the array in main() remain unchanged?</p>\n\n<pre><code>//include files... \n\nvoid interchange(float c[10][10],int m,int n)\n{\n    int i,j,p,q;\n    float temp;\n\n        printf(\"\\nEnter the two row numbers to interchange:\");\n        scanf(\"%d%d\",&amp;p,&amp;q);\n\n        if((--p&lt;m)&amp;&amp;(--q&lt;n))\n        {\n            for(i=0;i&lt;m;i++)\n            {\n                temp=c[p][i];\n                c[p][i]=c[q][i];\n                c[q][i]=temp;\n            }\n        } else\n        {\n            printf(\"Row numbers must be less than matrix order.\\n\");\n            return;\n        }\n\n    printf(\"\\nResultant matrix is:\\n\"); //print the array in interchange,c\n    printf(\"\\n\");\n    for(i=0;i&lt;m;i++)\n        {for(j=0;j&lt;n;j++)\n            {\n                printf(\"%f\\t\",c[i][j]); \n            }\n         printf(\"\\n\");\n        }\n}\n\nvoid elem(float b[10][10],int m,int n)\n{\n    int ch;\n    do\n    {\n        printf(\"\\n1:Row interchange\\t 2:Exit elementary transformations\\n\\nEnter the choice:\");\n        scanf(\"%d\",&amp;ch);  //get user input to decide which operation to perform (there are more operations in actual code)\n\n        switch(ch)\n        {\n            case 1: interchange(b,m,n);\n                    break;\n\n            case 2: printf(\"\\nExiting elementary transformations.\\n\");\n                    break;\n        }\n\n    }while(ch!=2);\n}\n\nint main()\n{\n    float a[10][10];\n    int m,n,i,j;\n    printf(\"Enter the order of the matrix:\");\n    scanf(\"%d%d\",&amp;m,&amp;n);\n    printf(\"Enter the matrix elements:\");\n    for(i=0;i&lt;m;i++)\n    {\n        for(j=0;j&lt;n;j++)\n        {\n            scanf(\"%f\",&amp;a[i][j]);\n        }\n    }\n\n        //print the entered array a\n    printf(\"\\n\");\n    for(i=0;i&lt;m;i++)\n        {for(j=0;j&lt;n;j++)\n            {\n                printf(\"%f\\t\",a[i][j]); \n            }\n         printf(\"\\n\");\n        }\n\n    elem(a,m,n);\n\n        //print the original array in main()   \n        printf(\"\\n\");\n    for(i=0;i&lt;m;i++)\n        {for(j=0;j&lt;n;j++)\n            {\n                printf(\"%f\\t\",a[i][j]); \n            }\n         printf(\"\\n\");\n        }\n}\n</code></pre>\n\n<p>This is the output I got:</p>\n\n<pre><code>Enter the order of the matrix:2 2\nEnter the matrix elements:1 2 3 4\n\n1.000000        2.000000\n3.000000        4.000000\n\n1:Row interchange        2:Exit elementary transformations\n\nEnter the choice:1\n\nEnter the two row numbers to interchange:1 2\n\nResultant matrix is:\n\n3.000000        4.000000\n1.000000        2.000000\n\n1:Row interchange        2:Exit elementary transformations\n\nEnter the choice:2\n\nExiting elementary transformations.\n\n3.000000        4.000000\n1.000000        2.000000\n</code></pre>\n\n<p>Sorry for the shabby code, I salvaged it from a larger file.</p>\n"}, {"tags": ["c", "variables", "declaration", "definition"], "comments": [{"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 2, "creation_date": 1559748561, "post_id": 56463543, "comment_id": 99518742, "body": "Variables would be mostly useless if you could only assign a value to them once"}, {"owner": {"reputation": 480272, "user_id": 1968, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd630f72eef3790bfb4ef38d08c7f85?s=128&d=identicon&r=PG", "display_name": "Konrad Rudolph", "link": "https://stackoverflow.com/users/1968/konrad-rudolph"}, "reply_to_user": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 1, "creation_date": 1559748824, "post_id": 56463543, "comment_id": 99518924, "body": "@ChrisTurner There are many programming languages that operate exactly like that, and which are very useful."}, {"owner": {"reputation": 402, "user_id": 11527039, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd22ca322c7ea2174c1daf9628a2bc90?s=128&d=identicon&r=PG&f=1", "display_name": "EUS", "link": "https://stackoverflow.com/users/11527039/eus"}, "edited": false, "score": 2, "creation_date": 1559749009, "post_id": 56463543, "comment_id": 99519025, "body": "They are called variables for a reason too..."}, {"owner": {"reputation": 665, "user_id": 5142427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9b1c6286b57291f50a9ea186dbd03d7?s=128&d=identicon&r=PG&f=1", "display_name": "Bertrand Gazanion", "link": "https://stackoverflow.com/users/5142427/bertrand-gazanion"}, "edited": false, "score": 1, "creation_date": 1559749069, "post_id": 56463543, "comment_id": 99519066, "body": "@RATAN the variable is declared only once, when you do <code>int x ...</code>. What you did several time was assigning a value to the variable."}], "answers": [{"comments": [{"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 1, "creation_date": 1559749147, "post_id": 56463641, "comment_id": 99519114, "body": "Nice answer. I got a few things wrong, and when I saw your answer I did not see the point in correcting my answer. Upvoted."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 1, "creation_date": 1559749600, "post_id": 56463641, "comment_id": 99519361, "body": "@Broman: That&#39;s a shame: Stack Overflow works best when there are multiple answers."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1559749823, "post_id": 56463641, "comment_id": 99519496, "body": "@Bathsheba This answer covered everything I wanted to say. There&#39;s no point in adding an answer if your answer does not provide anything new."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1559750142, "post_id": 56463641, "comment_id": 99519678, "body": "<i>x = 10; isn\u2019t a definition. It\u2019s an assignment.</i>  The <code>x = 10</code> portion is an <i>initialization</i>, and that&#39;s different from an assignment."}, {"owner": {"reputation": 480272, "user_id": 1968, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd630f72eef3790bfb4ef38d08c7f85?s=128&d=identicon&r=PG", "display_name": "Konrad Rudolph", "link": "https://stackoverflow.com/users/1968/konrad-rudolph"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1559753604, "post_id": 56463641, "comment_id": 99521291, "body": "@AndrewHenle I was talking about the standalone statement, not the fragment <code>x = 10</code> as part of the statement <code>int x = 10;</code>."}], "tags": [], "owner": {"reputation": 480272, "user_id": 1968, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd630f72eef3790bfb4ef38d08c7f85?s=128&d=identicon&r=PG", "display_name": "Konrad Rudolph", "link": "https://stackoverflow.com/users/1968/konrad-rudolph"}, "is_accepted": false, "score": 9, "last_activity_date": 1559749020, "last_edit_date": 1559749020, "creation_date": 1559748722, "answer_id": 56463641, "question_id": 56463543, "link": "https://stackoverflow.com/questions/56463543/a-variable-function-can-be-declared-any-number-of-times-but-it-can-be-defined-on/56463641#56463641", "title": "a variable/function can be declared any number of times but it can be defined only once", "body": "<p><code>x = 10;</code> isn\u2019t a <em>definition</em>. It\u2019s an <em>assignment</em>. You can assign as many times as you like.</p>\n\n<p><code>int x;</code> is a <em>definition</em> (and, at the same time, also a declaration). Likewise, <code>extern int x;</code> is a <em>declaration</em> (without a definition). To illustrate the concept you were asking about, the following is valid C:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>// Duplicate declaration: OK\nextern int x;\nextern int x;\n\n// Definition: OK\nint x;\n// int x; // Duplicate definition: ERROR\n\n// Definition with initialisation: OK\nint y = 42;\n\n// (Re)assignment: OK inside function.\nx = 1;\ny = 2;\n</code></pre>\n\n<p>For functions, the syntax is different. To declare a function, write its prototype. To define it, add a function body:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>// Declaration:\nint f(void);\n// Also possible, but unnecessary:\nextern int f(void);\n\n// Definition:\nint f(void) { return 42; }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 171, "user_id": 2271564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9068834827b61bdfa8b263e9fa1f022?s=128&d=identicon&r=PG", "display_name": "Daniel Kappelle", "link": "https://stackoverflow.com/users/2271564/daniel-kappelle"}, "is_accepted": false, "score": -1, "last_activity_date": 1559749902, "creation_date": 1559749902, "answer_id": 56463990, "question_id": 56463543, "link": "https://stackoverflow.com/questions/56463543/a-variable-function-can-be-declared-any-number-of-times-but-it-can-be-defined-on/56463990#56463990", "title": "a variable/function can be declared any number of times but it can be defined only once", "body": "<p>I just wanted to add that you <em>would</em> get an error if you had defined the variable as a constant, i.e.</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>const int x = 10;\n\nx = 15; // This will throw a compile-time error\n</code></pre>\n\n<p>As constants may only be assigned once during definition, hence the name constant.</p>\n\n<p><a href=\"https://www.programiz.com/c-programming/c-variables-constants\" rel=\"nofollow noreferrer\">https://www.programiz.com/c-programming/c-variables-constants</a></p>\n"}], "owner": {"reputation": 11, "user_id": 11604828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ka3hyxyw0W0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfv5T5GxO8g_ByMDKlo0r58MTBY-g/mo/photo.jpg?sz=128", "display_name": "RATAN NAMPALLE", "link": "https://stackoverflow.com/users/11604828/ratan-nampalle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 836, "favorite_count": 1, "closed_date": 1559749999, "answer_count": 2, "score": 1, "last_activity_date": 1559752387, "creation_date": 1559748368, "last_edit_date": 1559748449, "question_id": 56463543, "link": "https://stackoverflow.com/questions/56463543/a-variable-function-can-be-declared-any-number-of-times-but-it-can-be-defined-on", "closed_reason": "Duplicate", "title": "a variable/function can be declared any number of times but it can be defined only once", "body": "<p>a variable/function can be declared any number of times but it can be defined only once.\nWhat does that actually mean??</p>\n\n<p>I tried to understand that statement on online compilers and I was expecting to show error but it didnt. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint x=10;\n\nint main() {\n    x=20;\n    x=30;\n\n    printf(\"%d\",x);\n}\n</code></pre>\n\n<p>expected output: i expected to show error because i have defined variable x and assigned three different values 10,20,30. the concept says you can declare variable any number of times but can define only once since two different locations cant be given to the same variable\nactual output: 30</p>\n"}, {"tags": ["c", "memory", "lexical-scope"], "comments": [{"owner": {"reputation": 5192, "user_id": 2318649, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rW1HG.jpg?s=128&g=1", "display_name": "barny", "link": "https://stackoverflow.com/users/2318649/barny"}, "edited": false, "score": 2, "creation_date": 1559748756, "post_id": 56463477, "comment_id": 99518878, "body": "NOT a good idea. &quot;block-scope&quot; does what it says on the can: the buffer is <i>not</i> valid outside its scope. The behaviour of your code will be undefined: it might appear to work, but may fail unpredictably/randomly/painfully and be a <i>big</i> maintenance problem."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 1, "creation_date": 1559751365, "post_id": 56463477, "comment_id": 99520265, "body": "Your title is malformed - <i>Is block-scope buffer valid outside of the block in c</i> -- the answer is yes, sometimes. What you are asking is, is buffer declared in a block valid AFTER it&#39;s lifetime?"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 5192, "user_id": 2318649, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rW1HG.jpg?s=128&g=1", "display_name": "barny", "link": "https://stackoverflow.com/users/2318649/barny"}, "edited": false, "score": 1, "creation_date": 1559752688, "post_id": 56463477, "comment_id": 99520944, "body": "@barny: You write that block-scope does what it says on the can but then misstate it. \u201cScope\u201d is about visibility. Scope is <b>where</b> an <b>identifier</b> is visible. The concept of <b>when</b> an <b>object</b> exists is lifetime or storage duration. Lifetime is related to scope because, for objects with automatic storage duration, their lifetime ends when execution of the associated block <b>ends</b>, but not when execution merely <b>leaves</b> the block temporarily. This results in objects being completely valid and accessible outside the scope of their identifiers, as when a subroutine is called."}], "answers": [{"comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 2, "creation_date": 1559750214, "post_id": 56463704, "comment_id": 99519716, "body": "It would be better characterized as an issue of <i>lifetime</i> than one of scope.  During its lifetime, an object can be accessed (through a pointer) even though its identifier is not in scope.  Outside an object&#39;s lifetime, on the other hand, there is no object to access, and attempts to access it produce UB."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 3, "last_activity_date": 1559748901, "creation_date": 1559748901, "answer_id": 56463704, "question_id": 56463477, "link": "https://stackoverflow.com/questions/56463477/is-block-scope-buffer-valid-outside-of-the-block-in-c/56463704#56463704", "title": "Is block-scope buffer valid outside of the block in c", "body": "<blockquote>\n  <p>This makes the assumption that the memory in foo_buf is still valid (and unchanged) outside of the block scope</p>\n</blockquote>\n\n<p>That's a big assumption.  Attempting to dereference memory to a variable that is no longer in scope invokes <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behavior</a>.  There is no guarantee that memory will contain what you think it will.</p>\n\n<p>It's better to either define that buffer at a higher scope where it will still be valid or to allocate memory dynamically so that it remains valid.</p>\n\n<p>Also, the type is not correct:</p>\n\n<pre><code>char * foo_buf[20];\n</code></pre>\n\n<p>This defines an array of pointers, not an array of characters.  It should be:</p>\n\n<pre><code>char foo_buf[20];\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "is_accepted": true, "score": 3, "last_activity_date": 1559749758, "last_edit_date": 1559749758, "creation_date": 1559748908, "answer_id": 56463706, "question_id": 56463477, "link": "https://stackoverflow.com/questions/56463477/is-block-scope-buffer-valid-outside-of-the-block-in-c/56463706#56463706", "title": "Is block-scope buffer valid outside of the block in c", "body": "<p>It's UB.</p>\n\n<p>Lifting <code>char * foo_buf[20];</code> up shouldn't give you worse code. All the function's locals are likely to be allocated at the top anyway and compilers are quite well capable of eliminating locals that get never used. </p>\n\n<p>Try compiling:</p>\n\n<pre><code>#define UP 0\n#define CONST 1\n\n#include &lt;stdio.h&gt;\n\n#if CONST\n   #define SOME_MACRO() 0\n#else\n   int SOME_MACRO(void);\n#endif\n\nint some_global;\n\n\nvoid some_func(void) {\n    const char * foo;\n\n#if UP\n    char foo_buf[20]; //fixed from char *foo_buf[20];\n#endif\n\n\n    if (SOME_MACRO()) {\n#if !UP\n       char foo_buf[20]; //fixed from char *foo_buf[20];\n#endif\n       snprintf(foo_buf,sizeof(foo_buf),\"blah_%d\",some_global);\n       foo = foo_buf;\n    } else {\n       foo = \"some constant string\";\n    }\n    // do a bunch of other stuff here...\n    printf(\"%s\\n\", foo);\n}\n</code></pre>\n\n<p>with with CONST set to either 0 or 1 and then changing UP to between 0 and 1.</p>\n\n<p>With gcc, clang, or icc moving the declaration (by changing <code>UP</code>) makes no difference even at <code>-O0</code>: <a href=\"https://gcc.godbolt.org/z/z9jnQD\" rel=\"nofollow noreferrer\">https://gcc.godbolt.org/z/z9jnQD</a>.</p>\n"}], "owner": {"reputation": 434, "user_id": 2766918, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b30ed3dc92a395952309d65497b3b872?s=128&d=identicon&r=PG&f=1", "display_name": "user2766918", "link": "https://stackoverflow.com/users/2766918/user2766918"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 56463706, "answer_count": 2, "score": 1, "last_activity_date": 1559749758, "creation_date": 1559748143, "last_edit_date": 1559748463, "question_id": 56463477, "link": "https://stackoverflow.com/questions/56463477/is-block-scope-buffer-valid-outside-of-the-block-in-c", "title": "Is block-scope buffer valid outside of the block in c", "body": "<p>I'm just wondering if the following can be considered safe practice:</p>\n\n<pre><code>void some_func(void) {\n    const char * foo;\n\n    if (SOME_MACRO()) {\n       char * foo_buf[20];\n       snprintf(foo_buf,sizeof(foo_buf),\"blah_%d\",some_global);\n       foo = foo_buf;\n    } else {\n       foo = \"some constant string\";\n    }\n    // do a bunch of other stuff here...\n    printf(\"%s\\n\", foo);\n}\n</code></pre>\n\n<p>This makes the assumption that the memory in <code>foo_buf</code> is still valid (and unchanged) outside of the block scope.   I'm concerned if there are any situations where the compiler discards or overwrites block specific memory when the block  has exited.   The reason I'd like the declaration in the block rather than in global scope is that on some platforms, <code>SOME_MACRO()</code> would resolve to a constant, in others, to an expression, so the code inside the if block can be optimized out in some cases.</p>\n"}, {"tags": ["c", "json", "arduino"], "answers": [{"comments": [{"owner": {"reputation": 109, "user_id": 11211982, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-zQFTJdkfrnw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rddpFHqO-iQU38KPOcaiumRCW-k8g/mo/photo.jpg?sz=128", "display_name": "Quang Minh L&#234;", "link": "https://stackoverflow.com/users/11211982/quang-minh-l%c3%aa"}, "edited": false, "score": 0, "creation_date": 1559791150, "post_id": 56463504, "comment_id": 99532031, "body": "For my project, i want to store data in json then i will send json this_node to other_node using RF24l01. i&#39;m not experienced with JSON before, sorry. can JSON do like this:  <code>const int BUFFER_SIZE = 48; &#47;&#47; Choose a suitable number here</code>  <code>char json[BUFFER_SIZE] = &quot;{\\&quot;Temperature\\&quot;:%f,\\&quot;Humidity\\&quot;:%f}&quot;, pack0.humidity, pack0.temperature); </code>"}], "tags": [], "owner": {"reputation": 1353, "user_id": 1306779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4rji2.png?s=128&g=1", "display_name": "jfowkes", "link": "https://stackoverflow.com/users/1306779/jfowkes"}, "is_accepted": true, "score": 0, "last_activity_date": 1559748234, "creation_date": 1559748234, "answer_id": 56463504, "question_id": 56463206, "link": "https://stackoverflow.com/questions/56463206/can-i-read-value-from-sensors-then-add-it-to-json-string-for-rf24l01-network/56463504#56463504", "title": "Can i read value from sensors then add it to JSON string for RF24l01 network", "body": "<p>Consider using <a href=\"https://arduinojson.org/\" rel=\"nofollow noreferrer\">ArduinoJson</a>, which will do the JSON encoding for you. The advantage of this library is that it makes it easy to modify your data schema at a later time.</p>\n\n<p>Or you can do it yourself by simply using <code>snprintf</code>:</p>\n\n<pre><code>const int BUFFER_SIZE = 48; // Choose a suitable number here\nchar json[BUFFER_SIZE];\nsnprintf(json, BUFFER_SIZE, \"{\\\"Temperature\\\":%f,\\\"Humidity\\\":%f}\", pack0.humidity, pack0.temperature);\n</code></pre>\n\n<p><code>json</code> will then contain your JSON data. Using <code>snprintf</code> ensures that the write will not overflow.</p>\n"}], "owner": {"reputation": 109, "user_id": 11211982, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-zQFTJdkfrnw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rddpFHqO-iQU38KPOcaiumRCW-k8g/mo/photo.jpg?sz=128", "display_name": "Quang Minh L&#234;", "link": "https://stackoverflow.com/users/11211982/quang-minh-l%c3%aa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 56463504, "answer_count": 1, "score": 0, "last_activity_date": 1559792346, "creation_date": 1559747121, "question_id": 56463206, "link": "https://stackoverflow.com/questions/56463206/can-i-read-value-from-sensors-then-add-it-to-json-string-for-rf24l01-network", "title": "Can i read value from sensors then add it to JSON string for RF24l01 network", "body": "<p>i read a few example and the value is string or number like this </p>\n\n<pre><code>json[] =\n      \"{\\\"sensor\\\":\\\"gps\\\",\\\"time\\\":1351824120,\\\"data\\\":[48.756080,2.302038]}\";\n</code></pre>\n\n<p>For example i have 2 values: </p>\n\n<pre><code>pack0.humidity = dht.readHumidity();\npack0.temperature = dht.readTemperature();\n</code></pre>\n\n<p>Can i read those temp and humid and add it to json in loop()\nlike this </p>\n\n<pre><code>  json[] =\n          \"{\\\"Temperature\\\": /*temp here*/,\n           \\\"Humidity\\\":/*humid here*/}\";\n</code></pre>\n\n<p>Could anyone give me example for my project. thanks a lot.\nMy current code for rf24</p>\n\n<pre><code>struct package0\n  {\n    float temperature = 0;\n    float humidity = 0;\n    int soil = 0;\n  };\n  typedef struct package0 Package0;\n  Package0 pack0;\nvoid loop()\n{\n  delay(2000);\n  pack0.humidity = dht.readHumidity();\n  pack0.temperature = dht.readTemperature();\n  pack0.soil = map(analogRead(SOILPIN), 0, 4096, 100, 0);//convert to percentage\n  if (isnan(pack0.humidity) || isnan(pack0.temperature))\n  {\n    Serial.println(F(\"Failed to read from DHT sensor!\"));\n    return;\n  }\n  RF24NetworkHeader header(master00);\n  bool ok = network.write(header, &amp;pack0, sizeof(pack0));\n</code></pre>\n"}, {"tags": ["c", "macos", "include-path"], "comments": [{"owner": {"reputation": 4654, "user_id": 332733, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BR7yE.jpg?s=128&g=1", "display_name": "Mgetz", "link": "https://stackoverflow.com/users/332733/mgetz"}, "edited": false, "score": 2, "creation_date": 1559746817, "post_id": 56463049, "comment_id": 99517743, "body": "<code>malloc.h</code> does not appear to be <a href=\"https://en.cppreference.com/w/c/header\" rel=\"nofollow noreferrer\">a standard conforming header</a> so no your installation is fine and conformant."}, {"owner": {"reputation": 2385, "user_id": 2565958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be3bcf62e85eadc0ff5d40429813e2a3?s=128&d=identicon&r=PG", "display_name": "donjuedo", "link": "https://stackoverflow.com/users/2565958/donjuedo"}, "edited": false, "score": 0, "creation_date": 1559746820, "post_id": 56463049, "comment_id": 99517746, "body": "How could it run (and seg fault), if no malloc.h is found?  Without a needed header, it ought not build."}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 4, "creation_date": 1559746831, "post_id": 56463049, "comment_id": 99517754, "body": "To use <i>malloc</i> you have to <code>#include &lt;stdlib.h&gt;</code>, not <i>malloc.h</i>"}, {"owner": {"reputation": 4654, "user_id": 332733, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BR7yE.jpg?s=128&g=1", "display_name": "Mgetz", "link": "https://stackoverflow.com/users/332733/mgetz"}, "edited": false, "score": 0, "creation_date": 1559746936, "post_id": 56463049, "comment_id": 99517813, "body": "A little further research shows that header to be glibc specific, and non-portable."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1559750316, "post_id": 56463049, "comment_id": 99519767, "body": "If you commented out the #include of malloc.h, the compiler would have assumed <code>malloc()</code> returns <code>int</code>, probably a 32-bit int.  But on a 64-bit platform, including modern Macs, pointers are 64 bits.  So if the compiler thinks <code>malloc</code> returns int, the top 32 bits of the pointer values get scraped off, and this <i>definitely</i> leads to things like &quot;bombing immediately with a seg fault&quot;."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 4654, "user_id": 332733, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BR7yE.jpg?s=128&g=1", "display_name": "Mgetz", "link": "https://stackoverflow.com/users/332733/mgetz"}, "edited": false, "score": 0, "creation_date": 1559750819, "post_id": 56463049, "comment_id": 99520021, "body": "@Mgetz, <code>malloc.h</code> is certainly non-standard and thus non-portable, but it is not a glibc invention, nor specific to that implementation.  FreeBSD&#39;s C library has it, for example.  Glibc provides it to support non-conforming programs that depend on it."}, {"owner": {"reputation": 4654, "user_id": 332733, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BR7yE.jpg?s=128&g=1", "display_name": "Mgetz", "link": "https://stackoverflow.com/users/332733/mgetz"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1559751697, "post_id": 56463049, "comment_id": 99520445, "body": "@JohnBollinger I could not find a POSIX reference for it and only found it on the GLIBC docs. Hence my statement"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1559752106, "post_id": 56463049, "comment_id": 99520649, "body": "BSD (and System V) existed before POSIX.  Glibc has rather a lot of features aimed at supporting code written for one or the other of those using facilities that never were standardized anywhere."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1559752952, "post_id": 56463049, "comment_id": 99521052, "body": "I remember getting the impression that <code>&lt;malloc.h&gt;</code> first originated in old C compilers for MS-DOS, and that gcc and a few other Unix compilers/libraries added it just to coddle all the DOS-written code out there."}], "answers": [{"tags": [], "owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "is_accepted": true, "score": 5, "last_activity_date": 1559747407, "last_edit_date": 1559747407, "creation_date": 1559746845, "answer_id": 56463133, "question_id": 56463049, "link": "https://stackoverflow.com/questions/56463049/should-mac-osx-have-a-malloc-h-file/56463133#56463133", "title": "Should Mac OSX have a &quot;malloc.h&quot; file?", "body": "<p>The <code>malloc.h</code> is deprecated and should not be used. It contains some non-standard functions too. If you want to use <code>malloc</code>, then include <code>stdlib.h</code>. Not even the C89 standard mentions <code>malloc.h</code></p>\n\n<p>If it's the cause of your problems, I don't know, but it's quite probable.</p>\n"}, {"tags": [], "owner": {"reputation": 2385, "user_id": 2565958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be3bcf62e85eadc0ff5d40429813e2a3?s=128&d=identicon&r=PG", "display_name": "donjuedo", "link": "https://stackoverflow.com/users/2565958/donjuedo"}, "is_accepted": false, "score": 0, "last_activity_date": 1559747109, "creation_date": 1559747109, "answer_id": 56463202, "question_id": 56463049, "link": "https://stackoverflow.com/questions/56463049/should-mac-osx-have-a-malloc-h-file/56463202#56463202", "title": "Should Mac OSX have a &quot;malloc.h&quot; file?", "body": "<p>The listing below can provide ideas on where the file <em>should/could</em> be found.  I can't explain the segfault without more details, though.  I do not see how it could be related to malloc() in any way.</p>\n\n<pre><code>/Library/Developer/CommandLineTools/SDKs/MacOSX.sdk/usr/include/sys/malloc.h\n/Library/Developer/CommandLineTools/SDKs/MacOSX.sdk/usr/include/malloc/malloc.h\n/Library/Developer/CommandLineTools/SDKs/MacOSX.sdk/System/Library/Frameworks/Kernel.framework/Versions/A/Headers/sys/malloc.h\n/Applications/Xcode.app/Contents/Developer/Platforms/AppleTVOS.platform/Developer/SDKs/AppleTVOS.sdk/usr/include/malloc/malloc.h\n/Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/SDKs/iPhoneOS.sdk/usr/include/malloc/malloc.h\n/Applications/Xcode.app/Contents/Developer/Platforms/WatchOS.platform/Developer/SDKs/WatchOS.sdk/usr/include/malloc/malloc.h\n/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX.sdk/usr/include/sys/malloc.h\n/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX.sdk/usr/include/malloc/malloc.h\n/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX.sdk/System/Library/Frameworks/Kernel.framework/Versions/A/Headers/sys/malloc.h\n/Applications/Xcode.app/Contents/Developer/Platforms/WatchSimulator.platform/Developer/SDKs/WatchSimulator.sdk/usr/include/malloc/malloc.h\n/Applications/Xcode.app/Contents/Developer/Platforms/AppleTVSimulator.platform/Developer/SDKs/AppleTVSimulator.sdk/usr/include/malloc/malloc.h\n/Applications/Xcode.app/Contents/Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator.sdk/usr/include/malloc/malloc.h\n$ \n</code></pre>\n"}], "owner": {"reputation": 5213, "user_id": 1380285, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f9a9583aed6db34815797c68823225b9?s=128&d=identicon&r=PG", "display_name": "bob.sacamento", "link": "https://stackoverflow.com/users/1380285/bob-sacamento"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5590, "favorite_count": 0, "closed_date": 1559750163, "accepted_answer_id": 56463133, "answer_count": 2, "score": 2, "last_activity_date": 1559748729, "creation_date": 1559746574, "last_edit_date": 1559748729, "question_id": 56463049, "link": "https://stackoverflow.com/questions/56463049/should-mac-osx-have-a-malloc-h-file", "closed_reason": "Duplicate", "title": "Should Mac OSX have a &quot;malloc.h&quot; file?", "body": "<p>A customer's code is expecting to find an include file <code>malloc.h</code> in one of the \"usual suspect\" locations.  On my Mac, AFAICT, there is no <code>malloc.h</code>, at least not in any place you would expect to find it, such as <code>/usr/include</code>, <code>/usr/local/include</code>, or <code>/opt/local/include</code>.  Since the <code>malloc()</code> is usually defined in <code>stdlib.h</code>, and since the code includes stdlib.h anyway, I was able to get the code to build by just commenting out the few includes of <code>malloc.h</code>.  I am building with <code>gcc</code>.</p>\n\n<p>But two questions:  Is my gcc messed up somehow?  Should that file be there?  Also, the code bombs almost immediately with a seg fault that I haven't been able to track down yet.  Could this be the consequence of using the wrong <code>malloc()</code>?</p>\n"}, {"tags": ["c", "struct", "language-lawyer", "union"], "answers": [{"comments": [{"owner": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "edited": false, "score": 0, "creation_date": 1559744816, "post_id": 56462325, "comment_id": 99516571, "body": "<i>That is for the access purpose.</i> Can you please expand a bit? <i>The members of an anonymous structure or union are considered to be members of the containing structure or union.</i> goes in the semantic section while the fact that <code>union</code>s cannot contain flexible array members is constraint. So it looks a bit contradictory to me that we can interpret things in the <i>Semantic</i> as a a violation of constraint..."}, {"owner": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "edited": false, "score": 0, "creation_date": 1559745632, "post_id": 56462325, "comment_id": 99517046, "body": "After thinking about it for a while <i>That is for the access purpose.</i> definitely makes sense. I removed my previous comment."}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 6, "last_activity_date": 1559746008, "last_edit_date": 1559746008, "creation_date": 1559744067, "answer_id": 56462325, "question_id": 56462177, "link": "https://stackoverflow.com/questions/56462177/union-with-anonymous-struct-with-flexible-array-member/56462325#56462325", "title": "Union with anonymous struct with flexible array member", "body": "<p>The second case fails to compile, because flexible array member is a property of a structure type, not for unions. That's straightforward. </p>\n\n<p>Next, in the first case, trying to access <code>b[0]</code> would be undefined behavior, as no memory has been allocated for that.</p>\n\n<p>Quoting <code>C11</code>, \u00a76.7.2.1/P18</p>\n\n<blockquote>\n  <p>As a special case, the last element of a structure with more than one named member may\n  have an incomplete array type; this is called a flexible array member. [...] If this array would have no elements, it behaves as if\n  it had one element but the behavior is undefined if any attempt is made to access that\n  element or to generate a pointer one past it.</p>\n</blockquote>\n\n<p>That said,</p>\n\n<blockquote>\n  <p><em>The members of an anonymous structure or union are considered to be members of the containing structure or union.</em></p>\n</blockquote>\n\n<p>That is for the access purpose, the layout remains unchanged. See, in your first example, you're accessing <code>a</code> (and <code>b</code>) as if they are direct members of the union.</p>\n\n<p>To clarify,</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nunion test{\n    struct {\n        int p;\n        float q;\n    } t;                //named structure member\n  struct {\n      int a;\n      int b[];\n  };\n    char pqr;\n};\n\n\nint main(void){\n    union test test;\n    test.t.p = 20;   // you have to use the structure member name to access the elements\n    test.pqr = 'c';     // direct access, as member of union\n    test.a = 10;        // member of anonymous structure, so it behaves as if direct member of union\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "edited": false, "score": 0, "creation_date": 1559744263, "post_id": 56462343, "comment_id": 99516252, "body": "But since in the first case the structure is an anonymous so the members of the structure should be considered as members of the containing union making the union to contain a flexible array member. As I quoted <i>The members of an anonymous structure or union are considered to be members of the containing structure or union.</i>"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "edited": false, "score": 0, "creation_date": 1559744333, "post_id": 56462343, "comment_id": 99516286, "body": "@SomeName Just addressed this in my answer. :)"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1559744387, "post_id": 56462343, "comment_id": 99516325, "body": "One difference is that the offset of <code>b</code> in <code>union test</code> cannot be 0 \u2014 which is completely different from normal members of a union.  Normally, all members of a union start at offset 0.  Mostly, though, that says that given a variable <code>union test u;</code>, you can refer to <code>u.a</code> and <code>u.b</code>.  In times past, you would have had to specify a name for the structure: <code>union test { struct { int a; int b[]; } s; };</code> and have used <code>u.s.a</code> or <code>u.s.b</code> to access the elements of the structure within the union.  That doesn&#39;t affect where a flexible array member is allowed; only the notation used to access it."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1559745134, "post_id": 56462343, "comment_id": 99516754, "body": "Now, you see, when you put \u201c<i>must</i>\u201d in italics like that, then we have go to digging through the C standard to see if it is true. What if I put the structure in <code>union foo</code> with another member that is an array of a bazillion <code>char</code>? Then defining <code>union foo x</code> allocates plenty of memory. Can I use the flexible array member then?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 3, "creation_date": 1559745775, "post_id": 56462343, "comment_id": 99517134, "body": "Please don&#39;t change the question once you&#39;ve got answers \u2014 at least not in a way that invalidates parts of those answers."}], "tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": false, "score": 6, "last_activity_date": 1559800207, "last_edit_date": 1559800207, "creation_date": 1559744137, "answer_id": 56462343, "question_id": 56462177, "link": "https://stackoverflow.com/questions/56462177/union-with-anonymous-struct-with-flexible-array-member/56462343#56462343", "title": "Union with anonymous struct with flexible array member", "body": "<p>The (C11) standard says in <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.7.2.1p3\" rel=\"nofollow noreferrer\">\u00a76.7.2.1 Structure and union specifiers \u00b63</a> \u2014 a constraint:</p>\n\n<blockquote>\n  <p>\u00b63 A structure or union shall not contain a member with incomplete or function type (hence, a structure shall not contain an instance of itself, but may contain a pointer to an instance of itself), except that the last member of a structure with more than one named member may have incomplete array type; such a structure (and any union containing, possibly recursively, a member that is such a structure) shall not be a member of a structure or an element of an array.</p>\n</blockquote>\n\n<p>Note that only structures can (directly) contain a flexible array member \u2014 unions cannot.</p>\n\n<p>The first case is legitimate.  The second is not.</p>\n\n<p>(It's <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.7.2.1p18\" rel=\"nofollow noreferrer\">\u00a76.7.2.1 \u00b618</a> that defines the term <em>flexible array member</em>.)</p>\n\n<p>Incidentally, in the first <a href=\"https://stackoverflow.com/revisions/56462177/1\">version</a> of the question, the <code>printf()</code> statement in the first example was accessing an element of the array that was not allocated \u2014 a defect that has since been fixed in revision 2.  Writing <code>union test test;</code> gives you an array of size 0.  You <em>must</em> use dynamic memory allocation (or some other <a href=\"https://stackoverflow.com/questions/56462177/union-with-anonymous-struct-with-flexible-array-member/56462343#comment99516754_56462343\">mechanism</a>) to allocate a union or structure with sufficient space for a non-empty FAM. Similar comments applied to the second example too.</p>\n\n<p><a href=\"https://stackoverflow.com/users/8990329/some-name\">Some Name</a> says in a <a href=\"https://stackoverflow.com/questions/56462177/union-with-anonymous-struct-with-flexible-array-member/56462343#comment99516252_56462343\">comment</a></p>\n\n<blockquote>\n  <p>But since in the first case the structure is an anonymous so the members of the structure should be considered as members of the containing union making the union to contain a flexible array member. As I quoted <em>The members of an anonymous structure or union are considered to be members of the containing structure or union.</em></p>\n</blockquote>\n\n<p>Note that the anonymous structure doesn't lose its shape just because it is embedded into a union.  One difference is that the offset of <code>b</code> in <code>union test</code> cannot be 0 \u2014 which is completely different from normal members of a union.  Normally, all members of a union start at offset 0.  Mostly, though, that says that given a variable <code>union test u;</code>, you can refer to <code>u.a</code> and <code>u.b</code>.  In times past, you would have had to specify a name for the structure: <code>union test { struct { int a; int b[]; } s; };</code> and have used <code>u.s.a</code> or <code>u.s.b</code> to access the elements of the structure within the union.  That doesn't affect where a flexible array member is allowed; only the notation used to access it.</p>\n"}, {"comments": [{"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1590422097, "post_id": 56462766, "comment_id": 109667104, "body": "DR 502 has apparently not actually been accepted, according to the minutes of the April 2018 meeting (n2239.pdf). What I find interesting here is that the logic in DR502 which would allow <code>struct { int i; struct { int a[]; }; };</code> would also allow <code>struct { int i; union { int a[]; };};</code> (IMO). In practice, neither clang nor gcc seem to allow either of these. (I noticed this today because I tried to remove the 0 from a header which included <code>struct { ...; union { char* c; Node* n[0]; }; };</code>, which both gcc and clang seem to be happy with, thanks to the gcc extension.)"}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1590422537, "post_id": 56462766, "comment_id": 109667305, "body": "Here&#39;s a better reference for DR502 having been closed: <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n2257.htm#dr_502\" rel=\"nofollow noreferrer\">open-std.org/jtc1/sc22/wg14/www/docs/n2257.htm#dr_502</a>. So I guess I&#39;m out of luck here. According to that resolution, &quot;the effect is easily achieved.&quot; I supposed the simple resolution for me is to change the 0 to a 1."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1590432578, "post_id": 56462766, "comment_id": 109672173, "body": "Thanks, @rici, it appears that the committee changed course between 10/2016 and 4/2017.  That was not evident from the document I was relying upon (and that I linked), but it is abundantly clear from your link.  I will revise the answer shortly."}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 14, "last_activity_date": 1590434464, "last_edit_date": 1590434464, "creation_date": 1559745619, "answer_id": 56462766, "question_id": 56462177, "link": "https://stackoverflow.com/questions/56462177/union-with-anonymous-struct-with-flexible-array-member/56462766#56462766", "title": "Union with anonymous struct with flexible array member", "body": "<p><strong>NOTE: this answer has been substantively modified since first being written, reflecting a change to the committee's position after publication of the documents on which the original version of the answer relied.</strong></p>\n\n<blockquote>\n  <p>The members of an anonymous structure or union are considered to be members of the containing structure or union.</p>\n</blockquote>\n\n<p>This is a tricky provision to interpret, and indeed it has been the subject of at least two defect reports against the standard.  The intention, as supported by the committee in its response to <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/summary.htm#dr_499\" rel=\"nofollow noreferrer\">DR 499</a> is that anonymous structures are treated for layout purposes as if the structure itself were the member of the containing structure or union, but access to its members is <em>expressed</em> as if they were members of the containing structure or union.  </p>\n\n<p><s>The accepted position on <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/summary.htm#dr_502\" rel=\"nofollow noreferrer\">DR 502</a>, on the other hand, holds that even an anonymous struct containing a flexible array member as its <em>only</em> member is allowed if it is the last member of the structure (not union) containing it, and at least one other precedes it.</p>\n\n<p>I find those a bit inconsistent, but the unifying theme across them seems to be that the intent of the standard in this area comes down to <em>layout</em>.  A flexible array member inside an anonymous struct is allowed as long as it comes at the end of the layout of the innermost named structure or union, which must have non-zero size from consideration of the other members, taking into consideration the fact that members of an anonymous struct do not overlap, regardless of whether the anonymous struct appears inside a union.</s></p>\n\n<p>The proposed committee response to <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n2257.htm#dr_502\" rel=\"nofollow noreferrer\">DR 502</a> (which differs from its initial position) is consistent with that.  It holds that anonymous structures inside a structure or union must obey the same rules as other structures with respect to flexible array members, notwithstanding the provision you ask about.</p>\n\n<p>The committee does not appear to have decided the specific question you asked, but the theme of its decisions seems clear: the \"considered to be members of the containing structure or union\" wording is intended to be interpreted narrowly, as a statement only about the syntax for accessing members of anonymous structures and unions.  Thus, that provision has nothing to say about whether anonymous structures may contain FAMs, and the general rules about when and where they may do apply.  Those rules allow your first case.</p>\n"}, {"comments": [{"owner": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "edited": false, "score": 0, "creation_date": 1559746711, "post_id": 56462949, "comment_id": 99517657, "body": "Is the part you emphasized already added into some draft? If so could you please give a reference? N1570 does not contain it."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "reply_to_user": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "edited": false, "score": 1, "creation_date": 1559747252, "post_id": 56462949, "comment_id": 99518034, "body": "@SomeName. Done."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1559766453, "post_id": 56462949, "comment_id": 99526545, "body": "Has the intention of the Committee mattered in the last decade or so?  The authors of the Standard clearly and explicitly stated in their published Rationale a desire to uphold the Spirit of C and the principles behind it, and many &quot;ambiguities&quot; would be irrelevant for a compilers that try to uphold the Spirit of C.  The Standards Committee never intended that compiler writers focus on whether various useful behaviors are mandated by the Standard, or are merely &quot;popular extensions&quot; which quality compilers will support, but which aren&#39;t required for conformance."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "reply_to_user": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1559766991, "post_id": 56462949, "comment_id": 99526779, "body": "@supercat: the intentions of the committee matter to the people who care about the intentions of the committee. I believe all major compilers are represented on the committee; other than that, I suppose the document matters most to those who for some reason regard it as biblical. I don&#39;t fall into that category; I think we both agree that common sense is a better guide."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 1, "creation_date": 1559768995, "post_id": 56462949, "comment_id": 99527555, "body": "@rici: I would think common sense would imply that if <code>u</code> is the address of a union with member <code>um</code> of struct type <code>T</code> with member <code>sm</code>, a sequence like <code>T *p = &amp;u-&gt;m; p-&gt;sm = 123;</code> should be equivalent to <code>u-&gt;m.sm = 123;</code>, at least in cases where nothing (except <code>p</code>) accesses or addresses the union between the formation of <code>p</code> and the last use thereof.  I can&#39;t really think what else the address-of operator would usefully mean.  Neither gcc nor clang recognize such equivalence, however."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "reply_to_user": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1559872262, "post_id": 56462949, "comment_id": 99563824, "body": "@supercat: Sorry, you lost me. Does your example have something to do with this question? Does it relate to some other question on SO which I haven&#39;t happened to see? A simple -O3 -S gcc-8 test compile showed the same assembly code generated for both expressions. So what am I missing?"}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 1, "creation_date": 1559884841, "post_id": 56462949, "comment_id": 99565904, "body": "There are many situations where what used to be common sense would suggest that compilers should support constructs beyond what the Standard would mandate, but where compiler writers treat the lack of a mandate as an invitation to break such constructs.  Common sense carries no weight with the way some compilers treat unions.  I would think common sense would imply that code which takes the address of a union member should be able to access it at least in cases where a compiler could see that was the last action done with the union lvalue.  If common sense isn&#39;t honored there..."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 1, "creation_date": 1559884852, "post_id": 56462949, "comment_id": 99565908, "body": "...I wouldn&#39;t rely on it being honored anywhere."}], "tags": [], "owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "is_accepted": false, "score": 3, "last_activity_date": 1559747219, "last_edit_date": 1559747219, "creation_date": 1559746202, "answer_id": 56462949, "question_id": 56462177, "link": "https://stackoverflow.com/questions/56462177/union-with-anonymous-struct-with-flexible-array-member/56462949#56462949", "title": "Union with anonymous struct with flexible array member", "body": "<p>It was certainly always the intention that untagged composites in an anonymous composite retain their shape. But that was not explicit in the wording of &sect;6.7.2.1p13. The wording was revised tin C18 to: (emphasis added):</p>\n\n<blockquote>\n  <ol start=\"13\">\n  <li>An unnamed member whose type specifier is a structure specifier with no tag is called an anonymous structure; an unnamed member whose type specifier is a union specifier with no tag is called an anonymous union. The members of an anonymous structure or union are considered to be members of the containing structure or union, <strong>keeping their structure or union layout</strong>. This applies recursively if the containing structure or union is also anonymous.</li>\n  </ol>\n</blockquote>\n\n<p>See <a href=\"http://www.iso-9899.info/wiki/The_Standard\" rel=\"nofollow noreferrer\">http://www.iso-9899.info/wiki/The_Standard</a> for links to the C18 standard and <a href=\"https://web.archive.org/web/20181230041359if_/http://www.open-std.org/jtc1/sc22/wg14/www/abq/c17_updated_proposed_fdis.pdf\" rel=\"nofollow noreferrer\">freely-available draft (pdf)</a></p>\n"}], "owner": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 935, "favorite_count": 0, "accepted_answer_id": 56462766, "answer_count": 4, "score": 15, "last_activity_date": 1590434464, "creation_date": 1559743648, "last_edit_date": 1559745893, "question_id": 56462177, "link": "https://stackoverflow.com/questions/56462177/union-with-anonymous-struct-with-flexible-array-member", "title": "Union with anonymous struct with flexible array member", "body": "<p>Consider the following two examples:</p>\n\n<p>1.</p>\n\n<pre><code>union test{\n  struct {\n      int a;\n      int b[];\n  };\n};\n\n\nint main(void){\n    union test test;\n    test.a = 10;\n    printf(\"test.b[0] = %d\", test.b[0]); //prints 0, UB?\n}\n</code></pre>\n\n<p><a href=\"https://coliru.stacked-crooked.com/a/ffba25e3823b8621\" rel=\"noreferrer\">DEMO</a></p>\n\n<p>2.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nunion test{\n    int a;\n    int b[]; //error: flexible array member in union\n};\n\n\nint main(void){\n    union test test;\n    test.a = 10;\n    printf(\"test.b[0] = %d\", test.b[0]);\n}\n</code></pre>\n\n<p><a href=\"https://coliru.stacked-crooked.com/a/4ae29bb27c90529d\" rel=\"noreferrer\">DEMO</a></p>\n\n<p>The behavior is unclear. I expected the examples would behave the same (i.e. the first example would also fail to compile) since <code>6.7.2.1(p13)</code>:</p>\n\n<blockquote>\n  <p>The members of an anonymous structure or union are considered to be\n  members of the containing structure or union.</p>\n</blockquote>\n\n<p>So I interpreted the wording as if a <code>union</code> contains an anonymous <code>struct</code> as a member the members of the anonymous <code>struct</code> would be considered as members of the containing <code>union</code>.</p>\n\n<p><strong><em>Question</em>:</strong> Why does the first example compile fine instead of failing as the second one?</p>\n"}, {"tags": ["c", "binary", "double"], "comments": [{"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 1, "creation_date": 1559750778, "post_id": 56462164, "comment_id": 99520002, "body": "1) Which websites? 2) How did you get your result? 3) share the code!"}, {"owner": {"reputation": 21, "user_id": 8171662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b135269775381ad4082be9371c37ac0?s=128&d=identicon&r=PG&f=1", "display_name": "Selva Bharathi", "link": "https://stackoverflow.com/users/8171662/selva-bharathi"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1559835175, "post_id": 56462164, "comment_id": 99552033, "body": "#include&lt;stdio.h&gt;        int main()        { \u200bint i; \u200bdouble a = 5.2; \u200bchar *ptr; \u200bptr = (char *)&amp;a; \u200bfor(i=0;i&lt;=7;i++) \u200bprintf(\u201c%d\\n\u201d,*ptr++); \u200breturn 0;        }"}], "answers": [{"tags": [], "owner": {"reputation": 5397, "user_id": 11294831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M9BL5.png?s=128&g=1", "display_name": "the busybee", "link": "https://stackoverflow.com/users/11294831/the-busybee"}, "is_accepted": false, "score": 1, "last_activity_date": 1559744910, "creation_date": 1559744910, "answer_id": 56462563, "question_id": 56462164, "link": "https://stackoverflow.com/questions/56462164/5-2-recurring-binary-how-to-calculate-the-binary-value/56462563#56462563", "title": "5.2 recurring binary how to calculate the binary value", "body": "<p>If you express a decimal fractional number like \"###.2\" in a binary fractional number it will be a repeating binary fractional number.</p>\n\n<p>It is infinitely repeating because 0.2 can't be expressed as an finite (limited) sum of binary digits right of the \"decimal\" point. The first bit stands for 2^(-1)=0.5, the second bit stands for 2^(-2)=0.25 and so on. Just try it for yourself.</p>\n\n<p>If you look at the bit pattern of 5.25, it will be not repeating.</p>\n\n<p>Please read these articles: <a href=\"https://en.wikipedia.org/wiki/Fraction_(mathematics)\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/Fraction_(mathematics)</a> and <a href=\"https://en.wikipedia.org/wiki/Repeating_decimal\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/Repeating_decimal</a>.</p>\n\n<p>As a <code>double</code> has a limited size the infinitely repeating number has to be cut at some point. And so in the first case the representation was rounded down, and in the second case it was rounded up.</p>\n\n<p>For some more information see <a href=\"https://stackoverflow.com/questions/803225/when-should-i-use-double-instead-of-decimal\">When should I use double instead of decimal?</a> even it's for C#.</p>\n"}], "owner": {"reputation": 21, "user_id": 8171662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b135269775381ad4082be9371c37ac0?s=128&d=identicon&r=PG&f=1", "display_name": "Selva Bharathi", "link": "https://stackoverflow.com/users/8171662/selva-bharathi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1561045134, "creation_date": 1559743620, "question_id": 56462164, "link": "https://stackoverflow.com/questions/56462164/5-2-recurring-binary-how-to-calculate-the-binary-value", "title": "5.2 recurring binary how to calculate the binary value", "body": "<p>double 5.2 number when i find the binary value of this recurring binary i get as\n01000000 00010100 11001100 11001100 11001100 11001100 11001100 11001100\nlike this when i print the binary value programmatically and refering the websites it is something like this\n01000000 00010100 11001100 11001100 11001100 11001100 11001100 11001101\nhow to calculate the binary bits of a double.</p>\n\n<p>According to my answer it should print as \n-52 -52 -52 -52 -52 -52 20 64\nbut the real answer is \n-51 -52 -52 -52 -52 -52 20 64\nhow does that one bit change?</p>\n"}, {"tags": ["c", "gcc", "dll", "linker", "mingw"], "owner": {"reputation": 51, "user_id": 10326262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2435a99f33e60a42bfcc3d1d7e826f9c?s=128&d=identicon&r=PG&f=1", "display_name": "iocapa", "link": "https://stackoverflow.com/users/10326262/iocapa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 83, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1559742245, "creation_date": 1559742245, "question_id": 56461756, "link": "https://stackoverflow.com/questions/56461756/export-custom-linker-section-in-dll-using-mingw", "title": "Export custom linker section in DLL using MinGW", "body": "<p>I`m trying to build a shared object with MinGW (DLL in this case) which contains a bunch of functions that i want to access through a linker generated list by using:</p>\n\n<p><strong>attribute</strong>((section(\"my_custom_section\"))). </p>\n\n<p>I also want to have my export table free of anything but the two linker generated symbols (__start_my_custom_section, __stop_my_custom_section).</p>\n\n<p>I tried to give different attributes to the variables inside the custom section, including \"used\".\nWhen I inspect the dll with Dependency walker, i get nothing.\nI also tried to put </p>\n\n<p>__declspec(dllexport) extern fp_t __start_my_custom_section;\ninside the header file.</p>\n\n<p>I actually tried everything I could find (visibility, gc-off, etc..) but nothing seems to work.</p>\n\n<pre><code>//header.h\ntypedef void (* fp_t)(void);\n\n#define ADD_FUNC(name) \\\nvoid function_##name(void); \\\n__attribute__((section(\"custom_section\"))) \\\nfp_t function_##name##_data = function_##name \\\nvoid function_##name(void)\n\n//source1.c\nADD_FUNC(foo)\n{\n    //do stuff;\n}\n\n//source2.c\nADD_FUNC(bar)\n{\n    //do stuff;\n}\n</code></pre>\n\n<p>The main problem is that i need to do this inside the header without involving any extra source.</p>\n\n<p>This works as long as there is a variable initialized with __start/__stop, but obviously i cannot put a variable inside the header since a conflict will arise.</p>\n\n<p>Another solution would be to link a extra source file that contains these variables, but i would like to avoid that.</p>\n\n<p>Basically i'm asking if there is a way to force the custom linker generated symbols inside the dll export table, without involving DEF files, or any other extra files, only by using a single header file that I include in [1..n] C files containing functions that get a pointer added inside the custom section.</p>\n"}, {"tags": ["c", "stm32", "eeprom", "nucleo"], "comments": [{"owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 0, "creation_date": 1559739999, "post_id": 56460930, "comment_id": 99513719, "body": "It doesn&#39;t look like this part has EEPROM. It has 4 KB of SRAM that can be battery-backed and used as non-volatile memory. Please take time to do research on the part you&#39;re using."}, {"owner": {"reputation": 11, "user_id": 11604115, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebf673c027101da1cbeb7057558d64e5?s=128&d=identicon&r=PG&f=1", "display_name": "Vandini", "link": "https://stackoverflow.com/users/11604115/vandini"}, "reply_to_user": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 0, "creation_date": 1559886364, "post_id": 56460930, "comment_id": 99566300, "body": "how can I access SRAM to store my data even after power off?"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 11604115, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebf673c027101da1cbeb7057558d64e5?s=128&d=identicon&r=PG&f=1", "display_name": "Vandini", "link": "https://stackoverflow.com/users/11604115/vandini"}, "edited": false, "score": 0, "creation_date": 1559797123, "post_id": 56461227, "comment_id": 99533071, "body": "I am interested in changing the IP of the board.IP of the board changes(I am able to ping it) but once I reset it, it automatically takes the default IP which I had set in STM32 CubeMX. How can I save the changed IP in permanent memory."}, {"owner": {"reputation": 6873, "user_id": 5131711, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z5oP7.png?s=128&g=1", "display_name": "followed Monica to Codidact", "link": "https://stackoverflow.com/users/5131711/followed-monica-to-codidact"}, "reply_to_user": {"reputation": 11, "user_id": 11604115, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebf673c027101da1cbeb7057558d64e5?s=128&d=identicon&r=PG&f=1", "display_name": "Vandini", "link": "https://stackoverflow.com/users/11604115/vandini"}, "edited": false, "score": 0, "creation_date": 1559808156, "post_id": 56461227, "comment_id": 99537115, "body": "An IP Address can be stored in 4 bytes. When the flash is erased, all bytes are set to 255. As <code>255.255.255.255</code> is not a valid IP address, you can simply look for the first unused slot in the flash block, and write the address there. At startup, look for the last valid record in the flash. When the flash sector is full, erase it and start over."}, {"owner": {"reputation": 11, "user_id": 11604115, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebf673c027101da1cbeb7057558d64e5?s=128&d=identicon&r=PG&f=1", "display_name": "Vandini", "link": "https://stackoverflow.com/users/11604115/vandini"}, "edited": false, "score": 0, "creation_date": 1559813875, "post_id": 56461227, "comment_id": 99539975, "body": "can we do it directly using header files stm32f2xx_hal_flash.h  and stm32f2xx_hal_flash.h?           I am programming it on keil version 5."}, {"owner": {"reputation": 6873, "user_id": 5131711, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z5oP7.png?s=128&g=1", "display_name": "followed Monica to Codidact", "link": "https://stackoverflow.com/users/5131711/followed-monica-to-codidact"}, "reply_to_user": {"reputation": 11, "user_id": 11604115, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebf673c027101da1cbeb7057558d64e5?s=128&d=identicon&r=PG&f=1", "display_name": "Vandini", "link": "https://stackoverflow.com/users/11604115/vandini"}, "edited": false, "score": 0, "creation_date": 1559816909, "post_id": 56461227, "comment_id": 99541604, "body": "There should be a couple of example programs shipped with the HAL library that use this interface. If you can&#39;t find them, download the whole <a href=\"https://www.st.com/en/embedded-software/stm32cubef2.html\" rel=\"nofollow noreferrer\">STM32CubeF2 package</a>."}, {"owner": {"reputation": 11, "user_id": 11604115, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebf673c027101da1cbeb7057558d64e5?s=128&d=identicon&r=PG&f=1", "display_name": "Vandini", "link": "https://stackoverflow.com/users/11604115/vandini"}, "edited": false, "score": 0, "creation_date": 1559886538, "post_id": 56461227, "comment_id": 99566342, "body": "I just matched the address of the variable IP_ADDRESS (where it is stored in memory). I got to know that it is stored at address 0x2000 0018 which is the address in sram. i want that if I change the value of this variable then on resetting it should hold the changed value."}, {"owner": {"reputation": 6873, "user_id": 5131711, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z5oP7.png?s=128&g=1", "display_name": "followed Monica to Codidact", "link": "https://stackoverflow.com/users/5131711/followed-monica-to-codidact"}, "reply_to_user": {"reputation": 11, "user_id": 11604115, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebf673c027101da1cbeb7057558d64e5?s=128&d=identicon&r=PG&f=1", "display_name": "Vandini", "link": "https://stackoverflow.com/users/11604115/vandini"}, "edited": false, "score": 0, "creation_date": 1559888221, "post_id": 56461227, "comment_id": 99566847, "body": "<b>Don&#39;t change the RAM contents directly.</b> That address might change whenever you introduce a new variable in the program, and you&#39;d end up changing some unrelated variable to the stored IP address. To find out by name which variable is stored at the address, <a href=\"https://stackoverflow.com/questions/51190256/how-to-enable-the-linker-map-file-generation-in-keil\">generate a linker map file</a> and find the address in it. Now you can track it down in the source code, and find out how it is initialized."}], "tags": [], "owner": {"reputation": 6873, "user_id": 5131711, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z5oP7.png?s=128&g=1", "display_name": "followed Monica to Codidact", "link": "https://stackoverflow.com/users/5131711/followed-monica-to-codidact"}, "is_accepted": false, "score": 2, "last_activity_date": 1559740359, "creation_date": 1559740359, "answer_id": 56461227, "question_id": 56460930, "link": "https://stackoverflow.com/questions/56460930/stm32f207-nucleo144-board-writing-in-permanent-memory/56461227#56461227", "title": "STM32F207 Nucleo144 board, writing in permanent memory", "body": "<p>STM32F2 controllers don't have internal EEPROM memory.</p>\n\n<p>They have FLASH instead, with only 10000 guaranteed erase cycles, and comparatively large erase block size at 128 kBytes. AFAIK it does not support read-while-write operations, so the whole system comes to a stillstand while contents are updated.</p>\n\n<p>It'd be still useful for storing stuff that does not change too often, e.g. user preferences or calibration values.</p>\n\n<p>Unlike some other controller series, flash write functionality is described in a separate document, the <a href=\"https://www.st.com/resource/en/programming_manual/cd00233952.pdf\" rel=\"nofollow noreferrer\">STM32F207 Flash programming manual</a>. There are no \"read functions\", since its contents can be read as any other internal memory cell.</p>\n"}], "owner": {"reputation": 11, "user_id": 11604115, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebf673c027101da1cbeb7057558d64e5?s=128&d=identicon&r=PG&f=1", "display_name": "Vandini", "link": "https://stackoverflow.com/users/11604115/vandini"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 383, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1559740359, "creation_date": 1559739311, "question_id": 56460930, "link": "https://stackoverflow.com/questions/56460930/stm32f207-nucleo144-board-writing-in-permanent-memory", "title": "STM32F207 Nucleo144 board, writing in permanent memory", "body": "<p>I am currently working on Nucleo f207zg. \nI want to write its variables into its permanent memory (EEPROM).\nHow can I achieve it?</p>\n\n<p>I am unable to find read or write functions for the same.</p>\n"}, {"tags": ["c", "filter", "mask", "can-bus", "esp32"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1559740120, "post_id": 56460727, "comment_id": 99513779, "body": "You probably just want to do <code>acceptance_mask = 0x30 | 0x31 | ... | 0x35</code>. Then invert it all with <code>~</code> if needed."}], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 11509480, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-926bWVrkejE/AAAAAAAAAAI/AAAAAAAAAEA/4hto-_rbifs/photo.jpg?sz=128", "display_name": "Philipp Fu", "link": "https://stackoverflow.com/users/11509480/philipp-fu"}, "edited": false, "score": 0, "creation_date": 1559742395, "post_id": 56461778, "comment_id": 99515153, "body": "Yes, the Problem is that i need to use also Extended ID&#39;s.  So i think the only Option is to implement an Software Filter."}, {"owner": {"reputation": 2422, "user_id": 9112798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e2689048404de2b747c712b6782e8c7?s=128&d=identicon&r=PG&f=1", "display_name": "David Collins", "link": "https://stackoverflow.com/users/9112798/david-collins"}, "reply_to_user": {"reputation": 65, "user_id": 11509480, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-926bWVrkejE/AAAAAAAAAAI/AAAAAAAAAEA/4hto-_rbifs/photo.jpg?sz=128", "display_name": "Philipp Fu", "link": "https://stackoverflow.com/users/11509480/philipp-fu"}, "edited": false, "score": 0, "creation_date": 1559742474, "post_id": 56461778, "comment_id": 99515204, "body": "@PhilippFu: Thanks for clarifying."}, {"owner": {"reputation": 65, "user_id": 11509480, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-926bWVrkejE/AAAAAAAAAAI/AAAAAAAAAEA/4hto-_rbifs/photo.jpg?sz=128", "display_name": "Philipp Fu", "link": "https://stackoverflow.com/users/11509480/philipp-fu"}, "edited": false, "score": 0, "creation_date": 1559743046, "post_id": 56461778, "comment_id": 99515567, "body": "Thank you for the help :)"}], "tags": [], "owner": {"reputation": 2422, "user_id": 9112798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e2689048404de2b747c712b6782e8c7?s=128&d=identicon&r=PG&f=1", "display_name": "David Collins", "link": "https://stackoverflow.com/users/9112798/david-collins"}, "is_accepted": false, "score": 1, "last_activity_date": 1559742311, "creation_date": 1559742311, "answer_id": 56461778, "question_id": 56460727, "link": "https://stackoverflow.com/questions/56460727/can-controller-acceptance-filtering-with-the-sja1000-esp32/56461778#56461778", "title": "CAN-Controller acceptance filtering with the SJA1000 (ESP32)", "body": "<p>It seems to me that what you are trying to achieve is not possible if you are using a single filter. For example, you could define</p>\n\n<pre><code>   .acceptance_code = 0x30,\n   .acceptance_mask = 0x03,\n</code></pre>\n\n<p>This would accept IDs in the range 0x30 to 0x33 - but exclude 0x34 and 0x35.</p>\n\n<p>On the other hand, with <code>acceptance code = 0x34</code> and <code>acceptance mask = 0x01</code> you would be allowing 0x34 and 0x35 - but excluding 0x30 - 0x33.</p>\n\n<p>I notice that the acceptance filter can be placed in a <em>dual</em> filter mode, however - with the proviso that it can not be used to filter an extended ID. Maybe this will allow you to define complementary filters as defined above.</p>\n"}, {"tags": [], "owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "is_accepted": true, "score": 1, "last_activity_date": 1559900052, "last_edit_date": 1559900052, "creation_date": 1559742319, "answer_id": 56461781, "question_id": 56460727, "link": "https://stackoverflow.com/questions/56460727/can-controller-acceptance-filtering-with-the-sja1000-esp32/56461781#56461781", "title": "CAN-Controller acceptance filtering with the SJA1000 (ESP32)", "body": "<p>You probably cannot filter all unwanted messages. But you can narrow down a bit.\nFor a suitable mask you must treat the ones and the zeros separately.</p>\n\n<pre><code>uint32 mask_ones = mask_zeros = ~0;\n\nfor (int id = startId; id &lt; endId; id++)\n{\n  mask_ones  &amp;=  id;\n  mask_zeros &amp;= ~id;\n}\nuint32 mask = mask_ones | mask_zeroes;\nuint32 value = startId &amp; mask;\n</code></pre>\n\n<p>This creates a mask which includes all bits that are set to 1 in every allowed value and also all bits that are set to 0 in every allowed value.\nThis should get rid of all values above <code>0x37</code>.</p>\n\n<p>Example:</p>\n\n<pre><code>ones = zeros = 11111111\nCAN Message: 30 110000 =&gt; mask_ones = 00110000; mask_zeros = 11001111\nCAN Message: 31 110001 =&gt; mask_ones = 00110000; mask_zeros = 11001110\nCAN Message: 32 110010 =&gt; mask_ones = 00110000; mask_zeros = 11001100\nCAN Message: 33 110011 =&gt; mask_ones = 00110000; mask_zeros = 11001100\nCAN Message: 34 110100 =&gt; mask_ones = 00110000; mask_zeros = 11001000\nCAN Message: 35 110101 =&gt; mask_ones = 00110000; mask_zeros = 11001000\nunwanted:\nCAN Message: 36 110110\nCAN Message: 37 110111\nCAN Message: 38 111000\n\nmask =  00110000 | 11001000 = 11111000 = 0xF8\nvalue =  00110000 &amp; 11111000 = 00110000 = 0x30\n</code></pre>\n\n<p>Update:\nThe calculation above was broken. Fixed it.</p>\n"}], "owner": {"reputation": 65, "user_id": 11509480, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-926bWVrkejE/AAAAAAAAAAI/AAAAAAAAAEA/4hto-_rbifs/photo.jpg?sz=128", "display_name": "Philipp Fu", "link": "https://stackoverflow.com/users/11509480/philipp-fu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 686, "favorite_count": 1, "accepted_answer_id": 56461781, "answer_count": 2, "score": 4, "last_activity_date": 1559900052, "creation_date": 1559738598, "question_id": 56460727, "link": "https://stackoverflow.com/questions/56460727/can-controller-acceptance-filtering-with-the-sja1000-esp32", "title": "CAN-Controller acceptance filtering with the SJA1000 (ESP32)", "body": "<p>I'm try to use the acceptance filter from the SJA1000 CAN-Controller on a ESP23. \nThe Messages should be filtered in a defined area (e.g. Arbitration ID from: 0x30 to: 0x35).</p>\n\n<p>Example for filtering a single message (0x30):</p>\n\n<pre><code>#define CAN_FILTER_CONFIG_ACCEPT()  {.acceptance_code = 0x1500000, .acceptance_mask = 0xffffff, .single_filter = true}\n</code></pre>\n\n<p>If I want to filter a defined area (0x30 - 0x35):</p>\n\n<pre><code>int calc_mask(int startID, int endID) {\n    int size_of_range = endID - startID;\n    unsigned int acceptance_mask = 0xFFFFFFFF;\n    int i;\n\n    for (i = startID; i &lt;= endID; i++ {\n    acceptance_mask = ~(acceptance_mask &amp; i);\n    }\n\n    return acceptance_mask;     \n}\n\nacceptance_code = 0x30;\nacceptance_mask = calc_mask(0x30, 0x35);\n</code></pre>\n\n<blockquote>\n  <p>0x30 : 110000<br>\n  NAND  0x31: 110001<br>\n  NAND  0x32: 110010<br>\n  NAND  0x33: 110011<br>\n  NAND  0x34: 110100<br>\n  NAND  0x35: 110101<br>\n  0xF : 001111<br>\n  acceptance_code = 0x6000000: 0000 0110 0000 0000 0000 0000 0000 0000<br>\n  acceptance_mask = 0x1FFFFFF: 0000 0001 1111 1111 1111 1111 1111 1111 </p>\n</blockquote>\n\n<p>filtered Messages:<br>\n    wanted:<br>\n    14:21:17.754 -> CAN Message: 30  110000<br>\n    14:21:17.754 -> CAN Message: 31  110001<br>\n    14:21:17.787 -> CAN Message: 32  110010<br>\n    14:21:17.787 -> CAN Message: 33  110011<br>\n    14:21:17.787 -> CAN Message: 34  110100<br>\n    14:21:17.821 -> CAN Message: 35  110101<br>\n    unwanted:<br>\n    14:21:17.821 -> CAN Message: 36  110110<br>\n    14:21:17.821 -> CAN Message: 37  110111<br>\n    14:21:17.855 -> CAN Message: 38  111000<br>\n    14:21:17.855 -> CAN Message: 39  111001<br>\n    14:21:17.855 -> CAN Message: 3A  111010<br>\n    14:21:17.889 -> CAN Message: 3B  111011<br>\n    14:21:17.889 -> CAN Message: 3C  111100<br>\n    14:21:17.889 -> CAN Message: 3D  111101<br>\n    14:21:17.923 -> CAN Message: 3E  111110<br>\n    14:21:17.923 -> CAN Message: 3F  111111  </p>\n\n<p>Documentation ESP32 CAN-Controller (Acceptance Filter):<br>\n<a href=\"https://docs.espressif.com/projects/esp-idf/en/latest/api-reference/peripherals/can.html#acceptance-filter\" rel=\"nofollow noreferrer\">https://docs.espressif.com/projects/esp-idf/en/latest/api-reference/peripherals/can.html#acceptance-filter</a></p>\n\n<p>Documentation SJA1000 CAN-Controller (6.4.15 Acceptance filter):\n<a href=\"https://www.nxp.com/docs/en/data-sheet/SJA1000.pdf\" rel=\"nofollow noreferrer\">https://www.nxp.com/docs/en/data-sheet/SJA1000.pdf</a>  </p>\n\n<p>Does anyone have an idea how to get the not wanted Messages filtered?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 9, "creation_date": 1559738804, "post_id": 56460697, "comment_id": 99512968, "body": "No, and do not worry about defining new variables. The compiler will optimize the code. The \u201cStore return value\u201d example above would likely result in the compiler testing the response in the register the function returned it in, without moving it to any other place, and, if it returns, it would just do its normal return without needing to move the value, since it is already in the correct place to be returned. In other words, the code likely compiles to a test and a branch. The code in C is just an expression of the end result, not directions to produce certain assembly instructions."}, {"owner": {"reputation": 259, "user_id": 4526054, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N5Ub5.jpg?s=128&g=1", "display_name": "brhans", "link": "https://stackoverflow.com/users/4526054/brhans"}, "edited": false, "score": 2, "creation_date": 1559738820, "post_id": 56460697, "comment_id": 99512977, "body": "What problem are you actually trying to fix?"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 4, "creation_date": 1559738822, "post_id": 56460697, "comment_id": 99512978, "body": "Why is defining a new variable a problem?"}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 3, "creation_date": 1559739154, "post_id": 56460697, "comment_id": 99513182, "body": "I smell an XY-problem here. What is the actual problem? Neither of your approaches is bad in any way, provided that the function does not have side effects. If it has side effects, use the variable approach."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1559739184, "post_id": 56460697, "comment_id": 99513201, "body": "Just curious: What happens if the return value is 0?"}, {"owner": {"reputation": 682, "user_id": 5153899, "user_type": "registered", "accept_rate": 88, "profile_image": "https://graph.facebook.com/10206733961404743/picture?type=large", "display_name": "Alexander", "link": "https://stackoverflow.com/users/5153899/alexander"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1559740779, "post_id": 56460697, "comment_id": 99514141, "body": "@SouravGhosh 7 eats 9"}], "answers": [{"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1559741355, "post_id": 56461084, "comment_id": 99514458, "body": "In the shell, <code>$?</code> is a &#39;global variable&#39; and global variables are bad.  C shouldn&#39;t (and doesn&#39;t) have an analogous mechanism."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1559741851, "post_id": 56461084, "comment_id": 99514807, "body": "I don&#39;t see how the Bash stuff is relevant here - why mention something from another language which doesn&#39;t apply to C?"}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 1, "creation_date": 1559742075, "post_id": 56461084, "comment_id": 99514964, "body": "@4386427 I just thought it was a good idea to show an example of where it is actually possible."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1559742554, "post_id": 56461084, "comment_id": 99515257, "body": "@Broman hmm... then we could make examples from all kind of languages in C answers - not sure I would like that."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1559742777, "post_id": 56461084, "comment_id": 99515408, "body": "@4386427 I did it because it&#39;s simply not possible at all in C. How would I do an example in C in this case?"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1559743005, "post_id": 56461084, "comment_id": 99515545, "body": "@Broman well, in my mind it would be sufficient to state that it&#39;s not possible in C - end of story. OP is asking about C so no reason to tell about Bash, Perl, java, python,.... To me it just makes the answer confusing but ... well, never mind"}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1559743050, "post_id": 56461084, "comment_id": 99515569, "body": "@4386427 I think it added to the answer in this particular case. If you disagree, feel free to down vote."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1559743162, "post_id": 56461084, "comment_id": 99515635, "body": "@4386427 Hehe. Furthermore, I think the benefits both of including and excluding that snippet is so minor that it&#39;s not worth further discussion. :)"}], "tags": [], "owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "is_accepted": true, "score": 4, "last_activity_date": 1559743958, "last_edit_date": 1559743958, "creation_date": 1559739798, "answer_id": 56461084, "question_id": 56460697, "link": "https://stackoverflow.com/questions/56460697/can-i-access-a-functions-return-value-twice-without-storing-it-in-a-variable-or/56461084#56461084", "title": "Can I access a functions return value twice without storing it in a variable or calling the function again?", "body": "<p>No, it is completely impossible. If you want to use the return value from a function twice, you either have to store it in a variable or call the function again.</p>\n\n<p>In Bash, there is a feature which kind of is what you want. There, the <em>latest</em> exit code (return value) is stored in a builtin global variable called <code>$?</code>, but this feature does not exist in C, and I cannot really see the point either in a language like C. A similar snippet in Bash could look like this:</p>\n\n<pre><code>if ! my_command; then\n    exit \"$?\"\nfi\n</code></pre>\n\n<p>But Bash is a completely different language. I cannot see how such a feature would be good in C.</p>\n\n<p>I would go for the first option with declaring a new variable. The second option is also fine <em>provided</em> that the function has no side effects.</p>\n\n<blockquote>\n  <p>without defining a new variable</p>\n</blockquote>\n\n<p>Technically, this is possible to fulfill by reusing an old variable, but that is not a good solution. Don't do it.</p>\n\n<p>One thing you can do that prevents future use of the variable is to put everything in a scope. This is the C equivalent of the C++ code Bathsheba showed in another answer.</p>\n\n<pre><code>{ // Extra brace\nint response = id_data_valid(data);\nif (response != 0) {\n    return response;\n}}\n\n// Now response has gone out of scope, so this would be an error\nif(response == 0) { \n</code></pre>\n\n<p>In one way, this is a good thing to do, because it encapsulates temporary variables. But on the other hand, if you really need this construct, it is a very good sign that you instead should rethink your design.</p>\n"}, {"comments": [{"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1559752697, "post_id": 56463763, "comment_id": 99520947, "body": "@4386427: I changed the code a little bit. Maybe better now?"}], "tags": [], "owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "is_accepted": false, "score": 0, "last_activity_date": 1559752647, "last_edit_date": 1559752647, "creation_date": 1559749136, "answer_id": 56463763, "question_id": 56460697, "link": "https://stackoverflow.com/questions/56460697/can-i-access-a-functions-return-value-twice-without-storing-it-in-a-variable-or/56463763#56463763", "title": "Can I access a functions return value twice without storing it in a variable or calling the function again?", "body": "<blockquote>\n  <p>is there a way in C to use the function's return value, without defining a new variable, or calling the function twice[...]?</p>\n</blockquote>\n\n<p>Yes, with <code>switch</code></p>\n\n<pre><code>switch (id_data_valid(data)) {\n    default: return 0;\n    case 1: /* ... */ return 1;\n    case -1: /* ... */ return -1;\n    case 2: /* ... */ return 2;\n    // ...\n}\n</code></pre>\n"}], "owner": {"reputation": 682, "user_id": 5153899, "user_type": "registered", "accept_rate": 88, "profile_image": "https://graph.facebook.com/10206733961404743/picture?type=large", "display_name": "Alexander", "link": "https://stackoverflow.com/users/5153899/alexander"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 488, "favorite_count": 0, "accepted_answer_id": 56461084, "answer_count": 2, "score": 0, "last_activity_date": 1559752647, "creation_date": 1559738486, "last_edit_date": 1559748813, "question_id": 56460697, "link": "https://stackoverflow.com/questions/56460697/can-i-access-a-functions-return-value-twice-without-storing-it-in-a-variable-or", "title": "Can I access a functions return value twice without storing it in a variable or calling the function again?", "body": "<p>Function <code>id_data_valid(data)</code> may return 0, or a given error code (-1, 1, -2, 2,..., N). Is there a way in C to use the function's return value, without defining a new  variable, or calling the function twice, as the examples below show?</p>\n\n<pre><code>/* Store return value */\nint response = id_data_valid(data);\nif (response != 0) {\n    return response;\n}\n\n/* Double function call */\nif (id_data_valid(data) != 0) {\n    return id_data_valid(data);\n}\n</code></pre>\n"}, {"tags": ["c", "type-conversion", "numbers"], "comments": [{"owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 0, "creation_date": 1559737160, "post_id": 56460276, "comment_id": 99512059, "body": "At <code>return my_strcat(my_strcat(*LongToEnglish(j), &quot; &quot;), LongToEnglish(r));</code> and the line below it, I don&#39;t think you want to deference there. All the other ones don&#39;t deference."}, {"owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 1, "creation_date": 1559737375, "post_id": 56460276, "comment_id": 99512170, "body": "Actually, there are many type issues. You have <code>char *</code> passed as <code>char **</code> arguments and <code>char</code> passed as <code>char *</code> arguments."}, {"owner": {"reputation": 480272, "user_id": 1968, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd630f72eef3790bfb4ef38d08c7f85?s=128&d=identicon&r=PG", "display_name": "Konrad Rudolph", "link": "https://stackoverflow.com/users/1968/konrad-rudolph"}, "edited": false, "score": 4, "creation_date": 1559737483, "post_id": 56460276, "comment_id": 99512235, "body": "To expand on Thomas\u2019 comment: <b>You must fix your compiler warnings first</b>. These \u201cwarnings\u201d are actually errors, which you are ignoring. <i>After</i> that we can start talking about runtime errors."}, {"owner": {"reputation": 197, "user_id": 5983050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/333234567d7a296851388bf6c6d8669f?s=128&d=identicon&r=PG", "display_name": "pjaj", "link": "https://stackoverflow.com/users/5983050/pjaj"}, "edited": false, "score": 0, "creation_date": 1559738684, "post_id": 56460276, "comment_id": 99512897, "body": "Take a look at [<a href=\"https://stackoverflow.com/questions/51204004/convert-numbers-to-words-with-vba/51204358]\" title=\"convert numbers to words with vba\">stackoverflow.com/questions/51204004/&hellip;</a> where  the same question was asked using VBA instead of C"}, {"owner": {"reputation": 197, "user_id": 5983050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/333234567d7a296851388bf6c6d8669f?s=128&d=identicon&r=PG", "display_name": "pjaj", "link": "https://stackoverflow.com/users/5983050/pjaj"}, "edited": false, "score": 0, "creation_date": 1559738856, "post_id": 56460276, "comment_id": 99512993, "body": "There is another solution in C here [<a href=\"https://www.geeksforgeeks.org/convert-number-to-words/]\" rel=\"nofollow noreferrer\">geeksforgeeks.org/convert-number-to-words/]</a> you just need to google your question."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1559741874, "post_id": 56460276, "comment_id": 99514823, "body": "This code has tons of warnings even when compiling without extra flags in gcc. Fix those warnings first."}], "answers": [{"tags": [], "owner": {"reputation": 13124, "user_id": 1419272, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dcbff46aa5cd0a98d13d76595b3375f0?s=128&d=identicon&r=PG", "display_name": "alinsoar", "link": "https://stackoverflow.com/users/1419272/alinsoar"}, "is_accepted": false, "score": 2, "last_activity_date": 1559740702, "last_edit_date": 1559740702, "creation_date": 1559739959, "answer_id": 56461127, "question_id": 56460276, "link": "https://stackoverflow.com/questions/56460276/convert-arabic-number-long-long-int-to-words-in-c/56461127#56461127", "title": "Convert arabic number (long long int) to words in C", "body": "<p>There are other problems in your code, I tell just one. When input is <code>n=3</code> in <code>main</code>, <code>numberToWords</code> returns <code>\"Three\"</code> and you try to call <code>free(\"Three\")</code>, etc.</p>\n\n<p>You return a static string sometimes and try to free it for this particular case.</p>\n"}, {"tags": [], "owner": {"reputation": 755, "user_id": 6139796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70e8ec623799f48125b0aa020475091d?s=128&d=identicon&r=PG", "display_name": "Holger", "link": "https://stackoverflow.com/users/6139796/holger"}, "is_accepted": false, "score": 1, "last_activity_date": 1559743628, "creation_date": 1559743628, "answer_id": 56462169, "question_id": 56460276, "link": "https://stackoverflow.com/questions/56460276/convert-arabic-number-long-long-int-to-words-in-c/56462169#56462169", "title": "Convert arabic number (long long int) to words in C", "body": "<p>The task is for groups of thousands allways the same. So you can do it much less complicated.\nThe string handling might be optimized...</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nconst char *digits[] = { NULL, \"one \", \"two \", \"three \", \"four \", \"five \", \"six \", \"seven \", \"eight \", \"nine \", \"ten \", \"eleven \", \"twelve \", \"thirteen \", \"fourteen \", \"fifteen \", \"sixteen \", \"seventeen \", \"eighteen \", \"nineteen \" };\nconst char *tens[] = { NULL, \"ten \", \"twenty \", \"thirty \", \"forty \", \"fifty \", \"sixty \", \"seventy \", \"eighty \", \"ninety \" };\nconst char *scales[] = { \"\", \"thousand \", \"million \", \"billion \" };\n\nchar *long2words(long x, int grp) {\n    char *buf = malloc(4096), *bp;    \n    int e,t,h;\n\n    *buf='\\0';\n    e = x%10;\n    t = (x/10)%10;\n    h = (x/100)%10;\n    x /=1000;\n    if(x!=0) {\n        strcat(buf, bp=long2words(x,grp+1));\n        free(bp);\n    }\n    if(h!=0) {\n        strcat(buf, digits[h]);\n        strcat(buf,\"hundred \");\n    }\n    if(t&lt;2) strcat(buf, digits[t*10+e]);\n    else {\n        strcat(buf, tens[t]);\n        strcat(buf, digits[e]);\n    }\n    strcat(buf, scales[grp]);\n\n    return buf;\n}\nint main()\n{\n    printf(long2words(102410241024,0));\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 3140, "user_id": 1582481, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/MAazu.jpg?s=128&g=1", "display_name": "yak", "link": "https://stackoverflow.com/users/1582481/yak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1561746383, "creation_date": 1559736818, "last_edit_date": 1561746383, "question_id": 56460276, "link": "https://stackoverflow.com/questions/56460276/convert-arabic-number-long-long-int-to-words-in-c", "title": "Convert arabic number (long long int) to words in C", "body": "<p>I would like to convert a number, let's say, 1024 or 2345787654 into english words, such that for 1024 it should print one thousand twenty four etc.</p>\n\n<p>However, my code gives me segmentation fault. I tried to run it with <code>gdb</code> but is suggests that the problem is inside <code>my_strcat</code> function. However, I do not see any problem with this function. Please, help.</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nconst char *digits[] = { NULL, \"one \", \"two \", \"three \", \"four \", \"five \", \"six \", \"seven \", \"eight \", \"nine \" };\nconst char *tens[] = { NULL, \"ten \", \"twenty \", \"thirty \", \"forty \", \"fifty \", \"sixty \", \"seventy \", \"eighty \", \"ninety \" };\nconst char *teens[] = { \"ten \", \"eleven \", \"twelve \", \"thirteen \", \"fourteen \", \"fifteen \", \"sixteen \", \"seventeen \", \"eighteen \", \"nineteen \" };\nconst char *scales[] = { \"\", \"thousand \", \"million \", \"billion \" };\n\nchar *my_strcat ( char **dest, const char * src)\n{\n    char *tab = malloc ( sizeof ( char) * (strlen ( *dest) + strlen ( src) + 1));\n    if ( NULL == tab)\n        return NULL;\n    strcpy ( tab, *dest);\n    strcat ( tab, src);\n    free ( *dest);\n    *dest = malloc ( sizeof ( char) * ( strlen ( tab) + 1));\n    strcpy ( *dest, tab);\n    return tab;\n}\n\nchar * LongToEnglish(unsigned long x)\n{\n    switch(x)\n    {\n    case 0:\n        return \"Zero\";\n    case 1:\n        return \"One\";\n    case 2:\n        return \"Two\";\n    case 3:\n        return \"Three\";\n    case 4:\n        return \"Four\";\n    case 5:\n        return \"Five\";\n    case 6:\n        return \"Six\";\n    case 7:\n        return \"Seven\";\n    case 8:\n        return \"Eight\";\n    case 9:\n        return \"Nine\";\n    case 10:\n        return \"Ten\";\n    case 11:\n        return \"Eleven\";\n    case 12:\n        return \"Twelve\";\n    case 13:\n        return \"Thirteen\";\n    case 14:\n        return \"Fourteen\";\n    case 15:\n        return \"Fifteen\";\n    case 16:\n        return \"Sixteen\";\n    case 17:\n        return \"Seventeen\";\n    case 18:\n        return \"Eighteen\";\n    case 19:\n        return \"Nineteen\";\n    case 20:\n        return \"Twenty\";\n    case 30:\n        return \"Thirty\";\n    case 40:\n        return \"Forty\";\n    case 50:\n        return \"Fifty\";\n    case 60:\n        return \"Sixty\";\n    case 70:\n        return \"Seventy\";\n    case 80:\n        return \"Eighty\";\n    case 90:\n        return \"Ninety\";\n    case 100:\n        return \"One Hundred\";\n    case 1000:\n        return \"One Thousand\";\n    case 1000000:\n        return \"One Million\";\n    case 1000000000:\n        return \"One Billion\";\n    }\n    // less than 100\n    for (long i = 1; i &lt;= 9; i ++)\n    {\n        long j = i * 10;\n        if ((x &gt;= j) &amp;&amp; (x &lt; j + 10))\n        {\n            long r = x - j;\n\n            if(r &gt; 0)\n                return my_strcat(my_strcat(*LongToEnglish(j), \" \"), LongToEnglish(r));\n            else\n                return my_strcat(*LongToEnglish(j), \"\");\n        }\n    }\n    // less than 1000\n    for (long i = 1; i &lt;= 9; i ++)\n    {\n        long j = i * 100;\n        if ((x &gt;= j) &amp;&amp; (x &lt; j + 100))\n        {\n            long r = x - j;\n\n            if(r &gt; 0)\n                return my_strcat(my_strcat(LongToEnglish(i), \" Hundred \"), LongToEnglish(r));\n            else\n                return my_strcat(LongToEnglish(i), \" Hundred\");\n        }\n    }\n    // less than 10000\n    for (long i = 1; i &lt;= 9; i ++)\n    {\n        long j = i * 1000;\n        if ((x &gt;= j) &amp;&amp; (x &lt; j + 1000))\n        {\n            long r = x - j;\n            if(r &gt; 0)\n                return my_strcat(my_strcat(LongToEnglish(i), \" Thousand \"), LongToEnglish(r));\n            else\n                return my_strcat(LongToEnglish(i), \" Thousand\");\n        }\n    }\n    // Million\n    for (long i = 1; i &lt;= 9; i ++)\n    {\n        long j = i * 1000000;\n        if ((x &gt;= j) &amp;&amp; (x &lt; j + 1000000))\n        {\n            long r = x - j;\n            if(r &gt; 0)\n                return my_strcat(my_strcat(LongToEnglish(i), \" Million \"), LongToEnglish(r));\n            else\n                return my_strcat(LongToEnglish(i), \" Million\");\n        }\n    }\n    // Billion\n    for (long i = 1; i &lt;= 4; i ++)\n    {\n        long j = i * 1000000000;\n        if ((x &gt;= j) &amp;&amp; (x &lt; j + 1000000000))\n        {\n            long r = x - j;\n            if(r &gt; 0)\n                return my_strcat(my_strcat(LongToEnglish(i), \" Billion \"), LongToEnglish(r));\n            else\n                return my_strcat(LongToEnglish(i), \" Billion\");\n        }\n    }\n    // Divide the number into 3-digit groups from left to right\n    char* output = \"\";\n    long cnt = 0;\n    while (x &gt; 0)\n    {\n        long y = x % 1000;\n        x /= 1000;\n        if (y &gt; 0)   // skip middle-chunk zero\n        {\n            char * t = \"\";\n            if (cnt == 1) t = \" Thousand \";\n            if (cnt == 2) t = \" Million \";\n            if (cnt == 3) t = \" Billion \";\n            output = my_strcat(my_strcat(LongToEnglish(y), t), output);\n        }\n        cnt ++;\n    }\n\n    return (output);\n}\n\nchar* numberToWords(int num)\n{\n    return LongToEnglish(num);\n}\n\nint main(int argc, char **argv)\n{\n    char *dst = NULL;\n    dst = malloc ( sizeof ( char) * 10000000);\n\n    unsigned long long n = 122334;\n    dst = numberToWords(n);\n\n    printf(\"%s\", dst);\n    free(dst);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "c-preprocessor"], "comments": [{"owner": {"reputation": 22777, "user_id": 133203, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Fp3hB.jpg?s=128&g=1", "display_name": "Federico klez Culloca", "link": "https://stackoverflow.com/users/133203/federico-klez-culloca"}, "edited": false, "score": 0, "creation_date": 1559736961, "post_id": 56460272, "comment_id": 99511947, "body": "Also <a href=\"https://stackoverflow.com/questions/17160755/is-there-a-way-to-both-check-a-macro-is-defined-and-it-equals-a-certain-value-at\">this</a> question."}], "owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 118, "favorite_count": 0, "closed_date": 1559736943, "answer_count": 0, "score": 3, "last_activity_date": 1559737489, "creation_date": 1559736802, "question_id": 56460272, "link": "https://stackoverflow.com/questions/56460272/a-way-to-check-if-preprocessor-symbol-is-defined-but-empty", "closed_reason": "Duplicate", "title": "A way to check if preprocessor symbol is defined but empty?", "body": "<p><strong>Is there a way to check whether a preprocessor symbol is <em>defined but without value</em>?</strong></p>\n\n<p>Consider the following bit of code:</p>\n\n<pre><code>#if defined( FOO )\n  #if FOO == 1\n    #error FOO defined to 1.\n  #else\n    #error FOO defined to other value than 1.\n  #endif\n#else\n  #error FOO undefined\n#endif\n\nint main() {}\n</code></pre>\n\n<p>As is, this will give:</p>\n\n<pre><code>error: #error FOO undefined\n</code></pre>\n\n<p>If I add <code>#define FOO 1</code> to the top, I get:</p>\n\n<pre><code>error: #error FOO defined to 1.\n</code></pre>\n\n<p>So far, so good. <strong>But</strong> when I change that to <code>#define FOO</code> (i.e., <em>defining</em> <code>FOO</code>, but not defining it <em>to</em> something), I get:</p>\n\n<pre><code>error: operator '==' has no left operand\n</code></pre>\n\n<p><strong>Is there a way to check whether a preprocessor symbol is <em>defined but without value</em>?</strong></p>\n"}, {"tags": ["c", "arrays", "pointers"], "comments": [{"owner": {"reputation": 3638, "user_id": 3893262, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2c2858a4f4f41634337f78973b0281aa?s=128&d=identicon&r=PG&f=1", "display_name": "O&#39;Neil", "link": "https://stackoverflow.com/users/3893262/oneil"}, "edited": false, "score": 0, "creation_date": 1559737097, "post_id": 56460262, "comment_id": 99512029, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/16724368/how-to-pass-a-2d-array-by-pointer-in-c\">How to pass a 2D array by pointer in C?</a>"}, {"owner": {"reputation": 480272, "user_id": 1968, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd630f72eef3790bfb4ef38d08c7f85?s=128&d=identicon&r=PG", "display_name": "Konrad Rudolph", "link": "https://stackoverflow.com/users/1968/konrad-rudolph"}, "edited": false, "score": 0, "creation_date": 1559737638, "post_id": 56460262, "comment_id": 99512309, "body": "Rather than using nested arrays, a better solution in ~ 99% of cases is to represent a 2D array as an <code>int*</code>, and to perform the index computation yourself. All major linear algebra libraries do it that way."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1559740961, "post_id": 56460262, "comment_id": 99514247, "body": "You can use <code>int*</code> in place of <code>int [n]</code> because an array when used in an expression &quot;decays&quot; to a pointer to the first element. The same goes for 2D arrays, they are actually just arrays of arrays. The first element of a 2D array is a 1D array. And so it decays to a pointer to such an array: <code>int (*)[n]</code>. That&#39;s why you can&#39;t use <code>int**</code> because it means something else entirely. So you could write the function as <code>void shift (int (*arr)[5])</code> but that&#39;s quite hard to read. The method shown in the accepted answer is easier to read and completely equivalent."}, {"owner": {"reputation": 103, "user_id": 7860546, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5450bff38307680bd38f682612affe8d?s=128&d=identicon&r=PG&f=1", "display_name": "Sukrit Kapil", "link": "https://stackoverflow.com/users/7860546/sukrit-kapil"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1559741310, "post_id": 56460262, "comment_id": 99514432, "body": "@Lundin Thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 103, "user_id": 7860546, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5450bff38307680bd38f682612affe8d?s=128&d=identicon&r=PG&f=1", "display_name": "Sukrit Kapil", "link": "https://stackoverflow.com/users/7860546/sukrit-kapil"}, "edited": false, "score": 0, "creation_date": 1559737045, "post_id": 56460307, "comment_id": 99511996, "body": "Does that make any difference? Also I used the pointer notation so that I can change the value at the addresses using a void function. Fetching the elements using a matrix notation, I can&#39;t do much with a void function."}, {"owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "reply_to_user": {"reputation": 103, "user_id": 7860546, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5450bff38307680bd38f682612affe8d?s=128&d=identicon&r=PG&f=1", "display_name": "Sukrit Kapil", "link": "https://stackoverflow.com/users/7860546/sukrit-kapil"}, "edited": false, "score": 0, "creation_date": 1559737286, "post_id": 56460307, "comment_id": 99512117, "body": "@SukritKapil A 2D array doesn&#39;t dereference twice"}, {"owner": {"reputation": 103, "user_id": 7860546, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5450bff38307680bd38f682612affe8d?s=128&d=identicon&r=PG&f=1", "display_name": "Sukrit Kapil", "link": "https://stackoverflow.com/users/7860546/sukrit-kapil"}, "reply_to_user": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 0, "creation_date": 1559737454, "post_id": 56460307, "comment_id": 99512217, "body": "@ThomasJager Actually I did the same question for a 1-D array. Using *p as an argument. Should not **p work the same way for a 2-D array."}, {"owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "reply_to_user": {"reputation": 103, "user_id": 7860546, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5450bff38307680bd38f682612affe8d?s=128&d=identicon&r=PG&f=1", "display_name": "Sukrit Kapil", "link": "https://stackoverflow.com/users/7860546/sukrit-kapil"}, "edited": false, "score": 0, "creation_date": 1559737710, "post_id": 56460307, "comment_id": 99512343, "body": "@SukritKapil it works this way for me this way and also on online OnlineGDB (I added a link to that). <code>**p</code> works, but only for jagged arrays, which is when you have an array of pointer pointing to more arrays."}, {"owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "reply_to_user": {"reputation": 103, "user_id": 7860546, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5450bff38307680bd38f682612affe8d?s=128&d=identicon&r=PG&f=1", "display_name": "Sukrit Kapil", "link": "https://stackoverflow.com/users/7860546/sukrit-kapil"}, "edited": false, "score": 0, "creation_date": 1559737792, "post_id": 56460307, "comment_id": 99512390, "body": "@SukritKapil A double-pointer could be used as an array of pointers, which you could index into twice. However, a double-pointer is different. The compiler knows that doing <code>[2][3]</code> on an <code>int **</code> is completely different from doing it on an <code>int [4][5]</code>. The former will add <code>2 * sizeof(int *)</code> to the pointer address, get the <code>int *</code> at that address, add <code>3 * sizeof(int)</code> to that address, and get the <code>int</code> there. The latter will effectively dereference an <code>int *</code> with an index dependant on the indices used, and the size of all but one dimension."}, {"owner": {"reputation": 103, "user_id": 7860546, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5450bff38307680bd38f682612affe8d?s=128&d=identicon&r=PG&f=1", "display_name": "Sukrit Kapil", "link": "https://stackoverflow.com/users/7860546/sukrit-kapil"}, "edited": false, "score": 0, "creation_date": 1559737820, "post_id": 56460307, "comment_id": 99512409, "body": "@Blaze Thank you so much. It actually worked. Can you please help me why **p won&#39;t work?"}, {"owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "reply_to_user": {"reputation": 103, "user_id": 7860546, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5450bff38307680bd38f682612affe8d?s=128&d=identicon&r=PG&f=1", "display_name": "Sukrit Kapil", "link": "https://stackoverflow.com/users/7860546/sukrit-kapil"}, "edited": false, "score": 0, "creation_date": 1559737997, "post_id": 56460307, "comment_id": 99512499, "body": "@SukritKapil Thomas summed that up very well. If you want to do <code>**p</code>, you&#39;ll need a jagged array, which is explained here: <a href=\"https://stackoverflow.com/a/1083681/10411602\">stackoverflow.com/a/1083681/10411602</a>"}, {"owner": {"reputation": 103, "user_id": 7860546, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5450bff38307680bd38f682612affe8d?s=128&d=identicon&r=PG&f=1", "display_name": "Sukrit Kapil", "link": "https://stackoverflow.com/users/7860546/sukrit-kapil"}, "edited": false, "score": 0, "creation_date": 1559738020, "post_id": 56460307, "comment_id": 99512512, "body": "Thanks to all. Understood."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 103, "user_id": 7860546, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5450bff38307680bd38f682612affe8d?s=128&d=identicon&r=PG&f=1", "display_name": "Sukrit Kapil", "link": "https://stackoverflow.com/users/7860546/sukrit-kapil"}, "edited": false, "score": 0, "creation_date": 1559740737, "post_id": 56460307, "comment_id": 99514125, "body": "@SukritKapil Alternatively you can do <code>void shift(int x, int y, int arr[x][y]);</code> if you need a function accepting any 2D array."}, {"owner": {"reputation": 103, "user_id": 7860546, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5450bff38307680bd38f682612affe8d?s=128&d=identicon&r=PG&f=1", "display_name": "Sukrit Kapil", "link": "https://stackoverflow.com/users/7860546/sukrit-kapil"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1559741421, "post_id": 56460307, "comment_id": 99514502, "body": "@Lundin Alright, would that work because int x and int y are initialised earlier than arr[x][y] and so it does not give &#39;uninitialised array&#39; error?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 103, "user_id": 7860546, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5450bff38307680bd38f682612affe8d?s=128&d=identicon&r=PG&f=1", "display_name": "Sukrit Kapil", "link": "https://stackoverflow.com/users/7860546/sukrit-kapil"}, "edited": false, "score": 0, "creation_date": 1559744763, "post_id": 56460307, "comment_id": 99516543, "body": "@SukritKapil They are parameters to the function. The array in the example is actually a variable-length array (VLA) but it &quot;decays&quot; into a pointer &quot;between the lines&quot;."}], "tags": [], "owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "is_accepted": true, "score": 1, "last_activity_date": 1559737645, "last_edit_date": 1559737645, "creation_date": 1559736937, "answer_id": 56460307, "question_id": 56460262, "link": "https://stackoverflow.com/questions/56460262/why-am-i-getting-segmentation-error-while-using-double-pointer-as-an-argument/56460307#56460307", "title": "Why am I getting &#39;segmentation error&#39; while using double pointer as an argument for a 2-D array?", "body": "<p>Accessing the array elements of a 2D array like that only works for 2D arrays. Instead of declaring it like this:</p>\n\n<pre><code>void shift(int **p)\n</code></pre>\n\n<p>You should change it to this:</p>\n\n<pre><code>void shift(int p[4][5])\n</code></pre>\n\n<p>And the same for the prototype of the function. <a href=\"https://onlinegdb.com/H1OAVNBRE\" rel=\"nofollow noreferrer\">Click here</a> for a demo.</p>\n"}], "owner": {"reputation": 103, "user_id": 7860546, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5450bff38307680bd38f682612affe8d?s=128&d=identicon&r=PG&f=1", "display_name": "Sukrit Kapil", "link": "https://stackoverflow.com/users/7860546/sukrit-kapil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 56460307, "answer_count": 1, "score": 2, "last_activity_date": 1559738374, "creation_date": 1559736748, "last_edit_date": 1559738374, "question_id": 56460262, "link": "https://stackoverflow.com/questions/56460262/why-am-i-getting-segmentation-error-while-using-double-pointer-as-an-argument", "title": "Why am I getting &#39;segmentation error&#39; while using double pointer as an argument for a 2-D array?", "body": "<p>The problem is about taking input of a 4X5 matrix and shifting each of its rows circularly left by 2 places. Like if input is {1,2,3,4,5} the output should be {3,4,5,1,2}. I wrote the following code for the same. But I am getting 'segmentation fault(core dumped)' error. Can you help me with this. Also I am a bit susceptible  about sending a 2-d array to function with **p  argument. DO COMMENT ON THIS ALSO. I want to know why I am getting the error.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nvoid shift(int **);\nint main()\n{\n    int i,j,a[4][5];\n    printf(\"Enter the elements of the 4X5 matrix:\\n\");\n    for(i=0;i&lt;4;i++)\n    {\n        for(j=0;j&lt;5;j++)\n        {\n            scanf(\"%d\",&amp;a[i][j]);\n        }\n    }\n    printf(\"Entered Matrix:\\n\");\n    for(i=0;i&lt;4;i++)\n    {\n        for(j=0;j&lt;5;j++)\n        {\n            printf(\"%d \",a[i][j]);\n        }\n        printf(\"\\n\");\n    }\n    printf(\"\\n\");\n\n        shift(a);\n\n        printf(\"The new array is:\\n\");\n    for(i=0;i&lt;4;i++)\n    {\n        for(j=0;j&lt;5;j++)\n        {\n            printf(\"%d \",a[i][j]);\n        }\n        printf(\"\\n\");\n    }\n    printf(\"\\n\");\n    return 0;\n}\n\nvoid shift(int **p)\n{\n    int i;\n    for(i=0;i&lt;4;i++)\n    {\n        int temp[2] = {**(p+i),*(*(p+i)+1)};\n        *(*(p+i)+0) = *(*(p+i)+2);\n        *(*(p+i)+1) = *(*(p+i)+3);\n        *(*(p+i)+2) = *(*(p+i)+4);\n        *(*(p+i)+3) = temp[0];\n        *(*(p+i)+4) = temp[1];\n    }\n}\n</code></pre>\n\n<p>Expected Result - Rotated Array\nActual Result - Segmentation Fault(Core Dumped)</p>\n"}, {"tags": ["c", "openmpi"], "comments": [{"owner": {"reputation": 655, "user_id": 5565491, "user_type": "registered", "accept_rate": 27, "profile_image": "https://i.stack.imgur.com/p79I1.jpg?s=128&g=1", "display_name": "iOShit I Screwed Up", "link": "https://stackoverflow.com/users/5565491/ioshit-i-screwed-up"}, "edited": false, "score": 0, "creation_date": 1559741464, "post_id": 56460223, "comment_id": 99514534, "body": "Hey Antonio. Just some advice: you should try to post your variable names in English. To someone who doesn&#39;t speak Italian, the code will be much harder to read if variable names are gibberish to them."}, {"owner": {"reputation": 31, "user_id": 9657387, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sTimg.png?s=128&g=1", "display_name": "entoni", "link": "https://stackoverflow.com/users/9657387/entoni"}, "reply_to_user": {"reputation": 655, "user_id": 5565491, "user_type": "registered", "accept_rate": 27, "profile_image": "https://i.stack.imgur.com/p79I1.jpg?s=128&g=1", "display_name": "iOShit I Screwed Up", "link": "https://stackoverflow.com/users/5565491/ioshit-i-screwed-up"}, "edited": false, "score": 0, "creation_date": 1559742400, "post_id": 56460223, "comment_id": 99515157, "body": "thanks for the suggestion. I changed the variable names :)"}, {"owner": {"reputation": 6899, "user_id": 1212012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gmBY7.png?s=128&g=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1212012/mathieu"}, "edited": false, "score": 0, "creation_date": 1559742765, "post_id": 56460223, "comment_id": 99515401, "body": "Not linked to your problem: this line of code is at best useless, at worst buggy: <code>str_righe[j][strlen(str_righe[j])] = &#39;\\0&#39;;</code>"}, {"owner": {"reputation": 31, "user_id": 9657387, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sTimg.png?s=128&g=1", "display_name": "entoni", "link": "https://stackoverflow.com/users/9657387/entoni"}, "edited": false, "score": 0, "creation_date": 1559743287, "post_id": 56460223, "comment_id": 99515706, "body": "thanks for letting me know Mathieu"}, {"owner": {"reputation": 6899, "user_id": 1212012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gmBY7.png?s=128&g=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1212012/mathieu"}, "edited": false, "score": 0, "creation_date": 1559746722, "post_id": 56460223, "comment_id": 99517672, "body": "Are you trying to send characters array or pointers on characters array? Maybe you can try <code>MPI_Scatter(words, message_length, MPI_CHAR, local_words, message_length, MPI_CHAR, MASTER, MPI_COMM_WORLD);</code> This will send pointers on words instead of words"}, {"owner": {"reputation": 31, "user_id": 9657387, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sTimg.png?s=128&g=1", "display_name": "entoni", "link": "https://stackoverflow.com/users/9657387/entoni"}, "edited": false, "score": 0, "creation_date": 1559759566, "post_id": 56460223, "comment_id": 99523696, "body": "I&#39;m trying to send string arrays. I tried both solutions, but the result is the same"}], "owner": {"reputation": 31, "user_id": 9657387, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sTimg.png?s=128&g=1", "display_name": "entoni", "link": "https://stackoverflow.com/users/9657387/entoni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 110, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1559742592, "creation_date": 1559736587, "last_edit_date": 1559742592, "question_id": 56460223, "link": "https://stackoverflow.com/questions/56460223/how-to-share-a-string-array-using-open-mpi", "title": "How to share a string array using open mpi", "body": "<p>I'm new in openmpi and I don't know how to use scatter and gather to send an array of strings to all processors. I would like to divide an array and send it to each processor, but all I can divide are the characters of a single array element. Can anyone help me please?</p>\n\n<p>Here is my code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include \"mpi.h\"\n\n#define MASTER 0\n\n#define BUF_SIZE 2048\n#define CHAR_SIZE 900                                                       \n#define CHARS 13                                                            \n#define MAX_SIZE 3500                                                    \n#define NUMBER_OF_FILES  2                                                   \n\nint main(int argc, char** argv) {\n\n    int number_of_words = 0;\n    int total_rows = 0; \n    int i, j = 0;\n\n    char **words = (char**) calloc(MAX_SIZE, sizeof (char*));\n\n    for (i = 0; i &lt; MAX_SIZE; i++) {\n        words[i] = (char*) calloc(CHARS, sizeof (char));\n    }\n\n    char **local_words = (char**) calloc(MAX_SIZE, sizeof (char*));\n\n    for (i = 0; i &lt; MAX_SIZE; i++) {\n        local_words[i] = (char*) calloc(CHARS, sizeof (char));\n    }\n\n    char **rec_words = (char**) calloc(MAX_SIZE, sizeof (char*));\n\n    for (i = 0; i &lt; MAX_SIZE; i++) {\n        rec_words[i] = (char*) calloc(CHARS, sizeof (char));\n    }\n\n    char str_righe[BUF_SIZE][CHAR_SIZE]; \n\n    FILE *f = NULL;\n    char f_title[10]; \n    char str_nfiles[10]; \n\n    char delim[10] = {10, 32, 33, 39, 44, 46, 58, 59, 63}; \n\n    char *ptr;\n\n    int rank;\n    int size;\n    int message_length;\n\n    MPI_Init(&amp;argc, &amp;argv);\n    MPI_Comm_size(MPI_COMM_WORLD, &amp;size);\n    MPI_Comm_rank(MPI_COMM_WORLD, &amp;rank);\n\n    for (i = 1; i &lt;= NUMBER_OF_FILES; i++) {\n        strcpy(f_title, \"f\");\n        sprintf(str_nfiles, \"%d\", i);\n        strcat(f_title, str_nfiles);\n        strcat(f_title, \".txt\");\n\n        f = fopen(f_title, \"r\");\n        while (fgets(str_righe[j], BUF_SIZE, f)) {\n            str_righe[j][strlen(str_righe[j])] = '\\0';\n            j++;\n        }\n        fclose(f);\n    }\n\n    total_rows = j;\n\n    for (i = 0; i &lt; total_rows; ++i) {\n        ptr = strtok(str_righe[i], delim);\n\n        while (ptr != NULL) {\n            strcpy(words[number_of_words], ptr);\n            ptr = strtok(NULL, delim);\n            number_of_words++;\n        }\n    }\n\n    message_length = number_of_words / size;\n\n    if (rank == MASTER) {\n        for (i = 0; i &lt; number_of_words; i++)\n            printf(\"%s\\n\", words[i]);\n    }\n\n    MPI_Scatter(*words, message_length, MPI_CHAR, *local_words, message_length, MPI_CHAR, MASTER, MPI_COMM_WORLD);\n\n    printf(\"rank %d, fragment: \\t%s\\n\", rank, *local_words);\n\n    MPI_Gather(*local_words, message_length, MPI_CHAR, *rec_words, message_length, MPI_CHAR, MASTER, MPI_COMM_WORLD);\n\n    if (rank == MASTER) {\n        printf(\"rank %d, gathered: \\t%s\\n\", rank, *rec_words);\n    }\n\n    MPI_Finalize();\n\n    return EXIT_SUCCESS;\n}\n</code></pre>\n\n<p>I expect the output:</p>\n\n<pre><code>iMac-di-iMac01:mpi macbook$ mpirun -n 2 main\nGood\ntime\nby\nantonio\nrank 0, fragment:   Good time\nrank 1, fragment:   by antonio\nrank 0, gathered:   Good time by antonio\n</code></pre>\n\n<p>But the actual output is:</p>\n\n<pre><code>iMac-di-iMac01:mpi macbook$ mpirun -n 2 main\nGood\ntime\nby\nantonio\nrank 0, fragment:   Go\nrank 1, fragment:   od\nrank 0, gathered:   Good\n</code></pre>\n"}, {"tags": ["c", "stm32", "zlib"], "answers": [{"comments": [{"owner": {"reputation": 145, "user_id": 9859120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e2cee8fad2693e88b246a8c3f25b4e0?s=128&d=identicon&r=PG&f=1", "display_name": "Noob14", "link": "https://stackoverflow.com/users/9859120/noob14"}, "edited": false, "score": 0, "creation_date": 1559740307, "post_id": 56460256, "comment_id": 99513884, "body": "I dont find anything that looks like a library file in the zlib source code folder.? Do you know where to find it?"}, {"owner": {"reputation": 304, "user_id": 10124827, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22adbe933ba29413ef64aac370adf743?s=128&d=identicon&r=PG&f=1", "display_name": "G&#225;bor", "link": "https://stackoverflow.com/users/10124827/g%c3%a1bor"}, "reply_to_user": {"reputation": 145, "user_id": 9859120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e2cee8fad2693e88b246a8c3f25b4e0?s=128&d=identicon&r=PG&f=1", "display_name": "Noob14", "link": "https://stackoverflow.com/users/9859120/noob14"}, "edited": false, "score": 2, "creation_date": 1559740460, "post_id": 56460256, "comment_id": 99513974, "body": "you need to compile zlib source first to create a library."}], "tags": [], "owner": {"reputation": 304, "user_id": 10124827, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22adbe933ba29413ef64aac370adf743?s=128&d=identicon&r=PG&f=1", "display_name": "G&#225;bor", "link": "https://stackoverflow.com/users/10124827/g%c3%a1bor"}, "is_accepted": false, "score": 1, "last_activity_date": 1559736720, "creation_date": 1559736720, "answer_id": 56460256, "question_id": 56460102, "link": "https://stackoverflow.com/questions/56460102/import-zlib-on-stm32-microcontroller-giving-error-type-undefined-reference-to-g/56460256#56460256", "title": "Import zlib on stm32 microcontroller giving error Type undefined reference to `gzclose&#39;", "body": "<p>try add library to project ( project Properties -> C/C++ General -> Paths and Symbols -> Libraries)</p>\n"}], "owner": {"reputation": 145, "user_id": 9859120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e2cee8fad2693e88b246a8c3f25b4e0?s=128&d=identicon&r=PG&f=1", "display_name": "Noob14", "link": "https://stackoverflow.com/users/9859120/noob14"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "closed_date": 1564833773, "answer_count": 1, "score": -2, "last_activity_date": 1564833136, "creation_date": 1559736097, "last_edit_date": 1564833136, "question_id": 56460102, "link": "https://stackoverflow.com/questions/56460102/import-zlib-on-stm32-microcontroller-giving-error-type-undefined-reference-to-g", "closed_reason": "Duplicate", "title": "Import zlib on stm32 microcontroller giving error Type undefined reference to `gzclose&#39;", "body": "<p>I'm trying an example of compressing a file using zlib, on a stm32 microcontroller.</p>\n\n<p>It's just giving med the compiler error</p>\n\n<blockquote>\n  <p>Type undefined reference to `gzclose'</p>\n</blockquote>\n\n<p>I have looked on similar problems including the solution here on stackoverflow. Where it needs to be linked to zlib.</p>\n\n<p>How do I do this when I'm Atollic TrueSTUDIO?</p>\n"}, {"tags": ["c", "file", "load"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 4, "creation_date": 1559733751, "post_id": 56459467, "comment_id": 99510489, "body": "<code>typedef struct _node* node;</code> is the root of all your bugs. Never hide pointers behind a typedef."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 2, "creation_date": 1559733890, "post_id": 56459467, "comment_id": 99510551, "body": "Core dumbed? What is that?"}, {"owner": {"reputation": 17209, "user_id": 1055118, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/44Trt.jpg?s=128&g=1", "display_name": "doctorlove", "link": "https://stackoverflow.com/users/1055118/doctorlove"}, "edited": false, "score": 2, "creation_date": 1559733959, "post_id": 56459467, "comment_id": 99510587, "body": "What does <code>list_create</code> do? Also, maybe try your list with one or two items in, that are hard coded rather than from a file to check the list works fine. Then try a file."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 3, "creation_date": 1559734318, "post_id": 56459467, "comment_id": 99510720, "body": "And read this:  <a href=\"https://stackoverflow.com/questions/5431941/why-is-while-feoffile-always-wrong\"><b>Why is \u201cwhile (!feof(file))\u201d always wrong?</b></a>"}, {"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 0, "creation_date": 1559736820, "post_id": 56459467, "comment_id": 99511875, "body": "Even if we ignore the <code>!feof(file)</code> problem,  the loop in <code>load()</code> is assuming the <code>list</code> passed is allocated with multiple entries (enough to hold the contents of the file).   If the function <code>list_create()</code> doesn&#39;t allocate such entries, the behaviour of the loop is undefined.   A linked list doesn&#39;t magically grow by having a pointer traverse its nodes."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1559789423, "post_id": 56459467, "comment_id": 99531747, "body": "regarding; <code>list l=list_create();</code>  The posted code is missing this function!   How do you expect us to help you debug the problem when you have not posted a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1559789501, "post_id": 56459467, "comment_id": 99531761, "body": "OT:  for ease of readability and understanding: 1) please consistently indent the code.  Indent after every opening brace &#39;{&#39;.  Unindent before every closing brace &#39;}&#39;.  Suggest each indent level be 4 spaces  2) variable (and parameter) names should indicate <code>content</code> or <code>usage</code> (or better, both).  names like <code>l</code> are meaningless, even in the current context"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1559789698, "post_id": 56459467, "comment_id": 99531786, "body": "OT: regarding: <code>load(argv[1],l);</code>  Never access beyond <code>argv[0]</code> without first checking <code>argc</code> to assure the command line parameter was actually entered by the user"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1559789883, "post_id": 56459467, "comment_id": 99531819, "body": "OT:  regarding: <code>printf(&quot;Error trying to open the file&quot;);</code>  Error messages should be output to <code>stderr</code>, not <code>stdout</code>  Since the error is from a C library function, should also output (to <code>stderr</code>) the text reason the system thinks the error occurred.  Suggest using: <code>perror( &quot;fopen failed&quot; );</code>"}], "answers": [{"comments": [{"owner": {"reputation": 125, "user_id": 11600108, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-EFcNDwG4oJ0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reuhyyeP5WPt8dd4KxYVxny1f83nA/mo/photo.jpg?sz=128", "display_name": "Azzarian", "link": "https://stackoverflow.com/users/11600108/azzarian"}, "edited": false, "score": 0, "creation_date": 1559827986, "post_id": 56459615, "comment_id": 99547792, "body": "Unfortunately it did not fix the segmentation fault but it was a mistake that could have caused problem later."}], "tags": [], "owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "is_accepted": false, "score": 1, "last_activity_date": 1559734461, "last_edit_date": 1559734461, "creation_date": 1559734124, "answer_id": 56459615, "question_id": 56459467, "link": "https://stackoverflow.com/questions/56459467/segmentation-fault-core-dumped-while-trying-to-open-a-file/56459615#56459615", "title": "Segmentation fault (core dumped) while trying to open a file", "body": "<pre><code>free(l-&gt;head-&gt;next);\nl-&gt;head=l-&gt;head-&gt;next;\n</code></pre>\n\n<p>You are freeing <code>l-&gt;head-&gt;next</code> and assigning the freed value (garbage) to <code>l-&gt;head</code> in the next line.</p>\n\n<p>In consequence you read garbage (segfault) in the second iteration when trying to access to <code>l-&gt;head-&gt;next</code>.</p>\n"}], "owner": {"reputation": 125, "user_id": 11600108, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-EFcNDwG4oJ0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reuhyyeP5WPt8dd4KxYVxny1f83nA/mo/photo.jpg?sz=128", "display_name": "Azzarian", "link": "https://stackoverflow.com/users/11600108/azzarian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 411, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1559828190, "creation_date": 1559733612, "last_edit_date": 1559828190, "question_id": 56459467, "link": "https://stackoverflow.com/questions/56459467/segmentation-fault-core-dumped-while-trying-to-open-a-file", "title": "Segmentation fault (core dumped) while trying to open a file", "body": "<p>I am trying to create a program which creates a data structure of people with their names and ids. When I it compiles no problem but when it runs I get segmentation fault(core dumped). The file is on the same folder as the .c file.Also, inside the file the data will be separated by tab. The list_create() function creates the data structure in the form of a list.</p>\n\n<p>I tried instead of making one single line of code with many functions, multiple lines with few functions,use the tmp as a list instead of a node,free variables in a different order but it changed nothing.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;assert.h&gt;\n#define MAXSTRING 50\ntypedef struct{\n    char name[MAXSTRING];\n    int id;\n} student;\ntypedef struct _node* node;\ntypedef struct _list* list;\n\nstruct _node {\n    student data;\n    node next;\n};\n\nstruct _list {\n    node head;\n    int size;\n};\n\n\nint list_empty(list l){\n        assert(l);\n        return l-&gt;head==NULL;\n}\nnode list_deletefirst(list l){\n        assert(l &amp;&amp; l-&gt;head);\n        node ret;\n        l-&gt;head=l-&gt;head-&gt;next;\n        l-&gt;size--;\n        ret-&gt;next=NULL;\n        return ret;\n}\n\nvoid list_freenode(node n){\n        assert(n);\n        free(n);\n}\n\n\nvoid load(char*filename,list l){\n    FILE *fd;\n    node tmp=l-&gt;head;\n    if((fd=fopen(filename,\"r\"))==NULL){\n        printf(\"Error trying to open the file\");\n                abort();\n    }\n    else{\n                while(!feof(fd)){\n                fscanf(fd,\"%s\\t%d\\n\",tmp-&gt;data.name,&amp;tmp-&gt;data.id);\n\n                tmp=tmp-&gt;next;\n                l-&gt;size++;\n                }\n\n        }\n\n    tmp-&gt;next=NULL;\n    fclose(fd);\n}\n\nvoid save(char *filename,list l){\n    int i;\n    node tmp=l-&gt;head;\n    FILE *fd;   \n    rewind(fd);\n    if((fd=fopen(filename,\"w\"))==NULL){\n        printf(\"File could not be opened\");\n        abort();\n    }\n    for(i=0;i&lt;l-&gt;size;i++){\n        fprintf(fd,\"%s\\t%.4d\\n\",tmp-&gt;data.name,tmp-&gt;data.id);\n        tmp=tmp-&gt;next;\n    }\n    rewind(fd);\n    fclose(fd);\n}\n\nint main(int argc,char *argv[]){\n    list l=list_create();\n    load(argv[1],l);\n\n\n    save(argv[1],l);\n\n    while (!list_empty(l)){\n                list_freenode(list_deletefirst(l));\n        }\n    free(l);\n\n    return 0;\n}\n</code></pre>\n\n<p>I expect to get a list with names and ids.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1559733591, "post_id": 56459421, "comment_id": 99510415, "body": "Reverse the logic of your code. Set the flag and break out if two elements are <i>not</i> equal instead."}, {"owner": {"reputation": 237, "user_id": 2475001, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a4a1c8f24170d74a620eab3dd8684dc4?s=128&d=identicon&r=PG", "display_name": "ponayz", "link": "https://stackoverflow.com/users/2475001/ponayz"}, "edited": false, "score": 0, "creation_date": 1559733639, "post_id": 56459421, "comment_id": 99510436, "body": "seems like an answer to me"}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 1, "creation_date": 1559736153, "post_id": 56459421, "comment_id": 99511563, "body": "You need to think clearly about what you&#39;re doing.  Look at the code.  The very first time through the loop, it is comparing <code>a[0]</code> with itself, setting <code>f</code> to 1, and exiting the loop.  Clearly not right.  And even if you skip the first element, suppose <code>a[0]</code> and <code>a[1]</code> are the same and everything else differs.  The same thing will happen.  If <i>any</i> pair differ, then you need to set <code>f</code> to 0.  So initialize <code>f</code> to 1, and if any pair differ, set it to 0 and exit the loop."}], "answers": [{"comments": [{"owner": {"reputation": 197, "user_id": 5983050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/333234567d7a296851388bf6c6d8669f?s=128&d=identicon&r=PG", "display_name": "pjaj", "link": "https://stackoverflow.com/users/5983050/pjaj"}, "edited": false, "score": 0, "creation_date": 1559737333, "post_id": 56459476, "comment_id": 99512146, "body": "Maybe initialise f to <code>TRUE</code> and set it to <code>FALSE</code> if, for some i, <code>a[i] != a[0]</code> . The test at the end then becomes <code>if(f) ...</code>"}], "tags": [], "owner": {"reputation": 156300, "user_id": 1782465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b45d92faaf9d122bfed585490e0bafc5?s=128&d=identicon&r=PG", "display_name": "Angew is no longer proud of SO", "link": "https://stackoverflow.com/users/1782465/angew-is-no-longer-proud-of-so"}, "is_accepted": false, "score": 3, "last_activity_date": 1559733648, "creation_date": 1559733648, "answer_id": 56459476, "question_id": 56459421, "link": "https://stackoverflow.com/questions/56459421/i-want-to-check-whether-all-elementsintegers-from-starting-to-ending-in-an-arr/56459476#56459476", "title": "I want to check whether all elements(integers) from starting to ending in an array are equal", "body": "<p>Just invert the logic, really. And you can start iterating from 1, since you're comparing to <code>a[0]</code>:</p>\n\n<pre><code>f = 1;\nfor (i = 1; i &lt; n; ++i)\n  if (a[i] != a[0]) {\n    f = 0;\n    break;\n  }\n\nif (f == 1)\n  printf(\"All elements are the same\");\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1189, "user_id": 9232218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ced53adbb0ba08d1cea65a43b124d?s=128&d=identicon&r=PG&f=1", "display_name": "Yastanub", "link": "https://stackoverflow.com/users/9232218/yastanub"}, "edited": false, "score": 1, "creation_date": 1559736385, "post_id": 56459483, "comment_id": 99511680, "body": "I think pure code answers are as less helpful as pure link answers a bit of explanation should not be too much work."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 1189, "user_id": 9232218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ced53adbb0ba08d1cea65a43b124d?s=128&d=identicon&r=PG&f=1", "display_name": "Yastanub", "link": "https://stackoverflow.com/users/9232218/yastanub"}, "edited": false, "score": 0, "creation_date": 1559738126, "post_id": 56459483, "comment_id": 99512573, "body": "@Yastanub Alternatively a professional or enthusiast programmer can look at the original code for 5 seconds and figure out the solution themselves - that&#39;s not too much work either. This is such utterly trivial stuff that no explanation should be needed."}, {"owner": {"reputation": 1189, "user_id": 9232218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ced53adbb0ba08d1cea65a43b124d?s=128&d=identicon&r=PG&f=1", "display_name": "Yastanub", "link": "https://stackoverflow.com/users/9232218/yastanub"}, "edited": false, "score": 0, "creation_date": 1559738712, "post_id": 56459483, "comment_id": 99512913, "body": "If OP struggles with such a trivial problem it is pretty much a good idea to give an explanation. You cant compare a professional programer to a beginner you need to relativate their skill levels and their comprehensiveness. A professional programmer can for sure look at that code in 5 seconds and understand it but for an absolute beginner it might be not that understandable. Just imagine what a moderate problem like some algorithm. A professional programmer would udnerstand the code without explanation but someone with less knowledge might not. Would you leave the explanation out there?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 1189, "user_id": 9232218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ced53adbb0ba08d1cea65a43b124d?s=128&d=identicon&r=PG&f=1", "display_name": "Yastanub", "link": "https://stackoverflow.com/users/9232218/yastanub"}, "edited": false, "score": 0, "creation_date": 1559738985, "post_id": 56459483, "comment_id": 99513078, "body": "@Yastanub This is supposedly a site for professional or enthusiast programmers, not an interactive beginner tutorial. But sure, I can as well delete this answer, down vote the OP for posting chapter 1 beginner-level questions and move on. I&#39;m sure they&#39;ll thank you."}, {"owner": {"reputation": 1189, "user_id": 9232218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ced53adbb0ba08d1cea65a43b124d?s=128&d=identicon&r=PG&f=1", "display_name": "Yastanub", "link": "https://stackoverflow.com/users/9232218/yastanub"}, "edited": false, "score": 0, "creation_date": 1559739323, "post_id": 56459483, "comment_id": 99513289, "body": "What do you define as an &quot;enthusiast&quot; programmer? I could know very little about programming but could be very enthusastic to learn more about it and then search for help in SO. If you want to help especially beginners you should include an explanation. If you dont want to help them ignore them. If you dont like them/dont want them to post here downvote them if that pleases you."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 1189, "user_id": 9232218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ced53adbb0ba08d1cea65a43b124d?s=128&d=identicon&r=PG&f=1", "display_name": "Yastanub", "link": "https://stackoverflow.com/users/9232218/yastanub"}, "edited": false, "score": 0, "creation_date": 1559739696, "post_id": 56459483, "comment_id": 99513535, "body": "@Yastanub &quot;Enthusiast&quot; is SO&#39;s very subjective definition that&#39;s been around since day 1, <a href=\"https://meta.stackoverflow.com/questions/258081/should-professionals-and-enthusiasts-be-qualified-in-the-help-center\">see this for example</a>. Historically, the site has gone from mostly professional programmers helping each other, to the homework garbage dump that it is today. I suspect an &quot;enthusiast&quot; with SO&#39;s current definition today is someone who can type stuff with a keyboard."}, {"owner": {"reputation": 1189, "user_id": 9232218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ced53adbb0ba08d1cea65a43b124d?s=128&d=identicon&r=PG&f=1", "display_name": "Yastanub", "link": "https://stackoverflow.com/users/9232218/yastanub"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1559739893, "post_id": 56459483, "comment_id": 99513648, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/194485/discussion-between-yastanub-and-lundin\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": -1, "last_activity_date": 1559733673, "creation_date": 1559733673, "answer_id": 56459483, "question_id": 56459421, "link": "https://stackoverflow.com/questions/56459421/i-want-to-check-whether-all-elementsintegers-from-starting-to-ending-in-an-arr/56459483#56459483", "title": "I want to check whether all elements(integers) from starting to ending in an array are equal", "body": "<pre><code>f = 1;\n...\nif(a[0] != a[i])\n{\n  f = 0;\n  break;\n}\n...\nif(f == 1)\n    printf(\"All elements are same\");\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user11116003"}, "is_accepted": false, "score": 0, "last_activity_date": 1559733786, "creation_date": 1559733786, "answer_id": 56459521, "question_id": 56459421, "link": "https://stackoverflow.com/questions/56459421/i-want-to-check-whether-all-elementsintegers-from-starting-to-ending-in-an-arr/56459521#56459521", "title": "I want to check whether all elements(integers) from starting to ending in an array are equal", "body": "<p>A good idea for check if all list items are equal, is to find <strong>min</strong> and <strong>max</strong>, and compere them.</p>\n\n<ul>\n<li><p><strong>If they are equal</strong> - that means that the whole list (or arry and etc.) is equal.</p></li>\n<li><p><strong>If they are not equal</strong> - that means that not the whole list is equal.</p></li>\n</ul>\n\n<p>Good Luck!</p>\n"}, {"tags": [], "owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "is_accepted": false, "score": 1, "last_activity_date": 1559735053, "creation_date": 1559735053, "answer_id": 56459827, "question_id": 56459421, "link": "https://stackoverflow.com/questions/56459421/i-want-to-check-whether-all-elementsintegers-from-starting-to-ending-in-an-arr/56459827#56459827", "title": "I want to check whether all elements(integers) from starting to ending in an array are equal", "body": "<p>Here's another approach, more similar to your idea than other answers</p>\n\n<pre><code>f = 0; // start with 0 equals\nfor(i=0;i&lt;n;++i)\n{\n    if(a[0] == a[i])\n    {\n        f += 1; // add 1 when finds pair of equals\n        // break; // don't break: look at **ALL** elements\n    }\n}\nif(f == n) /* if total pairs is total elements */\nprintf(\"All elements are same\");\n</code></pre>\n\n<p>Note: this approach has to look at <strong>ALL</strong> elements. It is much more efficient to use an approach that minimizes the number of elements to compare.</p>\n"}], "owner": {"reputation": 1, "user_id": 11589055, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d62b059c306040e2604c3d5f1aa4fb6?s=128&d=identicon&r=PG&f=1", "display_name": "EAGALA  BHANU PRAKASH", "link": "https://stackoverflow.com/users/11589055/eagala-bhanu-prakash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "answer_count": 4, "score": -2, "last_activity_date": 1559735382, "creation_date": 1559733454, "last_edit_date": 1559734398, "question_id": 56459421, "link": "https://stackoverflow.com/questions/56459421/i-want-to-check-whether-all-elementsintegers-from-starting-to-ending-in-an-arr", "title": "I want to check whether all elements(integers) from starting to ending in an array are equal", "body": "<p>In an array, I have to check whether all elements are same.\nFor example:\n<code>a[]={2,2,2,2,2,2,2}</code></p>\n\n<pre><code>    for(i=0;i&lt;n;++i)\n    {\n        if(a[0] == a[i])\n        {\n            f = 1;\n            break;\n        }\n    }\n    if(f == 1)\n    printf(\"All elements are same\");\n</code></pre>\n\n<p>It is giving me true, when any two elements are same. But I have to check whether all elements are same or not.</p>\n"}, {"tags": ["c", "pointers", "vector"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1559733107, "post_id": 56459296, "comment_id": 99510168, "body": "Unrelated to your problem, but regarding that symbol <code>__vec</code>, please see <a href=\"https://stackoverflow.com/a/1449301/440558\">this old answer</a>."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1559733141, "post_id": 56459296, "comment_id": 99510190, "body": "As for your problem, you have many pointer variables (like for example <code>vec1</code> and <code>vec2</code> in the <code>main</code> function). But <i>where do these pointers really point?</i> I really recommend you get a few text-books to read and learn about pointers."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1559733543, "post_id": 56459296, "comment_id": 99510393, "body": "Third question today with this problem... what&#39;s going on, did people stop studying programming books entirely?"}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1559733789, "post_id": 56459296, "comment_id": 99510506, "body": "@Lundin how to know ? ^^"}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1559733812, "post_id": 56459296, "comment_id": 99510518, "body": "There are several problems in your code, see my answer"}], "answers": [{"tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": 0, "last_activity_date": 1559733188, "last_edit_date": 1559733188, "creation_date": 1559733128, "answer_id": 56459344, "question_id": 56459296, "link": "https://stackoverflow.com/questions/56459296/how-works-pointer-on-function-in-c/56459344#56459344", "title": "How works pointer on function in C", "body": "<p><code>vec* vec1;</code> you do not allocatememory for it so you cant dereference the pointer</p>\n\n<p><code>vec* vec1 = malloc(sizeof(*vec1));</code></p>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 7094707, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7af70c3cbb28b40002b245cbd17dd0f0?s=128&d=identicon&r=PG&f=1", "display_name": "snaaketv", "link": "https://stackoverflow.com/users/7094707/snaaketv"}, "edited": false, "score": 1, "creation_date": 1559743079, "post_id": 56459353, "comment_id": 99515591, "body": "Thank&#39;s you very much, my bad, I understand my mistake and thanks for  valgrind, i didn&#39;t know this !"}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "reply_to_user": {"reputation": 3, "user_id": 7094707, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7af70c3cbb28b40002b245cbd17dd0f0?s=128&d=identicon&r=PG&f=1", "display_name": "snaaketv", "link": "https://stackoverflow.com/users/7094707/snaaketv"}, "edited": false, "score": 0, "creation_date": 1559743271, "post_id": 56459353, "comment_id": 99515695, "body": "@snaaketv you welcome, yes <i>valgrind</i> is a fantastic tool, use it even when you think your program works well"}], "tags": [], "owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "is_accepted": true, "score": 3, "last_activity_date": 1559735446, "last_edit_date": 1559735446, "creation_date": 1559733143, "answer_id": 56459353, "question_id": 56459296, "link": "https://stackoverflow.com/questions/56459296/how-works-pointer-on-function-in-c/56459353#56459353", "title": "How works pointer on function in C", "body": "<blockquote>\n  <p>How works pointer on function in C</p>\n</blockquote>\n\n<p>they work well if they are set to a valid address, this is not the case in your program.</p>\n\n<p>In</p>\n\n<blockquote>\n<pre><code>vec *new_vec(double x, double y) {\n\n   vec* vector;\n\n   vector-&gt;x = x;\n\n   vector-&gt;y = y;\n\n   return vector;\n\n}\n</code></pre>\n</blockquote>\n\n<p>you missed to allocate the vector, <em>vector</em> is not set but you dereference it, the behavior in undefined (typically can be a crash)</p>\n\n<p>do</p>\n\n<pre><code> vec* vector = malloc(sizeof(vec));\n</code></pre>\n\n<p>Same problem in</p>\n\n<blockquote>\n<pre><code>vec *add_vec(const vec *const v1, const vec *const v2) {\n\n   vec* vector_result;\n\n   vector_result-&gt;x = v1-&gt;x;\n\n   vector_result-&gt;y = v2-&gt;y;\n\n   return vector_result;\n}\n</code></pre>\n</blockquote>\n\n<p>do</p>\n\n<pre><code>vec* vector_result = malloc(sizeof(vec));\n</code></pre>\n\n<p>And again same problem in <em>main</em> :</p>\n\n<blockquote>\n<pre><code>int main(int argc, char *argv[]) {\n\n   vec* vec1;\n\n   vec* vec2;\n\n\n\n   vec1-&gt;x = 2.0;\n\n   vec1-&gt;y = 3.0;\n\n\n\n   vec2-&gt;x = 4.0;\n\n   vec2-&gt;y = 7.0;\n\n   vec* vector = add_vec(vec1, vec2);\n</code></pre>\n</blockquote>\n\n<p>probably you wanted to do</p>\n\n<pre><code>vec * vec1 = new_vec(2.0, 3.0);\nvec * vec2 = new_vec(4.0, 7.0);\nvec * vector = add_vec(vec1, vec2);\n</code></pre>\n\n<p>but you can also do not allocate the <em>vec1</em> and <em>vec2</em> because they are temporary and just used to initialize <em>vector</em> :</p>\n\n<pre><code>int main(int argc, char *argv[]) {\n    vec vec1;\n    vec vec2;\n\n    vec1.x = 2.0;\n    vec1.y = 3.0;\n\n    vec2.x = 4.0;\n    vec2.y = 7.0;\n\n    vec* vector = add_vec(&amp;vec1,&amp;vec2);\n    ...\n</code></pre>\n\n<p>Note your code never free the allocated blocks, to do that and also modifying the <em>printf</em> for a more readable result and removing the useless parameters :</p>\n\n<pre><code>int main(void) {\n    vec vec1;\n    vec vec2;\n\n    vec1.x = 2.0;\n    vec1.y = 3.0;\n\n    vec2.x = 4.0;\n    vec2.y = 7.0;\n\n    vec* vector = add_vec(&amp;vec1,&amp;vec2);\n\n    printf(\"%f %f\\n\", vector-&gt;x, vector-&gt;y);\n    free(vector);\n}\n</code></pre>\n\n<p>Compilation and execution:</p>\n\n<pre><code>pi@raspberrypi:/tmp $ gcc -pedantic -Wall -Wextra -g v.c\npi@raspberrypi:/tmp $ ./a.out\n2.000000 7.000000\n</code></pre>\n\n<p>Execution under <em>valgrind</em> :</p>\n\n<pre><code>pi@raspberrypi:/tmp $ valgrind ./a.out\n==3154== Memcheck, a memory error detector\n==3154== Copyright (C) 2002-2017, and GNU GPL'd, by Julian Seward et al.\n==3154== Using Valgrind-3.13.0 and LibVEX; rerun with -h for copyright info\n==3154== Command: ./a.out\n==3154== \n2.000000 7.000000\n==3154== \n==3154== HEAP SUMMARY:\n==3154==     in use at exit: 0 bytes in 0 blocks\n==3154==   total heap usage: 2 allocs, 2 frees, 1,040 bytes allocated\n==3154== \n==3154== All heap blocks were freed -- no leaks are possible\n==3154== \n==3154== For counts of detected and suppressed errors, rerun with: -v\n==3154== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 6 from 3)\npi@raspberrypi:/tmp $ \n</code></pre>\n\n<p>Or allocating <em>vec1</em> and <em>vec2</em> :</p>\n\n<pre><code>int main(void) {\n    vec * vec1 = new_vec(2.0, 3.0);\n    vec * vec2 = new_vec(4.0, 7.0);\n\n    vec* vector = add_vec(vec1, vec2);\n\n    // vec1 and vec2 useless from here\n    free(vec1);\n    free(vec2);\n\n    printf(\"%f %f\\n\", vector-&gt;x, vector-&gt;y);\n    free(vector);\n}\n</code></pre>\n\n<p>Compilation and execution :</p>\n\n<pre><code>pi@raspberrypi:/tmp $ gcc -pedantic -Wall -Wextra -g v.c\npi@raspberrypi:/tmp $ ./a.out\n2.000000 7.000000\npi@raspberrypi:/tmp $ \n</code></pre>\n\n<p>Execution under <em>valgrind</em> :</p>\n\n<pre><code>pi@raspberrypi:/tmp $ valgrind ./a.out\n==3191== Memcheck, a memory error detector\n==3191== Copyright (C) 2002-2017, and GNU GPL'd, by Julian Seward et al.\n==3191== Using Valgrind-3.13.0 and LibVEX; rerun with -h for copyright info\n==3191== Command: ./a.out\n==3191== \n2.000000 7.000000\n==3191== \n==3191== HEAP SUMMARY:\n==3191==     in use at exit: 0 bytes in 0 blocks\n==3191==   total heap usage: 4 allocs, 4 frees, 1,072 bytes allocated\n==3191== \n==3191== All heap blocks were freed -- no leaks are possible\n==3191== \n==3191== For counts of detected and suppressed errors, rerun with: -v\n==3191== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 6 from 3)\npi@raspberrypi:/tmp $ \n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7094707, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7af70c3cbb28b40002b245cbd17dd0f0?s=128&d=identicon&r=PG&f=1", "display_name": "snaaketv", "link": "https://stackoverflow.com/users/7094707/snaaketv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "closed_date": 1559733458, "accepted_answer_id": 56459353, "answer_count": 2, "score": -1, "last_activity_date": 1559735446, "creation_date": 1559732950, "question_id": 56459296, "link": "https://stackoverflow.com/questions/56459296/how-works-pointer-on-function-in-c", "closed_reason": "Duplicate", "title": "How works pointer on function in C", "body": "<p>I have a problem of compilation \"Core dumped\" and I don't understand why.</p>\n\n<p>I have a struct for a vector and i have to add two vector together. If someone can explain me why that don't work, i will appreciate the help!</p>\n\n<p>Thanks you !</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>typedef struct __vec\n{\n    double x, y;\n} vec;\n\n\nvec *new_vec(double x, double y) {\n\n    vec* vector;\n\n    vector-&gt;x = x;\n\n    vector-&gt;y = y;\n\n    return vector;\n\n}\n\nvec *add_vec(const vec *const v1, const vec *const v2) {\n\n    vec* vector_result;\n\n    vector_result-&gt;x = v1-&gt;x;\n\n    vector_result-&gt;y = v2-&gt;y;\n\n    return vector_result;\n}\n\nint main(int argc, char *argv[]) {\n\n    vec* vec1;\n\n    vec* vec2;\n\n\n\n    vec1-&gt;x = 2.0;\n\n    vec1-&gt;y = 3.0;\n\n\n\n    vec2-&gt;x = 4.0;\n\n    vec2-&gt;y = 7.0;\n\n\n\n    vec* vector = add_vec(vec1,vec2);\n\n    printf(\"%f%f\", vector-&gt;x, vector-&gt;y);\n\n}\n\n</code></pre>\n"}, {"tags": ["c", "tcp", "network-programming", "getaddrinfo"], "comments": [{"owner": {"reputation": 1189, "user_id": 9232218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ced53adbb0ba08d1cea65a43b124d?s=128&d=identicon&r=PG&f=1", "display_name": "Yastanub", "link": "https://stackoverflow.com/users/9232218/yastanub"}, "edited": false, "score": 1, "creation_date": 1559734332, "post_id": 56459275, "comment_id": 99510727, "body": "Okay i searched a bit around and indeed the man pages state that the above mentioned defines should be in <code>netdb.h</code>. However they are not at least for the header on my system and the header of <a href=\"https://pubs.opengroup.org/onlinepubs/009695399/basedefs/netdb.h.html\" rel=\"nofollow noreferrer\">the open group</a> and appearently yours too. They are however defined in <code>addrinfo.h</code> but that will give conflicts about multiple definition. Thats what bothers me sometimes the man pages are just a confusing mess"}, {"owner": {"reputation": 370, "user_id": 4959688, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1eb1d4395875de881f67efcbbafe0955?s=128&d=identicon&r=PG&f=1", "display_name": "asfeynman", "link": "https://stackoverflow.com/users/4959688/asfeynman"}, "reply_to_user": {"reputation": 1189, "user_id": 9232218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ced53adbb0ba08d1cea65a43b124d?s=128&d=identicon&r=PG&f=1", "display_name": "Yastanub", "link": "https://stackoverflow.com/users/9232218/yastanub"}, "edited": false, "score": 0, "creation_date": 1559736635, "post_id": 56459275, "comment_id": 99511796, "body": "Hmm, when I examine <code>netdb.h</code> on my system, it does seem to be in there but only when <code>__USE_GNU</code> is defined. I&#39;ll have to see how that flag is enabled."}, {"owner": {"reputation": 1189, "user_id": 9232218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ced53adbb0ba08d1cea65a43b124d?s=128&d=identicon&r=PG&f=1", "display_name": "Yastanub", "link": "https://stackoverflow.com/users/9232218/yastanub"}, "edited": false, "score": 0, "creation_date": 1559736655, "post_id": 56459275, "comment_id": 99511810, "body": "As an addition you could use <code>gai_strerror()</code> to convert any returned result into a readable string for error output. This however means you can not react to an error but just message and exit."}, {"owner": {"reputation": 1189, "user_id": 9232218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ced53adbb0ba08d1cea65a43b124d?s=128&d=identicon&r=PG&f=1", "display_name": "Yastanub", "link": "https://stackoverflow.com/users/9232218/yastanub"}, "edited": false, "score": 0, "creation_date": 1559736753, "post_id": 56459275, "comment_id": 99511850, "body": "see <a href=\"https://stackoverflow.com/a/7297011/9232218\">this answer</a> for enabling __USE_GNU yourself"}, {"owner": {"reputation": 370, "user_id": 4959688, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1eb1d4395875de881f67efcbbafe0955?s=128&d=identicon&r=PG&f=1", "display_name": "asfeynman", "link": "https://stackoverflow.com/users/4959688/asfeynman"}, "reply_to_user": {"reputation": 1189, "user_id": 9232218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ced53adbb0ba08d1cea65a43b124d?s=128&d=identicon&r=PG&f=1", "display_name": "Yastanub", "link": "https://stackoverflow.com/users/9232218/yastanub"}, "edited": false, "score": 0, "creation_date": 1559736915, "post_id": 56459275, "comment_id": 99511928, "body": "@Yastanub  I&#39;m a little bit weary about defining <code>_GNU_SOURCE</code> myself. Do you know whether this definition is <i>supposed</i> to be user defined, or is is enabled by use of some compiler flag?"}, {"owner": {"reputation": 1189, "user_id": 9232218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ced53adbb0ba08d1cea65a43b124d?s=128&d=identicon&r=PG&f=1", "display_name": "Yastanub", "link": "https://stackoverflow.com/users/9232218/yastanub"}, "edited": false, "score": 1, "creation_date": 1559737134, "post_id": 56459275, "comment_id": 99512047, "body": "<a href=\"https://stackoverflow.com/a/5583764/9232218\">Take a look here</a> I somethimes find it very difficult to work with posix functions since the documentaries are sometimes so ambigous and i have never before used <code>_GNU_SOURCE</code> myself before."}, {"owner": {"reputation": 370, "user_id": 4959688, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1eb1d4395875de881f67efcbbafe0955?s=128&d=identicon&r=PG&f=1", "display_name": "asfeynman", "link": "https://stackoverflow.com/users/4959688/asfeynman"}, "reply_to_user": {"reputation": 1189, "user_id": 9232218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ced53adbb0ba08d1cea65a43b124d?s=128&d=identicon&r=PG&f=1", "display_name": "Yastanub", "link": "https://stackoverflow.com/users/9232218/yastanub"}, "edited": false, "score": 0, "creation_date": 1559737512, "post_id": 56459275, "comment_id": 99512251, "body": "@Yastanub, Sounds good. Thanks for your help!"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1559737755, "post_id": 56459275, "comment_id": 99512365, "body": "If you don&#39;t want to define <code>_GNU_SOURCE</code>, does <code>-D_XOPEN_SOURCE=600</code> or <code>-D_POSIX_C_SOURCE=200112L</code> work?"}, {"owner": {"reputation": 370, "user_id": 4959688, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1eb1d4395875de881f67efcbbafe0955?s=128&d=identicon&r=PG&f=1", "display_name": "asfeynman", "link": "https://stackoverflow.com/users/4959688/asfeynman"}, "reply_to_user": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1559738035, "post_id": 56459275, "comment_id": 99512518, "body": "@IanAbbott No, neither of those flags work."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1559745851, "post_id": 56459275, "comment_id": 99517169, "body": "Oh I see it&#39;s just the GNU-specific <code>EAI_</code> macros you are having trouble with. Defining <code>_POSIX_C_SOURCE</code> to be &gt;= <code>200112L</code> only defines the POSIX standard <code>EAI_</code> macros."}], "answers": [{"comments": [{"owner": {"reputation": 1189, "user_id": 9232218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ced53adbb0ba08d1cea65a43b124d?s=128&d=identicon&r=PG&f=1", "display_name": "Yastanub", "link": "https://stackoverflow.com/users/9232218/yastanub"}, "edited": false, "score": 1, "creation_date": 1559738839, "post_id": 56460556, "comment_id": 99512988, "body": "But note that there may be a reason these codes where excluded from posix as described <a href=\"https://stackoverflow.com/questions/5582211/what-does-define-gnu-source-imply/5583764#5583764\">here</a>"}], "tags": [], "owner": {"reputation": 370, "user_id": 4959688, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1eb1d4395875de881f67efcbbafe0955?s=128&d=identicon&r=PG&f=1", "display_name": "asfeynman", "link": "https://stackoverflow.com/users/4959688/asfeynman"}, "is_accepted": true, "score": 2, "last_activity_date": 1559737880, "creation_date": 1559737880, "answer_id": 56460556, "question_id": 56459275, "link": "https://stackoverflow.com/questions/56459275/how-can-i-fix-getaddrinfo-definitions-not-being-found/56460556#56460556", "title": "How can I fix `getaddrinfo` definitions not being found?", "body": "<p>It turned out that although the two definitions, <code>EAI_ADDRFAMILY</code> and <code>EAI_NODATA</code>, were defined in <code>netdb.h</code> on my system, they were <em>not</em> enabled because it required that <code>__USE_GNU</code> be defined.</p>\n\n<p>To enable <code>__USE_GNU</code> (indirectly), we define <code>_GNU_SOURCE</code> at the top of the file. The working file is the following:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>// Name: main.c\n// Compile: gcc -std=gnu11 main.c\n\n#define _GNU_SOURCE // Need for EAI_ADDRFAMILY and EAI_NODATA\n\n#include &lt;stddef.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;netdb.h&gt;\n\nint main()\n{\n    struct addrinfo* res;\n    char* domain = \"google.com\";\n\n    switch(getaddrinfo(domain, \"http\", NULL, &amp;res))\n    {\n        case 0:\n            break;\n        case EAI_ADDRFAMILY:\n            break;\n        case EAI_AGAIN:\n            break;\n        case EAI_BADFLAGS:\n            break;\n        case EAI_FAIL:\n            break;\n        case EAI_FAMILY:\n            break;\n        case EAI_MEMORY:\n            break;\n        case EAI_NODATA:\n            break;\n        case EAI_NONAME:\n            break;\n        case EAI_SERVICE:\n            break;\n        case EAI_SOCKTYPE:\n            break;\n    }\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 370, "user_id": 4959688, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1eb1d4395875de881f67efcbbafe0955?s=128&d=identicon&r=PG&f=1", "display_name": "asfeynman", "link": "https://stackoverflow.com/users/4959688/asfeynman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 523, "favorite_count": 0, "accepted_answer_id": 56460556, "answer_count": 1, "score": 1, "last_activity_date": 1559737880, "creation_date": 1559732818, "question_id": 56459275, "link": "https://stackoverflow.com/questions/56459275/how-can-i-fix-getaddrinfo-definitions-not-being-found", "title": "How can I fix `getaddrinfo` definitions not being found?", "body": "<p>I get the following errors when I try to compile my code:</p>\n\n<pre><code>main.c:13:40: note: each undeclared identifier is reported only once for each function it appears in\nmain.c:17:14: error: \u2018EAI_ADDRFAMILY\u2019 undeclared (first use in this function); did you mean \u2018EAI_FAMILY\u2019?\n         case EAI_ADDRFAMILY:\n              ^~~~~~~~~~~~~~\n              EAI_FAMILY\nmain.c:29:14: error: \u2018EAI_NODATA\u2019 undeclared (first use in this function); did you mean \u2018EAI_NONAME\u2019?\n         case EAI_NODATA:\n              ^~~~~~~~~~\n              EAI_NONAME\n</code></pre>\n\n<p>I've tried including different headers (e.g. <code>netinet/in.h</code>) as well as compiling with different standards (<code>gnu90</code>, <code>gnu99</code>, <code>gnu11</code>), but nothing seems to resolve the error.</p>\n\n<p>The following is my code:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>// Name: main.c\n// Compile: gcc -std=gnu11 main.c\n// Error:\n//   main.c: In function \u2018main\u2019:\n//   main.c:18:14: error: \u2018EAI_ADDRFAMILY\u2019 undeclared (first use in this function); did you mean \u2018EAI_FAMILY\u2019?\n//            case EAI_ADDRFAMILY:\n//                 ^~~~~~~~~~~~~~\n//                 EAI_FAMILY\n//   main.c:18:14: note: each undeclared identifier is reported only once for each function it appears in\n//   main.c:30:14: error: \u2018EAI_NODATA\u2019 undeclared (first use in this function); did you mean \u2018EAI_NONAME\u2019?\n//            case EAI_NODATA:\n//                 ^~~~~~~~~~\n//                 EAI_NONAME\n\n#include &lt;stddef.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;netdb.h&gt;\n\nint main()\n{\n    struct addrinfo* res;\n    char* domain = \"google.com\";\n\n    switch(getaddrinfo(domain, \"http\", NULL, &amp;res))\n    {\n        case 0:\n            break;\n        case EAI_ADDRFAMILY:\n            break;\n        case EAI_AGAIN:\n            break;\n        case EAI_BADFLAGS:\n            break;\n        case EAI_FAIL:\n            break;\n        case EAI_FAMILY:\n            break;\n        case EAI_MEMORY:\n            break;\n        case EAI_NODATA:\n            break;\n        case EAI_NONAME:\n            break;\n        case EAI_SERVICE:\n            break;\n        case EAI_SOCKTYPE:\n            break;\n    }\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "c-strings"], "comments": [{"owner": {"reputation": 1189, "user_id": 9232218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ced53adbb0ba08d1cea65a43b124d?s=128&d=identicon&r=PG&f=1", "display_name": "Yastanub", "link": "https://stackoverflow.com/users/9232218/yastanub"}, "edited": false, "score": 2, "creation_date": 1559732639, "post_id": 56459137, "comment_id": 99509958, "body": "Where is <code>value</code> defined? How is <code>TRUE&#47;FALSE</code> defined? Also please post the complete error message and elaborate where in the code it appears (usually the compiler says in which line it has problems)"}, {"owner": {"reputation": 1189, "user_id": 9232218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ced53adbb0ba08d1cea65a43b124d?s=128&d=identicon&r=PG&f=1", "display_name": "Yastanub", "link": "https://stackoverflow.com/users/9232218/yastanub"}, "edited": false, "score": 2, "creation_date": 1559732758, "post_id": 56459137, "comment_id": 99510008, "body": "Okay i now saw the comment your problem is <code>(string2[j]= &#39;a&#39;..</code> this is an assignement not a comparison you should use <code>==</code>. Also the expression will always be false because the same character cant be several characters at once you may use <code>||</code> logical or or <code>strcmp()</code>"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 2, "creation_date": 1559732812, "post_id": 56459137, "comment_id": 99510034, "body": "Welcome to SO. Unfortunately some parts are missing: Where do you get this error message? Where is <code>value</code> defined? What is the purpose of declaring <code>is_vowel</code> inside <code>verify_vowel</code>? Please read <a href=\"https://stackoverflow.com/help/how-to-ask\">How To ask</a> and provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">MCVE</a>"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 1, "creation_date": 1559732870, "post_id": 56459137, "comment_id": 99510064, "body": "<code>ret= is_vowel(string);</code>The function takes a <code>char</code> but you provide a <code>char *</code>"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1559736646, "post_id": 56459137, "comment_id": 99511801, "body": "Note that <code>verify_vowel()</code> is not used. There is a great deal wrong with the code. For example in <code>is_vowel()</code> the variable <code>char string2[LENGTH];</code> is not initialised, but is checked. Also, the iteration does not terminate on failure but returns the state of the final character, regardless of what else was found. But the function is incomplete and does not return a value anyway."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1559790384, "post_id": 56459137, "comment_id": 99531903, "body": "regarding: <code>char string2[LENGTH];     for(j=0; j&lt;length ...         if(string2[j]= &#39;a&#39; &amp;&amp; string2[j]= &#39;e&#39; &amp;&amp; string2[j]=&#39;i&#39; &amp;&amp; string2[j]=&#39;o&#39; &amp;&amp; string2[j]= &#39;u&#39;)</code>  The array: <code>string2]</code> is not initialized so contains what every trash was on the stack at its&#39; location.  You compiler should have told you about using an uninitialized variable"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1559790496, "post_id": 56459137, "comment_id": 99531922, "body": "Please post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> so we can reproduce the problem and help you debug it"}], "answers": [{"tags": [], "owner": {"reputation": 402, "user_id": 11527039, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd22ca322c7ea2174c1daf9628a2bc90?s=128&d=identicon&r=PG&f=1", "display_name": "EUS", "link": "https://stackoverflow.com/users/11527039/eus"}, "is_accepted": true, "score": 3, "last_activity_date": 1559749273, "last_edit_date": 1559749273, "creation_date": 1559738561, "answer_id": 56460718, "question_id": 56459137, "link": "https://stackoverflow.com/questions/56459137/how-to-fix-this-expression-is-not-assignable-error/56460718#56460718", "title": "How to fix this expression is not assignable error?", "body": "<p><code>=</code> is used for assignment, while <code>==</code> is used for comparison (you can use <code>strcmp</code> too if you want). In this case, you are assigning instead of comparing, that's why you get the error. Moreover, <code>verify_vowel</code> is never used. You can do it this way</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint is_vowel(char *element, int length){\n    for(int j=0; j&lt;length; j++){\n        if(!(element[j]== 'a' || element[j]== 'e' || \n            element[j]== 'i' || element[j]== 'o' || \n            element[j]== 'u')){\n            return 0;\n        }\n    }\n    return 1;\n}\n\nint main()\n{\n    char *string= \"aeifou\";\n    int ret;\n    ret= is_vowel(string,strlen(string));\n    printf(\"Result: %d\\n\",ret);\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 11603156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6173ad1f3daf5f478a9e52695cf53b43?s=128&d=identicon&r=PG&f=1", "display_name": "Oyo", "link": "https://stackoverflow.com/users/11603156/oyo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1010, "favorite_count": 0, "accepted_answer_id": 56460718, "answer_count": 1, "score": 1, "last_activity_date": 1559749273, "creation_date": 1559732361, "last_edit_date": 1559733599, "question_id": 56459137, "link": "https://stackoverflow.com/questions/56459137/how-to-fix-this-expression-is-not-assignable-error", "title": "How to fix this expression is not assignable error?", "body": "<p>I need to do this method where I have a string and it should all be vowels or else the method will return false, but I am getting this expression assignable error, I am just a beginner in coding, could someone please help me? Thanks!</p>\n\n<pre><code>int verify_vowel(char *string, char elem, int length){\n    if(string != NULL){\n        value= TRUE;\n        for (i=0; i&lt;length &amp;&amp; value == TRUE; i++) {\n            if(string[i] == elem){\n                int is_vowel(char element);\n                value = TRUE;\n            }else{\n                value= FALSE;\n            }\n        }\n    }\n    return 1;\n}\n</code></pre>\n\n<pre><code>int is_vowel(char element){\n    int j;\n    int value1;\n    int length;\n    char string2[LENGTH];\n    value1= TRUE;\n    for(j=0; j&lt;length &amp;&amp; value1== TRUE; j++){\n        if(string2[j]= 'a' &amp;&amp; string2[j]= 'e' &amp;&amp; string2[j]='i' &amp;&amp; string2[j]='o' &amp;&amp; string2[j]= 'u'){ //im getting the error here\n            value1= TRUE;\n        } else{\n            value1= FALSE;\n        }\n    }\n    int main(){\n    char string[]= \"aeiuodsf\";\n    int ret;\n    ret= is_vowel(string);\n    printf(\"Result: %d\\n\",ret);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 22777, "user_id": 133203, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Fp3hB.jpg?s=128&g=1", "display_name": "Federico klez Culloca", "link": "https://stackoverflow.com/users/133203/federico-klez-culloca"}, "edited": false, "score": 1, "creation_date": 1559731832, "post_id": 56458971, "comment_id": 99509600, "body": "What is the value of a function?"}, {"owner": {"reputation": 1, "user_id": 11603603, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/013c93fdb9367db9c9dd82f1fcd4ecfd?s=128&d=identicon&r=PG&f=1", "display_name": "krillin1995", "link": "https://stackoverflow.com/users/11603603/krillin1995"}, "reply_to_user": {"reputation": 22777, "user_id": 133203, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Fp3hB.jpg?s=128&g=1", "display_name": "Federico klez Culloca", "link": "https://stackoverflow.com/users/133203/federico-klez-culloca"}, "edited": false, "score": 0, "creation_date": 1559731975, "post_id": 56458971, "comment_id": 99509669, "body": "The functions have integer values."}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 1, "creation_date": 1559732032, "post_id": 56458971, "comment_id": 99509684, "body": "What value has the <code>Sor1Balra</code> function? How to get this &quot;value&quot;? Is it 1? 100? 200?"}, {"owner": {"reputation": 22777, "user_id": 133203, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Fp3hB.jpg?s=128&g=1", "display_name": "Federico klez Culloca", "link": "https://stackoverflow.com/users/133203/federico-klez-culloca"}, "edited": false, "score": 2, "creation_date": 1559732084, "post_id": 56458971, "comment_id": 99509705, "body": "@krillin1995 you mean the return type? That&#39;s not what I&#39;m asking. I&#39;m asking what&#39;s the logic behind the sorting. What is the &quot;lowest value&quot; and why?"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 2, "creation_date": 1559732320, "post_id": 56458971, "comment_id": 99509798, "body": "Functions do not have integer values. A function may return an integer value, but what value it returns almost always depends on circumstances (mostly its arguments in good designs, but possibly anything in the program state). To sort, you must pick one value to use as the sort key, such as the value the function returns when passed a particular argument."}, {"owner": {"reputation": 1153, "user_id": 11345381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3322e1e397dd7f2626bd3b7280585b1?s=128&d=identicon&r=PG&f=1", "display_name": "rtoijala", "link": "https://stackoverflow.com/users/11345381/rtoijala"}, "edited": false, "score": 1, "creation_date": 1559732326, "post_id": 56458971, "comment_id": 99509804, "body": "What is <code>tomb</code>? Is it meant to be a type or a variable?"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "reply_to_user": {"reputation": 1153, "user_id": 11345381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3322e1e397dd7f2626bd3b7280585b1?s=128&d=identicon&r=PG&f=1", "display_name": "rtoijala", "link": "https://stackoverflow.com/users/11345381/rtoijala"}, "edited": false, "score": 1, "creation_date": 1559733142, "post_id": 56458971, "comment_id": 99510191, "body": "@rtoijala <code>tomb</code> must be a type"}, {"owner": {"reputation": 119716, "user_id": 643383, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/uQ5JF.png?s=128&g=1", "display_name": "Caleb", "link": "https://stackoverflow.com/users/643383/caleb"}, "edited": false, "score": 1, "creation_date": 1559733188, "post_id": 56458971, "comment_id": 99510212, "body": "If you have a question, please ask it. <i>I wanna sort it</i> is not a question."}, {"owner": {"reputation": 1, "user_id": 11603603, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/013c93fdb9367db9c9dd82f1fcd4ecfd?s=128&d=identicon&r=PG&f=1", "display_name": "krillin1995", "link": "https://stackoverflow.com/users/11603603/krillin1995"}, "edited": false, "score": 0, "creation_date": 1559735576, "post_id": 56458971, "comment_id": 99511274, "body": "Sorry about the poorly made question. I&#39;m a beginner(in programming and on stackoverflow too). I edited the question, I hope it&#39;s better now."}], "answers": [{"comments": [{"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1559733107, "post_id": 56459192, "comment_id": 99510170, "body": "As OPs function takes an argument of type <code>tomb</code> I don&#39;t see how <code>qsort</code> can be used - at least not directly."}, {"owner": {"reputation": 374, "user_id": 3739149, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5ngIm.jpg?s=128&g=1", "display_name": "Bakurits", "link": "https://stackoverflow.com/users/3739149/bakurits"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1559733428, "post_id": 56459192, "comment_id": 99510333, "body": "If he wants to pass arguments than we can create array of structs like  <code>struct arg{    myFuncDef func,    tomb arg &#47;&#47; I don&#39;t know what tomb is };</code> and then we should call func with tomb from comparator"}, {"owner": {"reputation": 1, "user_id": 11603603, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/013c93fdb9367db9c9dd82f1fcd4ecfd?s=128&d=identicon&r=PG&f=1", "display_name": "krillin1995", "link": "https://stackoverflow.com/users/11603603/krillin1995"}, "edited": false, "score": 0, "creation_date": 1559735603, "post_id": 56459192, "comment_id": 99511289, "body": "Sorry about the poorly made question. I&#39;m a beginner(in programming and on stackoverflow too). I edited the question, I hope it&#39;s better now."}], "tags": [], "owner": {"reputation": 374, "user_id": 3739149, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5ngIm.jpg?s=128&g=1", "display_name": "Bakurits", "link": "https://stackoverflow.com/users/3739149/bakurits"}, "is_accepted": false, "score": 4, "last_activity_date": 1559734583, "last_edit_date": 1559734583, "creation_date": 1559732530, "answer_id": 56459192, "question_id": 56458971, "link": "https://stackoverflow.com/questions/56458971/sort-an-array-with-function-in-it/56459192#56459192", "title": "Sort an array with function in it", "body": "<p>you should call <code>qsort</code> function from <code>stdlib.h</code> like that \n<code>qsort((void*)arr, size, sizeof(arr[0]), comparator)</code>\nwhere <code>arr</code> is name of array and <code>comparator</code> is function which compares two functions. I assume that this functions don't have arguments. </p>\n\n<pre><code>typedef int (*myFuncDef)();\nint comparator(const void *p, const void *q)  \n{ \n    myFuncDef l = *((myFuncDef*)p); \n    myFuncDef r = *((myFuncDef*)q); \n    return (l() - r()); \n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "is_accepted": false, "score": 2, "last_activity_date": 1559732587, "creation_date": 1559732587, "answer_id": 56459207, "question_id": 56458971, "link": "https://stackoverflow.com/questions/56458971/sort-an-array-with-function-in-it/56459207#56459207", "title": "Sort an array with function in it", "body": "<p>The lowest value of your array functions is the function that <em>returns</em> the lowest value.</p>\n\n<p>In order to determine that, your sort function must call each array funcion and see what each two functions return, e.g. like bubble sort but in stead of comparing the array elements it compares the function returns, for example:</p>\n\n<pre><code>    if (a[i]() &gt; a[i+1]()) /*swap*/\n</code></pre>\n\n<p>Of course this assumes that the functions will always return the same value.</p>\n"}], "owner": {"reputation": 1, "user_id": 11603603, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/013c93fdb9367db9c9dd82f1fcd4ecfd?s=128&d=identicon&r=PG&f=1", "display_name": "krillin1995", "link": "https://stackoverflow.com/users/11603603/krillin1995"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "closed_date": 1559734011, "answer_count": 2, "score": -3, "last_activity_date": 1559736169, "creation_date": 1559731658, "last_edit_date": 1559736169, "question_id": 56458971, "link": "https://stackoverflow.com/questions/56458971/sort-an-array-with-function-in-it", "closed_reason": "Needs details or clarity", "title": "Sort an array with function in it", "body": "<p>There are functions in an array and I wanna sort it, and use the function with the lowest value. I'm trying to make an AI, which is solving the Simon Tatham Sixteen[3x3] game. The functions are operators, and the AI chooseing the operator with the lowest value.</p>\n\n<pre><code>int tomb[3][3]={3,4,7,8,1,2,9,5,6};\n\nint cel[3][3]={1,2,3,4,5,6,7,8,9};\n\nint heurisztika(int tomb[3][3], int cel[3][3]){\n    int i, j, k, l, counter=0, count2=0;\n\n    for(i=0;i&lt;3;i++){\n        for(j=0;j&lt;3;j++){\n            if(tomb[i][j]!=cel[i][j]){\n                counter++;\n            }\n        }\n    }\n\n    for(i=0;i&lt;3;i++){\n        for(j=0;j&lt;3;j++){\n            for(k=0;k&lt;3;k++){\n                for(l=0;l&lt;3;l++){\n                    if(cel[i][j]==tomb[k][l]){\n                        if(i==k &amp;&amp; j==l){\n                            count2=count2+0;\n                        }\n                        else if(i==k || j==l){\n                            count2=count2+1;\n                        }\n                        else if(i!=k &amp;&amp; j!=l){\n                            count2=count2+2;\n                        }\n                    }\n                }\n            }\n        }\n    }\n\n    return counter + count2;\n}\n\nint Sor1Balra(int tomb[3][3]){  //every function look like this\n    int tmp;\n    tmp=tomb[0][2];\n    tomb[0][2]=tomb[0][0];\n    tomb[0][0]=tomb[0][1];\n    tomb[0][1]=tmp;\n\n    int ertek=heurisztika(tomb,cel);\n\n    return ertek;\n}\n\nint (*operatorok[9])(tomb) = {Sor1Balra, Sor1Jobbra, Sor2Balra, Sor2Jobbra, Sor3Balra, Sor3Jobbra, Oszlop1Fel, Oszlop1Le, Oszlop2Fel, Oszlop2Le, Oszlop3Fel, Oszlop3Le};\n</code></pre>\n"}, {"tags": ["c++", "c"], "comments": [{"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 1, "creation_date": 1559729272, "post_id": 56458357, "comment_id": 99508486, "body": "Please don&#39;t double tag languages. C and C++ have very different specifications. Please <a href=\"https://stackoverflow.com/posts/56458357/edit\">edit</a> your tags and only include the language you actually use."}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 10, "creation_date": 1559729314, "post_id": 56458357, "comment_id": 99508508, "body": "Nothing in either language specification mentions timings, so you&#39;re at the mercy of your implementation."}, {"owner": {"reputation": 3355, "user_id": 4114447, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/aa93321ad023953eaaae28b490855e7a?s=128&d=identicon&r=PG&f=1", "display_name": "Dan M.", "link": "https://stackoverflow.com/users/4114447/dan-m"}, "edited": false, "score": 1, "creation_date": 1559729864, "post_id": 56458357, "comment_id": 99508755, "body": "This question would make sense for <code>asm</code>, but is meaningless when discussing higher-level languages. You can&#39;t be sure that your switch would even compile to some set of instructions and not be constant folded away. C/C++ compilers are free to choose any representation for your code as long as it behaves the same in the terms of the abstract machine (that has no notion of timings)."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 1, "creation_date": 1559732482, "post_id": 56458357, "comment_id": 99509884, "body": "Not only is there no guarantee, but the time could be negative, if it exists in any meaningful sense at all. A C implementation could execute the statement after a <code>switch</code> <b>before</b> any statement in the <code>switch</code>."}, {"owner": {"reputation": 1625, "user_id": 263399, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/08774edd95a7fbea5e4f795be6502393?s=128&d=identicon&r=PG", "display_name": "norlesh", "link": "https://stackoverflow.com/users/263399/norlesh"}, "edited": false, "score": 0, "creation_date": 1559734167, "post_id": 56458357, "comment_id": 99510666, "body": "Thank&#39;s all, I have moved the time critical code within each distinct switch case and reorganised so the time sensitive pin write and subsequent timer counter reset are accessed in sequential volatile writes."}], "answers": [{"tags": [], "owner": {"reputation": 26087, "user_id": 1312406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5418f577abfa7c529dd026723462b440?s=128&d=identicon&r=PG", "display_name": "Paul Evans", "link": "https://stackoverflow.com/users/1312406/paul-evans"}, "is_accepted": true, "score": 3, "last_activity_date": 1559729681, "creation_date": 1559729681, "answer_id": 56458503, "question_id": 56458357, "link": "https://stackoverflow.com/questions/56458357/is-the-timing-between-the-end-of-a-switch-statement-and-the-next-statement-deter/56458503#56458503", "title": "Is the timing between the end of a switch statement and the next statement deterministic (independent of path)?", "body": "<blockquote>\n  <p>the assumption that the period between the last instruction of each switch case (presumably some kind of jump or return) and the first statement after the switch will be the same </p>\n</blockquote>\n\n<p>This is implementation dependent behavior.  Best way to find out what's happening is to look at the assembly code generated and perform some timing profiling on your code.</p>\n"}], "owner": {"reputation": 1625, "user_id": 263399, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/08774edd95a7fbea5e4f795be6502393?s=128&d=identicon&r=PG", "display_name": "norlesh", "link": "https://stackoverflow.com/users/263399/norlesh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 56458503, "answer_count": 1, "score": 3, "last_activity_date": 1559729681, "creation_date": 1559729043, "question_id": 56458357, "link": "https://stackoverflow.com/questions/56458357/is-the-timing-between-the-end-of-a-switch-statement-and-the-next-statement-deter", "title": "Is the timing between the end of a switch statement and the next statement deterministic (independent of path)?", "body": "<p>I'm configuring various GPIO pins on a microcontroller (which initiates a process that I need to time) inside a switch statement and then resetting a timer counter immediately after the end of the switch statement on the assumption that the period between the last instruction of each switch case (presumably some kind of jump or return) and the first statement after the switch will be the same independently of which case was executed. </p>\n\n<p>My question - is there anything in c/c++ specifications that would validate my assumptions or am I over reaching and should reset my timer inside each case explicitly?</p>\n"}, {"tags": ["c#", "c++", "c", "icu"], "comments": [{"owner": {"reputation": 793, "user_id": 2684203, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/71zMc.png?s=128&g=1", "display_name": "X39", "link": "https://stackoverflow.com/users/2684203/x39"}, "edited": false, "score": 2, "creation_date": 1559728719, "post_id": 56458111, "comment_id": 99508244, "body": "There are two ways you can challenge this monster without any library. You do not want to hear both probably as one is &quot;manual parsing&quot; (as some help: translate the above to some <code>Regex</code> and just pass whatever <code>Console.ReadLine()</code> passes to you) and the second one involves <code>DllImport</code> and a little bit of unsafe code"}, {"owner": {"reputation": 793, "user_id": 2684203, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/71zMc.png?s=128&g=1", "display_name": "X39", "link": "https://stackoverflow.com/users/2684203/x39"}, "edited": false, "score": 0, "creation_date": 1559728747, "post_id": 56458111, "comment_id": 99508260, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/472202/looking-for-c-sharp-equivalent-of-scanf\">Looking for C# equivalent of scanf</a>"}, {"owner": {"reputation": 2242, "user_id": 1394710, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/0da2f1f5c2e83c6a2fd2291f28651175?s=128&d=identicon&r=PG", "display_name": "HelloWorld", "link": "https://stackoverflow.com/users/1394710/helloworld"}, "reply_to_user": {"reputation": 793, "user_id": 2684203, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/71zMc.png?s=128&g=1", "display_name": "X39", "link": "https://stackoverflow.com/users/2684203/x39"}, "edited": false, "score": 0, "creation_date": 1559731593, "post_id": 56458111, "comment_id": 99509506, "body": "@X39 that&#39;s what I was thinking as well. pinvoking is not an option though."}], "owner": {"reputation": 2242, "user_id": 1394710, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/0da2f1f5c2e83c6a2fd2291f28651175?s=128&d=identicon&r=PG", "display_name": "HelloWorld", "link": "https://stackoverflow.com/users/1394710/helloworld"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1565974151, "creation_date": 1559728172, "question_id": 56458111, "link": "https://stackoverflow.com/questions/56458111/how-to-convert-sscanf-function-call-to-c", "title": "How to convert sscanf function call to C#?", "body": "<p>I have this fun sscanf function call I need to convert to C#:</p>\n\n<pre><code>u_sscanf(tag.c_str(), \"%*[&lt;]%[^&lt;&gt;=:!]%[&lt;&gt;=:!]%[-.MAXIN0-9]%*[&gt;]\", tkey, top, txval)\n</code></pre>\n\n<p>How would I best go about this? Are there any libraries that can help me?</p>\n"}, {"tags": ["c", "recursion", "sudoku"], "comments": [{"owner": {"reputation": 26552, "user_id": 448932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QgLLl.png?s=128&g=1", "display_name": "500 - Internal Server Error", "link": "https://stackoverflow.com/users/448932/500-internal-server-error"}, "edited": false, "score": 5, "creation_date": 1559728930, "post_id": 56457867, "comment_id": 99508336, "body": "A couple of hints: 1) Only recurse when you actually found a valid value to insert 2) remove the value again when you come back out of the recursive call so that the cell is free for the next try."}, {"owner": {"reputation": 1, "user_id": 11603262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/871538f11b19d0f69d13806b9c936786?s=128&d=identicon&r=PG&f=1", "display_name": "The Great Hacksby", "link": "https://stackoverflow.com/users/11603262/the-great-hacksby"}, "edited": false, "score": 0, "creation_date": 1559757478, "post_id": 56457867, "comment_id": 99522807, "body": "I don&#39;t really understand what you mean, I really have no idea what to do"}, {"owner": {"reputation": 4593, "user_id": 105104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02b23920ac852e946b333d3f9d0d95c1?s=128&d=identicon&r=PG", "display_name": "dvhh", "link": "https://stackoverflow.com/users/105104/dvhh"}, "reply_to_user": {"reputation": 1480, "user_id": 8746648, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/726e6151726f9d185620a833825b61f3?s=128&d=identicon&r=PG", "display_name": "asynts", "link": "https://stackoverflow.com/users/8746648/asynts"}, "edited": false, "score": 1, "creation_date": 1559792555, "post_id": 56457867, "comment_id": 99532252, "body": "@asynts I believe the files were mostly untouched, and that the exercise is to fill the body of the <code>solve</code> function"}], "answers": [{"tags": [], "owner": {"reputation": 4593, "user_id": 105104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02b23920ac852e946b333d3f9d0d95c1?s=128&d=identicon&r=PG", "display_name": "dvhh", "link": "https://stackoverflow.com/users/105104/dvhh"}, "is_accepted": false, "score": 1, "last_activity_date": 1559786689, "last_edit_date": 1592644375, "creation_date": 1559786689, "answer_id": 56470100, "question_id": 56457867, "link": "https://stackoverflow.com/questions/56457867/recursive-backtracking-algorithm-in-c-to-solve-a-sudoku/56470100#56470100", "title": "Recursive Backtracking Algorithm in C to solve a Sudoku", "body": "<p>You might want to look at <a href=\"https://en.wikipedia.org/wiki/Backtracking\" rel=\"nofollow noreferrer\">what is a backtracking algorithm</a></p>\n<h2>Recusively Moving through the grid</h2>\n<p>Your solve would be solving one position (tracked by row and col ) at a time and recursively check solve the next position.</p>\n<p>So your solve function should at least walk through the grid</p>\n<pre><code>int solve(int row, int col) {\n    // solve next column in the current row\n    return solve(row, col + 1);\n}\n</code></pre>\n<p>As you can see the issue become that the col would be growing indefinitely without checking other rows. (by the way the first element of an array in C have an index of 0 )</p>\n<p>So we need to move to the other row once we reach the end of this one ( Assuming that <code>END_COLUMN_INDEX</code> contains the index of the last column)</p>\n<pre><code>   if(col == END_COLUMN_INDEX) { // we just reached the end of the current row\n        return solve(row+1, 0); // solve the beginning of the next row\n   }\n</code></pre>\n<p>Now your solving will automatically move to the next row, but what about when we reach the last row\n( Assuming that <code>END_ROW_INDEX</code> contains the index of the row column)</p>\n<pre><code>   if((col == END_COLUMN_INDEX) &amp;&amp; (row == END_ROW_INDEX)) { // we reached the end of the grid meaning that we might have successfully solved the whole grid\n       return 1; // return true\n   }\n</code></pre>\n<p>Now walking throught what should be implemented as this point.</p>\n<pre><code>solve(0,0) -&gt; solve(0,1)\nsolve(0,1) -&gt; solve(0,2)\nsolve(0,2) -&gt; solve(0,3)\n...\nsolve(0,END_COLUMN_INDEX - 1) -&gt; solve(0, END_COLUMN_INDEX)\nsolve(0, END_COLUMN_INDEX) -&gt; solve(1, 0)\n...\n...\nsolve(END_ROW_INDEX , END_COLUMN_INDEX - 1) -&gt; solve(END_ROW_INDEX , END_COLUMN_INDEX) -&gt; return true\n(the true value is returned through each upper level of recursion)\n</code></pre>\n<p>We are now recursively moving through the grid</p>\n<h2>Solving the Sudoku</h2>\n<p>for each cell you need to check</p>\n<ol>\n<li><p>if the cell is already filled (you can then <code>solve</code> the next cell)</p>\n</li>\n<li><p>check a value (1 through 9, using <code>checkValueInField</code> ):</p>\n</li>\n<li><p>if the found value is ok, you can store the value in the grid (<code>setValueInField</code>) and try to <code>solve</code> the next cell</p>\n</li>\n<li><p>else try the next value</p>\n</li>\n<li><p>what if we have tried all the value and nothing fits ?</p>\n</li>\n<li><p>that means that the upper level of recursion is wrong, so the solve function will return <code>false</code> to communicate that the value in the previous cell is wrong ( the upper layer would be at step 1 or 3 )</p>\n</li>\n<li><p>test what <code>solve</code>-ing the next cell returned ( at step 1 or 3 )</p>\n</li>\n<li><p>true, means that we solved the next cell and all the following cells</p>\n</li>\n<li><p>false means that we have a value that made the next cell un-<code>solve</code>able, we might want to try other values (backtracking ).</p>\n</li>\n</ol>\n<p>when returning <code>false</code> to the upper value of recursion you must not forget to restore the value of the current cell to its original value (<code>removeValueFromField</code>).</p>\n<h2>Putting it all together</h2>\n<p>At this point you should have all the guides to resolve your issue and write your recursive sudoku solving function.</p>\n<p>Additionally internet is filled with great example of sudoku solving code.</p>\n"}], "owner": {"reputation": 1, "user_id": 11603262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/871538f11b19d0f69d13806b9c936786?s=128&d=identicon&r=PG&f=1", "display_name": "The Great Hacksby", "link": "https://stackoverflow.com/users/11603262/the-great-hacksby"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 581, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1559786689, "creation_date": 1559727227, "last_edit_date": 1559782988, "question_id": 56457867, "link": "https://stackoverflow.com/questions/56457867/recursive-backtracking-algorithm-in-c-to-solve-a-sudoku", "title": "Recursive Backtracking Algorithm in C to solve a Sudoku", "body": "<p>I have to implement the solve method recursive in the sudoku.c for university.<br>\nI tried hard but all my implementations did not work.<br>\nI am an absolute newbie in programming c and so I despair on working with this Sudoku backtracking algorithm.</p>\n\n<p>Can somebody help me?</p>\n\n<p>The solve method was empty, so everything what's inside this method are just tries from me.</p>\n\n<p><strong>sudoku.h</strong></p>\n\n<pre><code>#ifndef _SUDOKU_H_\n#define _SUDOKU_H_\n\n#define SIZE 9\n#define SQRT_SIZE 3\n\nvoid init(int begin[SIZE][SIZE]);\nvoid print();\nint checkValueInField(int value, int row, int col);\nint setValueInField(int value, int row, int col);\nint removeValueFromField(int row, int col);\nint getValueFromField(int row, int col);\nint solve(int row, int col);\n\n#endif /* _SUDOKU_H_ */\n</code></pre>\n\n<p><strong>sudoku.c</strong></p>\n\n<pre><code>#include \"sudoku.h\"\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;memory.h&gt;\n\n#define SIZE 9\n#define SQRT_SIZE 3\n\nint field[SIZE][SIZE];\nint initial[SIZE][SIZE];\n\n\n/* Initializes the sudoku array.\n * The field initial keeps the original start value for\n * figuring out if a value is fixed or can be changed. */\nvoid init(int begin[SIZE][SIZE]) {\n    memcpy(field, begin, SIZE * SIZE * sizeof(int));\n    memcpy(initial, begin, SIZE * SIZE * sizeof(int));\n}\n\n/* really pretty prints the sudoku array */\nvoid print() {\n    int row, col;\n    // print the first line\n    printf(\"||\");\n    for (col = 0; col &lt; SIZE - 1; col++) {\n        if (col % SQRT_SIZE == SQRT_SIZE - 1)\n            printf(\"===++\");\n        else\n            printf(\"===+\");\n    }\n    printf(\"===||\\n\");\n    // loop through all rows of the array\n    for (row = 0; row &lt; SIZE; row++) {\n        // print the line with field values\n        for (col = 0; col &lt; SIZE; col++) {\n            if (col % SQRT_SIZE == 0)\n                printf(\"|| \");\n            else\n                printf(\"| \");\n            if (field[row][col] == 0)\n                printf(\"  \");\n            else\n                printf(\"%d \", field[row][col]);\n        }\n        // print the separation line;\n        // depending on the result of the modulo operation\n        // print a single or double line\n        printf(\"||\\n||\");\n        if (row % SQRT_SIZE == SQRT_SIZE - 1) {\n            for (col = 0; col &lt; SIZE - 1; col++) {\n                if (col % SQRT_SIZE == SQRT_SIZE - 1)\n                    printf(\"===++\");\n                else\n                    printf(\"===+\");\n            }\n            printf(\"===||\\n\");\n        }\n        else {\n            for (col = 0; col &lt; SIZE - 1; col++) {\n                if (col % SQRT_SIZE == SQRT_SIZE - 1)\n                    printf(\"---++\");\n                else\n                    printf(\"---+\");\n            }\n            printf(\"---||\\n\");\n        }\n    }\n}\n\n/* Checks if the value is valid and can be set into the field.\n * The function returns false if the value is already present or\n * has been one of the initial values. */\nint checkValueInField(int value, int row, int col) {\n    int i, r, c;\n    int squareRow;\n    int squareCol;\n    // checks for initial values\n    if (initial[row][col] != 0) {\n        if (initial[row][col] == value)\n            return 1;\n        else\n            return 0;\n    }\n\n    // check horizontally\n    for (i = 0; i &lt; SIZE; i++) {\n        if (field[row][i] == value) return 0;\n    }\n\n    // check vertically\n    for (i = 0; i &lt; SIZE; i++) {\n        if (field[i][col] == value) return 0;\n    }\n\n    // check square\n    squareRow = row / SQRT_SIZE;\n    squareCol = col / SQRT_SIZE;\n    for (r = squareRow * SQRT_SIZE; r &lt; squareRow * SQRT_SIZE + SQRT_SIZE; r++) {\n        for (c = squareCol * SQRT_SIZE; c &lt; squareCol * SQRT_SIZE + SQRT_SIZE; c++) {\n            if (field[r][c] == value) return 0;\n        }\n    }\n\n    return 1;\n}\n\n/* Set a value in the sudoku field if the field is empty.\n * The method returns false if the field contains a fixed number. */\nint setValueInField(int value, int row, int col) {\n    if (initial[row][col] == 0) {\n        field[row][col] = value;\n        return 1;\n    }\n    else if (initial[row][col] == value)\n        return 1;\n    return 0;\n}\n\n/* Removes a value in the sudoku field if it doesn't contain an initial value.\n * The method returns false if the field contains a fixed number and cannot be\n * removed. */\nint removeValueFromField(int row, int col) {\n    if (initial[row][col] == 0) {\n        field[row][col] = 0;\n        return 1;\n    }\n    return 0;\n}\n\n/* Returns the value in the field */\nint getValueFromField(int row, int col) {\n    return field[row][col];\n}\n\n/* Return true if you've found a valid solution for the sudoku. Use the\n * return value to abort the backtracking algorithm if you've found the\n * first solution, otherwise you would search for a possible solution. */\nint solve(int row, int col) {\n    /* Implement a backtracking for solving the sudoku */\n    for (int i = 1; i &lt;= 9; i++) {\n        if ((checkValueInField(i, row, col)) == 1) {\n            setValueInField(i, row, col);\n        }\n        solve(row, col + 1);\n        solve(row + 1, col);\n    }\n    return 0;\n}\n</code></pre>\n\n<p><strong>main.c</strong></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include \"sudoku.h\"\n\nint main(int argc, char * const argv[]) {\n    int initial[SIZE][SIZE] = {\n        {0, 1, 0, 0, 0, 9, 0, 5, 0},\n        {0, 9, 0, 0, 0, 0, 4, 8, 0},\n        {0, 6, 0, 1, 0, 4, 0, 0, 0},\n        {0, 0, 5, 0, 0, 0, 9, 3, 0},\n        {0, 0, 0, 7, 0, 2, 0, 0, 0},\n        {0, 2, 1, 0, 0, 0, 8, 0, 0},\n        {4, 0, 0, 0, 8, 0, 6, 0, 9},\n        {0, 0, 0, 0, 6, 0, 5, 0, 3},\n        {2, 0, 0, 0, 3, 0, 0, 0, 0},\n    };\n\n    init(initial);\n    print();\n    solve(0, 0);\n    print();\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "visual-c++", "pragma", "linker-warning"], "comments": [{"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 1, "creation_date": 1559726962, "post_id": 56457732, "comment_id": 99507395, "body": "Why would you want to disable a warning? Warnings are usually a sign that something isn&#39;t right"}, {"owner": {"reputation": 4513, "user_id": 1810087, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/T2x51.jpg?s=128&g=1", "display_name": "user1810087", "link": "https://stackoverflow.com/users/1810087/user1810087"}, "edited": false, "score": 1, "creation_date": 1559727241, "post_id": 56457732, "comment_id": 99507536, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/661606/visual-c-how-to-disable-specific-linker-warnings\">Visual C++: How to disable specific linker warnings?</a>"}, {"owner": {"reputation": 8884, "user_id": 8372104, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/72UbV.png?s=128&g=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/8372104/simon"}, "edited": false, "score": 0, "creation_date": 1559727260, "post_id": 56457732, "comment_id": 99507546, "body": "You can&#39;t, the compiler treats a linker warning as too important to ignore"}], "answers": [{"tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 0, "last_activity_date": 1559727602, "last_edit_date": 1559727602, "creation_date": 1559727276, "answer_id": 56457878, "question_id": 56457732, "link": "https://stackoverflow.com/questions/56457732/how-do-we-disable-a-linker-warning-with-a-pragma-warning/56457878#56457878", "title": "How do we disable a linker warning with a #pragma warning?", "body": "<p>You can't disable this warning with the current crop of MSVC toolsets.</p>\n\n<p>Yes, warnings can be very useful indeed, but you are free to ignore this one in particular in many circumstances. Just make sure your situation is one of those circumstances, and move on. Are you sure, for example, that inclusion of the compilation unit that causes this warning is necessary?</p>\n"}, {"tags": [], "owner": {"reputation": 16783, "user_id": 264325, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/q8UVK.jpg?s=128&g=1", "display_name": "Ajay", "link": "https://stackoverflow.com/users/264325/ajay"}, "is_accepted": true, "score": 2, "last_activity_date": 1559731243, "creation_date": 1559731243, "answer_id": 56458872, "question_id": 56457732, "link": "https://stackoverflow.com/questions/56457732/how-do-we-disable-a-linker-warning-with-a-pragma-warning/56458872#56458872", "title": "How do we disable a linker warning with a #pragma warning?", "body": "<p>Linker warning cannot be put in a source file, as source files (.CPP/.C/.H etc.) are for the consumption of the compiler and not for the linker. The compilation would produce object files out of one or more files (via one or more \"translation units\"). If you put <code>#prama disable_linker_warning</code> in some source file - to which .OBJ file (part of linking)  the linker setting should go? </p>\n\n<p>Linker settings are <strong>global</strong> to the project - since .OBJ files are linked to produce final PE image, and linker warnings would be applied then. You can choose the linker warnings in the project settings page.</p>\n\n<p>The preprocessor directives won't be saved and later propagated to the linker. It may lead to multiple path ambiguities (due to multiple translation units) and other complexities. Such linker feature may not be reliable. </p>\n\n<p>Note that in VC++ when you select property of a <strong>single source file</strong>, you don't see any \"Linker\" setting.</p>\n\n<p><a href=\"https://i.stack.imgur.com/wtmdA.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wtmdA.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 180, "user_id": 1145755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5GhI4.jpg?s=128&g=1", "display_name": "Sourabh", "link": "https://stackoverflow.com/users/1145755/sourabh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 477, "favorite_count": 0, "accepted_answer_id": 56458872, "answer_count": 2, "score": 4, "last_activity_date": 1559731243, "creation_date": 1559726788, "last_edit_date": 1559727390, "question_id": 56457732, "link": "https://stackoverflow.com/questions/56457732/how-do-we-disable-a-linker-warning-with-a-pragma-warning", "title": "How do we disable a linker warning with a #pragma warning?", "body": "<p>We can disable a compiler warning with</p>\n\n<p><code>#pragma warning(disable:4966)</code></p>\n\n<p>How can we disable a linker warning with a #pragma directive? Something like:</p>\n\n<pre><code>// Disable linker warning LNK4221\n#pragma warning(disable:4221)\n</code></pre>\n"}, {"tags": ["c", "visual-studio-code", "cygwin", "vscode-settings", "vscode-tasks"], "answers": [{"tags": [], "owner": {"reputation": 313, "user_id": 5474152, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/8wclz.jpg?s=128&g=1", "display_name": "stephw", "link": "https://stackoverflow.com/users/5474152/stephw"}, "is_accepted": true, "score": 3, "last_activity_date": 1559725603, "last_edit_date": 1559725603, "creation_date": 1559724859, "answer_id": 56457210, "question_id": 56457209, "link": "https://stackoverflow.com/questions/56457209/setting-up-vs-code-for-c-using-cygwin64-compiler-and-debugger-on-windows/56457210#56457210", "title": "Setting up VS Code for C using Cygwin64 Compiler and Debugger on Windows", "body": "<p>Instructions here are for setting up on VS Code</p>\n\n<ol>\n<li>Install the extension C/C++ on VS Code</li>\n</ol>\n\n<pre><code>Name: C/C++\nId: ms-vscode.cpptools\nDescription: C/C++ IntelliSense, debugging, and code browsing.\nVersion: 0.23.1\nPublisher: Microsoft\nVS Marketplace Link: https://marketplace.visualstudio.com/items?itemName=ms-vscode.cpptools\n</code></pre>\n\n<ol start=\"2\">\n<li><p>If you have a workspace already, skip this step.</p>\n\n<p>Create a folder and add this folder into VS Code. Then save workspace.</p></li>\n<li><p>Set up <code>launch.json</code></p>\n\n<p>Go to \"Debug > Open Configurations\", this should open the launch.json file. Below is my configuration. If you're testing this and unsure of what you're doing, I suggest you save your original content somewhere before replacing things.</p>\n\n<p><em>Note: <code>\"preLaunchTask\": \"gcc.exe build active file\"</code> runs the task labelled \"gcc.exe build active file\".</em></p></li>\n</ol>\n\n<pre><code>{\n    \"version\": \"0.2.0\",\n    \"configurations\": [\n        {\n            \"name\": \"gcc.exe build and debug active file\",\n            \"type\": \"cppdbg\",\n            \"request\": \"launch\",\n            \"program\": \"${fileDirname}\\\\${fileBasenameNoExtension}.exe\",\n            \"args\": [],\n            \"stopAtEntry\": false,\n            \"cwd\": \"${workspaceFolder}\",\n            \"environment\": [\n                {\n                    \"name\": \"PATH\",\n                    \"value\": \"%PATH%;z:\\\\cygwin64\\\\bin\"\n                }\n            ],\n            \"externalConsole\": false,\n            \"MIMode\": \"gdb\",\n            \"miDebuggerPath\": \"C:\\\\cygwin64\\\\bin\\\\gdb.exe\",\n            \"setupCommands\": [\n                {\n                    \"description\": \"Enable pretty-printing for gdb\",\n                    \"text\": \"-enable-pretty-printing\",\n                    \"ignoreFailures\": true\n                }\n            ],\n            \"logging\": { \"engineLogging\": true }, //optional\n            \"preLaunchTask\": \"gcc.exe build active file\"\n        }\n    ]\n}\n</code></pre>\n\n<ol start=\"4\">\n<li><p>Set up <code>task.json</code></p>\n\n<p>Go to \"Terminal > Configure Tasks...\" and select \"gcc.exe build active file\"</p>\n\n<p>The various \"-W\" flags in \"args\" are meant to make the compiler more strict. You can remove them if you'd like.</p></li>\n</ol>\n\n<pre><code>{\n    \"tasks\": [\n        {\n            \"type\": \"shell\",\n            \"label\": \"gcc.exe build active file\",\n            \"command\": \"C:\\\\cygwin64\\\\bin\\\\gcc.exe\",\n            \"args\": [\n                \"-g\",\n                \"-o\",\n                \"${fileDirname}\\\\${fileBasenameNoExtension}.exe\",\n                \"-Werror\", // Optional\n                \"-Wall\", // Optional\n                \"-Wextra\", // Optional\n                \"-ansi\", // Optional\n                \"-pedantic\", // Optional\n                \"${file}\"\n            ],\n            \"options\": {\n                \"cwd\": \"C:\\\\cygwin64\\\\bin\"\n            },\n            \"problemMatcher\": [\n                \"$gcc\"\n            ],\n            \"group\": {\n                \"kind\": \"build\",\n                \"isDefault\": true\n            }\n        },\n    ],\n    \"version\": \"2.0.0\"\n}\n</code></pre>\n\n<ol start=\"5\">\n<li><p>Build and Debug Active File</p>\n\n<p>Go to the C file you want to build, press Ctrl+Shift+P for \"Command Palette > C/C++ Build and Debug Active File > gcc.exe build active file\" or if you only want to build then go to \"Terminal > Run Build Task\".</p></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 3558, "user_id": 862391, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/982465269bdfd8f6e1790677fa3aed41?s=128&d=identicon&r=PG", "display_name": "A Fog", "link": "https://stackoverflow.com/users/862391/a-fog"}, "is_accepted": false, "score": 0, "last_activity_date": 1569656896, "creation_date": 1569656896, "answer_id": 58144385, "question_id": 56457209, "link": "https://stackoverflow.com/questions/56457209/setting-up-vs-code-for-c-using-cygwin64-compiler-and-debugger-on-windows/58144385#58144385", "title": "Setting up VS Code for C using Cygwin64 Compiler and Debugger on Windows", "body": "<p>Cygwin64 is inefficient because it is using a medium memory model. This makes it use 64 bit absolute addresses instead of 32 bit relative addresses for static data.</p>\n\n<p>I will recommend to use the Clang plugin for Visual Studio instead, unless you have a specific reason to use Cygwin64. See <a href=\"https://devblogs.microsoft.com/cppblog/clang-llvm-support-in-visual-studio/\" rel=\"nofollow noreferrer\">https://devblogs.microsoft.com/cppblog/clang-llvm-support-in-visual-studio/</a></p>\n\n<p>You also get rid of the cygwin DLL when using the Clang plugin.</p>\n"}], "owner": {"reputation": 313, "user_id": 5474152, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/8wclz.jpg?s=128&g=1", "display_name": "stephw", "link": "https://stackoverflow.com/users/5474152/stephw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8181, "favorite_count": 0, "accepted_answer_id": 56457210, "answer_count": 2, "score": 1, "last_activity_date": 1590774945, "creation_date": 1559724859, "last_edit_date": 1559725938, "question_id": 56457209, "link": "https://stackoverflow.com/questions/56457209/setting-up-vs-code-for-c-using-cygwin64-compiler-and-debugger-on-windows", "title": "Setting up VS Code for C using Cygwin64 Compiler and Debugger on Windows", "body": "<p>Would like to set up VS Code to work with Cygwin/Cygwin64.\nAlready have these set up:</p>\n\n<ol>\n<li>Installed Cygwin64 on windows</li>\n<li>Installed gcc (Compiler) and gdb (Debugger) packages from Cygwin installer</li>\n<li>GCC and GDB are <strong>NOT</strong> in windows path.</li>\n<li>Installed Visual Studio Code</li>\n</ol>\n\n<p>Posting this because it took me a couple of days from multiple different sources to set this up.\nThis is specifically for Windows with Cygwin/Cygwin64 installed.</p>\n\n<p>DISCLAIMER: I've only tested this for building single files.</p>\n"}, {"tags": ["c", "cs50", "vigenere"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1559725005, "post_id": 56457034, "comment_id": 99506434, "body": "<code>islower(c)</code> \u2014 do you mean <code>tolower(c)</code>?"}, {"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 0, "creation_date": 1559725316, "post_id": 56457034, "comment_id": 99506602, "body": "voting to close as off-topic, since the problem is a simple typo."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1559725470, "post_id": 56457034, "comment_id": 99506678, "body": "Fixing function <code>shift()</code> now prints the desired output for the example given."}], "owner": {"reputation": 13, "user_id": 11544116, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-7b_t_cZVzSQ/AAAAAAAAAAI/AAAAAAAAHiM/ViJyjeI7OZQ/photo.jpg?sz=128", "display_name": "Gokul", "link": "https://stackoverflow.com/users/11544116/gokul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1559724182, "creation_date": 1559724182, "question_id": 56457034, "link": "https://stackoverflow.com/questions/56457034/the-output-isnt-what-i-am-expecting-the-code-isnt-printing-any-error-and-i-do", "title": "The output isn&#39;t what i am expecting, the code isn&#39;t printing any error and i dont know whats going wrong", "body": "<p>Vigenere cipher \nTakes in a text and output a cipher version of that text\nthe user inputs a keyword in the command line and a text for which the user wishes to encrypt. If you're familiar with the Ceasar cipher it's pretty much the same thing except a small minor change, instead of inputting the actual shift value we instead input a keyword and the letters in the keyword would represent the shift value instead.</p>\n\n<pre><code>#include &lt;cs50.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;ctype.h&gt;\n\nint shift(char c);\n\nint main(int argc, string argv[])\n{    \n    //checks for alphabetic characters\n    if (argc == 2)\n    {\n        for (int i = 0, n = strlen(argv[1]); i &lt; n; i++)\n        {\n            if (isalpha(argv[1][i]) == false)\n            {\n                printf(\"Usage: ./vigenere keyword. \\n\");\n                return 1;\n            }\n        }\n\n        //promting the user for text\n        string text = get_string(\"plaintext:  \");\n        printf(\"ciphertext: \");\n\n        //Intializing variables\n        string key = argv[1];\n        int l = strlen(key);\n\n        for (int j = 0, k = 0, m = strlen(text); j &lt; m; j++)    \n        {\n            if (islower(text[j]))\n            {\n                //lower cap letter enter here \n                printf(\"%c\", 'a' + ( text[j] - 'a' + shift(key[k % l]) ) % 26);\n                k++;\n            }               \n            else if (isupper(text[j]))\n            {\n                //Upper caps letter enter here\n                printf(\"%c\", 'A' + ( text[j] - 'A' + shift(key[k % l]) ) % 26);\n                k++;\n            } \n            else\n            {\n                //The rest whatever left enter here \n                printf(\"%c\", text[j]);\n            }\n        }\n        printf(\"\\n\");\n        return 0;\n    }\n    else\n    {\n        printf(\"Usage: ./vigenere keyword. \\n\");\n        return 1;\n    }\n}\n\n//This function calculates the shift value per character \nint shift(char c)\n{\n    return ( islower(c) - 'a' );\n}\n</code></pre>\n\n<p>the problem is that the output isn't what I expect it to be. For instance, if the keyword is 'b' and the text is 'hello' the output must be 'ifmmp' but it's not. I don't know what goes wrong.</p>\n"}, {"tags": ["c", "arrays", "char", "printf"], "comments": [{"owner": {"reputation": 43, "user_id": 10559509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7678cad131cb1ed5a80078e33ec75b0?s=128&d=identicon&r=PG&f=1", "display_name": "Elgernon", "link": "https://stackoverflow.com/users/10559509/elgernon"}, "reply_to_user": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1559723998, "post_id": 56456915, "comment_id": 99505909, "body": "It is the function of printing to the file."}, {"owner": {"reputation": 43, "user_id": 10559509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7678cad131cb1ed5a80078e33ec75b0?s=128&d=identicon&r=PG&f=1", "display_name": "Elgernon", "link": "https://stackoverflow.com/users/10559509/elgernon"}, "reply_to_user": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1559724318, "post_id": 56456915, "comment_id": 99506094, "body": "@ikegami Solving the problem of size is not needed here. But what about NULL? Where should I use it?"}, {"owner": {"reputation": 196, "user_id": 11139937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fb20157f20488d087487a13a9544987?s=128&d=identicon&r=PG&f=1", "display_name": "Vaibhav", "link": "https://stackoverflow.com/users/11139937/vaibhav"}, "edited": false, "score": 0, "creation_date": 1559724331, "post_id": 56456915, "comment_id": 99506099, "body": "you must share your full code here for better visibility."}, {"owner": {"reputation": 43, "user_id": 10559509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7678cad131cb1ed5a80078e33ec75b0?s=128&d=identicon&r=PG&f=1", "display_name": "Elgernon", "link": "https://stackoverflow.com/users/10559509/elgernon"}, "reply_to_user": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1559724603, "post_id": 56456915, "comment_id": 99506235, "body": "@ikegami so how can I add it to my chars in the code?"}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1559724662, "post_id": 56456915, "comment_id": 99506266, "body": "@Elgernon Read the link <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1559724680, "post_id": 56456915, "comment_id": 99506273, "body": "If we cannot reproduce your problem, it&#39;s very hard to help you."}], "answers": [{"comments": [{"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "reply_to_user": {"reputation": 43, "user_id": 10559509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7678cad131cb1ed5a80078e33ec75b0?s=128&d=identicon&r=PG&f=1", "display_name": "Elgernon", "link": "https://stackoverflow.com/users/10559509/elgernon"}, "edited": false, "score": 0, "creation_date": 1559724753, "post_id": 56457135, "comment_id": 99506308, "body": "You&#39;re not using <code>cout</code> anywhere in the code though."}, {"owner": {"reputation": 43, "user_id": 10559509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7678cad131cb1ed5a80078e33ec75b0?s=128&d=identicon&r=PG&f=1", "display_name": "Elgernon", "link": "https://stackoverflow.com/users/10559509/elgernon"}, "edited": false, "score": 0, "creation_date": 1559724826, "post_id": 56457135, "comment_id": 99506350, "body": "It is just because it is not needed for the example. Answer the question."}, {"owner": {"reputation": 43, "user_id": 10559509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7678cad131cb1ed5a80078e33ec75b0?s=128&d=identicon&r=PG&f=1", "display_name": "Elgernon", "link": "https://stackoverflow.com/users/10559509/elgernon"}, "reply_to_user": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1559725019, "post_id": 56457135, "comment_id": 99506441, "body": "@ikegami I tell you that when I just <code>cout &lt;&lt; result1[0]</code> it brings me <code>10</code>."}, {"owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 1, "creation_date": 1559725047, "post_id": 56457135, "comment_id": 99506451, "body": "That&#39;s not a valid program. If <code>result1</code> were as you described, that would output just <code>0</code>."}, {"owner": {"reputation": 43, "user_id": 10559509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7678cad131cb1ed5a80078e33ec75b0?s=128&d=identicon&r=PG&f=1", "display_name": "Elgernon", "link": "https://stackoverflow.com/users/10559509/elgernon"}, "reply_to_user": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1559725148, "post_id": 56457135, "comment_id": 99506507, "body": "@ikegami Oh yes, you are better C++ machine than mine."}, {"owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 1, "creation_date": 1559725236, "post_id": 56457135, "comment_id": 99506564, "body": "<code>cout</code> doesn&#39;t output more than one byte when you pass it a <code>char</code>. Either that&#39;s not your code, <code>result1</code> isn&#39;t as you describe, or that&#39;s not what the statement outputs. We can&#39;t tell you which because you failed to provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> again."}, {"owner": {"reputation": 43, "user_id": 10559509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7678cad131cb1ed5a80078e33ec75b0?s=128&d=identicon&r=PG&f=1", "display_name": "Elgernon", "link": "https://stackoverflow.com/users/10559509/elgernon"}, "reply_to_user": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1559725466, "post_id": 56457135, "comment_id": 99506675, "body": "@ikegami check changes."}, {"owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1559725547, "post_id": 56457135, "comment_id": 99506710, "body": "You&#39;re doing <code>cout &lt;&lt; result1[1];</code> (which outputs <code>1</code>) and <code>cout &lt;&lt; result1[0];</code> (which outputs <code>0</code>). You&#39;d get the same output with <code>printf(&#39;%c&#39;, result1[i]);</code>"}, {"owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1559725691, "post_id": 56457135, "comment_id": 99506783, "body": "I agree, if you print the number from right to left, it does indeed come out right."}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1559725718, "post_id": 56457135, "comment_id": 99506797, "body": "Putting the <code>for</code> loop inside the <code>while</code> loop would mean you&#39;d output &quot;010&quot; though"}, {"owner": {"reputation": 43, "user_id": 10559509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7678cad131cb1ed5a80078e33ec75b0?s=128&d=identicon&r=PG&f=1", "display_name": "Elgernon", "link": "https://stackoverflow.com/users/10559509/elgernon"}, "edited": false, "score": 0, "creation_date": 1559725781, "post_id": 56457135, "comment_id": 99506829, "body": "@ChrisTurner So?"}, {"owner": {"reputation": 43, "user_id": 10559509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7678cad131cb1ed5a80078e33ec75b0?s=128&d=identicon&r=PG&f=1", "display_name": "Elgernon", "link": "https://stackoverflow.com/users/10559509/elgernon"}, "reply_to_user": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1559725805, "post_id": 56457135, "comment_id": 99506843, "body": "@ikegami so how should I print it to the file?"}, {"owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1559725820, "post_id": 56457135, "comment_id": 99506852, "body": "You&#39;re already doing that right. What needs fixing is the conversion code, as Chris Turner described."}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1559725825, "post_id": 56457135, "comment_id": 99506860, "body": "You want the loop outside the <code>while</code> loop so that it outputs the finished results..."}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1559725927, "post_id": 56457135, "comment_id": 99506910, "body": "And it&#39;d also output garbage as <code>digiCount</code> is always pointing to the character after the last digit you&#39;ve added"}], "tags": [], "owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "is_accepted": true, "score": 6, "last_activity_date": 1559724571, "creation_date": 1559724571, "answer_id": 56457135, "question_id": 56456915, "link": "https://stackoverflow.com/questions/56456915/when-using-fprintf-i-get-mirrored-array-of-chars-in-the-output/56457135#56457135", "title": "When using fprintf I get mirrored array of chars in the output", "body": "<p>Conversion code definitely doesn't work. Taking your example of converting 12 from base 10 to base 12, the loop does the following:</p>\n\n<p>First time around <code>num</code> is 12. <code>12 % 12</code> is 0 - so that is what is stored as the first character of your string. <code>num</code> is then divided by 12 to become 1.</p>\n\n<p>Second time around <code>1 % 12</code> is 1 and that is added as the second character. This means your string now contains \"01\". Which is what you're seeing in your output - your code is adding the digits in reverse order.</p>\n\n<p>You could either work out how big your number is and then count down from that to add the characters in the other direction or reverse the string using.</p>\n\n<p>And also after the loop you need to add the NUL terminator character like this:</p>\n\n<pre><code>result1 [digCount1] = '\\0';\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 10559509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7678cad131cb1ed5a80078e33ec75b0?s=128&d=identicon&r=PG&f=1", "display_name": "Elgernon", "link": "https://stackoverflow.com/users/10559509/elgernon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 56457135, "answer_count": 1, "score": -2, "last_activity_date": 1559725383, "creation_date": 1559723792, "last_edit_date": 1559725383, "question_id": 56456915, "link": "https://stackoverflow.com/questions/56456915/when-using-fprintf-i-get-mirrored-array-of-chars-in-the-output", "title": "When using fprintf I get mirrored array of chars in the output", "body": "<p>I'm converting numbers from 10 counting system (c.s.) to another and the printing it to the file.</p>\n\n<pre><code>void Fileoutkey(char *res1, char *res2, int sys1, int sys2) //KANON\n{\n    FILE *fp;\n    if(fp = fopen(\"task_out.cpp\", \"w\"))\n    {\n\n        fprintf(fp, \"%d: %s\\n\", sys1, res1);\n        fprintf(fp, \"%d: %s\\n\", sys2, res2);\n        fclose(fp);\n    }\n    else\n    {\n        printf(\"No such file in directory.\\n\");\n        exit(1);\n    }\n}\n</code></pre>\n\n<p>The function of converting (and it is OK)</p>\n\n<pre><code>int numSystem1 = 12;\nchar digits1 [13] = \"0123456789AB\";\nchar result1 [18] = \"\";\nint digCount1 = 0;\nwhile (num)\n{\n    int rem1 = num % numSystem1;\n    result1 [digCount1] = digits1[rem1];\n    num /= numSystem1;\n    digCount1++;    \n    for (int i = digCount1; i &gt;= 0; i--)\n    {\n        cout &lt;&lt; result1[i]; //here i get 10\n    }   \n}\n</code></pre>\n\n<p>When converting from 10 to 12 c.s. for, example, number <code>12</code> , instead of <code>10</code> I get <code>01</code>.\nOutput in the console is right.</p>\n"}, {"tags": ["c++", "c", "visual-studio"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 3, "creation_date": 1559722174, "post_id": 56456459, "comment_id": 99505032, "body": "Unrelated to your problem with the compiler, but the code you show will most likely crash anyway, as you dereference an uninitialized pointer in <code>scan</code> function."}, {"owner": {"reputation": 38, "user_id": 11577772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45179379e17a3de89d318cfc14b09889?s=128&d=identicon&r=PG&f=1", "display_name": "Anonymoose", "link": "https://stackoverflow.com/users/11577772/anonymoose"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1559722411, "post_id": 56456459, "comment_id": 99505141, "body": "Thank you @Some programmer dude.  That&#39;s true.  In the longer version of the program I did initialize the pointers and added some data to the <code>source</code> array.  I just shortened it up for the purpose of asking the question."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1559723333, "post_id": 56456459, "comment_id": 99505577, "body": "There&#39;s no such thing as C/C++. C and C++ are different languages that share some features."}, {"owner": {"reputation": 38, "user_id": 11577772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45179379e17a3de89d318cfc14b09889?s=128&d=identicon&r=PG&f=1", "display_name": "Anonymoose", "link": "https://stackoverflow.com/users/11577772/anonymoose"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1559723633, "post_id": 56456459, "comment_id": 99505733, "body": "@n.m.  Thank you.  I just included both tags because I got different results.  Under some conditions I got the program to compile and run when compiling as C code.  But nothing compiled no matter what when compiling as C++."}, {"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 1, "creation_date": 1559810554, "post_id": 56456459, "comment_id": 99538271, "body": "This is a bug in VS2019, the early releases suffer from the typical &quot;write code fast and let the customer test it&quot; agile bugs.  For now you need to ignore that specific message.  Just focus on the other errors that it reports.  Once you fix those the MSB6006 error should disappear as well."}, {"owner": {"reputation": 38, "user_id": 11577772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45179379e17a3de89d318cfc14b09889?s=128&d=identicon&r=PG&f=1", "display_name": "Anonymoose", "link": "https://stackoverflow.com/users/11577772/anonymoose"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1559888943, "post_id": 56456459, "comment_id": 99567081, "body": "@Some programmer dude.  Thank you again.  If I had understood the significance of what you &quot;said&quot; I would have saved myself some time."}, {"owner": {"reputation": 38, "user_id": 11577772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45179379e17a3de89d318cfc14b09889?s=128&d=identicon&r=PG&f=1", "display_name": "Anonymoose", "link": "https://stackoverflow.com/users/11577772/anonymoose"}, "reply_to_user": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1559889024, "post_id": 56456459, "comment_id": 99567113, "body": "@Hans Passant.  Thank you.  I agree.  Overall I think VS is a good product.  This is the first time I&#39;ve experienced a bug.  I&#39;ll have to be more careful with my coding."}], "answers": [{"comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1559852553, "post_id": 56473696, "comment_id": 99559406, "body": "The code has undefined behaviour in both C and C++. One of the infinitely many manifestations of undefined behaviour is the code doing what the programmer expects it to do."}, {"owner": {"reputation": 38, "user_id": 11577772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45179379e17a3de89d318cfc14b09889?s=128&d=identicon&r=PG&f=1", "display_name": "Anonymoose", "link": "https://stackoverflow.com/users/11577772/anonymoose"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1559889076, "post_id": 56473696, "comment_id": 99567135, "body": "Thank you again.  Undefined behavior.  Arrrgh."}], "tags": [], "owner": {"reputation": 38, "user_id": 11577772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45179379e17a3de89d318cfc14b09889?s=128&d=identicon&r=PG&f=1", "display_name": "Anonymoose", "link": "https://stackoverflow.com/users/11577772/anonymoose"}, "is_accepted": true, "score": 0, "last_activity_date": 1561378467, "last_edit_date": 1561378467, "creation_date": 1559809897, "answer_id": 56473696, "question_id": 56456459, "link": "https://stackoverflow.com/questions/56456459/getting-error-message-msb6006-error-code-2-with-c-c/56473696#56473696", "title": "Getting error message MSB6006 error code 2 with C/C++", "body": "<p>I've done some additional research.</p>\n\n<p>Running the code in VS Community Edition 15.9.12 showed that the line <code>w.lexeme[0] = '\\0';</code> was trying to use an uninitialized pointer.</p>\n\n<p>The corrected function is:</p>\n\n<pre><code>word scan(char** source)\n{\n    word w;\n\n    w.lexeme = (char*)malloc(1);    //  &lt;-- line added\n    w.lexeme[0] = '\\0';\n    return w;\n}\n</code></pre>\n\n<p>This compiles and runs okay.</p>\n\n<p>However that still doesn't explain why this code gives the MSB6006 error:</p>\n\n<pre><code>word scan(char** source)\n{\n}\n</code></pre>\n\n<p>And this only happens when compiling as C++.  It compiles and runs okay if compiling as C.</p>\n\n<p><strong>Update:</strong>  I reported the problem to MSFT but it doesn't look liked they fixed the problem yet.</p>\n"}], "owner": {"reputation": 38, "user_id": 11577772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45179379e17a3de89d318cfc14b09889?s=128&d=identicon&r=PG&f=1", "display_name": "Anonymoose", "link": "https://stackoverflow.com/users/11577772/anonymoose"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 805, "favorite_count": 0, "accepted_answer_id": 56473696, "answer_count": 1, "score": 0, "last_activity_date": 1561378467, "creation_date": 1559722003, "last_edit_date": 1559811208, "question_id": 56456459, "link": "https://stackoverflow.com/questions/56456459/getting-error-message-msb6006-error-code-2-with-c-c", "title": "Getting error message MSB6006 error code 2 with C/C++", "body": "<p>I'm getting the following message trying to compile some simple code:  <code>MSB6006 \"CL.exe\" exited with code 2</code>.</p>\n\n<p>I'm trying to learn C++.  I know some C.  I understand the two are completely different languages.  I include both tags because I get different results depending on how I try to compile the code.</p>\n\n<p>For my own education, I'm trying to write a lexer.  Mainly the problem seems to be with this function:</p>\n\n<pre><code>word scan(char** source)\n{\n    word w;\n    w.lexeme[0] = '\\0';\n    return w;\n}\n</code></pre>\n\n<p>I get the same problem as this one <a href=\"https://stackoverflow.com/questions/13975605/msb6006-cl-exe-exited-with-code-2\">MSB6006: &quot;CL.exe&quot; exited with code 2</a> but the answer doesn't apply in my case.  I saw this question <a href=\"https://stackoverflow.com/questions/13948990/error-msb6006-cl-exe-exited-with-code-2\">error MSB6006: &quot;CL.exe&quot; exited with code 2</a> which pointed to <a href=\"https://social.msdn.microsoft.com/Forums/vstudio/en-US/742dc49b-5fe1-4808-97b4-a8103617406c/error-msb6006-quotclexequot-exit-code-2.\" rel=\"nofollow noreferrer\">this question</a> on the MSDN site   They seem to indicate that small problems can cause this error code.</p>\n\n<p>I have two files.  One is a \"driver\" and the other is the lexer code.  But I get the exact same results if I include everything in one file.</p>\n\n<p>Here is the code for the driver:</p>\n\n<pre><code>#include \"pch.h\"\n#include \"Cl2aDLL.h\"\n\nvoid Cl2a(char argv1[], char argv2[])\n{\n    char** source = NULL;\n    scan(source);\n}\n</code></pre>\n\n<p>Here is the code for the header.  I got the technique somewhere from a MSFT website:</p>\n\n<pre><code>#pragma once\n#ifndef CL2ADLL__H__\n#define CL2ADLL__H__\n\ntypedef struct {\n    char* lexeme;\n}word;\n\n#ifdef __cplusplus\nextern \"C\" {\n#endif\n\n#ifdef CL2ADLL_EXPORTS\n#define CL2ADLL_API __declspec(dllexport)\n#else\n#define CL2ADLL_API __declspec(dllimport)\n#endif\n\n    CL2ADLL_API  void Cl2a(char argv1[], char argv2[]);\n\n    word scan(char** source);\n\n#ifdef __cplusplus\n}\n#endif\n\n#endif // ! CL2ADLL__H__\n</code></pre>\n\n<p>Here is the code for the lexer:</p>\n\n<pre><code>//  Error   MSB6006 \"CL.exe\" exited with code 2.\n\n#include \"pch.h\"\n#include \"Cl2aDLL.h\"\n\n/*\n//  when I comment out the following lines, it compiles and runs okay\nword scan(char** source)\n{\n    word w;\n    w.lexeme[0] = '\\0';\n    return w;\n}\n*/\n\n//  if I only have the following, I get compile error if .cpp\nword scan(char** source)\n{\n}\n</code></pre>\n\n<p>The strange thing is that if I compile <strong>as C code</strong> it compiles and runs okay.  But if I try to compile <strong>as C++</strong> I get the error message.  If I uncomment out the first version of the scanner, I get the error message compiling <strong>as C or C++</strong> either one.</p>\n\n<p>Does anyone know of a change that can remove this error message?</p>\n\n<p>Sorry for the long question, but I'm trying to give as clear a definition of the problem as I can.  Because I can't figure out what could be wrong.  TIA.</p>\n\n<p>Update:  I'm using VS 2019 Community Edition 16.1.1</p>\n\n<p><strong>Update 2:</strong>  I got the same results with version 16.1.2.  But trying the code in VS2017 Community Edition 15.9.12 showed the problem, as shown below.</p>\n\n<p>Also I should have explained that all the above code was in a .dll file.  The .dll code was run from a simple console application as follows:</p>\n\n<pre><code>#include \"..\\CL2aDLL\\CL2aDLL.h\"\n\nint main(int argc, char* argv[])\n{\n    char        parm1[1 + 1] = \"\";\n    char        parm2[1 + 1] = \"\";\n\n    if (argc == 1) {\n        Cl2aDLL(parm1, parm2);\n    }\n    else {\n        Cl2aDLL(argv[1], argv[2]);\n    }\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 168, "user_id": 11345020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48d3d43d49cd02d98fc22e7036e9c977?s=128&d=identicon&r=PG&f=1", "display_name": "ooj-001", "link": "https://stackoverflow.com/users/11345020/ooj-001"}, "edited": false, "score": 2, "creation_date": 1559722113, "post_id": 56456437, "comment_id": 99504994, "body": "Allocate memory to your pointer to <code>int</code> before: <code>int *ptr = malloc(sizeof(*int));</code>"}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1559722393, "post_id": 56456437, "comment_id": 99505128, "body": "<code>ptr</code> needs to point to an actual <code>int</code> before you dereference it."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1559722603, "post_id": 56456437, "comment_id": 99505240, "body": "I don&#39;t think that duplicate is correct, but the question is also a bit unclear."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1559727447, "post_id": 56456437, "comment_id": 99507637, "body": "I added a link to the canonical dupe for these questions."}], "answers": [{"tags": [], "owner": {"reputation": 5012, "user_id": 2416647, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f471b80868ae9c93d0903127ed27e2f9?s=128&d=identicon&r=PG", "display_name": "schorsch312", "link": "https://stackoverflow.com/users/2416647/schorsch312"}, "is_accepted": true, "score": 1, "last_activity_date": 1559722229, "creation_date": 1559722229, "answer_id": 56456519, "question_id": 56456437, "link": "https://stackoverflow.com/questions/56456437/why-is-a-segmentation-fault-core-dumped-error-produced/56456519#56456519", "title": "Why is a segmentation fault (core dumped) error produced?", "body": "<p>You don't have memory to write to.  You need to allocate memory in order to be able to write to it. Otherwise you will (might) get an segmentation fault.</p>\n\n<p>If you would have turned on compile time warnings clang would have warned you </p>\n\n<pre><code>prog.cc:6:5: warning: variable 'ptr' is uninitialized when used here [-Wuninitialized]\n   *ptr = 400;\n    ^~~\nprog.cc:4:12: note: initialize the variable 'ptr' to silence this warning\n   int *ptr ;\n</code></pre>\n\n<p>Here is the corrected code</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\nint main(void) {\n   int *ptr = (int*)malloc(sizeof(int));\n   *ptr = 400;\n   printf(\"%d\\n\", *ptr);\n   return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 11435368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7599dc45232f4752bad375e6e582997e?s=128&d=identicon&r=PG&f=1", "display_name": "effunna9", "link": "https://stackoverflow.com/users/11435368/effunna9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "closed_date": 1559722238, "accepted_answer_id": 56456519, "answer_count": 1, "score": -1, "last_activity_date": 1559727408, "creation_date": 1559721909, "question_id": 56456437, "link": "https://stackoverflow.com/questions/56456437/why-is-a-segmentation-fault-core-dumped-error-produced", "closed_reason": "Duplicate", "title": "Why is a segmentation fault (core dumped) error produced?", "body": "<p>I'm new to pointers, and I'm running some test code. I am aware that a segmentation fault means that I'm trying to access some piece of memory that I shouldn't be; however, I don't understand what's wrong with my line of thinking here.</p>\n\n<pre><code>int main(void) {\n   int *ptr;\n   *ptr = 400;\n   printf(\"%d\\n\", *ptr);\n   return 0;\n}\n</code></pre>\n\n<p>The function compiles just fine. From my understanding, when ptr is declared, it has an arbitrary memory address. Then the second line puts 400 as a reference to that memory address. Finally, the printf() line should return 400, but it's giving me a core dump.</p>\n\n<p>Can someone please clarify? I've looked at several pointer examples, and I thought I was getting the hang of it, until I tried this.</p>\n"}, {"tags": ["c", "gcc", "gdb"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 5, "creation_date": 1559721555, "post_id": 56456324, "comment_id": 99504762, "body": "None of this makes any sense. I don&#39;t even understand what you are trying to do... are you somehow assuming that C instructions are equivalent to assembler instructions?"}, {"owner": {"reputation": 428, "user_id": 2516697, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/3nNCJ.jpg?s=128&g=1", "display_name": "s.paszko", "link": "https://stackoverflow.com/users/2516697/s-paszko"}, "edited": false, "score": 0, "creation_date": 1559721585, "post_id": 56456324, "comment_id": 99504775, "body": "What is your purpose?  Compiler will handle it always properly, because it&#39;s it role to always generate code to correctly return from function."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1559721643, "post_id": 56456324, "comment_id": 99504796, "body": "It is btw impossible to manually set the PC in C, so you can&#39;t skip instructions by calculating a relative address. You have to use assembler for that."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1559721651, "post_id": 56456324, "comment_id": 99504800, "body": "This is rather perverse insofar the language doesn&#39;t really support it. You could try <code>setjmp</code>, <code>longjmp</code>, inline assembly &amp;c. &amp;c. but that&#39;s &quot;dodgy&quot; C."}, {"owner": {"reputation": 6746, "user_id": 1143634, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/e7lca.png?s=128&g=1", "display_name": "StaceyGirl", "link": "https://stackoverflow.com/users/1143634/staceygirl"}, "edited": false, "score": 0, "creation_date": 1559721805, "post_id": 56456324, "comment_id": 99504866, "body": "Moreover the value of <code>x</code> can be stored in a register. You will have to make it <code>volatile</code>."}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 0, "creation_date": 1559721827, "post_id": 56456324, "comment_id": 99504879, "body": "You can use an <code>if</code> statement, you can use a <code>goto</code> statement (if you must), or you can code the function in assembly.  Trying to modify instruction addresses is going to be hit or miss and will be extremely unlikely to work (not to mention unstable)."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 5, "creation_date": 1559722180, "post_id": 56456324, "comment_id": 99505036, "body": "For everyone&#39;s info: when a C function is called, the return address is pushed onto the stack (except for half a dozen reasons why it might not be). The OP&#39;s code attempts to modify that return address on the stack, so that the return address points to <code>printf(&quot;By&quot;);</code> instead of <code>x = &#39;b&#39;;</code>. There&#39;s at least a dozen reasons why this won&#39;t work, but it can be done if one understands all of the reasons why it might not."}, {"owner": {"reputation": 95, "user_id": 8799093, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e8cc03adfd21a99e42dba8f610ea8c9d?s=128&d=identicon&r=PG&f=1", "display_name": "sali333", "link": "https://stackoverflow.com/users/8799093/sali333"}, "edited": false, "score": 0, "creation_date": 1559722448, "post_id": 56456324, "comment_id": 99505154, "body": "Yes, this is what I am tying to do. To modify the return address so that it points in the <code>printf(&quot;By&quot;);</code> instead of <code>x = &#39;b&#39;;</code>"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1559722886, "post_id": 56456324, "comment_id": 99505366, "body": "The only way you&#39;re going to get this to work is to step through the assembly code with the debugger. That&#39;s the whole point of the exercise. I can&#39;t help you with that because what you see in the debugger depends on your hardware, the compiler that you&#39;re using, and the command line options that you used to compile."}, {"owner": {"reputation": 4831, "user_id": 689394, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07d1795a5234cffedd9ed3ad59f4cad3?s=128&d=identicon&r=PG", "display_name": "matt", "link": "https://stackoverflow.com/users/689394/matt"}, "edited": false, "score": 0, "creation_date": 1559726196, "post_id": 56456324, "comment_id": 99507026, "body": "since you specify gcc, have you looked at using the gcc extension for computed goto, is the outer function not in on it?"}], "answers": [{"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1559724889, "post_id": 56456694, "comment_id": 99506374, "body": "Yeah, we shouldn&#39;t use very dirty words like goto, setjmp and longjmp. I for one find them offensive!"}, {"owner": {"reputation": 61, "user_id": 6506370, "user_type": "registered", "profile_image": "https://graph.facebook.com/1150471885017033/picture?type=large", "display_name": "Maxim Irrigad", "link": "https://stackoverflow.com/users/6506370/maxim-irrigad"}, "edited": false, "score": 0, "creation_date": 1559725013, "post_id": 56456694, "comment_id": 99506437, "body": "Here you have it good sir, what about the rest? According to me that thread can really help him to do what he wants"}], "tags": [], "owner": {"reputation": 61, "user_id": 6506370, "user_type": "registered", "profile_image": "https://graph.facebook.com/1150471885017033/picture?type=large", "display_name": "Maxim Irrigad", "link": "https://stackoverflow.com/users/6506370/maxim-irrigad"}, "is_accepted": false, "score": 0, "last_activity_date": 1559724853, "last_edit_date": 1559724853, "creation_date": 1559722889, "answer_id": 56456694, "question_id": 56456324, "link": "https://stackoverflow.com/questions/56456324/modifying-the-return-address-of-a-function-for-jumping-a-line-code/56456694#56456694", "title": "Modifying the return address of a function for jumping a line code", "body": "<p>This post can help you resolve your question with some caveats: The problem is that both working to edit a jmp_buf or writing inline assembly is <strong>not portable</strong>. I suggest to you to use one of the many control flow constructs (like if or a goto), with that being said take a look at this as a starting point. <a href=\"https://stackoverflow.com/a/44279163/6506370\">Implementing setjmp and longjmp in C without built in functions or assembly (getting incorrect return values)</a></p>\n"}, {"tags": [], "owner": {"reputation": 65310, "user_id": 201725, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/616f7a1cbb20fe949d883393657c039a?s=128&d=identicon&r=PG", "display_name": "Jan Hudec", "link": "https://stackoverflow.com/users/201725/jan-hudec"}, "is_accepted": false, "score": 2, "last_activity_date": 1559723450, "creation_date": 1559723450, "answer_id": 56456827, "question_id": 56456324, "link": "https://stackoverflow.com/questions/56456324/modifying-the-return-address-of-a-function-for-jumping-a-line-code/56456827#56456827", "title": "Modifying the return address of a function for jumping a line code", "body": "<blockquote>\n  <p>ret=buffer1+12+4+1;</p>\n</blockquote>\n\n<p>This is <a href=\"https://en.cppreference.com/w/cpp/language/ub\" rel=\"nofollow noreferrer\">Undefined Behaviour\u2122</a>, because your pointer arithmetic has left the allocation. The compiler is now free to do whatever it pleases, up to and including making daemons fly out of your nose.</p>\n\n<blockquote>\n  <p>(*ret)+=4;</p>\n</blockquote>\n\n<p>And gcc has gotten <em>really good</em> at spotting out Undefined Behaviour, and pretty mean when to comes to choosing what it pleases.</p>\n\n<p>If optimizations are enabled, it might simply ignore the statement altogether, if not, you probably have the offset wrong anyway, because there is absolutely no guarantee regarding layout of the variables. There will be some padding for alignment and even the order might be different. And I am not sure where you got the <code>+1</code> from, but there is no reasonable layout where it would make sense.</p>\n\n<p>You also seem to assume 32-bit target, but most Linuxes are full 64-bit these days.</p>\n"}, {"tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 1, "last_activity_date": 1559724721, "last_edit_date": 1559724721, "creation_date": 1559724003, "answer_id": 56456988, "question_id": 56456324, "link": "https://stackoverflow.com/questions/56456324/modifying-the-return-address-of-a-function-for-jumping-a-line-code/56456988#56456988", "title": "Modifying the return address of a function for jumping a line code", "body": "<p>At this moment in time, when using my very personal computer and there is a new moon at night, the code below works perfectly<sup>(note)</sup>. It skips the 2nd <code>puts</code> instruction and jumps directly to the 3rd <code>puts</code>.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;setjmp.h&gt;\n#include &lt;stdint.h&gt;\n\n#define can_you_see_what_I_mean() setjmp(jb)\n#define might_as_well(task) ((uint32_t*)&amp;jb)[20] = 0x401544; task(jb, 0)\n\nstatic jmp_buf jb;\n\nint main (void)\n{\n  puts(\"I get up\");\n  if(!can_you_see_what_I_mean())\n  {\n    might_as_well(longjmp);\n  }\n  puts(\"Go ahead and jump\");\n  puts(\"Hey you, who said that?\");\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>I get up\nHey you, who said that?\n</code></pre>\n\n<hr>\n\n<p><sup>(note)</sup>\nI wouldn't recommend anyone to use this code for any purpose, since it relies on extremely bad practice and contains countless forms of undefined behavior. It is extremely non-portable.</p>\n"}, {"tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": false, "score": 0, "last_activity_date": 1559788392, "creation_date": 1559788392, "answer_id": 56470240, "question_id": 56456324, "link": "https://stackoverflow.com/questions/56456324/modifying-the-return-address-of-a-function-for-jumping-a-line-code/56470240#56470240", "title": "Modifying the return address of a function for jumping a line code", "body": "<p>the following proposed code:</p>\n\n<ol>\n<li>cleanly compiles</li>\n<li>depends on the statement in <code>function()</code> to skip the statement: <code>x = 'b';</code></li>\n</ol>\n\n<p>and now, the proposed code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint function ( void ) \n{\n    return 1;\n}\n\nint main( void ) \n{\n  char x = 'a';\n  printf (\"Hello\\n\");\n  printf (\"I am going to skip a statement\\n\");  \n  if( !function() )\n  {\n      x = 'b';\n  }\n  printf (\"By\");\n  printf(\"The following value must be the a letter: %c\\n\",x);\n}\n</code></pre>\n"}], "owner": {"reputation": 95, "user_id": 8799093, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e8cc03adfd21a99e42dba8f610ea8c9d?s=128&d=identicon&r=PG&f=1", "display_name": "sali333", "link": "https://stackoverflow.com/users/8799093/sali333"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1559788392, "creation_date": 1559721361, "question_id": 56456324, "link": "https://stackoverflow.com/questions/56456324/modifying-the-return-address-of-a-function-for-jumping-a-line-code", "title": "Modifying the return address of a function for jumping a line code", "body": "<p>I wanna modify the following function so that I can be able to skip the line : x='b' in the main function.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid function (int a, int b, int c) {\n  int i, j;\n  char buf[5];\n  char buffer1[12];  \n  int *ret; \n}\n\nint main() {\n  char x;\n  x = 'a';\n  printf (\"Hello\\n\");\n  printf (\"I am going to skip a statement\\n\");  \n  function(1,2,3);\n  x = 'b';\n  printf (\"By\");\n  printf(\"The following value must be the a letter: %c\\n\",x);\n}\n\n</code></pre>\n\n<p>I tried to get the return address and use the `ret' variable for adding  the necessary bytes, but it seems that it's not correct.</p>\n\n<pre><code>ret=buffer1+12+4+1;\n(*ret)+=4;\n\n\n</code></pre>\n\n<p>Anyway the x='b' is still executed.</p>\n"}, {"tags": ["c", "string", "file", "input"], "comments": [{"owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "edited": false, "score": 0, "creation_date": 1559721210, "post_id": 56456216, "comment_id": 99504611, "body": "And the question is?"}, {"owner": {"reputation": 13, "user_id": 11580097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d24de5123bd54f490abd27c38a51efee?s=128&d=identicon&r=PG&f=1", "display_name": "Tytanuser", "link": "https://stackoverflow.com/users/11580097/tytanuser"}, "reply_to_user": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "edited": false, "score": 0, "creation_date": 1559721635, "post_id": 56456216, "comment_id": 99504794, "body": "@SergeBallesta Well, I am getting a lot of errors and don&#39;t know whether my direction is a good one, so the question is how to do this properly?"}, {"owner": {"reputation": 2417, "user_id": 2503164, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/68d57915f8c4a877fe42a67251d1420a?s=128&d=identicon&r=PG", "display_name": "Mike", "link": "https://stackoverflow.com/users/2503164/mike"}, "edited": false, "score": 2, "creation_date": 1559721939, "post_id": 56456216, "comment_id": 99504923, "body": "Consider &quot;Democratic Republic of Congo Wonders of nature&quot;. Without any hard-coded context, vis-a-vis country/category nanes, how would we know where the country ends and the category begins? This is a bad data layout - tab or punctuation separation would be better."}, {"owner": {"reputation": 13, "user_id": 11580097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d24de5123bd54f490abd27c38a51efee?s=128&d=identicon&r=PG&f=1", "display_name": "Tytanuser", "link": "https://stackoverflow.com/users/11580097/tytanuser"}, "reply_to_user": {"reputation": 2417, "user_id": 2503164, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/68d57915f8c4a877fe42a67251d1420a?s=128&d=identicon&r=PG", "display_name": "Mike", "link": "https://stackoverflow.com/users/2503164/mike"}, "edited": false, "score": 0, "creation_date": 1559722495, "post_id": 56456216, "comment_id": 99505179, "body": "@Mike I absolutely agree, but it&#39;s not my idea, it&#39;s the task I was given to do. Probably with the input seperated by punctuation I wouldn&#39;t have problems"}, {"owner": {"reputation": 2417, "user_id": 2503164, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/68d57915f8c4a877fe42a67251d1420a?s=128&d=identicon&r=PG", "display_name": "Mike", "link": "https://stackoverflow.com/users/2503164/mike"}, "edited": false, "score": 0, "creation_date": 1559724396, "post_id": 56456216, "comment_id": 99506130, "body": "You are also going to have to buffer the content since the one constant is the number which has to be the last number in case it&#39;s in the title (eg Basket Weaving 101, Slaughter House 5 etc). Think about how you would read each line into a buffer and use strchr and strspn to parse that buffer."}, {"owner": {"reputation": 4703, "user_id": 5375464, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3292ca87ff6c766b75dbe4b2ea0831da?s=128&d=identicon&r=PG&f=1", "display_name": "J...S", "link": "https://stackoverflow.com/users/5375464/j-s"}, "edited": false, "score": 0, "creation_date": 1559725057, "post_id": 56456216, "comment_id": 99506458, "body": "@Tytanuser Will <code>country</code> have only single word values? If it can have multiple words, how are you distinguishing the <code>name</code> field from the <code>country</code> field?"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1559788847, "post_id": 56456216, "comment_id": 99531657, "body": "regarding: <code>if (file == NULL) {     printf(&quot;Opening error&quot;);     exit(-1); }</code>  This should be located immediately after the call to <code>fopen()</code> and this error message should be output to <code>stderr</code>, not <code>stdout</code>  Since this is a C library function, should also output to <code>stderr</code> the text reason the system thinks the error occurred.  Suggest: <code>perror( &quot;fopen failed&quot; );</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1559789027, "post_id": 56456216, "comment_id": 99531677, "body": "Your question indicates the parts are separated via a comma.  Therefore you could use: <code>fgets()</code> to read the whole line,  then <code>strtok( line, &quot;,&quot; )</code> to extract each successive desired part"}], "answers": [{"tags": [], "owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "is_accepted": false, "score": 1, "last_activity_date": 1559724943, "creation_date": 1559724943, "answer_id": 56457239, "question_id": 56456216, "link": "https://stackoverflow.com/questions/56456216/reading-multiple-diffrent-words-numbers-from-lines-of-file/56457239#56457239", "title": "Reading multiple diffrent words/numbers from lines of file", "body": "<p>Well, this is not a very good question for SO, because it is lacking context on what you are really trying to do. Anyway, I have had a look at your code but there would be too many things to fix for a SO answer. So I will just give you some advices.</p>\n\n<ul>\n<li><p>The best tool for a beginner is a pencil and a paper sheet. Write down the algo you want your program to follow, and control (yes from the paper) that is should work by following it with the initial data. If you had do that, you would have immediatly found that it contains an infinite loop starting at <code>while (flagc == 0) {</code>, because <code>c</code> is never changed in that loop. Only start coding when you really know what you want</p></li>\n<li><p>You are trying to parse a file one character at a time. It is not really hard, but require a lot of attention. As a beginner, I would advise you to use as much higher level function from standard library as possible: read the file line by line with <code>fgets</code> and then use <code>strcspn</code> and <code>strspn</code> to find the position of the number in the line. What comes before is the title, what comes after is the name.</p></li>\n<li><p>Be careful with indentation (many IDE or editors can automatically indent your code). If the file was correctly indented, you would have immediately seen that the <code>fclose</code> call was inside the main loop. So your current code closes the file after the first character.</p></li>\n<li><p>use shorter functions. If a function becomes too large, try to split it. Here the parsing function should parse a single line and <em>return</em> the title, number and name. That way the high level algo becomes:</p>\n\n<pre><code>open file\nloop line by line\n    extract title, number and name from a line\n    process title, number and name\nclose file\n</code></pre>\n\n<p>and then, write down the parsing algo to extract the fields from a line</p></li>\n<li><p>when things go wrong (yes they will, even if you follow my advices...), use a debugger to single step through the code. The infinite loop would have been evident if you had...</p></li>\n<li><p>less important, but good practices recommend to avoid <em>magic numbers</em> in the code. It is nice for you to know the ascii code table, but <code>' '</code> for a space is easier to read than 32. At least you immediately know that it is a char and not a true number...</p></li>\n</ul>\n\n<p>It may not be the expected answer, and I could certainly code that for you, but you would not have learned anything from it.</p>\n"}], "owner": {"reputation": 13, "user_id": 11580097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d24de5123bd54f490abd27c38a51efee?s=128&d=identicon&r=PG&f=1", "display_name": "Tytanuser", "link": "https://stackoverflow.com/users/11580097/tytanuser"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1559724943, "creation_date": 1559720906, "last_edit_date": 1559721685, "question_id": 56456216, "link": "https://stackoverflow.com/questions/56456216/reading-multiple-diffrent-words-numbers-from-lines-of-file", "title": "Reading multiple diffrent words/numbers from lines of file", "body": "<p>I am trying to read a line of text from file(example below). Every line of text has: title of the book(starts with capital letter, can be multiple words), number of the book, country origin of the book(starts with capital letter) and catalog of the book(starts with capital letter, can be multiple words). Every line ends with a \"\\n\" and the next line starts. I want to read the line and seperate title, number, country and name. How to do it properly?</p>\n\n<p>I tried to read char by char, and when char I am currently reading is either a number or a Capital letter and previous char was a \"space\", flag should go up to signalize I should move from for example title to number, number to country etc. When i read a \"\\n\" all flags should go down and the process should start again</p>\n\n<pre><code>void openfile(char* filedestination)\n{\nFILE *file = fopen(filedestination, \"r+\");\nint help[100];\nint c;\nint name[100];\nchar title[50];\nint country[50];\nint number[6];\nint i = 0, flagt = 0 , flagn = 0 , flagc = 0, flagname = 0;\nif (file == NULL)\n{\n    printf(\"Opening error\");\n    exit(-1);\n}\nwhile((c = fgetc(file))!=EOF)\n{\n\n    help[i] = c;\n    if (flagt == 0) {\n        for (int j = 0; j &lt; i; j++) {\n            name[j] = help[j];\n            if (c &gt; 47 &amp;&amp; c &lt; 91 &amp;&amp; help[i - 1] == 32) {\n                flagt = 1;\n                j = 100;\n            }\n        }\n    }\n    if (flagc == 0)\n    {\n        int j = 0;\n        while (flagc == 0) {\n            number[j] = help[i];\n            if (c &gt; 47 &amp;&amp; c &lt; 91 &amp;&amp; help[i - 1] == 32) {\n                flagc = 1;\n            }\n            j++;\n            i++;\n        }\n\n    }\n    i++;\n    printf(\"\\n\");\n    for (int j = 0; j &lt; i; j++) {\n\n        printf(\"%c\", name[j]);\n\n    }\n    for (int j = 0; j &lt; i; j++) {\n\n        printf(\"%c\", country[j]);\n    }\n    fclose(file);\n}\n}\n</code></pre>\n\n<p>Example line: </p>\n\n<p>Mountains 10002 France Wonders of nature</p>\n\n<p>Photonic crystals 10003 Germany Science</p>\n\n<p>So I should get title = Mountains, number = 10002, country = France, name = Wonders of nature. Then I will use it in another function, so I can overwrite name after I read it from the first line, because I won't need it.</p>\n"}, {"tags": ["c", "algorithm", "time-complexity", "counting-sort"], "comments": [{"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1559719749, "post_id": 56455830, "comment_id": 99504063, "body": "Does that code even work? Have you tried it with an array like <code>{5,5,5,0,0,0}</code>?"}, {"owner": {"reputation": 83, "user_id": 10999949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a28ae09789f4e8233a62fbf0f142dd8?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Ceitlin", "link": "https://stackoverflow.com/users/10999949/mark-ceitlin"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1559719978, "post_id": 56455830, "comment_id": 99504151, "body": "Yes, it works with an array like that, @user3386109"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1559720527, "post_id": 56455830, "comment_id": 99504350, "body": "Possible duplicate: <a href=\"https://stackoverflow.com/questions/42094465/correctly-allocating-multi-dimensional-arrays\">Correctly allocating multi-dimensional arrays</a>. The obvious performance loss in this program is the lack of 2D arrays - instead you are working with segments scattered all over the heap. Also, calloc might potentially be ever so slightly faster than malloc + memset."}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1559720751, "post_id": 56455830, "comment_id": 99504439, "body": "&quot;<i>becomes quadratic, and not linear.</i>&quot; no because you never reset <i>j</i> nor decrements it, so the complexity is 2*array_size (values have the same size as sorted if I well understand) ... supposing your algo is correct (like @user3386109 I a not sure of that, but you do not give all the code)"}, {"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "edited": false, "score": 1, "creation_date": 1559720999, "post_id": 56455830, "comment_id": 99504525, "body": "First of all you have UB by accessing out of bound, suppose you have an array <code>{0,5,4}</code> maximum element being <code>5</code> then you allocate <code>values</code> with size <code>5</code> and you access <code>values[5]</code> in the loop (<code>values[array[i]]++;</code>)."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1559721238, "post_id": 56455830, "comment_id": 99504623, "body": "The full code has no resemblance to the original code. You should delete the original, and fix the snippet you&#39;re asking about to match the full code."}, {"owner": {"reputation": 312, "user_id": 10309494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0ec600183f131b43b6d2116b9fbbe9f?s=128&d=identicon&r=PG&f=1", "display_name": "KBlr", "link": "https://stackoverflow.com/users/10309494/kblr"}, "reply_to_user": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "edited": false, "score": 0, "creation_date": 1559722352, "post_id": 56455830, "comment_id": 99505110, "body": "Also consider the bug which @KiranBiradar has pointed out."}], "answers": [{"tags": [], "owner": {"reputation": 1023, "user_id": 8153697, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7e8e50bcc1b0ed8d948e961eeaff5c2?s=128&d=identicon&r=PG&f=1", "display_name": "Shuki Avraham", "link": "https://stackoverflow.com/users/8153697/shuki-avraham"}, "is_accepted": true, "score": 2, "last_activity_date": 1559721132, "creation_date": 1559721132, "answer_id": 56456266, "question_id": 56455830, "link": "https://stackoverflow.com/questions/56455830/improve-the-time-complexity-of-my-implementation-of-counting-sort-c/56456266#56456266", "title": "Improve the time complexity of my implementation of Counting Sort (C)", "body": "<p>Your implementation is linear. You have an inner while loop, but the value of <code>j</code> is never reset to <code>0</code>, it keeps growing in each iteration of the for loop. Overall <code>i</code> will count from <code>0</code> to <code>size</code> and <code>j</code> will count from <code>0</code> to <code>n</code>.</p>\n"}], "owner": {"reputation": 83, "user_id": 10999949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a28ae09789f4e8233a62fbf0f142dd8?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Ceitlin", "link": "https://stackoverflow.com/users/10999949/mark-ceitlin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 56456266, "answer_count": 1, "score": 0, "last_activity_date": 1559721132, "creation_date": 1559719165, "last_edit_date": 1559721009, "question_id": 56455830, "link": "https://stackoverflow.com/questions/56455830/improve-the-time-complexity-of-my-implementation-of-counting-sort-c", "title": "Improve the time complexity of my implementation of Counting Sort (C)", "body": "<p>Consider the following code: </p>\n\n<pre><code>#define SIZE 12\n\nvoid randomize(int* array, int array_size);\nvoid print(int* array, int array_size);\nvoid counting_sort(int* array, int array_size);\nint get_max(int* array, int array_size);\nvoid construct(int* sorted, int sorted_array_size, int* values);\n\nint main(void)\n{\n    srand(time(NULL));\n    int* array = (int*)malloc(sizeof(int) * SIZE);\n    randomize(array, SIZE);\n    print(array, SIZE);\n    counting_sort(array, SIZE);\n    free(array);\n\n    return 0;\n}\n\nvoid randomize(int* array, int array_size) {...}\n\nvoid print(int* array, int array_size) {...}\n\nvoid counting_sort(int* array, int array_size) {\n    int minVal, maxVal;\n    int* sorted = (int*)malloc(sizeof(int) * SIZE);\n    maxVal = get_max(array, array_size);\n\n    int* values = (int*)malloc(maxVal * sizeof(int));\n\n    memset(values, 0, maxVal * sizeof(int));\n\n    for (int i = 0; i &lt; array_size; i++) {\n        values[array[i]]++;\n    }\n\n    construct(sorted, SIZE, values);\n\n    free(values);\n    free(sorted);\n    }\n\nint get_max(int* array, int array_size) {...}\n\nvoid construct(int* sorted, int array_size, int* values) {\n    for (int i = 0, j = 0; i &lt; array_size; i++) {\n        while (!values[++j]);\n        sorted[i] = j;\n        --values[j];\n    }\n    print(sorted, SIZE);\n} \n</code></pre>\n\n<p><code>main()</code> declares an array, the size of which is controlled by the macro <code>SIZE</code>. Then there are a few functions to randomize, print and find the max value of that array. After that is the implementation of Counting Sort itself, which uses the <code>construct(..)</code> function to create the sorted array. I've tested it a few times and couldn't find any bugs. However this bit right here is what I'm concerned about. </p>\n\n<pre><code>for (int i = 0, j = 0; i &lt; array_size; i++) {\n            while (!values[++j]);...\n</code></pre>\n\n<p>We have 2 inner loops, and the variables in these loops are incremented. This means that the time complexity of the <code>construct(...)</code> function becomes quadratic, and not linear. The issue is that I can't figure out a good way to discard all of the <code>0</code> in <code>values[]</code>. Linear solutions are most welcome. </p>\n\n<p>Added full code: </p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;cassert&gt;\n#include &lt;time.h&gt;\n#include &lt;limits.h&gt;\n#include &lt;string.h&gt;\n\n#define SIZE 160\n\nvoid randomize(int* array, int array_size);\nvoid print(int* array, int array_size);\nvoid counting_sort(int* array, int array_size);\nint get_max(int* array, int array_size);\nvoid construct(int* sorted, int sorted_array_size, int* values);\n\nint main(void)\n{\n    srand(time(NULL));\n    int* array = (int*)malloc(sizeof(int) * SIZE);\n    randomize(array, SIZE);\n    print(array, SIZE);\n    counting_sort(array, SIZE);\n    free(array);\n\n    return 0;\n}\n\nvoid randomize(int* array, int array_size) {\n    for (int i = 0; i &lt; array_size; i++) {\n        array[i] = rand() % array_size;\n    }\n}\n\nvoid print(int* array, int array_size) {\n    for (int i = 0; i &lt; array_size; i++) {\n        printf(\"%4d \", array[i]);\n    }\n    putchar('\\n');\n}\n\nvoid counting_sort(int* array, int array_size) {\n    int minVal, maxVal;\n    int* sorted = (int*)malloc(sizeof(int) * SIZE);\n    maxVal = get_max(array, array_size);\n\n    int* values = (int*)malloc(maxVal * sizeof(int));\n\n    memset(values, 0, maxVal * sizeof(int));\n\n    for (int i = 0; i &lt; array_size; i++) {\n        values[array[i]]++;\n    }\n\n    construct(sorted, SIZE, values);\n\n    free(values);\n    free(sorted);\n}\n\nint get_max(int* array, int array_size) {\n    int max = INT_MIN;\n    for (int i = 0; i &lt; array_size; i++) {\n        if (max &lt; array[i]) {\n            max = array[i];\n        }\n    }\n    return max;\n}\n\nvoid construct(int* sorted, int array_size, int* values) {\n    for (int i = 0, j = 0; i &lt; array_size; i++) {\n        while (!values[j]) {\n            ++j;\n        }\n        sorted[i] = j;\n        --values[j];\n    }\n    print(sorted, SIZE);\n} \n</code></pre>\n"}, {"tags": ["c", "image", "http", "server"], "comments": [{"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1559718039, "post_id": 56455518, "comment_id": 99503389, "body": "Welcome to SO. Did you check the header you prepared? You could simply print it before you add the body. Or you could capture the packet using Wireshark etc.. Does the string returned by your <code>findContentType</code> contain <code>&quot;\\r\\n&quot;</code>?"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1559718460, "post_id": 56455518, "comment_id": 99503557, "body": "What is the real size of the images? How much memory is available at <code>*messagebody</code>. Why do you use <code>sendbody</code> if you copy to <code>message_body</code> anyway? How does the calling function know how much data to send?"}, {"owner": {"reputation": 1, "user_id": 11602625, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6ffbcb8486a67a60958e67bdab62810?s=128&d=identicon&r=PG&f=1", "display_name": "TDLaouer", "link": "https://stackoverflow.com/users/11602625/tdlaouer"}, "reply_to_user": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1559718625, "post_id": 56455518, "comment_id": 99503627, "body": "@Gerhardh findcontenttype does Contain a &quot;\\r\\n&quot; The message body is a malloc of 10MB, i use sendbody because I don&#39;t like direclty modifying parameters, at least I&#39;ve benn taught that it&#39;s bad"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1559719019, "post_id": 56455518, "comment_id": 99503773, "body": "What is the difference compared to using <code>messagebody</code> directly? What can fail at this point is allocating the very same memory that you wouldn&#39;t need if you used <code>messagebody</code> instead."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1559719071, "post_id": 56455518, "comment_id": 99503797, "body": "But still you need to get the <code>body_size</code> out of that function."}, {"owner": {"reputation": 2422, "user_id": 9112798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e2689048404de2b747c712b6782e8c7?s=128&d=identicon&r=PG&f=1", "display_name": "David Collins", "link": "https://stackoverflow.com/users/9112798/david-collins"}, "edited": false, "score": 0, "creation_date": 1559719319, "post_id": 56455518, "comment_id": 99503888, "body": "Welcome to SO. I note that you are not freeing the memory you allocate for <code>body_size_char</code> and <code>filename</code>."}, {"owner": {"reputation": 1, "user_id": 11602625, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6ffbcb8486a67a60958e67bdab62810?s=128&d=identicon&r=PG&f=1", "display_name": "TDLaouer", "link": "https://stackoverflow.com/users/11602625/tdlaouer"}, "edited": false, "score": 0, "creation_date": 1559719334, "post_id": 56455518, "comment_id": 99503893, "body": "I did what you suggested, I used fread direclty on message_body, but still only svg loads, the png, jpg and tif don&#39;t"}, {"owner": {"reputation": 1, "user_id": 11602625, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6ffbcb8486a67a60958e67bdab62810?s=128&d=identicon&r=PG&f=1", "display_name": "TDLaouer", "link": "https://stackoverflow.com/users/11602625/tdlaouer"}, "edited": false, "score": 0, "creation_date": 1559719464, "post_id": 56455518, "comment_id": 99503947, "body": "Should I add &#39;\\0&#39; in the end of my char* variables ?"}, {"owner": {"reputation": 1, "user_id": 11602625, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6ffbcb8486a67a60958e67bdab62810?s=128&d=identicon&r=PG&f=1", "display_name": "TDLaouer", "link": "https://stackoverflow.com/users/11602625/tdlaouer"}, "edited": false, "score": 0, "creation_date": 1559719497, "post_id": 56455518, "comment_id": 99503961, "body": "I have freed the memories at the end"}, {"owner": {"reputation": 2422, "user_id": 9112798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e2689048404de2b747c712b6782e8c7?s=128&d=identicon&r=PG&f=1", "display_name": "David Collins", "link": "https://stackoverflow.com/users/9112798/david-collins"}, "edited": false, "score": 0, "creation_date": 1559719676, "post_id": 56455518, "comment_id": 99504038, "body": "@TDLaouer: when you use <code>calloc()</code> the memory is initialized to zero - so no need to explicitly add a NULL character. That is not the case when you use <code>malloc()</code> however. Having said that .. I think you are over-complicating things by using dynamic memory here. I would just declare <code>body_size_char</code> and <code>filename</code> on the stack rather than the heap."}, {"owner": {"reputation": 2422, "user_id": 9112798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e2689048404de2b747c712b6782e8c7?s=128&d=identicon&r=PG&f=1", "display_name": "David Collins", "link": "https://stackoverflow.com/users/9112798/david-collins"}, "edited": false, "score": 0, "creation_date": 1559719790, "post_id": 56455518, "comment_id": 99504080, "body": "I don&#39;t see you adding the <code>HTTP</code> status line in the case that the image file is loaded successfully. Should you not be using a <code>strcpy(rep, &quot;HTTP&#47;1.1 200 OK&quot;)</code> in that case?"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1559719983, "post_id": 56455518, "comment_id": 99504152, "body": "Please add the generated HTTP-header to the question."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1559720095, "post_id": 56455518, "comment_id": 99504196, "body": "<code>strncpy</code> does not add a terminating <code>\\0</code> if the string pointed to by <code>file</code> is longer than 100 bytes."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1559722059, "post_id": 56455518, "comment_id": 99504973, "body": "For test (index.html) the sending function could simply use <code>strlen</code> to get the length of data to be sent. It is still missing how you provide the length for images to the caller. I assume you simply do not send enough data to the client. How long was the transmitted packet for the PNG? AFAIK SVG file format is XML based, i.e. pure text."}, {"owner": {"reputation": 1, "user_id": 11602625, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6ffbcb8486a67a60958e67bdab62810?s=128&d=identicon&r=PG&f=1", "display_name": "TDLaouer", "link": "https://stackoverflow.com/users/11602625/tdlaouer"}, "edited": false, "score": 0, "creation_date": 1559722751, "post_id": 56455518, "comment_id": 99505310, "body": "The length is provided by the function ftell(f) once I&#39;m done with FSEEK, this normally seeks the end of the file, which is the size, and I put it in the body_size variable, thus obtaining the size of the image, normally. Then I rewind to go back to the beginning of the file."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1559723360, "post_id": 56455518, "comment_id": 99505586, "body": "That happens inside the function you show us. But this does not send any data. Sending must be done by the caller function. How would that function know what the nested cann to <code>ftell</code> returned to you? <code>body_size</code> is not known outside that function. As mentioned above a few times: How do you get this information out of that function?"}, {"owner": {"reputation": 1, "user_id": 11602625, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6ffbcb8486a67a60958e67bdab62810?s=128&d=identicon&r=PG&f=1", "display_name": "TDLaouer", "link": "https://stackoverflow.com/users/11602625/tdlaouer"}, "edited": false, "score": 0, "creation_date": 1559725076, "post_id": 56455518, "comment_id": 99506469, "body": "body_size is a global variable, and i do the memcpy to a variable in the parameter, which is in my case a pointer outside of the function outside of the function. And the caller clearly gets something"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1559738720, "post_id": 56455518, "comment_id": 99512915, "body": "OK, does your server handle multiple connections? A global variable might be a problem there."}], "owner": {"reputation": 1, "user_id": 11602625, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6ffbcb8486a67a60958e67bdab62810?s=128&d=identicon&r=PG&f=1", "display_name": "TDLaouer", "link": "https://stackoverflow.com/users/11602625/tdlaouer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1559721387, "creation_date": 1559717643, "last_edit_date": 1559721387, "question_id": 56455518, "link": "https://stackoverflow.com/questions/56455518/images-dont-load-on-browser-when-sending-http-response-via-a-c-http-server", "title": "Images don&#39;t load on browser when sending HTTP response via a C HTTP server", "body": "<p>I have been trying for several days to fix my problem with images not showing up on the browser, the index.html loads fine, the css and js aswell and the only image format that loads is .svg\nAll the headers are well initialwed and correct.</p>\n\n<p>I have tried most of the suggestions in the forums, such  as us memcpy instead of strcat, fread to load a file into the buffer using binary read (\"rb\" option) and such.</p>\n\n<p>Here is the code that copies the file's contents into the message body:\n(sorry for the stuff in french)</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>void server_fileToSend(char* file, int len, char* rep, char* header,\n                       char* message_body) {\n    char* body_size_char = (char*)malloc(100 * sizeof(char));\n    char* filename = (char*)calloc(100, sizeof(char));\n    char* sendbody;\n\n    if (file[0] == '/') {\n        strncpy(filename, file + 1, len - 1);\n    } else {\n        strncpy(filename, file, len);\n    }\n    // printf(\" filetruc %s\\n\",filename);\n    FILE* f = fopen(filename, \"rb+\");\n    if (f == NULL) {\n        // Modification du type de r\u00e9ponse\n        strcpy(rep, \"HTTP/1.0 404 NOT FOUND\\r\\n\");\n        f = fopen(\"sites/notfound.html\", \"r\");\n    }\n    fseek(f, 0, SEEK_END);\n    body_size = ftell(f);\n    rewind(f);\n    strcat(header, \"Content-Length: \");\n    sprintf(body_size_char, \"%ld\", body_size);\n    strcat(header, body_size_char);\n    strcat(header, \"\\r\\n\");\n\n    if (f != NULL &amp;&amp; findContentType(filename) != NULL) {\n        strcat(header, findContentType(filename));\n    }\n    strcat(header, \"Connection: keep-alive\\r\\n\");\n\n    if ((sendbody = (char*)malloc(body_size)) == NULL) {\n        memcpy(message_body, \"this is a directory\", 20);\n        body_size = 20;\n    } else {\n        result = fread(sendbody, 1, body_size, f);\n        if (result &gt; 0) {\n            memcpy(message_body, sendbody, body_size);\n        }\n    }\n    fclose(f);\n}\n</code></pre>\n\n<p>And after that I append the message_body into the response, after the headers with :</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>memcpy(rep+strlen(rep),message_body, body_size);\n</code></pre>\n\n<p>There are no actual errors, the page loads fine, it's just that all images except .svg don't load. Also when I inspect them with the web developper mode of firefox, the images are only a few bytes and the dimensions are 0x0.</p>\n\n<p>Thank you in advance for any help you can provide.</p>\n\n<p>Edit 1 :\nHere are some Requests from firefox and Responses respectively :</p>\n\n<p>For index.html</p>\n\n<pre><code>#########################################\nDemande recue depuis le client 9\nClient [9] [127.0.0.1:46918]\nContenu de la demande GET /www.toto.com/index.html HTTP/1.1\nHost: localhost:8080\nUser-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:67.0) Gecko/20100101 Firefox/67.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nConnection: keep-alive\nUpgrade-Insecure-Requests: 1\nCache-Control: max-age=0\n\n\n-----------R\u00e9ponse-------------------\nHTTP/1.0 200 OK\nDate: Wed, 05 Jun 2019 07:32:39 GMT\nServer: groupe15 (Debian9)\nContent-Length: 621\nContent-Type: text/html\nConnection: keep-alive\n\n&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt;\n&lt;link rel=\"stylesheet\" href=\"index.css\"&gt;\n&lt;script src=\"index.js\"&gt;&lt;/script&gt; \n&lt;title&gt;Index page&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n\n&lt;h1&gt;This is a all images i have got so far !!! &lt;/h1&gt;\n&lt;img onmouseover=\"big(this)\" src=\"index.gif\" alt=\"gif\"&gt; \n&lt;img onmouseover=\"big(this)\" src=\"index.png\" alt=\"png\"&gt; \n&lt;img onmouseover=\"big(this)\" src=\"index.svg\" alt=\"svg\"&gt; \n&lt;img onmouseover=\"big(this)\" src=\"index.jpg\" alt=\"jpg\"&gt; \n&lt;img onmouseover=\"big(this)\" src=\"index.jpeg\" alt=\"jpeg\"&gt; \n&lt;img onmouseover=\"big(this)\" src=\"index.tif\" alt=\"tif\"&gt; \n&lt;img onmouseover=\"big(this)\" src=\"index.tiff\" alt=\"tiff\"&gt; \n\n&lt;/body&gt;\n&lt;/html&gt; \n\n</code></pre>\n\n<p>For an image:</p>\n\n<pre><code>#########################################\nDemande recue depuis le client 8\nClient [8] [127.0.0.1:46926]\nContenu de la demande GET /www.toto.com/index.png HTTP/1.1\nHost: localhost:8080\nUser-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:67.0) Gecko/20100101 Firefox/67.0\nAccept: image/webp,*/*\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nReferer: http://localhost:8080/www.toto.com/index.html\nConnection: keep-alive\nCache-Control: max-age=0\n\n-----------R\u00e9ponse-------------------\nHTTP/1.0 200 OK\nDate: Wed, 05 Jun 2019 07:32:39 GMT\nServer: groupe15 (Debian9)\nContent-Length: 2574\nContent-Type: image/png\nConnection: keep-alive\n\n\ufffdPNG\n\n</code></pre>\n\n<p>As you can see, the problem lies in the message body</p>\n"}, {"tags": ["c", "clion"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1559716277, "post_id": 56455257, "comment_id": 99502773, "body": "Try <code>fprintf(stderr, &quot;Unable to open file %s: %s\\n&quot;, argv[1], strerror(errno));</code>. What do you get?"}, {"owner": {"reputation": 655, "user_id": 3616601, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d9dbe1da7416f8fa9b0cf1d0974269e7?s=128&d=identicon&r=PG&f=1", "display_name": "Phantom", "link": "https://stackoverflow.com/users/3616601/phantom"}, "edited": false, "score": 0, "creation_date": 1559716646, "post_id": 56455257, "comment_id": 99502899, "body": "Are you sure the file exist? (this code is quite simple, I&#39;m starting looking at the most simple things ;) ) And add <code>perror(&quot;fopen&quot;);</code> in the <code>if (fp==NULL)</code>, it while give you some info"}, {"owner": {"reputation": 61, "user_id": 11421862, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-EqThchVQMkA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfn5w8m9qWDvZCFQnQBbJCnDu_S0w/mo/photo.jpg?sz=128", "display_name": "Christina", "link": "https://stackoverflow.com/users/11421862/christina"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1559716794, "post_id": 56455257, "comment_id": 99502941, "body": "@melpomene it says &quot;errno&quot; is an undeclared identifier, what should it be?"}, {"owner": {"reputation": 655, "user_id": 3616601, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d9dbe1da7416f8fa9b0cf1d0974269e7?s=128&d=identicon&r=PG&f=1", "display_name": "Phantom", "link": "https://stackoverflow.com/users/3616601/phantom"}, "edited": false, "score": 0, "creation_date": 1559716818, "post_id": 56455257, "comment_id": 99502952, "body": "include <code>#include &lt;errno.h&gt;</code>"}, {"owner": {"reputation": 61, "user_id": 11421862, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-EqThchVQMkA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfn5w8m9qWDvZCFQnQBbJCnDu_S0w/mo/photo.jpg?sz=128", "display_name": "Christina", "link": "https://stackoverflow.com/users/11421862/christina"}, "reply_to_user": {"reputation": 655, "user_id": 3616601, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d9dbe1da7416f8fa9b0cf1d0974269e7?s=128&d=identicon&r=PG&f=1", "display_name": "Phantom", "link": "https://stackoverflow.com/users/3616601/phantom"}, "edited": false, "score": 0, "creation_date": 1559717499, "post_id": 56455257, "comment_id": 99503173, "body": "@Phantom I updated my question with the output I get.  I am not sure why it is saying there is no such file when I have the file on my desktop."}, {"owner": {"reputation": 655, "user_id": 3616601, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d9dbe1da7416f8fa9b0cf1d0974269e7?s=128&d=identicon&r=PG&f=1", "display_name": "Phantom", "link": "https://stackoverflow.com/users/3616601/phantom"}, "edited": false, "score": 1, "creation_date": 1559717548, "post_id": 56455257, "comment_id": 99503187, "body": "@Christina Is it in the directory where you are running your program?"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1559717573, "post_id": 56455257, "comment_id": 99503201, "body": "How are you running your code?"}, {"owner": {"reputation": 61, "user_id": 11421862, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-EqThchVQMkA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfn5w8m9qWDvZCFQnQBbJCnDu_S0w/mo/photo.jpg?sz=128", "display_name": "Christina", "link": "https://stackoverflow.com/users/11421862/christina"}, "reply_to_user": {"reputation": 655, "user_id": 3616601, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d9dbe1da7416f8fa9b0cf1d0974269e7?s=128&d=identicon&r=PG&f=1", "display_name": "Phantom", "link": "https://stackoverflow.com/users/3616601/phantom"}, "edited": false, "score": 0, "creation_date": 1559717575, "post_id": 56455257, "comment_id": 99503203, "body": "@Phantom I am using Clion for the code &amp; it is in the same folder as my project is saved in."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1559717722, "post_id": 56455257, "comment_id": 99503262, "body": "@Christina Is it in the same directory that the executable is in? (Also, what OS are you on?)"}, {"owner": {"reputation": 655, "user_id": 3616601, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d9dbe1da7416f8fa9b0cf1d0974269e7?s=128&d=identicon&r=PG&f=1", "display_name": "Phantom", "link": "https://stackoverflow.com/users/3616601/phantom"}, "edited": false, "score": 0, "creation_date": 1559717856, "post_id": 56455257, "comment_id": 99503313, "body": "@Christina In Clion, is there an option to tell it where to find files? In the if, print the current dir (<code>char *getwd(char *buf);</code>, in <code>#include &lt;unsitd.h&gt;</code>)"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1559717890, "post_id": 56455257, "comment_id": 99503326, "body": "Most IDE&#39;s have a setting that determines the current working directory when the code is run. See <a href=\"https://stackoverflow.com/questions/25834878/\">How do I change the working directory for my program</a>"}, {"owner": {"reputation": 48, "user_id": 11579707, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/251deac0d938d0d3deb300539991a969?s=128&d=identicon&r=PG&f=1", "display_name": "ARD", "link": "https://stackoverflow.com/users/11579707/ard"}, "edited": false, "score": 0, "creation_date": 1559718026, "post_id": 56455257, "comment_id": 99503381, "body": "@Christina, it appears that the executable (not the project) and the text files are not present in the same directory. Please either keep both the files in the same directory, or give the complete path+file name of the file in the command line."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1559718253, "post_id": 56455257, "comment_id": 99503469, "body": "By default, your program runs from <code>cmake-build-debug</code>, so that&#39;s where it&#39;ll look for files."}], "owner": {"reputation": 61, "user_id": 11421862, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-EqThchVQMkA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfn5w8m9qWDvZCFQnQBbJCnDu_S0w/mo/photo.jpg?sz=128", "display_name": "Christina", "link": "https://stackoverflow.com/users/11421862/christina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "closed_date": 1559718074, "answer_count": 0, "score": 1, "last_activity_date": 1559718146, "creation_date": 1559716178, "last_edit_date": 1559718146, "question_id": 56455257, "link": "https://stackoverflow.com/questions/56455257/how-to-fix-function-that-validates-input-from-not-reading-a-text-file", "closed_reason": "Duplicate", "title": "How to fix function (that validates input) from not reading a text file?", "body": "<p>Whenever I enter a text file for my program to read I always get the message: </p>\n\n<pre><code>Unable to open file: big_file.txt\nEnding program.\n</code></pre>\n\n<p>I am not sure what part of the program is not working. I assume that it is either something in main() or validate_input() functions:</p>\n\n<pre><code>FILE* validate_input(int argc, char* argv[]){\n\n    FILE* fp = NULL;\n\n    if(argc &lt; 2){\n        printf(\"Not enough arguments entered.\\nEnding program.\\n\");\n        exit(0);\n    }\n    else if(argc &gt; 2){\n        printf(\"Too many arguments entered.\\nEnding program.\\n\");\n        exit(0);\n    }\n\n    fp = fopen(argv[1], \"r\");\n\n    if(fp == NULL){\n        printf(\"Unable to open file: %s\\nEnding program.\\n\", argv[1]);\n        exit(0);\n    }\n\n    return fp;\n\n}\n\n\nint main(int argc, char* argv[]){\n    char** lines = NULL;\n    int num_lines = 0;\n    FILE* fp = validate_input(argc, argv);\n\n    read_lines(fp, &amp;lines, &amp;num_lines);\n    print_lines(lines, num_lines);\n    free_lines(lines, num_lines);\n    fclose(fp);\n\n    return 0;\n}\n</code></pre>\n\n<p>I expect the program to output each line of a given text with a number in front counting each line, but every time I input a file it claims it cannot be read.</p>\n\n<p>UPDATE:\nWhen I add <code>fprintf(stderr, \"Unable to open file %s: %s\\n\", argv[1], strerror(errno));</code> </p>\n\n<p>my output is:</p>\n\n<pre><code>Unable to open file big_file.txt: No such file or directory\n</code></pre>\n\n<p>but the file is on my desktop.</p>\n\n<p>Not sure if this is the right place for the file but here it is:\n<a href=\"https://i.stack.imgur.com/lFuTR.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/lFuTR.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c", "linux", "x11", "xlib"], "answers": [{"comments": [{"owner": {"reputation": 185, "user_id": 2352564, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/7kuAa.jpg?s=128&g=1", "display_name": "Scott Franco", "link": "https://stackoverflow.com/users/2352564/scott-franco"}, "edited": false, "score": 0, "creation_date": 1559716958, "post_id": 56455156, "comment_id": 99502991, "body": "Yes, I get what you are saying and thanks for that. The send yourself an expose event works, but would result in the entire buffer/screen being repainted. Since the routine is printing one character at a time, I expect that performance of that to suck. The traditional MS windows method is to invalidate just the bounding box for the character, so that the expose event only copies that part of the buffer, plus it optimizes by combining multiple events and even finding the greatest enclosing rectangle. This would apply, if for example I draw multiple characters before getting the next event."}, {"owner": {"reputation": 185, "user_id": 2352564, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/7kuAa.jpg?s=128&g=1", "display_name": "Scott Franco", "link": "https://stackoverflow.com/users/2352564/scott-franco"}, "edited": false, "score": 0, "creation_date": 1559717269, "post_id": 56455156, "comment_id": 99503091, "body": "This question covers this a bit, but does not give an answer: <a href=\"https://stackoverflow.com/questions/17027993/equivalent-of-invalidate-rect-wm-paint-in-x11\" title=\"equivalent of invalidate rect wm paint in x11\">stackoverflow.com/questions/17027993/&hellip;</a>"}, {"owner": {"reputation": 26680, "user_id": 1806780, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/NCB41.jpg?s=128&g=1", "display_name": "Sami Kuhmonen", "link": "https://stackoverflow.com/users/1806780/sami-kuhmonen"}, "reply_to_user": {"reputation": 185, "user_id": 2352564, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/7kuAa.jpg?s=128&g=1", "display_name": "Scott Franco", "link": "https://stackoverflow.com/users/2352564/scott-franco"}, "edited": false, "score": 0, "creation_date": 1559717534, "post_id": 56455156, "comment_id": 99503182, "body": "@ScottFranco It doesn\u2019t result in the whole window being painted, you can send the rectangle to paint and only paint that part in the event handler. So you\u2019re in control. But it\u2019s definitely not as easy as just drawing things on screen and letting some underlying system draw the necessary parts."}, {"owner": {"reputation": 185, "user_id": 2352564, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/7kuAa.jpg?s=128&g=1", "display_name": "Scott Franco", "link": "https://stackoverflow.com/users/2352564/scott-franco"}, "edited": false, "score": 0, "creation_date": 1559717856, "post_id": 56455156, "comment_id": 99503312, "body": "There is a way in X11 to pass a rectangle to draw to expose, or were you talking about end-around with a global?"}, {"owner": {"reputation": 26680, "user_id": 1806780, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/NCB41.jpg?s=128&g=1", "display_name": "Sami Kuhmonen", "link": "https://stackoverflow.com/users/1806780/sami-kuhmonen"}, "reply_to_user": {"reputation": 185, "user_id": 2352564, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/7kuAa.jpg?s=128&g=1", "display_name": "Scott Franco", "link": "https://stackoverflow.com/users/2352564/scott-franco"}, "edited": false, "score": 1, "creation_date": 1559719622, "post_id": 56455156, "comment_id": 99504019, "body": "@ScottFranco Yes, the Expose event carries information about what area needs to be painted. See here <a href=\"https://tronche.com/gui/x/xlib/events/exposure/expose.html\" rel=\"nofollow noreferrer\">tronche.com/gui/x/xlib/events/exposure/expose.html</a> so you can send that information yourself as well as use it in the event handler to only paint part of the window"}, {"owner": {"reputation": 185, "user_id": 2352564, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/7kuAa.jpg?s=128&g=1", "display_name": "Scott Franco", "link": "https://stackoverflow.com/users/2352564/scott-franco"}, "edited": false, "score": 0, "creation_date": 1559752968, "post_id": 56455156, "comment_id": 99521061, "body": "Sami I saw that later and incorporated it into the example below. Thank you."}], "tags": [], "owner": {"reputation": 26680, "user_id": 1806780, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/NCB41.jpg?s=128&g=1", "display_name": "Sami Kuhmonen", "link": "https://stackoverflow.com/users/1806780/sami-kuhmonen"}, "is_accepted": false, "score": 6, "last_activity_date": 1559715672, "creation_date": 1559715672, "answer_id": 56455156, "question_id": 56454948, "link": "https://stackoverflow.com/questions/56454948/why-does-it-matter-when-you-draw-in-xwindows/56455156#56455156", "title": "Why does it matter when you draw in XWindows?", "body": "<p>X servers are not required to provide backing store by themselves, so <code>Expose</code> events are sent when the window needs to be drawn. This is the same functionality that happens in other environments also. In the beginning you can draw, but the X server may not have set up the window properly yet and will later report to you when it\u2019s ready to have contents drawn on to screen. The drawing is kind of directly on screen, not to a backing buffer, so it has to be done every time the window is brought in front. </p>\n\n<p>As for requesting a redraw yourself you can use <code>XSendEvent</code> to send an <code>Expose</code> event yourself and then X will relay it to your event loop. So it\u2019s practically exactly the same as Windows does. </p>\n"}, {"comments": [{"owner": {"reputation": 185, "user_id": 2352564, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/7kuAa.jpg?s=128&g=1", "display_name": "Scott Franco", "link": "https://stackoverflow.com/users/2352564/scott-franco"}, "edited": false, "score": 0, "creation_date": 1559752732, "post_id": 56456205, "comment_id": 99520961, "body": "I agree with you mostly. Windows (as pointed out elsewhere) does not follow the X11 model. If you have valid data structures, and the window is onscreen, you are going to be able to draw on it. The place where the X11 model runs into trouble is with continuous animator programs, where drawing operations are pushed either continuously to the display or via a periodic timer. I see from elsewhere that timers, so essential for animation, are also left out of the X11 specification, IE, you cannot treat timers as an event."}, {"owner": {"reputation": 3350, "user_id": 7332147, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e4GFL.png?s=128&g=1", "display_name": "linuxfan says Reinstate Monica", "link": "https://stackoverflow.com/users/7332147/linuxfan-says-reinstate-monica"}, "reply_to_user": {"reputation": 185, "user_id": 2352564, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/7kuAa.jpg?s=128&g=1", "display_name": "Scott Franco", "link": "https://stackoverflow.com/users/2352564/scott-franco"}, "edited": false, "score": 0, "creation_date": 1559804797, "post_id": 56456205, "comment_id": 99535555, "body": "@ScottFranco I agree partly. Windows timers are quite crappy, but they have the advantage of letting you know <i>when</i> the GUI is ready. X11 does not have them, sometimes they would be handy, but all that fits in client/server paradigm which is not very suitable for real time animation. Apart from that, X11 is far more powerful than windows, especially if you consider its age!"}, {"owner": {"reputation": 185, "user_id": 2352564, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/7kuAa.jpg?s=128&g=1", "display_name": "Scott Franco", "link": "https://stackoverflow.com/users/2352564/scott-franco"}, "edited": false, "score": 0, "creation_date": 1560111336, "post_id": 56456205, "comment_id": 99621349, "body": "Ok, then what interface <i>IS</i> suitable for animation on Linux? I use windows timers for buffer flip animation. The Xwindows equivalent is actually pretty painful."}, {"owner": {"reputation": 3350, "user_id": 7332147, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e4GFL.png?s=128&g=1", "display_name": "linuxfan says Reinstate Monica", "link": "https://stackoverflow.com/users/7332147/linuxfan-says-reinstate-monica"}, "reply_to_user": {"reputation": 185, "user_id": 2352564, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/7kuAa.jpg?s=128&g=1", "display_name": "Scott Franco", "link": "https://stackoverflow.com/users/2352564/scott-franco"}, "edited": false, "score": 0, "creation_date": 1560154260, "post_id": 56456205, "comment_id": 99629538, "body": "@ScottFranco Sadly I don&#39;t know, <b>but</b> I suggest to take a look at some prominent software, for example mplayer. Anyway I suppose you can use a simple timer to invalidate regularly your window, and reply to expose events as usual."}], "tags": [], "owner": {"reputation": 3350, "user_id": 7332147, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e4GFL.png?s=128&g=1", "display_name": "linuxfan says Reinstate Monica", "link": "https://stackoverflow.com/users/7332147/linuxfan-says-reinstate-monica"}, "is_accepted": false, "score": 2, "last_activity_date": 1559720851, "creation_date": 1559720851, "answer_id": 56456205, "question_id": 56454948, "link": "https://stackoverflow.com/questions/56454948/why-does-it-matter-when-you-draw-in-xwindows/56456205#56456205", "title": "Why does it matter when you draw in XWindows?", "body": "<p>Just to add a bit to the good reply from Sami.</p>\n\n<p>Thinking deeply, the way X11 works is the only correct one when multiple windows, which can overlap each other, are used (not counting a lot of other things). This is why this mechanism (invalidate and expose | draw | paint) is used by many frameworks (X11, windows, gtk, qt...).</p>\n\n<p>It's all about optimizing the drawing. You should not draw blindly, because your drawing could be discarded; may be your window is invisible, may be the user is moving the window without repainting its content, or whatever.</p>\n\n<p>Instead, X11 (or other toolkit/framework) knows very well when data has to be displayed, and <em>can</em> be displayed. In that situation, X11 tells you to redraw (via an expose event). When X11 asks to repaint, your drawing operations will not be discarded.</p>\n\n<p>On the other hands, a good X11 program should be prepared to repaint when needed: it will happen often, if the user drags windows around, or changes virtual desktops, iconifies the application, and so on.</p>\n\n<p>Combine the two aspects: the program <em>must</em> draw when asked to, and it will be asked for sure just after having created its first window. So, it is perfect to draw only in the expose event.</p>\n\n<p>This basic mechanism can be improved by backing store: X11 can cache the drawing data, and use them later instead of asking the program again and again and again for the same data. Sometimes backing store is faster, but sometimes it only wastes memory.</p>\n"}, {"comments": [{"owner": {"reputation": 185, "user_id": 2352564, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/7kuAa.jpg?s=128&g=1", "display_name": "Scott Franco", "link": "https://stackoverflow.com/users/2352564/scott-franco"}, "edited": false, "score": 0, "creation_date": 1559747054, "post_id": 56456553, "comment_id": 99517895, "body": "I considered that X11 might need to wait for the first expose. However, I saw the behavior in my full program (not the demo) that this occurred even after the window was already running. In fact I saw cases where the single characters got painted in the window many seconds after the draw operation. Its not sitting in the queue, I printed the queue numbers and they are 0, and (as above) XFlush does not help."}], "tags": [], "owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "is_accepted": false, "score": 2, "last_activity_date": 1559722356, "creation_date": 1559722356, "answer_id": 56456553, "question_id": 56454948, "link": "https://stackoverflow.com/questions/56454948/why-does-it-matter-when-you-draw-in-xwindows/56456553#56456553", "title": "Why does it matter when you draw in XWindows?", "body": "<p>Remember that you are in client/server environment. Means that there are delays in between your code requests and their realizations. Returning from call to <code>XMapWindow</code> does not means that your window is really ready to accept drawings only that the XServer has to do it, so you <strong>need</strong> to wait the first <code>Expose</code> event to draw, which means that the XServer did the job. It is mandatory, because <code>Expose</code> is the event representing the fact that the window (or a portion of it) is viewable on screen.</p>\n\n<p>Always remember : UIs are event-driven.</p>\n"}, {"comments": [{"owner": {"reputation": 185, "user_id": 2352564, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/7kuAa.jpg?s=128&g=1", "display_name": "Scott Franco", "link": "https://stackoverflow.com/users/2352564/scott-franco"}, "edited": false, "score": 0, "creation_date": 1559753310, "post_id": 56464181, "comment_id": 99521207, "body": "So in case it was not apparent, I am pretty happy with the answer, which is to send yourself events via XSendEvent. I don&#39;t think I quite understand when and why X11 is ignoring or delaying draws, but I agree this detail is not required to achieve my ends. This information is going into a real program: <a href=\"https://sourceforge.net/projects/petitami/\" rel=\"nofollow noreferrer\">sourceforge.net/projects/petitami</a>. This is a graphical toolkit I created for MS Windows back in 1997 that I am now porting to X11 (yea,a bit late I know)."}], "tags": [], "owner": {"reputation": 185, "user_id": 2352564, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/7kuAa.jpg?s=128&g=1", "display_name": "Scott Franco", "link": "https://stackoverflow.com/users/2352564/scott-franco"}, "is_accepted": false, "score": 1, "last_activity_date": 1559750596, "creation_date": 1559750596, "answer_id": 56464181, "question_id": 56454948, "link": "https://stackoverflow.com/questions/56454948/why-does-it-matter-when-you-draw-in-xwindows/56464181#56464181", "title": "Why does it matter when you draw in XWindows?", "body": "<p>Ok, I thought about this last night and realized that an old, classic program called \"lines\" illustrates the issue I am talking about:</p>\n\n<pre><code>#include &lt;X11/Xlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint randr(int upper)\n\n{\n\n   return rand() % (upper+1);\n\n}   \n\nint main(void) {\n\n    Display *d;\n    Window w;\n    XEvent e;\n    const char *msg = \"Hello, World!\";\n    int s;\n    XEvent se;\n\n    d = XOpenDisplay(NULL);\n    if (d == NULL) {\n       fprintf(stderr, \"Cannot open display\\n\");\n       exit(1);\n    }\n\n    s = DefaultScreen(d);\n    w = XCreateSimpleWindow(d, RootWindow(d, s), 10, 10, 400, 400, 1,\n                            BlackPixel(d, s), WhitePixel(d, s));\n    XSelectInput(d, w, ExposureMask | KeyPressMask);\n    XMapWindow(d, w);\n\n    se.type = Expose;\n    se.xexpose.type = Expose;\n    se.xexpose.serial = 0;\n    se.xexpose.send_event = 1;\n    se.xexpose.window = w;\n    se.xexpose.x = 0;\n    se.xexpose.y = 0;\n    se.xexpose.width = 400;\n    se.xexpose.height = 400;\n    se.xexpose.count = 0;\n\n    while (1) {\n       XNextEvent(d, &amp;e);\n       if (e.type == Expose) {\n          XSetForeground(d, DefaultGC(d, s), randr(255)&lt;&lt;16 | randr(255)&lt;&lt;8 | randr(255));\n          XDrawLine(d, w, DefaultGC(d, s), randr(400), randr(400), randr(400), randr(400));\n          XSendEvent(d, w, 0, ExposureMask, &amp;se);\n       }\n       if (e.type == KeyPress) break;\n    }\n\n    XCloseDisplay(d);\n\n    return 0;\n}\n</code></pre>\n\n<p>Lines is an old program that goes back to the days of the Cromemco Dazzler of the late 1970's. It just draws random lines, it does it quite fast. It has no need of input, it just draws and draws, and it can serve as a performance test as well.</p>\n\n<p>As you see here I have tricked X11 into continuously processing the expose event by posting another one in the expose event itself. In (for example) MS windows this would not be necessary. You can draw on the window at any time, and not reading your event queue is not nice, but the program still works.</p>\n\n<p>This program works in X11, and (on my machine) works so rapidly that it basically fills the window almost immediately.</p>\n\n<p>Now if I wanted to make that demo work as fast as possible I would need to account for the major time sinks in the program, which, as far as I can tell, is the need to continually post the new expose events.</p>\n"}], "owner": {"reputation": 185, "user_id": 2352564, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/7kuAa.jpg?s=128&g=1", "display_name": "Scott Franco", "link": "https://stackoverflow.com/users/2352564/scott-franco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 647, "favorite_count": 0, "answer_count": 4, "score": 4, "last_activity_date": 1559750596, "creation_date": 1559714360, "last_edit_date": 1559714564, "question_id": 56454948, "link": "https://stackoverflow.com/questions/56454948/why-does-it-matter-when-you-draw-in-xwindows", "title": "Why does it matter when you draw in XWindows?", "body": "<p>I got this XWindows \"hello, world\" off the net. I have behavior I don't understand in a more complex program, but the simple program here also displays it:</p>\n\n<pre><code>#include &lt;X11/Xlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint main(void) {\n   Display *d;\n   Window w;\n   XEvent e;\n   const char *msg = \"Hello, World!\";\n   int s;\n   int x;\n\n   d = XOpenDisplay(NULL);\n   if (d == NULL) {\n      fprintf(stderr, \"Cannot open display\\n\");\n      exit(1);\n   }\n\n   s = DefaultScreen(d);\n   w = XCreateSimpleWindow(d, RootWindow(d, s), 10, 10, 100, 100, 1,\n                           BlackPixel(d, s), WhitePixel(d, s));\n   XSelectInput(d, w, ExposureMask | KeyPressMask);\n   XMapWindow(d, w);\n\n   XDrawString(d, w, DefaultGC(d, s), 10, 50, msg, strlen(msg));\n\n   //XFlush(d);\n\n   while (1) {\n      XNextEvent(d, &amp;e);\n      if (e.type == Expose) {\n//         XDrawString(d, w, DefaultGC(d, s), 10, 50, msg, strlen(msg));\n      }\n      if (e.type == KeyPress) break;\n   }\n\n   XCloseDisplay(d);\n   return 0;\n}\n</code></pre>\n\n<p>So the first XDrawString() call does not actually write to the window, but uncommenting the one in the expose event does. I find this behavior confusing. At the time of the first XDrawString(), the display, screen and window are all set up. Yet that does not draw and the one that appears in the event handler does. I also tried XFlush()'ing the queue, it makes no difference.</p>\n\n<p>This effect had bearing on the (much) more complex code I am working on, which is placing characters on screen. I place them at the desired location in a pixmap that backs the screen, and then I do the same draw to the real screen to keep it in sync. The expose handler will copy the pixmap to the screen, which updates it, but that expose event won't happen until later, and besides, copying the entire pixmap back to the screen is more expensive than placing a single character.</p>\n\n<p>I suspect I need to follow the draw to buffer with an operation flagging the rectangle under the character as invalid (this would be the MS windows way) and letting the event handler take care of it, but I would like to understand what goes on inside X11 to make this happen.</p>\n"}, {"tags": ["c", "pointers", "memory", "malloc", "dynamic-memory-allocation"], "comments": [{"owner": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "edited": false, "score": 1, "creation_date": 1559711381, "post_id": 56454514, "comment_id": 99501531, "body": "&quot;how does this work?&quot; by luck."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "edited": false, "score": 6, "creation_date": 1559712280, "post_id": 56454514, "comment_id": 99501721, "body": "@MatteoItalia or, let&#39;s say, bad luck!!"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1559712324, "post_id": 56454514, "comment_id": 99501738, "body": "It doesn&#39;t work. It clobbers memory, resulting in <a href=\"https://stackoverflow.com/questions/2397984\">undefined behavior</a>."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1559716673, "post_id": 56454514, "comment_id": 99502910, "body": "Kind of a duplicate: <a href=\"https://stackoverflow.com/questions/2235457/how-to-explain-undefined-behavior-to-know-it-all-newbies\">How to explain undefined behavior to know-it-all newbies?</a>."}], "answers": [{"comments": [{"owner": {"reputation": 1691, "user_id": 6396569, "user_type": "registered", "accept_rate": 61, "profile_image": "https://lh3.googleusercontent.com/-f0efiZGjd9s/AAAAAAAAAAI/AAAAAAAAAFQ/A1O5wGFybXA/photo.jpg?sz=128", "display_name": "the_endian", "link": "https://stackoverflow.com/users/6396569/the-endian"}, "edited": false, "score": 0, "creation_date": 1559796494, "post_id": 56454646, "comment_id": 99532949, "body": "I appreciate the info here. I have one other question - Do modern operating systems (Windows 10, macOS, etc...) actually allow anything bad to happen from accessing memory like this other than a potential segfault? I hear of how this can lead to random behavior or overwrites like you said but I&#39;ve never observed any actual bad behavior other than segfaults. I&#39;m not asserting that this is good and I totally understand and I avoid UB wherever I can... But I&#39;m wondering if this is mostly in embedded systems where OSes may not protect memory that such bad things can occur."}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 5, "last_activity_date": 1559712463, "last_edit_date": 1559712463, "creation_date": 1559712238, "answer_id": 56454646, "question_id": 56454514, "link": "https://stackoverflow.com/questions/56454514/how-does-a-pointer-heap-allocation-allocate-sufficient-space-for-a-struct-in-c/56454646#56454646", "title": "How does a pointer heap allocation allocate sufficient space for a struct in C?", "body": "<blockquote>\n  <p><em>So my question is, where is this struct data actually stored and if it is stored on the heap, how does this work?</em></p>\n</blockquote>\n\n<p>It <em>appears</em> to work, accessing invalid memory is <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behavior (UB)</a>. Don't do that.</p>\n\n<p>To elaborate, as you mention, you have allocated memory only by the size of a pointer, however, you are using that pointer to access memory beyond that boundary. The memory location, outside the allocated block, is not allocated to your program, thus that memory is invalid in context of your program, and trying to access the memory is UB.</p>\n\n<p>Based on the individual scenario, it may cause</p>\n\n<ul>\n<li>appear to work</li>\n<li>overwrite some other memory location</li>\n<li>produce a segmentation fault</li>\n<li>print the national anthem of your country</li>\n<li>order pizza and pony using your credit card for the entire team</li>\n</ul>\n\n<p>any or all, in no particular order.</p>\n"}], "owner": {"reputation": 1691, "user_id": 6396569, "user_type": "registered", "accept_rate": 61, "profile_image": "https://lh3.googleusercontent.com/-f0efiZGjd9s/AAAAAAAAAAI/AAAAAAAAAFQ/A1O5wGFybXA/photo.jpg?sz=128", "display_name": "the_endian", "link": "https://stackoverflow.com/users/6396569/the-endian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1559712667, "creation_date": 1559711280, "last_edit_date": 1559712667, "question_id": 56454514, "link": "https://stackoverflow.com/questions/56454514/how-does-a-pointer-heap-allocation-allocate-sufficient-space-for-a-struct-in-c", "title": "How does a pointer heap allocation allocate sufficient space for a struct in C?", "body": "<p>The following code compiles and runs perfectly:</p>\n\n<pre><code>typedef struct n {\n    char value;\n    struct n* next;\n} node;\nvoid insert_new_node(node** head, char new_value)\n{\n    node* new_node = malloc(sizeof(node*));\n    new_node-&gt;value = new_value;\n    new_node-&gt;next = NULL;\n\n    if(*head == NULL)\n    {\n        *head = new_node;\n    }\n    else\n    {\n        node* current = *head;\n\n        while(current-&gt;next != NULL)\n        {\n            current = current-&gt;next;\n        }\n\n        current-&gt;next = new_node;\n    }\n}\n</code></pre>\n\n<p>My question is - notice that I only actually malloc space for a <strong>pointer</strong> to a struct... Not for the struct itself (ref: <code>node* new_node = malloc(sizeof(node*));</code>). So my question is, where is this struct data actually stored and if it is stored on the heap, how does this work?</p>\n"}, {"tags": ["c", "makefile", "linker"], "comments": [{"owner": {"reputation": 539, "user_id": 2805824, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tBgwo.gif?s=128&g=1", "display_name": "Gaurav Pathak", "link": "https://stackoverflow.com/users/2805824/gaurav-pathak"}, "edited": false, "score": 0, "creation_date": 1559708149, "post_id": 56454097, "comment_id": 99500938, "body": "The above Makefile looks similar to that of a Kernel Source tree. Are you trying to compile a Linux Kernel driver?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1559710838, "post_id": 56454097, "comment_id": 99501433, "body": "If there are no files from which the object file can be created by implicit rules, but the   Makefile references the object file in the link command line, there&#39;ll be no problem.  If the object file vanishes, then compilations will fail.  If there are source files from which the object file can be created, they will be used if the object file is older than the corresponding source files."}, {"owner": {"reputation": 6882, "user_id": 3403834, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xpA5S.jpg?s=128&g=1", "display_name": "user58697", "link": "https://stackoverflow.com/users/3403834/user58697"}, "edited": false, "score": 0, "creation_date": 1559711827, "post_id": 56454097, "comment_id": 99501619, "body": "If you literally have <code>CONFIG_xxx</code>, it is likely to make no sense. What is the actual config you are trying to link?"}, {"owner": {"reputation": 13, "user_id": 1258436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a74d567648ff095d38fa247029b94a6?s=128&d=identicon&r=PG", "display_name": "Vick753", "link": "https://stackoverflow.com/users/1258436/vick753"}, "reply_to_user": {"reputation": 539, "user_id": 2805824, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tBgwo.gif?s=128&g=1", "display_name": "Gaurav Pathak", "link": "https://stackoverflow.com/users/2805824/gaurav-pathak"}, "edited": false, "score": 0, "creation_date": 1559714602, "post_id": 56454097, "comment_id": 99502282, "body": "@Gaurav  yes, I made some function for Linux kernel driver to invoke"}, {"owner": {"reputation": 13, "user_id": 1258436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a74d567648ff095d38fa247029b94a6?s=128&d=identicon&r=PG", "display_name": "Vick753", "link": "https://stackoverflow.com/users/1258436/vick753"}, "reply_to_user": {"reputation": 6882, "user_id": 3403834, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xpA5S.jpg?s=128&g=1", "display_name": "user58697", "link": "https://stackoverflow.com/users/3403834/user58697"}, "edited": false, "score": 0, "creation_date": 1559714761, "post_id": 56454097, "comment_id": 99502319, "body": "@user58697 I have defined CONFIG_xxx in KCONFIG."}, {"owner": {"reputation": 13, "user_id": 1258436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a74d567648ff095d38fa247029b94a6?s=128&d=identicon&r=PG", "display_name": "Vick753", "link": "https://stackoverflow.com/users/1258436/vick753"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1559717285, "post_id": 56454097, "comment_id": 99503098, "body": "@JonathanLeffler Is there any guide for adding reference the obj file in the link command line ?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1559717450, "post_id": 56454097, "comment_id": 99503154, "body": "It depends how your makefile is written.  If you have a rule like <code>program: ${OBJECTS}</code> \u2014\u2014 <code>${CC} -o $@ ${CFLAGS} ${OBJECTS} ${LDFLAGS} ${LDLIBS}</code> then you simply make sure your object file is listed in <code>${OBJECTS}</code>.  That might be <code>OBJECTS += your_object.o</code>.  If you have something more complex, then the change is correspondingly more complex."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1559718040, "post_id": 56454097, "comment_id": 99503391, "body": "Your question doesn&#39;t show your makefile \u2014 or, if that <b><i>is</i></b> your makefile, it is like no other makefile I&#39;ve ever seen, and it must be leveraging a huge framework that gives meaning to names like <code>obj-${CONFIG_SH_MMCIF}</code>.   The indentation is suspect \u2014 are those lines indented in the makefile?  If those are all macros \u2014 and it looks like they are \u2014 then there must be some code somewhere, probably in an included file, that makes use of them.  Look for <code>include</code> lines in the makefile(s), or maybe you invoke <code>make -f template.1 -f makefile -f template.2</code> or some other fancy mechanism."}, {"owner": {"reputation": 13, "user_id": 1258436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a74d567648ff095d38fa247029b94a6?s=128&d=identicon&r=PG", "display_name": "Vick753", "link": "https://stackoverflow.com/users/1258436/vick753"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1559784171, "post_id": 56454097, "comment_id": 99530904, "body": "@JonathanLeffler Just for confirmation, does compile check source file if I write OBJECTS += your_object.o ?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1559784358, "post_id": 56454097, "comment_id": 99530933, "body": "It doesn&#39;t matter how you write <code>your_object.o</code> into the <code>makefile</code>; when it comes time to use it, if it is listed as a dependency, then it will be checked to see whether it needs to be rebuilt.  If it is not listed as a dependency (it just appears magically in a command line), it will not be checked.  It all hinges on how your makefile is written."}, {"owner": {"reputation": 13, "user_id": 1258436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a74d567648ff095d38fa247029b94a6?s=128&d=identicon&r=PG", "display_name": "Vick753", "link": "https://stackoverflow.com/users/1258436/vick753"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1559792218, "post_id": 56454097, "comment_id": 99532208, "body": "@JonathanLeffler I have already put parts of the Makefile in root folder. Even if I find the TARGET or proper position to do modification. I still don&#39;t know how to achieve my need."}], "owner": {"reputation": 13, "user_id": 1258436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a74d567648ff095d38fa247029b94a6?s=128&d=identicon&r=PG", "display_name": "Vick753", "link": "https://stackoverflow.com/users/1258436/vick753"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 403, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1559792008, "creation_date": 1559707329, "last_edit_date": 1559792008, "question_id": 56454097, "link": "https://stackoverflow.com/questions/56454097/is-there-any-way-to-link-a-existed-object-file-in-makefile-when-compiling", "title": "Is there any way to link a existed object file in Makefile when compiling?", "body": "<p>I want to use the object files already compiled and only link it in Makefile without compiling again.</p>\n\n<p>Then I can put .o file in source folder not .c file.</p>\n\n<p>Is that possible? Thanks in advance!!</p>\n\n<p>I have tried below, but it is not working.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/33338028/how-to-create-reference-to-an-o-file-in-makefile\">How to create reference to an .o file in Makefile</a></p>\n\n<p>Actually, I still not sure how it works on my case.</p>\n\n<p>More specific:\nPlease see my makefile:</p>\n\n<pre><code>    obj-$(CONFIG_SH_MMCIF) += sh_mmcif.o\n    obj-$(CONFIG_SH_SDHI) += sh_sdhi.o\n    obj-$(CONFIG_STM32_SDMMC2) += stm32_sdmmc2.o\n    obj-$(CONFIG_MMC_NDS32) += nds32_mmc.o\n    PREBUILT_O = mysource.o\n    obj-$(CONFIG_xxx) += $(PREBUILT_O)\n    obj-$(CONFIG_MMC_MXC)           += mxcmmc.o\n    obj-$(CONFIG_MMC_MXS)           += mxsmmc.o  \n</code></pre>\n\n<p>By the way, I can not find \"TARGET\" in Makefile.</p>\n\n<pre><code>$(TARGET): $(OBJECTS) $(PREBUILT_O)\n\n  $(CC) $(OBJECTS) $(PREBUILT_O) $(LIBS) -o $@\n</code></pre>\n\n<p>I have no idea how \"obj-$() += \" works for the final TARGET.</p>\n\n<p>It is hard to find the TARGET in the Makefile of upper folder either.</p>\n\n<p>So here are my steps:</p>\n\n<ol>\n<li><p>Set obj-$(CONFIG_xxx) += mysource.o in Makefile</p></li>\n<li><p>Compile it, it will generate .o file under out/</p></li>\n<li><p>Get mysource.o from out/</p></li>\n<li><p>Remove mysource.c</p></li>\n<li><p>Modify Makefile => link mysource.o to obj-$(CONFIG_xxx) without compiling</p></li>\n<li><p>Compile it</p></li>\n</ol>\n\n<p>=>The compiling error is occurred. \nUndefined reference function is still there if other .c file use this obj file.</p>\n\n<p>It seems the compiler still compile mysource.o.</p>\n\n<p>How to link mysource.o to obj-$(CONFIG_xxx) without compile again?</p>\n\n<p>By the way, mysource.c and Makefile is under uboot_xxx/drivers/usb/gadget/</p>\n\n<p>Below is part of Makefile under uboot_xxx/</p>\n\n<pre><code>ifeq ($(KBUILD_SRC),)\n        # building in the source tree\n        srctree := .\nelse\n        ifeq ($(KBUILD_SRC)/,$(dir $(CURDIR)))\n                # building in a subdirectory of the source tree\n                srctree := ..\n        else\n                srctree := $(KBUILD_SRC)\n        endif\nendif\nobjtree     := .\nsrc     := $(srctree)\nobj     := $(objtree)\n\nVPATH       := $(srctree)$(if $(KBUILD_EXTMOD),:$(KBUILD_EXTMOD))\n\nexport srctree objtree VPATH\n############################################\n# set default to nothing for native builds\nifeq ($(HOSTARCH),$(ARCH))\nCROSS_COMPILE ?=\nendif\n\nKCONFIG_CONFIG  ?= .config\nexport KCONFIG_CONFIG\n\n# SHELL used by kbuild\nCONFIG_SHELL := $(shell if [ -x \"$$BASH\" ]; then echo $$BASH; \\\n      else if [ -x /bin/bash ]; then echo /bin/bash; \\\n      else echo sh; fi ; fi)\n\nHOSTCC       = cc\nHOSTCXX      = c++\nHOSTCFLAGS   = -Wall -Wstrict-prototypes -O2 -fomit-frame-pointer \\\n        $(if $(CONFIG_TOOLS_DEBUG),-g)\nHOSTCXXFLAGS = -O2\n\nifeq ($(HOSTOS),cygwin)\nHOSTCFLAGS  += -ansi\nendif\n\n# ======================================================================\n# Build targets only - this includes vmlinux, arch specific targets, clean\n# targets and others. In general all targets except *config targets.\n\n# Additional helpers built in scripts/\n# Carefully list dependencies so we do not try to build scripts twice\n# in parallel\nPHONY += scripts\nscripts: scripts_basic include/config/auto.conf\n    $(Q)$(MAKE) $(build)=$(@)\n\n# Read in dependencies to all Kconfig* files, make sure to run\n# oldconfig if changes are detected.\n-include include/config/auto.conf.cmd\n\n\nu-boot.cfg spl/u-boot.cfg tpl/u-boot.cfg: include/config.h FORCE\n    $(Q)$(MAKE) -f $(srctree)/scripts/Makefile.autoconf $(@)\n\n-include include/autoconf.mk\n-include include/autoconf.mk.dep\n\n# If board code explicitly specified LDSCRIPT or CONFIG_SYS_LDSCRIPT, use\n# that (or fail if absent).  Otherwise, search for a linker script in a\n# standard location.\n\nifndef LDSCRIPT\n    #LDSCRIPT := $(srctree)/board/$(BOARDDIR)/u-boot.lds.debug\n    ifdef CONFIG_SYS_LDSCRIPT\n        # need to strip off double quotes\n        LDSCRIPT := $(srctree)/$(CONFIG_SYS_LDSCRIPT:\"%\"=%)\n    endif\nendif\n\n# If there is no specified link script, we look in a number of places for it\nifndef LDSCRIPT\n    ifeq ($(wildcard $(LDSCRIPT)),)\n        LDSCRIPT := $(srctree)/board/$(BOARDDIR)/u-boot.lds\n    endif\n    ifeq ($(wildcard $(LDSCRIPT)),)\n        LDSCRIPT := $(srctree)/$(CPUDIR)/u-boot.lds\n    endif\n    ifeq ($(wildcard $(LDSCRIPT)),)\n        LDSCRIPT := $(srctree)/arch/$(ARCH)/cpu/u-boot.lds\n    endif\nendif\n\nelse\n\n# Add user supplied CPPFLAGS, AFLAGS and CFLAGS as the last assignments\nKBUILD_CPPFLAGS += $(KCPPFLAGS)\nKBUILD_AFLAGS += $(KAFLAGS)\nKBUILD_CFLAGS += $(KCFLAGS)\n\n# Use UBOOTINCLUDE when you must reference the include/ directory.\n# Needed to be compatible with the O= option\nUBOOTINCLUDE    := \\\n        -Iinclude \\\n        $(if $(KBUILD_SRC), -I$(srctree)/include) \\\n        $(if $(CONFIG_$(SPL_)SYS_THUMB_BUILD), \\\n            $(if $(CONFIG_HAS_THUMB2),, \\\n                -I$(srctree)/arch/$(ARCH)/thumb1/include),) \\\n        -I$(srctree)/arch/$(ARCH)/include \\\n        -include $(srctree)/include/linux/kconfig.h\n\nNOSTDINC_FLAGS += -nostdinc -isystem $(shell $(CC) -print-file-name=include)\nCHECKFLAGS     += $(NOSTDINC_FLAGS)\n\n# FIX ME\ncpp_flags := $(KBUILD_CPPFLAGS) $(PLATFORM_CPPFLAGS) $(UBOOTINCLUDE) \\\n                            $(NOSTDINC_FLAGS)\nc_flags := $(KBUILD_CFLAGS) $(cpp_flags)\n\n#########################################################################\n# U-Boot objects....order is important (i.e. start must be first)\n\nHAVE_VENDOR_COMMON_LIB = $(if $(wildcard $(srctree)/board/$(VENDOR)/common/Makefile),y,n)\nlibs-y += lib/\nlibs-$(HAVE_VENDOR_COMMON_LIB) += board/$(VENDOR)/common/\nlibs-$(CONFIG_OF_EMBED) += dts/\nlibs-y += fs/\nlibs-y += net/\nlibs-y += disk/\nlibs-y += drivers/\nlibs-y += drivers/dma/\nlibs-y += drivers/gpio/\nlibs-y += drivers/i2c/\nlibs-y += drivers/mtd/\nlibs-$(CONFIG_CMD_NAND) += drivers/mtd/nand/\nlibs-y += drivers/mtd/onenand/\nlibs-$(CONFIG_CMD_UBI) += drivers/mtd/ubi/\nlibs-y += drivers/mtd/spi/\nlibs-y += drivers/net/\nlibs-y += drivers/net/phy/\nlibs-y += drivers/pci/\nlibs-y += drivers/power/ \\\n    drivers/power/domain/ \\\n    drivers/power/fuel_gauge/ \\\n    drivers/power/mfd/ \\\n    drivers/power/pmic/ \\\n    drivers/power/battery/ \\\n    drivers/power/regulator/\nlibs-y += drivers/spi/\nlibs-$(CONFIG_FMAN_ENET) += drivers/net/fm/\nlibs-$(CONFIG_SYS_FSL_DDR) += drivers/ddr/fsl/\nlibs-$(CONFIG_SYS_FSL_MMDC) += drivers/ddr/fsl/\nlibs-$(CONFIG_ALTERA_SDRAM) += drivers/ddr/altera/\nlibs-y += drivers/serial/\nlibs-y += drivers/usb/cdns3/\nlibs-y += drivers/usb/dwc3/\nlibs-y += drivers/usb/common/\nlibs-y += drivers/usb/emul/\nlibs-y += drivers/usb/eth/\nlibs-y += drivers/usb/gadget/\nlibs-y += drivers/usb/gadget/udc/\nlibs-y += drivers/usb/host/\nlibs-y += drivers/usb/musb/\nlibs-y += drivers/usb/musb-new/\nlibs-y += drivers/usb/phy/\nlibs-y += drivers/usb/ulpi/\nlibs-y += cmd/\nlibs-y += common/\nlibs-y += env/\nlibs-$(CONFIG_API) += api/\nlibs-$(CONFIG_HAS_POST) += post/\nlibs-y += test/\nlibs-y += test/dm/\nlibs-$(CONFIG_UT_ENV) += test/env/\nlibs-$(CONFIG_UT_OVERLAY) += test/overlay/\n\nlibs-y += $(if $(BOARDDIR),board/$(BOARDDIR)/)\n\nlibs-y := $(sort $(libs-y))\n\nu-boot-dirs := $(patsubst %/,%,$(filter %/, $(libs-y))) tools examples\n\nu-boot-alldirs  := $(sort $(u-boot-dirs) $(patsubst %/,%,$(filter %/, $(libs-))))\n\nlibs-y      := $(patsubst %/, %/built-in.o, $(libs-y))\n\nu-boot-init := $(head-y)\nu-boot-main := $(libs-y)\n\n\n# Add GCC lib\nifeq ($(CONFIG_USE_PRIVATE_LIBGCC),y)\nPLATFORM_LIBGCC = arch/$(ARCH)/lib/lib.a\nelse\nPLATFORM_LIBGCC := -L $(shell dirname `$(CC) $(c_flags) -print-libgcc-file-name`) -lgcc\nendif\nPLATFORM_LIBS += $(PLATFORM_LIBGCC)\nexport PLATFORM_LIBS\nexport PLATFORM_LIBGCC\n\n# Special flags for CPP when processing the linker script.\n# Pass the version down so we can handle backwards compatibility\n# on the fly.\nLDPPFLAGS += \\\n    -include $(srctree)/include/u-boot/u-boot.lds.h \\\n    -DCPUDIR=$(CPUDIR) \\\n    $(shell $(LD) --version | \\\n      sed -ne 's/GNU ld version \\([0-9][0-9]*\\)\\.\\([0-9][0-9]*\\).*/-DLD_MAJOR=\\1 -DLD_MINOR=\\2/p')\n\n\ncmd_mkimage = $(objtree)/tools/mkimage $(MKIMAGEFLAGS_$(@F)) -d $&lt; $@ \\\n    $(if $(KBUILD_VERBOSE:1=), &gt;$(MKIMAGEOUTPUT))\n\nquiet_cmd_mkfitimage = MKIMAGE $@\ncmd_mkfitimage = $(objtree)/tools/mkimage $(MKIMAGEFLAGS_$(@F)) -f $(U_BOOT_ITS) -E $@ \\\n    $(if $(KBUILD_VERBOSE:1=), &gt;$(MKIMAGEOUTPUT))\n\nquiet_cmd_cat = CAT     $@\ncmd_cat = cat $(filter-out $(PHONY), $^) &gt; $@\n\nappend = cat $(filter-out $&lt; $(PHONY), $^) &gt;&gt; $@\n\nquiet_cmd_pad_cat = CAT     $@\ncmd_pad_cat = $(cmd_objcopy) &amp;&amp; $(append) || rm -f $@\n\ncfg: u-boot.cfg\n\nquiet_cmd_cfgcheck = CFGCHK  $2\ncmd_cfgcheck = $(srctree)/scripts/check-config.sh $2 \\\n        $(srctree)/scripts/config_whitelist.txt $(srctree)\n\nPHONY += dtbs\ndtbs: dts/dt.dtb\n    @:\ndts/dt.dtb: u-boot\n    $(Q)$(MAKE) $(build)=dts dtbs\n\nquiet_cmd_copy = COPY    $@\n      cmd_copy = cp $&lt; $@\n\nifeq ($(CONFIG_MULTI_DTB_FIT),y)\n\nfit-dtb.blob: dts/dt.dtb FORCE\n    $(call if_changed,mkimage)\n\nMKIMAGEFLAGS_fit-dtb.blob = -f auto -A $(ARCH) -T firmware -C none -O u-boot \\\n    -a 0 -e 0 -E \\\n    $(patsubst %,-b arch/$(ARCH)/dts/%.dtb,$(subst \",,$(CONFIG_OF_LIST))) -d /dev/null\n\nu-boot-fit-dtb.bin: u-boot-nodtb.bin fit-dtb.blob\n    $(call if_changed,cat)\n\nu-boot.bin: u-boot-fit-dtb.bin FORCE\n    $(call if_changed,copy)\nelse ifeq ($(CONFIG_OF_SEPARATE),y)\nu-boot-dtb.bin: u-boot-nodtb.bin dts/dt.dtb FORCE\n    $(call if_changed,cat)\n\nu-boot.bin: u-boot-dtb.bin FORCE\n    $(call if_changed,copy)\nelse\nu-boot.bin: u-boot-nodtb.bin FORCE\n    $(call if_changed,copy)\nendif\n\n%.imx: %.bin\n    $(Q)$(MAKE) $(build)=arch/arm/mach-imx $@\n\n%.vyb: %.imx\n    $(Q)$(MAKE) $(build)=arch/arm/cpu/armv7/vf610 $@\n\nquiet_cmd_copy = COPY    $@\n      cmd_copy = cp $&lt; $@\n\nu-boot.dtb: dts/dt.dtb\n    $(call cmd,copy)\n\nOBJCOPYFLAGS_u-boot.hex := -O ihex\n\nOBJCOPYFLAGS_u-boot.srec := -O srec\n\nu-boot.hex u-boot.srec: u-boot FORCE\n    $(call if_changed,objcopy)\n\nOBJCOPYFLAGS_u-boot-elf.srec := $(OBJCOPYFLAGS_u-boot.srec)\n\nu-boot-elf.srec: u-boot.elf FORCE\n    $(call if_changed,objcopy)\n\nOBJCOPYFLAGS_u-boot-spl.srec = $(OBJCOPYFLAGS_u-boot.srec)\n\nspl/u-boot-spl.srec: spl/u-boot-spl FORCE\n    $(call if_changed,objcopy)\n\nOBJCOPYFLAGS_u-boot-nodtb.bin := -O binary \\\n        $(if $(CONFIG_X86_16BIT_INIT),-R .start16 -R .resetvec)\n\n\nu-boot-nodtb.bin: u-boot FORCE\n    $(call if_changed,objcopy)\n    $(call DO_STATIC_RELA,$&lt;,$@,$(CONFIG_SYS_TEXT_BASE))\n    $(BOARD_SIZE_CHECK)\n\nu-boot.ldr: u-boot\n        $(CREATE_LDR_ENV)\n        $(LDR) -T $(CONFIG_CPU) -c $@ $&lt; $(LDR_FLAGS)\n        $(BOARD_SIZE_CHECK)\n\n# binman\n# ---------------------------------------------------------------------\nquiet_cmd_binman = BINMAN  $@\ncmd_binman = $(srctree)/tools/binman/binman -d u-boot.dtb -O . \\\n        -I . -I $(srctree)/board/$(BOARDDIR) $&lt;\n\nOBJCOPYFLAGS_u-boot.ldr.hex := -I binary -O ihex\n\nOBJCOPYFLAGS_u-boot.ldr.srec := -I binary -O srec\n\nu-boot.ldr.hex u-boot.ldr.srec: u-boot.ldr FORCE\n    $(call if_changed,objcopy)\n\n#\n# U-Boot entry point, needed for booting of full-blown U-Boot\n# from the SPL U-Boot version.\n#\nifndef CONFIG_SYS_UBOOT_START\nCONFIG_SYS_UBOOT_START := 0\nendif\n\n# Create a file containing the configuration options the image was built with\nquiet_cmd_cpp_cfg = CFG     $@\ncmd_cpp_cfg = $(CPP) -Wp,-MD,$(depfile) $(cpp_flags) $(LDPPFLAGS) -ansi \\\n    -DDO_DEPS_ONLY -D__ASSEMBLY__ -x assembler-with-cpp -P -dM -E -o $@ $&lt;\n\nMKIMAGEFLAGS_u-boot-dtb.img = $(MKIMAGEFLAGS_u-boot.img)\n\nMKIMAGEFLAGS_u-boot.kwb = -n $(srctree)/$(CONFIG_SYS_KWD_CONFIG:\"%\"=%) \\\n    -T kwbimage -a $(CONFIG_SYS_TEXT_BASE) -e $(CONFIG_SYS_TEXT_BASE)\n\nMKIMAGEFLAGS_u-boot-spl.kwb = -n $(srctree)/$(CONFIG_SYS_KWD_CONFIG:\"%\"=%) \\\n    -T kwbimage -a $(CONFIG_SYS_TEXT_BASE) -e $(CONFIG_SYS_TEXT_BASE) \\\n    $(if $(KEYDIR),-k $(KEYDIR))\n\nMKIMAGEFLAGS_u-boot.pbl = -n $(srctree)/$(CONFIG_SYS_FSL_PBL_RCW:\"%\"=%) \\\n        -R $(srctree)/$(CONFIG_SYS_FSL_PBL_PBI:\"%\"=%) -T pblimage\n\nu-boot-dtb.img u-boot.img u-boot.kwb u-boot.pbl u-boot-ivt.img: \\\n        $(if $(CONFIG_SPL_LOAD_FIT),u-boot-nodtb.bin dts/dt.dtb,u-boot.bin) FORCE\n    $(call if_changed,mkimage)\n\nu-boot.itb: u-boot-nodtb.bin dts/dt.dtb $(U_BOOT_ITS) FORCE\n    $(call if_changed,mkfitimage)\n    $(BOARD_SIZE_CHECK)\n\nu-boot-spl.kwb: u-boot.img spl/u-boot-spl.bin FORCE\n    $(call if_changed,mkimage)\n\nu-boot.sha1:    u-boot.bin\n        tools/ubsha1 u-boot.bin\n\nu-boot.dis: u-boot\n        $(OBJDUMP) -d $&lt; &gt; $@\n\nifdef CONFIG_TPL\nSPL_PAYLOAD := tpl/u-boot-with-tpl.bin\nelse\nSPL_PAYLOAD := u-boot.bin\nendif\n\nOBJCOPYFLAGS_u-boot-with-spl.bin = -I binary -O binary \\\n                   --pad-to=$(CONFIG_SPL_PAD_TO)\nu-boot-with-spl.bin: spl/u-boot-spl.bin $(SPL_PAYLOAD) FORCE\n    $(call if_changed,pad_cat)\n\nMKIMAGEFLAGS_lpc32xx-spl.img = -T lpc32xximage -a $(CONFIG_SPL_TEXT_BASE)\n\nlpc32xx-spl.img: spl/u-boot-spl.bin FORCE\n    $(call if_changed,mkimage)\n\nOBJCOPYFLAGS_lpc32xx-boot-0.bin = -I binary -O binary --pad-to=$(CONFIG_SPL_PAD_TO)\n\nlpc32xx-boot-0.bin: lpc32xx-spl.img FORCE\n    $(call if_changed,objcopy)\n\nOBJCOPYFLAGS_lpc32xx-boot-1.bin = -I binary -O binary --pad-to=$(CONFIG_SPL_PAD_TO)\n\nlpc32xx-boot-1.bin: lpc32xx-spl.img FORCE\n    $(call if_changed,objcopy)\n\nlpc32xx-full.bin: lpc32xx-boot-0.bin lpc32xx-boot-1.bin u-boot.img FORCE\n    $(call if_changed,cat)\n\nCLEAN_FILES += lpc32xx-*\n\nOBJCOPYFLAGS_u-boot-with-tpl.bin = -I binary -O binary \\\n                   --pad-to=$(CONFIG_TPL_PAD_TO)\ntpl/u-boot-with-tpl.bin: tpl/u-boot-tpl.bin u-boot.bin FORCE\n    $(call if_changed,pad_cat)\n\nSPL: spl/u-boot-spl.bin FORCE\n    $(Q)$(MAKE) $(build)=arch/arm/mach-imx $@\n\nu-boot-with-spl.imx u-boot-with-nand-spl.imx: SPL u-boot.bin FORCE\n    $(Q)$(MAKE) $(build)=arch/arm/mach-imx $@\n\nMKIMAGEFLAGS_u-boot.ubl = -n $(UBL_CONFIG) -T ublimage -e $(CONFIG_SYS_TEXT_BASE)\n\nu-boot.ubl: u-boot-with-spl.bin FORCE\n    $(call if_changed,mkimage)\n\nMKIMAGEFLAGS_u-boot-spl.ais = -s -n $(if $(CONFIG_AIS_CONFIG_FILE), \\\n    $(srctree)/$(CONFIG_AIS_CONFIG_FILE:\"%\"=%),\"/dev/null\") \\\n    -T aisimage -e $(CONFIG_SPL_TEXT_BASE)\nspl/u-boot-spl.ais: spl/u-boot-spl.bin FORCE\n    $(call if_changed,mkimage)\n\nOBJCOPYFLAGS_u-boot.ais = -I binary -O binary --pad-to=$(CONFIG_SPL_PAD_TO)\nu-boot.ais: spl/u-boot-spl.ais u-boot.img FORCE\n    $(call if_changed,pad_cat)\n\nu-boot-signed.sb: u-boot.bin spl/u-boot-spl.bin\n    $(Q)$(MAKE) $(build)=arch/arm/cpu/arm926ejs/mxs u-boot-signed.sb\nu-boot.sb: u-boot.bin spl/u-boot-spl.bin\n    $(Q)$(MAKE) $(build)=arch/arm/cpu/arm926ejs/mxs u-boot.sb\n\n# On x600 (SPEAr600) U-Boot is appended to U-Boot SPL.\n# Both images are created using mkimage (crc etc), so that the ROM\n# bootloader can check its integrity. Padding needs to be done to the\n# SPL image (with mkimage header) and not the binary. Otherwise the resulting image\n# which is loaded/copied by the ROM bootloader to SRAM doesn't fit.\n# The resulting image containing both U-Boot images is called u-boot.spr\nMKIMAGEFLAGS_u-boot-spl.img = -A $(ARCH) -T firmware -C none \\\n    -a $(CONFIG_SPL_TEXT_BASE) -e $(CONFIG_SPL_TEXT_BASE) -n XLOADER\nspl/u-boot-spl.img: spl/u-boot-spl.bin FORCE\n    $(call if_changed,mkimage)\n\nOBJCOPYFLAGS_u-boot.spr = -I binary -O binary --pad-to=$(CONFIG_SPL_PAD_TO) \\\n              --gap-fill=0xff\nu-boot.spr: spl/u-boot-spl.img u-boot.img FORCE\n    $(call if_changed,pad_cat)\n\nifneq ($(CONFIG_ARCH_SOCFPGA),)\nquiet_cmd_socboot = SOCBOOT $@\ncmd_socboot = cat   spl/u-boot-spl.sfp spl/u-boot-spl.sfp   \\\n            spl/u-boot-spl.sfp spl/u-boot-spl.sfp   \\\n            u-boot.img &gt; $@ || rm -f $@\nu-boot-with-spl.sfp: spl/u-boot-spl.sfp u-boot.img FORCE\n    $(call if_changed,socboot)\nendif\n\n# x86 uses a large ROM. We fill it with 0xff, put the 16-bit stuff (including\n# reset vector) at the top, Intel ME descriptor at the bottom, and U-Boot in\n# the middle. This is handled by binman based on an image description in the\n# board's device tree.\nifneq ($(CONFIG_X86_RESET_VECTOR),)\nrom: u-boot.rom FORCE\n\nrefcode.bin: $(srctree)/board/$(BOARDDIR)/refcode.bin FORCE\n    $(call if_changed,copy)\n\nquiet_cmd_ldr = LD      $@\ncmd_ldr = $(LD) $(LDFLAGS_$(@F)) \\\n           $(filter-out FORCE,$^) -o $@\n\nu-boot.rom: u-boot-x86-16bit.bin u-boot.bin \\\n        $(if $(CONFIG_SPL_X86_16BIT_INIT),spl/u-boot-spl.bin) \\\n        $(if $(CONFIG_HAVE_REFCODE),refcode.bin) FORCE\n    $(call if_changed,binman)\n\nOBJCOPYFLAGS_u-boot-x86-16bit.bin := -O binary -j .start16 -j .resetvec\nu-boot-x86-16bit.bin: u-boot FORCE\n    $(call if_changed,objcopy)\nendif\n\nifneq ($(CONFIG_ARCH_SUNXI),)\nu-boot-sunxi-with-spl.bin: spl/sunxi-spl.bin u-boot.img u-boot.dtb FORCE\n    $(call if_changed,binman)\nendif\n\nifneq ($(CONFIG_TEGRA),)\nifneq ($(CONFIG_BINMAN),)\nu-boot-dtb-tegra.bin u-boot-tegra.bin u-boot-nodtb-tegra.bin: \\\n        spl/u-boot-spl u-boot.bin FORCE\n    $(call if_changed,binman)\nelse\nOBJCOPYFLAGS_u-boot-nodtb-tegra.bin = -O binary --pad-to=$(CONFIG_SYS_TEXT_BASE)\nu-boot-nodtb-tegra.bin: spl/u-boot-spl u-boot-nodtb.bin FORCE\n    $(call if_changed,pad_cat)\n\nOBJCOPYFLAGS_u-boot-tegra.bin = -O binary --pad-to=$(CONFIG_SYS_TEXT_BASE)\nu-boot-tegra.bin: spl/u-boot-spl u-boot.bin FORCE\n    $(call if_changed,pad_cat)\n\nu-boot-dtb-tegra.bin: u-boot-tegra.bin FORCE\n    $(call if_changed,copy)\nendif  # binman\nendif\n\nOBJCOPYFLAGS_u-boot-app.efi := $(OBJCOPYFLAGS_EFI)\nu-boot-app.efi: u-boot FORCE\n    $(call if_changed,zobjcopy)\n\nu-boot.bin.o: u-boot.bin FORCE\n    $(call if_changed,efipayload)\n\nu-boot-payload.lds: $(LDSCRIPT_EFI) FORCE\n    $(call if_changed_dep,cpp_lds)\n\n# Rule to link the EFI payload which contains a stub and a U-Boot binary\nquiet_cmd_u-boot_payload ?= LD      $@\n      cmd_u-boot_payload ?= $(LD) $(LDFLAGS_EFI_PAYLOAD) -o $@ \\\n      -T u-boot-payload.lds arch/x86/cpu/call32.o \\\n      lib/efi/efi.o lib/efi/efi_stub.o u-boot.bin.o \\\n      $(addprefix arch/$(ARCH)/lib/,$(EFISTUB))\n\nu-boot-payload: u-boot.bin.o u-boot-payload.lds FORCE\n    $(call if_changed,u-boot_payload)\n\nOBJCOPYFLAGS_u-boot-payload.efi := $(OBJCOPYFLAGS_EFI)\nu-boot-payload.efi: u-boot-payload FORCE\n    $(call if_changed,zobjcopy)\n\nu-boot-img.bin: spl/u-boot-spl.bin u-boot.img FORCE\n    $(call if_changed,cat)\n\n#Add a target to create boot binary having SPL binary in PBI format\n#concatenated with u-boot binary. It is need by PowerPC SoC having\n#internal SRAM &lt;= 512KB.\nMKIMAGEFLAGS_u-boot-spl.pbl = -n $(srctree)/$(CONFIG_SYS_FSL_PBL_RCW:\"%\"=%) \\\n        -R $(srctree)/$(CONFIG_SYS_FSL_PBL_PBI:\"%\"=%) -T pblimage \\\n        -A $(ARCH) -a $(CONFIG_SPL_TEXT_BASE)\n\nspl/u-boot-spl.pbl: spl/u-boot-spl.bin FORCE\n    $(call if_changed,mkimage)\n\nifeq ($(ARCH),arm)\nUBOOT_BINLOAD := u-boot.img\nelse\nUBOOT_BINLOAD := u-boot.bin\nendif\n\nOBJCOPYFLAGS_u-boot-with-spl-pbl.bin = -I binary -O binary --pad-to=$(CONFIG_SPL_PAD_TO) \\\n              --gap-fill=0xff\n\nu-boot-with-spl-pbl.bin: spl/u-boot-spl.pbl $(UBOOT_BINLOAD) FORCE\n    $(call if_changed,pad_cat)\n\n# PPC4xx needs the SPL at the end of the image, since the reset vector\n# is located at 0xfffffffc. So we can't use the \"u-boot-img.bin\" target\n# and need to introduce a new build target with the full blown U-Boot\n# at the start padded up to the start of the SPL image. And then concat\n# the SPL image to the end.\n\nOBJCOPYFLAGS_u-boot-img-spl-at-end.bin := -I binary -O binary \\\n    --pad-to=$(CONFIG_UBOOT_PAD_TO) --gap-fill=0xff\nu-boot-img-spl-at-end.bin: u-boot.img spl/u-boot-spl.bin FORCE\n    $(call if_changed,pad_cat)\n\n# Create a new ELF from a raw binary file.\nifndef PLATFORM_ELFENTRY\n  PLATFORM_ELFENTRY = \"_start\"\nendif\nquiet_cmd_u-boot-elf ?= LD      $@\n    cmd_u-boot-elf ?= $(LD) u-boot-elf.o -o $@ \\\n    --defsym=$(PLATFORM_ELFENTRY)=$(CONFIG_SYS_TEXT_BASE) \\\n    -Ttext=$(CONFIG_SYS_TEXT_BASE)\nu-boot.elf: u-boot.bin\n    $(Q)$(OBJCOPY) -I binary $(PLATFORM_ELFFLAGS) $&lt; u-boot-elf.o\n    $(call if_changed,u-boot-elf)\n\nARCH_POSTLINK := $(wildcard $(srctree)/arch/$(ARCH)/Makefile.postlink)\n\n# Rule to link u-boot\n# May be overridden by arch/$(ARCH)/config.mk\nquiet_cmd_u-boot__ ?= LD      $@\n      cmd_u-boot__ ?= $(LD) $(LDFLAGS) $(LDFLAGS_u-boot) -o $@ \\\n      -T u-boot.lds $(u-boot-init)                             \\\n      --start-group $(u-boot-main) --end-group                 \\\n      $(PLATFORM_LIBS) -Map u-boot.map;                        \\\n      $(if $(ARCH_POSTLINK), $(MAKE) -f $(ARCH_POSTLINK) $@, true)\n\nquiet_cmd_smap = GEN     common/system_map.o\ncmd_smap = \\\n    smap=`$(call SYSTEM_MAP,u-boot) | \\\n        awk '$$2 ~ /[tTwW]/ {printf $$1 $$3 \"\\\\\\\\000\"}'` ; \\\n    $(CC) $(c_flags) -DSYSTEM_MAP=\"\\\"$${smap}\\\"\" \\\n        -c $(srctree)/common/system_map.c -o common/system_map.o\n\nu-boot: $(u-boot-init) $(u-boot-main) u-boot.lds FORCE\n    +$(call if_changed,u-boot__)\nifeq ($(CONFIG_KALLSYMS),y)\n    $(call cmd,smap)\n    $(call cmd,u-boot__) common/system_map.o\nendif\n\nifeq ($(CONFIG_RISCV),y)\n    @tools/prelink-riscv $@ 0\nendif\n\nquiet_cmd_sym ?= SYM     $@\n      cmd_sym ?= $(OBJDUMP) -t $&lt; &gt; $@\nu-boot.sym: u-boot FORCE\n    $(call if_changed,sym)\n\n# The actual objects are generated when descending,\n# make sure no implicit rule kicks in\n$(sort $(u-boot-init) $(u-boot-main)): $(u-boot-dirs) ;\n\n# Handle descending into subdirectories listed in $(vmlinux-dirs)\n# Preset locale variables to speed up the build process. Limit locale\n# tweaks to this spot to avoid wrong language settings when running\n# make menuconfig etc.\n# Error messages still appears in the original language\n\nPHONY += $(u-boot-dirs)\n$(u-boot-dirs): prepare scripts\n    $(Q)$(MAKE) $(build)=$@\n\ntools: prepare\n# The \"tools\" are needed early\n$(filter-out tools, $(u-boot-dirs)): tools\n# The \"examples\" conditionally depend on U-Boot (say, when USE_PRIVATE_LIBGCC\n# is \"yes\"), so compile examples after U-Boot is compiled.\nexamples: $(filter-out examples, $(u-boot-dirs))\n\ndefine filechk_uboot.release\n    echo \"$(UBOOTVERSION)$$($(CONFIG_SHELL) $(srctree)/scripts/setlocalversion $(srctree))\"\nendef\n\n# Store (new) UBOOTRELEASE string in include/config/uboot.release\ninclude/config/uboot.release: include/config/auto.conf FORCE\n    $(call filechk,uboot.release)\n\n\n# Things we need to do before we recursively start building the kernel\n# or the modules are listed in \"prepare\".\n# A multi level approach is used. prepareN is processed before prepareN-1.\n# archprepare is used in arch Makefiles and when processed asm symlink,\n# version.h and scripts_basic is processed / created.\n\n# Listed in dependency order\nPHONY += prepare archprepare prepare0 prepare1 prepare2 prepare3\n\n# prepare3 is used to check if we are building in a separate output directory,\n# and if so do:\n# 1) Check that make has not been executed in the kernel src $(srctree)\nprepare3: include/config/uboot.release\nifneq ($(KBUILD_SRC),)\n    @$(kecho) '  Using $(srctree) as source for U-Boot'\n    $(Q)if [ -f $(srctree)/.config -o -d $(srctree)/include/config ]; then \\\n        echo &gt;&amp;2 \"  $(srctree) is not clean, please run 'make mrproper'\"; \\\n        echo &gt;&amp;2 \"  in the '$(srctree)' directory.\";\\\n        /bin/false; \\\n    fi;\nendif\n\n# prepare2 creates a makefile if using a separate output directory\nprepare2: prepare3 outputmakefile\n\nprepare1: prepare2 $(version_h) $(timestamp_h) \\\n                   include/config/auto.conf\nifeq ($(wildcard $(LDSCRIPT)),)\n    @echo &gt;&amp;2 \"  Could not find linker script.\"\n    @/bin/false\nendif\n\narchprepare: prepare1 scripts_basic\n\nprepare0: archprepare FORCE\n    $(Q)$(MAKE) $(build)=.\n\n# All the preparing..\nprepare: prepare0\n\n# --------------------------------------------------------------------\nquiet_cmd_cpp_lds = LDS     $@\ncmd_cpp_lds = $(CPP) -Wp,-MD,$(depfile) $(cpp_flags) $(LDPPFLAGS) \\\n        -D__ASSEMBLY__ -x assembler-with-cpp -P -o $@ $&lt;\n\nu-boot.lds: $(LDSCRIPT) prepare FORCE\n    $(call if_changed_dep,cpp_lds)\n\nspl/u-boot-spl.bin: spl/u-boot-spl\n    @:\nspl/u-boot-spl: tools prepare \\\n        $(if $(CONFIG_OF_SEPARATE)$(CONFIG_OF_EMBED)$(CONFIG_SPL_OF_PLATDATA),dts/dt.dtb) \\\n        $(if $(CONFIG_OF_SEPARATE)$(CONFIG_OF_EMBED)$(CONFIG_TPL_OF_PLATDATA),dts/dt.dtb)\n    $(Q)$(MAKE) obj=spl -f $(srctree)/scripts/Makefile.spl all\n\nspl/sunxi-spl.bin: spl/u-boot-spl\n    @:\n\nspl/sunxi-spl-with-ecc.bin: spl/sunxi-spl.bin\n    @:\n\nspl/u-boot-spl.sfp: spl/u-boot-spl\n    @:\n\nspl/boot.bin: spl/u-boot-spl\n    @:\n\ntpl/u-boot-tpl.bin: tools prepare \\\n        $(if $(CONFIG_OF_SEPARATE)$(CONFIG_OF_EMBED)$(CONFIG_SPL_OF_PLATDATA),dts/dt.dtb)\n    $(Q)$(MAKE) obj=tpl -f $(srctree)/scripts/Makefile.spl all\n\nTAG_SUBDIRS := $(patsubst %,$(srctree)/%,$(u-boot-dirs) include)\n\nFIND := find\nFINDFLAGS := -L\n\ntags ctags:\n        ctags -w -o ctags `$(FIND) $(FINDFLAGS) $(TAG_SUBDIRS) \\\n                        -name '*.[chS]' -print`\n        ln -s ctags tags\n\netags:\n        etags -a -o etags `$(FIND) $(FINDFLAGS) $(TAG_SUBDIRS) \\\n                        -name '*.[chS]' -print`\ncscope:\n        $(FIND) $(FINDFLAGS) $(TAG_SUBDIRS) -name '*.[chS]' -print &gt; \\\n                        cscope.files\n        cscope -b -q -k\n\nSYSTEM_MAP = \\\n        $(NM) $1 | \\\n        grep -v '\\(compiled\\)\\|\\(\\.o$$\\)\\|\\( [aUw] \\)\\|\\(\\.\\.ng$$\\)\\|\\(LASH[RL]DI\\)' | \\\n        LC_ALL=C sort\nSystem.map: u-boot\n        @$(call SYSTEM_MAP,$&lt;) &gt; $@\n\n# Documentation targets\n# ---------------------------------------------------------------------------\n%docs: scripts_basic FORCE\n    $(Q)$(MAKE) $(build)=scripts build_docproc\n    $(Q)$(MAKE) $(build)=doc/DocBook $@\n\nendif #ifeq ($(config-targets),1)\nendif #ifeq ($(mixed-targets),1)\n\nPHONY += checkstack ubootrelease ubootversion\n\ncheckstack:\n    $(OBJDUMP) -d u-boot $$(find . -name u-boot-spl) | \\\n    $(PERL) $(src)/scripts/checkstack.pl $(ARCH)\n\nubootrelease:\n    @echo \"$(UBOOTVERSION)$$($(CONFIG_SHELL) $(srctree)/scripts/setlocalversion $(srctree))\"\n\nubootversion:\n    @echo $(UBOOTVERSION)\n\n# Single targets\n# --------------------------------------------------------------------\n# Single targets are compatible with:\n# - build with mixed source and output\n# - build with separate output dir 'make O=...'\n# - external modules\n#\n#  target-dir =&gt; where to store outputfile\n#  build-dir  =&gt; directory in kernel source tree to use\n\nifeq ($(KBUILD_EXTMOD),)\n        build-dir  = $(patsubst %/,%,$(dir $@))\n        target-dir = $(dir $@)\nelse\n        zap-slash=$(filter-out .,$(patsubst %/,%,$(dir $@)))\n        build-dir  = $(KBUILD_EXTMOD)$(if $(zap-slash),/$(zap-slash))\n        target-dir = $(if $(KBUILD_EXTMOD),$(dir $&lt;),$(dir $@))\nendif\n\n%.s: %.c prepare scripts FORCE\n    $(Q)$(MAKE) $(build)=$(build-dir) $(target-dir)$(notdir $@)\n%.i: %.c prepare scripts FORCE\n    $(Q)$(MAKE) $(build)=$(build-dir) $(target-dir)$(notdir $@)\n%.o: %.c prepare scripts FORCE\n    $(Q)$(MAKE) $(build)=$(build-dir) $(target-dir)$(notdir $@)\n%.lst: %.c prepare scripts FORCE\n    $(Q)$(MAKE) $(build)=$(build-dir) $(target-dir)$(notdir $@)\n%.s: %.S prepare scripts FORCE\n    $(Q)$(MAKE) $(build)=$(build-dir) $(target-dir)$(notdir $@)\n%.o: %.S prepare scripts FORCE\n    $(Q)$(MAKE) $(build)=$(build-dir) $(target-dir)$(notdir $@)\n%.symtypes: %.c prepare scripts FORCE\n    $(Q)$(MAKE) $(build)=$(build-dir) $(target-dir)$(notdir $@)\n</code></pre>\n"}, {"tags": ["c", "function"], "answers": [{"tags": [], "owner": {"reputation": 46708, "user_id": 179715, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e240f1a5bb197450dfb8934dd55d9e3a?s=128&d=identicon&r=PG", "display_name": "jamesdlin", "link": "https://stackoverflow.com/users/179715/jamesdlin"}, "is_accepted": false, "score": 1, "last_activity_date": 1559699924, "creation_date": 1559699924, "answer_id": 56453399, "question_id": 56453379, "link": "https://stackoverflow.com/questions/56453379/nested-functions-in-c/56453399#56453399", "title": "Nested Functions in C", "body": "<p><a href=\"https://gcc.gnu.org/onlinedocs/gcc/Nested-Functions.html\" rel=\"nofollow noreferrer\">GNU C supports nested functions as an extension</a>.  Your <code>cc</code> binary on your Linux machine is almost certainly a symlink to <code>gcc</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 354, "user_id": 8211365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d3d79ec69696aca6939ed5cbba2ac6b?s=128&d=identicon&r=PG&f=1", "display_name": "tejasvi88", "link": "https://stackoverflow.com/users/8211365/tejasvi88"}, "edited": false, "score": 0, "creation_date": 1559700117, "post_id": 56453404, "comment_id": 99499615, "body": "Dupe of <a href=\"https://stackoverflow.com/questions/2608158/nested-function-in-c\">Nested function in C</a>"}], "tags": [], "owner": {"reputation": 354, "user_id": 8211365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d3d79ec69696aca6939ed5cbba2ac6b?s=128&d=identicon&r=PG&f=1", "display_name": "tejasvi88", "link": "https://stackoverflow.com/users/8211365/tejasvi88"}, "is_accepted": false, "score": 1, "last_activity_date": 1559699995, "creation_date": 1559699995, "answer_id": 56453404, "question_id": 56453379, "link": "https://stackoverflow.com/questions/56453379/nested-functions-in-c/56453404#56453404", "title": "Nested Functions in C", "body": "<p>Nested functions don't exist in standard C. However, it might be supported as an extension in certain compilers like <a href=\"http://gcc.gnu.org/onlinedocs/gcc/Nested-Functions.html\" rel=\"nofollow noreferrer\">GNU</a>.</p>\n"}], "owner": {"reputation": 46, "user_id": 9472191, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-g7mdvDBNDMU/AAAAAAAAAAI/AAAAAAAAABI/N1NYEyTx7i0/photo.jpg?sz=128", "display_name": "Purusharth Verma", "link": "https://stackoverflow.com/users/9472191/purusharth-verma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "closed_date": 1559700533, "answer_count": 2, "score": 0, "last_activity_date": 1559699995, "creation_date": 1559699735, "question_id": 56453379, "link": "https://stackoverflow.com/questions/56453379/nested-functions-in-c", "closed_reason": "Duplicate", "title": "Nested Functions in C", "body": "<p>I read that nested function don't exist in C.\nI then successfully executed the following piece of code using the cc command on my linux machine.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main(){\n    float dummy(){\n        printf(\"hello\\n\");\n    }\n    dummy();\n    return 0;\n}\n</code></pre>\n\n<p>I got the the output <code>hello</code>.</p>\n\n<p>How does that play out?\nDoes my compiler support nested functions?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 3, "creation_date": 1559699570, "post_id": 56453356, "comment_id": 99499520, "body": "<code>float</code> gives only 7 decimal digits of precision. Use <code>double</code>."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1559699879, "post_id": 56453356, "comment_id": 99499578, "body": "It would improve the question to include a minimal, reproducible example -- someone can run it without editing and see the unexpected output"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1559700029, "post_id": 56453356, "comment_id": 99499597, "body": "@AnttiHaapala specifically, the line <code>float ratio, det;</code> should have <code>double</code> instead"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1559700936, "post_id": 56453356, "comment_id": 99499759, "body": "I say this is <b>not</b> the usual FP precision issue.  Had <code>double</code> been used the amount &quot;off&quot; would still exist, just about 10^-10 smaller.  The real issue here is how to do matrix math to get a better determinant,  Research partial and full <i>pivoting</i>."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1559700939, "post_id": 56453356, "comment_id": 99499760, "body": "@M.M well, yes, but all in all <i>everything</i> should use <code>double</code> if you&#39;re concerned with more than 8 digits. @chux: it might be but considering that the first question was why the error in the 8th digit and the variable was float, the answer is &quot;that should be more than expected&quot;"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1559701275, "post_id": 56453356, "comment_id": 99499809, "body": "@chux OP described the current error as &quot;tiny amount&quot; so perhaps they are happy with an error 10 orders of magnitude smaller...  IMO improving that even further by changing the algorithm to best suit the properties of computer floating point is a different topic and perhaps best suited to <a href=\"https://scicomp.stackexchange.com/\">scicomp.stackexchange.com</a>"}, {"owner": {"reputation": 29, "user_id": 11450458, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-xacb_DPgLO0/AAAAAAAAAAI/AAAAAAAAADw/uDhdDJ_Rwqw/photo.jpg?sz=128", "display_name": "somelube", "link": "https://stackoverflow.com/users/11450458/somelube"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1559702365, "post_id": 56453356, "comment_id": 99499969, "body": "@M.M thank you, changing it from float to double made it slightly more precise but not as much as I would hope. Im trying to get it so it prints 6125131.30 for the example matrix. I will try to provide a reproducible example of my code"}], "owner": {"reputation": 29, "user_id": 11450458, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-xacb_DPgLO0/AAAAAAAAAAI/AAAAAAAAADw/uDhdDJ_Rwqw/photo.jpg?sz=128", "display_name": "somelube", "link": "https://stackoverflow.com/users/11450458/somelube"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "closed_date": 1559699615, "answer_count": 0, "score": 0, "last_activity_date": 1559699785, "creation_date": 1559699496, "question_id": 56453356, "link": "https://stackoverflow.com/questions/56453356/determinant-of-a-matrix-function-giving-me-slightly-wrong-numbers", "closed_reason": "Duplicate", "title": "Determinant of a matrix function giving me slightly wrong numbers", "body": "<p>I wrote this program that reads in values from a file where the first two are the dimensions of the matrix, and the rest are the values. I then make the values into a matrix and calculate the determinant.</p>\n\n<p>matrix.c</p>\n\n<pre><code>void matrix(FILE *fp) {\n    float fval[102];\n    int n, i;\n\n    //scan floats into fval\n    if (fp != NULL) {\n        fputs(\"0.000   1.800   3.240   4.374   5.249   5.905   6.377   7.696 \", fp);\n        rewind(fp);\n\n        n = 0;\n        while (fscanf(fp, \"%f\", &amp;fval[n++]) != EOF);\n\n\n    }\n    //The first two values in the file are the NXN dimensions, so\n    //take every value after that into new array\n    double matrix[n];\n    //I find that I have to convert the array to doubles otherwise\n    //the matrix will have a bunch of random numbers\n    for(i = 2;i&lt;n;i++){\n    matrix[i-2]=fval[i];}\n\n    Matrix* m1 = copy_matrix(matrix,(int)fval[1]); //copies array and makes 2d matrix \n    print_matrix(m1);\n    determinant(m1-&gt;mat,(int)fval[1]);\n}\n\nMatrix* make_matrix(int N) {\n    struct Matrix* matrix = malloc(sizeof(Matrix));\n    matrix-&gt;dim = N;\n    matrix-&gt;dim = N;\n    double** mat = malloc(sizeof(double*) * N);\n    for(int x = 0; x &lt; N; x++){\n        mat[x] = calloc(N, sizeof(double));\n    }\n    matrix-&gt;mat = mat;\n\n    for(int x = 0; x &lt; N; x++) {\n        for(int y = 0; y &lt; N; y++) {\n            matrix-&gt;mat[x][y] = 4;\n        }\n    }\n\n    return matrix;\n}\n\nMatrix* copy_matrix(double* new, int N) {\n    struct Matrix *matrix = make_matrix(N);\n    for(int x = 0; x &lt; N; x++) {\n        for(int y = 0; y &lt; N; y++) {\n            matrix-&gt;mat[x][y] = new[N*x+y];\n        }\n    }\n    return matrix;\n}\ndouble determinant(double **matrix, int n)\n{\n    float ratio, det;\n    int i, j, k;\n    //print\n    /* Conversion of matrix to upper triangular */\n    for(i = 0; i &lt; n; i++){\n        for(j = 0; j &lt; n; j++){\n            if(j&gt;i){\n                ratio = matrix[j][i]/matrix[i][i];\n                for(k = 0; k &lt; n; k++){\n                    matrix[j][k] -= ratio * matrix[i][k];\n                }\n            }\n        }\n    }\n    det = 1; //storage for determinant\n    for(i = 0; i &lt; n; i++)\n        det *= matrix[i][i];\n    printf(\"The determinant is %.2f.\\n\", det);\n\n}\n</code></pre>\n\n<p>My problem is it gives me ALMOST the right answer, but its off by a tiny amount. For example, </p>\n\n<pre><code>-18.26 34.63 44.52 -9.84\n49.84 -43.78 31.26 37.53\n-34.91 20.56 5.89 45.52\n-29.0 4.0 38.25 13.88\n</code></pre>\n\n<p>The determinant of  this 4x4 matrix is 6125131.30. My program gives me 6125131.50. What could the problem be?</p>\n"}, {"tags": ["python", "c++", "c", "configuration", "pci-e"], "comments": [{"owner": {"reputation": 5119, "user_id": 4276647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6a929f6537e73d7cc1ec7b533032350?s=128&d=identicon&r=PG&f=1", "display_name": "Kurtis Rader", "link": "https://stackoverflow.com/users/4276647/kurtis-rader"}, "edited": false, "score": 0, "creation_date": 1559707919, "post_id": 56453339, "comment_id": 99500897, "body": "What does this have to do with Python? Also, since the compiler can&#39;t find the <i>wdm.h</i> header your problem is more fundamental than how to use the APIs defined in that header."}, {"owner": {"reputation": 1, "user_id": 11601799, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Sy1VhCg3Oxg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdGopOeBFR8p882oSOKO9ZWRERk6g/mo/photo.jpg?sz=128", "display_name": "JS Kim", "link": "https://stackoverflow.com/users/11601799/js-kim"}, "reply_to_user": {"reputation": 5119, "user_id": 4276647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6a929f6537e73d7cc1ec7b533032350?s=128&d=identicon&r=PG&f=1", "display_name": "Kurtis Rader", "link": "https://stackoverflow.com/users/4276647/kurtis-rader"}, "edited": false, "score": 0, "creation_date": 1559748677, "post_id": 56453339, "comment_id": 99518823, "body": "The python tag dosen&#39;t have enough explain.Actually I also try to get the data in PCI configuration register by Python. So Is there any proper API made by Python to get PCI configuration register? Or How Can I fix the problem that I explain about window driver develop kit in Visual Studio?"}], "owner": {"reputation": 1, "user_id": 11601799, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Sy1VhCg3Oxg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdGopOeBFR8p882oSOKO9ZWRERk6g/mo/photo.jpg?sz=128", "display_name": "JS Kim", "link": "https://stackoverflow.com/users/11601799/js-kim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 179, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1587363348, "creation_date": 1559699367, "last_edit_date": 1587363348, "question_id": 56453339, "link": "https://stackoverflow.com/questions/56453339/how-can-i-access-or-get-databit-stream-in-pci-configuration-registerspace-in", "title": "How can I access or get data(bit stream) in PCI configuration register(space) in Windows platform", "body": "<p>I need to read data in PCI configuration register. PCI configuraion registers are allocated in memory because PCI architecture is memory mapped I/O. So, I want to read the data in configuration register or space in Windows OS. How can I get this data?</p>\n\n<p>I already installed the Windows Driver developer kit. I followed the guidance in MSDN. But, I failed to load the header file or DDK file in Visual Studio 2019. If the trial that I have done is correct, how can I solve the error \"cannot open source file \"wdm.h\"\"? Or the method that I have tried, what is the method to get PCI configuration register(space) data in Windows OS?\nPlease recommend.</p>\n\n<blockquote>\n  <p>Cannot open source file \"wdm.h\"</p>\n</blockquote>\n\n<p>I installed the Windows Driver Kit following the guidance in MSDN. But the error is still present. Would I add the include file directory to a solution property or a configuration variable to system?</p>\n"}, {"tags": ["c", "openssl", "libcurl"], "comments": [{"owner": {"reputation": 977, "user_id": 3754125, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Zu0zi.png?s=128&g=1", "display_name": "milaniez", "link": "https://stackoverflow.com/users/3754125/milaniez"}, "edited": false, "score": 0, "creation_date": 1559697711, "post_id": 56453108, "comment_id": 99499220, "body": "<code>SSL_CTX_set_tlsext_servername_callback</code> might work. I&#39;ll update if it works."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1559699371, "post_id": 56453108, "comment_id": 99499490, "body": "If it works then please do answer the question yourself :)"}, {"owner": {"reputation": 977, "user_id": 3754125, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Zu0zi.png?s=128&g=1", "display_name": "milaniez", "link": "https://stackoverflow.com/users/3754125/milaniez"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1559950834, "post_id": 56453108, "comment_id": 99593391, "body": "@AnttiHaapala, unfortunately, my solution did not work. It only works for the server but in my case, I am the client."}], "answers": [{"comments": [{"owner": {"reputation": 977, "user_id": 3754125, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Zu0zi.png?s=128&g=1", "display_name": "milaniez", "link": "https://stackoverflow.com/users/3754125/milaniez"}, "edited": false, "score": 0, "creation_date": 1559755710, "post_id": 56455098, "comment_id": 99522184, "body": "How would one precisely do it with <code>CURLOPT_RESOLVE</code> or <code>CURLOPT_CONNECT_TO</code>? I am already using <code>CURLOPT_RESOLVE</code> to resolve FQDN to IPv4."}, {"owner": {"reputation": 977, "user_id": 3754125, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Zu0zi.png?s=128&g=1", "display_name": "milaniez", "link": "https://stackoverflow.com/users/3754125/milaniez"}, "edited": false, "score": 0, "creation_date": 1559772069, "post_id": 56455098, "comment_id": 99528671, "body": "Thanks for including the code in your answer. However, this does not work for me. I am using <code>CURLOPT_RESOLVE</code> to resolve FQDN to IPv4 (looks like <code>curl_slist_append(NULL, &quot;www.example.org:10443:172.18.27.161&quot;)</code>) (I have to do this because I have a specific API to resolve FQDN to IPv4 otherwise curl cannot resolve). The string that I am trying to inject into SNI is actually a token which the server uses to identify how it should dispatch the connection. The token looks like something like this: <code>tYqxjS6ntrqmPtBwUli1</code>. So If I want to fake SNI with <code>CURLOPT_RESOLVE</code> I cannot resolve the fqdn!"}, {"owner": {"reputation": 43751, "user_id": 93747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbf187b5b45c400649ed7f946e8f00d6?s=128&d=identicon&r=PG", "display_name": "Daniel Stenberg", "link": "https://stackoverflow.com/users/93747/daniel-stenberg"}, "reply_to_user": {"reputation": 977, "user_id": 3754125, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Zu0zi.png?s=128&g=1", "display_name": "milaniez", "link": "https://stackoverflow.com/users/3754125/milaniez"}, "edited": false, "score": 0, "creation_date": 1559812590, "post_id": 56455098, "comment_id": 99539298, "body": "Okay, but then you&#39;re not doing HTTPS anymore... nothing wrong in that, but curl is focused on talking the specific protocols we&#39;ve made it support."}, {"owner": {"reputation": 977, "user_id": 3754125, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Zu0zi.png?s=128&g=1", "display_name": "milaniez", "link": "https://stackoverflow.com/users/3754125/milaniez"}, "edited": false, "score": 0, "creation_date": 1559843091, "post_id": 56455098, "comment_id": 99555600, "body": "Actually I am doing https! It is something like <code>curl_easy_setopt(ez_h, CURLOPT_URL, &quot;https:&#47;&#47;www.example.org:10443&#47;api&#47;entry&#47;point&quot;)</code>. Are you implying that I cannot fake SNI in https?"}, {"owner": {"reputation": 977, "user_id": 3754125, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Zu0zi.png?s=128&g=1", "display_name": "milaniez", "link": "https://stackoverflow.com/users/3754125/milaniez"}, "edited": false, "score": 0, "creation_date": 1560273993, "post_id": 56455098, "comment_id": 99679564, "body": "On second thought on this solution, it worked for my case. <code>ipv4=getipv4(fqdn); snprintf(resolve_entry, sizeof(resolve_entry), &quot;%s:%s:%d.%d.%d.%d&quot;, fake_sni, port, IP(ipv4)); resolve_list = curl_slist_add(NULL, resolve_entry);snprintf(url, sizeof(url), &quot;https:&#47;&#47;%s:%s&#47;%s&quot;, fake_sni, port, api_entry_point);</code> The only catch is that I had to set the referer to <code>fqdn</code>."}], "tags": [], "owner": {"reputation": 43751, "user_id": 93747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbf187b5b45c400649ed7f946e8f00d6?s=128&d=identicon&r=PG", "display_name": "Daniel Stenberg", "link": "https://stackoverflow.com/users/93747/daniel-stenberg"}, "is_accepted": true, "score": 1, "last_activity_date": 1559770284, "last_edit_date": 1559770284, "creation_date": 1559715336, "answer_id": 56455098, "question_id": 56453108, "link": "https://stackoverflow.com/questions/56453108/fake-server-name-indication-sni-in-libcurl-with-openssl-backend/56455098#56455098", "title": "fake Server Name indication (SNI) in libcurl with OpenSSL backend", "body": "<p>If you want to \"fake\" the SNI then <code>CURLOPT_RESOLVE</code> or <code>CURLOPT_CONNECT_TO</code> are available options to reach the same end goal.</p>\n\n<h1>CURLOPT_RESOLVE example</h1>\n\n<p>Run a HTTPS server on 127.0.0.1 but make curl think it is <code>example.com</code> when it connects to it (so it sends that as SNI and in the <code>Host:</code> header)</p>\n\n<pre><code>CURL *curl;\nstruct curl_slist *host = NULL;\nhost = curl_slist_append(NULL, \"example.com:443:127.0.0.1\");\n\ncurl = curl_easy_init();\nif(curl) {\n  curl_easy_setopt(curl, CURLOPT_RESOLVE, host);\n  curl_easy_setopt(curl, CURLOPT_URL, \"https://example.com\");\n\n  curl_easy_perform(curl);\n\n  /* always cleanup */\n  curl_easy_cleanup(curl);\n}\n\ncurl_slist_free_all(host);\n</code></pre>\n\n<h1>CURLOPT_CONNECT_TO example</h1>\n\n<p>Run a dev HTTPS server on the host name <code>server1.example.com</code> but you want curl to connect to it thinking it is the <code>www.example.org</code> server.</p>\n\n<pre><code>CURL *curl;\nstruct curl_slist *connect_to = NULL;\nconnect_to = curl_slist_append(NULL, \"www.example.org::server1.example.com:\");\n\ncurl = curl_easy_init();\nif(curl) {\n  curl_easy_setopt(curl, CURLOPT_CONNECT_TO, connect_to);\n  curl_easy_setopt(curl, CURLOPT_URL, \"https://www.example.org\");\n\n  curl_easy_perform(curl);\n\n  /* always cleanup */\n  curl_easy_cleanup(curl);\n}\n\ncurl_slist_free_all(connect_to);\n</code></pre>\n"}], "owner": {"reputation": 977, "user_id": 3754125, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Zu0zi.png?s=128&g=1", "display_name": "milaniez", "link": "https://stackoverflow.com/users/3754125/milaniez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 673, "favorite_count": 0, "accepted_answer_id": 56455098, "answer_count": 1, "score": 1, "last_activity_date": 1559951456, "creation_date": 1559697029, "last_edit_date": 1559951456, "question_id": 56453108, "link": "https://stackoverflow.com/questions/56453108/fake-server-name-indication-sni-in-libcurl-with-openssl-backend", "title": "fake Server Name indication (SNI) in libcurl with OpenSSL backend", "body": "<p>I have libcurl built with OpenSSL backend. I want to set SNI to some specified string. the way that I could find is using the function <code>SSL_set_tlsext_host_name</code> which takes the <code>SSL *</code> instance and a string and then sets it. (see <a href=\"https://stackoverflow.com/a/5113466/3754125\">https://stackoverflow.com/a/5113466/3754125</a>)</p>\n\n<p>However curl_easy does not have a call back to retrieve <code>SSL*</code> instance. Is there an alternate way to do so?</p>\n\n<p>Some more context:\nIn my environment, I have to use <code>CURLOPT_RESOLVE</code> to resolve the FQDN to IPv4.\nThere is the FQDN: <code>const char *fqdn</code>\nIPv4 which <code>fqdn</code> should resolve to: <code>uint32_t ipv4</code>\nfake SNI: <code>const char *sni</code>\nThe gist looks something like:</p>\n\n<pre><code>CURL *ez;\nchar buf[ENOUGH];\nstruct curl_slist *resolver;\n/* ... */\nsnprintf(buf, sizeof(buf), \"%s:%d:%d.%d.%d.%d\", fqdn, port, IP(IPv4));\nresolver = curl_slist_append(NULL, buf);\ncurl_easy_setopt(ez, CURLOPT_RESOLVE, resolver);\n</code></pre>\n\n<p>After this I need to set the SNI to the fake SNI without touching the resolver.</p>\n"}, {"tags": ["c", "memory", "dump", "virtual-address-space", "page-fault"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1559705294, "post_id": 56452872, "comment_id": 99500432, "body": "C doesn&#39;t have SIGSEGV. C has <i>undefined behaviour</i>. You need to specify your platform. Platforms may (or may not) have SIGSEGV."}], "answers": [{"tags": [], "owner": {"reputation": 14421, "user_id": 1888983, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/Y6tnm.png?s=128&g=1", "display_name": "jozxyqk", "link": "https://stackoverflow.com/users/1888983/jozxyqk"}, "is_accepted": false, "score": 2, "last_activity_date": 1559694748, "last_edit_date": 1559694748, "creation_date": 1559694571, "answer_id": 56452873, "question_id": 56452872, "link": "https://stackoverflow.com/questions/56452872/how-can-i-dump-memory-from-an-arbitrary-virtual-address-ignoring-sigsegv/56452873#56452873", "title": "How can I dump memory from an arbitrary virtual address, ignoring SIGSEGV", "body": "<ul>\n<li>Use <code>sigaction</code> to catch signals such as <code>SIGBUS</code> and <code>SIGSEGV</code></li>\n<li>Use <code>siglongjmp</code> to exit the handler safely</li>\n<li>Set <code>SA_NODEFER</code> to be able to catch the signal again</li>\n</ul>\n\n<p>Based on this answer: <a href=\"https://stackoverflow.com/questions/10307739/catching-segmentation-violations-and-getting-on-with-life/10308089#10308089\">Catching Segmentation Violations and Getting on with Life</a></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;signal.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;setjmp.h&gt;\n\nsigjmp_buf badAddressRead;\n\nvoid badAddressReadHandler(int signo) {\n    siglongjmp(badAddressRead, signo);\n}\n\nvoid hexDump(const char *desc, void *addr, int len)\n{\n    int i;\n    unsigned char buff[17];\n    unsigned char *pc = (unsigned char*)addr;\n\n    struct sigaction segvActionOld;\n    struct sigaction busActionOld;\n    struct sigaction readAction = {};\n\n    readAction.sa_handler = badAddressReadHandler;\n    sigemptyset(&amp;readAction.sa_mask);\n    readAction.sa_flags = SA_NODEFER;\n    sigaction(SIGBUS, &amp;readAction, &amp;segvActionOld);\n    sigaction(SIGSEGV, &amp;readAction, &amp;busActionOld);\n\n    // Output description if given.\n    if (desc != NULL)\n        printf(\"%s:\\n\", desc);\n\n    printf(\"address = %p\\n\", addr);\n\n    // Process every byte in the data.\n    for (i = 0; i &lt; len; i++) {\n        // Multiple of 16 means new line (with line offset).\n\n        if ((i % 16) == 0) {\n            // Just don't print ASCII for the zeroth line.\n            if (i != 0)\n                printf(\"  %s\\n\", buff);\n\n            // Output the offset.\n            printf(\"  %04x \", i);\n        }\n\n        // Attempt to read memory that may not be accessible\n        unsigned char byte;\n        int caughtSignal;\n        if ((caughtSignal = sigsetjmp(badAddressRead, 0)) == 0) {\n            // Now the hex code for the specific character.\n            byte = pc[i];\n            printf(\" %02x\", byte);\n        } else {\n            byte = 0;\n            if (caughtSignal == SIGSEGV) {\n                printf(\" SV\");\n            } else if (caughtSignal == SIGBUS) {\n                printf(\" BS\");\n            } else {\n                printf(\" ??\");\n            }\n        }\n\n\n        // And store a printable ASCII character for later.\n        if ((byte &lt; 0x20) || (byte &gt; 0x7e)) {\n            buff[i % 16] = '.';\n        } else {\n            buff[i % 16] = pc[i];\n        }\n\n        buff[(i % 16) + 1] = '\\0';\n    }\n\n    // Pad out last line if not exactly 16 characters.\n    while ((i % 16) != 0) {\n        printf(\"   \");\n        i++;\n    }\n\n    // And print the final ASCII bit.\n    printf(\"  %s\\n\", buff);\n\n    sigaction(SIGBUS, &amp;busActionOld, NULL);\n    sigaction(SIGSEGV, &amp;segvActionOld, NULL);\n}\n\nint main(void) {\n    int test  = 123;\n    hexDump(\"test\", &amp;test, 8000); // dump 'test' and a whole bunch more after it\n    return 0;\n}\n</code></pre>\n\n<p>(hexdump code modified from <a href=\"https://gist.github.com/domnikl/af00cc154e3da1c5d965\" rel=\"nofollow noreferrer\">https://gist.github.com/domnikl/af00cc154e3da1c5d965</a>)</p>\n"}], "owner": {"reputation": 14421, "user_id": 1888983, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/Y6tnm.png?s=128&g=1", "display_name": "jozxyqk", "link": "https://stackoverflow.com/users/1888983/jozxyqk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1559771894, "creation_date": 1559694571, "last_edit_date": 1559771894, "question_id": 56452872, "link": "https://stackoverflow.com/questions/56452872/how-can-i-dump-memory-from-an-arbitrary-virtual-address-ignoring-sigsegv", "title": "How can I dump memory from an arbitrary virtual address, ignoring SIGSEGV", "body": "<p>I'm looking for a way to iterate over memory and print it (or do anything with it really), but if the virtual address hasn't been allocated I'll get a segfault. How can I attempt to read arbitrary addresses in my program and not crash?</p>\n\n<p>This is primarily for debugging so safety/defined behaviour isn't a high priority. For example, I might want to dump the memory a pointer points to and some surrounding values to check for corruption.</p>\n\n<p>Out of interest, is there any reason this cannot be made safe, e.g. side effects of reads?</p>\n\n<p>The actual memory dump is simple, for example the following. This question is really about ignoring the segfault.</p>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/questions/7775991/how-to-get-hexdump-of-a-structure-data\">how to get hexdump of a structure data</a></li>\n<li><a href=\"https://gist.github.com/domnikl/af00cc154e3da1c5d965\" rel=\"nofollow noreferrer\">https://gist.github.com/domnikl/af00cc154e3da1c5d965</a></li>\n</ul>\n\n<p><em>EDIT:</em><br/>\nI'm running ubuntu 18.04</p>\n"}, {"tags": ["c", "conways-game-of-life"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1559686374, "post_id": 56451871, "comment_id": 99497184, "body": "Use two boards: one the the current and one for the next generation. You can then swap them with a simple pointer swap. When looking at neighbours, make sure you don&#39;t go off the edge of the board. One way to do that is to have a dummy border, or edge guard, which takes no part but prevents checking off the edge of the board."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1559686788, "post_id": 56451871, "comment_id": 99497272, "body": "@WeatherVane, they have to use a bunch of existing functions that work with the given representation.  However, that representation appears already to accommodate maintaining the current and next state at the same time -- see the <code>cell</code> type."}], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 8973949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f0e31e664be82ac4d6ab05538c60b46?s=128&d=identicon&r=PG&f=1", "display_name": "Aliasa Zarowny Pseudonymia", "link": "https://stackoverflow.com/users/8973949/aliasa-zarowny-pseudonymia"}, "edited": false, "score": 0, "creation_date": 1559689172, "post_id": 56452025, "comment_id": 99497787, "body": "So if I understand it correctly. Should I inspect each and every neighbouring cell. Store the value for the amount of neighbouring cells.  Write a If-statment. That if the statment meets any of the above conditions, then I should update it accordingly.   I.e  <code>if(numberOfNeighbours == 3 || numberOfNeighbours == 2 ){</code>  <code>field[rows][cols].next = ALIVE </code> <code>}</code>  The hard part would then be to write some loop(I would assume) which checks all cells around 1 cell from our center cell."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 57, "user_id": 8973949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f0e31e664be82ac4d6ab05538c60b46?s=128&d=identicon&r=PG&f=1", "display_name": "Aliasa Zarowny Pseudonymia", "link": "https://stackoverflow.com/users/8973949/aliasa-zarowny-pseudonymia"}, "edited": false, "score": 1, "creation_date": 1559690867, "post_id": 56452025, "comment_id": 99498070, "body": "I am giving you a prod in the right direction, @AliasaZarownyPseudonymia, and it sounds like you have the right idea. But I&#39;m going to let you take it yourself from here.  I&#39;m fine with helping you along, but much further and I&#39;ll be writing your assignment for you."}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 1, "last_activity_date": 1559686596, "creation_date": 1559686596, "answer_id": 56452025, "question_id": 56451871, "link": "https://stackoverflow.com/questions/56451871/how-to-check-the-conditions-for-neighbours/56452025#56452025", "title": "How to check the conditions for neighbours?", "body": "<blockquote>\n  <p>All I have done is to write two nested for-loops which makes sure to check every cell.</p>\n</blockquote>\n\n<p>Well that's a start.</p>\n\n<blockquote>\n  <p>But I am not sure however how to proceed and implement the conditions above. Any ideas on how to check neighbours for each cell?</p>\n</blockquote>\n\n<p>The <code>evolve()</code> function receives the <code>field</code>, apparently describinbg the current state of the board and the next state.  It would appear that the data for a cell with indices <code>i</code>, <code>j</code> would be in <code>field[i][j]</code>.  So the main question is: which cells are the neighbors of that one?  But that shouldn't be hard.  They are the eight cells other than (<code>i</code>, <code>j</code>) each of whose indices differs by at most 1 from <code>i</code> or <code>j</code>, respectively.  That is, (<code>i - 1</code>, <code>j - 1</code>), (<code>i - 1</code>, <code>j</code>), (<code>i - 1</code>, <code>j + 1</code>), (<code>i</code>, <code>j - 1</code>), <em>etc</em>..  Work out an example if you need to do, with actual cell indices, for one cell.</p>\n\n<p>So it seems you would count the live population of all the neighbor cells, and use that in combination with whether the current cell is alive, to determine and record how that cell will evolve.</p>\n\n<p>Do note that the edges and corners are special cases: they do not have neighbors on at least one side, and you must not try to examine the neighbors that do not exist.  You should be able to accomplish that by checking whether the neighbor cell indices are in bounds before trying to access them.</p>\n"}], "owner": {"reputation": 57, "user_id": 8973949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f0e31e664be82ac4d6ab05538c60b46?s=128&d=identicon&r=PG&f=1", "display_name": "Aliasa Zarowny Pseudonymia", "link": "https://stackoverflow.com/users/8973949/aliasa-zarowny-pseudonymia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1559686596, "creation_date": 1559685578, "last_edit_date": 1559686135, "question_id": 56451871, "link": "https://stackoverflow.com/questions/56451871/how-to-check-the-conditions-for-neighbours", "title": "How to check the conditions for neighbours?", "body": "<p>I am stubborn about trying to solve as much as I can myself. However I think that I've reached an impasse. </p>\n\n<p>I have to write code for a simple version for game of life on a 20x20 grid. The conditions are:</p>\n\n<ul>\n<li>A cell which has 0 or 1 living neighbours dies next generation.</li>\n<li>A cell which has 2 or 3 living neighbours lives next generation.</li>\n<li>A cell which has 4 or more living neighbours dies next generation.</li>\n<li>A empty cell which has exactly 3 living neighbours becomes a live\ncell next generation.</li>\n</ul>\n\n<p>My particular problem is how to write the algoritm that performs the above said operations.</p>\n\n<p>I have not tried much since I'm out of ideas. I did hope to get some ideas which might give me a extra push into finishing my function that updates the world/field. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt;\n\n/* Constants, representation of states */\n#define ALIVE 'X'\n#define DEAD '.'\n\n/* Declaration of data structure */\ntypedef struct{\n  char current;\n  char next;\n} cell;\n\n/* Declaration of functions */\nvoid initField(const int rows, const int cols, cell field[rows][cols]);\nvoid loadGlider(const int rows, const int cols, cell field[rows][cols]);\nvoid loadSemaphore(const int rows, const int cols, cell field[rows][cols]);\nvoid loadRandom(const int rows, const int cols, cell field[rows][cols]);\nvoid loadCustom(const int rows, const int cols, cell field[rows][cols]);\nvoid printWorld(const int rows, const int cols, cell field[rows][cols]);\nvoid evolve(const int rows,const int cols,cell field[rows][cols]);\n\n\n/* Function:    main\n* Description: Start and run games, interact with the user.\n* Input:       About what initial structure and whether to step or exit.\n* Output:      Information to the user, and the game field in each step.\n*/\n\nint main(void) {\n\n  const int rows = 20;\n  const int cols = 20;\n  cell field[rows][cols];\n\n  initField(rows,cols, field);\n  printWorld(rows,cols,field);\n\n\n  return 0;\n}\n\n\n/* Function:    initField\n* Description: Initialize all the cells to dead, then asks the user about\n*              which structure to load, and finally load the structure.\n* Input:       The field array and its size.\n* Output:      The field array is updated.\n*/\n\nvoid initField(const int rows, const int cols, cell field[rows][cols]) {\n\n  for (int r = 0 ; r &lt; rows ; r++) {\n    for (int c = 0 ; c &lt; cols ; c++) {\n      field[r][c].current = DEAD;\n    }\n  }\n\n  printf(\"Select field spec to load ([G]lider, [S]emaphore, [R]andom \");\n  printf(\"or [C]ustom): \");\n\n  int ch = getchar();\n\n  /* Ignore following newline */\n  if (ch != '\\n') {\n    getchar();\n  }\n\n  switch (ch) {\n    case 'g':\n    case 'G':\n    loadGlider(rows, cols, field);\n    break;\n    case 's':\n    case 'S':\n    loadSemaphore(rows, cols, field);\n    break;\n    case 'r':\n    case 'R':\n    loadRandom(rows, cols, field);\n    break;\n    case 'c':\n    case 'C':\n    default:\n    loadCustom(rows, cols, field);\n    break;\n  }\n}\n\n\n/* Function:    loadGlider\n* Description: Inserts a glider into the field.\n* Input:       The field array and its size.\n* Output:      The field array is updated.\n*/\n\nvoid loadGlider(const int rows, const int cols, cell field[rows][cols]) {\n\n  field[0][1].current = ALIVE;\n  field[1][2].current = ALIVE;\n  field[2][0].current = ALIVE;\n  field[2][1].current = ALIVE;\n  field[2][2].current = ALIVE;\n}\n\n\n/* Function:    loadSemaphore\n* Description: Inserts a semaphore into the field.\n* Input:       The field array and its size.\n* Output:      The field array is updated.\n*/\n\nvoid loadSemaphore(const int rows, const int cols, cell field[rows][cols]) {\n\n  field[8][1].current = ALIVE;\n  field[8][2].current = ALIVE;\n  field[8][3].current = ALIVE;\n}\n\n\n/* Function:    loadRandom\n* Description: Inserts a random structure into the field.\n* Input:       The field array and its size.\n* Output:      The field array is updated. There is a 50 % chance that a cell\n*              is alive.\n*/\n\nvoid loadRandom(const int rows, const int cols, cell field[rows][cols]) {\n\n}\n\n\n/* Function:    loadCustom\n* Description: Lets the user specify a structure that then is inserted into\n*              the field.\n* Input:       The field array and its size.\n* Output:      The field array is updated.\n*/\n\nvoid loadCustom(const int rows, const int cols, cell field[rows][cols]) {\n\n  printf(\"Give custom format string: \");\n  do {\n    int r, c;\n    scanf(\"%d,%d\", &amp;r, &amp;c);\n    field[r][c].current = ALIVE;\n  } while (getchar() != '\\n');\n}\n/* Function:    printWorld\n* Description: Prints the current field\n* Input:       The field array and its size.\n* Output:      The field array is updated.\n*/\n\n\nvoid printWorld(const int rows, const int cols, cell field[rows][cols]){\n\n  char c = '\\n';\n\n  while(c == '\\n'){\n    for (int i = 0; i &lt; rows; i++) {\n      for (int j = 0; j &lt; cols; j++) {\n        printf(\"%c \", field[i][j].current);\n      }\n      printf(\"\\n\");\n    }\n    c = getchar();\n    if(c != '\\n'){\n      break;\n  }\n}\n\nvoid evolve(const int rows,const int cols,cell field[rows][cols]){\n\nfor(int i = 0;i&lt;rows;i++){\n  for(int j =0;j&lt;cols;j++){\n    if()\n  }\n}\n\n\n}\n</code></pre>\n\n<p>You can see above all current progress. All the functions except for<br>\n<code>printWorld()</code> and <code>evolve()</code> are pre-made and should remain as they are.</p>\n\n<p>This is my current progress for <code>evolve</code>, it is not much.</p>\n\n<pre><code>void evolve(const int rows,const int cols,cell field[rows][cols]){\n\nfor(int i = 0;i&lt;rows;i++){\n  for(int j =0;j&lt;cols;j++){\n    if()\n  }\n}\n\n\n}\n</code></pre>\n\n<p>All I have done is to write two nested for-loops which makes sure to check every cell.</p>\n\n<p>But I am not sure however how to proceed and implement the conditions above. Any ideas on how to check neighbours for each cell?</p>\n\n<p>English is not my  first language. So I apologise in advance for any grammatical error. And if you have trouble understanding what I want, ask, and I'll clarify.</p>\n\n<p>I would also add a disclaimer that the function: <code>printWorld</code> is not finished since it still requires the function <code>evolve</code>.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 2575, "user_id": 10669875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ae3bf8ded4da2254e5aa66d54167613?s=128&d=identicon&r=PG&f=1", "display_name": "wovano", "link": "https://stackoverflow.com/users/10669875/wovano"}, "edited": false, "score": 2, "creation_date": 1559685481, "post_id": 56451754, "comment_id": 99496941, "body": "Welcome to Stack Overflow. Please format your code properly, because your post is currently very hard to read. See <a href=\"https://stackoverflow.com/editing-help\">here</a> if you don&#39;t know how to format the code. Also, please read at least the following pages to quickly learn how to use Stack Overflow: <a href=\"https://stackoverflow.com/tour\">tour</a>, <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>, <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}], "answers": [{"tags": [], "owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "is_accepted": false, "score": 0, "last_activity_date": 1559685821, "creation_date": 1559685821, "answer_id": 56451905, "question_id": 56451754, "link": "https://stackoverflow.com/questions/56451754/my-c-program-crashes-in-its-second-loop-and-i-dont-know-why/56451905#56451905", "title": "My C program crashes in its second loop and I don&#39;t know why", "body": "<blockquote>\n<pre><code>p += size;\n</code></pre>\n</blockquote>\n\n<p>C knows the size. You need</p>\n\n<pre><code>p += 1 /* C multiplies by size automagically */;\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11601292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a68f05d6c05e1645e4e194f59b4e5a9?s=128&d=identicon&r=PG&f=1", "display_name": "sahand khoshdel", "link": "https://stackoverflow.com/users/11601292/sahand-khoshdel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "closed_date": 1559692749, "answer_count": 1, "score": -1, "last_activity_date": 1559687038, "creation_date": 1559684744, "last_edit_date": 1559687038, "question_id": 56451754, "link": "https://stackoverflow.com/questions/56451754/my-c-program-crashes-in-its-second-loop-and-i-dont-know-why", "closed_reason": "Duplicate", "title": "My C program crashes in its second loop and I don&#39;t know why", "body": "<p>Its aim is to get a number from the user and create that number of kind of television programs and save their information based on structures. It gets the program name, hour, etc.</p>\n\n<p>Unfortunately it crashes after getting the name in the second loop.</p>\n\n<p>I have tried printing something in its second loop but it doesn't even reach that point.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#include &lt;stdlib.h&gt;\n\nstruct time {\n    int hour;\n    int minute;\n};\n\nstruct program {\n    char name[30];\n    struct time mytime;\n    int viewer[3];// baby  woman man \n    int type;\n};\n\nvoid func (struct program *, int, int);\n\nstruct program * func2 (struct program *);\n\nint main()\n{\n    int k, i;\n\n    printf(\"k=\");\n    scanf(\"%d\", &amp;k);\n\n    struct program *p , *p1 , *p2;\n\n    int size = sizeof(struct program);\n\n    p = (struct program *) malloc (k * sizeof (struct program));\n\n    p1= p;\n\n    if (p != NULL)\n    {\n\n    for (i=0; i&lt;k; i++)\n    {\n\n      printf(\"Name =\");\n\n      scanf(\"%s\", p-&gt;name);\n\n    //it crashes here !\n\n      printf(\"Hour=\");\n\n      scanf(\"%d\",&amp;p-&gt;mytime.hour);\n\n      printf(\"Minute=\");\n\n      scanf(\"%d\",&amp;p-&gt;mytime.minute);\n\n      printf(\"Type=\");\n\n      scanf(\"%d\",&amp;p-&gt;type);\n\n      printf(\"Baby=\");\n      scanf(\"%d\",&amp;p-&gt;viewer[0]);\n      printf(\"Woman=\");\n      scanf(\"%d\",&amp;p-&gt;viewer[1]);\n      printf(\"Man=\");\n      scanf(\"%d\",&amp;p-&gt;viewer[2]);\n\n        printf(\"-----------------------------------------------\\n\");\n\n        p += size;\n\n    }\n\n   }\n\n    p=p1;\n\n    func (p, size, k);\n\n      printf(\"Name =\");\n      scanf(\"%s\", p1-&gt;name);\n      printf(\"Hour=\");\n      scanf(\"%d\",&amp;p1-&gt;mytime.hour);\n      printf(\"Minute=\");\n      scanf(\"%d\",&amp;p1-&gt;mytime.minute);\n      printf(\"Type=\");\n      scanf(\"%d\",&amp;p1-&gt;type);\n      printf(\"Baby=\");\n      scanf(\"%d\",&amp;p1-&gt;viewer[0]);\n      printf(\"Woman=\");\n      scanf(\"%d\",&amp;p1-&gt;viewer[1]);\n      printf(\"Man=\");\n      scanf(\"%d\",&amp;p1-&gt;viewer[2]);\n      printf(\"-----------------------------------------------\\n\");\n\n    func2(p1);\n\n    printf(\"%s %d  %d  %d  %d %d %d\", p1-&gt;name, p1-&gt;mytime.hour,p1-&gt;mytime.minute, p1-&gt;type, \n           p1-&gt;viewer[0], p1-&gt;viewer[1], p1-&gt;viewer[2]);\n\n    return 0;\n}\n\nvoid func (struct program *p, int size, int k)\n{\n    int i, s;\n\n    for (i=0; i&lt;k; i++)\n    {\n      s =  0.2*(p-&gt;viewer[0] + p-&gt;viewer[1] + p-&gt;viewer[2]);\n      if (  p-&gt;viewer[0] &gt; s ) \n         p-&gt;type= 1;    \n      if (p-&gt;mytime.hour &gt; 14  )    \n      {\n         printf(\"Name=%s Hour=%d   Minute=%d\\n\",p-&gt;name ,p-&gt;mytime.hour,p-&gt;mytime.minute);\n      }\n      p += size;    \n    }   \n}\n\nstruct program * func2 (struct program *p)\n{\n  if (p-&gt;viewer[1] &gt; p-&gt;viewer[2])  \n  {\n    p-&gt;type = 3;\n    return p;\n  }\n}\n</code></pre>\n"}, {"tags": ["c++", "c"], "comments": [{"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 3, "creation_date": 1559686181, "post_id": 56451716, "comment_id": 99497142, "body": "&quot;crt0.o&quot; is the &quot;C runtime&quot; code. If <code>bootstrap.S</code> is intended to completely replace that code, then you&#39;ll need to tell the compiler not to link with <code>crt0.o</code>."}, {"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1559699610, "post_id": 56451716, "comment_id": 99499532, "body": "@user3386109: OP did tell the compiler not to link with <code>crt0.o</code>.  That&#39;s the problem.  He needs to tell the linker..."}], "answers": [{"tags": [], "owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "is_accepted": false, "score": 2, "last_activity_date": 1559699468, "creation_date": 1559699468, "answer_id": 56453352, "question_id": 56451716, "link": "https://stackoverflow.com/questions/56451716/how-to-solve-multiple-definition-of-start-error/56453352#56453352", "title": "How to solve multiple definition of `_start&#39; error?", "body": "<p>You're using the <code>-nostartfiles</code> option, but in the wrong place.</p>\n\n<p>You have it on a compilation step (<code>-c</code> option), while it belongs on linking.</p>\n\n<p><code>-Wl,</code> options are also only used when linking</p>\n"}], "owner": {"reputation": 1, "user_id": 11601160, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e748ac3aff99c8d5b8a71d89e33a938?s=128&d=identicon&r=PG&f=1", "display_name": "girnd_it", "link": "https://stackoverflow.com/users/11601160/girnd-it"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 207, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1559699468, "creation_date": 1559684465, "last_edit_date": 1559698807, "question_id": 56451716, "link": "https://stackoverflow.com/questions/56451716/how-to-solve-multiple-definition-of-start-error", "title": "How to solve multiple definition of `_start&#39; error?", "body": "<p>I am working on a project where I have to compare incoming data from a sensor. The main source code is in C++ along with a C source file, a .S file, and a .h file. When I am trying to link those files it shows an error and I don't have any clue as to what the error is. Any help regarding the problem will be very much appreciated. </p>\n\n<p>My Makefile looks like:</p>\n\n<pre><code>all : main.cpp irq.c irq.h bootstrap.S\n\nriscv32-unknown-elf-gcc -c irq.c bootstrap.S -march=rv32g -mabi=ilp32d -nostartfiles -Wl,--no-relax \nriscv32-unknown-elf-g++  -c main.cpp -march=rv32g -mabi=ilp32d \nriscv32-unknown-elf-g++ -o main main.o irq.o bootstrap.o -march=rv32g -mabi=ilp32d\n\ndump-elf: all\nriscv32-unknown-elf-readelf -a main\n\ndump-code: all\nriscv32-unknown-elf-objdump -D main\n\ndump-comment: all\nobjdump -s --section .comment main\n\nclean:\nrm -f main`\n</code></pre>\n\n<p>main.cpp</p>\n\n<pre><code>#include \"stdint.h\"\nextern \"C\"{\n#include \"irq.h\"\n}\n#include&lt;stdio.h&gt;\n#include&lt;iostream&gt;\n\nusing namespace std;\n\nstatic volatile char * const TERMINAL_ADDR = (char * const)0x20000000;\nstatic volatile char * const SENSOR_INPUT_ADDR = (char * const)0x50000000;\nstatic volatile uint32_t * const SENSOR_SCALER_REG_ADDR = (uint32_t * const)0x50000080;\nstatic volatile uint32_t * const SENSOR_FILTER_REG_ADDR = (uint32_t * const)0x50000084;\n\nbool has_sensor_data = 0;\n\nvoid sensor_irq_handler() {\nhas_sensor_data = 1;\n}\n\nvoid dump_sensor_data() {\nwhile (!has_sensor_data) {\n    asm volatile (\"wfi\");\n}\nhas_sensor_data = 0;\n\nfor (int i=0; i&lt;64; ++i) {\n    *TERMINAL_ADDR = *(SENSOR_INPUT_ADDR + i) % 92 + 32;\n}\n*TERMINAL_ADDR = '\\n';  \n}\n\nint main() {\nregister_interrupt_handler(2, sensor_irq_handler);\n\n*SENSOR_SCALER_REG_ADDR = 5;\n*SENSOR_FILTER_REG_ADDR = 2;\n\nfor (int i=0; i&lt;3; ++i)\n    dump_sensor_data();\n\nreturn 0;\n}\n</code></pre>\n\n<p>irq.c</p>\n\n<p><a href=\"https://github.com/agra-uni-bremen/riscv-vp/blob/master/sw/simple-sensor/irq.c\" rel=\"nofollow noreferrer\">https://github.com/agra-uni-bremen/riscv-vp/blob/master/sw/simple-sensor/irq.c</a></p>\n\n<p>irq.h</p>\n\n<p><a href=\"https://github.com/agra-uni-bremen/riscv-vp/blob/master/sw/simple-sensor/irq.h\" rel=\"nofollow noreferrer\">https://github.com/agra-uni-bremen/riscv-vp/blob/master/sw/simple-sensor/irq.h</a></p>\n\n<p>bootstrap.S</p>\n\n<p><a href=\"https://github.com/agra-uni-bremen/riscv-vp/blob/master/sw/simple-sensor/bootstrap.S\" rel=\"nofollow noreferrer\">https://github.com/agra-uni-bremen/riscv-vp/blob/master/sw/simple-sensor/bootstrap.S</a></p>\n\n<p>The output should be 64 random characters with interrupts.</p>\n\n<p>The Error is: </p>\n\n<pre><code>/opt/riscv/lib/gcc/riscv32-unknown-elf/8.3.0/../../../../riscv32-unknown-elf/bin/ld: /tmp/cckjuDlw.o: in function `.L0 ':\n(.text+0x0): multiple definition of `_start'; /opt/riscv/lib/gcc/riscv32-unknown-elf/8.3.0/../../../../riscv32-unknown-elf/lib/crt0.o:(.text+0x0): first defined here\n</code></pre>\n"}, {"tags": ["c", "multithreading", "sockets", "select"], "comments": [{"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1559685157, "post_id": 56451699, "comment_id": 99496842, "body": "<code>poll()</code> would be better than <code>select()</code> with that many. Or <code>epoll</code> on Linux or <code>kqueue</code> on BSDs or completion ports on Windows. Or a library like libevent."}, {"owner": {"reputation": 14930, "user_id": 395718, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f1323cdc2a70698b5275082bf6e61184?s=128&d=identicon&r=PG", "display_name": "Dialecticus", "link": "https://stackoverflow.com/users/395718/dialecticus"}, "edited": false, "score": 0, "creation_date": 1559685241, "post_id": 56451699, "comment_id": 99496868, "body": "Stack Overflow is not meant to be used for opinions and advice. Maybe there is already some open-source framework optimized for your target OS that you could build upon."}, {"owner": {"reputation": 247, "user_id": 8310085, "user_type": "registered", "profile_image": "https://graph.facebook.com/1789907944358222/picture?type=large", "display_name": "Alex Erling", "link": "https://stackoverflow.com/users/8310085/alex-erling"}, "reply_to_user": {"reputation": 14930, "user_id": 395718, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f1323cdc2a70698b5275082bf6e61184?s=128&d=identicon&r=PG", "display_name": "Dialecticus", "link": "https://stackoverflow.com/users/395718/dialecticus"}, "edited": false, "score": 0, "creation_date": 1559685518, "post_id": 56451699, "comment_id": 99496953, "body": "@Dialecticus Thanks for the information. Would you have a suggestion on what are the best sites to ask for opinions and advice then?"}, {"owner": {"reputation": 14930, "user_id": 395718, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f1323cdc2a70698b5275082bf6e61184?s=128&d=identicon&r=PG", "display_name": "Dialecticus", "link": "https://stackoverflow.com/users/395718/dialecticus"}, "edited": false, "score": 1, "creation_date": 1559686607, "post_id": 56451699, "comment_id": 99497227, "body": "Maybe <a href=\"https://softwarerecs.stackexchange.com\">Software Recommendations</a>, maybe some forums, like Reddit. There is a Boost.Asio library, but it requires C++ instead of C. Maybe more thorough googling can help, like &quot;C high performance server source code&quot;"}, {"owner": {"reputation": 8402, "user_id": 4664415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hsfxj.jpg?s=128&g=1", "display_name": "mevets", "link": "https://stackoverflow.com/users/4664415/mevets"}, "edited": false, "score": 1, "creation_date": 1559688719, "post_id": 56451699, "comment_id": 99497682, "body": "has any of your research landed on Golang?   Go seems to have this story pretty well figured out.   You can do it in C, or even C++ if you are a masochist, but you will spend so much effort on infrastructure that is baked into Go...."}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 1, "creation_date": 1559697010, "post_id": 56451699, "comment_id": 99499096, "body": "200 clients is nothing. Keep it simple and use threads and blocking mode."}], "answers": [{"tags": [], "owner": {"reputation": 51, "user_id": 8812186, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aZQ4u.png?s=128&g=1", "display_name": "ogabriel", "link": "https://stackoverflow.com/users/8812186/ogabriel"}, "is_accepted": false, "score": 0, "last_activity_date": 1559685709, "creation_date": 1559685709, "answer_id": 56451894, "question_id": 56451699, "link": "https://stackoverflow.com/questions/56451699/is-it-better-to-use-select-or-multi-threading-or-both-when-creating-a-server-t/56451894#56451894", "title": "Is it better to use select or multi-threading (or both) when creating a server that will simultaneously send/receive tasks for 200+ clients", "body": "<p>I once made a program in Java, a chat application, that each connection with the server that was established, represented a new Thread in the server, to manage the client in question. </p>\n\n<p>Inside the Server class, there was a static variable, to manage which clients were connected.</p>\n\n<p>I don't know if recommend different technologies is the right way to answer you question, but i think, that for your case, would be a good idea to take a look at <a href=\"https://en.wikipedia.org/wiki/BEAM_(Erlang_virtual_machine)\" rel=\"nofollow noreferrer\">Erlang/Elixir</a> platform, the premise is the is able to hold a lot of clients at the same time.</p>\n\n<p>Currently, big companies, like Whatsapp uses Erlang and Discord Elixir.</p>\n\n<p>I hope that my answer was helpful.</p>\n"}, {"tags": [], "owner": {"reputation": 56858, "user_id": 131930, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/91536fe27d32713b8a154a0bf42f6748?s=128&d=identicon&r=PG", "display_name": "Jeremy Friesner", "link": "https://stackoverflow.com/users/131930/jeremy-friesner"}, "is_accepted": false, "score": 2, "last_activity_date": 1559713253, "last_edit_date": 1559713253, "creation_date": 1559712177, "answer_id": 56454633, "question_id": 56451699, "link": "https://stackoverflow.com/questions/56451699/is-it-better-to-use-select-or-multi-threading-or-both-when-creating-a-server-t/56454633#56454633", "title": "Is it better to use select or multi-threading (or both) when creating a server that will simultaneously send/receive tasks for 200+ clients", "body": "<p>Either approach will work; as far is which is \"better\", that's going to depend a lot on how you define the word \"better\".</p>\n\n<ul>\n<li><p>The single-threaded approach avoids any chance of problems with race conditions or deadlocks, because those problems inherently can't occur in a single-threaded program.  In a multithreaded program you have to be extremely careful about data-locking patterns, or else you will find yourself trying to debug very mysterious malfunctions that only occur once every few days/weeks/months.</p></li>\n<li><p>On the other hand, the single-threaded approach limits you to using a single core; it won't be able to take advantage of a modern multi-core CPU to give you a parallelism speedup.</p></li>\n<li><p>On the third hand, the multi-threaded approach can get hairy (and lose its speedup potential) if the various threads/connections often need to access any shared/mutable data structures.  In that \"shared data bottleneck\" scenario, the threads may spend a lot of their time blocked waiting to lock a mutex, and then you're mostly back to using a single core anyway.  If each connection operates independently of the others (e.g. as part of a simple web server) and doesn't need to interact with the other threads, then this shouldn't be a concern.</p></li>\n<li><p>Multithreading allows you to use blocking I/O (which is simpler to implement than non-blocking I/O), but blocking I/O limits your control over the threads (e.g. how do you get a thread to exit cleanly, or take some other non-client-initiated action, if it is blocked indefinitely inside a <code>recv()</code> call?  There aren't any good solutions to that problem, only poor ones)</p></li>\n<li><p>Single-threading requires you to use non-blocking I/O (otherwise a single unresponsive client can halt service to all the other clients while the server is blocked inside a <code>send()</code> or <code>recv()</code> call), and non-blocking I/O is tricky to do correctly, since you have to handle partial-reads and partial-writes gracefully.</p></li>\n<li><p>If your program ever needs to do a non-trivial amount of computation or file I/O, note that a single-threaded design will force all clients to wait while the computation (or I/O) for any client completes.  In a multithreaded design, OTOH, clients B through Z can continue to be serviced on other cores/threads while client A's is busy reading from the disk or crunching numbers.</p></li>\n<li><p>The overhead of spawning and maintaining threads will vary from one OS to another.  If you're going to be running hundreds of threads simultaneously, you might want to verify first that your target OS (and hardware) will be able to handle that load efficiently.  (You can reduce the overhead of spawning and reaping threads via a thread-pool, at some expense of increased RAM usage)</p></li>\n</ul>\n\n<p>I personally prefer the single-threaded/non-blocking-I/O approach, because blocking I/O is problematic if you want your program to be able to shut down cleanly and reliably (which you should want, if only so you can do e.g. memory-leak testing under valgrind).  If single-core performance turns out to be insufficient, it's often fairly straightforward extend the handle-N-sockets-on-1-thread design to a more powerful handle-N-sockets-on-each-of-M-threads design, and then you can play around with different values of N and M until you find the one that gives you the best performance (e.g. by setting M to the number of cores on the host machine, and handing out newly-accepted sockets to whichever thread is currently handling the smallest number of sockets)</p>\n"}], "owner": {"reputation": 247, "user_id": 8310085, "user_type": "registered", "profile_image": "https://graph.facebook.com/1789907944358222/picture?type=large", "display_name": "Alex Erling", "link": "https://stackoverflow.com/users/8310085/alex-erling"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 404, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1559713253, "creation_date": 1559684359, "question_id": 56451699, "link": "https://stackoverflow.com/questions/56451699/is-it-better-to-use-select-or-multi-threading-or-both-when-creating-a-server-t", "title": "Is it better to use select or multi-threading (or both) when creating a server that will simultaneously send/receive tasks for 200+ clients", "body": "<p>I am creating a server that will be sending and receiving tasks from over 200 clients simultaneously (potentially more client in the future). There will also be background engines on the clients that will perform tasks and send responses to the server without asking first. I expect there to be a high volume of information transferred both ways. I've been doing research into multi-threading and using the select function, and I'm wondering given some of the parameters of the project which option (or a combination) would be the most efficient scalable solution based on the amount of traffic that might occur. </p>\n\n<p>Any suggestions would be greatly appreciated. I'd be glad to answer any questions to provide more clarity.</p>\n"}, {"tags": ["c", "algorithm", "graph", "segmentation-fault", "breadth-first-search"], "comments": [{"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1559681946, "post_id": 56451255, "comment_id": 99495871, "body": "This is the point where you should start using a debugger. It should be able to tell you where the segmentation fault happened and let you inspect your variables at that time."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1559682191, "post_id": 56451255, "comment_id": 99495972, "body": "Fyi, this won&#39;t compile as is, which tells me it either never ran, or somehow you selectively dropped a semi-colon, seemingly impossible when one literally copy/pastes with no actual typing."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1559682248, "post_id": 56451255, "comment_id": 99495988, "body": "Do you mean you want to determine whether there is a <i>path</i> between a pair of vertices?  You should be able to determine whether there is an <i>edge</i> between them more or less directly from your representation of the graph."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1559682508, "post_id": 56451255, "comment_id": 99496074, "body": "I strongly suspect <code>if(maze[queue[bp+1]][i]==1)</code> is puking out-of-range on you. I&#39;d run this in a debugger and if that pans out, figure out why. Specifically, <code>queue[bp+1]</code> contains either indeterminate data or a value out of the range of the superior dimension of <code>maze</code>."}, {"owner": {"reputation": 30659, "user_id": 1210053, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/8cee821e7bf4acaa7f0de12d603b9f1d?s=128&d=identicon&r=PG", "display_name": "Nico Schertler", "link": "https://stackoverflow.com/users/1210053/nico-schertler"}, "edited": false, "score": 1, "creation_date": 1559683003, "post_id": 56451255, "comment_id": 99496220, "body": "If you are just interested in an edge, why not simply inspect <code>maze[t1-1][t2-1]</code>?"}, {"owner": {"reputation": 61, "user_id": 11352278, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-iuesVLpgeN8/AAAAAAAAAAI/AAAAAAAAJoc/QRuF_YTnvw8/photo.jpg?sz=128", "display_name": "karthik reddy", "link": "https://stackoverflow.com/users/11352278/karthik-reddy"}, "reply_to_user": {"reputation": 30659, "user_id": 1210053, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/8cee821e7bf4acaa7f0de12d603b9f1d?s=128&d=identicon&r=PG", "display_name": "Nico Schertler", "link": "https://stackoverflow.com/users/1210053/nico-schertler"}, "edited": false, "score": 0, "creation_date": 1559683590, "post_id": 56451255, "comment_id": 99496382, "body": "@Nico Schertler sorry for the wrong questions I actually need to determine path. Please help"}, {"owner": {"reputation": 30659, "user_id": 1210053, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/8cee821e7bf4acaa7f0de12d603b9f1d?s=128&d=identicon&r=PG", "display_name": "Nico Schertler", "link": "https://stackoverflow.com/users/1210053/nico-schertler"}, "edited": false, "score": 0, "creation_date": 1559684040, "post_id": 56451255, "comment_id": 99496506, "body": "Your input seems to have different formats. The first two cases seem to use 1-based indexing, the other two seem to use 0-based indexing."}, {"owner": {"reputation": 61, "user_id": 11352278, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-iuesVLpgeN8/AAAAAAAAAAI/AAAAAAAAJoc/QRuF_YTnvw8/photo.jpg?sz=128", "display_name": "karthik reddy", "link": "https://stackoverflow.com/users/11352278/karthik-reddy"}, "reply_to_user": {"reputation": 30659, "user_id": 1210053, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/8cee821e7bf4acaa7f0de12d603b9f1d?s=128&d=identicon&r=PG", "display_name": "Nico Schertler", "link": "https://stackoverflow.com/users/1210053/nico-schertler"}, "edited": false, "score": 0, "creation_date": 1559684239, "post_id": 56451255, "comment_id": 99496573, "body": "@Nico Schertler thanks it&#39;s working if I change indexing to 1"}], "answers": [{"tags": [], "owner": {"reputation": 61, "user_id": 11352278, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-iuesVLpgeN8/AAAAAAAAAAI/AAAAAAAAJoc/QRuF_YTnvw8/photo.jpg?sz=128", "display_name": "karthik reddy", "link": "https://stackoverflow.com/users/11352278/karthik-reddy"}, "is_accepted": false, "score": 0, "last_activity_date": 1559684603, "creation_date": 1559684603, "answer_id": 56451732, "question_id": 56451255, "link": "https://stackoverflow.com/questions/56451255/program-to-find-whether-a-path-exists-between-two-given-vertices-of-a-graph/56451732#56451732", "title": "Program to find whether a path exists between two given vertices of a graph", "body": "<p>The approach is correct but in the testcases I started indexing from '0' in later ones that's why I got a segmentation fault so if the vertices labeling starts from 1 this code works fine.</p>\n"}, {"comments": [{"owner": {"reputation": 61, "user_id": 11352278, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-iuesVLpgeN8/AAAAAAAAAAI/AAAAAAAAJoc/QRuF_YTnvw8/photo.jpg?sz=128", "display_name": "karthik reddy", "link": "https://stackoverflow.com/users/11352278/karthik-reddy"}, "edited": false, "score": 0, "creation_date": 1559720491, "post_id": 56451832, "comment_id": 99504336, "body": "This condition if (maze[queue[bp + 1]][i] == 1 is not to check the elements it is to add the children of next element into queue secondly you are correct with statement I use quadratic space but the program does execute please try it once"}, {"owner": {"reputation": 61, "user_id": 11352278, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-iuesVLpgeN8/AAAAAAAAAAI/AAAAAAAAJoc/QRuF_YTnvw8/photo.jpg?sz=128", "display_name": "karthik reddy", "link": "https://stackoverflow.com/users/11352278/karthik-reddy"}, "edited": false, "score": 0, "creation_date": 1559720544, "post_id": 56451832, "comment_id": 99504354, "body": "Can you suggest me a method to do it in linear space please"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 61, "user_id": 11352278, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-iuesVLpgeN8/AAAAAAAAAAI/AAAAAAAAJoc/QRuF_YTnvw8/photo.jpg?sz=128", "display_name": "karthik reddy", "link": "https://stackoverflow.com/users/11352278/karthik-reddy"}, "edited": false, "score": 0, "creation_date": 1559735247, "post_id": 56451832, "comment_id": 99511127, "body": "@karthikreddy, using linear queue space follows directly from avoiding enqueuing the same vertex more than once (ever).  You cannot then need more queue space, even in your somewhat simplistic queue implementation, than there are vertices in total."}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 1, "last_activity_date": 1559685276, "creation_date": 1559685276, "answer_id": 56451832, "question_id": 56451255, "link": "https://stackoverflow.com/questions/56451255/program-to-find-whether-a-path-exists-between-two-given-vertices-of-a-graph/56451832#56451832", "title": "Program to find whether a path exists between two given vertices of a graph", "body": "<p>Notwithstanding the errors in your test cases, you have several problems with your code, among them:</p>\n\n<ul>\n<li>you maintain <code>ep</code> as the index of the <em>next available</em> element of your queue, but your loop condition treats it as the <em>last used</em> element:</li>\n</ul>\n\n<blockquote>\n<pre><code>    while (bp &lt;= ep) {\n</code></pre>\n</blockquote>\n\n<ul>\n<li>you do not traverse the edges of the first vertex enqueued.  You look past it to the second:</li>\n</ul>\n\n<blockquote>\n<pre><code>                if (maze[queue[bp + 1]][i] == 1) {\n</code></pre>\n</blockquote>\n\n<ul>\n<li><p>you look up to <em>two</em> vertices past the last one enqueued (same lines already quoted)</p></li>\n<li><p>you have no mechanism to avoid visiting the same vertex more than once, so</p>\n\n<ol>\n<li>you use quadratic queue space when in principle you need only linear,</li>\n<li>but even that's not enough, because in the event that the start vertex is part of a loop but is not connected to the desired end vertex, your BFS will never terminate (until the program crashes).</li>\n</ol></li>\n</ul>\n"}], "owner": {"reputation": 61, "user_id": 11352278, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-iuesVLpgeN8/AAAAAAAAAAI/AAAAAAAAJoc/QRuF_YTnvw8/photo.jpg?sz=128", "display_name": "karthik reddy", "link": "https://stackoverflow.com/users/11352278/karthik-reddy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1559685276, "creation_date": 1559681825, "last_edit_date": 1559684262, "question_id": 56451255, "link": "https://stackoverflow.com/questions/56451255/program-to-find-whether-a-path-exists-between-two-given-vertices-of-a-graph", "title": "Program to find whether a path exists between two given vertices of a graph", "body": "<p>I wrote the following code in C to find whether there exists a path between two given vertices of a graph. Initially I ask the user for inputs, and then I use a breadth-first search to check whether there is a path between two specified vertices.</p>\n\n<p>This code is working fine for some testcases, but throwing a segmentation fault for others. Where am I going wrong?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main() {\n    int v, e, e1, e2, t1, t2;\n\n    printf(\"Enter num of vertices and edges: \");\n    scanf(\"%d %d\", &amp;v, &amp;e);\n    int maze[v][v];\n\n    for (int i = 0; i &lt; v; i++)\n        for (int j = 0; j &lt; v; j++)\n            maze[i][j] = 0;\n\n    printf(\"Enter edges:\\n\")\n    for (int i = 0; i &lt; e; i++) {\n        scanf(\"%d %d\", &amp;e1, &amp;e2);\n        maze[e1 - 1][e2 - 1] = 1;\n        maze[e2 - 1][e1 - 1] = 1;\n    }\n    printf(\"The maze looks like:\\n\");\n    for (int i = 0; i &lt; v; i++) {\n        for (int j = 0; j &lt; v; j++) {\n            printf(\"%d \", maze[i][j]);\n        }\n        printf(\"\\n\");\n    }\n\n    printf(\"enter target edges: \");\n    scanf(\"%d %d\", &amp;t1, &amp;t2);\n\n    //BFS starts from here.\n    int queue[v * v];\n    int k = 1;\n\n    queue[0] = t1 - 1;\n    for (int i = 0; i &lt; v; i++)\n        if (maze[t1 - 1][i] == 1) {\n            queue[k] = i;\n             k++;\n        }\n\n    int bp, ep;\n\n    bp = 0;\n    ep = k;\n    while (bp &lt;= ep) {\n        if (queue[bp] + 1 == t2) {\n            printf(\"\\npath exists\\n\");\n            exit(0);\n        } else {\n            for(int i = 0; i &lt; v; i++)\n                if (maze[queue[bp + 1]][i] == 1) {\n                    queue[k] = i;\n                    k++;\n                }       \n        }\n        bp = bp + 1;\n        ep = k;\n    }\n\n    printf(\"\\npath does'nt exist\\n\");\n}\n</code></pre>\n\n<p>Testcases for which this code is working:</p>\n\n<pre><code>    Testcase-1:\n    4 2\n    1 2\n    3 2\n    1 3\n\n    Testcase-2:\n    4 2\n    1 2\n    3 2\n    1 4\n\n    TestCase-3:\n    7 6\n    0 1\n    0 2\n    1 3\n    1 4\n    1 6\n    5 6\n    1 6\n</code></pre>\n\n<p>Testcases for which I am getting a segmentation fault:</p>\n\n<pre><code>    TestCase-4:\n    7 6\n    0 1\n    0 2\n    1 3\n    1 4\n    1 6\n    5 6\n    0 6\n\n    TestCase-5:\n    7 6\n    0 1\n    0 2\n    1 3\n    1 4\n    1 6\n    5 6\n    2 4\n</code></pre>\n"}, {"tags": ["c", "linux", "blkid"], "answers": [{"tags": [], "owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "is_accepted": true, "score": 3, "last_activity_date": 1559680446, "last_edit_date": 1559680446, "creation_date": 1559679900, "answer_id": 56450879, "question_id": 56450829, "link": "https://stackoverflow.com/questions/56450829/libblkid-only-works-with-root-and-after-running-as-root/56450879#56450879", "title": "libblkid only works with root and after running as root", "body": "<p>From the BLKID(8) man page:</p>\n\n<blockquote>\n  <p>The  libblkid  library is used to identify block devices (disks) as to their content (e.g.  filesystem type) as well as extracting additional information such as filesystem labels/volume names, unique identifiers/serial num\u2010\n         bers.  A common use is to allow use of LABEL= and UUID= tags instead of hard-coding specific block device names into configuration files.</p>\n</blockquote>\n\n<p>...</p>\n\n<blockquote>\n  <p>Note  that  blkid reads information directly from devices and <strong>for non-root users it returns cached unverified information.</strong></p>\n</blockquote>\n\n<p>From the LIBBLKID(3) man page:</p>\n\n<blockquote>\n  <p>The high-level part of the library keeps information about block\n  devices in a cache file and is verified to still be valid before being\n  returned to the user (if the user has read permission on the raw block\n  device, otherwise\n         not).  <strong>The cache file also allows unprivileged users (normally anyone other than root, or those not in the \"disk\" group) to locate\n  devices by label/id.</strong>  The standard location of the cache file can be\n  overridden by the envi\u2010\n         ronment variable BLKID_FILE.</p>\n</blockquote>\n\n<p>So after you've run it as root, the information is cached. Afterwards that information is retrieved when you run again as non-root.</p>\n"}], "owner": {"reputation": 674, "user_id": 2807964, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/1c165309ab0b980ea992270399846ec8?s=128&d=identicon&r=PG&f=1", "display_name": "jcfaracco", "link": "https://stackoverflow.com/users/2807964/jcfaracco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 56450879, "answer_count": 1, "score": 3, "last_activity_date": 1559680446, "creation_date": 1559679702, "question_id": 56450829, "link": "https://stackoverflow.com/questions/56450829/libblkid-only-works-with-root-and-after-running-as-root", "title": "libblkid only works with root and after running as root", "body": "<p>This is the weirdest thing that I've ever seen (actually, it has a nice explanation).</p>\n\n<p>I created a C code to list partitions and its own types:</p>\n\n<pre><code>char *get_luks_partition(void) {\n    blkid_dev dev;\n    blkid_cache cache;\n    blkid_dev_iterate iter;\n    const char *devname = NULL;\n    char *ret = NULL;\n    const char *type = NULL;\n\n    if (blkid_get_cache(&amp;cache, NULL))\n        return NULL;\n    blkid_probe_all(cache);\n\n    iter = blkid_dev_iterate_begin(cache);\n\n    while (!blkid_dev_next(iter, &amp;dev)) {\n        devname = blkid_dev_devname(dev);\n        type = blkid_get_tag_value(cache, \"TYPE\", devname);\n\n        if (type)\n            printf(\"dev: %s type: %s\\n\", devname, type);\n\n        if (type &amp;&amp; !strcmp(type, \"crypto_LUKS\")) {\n            ret = (char *) devname;\n            break;\n        }\n    }\n\n    blkid_dev_iterate_end(iter);\n\n    return ret;\n}\n</code></pre>\n\n<p>It does not show any device/partition and type when I run as a normal user.\nSo, I try to run as root and I finally see devices, partitions and types.\nAnd when I return to user, I can see the same output as root if I run again.\nSee the sequence:</p>\n\n<pre><code>$ ./main \ndev: /dev/sr0 type: udf\n\n$ sudo ./main \ndev: /dev/vda1 type: vfat\ndev: /dev/vda2 type: xfs\ndev: /dev/vda3 type: crypto_LUKS\n\n$ ./main \ndev: /dev/vda1 type: vfat\ndev: /dev/vda2 type: xfs\ndev: /dev/vda3 type: crypto_LUKS\n</code></pre>\n\n<p>Does anyone know what is happening?</p>\n"}, {"tags": ["c", "deadlock"], "comments": [{"owner": {"reputation": 109324, "user_id": 21926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6e61d47f9a6ec0a7a286835e51f3332?s=128&d=identicon&r=PG", "display_name": "Sean Bright", "link": "https://stackoverflow.com/users/21926/sean-bright"}, "edited": false, "score": 1, "creation_date": 1559679418, "post_id": 56450702, "comment_id": 99494792, "body": "Create two threads (<code>T1</code> and <code>T2</code>) and two mutexes (<code>M1</code> and <code>M2</code>). In thread <code>T1</code> lock <code>M1</code> and then <code>M2</code>. In thread <code>T2</code> lock <code>M2</code> and then <code>M1</code>."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 1, "creation_date": 1559679459, "post_id": 56450702, "comment_id": 99494807, "body": "Or even better, show the code and ask why it does not deadlock."}, {"owner": {"reputation": 11, "user_id": 11601026, "user_type": "registered", "profile_image": "https://graph.facebook.com/10217508559978944/picture?type=large", "display_name": "Marco Barca", "link": "https://stackoverflow.com/users/11601026/marco-barca"}, "edited": false, "score": 0, "creation_date": 1559728556, "post_id": 56450702, "comment_id": 99508174, "body": "This is the code"}], "answers": [{"tags": [], "owner": {"reputation": 6079, "user_id": 34989, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8f16eae47ba215ccc1fe3f05f1750adc?s=128&d=identicon&r=PG", "display_name": "Gerhard", "link": "https://stackoverflow.com/users/34989/gerhard"}, "is_accepted": false, "score": 0, "last_activity_date": 1559897329, "creation_date": 1559897329, "answer_id": 56490983, "question_id": 56450702, "link": "https://stackoverflow.com/questions/56450702/how-can-i-generate-threads-deadlock-on-macos/56490983#56490983", "title": "How can I generate threads deadlock on MacOs?", "body": "<p>Change the assignment of the variable in your thread:\n <code>int *i=(int *)p;</code></p>\n\n<p>You need to point to the argument else both threads run the same lock unlock sequence. Where you call <code>pthread_create</code> there is a implicit cast.</p>\n"}, {"tags": [], "owner": {"reputation": 11277, "user_id": 3657941, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/304d8d4cceca5f9ce2383ff97b53e36b?s=128&d=identicon&r=PG&f=1", "display_name": "David Cullen", "link": "https://stackoverflow.com/users/3657941/david-cullen"}, "is_accepted": false, "score": 0, "last_activity_date": 1560124146, "creation_date": 1560124146, "answer_id": 56519172, "question_id": 56450702, "link": "https://stackoverflow.com/questions/56450702/how-can-i-generate-threads-deadlock-on-macos/56519172#56519172", "title": "How can I generate threads deadlock on MacOs?", "body": "<p>I could not figure out how to get your code to deadlock. I was able to get the following example to deadlock on macOS:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;pthread.h&gt;\n#include &lt;unistd.h&gt;\n\ntypedef struct {\n    const char *mutex_name;\n    pthread_mutex_t *pmutex;\n} mutex_data_t;\n\ntypedef struct {\n    const char *thread_name;\n    mutex_data_t mutex_list[2];\n} thread_data_t;\n\nvoid *deadlock(void *data) {\n    thread_data_t *pthread_data = data;\n    const char *name = pthread_data-&gt;thread_name;\n    printf(\"%s: Starting...\\n\", name);\n    printf(\"%s: Locking %s...\\n\", name, pthread_data-&gt;mutex_list[0].mutex_name);\n    pthread_mutex_lock(pthread_data-&gt;mutex_list[0].pmutex);\n    printf(\"%s: Sleeping...\\n\", name);\n    sleep(1);\n    printf(\"%s: Locking %s...\\n\", name, pthread_data-&gt;mutex_list[1].mutex_name);\n    pthread_mutex_lock(pthread_data-&gt;mutex_list[1].pmutex);\n    printf(\"Done\\n\");\n    return NULL;\n}\n\nint main()\n{\n    pthread_mutex_t mutex1;\n    pthread_mutex_t mutex2;\n    mutex_data_t mutex1_data = { \"mutex1\", &amp;mutex1 };\n    mutex_data_t mutex2_data = { \"mutex2\", &amp;mutex2 };\n    thread_data_t thread1_data = { \"thread1\", { mutex1_data, mutex2_data }};\n    thread_data_t thread2_data = { \"thread2\", { mutex2_data, mutex1_data }};\n    pthread_t thread1;\n    pthread_t thread2;\n\n    pthread_mutex_init(&amp;mutex1, NULL);\n    pthread_mutex_init(&amp;mutex2, NULL);\n    pthread_create(&amp;thread1, NULL, deadlock, &amp;thread1_data);\n    pthread_create(&amp;thread2, NULL, deadlock, &amp;thread2_data);\n\n    pthread_join(thread1, NULL);\n    pthread_join(thread2, NULL);\n    return 0;\n}\n</code></pre>\n\n<p><strong>Output</strong></p>\n\n<pre><code>thread1: Starting...\nthread2: Starting...\nthread1: Locking mutex1...\nthread2: Locking mutex2...\nthread1: Sleeping...\nthread2: Sleeping...\nthread1: Locking mutex2...\nthread2: Locking mutex1...\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11601026, "user_type": "registered", "profile_image": "https://graph.facebook.com/10217508559978944/picture?type=large", "display_name": "Marco Barca", "link": "https://stackoverflow.com/users/11601026/marco-barca"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 94, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1560124146, "creation_date": 1559679088, "last_edit_date": 1559898449, "question_id": 56450702, "link": "https://stackoverflow.com/questions/56450702/how-can-i-generate-threads-deadlock-on-macos", "title": "How can I generate threads deadlock on MacOs?", "body": "<p>I'm learning to handle threads deadlock, but by executing the C code on my terminal, execution does not generate deadlocks even if it should. Can anyone tell me why and possibly how to force the deadlock?</p>\n\n<pre><code>#include&lt;pthread.h&gt;\n#include&lt;semaphore.h&gt;\n#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n#include&lt;unistd.h&gt;\n\nvoid *func(void *p);\n\npthread_mutex_t m1,m2;\n\nint main(){\n\n  pthread_t tid[2];\n  pthread_attr_t attr;\n  pthread_attr_init(&amp;attr);\n\n  int id[2];\n\n  for(int i=0;i&lt;2;i++){\n    id[i]=i;\n    pthread_create(&amp;tid[i],&amp;attr,func,(&amp;id[i]));\n  }\n\n  pause();\n\n}\n\nvoid *func(void *p){\n\n  int *i=p;\n  while(1){\n    if(*i==0){\n      pthread_mutex_lock(&amp;m1);\n      pthread_mutex_lock(&amp;m2);\n      printf(\"I'm Thread %d\\n\", *i);\n      pthread_mutex_unlock(&amp;m1);\n      pthread_mutex_unlock(&amp;m2);\n    }\n    else{\n      pthread_mutex_lock(&amp;m2);\n      pthread_mutex_lock(&amp;m1);\n      printf(\"I'm Thread %d\\n\", *i);\n      pthread_mutex_unlock(&amp;m1);\n      pthread_mutex_unlock(&amp;m2);\n    }\n  }\n  pthread_exit(0);\n\n}\n</code></pre>\n"}, {"tags": ["c", "inline", "c99", "linkage"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1559678084, "post_id": 56450337, "comment_id": 99494244, "body": "The <code>inline</code> keyword does not affect the linkage of the identifier to which it is applied.  Inline functions can have either external or internal linkage, and like other functions, they have external linkage by default.  But the combination of an explicit <code>extern</code> specifier with <code>inline</code> has special additional meaning."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1559678439, "post_id": 56450337, "comment_id": 99494396, "body": "Or, to be precise, I should say <i>the identifier of</i> an inline function can have either external or internal linkage."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1559678657, "post_id": 56450337, "comment_id": 99494495, "body": "See: (1) <a href=\"https://stackoverflow.com/questions/5229343/how-to-declare-an-inline-function-in-c99-multi-file-project\" title=\"how to declare an inline function in c99 multi file project\">stackoverflow.com/questions/5229343/&hellip;</a>, (2) <a href=\"https://stackoverflow.com/questions/6312597/is-inline-without-static-or-extern-ever-useful-in-c99\" title=\"is inline without static or extern ever useful in c99\">stackoverflow.com/questions/6312597/&hellip;</a>, (3) <a href=\"https://stackoverflow.com/questions/216510/extern-inline/\">stackoverflow.com/questions/216510/extern-inline</a> \u2014 probably amongst a number of other Q&amp;A on AO."}, {"owner": {"reputation": 427, "user_id": 5975045, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4ea137d6ba404fb60ed93346509bbf41?s=128&d=identicon&r=PG&f=1", "display_name": "Scorch", "link": "https://stackoverflow.com/users/5975045/scorch"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1559678892, "post_id": 56450337, "comment_id": 99494595, "body": "@JonathanLeffler Thanks for the resources. I&#39;ve read a few similar questions, but I can&#39;t seem to get it to click. I think I&#39;m thrown off by the declaration in the header and definition in the source file, which seems to counter to my current understanding of how to use <code>inline</code>"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1559679024, "post_id": 56450337, "comment_id": 99494644, "body": "In case of doubt, use <code>static inline \u2026</code> in the header and then you don&#39;t have to worry about anything much.  If the inline function is inlined, then there&#39;s no problem.  If it isn&#39;t inlined, then each file that uses it has a private copy of the function (that&#39;s the <code>static</code> part).  If that overhead is a worry, wonder about why you&#39;re declaring a function <code>inline</code> when it cannot actually be inlined."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1559679255, "post_id": 56450337, "comment_id": 99494740, "body": "And that previous comment doesn&#39;t address your concern.  Yes, the behaviour is a bit convoluted, but again, it usually isn&#39;t a problem if the function marked <code>inline</code> is actually inlined.  If it&#39;s not inlined, then the compiler generates a call to a regular function, and somewhere in the program, you need to define that function. And the mechanism used is <code>extern inline \u2026</code> in one source file. Note that placing the <code>extern inline</code> declaration in a header is odd \u2014 not what you&#39;d normally do. The plain <code>inline</code> definition (no <code>extern</code>) goes in a header; the <code>extern inline</code> goes in a source file."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1559694472, "post_id": 56450337, "comment_id": 99498693, "body": "In any case the example code that you found is of course wrong, the behaviour matches exactly that of the first duplicate, even though the <i>function declaration</i> has <code>inline</code> in it."}], "answers": [{"comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1559678649, "post_id": 56450558, "comment_id": 99494491, "body": "Minor correction: the needed external function definition does not have to have scope overlapping that of any inline definition of the same function.  In fact, I don&#39;t think it <i>can</i> do, though it can (but does not need to) share scope with any number of <i>declarations</i> of that function bearing the <code>inline</code> specifier."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1559678814, "post_id": 56450558, "comment_id": 99494563, "body": "There must be an <code>inline</code> definition of the function visible at the time you instantiate the function with <code>extern</code> \u2014 otherwise, how is the compiler to know how to instantiate the function?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1559679735, "post_id": 56450558, "comment_id": 99494927, "body": "I don&#39;t follow, @JonathanLeffler.  An inline definition of a given function does not provide and does not preclude an external definition of the same function.  In the case we&#39;re discussing, an external definition is required.  But in compiling the external definition, it is not necessary to know whether there are any internal ones.  All the declarations must be compatible, but inlinedness is not a factor in that."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1559680307, "post_id": 56450558, "comment_id": 99495177, "body": "Addendum: I meant to say &quot;But in compiling the external definition, it is not necessary to know whether there are any <b><i>inline</i></b> ones,&quot; though what I actually did say is true, too."}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1559680770, "post_id": 56450558, "comment_id": 99495369, "body": "@JohnBollinger I guess if the standard doesn&#39;t prohibit independent definitions where the corresponding inline isn&#39;t visible, it should be allowed. Thanks for the comment!"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1559682119, "post_id": 56450558, "comment_id": 99495941, "body": "See C11 <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.7.4p10\" rel=\"nofollow noreferrer\">&#167;6.7.4 Function specifiers &#182;10 (Example 1)</a>, which also references <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.9\" rel=\"nofollow noreferrer\">&#167;6.9 External definitions</a>, though I&#39;m not immediately sure why \u2014 there&#39;s only one mention of <code>inline</code> there.  Also very relevant is <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.7.4p7\" rel=\"nofollow noreferrer\">&#167;6.7.4 &#182;7</a>."}], "tags": [], "owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "is_accepted": true, "score": 3, "last_activity_date": 1559679280, "last_edit_date": 1559679280, "creation_date": 1559678439, "answer_id": 56450558, "question_id": 56450337, "link": "https://stackoverflow.com/questions/56450337/understanding-this-extern-inline-call-in-c99/56450558#56450558", "title": "Understanding this &quot;extern inline&quot; call in C99", "body": "<p>C99 inline functions are not like C++ inline functions.</p>\n\n<p>They aren't merged. You're expected to provide an extern definition if you don't make it <code>static</code>.</p>\n\n<p>The way you do that for an inline function <code>f</code> is by providing an <code>extern</code> declaration (e.g., <code>int f(void);</code>, <code>extern int f(void);</code>, or <code>extern inline int f(void);</code>) in a translation unit where an <code>inline</code> definition for <code>f</code> (e.g., <code>inline f(void){ return 42; }</code>) is also provided. </p>\n\n<p>The order is not important.</p>\n\n<pre><code>inline int f(void) { return 42; }\nint f(void);\n</code></pre>\n\n<p>provides an external definition just like</p>\n\n<pre><code>int f(void);\ninline int f(void) { return 42; }\n</code></pre>\n\n<p>does.</p>\n\n<p>A translation unit with just inline declarations/definitions without an extern declaration will not provide an extern definition:</p>\n\n<pre><code> inline int f(void); \n//^if an inline decl is present a definition MUST follow or else you get a diagnostic\n inline int f(void) { return 42; }\n inline int f(void);  //a pointless but legal redeclaration\n</code></pre>\n\n<p>Usually you'll have an inline definition in a header like in your example, and then to instantiate it, you'll include the header and provide an extern declaration. Including <code>extern</code> or <code>extern inline</code> in the declaration is technically unnecessary but it makes it clear that that declaration's goal is to instantiate an extern definition of an inline function.</p>\n\n<p>More info at <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.7.4p7\" rel=\"nofollow noreferrer\">6.7.4p7</a>. (I find this particular part of the C standard somewhat cryptic but usage examples are provided.)</p>\n"}], "owner": {"reputation": 427, "user_id": 5975045, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4ea137d6ba404fb60ed93346509bbf41?s=128&d=identicon&r=PG&f=1", "display_name": "Scorch", "link": "https://stackoverflow.com/users/5975045/scorch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 207, "favorite_count": 1, "closed_date": 1559694132, "accepted_answer_id": 56450558, "answer_count": 1, "score": 2, "last_activity_date": 1559694220, "creation_date": 1559677388, "question_id": 56450337, "link": "https://stackoverflow.com/questions/56450337/understanding-this-extern-inline-call-in-c99", "closed_reason": "Duplicate", "title": "Understanding this &quot;extern inline&quot; call in C99", "body": "<p>So I was reading some code and ran across this little snippet:</p>\n\n<pre><code>//file.h\n\nextern inline void foo();\n</code></pre>\n\n<p>With the implementation that looks like this:</p>\n\n<pre><code>//file.c\nMyType_t instance;\ninline void foo()\n{\n    instance.someField++;\n}\n</code></pre>\n\n<p>Perhaps maybe I'm misunderstanding something, but it looks to me like the author intended to have an externally visible function which was also <code>inline</code> (which has internal linkage by default I believe). Because it's a tiny modifier function, I think the intention was to leverage inline substitution to avoid function overhead (which makes sense, as this runs on an embedded platform). But is this code actually eligible for inline substitution?</p>\n\n<p>My understanding is that <code>inline</code> provides that the compiler won't complain about multiple definitions (as per <a href=\"https://www.ibm.com/support/knowledgecenter/en/ssw_ibm_i_71/rzarg/inline_linkage.htm\" rel=\"nofollow noreferrer\">this link</a>), and that the function <a href=\"https://gustedt.wordpress.com/2010/11/29/myth-and-reality-about-inline-in-c99/\" rel=\"nofollow noreferrer\">may be eligible for inline substitution</a> (as an alternative to function-like macros).</p>\n\n<p>In this case though, because the definition is not in the header, there will still only be one \"copy\" of the inline function, so it is not eligible for inline substitution in files which include <code>file.h</code> (as far as I can tell). </p>\n\n<p>(from the second link above):</p>\n\n<blockquote>\n  <p>the compiler must at least have seen a definition of the function. But if you have a classical big C project with functions that are implemented in different compilation units the compiler can\u2019t do that integration for you. So you\u2019d have to put the implementation of such candidate functions in header files.</p>\n</blockquote>\n\n<p>Therefore, it's only property remaining would be that the compiler won't complain about the multiply defined symbols, so that it could perhaps be defined differently in a different compilation unit. Though it's not so in this case, the symbol is only defined once for the record.</p>\n\n<p>So the crux of my question is: am I correct in concluding that this inline doesn't really serve much better purpose than this code:</p>\n\n<pre><code>//file.h\nextern void foo();\n\n//file.c\nMyType_t instance;\nvoid foo()\n{\n    instance.someField++;\n}\n</code></pre>\n\n<p>And if the author wanted to make it eligible for inline substitution, would the solution have been to <a href=\"https://embeddedgurus.com/barr-code/2011/03/do-inline-function-bodies-belong-in-c-header-files/\" rel=\"nofollow noreferrer\">put the inline declaration and function body in the header</a>?</p>\n"}, {"tags": ["c", "arrays", "pointers", "memory-management", "struct"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1559677211, "post_id": 56450254, "comment_id": 99493878, "body": "Are you trying to create a dynamic array of structures, which would require <code>ArrayOfStructures *array</code> and <code>array[0].X</code>, or a dynamic array of pointers to structures (which uses the pointer to pointer notation, but isn&#39;t what the title suggests you&#39;re after)?"}, {"owner": {"reputation": 445, "user_id": 7104681, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/ZtMiO.jpg?s=128&g=1", "display_name": "Dennis V.R.", "link": "https://stackoverflow.com/users/7104681/dennis-v-r"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1559677634, "post_id": 56450254, "comment_id": 99494057, "body": "Good question. Seems to me, It doesn&#39;t matter how turn to an element of a structure array[0]-&gt;X; or array[0].X; I would like to use fastest way to access of all these elements, because high performance is important to me."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1559677780, "post_id": 56450254, "comment_id": 99494122, "body": "Double pointers (pointers to pointers, that is) require two memory accesses to get at the data; single pointers require one.  You should probably go with the simpler version, then."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1559677865, "post_id": 56450254, "comment_id": 99494158, "body": "Also, don&#39;t hide multiple statements on a single line, as in <code>Points points; memset(&amp;points,0x0,sizeof(Points)); conf-&gt;points = &amp;points;</code>.  Use one line per statement."}, {"owner": {"reputation": 445, "user_id": 7104681, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/ZtMiO.jpg?s=128&g=1", "display_name": "Dennis V.R.", "link": "https://stackoverflow.com/users/7104681/dennis-v-r"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1559680698, "post_id": 56450254, "comment_id": 99495336, "body": "@JonathanLeffler I would like to create a dynamic array of structures, not a dynamic array of pointers to structures."}], "answers": [{"comments": [{"owner": {"reputation": 445, "user_id": 7104681, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/ZtMiO.jpg?s=128&g=1", "display_name": "Dennis V.R.", "link": "https://stackoverflow.com/users/7104681/dennis-v-r"}, "edited": false, "score": 0, "creation_date": 1559679463, "post_id": 56450374, "comment_id": 99494808, "body": "Uninitialized length is my fault. Unfortunately I can&#39;t change  the text of source code, because this site have a bug. But if you try to add conf-&gt;points-&gt;length = 1; at the begin of another_function() call nothing will be change. Segmentation fault stay the same."}], "tags": [], "owner": {"reputation": 284, "user_id": 11562467, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dVLZx.png?s=128&g=1", "display_name": "rjg", "link": "https://stackoverflow.com/users/11562467/rjg"}, "is_accepted": false, "score": 1, "last_activity_date": 1559677540, "creation_date": 1559677540, "answer_id": 56450374, "question_id": 56450254, "link": "https://stackoverflow.com/questions/56450254/allocate-memory-for-dynamic-array-of-structures-inside-a-structure-with-double-p/56450374#56450374", "title": "Allocate memory for dynamic array of structures inside a structure with double pointer**", "body": "<p>You don't seem to initialize <code>length</code> to a meaningful value. Therefore you don't actually allocate memory, since you call <code>calloc()</code> with the first argument being zero.</p>\n\n<p>(Disclaimer: I haven't tested the code, but that seems to be wrong.)</p>\n"}, {"comments": [{"owner": {"reputation": 445, "user_id": 7104681, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/ZtMiO.jpg?s=128&g=1", "display_name": "Dennis V.R.", "link": "https://stackoverflow.com/users/7104681/dennis-v-r"}, "edited": false, "score": 0, "creation_date": 1559710581, "post_id": 56451919, "comment_id": 99501397, "body": "Thank you very much for working example. You are right, real code has been minimized for this question. I left in its original form the entire tree of function calls and nesting of structures, simplifying everything else. Valgrind my everyday&#39;s  tool and I have no problem to free memory. But pointers and its dereferencing sometime makes me cry )"}, {"owner": {"reputation": 445, "user_id": 7104681, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/ZtMiO.jpg?s=128&g=1", "display_name": "Dennis V.R.", "link": "https://stackoverflow.com/users/7104681/dennis-v-r"}, "edited": false, "score": 0, "creation_date": 1559711014, "post_id": 56451919, "comment_id": 99501461, "body": "Well, I understood my mistake. However, I wonder how this code should look with a dynamic array of pointers to the structure?"}, {"owner": {"reputation": 445, "user_id": 7104681, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/ZtMiO.jpg?s=128&g=1", "display_name": "Dennis V.R.", "link": "https://stackoverflow.com/users/7104681/dennis-v-r"}, "edited": false, "score": 0, "creation_date": 1559712529, "post_id": 56451919, "comment_id": 99501795, "body": "Excellent. Thank you very much again. ^_^"}], "tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": true, "score": 1, "last_activity_date": 1559712291, "last_edit_date": 1559712291, "creation_date": 1559685930, "answer_id": 56451919, "question_id": 56450254, "link": "https://stackoverflow.com/questions/56450254/allocate-memory-for-dynamic-array-of-structures-inside-a-structure-with-double-p/56451919#56451919", "title": "Allocate memory for dynamic array of structures inside a structure with double pointer**", "body": "<p>You're fairly close to what you want according to your <a href=\"https://stackoverflow.com/questions/56450254/allocate-memory-for-dynamic-array-of-structures-inside-a-structure-with-double-p?noredirect=1#comment99495336_56450254\">comment</a>.</p>\n\n<h3>Using array of structures</h3>\n\n<p>Here's an adaptation of your code.  The primary change is use <code>ArrayOfStructs *array</code> instead of using a pointer-to-pointer.  Also, because you've decided to use <code>uint_fast64_t</code> for a data type, you have to use <code>PRIuFAST64</code> from <code>&lt;inttypes.h&gt;</code> to get the correct format string.  It would be better to change that to <code>size_t</code>; you aren't going to spot the performance difference on any reasonable system (but the code uses the format <code>PRIuFAST64</code>).</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;string.h&gt;\n#include &lt;inttypes.h&gt;\n\ntypedef struct\n{\n    double X;\n    double Y;\n} ArrayOfStructures;\n\ntypedef struct\n{\n    uint_fast64_t length;\n    ArrayOfStructures *array;\n} Points;\n\ntypedef struct\n{\n    Points *points;\n} Config;\n\nstatic\nvoid add_new_array(Config *conf)\n{\n    printf(\"conf=%p\\n\", conf);\n    printf(\"conf-&gt;points=%p\\n\", conf-&gt;points);\n    printf(\"conf-&gt;points-&gt;length=%\" PRIuFAST64 \"\\n\", conf-&gt;points-&gt;length);\n    printf(\"conf-&gt;points-&gt;array=%p\\n\", conf-&gt;points-&gt;array);\n\n    ArrayOfStructures *temp = calloc(conf-&gt;points-&gt;length, sizeof(ArrayOfStructures));\n    printf(\"temp=%p\\n\", temp);\n    conf-&gt;points-&gt;array = temp;\n    printf(\"conf-&gt;points-&gt;array=%p\\n\", conf-&gt;points-&gt;array);\n}\n\nstatic\nvoid another_function(Config *conf)\n{\n    conf-&gt;points-&gt;length = 1;\n\n    add_new_array(conf);\n\n    conf-&gt;points-&gt;array[0].X = 0.1;\n    conf-&gt;points-&gt;array[0].Y = 0.2;\n\n    printf(\"The result: X=%.12f, Y=%.12f, length=%\" PRIuFAST64 \"\\n\",\n           conf-&gt;points-&gt;array[0].X, conf-&gt;points-&gt;array[0].Y, conf-&gt;points-&gt;length);\n}\n\nstatic\nvoid some_function(Config *conf)\n{\n    // To pass the structure to another function\n    another_function(conf);\n}\n\nint main(void)\n{\n    // Stack's allocated memory\n    Config conf_;\n    Config *conf = &amp;conf_;\n    memset(conf, 0x0, sizeof(Config));\n\n    // Stack's allocated memory\n    Points points;\n    memset(&amp;points, 0x0, sizeof(Points));\n    conf-&gt;points = &amp;points;\n\n    some_function(conf);\n\n    return(EXIT_SUCCESS);\n}\n</code></pre>\n\n<p>When run, this produces:</p>\n\n<pre><code>conf=0x7ffeed6883f8\nconf-&gt;points=0x7ffeed688400\nconf-&gt;points-&gt;length=1\nconf-&gt;points-&gt;array=0x0\ntemp=0x7fef13c02a80\nconf-&gt;points-&gt;array=0x7fef13c02a80\nThe result: X=0.100000000000, Y=0.200000000000, length=1\n</code></pre>\n\n<p>It doesn't crash.  I've not run it under <a href=\"http://valgrind.org/\" rel=\"nofollow noreferrer\">Valgrind</a>.  It will report leaks for the allocated memory.</p>\n\n<p>Your type name <code>ArrayOfStructures</code> for a type that has no array in it seems wildly inappropriate.  I'd've expected that to be given a name such as <code>Point</code>.  I assume your <code>Config</code> structure has been minimized for this question (if so, thank you).  If not, then the structure holding a single pointer to another structure is not giving you any benefit.  It is just slowing down your access to the data \u2014 vastly outweighing any benefit from using <code>uint_fast64_t</code> instead of <code>size_t</code>.  You'll need to be careful about your allocation of memory for the <code>Config</code> structure; you can't simply free everything inside the <code>Config</code> and its child structures at the moment.</p>\n\n<h3>Using array of pointers to structures</h3>\n\n<p>This is very similar to the last code, but you need an extra set of memory allocations.  I've made that into a loop since the only reason for using this design is to allow you to allocate the pointed at structures separately.  Otherwise, it is just needlessly complex.  I've made a few minor cleanups; there are more improvements possible.  I've added a structure dumper function, <code>dump_points()</code>, which I can and do use to print values at different points.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;string.h&gt;\n#include &lt;inttypes.h&gt;\n\ntypedef struct\n{\n    double X;\n    double Y;\n} ArrayOfStructures;\n\ntypedef struct\n{\n    size_t length;\n    ArrayOfStructures **array;\n} Points;\n\ntypedef struct\n{\n    Points *points;\n} Config;\n\nstatic void dump_points(const char *tag, const Points *points)\n{\n    printf(\"%s (%zu, %p)\\n\", tag, points-&gt;length, (void *)points);\n    for (size_t i = 0; i &lt; points-&gt;length; i++)\n        printf(\"%zu: (%.12f, %.12f) %p\\n\", i, points-&gt;array[i]-&gt;X, points-&gt;array[i]-&gt;Y,\n               (void *)points-&gt;array[i]);\n}\n\nstatic\nvoid add_new_array(Config *conf)\n{\n    printf(\"conf=%p\\n\", (void *)conf);\n    printf(\"conf-&gt;points=%p\\n\", (void *)conf-&gt;points);\n    printf(\"conf-&gt;points-&gt;length=%zu\\n\", conf-&gt;points-&gt;length);\n    printf(\"conf-&gt;points-&gt;array=%p\\n\", (void *)conf-&gt;points-&gt;array);\n\n    conf-&gt;points-&gt;array = calloc(conf-&gt;points-&gt;length, sizeof(conf-&gt;points-&gt;array[0]));\n    for (size_t i = 0; i &lt; conf-&gt;points-&gt;length; i++)\n        conf-&gt;points-&gt;array[i] = calloc(1, sizeof(conf-&gt;points-&gt;array[i][0]));\n    printf(\"conf-&gt;points-&gt;array=%p\\n\", (void *)conf-&gt;points-&gt;array);\n    printf(\"conf-&gt;points-&gt;array[0]=%p\\n\", (void *)conf-&gt;points-&gt;array[0]);\n    dump_points(\"Inside add new array\", conf-&gt;points);\n}\n\nstatic\nvoid another_function(Config *conf)\n{\n    conf-&gt;points-&gt;length = 3;\n\n    add_new_array(conf);\n\n    conf-&gt;points-&gt;array[0]-&gt;X = 0.1;\n    conf-&gt;points-&gt;array[0]-&gt;Y = 0.2;\n    conf-&gt;points-&gt;array[1]-&gt;X = 1.1;\n    conf-&gt;points-&gt;array[1]-&gt;Y = 1.2;\n    conf-&gt;points-&gt;array[2]-&gt;X = 2.1;\n    conf-&gt;points-&gt;array[2]-&gt;Y = 2.2;\n\n    dump_points(\"Inside another function\", conf-&gt;points);\n}\n\nstatic\nvoid some_function(Config *conf)\n{\n    // To pass the structure to another function\n    another_function(conf);\n    dump_points(\"Inside some function\", conf-&gt;points);\n}\n\nint main(void)\n{\n    // Stack's allocated memory\n    Config conf_;\n    Config *conf = &amp;conf_;\n    memset(conf, 0x0, sizeof(Config));\n\n    // Stack's allocated memory\n    Points points;\n    memset(&amp;points, 0x0, sizeof(Points));\n    conf-&gt;points = &amp;points;\n\n    some_function(conf);\n    dump_points(\"Inside main\", conf-&gt;points);\n\n    return(EXIT_SUCCESS);\n}\n</code></pre>\n\n<p>Sample output (macOS 10.14.5 Mojave; GCC 9.1.0):</p>\n\n<pre><code>conf=0x7ffee6f6b408\nconf-&gt;points=0x7ffee6f6b410\nconf-&gt;points-&gt;length=3\nconf-&gt;points-&gt;array=0x0\nconf-&gt;points-&gt;array=0x7f9c0a402a70\nconf-&gt;points-&gt;array[0]=0x7f9c0a402a90\nInside add new array (3, 0x7ffee6f6b410)\n0: (0.000000000000, 0.000000000000) 0x7f9c0a402a90\n1: (0.000000000000, 0.000000000000) 0x7f9c0a402aa0\n2: (0.000000000000, 0.000000000000) 0x7f9c0a402ab0\nInside another function (3, 0x7ffee6f6b410)\n0: (0.100000000000, 0.200000000000) 0x7f9c0a402a90\n1: (1.100000000000, 1.200000000000) 0x7f9c0a402aa0\n2: (2.100000000000, 2.200000000000) 0x7f9c0a402ab0\nInside some function (3, 0x7ffee6f6b410)\n0: (0.100000000000, 0.200000000000) 0x7f9c0a402a90\n1: (1.100000000000, 1.200000000000) 0x7f9c0a402aa0\n2: (2.100000000000, 2.200000000000) 0x7f9c0a402ab0\nInside main (3, 0x7ffee6f6b410)\n0: (0.100000000000, 0.200000000000) 0x7f9c0a402a90\n1: (1.100000000000, 1.200000000000) 0x7f9c0a402aa0\n2: (2.100000000000, 2.200000000000) 0x7f9c0a402ab0\n</code></pre>\n\n<p>It's reassuring to see that the data is not corrupted as it is passed back up the chain of functions.</p>\n"}], "owner": {"reputation": 445, "user_id": 7104681, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/ZtMiO.jpg?s=128&g=1", "display_name": "Dennis V.R.", "link": "https://stackoverflow.com/users/7104681/dennis-v-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 56451919, "answer_count": 2, "score": 0, "last_activity_date": 1559712291, "creation_date": 1559676985, "last_edit_date": 1559680789, "question_id": 56450254, "link": "https://stackoverflow.com/questions/56450254/allocate-memory-for-dynamic-array-of-structures-inside-a-structure-with-double-p", "title": "Allocate memory for dynamic array of structures inside a structure with double pointer**", "body": "<p>When I use this code I would like to turn to every element of array of structures like this:</p>\n\n<pre><code>array[0]-&gt;X;\narray[1]-&gt;X;\n</code></pre>\n\n<p>I tried everything I could, but in all cases I've had Segmentation fault. What am I doing wrong?</p>\n\n<p>Please look at blocks between #if 0 #endif</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;string.h&gt;\n#include &lt;inttypes.h&gt;\n\ntypedef struct\n{\n    double X;\n    double Y;\n\n} ArrayOfStructures;\n\ntypedef struct\n{\n    uint_fast64_t length;\n\n    ArrayOfStructures **array;\n\n} Points;\n\ntypedef struct\n{\n    Points *points;\n\n} Config;\n\nvoid add_new_array(Config *conf)\n{\n    printf(\"conf=%p\\n\",conf);\n    printf(\"conf-&gt;points=%p\\n\",conf-&gt;points);\n    printf(\"conf-&gt;points-&gt;length=%zu\\n\",conf-&gt;points-&gt;length);\n    printf(\"conf-&gt;points-&gt;array=%p\\n\",conf-&gt;points-&gt;array);\n    #if 0\n    ArrayOfStructures *temp = (ArrayOfStructures*)calloc(conf-&gt;points-&gt;length,sizeof(ArrayOfStructures));\n    printf(\"temp=%p\\n\",temp);\n    // Segmentation fault\n    *conf-&gt;points-&gt;array = temp;\n    #else\n    conf-&gt;points-&gt;array  = (ArrayOfStructures **)calloc(conf-&gt;points-&gt;length,sizeof(ArrayOfStructures *));\n    #endif\n    printf(\"conf-&gt;points-&gt;array=%p\\n\",conf-&gt;points-&gt;array);\n}\n\nvoid another_function(Config *conf)\n{\n    conf-&gt;points-&gt;length = 1;\n\n    add_new_array(conf);\n\n    conf-&gt;points-&gt;array[0]-&gt;X = 0.1;\n    conf-&gt;points-&gt;array[0]-&gt;Y = 0.2;\n\n    printf(\"The result: X=%.12f, Y=%.12f, length=%zu\\n\",conf-&gt;points-&gt;array[0]-&gt;X,conf-&gt;points-&gt;array[0]-&gt;Y,conf-&gt;points-&gt;length);\n}\n\nvoid some_function(Config * conf)\n{\n    // To pass the structure to another function\n    another_function(conf);\n}\n\nint main(void)\n{\n    // Stack's allocated memory\n    Config conf_;\n    Config *conf = &amp;conf_;\n    memset(conf,0x0,sizeof(Config));\n\n    // Stack's allocated memory\n    Points points;\n    memset(&amp;points,0x0,sizeof(Points));\n    conf-&gt;points = &amp;points;\n\n    some_function(conf);\n\n    return(EXIT_SUCCESS);\n}\n</code></pre>\n\n<p>Compiled using:</p>\n\n<pre><code>gcc -D_SVID_SOURCE -g -ggdb -ggdb1 -ggdb2 -ggdb3 -O0 -DDEBUG -std=c11 -Wall --pedantic arryay.c -o array\n</code></pre>\n\n<p>I tried to find answers for handling a double pointer, but everything is very confusing.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 367, "user_id": 10930163, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a82a32b93373e472ee666e96b00d1b5?s=128&d=identicon&r=PG&f=1", "display_name": "anonmess", "link": "https://stackoverflow.com/users/10930163/anonmess"}, "edited": false, "score": 6, "creation_date": 1559676246, "post_id": 56450106, "comment_id": 99493527, "body": "<code>getline</code> is a function in <code>stdio.h</code>. You&#39;re re-defining it in your code, which includes <code>stdio.h</code>."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 4, "creation_date": 1559676684, "post_id": 56450106, "comment_id": 99493687, "body": "Also <code>getline</code> probably didn&#39;t exist at the time the book was written."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1559677455, "post_id": 56450106, "comment_id": 99493979, "body": "@Jean-Fran&#231;oisFabre: The probability of <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/getline.html\" rel=\"nofollow noreferrer\"><code>getline()</code></a> not existing as a POSIX function when K&amp;R 2nd Edn was written is 100%.  It wasn&#39;t in POSIX 2004; it arrived in POSIX 2008.  The book was about 20 years old by then."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1559677631, "post_id": 56450106, "comment_id": 99494056, "body": "morality: always give your functions funny names just in case they collide with standard functions in the future."}], "answers": [{"tags": [], "owner": {"reputation": 48, "user_id": 11579707, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/251deac0d938d0d3deb300539991a969?s=128&d=identicon&r=PG&f=1", "display_name": "ARD", "link": "https://stackoverflow.com/users/11579707/ard"}, "is_accepted": true, "score": 3, "last_activity_date": 1559677394, "last_edit_date": 1559677394, "creation_date": 1559676752, "answer_id": 56450212, "question_id": 56450106, "link": "https://stackoverflow.com/questions/56450106/gcc-errors-conflicting-types-for-and-previous-declaration-of-during-compilin/56450212#56450212", "title": "gcc errors &quot;conflicting types for&quot; and &quot;previous declaration of&quot; during compiling", "body": "<p>The POSIX function <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/getline.html\" rel=\"nofollow noreferrer\"><code>getline()</code></a> is now a standard library function which is (already) declared in <code>&lt;stdio.h&gt;</code> (but wasn't standard when K&amp;R was written).\nHence, you cannot re-declare the function a little differently in C language.\nA workaround is to rename your getline function to something else, e.g. getline_new\nThe updated code is as below with this workaround, or you may want to switch to C++ that gives flexibility to have many functions with same name, but different arguments, including argument type (polymorphism concept)</p>\n\n<pre><code>    #include &lt;stdio.h&gt;\n\n    int getline_new(char line[], int maxline);\n    void copy(char to[], char from[]);\n\n    int main()\n    {\n\n    }\n\n    int getline_new(char s[], int lim)\n    {\n       int c, i;\n\n       for (i=0; i&lt;lim-1 &amp;&amp; (c=getchar())!=EOF &amp;&amp; c!='\\n'; ++i)\n        s[i] = c;\n       if (c == '\\n') {\n        s[i] = c;\n        ++i;\n     }\n     s[i] = '\\0';\n     return i;\n    }\n\n   void copy(char to[], char from[])\n   {\n    int i;\n\n    i = 0;\n    while ((to[i] = from[i]) != '\\0')\n        ++i;\n   }\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 10872065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SJUE8.jpg?s=128&g=1", "display_name": "Spindaboy", "link": "https://stackoverflow.com/users/10872065/spindaboy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 56450212, "answer_count": 1, "score": 0, "last_activity_date": 1559677394, "creation_date": 1559676125, "question_id": 56450106, "link": "https://stackoverflow.com/questions/56450106/gcc-errors-conflicting-types-for-and-previous-declaration-of-during-compilin", "title": "gcc errors &quot;conflicting types for&quot; and &quot;previous declaration of&quot; during compiling", "body": "<p>I am getting these errors despite declaring the \"getline\" and \"copy\" function prototypes before main(). This program comes straight from the code in <em>The C Programming Language</em> so I'm unsure what the issue is and how to fix it.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint getline(char line[], int maxline);\nvoid copy(char to[], char from[]);\n\nint main()\n{\n\n}\n\nint getline(char s[], int lim)\n{\n    int c, i;\n\n    for (i=0; i&lt;lim-1 &amp;&amp; (c=getchar())!=EOF &amp;&amp; c!='\\n'; ++i)\n        s[i] = c;\n    if (c == '\\n') {\n        s[i] = c;\n        ++i;\n    }\n    s[i] = '\\0';\n    return i;\n}\n\nvoid copy(char to[], char from[])\n{\n    int i;\n\n    i = 0;\n    while ((to[i] = from[i]) != '\\0')\n        ++i;\n}\n</code></pre>\n\n<p>The exact errors produced by the compiler are:</p>\n\n<pre><code>string_reverser.c:4:5: error: conflicting types for 'getline'\n int getline(char line[], int maxline);\n     ^~~~~~~\n\nIn file included from string_reverser.c:1:0:\nc:\\mingw\\include\\stdio.h:650:1: note: previous declaration of 'getline' was here\n getline (char ** __restrict__, size_t * __restrict__, FILE * __restrict__);\n ^~~~~~~\n\nstring_reverser.c:27:5: error: conflicting types for 'getline'\n int getline(char s[], int lim)\n     ^~~~~~~\n\nIn file included from string_reverser.c:1:0:\nc:\\mingw\\include\\stdio.h:650:1: note: previous declaration of 'getline' was here\n getline (char ** __restrict__, size_t * __restrict__, FILE * __restrict__);\n ^~~~~~~\n</code></pre>\n"}, {"tags": ["c", "warnings"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1559675284, "post_id": 56449914, "comment_id": 99493172, "body": "Please re-format your question. Currently the mark-up makes a little sense."}, {"owner": {"reputation": 1046, "user_id": 614611, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c8a0c0fc3aa2182c46210e0257253dac?s=128&d=identicon&r=PG", "display_name": "Kingkong Jnr", "link": "https://stackoverflow.com/users/614611/kingkong-jnr"}, "edited": false, "score": 0, "creation_date": 1559675917, "post_id": 56449914, "comment_id": 99493411, "body": "R Sahu, the code is working code. The compile error happens when I pass it as &amp;tIPArray. I&#39;ll update the code for clarity."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1559676313, "post_id": 56449914, "comment_id": 99493551, "body": "@KingkongJnr The compile error is correct. The type of <code>tIPArray</code> in an expression is conversion to temporary pointer to base element. Since the elements are <code>MyStruct *</code>, a pointer to that would be <code>MyStruct **</code>.  Therefore <code>loadFunc(&amp;tIPArray, 3);</code> is wrong; it should be <code>loadFunc(tIPArray, 3);</code> The error says as much, and goes on to specifically tell you the difference in types and thus the conflict. That they resolve to the same address is irrelevant."}], "answers": [{"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 2, "last_activity_date": 1559677722, "creation_date": 1559677722, "answer_id": 56450413, "question_id": 56449914, "link": "https://stackoverflow.com/questions/56449914/difference-in-passing-a-double-pointer-to-a-function-in-c-and-c/56450413#56450413", "title": "Difference in passing a double pointer to a function in C and C++", "body": "<p>This declaration ...</p>\n\n<blockquote>\n<pre><code>        MyStruct*   tIPArray[3];\n</code></pre>\n</blockquote>\n\n<p>declares <code>tIPArray</code> as an array of 3 <code>MyStruct *</code>.  Therefore, <code>&amp;tIPArray</code> is a pointer to such an array, its type is <code>MyStruct *(*)[3]</code>, just as the error message says.  This is not the same type as <code>MyStruct **</code>, which is the expected type of the function argument.</p>\n\n<p>You can instead pass an explicit pointer to the first element ...</p>\n\n<pre><code>        loadFunc(&amp;tIPArray[0], 3);\n</code></pre>\n\n<p>... but it would be more idiomatic to just omit the <code>&amp;</code>, since ordinary conversion of array to pointer (\"decay\" of the array) produces a pointer of the correct type and value:</p>\n\n<pre><code>        loadFunc(tIPArray, 3);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8101, "user_id": 7691729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2568514188dfa24ecc3c1884e481834?s=128&d=identicon&r=PG&f=1", "display_name": "Quimby", "link": "https://stackoverflow.com/users/7691729/quimby"}, "is_accepted": false, "score": 2, "last_activity_date": 1559677752, "creation_date": 1559677752, "answer_id": 56450421, "question_id": 56449914, "link": "https://stackoverflow.com/questions/56449914/difference-in-passing-a-double-pointer-to-a-function-in-c-and-c/56450421#56450421", "title": "Difference in passing a double pointer to a function in C and C++", "body": "<p>Perhaps it can be clearer if we use <code>typedef MyStruct* StrPtr;</code>. Then your example becomes:</p>\n\n<pre><code>void foo(StrPtr* bar);\n\nStrPtr array[4];\n</code></pre>\n\n<p>First, let look at this call:</p>\n\n<pre><code>foo(array);\n</code></pre>\n\n<p>Array is of type <code>StrPtr[4]</code>, not <code>StrPtr*</code>. Ideally this would call <code>foo(StrPtr bar[4])</code> but there's no such function. The next best match is that arrays can decay to pointers to their elements = <code>StrPtr*</code> and luckily there's <code>foo(StrPtr* bar)</code> function so the call is valid.</p>\n\n<p>Now, what is type of this expression?</p>\n\n<pre><code>&amp;array;\n</code></pre>\n\n<p>Well, again array is of type <code>StrPtr[4]</code> so this must be a pointer to that type = <code>StrPtr(*)[4]</code>. Same \"weird\" syntax as for function pointers.</p>\n\n<p>At last, take this call:</p>\n\n<pre><code>foo(&amp;array);\n</code></pre>\n\n<p>We now know that this would like to call <code>foo(StrPtr(*bar)[4])</code> and again there's no such function. So what can compiler do? <code>&amp;array</code> is not an array, it's a pointer and pointers cannot decay to anything. Hmm, what now? Well, in C any pointer can be passed to another no matter the type. Dereferencing such pointer is another thing. So, this call is valid and calls <code>foo(StrPtr* bar)</code> as there's no other candidate. Success? No, any decent compiler should warn against this, even better turning those warnings into errors using <code>-Wincompatible-pointer-types</code> or even forbid all warnings with <code>-Werror</code> as you did.</p>\n\n<p>So, the take away is that correct call is <code>foo(array);</code>.</p>\n"}], "owner": {"reputation": 1046, "user_id": 614611, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c8a0c0fc3aa2182c46210e0257253dac?s=128&d=identicon&r=PG", "display_name": "Kingkong Jnr", "link": "https://stackoverflow.com/users/614611/kingkong-jnr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 0, "accepted_answer_id": 56450413, "answer_count": 2, "score": 0, "last_activity_date": 1559677752, "creation_date": 1559675204, "last_edit_date": 1559676425, "question_id": 56449914, "link": "https://stackoverflow.com/questions/56449914/difference-in-passing-a-double-pointer-to-a-function-in-c-and-c", "title": "Difference in passing a double pointer to a function in C and C++", "body": "<p>In parseFunc() if I call loadFunc() by passing &amp;tIpArray, it compiles fine when using C as the compile(in onlinegdb.com) but complains as below on a later version of C compiler(gcc-bin/4.9.4/gcc) at work. </p>\n\n<p>Error at work is similar to what I see when I compile when using language as C++ in onlinegdb. Can someone tell me why the 4.9.4 gcc C compiler doesn't like the &amp; and what is the right way to handle this?</p>\n\n<pre><code>/******************************************************************************\n\nWelcome to GDB Online.\nGDB online is an online compiler and debugger tool for C, C++, Python, PHP, Ruby, \nC#, VB, Perl, Swift, Prolog, Javascript, Pascal, HTML, CSS, JS\nCode, Compile, Run and Debug online from anywhere in world.\n\n*******************************************************************************/\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\ntypedef struct _MyStruct\n{\n    char string[72];\n}MyStruct;\n\nint loadFunc(MyStruct** ipData, int counter)\n{\n    MyStruct **currentVal = ipData;\n\n    MyStruct *ipPtr = NULL;\n\n    printf(\"%p\\n\", currentVal);\n\n    for(int i=0; i&lt;counter; i++)\n    {\n        ipPtr = currentVal[i];\n        printf(\"Line-%d - %s - %p\\n\", i+1, ipPtr-&gt;string, ipPtr);\n    }\n}\n\nint parseFunc()\n{\n        MyStruct*   tIPArray[3];\n\n        for(int i=0; i&lt; 3; i++)\n        {\n            tIPArray[i] = 0;\n            tIPArray[i] = (MyStruct*) calloc(1, sizeof(MyStruct));\n            snprintf(tIPArray[i]-&gt;string, 72, \"Test-String-%d\", i+101);         \n        }        \n\n        for(int i=0; i&lt;3; i++)\n        {\n            printf(\"Line-%d %p-%p- %s\\n\", i+1, &amp;tIPArray[i], tIPArray[i], tIPArray[i]-&gt;string);\n        }\n\n        // call the load/ print loadFunc\n        loadFunc(&amp;tIPArray, 3);\n}\n\nint main()\n{\n    printf(\"Hello World\\n\");\n    parseFunc();\n    return 0;\n}\n</code></pre>\n\n<blockquote>\n  <p>Below is the error I get at work</p>\n\n<pre><code>error: passing argument 1 of 'loadFunc' from incompatible pointer type [-Werror]\n   loadFunc(&amp;tIPArray, 3);\nnote: expected 'struct MyStruct **' but argument is of type 'struct MyStruct * (*)[(sizetype)((int)((short unsigned int)getMaxAddressObjects() / 4u))]'\n int loadFunc(MyStruct **ipData, int counter)\n</code></pre>\n</blockquote>\n\n<p>Below error when building this in onlinegdb.com as C++ file</p>\n\n<blockquote>\n<pre><code>main.cpp: In function \u2018int parseFunc()\u2019:\nmain.cpp:49:38: error: cannot convert \u2018MyStruct * (*)[3] {aka MyStruct * (*)[3]}\u2019 to \u2018MyStruct ** {aka MyStruct **}\u2019 for argument \u20181\u2019 to \u2018int loadFunc(MyStruct **, int)\u2019\n     loadFunc(&amp;tIPArray, 3);\n</code></pre>\n</blockquote>\n"}, {"tags": ["python", "c"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1559674208, "post_id": 56449662, "comment_id": 99492706, "body": "Is that Python code properly formatted? And when asking questions about errors, first of all please show us a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> which replicates the problem, and always include the errors. So please create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> to show us, and then copy-paste (as text) the <i>complete</i> and <i>full</i> error output from the shown example."}, {"owner": {"reputation": 9079, "user_id": 7867968, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c6976c101b7e5d81ad398cedf6a2ab9b?s=128&d=identicon&r=PG&f=1", "display_name": "C.Nivs", "link": "https://stackoverflow.com/users/7867968/c-nivs"}, "edited": false, "score": 0, "creation_date": 1559674243, "post_id": 56449662, "comment_id": 99492719, "body": "<code>**argv</code> assumes a mapping like a <code>dict</code>. If <code>argv</code> is a <code>str</code>, you might want either <code>*argv</code> or just <code>argv</code>. We will need to see <i>exactly</i> how you are calling <code>main</code> in order to help"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1559674262, "post_id": 56449662, "comment_id": 99492726, "body": "Or perhaps all you need is some <a href=\"https://docs.python.org/3/\" rel=\"nofollow noreferrer\">good Python documentation</a>?"}, {"owner": {"reputation": 30387, "user_id": 6260170, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/0caf9a0d28be362618ffc0223b301d6e?s=128&d=identicon&r=PG&f=1", "display_name": "Chris_Rands", "link": "https://stackoverflow.com/users/6260170/chris-rands"}, "edited": false, "score": 0, "creation_date": 1559674327, "post_id": 56449662, "comment_id": 99492758, "body": "well you have no code block inside main, and you haven&#39;t defined <code>argv</code>"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 1, "creation_date": 1559674915, "post_id": 56449662, "comment_id": 99493000, "body": "Do you know what the <code>char**</code> in <code>C</code> means?"}], "answers": [{"comments": [{"owner": {"reputation": 123382, "user_id": 1252759, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/aGFfT.jpg?s=128&g=1", "display_name": "Jon Clements", "link": "https://stackoverflow.com/users/1252759/jon-clements"}, "edited": false, "score": 0, "creation_date": 1559674347, "post_id": 56449714, "comment_id": 99492765, "body": "It&#39;s not common style to <code>from sys import argv</code>... it&#39;s far more traditional to <code>import sys</code> and then use <code>sys.argv</code>..."}, {"owner": {"reputation": 30387, "user_id": 6260170, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/0caf9a0d28be362618ffc0223b301d6e?s=128&d=identicon&r=PG&f=1", "display_name": "Chris_Rands", "link": "https://stackoverflow.com/users/6260170/chris-rands"}, "reply_to_user": {"reputation": 123382, "user_id": 1252759, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/aGFfT.jpg?s=128&g=1", "display_name": "Jon Clements", "link": "https://stackoverflow.com/users/1252759/jon-clements"}, "edited": false, "score": 0, "creation_date": 1559674395, "post_id": 56449714, "comment_id": 99492790, "body": "@JonClements although it&#39;s not really bad in this case is it- not really namespace polluting or shadowing anything?"}, {"owner": {"reputation": 1332, "user_id": 8033766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9abf9af4a25c7a53a1c810822bac1db?s=128&d=identicon&r=PG", "display_name": "jarhill0", "link": "https://stackoverflow.com/users/8033766/jarhill0"}, "reply_to_user": {"reputation": 123382, "user_id": 1252759, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/aGFfT.jpg?s=128&g=1", "display_name": "Jon Clements", "link": "https://stackoverflow.com/users/1252759/jon-clements"}, "edited": false, "score": 0, "creation_date": 1559674449, "post_id": 56449714, "comment_id": 99492813, "body": "@JonClements do you have a source or a justification other than &quot;common&quot; and &quot;traditional&quot;? The only component of the <code>sys</code> module I use in this code is <code>argv</code>, so I don&#39;t see what&#39;s wrong with importing it only."}, {"owner": {"reputation": 123382, "user_id": 1252759, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/aGFfT.jpg?s=128&g=1", "display_name": "Jon Clements", "link": "https://stackoverflow.com/users/1252759/jon-clements"}, "reply_to_user": {"reputation": 30387, "user_id": 6260170, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/0caf9a0d28be362618ffc0223b301d6e?s=128&d=identicon&r=PG&f=1", "display_name": "Chris_Rands", "link": "https://stackoverflow.com/users/6260170/chris-rands"}, "edited": false, "score": 0, "creation_date": 1559674463, "post_id": 56449714, "comment_id": 99492820, "body": "@Chris_Rands nope... but everyone will immediately know that <code>sys.argv</code> is going to be the command line arguments without having to check... <code>argv</code> could just be any arbitrary thing... or maybe even a typo of <code>args</code> or <code>*args</code>..."}, {"owner": {"reputation": 123382, "user_id": 1252759, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/aGFfT.jpg?s=128&g=1", "display_name": "Jon Clements", "link": "https://stackoverflow.com/users/1252759/jon-clements"}, "edited": false, "score": 0, "creation_date": 1559674598, "post_id": 56449714, "comment_id": 99492866, "body": "Well, let&#39;s put it another way, in 15 years of Python, this is the first time I&#39;ve ever seen <code>from sys import argv</code> used anywhere (it&#39;s not in the standard library, I&#39;ve never seen it used in myriads of projects I&#39;ve been involved with or on github etc...)... as it&#39;s such short code it&#39;s easy to spot it, but if I&#39;m a page or two down, seeing <code>argv</code> I&#39;d have to check what it might be, seeing <code>sys.argv</code> - I don&#39;t exactly what it is - or supposed to be."}, {"owner": {"reputation": 30387, "user_id": 6260170, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/0caf9a0d28be362618ffc0223b301d6e?s=128&d=identicon&r=PG&f=1", "display_name": "Chris_Rands", "link": "https://stackoverflow.com/users/6260170/chris-rands"}, "reply_to_user": {"reputation": 123382, "user_id": 1252759, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/aGFfT.jpg?s=128&g=1", "display_name": "Jon Clements", "link": "https://stackoverflow.com/users/1252759/jon-clements"}, "edited": false, "score": 0, "creation_date": 1559674667, "post_id": 56449714, "comment_id": 99492896, "body": "@JonClements Well i agree <code>sys.argv</code> is more common but <code>from sys import argv</code> still has &gt;100K hits on github <a href=\"https://github.com/search?q=%22from+sys+import+argv%22&amp;type=Code\" rel=\"nofollow noreferrer\">github.com/search?q=%22from+sys+import+argv%22&amp;type=Code</a>"}, {"owner": {"reputation": 123382, "user_id": 1252759, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/aGFfT.jpg?s=128&g=1", "display_name": "Jon Clements", "link": "https://stackoverflow.com/users/1252759/jon-clements"}, "reply_to_user": {"reputation": 30387, "user_id": 6260170, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/0caf9a0d28be362618ffc0223b301d6e?s=128&d=identicon&r=PG&f=1", "display_name": "Chris_Rands", "link": "https://stackoverflow.com/users/6260170/chris-rands"}, "edited": false, "score": 0, "creation_date": 1559674813, "post_id": 56449714, "comment_id": 99492967, "body": "@Chris_Rands Okay... given the evidence, I&#39;ll have to concede one of my points then... however, since the OP is obviously new though, it&#39;s probably best to suggest the more established and documented approach used within Python itself?"}, {"owner": {"reputation": 1332, "user_id": 8033766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9abf9af4a25c7a53a1c810822bac1db?s=128&d=identicon&r=PG", "display_name": "jarhill0", "link": "https://stackoverflow.com/users/8033766/jarhill0"}, "reply_to_user": {"reputation": 123382, "user_id": 1252759, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/aGFfT.jpg?s=128&g=1", "display_name": "Jon Clements", "link": "https://stackoverflow.com/users/1252759/jon-clements"}, "edited": false, "score": 0, "creation_date": 1559674837, "post_id": 56449714, "comment_id": 99492979, "body": "@JonClements it may be that the pattern I&#39;ve used above is uncommon because codebases with complex arguments tend to use a library that takes care of agument parsing, such as <code>argparse</code>. Just looking through the GitHub link, many uses of &quot;<code>from sys import argv</code>&quot; tend to be beginners learning to program, so I feel that its use is appropriate here."}, {"owner": {"reputation": 123382, "user_id": 1252759, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/aGFfT.jpg?s=128&g=1", "display_name": "Jon Clements", "link": "https://stackoverflow.com/users/1252759/jon-clements"}, "edited": false, "score": 1, "creation_date": 1559674979, "post_id": 56449714, "comment_id": 99493030, "body": "@jarhill0 indeed... I tend to only use <code>sys.argv</code> for quick and dirty (and most likely disposable scripts)."}, {"owner": {"reputation": 123382, "user_id": 1252759, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/aGFfT.jpg?s=128&g=1", "display_name": "Jon Clements", "link": "https://stackoverflow.com/users/1252759/jon-clements"}, "edited": false, "score": 1, "creation_date": 1559675065, "post_id": 56449714, "comment_id": 99493077, "body": "Well, when people are learning, I tend to find it&#39;s best to introduce the more common and easily interpreted practices rather than short hands... but anyway... 6 of one and half dozen of the other and all that :)"}], "tags": [], "owner": {"reputation": 1332, "user_id": 8033766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9abf9af4a25c7a53a1c810822bac1db?s=128&d=identicon&r=PG", "display_name": "jarhill0", "link": "https://stackoverflow.com/users/8033766/jarhill0"}, "is_accepted": false, "score": 1, "last_activity_date": 1559674279, "creation_date": 1559674279, "answer_id": 56449714, "question_id": 56449662, "link": "https://stackoverflow.com/questions/56449662/how-to-convert-a-c-function-inputs-with-char-argv-to-python/56449714#56449714", "title": "How to convert a C function inputs with char** argv to python?", "body": "<p>Try this:</p>\n\n<pre><code>from sys import argv\n\ndef main():\n    day = int(argv[1])\n    month = int(argv[2])\n    year = int(argv[3])\n\nif __name__ == '__main__':\n    main()\n</code></pre>\n\n<p>For future reference, you should post the errors that you get, rather than just saying that you \"get errors.\"</p>\n"}], "owner": {"reputation": 1, "user_id": 8715954, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/w4oQi.jpg?s=128&g=1", "display_name": "Maedeh Gholizadeh", "link": "https://stackoverflow.com/users/8715954/maedeh-gholizadeh"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "closed_date": 1559696804, "answer_count": 1, "score": -6, "last_activity_date": 1559674279, "creation_date": 1559674052, "question_id": 56449662, "link": "https://stackoverflow.com/questions/56449662/how-to-convert-a-c-function-inputs-with-char-argv-to-python", "closed_reason": "Not suitable for this site", "title": "How to convert a C function inputs with char** argv to python?", "body": "<p>I want to convert a C code with the function below to python code, but I get errors.</p>\n\n<pre><code>int main(int argc, char** argv)\n{\n    int year, month, day;\n    int jul;\n    day = atoi(argv[1]);\n    month = atoi(argv[2]);\n    year = atoi(argv[3]);\n...    \n</code></pre>\n\n<p>when I write this python code for it, I get errors:</p>\n\n<pre><code>def main(argc, **argv):\n\nday = int(argv[1])\nmonth = int(argv[2])\nyear = int(argv[3])\n</code></pre>\n"}, {"tags": ["c", "gdb", "cross-platform"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 4, "creation_date": 1559670893, "post_id": 56449053, "comment_id": 99491428, "body": "If a program runs under A but crashes under B, it means that it has a bug causing undefined behavior. That&#39;s it, it is not about GDB but about your code."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1559671112, "post_id": 56449053, "comment_id": 99491508, "body": "There is a contradiction too - if it &quot;runs fine&quot; why the debugger?"}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1559671125, "post_id": 56449053, "comment_id": 99491516, "body": "If all you want is to run GDB through an IDE, you could just use a native Linux IDE.  I think VSCode itself even has a native Linux version as it is based off of Code Composer Studio (which itself might be Eclipse-based?  It&#39;s been awhile since I immersed myself in the world of IDEs)"}, {"owner": {"reputation": 177, "user_id": 5557298, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cec1dd587121708b8ee42bcf99c07f9?s=128&d=identicon&r=PG&f=1", "display_name": "Alex A", "link": "https://stackoverflow.com/users/5557298/alex-a"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1559671232, "post_id": 56449053, "comment_id": 99491564, "body": "@Eugene The program works when GDB is not being run. The program works when GDB is being run from a Linux architecture. The program does not work when GDB is being run from a Windows architecture. Perhaps there is a bug, but what could possibly be different about these GDB builds that could trigger such a bug? Ironically I cannot use the debugger to find such a bug."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 1, "creation_date": 1559671324, "post_id": 56449053, "comment_id": 99491614, "body": "Can you get a backtrace after it segfaults?  Is it GDB itself that is segfaulting rather than program being debugged?"}, {"owner": {"reputation": 5541, "user_id": 4367864, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/mIepQ.png?s=128&g=1", "display_name": "PC Luddite", "link": "https://stackoverflow.com/users/4367864/pc-luddite"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1559671333, "post_id": 56449053, "comment_id": 99491622, "body": "Like @EugeneSh. said, this almost certainly isn&#39;t an issue with GDB, but your program. We&#39;ll need to see the specific code that seg faults. Undefined behavior is exactly that. Could work in some instances, not in others. It&#39;s undefined."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 2, "creation_date": 1559671346, "post_id": 56449053, "comment_id": 99491623, "body": "<i>&quot;I know it&#39;s somehow related to the cross-platform-ness&quot;</i> - No, you don&#39;t. UB can manifest itself in many ways. Including working as intended."}, {"owner": {"reputation": 177, "user_id": 5557298, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cec1dd587121708b8ee42bcf99c07f9?s=128&d=identicon&r=PG&f=1", "display_name": "Alex A", "link": "https://stackoverflow.com/users/5557298/alex-a"}, "reply_to_user": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1559672056, "post_id": 56449053, "comment_id": 99491857, "body": "Looking at the core dump, and nothing obviously sticks out at me as being the cause of the segfault here. I am starting to think that, perhaps it will be easier to convince my corporate overlords to let me use an unapproved Linux machine on the corporate network (so I can use a native Linux IDE @Christian), than it will be to solve this debugging mess."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 1, "creation_date": 1559673169, "post_id": 56449053, "comment_id": 99492286, "body": "It is always the program. Gdb  is used by millions of programmers. Probably when gdb is active your program is run from different addresses and one of your out of bounds or dangling pointers are in the protected memory area."}, {"owner": {"reputation": 5541, "user_id": 4367864, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/mIepQ.png?s=128&g=1", "display_name": "PC Luddite", "link": "https://stackoverflow.com/users/4367864/pc-luddite"}, "edited": false, "score": 1, "creation_date": 1559673493, "post_id": 56449053, "comment_id": 99492392, "body": "@AlexA Using a different machine that doesn&#39;t segfault won&#39;t actually fix the problem.You cannot assume the program will still function in the future just because it functions now. (again, <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behavior</a>)"}, {"owner": {"reputation": 5541, "user_id": 4367864, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/mIepQ.png?s=128&g=1", "display_name": "PC Luddite", "link": "https://stackoverflow.com/users/4367864/pc-luddite"}, "edited": false, "score": 0, "creation_date": 1559673645, "post_id": 56449053, "comment_id": 99492466, "body": "I am voting to close as off topic since the OP has not provided a minimum, reproducible example."}, {"owner": {"reputation": 177, "user_id": 5557298, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cec1dd587121708b8ee42bcf99c07f9?s=128&d=identicon&r=PG&f=1", "display_name": "Alex A", "link": "https://stackoverflow.com/users/5557298/alex-a"}, "edited": false, "score": 0, "creation_date": 1559673899, "post_id": 56449053, "comment_id": 99492575, "body": "I will never in a million years be able to do such a thing, as I have no clue what is the cause here, so I would not able to provide a reproducible example. So if you want to close it, go ahead. My C application has around 2 million lines of code, and the stack trace in the core dump isn&#39;t providing anything helpful in this case."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1559674004, "post_id": 56449053, "comment_id": 99492617, "body": "From your question it is even not clear what is crashing. Your program? GDB? Something else? Can you post the exact terminal session transcript?"}, {"owner": {"reputation": 177, "user_id": 5557298, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cec1dd587121708b8ee42bcf99c07f9?s=128&d=identicon&r=PG&f=1", "display_name": "Alex A", "link": "https://stackoverflow.com/users/5557298/alex-a"}, "edited": false, "score": 0, "creation_date": 1559674161, "post_id": 56449053, "comment_id": 99492685, "body": "The actual application is crashing - gdbserver then terminates, causing the remote gdb session to end. The only (unexpected) output I get is <code>Child terminated with signal = 0xb (SIGSEGV)</code>, which is output by gdbserver indicating that the underlying application has terminated. There is no other output to provide."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1559674578, "post_id": 56449053, "comment_id": 99492860, "body": "Well, I guess <code>gdbserver</code> should not be crashing because of the debugged program. If it does then it could be it&#39;s bug. Does it work with some simple bug-free program such as &quot;hello world&quot; ?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1559675548, "post_id": 56449053, "comment_id": 99493287, "body": "Actually no, my mistake in the previous comment. <code>gdbserver</code> <i>should</i> terminate once the debugged process is terminated unless it is executed with specific  command line option (<code>--multi</code>) as stated <a href=\"https://sourceware.org/gdb/onlinedocs/gdb/Server.html\" rel=\"nofollow noreferrer\">here</a>"}, {"owner": {"reputation": 65820, "user_id": 1741542, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QdVqh.jpg?s=128&g=1", "display_name": "Olaf Dietsche", "link": "https://stackoverflow.com/users/1741542/olaf-dietsche"}, "edited": false, "score": 1, "creation_date": 1559676073, "post_id": 56449053, "comment_id": 99493473, "body": "Since you already use docker, try running the application with valgrind or some other memory debugger you&#39;re comfortable with. This might give more of a clue than poking around with gdb."}, {"owner": {"reputation": 591, "user_id": 4054546, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78aa1f3e1fc65e8b2e8d67f34689fd81?s=128&d=identicon&r=PG", "display_name": "Shawn", "link": "https://stackoverflow.com/users/4054546/shawn"}, "edited": false, "score": 0, "creation_date": 1559678914, "post_id": 56449053, "comment_id": 99494605, "body": "Along with Olaf&#39;s comment - It sounds like it&#39;s worth investigating other means of debugging.  If you&#39;re app is 2Million+ lines of code, surely it&#39;s under some sore of version control - may be worth trying a few changesets (or git bisect or equivalent) to see if you can find when/where the problem was introduced."}], "owner": {"reputation": 177, "user_id": 5557298, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cec1dd587121708b8ee42bcf99c07f9?s=128&d=identicon&r=PG&f=1", "display_name": "Alex A", "link": "https://stackoverflow.com/users/5557298/alex-a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 158, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1559670805, "creation_date": 1559670805, "question_id": 56449053, "link": "https://stackoverflow.com/questions/56449053/application-runs-fine-on-its-own-segmentation-faults-when-running-gdb", "title": "Application runs fine on its own, segmentation faults when running GDB", "body": "<p>I have a C application which is compiled to run on redhat linux architecture, which runs just fine during normal execution. However, as soon as I start trying to debug it using GDB, it crashes: <code>Child terminated with signal = 0xb (SIGSEGV).</code> </p>\n\n<p>The thing is that there are some caveats here - it is a linux application, but I am debugging remotely using gdbserver from a windows machine. I followed the steps in this article: <a href=\"https://www.linux.com/news/remote-cross-target-debugging-gdb-and-gdbserver\" rel=\"nofollow noreferrer\">https://www.linux.com/news/remote-cross-target-debugging-gdb-and-gdbserver</a>, which basically state that I need to compile a cross-platform version of GDB that will run on Windows but can debug Linux applications.  I have done this. The application is running inside a docker container on my local machine at which point I have run gdbserver on the container. I have created the cross-platform GDB executable and I am running it, connecting to the gdbserver on the docker container.</p>\n\n<p>It can attach the breakpoints meaning it is finding the symbols just fine, yet as soon as the application starts doing anything, it crashes due to segfault.</p>\n\n<p>The thing here is that I know it's somehow related to the cross-platform-ness of the GDB executable. If I run the regular GDB from the Windows Subsystem for Linux and connect to the gdbserver using that, it works just fine, yet the cross-platform compiled GDB causes segfaults. So, does anyone have any clues about what I might be able to do about this? </p>\n\n<p>The whole point of doing this is to be able to debug using an IDE (preferably VSCode) which is why I need to use the cross-platform GDB executable and can't just use the Windows Subsystem for Linux GDB. </p>\n\n<p>Any help would be greatly appreciated.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 3, "creation_date": 1559668847, "post_id": 56448605, "comment_id": 99490626, "body": "Your title has nothing to do with the problem. You are passing <code>a[n]</code> when need to pass <code>a</code>. Also I don&#39;t see how your loops in the functions are supposed to terminate."}, {"owner": {"reputation": 25, "user_id": 10760911, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4IMLD.jpg?s=128&g=1", "display_name": "Tr\u01b0\u01a1ng Qu\u1ed1c Qu&#226;n", "link": "https://stackoverflow.com/users/10760911/tr%c6%b0%c6%a1ng-qu%e1%bb%91c-qu%c3%a2n"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1559669260, "post_id": 56448605, "comment_id": 99490789, "body": "Hello Eugene, may I ask what you meant by passing? And the loop are supposed to run infinitely since i want to make a program that can sort through arrays of all sizes. Thank you for helping!"}, {"owner": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 1, "creation_date": 1559669380, "post_id": 56448605, "comment_id": 99490840, "body": "Running infinitely doesn&#39;t mean that it will work on all sizes. It means that it will keep running and read past the end of the array."}, {"owner": {"reputation": 12119, "user_id": 5265292, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/0b9b1031971201aa02e13287af690946?s=128&d=identicon&r=PG&f=1", "display_name": "grek40", "link": "https://stackoverflow.com/users/5265292/grek40"}, "edited": false, "score": 0, "creation_date": 1559669406, "post_id": 56448605, "comment_id": 99490854, "body": "&quot;passing&quot; refers to the point, where you call a function with some arguments like in <code>arrangef(a[n]);</code>. There, you are <i>passing</i> <code>a[n]</code> to the function, so the value can be used inside."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1559669408, "post_id": 56448605, "comment_id": 99490856, "body": "Your functions are expected to take an array as argument but you pass it an <code>int</code> instead (<code>a[n]</code> is an <i>element</i> - which is out of bounds, by the way - of <code>a</code>). And your loops can&#39;t run indefinitely as it will obviously access the arrays out of bounds. and won&#39;t terminate."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1559669490, "post_id": 56448605, "comment_id": 99490883, "body": "You need to learn some basics. Your function expect the pointer but you pass the integer instead. This integer will be used as a nonsense pointer in the infinitive loop."}, {"owner": {"reputation": 12119, "user_id": 5265292, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/0b9b1031971201aa02e13287af690946?s=128&d=identicon&r=PG&f=1", "display_name": "grek40", "link": "https://stackoverflow.com/users/5265292/grek40"}, "edited": false, "score": 0, "creation_date": 1559669748, "post_id": 56448605, "comment_id": 99490968, "body": "Since you say you have a working program (1 function for all), your question seems to be, how to refactor a specific piece of code into a separate function?"}, {"owner": {"reputation": 25, "user_id": 10760911, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4IMLD.jpg?s=128&g=1", "display_name": "Tr\u01b0\u01a1ng Qu\u1ed1c Qu&#226;n", "link": "https://stackoverflow.com/users/10760911/tr%c6%b0%c6%a1ng-qu%e1%bb%91c-qu%c3%a2n"}, "edited": false, "score": 0, "creation_date": 1559669852, "post_id": 56448605, "comment_id": 99491018, "body": "I see. Thank you all. I wonder, is it impossible to design a program that sorts arrays of desired size? Since many said that if I don&#39;t establish an upper boundary, I can&#39;t stop the program."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1559669898, "post_id": 56448605, "comment_id": 99491039, "body": "Of course it is possible. Just pass the size to the function."}, {"owner": {"reputation": 25, "user_id": 10760911, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4IMLD.jpg?s=128&g=1", "display_name": "Tr\u01b0\u01a1ng Qu\u1ed1c Qu&#226;n", "link": "https://stackoverflow.com/users/10760911/tr%c6%b0%c6%a1ng-qu%e1%bb%91c-qu%c3%a2n"}, "reply_to_user": {"reputation": 12119, "user_id": 5265292, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/0b9b1031971201aa02e13287af690946?s=128&d=identicon&r=PG&f=1", "display_name": "grek40", "link": "https://stackoverflow.com/users/5265292/grek40"}, "edited": false, "score": 0, "creation_date": 1559670081, "post_id": 56448605, "comment_id": 99491120, "body": "@grek40, yes, I just can&#39;t seem to factor it. P__J__, you see, our syllabus focuses heavily on the thought process instead of the syntax, so I lack some serious skills. I&#39;m compensating by reading K&amp;R and I&#39;m watching CS50. But I&#39;m not sure if that&#39;s enough."}, {"owner": {"reputation": 25, "user_id": 10760911, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4IMLD.jpg?s=128&g=1", "display_name": "Tr\u01b0\u01a1ng Qu\u1ed1c Qu&#226;n", "link": "https://stackoverflow.com/users/10760911/tr%c6%b0%c6%a1ng-qu%e1%bb%91c-qu%c3%a2n"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1559670286, "post_id": 56448605, "comment_id": 99491208, "body": "@EugeneSh. well yes :))))), but I want the user to decide how big the array they want to sort. Should I, instead of using 1 variable, use 2 variables, like: void arranged (int n, int a[n])?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1559670624, "post_id": 56448605, "comment_id": 99491326, "body": "This would be one of approaches."}, {"owner": {"reputation": 25, "user_id": 10760911, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4IMLD.jpg?s=128&g=1", "display_name": "Tr\u01b0\u01a1ng Qu\u1ed1c Qu&#226;n", "link": "https://stackoverflow.com/users/10760911/tr%c6%b0%c6%a1ng-qu%e1%bb%91c-qu%c3%a2n"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1559671212, "post_id": 56448605, "comment_id": 99491556, "body": "@EugeneSh., I tried, but lo and behold, it still crashed. I used 2 variables to store the size of array and the number of loops and yet..."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1559671324, "post_id": 56448605, "comment_id": 99491613, "body": "Programs crash for different reasons. We can&#39;t help you with code we don&#39;t see. You can post another question about that one"}, {"owner": {"reputation": 25, "user_id": 10760911, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4IMLD.jpg?s=128&g=1", "display_name": "Tr\u01b0\u01a1ng Qu\u1ed1c Qu&#226;n", "link": "https://stackoverflow.com/users/10760911/tr%c6%b0%c6%a1ng-qu%e1%bb%91c-qu%c3%a2n"}, "edited": false, "score": 0, "creation_date": 1559671401, "post_id": 56448605, "comment_id": 99491644, "body": "Of course. Thank you all so much for helping :)))))"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1559746743, "post_id": 56448605, "comment_id": 99517691, "body": "OT: for ease of readability and understanding: 1) follow the axiom:  <i>only one statement per line and (at most) one variable declaration per statement.</i>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1559747014, "post_id": 56448605, "comment_id": 99517862, "body": "Each of the sub functions needs two parameters: 1) a pointer to the first byte of the array and 2) the number of elements in the array.   Note: <code>a[n]</code> is the contents of the memory just past the end of the array which does no good.  Suggest: in fuinction: <code>main()</code> <code>arrangef(a, n)</code> and <code>arrangef(a, n);</code>  Note: the name of an array, in C, degrades to the address of the first byte of the array"}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 10760911, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4IMLD.jpg?s=128&g=1", "display_name": "Tr\u01b0\u01a1ng Qu\u1ed1c Qu&#226;n", "link": "https://stackoverflow.com/users/10760911/tr%c6%b0%c6%a1ng-qu%e1%bb%91c-qu%c3%a2n"}, "edited": false, "score": 0, "creation_date": 1559669451, "post_id": 56448690, "comment_id": 99490873, "body": "Hello alinsoar, I wanted to make a program that can sort through arrays of all sizes, hence I left the upper bound open. Is it something coders frown upon?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1559669539, "post_id": 56448690, "comment_id": 99490896, "body": "&quot;frown upon&quot;? Non-terminating programs are useless. Programs accessing arrays out of bounds are both incorrect and have undefined behavior (well.. they mostly crash)."}, {"owner": {"reputation": 13124, "user_id": 1419272, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dcbff46aa5cd0a98d13d76595b3375f0?s=128&d=identicon&r=PG", "display_name": "alinsoar", "link": "https://stackoverflow.com/users/1419272/alinsoar"}, "reply_to_user": {"reputation": 25, "user_id": 10760911, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4IMLD.jpg?s=128&g=1", "display_name": "Tr\u01b0\u01a1ng Qu\u1ed1c Qu&#226;n", "link": "https://stackoverflow.com/users/10760911/tr%c6%b0%c6%a1ng-qu%e1%bb%91c-qu%c3%a2n"}, "edited": false, "score": 2, "creation_date": 1559670073, "post_id": 56448690, "comment_id": 99491117, "body": "@Tr\u01b0\u01a1ngQu\u1ed1cQu&#226;n You do not set any terminating condition inside your for-loop, so the for-loop will grow <code>j</code> indefinitely.  In the moment when <code>j&gt;n</code> the behavior is undefined.  It crashes.  You need to set <code>for (j=1;j&lt;n;j++)</code> and pass <code>n</code> as parameter to <code>arrangef </code>."}], "tags": [], "owner": {"reputation": 13124, "user_id": 1419272, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dcbff46aa5cd0a98d13d76595b3375f0?s=128&d=identicon&r=PG", "display_name": "alinsoar", "link": "https://stackoverflow.com/users/1419272/alinsoar"}, "is_accepted": false, "score": 1, "last_activity_date": 1559671082, "last_edit_date": 1559671082, "creation_date": 1559669168, "answer_id": 56448690, "question_id": 56448605, "link": "https://stackoverflow.com/questions/56448605/is-there-a-way-to-not-use-pointer-in-returning-array-warning-passing-argument/56448690#56448690", "title": "Is there a way to not use pointer in returning array? (warning: passing argument 1 of &#39;arrangef&#39; makes pointer from integer without a cast.)", "body": "<pre><code>for (j=1;;j++){\n</code></pre>\n\n<p>This line will loop forever and will access <code>*(a+j)</code> in <code>a[i] = a[j]</code> outside the bounds of <code>a</code>.  Similarly with three other loops in your code.  Specify an upper bound:</p>\n\n<pre><code>for (j = 1; j &lt; n; j++) {\n</code></pre>\n\n<p>You'll need to pass the size of the array to the function too, and call it with <code>arrangef(a, n);</code>.  At the moment, you are passing the value one after the end of the array to the function, which is expecting a pointer, not a value.</p>\n"}, {"tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": true, "score": 1, "last_activity_date": 1559684263, "creation_date": 1559684263, "answer_id": 56451681, "question_id": 56448605, "link": "https://stackoverflow.com/questions/56448605/is-there-a-way-to-not-use-pointer-in-returning-array-warning-passing-argument/56451681#56451681", "title": "Is there a way to not use pointer in returning array? (warning: passing argument 1 of &#39;arrangef&#39; makes pointer from integer without a cast.)", "body": "<p>To pass an <em>array</em> to a function, just specify the array name<sup>1</sup>:</p>\n\n<pre><code>arrangef( a );\n...\narrangeb( a );\n</code></pre>\n\n<p><code>a[n]</code> specifies a single element of the array, and it's one past the <em>last</em> element in the array, so you're passing an expression of the wrong type (the <code>arrange*</code> functions expect <code>int *</code>, you're passing <code>int</code>) and it's outside the bounds of the array, so the value isn't known.  </p>\n\n<p>Except when it is the operand of the <code>sizeof</code> or unary <code>&amp;</code> operators, or is a string literal used to initialize a character array in a declaration, an <em>expression</em> of type \"N-element array of <code>T</code>\" is converted (\"decays\") to an expression of type \"pointer to <code>T</code>\", and the value of the expression is the address of the first element of the array.</p>\n\n<p>So when you call</p>\n\n<pre><code>arrangef( a );\n</code></pre>\n\n<p>the expression <code>a</code> is implicitly converted from \"<code>n</code>-element array of <code>int</code>\" to \"pointer to <code>int</code>\", and the value of the expression is the address of <code>a[0]</code>, so what <code>arrangef</code> actually receives is a pointer value.</p>\n\n<p>In a function parameter declaration, <code>T a[N]</code> and <code>T a[]</code> are \"adjusted\" to <code>T *a</code> - all three declare <code>a</code> as a pointer to <code>T</code>.  </p>\n\n<p>Since all the function receives is the address of the first element of the array, you must also either pass the number of elements as a separate parameter, or one element will have to contain a sentinel value that marks the end of the data (such as the 0 terminator in strings).  In your case, you need to pass the size separately:</p>\n\n<pre><code>void arrangef( int *a, size_t n ) // or int a[]\n{\n  for ( int i = 0; i &lt; n; i++ ) // don't loop past the last element in the array\n  {\n    for ( int j = i; j &lt; n; j++ ) \n    {\n      int tmp = a[i];\n      a[i] = a[j];\n      a[j] = tmp;\n    }\n  }\n}\n</code></pre>\n\n<p><code>arrangeb</code> will look the same, just with the different ordering.</p>\n\n<p><code>for( i = 0; ; i++ )</code> will loop \"forever\" - it will loop past the end of your array and eventually into memory that you don't own, leading to a runtime error.  <code>i</code> will also eventually overflow, and the behavior on signed integer overflow isn't well-defined.  Basically, that loop <em>will</em> blow up.  </p>\n\n<p><hr>\n<sup></p>\n\n<ol>\n<li>Actually, you would pass any <em>expression</em> of array type, which gets converted to a pointer type, but for now we'll just stick with the name.\n</ol>\n\n<p></sup></p>\n"}], "owner": {"reputation": 25, "user_id": 10760911, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4IMLD.jpg?s=128&g=1", "display_name": "Tr\u01b0\u01a1ng Qu\u1ed1c Qu&#226;n", "link": "https://stackoverflow.com/users/10760911/tr%c6%b0%c6%a1ng-qu%e1%bb%91c-qu%c3%a2n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 56451681, "answer_count": 2, "score": 2, "last_activity_date": 1559684263, "creation_date": 1559668774, "last_edit_date": 1559670889, "question_id": 56448605, "link": "https://stackoverflow.com/questions/56448605/is-there-a-way-to-not-use-pointer-in-returning-array-warning-passing-argument", "title": "Is there a way to not use pointer in returning array? (warning: passing argument 1 of &#39;arrangef&#39; makes pointer from integer without a cast.)", "body": "<p>I tried to write 2 subprograms to arrange an array in ascending and descending order, but it gave me this problem with pointers and cast. Is there a way to go around this?</p>\n\n<p>I tried to put all codes into one big program and it works flawlessly.\nI tried to cast pointers in the subprograms but it didn't work.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\nvoid arrangef (int a[]){\n    int i, j, temp;\n    for (i=0;;i++){\n        for (j=1;;j++){\n            if (a[i]&gt;a[j]) {\n                temp = a[i];\n                a[i] = a[j];\n                a[j] = temp;\n            }\n        }\n    }\n}\n\nvoid arrangeb (int a[]){\n    int i, j, temp;\n    for (i=0;;i++){\n        for (j=1;;j++){\n            if (a[i]&gt;a[j]) {}\n                else {\n                    temp = a[i];\n                    a[i] = a[j];\n                    a[j] = temp;\n            }\n        }\n    }\n}\n\nint main () {\n    int i, n;\n    printf(\"What is the size of your array?\\t\"); scanf(\"%d\",&amp;n);\n    int a[n];\n    for (i=0;i&lt;n;i++) {\n        printf(\"\\nInsert element #%d of array\\t\",i+1); scanf(\"%d\",&amp;a[i]);\n    }\n    printf(\"\\n\\n\");\n    for (i=0;i&lt;n;i++) {\n        printf(\"%d\\t\",a[i]);}\n\n    printf(\"\\n\");\n\n    arrangef(a[n]);\n    for (i=0;i&lt;n;i++) {\n        printf(\"%d\\t\",a[i]);}\n    printf(\"\\n\");\n\n    arrangeb(a[n]);\n    for (i=0;i&lt;n;i++) {\n        printf(\"%d\\t\",a[i]);\n    }\n}\n</code></pre>\n\n<p>I expect the output to be 3 lists of number, the original, the ascending arranged and the descending arrange, but the program crashes.</p>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 8627, "user_id": 59314, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/24424c3c34f1dd023613c34b627d08f4?s=128&d=identicon&r=PG", "display_name": "OrElse", "link": "https://stackoverflow.com/users/59314/orelse"}, "reply_to_user": {"reputation": 1924, "user_id": 2669042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c66a47707c3d1748c9977727ddfa4d50?s=128&d=identicon&r=PG", "display_name": "xing", "link": "https://stackoverflow.com/users/2669042/xing"}, "edited": false, "score": 0, "creation_date": 1559667440, "post_id": 56448233, "comment_id": 99490046, "body": "@xing It compiles but is this byreference or value?"}, {"owner": {"reputation": 8627, "user_id": 59314, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/24424c3c34f1dd023613c34b627d08f4?s=128&d=identicon&r=PG", "display_name": "OrElse", "link": "https://stackoverflow.com/users/59314/orelse"}, "reply_to_user": {"reputation": 1924, "user_id": 2669042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c66a47707c3d1748c9977727ddfa4d50?s=128&d=identicon&r=PG", "display_name": "xing", "link": "https://stackoverflow.com/users/2669042/xing"}, "edited": false, "score": 0, "creation_date": 1559667886, "post_id": 56448233, "comment_id": 99490234, "body": "@xing i am sorry but i do not quite understand. This way the KAL_P_X, KAL_P_Y and KAL_P_Z won&#39;t have the same value? I would love to change the value of the argument within the function. That&#39;s why i though of using a pointer in argument"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 2, "creation_date": 1559668122, "post_id": 56448233, "comment_id": 99490342, "body": "I would recommend reducing the amount of <code>*</code> and <code>&amp;</code> used by changing the prototype of <code>kalman</code> to <code>float kalman(float P[2][2], float newAngle, float newRate)</code>, and call it like <code>float Angle.GX = kalman(KAL_P_X, Angle.AX, Raw.GX);</code>. Within <code>kalman</code>, accesses to <code>P[i][j]</code> will access <code>KAL_P_X[i][j]</code>. The parameter <code>float P[2][2]</code> is automatically adjusted to <code>float (*P)[2]</code>. In the function call, <code>KAL_P_X</code> is converted to a pointer to its first element of type <code>float [2]</code>, so the pointer is of type <code>float (*)[2]</code>, which matches the type of <code>P</code>."}], "owner": {"reputation": 8627, "user_id": 59314, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/24424c3c34f1dd023613c34b627d08f4?s=128&d=identicon&r=PG", "display_name": "OrElse", "link": "https://stackoverflow.com/users/59314/orelse"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "closed_date": 1559667250, "answer_count": 0, "score": 0, "last_activity_date": 1559668017, "creation_date": 1559667090, "last_edit_date": 1559668017, "question_id": 56448233, "link": "https://stackoverflow.com/questions/56448233/how-can-i-pass-a-two-dimensional-array-as-an-argument-in-c", "closed_reason": "Duplicate", "title": "How can i pass a two dimensional array as an argument in C?", "body": "<p>Given the following 2d arrays</p>\n\n<pre><code>float KAL_P_X[2][2];\nfloat KAL_P_Y[2][2];\nfloat KAL_P_Z[2][2];\n</code></pre>\n\n<p>and the function</p>\n\n<pre><code>float kalman(float * P[2][2], float newAngle, float newRate)\n{\n P[0][0] = 1.0f;\n P[0][1] = 2.0f;\n P[1][0] = 1.0f;\n P[1][1] = 2.0f;\n return 1.0f;\n};\n</code></pre>\n\n<p>i get the error </p>\n\n<pre><code>cannot convert 'float (*)[2][2]' to \n'float* (*)[2]' for argument '1' to 'float kalman(float* (*)[2], float, float)'\n</code></pre>\n\n<p>while using</p>\n\n<pre><code>  float Angle.GX =  kalman(&amp;KAL_P_X, Angle.AX, Raw.GX);\n  float Angle.GY =  kalman(&amp;KAL_P_Y, Angle.AY, Raw.GY);\n  float Angle.GZ =  kalman(&amp;KAL_P_Z, Angle.AZ, Raw.GZ);\n</code></pre>\n\n<p>So, what am i doing wrong here?</p>\n"}, {"tags": ["java", "c", "performance", "file-io", "jvm"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1559669137, "post_id": 56447869, "comment_id": 99490735, "body": "It may just be that the debug symbols for your C library have not been installed.  These are packaged separately from the library itself in some Linux distributions and maybe in other environments.  On RedHat-family Linuxes, for example, you would want the package glibc-debuginfo.  Alternatively, you may need to <a href=\"https://stackoverflow.com/q/10000335/2402272\">cause a special version of the C library to be used</a>.  In one of these ways, it should be possible to make the wanted information available to <code>gdb</code>."}, {"owner": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1559690617, "post_id": 56447869, "comment_id": 99498035, "body": "@JohnBollinger It turned out to be the case. I did not know about where debug info come from before reading about <code>.symtab</code> and <code>.dynsym</code> sections so did not checked them... Also <code>&#47;usr&#47;lib&#47;debug</code> did not contain the package."}], "answers": [{"comments": [{"owner": {"reputation": 77832, "user_id": 3448419, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/54njx.png?s=128&g=1", "display_name": "apangin", "link": "https://stackoverflow.com/users/3448419/apangin"}, "edited": false, "score": 1, "creation_date": 1559669841, "post_id": 56448740, "comment_id": 99491009, "body": "@SomeName BTW, have you tried <a href=\"https://github.com/jvm-profiling-tools/async-profiler\" rel=\"nofollow noreferrer\">async-profiler</a>? It also relies on perf-events, but unlike perf it is Java friendly, i.e. can show mixed Java+native+kernel stack traces."}, {"owner": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "edited": false, "score": 0, "creation_date": 1559685481, "post_id": 56448740, "comment_id": 99496940, "body": "No, not really tried, but heard about it, of course. Thank you."}], "tags": [], "owner": {"reputation": 77832, "user_id": 3448419, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/54njx.png?s=128&g=1", "display_name": "apangin", "link": "https://stackoverflow.com/users/3448419/apangin"}, "is_accepted": true, "score": 2, "last_activity_date": 1559669407, "creation_date": 1559669407, "answer_id": 56448740, "question_id": 56447869, "link": "https://stackoverflow.com/questions/56447869/jni-function-calls-some-libc-function-which-gdb-does-not-know-about/56448740#56448740", "title": "jni function calls some libc function which gdb does not know about", "body": "<p>Apparently libc on your system does not contain debug symbols (there is no <code>.symtab</code> section in the shared library). Therefore gdb shows the nearest exported symbol from <code>.dynsym</code>, which has nothing to do with the actual hottest function.</p>\n\n<p><code>rep movsb</code> instruction suggests this fragment is a part of <code>memcpy</code> implementation.</p>\n\n<p>Install <code>libc-dbg</code> package (or how it is called in your Linux distribution).</p>\n\n<p>E.g. on my Ubuntu 18.04 the address <code>__nss_group_lookup+0x24ddc</code> indeed points to <code>memcpy</code> internals:</p>\n\n<pre><code>(gdb) disas __nss_group_lookup+0x24ddc\nDump of assembler code for function __memmove_avx_unaligned_erms:\n   0x00007ffffef7ead0 &lt;+0&gt;:     mov    %rdi,%rax\n   ...\n   0x00007ffffef7eb1c &lt;+76&gt;:    mov    %rdx,%rcx\n   0x00007ffffef7eb1f &lt;+79&gt;:    rep movsb %ds:(%rsi),%es:(%rdi)\n   0x00007ffffef7eb21 &lt;+81&gt;:    retq\n</code></pre>\n"}], "owner": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 145, "favorite_count": 0, "accepted_answer_id": 56448740, "answer_count": 1, "score": 0, "last_activity_date": 1559669407, "creation_date": 1559665550, "last_edit_date": 1559666371, "question_id": 56447869, "link": "https://stackoverflow.com/questions/56447869/jni-function-calls-some-libc-function-which-gdb-does-not-know-about", "title": "jni function calls some libc function which gdb does not know about", "body": "<p>I have a simple JNI function which I use to read data from file into <code>byte[]</code> from C code <code>UnixUtil.unsafeReadToByteArray</code> which is implemented as:</p>\n\n<pre><code>JNIEXPORT jlong JNICALL Java_net_xxxxxxx_UnixUtil_unsafeReadToByteArray\n  (JNIEnv *e, jclass jc, jint fd, jbyteArray array, jlong offset, jlong count){\n  signed char *array_native_ptr = (*e) -&gt; GetByteArrayElements(e, array, NULL);\n  ssize_t bytes_read = read(fd, array_native_ptr + offset, (size_t) count);\n  (*e) -&gt; ReleaseByteArrayElements(e, array, array_native_ptr, 0);\n  return bytes_read;\n}\n</code></pre>\n\n<p>Profiling a java application running the function showed up some unclear result. Here is the top:</p>\n\n<p><a href=\"https://i.stack.imgur.com/FEMAk.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/FEMAk.png\" alt=\"enter image description here\"></a></p>\n\n<p>One of the hottest thing turned out to be some instruction by address <code>0x18eb1f</code> which is from <code>libc-2.27.so</code>. I wanted to understand what it was but gdb does not know about it</p>\n\n<pre><code>(gdb) disas 0x18eb1f\nNo function contains specified address\n</code></pre>\n\n<p>Objdump'ing libc to grep the address I found that</p>\n\n<pre><code>18eb0b:       72 0f                   jb     18eb1c &lt;__nss_group_lookup@GLIBC_2.2.5+0x24ddc&gt;\n[...]\n18eb1c:       48 89 d1                mov    %rdx,%rcx\n18eb1f:       f3 a4                   rep movsb %ds:(%rsi),%es:(%rdi)\n</code></pre>\n\n<p>Which looks like it is a part of <code>__nss_group_lookup</code> while <code>__nss_group_lookup</code> seems not to contain the address:</p>\n\n<pre><code>(gdb) disas __nss_group_lookup\nDump of assembler code for function __nss_passwd_lookup:\n   0x0000000000169d40 &lt;+0&gt;:     mov    rax,QWORD PTR [rip+0x281121]        # 0x3eae68\n   0x0000000000169d47 &lt;+7&gt;:     mov    DWORD PTR fs:[rax],0x26\n   0x0000000000169d4e &lt;+14&gt;:    mov    eax,0xffffffff\n   0x0000000000169d53 &lt;+19&gt;:    ret    \nEnd of assembler dump. making the things more unclear then it was before.\n</code></pre>\n\n<p>making the things more unclear then before.</p>\n\n<p><strong><em>Question:</em></strong> Can you give any hint where to look at to understand why is the instruction belonging to <code>__nss_group_lookup</code> is the hottest while calling to <code>jni_GetByteArrayElements</code>/<code>jni_ReleaseByteArrayElements</code> and what it actually is.</p>\n\n<p>My expectation was since <code>jni_GetByteArrayElements</code>/<code>jni_ReleaseByteArrayElements</code> copies the <code>byte[]</code> from Java heap to C heap via <code>memcpy</code> it would be the hottest one.</p>\n"}, {"tags": ["php", "c", "pthreads", "systemctl"], "comments": [{"owner": {"reputation": 1263, "user_id": 7099984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb73d10a9ce4b91379b514722601f9ee?s=128&d=identicon&r=PG&f=1", "display_name": "myxaxa", "link": "https://stackoverflow.com/users/7099984/myxaxa"}, "edited": false, "score": 0, "creation_date": 1559665788, "post_id": 56447573, "comment_id": 99489257, "body": "maybe sleep using microseconds instead seconds :)"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1559669904, "post_id": 56447573, "comment_id": 99491041, "body": "Do the first set of log outputs all appear immediately after starting the program?  Or could it be that they are delayed for, say, 100 seconds or longer?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1559670178, "post_id": 56447573, "comment_id": 99491166, "body": "In any case, when you say &quot;i transformed this program into a systemctl service&quot;, I think you&#39;re saying that the code you&#39;ve presented is <i>not</i> the code for a program that actually exhibited the problem for you.  If so, then that really won&#39;t do.  To answer questions about program misbehaviors we expect and typically <i>need</i> a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> demonstrating the problem."}, {"owner": {"reputation": 501, "user_id": 4508962, "user_type": "registered", "profile_image": "https://graph.facebook.com/1257600928/picture?type=large", "display_name": "Jerem Lachkar", "link": "https://stackoverflow.com/users/4508962/jerem-lachkar"}, "reply_to_user": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "edited": false, "score": 0, "creation_date": 1559730000, "post_id": 56447573, "comment_id": 99508820, "body": "@Bodo no absolute path for php script, but php program is called because I have in the log &#171; start : retrieving notifications &#187; which is output of php script. The problem here is that my thread are being called 100 times in the same second, while I put a &#171; sleep(1) &#187; after each thread creation. Maybe it is due to systemd service config file ?"}, {"owner": {"reputation": 501, "user_id": 4508962, "user_type": "registered", "profile_image": "https://graph.facebook.com/1257600928/picture?type=large", "display_name": "Jerem Lachkar", "link": "https://stackoverflow.com/users/4508962/jerem-lachkar"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1559730688, "post_id": 56447573, "comment_id": 99509147, "body": "@JohnBollinger Ok i will try to add a mre to enable you to reproduce it"}, {"owner": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "edited": false, "score": 1, "creation_date": 1559736006, "post_id": 56447573, "comment_id": 99511506, "body": "@JeremLachkar Maybe some buffering is involved. It is not clear that all <code>[SERVICE]</code> messages have been printed in the same second. See <code>[SE83728128 | START : Retrieving all new notifications..</code> which is probably <code>[SERVICE] start php script on thread ...</code> (or <code>...stop php...</code> interlaced with output from your PHP script. Try <code>fflush(stdout)</code> after every <code>printf</code> and <code>fflush(stderr);</code> after every <code>fprintf(stderr,...)</code>"}, {"owner": {"reputation": 501, "user_id": 4508962, "user_type": "registered", "profile_image": "https://graph.facebook.com/1257600928/picture?type=large", "display_name": "Jerem Lachkar", "link": "https://stackoverflow.com/users/4508962/jerem-lachkar"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1559740215, "post_id": 56447573, "comment_id": 99513839, "body": "@JohnBollinger I just added the minimal reproductible exemple with a sample long php script"}, {"owner": {"reputation": 501, "user_id": 4508962, "user_type": "registered", "profile_image": "https://graph.facebook.com/1257600928/picture?type=large", "display_name": "Jerem Lachkar", "link": "https://stackoverflow.com/users/4508962/jerem-lachkar"}, "reply_to_user": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "edited": false, "score": 0, "creation_date": 1559740531, "post_id": 56447573, "comment_id": 99514011, "body": "@Bodo Thank you!! That was that, but I don&#39;t understand at all why this solution works. Why stdout buffer get sent to screen &quot;normally&quot;, after each printf, when executing ./start and why, when I run it as systemd service, stdout get flushed so randomly ?"}, {"owner": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "edited": false, "score": 1, "creation_date": 1559741583, "post_id": 56447573, "comment_id": 99514604, "body": "@JeremLachkar see <a href=\"https://groups.google.com/d/msg/comp.lang.c/dvRKt-iuO40/qtYVQ6eGBNMJ\" rel=\"nofollow noreferrer\">groups.google.com/d/msg/comp.lang.c/dvRKt-iuO40/qtYVQ6eGBNMJ</a> &quot;Unix convention is that stdin and stdout are line-buffered when associated with a terminal, and fully-buffered (aka block-buffered) otherwise. stderr is always unbuffered.&quot; (That means you don&#39;t need <code>fflush(stderr)</code>, but it shouldn&#39;t hurt.)"}, {"owner": {"reputation": 501, "user_id": 4508962, "user_type": "registered", "profile_image": "https://graph.facebook.com/1257600928/picture?type=large", "display_name": "Jerem Lachkar", "link": "https://stackoverflow.com/users/4508962/jerem-lachkar"}, "edited": false, "score": 0, "creation_date": 1559741659, "post_id": 56447573, "comment_id": 99514658, "body": "Thanks I learned something today haha:)"}], "owner": {"reputation": 501, "user_id": 4508962, "user_type": "registered", "profile_image": "https://graph.facebook.com/1257600928/picture?type=large", "display_name": "Jerem Lachkar", "link": "https://stackoverflow.com/users/4508962/jerem-lachkar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 72, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1559740078, "creation_date": 1559664354, "last_edit_date": 1559740078, "question_id": 56447573, "link": "https://stackoverflow.com/questions/56447573/program-executes-differently-when-running-as-systemctl-service", "title": "Program executes differently when running as systemctl service", "body": "<p>I have a PHP script that takes a lot of time to complete (> 1s). I want to execute one script per second, no matter if the previous one has finished running or not. \nFor this, i created a C program with pthread like this : </p>\n\n<pre><code>void *start_instance(void *_args)\n{\n    int id = abs(pthread_self());\n    arg_for_script* args = _args ;\n\n    printf(\"[SERVICE] start php script on thread %d\\n\",id);\n\n    char cmd[200] ;\n\n    sprintf(cmd, \"php -f %s %d\", args-&gt;script_path, id );\n\n    system(cmd);\n\n    printf(\"[SERVICE] end of script on thread %d\\n\", id);\n    /* Pour enlever le warning */\n    pthread_exit(NULL);\n}\n\nint main(int argc, char* argv[])\n{\n\n\n    if(argc &lt; 2)\n    {\n        fprintf(stderr, \"[SERVICE] Path of php script must be filled\\n\");\n        return EXIT_FAILURE;\n    }\n\n    arg_for_script args ;\n    args.script_path = argv[1];\n\n    pthread_attr_t tattr ;\n    pthread_attr_init(&amp;tattr);\n    pthread_attr_getinheritsched(&amp;tattr, PTHREAD_EXPLICIT_SCHED);\n    pthread_attr_getschedpolicy(&amp;tattr, SCHED_RR);\n\n    while(1) {\n        pthread_t thrd;\n\n\n        if(pthread_create(&amp;thrd, &amp;tattr, start_instance, (void *)&amp;args) == -1) {\n            fprintf(stderr, \"[SERVICE] Unable to create thread\\n\");\n            return EXIT_FAILURE;\n        }\n\n\n        sleep(1);\n    }\n\n    pthread_attr_destroy(&amp;tattr);\n    return EXIT_SUCCESS ;\n}\n</code></pre>\n\n<p>if I execute this program from command line : </p>\n\n<pre><code>./this_program path_of_php_script_as_argv.php\n</code></pre>\n\n<p>It execute as excepted, I have an output like this : </p>\n\n<pre><code>[SERVICE] start php script on thread 209983744\n209983744\u00a0| START : Retrieving all new notifications..\n209983744\u00a0| No new notification\n[SERVICE] end of script on thread 209983744\n[SERVICE] start php script on thread 218376448\n218376448\u00a0| START : Retrieving all new notifications..\n218376448\u00a0| No new notification\n[SERVICE] end of script on thread 218376448\n[SERVICE] start php script on thread 226769152\n226769152\u00a0| START : Retrieving all new notifications..\n226769152\u00a0| No new notification\n[SERVICE] end of script on thread 226769152\n[SERVICE] start php script on thread 235161856\n235161856\u00a0| START : Retrieving all new notifications..\n235161856\u00a0| No new notification\n[SERVICE] end of script on thread 235161856\n[SERVICE] start php script on thread 243554560\n243554560\u00a0| START : Retrieving all new notifications..\n243554560\u00a0| No new notification\n[SERVICE] end of script on thread 243554560\n</code></pre>\n\n<p>Now, i transformed this program into a systemctl service to execute it all the time in the background, but when I <code>journalctl --follow</code> (to see systemctl output), here is what I obtain : </p>\n\n<pre><code>Jun 04 15:12:05 vps559055 start[6116]: [SERVICE] start php script on thread 532399872\nJun 04 15:12:05 vps559055 start[6116]: [SERVICE] end of script on thread 532399872\nJun 04 15:12:05 vps559055 start[6116]: [SERVICE] start php script on thread 521811712\nJun 04 15:12:05 vps559055 start[6116]: [SERVICE] end of script on thread 521811712\nJun 04 15:12:05 vps559055 start[6116]: [SERVICE] start php script on thread 513419008\nJun 04 15:12:05 vps559055 start[6116]: [SERVICE] end of script on thread 513419008\nJun 04 15:12:05 vps559055 start[6116]: [SERVICE] start php script on thread 505026304\nJun 04 15:12:05 vps559055 start[6116]: [SERVICE] end of script on thread 505026304\nJun 04 15:12:05 vps559055 start[6116]: [SERVICE] start php script on thread 496633600\n// ..... ~100 times, in the same second ! \n// then, second per second : \nJun 04 15:12:05 vps559055 start[6116]: [SE83728128\u00a0| START : Retrieving all new notifications..\nJun 04 15:12:05 vps559055 start[6116]: 83728128\u00a0| No new notification\nJun 04 15:12:06 vps559055 start[6116]: 75335424\u00a0| START : Retrieving all new notifications..\nJun 04 15:12:06 vps559055 start[6116]: 75335424\u00a0| No new notification\nJun 04 15:12:07 vps559055 start[6116]: 66942720\u00a0| START : Retrieving all new notifications..\nJun 04 15:12:07 vps559055 start[6116]: 66942720\u00a0| No new notification\nJun 04 15:12:08 vps559055 start[6116]: 58550016\u00a0| START : Retrieving all new notifications..\nJun 04 15:12:08 vps559055 start[6116]: 58550016\u00a0| No new notification\nJun 04 15:12:09 vps559055 start[6116]: 50157312\u00a0| START : Retrieving all new notifications..\nJun 04 15:12:09 vps559055 start[6116]: 50157312\u00a0| No new notification\nJun 04 15:12:10 vps559055 start[6116]: 41764608\u00a0| START : Retrieving all new notifications..\nJun 04 15:12:10 vps559055 start[6116]: 41764608\u00a0| No new notification\n</code></pre>\n\n<p>all the C thread are executed the same time (same second on the logs), but the php scripts are executed second per second. Do you know why execution of these program are different ? </p>\n\n<p>EDIT : Reproductible exemple : \nCreate a php script script.php which contain : </p>\n\n<pre><code>$thid = $argv[1]?:null;\necho \"php : START PHP SCRIPT ON THREADID $thid\\n\";\nfor($i = 0; $i &lt; 3000000; $i++); // work .. \necho \"php : END PHP SCRIPT ON THREADID $thid\\n\";\n\nexit ;\n</code></pre>\n\n<p>Create a main.c file containing the code above, and compile it : </p>\n\n<pre><code>gcc main.c -o start -lpthread\n</code></pre>\n\n<p>When you run <code>./start</code> everything is outputted as excepted : </p>\n\n<pre><code>[SERVICE] start php script on thread 861141248\nphp : START PHP SCRIPT ON THREADID 861141248\nphp : END PHP SCRIPT ON THREADID 861141248\n[SERVICE] end of script on thread 861141248\n[SERVICE] start php script on thread 939526400\nphp : START PHP SCRIPT ON THREADID 939526400\nphp : END PHP SCRIPT ON THREADID 939526400\n[SERVICE] end of script on thread 939526400\n</code></pre>\n\n<p>now create a systemd service using this configuration file : </p>\n\n<pre><code>Description=My Service\nAfter=network-online.target\n\n[Service]\nType=simple\nExecStart=/path/to/c/program /path/to/php/script\nRestart=on-failure\n\n# Configures the time to wait before service is stopped forcefully.\nTimeoutStopSec=300\n\n[Install]\nWantedBy=multi-user.target\n</code></pre>\n\n<p>Output should be what I obtain : </p>\n\n<pre><code>Jun 05 13:03:00 vps559055 start[4491]: php : START PHP SCRIPT ON THREADID 1259825408\nJun 05 13:03:00 vps559055 start[4491]: php : END PHP SCRIPT ON THREADID 1259825408\n// about one second later \nJun 05 13:03:01 vps559055 start[4491]: php : START PHP SCRIPT ON THREADID 1268218112\nJun 05 13:03:01 vps559055 start[4491]: php : END PHP SCRIPT ON THREADID 1268218112\n// ...\n// same about 50 times \n// ...\n// then suddenly, i got : \nJun 05 13:03:32 vps559055 start[4491]: [SERVICE] start php script on thread 1175898368\nJun 05 13:03:32 vps559055 start[4491]: [SERVICE] end of script on thread 1175898368\nJun 05 13:03:32 vps559055 start[4491]: [SERVICE] start php script on thread 1184291072\nJun 05 13:03:32 vps559055 start[4491]: [SERVICE] end of script on thread 1184291072\nJun 05 13:03:32 vps559055 start[4491]: [SERVICE] start php script on thread 1192683776\nJun 05 13:03:32 vps559055 start[4491]: [SERVICE] end of script on thread 1192683776\n//...\n// again about 50 times, IN THE SAME SECOND, all this output \n// ...\n</code></pre>\n\n<p>Why output get so disordered when the program is executed as a systemd background service ? ...</p>\n"}, {"tags": ["c", "makefile", "cmake", "clion", "libsodium"], "comments": [{"owner": {"reputation": 2341, "user_id": 3589609, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/VPC24.jpg?s=128&g=1", "display_name": "Joshua Schlichting", "link": "https://stackoverflow.com/users/3589609/joshua-schlichting"}, "edited": false, "score": 0, "creation_date": 1574807415, "post_id": 56447526, "comment_id": 104360033, "body": "I see this is marked as a duplicate, but I&#39;m certainly glad this exists. I had the exact same issue, down the the same library. As I am new to C, I don&#39;t think the linked duplicate would have caught my attention. It is this post that lead to me solving my problem, not the post that this is allegedly a duplicate of.  I wish OP would answer his or her own question in the answer section instead of editing the question, so that others could find this solution more easily."}], "answers": [{"tags": [], "owner": {"reputation": 284, "user_id": 11562467, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dVLZx.png?s=128&g=1", "display_name": "rjg", "link": "https://stackoverflow.com/users/11562467/rjg"}, "is_accepted": false, "score": 1, "last_activity_date": 1559664554, "creation_date": 1559664554, "answer_id": 56447607, "question_id": 56447526, "link": "https://stackoverflow.com/questions/56447526/how-to-add-linker-flags-in-clion/56447607#56447607", "title": "How to add linker flags in CLion", "body": "<p>You can use the usual <code>find_package()</code> or <code>find_library()</code> CMake commands and link it with <code>target_link_libraries()</code>. If you don't want to specify the path manually, there already is a <a href=\"https://github.com/jedisct1/libsodium/blob/master/contrib/Findsodium.cmake\" rel=\"nofollow noreferrer\"><code>Findsodium.cmake</code></a> in the official repository. <a href=\"https://github.com/ruslo/hunter/blob/master/examples/libsodium/CMakeLists.txt\" rel=\"nofollow noreferrer\">Here</a> is one random example of a CMakeLists.txt found on Github.</p>\n"}], "owner": {"reputation": 11, "user_id": 7276240, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-EilRUijSZow/AAAAAAAAAAI/AAAAAAAAAEs/qR4EIHSIRws/photo.jpg?sz=128", "display_name": "SupremeGamer21", "link": "https://stackoverflow.com/users/7276240/supremegamer21"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2529, "favorite_count": 0, "closed_date": 1559665283, "answer_count": 1, "score": 1, "last_activity_date": 1559672700, "creation_date": 1559664161, "last_edit_date": 1559672700, "question_id": 56447526, "link": "https://stackoverflow.com/questions/56447526/how-to-add-linker-flags-in-clion", "closed_reason": "Duplicate", "title": "How to add linker flags in CLion", "body": "<p>Im trying to use libsodium, ive installed the librarys and trying to make the simplests of tests, when making the project using Makefile there are no probkems but when using CLion and Cmake i get \"undefined reference to `sodium_init'\"</p>\n\n<p>Im working on Ubuntu 18.04.\nI found the reason for the error was the need to link to add the -lsodium flag to the linking (adding the flag makes a normal Makefile work)\nas i searched the web for ways to link to an external library using CMake or in CLion i found many solutions that did not work, including :</p>\n\n<ul>\n<li>add_link_options(-lsodium)</li>\n<li>set (CMAKE_STATIC_LINKER_FLAGS \"-lsodium\")</li>\n</ul>\n\n<p>this is the code im trying to compile:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;sodium.h&gt;\n\nint main() \n{\n    if (sodium_init() &lt; 0)\n    {\n        printf(\"sodium init error\");\n    }\n    __uint32_t rand = randombytes_random();\n    printf(\"hello %d, this is a random number \\n\", &amp;rand);\n    return 0;\n}\n</code></pre>\n\n<p>The full error message in CLion looks like this :</p>\n\n<pre><code>MakeFiles/TestC.dir/main.c.o: In function `main':\n/home/--username--/Projects/TestC/main.c:7: undefined reference to `sodium_init'\ncollect2: error: ld returned 1 exit status\nCMakeFiles/TestC.dir/build.make:83: recipe for target 'TestC' failed\nmake[3]: *** [TestC] Error 1\nCMakeFiles/Makefile2:72: recipe for target 'CMakeFiles/TestC.dir/all' failed\nmake[2]: *** [CMakeFiles/TestC.dir/all] Error 2\nCMakeFiles/Makefile2:84: recipe for target 'CMakeFiles/TestC.dir/rule' failed\nmake[1]: *** [CMakeFiles/TestC.dir/rule] Error 2\nMakefile:118: recipe for target 'TestC' failed\nmake: *** [TestC] Error 2\n</code></pre>\n\n<p>EDIT: \nIve solved the problem, after looking at - <a href=\"https://stackoverflow.com/a/43136754/7276240\">https://stackoverflow.com/a/43136754/7276240</a>\nI added the following line to my CMakeLists.txt:\n <code>target_link_libraries(TestC libsodium.a)</code>\nTestC being the name of the executable.</p>\n"}, {"tags": ["c", "security", "encryption", "openssl", "ubuntu-14.10"], "comments": [{"owner": {"reputation": 79299, "user_id": 589259, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vJbKg.jpg?s=128&g=1", "display_name": "Maarten Bodewes", "link": "https://stackoverflow.com/users/589259/maarten-bodewes"}, "edited": false, "score": 1, "creation_date": 1559685760, "post_id": 56447374, "comment_id": 99497035, "body": "What EVP would that be? I don&#39;t see any function starting with <code>EVP_</code> other than <code>EVP_BytesToKey</code> and the encoding / decoding, but not the encryption."}, {"owner": {"reputation": 29, "user_id": 11599880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6549f16f6e52e062a67348fd8cd52498?s=128&d=identicon&r=PG&f=1", "display_name": "moonking1863", "link": "https://stackoverflow.com/users/11599880/moonking1863"}, "reply_to_user": {"reputation": 79299, "user_id": 589259, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vJbKg.jpg?s=128&g=1", "display_name": "Maarten Bodewes", "link": "https://stackoverflow.com/users/589259/maarten-bodewes"}, "edited": false, "score": 0, "creation_date": 1559696277, "post_id": 56447374, "comment_id": 99498983, "body": "Internally the AES_ uses the EVP."}, {"owner": {"reputation": 29, "user_id": 11599880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6549f16f6e52e062a67348fd8cd52498?s=128&d=identicon&r=PG&f=1", "display_name": "moonking1863", "link": "https://stackoverflow.com/users/11599880/moonking1863"}, "reply_to_user": {"reputation": 79299, "user_id": 589259, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vJbKg.jpg?s=128&g=1", "display_name": "Maarten Bodewes", "link": "https://stackoverflow.com/users/589259/maarten-bodewes"}, "edited": false, "score": 0, "creation_date": 1559696314, "post_id": 56447374, "comment_id": 99498993, "body": "Though, I will correct in order to avoid confusion! Thanks for the tip."}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 11599880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6549f16f6e52e062a67348fd8cd52498?s=128&d=identicon&r=PG&f=1", "display_name": "moonking1863", "link": "https://stackoverflow.com/users/11599880/moonking1863"}, "edited": false, "score": 0, "creation_date": 1559807639, "post_id": 56454768, "comment_id": 99536842, "body": "First, thanks for the feedback! I am sorry, I missed out on a few details.  1. I am using openssl version 1.0.1f as included in Ubuntu 14.04 For the cipher type and message digest, here goes: <code>const EVP_CIPHER * CAES::cipher_type = EVP_aes_256_cbc(); const EVP_MD * CAES::msg_digest_type = EVP_sha256(); </code> 2. I haven&#39;t included any code for padding, I did not know this.  3. Understood, I&#39;ll change accordingly.  4. Can you please explain further?  5. I need to get the code working first, then I will definitely fix the leaks/code issues :-)"}, {"owner": {"reputation": 29, "user_id": 11599880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6549f16f6e52e062a67348fd8cd52498?s=128&d=identicon&r=PG&f=1", "display_name": "moonking1863", "link": "https://stackoverflow.com/users/11599880/moonking1863"}, "edited": false, "score": 0, "creation_date": 1559807648, "post_id": 56454768, "comment_id": 99536852, "body": "Can I use <code>PKCS5_PBKDF2_HMAC(const char *pass, int passlen, const unsigned char *salt, int saltlen, int iter, const EVP_MD *digest, int keylen, unsigned char *out)</code> to derive the correct key?  Would I still need to do explicit padding?"}, {"owner": {"reputation": 8340, "user_id": 1645712, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/48781792c1fb7d61086b4fb612938c13?s=128&d=identicon&r=PG", "display_name": "gusto2", "link": "https://stackoverflow.com/users/1645712/gusto2"}, "reply_to_user": {"reputation": 29, "user_id": 11599880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6549f16f6e52e062a67348fd8cd52498?s=128&d=identicon&r=PG&f=1", "display_name": "moonking1863", "link": "https://stackoverflow.com/users/11599880/moonking1863"}, "edited": false, "score": 0, "creation_date": 1559813377, "post_id": 56454768, "comment_id": 99539725, "body": "@moonking1863 You need to use padding to fit the plaintext into the block length (padding has nothing to do with the key generation algorithm).  For key stretching you can use either EVP or PBKDF, but you cannot mix them"}, {"owner": {"reputation": 23625, "user_id": 2868801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ec5567811049b7ce8192be0bc0246d1?s=128&d=identicon&r=PG&f=1", "display_name": "dave_thompson_085", "link": "https://stackoverflow.com/users/2868801/dave-thompson-085"}, "reply_to_user": {"reputation": 29, "user_id": 11599880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6549f16f6e52e062a67348fd8cd52498?s=128&d=identicon&r=PG&f=1", "display_name": "moonking1863", "link": "https://stackoverflow.com/users/11599880/moonking1863"}, "edited": false, "score": 0, "creation_date": 1559878975, "post_id": 56454768, "comment_id": 99564787, "body": "@moonking1863: as I said, BytesToKey with SHA256 is correct for OpenSSL 1.1.0 up but not lower <i>by default</i>, but can be overridden. OpenSSL 1.1.1 but not lower can use PBKDF2(_HMAC) instead of BytesToKey for <code>enc</code> (nonstandardly generating both key and IV, like PKCS5v1/PBKDF1 and BytesToKey do). As gusto2 said, key (and IV) derivation and padding are separate and unrelated."}], "tags": [], "owner": {"reputation": 23625, "user_id": 2868801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ec5567811049b7ce8192be0bc0246d1?s=128&d=identicon&r=PG&f=1", "display_name": "dave_thompson_085", "link": "https://stackoverflow.com/users/2868801/dave-thompson-085"}, "is_accepted": false, "score": 3, "last_activity_date": 1559713480, "last_edit_date": 1559713480, "creation_date": 1559713172, "answer_id": 56454768, "question_id": 56447374, "link": "https://stackoverflow.com/questions/56447374/decrypting-the-openssl-library-generated-cipher-on-the-terminal-and-vice-versa/56454768#56454768", "title": "Decrypting the openssl library generated cipher on the terminal and vice versa", "body": "<p>Your code is not complete, and there are several things not shown which <em>could</em> be wrong, but the things <em>shown</em> that are definitely or probably wrong are:</p>\n\n<ul>\n<li><p>you call <code>EVP_BytesToKey</code> with count=5, when commandline <code>enc</code> uses count=1. In addition you don't show what <code>cipher_type</code> and <code>msg_digest_type</code> are and they could be wrong; in particular, the default digest used for <code>BytesToKey</code> in commandline <code>enc</code> varies depending on the version of OpenSSL, and you didn't say what version(s) you are or will or might be using. Although specifying <code>-md $hash</code> overrides that default, which is a more robust and clearer solution.</p></li>\n<li><p>you don't show where the plaintext comes from, and in particular whether and how you've padded it. Commandline <code>enc</code> by default uses PKCS5/7 padding, and has an option to use no padding, but in that case the plaintext length must always be an exact multiple of 16 -- have you guaranteed that? </p></li>\n<li><p>you use <code>strlen(ciphertext)</code> as the length of the (raw = before base64) ciphertext; this is usually wrong. The ciphertext is effectively random bits, and can easily contain a byte with value 0, giving a strlen() that is too small, but if that doesn't happen it will not necessarily be followed or terminated by a 0 byte, giving a strlen() that is too large.</p></li>\n<li><p>you do not include in the base64 encoding the file header (aka 'magic') required by commandline <code>enc</code> when using salt. The code shown does not add the line breaks required by commandline <code>enc</code> file format, but that could be done elsewhere, and only matters if the values you encrypt (and want to decrypt) are or (ever) can be more than 31 bytes.</p></li>\n<li><p>Also, you call <code>memset (key, 0, sizeof(key))</code> and the same for <code>iv</code> when they are pointers; this clears only the size of the <em>pointer</em>, 4 or 8 bytes on modern systems, not the object pointed to. But since these objects are promptly overwritten by <code>BytesToKey</code>, this mistake doesn't matter.</p></li>\n</ul>\n\n<p>Anyway, here is a minimal-ish code that <em>is</em> complete and produces an output that is decryptable by commandline <code>enc -aes-256-cbc -d -a -k $password</code> with <code>-md sha256</code> for versions below 1.1.0 where that is not the default. For convenience I have limited to 80 bytes input, but it should be obvious how to increase that if desired.</p>\n\n<pre><code>/* SO56447374 */\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;openssl/aes.h&gt;\n#include &lt;openssl/bio.h&gt;\n#include &lt;openssl/err.h&gt;\n#include &lt;openssl/evp.h&gt;\n#include &lt;openssl/rand.h&gt;\n\nvoid err (const char *label){\n  fprintf (stderr, \"%s:\\n\", label); ERR_print_errors_fp (stderr); exit (1);\n}\n\nint main (int argc, char**argv)\n{\n  ERR_load_crypto_strings(); \n  //OPENSSL_add_all_algorithms_noconf(); \n\n  const char * pass = argv[1];\n  unsigned char salt [8], key [32], iv [16],\n        plain [80], buffer [16+96], *cipher = buffer+16;\n  int inlen = fread (plain, 1, 80-1, stdin), pad = 16-inlen%16U;\n  AES_KEY aeskey;\n\n  RAND_bytes (salt, 8);\n  if( !EVP_BytesToKey (EVP_aes_256_cbc(), EVP_sha256(), salt, \n        (unsigned char*)pass, strlen(pass), 1, key, iv) ) err(\"BytesToKey\");\n  AES_set_encrypt_key (key, 256, &amp;aeskey);\n  memset (plain+inlen, pad, pad); // PKCS5/7 \n  AES_cbc_encrypt (plain, cipher, inlen+pad, &amp;aeskey, iv, AES_ENCRYPT);\n  memcpy (buffer+0, \"Salted__\", 8); memcpy (buffer+8, salt, 8);\n  BIO *bio1 = BIO_new (BIO_f_base64()); // does b64 with linebreaks (by default)\n  BIO_push (bio1, BIO_new_fp (stdout, BIO_NOCLOSE));\n  BIO_write (bio1, buffer, 16+inlen+pad);\n  BIO_flush (bio1);\n  BIO_free_all (bio1);\n  return 0;\n}\n\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 11599880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6549f16f6e52e062a67348fd8cd52498?s=128&d=identicon&r=PG&f=1", "display_name": "moonking1863", "link": "https://stackoverflow.com/users/11599880/moonking1863"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 189, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1559713480, "creation_date": 1559663610, "last_edit_date": 1559696570, "question_id": 56447374, "link": "https://stackoverflow.com/questions/56447374/decrypting-the-openssl-library-generated-cipher-on-the-terminal-and-vice-versa", "title": "Decrypting the openssl library generated cipher on the terminal and vice versa", "body": "<p>I have made an implementation using the OpenSSL library to encrypt a password.\nI am able to successfully encrypt and decrypt the password using the library in the code.</p>\n\n<p>However, if I try to decrypt the cipher generated by the Library on a linux system on the terminal the decryption fails.</p>\n\n<p>Encryption:</p>\n\n<pre><code>openssl enc -aes-256-cbc -base64 -salt -k &lt;passphrase&gt; -in plain.txt -out \nencrypt.txt\n</code></pre>\n\n<p>Decryption:</p>\n\n<pre><code>openssl enc -aes-256-cbc -base64 -salt -d -k &lt;passphrase&gt; -in encrypt.txt -out plain.txt\n</code></pre>\n\n<p>Please help.</p>\n\n<p>I have removed salts so as to make the process simpler.\nI have generated sample base64 ciphers on the terminal and tried decrypting with Library, this fails.\nI have tried generating sample base64 ciphers with Library and tried decrypting it  in the terminal, this fails, too!</p>\n\n<pre><code>size_t init_key_iv(const std::string&amp; pass, const unsigned char* salt, unsigned char* key, unsigned char* iv ) {\nsize_t derived_key_size = 0;\n  const unsigned char * pass_key = reinterpret_cast&lt;const unsigned char*&gt;( pass.c_str() );\n  const size_t pass_key_len = pass.size();\n  if(salt &amp;&amp; key &amp;&amp; iv &amp;&amp; pass_key &amp;&amp; pass_key_len &gt; 0) {\n    memset(key, 0, sizeof(key));\n    memset( iv, 0, sizeof(iv));\n    derived_key_size = EVP_BytesToKey(cipher_type, msg_digest_type, salt, pass_key, pass_key_len, 5, key, iv);\n  }\n return derived_key_size;\n}\n\nvoid encrypt(const unsigned char* msg, unsigned char** encrypted_message, const size_t msg_len, const unsigned char *key, unsigned char *iv) {\n    AES_KEY enc_key;\n    AES_set_encrypt_key(key, 256, &amp;enc_key);\n    AES_cbc_encrypt(msg, *encrypted_message, msg_len, &amp;enc_key, iv, AES_ENCRYPT);\n}\n\nvoid decrypt(const unsigned char* cipher, unsigned char** decrypted_msg, const size_t cipher_len, const unsigned char *key, unsigned char *iv ) {\n  AES_KEY enc_key;\n  AES_set_decrypt_key(key, 256, &amp;enc_key);\n  AES_cbc_encrypt(cipher, *decrypted_msg, cipher_len, &amp;enc_key, iv, AES_DECRYPT);\n}\n\nint decode(const char* b64_msg, unsigned char** decode_msg, const size_t  decode_msg_len) {\n  size_t bytes_decoded = 0;\n  bytes_decoded = EVP_DecodeBlock(*decode_msg, (unsigned char *)b64_msg, strlen(b64_msg));\n  return bytes_decoded;\n}\n\nint encode(const unsigned char* msg, const size_t msg_len, char** b64_msg) {\n  size_t bytes_encoded = 0;\n  if(msg &amp;&amp; msg_len &gt; 0 &amp;&amp; b64_msg)  {\n    bytes_encoded = EVP_EncodeBlock((unsigned char *) *b64_msg, msg, msg_len);\n  }\n  return bytes_encoded;\n}\n\nconst int derived_key_size = init_key_iv(password, salt, key, iv_enc);\nencrypt((unsigned char *)msg, &amp;encrypted_message, strlen(msg), key, iv_enc);\nconst size_t bytes_encoded( encode((const unsigned char*)encrypted_message, strlen(reinterpret_cast&lt;char*&gt;(encrypted_message)), &amp;base64_enc_str) );\nconst size_t bytes_decoded( CBase64::decode(cipher_base64, &amp;cipher, cipher_len) );\ndecrypt(cipher, &amp;decrypted_message, cipher_len, key, iv_dec);\n</code></pre>\n\n<p>Expectation is; the base64 ciphers generated by the Library should be decrypted in the openssl terminal and vice versa.</p>\n"}, {"tags": ["c", "graph"], "comments": [{"owner": {"reputation": 480272, "user_id": 1968, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd630f72eef3790bfb4ef38d08c7f85?s=128&d=identicon&r=PG", "display_name": "Konrad Rudolph", "link": "https://stackoverflow.com/users/1968/konrad-rudolph"}, "edited": false, "score": 3, "creation_date": 1559663028, "post_id": 56447181, "comment_id": 99487955, "body": "C or C++? The solutions will differ fundamentally."}, {"owner": {"reputation": 3783, "user_id": 2428235, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sj48p.jpg?s=128&g=1", "display_name": "Roman Hocke", "link": "https://stackoverflow.com/users/2428235/roman-hocke"}, "edited": false, "score": 0, "creation_date": 1559663164, "post_id": 56447181, "comment_id": 99488029, "body": "I think Your <code>j</code> variable needs to be reinitialized (to <code>j = i + 1</code>) for every <code>i</code>."}, {"owner": {"reputation": 233613, "user_id": 14065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e1475012bb1630271c9165899bccd548?s=128&d=identicon&r=PG", "display_name": "Martin York", "link": "https://stackoverflow.com/users/14065/martin-york"}, "edited": false, "score": 0, "creation_date": 1559663202, "post_id": 56447181, "comment_id": 99488045, "body": "Not quite a duplicate question. But very similar premise! <a href=\"https://stackoverflow.com/q/56436642/14065\">stackoverflow.com/q/56436642/14065</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user11599874"}, "edited": false, "score": 0, "creation_date": 1559663240, "post_id": 56447181, "comment_id": 99488062, "body": "Sorry that was my mistake. It is C"}, {"owner": {"reputation": 3783, "user_id": 2428235, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sj48p.jpg?s=128&g=1", "display_name": "Roman Hocke", "link": "https://stackoverflow.com/users/2428235/roman-hocke"}, "edited": false, "score": 0, "creation_date": 1559663337, "post_id": 56447181, "comment_id": 99488106, "body": "How have You allocated <code>graph1-&gt;edge</code>? I suspect that <code>free()</code> may be a problem - I guess You haven&#39;t allocated every single edge, but You are trying to free it."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11599874"}, "edited": false, "score": 0, "creation_date": 1559663424, "post_id": 56447181, "comment_id": 99488145, "body": "Yes I&#39;ve allocated for it. I guess I&#39;m more wondering if the approach I choose is correct for finding the duplicate edges."}, {"owner": {"reputation": 3783, "user_id": 2428235, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sj48p.jpg?s=128&g=1", "display_name": "Roman Hocke", "link": "https://stackoverflow.com/users/2428235/roman-hocke"}, "edited": false, "score": 0, "creation_date": 1559663560, "post_id": 56447181, "comment_id": 99488205, "body": "Your approach would be correct with <code>for (i=0; i&lt;N-1; i++) ... for (j=i+1; j&lt;N; j++)</code>. And with correct deallocation and skipping already deallocated edges in the loop."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 2, "creation_date": 1559663663, "post_id": 56447181, "comment_id": 99488254, "body": "Your code attempts to free a duplicate edge. There are two problems with this. One, the code you show suggests <code>graph-edge</code> is an array of edges, in which case you cannot free individual elements of it. It was allocated as an entire array and can only be freed as an entire array. Two, you need to remove the edge from the array (or other data structure), not just release the memory it uses. One way to solve both of these would be, when a duplicate is found, copy the last array element over the duplicate and then use <code>realloc</code> to shrink the array."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 2, "creation_date": 1559663756, "post_id": 56447181, "comment_id": 99488295, "body": "Note that, when using <code>realloc</code> to shrink the array, you must update the pointer or pointer(s) to it. (In particular, <code>graph-&gt;edge</code> must be changed.) It may be preferable to keep track of where the end of the array is while processing all of the edges (if <code>N</code> is the number of edges, it decreases when you remove an edge) and then call <code>realloc</code> just once after all of the duplicates have been handled. Also notice that, if you write over a duplicate, you cannot let <code>i</code> and <code>j</code> increment immediately. You have to check if the new edge in the current location is also a duplicate."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 2, "creation_date": 1559663876, "post_id": 56447181, "comment_id": 99488354, "body": "It is odd that <code>remove_dups</code> is passed two pointers to a graph. If it is only removing duplicate edges from one graph, it only needs one pointer."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11599874"}, "edited": false, "score": 0, "creation_date": 1559663912, "post_id": 56447181, "comment_id": 99488370, "body": "Okay I will try that approach. Thank you!"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1559664753, "post_id": 56447181, "comment_id": 99488748, "body": "Consider whether you actually want to deduplicate at all.  It will save you some memory for graph storage, but you will need to account for the two possible vertex orders in all your code that analyzes the resulting graphs.  Note also that you should be careful to distinguish between an undirected graph and a directed one in which each edge is matched with one going the opposite direction.  Deduplicating makes more sense to me for the former than for the latter."}, {"owner": {"reputation": 13124, "user_id": 1419272, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dcbff46aa5cd0a98d13d76595b3375f0?s=128&d=identicon&r=PG", "display_name": "alinsoar", "link": "https://stackoverflow.com/users/1419272/alinsoar"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1559665624, "post_id": 56447181, "comment_id": 99489174, "body": "@JohnBollinger as time as he says <code>graph is symmetrical</code> , that means it&#39;s undirected."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 13124, "user_id": 1419272, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dcbff46aa5cd0a98d13d76595b3375f0?s=128&d=identicon&r=PG", "display_name": "alinsoar", "link": "https://stackoverflow.com/users/1419272/alinsoar"}, "edited": false, "score": 0, "creation_date": 1559665825, "post_id": 56447181, "comment_id": 99489281, "body": "Well, @alinsoar, that <i>could be</i> what he means, but as I already noted, he could also mean that his graph is directed, with each edge having another going in the opposite direction between the same pair of vertices.  That is <i>not</i> the same thing, and it&#39;s important (for them) to understand which they are working with.  The difference is whether &quot;symmetrical&quot; describes a property of the graph itself, or whether it describes a property of a particular <i>representation</i> of the graph."}, {"owner": {"reputation": 13124, "user_id": 1419272, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dcbff46aa5cd0a98d13d76595b3375f0?s=128&d=identicon&r=PG", "display_name": "alinsoar", "link": "https://stackoverflow.com/users/1419272/alinsoar"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1559666646, "post_id": 56447181, "comment_id": 99489678, "body": "@JohnBollinger ok, correct"}], "owner": {"user_type": "does_not_exist", "display_name": "user11599874"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 323, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1559664982, "creation_date": 1559662874, "last_edit_date": 1559663213, "question_id": 56447181, "link": "https://stackoverflow.com/questions/56447181/remove-duplicate-edges-in-graph-data-structure", "title": "Remove Duplicate Edges In Graph Data Structure", "body": "<p>I  have this current Graph Datastructure read into memory.</p>\n\n<pre><code>struct Edge\n{\n    char s; // source\n    char d; // destination\n    int w; // weight\n};\n\nstruct Graph\n{\n    int v; //number of vertices\n    int e; //number of edges\n    struct Edge* edge;\n};\n</code></pre>\n\n<p>After reading in my graph, these are the following components : </p>\n\n<pre><code>&lt;A, B, 2&gt; &lt;A, F, 9&gt; &lt;A, G, 5&gt; &lt;B, A, 2&gt; &lt;B, C, 4&gt; &lt;B, G, 6&gt; &lt;C, B, 4&gt; &lt;C, D, 2&gt; &lt;C, H, 5&gt; &lt;D, C, 2&gt; &lt;D, E, 1&gt; &lt;D, H, 1&gt; &lt;E, D, 1&gt; &lt;E, F, 6&gt; &lt;E, I, 3&gt; &lt;F, A, 9&gt; &lt;F, E, 6&gt; &lt;F, I, 1&gt; &lt;G, A, 5&gt; &lt;G, B, 6&gt; &lt;G, H, 5&gt; &lt;G, I, 2&gt; &lt;H, C, 5&gt; &lt;H, D, 1&gt; &lt;H, G, 5&gt; &lt;H, I, 4&gt; &lt;I, E, 3&gt; &lt;I, F, 1&gt; &lt;I, G, 2&gt; &lt;I, H, 4&gt;\n</code></pre>\n\n<p>However, because this graph is symmetrical, I need only half the edges because there are duplicates.</p>\n\n<p>How can I delete multiple edges?</p>\n\n<p>For instance, I know [A, B, 2] and [B, A, 2] are the same edge. I can remove [B,A,2].</p>\n\n<p>Below is code that I thought would work but doesn't : </p>\n\n<pre><code>int remove_dups(struct Graph * graph1, struct Graph * graph)\n{\n  int i = 0;\n  int j = 1;\n\nfor(i; i &lt; N; i++)\n{\n    for(j; j &lt; N; j++)\n    {\n        if(graph-&gt;edge[i].s == graph1-&gt;edge[j].d || graph-&gt;edge[i].d == graph1-&gt;edge[j].s)\n            free(graph1-&gt;edge[i]);\n    }\n } \n}\n</code></pre>\n\n<p>Where should I start by doing this? I know my graph has 15 edges because 30 / 2 = 15. So I have twice as many edges as I need because I have duplicates. Any help would be nice. This is my first post. Thank you</p>\n"}, {"tags": ["c", "strtok"], "comments": [{"owner": {"reputation": 480272, "user_id": 1968, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd630f72eef3790bfb4ef38d08c7f85?s=128&d=identicon&r=PG", "display_name": "Konrad Rudolph", "link": "https://stackoverflow.com/users/1968/konrad-rudolph"}, "edited": false, "score": 3, "creation_date": 1559662133, "post_id": 56446958, "comment_id": 99487451, "body": "The code you\u2019ve posted contains a lot of irrelevant logic. It would be good if you could reduce the code to the essential, and remove everything that\u2019s not required to reproduce the problem. In particular this includes file reading."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1559662157, "post_id": 56446958, "comment_id": 99487457, "body": "... in other words, read this: how to privide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 1463, "user_id": 3083195, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/862fcf01c7837e10629ed86910f46029?s=128&d=identicon&r=PG&f=1", "display_name": "anurag86", "link": "https://stackoverflow.com/users/3083195/anurag86"}, "reply_to_user": {"reputation": 480272, "user_id": 1968, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd630f72eef3790bfb4ef38d08c7f85?s=128&d=identicon&r=PG", "display_name": "Konrad Rudolph", "link": "https://stackoverflow.com/users/1968/konrad-rudolph"}, "edited": false, "score": 0, "creation_date": 1559662371, "post_id": 56446958, "comment_id": 99487587, "body": "@KonradRudolph I reduced the code"}, {"owner": {"reputation": 168120, "user_id": 102937, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1233ec65168f4aae4d939ae8fe6cde1e?s=128&d=identicon&r=PG", "display_name": "Robert Harvey", "link": "https://stackoverflow.com/users/102937/robert-harvey"}, "edited": false, "score": 2, "creation_date": 1559662470, "post_id": 56446958, "comment_id": 99487644, "body": "This line <code>userHostPairs[i] = strtok(temp,&quot;@&quot;);</code> doesn&#39;t look right.  Shouldn&#39;t you be doing a strcpy instead of an assignment?"}], "answers": [{"comments": [{"owner": {"reputation": 1463, "user_id": 3083195, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/862fcf01c7837e10629ed86910f46029?s=128&d=identicon&r=PG&f=1", "display_name": "anurag86", "link": "https://stackoverflow.com/users/3083195/anurag86"}, "edited": false, "score": 0, "creation_date": 1559663179, "post_id": 56447156, "comment_id": 99488035, "body": "Can you explain the first point about &quot;you replace the mallocd block&quot; please?"}, {"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "reply_to_user": {"reputation": 1463, "user_id": 3083195, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/862fcf01c7837e10629ed86910f46029?s=128&d=identicon&r=PG&f=1", "display_name": "anurag86", "link": "https://stackoverflow.com/users/3083195/anurag86"}, "edited": false, "score": 1, "creation_date": 1559663256, "post_id": 56447156, "comment_id": 99488068, "body": "@anurag86 You have memory leaks because of overwriting <code>userHostPairs[i]</code> with <code>strtok</code> return."}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "reply_to_user": {"reputation": 1463, "user_id": 3083195, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/862fcf01c7837e10629ed86910f46029?s=128&d=identicon&r=PG&f=1", "display_name": "anurag86", "link": "https://stackoverflow.com/users/3083195/anurag86"}, "edited": false, "score": 1, "creation_date": 1559663265, "post_id": 56447156, "comment_id": 99488075, "body": "@anurag86 you assign  <code>userHostPairs[i]</code> so the previous value in <code>userHostPairs[i]</code> is lost and you have a memory leak"}, {"owner": {"reputation": 1463, "user_id": 3083195, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/862fcf01c7837e10629ed86910f46029?s=128&d=identicon&r=PG&f=1", "display_name": "anurag86", "link": "https://stackoverflow.com/users/3083195/anurag86"}, "edited": false, "score": 0, "creation_date": 1559666846, "post_id": 56447156, "comment_id": 99489772, "body": "@bruno lso by 3rd point - temp wont be out of scope till for loop finishes. Moreover am i not assigning the temp value to userHostPair whose  scope isnt limited to loop?"}, {"owner": {"reputation": 1463, "user_id": 3083195, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/862fcf01c7837e10629ed86910f46029?s=128&d=identicon&r=PG&f=1", "display_name": "anurag86", "link": "https://stackoverflow.com/users/3083195/anurag86"}, "edited": false, "score": 0, "creation_date": 1559666998, "post_id": 56447156, "comment_id": 99489842, "body": "Also, an offtrack question - If i declare <code>char* (*oActualList)[100] = &amp;userHostPairs;</code> , is it wrong to expect (*oActual)[i] to print same values as userHostPairs[i] holds?"}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "reply_to_user": {"reputation": 1463, "user_id": 3083195, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/862fcf01c7837e10629ed86910f46029?s=128&d=identicon&r=PG&f=1", "display_name": "anurag86", "link": "https://stackoverflow.com/users/3083195/anurag86"}, "edited": false, "score": 0, "creation_date": 1559667309, "post_id": 56447156, "comment_id": 99489994, "body": "@anurag86 <i>strtok</i> returns an address pointing <b>inside</b> <i>temp</i>, so out of the loop the memorized address are invalid."}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "reply_to_user": {"reputation": 1463, "user_id": 3083195, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/862fcf01c7837e10629ed86910f46029?s=128&d=identicon&r=PG&f=1", "display_name": "anurag86", "link": "https://stackoverflow.com/users/3083195/anurag86"}, "edited": false, "score": 0, "creation_date": 1559667620, "post_id": 56447156, "comment_id": 99490121, "body": "@anurag86 and yes <code>&amp;(*oActualList)[i] == &amp;userHostPairs[i]</code>, but what that changes something about your problem ?"}, {"owner": {"reputation": 1463, "user_id": 3083195, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/862fcf01c7837e10629ed86910f46029?s=128&d=identicon&r=PG&f=1", "display_name": "anurag86", "link": "https://stackoverflow.com/users/3083195/anurag86"}, "edited": false, "score": 0, "creation_date": 1559667975, "post_id": 56447156, "comment_id": 99490281, "body": "Well the above piece of code is a function which looks like <code>void getActualList(char* (*oActualList)[100])</code> and in main() i have <code>char* actualList[100]; getActualList(&amp;actualList);</code> , but when coming back to main, i cant printf the results in <code>actualList</code> `"}, {"owner": {"reputation": 1463, "user_id": 3083195, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/862fcf01c7837e10629ed86910f46029?s=128&d=identicon&r=PG&f=1", "display_name": "anurag86", "link": "https://stackoverflow.com/users/3083195/anurag86"}, "reply_to_user": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1559668020, "post_id": 56447156, "comment_id": 99490295, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/194452/discussion-between-anurag86-and-bruno\">continue this discussion in chat</a>."}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "reply_to_user": {"reputation": 1463, "user_id": 3083195, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/862fcf01c7837e10629ed86910f46029?s=128&d=identicon&r=PG&f=1", "display_name": "anurag86", "link": "https://stackoverflow.com/users/3083195/anurag86"}, "edited": false, "score": 0, "creation_date": 1559675006, "post_id": 56447156, "comment_id": 99493045, "body": "@anurag86 I edited my answer to add two proposal, the first one closer to your where the receiver arrays have a limited size, the second without limiting/supposing how much elements will be read"}, {"owner": {"reputation": 1463, "user_id": 3083195, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/862fcf01c7837e10629ed86910f46029?s=128&d=identicon&r=PG&f=1", "display_name": "anurag86", "link": "https://stackoverflow.com/users/3083195/anurag86"}, "edited": false, "score": 0, "creation_date": 1559805303, "post_id": 56447156, "comment_id": 99535772, "body": "thnx bruno. it worked for me well. However with valgrind i see weird error on strcpy with my program. But valgrind has no issues after replacing the two lines with strdup  <code>==11955==    at 0x4C2AAD0: strcpy (vg_replace_strmem.c:506) ==11955==    by 0x400C1D: getActualList (anurag.c:95) ==11955==    by 0x400D34: main (anurag.c:115) ==11955==  Address 0x51f4c48 is 0 bytes after a block of size 8 alloc&#39;d ==11955==    at 0x4C27BE3: malloc (vg_replace_malloc.c:299) ==11955==    by 0x400BF1: getActualList (anurag.c:94) ==11955==    by 0x400D34: main (anurag.c:115) </code>"}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "reply_to_user": {"reputation": 1463, "user_id": 3083195, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/862fcf01c7837e10629ed86910f46029?s=128&d=identicon&r=PG&f=1", "display_name": "anurag86", "link": "https://stackoverflow.com/users/3083195/anurag86"}, "edited": false, "score": 1, "creation_date": 1559818960, "post_id": 56447156, "comment_id": 99542680, "body": "@anurag86 if ok with <i>strdup</i> but nok with <i>strcpy</i> and considering the message of <i>valgrind</i> that probably means you wrongly <code>malloc(strlen(xx))</code> rather than <code>malloc(strlen(xx) + 1 )</code>"}], "tags": [], "owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "is_accepted": true, "score": 3, "last_activity_date": 1559674896, "last_edit_date": 1559674896, "creation_date": 1559662795, "answer_id": 56447156, "question_id": 56446958, "link": "https://stackoverflow.com/questions/56446958/breaking-a-c-string-into-tokens-through-strtok/56447156#56447156", "title": "Breaking a c string into tokens through strtok", "body": "<blockquote>\n  <p>prints weird values(most probably the last fetched value).</p>\n</blockquote>\n\n<p>this is because of several errors in your code</p>\n\n<pre><code>            char temp[100];\n\n            userHostPairs[i] = strtok(temp,\"@\");\n            userHostPairs[i] = strtok(NULL,\"@\");\n</code></pre>\n\n<p>the assignments are not what you want for 3 reasons :</p>\n\n<ul>\n<li>you replace the <em>mallocd</em> block (rather than probably to <em>strcpy</em> in it), so you create a memory leak</li>\n<li>you assign two times the same entry in <em>userHostPairs</em>, so the first result of <em>strtok</em> is lost</li>\n<li><em>strtok</em> returns pointers in <em>temp</em> and you modify <em>temps</em> the next loop so the previous results are broken</li>\n</ul>\n\n<hr>\n\n<p>Of course when you will go out of the scope of <em>temp</em> any uses to pointer saved in <em>userHostPairs</em>  will have an undefined behavior, but this is not the reason of the result you see because your writes are in the scope of <em>temp</em></p>\n\n<hr>\n\n<p>Example :</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nsize_t read(size_t sz, char *a1[sz], char * a2[sz])\n{\n  FILE* fp = fopen(\"f\", \"r\");\n\n  if (fp == 0)\n    return 0;\n\n  char line[50];        \n  size_t rank;\n\n  for (rank = 0; rank != sz; ++rank) {\n    if (fgets(line, sizeof(line), fp) == NULL)\n      break;\n\n    char * p1, * p2;\n\n    if (((p1 = strtok(line, \"@\")) == NULL) ||\n        ((p2 = strtok(NULL, \"@\\n\")) == NULL))\n      break;\n\n    a1[rank] = malloc(strlen(p1) + 1);\n    strcpy(a1[rank], p1);\n\n    a2[rank] = malloc(strlen(p2) + 1);\n    strcpy(a2[rank], p2);\n  }\n\n  fclose(fp);\n  return rank;\n}\n\n#define N 50\n\nint main()\n{\n  char * a1[N];\n  char * a2[N];\n  size_t n = read(N, a1, a2);\n\n  for (size_t i = 0; i != n; ++i)\n    printf(\"'%s' / '%s'\\n\", a1[i], a2[i]);\n\n  /* ... */\n\n  /* free resources */\n  for (size_t i = 0; i != n; ++i) {\n    free(a1[i]);\n    free(a2[i]);\n  }\n\n  return 0;\n}\n</code></pre>\n\n<p>Note if you have <em>strdup</em> you can replace</p>\n\n<pre><code>    a1[rank] = malloc(strlen(p1) + 1);\n    strcpy(a1[rank], p1);\n\n    a2[rank] = malloc(strlen(p2) + 1);\n    strcpy(a2[rank], p2);\n</code></pre>\n\n<p>by</p>\n\n<pre><code>    a1[rank] = strsup(p1);\n    a2[rank] = strdup(p2);\n</code></pre>\n\n<p>Having the file <em>f</em> containing :</p>\n\n<pre><code>aze@qsd@\nwxc@iop\niop@jkl\n</code></pre>\n\n<p>Compilation and execution :</p>\n\n<pre><code>pi@raspberrypi:/tmp $ ./a.out\n'aze' / 'qsd'\n'wxc' / 'iop'\n'iop' / 'jkl'\npi@raspberrypi:/tmp $ \n</code></pre>\n\n<p>Execution under <em>valgrind</em> :</p>\n\n<pre><code>pi@raspberrypi:/tmp $ valgrind ./a.out\n==6244== Memcheck, a memory error detector\n==6244== Copyright (C) 2002-2017, and GNU GPL'd, by Julian Seward et al.\n==6244== Using Valgrind-3.13.0 and LibVEX; rerun with -h for copyright info\n==6244== Command: ./a.out\n==6244== \n'aze' / 'qsd'\n'wxc' / 'iop'\n'iop' / 'jkl'\n==6244== \n==6244== HEAP SUMMARY:\n==6244==     in use at exit: 0 bytes in 0 blocks\n==6244==   total heap usage: 9 allocs, 9 frees, 5,496 bytes allocated\n==6244== \n==6244== All heap blocks were freed -- no leaks are possible\n==6244== \n==6244== For counts of detected and suppressed errors, rerun with: -v\n==6244== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 6 from 3)\npi@raspberrypi:/tmp $ cat f\n</code></pre>\n\n<p>If you do not want to limit the number of elements in the arrays you can use <em>malloc</em> then <em>realloc</em> for the arrays :</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nsize_t read(char *** a1, char *** a2)\n{\n  *a1 = malloc(0);\n  *a2 = malloc(0);\n\n  FILE* fp = fopen(\"f\", \"r\");\n\n  if (fp == 0)\n    return 0;\n\n  char line[50];        \n  size_t rank = 0;\n\n  while (fgets(line, sizeof(line), fp) != NULL) {\n    char * p1, * p2;\n\n    if (((p1 = strtok(line, \"@\")) == NULL) ||\n        ((p2 = strtok(NULL, \"@\\n\")) == NULL))\n      break;\n\n    *a1 = realloc(*a1, (rank+1) * sizeof(char *));\n    (*a1)[rank] = malloc(strlen(p1) + 1);\n    strcpy((*a1)[rank], p1);\n\n    *a2 = realloc(*a2, (rank+1) * sizeof(char *));\n    (*a2)[rank] = malloc(strlen(p2) + 1);\n    strcpy((*a2)[rank], p2);\n\n    rank += 1;\n  }\n\n  fclose(fp);\n  return rank;\n}\n\nint main()\n{\n  char ** a1;\n  char ** a2;\n  size_t n = read(&amp;a1, &amp;a2);\n\n  for (size_t i = 0; i != n; ++i)\n    printf(\"'%s' / '%s'\\n\", a1[i], a2[i]);\n\n  /* ... */\n\n  /* free resources */\n  for (size_t i = 0; i != n; ++i) {\n    free(a1[i]);\n    free(a2[i]);\n  }\n  free(a1);\n  free(a2);\n\n  return 0;\n}\n</code></pre>\n\n<p>With the same file <em>f</em> , compilation and execution :</p>\n\n<pre><code>pi@raspberrypi:/tmp $ gcc -g -pedantic -Wextra -Wall st.c\npi@raspberrypi:/tmp $ ./a.out\n'aze' / 'qsd'\n'wxc' / 'iop'\n'iop' / 'jkl'\npi@raspberrypi:/tmp $ \n</code></pre>\n\n<p>Execution under <em>valgrind</em> :</p>\n\n<pre><code>pi@raspberrypi:/tmp $ valgrind ./a.out\n==6423== Memcheck, a memory error detector\n==6423== Copyright (C) 2002-2017, and GNU GPL'd, by Julian Seward et al.\n==6423== Using Valgrind-3.13.0 and LibVEX; rerun with -h for copyright info\n==6423== Command: ./a.out\n==6423== \n'aze' / 'qsd'\n'wxc' / 'iop'\n'iop' / 'jkl'\n==6423== \n==6423== HEAP SUMMARY:\n==6423==     in use at exit: 0 bytes in 0 blocks\n==6423==   total heap usage: 17 allocs, 17 frees, 5,544 bytes allocated\n==6423== \n==6423== All heap blocks were freed -- no leaks are possible\n==6423== \n==6423== For counts of detected and suppressed errors, rerun with: -v\n==6423== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 6 from 3)\npi@raspberrypi:/tmp $ \n</code></pre>\n"}], "owner": {"reputation": 1463, "user_id": 3083195, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/862fcf01c7837e10629ed86910f46029?s=128&d=identicon&r=PG&f=1", "display_name": "anurag86", "link": "https://stackoverflow.com/users/3083195/anurag86"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 56447156, "answer_count": 1, "score": 0, "last_activity_date": 1559674896, "creation_date": 1559662054, "last_edit_date": 1559662343, "question_id": 56446958, "link": "https://stackoverflow.com/questions/56446958/breaking-a-c-string-into-tokens-through-strtok", "title": "Breaking a c string into tokens through strtok", "body": "<p>In the following piece of code, i see that after breaking <code>userHostPairs</code> in tokens and assigning to itself doesn't work.\nAfter breaking into tokens i print <code>userHostPairs</code> in loop and in the same loop i also print 0th element always through <code>printf(\"0Printing after strtok = %s\",userHostPairs[0]);</code> which prints weird values(most probably the last fetched value).</p>\n\n<pre><code>FILE* fp;        \nchar  line[100];        \nchar* userHostPairs[100];\n\nfp = fopen(\"somefile\", \"r\");\n\n//READING THE FILE LINE BY LINE. WORKS FINE  \n        int count =0;\n        while (fgets(line, sizeof(line), fp) != NULL ) {\n                userHostPairs[count]=malloc(MAX_LINE_SIZE);\n                strcpy(userHostPairs[count],line);\n                count++;\n        }\n\n///PROBLEMATIC CODE////////////////////\n\n        for(i=0;i&lt;count;i++)\n        {\n                char temp[100];\n                strcpy(temp,userHostPairs[i]);\n\n                userHostPairs[i] = strtok(temp,\"@\");\n                userHostPairs[i] = strtok(NULL,\"@\");\n                printf(\"Printing after strtok = %s\",userHostPairs[i]);\n                printf(\"0Printing after strtok = %s\",userHostPairs[0]); //This 0th element is always some random(or last) value fetched.\n        }\n}\n</code></pre>\n\n<p><strong>Output:</strong></p>\n\n<pre><code>Printing in strtok = 10.238.178.136\n0Printing in strtok = 10.238.178.136\nPrinting in strtok = 10.238.152.101\n0Printing in strtok = 10.238.152.101\nPrinting in strtok = eaasrt\n0Printing in strtok = eaasrt\nPrinting in strtok = eaasrt7\n0Printing in strtok = aasrt7\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1559661223, "post_id": 56446612, "comment_id": 99486926, "body": "Probably you are not using the right toolchain or passing it incorrect settings."}, {"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1559661673, "post_id": 56446612, "comment_id": 99487202, "body": "Is the address of r3 + r2 a valid range?  Or is it garbage?"}, {"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1559661734, "post_id": 56446612, "comment_id": 99487239, "body": "And yes, the compiler can handle thumb to arm switching if you enabled inter-working.   But I thing that @EugeneSh. has the real answer."}, {"owner": {"reputation": 51, "user_id": 9711590, "user_type": "registered", "profile_image": "https://graph.facebook.com/2082958171733073/picture?type=large", "display_name": "Gregory Helton", "link": "https://stackoverflow.com/users/9711590/gregory-helton"}, "edited": false, "score": 0, "creation_date": 1559666313, "post_id": 56446612, "comment_id": 99489520, "body": "I&#39;ve added the make file for reference. The tool chain has been working fine for this project until function localtime() was added, and it&#39;s header file &quot;time.h&quot;. Is there something that needs to be setup differently in the make file ?  Also, to answer Michael&#39;s question :  r3+r2 is not a valid address."}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1559666410, "post_id": 56446612, "comment_id": 99489561, "body": "<a href=\"https://github.com/bminor/newlib/blob/master/newlib/libc/time/lcltime_r.c\" rel=\"nofollow noreferrer\">localtime sources</a>  you passed <code>-nostartfiles</code>, could be _REENT or any locale global variable is not initialized properly. It can fail at <a href=\"https://github.com/bminor/newlib/blob/master/newlib/libc/time/lcltime.c#L50\" rel=\"nofollow noreferrer\">here</a>, where is need to dereference reent. Also you are passing both <code>nano.specs</code> <i>and</i> <code>nosys.specs</code> and then you are using <code>-lnosys</code>, specifying both makes no (little) sense. Either you want nano system or no system calls and implement them yourself, don&#39;t pass both."}, {"owner": {"reputation": 51, "user_id": 9711590, "user_type": "registered", "profile_image": "https://graph.facebook.com/2082958171733073/picture?type=large", "display_name": "Gregory Helton", "link": "https://stackoverflow.com/users/9711590/gregory-helton"}, "edited": false, "score": 0, "creation_date": 1559679474, "post_id": 56446612, "comment_id": 99494816, "body": "I was able to remove the -nosys.specs option from the linker options, but this did not solve the problem. The make file is created automatically from various checkboxes and dialogs. However, I cannot find anything related to the -lnosys option (it is still in the make file, and I don&#39;t know how to remove it). The -nostartfiles option was selected because I am using a custom startup file. But I don&#39;t see why this would cause 64 bit addresses to be used in a lib function."}], "owner": {"reputation": 51, "user_id": 9711590, "user_type": "registered", "profile_image": "https://graph.facebook.com/2082958171733073/picture?type=large", "display_name": "Gregory Helton", "link": "https://stackoverflow.com/users/9711590/gregory-helton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 83, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1559666065, "creation_date": 1559660858, "last_edit_date": 1559666065, "question_id": 56446612, "link": "https://stackoverflow.com/questions/56446612/arm-cortex-m3-hard-fault-due-to-64bit-address", "title": "ARM Cortex M3 hard fault due to 64bit address", "body": "<p>My ARM Cortex M3 micro generates a hard fault error when running a C library function \"localtime()\". Single stepping through the localtime function shows that 64 bit addresses are being used everywhere. This didn't cause any problem until this line of code   \"str     r1,[r3,r2]\"    which uses a relative 64 bit address.  The GCC compiler is setup for Thumb mode. Is the compiler/linker supposed to recognize the Thumb mode, and compile/link code for that mode ?  What can I do to resolve this problem ?</p>\n\n<p>Single step through localtime() function to find source of address error.</p>\n\n<p>str     r1,[r3,r2]</p>\n\n<p>===========================================\nMake file</p>\n\n<pre><code>################################################################################\n# Automatically-generated file. Do not edit!\n################################################################################\n\n-include ../makefile.init\n\nRM := rm -rf\n\n# All of the sources participating in the build are defined here\n-include sources.mk\n-include Source/subdir.mk\n-include subdir.mk\n-include objects.mk\n\nifneq ($(MAKECMDGOALS),clean)\nifneq ($(strip $(C_DEPS)),)\n-include $(C_DEPS)\nendif\nendif\n\n-include ../makefile.defs\n\n# Add inputs and outputs from these tool invocations to the build variables \n\n# All Target\nall: GPS_Clock3.axf\n\ndependents:\n    -cd C:/Users/Greg/SimplicityStudio/v4_workspace/GPS_Clock3/GNU\\ ARM\\ v4.9.3\\ -\\ Release &amp;&amp; $(MAKE) all\n\n# Tool invocations\nGPS_Clock3.axf: $(OBJS) $(USER_OBJS) C:/Users/Greg/SimplicityStudio/v4_workspace/GPS_Clock3/GNU\\ ARM\\ v4.9.3\\ -\\ Release/GPS_Clock3.axf\n    @echo 'Building target: $@'\n    @echo 'Invoking: GNU ARM C Linker'\n    arm-none-eabi-gcc -g3 -gdwarf-2 -mcpu=cortex-m3 -mthumb -T \"C:/Users/Greg/SimplicityStudio/v4_workspace/GPS_Clock3/GNU ARM v4.9.3 - Debug/GPS_Clock3.ld\" -nostartfiles --specs=nosys.specs -Xlinker --gc-sections -Xlinker -Map=\"GPS_Clock3.map\" --specs=nano.specs -o GPS_Clock3.axf \"./Source/aeabi_memset-thumb.o\" \"./Source/crt0.o\" \"./Source/em_emu.o\" \"./Source/functions.o\" \"./Source/interrupts.o\" \"./Source/main.o\" \"./Source/startup_efm32jg1b.o\" \"./Source/test.o\" -lm -Wl,--start-group -lgcc -lc -lnosys -Wl,--end-group\n    @echo 'Finished building target: $@'\n    @echo ' '\n\n    @echo 'Building hex file: GPS_Clock3.hex'\n    arm-none-eabi-objcopy -O ihex \"GPS_Clock3.axf\" \"GPS_Clock3.hex\"\n    @echo ' '\n\n    @echo 'Building bin file: GPS_Clock3.bin'\n    arm-none-eabi-objcopy -O binary \"GPS_Clock3.axf\" \"GPS_Clock3.bin\"\n    @echo ' '\n\n    @echo 'Building s37 file: GPS_Clock3.s37'\n    arm-none-eabi-objcopy -O srec \"GPS_Clock3.axf\" \"GPS_Clock3.s37\"\n    @echo ' '\n\n    @echo 'Running size tool'\n    arm-none-eabi-size \"GPS_Clock3.axf\"\n    @echo ' '\n\n# Other Targets\nclean:\n    -$(RM) $(EXECUTABLES)$(OBJS)$(C_DEPS) GPS_Clock3.axf\n    -@echo ' '\n\n.PHONY: all clean dependents\n.SECONDARY:\nC:/Users/Greg/SimplicityStudio/v4_workspace/GPS_Clock3/GNU\\ ARM\\ v4.9.3\\ -\\ Release/GPS_Clock3.axf:\n\n-include ../makefile.targets\n</code></pre>\n"}, {"tags": ["c", "string", "data-structures", "binary-tree", "binary-search-tree"], "comments": [{"owner": {"reputation": 17209, "user_id": 1055118, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/44Trt.jpg?s=128&g=1", "display_name": "doctorlove", "link": "https://stackoverflow.com/users/1055118/doctorlove"}, "edited": false, "score": 1, "creation_date": 1559660152, "post_id": 56446359, "comment_id": 99486296, "body": "Can you be more explicit about what goes wrong? Or give an example of the strings you used and what happened? Also, <code>new1=(struct node*)malloc(strlen(str)+10);</code> Why 10? Why not a new node?"}, {"owner": {"reputation": 3, "user_id": 10908438, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-D2UBOnaHZn4/AAAAAAAAAAI/AAAAAAAABV0/EvbA7ISvemc/photo.jpg?sz=128", "display_name": "Haerambhan", "link": "https://stackoverflow.com/users/10908438/haerambhan"}, "reply_to_user": {"reputation": 17209, "user_id": 1055118, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/44Trt.jpg?s=128&g=1", "display_name": "doctorlove", "link": "https://stackoverflow.com/users/1055118/doctorlove"}, "edited": false, "score": 0, "creation_date": 1559660404, "post_id": 56446359, "comment_id": 99486445, "body": "@doctorlove The program compiles without any errors but if I give any input, for instance - &quot;school&quot;, The program stops execution and returns nothing."}, {"owner": {"reputation": 50669, "user_id": 1711796, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6pRI7.png?s=128&g=1", "display_name": "Bernhard Barker", "link": "https://stackoverflow.com/users/1711796/bernhard-barker"}, "edited": false, "score": 1, "creation_date": 1559660536, "post_id": 56446359, "comment_id": 99486535, "body": "<code>char *</code> is a <b>pointer</b> that points to a char that&#39;s stored <b>somewhere else</b>. So <code>new1=(struct node*)malloc(strlen(str)+10);</code> only allocates memory for the string pointer, not the actual string. You need a separate malloc for the string. Also, don&#39;t hard-code sizes, use <code>sizeof</code>."}, {"owner": {"reputation": 3, "user_id": 10908438, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-D2UBOnaHZn4/AAAAAAAAAAI/AAAAAAAABV0/EvbA7ISvemc/photo.jpg?sz=128", "display_name": "Haerambhan", "link": "https://stackoverflow.com/users/10908438/haerambhan"}, "reply_to_user": {"reputation": 50669, "user_id": 1711796, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6pRI7.png?s=128&g=1", "display_name": "Bernhard Barker", "link": "https://stackoverflow.com/users/1711796/bernhard-barker"}, "edited": false, "score": 0, "creation_date": 1559660738, "post_id": 56446359, "comment_id": 99486652, "body": "@Dukeling Thank you for pointing it out. Can you please provide me with the appropriate code to allocate memory for both the string and the struct."}, {"owner": {"reputation": 50669, "user_id": 1711796, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6pRI7.png?s=128&g=1", "display_name": "Bernhard Barker", "link": "https://stackoverflow.com/users/1711796/bernhard-barker"}, "edited": false, "score": 1, "creation_date": 1559660926, "post_id": 56446359, "comment_id": 99486749, "body": "See: <a href=\"https://stackoverflow.com/questions/19263717/allocating-memory-for-a-struct-when-it-includes-a-string\">Allocating memory for a struct when it includes a string</a>"}], "answers": [{"comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1559661878, "post_id": 56446777, "comment_id": 99487316, "body": "<code>new1=(struct node*)malloc(sizeof(node));</code> should rather be <code>new1 = malloc(sizeof(node));</code>, the cast is not necessary. +1 anyway"}, {"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "edited": false, "score": 1, "creation_date": 1559663048, "post_id": 56446777, "comment_id": 99487966, "body": "Even better - <code>new1 = malloc( sizeof *new1 );</code>."}, {"owner": {"reputation": 3, "user_id": 10908438, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-D2UBOnaHZn4/AAAAAAAAAAI/AAAAAAAABV0/EvbA7ISvemc/photo.jpg?sz=128", "display_name": "Haerambhan", "link": "https://stackoverflow.com/users/10908438/haerambhan"}, "edited": false, "score": 0, "creation_date": 1559715805, "post_id": 56446777, "comment_id": 99502628, "body": "@doctorlove I&#39;ve added these lines to my code for memory allocation:      <code>new1=(struct node*)malloc(sizeof(struct node));</code>     <code>new1-&gt;str=malloc(strlen(str)+1);</code>     <code>strcpy(new1-&gt;str,str);</code>  I&#39;m still facing the same problem."}, {"owner": {"reputation": 3, "user_id": 10908438, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-D2UBOnaHZn4/AAAAAAAAAAI/AAAAAAAABV0/EvbA7ISvemc/photo.jpg?sz=128", "display_name": "Haerambhan", "link": "https://stackoverflow.com/users/10908438/haerambhan"}, "edited": false, "score": 0, "creation_date": 1559717509, "post_id": 56446777, "comment_id": 99503177, "body": "Thanks for your help guys. I&#39;ve managed to fix the issue by using a character array instead of a pointer to char in main(). Can anyone explain to me why this happened."}, {"owner": {"reputation": 17209, "user_id": 1055118, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/44Trt.jpg?s=128&g=1", "display_name": "doctorlove", "link": "https://stackoverflow.com/users/1055118/doctorlove"}, "edited": false, "score": 0, "creation_date": 1559722164, "post_id": 56446777, "comment_id": 99505024, "body": "You still haven&#39;t said what went wrong, but the <code>str</code> member gets copied straight into in your version with <code>strcpy(new1-&gt;str,str);</code> but you didn&#39;t alloc enough space for the string. The +10 in your malloc buys you a bit of space, but possibly not enough"}], "tags": [], "owner": {"reputation": 17209, "user_id": 1055118, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/44Trt.jpg?s=128&g=1", "display_name": "doctorlove", "link": "https://stackoverflow.com/users/1055118/doctorlove"}, "is_accepted": true, "score": 5, "last_activity_date": 1559661361, "creation_date": 1559661361, "answer_id": 56446777, "question_id": 56446359, "link": "https://stackoverflow.com/questions/56446359/how-to-use-a-binary-search-tree-to-store-strings/56446777#56446777", "title": "How to use a binary search tree to store strings?", "body": "<p>Main problem: in <code>create</code> you have</p>\n\n<pre><code>new1=(struct node*)malloc(strlen(str)+10);\nstrcpy(new1-&gt;str,str);\n</code></pre>\n\n<p>You want a new node</p>\n\n<pre><code>new1=(struct node*)malloc(sizeof(node));\n</code></pre>\n\n<p>And space for the string</p>\n\n<pre><code>new1-&gt;str=malloc(strlen(str)+1); //plus 1 for null terminator\n</code></pre>\n\n<p>Then you can do this:</p>\n\n<pre><code>strcpy(new1-&gt;str,str);\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10908438, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-D2UBOnaHZn4/AAAAAAAAAAI/AAAAAAAABV0/EvbA7ISvemc/photo.jpg?sz=128", "display_name": "Haerambhan", "link": "https://stackoverflow.com/users/10908438/haerambhan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1124, "favorite_count": 0, "accepted_answer_id": 56446777, "answer_count": 1, "score": 0, "last_activity_date": 1559661361, "creation_date": 1559659903, "question_id": 56446359, "link": "https://stackoverflow.com/questions/56446359/how-to-use-a-binary-search-tree-to-store-strings", "title": "How to use a binary search tree to store strings?", "body": "<p>I had previously written C code to insert and traverse integer values in a binary search tree. I tried to make it work for strings as well. I made a few changes like converting all integers to strings and I've also added functions like strcpy() and strcmp() to handle string operations.\nBut the code doesn't seem to work. Can someone explain to me what went wrong?</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n#include&lt;string.h&gt;\n\nstruct node  \n{\n    char *str;\n    struct node *left;\n    struct node *right;\n};\nstruct node *root=NULL;\n\nvoid preorder(struct node *temp)\n{\n    if(temp==NULL)\n        return;\n    printf(\"%s \", temp-&gt;str);\n    preorder(temp-&gt;left);\n    preorder(temp-&gt;right);\n\n}\n\nvoid inorder(struct node *temp)\n{\n    if(temp==NULL)\n        return;\n    inorder(temp-&gt;left);\n    printf(\"%s \", temp-&gt;str);\n    inorder(temp-&gt;right);\n\n}\nvoid postorder(struct node *temp)\n{\n    if(temp==NULL)\n        return;\n    postorder(temp-&gt;left);\n    postorder(temp-&gt;right);\n    printf(\"%s \", temp-&gt;str);\n}\n\nstruct node* create(char *str)   // Function to create new node\n{\n    struct node *new1;\n    new1=(struct node*)malloc(strlen(str)+10);\n    strcpy(new1-&gt;str,str);\n    new1-&gt;left=NULL;\n    new1-&gt;right=NULL;\n    return new1;\n}\n\nstruct node* insert(struct node *root,char *str) // Function to insert a node\n{\n    if(root==NULL)\n    {\n        root=create(str);\n    }\n    else if(strcmp(str,root-&gt;str)&lt;0)\n    {\n        root-&gt;left = insert(root-&gt;left,str);\n    }\n    else if(strcmp(str,root-&gt;str)&gt;0)\n    {\n       root-&gt;right =  insert(root-&gt;right,str);\n    }\n    return root;\n}\n\nint main()\n{\n    char *str;\n    while(1)\n    {\n        printf(\"Enter value to insert: \");\n        scanf(\"%s\",str);\n        if(strcmp(str,\"-1\")==0)\n        {\n            break;\n        }\n        else\n        {\n            root=insert(root,str);\n        }\n    }\n    printf(\"\\nThe values of the BST traversed in PREORDER are: \");\n    preorder(root);\n    printf(\"\\nThe values of the BST traversed in INORDER are: \");\n    inorder(root);\n    printf(\"\\nThe values of the BST traversed in POSTORDER are: \");\n    postorder(root);\n    return 0;\n}\n</code></pre>\n\n<p>If anyone can fix this for me, I'd be grateful.</p>\n"}, {"tags": ["c", "json", "arduino", "mqtt", "esp8266"], "comments": [{"owner": {"reputation": 21178, "user_id": 89586, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17fe3afc9020eddb5c7445e286eead4a?s=128&d=identicon&r=PG", "display_name": "Matthew Whited", "link": "https://stackoverflow.com/users/89586/matthew-whited"}, "edited": false, "score": 0, "creation_date": 1559660726, "post_id": 56445861, "comment_id": 99486645, "body": "Oh, you aren&#39;t going to be able use to 115200 with softserial.  slow that baud rate down to 9600 or less and try again."}, {"owner": {"reputation": 21178, "user_id": 89586, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17fe3afc9020eddb5c7445e286eead4a?s=128&d=identicon&r=PG", "display_name": "Matthew Whited", "link": "https://stackoverflow.com/users/89586/matthew-whited"}, "edited": false, "score": 0, "creation_date": 1559666198, "post_id": 56445861, "comment_id": 99489468, "body": "And since you are using println it should send a text representation of the integer"}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 10587677, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6286e5499a121af0e479956d84224c85?s=128&d=identicon&r=PG&f=1", "display_name": "Matheus Andrade", "link": "https://stackoverflow.com/users/10587677/matheus-andrade"}, "edited": false, "score": 0, "creation_date": 1559662472, "post_id": 56446622, "comment_id": 99487645, "body": "So if I try using 9600 will it send the integer on it&#39;s original value?"}, {"owner": {"reputation": 21178, "user_id": 89586, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17fe3afc9020eddb5c7445e286eead4a?s=128&d=identicon&r=PG", "display_name": "Matthew Whited", "link": "https://stackoverflow.com/users/89586/matthew-whited"}, "reply_to_user": {"reputation": 27, "user_id": 10587677, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6286e5499a121af0e479956d84224c85?s=128&d=identicon&r=PG&f=1", "display_name": "Matheus Andrade", "link": "https://stackoverflow.com/users/10587677/matheus-andrade"}, "edited": false, "score": 0, "creation_date": 1559666159, "post_id": 56446622, "comment_id": 99489442, "body": "Your data corruption issue is because the bitbanging process doesn&#39;t keep the output in the correct values for the input to understand it.  (you would see a similar issue if you use the wrong data rate.)  The bits are being skewed since the processor can&#39;t do its normal job withing the time of the data read.  (the issue could be on the sender, receiver or both since you are using softwareserial on both ends)"}], "tags": [], "owner": {"reputation": 21178, "user_id": 89586, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17fe3afc9020eddb5c7445e286eead4a?s=128&d=identicon&r=PG", "display_name": "Matthew Whited", "link": "https://stackoverflow.com/users/89586/matthew-whited"}, "is_accepted": true, "score": 1, "last_activity_date": 1559660884, "creation_date": 1559660884, "answer_id": 56446622, "question_id": 56445861, "link": "https://stackoverflow.com/questions/56445861/send-an-integer-value-from-arduino-uno-to-nodemcu/56446622#56446622", "title": "Send an integer value from arduino uno to nodemcu", "body": "<p><a href=\"https://www.arduino.cc/en/Reference/SoftwareSerial\" rel=\"nofollow noreferrer\">SoftwareSerial</a> doesn't support 115200 baud rate.  You may be able to get 57600 but you are better off trying 9600 or less.</p>\n"}], "owner": {"reputation": 27, "user_id": 10587677, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6286e5499a121af0e479956d84224c85?s=128&d=identicon&r=PG&f=1", "display_name": "Matheus Andrade", "link": "https://stackoverflow.com/users/10587677/matheus-andrade"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 624, "favorite_count": 0, "accepted_answer_id": 56446622, "answer_count": 1, "score": 0, "last_activity_date": 1559660884, "creation_date": 1559658102, "last_edit_date": 1559659123, "question_id": 56445861, "link": "https://stackoverflow.com/questions/56445861/send-an-integer-value-from-arduino-uno-to-nodemcu", "title": "Send an integer value from arduino uno to nodemcu", "body": "<p>I want to send one variable my Arduino UNO reads from a sensor to the NodeMCU, so it can send it as a json to a MQTT server.</p>\n\n<p>I've tried multiple code implementations that I've seen on the web, but when I watch the console on the baud rate I set for the SoftwareSerial, it only gives me random strings.</p>\n\n<blockquote>\n  <p>Code on the uno: <a href=\"https://pastebin.com/fZHtEdjV\" rel=\"nofollow noreferrer\">https://pastebin.com/fZHtEdjV</a></p>\n</blockquote>\n\n<pre><code>#include &lt;SoftwareSerial.h&gt;\n#include &lt;String.h&gt;\nSoftwareSerial toNode(2,3); // (Rx, Tx)\n\nint sensorPin = A0;\nint sensorValue;\n\nvoid setup() {\n Serial.begin(9600);\n toNode.begin(115200);\n\n pinMode(9, OUTPUT);\n pinMode(10, OUTPUT);\n pinMode(8, OUTPUT);\n}\n\nvoid loop() {\n\n sensorValue = analogRead(sensorPin); \n Serial.println(\"Analog Value : \");\n Serial.println(sensorValue);\n\n if (sensorValue&lt;300) {\n digitalWrite(10, HIGH);\n digitalWrite(9, LOW);\n digitalWrite(8, LOW);\n parseJson(sensorValue);\n }\n else if(sensorValue&gt;300 &amp;&amp; sensorValue&lt;450){\n digitalWrite(9, HIGH);\n digitalWrite(8, LOW);\n digitalWrite(10, LOW);\n parseJson(sensorValue);\n }\n else if(sensorValue &lt; 300)\n {\n digitalWrite(8, HIGH);\n digitalWrite(9, LOW);\n digitalWrite(10, LOW);\n parseJson(sensorValue);\n }\n\n delay(1000); \n}\n\nvoid parseJson(int criticidade) {\n   String njs;\n   njs = String(criticidade);\n   toNode.println(njs);\n}\n</code></pre>\n\n<blockquote>\n  <p>Code on the NodeMCU: <a href=\"https://pastebin.com/SFNC5JfG\" rel=\"nofollow noreferrer\">https://pastebin.com/SFNC5JfG</a></p>\n</blockquote>\n\n<pre><code>#include &lt;ESP8266WiFi.h&gt;\n#include &lt;PubSubClient.h&gt;\n#include &lt;SoftwareSerial.h&gt;\n#include &lt;String.h&gt;\nSoftwareSerial fromUno(D5,D6); // (Rx, Tx)\n\nchar* ssid = \"B\";\nchar* password =  \"A\";\nconst char* mqttServer = \"Z\";\nconst int mqttPort = 1;\nconst char* mqttUser = \"Y\";\nconst char* mqttPassword = \"X;\n\nWiFiClient espClient;\nPubSubClient client(espClient);\n\nvoid setup() {\n\n  Serial.begin(9600);\n  fromUno.begin(115200);\n\n  WiFi.begin(ssid, password);\n\n  while (WiFi.status() != WL_CONNECTED) {\n    delay(500);\n    Serial.println(\"Connecting to WiFi..\");\n  }\n\n  Serial.println(\"Connected to the WiFi network\");\n\n  client.setServer(mqttServer, mqttPort);\n\n  while (!client.connected()) {\n    Serial.println(\"Connecting to MQTT...\");\n\n    if (client.connect(\"ESP32Client\", mqttUser, mqttPassword )) {\n\n      Serial.println(\"connected\");\n\n    } else {\n\n      Serial.print(\"failed with state \");\n      Serial.print(client.state());\n      delay(2000);\n\n    }\n  }\n}\n\nvoid loop() {\n   char json[100];\n   json[0] = fromUno.read();\n   String json2 = \"{\\\"planta\\\":{\\\"umidade\\\":200,\\\"criticidade\\\":1}}\";\n\n  Serial.println(\"Sending message to MQTT topic..\");\n\n  if (client.publish(\"test\", json2) == true) {\n    Serial.println(\"Success sending message\");\n  } else {\n    Serial.println(\"Error sending message\");\n  }\n\n  client.loop();\n  Serial.println(\"-------------\");\n\n  delay(10000);\n}\n</code></pre>\n\n<p>I expected that when reading the serial port from the NodeMCU, it would set the integer value I'm sending from the UNO to a variable.</p>\n"}, {"tags": ["c", "list", "pointers", "structure", "singly-linked-list"], "comments": [{"owner": {"reputation": 3936, "user_id": 1675804, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f375fecf87753c214d732aaa119d59c6?s=128&d=identicon&r=PG", "display_name": "xception", "link": "https://stackoverflow.com/users/1675804/xception"}, "edited": false, "score": 1, "creation_date": 1559657762, "post_id": 56445697, "comment_id": 99484983, "body": "your problem seems to be that you think that by changing the value of c inside the first function, you are changing the value outside of it as well, that is not true. If you want to &quot;obtain&quot; the value of the last cell removed by last_cell_out, you have to either return the value or use a parameter that&#39;s a pointer and assign to it&#39;s value."}], "answers": [{"tags": [], "owner": {"reputation": 3936, "user_id": 1675804, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f375fecf87753c214d732aaa119d59c6?s=128&d=identicon&r=PG", "display_name": "xception", "link": "https://stackoverflow.com/users/1675804/xception"}, "is_accepted": true, "score": 1, "last_activity_date": 1559661984, "last_edit_date": 1559661984, "creation_date": 1559658244, "answer_id": 56445897, "question_id": 56445697, "link": "https://stackoverflow.com/questions/56445697/moving-struct-from-end-of-one-list-to-start-of-another-list/56445897#56445897", "title": "moving struct from end of one list to start of another list", "body": "<p>This function seems perfectly fine to me, given how you described your requirements</p>\n\n<pre><code>CellPtr new_first_cell(CellPtr list, CellPtr c)\n{\n    c-&gt;next=list;\n    return c;/*returnes the start of the list*/\n}\n</code></pre>\n\n<p>However the <code>last_cell_out</code> has some problems.</p>\n\n<p>first of all you don't need this block of code</p>\n\n<pre><code>if (list-&gt;next-&gt;next==NULL)\n{\n    c=list-&gt;next;\n    list-&gt;next=NULL;\n}\n</code></pre>\n\n<p>it would be dealt with in the next cycle anyway.</p>\n\n<p>That being said your function does remove the last element from the list.\nIt just does not return it or change it in your code in a way that you can see that.</p>\n\n<p>One option would be to return the last cell, instead of passing it as a parameter.</p>\n\n<pre><code>CellPtr last_cell_out(CellPtr *listPtr)\n{\n    CellPtr list = *listPtr;\n    if (list==NULL)/*if list is empty*/\n        return NULL;/*doing nothing*/\n    if (list-&gt;next==NULL)/*if theres only one cell in the list*/\n    {\n        *listPtr = NULL;\n        return list;/*deleting from list and return*/\n    }\n    return last_cell_out(&amp;(list-&gt;next));\n}\n</code></pre>\n\n<p>The second variant would pass the c as a pointer so you can change it's contents inside the code.</p>\n\n<pre><code>void last_cell_out(CellPtr *listPtr, CellPtr *c)\n{\n    CellPtr list = *listPtr;\n    if (list==NULL)/*if list is empty*/\n    {\n        *c = NULL;\n        return;/*doing nothing*/\n    }\n    if (list-&gt;next==NULL)/*if theres only one cell in the list*/\n    {\n        *c=list;\n        *listPtr = NULL;\n        return;/*deleting from list and moving to c*/\n    }\n    last_cell_out(&amp;((*listPtr)-&gt;next), c);\n    return;\n}\n</code></pre>\n\n<p>You can also completely avoid recursion to avoid a possible stack overflow if your list becomes too large.</p>\n\n<pre><code>CellPtr last_cell_out(CellPtr *listPtr)\n{\n    CellPtr list = *listPtr;\n    if(list == NULL)\n        return NULL;\n\n    if(list-&gt;next == NULL) {\n        *listPtr = NULL;\n        return list;\n    }\n\n    while(list-&gt;next-&gt;next != NULL)\n        list = list-&gt;next;\n\n    CellPtr tmp = list-&gt;next;\n    list-&gt;next = NULL;\n    return tmp;\n}\n</code></pre>\n\n<p>Complete test program:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n\ntypedef struct cell *CellPtr;\ntypedef struct cell\n{\n    int contents; /* contents of the cell */\n    CellPtr next; /* next cell in the list */\n} Cell;\n\nCellPtr last_cell_out(CellPtr *listPtr)\n{\n    CellPtr list = *listPtr;\n    if(list == NULL)\n        return NULL;\n\n    if(list-&gt;next == NULL) {\n        *listPtr = NULL;\n        return list;\n    }\n\n    while(list-&gt;next-&gt;next != NULL)\n        list = list-&gt;next;\n\n    CellPtr tmp = list-&gt;next;\n    list-&gt;next = NULL;\n    return tmp;\n}\n\nCellPtr new_first_cell(CellPtr list, CellPtr c)\n{\n    c-&gt;next=list;\n    return c;/*returnes the start of the list*/\n}\n\nvoid show_list(CellPtr list)\n{\n    if(list == NULL) {\n        printf(\"\\n\");\n        return;\n    }\n\n    printf(\"%d \", list-&gt;contents);\n    show_list(list-&gt;next);\n}\n\nint main()\n{\n    CellPtr list = NULL;\n    CellPtr out;\n    int i;\n\n    show_list(list);\n\n    CellPtr elem = malloc(sizeof(struct cell));\n    elem-&gt;contents = 0;\n    list = new_first_cell(list, elem);\n\n    show_list(list);\n\n    out = last_cell_out(&amp;list);\n    show_list(list);\n    list = new_first_cell(list, out);\n    show_list(list);\n\n    for(i = 1; i &lt; 5; ++i) {\n        CellPtr elem = malloc(sizeof(struct cell));\n        elem-&gt;contents = i;\n        list = new_first_cell(list, elem);\n    }\n\n    show_list(list);\n    out = last_cell_out(&amp;list);\n    show_list(list);\n    list = new_first_cell(list, out);\n    show_list(list);\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 1, "last_activity_date": 1559667029, "last_edit_date": 1559667029, "creation_date": 1559659811, "answer_id": 56446325, "question_id": 56445697, "link": "https://stackoverflow.com/questions/56445697/moving-struct-from-end-of-one-list-to-start-of-another-list/56446325#56446325", "title": "moving struct from end of one list to start of another list", "body": "<p>The function <code>last_cell_out</code> has to accept its arguments by reference because it changes their original values. Otherwise the function will have undeifined behaviour because for example this statement</p>\n\n<pre><code>list=NULL;\n</code></pre>\n\n<p>does not changes the original value of the list. It only changes its local variable <code>list</code> defined as a parameter that has a copy of the vlaue of the original list.</p>\n\n<p>So the function should be defined at least the following way</p>\n\n<pre><code>void last_cell_out(CellPtr *list, CellPtr *c)\n{\n    if ( *list == NULL )/*if list is empty*/\n    {\n        *c = NULL;\n        return;/*doing nothing*/\n    }        \n    else if ( ( *list )-&gt;next == NULL )/*if theres only one cell in the list*/\n    {\n        *c = *list;\n        *list = NULL;\n        return;/*deleting from list and moving to c*/\n    }\n    else if ( ( *list )-&gt;next-&gt;next == NULL )\n    {\n        *c = ( *list )-&gt;next;\n        ( *list )-&gt;next = NULL;\n        return;/*deleting from list and moving to c*/\n    }\n    else\n    {\n        last_cell_out( &amp;( *list )-&gt;next, c );\n        return;/*doing nothing*/\n    }        \n}\n</code></pre>\n\n<p>Here is a demonstrative program.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nstruct Cell\n{\n    int data;\n    struct Cell *next;\n};\n\ntypedef struct Cell *CellPtr;\n\nvoid last_cell_out(CellPtr *list, CellPtr *c)\n{\n    if ( *list == NULL )/*if list is empty*/\n    {\n        *c = NULL;\n        return;/*doing nothing*/\n    }        \n    else if ( ( *list )-&gt;next == NULL )/*if theres only one cell in the list*/\n    {\n        *c = *list;\n        *list = NULL;\n        return;/*deleting from list and moving to c*/\n    }\n    else if ( ( *list )-&gt;next-&gt;next == NULL )\n    {\n        *c = ( *list )-&gt;next;\n        ( *list )-&gt;next = NULL;\n        return;/*deleting from list and moving to c*/\n    }\n    else\n    {\n        last_cell_out( &amp;( *list )-&gt;next, c );\n        return;/*doing nothing*/\n    }        \n}\n\nCellPtr new_first_cell(CellPtr list, CellPtr c)\n{\n    c-&gt;next = list;\n    return c;/*returnes the start of the list*/\n}\n\nvoid print_cells( CellPtr list )\n{\n    for ( CellPtr current = list; current != NULL; current = current-&gt;next )\n    {\n        printf( \"%d -&gt; \", current-&gt;data );\n    }\n\n    puts( \"NULL\" );\n}\n\nint main(void) \n{\n    CellPtr list = NULL;\n\n    CellPtr cell = malloc( sizeof( struct Cell ) );\n    cell-&gt;data = 1;\n\n    list = new_first_cell( list, cell );\n\n    print_cells( list );\n\n    last_cell_out( &amp;list, &amp;cell );\n\n    CellPtr list1 = NULL;\n\n    list1 = new_first_cell( list1, cell );\n\n    print_cells( list );\n    print_cells( list1 );\n\n    last_cell_out( &amp;list1, &amp;cell );\n\n    free( cell );\n\n    return 0;\n}\n</code></pre>\n\n<p>Its output is</p>\n\n<pre><code>1 -&gt; NULL\nNULL\n1 -&gt; NULL\n</code></pre>\n\n<p>Take into account that it is a bad idea to use a typedef for a pointer because it  sometimes confuses users.</p>\n\n<p>And the function <code>last_cell_out</code> can be written simpler without recursion. For example</p>\n\n<pre><code>void last_cell_out(CellPtr *list, CellPtr *c)\n{\n    if ( *list )\n    {\n        while ( ( *list )-&gt;next ) list = &amp;( *list )-&gt;next;\n    }\n\n    *c = *list;\n    *list = NULL;\n}\n</code></pre>\n\n<p>Or with recursion</p>\n\n<pre><code>void last_cell_out(CellPtr *list, CellPtr *c)\n{\n    if ( *list &amp;&amp; ( *list )-&gt;next )\n    {\n        last_cell_out( &amp;( *list )-&gt;next, c );\n    }\n    else\n    {\n        *c = *list;\n        *list = NULL;\n    }       \n}\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11361798, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-D-Ud08k1LHI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reWOwhJrtX0XluSoldmZZpJl7Nh2Q/mo/photo.jpg?sz=128", "display_name": "Daniel125", "link": "https://stackoverflow.com/users/11361798/daniel125"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 56445897, "answer_count": 2, "score": 0, "last_activity_date": 1559667029, "creation_date": 1559657492, "last_edit_date": 1559660137, "question_id": 56445697, "link": "https://stackoverflow.com/questions/56445697/moving-struct-from-end-of-one-list-to-start-of-another-list", "title": "moving struct from end of one list to start of another list", "body": "<p>I'm trying to write two functions: One that pushes out the last cell of a list, and another one to make that cell the first one in another list. Somehow, my functions don't work (and I've checked the other parts of my code many times).</p>\n\n<pre><code>void last_cell_out(CellPtr list, CellPtr c)\n{\n    if (list==NULL)/*if list is empty*/\n        return;/*doing nothing*/\n    if (list-&gt;next==NULL)/*if theres only one cell in the list*/\n    {\n        c=list;\n        list=NULL;\n        return;/*deleting from list and moving to c*/\n    }\n    if (list-&gt;next-&gt;next==NULL)\n    {\n        c=list-&gt;next;\n        list-&gt;next=NULL;\n    }\n    else\n        last_cell_out(list-&gt;next, c);\n    return;\n}\n\nCellPtr new_first_cell(CellPtr list, CellPtr c)\n{\n    c-&gt;next=list;\n    return c;/*returnes the start of the list*/\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 3, "creation_date": 1559656849, "post_id": 56445486, "comment_id": 99484473, "body": "2nd answer in first set is definitely incorrect. 3rd in the second set as well."}, {"owner": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "edited": false, "score": 0, "creation_date": 1559657057, "post_id": 56445486, "comment_id": 99484599, "body": "Read the documentation of the <code>printf</code>/<code>scanf</code> format specifiers <code>%f</code> and <code>%p</code> and what type you should supply as the corresponding argument. Compare this with the data types in the proposed function calls."}, {"owner": {"reputation": 480272, "user_id": 1968, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd630f72eef3790bfb4ef38d08c7f85?s=128&d=identicon&r=PG", "display_name": "Konrad Rudolph", "link": "https://stackoverflow.com/users/1968/konrad-rudolph"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1559657264, "post_id": 56445486, "comment_id": 99484708, "body": "@EugeneSh. The first two answers are both incorrect."}, {"owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 0, "creation_date": 1559657275, "post_id": 56445486, "comment_id": 99484716, "body": "It sounds like you&#39;re trying to scan or print a <code>float</code>, not a <code>float *</code>."}, {"owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 2, "creation_date": 1559657376, "post_id": 56445486, "comment_id": 99484767, "body": "It looks to be like 1. and 5. are correct in the first set; and 2. and 4. are correct in the second set."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1559657604, "post_id": 56445486, "comment_id": 99484905, "body": "Some of them will emit warnings - did you look at them?"}, {"owner": {"reputation": 9, "user_id": 10985885, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e87c72e59d03b2e7d1db0d57c86cfe46?s=128&d=identicon&r=PG&f=1", "display_name": "Du\u0161an Stojkovi\u0107", "link": "https://stackoverflow.com/users/10985885/du%c5%a1an-stojkovi%c4%87"}, "reply_to_user": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 0, "creation_date": 1559657637, "post_id": 56445486, "comment_id": 99484919, "body": "The answers I have commented in my question are from a friend and not from the actual test people. @ThomasJager In my textbook B is declared as <code>float*</code>."}, {"owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 0, "creation_date": 1559657687, "post_id": 56445486, "comment_id": 99484950, "body": "@Du\u0161anStojkovi\u0107 <code>B</code> is a <code>float *</code>, but it&#39;s being used as an array of <code>float</code>. The elements of the array have type <code>float</code>, and that&#39;s what you&#39;re reading and writing."}], "answers": [{"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 9, "last_activity_date": 1559657568, "last_edit_date": 1559657568, "creation_date": 1559657382, "answer_id": 56445661, "question_id": 56445486, "link": "https://stackoverflow.com/questions/56445486/how-many-ways-are-there-to-printf-and-scanf-a-float-variable/56445661#56445661", "title": "How many ways are there to printf() and scanf() a float* variable?", "body": "<p>Your understanding of which answers are correct are flawed.</p>\n\n<p>To print a value of type <code>float</code> using <code>printf</code>, you need to use the <code>%f</code> format specifier and pass a value of type <code>float</code>.   To read a value of type <code>float</code> with <code>scanf</code>, you also use the <code>%f</code> format specifier but pass a value of type <code>float *</code>.</p>\n\n<p>Regarding array indexing, the notation <code>A[N]</code> is exactly equivalent to <code>*(A + N)</code> and has the type of the array element, and <code>&amp;A[N]</code> is exactly equivalent to <code>A + N</code> and has type pointer to array element.</p>\n\n<p>Based on that, we have the following:</p>\n\n<pre><code>printf(\"%f\",B[i]);    // Correct\nprintf(\"%f\",&amp;B[i]);   // Incorrect, passing a float *, expected float\nprintf(\"%f\",B+i);     // Incorrect, passing a float *, expected float (same as prior)\nprintf(\"%p\",*(B+i));  // Incorrect, %p is used to print a pointer (expects a void *)\nprintf(\"%f\",*(B+i));  // Correct\n\nscanf(\"%f\", B[i]);    // Incorrect, passing a float, expected float *\nscanf(\"%f\", B+i);     // Correct\nscanf(\"%p\", B+i);     // Incorrect, %p is used to read a pointer (expects a void *)\nscanf(\"%f\", &amp;B[i]);   // Correct\nscanf(\"%f\", *(B+i));  // Incorrect, passing a float, expected a float *\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 9, "user_id": 10985885, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e87c72e59d03b2e7d1db0d57c86cfe46?s=128&d=identicon&r=PG&f=1", "display_name": "Du\u0161an Stojkovi\u0107", "link": "https://stackoverflow.com/users/10985885/du%c5%a1an-stojkovi%c4%87"}, "edited": false, "score": 0, "creation_date": 1559662550, "post_id": 56446832, "comment_id": 99487689, "body": "I agree with you that it doesn&#39;t make sense. These were just questions for an exam I&#39;m preparing and I don&#39;t think someone might use this in practice. The test should just measure how much I understand c."}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 1, "last_activity_date": 1559661592, "creation_date": 1559661592, "answer_id": 56446832, "question_id": 56445486, "link": "https://stackoverflow.com/questions/56445486/how-many-ways-are-there-to-printf-and-scanf-a-float-variable/56446832#56446832", "title": "How many ways are there to printf() and scanf() a float* variable?", "body": "<p><strong><code>float</code></strong> </p>\n\n<p>There are 2 ways to <code>printf</code> a float and 1 way to <code>scanf</code> them.</p>\n\n<pre><code>printf(\"%f\",  my_float);\nprintf(\"%lf\", my_float); // works fine but bad style\n\nscanf(\"%f\",  &amp;my_float);\n</code></pre>\n\n<p>(In the oldest C standard, <code>printf</code> didn't allow <code>%lf</code>)</p>\n\n<hr>\n\n<p><strong><code>float*</code></strong> </p>\n\n<p>There is one way to <code>printf</code> the pointer itself: </p>\n\n<pre><code>printf(\"%p\", ptr);\n</code></pre>\n\n<p>It doesn't make sense to read a pointer with <code>scanf</code>, but you can read to the memory pointed-at by the pointer <code>ptr</code> as:</p>\n\n<pre><code>scanf(\"%f\",  ptr); // no &amp; needed, it is already a pointer\n</code></pre>\n\n<hr>\n\n<p>Everything else from your examples doesn't make much sense. Printing an address is not printing a <code>float</code>. Applying various forms of arithmetic on the pointer such as <code>&amp;B[i]</code> versus <code>*(B+i)</code> have nothing whatsoever to do with the the printing. </p>\n"}], "owner": {"reputation": 9, "user_id": 10985885, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e87c72e59d03b2e7d1db0d57c86cfe46?s=128&d=identicon&r=PG&f=1", "display_name": "Du\u0161an Stojkovi\u0107", "link": "https://stackoverflow.com/users/10985885/du%c5%a1an-stojkovi%c4%87"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "accepted_answer_id": 56445661, "answer_count": 2, "score": -3, "last_activity_date": 1572360128, "creation_date": 1559656748, "last_edit_date": 1572360128, "question_id": 56445486, "link": "https://stackoverflow.com/questions/56445486/how-many-ways-are-there-to-printf-and-scanf-a-float-variable", "title": "How many ways are there to printf() and scanf() a float* variable?", "body": "<p>I'm preparing for my graduation test and I have some questions regarding the c programming language. I will combine two of these questions which I have answers for, but I don't really understand them. The first question is select the correct expression that outputs the value of the <em>i</em>-th element of the array and these are the possible answers:\n(note that the code for both questions is the same)</p>\n\n<ol>\n<li><code>printf(\"%f\",B[i]);</code></li>\n<li><code>printf(\"%f\",&amp;B[i]);</code> </li>\n<li><code>printf(\"%f\",B+i);</code></li>\n<li><code>printf(\"%p\",*(B+i));</code></li>\n<li><code>printf(\"%f\",*(B+i));</code></li>\n</ol>\n\n<p>The second question is select the correct expression that inputs the value of the i-th element of the array</p>\n\n<ol>\n<li><code>scanf(\"%f\", B[i]);</code></li>\n<li><code>scanf(\"%f\", B+i);</code></li>\n<li><code>scanf(\"%p\", B+i);</code></li>\n<li><code>scanf(\"%f\", &amp;B[i]);</code> </li>\n<li><code>scanf(\"%f\", *(B+i));</code></li>\n</ol>\n\n<p>I tried to compile and run a program that simulates these questions. The <code>scanf</code> part works for the answers 2-5 and all of the <code>printf</code>s print out a zero except the 4<sup>th</sup> one (of course after input).</p>\n\n<pre><code>float *B;\nint n;\nB=calloc(n,sizeof(float));\n</code></pre>\n"}, {"tags": ["c", "i2c", "infineon"], "comments": [{"owner": {"reputation": 1127, "user_id": 1796858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c1b4f442048641cf0656ab4cdc4b6ec?s=128&d=identicon&r=PG", "display_name": "Owl", "link": "https://stackoverflow.com/users/1796858/owl"}, "edited": false, "score": 0, "creation_date": 1559657348, "post_id": 56445479, "comment_id": 99484753, "body": "Best thing to do is get an USB to i2c evaluation board. It shows up as a tty usb device. Use this first, get your I2C lib working. then do specific devices"}, {"owner": {"reputation": 259, "user_id": 4526054, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N5Ub5.jpg?s=128&g=1", "display_name": "brhans", "link": "https://stackoverflow.com/users/4526054/brhans"}, "edited": false, "score": 3, "creation_date": 1559658189, "post_id": 56445479, "comment_id": 99485210, "body": "If you&#39;re bit-banging the I2C comms (which is what I assume you mean by &quot;I implement it as GPIO&quot;) then you should show us how you&#39;ve implemented your <code>I2C_xxx</code> functions."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1559683351, "post_id": 56445479, "comment_id": 99496314, "body": "usually, when accessing a device via I2C, the command to read a value from the device is &lt;start&gt;&lt;deviceAddress&gt;&lt;writeCommand&gt;&lt;deviceAction&gt;&lt;addressTo&zwnj;&#8203;Read&gt;&lt;numberOfBytesT&zwnj;&#8203;oRead&gt;&lt;stop&gt;  Then input the ACK/NAK then if ACK received then output a similar set of data to transfer the actual data via &lt;start&gt;&lt;deviceAddress&gt;&lt;readCommand&gt;&lt;stop&gt; then &lt;read actual data bytes&gt;  And since your &#39;bit banging&#39; the I/O, also need to be appropriately setting/resetting the port used for the clock signal."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1559683786, "post_id": 56445479, "comment_id": 99496435, "body": "strongly suggest reading the web page: &lt;<a href=\"https://www.google.com/search?client=ubuntu&amp;channel=fs&amp;q=i2c+protocol&amp;ie=utf-8&amp;oe=utf-8\" rel=\"nofollow noreferrer\">google.com/&hellip;</a>&gt; and the resulting documents on I2C like: `&lt;<a href=\"https://i2c.info/\" rel=\"nofollow noreferrer\">i2c.info</a>&gt;"}], "owner": {"reputation": 1, "user_id": 10139369, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-R9rxCkYB14A/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7qVAwMwN9gr02UYCP6IJbUGJxPjLA/mo/photo.jpg?sz=128", "display_name": "\uae40\uc2dc\ud604", "link": "https://stackoverflow.com/users/10139369/%ea%b9%80%ec%8b%9c%ed%98%84"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 153, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1559662002, "creation_date": 1559656725, "last_edit_date": 1559662002, "question_id": 56445479, "link": "https://stackoverflow.com/questions/56445479/i2c-from-master-to-slave-communication-problem", "title": "I2C from master to slave communication problem", "body": "<p>I am using TC237 and the board does not provide I2C communication, so I implement it as GPIO.\nReads and writes through registers, but no master-slave communication.</p>\n\n<p>According to the I2C communication protocol, the start-stop ACK NACK function code was created.\nI also create a 1-byte write and read code, and based on it I create code to read and write to the registers of the slave.</p>\n\n<p>I do not know how to upload a picture, but when I check the SDA and SCL with the oscilloscope, when I read it, it seems that there are two bytes to read and the rest is OK. The first byte reads 0x00 and the next byte reads 0xEF.</p>\n\n<pre><code>I2C_Start();\nwaitTime(1*TimeConst_100us);\n\nI2C_WriteByte((uint8)(Slave_addr|0x01));//LIDAR : 0xC5/BH1750 : 0x27\nI2C_ACK();//I2C_GetACK();\n\nI2C_ReadData_H = I2C_ReadByte();\nI2C_ACK();\n\nwaitTime(1*TimeConst_100us);\n\nI2C_ReadData_L = I2C_ReadByte();\nwaitTime(1*TimeConst_100us);\nif(I2C_NACK() == BUSY)\n{\nreturn RESET;\n}\nI2C_Stop();\nreturn SET;\n</code></pre>\n\n<p>The result should be received by the internal IC, but it receives a strange value.\nThe suspicious part seems to not receive an ACK from the device after reading the first byte, what should I do?</p>\n"}]