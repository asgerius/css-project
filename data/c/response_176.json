[{"tags": ["c", "gps", "tiff", "luajit", "libtiff"], "comments": [{"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1564411141, "post_id": 50498812, "comment_id": 101011772, "body": "FWIW all your statements so far sound correct"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1564411170, "post_id": 50498812, "comment_id": 101011785, "body": "<i>&quot;there are no LibTIFF names for the fields inside the GPS IFD&quot;</i> doesn&#39;t matter just  use <a href=\"https://sno.phy.queensu.ca/~phil/exiftool/TagNames/GPS.html\" rel=\"nofollow noreferrer\">the tag IDs</a>"}], "owner": {"reputation": 41, "user_id": 6945826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a260e2ddb9fe7947ccc50134cb5ab4f6?s=128&d=identicon&r=PG", "display_name": "dirtbirb", "link": "https://stackoverflow.com/users/6945826/dirtbirb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 161, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1527799402, "creation_date": 1527117978, "last_edit_date": 1527799402, "question_id": 50498812, "link": "https://stackoverflow.com/questions/50498812/add-gps-tags-in-libtiff", "title": "Add GPS tags in libtiff", "body": "<p>I need to add GPS metadata to TIFF / DNG images using LibTIFF. I know very little about LibTIFF. To be extra annoying, I have to hack this into an existing LuaJIT module with minimal footprint (Edit: to be clear, I don't need an answer in LuaJIT!).</p>\n\n<p>From <a href=\"https://stackoverflow.com/questions/11959617/in-a-tiff-create-a-sub-ifd-with-thumbnail-libtiff#11998400\">this question</a>, it seems like I need to set the TIFFTAG_SUBIFD field first, then write the main IFD, then write the GPS IFD. I'm confused on two points: </p>\n\n<ol>\n<li><p>There's a special LibTIFF name for TIFFTAG_GPSIFD, and I'm not sure where that comes in, or if that's supposed to happen in place of setting TIFFTAG_SUBIFD.</p></li>\n<li><p>I don't know how to assemble the GPS IFD in the first place. If indeed I'm supposed to set TIFFTAG_SUBIFD and use TIFFWriteDirectory() to close the main IFD, I assume that any following calls to TIFFSetField() will write to the GPS IFD, but there are no LibTIFF names for the fields inside the GPS IFD. That makes me think I'm missing something.</p></li>\n</ol>\n\n<p>I imagine it's clear that I don't really know what I'm doing with LibTIFF, so any help is appreciated. Feel free to ignore the fact that I'm in LuaJIT and just tell me what this might look like in C.</p>\n\n<p>For reference, <a href=\"https://stackoverflow.com/questions/19371620/how-to-add-gps-metadata-to-tiff-in-java\">this question</a> seems to accomplish the same task in Java, but I don't understand it well enough to translate.</p>\n\n<p>Finally, here's a general idea of what I have now, but this is obviously incomplete. the \"v_int\" style functions are just helpers to return the appropriate C variable from ffi.new().</p>\n\n<pre><code>local fdt = tiff.TIFFOpen(ofname, 'w')\n\n-- Set all the fields in the main IFD here\n-- ...\n\nif self.scfg.gps then\n    -- Prepare libtiff for a subIFD\n    -- https://stackoverflow.com/questions/11959617/in-a-tiff-create-a-sub-ifd-with-thumbnail-libtiff#11998400\n    subifd_n = v_int(1)\n    subifd_offsets = ffi.new(string.format('toff_t[%i]', subifd_n), {v_uint32(0)})\n    tiff.TIFFSetField(fdt, C.TIFFTAG_SUBIFD, v_int(subifd_n), subifd_offsets)\nend\n\nlocal bytes_per_pixel = self.sample_depth / 8\ntiff.TIFFWriteRawStrip(fdt, 0, data_raw, self.frame_height * self.frame_width * bytes_per_pixel)\n\nif self.scfg.gps then\n    tiff.TIFFWriteDirectory(fdt)    -- Finish main IFD\n    b2 = v_unit8(2)\n    b0 = v_uint8(0)\n    tiff.TIFFSetField(fdt, 0, b2, b2, b0, b0)   -- GPSVersionID\nend\n\ntiff.TIFFClose(fdt)   -- Closes currently-open IFD (?)\n</code></pre>\n\n<p>Any help is very much appreciated!</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1527117871, "post_id": 50498760, "comment_id": 88010390, "body": "Better omit the entire typedef and just use the struct:<code>struct lligada *foo = ... ;</code>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 4, "creation_date": 1527117975, "post_id": 50498760, "comment_id": 88010417, "body": "&quot;Wouldn&#39;t this be simpler?&quot; --&gt; Yes, and less confusing."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1527118143, "post_id": 50498760, "comment_id": 88010452, "body": "It is unlikely your school will change.  Sometimes the university is stuck in  rut, in a rut, in a rut, in a rut."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1527118323, "post_id": 50498760, "comment_id": 88010504, "body": "In your second example the struct has a different tag, was that intentional?"}, {"owner": {"reputation": 51, "user_id": 9837471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbf869c1acfac565d80a09e0f98615ed?s=128&d=identicon&r=PG&f=1", "display_name": "rybur", "link": "https://stackoverflow.com/users/9837471/rybur"}, "edited": false, "score": 0, "creation_date": 1527118464, "post_id": 50498760, "comment_id": 88010549, "body": "no I just forgot to change it"}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1527118349, "post_id": 50498840, "comment_id": 88010513, "body": "Not complaining about your answer, yet it is surprising to see a post-able answer after <i>marked as duplicate</i>."}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1527118506, "post_id": 50498840, "comment_id": 88010562, "body": "@chux I was surprised to be able to post it as well. Must have been a race condition."}, {"owner": {"reputation": 51, "user_id": 9837471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbf869c1acfac565d80a09e0f98615ed?s=128&d=identicon&r=PG&f=1", "display_name": "rybur", "link": "https://stackoverflow.com/users/9837471/rybur"}, "edited": false, "score": 0, "creation_date": 1527118580, "post_id": 50498840, "comment_id": 88010574, "body": "I understand your answer but the thing is even with the struct defined with the typedef and the start they still do the declarations with the star, is there any reason for that? isn&#39;t that using a double pointer?"}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "reply_to_user": {"reputation": 51, "user_id": 9837471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbf869c1acfac565d80a09e0f98615ed?s=128&d=identicon&r=PG&f=1", "display_name": "rybur", "link": "https://stackoverflow.com/users/9837471/rybur"}, "edited": false, "score": 0, "creation_date": 1527118644, "post_id": 50498840, "comment_id": 88010598, "body": "@rybur Yes. If they add another star the variable will be a doubly-indirect pointer."}, {"owner": {"reputation": 51, "user_id": 9837471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbf869c1acfac565d80a09e0f98615ed?s=128&d=identicon&r=PG&f=1", "display_name": "rybur", "link": "https://stackoverflow.com/users/9837471/rybur"}, "edited": false, "score": 0, "creation_date": 1527118814, "post_id": 50498840, "comment_id": 88010653, "body": "and is that useful in anyway? or bad?"}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "reply_to_user": {"reputation": 51, "user_id": 9837471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbf869c1acfac565d80a09e0f98615ed?s=128&d=identicon&r=PG&f=1", "display_name": "rybur", "link": "https://stackoverflow.com/users/9837471/rybur"}, "edited": false, "score": 0, "creation_date": 1527119128, "post_id": 50498840, "comment_id": 88010734, "body": "@rybur I&#39;d say it&#39;s mostly bad. At worst it&#39;ll confuse someone, at best it&#39;ll save you from having to type an <code>*</code>.  The scales seem to be tipped against it."}], "tags": [], "owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "is_accepted": true, "score": 1, "last_activity_date": 1527118570, "last_edit_date": 1527118570, "creation_date": 1527118199, "answer_id": 50498840, "question_id": 50498760, "link": "https://stackoverflow.com/questions/50498760/c-using-a-pointer-to-a-pointer-to-a-struct/50498840#50498840", "title": "C using a pointer to a pointer to a struct", "body": "<pre><code>typedef struct llist {\n    int valor;\n    struct lligada *prox;\n} *LInt;\n</code></pre>\n\n<p>makes  <code>LInt</code> equivalent to <code>struct llist*</code> (with the star included). \nThis practice of typedefing pointers is pretty much discouraged in all modern resources\non C I've come across but it has been used historically, notably the lcc compiler\nuses this practice a lot (their convention capitalizes the pointer typedefed name as well).</p>\n\n<p>The problem with typedefing pointers is that it's potentially confusing and\nyou can suddenly pass 0 (as NULL) with a special value through them, however if you \nhave a naming convention (such as capitalizing each pointer typedef) then \nthe star is effectively not hidden but just expressed as an upper case letter,\nalthough it might still be confusing to someone foreign to your codebase.</p>\n\n<p>So to summarize, with </p>\n\n<pre><code>typedef struct llist {\n    int valor;\n    struct lligada *prox;\n} *LInt;\n</code></pre>\n\n<p>you'd then use it like so:</p>\n\n<pre><code>LInt foo = NULL; \n</code></pre>\n\n<p>whereas without the star in the typedef, the above would be:</p>\n\n<pre><code>LInt *foo = NULL; \n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 9837471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbf869c1acfac565d80a09e0f98615ed?s=128&d=identicon&r=PG&f=1", "display_name": "rybur", "link": "https://stackoverflow.com/users/9837471/rybur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "closed_date": 1527118048, "accepted_answer_id": 50498840, "answer_count": 1, "score": 3, "last_activity_date": 1527118570, "creation_date": 1527117514, "question_id": 50498760, "link": "https://stackoverflow.com/questions/50498760/c-using-a-pointer-to-a-pointer-to-a-struct", "closed_reason": "Duplicate", "title": "C using a pointer to a pointer to a struct", "body": "<pre><code>typedef struct llist {\n    int valor;\n    struct lligada *prox;\n} *LInt;\n</code></pre>\n\n<p>So this is how linked lists are implemented in C at my university and I have been wondering why in the last line they put a pointer to LInt instead of just LInt.</p>\n\n<pre><code>typedef struct lligada {\n    int valor;\n    struct lligada *prox;\n} LInt;\n</code></pre>\n\n<p>Wouldn't this be simpler? I mean it's this last example that I see in tutorials around the web and if we want a pointer to the struct we would just write something like</p>\n\n<pre><code>LInt *foo = ...;\n</code></pre>\n\n<p>What confuses me is that they declare the pointer in the struct and in the exercises they still do the declaration above. Is there any special reason for this? Is this normal? They also do this for binary trees.</p>\n"}, {"tags": ["c", "jar", "software-distribution"], "comments": [{"owner": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 1, "creation_date": 1527117232, "post_id": 50498714, "comment_id": 88010241, "body": "perhaps you should investigate base64: <a href=\"https://stackoverflow.com/q/342409/1212725\">stackoverflow.com/q/342409/1212725</a>"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1527123096, "post_id": 50498714, "comment_id": 88011523, "body": "Indeed. Base64 is the standard way to encode arbitrary binary data as a sequence of printable characters."}, {"owner": {"reputation": 535, "user_id": 2277013, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/48932ff6c4b1e70778833e41ae832507?s=128&d=identicon&r=PG", "display_name": "Sam Thomas", "link": "https://stackoverflow.com/users/2277013/sam-thomas"}, "reply_to_user": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 0, "creation_date": 1527143808, "post_id": 50498714, "comment_id": 88017327, "body": "@bruceg thanks for the link, there is an answer there that compares many implementations and shows the best encoding and the best decoding implementation. Can I use the best of both or do I have to stick a complete implementation?"}, {"owner": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 0, "creation_date": 1527190358, "post_id": 50498714, "comment_id": 88046236, "body": "@SamThomas base64 is a standard. you can use the encoder from one implementation, and the decoder from another. Back in the dark ages when I had to do it myself, I always used a simple table driven approach."}, {"owner": {"reputation": 535, "user_id": 2277013, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/48932ff6c4b1e70778833e41ae832507?s=128&d=identicon&r=PG", "display_name": "Sam Thomas", "link": "https://stackoverflow.com/users/2277013/sam-thomas"}, "reply_to_user": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 0, "creation_date": 1527190828, "post_id": 50498714, "comment_id": 88046484, "body": "@bruceg Cool Thanks :D"}, {"owner": {"reputation": 535, "user_id": 2277013, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/48932ff6c4b1e70778833e41ae832507?s=128&d=identicon&r=PG", "display_name": "Sam Thomas", "link": "https://stackoverflow.com/users/2277013/sam-thomas"}, "reply_to_user": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 0, "creation_date": 1528144921, "post_id": 50498714, "comment_id": 88386663, "body": "@bruceg Can you submit an answer? I&#39;ll accept it and lets close this :D"}, {"owner": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 1, "creation_date": 1528146511, "post_id": 50498714, "comment_id": 88387306, "body": "@SamThomas here&#39;s the consolidated information in the answer below.  Hope it helps!"}], "answers": [{"tags": [], "owner": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "is_accepted": true, "score": 1, "last_activity_date": 1528146481, "creation_date": 1528146481, "answer_id": 50688796, "question_id": 50498714, "link": "https://stackoverflow.com/questions/50498714/c-read-binary-and-write-as-encoded-text/50688796#50688796", "title": "C: Read Binary and Write as encoded text", "body": "<p>You can use base64 encoding for this.  Base64 is a standard, and you can use the encoder from one implementation, and the decoder from another, and you'd get back the original string on the other side.  The typical straightforward implementation is a table driven one, as in this answer here:  <a href=\"https://stackoverflow.com/a/6782480/1212725\">https://stackoverflow.com/a/6782480/1212725</a></p>\n"}], "owner": {"reputation": 535, "user_id": 2277013, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/48932ff6c4b1e70778833e41ae832507?s=128&d=identicon&r=PG", "display_name": "Sam Thomas", "link": "https://stackoverflow.com/users/2277013/sam-thomas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 50688796, "answer_count": 1, "score": 0, "last_activity_date": 1528146481, "creation_date": 1527117132, "question_id": 50498714, "link": "https://stackoverflow.com/questions/50498714/c-read-binary-and-write-as-encoded-text", "title": "C: Read Binary and Write as encoded text", "body": "<p>I wish to read a jar in binary mode and write the binary as string(encoded if need be) to a file.\nThis string would be included in code to be read and converted back into binary and written as a jar file.</p>\n\n<p>I'm trying to replicate what get-pip.py has done to distribute pip.</p>\n\n<p>What would be the best way to do this in C?</p>\n"}, {"tags": ["c", "scanf"], "comments": [{"owner": {"reputation": 553, "user_id": 9023746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b85e883dde2b07ffd09399d44ac9335?s=128&d=identicon&r=PG", "display_name": "sjdm", "link": "https://stackoverflow.com/users/9023746/sjdm"}, "edited": false, "score": 0, "creation_date": 1527116417, "post_id": 50498548, "comment_id": 88010029, "body": "Is there a reason you have a space before the integer %d identifier within the quotes of your scanf"}, {"owner": {"reputation": 553, "user_id": 9023746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b85e883dde2b07ffd09399d44ac9335?s=128&d=identicon&r=PG", "display_name": "sjdm", "link": "https://stackoverflow.com/users/9023746/sjdm"}, "edited": false, "score": 0, "creation_date": 1527116437, "post_id": 50498548, "comment_id": 88010037, "body": "choice = scanf(&quot;%d&quot;, &amp;choice); try without the space"}, {"owner": {"reputation": 5, "user_id": 6600366, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yAv8f.jpg?s=128&g=1", "display_name": "Satvik_08", "link": "https://stackoverflow.com/users/6600366/satvik-08"}, "reply_to_user": {"reputation": 553, "user_id": 9023746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b85e883dde2b07ffd09399d44ac9335?s=128&d=identicon&r=PG", "display_name": "sjdm", "link": "https://stackoverflow.com/users/9023746/sjdm"}, "edited": false, "score": 0, "creation_date": 1527116610, "post_id": 50498548, "comment_id": 88010075, "body": "it&#39;s not working"}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 6600366, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yAv8f.jpg?s=128&g=1", "display_name": "Satvik_08", "link": "https://stackoverflow.com/users/6600366/satvik-08"}, "edited": false, "score": 0, "creation_date": 1527117457, "post_id": 50498586, "comment_id": 88010296, "body": "please take a look at my another screenshot that i uploaded."}, {"owner": {"reputation": 353, "user_id": 5768266, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mP1j8.gif?s=128&g=1", "display_name": "StereoBucket", "link": "https://stackoverflow.com/users/5768266/stereobucket"}, "reply_to_user": {"reputation": 5, "user_id": 6600366, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yAv8f.jpg?s=128&g=1", "display_name": "Satvik_08", "link": "https://stackoverflow.com/users/6600366/satvik-08"}, "edited": false, "score": 0, "creation_date": 1527117888, "post_id": 50498586, "comment_id": 88010398, "body": "@Satvik_08 Either create a separate variable that will hold the return value of scanf or don&#39;t store the return value. so either <code>int ret_val = scanf(&quot;%d&quot;, &amp;value)</code> or <code>scanf(&quot;%d&quot;, &amp;value);</code> same goes for the line that gets the choice. What you are currently doing is overwriting your choice and value with the scanf&#39;s return which in this case is 1 (but could be 0 or EOF)."}], "tags": [], "owner": {"reputation": 353, "user_id": 5768266, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mP1j8.gif?s=128&g=1", "display_name": "StereoBucket", "link": "https://stackoverflow.com/users/5768266/stereobucket"}, "is_accepted": true, "score": 3, "last_activity_date": 1527116100, "creation_date": 1527116100, "answer_id": 50498586, "question_id": 50498548, "link": "https://stackoverflow.com/questions/50498548/why-is-scanf-not-taking-my-second-input/50498586#50498586", "title": "Why is scanf() not taking my second input?", "body": "<p><code>int value = scanf(\"%d\", &amp;value);</code></p>\n\n<p>scanf returns the number of items successfully read. Since you're reading 1 item and it is successful that is then written into the value variable, overwriting the 4 that scanf wrote into it before returning.\nSo to be clear, it is reading the 2nd input, but the input you recorded is immediately overwritten.</p>\n"}], "owner": {"reputation": 5, "user_id": 6600366, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yAv8f.jpg?s=128&g=1", "display_name": "Satvik_08", "link": "https://stackoverflow.com/users/6600366/satvik-08"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 50498586, "answer_count": 1, "score": -1, "last_activity_date": 1527133546, "creation_date": 1527115765, "last_edit_date": 1527133546, "question_id": 50498548, "link": "https://stackoverflow.com/questions/50498548/why-is-scanf-not-taking-my-second-input", "title": "Why is scanf() not taking my second input?", "body": "<p>Why is <strong>scanf()</strong> not taking input for the second time as we can clearly see from the screenshot it is using the same value provided to it for the first input?</p>\n\n<p><a href=\"https://i.stack.imgur.com/sx8Xw.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/sx8Xw.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;malloc.h&gt;\n\nstruct NODE{\nint data;\nstruct NODE *link;\n};\nstruct NODE *head = NULL;\nint currentSize = 0;\n\nvoid print(){\nstruct NODE *ptr = head;\n\n//Printing the whole linked list;\nwhile(ptr){\n    printf(\"%d\", ptr-&gt;data);\n    ptr = ptr-&gt;link;\n    }\n}\n\nvoid insert(int value){\n\n//if this is the first element in the linked list\nif(head == NULL){      \n    head = (struct NODE *)malloc(sizeof(struct NODE));\n    head-&gt;data = value;\n    currentSize = 1;\n    return;\n}\n\n//if we traverse the linked list to the last element and then we the element\nstruct NODE *ptr = head; \n\n//traversing\nwhile(ptr-&gt;link != NULL)\nptr = ptr-&gt;link;\n\n//new node creation and adding it to the linked list\nstruct NODE *new = (struct NODE *)malloc(sizeof(struct NODE));\ncurrentSize += 1;\nnew-&gt;data = value;\nnew-&gt;link = ptr-&gt;link;\nptr-&gt;link = new;\n}\n\nint main(){\nprintf(\"Options:\\n1. Insert a node\\n4. Print the Linked List\\n5. Enter 0 to exit\\n\");\nprintf(\"\\nEnter your choice: \");\nint choice = scanf(\" %d\", &amp;choice);\nprintf(\"Value of Choice %d\\n\", choice);\nwhile(choice != 0){\n    if(choice == 1){\n        printf(\"Enter the Value: \");\n        int value = scanf(\"%d\", &amp;value);            \n        insert(value);\n    }\n    else if(choice == 4)\n        print();\n    else\n        printf(\"Wrong Input\");\n\n    printf(\"\\nEnter your choice: \");\n    choice = scanf(\" %d\", &amp;choice);\n    printf(\"Value of Choice %d\\n\", choice);\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "string", "pointers", "struct", "linked-list"], "comments": [{"owner": {"reputation": 4598, "user_id": 9264702, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mHczh.jpg?s=128&g=1", "display_name": "Stephen Docy", "link": "https://stackoverflow.com/users/9264702/stephen-docy"}, "edited": false, "score": 5, "creation_date": 1527115182, "post_id": 50498430, "comment_id": 88009739, "body": "Don&#39;t hide pointers behind a typedef...very confusing and error-prone."}, {"owner": {"reputation": 39, "user_id": 9700866, "user_type": "registered", "profile_image": "https://graph.facebook.com/1727463590648720/picture?type=large", "display_name": "Rafael Santos", "link": "https://stackoverflow.com/users/9700866/rafael-santos"}, "reply_to_user": {"reputation": 4598, "user_id": 9264702, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mHczh.jpg?s=128&g=1", "display_name": "Stephen Docy", "link": "https://stackoverflow.com/users/9264702/stephen-docy"}, "edited": false, "score": 0, "creation_date": 1527115760, "post_id": 50498430, "comment_id": 88009884, "body": "I find it easier to work like that xD"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1527115787, "post_id": 50498430, "comment_id": 88009890, "body": "<a href=\"https://stackoverflow.com/questions/750178/is-it-a-good-idea-to-typedef-pointers\">is it a good idea to typedef pointers</a>"}], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 9700866, "user_type": "registered", "profile_image": "https://graph.facebook.com/1727463590648720/picture?type=large", "display_name": "Rafael Santos", "link": "https://stackoverflow.com/users/9700866/rafael-santos"}, "edited": false, "score": 0, "creation_date": 1527115844, "post_id": 50498489, "comment_id": 88009904, "body": "I have a lot of trouble with dynamic allocation, and I still don&#39;t understand it pretty well. Should I allocate the struct in the mklist() function?"}, {"owner": {"reputation": 4598, "user_id": 9264702, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mHczh.jpg?s=128&g=1", "display_name": "Stephen Docy", "link": "https://stackoverflow.com/users/9264702/stephen-docy"}, "reply_to_user": {"reputation": 39, "user_id": 9700866, "user_type": "registered", "profile_image": "https://graph.facebook.com/1727463590648720/picture?type=large", "display_name": "Rafael Santos", "link": "https://stackoverflow.com/users/9700866/rafael-santos"}, "edited": false, "score": 0, "creation_date": 1527116082, "post_id": 50498489, "comment_id": 88009956, "body": "You should allocate memory whenever you are adding and filling in a new node in your list.  Think of <code>malloc()</code> as actually building the struct for you to store information in.  <code>malloc()</code> within a function is perfectly fine, the memory is yours until you explicitly free it.  As long as you return a pointer to the new memory or correctly update existing pointers to point to it, you will maintain access to the memory."}, {"owner": {"reputation": 4598, "user_id": 9264702, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mHczh.jpg?s=128&g=1", "display_name": "Stephen Docy", "link": "https://stackoverflow.com/users/9264702/stephen-docy"}, "reply_to_user": {"reputation": 39, "user_id": 9700866, "user_type": "registered", "profile_image": "https://graph.facebook.com/1727463590648720/picture?type=large", "display_name": "Rafael Santos", "link": "https://stackoverflow.com/users/9700866/rafael-santos"}, "edited": false, "score": 0, "creation_date": 1527116172, "post_id": 50498489, "comment_id": 88009975, "body": "Memory allocation is a tricky subject to grasp at first, so stick with it.  Eventually, data structures like linked lists will become second-nature if you keep playing with them."}, {"owner": {"reputation": 39, "user_id": 9700866, "user_type": "registered", "profile_image": "https://graph.facebook.com/1727463590648720/picture?type=large", "display_name": "Rafael Santos", "link": "https://stackoverflow.com/users/9700866/rafael-santos"}, "edited": false, "score": 0, "creation_date": 1527116619, "post_id": 50498489, "comment_id": 88010078, "body": "Thanks a lot, it solved the problem. I will study more about pointers and allocation so it won&#39;t be a nightmare anymore haha."}], "tags": [], "owner": {"reputation": 4598, "user_id": 9264702, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mHczh.jpg?s=128&g=1", "display_name": "Stephen Docy", "link": "https://stackoverflow.com/users/9264702/stephen-docy"}, "is_accepted": false, "score": 1, "last_activity_date": 1527115806, "last_edit_date": 1527115806, "creation_date": 1527115406, "answer_id": 50498489, "question_id": 50498430, "link": "https://stackoverflow.com/questions/50498430/why-is-this-linked-list-initialization-not-working/50498489#50498489", "title": "Why is this linked-list initialization not working?", "body": "<p>So <code>node</code> is actually a pointer to a <code>struct node</code>, very confusing</p>\n\n<pre><code>typedef struct node* node;\n</code></pre>\n\n<p>In <code>main()</code> you declare a pointer and pass a pointer to a pointer to <code>mklist()</code></p>\n\n<pre><code>node n;\nmklist(&amp;n);\n</code></pre>\n\n<p>In <code>mklist()</code>, <code>n</code> is actually a pointer to a pointer to the struct, so derefencing it, you get a pointer to a struct</p>\n\n<pre><code>void mklist(node* n){\n    (*n)-&gt;times=0;\n</code></pre>\n\n<p>but nowhere in your code have you allocated memory for an actual struct.</p>\n\n<p>The most straightforward fix with the way your code is currently is to add a <code>malloc()</code></p>\n\n<pre><code>void mklist(node* n) {\n    *n = malloc(sizeof(*(*n)));\n    // check for malloc() failure\n\n    (*n)-&gt;times = 0;\n    strcpy((*n)-&gt;name, \"null\");\n    strcpy((*n)-&gt;number, \"null\");\n    (*n)-&gt;next = (node)NULL;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user539810"}, "is_accepted": false, "score": 0, "last_activity_date": 1527117238, "creation_date": 1527117238, "answer_id": 50498728, "question_id": 50498430, "link": "https://stackoverflow.com/questions/50498430/why-is-this-linked-list-initialization-not-working/50498728#50498728", "title": "Why is this linked-list initialization not working?", "body": "<p>You can do this easily in the global scope:</p>\n\n<pre><code>// nil = &amp;nilObj, which means nil-&gt;next == nil.\n// \n// This way, there's no checking for both 'nil' and 'NULL'!\n// \n// As a consequence of this last point, you can make passing 'NULL'\n// to most list functions invalid: it just means the user didn't\n// use mklist() on every list they needed to manually work with.\nstatic struct node nilObj = { 0, \"null\", \"null\", &amp;nilObj };\nnode nil = &amp;nilObj;\n\nvoid mklist(node *n)\n{\n    *n = nil;\n}\n</code></pre>\n\n<p>As Stephen Docy mentioned, using <code>typedef T *Tname;</code> is generally a bad idea as it hides the fact that you're using a pointer, which can be confusing when you use <code>Tname *n</code> as <code>(*n)-&gt;foo</code> (I'd expect to use it as <code>n-&gt;foo</code> honestly).  Some APIs do this, but they do it in a way that expresses that the variable is a pointer to an object rather than an object: instead of <code>Node</code>, something like <code>NodeRef</code> or <code>NodePtr</code> is used, signifying in the name that it's a pointer to a node, not a node.  Apple's Core Foundation API uses names like this (e.g. <a href=\"https://developer.apple.com/documentation/corefoundation/cfstring-rfh\" rel=\"nofollow noreferrer\"><code>CFStringRef</code></a>).  I highly suggest adopting a convention similar to this henceforth.  The above code I posted might then look something like this:</p>\n\n<pre><code>static struct node nilObj = { 0, \"null\", \"null\", &amp;nilObj };\nnodeRef nil = &amp;nilObj;\n\nvoid mklist(nodeRef *n)\n{\n    *n = nil;\n}\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 9700866, "user_type": "registered", "profile_image": "https://graph.facebook.com/1727463590648720/picture?type=large", "display_name": "Rafael Santos", "link": "https://stackoverflow.com/users/9700866/rafael-santos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1527120986, "creation_date": 1527115040, "last_edit_date": 1527120986, "question_id": 50498430, "link": "https://stackoverflow.com/questions/50498430/why-is-this-linked-list-initialization-not-working", "title": "Why is this linked-list initialization not working?", "body": "<p>I'm trying to initialize (or create) a linked-list with an empty node pointing to <code>NULL</code>, but it's returning an error and I don't know why. Can somebody help me?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nstruct node {\n    int times;\n    char name[100];\n    char number[100];  \n    struct node* next;\n};\n\ntypedef struct node* node;\n\nvoid mklist(node* n) {\n    (*n)-&gt;times = 0;\n    strcpy((*n)-&gt;name, \"null\");\n    strcpy((*n)-&gt;number, \"null\");\n    (*n)-&gt;next = (node)NULL;\n}\n\nint main(void) {\n    node n;\n    mklist(&amp;n);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "gcc", "cmake"], "comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1527130706, "post_id": 50498265, "comment_id": 88013174, "body": "As specified in the referenced answer <b>Do not overwrite <code>CMAKE_C_COMPILER</code>, but export <code>CC</code> (and <code>CXX</code>) before calling <code>cmake</code></b>."}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1527151855, "post_id": 50498265, "comment_id": 88021963, "body": "Actually, the error &quot;The CMAKE_C_COMPILER is set to a C++ compiler&quot; seems to be self-explanatory: someone assign C++ compiler (<code>&#47;usr&#47;bin&#47;g++</code>) to the variable, denoted for C compiler. Instead, C++ compiler should be assigned to <code>CMAKE_CXX_COMPILER</code> variable, and <code>CMAKE_C_COMPILER</code> variable should be set to C compiler."}, {"owner": {"reputation": 498, "user_id": 1036361, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1d7a8fb2d53ad21e94bcec10773a80e2?s=128&d=identicon&r=PG", "display_name": "SailorCire", "link": "https://stackoverflow.com/users/1036361/sailorcire"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1527170579, "post_id": 50498265, "comment_id": 88034942, "body": "No, because when I have a program as output, everything works. @DavidC.Rankin cc is soft linked to gcc."}, {"owner": {"reputation": 498, "user_id": 1036361, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1d7a8fb2d53ad21e94bcec10773a80e2?s=128&d=identicon&r=PG", "display_name": "SailorCire", "link": "https://stackoverflow.com/users/1036361/sailorcire"}, "edited": false, "score": 0, "creation_date": 1527171055, "post_id": 50498265, "comment_id": 88035298, "body": "To be specific, when I have a CMakeLists.txt like this <a href=\"https://pastebin.com/PLG0gePL\" rel=\"nofollow noreferrer\">pastebin.com/PLG0gePL</a>, everything works perfectly."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1527179270, "post_id": 50498265, "comment_id": 88040633, "body": "@SailorCire - I&#39;ve reopened the question. From what you describe, you were describing the exact problem already answered in the question I listed, if that isn&#39;t the case, then there is another issue, but you should not be overwriting the <code>CMAKE_C_COMPILER</code> macro, you should be exporting the proper values for <code>CC</code> and <code>CXX</code>."}, {"owner": {"reputation": 498, "user_id": 1036361, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1d7a8fb2d53ad21e94bcec10773a80e2?s=128&d=identicon&r=PG", "display_name": "SailorCire", "link": "https://stackoverflow.com/users/1036361/sailorcire"}, "edited": false, "score": 0, "creation_date": 1527181538, "post_id": 50498265, "comment_id": 88041802, "body": "I think it might be a bug. I messed up on another CMakeLists.txt and got the same error; however, when forced CMAKE_C_COMPILER <i>(yes I know you said not to)</i> then it wound up spitting useful information."}], "owner": {"reputation": 498, "user_id": 1036361, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1d7a8fb2d53ad21e94bcec10773a80e2?s=128&d=identicon&r=PG", "display_name": "SailorCire", "link": "https://stackoverflow.com/users/1036361/sailorcire"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 843, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1527179083, "creation_date": 1527113810, "question_id": 50498265, "link": "https://stackoverflow.com/questions/50498265/cmake-fails-to-detect-c-compiler-on-trival-file", "title": "CMake fails to detect C compiler on trival file", "body": "<p>I have a very large project that I'm trying to migrate from GNU make to cmake. As such, I think having intermediary files containing various variables is a good way to go.</p>\n\n<p>Since I'm just starting out, this is what I have for top_directory/vars/CMakeLists.txt:</p>\n\n<pre><code>cmake_minimum_required(VERSION 2.8)\n\nset(VARIABLE \"value\")\n</code></pre>\n\n<p>This way, in another folder, I can add this line to that CMakeLists.txt:</p>\n\n<pre><code>add_subdirectory(top_directory/vars)\n</code></pre>\n\n<p>However, when trying to run cmake on top_directory/vars/CMakeLists.txt, I receive the following error:</p>\n\n<pre><code>me@host:/tmp&gt;cmake .\n-- The C compiler identification is unknown\n-- The CXX compiler identification is GNU 7.3.1\n-- Check for working C compiler: /usr/bin/g++\n-- Check for working C compiler: /usr/bin/g++ -- broken\nCMake Error at /usr/share/cmake/Modules/CMakeTestCCompiler.cmake:52 (message):\n  The C compiler\n\n    \"/usr/bin/g++\"\n\n  is not able to compile a simple test program.\n\n  It fails with the following output:\n\n    Change Dir: /tmp/CMakeFiles/CMakeTmp\n\n    Run Build Command:\"/usr/bin/gmake\" \"cmTC_607e9/fast\"\n    /usr/bin/gmake -f CMakeFiles/cmTC_607e9.dir/build.make CMakeFiles/cmTC_607e9.dir/build\n    gmake[1]: Entering directory '/tmp/CMakeFiles/CMakeTmp'\n    Building C object CMakeFiles/cmTC_607e9.dir/testCCompiler.c.o\n    /usr/bin/g++    -o CMakeFiles/cmTC_607e9.dir/testCCompiler.c.o   -c /tmp/CMakeFiles/CMakeTmp/testCCompiler.c\n    /tmp/CMakeFiles/CMakeTmp/testCCompiler.c:2:3: error: #error \"The CMAKE_C_COMPILER is set to a C++ compiler\"\n     # error \"The CMAKE_C_COMPILER is set to a C++ compiler\"\n       ^~~~~\n    gmake[1]: *** [CMakeFiles/cmTC_607e9.dir/build.make:66: CMakeFiles/cmTC_607e9.dir/testCCompiler.c.o] Error 1\n    gmake[1]: Leaving directory '/tmp/CMakeFiles/CMakeTmp'\n    gmake: *** [Makefile:126: cmTC_607e9/fast] Error 2\n\n\n\n\n  CMake will not be able to correctly generate this project.\nCall Stack (most recent call first):\n  CMakeLists.txt\n\n\n-- Configuring incomplete, errors occurred!\nSee also \"/tmp/CMakeFiles/CMakeOutput.log\".\nSee also \"/tmp/CMakeFiles/CMakeError.log\".\n</code></pre>\n\n<p>Now I <em>can</em> force it by adding <code>-DCMAKE_C_COMPILER=gcc</code>, but that really defeats the portability aspect. </p>\n\n<p>So my question is: is this the right way to be making \"variable\" CMake files and why does CMake incorrectly detect my C compiler?</p>\n\n<p>Helpful Information:</p>\n\n<pre><code>cmake --version\ncmake version 3.11.1\nCMake suite maintained and supported by Kitware (kitware.com/cmake).\n\ngcc --version\ngcc (SUSE Linux) 7.3.1 20180323 [gcc-7-branch revision 258812]\nCopyright (C) 2017 Free Software Foundation, Inc.\nThis is free software; see the source for copying conditions.  There is NO\nwarranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n</code></pre>\n\n<p>If there is any additional information I can provide, then please let me know.</p>\n"}, {"tags": ["c", "multithreading", "pthreads"], "comments": [{"owner": {"reputation": 9215, "user_id": 5212827, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7e9f9b0d7e2d571c9f8886dd54bd50f9?s=128&d=identicon&r=PG&f=1", "display_name": "DeiDei", "link": "https://stackoverflow.com/users/5212827/deidei"}, "edited": false, "score": 1, "creation_date": 1527110952, "post_id": 50497666, "comment_id": 88008352, "body": "Note: A CS student probably can&#39;t answer this."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 5, "creation_date": 1527110960, "post_id": 50497666, "comment_id": 88008353, "body": "I don&#39;t think one can call it a race condition in the classical meaning. Race conditions have a somewhat stochastic behavior, depending on the scheduler policy and timings. The author is probably talking about <i>bugs</i> that can arise when the same object/resource is accessed from multiple recursive calls. But this behavior is completely deterministic. Signals is a different story as they occur asynchronously and can apparently interrupt some data processing and trigger some other processing on that data."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1527111254, "post_id": 50497666, "comment_id": 88008453, "body": "@EugeneSh. What is missing in your comment, causing you not to consider it an answer? You even correctly contrasted the two very different aspects (correctly as far as I can tell)."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 1, "creation_date": 1527111332, "post_id": 50497666, "comment_id": 88008480, "body": "@Yunnosch A lack of <i>100%</i> confidence :)"}, {"owner": {"reputation": 2176, "user_id": 5402401, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/dPV49.jpg?s=128&g=1", "display_name": "0.sh", "link": "https://stackoverflow.com/users/5402401/0-sh"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1527111391, "post_id": 50497666, "comment_id": 88008506, "body": "@EugeneSh. Your comment should be an answer, it makes sence"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1527111415, "post_id": 50497666, "comment_id": 88008514, "body": "OK, I am covinced. Will convert to an answer."}], "answers": [{"tags": [], "owner": {"reputation": 19267, "user_id": 801894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67f2ccd17aa6fd622152ad88fc2ae784?s=128&d=identicon&r=PG", "display_name": "Solomon Slow", "link": "https://stackoverflow.com/users/801894/solomon-slow"}, "is_accepted": false, "score": 4, "last_activity_date": 1527111262, "creation_date": 1527111262, "answer_id": 50497805, "question_id": 50497666, "link": "https://stackoverflow.com/questions/50497666/race-conditions-can-also-occur-in-traditional-single-threaded-programs-clarit/50497805#50497805", "title": "Race conditions can also occur in traditional, single-threaded programs - Clarity", "body": "<p>A signal handler can be called at any time without warning, and it potentially can access any global state in the program.</p>\n\n<p>So, suppose your program has some global flag, that the signal handler sets in response to,... I don't know,... SIGINT.  And your program checks the flag before each call to f(x).</p>\n\n<pre><code>if (! flag) {\n    f(x);\n}\n</code></pre>\n\n<p>That's a data race. There is no guarantee that f(x) will not be called after the signal happens because the signal could sneak in at any time, including right after the \"main\" program tests the flag.</p>\n"}, {"comments": [{"owner": {"reputation": 19267, "user_id": 801894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67f2ccd17aa6fd622152ad88fc2ae784?s=128&d=identicon&r=PG", "display_name": "Solomon Slow", "link": "https://stackoverflow.com/users/801894/solomon-slow"}, "edited": false, "score": 3, "creation_date": 1527111758, "post_id": 50497843, "comment_id": 88008645, "body": "A <a href=\"https://en.wikipedia.org/wiki/Deadlock\" rel=\"nofollow noreferrer\">deadlock</a> is not a <a href=\"https://en.wikipedia.org/wiki/Race_condition\" rel=\"nofollow noreferrer\">data race</a>."}, {"owner": {"reputation": 2176, "user_id": 5402401, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/dPV49.jpg?s=128&g=1", "display_name": "0.sh", "link": "https://stackoverflow.com/users/5402401/0-sh"}, "edited": false, "score": 1, "creation_date": 1527112002, "post_id": 50497843, "comment_id": 88008752, "body": "the author is talking about race condition which is so different from deadlock situations"}, {"owner": {"reputation": 823, "user_id": 8219383, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-skKjxh6jxds/AAAAAAAAAAI/AAAAAAAAtPU/vVIFbedVzvo/photo.jpg?sz=128", "display_name": "Michael Beer", "link": "https://stackoverflow.com/users/8219383/michael-beer"}, "edited": false, "score": 0, "creation_date": 1527112202, "post_id": 50497843, "comment_id": 88008824, "body": "You are right. However, the basic problem stated in the quotation I guess is more or less the very problem I described. IMHO ;)"}, {"owner": {"reputation": 823, "user_id": 8219383, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-skKjxh6jxds/AAAAAAAAAAI/AAAAAAAAtPU/vVIFbedVzvo/photo.jpg?sz=128", "display_name": "Michael Beer", "link": "https://stackoverflow.com/users/8219383/michael-beer"}, "edited": false, "score": 0, "creation_date": 1527112582, "post_id": 50497843, "comment_id": 88008956, "body": "Thus, hopefully made my point more clear... Thanks for the ciritque!"}], "tags": [], "owner": {"reputation": 823, "user_id": 8219383, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-skKjxh6jxds/AAAAAAAAAAI/AAAAAAAAtPU/vVIFbedVzvo/photo.jpg?sz=128", "display_name": "Michael Beer", "link": "https://stackoverflow.com/users/8219383/michael-beer"}, "is_accepted": false, "score": -2, "last_activity_date": 1527113432, "last_edit_date": 1527113432, "creation_date": 1527111454, "answer_id": 50497843, "question_id": 50497666, "link": "https://stackoverflow.com/questions/50497666/race-conditions-can-also-occur-in-traditional-single-threaded-programs-clarit/50497843#50497843", "title": "Race conditions can also occur in traditional, single-threaded programs - Clarity", "body": "<p>Well, consider the following code:</p>\n\n<pre><code>#include &lt;pthread.h&gt;\n\npthread_mutex_t mutex = PTHREAD_MUTEX_INITIALIZER;\n\nint num = 2;\n\nvoid lock_and_call_again() {\n    pthread_mutex_lock(&amp;mutex);\n    if(num &gt; 0) {\n        --num;\n        lock_and_call_again();\n    }\n}\n\n\nint main(int argc, char** argv) {\n    lock_and_call_again();\n}\n</code></pre>\n\n<p>(Compile with <code>gcc -pthread thread-test.c</code> if you safe the code as <code>thread-test.c</code>)</p>\n\n<p>This is clearly single-threaded, isn't it?\nNever the less, it will enter a dead-lock, because you try to lock an already locked mutex.</p>\n\n<p>That's basically what is meant within the paragraph you cited, IMHO:</p>\n\n<p>It does not matter whether it is done in several threads or one single thread, if you try to lock an already locked mutex, your program will end in an dead-lock.</p>\n\n<p>If a function calls itself, like <code>lock_and_call</code> above, it what is called a <em>recursive call</em> .</p>\n\n<p>Just as james large explains, a signal can occur any time, and if a signal handler is registered with this signal, it will called at unpredictable times, if no measures are taken, even while the same handler is already being executed - yielding some kind of <em>implicit recursive</em> execution of the signal handler.</p>\n\n<p>If this handler aquires some kind of a lock, you end up in a dead-lock, even without a function calling itself explicitly.\nConsider the following function:</p>\n\n<pre><code>pthread_mutex_t mutex;\n\nvoid my_handler(int s) {\n\n    pthread_mutex_lock(&amp;mutex);\n    sleep(10);\n    pthread_mutex_unnlock(&amp;mutex);\n\n}\n</code></pre>\n\n<p>Now if  you register this function for a particular signal, it will be called whenever the signal is caught by your program. If the handler has been called and sleeps, it might get interrupted, the handler called again, and the handler try to lock the <code>mutex</code> that is already locked.</p>\n\n<p>Regarding the wording of the citation:</p>\n\n<p>\"<em>A single-threaded program of this kind may have the same routine in progress in various call frames on its process stack.</em>\"</p>\n\n<p>When a function gets called, some information is stored on the process's stack - e.g. the return address. This information is called a call frame. If you call a function recursively, like in the example above, this information gets stored on the stack several times - several call frames are stored.\nIt's stated a littlebit clumsy, I admit...</p>\n"}, {"comments": [{"owner": {"reputation": 823, "user_id": 8219383, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-skKjxh6jxds/AAAAAAAAAAI/AAAAAAAAtPU/vVIFbedVzvo/photo.jpg?sz=128", "display_name": "Michael Beer", "link": "https://stackoverflow.com/users/8219383/michael-beer"}, "edited": false, "score": 1, "creation_date": 1527112840, "post_id": 50497892, "comment_id": 88009049, "body": "You contradict yourself a bit, don&#39;t you?  - IMHO it is the signals inducing the stochastic behaviour you demand for a race condition to be present - I tried to explain this in my post below."}], "tags": [], "owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "is_accepted": true, "score": 8, "last_activity_date": 1527111708, "creation_date": 1527111708, "answer_id": 50497892, "question_id": 50497666, "link": "https://stackoverflow.com/questions/50497666/race-conditions-can-also-occur-in-traditional-single-threaded-programs-clarit/50497892#50497892", "title": "Race conditions can also occur in traditional, single-threaded programs - Clarity", "body": "<p>I don't think one can call it a race condition in the classical meaning. Race conditions have a somewhat stochastic behavior, depending on the scheduler policy and timings. </p>\n\n<p>The author is probably talking about <em>bugs</em> that can arise when the same object/resource is accessed from multiple recursive calls. But this behavior is completely deterministic and manageable.   </p>\n\n<p>Signals on the other hand  is a different story as they occur asynchronously and can apparently interrupt some data processing in the middle and trigger some other processing on that data, corrupting it when returned to the interrupted task. </p>\n"}, {"comments": [{"owner": {"reputation": 4217, "user_id": 9614249, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eJfci.png?s=128&g=1", "display_name": "Increasingly Idiotic", "link": "https://stackoverflow.com/users/9614249/increasingly-idiotic"}, "edited": false, "score": 1, "creation_date": 1527112695, "post_id": 50497964, "comment_id": 88008995, "body": "&quot;<i>the term is defined with respect to the respective actions of multiple threads</i>&quot;. This is not entirely correct. The most general definition of a race condition is when a program behaves incorrectly due to differences in timing or ordering of execution. This does not <i>necessarily</i> require multiple threads."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 4217, "user_id": 9614249, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eJfci.png?s=128&g=1", "display_name": "Increasingly Idiotic", "link": "https://stackoverflow.com/users/9614249/increasingly-idiotic"}, "edited": false, "score": 0, "creation_date": 1527113256, "post_id": 50497964, "comment_id": 88009185, "body": "Fair enough, @IncreasinglyIdiotic, but the question is tagged [c], and C defines the related term &quot;data race&quot; with respect to actions of multiple threads, as I describe.  Acknowledged that that&#39;s not exactly the same term."}, {"owner": {"reputation": 4217, "user_id": 9614249, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eJfci.png?s=128&g=1", "display_name": "Increasingly Idiotic", "link": "https://stackoverflow.com/users/9614249/increasingly-idiotic"}, "edited": false, "score": 0, "creation_date": 1527113404, "post_id": 50497964, "comment_id": 88009234, "body": "data races are actually a subset of race conditions and are indeed defined with respect to multiple threads. A data race is defined as two threads making an unordered access to the same shared memory where at least one access is a write. You answer reads like you are saying the definition of race condition relies on multiple threads."}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 1, "last_activity_date": 1527112099, "creation_date": 1527112099, "answer_id": 50497964, "question_id": 50497666, "link": "https://stackoverflow.com/questions/50497666/race-conditions-can-also-occur-in-traditional-single-threaded-programs-clarit/50497964#50497964", "title": "Race conditions can also occur in traditional, single-threaded programs - Clarity", "body": "<p>The author of the book in which you found seems to be defining the term \"race condition\" in an unusual manner, or maybe he's just used the wrong term.</p>\n\n<p>By the usual definition, no, recursion does not create race conditions in single-threaded programs because the term is defined with respect to the respective actions of multiple threads of execution.  It is possible, however, for a recursion to produce exposure to <em>non-reentrancy</em> of some of the functions involved.  It's also possible for a single thread to deadlock against itself.  These do not reflect race conditions, but perhaps one or both of them is what the author meant.</p>\n\n<p>Alternatively, maybe what you read is the result of a bad editing job.  The text you quoted groups functions that employ signal handling together with recursive functions, and signal handlers indeed can produce data races, just as a multiple threads can do, because execution of a signal handler has the relevant characteristics of execution of a separate thread.</p>\n"}, {"tags": [], "owner": {"reputation": 4217, "user_id": 9614249, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eJfci.png?s=128&g=1", "display_name": "Increasingly Idiotic", "link": "https://stackoverflow.com/users/9614249/increasingly-idiotic"}, "is_accepted": false, "score": 3, "last_activity_date": 1527114232, "creation_date": 1527114232, "answer_id": 50498325, "question_id": 50497666, "link": "https://stackoverflow.com/questions/50497666/race-conditions-can-also-occur-in-traditional-single-threaded-programs-clarit/50498325#50498325", "title": "Race conditions can also occur in traditional, single-threaded programs - Clarity", "body": "<p>First it is important to understand what a race condition is. The definition given by <a href=\"https://en.wikipedia.org/wiki/Race_condition\" rel=\"nofollow noreferrer\">Wikipedia</a> is:</p>\n\n<blockquote>\n  <p>Race conditions arise in software when an application depends on the sequence or timing of processes or threads for it to operate properly.</p>\n</blockquote>\n\n<p>The important thing to note is that a program can behave both properly and improperly based on timing or ordering of execution.</p>\n\n<hr>\n\n<p>We can fairly easily create \"dummy\" race conditions in single threaded programs under this definition.</p>\n\n<pre><code>bool isnow(time_t then) {\n    time_t now = time(0);\n    return now == then;\n}\n</code></pre>\n\n<p>The above function is a very dumb example and while mostly it will not work, <em>sometimes it will give the correct answer</em>. The correct vs. incorrect behavior depends entirely on timing and so represents a race condition on a single thread.</p>\n\n<hr>\n\n<p>Taking it a step further we can write another dummy program.</p>\n\n<pre><code>bool printHello() {\n    sleep(10);\n    printf(\"Hello\\n\");\n}\n</code></pre>\n\n<p>The expected behavior of the above program is to print <code>\"Hello\"</code> after waiting 10 seconds. </p>\n\n<p>If we send a <code>SIGINT</code> signal 11 seconds after calling our function, everything behaves as expected. If we send a <code>SIGINT</code> signal 3 seconds after calling our function, the program behaves improperly and does not print <code>\"Hello\"</code>.</p>\n\n<p>The only difference between the correct and incorrect behavior was the timing of the <code>SIGINT</code> signal. Thus, a race condition was introduced by signal handling.</p>\n"}, {"comments": [{"owner": {"reputation": 2176, "user_id": 5402401, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/dPV49.jpg?s=128&g=1", "display_name": "0.sh", "link": "https://stackoverflow.com/users/5402401/0-sh"}, "edited": false, "score": 0, "creation_date": 1527116361, "post_id": 50498544, "comment_id": 88010019, "body": "all three explanations are nice and simple. Thanks."}], "tags": [], "owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "is_accepted": false, "score": 2, "last_activity_date": 1527115701, "creation_date": 1527115701, "answer_id": 50498544, "question_id": 50497666, "link": "https://stackoverflow.com/questions/50497666/race-conditions-can-also-occur-in-traditional-single-threaded-programs-clarit/50498544#50498544", "title": "Race conditions can also occur in traditional, single-threaded programs - Clarity", "body": "<p>I'm going to give a more general answer than you asked for.  And this is my own, personal, pragmatic answer, not necessarily one that hews to any official, formal definition of the term \"race condition\".</p>\n\n<p>Me, I hate race conditions.  They lead to huge classes of nasty bugs that are hard to think about, hard to find, and sometimes hard to fix.  So I don't like doing programming that's susceptible to race conditions.  So I don't do much classically multithreaded programming.</p>\n\n<p>But even though I don't do much multithreaded programming, I'm still confronted by certain classes of what feel to me like race conditions from time to time.  Here are the three I try to keep in mind:</p>\n\n<ol>\n<li><p>The one you mentioned: signal handlers.  Receipt of a signal, and calling of a signal handler, is a truly asynchronous event.  If you have a data structure of some kind, and you're in the middle of modifying it when a signal occurs, and if your signal handler also tries to modify that same data structure, you've got a race condition.  If the code that was interrupted was in the middle of doing something that left the data structure in an inconsistent state, the code in the signal handler might be confused.  Note, too, that it's not necessarily code right in the signal handler, but any function called by the signal handler, or called by a function that's called by the signal handler, etc.</p></li>\n<li><p>Shared OS resources, typically in the filesystem: If your program accesses (or modifies) a file or directory in the filesystem that's also being accessed or modified by another process, you've got a big potential for race conditions.  (This is not surprising, because in a computer science sense, multiple processes <em>are</em> multiple threads.  They may have separate address spaces meaning they can't interfere with each other that way, but obviously the filesystem is a shared resource where they still can interfere with each other.)</p></li>\n<li><p>Non-reentrant functions like <code>strtok</code>.  If a function maintains internal, static state, you can't have a second call to that function if another instance is active.  This is not a \"race condition\" in the formal sense at all, but it has many of the same symptoms, and also some of the same fixes: don't use static data; do try to write your functions so that they're reentrant.</p></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 13385861, "user_type": "registered", "profile_image": "https://graph.facebook.com/2816894151757817/picture?type=large", "display_name": "Steven Eker", "link": "https://stackoverflow.com/users/13385861/steven-eker"}, "is_accepted": false, "score": 0, "last_activity_date": 1587596139, "creation_date": 1587596139, "answer_id": 61376459, "question_id": 50497666, "link": "https://stackoverflow.com/questions/50497666/race-conditions-can-also-occur-in-traditional-single-threaded-programs-clarit/61376459#61376459", "title": "Race conditions can also occur in traditional, single-threaded programs - Clarity", "body": "<p>Race conditions absolutely happen in single-threaded programs once you have signal handlers. Look at the Unix manual page for pselect().</p>\n\n<p>One way it happens is like this: You have a signal handler that sets some global flag. You check your global flag and because it is clear you make a system call that suspends, confident that when the signal arrives the system call will exit early. But the signal arrives just after you check the global flag and just before the system call takes place. So now you're hung in a system call waiting for a signal that has already arrived. In this case, the race is between your single-threaded code and an external signal.</p>\n"}], "owner": {"reputation": 2176, "user_id": 5402401, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/dPV49.jpg?s=128&g=1", "display_name": "0.sh", "link": "https://stackoverflow.com/users/5402401/0-sh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1115, "favorite_count": 2, "accepted_answer_id": 50497892, "answer_count": 7, "score": 7, "last_activity_date": 1587596139, "creation_date": 1527110557, "last_edit_date": 1527112270, "question_id": 50497666, "link": "https://stackoverflow.com/questions/50497666/race-conditions-can-also-occur-in-traditional-single-threaded-programs-clarit", "title": "Race conditions can also occur in traditional, single-threaded programs - Clarity", "body": "<p>I have read few books on parallel programming over the past few months and I decided to close it off with learning about the posix thread. </p>\n\n<p>I am reading \"<em>PThreads programming - A Posix standard for better multiprocessing nutshell-handbook</em>\". In chapter 5 ( Pthreads and Unix ) the author talks about handling signals in multi-threaded programs. In the \"<em>Threadsafe Library Functions and System Calls</em>\" section, the author made a statement that I have not seen in most books that I have read on parallel programming. The statement was:</p>\n\n<blockquote>\n  <p>Race conditions can also occur in traditional, single-threaded programs  that use signal handlers or that call routines recursively. A single-threaded program of this kind may have the same routine in progress in various call frames on its process stack.</p>\n</blockquote>\n\n<p>I find it a little bit tedious to decipher this statement. Does the race condition in the recursive function occur when the recursive function keeps an internal structure by using the static storage type? </p>\n\n<p>I would also love to know how signal handlers can cause <strong>RACE CONDITION IN SINGLE THREADED PROGRAMS</strong></p>\n\n<p><strong>Note:</strong> Am not a computer science student , i would really appreciate simplified terms</p>\n"}, {"tags": ["c", "string", "function"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1527110456, "post_id": 50497594, "comment_id": 88008167, "body": "What&#39;s your input?"}, {"owner": {"reputation": 421, "user_id": 1924261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66c2f856227c3dc145ddc85f5edbab56?s=128&d=identicon&r=PG", "display_name": "kingW3", "link": "https://stackoverflow.com/users/1924261/kingw3"}, "edited": false, "score": 1, "creation_date": 1527110755, "post_id": 50497594, "comment_id": 88008279, "body": "Maybe your s[index++] = s[i], overwrites the terminating zero hence the loop never reaches the end though i may br mistaking."}, {"owner": {"reputation": 128, "user_id": 9806533, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j7zEj.jpg?s=128&g=1", "display_name": "raijin", "link": "https://stackoverflow.com/users/9806533/raijin"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1527110850, "post_id": 50497594, "comment_id": 88008308, "body": "@EugeneSh. cheese, but any input gives a unexpected output"}, {"owner": {"reputation": 128, "user_id": 9806533, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j7zEj.jpg?s=128&g=1", "display_name": "raijin", "link": "https://stackoverflow.com/users/9806533/raijin"}, "reply_to_user": {"reputation": 421, "user_id": 1924261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66c2f856227c3dc145ddc85f5edbab56?s=128&d=identicon&r=PG", "display_name": "kingW3", "link": "https://stackoverflow.com/users/1924261/kingw3"}, "edited": false, "score": 0, "creation_date": 1527110932, "post_id": 50497594, "comment_id": 88008340, "body": "@kingW3 cant see why but what should i change?"}, {"owner": {"reputation": 1639, "user_id": 2073349, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0266d3aafa1813f794a5b71058d5cd27?s=128&d=identicon&r=PG", "display_name": "Ritesh", "link": "https://stackoverflow.com/users/2073349/ritesh"}, "edited": false, "score": 0, "creation_date": 1527111074, "post_id": 50497594, "comment_id": 88008395, "body": "s[index++] = s[i]; is wrong. You are modifying the input string. And this can cause  overwriting 0 at the end of string, and get into buffer overflow. Instead use some other buffer to copy characters."}, {"owner": {"reputation": 128, "user_id": 9806533, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j7zEj.jpg?s=128&g=1", "display_name": "raijin", "link": "https://stackoverflow.com/users/9806533/raijin"}, "reply_to_user": {"reputation": 1639, "user_id": 2073349, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0266d3aafa1813f794a5b71058d5cd27?s=128&d=identicon&r=PG", "display_name": "Ritesh", "link": "https://stackoverflow.com/users/2073349/ritesh"}, "edited": false, "score": 0, "creation_date": 1527111223, "post_id": 50497594, "comment_id": 88008441, "body": "@Ritesh s[index] = s[i];index++; like that? because that dont work too"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1527111777, "post_id": 50497594, "comment_id": 88008654, "body": "The <code>j</code> loop should start at <code>j = i+1</code>. Otherwise you&#39;ll treat it as a repetition when <code>i == j</code>."}, {"owner": {"reputation": 1639, "user_id": 2073349, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0266d3aafa1813f794a5b71058d5cd27?s=128&d=identicon&r=PG", "display_name": "Ritesh", "link": "https://stackoverflow.com/users/2073349/ritesh"}, "edited": false, "score": 0, "creation_date": 1527111974, "post_id": 50497594, "comment_id": 88008737, "body": "I am saying that you can not do this at all. You are modifying the input string. You need to use some other array(dynamic) and copy the characters in that other. S[index]=s[i] is modifying the input, and that is causing buffer overflow. First time you find &#39;e&#39;, you wrote eee, then second time &#39;e&#39;, you wrote eee, then another eee , and you get into sort of infinite loop. Also j should be started from i+1, and not 0."}, {"owner": {"reputation": 1639, "user_id": 2073349, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0266d3aafa1813f794a5b71058d5cd27?s=128&d=identicon&r=PG", "display_name": "Ritesh", "link": "https://stackoverflow.com/users/2073349/ritesh"}, "edited": false, "score": 0, "creation_date": 1527112202, "post_id": 50497594, "comment_id": 88008823, "body": "Just another solution is use std::set&lt;char&gt;. Start inserting chars, and when set insertion fails, increase the count."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 1639, "user_id": 2073349, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0266d3aafa1813f794a5b71058d5cd27?s=128&d=identicon&r=PG", "display_name": "Ritesh", "link": "https://stackoverflow.com/users/2073349/ritesh"}, "edited": false, "score": 0, "creation_date": 1527112243, "post_id": 50497594, "comment_id": 88008834, "body": "@Ritesh Why would it cause buffer overflow? There can&#39;t be more repeated characters than input characters."}], "answers": [{"comments": [{"owner": {"reputation": 128, "user_id": 9806533, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j7zEj.jpg?s=128&g=1", "display_name": "raijin", "link": "https://stackoverflow.com/users/9806533/raijin"}, "edited": false, "score": 0, "creation_date": 1527114003, "post_id": 50498019, "comment_id": 88009405, "body": "some progress has been made, but it didnt fully work, when i write &quot;popcorn&quot; it returns &quot;pop&quot; but should be &quot;popo&quot; or if i input &quot;invisibility&quot; it returns &quot;iiiis&quot; when should be &quot;iiiii&quot;"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 128, "user_id": 9806533, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j7zEj.jpg?s=128&g=1", "display_name": "raijin", "link": "https://stackoverflow.com/users/9806533/raijin"}, "edited": false, "score": 0, "creation_date": 1527114124, "post_id": 50498019, "comment_id": 88009450, "body": "That makes it much more complicated, because you need some way to prevent it from reporting the same letters twice."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 128, "user_id": 9806533, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j7zEj.jpg?s=128&g=1", "display_name": "raijin", "link": "https://stackoverflow.com/users/9806533/raijin"}, "edited": false, "score": 0, "creation_date": 1527114187, "post_id": 50498019, "comment_id": 88009469, "body": "In <code>invisibility</code>, the third i matches the first i and the second i. The 4th i matches the 1st, 2nd, and 3rd i."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 128, "user_id": 9806533, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j7zEj.jpg?s=128&g=1", "display_name": "raijin", "link": "https://stackoverflow.com/users/9806533/raijin"}, "edited": false, "score": 0, "creation_date": 1527114439, "post_id": 50498019, "comment_id": 88009536, "body": "After fixing <code>s[++index] = &#39;\\0&#39;;</code> the output is <code>po</code>. It only returns the repetitions of the characters, not their original occurrence."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 128, "user_id": 9806533, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j7zEj.jpg?s=128&g=1", "display_name": "raijin", "link": "https://stackoverflow.com/users/9806533/raijin"}, "edited": false, "score": 0, "creation_date": 1527114518, "post_id": 50498019, "comment_id": 88009551, "body": "A better way to do this is to make a table that contains the count of repetition of each character. Then return a string containing all the characters whose count is &gt; 1, repeated that many characters."}, {"owner": {"reputation": 128, "user_id": 9806533, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j7zEj.jpg?s=128&g=1", "display_name": "raijin", "link": "https://stackoverflow.com/users/9806533/raijin"}, "edited": false, "score": 0, "creation_date": 1527115202, "post_id": 50498019, "comment_id": 88009749, "body": "but how it will remember the string order?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 128, "user_id": 9806533, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j7zEj.jpg?s=128&g=1", "display_name": "raijin", "link": "https://stackoverflow.com/users/9806533/raijin"}, "edited": false, "score": 0, "creation_date": 1527115269, "post_id": 50498019, "comment_id": 88009771, "body": "I didn&#39;t know that was required. You&#39;re making this very hard."}], "tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": false, "score": 1, "last_activity_date": 1527114375, "last_edit_date": 1527114375, "creation_date": 1527112429, "answer_id": 50498019, "question_id": 50497594, "link": "https://stackoverflow.com/questions/50497594/string-manipulation-variable-output-with-the-same-input/50498019#50498019", "title": "String manipulation (variable output with the same input)", "body": "<p>You need to start the inner loop at the next character after the one being processed in the outer loop, otherwise you'll process the same pair of characters twice, as well as testing a character against itself when <code>i == j</code>.</p>\n\n<p>You should also break out of the inner loop as soon as you find a match. You'll find later matches in a future iteration of the outer loop. Otherwise you'll process the same pair twice again.</p>\n\n<p>And you shouldn't increment <code>index</code> before assigning the null character after the loop. It was already incremented when adding the repetition.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nchar * repeticoes(char *s) {\n    int index = 0;\n\n    for (int i = 0;( s[i] != '\\0'); i++) //problem starts when i is &gt; 0\n    {\n        for (int j = i+1; ( s[j] != '\\0'); j++)\n        {\n            if (s[i] == s[j])\n            {\n                printf(\"%c == %c\\ni %d  j %d\\n\", s[i], s[j],i,j);\n                s[index++] = s[i];\n                break;\n            }\n            else\n            {\n                printf(\"not happening %c != %c\\ni %d  j %d\\n\", s[i],s[j],i,j);\n            }\n        }\n\n    }\n\n    s[index] = '\\0';\n    return s;\n}\n\nint main() {\n    char input[21];\n\n    printf(\"str 1\\n\");\n    fgets(input, 20, stdin);\n    repeticoes(input);\n    printf(\"duplicated letters %s\\n\", input);\n\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6975, "user_id": 3121023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f52448806175b9aa66c86d40cf0829f1?s=128&d=identicon&r=PG&f=1", "display_name": "user3121023", "link": "https://stackoverflow.com/users/3121023/user3121023"}, "is_accepted": true, "score": 0, "last_activity_date": 1527115578, "creation_date": 1527115578, "answer_id": 50498522, "question_id": 50497594, "link": "https://stackoverflow.com/questions/50497594/string-manipulation-variable-output-with-the-same-input/50498522#50498522", "title": "String manipulation (variable output with the same input)", "body": "<p>With an array of letters to count and an array of counts. Once the letters have been counted, loop through the input again and set the letters that have a count greater than one.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid repeticoes ( char *s) {\n    char tocount[] = \"abcdefghijklmnopqrstuvwxyz\";\n    size_t len = sizeof tocount;\n    size_t index = 0;\n    int count[len];\n\n    for (int j = 0; j &lt; len; j++) {\n        count[j] = 0;\n    }\n\n    for (int i = 0;( s[i] != '\\0'); i++) {\n        for (int j = 0; j &lt; len; j++) {\n            if ( s[i] == tocount[j]) {\n                count[j]++;\n            }\n        }\n    }\n    for (int i = 0;( s[i] != '\\0'); i++) {\n        for (int j = 0; j &lt; len; j++) {\n            if ( s[i] == tocount[j] &amp;&amp; 1 &lt; count[j]) {\n                s[index] = s[i];\n                index++;\n            }\n        }\n    }\n    s[index] = '\\0';\n}\n\nint main ( void) {\n    char input[21];\n\n    printf(\"str 1\\n\");\n    fgets(input, 20, stdin);\n    repeticoes(input);\n    printf(\"duplicated letters %s\\n\", input);\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 128, "user_id": 9806533, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j7zEj.jpg?s=128&g=1", "display_name": "raijin", "link": "https://stackoverflow.com/users/9806533/raijin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 50498522, "answer_count": 2, "score": 0, "last_activity_date": 1527115578, "creation_date": 1527110175, "question_id": 50497594, "link": "https://stackoverflow.com/questions/50497594/string-manipulation-variable-output-with-the-same-input", "title": "String manipulation (variable output with the same input)", "body": "<p>Maybe some property is passing unnoticed to me, but when 'i' is 1 it just freeze. When i input whatever string, 'j' variable goes to 700 or 2000 in different executions. The code goal is to output repetitive letters if you input \"cheese\" the output should be \"eee\". What am i doing wrong?</p>\n\n<pre><code>    #include &lt;stdio.h&gt;\n    char * repeticoes(char *s) {\n        int index = 0;\n\n        for (int i = 0;( s[i] != '\\0'); i++) //problem starts when i is &gt; 0\n        {\n            for (int j = 0; ( s[j] != '\\0'); j++)\n            {\n                if (s[i] == s[j])\n                {\n                    printf(\"%c == %c\\ni %d  j %d\\n\", s[i], s[j],i,j);\n                    s[index++] = s[i];\n\n                }\n                else\n                {\n                    printf(\"not happening %c != %c\\ni %d  j %d\\n\", s[i],s[j],i,j);\n                }\n            }\n\n        }\n\n        s[++index] = '\\0';\n        return s;\n    }\n\n    main() {\n        char input[21];\n\n        printf(\"str 1\\n\");\n        fgets(input, 20, stdin);\n        repeticoes(input);\n        printf(\"duplicated letters %s\\n\", input);\n\n    }\n</code></pre>\n"}, {"tags": ["c", "parallel-processing", "mpi"], "comments": [{"owner": {"reputation": 1996, "user_id": 3357105, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c368973a174d114614a9debc188dad1?s=128&d=identicon&r=PG&f=1", "display_name": "ptb", "link": "https://stackoverflow.com/users/3357105/ptb"}, "edited": false, "score": 0, "creation_date": 1527111318, "post_id": 50497163, "comment_id": 88008476, "body": "Is it the same garbage that is in <code>parcial</code> on the root process?"}], "answers": [{"comments": [{"owner": {"reputation": 7287, "user_id": 8062491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rd6rD.png?s=128&g=1", "display_name": "Gilles Gouaillardet", "link": "https://stackoverflow.com/users/8062491/gilles-gouaillardet"}, "edited": false, "score": 0, "creation_date": 1527114389, "post_id": 50497879, "comment_id": 88009522, "body": "If you do not want to initialize <code>parcial</code> on rank 0, you might want to use <code>MPI_IN_PLACE</code>"}, {"owner": {"reputation": 1996, "user_id": 3357105, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c368973a174d114614a9debc188dad1?s=128&d=identicon&r=PG&f=1", "display_name": "ptb", "link": "https://stackoverflow.com/users/3357105/ptb"}, "reply_to_user": {"reputation": 7287, "user_id": 8062491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rd6rD.png?s=128&g=1", "display_name": "Gilles Gouaillardet", "link": "https://stackoverflow.com/users/8062491/gilles-gouaillardet"}, "edited": false, "score": 0, "creation_date": 1527115997, "post_id": 50497879, "comment_id": 88009933, "body": "Excellent point @GillesGouaillardet!  I&#39;ve added an example to my answer"}], "tags": [], "owner": {"reputation": 1996, "user_id": 3357105, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c368973a174d114614a9debc188dad1?s=128&d=identicon&r=PG&f=1", "display_name": "ptb", "link": "https://stackoverflow.com/users/3357105/ptb"}, "is_accepted": true, "score": 3, "last_activity_date": 1527115813, "last_edit_date": 1527115813, "creation_date": 1527111648, "answer_id": 50497879, "question_id": 50497163, "link": "https://stackoverflow.com/questions/50497163/mpi-gather-junk-in-receiving-buffer-mpic/50497879#50497879", "title": "MPI_Gather junk in receiving buffer (MPI+C)", "body": "<p>Excerpt from the MPI man page for MPI_Gather:</p>\n\n<blockquote>\n  <p>Each  process  (root  process  included) sends the contents of its\n  send buffer to the root process.</p>\n</blockquote>\n\n<p>Thus, the first 15000 elements of the recv buffer <code>total</code> will contain the elements of <code>parcial</code> on the root process. This was left unitialized in your code.</p>\n\n<p>Edit: @Gilles commented that <code>MPI_IN_PLACE</code> could be used to avoid initialization on the root process.  Here's an example showing its effect:</p>\n\n<pre><code>#include &lt;assert.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;mpi.h&gt;\n\n\nint main(int argc, char *argv[])\n{\n    int rank, size;\n\n    MPI_Init(&amp;argc, &amp;argv);\n    MPI_Comm_rank(MPI_COMM_WORLD, &amp;rank);\n    MPI_Comm_size(MPI_COMM_WORLD, &amp;size);\n\n    int *in_place_total = calloc(sizeof(int), size);\n    int *total = calloc(sizeof(int), size);\n\n    int sendval = rank-5000;\n\n    MPI_Gather(&amp;sendval, 1, MPI_INT,\n           total, 1, MPI_INT, 0, MPI_COMM_WORLD);\n\n    if (rank == 0)\n        assert(total[0] == -5000);\n\n    if (rank)\n        MPI_Gather(&amp;sendval, 1, MPI_INT,\n           in_place_total, 1, MPI_INT, 0, MPI_COMM_WORLD);\n    else\n        MPI_Gather(MPI_IN_PLACE, 1, MPI_INT,\n           in_place_total, 1, MPI_INT, 0, MPI_COMM_WORLD);\n\n    if (rank == 0)\n        assert(in_place_total[0] == 0);\n\n    free(total);\n    free(in_place_total);\n\n    MPI_Finalize();\n\n}\n</code></pre>\n"}], "owner": {"reputation": 170, "user_id": 3024178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4d12980468135f1fd58982d326bdb2f?s=128&d=identicon&r=PG&f=1", "display_name": "MsTais", "link": "https://stackoverflow.com/users/3024178/mstais"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 1, "accepted_answer_id": 50497879, "answer_count": 1, "score": 2, "last_activity_date": 1533111335, "creation_date": 1527108155, "last_edit_date": 1533111335, "question_id": 50497163, "link": "https://stackoverflow.com/questions/50497163/mpi-gather-junk-in-receiving-buffer-mpic", "title": "MPI_Gather junk in receiving buffer (MPI+C)", "body": "<p>I am new to MPI and trying to parallelize the code on multiple threads. I need to communicate a big chunk of data back to the master thread, and can't clean up the memory garbage I get after MPI_Gather. Here is the sample code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;mpi.h&gt;\n\nint main (int argc, char *argv[]) {\n\nMPI_Init(&amp;argc, &amp;argv);\nint rank, world_size;\nMPI_Comm_rank(MPI_COMM_WORLD, &amp;rank);\nMPI_Comm_size(MPI_COMM_WORLD, &amp;world_size);\n\ndouble *total=NULL;\ndouble parcial[15000];\nint W=world_size*15000;\n\nif (rank == 0) {\n    total=malloc(sizeof(double) * world_size*15000);\n}\nelse if (rank != 0) {\n    for(int i=0; i&lt;15000; i++)parcial[i] = rank*i*0.1;\n}\nMPI_Barrier(MPI_COMM_WORLD);\n\nif(rank==0) for(int ii=0; ii&lt;W; ii++)total[ii]=0.;\n\nMPI_Gather(parcial,15000,MPI_DOUBLE,total,15000,MPI_DOUBLE,0,MPI_COMM_WORLD);\n\nif (rank == 0) {\n    int N=world_size*15000;\n    for(int i=0; i&lt;N; i++) printf(\"%f \", total[i]);\n}\n\nfree(total);\nMPI_Finalize();\n\n}\n</code></pre>\n\n<p>If you run the code with multiple threads (I have tried 3,4,5...), it always has junk in the beginning of the receiving buffer even though I explicitly put total[ii] to zero before calling MPI_Gather and set a barrier. Is it because I physically have only two kernels? But I have read that MPI creates a virtual machine anyways. Is there a way to clean it and get a reliable gather?</p>\n\n<p><strong>Addition:</strong></p>\n\n<p>I figured, this junk is probably coming form zero-th thread. Why doesn't it go to zero after line 25?</p>\n"}, {"tags": ["c", "get", "console", "character", "mouseover"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1527108258, "post_id": 50497145, "comment_id": 88007153, "body": "I suggest you explore the <a href=\"https://docs.microsoft.com/en-us/windows/console/console-functions\" rel=\"nofollow noreferrer\">Windows console API functions</a>"}], "answers": [{"tags": [], "owner": {"reputation": 589, "user_id": 7623655, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d0c35cea1baf410727643201e2bf0c9?s=128&d=identicon&r=PG&f=1", "display_name": "Olivier Samson", "link": "https://stackoverflow.com/users/7623655/olivier-samson"}, "is_accepted": false, "score": 0, "last_activity_date": 1527109391, "creation_date": 1527109391, "answer_id": 50497420, "question_id": 50497145, "link": "https://stackoverflow.com/questions/50497145/can-a-c-program-get-the-character-mouse-is-hovering-over-in-windows-console/50497420#50497420", "title": "Can a C program get the character mouse is hovering over in Windows Console?", "body": "<p>The <code>GetConsoleScreenBufferInfo</code> function of the console API will get you as close as you can get to what you want (I think) but with extra steps : <a href=\"https://docs.microsoft.com/en-us/windows/console/getconsolescreenbufferinfo\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/windows/console/getconsolescreenbufferinfo</a></p>\n\n<p>As you can see, it returns a <code>CONSOLE_SCREEN_BUFFER_INFO</code> structure which not only contains the position of the cursor (<code>dwCursorPosition</code>), but also character positions (<code>wAttributes</code>).</p>\n\n<p>The downside is this can only be done in a screen buffer, where the user can move the cursor the same way he would interact with the cmd on writing a command (with left-right arrows, on click, etc...).</p>\n\n<p>So yeah, I don't think you could detect a mouse over but with a screen buffer you can have the user click on the characters or navigate through them and be aware of this position.</p>\n"}, {"tags": [], "owner": {"reputation": 9367, "user_id": 4454124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c094d8979fb41b789a7c7f21d9329359?s=128&d=identicon&r=PG&f=1", "display_name": "mnistic", "link": "https://stackoverflow.com/users/4454124/mnistic"}, "is_accepted": false, "score": 0, "last_activity_date": 1527130174, "creation_date": 1527130174, "answer_id": 50500202, "question_id": 50497145, "link": "https://stackoverflow.com/questions/50497145/can-a-c-program-get-the-character-mouse-is-hovering-over-in-windows-console/50500202#50500202", "title": "Can a C program get the character mouse is hovering over in Windows Console?", "body": "<p>Probably the easiest thing to do is to <a href=\"https://docs.microsoft.com/en-us/windows/console/reading-input-buffer-events\" rel=\"nofollow noreferrer\">track mouse movement with <code>ReadConsoleInput</code></a> which will give you console screen buffer coordinates of the mouse pointer and then get the character with <code>ReadConsoleOutputCharacter</code>, something like:</p>\n\n<pre><code>INPUT_RECORD irInBuf[128];\nDWORD cNumRead;\nint i;\nCOORD coord;\n\nwhile (1)\n{\n    ReadConsoleInput(\n        GetStdHandle(STD_INPUT_HANDLE),      // input buffer handle \n        irInBuf,     // buffer to read into \n        128,         // size of read buffer \n        &amp;cNumRead);\n    for (i = 0; i &lt; cNumRead; i++)\n    {\n        if (irInBuf[i].EventType == MOUSE_EVENT)\n        {\n            MOUSE_EVENT_RECORD mer = irInBuf[i].Event.MouseEvent;\n            switch (mer.dwEventFlags)\n            {\n            case 0:\n\n                if (mer.dwButtonState == FROM_LEFT_1ST_BUTTON_PRESSED)\n                {\n                    TCHAR c[2] = { '\\0' };\n                    DWORD cnum;\n                    ReadConsoleOutputCharacter(\n                        GetStdHandle(STD_OUTPUT_HANDLE),\n                        c,\n                        1,\n                        coord,\n                        &amp;cnum\n                        );\n                    if (cnum == 1) MessageBox(NULL, c, NULL, 0);\n                }\n                break;\n            case MOUSE_MOVED:\n                //printf(\"mouse moved\\n\");\n                coord.X = mer.dwMousePosition.X;\n                coord.Y = mer.dwMousePosition.Y;\n                break;\n            default:\n                break;\n            }\n        }\n        else if (irInBuf[i].EventType == KEY_EVENT)\n        {\n            KEY_EVENT_RECORD ker = irInBuf[i].Event.KeyEvent;\n            if (ker.bKeyDown)\n            {\n                DWORD written;\n                WriteConsole(\n                    GetStdHandle(STD_OUTPUT_HANDLE),\n                    &amp;ker.uChar,\n                    1,\n                    &amp;written,\n                    NULL\n                    );\n            }\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8830328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfbf429bc7e543df4d2ea6c61dc338d9?s=128&d=identicon&r=PG&f=1", "display_name": "C. Hakan", "link": "https://stackoverflow.com/users/8830328/c-hakan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 214, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1527130174, "creation_date": 1527108055, "question_id": 50497145, "link": "https://stackoverflow.com/questions/50497145/can-a-c-program-get-the-character-mouse-is-hovering-over-in-windows-console", "title": "Can a C program get the character mouse is hovering over in Windows Console?", "body": "<p>There have been questions and answers regarding to Mouse Input but Mouse Input doesn't seem to be solving this problem.</p>\n\n<p>Lets say the word \"chair\" is printed on the Console. Is there a way to get which character ('c','h','a','i','r' or none) mouse hovers over?</p>\n\n<p>I don't really need the function to continuously update itself, I need to learn the character only once (like when the user presses a button).</p>\n"}, {"tags": ["c", "pipe", "fork"], "comments": [{"owner": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "edited": false, "score": 2, "creation_date": 1527108671, "post_id": 50497066, "comment_id": 88007356, "body": "Why are you writing over a million bytes starting from an address that only guarantees the content of the first six bytes?"}, {"owner": {"reputation": 69, "user_id": 3006119, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/100001180116334/picture?type=large", "display_name": "user3006119", "link": "https://stackoverflow.com/users/3006119/user3006119"}, "reply_to_user": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "edited": false, "score": 0, "creation_date": 1527109558, "post_id": 50497066, "comment_id": 88007814, "body": "@aschepler That&#39;s a good question to ask. I changed that number to a reasonable value and it worked. Silly me."}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "reply_to_user": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "edited": false, "score": 0, "creation_date": 1527109780, "post_id": 50497066, "comment_id": 88007914, "body": "@aschepler The bytes are allocated on the stack too. Ostensibly, the OP was trying to get his code to &quot;Stack-Overflow\u2122&quot;."}], "answers": [{"tags": [], "owner": {"reputation": 69, "user_id": 3006119, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/100001180116334/picture?type=large", "display_name": "user3006119", "link": "https://stackoverflow.com/users/3006119/user3006119"}, "is_accepted": false, "score": 0, "last_activity_date": 1527109804, "creation_date": 1527109804, "answer_id": 50497503, "question_id": 50497066, "link": "https://stackoverflow.com/questions/50497066/pipes-between-uncle-and-nephwew/50497503#50497503", "title": "Pipes between uncle and nephwew", "body": "<p>As <a href=\"https://stackoverflow.com/users/459640/aschepler\">aschepler</a> noted, I wrote way too many bytes to my buffer. So the correct version would be <code>write(fd[1], \"hello\", 6);</code> (or any reasonable value).</p>\n"}, {"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 0, "last_activity_date": 1527109984, "creation_date": 1527109984, "answer_id": 50497544, "question_id": 50497066, "link": "https://stackoverflow.com/questions/50497066/pipes-between-uncle-and-nephwew/50497544#50497544", "title": "Pipes between uncle and nephwew", "body": "<blockquote>\n  <p>I want to send a message (or any sort of data) from the v1 process to\n  the a process. I suppose I have to close pipes in other processes but\n  not sure how.</p>\n</blockquote>\n\n<p>You <em>should</em> close the pipe ends that go unused in your various processes, especially the write ends of the pipe, but failing to do so does not prevent communication via the pipe between other processes.  Instead, there are risks of deadlocking and / or failing to terminate, but your particular code as it now stands would not be affected.</p>\n\n<p>I'm not sure what you mean by \"not sure how\", however.  Your code demonstrates that you know how to use <code>close()</code> and that you know how to use the return value of <code>fork()</code> to discriminate between the parent and child processes.  The only other thing is timing: make sure each process closes any file descriptors it's going to close only after forking all the children that need to get their own open copies.</p>\n\n<blockquote>\n  <p>I tried closing them in every process but didn't succeed\n  (maybe I closed them wrong).</p>\n</blockquote>\n\n<p>You seem to have some misconceptions about <code>read()</code> and <code>write()</code>.  In particular,</p>\n\n<ul>\n<li><p>these are low-level functions, and they know nothing about strings.  When you <code>write()</code>, then, you must specify exactly the number of bytes you want to write.  You cannot expect writing to stop at a string terminator.  Similarly, when you <code>read()</code>, you must specify the maximum number of bytes you are interested in receiving, and although you can transmit a string terminator over the channel, <code>read()</code> won't automatically supply one in the event that you don't.</p></li>\n<li><p>nevertheless, the byte counts you pass are <em>maximums</em>.  Fewer bytes than that may actually be transferred.  Additionally, read and write sizes do not necessarily correlate.  That is, there are no message boundaries unless you build them into the data you transfer yourself.</p></li>\n</ul>\n\n<p>With those things in mind, if I correct your program to write and read exactly 6 bytes, then that is enough for it to produce the expected output for me.  That does still leave some potential issues around transfer sizes, however (short writes and short reads are not protected against).</p>\n"}], "owner": {"reputation": 69, "user_id": 3006119, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/100001180116334/picture?type=large", "display_name": "user3006119", "link": "https://stackoverflow.com/users/3006119/user3006119"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1527109984, "creation_date": 1527107752, "question_id": 50497066, "link": "https://stackoverflow.com/questions/50497066/pipes-between-uncle-and-nephwew", "title": "Pipes between uncle and nephwew", "body": "<p>So I have the following code</p>\n\n<pre><code>const int CMAX = 1048578;\n\nint main(int argc, char *argv[]){\n    int fd[2];\n    pid_t v1, v2, v3, a;\n    if( pipe( fd ) == -1 ){\n        puts(\"Failed to create pipe !\\n\" );\n        return 1;\n    }\n    v1 = fork();\n    if(v1 == 0){\n        close(fd[0]);\n        write(fd[1], \"hello\", CMAX);\n        printf(\"v1      Parent's PID = %ld; Process' PID = %ld\\n\", getppid(), getpid());\n    }\n    if(v1 &gt; 0){\n        v2 = fork();\n        if(v2 == 0){    \n            printf(\"v2      Parent's PID = %ld; Process' PID = %ld\\n\", getppid(), getpid());\n        }\n        if(v2 &gt; 0){\n            v3 = fork();\n            if(v3 == 0){\n                printf(\"v3      Parent's PID = %ld; Process' PID = %ld\\n\", getppid(), getpid());\n                a = fork();\n                if(a == 0){\n                    printf(\"a       Parent's PID = %ld;  Child's PID = %ld\\n\", getppid(), getpid());\n                    close(fd[1]);\n                    char buf[CMAX];\n                    int bytes = read(fd[0], buf, CMAX);\n                    printf(\"Message: %s\\nSize: %d\", buf, bytes);\n                    }\n                }\n            }\n    }\n    return 0;\n}\n</code></pre>\n\n<p>It outputs the following text:</p>\n\n<pre><code>v2      Parent's PID = 23859; Process' PID = 23861\nv1      Parent's PID = 23859; Process' PID = 23860\nv3      Parent's PID = 23859; Process' PID = 23862\na       Parent's PID = 23862;  Child's PID = 23863\nMessage: \nSize: 0\n</code></pre>\n\n<p>I want to send a message (or any sort of data) from the <code>v1</code> process to the <code>a</code> process. I suppose I have to close pipes in other processes but not sure how. I tried closing them in every process but didn't succeed (maybe I closed them wrong).</p>\n"}, {"tags": ["c", "list", "text", "scanf"], "comments": [{"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 3, "creation_date": 1527107884, "post_id": 50496996, "comment_id": 88006991, "body": "<code>fscanf</code> wants the address of the variable (not his value), change <code>a[i].medie</code> to <code>&amp;a[i].medie</code> for the <code>float</code> member."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1527107900, "post_id": 50496996, "comment_id": 88007002, "body": "What are the return values of <code>fopen()</code> and <code>fscanf()</code>? Whenever you use functions like these and ignore the return values, you will very likely be asked the same question."}], "answers": [{"tags": [], "owner": {"reputation": 1037, "user_id": 6342463, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/STRPB.jpg?s=128&g=1", "display_name": "Jabberwock", "link": "https://stackoverflow.com/users/6342463/jabberwock"}, "is_accepted": true, "score": 0, "last_activity_date": 1527108329, "creation_date": 1527108329, "answer_id": 50497205, "question_id": 50496996, "link": "https://stackoverflow.com/questions/50496996/how-to-copy-from-text-file-to-struct-using-fscanf/50497205#50497205", "title": "how to copy from text file to struct using fscanf", "body": "<p>Almost certainly because you are passing a[i].medie (the value of the float) not &amp;a[i].medie (the address of the float) to fscanf().</p>\n\n<p>But you will also crash if the file input.txt is not present or not readable, as you don't check for an error return from fopen()</p>\n"}], "owner": {"reputation": 33, "user_id": 9565595, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e76eb5c95b5cccdef89c5ba8eefb983?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan Nastase", "link": "https://stackoverflow.com/users/9565595/stefan-nastase"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "accepted_answer_id": 50497205, "answer_count": 1, "score": 0, "last_activity_date": 1527108329, "creation_date": 1527107396, "last_edit_date": 1527107907, "question_id": 50496996, "link": "https://stackoverflow.com/questions/50496996/how-to-copy-from-text-file-to-struct-using-fscanf", "title": "how to copy from text file to struct using fscanf", "body": "<pre><code>    #include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n\n\ntypedef struct Student{\nchar nume[30];\nchar prenume[30];\nfloat medie;\n}Student;\n\nint main()\n{   FILE *st= fopen(\"input.txt\",\"r\");\n    Student a[10];\n    int i;\n    for(i=0;i&lt;10;i++)\n        fscanf(st,\"%s %s %f\",a[i].nume,a[i].prenume,a[i].medie);\n    fclose(st);\n    return 0;\n}\n</code></pre>\n\n<p>this should read the first name, last name and a number from a list, why does it crash?</p>\n\n<p>the list looks like this:</p>\n\n<pre><code>ALEXANDRU Tudor 2.23\nAMUZA Marius 2.15\nCELCAN Alexandra 2.29\nKONRAD Eric 2.15\n...\n</code></pre>\n"}, {"tags": ["c", "c++11", "macros", "openmp"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1527107738, "post_id": 50496816, "comment_id": 88006909, "body": "Could you <code>#define macx</code> and <code>#define macy</code> and use those in the function calls?"}, {"owner": {"reputation": 5213, "user_id": 1380285, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f9a9583aed6db34815797c68823225b9?s=128&d=identicon&r=PG", "display_name": "bob.sacamento", "link": "https://stackoverflow.com/users/1380285/bob-sacamento"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1527108289, "post_id": 50496816, "comment_id": 88007166, "body": "@WeatherVane Thanks very much for your help.  I&#39;m not sure what you mean.  Probably because I&#39;m kind of new at this.  Could you elaborate?  Much obliged!"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1527108366, "post_id": 50496816, "comment_id": 88007201, "body": "As expanded in an answer."}], "answers": [{"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 3, "last_activity_date": 1527107834, "creation_date": 1527107834, "answer_id": 50497090, "question_id": 50496816, "link": "https://stackoverflow.com/questions/50496816/any-clean-way-to-get-openmp-pragmas-to-work-with-macros/50497090#50497090", "title": "Any clean way to get OpenMP pragmas to work with macros?", "body": "<p>The easiest and most natural thing I can think of would be this:</p>\n\n<pre><code>// Just once, in a header if need be:\n\n#ifdef MAC1\n// Note trailing comma:\n#define MAC1_VARS x1, y1,\n#else\n#define MAC1_VARS\n#endif\n\n#ifdef MAC2\n// Note trailing comma:\n#define MAC2_VARS x2, y2,\n#else\n#define MAC2_VARS\n#endif\n/////////////////////////\n\n// ...\n\n// each parallel region / loop:\n#pragma omp parallel private(MAC1_VARS \\\n                         MAC2_VARS     \\\n                         other, stuff)\n{\n    // ...\n}\n</code></pre>\n\n<p>The <code>MAC1_VARS</code> and <code>MAC2_VARS</code> thus expand appropriately, either to nothing or to an appropriate subsequence of the variable list.</p>\n\n<p>If you can modify the client code that conditionally declares those variables, then I would put the definitions of <code>MAC1_VARS</code> and <code>MAC2_VARS</code> there, too, instead of in separate preprocessor conditionals.</p>\n"}, {"comments": [{"owner": {"reputation": 5213, "user_id": 1380285, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f9a9583aed6db34815797c68823225b9?s=128&d=identicon&r=PG", "display_name": "bob.sacamento", "link": "https://stackoverflow.com/users/1380285/bob-sacamento"}, "edited": false, "score": 0, "creation_date": 1527266508, "post_id": 50532443, "comment_id": 88079113, "body": "Interesting.  I&#39;ve never seen this before.  Thanks!"}], "tags": [], "owner": {"reputation": 1323, "user_id": 487362, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3f5c8ff7df2a8d8eeb983da2256fba54?s=128&d=identicon&r=PG", "display_name": "ipapadop", "link": "https://stackoverflow.com/users/487362/ipapadop"}, "is_accepted": false, "score": 1, "last_activity_date": 1527261723, "creation_date": 1527261723, "answer_id": 50532443, "question_id": 50496816, "link": "https://stackoverflow.com/questions/50496816/any-clean-way-to-get-openmp-pragmas-to-work-with-macros/50532443#50532443", "title": "Any clean way to get OpenMP pragmas to work with macros?", "body": "<p>If you compile using C99 and up, you can use the pragma operator: <a href=\"https://gcc.gnu.org/onlinedocs/cpp/Pragmas.html\" rel=\"nofollow noreferrer\">https://gcc.gnu.org/onlinedocs/cpp/Pragmas.html</a></p>\n\n<p>Here's a small working example:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;omp.h&gt;\n\n#define MAC1\n#define MAC2\n\n#ifdef MAC1\ndouble x1 = 0.0, y1 = 0.1;\n#endif\n\n#ifdef MAC2\ndouble x2 = 1.0, y2 = 1.1;\n#endif\n\n#if defined(MAC1) &amp;&amp; defined(MAC2)\n# define MY_OMP_LOOP_PRAGMA _Pragma(\"omp parallel for firstprivate(x1, y1, x2, y2)\")\n#elif defined(MAC1)\n# define MY_OMP_LOOP_PRAGMA _Pragma(\"omp parallel for firstprivate(x1, y1)\")\n#elif defined(MAC2)\n# define MY_OMP_LOOP_PRAGMA _Pragma(\"omp parallel for firstprivate(x2, y2)\")\n#endif\n\nint main(int argc, char* argv[])\n{\n   int imax = 10;\nMY_OMP_LOOP_PRAGMA\n   for (int i=0; i &lt; imax; ++i) {\n#ifdef MAC1\n     printf(\"%d: %f, %f\\n\", omp_get_thread_num(), x1, y1);\n#endif\n#ifdef MAC2\n    printf(\"%d: %f, %f\\n\", omp_get_thread_num(), x2, y2);\n#endif\n}\n\n  return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 5213, "user_id": 1380285, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f9a9583aed6db34815797c68823225b9?s=128&d=identicon&r=PG", "display_name": "bob.sacamento", "link": "https://stackoverflow.com/users/1380285/bob-sacamento"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 301, "favorite_count": 0, "accepted_answer_id": 50497090, "answer_count": 2, "score": 2, "last_activity_date": 1527261723, "creation_date": 1527106708, "question_id": 50496816, "link": "https://stackoverflow.com/questions/50496816/any-clean-way-to-get-openmp-pragmas-to-work-with-macros", "title": "Any clean way to get OpenMP pragmas to work with macros?", "body": "<p>I have to add OpenMP to a customer's code.  It has a couple of macros that work sort of like so:</p>\n\n<pre><code>int i, imax;\n#ifdef MAC1\ndouble x1, y1\n#endif\n#ifdef MAC2\ndouble x2, y2\n#endif\n\n//first loop:\nfor (i=0; i&lt;imax; i++ ) {\n#ifdef MAC1\n//process x1, y1\n#endif\n#ifdef MAC2\n//process x2, y2\n#endif\n//do a ton of other stuff\n}\n\n// Lots more code.  No way it will all work in one omp region.\n\n//second loop:\nfor (i=0; i&lt;imax; i++ ) {\n#ifdef MAC1\n//process x1, y1\n#endif\n#ifdef MAC2\n//process x2, y2\n#endif\n//do a ton of other stuff\n}\n</code></pre>\n\n<p>It is completely possible that <code>MAC1</code> and <code>MAC2</code> may both be defined, or either, or neither.</p>\n\n<p>So now, I want to run the loops under OpenMP.  This generally won't work:</p>\n\n<pre><code>#pragma omp parallel private(x1, y1,   \\\n                             x2, y2,   \\\n                             and a     \\\n                             ton of    \\\n                             other stuff)\n{\n...\n}\n</code></pre>\n\n<p>... because if <code>MAC1</code> and/or <code>MAC2</code> are undefined, the compiler complains that <code>x1, y1</code>, and/or <code>x2, y2</code> are undefined.</p>\n\n<p>I have thought of several ways to get around this that either won't work or are sub-standard:</p>\n\n<p>1) I can't just pull the definitions of these variables into the omp parallel region because, as I said, I will have to use them in a second region later and I can't redefine them there.</p>\n\n<p>2) I guess I could pull these variables outside of their macro blocks and define them whether they are needed or not.  This would be the simplest solution, but that seems kind of \"hack-ish\".  And I suspect that in principle there are situations where this wouldn't work anyway.</p>\n\n<p>3) I guess I could write several omp pragmas, one for each combination of macros, encased in four different <code>#ifdefs</code>, but then I need four different optional pragmas and the code is going to get messy real fast.</p>\n\n<p>4) I tried to do something like</p>\n\n<pre><code>#pragma omp parallel private(the other stuff) \\\n#ifdef MAC1\n                     private(x1, y1)   \\\n#endif\n#ifdef MAC2\n                     private(x2, y2)   \\\n#endif\n{ ... }\n</code></pre>\n\n<p>This would still be not so nice to look at, but it would be much better than four different optional pragmas.  Nevertheless, I tried several syntax variations of this but the compiler had no idea what I was trying to do.</p>\n\n<p>Anyone know a clean way to do what I am trying to do here?</p>\n"}, {"tags": ["c", "arrays", "function"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1527106963, "post_id": 50496799, "comment_id": 88006491, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/11656532/returning-an-array-using-c\">Returning an array using C</a>"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1527107094, "post_id": 50496799, "comment_id": 88006568, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/22288871/function-returning-address-of-local-variable-error-in-c\">Function returning address of local variable error in C</a>"}, {"owner": {"reputation": 1604, "user_id": 7032512, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/4848s.png?s=128&g=1", "display_name": "amin saffar", "link": "https://stackoverflow.com/users/7032512/amin-saffar"}, "edited": false, "score": 0, "creation_date": 1527107174, "post_id": 50496799, "comment_id": 88006608, "body": "int last[b]; what&#39;s this? this is fault"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 1604, "user_id": 7032512, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/4848s.png?s=128&g=1", "display_name": "amin saffar", "link": "https://stackoverflow.com/users/7032512/amin-saffar"}, "edited": false, "score": 0, "creation_date": 1527107267, "post_id": 50496799, "comment_id": 88006670, "body": "@aminsaffar <code>int last[b];</code> is a VLA (variable length array). It&#39;s only a fault if the compiler does not support it."}], "answers": [{"comments": [{"owner": {"reputation": 89, "user_id": 9814794, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ce8df19518fecf79162c66f62ec4731?s=128&d=identicon&r=PG&f=1", "display_name": "Rishad Tanjim", "link": "https://stackoverflow.com/users/9814794/rishad-tanjim"}, "edited": false, "score": 0, "creation_date": 1527107073, "post_id": 50496834, "comment_id": 88006558, "body": "Changed but showing <code>error: invalid conversion from \u2018void*\u2019 to \u2018int*\u2019 [-fpermissive]|</code>"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 89, "user_id": 9814794, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ce8df19518fecf79162c66f62ec4731?s=128&d=identicon&r=PG&f=1", "display_name": "Rishad Tanjim", "link": "https://stackoverflow.com/users/9814794/rishad-tanjim"}, "edited": false, "score": 2, "creation_date": 1527107196, "post_id": 50496834, "comment_id": 88006626, "body": "@RishadTanjim C allows that - even prefers the lack of cast. Are you programming in C?"}, {"owner": {"reputation": 89, "user_id": 9814794, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ce8df19518fecf79162c66f62ec4731?s=128&d=identicon&r=PG&f=1", "display_name": "Rishad Tanjim", "link": "https://stackoverflow.com/users/9814794/rishad-tanjim"}, "edited": false, "score": 0, "creation_date": 1527107488, "post_id": 50496834, "comment_id": 88006792, "body": "wow it works now ! file extension was .cpp changed to .c and now works"}], "tags": [], "owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "is_accepted": true, "score": 3, "last_activity_date": 1527106805, "creation_date": 1527106805, "answer_id": 50496834, "question_id": 50496799, "link": "https://stackoverflow.com/questions/50496799/returning-arrays-with-custom-function-in-c-not-working/50496834#50496834", "title": "Returning arrays with custom function in c not working", "body": "<p>You are returning the address of a local array whose lifetime ends with the function.</p>\n\n<p>Change</p>\n\n<pre><code>int last[b];\n</code></pre>\n\n<p>to</p>\n\n<pre><code>int *last = malloc(sizeof(int) * b);\n</code></pre>\n\n<p>Don't forget to call <code>free(r);</code> after the <code>printf</code></p>\n"}, {"tags": [], "owner": {"reputation": 4513, "user_id": 3416272, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/xL2ZJ.jpg?s=128&g=1", "display_name": "Md Johirul Islam", "link": "https://stackoverflow.com/users/3416272/md-johirul-islam"}, "is_accepted": false, "score": 2, "last_activity_date": 1527107212, "creation_date": 1527107212, "answer_id": 50496943, "question_id": 50496799, "link": "https://stackoverflow.com/questions/50496799/returning-arrays-with-custom-function-in-c-not-working/50496943#50496943", "title": "Returning arrays with custom function in c not working", "body": "<p>Here is the working code</p>\n\n<pre><code>#include&lt;stdio.h&gt;\nint * range(int a, int b);\n\nint main()\n{\n     int *r;\n     int j;\n     r = range(0,5);\n     printf(\"%d\",r[1]); // Outputs 1\n     free(r);\n     return 0;\n}\n\nint * range(int a, int b){\n    int *last = malloc(sizeof(int) * b);\n    int i,j;\n    for(i=a;i&lt;b;i++){\n        last[i] = i;\n    }\n    return last;\n}\n</code></pre>\n\n<p>You can run in Ideone <a href=\"https://ideone.com/OzaYoL\" rel=\"nofollow noreferrer\">https://ideone.com/OzaYoL</a></p>\n"}, {"tags": [], "owner": {"reputation": 2465, "user_id": 5462988, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9i3ex.jpg?s=128&g=1", "display_name": "anoopknr", "link": "https://stackoverflow.com/users/5462988/anoopknr"}, "is_accepted": false, "score": 1, "last_activity_date": 1527107287, "creation_date": 1527107287, "answer_id": 50496965, "question_id": 50496799, "link": "https://stackoverflow.com/questions/50496799/returning-arrays-with-custom-function-in-c-not-working/50496965#50496965", "title": "Returning arrays with custom function in c not working", "body": "<p>This happens because your function <code>int * range(int a, int b);</code> returns address of <strong>local variable</strong>. So in order to correct it you have to <em>dynamically</em> allocate memory to <code>last</code> .</p>\n\n<p>Try this code :</p>\n\n<pre><code>int *last=(int *)malloc(sizeof(int)*b);\n</code></pre>\n\n<p>This will work.</p>\n"}, {"tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": false, "score": 2, "last_activity_date": 1527110067, "creation_date": 1527110067, "answer_id": 50497566, "question_id": 50496799, "link": "https://stackoverflow.com/questions/50496799/returning-arrays-with-custom-function-in-c-not-working/50497566#50497566", "title": "Returning arrays with custom function in c not working", "body": "<p>Your immediate problem is that the <code>last</code> array <em>ceases to exist</em> as soon as the <code>range</code> function exits, so the pointer being returned is no longer valid.</p>\n\n<p>If you want <code>range</code> to set aside the memory for the array as well as initialize its content, then you'll have to allocate the memory dynamically:</p>\n\n<pre><code>int *range( int a, int b )\n{\n  int *last = malloc( sizeof *last * b );\n  if ( last )\n  {\n    for ( size_t i = a; i &lt; b; i++ )\n      last[i] = i;\n  }\n  return last;\n}\n</code></pre>\n\n<p>You will need to remember to <code>free</code> that memory when you're done with it.  </p>\n\n<p>A quick comment - it's not clear to me how you intend <code>range</code> to work when it comes to setting values.  If you called <code>range(3,6)</code>, you'd get a 6-element array, but you'd only set the values of <code>last[3]</code>, <code>last[4]</code>, and <code>last[5]</code>, leaving <code>last[0]</code> through <code>last[2]</code> containing indeterminate values.  If that's what you intended, great.  If not, you'll want to re-think this.</p>\n"}], "owner": {"reputation": 89, "user_id": 9814794, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ce8df19518fecf79162c66f62ec4731?s=128&d=identicon&r=PG&f=1", "display_name": "Rishad Tanjim", "link": "https://stackoverflow.com/users/9814794/rishad-tanjim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 50496834, "answer_count": 4, "score": 1, "last_activity_date": 1527118153, "creation_date": 1527106636, "last_edit_date": 1527118153, "question_id": 50496799, "link": "https://stackoverflow.com/questions/50496799/returning-arrays-with-custom-function-in-c-not-working", "title": "Returning arrays with custom function in c not working", "body": "<p>I am new to C programming. Take a look at my code &amp; point me where i am doing wrong? Here is my code to create a range function which should return int array.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\nint * range(int a, int b);\n\nmain()\n{\n    int *r;\n    int j;\n    r = range(0,5);\n    printf(\"%d\",r[0]); // getting the first one to check array but not working\n                       // instead showing segmantation fault\n}\n\nint * range(int a, int b) {\n\n    int last[b];\n    int i,j;\n\n    for(i=a;i&lt;b;i++){\n        last[i] = i;\n    }\n\n    return last;\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "scope", "function-declaration"], "comments": [{"owner": {"reputation": 74843, "user_id": 2988730, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ZOX7t.jpg?s=128&g=1", "display_name": "Mad Physicist", "link": "https://stackoverflow.com/users/2988730/mad-physicist"}, "edited": false, "score": 5, "creation_date": 1527104405, "post_id": 50496264, "comment_id": 88005250, "body": "Pick a language."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 6, "creation_date": 1527104424, "post_id": 50496264, "comment_id": 88005260, "body": "<i>Is it a perk of the C programming language</i> - yes, it is. C is naive and thinks that the programmer knows what they are doing."}, {"owner": {"reputation": 1810, "user_id": 5500589, "user_type": "registered", "accept_rate": 35, "profile_image": "https://i.stack.imgur.com/IldVR.jpg?s=128&g=1", "display_name": "Galaxy", "link": "https://stackoverflow.com/users/5500589/galaxy"}, "edited": false, "score": 0, "creation_date": 1527104476, "post_id": 50496264, "comment_id": 88005289, "body": "This question pertains to both C and C++, although I usually use them interchangeably as one single language."}, {"owner": {"reputation": 74843, "user_id": 2988730, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ZOX7t.jpg?s=128&g=1", "display_name": "Mad Physicist", "link": "https://stackoverflow.com/users/2988730/mad-physicist"}, "edited": false, "score": 0, "creation_date": 1527104489, "post_id": 50496264, "comment_id": 88005294, "body": "Why wouldn&#39;t it let you call an undeclared function? Declaration just specifies the function signature, not anything real about the function."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 74843, "user_id": 2988730, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ZOX7t.jpg?s=128&g=1", "display_name": "Mad Physicist", "link": "https://stackoverflow.com/users/2988730/mad-physicist"}, "edited": false, "score": 0, "creation_date": 1527104538, "post_id": 50496264, "comment_id": 88005316, "body": "@MadPhysicist ... which is quite important. If not provided, it has to <i>assume</i> some default signature."}, {"owner": {"reputation": 1810, "user_id": 5500589, "user_type": "registered", "accept_rate": 35, "profile_image": "https://i.stack.imgur.com/IldVR.jpg?s=128&g=1", "display_name": "Galaxy", "link": "https://stackoverflow.com/users/5500589/galaxy"}, "edited": false, "score": 0, "creation_date": 1527104582, "post_id": 50496264, "comment_id": 88005336, "body": "Doesn&#39;t a declaration of a function say, &quot;Hey, I&#39;m defined in another translation unit, but I&#39;ll let you call me.&quot; A declaration extends scope of the function into another translation unit."}, {"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 1, "creation_date": 1527104659, "post_id": 50496264, "comment_id": 88005373, "body": "@Galaxy A declaration more or less just tells you what type something has (type of function in C and C++ is usually called a signature). It doesn&#39;t really have anything to do with multiple translation units and what not, although it&#39;s also useful for that."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1527104666, "post_id": 50496264, "comment_id": 88005379, "body": "@Galaxy Not really. Functions linkage is external by default. Once you have function in some translation unit, it is visible for all."}, {"owner": {"reputation": 480272, "user_id": 1968, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd630f72eef3790bfb4ef38d08c7f85?s=128&d=identicon&r=PG", "display_name": "Konrad Rudolph", "link": "https://stackoverflow.com/users/1968/konrad-rudolph"}, "edited": false, "score": 2, "creation_date": 1527104695, "post_id": 50496264, "comment_id": 88005393, "body": "@Galaxy The question can\u2019t pertain to both languages since C++ doesn\u2019t allow this. ;-)"}, {"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1527104715, "post_id": 50496264, "comment_id": 88005400, "body": "<i>&quot;Also, in C89, functions returning int may be implicitly declared by the function call operator and function parameters of type int do not have to be declared when using old-style function definitions.&quot;</i> see: <a href=\"http://en.cppreference.com/w/c/language/declarations\" rel=\"nofollow noreferrer\">en.cppreference.com/w/c/language/declarations</a>"}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "edited": false, "score": 3, "creation_date": 1527104900, "post_id": 50496264, "comment_id": 88005494, "body": "It&#39;s a backward compatibility thing. C was born without prototypes. The programmer was supposed to know how to call each function and each undeclared function was assumed to return int (and take an unspecified number of (promoted) arguments, which is a consequence of no prototypes)."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "edited": false, "score": 1, "creation_date": 1527105079, "post_id": 50496264, "comment_id": 88005584, "body": "@PSkocik True about early C.  At <a href=\"https://jcmit.net/memoryprice.htm\" rel=\"nofollow noreferrer\">$0.02/byte</a> in 1978, why use any code/functionality unless it was absolutely required?"}, {"owner": {"reputation": 49854, "user_id": 16287, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Ogq0T.png?s=128&g=1", "display_name": "Drew Dormann", "link": "https://stackoverflow.com/users/16287/drew-dormann"}, "edited": false, "score": 1, "creation_date": 1527105695, "post_id": 50496264, "comment_id": 88005888, "body": "&quot;g++ does what it&#39;s supposed to do...But gcc did not&quot;  That is an incorrect assumption.   They are both implementing a different language, correctly.  Are you asking why C and C++ are <i>different</i> in this particular regard?  That&#39;s not what you&#39;re asking in the title to this question."}], "answers": [{"comments": [{"owner": {"reputation": 1810, "user_id": 5500589, "user_type": "registered", "accept_rate": 35, "profile_image": "https://i.stack.imgur.com/IldVR.jpg?s=128&g=1", "display_name": "Galaxy", "link": "https://stackoverflow.com/users/5500589/galaxy"}, "edited": false, "score": 0, "creation_date": 1527104801, "post_id": 50496348, "comment_id": 88005446, "body": "But WHY does C allow undeclared functions to be called, unlike C++?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 3, "creation_date": 1527104837, "post_id": 50496348, "comment_id": 88005464, "body": "Because it <i>can</i>. C++ is a different language with some more strict rules."}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "edited": false, "score": 1, "creation_date": 1527105090, "post_id": 50496348, "comment_id": 88005588, "body": "Or with <code>-Werror</code> (<code>-Werror=implicit-function-declaration</code>). That&#39;s even more serious. :)"}, {"owner": {"reputation": 1190, "user_id": 962670, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b7cb6dca5f7ca6b68e700e7c8a9c2415?s=128&d=identicon&r=PG", "display_name": "Triang3l", "link": "https://stackoverflow.com/users/962670/triang3l"}, "reply_to_user": {"reputation": 1810, "user_id": 5500589, "user_type": "registered", "accept_rate": 35, "profile_image": "https://i.stack.imgur.com/IldVR.jpg?s=128&g=1", "display_name": "Galaxy", "link": "https://stackoverflow.com/users/5500589/galaxy"}, "edited": false, "score": 0, "creation_date": 1527332047, "post_id": 50496348, "comment_id": 88095117, "body": "@Galaxy Historic reasons, coming from the B language which had only one storage type \u2014 which became <code>int</code> in C. Though you needed to declare functions you used within blocks, like <code>main() { extrn &#47;* sic *&#47; printn, char, putchar; \u2026 }</code>, but I&#39;m not sure if that was mandatory."}, {"owner": {"reputation": 447, "user_id": 6100005, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Ci6HLXLJSCQ/AAAAAAAAAAI/AAAAAAAADCw/Z70ZfBgThKk/photo.jpg?sz=128", "display_name": "Max Coplan", "link": "https://stackoverflow.com/users/6100005/max-coplan"}, "edited": false, "score": 0, "creation_date": 1568061941, "post_id": 50496348, "comment_id": 102148178, "body": "Consider two parts of making a program: compiling and linking.  Why don&#39;t you try getting rid of <code>say_hello</code> in <code>test1.c</code> and see what happens?  The program compiles fine, but when the linker tries to search for <code>say_hello</code> (since it&#39;s called in <code>test2.c</code>), it fails.  So one way to phrase this difference between C and C++ is that C will throw a linker error and C++ will throw a compiler error."}], "tags": [], "owner": {"reputation": 623, "user_id": 2008273, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VTTvj.jpg?s=128&g=1", "display_name": "ricco19", "link": "https://stackoverflow.com/users/2008273/ricco19"}, "is_accepted": false, "score": 5, "last_activity_date": 1527104740, "creation_date": 1527104740, "answer_id": 50496348, "question_id": 50496264, "link": "https://stackoverflow.com/questions/50496264/why-does-c-allow-me-to-call-an-undeclared-function/50496348#50496348", "title": "Why does C allow me to call an undeclared function?", "body": "<p>Simple, because C allows undeclared functions to be called and C++ does not. Either way, <code>gcc</code> warns you and you may want to take warnings seriously.</p>\n"}], "owner": {"reputation": 1810, "user_id": 5500589, "user_type": "registered", "accept_rate": 35, "profile_image": "https://i.stack.imgur.com/IldVR.jpg?s=128&g=1", "display_name": "Galaxy", "link": "https://stackoverflow.com/users/5500589/galaxy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1068, "favorite_count": 0, "closed_date": 1527104824, "answer_count": 1, "score": 3, "last_activity_date": 1527104740, "creation_date": 1527104333, "question_id": 50496264, "link": "https://stackoverflow.com/questions/50496264/why-does-c-allow-me-to-call-an-undeclared-function", "closed_reason": "Duplicate", "title": "Why does C allow me to call an undeclared function?", "body": "<p>I have two files: <code>test1.c</code>, and <code>test2.c</code>, which contains the <code>main()</code> function.</p>\n\n<p>test1.c:</p>\n\n<pre><code>#include &lt;stdio.h&gt;  // printf() function declaration/prototype\n\n// function definition\nvoid say_hello() {\n  printf(\"\\tHello, world!\\n\");\n}\n</code></pre>\n\n<p>test2.c:</p>\n\n<pre><code>#include &lt;stdio.h&gt;  // printf() function declaration/prototype\nint main() {\n  printf(\"Inside main()\\n\");\n  say_hello();\n\n  return 0;\n}\n</code></pre>\n\n<p>And this is my makefile:</p>\n\n<pre><code>a.out: test1.o test2.o\n    $(CXX) -o a.out test1.o test2.o\n\ntest1.o: test1.c\n    $(CXX) -c test1.c\n\ntest2.o: test2.c\n    $(CXX) -c test2.c\n</code></pre>\n\n<p>Now it should be clear where the problem lies: The main() function in test2.c calls say_hello() without declaring it!\nI run the following command, to use the gcc compiler:\n<code>make CXX=gcc</code>\nI get this warning to the screen:</p>\n\n<pre><code>gcc -c test1.c\ngcc -c test2.c\ntest2.c: In function \u2018main\u2019:\ntest2.c:16:3: warning: implicit declaration of function \u2018say_hello\u2019 [-Wimplicit-function-declaration]\n   say_hello();\n   ^\ngcc -o a.out test1.o test2.o\n</code></pre>\n\n<p>Although the *.o files got compiled and linked into the executable. That's weird. Imagine my surprise when I run the a.out file, and I see that <code>main()</code> successfully called <code>say_hello()</code>, a function which is not declared inside of main's translation unit, as if there were no issue at all! I reason that since <code>say_hello()</code> was not previously declared in <code>test2.c</code>, it should not allowed to be called by <code>main()</code> at all. Notice that I've added comments to the <code>#include &lt;stdio.h&gt;</code>. These preprocessor directives include the function declarations/prototypes, which extend their scope into the corresponding *.c files. That is why we are able to use them. No function declaration/prototype == no scope in that translation unit, or so I thought until now.</p>\n\n<p>Then I compiled the above code as C++ code:\n<code>make CXX=g++</code></p>\n\n<p>I get this error to the screen:</p>\n\n<pre><code>test2.c: In function \u2018int main()\u2019:\ntest2.c:16:13: error: \u2018say_hello\u2019 was not declared in this scope\n   say_hello();\n             ^\nmakefile:18: recipe for target 'test2.o' failed\nmake: *** [test2.o] Error 1\n</code></pre>\n\n<p>g++ does what it's supposed to do, and stops the compilation process. But gcc did not do this! What's going on? Is it a perk of the C programming language? Is it an issue with the compiler?</p>\n"}, {"tags": ["c", "string", "wchar-t"], "comments": [{"owner": {"reputation": 719, "user_id": 3476492, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/IPHzX.jpg?s=128&g=1", "display_name": "01000001", "link": "https://stackoverflow.com/users/3476492/01000001"}, "edited": false, "score": 1, "creation_date": 1527103627, "post_id": 50496030, "comment_id": 88004875, "body": "Can you put output for both cases; the case where it worked and the case where it didn&#39;t?"}, {"owner": {"reputation": 41, "user_id": 9269954, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/13ce55e685bd7adea240f02f72f89efd?s=128&d=identicon&r=PG&f=1", "display_name": "Paulo Cezar Sousa Paes", "link": "https://stackoverflow.com/users/9269954/paulo-cezar-sousa-paes"}, "reply_to_user": {"reputation": 719, "user_id": 3476492, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/IPHzX.jpg?s=128&g=1", "display_name": "01000001", "link": "https://stackoverflow.com/users/3476492/01000001"}, "edited": false, "score": 0, "creation_date": 1527104326, "post_id": 50496030, "comment_id": 88005205, "body": "That&#39;s the thing, it&#39;s the same code, it worked and then I went to look my main program and see if there were any differences on how i used wchar, and when i went back and runned the code again it didn&#39;t work."}, {"owner": {"reputation": 41, "user_id": 9269954, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/13ce55e685bd7adea240f02f72f89efd?s=128&d=identicon&r=PG&f=1", "display_name": "Paulo Cezar Sousa Paes", "link": "https://stackoverflow.com/users/9269954/paulo-cezar-sousa-paes"}, "reply_to_user": {"reputation": 719, "user_id": 3476492, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/IPHzX.jpg?s=128&g=1", "display_name": "01000001", "link": "https://stackoverflow.com/users/3476492/01000001"}, "edited": false, "score": 0, "creation_date": 1527104415, "post_id": 50496030, "comment_id": 88005256, "body": "i want the code to read for example &quot;&#231;&#225;&quot; and print it normally, it work with ASCII characters, but not with the wide characters it should work"}, {"owner": {"reputation": 44820, "user_id": 4492932, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e8938ef2681650e100bc9f83434ef272?s=128&d=identicon&r=PG", "display_name": "DYZ", "link": "https://stackoverflow.com/users/4492932/dyz"}, "edited": false, "score": 0, "creation_date": 1527105849, "post_id": 50496030, "comment_id": 88005954, "body": "You should check the value returned by <code>setlocale</code>. It is possible that the locale you requested may not have been set."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1527106466, "post_id": 50496030, "comment_id": 88006233, "body": "1)  Check return value from all 3 function calls. 2) <code>&quot;&#231;&#225;\\n&quot;</code> is too big for <code>wchar_t meu[3];</code>"}, {"owner": {"reputation": 41, "user_id": 9269954, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/13ce55e685bd7adea240f02f72f89efd?s=128&d=identicon&r=PG&f=1", "display_name": "Paulo Cezar Sousa Paes", "link": "https://stackoverflow.com/users/9269954/paulo-cezar-sousa-paes"}, "edited": false, "score": 0, "creation_date": 1527107311, "post_id": 50496030, "comment_id": 88006699, "body": "even if i increase n in wchar_t meu[n] and continue to pass &quot;&#231;&#225;\\n&quot; it doesn&#39;t work"}, {"owner": {"reputation": 26606, "user_id": 4603670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7eabc1427aa3c8185153cc81978289a?s=128&d=identicon&r=PG&f=1", "display_name": "Barmak Shemirani", "link": "https://stackoverflow.com/users/4603670/barmak-shemirani"}, "edited": false, "score": 1, "creation_date": 1527108509, "post_id": 50496030, "comment_id": 88007276, "body": "Show what operating system you use, and what compiler. The question has been asked before."}, {"owner": {"reputation": 41, "user_id": 9269954, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/13ce55e685bd7adea240f02f72f89efd?s=128&d=identicon&r=PG&f=1", "display_name": "Paulo Cezar Sousa Paes", "link": "https://stackoverflow.com/users/9269954/paulo-cezar-sousa-paes"}, "edited": false, "score": 0, "creation_date": 1527108847, "post_id": 50496030, "comment_id": 88007453, "body": "windows 8.1 single language and i use falcon"}, {"owner": {"reputation": 1037, "user_id": 6342463, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/STRPB.jpg?s=128&g=1", "display_name": "Jabberwock", "link": "https://stackoverflow.com/users/6342463/jabberwock"}, "edited": false, "score": 0, "creation_date": 1527113328, "post_id": 50496030, "comment_id": 88009212, "body": "What are the return values of the function calls?  If something is not working, one of them is probably failing.  Knowing what is failing is pretty fundamental to debugging the problem."}, {"owner": {"reputation": 41, "user_id": 9269954, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/13ce55e685bd7adea240f02f72f89efd?s=128&d=identicon&r=PG&f=1", "display_name": "Paulo Cezar Sousa Paes", "link": "https://stackoverflow.com/users/9269954/paulo-cezar-sousa-paes"}, "edited": false, "score": 0, "creation_date": 1527115204, "post_id": 50496030, "comment_id": 88009751, "body": "I don&#39;t understand what you mean, to as far as I know fgetws and fputws don&#39;t return anything. I&#39;m sorry i&#39;m new to c. I&#39;ve tried initializing the string explicitly and using the fputws, and it did&#39;nt work.but the fgetws could also not be working"}, {"owner": {"reputation": 26606, "user_id": 4603670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7eabc1427aa3c8185153cc81978289a?s=128&d=identicon&r=PG&f=1", "display_name": "Barmak Shemirani", "link": "https://stackoverflow.com/users/4603670/barmak-shemirani"}, "edited": false, "score": 0, "creation_date": 1527144460, "post_id": 50496030, "comment_id": 88017691, "body": "I don&#39;t know this compiler but it probably won&#39;t work, unless you use WinAPI directly. If you are on a Portuguese computer then you should be able to type in Portuguese and use <code>char</code>, Windows should use the ANSI version (it may not be compatible with other platforms). If it still doesn&#39;t work then call <code>SetConsoleOutputCP</code> and <code>SetConsoleCP</code> with Portuguese code page."}], "owner": {"reputation": 41, "user_id": 9269954, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/13ce55e685bd7adea240f02f72f89efd?s=128&d=identicon&r=PG&f=1", "display_name": "Paulo Cezar Sousa Paes", "link": "https://stackoverflow.com/users/9269954/paulo-cezar-sousa-paes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1527103403, "creation_date": 1527103403, "question_id": 50496030, "link": "https://stackoverflow.com/questions/50496030/wchar-t-strings-not-working-c", "title": "wchar_t strings not working C", "body": "<p>I'm trying to create a program that needs to get string input from the user, since it's has to work with portuguese words i'm using wchar_t,the problem is,\nC seems to have a will, because when i need it to work it doens't but then out of the blue it works in some simple test.\nthe following code worked 5 minutes ago and now it doesn't:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;wchar.h&gt;\n#include &lt;locale.h&gt;\n/\nint main(){\n    setlocale(LC_ALL,\"Portuguese\");\n\n    wchar_t meu[3];\n    fgetws(meu,3,stdin);\n    fputws(meu,stdout);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 74843, "user_id": 2988730, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ZOX7t.jpg?s=128&g=1", "display_name": "Mad Physicist", "link": "https://stackoverflow.com/users/2988730/mad-physicist"}, "edited": false, "score": 0, "creation_date": 1527103239, "post_id": 50495973, "comment_id": 88004640, "body": "What result do you expect and what did you actually do? Please show code."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1527103344, "post_id": 50495973, "comment_id": 88004704, "body": "looks like a job for regular expressions."}, {"owner": {"reputation": 33821, "user_id": 45685, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/y4RJr.jpg?s=128&g=1", "display_name": "AndersK", "link": "https://stackoverflow.com/users/45685/andersk"}, "edited": false, "score": 3, "creation_date": 1527103349, "post_id": 50495973, "comment_id": 88004706, "body": "please note that buff points to a literal which must not be modified, use instead char buff[] = ..."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1527103356, "post_id": 50495973, "comment_id": 88004714, "body": "You can&#39;t &quot;remove&quot;, but you can construct a new string."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1527103386, "post_id": 50495973, "comment_id": 88004730, "body": "find the position of <code>&lt;</code> and <code>|</code> with <code>strstr</code> and assemble both parts."}, {"owner": {"reputation": 151, "user_id": 7681153, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c1e79de15e8922c4df73d86ab96d6f0c?s=128&d=identicon&r=PG&f=1", "display_name": "Samun", "link": "https://stackoverflow.com/users/7681153/samun"}, "edited": false, "score": 0, "creation_date": 1527103491, "post_id": 50495973, "comment_id": 88004791, "body": "I have updated the question now."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1527103592, "post_id": 50495973, "comment_id": 88004845, "body": "Code cannot remove (without UB) the contents of <i>string literal</i> <code>&quot;cat \u2013v &lt;  x y z | &quot;</code>.  Code can create (allocate) a new string with the shrunken contents."}], "answers": [{"tags": [], "owner": {"reputation": 10281, "user_id": 51760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SI89u.jpg?s=128&g=1", "display_name": "Aif", "link": "https://stackoverflow.com/users/51760/aif"}, "is_accepted": false, "score": 0, "last_activity_date": 1527103617, "creation_date": 1527103617, "answer_id": 50496093, "question_id": 50495973, "link": "https://stackoverflow.com/questions/50495973/how-do-i-remove-the-substring-of-a-string-in-c/50496093#50496093", "title": "how do I remove the substring of a String in C", "body": "<p>There is (almost) not builtin solution:</p>\n\n<ul>\n<li>either you want to modify <em>inplace</em>: in that case you have to \"move\" the end of your string (basically <code>|</code>);</li>\n<li>or create a new string, copy the relevant part an skip what's not.</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "is_accepted": false, "score": 1, "last_activity_date": 1527104580, "last_edit_date": 1527104580, "creation_date": 1527104157, "answer_id": 50496226, "question_id": 50495973, "link": "https://stackoverflow.com/questions/50495973/how-do-i-remove-the-substring-of-a-string-in-c/50496226#50496226", "title": "how do I remove the substring of a String in C", "body": "<p>I would generally recommend regexes for this, and certainly not <code>strtok</code>, and even less on a string literal (undefined behaviour, see <a href=\"https://stackoverflow.com/questions/272876/cs-strtok-and-read-only-string-literals?rq=1\">C&#39;s strtok() and read only string literals</a>)</p>\n\n<p>One solution with only basic libs would be to:</p>\n\n<ul>\n<li>look for the start string/character</li>\n<li>look for the end string/character</li>\n<li>rebuild a string (as long or shorter) with the part before the start string assembled with the part after the end string.</li>\n</ul>\n\n<p>I'm using <code>strstr</code> for this. It's built-in, doesn't need a loop, and works for multi-char patterns.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;string.h&gt;\n#include&lt;stdlib.h&gt;\n\nint main()\n{\n  const char *buff = \"cat -v &lt;  x y z | hello\";\n  const char *start_pattern = \"&lt;\";\n  const char *end_pattern = \"|\";\n\n  const char *start = strstr(buff,start_pattern);\n  if (start)\n  {\n    const char *end = strstr(start,end_pattern);\n    if (end)\n    {\n    // allocate enough memory\n    char *newbuff = malloc(strlen(buff)+1);\n\n    int startlen = start-buff;   // length of the start of the string we want to keep\n\n    strncpy(newbuff,buff,startlen);  // start of the string\n    strcpy(newbuff+startlen,end+strlen(end_pattern));  // end of the string\n\n    printf(\"Result:%s\\n\",newbuff);\n    free(newbuff);   // free the memory\n    }\n  }\n\n}\n</code></pre>\n\n<p>EDIT: some code has been added to the question in the meanwhile. Which explains I didn't take it into account, as I was trying to write a not-so-clunky solution.</p>\n"}, {"tags": [], "owner": {"reputation": 14339, "user_id": 1466970, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/V1J6z.jpg?s=128&g=1", "display_name": "Richard Chambers", "link": "https://stackoverflow.com/users/1466970/richard-chambers"}, "is_accepted": true, "score": 0, "last_activity_date": 1527106446, "creation_date": 1527106446, "answer_id": 50496752, "question_id": 50495973, "link": "https://stackoverflow.com/questions/50495973/how-do-i-remove-the-substring-of-a-string-in-c/50496752#50496752", "title": "how do I remove the substring of a String in C", "body": "<p>An alternative would be a simple function that iterates over the source string copying characters that are not to be removed to a destination string as in the following.</p>\n\n<pre><code>char *  CopyStringRemove(char *pDest, const char *pSrc)\n{\n    // copy the source string, pSrc, to the destination string, pDest, while\n    // removing special codes that are between a &lt; character and a | character.\n    // we will copy the two special code characters but remove everything in between.\n    char * pRet = pDest;\n\n    if (pDest) {\n        if (pSrc) {\n            int   iState = 0;      // state indicates whether copying characters or not.\n\n            for (; *pSrc; pSrc++) {\n                switch (*pSrc) {\n                case '&lt;':\n                    iState = 1;         // indicate we are skipping characters\n                    *pDest++ = *pSrc;   // however copy this character we found\n                    break;\n                case '|':\n                    iState = 0;     // indicate we are copying characters\n                    break;\n                default:\n                    break;\n                }\n                switch (iState) {\n                case 0:\n                    *pDest++ = *pSrc;    // state is to copy the current character\n                    break;\n                case 1:                  // state is to not copy current character, just skip over it.\n                    break;\n                }\n            }\n        }\n        *pDest = 0;\n    }\n\n    return pRet;\n}\n</code></pre>\n\n<p>This function provides quite a bit of flexibility in that the source can be a constant or not. The destination may be an array on the stack or an array malloced from the heap. If the source array is not <code>const</code> then you can do an inplace change by calling the <code>CopyStringRemove()</code> function with both source and destination being the same buffer.</p>\n\n<p>It also allows for problems with the input such as not having a '&lt;' character or a '|' character in the string.</p>\n\n<p>A test harness such as:</p>\n\n<pre><code>void testfunc(const char *buff)\n{\n    {\n        char destbuff[128] = { 0 };\n        printf(\"    orig string \\\"%s\\\"\\n\", buff);\n        CopyStringRemove(destbuff, buff);\n        printf(\"        new     \\\"%s\\\"\\n\", destbuff);\n    }\n\n    {\n        char destbuff[128] = { 0 };\n        char buff2[128] = { 0 };\n        strcpy_s(buff2, sizeof(buff2), buff);\n        printf(\"    orig string \\\"%s\\\"\\n\", buff2);\n        CopyStringRemove(destbuff, buff2);\n        printf(\"        new     \\\"%s\\\"\\n\", destbuff);\n    }\n\n    {\n        char buff2[128] = { 0 };\n        strcpy_s(buff2, sizeof(buff2), buff);\n        printf(\"    orig string \\\"%s\\\"\\n\", buff2);\n        CopyStringRemove(buff2, buff2);\n        printf(\"        new     \\\"%s\\\"\\n\", buff2);\n    }\n\n}\n\nvoid main_xfun(void)\n{\n    char *buff = \"cat -v &lt;  x y z | \";\n    char *buffa = \"cat -v &lt;  x y z  \";\n    char *buffb = \"cat -v   x y z | \";\n    char *buffc = \"cat -v   x y z  \";\n\n    printf(\"\\ntest #1\\n\");\n    testfunc(buff);\n    printf(\"\\ntest #2\\n\");\n    testfunc(buffa);\n    printf(\"\\ntest #3\\n\");\n    testfunc(buffb);\n    printf(\"\\ntest #4\\n\");\n    testfunc(buffc);\n}\n</code></pre>\n\n<p>yields a result of:</p>\n\n<pre><code>test #1\n    orig string \"cat -v &lt;  x y z | \"\n        new     \"cat -v &lt;| \"\n    orig string \"cat -v &lt;  x y z | \"\n        new     \"cat -v &lt;| \"\n    orig string \"cat -v &lt;  x y z | \"\n        new     \"cat -v &lt;| \"\n\ntest #2\n    orig string \"cat -v &lt;  x y z  \"\n        new     \"cat -v &lt;\"\n    orig string \"cat -v &lt;  x y z  \"\n        new     \"cat -v &lt;\"\n    orig string \"cat -v &lt;  x y z  \"\n        new     \"cat -v &lt;\"\n\ntest #3\n    orig string \"cat -v   x y z | \"\n        new     \"cat -v   x y z | \"\n    orig string \"cat -v   x y z | \"\n        new     \"cat -v   x y z | \"\n    orig string \"cat -v   x y z | \"\n        new     \"cat -v   x y z | \"\n\ntest #4\n    orig string \"cat -v   x y z  \"\n        new     \"cat -v   x y z  \"\n    orig string \"cat -v   x y z  \"\n        new     \"cat -v   x y z  \"\n    orig string \"cat -v   x y z  \"\n        new     \"cat -v   x y z  \"\n</code></pre>\n"}], "owner": {"reputation": 151, "user_id": 7681153, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c1e79de15e8922c4df73d86ab96d6f0c?s=128&d=identicon&r=PG&f=1", "display_name": "Samun", "link": "https://stackoverflow.com/users/7681153/samun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "accepted_answer_id": 50496752, "answer_count": 3, "score": 1, "last_activity_date": 1527106446, "creation_date": 1527103170, "last_edit_date": 1527104608, "question_id": 50495973, "link": "https://stackoverflow.com/questions/50495973/how-do-i-remove-the-substring-of-a-string-in-c", "title": "how do I remove the substring of a String in C", "body": "<p>I am having hard time getting the substring of a string in C. For example if I have a </p>\n\n<pre><code>char *buff = \"cat \u2013v &lt;  x y z | \";\nchar *p = strtok (buff, \" \");\nwhile (p != NULL)\n{\n    if (!strcmp(p, \"&lt;\") &amp;&amp; !isredirected)\n    {\n        isredirected = 1;\n        infileindex  = tokenscounter + 1;\n        inputredirectionindex = tokenscounter;\n    }\n    commandsArray[tokenscounter++]  = p;\n    p = strtok (NULL, \" \");\n\n}\n</code></pre>\n\n<p>from this buff string, I would like to remove any string that is between <strong>'&lt;'</strong> and <strong>'|'</strong>. that is removing x y z . I used strtok to parse all the tokens, but cannot get to remove that x y z.  After I find <strong>'&lt;'</strong> I want to get rid of all the tokens that come after <strong>&lt;</strong> and before <strong>|</strong></p>\n"}, {"tags": ["c", "file", "malloc", "free"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1527102202, "post_id": 50495660, "comment_id": 88004123, "body": "500 lines of code ;)"}, {"owner": {"reputation": 81, "user_id": 9518524, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Gderu", "link": "https://stackoverflow.com/users/9518524/gderu"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1527102284, "post_id": 50495660, "comment_id": 88004160, "body": "Yep :/. It&#39;s a bit of a long one. I&#39;m pretty sure the problem is either in main or statusOfFiles. Ill add that to the question."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 4, "creation_date": 1527102408, "post_id": 50495660, "comment_id": 88004227, "body": "No, you should add a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> instead."}, {"owner": {"reputation": 81, "user_id": 9518524, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Gderu", "link": "https://stackoverflow.com/users/9518524/gderu"}, "edited": false, "score": 0, "creation_date": 1527102672, "post_id": 50495660, "comment_id": 88004351, "body": "OK. I&#39;ll try to do that."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1527103349, "post_id": 50495660, "comment_id": 88004707, "body": "Could you help find the declaration/definition of <code>sortOrder</code> which you are trying to free in <code>main()</code>? And please let us know what the exact error is which &quot;it just returns an error&quot;. It would not be &quot;sortOrder undefined&quot; or something like that, would it?"}, {"owner": {"reputation": 81, "user_id": 9518524, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Gderu", "link": "https://stackoverflow.com/users/9518524/gderu"}, "edited": false, "score": 0, "creation_date": 1527103567, "post_id": 50495660, "comment_id": 88004828, "body": "ok I revised it, so now it&#39;s much shorter"}, {"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 0, "creation_date": 1527106015, "post_id": 50495660, "comment_id": 88006026, "body": "<code>**sortOrder = (char**)malloc(0);</code>  Very suspicious!"}, {"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1527106107, "post_id": 50495660, "comment_id": 88006073, "body": "You overflow the new string that you create in <code>statusOfFiles</code>"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1527126817, "post_id": 50495660, "comment_id": 88012289, "body": "Welcome, three-star programmer"}], "answers": [{"comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1527126896, "post_id": 50498290, "comment_id": 88012308, "body": "<code>strdup</code> is not in ISO C"}], "tags": [], "owner": {"reputation": 1037, "user_id": 6342463, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/STRPB.jpg?s=128&g=1", "display_name": "Jabberwock", "link": "https://stackoverflow.com/users/6342463/jabberwock"}, "is_accepted": true, "score": 1, "last_activity_date": 1527113984, "creation_date": 1527113984, "answer_id": 50498290, "question_id": 50495660, "link": "https://stackoverflow.com/questions/50495660/my-program-unexpectedly-stops-running-and-cant-free-a-variable/50498290#50498290", "title": "My program unexpectedly stops running, and can&#39;t free a variable", "body": "<p>Here:</p>\n\n<pre><code>(*sortOrder)[i] = (char*)malloc((strlen(file) + ZERO_END) * sizeof(char));\n</code></pre>\n\n<p>you malloc enough space to hold the string file plus 1 for the terminating null. \n The very next line:</p>\n\n<pre><code>strcat(strcpy((*sortOrder)[i], file), \" - \");\n</code></pre>\n\n<p>you copy file into it (filling the space entirely) and then add \" - \" to the end of it, overrunning the buffer.</p>\n\n<p>A style note that would likely have helped you find this on your own: packing as much code as you can into a single line makes code hard to read and offers no speed savings with modern compilers.  I would have written this as</p>\n\n<pre><code>(*sortOrder)[i] = malloc((strlen(file) + ZERO_END) * sizeof(char));\nstrcpy((*sortOrder)[i], file);\nstrcat((*sortOrder)[i], \" - \");\n</code></pre>\n\n<p>which makes the bug much more visible.  Actually, because strdup() does the alloc and copy for you, I'd have probably written it as</p>\n\n<pre><code>(*sortOrder)[i] = strdup(file);\nstrcat((*sortOrder)[i], \" - \");\n</code></pre>\n\n<p>which is pretty obviously wrong.</p>\n"}], "owner": {"reputation": 81, "user_id": 9518524, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Gderu", "link": "https://stackoverflow.com/users/9518524/gderu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 50498290, "answer_count": 1, "score": 0, "last_activity_date": 1527113984, "creation_date": 1527102038, "last_edit_date": 1527103858, "question_id": 50495660, "link": "https://stackoverflow.com/questions/50495660/my-program-unexpectedly-stops-running-and-cant-free-a-variable", "title": "My program unexpectedly stops running, and can&#39;t free a variable", "body": "<p>I have made a program that scans for the contents of a file (in bytes) in another file. It used to work well, but then I learned that the output has to be sorted, so I added the variable sortOrder, and changed my program a bit so that it saves the data instead of just printing it out. The problem is that now my program reaches an error at random points while running. Another problem that I have is that for some reason I can't free the strings inside sortOrder in main, it just returns an error. I'm pretty sure the problem is either in main or statusOfFiles, although I could be wrong since I don't really understand the problem.</p>\n\n<pre><code>#define _CRT_SECURE_NO_WARNINGS\n\n#include &lt;errno.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;dirent.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;sys/stat.h&gt;\n\n#define ADD_NAME 1\n#define MAX_LEN 200\n#define ZERO_END 1\n#define VIRUS 2\n#define CLEAN 0\n#define INFECTED 1\n#define FIRST_PART 2\n#define LAST_PART 3\n\nvoid addResults(int foundDetails, char*** sortOrder, int i)\n{\n    if (foundDetails == CLEAN)\n    {\n        strcat((*sortOrder)[i], \"Clean\");\n    }\n    else if (foundDetails == INFECTED)\n    {\n        strcat((*sortOrder)[i], \"Infected!\");\n    }\n    else if (foundDetails == FIRST_PART)\n    {\n        strcat((*sortOrder)[i], \"Infected! (first 20%%)\");\n    }\n    else\n    {\n        strcat((*sortOrder)[i], \"Infected! (last 20%%)\");\n    }\n}\n\nvoid statusOfFiles(char * filePath, char ** files, int lenFiles, char*** sortOrder)\n{\n    char file[MAX_LEN] = { 0 };\n    int i = 0;\n    for (i = 0; i &lt; lenFiles; i++)\n    {\n        strcpy(file, filePath);\n        strcat(file, \"/\");\n        strcat(file, files[i]);\n        *sortOrder = (char**)realloc((*sortOrder), (i + ADD_NAME) * sizeof(char*));\n        (*sortOrder)[i] = (char*)malloc((strlen(file) + ZERO_END) * sizeof(char));\n        strcat(strcpy((*sortOrder)[i], file), \" - \");\n        addResults(0, sortOrder, i);\n    }\n}\n\nvoid printResultsInOrder(char** sortOrder, int len)\n{\n    int i = 0;\n    for (i = 0; i &lt; len; i++)\n    {\n        printf(\"%s\\n\", sortOrder[i]);\n    }\n}\n\nint main(void)\n{\n    int i = 0, len = 5;\n    char *fileNames[] = {\"adgv.txt\", \"fsagda\", \"adagda\", \"adga\", \"adgastgaet\"}, **sortOrder = (char**)malloc(0);\n    statusOfFiles(\"C:/folder\", fileNames, len, &amp;sortOrder);\n    printResultsInOrder(sortOrder, len);\n    for (i = 0; i &lt; len; i++)\n    {\n        free(sortOrder[i]);\n    }\n    free(sortOrder);\n    getchar();\n    return 0;\n}\n</code></pre>\n\n<p>Thanks for the help!</p>\n"}, {"tags": ["c++", "c", "gcc", "compiler-construction", "compiler-optimization"], "comments": [{"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1527102075, "post_id": 50495572, "comment_id": 88004064, "body": "Related: <a href=\"https://stackoverflow.com/questions/37825859/cache-miss-a-tlb-miss-and-page-fault\">cache miss, a TLB miss and page fault</a>"}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1527102220, "post_id": 50495572, "comment_id": 88004131, "body": "Are you getting TLB misses due to data fetching (memory accessing) or due to instruction fetching?"}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1527103024, "post_id": 50495572, "comment_id": 88004535, "body": "There are a lot of &quot;it depends&quot; items.  It depends on the memory on your machine, whether the OS has room for all of your code, how often a function is called, and how sparse the function calls are.  There are not many TLB misses if a function is loaded and accessed frequently.  However, you may get more TLB misses if your code is calling many different functions that are not in memory.  The order is not much of an issue as the length of the function and whether it needs to be replaced."}, {"owner": {"reputation": 11238, "user_id": 7594711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7872c871b0431b72df6350dd0394bea?s=128&d=identicon&r=PG&f=1", "display_name": "SoronelHaetir", "link": "https://stackoverflow.com/users/7594711/soronelhaetir"}, "edited": false, "score": 0, "creation_date": 1527103162, "post_id": 50495572, "comment_id": 88004605, "body": "The likely answer would be to place the functions in named sequential sub-sections ((.text.prefix.1 ... .text.prefix.N) and then count on the linker placing those sub-sections in contiguous memory."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1527103220, "post_id": 50495572, "comment_id": 88004627, "body": "You may get some benefit by ordering the functions by frequency of being called.  Functions called more frequently should be placed closer to the caller than less frequently called functions."}, {"owner": {"reputation": 81, "user_id": 6401867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ed9983843252230d840a54cc214f437?s=128&d=identicon&r=PG&f=1", "display_name": "Modestas Jur\u010dius", "link": "https://stackoverflow.com/users/6401867/modestas-jur%c4%8dius"}, "reply_to_user": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1527105575, "post_id": 50495572, "comment_id": 88005833, "body": "@ThomasMatthews Yes I&#39;m planing to do just that, functions who are more likely to be called to place them closer. The question is with what tools I actually can do this."}, {"owner": {"reputation": 18599, "user_id": 4230618, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KRWgI.jpg?s=128&g=1", "display_name": "Hadi Brais", "link": "https://stackoverflow.com/users/4230618/hadi-brais"}, "edited": false, "score": 0, "creation_date": 1527130668, "post_id": 50495572, "comment_id": 88013158, "body": "This can certainly be done relatively easily, but at compile-time. Doing it at run-time is also technically possible, but is much more complicated and requires a lot of effort from your side. It&#39;s unusual to reorder functions at run-time, are you sure this is what you want?"}, {"owner": {"reputation": 81, "user_id": 6401867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ed9983843252230d840a54cc214f437?s=128&d=identicon&r=PG&f=1", "display_name": "Modestas Jur\u010dius", "link": "https://stackoverflow.com/users/6401867/modestas-jur%c4%8dius"}, "reply_to_user": {"reputation": 18599, "user_id": 4230618, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KRWgI.jpg?s=128&g=1", "display_name": "Hadi Brais", "link": "https://stackoverflow.com/users/4230618/hadi-brais"}, "edited": false, "score": 0, "creation_date": 1527147135, "post_id": 50495572, "comment_id": 88019300, "body": "@HadiBrais I would be pleased if you could give me both scenarios on how I would have to do it, compile-time and run-time."}, {"owner": {"reputation": 352, "user_id": 3473433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa87ec32236bf2a31994b1067e633067?s=128&d=identicon&r=PG&f=1", "display_name": "eugenioperez", "link": "https://stackoverflow.com/users/3473433/eugenioperez"}, "edited": false, "score": 0, "creation_date": 1527174938, "post_id": 50495572, "comment_id": 88038011, "body": "You should be able to put similar functions together with your compiler&#39;s inter-procedural profiled guide optimizations. The compiler should be able then to put hot (or temporal nearest) functions together, and cold ones far away. You need to compile your software once, run it under the PGO, and then compile it again with the generated feedback. In gcc, that option is ` --profile-generate` and ` --profile-use`. Take care that if the tests suite you use to generate profile information is too different from the actual software use, it will could perform worse than default!"}, {"owner": {"reputation": 61, "user_id": 7531575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71c42b5e8566b24cccdbba651c02f798?s=128&d=identicon&r=PG&f=1", "display_name": "Deandre Thomson", "link": "https://stackoverflow.com/users/7531575/deandre-thomson"}, "reply_to_user": {"reputation": 352, "user_id": 3473433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa87ec32236bf2a31994b1067e633067?s=128&d=identicon&r=PG&f=1", "display_name": "eugenioperez", "link": "https://stackoverflow.com/users/3473433/eugenioperez"}, "edited": false, "score": 0, "creation_date": 1527178481, "post_id": 50495572, "comment_id": 88040239, "body": "@eugenioperez How does putting related functions together actually help to decrease TLB misses? I can see that improving overall need of traversing memory when reaching the called function, but I would imaging TLB be independent of order in the actual program. Maybe you have a specific optimzation flag in mind?"}], "owner": {"reputation": 81, "user_id": 6401867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ed9983843252230d840a54cc214f437?s=128&d=identicon&r=PG&f=1", "display_name": "Modestas Jur\u010dius", "link": "https://stackoverflow.com/users/6401867/modestas-jur%c4%8dius"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 250, "favorite_count": 3, "answer_count": 0, "score": 1, "last_activity_date": 1527103127, "creation_date": 1527101716, "last_edit_date": 1527103127, "question_id": 50495572, "link": "https://stackoverflow.com/questions/50495572/subroutine-reordering-reducing-tlb-misses", "title": "Subroutine reordering, reducing TLB misses", "body": "<p>Let's say I have an algorithm which would optimize subroutine ordering, in hopes to reduce TLB misses.</p>\n\n<p>How would one be able actually to reorder subroutines at run-time in gcc compiler? So far I presume that it would be possible to write a gcc plugin for this. How ever I have no idea how to actually write them let alone that it is possible at all.</p>\n"}, {"tags": ["c", "posix"], "comments": [{"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 1, "creation_date": 1527101217, "post_id": 50495355, "comment_id": 88003605, "body": "yeah, use a RAM-drive path. related: <a href=\"https://stackoverflow.com/questions/36706602/how-to-mount-a-drive-in-ram-in-java\" title=\"how to mount a drive in ram in java\">stackoverflow.com/questions/36706602/&hellip;</a>"}, {"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 3, "creation_date": 1527101483, "post_id": 50495355, "comment_id": 88003754, "body": "On which OS????"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1527101657, "post_id": 50495355, "comment_id": 88003865, "body": "solutions exist on both Linux &amp; Windows to create a RAM disk, and pass the path of a file from this RAM disk. It doesn&#39;t write to disk. Note that if the file is small, wrting to the temporary directory doesn&#39;t write to disk at all if re-read immediately &amp; deleted."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 3, "creation_date": 1527101744, "post_id": 50495355, "comment_id": 88003906, "body": "this third party library has a broken design. Allowing to write to a <code>FILE *</code> object would have given you more options."}, {"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1527101774, "post_id": 50495355, "comment_id": 88003917, "body": "@Jean-Fran&#231;oisFabre true, but on Debian and derivates you can easily read/write to /dev/shm"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1527101920, "post_id": 50495355, "comment_id": 88003986, "body": "then it&#39;s the solution for those OSes. Amiga OS has a <code>RAM:</code> device as well (since 1985). It&#39;s just this crap windows that needs some fiddling to get a ram drive."}, {"owner": {"reputation": 1351, "user_id": 328316, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/8face8afbe4e34480ae1c65a232c46ca?s=128&d=identicon&r=PG", "display_name": "Ben L", "link": "https://stackoverflow.com/users/328316/ben-l"}, "edited": false, "score": 0, "creation_date": 1527102005, "post_id": 50495355, "comment_id": 88004031, "body": "This is for windows and linux. I don&#39;t want to resort to RAM drives. And the files are quite large."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1527102086, "post_id": 50495355, "comment_id": 88004070, "body": "<code>&#47;dev&#47;shm</code> probably stands for &quot;shared memory&quot;. So it looks like it&#39;s a good option for Linux at least. if you don&#39;t want RAM drives, then you need to can this broken library, or reverse engineer/hack it to be able to pass a <code>FILE *</code> (since the first thing that it probably does is to convert the string to <code>FILE *</code>"}, {"owner": {"reputation": 1351, "user_id": 328316, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/8face8afbe4e34480ae1c65a232c46ca?s=128&d=identicon&r=PG", "display_name": "Ben L", "link": "https://stackoverflow.com/users/328316/ben-l"}, "edited": false, "score": 0, "creation_date": 1527102131, "post_id": 50495355, "comment_id": 88004089, "body": "Hopefully, the library owner will respond to my request. But in the meantime I appreciate any help. Even knowing something is not possible is useful information."}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 0, "creation_date": 1527107419, "post_id": 50495355, "comment_id": 88006755, "body": "Have you tried to interpose the <code>writeFoo()</code> function with your own? If it is a dynamic library (<code>.so</code>), it should be simple. If it is a static library, consider writing your own writeFoo(), and replacing it in the library. You don&#39;t need sources for that, except for your own replacement, and for defining the <code>FOO_DATA</code> type."}, {"owner": {"reputation": 1351, "user_id": 328316, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/8face8afbe4e34480ae1c65a232c46ca?s=128&d=identicon&r=PG", "display_name": "Ben L", "link": "https://stackoverflow.com/users/328316/ben-l"}, "reply_to_user": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 0, "creation_date": 1527261031, "post_id": 50495355, "comment_id": 88076382, "body": "@NominalAnimal I am the caller of the function, not the callee. If I could write the function myself, I wouldn&#39;t be asking the question at all."}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 0, "creation_date": 1527268581, "post_id": 50495355, "comment_id": 88080050, "body": "@BenL: Ah, now I understand: the function <i>manipulates</i>, then writes the data to the file, but you&#39;d prefer to obtain the manipulated data without having to reread it from the file. So: Run <code>strace</code> on the binary, to see which syscalls the function actually uses to write to the file. These are almost certainly <code>open()</code>, <code>write()</code>, and <code>close()</code>. You can interpose them, replacing the write part with a copy to memory. Do you want an outline as to exactly how to do this?"}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 0, "creation_date": 1527269061, "post_id": 50495355, "comment_id": 88080260, "body": "@BenL: Do feel free to roll-back or re-edit the question. However, I did find that information (that was only implied in the function name!) crucial to a proper answer to this question, so some kind of edit that emphasizes that, is needed in my opinion."}], "answers": [{"comments": [{"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1527101299, "post_id": 50495401, "comment_id": 88003652, "body": "this link doesn&#39;t help as it&#39;s unrelated."}, {"owner": {"reputation": 35, "user_id": 9765374, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-BSYq3pxD2Dc/AAAAAAAAAAI/AAAAAAAABTE/pZxgh-dCmd4/photo.jpg?sz=128", "display_name": "Gabriel Tapizquent", "link": "https://stackoverflow.com/users/9765374/gabriel-tapizquent"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1527101422, "post_id": 50495401, "comment_id": 88003717, "body": "He asked for options, and the question is tagged with c and POSIX. How is the link unrelated?"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 3, "creation_date": 1527101449, "post_id": 50495401, "comment_id": 88003733, "body": "because OP doesn&#39;t have a <code>FILE</code> object in the interface to begin with"}, {"owner": {"reputation": 35, "user_id": 9765374, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-BSYq3pxD2Dc/AAAAAAAAAAI/AAAAAAAABTE/pZxgh-dCmd4/photo.jpg?sz=128", "display_name": "Gabriel Tapizquent", "link": "https://stackoverflow.com/users/9765374/gabriel-tapizquent"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1527101530, "post_id": 50495401, "comment_id": 88003776, "body": "Hence this is presented as an option. An alternative to using his library function."}, {"owner": {"reputation": 1351, "user_id": 328316, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/8face8afbe4e34480ae1c65a232c46ca?s=128&d=identicon&r=PG", "display_name": "Ben L", "link": "https://stackoverflow.com/users/328316/ben-l"}, "edited": false, "score": 0, "creation_date": 1527101884, "post_id": 50495401, "comment_id": 88003963, "body": "It&#39;s not my library function. The issue is I need to capture the other data manipulations this function is performing without the penalty of hitting the disks."}, {"owner": {"reputation": 35, "user_id": 9765374, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-BSYq3pxD2Dc/AAAAAAAAAAI/AAAAAAAABTE/pZxgh-dCmd4/photo.jpg?sz=128", "display_name": "Gabriel Tapizquent", "link": "https://stackoverflow.com/users/9765374/gabriel-tapizquent"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1527102011, "post_id": 50495401, "comment_id": 88004034, "body": "Interesting. As @Jean-Fran&#231;oisFabre mentioned, this third-party library has a broken design. His suggestions might be helpful though."}], "tags": [], "owner": {"reputation": 35, "user_id": 9765374, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-BSYq3pxD2Dc/AAAAAAAAAAI/AAAAAAAABTE/pZxgh-dCmd4/photo.jpg?sz=128", "display_name": "Gabriel Tapizquent", "link": "https://stackoverflow.com/users/9765374/gabriel-tapizquent"}, "is_accepted": false, "score": -3, "last_activity_date": 1527101100, "creation_date": 1527101100, "answer_id": 50495401, "question_id": 50495355, "link": "https://stackoverflow.com/questions/50495355/can-i-adapt-a-function-that-writes-to-disk-to-write-to-memory/50495401#50495401", "title": "Can I adapt a function that writes to disk to write to memory", "body": "<p>You could not use that library function. Take a look at this on how to write to in-memory files:\n<a href=\"https://stackoverflow.com/questions/16815785/is-it-possible-to-create-a-c-file-object-to-read-write-in-memory\">Is it possible to create a C FILE object to read/write in memory</a></p>\n"}, {"tags": [], "owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "is_accepted": false, "score": 1, "last_activity_date": 1527271002, "creation_date": 1527271002, "answer_id": 50534592, "question_id": 50495355, "link": "https://stackoverflow.com/questions/50495355/can-i-adapt-a-function-that-writes-to-disk-to-write-to-memory/50534592#50534592", "title": "Can I adapt a function that writes to disk to write to memory", "body": "<p>Yes, you have several options, although only the first suggestion below is supported by POSIX. The rest of them are OS-specific, and may not be portable across all POSIX systems, although I do believe they work on all POSIXy systems.<br>&nbsp;</p>\n\n<ul>\n<li><p>You can use a named pipe (FIFO), and have a helper thread read from it concurrently to the writer function.</p>\n\n<p>Because there is no file per se, the overhead is just the syscalls (write and read); basically just the overhead of interprocess communication, nothing to worry about.  To conserve resources, do create the helper thread with a small stack (using <code>pthread_attr_</code> etc.), as the default stack size tends to be huge (on the order of several megabytes; <code>2*PTHREAD_STACK_SIZE</code> should be plenty for helper threads.)</p>\n\n<p>You should ensure the named pipe is in a safe directory, accessible only to the user running the process, for example.<br>&nbsp; </p></li>\n<li><p>In many POSIXy systems, you can create a pipe or a socket pair, and access it via <code>/dev/fd/N</code>, where <code>N</code> is the descriptor number in decimal. (In Linux, <code>/proc/self/fd/N</code> also works.) This is not mandated by POSIX, so may not be available on all systems, but most do support it.</p>\n\n<p>This way, there is no actual file per se, and the function writes to the pipe or socket.  If the data written by the function is at most <code>PIPE_BUF</code> bytes, you can simply read the data from the pipe afterwards; otherwise, you do need to create a helper thread to read from the pipe or socket concurrently to the function, or the write will block.</p>\n\n<p>In this case, too, the overhead is minimal.<br>&nbsp;</p></li>\n<li><p>On ELF-based POSIXy systems (basically all), you can <em>interpose</em> the <code>open()</code>, <code>write()</code>, and <code>close()</code> syscalls or C library functions.</p>\n\n<p>(In Linux, there are two basic approaches, one using the linker <code>--wrap</code>, and one using <code>dlsym()</code>. Both work fine for this particular case.  This ability to interpose functions is based on how ELF binaries are linked at run time, and is not directly related to POSIX.)</p>\n\n<p>You first set up the interposing functions, so that <code>open()</code> detects if the filename matches your special \"in-memory\" file, and returns a dedicated descriptor number for it. (You may also need to interpose other functions, like <code>ftruncate()</code> or <code>lseek()</code>, depending on what the function actually does; in Linux, you can run a binary under <code>ptrace</code> to examine what syscalls it actually uses.)</p>\n\n<p>When <code>write()</code> is called with the dedicated descriptor number, you simply <code>memcpy()</code> it to a memory buffer. You'll need to use global variables to describe the allocated size, size used, and the pointer to the memory buffer, and probably be prepared to resize/grow the buffer if necessary.</p>\n\n<p>When <code>close()</code> is called with the dedicated descriptor number, you know the memory buffer is complete, and the contents ready for processing.\n<br>&nbsp;</p></li>\n<li><p>You can use a temporary file on a RAM filesystem. While the data is technically written to a file and read back from it, the operations involve RAM only.</p>\n\n<p>You should arrange for a default path to one to be set at compile time, and for individual users to be able to override that for their personal needs, for example via an environment variable (<code>YOURAPP_TMPDIR</code>?).</p>\n\n<p>There is no need for the application to try and look for a RAM-based filesystem: choices like this are, and should be, up to the user. The application should not even care what kind of filesystem the file is on, and should just use the specified directory. </p></li>\n</ul>\n"}], "owner": {"reputation": 1351, "user_id": 328316, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/8face8afbe4e34480ae1c65a232c46ca?s=128&d=identicon&r=PG", "display_name": "Ben L", "link": "https://stackoverflow.com/users/328316/ben-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1527271002, "creation_date": 1527100923, "last_edit_date": 1527268996, "question_id": 50495355, "link": "https://stackoverflow.com/questions/50495355/can-i-adapt-a-function-that-writes-to-disk-to-write-to-memory", "title": "Can I adapt a function that writes to disk to write to memory", "body": "<p>I have third-party library with a function that does some computation on the specified data, and writes the results to a file specified by file name:</p>\n\n<pre><code>int manipulateAndWrite(const char *filename,\n                       const FOO_DATA *data);\n</code></pre>\n\n<p>I <strong>cannot</strong> change this function, or reimplement the computation in my own function, because I do not have the source.</p>\n\n<p>To get the results, I currently need to read them from the file. I would prefer to avoid the write to and read from the file, and obtain the results into a memory buffer instead.</p>\n\n<p>Can I pass a filepath that indicates <em>writing to memory</em> instead of a \nfilesystem?</p>\n"}, {"tags": ["c++", "c", "assembly"], "comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1527101995, "post_id": 50495208, "comment_id": 88004029, "body": "<i>you can return results from assembly by moving the value into the eax register</i>.  That might appear to work, but only works by accident.  You can&#39;t use GNU C inline asm safely unless you use input and output operands to tell the compiler what you&#39;re doing.  It will break when the compiler inlines your function into a caller.  See <a href=\"https://stackoverflow.com/questions/34520013/using-base-pointer-register-in-c-inline-asm\">this answer</a> for some more links about inline asm, and the kind of trouble you can get into from using it wrong."}], "answers": [{"comments": [{"owner": {"reputation": 780, "user_id": 3741284, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/38b1ab011312cb05bbd578dfc03f2587?s=128&d=identicon&r=PG&f=1", "display_name": "CRoemheld", "link": "https://stackoverflow.com/users/3741284/croemheld"}, "edited": false, "score": 0, "creation_date": 1527111715, "post_id": 50496319, "comment_id": 88008633, "body": "This sounds reasonable. Also, writing more in a high level language should also circumvent the problem regarding assembly, since the compiler translates a program/file to the architecture the compiler is targeting. So only some (few) parts of the OS should be written in assembly, if there is no C-equivalent code or if you need to manipulate some specific register for the OS?"}, {"owner": {"reputation": 6093, "user_id": 2189500, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/109f747845a9ce762a1fff72eb8cf6f3?s=128&d=identicon&r=PG", "display_name": "David Wohlferd", "link": "https://stackoverflow.com/users/2189500/david-wohlferd"}, "edited": false, "score": 0, "creation_date": 1527129977, "post_id": 50496319, "comment_id": 88013002, "body": "Inline asm can be... well, inlined, whereas a call to an asm routine must always incur the cost of the call/ret, so there&#39;s that.  But mostly I&#39;m of the opinion that <a href=\"https://gcc.gnu.org/wiki/DontUseInlineAsm\" rel=\"nofollow noreferrer\">you should not use inline asm</a>."}], "tags": [], "owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "is_accepted": false, "score": 1, "last_activity_date": 1527104604, "creation_date": 1527104604, "answer_id": 50496319, "question_id": 50495208, "link": "https://stackoverflow.com/questions/50495208/inline-assembly-or-separate-assembly-files/50496319#50496319", "title": "Inline assembly or separate assembly files", "body": "<h2>Interface, Procotol &amp; Conventions</h2>\n\n<p>In a pure assembly language project, you need to set up protocols or conventions for passing values and returning values.  </p>\n\n<p>When mixing assembly language functions with C or C++, you will need to follow the parameter passing conventions of C or C++ as dictated by the compiler you are using.  </p>\n\n<p>Some compilers may use a convention of passing the first parameter in R0, while others may pass the last parameter in R0.  Some compilers may place the variables on the stack and not use registers.  Others may use registers for a few parameters and the remaining on the stack.  </p>\n\n<h2>Inline vs Separate Assembly functions</h2>\n\n<p>One issue is portability.  Assembly language is processor specific.  For example, ARM assembly doesn't have an EAX register.  Intel assembly doesn't have R10 register.  When using inline assembly, the assembly must change depending on the processor, which includes modifying the high level language function to account for all target processors.  When implementing as a separate assembly function (file), only the file needs to be swapped out when porting to other processors.  </p>\n\n<p>IMHO, pure assembly functions are easier to read than intermixed C and inline assembly.</p>\n\n<h2>Guidelines for High Level Language Usage in OS</h2>\n\n<p>The quantity of assembly language should be minimized.  Assembly language takes longer to develop (typing, and debugging, more lines == high possible injected defects), whereas the high level language is more productive with lower risks.  </p>\n\n<p>Prefer to write the entire OS in a high level language.  Get this version working robustly.  Replace C functions with assembly functions for more efficiency, or when specific assembly language instructions are required.</p>\n"}], "owner": {"reputation": 780, "user_id": 3741284, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/38b1ab011312cb05bbd578dfc03f2587?s=128&d=identicon&r=PG&f=1", "display_name": "CRoemheld", "link": "https://stackoverflow.com/users/3741284/croemheld"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 477, "favorite_count": 0, "closed_date": 1527111565, "answer_count": 1, "score": -1, "last_activity_date": 1527104604, "creation_date": 1527100419, "question_id": 50495208, "link": "https://stackoverflow.com/questions/50495208/inline-assembly-or-separate-assembly-files", "closed_reason": "Opinion-based", "title": "Inline assembly or separate assembly files", "body": "<p>I'm currently trying to get into OS development, mostly following the articles and tutorials from <a href=\"https://wiki.osdev.org/\" rel=\"nofollow noreferrer\">OSDev</a>. As os now, I have multiple assembly files I need to e.g. enable paging and setting up long mode. </p>\n\n<p>While the only assembler code I'm certain about needs to be separated in an own file is the boot assembly file, I'm curious about the practices and \"standards\" how to deal with assembly in an OS written in C. Is it convenient to separate assembler from C or is there a reason why e.g. Linux wraps most of the assembly code inside C functions and calls them using the <code>asm volatile</code> directives? </p>\n\n<p>I don't see much difference, as you can return results from assembly by moving the value into the <code>eax</code> register, or when using <code>asm</code> and <code>asm volatile</code>, you can specify parameters and output operands where to store the result. However, you always need to separate multiple instructions by using <code>\\n</code> or <code>\\n\\t</code>.</p>\n\n<p>As of now, I only found out about the different ways of dealing with assembly in a larger project, but not why some chose to separate assembly code from C or C++, and why some chose to use inline assembly thorough the whole program.</p>\n\n<p>I hope you could give me some insights about the different ways used regarding this topic.</p>\n"}, {"tags": ["c", "utility-method"], "comments": [{"owner": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 1, "creation_date": 1527101389, "post_id": 50495186, "comment_id": 88003698, "body": "it is important to understand that <code>count &amp; 3</code> is a test to see if the variable <code>count</code> is divisible by 4.  Similarly, <code>count &amp; 7</code> would test to see if it is divisible by 8, and so on."}, {"owner": {"reputation": 69, "user_id": 3423386, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/100001709490508/picture?type=large", "display_name": "Simeon Laplev", "link": "https://stackoverflow.com/users/3423386/simeon-laplev"}, "reply_to_user": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 1, "creation_date": 1527101532, "post_id": 50495186, "comment_id": 88003777, "body": "Yes, I understand now. Thank you for the feedback either way! I will keep this in mind from now on."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 1, "creation_date": 1527101535, "post_id": 50495186, "comment_id": 88003780, "body": "@bruceg And even more important to understand that it will only work to test divisibility with powers of 2..."}, {"owner": {"reputation": 69, "user_id": 3423386, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/100001709490508/picture?type=large", "display_name": "Simeon Laplev", "link": "https://stackoverflow.com/users/3423386/simeon-laplev"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1527101690, "post_id": 50495186, "comment_id": 88003884, "body": "Yes, I understood that @EugeneSh. The bitwise OR operations were confusing me a bit as well, but I got it! Thanks a bunch!"}, {"owner": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1527102729, "post_id": 50495186, "comment_id": 88004383, "body": "@EugeneSh. yes... <code>count &amp; 12</code> doesn&#39;t do a very good job of checking divisibility by 13."}], "answers": [{"comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1527100822, "post_id": 50495223, "comment_id": 88003399, "body": "Well, to &quot;optimize&quot; here we can combine the two methods. Copy the 4-byte aligned portion as <code>int</code>s, and the &quot;corners&quot; as bytes. Update: Actually no... If source and destination are mutually misalligned - we can&#39;t."}, {"owner": {"reputation": 69, "user_id": 3423386, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/100001709490508/picture?type=large", "display_name": "Simeon Laplev", "link": "https://stackoverflow.com/users/3423386/simeon-laplev"}, "edited": false, "score": 0, "creation_date": 1527101128, "post_id": 50495223, "comment_id": 88003562, "body": "I am ready to accept this as an answer. Awesome explanation! The last sentence really made me go: &quot;OOOHHH, I see!&quot;. Just one more question. Isn&#39;t the third line of your code supposed to be: count = count / 4"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "reply_to_user": {"reputation": 69, "user_id": 3423386, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/100001709490508/picture?type=large", "display_name": "Simeon Laplev", "link": "https://stackoverflow.com/users/3423386/simeon-laplev"}, "edited": false, "score": 1, "creation_date": 1527101157, "post_id": 50495223, "comment_id": 88003572, "body": "@SimeonLaplev yes, fixed"}], "tags": [], "owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "is_accepted": true, "score": 1, "last_activity_date": 1527101148, "last_edit_date": 1527101148, "creation_date": 1527100477, "answer_id": 50495223, "question_id": 50495186, "link": "https://stackoverflow.com/questions/50495186/dont-fully-understand-custom-written-memcpy-function-in-c/50495223#50495223", "title": "Don&#39;t fully understand custom-written &#39;memcpy&#39; function in C", "body": "<p>It first tests if <strong>all 3 arguments</strong> are divisible by 4. If - and only if - they all are, it proceeds with copying 4 bytes at a time.</p>\n\n<p>I.e. this undecoded would be</p>\n\n<pre><code>if ((long) src % 4 == 0 &amp;&amp; (long) dst % 4 == 0 &amp;&amp; count % 4 == 0 )\n{\n    count = count / 4;\n    for (i = 0; i &lt; count; i++)\n        ((int *)dest)[i] = ((int *)src)[i];\n}\n</code></pre>\n\n<p>I am not sure if they tested their compiler and it generated bad code for even a test, and therefore they decided to write it in such a convoluted way. In any case, the <code>x |\u00a0y | z</code> will guarantee that a bit <em>n</em> is set in the result if it is set in any of <code>x</code>, <code>y</code> or <code>z</code>. Therefore if the <code>(x\u00a0| y | z) &amp; 3</code> results in 0, none of the numbers had either of the 2 lowest bits set, and therefore are divisible by 4.</p>\n\n<hr>\n\n<p>Of course it would be rather silly to use <em>now</em> - the standard library <code>memcpy</code> in recent library implementations is almost certainly better than this.</p>\n\n<p>Therefore, on recent compilers you can <strong>optimize</strong> all calls to <code>Q_memcpy</code> by switching them to <code>memcpy</code>. GCC could generate things like 64-bit or SIMD moves with <code>memcpy</code> depending on the size of area to be copied.</p>\n"}, {"tags": [], "owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "is_accepted": false, "score": 2, "last_activity_date": 1527100491, "creation_date": 1527100491, "answer_id": 50495227, "question_id": 50495186, "link": "https://stackoverflow.com/questions/50495186/dont-fully-understand-custom-written-memcpy-function-in-c/50495227#50495227", "title": "Don&#39;t fully understand custom-written &#39;memcpy&#39; function in C", "body": "<p>The bitwise ORing and ANding with 3 is to check whether the source, destination and <code>count</code> are divisible by 4. If they are, the operation can work with 4-byte words, while this code is assuming <code>int</code> as 4 bytes. Otherwise the operation is performed bytewise. </p>\n"}, {"tags": [], "owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "is_accepted": false, "score": 3, "last_activity_date": 1527102022, "last_edit_date": 1527102022, "creation_date": 1527100542, "answer_id": 50495243, "question_id": 50495186, "link": "https://stackoverflow.com/questions/50495186/dont-fully-understand-custom-written-memcpy-function-in-c/50495243#50495243", "title": "Don&#39;t fully understand custom-written &#39;memcpy&#39; function in C", "body": "<p>It is finding out whether the source and destination pointers are <code>int</code> aligned, and whether the <code>count</code> is an exact <code>int</code> size of bytes. </p>\n\n<p>If those three things are all true, the l.s. 2 bits of them all will be <code>0</code> (assuming pointers and <code>int</code> are 4 bytes). So the algorithm ORs the three values, and isolates the l.s. 2 bits.</p>\n\n<p>In this case, it copies <code>int</code> by <code>int</code>. Otherwise it copies <code>char</code> by <code>char</code>.</p>\n\n<p>If the test fails, a more sophisticated algorithm would copy some of the leading and trailing bytes <code>char</code> by <code>char</code> and the intermediate bytes <code>int</code> by <code>int</code>.</p>\n"}], "owner": {"reputation": 69, "user_id": 3423386, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/100001709490508/picture?type=large", "display_name": "Simeon Laplev", "link": "https://stackoverflow.com/users/3423386/simeon-laplev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "accepted_answer_id": 50495223, "answer_count": 3, "score": 2, "last_activity_date": 1527102022, "creation_date": 1527100310, "question_id": 50495186, "link": "https://stackoverflow.com/questions/50495186/dont-fully-understand-custom-written-memcpy-function-in-c", "title": "Don&#39;t fully understand custom-written &#39;memcpy&#39; function in C", "body": "<p>So I was browsing the Quake engine source code earlier today and stumbled upon some written utility functions. One of them was 'Q_memcpy':</p>\n\n<pre><code>void Q_memcpy (void *dest, void *src, int count)\n{\n    int             i;\n\n    if (( ( (long)dest | (long)src | count) &amp; 3) == 0 )\n    {\n        count&gt;&gt;=2;\n        for (i=0 ; i&lt;count ; i++)\n            ((int *)dest)[i] = ((int *)src)[i];\n    }\n    else\n        for (i=0 ; i&lt;count ; i++)\n            ((byte *)dest)[i] = ((byte *)src)[i];\n}\n</code></pre>\n\n<p>I understand the whole premise of the function but I don't quite understand the reason for the bitwise OR between the source and destination address. So the sum of my questions are as follows:</p>\n\n<ul>\n<li>Why does 'count' get used in the same bitwise arithmetic?</li>\n<li>Why is that result's last two bits checked if they are differing?</li>\n<li>What purpose does this whole check serve?</li>\n</ul>\n\n<p>I'm sure it's something obvious but please excuse my ignorance because I haven't really delved into the more low level side of things when it comes to programming. I just find it interesting and want to learn more. </p>\n"}, {"tags": ["c", "linux", "assembly", "makefile"], "comments": [{"owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 6, "creation_date": 1527099233, "post_id": 50494850, "comment_id": 88002574, "body": "You need to add the <code>-lncurses</code> to the linking command (the first rule) not the compiling."}], "answers": [{"tags": [], "owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "is_accepted": true, "score": 2, "last_activity_date": 1527109724, "last_edit_date": 1527109724, "creation_date": 1527109251, "answer_id": 50497390, "question_id": 50494850, "link": "https://stackoverflow.com/questions/50494850/makefile-c-as-with-ncurses/50497390#50497390", "title": "Makefile .c + .as with ncurses", "body": "<p>Here's a better Makefile skeleton for you:\n</p>\n\n<pre><code>PKGS    := ncursesw\nCC      := gcc\nCFLAGS  := -Wall -m32 -O2 -std=c99 $(shell pkg-config --cflags $(PKGS))\nLDFLAGS := $(shell pkg-config --libs $(PKGS))\nAS      := as\nASFLAGS := -gdbb --32\nPROGS   := test-reservation\n\n.PHONY: all clean\n\nall: $(PROGS)\n\nclean:\n    $(RM) *.o $(PROGS)\n\n%.o: %.c\n    $(CC) $(CFLAGS) -c $^ -o $@\n\n%.o: %.s\n    $(AS) $(ASFLAGS) $^ -o $@\n\ntest-reservation: reservation.o service.o\n    $(CC) $(CFLAGS) $(LDFLAGS) $^ -o $@\n</code></pre>\n\n<p>If you copy-paste the above, remember to run <code>sed -e 's|^  *|\\t|' -i Makefile</code> to fix the indentation.</p>\n\n<p>Most Linux distributions use <code>pkg-config</code> to keep track of the options needed to compile a specific library. You just need to add the packages you need to the <code>PKGS</code> variable, separated by spaces. <code>ncursesw</code> is the version of ncurses that supports wide characters (you'll want Unicode character output). The <code>$(shell pkg-config ... $(PKGS))</code> idiom uses the <code>pkg-config</code> shell command to pull in the correct flags (<code>--cflags</code>) and library files (<code>--libs</code>).</p>\n\n<p>If you use <code>&lt;math.h&gt;</code>, you'll want to prepend <code>-lm</code> to <code>LDFLAGS</code>; i.e., <code>LDFLAGS := -lm $(shell pkg-config --libs $(PKGS))</code>.</p>\n\n<p>If you compile several binaries in that directory, just add the final binary name to <code>PROGS</code>, and add the new rule, e.g.</p>\n\n<pre><code>foo-bin: foo.o bar.o baz.o\n    $(CC) $(CFLAGS) $(LDFLAGS) $^ -o $@\n</code></pre>\n\n<p>the rule action does not change, only the target and the prerequisites change.</p>\n\n<p>With the <code>all: $(PROGS)</code> rule, you only need to run <code>make</code> to compile all binaries named in <code>PROGS</code>. If you modify say <code>service.c</code>, then both <code>service.o</code> and <code>test-reservation</code> will be recompiled. Run <code>make clean all</code> to remove any compiled files, then recompile them all.</p>\n"}], "owner": {"reputation": 41, "user_id": 9836317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d6725c0a7874db2701788819a5880ae?s=128&d=identicon&r=PG&f=1", "display_name": "Ensomme", "link": "https://stackoverflow.com/users/9836317/ensomme"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 539, "favorite_count": 1, "closed_date": 1527148199, "accepted_answer_id": 50497390, "answer_count": 1, "score": 2, "last_activity_date": 1527109724, "creation_date": 1527099074, "question_id": 50494850, "link": "https://stackoverflow.com/questions/50494850/makefile-c-as-with-ncurses", "closed_reason": "Not suitable for this site", "title": "Makefile .c + .as with ncurses", "body": "<p>I have some problems with compiling my program to use ncurses. Im new in creating makefiles so:</p>\n\n<p>Here's my makefile:</p>\n\n<pre><code>test_reservation: reservation.o service.o\n    gcc -g -m32 service.o reservation.o -o test_reservation \nservice.o: service.c\n    gcc -g -m32 -c -o service.o service.c -std=c99 -lncurses\nreservation.o: reservation.s\n    as -gdbb --32 -o reservation.o reservation.s\n</code></pre>\n\n<p>I've already installed and included  in my c file</p>\n\n<p>When I'm trying to make it:</p>\n\n<pre><code>gcc -g -m32 service.o reservation.o -o test_reseration\nservice.o: In function `main':\n/home/xxx/reservationService/service.c:23: undefined reference to `initscr'\ncollect2: error: ld returned 1 exit status\nmakefile:2: recipe for target 'test_reservation' failed\nmake: *** [test_reservation] Error 1\n</code></pre>\n\n<p>What's wrong with this makefile? How should I compile it?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1527099132, "post_id": 50494792, "comment_id": 88002524, "body": "Here is the description of all of the standard time manipulation functions <a href=\"http://port70.net/~nsz/c/c11/n1570.html#7.27.2\" rel=\"nofollow noreferrer\">port70.net/~nsz/c/c11/n1570.html#7.27.2</a>"}, {"owner": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 0, "creation_date": 1527101237, "post_id": 50494792, "comment_id": 88003620, "body": "if you use the <code>mktime</code> system function, it will automatically adjust the values of the <code>struct tm</code> value that you pass it, even if they are outside of the normal range."}], "answers": [{"comments": [{"owner": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 1, "creation_date": 1527100365, "post_id": 50494864, "comment_id": 88003144, "body": "Note that it is possible that even though a <code>time_t</code> value is usually represented as a number of seconds, this is not guaranteed by C.  Adding seconds to a time_t value is not portable, so it is better to use the standard library functions to manipulate the returned value.  See this answer for details: <a href=\"https://stackoverflow.com/a/1860996/1212725\">stackoverflow.com/a/1860996/1212725</a>"}], "tags": [], "owner": {"reputation": 149903, "user_id": 14637, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1904e7096278a10f1dfb3fdc0ceb53cc?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/14637/thomas"}, "is_accepted": true, "score": 4, "last_activity_date": 1527099134, "creation_date": 1527099134, "answer_id": 50494864, "question_id": 50494792, "link": "https://stackoverflow.com/questions/50494792/how-to-get-date-with-future-time-in-c/50494864#50494864", "title": "How to get Date with future time in C", "body": "<p>Even if you manage to work around issues with midnight, there's also daylight savings time to take into account, and wrapping months, meaning you have to take leap years into account as well... don't go there.</p>\n\n<p>Instead, it's much easier to just add 2 hours (2 * 60 * 60 seconds) to the time <em>before</em> you convert it to <code>time_t</code>:</p>\n\n<pre><code>    t = time(NULL) + 2 * 60 * 60;\n    date = localtime(&amp;t);\n</code></pre>\n\n<p>This is much more reliable, because a <code>time_t</code> is just the number of seconds since some well-defined epoch.</p>\n"}], "owner": {"reputation": 71, "user_id": 2792958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/474355d754b56d0089d92e440a480989?s=128&d=identicon&r=PG&f=1", "display_name": "Jaime T", "link": "https://stackoverflow.com/users/2792958/jaime-t"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 280, "favorite_count": 0, "accepted_answer_id": 50494864, "answer_count": 1, "score": 1, "last_activity_date": 1527099134, "creation_date": 1527098793, "question_id": 50494792, "link": "https://stackoverflow.com/questions/50494792/how-to-get-date-with-future-time-in-c", "title": "How to get Date with future time in C", "body": "<p>I want to get date with time that is 2 hours ahead.\nCurrently I am trying this: where I add 2 to the hours value</p>\n\n<pre><code>void printTodayFutureTime()\n{\n        char finalDate[50];\n        time_t t;\n        struct tm *date;\n\n        memset(finalDate, '\\0', 50);\n\n        t = time(NULL);\n        date = localtime(&amp;t);\n        if(date == NULL)\n        {\n                printf(\"Unable to get localtime\\n\\n\");\n                return;\n        }\n\n        int today = date-&gt;tm_mday;\n        int month = date-&gt;tm_mon + 1;\n        int year = date-&gt;tm_year + 1900;\n        int hour = date-&gt;tm_hour;\n        int minute = date-&gt;tm_min;\n        int sec = date-&gt;tm_sec;\n\n        snprintf(finalDate, 50, \"%d-%d-%dT%d:%d:%d\", year, month, today, hour + 2, minute, sec);\n\n        printf(\"Today's date with future time is: %s\\n\\n\", finalDate);\n}\n</code></pre>\n\n<p>But this will not work if the hour is lets say 22, 23 because it will jump to hour 24 and 25... \nCan anyone please give me some advice or help.</p>\n"}, {"tags": ["c", "string", "pointers", "memory-management"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 4, "creation_date": 1527098867, "post_id": 50494783, "comment_id": 88002413, "body": "<i>Calloc statement above does same thing which is done by two malloc statements in below program</i> - no it does not. <code>calloc</code> is not magic, it is the same as <code>malloc</code>, but initializing the memory to all zeros."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 2, "creation_date": 1527099179, "post_id": 50494783, "comment_id": 88002549, "body": "Your first <code>malloc()</code> allocates only two bytes -- not enough even for one <code>char *</code>.  If the program works as you wanted anyway then that&#39;s a factor of luck, not correctness."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1527099197, "post_id": 50494783, "comment_id": 88002559, "body": "I notice you are using <code>sizeof(char)</code> while expecting to assign to a <code>char **</code>"}], "answers": [{"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 2, "last_activity_date": 1527099806, "creation_date": 1527099806, "answer_id": 50495052, "question_id": 50494783, "link": "https://stackoverflow.com/questions/50494783/why-does-malloc-works-but-calloc-doesnt-when-we-try-to-use-it-for-multiple-stri/50495052#50495052", "title": "Why does malloc works but calloc doesn&#39;t when we try to use it for multiple strings in C programming?", "body": "<blockquote>\n  <p>Calloc statement above does same thing which is done by two malloc statements in below program.</p>\n</blockquote>\n\n<p>No, it will not.  Setting aside the fact that your first <code>malloc()</code> does not allocate enough space even for one pointer, much less two, you seem to be confused about the difference between arrays and pointers.</p>\n\n<blockquote>\n  <p>Calloc function will simply initialize two arrays of each size 20Bytes. But still I don't understand why this doesn't work.</p>\n</blockquote>\n\n<p>That's indeed a reasonable way to describe the effect of that <code>calloc()</code> call (when it succeeds).  A more complete description might be that it allocates and zeroes space for <em>an array</em> of two arrays of 20 <code>char</code>s.  But that is <em>not</em> the same thing you do with your three <code>malloc()</code> calls in the example code.</p>\n\n<p>You go wrong when you assign the result of your <code>calloc()</code> to a pointer variable of a type that doesn't match.  <code>char **</code> is a pointer to a <code>char *</code>.  The pointed-to pointer might in some cases be an element of an array of such pointers.  But arrays are not at all the same thing as pointers, and thus arrays of arrays are not the same thing as arrays of pointers.</p>\n\n<p>Quite possibly you want this, instead:</p>\n\n<pre><code>char (*ptr)[20] = calloc(2 * sizeof(char) * 20);\n</code></pre>\n\n<p>or, better, this:</p>\n\n<pre><code>char (*ptr)[20] = calloc(2 * sizeof(*ptr));\n</code></pre>\n\n<p>In either case, <code>ptr</code> is declared as a pointer to an array of 20 <code>char</code>, and sufficient space is reserved for the pointed-to array to be the first element of an array of two such.  You can use the resulting pointer in all the ways you demonstrate doing in your question, except that you must <code>free()</code> only the one pointer -- there aren't any others.</p>\n"}], "owner": {"reputation": 49, "user_id": 7001540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1079cc32bec5b499499611fb98a2957?s=128&d=identicon&r=PG&f=1", "display_name": "Karna", "link": "https://stackoverflow.com/users/7001540/karna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 234, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1527099806, "creation_date": 1527098754, "question_id": 50494783, "link": "https://stackoverflow.com/questions/50494783/why-does-malloc-works-but-calloc-doesnt-when-we-try-to-use-it-for-multiple-stri", "title": "Why does malloc works but calloc doesn&#39;t when we try to use it for multiple strings in C programming?", "body": "<p>In below code I am trying to use double pointer to access multiple strings as well as each character in every string. This below code is working perfectly as expected. But I wonder why it doesn't work when I remove the malloc statements which are used two times and instead use only one single calloc statement as </p>\n\n<pre><code>ptr = (char **)calloc(2, sizeof(char)*20);\n</code></pre>\n\n<p>Calloc statement above does same thing which is done by two malloc statements in below program. Calloc function will simply initialize two arrays of each size 20Bytes. But still I don't understand why this doesn't work.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main(){\n\nint i=0;\nchar **ptr=NULL;\n\nptr =(char **) malloc(2*sizeof(char));\nif(ptr==NULL){\n    printf(\"Memory not allocated!\\n\");\n    return -1;\n}\n\nfor(i=0; i&lt;2;i++){\n    ptr[i] = (char *)malloc(20*sizeof(char));\n    if(ptr[i]==NULL){\n        printf(\"Memory not allocated!\\n\");\n        return -1;\n    }\n}\n\nfor(i=0; i&lt;2;i++)   \n    scanf(\"%s\", ptr[i]);\n\nfor(i=0; i&lt;2; i++)  \n    printf(\"%s\\n\", ptr[i]);\n\nfor(i=0; i&lt;4; i++)\n    printf(\"%c\\n\", ptr[0][i]);\n\nfor(i=0; i&lt;4; i++)\n    printf(\"%c\\n\", ptr[1][i]);\n\nfree(ptr[0]);\nfree(ptr[1]);\nfree(ptr);\n\nreturn 0;\n}\n</code></pre>\n"}, {"tags": ["c", "gcc", "mingw"], "comments": [{"owner": {"reputation": 613, "user_id": 3112926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b33809c5d0f78b110e8613c9e5972dd5?s=128&d=identicon&r=PG&f=1", "display_name": "JGroven", "link": "https://stackoverflow.com/users/3112926/jgroven"}, "edited": false, "score": 2, "creation_date": 1527098389, "post_id": 50494670, "comment_id": 88002197, "body": "Do you have a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>?"}, {"owner": {"reputation": 15, "user_id": 9834477, "user_type": "registered", "profile_image": "https://graph.facebook.com/2081283998867394/picture?type=large", "display_name": "Rajesh Kummar", "link": "https://stackoverflow.com/users/9834477/rajesh-kummar"}, "reply_to_user": {"reputation": 613, "user_id": 3112926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b33809c5d0f78b110e8613c9e5972dd5?s=128&d=identicon&r=PG&f=1", "display_name": "JGroven", "link": "https://stackoverflow.com/users/3112926/jgroven"}, "edited": false, "score": 0, "creation_date": 1527099422, "post_id": 50494670, "comment_id": 88002663, "body": "Thank you for asking , i added the code please have a look"}, {"owner": {"reputation": 612, "user_id": 5511137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a52669f8524c53fd6a1451800dac0c45?s=128&d=identicon&r=PG&f=1", "display_name": "Roflcopter4", "link": "https://stackoverflow.com/users/5511137/roflcopter4"}, "edited": false, "score": 0, "creation_date": 1527113196, "post_id": 50494670, "comment_id": 88009167, "body": "This isn&#39;t, strictly speaking, an answer to your question, but I would highly recommend that you incorporate some open source variation of the (non-standard) strsep function, which can be found in glibc and all of the BSD&#39;s libc&#39;s. It is vastly superior to strtok."}], "answers": [{"tags": [], "owner": {"reputation": 4046, "user_id": 4971422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4abf51a937ddda51cc6813445605c50?s=128&d=identicon&r=PG&f=1", "display_name": "FredK", "link": "https://stackoverflow.com/users/4971422/fredk"}, "is_accepted": true, "score": 0, "last_activity_date": 1527101304, "creation_date": 1527101304, "answer_id": 50495451, "question_id": 50494670, "link": "https://stackoverflow.com/questions/50494670/undefined-reference-to-strtok-r-windows-10-mingw/50495451#50495451", "title": "undefined reference to `strtok_r&#39; Windows 10 MinGW", "body": "<p>strtok_r is not a standard C method (it is POSIX). Your compiler may not be POSIX compliant and therefore its standard library might not contain the method. Look in your string.h file and see whether its prototype is declared there.</p>\n"}], "owner": {"reputation": 15, "user_id": 9834477, "user_type": "registered", "profile_image": "https://graph.facebook.com/2081283998867394/picture?type=large", "display_name": "Rajesh Kummar", "link": "https://stackoverflow.com/users/9834477/rajesh-kummar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1014, "favorite_count": 0, "accepted_answer_id": 50495451, "answer_count": 1, "score": 0, "last_activity_date": 1527101304, "creation_date": 1527098288, "last_edit_date": 1527099386, "question_id": 50494670, "link": "https://stackoverflow.com/questions/50494670/undefined-reference-to-strtok-r-windows-10-mingw", "title": "undefined reference to `strtok_r&#39; Windows 10 MinGW", "body": "<p>i am always getting error while compile , it's saying undefined reference to `strtok_r' i am using MinGW in windows 10 , please help to solve this issue. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\n\nint main(int argc, char **argv) {\n  char *test1, *test2;\n  char *state1, *state2;\n  char *cur1, *cur2;\n\n  test1 = malloc(20);\n  test2 = malloc(20);\n  strcpy(test1, \"a,b,c,d\");\n  strcpy(test2, \"e,f,g,h\");\n\n  cur1 = strtok_r(test1, \",\", &amp;state1);\n  cur2 = strtok_r(test2, \",\", &amp;state2);\n  while (cur1 != NULL &amp;&amp; cur2 != NULL) {\n    if (cur1 != NULL) {\n      printf(\"cur1 : %s\\n\", cur1);\n    }\n    if (cur2 != NULL) {\n      printf(\"cur2 : %s\\n\", cur2);\n    }\n    cur1 = strtok_r(NULL, \",\", &amp;state1);\n    cur2 = strtok_r(NULL, \",\", &amp;state2);\n  };\n}\n</code></pre>\n\n<p>Here is error and warning messages in windows 10 </p>\n\n<pre><code>strtok-test.c: In function 'main':\nstrtok-test.c:16:10: warning: implicit declaration of function 'strtok_r' [-Wimplicit-function-declaration]\n   cur1 = strtok_r(test1, \",\", &amp;state1);\n          ^~~~~~~~\nstrtok-test.c:16:8: warning: assignment makes pointer from integer without a cast [-Wint-conversion]\n   cur1 = strtok_r(test1, \",\", &amp;state1);\n        ^\nstrtok-test.c:17:8: warning: assignment makes pointer from integer without a cast [-Wint-conversion]\n   cur2 = strtok_r(test2, \",\", &amp;state2);\n        ^\nstrtok-test.c:25:10: warning: assignment makes pointer from integer without a cast [-Wint-conversion]\n     cur1 = strtok_r(NULL, \",\", &amp;state1);\n          ^\nstrtok-test.c:26:10: warning: assignment makes pointer from integer without a cast [-Wint-conversion]\n     cur2 = strtok_r(NULL, \",\", &amp;state2);\n      ^\nC:\\Users\\AppData\\Local\\Temp\\ccvzdBJh.o: In function `main':\nC:\\Users\\Desktop\\New folder/strtok-test.c:16: undefined reference to `strtok_r'\nC:\\Users\\Desktop\\New folder/strtok-test.c:17: undefined reference to `strtok_r'\nC:\\Users\\Desktop\\New folder/strtok-test.c:25: undefined reference to `strtok_r'\nC:\\Users\\Desktop\\New folder/strtok-test.c:26: undefined reference to `strtok_r'\ncollect2.exe: error: ld returned 1 exit status\n</code></pre>\n"}, {"tags": ["c", "arrays", "for-loop", "malloc", "storage"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 3, "creation_date": 1527098290, "post_id": 50494647, "comment_id": 88002153, "body": "Post your code, please."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1527098517, "post_id": 50494647, "comment_id": 88002252, "body": "<i>&quot;each time the for loop ends, those coordinates entered need to be saved&quot;</i> - so.. save them. The actual <i>problem</i> eludes this post, so unless you have a specific question about your code, this is likely to close quickly. Don&#39;t just tell us about your code; <a href=\"https://stackoverflow.com/posts/50494647/edit\"><i>show it in your question</i></a>. The description suggests you already have potential memory leak problems, but we can&#39;t be sure, and this isn&#39;t a site for guessing."}, {"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "edited": false, "score": 0, "creation_date": 1527099253, "post_id": 50494647, "comment_id": 88002588, "body": "Maria, your logic is incorrect. How many numbers do you want to store in total? =) Or, what exactly do you want to do? Maybe you can edit your question with an example on it."}], "answers": [{"tags": [], "owner": {"reputation": 2385, "user_id": 1009270, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/33fcdc9c0604cf69abb15e17840d2a3c?s=128&d=identicon&r=PG", "display_name": "john elemans", "link": "https://stackoverflow.com/users/1009270/john-elemans"}, "is_accepted": false, "score": 0, "last_activity_date": 1527100473, "creation_date": 1527100473, "answer_id": 50495221, "question_id": 50494647, "link": "https://stackoverflow.com/questions/50494647/storing-values-in-an-array-in-a-for-loop/50495221#50495221", "title": "Storing values in an array in a for loop", "body": "<p>You have created a set of buffers for storing ints of size zones. You have 4 variables which point to the first byte in each buffer (x1, y1, x2, y2). </p>\n\n<p>You have a small error in your scan statement,  scan expects pointers to the memory where you want to store your value. But x1 etc are already pointers, so you don't need &amp;x1, just x1 will do what you need.</p>\n\n<p>Next you want to advance the pointers to scan into the next memory location in the buffer you created for your array. You can just increment the pointers after each scan; eg x1++ . This will put each value in the subsequent location in your buffer.</p>\n\n<p>But this will also loose the reference to the buffers themselves. You can move the pointers back to the beginning of the buffers after the loop (eg - x1 = x1 - zones) or you can just create a different pointer to iterate over the buffer which might be more readable.</p>\n"}, {"tags": [], "owner": {"reputation": 4046, "user_id": 4971422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4abf51a937ddda51cc6813445605c50?s=128&d=identicon&r=PG&f=1", "display_name": "FredK", "link": "https://stackoverflow.com/users/4971422/fredk"}, "is_accepted": false, "score": 0, "last_activity_date": 1527101570, "creation_date": 1527101570, "answer_id": 50495532, "question_id": 50494647, "link": "https://stackoverflow.com/questions/50494647/storing-values-in-an-array-in-a-for-loop/50495532#50495532", "title": "Storing values in an array in a for loop", "body": "<p>Your read statement should be</p>\n\n<pre><code>scanf(\"%d%d%d%d\", &amp;x1[i], &amp;y1[i], &amp;x2[i], &amp;y2[i]);\n</code></pre>\n\n<p>But you should also handle the case where the input is incorrect; i.e., when the user mistypes and enters something that is not an integer value.</p>\n"}], "owner": {"reputation": 21, "user_id": 8958344, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ed1cf1a90596cb9f281934b288a6d95?s=128&d=identicon&r=PG&f=1", "display_name": "Maria Greenfield", "link": "https://stackoverflow.com/users/8958344/maria-greenfield"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 406, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1530892412, "creation_date": 1527098187, "last_edit_date": 1530892412, "question_id": 50494647, "link": "https://stackoverflow.com/questions/50494647/storing-values-in-an-array-in-a-for-loop", "title": "Storing values in an array in a for loop", "body": "<p>Edit: For this assignment I need to input how many rectangular \"zones\" we are putting in on a Cartesian grid. Our 4 inputs are 2 (x,y) coordinates <code>x1</code>, <code>y1</code>, <code>x2</code>, <code>y2</code>, for each zone. The coordinates should be the bottom left corner and the top right corner of the rectangle. we are checking to see if each zones overlaps with any of the previous zones, so I need the coordinates of the previous zones to be saved so that I can use them later for checking for overlaps. My professor is requiring us to use dynamic memory allocation for this program.</p>\n\n<p>I'm trying to create an array of x and y coordinates to compare with each other. Each iteration of the <code>for</code> loop is going to ask for 2 coordinate points (<code>x1</code>, <code>y1</code>, <code>x2</code>, <code>y2</code>) to compare with the next set of points, so each time the <code>for</code> loop ends, those coordinates entered need to be saved. I've already used <code>malloc()</code> for each of the values, I just need help figuring out how to save them from being erased when the next <code>for</code> loop starts in an efficient way. Should I create an array for each of the values or would that be inefficient?</p>\n\n<pre><code>int i, j;\nint zones, *x1, *y1, *x2, *y2;\n\nscanf(\"%d\", &amp;zones);\n\nx1 = malloc(sizeof(int)*zones);\ny1 = malloc(sizeof(int)*zones);\nx2 = malloc(sizeof(int)*zones);\ny2 = malloc(sizeof(int)*zones);\n\nfor(i=0; i&lt;zones; i++)\n{\n    scanf(\"%d%d%d%d\", &amp;x1, &amp;y1, &amp;x2, &amp;y2);\n}\n</code></pre>\n\n<p>After I scan my values I'm not sure where to go from there. Also I'm not sure if I'm entering in <code>malloc</code> correctly. I want each value to be big enough to hold values equal the number of zones that will be asked.</p>\n"}, {"tags": ["c++", "c", "linux", "gcc", "msvcrt"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1527098233, "post_id": 50494605, "comment_id": 88002120, "body": "GCC has GNU extensions, yes. Linux has it&#39;s own specific APIs. Not clear what the point of the question though..."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1527098308, "post_id": 50494605, "comment_id": 88002165, "body": "@EugeneSh. I imagine OP&#39;s question is &#39;can you compile glibc source by non-gcc compiler&#39;. I do not know the answer to it. I guess, OP can always try."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1527098513, "post_id": 50494605, "comment_id": 88002248, "body": "All of the gcc extensions have names starting with <code>__</code>, which makes them pretty visible. If your program uses one of these, it might not compile on other compilers, although Clang tries to emulate many of them."}, {"owner": {"reputation": 172, "user_id": 8396910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60cac67c4aa7fc1e07e883d0ba58fb73?s=128&d=identicon&r=PG&f=1", "display_name": "hescobar", "link": "https://stackoverflow.com/users/8396910/hescobar"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1527100949, "post_id": 50494605, "comment_id": 88003468, "body": "@EugeneSh...... the question is pretty specific so I am not sure what the confusion is. I posted an example so that others would know exactly what I meant...I was able to answer my own question now, so I will answer myself on here as well. Basically either of you could have provided this link, <a href=\"https://gcc.gnu.org/onlinedocs/gcc/C-Extensions.html\" rel=\"nofollow noreferrer\">gcc.gnu.org/onlinedocs/gcc/C-Extensions.html</a>, and answer my question...."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "reply_to_user": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1527101702, "post_id": 50494605, "comment_id": 88003891, "body": "@rici &quot;All of the gcc extensions have names starting with __&quot; - not quite true. There are also language extensions like allowing VLAs (Variable Length Arrays) and nested functions (although that one is C only) and many more, that are not so easily identifiable as extensions. Luckily, if you build your code with, for example, <code>-std=c++14</code> rather than the (unfortunate) default of <code>-std=gnu++14</code> then the extension support goes away."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "reply_to_user": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1527102757, "post_id": 50494605, "comment_id": 88004403, "body": "@jesper: that&#39;s true. I meant to type that all of gcc&#39;s extension functions have names of that form, but by the time I noticed I&#39;d missed the word, it was too late to edit. (VLAs aren&#39;t really an extension; they&#39;re an optional feature, at least in C since C99)"}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 1, "creation_date": 1527104947, "post_id": 50494605, "comment_id": 88005515, "body": "I&#39;m voting to close this question as off-topic because the information on GCC extensions is readily available in the GCC documentation."}], "answers": [{"tags": [], "owner": {"reputation": 172, "user_id": 8396910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60cac67c4aa7fc1e07e883d0ba58fb73?s=128&d=identicon&r=PG&f=1", "display_name": "hescobar", "link": "https://stackoverflow.com/users/8396910/hescobar"}, "is_accepted": false, "score": 2, "last_activity_date": 1527100987, "creation_date": 1527100987, "answer_id": 50495374, "question_id": 50494605, "link": "https://stackoverflow.com/questions/50494605/glibc-specific-functions-for-gcc/50495374#50495374", "title": "glibc specific functions for gcc", "body": "<p>Extensions to the C language in gcc can be found here <a href=\"https://gcc.gnu.org/onlinedocs/gcc/C-Extensions.html\" rel=\"nofollow noreferrer\">https://gcc.gnu.org/onlinedocs/gcc/C-Extensions.html</a></p>\n"}], "owner": {"reputation": 172, "user_id": 8396910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60cac67c4aa7fc1e07e883d0ba58fb73?s=128&d=identicon&r=PG&f=1", "display_name": "hescobar", "link": "https://stackoverflow.com/users/8396910/hescobar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "closed_date": 1527146598, "answer_count": 1, "score": -2, "last_activity_date": 1527100987, "creation_date": 1527098032, "question_id": 50494605, "link": "https://stackoverflow.com/questions/50494605/glibc-specific-functions-for-gcc", "closed_reason": "Not suitable for this site", "title": "glibc specific functions for gcc", "body": "<p>I have read that the Windows C library msvcrt has functions(and other things) that can only be compiled by Microsoft's own compiler. <br>\nIs there anything equivalent to \"Microsoft extensions to c and c++\" in linux/glibc? Thank you.</p>\n"}, {"tags": ["c", "pointers", "malloc", "virtualdub"], "comments": [{"owner": {"reputation": 116, "user_id": 2983437, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24a342b21949a70782e8d6f5877afccb?s=128&d=identicon&r=PG&f=1", "display_name": "shekh", "link": "https://stackoverflow.com/users/2983437/shekh"}, "edited": false, "score": 0, "creation_date": 1527158691, "post_id": 50494401, "comment_id": 88026598, "body": "free the same buf as you allocate"}], "answers": [{"tags": [], "owner": {"reputation": 124, "user_id": 6416036, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156970694490057/picture?type=large", "display_name": "Captain Jack", "link": "https://stackoverflow.com/users/6416036/captain-jack"}, "is_accepted": false, "score": 0, "last_activity_date": 1527230019, "creation_date": 1527230019, "answer_id": 50522877, "question_id": 50494401, "link": "https://stackoverflow.com/questions/50494401/virtualdub-filter-framebuffer-freeing-memory/50522877#50522877", "title": "VirtualDub filter framebuffer - freeing memory", "body": "<p>Resolved by allocating memory only once per run. There's no reason to allocate memory for each frame, since I only need to hold one frame at a time.</p>\n"}], "owner": {"reputation": 124, "user_id": 6416036, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156970694490057/picture?type=large", "display_name": "Captain Jack", "link": "https://stackoverflow.com/users/6416036/captain-jack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1527230019, "creation_date": 1527097140, "last_edit_date": 1527098923, "question_id": 50494401, "link": "https://stackoverflow.com/questions/50494401/virtualdub-filter-framebuffer-freeing-memory", "title": "VirtualDub filter framebuffer - freeing memory", "body": "<p>I am writing a VirtualDub filter, which requires a separate frame buffer for intermediate image processing between fa->src.data and fa->dst.data (.data is essentially a pointer to Pixel data).</p>\n\n<p>I create a char pointer to the above using this:</p>\n\n<pre><code>/* Pointers to source and destination frame stores */\nchar *src = (char *)fa-&gt;src.data;\nchar *dst = (char *)fa-&gt;dst.data;\n\n/* Image width and height */\nint w = fa-&gt;src.w*sizeof(Pixel32);\nint h = fa-&gt;src.h*sizeof(Pixel32);\n</code></pre>\n\n<p>This then allows me to copy data from source frame to destination frame, line by line:</p>\n\n<pre><code>memcpy(dst,src,w);\n</code></pre>\n\n<p>Now I would like to have an intermediate buffer that I can copy from *dst to buffer, then from buffer to *src. How can I do that?</p>\n\n<p>I tried several things with varying degrees of success.</p>\n\n<pre><code>/* Define and initialise char array with malloc */\nchar *buf = (char*)malloc(w*h); \n</code></pre>\n\n<p>Then: </p>\n\n<pre><code>memcpy(buf,src,w); /* copy to buffer */\nmemcpy(dst,buf,w); /* copy from buffer to dst */\n</code></pre>\n\n<p>Most of the time, this seems to work. However, after a short while I get \"An out-of-bounds memory access (access violation) occurred in module \". The issue is that I seem to run out of system memory (VirtualDub takes ALL the available memory after a while). </p>\n\n<p>Do I need to free the buffer? Seems odd, since it is initialised every frame. How can I free it?</p>\n\n<p>I tried free(dstbuf) and free(&amp;dstbuf) but I am getting \"Debug Assertion Failed\" error at runtime, expression: _CrtIsValidHeapPointer(pUserData)... with not much else.</p>\n\n<p>Any ideas? </p>\n"}, {"tags": ["java", "c", "c99"], "comments": [{"owner": {"reputation": 19590, "user_id": 5050667, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/3WJfP.jpg?s=128&g=1", "display_name": "Yassin Hajaj", "link": "https://stackoverflow.com/users/5050667/yassin-hajaj"}, "edited": false, "score": 0, "creation_date": 1527097272, "post_id": 50494347, "comment_id": 88001664, "body": "I don&#39;t see any problem with allocating an array&#39;s size this way"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8849289"}, "reply_to_user": {"reputation": 19590, "user_id": 5050667, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/3WJfP.jpg?s=128&g=1", "display_name": "Yassin Hajaj", "link": "https://stackoverflow.com/users/5050667/yassin-hajaj"}, "edited": false, "score": 3, "creation_date": 1527097345, "post_id": 50494347, "comment_id": 88001695, "body": "@YassinHajaj No. c99 is a version of C standard. Other C standards include c11, etc"}, {"owner": {"reputation": 80989, "user_id": 466862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d873f397779db38cd510d9ee5416fd43?s=128&d=identicon&r=PG", "display_name": "Mark Rotteveel", "link": "https://stackoverflow.com/users/466862/mark-rotteveel"}, "edited": false, "score": 0, "creation_date": 1527097640, "post_id": 50494347, "comment_id": 88001830, "body": "The behavior and workings of arrays in Java are fully specified, see <a href=\"https://docs.oracle.com/javase/specs/jls/se10/html/jls-10.html\" rel=\"nofollow noreferrer\">Java Language Specification version 10, chapter 10</a>. Frankly, I&#39;m amazed you even think that Java - a fully managed language - would somehow skip that for arrays."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1527098898, "post_id": 50494347, "comment_id": 88002426, "body": "<code>int arr[size];</code> is not a dynamic array. It is an automatic array whose size is determined at run-time. The lifetime of an automatic object only extends to the moment execution leaves the block in which it was declared. Dynamic objects live until <i>explicitly</i> freed."}], "answers": [{"comments": [{"owner": {"reputation": 120590, "user_id": 3788176, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/9c18d321d8948803c05643d87b003dc2?s=128&d=identicon&r=PG&f=1", "display_name": "Andy Turner", "link": "https://stackoverflow.com/users/3788176/andy-turner"}, "edited": false, "score": 2, "creation_date": 1527097650, "post_id": 50494436, "comment_id": 88001835, "body": "Even if it is a negative int, it is valid Java. It will fail at runtime; but so might a positive integer if it is too big for the available memory. (Also, you mean non-negative, not positive: zero is a fine length for an array). (Also, the length needn&#39;t be an int; it merely needs to be a type which undergoes unary numeric promotion to int)."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8849289"}, "edited": false, "score": 0, "creation_date": 1527097807, "post_id": 50494436, "comment_id": 88001904, "body": "Then is the array allocated on heap or stack? I know in C/C++, static arrays are allocated on stack while dynamic arrays are allocated on heap. But in Jave, it looks like the ways to create a static array (e.g., int[] static_arr = new int[5]) and a dynamic array (e.g., int[] dynamic_arr = new int[n]; // n determined by user input) are the same.  Then are they allocated both on heap rather than one on stack and one on heap? @Ernest Kiwele"}, {"owner": {"reputation": 120590, "user_id": 3788176, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/9c18d321d8948803c05643d87b003dc2?s=128&d=identicon&r=PG&f=1", "display_name": "Andy Turner", "link": "https://stackoverflow.com/users/3788176/andy-turner"}, "edited": false, "score": 0, "creation_date": 1527097946, "post_id": 50494436, "comment_id": 88001978, "body": "@Jane Java arrays are Objects, so they are always heap allocated."}, {"owner": {"reputation": 39204, "user_id": 5761558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3cf04bfac11ef3ee693852eccde3b3c?s=128&d=identicon&r=PG&f=1", "display_name": "ernest_k", "link": "https://stackoverflow.com/users/5761558/ernest-k"}, "reply_to_user": {"reputation": 120590, "user_id": 3788176, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/9c18d321d8948803c05643d87b003dc2?s=128&d=identicon&r=PG&f=1", "display_name": "Andy Turner", "link": "https://stackoverflow.com/users/3788176/andy-turner"}, "edited": false, "score": 0, "creation_date": 1527098028, "post_id": 50494436, "comment_id": 88002023, "body": "@AndyTurner Good point about non-negative length, I&#39;ve edited. Regarding a negative int passing compile-time validation, that&#39;s obvious, but I suppose the question is more about the dynamic aspect of the array creation. There are many possible reasons for errors to occur at runtime, but that doesn&#39;t make the dynamic creation essentially problematic."}], "tags": [], "owner": {"reputation": 39204, "user_id": 5761558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3cf04bfac11ef3ee693852eccde3b3c?s=128&d=identicon&r=PG&f=1", "display_name": "ernest_k", "link": "https://stackoverflow.com/users/5761558/ernest-k"}, "is_accepted": false, "score": 0, "last_activity_date": 1527097874, "last_edit_date": 1527097874, "creation_date": 1527097293, "answer_id": 50494436, "question_id": 50494347, "link": "https://stackoverflow.com/questions/50494347/create-an-array-whose-length-is-determined-by-user-input-c-vs-c99-vs-java/50494436#50494436", "title": "create an array whose length is determined by user input: C vs C99 vs Java", "body": "<p>This is perfectly acceptable and commonly done in Java. <code>new int[number]</code> is executed at runtime and a dynamic number does it.</p>\n\n<p>As long as the length of the array is a non-negative <code>int</code>, this is valid in Java.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 9831162, "user_type": "registered", "profile_image": "https://graph.facebook.com/1158850784246614/picture?type=large", "display_name": "John Luo", "link": "https://stackoverflow.com/users/9831162/john-luo"}, "is_accepted": false, "score": 0, "last_activity_date": 1527097653, "creation_date": 1527097653, "answer_id": 50494517, "question_id": 50494347, "link": "https://stackoverflow.com/questions/50494347/create-an-array-whose-length-is-determined-by-user-input-c-vs-c99-vs-java/50494517#50494517", "title": "create an array whose length is determined by user input: C vs C99 vs Java", "body": "<p>In java you are able to set the length of the array as the creation of the array is executed during runtime and should be accepted in all java platforms.</p>\n"}, {"comments": [{"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1527099671, "post_id": 50494581, "comment_id": 88002791, "body": "Of course, seg faults from optimistic memory allocation are <i>completely different</i>. :-)"}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1527116101, "post_id": 50494581, "comment_id": 88009960, "body": "@rici: I would like to see the C Standard require that implementations document &quot;environmental requirements&quot;, and then say that if environmental conditions are satisfied and a program does not invoke UB, an implementation must either behave as defined by the Standard or fail in implementation-defined manner.  If a C compiler specifies an environmental requirement that the OS must let the program run, but an OS kills off a process for reasons outside that program&#39;s control, such action would violate the documented environmental requirements, thus waiving any requirements on the implementation."}], "tags": [], "owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "is_accepted": false, "score": 0, "last_activity_date": 1527098263, "last_edit_date": 1527098263, "creation_date": 1527097950, "answer_id": 50494581, "question_id": 50494347, "link": "https://stackoverflow.com/questions/50494347/create-an-array-whose-length-is-determined-by-user-input-c-vs-c99-vs-java/50494581#50494581", "title": "create an array whose length is determined by user input: C vs C99 vs Java", "body": "<p>In Java an array is allocated on heap. If the allocation fails, a catchable exception is thrown! It is possible to recover from failed array allocation.</p>\n\n<pre><code>% java Main\nenter a number:\n1231231231\nException in thread \"main\" java.lang.OutOfMemoryError: Java heap space\n        at Main.main(Main.java:12)\n</code></pre>\n\n<p>Catch the exception:</p>\n\n<pre><code>try {\n    int[] arr = new int[size];\n} catch (OutOfMemoryError e) {\n    System.out.println(\"Alas, such array could not be allocated. Try a smaller number next time!\");\n}\n</code></pre>\n\n<p>and you get</p>\n\n<pre><code>% java Main      \nenter a number:\n1231231231\nAlas, such array could not be allocated. Try a smaller number next time!\n</code></pre>\n\n<hr>\n\n<p>The reason why the simple use of variable-length arrays in C99 is often frowned upon is that the array is allocated on <strong>stack</strong>. Now, if the size of the array comes from the user, it is easy to cause an uncontrollable crash:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void) {\n    int size;\n    scanf(\"%d\", &amp;size);\n    volatile int arr[size];\n    printf(\"%d\\n\", arr[size - 1]);\n}\n</code></pre>\n\n<p>now compile and run:</p>\n\n<pre><code>% ./a.out    \n1231231231  \nzsh: segmentation fault (core dumped)  ./a.out\n</code></pre>\n\n<p>There is <em>no way</em> of checking whether the allocation succeeded or not. Therefore if you're unsure - and especially when playing with numbers that could come from an untrusted user, you shouldn't use stack-allocated variable-length arrays.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user8849289"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1527098263, "creation_date": 1527096932, "last_edit_date": 1527097430, "question_id": 50494347, "link": "https://stackoverflow.com/questions/50494347/create-an-array-whose-length-is-determined-by-user-input-c-vs-c99-vs-java", "title": "create an array whose length is determined by user input: C vs C99 vs Java", "body": "<p>I am trying to figure out methods to create an array whose length is determined at run time (e.g., by user input) in C and Java.</p>\n\n<p>In C, I know that some versions of C standards such as C99 now allow the following way:</p>\n\n<pre><code>int size;\nscanf(\"%d\",&amp;size);\nint arr[size];\n</code></pre>\n\n<p>However, theoretically, it is not acceptable to create a dynamic array in C like this. The global solution is to use malloc() in C.</p>\n\n<p>My question is, what about in Java? I have run the following Java program on my own computer and no error was generated. But I am not sure whether it is only correct to a specific Java platform (like C99 in the C case) or it is universally acceptable in all Java's</p>\n\n<pre><code>import java.util.Scanner;\n\npublic class Main{\n    public static void main(String[] args){\n\n    int size;\n\n    System.out.println(\"enter a number:\");\n    Scanner s = new Scanner(System.in);\n    size = s.nextInt();\n\n    int[] arr = new int[size];\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "segmentation-fault", "debian"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1527096736, "post_id": 50494227, "comment_id": 88001386, "body": "You need to learn how to debug it. Multithreading is not simple, and if you are up to it you will need this skill."}], "answers": [{"tags": [], "owner": {"reputation": 6882, "user_id": 3403834, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xpA5S.jpg?s=128&g=1", "display_name": "user58697", "link": "https://stackoverflow.com/users/3403834/user58697"}, "is_accepted": false, "score": 1, "last_activity_date": 1527103372, "creation_date": 1527103372, "answer_id": 50496024, "question_id": 50494227, "link": "https://stackoverflow.com/questions/50494227/segmentation-fault-with-multithreaded-array/50496024#50496024", "title": "Segmentation fault with multithreaded array", "body": "<p>There is no multithreading in this program: every thread is immediately joined; noting runs in parallel.</p>\n\n<p>The real problem is in <code>boyutbul</code>, which tries to figure out the length of the array by looking for <code>'\\0'</code>. The way you initialize the arrays, there is no guarantee that they would have the terminating 0 (in fact, they wouldn't have any zeroes), so the program is doomed to access them beyond the bounds. This is UB.</p>\n"}], "owner": {"reputation": 11, "user_id": 9836054, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-uDfwCvhalDw/AAAAAAAAAAI/AAAAAAAAAt8/SApEE-G7zyY/photo.jpg?sz=128", "display_name": "T&#252;rk&#252; Do\u011fan", "link": "https://stackoverflow.com/users/9836054/t%c3%bcrk%c3%bc-do%c4%9fan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1527103372, "creation_date": 1527096522, "last_edit_date": 1527096589, "question_id": 50494227, "link": "https://stackoverflow.com/questions/50494227/segmentation-fault-with-multithreaded-array", "title": "Segmentation fault with multithreaded array", "body": "<p>I am trying to make multithread array sorting program in c. But when I run the program, I get an \"segmentation fault\" error. \nCan someone help?\nWhat should I change? First array should be 300 the other should be 500. We sort sequences separately first. After that merge 2 sorted sequences. I use \"gcc -pthreads -0 soru1 soru1.c\" and \"./soru1\" commands.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;pthread.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;time.h&gt;\n#define size 800\n\nint orginal_dizi[size], dizi1[300], dizi2[500], dizi3[size];\nint sayi,a=1;\n\nint boyutbul(int *the)\n{\n    int number=-1;\n    while(the[++number]!='\\0'){}\n    return number;\n}\n\nvoid*runner(void *param)\n{\n    int temp,i,k;\n    int *bolum = param;\n    sayi = boyutbul(bolum);\n    printf(\"\\n----------unsorted %d. array-----------\\n\\n\",a);\n    for(i=0; i&lt;sayi;i++)\n    printf(\"%d\\n\", bolum[i]);\n\n    for(i=0; i&lt;sayi;i++)\n    {\n        for(k=0; k&lt;(sayi-i-1);k++)\n        {\n            if(bolum[k]&gt;bolum[k+1])\n            {\n                temp=bolum[k];\n                bolum[k]=bolum[k+1];\n                bolum[k+1]=temp;\n            }\n        }\n    }\n    printf(\"\\n----------sorted %d. array-----------\\n\\n\",a);\n    for(i=0; i&lt;sayi;i++)\n    printf(\"%d\\n\", bolum[i]);\n    a++;\n    pthread_exit(0);\n}\n\nint main()\n{\n    pthread_t tid1,tid2, tid3;\n    int i=0;\n    while(i&lt;size)\n    {\n        int yenisayi=1+rand()%1500;\n        int aynimi=0, j=0;\n        while(j&lt;i)\n        {\n            if(orginal_dizi[j]==yenisayi)\n            {\n                aynimi=1;\n                break;\n            }\n        j++;\n        }\n        if(aynimi)\n        continue;\n        orginal_dizi[i]=yenisayi;\n        i++;\n    }\n    for(i=0;i&lt;size;i++)\n    {\n        if(i&lt;(300))\n        {\n            dizi1[i]=orginal_dizi[i];\n        }\n        else\n        {\n            dizi2[i-(500)-1]= orginal_dizi[i];\n        }\n    }\n    pthread_create(&amp;tid1,NULL,runner,(void *)dizi1);\n    pthread_join(tid1,NULL);\n\n    pthread_create(&amp;tid2,NULL,runner,(void *)dizi2);\n    pthread_join(tid2,NULL);\n\n    for(i=0; i&lt;size;i++)\n    {\n        if(i&lt;300)\n        {\n            dizi3[i]=dizi1[i];\n        }\n        else\n        {\n            dizi3[i]=dizi2[i-500];\n        }\n    }\n\n    pthread_create(&amp;tid3,NULL,runner,(void *)dizi3);\n    pthread_join(tid3,NULL);\n\n    FILE *fp;\n    if((fp=fopen(\"son.txt\",\"w\"))== NULL)\n    printf(\"Dosya acilamadi.\");\n\n    for(i=0;i&lt;size;i++)\n    {\n        fprintf(fp, \"%d\\n\", dizi3[i]);\n    }\n    fclose(fp);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "memory", "unsigned-integer"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 3, "creation_date": 1527096217, "post_id": 50494128, "comment_id": 88001147, "body": "The location of <i>where</i> a variable is allocated is not an indication of it&#39;s <i>size</i>. Variables are often padded for various reasons such as alignment and access optimization."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1527096259, "post_id": 50494128, "comment_id": 88001165, "body": "Aside: you should not use <code>%d</code> for <code>sizeof</code> but <code>%zu</code>. The <code>sizeof</code> gives a value of type <code>size_t</code> which <i>might</i> be the same size as <code>int</code>, or maybe not."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 1, "creation_date": 1527097030, "post_id": 50494128, "comment_id": 88001547, "body": "Even though it can be of same size, it <b>must not be</b> <code>int</code> since <code>size_t</code> must be unsigned, therefore <code>%d</code> is still not compliant even on those platforms"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1527097102, "post_id": 50494128, "comment_id": 88001576, "body": "@AnttiHaapala I only meant that OP could have &quot;got away with it&quot; in this case, which was apparently so."}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1527098455, "post_id": 50494128, "comment_id": 88002220, "body": "if you want to understand why this is happening look here <a href=\"https://en.wikipedia.org/wiki/Data_structure_alignment\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Data_structure_alignment</a>"}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 1, "creation_date": 1527099089, "post_id": 50494128, "comment_id": 88002503, "body": "Why does the tile of the question talk about &quot;sizeof unsigned int&quot; when in reality it is about &quot;sizeof ABC&quot;???"}], "answers": [{"comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 1, "creation_date": 1527097177, "post_id": 50494343, "comment_id": 88001612, "body": "&quot;can break on some compilers&quot; = can break on <i>any</i> compiler anywhere. Including those platforms that supposedly allow unaligned access."}], "tags": [], "owner": {"reputation": 2412, "user_id": 1191058, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/09eeee14385ba75f18adb473ccffe208?s=128&d=identicon&r=PG", "display_name": "j123b567", "link": "https://stackoverflow.com/users/1191058/j123b567"}, "is_accepted": false, "score": 1, "last_activity_date": 1527097862, "last_edit_date": 1527097862, "creation_date": 1527096917, "answer_id": 50494343, "question_id": 50494128, "link": "https://stackoverflow.com/questions/50494128/sizeof-unsigned-int-is-8/50494343#50494343", "title": "sizeof unsigned int is 8", "body": "<p>It is up to the compiler how it aligns memory. You can try to use <code>__attribute__ ((__packed__))</code> if using GCC or similar compiler or <code>#pragma pack(push,1)</code> and <code>#pragma pack(pop)</code> if using Visual C.</p>\n\n<p>It is not portable way to do things and it can break on some compilers/systems but it can work for you.</p>\n\n<p>Packing can save the memory but accessing variables may be slower.</p>\n\n<p><strong>Edit:</strong></p>\n\n<p>What can break if using packed:</p>\n\n<p>Some compilers can ignore packing at all in some cases (e.g. there was/is? a bug in mingw-gcc)</p>\n\n<p>Some CPU architectures can't handle unaligned access to memory. They throw an exception/fault or they just use wrong values. (e.g. ARMv5 and older ARM cores). Compiler can overcome this issue in some cases but not in all cases.</p>\n"}, {"tags": [], "owner": {"reputation": 655, "user_id": 7484210, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ghd9L.jpg?s=128&g=1", "display_name": "0x400921FB54442D18", "link": "https://stackoverflow.com/users/7484210/0x400921fb54442d18"}, "is_accepted": false, "score": 1, "last_activity_date": 1527096926, "creation_date": 1527096926, "answer_id": 50494345, "question_id": 50494128, "link": "https://stackoverflow.com/questions/50494128/sizeof-unsigned-int-is-8/50494345#50494345", "title": "sizeof unsigned int is 8", "body": "<p>As others pointed out in comments, offset of an element in a struct is not a reliable way to measure its as your compiler is free to insert padding to structs in order to enforce specific member alignment. <br><br>\nIf you want your structs not to include padding for various reason, you have to use a compiler specific pragma to do it.<br></p>\n\n<p>For GCC, Clang and MSVC, you have to add <code>#pragma pack(push, 1)</code> right before your struct definition and <code>#pragma pack(pop)</code> right after it. </p>\n"}, {"tags": [], "owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "is_accepted": false, "score": 0, "last_activity_date": 1527098929, "creation_date": 1527098929, "answer_id": 50494819, "question_id": 50494128, "link": "https://stackoverflow.com/questions/50494128/sizeof-unsigned-int-is-8/50494819#50494819", "title": "sizeof unsigned int is 8", "body": "<p>Structs will typically be padded for alignment purposes.  An 8-byte type will want 8-byte alignment, so if it follows a 4-byte type, there may be 4 bytes of padding added so the 8-byte type can have its proper alignment.  Some compilers have extensions that will allow you to throw alignment to the wind (as shown in some of the other answers), but that comes with the problem of relying on compiler-specific extensions and unaligned members which, depending on the underlying hardware, can result in speed penalties or even traps (SPARC, for example, cannot handle unaligned access).</p>\n\n<p>Instead of relying on such behavior, if you order the struct by strictest alignment requirements first, it should naturally pack nicely without the alignment issues, though you might still wind up with some padding at the end so the struct itself can be aligned.</p>\n"}], "owner": {"reputation": 1046, "user_id": 614611, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c8a0c0fc3aa2182c46210e0257253dac?s=128&d=identicon&r=PG", "display_name": "Kingkong Jnr", "link": "https://stackoverflow.com/users/614611/kingkong-jnr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2541, "favorite_count": 1, "closed_date": 1527099195, "answer_count": 3, "score": 0, "last_activity_date": 1527108206, "creation_date": 1527096097, "last_edit_date": 1527108206, "question_id": 50494128, "link": "https://stackoverflow.com/questions/50494128/sizeof-unsigned-int-is-8", "closed_reason": "Duplicate", "title": "sizeof unsigned int is 8", "body": "<p>I am confused why clientIf even though declared as uint32(unsigned int - size 4 bytes), is taking up 8 bytes. I have explicitly printed sizeof(uint32) and that shows 4 bytes.</p>\n\n<p>Can someone throw some insight.</p>\n\n<p>I am running this code on a little endian machine x86.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\n/* network defines */\ntypedef char uint8;\ntypedef short uint16;\ntypedef unsigned int uint32;\ntypedef uint32 ipv4Addr;\n\n/***********************    V6 IP ADDRESS   **********************************/\ntypedef struct _v6IpAddr\n{\n    union _Bytes\n    {\n        uint8       rbyte[16];\n        uint16      doublebyte[8];\n        uint32      wordbyte[4];\n        long long   dwordbyte[2];\n    }unionv6;\n#define dbyte   unionv6.doublebyte\n#define wbyte   unionv6.wordbyte\n#define dwbyte  unionv6.dwordbyte\n#define xbyte   unionv6.rbyte\n}v6IpAddr;\n\ntypedef struct _v6IpAddr uint128;\n\ntypedef union _comIpAddr\n{\n    ipv4Addr v4Ip;\n    v6IpAddr v6Ip;\n}comIpAddr;\n\ntypedef struct abc\n{\n    /*|*/uint32         clientIf;          /*|*/\n    /*|*/comIpAddr      clientIp;          /*|*/\n    /*|*/uint8          mac[6];            /*|*/\n    /*|*/uint16         zero;              /*|*/\n}ABC;\n\nvoid print_bytes(const void *object, size_t size)\n{\n  // This is for C++; in C just drop the static_cast&lt;&gt;() and assign.\n  const unsigned char * const bytes = object;\n  size_t i;\n\n  printf(\"[ \");\n  for(i = 0; i &lt; size; i++)\n  {\n    printf(\"%02x \", bytes[i]);\n  }\n  printf(\"]\\n\");\n}\n\nint main()\n{\n    ABC test;\n    memset(&amp;test,0,sizeof test);\n    printf(\"sizeof test = %u\\n\", sizeof test);\n    printf(\"%d-%d-%d\\n\", sizeof(uint8), sizeof(uint16), sizeof(uint32));\n\n    print_bytes(&amp;test, sizeof test);\n    test.clientIf = 10;\n    test.clientIp.v4Ip = 0xAABBCCDD;\n    print_bytes(&amp;test, sizeof test);\n    printf(\"%p-%p-%p\\n\", &amp;(test.clientIf), &amp;(test.clientIp), &amp;(test.clientIp.v4Ip));\n    return 0;\n}\n</code></pre>\n\n<p>$ ./a.out</p>\n\n<p>sizeof test = 32</p>\n\n<p>1-2-4</p>\n\n<p>[ 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ]</p>\n\n<p>[ 0a 00 00 00 00 00 00 00 dd cc bb aa 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ]</p>\n\n<p>0x7fff113b0780-0x7fff113b0788-0x7fff113b0788\n$ </p>\n\n<p>Edit:</p>\n\n<p>Why will compiler add padding after clientIf since it is already a multiple of 4 bytes?</p>\n"}, {"tags": ["c", "linked-list"], "comments": [{"owner": {"reputation": 5074, "user_id": 5522303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c236ba3d52af53355a4d1a44a5145b04?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/5522303/kevin"}, "edited": false, "score": 2, "creation_date": 1527094247, "post_id": 50493607, "comment_id": 88000179, "body": "I don&#39;t see any double pointers in your code. Can you explain what you mean?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8521916"}, "reply_to_user": {"reputation": 5074, "user_id": 5522303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c236ba3d52af53355a4d1a44a5145b04?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/5522303/kevin"}, "edited": false, "score": 0, "creation_date": 1527094438, "post_id": 50493607, "comment_id": 88000272, "body": "@Kevin In C implementations of linked lists I often see the <code>push_front</code> function implemented with double pointers. The code I show uses a wrapper (SList) to avoid explicit double pointers. My question is why the first method seems to be the preferred one."}, {"owner": {"reputation": 4625, "user_id": 1964969, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0879c1954a7ee8660f80eafdf9f66776?s=128&d=identicon&r=PG", "display_name": "Yury Schkatula", "link": "https://stackoverflow.com/users/1964969/yury-schkatula"}, "edited": false, "score": 0, "creation_date": 1527094439, "post_id": 50493607, "comment_id": 88000274, "body": "&quot;Double&quot; - you mean pointer to next and prev items? or what?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8521916"}, "reply_to_user": {"reputation": 4625, "user_id": 1964969, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0879c1954a7ee8660f80eafdf9f66776?s=128&d=identicon&r=PG", "display_name": "Yury Schkatula", "link": "https://stackoverflow.com/users/1964969/yury-schkatula"}, "edited": false, "score": 0, "creation_date": 1527094476, "post_id": 50493607, "comment_id": 88000293, "body": "@YurySchkatula No, I mean pointers to pointers."}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1527094721, "post_id": 50493607, "comment_id": 88000405, "body": "You mean where they pass something in as a pointer so they can update it rather than use the return value?"}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1527094723, "post_id": 50493607, "comment_id": 88000406, "body": "Because they make the code simpler, and avoid the head-node boilerplate. Note: there is an &#39;*&#39; missing here: <code>SListNode* (*push_front)(SList);</code>"}], "answers": [{"tags": [], "owner": {"reputation": 1458, "user_id": 3643303, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/sIpdl.jpg?s=128&g=1", "display_name": "Amber Beriwal", "link": "https://stackoverflow.com/users/3643303/amber-beriwal"}, "is_accepted": true, "score": 0, "last_activity_date": 1527096055, "creation_date": 1527096055, "answer_id": 50494115, "question_id": 50493607, "link": "https://stackoverflow.com/questions/50493607/double-pointers-when-working-with-linked-data-structures-in-c/50494115#50494115", "title": "Double pointers when working with linked data structures in C", "body": "<p>This is a matter of \"how are we designing our solution\" and \"how does we want others to access the libraries\".</p>\n\n<p>This specific problem could be considered as an \"Abstraction\" problem. Generally, abstraction is considered in OOPS concepts, but it is also part of Procedural programming like C. In C language, abstraction can be obtained to some level using <code>static</code> keyword.</p>\n\n<p>Here, there is no right or wrong. We could provide a wrapper so that it is more abstract to access the list and only data is to be considered, but it will also add the complexity of maintaining the wrappers. Also, as C does not support generics, so you will need different wrapper/structures for different data types, OR, you will need to make the data storage as a void* and keep a type for the list.</p>\n\n<p>So, adding a wrapper makes the list usage simple for its users, but it would be complex and error-prone to maintain it at developers level.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user8521916"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 50494115, "answer_count": 1, "score": 0, "last_activity_date": 1527096055, "creation_date": 1527094129, "last_edit_date": 1527094961, "question_id": 50493607, "link": "https://stackoverflow.com/questions/50493607/double-pointers-when-working-with-linked-data-structures-in-c", "title": "Double pointers when working with linked data structures in C", "body": "<p>I am new to C, practicing implementations of some common data structures. Can you explain why double pointers are preferred when doing list operations (e.g. <code>push_front</code>), as opposed to having an <code>SList</code> wrapper that contains a reference to <code>head</code>, as well as the <code>size</code> of the list, i.e. the Java way shown below.</p>\n\n<pre><code>typedef\nstruct SListNode\n{\n    int value;\n    struct SListNode* next;\n} SListNode;\n\ntypedef\nstruct SList\n{\n    /* Private members */\n    int size;\n    SListNode* head;\n} SList;\n\n/* API */\ntypedef\nstruct SListInterface\n{   \n    int (*get_size)(SList*);\n    bool (*empty)(SList*);\n    SListNode* (*push_front)(SList*);\n} SListInterface;\n\n/* API Implementation */\nint \nget_size(SList* list)\n{\n    return list-&gt;size;\n}\n\nbool\nempty(SList* list)\n{\n    return list-&gt;head == NULL;\n}\n\nSListNode*\npush_front(int value, SList* list)\n{\n    SListNode* node = (SListNode*) malloc(sizeof(SListNode));\n    node-&gt;value = value;\n    node-&gt;next = list-&gt;head;\n    list-&gt;head = node;\n    list-&gt;size++;\n}\n\nSList* \nList(void)\n{\n    SList* list = (SList*) malloc(sizeof(SList));\n    list-&gt;size = 0;\n    list-&gt;head = NULL;\n\n    return list;\n}\n\nSListInterface*\nInterface(void)\n{\n    SListInterface* interface = (SListInterface*) malloc(sizeof(SListInterface));\n    interface-&gt;get_size = get_size;\n    interface-&gt;is_empty = is_empty;\n\n    return interface;\n}\n</code></pre>\n"}, {"tags": ["c", "assembly", "stack-frame"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1527093790, "post_id": 50493372, "comment_id": 87999938, "body": "Regarding the latter, the run-time loader invokes <code>main</code> after it does its preamble work. You compiled <i>your</i> source file to assembly  with your <code>main</code>. If you have the source to your run-time library, you can peruse it to find how and where <i>it</i> actually invokes the <code>main</code> you provided."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 2, "creation_date": 1527094391, "post_id": 50493372, "comment_id": 88000248, "body": "This appears to be unoptimized code; if you turn optimization on the code may become much shorter and easier to understand. Anyway, the stack adjustment on exit is performed by the <code>leave</code> instruction."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1527095604, "post_id": 50493372, "comment_id": 88000832, "body": "@zwol: The <code>leave</code> in this example does not restore the original stack pointer. It \u201crestores\u201d a value written to <code>%ebp</code> after modifying the stack pointer."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 1, "creation_date": 1527096143, "post_id": 50493372, "comment_id": 88001122, "body": "@EricPostpischil Yeah, I guess I didn&#39;t read it closely enough.  The true restoration of the original stack pointer is done by the <code>leal -4(%ecx),%esp</code> right before <code>ret</code>, as you say in your answer.  But the <code>leave</code> balances the <code>push %ebp; mov %esp,%ebp</code> at the top, and it&#39;s necessary because EBP is call-saved, and OP needs to understand that <code>leave</code> restores EBP and undoes any stack adjustments after the last time EBP was set, in particular, the <code>subl $20,%esp</code> that they are confused about is undone by the <code>leave</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8862019"}, "edited": false, "score": 0, "creation_date": 1527097282, "post_id": 50493372, "comment_id": 88001667, "body": "I just googled and leave is the same as move ebp, esp pop ebp so that now I understand thank you"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8862019"}, "edited": false, "score": 0, "creation_date": 1527094834, "post_id": 50493719, "comment_id": 88000464, "body": "but why add 4 when 20 was subtracted?"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 1, "creation_date": 1527095370, "post_id": 50493719, "comment_id": 88000709, "body": "@momonosuke: At rhe moment the routine is entered, four plus the stack pointer is just above the return address that was pushed onto the stack by the call instruction. Thus, it is the value the stack pointer had at the moment the caller executed to the call. This value could be useful for addressing arguments the caller put on the stack. Ntoice the <code>andl</code> instruction. That aligns the stack pointer to a multiple of 16 bytes, as needed to conform to the ABI. That changes the stack pointer by a variable number of bytes, so you cannot undo it by adding a fized number."}], "tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": true, "score": 2, "last_activity_date": 1527094564, "creation_date": 1527094564, "answer_id": 50493719, "question_id": 50493372, "link": "https://stackoverflow.com/questions/50493372/stackframe-dosent-get-eliminated-from-the-stack/50493719#50493719", "title": "stackframe dosen&#39;t get eliminated from the stack?", "body": "<p>Just after the <code>main</code> label, <code>leal 4(%esp), %ecx</code> saves four plus the stack pointer in <code>%ecx</code>. At the end of the routine, <code>leal -4(%ecx), %esp</code> writes four less than the saved value to the stack pointer. This directly restores the original value, instead of doing it by adding the amount that was subtracted.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user8862019"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 50493719, "answer_count": 1, "score": 0, "last_activity_date": 1527094968, "creation_date": 1527093214, "question_id": 50493372, "link": "https://stackoverflow.com/questions/50493372/stackframe-dosent-get-eliminated-from-the-stack", "title": "stackframe dosen&#39;t get eliminated from the stack?", "body": "<p>I wrote a single c program that prints input to std output. Then I converted it to assembly language. By the way I am using AT&amp;T Syntax.</p>\n\n<p>This is the simple C code.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n\nint c; \n\n\n  while ((c = getchar ()) != EOF) \n    {\n\n    putchar(c);\n\n}\n\n    return 0;\n}\n</code></pre>\n\n<p>int c is a local variable.</p>\n\n<p>Then I converted it to assembly language.</p>\n\n<pre><code>.file   \"question_1.c\"\n    .text\n    .globl  main\n    .type   main, @function \n\n//prolog\n\nmain:\n    leal    4(%esp), %ecx\n    andl    $-16, %esp\n    pushl   -4(%ecx)\n    pushl   %ebp\n    movl    %esp, %ebp\n    pushl   %ecx\n    subl    $20, %esp    // we add 20 bytes to the stack\n    jmp .L2\n.L3:\n    subl    $12, %esp\n    pushl   -12(%ebp)\n    call    putchar\n    addl    $16, %esp\n.L2:\n    call    getchar\n    movl    %eax, -12(%ebp)\n    cmpl    $-1, -12(%ebp)\n    jne .L3\n\n//assumption this is the epilog\n    movl    $0, %eax\n    movl    -4(%ebp), %ecx\n    leave\n    leal    -4(%ecx), %esp\n    ret\n    .size   main, .-main\n    .ident  \"GCC: (Ubuntu 4.9.4-2ubuntu1) 4.9.4\"\n    .section    .note.GNU-stack,\"\",@progbits\n</code></pre>\n\n<p>normally in the epilog we are supposed to addl 20 because in the prolog we subl 20. \nSo the is the stack frame still there?\nOr am I missing out a crucial point?</p>\n\n<p>I also have a question regarding the main function. Normally functions are normally \"called\" but where does it happen in the assembly code?</p>\n\n<p>Thank you in advance.</p>\n"}, {"tags": ["c", "pointers", "dynamic-memory-allocation"], "comments": [{"owner": {"reputation": 1984, "user_id": 4337151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dD0ri.jpg?s=128&g=1", "display_name": "dehasi", "link": "https://stackoverflow.com/users/4337151/dehasi"}, "edited": false, "score": 1, "creation_date": 1527092651, "post_id": 50493118, "comment_id": 87999317, "body": "try just ` array = (int <b>*)malloc(n1</b>n2*n3*sizeof(int **));`"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 6, "creation_date": 1527092660, "post_id": 50493118, "comment_id": 87999321, "body": "You will need another loop for assigning <code>array[i]</code>, before assigning <code>array[i][j]</code>."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1527094608, "post_id": 50493118, "comment_id": 88000353, "body": "Being C, you <i>can</i> do this using VLA addressing and a single allocation (assuming your toolchain actually supports it, you&#39;re SOL if using an MS tool set). So I&#39;m not sure whether that&#39;s an option for you or not."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1527096291, "post_id": 50493118, "comment_id": 88001178, "body": "Do not cast the return of <code>malloc</code>, it is unnecessary. See: <a href=\"http://stackoverflow.com/q/605845/995714\"><b>Do I cast the result of malloc?</b></a>"}], "answers": [{"comments": [{"owner": {"reputation": 379, "user_id": 1991502, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/1883e91ac7aca1b3b90581ba0c70b521?s=128&d=identicon&r=PG", "display_name": "DJames", "link": "https://stackoverflow.com/users/1991502/djames"}, "edited": false, "score": 0, "creation_date": 1527093711, "post_id": 50493463, "comment_id": 87999899, "body": "I don&#39;t think the memory would be contiguous in this example, as you are mallocing n1*n2 separate chunks of memory"}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "reply_to_user": {"reputation": 379, "user_id": 1991502, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/1883e91ac7aca1b3b90581ba0c70b521?s=128&d=identicon&r=PG", "display_name": "DJames", "link": "https://stackoverflow.com/users/1991502/djames"}, "edited": false, "score": 1, "creation_date": 1527093909, "post_id": 50493463, "comment_id": 87999998, "body": "@DJames your suspicions of discontinuity are well-founded. As soon as you introduce more than one <code>malloc</code> continuity goes out the window. This answer does not provide a single contiguous region (and neither does any of your posted code)."}, {"owner": {"reputation": 198, "user_id": 9317706, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd96f97c58b306523bb8defb014daab6?s=128&d=identicon&r=PG&f=1", "display_name": "purec", "link": "https://stackoverflow.com/users/9317706/purec"}, "reply_to_user": {"reputation": 379, "user_id": 1991502, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/1883e91ac7aca1b3b90581ba0c70b521?s=128&d=identicon&r=PG", "display_name": "DJames", "link": "https://stackoverflow.com/users/1991502/djames"}, "edited": false, "score": 0, "creation_date": 1527094075, "post_id": 50493463, "comment_id": 88000084, "body": "@DJames  True. But you can use indices."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1527094244, "post_id": 50493463, "comment_id": 88000177, "body": "@WhozCraig: Well, this <code>array[0] = (int *)malloc(n1*n2*sizeof(int));</code> allocates a <i>continues</i> region of memory which holds <i>all</i> <code>int</code>s of the &quot;2D&quot;-array."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "reply_to_user": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1527094525, "post_id": 50493463, "comment_id": 88000315, "body": "@alk Of <i>that</i> array of arrays, but there are more than one (thus the loops). The backdrop of this, therefore, cannot be similar to <code>int arr[a][b][c];</code>, but you already knew that."}], "tags": [], "owner": {"reputation": 198, "user_id": 9317706, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd96f97c58b306523bb8defb014daab6?s=128&d=identicon&r=PG&f=1", "display_name": "purec", "link": "https://stackoverflow.com/users/9317706/purec"}, "is_accepted": false, "score": -1, "last_activity_date": 1527093581, "creation_date": 1527093581, "answer_id": 50493463, "question_id": 50493118, "link": "https://stackoverflow.com/questions/50493118/attempting-to-allocate-a-contiguous-memory-block-and-access-it-using-3-indices/50493463#50493463", "title": "Attempting to allocate a contiguous memory block and access it using 3 indices, but my method segfaults", "body": "<p>Allocating memory for 3D array.\nMaybe I did something wrong, but seems ok.</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n\nint\nmain () {\n int n1 = 2;\n int n2 = 3;\n int n3 = 4;\n int i, j;\n\n int ***array;\n\n array = malloc(n1 * sizeof(int**));\n\n for (i = 0; i &lt; n1; i++)\n    array[i] = malloc(n2 * sizeof(int*));\n\n for (i = 0; i &lt; n1; i++)\n for (j = 0; j &lt; n2; j++)\n    array[i][j] = malloc(n3 * sizeof(int));\n\n\n array[1][2][3] = 15000;\n printf(\"%d\\n\", array[1][2][3]);\n\nreturn 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1527095980, "post_id": 50493957, "comment_id": 88001039, "body": "Do not cast the return of <code>malloc</code>, it is unnecessary. See: <a href=\"http://stackoverflow.com/q/605845/995714\"><b>Do I cast the result of malloc?</b></a>"}], "tags": [], "owner": {"reputation": 2412, "user_id": 1191058, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/09eeee14385ba75f18adb473ccffe208?s=128&d=identicon&r=PG", "display_name": "j123b567", "link": "https://stackoverflow.com/users/1191058/j123b567"}, "is_accepted": true, "score": 1, "last_activity_date": 1527095492, "creation_date": 1527095492, "answer_id": 50493957, "question_id": 50493118, "link": "https://stackoverflow.com/questions/50493118/attempting-to-allocate-a-contiguous-memory-block-and-access-it-using-3-indices/50493957#50493957", "title": "Attempting to allocate a contiguous memory block and access it using 3 indices, but my method segfaults", "body": "<p>You are probably missing </p>\n\n<pre><code>array[i] = array[0] + i*n2;\n</code></pre>\n\n<p>Here is your code</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n\nint main() {\n\n    // Dimensions\n    const int n1 = 2;\n    const int n2 = 2;\n    const int n3 = 2;\n\n    int ***array;\n\n    // Pointers\n    array = (int ***)malloc(n1*sizeof(int **));\n    array[0] = (int **)malloc(n1*n2*sizeof(int *));\n\n    // Contiguous chunk of memory of size n1xn2xn3\n    array[0][0] = (int *)malloc(n1*n2*n3*sizeof(int));\n\n    // Pointer arithmetic\n    for(int i=0;i&lt;n1;i++) {\n        array[i] = array[0] + i*n2;\n        for(int j=0;j&lt;n2;j++) {\n            array[i][j] = array[0][0] + i*n2*n3 + j*n2;\n        }\n    }\n\n    array[0][0][0] = 1;\n\n    return EXIT_SUCCESS;\n}\n</code></pre>\n"}], "owner": {"reputation": 379, "user_id": 1991502, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/1883e91ac7aca1b3b90581ba0c70b521?s=128&d=identicon&r=PG", "display_name": "DJames", "link": "https://stackoverflow.com/users/1991502/djames"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 50493957, "answer_count": 2, "score": 0, "last_activity_date": 1527095492, "creation_date": 1527092318, "question_id": 50493118, "link": "https://stackoverflow.com/questions/50493118/attempting-to-allocate-a-contiguous-memory-block-and-access-it-using-3-indices", "title": "Attempting to allocate a contiguous memory block and access it using 3 indices, but my method segfaults", "body": "<p>I am attempting to write a procedure that lets me allocate a contiguous block of memory of size n1*n2*n3 and access it using 3 indices, like you would with an array</p>\n\n<pre><code>int array[n1][n2][n3];\n</code></pre>\n\n<p>I have successfully (as far as I can tell) managed this with two indices (see my example below)</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n\nint main() {\n\n    // Dimensions\n    const int n1 = 2;\n    const int n2 = 2;\n\n    int **array;\n\n    // Pointers\n    array = (int **)malloc(n1*sizeof(int *));\n\n    // Contiguous chunk of memory of size n1xn2\n    array[0] = (int *)malloc(n1*n2*sizeof(int));\n\n    // Pointer arithmetic\n    for(int i=0;i&lt;n1;i++) {\n        array[i] = array[0] + i*n2;\n    }\n\n    array[0][0] = 1;\n\n    return EXIT_SUCCESS;\n}\n</code></pre>\n\n<p>But when I try a similar construct with three indices, my procedure throws a segfault:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n\nint main() {\n\n    // Dimensions\n    const int n1 = 2;\n    const int n2 = 2;\n    const int n3 = 2;\n\n    int ***array;\n\n    // Pointers\n    array = (int ***)malloc(n1*sizeof(int **));\n    array[0] = (int **)malloc(n1*n2*sizeof(int *));\n\n    // Contiguous chunk of memory of size n1xn2xn3\n    array[0][0] = (int *)malloc(n1*n2*n3*sizeof(int));\n\n    // Pointer arithmetic\n    for(int i=0;i&lt;n1;i++) {\n        for(int j=0;j&lt;n2;j++) {\n            array[i][j] = array[0][0] + i*n2*n3 + j*n2;\n        }\n    }\n\n    array[0][0][0] = 1;\n\n    return EXIT_SUCCESS;\n}\n</code></pre>\n\n<p>I understand there are other ways to manage a contiguous block of memory. I am specifically interested in why my logic is failing in the above case.</p>\n"}, {"tags": ["c++", "c", "makefile", "shared-libraries", "gnu"], "comments": [{"owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "edited": false, "score": 1, "creation_date": 1527092939, "post_id": 50493108, "comment_id": 87999480, "body": "Have you added your libyaml location to <code>LD_LIBRARY_PATH</code>?"}, {"owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "edited": false, "score": 0, "creation_date": 1527094334, "post_id": 50493108, "comment_id": 88000219, "body": "I dislike how people come, ask incomplete questions, and then leave..."}, {"owner": {"reputation": 26689, "user_id": 5769463, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/71a28b5fac23ee656a32cc7ea6df54ec?s=128&d=identicon&r=PG&f=1", "display_name": "ead", "link": "https://stackoverflow.com/users/5769463/ead"}, "edited": false, "score": 0, "creation_date": 1527096649, "post_id": 50493108, "comment_id": 88001337, "body": "There are so many ways the linking could go wrong. without being able to reproduce we can only guess."}, {"owner": {"reputation": 37, "user_id": 4908929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/270be1d222ba1a39ebd937df33307873?s=128&d=identicon&r=PG&f=1", "display_name": "Pankaj", "link": "https://stackoverflow.com/users/4908929/pankaj"}, "reply_to_user": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "edited": false, "score": 0, "creation_date": 1527183283, "post_id": 50493108, "comment_id": 88042723, "body": "@YSC Yes I have added that."}], "answers": [{"tags": [], "owner": {"reputation": 37, "user_id": 4908929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/270be1d222ba1a39ebd937df33307873?s=128&d=identicon&r=PG&f=1", "display_name": "Pankaj", "link": "https://stackoverflow.com/users/4908929/pankaj"}, "is_accepted": false, "score": 1, "last_activity_date": 1527183601, "creation_date": 1527183601, "answer_id": 50515207, "question_id": 50493108, "link": "https://stackoverflow.com/questions/50493108/linking-shared-library-dependency-not-being-listing-in-ldd/50515207#50515207", "title": "Linking shared library dependency not being listing in ldd", "body": "<p>The one approach which I found is disabling optimization using the gcc flag  -Wl,--no-as-needed. Since I am already linking using -lyaml, symbols are getting resolved. It works but not efficient.</p>\n"}], "owner": {"reputation": 37, "user_id": 4908929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/270be1d222ba1a39ebd937df33307873?s=128&d=identicon&r=PG&f=1", "display_name": "Pankaj", "link": "https://stackoverflow.com/users/4908929/pankaj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 696, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1527183601, "creation_date": 1527092274, "last_edit_date": 1527092663, "question_id": 50493108, "link": "https://stackoverflow.com/questions/50493108/linking-shared-library-dependency-not-being-listing-in-ldd", "title": "Linking shared library dependency not being listing in ldd", "body": "<p>There is library which is compiled against -lyaml. But libyaml.so is not getting listed as dependency by ldd. Build is happening successfully using autoconf tool chain. </p>\n\n<pre><code>$ nm libxxxx.so | grep -i yaml\n U yaml_document_delete\n U yaml_document_get_node\n U yaml_parser_delete\n U yaml_parser_initialize\n U yaml_parser_load\n U yaml_parser_set_input_file\n\n\n$ readelf -d libxxxx.so\n    Tag        Type                         Name/Value\n    0x0000000000000001 (NEEDED)             Shared library: [libc.so.6]\n    0x000000000000000e (SONAME)             Library soname: [libxxxx.so.0] \n</code></pre>\n\n<p>There is another shared library which depends depend upon libxxxx.so. </p>\n\n<pre><code>$ ldd  lib/libxxxx1.so\n    libzmq.so.5 =&gt; /usr/lib/x86_64-linux-gnu/libzmq.so.5 (0x00007fd45e072000)\n    libxmaapi.so.0 =&gt; \n</code></pre>\n\n<p>When I am linking my executable with libxxxx1.so, it is giving undefined symbols error. The question is how do I link against library not found in dependency tree? </p>\n\n<p>This question provides approaches to ignore the problem.\n<a href=\"https://stackoverflow.com/questions/11055569/linking-with-dynamic-library-with-dependencies\">Linking with dynamic library with dependencies</a></p>\n"}, {"tags": ["c", "string", "memory", "buffer", "buffer-overflow"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 5, "creation_date": 1527091744, "post_id": 50492965, "comment_id": 87998831, "body": "The C people do not like explaining behavior which is undefined."}, {"owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 1, "creation_date": 1527091758, "post_id": 50492965, "comment_id": 87998842, "body": "Check the generated assembly."}, {"owner": {"reputation": 1651, "user_id": 635822, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fd51a3c79639c315af5864adc731298?s=128&d=identicon&r=PG", "display_name": "Jason", "link": "https://stackoverflow.com/users/635822/jason"}, "edited": false, "score": 0, "creation_date": 1527091874, "post_id": 50492965, "comment_id": 87998913, "body": "It is undefined behavior in either case."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 1, "creation_date": 1527091894, "post_id": 50492965, "comment_id": 87998920, "body": "Undefined behavior is undefined.  Don&#39;t try to make too much sense of it."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1527092309, "post_id": 50492965, "comment_id": 87999136, "body": "For some architectures the variables are stored on the stack with descending addresses. In that case you might expect <code>x</code> to be in wrong position. But as already mentioned this is totally undefined behaviour which might or might not do what you want it to do."}, {"owner": {"reputation": 33, "user_id": 9835660, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Wes Weitzel", "link": "https://stackoverflow.com/users/9835660/wes-weitzel"}, "reply_to_user": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 0, "creation_date": 1527093681, "post_id": 50492965, "comment_id": 87999884, "body": "@tkausl assembly has been added"}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 1, "creation_date": 1527093794, "post_id": 50492965, "comment_id": 87999943, "body": "If you look at the assembly (or even your output), you&#39;ll see that the order of the variables <code>x</code> and <code>str</code> differs in the two programs. The compiler can place local variables in any arbitrary order, and the algorithm it uses can be totally opaque. But my guess is that the difference here has more to do with the fact that you take the address of <code>x</code> in the second one, thereby forcing it to have an address. If you compiled with optimisation, you&#39;d probably find that <code>x</code> in the first program doesn&#39;t actually exist in memory; it xan simply live in a register (or be eliminated altogether)."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1527097298, "post_id": 50492965, "comment_id": 88001674, "body": "Yes, I know. I said that <i>if you compiled with optimisation</i>, it would probably only live in a register. That indeed means that it could not be overwritten."}], "answers": [{"tags": [], "owner": {"reputation": 4217, "user_id": 9614249, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eJfci.png?s=128&g=1", "display_name": "Increasingly Idiotic", "link": "https://stackoverflow.com/users/9614249/increasingly-idiotic"}, "is_accepted": true, "score": 2, "last_activity_date": 1527099324, "creation_date": 1527099324, "answer_id": 50494909, "question_id": 50492965, "link": "https://stackoverflow.com/questions/50492965/printf-affecting-buffer-overflow-situation/50494909#50494909", "title": "printf() affecting buffer overflow situation", "body": "<p>First lets look at why a buffer overflow <strong>did not</strong> happen in the second example.</p>\n\n<p>Looking at your output:</p>\n\n<pre><code>0061FF2A: Testt\nX\n0061FF2A: Hello world\n0061FF29: X\n</code></pre>\n\n<p>We can see that <code>str</code> is <strong>above</strong> <code>x</code> on the stack.</p>\n\n<p>The string <code>\"Hello world\"</code> is taking up memory addresses <code>0061FF2A</code> through <code>0061FF36</code></p>\n\n<p>The stack looks something like</p>\n\n<pre><code>0061FF29   0061FF2A        0061FF36\n       |   |                      |\n       ----------------------------\n       | X | H e l l o  w o r l d |\n       ----------------------------\n</code></pre>\n\n<p>In this case it doesn't matter how far past the end of <code>str</code> we write because <code>x</code> comes before <code>str</code> on the stack.</p>\n\n<hr>\n\n<p>Next lets look at why a buffer overflow <strong>did</strong> happen in the first example.</p>\n\n<p>We can't see the addresses of each variable directly in your output <em>however</em> we can see their locations on the stack in the assembly.</p>\n\n<pre><code>movl    $1953719636, 25(%esp)\nmovw    $116, 29(%esp)\nmovb    $88, 31(%esp)\n</code></pre>\n\n<p>The <code>x</code> variable is definitely at <code>31(%esp)</code> as we see the decimal <a href=\"https://www.asciitable.com/\" rel=\"nofollow noreferrer\">ASCII</a> value for <code>'X'</code> being placed there.</p>\n\n<p>It is not too big of a leap to assume that the 5 character string <code>\"Testt\"</code> is being stored at <code>25(%esp)</code> as the distance between  <code>25(%esp)</code> and <code>31(%esp)</code> is just enough to store 5 characters and a null terminator.</p>\n\n<p>So we know <code>str</code> is at <code>25(%esp)</code> and <code>x</code> is at <code>31(%esp)</code>. The stack should look something like:</p>\n\n<pre><code>esp  +25         +31\n  |    |           | \n  ---------------------- \n  |    | T e s t t | X |\n  ----------------------\n</code></pre>\n\n<p>Now we can easily see that <code>str</code> comes before <code>x</code> and it is clear to see why writing past the end of <code>str</code> would cause <code>x</code> to be overwritten.</p>\n\n<hr>\n\n<p>Now the main question, <strong>Why did this work in the first case but not the second?</strong></p>\n\n<p>For some reason the compiler decided to place <code>x</code> after <code>str</code> in the first example and <code>x</code> before <code>str</code> in the second example.</p>\n\n<p>As was pointed out in the comments, the exact location of local variables on the stack is not defined by C. The compiler can decide the order it wants things stored in and may change that order from program to program for non-obvious reasons.</p>\n\n<p>Essentially, the exact location and ordering of local variables on the stack is undefined, and so undefined behavior is why the buffer overflow works in one case but not the other.</p>\n"}], "owner": {"reputation": 33, "user_id": 9835660, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Wes Weitzel", "link": "https://stackoverflow.com/users/9835660/wes-weitzel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1158, "favorite_count": 0, "accepted_answer_id": 50494909, "answer_count": 1, "score": 3, "last_activity_date": 1575909313, "creation_date": 1527091684, "last_edit_date": 1575909313, "question_id": 50492965, "link": "https://stackoverflow.com/questions/50492965/printf-affecting-buffer-overflow-situation", "title": "printf() affecting buffer overflow situation", "body": "<p>I have a simple program that initializes a c style string and then initializes a character. I then use the function <code>strcpy</code> to cause a buffer overflow situation which would seemingly overwrite the memory content of the character variable <code>x</code> (assuming it is stored in adjacent memory).</p>\n\n<pre><code>char str[] = \"Testt\";\nchar x = 'X';\n\n// print address and value of str\nprintf(\"%p: \", &amp;str);\nprintf(\"%s\\n\", str);\n\n// print value of x\nprintf(\"%c\\n\", x);\n\n// cause buffer overflow\nstrcpy(str, \"Hello world\");\n\n// print address and value of str\nprintf(\"%p: \", &amp;str);\nprintf(\"%s\\n\", str);\n\n// print address and value of x\n// printf(\"%p: \", &amp;x);\nprintf(\"%c\\n\", x);\nreturn 0;\n</code></pre>\n\n<p>When run, this code produces output that looks like</p>\n\n<pre><code>0061FF29: Testt\nX\n0061FF29: Hello world\nw\n</code></pre>\n\n<p>This situation shows that the buffer overflow did occur, and it caused the value of the <code>x</code> variable to change from <code>'X'</code> to <code>'w'</code>.</p>\n\n<p>However, if I remove the commented <code>// printf(\"%p: \", &amp;x);</code> on the third to last line, the buffer overflow does not cause the <code>x</code> variable to be overwritten.</p>\n\n<p>For clarity here is that code (notice the change on the third to last line)</p>\n\n<pre><code>char str[] = \"Testt\";\nchar x = 'X';\n\n// print address and value of str\nprintf(\"%p: \", &amp;str);\nprintf(\"%s\\n\", str);\n\n// print value of x\nprintf(\"%c\\n\", x);\n\n// cause buffer overflow\nstrcpy(str, \"Hello world\");\n\n// print address and value of str\nprintf(\"%p: \", &amp;str);\nprintf(\"%s\\n\", str);\n\n// print address and value of x\nprintf(\"%p: \", &amp;x);\nprintf(\"%c\\n\", x);\nreturn 0;\n</code></pre>\n\n<p>This causes the output to be:</p>\n\n<pre><code>0061FF2A: Testt\nX\n0061FF2A: Hello world\n0061FF29: X\n</code></pre>\n\n<p>So in this situation, the buffer overflow did not overwrite the <code>x</code> variable. </p>\n\n<p><strong>Why does simply printing the memory address of the <code>x</code> variable have this affect on the buffer overflow situation?</strong></p>\n\n<p>edit: added in assembly for the two situations\nThe generated assembly for the first case (no printf):</p>\n\n<pre><code>    .file   \"hello.c\"\n    .def    ___main;    .scl    2;  .type   32; .endef\n    .section .rdata,\"dr\"\nLC0:\n    .ascii \"%p: \\0\"\nLC1:\n    .ascii \"%c\\12\\0\"\n    .text\n    .globl  _main\n    .def    _main;  .scl    2;  .type   32; .endef\n_main:\nLFB17:\n    .cfi_startproc\n    pushl   %ebp\n    .cfi_def_cfa_offset 8\n    .cfi_offset 5, -8\n    movl    %esp, %ebp\n    .cfi_def_cfa_register 5\n    andl    $-16, %esp\n    subl    $32, %esp\n    call    ___main\n    movl    $1953719636, 25(%esp)\n    movw    $116, 29(%esp)\n    movb    $88, 31(%esp)\n    leal    25(%esp), %eax\n    movl    %eax, 4(%esp)\n    movl    $LC0, (%esp)\n    call    _printf\n    leal    25(%esp), %eax\n    movl    %eax, (%esp)\n    call    _puts\n    movsbl  31(%esp), %eax\n    movl    %eax, 4(%esp)\n    movl    $LC1, (%esp)\n    call    _printf\n    leal    25(%esp), %eax\n    movl    $1819043144, (%eax)\n    movl    $1870078063, 4(%eax)\n    movl    $6581362, 8(%eax)\n    leal    25(%esp), %eax\n    movl    %eax, 4(%esp)\n    movl    $LC0, (%esp)\n    call    _printf\n    leal    25(%esp), %eax\n    movl    %eax, (%esp)\n    call    _puts\n    movsbl  31(%esp), %eax\n    movl    %eax, 4(%esp)\n    movl    $LC1, (%esp)\n    call    _printf\n    movl    $0, %eax\n    leave\n    .cfi_restore 5\n    .cfi_def_cfa 4, 4\n    ret\n    .cfi_endproc\nLFE17:\n    .ident  \"GCC: (MinGW.org GCC-6.3.0-1) 6.3.0\"\n    .def    _printf;    .scl    2;  .type   32; .endef\n    .def    _puts;  .scl    2;  .type   32; .endef\n</code></pre>\n\n<p>and for the second situation</p>\n\n<pre><code>    .file   \"hello.c\"\n    .def    ___main;    .scl    2;  .type   32; .endef\n    .section .rdata,\"dr\"\nLC0:\n    .ascii \"%p: \\0\"\nLC1:\n    .ascii \"%c\\12\\0\"\n    .text\n    .globl  _main\n    .def    _main;  .scl    2;  .type   32; .endef\n_main:\nLFB17:\n    .cfi_startproc\n    pushl   %ebp\n    .cfi_def_cfa_offset 8\n    .cfi_offset 5, -8\n    movl    %esp, %ebp\n    .cfi_def_cfa_register 5\n    andl    $-16, %esp\n    subl    $32, %esp\n    call    ___main\n    movl    $1953719636, 26(%esp)\n    movw    $116, 30(%esp)\n    movb    $88, 25(%esp)\n    leal    26(%esp), %eax\n    movl    %eax, 4(%esp)\n    movl    $LC0, (%esp)\n    call    _printf\n    leal    26(%esp), %eax\n    movl    %eax, (%esp)\n    call    _puts\n    movzbl  25(%esp), %eax\n    movsbl  %al, %eax\n    movl    %eax, 4(%esp)\n    movl    $LC1, (%esp)\n    call    _printf\n    leal    26(%esp), %eax\n    movl    $1819043144, (%eax)\n    movl    $1870078063, 4(%eax)\n    movl    $6581362, 8(%eax)\n    leal    26(%esp), %eax\n    movl    %eax, 4(%esp)\n    movl    $LC0, (%esp)\n    call    _printf\n    leal    26(%esp), %eax\n    movl    %eax, (%esp)\n    call    _puts\n    leal    25(%esp), %eax\n    movl    %eax, 4(%esp)\n    movl    $LC0, (%esp)\n    call    _printf\n    movzbl  25(%esp), %eax\n    movsbl  %al, %eax\n    movl    %eax, 4(%esp)\n    movl    $LC1, (%esp)\n    call    _printf\n    movl    $0, %eax\n    leave\n    .cfi_restore 5\n    .cfi_def_cfa 4, 4\n    ret\n    .cfi_endproc\nLFE17:\n    .ident  \"GCC: (MinGW.org GCC-6.3.0-1) 6.3.0\"\n    .def    _printf;    .scl    2;  .type   32; .endef\n    .def    _puts;  .scl    2;  .type   32; .endef\n</code></pre>\n"}, {"tags": ["c++", "sql", "c", "database", "sqlite"], "comments": [{"owner": {"reputation": 627, "user_id": 1976388, "user_type": "registered", "profile_image": "https://graph.facebook.com/771700761/picture?type=large", "display_name": "Rajat Jaiswal", "link": "https://stackoverflow.com/users/1976388/rajat-jaiswal"}, "edited": false, "score": 0, "creation_date": 1527091610, "post_id": 50492892, "comment_id": 87998761, "body": "Use Count  SELECT COUNT(ORDER_STATUS) As Counter FROM REPAIR WHERE ORDER_STATUS = &#39;Waiting for client&#39;&quot;"}, {"owner": {"reputation": 4533, "user_id": 2504757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ef5b308d33027fab8440d223828fe4c?s=128&d=identicon&r=PG", "display_name": "Robert Andrzejuk", "link": "https://stackoverflow.com/users/2504757/robert-andrzejuk"}, "edited": false, "score": 0, "creation_date": 1527091614, "post_id": 50492892, "comment_id": 87998764, "body": "Did you search the web : <a href=\"https://www.tutorialspoint.com/sqlite/sqlite_c_cpp.htm\" rel=\"nofollow noreferrer\">tutorialspoint.com/sqlite/sqlite_c_cpp.htm</a>?"}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 4, "creation_date": 1527091621, "post_id": 50492892, "comment_id": 87998768, "body": "Your &quot;query&quot; is currently just a C-string. you should probably have a query object somewhere."}, {"owner": {"reputation": 11, "user_id": 9835697, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-j4q7kHBUnO4/AAAAAAAAAAI/AAAAAAAAAwA/jT-h4d4GvO8/photo.jpg?sz=128", "display_name": "PyQ", "link": "https://stackoverflow.com/users/9835697/pyq"}, "reply_to_user": {"reputation": 627, "user_id": 1976388, "user_type": "registered", "profile_image": "https://graph.facebook.com/771700761/picture?type=large", "display_name": "Rajat Jaiswal", "link": "https://stackoverflow.com/users/1976388/rajat-jaiswal"}, "edited": false, "score": 0, "creation_date": 1527098007, "post_id": 50492892, "comment_id": 88002006, "body": "Thanks @RajatJaiswal. I&#39;ve used your idea and changed some lines in callback and it works."}, {"owner": {"reputation": 627, "user_id": 1976388, "user_type": "registered", "profile_image": "https://graph.facebook.com/771700761/picture?type=large", "display_name": "Rajat Jaiswal", "link": "https://stackoverflow.com/users/1976388/rajat-jaiswal"}, "edited": false, "score": 0, "creation_date": 1527128554, "post_id": 50492892, "comment_id": 88012695, "body": "You are welcome @PyQ"}], "owner": {"reputation": 11, "user_id": 9835697, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-j4q7kHBUnO4/AAAAAAAAAAI/AAAAAAAAAwA/jT-h4d4GvO8/photo.jpg?sz=128", "display_name": "PyQ", "link": "https://stackoverflow.com/users/9835697/pyq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1527091423, "creation_date": 1527091423, "question_id": 50492892, "link": "https://stackoverflow.com/questions/50492892/return-information-about-existing-data-sqlite", "title": "Return information about existing data SQLite", "body": "<p>I want to have information if data exists or not.\nHere is a sample:</p>\n\n<pre><code>if(\"SELECT ORDER_STATUS FROM REPAIR WHERE ORDER_STATUS = 'Waiting for client'\" != NULL) {\n   printf(\"\\nNotification:\");\n   printf(\"\\nThere are unclaimed cars.\");}\n</code></pre>\n\n<p>I know that it doesn't work. SQL commands don't return NULL in this situation. Do you have any ideas how to do it?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "edited": false, "score": 0, "creation_date": 1527091522, "post_id": 50492891, "comment_id": 87998727, "body": "&quot;Which&quot; suggests you have one or more other ways in mind. What do you want to compare against?"}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "reply_to_user": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "edited": false, "score": 0, "creation_date": 1527091550, "post_id": 50492891, "comment_id": 87998736, "body": "@FredLarson probably against the way included in the question."}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "edited": false, "score": 0, "creation_date": 1527092536, "post_id": 50492891, "comment_id": 87999267, "body": "Modulo 65 will be expensive, modulo 64 will be cheap (==equivalent to &amp;63 ). That will give you numbers [0-63], but it won&#39;t give you 63 (or 64) for numbers &gt;=64. It&#39;ll wrap around back to 0. If you&#39;re OK with that, this might be very slightly faster than the if, but I&#39;d expect this to be tight. At least on my machine, if&#39;s aren&#39;t that expensive."}, {"owner": {"reputation": 65414, "user_id": 768469, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/383724e63ab04b146277912c16f27f54?s=128&d=identicon&r=PG", "display_name": "Nemo", "link": "https://stackoverflow.com/users/768469/nemo"}, "edited": false, "score": 3, "creation_date": 1527093044, "post_id": 50492891, "comment_id": 87999548, "body": "This probably compiles into three instructions: one load, one compare, and one conditional move. (Check the assembly for yourself.) You are going to have trouble beating that. If you are doing this sort of thing on many values, vectorizing the code -- whether done by hand or automatically by the compiler -- will make a much bigger difference than any micro-optimization."}, {"owner": {"reputation": 3560, "user_id": 5550963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7jAip.png?s=128&g=1", "display_name": "CEPB", "link": "https://stackoverflow.com/users/5550963/cepb"}, "edited": false, "score": 1, "creation_date": 1527093443, "post_id": 50492891, "comment_id": 87999777, "body": "What problem are you having with this?"}, {"owner": {"reputation": 15724, "user_id": 1716339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/835fc3719b0118c68c4d202b3e5cbf18?s=128&d=identicon&r=PG", "display_name": "Aki Suihkonen", "link": "https://stackoverflow.com/users/1716339/aki-suihkonen"}, "edited": false, "score": 2, "creation_date": 1527093851, "post_id": 50492891, "comment_id": 87999968, "body": "If your target cpu contains <code>min</code> instruction, this will generate one instruction: <code>min.u r0, #64</code>. This is available eg in x86 mmx/sse."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 3, "creation_date": 1527095052, "post_id": 50492891, "comment_id": 88000560, "body": "What type is &#39;len&#39;?"}], "answers": [{"comments": [{"owner": {"reputation": 65414, "user_id": 768469, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/383724e63ab04b146277912c16f27f54?s=128&d=identicon&r=PG", "display_name": "Nemo", "link": "https://stackoverflow.com/users/768469/nemo"}, "edited": false, "score": 3, "creation_date": 1527092741, "post_id": 50492929, "comment_id": 87999356, "body": "Your code doesn&#39;t work for <code>len</code> of 65 (among an infinity of others). Your first sentence is better."}], "tags": [], "owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "is_accepted": false, "score": 4, "last_activity_date": 1527101733, "last_edit_date": 1527101733, "creation_date": 1527091545, "answer_id": 50492929, "question_id": 50492891, "link": "https://stackoverflow.com/questions/50492891/c-fast-way-to-limit-a-number-to-64/50492929#50492929", "title": "C, Fast way to limit a number to &lt;= 64", "body": "<p><strong>Don't bother.</strong> The compiler optimizes better than you could. </p>\n\n<p><strike>You might perhaps try</p>\n\n<pre><code>len = ((len - 1) &amp; 0x3f) + 1;\n</code></pre>\n\n<p>(but when <code>len</code> is 0 -or 65, etc...- this might not give what you want)</strike></p>\n\n<p>If that is so important for you, benchmark!</p>\n"}, {"tags": [], "owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "is_accepted": true, "score": 3, "last_activity_date": 1527505045, "last_edit_date": 1527505045, "creation_date": 1527098869, "answer_id": 50494811, "question_id": 50492891, "link": "https://stackoverflow.com/questions/50492891/c-fast-way-to-limit-a-number-to-64/50494811#50494811", "title": "C, Fast way to limit a number to &lt;= 64", "body": "<p>I created a program</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void) {\n    unsigned int len;\n    scanf(\"%u\", &amp;len);\n    len = len &gt; 64 ? 64 : len;\n    printf(\"%u\\n\", len);\n}\n</code></pre>\n\n<p>and compiled with <code>gcc -O3</code> and it generated this assembly:</p>\n\n<pre><code>cmpl    $64, 4(%rsp)\nmovl    $64, %edx\nleaq    .LC1(%rip), %rsi\ncmovbe  4(%rsp), %edx\n</code></pre>\n\n<p>the <code>leaq</code> there loads the <code>\"%u\\n\"</code> string in between - I presume it is because the timing of the instructions. The generated code seems pretty efficient. There are no jumps, just a conditional move. No <a href=\"https://stackoverflow.com/questions/11227809/why-is-it-faster-to-process-a-sorted-array-than-an-unsorted-array\">branch prediction failure</a>.</p>\n\n<p>So the best way to optimize your executable is to get a good compiler.</p>\n"}], "owner": {"reputation": 1173, "user_id": 1734108, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bd845e394662aedc5beeefe13c3ccfcd?s=128&d=identicon&r=PG", "display_name": "orfruit", "link": "https://stackoverflow.com/users/1734108/orfruit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "accepted_answer_id": 50494811, "answer_count": 2, "score": 1, "last_activity_date": 1527505045, "creation_date": 1527091420, "question_id": 50492891, "link": "https://stackoverflow.com/questions/50492891/c-fast-way-to-limit-a-number-to-64", "title": "C, Fast way to limit a number to &lt;= 64", "body": "<p>Which is the fastest way to limit a number to 64 inclusive (ie. &lt;= 64)</p>\n\n<pre><code>len = len &gt; 64 ? 64 : len; /* limit to 64 */\n</code></pre>\n\n<p>Thanks!</p>\n"}, {"tags": ["c", "arrays", "linux", "popen"], "comments": [{"owner": {"reputation": 52445, "user_id": 1253222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3a62746fb04e19c1656cd1df560911f?s=128&d=identicon&r=PG", "display_name": "twalberg", "link": "https://stackoverflow.com/users/1253222/twalberg"}, "edited": false, "score": 0, "creation_date": 1527094930, "post_id": 50492852, "comment_id": 88000502, "body": "It would be much more efficient to just use <code>statvfs()</code>..."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1527095333, "post_id": 50492852, "comment_id": 88000684, "body": "What&#39;s read by <code>fread()</code> is not usually null terminated \u2014 but you assume it is.  Also, you use what was read by <code>fread()</code> the time before on EOF, because you don&#39;t check that <code>fread()</code> succeeded until after you use the path information.  Top-tested loops with assignments (<code>while ((len = fread(\u2026)) != 0)</code>) are better for I/O."}], "answers": [{"comments": [{"owner": {"reputation": 11455, "user_id": 10888, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/adbf81127c90a370ceab11b3087a8e4e?s=128&d=identicon&r=PG", "display_name": "Leonard", "link": "https://stackoverflow.com/users/10888/leonard"}, "edited": false, "score": 0, "creation_date": 1527094878, "post_id": 50493637, "comment_id": 88000480, "body": "Also, you don&#39;t return anything from the function execute_cmd().  You should return(buffer)"}], "tags": [], "owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "is_accepted": false, "score": 1, "last_activity_date": 1527098307, "last_edit_date": 1527098307, "creation_date": 1527094258, "answer_id": 50493637, "question_id": 50492852, "link": "https://stackoverflow.com/questions/50492852/popen-and-output-of-system-command/50493637#50493637", "title": "popen and output of system command", "body": "<p><code>sizeof(buffer)</code> is <code>sizeof(char*)</code>, which is probably 8 (or maybe 4). So your <code>memset</code> only clears a little bit of <code>buffer</code>. But with your use of <code>fread</code>, it's not just <code>buffer</code> that needs to be cleared; it's the temporary <code>path</code>.</p>\n\n<p>Uninitialized local variables like <code>path</code> are not zero-initialised. You could use <code>memset(path, 0, sizeof(path));</code> to clear it -- here the <code>sizeof</code> works because <code>path</code> really is an array -- but simpler is to initialise it in the declaration: <code>char path[100] = \"\";</code>.</p>\n\n<p>Since <code>fread</code> does not NUL-terminate what it reads, there might be arbitrary garbage following it, making the <code>strcat</code> Undefined Behaviour. In fact, the <code>strcat</code> is totally unnecessary and a waste of cycles. You know how much data you read (it's in <code>len</code>) so you know exactly where to read the next chunk and you can do so directly without a temporary buffer and without a copy.</p>\n\n<p>For future reference, if you are planning on calling <code>malloc</code> and then using <code>memset</code> to clear the allocated region, you should instead use <code>calloc</code>. That's what it's there for.</p>\n"}], "owner": {"reputation": 91, "user_id": 4862770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b909005c3e49a1fc4437980410988c7b?s=128&d=identicon&r=PG", "display_name": "OpenSourceEnthusiast", "link": "https://stackoverflow.com/users/4862770/opensourceenthusiast"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1527098307, "creation_date": 1527091217, "question_id": 50492852, "link": "https://stackoverflow.com/questions/50492852/popen-and-output-of-system-command", "title": "popen and output of system command", "body": "<p>I have to figure out the available space in /mnt/ in my application. I wrote the following code. However, execute_cmd some times returns junk apart from the actual output. For ex: 4.5K(followed by junk). Where am I going wrong? Could some one review and let me know why execute_cmd returns a junk byte at the end? How do I improve the code? </p>\n\n<pre><code>char *execute_cmd(char *cmd)\n{\n        FILE *fp;\n        char path[100];\n        int ii = 0;\n        //char ii = 0;\n        char *buffer = malloc(1024);\n        char len = 0;\n\n        /* Open the command for reading. */\n        fp = popen(cmd, \"r\");\n        if (fp == NULL) {\n        printf(\"Failed to run command\\n\" );\n        exit(1);\n        }\n        printf(\"Running command is: %s\\n\", cmd);\n\n        memset(buffer, 0, sizeof(buffer));\n\n        do {\n        len = fread(path, 100, 1, fp); /* Is it okay to use fread? I do not know how many bytes to read as this function is a generic function which can be used for executing any command */\n        strcat(buffer,path);\n        printf(\"Number of bytes is: %d\\n\", len);\n        } while (len != 0);\n\n        len = strlen(buffer);\n        printf(\"Buffer contents are: %s %d\\n\", buffer,len);\n\n        /* close */\n        pclose(fp);\n}\n\nvoid main()\n{\n        char *buffer = \"df -h  | grep \\\"/mnt\\\" | awk '{ print $4}'\"; /* FIXME */\n        char len;\n        char units;\n        float number;\n        char dummy = 0;\n        char *avail_space;\n\n        avail_space = execute_cmd(buffer);\n        len = strlen(avail_space);\n        units = avail_space[len - 1];\n\n        printf(\"Available space is: %s %d %c end here\\n\", avail_space, len, units);\n        number = strtof(avail_space, NULL);\n        printf(\"Number is: %f\\n\", number);\n}\n</code></pre>\n"}, {"tags": ["c", "valgrind", "strtok"], "comments": [{"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 6, "creation_date": 1527089804, "post_id": 50492305, "comment_id": 87997653, "body": "<code>char* buffer = (char*) calloc(1, size);      fread(buffer, size, 1, fptr);</code> Your buffer is not NUL-terminated."}, {"owner": {"reputation": 886, "user_id": 5477126, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/6VrvP.jpg?s=128&g=1", "display_name": "rak007", "link": "https://stackoverflow.com/users/5477126/rak007"}, "reply_to_user": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1527089967, "post_id": 50492305, "comment_id": 87997738, "body": "As @wildplasser pointed out (and valgrind too), you have an <code>Invalid read of size 1</code> because your buffer is not null terminated"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1527090376, "post_id": 50492305, "comment_id": 87998000, "body": "You really ought to test the return value of your <code>malloc()</code> call.  That&#39;s true even for modest-sized allocations that you can be fairly confident will succeed, but you&#39;re allocating probably 2 GB of memory to <code>intended_schedule</code>, and there&#39;s a much greater chance that an allocation so large will fail."}, {"owner": {"reputation": 183, "user_id": 708489, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/722325f52a11e3f8e9cd988c998faa89?s=128&d=identicon&r=PG&f=1", "display_name": "PPGoodMan", "link": "https://stackoverflow.com/users/708489/ppgoodman"}, "reply_to_user": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1527090422, "post_id": 50492305, "comment_id": 87998039, "body": "@wildplasser thank you! Now I feel like an idiot. I went to lengths to figure out the problem."}, {"owner": {"reputation": 886, "user_id": 5477126, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/6VrvP.jpg?s=128&g=1", "display_name": "rak007", "link": "https://stackoverflow.com/users/5477126/rak007"}, "edited": false, "score": 0, "creation_date": 1527090553, "post_id": 50492305, "comment_id": 87998138, "body": "@PPGoodMan You can answer your own question or close it then"}, {"owner": {"reputation": 183, "user_id": 708489, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/722325f52a11e3f8e9cd988c998faa89?s=128&d=identicon&r=PG&f=1", "display_name": "PPGoodMan", "link": "https://stackoverflow.com/users/708489/ppgoodman"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1527090584, "post_id": 50492305, "comment_id": 87998172, "body": "@JohnBollinger yes. You&#39;re right! I will do that. Thanks for the suggestion."}], "answers": [{"comments": [{"owner": {"reputation": 183, "user_id": 708489, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/722325f52a11e3f8e9cd988c998faa89?s=128&d=identicon&r=PG&f=1", "display_name": "PPGoodMan", "link": "https://stackoverflow.com/users/708489/ppgoodman"}, "edited": false, "score": 0, "creation_date": 1527096459, "post_id": 50493107, "comment_id": 88001247, "body": "You&#39;re right! It is faster. What I was thinking was that reading the whole file at once would be faster than reading character by character. I thought it would have to issue a read for each character which I expected to be slower than execution of strtok(). Can you explain why is it faster?"}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "reply_to_user": {"reputation": 183, "user_id": 708489, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/722325f52a11e3f8e9cd988c998faa89?s=128&d=identicon&r=PG&f=1", "display_name": "PPGoodMan", "link": "https://stackoverflow.com/users/708489/ppgoodman"}, "edited": false, "score": 1, "creation_date": 1527098069, "post_id": 50493107, "comment_id": 88002042, "body": "Stdio is buffered. <code>getc()</code> (and others) automatically call <code>read()</code> if their buffer is exhausted. Also: getc() is (in most  implementations) a macro, avoiding function-calling overhead. The overhead for calling <code>strtok()</code> once for every produced character is <b>huge</b> (probably more than 50% of the time spent in your loop)"}], "tags": [], "owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "is_accepted": true, "score": 1, "last_activity_date": 1527093856, "last_edit_date": 1527093856, "creation_date": 1527092269, "answer_id": 50493107, "question_id": 50492305, "link": "https://stackoverflow.com/questions/50492305/valgrind-shows-error-for-strtok-with-a-large-memory/50493107#50493107", "title": "valgrind shows error for strtok with a large memory", "body": "<p><code>strtok()</code> assumes a NUL-terminated string, your buffer is <strong>NOT</strong> NUL-terminated, so strtok() will try to walk beyond the end of your buffer. But you can do without<code>strtok()</code> and the large buffer.</p>\n\n<hr>\n\n<p>You don't <em>need</em> to buffer the entire file; for simple cases like this, you can step through it using a one-character buffer. This will consume less memory and will also be consirably faster (<em>at least</em> 2 times)</p>\n\n<hr>\n\n<pre><code> #include &lt;stdio.h&gt; \n #include &lt;stdlib.h&gt;\n #include &lt;string.h&gt;\n\n int main(){\n    unsigned long no_of_houses = 1048576L; //dimensions of my final table.\n    unsigned int no_of_appliances = 5;\n    unsigned int no_of_sectors = 48;\n    unsigned long no = 0;\n    int ch;\n    unsigned int *intended_schedule; // this is where the table will be stored. \n\n    intended_schedule = malloc(no_of_houses * no_of_appliances * no_of_sectors * sizeof *intended_schedule);\n\n    FILE *fptr = fopen(\"./data/houses.csv\", \"r\"); //this file is around 480 mega bytes.\n    if(!fptr) {\n            perror(\"housese file\");\n            exit(0);\n    }\n\n    while(no &lt; no_of_houses*no_of_appliances*no_of_sectors) {\n            ch = getc(fptr);\n            if (ch== EOF) break;\n            if (ch== '\\n') continue;\n            if (ch== ',') continue; \n\n            intended_schedule[no++] = ch - '0'; // it's either 0 or 1. So this is good enough\n    }\n    fclose(fptr);\n\n    free(intended_schedule);\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 183, "user_id": 708489, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/722325f52a11e3f8e9cd988c998faa89?s=128&d=identicon&r=PG&f=1", "display_name": "PPGoodMan", "link": "https://stackoverflow.com/users/708489/ppgoodman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 424, "favorite_count": 0, "accepted_answer_id": 50493107, "answer_count": 1, "score": 0, "last_activity_date": 1527093856, "creation_date": 1527089533, "question_id": 50492305, "link": "https://stackoverflow.com/questions/50492305/valgrind-shows-error-for-strtok-with-a-large-memory", "title": "valgrind shows error for strtok with a large memory", "body": "<p>I wrote a simple code that reads a very large file into memory. (The file is around 480 mega bytes in size). The file contains some comma separated values of 0s and 1s. The code is fairly straight forward. I first get the file size, then allocate enough buffer space, read the file, separate by comma and just put it in the array. The program is as follows:</p>\n\n<pre><code> #include &lt;stdio.h&gt; \n #include &lt;stdlib.h&gt;\n #include &lt;string.h&gt;\n\n int main(){\n    long no_of_houses = 1048576L; //dimensions of my final table.\n    int no_of_appliances = 5;\n    int no_of_sectors = 48;\n\n    int* intended_schedule; // this is where the table will be stored. \n\n    intended_schedule = (int*) malloc(no_of_houses * no_of_appliances * no_of_sectors * sizeof(int));\n\n    FILE* fptr = fopen(\"./data/houses.csv\", \"r\"); //this file is around 480 mega bytes.\n    if(fptr == NULL){\n            perror(\"housese file\");\n            exit(0);\n    }\n\n    fseek(fptr, 0L, SEEK_END); //find the size of the file before allocating space\n    long size = ftell(fptr);\n    rewind(fptr);\n\n    char* buffer = (char*) calloc(1, size); //now we know the size, we can allocate space. \n    fread(buffer, size, 1, fptr);\n\n\n    char* token = strtok(buffer, \",\\n\"); //it's a comma separated file. So break from comma\n    long no = 0;\n    while(token != NULL){\n            if(no == no_of_houses*no_of_appliances*no_of_sectors)\n                    break; //guard against unexpectedly big data file. \n            intended_schedule[no] = token[0] - 48;// it's either 0 or 1. So this is good enough\n            no++;\n            token = strtok(NULL, \",\\n\");\n    }\n    fclose(fptr);\n\n    free(intended_schedule);\n    free(buffer);\n\n    return 0;\n}\n</code></pre>\n\n<p>I used this code as a function of a bigger program and since it gave me errors, I ran this program through valgrind. This is the result I got:</p>\n\n<pre><code> goodman@node2 analyse_code]$ valgrind ./analyse\n ==39263== Memcheck, a memory error detector\n ==39263== Copyright (C) 2002-2017, and GNU GPL'd, by Julian Seward et al.\n ==39263== Using Valgrind-3.13.0 and LibVEX; rerun with -h for copyright info\n ==39263== Command: ./analyse\n ==39263==\n ==39263== Warning: set address range perms: large range [0x51f8040, 0x411f8040) (undefined)\n ==39263== Warning: set address range perms: large range [0x59e3f040, 0x77e3f040) (defined)\n ==39263== Warning: set address range perms: large range [0x59e3f040, 0x77e3f040) (defined)\n ==39263== Invalid read of size 1\n ==39263==    at 0x4EBEDCC: strtok (in /usr/lib64/libc-2.17.so)\n ==39263==    by 0x400997: main (analyse.c:36)\n ==39263==  Address 0x77e3f040 is 0 bytes after a block of size 503,316,480 alloc'd\n  ==39263==    at 0x4C2B9B5: calloc (vg_replace_malloc.c:711)\n  ==39263==    by 0x400904: main (analyse.c:27)\n  ==39263==\n  ==39263== Invalid read of size 1\n  ==39263==    at 0x4EBEDFC: strtok (in /usr/lib64/libc-2.17.so)\n  ==39263==    by 0x400997: main (analyse.c:36)\n  ==39263==  Address 0x77e3f040 is 0 bytes after a block of size 503,316,480 alloc'd\n  ==39263==    at 0x4C2B9B5: calloc (vg_replace_malloc.c:711)\n  ==39263==    by 0x400904: main (analyse.c:27)\n  ==39263==\n  ==39263== Warning: set address range perms: large range [0x51f8028, 0x411f8058) (noaccess)\n  ==39263== Warning: set address range perms: large range [0x59e3f028, 0x77e3f058) (noaccess)\n  ==39263==\n  ==39263== HEAP SUMMARY:\n  ==39263==     in use at exit: 0 bytes in 0 blocks\n  ==39263==   total heap usage: 3 allocs, 3 frees, 1,509,950,008 bytes allocated\n  ==39263==\n  ==39263== All heap blocks were freed -- no leaks are possible\n  ==39263==\n  ==39263== For counts of detected and suppressed errors, rerun with: -v\n  ==39263== ERROR SUMMARY: 2 errors from 2 contexts (suppressed: 0 from 0)\n</code></pre>\n\n<p>I'm wondering why I get these errors. As far as I can tell, there are no problems with my code. Is it because my data is too large? I don't think that could be the case since I run this code on a server with 128 GB of RAM. </p>\n\n<p>Any help would be appreciated. </p>\n\n<p>--ppgoodman</p>\n"}, {"tags": ["java", "c", "string"], "comments": [{"owner": {"reputation": 3316, "user_id": 3499626, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/npoNP.png?s=128&g=1", "display_name": "jhamon", "link": "https://stackoverflow.com/users/3499626/jhamon"}, "edited": false, "score": 1, "creation_date": 1527089592, "post_id": 50492279, "comment_id": 87997497, "body": "adding the expected result may help"}, {"owner": {"reputation": 886, "user_id": 5477126, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/6VrvP.jpg?s=128&g=1", "display_name": "rak007", "link": "https://stackoverflow.com/users/5477126/rak007"}, "reply_to_user": {"reputation": 3316, "user_id": 3499626, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/npoNP.png?s=128&g=1", "display_name": "jhamon", "link": "https://stackoverflow.com/users/3499626/jhamon"}, "edited": false, "score": 0, "creation_date": 1527089701, "post_id": 50492279, "comment_id": 87997572, "body": "@jhamon <code>ret</code> is a pointer to the first occurrence in str1 of any of the characters that are part of str2."}, {"owner": {"reputation": 1791, "user_id": 794606, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9a1d5c337bdddae373bbdcb92fdb7077?s=128&d=identicon&r=PG", "display_name": "Jacek Cz", "link": "https://stackoverflow.com/users/794606/jacek-cz"}, "edited": false, "score": 0, "creation_date": 1527089877, "post_id": 50492279, "comment_id": 87997693, "body": "goggle <code>java find string in string</code>"}, {"owner": {"reputation": 2412, "user_id": 1191058, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/09eeee14385ba75f18adb473ccffe208?s=128&d=identicon&r=PG", "display_name": "j123b567", "link": "https://stackoverflow.com/users/1191058/j123b567"}, "edited": false, "score": 0, "creation_date": 1527090114, "post_id": 50492279, "comment_id": 87997839, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/8938498/get-the-index-of-a-pattern-in-a-string-using-regex\" title=\"get the index of a pattern in a string using regex\">stackoverflow.com/questions/8938498/&hellip;</a>"}, {"owner": {"reputation": 2165, "user_id": 221543, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb1fd995fd5e032f19319c9ce4aa45b3?s=128&d=identicon&r=PG", "display_name": "Brendan Lesniak", "link": "https://stackoverflow.com/users/221543/brendan-lesniak"}, "edited": false, "score": 0, "creation_date": 1527091221, "post_id": 50492279, "comment_id": 87998539, "body": "Please add the expected results, right now your question requires someone to leave the site to figure out what <code>strpbrk()</code> does"}], "answers": [{"comments": [{"owner": {"reputation": 817, "user_id": 1896581, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/84223349f4fceca995c390076ceaf2fe?s=128&d=identicon&r=PG", "display_name": "Zixradoom", "link": "https://stackoverflow.com/users/1896581/zixradoom"}, "reply_to_user": {"reputation": 1744, "user_id": 3580357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09e327bdf4e6fc03bdda0fbaccf18132?s=128&d=identicon&r=PG", "display_name": "Benjamin Caure", "link": "https://stackoverflow.com/users/3580357/benjamin-caure"}, "edited": false, "score": 0, "creation_date": 1527105929, "post_id": 50492530, "comment_id": 88005989, "body": "I used the example information given in the question, I trust the user will be able to divine the required character checking for a truly production solution."}], "tags": [], "owner": {"reputation": 817, "user_id": 1896581, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/84223349f4fceca995c390076ceaf2fe?s=128&d=identicon&r=PG", "display_name": "Zixradoom", "link": "https://stackoverflow.com/users/1896581/zixradoom"}, "is_accepted": false, "score": 1, "last_activity_date": 1531166864, "last_edit_date": 1531166864, "creation_date": 1527090193, "answer_id": 50492530, "question_id": 50492279, "link": "https://stackoverflow.com/questions/50492279/is-there-a-strpbrk-equivalent-in-java-and-how-to-use-it/50492530#50492530", "title": "Is there a strpbrk equivalent in Java? and how to use it?", "body": "<p>There is no direct equivalent in java.</p>\n\n<p>One possible solution would be the use of <a href=\"https://docs.oracle.com/javase/10/docs/api/java/util/regex/Pattern.html\" rel=\"nofollow noreferrer\">Pattern</a> and <a href=\"https://docs.oracle.com/javase/10/docs/api/java/util/regex/Matcher.html\" rel=\"nofollow noreferrer\">Matcher</a>.</p>\n\n<pre><code>java.util.regex.Pattern\njava.util.regex.Matcher\n\nvar str1 = \"abcde2fghi3jk4l\";\nvar str2 = Pattern.quote(\"34\");\n\nMatcher m = Pattern.compile(\"[\"+str2+\"]\").matcher(str1);\nif ( m.find() )\n  return m.start();\nreturn -1;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1744, "user_id": 3580357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09e327bdf4e6fc03bdda0fbaccf18132?s=128&d=identicon&r=PG", "display_name": "Benjamin Caure", "link": "https://stackoverflow.com/users/3580357/benjamin-caure"}, "is_accepted": false, "score": 0, "last_activity_date": 1527093350, "last_edit_date": 1527093350, "creation_date": 1527090218, "answer_id": 50492537, "question_id": 50492279, "link": "https://stackoverflow.com/questions/50492279/is-there-a-strpbrk-equivalent-in-java-and-how-to-use-it/50492537#50492537", "title": "Is there a strpbrk equivalent in Java? and how to use it?", "body": "<p>There's no direct equivalent using standard API.</p>\n\n<p><strong>First solution</strong>: using <a href=\"https://commons.apache.org/proper/commons-lang/apidocs/org/apache/commons/lang3/StringUtils.html#indexOfAny-java.lang.CharSequence-char...-\" rel=\"nofollow noreferrer\">Apache StringUtils library: indexOfAny()</a></p>\n\n<pre><code>ret = StringUtils.indexOfAny(str2,str1.toCharArray());\n</code></pre>\n\n<p><strong>Second solution</strong>: using standard Java 8 API, this is quite verbose</p>\n\n<pre><code>    String str1 = \"abcde2fghi3jk4l\";\n    String str2 = \"34\";\n    OptionalInt ret = str2.chars().map(c -&gt; str1.indexOf(c)).min();\n</code></pre>\n\n<p><strong>Third solution</strong>: using regex, but str1 should not contain any regex special chars so I would not recommend it ...</p>\n\n<pre><code>Matcher matcher = str2.matcher(\"[\"+str1+\"]\");\nif(matcher.find()){\n    ret = matcher.start();\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1081, "user_id": 3402449, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a4d39a6c943663d10fd86abca30f6fe?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmad Shahwan", "link": "https://stackoverflow.com/users/3402449/ahmad-shahwan"}, "is_accepted": false, "score": 1, "last_activity_date": 1527102212, "last_edit_date": 1527102212, "creation_date": 1527090630, "answer_id": 50492680, "question_id": 50492279, "link": "https://stackoverflow.com/questions/50492279/is-there-a-strpbrk-equivalent-in-java-and-how-to-use-it/50492680#50492680", "title": "Is there a strpbrk equivalent in Java? and how to use it?", "body": "<p>First off, Java is not C and it has no pointers the same way C has.</p>\n\n<p>The closest I can think of to your code is something along the lines:</p>\n\n<pre><code>final String str1 = \"abcde2fghi3jk4l\";\nfinal String str2 = \"34\";\nStringTokenizer st = new StringTokenizer(str1, str2);\nString ret = st.hasMoreTokens() ? str1.substring(st.nextToken().length()) : null;\n</code></pre>\n\n<p>This code uses <a href=\"https://docs.oracle.com/javase/10/docs/api/java/util/StringTokenizer.html\" rel=\"nofollow noreferrer\">java.util.StringTokenizer</a>, shipped with the JRE.</p>\n\n<p>You can try it yourself <a href=\"https://ideone.com/lFYvCK\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 23, "user_id": 4658548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa9f3ecff0b385e971eb8bac666aeb30?s=128&d=identicon&r=PG&f=1", "display_name": "AbhiCR7", "link": "https://stackoverflow.com/users/4658548/abhicr7"}, "is_accepted": false, "score": 1, "last_activity_date": 1527090833, "creation_date": 1527090833, "answer_id": 50492739, "question_id": 50492279, "link": "https://stackoverflow.com/questions/50492279/is-there-a-strpbrk-equivalent-in-java-and-how-to-use-it/50492739#50492739", "title": "Is there a strpbrk equivalent in Java? and how to use it?", "body": "<p>There is this function: \n<code>StringUtils.indexOfAny(String str, String searchChars)</code> which will return you the index of first matching character from <code>searchChars</code>. Hope this is what you were looking for.\nThis is quite an expensive approach, see if you can use a better one.</p>\n\n<p>Dependency for which is <code>org.apache.commons:commons-lang3</code></p>\n"}], "owner": {"reputation": 43, "user_id": 9736439, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Raja", "link": "https://stackoverflow.com/users/9736439/raja"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 270, "favorite_count": 0, "answer_count": 4, "score": 2, "last_activity_date": 1531166864, "creation_date": 1527089461, "last_edit_date": 1527089626, "question_id": 50492279, "link": "https://stackoverflow.com/questions/50492279/is-there-a-strpbrk-equivalent-in-java-and-how-to-use-it", "title": "Is there a strpbrk equivalent in Java? and how to use it?", "body": "<p>If the code is something like this</p>\n\n<pre><code>const char str1[] = \"abcde2fghi3jk4l\";\nconst char str2[] = \"34\";\nchar *ret;\nret = strpbrk(str1, str2);\n</code></pre>\n\n<p>how should I replicate the same in Java?</p>\n"}, {"tags": ["c", "data-structures", "heap"], "comments": [{"owner": {"reputation": 13895, "user_id": 1162233, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/e3Eil.jpg?s=128&g=1", "display_name": "Kaidul", "link": "https://stackoverflow.com/users/1162233/kaidul"}, "edited": false, "score": 2, "creation_date": 1527089349, "post_id": 50492213, "comment_id": 87997328, "body": "Provide the full code please."}], "answers": [{"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 0, "last_activity_date": 1527089986, "creation_date": 1527089986, "answer_id": 50492439, "question_id": 50492213, "link": "https://stackoverflow.com/questions/50492213/heap-code-line-explanation/50492439#50492439", "title": "Heap code line explanation", "body": "<p>The conditional you flag appears to be testing whether <code>indexMaxim</code> corresponds to an internal node of the heap, as opposed to a leaf node.  If it is an internal node then the value may need to filter down farther, hence the (recursive?) call to  <code>filtrareHeap()</code>, but if it is a leaf node then the value can't go any farther than that node.</p>\n"}, {"tags": [], "owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "is_accepted": false, "score": 2, "last_activity_date": 1527090357, "creation_date": 1527090357, "answer_id": 50492577, "question_id": 50492213, "link": "https://stackoverflow.com/questions/50492213/heap-code-line-explanation/50492577#50492577", "title": "Heap code line explanation", "body": "<p>In a zero-based array-hosted heap of size <code>n</code>, where <code>n &gt; 0</code> holds true, given any parent node index <code>i</code> such that <code>i</code> is in <code>[0,n-1]</code>, where <code>n</code> is the node count of the heap, the corresponding children nodes can be found at:</p>\n\n<pre><code>2 * i + 1\n2 * (i + 1)\n</code></pre>\n\n<p>in such case where each of the above is likewise in <code>[0,n-1]</code></p>\n\n<p>Given that, one can determine the <em>first</em> node that genuinely has no possible children (and is therefore leaf nodes from that point on in the heap) by taking the heap size, subtracting one to account for the zero-based indexing model, then integer-dividing by two. </p>\n\n<p>Given a heap of size 7, the equation yields 3. And that makes sense because, given indexes</p>\n\n<pre><code>0 1 2 3 4 5 6\n</code></pre>\n\n<p>we know that </p>\n\n<ul>\n<li>0 is parent of 1,2</li>\n<li>1 is parent of 3,4</li>\n<li>2 is parent of 5,6</li>\n</ul>\n\n<p>Therefore, the first node that will have <strong>no</strong> children in the tree is 3. The condition you're questioning simply determines whether the node is less than that position, and if it is, take further action; otherwise stop.</p>\n"}], "owner": {"reputation": 11, "user_id": 9567139, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "ACob", "link": "https://stackoverflow.com/users/9567139/acob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1527090357, "creation_date": 1527089271, "last_edit_date": 1527089355, "question_id": 50492213, "link": "https://stackoverflow.com/questions/50492213/heap-code-line-explanation", "title": "Heap code line explanation", "body": "<pre><code>if (index != indexMaxim)\n{\n    Rezervare aux = heap.vectorRezervari[index];\n    heap.vectorRezervari[index] = heap.vectorRezervari[indexMaxim];\n    heap.vectorRezervari[indexMaxim] = aux;\n\n    if (indexMaxim &lt; (heap.nrElements - 1) / 2) // I REALLY DONT GET WHAT THAT MEAN...\n        filtrareHeap(heap, indexMaxim);\n}\n</code></pre>\n\n<p>I'm working on a heap structure and I think that this line is to compare the value of indexMaxim to the Parent node so if the value is less than the filtrareHeap() method is called to interchange the indices.</p>\n\n<p>Can you give me a more specific explanation?</p>\n"}, {"tags": ["c", "aes", "intrinsics"], "comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1527094155, "post_id": 50491807, "comment_id": 88000129, "body": "Yes, you can use the AES intrinsics for different key sizes.<a href=\"https://security.stackexchange.com/q/145757\">Do AES-NI instructions accelerate both AES-128 and AES-256?</a>.  Intel&#39;s <a href=\"https://www.intel.com/content/dam/doc/white-paper/advanced-encryption-standard-new-instructions-set-paper.pdf\" rel=\"nofollow noreferrer\">intel.com/content/dam/doc/white-paper/&hellip;</a> shows how."}, {"owner": {"reputation": 275, "user_id": 8145784, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/d03231b4f907072b4af34ee5f9f05643?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Clabault", "link": "https://stackoverflow.com/users/8145784/tom-clabault"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1527254729, "post_id": 50491807, "comment_id": 88072328, "body": "Yup, it seems good with the Intel paper. Thank you : ]"}], "owner": {"reputation": 275, "user_id": 8145784, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/d03231b4f907072b4af34ee5f9f05643?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Clabault", "link": "https://stackoverflow.com/users/8145784/tom-clabault"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 420, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1527088682, "creation_date": 1527088017, "last_edit_date": 1527088682, "question_id": 50491807, "link": "https://stackoverflow.com/questions/50491807/aes-ni-intrinsics-with-192-and-256-bits-keys", "title": "AES-NI intrinsics with 192 and 256 bits keys", "body": "<p>I recently found a code on Stack Overflow that uses <em>wmmintrin.h</em> in order to encrypt a block of data using AES-ECB / AES-CBC / AES-Whatever with a 128-bits key.</p>\n\n<p>The code ( shown below ) works really great but it's only using 128-bits keys and I'd really like it to be able to use 192-bits keys and 256-bits keys. </p>\n\n<p>Is there a way to run both 192 and 256 bits encryption with kind of the same code ? Like adding some rounds or so ? Because I know that a 128-bits key goes with 10 rounds of encryption, a 192 with 12 and a 256 with 14 rounds but I'm not sure I could implement this on my own so if you could help me on that...</p>\n\n<p>Here is the code I found:</p>\n\n<pre><code>#ifndef __AES_NI_H__\n#define __AES_NI_H__\n\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdint.h&gt;     //for int8_t\n#include &lt;string.h&gt;     //for memcmp\n#include &lt;wmmintrin.h&gt;  //for intrinsics for AES-NI\n//compile using gcc and following arguments: -g;-O0;-Wall;-msse2;-msse;-march=native;-maes\n\n//internal stuff\n\n//macros\n#define DO_ENC_BLOCK(m,k) \\\n    do{\\\n        m = _mm_xor_si128       (m, k[ 0]); \\\n        m = _mm_aesenc_si128    (m, k[ 1]); \\\n        m = _mm_aesenc_si128    (m, k[ 2]); \\\n        m = _mm_aesenc_si128    (m, k[ 3]); \\\n        m = _mm_aesenc_si128    (m, k[ 4]); \\\n        m = _mm_aesenc_si128    (m, k[ 5]); \\\n        m = _mm_aesenc_si128    (m, k[ 6]); \\\n        m = _mm_aesenc_si128    (m, k[ 7]); \\\n        m = _mm_aesenc_si128    (m, k[ 8]); \\\n        m = _mm_aesenc_si128    (m, k[ 9]); \\\n        m = _mm_aesenclast_si128(m, k[10]);\\\n    }while(0)\n\n#define DO_DEC_BLOCK(m,k) \\\n    do{\\\n        m = _mm_xor_si128       (m, k[10+0]); \\\n        m = _mm_aesdec_si128    (m, k[10+1]); \\\n        m = _mm_aesdec_si128    (m, k[10+2]); \\\n        m = _mm_aesdec_si128    (m, k[10+3]); \\\n        m = _mm_aesdec_si128    (m, k[10+4]); \\\n        m = _mm_aesdec_si128    (m, k[10+5]); \\\n        m = _mm_aesdec_si128    (m, k[10+6]); \\\n        m = _mm_aesdec_si128    (m, k[10+7]); \\\n        m = _mm_aesdec_si128    (m, k[10+8]); \\\n        m = _mm_aesdec_si128    (m, k[10+9]); \\\n        m = _mm_aesdeclast_si128(m, k[0]);\\\n    }while(0)\n\n#define AES_128_key_exp(k, rcon) aes_128_key_expansion(k, _mm_aeskeygenassist_si128(k, rcon))\n\nstatic __m128i aes_128_key_expansion(__m128i key, __m128i keygened) {\n    keygened = _mm_shuffle_epi32(keygened, _MM_SHUFFLE(3, 3, 3, 3));\n    key = _mm_xor_si128(key, _mm_slli_si128(key, 4));\n    key = _mm_xor_si128(key, _mm_slli_si128(key, 4));\n    key = _mm_xor_si128(key, _mm_slli_si128(key, 4));\n    return _mm_xor_si128(key, keygened);\n}\n\n//public API\nstatic void aes128_load_key_enc_only(uint8_t *enc_key, __m128i *key_schedule) {\n    key_schedule[0] = _mm_loadu_si128((const __m128i*) enc_key);\n    key_schedule[1] = AES_128_key_exp(key_schedule[0], 0x01);\n    key_schedule[2] = AES_128_key_exp(key_schedule[1], 0x02);\n    key_schedule[3] = AES_128_key_exp(key_schedule[2], 0x04);\n    key_schedule[4] = AES_128_key_exp(key_schedule[3], 0x08);\n    key_schedule[5] = AES_128_key_exp(key_schedule[4], 0x10);\n    key_schedule[6] = AES_128_key_exp(key_schedule[5], 0x20);\n    key_schedule[7] = AES_128_key_exp(key_schedule[6], 0x40);\n    key_schedule[8] = AES_128_key_exp(key_schedule[7], 0x80);\n    key_schedule[9] = AES_128_key_exp(key_schedule[8], 0x1B);\n    key_schedule[10] = AES_128_key_exp(key_schedule[9], 0x36);\n}\n\nstatic void aes128_load_key(uint8_t *enc_key, __m128i *key_schedule) {\n    aes128_load_key_enc_only(enc_key, key_schedule);\n\n    // generate decryption keys in reverse order.\n    // k[10] is shared by last encryption and first decryption rounds\n    // k[0] is shared by first encryption round and last decryption round (and is the original user key)\n    // For some implementation reasons, decryption key schedule is NOT the encryption key schedule in reverse order\n    key_schedule[11] = _mm_aesimc_si128(key_schedule[9]);\n    key_schedule[12] = _mm_aesimc_si128(key_schedule[8]);\n    key_schedule[13] = _mm_aesimc_si128(key_schedule[7]);\n    key_schedule[14] = _mm_aesimc_si128(key_schedule[6]);\n    key_schedule[15] = _mm_aesimc_si128(key_schedule[5]);\n    key_schedule[16] = _mm_aesimc_si128(key_schedule[4]);\n    key_schedule[17] = _mm_aesimc_si128(key_schedule[3]);\n    key_schedule[18] = _mm_aesimc_si128(key_schedule[2]);\n    key_schedule[19] = _mm_aesimc_si128(key_schedule[1]);\n}\n\nstatic void aes128_enc(__m128i *key_schedule, uint8_t *plainText, uint8_t *cipherText) {\n    __m128i m = _mm_loadu_si128((__m128i *) plainText);\n\n    DO_ENC_BLOCK(m, key_schedule);\n\n    _mm_storeu_si128((__m128i *) cipherText, m);\n}\n\nstatic void aes128_dec(__m128i *key_schedule, uint8_t *cipherText, uint8_t *plainText) {\n    __m128i m = _mm_loadu_si128((__m128i *) cipherText);\n\n    DO_DEC_BLOCK(m, key_schedule);\n\n    _mm_storeu_si128((__m128i *) plainText, m);\n}\n\n//return 0 if no error\n//1 if encryption failed\n//2 if decryption failed\n//3 if both failed\nstatic int aes128_self_test(void) {\n    uint8_t plain[] = { 0x32, 0x43, 0xf6, 0xa8, 0x88, 0x5a, 0x30, 0x8d, 0x31, 0x31, 0x98, 0xa2, 0xe0, 0x37, 0x07, 0x34 };\n    uint8_t enc_key[] = { 0x2b, 0x7e, 0x15, 0x16, 0x28, 0xae, 0xd2, 0xa6, 0xab, 0xf7, 0x15, 0x88, 0x09, 0xcf, 0x4f, 0x3c };\n    uint8_t cipher[] = { 0x39, 0x25, 0x84, 0x1d, 0x02, 0xdc, 0x09, 0xfb, 0xdc, 0x11, 0x85, 0x97, 0x19, 0x6a, 0x0b, 0x32 };\n    uint8_t computed_cipher[16];\n    uint8_t computed_plain[16];\n    int out = 0;\n    __m128i key_schedule[20];\n    aes128_load_key(enc_key, key_schedule);\n    aes128_enc(key_schedule, plain, computed_cipher);\n    aes128_dec(key_schedule, cipher, computed_plain);\n    if (memcmp(cipher, computed_cipher, sizeof(cipher))) out = 1;\n    if (memcmp(plain, computed_plain, sizeof(plain))) out |= 2;\n    return out;\n}\n#endif\n\nint main()\n{\n    uint8_t input[16]; memset(input, 0, 16); input[0] = 'A';\n    uint8_t output[16];\n    uint8_t keyText[16] = \"This is my key.\";\n\n    __m128i key[20];\n\n    aes128_load_key(keyText, key);\n    aes128_enc(key, input, output);\n\n    for (unsigned int i = 0; i &lt; 16; i++)\n        printf(\"%02X\", output[i]);\n\n    getchar();\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "string"], "comments": [{"owner": {"reputation": 4693, "user_id": 5501536, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/50b9ab14ab8699a3862c14ee48126abe?s=128&d=identicon&r=PG&f=1", "display_name": "chevybow", "link": "https://stackoverflow.com/users/5501536/chevybow"}, "edited": false, "score": 1, "creation_date": 1527087142, "post_id": 50491431, "comment_id": 87995831, "body": "In C strings are represented as a sequence of characters followed by a special character marking that its the end of the string. You, the programmer, have to allocate memory for these characters. The reason your professor might assert that &quot;strings don&#39;t really exist&quot; is because they are really just characters in a certain order. There is no &quot;string&quot; keyword in C that you can just declare."}, {"owner": {"reputation": 77, "user_id": 9807095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a9d4f74948e9254a2bfc55155ce5946?s=128&d=identicon&r=PG&f=1", "display_name": "wutBruh", "link": "https://stackoverflow.com/users/9807095/wutbruh"}, "reply_to_user": {"reputation": 4693, "user_id": 5501536, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/50b9ab14ab8699a3862c14ee48126abe?s=128&d=identicon&r=PG&f=1", "display_name": "chevybow", "link": "https://stackoverflow.com/users/5501536/chevybow"}, "edited": false, "score": 0, "creation_date": 1527087312, "post_id": 50491431, "comment_id": 87995964, "body": "ah that&#39;s refreshing, thanks! and indeed, it&#39;s ended with /0 i believe."}, {"owner": {"reputation": 77, "user_id": 9807095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a9d4f74948e9254a2bfc55155ce5946?s=128&d=identicon&r=PG&f=1", "display_name": "wutBruh", "link": "https://stackoverflow.com/users/9807095/wutbruh"}, "reply_to_user": {"reputation": 4693, "user_id": 5501536, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/50b9ab14ab8699a3862c14ee48126abe?s=128&d=identicon&r=PG&f=1", "display_name": "chevybow", "link": "https://stackoverflow.com/users/5501536/chevybow"}, "edited": false, "score": 0, "creation_date": 1527087382, "post_id": 50491431, "comment_id": 87996014, "body": "is this different from java? @chevybow"}, {"owner": {"reputation": 6004, "user_id": 6471538, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Robert Columbia", "link": "https://stackoverflow.com/users/6471538/robert-columbia"}, "edited": false, "score": 0, "creation_date": 1527087397, "post_id": 50491431, "comment_id": 87996022, "body": "Very different. There is a native, <i>immutable</i> String type in Java. You can also declare an array of <i>char</i>, if you are feeling like it, but one would not normally null-terminate them."}, {"owner": {"reputation": 4693, "user_id": 5501536, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/50b9ab14ab8699a3862c14ee48126abe?s=128&d=identicon&r=PG&f=1", "display_name": "chevybow", "link": "https://stackoverflow.com/users/5501536/chevybow"}, "edited": false, "score": 1, "creation_date": 1527087421, "post_id": 50491431, "comment_id": 87996044, "body": "Strings in Java are objects."}, {"owner": {"reputation": 77, "user_id": 9807095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a9d4f74948e9254a2bfc55155ce5946?s=128&d=identicon&r=PG&f=1", "display_name": "wutBruh", "link": "https://stackoverflow.com/users/9807095/wutbruh"}, "reply_to_user": {"reputation": 6004, "user_id": 6471538, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Robert Columbia", "link": "https://stackoverflow.com/users/6471538/robert-columbia"}, "edited": false, "score": 0, "creation_date": 1527087465, "post_id": 50491431, "comment_id": 87996080, "body": "so in java strings arent a sequence of characters but are saved as literal strings? @RobertColumbia"}, {"owner": {"reputation": 6004, "user_id": 6471538, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Robert Columbia", "link": "https://stackoverflow.com/users/6471538/robert-columbia"}, "edited": false, "score": 0, "creation_date": 1527087492, "post_id": 50491431, "comment_id": 87996097, "body": "Yes, they are literally saved as literal strings. Keep in mind, though, that Java, like any high or mid-level language, abstracts some things. At the very bottom there are only ones and zeroes."}, {"owner": {"reputation": 4693, "user_id": 5501536, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/50b9ab14ab8699a3862c14ee48126abe?s=128&d=identicon&r=PG&f=1", "display_name": "chevybow", "link": "https://stackoverflow.com/users/5501536/chevybow"}, "reply_to_user": {"reputation": 6004, "user_id": 6471538, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Robert Columbia", "link": "https://stackoverflow.com/users/6471538/robert-columbia"}, "edited": false, "score": 0, "creation_date": 1527087698, "post_id": 50491431, "comment_id": 87996235, "body": "@RobertColumbia to go off of that- I think its very misleading to say that strings don&#39;t exist in a language like C (just because there is no way to explicitly define a string using the string keyword). Strings are more of a concept that we as programmers use to think about certain types of data. Strings definitely exist in C, but as a low level programming language- you have to better understand their implementation opposed to a high level language like java where you can just do <code>String x = new String(&#39;blep&#39;)</code>"}, {"owner": {"reputation": 6004, "user_id": 6471538, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Robert Columbia", "link": "https://stackoverflow.com/users/6471538/robert-columbia"}, "reply_to_user": {"reputation": 4693, "user_id": 5501536, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/50b9ab14ab8699a3862c14ee48126abe?s=128&d=identicon&r=PG&f=1", "display_name": "chevybow", "link": "https://stackoverflow.com/users/5501536/chevybow"}, "edited": false, "score": 0, "creation_date": 1527087783, "post_id": 50491431, "comment_id": 87996305, "body": "@chevybow that&#39;s exactly what I was trying to say in my last comment about abstraction. Java Strings are just an abstraction, though a more robust and more intuitive one than C &quot;strings&quot;. In the end it&#39;s all ones and zeroes."}, {"owner": {"reputation": 77, "user_id": 9807095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a9d4f74948e9254a2bfc55155ce5946?s=128&d=identicon&r=PG&f=1", "display_name": "wutBruh", "link": "https://stackoverflow.com/users/9807095/wutbruh"}, "edited": false, "score": 1, "creation_date": 1527087959, "post_id": 50491431, "comment_id": 87996427, "body": "this conversation remembers me of what i&#39;ve forgotten about the courses haha anyway thanks buddies"}], "answers": [{"comments": [{"owner": {"reputation": 77, "user_id": 9807095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a9d4f74948e9254a2bfc55155ce5946?s=128&d=identicon&r=PG&f=1", "display_name": "wutBruh", "link": "https://stackoverflow.com/users/9807095/wutbruh"}, "edited": false, "score": 0, "creation_date": 1527111332, "post_id": 50491581, "comment_id": 88008479, "body": "but yet there is the variable string in C"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1527171054, "post_id": 50491581, "comment_id": 88035295, "body": "<i>String</i> exist in the standard C library.  It is specified as a term defined as &quot;A <i>string</i> is a contiguous sequence of characters terminated by and including the first null character.&quot;"}, {"owner": {"reputation": 3306, "user_id": 1951463, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nZ8Ii.jpg?s=128&g=1", "display_name": "Terry Carmen", "link": "https://stackoverflow.com/users/1951463/terry-carmen"}, "edited": false, "score": 0, "creation_date": 1527171251, "post_id": 50491581, "comment_id": 88035463, "body": "The library is not the language, it&#39;s just a library. I&#39;m not saying that strings are impossible, I&#39;m answering the OP&#39;s question as to why his professor said that &quot;strings don&#39;t exist in C&quot;"}, {"owner": {"reputation": 77, "user_id": 9807095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a9d4f74948e9254a2bfc55155ce5946?s=128&d=identicon&r=PG&f=1", "display_name": "wutBruh", "link": "https://stackoverflow.com/users/9807095/wutbruh"}, "edited": false, "score": 0, "creation_date": 1527175173, "post_id": 50491581, "comment_id": 88038177, "body": "gotcha.. That&#39;s totally true, it&#39;s just the library"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1527177598, "post_id": 50491581, "comment_id": 88039745, "body": "True the C standard library is a library, yet not just any library.  It is defined in the same specification as the C language proper and forms the basis for <i>portable</i> code.  Although rare C code does not use any of the standard C library, learning about C is not done without it any more than not using <code>NULL</code>, <code>abs()</code>, <code>printf()</code>, <code>INTMAX</code>, <code>malloc()</code>, and functions that depend on <i>string</i>."}], "tags": [], "owner": {"reputation": 3306, "user_id": 1951463, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nZ8Ii.jpg?s=128&g=1", "display_name": "Terry Carmen", "link": "https://stackoverflow.com/users/1951463/terry-carmen"}, "is_accepted": false, "score": 2, "last_activity_date": 1527088326, "last_edit_date": 1527088326, "creation_date": 1527087376, "answer_id": 50491581, "question_id": 50491431, "link": "https://stackoverflow.com/questions/50491431/why-dont-strings-exist-and-memory-of-chars-vs-memory-of-strings/50491581#50491581", "title": "Why don&#39;t strings &quot;exist&quot; and memory of chars vs memory of strings?", "body": "<p>Strings don't exist in C as a data type. There is int, char, byte, etc., but no \"string\".</p>\n\n<p>This means you can declare a variable as an int, but not as a \"string\" because there is no data type named \"string\" .</p>\n\n<p>The closest C has to a string is an array of chars, or a char * to a section of memory. The actual string is up to the programmer to define, as a sequence of chars terminated with a \\0, or a number of chars with a known upper bound.</p>\n"}, {"comments": [{"owner": {"reputation": 77, "user_id": 9807095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a9d4f74948e9254a2bfc55155ce5946?s=128&d=identicon&r=PG&f=1", "display_name": "wutBruh", "link": "https://stackoverflow.com/users/9807095/wutbruh"}, "edited": false, "score": 1, "creation_date": 1527088477, "post_id": 50491766, "comment_id": 87996752, "body": "thanks for the references, this reminds me everything again. I was like &quot;I swear i used variable String multiple times with C&quot;, but i think i called the char sequences &quot;str&quot;, and then str.length etc.. That&#39;s why my mind was mixed up i think lol"}, {"owner": {"reputation": 3306, "user_id": 1951463, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nZ8Ii.jpg?s=128&g=1", "display_name": "Terry Carmen", "link": "https://stackoverflow.com/users/1951463/terry-carmen"}, "edited": false, "score": 0, "creation_date": 1527091400, "post_id": 50491766, "comment_id": 87998661, "body": "C has a str* functions, however they depend on being pointed at a valid sequence of chars terminated with a \\0, or by defining how long the &quot;string&quot; is in the function call. They&#39;re easy to do wrong, which leads to crashes and buffer overruns and security vulnerabilities. This is one reason for the popularity of managed languages like .net and others."}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "reply_to_user": {"reputation": 3306, "user_id": 1951463, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nZ8Ii.jpg?s=128&g=1", "display_name": "Terry Carmen", "link": "https://stackoverflow.com/users/1951463/terry-carmen"}, "edited": false, "score": 0, "creation_date": 1527092257, "post_id": 50491766, "comment_id": 87999105, "body": "@TerryCarmen - You are making a point, I just do not know what it is.  And careful... Part of your definition of a string: &quot;<i>as a sequence of chars terminated with a \\0, or a number of chars with a known upper bound.&quot;</i> is correct, but part is not.  A string in C is pure and simple: an array of <code>char</code> terminated with a <code>NULL</code>.  (you got that part right) but <i>&quot;or a number of chars with a known upper bound.&quot;</i> is not correct.  If I use the <code>strlen</code> function on a string, it will tell me the length, but that value length does not include the <code>NULL</code> terminator."}, {"owner": {"reputation": 3306, "user_id": 1951463, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nZ8Ii.jpg?s=128&g=1", "display_name": "Terry Carmen", "link": "https://stackoverflow.com/users/1951463/terry-carmen"}, "edited": false, "score": 0, "creation_date": 1527094985, "post_id": 50491766, "comment_id": 88000526, "body": "There are no strings. There are only sequences bytes interpreted as chars. They can be null terminated, but are not required to be. This is why the strn* functions exist; for cases where the null terminator is missing or is ignored."}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "reply_to_user": {"reputation": 3306, "user_id": 1951463, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nZ8Ii.jpg?s=128&g=1", "display_name": "Terry Carmen", "link": "https://stackoverflow.com/users/1951463/terry-carmen"}, "edited": false, "score": 0, "creation_date": 1527098178, "post_id": 50491766, "comment_id": 88002090, "body": "@TerryCarmen - Kindly read the <i>&quot;Strings in C&quot;</i> information I linked above, it clearly describes C strings as requiring a null termination.  Without a null termination, you are correct, it is just an array of <code>char</code>.  By the way, it is <i><a href=\"https://www.nayuki.io/page/undefined-behavior-in-c-and-cplusplus-programs\" rel=\"nofollow noreferrer\">undefined behavior</a></i> to pass a non-null terminated <code>char</code> array to a string function, such as <code>stcpy()</code>, or <code>strcmp()</code>."}, {"owner": {"reputation": 77, "user_id": 9807095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a9d4f74948e9254a2bfc55155ce5946?s=128&d=identicon&r=PG&f=1", "display_name": "wutBruh", "link": "https://stackoverflow.com/users/9807095/wutbruh"}, "edited": false, "score": 0, "creation_date": 1527111315, "post_id": 50491766, "comment_id": 88008474, "body": "But still there is the variable &quot;string&quot; in C"}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "reply_to_user": {"reputation": 77, "user_id": 9807095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a9d4f74948e9254a2bfc55155ce5946?s=128&d=identicon&r=PG&f=1", "display_name": "wutBruh", "link": "https://stackoverflow.com/users/9807095/wutbruh"}, "edited": false, "score": 0, "creation_date": 1527164029, "post_id": 50491766, "comment_id": 88030175, "body": "@wutBruh - Well, I&#39;m not certain if that is a question, or a statement.  Either way, yes there can be a string literal that contains the content &#39;string&#39;, and it can even be stored in a <i>variable</i> declared as <code>char string[7]=&quot;string&quot;.  But, there is no </code>string` type, per se.   (Also, see edit portion at the bottom of my post above.)"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1527170309, "post_id": 50491766, "comment_id": 88034749, "body": "&quot;defined as a <code>NULL</code> terminated&quot; confuses the use of <code>NULL</code>, a <i>null pointer constant</i> with <code>&#39;\\0&#39;</code>, the <i>null character</i>.  Better to avoid <code>NULL</code> when discussing the end of a <i>string</i>:  Maybe: &quot;defined as a <i>null character</i> terminated&quot;"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1527170891, "post_id": 50491766, "comment_id": 88035163, "body": "Detail about &quot;The term <code>NULL</code> is a pointer, typically defined as <code>(void*)0)</code>, or just <code>0</code>.&quot;:  When <code>NULL</code> is defined as <code>0</code>, it is an <code>int</code>, not a pointer.  A weakness in C, IMO."}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1527173657, "post_id": 50491766, "comment_id": 88037186, "body": "@chux - I edited to add your suggestion, and agree, duality of NULL in C is at the very least confusing.  Thanks for your comments."}, {"owner": {"reputation": 77, "user_id": 9807095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a9d4f74948e9254a2bfc55155ce5946?s=128&d=identicon&r=PG&f=1", "display_name": "wutBruh", "link": "https://stackoverflow.com/users/9807095/wutbruh"}, "edited": false, "score": 0, "creation_date": 1527175397, "post_id": 50491766, "comment_id": 88038336, "body": "Once again, I thank you all for the conversations and elaborations on the question :) Y&#39;all cleared my mind and gave some extra information as well"}], "tags": [], "owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "is_accepted": true, "score": 3, "last_activity_date": 1527255554, "last_edit_date": 1527255554, "creation_date": 1527087904, "answer_id": 50491766, "question_id": 50491431, "link": "https://stackoverflow.com/questions/50491431/why-dont-strings-exist-and-memory-of-chars-vs-memory-of-strings/50491766#50491766", "title": "Why don&#39;t strings &quot;exist&quot; and memory of chars vs memory of strings?", "body": "<p>a <code>string</code> <em>type</em> does not exist in C, but <em>C strings</em> do exist. They are defined as a null terminated character array.  For example:</p>\n\n<pre><code>char buffer1[] = \"this is a C string\";//string literal\n</code></pre>\n\n<p>creates a C string that looks like this in memory:</p>\n\n<pre><code>|t|h|i|s| |i|s| |a| |C| |s|t\\r|i|n|g|\\0|?|?|?|  \n&lt;                 string               &gt;\n</code></pre>\n\n<p>Note that this is not a string:</p>\n\n<pre><code>char *buffer2;  \n</code></pre>\n\n<p>Until it contains a series of <code>char</code> terminated by a <code>\\0</code>, it is just a pointer to <code>char</code>. (<code>char *</code>)</p>\n\n<pre><code>buffer2 = calloc(strlen(buffer1)+1, 1);\nstrcpy(buffer2, buffer1); //now buffer2 is pointing to a string  \n</code></pre>\n\n<p>References:<br>\n<em><a href=\"https://www.geeksforgeeks.org/strings-in-c-2/\" rel=\"nofollow noreferrer\">Strings in C 1</a></em><br>\n<em><a href=\"https://www.tutorialspoint.com/cprogramming/c_strings.htm\" rel=\"nofollow noreferrer\">Strings in C 2</a></em><br>\n<em><a href=\"https://cs.nyu.edu/courses/spring05/V22.0201-001/c_tutorial/classes/String.html\" rel=\"nofollow noreferrer\">Stirngs in C 3</a></em><br>\n<em><a href=\"https://www.google.com/search?source=hp&amp;ei=Z4MFW6fBGoGowATX8YiIDw&amp;q=strings+in+C&amp;oq=strings+in+C&amp;gs_l=psy-ab.3..0l10.1348.3096.0.3401.13.9.0.0.0.0.383.949.2-1j2.3.0....0...1c.1.64.psy-ab..10.3.948.0..35i39k1j0i131k1.0.ezzp1GMaZi4\" rel=\"nofollow noreferrer\">and many more...</a></em>     </p>\n\n<p><strong><em>Edit:</em></strong><br>\n(to address discussion in comments on strings:)  </p>\n\n<p>Based on the following definition:  (From <em><a href=\"https://www.tutorialspoint.com/cprogramming/c_strings.htm\" rel=\"nofollow noreferrer\">here</a></em>)    </p>\n\n<blockquote>\n  <p>Strings are actually one-dimensional array of characters terminated by\n  a null character '\\0'.</p>\n</blockquote>\n\n<p>First, since <em>null termination</em> is integral to a conversation about C strings, here are some clarifications:    </p>\n\n<ul>\n<li>The term <code>NULL</code> is a <em>pointer</em>, typically defined as <code>(void*)0)</code>, or\njust <code>0</code>. It can be, and typically is used to initialize pointer\nvariables.</li>\n<li>The term '\\0' is a <em>character</em>.  In C, it means exactly the same\nthing as the integer constant <code>0</code>.  (same value <code>0</code>, same type\n<code>int</code>).  It is used to   initialize <code>char</code> arrays.    </li>\n</ul>\n\n<p>Things that <em>are</em> strings:   </p>\n\n<pre><code>char string[] = {'\\0'}; //zero length or _empty_ string with `sizeof` 1.    \n</code></pre>\n\n<p>In memory:  </p>\n\n<pre><code>|\\0|\n</code></pre>\n\n<p>...</p>\n\n<pre><code>char string[10] = {'\\0'} also zero length or _empty_ with `sizeof` 10.   \n</code></pre>\n\n<p>In memory:  </p>\n\n<pre><code>|\\0|\\0|\\0|\\0|\\0|\\0|\\0|\\0|\\0|\\0|  \n</code></pre>\n\n<p>...</p>\n\n<pre><code>char string[] = {\"string\"}; string of length 6, and `sizeof` 7.    \n</code></pre>\n\n<p>In memory:  </p>\n\n<pre><code>|s|t|r|i|n|g|\\0|  \n</code></pre>\n\n<p>... </p>\n\n<pre><code>char [2][5] = {{0}}; 2 strings, each with zero length, and `sizeof` 5.    \n</code></pre>\n\n<p>In memory:  </p>\n\n<pre><code>|0|0|0|0|0|0|0|0|0|0| (note 0 equivalent to \\0) \n</code></pre>\n\n<p>...</p>\n\n<pre><code>char *buf = {\"string\"};//string literal.    \n</code></pre>\n\n<p>In memory:  </p>\n\n<pre><code>|s|t|r|i|n|g|\\0|\n</code></pre>\n\n<p>Things that <em>are not</em> strings:     </p>\n\n<pre><code>char buf[6] = {\"string\"};//space for 6, but \"string\" requires 7 for null termination.   \n</code></pre>\n\n<p>In Memory:  </p>\n\n<pre><code>|s|t|r|i|n|g|  //no null terminator\n          |end of space in memory.   \n</code></pre>\n\n<p>...   </p>\n\n<pre><code>char *buf = {0};//pointer to char (`char *`).  \n</code></pre>\n\n<p>In memory:  </p>\n\n<pre><code>|0| //null initiated pointer residing at address of `buf`  (eg. 0x00123650)\n</code></pre>\n"}], "owner": {"reputation": 77, "user_id": 9807095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a9d4f74948e9254a2bfc55155ce5946?s=128&d=identicon&r=PG&f=1", "display_name": "wutBruh", "link": "https://stackoverflow.com/users/9807095/wutbruh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 1, "accepted_answer_id": 50491766, "answer_count": 2, "score": 3, "last_activity_date": 1527255554, "creation_date": 1527086952, "last_edit_date": 1527088627, "question_id": 50491431, "link": "https://stackoverflow.com/questions/50491431/why-dont-strings-exist-and-memory-of-chars-vs-memory-of-strings", "title": "Why don&#39;t strings &quot;exist&quot; and memory of chars vs memory of strings?", "body": "<p>I've studied C programming at university for 4 months. My professor always said that strings don't really exist. Since I finished those 2 small courses, I really started programming (java). I can't remember WHY strings don't really exist. I wasn't concerned about this before, but I'm curious now. Why don't they exist? And do they exist in Java? I know it has to do something with that \"under the hood strings are just characters\", but does that mean that strings are all saved as multiple characters etc? And doesn't that take more memory? </p>\n"}, {"tags": ["c", "pointers", "gcc", "mingw"], "comments": [{"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1527086717, "post_id": 50491313, "comment_id": 87995504, "body": "<code>int **sortedData = malloc(sizeof(int) * 512);</code> =&gt; <code>int **sortedData = malloc(sizeof(int *) * 512);</code> your elements are pointers not integers"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1527086935, "post_id": 50491313, "comment_id": 87995647, "body": "if someone finds a better duplicate, be my guest to edit. But it&#39;s a common error, so I&#39;m closing, my answer explains the exact same issue"}, {"owner": {"reputation": 1, "user_id": 5215195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c24a43aa50ac4723015ead0e840140e4?s=128&d=identicon&r=PG&f=1", "display_name": "Neodia", "link": "https://stackoverflow.com/users/5215195/neodia"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1527087796, "post_id": 50491313, "comment_id": 87996313, "body": "I changed the malloc as you said, but it still doesn&#39;t work. The printf is still the only way to get what I am looking for."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1527091620, "post_id": 50491313, "comment_id": 87998766, "body": "what is <code>dimensions[0]</code> ? is that 512? are you sure ?"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1527091762, "post_id": 50491313, "comment_id": 87998845, "body": "could you create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> that runs and demonstrates the issue? it&#39;s not obvious by the current bits of code."}, {"owner": {"reputation": 1, "user_id": 5215195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c24a43aa50ac4723015ead0e840140e4?s=128&d=identicon&r=PG&f=1", "display_name": "Neodia", "link": "https://stackoverflow.com/users/5215195/neodia"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1527093335, "post_id": 50491313, "comment_id": 87999712, "body": "So, while doing what you asked from me, I cleaned some of the code to get it smaller to paste here. It now works after cleaning the code. Seems like the problem was coming from an unused var that I used for testing. Any ideas why it would cause trouble ?"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1527096301, "post_id": 50491313, "comment_id": 88001185, "body": "not right away. You can completely change your question by posting your example that works &amp; the one that doesn&#39;t (both as <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>) and I&#39;ll have a look"}, {"owner": {"reputation": 1, "user_id": 5215195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c24a43aa50ac4723015ead0e840140e4?s=128&d=identicon&r=PG&f=1", "display_name": "Neodia", "link": "https://stackoverflow.com/users/5215195/neodia"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1527149390, "post_id": 50491313, "comment_id": 88020546, "body": "After some further research, it seems that is was one of my string declarations. Before it was : <code>char str[10];</code> After : <code>char str[10] = &quot;&quot;;</code>"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1527149428, "post_id": 50491313, "comment_id": 88020577, "body": "both aren&#39;t equivalent. In the first case <code>str</code> value isn&#39;t initialized/nul-terminated"}, {"owner": {"reputation": 1, "user_id": 5215195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c24a43aa50ac4723015ead0e840140e4?s=128&d=identicon&r=PG&f=1", "display_name": "Neodia", "link": "https://stackoverflow.com/users/5215195/neodia"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1527149473, "post_id": 50491313, "comment_id": 88020606, "body": "Okay I see now, thanks for your help !"}], "owner": {"reputation": 1, "user_id": 5215195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c24a43aa50ac4723015ead0e840140e4?s=128&d=identicon&r=PG&f=1", "display_name": "Neodia", "link": "https://stackoverflow.com/users/5215195/neodia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1527091562, "creation_date": 1527086607, "last_edit_date": 1527088423, "question_id": 50491313, "link": "https://stackoverflow.com/questions/50491313/printing-loop-variable-changes-var-value", "title": "Printing loop variable changes var value", "body": "<p>Here are my two structures :</p>\n\n<pre><code>int *data = malloc(sizeof(int) * 512 * 512);\nint **sortedData = malloc(sizeof(int) * 512);\n</code></pre>\n\n<p>The data var contains integers from a file. sortedData is supposed to be a 2D version of data. Here is how I initialize it :</p>\n\n<pre><code>for (int i = 0; i &lt; dimensions[0]; i++)\n    {\n        sortedData[i] = (data + i * 512);\n    }\n</code></pre>\n\n<p>For testing the values I use :</p>\n\n<pre><code>    printf(\"%d\\n\", data[0]);\n    printf(\"%d\\n\", sortedData[0][0]);`\n</code></pre>\n\n<p>The problem is that the outcome of the second printf is an address, so the values are :</p>\n\n<pre><code>81\n44766304\n</code></pre>\n\n<p>I tried to print the value of (data + i * 512) like this :</p>\n\n<pre><code>for (int i = 0; i &lt; dimensions[0]; i++)\n    {\n        printf(\"%d\\n\", data + i * 512);\n        sortedData[i] = (data + i * 512);\n    }\n</code></pre>\n\n<p>And here is the thing : The printf returns an address for each i, but now, the outcome of the program is what I am looking for : </p>\n\n<pre><code>81\n81\n</code></pre>\n\n<p>I can't really understand how the printf would change the returned value and why my initial solution is wrong.</p>\n\n<p>EDIT 1 : It still doesn't work after changing sortedData from </p>\n\n<pre><code>... = malloc(sizeof(int) * 512);\n</code></pre>\n\n<p>To </p>\n\n<pre><code>... = malloc(sizeof(int *) * 512);\n</code></pre>\n"}, {"tags": ["c", "mqtt", "paho"], "answers": [{"comments": [{"owner": {"reputation": 764, "user_id": 4791682, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lzGgn.png?s=128&g=1", "display_name": "ci7i2en4", "link": "https://stackoverflow.com/users/4791682/ci7i2en4"}, "edited": false, "score": 0, "creation_date": 1527429980, "post_id": 50533242, "comment_id": 88116672, "body": "As far as I understand the Paho MQTT C documentation, the client object should be passed to the MQTTClient_isConnected() function, not its address. Or is that wrong? Also, I don&#39;t think that conn_opts.cleansession = 1; is the problem as that happens only once anyway (when the client is initially created; afterwards, that code line should never be reached again). I have provided a simplified example of my code in the original post. There are now two things that I don&#39;t understand: ..."}, {"owner": {"reputation": 764, "user_id": 4791682, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lzGgn.png?s=128&g=1", "display_name": "ci7i2en4", "link": "https://stackoverflow.com/users/4791682/ci7i2en4"}, "edited": false, "score": 0, "creation_date": 1527430155, "post_id": 50533242, "comment_id": 88116716, "body": "1) If I pass the client object to the MQTTClient_isConnected() function, the &quot;hello&quot; message is successfully published to the Server exactly 16 times (before the Segmentation fault occurs) and I don&#39;t beliebe that to be a coincidence?! Is there an array size anywhere that is exceeded at the 17th attempt? 2) If I pass &amp;client to said function, no message is transmitted to the Server. Instead I get &quot;==&gt; Connection to MQTT Broker failed.&quot; Can anyone explain this to me, please?"}], "tags": [], "owner": {"reputation": 39, "user_id": 4841665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac063cb2c44f6e01757481c5f4e7c704?s=128&d=identicon&r=PG&f=1", "display_name": "Tomasz Pluta", "link": "https://stackoverflow.com/users/4841665/tomasz-pluta"}, "is_accepted": false, "score": 0, "last_activity_date": 1527264910, "creation_date": 1527264910, "answer_id": 50533242, "question_id": 50490872, "link": "https://stackoverflow.com/questions/50490872/eclipse-paho-mqtt-client-how-to-check-for-existing-connection/50533242#50533242", "title": "Eclipse Paho MQTT Client: How to check for existing connection?", "body": "<p>Probably you are setting up \"clean session flag\", what's mean: \"\n   If the ClientId represents a Client already connected to the Server then the Server MUST disconnect the existing Client [MQTT-3.1.4-2].\" (from mqtt standard). So you client is disconnected (the existing one).</p>\n\n<p>Code from example seems to be reasobable. It looks like there is  problem with passing function argument. For example if function needed address, and you are giving objects itself.</p>\n\n<p>Morze from standard:\n\"3.2.2.2 Session Present \nPosition: bit 0 of the Connect Acknowledge Flags. </p>\n\n<p>If the Server accepts a connection with CleanSession set to 1, the Server MUST set Session Present to 0 in the CONNACK packet in addition to setting a zero return code in the CONNACK packet [MQTT-3.2.2-1].</p>\n\n<p>If the Server accepts a connection with CleanSession set to 0, the value set in Session Present depends on whether the Server already has stored Session state for the supplied client ID. If the Server has stored Session state, it MUST set Session Present to 1 in the CONNACK packet [MQTT-3.2.2-2]. If the Server does not have stored Session state, it MUST set Session Present to 0 in the CONNACK packet. This is in addition to setting a zero return code in the CONNACK packet\".</p>\n"}, {"tags": [], "owner": {"reputation": 764, "user_id": 4791682, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lzGgn.png?s=128&g=1", "display_name": "ci7i2en4", "link": "https://stackoverflow.com/users/4791682/ci7i2en4"}, "is_accepted": true, "score": 1, "last_activity_date": 1527434392, "creation_date": 1527434392, "answer_id": 50553618, "question_id": 50490872, "link": "https://stackoverflow.com/questions/50490872/eclipse-paho-mqtt-client-how-to-check-for-existing-connection/50553618#50553618", "title": "Eclipse Paho MQTT Client: How to check for existing connection?", "body": "<p>I figured it out: Apparently, there is absolutely nothing wrong with the example codes in the original posting.</p>\n\n<p>It turns out I was appending the port of the MQTT server to the addr parameter again and again (in a section of the code not shown here as I didn't suspect the source of the error to be there), every time the publish_MQTT() function was called. This made the addr char string grow and eventually exceed the specified length, thus causing the SegFault.</p>\n\n<p>This way everything works just as intended:</p>\n\n<pre><code>printf(\"\\nADDR = %s\\n\\n\", addr); // DEBUG OUTPUT\n\nif (!MQTTClient_isConnected(client)) {\n    strcat(strcat(addr, \":\"), pt); // This line needed to be placed here, not before that if block\n\n    MQTTClient_create(&amp;client, addr, CLIENT_ID, MQTTCLIENT_PERSISTENCE_NONE, NULL);\n    conn_opts.keepAliveInterval = 20;\n    conn_opts.cleansession = 1;\n    conn_opts.username = TOKEN;\n\n    if (MQTTClient_connect(client, &amp;conn_opts) != MQTTCLIENT_SUCCESS) {\n        printf(\"\\n==&gt; Connection to MQTT Broker failed.\\n\");\n        MQTTClient_destroy(&amp;client);\n        free(payload);\n        exit(EXIT_FAILURE);\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 764, "user_id": 4791682, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lzGgn.png?s=128&g=1", "display_name": "ci7i2en4", "link": "https://stackoverflow.com/users/4791682/ci7i2en4"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2574, "favorite_count": 0, "accepted_answer_id": 50553618, "answer_count": 2, "score": 0, "last_activity_date": 1527434392, "creation_date": 1527085397, "last_edit_date": 1527430917, "question_id": 50490872, "link": "https://stackoverflow.com/questions/50490872/eclipse-paho-mqtt-client-how-to-check-for-existing-connection", "title": "Eclipse Paho MQTT Client: How to check for existing connection?", "body": "<p>On the Eclipse Paho MQTT website, the developers provide a client example (<a href=\"http://www.eclipse.org/paho/files/mqttdoc/MQTTClient/html/pubsync.html\" rel=\"nofollow noreferrer\">http://www.eclipse.org/paho/files/mqttdoc/MQTTClient/html/pubsync.html</a>) that does the following:</p>\n\n<ol>\n<li>Create a client object with the specified parameters</li>\n<li>Connect the client with the specified connection options</li>\n<li>Publish a MQTT message</li>\n<li>Disconnect the client</li>\n<li>Destroy the client object</li>\n</ol>\n\n<p>This works well if all you want is to publish one single message.</p>\n\n<p>In my code, I have a function that contains pretty much the same code as in the aforementioned example, however, the function is called repeatedly from main() as I need to publish a large number of messages one after another. The problem is, if I use the code exactly as in the example, every time my function is called a new connection is created and shortly after destroyed. This happens again and again and again as long as the function is called repeatedly, causing a huge overhead.</p>\n\n<p>Is there a way to check whether a client object has already been created, and if so, don't do it again but use the existing one?</p>\n\n<p>In my understanding, the MQTTClient_isConnected() function is supposed to do that: <a href=\"https://www.eclipse.org/paho/files/mqttdoc/MQTTClient/html/_m_q_t_t_client_8h.html#ad9e40bdb7149ee3e5d075db7f51a735f\" rel=\"nofollow noreferrer\">https://www.eclipse.org/paho/files/mqttdoc/MQTTClient/html/_m_q_t_t_client_8h.html#ad9e40bdb7149ee3e5d075db7f51a735f</a>\nBut if I try it like this, I get a Segmentation fault:</p>\n\n<pre><code>if (!MQTTClient_isConnected(client)) {\n    MQTTClient_create(&amp;client, mqtt.addr, CLIENT_ID, MQTTCLIENT_PERSISTENCE_NONE, NULL);\n    conn_opts.keepAliveInterval = 20;\n    conn_opts.cleansession = 1;\n    conn_opts.username = TOKEN;\n\n    if (MQTTClient_connect(client, &amp;conn_opts) != MQTTCLIENT_SUCCESS) {\n        printf(\"\\n==&gt; Connection to MQTT Broker failed.\\n\");\n        MQTTClient_destroy(&amp;client);\n        exit(EXIT_FAILURE);\n    }\n}\n</code></pre>\n\n<p><strong>[EDIT]</strong></p>\n\n<p>Here is a simple demo code that better illustrates what I'm trying to accomplish:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;MQTTClient.h&gt;\n\nMQTTClient client;\n\nvoid publish_MQTT() {\n    MQTTClient_connectOptions conn_opts =  MQTTClient_connectOptions_initializer;\n    MQTTClient_message pubmsg = MQTTClient_message_initializer;\n    MQTTClient_deliveryToken token;\n    char *payload = (char *)calloc(1024, sizeof(char));\n\n    strcpy(payload, \"hello\");\n\n    printf(\"DEBUG_BEFORE &gt;&gt; MQTTClient_isConnected(client) = %d\\n\", MQTTClient_isConnected(client)); // DEBUG OUTPUT\n\n    if (!MQTTClient_isConnected(client)) {\n        MQTTClient_create(&amp;client, addr, CLIENT_ID, MQTTCLIENT_PERSISTENCE_NONE, NULL);\n        conn_opts.keepAliveInterval = 20;\n        conn_opts.cleansession = 1;\n        conn_opts.username = TOKEN;\n\n        if (MQTTClient_connect(client, &amp;conn_opts) != MQTTCLIENT_SUCCESS) {\n            fprintf(stderr, RED \"\\n==&gt; Connection to MQTT Broker failed.\\n\" RESET_CL);\n            MQTTClient_destroy(&amp;client);\n            free(payload);\n            exit(EXIT_FAILURE);\n        }\n    }\n\n    printf(\"DEBUG_AFTER &gt;&gt; MQTTClient_isConnected(client) = %d\\n\", MQTTClient_isConnected(client)); // DEBUG OUTPUT\n\n    pubmsg.payload = payload;\n    pubmsg.payloadlen = strlen(payload);\n    pubmsg.qos = QOS;\n    pubmsg.retained = 0;\n\n    MQTTClient_publishMessage(client, TOPIC, &amp;pubmsg, &amp;token);\n    MQTTClient_waitForCompletion(client, token, TIMEOUT);\n\n    //MQTTClient_disconnect(client, 10000);\n    //MQTTClient_destroy(&amp;client);\n    free(payload);\n}\n\nint main(void) {\n    for (i=0; i&lt;1000; i++) {\n        publish_MQTT();\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>Please ignore the fact that the addr parameter is never specified (in my real code it is) or that it is pretty useless specifying a message in the publish_MQTT() function (in my real code, data is passed from main() to that function).</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1527084460, "post_id": 50490479, "comment_id": 87993882, "body": "String literals is not something native to a processor. They <i>must</i> be stored in memory (except the cases they are very short), while the &quot;literals&quot; such as integer constants can be just naturally passed as operands to the corresponding assembly instructions and/or stored in registers. And of course a bit of historical reasons is there..."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1527084522, "post_id": 50490479, "comment_id": 87993924, "body": "Probably has to do with the fact that a string literal is not a singular value.  An int is just a value that the compiler can just be passed directly in to an instruction.  A string, on the other hand is an array that is operated on by its address, which means it needs to exist somewhere in memory.  The pointer to the string literal would probably be the string&#39;s equivalent of what you get with integral constants."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1527085134, "post_id": 50490479, "comment_id": 87994317, "body": "<code>char *p = &quot;Hello&quot;;</code> is useful to allow, <code>int *p = &amp;3;</code> is not so useful"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1527085135, "post_id": 50490479, "comment_id": 87994320, "body": "@unwind  <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.3.2.1p1\" rel=\"nofollow noreferrer\">port70.net/~nsz/c/c11/n1570.html#6.3.2.1p1</a> Looks like the OP is confusing the string literal with a pointer to it."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1527085157, "post_id": 50490479, "comment_id": 87994345, "body": "Note that you can make lvalue literals, e.g. <code>int *p = &amp;(int){3};</code>"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1527085196, "post_id": 50490479, "comment_id": 87994375, "body": "Related but not a duplicate: <a href=\"https://stackoverflow.com/questions/2589949/string-literals-where-do-they-go\">String literals: Where do they go?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 46684, "user_id": 1527, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/2180b1a962bf46e58fa9746cb4ebfb91?s=128&d=identicon&r=PG", "display_name": "Pete Kirkham", "link": "https://stackoverflow.com/users/1527/pete-kirkham"}, "edited": false, "score": 1, "creation_date": 1527086578, "post_id": 50490560, "comment_id": 87995395, "body": "True, but the fact that the compiler makes a specific optimisation were it can do so without changing the operation of the program does not imply anything about the semantics of language. IIRC, early Fortran was pass by references so implemented constants in memory and you could assign a new value to say, 2 inside a procedure, which was not very useful."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8434155"}, "edited": false, "score": 0, "creation_date": 1527086720, "post_id": 50490560, "comment_id": 87995509, "body": "Just out of curiosity, are array initializer expressions (e.g {1, 2, 3}) given similar treatment to string literals? If the variable it&#39;s initializing is automatic, will the object {1, 2, 3} perhaps be addressable with static duration in read only memory? If not, what is the compiler&#39;s rationale for differentiating between &quot;123&quot; and {1,2,3} in terms of memory allocation?"}], "tags": [], "owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "is_accepted": false, "score": 5, "last_activity_date": 1527087456, "last_edit_date": 1527087456, "creation_date": 1527084529, "answer_id": 50490560, "question_id": 50490479, "link": "https://stackoverflow.com/questions/50490479/lifetime-of-literals-in-c/50490560#50490560", "title": "Lifetime of literals in C", "body": "<p>An integer constant literal is <em>not</em> an lvalue (see the C standard <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.3.2.1p1\" rel=\"nofollow noreferrer\">n1570 \u00a76.3.2.1</a>), and (or perhaps because) usually is not even in addressable memory. However, a string literal is an lvalue (<a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.4.5\" rel=\"nofollow noreferrer\">\u00a76.4.5</a>) that should not be modified (otherwise, <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behavior</a>).</p>\n\n<p>In many cases, small enough integer literals are translated into a <em>subpart</em> of a single machine code instruction and don't have any location.</p>\n\n<p>For some silly example, <code>int zero(void) { return 0; }</code> is compiled (using GCC 8.1 on Linux/x86-64/Debian) with <code>gcc -O2 -S -fverbose-asm</code> into </p>\n\n<pre><code>    .globl  zero\n    .type   zero, @function\nzero:\n.LFB0:\n    .cfi_startproc\n# zero.c:1: int zero(void) {return 0;}\n    xorl    %eax, %eax  #\n    ret \n    .cfi_endproc\n</code></pre>\n\n<p>You don't see any mention of <code>0</code>  in the generated machine code!</p>\n\n<p>Of course details about implementation of integer literals are obviously implementation specific. They depend upon the instruction set architecture, the optimization levels, the compiler version, the phase of the moon, the mood of my cat (I'm not sure about the two last items, I leave you to check).</p>\n"}, {"tags": [], "owner": {"reputation": 51, "user_id": 7355287, "user_type": "registered", "profile_image": "https://graph.facebook.com/1659344597425163/picture?type=large", "display_name": "Darinka Zobenica", "link": "https://stackoverflow.com/users/7355287/darinka-zobenica"}, "is_accepted": false, "score": 2, "last_activity_date": 1527086233, "creation_date": 1527086233, "answer_id": 50491171, "question_id": 50490479, "link": "https://stackoverflow.com/questions/50490479/lifetime-of-literals-in-c/50491171#50491171", "title": "Lifetime of literals in C", "body": "<p>The reason C string literals are lvalues is because they're technically arrays of type char[], and arrays always must be addressable in memory.</p>\n\n<p>If you're asking <em>why</em>, my best guess would be because it makes no sense for literals to be lvalues, but since arrays can't be assigned to anyway there's no point in bothering to explicitly forbid it as a lvalue in this one case (of string literals). There's probably a somewhat more complete explanation somebody more knowledgeable about construction of compilers will be able to provide.</p>\n"}, {"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 2, "last_activity_date": 1527087796, "creation_date": 1527087796, "answer_id": 50491724, "question_id": 50490479, "link": "https://stackoverflow.com/questions/50490479/lifetime-of-literals-in-c/50491724#50491724", "title": "Lifetime of literals in C", "body": "<blockquote>\n  <p>Why does the same not hold for an integer constant literal? Does it\n  not also have static storage duration?</p>\n</blockquote>\n\n<p>Integer constants are not \"literals\" in the standard's terminology.  \"Constants\" are a separate thing.  And no, constants do not have static storage duration because they are not objects at all.  They are constants.  C does not define them to have storage of any kind.  In practice, they usually are directly represented in the generated executable code, not among the program's data.</p>\n\n<blockquote>\n  <p>If I attempt to assign to an\n  integer constant, gcc complains that it is not an lvalue.</p>\n</blockquote>\n\n<p>It isn't.  In other words, a constant does not correspond to a memory location, it's just a constant.  </p>\n\n<blockquote>\n  <p>Why are string literals given this special treatment? (And compound\n  literals in C99).</p>\n</blockquote>\n\n<p>The treatment of string and compound literals is not special, it's just what it is.  You seem to be getting confused by incorrectly considering these kinds of object literals to be a similar kind of thing to constants, but they are not.  String and compound literals represent objects that <em>do</em> have representations as data in memory.</p>\n\n<blockquote>\n  <p>I've heard the following definition for lvalues: \"An\n  lvalue (locator value) represents an object that occupies some\n  identifiable location in memory (i.e. has an address).\"</p>\n</blockquote>\n\n<p>Yes.</p>\n\n<blockquote>\n  <p>If a string\n  literal (a character array type) must be addressable in memory, why\n  does the same not apply to an integer?</p>\n</blockquote>\n\n<p>You are again glancing off the point.  Integers can and often do have addressable locations in memory.  But integer <em>constants</em> do not (or at least, C does not require them to have).  Their representations in a program are typically in executable code.</p>\n\n<p>Part of the significance of the term \"literal\" is that the entity so described represents an actual <em>object</em> of the specified type.</p>\n\n<p>A \"constant\", on the other hand, represents a <em>value</em> of the specified type.</p>\n\n<blockquote>\n  <p>Even an integer still has to be\n  allocated in the program's address space.</p>\n</blockquote>\n\n<p>There is a somewhat subtle distinction here, but an important one, between objects and values.  Objects are identified with storage locations; they <em>have</em> and / or <em>contain</em> values.  Thus, an object of integer type indeed does have storage, and an expression that designates that storage is an lvalue.  On the other hand, although a particular integer value may in fact be the value of any number of objects, but the value itself is not inherently associated with a specific storage location.</p>\n\n<blockquote>\n  <p>Is there a performance\n  reason?</p>\n</blockquote>\n\n<p>Fundamentally, there are language design reasons.  Some of these do promote better performance -- i.e. values can be encoded directly into executable machine code, rather than the machine code having to load them from (other) memory -- but I don't take those to be the primary factor.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user8434155"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 146, "favorite_count": 0, "answer_count": 3, "score": 3, "last_activity_date": 1527087796, "creation_date": 1527084301, "question_id": 50490479, "link": "https://stackoverflow.com/questions/50490479/lifetime-of-literals-in-c", "title": "Lifetime of literals in C", "body": "<p>There are a lot of good answers on this site regarding the static lifetime of string literals. As I understand it, they are allocated in read-only memory (others have referred specifically to a \"string-literal pool\"). As such, returning a pointer to a string literal would not result in a dangling pointer. They are also lvalues.</p>\n\n<p>Why does the same not hold for an integer constant literal? Does it not also have static storage duration? If I attempt to assign to an integer constant, gcc complains that it is not an lvalue.</p>\n\n<p>Why are string literals given this special treatment? (And compound literals in C99). I've heard the following definition for lvalues: \"An lvalue (locator value) represents an object that occupies some identifiable location in memory (i.e. has an address).\" If a string literal (a character array type) must be addressable in memory, why does the same not apply to an integer? Even an integer still has to be allocated in the program's address space. Is there a performance reason?</p>\n"}, {"tags": ["c", "valgrind", "memcpy", "void-pointers", "pointer-arithmetic"], "comments": [{"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 2, "creation_date": 1527083426, "post_id": 50490069, "comment_id": 87993177, "body": "<code>vector-&gt;data = (char *)vector-&gt;data + sizeof(int);</code> changes the pointer, so when you go to <code>free</code> it, you are using the wrong address."}, {"owner": {"reputation": 10095, "user_id": 1158977, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/B6Za7.png?s=128&g=1", "display_name": "Sam Hammamy", "link": "https://stackoverflow.com/users/1158977/sam-hammamy"}, "reply_to_user": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 0, "creation_date": 1527083493, "post_id": 50490069, "comment_id": 87993215, "body": "I thought this cast would be temporary?"}, {"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 4, "creation_date": 1527083902, "post_id": 50490069, "comment_id": 87993506, "body": "Johnny Mopp has nothing to do with the cast. The problem is that you are reassigning the pointer. It no longer points at the memory allocated with <code>malloc()</code>."}, {"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 0, "creation_date": 1527084037, "post_id": 50490069, "comment_id": 87993597, "body": "Just noticed: <code>vector.data = (char *)vector.data - ( 5 * vector.elemSize);</code> looks like you try to reset it back to the original value before the <code>free()</code> but you use <code>5</code> instead of <code>8</code>."}, {"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 1, "creation_date": 1527084310, "post_id": 50490069, "comment_id": 87993777, "body": "I suggest that you read <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">ericlippert.com/2014/03/05/how-to-debug-small-programs</a> for some tips to debug your code. Pointers are a little bit more complex to debug but the concepts from Eric Lippert&#39;s blog can be modified to debug these kinds of programs."}], "answers": [{"comments": [{"owner": {"reputation": 10095, "user_id": 1158977, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/B6Za7.png?s=128&g=1", "display_name": "Sam Hammamy", "link": "https://stackoverflow.com/users/1158977/sam-hammamy"}, "edited": false, "score": 0, "creation_date": 1527083579, "post_id": 50490182, "comment_id": 87993268, "body": "re: #1, the point of it is to be generic. So today an <code>int</code> tomorrow a <code>double</code>"}, {"owner": {"reputation": 10095, "user_id": 1158977, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/B6Za7.png?s=128&g=1", "display_name": "Sam Hammamy", "link": "https://stackoverflow.com/users/1158977/sam-hammamy"}, "edited": false, "score": 0, "creation_date": 1527083627, "post_id": 50490182, "comment_id": 87993299, "body": "Oh and I also don&#39;t know the type ahead of time! I should have clarified that! Updating the question"}, {"owner": {"reputation": 5101, "user_id": 700170, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gZ8hw.png?s=128&g=1", "display_name": "Morten Jensen", "link": "https://stackoverflow.com/users/700170/morten-jensen"}, "reply_to_user": {"reputation": 10095, "user_id": 1158977, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/B6Za7.png?s=128&g=1", "display_name": "Sam Hammamy", "link": "https://stackoverflow.com/users/1158977/sam-hammamy"}, "edited": false, "score": 0, "creation_date": 1527083775, "post_id": 50490182, "comment_id": 87993407, "body": "@SamHammamy if it should be generic, you need to store the size of the items to the struct so that you know how many byte to allocate"}, {"owner": {"reputation": 10095, "user_id": 1158977, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/B6Za7.png?s=128&g=1", "display_name": "Sam Hammamy", "link": "https://stackoverflow.com/users/1158977/sam-hammamy"}, "reply_to_user": {"reputation": 5101, "user_id": 700170, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gZ8hw.png?s=128&g=1", "display_name": "Morten Jensen", "link": "https://stackoverflow.com/users/700170/morten-jensen"}, "edited": false, "score": 0, "creation_date": 1527083803, "post_id": 50490182, "comment_id": 87993431, "body": "@MortenJensen correct, in my main code I am, for this trial I did not, updating again..."}, {"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "reply_to_user": {"reputation": 10095, "user_id": 1158977, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/B6Za7.png?s=128&g=1", "display_name": "Sam Hammamy", "link": "https://stackoverflow.com/users/1158977/sam-hammamy"}, "edited": false, "score": 1, "creation_date": 1527084050, "post_id": 50490182, "comment_id": 87993611, "body": "@SamHammamy Okay, edited to better match your current question."}, {"owner": {"reputation": 10095, "user_id": 1158977, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/B6Za7.png?s=128&g=1", "display_name": "Sam Hammamy", "link": "https://stackoverflow.com/users/1158977/sam-hammamy"}, "edited": false, "score": 0, "creation_date": 1527087206, "post_id": 50490182, "comment_id": 87995882, "body": "Thanks! It&#39;s much more clear now! I picked the answer by @dasblinklight because I believe it answers the core question a little more"}], "tags": [], "owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "is_accepted": false, "score": 4, "last_activity_date": 1527084646, "last_edit_date": 1527084646, "creation_date": 1527083507, "answer_id": 50490182, "question_id": 50490069, "link": "https://stackoverflow.com/questions/50490069/what-is-the-correct-way-to-temporarily-cast-void-for-arithmetic/50490182#50490182", "title": "What is the correct way to temporarily cast void* for arithmetic?", "body": "<p>Your code is somewhat confusing, there's probably a mis-understanding or two hiding in there.</p>\n\n<p>A few observations:</p>\n\n<ol>\n<li>You can't <em>change</em> a pointer returned by <code>malloc()</code> and then pass the new value to <code>free()</code>. Every value passed to <code>free()</code> must be the exact same value returned by one of the allocation functions.</li>\n<li>As you've guessed, the copying is best done by <code>memcpy()</code> and you have to cast to <code>char *</code> for the arithmetic.</li>\n</ol>\n\n<p>The function to append a value could be:</p>\n\n<pre><code>void add(trial *vector, const void *element)\n{\n  memcpy((char *) vector-&gt;data + vector-&gt;aindex * vector-&gt;elemSize, element);\n  ++vector-&gt;aindex;\n}\n</code></pre>\n\n<p>Of course this doesn't handle overflowing the vector, since the length is not stored (I didn't want to assume it was hard-coded at 10).</p>\n\n<p>Changing the <code>data</code> value in <code>vector</code> for each object is very odd, and makes things more confusing. Just add the required offset when you need to access the element, that's super-cheap and very straight forward.</p>\n"}, {"comments": [{"owner": {"reputation": 10095, "user_id": 1158977, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/B6Za7.png?s=128&g=1", "display_name": "Sam Hammamy", "link": "https://stackoverflow.com/users/1158977/sam-hammamy"}, "edited": false, "score": 0, "creation_date": 1527084503, "post_id": 50490352, "comment_id": 87993913, "body": "Thanks! That&#39;s what I needed to understand! Many thanks for your help!"}], "tags": [], "owner": {"reputation": 1125, "user_id": 5672740, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c16baffcdc08015ed0b3f9dcfd424751?s=128&d=identicon&r=PG&f=1", "display_name": "SenselessCoder", "link": "https://stackoverflow.com/users/5672740/senselesscoder"}, "is_accepted": false, "score": 4, "last_activity_date": 1527084006, "creation_date": 1527084006, "answer_id": 50490352, "question_id": 50490069, "link": "https://stackoverflow.com/questions/50490069/what-is-the-correct-way-to-temporarily-cast-void-for-arithmetic/50490352#50490352", "title": "What is the correct way to temporarily cast void* for arithmetic?", "body": "<p>If you don't know the array's data type beforehand, you must assume a certain amount of memory when you first initialize it, for example, 32 bytes or 100 bytes. Then if you run out of memory, you can expand using realloc and copying over your previous data to the new slot. The C++ vector IIRC follows either a x2 or x2.2 ratio to reallocate, not sure.</p>\n\n<p>Next up is your <code>free</code>. There's a big thing you must know here. What if the user were to send you a memory allocated object of their own? For example a <code>char*</code> that they allocated previously? If you simply delete the data member of your vector, that won't be enough. You need to ask for a function pointer in case the data type is something that requires special attention as your input to add.</p>\n\n<p>Lastly you are doing a big mistake at this line here:</p>\n\n<pre><code>if (vector-&gt;aindex != 0)\n    vector-&gt;data = (char *)vector-&gt;data + vector-&gt;elemSize;\n</code></pre>\n\n<p>You are modifiyng your pointer address!!! Your initial address is lost here! You must never do this. Use a temporary <code>char*</code> to hold your initial data address and manipulate it instead.</p>\n"}, {"comments": [{"owner": {"reputation": 10095, "user_id": 1158977, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/B6Za7.png?s=128&g=1", "display_name": "Sam Hammamy", "link": "https://stackoverflow.com/users/1158977/sam-hammamy"}, "edited": false, "score": 0, "creation_date": 1527084441, "post_id": 50490378, "comment_id": 87993868, "body": "Thanks @dasblinklight that&#39;s what I needed to understand! I also changed my print call to <code>printf(&quot;%d\\n&quot;, *(int *)vector.data + 5);</code>"}], "tags": [], "owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "is_accepted": true, "score": 10, "last_activity_date": 1527084079, "creation_date": 1527084079, "answer_id": 50490378, "question_id": 50490069, "link": "https://stackoverflow.com/questions/50490069/what-is-the-correct-way-to-temporarily-cast-void-for-arithmetic/50490378#50490378", "title": "What is the correct way to temporarily cast void* for arithmetic?", "body": "<p>This happens because you add eight elements to the vector, and then \"roll back\" the pointer by only five steps before attempting a <code>free</code>. You can easily fix that by using <code>vector-&gt;aindex</code> to decide by how much the index is to be unrolled.</p>\n\n<p>The root cause of the problem, however, is that you modify <code>vector-&gt;data</code>. You should avoid modifying it in the first place, relying on a temporary pointer inside of your <code>add</code> function instead:</p>\n\n<pre><code>void add(trial *vector, const void *elemAddr, size_t sz) {\n    char *base = vector-&gt;data;\n    memcpy(base + vector-&gt;aindex*sz, elemAddr, sz);\n    vector-&gt;aindex++;\n}\n</code></pre>\n\n<p>Note the use of <code>sz</code>, you need to pass <code>sizeof(int)</code> to it.</p>\n\n<p>Another problem in your code is when you print by casting <code>vector.data</code> to <code>int*</code>. This would probably work, but a better approach would be to write a similar <code>read</code> function to extract the data.</p>\n"}], "owner": {"reputation": 10095, "user_id": 1158977, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/B6Za7.png?s=128&g=1", "display_name": "Sam Hammamy", "link": "https://stackoverflow.com/users/1158977/sam-hammamy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 463, "favorite_count": 1, "accepted_answer_id": 50490378, "answer_count": 3, "score": 9, "last_activity_date": 1527084646, "creation_date": 1527083195, "last_edit_date": 1527083979, "question_id": 50490069, "link": "https://stackoverflow.com/questions/50490069/what-is-the-correct-way-to-temporarily-cast-void-for-arithmetic", "title": "What is the correct way to temporarily cast void* for arithmetic?", "body": "<p>I am C novice but been a programmer for some years, so I am trying to learn C by following along Stanford's course from 2008 and doing <a href=\"https://see.stanford.edu/materials/icsppcs107/11-Assignment-3-Vector.pdf\" rel=\"noreferrer\">Assignment 3</a> on Vectors in C.</p>\n\n<p>It's just a generic array basically, so the data is held inside a struct as a <code>void *</code>.  The compiler flag <code>-Wpointer-arith</code> is turned on so I can't do <a href=\"https://stackoverflow.com/questions/3523145/pointer-arithmetic-for-void-pointer-in-c?utm_medium=organic&amp;utm_source=google_rich_qa&amp;utm_campaign=google_rich_qa\">arithmetic</a> (and I understand the reasons why).</p>\n\n<p>The struct around the data <strong>must not know</strong> what type the data is, so that it is generic for the caller.</p>\n\n<p>To simplify things I am trying out the following code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\ntypedef struct {\n    void *data;\n    int aindex;\n    int elemSize;\n} trial;\n\nvoid init(trial *vector, int elemSize)\n{\n    vector-&gt;aindex = 0;\n    vector-&gt;elemSize = elemSize;\n    vector-&gt;data = malloc(10 * elemSize);\n}\n\nvoid add(trial *vector, const void *elemAddr)\n{\n    if (vector-&gt;aindex != 0)\n        vector-&gt;data = (char *)vector-&gt;data + vector-&gt;elemSize;\n\n    vector-&gt;aindex++;\n    memcpy(vector-&gt;data, elemAddr, sizeof(int));\n\n}\n\nint main()\n{\n    trial vector;\n    init(&amp;vector, sizeof(int));\n\n    for (int i = 0; i &lt; 8; i++)\n        {add(&amp;vector, &amp;i);}\n\n    vector.data = (char *)vector.data - ( 5 * vector.elemSize);\n    printf(\"%d\\n\", *(int *)vector.data);\n    printf(\"%s\\n\", \"done..\");\n\n    free(vector.data);\n    return 0;\n}\n</code></pre>\n\n<p>However I get an error at free with <code>free(): invalid pointer</code>.  So I ran <code>valgrind</code> on it and received the following:</p>\n\n<pre><code>==21006==  Address 0x51f0048 is 8 bytes inside a block of size 40 alloc'd\n==21006==    at 0x4C2CEDF: malloc (vg_replace_malloc.c:299)\n==21006==    by 0x1087AA: init (pointer_arithm.c:13)\n==21006==    by 0x108826: main (pointer_arithm.c:29)\n</code></pre>\n\n<p>At this point my guess is I am either not doing the <code>char*</code> correctly, or maybe using <code>memcpy</code> <a href=\"https://stackoverflow.com/a/7873135/1158977\">incorrectly</a></p>\n"}, {"tags": ["c", "arrays", "string", "loops", "for-loop"], "answers": [{"tags": [], "owner": {"reputation": 1000, "user_id": 9332988, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BRbxE.jpg?s=128&g=1", "display_name": "Surya Tej", "link": "https://stackoverflow.com/users/9332988/surya-tej"}, "is_accepted": false, "score": 1, "last_activity_date": 1527082928, "last_edit_date": 1527082928, "creation_date": 1527082777, "answer_id": 50489950, "question_id": 50489809, "link": "https://stackoverflow.com/questions/50489809/storing-users-input-into-two-arrays/50489950#50489950", "title": "Storing users input into two arrays", "body": "<p>C needs 2-dimensional array for storing strings. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main (void) {\n\n    char street[10][100]; \n    int number[10]; \n\n    int i;\n\n    for (i=0;i&lt;3;i++){\n\n\n        printf(\"Enter street and number: \\n\");\n        scanf(\"%99s %d\", &amp;street[i], &amp;number[i]);\n    }\n    for (int i=0;i&lt;3;i++) {\n        printf(\"%s \",street[i]);\n    }\n}\n</code></pre>\n\n<p>or with pointers, you could use malloc to allocate memory</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main (void) {\n\n    char *street[10]; \n    int number[10]; \n    int i;\n\n    for (i=0;i&lt;3;i++){\n        street[i] = malloc(100);\n        printf(\"Enter street and number: \\n\");\n        scanf(\"%99s %d\", street[i], &amp;number[i]);\n    }\n    for (int i=0;i&lt;3;i++) {\n        printf(\"%s \",street[i]);\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2465, "user_id": 5462988, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9i3ex.jpg?s=128&g=1", "display_name": "anoopknr", "link": "https://stackoverflow.com/users/5462988/anoopknr"}, "is_accepted": false, "score": 1, "last_activity_date": 1527085278, "creation_date": 1527085278, "answer_id": 50490838, "question_id": 50489809, "link": "https://stackoverflow.com/questions/50489809/storing-users-input-into-two-arrays/50490838#50490838", "title": "Storing users input into two arrays", "body": "<p>Angela, you have mainly made <strong>3</strong> mistakes in your code .</p>\n\n<p><em>First</em> to have an integer array of 10 elements  <code>int number[10];</code> not  <code>int *number[10];</code> .Here you need only a one dimensional array. <code>int *number[10];</code> Is used for two dimensional array.</p>\n\n<p><em>Second</em> you cannot use string pointer without allocating memory for that.so the allocation code using <em>malloc</em>  <code>street[i] = (char *)malloc(sizeof(char) * 100);</code> should be used before reading some values to <code>street[i]</code>.</p>\n\n<p>Third while scanning an integer array in c you have to use the <code>&amp;</code> operator.So the <code>scanf</code> statement should be  <code>scanf(\"%s%d\", street[i], &amp;number[i]);</code> </p>\n\n<p>Please try this modified code.This will work:-</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main(void)\n{\n\n    char *street[10];\n    int number[10];                                     // not *number[10]\n    int i;\n\n    for (i = 0; i &lt; 10; i++)\n    {\n\n        printf(\"Enter street and number: \\n\");\n        street[i] = (char *)malloc(sizeof(char) * 100); // assuming the max-string size is 100\n        scanf(\"%s%d\", street[i], &amp;number[i]);           // not number[i]\n        getchar();                                      // for handling un managed '\\n' (enter-keys)\n    }\n    for (int i = 0; i &lt; 10; i++)\n    {\n\n        printf(\"%s\\n\", street[i]);\n    }\n}\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9741196"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1527085278, "creation_date": 1527082349, "last_edit_date": 1527082660, "question_id": 50489809, "link": "https://stackoverflow.com/questions/50489809/storing-users-input-into-two-arrays", "title": "Storing users input into two arrays", "body": "<p>I am going to prompt the user to enter their street name (is a single word) and separated by a space, their house number. The user will give me 10 of these at the prompt.</p>\n\n<p>I am going to put the street name into one array, and the house number into another. So far I have the code shown below. It results in a segmentation fault. I have read all of my notes and I am still unsure why this is happening. Any help is greatly appreciated. (Note, the second loop was to see if the street  array was correctly storing its elements). </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main (void){\n\n    char *street[10]; \n    int *number[10]; \n\n    int i;\n\n    for (i=0;i&lt;10;i++){\n\n\n        printf(\"Enter street and number: \\n\");\n\n\n        scanf(\" %s %d\", street[i], number[i]);\n    }\n    for (int i=0;i&lt;10;i++){\n\n        printf(\"%s \",street[i]);\n\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "pointers", "dynamic", "struct", "malloc"], "comments": [{"owner": {"reputation": 102162, "user_id": 613130, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/40bd5f390cba274159501bb244bc29f4?s=128&d=identicon&r=PG", "display_name": "xanatos", "link": "https://stackoverflow.com/users/613130/xanatos"}, "edited": false, "score": 7, "creation_date": 1527081098, "post_id": 50489316, "comment_id": 87991464, "body": "The <code>malloc</code> method doesn&#39;t &quot;clean&quot; the memory it returns. Use <code>calloc</code> if you want zeroed memory, or <code>memset</code> it. See <a href=\"https://stackoverflow.com/questions/1538420/difference-between-malloc-and-calloc\" title=\"difference between malloc and calloc\">stackoverflow.com/questions/1538420/&hellip;</a>"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 102162, "user_id": 613130, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/40bd5f390cba274159501bb244bc29f4?s=128&d=identicon&r=PG", "display_name": "xanatos", "link": "https://stackoverflow.com/users/613130/xanatos"}, "edited": false, "score": 1, "creation_date": 1527082077, "post_id": 50489316, "comment_id": 87992162, "body": "Your code looks fine to me, except that you do not check <code>malloc()</code>&#39;s return value and that it is unnecessary to cast the return value of <code>malloc()</code> in C.  And note well the distinction implicit in @xanatos&#39;s comment: a valid pointer to space with junk in it is not at all the same thing as an invalid pointer.  When <code>malloc()</code> fails, it returns a null pointer."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1527090043, "post_id": 50489316, "comment_id": 87997790, "body": "In C all those cast are needless."}], "answers": [{"comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1527082654, "post_id": 50489749, "comment_id": 87992625, "body": "You seem to have misunderstood the OP&#39;s main problem.  Although his code would be more robust if it checked the results of his <code>malloc()</code> calls, it is basically ok.  His is a problem of wrong expectations about the contents of the memory to which his (properly allocated) pointers point."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1527085844, "post_id": 50489749, "comment_id": 87994885, "body": "This <code>name_t *name_dict = (name_t*)malloc(sizeof(name_dict));</code> is wrong, as it allocates just the size of a pointer. The OP does it right."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1527089779, "post_id": 50489749, "comment_id": 87997621, "body": "You missed to correct this &quot;<i>So on 32 bit OS, <code>sizeof(name_t)</code> is 8 bytes.</i>&quot;"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1527089906, "post_id": 50489749, "comment_id": 87997707, "body": "Also why do you mention this: &quot;<i>Dynamic creation of instance of <code>name_t</code> struct  <code>name_t *name_dict = (name_t*)malloc(sizeof(name_dict));</code> allocates only 8 bytes to store two pointers.</i>&quot;? The OP is not doing it this way."}], "tags": [], "owner": {"reputation": 428, "user_id": 2516697, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/3nNCJ.jpg?s=128&g=1", "display_name": "s.paszko", "link": "https://stackoverflow.com/users/2516697/s-paszko"}, "is_accepted": false, "score": -1, "last_activity_date": 1527088115, "last_edit_date": 1527088115, "creation_date": 1527082197, "answer_id": 50489749, "question_id": 50489316, "link": "https://stackoverflow.com/questions/50489316/dynamic-memory-allocation-for-structs-in-c/50489749#50489749", "title": "Dynamic memory allocation for structs in c", "body": "<p>Struct </p>\n\n<pre><code>typedef struct {\n    char *name;\n    prob_t *prob;\n} name_t;\n</code></pre>\n\n<p>has two pointers as members. So on 32 bit OS, <code>sizeof(name_t)</code> is 8 bytes.\nDynamic creation of instance of <code>name_t</code> struct </p>\n\n<pre><code>name_t *name_dict = (name_t*)malloc(sizeof(name_dict));\n</code></pre>\n\n<p>allocates only 8 bytes to store two pointers. As xanatos said allocated memory is garbage and pointers will point random locations. You can use <code>calloc()</code> when allocation <code>name_dict</code> or manually nullify them <code>name_dict-&gt;name = NULL;name_dict-&gt;prob = NULL;</code>. You can also don't bother yourself by content of pointers and in next code line allocate memory to members</p>\n\n<pre><code>name_dict-&gt;name = (char*)malloc(MAX_LEN*sizeof(char));\nname_dict-&gt;prob = (prob_t*)malloc(sizeof(prob_t));\n</code></pre>\n\n<p>You can also check if memory was allocated good and both pointers don't ppoint to NULL.</p>\n\n<p>To sum up, properly written init_name_dict() method </p>\n\n<pre><code>name_t * init_name_dict() \n{\n  name_t *name_dict = (name_t*)malloc(sizeof(name_t));\n  if  (name_dict != NULL)\n  {\n        name_dict-&gt;name = (char*)malloc(MAX_LEN*sizeof(char)));\n        name_dict-&gt;prob = (prob_t*)malloc(sizeof(prob_t));\n  }\n  return name_dict;\n }\n</code></pre>\n\n<p><strong>Errors</strong> in your code was </p>\n\n<ul>\n<li><p>MAX_LINES here(assume that you want to create only one structure here)</p>\n\n<p><code>name_dict = (name_t*)malloc(MAX_LINES*sizeof(*name_dict));</code></p></li>\n<li><p>MAX_PROB here (assume that you want to create only one structure\nhere)</p>\n\n<p><code>name_dict-&gt;prob = (prob_t*)malloc(MAX_PROB*sizeof(*name_dict-&gt;prob));</code></p></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 102162, "user_id": 613130, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/40bd5f390cba274159501bb244bc29f4?s=128&d=identicon&r=PG", "display_name": "xanatos", "link": "https://stackoverflow.com/users/613130/xanatos"}, "is_accepted": false, "score": 4, "last_activity_date": 1527087061, "last_edit_date": 1527087061, "creation_date": 1527083454, "answer_id": 50490158, "question_id": 50489316, "link": "https://stackoverflow.com/questions/50489316/dynamic-memory-allocation-for-structs-in-c/50490158#50490158", "title": "Dynamic memory allocation for structs in c", "body": "<p>As explained <a href=\"https://stackoverflow.com/questions/1538420/difference-between-malloc-and-calloc\">here</a>, <code>malloc</code> doesn't \"clean\" the memory, that then can be full of garbage (because for example the same memory was returned by another call to <code>malloc()</code>, used and then <code>free()</code>). The three classical solutions are:</p>\n\n<ul>\n<li>Live with it. Set manually all the members of the <code>struct</code> (if you are\nusing the <code>malloc</code> to allocate a <code>struct</code>) before using the <code>struct</code> (or in general set the all the obtained memory to the value you want)</li>\n<li>Use <code>memset</code> to zero all the memory before using it</li>\n<li>Use <code>calloc</code> instead of <code>malloc</code> (note that it has a slightly different signature). <code>calloc</code> is similar to <code>malloc</code> + <code>memset</code>. As an example:</li>\n</ul>\n\n<p></p>\n\n<pre><code>name_t *init_name_dict() {\n    name_t *name_dict;\n    name_dict = calloc(MAX_LINES, sizeof(*name_dict));\n    name_dict-&gt;name = calloc(MAX_LEN, sizeof(*name_dict-&gt;name));\n    name_dict-&gt;prob = calloc(MAX_PROB, sizeof(*name_dict-&gt;prob));\n    return name_dict;\n}\n</code></pre>\n\n<p>As a sidenote, in C you don't need/shouldn't cast a pointer returned by <code>malloc</code>/<code>calloc</code> (<a href=\"https://stackoverflow.com/questions/3477741/why-does-c-require-a-cast-for-malloc-but-c-doesnt\">but if in truth you are using a C++ compiler then you have to cast it...</a>).</p>\n"}, {"tags": [], "owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "is_accepted": false, "score": 1, "last_activity_date": 1527087434, "last_edit_date": 1527087434, "creation_date": 1527085119, "answer_id": 50490787, "question_id": 50489316, "link": "https://stackoverflow.com/questions/50489316/dynamic-memory-allocation-for-structs-in-c/50490787#50490787", "title": "Dynamic memory allocation for structs in c", "body": "<p>If you want cleared memory (as opposed to memory with junk in it), you need <code>calloc</code>\ninstead of <code>malloc</code>, but that's trivial.</p>\n\n<p>You're bigger problems are:</p>\n\n<pre><code>1) no error checking\n2) possibly needless malloc calls\n3) you're allocating MAX_LINES of theses name_t structure but initializing \n  only one of them\n</code></pre>\n\n<p>If the <code>.name</code> and <code>.prob</code> fields won't be reallocated, you should change your <code>name_t</code>\ndefinition to </p>\n\n<pre><code>typedef struct { char name[MAX_LEN]; prob_t prob[MAX_PROB]; } name_t;\n</code></pre>\n\n<p>and allocate all MAX_LINES name_t's in one go: <code>calloc(MAX_LINES, sizeof(name_t))</code>.</p>\n\n<p>If you need the original <code>name_t</code> structure, then I'd have an initializer for one:</p>\n\n<pre><code>int init_name_dict (name_t  *this)\n{\n    if(0==(this-&gt;name=calloc(MAX_LEN, sizeof *this-&gt;name))) return -1;\n    if(0==(this-&gt;prob=calloc(MAX_PROB, sizeof *this-&gt;prob))){ free(this-&gt;name); return -1; }\n    return 0;\n}\n</code></pre>\n\n<p>a destructor for it</p>\n\n<pre><code>void destroy_name_dict(name_t *this) { free(this-&gt;name); free(this-&gt;prob); }\n</code></pre>\n\n<p>and then an initializing allocator for the whole array:</p>\n\n<pre><code>name_t* new_name_dicts(void)\n{\n    name_t *r = malloc(MAX_LINES*sizeof *r);\n    if(!r) return r;\n    int i;\n    for(i=0; i&lt;MAX_LINES; i++)\n        if(0&gt;init_name_dict(&amp;r[i])) goto fail;\n    return r;\n    fail:\n        for(--i; i&gt;=0; --i)\n            destructor_name_dict(&amp;r[i]);\n    return NULL;\n}\n</code></pre>\n\n<p>(Basically what would amount to a C++ vector constructor that picks up the constructor for the\n cell type.)</p>\n"}], "owner": {"reputation": 21, "user_id": 9834656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4e4557951f4a3cfaeadf112017c54f8?s=128&d=identicon&r=PG&f=1", "display_name": "B Rob", "link": "https://stackoverflow.com/users/9834656/b-rob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1079, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1527088115, "creation_date": 1527081016, "question_id": 50489316, "link": "https://stackoverflow.com/questions/50489316/dynamic-memory-allocation-for-structs-in-c", "title": "Dynamic memory allocation for structs in c", "body": "<p>I am trying to initialise a struct by allocating memory to it and it's pointer members using malloc:</p>\n\n<pre><code>typedef struct {\n    char *name;\n    prob_t *prob;\n} name_t;\n</code></pre>\n\n<p>I understand that I need to allocate memory to the pointers separately once the struct is initialised:</p>\n\n<pre><code>name_t\n*init_name_dict() {\n    name_t *name_dict;\n    name_dict = (name_t*)malloc(MAX_LINES*sizeof(*name_dict));\n    name_dict-&gt;name = (char*)malloc(MAX_LEN*sizeof(*name_dict-&gt;name));\n    name_dict-&gt;prob = (prob_t*)malloc(MAX_PROB*sizeof(*name_dict-&gt;prob));\n    return name_dict;\n}\n</code></pre>\n\n<p>But when I do so, it allocates memory to the struct, but not to either of its member pointers (they just point to junk).</p>\n\n<p>What am I doing wrong? Thanks</p>\n"}, {"tags": ["c", "arrays", "memory", "allocation"], "comments": [{"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 1, "creation_date": 1527081088, "post_id": 50489298, "comment_id": 87991456, "body": "Which do you think? Reason about the problem."}, {"owner": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 6, "creation_date": 1527081089, "post_id": 50489298, "comment_id": 87991458, "body": "Either one can happen depending on whether the array can be expanded (e.g.: there is more free space available in the same contiguous memory), see: <a href=\"http://en.cppreference.com/w/c/memory/realloc\" rel=\"nofollow noreferrer\">en.cppreference.com/w/c/memory/realloc</a>"}, {"owner": {"reputation": 81, "user_id": 7738825, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-D9itoPjRDX8/AAAAAAAAAAI/AAAAAAAAAiU/5dWlxfInJ5Y/photo.jpg?sz=128", "display_name": "Robin Camus", "link": "https://stackoverflow.com/users/7738825/robin-camus"}, "edited": false, "score": 0, "creation_date": 1527081162, "post_id": 50489298, "comment_id": 87991525, "body": "duplicates from <a href=\"https://stackoverflow.com/questions/362760/how-do-realloc-and-memcpy-work\" title=\"how do realloc and memcpy work\">stackoverflow.com/questions/362760/&hellip;</a>"}, {"owner": {"reputation": 3723, "user_id": 1169091, "user_type": "registered", "accept_rate": 9, "profile_image": "https://i.stack.imgur.com/5vE4L.jpg?s=128&g=1", "display_name": "nicomp", "link": "https://stackoverflow.com/users/1169091/nicomp"}, "reply_to_user": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 2, "creation_date": 1527081428, "post_id": 50489298, "comment_id": 87991708, "body": "@DaveNewton OP did reason about the problem."}, {"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "reply_to_user": {"reputation": 3723, "user_id": 1169091, "user_type": "registered", "accept_rate": 9, "profile_image": "https://i.stack.imgur.com/5vE4L.jpg?s=128&g=1", "display_name": "nicomp", "link": "https://stackoverflow.com/users/1169091/nicomp"}, "edited": false, "score": 0, "creation_date": 1527082705, "post_id": 50489298, "comment_id": 87992662, "body": "@nicomp I disagree. OP stated some information; that&#39;s not reasoning, that&#39;s recitation. Reasoning means analyzing the impact(s) of the information stated, considering various scenarios that would affect the answer, and so on. One you&#39;ve considered the various scenarios it&#39;s basically self-answering, although the <i>exact</i> answer depends on the memory allocation library/mechanism in use."}, {"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "reply_to_user": {"reputation": 3723, "user_id": 1169091, "user_type": "registered", "accept_rate": 9, "profile_image": "https://i.stack.imgur.com/5vE4L.jpg?s=128&g=1", "display_name": "nicomp", "link": "https://stackoverflow.com/users/1169091/nicomp"}, "edited": false, "score": 1, "creation_date": 1527083400, "post_id": 50489298, "comment_id": 87993164, "body": "@nicomp I&#39;d add also that (to me) reasoning would also mean sharing the results of your own investigation, and that investigation would be required to show due diligence in the question. I mean, if you&#39;re smart enough to ask the question, you&#39;re certainly smart enough to do a fair amount of research, and likely reach the correct conclusion (&quot;it depends&quot;). But to request verification of an assumption on SO, IMO, sets the bar fairly high to show that due diligence YMMV."}, {"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "reply_to_user": {"reputation": 3723, "user_id": 1169091, "user_type": "registered", "accept_rate": 9, "profile_image": "https://i.stack.imgur.com/5vE4L.jpg?s=128&g=1", "display_name": "nicomp", "link": "https://stackoverflow.com/users/1169091/nicomp"}, "edited": false, "score": 1, "creation_date": 1527084812, "post_id": 50489298, "comment_id": 87994121, "body": "@nicomp I&#39;m not trying to be combative or divisive--I just think the question is reasonable self-answerable with suitable application of neurons is all."}], "answers": [{"comments": [{"owner": {"reputation": 103, "user_id": 9741306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76a7342386e559a424a98c3551b29715?s=128&d=identicon&r=PG&f=1", "display_name": "Asm .", "link": "https://stackoverflow.com/users/9741306/asm"}, "edited": false, "score": 0, "creation_date": 1527081297, "post_id": 50489357, "comment_id": 87991620, "body": "Yes, I forgot to add the size of the type in order to avoid bugs and undefined behavior. But in this particular case that i explained at the topic, if i take the same array and resize it to one more cell, how many actions does the realloc function?"}, {"owner": {"reputation": 103, "user_id": 9741306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76a7342386e559a424a98c3551b29715?s=128&d=identicon&r=PG&f=1", "display_name": "Asm .", "link": "https://stackoverflow.com/users/9741306/asm"}, "edited": false, "score": 0, "creation_date": 1527082095, "post_id": 50489357, "comment_id": 87992183, "body": "That&#39;s what i said. I do not take another pointer and relocate the memory for the array a through the new pointer. I take a pointer that keeps the array a address and do realloc on the same pointer like this =&gt;      a = (int*) realloc (a, 11*sizeof(int));"}, {"owner": {"reputation": 80047, "user_id": 169346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/645dbb4f7ba1ff9d7ff2de02f68fbe9c?s=128&d=identicon&r=PG", "display_name": "JeremyP", "link": "https://stackoverflow.com/users/169346/jeremyp"}, "edited": false, "score": 0, "creation_date": 1527084516, "post_id": 50489357, "comment_id": 87993920, "body": "It&#39;s considered best practice in C <a href=\"https://stackoverflow.com/a/605858/169346\">not to cast the result of <code>malloc</code> or <code>realloc</code></a>"}], "tags": [], "owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "is_accepted": false, "score": 9, "last_activity_date": 1527084570, "last_edit_date": 1527084570, "creation_date": 1527081123, "answer_id": 50489357, "question_id": 50489298, "link": "https://stackoverflow.com/questions/50489298/whats-the-time-complexity-of-realloc-function-in-c/50489357#50489357", "title": "What&#39;s the time complexity of realloc function in C?", "body": "<p>First, your code (in the original form of your question) is wrong. It should at least be</p>\n\n<pre><code>a = realloc(a, 11*sizeof(int));\n</code></pre>\n\n<p>(otherwise you probably have undefined behavior, in the usual case when <code>sizeof(int)</code> is greater than one). BTW <code>realloc</code> should not be casted in C.</p>\n\n<p>Then, your question</p>\n\n<blockquote>\n  <p>What's the time complexity of realloc function in C?</p>\n</blockquote>\n\n<p>Has no sense, unless you speak of some <em>particular</em> realloc function whose implementation you do know.</p>\n\n<p>Notice that <a href=\"http://en.cppreference.com/w/c/memory/realloc\" rel=\"nofollow noreferrer\"><code>realloc</code></a> is allowed to fail. Here is an efficient but useless and constant-time implementation of it (see also <a href=\"https://stackoverflow.com/a/8460584/841108\">this</a> answer; it is a standard conforming <code>realloc</code> which follows the letter, but not the spirit, of the standard <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"nofollow noreferrer\">n1570</a>):</p>\n\n<pre><code>void *realloc( void *ptr, size_t new_size ) { \n  errno = ENOMEM;\n  return NULL;\n}\n</code></pre>\n\n<p>At last, in practice, you could consider <code>malloc</code> and <code>realloc</code> as somehow expensive operations (typical runtime could be several microseconds, so thousands of time slower than an addition), and in many cases you don't want to <code>realloc</code> on every loop. So you'll rather use some geometrical growth for <code>realloc</code> (like <a href=\"https://stackoverflow.com/a/19206121/841108\">here</a>)</p>\n\n<blockquote>\n  <p>Does realloc simply add an additional cell into the array and then it takes O(1) or it recopies the whole array a, add the additional 11th cell and return the new-sized array and in this case the time complexity of this action is O(n)? </p>\n</blockquote>\n\n<p>Both can happen. You could imagine that <code>malloc</code> keeps somewhere the allocated size (rounded up by the implementation...) and in good cases <code>realloc</code> returns the same pointer (so O(1)) and in less happy cases it need to copy the memory zone elsewhere. Without knowing your particular implementation (of <code>malloc</code>, <code>realloc</code>, <code>free</code>) you cannot know what is the most common case, or their probability distribution. BTW, it seems that a <code>realloc</code>  implementation which <em>always</em> copy data (or fail) is conforming to the standard (but inefficient). If you need to know more, you should benchmark.</p>\n\n<p>At last, many implementations of the <a href=\"https://en.wikipedia.org/wiki/C_standard_library\" rel=\"nofollow noreferrer\">C standard library</a> are <a href=\"https://en.wikipedia.org/wiki/Free_software\" rel=\"nofollow noreferrer\">free software</a> (e.g. <a href=\"https://www.gnu.org/software/libc/\" rel=\"nofollow noreferrer\">GNU libc</a>, <a href=\"http://musl-libc.org/\" rel=\"nofollow noreferrer\">musl-libc</a>, ...) and you might study their source code of <code>malloc</code>, <code>free</code>, <code>realloc</code> (above <a href=\"https://en.wikipedia.org/wiki/Operating_system\" rel=\"nofollow noreferrer\">operating system</a> primitives -usually <a href=\"https://en.wikipedia.org/wiki/System_call\" rel=\"nofollow noreferrer\">system calls</a>- growing the <a href=\"https://en.wikipedia.org/wiki/Virtual_address_space\" rel=\"nofollow noreferrer\">virtual address space</a>; on Linux, something like <a href=\"http://man7.org/linux/man-pages/man2/mmap.2.html\" rel=\"nofollow noreferrer\">mmap(2)</a>)</p>\n"}, {"comments": [{"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1527084646, "post_id": 50490571, "comment_id": 87994015, "body": "Not exactly. Perhaps some <code>if (old_size == new_size) return old;</code> might happen (but that is not specified). So it is not exactly <i>equivalent</i>. BTW <code>internal_function_that_knows_old_size</code> might not be constant-time!"}, {"owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "reply_to_user": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1527084937, "post_id": 50490571, "comment_id": 87994197, "body": "@BasileStarynkevitch Which part of &quot;It is possible for realloc to have optimizations that in some situations makes it faster&quot; is unclear? And how is your comment relevant to the general case? Every specific case is O(1) which is why talking about big-O of specific cases is irrelevant."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1527085053, "post_id": 50490571, "comment_id": 87994269, "body": "You claim <code>realloc</code> <i>is equivalent to</i> your code, and there is no equivalence but a supposition. My <code>realloc</code> in my answer is a possible (but silly) implementation, and there are many variants (e.g. doing some bit computation on addresses etc...)"}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1527085225, "post_id": 50490571, "comment_id": 87994401, "body": "I would have upvoted your answer if you wrote: &quot;realloc is often implemented with a code similar to&quot;, but since you claim that &quot;realloc is <i>equivalent</i>&quot;, I downvoted your answer. For example, some <i>reasonable</i> implementations of <code>realloc</code> might start with <code>if (new_size &gt; SOME_LARGE_LIMIT) return NULL;</code>; BTW, <code>realloc</code> in practice don&#39;t call <code>malloc</code> (but both call some <i>internal function</i>)"}], "tags": [], "owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "is_accepted": false, "score": 0, "last_activity_date": 1527084566, "creation_date": 1527084566, "answer_id": 50490571, "question_id": 50489298, "link": "https://stackoverflow.com/questions/50489298/whats-the-time-complexity-of-realloc-function-in-c/50490571#50490571", "title": "What&#39;s the time complexity of realloc function in C?", "body": "<p><code>realloc</code> is equivalent to:</p>\n\n<pre><code>void *\nrealloc(void *old, size_t new_size)\n{\n    size_t old_size = internal_function_that_knows_old_size(old);\n    void *new = malloc(new_size);\n    if (new == NULL)\n        return NULL;\n    size_t sz = old_size;\n    if (new_size &lt; old_size)\n        sz = new_size;\n    memcpy(new, old, sz);\n    free(old);\n    return new;\n}\n</code></pre>\n\n<p>It is possible for <code>realloc</code> to have optimizations that in some situations makes it faster, but I'm pretty sure that it's impossible to make those optimizations always work, so the fallback will always be a function that does something like the above, so you should consider this your worst case.</p>\n\n<p>Now, when it comes to time complexity, there is nothing in the standard that requires <code>malloc</code> or <code>free</code> have any reasonable behavior so it is possible that they will dominate the runtime of this function (or <code>internal_function_that_knows_old_size</code> will), but since those bits of the system are usually quite well written that is unlikely. The dominant part (at least for large n, which is where complexity is interesting) will be the <code>memcpy</code>.</p>\n\n<p>So with some reasonable assumptions <code>realloc</code> has to be O(n) (with n being the old or new size of the allocation whichever is smaller).</p>\n"}], "owner": {"reputation": 103, "user_id": 9741306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76a7342386e559a424a98c3551b29715?s=128&d=identicon&r=PG&f=1", "display_name": "Asm .", "link": "https://stackoverflow.com/users/9741306/asm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3207, "favorite_count": 0, "answer_count": 2, "score": 5, "last_activity_date": 1527084578, "creation_date": 1527080952, "last_edit_date": 1527084578, "question_id": 50489298, "link": "https://stackoverflow.com/questions/50489298/whats-the-time-complexity-of-realloc-function-in-c", "title": "What&#39;s the time complexity of realloc function in C?", "body": "<p>I have a question: what's the time complexity of realloc function?\nFor example, I have an array of integers: a[10]. Of course, the array has been dynamically allocated in this way =></p>\n\n<pre><code>int *a = (int*)malloc(10*sizeof(int));\n</code></pre>\n\n<p>And then I want to resize this array to 11 in order to insert an additional value to the array a, so I do =></p>\n\n<pre><code>a = (int*)realloc(a, 11*sizeof(int));\n</code></pre>\n\n<p>My question is: What's the time complexity of reallocation? Does realloc simply add an additional cell into the array and then it takes O(1) or it recopies the whole array a, add the additional 11th cell and return the new-sized array and in this case the time complexity of this action is O(n)? Which assumption is true?</p>\n"}, {"tags": ["c", "data-structures"], "comments": [{"owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "edited": false, "score": 1, "creation_date": 1527079365, "post_id": 50488578, "comment_id": 87990244, "body": "<code>typedef struct list { .... } List</code> defines <code>List</code> as an alias for type <code>struct list</code>. Henceforth, you can write <code>List</code> wherever you would have to write <code>struct list</code> otherwise. Still something unclear?"}, {"owner": {"reputation": 15, "user_id": 9834477, "user_type": "registered", "profile_image": "https://graph.facebook.com/2081283998867394/picture?type=large", "display_name": "Rajesh Kummar", "link": "https://stackoverflow.com/users/9834477/rajesh-kummar"}, "reply_to_user": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "edited": false, "score": 0, "creation_date": 1527079681, "post_id": 50488578, "comment_id": 87990487, "body": "Thank you so much Stephan that make sense to me :)"}], "answers": [{"tags": [], "owner": {"reputation": 608, "user_id": 9502067, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/261b06a0bd237491cbf6130b573b1a2e?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander Pane", "link": "https://stackoverflow.com/users/9502067/alexander-pane"}, "is_accepted": true, "score": 0, "last_activity_date": 1527081134, "last_edit_date": 1527081134, "creation_date": 1527080780, "answer_id": 50489235, "question_id": 50488578, "link": "https://stackoverflow.com/questions/50488578/how-to-read-data-structure-from-node-list-with-custom-types-in-c/50489235#50489235", "title": "how to read data structure from node list with custom types in c", "body": "<p>In order to correctly write in memory, you need to correctly allocate the latter.\nI leave you here an example (I omitted all the checks, but these should be done!):</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\n#define N 5\n#define ID_LEN 64\n#define NAME_LEN 64\n#define DESC_LEN 64\n\ntypedef struct price\n{\n    unsigned dollars;\n    unsigned cents;\n} Price;\n\n/**\n* Stores data for a stock item.\n**/\ntypedef struct stock\n{\n    char id[ID_LEN];\n    char name[NAME_LEN];\n    char desc[DESC_LEN];\n    Price price;\n    unsigned onHand;\n} Stock;\n\n/**\n* The node that holds the data about an item stored in memory.\n**/\ntypedef struct node\n{\n    Stock *data;\n    struct node *next;\n} Node;\n\n/**\n* The list of products - each link in the list is a Node.\n**/\n\ntypedef struct list\n{\n    Node *head;\n    unsigned size;\n} List;\n\nint main() {\n    List l;\n    int i;\n    l.size = N;\n    l.head = (Node*) malloc (l.size * sizeof(Node));\n    for (i = 0; i &lt; l.size; i++) {\n        l.head[i].data = (Stock*) malloc (sizeof(Stock));\n    }\n\n    //you can now fill you data\n    //example\n    strcpy(l.head[0].data-&gt;id, \"test\\n\");\n    printf(\"id of element 0: %s\\n\", l.head[0].data-&gt;id);\n    //example\n    strcpy(l.head[1].data-&gt;name, \"Paul\\n\");\n    printf(\"name of element 1: %s\\n\", l.head[1].data-&gt;name);\n    //example\n    l.head[2].data-&gt;price.dollars = 99;\n    l.head[2].data-&gt;price.cents = 99;\n    printf(\"price of element 2: %d.%d $\\n\", l.head[2].data-&gt;price.dollars, l.head[2].data-&gt;price.cents);\n\n    return 0;\n}\n</code></pre>\n\n<p>You can run it and check that everything is stored fine.</p>\n\n<p>NOTE: I didn't connect the node pointer next!</p>\n"}], "owner": {"reputation": 15, "user_id": 9834477, "user_type": "registered", "profile_image": "https://graph.facebook.com/2081283998867394/picture?type=large", "display_name": "Rajesh Kummar", "link": "https://stackoverflow.com/users/9834477/rajesh-kummar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 50489235, "answer_count": 1, "score": 0, "last_activity_date": 1527098160, "creation_date": 1527078891, "last_edit_date": 1527098160, "question_id": 50488578, "link": "https://stackoverflow.com/questions/50488578/how-to-read-data-structure-from-node-list-with-custom-types-in-c", "title": "how to read data structure from node list with custom types in c", "body": "<p>Please help me to find a way read/add something to this data list by C language. I am confused in with <code>typeDef</code> statement.</p>\n\n<pre><code>typedef struct price\n{\n    unsigned dollars;\n    unsigned cents;\n} Price;\n\n/**\n * Stores data for a stock item.\n **/\ntypedef struct stock\n{\n    char id[ID_LEN + NULL_SPACE];\n    char name[NAME_LEN + NULL_SPACE];\n    char desc[DESC_LEN + NULL_SPACE];\n    Price price;\n    unsigned onHand;\n} Stock;\n\n/**\n * The node that holds the data about an item stored in memory.\n **/\ntypedef struct node\n{\n    Stock *data;\n    struct node *next;\n} Node;\n\n/**\n * The list of products - each link in the list is a Node.\n **/\n\ntypedef struct list\n{\n    Node *head;\n    unsigned size;\n} List;\n</code></pre>\n"}, {"tags": ["c", "ubuntu", "pthreads", "double-pointer", "pthread-barriers"], "comments": [{"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 1, "creation_date": 1527079739, "post_id": 50488069, "comment_id": 87990529, "body": "Compile with all warnings &amp; debug info: <code>gcc -Wall -Wextra -g</code> with <a href=\"http://gcc.gnu.org/\" rel=\"nofollow noreferrer\">GCC</a>. Improve your code to get no warnings. <a href=\"https://sourceware.org/gdb/current/onlinedocs/gdb/\" rel=\"nofollow noreferrer\">use the <code>gdb</code> debugger</a> and also <a href=\"http://valgrind.org/\" rel=\"nofollow noreferrer\">valgrind</a> to understand the behavior of your program"}], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 8156652, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-2cdY92hGjA4/AAAAAAAAAAI/AAAAAAAAAFo/_ElFwBkLQKY/photo.jpg?sz=128", "display_name": "george nikitas", "link": "https://stackoverflow.com/users/8156652/george-nikitas"}, "edited": false, "score": 0, "creation_date": 1527079523, "post_id": 50488291, "comment_id": 87990371, "body": "Wow I did not see that o_O!!! I was looking for more complex solutions for some reason. THANK YOU!!!"}, {"owner": {"reputation": 608, "user_id": 9502067, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/261b06a0bd237491cbf6130b573b1a2e?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander Pane", "link": "https://stackoverflow.com/users/9502067/alexander-pane"}, "reply_to_user": {"reputation": 39, "user_id": 8156652, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-2cdY92hGjA4/AAAAAAAAAAI/AAAAAAAAAFo/_ElFwBkLQKY/photo.jpg?sz=128", "display_name": "george nikitas", "link": "https://stackoverflow.com/users/8156652/george-nikitas"}, "edited": false, "score": 0, "creation_date": 1527080934, "post_id": 50488291, "comment_id": 87991353, "body": "@georgenikitas No problem! I know that feeling of not working code for just typos is so frustrating :) Anyhow, if that was the only problem you can accept the answer and close it."}], "tags": [], "owner": {"reputation": 608, "user_id": 9502067, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/261b06a0bd237491cbf6130b573b1a2e?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander Pane", "link": "https://stackoverflow.com/users/9502067/alexander-pane"}, "is_accepted": true, "score": 3, "last_activity_date": 1527078100, "creation_date": 1527078100, "answer_id": 50488291, "question_id": 50488069, "link": "https://stackoverflow.com/questions/50488069/segmentation-fault-core-dumped-in-c-while-using-pthreads/50488291#50488291", "title": "Segmentation fault (core dumped) in C - While Using PTHREADS", "body": "<p>I think the only problem are the indexes in the following lines:</p>\n\n<pre><code>for(i=0;i&lt;p;i++){\n    pthread_create(&amp;tid[id],NULL,add,(void *)(long) i);\n}\nfor(i=0;i&lt;p;i++){\n    pthread_join(tid[id],NULL);\n}\n</code></pre>\n\n<p>id has only been declared, but never initialized! Maybe it's just a typo and you wanted to use <code>i</code> as index for the <code>tid</code></p>\n\n<p>The solutions should be:</p>\n\n<pre><code>for(i=0;i&lt;p;i++){\n    pthread_create(&amp;tid[i],NULL,add,(void *)(long) i);\n}\nfor(i=0;i&lt;p;i++){\n    pthread_join(tid[i],NULL);\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "is_accepted": false, "score": 1, "last_activity_date": 1527090546, "last_edit_date": 1527090546, "creation_date": 1527079555, "answer_id": 50488799, "question_id": 50488069, "link": "https://stackoverflow.com/questions/50488069/segmentation-fault-core-dumped-in-c-while-using-pthreads/50488799#50488799", "title": "Segmentation fault (core dumped) in C - While Using PTHREADS", "body": "<p>The answer to the source of your core dump problem has already been addressed, but to address the other things you asked, or stated:    </p>\n\n<p><strong>1st:</strong><br>\nRegarding your statement: <em>i have them as pointers because i don not know the size,the user gives it as argument</em>.  </p>\n\n<p>Often times, in C, you can avoid using <code>calloc</code>/<code>malloc</code> in your code by using VLAs instead. Available in C99 and beyond.  (see links)<br>\n<em><a href=\"https://en.wikipedia.org/wiki/Variable-length_array\" rel=\"nofollow noreferrer\">VLA a</a></em><br>\n<em><a href=\"https://stackoverflow.com/questions/22530363/whats-the-point-of-vla-anyway\">VLA b</a></em>   </p>\n\n<p><strong>2nd:</strong><br>\nRegarding your statement: <em>I know it gets a little bit messy</em>...<br>\nIts really not <em>that</em> messy, but you could consider cleaning up the memory allocation/freeing steps by moving most of the work into a function:</p>\n\n<pre><code>long int **A,**B,**C;\nint N;\n... \n//in main\nN = atoi(argv[2]); \nA = Create2D(N, N);\nB = Create2D(N, N);\nB = Create2D(N, N);\n...\nfree2D(A, N);\nfree2D(B, N);\nfree2D(C, N);\n\n\nlong ** Create2D(int c, int r)\n{   \n    long **arr;\n    int    y = 0;\n\n    arr   = calloc(c, sizeof(long *));\n    for(y=0;y&lt;c;y++)\n    {\n        arr[y] = calloc((2*y)+1, sizeof(long)); \n    }\n    return arr;\n}\n\nvoid free2D(long **arr, int c)\n{\n    int i;\n    if(!arr) return;\n    for(i=0;i&lt;c;i++)\n    {\n        if(arr[i]) \n        {\n            free(arr[i]);\n            arr[i] = NULL;\n        }\n    }\n    free(arr);\n    arr = NULL;\n}\n</code></pre>\n\n<p>Side note:<br>\nThere is nothing absolutely <em>wrong</em> with your memory statements as they are:  </p>\n\n<pre><code>A = (long int**) malloc(N*sizeof(long int*));  \n</code></pre>\n\n<p>However, although C++ requires it, there is no reason to cast the return of <code>malloc</code> ,<code>calloc</code> or <code>realloc</code> when using C.  (<em><a href=\"https://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc\">See discussion here</a></em>) The following is sufficient (in C):</p>\n\n<pre><code>A = malloc(N*sizeof(long int*));\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 8156652, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-2cdY92hGjA4/AAAAAAAAAAI/AAAAAAAAAFo/_ElFwBkLQKY/photo.jpg?sz=128", "display_name": "george nikitas", "link": "https://stackoverflow.com/users/8156652/george-nikitas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 269, "favorite_count": 0, "accepted_answer_id": 50488291, "answer_count": 2, "score": 0, "last_activity_date": 1527090546, "creation_date": 1527077429, "question_id": 50488069, "link": "https://stackoverflow.com/questions/50488069/segmentation-fault-core-dumped-in-c-while-using-pthreads", "title": "Segmentation fault (core dumped) in C - While Using PTHREADS", "body": "<p><strong><em>Hello guys,</em></strong>\nI have a problem in my code and i do not know how to fix it(A Segmentation fault(core dumped))!</p>\n\n<p>So my teacher wants me to write a program that creates N treads and makes them do some calculations.I have 3 global 2d arrays A,B,C (i have them as pointers because i don not  know the size,the user gives it as argument).I try to allocate memory to them in the main function.</p>\n\n<p>So the problem is i get a Segmentation fault when i try to create the treads in \"pthread_create(&amp;tid[id],NULL,add,(void *)(long) i);\" :(.\nI can't figure out why this is happening.I tried using the gdb command but the result was that the problem is in pthread_create.</p>\n\n<p>However when i put in comment the arrays(A,B,C) and the malloc they are using is runs(but the final result is 0).</p>\n\n<p>I am using a virtual box(with Ubuntu inside if that helps :D).</p>\n\n<p>The following code is what i wrote so far:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;pthread.h&gt;\n#include &lt;unistd.h&gt;\n\nlong int p,N,Total_Sum;\nlong int **A,**B,**C;\npthread_mutex_t mutex = PTHREAD_MUTEX_INITIALIZER;\npthread_barrier_t bar;\n\nvoid * add(void *arg){\n\n    long int i,j,Local_Sum=0;\n    long int lines,start,end,id;\n\n    id = (long int)arg;\n    lines = N/p;\n    start = id*lines;\n    end = start+lines;\n\n    for(i=start;i&lt;end;i++){\n        for(j=0;j&lt;N;j++){\n            A[i][j] = 1;\n            B[i][j] = 1;\n        }\n    }\n    for(i=start;i&lt;end;i++){\n        for(j=0;j&lt;N;j++){\n            C[i][j] = A[i][j] * B[i][j];\n            Local_Sum += C[i][j];\n            printf(\"C[%ld][%ld] = %ld\\n\",i,j,C[i][j]);\n        }\n    }\n    pthread_mutex_lock(&amp;mutex);\n    Total_Sum += Local_Sum;\n    pthread_mutex_unlock(&amp;mutex);\n    pthread_barrier_wait(&amp;bar);\n    pthread_exit(0);\n}\n\nint main(int argc, char *argv[]){\n\n    long int i,j,id;\n    pthread_t *tid;\n    if(argc!=3){\n        printf(\"Provide Number Of Threads And Size\\n\");\n        exit(1);\n    }\n    p = atoi(argv[1]);\n    tid = (pthread_t *) malloc(p*sizeof(pthread_t));\n    if(tid == NULL){\n        printf(\"Could Not Allocate Memory\\n\");\n        exit(1);\n    }\n\n    pthread_barrier_init(&amp;bar,NULL,p);\n\n    N = atoi(argv[2]);\n    A = (long int**) malloc(N*sizeof(long int*));\n    B = (long int**) malloc(N*sizeof(long int*));\n    C = (long int**) malloc(N*sizeof(long int*));\n\n    for(i=0;i&lt;N;i++){\n        A[i] = (long int*) malloc(N*sizeof(long int));\n        B[i] = (long int*) malloc(N*sizeof(long int));\n        C[i] = (long int*) malloc(N*sizeof(long int));\n    }\n\n    if((A==NULL) || (B == NULL) || (C == NULL)){\n        printf(\"Count Not Allocate Memory\\n\");\n        exit(1);\n    }\n\n    for(i=0;i&lt;p;i++){\n        pthread_create(&amp;tid[id],NULL,add,(void *)(long) i);\n    }\n    for(i=0;i&lt;p;i++){\n        pthread_join(tid[id],NULL);\n    }\n\n    for(i=0;i&lt;N;i++){\n        free(A[i]);\n        free(B[i]);\n        free(C[i]);\n    }\n    free(A);\n    free(B);\n    free(C);\n\n    printf(\"Final Result Is Equal To: %ld\\n\",Total_Sum);\n\n    return 0;\n}\n</code></pre>\n\n<p>******I know it gets a little bit messy because of the mutex and the the barriers but ask me for further specifications :D.******</p>\n\n<p><strong><em>Thanks!!!!!!</em></strong></p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 3, "creation_date": 1527075668, "post_id": 50487483, "comment_id": 87987627, "body": "The posted code shouldn&#39;t even compile.  The <code>if-else</code> in your <code>computeRowsCols()</code> function is badly broken."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 5, "creation_date": 1527075987, "post_id": 50487483, "comment_id": 87987830, "body": "And when passing a struct as pointer you&#39;d use <code>-&gt;</code> rather than <code>.</code>."}, {"owner": {"reputation": 6676, "user_id": 3716664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fN14n.png?s=128&g=1", "display_name": "tilz0R", "link": "https://stackoverflow.com/users/3716664/tilz0r"}, "edited": false, "score": 0, "creation_date": 1527076943, "post_id": 50487483, "comment_id": 87988529, "body": "<a href=\"https://www.tutorialspoint.com/cprogramming/c_pointers.htm\" rel=\"nofollow noreferrer\">tutorialspoint.com/cprogramming/c_pointers.htm</a>"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1527077090, "post_id": 50487483, "comment_id": 87988621, "body": "To me this is unclear. Are you asking how you can pass a variable size matrix to a function ?"}, {"owner": {"reputation": 23, "user_id": 9796344, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Cherry", "link": "https://stackoverflow.com/users/9796344/cherry"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1527077098, "post_id": 50487483, "comment_id": 87988630, "body": "@AndrewHenle This is just a sample code, the actual program is quite big and if you can help me with this part of the code, I would be thankful. <code>int (*func1( int A[3][3]))[3]  &#47;* required : int (*func1( int A[str.rows][str.cols]))[str.cols] *&#47; { ... return A; }</code>"}, {"owner": {"reputation": 23, "user_id": 9796344, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Cherry", "link": "https://stackoverflow.com/users/9796344/cherry"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1527077217, "post_id": 50487483, "comment_id": 87988726, "body": "@4386427 Yes I need to pass a variable size matrix to a function. How can I do that?"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 2, "creation_date": 1527077419, "post_id": 50487483, "comment_id": 87988849, "body": "The function could look: <code>void func(int rows, int cols, int A[][cols]) { ... };</code> and you&#39;ll call it like: <code>func(str.rows, str.cols, A);</code>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1527077740, "post_id": 50487483, "comment_id": 87989060, "body": "<code>void computeRowsCols(matrix *str, int val){ ...         str.rows = 3;</code> does not compile and this post lacks the certain compiler error message.  Post all the compiler error messages and a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 23, "user_id": 9796344, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Cherry", "link": "https://stackoverflow.com/users/9796344/cherry"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1527082780, "post_id": 50487483, "comment_id": 87992726, "body": "@4386427 Thanks the problem is half solved. I am able to use rows and cols for <code>A[3][3]</code> as <code>A[rows][cols]</code> in <code>int (*func1( int rows, int cols, int A[][cols]))[3]  &#47;* required : int (*func1( int rows, int cols, int A[][cols]))[col]  *&#47; { ... return A; }</code> But the only problem is it&#39;s not allowing me to use <code>cols</code> next to <code>int (*func1( int rows, int cols, int A[][cols]))</code> i.e i have to use <code>[3]</code> for the program to compile, but I need to insert <code>[col]</code> there."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1527144538, "post_id": 50487483, "comment_id": 88017731, "body": "@Cherry I don&#39;t understand what you are trying to do with this: <code>&#47;* required : int (*func1( int rows, int cols, int A[][cols]))[col] *&#47; { ... return A; }</code> It&#39;s illegal C code and consequently it&#39;s meaningless. My previous comment tells you how you declare the function and how you call. That&#39;s all. Just do it like the comment says and you&#39;re done :-)"}], "owner": {"reputation": 23, "user_id": 9796344, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Cherry", "link": "https://stackoverflow.com/users/9796344/cherry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 115, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1527076887, "creation_date": 1527075592, "last_edit_date": 1527076887, "question_id": 50487483, "link": "https://stackoverflow.com/questions/50487483/using-struct-parameters-in-a-function-call-in-c", "title": "Using struct parameters in a function call in C", "body": "<p>Problem with using the parameters from a struct in a function. I am new to C and I couldn't find any related solutions online. Please find the below code and help me how to use the parameters from a struct in a function.</p>\n\n<pre><code>typedef struct{\nint rows;\nint cols;\n}matrix;\n\n/* Find the number of rows and columns */\nvoid computeRowsCols(matrix *str, int val)\n{\n    if (condition)\n        {\n        str.rows = 3;\n        str.cols = 3;\n        }\n    else\n        {\n        str.rows = 6;\n        str.cols = 6;\n        }\n}\n\n\n/* Find the matrix with the number of rows and columns\nvoid computeMatrix(int val)\n{\n\n    matrix str;\n    computeRowsCols(&amp;str,val);\n\n    int A[str.rows][str.cols];\n    int (*mat)[str.cols] = &amp;A[str.cols]; /* Pointer to a matrix */\n\n    if (condition)\n        mat = func1(A);\n    else\n        mat = func2(A);\n\n}\n</code></pre>\n\n<p>When I call <strong>func1(A)</strong>, I am manually entering the number of rows, cols. But I need to take the values of rows, cols from the function <strong>computeRowsCols()</strong> as commented below in the <em>required</em> section</p>\n\n<pre><code>int (*func1( int A[3][3]))[3] \n/* required : int (*func1( int A[str.rows][str.cols]))[str.cols] */\n{\n...\nreturn A;\n}\n\nint (*func2( int A[6][6]))[6]\n/* required : int (*func2( int A[str.rows][str.cols]))[str.cols] */\n{\n...\nreturn A;\n}\n\nint main()\n{\n    int val = 10;\n    computeMatrix(val);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "jemalloc"], "comments": [{"owner": {"reputation": 2156, "user_id": 3476954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fb810a12cd393949bca88e4b0cdba75?s=128&d=identicon&r=PG&f=1", "display_name": "Mansoor", "link": "https://stackoverflow.com/users/3476954/mansoor"}, "edited": false, "score": 0, "creation_date": 1588872153, "post_id": 50487418, "comment_id": 109074484, "body": "pthreads is a header API for Unix threading, I wouldn&#39;t expect it to build on Windows. There is possibly something wrong in the config .sh scripts if it is checking for pthreads on windows."}], "owner": {"reputation": 326, "user_id": 6517394, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yaIhE.jpg?s=128&g=1", "display_name": "lemon", "link": "https://stackoverflow.com/users/6517394/lemon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 287, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1527440639, "creation_date": 1527075402, "last_edit_date": 1527440639, "question_id": 50487418, "link": "https://stackoverflow.com/questions/50487418/jemalloc-env-setup-on-windows-vs2017", "title": "jemalloc env setup on Windows VS2017", "body": "<p>I'm following the instructions given <a href=\"https://github.com/jemalloc/jemalloc-cmake/tree/master/msvc\" rel=\"nofollow noreferrer\">here</a> (this page indicates VS2015, but the folder obtained from released jemalloc contains sln for both 2015 and 2017), and it fails running:</p>\n\n<pre><code>bash -c \"CC=cl.exe ./autogen.sh\"\n</code></pre>\n\n<p>from \"VS x86 Native Tools Command Prompt\" (VS2017 here) with the following log:</p>\n\n<pre><code>&gt; checking pthread.h usability... no checking pthread.h presence... yes\n&gt; configure: WARNING: pthread.h: present but cannot be compiled\n&gt; configure: WARNING: pthread.h:     check for missing prerequisite\n&gt; headers? configure: WARNING: pthread.h: see the Autoconf documentation\n&gt; configure: WARNING: pthread.h:     section \"Present But Cannot Be\n&gt; Compiled\" configure: WARNING: pthread.h: proceeding with the\n&gt; compiler's result checking for pthread.h... no configure: error:\n&gt; pthread.h is missing Error 0 in ./configure\n</code></pre>\n\n<p>I think I miss some prerequisites or something. I've tried to install pthread manually from <a href=\"ftp://sourceware.org/pub/pthreads-win32/dll-latest\" rel=\"nofollow noreferrer\">ftp://sourceware.org/pub/pthreads-win32/dll-latest</a> (following some google links).\nBut is it the good link? </p>\n\n<p>I've also seen some answers here like this <a href=\"https://stackoverflow.com/questions/33535025/how-to-compile-jemalloc-on-windows\">one</a>, but it does not work for me, maybe because referencing an older version of jemalloc.</p>\n\n<p>How to install jemalloc properly on Windows? </p>\n\n<p>Edit:\nTried to use Cygwin instead of bash, the error is now:</p>\n\n<pre><code>&gt; configure: error: Unsupported intmax_t size: 0\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 0, "creation_date": 1527072771, "post_id": 50486497, "comment_id": 87985767, "body": "You mean how the actual header is defined/implemented or what the C standard states it should include?"}, {"owner": {"reputation": 494, "user_id": 1383880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/258c2172c30ab4b732d6fb83ffb2c586?s=128&d=identicon&r=PG", "display_name": "CannedMoose", "link": "https://stackoverflow.com/users/1383880/cannedmoose"}, "edited": false, "score": 1, "creation_date": 1527073008, "post_id": 50486497, "comment_id": 87985924, "body": "I would lookup via the headers. IMO a good site to look that up would be <a href=\"http://en.cppreference.com/w/c/header\" rel=\"nofollow noreferrer\">C Standard Library headers on C++Reference</a>"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 3, "creation_date": 1527073033, "post_id": 50486497, "comment_id": 87985935, "body": "Questions asking where to find off-site resources are off-topic. That being said, the easiest is to Google &quot;C11 draft&quot;, download the pdf, then go read Appendix B - Library Summary."}, {"owner": {"user_type": "does_not_exist", "display_name": "user777337"}, "edited": false, "score": 0, "creation_date": 1527075439, "post_id": 50486497, "comment_id": 87987478, "body": "Updated the question to indicate I&#39;d much prefer a way to do this locally, not using an off-site resource."}, {"owner": {"reputation": 4150, "user_id": 7412986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xOv4e.png?s=128&g=1", "display_name": "AlexP", "link": "https://stackoverflow.com/users/7412986/alexp"}, "edited": false, "score": 0, "creation_date": 1527078773, "post_id": 50486497, "comment_id": 87989822, "body": "What exact macros, constants, variables, types and functions are declared when you <code>#include &lt;stdlib.h&gt;</code> is irrelevant -- you are allowed to use only those which the standard says you are allowed to use. The final draft of the standard is <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"nofollow noreferrer\">available on-line</a>. (The actual standard costs money, but it is the exact same as the final draft.) You would normally be more interested to find out what header to include to get a specific function or macro, rather than to find out what functions or macros you get from a specific header."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1527085599, "post_id": 50486497, "comment_id": 87994678, "body": "Look up the C Standard (N1570), this is more reliable than any other info"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user777337"}, "edited": false, "score": 0, "creation_date": 1527075498, "post_id": 50486781, "comment_id": 87987524, "body": "Sorry for the confusion. I updated the question to clarify <code>stdlib</code>: what are all the functions, types and constants I get with <code>#include &lt;stdlib&gt;</code>?"}, {"owner": {"reputation": 61555, "user_id": 648658, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/75ee864ee3bef78f2a144398789fed25?s=128&d=identicon&r=PG", "display_name": "Jens", "link": "https://stackoverflow.com/users/648658/jens"}, "edited": false, "score": 1, "creation_date": 1527084225, "post_id": 50486781, "comment_id": 87993720, "body": "@BrunoSutic There is no simple answer to this since it depends on the particular <i>Standard</i> and <i>Feature Test Macros</i> you specify when compiling. I.e. <code>gcc -std=c89</code> will make a different set available than <code>gcc -std=c11 -D_POSIX_SOURCE</code>."}, {"owner": {"reputation": 61555, "user_id": 648658, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/75ee864ee3bef78f2a144398789fed25?s=128&d=identicon&r=PG", "display_name": "Jens", "link": "https://stackoverflow.com/users/648658/jens"}, "edited": false, "score": 0, "creation_date": 1527084436, "post_id": 50486781, "comment_id": 87993865, "body": "@BrunoSutic That said, you can look at the preprocessing result to see what you get in all its glory. Assuming gcc on a unixoid system, use <code>gcc -E &#47;usr&#47;include&#47;stdlib.h</code>."}], "tags": [], "owner": {"reputation": 61555, "user_id": 648658, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/75ee864ee3bef78f2a144398789fed25?s=128&d=identicon&r=PG", "display_name": "Jens", "link": "https://stackoverflow.com/users/648658/jens"}, "is_accepted": false, "score": 2, "last_activity_date": 1527084707, "last_edit_date": 1527084707, "creation_date": 1527073495, "answer_id": 50486781, "question_id": 50486497, "link": "https://stackoverflow.com/questions/50486497/reference-of-all-functions-and-constants-in-stdlib-h-stdio-h/50486781#50486781", "title": "Reference of all functions and constants in stdlib.h, stdio.h?", "body": "<p>Your terminology <code>stdlib</code> is not well-defined. There's a \"Standard I/O Library\" as part of the C Programming Language, and a <code>stdlib.h</code> header file.</p>\n\n<p>For C identifiers, here's an overview for <a href=\"http://www.schweikhardt.net/identifiers.html\" rel=\"nofollow noreferrer\">ISO C and POSIX identifiers</a>.</p>\n\n<p>Apart from that, you can look at the symbols in library files with</p>\n\n<pre><code>nm -AP /path/to/libfoobar.a\n</code></pre>\n\n<p><strong>Update</strong></p>\n\n<p>To inspect a header in the form the compiler sees it, look at the result of preprocessing (<code>-E</code>):</p>\n\n<pre><code>$ gcc -E /usr/include/stdlib.h|less\ntypedef unsigned char __u_char;\ntypedef unsigned short int __u_short;\ntypedef unsigned int __u_int;\ntypedef unsigned long int __u_long;\n[...]\ntypedef struct\n  {\n    int quot;\n    int rem;\n  } div_t;\ntypedef struct\n  {\n    long int quot;\n    long int rem;\n  } ldiv_t;\n[...]\nextern long int random (void) __attribute__ ((__nothrow__ , __leaf__));\n[...]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": false, "score": 2, "last_activity_date": 1527080248, "last_edit_date": 1527080248, "creation_date": 1527079509, "answer_id": 50488782, "question_id": 50486497, "link": "https://stackoverflow.com/questions/50486497/reference-of-all-functions-and-constants-in-stdlib-h-stdio-h/50488782#50488782", "title": "Reference of all functions and constants in stdlib.h, stdio.h?", "body": "<p>When you include one of the standard C headers, at least three types of identifiers may be declared:</p>\n\n<ul>\n<li><p>Identifiers specified by the C standard. The authoritative source for information on these is <a href=\"https://stackoverflow.com/questions/81656/where-do-i-find-the-current-c-or-c-standard-documents\">the C standard</a>, plus documentation for the C implementation you are using.</p></li>\n<li><p>Identifiers for extensions to the C language. For example, the headers may declare identifiers for POSIX functions. The headers might declare such identifiers only if you have requested them by defining certain preprocessor symbols before including the headers.</p></li>\n<li><p>Identifiers for internal use of the C implementation. These identifiers commonly begin with an underscore followed by another underscore or a caputal letter, as the C standard reserves those. You can discover these identifiers by examining the actual header files in your C implementation, but you should not use them unless documentation for your implementation offers them for use.</p></li>\n</ul>\n\n<p>Overall, if you want to know what C provides in the standard headers, you should read either the C standard (for authoritative information) or a good C textbook (for tutorial information). If you want to know what else is in the headers, there is a large variety of things that an implementation <strong>could</strong> put into the headers, so the way to find out what is there is to read the documentation for the implementation and/or to examine the header file and then find the documentation for the extra things it provides, such as the <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/toc.htm\" rel=\"nofollow noreferrer\">POSIX documentation</a>.</p>\n\n<p>You asked for sources on your computer. Your C implementation may come with documentation, and Unix includes documentation accessible via the <code>man</code> command. While you can examine the actual header files, it is important to understand the current contents of the headers do not constitute any promise about future behavior. Any internal identifiers may change in future versions, and the behavior of standard identifiers may change as permitted by the C standard.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user777337"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 539, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1527084707, "creation_date": 1527072667, "last_edit_date": 1527077424, "question_id": 50486497, "link": "https://stackoverflow.com/questions/50486497/reference-of-all-functions-and-constants-in-stdlib-h-stdio-h", "title": "Reference of all functions and constants in stdlib.h, stdio.h?", "body": "<p>I'd like to look up all the functions, constants and types defined in C libraries: <code>stdlib.h</code>, <code>stdio.h</code>, <code>ctype.h</code> etc. So, when in C program I do: <code>#include &lt;stdlib.h&gt;</code> or <code>#include &lt;stdio.h&gt;</code> I'd like to know what are all the functions, constants and types I get with that?</p>\n\n<p>What's the easiest way to do this <strong>locally on the computer</strong>? I'm not so much interested in online references, especially if they're not official.</p>\n\n<p>Is there a manpage that lists this for eg <code>stdlib</code>? Does maybe GNU <code>info</code> program have docs for this? Or do I have to find an actual header file and look it up?</p>\n\n<p>I'd prefer an universal approach, but if it differs from system to system I'm curious how to do that on both Mac and Linux?</p>\n"}, {"tags": ["c", "mips", "cpu", "tlb", "soc"], "comments": [{"owner": {"reputation": 30055, "user_id": 2755607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0b903bf594599a27ed5df3776e42c5b?s=128&d=identicon&r=PG", "display_name": "dave_59", "link": "https://stackoverflow.com/users/2755607/dave-59"}, "edited": false, "score": 0, "creation_date": 1527137422, "post_id": 50486367, "comment_id": 88014766, "body": "What does your question have to do with RTL or SystemVerilog?"}, {"owner": {"reputation": 1, "user_id": 2862508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d36f7150f71db2f69533b64cada80042?s=128&d=identicon&r=PG&f=1", "display_name": "user2862508", "link": "https://stackoverflow.com/users/2862508/user2862508"}, "reply_to_user": {"reputation": 30055, "user_id": 2755607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0b903bf594599a27ed5df3776e42c5b?s=128&d=identicon&r=PG", "display_name": "dave_59", "link": "https://stackoverflow.com/users/2755607/dave-59"}, "edited": false, "score": 0, "creation_date": 1527161305, "post_id": 50486367, "comment_id": 88028323, "body": "i worked on the verification of a SOC Design  who use MIPS as CPU and this design DUT is instantiated in TESTBENCH (System verilog), but my question is for who master the CPU MIPS Architecture"}], "owner": {"reputation": 1, "user_id": 2862508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d36f7150f71db2f69533b64cada80042?s=128&d=identicon&r=PG&f=1", "display_name": "user2862508", "link": "https://stackoverflow.com/users/2862508/user2862508"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 189, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1527161366, "creation_date": 1527072246, "last_edit_date": 1527161366, "question_id": 50486367, "link": "https://stackoverflow.com/questions/50486367/in-mips-tlb-confusion-between-virtual-and-physical-addresses", "title": "In MIPS TLB, Confusion between virtual and physical addresses", "body": "<p>I have some C code running in RTL mode, I use <code>CPU I6400</code> the C code is just a simple code to read and write from some subsystem, for example, </p>\n\n<p>I tried to write in this address :  <code>0x001e400000</code> (physical address) so when CPU executes this address I got a <code>TLB exception</code> because this address is a mapped area, after many research I fond that I need to translate this address from Virtual address to physical address, I replace this address by <code>0xffffffffbe400000 (Kseg1)</code>, now im able to write some value in this address is done, But when I tried to read from this address(W/R) or another address I got an exception on KSEG2,</p>\n\n<p>Have you an idea why the writing step pass correctly but the reading step generate a exception?</p>\n"}, {"tags": ["c", ".net", "encryption", "asp.net-core", "aes"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 3, "creation_date": 1527070717, "post_id": 50485730, "comment_id": 87984423, "body": "Storing in the code is definitely a very bad option. This basically means you give the key away. It&#39;s just like putting the key of your house under the doormat."}, {"owner": {"reputation": 36141, "user_id": 4354477, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/SuxtS.gif?s=128&g=1", "display_name": "ForceBru", "link": "https://stackoverflow.com/users/4354477/forcebru"}, "edited": false, "score": 1, "creation_date": 1527070806, "post_id": 50485730, "comment_id": 87984481, "body": "There is no way to store keys securely. The longer you store them, the less secure such storage becomes. You can consider using random keys each time or public-key cryptography."}, {"owner": {"reputation": 8643, "user_id": 1718554, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/n3jD1.jpg?s=128&g=1", "display_name": "Luke Joshua Park", "link": "https://stackoverflow.com/users/1718554/luke-joshua-park"}, "edited": false, "score": 1, "creation_date": 1527071226, "post_id": 50485730, "comment_id": 87984732, "body": "Provide more information about <i>why</i> you need to encryption information."}, {"owner": {"reputation": 861, "user_id": 743414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4865c7841b624ea4f967e6d1806bbbb0?s=128&d=identicon&r=PG", "display_name": "user743414", "link": "https://stackoverflow.com/users/743414/user743414"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1527078695, "post_id": 50485730, "comment_id": 87989756, "body": "@Jabberwocky It doesn&#39;t matter if he put the key inside his code or a config file. He by design have to give the key &quot;away&quot;, which like you wrote is bad."}, {"owner": {"reputation": 135, "user_id": 8392287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10200084a1651f1ba21f5fa93d085426?s=128&d=identicon&r=PG&f=1", "display_name": "R.Prog", "link": "https://stackoverflow.com/users/8392287/r-prog"}, "edited": false, "score": 0, "creation_date": 1527083859, "post_id": 50485730, "comment_id": 87993468, "body": "So what it the solution? If I want have encrypted data?"}, {"owner": {"reputation": 79299, "user_id": 589259, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vJbKg.jpg?s=128&g=1", "display_name": "Maarten Bodewes", "link": "https://stackoverflow.com/users/589259/maarten-bodewes"}, "edited": false, "score": 0, "creation_date": 1527119387, "post_id": 50485730, "comment_id": 88010785, "body": "You want to have the least possible amount of access to the key that can be used for decryption. The harder it is for an attacker to get to it, the better it is protected. And yes, getting to the source <i>may</i> be harder than getting to the data. But there are also system key stores, hardware modules etc. Actually, books have been written about <i>key management</i>. Configuring the key management system is one of the hardest things about creating a secure system. There is not one good answer, there are basically a lot of average to bad answers because in the end you need to use the key."}], "owner": {"reputation": 135, "user_id": 8392287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10200084a1651f1ba21f5fa93d085426?s=128&d=identicon&r=PG&f=1", "display_name": "R.Prog", "link": "https://stackoverflow.com/users/8392287/r-prog"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1527070571, "creation_date": 1527070571, "question_id": 50485730, "link": "https://stackoverflow.com/questions/50485730/place-for-aes-encryption-keys-in-web-project", "title": "Place for AES encryption keys in web project", "body": "<p>I build web application with .net Core 2.0</p>\n\n<p>I have to encrypt some data with AES algorithm, and there is a question. I have IV and key but where I should store keys to be sure if the keys are secure?</p>\n\n<p>Should I store this keys in code? If yes where is the best place for it?</p>\n"}, {"tags": ["c", "string", "hex", "string-formatting"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1527069886, "post_id": 50485349, "comment_id": 87983849, "body": "Your question is unclear, please show the raw memory content you&#39;re receiving and what output you want."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 1, "creation_date": 1527070426, "post_id": 50485349, "comment_id": 87984226, "body": "You could build a loop around <code>sscanf</code> and the <code>%2x</code> format."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1527071633, "post_id": 50485349, "comment_id": 87985001, "body": "@SteveSummit  :D Using a cannon to shoot a sparrow"}], "answers": [{"tags": [], "owner": {"reputation": 715, "user_id": 8027470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1637b4a50635f77fc6605b1b1285082?s=128&d=identicon&r=PG&f=1", "display_name": "Asaf Rosemarin", "link": "https://stackoverflow.com/users/8027470/asaf-rosemarin"}, "is_accepted": false, "score": 0, "last_activity_date": 1527070318, "creation_date": 1527070318, "answer_id": 50485621, "question_id": 50485349, "link": "https://stackoverflow.com/questions/50485349/string-formatting-and-parsing-in-c/50485621#50485621", "title": "String formatting and parsing in C", "body": "<p>Should look something like that:</p>\n\n<pre><code>char char_to_hex(char c) {\n        if (c &gt;= '0' &amp;&amp; c &lt;= '9') return c - '0';\n        else if (c &gt;= 'A' &amp;&amp; c &lt;= 'F') return 10 + c - 'A';\n        else if (c &gt;= 'a' &amp;&amp; c &lt;= 'f') return 10 + c - 'a';\n        else error();\n}\n\nchar* parse(char* str) {\n        int len = strlen(str);\n        char* output = malloc(len / 2 + 1); // assuming str is in valid format, so len is even\n        char* output_ptr = output;\n        int i;\n        for (i = 0; i &lt; len; i += 2) {\n                char c = char_to_hex(str[i]) * 16 + char_to_hex(str[i+1]); // convert 2 chars to hex\n                *output_ptr++ = c;\n        }\n        *output_ptr = '\\0'; // terminate\n        return output;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "is_accepted": false, "score": 0, "last_activity_date": 1527070757, "last_edit_date": 1527070757, "creation_date": 1527070436, "answer_id": 50485675, "question_id": 50485349, "link": "https://stackoverflow.com/questions/50485349/string-formatting-and-parsing-in-c/50485675#50485675", "title": "String formatting and parsing in C", "body": "<p>You need to collect 2 characters from the input string and make it into a single byte. That would be your output string. </p>\n\n<p>You can do it using this function. </p>\n\n<pre><code>int get_byte(char b) {\n    if (b &gt;= 'A' &amp;&amp; b &lt;='F')\n        return b - 'A' + 10;\n    else if (b &gt;= '0' &amp;&amp; b &lt;='9') \n        return b - '0';\n    return -1;\n}\n\n\nchar* output_string(char *src) { // Assumes a nul terminated string    \n    int length = strlen(src);\n    assert(length % 2 == 0);\n    char *output = malloc(length/2 + 1);\n    assert(output != NULL);\n    char *to_ret = output;\n    while(*src) {\n        int nibble1 = get_byte(src[0]);\n        int nibble2 = get_byte(src[1]);\n        assert(nibble1 != -1 &amp;&amp; nibble2 != -1);\n        *output = (nibble1 &lt;&lt; 4) | nibble2;\n        output++;\n        src+=2;  \n    }\n    *output = 0;\n    return to_ret; \n}\n</code></pre>\n\n<p>Here is a working <a href=\"https://ideone.com/PqE5tt\" rel=\"nofollow noreferrer\">demo</a> for the example. </p>\n"}, {"comments": [{"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1527071373, "post_id": 50485751, "comment_id": 87984827, "body": "scanf for it. Using a cannon (or Cruise missile) to hunt the sparrow."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 2, "creation_date": 1527072560, "post_id": 50485751, "comment_id": 87985620, "body": "The proper type for an argument to receive the result of a <code>%2x</code> conversion is <code>unsigned int *</code> rather than <code>int *</code>."}], "tags": [], "owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "is_accepted": false, "score": 3, "last_activity_date": 1527070637, "creation_date": 1527070637, "answer_id": 50485751, "question_id": 50485349, "link": "https://stackoverflow.com/questions/50485349/string-formatting-and-parsing-in-c/50485751#50485751", "title": "String formatting and parsing in C", "body": "<p>The simplest way is probably with <code>scanf</code>.  The <code>%x</code> format reads hexadecimal, and you can restrict it to two hexadecimal digits at a time with a width modifier, like <code>%2x</code>.  The program would look something like this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n    int c;\n    while(scanf(\"%2x\", &amp;c) == 1)\n        putchar(c);\n}   \n</code></pre>\n\n<p>Note that it's important to check <code>scanf</code>'s return value, to make sure it actually found the input you were expecting.  This program will stop when it reaches EOF, or when any non-hexadecimal input is encountered.</p>\n\n<p>Incidentally, because of the way <code>scanf</code> works, this program will also accept whitespace between the hexadecimal pairs.  So the input could be <code>\"E5 A6 82 E6 82 A8\"</code>, or there could even be multiple lines:</p>\n\n<pre><code>E5 A6 82\nE6 82 A8\n</code></pre>\n\n<p>In this case, that's probably fine.</p>\n"}], "owner": {"reputation": 682, "user_id": 5784747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73468f69f865b3a795934176bc1ef5fb?s=128&d=identicon&r=PG&f=1", "display_name": "K J Gor", "link": "https://stackoverflow.com/users/5784747/k-j-gor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 0, "closed_date": 1527088415, "answer_count": 3, "score": 0, "last_activity_date": 1527070757, "creation_date": 1527069645, "question_id": 50485349, "link": "https://stackoverflow.com/questions/50485349/string-formatting-and-parsing-in-c", "closed_reason": "Needs details or clarity", "title": "String formatting and parsing in C", "body": "<p>I am receiving string in hex form, input string: <code>\"E5A682E682A8\"</code>.\nI want to display string from it in C programming.</p>\n\n<p>i.e. here 3 bytes makes one character (Chinese).\nI am getting output using below statement:</p>\n\n<pre><code>unsigned char output[] = \"\\xE5\\xA6\\x82\\xE6\\x82\\xA8\";\n</code></pre>\n\n<p>But i need help on getting this format from Input string.\nHow to parse and process this string to get this output?</p>\n"}, {"tags": ["android", "c"], "answers": [{"tags": [], "owner": {"reputation": 53, "user_id": 9223352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99437729074ee335d0d24d861b8a1f32?s=128&d=identicon&r=PG", "display_name": "Jackxl", "link": "https://stackoverflow.com/users/9223352/jackxl"}, "is_accepted": false, "score": 0, "last_activity_date": 1529397577, "creation_date": 1529397577, "answer_id": 50924067, "question_id": 50485110, "link": "https://stackoverflow.com/questions/50485110/is-it-posible-to-create-virtual-input-device-on-non-root-android/50924067#50924067", "title": "Is it posible to create virtual input device on non root Android?", "body": "<p>I found out, that create device on non root phone in C is imposible, but the workaround exists. Solution is AccessibilityService implemented in Java in Android.</p>\n"}], "owner": {"reputation": 53, "user_id": 9223352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99437729074ee335d0d24d861b8a1f32?s=128&d=identicon&r=PG", "display_name": "Jackxl", "link": "https://stackoverflow.com/users/9223352/jackxl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 136, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1529397577, "creation_date": 1527068983, "question_id": 50485110, "link": "https://stackoverflow.com/questions/50485110/is-it-posible-to-create-virtual-input-device-on-non-root-android", "title": "Is it posible to create virtual input device on non root Android?", "body": "<p>Is it posible to create virtual input device on non root Android ? Yes or NO ?</p>\n\n<p>I tried this </p>\n\n<pre><code>int fd = open(\"/dev/uinput\", O_WRONLY | O_NONBLOCK);\n</code></pre>\n\n<p>but result is -1.\nI tried this too:</p>\n\n<pre><code>Runtime.getRuntime().exec(\"chmod +0666 /dev/uinput\");\n</code></pre>\n\n<p>but with the same result.</p>\n"}, {"tags": ["c", "linux", "message-queue", "system-calls"], "comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1527070010, "post_id": 50485023, "comment_id": 87983939, "body": "<i>Does the message queue identifier has to be &quot;closed&quot;?</i>  Before doing what?"}], "answers": [{"comments": [{"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 1, "creation_date": 1527069668, "post_id": 50485264, "comment_id": 87983679, "body": "I don&#39;t think OP is asking about deletion of the queues. As they mentioned, creation and deletion is handled by another process. The question is about closing the handle in this process."}, {"owner": {"reputation": 1995, "user_id": 2718002, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/a1ed8371bd619c1d0297cea4efbf984b?s=128&d=identicon&r=PG&f=1", "display_name": "powerpete", "link": "https://stackoverflow.com/users/2718002/powerpete"}, "edited": false, "score": 0, "creation_date": 1527070530, "post_id": 50485264, "comment_id": 87984311, "body": "Yes, that&#39;s correct. The deletion of the queue is done in the other process"}], "tags": [], "owner": {"reputation": 4888, "user_id": 5785362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a786fd81952576dc07942023bf8830b?s=128&d=identicon&r=PG", "display_name": "tofro", "link": "https://stackoverflow.com/users/5785362/tofro"}, "is_accepted": true, "score": 1, "last_activity_date": 1527071499, "last_edit_date": 1527071499, "creation_date": 1527069423, "answer_id": 50485264, "question_id": 50485023, "link": "https://stackoverflow.com/questions/50485023/does-a-systemv-message-queue-need-to-be-closed/50485264#50485264", "title": "Does a systemv message queue need to be closed", "body": "<p>No, you don't.</p>\n\n<p>SYSV message queues don't allocate specific resources (other than the queue itself and the messages posted in there) for clients that would need to be released. These resources are \"global\" to the system, not per process. <code>msgget</code> is just returning the key as a system global handle.</p>\n\n<p>Destroying the message queue itself, however, should be done once it is no longer needed, as it occupies system resources. That is handled by \"the other process\", as you say, however.</p>\n\n<p>Note that POSIX message queues (<code>mq_open, mq_close</code>) behave differently.</p>\n"}], "owner": {"reputation": 1995, "user_id": 2718002, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/a1ed8371bd619c1d0297cea4efbf984b?s=128&d=identicon&r=PG&f=1", "display_name": "powerpete", "link": "https://stackoverflow.com/users/2718002/powerpete"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 226, "favorite_count": 0, "accepted_answer_id": 50485264, "answer_count": 1, "score": 1, "last_activity_date": 1527071499, "creation_date": 1527068705, "question_id": 50485023, "link": "https://stackoverflow.com/questions/50485023/does-a-systemv-message-queue-need-to-be-closed", "title": "Does a systemv message queue need to be closed", "body": "<p>I'm using a system v Message queue. The Queue is created and deleteted by an other process. So on this example I'm using the already created message queue:</p>\n\n<pre><code>#include &lt;sys/types.h&gt;\n#include &lt;sys/ipc.h&gt;\n#include &lt;sys/msg.h&gt;\n...\nkey = ftok(path,project);\nmsqid = msgget(key,0);\nmsgsnd(msqid,data,size,0);\n//Must be the \"handle\" msgqid closed?\n...\n</code></pre>\n\n<p>I can not find any information about closing the handle/identifier of the message queue. Does the message queue identifier has to be \"closed\"?</p>\n"}, {"tags": ["c", "arrays", "uint64", "uint16"], "comments": [{"owner": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 3, "creation_date": 1527065904, "post_id": 50484021, "comment_id": 87981055, "body": "And what exactly is the problem you are having?"}, {"owner": {"reputation": 11, "user_id": 6404106, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e2544ee62ee3830eed443ab69987ec0?s=128&d=identicon&r=PG&f=1", "display_name": "OriolBur", "link": "https://stackoverflow.com/users/6404106/oriolbur"}, "edited": false, "score": 0, "creation_date": 1527066059, "post_id": 50484021, "comment_id": 87981163, "body": "Honestly, I don&#39;t know how to do it..."}, {"owner": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 0, "creation_date": 1527066229, "post_id": 50484021, "comment_id": 87981284, "body": "Well, what have you tried doing? What has your research suggested as solution(s)? How have those not worked for you?"}, {"owner": {"reputation": 11, "user_id": 6404106, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e2544ee62ee3830eed443ab69987ec0?s=128&d=identicon&r=PG&f=1", "display_name": "OriolBur", "link": "https://stackoverflow.com/users/6404106/oriolbur"}, "reply_to_user": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 0, "creation_date": 1527066341, "post_id": 50484021, "comment_id": 87981353, "body": "I was trying to do it with this line : memcpy(&amp;frame[2], data, 8); , but without success"}, {"owner": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 3, "creation_date": 1527066453, "post_id": 50484021, "comment_id": 87981431, "body": "What does <i>&quot;without success&quot;</i> mean? What happened and what did you expect to happen? Provide a proper <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> please, right now it&#39;s still unclear what exactly your problem is"}, {"owner": {"reputation": 11, "user_id": 6404106, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e2544ee62ee3830eed443ab69987ec0?s=128&d=identicon&r=PG&f=1", "display_name": "OriolBur", "link": "https://stackoverflow.com/users/6404106/oriolbur"}, "reply_to_user": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 1, "creation_date": 1527066734, "post_id": 50484021, "comment_id": 87981623, "body": "Ok, sorry. If data is 0x0000000000000004, I expect to save into array this: frame[2] = 0x0004, frame[3] = 0x0000, frame[4] = 0x0000, frame[5] = 0x0000. &quot;Without success&quot; means that I get a crash in my program : Access violation reading location 0x00000000"}, {"owner": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 3, "creation_date": 1527066930, "post_id": 50484021, "comment_id": 87981768, "body": "First of please don&#39;t post relevant information into comments, <a href=\"https://stackoverflow.com/posts/50484021/edit\">edit</a> it into your question. Second off we still require a complete <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>, ideally you should be able to reduce your code to a self-contained example. (e.g.: right now we neither now the size of <code>MCB_FRAME_SIZE</code> or where this null pointer access comes from)"}, {"owner": {"reputation": 2287, "user_id": 5267751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd62e8fd8fbb37abc7e2a39d23828047?s=128&d=identicon&r=PG&f=1", "display_name": "user202729", "link": "https://stackoverflow.com/users/5267751/user202729"}, "edited": false, "score": 0, "creation_date": 1527067262, "post_id": 50484021, "comment_id": 87982013, "body": "The green checkmark is <a href=\"https://stackoverflow.com\">Stack Overflow</a>&#39;s equivalent of &quot;Thanks you so much!&quot; comments on other sites. Here, comments should only be used for suggesting improvements, for the other usage you have the checkmark. See <a href=\"https://meta.stackexchange.com/questions/2950/should-hi-thanks-taglines-and-salutations-be-removed-from-posts\" title=\"should hi thanks taglines and salutations be removed from posts\">meta.stackexchange.com/questions/2950/&hellip;</a> and <a href=\"https://meta.stackoverflow.com/questions/258004/should-thank-you-comments-be-flagged\" title=\"should thank you comments be flagged\">meta.stackoverflow.com/questions/258004/&hellip;</a>"}, {"owner": {"reputation": 2287, "user_id": 5267751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd62e8fd8fbb37abc7e2a39d23828047?s=128&d=identicon&r=PG&f=1", "display_name": "user202729", "link": "https://stackoverflow.com/users/5267751/user202729"}, "edited": false, "score": 1, "creation_date": 1527069831, "post_id": 50484021, "comment_id": 87983797, "body": "You appear to have some difficulties with asking questions on <a href=\"https://stackoverflow.com\">Stack Overflow</a>. <a href=\"https://meta.stackoverflow.com/questions/260648/stack-overflow-question-checklist\">Stack Overflow question checklist</a> may be helpful. Although..."}, {"owner": {"reputation": 2287, "user_id": 5267751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd62e8fd8fbb37abc7e2a39d23828047?s=128&d=identicon&r=PG&f=1", "display_name": "user202729", "link": "https://stackoverflow.com/users/5267751/user202729"}, "edited": false, "score": 0, "creation_date": 1527069935, "post_id": 50484021, "comment_id": 87983879, "body": "for this particular question, you should be able to receive better answers by showing your code (the code which give you the access violation) as an MCVE, and redo the steps above."}], "answers": [{"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1527073210, "post_id": 50484440, "comment_id": 87986057, "body": "Not really a good idea since this needlessly turns the code endianess-dependent. It is better to only use bit shifts."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1527075469, "post_id": 50484440, "comment_id": 87987500, "body": "@Ludlin it is not. It is not required here to have the lower bytes in the lower uint16_t table indexes. Typical nitpick."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1527075907, "post_id": 50484440, "comment_id": 87987768, "body": "So how do you know what&#39;s inside <code>u.u16[0]</code>? You don&#39;t, unless you assume a certain endianess and hard-code accordingly."}], "tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": true, "score": 0, "last_activity_date": 1527068990, "last_edit_date": 1527068990, "creation_date": 1527067012, "answer_id": 50484440, "question_id": 50484021, "link": "https://stackoverflow.com/questions/50484021/fill-uint16-t-array-with-uint64-t-data-in-c/50484440#50484440", "title": "Fill uint16_t array with uint64_t data in C", "body": "<pre><code>typedef union\n{\n    uint64_t u64;\n    uint32_t u32[2];\n    uint16_t u16[4];\n    uint8_t u8[8];\n}UINT_UNION_T;\n\nuint16_t *saveU64(uint16_t *table, size_t position, uint64_t value)\n{\n    UINT_UNION_T u = {.u64 = value};\n\n    table[position] = u.u16[0];\n    table[position + 1] = u.u16[1];\n    table[position + 2] = u.u16[2];\n    table[position + 3] = u.u16[3];\n    return table;\n}\n</code></pre>\n\n<p>Or </p>\n\n<pre><code>  memcpy(table + position, &amp;value, sizeof value);\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6404106, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e2544ee62ee3830eed443ab69987ec0?s=128&d=identicon&r=PG&f=1", "display_name": "OriolBur", "link": "https://stackoverflow.com/users/6404106/oriolbur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 929, "favorite_count": 0, "closed_date": 1527079573, "accepted_answer_id": 50484440, "answer_count": 1, "score": -5, "last_activity_date": 1527068990, "creation_date": 1527065854, "last_edit_date": 1527068020, "question_id": 50484021, "link": "https://stackoverflow.com/questions/50484021/fill-uint16-t-array-with-uint64-t-data-in-c", "closed_reason": "Needs details or clarity", "title": "Fill uint16_t array with uint64_t data in C", "body": "<p>I'm having a problem trying to save a data of uint64_t size into 4 uint16_t positions in array without using any loop...\nHere is a part of my code:</p>\n\n<pre><code>static int send(uint16_t addr, const void *data)\n{\n    uint16_t frame[7];\n    /* Here I want to save in frame[2], frame[3], frame[4] and frame[5] the data recieved by parameter */\n\n}\n</code></pre>\n\n<p>Thanks in advance! :)</p>\n"}, {"tags": ["c", "arm", "embedded", "clang", "libc"], "answers": [{"comments": [{"owner": {"reputation": 1961, "user_id": 1874323, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/7f6c299c60b5eab6f199347f6715bc05?s=128&d=identicon&r=PG", "display_name": "BlamKiwi", "link": "https://stackoverflow.com/users/1874323/blamkiwi"}, "edited": false, "score": 0, "creation_date": 1527066696, "post_id": 50484253, "comment_id": 87981593, "body": "That&#39;s not a terrible idea, although it doesn&#39;t integrate well into CMake toolchain files."}], "tags": [], "owner": {"reputation": 7970, "user_id": 4117097, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lrdeC.jpg?s=128&g=1", "display_name": "Anton Malyshev", "link": "https://stackoverflow.com/users/4117097/anton-malyshev"}, "is_accepted": false, "score": 1, "last_activity_date": 1527066568, "creation_date": 1527066568, "answer_id": 50484253, "question_id": 50483967, "link": "https://stackoverflow.com/questions/50483967/how-can-i-use-libc-nano-with-clang/50484253#50484253", "title": "How can I use libc_nano with Clang?", "body": "<p>You can build fake libc.a without any functions inside and use it together with libc_nano.</p>\n"}, {"tags": [], "owner": {"reputation": 1961, "user_id": 1874323, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/7f6c299c60b5eab6f199347f6715bc05?s=128&d=identicon&r=PG", "display_name": "BlamKiwi", "link": "https://stackoverflow.com/users/1874323/blamkiwi"}, "is_accepted": true, "score": 3, "last_activity_date": 1527066938, "creation_date": 1527066938, "answer_id": 50484410, "question_id": 50483967, "link": "https://stackoverflow.com/questions/50483967/how-can-i-use-libc-nano-with-clang/50484410#50484410", "title": "How can I use libc_nano with Clang?", "body": "<p>Upon further google-fu and grep-fu, it turns out the answer was staring at me the entire time. Clang has a <code>-nodefaultlibs</code> that does the trick and prevents default linker directives. Although strangely it wasn't documented in <code>--help</code>. </p>\n"}], "owner": {"reputation": 1961, "user_id": 1874323, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/7f6c299c60b5eab6f199347f6715bc05?s=128&d=identicon&r=PG", "display_name": "BlamKiwi", "link": "https://stackoverflow.com/users/1874323/blamkiwi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 491, "favorite_count": 1, "accepted_answer_id": 50484410, "answer_count": 2, "score": 1, "last_activity_date": 1527066938, "creation_date": 1527065661, "last_edit_date": 1527066477, "question_id": 50483967, "link": "https://stackoverflow.com/questions/50483967/how-can-i-use-libc-nano-with-clang", "title": "How can I use libc_nano with Clang?", "body": "<p>I'm exploring using clang as the compiler for ARM embedded development. As clang doesn't have an equivalent of <code>.spec</code> files, I'm having trouble convincing clang to link against <code>libc_nano</code>. How could I either tell clang to not link against any libraries by default so I can specify the correct library, or rewrite the <code>-lc</code> command to <code>-lc_nano</code>?</p>\n\n<p>The command I'm trying to run is:</p>\n\n<pre><code>clang -target arm-none-eabi -mcpu=cortex-a5 -mfpu=neon-vfpv4 -mfloat-abi=hard -march=armv7-a main.c\n</code></pre>\n\n<p>Currently I get this error message:</p>\n\n<pre><code>/usr/lib/llvm-6.0/bin/ld.lld: error: unable to find library -lc\n</code></pre>\n\n<p>EDIT: I've noticed that clang has a <code>-fno-autolink</code> which according to the help text: <code>Disable generation of linker directives for automatic library linking</code>. However it doesn't seem to do anything?</p>\n\n<p>EDIT2: I'm aware I could abuse symlinks to achieve this. I would like to avoid symlinks in this case as it can make the build system brittle. </p>\n"}, {"tags": ["c", "gcc"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1527064551, "post_id": 50483540, "comment_id": 87980125, "body": "What is e.g. <code>displayItems</code>? Is it matching the type-alias <code>MenuFunction</code>? What is <code>Boolean</code>? Is it equal to <code>void</code> (which is the return type of <code>MenuFunction</code> functions)?"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 2, "creation_date": 1527064710, "post_id": 50483540, "comment_id": 87980223, "body": "Please ensure that you&#39;ve provided a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> in your question!"}, {"owner": {"reputation": 5, "user_id": 9833146, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-YgAkxHOW8Zw/AAAAAAAAAAI/AAAAAAAACI0/m9FBUpSrjg4/photo.jpg?sz=128", "display_name": "Rohan k", "link": "https://stackoverflow.com/users/9833146/rohan-k"}, "edited": false, "score": 0, "creation_date": 1527064997, "post_id": 50483540, "comment_id": 87980411, "body": "displayItems and all others items void displayItems(VmSystem * system) , Boolean is enum  , and menu function is : typedef void (*MenuFunction)(VmSystem *);"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1527065388, "post_id": 50483540, "comment_id": 87980677, "body": "Unrelated to your problem, but please don&#39;t use your own boolean types. C has had <a href=\"http://en.cppreference.com/w/c/types/boolean\" rel=\"nofollow noreferrer\">a boolean type</a> since C99"}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 9833146, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-YgAkxHOW8Zw/AAAAAAAAAAI/AAAAAAAACI0/m9FBUpSrjg4/photo.jpg?sz=128", "display_name": "Rohan k", "link": "https://stackoverflow.com/users/9833146/rohan-k"}, "edited": false, "score": 0, "creation_date": 1527065464, "post_id": 50483843, "comment_id": 87980732, "body": "Thanks alot You save my day , i almost spend 2 hours on it , newbie :)"}], "tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": true, "score": 0, "last_activity_date": 1527065317, "creation_date": 1527065317, "answer_id": 50483843, "question_id": 50483540, "link": "https://stackoverflow.com/questions/50483540/warning-initialization-from-incompatible-pointer-type-wincompatible-pointer-t/50483843#50483843", "title": "warning: initialization from incompatible pointer type [-Wincompatible-pointer-types]", "body": "<p>You have two problems.</p>\n\n<p>The first:</p>\n\n<pre><code>typedef void (*MenuFunction)(VmSystem *);\n</code></pre>\n\n<p>followed by</p>\n\n<pre><code>Boolean(*MenuFunction[])(VmSystem *) = { ... };\n</code></pre>\n\n<p>Two different things, same name.</p>\n\n<p>Then as for your errors: You state in a comment that e.g. <code>displayItem</code> matches the function type <code>MenuFunction</code>, and that it returns <code>void</code>. The problem is that the array <code>MenuFunction</code> (see how confusing this can be?) is an array of function returning <code>Boolean</code>. The two types are not compatible, and you must change one.</p>\n"}], "owner": {"reputation": 5, "user_id": 9833146, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-YgAkxHOW8Zw/AAAAAAAAAAI/AAAAAAAACI0/m9FBUpSrjg4/photo.jpg?sz=128", "display_name": "Rohan k", "link": "https://stackoverflow.com/users/9833146/rohan-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 809, "favorite_count": 0, "accepted_answer_id": 50483843, "answer_count": 1, "score": -2, "last_activity_date": 1527065317, "creation_date": 1527064396, "last_edit_date": 1527065017, "question_id": 50483540, "link": "https://stackoverflow.com/questions/50483540/warning-initialization-from-incompatible-pointer-type-wincompatible-pointer-t", "title": "warning: initialization from incompatible pointer type [-Wincompatible-pointer-types]", "body": "<p>Please Help me to identify the problem with the Function pointer for the menu items is giving the error \"initialization from incompatible pointer type\"</p>\n\n<p>This is header file </p>\n\n<pre><code>/**\n * Represents a function that can be selected from the list of\n * menu_functions - creates a new type called a menu_function.\n */\nvoid displayItems(VmSystem * system);\ntypedef void (*MenuFunction)(VmSystem *);\n\n\n/**\n * Represents a menu item to be displayed and executed in the program.\n **/\ntypedef struct menu_item\n{\n    char text[MENU_NAME_LEN + NULL_SPACE];\n    MenuFunction function;\n} MenuItem;\n\nvoid initMenu(MenuItem * menu);\nMenuFunction getMenuChoice(MenuItem * menu);\n\n\nMenuItem menu[NUM_MENU_ITEMS];\n</code></pre>\n\n<p>main menu file </p>\n\n<pre><code>typedef enum boolean\n{\n    FALSE = 0,\n    TRUE\n} Boolean;\n\nvoid initMenu(MenuItem * menu)\n{\n    /* Strings names of menu items */\n    char * menu_items[] = {\n        \"Display Items\",\n        \"Purchase Items\",\n        \"Save and Exit\",\n        \"Add Item\",\n        \"Remove Item\",\n        \"Display Coins\",\n        \"Reset Stock\",\n        \"Reset Coins\",\n        \"Abort Program\"\n    };\n</code></pre>\n\n<p>Function pointer for the menu items </p>\n\n<pre><code>    Boolean(*MenuFunction[])(VmSystem *) = {\n        displayItems,  /*Here i got the error */\n        purchaseItem,\n        saveStock,\n        addItem,\n        removeItem,\n        displayCoins,\n        resetStock,\n        resetCoins,\n        abortProgram\n    };\n</code></pre>\n"}, {"tags": ["c", "coroutine", "setjmp", "alloca"], "comments": [{"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1527063211, "post_id": 50483136, "comment_id": 87979251, "body": "Beware of <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behavior</a>"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 1, "creation_date": 1527063291, "post_id": 50483136, "comment_id": 87979306, "body": "Like I explained <a href=\"https://stackoverflow.com/questions/50481755/how-to-implement-coroutine-within-for-loop-in-c/50482435#50482435\">here</a>, the code invokes undefined behavior. You should not be doing such jumps between functions."}, {"owner": {"reputation": 3380, "user_id": 3308570, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/3Mzz9.jpg?s=128&g=1", "display_name": "JustWe", "link": "https://stackoverflow.com/users/3308570/justwe"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1527063674, "post_id": 50483136, "comment_id": 87979564, "body": "@AjayBrahmakshatriya So I shall simply consider <code>longjmp</code> as a speical <code>return</code>."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 1, "creation_date": 1527063881, "post_id": 50483136, "comment_id": 87979694, "body": "@Jiu, <code>longjmp</code> is not always a return. It terminates the function only if the corresponding <code>setjmp</code> was in a function earlier in the set of nested calls. If the <code>setjmp</code> is in the same function, it is like a normal <code>goto</code>. Also the <code>setjmp</code> could be many steps down the nesting. So it is not like <code>return</code> at all."}, {"owner": {"reputation": 3380, "user_id": 3308570, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/3Mzz9.jpg?s=128&g=1", "display_name": "JustWe", "link": "https://stackoverflow.com/users/3308570/justwe"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1527064149, "post_id": 50483136, "comment_id": 87979861, "body": "@AjayBrahmakshatriya Thanks! The Best summary of using <code>longjmp</code> &amp; <code>setjmp</code>."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1527073531, "post_id": 50483136, "comment_id": 87986262, "body": "alloca is not nearly as evil as setjmp/longjmp."}], "answers": [{"comments": [{"owner": {"reputation": 3380, "user_id": 3308570, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/3Mzz9.jpg?s=128&g=1", "display_name": "JustWe", "link": "https://stackoverflow.com/users/3308570/justwe"}, "edited": false, "score": 0, "creation_date": 1527065171, "post_id": 50483549, "comment_id": 87980529, "body": "So the <code>2048</code> split stack makes A &amp; B separately?"}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "reply_to_user": {"reputation": 3380, "user_id": 3308570, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/3Mzz9.jpg?s=128&g=1", "display_name": "JustWe", "link": "https://stackoverflow.com/users/3308570/justwe"}, "edited": false, "score": 0, "creation_date": 1527065426, "post_id": 50483549, "comment_id": 87980705, "body": "@Jiu alloca(2048) moves the stack pointer forward 2048 bytes, which means that routineB will start 2048 later and when B longjmp-returns to A, A will be able to use 2048 bytes of stack before B&#39;s on-stack state is compromised."}], "tags": [], "owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "is_accepted": true, "score": 2, "last_activity_date": 1527064839, "last_edit_date": 1527064839, "creation_date": 1527064427, "answer_id": 50483549, "question_id": 50483136, "link": "https://stackoverflow.com/questions/50483136/whats-the-function-of-alloca-with-setjmp/50483549#50483549", "title": "What&#39;s the function of alloca() with setjmp?", "body": "<p>Here's an article about implementing coros with setjmp/longjmp/alloca: <a href=\"https://fanf.livejournal.com/105413.html\" rel=\"nofollow noreferrer\">https://fanf.livejournal.com/105413.html</a> . </p>\n\n<p>The idea is that in order for B to preserve it's full context (not just registers (preserved by setjmp) but also local, on-stack variables) when long-jumping back to A, B needs its own stack or at least it needs to make sure whatever A does won't overwrite B's variables.</p>\n\n<p><code>alloca</code> is a way to achieve that without delving into assembly.\n<code>alloca</code> will basically move B much further on the stack than A is so that unless A uses deep recursion or anything that'd make it use more than 2KiB (in this case) of its stack, A and B will keep their on-stack local variables separate.</p>\n\n<p>(This technique is quite naturally not strictly conforming C, and it'd be even less so if you used back-and-forth jumps between multiple <code>malloc</code>'d stacks.)</p>\n"}, {"tags": [], "owner": {"reputation": 3380, "user_id": 3308570, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/3Mzz9.jpg?s=128&g=1", "display_name": "JustWe", "link": "https://stackoverflow.com/users/3308570/justwe"}, "is_accepted": false, "score": 0, "last_activity_date": 1527124071, "creation_date": 1527124071, "answer_id": 50499480, "question_id": 50483136, "link": "https://stackoverflow.com/questions/50483136/whats-the-function-of-alloca-with-setjmp/50499480#50499480", "title": "What&#39;s the function of alloca() with setjmp?", "body": "<p>About the solution of Second Question:</p>\n\n<p>Put <code>int r</code> into data segment will give the same result either release or debug in GCC.</p>\n\n<pre><code>static int r = 0;\n</code></pre>\n"}], "owner": {"reputation": 3380, "user_id": 3308570, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/3Mzz9.jpg?s=128&g=1", "display_name": "JustWe", "link": "https://stackoverflow.com/users/3308570/justwe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 199, "favorite_count": 0, "accepted_answer_id": 50483549, "answer_count": 2, "score": 2, "last_activity_date": 1527124071, "creation_date": 1527063092, "question_id": 50483136, "link": "https://stackoverflow.com/questions/50483136/whats-the-function-of-alloca-with-setjmp", "title": "What&#39;s the function of alloca() with setjmp?", "body": "<p>This question comes from <a href=\"https://stackoverflow.com/questions/14685406/practical-usage-of-setjmp-and-longjmp-in-c\">Practical usage of setjmp and longjmp in C</a> and <a href=\"https://stackoverflow.com/questions/50481755/how-to-implement-coroutine-within-for-loop-in-c\">How to implement coroutine within for loop in c</a> which I asked.</p>\n\n<pre><code>jmp_buf bufferA, bufferB;\n\nvoid routineB(); // forward declaration\n\nvoid routineA()\n{\n    int r = 0;\n\n    printf(\"(A1)\\n\");\n\n    if (setjmp(bufferA) == 0) {\n        r++;\n        alloca(2048);\n        routineB();\n    }\n\n    printf(\"(A2) r=%d\\n\",r);\n\n    if (setjmp(bufferA) == 0) {\n        r++;\n        longjmp(bufferB, 1);\n    }\n\n    printf(\"(A3) r=%d\\n\",r);\n\n    if (setjmp(bufferA) == 0) {\n        r++;\n        longjmp(bufferB, 1);\n    }\n\n    printf(\"(A4) r=%d\\n\",r);\n}\n\nvoid routineB()\n{\n    int r = 0;\n\n    printf(\"(B1)\\n\");\n\n    if (setjmp(bufferB) == 0) {\n        r++;\n        longjmp(bufferA, 1);\n    }\n\n    printf(\"(B2) r=%d\\n\", r);\n\n    if (setjmp(bufferB) == 0) {\n        r++;\n        longjmp(bufferA, 1);\n    }\n\n    printf(\"(B3) r=%d\\n\", r);\n\n    if (setjmp(bufferB) == 0) {\n        r++;\n        longjmp(bufferA, 1);\n    }\n\n    printf(\"(B4) r=%d never reach\\n\", r);\n}\n\nint main()\n{\n    printf(\"main\\n\");\n    routineA();\n    return 0;\n}\n</code></pre>\n\n<p>I am studying about the coroutine implementation by C. and trying to see what happened in the stack after <code>longjmp</code>.</p>\n\n<p>Question 1:</p>\n\n<p>What's the magic makes the stack of <code>routineB</code> alive after using <code>alloca(2048)</code>?\nI heard <code>alloca</code> is evil but why it makes the stack looks like expanded.\nShould I use it like this?</p>\n\n<p>Output:</p>\n\n<pre><code>main\n(A1)\n(B1)\n(A2) r=1\n(B2) r=1\n(A3) r=2\n(B3) r=2\n(A4) r=3\n</code></pre>\n\n<p>Question 2:</p>\n\n<p>After removing <code>alloca(2048)</code>. it gives different result after tell complier disable optimization(-O2).</p>\n\n<p><strong>-O0</strong></p>\n\n<pre><code>main\n(A1)\n(B1)\n(A2) r=1\n(B2) r=6356584\n(A3) r=2\n(B3) r=6356584\n(A4) r=3\n</code></pre>\n\n<p><strong>-O2</strong></p>\n\n<pre><code>main\n(A1)\n(B1)\n(A2) r=1\n(B2) r=0\n(A3) r=1\n(B3) r=0\n(A4) r=1\n</code></pre>\n\n<p>if it's not undefined, how to make the code get the same behaviour? if it's, Please forget Q2.</p>\n"}, {"tags": ["c", "linux", "debian", "linker-errors", "undefined-reference"], "comments": [{"owner": {"reputation": 188064, "user_id": 635608, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIJia.png?s=128&g=1", "display_name": "Mat", "link": "https://stackoverflow.com/users/635608/mat"}, "edited": false, "score": 1, "creation_date": 1527063144, "post_id": 50483044, "comment_id": 87979210, "body": "Typoes (C is case-sensitive), and format your code properly, the other problems should stand out once you do that."}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 1, "creation_date": 1527063217, "post_id": 50483044, "comment_id": 87979261, "body": "Please, don&#39;t send textual info as image. (Copy/paste it instead.)"}, {"owner": {"reputation": 3141, "user_id": 2468549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b87d95c561b24d120cbfb5a1c5c9867?s=128&d=identicon&r=PG", "display_name": "Frax", "link": "https://stackoverflow.com/users/2468549/frax"}, "edited": false, "score": 1, "creation_date": 1527063662, "post_id": 50483044, "comment_id": 87979551, "body": "This is a linker error, it has nothing to do with the threading code, so please strip your question down to a <a href=\"/help/mcve\">minimal example</a>. Also, include you error message as text (forecast is as code) and <b>fix your indentation</b> because wrong bracing is likely the issue."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1527064016, "post_id": 50483044, "comment_id": 87979776, "body": "I cannot read the screen shot. Please post text as text."}, {"owner": {"reputation": 31255, "user_id": 28494, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/c14ME.gif?s=128&g=1", "display_name": "qrdl", "link": "https://stackoverflow.com/users/28494/qrdl"}, "edited": false, "score": 0, "creation_date": 1527067483, "post_id": 50483044, "comment_id": 87982190, "body": "Check your curly braces. Your functions are inside <code>main()</code>"}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1527072315, "post_id": 50483044, "comment_id": 87985457, "body": "It looks like you forgot to enable a good set of warnings.  For GCC, I recommend <code>-Wall -Wextra -Wwrite-strings</code> as a minimum; consider also <code>-Wpedantic -Warray-bounds</code> for identifying some other common mistakes."}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1527072333, "post_id": 50483044, "comment_id": 87985468, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/12573816/what-is-an-undefined-reference-unresolved-external-symbol-error-and-how-do-i-fix\">What is an undefined reference/unresolved external symbol error and how do I fix it?</a>"}, {"owner": {"reputation": 1, "user_id": 9389953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff191b95dd6c58ef703e10f6423321d0?s=128&d=identicon&r=PG", "display_name": "user9389953", "link": "https://stackoverflow.com/users/9389953/user9389953"}, "edited": false, "score": 0, "creation_date": 1527605136, "post_id": 50483044, "comment_id": 88183651, "body": "None of what you say has made me solve. I asked for help, not humiliation."}], "answers": [{"tags": [], "owner": {"reputation": 5339, "user_id": 1714692, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/bd72cbc200eb7c9aa507624f154b21a7?s=128&d=identicon&r=PG", "display_name": "Francesco Boi", "link": "https://stackoverflow.com/users/1714692/francesco-boi"}, "is_accepted": false, "score": 1, "last_activity_date": 1527066124, "last_edit_date": 1527066124, "creation_date": 1527064023, "answer_id": 50483401, "question_id": 50483044, "link": "https://stackoverflow.com/questions/50483044/c-linux-debian-undefined-reference-to-function-in-multi-thread-program/50483401#50483401", "title": "c-linux-debian undefined reference to function in multi thread program", "body": "<p>The function you must use to create a new thread is <code>pthread_create</code> not <code>threadcreate</code>.</p>\n\n<p>EDIT: You also forgot to <code>#include&lt;pthread.h&gt;</code> and forgot to close the main function with <code>}</code> at the end. You wrote also <code>quicksort</code> while the funciont is <code>quickSort</code>.</p>\n\n<p>Please reformat your code because it is a mess and it is impossible to understand where functions end.</p>\n\n<pre><code>#include &lt;stdio.h&gt; \n#include &lt;stdlib.h&gt;    \n#include &lt;time.h&gt;    \n#include&lt;pthread.h&gt;\n#define NUM_THREADS 3\n\nint sayilar[800];\n\nvoid *Sirala(void *param);\n\nvoid quickSort(int[], int, int);\n\nint partition(int[], int, int);\n\nint kontrol=0;\n\n\n\nint main(int argc, char *argv[]){\n\nint i,j;\n\n    srand(time(NULL));\n\n    for(i=0; i&lt;800; i++){\n\n        sayilar[i] = 1+ (rand() % 800);\n\n        for(j=0; j&lt;1; j++){\n\n            if(sayilar[j]== sayilar[i]){\n\n                i--;\n\n                break;\n\n                }\n\n        }\n\n    }\n\n\n\n    pthread_t threads[NUM_THREADS];\n\n    int rc;\n\n    long t;\n\n    for(t=0; t&lt;3; t++){\n\n        rc = pthread_create(&amp;threads[t], NULL, Sirala, (void *)t);\n\n        if(rc){\n\n            printf(\"Hata, thread olu\u015fturulamad\u0131. Thread: %d\\n\", rc);\n\n            exit(-1);\n\n        }\n\n        pthread_join(threads[t], NULL);\n\n    printf(\"\\n\\n\");\n\n    }\n\n    printf(\"SON\\n\");\n\n    for(i=0; i&lt;800; i++)\n\n        printf(\"%d\\n\", sayilar[i]);\n\n    printf(\"/n/n\");\n\n\n\n    FILE *yaz; //dosya g\u00f6stericisi\n\n    yaz = fopen(\"son.txt\", \"w+\");\n\n    if(yaz == NULL){\n\n        puts(\"Dosya acilmiyor\");\n\n        exit(1);\n\n    }\n\n    for(i=0; i&lt;800; i++){\n\n        fprintf(yaz, \"%d\\n\", sayilar[i]);\n\n    }\n\n    fclose(yaz);\n\n\n\n    pthread_exit(NULL);\n}\n\n\nvoid *Sirala(void *param){\n\n    int i, baslangic, bitis;\n\n    if((long)param ==0){\n\n        baslangic = 0;\n\n        bitis= 300;\n\n        kontrol =1;\n\n        printf(\"Dizinin ilk 300 eleman\u0131n\u0131n s\u0131ras\u0131z hali:\\n\\n\");\n\n        for(i=baslangic; i&lt;bitis; i++){\n\n            printf(\"%d - \", sayilar[i]);\n\n        }\n\n        printf(\"/n/n\");\n\n    }\n\n    else if((long)param ==1){\n\n        baslangic = 300;\n\n        bitis= 800;\n\n        kontrol =2;\n\n        printf(\"Dizinin di\u011fer 500 eleman\u0131n\u0131n s\u0131ras\u0131z hali:\\n\\n\");\n\n        for(i=baslangic; i&lt;bitis; i++){\n\n            printf(\"%d - \", sayilar[i]);\n\n        }\n\n        printf(\"/n/n\");\n\n    }\n\n    else {\n\n        baslangic = 0;\n\n        bitis= 800;\n\n        kontrol =0;\n\n    }\n\n    for(i= baslangic; i&lt;bitis; i++){\n\n        quickSort(sayilar, baslangic, bitis-1);\n\n    }\n\n    if(kontrol ==1){\n\n    printf(\"Dizinin 300 eleman\u0131n\u0131n s\u0131ral\u0131 hali:\\n\\n\");\n\n    for(i = baslangic; i&lt;bitis; i++){\n\n        printf(\"%d - \", sayilar[i]);\n\n    }\n\n    }\n\n    else if(kontrol ==2){\n\n    printf(\"Dizinin di\u011fer 500 eleman\u0131n\u0131n s\u0131ral\u0131 hali:\\n\\n\");\n\n    for(i = baslangic; i&lt;bitis; i++){\n\n        printf(\"%d - \", sayilar[i]);\n\n    }\n\n    }\n\n    printf(\"\\n\\n\");\n\n    pthread_exit(0);\n\n}\n\n\n\nvoid quickSort(int a[], int sol, int sag){\n\n    int j;\n\n    if(sol&lt;sag){\n\n        j=partition(a,sol, sag);\n\n        quickSort(a, sol, j-1);\n\n        quickSort(a, j+1, sag);\n\n    }\n\n}\n\n\n\nint partition(int a[], int sol, int sag){\n\n    int pivot, i, j, t;\n\n    pivot = a[sol];\n\n    i= sol;\n\n    j= sag+1;\n\n}\n</code></pre>\n\n<p>EDIT 2: You must solve also this warning:</p>\n\n<pre><code>warning: control reaches end of non-void function\n  [-Wreturn-type]\n}\n^\n1 warning generated. \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 98, "user_id": 9821739, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-khBJJN1kbZo/AAAAAAAAAAI/AAAAAAAABOM/xkc-n6PdgZ0/photo.jpg?sz=128", "display_name": "Melody", "link": "https://stackoverflow.com/users/9821739/melody"}, "edited": false, "score": 0, "creation_date": 1527064886, "post_id": 50483510, "comment_id": 87980333, "body": "By the way, in original code,  you miss a &quot;}&quot; after pthread_exit(NULL);"}], "tags": [], "owner": {"reputation": 98, "user_id": 9821739, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-khBJJN1kbZo/AAAAAAAAAAI/AAAAAAAABOM/xkc-n6PdgZ0/photo.jpg?sz=128", "display_name": "Melody", "link": "https://stackoverflow.com/users/9821739/melody"}, "is_accepted": false, "score": 1, "last_activity_date": 1527064315, "creation_date": 1527064315, "answer_id": 50483510, "question_id": 50483044, "link": "https://stackoverflow.com/questions/50483044/c-linux-debian-undefined-reference-to-function-in-multi-thread-program/50483510#50483510", "title": "c-linux-debian undefined reference to function in multi thread program", "body": "<p>you should adjust threadcreate to pthread_create, and adjust quicksort to quickSort</p>\n\n<pre><code>#include &lt;pthread.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt;\n#define NUM_THREADS 3\n\nint sayilar[800];\nvoid *Sirala(void *param);\nvoid quickSort(int[], int, int);\nint partition(int[], int, int);\nint kontrol=0;\n\nint main(int argc, char *argv[]){\n    int i,j;\n    srand(time(NULL));\n    for(i=0; i&lt;800; i++){\n        sayilar[i] = 1+ (rand() % 800);\n        for(j=0; j&lt;1; j++){\n            if(sayilar[j]== sayilar[i]){\n                i--;\n                break;\n            }\n        }\n    }\n    pthread_t threads[NUM_THREADS];\n    int rc;\n    long t;\n    for(t=0; t&lt;3; t++){\n        rc = pthread_create(&amp;threads[t], NULL, Sirala, (void *)t);/*here*/\n        if(rc){\n            printf(\"Hata, thread olu\u015fturulamad\u0131. Thread: %d\\n\", rc);\n            exit(-1);       \n        }\n        pthread_join(threads[t], NULL);\n        printf(\"\\n\\n\");\n    }\n    printf(\"SON\\n\");\n    for(i=0; i&lt;800; i++){\n        printf(\"%d\\n\", sayilar[i]);\n    }\n    printf(\"/n/n\");\n\n    FILE *yaz; //dosya g\u00f6stericisi\n    yaz = fopen(\"son.txt\", \"w+\");\n    if(yaz == NULL){\n        puts(\"Dosya acilmiyor\");\n        exit(1);\n    }\n\n    for(i=0; i&lt;800; i++){\n        fprintf(yaz, \"%d\\n\", sayilar[i]);\n    }\n    fclose(yaz);\n    pthread_exit(NULL);\n    return 0;\n}\nvoid *Sirala(void *param){\n    int i, baslangic, bitis;\n    if((long)param ==0){\n        baslangic = 0;\n        bitis= 300;\n        kontrol =1; \n        printf(\"Dizinin ilk 300 eleman\u0131n\u0131n s\u0131ras\u0131z hali:\\n\\n\");\n        for(i=baslangic; i&lt;bitis; i++){\n            printf(\"%d - \", sayilar[i]);\n        }\n        printf(\"/n/n\");\n    }\n    else if((long)param ==1){\n        baslangic = 300;\n        bitis= 800;\n        kontrol =2; \n        printf(\"Dizinin di\u011fer 500 eleman\u0131n\u0131n s\u0131ras\u0131z hali:\\n\\n\");\n        for(i=baslangic; i&lt;bitis; i++){\n            printf(\"%d - \", sayilar[i]);\n        } \n        printf(\"/n/n\");\n    }\n    else{\n        baslangic = 0;\n        bitis= 800;\n        kontrol =0;\n    }\n    for(i= baslangic; i&lt;bitis; i++){\n        quickSort(sayilar, baslangic, bitis-1);/*here*/\n    }   \n    if(kontrol ==1){\n        printf(\"Dizinin 300 eleman\u0131n\u0131n s\u0131ral\u0131 hali:\\n\\n\");\n        for(i = baslangic; i&lt;bitis; i++){\n            printf(\"%d - \", sayilar[i]);\n        }   \n    }\n    else if(kontrol ==2){\n        printf(\"Dizinin di\u011fer 500 eleman\u0131n\u0131n s\u0131ral\u0131 hali:\\n\\n\");\n        for(i = baslangic; i&lt;bitis; i++){\n            printf(\"%d - \", sayilar[i]);\n        }   \n    }\n    printf(\"\\n\\n\");\n    pthread_exit(0);\n}\nvoid quickSort(int a[], int sol, int sag){\n    int j;\n    if(sol&lt;sag){\n        j=partition(a,sol, sag);\n        quickSort(a, sol, j-1);\n        quickSort(a, j+1, sag); \n    }\n}\nint partition(int a[], int sol, int sag){\n    int pivot, i, j, t;\n    pivot = a[sol];\n    i= sol;\n    j= sag+1;\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9389953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff191b95dd6c58ef703e10f6423321d0?s=128&d=identicon&r=PG", "display_name": "user9389953", "link": "https://stackoverflow.com/users/9389953/user9389953"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "closed_date": 1527088689, "answer_count": 2, "score": -3, "last_activity_date": 1527066124, "creation_date": 1527062808, "last_edit_date": 1527064663, "question_id": 50483044, "link": "https://stackoverflow.com/questions/50483044/c-linux-debian-undefined-reference-to-function-in-multi-thread-program", "closed_reason": "Not suitable for this site", "title": "c-linux-debian undefined reference to function in multi thread program", "body": "<p>I got error message about \"undefined reference to function\". How can i solve this? Error message is in the image.\nWe are trying to make a multi-thread sorting program.</p>\n\n<p>First, a series of 800 elements and a random distribution of distributions should be created. The values \u200b\u200bof the elements are unique. Three scheduled threads will be created. The first thread lists the first 300 elements, while the second thread lists the other 500 threads. After the two workpieces have finished their work, they have not found the third workpiece sequence and the second-row sequences. We have a new set for merging. So it must be joined. In the last step, the listed elements should be taken to the file named \"son.txt\" which will be created in the working directory.</p>\n\n<pre><code>    #include &lt;pthread.h&gt;\n    #include &lt;stdio.h&gt;\n    #include &lt;stdlib.h&gt;\n    #include &lt;time.h&gt;\n    #define NUM_THREADS 3\n    int sayilar[800];\n    void *Sirala(void *param);\n    void quickSort(int[], int, int);\n    int partition(int[], int, int);\n    int kontrol=0;\n\nint main(int argc, char *argv[]){\nint i,j;\n    srand(time(NULL));\n    for(i=0; i&lt;800; i++){\n        sayilar[i] = 1+ (rand() % 800);\n        for(j=0; j&lt;1; j++){\n            if(sayilar[j]== sayilar[i]){\n                i--;\n                break;\n                }\n        }\n    }\n\n    pthread_t threads[NUM_THREADS];\n    int rc;\n    long t;\n    for(t=0; t&lt;3; t++){\n        rc = threadcreate(&amp;threads[t], NULL, Sirala, (void *)t);\n        if(rc){\n            printf(\"Hata, thread olu\u015fturulamad\u0131. Thread: %d\\n\", rc);\n            exit(-1);       \n        }\n        pthread_join(threads[t], NULL);\n    printf(\"\\n\\n\");\n    }\n    printf(\"SON\\n\");\n    for(i=0; i&lt;800; i++)\n        printf(\"%d\\n\", sayilar[i]);\n    printf(\"/n/n\");\n\n    FILE *yaz; //dosya g\u00f6stericisi\n    yaz = fopen(\"son.txt\", \"w+\");\n    if(yaz == NULL){\n        puts(\"Dosya acilmiyor\");\n        exit(1);\n    }\n    for(i=0; i&lt;800; i++){\n        fprintf(yaz, \"%d\\n\", sayilar[i]);\n    }\n    fclose(yaz);\n\n    pthread_exit(NULL);\n\nvoid *Sirala(void *param){\n    int i, baslangic, bitis;\n    if((long)param ==0){\n        baslangic = 0;\n        bitis= 300;\n        kontrol =1; \n        printf(\"Dizinin ilk 300 eleman\u0131n\u0131n s\u0131ras\u0131z hali:\\n\\n\");\n        for(i=baslangic; i&lt;bitis; i++){\n            printf(\"%d - \", sayilar[i]);\n        }\n        printf(\"/n/n\");\n    }\n    else if((long)param ==1){\n        baslangic = 300;\n        bitis= 800;\n        kontrol =2; \n        printf(\"Dizinin di\u011fer 500 eleman\u0131n\u0131n s\u0131ras\u0131z hali:\\n\\n\");\n        for(i=baslangic; i&lt;bitis; i++){\n            printf(\"%d - \", sayilar[i]);\n        } \n        printf(\"/n/n\");\n    }\n    else {\n        baslangic = 0;\n        bitis= 800;\n        kontrol =0;\n    }\n    for(i= baslangic; i&lt;bitis; i++){\n        quicksort(sayilar, baslangic, bitis-1);\n    }   \n    if(kontrol ==1){\n    printf(\"Dizinin 300 eleman\u0131n\u0131n s\u0131ral\u0131 hali:\\n\\n\");\n    for(i = baslangic; i&lt;bitis; i++){\n        printf(\"%d - \", sayilar[i]);\n    }   \n    }\n    else if(kontrol ==2){\n    printf(\"Dizinin di\u011fer 500 eleman\u0131n\u0131n s\u0131ral\u0131 hali:\\n\\n\");\n    for(i = baslangic; i&lt;bitis; i++){\n        printf(\"%d - \", sayilar[i]);\n    }   \n    }\n    printf(\"\\n\\n\");\n    pthread_exit(0);\n}\n\nvoid quickSort(int a[], int sol, int sag){\n    int j;\n    if(sol&lt;sag){\n        j=partition(a,sol, sag);\n        quickSort(a, sol, j-1);\n        quickSort(a, j+1, sag); \n    }\n}\n\nint partition(int a[], int sol, int sag){\n    int pivot, i, j, t;\n    pivot = a[sol];\n    i= sol;\n    j= sag+1;\n}\n}\n</code></pre>\n\n<p>Error message:</p>\n\n<p><img src=\"https://i.stack.imgur.com/yIbP7.png\" alt=\"error message\"></p>\n"}, {"tags": ["c", "multithreading", "pthreads", "semaphore"], "comments": [{"owner": {"reputation": 1859, "user_id": 2157639, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/faaf63a16923788f63d2a2b68c8d3c6b?s=128&d=identicon&r=PG", "display_name": "Ivan  Ivanov", "link": "https://stackoverflow.com/users/2157639/ivan-ivanov"}, "edited": false, "score": 1, "creation_date": 1527062418, "post_id": 50482404, "comment_id": 87978783, "body": "You get semi-random value because program spend different time on execution (time between <code>running</code> set to 1 and then set to 0)."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 7106343, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-g5yBWs3aAnM/AAAAAAAAAAI/AAAAAAAAADg/vc6W6sQhtgs/photo.jpg?sz=128", "display_name": "A D", "link": "https://stackoverflow.com/users/7106343/a-d"}, "edited": false, "score": 0, "creation_date": 1527066217, "post_id": 50483476, "comment_id": 87981281, "body": "first of all thnx a lot. if I want to explain more : I mean change the defining of long Long count, to int count and the same for sum.  after this change and also changing %lld to %d there is no change in the result (that you explained). I made a mistake in my question: int counter , gave me similar semi-random result, sorry for that. I thought that the changing the type of counter, can change the result.  @Acorn"}], "tags": [], "owner": {"reputation": 21663, "user_id": 9305398, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cqJvE.png?s=128&g=1", "display_name": "Acorn", "link": "https://stackoverflow.com/users/9305398/acorn"}, "is_accepted": false, "score": 1, "last_activity_date": 1527064226, "creation_date": 1527064226, "answer_id": 50483476, "question_id": 50482404, "link": "https://stackoverflow.com/questions/50482404/defining-variables-for-semaphore/50483476#50483476", "title": "defining variables for semaphore", "body": "<blockquote>\n  <p>1.the variables sum and counter in this code are defined as long long ? I changed them into int , but it did not give me similar counting,</p>\n</blockquote>\n\n<p>Not sure what you mean by that. Changing <code>int</code> to <code>long long</code> for both <code>counter</code> and <code>sum</code> (and adjusting the <code>%</code> formatting specifier accordingly to e.g. <code>%d</code>) should not (meaningfully) change the meaning of the program. In x86_64 Linux, you will be using a 32-bit counter, instead of a 64-bit one.</p>\n\n<blockquote>\n  <p>like the codes without threads and semaphore!</p>\n</blockquote>\n\n<p>Well, we would need to see the other program, but see below.</p>\n\n<blockquote>\n  <p>why count get semi-random values (even by setting it to zero in for loop again)?</p>\n</blockquote>\n\n<p>Because there are two concurrent threads running. One is incrementing the counter and the other is resetting it every second. There is no way to predict how many times the other thread will be able to increment the counter. It will depend on the load of the system (between runs in the same machine) and on the system itself (between machines, i.e. how fast it is).</p>\n\n<p>Typically, the only kind of system where the counter value could be \"predicted\" would be one with a non-OOO, fixed frequency processor with a deterministic scheduler/operating system, etc. A common desktop is not such a machine -- the complete opposite, in fact!</p>\n\n<p>I would suggest reading up on operating systems, their scheduler, timeslicing, etc.</p>\n"}], "owner": {"reputation": 33, "user_id": 7106343, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-g5yBWs3aAnM/AAAAAAAAAAI/AAAAAAAAADg/vc6W6sQhtgs/photo.jpg?sz=128", "display_name": "A D", "link": "https://stackoverflow.com/users/7106343/a-d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1527076154, "creation_date": 1527060778, "last_edit_date": 1527076154, "question_id": 50482404, "link": "https://stackoverflow.com/questions/50482404/defining-variables-for-semaphore", "title": "defining variables for semaphore", "body": "<p>I have two questions: </p>\n\n<ol>\n<li>the variables sum and counter in this code are defined as \n<strong>long long</strong> ? I changed them into int , but it did not give me similar counting, like the codes without threads and semaphore! Why does count get semi-random values (even by setting it to zero in for loop again)? </li>\n<li>How can I reach to 1+2+3.../10 ? I mean, what is the impact of type of \nvariables (those not related to semaphore, process and threads. i.e <code>pid_t</code>)?</li>\n</ol>\n\n<p>Thank you in advance. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;pthread.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;semaphore.h&gt;\nsem_t s1;\nchar running = 1;\nlong long counter = 0;\nvoid * process() {\n  while (running) {\n    sem_wait(&amp;s1);\n    counter++;\n    sem_post(&amp;s1);\n  }\n  printf(\"Thread: exit\\n\");\n  pthread_exit(NULL);\n}\n\nint main() {\n  int i;\n  long long sum = 0;\n  pthread_t thread_Id;\n  sem_init(&amp;s1, 0, 1);\n  if (pthread_create(&amp;thread_Id, NULL, process, NULL)) {\n    printf(\"ERROR in pthread_create()\\n\");\n    exit(-1);\n  }\n\n  for (i=0 ; i &lt; 10 ; i++) {\n    sleep(1);\n    sem_wait(&amp;s1);\n    printf(\"counter = %lld\\n\", counter);\n    sum += counter;\n    counter = 0;\n    sem_post(&amp;s1);\n  }\n\n  sem_wait(&amp;s1);\n  running = 0;\n  sem_post(&amp;s1);\n  pthread_join(thread_Id, NULL);\n  printf(\"Average Instructions = %lld \\n\", sum/10);\n\n  return 0;\n\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "sockets", "solaris", "lib"], "comments": [{"owner": {"reputation": 6673, "user_id": 777689, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/19JOo.jpg?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/777689/petert"}, "edited": false, "score": 4, "creation_date": 1527060250, "post_id": 50482186, "comment_id": 87977352, "body": "You mean run without recompiling? You can&#39;t just copy any linux binary and expect it work on another OS"}, {"owner": {"reputation": 47, "user_id": 9482643, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "\uae40\uc9c4\uc601", "link": "https://stackoverflow.com/users/9482643/%ea%b9%80%ec%a7%84%ec%98%81"}, "reply_to_user": {"reputation": 6673, "user_id": 777689, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/19JOo.jpg?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/777689/petert"}, "edited": false, "score": 0, "creation_date": 1527060464, "post_id": 50482186, "comment_id": 87977508, "body": "Does It need recompile? Are not they the same ELF file?"}, {"owner": {"reputation": 6673, "user_id": 777689, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/19JOo.jpg?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/777689/petert"}, "edited": false, "score": 4, "creation_date": 1527061111, "post_id": 50482186, "comment_id": 87977908, "body": "I would suggest that you recompile. There&#39;s apparently some emulation layers for linux binaries on solaris, but they seem to have their limitiations. If you have the source just compile it for solaris instead. It&#39;s a different OS. There&#39;s more to a system environment than its binary containerformat and instruction set."}, {"owner": {"reputation": 3921, "user_id": 46220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc77d5a13726cfd5528da0f809153956?s=128&d=identicon&r=PG", "display_name": "alanc", "link": "https://stackoverflow.com/users/46220/alanc"}, "edited": false, "score": 0, "creation_date": 1527088243, "post_id": 50482186, "comment_id": 87996596, "body": "Solaris &amp; Linux use the same ELF format, but different libraries &amp; system calls, so a recompile is required."}, {"owner": {"reputation": 47, "user_id": 9482643, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "\uae40\uc9c4\uc601", "link": "https://stackoverflow.com/users/9482643/%ea%b9%80%ec%a7%84%ec%98%81"}, "edited": false, "score": 0, "creation_date": 1527121449, "post_id": 50482186, "comment_id": 88011199, "body": "Thank you very much for your help."}], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 9482643, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "\uae40\uc9c4\uc601", "link": "https://stackoverflow.com/users/9482643/%ea%b9%80%ec%a7%84%ec%98%81"}, "edited": false, "score": 0, "creation_date": 1527121406, "post_id": 50482518, "comment_id": 88011188, "body": "Thank you very much. Your answer has been a great help to me."}], "tags": [], "owner": {"reputation": 912, "user_id": 1920835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d730e4b0caec717f1f5a19af5f1c25a3?s=128&d=identicon&r=PG", "display_name": "Rob Newton", "link": "https://stackoverflow.com/users/1920835/rob-newton"}, "is_accepted": true, "score": 4, "last_activity_date": 1527061119, "creation_date": 1527061119, "answer_id": 50482518, "question_id": 50482186, "link": "https://stackoverflow.com/questions/50482186/cannot-find-lib64-ld-linux-x86-64-so-2/50482518#50482518", "title": "Cannot find /lib64/ld-linux-x86-64.so.2", "body": "<p>Solaris is not Linux.  The system libraries will most likely be in different locations.    You will need to recompile your program on Solaris.</p>\n"}], "owner": {"reputation": 47, "user_id": 9482643, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "\uae40\uc9c4\uc601", "link": "https://stackoverflow.com/users/9482643/%ea%b9%80%ec%a7%84%ec%98%81"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6036, "favorite_count": 0, "accepted_answer_id": 50482518, "answer_count": 1, "score": 1, "last_activity_date": 1527061119, "creation_date": 1527060033, "question_id": 50482186, "link": "https://stackoverflow.com/questions/50482186/cannot-find-lib64-ld-linux-x86-64-so-2", "title": "Cannot find /lib64/ld-linux-x86-64.so.2", "body": "<p>I was coding a simple socket agent program in LINUX system(Ubuntu 16.04 server).</p>\n\n<p>When I run this program in Solaris, It gets the following error:</p>\n\n<pre><code>Cannot find /lib64/ld-linux-x86-64.so.2\n</code></pre>\n\n<p>This list is what I included.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;string.h&gt;\n#include &lt;arpa/inet.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/socket.h&gt;\n</code></pre>\n\n<p>Why is this happening? Please let me know.....</p>\n"}, {"tags": ["c", "type-conversion"], "comments": [{"owner": {"reputation": 10050, "user_id": 3512538, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/6Om7A.png?s=128&g=1", "display_name": "CIsForCookies", "link": "https://stackoverflow.com/users/3512538/cisforcookies"}, "edited": false, "score": 0, "creation_date": 1527059327, "post_id": 50481907, "comment_id": 87976835, "body": "you want to read the char array, extract the specific variable name (<code>PINB</code> or <code>PIND</code>) and then perform a shift on it and return as a <code>uint8</code>?"}, {"owner": {"reputation": 432, "user_id": 8068536, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1eafb1d91ea01feb319f8f969058056d?s=128&d=identicon&r=PG&f=1", "display_name": "david_10001", "link": "https://stackoverflow.com/users/8068536/david-10001"}, "reply_to_user": {"reputation": 10050, "user_id": 3512538, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/6Om7A.png?s=128&g=1", "display_name": "CIsForCookies", "link": "https://stackoverflow.com/users/3512538/cisforcookies"}, "edited": false, "score": 0, "creation_date": 1527059420, "post_id": 50481907, "comment_id": 87976890, "body": "Extract the value, return it as a uint_8 then perform as shift on it. Or just literally insert the text of the array index into that for loop"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1527059654, "post_id": 50481907, "comment_id": 87977019, "body": "Maybe I&#39;m misunderstanding your question but it seems to me you are trying to get a text string executed as code (!?). That&#39;s not possible."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1527059981, "post_id": 50481907, "comment_id": 87977184, "body": "How are those <code>PINx</code> defined?"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1527059985, "post_id": 50481907, "comment_id": 87977189, "body": "You could make an array of function pointers, e.g. <code>uint8_t f0() {return PINB &gt;&gt; 7;}</code> or just make a support function if you don&#39;t like all the if statements inside the loop."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1527060127, "post_id": 50481907, "comment_id": 87977275, "body": "How many <code>PINx</code> values are possible?"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1527060195, "post_id": 50481907, "comment_id": 87977305, "body": "You can pack the information in a <code>struct</code> with bit fields."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1527060292, "post_id": 50481907, "comment_id": 87977383, "body": "@4386427 it is possible. He just needs to write the interpreter."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1527067463, "post_id": 50481907, "comment_id": 87982177, "body": "@PeterJ_01 yaaa, that would be a real fun way to make simple stuff complicated"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1527068502, "post_id": 50481907, "comment_id": 87982905, "body": "Good programming exercise."}], "answers": [{"tags": [], "owner": {"reputation": 10050, "user_id": 3512538, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/6Om7A.png?s=128&g=1", "display_name": "CIsForCookies", "link": "https://stackoverflow.com/users/3512538/cisforcookies"}, "is_accepted": false, "score": 1, "last_activity_date": 1527061769, "last_edit_date": 1527061769, "creation_date": 1527060452, "answer_id": 50482307, "question_id": 50481907, "link": "https://stackoverflow.com/questions/50481907/how-to-convert-strings-in-array-to-unsigned-integers/50482307#50482307", "title": "How to convert strings in array to unsigned integers?", "body": "<p>You can use your knowledge about the array and create a function to convert your values from <code>\"PINB &gt;&gt; 7\"</code> to <code>PINB &gt;&gt; 7</code>. The assumptions I made are:</p>\n\n<ol>\n<li>The string always starts with \"PIN\" and then has a \"B\" or a \"D\" (can be easily modified )</li>\n<li>The string will then do an operation (currently I only support \">>\" but this can too be easily modified)</li>\n<li>Last char in the string is a 1-char number (again, can be modified according to your knowledge about the string)</li>\n</ol>\n\n<p>Using that, I can create a <code>convert</code> function</p>\n\n<pre><code>unsigned int convert(char * p);\n\n/* PINB and the others have defined 8 bit value in the libraries\n   so I'm making up their values here for convenience */\nunsigned int PINB = 1024;\nunsigned int PIND = 2048;\n\nint main(){\n    // deleted your ending }\n    // and changed the type of the array\n    char* switch_list[] = {\n        \"PINB &gt;&gt; 7\", \n        \"PIND &gt;&gt; 1\", \n        \"PINB &gt;&gt; 1\", \n        \"PIND &gt;&gt; 0\"\n    };\n\n    unsigned int switch_value;\n    // , should be ;\n    // don't compare signed with unsigned\n    for (unsigned int i = 0; i &lt; sizeof(switch_list)/sizeof(switch_list[0]); i++){\n        switch_value = convert(switch_list[i]); \n        printf(\"%u\\n\", switch_value);\n    }\n\n    return 0;\n}\n\n// assuming string must be exactly long as \"PINB &gt;&gt; 7\"\nunsigned int convert(char * p){\n    if(!p || strlen(p) != strlen(\"PINB &gt;&gt; 7\")){\n        printf(\"error\\n\");\n        return (unsigned)-1;\n    }\n\n    unsigned int n;\n    // use a string compare or, in your case, since only the 4th char is different:\n    if(p[3] == 'B')\n        n = PINB;\n    if(p[3] == 'D')\n        n = PIND;\n    // note I'm not handling a case where the 4th letter isn't {'B', 'D'}, according to my assumption (the 1st).\n\n    // use your knowledge about the string inside switch_list\n    return n &gt;&gt; (p[strlen(p) - 1] - '0');\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1527067389, "post_id": 50483180, "comment_id": 87982114, "body": "IMO, this is by far the best approach. I&#39;m not sure that <code>&amp;PINx</code> is correct but that&#39;s not important. The principle is what&#39;s important."}], "tags": [], "owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "is_accepted": false, "score": 1, "last_activity_date": 1527063255, "creation_date": 1527063255, "answer_id": 50483180, "question_id": 50481907, "link": "https://stackoverflow.com/questions/50481907/how-to-convert-strings-in-array-to-unsigned-integers/50483180#50483180", "title": "How to convert strings in array to unsigned integers?", "body": "<p>Assuming the <code>PINx</code> thingies would evaluate to a type <code>PIN_T</code> you can do:</p>\n\n<pre><code>#include &lt;stdlib.h&gt; /* for size_t */\n#include &lt;inttypes.h&gt; /* for uint8_t */\n\n/* other include here */\n\n\nstruct switch_s\n{\n  PIN_T * ppin;\n  uint8_t offset;\n};\n\nstruct switch_s switches[] =\n{\n  {&amp;PINB, 7},\n  {&amp;PIND, 1},\n  {&amp;PINB, 1},\n  {&amp;PIND, 0},\n  /* more here */\n};\n\nint main(void)\n{ \n  for (size_t i; i &lt; sizeof switches / sizeof *switches; ++i)\n  {\n    uint8_t switch_value = (*switches[i].ppin &gt;&gt; switches[i].offset) &amp; 1;\n\n    /* Work with switch_value here ... */\n  }\n}\n</code></pre>\n"}], "owner": {"reputation": 432, "user_id": 8068536, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1eafb1d91ea01feb319f8f969058056d?s=128&d=identicon&r=PG&f=1", "display_name": "david_10001", "link": "https://stackoverflow.com/users/8068536/david-10001"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 136, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1527063255, "creation_date": 1527059176, "last_edit_date": 1527059565, "question_id": 50481907, "link": "https://stackoverflow.com/questions/50481907/how-to-convert-strings-in-array-to-unsigned-integers", "title": "How to convert strings in array to unsigned integers?", "body": "<p>I have the following code:</p>\n\n<pre><code>char switch_list[] = {\n    \"PINB &gt;&gt; 7\", \n    \"PIND &gt;&gt; 1\", \n    \"PINB &gt;&gt; 1\", \n    \"PIND &gt;&gt; 0}\"\n};\n\nvoid values(void){\n    uint8_t switch_value = 0;\n        if (i == 0){\n            switch_value = (PINB &gt;&gt; 7) &amp; 1; \n        }\n        if (i == 1){\n            switch_value = (PIND &gt;&gt; 1) &amp; 1;\n        }\n        if (i == 2){\n            switch_value = (PINB &gt;&gt; 1) &amp; 1;\n        }\n        if (i == 3){\n            switch_value = (PIND &gt;&gt; 0) &amp; 1;\n        }\n        SOME OTHER OPERATIONS GO HERE\n}\n</code></pre>\n\n<p>I need to interpret the <strong>switch_list</strong> values as unsigned integers somehow, but I am not able to  make any changes to the array (it needs to remain a char array). <strong>PINB</strong> and the others have defined 8 bit value in the libraries. I would like to create a for loop that looks something like this:</p>\n\n<pre><code>uint8_t switch_value = 0;\n    for (int i = 0, i &lt; sizeof(switch_list)/sizeof(switch_list[0]); i++){\n            switch_value = **********[i] &amp; 1; \n         SOME OTHER OPERATIONS GO HERE\n        }\n}\n</code></pre>\n\n<p>Where ********* is the same as <strong>switch_list</strong> but instead of being of char type, it is <strong>uint8_t</strong>. Can anyone provide any tips?</p>\n"}, {"tags": ["c", "coroutine"], "comments": [{"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1527063778, "post_id": 50481755, "comment_id": 87979635, "body": "If you want to serialize execution of 2 processes, why do you use 2 processes at all?"}, {"owner": {"reputation": 3380, "user_id": 3308570, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/3Mzz9.jpg?s=128&g=1", "display_name": "JustWe", "link": "https://stackoverflow.com/users/3308570/justwe"}, "reply_to_user": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1527063925, "post_id": 50481755, "comment_id": 87979718, "body": "@Gerhardh I having the same problem. <a href=\"https://stackoverflow.com/questions/50383520/why-should-i-use-coroutine-in-c-c\" title=\"why should i use coroutine in c c\">stackoverflow.com/questions/50383520/&hellip;</a>"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1527066383, "post_id": 50481755, "comment_id": 87981383, "body": "That&#39;s the same weird <code>setjmp</code>-massacre. Then put it this way: If you want serial execution of single steps why would you want to organize them in such a set of functions? Just call the stepts within one function. Or maybe maintain a static variable in the second function that holds information about which step to execute next. Or are you searching for a problem that might match your semi-solution?"}, {"owner": {"reputation": 3380, "user_id": 3308570, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/3Mzz9.jpg?s=128&g=1", "display_name": "JustWe", "link": "https://stackoverflow.com/users/3308570/justwe"}, "reply_to_user": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1527067107, "post_id": 50481755, "comment_id": 87981900, "body": "@Gerhardh I am studying about how to make the <i>correct</i> coroutine implementation in C. Then wiki and google told me the solution need using <code>setjmp</code>. So I am searching the right way lead me to the real &#39;coroutine&#39;. don&#39;t care it&#39;s good or not, just wondering how to make it works."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1527067418, "post_id": 50481755, "comment_id": 87982142, "body": "Which problem do you want to solve? Using coroutines just for the sake of using coroutines sounds a bit strange. The comment to your linked question is very true."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1527067623, "post_id": 50481755, "comment_id": 87982286, "body": "Also your other question is based on a (incorrect) answer to a question looking for some usecase for <code>setjmp</code>. It doesn&#39;t make much sense to insist on using it unless it really solves your problem. Which you don&#39;t tell us."}, {"owner": {"reputation": 3380, "user_id": 3308570, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/3Mzz9.jpg?s=128&g=1", "display_name": "JustWe", "link": "https://stackoverflow.com/users/3308570/justwe"}, "reply_to_user": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1527067821, "post_id": 50481755, "comment_id": 87982417, "body": "@Gerhardh That incorrect answer is the beginning of all of these question I asked...I am just trying to know what&#39;s coroutine in C."}, {"owner": {"reputation": 3380, "user_id": 3308570, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/3Mzz9.jpg?s=128&g=1", "display_name": "JustWe", "link": "https://stackoverflow.com/users/3308570/justwe"}, "reply_to_user": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1527068074, "post_id": 50481755, "comment_id": 87982593, "body": "I&#39;m having the exactly same question as you. But people created this evil <code>setjmp</code> and tell me it&#39;s way of the coroutine."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "reply_to_user": {"reputation": 3380, "user_id": 3308570, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/3Mzz9.jpg?s=128&g=1", "display_name": "JustWe", "link": "https://stackoverflow.com/users/3308570/justwe"}, "edited": false, "score": 0, "creation_date": 1527069345, "post_id": 50481755, "comment_id": 87983465, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/171611/discussion-between-gerhardh-and-jiu\">continue this discussion in chat</a>."}], "answers": [{"tags": [], "owner": {"reputation": 170455, "user_id": 149341, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/omfTQ.png?s=128&g=1", "display_name": "duskwuff -inactive-", "link": "https://stackoverflow.com/users/149341/duskwuff-inactive"}, "is_accepted": false, "score": 3, "last_activity_date": 1527060848, "creation_date": 1527060848, "answer_id": 50482423, "question_id": 50481755, "link": "https://stackoverflow.com/questions/50481755/how-to-implement-coroutine-within-for-loop-in-c/50482423#50482423", "title": "How to implement coroutine within for loop in c", "body": "<p>The <code>setjmp()</code> and <code>longjmp()</code> functions can only be used to exit from a nested subroutine, as a sort of \"throw/catch\". They cannot be used to reenter a subroutine that has already exited, either through a <code>return</code> or through a <code>longjmp()</code>. In short, they cannot be used this way.</p>\n\n<p>The only well-defined way to implement coroutines in C is <a href=\"https://www.chiark.greenend.org.uk/~sgtatham/coroutines.html\" rel=\"nofollow noreferrer\">as a state machine</a>. There is no way to implement coroutines as normal subroutines, as this is incompatible with the C stack.</p>\n"}, {"comments": [{"owner": {"reputation": 3380, "user_id": 3308570, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/3Mzz9.jpg?s=128&g=1", "display_name": "JustWe", "link": "https://stackoverflow.com/users/3308570/justwe"}, "edited": false, "score": 0, "creation_date": 1527063527, "post_id": 50482435, "comment_id": 87979450, "body": "I understand <i>At this point b&#39;s execution has terminated</i>. So in <a href=\"https://stackoverflow.com/questions/14685406/practical-usage-of-setjmp-and-longjmp-in-c\" title=\"practical usage of setjmp and longjmp in c\">stackoverflow.com/questions/14685406/&hellip;</a> the example of the first answer is wrong?"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 3380, "user_id": 3308570, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/3Mzz9.jpg?s=128&g=1", "display_name": "JustWe", "link": "https://stackoverflow.com/users/3308570/justwe"}, "edited": false, "score": 1, "creation_date": 1527063708, "post_id": 50482435, "comment_id": 87979586, "body": "@Jiu yes the example is completely wrong. Read the comments for that answer. It is possible for very primitive functions and not supported by the standard. It just works because of some artifacts of how <i>some</i> compilers work."}], "tags": [], "owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "is_accepted": true, "score": 3, "last_activity_date": 1527062470, "last_edit_date": 1592644375, "creation_date": 1527060878, "answer_id": 50482435, "question_id": 50481755, "link": "https://stackoverflow.com/questions/50481755/how-to-implement-coroutine-within-for-loop-in-c/50482435#50482435", "title": "How to implement coroutine within for loop in c", "body": "<p>What you are trying to achieve using your code here is not defined.</p>\n<p>Quoting <code>C11</code>, chapter <a href=\"http://port70.net/%7Ensz/c/c11/n1570.html#7.13.2.1p2\" rel=\"nofollow noreferrer\">\u00a77.13.2.1p2</a></p>\n<blockquote>\n<p>The <code>longjmp</code> function restores the environment saved by the most recent invocation of the <code>setjmp</code> macro in the same invocation of the program with the corresponding jmp_buf argument. If there has been no such invocation, or if the invocation was from another thread of execution, <strong>or if the function containing the invocation of the <code>setjmp</code> macro has terminated execution</strong> in the interim, or if the invocation of the <code>setjmp</code> macro was within the scope of an identifier with variably modified type and execution has left that scope in the interim, the behavior is undefined.</p>\n<p><sub>Emphasis mine</sub></p>\n</blockquote>\n<p>Regarding what counts as terminated execution:</p>\n<p>Quoting <code>C11</code>, chapter <a href=\"http://port70.net/%7Ensz/c/c11/n1570.html#note248\" rel=\"nofollow noreferrer\">\u00a7note248</a></p>\n<blockquote>\n<p>For example, by executing a return statement or because another <code>longjmp</code> call has caused a transfer to a <code>setjmp</code> invocation in a function earlier in the set of nested calls.</p>\n</blockquote>\n<p>So, say you call <code>a()</code> first, and it calls <code>b()</code> after setting the <code>a_buf</code>. Now <code>b()</code> sets the <code>b_buf</code> and jumps back to <code>a</code>. At this point <code>b</code>'s execution has terminated and if you jump back to <code>b_buf</code>, the behavior is undefined.</p>\n<p>One possible solution for your problem could be to define functions <code>a_step()</code> and <code>b_step()</code> which perform just a single step of <code>a()</code> and <code>b()</code> respectively. Then call them alternatively in a loop.</p>\n"}, {"tags": [], "owner": {"reputation": 111, "user_id": 2446655, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60d916b39d72a6c6c14ab34221df00af?s=128&d=identicon&r=PG", "display_name": "xhawk18", "link": "https://stackoverflow.com/users/2446655/xhawk18"}, "is_accepted": false, "score": 0, "last_activity_date": 1584884552, "creation_date": 1584884552, "answer_id": 60800066, "question_id": 50481755, "link": "https://stackoverflow.com/questions/50481755/how-to-implement-coroutine-within-for-loop-in-c/60800066#60800066", "title": "How to implement coroutine within for loop in c", "body": "<p>Please look at the \"s_task\" coroutine, which may be the answer for you --</p>\n\n<p><a href=\"https://github.com/xhawk18/s_task\" rel=\"nofollow noreferrer\">https://github.com/xhawk18/s_task</a></p>\n\n<p>features --</p>\n\n<ol>\n<li>written in pure c and asm, without c++ required</li>\n<li>asm code from boost context, which is robust and effective</li>\n<li>add keywords <strong>await</strong> and <strong>async</strong></li>\n<li>supports various platforms, such as windows, linux (arm,x86,mips), stm32, stm8</li>\n<li>have integrated with libuv for network programming</li>\n<li>\"event\" and \"mutex\" object for communication between coroutings</li>\n</ol>\n"}], "owner": {"reputation": 3380, "user_id": 3308570, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/3Mzz9.jpg?s=128&g=1", "display_name": "JustWe", "link": "https://stackoverflow.com/users/3308570/justwe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 324, "favorite_count": 1, "accepted_answer_id": 50482435, "answer_count": 3, "score": 1, "last_activity_date": 1613398380, "creation_date": 1527058696, "question_id": 50481755, "link": "https://stackoverflow.com/questions/50481755/how-to-implement-coroutine-within-for-loop-in-c", "title": "How to implement coroutine within for loop in c", "body": "<p>Here is part code:</p>\n\n<pre><code>void a()\n{\n    printf(\"entering a\\n\");\n    int i;\n    for(i = 0; i &lt; 3; i++){\n        if(setjmp(a_buf) == 0) {\n            printf(\"A step %d\\n\", i);\n            b();\n        } else {\n            longjmp(b_buf, 1);\n        }\n    }\n    printf(\"returning from a\\n\");\n}\n\nvoid b()\n{\n    printf(\"entering b\\n\");\n    int i;\n    for(i = 0; i &lt; 5; i++){\n        if(setjmp(b_buf) == 0) {\n            printf(\"B step %d\\n\", i);\n            a();\n        } else {\n            longjmp(a_buf, 1);\n        }\n    }\n    printf(\"returning from b\\n\");\n}\n</code></pre>\n\n<p>I have two processes <code>a</code> &amp; <code>b</code>. How to make them works as coroutine.\nWish them doing <code>A Step 0</code> then <code>B Step 0</code> then back to <code>A Step 1</code>... until both finished. But looks like counter <code>i</code> never changed.</p>\n"}, {"tags": ["c", "fopen"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 3, "creation_date": 1527065076, "post_id": 50481739, "comment_id": 87980464, "body": "The pointer to the filename is here: <code>pthis-&gt;fname</code>. You probably lack the most basic knowledge of C programming, or just programming. Start reading your C text book."}], "answers": [{"comments": [{"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 1, "creation_date": 1527067691, "post_id": 50481958, "comment_id": 87982329, "body": "Consider linking to a <a href=\"https://www.tutorialspoint.com/c_standard_library/c_function_fopen.htm\" rel=\"nofollow noreferrer\">C reference</a> of <code>fopen</code> instead of a <code>C++</code> one."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1527080383, "post_id": 50481958, "comment_id": 87990986, "body": "@AjayBrahmakshatriya Even better:  <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"nofollow noreferrer\">http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf</a> or <a href=\"https://port70.net/~nsz/c/c11/n1570.html#7.21.5.3\" rel=\"nofollow noreferrer\">https://port70.net/~nsz/c/c11/n1570.html#7.21.5.3</a>."}], "tags": [], "owner": {"reputation": 957, "user_id": 1393510, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/d577ec4e03225c00a51523736dbe006a?s=128&d=identicon&r=PG&f=1", "display_name": "baptiste", "link": "https://stackoverflow.com/users/1393510/baptiste"}, "is_accepted": false, "score": 1, "last_activity_date": 1527080141, "last_edit_date": 1527080141, "creation_date": 1527059326, "answer_id": 50481958, "question_id": 50481739, "link": "https://stackoverflow.com/questions/50481739/what-is-this-code-means-fopen-pthis-fname-w/50481958#50481958", "title": "What is this code means? fopen (pthis -&gt; fname,w)", "body": "<p>If you look at the <code>fopen</code> <a href=\"https://www.tutorialspoint.com/c_standard_library/c_function_fopen.htm\" rel=\"nofollow noreferrer\">reference documentation</a>. You will see the function is defined this way:</p>\n\n<pre><code>FILE * fopen ( const char * filename, const char * mode );\n</code></pre>\n\n<p>Your filename <code>\"C:\\temp\\kmj12134.txt\"</code> is the path to the file to either write (<code>w</code>) or read (<code>r</code>) depending on the <code>mode</code> option.</p>\n\n<p>So <code>fp = fopen(pthis-&gt;fname,\"w\");</code> basically means you write a file at the path <code>pthis-&gt;fname</code> where <code>pthis-&gt;fname</code> is of type <code>const char*</code>. You can see this path by simply printing it:</p>\n\n<pre><code>printf(\"filename: %s\\n\", pthis-&gt;fname);\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9798773, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Rozwel Gustab", "link": "https://stackoverflow.com/users/9798773/rozwel-gustab"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 0, "closed_date": 1527088948, "answer_count": 1, "score": 0, "last_activity_date": 1527080141, "creation_date": 1527058653, "last_edit_date": 1527059021, "question_id": 50481739, "link": "https://stackoverflow.com/questions/50481739/what-is-this-code-means-fopen-pthis-fname-w", "closed_reason": "Needs more focus", "title": "What is this code means? fopen (pthis -&gt; fname,w)", "body": "<pre><code>fp = fopen(pthis-&gt;fname,\"w\");\n</code></pre>\n\n<p>Well I, ask here second time.</p>\n\n<p>I used that code. </p>\n\n<p>Since I knew about that code, i always used fopen(\"C:\\temp\\kmj12134.txt\",\"w\") </p>\n\n<p>This code means save the kmj12134.txt in C:\\temp.</p>\n\n<p>But when i use that code,</p>\n\n<p>I don't know what is the file name and where is save place.</p>\n\n<p>Do you know the file name and where is save place?</p>\n\n<p>And do you know how to change file name and change save place?</p>\n"}, {"tags": ["c", "haskell", "garbage-collection", "ffi", "bytestring"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1527058529, "post_id": 50481610, "comment_id": 87976405, "body": "You can force the <code>ByteString</code> to not be GC&#39;ed via <code>touchForeignPtr</code>. That doesn&#39;t solve all of your problems, but it sure helps the examples you gave. You&#39;ll have to tiptoe around laziness though..."}, {"owner": {"reputation": 1750, "user_id": 3929481, "user_type": "registered", "accept_rate": 12, "profile_image": "https://i.stack.imgur.com/3ZrH1.jpg?s=128&g=1", "display_name": "mcmayer", "link": "https://stackoverflow.com/users/3929481/mcmayer"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1527058800, "post_id": 50481610, "comment_id": 87976555, "body": "touchForeignPtr: &quot;This function ensures that the foreign object in question is alive at the given place in the sequence of IO actions.&quot; That&#39;s neat."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1527061388, "post_id": 50481610, "comment_id": 87978109, "body": "Regarding wanting to avoid <code>IO</code> in favour of another monad, you could go to <code>ST</code>. Depending on what you are doing <code>unsafeIOToST :: IO a -&gt; ST s a</code> might be useful for lifting an FFI imported <code>IO</code> action to <code>ST</code>."}, {"owner": {"reputation": 1750, "user_id": 3929481, "user_type": "registered", "accept_rate": 12, "profile_image": "https://i.stack.imgur.com/3ZrH1.jpg?s=128&g=1", "display_name": "mcmayer", "link": "https://stackoverflow.com/users/3929481/mcmayer"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1527232141, "post_id": 50481610, "comment_id": 88058696, "body": "<code>unsafeIOToST</code> is a nice mechanism. One drawback I noticed is that <code>liftIO</code> is not avaliable in <code>ST</code>. In <code>ST</code> that makes sense, but since my <code>ST</code> ist just <code>IO</code> in disguise, <code>liftIO</code> ought to be available. I guess it&#39;s possible to make my own <code>myLiftIO</code>, which is actually just <code>unsafeIOToST</code>, I think."}], "owner": {"reputation": 1750, "user_id": 3929481, "user_type": "registered", "accept_rate": 12, "profile_image": "https://i.stack.imgur.com/3ZrH1.jpg?s=128&g=1", "display_name": "mcmayer", "link": "https://stackoverflow.com/users/3929481/mcmayer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 348, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1527060484, "creation_date": 1527058217, "last_edit_date": 1527060484, "question_id": 50481610, "link": "https://stackoverflow.com/questions/50481610/haskell-ffi-correct-way-to-pass-in-and-return-bytestrings", "title": "Haskell FFI: Correct way to pass in and return ByteStrings", "body": "<p><strong>Setup</strong></p>\n\n<p>Suppose you have a typical C API where some struct is allocated, then initialised (memory allocated, handles created, etc.), then worked upon (transformed, queried, etc.) using various functions, and finally freed again. I.e. the standard C-style OO framework where the struct is the 'object' and the functions are the 'member functions'.</p>\n\n<p>More specifically, let the API work on bytestrings. For example, this could be a compression library.</p>\n\n<p>In Haskell, <code>Data.ByteString.ByteString</code>, at the lowest level, is just \"pinned memory in the GC heap\" (allocated with <a href=\"http://hackage.haskell.org/package/bytestring-0.10.8.2/docs/src/Data.ByteString.Internal.html#mallocByteString\" rel=\"nofollow noreferrer\"><code>mallocPlainForeignPtrBytes</code></a>), the pointer to which is the first argument to the <code>ByteString</code> constructor <a href=\"http://hackage.haskell.org/package/bytestring-0.10.8.2/docs/src/Data.ByteString.Internal.html#PS\" rel=\"nofollow noreferrer\"><code>PS</code></a>. The underlying memory of the <code>ByteString</code> can be obtained with <a href=\"http://hackage.haskell.org/package/bytestring-0.9/docs/Data-ByteString-Internal.html#v%3AtoForeignPtr\" rel=\"nofollow noreferrer\"><code>Data.ByteString.Internal.toForeignPtr</code></a>. So far so good.</p>\n\n<p><strong>Passing down <code>ByteString</code></strong></p>\n\n<p>It is convenient to let Haskell manage the <code>ByteString</code> on which the C API operates. In C we might have a struct and a init function like this:</p>\n\n<pre><code>   typedef struct { \n       uint8_t* buf; \n       size_t buflen; \n   } API_t;\n\n   void API_init_as_writer(API_t* p, uint8_t* buf, size_t buflen);\n</code></pre>\n\n<p><code>buf</code> and <code>buflen</code> hold the Haskell <code>ByteString</code>. This object becomes a 'writer'. The Haskell binding would look like this:</p>\n\n<pre><code>   data API  -- empty decl (needs EmptyDataDecls extension)\n\n   foreign import ccall unsafe \"API.h API_init_as_writer\"\n       init :: Ptr API -&gt; Ptr Word8 -&gt; Int -&gt; IO ()\n</code></pre>\n\n<p>where the <code>Ptr Word8</code> is obtained with <a href=\"http://hackage.haskell.org/package/bytestring-0.9/docs/Data-ByteString-Internal.html#v:toForeignPtr\" rel=\"nofollow noreferrer\"><code>toForeignPtr</code></a> and <a href=\"http://hackage.haskell.org/package/base-4.11.1.0/docs/Foreign-ForeignPtr.html#v:withForeignPtr\" rel=\"nofollow noreferrer\"><code>withForeignPtr</code></a>.</p>\n\n<p><strong>Returning (passing up) a <code>ByteString</code></strong></p>\n\n<p>Similarly, we can let the object (struct) become a 'reader' and create the <code>ByteString</code> as described above, using <code>mallocPlainForeignPtrBytes</code> and <code>PS</code>.</p>\n\n<p><strong>Garbage collection gets in the way!</strong></p>\n\n<p>The trouble with this is that the garbage collector does not know that the <code>ByteStrings</code> are being used (via the struct that holds the pointer to the memory on the GC heap) after the API_init_* functions have been called. In the case of the 'writer':</p>\n\n<pre><code>    writer &lt;- initWriter 1024     -- inits with buflen of 1024 via mallocPlainForeignPtrBytes\n    writeSomething writer\n    writeSomethingElse writer\n    ...\n    bs &lt;- getByteString writer    -- construct ByteString with PS\n    writeFile \"Some.file\" bs\n</code></pre>\n\n<p>and in the case of the 'reader':</p>\n\n<pre><code>    bs &lt;- ByteString.readFile(\"Some.file\")\n    reader &lt;- initReader bs\n    info1 &lt;- readSomething reader\n    info2 &lt;- readSomethingElse reader\n</code></pre>\n\n<p>All this happens in the IO monad.</p>\n\n<p>Clearly, this doesn't work. The <code>ByteString</code> may get garbage collected after <code>initWriter</code> or <code>initReader</code>, and the <code>writeSomething</code> or <code>readSomething</code> functions will continue using the garbage collected memory.</p>\n\n<p>And, notwithstanding any GC issues, just like the <code>ByteString</code> has been \"unsafe'd\" out of the IO monad, these API <code>ByteString</code> ops shouldn't be in the IO monad, either, because there isn't really any IO or interaction with <code>RealWorld</code> happening.</p>\n\n<p>So the question is: <strong>How is this structured correctly in Haskell?</strong></p>\n\n<p><a href=\"https://stackoverflow.com/questions/32197977/how-to-create-two-bytestrings-calling-this-external-library-api/32198466#32198466\">This</a> SO question leads to the hint of using <code>IORef</code>, which is not very nice.</p>\n\n<p>My hunch is that this needs to be made functional. The sequential nature of these OO-type APIs (alloc, init, operate, operate, ..., free) necessitate the introduction of a monad other than the IO monad, I guess. But I don't quite see how to set this up correctly. When I look at database bindings I only see the IO monad. For example, the <a href=\"https://hackage.haskell.org/package/BerkeleyDB-0.8.7/docs/Database-Berkeley-Db.html#v:db_get\" rel=\"nofollow noreferrer\"><code>db_get</code></a> function of the <a href=\"https://hackage.haskell.org/package/BerkeleyDB-0.8.7/docs/Database-Berkeley-Db.html\" rel=\"nofollow noreferrer\">BerkeleyDB binding</a> returns a <code>IO (Maybe ByteString)</code> - the GC problem doesn't arise because the <code>ByteString</code> is the result of the query. I'm a bit puzzled right now. I guess I'm hitting the friction point between OO and FP. Or maybe I'm looking at this completely in the wrong way.</p>\n\n<p><strong>Update 1</strong></p>\n\n<p>As @Alec points out, the GC problems can be alleviated (solved?) by using the <a href=\"http://hackage.haskell.org/package/base-4.11.1.0/docs/Foreign-ForeignPtr.html#v:touchForeignPtr\" rel=\"nofollow noreferrer\"><code>touchForeignPtr</code></a>. I still have a strong inclination to take this out of the IO monad, though, towards a cleaner interface.</p>\n"}, {"tags": ["c", "ldap", "openldap", "ldif"], "comments": [{"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1527064239, "post_id": 50481527, "comment_id": 87979929, "body": "Why? <code>ldapmodify</code> already exists."}], "answers": [{"comments": [{"owner": {"reputation": 455, "user_id": 4899025, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YGgvb.jpg?s=128&g=1", "display_name": "Ajith C Narayanan", "link": "https://stackoverflow.com/users/4899025/ajith-c-narayanan"}, "edited": false, "score": 0, "creation_date": 1527489547, "post_id": 50485300, "comment_id": 88131385, "body": "This is ok. But my question is about adding attributes to an existing objectclass (AUX) dynamically using openLDAP library for C programming language. we can bind to LDAP server by using API ldap_bind() , search a directory entry using ldap_search() API, is there any similar API available to add an attribute to an objectclass. I don&#39;t want to add it using some LDIF file or from the terminal using some commands but I need to know is there any API for this available or not? Hope you are clear. Thanks"}], "tags": [], "owner": {"reputation": 9067, "user_id": 88122, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/U0pg3.png?s=128&g=1", "display_name": "jwilleke", "link": "https://stackoverflow.com/users/88122/jwilleke"}, "is_accepted": true, "score": 2, "last_activity_date": 1527529138, "last_edit_date": 1527529138, "creation_date": 1527069523, "answer_id": 50485300, "question_id": 50481527, "link": "https://stackoverflow.com/questions/50481527/how-to-programmatically-modify-an-existing-open-ldap-objectclass-using-openldap/50485300#50485300", "title": "How to Programmatically modify an existing Open LDAP objectclass using openLDAP library APIs for C language?", "body": "<p>The best practice would be to add an Auxiliary ObjectClass with no REQUIRED attributes and adding \"MAY\" attributes as needed.</p>\n\n<p>After adding the AUX class to the Schema, then you can add, though a modify operation the AUX Class to any Structural ObjectClass entry as a ObjectClass value as desired.</p>\n\n<p>This allows you to maintain the base schema intact.</p>\n\n<p>-jim</p>\n"}, {"tags": [], "owner": {"reputation": 1045, "user_id": 10088178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6dc359c8559182976bca35e8db73cd6?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Str&#246;der", "link": "https://stackoverflow.com/users/10088178/michael-str%c3%b6der"}, "is_accepted": false, "score": 1, "last_activity_date": 1533050361, "last_edit_date": 1592644375, "creation_date": 1533050361, "answer_id": 51616814, "question_id": 50481527, "link": "https://stackoverflow.com/questions/50481527/how-to-programmatically-modify-an-existing-open-ldap-objectclass-using-openldap/51616814#51616814", "title": "How to Programmatically modify an existing Open LDAP objectclass using openLDAP library APIs for C language?", "body": "<p>Not what you've asked for. But it's important so others do not naively copy&amp;paste this:</p>\n<blockquote>\n<p>attributetype ( 2.5.4.*</p>\n<p>[..]</p>\n<p>objectclass ( 2.5.4.4 NAME 'user'</p>\n</blockquote>\n<p>You're abusing OIDs already assigned to other schema descriptions. This is broken. You will not be able to load any data with that.</p>\n<p>With OpenLDAP's dynamic configuration you can add/modify schema on the fly if you follow the rules in <a href=\"https://tools.ietf.org/html/rfc4512\" rel=\"nofollow noreferrer\">RFC 4512</a> for defining attribute types and object classes.</p>\n<p>See also: <a href=\"https://www.openldap.org/doc/admin24/slapdconf2.html#cn=schema\" rel=\"nofollow noreferrer\">cn=schema</a></p>\n<p>Note that removing schema descriptions in case there's already existing data using it is a no-no.</p>\n"}, {"comments": [{"owner": {"reputation": 560, "user_id": 10850601, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-3R2h7RDJ9yU/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcYNkQa9HPTd778Jo28o4mlsEFPJpw/mo/photo.jpg?sz=128", "display_name": "Ed Grimm", "link": "https://stackoverflow.com/users/10850601/ed-grimm"}, "edited": false, "score": 0, "creation_date": 1547601287, "post_id": 54209108, "comment_id": 95244595, "body": "Note: changing the standard schema is bad for more reasons than I gave.  I just chose to give only the reason I felt is likely to have purchase with the OP, based on other developers I&#39;ve talked to who suggested making changes to standard objectclasses."}], "tags": [], "owner": {"reputation": 560, "user_id": 10850601, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-3R2h7RDJ9yU/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcYNkQa9HPTd778Jo28o4mlsEFPJpw/mo/photo.jpg?sz=128", "display_name": "Ed Grimm", "link": "https://stackoverflow.com/users/10850601/ed-grimm"}, "is_accepted": false, "score": 1, "last_activity_date": 1547601175, "creation_date": 1547601175, "answer_id": 54209108, "question_id": 50481527, "link": "https://stackoverflow.com/questions/50481527/how-to-programmatically-modify-an-existing-open-ldap-objectclass-using-openldap/54209108#54209108", "title": "How to Programmatically modify an existing Open LDAP objectclass using openLDAP library APIs for C language?", "body": "<p>The LDAP standards are written for schema to be Write Once Read Many data - once you set something, you can't unset it.  As a result, many LDAP servers are very resistant to changing their schema elements like you're talking about.</p>\n\n<p>Of course, for many of us, that attitude is an academic luxury we can't afford, so we <em>do</em> make changes to our schema, despite how much it horrifies our LDAP vendors.</p>\n\n<p>However, we change <strong>our</strong> schema, not the standard schema.  Changing standard objectclasses is a no-no, because whatever changes you make to the default standard will go away without warning sometimes when you update your LDAP server software.  And even when restricting yourself to editing objectclasses that are yours to edit, you will still probably have to update the schema files directly and then have the ldap server load the new files, rather than just asking it nicely to update its schema elements.</p>\n\n<p>Of course, different LDAP servers have different levels of orneriness on this.  For example back when we used iPlanet LDAP, if I recall correctly, it would let us do a delete &amp; add of an objectclass that wasn't in use, and make changes to it like that.  (Don't use iPlanet LDAP; it was the product of a joint venture that fell apart over 15 years ago.)</p>\n"}], "owner": {"reputation": 455, "user_id": 4899025, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YGgvb.jpg?s=128&g=1", "display_name": "Ajith C Narayanan", "link": "https://stackoverflow.com/users/4899025/ajith-c-narayanan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 693, "favorite_count": 0, "accepted_answer_id": 50485300, "answer_count": 3, "score": 0, "last_activity_date": 1547601175, "creation_date": 1527057969, "question_id": 50481527, "link": "https://stackoverflow.com/questions/50481527/how-to-programmatically-modify-an-existing-open-ldap-objectclass-using-openldap", "title": "How to Programmatically modify an existing Open LDAP objectclass using openLDAP library APIs for C language?", "body": "<p>I am writing an Identity and Access Management application in C programming language. So I use openLDAP for persisting user details and it provides a set of APIs to perform operations such as bind, add, search, modify etc. I created a new object class to hold my Application's user details as bellow,</p>\n\n<pre><code>attributetype ( 2.5.4.1 NAME 'id'\n    DESC 'RFC2256: user identifier'\n    EQUALITY caseIgnoreMatch\n    SUBSTR caseIgnoreSubstringsMatch\n    SYNTAX 1.3.6.1.4.1.1466.115.121.1.15{32768} )\n\nattributetype ( 2.5.4.2 NAME 'name'\n    DESC 'RFC2256: user name'\n    EQUALITY caseIgnoreMatch\n    SUBSTR caseIgnoreSubstringsMatch\n    SYNTAX 1.3.6.1.4.1.1466.115.121.1.15{32768} )\n\nattributetype ( 2.5.4.3 NAME 'email'\n    DESC 'RFC2256: user mail address'\n    EQUALITY caseIgnoreMatch\n    SUBSTR caseIgnoreSubstringsMatch\n    SYNTAX 1.3.6.1.4.1.1466.115.121.1.15{32768} )\n\n\nobjectclass ( 2.5.4.4 NAME 'user'\n    DESC 'user details'\n    SUP top STRUCTURAL\n    MUST id\n    MAY ( name $ email ) )\n</code></pre>\n\n<p>Is it possible to add a new attribute 'phoneNumber' to the 'user' object class without directly editing schema file but by using APIs provided by openLDAP library?</p>\n"}, {"tags": ["c", "struct"], "comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 3, "creation_date": 1527057940, "post_id": 50481464, "comment_id": 87976087, "body": "The problem is that your sample doesn&#39;t make any use of <code>.</code> or <code>-&gt;</code>. Please show a small program that reproduces the exact error. It should be a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1527058057, "post_id": 50481464, "comment_id": 87976142, "body": "Please link to the descriptions by the peopole with the same problem. Maybe they provide more details."}, {"owner": {"reputation": 83, "user_id": 9827552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ff9bd97300eb501d01185d4ecc1b868?s=128&d=identicon&r=PG&f=1", "display_name": "serc", "link": "https://stackoverflow.com/users/9827552/serc"}, "edited": false, "score": 0, "creation_date": 1527058346, "post_id": 50481464, "comment_id": 87976299, "body": "sry forgot the makro, now better?"}, {"owner": {"reputation": 83, "user_id": 9827552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ff9bd97300eb501d01185d4ecc1b868?s=128&d=identicon&r=PG&f=1", "display_name": "serc", "link": "https://stackoverflow.com/users/9827552/serc"}, "edited": false, "score": 0, "creation_date": 1527058421, "post_id": 50481464, "comment_id": 87976342, "body": "<a href=\"https://stackoverflow.com/questions/14256739/what-is-the-cause-of-this-error-structure-required-on-left-side-of-or\" title=\"what is the cause of this error structure required on left side of or\">stackoverflow.com/questions/14256739/&hellip;</a>    Yunnosch, but dont understand what he mean :/"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1527058518, "post_id": 50481464, "comment_id": 87976398, "body": "You don&#39;t use the macro <code>set_val</code> in the code you show, unless <code>function</code> is really spelled <code>set_val</code>.  Please create an MCVE (<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>) as already requested \u2014 and show the exact error message with line numbers that match the code shown in the question.  It should only be about 10 or so lines long \u2014 it won&#39;t be big."}, {"owner": {"reputation": 83, "user_id": 9827552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ff9bd97300eb501d01185d4ecc1b868?s=128&d=identicon&r=PG&f=1", "display_name": "serc", "link": "https://stackoverflow.com/users/9827552/serc"}, "edited": false, "score": 0, "creation_date": 1527058671, "post_id": 50481464, "comment_id": 87976485, "body": "okay I will and ty!"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1527065244, "post_id": 50481464, "comment_id": 87980586, "body": "Don&#39;t use macros for this. Is <code>set_val(xyz, val)</code> really more readable than <code>xyz.y = val</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 83, "user_id": 9827552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ff9bd97300eb501d01185d4ecc1b868?s=128&d=identicon&r=PG&f=1", "display_name": "serc", "link": "https://stackoverflow.com/users/9827552/serc"}, "edited": false, "score": 1, "creation_date": 1527060408, "post_id": 50481796, "comment_id": 87977469, "body": "If my answer was helpful, click the \u201caccept\u201d tick mark under the score for my answer in the left margin.  That shows that a satisfactory solution has been provided."}], "tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": true, "score": 7, "last_activity_date": 1527059502, "last_edit_date": 1527059502, "creation_date": 1527058810, "answer_id": 50481796, "question_id": 50481464, "link": "https://stackoverflow.com/questions/50481464/c-is-not-struct-or-union/50481796#50481796", "title": "C - is not struct or union", "body": "<p>The compiler message isn't great \u2014 it is combining multiple errors into a single message.  Your macro invocation creates the text:</p>\n\n<pre><code>((xyz)-&gt;y= (val));\n</code></pre>\n\n<p>The trouble is, <code>xyz</code> is a structure, and therefore you access members using <code>xyz.y</code> and not <code>xyz-&gt;y</code>.  You could invoke:</p>\n\n<pre><code>set_val(&amp;xyz, val);\n</code></pre>\n\n<p>and that would work OK; you pass a pointer and then dereference using the pointer notation.  Or you could rewrite the macro as:</p>\n\n<pre><code>#define set_val(xyz, val) ((xyz).y = (val))\n</code></pre>\n\n<hr>\n\n<p>Note that the macro argument names <code>xyz</code> and <code>val</code> are only coincidentally the same as the arguments passed.  I could write the macro as:</p>\n\n<pre><code>#define set_val(s, value) ((s).y = (value))\n</code></pre>\n\n<p>or</p>\n\n<pre><code>#define set_val(p, value) ((p)-&gt;y = (value))\n</code></pre>\n\n<p>(depending on which version you want to keep) and it would work the same way.  The reusing of the same names could be adding to your confusion, though.</p>\n\n<p>It might also be a good time to note that macros such as this are not necessarily a good idea because they can lead to confusion.  You might do better with an inline function:</p>\n\n<pre><code>static inline void set_val(v1 *p, u32_t val) { p-&gt;y = val; }\n</code></pre>\n\n<p>Now at least you'll get a better error message if you call it the wrong way.  Of course, the function must take a pointer to the structure \u2014 the function semantics still apply even to inline functions.  It is still debatable whether the function is a benefit, but the type safety the function signature imposes is a big help.</p>\n"}], "owner": {"reputation": 83, "user_id": 9827552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ff9bd97300eb501d01185d4ecc1b868?s=128&d=identicon&r=PG&f=1", "display_name": "serc", "link": "https://stackoverflow.com/users/9827552/serc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 444, "favorite_count": 0, "accepted_answer_id": 50481796, "answer_count": 1, "score": 0, "last_activity_date": 1527059502, "creation_date": 1527057761, "last_edit_date": 1527058617, "question_id": 50481464, "link": "https://stackoverflow.com/questions/50481464/c-is-not-struct-or-union", "title": "C - is not struct or union", "body": "<p>The following code gives me a compiler error: <code>left side of '.' or '-&gt;' is not struct or union</code>.</p>\n\n<p>Sample code:</p>\n\n<pre><code>struct x {\n    u32_t y;\n};\ntypedef struct x v1;\n\nv1 xyz;\nset_val(xyz, val); \n</code></pre>\n\n<p>Here I get the problem that <code>xyz</code> is not an struct or union, but it is a struct or not?</p>\n\n<pre><code>#define set_val(xyz, val) ((xyz)-&gt;y=  (val))\n</code></pre>\n\n<p>I've searched for this and found some people with the same problem, but don't understand how to fix it.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 3, "creation_date": 1527057168, "post_id": 50481263, "comment_id": 87975661, "body": "It is just a naming convention. Call this function on some event, like <code>on_load</code>, <code>on_entry</code>, <code>on_exit</code>. There is nothing special about these functions."}, {"owner": {"reputation": 29, "user_id": 7625313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e0780789d8d156e06e0fbae28de3b55?s=128&d=identicon&r=PG&f=1", "display_name": "bijian", "link": "https://stackoverflow.com/users/7625313/bijian"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1527058837, "post_id": 50481263, "comment_id": 87976579, "body": "it confused me for a long time. Thx."}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 7625313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e0780789d8d156e06e0fbae28de3b55?s=128&d=identicon&r=PG&f=1", "display_name": "bijian", "link": "https://stackoverflow.com/users/7625313/bijian"}, "edited": false, "score": 0, "creation_date": 1527058654, "post_id": 50481330, "comment_id": 87976476, "body": "Get it, your link is very clear.Are there any other similar naming conventions?"}, {"owner": {"reputation": 11041, "user_id": 1326913, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/7ec6f3b4e7f3399ff8564b3538aee5e8?s=128&d=identicon&r=PG", "display_name": "\u1d07\u029f\u1d07v\u1d00\u0442\u1d07", "link": "https://stackoverflow.com/users/1326913/%e1%b4%87%ca%9f%e1%b4%87v%e1%b4%80%d1%82%e1%b4%87"}, "reply_to_user": {"reputation": 29, "user_id": 7625313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e0780789d8d156e06e0fbae28de3b55?s=128&d=identicon&r=PG&f=1", "display_name": "bijian", "link": "https://stackoverflow.com/users/7625313/bijian"}, "edited": false, "score": 0, "creation_date": 1527059132, "post_id": 50481330, "comment_id": 87976728, "body": "Vary from language to language. Examples in Java, <code>emit</code> (e.g. <code>emitSomeEvent</code>). <code>add</code> and <code>remove</code> (e.g. to add an item or a handler). <code>get</code> and <code>set</code> (to set a property), <code>is</code> for a boolean property."}, {"owner": {"reputation": 29, "user_id": 7625313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e0780789d8d156e06e0fbae28de3b55?s=128&d=identicon&r=PG&f=1", "display_name": "bijian", "link": "https://stackoverflow.com/users/7625313/bijian"}, "edited": false, "score": 0, "creation_date": 1527059387, "post_id": 50481330, "comment_id": 87976873, "body": "so what does &quot;emit&quot; means here?"}, {"owner": {"reputation": 11041, "user_id": 1326913, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/7ec6f3b4e7f3399ff8564b3538aee5e8?s=128&d=identicon&r=PG", "display_name": "\u1d07\u029f\u1d07v\u1d00\u0442\u1d07", "link": "https://stackoverflow.com/users/1326913/%e1%b4%87%ca%9f%e1%b4%87v%e1%b4%80%d1%82%e1%b4%87"}, "reply_to_user": {"reputation": 29, "user_id": 7625313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e0780789d8d156e06e0fbae28de3b55?s=128&d=identicon&r=PG&f=1", "display_name": "bijian", "link": "https://stackoverflow.com/users/7625313/bijian"}, "edited": false, "score": 0, "creation_date": 1527059532, "post_id": 50481330, "comment_id": 87976952, "body": "<code>emit</code> is the initiator of <code>on</code>. That is, the function that will call the <code>on</code> methods of all the registered listeners will be called <code>emit</code>."}, {"owner": {"reputation": 29, "user_id": 7625313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e0780789d8d156e06e0fbae28de3b55?s=128&d=identicon&r=PG&f=1", "display_name": "bijian", "link": "https://stackoverflow.com/users/7625313/bijian"}, "edited": false, "score": 0, "creation_date": 1527060017, "post_id": 50481330, "comment_id": 87977206, "body": "I think the verb  like add or remove is easier to understand than preposition. Thanks for your answer."}, {"owner": {"reputation": 11041, "user_id": 1326913, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/7ec6f3b4e7f3399ff8564b3538aee5e8?s=128&d=identicon&r=PG", "display_name": "\u1d07\u029f\u1d07v\u1d00\u0442\u1d07", "link": "https://stackoverflow.com/users/1326913/%e1%b4%87%ca%9f%e1%b4%87v%e1%b4%80%d1%82%e1%b4%87"}, "reply_to_user": {"reputation": 29, "user_id": 7625313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e0780789d8d156e06e0fbae28de3b55?s=128&d=identicon&r=PG&f=1", "display_name": "bijian", "link": "https://stackoverflow.com/users/7625313/bijian"}, "edited": false, "score": 0, "creation_date": 1527060231, "post_id": 50481330, "comment_id": 87977340, "body": "I guess in this case it&#39;s hard to come up with a useful verb because the event emitter shouldn&#39;t know or care what you want to do with the event. I suppose <code>handle</code> could be used but that word is longer and has other meanings."}], "tags": [], "owner": {"reputation": 11041, "user_id": 1326913, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/7ec6f3b4e7f3399ff8564b3538aee5e8?s=128&d=identicon&r=PG", "display_name": "\u1d07\u029f\u1d07v\u1d00\u0442\u1d07", "link": "https://stackoverflow.com/users/1326913/%e1%b4%87%ca%9f%e1%b4%87v%e1%b4%80%d1%82%e1%b4%87"}, "is_accepted": false, "score": 1, "last_activity_date": 1527057252, "creation_date": 1527057252, "answer_id": 50481330, "question_id": 50481263, "link": "https://stackoverflow.com/questions/50481263/what-does-the-word-on-prefix-mean-in-program/50481330#50481330", "title": "what does the word &quot;on&quot; prefix mean in program", "body": "<p>It's not an abbreviation. The word \"on\" is a naming convention to indicate that the function is called when an event occurs. E.g. \"onKeyPress\" means this function is called when a key is pressed.</p>\n\n<p>Possible duplicate: <a href=\"https://softwareengineering.stackexchange.com/questions/299101/what-does-the-prefix-on-in-a-function-e-g-onbuttonpressed-mean\">What does the prefix \u201con\u201d in a function (e.g.\u201conButtonPressed\u201d) mean?</a></p>\n"}, {"comments": [{"owner": {"reputation": 29, "user_id": 7625313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e0780789d8d156e06e0fbae28de3b55?s=128&d=identicon&r=PG&f=1", "display_name": "bijian", "link": "https://stackoverflow.com/users/7625313/bijian"}, "edited": false, "score": 0, "creation_date": 1527058433, "post_id": 50481350, "comment_id": 87976350, "body": "Yes,it&#39;s very confusing for me.You are so smart.Thank you for understanding me.I think I should learn more English culture and background knowledge.So are there  any other similar usage just like word &quot;on&quot;?"}, {"owner": {"reputation": 1253974, "user_id": 22656, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/6d8ebb117e8d83d74ea95fbdd0f87e13?s=128&d=identicon&r=PG", "display_name": "Jon Skeet", "link": "https://stackoverflow.com/users/22656/jon-skeet"}, "reply_to_user": {"reputation": 29, "user_id": 7625313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e0780789d8d156e06e0fbae28de3b55?s=128&d=identicon&r=PG&f=1", "display_name": "bijian", "link": "https://stackoverflow.com/users/7625313/bijian"}, "edited": false, "score": 0, "creation_date": 1527062165, "post_id": 50481350, "comment_id": 87978622, "body": "@user7625313: I&#39;m not sure what you mean by &quot;other similar usage just like word on&quot; - there are lots of naming conventions, some of which are common across programming languages and some of which aren&#39;t."}], "tags": [], "owner": {"reputation": 1253974, "user_id": 22656, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/6d8ebb117e8d83d74ea95fbdd0f87e13?s=128&d=identicon&r=PG", "display_name": "Jon Skeet", "link": "https://stackoverflow.com/users/22656/jon-skeet"}, "is_accepted": false, "score": 1, "last_activity_date": 1527057328, "creation_date": 1527057328, "answer_id": 50481350, "question_id": 50481263, "link": "https://stackoverflow.com/questions/50481263/what-does-the-word-on-prefix-mean-in-program/50481350#50481350", "title": "what does the word &quot;on&quot; prefix mean in program", "body": "<p>It means \"when this thing happens\". It's a <em>reasonably</em> common usage in English, but I can see how it would be confusing for developers who don't have English as a first language.</p>\n\n<p>As an example outside computing, you might say, \"<strong>On entry</strong> to a country, you must present your passport\" or equivalently \"You must present your passport <strong>on entry</strong> to a country.\"</p>\n"}], "owner": {"reputation": 29, "user_id": 7625313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e0780789d8d156e06e0fbae28de3b55?s=128&d=identicon&r=PG&f=1", "display_name": "bijian", "link": "https://stackoverflow.com/users/7625313/bijian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1527057328, "creation_date": 1527057050, "question_id": 50481263, "link": "https://stackoverflow.com/questions/50481263/what-does-the-word-on-prefix-mean-in-program", "title": "what does the word &quot;on&quot; prefix mean in program", "body": "<p>When I read some program write with C language, I find some function name have the word \"on\" as a prefix, such as on_something(). So what does the word \"on\" stand for? If you can tell me some links or books about this,it will be better. Thanks a lot.</p>\n"}, {"tags": ["c", "gcc", "assembly", "x86-64"], "comments": [{"owner": {"reputation": 3596, "user_id": 1753435, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b81cf3b8c8432e0bcac7322120a09b56?s=128&d=identicon&r=PG", "display_name": "andreee", "link": "https://stackoverflow.com/users/1753435/andreee"}, "edited": false, "score": 1, "creation_date": 1527056427, "post_id": 50480895, "comment_id": 87975284, "body": "Related: <a href=\"https://stackoverflow.com/questions/8333413/why-cant-you-set-the-instruction-pointer-directly\">You cannot access the instruction pointer directly</a>. What is it that you want to achieve? Why do you need access to RIP? See the linked questions for alternative ways of accessing RIP."}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1527070071, "post_id": 50480895, "comment_id": 87983977, "body": "<code>rip</code> is not a general purpose register and there is no dedicated <code>push rip</code> instruction either."}, {"owner": {"reputation": 85822, "user_id": 597607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jCzJi.png?s=128&g=1", "display_name": "Bo Persson", "link": "https://stackoverflow.com/users/597607/bo-persson"}, "edited": false, "score": 0, "creation_date": 1527070729, "post_id": 50480895, "comment_id": 87984432, "body": "You generally get the equivalent of <code>push rip</code> as part of a <code>call</code> instruction. When you enter a function, the <code>rip</code> of the caller is already saved on the stack,"}], "answers": [{"comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1527075096, "post_id": 50481117, "comment_id": 87987262, "body": "<code>call rel32</code> with a rel32=0 is the same thing as <code>push rip</code>.  It turns out that CPUs more recent than PPro special-case it, so it might be more efficient than lea/push."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1527075213, "post_id": 50481117, "comment_id": 87987344, "body": "@PeterCordes I had written that before. Edited it out because wasn&#39;t sure and according to my understand will also mess with return prediction. But anyway some kind of context switch is happening here. Should be okay I guess"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1527075478, "post_id": 50481117, "comment_id": 87987508, "body": "@PeterCordes can you check if the instruction I have added now is correct? I am a bit unsure."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1527076082, "post_id": 50481117, "comment_id": 87987904, "body": "@PeterCordes does <code>callq *(%rip)</code> do an indirect call?"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1527076974, "post_id": 50481117, "comment_id": 87988548, "body": "Yes, that&#39;s what the <code>*</code> means.  It assembles to <code>ff 15 00 00 00 00       call   QWORD PTR [rip+0x0]</code>.  Without the <code>*</code>, <code>call (%rip)</code> just warns <code>indirect call without &#39;*&#39;</code>.  I&#39;m not sure of any &quot;clean&quot; way to encode <code>call +0</code> without a label or hard-coding the instruction length.  Of course you can encode it manually with <code>.byte 0xe8, 0,0,0,0</code>."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1527077229, "post_id": 50481117, "comment_id": 87988737, "body": "@PeterCordes and <code>call *%rip</code> also does not assemble. I think local labels are the &quot;nicest&quot; option."}], "tags": [], "owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "is_accepted": false, "score": 5, "last_activity_date": 1527075717, "last_edit_date": 1527075717, "creation_date": 1527056413, "answer_id": 50481117, "question_id": 50480895, "link": "https://stackoverflow.com/questions/50480895/operand-type-mismatch-for-push/50481117#50481117", "title": "Operand type mismatch for `push&#39;", "body": "<p>With <code>X86_64</code> you cannot push the <code>%rip</code>, in fact you cannot access it directly at all. </p>\n\n<p>If you still need to do it, you can do </p>\n\n<pre><code>leaq 0(%rip), %rax # Or any other GPR that is free\npushq %rax \n</code></pre>\n\n<p>OR</p>\n\n<pre><code>callq . + 5          # no label, hard-code instruction length\n# or\ncallq 1f ;  1:       # with a local numbered label\n</code></pre>\n\n<p>Although I am not sure <strong>why</strong> you would want to stash the <code>%rip</code>, if you restore it from here, the execution will continue from the push instruction. Is there any value to that? You need to rethink your thread switching logic. </p>\n"}, {"tags": [], "owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "is_accepted": false, "score": 1, "last_activity_date": 1527075007, "creation_date": 1527075007, "answer_id": 50487284, "question_id": 50480895, "link": "https://stackoverflow.com/questions/50480895/operand-type-mismatch-for-push/50487284#50487284", "title": "Operand type mismatch for `push&#39;", "body": "<p>To push RIP, simply execute <a href=\"http://felixcloutier.com/x86/CALL.html\" rel=\"nofollow noreferrer\"><code>call</code></a> with a zero displacement.</p>\n\n<pre><code>call next_insn\nnext_insn:\n</code></pre>\n\n<p>So the jump part of <code>call</code> is a no-op, so you just get the effect of pushing a return address (i.e. the current RIP).</p>\n\n<p>Fun fact: <a href=\"http://blog.stuffedcow.net/2018/04/ras-microbenchmarks/#call0\" rel=\"nofollow noreferrer\"><code>call rel32=0</code> is a special case and doesn't unbalance the return address predictor stack</a> on CPUs more recent than PPro.  So <code>call next_insn / pop eax</code> is useful in 32-bit mode as an equivalent to <code>lea (%rip), %rax</code>.</p>\n\n<p>It's still a branch instruction, and still decodes to multiple uops (unlike a <code>push</code> of a GPR which is 1 micro-fused uop), so <code>lea (%rip), %rax</code> ; <code>push %rax</code> may be more efficient.</p>\n"}], "owner": {"reputation": 3080, "user_id": 2375119, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/oB60l.png?s=128&g=1", "display_name": "ArekBulski", "link": "https://stackoverflow.com/users/2375119/arekbulski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1936, "favorite_count": 0, "closed_date": 1527075771, "answer_count": 2, "score": 0, "last_activity_date": 1527075717, "creation_date": 1527055458, "last_edit_date": 1527073587, "question_id": 50480895, "link": "https://stackoverflow.com/questions/50480895/operand-type-mismatch-for-push", "closed_reason": "Duplicate", "title": "Operand type mismatch for `push&#39;", "body": "<p>I need help with C code that uses ASSEMBLY parts. GCC has a problem compiling the assembly, error:</p>\n\n<pre><code>$ make\ngcc -Wall -g -std=c99 -pedantic   -c -o sthread.o sthread.c\nsthread.c: In function \u2018sthread_create\u2019:\nsthread.c:159:57: warning: pointer of type \u2018void *\u2019 used in arithmetic [-Wpointer-arith]\n     t-&gt;context = __sthread_initialize_context(t-&gt;memory + DEFAULT_STACKSIZE, f, arg);\n                                                         ^\ngcc -Wall -g -std=c99 -pedantic   -c -o queue.o queue.c\nas -g  -o glue.o glue.s\nglue.s: Assembler messages:\nglue.s:32: Error: operand type mismatch for `push'\n&lt;wbudowane&gt;: polecenia dla obiektu 'glue.o' nie powiod\u0142y si\u0119\nmake: *** [glue.o] B\u0142\u0105d 1\n</code></pre>\n\n<p>Code in question:</p>\n\n<pre><code>__sthread_switch:\n    # preserve CPU state on the stack, with exception of stack pointer, instruction pointer first, reverse order\n    pushq %rip  #line 32\n    pushf\n    pushq %rdi\n    pushq %rsi\n    pushq %rbp\n    pushq %rbx\n    pushq %rdx\n    pushq %rcx\n    pushq %rax\n\n    # Call the high-level scheduler with the current context as an argument\n    movq    %rsp, %rdi\n    movq    scheduler_context, %rsp\n    call    __sthread_scheduler\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1527053349, "post_id": 50480423, "comment_id": 87974082, "body": "Global variables are initialized to 0. All you need to do is declare your variable."}, {"owner": {"reputation": 271, "user_id": 9353451, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4089968caf5bda29a44448b5608bed91?s=128&d=identicon&r=PG&f=1", "display_name": "Lakshraj", "link": "https://stackoverflow.com/users/9353451/lakshraj"}, "edited": false, "score": 0, "creation_date": 1527053374, "post_id": 50480423, "comment_id": 87974090, "body": "the list is inside the function?"}, {"owner": {"reputation": 432, "user_id": 8068536, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1eafb1d91ea01feb319f8f969058056d?s=128&d=identicon&r=PG&f=1", "display_name": "david_10001", "link": "https://stackoverflow.com/users/8068536/david-10001"}, "edited": false, "score": 0, "creation_date": 1527053473, "post_id": 50480423, "comment_id": 87974124, "body": "Sorry, I used 0 as a bad example. I&#39;ve changed it to 1."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1527053636, "post_id": 50480423, "comment_id": 87974167, "body": "Then you need to put the loop inside a function, e.g. at the top of <code>main</code>, or in a separate function that&#39;s called at the top of <code>main</code>. The declaration can still go outside: <code>int counter[sizeof(list)&#47;sizeof(list[0])];</code>"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1527053653, "post_id": 50480423, "comment_id": 87974175, "body": "Please show examples of how you intend to use the counters. You are going to implement many pieces of code, each of which use one of the counters differently? <code>counter[A]++</code>? <code>counterB++</code>? <code>counter[&#39;A&#39;]++</code>? <code>C++</code>? <code>x=&#39;D&#39;; counter[x]++</code>?"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1527053993, "post_id": 50480423, "comment_id": 87974280, "body": "Please explain more about <code>list</code>, the array of strings, and its meaning for your purpose? How is the list of words related to what you intend to do?"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1527054096, "post_id": 50480423, "comment_id": 87974314, "body": "Do you want those many global counters to be initialised with equally many explicit initialiation values? Or do you want to initialise all of them programatically, all of them with the same init value?"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1527054221, "post_id": 50480423, "comment_id": 87974360, "body": "Can you comapre what you want to achieve to constructs from other programming languages? E.g. &quot;map&quot;, perls &quot;hash&quot;... ?"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1527054732, "post_id": 50480423, "comment_id": 87974524, "body": "Is the list of strings going to be as systematically predictable as in your example? E.g. will the next be &quot;D&quot;? Or could there be &quot;Z&quot;, &quot;M&quot;, &quot;Peter&quot;, &quot;John Skeet&quot;, &quot;*+-&amp;&quot;?"}], "answers": [{"tags": [], "owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "is_accepted": false, "score": 3, "last_activity_date": 1527053968, "last_edit_date": 1527053968, "creation_date": 1527053375, "answer_id": 50480450, "question_id": 50480423, "link": "https://stackoverflow.com/questions/50480423/how-to-create-multiple-global-variables-using-a-for-loop-outside-of-a-function/50480450#50480450", "title": "How to create multiple global variables using a for loop outside of a function?", "body": "<p>C has no facility to run such initialization code outside of functions. And since initializers to static variables at file scope need to be constant expressions, you have two options:</p>\n\n<ol>\n<li><p>Create a script in your scripting language of choice that generates an initializer macro of the right size, for you to use as an initializer to the array. For instance, the script can read this file:</p>\n\n<pre><code>#include \"my_init_list.h\"\nchar* list[] = {\"A\", \"B\", \"C\", /* However many more */};\nint counter[] = COUNTERS_INITIALIZER;\n</code></pre>\n\n<p>It would parse the initializer for <code>list</code>, and output the file <code>my_init_list.h</code> which would contain the macro <code>COUNTERS_INITIALIZER</code> that is expanded to <code>{1, 1, ..., 1}</code>. If you run the script as a step in your build process, that should do it.</p></li>\n<li><p>Put the initialization code into a function, and rig your function to run once early in your program's startup code (what <code>main</code> executes when it starts running).</p></li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 1, "creation_date": 1527055734, "post_id": 50480495, "comment_id": 87974962, "body": "<code>sizeof(list)&#47;sizeof(*list)</code> is a constant expression and can be used as size for <code>counter</code> as <code>int counter[sizeof(list)&#47;sizeof(*list)];</code>"}], "tags": [], "owner": {"reputation": 4598, "user_id": 9264702, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mHczh.jpg?s=128&g=1", "display_name": "Stephen Docy", "link": "https://stackoverflow.com/users/9264702/stephen-docy"}, "is_accepted": true, "score": 4, "last_activity_date": 1527055557, "last_edit_date": 1527055557, "creation_date": 1527053593, "answer_id": 50480495, "question_id": 50480423, "link": "https://stackoverflow.com/questions/50480423/how-to-create-multiple-global-variables-using-a-for-loop-outside-of-a-function/50480495#50480495", "title": "How to create multiple global variables using a for loop outside of a function?", "body": "<p>is this what you are after?</p>\n\n<pre><code>char* list[] = {\"A\", \"B\", \"C\"};\nint counter[] = {1, 1, 1};\n</code></pre>\n\n<p>Just declare them both globally and initialize <code>counter</code> just like you initialize <code>list</code>.</p>\n\n<p>It is also possible to declare <code>counter</code> globally and then initialize it in <code>main()</code> or wherever with a <code>for</code> loop:</p>\n\n<pre><code>char* list[] = {\"A\", \"B\", \"C\"};\nint counter[3];\n\nint main(void) {\n    for (int i = 0; i &lt; sizeof(list) / sizeof(*list); i++) {\n        counter[i] = 1;\n    }\n}\n</code></pre>\n\n<p>or even better, figure out how much memory you need for <code>counter</code> based on the size of <code>list</code>:</p>\n\n<pre><code>char* list[] = {\"A\", \"B\", \"C\"};\nint *counter;\n\nint main(void) {\n    int numElements = sizeof(list) / sizeof(*list);\n\n    counter = malloc(numElements * sizeof(*counter));\n    // check for malloc() failure\n\n    for (int i = 0; i &lt; numElements; i++) {\n        counter[i] = 1;\n    }\n}\n</code></pre>\n\n<p>Notice that you can't simply use <code>sizeof(list)</code>...that will return how much memory <code>list</code> has allocated.  You need to divide <code>sizeof(list)</code> by the size of each element, <code>sizeof(*list)</code>, to get the number of elements</p>\n"}], "owner": {"reputation": 432, "user_id": 8068536, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1eafb1d91ea01feb319f8f969058056d?s=128&d=identicon&r=PG&f=1", "display_name": "david_10001", "link": "https://stackoverflow.com/users/8068536/david-10001"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 186, "favorite_count": 0, "closed_date": 1527055786, "accepted_answer_id": 50480495, "answer_count": 2, "score": 1, "last_activity_date": 1527058090, "creation_date": 1527053228, "last_edit_date": 1527058090, "question_id": 50480423, "link": "https://stackoverflow.com/questions/50480423/how-to-create-multiple-global-variables-using-a-for-loop-outside-of-a-function", "closed_reason": "Duplicate", "title": "How to create multiple global variables using a for loop outside of a function?", "body": "<p>I have a list and I want to create a global counter for each item in the list, with the initial value set to <code>1</code>. I thought I would do this with a <code>for</code> loop (my actual list is a lot bigger than the example below) however I just realized <code>for</code> loops don't work outside of a function. How can I get the below code to work?</p>\n\n<pre><code>char* list[] = {\"A\", \"B\", \"C\"};\n\nfor (int i = 0; i &lt; sizeof(list); i++){\n    int counter[i] = 1;\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "pointers", "casting", "type-conversion"], "comments": [{"owner": {"reputation": 27279, "user_id": 857132, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4fd51ed5980999c7c6ce3729d6cb2184?s=128&d=identicon&r=PG", "display_name": "John3136", "link": "https://stackoverflow.com/users/857132/john3136"}, "edited": false, "score": 1, "creation_date": 1527051744, "post_id": 50480121, "comment_id": 87973554, "body": "What am I missing? <code>uintptr_t ptr = (uintptr_t)x;</code> ?"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1527056337, "post_id": 50480121, "comment_id": 87975246, "body": "Related to <a href=\"https://stackoverflow.com/q/18545212/694576\">stackoverflow.com/q/18545212/694576</a> if not a duplicate."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1527079529, "post_id": 50480121, "comment_id": 87990375, "body": "@John3136n <code>(uintptr_t)x;</code> is missing a needed cast through <code>void*</code>."}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1527079137, "post_id": 50480182, "comment_id": 87990079, "body": "Detail: <code>x</code> is not a <code>void*</code> or like.  Cast to <code>(uintptr_t)</code> from <code>int*</code> is <i>not</i> so well defined.  6.3.2.3 3 Suggest <code>uintptr_t z = (uintptr_t)(void*)x;</code>  C11 7.20.1.4 1.  The &quot;if you cast z back to an int * you&#39;ll get the original pointer back.&quot; is almost consistent with the spec, Conversion needs to go through <code>void *</code> and one get an equivalent pointer, perhaps not the original."}], "tags": [], "owner": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "is_accepted": true, "score": 3, "last_activity_date": 1527051851, "creation_date": 1527051851, "answer_id": 50480182, "question_id": 50480121, "link": "https://stackoverflow.com/questions/50480121/get-the-hexadecimal-address-of-a-variable-as-uintptr-t/50480182#50480182", "title": "Get the hexadecimal address of a variable as uintptr_t", "body": "<p>It isn't particularly difficult... </p>\n\n<pre><code>uintptr_t z = (uintptr_t)x;\n</code></pre>\n\n<p>Notice that the result of this cast is implementation-defined; the only guarantee you have is that if you cast <code>z</code> back to an <code>int *</code> you'll get the original pointer back.</p>\n\n<p>By the way, there's no such a thing as a \"hexadecimal address\"; addresses are addresses, they can be seen as numbers in whatever base you like most, showing them in hexadecimal base is just a convention (which has some advantages). </p>\n"}, {"tags": [], "owner": {"reputation": 59, "user_id": 8487340, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc51fe61ebda41befdd8704d76458f9c?s=128&d=identicon&r=PG&f=1", "display_name": "Amal John", "link": "https://stackoverflow.com/users/8487340/amal-john"}, "is_accepted": false, "score": 0, "last_activity_date": 1527054734, "creation_date": 1527054734, "answer_id": 50480721, "question_id": 50480121, "link": "https://stackoverflow.com/questions/50480121/get-the-hexadecimal-address-of-a-variable-as-uintptr-t/50480721#50480721", "title": "Get the hexadecimal address of a variable as uintptr_t", "body": "<p>You can store the value by explicitly typecasting the adddress of x to uintptr_t.</p>\n\n<p><code>uintptr_t z = (uintptr_t)&amp;x;</code></p>\n"}], "owner": {"reputation": 57, "user_id": 6941772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1037ba85a96349fe6f8a4ec1f0fda7c5?s=128&d=identicon&r=PG&f=1", "display_name": "BODDU MANOHAR REDDY", "link": "https://stackoverflow.com/users/6941772/boddu-manohar-reddy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 340, "favorite_count": 0, "accepted_answer_id": 50480182, "answer_count": 2, "score": -1, "last_activity_date": 1527056379, "creation_date": 1527051560, "last_edit_date": 1527056379, "question_id": 50480121, "link": "https://stackoverflow.com/questions/50480121/get-the-hexadecimal-address-of-a-variable-as-uintptr-t", "title": "Get the hexadecimal address of a variable as uintptr_t", "body": "<pre><code>int y = 1;\nint *x = &amp;y;  \nprintf(\"%p\\n\",x); // instead of printing, get this into variable of type unintptr_t\n</code></pre>\n\n<p>I would like to get the address <code>x</code> into variable of type <code>uintptr_t</code></p>\n\n<p>Is there a way to do that in C?</p>\n"}, {"tags": ["c", "linux", "multithreading", "chmod", "umask"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1527048781, "post_id": 50479624, "comment_id": 87972787, "body": "Don&#39;t meddle with the umask. Instead just use <a href=\"http://man7.org/linux/man-pages/man2/open.2.html\" rel=\"nofollow noreferrer\"><code>open</code> or <code>creat</code></a> passing the permissions you want, and then let the system handle it with the users umask. If you later need a standard C <code>FILE*</code>, use <a href=\"http://man7.org/linux/man-pages/man3/fdopen.3p.html\" rel=\"nofollow noreferrer\"><code>fdopen</code></a>."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1527050471, "post_id": 50479624, "comment_id": 87973190, "body": "&quot;<i>if we use umask in a thread, does it affect files created in other threads?</i>&quot; From <a href=\"http://man7.org/linux/man-pages/man2/umask.2.html\" rel=\"nofollow noreferrer\">the docs</a>: &quot;<i><code>umask()</code> sets the calling process&#39;s file mode creation mask ...</i>&quot; So yes, it affects <b>all</b> threads of a process."}, {"owner": {"reputation": 137, "user_id": 4346150, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed52f6ba3084c5efb65ef6677f094678?s=128&d=identicon&r=PG&f=1", "display_name": "MSK", "link": "https://stackoverflow.com/users/4346150/msk"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1527084136, "post_id": 50479624, "comment_id": 87993671, "body": "@Someprogrammerdude: Can i create files with the required permissions, wont it masked by the umask bits?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1527152055, "post_id": 50479624, "comment_id": 88022108, "body": "The user might have set the umask for a reason. Don&#39;t meddle with it."}], "owner": {"reputation": 137, "user_id": 4346150, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed52f6ba3084c5efb65ef6677f094678?s=128&d=identicon&r=PG&f=1", "display_name": "MSK", "link": "https://stackoverflow.com/users/4346150/msk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 516, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1527048765, "creation_date": 1527048331, "question_id": 50479624, "link": "https://stackoverflow.com/questions/50479624/umask-or-chmod-in-multithreaded-application", "title": "umask OR chmod in multithreaded application", "body": "<p>Which of these is the best practice:</p>\n\n<ol>\n<li>Set umask and create files with appropriate file permissions\nOR</li>\n<li>Create files and then use chmod() to set appropriate file permissions</li>\n</ol>\n\n<p>if we use umask in a thread, does it affect files created in other threads?</p>\n\n<p>I know chmod affects only the file, but is likely to fail, if the files are created by a different user.</p>\n"}, {"tags": ["c", "data-structures", "doubly-linked-list"], "comments": [{"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 1, "creation_date": 1527047362, "post_id": 50479356, "comment_id": 87972503, "body": "Did you trying running a <a href=\"https://en.wikipedia.org/wiki/Debugger\" rel=\"nofollow noreferrer\">debugger</a> and stepping through it?"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1527050214, "post_id": 50479356, "comment_id": 87973122, "body": "Saving a <code>tail</code> pointer is a principal advantage of a doubly-linked list for the very purpose of allowing reverse iteration. In a non-circular list you will generally keep two pointers <code>head</code> and <code>tail</code> to the beginning and end nodes, respectively. In a <i>circular</i> list, <code>head-&gt;prev</code> points to the last node, and <code>head-&gt;prev-&gt;next</code> points to <code>head</code>."}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 9831976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7312fbacc40180ef1efdd05b3667b288?s=128&d=identicon&r=PG&f=1", "display_name": "vkygul", "link": "https://stackoverflow.com/users/9831976/vkygul"}, "edited": false, "score": 0, "creation_date": 1527047487, "post_id": 50479479, "comment_id": 87972524, "body": "oh ok. this exposed some other bugs within the block"}], "tags": [], "owner": {"reputation": 11455, "user_id": 10888, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/adbf81127c90a370ceab11b3087a8e4e?s=128&d=identicon&r=PG", "display_name": "Leonard", "link": "https://stackoverflow.com/users/10888/leonard"}, "is_accepted": true, "score": 1, "last_activity_date": 1527047107, "creation_date": 1527047107, "answer_id": 50479479, "question_id": 50479356, "link": "https://stackoverflow.com/questions/50479356/how-to-save-pointer-to-last-node/50479479#50479479", "title": "How to save pointer to last node", "body": "<p>In your else block else if (tmp->next == NULL) you have a line </p>\n\n<pre><code>temp-&gt;next-&gt;prev = prev;\n</code></pre>\n\n<p>This is invalid.  You're trying to use the null pointer.</p>\n"}], "owner": {"reputation": 5, "user_id": 9831976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7312fbacc40180ef1efdd05b3667b288?s=128&d=identicon&r=PG&f=1", "display_name": "vkygul", "link": "https://stackoverflow.com/users/9831976/vkygul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 0, "accepted_answer_id": 50479479, "answer_count": 1, "score": 0, "last_activity_date": 1527047107, "creation_date": 1527045967, "question_id": 50479356, "link": "https://stackoverflow.com/questions/50479356/how-to-save-pointer-to-last-node", "title": "How to save pointer to last node", "body": "<p>Here I have a delete by position function for doubly linked lists. I am trying to save a pointer to the last node so that when printing in reverse direction, I do not have to iterate to last node.</p>\n\n<pre><code>node* deleteByPos(node* list, node** last, int position) {\n    int c = 0;\n    node* temp;\n    node* prev;\n\n    temp=list;\n    if (temp==NULL) {\n        printf(\"No nodes available to delete\\n\\n\");\n        return list;\n    } else {\n        while(temp!=NULL &amp;&amp; c != position) {\n            prev=temp;\n            temp=temp-&gt;next;\n            c++;\n        }\n        if (temp==NULL) {\n            printf(\"Reached end of list, position not available\\n\\n\");\n            return list;\n        } else if (temp-&gt;next == NULL) {\n            prev-&gt;next=temp-&gt;next;\n            temp-&gt;next-&gt;prev = prev;\n            &amp;last = temp-&gt;next;\n            free(temp);\n            return list;\n        } else {\n            prev-&gt;next=temp-&gt;next;\n            temp-&gt;next-&gt;prev = prev;\n            free(temp);\n            return list;\n        }\n    }\n}\n</code></pre>\n\n<p>When I try to delete the last position in the list, I get a segmentation fault. How do I fix?</p>\n"}, {"tags": ["c", "singly-linked-list"], "comments": [{"owner": {"reputation": 3108, "user_id": 1556820, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cffaba688aa3f0f21ece8e09c9450e37?s=128&d=identicon&r=PG", "display_name": "mangusta", "link": "https://stackoverflow.com/users/1556820/mangusta"}, "edited": false, "score": 0, "creation_date": 1527045203, "post_id": 50479110, "comment_id": 87972049, "body": "why don&#39;t you use hash instead?"}, {"owner": {"reputation": 23, "user_id": 9654775, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "David Salvador", "link": "https://stackoverflow.com/users/9654775/david-salvador"}, "reply_to_user": {"reputation": 3108, "user_id": 1556820, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cffaba688aa3f0f21ece8e09c9450e37?s=128&d=identicon&r=PG", "display_name": "mangusta", "link": "https://stackoverflow.com/users/1556820/mangusta"}, "edited": false, "score": 0, "creation_date": 1527045336, "post_id": 50479110, "comment_id": 87972080, "body": "funny you mention that because that&#39;s unfortunately next week&#39;s lesson so I&#39;m just working with what I was semi taught."}, {"owner": {"reputation": 3108, "user_id": 1556820, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cffaba688aa3f0f21ece8e09c9450e37?s=128&d=identicon&r=PG", "display_name": "mangusta", "link": "https://stackoverflow.com/users/1556820/mangusta"}, "edited": false, "score": 0, "creation_date": 1527045482, "post_id": 50479110, "comment_id": 87972107, "body": "you&#39;ve got a semicolon after your <code>for</code> loop"}, {"owner": {"reputation": 23, "user_id": 9654775, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "David Salvador", "link": "https://stackoverflow.com/users/9654775/david-salvador"}, "reply_to_user": {"reputation": 3108, "user_id": 1556820, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cffaba688aa3f0f21ece8e09c9450e37?s=128&d=identicon&r=PG", "display_name": "mangusta", "link": "https://stackoverflow.com/users/1556820/mangusta"}, "edited": false, "score": 0, "creation_date": 1527045542, "post_id": 50479110, "comment_id": 87972123, "body": "From what I&#39;ve seen/read in my book that&#39;s intentional as it will just move to the end of the linked list."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1527045948, "post_id": 50479110, "comment_id": 87972207, "body": "<code>memcpy(&amp;ptr-&gt;str, &amp;strToken, sizeof(strToken));</code> is suspicious.   Perhasp <code>strcpy(ptr-&gt;str, strToken);</code>?"}, {"owner": {"reputation": 23, "user_id": 9654775, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "David Salvador", "link": "https://stackoverflow.com/users/9654775/david-salvador"}, "edited": false, "score": 0, "creation_date": 1527046131, "post_id": 50479110, "comment_id": 87972247, "body": "Chux, it was recommended to use memcpy vs strcpy. It was noted to be used for efficiency purposes."}, {"owner": {"reputation": 849, "user_id": 4086095, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CMn9X.jpg?s=128&g=1", "display_name": "Tsakiroglou Fotis", "link": "https://stackoverflow.com/users/4086095/tsakiroglou-fotis"}, "edited": false, "score": 0, "creation_date": 1527086273, "post_id": 50479110, "comment_id": 87995193, "body": "A design tip.Don&#39;t keep data inside a Node.Create a struct to hold your data , and create a Node with one pointer to the next node and one pointer to your struct.You keep things clear this way and if 3 months later you would like to update your data , then you will have only to fix your struct."}], "owner": {"reputation": 23, "user_id": 9654775, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "David Salvador", "link": "https://stackoverflow.com/users/9654775/david-salvador"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1527043817, "creation_date": 1527043817, "question_id": 50479110, "link": "https://stackoverflow.com/questions/50479110/creating-a-singly-linked-list-with-data-from-a-filestream", "title": "Creating a Singly Linked List with Data from a Filestream", "body": "<p>I'm currently attempting to create a program that will create a linked list containing the following in each node:</p>\n\n<ol>\n<li>pointer to the next node (obviously needed)</li>\n<li>a string read in from a line of text from the file stream</li>\n<li>a count of how many times the string was encountered in the filestream</li>\n</ol>\n\n<p>I have the following code but, I'm running into a couple issues that I'm clearly  failing to grasp:</p>\n\n<ol>\n<li><p>How to search the list and then create a node if a corresponding node wasn't found in the list already?</p></li>\n<li><p>In general, how to create the head node and then start linking subsequent nodes to it?</p></li>\n</ol>\n\n<p>Any help is greatly appreciated as I've spent many hours googling and watching youtube videos to no avail.</p>\n\n<pre><code>typedef struct List\n    {\n       struct List *next;\n       char *str;\n       int count;\n    } List;\n</code></pre>\n\n<p>The above is from a provided header file. Below is my current code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include \"C2A6E4_List-Driver.h\"\n\n#define ARRAY_SIZE 255  /*Define the size of the array*/\n\nList *CreateLinkedList(FILE *fp)\n{\n   List *head, *ptr, *p;\n   head = NULL;\n   char tempBuffer[ARRAY_SIZE];\n\n   while (fgets(tempBuffer, ARRAY_SIZE, fp) != NULL)\n   {\n      char *strToken = strtok(tempBuffer, \" \");\n\n      while (strToken != NULL)\n      {\n         for (p = head; p != NULL; p = p-&gt;next)\n            ;\n         if (strcmp(p-&gt;str, strToken) == 0)\n         {\n            p-&gt;count++;\n            break;\n         }\n         else\n         {\n            if ((ptr = (List *)malloc(sizeof(List))) == NULL)\n            {\n               fprintf(stderr, \"Failed to allocate memory!\");\n               exit(EXIT_FAILURE);\n            }\n\n            if ((ptr-&gt;str = (char *)malloc(strlen(strToken) * sizeof(char) + sizeof(char))) == NULL)\n            {\n               fprintf(stderr, \"Failed to allocate memory!\");\n               exit(EXIT_FAILURE);\n            }\n\n            memcpy(&amp;ptr-&gt;str, &amp;strToken, sizeof(strToken));\n            ptr-&gt;count = 1;\n\n            if (head != NULL)\n            {\n               p = head;\n               p-&gt;next = ptr;\n            }\n            else\n               head = ptr;\n         }\n         strToken = strtok(NULL, \" \");\n      }\n   }\n   return head;\n}\n</code></pre>\n"}, {"tags": ["c", "eclipse", "api", "c++14"], "comments": [{"owner": {"reputation": 678, "user_id": 9622872, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lbCvk.png?s=128&g=1", "display_name": "James Whyte", "link": "https://stackoverflow.com/users/9622872/james-whyte"}, "edited": false, "score": 5, "creation_date": 1527043893, "post_id": 50479098, "comment_id": 87971787, "body": "For starters, your code wont compile with missing semi colons and closing braces. Perhaps you should revise your code and get it to the point it&#39;s a readable, <a href=\"https://stackoverflow.com/help/mcve\">minimal and verifiable example</a>."}, {"owner": {"reputation": 18942, "user_id": 894328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3db17c5296335f63e856be44aa821bf6?s=128&d=identicon&r=PG", "display_name": "Ahmed Masud", "link": "https://stackoverflow.com/users/894328/ahmed-masud"}, "edited": false, "score": 0, "creation_date": 1527045855, "post_id": 50479098, "comment_id": 87972184, "body": "Your code is working correctly.  that&#39;s because in your strncat_s you are setting a maximal length of 7 on the dest."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1527055441, "post_id": 50479098, "comment_id": 87974837, "body": "You write &quot;implement&quot; but it seems you ask about how to <b>use</b> it. Could you clarify?"}, {"owner": {"reputation": 811, "user_id": 9493582, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bfI3b.jpg?s=128&g=1", "display_name": "Arndt Jonasson", "link": "https://stackoverflow.com/users/9493582/arndt-jonasson"}, "edited": false, "score": 0, "creation_date": 1527063114, "post_id": 50479098, "comment_id": 87979190, "body": "I haven&#39;t heard of <code>strncat_s</code> before. Is it C, C++ or both?"}], "owner": {"reputation": 41, "user_id": 4726568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f9cdf5a6bdbd2ec2c9aa98a8bb2cb09?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/4726568/jordan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 105, "favorite_count": 0, "closed_date": 1527057004, "answer_count": 0, "score": 2, "last_activity_date": 1527324720, "creation_date": 1527043667, "last_edit_date": 1527324720, "question_id": 50479098, "link": "https://stackoverflow.com/questions/50479098/c-programming-secure-function", "closed_reason": "Needs details or clarity", "title": "C programming secure function", "body": "<p>Please suggest any changes to execute the following program.</p>\n\n<p>This is following I have tried for concatenating  but it was printing only dest string. Not concatenated string.</p>\n\n<pre><code> #include &lt;stdio.h&gt; \n #include &lt;string.h&gt; \n #include\"safe_str_lib.h\"\n\n int main () {\n  char src[50], dest[50];\n  char max=8; char Len=8  \n  strcpy(src,  \"This is source\");   \n  strcpy(dest, \"This is destination\");\n  //strncat(dest, src, 15);\n  strncat_s(dest,7,src,8);\n  printf(\"Final destination string : |%s|\", dest);\n  return(0);\n }\n</code></pre>\n"}, {"tags": ["c", "arrays", "scanf", "abort"], "comments": [{"owner": {"reputation": 121, "user_id": 9732828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55ba3c3d305444bb55ba37aec48e477d?s=128&d=identicon&r=PG&f=1", "display_name": "Michel", "link": "https://stackoverflow.com/users/9732828/michel"}, "edited": false, "score": 0, "creation_date": 1527039024, "post_id": 50478573, "comment_id": 87970747, "body": "PS. I also used &#39;gets&#39; after the printf in the first loop, using one array to contain both the id and mark, however, this also resulted in the same &quot;Abort error: 6&quot;."}, {"owner": {"reputation": 4593, "user_id": 105104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02b23920ac852e946b333d3f9d0d95c1?s=128&d=identicon&r=PG", "display_name": "dvhh", "link": "https://stackoverflow.com/users/105104/dvhh"}, "edited": false, "score": 0, "creation_date": 1527039268, "post_id": 50478573, "comment_id": 87970812, "body": "Are the string you scan using 1 char only ? whuy not use <code>%c</code> in the scanf ?"}, {"owner": {"reputation": 121, "user_id": 9732828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55ba3c3d305444bb55ba37aec48e477d?s=128&d=identicon&r=PG&f=1", "display_name": "Michel", "link": "https://stackoverflow.com/users/9732828/michel"}, "reply_to_user": {"reputation": 4593, "user_id": 105104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02b23920ac852e946b333d3f9d0d95c1?s=128&d=identicon&r=PG", "display_name": "dvhh", "link": "https://stackoverflow.com/users/105104/dvhh"}, "edited": false, "score": 0, "creation_date": 1527039420, "post_id": 50478573, "comment_id": 87970853, "body": "Sorry for not addressing this."}, {"owner": {"reputation": 121, "user_id": 9732828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55ba3c3d305444bb55ba37aec48e477d?s=128&d=identicon&r=PG&f=1", "display_name": "Michel", "link": "https://stackoverflow.com/users/9732828/michel"}, "reply_to_user": {"reputation": 4593, "user_id": 105104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02b23920ac852e946b333d3f9d0d95c1?s=128&d=identicon&r=PG", "display_name": "dvhh", "link": "https://stackoverflow.com/users/105104/dvhh"}, "edited": false, "score": 0, "creation_date": 1527039442, "post_id": 50478573, "comment_id": 87970866, "body": "The ID I receive will be like: j134432 (one letter, followed by 6 numbers)"}, {"owner": {"reputation": 4593, "user_id": 105104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02b23920ac852e946b333d3f9d0d95c1?s=128&d=identicon&r=PG", "display_name": "dvhh", "link": "https://stackoverflow.com/users/105104/dvhh"}, "edited": false, "score": 0, "creation_date": 1527039807, "post_id": 50478573, "comment_id": 87970954, "body": "but you are storing it into one char ?"}, {"owner": {"reputation": 121, "user_id": 9732828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55ba3c3d305444bb55ba37aec48e477d?s=128&d=identicon&r=PG&f=1", "display_name": "Michel", "link": "https://stackoverflow.com/users/9732828/michel"}, "reply_to_user": {"reputation": 4593, "user_id": 105104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02b23920ac852e946b333d3f9d0d95c1?s=128&d=identicon&r=PG", "display_name": "dvhh", "link": "https://stackoverflow.com/users/105104/dvhh"}, "edited": false, "score": 0, "creation_date": 1527039901, "post_id": 50478573, "comment_id": 87970975, "body": "I would like to take this id and put it into the corresponding index in the id array"}], "answers": [{"tags": [], "owner": {"reputation": 4593, "user_id": 105104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02b23920ac852e946b333d3f9d0d95c1?s=128&d=identicon&r=PG", "display_name": "dvhh", "link": "https://stackoverflow.com/users/105104/dvhh"}, "is_accepted": false, "score": 0, "last_activity_date": 1527040345, "creation_date": 1527040345, "answer_id": 50478734, "question_id": 50478573, "link": "https://stackoverflow.com/questions/50478573/abort-trap-when-storing-users-input-into-two-arrays/50478734#50478734", "title": "Abort trap when storing users input into two arrays", "body": "<p>I think your ID reading is wrong, your IDs are string of 7 character length while your <a href=\"https://cdecl.org/?q=char+ids%5B10%5D\" rel=\"nofollow noreferrer\"><code>char id[10]</code></a> is a string of 10 char ( where you intended to use a list of string ), you should use <a href=\"https://cdecl.org/?q=char+*ids%5B10%5D\" rel=\"nofollow noreferrer\"><code>char *ids[10]</code></a> instead.</p>\n\n<pre><code>char *ids[10] = { NULL }; // list of 10 string, initialized to NULL\nint mark[10];\nfor (int i=0;i&lt;10;i++){\n    ...\n    char* id=malloc(8*sizeof(char)); // allocate a new string to store\n    scanf( \"%7s %d\\n\", id, &amp;mark[i] ); // check the result of the scanf to ensure you got the correct input\n    ids[i] = id; // store the string at position in the list\n}\nfor (int i=0;i&lt;10;i++){\n     printf(\"%s\\n\", ids[i]);\n}\n</code></pre>\n\n<p>Also using a debugger like <a href=\"https://sourceware.org/gdb/onlinedocs/gdb/gdb-man.html\" rel=\"nofollow noreferrer\">GDB</a> would help you pinpoint where is the error happening in your code. And probably help you figure out your mistake.</p>\n"}], "owner": {"reputation": 121, "user_id": 9732828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55ba3c3d305444bb55ba37aec48e477d?s=128&d=identicon&r=PG&f=1", "display_name": "Michel", "link": "https://stackoverflow.com/users/9732828/michel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1527040345, "creation_date": 1527038896, "question_id": 50478573, "link": "https://stackoverflow.com/questions/50478573/abort-trap-when-storing-users-input-into-two-arrays", "title": "Abort trap when storing users input into two arrays", "body": "<p>I am going to take in a users input consisting of their identification and their mark, separated by a space. The code compiles and I can enter answers at the prompt, however, at the end of the prompts (end of the first loop) I get an \"Abort trap: 6\" appearing. </p>\n\n<p>I would appreciate it if you could help me find out why this comment is arising. I read that it could be from me overwriting over other memory, but it looks like my loops do not go beyond what I would want them to loop over (user gives me 10 answers). </p>\n\n<p>I also added ampersands in front of the arrays in scanf, which I found odd to do, but the code did not compile otherwise. </p>\n\n<h1>include </h1>\n\n<p>int main (void){</p>\n\n<pre><code>char id[10];\n\nint mark[10];\n\nfor (int i=0;i&lt;10;i++){\n\n\n    printf(\"Enter ID and mark: \\n\");\n\n\n\n    scanf(\" %s %d\", &amp;id[i], &amp;mark[i]);\n}\nfor (int i=0;i&lt;10;i++){\n\n    printf(\"%c \",id[i]);\n\n}\n</code></pre>\n\n<p>}</p>\n"}, {"tags": ["c", "netbeans", "binaryfiles", "fwrite", "fread"], "comments": [{"owner": {"reputation": 4328, "user_id": 920069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd39f0db1f22e1314746491df063602a?s=128&d=identicon&r=PG", "display_name": "Retired Ninja", "link": "https://stackoverflow.com/users/920069/retired-ninja"}, "edited": false, "score": 0, "creation_date": 1527038198, "post_id": 50478458, "comment_id": 87970543, "body": "Consider what you&#39;re writing. It would help a great deal if you made your program short and self contained, not a bunch of blocks. Read <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> for help with that.  In your write function <code>ELEMENTO *aux = NULL; fwrite(aux, sizeof(CLIENTE), 1, fp);</code>, and your read <code>CLIENTE aux; fread(&amp;aux, sizeof(CLIENTE), 1, fp);</code> You can see these aren&#39;t the same thing can&#39;t you? <code>CLIENTE</code> isn&#39;t even the first element in <code>ELEMENTO</code>. <code>&amp;aux-&gt;info_cliente</code> could be what you want in the write."}, {"owner": {"reputation": 25, "user_id": 5162671, "user_type": "registered", "profile_image": "https://graph.facebook.com/934463189960781/picture?type=large", "display_name": "Nuno Oliveira", "link": "https://stackoverflow.com/users/5162671/nuno-oliveira"}, "reply_to_user": {"reputation": 4328, "user_id": 920069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd39f0db1f22e1314746491df063602a?s=128&d=identicon&r=PG", "display_name": "Retired Ninja", "link": "https://stackoverflow.com/users/920069/retired-ninja"}, "edited": false, "score": 0, "creation_date": 1527044231, "post_id": 50478458, "comment_id": 87971842, "body": "thank you for your enlightment, sorry about the writing just  wanted to make things more clear. I tried what you said and it worked but at the same time writes a  0    0  for each cliente inserted any way to fix that? @RetiredNinja"}, {"owner": {"reputation": 4328, "user_id": 920069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd39f0db1f22e1314746491df063602a?s=128&d=identicon&r=PG", "display_name": "Retired Ninja", "link": "https://stackoverflow.com/users/920069/retired-ninja"}, "edited": false, "score": 0, "creation_date": 1527048921, "post_id": 50478458, "comment_id": 87972812, "body": "Based on the code you&#39;ve shown, how would anyone know what menu option 3 is or does? That&#39;s why we ask for a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}], "owner": {"reputation": 25, "user_id": 5162671, "user_type": "registered", "profile_image": "https://graph.facebook.com/934463189960781/picture?type=large", "display_name": "Nuno Oliveira", "link": "https://stackoverflow.com/users/5162671/nuno-oliveira"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1527043590, "creation_date": 1527037783, "last_edit_date": 1527043590, "question_id": 50478458, "link": "https://stackoverflow.com/questions/50478458/write-and-read-struct-to-binary-file-in-c-netbeans-doesnt-work", "title": "Write and Read struct to Binary File in C (netbeans) doesnt work", "body": "<pre><code>## MY STRUCT ##\n\n\n    typedef struct clientes{\n        int cod_cliente;\n        char name[100];\n        char country[100];\n        char city[100];\n        char email[100];\n        int nif;\n        char n_passporte[50];\n        char n_carta_conducao[50];\n        char telefone[50];\n    }CLIENTE;\n\n\n    typedef struct Elem{\n        VEICULO info_veiculo;\n        CLIENTE info_cliente;\n        ALUGADO info_alugado;\n        struct Elem *seguinte;\n    }ELEMENTO;\n</code></pre>\n\n<hr>\n\n<pre><code>## FUNCTIONS ##\n\n\n\n       int saveBinaryCliente(ELEMENTO *iniLista){\n             ELEMENTO *aux = NULL;\n            FILE *fp = NULL;\n            int res=0;\n\n            fp = fopen(\"clientes.dat\", \"wb\");\n\n            if(fp == NULL){\n                printf(\"Erro ao abrir o ficheiro clientes!\\n\");\n                return -1;\n            }\n\n            for(aux=iniLista; aux!=NULL; aux=aux-&gt;seguinte){\n\n        /*\n                printf(\"%i %s %s %s %i %s %s %s %s\\n\", aux-&gt;info_cliente.cod_cliente, aux-&gt;info_cliente.nome, aux-&gt;info_cliente.pais, aux-&gt;info_cliente.cidade, aux-&gt;info_cliente.nif, aux-&gt;info_cliente.n_passporte, aux-&gt;info_cliente.n_carta_conducao, aux-&gt;info_cliente.email, aux-&gt;info_cliente.telefone);\n\n        */\n</code></pre>\n\n<p><em>Receives every parameter until this printf above</em></p>\n\n<pre><code>                res = fwrite(aux, sizeof(CLIENTE), 1, fp);\n            }\n\n            fclose(fp);\n            printf(\"Saved %i register clientes!\\n\", res);\n            return 0;\n        }\n\n        int readDataCliente(ELEMENTO **iniLista){\n            CLIENTE aux;\n            int res=0;\n            FILE *fp = NULL;\n\n            fp = fopen(\"clientes.dat\", \"rb\");\n\n            if(fp == NULL){\n                printf(\"Error reading file clientes!\\n\");\n                return -1;\n            }\n\n            while (!feof(fp)){\n                res = fread(&amp;aux, sizeof(CLIENTE), 1, fp);\n\n                if (res){\n                    inserirCliente(&amp;(*iniLista), aux);  \n                }\n            }\n            fclose(fp);\n            return 0;\n            }\n</code></pre>\n\n<hr>\n\n<pre><code>## OUTPUT ##\n</code></pre>\n\n<p><strong>LISTING BEFORE CLOSING WITH 1 CLIENT INSERTED</strong></p>\n\n<pre><code>            1 nuno portugal porto 23421342 ASDFA0942 ASDF-434 ssss@hotmail.com +351093856273\n</code></pre>\n\n<hr>\n\n<pre><code>             **AFTER CLOSING PROGRAM AND SAVE TO BINARY FILE**\n\n                *****************************************************\n                *                MENU  CLIENTES                     *\n                *****************************************************\n                *                                                   *\n                *   1 - INSERT NEW CLIENTE                          *\n                *   2 - CHANGE INFO CLIENTE                         *\n                *   3 - LIST CLIENTES                               *\n                *****************************************************\n\n                Choose your CHOICE: 3\n                0    0    \n                0    0    \n</code></pre>\n\n<p>strange fact...all seemed to work before. Dunno why doesnt work now and it also saves when I dont insert a client and reads it.                 I have been poking my head for a while so i decided to ask you guys for your help, thank you.</p>\n"}, {"tags": ["c", "memset"], "comments": [{"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1527036823, "post_id": 50478273, "comment_id": 87970262, "body": "In general you can&#39;t do it this way. I will explain on 2d example.  Array is stored row by row. If you want to set the second row to some value you can use memset as the row is the continuous chunk oh memory, but if you want to set second column you can&#39;t as the column is not continuous. You need to iterate. Same is with the nD arrays"}], "answers": [{"comments": [{"owner": {"reputation": 656, "user_id": 9592917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fe6504c31f4954495f952699592361a?s=128&d=identicon&r=PG&f=1", "display_name": "Bwebb", "link": "https://stackoverflow.com/users/9592917/bwebb"}, "edited": false, "score": 0, "creation_date": 1527037012, "post_id": 50478332, "comment_id": 87970300, "body": "Thanks for the answer.  Thinking about the implicit pointer arithmetic behind the array sub-scripting it is obvious why this works."}], "tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": true, "score": 6, "last_activity_date": 1527036624, "creation_date": 1527036624, "answer_id": 50478332, "question_id": 50478273, "link": "https://stackoverflow.com/questions/50478273/how-to-memset-one-dimension-of-an-array-to-zero-in-c/50478332#50478332", "title": "How to memset one dimension of an array to zero in C", "body": "<p><code>memset(&amp;multi_dimension_array[2], 0, sizeof multi_dimension_array[2]);</code></p>\n\n<p>This requires that <code>multi_dimension_array[i]</code> be an array of arrays of arrays, not a pointer. It works because, when <code>sizeof</code> is applied to an array, it returns the size of the array. The array is not automatically converted to a pointer as in most expressions.</p>\n\n<p>Of course, it works only for the first dimension (or first several dimensions, if you do more than one). E.g., you can use one memset with <code>array[i]</code> or <code>array[i][j]</code> but not with the middle dimensions such as <code>array[???][j]</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 656, "user_id": 9592917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fe6504c31f4954495f952699592361a?s=128&d=identicon&r=PG&f=1", "display_name": "Bwebb", "link": "https://stackoverflow.com/users/9592917/bwebb"}, "is_accepted": false, "score": 0, "last_activity_date": 1527048197, "creation_date": 1527048197, "answer_id": 50479604, "question_id": 50478273, "link": "https://stackoverflow.com/questions/50478273/how-to-memset-one-dimension-of-an-array-to-zero-in-c/50479604#50479604", "title": "How to memset one dimension of an array to zero in C", "body": "<p>For future readers of this question, Eric Postpischil's answer is correct and I have accepted it because it is.  Here is a sample program and output to demonstrate the sizeof operator/function as it applies to multidimensional arrays.\nIn general, if declared as an array of ints</p>\n\n<pre><code>int mda[x][y][z]; \nthen mda[a][b][c] == *(mda + ((a *( y* z)) + (b*z) + (c))\n</code></pre>\n\n<p>Whats important, atleast to the original question i asked, is that indexing into array with fewer \"dimensions\" than it was declared with your program still will compile and maintain the \"sizeof\" the next array.</p>\n\n<pre><code>mda[a] == *(mda + (a * (y*z))) AND sizeof(mda[a]) == sizeof(array_type) * y * z\nmda[a][b] == *(mda + (a * (y*z)) + (b * z)) AND sizeof(mda[a][b]) == sizeof(array_type) * z\n</code></pre>\n\n<p>Ok so heres a sample program that you can run in an online IDE and verify:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#define X (4)\n#define Y (10)\n#define Z (5)\nint multi_dimension_array[X][Y][Z];\n\nvoid print_array(){\n    for(int i=0; i&lt;X; i++){\n        printf(\"THIS IS THE %dth value of X\\n\", i);\n        for(int j=0; j&lt;Y; j++){\n            for(int k=0; k&lt;Z; k++){\n                printf(\"%d \", multi_dimension_array[i][j][k]);\n            }\n            printf(\"\\n\");\n        }\n    }\n}\n\nint main(void) {\n    printf(\"%d %d %d %d\\n\", sizeof(multi_dimension_array[0][0][0]), sizeof(multi_dimension_array[0][0]), sizeof(multi_dimension_array[0]), sizeof(multi_dimension_array));\n\n    memset(multi_dimension_array,0x01,sizeof(multi_dimension_array));\n    print_array();\n\n    memset(&amp;multi_dimension_array[2],0x0,sizeof(multi_dimension_array[2]));\n\n    printf(\"\\n\\n\\nNEXT MEMSET with the X=2 zeroed out\\n\\n\\n\");\n    print_array();\n\n    return 0;\n}\n</code></pre>\n\n<p>And Here is this programs output:</p>\n\n<pre><code>4 20 200 800\nTHIS IS THE 0th value of X\n16843009 16843009 16843009 16843009 16843009 \n16843009 16843009 16843009 16843009 16843009 \n16843009 16843009 16843009 16843009 16843009 \n16843009 16843009 16843009 16843009 16843009 \n16843009 16843009 16843009 16843009 16843009 \n16843009 16843009 16843009 16843009 16843009 \n16843009 16843009 16843009 16843009 16843009 \n16843009 16843009 16843009 16843009 16843009 \n16843009 16843009 16843009 16843009 16843009 \n16843009 16843009 16843009 16843009 16843009 \nTHIS IS THE 1th value of X\n16843009 16843009 16843009 16843009 16843009 \n16843009 16843009 16843009 16843009 16843009 \n16843009 16843009 16843009 16843009 16843009 \n16843009 16843009 16843009 16843009 16843009 \n16843009 16843009 16843009 16843009 16843009 \n16843009 16843009 16843009 16843009 16843009 \n16843009 16843009 16843009 16843009 16843009 \n16843009 16843009 16843009 16843009 16843009 \n16843009 16843009 16843009 16843009 16843009 \n16843009 16843009 16843009 16843009 16843009 \nTHIS IS THE 2th value of X\n16843009 16843009 16843009 16843009 16843009 \n16843009 16843009 16843009 16843009 16843009 \n16843009 16843009 16843009 16843009 16843009 \n16843009 16843009 16843009 16843009 16843009 \n16843009 16843009 16843009 16843009 16843009 \n16843009 16843009 16843009 16843009 16843009 \n16843009 16843009 16843009 16843009 16843009 \n16843009 16843009 16843009 16843009 16843009 \n16843009 16843009 16843009 16843009 16843009 \n16843009 16843009 16843009 16843009 16843009 \nTHIS IS THE 3th value of X\n16843009 16843009 16843009 16843009 16843009 \n16843009 16843009 16843009 16843009 16843009 \n16843009 16843009 16843009 16843009 16843009 \n16843009 16843009 16843009 16843009 16843009 \n16843009 16843009 16843009 16843009 16843009 \n16843009 16843009 16843009 16843009 16843009 \n16843009 16843009 16843009 16843009 16843009 \n16843009 16843009 16843009 16843009 16843009 \n16843009 16843009 16843009 16843009 16843009 \n16843009 16843009 16843009 16843009 16843009 \n\n\n\nNEXT MEMSET with the X=2 zeroed out\n\n\nTHIS IS THE 0th value of X\n16843009 16843009 16843009 16843009 16843009 \n16843009 16843009 16843009 16843009 16843009 \n16843009 16843009 16843009 16843009 16843009 \n16843009 16843009 16843009 16843009 16843009 \n16843009 16843009 16843009 16843009 16843009 \n16843009 16843009 16843009 16843009 16843009 \n16843009 16843009 16843009 16843009 16843009 \n16843009 16843009 16843009 16843009 16843009 \n16843009 16843009 16843009 16843009 16843009 \n16843009 16843009 16843009 16843009 16843009 \nTHIS IS THE 1th value of X\n16843009 16843009 16843009 16843009 16843009 \n16843009 16843009 16843009 16843009 16843009 \n16843009 16843009 16843009 16843009 16843009 \n16843009 16843009 16843009 16843009 16843009 \n16843009 16843009 16843009 16843009 16843009 \n16843009 16843009 16843009 16843009 16843009 \n16843009 16843009 16843009 16843009 16843009 \n16843009 16843009 16843009 16843009 16843009 \n16843009 16843009 16843009 16843009 16843009 \n16843009 16843009 16843009 16843009 16843009 \nTHIS IS THE 2th value of X\n0 0 0 0 0 \n0 0 0 0 0 \n0 0 0 0 0 \n0 0 0 0 0 \n0 0 0 0 0 \n0 0 0 0 0 \n0 0 0 0 0 \n0 0 0 0 0 \n0 0 0 0 0 \n0 0 0 0 0 \nTHIS IS THE 3th value of X\n16843009 16843009 16843009 16843009 16843009 \n16843009 16843009 16843009 16843009 16843009 \n16843009 16843009 16843009 16843009 16843009 \n16843009 16843009 16843009 16843009 16843009 \n16843009 16843009 16843009 16843009 16843009 \n16843009 16843009 16843009 16843009 16843009 \n16843009 16843009 16843009 16843009 16843009 \n16843009 16843009 16843009 16843009 16843009 \n16843009 16843009 16843009 16843009 16843009 \n16843009 16843009 16843009 16843009 16843009 \n</code></pre>\n\n<p>*Note that memset sets each byte to the value of the second paramater, which in this case was 0x01 which makes the 4 byte ints 0x01010101 == 16843009.</p>\n"}], "owner": {"reputation": 656, "user_id": 9592917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fe6504c31f4954495f952699592361a?s=128&d=identicon&r=PG&f=1", "display_name": "Bwebb", "link": "https://stackoverflow.com/users/9592917/bwebb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 400, "favorite_count": 1, "accepted_answer_id": 50478332, "answer_count": 2, "score": 2, "last_activity_date": 1527048197, "creation_date": 1527035943, "question_id": 50478273, "link": "https://stackoverflow.com/questions/50478273/how-to-memset-one-dimension-of-an-array-to-zero-in-c", "title": "How to memset one dimension of an array to zero in C", "body": "<p>Suppose i have a 3d array declared globably (in data segment) that I want to memset 1d of it to 0.</p>\n\n<pre><code>int multi_dimension_array[x][y][z];\n</code></pre>\n\n<p>I can memset the whole thing with the line:</p>\n\n<pre><code>memset(multi_dimension_array, 0, sizeof(multi_dimension_array));\n</code></pre>\n\n<p>But now suppose i only want to memset the x dimension for some value (say 2), meaning the values of multi_dimension_array[2][0][0] to multi_dimension_array[2][y-1][z-1] should all be zero.  I dont think theres a clever way to use memset for y or z since they're not contiguous.  The following line should work:</p>\n\n<pre><code>memset(&amp;multi_dimension_array[2][0][0], 0, sizeof(multi_dimension_array[2][0][0]) * y * z);\n</code></pre>\n\n<p>My \"issue\" is that i dont like the * y * z part of the memset param.  Is there something in the array that says sizeof(multi_dimension_array[2]) == byte_size_of_type * y * z?</p>\n\n<p>I want to use a property of the array that sizeof would evaluate to the correct number of bytes for the \"x\" dimension in this example.  I dont want to use * y *z in the event that someone changes the size in the declaration and they do not change this memset, plus i dont like how it looks.</p>\n"}, {"tags": ["c", "time", "execution-time"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1527034681, "post_id": 50478119, "comment_id": 87969862, "body": "How do you know the time is improper in the second case?  What do you get from the first and second?  How long do the functions actually take to run?  If they&#39;re under a number in the 50 ms range, the timing is likely to be unreliable, IMO \u2014 and longer than that would be better.  But you really need to show what it is that you&#39;re getting."}, {"owner": {"reputation": 7, "user_id": 9830598, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76ead5aab4bf1e664a2065693f87210c?s=128&d=identicon&r=PG&f=1", "display_name": "InfoSecNick", "link": "https://stackoverflow.com/users/9830598/infosecnick"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1527034862, "post_id": 50478119, "comment_id": 87969896, "body": "@JonathanLeffler You&#39;re right. Sorry about that. I&#39;ve edited the post."}, {"owner": {"reputation": 2784, "user_id": 8413636, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d8c46d1ea221e93d32a1b3d2ee354cae?s=128&d=identicon&r=PG&f=1", "display_name": "zzxyz", "link": "https://stackoverflow.com/users/8413636/zzxyz"}, "edited": false, "score": 0, "creation_date": 1527035530, "post_id": 50478119, "comment_id": 87970005, "body": "Looks like the measurements should be accurate.  Have you tried executing the 2nd choice and THEN the first?  <a href=\"https://en.wikipedia.org/wiki/CPU_cache#CPU_stalls\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/CPU_cache#CPU_stalls</a>.  Although 600ms worth of memory time is far more than a modern CPU can cache as far as I know (generally speaking)"}, {"owner": {"reputation": 27279, "user_id": 857132, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4fd51ed5980999c7c6ce3729d6cb2184?s=128&d=identicon&r=PG", "display_name": "John3136", "link": "https://stackoverflow.com/users/857132/john3136"}, "edited": false, "score": 1, "creation_date": 1527035657, "post_id": 50478119, "comment_id": 87970022, "body": "Add a sleep between <code>begin2</code> and <code>end2</code> - that will tell you if timing is a problem or the 2nd algorithm is really fast..."}, {"owner": {"reputation": 7, "user_id": 9830598, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76ead5aab4bf1e664a2065693f87210c?s=128&d=identicon&r=PG&f=1", "display_name": "InfoSecNick", "link": "https://stackoverflow.com/users/9830598/infosecnick"}, "reply_to_user": {"reputation": 2784, "user_id": 8413636, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d8c46d1ea221e93d32a1b3d2ee354cae?s=128&d=identicon&r=PG&f=1", "display_name": "zzxyz", "link": "https://stackoverflow.com/users/8413636/zzxyz"}, "edited": false, "score": 0, "creation_date": 1527036023, "post_id": 50478119, "comment_id": 87970102, "body": "@zzxyz Yes, I&#39;ve tried running the 2nd choice first. Hmm, it&#39;s strange I&#39;m not even getting 0.001 ms."}, {"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "edited": false, "score": 0, "creation_date": 1527036060, "post_id": 50478119, "comment_id": 87970110, "body": "Is it possible it&#39;s been completely optimized away?"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1527036131, "post_id": 50478119, "comment_id": 87970117, "body": "Print the values of the bedinners and end. Check if your second function does not return instantly"}, {"owner": {"reputation": 7, "user_id": 9830598, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76ead5aab4bf1e664a2065693f87210c?s=128&d=identicon&r=PG&f=1", "display_name": "InfoSecNick", "link": "https://stackoverflow.com/users/9830598/infosecnick"}, "reply_to_user": {"reputation": 27279, "user_id": 857132, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4fd51ed5980999c7c6ce3729d6cb2184?s=128&d=identicon&r=PG", "display_name": "John3136", "link": "https://stackoverflow.com/users/857132/john3136"}, "edited": false, "score": 0, "creation_date": 1527036220, "post_id": 50478119, "comment_id": 87970131, "body": "@John3136 I&#39;ve added a sleep statement, and I&#39;m still getting 0.000 ms"}, {"owner": {"reputation": 7, "user_id": 9830598, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76ead5aab4bf1e664a2065693f87210c?s=128&d=identicon&r=PG&f=1", "display_name": "InfoSecNick", "link": "https://stackoverflow.com/users/9830598/infosecnick"}, "reply_to_user": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "edited": false, "score": 0, "creation_date": 1527036338, "post_id": 50478119, "comment_id": 87970165, "body": "@Schwern Do you mean optimized to the point where it runs instantly? Maybe. But if I put a very large integer, it should still take a millisecond to run at least."}, {"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "edited": false, "score": 2, "creation_date": 1527036497, "post_id": 50478119, "comment_id": 87970197, "body": "@InfoSecNick I mean optimized to the point where the compiler eliminates the call to <code>prefixAverages2</code> completely. Since the code never uses the return value (except to free it), if <code>prefixAverages2</code> has no side-effects the compiler might eliminate the call completely. Try compiling with and without optimizations. Or do something with the contents of <code>a2</code>, like printing them. Maybe you should show us <code>prefixAverages2</code>."}, {"owner": {"reputation": 7, "user_id": 9830598, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76ead5aab4bf1e664a2065693f87210c?s=128&d=identicon&r=PG&f=1", "display_name": "InfoSecNick", "link": "https://stackoverflow.com/users/9830598/infosecnick"}, "reply_to_user": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "edited": false, "score": 0, "creation_date": 1527036879, "post_id": 50478119, "comment_id": 87970272, "body": "@Schwern That&#39;s interesting. Didn&#39;t know that was something a compiler could do. All of the work for <code>a2</code> is done within the function call. It creates an array of size n, and averages the values for the array. The first function does the same, just with a different algorithm. I can print the values, but I&#39;m looking to measure the execution-time differences between the two algorithms."}, {"owner": {"reputation": 27279, "user_id": 857132, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4fd51ed5980999c7c6ce3729d6cb2184?s=128&d=identicon&r=PG", "display_name": "John3136", "link": "https://stackoverflow.com/users/857132/john3136"}, "edited": false, "score": 0, "creation_date": 1527036946, "post_id": 50478119, "comment_id": 87970286, "body": "@InfoSecNick Assuming your sleep was big enough (make it 1000) then one possibility would be stack corruption in the 2nd algorithm."}, {"owner": {"reputation": 7, "user_id": 9830598, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76ead5aab4bf1e664a2065693f87210c?s=128&d=identicon&r=PG&f=1", "display_name": "InfoSecNick", "link": "https://stackoverflow.com/users/9830598/infosecnick"}, "reply_to_user": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "edited": false, "score": 0, "creation_date": 1527036993, "post_id": 50478119, "comment_id": 87970295, "body": "@Schwern I&#39;ve added my functions to my post."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1527037343, "post_id": 50478119, "comment_id": 87970372, "body": "What value of <code>input</code> are you using?"}, {"owner": {"reputation": 2784, "user_id": 8413636, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d8c46d1ea221e93d32a1b3d2ee354cae?s=128&d=identicon&r=PG&f=1", "display_name": "zzxyz", "link": "https://stackoverflow.com/users/8413636/zzxyz"}, "edited": false, "score": 0, "creation_date": 1527037384, "post_id": 50478119, "comment_id": 87970380, "body": "@InfoSecNick I can&#39;t speak for the sleep(), but the 2nd function is obviously going to be thousands of times faster than the first once your input values get into the &gt; 2000 range."}, {"owner": {"reputation": 7, "user_id": 9830598, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76ead5aab4bf1e664a2065693f87210c?s=128&d=identicon&r=PG&f=1", "display_name": "InfoSecNick", "link": "https://stackoverflow.com/users/9830598/infosecnick"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1527037657, "post_id": 50478119, "comment_id": 87970431, "body": "@user3386109 It is user input. I&#39;m trying values between 10-50000. Same answer everytime."}, {"owner": {"reputation": 7, "user_id": 9830598, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76ead5aab4bf1e664a2065693f87210c?s=128&d=identicon&r=PG&f=1", "display_name": "InfoSecNick", "link": "https://stackoverflow.com/users/9830598/infosecnick"}, "reply_to_user": {"reputation": 2784, "user_id": 8413636, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d8c46d1ea221e93d32a1b3d2ee354cae?s=128&d=identicon&r=PG&f=1", "display_name": "zzxyz", "link": "https://stackoverflow.com/users/8413636/zzxyz"}, "edited": false, "score": 0, "creation_date": 1527037693, "post_id": 50478119, "comment_id": 87970440, "body": "@zzxyz Yes, that&#39;s a given. I was hoping I&#39;d be able to get at least a value to compare with."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1527042292, "post_id": 50478119, "comment_id": 87971495, "body": "Try printing some of the values returned outside the timing code and see whether that makes enough difference.  The first function appears to be O(N*N) and the second O(N) so you\u2019d expect the second to be quicker\u2014 a lot quicker in big enough values of N."}, {"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "edited": false, "score": 0, "creation_date": 1527054612, "post_id": 50478119, "comment_id": 87974489, "body": "@InfoSecNick Thanks. I&#39;m still getting valid times. My best guess is that <code>clock</code> failed for some reason. <a href=\"https://stackoverflow.com/a/50478277/14660\">See the update in my answer</a> for how to check for that. The other possibility is that <code>begin</code> and <code>end</code> are so close together that <code>(double)(end - begin) * 1000.0 &#47; CLOCKS_PER_SEC;</code> is resulting in 0 because of floating point inaccuracy. Try printing <code>begin</code> and <code>end</code> alone."}], "answers": [{"comments": [{"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "edited": false, "score": 0, "creation_date": 1527622051, "post_id": 50478277, "comment_id": 88192493, "body": "@InfoSecNick I&#39;m curious to know what is was."}], "tags": [], "owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "is_accepted": true, "score": 2, "last_activity_date": 1527054368, "last_edit_date": 1527054368, "creation_date": 1527036011, "answer_id": 50478277, "question_id": 50478119, "link": "https://stackoverflow.com/questions/50478119/measuring-time-spent-executing-function/50478277#50478277", "title": "Measuring Time Spent Executing Function", "body": "<p>While I don't know why the second choice might be 0, since the two functions have the same signature you can eliminate the redundant code by using function pointers.</p>\n\n<pre><code>void do_benchmark( const char *name, int*(*functionPtr)(int), int input ) {\n    printf(\"Beginning %s\\n\", name);\n    clock_t begin = clock();\n    int *ret = (*functionPtr)(input);\n    clock_t end = clock();\n    double time_spent = (double)(end - begin) * 1000.0 / CLOCKS_PER_SEC;\n    free(ret);\n    printf(\"Algorithm took %f milliseconds to execute \\n\", time_spent);\n}\n</code></pre>\n\n<p>Then both functions are run with the same timing code, eliminating differences in the benchmarking code as the culprit.</p>\n\n<pre><code>switch(choice) {\n    case 1:\n        do_benchmark(\"prefixAverages1\", &amp;prefixAverages1, input);\n        break;\n    case 2:\n        do_benchmark(\"prefixAverages2\", &amp;prefixAverages2, input);\n        break;\n    default:\n        printf(\"Invalid input!\");\n        break;\n}\n</code></pre>\n\n<hr>\n\n<p>Note that <code>clock</code> can fail.</p>\n\n<blockquote>\n  <p>If the processor time used is not available or its value cannot be represented, the function returns the value (clock_t)(-1).</p>\n</blockquote>\n\n<p>You'll want to check for that failure.</p>\n\n<pre><code>if( begin == (clock_t)-1 ) {\n    fprintf(stderr, \"Begin time not available.\\n\");\n}\nelse if( end == (clock_t)-1 ) {\n    fprintf(stderr, \"End time not available.\\n\");\n}\nelse {\n    double time_spent = (double)(end - begin) * 1000.0 / CLOCKS_PER_SEC;\n    printf(\"Algorithm took %f milliseconds to execute \\n\", time_spent);\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2784, "user_id": 8413636, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d8c46d1ea221e93d32a1b3d2ee354cae?s=128&d=identicon&r=PG&f=1", "display_name": "zzxyz", "link": "https://stackoverflow.com/users/8413636/zzxyz"}, "is_accepted": false, "score": 1, "last_activity_date": 1527041973, "last_edit_date": 1527041973, "creation_date": 1527041660, "answer_id": 50478867, "question_id": 50478119, "link": "https://stackoverflow.com/questions/50478119/measuring-time-spent-executing-function/50478867#50478867", "title": "Measuring Time Spent Executing Function", "body": "<p>I'm more familiar with doing this on Windows using QueryPerformanceCounter, so I'm probably doing all sorts of bad stuff here, but the basic idea for measuring short loops:</p>\n\n<pre><code>int main()\n{\n  printf(\"Beginning prefixAverages2\\n\");\n  timespec begin, end;\n  clock_gettime(CLOCK_REALTIME, &amp;begin);\n  int *a1 = prefixAverages2(50000);\n  clock_gettime(CLOCK_REALTIME, &amp;end);\n  double time_spent = (end.tv_nsec - begin.tv_nsec) / 1000;\n  time_spent += (end.tv_sec - begin.tv_sec) *1000000;\n\n  free(a1);\n  printf (\"Time spent %f microseconds\", time_spent);\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>Beginning prefixAverages2\nTime spent 427.000000 microseconds\n</code></pre>\n\n<p>PS--It turns out <code>clock()</code> doesn't do wall time:  <a href=\"https://stackoverflow.com/questions/22661300/calculate-execution-time-when-sleep-is-used\">Calculate execution time when sleep() is used</a></p>\n"}], "owner": {"reputation": 7, "user_id": 9830598, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76ead5aab4bf1e664a2065693f87210c?s=128&d=identicon&r=PG&f=1", "display_name": "InfoSecNick", "link": "https://stackoverflow.com/users/9830598/infosecnick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "accepted_answer_id": 50478277, "answer_count": 2, "score": 0, "last_activity_date": 1527054368, "creation_date": 1527034318, "last_edit_date": 1527038695, "question_id": 50478119, "link": "https://stackoverflow.com/questions/50478119/measuring-time-spent-executing-function", "title": "Measuring Time Spent Executing Function", "body": "<p>edit: I've figured it out. The 2nd algorithm was running so efficiently that the time wasn't even being recorded with an input &lt; 100,000</p>\n\n<p>I'm trying to measure how long a certain algorithm that I have implemented in a function takes to execute. I've included <code>&lt;time.h&gt;</code> and I'm surrounding the function around <code>time_t</code> variables. It works great for my first implementation, but not my second.</p>\n\n<p>Do I need to close the clock stream (can't think of a better work)between uses? Kind of like how you close the <code>Scanner</code> stream in a Java program. Here's my code in case I am not explaining it well.</p>\n\n<pre><code>switch(choice) {\n    case 1:\n        printf(\"Beginning prefixAverages1\\n\");\n        clock_t begin1 = clock();\n        int *a1 = prefixAverages1(input);\n        clock_t end1 = clock();\n        double time_spent1 = (double)(end1 - begin1) * 1000.0 / CLOCKS_PER_SEC;\n        free(a1);\n        printf(\"Algorithm took %f milliseconds to execute \\n\", time_spent1);\n        break;\n    case 2:\n        printf(\"Beginning prefixAverages2\\n\");\n        clock_t begin2 = clock();\n        int *a2 = prefixAverages2(input);\n        clock_t end2 = clock();\n        double time_spent2 = (double)(end2 - begin2) * 1000.0 / CLOCKS_PER_SEC;\n        free(a2);\n        printf(\"Algorithm took %f milliseconds to execute \\n\", time_spent2);\n        break;\n    default:\n        printf(\"Invalid input!\");\n        break;\n}\n</code></pre>\n\n<p>Time is displayed properly in my 1st case, but not in the second. I've tried doing some research but I can't find anything particular to my scenario.</p>\n\n<p>When running case 1, depending on the input, I get a time between 600-1000 ms to run (which sounds about right). When I run case 2, regardless of the input, I get 00.000</p>\n\n<p>Here are my functions if that helps:</p>\n\n<pre><code>int* prefixAverages1(int input) {\n    int x[input];\n    int *a = malloc(input*sizeof(*a));\n    srand(time(NULL));  \n\n    for(int i = 0; i &lt; input; i++) {\n        int sum = 0;\n        for(int j = 0; j &lt; i; j++) {\n            int r = rand() % 100;\n            x[j] = r;\n            sum = sum + x[j];\n        }\n        a[i] = sum / (i+1);\n    }\n    return a;\n}\n\nint* prefixAverages2(int input) {\n    int sum = 0;\n    int x[input];\n    int *a = malloc(input*sizeof(*a));\n    srand(time(NULL));  \n\n    for(int i = 0; i &lt; input; i++) {\n        int r = rand() % 100;\n        x[i] = r;\n        sum = sum + x[i];\n        a[i] = sum / (i+1);\n    }\n    return a;\n}\n</code></pre>\n"}, {"tags": ["c", "openmp", "dijkstra"], "comments": [{"owner": {"reputation": 332, "user_id": 8137872, "user_type": "registered", "accept_rate": 79, "profile_image": "https://graph.facebook.com/10213146126271038/picture?type=large", "display_name": "Joseph Franciscus", "link": "https://stackoverflow.com/users/8137872/joseph-franciscus"}, "edited": false, "score": 2, "creation_date": 1527034523, "post_id": 50478098, "comment_id": 87969831, "body": "Sometimes the overhead multithreading itself (spawning threads generally) outweighs the speed boost, though its also relevant to know what is your method for benchmarking and the number of nodes you are testing on."}, {"owner": {"reputation": 136, "user_id": 5041260, "user_type": "registered", "profile_image": "https://graph.facebook.com/499968856839050/picture?type=large", "display_name": "Mario Flores", "link": "https://stackoverflow.com/users/5041260/mario-flores"}, "reply_to_user": {"reputation": 332, "user_id": 8137872, "user_type": "registered", "accept_rate": 79, "profile_image": "https://graph.facebook.com/10213146126271038/picture?type=large", "display_name": "Joseph Franciscus", "link": "https://stackoverflow.com/users/8137872/joseph-franciscus"}, "edited": false, "score": 0, "creation_date": 1527034571, "post_id": 50478098, "comment_id": 87969842, "body": "I am using clock() to measure time and the graph has 10,000 nodes"}, {"owner": {"reputation": 332, "user_id": 8137872, "user_type": "registered", "accept_rate": 79, "profile_image": "https://graph.facebook.com/10213146126271038/picture?type=large", "display_name": "Joseph Franciscus", "link": "https://stackoverflow.com/users/8137872/joseph-franciscus"}, "edited": false, "score": 2, "creation_date": 1527034838, "post_id": 50478098, "comment_id": 87969888, "body": "I think that&#39;s actually just too small to get performance increases, try with a larger amount.  Also some things that may help you.  <a href=\"https://stackoverflow.com/questions/10673732/openmp-time-and-clock-calculates-two-different-results\" title=\"openmp time and clock calculates two different results\">stackoverflow.com/questions/10673732/&hellip;</a>  <a href=\"https://unix.stackexchange.com/questions/80424/why-using-more-threads-makes-it-slower-than-using-less-threads\" title=\"why using more threads makes it slower than using less threads\">unix.stackexchange.com/questions/80424/&hellip;</a>"}, {"owner": {"reputation": 530, "user_id": 2394541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f9b9b9399b329591f7be92da1c5e442?s=128&d=identicon&r=PG", "display_name": "tim18", "link": "https://stackoverflow.com/users/2394541/tim18"}, "edited": false, "score": 1, "creation_date": 1527038939, "post_id": 50478098, "comment_id": 87970724, "body": "As you are summing CPU times of all threads, it would be unusual to see a decrease with increased number of threads."}, {"owner": {"reputation": 1807, "user_id": 1900441, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa3540494c1cb556bf1f517992b172fe?s=128&d=identicon&r=PG", "display_name": "Jim Cownie", "link": "https://stackoverflow.com/users/1900441/jim-cownie"}, "edited": false, "score": 0, "creation_date": 1527069988, "post_id": 50478098, "comment_id": 87983921, "body": "This also looks racy. Consider what happens if two different nodes connect to the same third node. Given that &quot;notVisited[ct]&quot; is not updated, more than one thread can be assigning prev[ct] and dist[ct] at the same time!"}, {"owner": {"reputation": 29002, "user_id": 2542702, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fW5ka.jpg?s=128&g=1", "display_name": "Z boson", "link": "https://stackoverflow.com/users/2542702/z-boson"}, "edited": false, "score": 0, "creation_date": 1527075062, "post_id": 50478098, "comment_id": 87987244, "body": "What OS and compiler and compile options are you using.  <code>clock()</code> with *nix C runtimes does not measure the wall time. Consider using <code>omp_get_wtime()</code>."}, {"owner": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "edited": false, "score": 0, "creation_date": 1527119159, "post_id": 50478098, "comment_id": 88010740, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/10673732/openmp-time-and-clock-calculates-two-different-results\">OpenMP time and clock() calculates two different results</a>"}, {"owner": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "edited": false, "score": 1, "creation_date": 1527119269, "post_id": 50478098, "comment_id": 88010762, "body": "1) Fix the time measurement using <code>omp_get_wtime()</code>. 2) Prepare a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> including compilation command. 3) Show the specific results, system specs -&gt; edit the question or post a new one"}], "owner": {"reputation": 136, "user_id": 5041260, "user_type": "registered", "profile_image": "https://graph.facebook.com/499968856839050/picture?type=large", "display_name": "Mario Flores", "link": "https://stackoverflow.com/users/5041260/mario-flores"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 189, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1559246119, "creation_date": 1527034174, "last_edit_date": 1559246119, "question_id": 50478098, "link": "https://stackoverflow.com/questions/50478098/openmp-parallization-is-slower-than-sequential", "title": "OpenMP Parallization is slower than sequential", "body": "<p>I implemented the Dijkstra's algorithm In C. I'm trying to compare the runtime with and without using OpenMP, but for some reason OpenMP is always slower. I read something about how expensive new threads are but expanding the graph does not solve it. <br><br>I would like to use omp here</p>\n\n<pre><code>#pragma omp parallel for\nfor(index=0; index&lt;nodes[n].size; index++){\n        int ct = nodes[n].paths[index].connectsTo;\n        if(notVisited[ct]){\n            int dist = dis[n]+nodes[n].paths[index].weight;\n            if(dist&lt;dis[ct]){\n                prev[ct] = n;\n                dis[ct] = dist;\n            }\n        }\n    }\n</code></pre>\n"}, {"tags": ["c", "udp", "ip"], "answers": [{"tags": [], "owner": {"reputation": 7617, "user_id": 2878070, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/42b5fba5761d7e519d05b642be0b2e14?s=128&d=identicon&r=PG&f=1", "display_name": "Sergio", "link": "https://stackoverflow.com/users/2878070/sergio"}, "is_accepted": true, "score": 2, "last_activity_date": 1527039236, "creation_date": 1527039236, "answer_id": 50478613, "question_id": 50478030, "link": "https://stackoverflow.com/questions/50478030/address-family-not-supported-by-protocol-udp-c-error-sending/50478613#50478613", "title": "Address family not supported by protocol UDP C Error sending", "body": "<p>Your issue is likely because of uninitialized destination address. <code>sendto()</code> takes destination address as the one before the last argument. But you are trying to provide not-initialized address (like for <code>recvfrom()</code>)</p>\n\n<pre><code>    if( sendto( se1_sockfd, buf, BUFLEN, 0, (struct sockaddr*) &amp;cli1_addr, cli1_len) &lt; 0)\n        error (\"Error sending1\");\n                                                                  ^^^\n                                                        Try serv1_addr instead ?\n</code></pre>\n\n<p>Also need to provide appropriate size.</p>\n\n<p>One more thing. As long as you use <code>sendto()</code> - no need to perform <code>connect()</code>. UDP is connectionless and <code>connect()</code> only establishes default destination address for those who is going to use <code>send()</code> on such socket. But this is not your case because you provide destination address each time you call <code>sendto()</code>. Even more - you may use different addresses each time.</p>\n\n<p><strong>P.S.</strong> Reference: <a href=\"http://man7.org/linux/man-pages/man3/sendto.3p.html\" rel=\"nofollow noreferrer\">sendto()</a></p>\n"}], "owner": {"reputation": 25, "user_id": 8310190, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff1c983542db21801f7bb8593b9dfc9c?s=128&d=identicon&r=PG&f=1", "display_name": "Mateusz Turek", "link": "https://stackoverflow.com/users/8310190/mateusz-turek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 581, "favorite_count": 0, "accepted_answer_id": 50478613, "answer_count": 1, "score": 1, "last_activity_date": 1527039236, "creation_date": 1527033665, "question_id": 50478030, "link": "https://stackoverflow.com/questions/50478030/address-family-not-supported-by-protocol-udp-c-error-sending", "title": "Address family not supported by protocol UDP C Error sending", "body": "<p>I'm trying to implement communication by UDP protocol, and I'm getting an error: <strong>\"Error sending: Address family not supported by protocol\"</strong>. I've checked in Google for this problem but couldn't managed to find answer. \nPlease be patient, I'm only starting my adventure with coding in C.\nHere is a C code: </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;netinet/in.h&gt;\n#include &lt;netdb.h&gt;\n#include &lt;arpa/inet.h&gt;\n\n#define BUFLEN 512\n\n// define function that deals with errors\nvoid error(const char *msg)\n{\n    perror(msg); // print error msg\n    exit(1); // exit the main() function\n}\n\nint main(int argc, char *argv[])\n{\n    struct sockaddr_in serv1_addr, serv2_addr, cli1_addr, cli2_addr; //definicja struktur adres\u00f3w servera i clienta \n    struct hostent *server; //defines host addres struct\n    int cl1_sockfd, se1_sockfd, se2_sockfd, i, c1len = sizeof(cli1_addr), c2len = sizeof(cli2_addr), recv_len, portno1,portno2; // creates inits\n    int cli1_len = sizeof(cli1_addr);\n    int cli2_len = sizeof(cli2_addr);\n\n    char buf[BUFLEN];\n\n    if (argc &lt; 4) {\n        fprintf(stderr,\"ERROR, no port provided\\n\"); // deal with wrong port\n        exit(1);\n    }\n\n    //tworzenie soceketu servera \n    if ((se1_sockfd = socket(AF_INET, SOCK_DGRAM, IPPROTO_UDP)) == -1){\n        error(\"socket1\");   //if socket() return -1 -- error\n    }\n    if ((se2_sockfd = socket(AF_INET, SOCK_DGRAM, IPPROTO_UDP)) == -1){\n        error(\"socket2\");   //if socket() return -1 -- error\n    }\n\n    //zero out the structure\n    memset( &amp;serv1_addr, 0, sizeof(serv1_addr)); //put zero into structure\n    memset( &amp;serv2_addr, 0, sizeof(serv2_addr)); //put zero into structure\n\n    portno1 = atoi(argv[2]); // get port number\n    portno2 = atoi(argv[3]);\n\n\n    serv1_addr.sin_family = AF_INET; // specify address family (IPv4)\n    serv1_addr.sin_addr.s_addr = inet_addr(\"127.0.0.1\");\n    serv1_addr.sin_port = htons(portno1); // set port number\n\n    serv2_addr.sin_family = AF_INET; // specify address family (IPv4)\n    serv2_addr.sin_addr.s_addr = inet_addr(\"127.0.0.1\"); \n    serv2_addr.sin_port = htons(portno2); // set port number\n\n    if(connect(se1_sockfd,(struct sockaddr *) &amp;serv1_addr, sizeof(serv1_addr)) &lt; 0)\n        error (\"ERROR connecting1\"); //if connection failed\n\n    if(connect(se2_sockfd,(struct sockaddr *) &amp;serv2_addr, sizeof(serv2_addr)) &lt; 0)\n        error (\"ERROR connecting2\"); //if connection failed\n    while(1) //inf loop\n    {\n        printf(\"Please enter the message: \"); //write the msg to socket\n        bzero(buf, 512); //fill buffer with zeros\n        fgets(buf, 512, stdin); //read into buffer\n\n\n\n        if( sendto( se1_sockfd, buf, BUFLEN, 0, (struct sockaddr*) &amp;cli1_addr, cli1_len) &lt; 0)\n            error (\"Error sending1\"); \n        if( sendto( se2_sockfd, buf, BUFLEN, 0, (struct sockaddr*) &amp;cli2_addr, cli2_len) &lt; 0)\n            error (\"Error sending2\"); \n\n\n        if (recvfrom(se1_sockfd, buf, BUFLEN, 0, (struct sockaddr *) &amp;cli1_addr, &amp;cli1_len) == -1){\n            error(\"recivfrom()1\"); //if reciving failed -- error    \n        }\n        printf(\"Data: %s\\n\", buf);\n\n        if (recvfrom(se2_sockfd, buf, BUFLEN, 0, (struct sockaddr *) &amp;cli2_addr, &amp;cli2_len) == -1){\n            error(\"recivfrom()2\"); //if reciving failed -- error    \n        }\n        printf(\"Data: %s\\n\", buf);\n\n    }   \n\n    close(se1_sockfd);\n    close(se2_sockfd);\n    return 0;\n} \n</code></pre>\n\n<p>Thanks for your help. ;)</p>\n"}, {"tags": ["c", "unix", "posix"], "comments": [{"owner": {"reputation": 5219, "user_id": 1166774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2186f597c73ae03edf7912fa5ec93cc7?s=128&d=identicon&r=PG&f=1", "display_name": "LoztInSpace", "link": "https://stackoverflow.com/users/1166774/loztinspace"}, "edited": false, "score": 1, "creation_date": 1527031526, "post_id": 50477737, "comment_id": 87969078, "body": "how is <code>s</code> defined?  What is the output that isn&#39;t right and what do you expect?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1527031657, "post_id": 50477737, "comment_id": 87969120, "body": "Are you <i>sure</i> nothing is sent to <code>stdout</code>?  Not even, say, non-printing characters?"}, {"owner": {"reputation": 330, "user_id": 4454877, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0129832b19e0227f7085a5782b34b85?s=128&d=identicon&r=PG&f=1", "display_name": "Retr0id", "link": "https://stackoverflow.com/users/4454877/retr0id"}, "edited": false, "score": 0, "creation_date": 1527031694, "post_id": 50477737, "comment_id": 87969133, "body": "What is <code>STDOUT_FILENO</code> defined as?"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1527031701, "post_id": 50477737, "comment_id": 87969135, "body": "You wrote <code>fprintf(stderr, &quot;%d\\n&quot;, i)</code> and said in your comment that it &quot;correctly prints out the string&quot;, but <code>%d</code> does not print out a string!  Nor is it printing out the characters of the string -- it&#39;s just printing &quot;0 1 2...&quot; up to the number of characters in the string.  WHat does the array <code>s</code> actually contain?"}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 1, "creation_date": 1527031705, "post_id": 50477737, "comment_id": 87969138, "body": "Looks like <code>s</code> is a string (char array) and <code>&amp;s</code> should be <code>&amp;s[i]</code>."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1527031794, "post_id": 50477737, "comment_id": 87969159, "body": "I second R&#39;s suggestion.  Try <code>write(STDOUT_FILENO, s+i, 1)</code>.  And if that works, skip the loop and try <code>write(STDOUT_FILENO, s, strlen(s))</code>."}, {"owner": {"reputation": 508, "user_id": 8468636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48abbf00456ad4b2fbfe9c11fd675b94?s=128&d=identicon&r=PG&f=1", "display_name": "K-Log", "link": "https://stackoverflow.com/users/8468636/k-log"}, "edited": false, "score": 0, "creation_date": 1527031832, "post_id": 50477737, "comment_id": 87969171, "body": "I updated my question so hopefully it is more clear what i&#39;m asking."}, {"owner": {"reputation": 28330, "user_id": 298054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7dffcc86140441472cfb6119375a9d7?s=128&d=identicon&r=PG", "display_name": "jweyrich", "link": "https://stackoverflow.com/users/298054/jweyrich"}, "edited": false, "score": 2, "creation_date": 1527031838, "post_id": 50477737, "comment_id": 87969173, "body": "And <code>sizeof(s)</code> should be <code>strlen(s)</code>?"}, {"owner": {"reputation": 508, "user_id": 8468636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48abbf00456ad4b2fbfe9c11fd675b94?s=128&d=identicon&r=PG&f=1", "display_name": "K-Log", "link": "https://stackoverflow.com/users/8468636/k-log"}, "edited": false, "score": 0, "creation_date": 1527031881, "post_id": 50477737, "comment_id": 87969184, "body": "I have used both <code>sizeof</code> and <code>strlen</code> and didn&#39;t notice a difference. Either way the <code>fprintf</code> works but <code>write</code> does not."}, {"owner": {"reputation": 330, "user_id": 4454877, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0129832b19e0227f7085a5782b34b85?s=128&d=identicon&r=PG&f=1", "display_name": "Retr0id", "link": "https://stackoverflow.com/users/4454877/retr0id"}, "edited": false, "score": 0, "creation_date": 1527032052, "post_id": 50477737, "comment_id": 87969227, "body": "@K-Log this is a bit of a waste of time if you don&#39;t show your full code. <code>sizeof</code> and <code>strlen</code> are fundamentally different, I suggest you research the difference before picking one at random."}, {"owner": {"reputation": 508, "user_id": 8468636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48abbf00456ad4b2fbfe9c11fd675b94?s=128&d=identicon&r=PG&f=1", "display_name": "K-Log", "link": "https://stackoverflow.com/users/8468636/k-log"}, "reply_to_user": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1527032137, "post_id": 50477737, "comment_id": 87969248, "body": "@SteveSummit I tried both of your suggestions but neither produced any output to the console."}, {"owner": {"reputation": 508, "user_id": 8468636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48abbf00456ad4b2fbfe9c11fd675b94?s=128&d=identicon&r=PG&f=1", "display_name": "K-Log", "link": "https://stackoverflow.com/users/8468636/k-log"}, "reply_to_user": {"reputation": 330, "user_id": 4454877, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0129832b19e0227f7085a5782b34b85?s=128&d=identicon&r=PG&f=1", "display_name": "Retr0id", "link": "https://stackoverflow.com/users/4454877/retr0id"}, "edited": false, "score": 0, "creation_date": 1527032210, "post_id": 50477737, "comment_id": 87969261, "body": "@Retr0id I would but my full code is very long and has very little to due with what I&#39;m asking aside from existing in the same program."}, {"owner": {"reputation": 897, "user_id": 3830887, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9aa739aedfb6760abc3605091e12810e?s=128&d=identicon&r=PG&f=1", "display_name": "TonyB", "link": "https://stackoverflow.com/users/3830887/tonyb"}, "edited": false, "score": 0, "creation_date": 1527032790, "post_id": 50477737, "comment_id": 87969399, "body": "Problems statements should  <a href=\"https://stackoverflow.com/help/mcve\">include MCVE</a>"}], "answers": [{"comments": [{"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1527038649, "post_id": 50478523, "comment_id": 87970644, "body": "I doubt this is the problem. <code>STDOUT_FILENO</code> is defined in unistd.h and will be correct unless you un- and re-defined it."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "reply_to_user": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1527038920, "post_id": 50478523, "comment_id": 87970719, "body": "@R.. I doubt it, too, but the OP claims that <code>write(STDOUT_FILENO, s, strlen(s))</code> didn&#39;t work, so I&#39;m exploring options..."}, {"owner": {"reputation": 508, "user_id": 8468636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48abbf00456ad4b2fbfe9c11fd675b94?s=128&d=identicon&r=PG&f=1", "display_name": "K-Log", "link": "https://stackoverflow.com/users/8468636/k-log"}, "edited": false, "score": 0, "creation_date": 1527039454, "post_id": 50478523, "comment_id": 87970869, "body": "I have tried use 1 &amp; 2 instead of STDOUT/STDIN and neither produced any output. I also tried your other suggestions and am still getting no output. I don\u2019t know if this was clear in my question but only stderr with fprintf seems to work for printing to the console."}], "tags": [], "owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "is_accepted": true, "score": 1, "last_activity_date": 1527038815, "last_edit_date": 1527038815, "creation_date": 1527038467, "answer_id": 50478523, "question_id": 50477737, "link": "https://stackoverflow.com/questions/50477737/unable-use-write-to-write-to-standard-out/50478523#50478523", "title": "Unable use write() to write to standard out", "body": "<p>There are some details missing, but based on what you've posted so far, this ought to work:</p>\n\n<pre><code>void myfunction(char *s, int fd, int n) {\n\n    if( write(fd, s, strlen(s)) &lt; 0) {\n         perror(\"Error: Write problems.\");\n    }\n\n    wastesometime(n);\n}\n</code></pre>\n\n<p>Let's make sure we understand what's going on here.  Within <code>myfunction</code>, the argument <code>s</code> is a pointer to <code>char</code>, and more specifically, it points to the first character of a null-terminated array of characters, which is C's definition of a string.</p>\n\n<p>The <code>write</code> function you're trying to use also accepts a pointer to <code>char</code>.  However, it does not insist (or expect) that the pointer be specifically to a null-terminated string; it can be a pointer to any array of characters.  Since <code>write</code> does not assume a null-terminated string, you must tell it precisely how many characters you want it to write.</p>\n\n<p>Since you're starting with a null-terminated string, you can compute the actual number of characters in the string (which is precisely the number you need to pass as the third argument to <code>write</code>) by calling the standard <code>strlen</code> function, as I've shown.</p>\n\n<p>Your problem may have something to do with <code>STDOUT_FILENO</code> not being defined correctly.  Please try all four of these calls:</p>\n\n<pre><code>myfunction(buffer, 1, n);\n\nmyfunction(buffer, 2, n);\n\nmyfunction(buffer, fileno(stdout), n);\n\nprintf(\"STDOUT_FILENO = %d\\n\", STDOUT_FILENO);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 508, "user_id": 8468636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48abbf00456ad4b2fbfe9c11fd675b94?s=128&d=identicon&r=PG&f=1", "display_name": "K-Log", "link": "https://stackoverflow.com/users/8468636/k-log"}, "edited": false, "score": 0, "creation_date": 1527039270, "post_id": 50478586, "comment_id": 87970815, "body": "I already tried 1 instead of STDOUT_FILENO and it still produced no output along. s + i had no effect either."}, {"owner": {"reputation": 54, "user_id": 9831564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fc63ed4324c7ac999cf3486b1022e9d?s=128&d=identicon&r=PG&f=1", "display_name": "Eskombro", "link": "https://stackoverflow.com/users/9831564/eskombro"}, "reply_to_user": {"reputation": 508, "user_id": 8468636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48abbf00456ad4b2fbfe9c11fd675b94?s=128&d=identicon&r=PG&f=1", "display_name": "K-Log", "link": "https://stackoverflow.com/users/8468636/k-log"}, "edited": false, "score": 0, "creation_date": 1527040389, "post_id": 50478586, "comment_id": 87971090, "body": "sizeof(s) will return the size of a pointer, you should use &quot;i &lt; strlen(s)&quot; to get the size of your string. But the main problem in your loop is definitely &amp;s"}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1527044560, "post_id": 50478586, "comment_id": 87971913, "body": "@Eskombro: Only if <code>s</code> is a pointer. Presumably it&#39;s an array."}, {"owner": {"reputation": 54, "user_id": 9831564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fc63ed4324c7ac999cf3486b1022e9d?s=128&d=identicon&r=PG&f=1", "display_name": "Eskombro", "link": "https://stackoverflow.com/users/9831564/eskombro"}, "edited": false, "score": 0, "creation_date": 1527089522, "post_id": 50478586, "comment_id": 87997452, "body": "In the function parameter s is a char*, so a pointer, isn&#39;t it?"}], "tags": [], "owner": {"reputation": 54, "user_id": 9831564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fc63ed4324c7ac999cf3486b1022e9d?s=128&d=identicon&r=PG&f=1", "display_name": "Eskombro", "link": "https://stackoverflow.com/users/9831564/eskombro"}, "is_accepted": false, "score": 1, "last_activity_date": 1527039351, "last_edit_date": 1527039351, "creation_date": 1527039023, "answer_id": 50478586, "question_id": 50477737, "link": "https://stackoverflow.com/questions/50477737/unable-use-write-to-write-to-standard-out/50478586#50478586", "title": "Unable use write() to write to standard out", "body": "<pre><code>void myfunction(char *s, int fd, int n)\n{\n    for (int i = 0; i &lt; strlen(s); i++)\n    {\n        if (write(fd, s + i, 1) &lt; 0)\n        {\n             perror(\"Error: Write problems.\");\n        }\n        sleep(n);\n    }\n}\n</code></pre>\n\n<p>You don't need to send &amp;s to write, because s is already a pointer, already contains an adress... and sending &amp;s is like sending the adress of an adress... Also, dont forget to increment that adress s in your loop or you will write the same character over and over.</p>\n\n<p>When you use printf (or any of its variants), you can use %c to print a character, you use %s to print a string (char *)</p>\n"}], "owner": {"reputation": 508, "user_id": 8468636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48abbf00456ad4b2fbfe9c11fd675b94?s=128&d=identicon&r=PG&f=1", "display_name": "K-Log", "link": "https://stackoverflow.com/users/8468636/k-log"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "accepted_answer_id": 50478523, "answer_count": 2, "score": -3, "last_activity_date": 1527043812, "creation_date": 1527031210, "last_edit_date": 1527033021, "question_id": 50477737, "link": "https://stackoverflow.com/questions/50477737/unable-use-write-to-write-to-standard-out", "title": "Unable use write() to write to standard out", "body": "<p>I'm trying to use write() to write a char to standard out one byte at a time. The program compiles and runs fine but the output isn't turning out quite right. Now I'm trying to get it to run with write but I'm not getting any output in the console.</p>\n\n<pre><code>void myfunction(char *s, int fd, int n){\n\n    for(int i = 0; i != sizeof(s) - 1; ++i){\n        fprintf(stderr, \"%s\\n\", &amp;s[i]);  // This correctly prints out the string\n\n        if( write(fd, &amp;s, 1) &lt; 0){ // This will not print to the console\n             perror(\"Error: Write problems.\");  // Have not gotten any errors yet   \n        }\n\n        wastesometime(n);  // This just calls a for loop that runs n times\n    }\n}\n\n\nsizeN = sprintf(buffer, \"This is process %d with ID %ld and parent id %ld\\n\", i, (long)getpid(), (long)getppid());\n\nmyfunction(buffer, STDOUT_FILENO, n);\n</code></pre>\n\n<p>Currently I'm getting output in the form of this from fprintf:</p>\n\n<pre><code>process 2 with ID 27711 and parent id 27710\nrocess 2 with ID 27711 and parent id 27710\nocess 2 with ID 27711 and parent id 27710\ncess 2 with ID 27711 and parent id 27710\ness 2 with ID 27711 and parent id 27710\nss 2 with ID 27711 and parent id 27710\ns 2 with ID 27711 and parent id 27710\n 2 with ID 27711 and parent id 27710\n2 with ID 27711 and parent id 27710\n with ID 27711 and parent id 27710\nwith ID 27711 and parent id 27710\nith ID 27711 and parent id 27710\nth ID 27711 and parent id 27710\nh ID 27711 and parent id 27710\n ID 27711 and parent id 27710\nID 27711 and parent id 27710\nD 27711 and parent id 27710\n 27711 and parent id 27710\n27711 and parent id 27710\n7711 and parent id 27710\n711 and parent id 27710\n11 and parent id 27710\n1 and parent id 27710\n and parent id 27710\nand parent id 27710\nnd parent id 27710\nd parent id 27710\n parent id 27710\nparent id 27710\narent id 27710\nrent id 27710\nent id 27710\nnt id 27710\nt id 27710\n id 27710\nid 27710\nd 27710\n 27710\n27710\n7710\n710\n10\n0\n</code></pre>\n\n<p>But I am trying to get this output using write instead of fprintf, for every process:</p>\n\n<pre><code>This is process 2 with ID 27711 and parent id 27710   \n</code></pre>\n\n<p>This may be relevant but <code>fprintf(stderr, %d\\n\", &amp;s[i])</code> works and <code>fprintf(stdout, %d\\n\", &amp;s[i])</code>? I believe <code>stderr</code> gets priority but I didn't think that the other output wouldn't get printed at all? </p>\n\n<p>Yes, I have done some research but most answers I've found use <code>fwrite()</code> or are in C++ and are therefore not what I'm looking for.</p>\n"}, {"tags": ["c", "sockets", "select", "block"], "comments": [{"owner": {"reputation": 5010, "user_id": 3150445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bfca2588483eadf6695a120cbcef1f8?s=128&d=identicon&r=PG&f=1", "display_name": "jwdonahue", "link": "https://stackoverflow.com/users/3150445/jwdonahue"}, "edited": false, "score": 0, "creation_date": 1527030432, "post_id": 50477356, "comment_id": 87968797, "body": "Read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>, and <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>.  Hard to debug code we can&#39;t compile, particularly hard when we don&#39;t have access to some of the important bits."}], "answers": [{"tags": [], "owner": {"reputation": 56858, "user_id": 131930, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/91536fe27d32713b8a154a0bf42f6748?s=128&d=identicon&r=PG", "display_name": "Jeremy Friesner", "link": "https://stackoverflow.com/users/131930/jeremy-friesner"}, "is_accepted": true, "score": 2, "last_activity_date": 1527034216, "creation_date": 1527034216, "answer_id": 50478102, "question_id": 50477356, "link": "https://stackoverflow.com/questions/50477356/select-blocks-when-trying-to-read-activity-from-file-descriptors/50478102#50478102", "title": "Select blocks when trying to read activity from file descriptors", "body": "<p>Your problem is here:</p>\n\n<pre><code>FD_ZERO(&amp;set);\nFD_SET(fd_serv, &amp;set);\nFD_SET(fd_comm, &amp;set); \nwhile (1) \n{\n   [...]\n</code></pre>\n\n<p>You are only setting up your <code>fd_set</code> once, but your <code>fd_set</code> will be modified by the <code>select()</code> call, so you need to set it up once per iteration of your loop.  Try this instead:</p>\n\n<pre><code>while (1) \n{\n   FD_ZERO(&amp;set);\n   FD_SET(fd_serv, &amp;set);\n   FD_SET(fd_comm, &amp;set); \n   const int max_fd = (fd_serve &gt; fd_comm) ? fd_serve : fd_comm;\n   [...]\n</code></pre>\n\n<p>... after the <code>select()</code> call, the only <code>select()</code>-related thing you should be calling is <code>FD_ISSET()</code>.  All the other stuff is pointless, since your additional <code>FD_SET()</code> and <code>FD_CLR()</code> calls are modifying an <code>fd_set</code> that you're just going to wipe clean with the <code>FD_ZERO()</code> call at the beginning of the next while-loop iteration.</p>\n\n<p>Also, as a side note:  that <code>usleep(10000)</code> call should go away -- if you're calling <code>select()</code> correctly, sleeping for arbitrary time periods outside of <code>select()</code> is neither necessary nor desirable.</p>\n"}], "owner": {"reputation": 119, "user_id": 9773515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15d5cbcb616fc6782e369993022a01c1?s=128&d=identicon&r=PG&f=1", "display_name": "Darren Col", "link": "https://stackoverflow.com/users/9773515/darren-col"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 210, "favorite_count": 0, "accepted_answer_id": 50478102, "answer_count": 1, "score": 0, "last_activity_date": 1527034216, "creation_date": 1527028548, "question_id": 50477356, "link": "https://stackoverflow.com/questions/50477356/select-blocks-when-trying-to-read-activity-from-file-descriptors", "title": "Select blocks when trying to read activity from file descriptors", "body": "<p>I am trying to create a server that accepts multiple clients. Here is a part of my code. My server needs to <code>listen</code> to two <code>ports</code>. The <code>sockets</code> that achieve this are <code>fd_serv</code> and <code>fd_comm</code>.</p>\n\n<p>Using <code>select</code> and <code>nonblock</code> file descriptors, unfortunately does not give me the desired output. The problems are that <code>select</code> <code>accepts</code> the first <code>client</code> and then blocks, and doesn't read messages from other <code>clients</code>.</p>\n\n<p>Also for some reason if I don't use the <code>usleep(100000)</code> command, my program succeeds accepting but doesn't go on.</p>\n\n<p>Any help appreciated.</p>\n\n<pre><code>FD_ZERO(&amp;set);\nFD_SET(fd_serv, &amp;set);\nFD_SET(fd_comm, &amp;set); \nwhile (1)\n    {\n    if (select (max_fd + 1, &amp;set, NULL, NULL, NULL) &lt; 0)\n    {\n        perror (\"select\");\n        exit (EXIT_FAILURE);\n    }\n\n    for (i = 1; i &lt; max_fd + 1; i++)\n    {\n        usleep(100000);\n        if (FD_ISSET (i, &amp;set))\n        {\n            if (i == fd_serv)       //Connection request on original socket.\n            {\n                new_serv = accept (fd_serv, (struct sockaddr *) &amp;client_serv_addr, &amp;sin_len_serv);\n                if (new_serv &lt; 0){ perror (\"accept\"); exit (EXIT_FAILURE); }\n                fd_set_blocking(new_serv, 0);\n                FD_SET(new_serv, &amp;set);\n                max_fd = max(max_fd, new_serv);\n            }\n            else if (i == fd_comm)  //Connection request on original socket.\n            {\n                new_comm = accept (fd_comm, (struct sockaddr *) &amp;client_comm_addr, &amp;sin_len_comm);\n                if (new_comm &lt; 0){ perror (\"accept\"); exit (EXIT_FAILURE); }\n                fd_set_blocking(new_comm, 0);\n                FD_SET (new_comm, &amp;set);\n                max_fd = max(max_fd, new_comm);\n            }\n            else if (i == new_comm) //Activity on already connected socket\n            {\n                if (read_command(fd_comm, i, start_time) == 1)\n                {\n                    close(i);\n                    FD_CLR(i, &amp;set);\n                    return SHUTDOWN;\n                }\n            }\n            else if (i == new_serv) //Activity on already connected socket\n            {\n                read_service(i);\n                close(i);\n                FD_CLR(i, &amp;set);\n            }\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "scanf"], "comments": [{"owner": {"reputation": 461, "user_id": 3846286, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c08598e91102b796103792b17ad3abe4?s=128&d=identicon&r=PG&f=1", "display_name": "chilliefiber", "link": "https://stackoverflow.com/users/3846286/chilliefiber"}, "reply_to_user": {"reputation": 6975, "user_id": 3121023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f52448806175b9aa66c86d40cf0829f1?s=128&d=identicon&r=PG&f=1", "display_name": "user3121023", "link": "https://stackoverflow.com/users/3121023/user3121023"}, "edited": false, "score": 0, "creation_date": 1527027600, "post_id": 50477114, "comment_id": 87968009, "body": "@user3121023 so what am I supposed to do to fix that?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1527027970, "post_id": 50477114, "comment_id": 87968117, "body": "... and of course, the matter of reading a line at a time or not is orthogonal to the matter of using input field directives that won&#39;t match the trailing &#39;E&#39; in your longitudes."}], "answers": [{"tags": [], "owner": {"reputation": 4598, "user_id": 9264702, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mHczh.jpg?s=128&g=1", "display_name": "Stephen Docy", "link": "https://stackoverflow.com/users/9264702/stephen-docy"}, "is_accepted": true, "score": 2, "last_activity_date": 1527028035, "creation_date": 1527028035, "answer_id": 50477290, "question_id": 50477114, "link": "https://stackoverflow.com/questions/50477114/sscanf-not-reading-identical-lines-the-same-way/50477290#50477290", "title": "Sscanf not reading identical lines the same way", "body": "<p>As mentioned in the comments, the <code>E</code> is being read as part of the float.  You can use this code to read the float as a string and then convert it to a float:</p>\n\n<pre><code>void printLine(char* line) {\n    char lat, lon;\n    unsigned int year, month, day;\n    float temp, uncertainty;\n    char latitude[100], longitude[100];\n    float latFloat, longFloat;\n    char country[100], city[100];\n    char blah[100];\n    int result;\n    result = sscanf(line, \"%u-%u-%u,%f,%f,%[^,],%[^,],%[0-9.]%c,%[0-9.]%c\", &amp;year,\n        &amp;month, &amp;day, &amp;temp, &amp;uncertainty, city, country, latitude, &amp;lat, longitude, &amp;lon);\n\n    latFloat = atof(latitude);\n    longFloat = atof(longitude);\n\n    printf(\"%u-%u-%u,%f,%f,%s,%s,%f%c,%f%c\\n\", year, month, day, temp, uncertainty,\n        city, country, latFloat, lat, longFloat, lon);\n\n    printf(\"sscanf read %i variables\\n\", result);\n}\n</code></pre>\n"}], "owner": {"reputation": 461, "user_id": 3846286, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c08598e91102b796103792b17ad3abe4?s=128&d=identicon&r=PG&f=1", "display_name": "chilliefiber", "link": "https://stackoverflow.com/users/3846286/chilliefiber"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 1, "accepted_answer_id": 50477290, "answer_count": 1, "score": 3, "last_activity_date": 1527053017, "creation_date": 1527026799, "last_edit_date": 1527053017, "question_id": 50477114, "link": "https://stackoverflow.com/questions/50477114/sscanf-not-reading-identical-lines-the-same-way", "title": "Sscanf not reading identical lines the same way", "body": "<pre><code>#include &lt;stdlib.h&gt;\n\nvoid printLine(char* line) {\n     char lat, lon;\n     unsigned int year, month, day;\n     float temp, uncertainty, latitude, longitude;\n     char country[100], city[100];\n     int result;\n\n     result = sscanf(line, \"%u-%u-%u,%f,%f,%[^,],%[^,],%f%c,%f%c\", &amp;year,\n         &amp;month,&amp;day, &amp;temp, &amp;uncertainty, city, country, &amp;latitude, &amp;lat, &amp;longitude, &amp;lon);\n\n     printf(\"%u-%u-%u,%f,%f,%s,%s,%f%c,%f%c\\n\", year, month, day, temp, uncertainty,\n         city, country, latitude, lat, longitude, lon);\n\n     printf(\"sscanf read %i variables\\n\", result);\n}\nint main() {\n    char line[] = \"2013-08-01,19.005,3.621,Addis Abeba,Ethiopia,8.84N,38.11E\";\n    char line2[] = \"1816-03-01,27.426,1.793,Bangkok,Thailand,13.66N,99.91E\";\n    char line3[] = \"1743-11-01,3.264,1.665,New York,United States,40.99N,74.56W\";\n\n    printLine(line);\n    printLine(line2);\n    printLine(line3);\n}\n</code></pre>\n\n<p>Some lines it reads properly and some lines it doesn't read the last character. I'm not sure what causes this bug, I'm probably invoking some sort of undefined behaviour but I'm not sure what it is.</p>\n"}, {"tags": ["c", "string", "char", "malloc"], "comments": [{"owner": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "edited": false, "score": 3, "creation_date": 1527023881, "post_id": 50476551, "comment_id": 87966694, "body": "<a href=\"https://en.cppreference.com/w/c/string/byte/strlen\" rel=\"nofollow noreferrer\"><code>strlen()</code></a>"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1527023885, "post_id": 50476551, "comment_id": 87966696, "body": "Maybe the <code>strlen()</code> function?"}, {"owner": {"reputation": 1, "user_id": 9830984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51c57e40c7a4d5b717f234b76d196aab?s=128&d=identicon&r=PG&f=1", "display_name": "Anika", "link": "https://stackoverflow.com/users/9830984/anika"}, "edited": false, "score": 0, "creation_date": 1527025092, "post_id": 50476551, "comment_id": 87967158, "body": "Thanks for the strlen() mention, I could only think about allocated space and such, I totally forgot about that function. Maybe you could post it as an answer so that I can upvote it and mark it as accepted?"}], "answers": [{"comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 2, "creation_date": 1527024099, "post_id": 50476592, "comment_id": 87966779, "body": "You <i>could</i> do it with a <code>for</code> loop, but a call to <code>strlen()</code> is easier both to write and to read."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 1, "creation_date": 1527024815, "post_id": 50476592, "comment_id": 87967067, "body": "nor <code>int</code> but <code>size_t</code>"}], "tags": [], "owner": {"reputation": 161, "user_id": 8868682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cdee0740030935980754045e2d6aeb0?s=128&d=identicon&r=PG&f=1", "display_name": "engelant", "link": "https://stackoverflow.com/users/8868682/engelant"}, "is_accepted": false, "score": 0, "last_activity_date": 1527024643, "last_edit_date": 1527024643, "creation_date": 1527023946, "answer_id": 50476592, "question_id": 50476551, "link": "https://stackoverflow.com/questions/50476551/how-do-i-calculate-the-number-of-chars-in-a-string-if-not-all-the-space-is-take/50476592#50476592", "title": "How do I calculate the number of chars in a string (if not all the space is taken)", "body": "<p>You have to find the null terminator.</p>\n\n<pre><code>int i = 0;\nwhile(input[i] != 0) {\n    ++i;\n}\n//i marks the spot\n</code></pre>\n\n<p>But yeah, strlen() does a better job, since it has some improved/optimized searching, since it uses word(16/32/64? bit) compare and stuff.</p>\n"}], "owner": {"reputation": 1, "user_id": 9830984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51c57e40c7a4d5b717f234b76d196aab?s=128&d=identicon&r=PG&f=1", "display_name": "Anika", "link": "https://stackoverflow.com/users/9830984/anika"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "closed_date": 1527025270, "answer_count": 1, "score": -3, "last_activity_date": 1527024643, "creation_date": 1527023698, "last_edit_date": 1527024322, "question_id": 50476551, "link": "https://stackoverflow.com/questions/50476551/how-do-i-calculate-the-number-of-chars-in-a-string-if-not-all-the-space-is-take", "closed_reason": "Duplicate", "title": "How do I calculate the number of chars in a string (if not all the space is taken)", "body": "<p>I have this piece of code:</p>\n\n<pre><code>char* input = malloc(sizeof(char)*100);\nscanf(\"%s\", input);        //let's say that the number of chars in \"%s\" is 5\n</code></pre>\n\n<p>How do I calculate how many chars I typed in (5)? I tried by playing around with sizeof(), but couldn't find a solution.</p>\n\n<p>Edit (better explanation): the input variable can host up to 100 chars, but let's say I type in the terminal 'abcde': then it hosts only 5 chars, the other 95 are not taken. I want to calculate that '5'.</p>\n"}, {"tags": ["c", "winapi", "mingw", "mingw-w64", "mingw32"], "comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1527027342, "post_id": 50476378, "comment_id": 87967916, "body": "MinGW is dead, use mingw-w64"}], "answers": [{"comments": [{"owner": {"reputation": 11238, "user_id": 7594711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7872c871b0431b72df6350dd0394bea?s=128&d=identicon&r=PG&f=1", "display_name": "SoronelHaetir", "link": "https://stackoverflow.com/users/7594711/soronelhaetir"}, "edited": false, "score": 0, "creation_date": 1527029263, "post_id": 50477077, "comment_id": 87968491, "body": "An expansion of what Remy Lebeau  said is that the SDK as shipped makes use of a large number of VC++ extensions to the core C alanguage. Some of these are understood by gcc and clang (the __declspec(dllimport) syntax as an example), others aare not (most other __declspec specifiers)."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 11238, "user_id": 7594711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7872c871b0431b72df6350dd0394bea?s=128&d=identicon&r=PG&f=1", "display_name": "SoronelHaetir", "link": "https://stackoverflow.com/users/7594711/soronelhaetir"}, "edited": false, "score": 0, "creation_date": 1527029964, "post_id": 50477077, "comment_id": 87968681, "body": "Yes, which may have to be wrapped with compiler-specific <code>#ifdef</code>&#39;s to enable/disable them, or change their behavior, without having to rewrite large pieces of the headers."}, {"owner": {"reputation": 172, "user_id": 8396910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60cac67c4aa7fc1e07e883d0ba58fb73?s=128&d=identicon&r=PG&f=1", "display_name": "hescobar", "link": "https://stackoverflow.com/users/8396910/hescobar"}, "reply_to_user": {"reputation": 11238, "user_id": 7594711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7872c871b0431b72df6350dd0394bea?s=128&d=identicon&r=PG&f=1", "display_name": "SoronelHaetir", "link": "https://stackoverflow.com/users/7594711/soronelhaetir"}, "edited": false, "score": 0, "creation_date": 1527032499, "post_id": 50477077, "comment_id": 87969328, "body": "@SoronelHaetir so what you are saying is that all/most &quot;Microsoft extensions to c and c++&quot; found here, <a href=\"https://msdn.microsoft.com/en-us/library/34h23df8.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/34h23df8.aspx</a>, would not be able to be compiled by gcc.... so what if I were to link the msvrct library to the compiler and ONLY use standard functions and common system calls? Would that work? I guess what I am getting at is, is there a specific thing other than extensions by microsoft/linux, that would tie a specific compiler to a specific libc implementation? Thank you."}, {"owner": {"reputation": 172, "user_id": 8396910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60cac67c4aa7fc1e07e883d0ba58fb73?s=128&d=identicon&r=PG&f=1", "display_name": "hescobar", "link": "https://stackoverflow.com/users/8396910/hescobar"}, "edited": false, "score": 0, "creation_date": 1527032561, "post_id": 50477077, "comment_id": 87969341, "body": "Also thank you for your responses. I am still learning and very curious. Sometimes it&#39;s hard to find specific answers to specific questions that I have."}], "tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": true, "score": 1, "last_activity_date": 1527026549, "creation_date": 1527026549, "answer_id": 50477077, "question_id": 50476378, "link": "https://stackoverflow.com/questions/50476378/what-is-the-use-of-w32api-in-mingw-project/50477077#50477077", "title": "What is the use of w32api in minGW project", "body": "<blockquote>\n  <p>But doesn't Windows ALREADY provide header files and libraries for itself?</p>\n</blockquote>\n\n<h2>No.</h2>\n\n<p><em>Microsoft</em> provides a Windows SDK, which includes C header files, and import libraries for use in Visual Studio only. Other compiler vendors ship those headers (making any tweaks they may require to compile) and import libraries that are appropriate for use in their own compilers.</p>\n\n<p>That is what the <code>w32api</code> package is for minGW.  The files needed to compile Windows code in minGW's environment.</p>\n"}], "owner": {"reputation": 172, "user_id": 8396910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60cac67c4aa7fc1e07e883d0ba58fb73?s=128&d=identicon&r=PG&f=1", "display_name": "hescobar", "link": "https://stackoverflow.com/users/8396910/hescobar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 703, "favorite_count": 0, "accepted_answer_id": 50477077, "answer_count": 1, "score": 0, "last_activity_date": 1527026549, "creation_date": 1527022816, "last_edit_date": 1527026335, "question_id": 50476378, "link": "https://stackoverflow.com/questions/50476378/what-is-the-use-of-w32api-in-mingw-project", "title": "What is the use of w32api in minGW project", "body": "<p>I have been reading about the minGW project and I am a bit confused about a specific part of it. If you look at <a href=\"http://www.mingw.org/wiki/MinGW\" rel=\"nofollow noreferrer\">http://www.mingw.org/wiki/MinGW</a>, the \"Packages included with minGW\" section mentions a <code>w32api</code> package. What is that?</p>\n\n<p>Since the project was able to produce a Windows port of gcc, wouldn't you just have to link the Windows c library instead of glibc and have it work?</p>\n\n<p>In the same document it explains:</p>\n\n<blockquote>\n  <p>Header files and import libraries for the Microsoft Windows operating system</p>\n</blockquote>\n\n<p>But doesn't Windows ALREADY provide header files and libraries for itself? Is the libc that minGW uses different from msvrct?</p>\n"}, {"tags": ["c", "pointers", "segmentation-fault"], "comments": [{"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1527021251, "post_id": 50476015, "comment_id": 87965614, "body": "Not enough information."}, {"owner": {"reputation": 360, "user_id": 5875805, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S4zBy.jpg?s=128&g=1", "display_name": "Tormund Giantsbane", "link": "https://stackoverflow.com/users/5875805/tormund-giantsbane"}, "edited": false, "score": 0, "creation_date": 1527021254, "post_id": 50476015, "comment_id": 87965615, "body": "what&#39;s <code>my_function</code>, show more code pls"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1527021279, "post_id": 50476015, "comment_id": 87965620, "body": "Can we reduce it to one star? I don&#39;t see a point of the extra three."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1527021296, "post_id": 50476015, "comment_id": 87965631, "body": "Please don&#39;t post romantic code (&quot;similar to the following&quot;). Post the <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a> that shows the problem."}, {"owner": {"reputation": 379, "user_id": 1991502, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/1883e91ac7aca1b3b90581ba0c70b521?s=128&d=identicon&r=PG", "display_name": "DJames", "link": "https://stackoverflow.com/users/1991502/djames"}, "edited": false, "score": 0, "creation_date": 1527022115, "post_id": 50476015, "comment_id": 87965994, "body": "My question pertained to general C syntax, not to where I am going wrong in my original source code."}], "answers": [{"comments": [{"owner": {"reputation": 379, "user_id": 1991502, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/1883e91ac7aca1b3b90581ba0c70b521?s=128&d=identicon&r=PG", "display_name": "DJames", "link": "https://stackoverflow.com/users/1991502/djames"}, "edited": false, "score": 0, "creation_date": 1527021874, "post_id": 50476073, "comment_id": 87965877, "body": "My question is not essentially unanswerable, as it has been succinctly answered by both you and Zan Lynx. My question did not pertain to my original code. Instead, it pertained to the code I posted, as I was asking what the difference is between the two snippets I posted above."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 379, "user_id": 1991502, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/1883e91ac7aca1b3b90581ba0c70b521?s=128&d=identicon&r=PG", "display_name": "DJames", "link": "https://stackoverflow.com/users/1991502/djames"}, "edited": false, "score": 1, "creation_date": 1527025218, "post_id": 50476073, "comment_id": 87967205, "body": "@DJames: I couldn&#39;t tell whether you had assigned a value to <code>A</code> somewhere between its definition and the call to <code>my_function</code>. My answer assumed that you hadn&#39;t, but given that the code in your question was merely &quot;similar&quot; to your actual code, there was no way to be sure. Posting a simplified version of your code is encouraged, but it should be actual code that exhibits the problem. See <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}], "tags": [], "owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "is_accepted": false, "score": 2, "last_activity_date": 1527021372, "creation_date": 1527021372, "answer_id": 50476073, "question_id": 50476015, "link": "https://stackoverflow.com/questions/50476015/one-method-induces-a-segfault-the-other-doesnt-what-is-the-difference/50476073#50476073", "title": "One method induces a segfault, the other doesn&#39;t. What is the difference?", "body": "<p>Given:</p>\n\n<pre><code>double ****A;\n\nmy_function(A);\n</code></pre>\n\n<p>and assuming that those lines appear literally in your code, with no value assigned to <code>A</code>, we can be sure that you're passing an uninitialized value, a garbage pointer, to <code>my_function</code>. That in itself has undefined behavior. Whether it causes a segmentation fault will depend on what <code>my_function</code> does with that value.</p>\n\n<p>This:</p>\n\n<pre><code>double ***A;\n\nmy_function(&amp;A);\n</code></pre>\n\n<p>passes a valid value of type <code>double****</code>. That value is the address of a declared object. By itself, the call is perfectly valid. (It might result in a segmentation fault depending on what <code>my_function</code> does with it, but you haven't shown us what <code>my_function</code> does, so I won't speculate further.)</p>\n\n<p>EDIT: I just noticed the phrase \"similar to the following\" in your question. Without seeing your <em>exact</em> code, we have no idea what you've left out, and your question is essentially unanswerable. (I wouldn't have posted this answer if I had noticed that initially.)</p>\n"}, {"tags": [], "owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "is_accepted": true, "score": 2, "last_activity_date": 1527021409, "creation_date": 1527021409, "answer_id": 50476087, "question_id": 50476015, "link": "https://stackoverflow.com/questions/50476015/one-method-induces-a-segfault-the-other-doesnt-what-is-the-difference/50476087#50476087", "title": "One method induces a segfault, the other doesn&#39;t. What is the difference?", "body": "<p>This: <code>double ****A;</code> is not set to point to anything. It is a dangling pointer with no known value.</p>\n\n<p>This: <code>double ***A; double ****B = &amp;A;</code> which is kind of what your function call does, points B at the storage of A, so the pointer actually points to something that exists.</p>\n"}], "owner": {"reputation": 379, "user_id": 1991502, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/1883e91ac7aca1b3b90581ba0c70b521?s=128&d=identicon&r=PG", "display_name": "DJames", "link": "https://stackoverflow.com/users/1991502/djames"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 50476087, "answer_count": 2, "score": -1, "last_activity_date": 1527021409, "creation_date": 1527021157, "last_edit_date": 1527021196, "question_id": 50476015, "link": "https://stackoverflow.com/questions/50476015/one-method-induces-a-segfault-the-other-doesnt-what-is-the-difference", "title": "One method induces a segfault, the other doesn&#39;t. What is the difference?", "body": "<p>My source code contains a segment similar to the following:</p>\n\n<pre><code>double ****A;\n\nmy_function(A);\n</code></pre>\n\n<p>which throws a segfault error in my_function.</p>\n\n<p>However, when I replace it with:</p>\n\n<pre><code>double ***A;\n\nmy_function(&amp;A);\n</code></pre>\n\n<p>then my_function works. I would have thought my_function would see the same argument in both cases.</p>\n"}, {"tags": ["c", "clion"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 4, "creation_date": 1527019542, "post_id": 50475648, "comment_id": 87964829, "body": "What would you expect for <code>if</code>? A pair of braces?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1527019783, "post_id": 50475648, "comment_id": 87964948, "body": "C has no <code>elif</code>. In C you are expected to implement pretty much everything not in a library. But I can see the advantage of expanding <code>switch</code> where a framework with one <code>case</code> and the <code>default</code> are written."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1527020052, "post_id": 50475648, "comment_id": 87965051, "body": "@WeatherVane <code>#elif</code>? :-)"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1527020100, "post_id": 50475648, "comment_id": 87965072, "body": "A decent text editor like <a href=\"https://notepad-plus-plus.org/\" rel=\"nofollow noreferrer\">Notepad++</a> can do this sort of thing for you."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1527020128, "post_id": 50475648, "comment_id": 87965086, "body": "@melpomene <code>elif</code> is not a C &quot;keyword&quot;, <code>#elif</code> is a preprocessor instruction."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1527021923, "post_id": 50475648, "comment_id": 87965900, "body": "@WeatherVane CLion is a fancy IDE for C, from JetBrains, the folks behind PhpStorm, WebStorm, PyCharm, etc."}, {"owner": {"reputation": 1830, "user_id": 1939432, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/33f04ad78cc166c320de2001db7d1955?s=128&d=identicon&r=PG", "display_name": "Lyrk", "link": "https://stackoverflow.com/users/1939432/lyrk"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1527024494, "post_id": 50475648, "comment_id": 87966939, "body": "@EugeneSh. sthg like this...  if (true) {  }"}, {"owner": {"reputation": 1830, "user_id": 1939432, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/33f04ad78cc166c320de2001db7d1955?s=128&d=identicon&r=PG", "display_name": "Lyrk", "link": "https://stackoverflow.com/users/1939432/lyrk"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1527024707, "post_id": 50475648, "comment_id": 87967028, "body": "@WeatherVane sorry I made a mistake. I meant &quot;else&quot;"}], "owner": {"reputation": 1830, "user_id": 1939432, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/33f04ad78cc166c320de2001db7d1955?s=128&d=identicon&r=PG", "display_name": "Lyrk", "link": "https://stackoverflow.com/users/1939432/lyrk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1527019363, "creation_date": 1527019363, "question_id": 50475648, "link": "https://stackoverflow.com/questions/50475648/clion-missing-some-obvious-templates-like-if-switch", "title": "Clion missing some obvious templates like if, switch", "body": "<p>When I type \"for\" and press TAB, a full for loop is created as expected but this is not the case for \"if\" \"elif\" \"switch\" keywords as I am used to other IDEs. Am I expected to implement these by myself on CLion or can I find a internet source for all these done beforehand?</p>\n"}, {"tags": ["c", "arrays", "pointers", "static"], "comments": [{"owner": {"reputation": 411, "user_id": 2355561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19c3b43b98852d663878542ad3ff4bff?s=128&d=identicon&r=PG", "display_name": "Austin Stephens", "link": "https://stackoverflow.com/users/2355561/austin-stephens"}, "edited": false, "score": 0, "creation_date": 1527019306, "post_id": 50475554, "comment_id": 87964722, "body": "Why not just make an array in main() and send it to the function to be modified?"}, {"owner": {"reputation": 7, "user_id": 9830598, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76ead5aab4bf1e664a2065693f87210c?s=128&d=identicon&r=PG&f=1", "display_name": "InfoSecNick", "link": "https://stackoverflow.com/users/9830598/infosecnick"}, "reply_to_user": {"reputation": 411, "user_id": 2355561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19c3b43b98852d663878542ad3ff4bff?s=128&d=identicon&r=PG", "display_name": "Austin Stephens", "link": "https://stackoverflow.com/users/2355561/austin-stephens"}, "edited": false, "score": 0, "creation_date": 1527019444, "post_id": 50475554, "comment_id": 87964789, "body": "@AustinStephens I have thought of that, but I need the array to be passed back to the main eventually. Wouldn&#39;t that put me back into the same situation?"}, {"owner": {"reputation": 411, "user_id": 2355561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19c3b43b98852d663878542ad3ff4bff?s=128&d=identicon&r=PG", "display_name": "Austin Stephens", "link": "https://stackoverflow.com/users/2355561/austin-stephens"}, "edited": false, "score": 0, "creation_date": 1527019644, "post_id": 50475554, "comment_id": 87964876, "body": "No, the array you send will be modified in main() as well; you don&#39;t have to return anything."}, {"owner": {"reputation": 7, "user_id": 9830598, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76ead5aab4bf1e664a2065693f87210c?s=128&d=identicon&r=PG&f=1", "display_name": "InfoSecNick", "link": "https://stackoverflow.com/users/9830598/infosecnick"}, "reply_to_user": {"reputation": 411, "user_id": 2355561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19c3b43b98852d663878542ad3ff4bff?s=128&d=identicon&r=PG", "display_name": "Austin Stephens", "link": "https://stackoverflow.com/users/2355561/austin-stephens"}, "edited": false, "score": 0, "creation_date": 1527019836, "post_id": 50475554, "comment_id": 87964959, "body": "@AustinStephens I guess that&#39;s where the functionality of pointers come into play? That sounds like it would work, but my assignment explicitly asks for the array passed back to the main."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1527020014, "post_id": 50475554, "comment_id": 87965032, "body": "<code>printf(&quot;%d&quot;, &amp;i);</code> == <code>printf(&quot;%d: &quot;, i);</code>"}, {"owner": {"reputation": 7, "user_id": 9830598, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76ead5aab4bf1e664a2065693f87210c?s=128&d=identicon&r=PG&f=1", "display_name": "InfoSecNick", "link": "https://stackoverflow.com/users/9830598/infosecnick"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1527020230, "post_id": 50475554, "comment_id": 87965139, "body": "@4386427 That solved my issue! Do you mind clarifying how that fixed it?"}, {"owner": {"reputation": 2024, "user_id": 1315171, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/081b87a82980b9c47ce10d65653ffe57?s=128&d=identicon&r=PG", "display_name": "Zakir", "link": "https://stackoverflow.com/users/1315171/zakir"}, "edited": false, "score": 0, "creation_date": 1527020811, "post_id": 50475554, "comment_id": 87965414, "body": "@InfoSecNick - see my ans below it has the explanation.. i is a local counter &amp;i is the address of that variable you don&#39;t  want to print the address - but the variable - i"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1527022340, "post_id": 50475554, "comment_id": 87966101, "body": "<code>srand(time(NULL));</code> every time you call your <code>prefixAverages1()</code> function?  No - do not do that.  Call <code>srand()</code> fast enough that the return value of <code>time(NULL)</code> doesn&#39;t change between iterations and you&#39;ll get the same sequence of &quot;random&quot; numbers from your later calls to <code>rand()</code>."}], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 9830598, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76ead5aab4bf1e664a2065693f87210c?s=128&d=identicon&r=PG&f=1", "display_name": "InfoSecNick", "link": "https://stackoverflow.com/users/9830598/infosecnick"}, "edited": false, "score": 0, "creation_date": 1527019352, "post_id": 50475616, "comment_id": 87964742, "body": "Thanks for that. I wasn&#39;t exactly sure if I was using <code>malloc</code> correctly. Having changed that, I&#39;m still getting incorrect values printed in the main."}, {"owner": {"reputation": 7, "user_id": 9830598, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76ead5aab4bf1e664a2065693f87210c?s=128&d=identicon&r=PG&f=1", "display_name": "InfoSecNick", "link": "https://stackoverflow.com/users/9830598/infosecnick"}, "edited": false, "score": 0, "creation_date": 1527019672, "post_id": 50475616, "comment_id": 87964892, "body": "The values are printing correctly in the function. It&#39;s solely when returning to the main."}], "tags": [], "owner": {"reputation": 2024, "user_id": 1315171, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/081b87a82980b9c47ce10d65653ffe57?s=128&d=identicon&r=PG", "display_name": "Zakir", "link": "https://stackoverflow.com/users/1315171/zakir"}, "is_accepted": false, "score": 0, "last_activity_date": 1527020141, "last_edit_date": 1527020141, "creation_date": 1527019226, "answer_id": 50475616, "question_id": 50475554, "link": "https://stackoverflow.com/questions/50475554/static-or-pointer-when-returning-array/50475616#50475616", "title": "Static or Pointer When &quot;Returning&quot; Array", "body": "<p>First of all <code>malloc</code> takes an inparam of no of bytes not absolute array size - so change this line:-</p>\n\n<pre><code>int *a = (int*)malloc(input);\n</code></pre>\n\n<p>to</p>\n\n<pre><code>int *a = malloc(input*sizeof(int));\n</code></pre>\n\n<p>Secondly, to debug incorrect values being printed put a print in your function <code>prefixAverages1</code> :-</p>\n\n<pre><code>...\n...\na[i] = s / (i+1);\nprintf(\"%d \\n\", a[i]);\n...\n</code></pre>\n\n<p>In main print, get rid of the first print.. this is probably making you think printing incorrect values.. The address of the local loop counter variable will look like garbage</p>\n\n<pre><code>printf(\"%d\", &amp;i);\n</code></pre>\n\n<p>OR if you wanted to track the indexes of the array elements as well modify it to :-</p>\n\n<pre><code>printf(\"%d\", i);\n</code></pre>\n\n<p>You must introduce the <code>free</code> back to avoid leaking memory </p>\n\n<p>And you should follow @AustinStephens's suggestion and avoid using a second function</p>\n"}, {"tags": [], "owner": {"reputation": 411, "user_id": 2355561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19c3b43b98852d663878542ad3ff4bff?s=128&d=identicon&r=PG", "display_name": "Austin Stephens", "link": "https://stackoverflow.com/users/2355561/austin-stephens"}, "is_accepted": false, "score": 0, "last_activity_date": 1527021324, "last_edit_date": 1527021324, "creation_date": 1527020802, "answer_id": 50475941, "question_id": 50475554, "link": "https://stackoverflow.com/questions/50475554/static-or-pointer-when-returning-array/50475941#50475941", "title": "Static or Pointer When &quot;Returning&quot; Array", "body": "<p>This works as far as having a function that loads an array with random values:</p>\n\n<pre><code>void randomValues(int arr[], int size);\n\n#include &lt;stdio.h&gt;\n#include &lt;time.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main() {\n    int i;\n    int input;\n    int *array;\n\n    printf(\"What is the size of the array?: \");\n    scanf(\"%d\", &amp;input);\n\n    array = malloc(sizeof(int) * input);\n\n    randomValues(array, input);\n\n    for(i = 0; i &lt; input; ++i)\n        printf(\"array[%d] = %d\\n\", i, array[i]);\n\n    free(array);\n\n    return 0;\n}\n\nvoid randomValues(int arr[], int size) {\n    int i;\n    int r;\n\n    srand((int) time(0));\n\n    for(i = 0; i &lt; size; ++i) {\n        r = rand() % 100;\n        arr[i] = r;\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 7, "user_id": 9830598, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76ead5aab4bf1e664a2065693f87210c?s=128&d=identicon&r=PG&f=1", "display_name": "InfoSecNick", "link": "https://stackoverflow.com/users/9830598/infosecnick"}, "edited": false, "score": 0, "creation_date": 1527024069, "post_id": 50476371, "comment_id": 87966767, "body": "That makes a lot of sense! Thanks for going through each of my questions and answering them individually."}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 0, "last_activity_date": 1527022778, "creation_date": 1527022778, "answer_id": 50476371, "question_id": 50475554, "link": "https://stackoverflow.com/questions/50475554/static-or-pointer-when-returning-array/50476371#50476371", "title": "Static or Pointer When &quot;Returning&quot; Array", "body": "<blockquote>\n  <p>I'm attempting to load an array of size n (user input), with random\n  values. I've read that you can not return an array in C, you must use\n  a pointer (Which is quite confusing).</p>\n</blockquote>\n\n<p>Yes, the relationship between pointers and arrays and the surprisingly wide scope of things you cannot do with arrays themselves are common points of confusion.  To some extent it's a pedantic distinction.  Almost everything C allows you to do with an array, it makes you do via a pointer, but it automatically <em>converts</em> values of array type to appropriate pointers, so that those details are largely hidden.</p>\n\n<p>But in some places it pokes out.  For example, there is no valid syntax that allows you even to try to declare a function that returns an array.</p>\n\n<p>In other places it is actively misleading.  For example, you can declare a function that <em>appears</em> to accept an array as an argument, but the standard explicitly specifies that the argument is actually a corresponding pointer (and that's what naturally falls out when you call such a function anyway).  Specifically:</p>\n\n<pre><code>int foo(int x[3]);\n</code></pre>\n\n<p>is 100% equivalent to</p>\n\n<pre><code>int foo(int *x);\n</code></pre>\n\n<blockquote>\n  <p>However, I've read that if you\n  are storing that array to a local variable in the returning function,\n  a pointer will not work</p>\n</blockquote>\n\n<p>That's not so much about arrays specifically, but rather about automatic variables in general.  These logically cease to exist when they go out of scope -- at the end of the innermost block in which they are declared -- so pointers to or into such objects are no longer valid once the function returns.  One way to obtain such a pointer value is for the function to return it.  That in itself is OK, but you cannot safely dereference such a pointer value.</p>\n\n<blockquote>\n  <p>and a static array can be used (can that be\n  returned in a function?).</p>\n</blockquote>\n\n<p>The lifetime of static variables of any type is the whole execution of the program.  Therefore, it is safe and can be meaningful to return a pointer (in)to a static variable from a function.  But although it can work to return a pointer to a static array from your function, you still cannot return such an array itself.</p>\n\n<blockquote>\n  <p>Also, I've read that you are supposed to\n  call free after using the array is open the space back up?</p>\n</blockquote>\n\n<p>You should free memory that you have allocated with one of the memory allocation functions (<code>malloc()</code> etc.), and no other.  But when you allocate memory inside a function, you can give the caller responsibility for freeing that memory by returning the pointer to it, among other ways.</p>\n\n<p>In fact, most of what you demonstrate in your example code is fine in those regards.  However, you do make a key error that undermines your program.  Here:</p>\n\n<blockquote>\n<pre><code>    int *a = (int*)malloc(input);\n</code></pre>\n</blockquote>\n\n<p>You allocate <code>input</code> <em>bytes</em> and store the pointer to them in <code>a</code>, but that is not enough storage for <code>input</code> objects of type <code>int</code>.  The size of an <code>int</code> varies from implementation to implementation, but the minimum size permitted by the standard is two bytes, in the most common size is four bytes.  To allocate space for <code>input</code> objects of type <code>int</code>, the basic idiom is</p>\n\n<pre><code>int *a = malloc(input * sizeof(int));\n</code></pre>\n\n<p>Personally, though, I prefer</p>\n\n<pre><code>int *a = malloc(input * sizeof(*a));\n</code></pre>\n\n<p>because then I get the correct size no matter what type the pointer's referenced type is, and even if I change it later.</p>\n\n<p>The fact that you treated the allocated space as if it were larger than it really was likely explains much of your program's misbehavior, including the crash when you tried to free the allocated memory.</p>\n"}], "owner": {"reputation": 7, "user_id": 9830598, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76ead5aab4bf1e664a2065693f87210c?s=128&d=identicon&r=PG&f=1", "display_name": "InfoSecNick", "link": "https://stackoverflow.com/users/9830598/infosecnick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 1, "accepted_answer_id": 50476371, "answer_count": 3, "score": 0, "last_activity_date": 1527022778, "creation_date": 1527018962, "last_edit_date": 1527019747, "question_id": 50475554, "link": "https://stackoverflow.com/questions/50475554/static-or-pointer-when-returning-array", "title": "Static or Pointer When &quot;Returning&quot; Array", "body": "<p>I'm attempting to load an array of size n (user input), with random values. I've read that you can not return an array in C, you must use a pointer (Which is quite confusing). However, I've read that if you are storing that array to a local variable in the returning function, a pointer will not work and a static array can be used (can that be returned in a function?). Also, I've read that you are supposed to call <code>free</code> after using the array is open the space back up? I must be using it wrong because it crashed. So I commented it out for now. Some clarification would be great.</p>\n\n<p>Here's what I have so far. When printing, it's just printing what I'm assuming is just garbage.</p>\n\n<pre><code>int* prefixAverages1(int);\n\n#include &lt;stdio.h&gt;\n#include &lt;time.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main() {\n\n    int choice;\n    int input;\n\n    printf(\"What is the size of the array?:\");\n    scanf(\"%d\", &amp;input);\n    printf(\"Do you want to run prefixAverages 1 or 2?\");\n    scanf(\"%d\", &amp;choice);\n\n    switch(choice) {\n        case 1:\n            printf(\"Beginning prefixAverages1\\n\");\n            int *a = prefixAverages1(input);\n            for (int i=0; i &lt; input; i++) {\n                printf(\"%d\", &amp;i);\n                printf(\"%d \\n\", a[i]);\n            }\n            //free(a);\n            break;\n    }\n}\n\nint* prefixAverages1(int input) {\n    int x[input];\n    int *a = (int*)malloc(input);\n    srand(time(NULL));  \n\n    for(int i = 0; i &lt; input; i++) {\n        int s = 0;\n        for(int j = 0; j &lt; i; j++) {\n            int r = rand() % 100;\n            x[j] = r;\n            s = s + x[j];\n        }\n        a[i] = s / (i+1);\n        printf(\"%d \\n\", a[i]);\n    }\n    return a;\n}\n</code></pre>\n\n<p>I'm aware my syntax may be wonky. I haven't touched C in years, so let me know if my error is syntaxical.</p>\n\n<p>edit: Values are printing as intended in the function. Added print statement in code for clairity</p>\n"}, {"tags": ["c", "file", "pattern-matching", "scanf"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1527018530, "post_id": 50475362, "comment_id": 87964347, "body": "The pattern should be <code>$[^,\\n]</code> otherwise it will read a token that goes across multiple lines."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1527018580, "post_id": 50475362, "comment_id": 87964364, "body": "Reading until <code>fscanf()</code> returns <code>NULL</code> will go until the end of the file. You can&#39;t use <code>scanf()</code> like that to stop at the end of the first line."}, {"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 1, "creation_date": 1527018596, "post_id": 50475362, "comment_id": 87964368, "body": "I usually recommend to <code>fgets()</code> the whole line and then pick it apart with what <code>&lt;string.h&gt;</code> and <code>&lt;stdlib.h&gt;</code> have to offer..."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1527018638, "post_id": 50475362, "comment_id": 87964384, "body": "I don&#39;t think this task can be done using just <code>scanf()</code>."}, {"owner": {"reputation": 1608, "user_id": 7757135, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/JQ8Kt.png?s=128&g=1", "display_name": "JuMoGar", "link": "https://stackoverflow.com/users/7757135/jumogar"}, "edited": false, "score": 1, "creation_date": 1527018647, "post_id": 50475362, "comment_id": 87964387, "body": "I always used fgets for doing that. But it is a requisite using <code>scanf</code>... So I can not do that with fgets"}, {"owner": {"reputation": 1608, "user_id": 7757135, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/JQ8Kt.png?s=128&g=1", "display_name": "JuMoGar", "link": "https://stackoverflow.com/users/7757135/jumogar"}, "edited": false, "score": 0, "creation_date": 1527027848, "post_id": 50475362, "comment_id": 87968081, "body": "I have achieved that, I will post the code if you wanna try it"}], "answers": [{"tags": [], "owner": {"reputation": 1608, "user_id": 7757135, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/JQ8Kt.png?s=128&g=1", "display_name": "JuMoGar", "link": "https://stackoverflow.com/users/7757135/jumogar"}, "is_accepted": true, "score": 0, "last_activity_date": 1527028305, "creation_date": 1527028305, "answer_id": 50477323, "question_id": 50475362, "link": "https://stackoverflow.com/questions/50475362/fscanf-read-a-file-with-a-pattern-in-c/50477323#50477323", "title": "fscanf(). Read a file with a pattern in C", "body": "<p>I have achieved my purpose. I have got it like: </p>\n\n<pre><code>// WAY 1\n            int contadorAlmoadillas = 0;\n            int contadorCamposLinea = 0;\n\n            if ((fichero = fopen(\"./files/carreteras.txt\", \"r\")) != NULL) {\n                while (fscanf(fichero, \" %[^,\\n ]%*c\",buffer) != EOF) {\n                    G:\n                    if (buffer[0] == '#') {\n                        fscanf(fichero, \" %[^\\n]\",buffer);\n                        printf(\"\\n\\n\\n# %s \\n\\n\", buffer); // CABECERA\n                        contadorAlmoadillas++;\n                    } else {\n                        // # Lista ciudades\n                        if (contadorAlmoadillas == 1) {\n                            printf(\"%s \", buffer); // CIUDAD\n                        // # Distancias entre ciudades\n                        } else if (contadorAlmoadillas == 2) {\n                            if (contadorCamposLinea &lt; 3) {\n                                printf(\"%s \", buffer); // NODO1 Y NODO2 Y PESO\n                                contadorCamposLinea++;\n                            } else {\n                                printf(\"\\n\");\n                                contadorCamposLinea = 0;\n                                goto G;\n                            }\n                        }\n                    }\n                }\n\n                printf(\"\\n\\n\\n\");\n                fclose(fichero);\n            }\n\n// WAY 2\n            int contadorAlmoadillas = 0;\n            int contadorCamposLinea = 0;\n\n            if ((fichero = fopen(\"./files/carreteras.txt\", \"r\")) != NULL) {\n                while (fscanf(fichero, \" %[^,\\n ]%*c\",buffer) != EOF) {\n                    if (buffer[0] == '#') {\n                        fscanf(fichero, \" %[^\\n]\",buffer);\n                        printf(\"\\n\\n\\n# %s \\n\\n\", buffer); // CABECERA\n                        contadorAlmoadillas++;\n                    } else {\n                        // # Lista ciudades\n                        if (contadorAlmoadillas == 1) {\n                            printf(\"%s \", buffer); // CIUDAD\n                        // # Distancias entre ciudades\n                        } else if (contadorAlmoadillas == 2) {\n                            if (contadorCamposLinea &lt; 2) {\n                                printf(\"%s \", buffer); // NODO1 Y NODO2\n                                contadorCamposLinea++;\n                            } else {\n                                printf(\"%s\\n\", buffer); // PESO\n                                contadorCamposLinea = 0;\n                            }\n                        }\n                    }\n                }\n                fclose(fichero);\n            }\n</code></pre>\n\n<p>Both ways are equal, one using TAGs and other avoiding it. I hope it could be helpful for anyone more.</p>\n\n<p>Regards.</p>\n"}], "owner": {"reputation": 1608, "user_id": 7757135, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/JQ8Kt.png?s=128&g=1", "display_name": "JuMoGar", "link": "https://stackoverflow.com/users/7757135/jumogar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 431, "favorite_count": 0, "accepted_answer_id": 50477323, "answer_count": 1, "score": 0, "last_activity_date": 1527028305, "creation_date": 1527018118, "last_edit_date": 1527018417, "question_id": 50475362, "link": "https://stackoverflow.com/questions/50475362/fscanf-read-a-file-with-a-pattern-in-c", "title": "fscanf(). Read a file with a pattern in C", "body": "<p>I must read a txt file using <code>scanf</code> and show in console the content. It is neccesary doing that with <code>scanf</code>. Also <code>#</code>lines should be ommited on the output.</p>\n\n<p>I have next txt file:</p>\n\n<pre><code># Lista ciudades\n\nCoru\u00f1a, Vigo, Valladolid, Oviedo, Bilbao, Zaragoza, Gerona, Barcelona, Madrid, Badajoz, Albacete, Valencia, Murcia, Ja\u00e9n, Sevilla, Granada, C\u00e1diz\n\n\n# Distancias entre ciudades\n\nCoru\u00f1a Vigo 171\nCoru\u00f1a Valladolid 455\nVigo Valladolid 356\nValladolid Bilbao 280\nValladolid Madrid 193\nOviedo Bilbao 304\nBilbao Madrid 395\nBilbao Zaragoza 324\nMadrid Zaragoza 325\nZaragoza Barcelona 296\nBarcelona Gerona 100\nValencia Barcelona 349\nMadrid Badajoz 403\nMadrid Ja\u00e9n 335\nMadrid Albacete 251\nAlbacete Valencia 191\nAlbacete Murcia 150\nMurcia Granada 284\nMurcia Valencia 241\nGranada Ja\u00e9n 99\nGranada Sevilla 256\nJa\u00e9n Sevilla 242\nSevilla C\u00e1diz 125\n</code></pre>\n\n<p>Desired output is: </p>\n\n<pre><code>Coru\u00f1a Vigo Valladolid Oviedo Bilbao Zaragoza Gerona Barcelona Madrid Badajoz Albacete Valencia Murcia Ja\u00e9n Sevilla Granada C\u00e1diz\n\nCoru\u00f1a Vigo 171\nCoru\u00f1a Valladolid 455\nVigo Valladolid 356\nValladolid Bilbao 280\nValladolid Madrid 193\nOviedo Bilbao 304\nBilbao Madrid 395\nBilbao Zaragoza 324\nMadrid Zaragoza 325\nZaragoza Barcelona 296\nBarcelona Gerona 100\nValencia Barcelona 349\nMadrid Badajoz 403\nMadrid Ja\u00e9n 335\nMadrid Albacete 251\nAlbacete Valencia 191\nAlbacete Murcia 150\nMurcia Granada 284\nMurcia Valencia 241\nGranada Ja\u00e9n 99\nGranada Sevilla 256\nJa\u00e9n Sevilla 242\nSevilla C\u00e1diz 125\n</code></pre>\n\n<p>For achieving that, I was thinking in something like: </p>\n\n<pre><code>contadorAlmoadillas = 0;\nif ((fichero = fopen(\"./files/carreteras.txt\", \"r\")) != NULL) {\n    // If contadorAlmoadillas is 1\n    while (fscanf(fichero, \" %[^,]\",buffer) != NULL) {\n        printf(\"%s \", buffer);\n    }\n    // If contadorAlmoadillas is 2\n    while (fscanf(fichero, \" %[^ ], %[^ ], %[^\\n]\",buffer1,buffer2,&amp;d) != NULL) {\n        printf(\"%s %s %i \\n\", buffer1,buffer2,d);\n    }\n    fclose(fichero);\n}\n</code></pre>\n\n<p>But I am not getting desired output. It is due to scanf pattern. </p>\n\n<p>Also, I do now know how can I count how many times appear <code>#</code> character, so I cant implement the if statement.</p>\n\n<p>Any idea how can I do that?.</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["c", "tensorflow"], "comments": [{"owner": {"reputation": 19375, "user_id": 1735003, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/qNeQo.png?s=128&g=1", "display_name": "P-Gn", "link": "https://stackoverflow.com/users/1735003/p-gn"}, "edited": false, "score": 0, "creation_date": 1527022138, "post_id": 50475320, "comment_id": 87966008, "body": "Looking at the code, it seems that the operation is located in a <a href=\"https://github.com/tensorflow/tensorflow/blob/r1.8/tensorflow/contrib/resampler/python/ops/resampler_ops.py#L28\" rel=\"nofollow noreferrer\">separate binary called <code>_resampler_ops.so</code></a>. No surprise it cannot find it -- you will need to load this library first."}, {"owner": {"reputation": 2556, "user_id": 392805, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/fc6e8fd9fa86a987feb3996ab19ce262?s=128&d=identicon&r=PG", "display_name": "The Fiddler", "link": "https://stackoverflow.com/users/392805/the-fiddler"}, "reply_to_user": {"reputation": 19375, "user_id": 1735003, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/qNeQo.png?s=128&g=1", "display_name": "P-Gn", "link": "https://stackoverflow.com/users/1735003/p-gn"}, "edited": false, "score": 0, "creation_date": 1527026841, "post_id": 50475320, "comment_id": 87967773, "body": "Surprisingly, this binary does not exist in my installation (tensorflow-gpu 1.8.0 installed through pip on windows), yet the python version is able to load and run the graph. That means the op exists and can be loaded iff I can figure out how to do that in C."}], "answers": [{"tags": [], "owner": {"reputation": 5655, "user_id": 6708503, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b6830ee25bc34994df9835cc17b64aa?s=128&d=identicon&r=PG&f=1", "display_name": "ash", "link": "https://stackoverflow.com/users/6708503/ash"}, "is_accepted": false, "score": 1, "last_activity_date": 1527294586, "creation_date": 1527294586, "answer_id": 50538292, "question_id": 50475320, "link": "https://stackoverflow.com/questions/50475320/executing-frozen-tensorflow-graph-that-uses-tensorflow-contrib-resampler-using-c/50538292#50538292", "title": "Executing frozen tensorflow graph that uses tensorflow.contrib.resampler using c_api.h", "body": "<p>(This is very similar to <a href=\"https://stackoverflow.com/a/47277367/6708503\">this other StackOverflow thread</a> talking about the same thing, but for Java)</p>\n\n<p>When you use operations in the <code>tf.contrib</code> module, they are not considered to be experimental, thus are not part of the <a href=\"https://www.tensorflow.org/programmers_guide/version_compat\" rel=\"nofollow noreferrer\">stable TensorFlow API</a> and aren't included in other language distributions.</p>\n\n<p>However, you can explicitly load the shared library in C using <a href=\"https://github.com/tensorflow/tensorflow/blob/dcb10b1d557168646204239bea6ca5bf1abc40a3/tensorflow/c/c_api.h#L1526\" rel=\"nofollow noreferrer\"><code>TF_LoadLibrary</code></a>.</p>\n\n<p>To do that, first you need to find the location of the shared library that contains the implementation of the <code>tf.contrib</code> operation you're interested in. In this case it seems like it's <code>tf.contrib.resampler</code>, so you'd do something like this:</p>\n\n<pre><code>python -c \"import tensorflow; print(tensorflow.contrib.resampler.__path__)\"\n</code></pre>\n\n<p>Which would print something like:</p>\n\n<pre><code>['/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/resampler']\n</code></pre>\n\n<p>Then you'd find all the shared libraries in that path using something like:</p>\n\n<pre><code>find /usr/local/lib/python2.7/dist-packages/tensorflow/contrib/resampler -name \"*.so\"\n</code></pre>\n\n<p>Which would be something like:</p>\n\n<pre><code>/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/resampler/python/ops/_resampler_ops.so\n</code></pre>\n\n<p>Alright, now you have that library, you can load it in C using:</p>\n\n<pre><code>TF_Status* status = TF_NewStatus();\nTF_LoadLibrary(\"/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/resampler/python/ops/_resampler_ops.so\", status);\nif (TF_GetCode(status) != TF_OK) {\n  // Log/fail, details in TF_Message(status)\n}\nTF_DeleteStatus(status);\n</code></pre>\n\n<p>Caveats:</p>\n\n<ul>\n<li><p>If you want to run on a different machine, you'd want to package the <code>.so</code> file above with your program and adjust the call to <code>TF_LoadLibrary</code> appropriately.</p></li>\n<li><p>Make sure you're using the same TensorFlow version for Python and C</p></li>\n<li><p><strong>Windows</strong>: For Windows, the build is currently (till TensorFlow 1.8 at least) different and all operations are statically compiled into a single native library included with the pip package, but not with the C API release binaries. So, there is no DLL corresponding to these contrib operations that you can load.</p></li>\n</ul>\n\n<p>Hope that helps.</p>\n"}], "owner": {"reputation": 2556, "user_id": 392805, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/fc6e8fd9fa86a987feb3996ab19ce262?s=128&d=identicon&r=PG", "display_name": "The Fiddler", "link": "https://stackoverflow.com/users/392805/the-fiddler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1541, "favorite_count": 2, "answer_count": 1, "score": 4, "last_activity_date": 1527294586, "creation_date": 1527017989, "last_edit_date": 1527021994, "question_id": 50475320, "link": "https://stackoverflow.com/questions/50475320/executing-frozen-tensorflow-graph-that-uses-tensorflow-contrib-resampler-using-c", "title": "Executing frozen tensorflow graph that uses tensorflow.contrib.resampler using c_api.h", "body": "<p>I have a frozen tensorflow graph (.pb format) that contains a call to tensorflow.contrib.resampler, which must be loaded and executed in a C application using <code>c_api.h</code>.</p>\n\n<p>I am able to succesfully load and execute this graph from python if I call: </p>\n\n<pre><code>import tensorflow as tf\ntf.contrib.resampler\n</code></pre>\n\n<p>before I load the graph.</p>\n\n<p>However, I cannot find how to do the same using the C api, which leads to a failure with the following message:</p>\n\n<pre><code>Failed to process frame with No OpKernel was registered to support Op 'Resampler'\nwith these attrs.  Registered devices: [CPU,GPU], Registered kernels:\n&lt;no registered kernels&gt;\n</code></pre>\n\n<p>How can I instruct tensorflow that this op exists using the C api?</p>\n"}, {"tags": ["c", "algorithm"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 5, "creation_date": 1527018190, "post_id": 50475317, "comment_id": 87964186, "body": "This is not the way. <code>1 xor 1 = 0</code>. <code>0 xor 0 = 0</code>. How would you distinguish  them? For future interviews - stop trying to come up with something fancy, just be straightforward this way you will gain at least 50% of the points instead of zero. The way to solve the anagrams problem - is to sort and compare."}, {"owner": {"reputation": 1747, "user_id": 3726902, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/kV59z.png?s=128&g=1", "display_name": "Miket25", "link": "https://stackoverflow.com/users/3726902/miket25"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1527018415, "post_id": 50475317, "comment_id": 87964295, "body": "@EugeneSh. Thanks. I ended up just sorting and comparing at the end. But I was curious, and your example made it obvious now."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1527018822, "post_id": 50475317, "comment_id": 87964469, "body": "Cool, then you&#39;ve got 100% :) Just to add to above notes - in most cases after you come up with a trivial solution to an interview question, they will tell you &quot;cool, and how about more efficient way?&quot; if there is any. Then become fancy :)"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1527045508, "post_id": 50475317, "comment_id": 87972112, "body": "Aside: many a compiler, with a string of length <code>N</code> will see <code>for(int i = 0; i&lt;strlen(str1); i++){</code> and call <code>strlen(str1)</code> N times, each call costing <code>N</code> operations.  This make code <code>O(N*N)</code> on an   interview answer.   Some compilers will see, <code>str1</code> does not change an create reasonable code. A trivial simply alternative is <code>for(int i = 0; str1[i]; i++){</code>"}, {"owner": {"reputation": 2026, "user_id": 3789665, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/38983281a7926f50843153d9e0788cdf?s=128&d=identicon&r=PG&f=1", "display_name": "greybeard", "link": "https://stackoverflow.com/users/3789665/greybeard"}, "edited": false, "score": 0, "creation_date": 1527061995, "post_id": 50475317, "comment_id": 87978500, "body": "With string length not limited, can <i>any</i> <a href=\"https://en.m.wikipedia.org/wiki/Hash_function#Defined_range\" rel=\"nofollow noreferrer\">function with fixed output size</a> catch <i>all</i> non-anagrams? Good ones catch most: fast ones are useful for a pre-check."}], "answers": [{"comments": [{"owner": {"reputation": 4227, "user_id": 8200485, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f6663ff2d61581b26bd021b3ce6b6376?s=128&d=identicon&r=PG", "display_name": "hyper-neutrino", "link": "https://stackoverflow.com/users/8200485/hyper-neutrino"}, "edited": false, "score": 0, "creation_date": 1527018261, "post_id": 50475356, "comment_id": 87964218, "body": "How can you possibly get constant time when the string length changes? Maybe you meant linear? Either way, sorting is the right way to go."}, {"owner": {"reputation": 1747, "user_id": 3726902, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/kV59z.png?s=128&g=1", "display_name": "Miket25", "link": "https://stackoverflow.com/users/3726902/miket25"}, "edited": false, "score": 0, "creation_date": 1527018285, "post_id": 50475356, "comment_id": 87964230, "body": "I&#39;m more interested in the reasoning why XOR gave a false positive and whether it can be resolved continuing with XOR, not  on a different approach."}, {"owner": {"reputation": 13895, "user_id": 1162233, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/e3Eil.jpg?s=128&g=1", "display_name": "Kaidul", "link": "https://stackoverflow.com/users/1162233/kaidul"}, "reply_to_user": {"reputation": 4227, "user_id": 8200485, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f6663ff2d61581b26bd021b3ce6b6376?s=128&d=identicon&r=PG", "display_name": "hyper-neutrino", "link": "https://stackoverflow.com/users/8200485/hyper-neutrino"}, "edited": false, "score": 0, "creation_date": 1527018329, "post_id": 50475356, "comment_id": 87964246, "body": "@HyperNeutrino Yeah, thanks a lot! It was a typo. I&#39;ve corrected now :)"}, {"owner": {"reputation": 13895, "user_id": 1162233, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/e3Eil.jpg?s=128&g=1", "display_name": "Kaidul", "link": "https://stackoverflow.com/users/1162233/kaidul"}, "reply_to_user": {"reputation": 1747, "user_id": 3726902, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/kV59z.png?s=128&g=1", "display_name": "Miket25", "link": "https://stackoverflow.com/users/3726902/miket25"}, "edited": false, "score": 0, "creation_date": 1527019435, "post_id": 50475356, "comment_id": 87964784, "body": "@Miket25 Thanks for accepting this answer. I&#39;ve also provided another way in the answer. You can check it as well."}, {"owner": {"reputation": 1747, "user_id": 3726902, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/kV59z.png?s=128&g=1", "display_name": "Miket25", "link": "https://stackoverflow.com/users/3726902/miket25"}, "edited": false, "score": 0, "creation_date": 1527021937, "post_id": 50475356, "comment_id": 87965906, "body": "@KaidulIslam Thanks, I saw that your alternative solution was removed. Was there something wrong with it?"}, {"owner": {"reputation": 767708, "user_id": 14860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vXG1F.png?s=128&g=1", "display_name": "paxdiablo", "link": "https://stackoverflow.com/users/14860/paxdiablo"}, "reply_to_user": {"reputation": 1747, "user_id": 3726902, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/kV59z.png?s=128&g=1", "display_name": "Miket25", "link": "https://stackoverflow.com/users/3726902/miket25"}, "edited": false, "score": 0, "creation_date": 1527049671, "post_id": 50475356, "comment_id": 87972970, "body": "@Miket25, probably because <i>any</i> hashing algorithm which loses information will have some form of false positive (see my answer for an example). You need a solution with <i>no</i> information loss."}, {"owner": {"reputation": 13895, "user_id": 1162233, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/e3Eil.jpg?s=128&g=1", "display_name": "Kaidul", "link": "https://stackoverflow.com/users/1162233/kaidul"}, "reply_to_user": {"reputation": 767708, "user_id": 14860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vXG1F.png?s=128&g=1", "display_name": "paxdiablo", "link": "https://stackoverflow.com/users/14860/paxdiablo"}, "edited": false, "score": 0, "creation_date": 1527088644, "post_id": 50475356, "comment_id": 87996869, "body": "@paxdiablo I&#39;ve just checked your answer. Some intuitive contexts you mentioned :) Mike, Yes, I removed the alternative solution because I realized there will still atleast some collision on the Berenstain hashing. Also I was not sure if the Berenstain hashing works for anagrams as well. Sorry, ignore that one."}], "tags": [], "owner": {"reputation": 13895, "user_id": 1162233, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/e3Eil.jpg?s=128&g=1", "display_name": "Kaidul", "link": "https://stackoverflow.com/users/1162233/kaidul"}, "is_accepted": false, "score": 1, "last_activity_date": 1527020081, "last_edit_date": 1527020081, "creation_date": 1527018091, "answer_id": 50475356, "question_id": 50475317, "link": "https://stackoverflow.com/questions/50475317/resolving-equal-xor-values-for-different-strings-for-anagram-detection/50475356#50475356", "title": "Resolving equal XOR values for different strings for anagram detection", "body": "<p>Why do you need to do XOR on the first place?</p>\n\n<p>The most simple and fast enough approach is sort both the string by character and compare if both of them are equal or not. In this case, if you need faster sorting algorithm, you can use counting sort to achieve linear time.</p>\n\n<p>Another way is, you can simply count the number of characters in each string and check if those counts are equal. </p>\n\n<h2>EDIT</h2>\n\n<p>Your XOR based solution is not right in terms of correctness. There can be more than one combination of characters which can XOR up to a same number, the XOR of characters/ASCII codes of two different strings might not yield to different XOR all the time. So for same string, the output will be always correct. But for different string, the output MAY not be correct always (False positive).</p>\n"}, {"tags": [], "owner": {"reputation": 767708, "user_id": 14860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vXG1F.png?s=128&g=1", "display_name": "paxdiablo", "link": "https://stackoverflow.com/users/14860/paxdiablo"}, "is_accepted": true, "score": 5, "last_activity_date": 1527125597, "last_edit_date": 1527125597, "creation_date": 1527049455, "answer_id": 50479765, "question_id": 50475317, "link": "https://stackoverflow.com/questions/50475317/resolving-equal-xor-values-for-different-strings-for-anagram-detection/50479765#50479765", "title": "Resolving equal XOR values for different strings for anagram detection", "body": "<p>A pure <code>xor</code> solution will not work as there is information lost during the process (this problem is likely to exist in other forms of lossy calculation as well, such as hashing). The information lost in this case is the <em>actual</em> characters being used for comparison.</p>\n\n<p>By way of example, consider the two strings <code>ae</code> and <code>bf</code> (in ASCII):</p>\n\n<pre><code>  a: 0110 0001    b: 0110 0010\n  e: 0110 0101    f: 0110 0110\n     ---- ----       ---- ----\nxor: 0000 0100       0000 0100\n</code></pre>\n\n<p>You can see that the result of the <code>xor</code> is identical for both string <em>despite</em> the fact they are totally different.</p>\n\n<p>This may become even <em>more</em> obvious once you realise that any value <code>xor</code>-ed with itself is zero, meaning that all strings like <code>aa</code>, <code>bb</code>, <code>cc</code>, <code>xx</code>, and so on, would be considered anagrams under your scheme.</p>\n\n<p>So, now you've established that method as unsuitable, there are a couple of options that spring to mind.</p>\n\n<hr>\n\n<p>The first is to simply sort both strings and compare them. Once sorted, they will be identical on a character-by-character basis. This will work but it's unlikely to deliver your requested <code>O(n)</code> time complexity since you'll almost certainly be using a comparison style sort.</p>\n\n<hr>\n\n<p>The second still allows you to meet that requirement by using the usual \"trick\" of trading space for time. You simply set up a count of each character (all initially zero) then, for each character in the first string, increase its count.</p>\n\n<p>After that, for each character in the <em>second</em> string, <em>decrease</em> its count.</p>\n\n<p>That's linear time complexity and the strings can be deemed to be anagrams if every character count is set to zero after the process. Any non-zero count will only be there if a character occurred more times in one string than the other.</p>\n\n<p>This is effectively a <a href=\"https://en.wikipedia.org/wiki/Counting_sort\" rel=\"nofollow noreferrer\">counting sort</a>, a non-comparison sort meaning it's not subject to the normal minimum <code>O(n log n)</code> time complexity for those sorts.</p>\n\n<p>The <em>pseudo-code</em> for such a beast would be:</p>\n\n<pre><code>def isAnagram(str1, str2):\n    if len(str1) != len(str2):    # Can also handle different lengths.\n        return false\n\n    dim count[0..255] = {0}       # Init all counts to zero.\n\n    for each code in str1:        # Increase for each char in string 1.\n        count[code]++\n\n    for each code in str2:        # Decrease for each char in string 2.\n        count[code]--\n\n    for each code in 0..255:\n        if count[code] != 0:      # Any non-zero means non-anagram.\n            return false    \n\n    return true                   # All zero means anagram.\n</code></pre>\n\n<hr>\n\n<p>Here, by the way, is a complete C test program which illustrates this concept, able to handle 8-bit character widths though more widths can be added with a simple change to the <code>#if</code> section:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;limits.h&gt;\n#include &lt;stdbool.h&gt;\n\n#if CHAR_BIT == 8\n    #define ARRSZ 256\n#else\n    #error Need to adjust for unexpected CHAR_BIT.\n#endif\n\nstatic bool isAnagram(unsigned char *str1, unsigned char *str2) {\n    // Ensure strings are same size.\n\n    size_t len = strlen(str1);\n    if (len != strlen(str2))\n        return false;\n\n    // Initialise all counts to zero.\n\n    int count[ARRSZ];\n    for (size_t i = 0; i &lt; sizeof(count) / sizeof(*count); ++i)\n        count[i] = 0;\n\n    // Increment for string 1, decrement for string 2.\n\n    for (size_t i = 0; i &lt; len; ++i) {\n        count[str1[i]]++;\n        count[str2[i]]--;\n    }\n\n    // Any count non-zero means non-anagram.\n\n    for (size_t i = 0; i &lt; sizeof(count) / sizeof(*count); ++i)\n        if (count[i] != 0)\n            return false;\n\n    // All counts zero means anagram.\n\n    return true;\n}\n\nint main(int argc, char *argv[]) {\n    if ((argc - 1) % 2 != 0) {\n        puts(\"Usage: check_anagrams [&lt;string1&gt; &lt;string2&gt;] ...\");\n        return 1;\n    }\n\n    for (size_t i = 1; i &lt; argc; i += 2) {\n        printf(\"%s: '%s' '%s'\\n\",\n            isAnagram(argv[i], argv[i + 1]) ? \"Yes\" : \" No\",\n            argv[i], argv[i + 1]);\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>Running this on some suitable test data shows it in action:</p>\n\n<pre><code>pax$ ./check_anagrams ' paxdiablo ' 'a plaid box' paxdiablo PaxDiablo \\\n         one two aa bb aa aa '' '' paxdiablo pax.diablo\n\nYes: ' paxdiablo ' 'a plaid box'\n No: 'paxdiablo' 'PaxDiablo'\n No: 'one' 'two'\n No: 'aa' 'bb'\nYes: 'aa' 'aa'\nYes: '' ''\n No: 'paxdiablo' 'pax.diablo'\n</code></pre>\n"}], "owner": {"reputation": 1747, "user_id": 3726902, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/kV59z.png?s=128&g=1", "display_name": "Miket25", "link": "https://stackoverflow.com/users/3726902/miket25"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 357, "favorite_count": 0, "accepted_answer_id": 50479765, "answer_count": 2, "score": -1, "last_activity_date": 1527125597, "creation_date": 1527017980, "question_id": 50475317, "link": "https://stackoverflow.com/questions/50475317/resolving-equal-xor-values-for-different-strings-for-anagram-detection", "title": "Resolving equal XOR values for different strings for anagram detection", "body": "<p>I recently had an interview question where I had to write a function that takes two strings, and it would return <code>1</code> if they are anagrams of each other or else return <code>0</code>. To simplify things, both strings are of the same length, non-empty, and only contain lower-case alphabetical and numeric characters. </p>\n\n<p>What I implemented a function that accumulates the XOR value of each character of each string independently then compared the final XOR values of each string to see if they are equal. If they are, I would return <code>1</code>, else return <code>0</code>. </p>\n\n<p>My function:</p>\n\n<pre><code>int isAnagram(char* str1, char* str2){\n    int xor_acc_1 = 0;\n    int xor_acc_2 = 0;\n    for(int i = 0; i&lt;strlen(str1); i++){\n        xor_acc_1 ^= str1[i] - '0';\n        xor_acc_2 ^= str2[i] - '0';\n    }\n    return xor_acc_1 == xor_acc_2;\n}\n</code></pre>\n\n<p>My function worked for every case except for one test case.</p>\n\n<pre><code>char* str1 = \"123\";\nchar* str2 = \"303\";\n</code></pre>\n\n<p>To my surprise, even though these two strings are not anagrams of each other, they both returned <code>48</code> as their XOR value. </p>\n\n<p>My question is: Can this be resolve still with XOR in linear time, without the usage of a data structure e.g. a Map, through modification on the mathematics behind XOR? </p>\n"}]