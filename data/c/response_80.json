[{"tags": ["c", "compiler-errors", "inline-assembly", "mingw32", "att"], "comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1469056048, "post_id": 38492250, "comment_id": 64385871, "body": "Why are you using <code>=I</code> for an output-operand? That constraint is used for constants."}, {"owner": {"reputation": 3326, "user_id": 957950, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42736a5eb715da772cd40f4d8d260d06?s=128&d=identicon&r=PG", "display_name": "brichins", "link": "https://stackoverflow.com/users/957950/brichins"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 2, "creation_date": 1469056133, "post_id": 38492250, "comment_id": 64385884, "body": "@EOF because emoticons in code are adorable ;)"}, {"owner": {"reputation": 6093, "user_id": 2189500, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/109f747845a9ce762a1fff72eb8cf6f3?s=128&d=identicon&r=PG", "display_name": "David Wohlferd", "link": "https://stackoverflow.com/users/2189500/david-wohlferd"}, "edited": false, "score": 0, "creation_date": 1469056176, "post_id": 38492250, "comment_id": 64385895, "body": "What processor is this for?"}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "reply_to_user": {"reputation": 6093, "user_id": 2189500, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/109f747845a9ce762a1fff72eb8cf6f3?s=128&d=identicon&r=PG", "display_name": "David Wohlferd", "link": "https://stackoverflow.com/users/2189500/david-wohlferd"}, "edited": false, "score": 0, "creation_date": 1469056368, "post_id": 38492250, "comment_id": 64385949, "body": "@DavidWohlferd: <code>lpm</code> suggests AVR."}], "answers": [{"tags": [], "owner": {"reputation": 6093, "user_id": 2189500, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/109f747845a9ce762a1fff72eb8cf6f3?s=128&d=identicon&r=PG", "display_name": "David Wohlferd", "link": "https://stackoverflow.com/users/2189500/david-wohlferd"}, "is_accepted": false, "score": 0, "last_activity_date": 1469058097, "creation_date": 1469058097, "answer_id": 38492555, "question_id": 38492250, "link": "https://stackoverflow.com/questions/38492250/impossible-constraint-in-asm-asm-volatile/38492555#38492555", "title": "Impossible constraint in &#39;asm&#39;: __asm__ __volatile__", "body": "<p>As EOF says, the <code>I</code> constraint is used for parameters that are constant (see the AVR section at <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Machine-Constraints.html\" rel=\"nofollow\">https://gcc.gnu.org/onlinedocs/gcc/Machine-Constraints.html</a>).  By putting this parameter after the first colon (and by using an <code>=</code>), you are saying this is an output.  Outputting to a constant makes no sense.</p>\n\n<p>Also:</p>\n\n<ul>\n<li>You list <code>x</code>, <code>y</code>, and <code>z</code> as inputs to the asm (by putting them after the second colon), but they never get assigned a value.  An input that has never been assigned a value makes no sense.</li>\n<li>You are (apparently) modifying registers 29-31, but you don't tell the compiler that you are doing so?</li>\n</ul>\n\n<p>There's more, but I just can't follow what you think this code is supposed to do.  You might want to take some time to look thru the gcc <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Extended-Asm.html\" rel=\"nofollow\">docs</a> for asm to understand how this works.</p>\n"}, {"tags": [], "owner": {"reputation": 11138, "user_id": 1015327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00d71e011fc61cad60c5ffc9bf48c5ef?s=128&d=identicon&r=PG", "display_name": "JimmyB", "link": "https://stackoverflow.com/users/1015327/jimmyb"}, "is_accepted": false, "score": 1, "last_activity_date": 1469622846, "creation_date": 1469622846, "answer_id": 38613135, "question_id": 38492250, "link": "https://stackoverflow.com/questions/38492250/impossible-constraint-in-asm-asm-volatile/38613135#38613135", "title": "Impossible constraint in &#39;asm&#39;: __asm__ __volatile__", "body": "<p>Notice that gcc's inline assembly syntax is </p>\n\n<pre><code>asm [volatile] ( AssemblerTemplate\n                      : OutputOperands\n                      [ : InputOperands\n                      [ : Clobbers ] ])\n</code></pre>\n\n<p>After the assembler instructions first come the <strong>output</strong> operands, then the inputs.</p>\n\n<p>As @DavidWohlferd said, <code>I</code> is for <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Machine-Constraints.html#Machine-Constraints\" rel=\"nofollow\">\"constant greater than \u22121, less than 64 \"</a>constants (\"immediates\").</p>\n\n<p>While the <code>out</code> instruction in fact requires a constant value from that range, <code>PORTB</code> is <em>not</em> that constant value. (You can see that for yourself if you look into the corresponding <code>avr/ioXXXX.h</code> file for your controller, where you may find something like <code>#define PORTB _SFR_IO8(0x05)</code>.)</p>\n\n<p>Also, not all IO registers may be accessible via <code>out</code>/<code>in</code>; especially the bigger controllers have more than 64 IO registers, but only the first 64 can be accessed as such. However, all IO registers can be accessed at their memory-mapped address through <code>lds</code>/<code>sts</code>. So, depending on which register on which controller you want to access you may not be able to use <code>out</code> for that register at all, but you can always use <code>sts</code> instead. If you want your code to be portable you'll have to take that into account, like suggested <a href=\"http://www.nongnu.org/avr-libc/user-manual/group__avr__sfr__notes.html\" rel=\"nofollow\">here</a> for example.</p>\n\n<p>If you know that <code>PORTB</code> is one of the first 64 IO registers on your controller, you can use</p>\n\n<p><code>\"I\" (_SFR_IO_ADDR( PORTB ))</code> with <code>out</code>, else use</p>\n\n<p><code>\"m\" ( PORTB )</code> with <code>sts</code>.</p>\n\n<p>So this:</p>\n\n<pre><code>__asm__ __volatile__(\"\\n\"\n    \"addl r29,%0\\n\"\n    \"addl r30,%1\\n\"\n    \"addl r31,%2\\n\"\n    \"lpm\\n\"\n    \"out %3,r0\\n\"\n    : /* No output operands here */\n    : \"r\" (x), \"r\" (y), \"r\" (z), \"I\" (_SFR_IO_ADDR( PORTB ))\n\n);\n</code></pre>\n\n<p>should get you rid of that \"impossible constraint\" error. Although the code still does not make any sense, mostly because you're using \"random\", uninitialized data as input. You clobber registers r29-r31 without declaring them, and I'm totally not sure what your intention is with all the code before the <code>lpm</code>.</p>\n"}], "owner": {"reputation": 1, "user_id": 4809573, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-LAWV3sHi_6M/AAAAAAAAAAI/AAAAAAAAACg/7nq_GE53CzE/photo.jpg?sz=128", "display_name": "Icronace", "link": "https://stackoverflow.com/users/4809573/icronace"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1699, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1469622846, "creation_date": 1469055727, "last_edit_date": 1469055761, "question_id": 38492250, "link": "https://stackoverflow.com/questions/38492250/impossible-constraint-in-asm-asm-volatile", "title": "Impossible constraint in &#39;asm&#39;: __asm__ __volatile__", "body": "<p>I trying since a few days to write a very simple inline assembler code, but nothing worked. I have as IDE NetBeans and as compiler MinGW.\nMy latest code is:</p>\n\n<pre><code>uint16 readle_uint16(const uint8 * buffer, int offset) {\n    unsigned char x, y, z;\n    unsigned int PORTB;\n    __asm__ __volatile__(\"\\n\"\n        \"addl r29,%0\\n\"\n        \"addl r30,%1\\n\"\n        \"addl r31,%2\\n\"\n        \"lpm\\n\"\n        \"out %3,r0\\n\"\n        : \"=I\" (PORTB)\n        : \"r\" (x), \"r\" (y), \"r\" (z)\n    );\n    return value;\n}\n</code></pre>\n\n<p>But I get everytime the same message \"error: impossible constraint in 'asm'\".\nI tried to write all in a single line or to use different <code>asm</code> introductions. I have no idea what I can do otherwise.</p>\n"}, {"tags": ["c", "linux", "linux-kernel"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 2, "creation_date": 1469054746, "post_id": 38492059, "comment_id": 64385507, "body": "Compiler-supported string literal concatenation. Look at the definition of <code>KERN_INFO</code>. I don&#39;t do kernels, but I bet it is a string literal <code>#define</code>"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 2, "creation_date": 1469060526, "post_id": 38492059, "comment_id": 64386917, "body": "@WhozCraig: String literal concatenation isn&#39;t merely compiler-supported. It&#39;s defined by the language, and has been since 1989."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 6, "creation_date": 1469060582, "post_id": 38492059, "comment_id": 64386930, "body": "Note that multiple arguments <i>are</i> separated by commas: <code>printfk(KERN_INFO &quot;n = %d\\n&quot;, n);</code>. The format string <code>KERN_INFO &quot;n = %d\\n&quot;</code> is the first argument, and <code>n</code> is the second."}, {"owner": {"reputation": 938, "user_id": 1486966, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/33c0e5556fbfcda1fbd3ce24fc901f92?s=128&d=identicon&r=PG", "display_name": "datu-puti", "link": "https://stackoverflow.com/users/1486966/datu-puti"}, "edited": false, "score": 0, "creation_date": 1469060747, "post_id": 38492059, "comment_id": 64386968, "body": "I don&#39;t want to edit my original question, so I&#39;ll put this here. Does anyone have insight as to why the linux kernel would parse messages like this? Why not pass these as separate arguments?"}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1469064725, "post_id": 38492059, "comment_id": 64387874, "body": "@KeithThompson Completely not what I meant, though if wordsmithed strict enough, you certainly could slice it that way. i meant, and still mean, the compiler concatenated the string literals. Had I intended to say it was dependent on some subset of compiler implementations, I can assure you I would have said &quot;Compiler-<i>dependent</i>&quot;, which would obviously be wrong."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1469065990, "post_id": 38492059, "comment_id": 64388126, "body": "@WhozCraig: I wasn&#39;t disagreeing with what you wrote, just expanding on it. &quot;Compiler-supported&quot; doesn&#39;t necessarily imply that <i>all</i> C compilers implement it."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 1, "creation_date": 1469066115, "post_id": 38492059, "comment_id": 64388144, "body": "<code>printk</code> is analogous to <code>printf</code>, which takes a format string and zero or more following arguments. And it&#39;s possible (this is sheer speculation) that early versions of Linux didn&#39;t support different log levels; adding them by prepending a string to the format wouldn&#39;t have broken existing code."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 2, "creation_date": 1469098755, "post_id": 38492059, "comment_id": 64403546, "body": "<code>Why not pass these as separate arguments?</code> efficiency.  Why would you want to <code>push</code> an extra arg separately, and then have printk pre-pend it to the string?  In ABIs that pass the first few args in registers, that effectively wastes an arg-passing register. There&#39;s also a code-size advantage.  The machine instruction to push an immediate integer is always going to be larger than prepending the data directly into the string. Passing a pointer instead of the actual bytes to be pre-pended is even worse, because then the bytes need to be stored somewhere AND you need a 32bit pointer in the code."}, {"owner": {"reputation": 938, "user_id": 1486966, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/33c0e5556fbfcda1fbd3ce24fc901f92?s=128&d=identicon&r=PG", "display_name": "datu-puti", "link": "https://stackoverflow.com/users/1486966/datu-puti"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1469111908, "post_id": 38492059, "comment_id": 64412575, "body": "@PeterCordes That makes perfect sense. I always thought that string manipulation was a pretty expensive task. At some point the kernel will have to strip off the prepended log level metadata. Since they&#39;re always the same length, then I guess it&#39;s as simple as advancing the char array base pointer a few spots, which isn&#39;t expensive. Thanks"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1469133527, "post_id": 38492059, "comment_id": 64424900, "body": "@elBradford: oh right, the log level bytes aren&#39;t actually logged, since the log-level filtering happens in kernel.  I was mixed up on that.  The log-level wouldn&#39;t need to be pre-pended.  You&#39;re right that leaving out the first 2 bytes when memcpying into the output log buffer is trivially cheap.  I think the prefix instead of a separate arg maybe evolved as a backwards-compat way to add log-levels.  So existing code with format strings that didn&#39;t include a level prefix kept working, and the change to having log levels could happen gradually.  Code-size in the callers is another advantage."}], "answers": [{"tags": [], "owner": {"reputation": 7787, "user_id": 1257035, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WHLC8.png?s=128&g=1", "display_name": "a3f", "link": "https://stackoverflow.com/users/1257035/a3f"}, "is_accepted": false, "score": 7, "last_activity_date": 1469054754, "creation_date": 1469054754, "answer_id": 38492100, "question_id": 38492059, "link": "https://stackoverflow.com/questions/38492059/why-doesnt-the-function-printk-use-a-comma-to-separate-parameters/38492100#38492100", "title": "Why doesn&#39;t the function printk() use a comma to separate parameters?", "body": "<p>The log level isn't an integer but a string literal. String literals next to each other are concatenated into a single string literal at compile time.</p>\n"}, {"tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": false, "score": 5, "last_activity_date": 1469054787, "creation_date": 1469054787, "answer_id": 38492109, "question_id": 38492059, "link": "https://stackoverflow.com/questions/38492059/why-doesnt-the-function-printk-use-a-comma-to-separate-parameters/38492109#38492109", "title": "Why doesn&#39;t the function printk() use a comma to separate parameters?", "body": "<p>Because if you search the header files you will see that e.g. <a href=\"http://lxr.free-electrons.com/source/include/linux/kern_levels.h#L13\"><code>KERN_INFO</code></a> is a macro expanded as a <em>string literal</em> (actually multiple string literals, see e.g. the linked cross-reference), and two string literals next to each-other like that will be concatenated into a single string literal by the compiler.</p>\n\n<p>So the call</p>\n\n<pre><code>printk(KERN_INFO \"Log message.\\n\");\n</code></pre>\n\n<p>isn't a function call with multiple arguments, it's a function call with a single string literal argument.</p>\n"}, {"comments": [{"owner": {"reputation": 938, "user_id": 1486966, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/33c0e5556fbfcda1fbd3ce24fc901f92?s=128&d=identicon&r=PG", "display_name": "datu-puti", "link": "https://stackoverflow.com/users/1486966/datu-puti"}, "edited": false, "score": 1, "creation_date": 1469060527, "post_id": 38492120, "comment_id": 64386918, "body": "Thank you. I saw that the log levels in the header were numbers and missed that they were string literals. I also had to do a little refresher about how C concatenates string literals separated by a space."}, {"owner": {"reputation": 609, "user_id": 11143545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/617c9145bb039f1defedce54b28e89b3?s=128&d=identicon&r=PG&f=1", "display_name": "Herdsman", "link": "https://stackoverflow.com/users/11143545/herdsman"}, "edited": false, "score": 0, "creation_date": 1578392551, "post_id": 38492120, "comment_id": 105415038, "body": "@PSkocik, but why is macro <code>KERN_INFO</code> <code>&quot;\\001&quot; &quot;6&quot;</code>? I only understand null character at the beginning, but then it is 01 in octal? (as preceding <code>0</code>? - so it is <code>016</code> in octal after concatenation? In ascii is 016 (<code>14</code> in decimal, <code>0E</code> in hex, <code>SO - shift out</code>, so it is to be sure the next <code>6</code> wont be <code>^</code>?) and then - I have tried to look up the macro in <code>&#47;usr&#47;include&#47;linux&#47;kernel.h</code>, but have not found it. Is it in that dir or somewhere else?"}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "reply_to_user": {"reputation": 609, "user_id": 11143545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/617c9145bb039f1defedce54b28e89b3?s=128&d=identicon&r=PG&f=1", "display_name": "Herdsman", "link": "https://stackoverflow.com/users/11143545/herdsman"}, "edited": false, "score": 0, "creation_date": 1578403963, "post_id": 38492120, "comment_id": 105420776, "body": "@Herdsman The syntax for escape sequences is in <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.4.4.4\" rel=\"nofollow noreferrer\">port70.net/~nsz/c/c11/n1570.html#6.4.4.4</a>. Namely for octals it&#39;s &#39;\\&#39; + 1\u20133 octal digits (including the initiating 0). So &quot;\\0016&quot; (or the equivalent &quot;\\001&quot; &quot;6&quot;) is parsed as  &quot;{001}6&quot;, i.e., byte 1 followed by the digit six (byte 36 in decimal ASCII). The limit of 3 octal digit is why, I guess, an octal escape is used as opposed to a hexadecimal one. The hexadecimal escape doesn&#39;t have a digit limit so <code>&quot;\\x111111111aaaabbbcccdddeeefffgreetings, world&quot;</code> would be interpret everything up to the g as an escape."}], "tags": [], "owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "is_accepted": true, "score": 22, "last_activity_date": 1469101454, "last_edit_date": 1469101454, "creation_date": 1469054885, "answer_id": 38492120, "question_id": 38492059, "link": "https://stackoverflow.com/questions/38492059/why-doesnt-the-function-printk-use-a-comma-to-separate-parameters/38492120#38492120", "title": "Why doesn&#39;t the function printk() use a comma to separate parameters?", "body": "<p>The <code>printk()</code> function only takes one <code>const char*</code> argument. The <code>KERN_INFO</code> macro expands to <code>\"\\001\" \"6\"</code>, yielding:</p>\n\n<pre><code>printk(\"\\001\" \"6\" \"Log message.\\n\");\n</code></pre>\n\n<p>The C lexer concatenates adjacent string literal tokens which means that\nthe above is converted into:</p>\n\n<pre><code>printk(\"\\0016Log message.\\n\");\n</code></pre>\n"}], "owner": {"reputation": 938, "user_id": 1486966, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/33c0e5556fbfcda1fbd3ce24fc901f92?s=128&d=identicon&r=PG", "display_name": "datu-puti", "link": "https://stackoverflow.com/users/1486966/datu-puti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1908, "favorite_count": 0, "accepted_answer_id": 38492120, "answer_count": 3, "score": 15, "last_activity_date": 1469103895, "creation_date": 1469054507, "last_edit_date": 1469103895, "question_id": 38492059, "link": "https://stackoverflow.com/questions/38492059/why-doesnt-the-function-printk-use-a-comma-to-separate-parameters", "title": "Why doesn&#39;t the function printk() use a comma to separate parameters?", "body": "<p>An example <code>printk</code> call:</p>\n\n<pre><code>printk(KERN_INFO \"Log message.\\n\");\n</code></pre>\n\n<p>Perhaps this question is more about C in general, because I've never seen a function in C before that separated parameters without a comma. </p>\n\n<p>How does this work? What does the compiler do with this information? Since the log level is an integer and the message is a pointer to a char array, it must pass them separately.</p>\n"}, {"tags": ["c", "arrays", "casting", "c11"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1469054521, "post_id": 38492024, "comment_id": 64385453, "body": "Fyi, &quot;I have good reason to think it this&quot; - that reason is likely worthy of mentioning in your question."}, {"owner": {"reputation": 14710, "user_id": 5538420, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/oc81s.jpg?s=128&g=1", "display_name": "dxiv", "link": "https://stackoverflow.com/users/5538420/dxiv"}, "edited": false, "score": 1, "creation_date": 1469054769, "post_id": 38492024, "comment_id": 64385512, "body": "Yes, it&#39;s compliant. See <a href=\"http://stackoverflow.com/questions/6290956/one-dimensional-access-to-a-multidimensional-array-well-defined-c\">One-dimensional access to a multidimensional array: well-defined C?</a>."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1469055776, "post_id": 38492024, "comment_id": 64385788, "body": "<a href=\"http://stackoverflow.com/questions/27093290/can-an-array-have-trailing-padding\" title=\"can an array have trailing padding\">stackoverflow.com/questions/27093290/&hellip;</a>"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1469058371, "post_id": 38492024, "comment_id": 64386483, "body": "write <code>assert(sizeof(buf) == 2 * 5 * sizeof(buf[0][0]));</code> before do it."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "reply_to_user": {"reputation": 14710, "user_id": 5538420, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/oc81s.jpg?s=128&g=1", "display_name": "dxiv", "link": "https://stackoverflow.com/users/5538420/dxiv"}, "edited": false, "score": 0, "creation_date": 1469079145, "post_id": 38492024, "comment_id": 64391494, "body": "@dxiv The first two answers explain this is ub, how is this compliant? And what do you mean by &#39;compliant&#39;?"}, {"owner": {"reputation": 14710, "user_id": 5538420, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/oc81s.jpg?s=128&g=1", "display_name": "dxiv", "link": "https://stackoverflow.com/users/5538420/dxiv"}, "reply_to_user": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1469079838, "post_id": 38492024, "comment_id": 64391744, "body": "@2501 <code>The first two answers explain this is ub</code> (1) Please specify <i>which</i> ones, since the order they are listed in may/oes change with time, so <i>first</i> is meaningless. (2) If you meant the <i>accepted</i> answer, then please read to the end: <code>special case that should be noted: if your type were unsigned char (or any char type), accessing the multi-dimensional array as a one-dimensional array would be perfectly well-defined.</code>. Note that OP&#39;s question here specifically used <code>char</code>."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "reply_to_user": {"reputation": 14710, "user_id": 5538420, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/oc81s.jpg?s=128&g=1", "display_name": "dxiv", "link": "https://stackoverflow.com/users/5538420/dxiv"}, "edited": false, "score": 0, "creation_date": 1469079971, "post_id": 38492024, "comment_id": 64391804, "body": "@dxiv The first two by votes. Ok I agree. You didn&#39;t explain what is &#39;compliant&#39; though."}], "answers": [{"tags": [], "owner": {"reputation": 1233, "user_id": 5366130, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ce3d4bd07d1115070e7727de382560ba?s=128&d=identicon&r=PG&f=1", "display_name": "Omid CompSCI", "link": "https://stackoverflow.com/users/5366130/omid-compsci"}, "is_accepted": false, "score": -1, "last_activity_date": 1469056088, "last_edit_date": 1469056088, "creation_date": 1469054818, "answer_id": 38492112, "question_id": 38492024, "link": "https://stackoverflow.com/questions/38492024/is-it-defined-behavior-to-treat-2-dimensional-array-as-one/38492112#38492112", "title": "Is it defined behavior to treat 2 dimensional array as one?", "body": "<p>I believe, it can be treated as a 1-D array when using explicit casting. </p>\n\n<p>Essentially just removing a double pointer to just one, and I believe the use of explicit casting in this form is standard.</p>\n\n<pre><code>char ** buf; //equal to char[][]\n(char*) buf; //equal to char[]\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6274708"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 84, "favorite_count": 0, "closed_date": 1469056112, "answer_count": 1, "score": 3, "last_activity_date": 1469056088, "creation_date": 1469054303, "question_id": 38492024, "link": "https://stackoverflow.com/questions/38492024/is-it-defined-behavior-to-treat-2-dimensional-array-as-one", "closed_reason": "Duplicate", "title": "Is it defined behavior to treat 2 dimensional array as one?", "body": "<p>I can imagine a two dimensional array as a contagious sequence of bytes. My question is, can it be treated as a one dimensional array with explicit cast without invoking undefined behavior?</p>\n\n<p>I have tested the following code with gcc and it ran normally and didn't crash. What does the standard say about it?</p>\n\n<pre><code>int main(void)\n{\n    char buf[2][5];\n    strcpy((char *)buf, \"link 101\");\n    printf(\"%s\\n\", (char *)buf);\n    return 0;\n}\n</code></pre>\n\n<p>Just saying, I have good reason to think of this.</p>\n"}, {"tags": ["ios", "objective-c", "c", "cydia-substrate", "logos"], "answers": [{"tags": [], "owner": {"reputation": 624, "user_id": 4130118, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/8173a2afd21cacb48123cec8f151901b?s=128&d=identicon&r=PG&f=1", "display_name": "jp2g", "link": "https://stackoverflow.com/users/4130118/jp2g"}, "is_accepted": false, "score": 0, "last_activity_date": 1469054033, "creation_date": 1469054033, "answer_id": 38491971, "question_id": 38491896, "link": "https://stackoverflow.com/questions/38491896/setting-frame-if-in-landscape-not-functioning-ios/38491971#38491971", "title": "Setting frame if in landscape not functioning iOS", "body": "<p>Avoid using <code>[[UIDevice currentDevice] orientation...</code>.   This is the hardware orientation and does not always reflect the true state of the user interface.   Use <code>UIInterfaceOrientation orientation = [[UIApplication sharedApplication] statusBarOrientation]</code> instead.</p>\n\n<p>Lastly, you should really be using Auto Layout instead of manipulating frames directly like that.</p>\n"}, {"tags": [], "owner": {"reputation": 1682, "user_id": 551487, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/6479d27cd08130093e24aa6994dc0d41?s=128&d=identicon&r=PG", "display_name": "JingJingTao", "link": "https://stackoverflow.com/users/551487/jingjingtao"}, "is_accepted": false, "score": 0, "last_activity_date": 1469054673, "creation_date": 1469054673, "answer_id": 38492083, "question_id": 38491896, "link": "https://stackoverflow.com/questions/38491896/setting-frame-if-in-landscape-not-functioning-ios/38492083#38492083", "title": "Setting frame if in landscape not functioning iOS", "body": "<p>You can just set the center of SBControlCenterContainerView in it's parent, hope this helps and good luck.</p>\n\n<pre><code>// In Parent UIViewController\nself.sBControlCenterContainerView.center = self.view.center;\n</code></pre>\n"}], "owner": {"reputation": 143, "user_id": 6458593, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/73ca8861b7d9ef3e2223d10ad44e6a58?s=128&d=identicon&r=PG&f=1", "display_name": "TheHellOTrofasdasd", "link": "https://stackoverflow.com/users/6458593/thehellotrofasdasd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1469054673, "creation_date": 1469053666, "question_id": 38491896, "link": "https://stackoverflow.com/questions/38491896/setting-frame-if-in-landscape-not-functioning-ios", "title": "Setting frame if in landscape not functioning iOS", "body": "<p>I am writing a tweak to change the size of the control center.</p>\n\n<p>I am trying to set the frame depending on the orientation.</p>\n\n<p>This is the code:</p>\n\n<pre><code>%hook SBControlCenterContainerView\n-(void)layoutSubviews{\n%orig;\nCGRect screenBounds = [[UIScreen mainScreen] bounds];\nif ([[UIDevice currentDevice] orientation] == UIDeviceOrientationLandscapeLeft || [[UIDevice currentDevice] orientation ]== UIDeviceOrientationLandscapeRight){\nself.frame = CGRectMake(0, 0, (screenBounds.size.width - 20), 427);\n} else {\nself.frame = CGRectMake(0, 227, screenBounds.size.width - 20, 427);\n}\n}\n%end\n</code></pre>\n\n<p>But the frame does not change if I switch to landscape mode. It only sets the frame with what is set for the else statement. What am I doing wrong and it there an alternative?</p>\n"}, {"tags": ["c", "xcode", "macros"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1469051835, "post_id": 38491490, "comment_id": 64384567, "body": "Home-brew Boolean types are usually a bad idea. Use <code>stdbool.h</code>."}], "answers": [{"comments": [{"owner": {"reputation": 4380, "user_id": 3840981, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/uGzrp.png?s=128&g=1", "display_name": "Rob Sanders", "link": "https://stackoverflow.com/users/3840981/rob-sanders"}, "edited": false, "score": 0, "creation_date": 1469051885, "post_id": 38491531, "comment_id": 64384584, "body": "Ahh **** I am a noob. Thanks."}, {"owner": {"reputation": 5024, "user_id": 4439794, "user_type": "registered", "accept_rate": 39, "profile_image": "https://i.stack.imgur.com/ogyE1.png?s=128&g=1", "display_name": "Trevor", "link": "https://stackoverflow.com/users/4439794/trevor"}, "reply_to_user": {"reputation": 4380, "user_id": 3840981, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/uGzrp.png?s=128&g=1", "display_name": "Rob Sanders", "link": "https://stackoverflow.com/users/3840981/rob-sanders"}, "edited": false, "score": 0, "creation_date": 1469077844, "post_id": 38491531, "comment_id": 64391072, "body": "@RASS  and you should use <code>typedef</code> for type definition, shouldn&#39;t use <code>define</code>"}], "tags": [], "owner": {"reputation": 7587, "user_id": 943010, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/R7Q27.png?s=128&g=1", "display_name": "kdopen", "link": "https://stackoverflow.com/users/943010/kdopen"}, "is_accepted": false, "score": 5, "last_activity_date": 1469059499, "last_edit_date": 1469059499, "creation_date": 1469051839, "answer_id": 38491531, "question_id": 38491490, "link": "https://stackoverflow.com/questions/38491490/c-import-defines-from-header-file/38491531#38491531", "title": "C import #defines from header file", "body": "<p>Remove all the semi-colons from your <code>#define</code> statements!</p>\n\n<p>Beyond that, there is no need to define these types. They are already there in <code>&lt;stdbool.h&gt;</code> which gives you <code>bool</code>, <code>true</code>, and <code>false</code>.</p>\n"}], "owner": {"reputation": 4380, "user_id": 3840981, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/uGzrp.png?s=128&g=1", "display_name": "Rob Sanders", "link": "https://stackoverflow.com/users/3840981/rob-sanders"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 678, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1469059499, "creation_date": 1469051641, "last_edit_date": 1592644375, "question_id": 38491490, "link": "https://stackoverflow.com/questions/38491490/c-import-defines-from-header-file", "title": "C import #defines from header file", "body": "<p>I'm using Xcode to develop little C command line tools and I have a header file that looks like this:</p>\n<pre><code>#define Bool unsigned char;\n#define YES ((Bool) 1);\n#define true ((Bool) 1);\n#define NO ((Bool) 0);\n#define false ((Bool) 0);\n</code></pre>\n<p>In another .c file I'm importing the header file like so</p>\n<p><code>#include &quot;Definitions.h&quot;</code></p>\n<p>Whenever I use <code>Bool</code> or <code>true</code> or <code>false</code> Xcode gives me the following warnings:</p>\n<blockquote>\n<p>Type specifier missing, defaults to 'int'</p>\n<p>Declaration does not declare anything</p>\n</blockquote>\n<p>For a function like so:</p>\n<p><a href=\"https://i.stack.imgur.com/Ql54V.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Ql54V.png\" alt=\"enter image description here\" /></a></p>\n<p>If I take out the <code>include &quot;Definitions.h&quot;</code> and just put the defines in the c file all the warnings go away.</p>\n<p>What is going on here?</p>\n"}, {"tags": ["c", "file-io", "unicode", "utf-8"], "comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1469052074, "post_id": 38491380, "comment_id": 64384646, "body": "Did you make sure <code>stdout</code> was not byte-oriented?"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1469052379, "post_id": 38491380, "comment_id": 64384756, "body": "@EOF: actually <code>stdout</code> must be byte oriented and the proper locale must be selected for this work."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "reply_to_user": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1469052454, "post_id": 38491380, "comment_id": 64384786, "body": "@chqrlie: Not if you want to use <code>wprintf()</code> as the OP apparently does."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1469053492, "post_id": 38491380, "comment_id": 64385149, "body": "@EOF: The OP tried using <code>wprintf()</code> for his purpose, but he does not necessarily want to use the wide string versions, he merely wants to convert Unicode codepoints to UTF-8."}], "answers": [{"comments": [{"owner": {"reputation": 2277, "user_id": 4591810, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/61e63df3db53ef926974e7a2dafd3cf7?s=128&d=identicon&r=PG&f=1", "display_name": "hazrmard", "link": "https://stackoverflow.com/users/4591810/hazrmard"}, "edited": false, "score": 0, "creation_date": 1469053227, "post_id": 38491581, "comment_id": 64385060, "body": "Setting locale does not help. <code>fprintf()</code> and <code>wprintf()</code> only print/store blank space, and <code>fwprintf()</code> stores incorrect characters on the file."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 2277, "user_id": 4591810, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/61e63df3db53ef926974e7a2dafd3cf7?s=128&d=identicon&r=PG&f=1", "display_name": "hazrmard", "link": "https://stackoverflow.com/users/4591810/hazrmard"}, "edited": false, "score": 0, "creation_date": 1469053519, "post_id": 38491581, "comment_id": 64385155, "body": "What are your platform and compiler?"}, {"owner": {"reputation": 2277, "user_id": 4591810, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/61e63df3db53ef926974e7a2dafd3cf7?s=128&d=identicon&r=PG&f=1", "display_name": "hazrmard", "link": "https://stackoverflow.com/users/4591810/hazrmard"}, "edited": false, "score": 0, "creation_date": 1469057955, "post_id": 38491581, "comment_id": 64386391, "body": "Win10, gcc 5.3, Cygwin"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 2277, "user_id": 4591810, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/61e63df3db53ef926974e7a2dafd3cf7?s=128&d=identicon&r=PG&f=1", "display_name": "hazrmard", "link": "https://stackoverflow.com/users/4591810/hazrmard"}, "edited": false, "score": 0, "creation_date": 1469111747, "post_id": 38491581, "comment_id": 64412480, "body": "The support for locale and multibyte encoding is in the C library.  On Windows, you may use either the MSVC runtime library or the Cygwin specific C library, derived from the Glibc, which I believe has better support.  To avoid this issue, use your own UTF-8 converter."}], "tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 2, "last_activity_date": 1469111593, "last_edit_date": 1469111593, "creation_date": 1469052030, "answer_id": 38491581, "question_id": 38491380, "link": "https://stackoverflow.com/questions/38491380/how-to-print-unicode-codepoints-as-characters-in-c/38491581#38491581", "title": "How to print Unicode codepoints as characters in C?", "body": "<p>You must first select the proper locale with:</p>\n\n<pre><code>#include &lt;locale.h&gt;\n\nsetlocale(LC_ALL, \"C.UTF-8\");\n</code></pre>\n\n<p>or </p>\n\n<pre><code>setlocale(LC_ALL, \"en_US.UTF-8\");\n</code></pre>\n\n<p>And then use <code>printf</code> or <code>fprintf</code> with the <code>%lc</code> format:</p>\n\n<pre><code>printf(\"%lc\", UINT32_T_VARIABLE);\n</code></pre>\n\n<p>This will work only for Unicode code points small enough to fit in a <code>wchar_t</code>.  For a more complete and portable solution, you may nee to implement the Unicode to UTF-8 conversion yourself, which is not very difficult.</p>\n"}, {"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1469059987, "post_id": 38492214, "comment_id": 64386806, "body": "The correct range for the high and low surrogates is U+D800 .. U+DFFF (split into high surrogates U+D800 .. U+DBFF and low surrogates U+DC00 .. U+DFFF) rather than U+D000 .. U+DFFF as in one version of the code in the answer.  The chart for <a href=\"http://www.unicode.org/charts/PDF/UAC00.pdf\" rel=\"nofollow noreferrer\">U+AC00 .. U+D7AF</a> covers Hangul Syllables.  As you said, it&#39;s easy to mess it up."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 1, "creation_date": 1469111407, "post_id": 38492214, "comment_id": 64412256, "body": "The code is incorrect for the intermediary sequence bytes in the 3 and 4 byte cases: you must mask off the <code>0x40</code> bit after shifting <code>codepoint</code>... <i>simple, yet easy to mess up</i> indeed."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1469112451, "post_id": 38492214, "comment_id": 64412969, "body": "@chqrlie Yes, bit needed clearing (in 2 byte case too) - code amended."}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 1, "last_activity_date": 1469112395, "last_edit_date": 1495540424, "creation_date": 1469055455, "answer_id": 38492214, "question_id": 38491380, "link": "https://stackoverflow.com/questions/38491380/how-to-print-unicode-codepoints-as-characters-in-c/38492214#38492214", "title": "How to print Unicode codepoints as characters in C?", "body": "<p>Best to use existing code when available.</p>\n\n<p>Rolling ones own Unicode code-point to <a href=\"https://en.wikipedia.org/wiki/UTF-8\" rel=\"nofollow noreferrer\">UTF8</a> is simply, yet easy to mess up.  The answer took 2 edits to fix. <a href=\"https://stackoverflow.com/questions/38491380/how-to-print-unicode-codepoints-as-characters-in-c/38492214?noredirect=1#comment64386806_38492214\">@Jonathan Leffler</a> <a href=\"https://stackoverflow.com/questions/38491380/how-to-print-unicode-codepoints-as-characters-in-c/38492214?noredirect=1#comment64412256_38492214\">@chqrlie</a>, so rigorous testing is recommended for any self-coded solution.  Follows is lightly tested code to convert a code-point to an array.<br>\nNote that the result is not a <em>string</em>.</p>\n\n<pre><code>// Populate utf8 with 0-4 bytes\n// Return length used in utf8[]\n// 0 implies bad codepoint\nunsigned Unicode_CodepointToUTF8(uint8_t *utf8, uint32_t codepoint) {\n  if (codepoint &lt;= 0x7F) {\n    utf8[0] = codepoint;\n    return 1;\n  }\n  if (codepoint &lt;= 0x7FF) {\n    utf8[0] = 0xC0 | (codepoint &gt;&gt; 6);\n    utf8[1] = 0x80 | (codepoint &amp; 0x3F);\n    return 2;\n  }\n  if (codepoint &lt;= 0xFFFF) {\n    // detect surrogates\n    if (codepoint &gt;= 0xD800 &amp;&amp; codepoint &lt;= 0xDFFF) return 0;\n    utf8[0] = 0xE0 | (codepoint &gt;&gt; 12);\n    utf8[1] = 0x80 | ((codepoint &gt;&gt; 6) &amp; 0x3F);\n    utf8[2] = 0x80 | (codepoint &amp; 0x3F);\n    return 3;\n  }\n  if (codepoint &lt;= 0x10FFFF) {\n    utf8[0] = 0xF0 | (codepoint &gt;&gt; 18);\n    utf8[1] = 0x80 | ((codepoint &gt;&gt; 12) &amp; 0x3F);\n    utf8[2] = 0x80 | ((codepoint &gt;&gt; 6) &amp; 0x3F);\n    utf8[3] = 0x80 | (codepoint &amp; 0x3F);\n    return 4;\n  }\n  return 0;\n}\n\n// Sample usage\nuint32_t cp = foo();\nuint8_t utf8[4];\nunsigned len = Unicode_CodepointToUTF8(utf8, cp);\nif (len == 0) Handle_BadCodePoint();\nsize_t y = fwrite(utf8, 1, len, stream_opened_in_binary_mode);\n</code></pre>\n"}], "owner": {"reputation": 2277, "user_id": 4591810, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/61e63df3db53ef926974e7a2dafd3cf7?s=128&d=identicon&r=PG&f=1", "display_name": "hazrmard", "link": "https://stackoverflow.com/users/4591810/hazrmard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1018, "favorite_count": 2, "answer_count": 2, "score": 5, "last_activity_date": 1469112395, "creation_date": 1469051096, "question_id": 38491380, "link": "https://stackoverflow.com/questions/38491380/how-to-print-unicode-codepoints-as-characters-in-c", "title": "How to print Unicode codepoints as characters in C?", "body": "<p>I have an array of <code>uint32_t</code> elements that each store a codepoint for a non-latin Unicode character. How do I print them on the console or store them in a file as UTF-8 encoded characters? I understand that they may fail to render properly on a console, but they should display fine if I open them in a compatible editor.  </p>\n\n<p>I have tried using <code>wprintf(L\"%lc\", UINT32_T_VARIABLE)</code>, and <code>fwprintf(FILE_STREAM, L\"%lc\", UINT32_T_VARIABLE)</code> but to no avail.</p>\n"}, {"tags": ["c", "recursion", "binary-tree"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1469047585, "post_id": 38490469, "comment_id": 64382715, "body": "It doesn&#39;t work - how? And what are you doing with the result of the recursive calls? Looks like nothing, as <code>count</code> is local to every instance of the call."}], "answers": [{"tags": [], "owner": {"reputation": 3239, "user_id": 5271927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aTJYf.jpg?s=128&g=1", "display_name": "KIIV", "link": "https://stackoverflow.com/users/5271927/kiiv"}, "is_accepted": false, "score": 0, "last_activity_date": 1469047613, "creation_date": 1469047613, "answer_id": 38490535, "question_id": 38490469, "link": "https://stackoverflow.com/questions/38490469/counting-the-specific-nodes-in-a-binary-tree-in-which-the-nodes-are-chars-in-c/38490535#38490535", "title": "counting the specific nodes in a binary tree in which the nodes are chars in c", "body": "<p>You are ignoring all values returned from both recursions.\nYou should add it into count variable too.</p>\n"}, {"tags": [], "owner": {"reputation": 977, "user_id": 6523710, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1400d77879f884a878f290e36d3f7ff?s=128&d=identicon&r=PG&f=1", "display_name": "Javant", "link": "https://stackoverflow.com/users/6523710/javant"}, "is_accepted": true, "score": 2, "last_activity_date": 1469048047, "last_edit_date": 1469048047, "creation_date": 1469047762, "answer_id": 38490588, "question_id": 38490469, "link": "https://stackoverflow.com/questions/38490469/counting-the-specific-nodes-in-a-binary-tree-in-which-the-nodes-are-chars-in-c/38490588#38490588", "title": "counting the specific nodes in a binary tree in which the nodes are chars in c", "body": "<p>You are not adding the numbers being returned by your children. Also if the node you are evaluating does not have the state you are looking for, your right node is never searched. Below should be a fix.</p>\n\n<pre><code>int findStateCount(Node* root, char* state){\n           int count=0;\n           if (root!=NULL){\n\n               //Check if this node has the state we're looking for\n               if(strcmp((root-&gt; state),(state))==0)\n                   ++count;\n               }\n\n               //Get the number of matches from my children\n               count += findStateCount(root-&gt;left,state);\n               count += findStateCount(root-&gt;right,state);\n           }\n\n           return count;\n}\n</code></pre>\n"}], "owner": {"reputation": 327, "user_id": 6581455, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh4.googleusercontent.com/-ZRKH7WIHZVQ/AAAAAAAAAAI/AAAAAAAAChM/YJPpyK-CRro/photo.jpg?sz=128", "display_name": "The-Han-Emperor", "link": "https://stackoverflow.com/users/6581455/the-han-emperor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 323, "favorite_count": 0, "accepted_answer_id": 38490588, "answer_count": 2, "score": 1, "last_activity_date": 1469048294, "creation_date": 1469047299, "last_edit_date": 1469048294, "question_id": 38490469, "link": "https://stackoverflow.com/questions/38490469/counting-the-specific-nodes-in-a-binary-tree-in-which-the-nodes-are-chars-in-c", "title": "counting the specific nodes in a binary tree in which the nodes are chars in c", "body": "<p>I created a Binary tree that has three values which are integer zipCode, character strings of States, and character pointer of city. I'm trying to count how many cities (zipCodes) are in the same states. Therefore, I wrote a function in the following, but it doesn't work.(the format is as same as input file which is posted in here the picture) Hope someone can help me out.<a href=\"http://i.stack.imgur.com/RSfdK.png\" rel=\"nofollow\">enter image description here</a></p>\n\n<pre><code>typedef struct n_ {\n    int zipCode;   // A zip code that exists in the given city/state\n    char *city;    // Will point to a city name\n    char state[3]; // A state abbreviation. Note that we need\n                   // room for the NULL terminator!\n    struct n_ *left; //connections to other nodes\n    struct n_ *right;\n} Node;\n\nint findStateCount(Node *root, char *state) {\n    int count = 0;\n    if (root!=NULL) {\n        findStateCount(root-&gt;left, state);\n        if (strcmp((root-&gt; state), (state)) == 0)\n            ++count;\n        findStateCount(root-&gt;right, state);\n    }\n    return count;\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "multithreading", "clone", "lightweight-processes"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1469056222, "post_id": 38490401, "comment_id": 64385907, "body": "Note that on a rare system where <code>int&#47;unsigned</code> is 16-bit, yet <code>size_t</code> is 32-bit: <code>#define STACK_SIZE 1024*1024  void* ptr = malloc(STACK_SIZE);</code>  is a problem.  Anytime math is done in a &quot;constant&quot;, watch out for overflow.  Suggest <code>#define STACK_SIZE ((size_t)1024*1024)</code>"}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1469056463, "post_id": 38490401, "comment_id": 64385971, "body": "Since it is apparently difficult to reproduce this problem, perhaps you would be so kind as to tell us some more about your architecture. Eg. OS and version; glibc version; gcc version. (Also any non-default compiler flags you use)"}, {"owner": {"reputation": 2978, "user_id": 227024, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/tuhtK.jpg?s=128&g=1", "display_name": "lstipakov", "link": "https://stackoverflow.com/users/227024/lstipakov"}, "edited": false, "score": 0, "creation_date": 1469091570, "post_id": 38490401, "comment_id": 64398898, "body": "Ubuntu 16.04, GLIBC 2.23-0ubuntu3, gcc 5.4.0. CPU i7-5600U. No additional compiler flags."}], "answers": [{"comments": [{"owner": {"reputation": 1275, "user_id": 5058676, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-WPjsyC41Gy0/AAAAAAAAAAI/AAAAAAAABNY/Fs0vX3pO_wA/photo.jpg?sz=128", "display_name": "evaitl", "link": "https://stackoverflow.com/users/5058676/evaitl"}, "edited": false, "score": 0, "creation_date": 1469050968, "post_id": 38491173, "comment_id": 64384246, "body": "glibc printf is supposed to be <a href=\"http://stackoverflow.com/a/468105/5058676\">thread safe</a>"}, {"owner": {"reputation": 170455, "user_id": 149341, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/omfTQ.png?s=128&g=1", "display_name": "duskwuff -inactive-", "link": "https://stackoverflow.com/users/149341/duskwuff-inactive"}, "reply_to_user": {"reputation": 1275, "user_id": 5058676, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-WPjsyC41Gy0/AAAAAAAAAAI/AAAAAAAABNY/Fs0vX3pO_wA/photo.jpg?sz=128", "display_name": "evaitl", "link": "https://stackoverflow.com/users/5058676/evaitl"}, "edited": false, "score": 0, "creation_date": 1469052316, "post_id": 38491173, "comment_id": 64384731, "body": "@evaitl However, <code>clone()</code> doesn&#39;t &quot;officially&quot; create a thread. So there may be some additional setup required that isn&#39;t happening."}, {"owner": {"reputation": 1275, "user_id": 5058676, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-WPjsyC41Gy0/AAAAAAAAAAI/AAAAAAAABNY/Fs0vX3pO_wA/photo.jpg?sz=128", "display_name": "evaitl", "link": "https://stackoverflow.com/users/5058676/evaitl"}, "edited": false, "score": 0, "creation_date": 1469052563, "post_id": 38491173, "comment_id": 64384829, "body": "I suppose, but I don&#39;t see the difference. The glibc docs <a href=\"https://www.gnu.org/software/libc/manual/html_node/Streams-and-Threads.html\" rel=\"nofollow noreferrer\">confirm</a> that there is no problem with multiple threads writing to output: <i>&quot;yes, the same job could be done with one fprintf call but it is sometimes not possible&quot;</i>. Incidentally, I can&#39;t recreate OPs problem."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "reply_to_user": {"reputation": 1275, "user_id": 5058676, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-WPjsyC41Gy0/AAAAAAAAAAI/AAAAAAAABNY/Fs0vX3pO_wA/photo.jpg?sz=128", "display_name": "evaitl", "link": "https://stackoverflow.com/users/5058676/evaitl"}, "edited": false, "score": 0, "creation_date": 1469055355, "post_id": 38491173, "comment_id": 64385675, "body": "@evaitl: Yeah, I can&#39;t reproduce it either (now that I have a computer in front of me to try it with.) It&#39;s possible that this comment by Rich Felker is relevant: <a href=\"https://sourceware.org/bugzilla/show_bug.cgi?id=10311#c6\" rel=\"nofollow noreferrer\">sourceware.org/bugzilla/show_bug.cgi?id=10311#c6</a>"}, {"owner": {"reputation": 1275, "user_id": 5058676, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-WPjsyC41Gy0/AAAAAAAAAAI/AAAAAAAABNY/Fs0vX3pO_wA/photo.jpg?sz=128", "display_name": "evaitl", "link": "https://stackoverflow.com/users/5058676/evaitl"}, "edited": false, "score": 0, "creation_date": 1469055619, "post_id": 38491173, "comment_id": 64385748, "body": "@rici I wish he had linked to some kind of authoritative source. Also I wish the problem were reproducible."}], "tags": [], "owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "is_accepted": false, "score": 3, "last_activity_date": 1469050180, "creation_date": 1469050180, "answer_id": 38491173, "question_id": 38490401, "link": "https://stackoverflow.com/questions/38490401/strange-behavior-of-clone/38491173#38491173", "title": "Strange behavior of clone", "body": "<p>Your processes both use the same <code>stdout</code> (that is, the C standard library <code>FILE</code> struct), which includes an accidentally shared buffer. That's undoubtedly causing problems.</p>\n"}, {"tags": [], "owner": {"reputation": 1275, "user_id": 5058676, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-WPjsyC41Gy0/AAAAAAAAAAI/AAAAAAAABNY/Fs0vX3pO_wA/photo.jpg?sz=128", "display_name": "evaitl", "link": "https://stackoverflow.com/users/5058676/evaitl"}, "is_accepted": false, "score": 3, "last_activity_date": 1469055929, "last_edit_date": 1469055929, "creation_date": 1469052989, "answer_id": 38491767, "question_id": 38490401, "link": "https://stackoverflow.com/questions/38490401/strange-behavior-of-clone/38491767#38491767", "title": "Strange behavior of clone", "body": "<p>I can't recreate OP's issue, but I don't think the printf's are actually a problem. </p>\n\n<p><a href=\"https://www.gnu.org/software/libc/manual/html_node/Streams-and-Threads.html\" rel=\"nofollow\">glibc docs</a>: </p>\n\n<blockquote>\n  <p>The POSIX standard requires that by default the stream operations are\n  atomic. I.e., issuing two stream operations for the same stream in two\n  threads at the same time will cause the operations to be executed as\n  if they were issued sequentially. The buffer operations performed\n  while reading or writing are protected from other uses of the same\n  stream. To do this each stream has an internal lock object which has\n  to be (implicitly) acquired before any work can be done.</p>\n</blockquote>\n\n<p><strong>Edit:</strong></p>\n\n<p>Even though the above is true for threads, as rici points out, there is a comment on <a href=\"https://sourceware.org/bugzilla/show_bug.cgi?id=10311#c6\" rel=\"nofollow\">sourceware</a>:</p>\n\n<blockquote>\n  <p>Basically, there's nothing you can safely do with CLONE_VM unless the\n  child restricts itself to pure computation and direct syscalls (via\n  sys/syscall.h). If you use any of the standard library, you risk the\n  parent and child clobbering each other's internal states. You also\n  have issues like the fact that glibc caches the pid/tid in userspace,\n  and the fact that glibc expects to always have a valid thread pointer\n  which your call to clone is unable to initialize correctly because it\n  does not know (and should not know) the internal implementation of\n  threads.</p>\n</blockquote>\n\n<p>Apparently, glibc isn't designed to work with clone if CLONE_VM is set but CLONE_THREAD|CLONE_SIGHAND are not. </p>\n"}, {"tags": [], "owner": {"reputation": 5298, "user_id": 4241278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53f687af42c3e779a0f2ee98d5fe3bb4?s=128&d=identicon&r=PG", "display_name": "deamentiaemundi", "link": "https://stackoverflow.com/users/4241278/deamentiaemundi"}, "is_accepted": false, "score": 2, "last_activity_date": 1469053237, "creation_date": 1469053237, "answer_id": 38491820, "question_id": 38490401, "link": "https://stackoverflow.com/questions/38490401/strange-behavior-of-clone/38491820#38491820", "title": "Strange behavior of clone", "body": "<p>Ass everyone suggests: it really seems to be a problem with, how shall I put it in case of <code>clone()</code>, process-safety? With a rough sketch of a locking version of printf (using <code>write(2)</code>) the output is as expected.</p>\n\n<pre><code>#define _GNU_SOURCE\n\n#include &lt;sched.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt;\n\n#define STACK_SIZE 1024*1024\n\n// VERY rough attempt at a thread-safe printf\n#include &lt;stdarg.h&gt;\n#define SYNC_REALLOC_GROW 64\nint sync_printf(const char *format, ...)\n{\n  int n, all = 0;\n  int size = 256;\n  char *p, *np;\n  va_list args;\n\n  if ((p = malloc(size)) == NULL)\n    return -1;\n\n  for (;;) {\n    va_start(args, format);\n    n = vsnprintf(p, size, format, args);\n    va_end(args);\n    if (n &lt; 0)\n      return -1;\n    all += n;\n    if (n &lt; size)\n      break;\n    size = n + SYNC_REALLOC_GROW;\n    if ((np = realloc(p, size)) == NULL) {\n      free(p);\n      return -1;\n    } else {\n      p = np;\n    }\n  }\n  // write(2) shoudl be threadsafe, so just in case\n  flockfile(stdout);\n  n = (int) write(fileno(stdout), p, all);\n  fflush(stdout);\n  funlockfile(stdout);\n  va_end(args);\n  free(p);\n  return n;\n}\n\n\nint func(void *param)\n{\n  sync_printf(\"I am func, pid %d\\n\", getpid());\n  return 0;\n}\n\nint main()\n{\n\n  sync_printf(\"I am main, pid %d\\n\", getpid());\n  void *ptr = malloc(STACK_SIZE);\n\n  sync_printf(\"I am calling clone\\n\");\n  int res = clone(func, ptr + STACK_SIZE, CLONE_VM, NULL);\n  // works fine with sleep() call\n  // sleep(1);\n\n  if (res == -1) {\n    sync_printf(\"clone error: %d\", errno);\n  } else {\n    sync_printf(\"I created child with pid: %d\\n\", res);\n  }\n  sync_printf(\"Main done, pid %d\\n\\n\", getpid());\n  return 0;\n}\n</code></pre>\n\n<p>For the third time: it's only a sketch, no time for a robust version, but that shouldn't hinder you to write one.</p>\n"}, {"comments": [{"owner": {"reputation": 1275, "user_id": 5058676, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-WPjsyC41Gy0/AAAAAAAAAAI/AAAAAAAABNY/Fs0vX3pO_wA/photo.jpg?sz=128", "display_name": "evaitl", "link": "https://stackoverflow.com/users/5058676/evaitl"}, "edited": false, "score": 0, "creation_date": 1469056415, "post_id": 38492245, "comment_id": 64385959, "body": "Were you able to recreate OPs problem with clone?"}, {"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "reply_to_user": {"reputation": 1275, "user_id": 5058676, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-WPjsyC41Gy0/AAAAAAAAAAI/AAAAAAAABNY/Fs0vX3pO_wA/photo.jpg?sz=128", "display_name": "evaitl", "link": "https://stackoverflow.com/users/5058676/evaitl"}, "edited": false, "score": 0, "creation_date": 1469058483, "post_id": 38492245, "comment_id": 64386501, "body": "@evaitl Yes, absolutely. See my updated answer for more details."}, {"owner": {"reputation": 1275, "user_id": 5058676, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-WPjsyC41Gy0/AAAAAAAAAAI/AAAAAAAABNY/Fs0vX3pO_wA/photo.jpg?sz=128", "display_name": "evaitl", "link": "https://stackoverflow.com/users/5058676/evaitl"}, "edited": false, "score": 0, "creation_date": 1469059405, "post_id": 38492245, "comment_id": 64386688, "body": "Very cool +1. I wasn&#39;t planning on using clone(), but now I have a reason."}], "tags": [], "owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "is_accepted": true, "score": 5, "last_activity_date": 1469058396, "last_edit_date": 1469058396, "creation_date": 1469055704, "answer_id": 38492245, "question_id": 38490401, "link": "https://stackoverflow.com/questions/38490401/strange-behavior-of-clone/38492245#38492245", "title": "Strange behavior of clone", "body": "<p>You have a race condition (i.e.) you don't have the implied thread safety of stdio.</p>\n\n<p>The problem is even more severe. You can get duplicate \"func\" messages.</p>\n\n<p>The problem is that using <code>clone</code> does not have the same guarantees as <code>pthread_create</code>. (i.e.) You do <em>not</em> get the thread safe variants of <code>printf</code>.</p>\n\n<p>I don't know for sure, but, IMO the verbiage about stdio streams and thread safety, in practice, only applies when using <code>pthreads</code>.</p>\n\n<p>So, you'll have to handle your own interthread locking.</p>\n\n<p>Here is a version of your program recoded to use <code>pthread_create</code>. It seems to work without incident:</p>\n\n<pre><code>#define _GNU_SOURCE\n\n#include &lt;sched.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt;\n#include &lt;pthread.h&gt;\n\n#define STACK_SIZE 1024*1024\n\nvoid *func(void* param) {\n    printf(\"I am func, pid %d\\n\", getpid());\n    return (void *) 0;\n}\n\nint main(int argc, char const *argv[]) {\n    printf(\"I am main, pid %d\\n\", getpid());\n    void* ptr = malloc(STACK_SIZE);\n\n    printf(\"I am calling clone\\n\");\n\n    pthread_t tid;\n    pthread_create(&amp;tid,NULL,func,NULL);\n    //int res = clone(func, ptr + STACK_SIZE, CLONE_VM, NULL);\n    int res = 0;\n\n    // works fine with sleep() call\n    // sleep(1);\n\n    if (res == -1) {\n        printf(\"clone error: %d\", errno);\n    } else {\n        printf(\"I created child with pid: %d\\n\", res);\n    }\n\n    pthread_join(tid,NULL);\n    printf(\"Main done, pid %d\\n\", getpid());\n    return 0;\n}\n</code></pre>\n\n<p>Here is a test script I've been using to check for errors [it's a little rough, but should be okay]. Run against your version and it will abort quickly. The <code>pthread_create</code> version seems to pass just fine</p>\n\n<pre><code>#!/usr/bin/perl\n# clonetest -- clone test\n#\n# arguments:\n#   \"-p0\" -- suppress check for duplicate parent messages\n#   \"-c0\" -- suppress check for duplicate child messages\n#   1 -- base name for program to test (e.g. for xyz.c, use xyz)\n#   2 -- [optional] number of test iterations (DEFAULT: 100000)\n\nmaster(@ARGV);\nexit(0);\n\n# master -- master control\nsub master\n{\n    my(@argv) = @_;\n    my($arg,$sym);\n\n    while (1) {\n        $arg = $argv[0];\n        last unless (defined($arg));\n\n        last unless ($arg =~ s/^-(.)//);\n        $sym = $1;\n\n        shift(@argv);\n\n        $arg = 1\n            if ($arg eq \"\");\n\n        $arg += 0;\n        ${\"opt_$sym\"} = $arg;\n    }\n\n    $opt_p //= 1;\n    $opt_c //= 1;\n    printf(\"clonetest: p=%d c=%d\\n\",$opt_p,$opt_c);\n\n    $xfile = shift(@argv);\n    $xfile //= \"clone1\";\n    printf(\"clonetest: xfile='%s'\\n\",$xfile);\n\n    $itermax = shift(@argv);\n    $itermax //= 100000;\n    $itermax += 0;\n    printf(\"clonetest: itermax=%d\\n\",$itermax);\n\n    system(\"cc -o $xfile -O2 $xfile.c -lpthread\");\n    $code = $? &gt;&gt; 8;\n    die(\"master: compile error\\n\")\n        if ($code);\n\n    $logf = \"/tmp/log\";\n\n    for ($iter = 1;  $iter &lt;= $itermax;  ++$iter) {\n        printf(\"iter: %d\\n\",$iter)\n            if ($opt_v);\n        dotest($iter);\n    }\n}\n\n# dotest -- perform single test\nsub dotest\n{\n    my($iter) = @_;\n    my($parcnt,$cldcnt);\n    my($xfsrc,$bf);\n\n    system(\"./$xfile &gt; $logf\");\n\n    open($xfsrc,\"&lt;$logf\") or\n        die(\"dotest: unable to open '$logf' -- $!\\n\");\n\n    while ($bf = &lt;$xfsrc&gt;) {\n        chomp($bf);\n\n        if ($opt_p) {\n            while ($bf =~ /created/g) {\n                ++$parcnt;\n            }\n        }\n\n        if ($opt_c) {\n            while ($bf =~ /func/g) {\n                ++$cldcnt;\n            }\n        }\n    }\n\n    close($xfsrc);\n\n    if (($parcnt &gt; 1) or ($cldcnt &gt; 1)) {\n        printf(\"dotest: fail on %d -- parcnt=%d cldcnt=%d\\n\",\n            $iter,$parcnt,$cldcnt);\n        system(\"cat $logf\");\n        exit(1);\n    }\n}\n</code></pre>\n\n<hr>\n\n<p><strong>UPDATE:</strong></p>\n\n<blockquote>\n  <p>Were you able to recreate OPs problem with clone?</p>\n</blockquote>\n\n<p>Absolutely. Before I created the pthreads version, in addition to testing OP's original version, I also created versions that:</p>\n\n<p>(1) added <code>setlinebuf</code> to the start of <code>main</code></p>\n\n<p>(2) added <code>fflush</code> just before the <code>clone</code> and <code>__fpurge</code> as the first statement of <code>func</code></p>\n\n<p>(3) added an <code>fflush</code> in <code>func</code> before the <code>return 0</code></p>\n\n<p>Version (2) eliminated the duplicate parent messages, but the duplicate child messages remained</p>\n\n<p>If you'd like to see this for yourself, download OP's version from the question, my version, and the test script. Then, run the test script on OP's version.</p>\n\n<p>I posted enough information and files so that anyone can recreate the problem.</p>\n\n<p>Note that due to differences between my system and OP's, I couldn't at first reproduce the problem on just 3-4 tries. So, that's why I created the script.</p>\n\n<p>The script does 100,000 test runs and usually the problem will manifest itself within 5000-15000.</p>\n"}, {"tags": [], "owner": {"reputation": 3492, "user_id": 118958, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/NwFFJ.jpg?s=128&g=1", "display_name": "ynimous", "link": "https://stackoverflow.com/users/118958/ynimous"}, "is_accepted": false, "score": 2, "last_activity_date": 1469056049, "last_edit_date": 1495541685, "creation_date": 1469056049, "answer_id": 38492299, "question_id": 38490401, "link": "https://stackoverflow.com/questions/38490401/strange-behavior-of-clone/38492299#38492299", "title": "Strange behavior of clone", "body": "<p>As <a href=\"https://stackoverflow.com/users/5058676/evaitl\">evaitl</a> points out <code>printf</code> is documented to be thread-safe by glibc's documentation. <strong>BUT</strong>, this typically assumes that you are using the designated glibc function to create threads (that is, <code>pthread_create()</code>). If you do not, then you are on your own.</p>\n\n<p>The lock  taken by <code>printf()</code> is <a href=\"https://en.wikipedia.org/wiki/Reentrant_mutex\" rel=\"nofollow noreferrer\">recursive</a> (see <code>flockfile</code>). This means that if the lock is already taken, the implementation checks the owner of the lock against the locker. If the locker is the same as the owner, the locking attempt succeeds.</p>\n\n<p>To distinguish between different threads, you need to setup properly <a href=\"https://en.wikipedia.org/wiki/Thread-local_storage\" rel=\"nofollow noreferrer\">TLS</a>, which you do not do, but <code>pthread_create()</code> does. What I'm guessing happens is that in your case the TLS variable that identifies the thread is the same for both threads, so you end up taking the lock.</p>\n\n<p>TL;DR: please use <code>pthread_create()</code></p>\n"}], "owner": {"reputation": 2978, "user_id": 227024, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/tuhtK.jpg?s=128&g=1", "display_name": "lstipakov", "link": "https://stackoverflow.com/users/227024/lstipakov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 262, "favorite_count": 0, "accepted_answer_id": 38492245, "answer_count": 5, "score": 5, "last_activity_date": 1469058791, "creation_date": 1469047020, "question_id": 38490401, "link": "https://stackoverflow.com/questions/38490401/strange-behavior-of-clone", "title": "Strange behavior of clone", "body": "<p>This is fairly simple application which creates a lightweight process (thread) with <code>clone()</code> call.</p>\n\n<pre><code>#define _GNU_SOURCE\n\n#include &lt;sched.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt;\n\n#define STACK_SIZE 1024*1024\n\nint func(void* param) {\n    printf(\"I am func, pid %d\\n\", getpid());    \n    return 0;\n}\n\nint main(int argc, char const *argv[]) {\n    printf(\"I am main, pid %d\\n\", getpid());\n    void* ptr = malloc(STACK_SIZE);\n\n    printf(\"I am calling clone\\n\");             \n    int res = clone(func, ptr + STACK_SIZE, CLONE_VM, NULL);\n    // works fine with sleep() call\n    // sleep(1);\n\n    if (res == -1) {\n        printf(\"clone error: %d\", errno);       \n    } else {\n        printf(\"I created child with pid: %d\\n\", res);      \n    }\n\n    printf(\"Main done, pid %d\\n\", getpid());        \n    return 0;\n}\n</code></pre>\n\n<p>Here are results:</p>\n\n<p><strong>Run 1:</strong></p>\n\n<pre><code>\u279c  LFD401 ./clone\nI am main, pid 10974\nI am calling clone\nI created child with pid: 10975\nMain done, pid 10974\nI am func, pid 10975\n</code></pre>\n\n<p><strong>Run 2:</strong></p>\n\n<pre><code>\u279c  LFD401 ./clone\nI am main, pid 10995\nI am calling clone\nI created child with pid: 10996\nI created child with pid: 10996\nI am func, pid 10996\nMain done, pid 10995\n</code></pre>\n\n<p><strong>Run 3:</strong></p>\n\n<pre><code>\u279c  LFD401 ./clone\nI am main, pid 11037\nI am calling clone\nI created child with pid: 11038\nI created child with pid: 11038\nI am func, pid 11038\nI created child with pid: 11038\nI am func, pid 11038\nMain done, pid 11037\n</code></pre>\n\n<p><strong>Run 4:</strong></p>\n\n<pre><code>\u279c  LFD401 ./clone\nI am main, pid 11062\nI am calling clone\nI created child with pid: 11063\nMain done, pid 11062\nMain done, pid 11062\nI am func, pid 11063\n</code></pre>\n\n<p>What is going on here? Why \"I created child\" message is sometimes printed several times?</p>\n\n<p>Also I noticed that adding a delay after <code>clone</code> call \"fixes\" the problem.</p>\n"}, {"tags": ["c++", "c", "linux", "macos", "memory"], "comments": [{"owner": {"reputation": 2664, "user_id": 1862101, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e069875829ca4da3cd8895e468c64409?s=128&d=identicon&r=PG", "display_name": "brian beuning", "link": "https://stackoverflow.com/users/1862101/brian-beuning"}, "edited": false, "score": 0, "creation_date": 1469048931, "post_id": 38490320, "comment_id": 64383336, "body": "mallinfo() with (arena + hblkhd + uordblks)"}, {"owner": {"reputation": 113, "user_id": 6530331, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jDWhJ.gif?s=128&g=1", "display_name": "Martin Bisson", "link": "https://stackoverflow.com/users/6530331/martin-bisson"}, "reply_to_user": {"reputation": 2664, "user_id": 1862101, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e069875829ca4da3cd8895e468c64409?s=128&d=identicon&r=PG", "display_name": "brian beuning", "link": "https://stackoverflow.com/users/1862101/brian-beuning"}, "edited": false, "score": 0, "creation_date": 1469136951, "post_id": 38490320, "comment_id": 64426486, "body": "@brianbeuning : according to <a href=\"http://man7.org/linux/man-pages/man3/mallinfo.3.html\" rel=\"nofollow noreferrer\">man7.org/linux/man-pages/man3/mallinfo.3.html</a>, <code>arena</code> is <code>uordblks</code> + <code>fordblks</code>, so your suggestion would end up counting some memory twice..."}], "answers": [{"comments": [{"owner": {"reputation": 113, "user_id": 6530331, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jDWhJ.gif?s=128&g=1", "display_name": "Martin Bisson", "link": "https://stackoverflow.com/users/6530331/martin-bisson"}, "edited": false, "score": 1, "creation_date": 1469115637, "post_id": 38490525, "comment_id": 64415113, "body": "Thanks for the suggestion.  I tried it (reading <code>ru_ixrss</code>, <code>ru_idrss</code> and <code>ru_isrss</code>) and all fields have 0.  According to the man page, &quot;Not all fields are completed; unmaintained fields are set to zero by the kernel.&quot; and &quot;In Linux 2.4 only the fields ru_utime, ru_stime, ru_minflt, and ru_majflt are maintained.  Since Linux 2.6, ru_nvcsw and ru_nivcsw are also maintained.&quot;"}], "tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 2, "last_activity_date": 1469047568, "creation_date": 1469047568, "answer_id": 38490525, "question_id": 38490320, "link": "https://stackoverflow.com/questions/38490320/how-to-query-amount-of-allocated-memory-on-linux-and-osx/38490525#38490525", "title": "How to query amount of allocated memory on Linux (and OSX)?", "body": "<p>You can try and use information returned by <code>getrusage()</code>:</p>\n\n<pre><code>#include &lt;sys/time.h&gt;\n#include &lt;sys/resource.h&gt;\n\nint getrusage(int who, struct rusage *usage);\n\nstruct rusage {\n    struct timeval ru_utime; /* user CPU time used */\n    struct timeval ru_stime; /* system CPU time used */\n    long   ru_maxrss;        /* maximum resident set size */\n    long   ru_ixrss;         /* integral shared memory size */\n    long   ru_idrss;         /* integral unshared data size */\n    long   ru_isrss;         /* integral unshared stack size */\n    long   ru_minflt;        /* page reclaims (soft page faults) */\n    long   ru_majflt;        /* page faults (hard page faults) */\n    long   ru_nswap;         /* swaps */\n    long   ru_inblock;       /* block input operations */\n    long   ru_oublock;       /* block output operations */\n    long   ru_msgsnd;        /* IPC messages sent */\n    long   ru_msgrcv;        /* IPC messages received */\n    long   ru_nsignals;      /* signals received */\n    long   ru_nvcsw;         /* voluntary context switches */\n    long   ru_nivcsw;        /* involuntary context switches */\n};\n</code></pre>\n\n<p>If the memory information does not fit you purpose, observing the page fault counts can help monitor memory stress, which is what you intend to detect.</p>\n"}, {"tags": [], "owner": {"reputation": 2173, "user_id": 6577680, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-BNh_9G6Q-1M/AAAAAAAAAAI/AAAAAAAAAA8/uTxVAAioLfw/photo.jpg?sz=128", "display_name": "Matthew Fisher", "link": "https://stackoverflow.com/users/6577680/matthew-fisher"}, "is_accepted": false, "score": 2, "last_activity_date": 1469320017, "creation_date": 1469320017, "answer_id": 38547596, "question_id": 38490320, "link": "https://stackoverflow.com/questions/38490320/how-to-query-amount-of-allocated-memory-on-linux-and-osx/38547596#38547596", "title": "How to query amount of allocated memory on Linux (and OSX)?", "body": "<p>Have you tried a shared library interposer for Linux for section (5) above?  So long as your application is not statically linking the malloc functions, you can interpose a new function between your program and the kernel malloc.  I've used this tactic many times to collect stats on memory usage.  </p>\n\n<p>It does required setting LD_PRELOAD before running the program but no source or binary changes.  It is an ideal answer in many cases.</p>\n\n<p>Here is an example of a malloc interposer:</p>\n\n<p><a href=\"http://www.drdobbs.com/building-library-interposers-for-fun-and/184404926\" rel=\"nofollow\">http://www.drdobbs.com/building-library-interposers-for-fun-and/184404926</a></p>\n\n<p>You probably will also want to do calloc and free. Calls to new generally end up as a call to malloc so C++ is covered as well.  </p>\n\n<p>OS X seems to have similar capabilities but I have not tried it.</p>\n\n<p><a href=\"http://tlrobinson.net/blog/2007/12/overriding-library-functions-in-mac-os-x-the-easy-way-dyld_insert_libraries/\" rel=\"nofollow\">http://tlrobinson.net/blog/2007/12/overriding-library-functions-in-mac-os-x-the-easy-way-dyld_insert_libraries/</a></p>\n\n<p>--Matt</p>\n"}, {"comments": [{"owner": {"reputation": 4981, "user_id": 490529, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d62e4dfe127b89706657e13a91a55b15?s=128&d=identicon&r=PG", "display_name": "Dmitriy", "link": "https://stackoverflow.com/users/490529/dmitriy"}, "edited": false, "score": 0, "creation_date": 1539180773, "post_id": 43126663, "comment_id": 92409150, "body": "Doesn&#39;t work on Mac Os X, fopen(&quot;/proc/self/maps&quot; returns NULL."}, {"owner": {"reputation": 113, "user_id": 6530331, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jDWhJ.gif?s=128&g=1", "display_name": "Martin Bisson", "link": "https://stackoverflow.com/users/6530331/martin-bisson"}, "reply_to_user": {"reputation": 4981, "user_id": 490529, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d62e4dfe127b89706657e13a91a55b15?s=128&d=identicon&r=PG", "display_name": "Dmitriy", "link": "https://stackoverflow.com/users/490529/dmitriy"}, "edited": false, "score": 0, "creation_date": 1539277927, "post_id": 43126663, "comment_id": 92453836, "body": "This solution is for Linux, it requires the proc filesystem."}, {"owner": {"reputation": 4981, "user_id": 490529, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d62e4dfe127b89706657e13a91a55b15?s=128&d=identicon&r=PG", "display_name": "Dmitriy", "link": "https://stackoverflow.com/users/490529/dmitriy"}, "edited": false, "score": 0, "creation_date": 1539370148, "post_id": 43126663, "comment_id": 92492301, "body": "Did you find a solution for OSX(question title is about OSX too)?"}], "tags": [], "owner": {"reputation": 113, "user_id": 6530331, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jDWhJ.gif?s=128&g=1", "display_name": "Martin Bisson", "link": "https://stackoverflow.com/users/6530331/martin-bisson"}, "is_accepted": true, "score": 0, "last_activity_date": 1490901589, "last_edit_date": 1495541417, "creation_date": 1490901589, "answer_id": 43126663, "question_id": 38490320, "link": "https://stackoverflow.com/questions/38490320/how-to-query-amount-of-allocated-memory-on-linux-and-osx/43126663#43126663", "title": "How to query amount of allocated memory on Linux (and OSX)?", "body": "<p>Here is what I ended up using.  I scan /proc/self/maps and sum the size of all the address ranges meeting my criteria, which is:</p>\n\n<ul>\n<li>Only include ranges from inode 0 (i.e. no devices, no mapped file, etc.)</li>\n<li>Only include ranges that are at least one of readable, writable or executable</li>\n<li>Only include private memory\n\n<ul>\n<li>In my experiments I did not see instances of shared memory from inode 0.  Maybe with inter-process shared memory...?</li>\n</ul></li>\n</ul>\n\n<p>Here is the code for my solution:</p>\n\n<pre><code>size_t getValue()\n{\n    FILE* file = fopen(\"/proc/self/maps\", \"r\");\n    if (!file)\n    {\n        assert(0);\n        return 0;\n    }\n\n    size_t value = 0;\n\n    char line[1024];\n    while (fgets(line, 1024, file) != NULL)\n    {\n        ptrdiff_t start_address, end_address;\n        char perms[4];\n        ptrdiff_t offset;\n        int dev_major, dev_minor;\n        unsigned long int inode;\n        const int nb_scanned = sscanf(\n            line, \"%16tx-%16tx %c%c%c%c %16tx %02x:%02x %lu\",\n            &amp;start_address, &amp;end_address,\n            &amp;perms[0], &amp;perms[1], &amp;perms[2], &amp;perms[3],\n            &amp;offset, &amp;dev_major, &amp;dev_minor, &amp;inode\n            );\n        if (10 != nb_scanned)\n        {\n            assert(0);\n            continue;\n        }\n\n        if ((inode == 0) &amp;&amp;\n            (perms[0] != '-' || perms[1] != '-' || perms[2] != '-') &amp;&amp;\n            (perms[3] == 'p'))\n        {\n            assert(dev_major == 0);\n            assert(dev_minor == 0);\n            value += (end_address - start_address);\n        }\n    }\n\n    fclose(file);\n\n    return value;\n}\n</code></pre>\n\n<p>Since this is looping through all the lines in /proc/self/maps, querying memory that way is significantly slower than using \"Virtual Memory currently used by current process\" from <a href=\"https://stackoverflow.com/questions/63166/how-to-determine-cpu-and-memory-consumption-from-inside-a-process\">How to determine CPU and memory consumption from inside a process?</a>.</p>\n\n<p>However, it provides an answer much closer to what I need.</p>\n"}], "owner": {"reputation": 113, "user_id": 6530331, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jDWhJ.gif?s=128&g=1", "display_name": "Martin Bisson", "link": "https://stackoverflow.com/users/6530331/martin-bisson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1254, "favorite_count": 4, "accepted_answer_id": 43126663, "answer_count": 3, "score": 11, "last_activity_date": 1490901589, "creation_date": 1469046726, "last_edit_date": 1495542327, "question_id": 38490320, "link": "https://stackoverflow.com/questions/38490320/how-to-query-amount-of-allocated-memory-on-linux-and-osx", "title": "How to query amount of allocated memory on Linux (and OSX)?", "body": "<p>While this might look like a duplicate from other questions, let me explain why it's not.</p>\n\n<p>I am looking to get a specific part of my application to degrade gracefully when a certain memory limit has been reached.  I could have used criteria based on remaining available physical memory, but this wouldn't be safe, because the OS could start paging out memory used by my application before reaching the criteria, which would think there is still some physical memory left, and keep allocating, etc.  For the same reason, I can't used the amount of physical memory currently used by the process, because as soon as the OS would start swapping me out, I would keep allocating as the OS pages memory so the number would not grow anymore.</p>\n\n<p>For this reason, I chose a criteria based on the amount of memory allocated by my application, i.e. very close to virtual memory size.</p>\n\n<p>This question (<a href=\"https://stackoverflow.com/questions/63166/how-to-determine-cpu-and-memory-consumption-from-inside-a-process\">How to determine CPU and memory consumption from inside a process?</a>) provides great ways of querying the amount of virtual memory used by the current process, which I THOUGHT was what I needed.</p>\n\n<p>On Windows, I'm using <code>GetProcessMemoryInfo()</code> and the <code>PrivateUsage</code> field, which works great.</p>\n\n<p>On Linux, I tried several things (listed below) that did not work.  The reason why virtual memory usage does not work for me is because of something that happens with OpenCL context creation on NVidia hardware on Linux.  The driver reserves a region of the virtual memory space big enough to hold all RAM, all swap and all video memory.  My guess is it does so for unified address space and everything.  But it also means that the process reports using enormous amounts of memory.  On my system for instance, <em>top</em> will report 23.3 Gb in the VIRT column (12 Gb of RAM, 6 Gb of swap, 2 Gb of video memory, which gives 20 Gb reserved by the NVidia driver).</p>\n\n<p>On OSX, by using <code>task_info()</code> and the <code>virtual_size</code> field, I also get a bigger than expected number (a few Gb for an app that takes not even close to 1 Gb on Windows), but not as big as Linux.</p>\n\n<p>So here is the big question: how can I get the amount of memory allocated by my application?  I know that this is a somewhat vague question (what does \"allocated memory\" means?), but I'm flexible:</p>\n\n<ul>\n<li>I would prefer to include the application static data, code section and everything, but I can live without.</li>\n<li>I would prefer to include the memory allocated for stacks, but I can live without.</li>\n<li>I would prefer to include the memory used by shared libraries, but I can live without.</li>\n<li>I don't really care for mmap stuff, I can do with or without at that point.</li>\n<li>Etc.</li>\n</ul>\n\n<p>What is really important is that the number grows with dynamic allocation (new, malloc, anything) and shrinks when the memory is released (which I know can be implementation-dependent).</p>\n\n<h1>Things I have tried</h1>\n\n<p>Here are a couple of solutions I have tried and/or thought of but that would not work for me.</p>\n\n<ol>\n<li><p><strong>Read from /proc/self/status</strong></p>\n\n<p>This is the approach suggested by how-to-determine-cpu-and-memory-consumption-from-inside-a-process.  However, as stated above, this returns the amount of virtual memory, which does not work for me.</p></li>\n<li><p><strong>Read from /proc/self/statm</strong></p>\n\n<p><em>Very slightly</em> worst: according to <a href=\"http://kernelnewbies.kernelnewbies.narkive.com/iG9xCmwB/proc-pid-statm-doesnt-match-with-status\" rel=\"nofollow noreferrer\">http://kernelnewbies.kernelnewbies.narkive.com/iG9xCmwB/proc-pid-statm-doesnt-match-with-status</a>, which refers to Linux kernel code, the only difference between those two values is that the second one does not substract <code>reserved_vm</code> to the amount of virtual memory.  I would have HOPED that <code>reserved_vm</code> would include the memory reserved by the OpenCL driver, but it does not.</p></li>\n<li><p><strong>Use <code>mallinfo()</code> and the <code>uordblks</code> field</strong></p>\n\n<p>This does not seem to include all the allocations (I'm guessing the <code>new</code>s are missing), since for an +2Gb growth in virtual memory space (after doing some memory-heavy work and still holding the memory), I'm only seeing about 0.1Gb growth in the number returned by <code>mallinfo()</code>.</p></li>\n<li><p><strong>Read the [heap] section size from /proc/self/smaps</strong></p>\n\n<p>This value started at around 336,760 Kb and peaked at 1,019,496 Kb for work that grew virtual memory space by +2Gb, and then it never gets down, so I'm not sure I can't really rely on this number...</p></li>\n<li><p><strong>Monitor all memory allocations in my application</strong></p>\n\n<p>Yes, in an ideal world, I would have control over everybody who allocates memory.  However, this is a legacy application, using tons of different allocators, some <code>malloc</code>s, some <code>new</code>s, some OS-specific routines, etc.  There are some plug-ins that could do whatever they want, they could be compiled with a different compiler, etc.  So while this would be great to really control memory, this does not work in my context.</p></li>\n<li><p><strong>Read the virtual memory size before and after the OpenCL context initialization</strong></p>\n\n<p>While this could be a \"hacky\" way to solve the problem (and I might have to fallback to it), I would really wish for a more reliable way to query memory, because OpenCL context could be initialized somewhere out of my control, and other similar but non-OpenCL specific issues could creep in and I wouldn't know about it.</p></li>\n</ol>\n\n<p>So that's pretty much all I've got.  There is one more thing I have not tried yet, because it only works on OSX, but it is to use the approach described in <a href=\"https://stackoverflow.com/questions/25609945/why-does-mstats-and-malloc-zone-statistics-not-show-recovered-memory-after-free\">Why does mstats and malloc_zone_statistics not show recovered memory after free?</a>, i.e. use <code>malloc_get_all_zones()</code> and <code>malloc_zone_statistics()</code>, but I think this might be the same problem as <code>mallinfo()</code>, i.e. not take all allocations into account.</p>\n\n<p>So, can anyone suggest a way to query memory usage (as vague of a term as this is, see above for precision) of a given process in Linux (and also OSX even if it's a different method)?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 1164, "user_id": 2957713, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/wLtyw.jpg?s=128&g=1", "display_name": "Roma-MT", "link": "https://stackoverflow.com/users/2957713/roma-mt"}, "edited": false, "score": 4, "creation_date": 1469045218, "post_id": 38489855, "comment_id": 64381440, "body": "Open up the file &quot;stdlib.h&quot; And read it&#39;s prototypes... (You can also do this by code)"}, {"owner": {"reputation": 3577, "user_id": 2176813, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/Nv7lK.jpg?s=128&g=1", "display_name": "tambre", "link": "https://stackoverflow.com/users/2176813/tambre"}, "edited": false, "score": 1, "creation_date": 1469045223, "post_id": 38489855, "comment_id": 64381443, "body": "That&#39;s something that your IDE should do, though it can also be done programmatically."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1469045436, "post_id": 38489855, "comment_id": 64381548, "body": "Wouldn&#39;t it be better if you could just use your functions and then have your IDE add all required headers?"}, {"owner": {"reputation": 558, "user_id": 1880811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dedecbb23246d138593b5aea66d2d33?s=128&d=identicon&r=PG&f=1", "display_name": "Asthor", "link": "https://stackoverflow.com/users/1880811/asthor"}, "edited": false, "score": 1, "creation_date": 1469045520, "post_id": 38489855, "comment_id": 64381597, "body": "Man pages also contain all this info"}, {"owner": {"reputation": 62488, "user_id": 45249, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/81039d357ce18bee9dd8fac6c1c56290?s=128&d=identicon&r=PG", "display_name": "mouviciel", "link": "https://stackoverflow.com/users/45249/mouviciel"}, "edited": false, "score": 0, "creation_date": 1469045553, "post_id": 38489855, "comment_id": 64381616, "body": "If <code>vi</code> or <code>eclipse</code> don&#39;t solve your problem, you might want to check <a href=\"http://www.doxygen.org/\" rel=\"nofollow noreferrer\"><code>doxygen</code></a>"}, {"owner": {"reputation": 447, "user_id": 3573277, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IZtww.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/3573277/himanshu"}, "edited": false, "score": 1, "creation_date": 1469045837, "post_id": 38489855, "comment_id": 64381776, "body": "I want the results in the program output."}, {"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 0, "creation_date": 1469045930, "post_id": 38489855, "comment_id": 64381828, "body": "Why do you want C code? Anyway, using Clang compiler framework is probably the most robust way to create the function you desire.  However, if you really want what you are asking for, a C function, then this question is way too broad for SO."}, {"owner": {"reputation": 1884, "user_id": 3078414, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b1180f5e68d3542488d66de14ff53964?s=128&d=identicon&r=PG&f=1", "display_name": "user3078414", "link": "https://stackoverflow.com/users/3078414/user3078414"}, "edited": false, "score": 0, "creation_date": 1469045959, "post_id": 38489855, "comment_id": 64381848, "body": "Some modern compilers, such as <code>clang</code> even warn you, for example, not to implicitly declare <code>malloc()</code> (if you did so), but to include <code>stdlib.h</code> instead."}, {"owner": {"user_type": "does_not_exist", "display_name": "user3458"}, "edited": false, "score": 0, "creation_date": 1469046087, "post_id": 38489855, "comment_id": 64381914, "body": "If the goal is to help you remember what to include, then the man pages or google are your friends. If the goal is to figure out where a particular prototype comes from in your own c file, you need to dump the preprocessor output."}, {"owner": {"reputation": 447, "user_id": 3573277, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IZtww.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/3573277/himanshu"}, "edited": false, "score": 0, "creation_date": 1469046310, "post_id": 38489855, "comment_id": 64382024, "body": "@Arkadiy okay so how can I &quot;dump the preprocessor output&quot; to stdout."}, {"owner": {"user_type": "does_not_exist", "display_name": "user3458"}, "edited": false, "score": 0, "creation_date": 1469046432, "post_id": 38489855, "comment_id": 64382082, "body": "Please google &quot;dump preprocessor output&quot;? In gcc it&#39;s -E switch."}, {"owner": {"reputation": 447, "user_id": 3573277, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IZtww.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/3573277/himanshu"}, "edited": false, "score": 0, "creation_date": 1469046624, "post_id": 38489855, "comment_id": 64382200, "body": "but during contests I only have access to my editor and a compile button which automatically compiles so I cannot provide custom flags or access any other file. I just have the editor and the output screen and a compile and run button."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1469047593, "post_id": 38489855, "comment_id": 64382718, "body": "So basically you&#39;re proposing to write a <i>header file parser</i> from scratch at the beginning of the contest. Is that right? May I suggest that it&#39;s easier just to memorize the names of all the header files, and just include all of them."}, {"owner": {"reputation": 447, "user_id": 3573277, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IZtww.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/3573277/himanshu"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1469047911, "post_id": 38489855, "comment_id": 64382882, "body": "@user3386109 yeah you can say that, I don&#39;t know if thats possible in an coding contest. But as far as this discussion is going it seems there is no direct way and I need to parse or read the header files (which wouldn&#39;t be possible since I don&#39;t know the path to the header files.)"}, {"owner": {"reputation": 447, "user_id": 3573277, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IZtww.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/3573277/himanshu"}, "edited": false, "score": 0, "creation_date": 1469048059, "post_id": 38489855, "comment_id": 64382945, "body": "It would be great if I could somehow derive the path from the header file&#39;s name and then use that path to open the header file to read its contents."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1469048228, "post_id": 38489855, "comment_id": 64383040, "body": "You would need the include path from the environment, and/or the include path that&#39;s passed to the compiler on the command line. Even then, it&#39;s possible that you won&#39;t have any access to the directory that contains the header files."}, {"owner": {"reputation": 447, "user_id": 3573277, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IZtww.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/3573277/himanshu"}, "edited": false, "score": 0, "creation_date": 1469049268, "post_id": 38489855, "comment_id": 64383500, "body": "yes I don&#39;t have access to any documentation."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1469081682, "post_id": 38489855, "comment_id": 64392602, "body": "some 99% of the header files are located in <code>&#47;usr&#47;include</code>, with some in <code>&#47;usr&#47;local&#47;include</code>   Then any files you write will be where ever you placed them (usually in the same directory or sub directory of your top level project directory."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1469092329, "post_id": 38489855, "comment_id": 64399446, "body": "What about <code>grep function_name_in_question &#47;usr&#47;include&#47; -rw</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 447, "user_id": 3573277, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IZtww.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/3573277/himanshu"}, "edited": false, "score": 0, "creation_date": 1469045857, "post_id": 38490030, "comment_id": 64381790, "body": "I want the results in program output itself"}, {"owner": {"reputation": 447, "user_id": 3573277, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IZtww.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/3573277/himanshu"}, "edited": false, "score": 0, "creation_date": 1469083806, "post_id": 38490030, "comment_id": 64393787, "body": "can you please elaborate with a working code..."}, {"owner": {"reputation": 14339, "user_id": 1466970, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/V1J6z.jpg?s=128&g=1", "display_name": "Richard Chambers", "link": "https://stackoverflow.com/users/1466970/richard-chambers"}, "reply_to_user": {"reputation": 447, "user_id": 3573277, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IZtww.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/3573277/himanshu"}, "edited": false, "score": 0, "creation_date": 1469101813, "post_id": 38490030, "comment_id": 64405532, "body": "@Himanshu, I have added an example. You will probably need to tailor this example."}], "tags": [], "owner": {"reputation": 14339, "user_id": 1466970, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/V1J6z.jpg?s=128&g=1", "display_name": "Richard Chambers", "link": "https://stackoverflow.com/users/1466970/richard-chambers"}, "is_accepted": false, "score": 1, "last_activity_date": 1469101768, "last_edit_date": 1469101768, "creation_date": 1469045647, "answer_id": 38490030, "question_id": 38489855, "link": "https://stackoverflow.com/questions/38489855/view-function-prototypes-in-c/38490030#38490030", "title": "View function prototypes in C", "body": "<p>Create a C program file with the <code>include</code> directive for the include file you want to see.</p>\n\n<p>For instance:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n</code></pre>\n\n<p>Compile with Preprocessor output to generate a file, usually a file with an extension of <code>.i</code> and you will have the complete contents of the include file.</p>\n\n<p>For Visual Studio, you may need to indicate whether you want to keep the comments or not.</p>\n\n<p>The output file should appear in your working directory.</p>\n\n<p>A more involved example of an approach is as follows. This is a C source text file which does a series of includes with special markers to show what is where.</p>\n\n<p>The program at the bottom of the source file is a simple filter program which reads the C Preprocessor file generated and removes most of the clutter such as blank lines or those \"#line \" lines of output which specify a line number and the file it came from.</p>\n\n<p>You will need to add whatever include files you want to see. Then compile it twice, once with C Preprocessor output enabled to generate a file containing the C Preprocessor output and once with C Preprocessor output disabled to generate an actual executable file. Your C compiler may provide options to do both steps in a single compile. I could not see how to do that with Visual Studio 2013.</p>\n\n<p>Here is an example source file. I expect you may need to tailor this for your compiler and development environment. This compiles and generates output with Visual Studio 2013. I created a simple <code>.bat</code> file which runs this application from the command line and redirect STDOUT to a text file that contains the filtered C Preprocessor output.</p>\n\n<pre><code>#define MAKE_SEP_STRING \"&lt;!-- #$%^&amp;*()_+-=qwrtv --&gt;\"\n#define MAKE_SEP_STRING_END \"&lt;!--END #$%^&amp;*()_+-=qwrtv --&gt;\"\n#define MAKE_SEP_BEGIN(x)  static const char X_##x [] = MAKE_SEP_STRING #x;\n#define MAKE_SEP_END\n\nMAKE_SEP_BEGIN(stdio);\n#include &lt;stdio.h&gt;\nMAKE_SEP_BEGIN(stdlib);\n#include &lt;stdlib.h&gt;\nMAKE_SEP_END\n\n#include &lt;string.h&gt;\nint main(int argc, char* argv[])\n{\n    if (argc &lt; 2) {\n        printf(\"output file must be specified.\\n\");\n        return 1;\n    }\n    else {\n        char *sep = MAKE_SEP_STRING_END;  // if we want to determine where each file begins or ends.\n        FILE *pFile;\n\n        fopen_s(&amp;pFile, argv[1], \"r\");\n\n        if (pFile) {\n            char  hugeBuffer[4096];\n\n            // read through the C Preprocessor output file and eliminate empty lines.\n            // there can be a lot of empty lines.\n            while (fgets(hugeBuffer, 4000, pFile)) {\n                if (strlen(hugeBuffer) &gt; 5) {\n                    // discard all those tons of #line n text lines generated by the Preprocessor\n                    if (strncmp(hugeBuffer, \"#line \", 6) == 0) continue;\n                    if (strcmp(hugeBuffer, sep) == 0)\n                    {\n                        break;\n                    }\n                    printf(\"%s\\n\", hugeBuffer);\n                }\n            }\n            fclose(pFile);\n        }\n    }\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 447, "user_id": 3573277, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IZtww.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/3573277/himanshu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 136, "favorite_count": 0, "closed_date": 1469646037, "answer_count": 1, "score": -4, "last_activity_date": 1469101768, "creation_date": 1469045057, "question_id": 38489855, "link": "https://stackoverflow.com/questions/38489855/view-function-prototypes-in-c", "closed_reason": "Needs more focus", "title": "View function prototypes in C", "body": "<p>Often during programming contests I forget which library contains which function. Hence I require some C code which can print the available functions with a specific library. eg. usage:</p>\n\n<p><code>showAvailFunctions(\"stdlib.h\")</code></p>\n\n<p>and it would print all the available functions with <code>stdlib.h</code> library</p>\n"}, {"tags": ["ios", "objective-c", "c", "iphone"], "comments": [{"owner": {"reputation": 1884, "user_id": 3078414, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b1180f5e68d3542488d66de14ff53964?s=128&d=identicon&r=PG&f=1", "display_name": "user3078414", "link": "https://stackoverflow.com/users/3078414/user3078414"}, "edited": false, "score": 0, "creation_date": 1469044663, "post_id": 38489504, "comment_id": 64381162, "body": "OSX and iOS audio programs are full of instructive examples: while a program in its entirety is written in Obj-C, the critical audio processing code has to be &quot;streamlined&quot; down to plain-C. Please, see the SO tag &quot;core-audio&quot;."}, {"owner": {"reputation": 62027, "user_id": 603977, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/myasv.jpg?s=128&g=1", "display_name": "jscs", "link": "https://stackoverflow.com/users/603977/jscs"}, "edited": false, "score": 0, "creation_date": 1469046357, "post_id": 38489504, "comment_id": 64382045, "body": "This doesn&#39;t really make sense; C is 100% usable from ObjC. Yes, it&#39;s one-way: you can&#39;t #include an ObjC header in a file compiled as C, or  make ObjC message sends, but it should be no problem at all to provide wrappers for your must-be-C functions in either an ObjC class or in C functions that are inside a file compiled as ObjC. Can you maybe provide a minimal demo of what you&#39;re doing and explain exactly how it fails?"}, {"owner": {"reputation": 4060, "user_id": 763355, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/dxAhW.jpg?s=128&g=1", "display_name": "MoDJ", "link": "https://stackoverflow.com/users/763355/modj"}, "edited": false, "score": 0, "creation_date": 1469049863, "post_id": 38489504, "comment_id": 64383750, "body": "You can call C methods from Objective-C, it is no big deal. Don&#39;t rename thing, just include the .c and .h files and go from there. You are over thinking it."}, {"owner": {"reputation": 327, "user_id": 4789239, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7cafa12a62a0f706156f9879e4381f41?s=128&d=identicon&r=PG&f=1", "display_name": "setzuiro", "link": "https://stackoverflow.com/users/4789239/setzuiro"}, "edited": false, "score": 0, "creation_date": 1469113318, "post_id": 38489504, "comment_id": 64413550, "body": "The problem isn&#39;t so much calling to C from ObjC, but more so having calling to ObjC in (.m) files from C methods in (.c) files. I updated my question with additional details and sample test code or what my expectations were."}], "answers": [{"comments": [{"owner": {"reputation": 327, "user_id": 4789239, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7cafa12a62a0f706156f9879e4381f41?s=128&d=identicon&r=PG&f=1", "display_name": "setzuiro", "link": "https://stackoverflow.com/users/4789239/setzuiro"}, "edited": false, "score": 0, "creation_date": 1469540300, "post_id": 38516683, "comment_id": 64571179, "body": "That was a beautiful answer to my question. Slightly related question though, I noticed here we&#39;re returning size_t for byte size, but while playing around a I had to define return type of strings in objc as <code>const char *</code> to c (knowing that c strings are character arrays). Took me a while to figure this out, but how would I define other common data types in this scenario?"}, {"owner": {"reputation": 62027, "user_id": 603977, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/myasv.jpg?s=128&g=1", "display_name": "jscs", "link": "https://stackoverflow.com/users/603977/jscs"}, "reply_to_user": {"reputation": 327, "user_id": 4789239, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7cafa12a62a0f706156f9879e4381f41?s=128&d=identicon&r=PG&f=1", "display_name": "setzuiro", "link": "https://stackoverflow.com/users/4789239/setzuiro"}, "edited": false, "score": 0, "creation_date": 1469551572, "post_id": 38516683, "comment_id": 64579095, "body": "I picked <code>size_t</code> so that the C side doesn&#39;t have to get the definition of <code>NSUInteger</code>, which is the actual return type of <code>lengthOfBytesUsingEncoding:</code>. They&#39;re not strictly the same, but as a practical matter, (AFAIK) they are the same size on all platforms. For this whole project, it&#39;s important to note that any valid C you write is valid as ObjC. Therefore, in the crossover interface, you simply need to make sure that you&#39;re using standard C types."}], "tags": [], "owner": {"reputation": 62027, "user_id": 603977, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/myasv.jpg?s=128&g=1", "display_name": "jscs", "link": "https://stackoverflow.com/users/603977/jscs"}, "is_accepted": true, "score": 2, "last_activity_date": 1469551258, "last_edit_date": 1469551258, "creation_date": 1469149633, "answer_id": 38516683, "question_id": 38489504, "link": "https://stackoverflow.com/questions/38489504/how-to-communicate-from-pure-c-c-files-sdk-to-ios-obj-c-m-files-framework/38516683#38516683", "title": "How to communicate from pure C (.c files) SDK to IOS (obj-C, .m files) framework?", "body": "<p>This line <code>#include \"GPSWrapper.h\"</code> in your example is the problem. You can't include a header that has ObjC syntax in a file that's being compiled as C. Any interface to the ObjC side that's being included in your C code needs to be broken out into its own header that contains only valid C. Here's a demo of what you need:</p>\n\n<p>First, header and implementation file for the C-only stuff.</p>\n\n<pre><code>//  CUtils.h\n//  OCFromC\n\n#ifndef CUtils_h\n#define CUtils_h\n\n#include &lt;stdio.h&gt;\n\nvoid doThatThingYouDo();\n\nvoid doThatThingWithThisObject(const void * objRef);\n\n#endif /* CUtils_h */\n</code></pre>\n\n<hr>\n\n<pre><code>//  CUtils.c\n//  OCFromC\n\n// Proof that this is being compiled without ObjC\n#ifdef __OBJC__\n#error \"Compile this as C, please.\"\n#endif\n\n#include \"CUtils.h\"\n#include \"StringCounterCInterface.h\"\n\nvoid doThatThingYouDo()\n{\n    printf(\"%zu\\n\", numBytesInUTF32(\"Calliope\"));\n}\n\nvoid doThatThingWithThisObject(const void * objRef)\n{\n    size_t len = numBytesInUTF32WithRef(objRef, \"Calliope\");\n    printf(\"%zu\\n\", len);\n}\n</code></pre>\n\n<p>Note that second function; if you need to, you can pass around an object reference in C land, as long as it's cloaked in a <code>void *</code>. There's also some casting that needs to be done for memory management. More on that below.</p>\n\n<p>This is the exciting ObjC class we'll be using:</p>\n\n<pre><code>//  StringCounter.h\n//  OCFromC\n\n#import &lt;Foundation/Foundation.h&gt;\n\n@interface StringCounter : NSObject\n\n- (size_t)lengthOfBytesInUTF32:(const char *)s;\n\n@end\n</code></pre>\n\n<hr>\n\n<pre><code> //  StringCounter.m\n //  OCFromC\n\n #import \"StringCounter.h\"\n\n @implementation StringCounter\n\n - (size_t)lengthOfBytesInUTF32:(const char *)s\n {\n     NSString * string = [NSString stringWithUTF8String:s];\n     return [string lengthOfBytesUsingEncoding:NSUTF32StringEncoding];\n }\n\n @end\n</code></pre>\n\n<p>Now, this is the important part. This is a header file that declares C functions. The header itself contains no ObjC, so it can be included in CUtils.c as you saw above.</p>\n\n<pre><code>//  StringCounterCInterface.h\n//  OCFromC\n\n#ifndef StringCounterCInterface_h\n#define StringCounterCInterface_h\n\n// Get size_t definition\n#import &lt;stddef.h&gt;\n\nsize_t numBytesInUTF32(const char * s);\nsize_t numBytesInUTF32WithRef(const void * scRef, const char *s);\n\n#endif /* StringCounterCInterface_h */\n</code></pre>\n\n<p><strong>This is the connection point.</strong> Its implementation file is compiled as ObjC, and it contains the definitions of those functions just declared. This file imports the interface of <code>StringCounter</code>, and so the functions can use methods from that class:</p>\n\n<pre><code>//  StringCounterCInterface.m\n//  OCFromC\n\n#ifndef __OBJC__\n#error \"Must compile as ObjC\"\n#endif\n\n#import \"StringCounterCInterface.h\"\n#import \"StringCounter.h\"\n\nsize_t numBytesInUTF32(const char * s)\n{\n    StringCounter * sc = [StringCounter new];\n    // Or, use some \"default\" object in static storage here\n    return [sc lengthOfBytesInUTF32:s];\n}\n\nsize_t numBytesInUTF32WithRef(const void * objRef, const char * s)\n{\n    StringCounter * sc = (__bridge_transfer StringCounter *)objRef;\n    return [sc lengthOfBytesInUTF32:s];\n}\n</code></pre>\n\n<p>Now, in main or wherever you like you can exercise those functions from CUtils:</p>\n\n<pre><code>//  main.m\n//  OCFromC\n\n#import &lt;Foundation/Foundation.h&gt;\n#import \"StringCounter.h\"\n#import \"CUtils.h\"\n\nint main(int argc, const char * argv[]) {\n    @autoreleasepool {\n\n        doThatThing();\n        // Create an object reference\n        StringCounter * sc = [StringCounter new];\n        // Tell ARC that I know this is dangerous, trust me,\n        // pass this reference along.\n        const void * scRef = (__bridge_retained void *)sc;\n        doThatThingWithThisObject(scRef);\n    }\n    return 0;\n}\n</code></pre>\n\n<p>The bridging cast, along with its counterpart in StringCounterCInterface.m, lets you move an ObjC object through areas where ARC cannot go. It bumps the object's retain count before it is hidden in the <code>void *</code>, so that it will not be accidentally deallocated before you can <code>__bridge_transfer</code> it back to ObjC land.</p>\n\n<p>One final note: If you are going to be passing object references around in C a lot, you might consider doing <code>typedef void * StringCounterRef;</code> and changing the signatures of everything appropriately.</p>\n"}], "owner": {"reputation": 327, "user_id": 4789239, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7cafa12a62a0f706156f9879e4381f41?s=128&d=identicon&r=PG&f=1", "display_name": "setzuiro", "link": "https://stackoverflow.com/users/4789239/setzuiro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 426, "favorite_count": 3, "accepted_answer_id": 38516683, "answer_count": 1, "score": 3, "last_activity_date": 1469551258, "creation_date": 1469043809, "last_edit_date": 1495540446, "question_id": 38489504, "link": "https://stackoverflow.com/questions/38489504/how-to-communicate-from-pure-c-c-files-sdk-to-ios-obj-c-m-files-framework", "title": "How to communicate from pure C (.c files) SDK to IOS (obj-C, .m files) framework?", "body": "<p>Preface: I have little experience with C integration in iOS, feel free to correct me on any misinterpretations I have about this.</p>\n\n<p>I have a project that has a custom 2-tier \"SDK\" both written in C. The <em>coreSDK</em> makes method calls to the <em>deviceSDK</em> which communicates with the <em>ios framework</em> to execute hardware actions (ie. enable camera) or retrieve device information (ie. path to NSDocumentDirectory).</p>\n\n<p>Unfortunately, due to the infrastructure, both SDK file extensions use (.h) and (.c) and cannot be changed to (.m) as some sources recommended. According to what I've read, I can create C-callbacks to the ObjC methods but that's only really viable for singletons, and the C-callback needs to be within the scope of the (.m) file.</p>\n\n<p>I have tried creating a wrapper class in ObjC such that it has a C-callback from which the <em>deviceSDK</em> calls to, but when including the header(.h) for that (.m), the compiler seems to crash. If my understanding is correct, it's because the C-compiler cannot interpret the ObjC language contained in the (.m).</p>\n\n<p>I believe theoretically is possible to write iOS apps in pure C with ObjC runtime, but ideally would rather not go down that route as what I've seen is absurdly complicated.</p>\n\n<p>An example workflow</p>\n\n<ol>\n<li><em>ViewController.m</em> method calls to <em>coreSDK</em> method (.c)</li>\n<li><em>coreSDK</em> method calls to <em>deviceSDK</em> method (.c)</li>\n<li><strong><em>deviceSDK</em> needs to retrieve (for example) <em>NSDocumentDirectory</em> (or enable camera)</strong></li>\n</ol>\n\n<p>How can I achieve this?<br>\nCode examples would be most comprehensive and appreciated.<br>\nThanks!<br></p>\n\n<hr>\n\n<p>These are some(not all) references I've already looked into...</p>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/questions/10289890/how-to-write-ios-app-purely-in-c\" title=\"How to write ios app purely in c\">How to write ios app purely in c</a></li>\n<li><a href=\"https://stackoverflow.com/questions/20419042/pure-c-function-calling-objective-c-method/\" title=\"Pure C function calling Objective-C method\">Pure C function calling Objective-C method</a></li>\n<li><a href=\"https://stackoverflow.com/questions/12854195/c-function-calling-objective-c-functions\">C function calling objective C functions</a></li>\n<li><a href=\"https://stackoverflow.com/questions/16556525/using-native-objective-c-method-for-c-callbacks\">Using native objective-c method for C callbacks</a></li>\n<li><a href=\"https://stackoverflow.com/questions/12193857/callback-methods-from-c-to-objective-c\">Callback methods from C to Objective-C</a></li>\n<li><a href=\"https://stackoverflow.com/questions/801976/mixing-c-functions-in-an-objective-c-class\">Mixing C functions in an Objective-C class</a></li>\n<li><a href=\"https://stackoverflow.com/questions/1280017/how-to-call-an-objective-c-method-from-a-c-method\">How to call an Objective-C method from a C method</a></li>\n<li><a href=\"https://stackoverflow.com/questions/12960552/how-to-use-pure-c-files-in-an-objective-c-project\">How to use pure C files in an objective-C project</a></li>\n</ul>\n\n<hr>\n\n<h2>Edit: 2016-07-21</h2>\n\n<p>To clarify the issue, I'm having trouble making calls from C methods in (.c) files to ObjC methods in (.m) files, or figuring out an alternative means to retrieve information such as (for example) NSDocumentsDirectory in ObjC (.m files) and passing back to C in (.c) files.</p>\n\n<p>Example Code: Of course it's incorrect but it's along the lines of my expectations or what I'm hoping to achieve.</p>\n\n<pre><code>//GPS.h\n#include \"GPSWrapper.h\"\nSTATUS_Code GPSInitialize(void);\n</code></pre>\n\n\n\n<pre><code>//GPS.c\n#include \"GPS.h\"\nSTATUS_Code GPSInitialize(void) {\n  GPS_cCallback();\n}\n</code></pre>\n\n\n\n<pre><code>//GPSWrapper.h\n#import &lt;Foundation/Foundation.h&gt;\n@interface GPSWrapper: NSObject\n- (void) testObjC;\n@end\n</code></pre>\n\n\n\n<pre><code>//GPSWrapper.m\n#import \"GPSWrapper.h\"\nstatic id refToSelf = nil;\n@implementation GPSWrapper\n  - (void) testObjC {\n    // just an example of a ObjC method call\n    NSString *documentsDirectory = [paths objectAtIndex:0];\n    NSLog(documentsDirectory);\n  }\n@end\n\nstatic void GPS_cCallback() {\n  [refToSelf testObjC];\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "function", "function-calls", "cs50"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 2, "creation_date": 1469043275, "post_id": 38489311, "comment_id": 64380331, "body": "<code>void convertNumber(int size, int array[size]);</code> that&#39;s not how you <i>call</i> a function"}, {"owner": {"reputation": 1884, "user_id": 3078414, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b1180f5e68d3542488d66de14ff53964?s=128&d=identicon&r=PG&f=1", "display_name": "user3078414", "link": "https://stackoverflow.com/users/3078414/user3078414"}, "edited": false, "score": 0, "creation_date": 1469043562, "post_id": 38489311, "comment_id": 64380506, "body": "Please, format your code consistently, it is difficult to read. Thanks"}, {"owner": {"reputation": 2988, "user_id": 452414, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rDMfs.png?s=128&g=1", "display_name": "babon", "link": "https://stackoverflow.com/users/452414/babon"}, "edited": false, "score": 0, "creation_date": 1469043673, "post_id": 38489311, "comment_id": 64380564, "body": "alternatively, <code>(void) convertNumber(int size, int array[size]);</code>"}, {"owner": {"reputation": 2988, "user_id": 452414, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rDMfs.png?s=128&g=1", "display_name": "babon", "link": "https://stackoverflow.com/users/452414/babon"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1469073690, "post_id": 38489311, "comment_id": 64389915, "body": "@SouravGhosh What I meant was, when the return type of a function is <code>void</code>, it can alternatively be invoked as: <code>(void) functionName();</code>."}], "answers": [{"comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1469044140, "post_id": 38489397, "comment_id": 64380844, "body": "And another good point would be to move declarations for <code>convertedNumber</code>, <code>base</code> and <code>digit</code> inside <code>main()</code> and pass them as parameters. There is no reason they should be global in scope. (there are cases where use of globals is required, but in general they should be avoided otherwise)"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1469044332, "post_id": 38489397, "comment_id": 64380969, "body": "@DavidC.Rankin Yes, I kind of missed the globals, edited my answer to accommodate them."}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 5, "last_activity_date": 1472393852, "last_edit_date": 1472393852, "creation_date": 1469043428, "answer_id": 38489397, "question_id": 38489311, "link": "https://stackoverflow.com/questions/38489311/why-isnt-my-variable-length-array-converting/38489397#38489397", "title": "Why isn&#39;t my variable length array converting?", "body": "<p>In your code, you never made a <em>call</em> to <code>convertNumber()</code> function. You should change the last part of <code>getNumberAndBase()</code> function from</p>\n\n<pre><code>void convertNumber(int size, int array[size]);\n</code></pre>\n\n<p>to</p>\n\n<pre><code>convertNumber (size, array);\n</code></pre>\n\n<p>to make a call.</p>\n\n<p>That said, you should define <code>convertedNumber</code>, <code>base</code> and <code>digit</code> inside <code>main()</code> and then pass them as some of the arguments to the functions (to be able to make use of it inside called functions). There's no reason for them to be global, in general.</p>\n\n<p>Also, move the function declarations out of <code>main()</code>; put them in file scope.</p>\n"}, {"tags": [], "owner": {"reputation": 3054, "user_id": 193848, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/HWieK.jpg?s=128&g=1", "display_name": "Andrew Cottrell", "link": "https://stackoverflow.com/users/193848/andrew-cottrell"}, "is_accepted": false, "score": 1, "last_activity_date": 1469048067, "creation_date": 1469048067, "answer_id": 38490670, "question_id": 38489311, "link": "https://stackoverflow.com/questions/38489311/why-isnt-my-variable-length-array-converting/38490670#38490670", "title": "Why isn&#39;t my variable length array converting?", "body": "<p>You have several bugs in your code.  Here's a working version of your code that is as unchanged as possible (I resisted the urge to clean it up).  I added comments to the changes I made.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;cs50.h&gt;\n\n/* I moved your prototypes up here rather than leaving them inline. */\nvoid displayConvertedNumber(void);\nvoid convertNumber(int size, int *array);\n\nint convertedNumber[64];\nint base;\nint digit = 0;\n\nvoid getNumberAndBase (void)\n{\n    /* I moved your variable declarations here.  If you want your C to be\n       portable, define your variables at the beginning of your function.\n       Don't expect \"int i = 0;\" to work in your for loop on all C compilers. */\n    int size;\n    int array[size];\n    int i;\n\n    printf(\"How many numbers to be converted??\\n\");\n    size = GetInt();\n\n    for(i = 0; i &lt; size; i++){\n        printf(\"Number to be converted?\\n\");\n        array[i] = GetInt();\n    }\n\n    printf(\"Base?\\n\");\n\n    do{\n        base = GetInt();\n\n        if(base &lt; 2 || base &gt; 16)\n        {\n            printf(\"Bad base - must be between 2 and 16. Try again!\\n\");\n        }\n    } while(base &lt; 2 || base &gt; 16);\n\n    /* I corrected your call to this function. */\n    convertNumber(size, array);\n}\n\nvoid convertNumber (int size, int numberToConvert[size])\n{\n    int i;\n\n    for(i = 0; i &lt; size; i++)\n    {\n        do{\n            convertedNumber[digit] = numberToConvert[i] % base;\n            digit++;\n            numberToConvert[i] /= base;\n        }\n        while(numberToConvert[i] != 0);\n\n        /* I added a call to display the number here.  The way\n           you've written your code means each number has to be\n           displayed after it is converted.  You cannot convert\n           them all first and then attempt to display them since\n           you're using a single variable and index (convertedNumber\n           and digit) for the conversion. */\n        displayConvertedNumber();\n    }\n}\n\nvoid displayConvertedNumber (void)\n{\n    const char baseDigits[16] = { '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', 'A', 'B', 'C', 'D', 'E', 'F'};\n    int nextDigit;\n\n    printf(\"Converted number = \");\n\n    for(--digit; digit &gt;= 0; --digit)\n    {\n        nextDigit = convertedNumber[digit];\n        printf(\"%c\", baseDigits[nextDigit]);\n    }\n\n    printf(\"\\n\");\n\n    /* I reset your digit variable here.  Otherwise it would have\n       been left at -1 since that was the exit condition for your\n       loop above. */\n    digit = 0;\n}\n\nint main (void)\n{\n    getNumberAndBase();\n    /* I removed the other function call because now everything is\n       handled in this function. */\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 437, "user_id": 6557079, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7ade9a92d724b19b0c7cc35bb300fc7d?s=128&d=identicon&r=PG&f=1", "display_name": "gloopit", "link": "https://stackoverflow.com/users/6557079/gloopit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1472394080, "creation_date": 1469043115, "last_edit_date": 1472394080, "question_id": 38489311, "link": "https://stackoverflow.com/questions/38489311/why-isnt-my-variable-length-array-converting", "title": "Why isn&#39;t my variable length array converting?", "body": "<p>I'm writing code that will take in an array of integers which can then be converted into a desired base, such as base-16.</p>\n\n<p>For some reason, the terminal makes its way through the program and prints out </p>\n\n<blockquote>\n  <p>\"converted number=  \"</p>\n</blockquote>\n\n<p>Here is my code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;cs50.h&gt;\n\nint convertedNumber[64];\nint base;\nint digit = 0;\n\nvoid getNumberAndBase(void) {\n    int size;\n\n    printf(\"How many numbers to be converted??\\n\");\n    size = GetInt();\n\n    int array[size];\n\n    for (int i = 0; i &lt; size; i++) {\n        printf(\"Number to be converted?\\n\");\n        array[i] = GetInt();\n    }\n\n    printf(\"Base?\\n\");\n\n    do {\n        base = GetInt();\n\n        if (base &lt; 2 || base &gt; 16) {\n            printf(\"Bad base - must be between 2 and 16. Try again!\\n\");\n        }\n    } while (base &lt; 2 || base &gt; 16);\n\n    void convertNumber(int size, int array[size]);\n}\n\nvoid convertNumber(int size, int numberToConvert[size]) {\n    for (int i = 0; i &lt; size; i++) {\n        do {\n            convertedNumber[digit] = numberToConvert[i] % base;\n            digit++;\n            numberToConvert[i] /= base;\n        } while (numberToConvert[i] != 0);\n    }\n}\n\nvoid displayConvertedNumber(void) {\n    const char baseDigits[16] = { '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', 'A', 'B', 'C', 'D', 'E', 'F'};\n    int nextDigit;\n\n    printf(\"Converted number = \");\n\n    for (--digit; digit &gt;= 0; --digit) {\n        nextDigit = convertedNumber[digit];\n        printf(\"%c\", baseDigits[nextDigit]);\n    }\n\n    printf(\"\\n\");\n}\n\nint main(void) {\n    void getNumberAndBase(void), displayConvertedNumber(void);\n\n    getNumberAndBase();\n    displayConvertedNumber();\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "pointers", "arguments"], "comments": [{"owner": {"reputation": 2988, "user_id": 452414, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rDMfs.png?s=128&g=1", "display_name": "babon", "link": "https://stackoverflow.com/users/452414/babon"}, "edited": false, "score": 1, "creation_date": 1469042904, "post_id": 38489122, "comment_id": 64380145, "body": "Can we see <code>_read_line()</code>?"}, {"owner": {"reputation": 2988, "user_id": 452414, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rDMfs.png?s=128&g=1", "display_name": "babon", "link": "https://stackoverflow.com/users/452414/babon"}, "edited": false, "score": 0, "creation_date": 1469043401, "post_id": 38489122, "comment_id": 64380408, "body": "You have written three functions named: <code>read_lines</code>, <code>_read_line</code> and <code>read_line</code>. Why?"}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1469043494, "post_id": 38489122, "comment_id": 64380476, "body": "Yes that pretty dangerous as it might lead to confusion. It&#39;s confusing. Better if you give them more <i>explicit</i> names. Like <code>read_line_with_something()</code> or something like that."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1469050907, "post_id": 38489122, "comment_id": 64384223, "body": "Worry about memory leakage or misuse in the <code>read_lines()</code> function.  Either you&#39;re leaking all the lines returned by <code>_read_line()</code> while you&#39;re finding out how many lines are in the file, or you are not making separate copies of each line in the second loop, so the array will end up holding multiple copies of the last line.  Neither is likely to be what you want."}], "answers": [{"comments": [{"owner": {"reputation": 555, "user_id": 4642081, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/813edfdbad12b8d0c3cc9c2066835825?s=128&d=identicon&r=PG&f=1", "display_name": "R.O.S.S", "link": "https://stackoverflow.com/users/4642081/r-o-s-s"}, "edited": false, "score": 0, "creation_date": 1469086522, "post_id": 38489195, "comment_id": 64395508, "body": "Thanks, it worked - but it is not unsafe, since the <code>open_file</code> functions checks if <code>fopen</code> returns <code>NULL</code>. If so, it <code>exit(1)</code>s."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "reply_to_user": {"reputation": 555, "user_id": 4642081, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/813edfdbad12b8d0c3cc9c2066835825?s=128&d=identicon&r=PG&f=1", "display_name": "R.O.S.S", "link": "https://stackoverflow.com/users/4642081/r-o-s-s"}, "edited": false, "score": 0, "creation_date": 1469102371, "post_id": 38489195, "comment_id": 64405887, "body": "You should not handle errors in a convoluted way, and you certainly SHOULD not <code>exit(1)</code> on any error. Make your function reusable, do not exit the whole program from it. Just return something that lets the caller know there is an error. Like <code>NULL</code>, why do you think <code>malloc()</code> returns <code>NULL</code> instead of simple calling <code>exit(0)</code>."}, {"owner": {"reputation": 555, "user_id": 4642081, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/813edfdbad12b8d0c3cc9c2066835825?s=128&d=identicon&r=PG&f=1", "display_name": "R.O.S.S", "link": "https://stackoverflow.com/users/4642081/r-o-s-s"}, "edited": false, "score": 0, "creation_date": 1469127823, "post_id": 38489195, "comment_id": 64422086, "body": "Well, returning <code>NULL</code> leads to <code>if (result == NULL)</code> everywhere. I would probably never use <code>open_file</code> anywhere else, and returning <code>NULL</code> from it would cause just a general failure of the whole program, so I will have to <code>exit(1)</code> somewhere else. And my code isn&#39;t meant to be reused by someone. If so, he must deal with this fact."}], "tags": [], "owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "is_accepted": true, "score": 1, "last_activity_date": 1469043077, "last_edit_date": 1469043077, "creation_date": 1469042715, "answer_id": 38489195, "question_id": 38489122, "link": "https://stackoverflow.com/questions/38489122/out-argument-doesnt-seem-to-work/38489195#38489195", "title": "Out argument doesn&#39;t seem to work", "body": "<p>Assuming that <code>read_line()</code> works as expected, what you want to achieve is only possible with a three star pointer, IMHO this is one case where you can use it because it's not really a three star pointer, it's a two star pointer whose address was passed to a function.</p>\n\n<p>The double <code>char</code> pointer in the <code>read_lines()</code> function is a local variable to the function, so storing the address returned by <code>calloc()</code> in it will not be preserved when the function returns, instead you should pass the address of the pointer and store the return value of <code>calloc()</code> by dereferencing the pointer and assigning it to the real two star pointer defined in <code>main()</code>, somethin like this</p>\n\n<pre><code>size_t read_lines(const char *file_name, char ***buffer)\n{\n    size_t n_lines = 0;\n    FILE *file = open_file(file_name);\n    // FIXME: check if `file != NULL' before reading\n    while (1) {\n        char *ln = _read_line(file);\n        if (ln == NULL)\n            break;\n        n_lines++;\n    }\n    fclose(file);\n\n    file = open_file(file_name);\n    // FIXME: check if `file != NULL' before reading\n    *buffer = malloc(n_lines * sizeof(**buffer));\n    // FIXME: check that `malloc' did not return `NULL'\n    for (int i = 0; i &lt; n_lines; i++)\n        (*buffer)[i] = read_line(file);\n    fclose(file);\n    return n_lines;\n}\n</code></pre>\n\n<p>Note that:</p>\n\n<ol>\n<li><p>I replaced <code>calloc()</code> with <code>malloc()</code> since the line should be <code>null</code> terminated inside <code>read_line()</code>. Using <code>calloc()</code> in this case can hide some bugs that would be very hard to debug. If you instead use <code>malloc()</code> you can easily reveal the potential bugs with a tool like <a href=\"http://www.valgrind.org\" rel=\"nofollow\">valgrind</a>.</p></li>\n<li><p>I added smoe comments to let you see that your code is very unsafe.</p></li>\n</ol>\n\n<p>On <code>main()</code> you would do this</p>\n\n<pre><code>#define PLEASE_AVOID_SUCH_LONG_LINES \"/Users/honzik/Documents/Xcode/BoioVM/BoioVM/test_file.bic\"\n\nsize_t length = read_lines(PLEASE_AVOID_SUCH_LONG_LINES, &amp;lines);\n/* long lines make the code hard to read even on modern editors */\n</code></pre>\n"}], "owner": {"reputation": 555, "user_id": 4642081, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/813edfdbad12b8d0c3cc9c2066835825?s=128&d=identicon&r=PG&f=1", "display_name": "R.O.S.S", "link": "https://stackoverflow.com/users/4642081/r-o-s-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 38489195, "answer_count": 1, "score": -1, "last_activity_date": 1469043077, "creation_date": 1469042450, "question_id": 38489122, "link": "https://stackoverflow.com/questions/38489122/out-argument-doesnt-seem-to-work", "title": "Out argument doesn&#39;t seem to work", "body": "<p>I'm parsing a text file - I am able to open it, read it and delete unnecessary pieces from string.<br>\nHowever, I'm not able to get this code to work:</p>\n\n<pre><code>size_t read_lines(const char *file_name, char **buffer) {\n    size_t n_lines = 0;\n\n    FILE *file = open_file(file_name);\n\n    while (1) {\n        char *ln = _read_line(file);\n\n        if (ln == NULL) {\n            break;\n        }\n\n        n_lines++;\n    }\n\n    fclose(file);\n\n    file = open_file(file_name);\n\n    buffer = calloc(n_lines, sizeof(char *));\n\n    for (int i = 0; i &lt; n_lines; i++) {\n        buffer[i] = read_line(file);\n    }\n\n    fclose(file);\n\n    return n_lines;\n}\n\nint main(int argc, const char *argv[]) {\n    char **lines;\n\n    size_t length = read_lines(\"/Users/honzik/Documents/Xcode/BoioVM/BoioVM/test_file.bic\", lines);\n\n    for (int i = 0; i &lt; length; i++) {\n        printf(\"%s\\n\", lines[i]);\n    }\n\n    free(lines);\n\n    return 0;\n}\n</code></pre>\n\n<p>I know this is probably crappy code, but it just <em>should</em> work.<br>\nOr maybe not? The <code>lines</code> are equal to <code>NULL</code>, but how to get the pointer updated by the function?   </p>\n\n<p><em>P.S.: Don't worry about all those functions (<code>open_file</code>, <code>read_line</code>, <code>_read_line</code>, ...) they work :)</em></p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 2, "creation_date": 1469042352, "post_id": 38489049, "comment_id": 64379844, "body": "You need to check if <code>strtok()</code> returns NULL in <i>every</i> call. In both of the <code>if</code> statements, you don&#39;t check that."}], "answers": [{"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 1, "last_activity_date": 1469042612, "creation_date": 1469042612, "answer_id": 38489159, "question_id": 38489049, "link": "https://stackoverflow.com/questions/38489049/i-keep-getting-segfault-11-on-the-second-if-loop-whats-the-reason/38489159#38489159", "title": "I keep getting segfault 11 on the second if loop, what&#39;s the reason?", "body": "<p>Two issues:</p>\n\n<ol>\n<li>The <code>%s</code> format specifier to <code>scanf</code> expects a <code>char *</code> but you pass a <code>char **</code>.  In practice, these will typically evaluate to the same value, so this is most likely not the cause of the segfault.</li>\n<li>You check <code>token</code> for <code>NULL</code> <strong>before</strong> reading the next token instead of after.  So if you do the check, then call <code>strtok</code> again which returns <code>NULL</code>, then use <code>token</code>, you dereference a <code>NULL</code> pointer.</li>\n</ol>\n\n<p>So make the following updates:</p>\n\n<pre><code>scanf(\"%[^\\n]s\", input);     // pass input, not &amp;input\ntoken = strtok(input, space);\nstrcpy(firstName, token);\ntoken = strtok(NULL, space);     // get token first\nif (token != NULL){\n    strcpy(middleName, token);\n    token = strtok(NULL, space);     // get token first\n}\nif (token != NULL){\n    strcpy(lastName, token);\n    printf(\"%s %c. %c.\\n\", lastName, middleName[0], firstName[0]);\n}\nelse {\n    printf(\"%s\", middleName);\n    printf(\"%s %c.\\n\", middleName, firstName[0]);\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1469044975, "post_id": 38489174, "comment_id": 64381304, "body": "Just a slight addition for completeness, &quot;<code>strtok()</code> returns pointers to the <code>input</code> array that remain valid after successive calls&quot;... <i>so long as <code>input</code> remains in scope</i>."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1469611788, "post_id": 38489174, "comment_id": 64604542, "body": "@Zhou: can you please accept one of the answers by clicking on the grey checkmark below the answer score?"}], "tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 2, "last_activity_date": 1469045170, "last_edit_date": 1469045170, "creation_date": 1469042663, "answer_id": 38489174, "question_id": 38489049, "link": "https://stackoverflow.com/questions/38489049/i-keep-getting-segfault-11-on-the-second-if-loop-whats-the-reason/38489174#38489174", "title": "I keep getting segfault 11 on the second if loop, what&#39;s the reason?", "body": "<p>There are multiple issues in your code:</p>\n\n<ul>\n<li>You are testing for a <code>NULL</code> value for <code>token</code> <strong>after</strong> using it as an argument to <code>strcpy</code>: you are effectively invoking undefined behavior unless all 3 parts are present.</li>\n<li>You pass the address of the array <code>input</code> as the destination for <code>scanf(\"%[\\n]\"</code>.  This is incorrect, although unlikely to cause a problem.</li>\n<li>There is an extra <code>s</code> at the end of the <code>\"%[\\n]\"</code> format.  Incorrect but not a major issue.</li>\n<li>You do not check the return value of <code>scanf()</code>.  If the input is empty, your code invokes undefined behavior.</li>\n<li>You do not provide <code>scanf</code> with size information to prevent buffer overflow on invalid input.</li>\n<li>The arrays for <code>firstName</code>, <code>middleName</code> and <code>lastName</code> are smaller than <code>intput</code>.  You may cause buffer overflows on input with very long name parts.</li>\n</ul>\n\n<p>Here is a corrected version:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nconst char space[2] = \" \";\n\nint main(void) {\n    char input[50], firstName[50], middleName[50], lastName[50], *token;\n\n    if (scanf(\"%49[^\\n]\", input) != 1)\n        return 1;\n    token = strtok(input, space);\n    if (token != NULL) {\n        strcpy(firstName, token);   \n        token = strtok(NULL, space);\n        if (token != NULL) {\n            strcpy(middleName, token);\n            token = strtok(NULL, space);\n            if (token != NULL) {\n                strcpy(lastName, token);\n                printf(\"%s %c. %c.\\n\", lastName, middleName[0], firstName[0]);\n            } else {\n                printf(\"%s %c.\\n\", middleName, firstName[0]);\n            }\n        } else {\n            printf(\"%s\\n\", firstName);\n        }\n    }\n    return 0;\n}\n</code></pre>\n\n<p>Note that you do not need to copy the name parts, <code>strtok()</code> returns pointers to the <code>input</code> array that remain valid after successive calls as long as <code>input</code> remains in scope.  Here is a simpler version:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nconst char space[2] = \" \";\n\nint main(void) {\n    char input[50], *part1, *part2, *part3;\n\n    if (scanf(\"%49[^\\n]\", input) != 1)\n        return 1;\n\n    part1 = strtok(input, space);\n    if (part1 != NULL) {\n        part2 = strtok(NULL, space);\n        if (part2 != NULL) {\n            part3 = strtok(NULL, space);\n            if (part3 != NULL) {\n                printf(\"%s %c. %c.\\n\", part3, *part1, *part2);\n            } else {\n                printf(\"%s %c.\\n\", part2, *part1);\n            }\n        } else {\n            printf(\"%s\\n\", part1);\n        }\n    }\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 6525750, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-38ElGaNu3hs/AAAAAAAAAAI/AAAAAAAACIE/PxaO00EGIas/photo.jpg?sz=128", "display_name": "Zhou", "link": "https://stackoverflow.com/users/6525750/zhou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1469045170, "creation_date": 1469042208, "question_id": 38489049, "link": "https://stackoverflow.com/questions/38489049/i-keep-getting-segfault-11-on-the-second-if-loop-whats-the-reason", "title": "I keep getting segfault 11 on the second if loop, what&#39;s the reason?", "body": "<p>I'm trying to write a program that reads a person name on the form first name followed by either middle name and last name or just last name. Then the program should display the name as last name followed by comma, then first letter of the first name followed by a period. Example of input: </p>\n\n<pre><code>John Smith\n</code></pre>\n\n<p>the output should be </p>\n\n<pre><code>Smith J. \n</code></pre>\n\n<p>Another example input: </p>\n\n<pre><code>John David Smith\n</code></pre>\n\n<p>output: </p>\n\n<pre><code>Smith D. J.\n</code></pre>\n\n<p>This is the program I wrote: </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nconst char space[2] = \" \";\n\nint main(){\n    char input[50], firstName[20], middleName[20], lastName[20], *token;\n    scanf(\"%[^\\n]s\", &amp;input);\n    token = strtok(input, space);\n    strcpy(firstName, token);   \n    if (token != NULL){\n        token = strtok(NULL, space);\n        strcpy(middleName, token);\n    }\n    if (token != NULL){\n        token = strtok(NULL, space);\n        strcpy(lastName, token);\n        printf(\"%s %c. %c.\\n\", lastName, middleName[0], firstName[0]);\n    }\n    else {\n        printf(\"%s\", middleName);\n        printf(\"%s %c.\\n\", middleName, firstName[0]);\n    }\n    return 0;\n}\n</code></pre>\n\n<p>It works when the input name has a middle name, for example if I type \"John David Smith\" it will throw \"Smith D. J.\", but if I type \"John Smith\", it will throw a segfault 11. \n    So what's the problem? Is is because I didn't use strtok properly?  </p>\n"}, {"tags": ["c", "cs50"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1469041400, "post_id": 38488764, "comment_id": 64379270, "body": "You have an additional <code>main</code> function compiled into one of the linked object files.."}, {"owner": {"reputation": 15946, "user_id": 4606734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/858769040849894/picture?type=large", "display_name": "ameyCU", "link": "https://stackoverflow.com/users/4606734/ameycu"}, "edited": false, "score": 0, "creation_date": 1469041407, "post_id": 38488764, "comment_id": 64379276, "body": "Is there another file with <code>main</code> in project ?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1469041851, "post_id": 38488764, "comment_id": 64379554, "body": "Well, from the error message it looks like both <code>dictionary.c</code> and <code>speller.c</code> have <code>main</code>."}, {"owner": {"reputation": 13866, "user_id": 54200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6261c8ab215b8069e8290516c80445d8?s=128&d=identicon&r=PG", "display_name": "KevinDTimm", "link": "https://stackoverflow.com/users/54200/kevindtimm"}, "edited": false, "score": 4, "creation_date": 1469042823, "post_id": 38488764, "comment_id": 64380098, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/8893093/compile-time-error-multiple-definition-of-main\">Compile-time error: Multiple definition of &#39;main&#39;</a>"}, {"owner": {"reputation": 13866, "user_id": 54200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6261c8ab215b8069e8290516c80445d8?s=128&d=identicon&r=PG", "display_name": "KevinDTimm", "link": "https://stackoverflow.com/users/54200/kevindtimm"}, "edited": false, "score": 0, "creation_date": 1469042869, "post_id": 38488764, "comment_id": 64380126, "body": "Please Please Please search before you ask a question - the first result from <code>gcc multiple definition of main</code> returned the duplicate question :("}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 13866, "user_id": 54200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6261c8ab215b8069e8290516c80445d8?s=128&d=identicon&r=PG", "display_name": "KevinDTimm", "link": "https://stackoverflow.com/users/54200/kevindtimm"}, "edited": false, "score": 0, "creation_date": 1469050554, "post_id": 38488764, "comment_id": 64384062, "body": "@KevinDTimm: the suggested duplicate is tagged C++ and not C.  Although the basic problem is the same, I&#39;m leery of duplicating a C question to a C++ question."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1469050707, "post_id": 38488764, "comment_id": 64384142, "body": "The file <code>dictionary.c</code> also contains a <code>main()</code> function.  You need to ensure that there is only one <code>main()</code> function in the object files linked together to make your spelling program.  Probably, you need to make the <code>main()</code> program in <code>dictionary.c</code> into code that is only compiled when you&#39;re testing <code>dictionary.c</code>, or you need to move it into a new file such as <code>test-dictionary.c</code> leaving only the working dictionary code in <code>dictionary.c</code> itself \u2014 the code used by both <code>spelling.c</code> and <code>dictionary.c</code>, described by <code>dictionary.h</code>."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 2857, "user_id": 1982136, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3aEnN.png?s=128&g=1", "display_name": "Tim Malone", "link": "https://stackoverflow.com/users/1982136/tim-malone"}, "edited": false, "score": 2, "creation_date": 1469051218, "post_id": 38488764, "comment_id": 64384339, "body": "@TimMalone: Like in the answer? :D"}, {"owner": {"reputation": 13866, "user_id": 54200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6261c8ab215b8069e8290516c80445d8?s=128&d=identicon&r=PG", "display_name": "KevinDTimm", "link": "https://stackoverflow.com/users/54200/kevindtimm"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1469106072, "post_id": 38488764, "comment_id": 64408379, "body": "@JonathanLeffler - Regardless of tag - the solution was the same, which in my eyes makes it a duplicate."}], "answers": [{"tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": false, "score": 1, "last_activity_date": 1469051157, "creation_date": 1469051157, "answer_id": 38491394, "question_id": 38488764, "link": "https://stackoverflow.com/questions/38488764/multiple-definition-of-main-error-in-cs50-pset5-speller-c/38491394#38491394", "title": "&#39;Multiple definition of main&#39; error in cs50 pset5 speller.c", "body": "<p>The file <code>spelling.c</code>, which you show us, contains a <code>main()</code> function; that's fine.  The file <code>dictionary.c</code>, which you don't show us, also contains a <code>main()</code> function; that's the problem.</p>\n\n<p>You need to ensure that there is only one <code>main()</code> function in the object files linked together to make your spelling program \u2014 and in this context, you probably want just the <code>main()</code> from <code>spelling.c</code>.</p>\n\n<p>Probably, you need to make the <code>main()</code> program in <code>dictionary.c</code> into code that is only compiled when you're testing <code>dictionary.c</code>.  Alternatively, you need to move the test <code>main()</code> into a new file such as <code>test-dictionary.c</code>, leaving only the main working dictionary code in <code>dictionary.c</code> itself \u2014 the code that's used by both <code>spelling.c</code> and <code>dictionary.c</code>, the code that's described by <code>dictionary.h</code>.</p>\n"}], "owner": {"reputation": 1, "user_id": 6569424, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-8ZacFvRV1_c/AAAAAAAAAAI/AAAAAAAAAK4/nhEBkN_cGb4/photo.jpg?sz=128", "display_name": "Savage42", "link": "https://stackoverflow.com/users/6569424/savage42"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 456, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1469847296, "creation_date": 1469041233, "last_edit_date": 1469847296, "question_id": 38488764, "link": "https://stackoverflow.com/questions/38488764/multiple-definition-of-main-error-in-cs50-pset5-speller-c", "title": "&#39;Multiple definition of main&#39; error in cs50 pset5 speller.c", "body": "<p>I need help with an error I keep getting in <code>speller.c</code> for pset5 from the <a href=\"https://manual.cs50.net/library/\" rel=\"nofollow\">CS50</a> course. The error looks like this:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>clang -ggdb3 -O0 -Qunused-arguments -std=c11 -Wall -Werror -o speller speller.o dictionary.o \ndictionary.o: In function `main':\n/home/ubuntu/workspace/pset5/dictionary.c:21: multiple definition of `main'\nspeller.o:/home/ubuntu/workspace/pset5/speller.c:28: first defined here\nclang: error: linker command failed with exit code 1 (use -v to see invocation)\nmake: *** [speller] Error 1a\"\n</code></pre>\n\n<p>Does anyone know how to fix this? </p>\n\n<pre class=\"lang-c prettyprint-override\"><code>/****************************************************************************\n * speller.c\n *\n * Computer Science 50\n * Problem Set 6\n *\n * Implements a spell-checker.\n ***************************************************************************/\n\n#include &lt;ctype.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;sys/resource.h&gt;\n#include &lt;sys/time.h&gt;\n\n#include \"dictionary.h\"\n\n\n// default dictionary\n#define DICTIONARY \"/home/cs50/pset6/dictionaries/large\"\n\n// prototype\ndouble calculate(const struct rusage *b, const struct rusage *a);\n\n\nint\nmain(int argc, char *argv[])\n{\n    // check for correct number of args\n    if (argc != 2 &amp;&amp; argc != 3)\n    {\n        printf(\"Usage: speller [dictionary] text\\n\");\n        return 1;\n    }\n\n    // structs for timing data\n    struct rusage before, after;\n\n    // benchmarks\n    double ti_load = 0.0, ti_check = 0.0, ti_size = 0.0, ti_unload = 0.0;\n\n    // determine dictionary to use\n    char *dictionary = (argc == 3) ? argv[1] : DICTIONARY;\n\n    // load dictionary\n    getrusage(RUSAGE_SELF, &amp;before);\n    bool loaded = load(dictionary);\n    getrusage(RUSAGE_SELF, &amp;after);\n\n    // abort if dictionary not loaded\n    if (!loaded)\n    {\n        printf(\"Could not load %s.\\n\", dictionary);\n        return 2;\n    }\n\n    // calculate time to load dictionary\n    ti_load = calculate(&amp;before, &amp;after);\n\n    // try to open text\n    char *text = (argc == 3) ? argv[2] : argv[1];\n    FILE *fp = fopen(text, \"r\");\n    if (fp == NULL)\n    {\n        printf(\"Could not open %s.\\n\", text);\n        unload();\n        return 3;\n    }\n\n    // prepare to report misspellings\n    printf(\"\\nMISSPELLED WORDS\\n\\n\");\n\n    // prepare to spell-check\n    int index = 0, misspellings = 0, words = 0;\n    char word[LENGTH+1];\n\n    // spell-check each word in text\n    for (int c = fgetc(fp); c != EOF; c = fgetc(fp))\n    {\n        // allow only alphabetical characters and apostrophes\n        if (isalpha(c) || (c == '\\'' &amp;&amp; index &gt; 0))\n        {\n            // append character to word\n            word[index] = c;\n            index++;\n\n            // ignore alphabetical strings too long to be words\n            if (index &gt; LENGTH)\n            {\n                // consume remainder of alphabetical string\n                while ((c = fgetc(fp)) != EOF &amp;&amp; isalpha(c));\n\n                // prepare for new word\n                index = 0;\n            }\n        }\n\n        // ignore words with numbers (like MS Word can)\n        else if (isdigit(c))\n        {\n            // consume remainder of alphanumeric string\n            while ((c = fgetc(fp)) != EOF &amp;&amp; isalnum(c));\n\n            // prepare for new word\n            index = 0;\n        }\n\n        // we must have found a whole word\n        else if (index &gt; 0)\n        {\n            // terminate current word\n            word[index] = '\\0';\n\n            // update counter\n            words++;\n\n            // check word's spelling\n            getrusage(RUSAGE_SELF, &amp;before);\n            bool misspelled = !check(word);\n            getrusage(RUSAGE_SELF, &amp;after);\n\n            // update benchmark\n            ti_check += calculate(&amp;before, &amp;after);\n\n            // print word if misspelled\n            if (misspelled)\n            {\n                printf(\"%s\\n\", word);\n                misspellings++;\n            }\n\n            // prepare for next word\n            index = 0;\n        }\n    }\n\n    // check whether there was an error\n    if (ferror(fp))\n    {\n        fclose(fp);\n        printf(\"Error reading %s.\\n\", text);\n        unload();\n        return 4;\n    }\n\n    // close text\n    fclose(fp);\n\n    // determine dictionary's size\n    getrusage(RUSAGE_SELF, &amp;before);\n    unsigned int n = size();\n    getrusage(RUSAGE_SELF, &amp;after);\n\n    // calculate time to determine dictionary's size\n    ti_size = calculate(&amp;before, &amp;after);\n\n    // unload dictionary\n    getrusage(RUSAGE_SELF, &amp;before);\n    bool unloaded = unload();\n    getrusage(RUSAGE_SELF, &amp;after);\n\n    // abort if dictionary not unloaded\n    if (!unloaded)\n    {\n        printf(\"Could not unload %s.\\n\", dictionary);\n        return 5;\n    }\n\n    // calculate time to unload dictionary\n    ti_unload = calculate(&amp;before, &amp;after);\n\n    // report benchmarks\n    printf(\"\\nWORDS MISSPELLED:     %d\\n\", misspellings);\n    printf(\"WORDS IN DICTIONARY:  %d\\n\", n);\n    printf(\"WORDS IN TEXT:        %d\\n\", words);\n    printf(\"TIME IN load:         %.2f\\n\", ti_load);\n    printf(\"TIME IN check:        %.2f\\n\", ti_check);\n    printf(\"TIME IN size:         %.2f\\n\", ti_size);\n    printf(\"TIME IN unload:       %.2f\\n\", ti_unload);\n    printf(\"TIME IN TOTAL:        %.2f\\n\\n\", \n     ti_load + ti_check + ti_size + ti_unload);\n\n    // that's all folks\n    return 0;\n}\n\n\n/*\n * Returns number of seconds between b and a.\n */\n\ndouble\ncalculate(const struct rusage *b, const struct rusage *a)\n{\n    if (b == NULL || a == NULL)\n        return 0;\n    else\n        return ((((a-&gt;ru_utime.tv_sec * 1000000 + a-&gt;ru_utime.tv_usec) -\n                 (b-&gt;ru_utime.tv_sec * 1000000 + b-&gt;ru_utime.tv_usec)) +\n                ((a-&gt;ru_stime.tv_sec * 1000000 + a-&gt;ru_stime.tv_usec) -\n                 (b-&gt;ru_stime.tv_sec * 1000000 + b-&gt;ru_stime.tv_usec)))\n                / 1000000.0);\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "sockets", "pthreads"], "answers": [{"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 0, "last_activity_date": 1469041529, "creation_date": 1469041529, "answer_id": 38488872, "question_id": 38488749, "link": "https://stackoverflow.com/questions/38488749/using-printf-with-threads-and-socket-programming/38488872#38488872", "title": "Using printf with threads and socket programming", "body": "<p>Besides the characters the user is typing in, you're also getting a carriage return (0xd) and linefeed (0xa) character when the user presses the Enter key.  That's why you're getting a number 2 larger than you might expect.</p>\n"}, {"comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1469042094, "post_id": 38488968, "comment_id": 64379690, "body": "There are even special ascii values for this (<i>normally used in serial terminals, but still useful and used</i>). I once worked with a device that would use them. STX (0x02) to start text, and I think it was 0x03 to end text. So the OP could use those <i>unused</i> ascii values for that too. I am working currently with a websocket server that sends lists of Json separated with such characters and also uses the STX."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1469042506, "post_id": 38488968, "comment_id": 64379932, "body": "Of course, I know. I actually don&#39;t really understand why it is done like that. It&#39;s a service on the web that is not documented or anything and I simply infered the way things are sent or received to/from it, to work with it. But it is indeed wierd. Since you can define arrays in pure Json so no need for any separators or special characters. But that is the way it works."}, {"owner": {"reputation": 920, "user_id": 5380429, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh3.googleusercontent.com/-euCKL3OsdNI/AAAAAAAAAAI/AAAAAAAAAA4/DhoXnoeEixQ/photo.jpg?sz=128", "display_name": "Shivam Mitra", "link": "https://stackoverflow.com/users/5380429/shivam-mitra"}, "edited": false, "score": 0, "creation_date": 1469044073, "post_id": 38488968, "comment_id": 64380796, "body": "@BenVoigt Have a look at the edited code. It is working fine after I removed  last two characters. Will this work all the time?"}, {"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "reply_to_user": {"reputation": 920, "user_id": 5380429, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh3.googleusercontent.com/-euCKL3OsdNI/AAAAAAAAAAI/AAAAAAAAAA4/DhoXnoeEixQ/photo.jpg?sz=128", "display_name": "Shivam Mitra", "link": "https://stackoverflow.com/users/5380429/shivam-mitra"}, "edited": false, "score": 0, "creation_date": 1469044355, "post_id": 38488968, "comment_id": 64380982, "body": "@ShivamMitra: No, it won&#39;t be reliable.  A single command such as <code>exit</code> could be split across multiple read calls (e.g. you get <code>e</code> from the first and then <code>xit\\r\\n</code> from the second -- this is really bad because now index <code>n-2</code> where you write the NUL character is negative and you corrupt another object) or you could get more than one command in a single read call like <code>hello\\r\\nexit\\r\\n</code>"}], "tags": [], "owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "is_accepted": true, "score": 3, "last_activity_date": 1469041903, "creation_date": 1469041903, "answer_id": 38488968, "question_id": 38488749, "link": "https://stackoverflow.com/questions/38488749/using-printf-with-threads-and-socket-programming/38488968#38488968", "title": "Using printf with threads and socket programming", "body": "<p>TCP is a stream-oriented protocol, there are no message boundaries.  So you cannot write application logic that depends on the return value of <code>read()</code> as you are doing.</p>\n\n<p>Workarounds for this are length-prefixed strings, or sending the NUL terminator through the socket.  You can dream up other mechanisms too, but the client must, within the data stream, tell the server where the message ends; the TCP layer won't do that.</p>\n"}], "owner": {"reputation": 920, "user_id": 5380429, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh3.googleusercontent.com/-euCKL3OsdNI/AAAAAAAAAAI/AAAAAAAAAA4/DhoXnoeEixQ/photo.jpg?sz=128", "display_name": "Shivam Mitra", "link": "https://stackoverflow.com/users/5380429/shivam-mitra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 156, "favorite_count": 0, "accepted_answer_id": 38488968, "answer_count": 2, "score": 0, "last_activity_date": 1469043846, "creation_date": 1469041193, "last_edit_date": 1469043846, "question_id": 38488749, "link": "https://stackoverflow.com/questions/38488749/using-printf-with-threads-and-socket-programming", "title": "Using printf with threads and socket programming", "body": "<p>I was making a server using socket programming that echoes what the client says to him. But when I print out the message(send by client) and it's length, the message and it's length don't match. I am using printf to print. </p>\n\n<p>What I basically want is to close the connection when the client types \"exit\". But strcmp(\"exit\",clientmessage) is not working. </p>\n\n<p>server code:</p>\n\n<pre><code>//for running type ./a.out anyportnumber\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/types.h&gt; \n#include &lt;sys/socket.h&gt;\n#include &lt;netinet/in.h&gt;\n#include &lt;pthread.h&gt;\n\nvoid *function(void *s)\n{\n    int s1;\n    int n;\n    char rmsg[500];\n    s1 = *(int *)s;\n    while((n = read(s1,rmsg,499)) &gt; 0) {\n        rmsg[n] = '\\0';\n        printf(\"%s %d\\n\",rmsg,strlen(rmsg));\n        bzero(rmsg,499);\n    }\n    pthread_exit(NULL);\n}\nint main(int arrc,char *argv[])\n{\n    struct sockaddr_in server,client;\n    int s1,len;\n    int s2;\n    int n;\n    int i = 0;\n    int port;\n    pthread_t t1;\n    char message[500];\n    port = atoi(argv[1]);\n    bzero((char *)&amp;server,sizeof(server));\n    server.sin_port = htons(port);\n    server.sin_addr.s_addr = INADDR_ANY;\n    server.sin_family = AF_INET;\n    s1 = socket(AF_INET,SOCK_STREAM,0);\n    if(s1 == -1) {\n        perror(\"socket not created\\n\");\n        exit(1);\n    }\n    if(bind(s1,(struct sockaddr *)&amp;server,sizeof(struct sockaddr)) == -1) {\n        perror(\"socket not binded\\n\");\n        exit(1);\n    }\n    if(listen(s1,5) == -1) {\n        perror(\"unable to listen\");\n        exit(1);\n    }\n    len = sizeof(struct sockaddr_in);\n    s2 = accept(s1,(struct sockaddr *)&amp;client,&amp;len);\n    pthread_create(&amp;t1,NULL,function,(void *)&amp;s2);\n    pthread_join(t1,NULL);\n    close(s2);\n    close(s1);\n    return 0;\n\n}\n</code></pre>\n\n<p>client side input:</p>\n\n<pre><code>shivam@shivam-HP-Pavilion-15-Notebook-PC:~$ telnet localhost 8009\nTrying 127.0.0.1...\nConnected to localhost.\nEscape character is '^]'.\nhhh\njhiklmnop\n</code></pre>\n\n<p>Server side output:</p>\n\n<pre><code>shivam@shivam-HP-Pavilion-15-Notebook-PC:~/Study/chat$ ./a.out 8009\nhhh\n 5\njhiklmnop\n 11\n</code></pre>\n\n<p>Edited code:</p>\n\n<pre><code>//for running type ./a.out anyportnumber\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/types.h&gt; \n#include &lt;sys/socket.h&gt;\n#include &lt;netinet/in.h&gt;\n#include &lt;pthread.h&gt;\nvoid *function(void *s)\n{\n    int s1;\n    int n;\n    char rmsg[500];\n    s1 = *(int *)s;\n    char d[] = {'e','x','i','t','\\0'};\n    while((n = read(s1,rmsg,499)) &gt; 0) {\n        rmsg[n-2] = '\\0';\n        if(strcmp(d,rmsg) == 0) {\n            write(s1,\"bye\",3);\n            close(s1);\n        }\n        rmsg[n-2] = '\\n';\n        rmsg[n-1] = '\\0';\n        write(s1,rmsg,strlen(rmsg));\n        bzero(rmsg,499);\n    }\n    pthread_exit(NULL);\n}\nint main(int arrc,char *argv[])\n{\n    struct sockaddr_in server,client;\n    int s1,len;\n    int s2;\n    int n;\n    int i = 0;\n    int port;\n    pthread_t t1;\n    char message[500];\n    port = atoi(argv[1]);\n    bzero((char *)&amp;server,sizeof(server));\n    server.sin_port = htons(port);\n    server.sin_addr.s_addr = INADDR_ANY;\n    server.sin_family = AF_INET;\n    s1 = socket(AF_INET,SOCK_STREAM,0);\n    if(s1 == -1) {\n        perror(\"socket not created\\n\");\n        exit(1);\n    }\n    if(bind(s1,(struct sockaddr *)&amp;server,sizeof(struct sockaddr)) == -1) {\n        perror(\"socket not binded\\n\");\n        exit(1);\n    }\n    if(listen(s1,5) == -1) {\n        perror(\"unable to listen\");\n        exit(1);\n    }\n    len = sizeof(struct sockaddr_in);\n    s2 = accept(s1,(struct sockaddr *)&amp;client,&amp;len);\n    pthread_create(&amp;t1,NULL,function,(void *)&amp;s2);\n    pthread_join(t1,NULL);\n    close(s2);\n    close(s1);\n    return 0;\n\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1469051083, "post_id": 38488594, "comment_id": 64384284, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/4824342/returning-a-local-variable-from-function-in-c\">returning a local variable from function in C</a>"}], "answers": [{"comments": [{"owner": {"reputation": 15946, "user_id": 4606734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/858769040849894/picture?type=large", "display_name": "ameyCU", "link": "https://stackoverflow.com/users/4606734/ameycu"}, "edited": false, "score": 0, "creation_date": 1469041289, "post_id": 38488664, "comment_id": 64379214, "body": "Just a suggestion , instead of  <i>&quot;it leaves the function it was created in&quot;</i> , it would be suited to say that it is freed from stack as function it is declared in is terminated ."}], "tags": [], "owner": {"reputation": 203, "user_id": 6524939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66c08308e85fe4e732ca7278a75ada7?s=128&d=identicon&r=PG&f=1", "display_name": "Robert", "link": "https://stackoverflow.com/users/6524939/robert"}, "is_accepted": false, "score": 8, "last_activity_date": 1469041213, "last_edit_date": 1469041213, "creation_date": 1469040919, "answer_id": 38488664, "question_id": 38488594, "link": "https://stackoverflow.com/questions/38488594/how-does-printf-change-the-return-value-of-a-function/38488664#38488664", "title": "how does printf change the return value of a function?", "body": "<p><code>s3</code> goes out of scope (it leaves the function it was created in), so it has undefined behavior either way. You need to either create <code>s3</code> in <code>main</code> and pass it in as another parameter, or use heap allocation via <code>malloc()</code> which is managed by the OS.</p>\n"}, {"comments": [{"owner": {"reputation": 65, "user_id": 6005501, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-FRCrLrMsdic/AAAAAAAAAAI/AAAAAAAAAo0/f1cN8Mpo_WA/photo.jpg?sz=128", "display_name": "PyRookie", "link": "https://stackoverflow.com/users/6005501/pyrookie"}, "edited": false, "score": 0, "creation_date": 1469098558, "post_id": 38488813, "comment_id": 64403446, "body": "char * s4=s3;     return (s4);                           Will this also work?  Because char * is stored in data  segment right? So it should be available after exiting the function, correct?"}, {"owner": {"reputation": 1884, "user_id": 3078414, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b1180f5e68d3542488d66de14ff53964?s=128&d=identicon&r=PG&f=1", "display_name": "user3078414", "link": "https://stackoverflow.com/users/3078414/user3078414"}, "reply_to_user": {"reputation": 65, "user_id": 6005501, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-FRCrLrMsdic/AAAAAAAAAAI/AAAAAAAAAo0/f1cN8Mpo_WA/photo.jpg?sz=128", "display_name": "PyRookie", "link": "https://stackoverflow.com/users/6005501/pyrookie"}, "edited": false, "score": 0, "creation_date": 1469106926, "post_id": 38488813, "comment_id": 64408989, "body": "You only give the returned <i>pointer</i> a local name, @PyRookie, so nothing else should change for the compiler: memory that it points to stays the same. If you are more curious, try to compile into assembly language and compare the resulting codes line by line. (-:"}], "tags": [], "owner": {"reputation": 1884, "user_id": 3078414, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b1180f5e68d3542488d66de14ff53964?s=128&d=identicon&r=PG&f=1", "display_name": "user3078414", "link": "https://stackoverflow.com/users/3078414/user3078414"}, "is_accepted": false, "score": 1, "last_activity_date": 1469043001, "last_edit_date": 1495535328, "creation_date": 1469041377, "answer_id": 38488813, "question_id": 38488594, "link": "https://stackoverflow.com/questions/38488594/how-does-printf-change-the-return-value-of-a-function/38488813#38488813", "title": "how does printf change the return value of a function?", "body": "<p>Your code returns the pointer to the local variable <code>s3</code>. Declared as such, it goes out of scope (gets released from stack memory) on <code>return</code>; when programmer neglects it, it's a common \"generator\" of program's undefined behavior. Two solutions are possible:</p>\n\n<ol>\n<li>Dynamically allocating (and subsequently freeing) the variable, as suggested in the other answer.</li>\n<li>Modifying the storage duration of the variable, by declaring it <code>static char s3[100]</code></li>\n</ol>\n\n<p>Please, also see this <a href=\"https://stackoverflow.com/questions/4824342/returning-a-local-variable-from-function-in-c\">related SO post</a>.</p>\n"}], "owner": {"reputation": 65, "user_id": 6005501, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-FRCrLrMsdic/AAAAAAAAAAI/AAAAAAAAAo0/f1cN8Mpo_WA/photo.jpg?sz=128", "display_name": "PyRookie", "link": "https://stackoverflow.com/users/6005501/pyrookie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 191, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1469043996, "creation_date": 1469040706, "last_edit_date": 1469043996, "question_id": 38488594, "link": "https://stackoverflow.com/questions/38488594/how-does-printf-change-the-return-value-of-a-function", "title": "how does printf change the return value of a function?", "body": "<p>With the printf statement <code>printf(\"new s3 string (in locate function) is \\\"%s\\\" \\n\",s3)</code>, code works properly</p>\n\n<p>but when <code>printf(\"new s3 string (in locate function) is \\\"%s\\\" \\n\",s3)</code> is commented, the code returns <code>null</code></p>\n\n<p>how is <code>printf</code> affecting the <code>return</code> value?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nchar * locate(char * s1,char * s2,int index) \n{\n    printf(\"s1 string is \\\"%s\\\" \\n\",s1);\n    printf(\"s2 string is \\\"%s\\\" \\n\",s2);\n\n    int i=0,j=0, k;\n    char s3[100];    \n\n    while(i&lt;=index)\n    {\n        s3[i]=s1[i];\n        i++;\n    }\n    k=i;\n\n    while(s2[j]!='\\0')\n    {\n        s3[i]=s2[j];\n        i++; j++;\n    }\n\n    while(s1[k]!='\\0')\n    {\n        s3[i]=s1[k];\n        i++;k++;\n    }\n\n    s3[i]='\\0';\n\n    //printf(\"new s3 string (in locate function) is \\\"%s\\\" \\n\",s3);\n\n    return ((char *)s3);\n}\n\n\nint main(void) \n{\n    char * s1=\"my name shwetha\";\n    char * s2=\"is \";\n    s1=locate(s1,s2,7);\n\n    printf(\"Final Inserted string S1 is \\\"%s\\\" \\n\",s1);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "multithreading", "contiguous"], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 6398644, "user_type": "registered", "profile_image": "https://graph.facebook.com/1177868565559595/picture?type=large", "display_name": "Omar Hijazi", "link": "https://stackoverflow.com/users/6398644/omar-hijazi"}, "edited": false, "score": 0, "creation_date": 1469041064, "post_id": 38488576, "comment_id": 64379094, "body": "Thank you. Could you elaborate a little on the last comment:   &quot;Create an array and store each thread&#39;s ID in the array. Then you can use the array to access them in order.&quot;   Thanks again."}, {"owner": {"reputation": 65, "user_id": 6398644, "user_type": "registered", "profile_image": "https://graph.facebook.com/1177868565559595/picture?type=large", "display_name": "Omar Hijazi", "link": "https://stackoverflow.com/users/6398644/omar-hijazi"}, "edited": false, "score": 0, "creation_date": 1469041472, "post_id": 38488576, "comment_id": 64379317, "body": "I want to actually output the thread number. So if thread 55 is running. I want to print: Hello from thread: 55. Is that possible?"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 65, "user_id": 6398644, "user_type": "registered", "profile_image": "https://graph.facebook.com/1177868565559595/picture?type=large", "display_name": "Omar Hijazi", "link": "https://stackoverflow.com/users/6398644/omar-hijazi"}, "edited": false, "score": 0, "creation_date": 1469041728, "post_id": 38488576, "comment_id": 64379477, "body": "@OmarHijazi If you want a thread to print its own ID, you can just call <code>pthread_self</code> to get it."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 3, "last_activity_date": 1469041218, "last_edit_date": 1469041218, "creation_date": 1469040633, "answer_id": 38488576, "question_id": 38488533, "link": "https://stackoverflow.com/questions/38488533/how-to-create-threads-in-c-with-contiguous-ids/38488576#38488576", "title": "How to create threads in c with contiguous ids?", "body": "<p>Thread IDs are created by the OS or threading library.  You can't control what they will be.</p>\n\n<p>You don't need the IDs to be consecutive.  Create an array and store each thread's ID in the array.  Then you can use the array to access them in order.</p>\n\n<p>Something like this (assuming you use pthreads):</p>\n\n<pre><code>pthread_t thread_list[100];\nint thread_count = 0;\n\n...\n\npthread_create(&amp;thread_list[thread_count++], NULL, thread_function, NULL);\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 6398644, "user_type": "registered", "profile_image": "https://graph.facebook.com/1177868565559595/picture?type=large", "display_name": "Omar Hijazi", "link": "https://stackoverflow.com/users/6398644/omar-hijazi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "accepted_answer_id": 38488576, "answer_count": 1, "score": 0, "last_activity_date": 1469041218, "creation_date": 1469040504, "question_id": 38488533, "link": "https://stackoverflow.com/questions/38488533/how-to-create-threads-in-c-with-contiguous-ids", "title": "How to create threads in c with contiguous ids?", "body": "<p>I am trying to create threads in C that have contiguous id numbers.\nFor example let us say I want to create 10 threads, then I want to give them the id's 1 through 10. Later on, I want to be able to access these id's and print them out from the thread function. Is this feasible?</p>\n\n<p>I know this may seem simple but I haven't managed to find a solution to this anywhere.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 1884, "user_id": 3078414, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b1180f5e68d3542488d66de14ff53964?s=128&d=identicon&r=PG&f=1", "display_name": "user3078414", "link": "https://stackoverflow.com/users/3078414/user3078414"}, "edited": false, "score": 0, "creation_date": 1469040270, "post_id": 38488427, "comment_id": 64378639, "body": "Please, format your code. It is difficult to read. Thanks."}, {"owner": {"reputation": 977, "user_id": 6523710, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1400d77879f884a878f290e36d3f7ff?s=128&d=identicon&r=PG&f=1", "display_name": "Javant", "link": "https://stackoverflow.com/users/6523710/javant"}, "edited": false, "score": 0, "creation_date": 1469040687, "post_id": 38488427, "comment_id": 64378884, "body": "A user3068424 said. Add some comments and some proper var names."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1469040820, "post_id": 38488427, "comment_id": 64378956, "body": "Program works perfectly here, one line per row. Input prompts would go a long way to remind the user what input to give. I had to guess, from looking at the program. Please also check the validity of the inputs before using them to index arrays."}, {"owner": {"reputation": 15946, "user_id": 4606734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/858769040849894/picture?type=large", "display_name": "ameyCU", "link": "https://stackoverflow.com/users/4606734/ameycu"}, "edited": false, "score": 0, "creation_date": 1469040834, "post_id": 38488427, "comment_id": 64378963, "body": "I really don&#39;t see any problem in format of output -<a href=\"https://ideone.com/jTsPS2\" rel=\"nofollow noreferrer\">ideone.com/jTsPS2</a>"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1469040932, "post_id": 38488427, "comment_id": 64379031, "body": "I do not understand the question. It is contradictory. You want each row on a separate line, but you are puzzled why each row is on a new line. Show what you input, and the exact output. (By editing the question)."}, {"owner": {"reputation": 1, "user_id": 6615206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e9244cd2a954c37d9325a525b633f76?s=128&d=identicon&r=PG&f=1", "display_name": "salil shet", "link": "https://stackoverflow.com/users/6615206/salil-shet"}, "edited": false, "score": 0, "creation_date": 1469125435, "post_id": 38488427, "comment_id": 64420780, "body": "Please check out the output link below the program where i have added the screen shot of my output and the expected output.Check the gap between rows.In my output the gap is more as if it is taking one extra line.I am solving program on one website.The matrix addition output is correct.but because of the more gap between the rows.The my output is not matching with expected output \u2013"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6615206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e9244cd2a954c37d9325a525b633f76?s=128&d=identicon&r=PG&f=1", "display_name": "salil shet", "link": "https://stackoverflow.com/users/6615206/salil-shet"}, "edited": false, "score": 0, "creation_date": 1469125022, "post_id": 38490545, "comment_id": 64420537, "body": "Please check out the output link below the program where i have added the screen shot of my output and the expected output.Check the gap between rows.In my output the gap is more as if it is taking one extra line.I am solving program on one website.The matrix addition output is correct.but because of the more gap between the rows.The my output is not matching with expected output"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 1, "user_id": 6615206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e9244cd2a954c37d9325a525b633f76?s=128&d=identicon&r=PG&f=1", "display_name": "salil shet", "link": "https://stackoverflow.com/users/6615206/salil-shet"}, "edited": false, "score": 0, "creation_date": 1469154351, "post_id": 38490545, "comment_id": 64430816, "body": "In the link you show an additional <code>&#39;\\n&#39;</code>, but that isn&#39;t shown in the code you show in the question. Please add the print routine that produced the output below the link you posted, otherwise all I can do is guess. Also what OS? Linux or windoze or other?"}], "tags": [], "owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "is_accepted": false, "score": 0, "last_activity_date": 1469047642, "creation_date": 1469047642, "answer_id": 38490545, "question_id": 38488427, "link": "https://stackoverflow.com/questions/38488427/matrix-addition-program-if-i-type-one-newline-character-it-is-skipping-one-line/38490545#38490545", "title": "matrix addition program. If i type one newline character it is skipping one line .and gets on the third line", "body": "<p>You have a significant number of instances where undefined behavior can occur in your code. The number one place you can prevent against attempted access of an uninitialized value is to <em>initialize all your variables</em>, especially your two-dimensional arrays. That will prevent inadvertent iteration over any uninitialized values within your array, e.g.</p>\n\n<pre><code>    int x,y,z,w,i,j;\n    int a[3][3] = {{0}}, b[3][3] = {{0}}, c[3][3] = {{0}};\n    x = y = z = w = 0;\n</code></pre>\n\n<p>Next, when taking user input, always, <em>always</em> validate user input. That means at minimum validating the return of <code>scanf</code> to insure the expected number of conversions have successfully taken place, e.g. for your <code>x</code>, <code>y</code> array:</p>\n\n<pre><code>    /* x &amp; y input and validation */\n    if (scanf (\" %d\", &amp;x) != 1 || x &lt; 0 || x &gt; 3) {\n        fprintf (stderr, \"error: invalid input for x '%d'.\\n\", x);\n        return 1;\n    }\n    if (scanf (\" %d\", &amp;y) != 1 || y &lt; 0 || y &gt; 3) {\n        fprintf (stderr, \"error: invalid input for y '%d'.\\n\", y);\n        return 1;\n    }\n\n    for (i = 0; i &lt; x; i++)     /* fill a -- validate input */\n        for (j = 0; j &lt; y; j++)\n            if (scanf(\" %d\",&amp;a[i][j]) != 1) {\n                fprintf (stderr, \"error: invalid input a[%d][%d].\\n\",\n                        i, j);\n                return 1;\n            }\n</code></pre>\n\n<p>You also need to validate the dimensions of the arrays <code>a</code> and <code>b</code> match before adding all indexes between the arrays (some of which would be empty and uninitialized without initializations of the arrays), e.g.</p>\n\n<pre><code>    if (x != z || w != y)\n        fprintf (stderr, \"warning: dimension mismatch - limiting addition.\\n\");\n</code></pre>\n\n<p>Before adding the arrays, you must limit the indexes to just those with values. (it is up to you whether you display the complete array after addition). One way is simply to limit the addition to the minimum index for each dimension between array <code>a</code> and <code>b</code>, e.g. (a <em>ternary</em> operator is used below to set the minimum value)</p>\n\n<pre><code>     /* add a + b -- validating max dimensions to prevent overrun */\n    int xdim = z &gt; x ? x : z;\n    int ydim = w &gt; y ? y : w;\n    for (i = 0; i &lt; xdim; i++)\n        for (j = 0; j &lt; ydim; j++)\n            c[i][j] = a[i][j] + b[i][j];\n</code></pre>\n\n<p>Finally, opening your code with spacing may help make some of the subtle points more apparent and readable. (that is entirely up to you -- the older you get, the greater you will appreciate the additional spacing...) Putting all the pieces together, you could do something like the following:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\nint main (void) {\n\n    int x,y,z,w,i,j;\n    int a[3][3] = {{0}}, b[3][3] = {{0}}, c[3][3] = {{0}};\n    x = y = z = w = 0;\n\n    /* x &amp; y input and validation */\n    if (scanf (\" %d\", &amp;x) != 1 || x &lt; 0 || x &gt; 3) {\n        fprintf (stderr, \"error: invalid input for x '%d'.\\n\", x);\n        return 1;\n    }\n    if (scanf (\" %d\", &amp;y) != 1 || y &lt; 0 || y &gt; 3) {\n        fprintf (stderr, \"error: invalid input for y '%d'.\\n\", y);\n        return 1;\n    }\n\n    for (i = 0; i &lt; x; i++)     /* fill a -- validate input */\n        for (j = 0; j &lt; y; j++)\n            if (scanf(\" %d\",&amp;a[i][j]) != 1) {\n                fprintf (stderr, \"error: invalid input a[%d][%d].\\n\",\n                        i, j);\n                return 1;\n            }\n\n    /* z &amp; w input and validation */\n    if (scanf (\" %d\", &amp;z) != 1 || z &lt; 0 || z &gt; 3) {\n        fprintf (stderr, \"error: invalid input for z '%d'.\\n\", z);\n        return 1;\n    }\n    if (scanf (\" %d\", &amp;w) != 1 || w &lt; 0 || w &gt; 3) {\n        fprintf (stderr, \"error: invalid input for w '%d'.\\n\", w);\n        return 1;\n    }\n\n    for (i = 0; i &lt; z; i++)     /* fill b -- validate input */\n        for (j = 0; j &lt; w; j++)\n            if (scanf(\" %d\",&amp;b[i][j]) != 1) {\n                fprintf (stderr, \"error: invalid input b[%d][%d].\\n\",\n                        i, j);\n                return 1;\n            }\n\n    if (x != z || w != y)\n        fprintf (stderr, \"warning: dimension mismatch - limiting addition.\\n\");\n\n    printf (\"\\n array a[%d][%d]\\n\\n\", x, y);\n    for (i = 0; i &lt; x; i++) {\n        for (j = 0; j &lt; y; j++)\n            printf (\" %3d\", a[i][j]);\n        putchar ('\\n');\n    }\n\n    printf (\"\\n array b[%d][%d]\\n\\n\", z, w);\n    for (i = 0; i &lt; z; i++) {\n        for (j = 0; j &lt; w; j++)\n            printf (\" %3d\", b[i][j]);\n        putchar ('\\n');\n    }\n\n    /* add a + b -- validating max dimensions to prevent overrun */\n    int xdim = z &gt; x ? x : z;\n    int ydim = w &gt; y ? y : w;\n    for (i = 0; i &lt; xdim; i++)\n        for (j = 0; j &lt; ydim; j++)\n            c[i][j] = a[i][j] + b[i][j];\n\n    printf (\"\\n array c[%d][%d]\\n\\n\", xdim, ydim);\n    for (i = 0; i &lt; xdim; i++){\n        for (j = 0; j &lt; ydim; j++)\n            printf (\" %3d\", c[i][j]);\n        putchar ('\\n');\n    }\n    putchar ('\\n');\n\n    return 0;\n}\n</code></pre>\n\n<p>(<strong>note:</strong> <code>main()</code> is a function of type <code>int</code> and therefore returns a value)</p>\n\n<p><strong>Example Input File</strong></p>\n\n<pre><code>$ cat dat/arradd.txt\n3\n3\n1 2 3 4 5 6 7 8 9\n3\n3\n1 2 3 4 5 6 7 8 9\n</code></pre>\n\n<p><strong>Example Use/Output</strong></p>\n\n<pre><code>$ ./bin/arrayadd &lt;dat/arradd.txt\n\n array a[3][3]\n\n   1   2   3\n   4   5   6\n   7   8   9\n\n array b[3][3]\n\n   1   2   3\n   4   5   6\n   7   8   9\n\n array c[3][3]\n\n   2   4   6\n   8  10  12\n  14  16  18\n</code></pre>\n\n<p>Look things over and let me know if you have any additional questions.</p>\n"}], "owner": {"reputation": 1, "user_id": 6615206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e9244cd2a954c37d9325a525b633f76?s=128&d=identicon&r=PG&f=1", "display_name": "salil shet", "link": "https://stackoverflow.com/users/6615206/salil-shet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1469047642, "creation_date": 1469040150, "last_edit_date": 1469040443, "question_id": 38488427, "link": "https://stackoverflow.com/questions/38488427/matrix-addition-program-if-i-type-one-newline-character-it-is-skipping-one-line", "title": "matrix addition program. If i type one newline character it is skipping one line .and gets on the third line", "body": "<p>I am writing a matrix addition program. The expected output should each row on a single line.But after the first row  output if i use a new line character it is skipping one line and printing on the second line the second row.Its as if i have given two new line characters.   </p>\n\n<pre><code>#include&lt;stdio.h&gt;\nint main(int argc, char *argv[])\n{\n    int x,y,z,w,i,j;\n    int a[3][3],b[3][3],c[3][3];\n\n    scanf(\"%d\",&amp;x);\n    scanf(\"%d\",&amp;y);\n\n    //getchar();\n    for(i=0;i&lt;x;i++)\n        for(j=0;j&lt;y;j++)\n            scanf(\" %d\",&amp;a[i][j]);\n    scanf(\"%d\",&amp;z);\n    //getchar();\n    scanf(\"%d\",&amp;w);\n    //getchar();\n    for(i=0;i&lt;z;i++)\n        for(j=0;j&lt;w;j++)\n            scanf(\" %d\",&amp;b[i][j]);\n\n    for(i=0;i&lt;z;i++)\n        for(j=0;j&lt;w;j++)\n            c[i][j]=a[i][j]+b[i][j];\n\n    for(i=0;i&lt;x;i++){\n        for(j=0;j&lt;y;j++)\n            printf(\"%d \",c[i][j]);\n        printf(\"\\n\");\n    }\n}\n</code></pre>\n\n<p><a href=\"http://i.stack.imgur.com/pArvs.png\" rel=\"nofollow\">output</a></p>\n"}, {"tags": ["c++", "c", "arrays", "algorithm"], "comments": [{"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1469040091, "post_id": 38488317, "comment_id": 64378542, "body": "The simplest answer is to sort the array (in descending order) with <code>qsort</code>, and then take the first X items. Alternatively, you need to insert new items at the correct location in your <code>retArray</code> so that the array is always sorted."}, {"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1469040236, "post_id": 38488317, "comment_id": 64378619, "body": "You are overwriting 77 with 88, even though 67 is smaller.  You need to replace the smallest value in retArray, not the first one you find."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 2, "creation_date": 1469040475, "post_id": 38488317, "comment_id": 64378759, "body": "<code>calloc(sizeof(int) * maxGrades)</code> --&gt; <code>calloc( maxGrades, sizeof(int))</code>"}, {"owner": {"reputation": 1014, "user_id": 6047952, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a56a0a74a9848b8796170a9bce83e9fa?s=128&d=identicon&r=PG", "display_name": "infixed", "link": "https://stackoverflow.com/users/6047952/infixed"}, "edited": false, "score": 0, "creation_date": 1469040505, "post_id": 38488317, "comment_id": 64378775, "body": "Lets say it was a learning exercise and<code>qsort</code> is cheating.  Then your problem is that any new value going into <code>retArray</code> has that <code>break</code> statement preventing  tests on later indexs inside <code>retArray</code>.  Opportunities to find a new maximum could be skipped.  I suspect that replacing <code>break;</code> with <code>grades[i]=0;</code> would work, but I am too lazy to check.  But it would be pretty brute force then."}], "answers": [{"tags": [], "owner": {"reputation": 203, "user_id": 6524939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66c08308e85fe4e732ca7278a75ada7?s=128&d=identicon&r=PG&f=1", "display_name": "Robert", "link": "https://stackoverflow.com/users/6524939/robert"}, "is_accepted": false, "score": 0, "last_activity_date": 1469040652, "last_edit_date": 1469040652, "creation_date": 1469040230, "answer_id": 38488452, "question_id": 38488317, "link": "https://stackoverflow.com/questions/38488317/maximum-x-values-at-array/38488452#38488452", "title": "Maximum X values at array", "body": "<p>At the start of your last loop iteration your retArray looks like this: <code>{90,77,67}</code>. If you step through the inner loop with an <code>i=5</code>, you'll find the 77 is found before the 67, so the 77 is the one replaced. You should probably sort the array and take the top maxGrades values, but if you want to do it your way:</p>\n\n<pre><code>for(...)\n    if(grades[i] &gt; retArray[j])\n        if(retArray[j] &lt; retArray[minVal])\n            minVal = j;\nif(minVal &gt; 0)\n    retArray[minVal] = grades[i];\nminVal = -1;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 2, "last_activity_date": 1469041432, "creation_date": 1469041432, "answer_id": 38488833, "question_id": 38488317, "link": "https://stackoverflow.com/questions/38488317/maximum-x-values-at-array/38488833#38488833", "title": "Maximum X values at array", "body": "<p>Selecting the X largest values from an array of size N can be performed in <strong>O(N)</strong> average complexity using the QuickSelect algorithm from the inventor of QuickSort: <a href=\"https://en.wikipedia.org/wiki/Quickselect\" rel=\"nofollow\">https://en.wikipedia.org/wiki/Quickselect</a></p>\n"}, {"tags": [], "owner": {"reputation": 165886, "user_id": 572670, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/5011cf6d98e276b1bdc2cb321546e528?s=128&d=identicon&r=PG", "display_name": "amit", "link": "https://stackoverflow.com/users/572670/amit"}, "is_accepted": false, "score": 4, "last_activity_date": 1469047366, "last_edit_date": 1469047366, "creation_date": 1469047008, "answer_id": 38490399, "question_id": 38488317, "link": "https://stackoverflow.com/questions/38488317/maximum-x-values-at-array/38490399#38490399", "title": "Maximum X values at array", "body": "<p>While it can be done in linear time using selection algorithm, it is usually done using a min-heap that stores the top k elements, at each iteration - you check if the smallest element in the heap is greater or not from the current one you are iterating, and if it is - you replace them.</p>\n\n<p>This is <code>O(nlogk)</code> time and only <code>O(k)</code> extra memory, and requires only a single traversal on the data (so it'll work perfectly if your elements are coming in a stream).</p>\n\n<p>The following code is C++11 (with its elegant for-each loops), but it's easy to transform it to old c++ code, using the same data structures.</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;vector&gt;\n#include &lt;queue&gt;\n\nint main(void) {\n    int array[] = { 90,45,77,43,67,88 }; \n    int maxGrades = 3;\n    std::priority_queue&lt;int, std::vector&lt;int&gt;, std::greater&lt;int&gt;&gt; q;\n    for (int x : array) { \n        // populate first maxGrades elements\n        if (q.size() &lt; maxGrades) {\n            q.push(x);\n        // replace if new element is higher than smallest in heap.\n        } else if (q.top() &lt; x) {\n            q.pop();\n            q.push(x);\n        }\n    }\n    // print elements\n    std::cout &lt;&lt; \"elements: \";\n    while (!q.empty()) { \n        std::cout &lt;&lt; q.top() &lt;&lt; \" \";\n        q.pop();\n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 778, "user_id": 1836540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4466fdeadf066a319e6afba5df630960?s=128&d=identicon&r=PG", "display_name": "Vyacheslav Napadovsky", "link": "https://stackoverflow.com/users/1836540/vyacheslav-napadovsky"}, "is_accepted": true, "score": 0, "last_activity_date": 1469079149, "last_edit_date": 1469079149, "creation_date": 1469078591, "answer_id": 38495464, "question_id": 38488317, "link": "https://stackoverflow.com/questions/38488317/maximum-x-values-at-array/38495464#38495464", "title": "Maximum X values at array", "body": "<p>If your <code>grades</code> array may contain duplicates the solution becomes more difficult. And don't forget that if you return back pointer to <code>grades</code> array the caller may not know should or should not it free the returned pointer.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint* GetMaxGrades(int* grades, int size, int maxGrades) {\n    if (maxGrades &lt;= 0 || size &lt;= 0)\n        return NULL;\n\n    // first, function must allocate memory every time,\n    // otherwise you can't understand when to free memory or when do not it.\n    int *retArray = (int*)malloc(sizeof(int) * maxGrades);\n\n    if (maxGrades &gt;= size) {\n        for (int i = 0; i &lt; size; ++i)\n            retArray[i] = grades[i];\n        for (int i = size; i &lt; maxGrades; ++i)\n            retArray[i] = 0;\n    }\n    else {\n        // need to save positions of found max grades,\n        // because if there's duplicates among grades,\n        // you will pick up only different onces.\n        int *positions = (int*)malloc(sizeof(int) * maxGrades);\n        for (int i = 0; i &lt; maxGrades; ++i) {\n            int position = 0;\n            int maxgrade = INT_MIN;\n            for (int j = 0; j &lt; size; ++j) {\n                // pick max grade\n                if (grades[j] &gt; maxgrade) {\n                    // do not permit duplicates among positions\n                    bool newmax = true;\n                    for (int k = 0; k &lt; i; ++k) {\n                        if (positions[k] == j) {\n                            newmax = false;\n                            break;\n                        }\n                    }\n                    // assign new max value &amp; position\n                    if (newmax) {\n                        position = j;\n                        maxgrade = grades[j];\n                    }\n                }\n            }\n            positions[i] = position;\n            retArray[i] = maxgrade;\n        }\n        free(positions);\n    }\n    return retArray;\n}\n\nint main(int argc, char* argv[]) {\n    int a[] = { 90,45,77,43,67,88 };\n    const int max_grades = 3;\n    int *p = GetMaxGrades(a, sizeof(a) / sizeof(a[0]), 3);\n    for (int i = 0; i &lt; max_grades; ++i) {\n        printf(\"%d \", p[i]);\n    }\n    printf(\"\\n\");\n    free(p);\n    return 0;\n}\n</code></pre>\n\n<p>If you are allowed to use <code>qsort</code> that will become more easy:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint greater_comp(const void * a, const void * b) {\n    return *(int*)b - *(int*)a;\n}\n\nint* GetMaxGrades(int* grades, int size, int maxGrades) {\n    if (maxGrades &lt;= 0 || size &lt;= 0)\n        return NULL;\n\n    int alloc_size = (maxGrades &lt; size) ? size : maxGrades;\n\n    // copy grades array (allocate more memory)\n    int *retArray = (int*)malloc(sizeof(int) * alloc_size);\n    for (int i = 0; i &lt; size; ++i)\n        retArray[i] = grades[i];\n    for (int i = size; i &lt; alloc_size; ++i)\n        retArray[i] = 0;\n\n    // sort: descending order\n    qsort(retArray, size, sizeof(int), greater_comp);\n\n    return retArray;\n}\n\nint main(int argc, char* argv[]) {\n    int a[] = { 90,45,77,43,67,88 };\n    const int max_grades = 3;\n    int *p = GetMaxGrades(a, sizeof(a) / sizeof(a[0]), 3);\n    for (int i = 0; i &lt; max_grades; ++i) {\n        printf(\"%d \", p[i]);\n    }\n    printf(\"\\n\");\n    free(p);\n    return 0;\n}\n</code></pre>\n\n<p>And if you would use algorithm library that will become much more easy:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;algorithm&gt;\n#include &lt;functional&gt;\n#include &lt;vector&gt;\n\nusing namespace std;\n\nvector&lt;int&gt; GetMaxGrades(vector&lt;int&gt; grades, int maxGrades) {\n    // descending order\n    sort(grades.begin(), grades.end(), greater&lt;int&gt;());\n    grades.resize(maxGrades);\n    return grades;\n}\n\nint main(int argc, char* argv[]) {\n    vector&lt;int&gt; a = { 90,45,77,43,67,88 };\n    vector&lt;int&gt; p = GetMaxGrades(a, 3);\n    for (auto&amp; i : p)\n        cout &lt;&lt; i &lt;&lt; ' ';\n    cout &lt;&lt; endl;\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 451, "user_id": 6502945, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/b2caa3c177f7dc69e350cd9bc98c07cb?s=128&d=identicon&r=PG&f=1", "display_name": "CSharpBeginner", "link": "https://stackoverflow.com/users/6502945/csharpbeginner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 137, "favorite_count": 0, "accepted_answer_id": 38495464, "answer_count": 4, "score": 2, "last_activity_date": 1469079149, "creation_date": 1469039738, "last_edit_date": 1469046081, "question_id": 38488317, "link": "https://stackoverflow.com/questions/38488317/maximum-x-values-at-array", "title": "Maximum X values at array", "body": "<p>I'm trying to write a function that takes array, size and number of X maximum grades at the array.<br>\ne.g:  </p>\n\n<pre><code>array = { 90,45,77,43,67,88 }, maxGrades = 3\n</code></pre>\n\n<p>The result should be:</p>\n\n<pre><code>retArray = {90,77,88} or {90,88,77}\n</code></pre>\n\n<p>What I have been tried:</p>\n\n<pre><code>int * GetMaxGrades(int * grades, int size, int maxGrades)\n{\n     int *retArray;\n\n     if (maxGrades &gt; size)\n        return grades;\n\n     retArray = (int*)calloc(sizeof(int) * maxGrades);\n\n     for (int i = 0; i &lt; size; i++)\n     {\n         for (int j = 0; j &lt; maxGrades; j++)\n            if (grades[i] &gt; retArray[j])\n            {\n                 retArray[j] = grades[i];\n                 break;\n            }\n     }\n\n     return retArray;\n}\n</code></pre>\n\n<p>But I'm revived <code>{90,88,67}</code></p>\n\n<p><strong>EDIT</strong>\nIf I change the inner loop like that:</p>\n\n<pre><code>        if (grades[i] &gt; retArray[j])\n        {\n            if (j + 1 &lt; maxGrades)\n                retArray[j + 1] = retArray[j];\n\n            retArray[j] = grades[i];\n            break;\n        }\n</code></pre>\n\n<p>It solved part of the problem, but is it the best way to do that?</p>\n"}, {"tags": ["c", "for-loop", "random"], "comments": [{"owner": {"reputation": 3574, "user_id": 5793987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a057299226b268d59f2faa0b3f1d1112?s=128&d=identicon&r=PG", "display_name": "gudok", "link": "https://stackoverflow.com/users/5793987/gudok"}, "edited": false, "score": 1, "creation_date": 1469040238, "post_id": 38488290, "comment_id": 64378622, "body": "<code>newLevel &lt;= MAXLEVEL</code>"}, {"owner": {"reputation": 5295, "user_id": 2089899, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/JJVOk.jpg?s=128&g=1", "display_name": "Austin", "link": "https://stackoverflow.com/users/2089899/austin"}, "reply_to_user": {"reputation": 3574, "user_id": 5793987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a057299226b268d59f2faa0b3f1d1112?s=128&d=identicon&r=PG", "display_name": "gudok", "link": "https://stackoverflow.com/users/5793987/gudok"}, "edited": false, "score": 0, "creation_date": 1469040361, "post_id": 38488290, "comment_id": 64378690, "body": "Hmmm, my book actually has <code>&lt;</code> too, I guess this is a typo? edit: If I change it to <code>&lt;=</code> I get <code>ABORT TRAP (6)</code>, but values that look correct."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1469040898, "post_id": 38488290, "comment_id": 64379006, "body": "You get the abort trap because you&#39;re writing off the end of the array. Change <code>int a[6]</code> to <code>int a[7]</code> if you want to use <code>newlevel &lt;= MAXLEVEL</code>"}, {"owner": {"reputation": 3574, "user_id": 5793987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a057299226b268d59f2faa0b3f1d1112?s=128&d=identicon&r=PG", "display_name": "gudok", "link": "https://stackoverflow.com/users/5793987/gudok"}, "edited": false, "score": 0, "creation_date": 1469040899, "post_id": 38488290, "comment_id": 64379008, "body": "My bad, I didn&#39;t notice semicolon in for loop."}, {"owner": {"reputation": 5295, "user_id": 2089899, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/JJVOk.jpg?s=128&g=1", "display_name": "Austin", "link": "https://stackoverflow.com/users/2089899/austin"}, "edited": false, "score": 0, "creation_date": 1469041061, "post_id": 38488290, "comment_id": 64379091, "body": "I only want there to be [0:5] levels though. I could sort of fake it by using <code>&lt;=</code> then doing <code>if (newLevel &lt; MAXLEVEL) a[newLevel]++;</code>, but then I don&#39;t even understand why I need to do this or why it wasn&#39;t working originally."}], "answers": [{"comments": [{"owner": {"reputation": 5295, "user_id": 2089899, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/JJVOk.jpg?s=128&g=1", "display_name": "Austin", "link": "https://stackoverflow.com/users/2089899/austin"}, "edited": false, "score": 0, "creation_date": 1469042282, "post_id": 38488836, "comment_id": 64379806, "body": "To be honest I&#39;m having trouble following this. I don&#39;t understand the point you are making about sum of further levels, or why the <code>i</code>th level is different than the <code>i-1</code>th level. Also, does this mean that a skip-list which is using this code for level determination is actually doing it wrong?"}, {"owner": {"reputation": 3574, "user_id": 5793987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a057299226b268d59f2faa0b3f1d1112?s=128&d=identicon&r=PG", "display_name": "gudok", "link": "https://stackoverflow.com/users/5793987/gudok"}, "reply_to_user": {"reputation": 5295, "user_id": 2089899, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/JJVOk.jpg?s=128&g=1", "display_name": "Austin", "link": "https://stackoverflow.com/users/2089899/austin"}, "edited": false, "score": 0, "creation_date": 1469043353, "post_id": 38488836, "comment_id": 64380384, "body": "My point is that it is expected for above algorithm to produce similar values at last two levels. Whether it is correct or not -- I can&#39;t answer without reading book you have. But my guess is that this skip-list is supposed to have only 5 true levels, 0 to 4. Level number 5 is artificial."}], "tags": [], "owner": {"reputation": 3574, "user_id": 5793987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a057299226b268d59f2faa0b3f1d1112?s=128&d=identicon&r=PG", "display_name": "gudok", "link": "https://stackoverflow.com/users/5793987/gudok"}, "is_accepted": true, "score": 2, "last_activity_date": 1469041441, "creation_date": 1469041441, "answer_id": 38488836, "question_id": 38488290, "link": "https://stackoverflow.com/questions/38488290/logic-confusion-with-rand-in-a-for-loop/38488836#38488836", "title": "logic confusion with rand() in a for loop", "body": "<p>Suppose that we made it to level <code>i</code>. Chances that we promote to next level are ~0.5. This means that if we made it to <code>i</code>-th level <code>N</code> times, then ~0.5*N times we stop at level <code>i</code> and ~0.5*N times we promote to next level. Equivalently, we stop at level <code>i</code> ~0.5*N times and <em>sum</em> of all further level values is also ~0.5*N. Hence, last two levels have similar values no matter how many there are total levels.</p>\n\n<p>Sequence of X, X/2, X/4, X/8, X/16, X/16 is expected. If you want last member to be X/32, simply add artificial level.</p>\n"}], "owner": {"reputation": 5295, "user_id": 2089899, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/JJVOk.jpg?s=128&g=1", "display_name": "Austin", "link": "https://stackoverflow.com/users/2089899/austin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 38488836, "answer_count": 1, "score": 2, "last_activity_date": 1469041441, "creation_date": 1469039646, "question_id": 38488290, "link": "https://stackoverflow.com/questions/38488290/logic-confusion-with-rand-in-a-for-loop", "title": "logic confusion with rand() in a for loop", "body": "<p>I'm trying to do skip-list insertion, so I'm using rand() to determine the level. I know I need to do continuous coin flips, so I figure if I print test counts for the generator it should have approximately 50% less for each successive level. I'm messing up with the logic somehow, but I can't catch my mistake. On the last level it is ~== to the level before it, instead of half. </p>\n\n<p>Here's my code: </p>\n\n<pre><code>#define MAXLEVEL 5\nsrand(time(NULL));\nint newLevel;\nint a[6] = {0};\nfor (int i = 0; i &lt; 100000; i++) {      \n    for (newLevel = 0; (rand() &lt; RAND_MAX/2) &amp;&amp; (newLevel &lt; MAXLEVEL); newLevel++);\n    a[newLevel]++;\n}\nprintf(\"0: %d   1: %d   2: %d   3: %d   4: %d   5: %d\\n\", a[0], a[1], a[2], a[3], a[4], a[5]);\n</code></pre>\n\n<p>And here's the output:</p>\n\n<pre><code>0: 50018   1: 24969   2: 12532   3: 6334   4: 3094   5: 3053\n</code></pre>\n\n<p>I'm sort of expecting my mistake to be something silly, but I've been looking at this for a while now and can't seem to catch it. </p>\n"}, {"tags": ["python", "c++", "c", "boost-python"], "answers": [{"comments": [{"owner": {"reputation": 1257, "user_id": 649140, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/ff4ce275d6b5e7986cc235e90c90a07b?s=128&d=identicon&r=PG", "display_name": "Sam Kellett", "link": "https://stackoverflow.com/users/649140/sam-kellett"}, "edited": false, "score": 0, "creation_date": 1469054124, "post_id": 38489304, "comment_id": 64385336, "body": "i&#39;ve accepted the other answer as i&#39;ve tested it and it works (although i tagged boost-python in my question i didn&#39;t actually state it so i&#39;ll edit my question now). thanks for answering though, i&#39;m sure this will help anybody who finds this page that doesn&#39;t want the boost dependency."}], "tags": [], "owner": {"reputation": 2928, "user_id": 1603365, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/K4qJN.png?s=128&g=1", "display_name": "md5i", "link": "https://stackoverflow.com/users/1603365/md5i"}, "is_accepted": false, "score": 3, "last_activity_date": 1469043100, "creation_date": 1469043100, "answer_id": 38489304, "question_id": 38488205, "link": "https://stackoverflow.com/questions/38488205/how-do-i-create-a-python-decimal-object-from-c/38489304#38489304", "title": "How do I create a Python Decimal object from C++?", "body": "<p>Should be straightforward enough.  Although untested, something like the following should work:</p>\n\n<pre><code>PyObject * decimal_mod = PyImport_ImportModule(\"decimal\");\nassert(decimal_mod);\nPyObject * decimal_ctor = PyObject_GetAttrString(decimal_mod, \"Decimal\");\nassert(decimal_ctor);\nPyObject * four = PyObject_CallFunction(decimal_ctor, \"i\", 4);\nassert(four);\n</code></pre>\n\n<p>Do keep in mind that all three <code>PyObject *</code> references here should be decreffed (using <code>Py_DECREF()</code>) once you are done with them.  Also, I use <code>assert()</code> here for pedagogical purposes.  Actual code should have real error handling.</p>\n\n<p>Also, I use the raw Python/C API here.  I've never used boost-python, so I don't know what differences exist, if any.</p>\n"}, {"tags": [], "owner": {"reputation": 26037, "user_id": 542190, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3bb1f122c476561bb9a98a1523e8b5e?s=128&d=identicon&r=PG", "display_name": "filmor", "link": "https://stackoverflow.com/users/542190/filmor"}, "is_accepted": true, "score": 2, "last_activity_date": 1469044141, "creation_date": 1469044141, "answer_id": 38489597, "question_id": 38488205, "link": "https://stackoverflow.com/questions/38488205/how-do-i-create-a-python-decimal-object-from-c/38489597#38489597", "title": "How do I create a Python Decimal object from C++?", "body": "<p>In Boost.Python that would be something like</p>\n\n<pre><code>bp::object decimal = bp::import(\"decimal\").attr(\"Decimal\");\nbp::object decimal_obj = decimal(1, 4);\n</code></pre>\n"}], "owner": {"reputation": 1257, "user_id": 649140, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/ff4ce275d6b5e7986cc235e90c90a07b?s=128&d=identicon&r=PG", "display_name": "Sam Kellett", "link": "https://stackoverflow.com/users/649140/sam-kellett"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 359, "favorite_count": 2, "accepted_answer_id": 38489597, "answer_count": 2, "score": 2, "last_activity_date": 1469054153, "creation_date": 1469039390, "last_edit_date": 1469054153, "question_id": 38488205, "link": "https://stackoverflow.com/questions/38488205/how-do-i-create-a-python-decimal-object-from-c", "title": "How do I create a Python Decimal object from C++?", "body": "<p>...or any Python object that exists in an importable library. I have found PyDateTime_* functions in the <a href=\"https://docs.python.org/3/c-api/datetime.html\" rel=\"nofollow\">documentation</a> for creating objects from the datetime module, but I can't find anything to do with the python decimal module. Is this possible?</p>\n\n<p>Looking for a Boost.Python way if there is one, but the native API's will suffice if not.</p>\n"}, {"tags": ["c", "ssl", "curl", "libcurl", "ubuntu-16.04"], "comments": [{"owner": {"reputation": 43751, "user_id": 93747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbf187b5b45c400649ed7f946e8f00d6?s=128&d=identicon&r=PG", "display_name": "Daniel Stenberg", "link": "https://stackoverflow.com/users/93747/daniel-stenberg"}, "edited": false, "score": 0, "creation_date": 1469050418, "post_id": 38488122, "comment_id": 64384005, "body": "sounds like gnutls couldn&#39;t complete the TLS handshake with the server..."}], "answers": [{"comments": [{"owner": {"reputation": 1784, "user_id": 5088165, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c54064a4903efcc8bbb27c502f04c693?s=128&d=identicon&r=PG", "display_name": "Panwen Wang", "link": "https://stackoverflow.com/users/5088165/panwen-wang"}, "edited": false, "score": 0, "creation_date": 1594431276, "post_id": 62844084, "comment_id": 111132890, "body": "By &quot;old question&quot;, did you mean  someone has asked this on SO? If so, please attach the URL."}], "tags": [], "owner": {"reputation": 1, "user_id": 11508143, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-vEuABWjZmsI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcMtI8Rbtmiv97wiqlc7n8YeZtYUw/mo/photo.jpg?sz=128", "display_name": "FootballMad", "link": "https://stackoverflow.com/users/11508143/footballmad"}, "is_accepted": false, "score": 0, "last_activity_date": 1594553208, "last_edit_date": 1594553208, "creation_date": 1594429027, "answer_id": 62844084, "question_id": 38488122, "link": "https://stackoverflow.com/questions/38488122/ftps-connection-error-gnutls-handshake-failed/62844084#62844084", "title": "FTPS connection error: gnutls_handshake failed", "body": "<p>Kinda old question, but incase it helps others...</p>\n<p>You might need to use --insecure --ftp-ssl --tlsv1 and maybe ftps:// but sometimes ftp://</p>\n<p>Hope it helps!</p>\n<p>EDIT:\nURL attached\n<a href=\"https://stackoverflow.com/questions/38488122/ftps-connection-error-gnutls-handshake-failed\">FTPS connection error: gnutls_handshake failed</a></p>\n"}], "owner": {"reputation": 51, "user_id": 5016959, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/54b205cc89788bd5272db6782dac0661?s=128&d=identicon&r=PG&f=1", "display_name": "JavaProgrammer", "link": "https://stackoverflow.com/users/5016959/javaprogrammer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 547, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1594553208, "creation_date": 1469039126, "last_edit_date": 1469041524, "question_id": 38488122, "link": "https://stackoverflow.com/questions/38488122/ftps-connection-error-gnutls-handshake-failed", "title": "FTPS connection error: gnutls_handshake failed", "body": "<p>I researched about this question and could not find any pointers to this error. I am essentially trying to connect to server using libcurl program. </p>\n\n<p><a href=\"https://curl.haxx.se/libcurl/c/ftpsget.html\" rel=\"nofollow\">https://curl.haxx.se/libcurl/c/ftpsget.html</a></p>\n\n<p>The program compiles fine but gives a run time error as follows: </p>\n\n<pre><code>Trying (Some IP)...\n\n* Connected to (Some server name) (same ip as above) port 21 (#0)\n* found 173 certificates in /etc/ssl/certs/ca-certificates.crt\n* found 697 certificates in /etc/ssl/certs\n* ALPN, offering http/1.1\n* gnutls_handshake() failed: An unexpected TLS packet was received.\n* Closing connection 0\ncurl told us 35\n</code></pre>\n\n<p>I am having access to this server through a username&amp; password. </p>\n"}, {"tags": ["c++", "c", "c++11"], "comments": [{"owner": {"reputation": 8847, "user_id": 3484570, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/r5BRZ.png?s=128&g=1", "display_name": "nwp", "link": "https://stackoverflow.com/users/3484570/nwp"}, "edited": false, "score": 0, "creation_date": 1469038154, "post_id": 38487762, "comment_id": 64377433, "body": "You can write the &quot;GL&quot; functions yourself and call the &quot;gl&quot; functions from inside. That way you can use your favorite names without loss of functionality or performance."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 2, "creation_date": 1469038177, "post_id": 38487762, "comment_id": 64377445, "body": "Well you could write wrapper functions named how you want it and then just call the <code>gl</code> function in the body."}, {"owner": {"reputation": 8326, "user_id": 53089, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/525dac0c4812e8e8753935590b40ddb6?s=128&d=identicon&r=PG", "display_name": "Rob K", "link": "https://stackoverflow.com/users/53089/rob-k"}, "edited": false, "score": 3, "creation_date": 1469038687, "post_id": 38487762, "comment_id": 64377751, "body": "This is a horrible idea. Things have standardized names for a reason. You&#39;re talking about doing a huge amount of pointless extra work,  maybe breaking compatibility, and causing confusion in communicating with other programmers. Lots of things in life are hard."}, {"owner": {"reputation": 123967, "user_id": 251153, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4b25144c09555e7d5b5e288469e011ef?s=128&d=identicon&r=PG", "display_name": "zneak", "link": "https://stackoverflow.com/users/251153/zneak"}, "edited": false, "score": 0, "creation_date": 1469038841, "post_id": 38487762, "comment_id": 64377848, "body": "Wow, people voting to close as &quot;too broad&quot;? Just because there are multiple solutions doesn&#39;t mean that you have to expand 10 pages to cover them all."}], "answers": [{"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 2, "last_activity_date": 1469038948, "last_edit_date": 1469038948, "creation_date": 1469038243, "answer_id": 38487859, "question_id": 38487762, "link": "https://stackoverflow.com/questions/38487762/is-possible-to-linking-a-function-with-a-different-name/38487859#38487859", "title": "Is possible to linking a function with a different name", "body": "<p>You could create function pointers with whatever name you want and assign the existing functions to them:</p>\n\n<pre><code>char *(*my_strcpy)(char *, const char *) = strcpy;\n</code></pre>\n\n<p>You could also use the preprocessor as follows if your compiler supports <code>__VA_ARGS__</code>:</p>\n\n<pre><code>#define my_function(...) gl_function(__VA_ARGS__)\n</code></pre>\n\n<p>The latter is probably easier to use since you don't have to know the return type or the number and type of the arguments.</p>\n\n<p>While you could define the above macro as a non-function type, defining it as a function-type macro will help prevent it from being replaced in places you wouldn't want it.</p>\n"}, {"tags": [], "owner": {"reputation": 123967, "user_id": 251153, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4b25144c09555e7d5b5e288469e011ef?s=128&d=identicon&r=PG", "display_name": "zneak", "link": "https://stackoverflow.com/users/251153/zneak"}, "is_accepted": false, "score": 7, "last_activity_date": 1469039227, "last_edit_date": 1469039227, "creation_date": 1469038432, "answer_id": 38487915, "question_id": 38487762, "link": "https://stackoverflow.com/questions/38487762/is-possible-to-linking-a-function-with-a-different-name/38487915#38487915", "title": "Is possible to linking a function with a different name", "body": "<p>Given that this is C++11, you can easily create an alias to any function that you like with the auto keyword:</p>\n\n<pre><code>const auto Finish = glFinish;\nint main()\n{\n    Finish();\n}\n</code></pre>\n\n<p>Using <code>const</code> informs the compiler that nothing else will modify the function pointer/alias that you've set up and that may enable better code generation.</p>\n\n<p>There isn't a built-in, automated way to \"rename\" functions, however. Other than manually maintaining a list, one way to get a similar result would be to find a page that has every OpenGL call and do a regex search-and replace for the pattern <code>(gl(.+))</code> to <code>const auto \\2 = \\1;</code>, or something like that.</p>\n"}, {"tags": [], "owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "is_accepted": false, "score": 2, "last_activity_date": 1469038822, "creation_date": 1469038822, "answer_id": 38488028, "question_id": 38487762, "link": "https://stackoverflow.com/questions/38487762/is-possible-to-linking-a-function-with-a-different-name/38488028#38488028", "title": "Is possible to linking a function with a different name", "body": "<p>You can use <code>#define</code> to rename all the functions (although I would recommend <strong>not</strong> doing this if you ever intend to share your code with anyone else). For example</p>\n\n<pre><code>#define GLClear      glClear\n#define GLDrawArrays glDrawArrays\n#define GLFinish     glFinish\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 429, "user_id": 6615096, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/1AHQb.png?s=128&g=1", "display_name": "Ibrahim Ipek", "link": "https://stackoverflow.com/users/6615096/ibrahim-ipek"}, "is_accepted": true, "score": 0, "last_activity_date": 1469132144, "creation_date": 1469132144, "answer_id": 38513562, "question_id": 38487762, "link": "https://stackoverflow.com/questions/38487762/is-possible-to-linking-a-function-with-a-different-name/38513562#38513562", "title": "Is possible to linking a function with a different name", "body": "<p>I find a better solution:</p>\n\n<pre><code>#define GLFunction(Function) gl##Function\n</code></pre>\n\n<p>So:</p>\n\n<pre><code>#define GLClearDepth GLFunction(ClearDepth)\n//...\n</code></pre>\n\n<p>More bearable to see.</p>\n"}], "owner": {"reputation": 429, "user_id": 6615096, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/1AHQb.png?s=128&g=1", "display_name": "Ibrahim Ipek", "link": "https://stackoverflow.com/users/6615096/ibrahim-ipek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 202, "favorite_count": 0, "closed_date": 1469408456, "accepted_answer_id": 38513562, "answer_count": 4, "score": 2, "last_activity_date": 1469132144, "creation_date": 1469037975, "question_id": 38487762, "link": "https://stackoverflow.com/questions/38487762/is-possible-to-linking-a-function-with-a-different-name", "closed_reason": "Needs more focus", "title": "Is possible to linking a function with a different name", "body": "<p>Well, function names are only labels to pointing starting address of a function, so can we link a function with a different name? As a example in OpenGL API functions are starting with 'gl', can we chance this to 'GL'? I have OCD, this is really hard for me.</p>\n"}, {"tags": ["c++", "c", "sse", "fpu", "x87"], "comments": [{"owner": {"reputation": 436126, "user_id": 922184, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h7WDB.jpg?s=128&g=1", "display_name": "Mysticial", "link": "https://stackoverflow.com/users/922184/mysticial"}, "edited": false, "score": 5, "creation_date": 1469038179, "post_id": 38487718, "comment_id": 64377446, "body": "Wait... I&#39;m confused. You mention IEEE and bits which means you know about FP representation. But at the same time you&#39;re asking how to truncate <i>decimals</i> which is impossible in binary floating-point. Am I missing something?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 6, "creation_date": 1469038284, "post_id": 38487718, "comment_id": 64377503, "body": "@user354900 I disagree, work to the best precision you can, and truncate or round for display. By truncating during the calculations, you will &quot;spread&quot; a bigger error, not less."}, {"owner": {"reputation": 1, "user_id": 6615057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/935b05610702d4621e61e276e12b438b?s=128&d=identicon&r=PG&f=1", "display_name": "user354900", "link": "https://stackoverflow.com/users/6615057/user354900"}, "reply_to_user": {"reputation": 436126, "user_id": 922184, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h7WDB.jpg?s=128&g=1", "display_name": "Mysticial", "link": "https://stackoverflow.com/users/922184/mysticial"}, "edited": false, "score": 0, "creation_date": 1469038354, "post_id": 38487718, "comment_id": 64377542, "body": "@Mysticial I&#39;m confused too, it all depends on what &quot;chopping mode&quot; means for Intel ..."}, {"owner": {"reputation": 1, "user_id": 6615057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/935b05610702d4621e61e276e12b438b?s=128&d=identicon&r=PG&f=1", "display_name": "user354900", "link": "https://stackoverflow.com/users/6615057/user354900"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1469038429, "post_id": 38487718, "comment_id": 64377586, "body": "@WeatherVane I really don&#39;t need those extra decimals and there is no rounding mode that is helping my case / function"}, {"owner": {"reputation": 436126, "user_id": 922184, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h7WDB.jpg?s=128&g=1", "display_name": "Mysticial", "link": "https://stackoverflow.com/users/922184/mysticial"}, "edited": false, "score": 2, "creation_date": 1469038552, "post_id": 38487718, "comment_id": 64377670, "body": "@user354900 &quot;Chopping mode&quot; in IEEE floating point is just truncating the binary representation. In no way does it map to decimal digits unless you happen to be rounding to an integer."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1469038559, "post_id": 38487718, "comment_id": 64377672, "body": "Floating point values (typically) do not <i>have</i> &quot;decimal values&quot; - that&#39;s a conversion to human readable format. If you don&#39;t need them, then you are not doing any further calculations with the values. So you might just as well retain the precision and deal with truncation at output. If you are doing more calculations, then you do need maximum precison."}, {"owner": {"reputation": 1, "user_id": 6615057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/935b05610702d4621e61e276e12b438b?s=128&d=identicon&r=PG&f=1", "display_name": "user354900", "link": "https://stackoverflow.com/users/6615057/user354900"}, "reply_to_user": {"reputation": 436126, "user_id": 922184, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h7WDB.jpg?s=128&g=1", "display_name": "Mysticial", "link": "https://stackoverflow.com/users/922184/mysticial"}, "edited": false, "score": 0, "creation_date": 1469038617, "post_id": 38487718, "comment_id": 64377704, "body": "@Mysticial Can you code an example for &quot;rouding to an integer with chopping mode &quot; I would like to see that in action"}, {"owner": {"reputation": 27437, "user_id": 95954, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/iD0qO.png?s=128&g=1", "display_name": "Rudy Velthuis", "link": "https://stackoverflow.com/users/95954/rudy-velthuis"}, "edited": false, "score": 1, "creation_date": 1469038769, "post_id": 38487718, "comment_id": 64377798, "body": "@user354900: Weather Vane is right. By truncating you lose information, and it makes your results less accurate, i.e. you increase the error."}, {"owner": {"reputation": 436126, "user_id": 922184, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h7WDB.jpg?s=128&g=1", "display_name": "Mysticial", "link": "https://stackoverflow.com/users/922184/mysticial"}, "edited": false, "score": 5, "creation_date": 1469038810, "post_id": 38487718, "comment_id": 64377827, "body": "@user354900 If you&#39;re really asking that question. Then I presume you don&#39;t know floating-point math. So I refer you to this: <a href=\"https://docs.oracle.com/cd/E19957-01/806-3568/ncg_goldberg.html\" rel=\"nofollow noreferrer\">docs.oracle.com/cd/E19957-01/806-3568/ncg_goldberg.html</a>"}, {"owner": {"reputation": 1, "user_id": 6615057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/935b05610702d4621e61e276e12b438b?s=128&d=identicon&r=PG&f=1", "display_name": "user354900", "link": "https://stackoverflow.com/users/6615057/user354900"}, "reply_to_user": {"reputation": 436126, "user_id": 922184, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h7WDB.jpg?s=128&g=1", "display_name": "Mysticial", "link": "https://stackoverflow.com/users/922184/mysticial"}, "edited": false, "score": 0, "creation_date": 1469039124, "post_id": 38487718, "comment_id": 64377999, "body": "@Mysticial still confused about this, and apparently <code>FISTTP</code> doesn&#39;t really has an intrinsics equivalent ."}, {"owner": {"reputation": 436126, "user_id": 922184, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h7WDB.jpg?s=128&g=1", "display_name": "Mysticial", "link": "https://stackoverflow.com/users/922184/mysticial"}, "edited": false, "score": 2, "creation_date": 1469039930, "post_id": 38487718, "comment_id": 64378433, "body": "@user354900 Read that article that I linked you and you will understand why your question is fundamentally flawed. (putting aside the fact that this is an <a href=\"http://meta.stackexchange.com/questions/66377/what-is-the-xy-problem\">XY problem</a>) When people use words like, &quot;IEEE&quot;, &quot;intrinsics&quot;, &quot;SSE&quot;, &quot;vectorization&quot;, and assembly instructions, we habitually assume they know all the basics such as floating-point representation. This is the first time I&#39;ve seen otherwise. Sorry."}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 1, "creation_date": 1469078571, "post_id": 38487718, "comment_id": 64391309, "body": "internal calculations should be done in as most precision as possible, that&#39;s why x87 uses 80-bit registers"}], "answers": [{"comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 2, "creation_date": 1469068702, "post_id": 38490616, "comment_id": 64388705, "body": "I&#39;d recommend <a href=\"http://en.cppreference.com/w/c/numeric/math/rint\" rel=\"nofollow noreferrer\">C99 <code>double rint(double)</code></a> instead of <code>round()</code>.  <code>round</code> has weird rounding semantics that don&#39;t match any of the available rounding modes on x86, <a href=\"http://stackoverflow.com/a/37624488/224132\">so it compiles to worse code for that architecture.</a>.  <code>round</code> can actually inline to a single instruction for ARM, since it seems ARM has an instruction with those semantics."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1469069094, "post_id": 38490616, "comment_id": 64388802, "body": "@Peter Cordes Good thoughts in your <a href=\"http://stackoverflow.com/questions/38487718/truncate-floats-and-doubles-after-user-defined-points-in-x87-and-sse-fpus/38490616?noredirect=1#comment64388705_38490616\">comment</a>.  I see both <code>rint()</code> and <code>nearbyint()</code> as contenders.  Thanks for the tip.  Amend the post as you see fit - it is community wiki."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1469069346, "post_id": 38490616, "comment_id": 64388856, "body": "oh right, yes <a href=\"http://en.cppreference.com/w/c/numeric/math/nearbyint\" rel=\"nofollow noreferrer\"><code>double nearbyint(double)</code></a> should always be at least as efficient, and potentially better since it doesn&#39;t have to set errno.  Other than that, I think they have identical semantics."}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 2, "last_activity_date": 1469069146, "last_edit_date": 1469069146, "creation_date": 1469047838, "answer_id": 38490616, "question_id": 38487718, "link": "https://stackoverflow.com/questions/38487718/truncate-floats-and-doubles-after-user-defined-points-in-x87-and-sse-fpus/38490616#38490616", "title": "Truncate Floats and Doubles after user defined points in X87 and SSE FPUs", "body": "<blockquote>\n  <p>how do I do this in X87 ( scalar FPU ) and SSE ( vector FPU ) ?</p>\n</blockquote>\n\n<p>The following does not use X87 nor SSE.  I've included it as a community reference for general purpose code.  If anything, it can be used to test a X87 solution.</p>\n\n<ol>\n<li><p>Any \"chopping\" of the result of <code>g()</code> will at least <em>marginally</em> increase error, hopefully tolerable as OP said \"To avoid spreading error to other computations ...\"</p></li>\n<li><p>It is unclear if OP wants \"accurate results up to 5 decimals\" to reflect absolute precision (+/- 0.000005) or relative precision (+/- 0.000005 * result).  Will assume \"absolute precision\".</p></li>\n<li><p>Since <code>float</code>, <code>double</code> are far often a <em>binary</em> floating point, any \"chop\" will reflect a FP number <em>nearest</em> to a multiple of 0.00001.</p></li>\n<li><p>Text Method:</p>\n\n<pre><code>//       - x    xxx...xxx    . xxxxx \\0\nchar buf[1+1+ DBL_MAX_10_EXP+1  +5   +1];\nsprintf(buf, \"%.5f\", x);\nx = atof(buf);\n</code></pre></li>\n<li><p><strike><code>round()</code></strike>  <code>rint()</code> method:</p>\n\n<pre><code>#define SCALE 100000.0\nif (fabs(x) &lt; DBL_MAX/SCALE) {\n  x = x*SCALE;\n  x = rint(x)/SCALE;\n}\n</code></pre></li>\n<li><p>Direct bit manipulation of <code>x</code>.  Simply zero select bits in the significand.</p>\n\n<pre><code>TBD code.\n</code></pre></li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1469069482, "post_id": 38493931, "comment_id": 64388893, "body": "Could use <code>double HHGTG_round(double) { return 42; }</code>"}], "tags": [], "owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "is_accepted": false, "score": 3, "last_activity_date": 1469073487, "last_edit_date": 1469073487, "creation_date": 1469068405, "answer_id": 38493931, "question_id": 38487718, "link": "https://stackoverflow.com/questions/38487718/truncate-floats-and-doubles-after-user-defined-points-in-x87-and-sse-fpus/38493931#38493931", "title": "Truncate Floats and Doubles after user defined points in X87 and SSE FPUs", "body": "<p>As several people commented, <a href=\"https://docs.oracle.com/cd/E19957-01/806-3568/ncg_goldberg.html\" rel=\"nofollow\">more early rounding doesn't help the final result be more accurate</a>.  If you want to read more about floating point comparisons and weirdness / gotchas, I highly recommend Bruce Dawson's series of articles on floating point.  Here's a quote from <a href=\"https://randomascii.wordpress.com/2012/02/25/comparing-floating-point-numbers-2012-edition/\" rel=\"nofollow\">the one with the index</a></p>\n\n<blockquote>\n  <p>We\u2019ve finally reached the point in this series that I\u2019ve been waiting\n  for. In <a href=\"https://randomascii.wordpress.com/2012/02/25/comparing-floating-point-numbers-2012-edition/\" rel=\"nofollow\">this post</a> I am going to share the most crucial piece of\n  floating-point math knowledge that I have. Here it is:</p>\n  \n  <p>[Floating-point] math is hard.</p>\n  \n  <p>You just won\u2019t believe how vastly, hugely, mind-bogglingly hard it is.\n  I mean, you may think it\u2019s difficult to calculate when trains from\n  Chicago and Los Angeles will collide, but that\u2019s just peanuts to\n  floating-point math.</p>\n</blockquote>\n\n<p>(Bonus points if you recognize that last paragraph as a paraphrase of a famous line about space.)</p>\n\n<hr>\n\n<h3>How you could actually implement your bad idea:</h3>\n\n<p>There aren't any machine instructions or C standard library functions to truncate or round to anything other than integer.</p>\n\n<p>Note that there are machine instructions (and C functions) that round a <code>double</code> to nearest (representable) integer without converting it to <code>intmax_t</code> or anything, just <code>double</code>-><code>double</code>.  So no round-trip through a fixed-width 2's complement integer.</p>\n\n<p>So to use them, you could scale your float up by some factor, round to nearest integer, then scale back down.  (like chux's <code>round()</code>-based function, but I'd recommend <a href=\"http://en.cppreference.com/w/c/numeric/math/rint\" rel=\"nofollow\">C99 <code>double rint(double)</code></a> instead of <code>round()</code>.  <code>round</code> has weird rounding semantics that don't match any of the available rounding modes on x86, so it compiles to worse code.</p>\n\n<hr>\n\n<p><strong>The x86 asm instructions you keep mentioning are nothing special</strong>, and don't do anything that you can't ask the compiler to do with pure C.</p>\n\n<p><a href=\"http://www.felixcloutier.com/x86/FIST:FISTP.html\" rel=\"nofollow\"><code>FISTP</code></a> (Float Integer STore (and Pop the x87 stack) is one way for a compiler or asm programmer to implement <a href=\"https://stackoverflow.com/a/37624488/224132\"><code>long lrint(double)</code> or <code>(int)nearbyint(double)</code>.</a>  Some compilers make better code for one or the other.  It rounds using the current x87 rounding mode (default: round to nearest), which is the <a href=\"http://en.cppreference.com/w/c/numeric/math/rint\" rel=\"nofollow\">same semantics as those ISO C standard functions</a>.</p>\n\n<p><a href=\"http://www.felixcloutier.com/x86/FISTTP.html\" rel=\"nofollow\"><code>FISTTP</code></a> (Float Integer STore with Truncation (and Pop the x87 stack) is <a href=\"https://en.wikipedia.org/wiki/SSE3\" rel=\"nofollow\">part of SSE3</a>, even though it operates on the x87 stack.  It lets compilers avoid setting the rounding mode to truncation (round-towards-zero) to implement the C truncation semantics of <code>(long)x</code>, and then restoring the old rounding mode.</p>\n\n<p>This is what the \"not modify the control word\" stuff is about.  Neither instruction does that, but to implement <code>(int)x</code> without FISTTP, the compiler has to use <em>other</em> instructions to modify and restore the rounding mode around a <code>FIST</code> instruction.  Or just use <a href=\"http://www.felixcloutier.com/x86/CVTTSD2SI.html\" rel=\"nofollow\">SSE2 <code>CVTTSD2SI</code></a> to convert a double in an xmm register with truncation, instead of an FP value on the legacy x87 stack.</p>\n\n<p>Since <code>FISTTP</code> is only available with SSE3, you'd only use it for <code>long double</code>, or in 32-bit code that had FP values in x87 registers anyway because of the crusty old 32-bit ABI which returns FP values on the x87 stack.</p>\n\n<hr>\n\n<p>PS. if you didn't recognize Bruce's <a href=\"https://en.wikipedia.org/wiki/The_Hitchhiker%27s_Guide_to_the_Galaxy\" rel=\"nofollow\">HHGTG</a> reference, <a href=\"http://hitchhikersguidequotes.tumblr.com/post/13945214509/space-is-big-really-big-you-just-wont-believe\" rel=\"nofollow\">the original is</a>:</p>\n\n<blockquote>\n  <p>Space is big. Really big. You just won\u2019t believe how vastly hugely\n  mindbogglingly big it is. I mean you may think it\u2019s a long way down\n  the road to the chemist\u2019s, but that\u2019s just peanuts to space.</p>\n</blockquote>\n"}], "owner": {"reputation": 1, "user_id": 6615057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/935b05610702d4621e61e276e12b438b?s=128&d=identicon&r=PG&f=1", "display_name": "user354900", "link": "https://stackoverflow.com/users/6615057/user354900"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 315, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1469073487, "creation_date": 1469037823, "question_id": 38487718, "link": "https://stackoverflow.com/questions/38487718/truncate-floats-and-doubles-after-user-defined-points-in-x87-and-sse-fpus", "title": "Truncate Floats and Doubles after user defined points in X87 and SSE FPUs", "body": "<p>I have made a function <code>g</code> that is able to approximate a function to a certain degree, this function gives accurate results up to 5 decimals ( 1,23456xxxxxxxxxxxx where the x positions are just rounding errors / junk ) .</p>\n\n<p>To avoid spreading error to other computations that will use the results of <code>g</code> I would like to just set all the x positions to zero, better yet, just set to 0 everything after the 5th decimal .</p>\n\n<p>I haven't found anything in X87 and SSE literature that let's me play with IEEE 754 bits or their representation the way I would like to .</p>\n\n<p>There is an old reference to the <code>FISTP</code> instruction for X87 that is apparently mirrored in the SSE world with <code>FISTTP</code>, with the benefit that <code>FISTTP</code> doesn't necesserily modify the control word and is therefore faster .</p>\n\n<p>I have noticed that <code>FISTTP</code> was called \"chopping mode\", but now in more modern literature is just \"rounding toward zero\" or \"truncate\" and this confuse me because \"chopping\" means removing something altogether where \"rounding toward zero\" doesn't necessarily means the same thing to me .</p>\n\n<p>I don't need to round to zero, I only need to preserve up to 5 decimals as the last step in my function before storing the result in memory; how do I do this in X87 ( scalar FPU ) and SSE ( vector FPU ) ? </p>\n"}, {"tags": ["c", "raspberry-pi", "concatenation", "analog-digital-converter"], "comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 2, "creation_date": 1469036545, "post_id": 38487250, "comment_id": 64376385, "body": "What is an actual number? Is the math the problem here? Is it that you, don&#39;t know how to calculate the number from the <code>iTemp</code>?"}, {"owner": {"reputation": 1, "user_id": 6614917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/791262a082c0cc3e178f26d552ecf77d?s=128&d=identicon&r=PG&f=1", "display_name": "Josh ", "link": "https://stackoverflow.com/users/6614917/josh"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1469036831, "post_id": 38487250, "comment_id": 64376558, "body": "its that the number is displayed correctly using the printf settings they have. However I need to create a variable that acutally is that number so that I can use it in my equation"}, {"owner": {"reputation": 604, "user_id": 854911, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-302baaBxp8Q/AAAAAAAAAAI/AAAAAAAAABA/-K5SxmEim-A/photo.jpg?sz=128", "display_name": "struct", "link": "https://stackoverflow.com/users/854911/struct"}, "edited": false, "score": 0, "creation_date": 1469037201, "post_id": 38487250, "comment_id": 64376794, "body": "Does <code>iTemp</code> contain 1186392 at the moment? If it does, conversion could be done via division by <code>1000000.0</code>"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1469038837, "post_id": 38487250, "comment_id": 64377843, "body": "<code>while((ADS1256_Scan() == 0));</code> has an empty body.  If this is intended, It would be more explicit to write it <code>while((ADS1256_Scan() == 0)) continue;</code>"}, {"owner": {"reputation": 1, "user_id": 6614917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/791262a082c0cc3e178f26d552ecf77d?s=128&d=identicon&r=PG&f=1", "display_name": "Josh ", "link": "https://stackoverflow.com/users/6614917/josh"}, "edited": false, "score": 0, "creation_date": 1469039100, "post_id": 38487250, "comment_id": 64377980, "body": "Your right, I was over complicating it. Thanks for you help"}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "reply_to_user": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1469041730, "post_id": 38487250, "comment_id": 64379479, "body": "@chqrlie right, even the semicolon in the next line or an actual empty body block <code>{}</code> is better but it&#39;s odd that you didn&#39;t mention the extraneous parentheses."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1469042191, "post_id": 38487250, "comment_id": 64379752, "body": "@iharob: the extra parentheses are redundant but harmless, what is more troublesome is the closing curly brace 4 rows from the bottom of the code fragment..."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1469042283, "post_id": 38487250, "comment_id": 64379807, "body": "@Josh: <b>please indent the code correctly!</b> As posted, it is very confusion ans inconsistent."}], "answers": [{"tags": [], "owner": {"reputation": 12209, "user_id": 4926757, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-jsLBa8e0dT0/AAAAAAAAAAI/AAAAAAAAAEc/YqNqYlsSjrU/photo.jpg?sz=128", "display_name": "Rotem", "link": "https://stackoverflow.com/users/4926757/rotem"}, "is_accepted": false, "score": 0, "last_activity_date": 1469053196, "creation_date": 1469053196, "answer_id": 38491804, "question_id": 38487250, "link": "https://stackoverflow.com/questions/38487250/concatenating-32-bit-integers-in-c/38491804#38491804", "title": "Concatenating 32 bit integers in C", "body": "<p>According to your comment: <code>iTemp = volt[i];    /* uV  */</code>, iTemp read is in micro-volts.\nIn order to use it in your equation, all you need to do is convert it to volts (convert it to <code>double</code> or <code>float</code> and multiply by (1.0/1000000.0)).</p>\n\n<pre><code>double iTempV = (double)iTemp*1.0e-6;\n</code></pre>\n\n<p>or:</p>\n\n<pre><code>float iTempV = (float)iTemp*1.0e-6f;\n</code></pre>\n\n<p>I assume the following formula converts A2D raw sample value to micro-voltage:</p>\n\n<pre><code>adc[i] = ADS1256_GetAdc(i);\nvolt[i] = (adc[i] * 100) / 167;\n</code></pre>\n\n<p>I found the following project in GitHub: <a href=\"https://github.com/ecao1/SEADS-Rpi/blob/master/test_ver1.c\" rel=\"nofollow\">https://github.com/ecao1/SEADS-Rpi/blob/master/test_ver1.c</a> to support my claim.</p>\n"}], "owner": {"reputation": 1, "user_id": 6614917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/791262a082c0cc3e178f26d552ecf77d?s=128&d=identicon&r=PG&f=1", "display_name": "Josh ", "link": "https://stackoverflow.com/users/6614917/josh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 177, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1469053196, "creation_date": 1469036353, "question_id": 38487250, "link": "https://stackoverflow.com/questions/38487250/concatenating-32-bit-integers-in-c", "title": "Concatenating 32 bit integers in C", "body": "<p>I am currently working on a project that will use a thermister as a temperature sensor and displaying this information among other things onto a gui using the raspberry pi. However I am currently stuck on the Analog to digital conversion. Using the sample code from the waveshare ad board I am using I manage to get the voltage to display, however I then need to use this vout in my voltage divider equation to get the resistance of my thermister and I can't figure out how to actually use the <strong>32 bit integer iTemp</strong> variable and properly convert it so thats its the actual number displayed on the console. Currently the 2 print lines with itemp print out numbers like (1.186 391 V). which is correct but I need to convert that into a actual number that I can then plug into my voltage divider equation. Ps: I included the part of the code with the print statements.\nAny help would be greatly appreaciated.</p>\n\n<p>Code:</p>\n\n<pre><code> while((ADS1256_Scan() == 0));\n        for (i = 0; i &lt; ch_num; i++)\n        {\n            adc[i] = ADS1256_GetAdc(i);\n                 volt[i] = (adc[i] * 100) / 167;    \n        }\n\n        for (i = 0; i &lt; ch_num; i++)\n        {\n                    buf[0] = ((uint32_t)adc[i] &gt;&gt; 16) &amp; 0xFF;\n                    buf[1] = ((uint32_t)adc[i] &gt;&gt; 8) &amp; 0xFF;\n                    buf[2] = ((uint32_t)adc[i] &gt;&gt; 0) &amp; 0xFF;\n                    printf(\"%d=%02X%02X%02X, %8ld\", (int)i, (int)buf[0], \n                           (int)buf[1], (int)buf[2], (long)adc[i]);                \n\n                    iTemp = volt[i];    /* uV  */\n                    if (iTemp &lt; 0)\n                    {\n                        iTemp = -iTemp;\n                                printf(\" (-%ld.%03ld %03ld V) \\r\\n\", iTemp /1000000, (iTemp%1000000)/1000, iTemp%1000);\n                    }\n                    else\n                    {\n                                    printf(\" ( %ld.%03ld %03ld V) \\r\\n\", iTemp /1000000, (iTemp%1000000)/1000, iTemp%1000);                   \n                    }\n\n        }\n            //printf(\"\\33[%dA\", (int)ch_num);  \n        bsp_DelayUS(100000);    \n            }   \n    bcm2835_spi_end();\n    bcm2835_close();\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 7792, "user_id": 249237, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QjPtI.png?s=128&g=1", "display_name": "Kninnug", "link": "https://stackoverflow.com/users/249237/kninnug"}, "edited": false, "score": 1, "creation_date": 1469033079, "post_id": 38486245, "comment_id": 64374407, "body": "How big would the array be?"}, {"owner": {"reputation": 871334, "user_id": 157247, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/4HovX.jpg?s=128&g=1", "display_name": "T.J. Crowder", "link": "https://stackoverflow.com/users/157247/t-j-crowder"}, "edited": false, "score": 0, "creation_date": 1469033103, "post_id": 38486245, "comment_id": 64374425, "body": "I see two completely separate questions above. Suggest picking one."}, {"owner": {"reputation": 59, "user_id": 4451210, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26afe37bbabd6844dfc690a1adbe02fd?s=128&d=identicon&r=PG&f=1", "display_name": "share75", "link": "https://stackoverflow.com/users/4451210/share75"}, "edited": false, "score": 0, "creation_date": 1469033282, "post_id": 38486245, "comment_id": 64374523, "body": "I have chosen one and array can be of any size"}, {"owner": {"reputation": 7792, "user_id": 249237, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QjPtI.png?s=128&g=1", "display_name": "Kninnug", "link": "https://stackoverflow.com/users/249237/kninnug"}, "edited": false, "score": 0, "creation_date": 1469033363, "post_id": 38486245, "comment_id": 64374554, "body": "What I meant was: after this declaration, how big is the array <code>key</code>?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1469034151, "post_id": 38486245, "comment_id": 64375036, "body": "Have you actually tried it?"}, {"owner": {"reputation": 201, "user_id": 6566675, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lDqPG.png?s=128&g=1", "display_name": "clarasoft-it", "link": "https://stackoverflow.com/users/6566675/clarasoft-it"}, "edited": false, "score": 1, "creation_date": 1469035068, "post_id": 38486245, "comment_id": 64375553, "body": "An initializer cannot be empty in C"}], "answers": [{"tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": true, "score": 1, "last_activity_date": 1469035247, "creation_date": 1469035247, "answer_id": 38486937, "question_id": 38486245, "link": "https://stackoverflow.com/questions/38486245/character-array-declaration-and-initialization/38486937#38486937", "title": "Character Array Declaration and initialization", "body": "<p>Per the <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"nofollow\">online C2011 standard</a>, it is not valid; you may not have an empty initializer list (see 6.7.9, Syntax).  That doesn't mean a specific implementation can't offer an empty initializer list as an extension, but the utility would be unclear.  </p>\n\n<p>Beyond that, the compiler has no way of knowing how much storage to set aside for the array.  </p>\n"}], "owner": {"reputation": 59, "user_id": 4451210, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26afe37bbabd6844dfc690a1adbe02fd?s=128&d=identicon&r=PG&f=1", "display_name": "share75", "link": "https://stackoverflow.com/users/4451210/share75"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "closed_date": 1469036757, "accepted_answer_id": 38486937, "answer_count": 1, "score": -5, "last_activity_date": 1469035247, "creation_date": 1469032979, "last_edit_date": 1469033190, "question_id": 38486245, "link": "https://stackoverflow.com/questions/38486245/character-array-declaration-and-initialization", "closed_reason": "Duplicate", "title": "Character Array Declaration and initialization", "body": "<p>Is the below declaration valid in C?</p>\n\n<pre><code>char key[] = {};\n</code></pre>\n\n<p>If not why not?</p>\n"}, {"tags": ["c", "macros"], "comments": [{"owner": {"reputation": 17812, "user_id": 725851, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/6eb2d58a613015ccde3f2002ace4e08e?s=128&d=identicon&r=PG", "display_name": "Chad", "link": "https://stackoverflow.com/users/725851/chad"}, "edited": false, "score": 3, "creation_date": 1469032554, "post_id": 38486056, "comment_id": 64374121, "body": "Potentially relevant: <a href=\"http://stackoverflow.com/questions/4176328/undefined-behavior-and-sequence-points\" title=\"undefined behavior and sequence points\">stackoverflow.com/questions/4176328/&hellip;</a>"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1469032639, "post_id": 38486056, "comment_id": 64374169, "body": "Undefined behaviour: which value of <code>*ip</code> will be the operand of <code>RETAIN(ip)</code>?"}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 3, "creation_date": 1469033466, "post_id": 38486056, "comment_id": 64374616, "body": "Why are you using macros in the first place?"}], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 2582701, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/d4d3c357f5ea9f688060f9acf482938d?s=128&d=identicon&r=PG", "display_name": "mit23", "link": "https://stackoverflow.com/users/2582701/mit23"}, "edited": false, "score": 0, "creation_date": 1469033007, "post_id": 38486140, "comment_id": 64374374, "body": "Yeah!! Can you suggest the correct way of writing macro so as to avoid the warning?"}], "tags": [], "owner": {"reputation": 2488, "user_id": 6600109, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60d018ddca1b281e434c1ae6696a0195?s=128&d=identicon&r=PG&f=1", "display_name": "Markus Laire", "link": "https://stackoverflow.com/users/6600109/markus-laire"}, "is_accepted": false, "score": 2, "last_activity_date": 1469032669, "creation_date": 1469032669, "answer_id": 38486140, "question_id": 38486056, "link": "https://stackoverflow.com/questions/38486056/opearation-may-be-undefined-in-c/38486140#38486140", "title": "Opearation may be undefined in C", "body": "<p>When second example is expanded it becomes</p>\n\n<pre><code>*op |= *ip++ &lt;&lt; 20 | *ip;\n</code></pre>\n\n<p>Here it is undefined whether value of <strong>second</strong> <code>*ip</code> is read before or after <code>\u00ecp</code> is incremented.</p>\n"}, {"comments": [{"owner": {"reputation": 53, "user_id": 2582701, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/d4d3c357f5ea9f688060f9acf482938d?s=128&d=identicon&r=PG", "display_name": "mit23", "link": "https://stackoverflow.com/users/2582701/mit23"}, "edited": false, "score": 0, "creation_date": 1469032944, "post_id": 38486192, "comment_id": 64374329, "body": "Got it! Can you suggest the way of writing macro for this so as to avoid the warning?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 53, "user_id": 2582701, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/d4d3c357f5ea9f688060f9acf482938d?s=128&d=identicon&r=PG", "display_name": "mit23", "link": "https://stackoverflow.com/users/2582701/mit23"}, "edited": false, "score": 1, "creation_date": 1469032992, "post_id": 38486192, "comment_id": 64374367, "body": "@user2582701 It&#39;s not just a warning. It is actual error. And..you have to answer yourself - do you want <code>ip</code> to get incremented before or after <code>RETAIN</code>?"}, {"owner": {"reputation": 53, "user_id": 2582701, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/d4d3c357f5ea9f688060f9acf482938d?s=128&d=identicon&r=PG", "display_name": "mit23", "link": "https://stackoverflow.com/users/2582701/mit23"}, "edited": false, "score": 0, "creation_date": 1469033184, "post_id": 38486192, "comment_id": 64374471, "body": "I have changed the macros as suggested, but still the warnings persist!!"}, {"owner": {"reputation": 17608, "user_id": 3650362, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fqdi1.jpg?s=128&g=1", "display_name": "trentcl", "link": "https://stackoverflow.com/users/3650362/trentcl"}, "edited": false, "score": 3, "creation_date": 1469033190, "post_id": 38486192, "comment_id": 64374473, "body": "You cannot fix this by changing the macro. You need to introduce a sequence point to make the behavior defined. Either <code>tmp = RETAIN(ip); *op |= INCREMENT(ip)&lt;&lt;20 | tmp</code> or <code>tmp = INCREMENT(ip); *op |= tmp&lt;&lt;20 | RETAIN(ip)</code> will work depending on which thing you want to happen first"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 53, "user_id": 2582701, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/d4d3c357f5ea9f688060f9acf482938d?s=128&d=identicon&r=PG", "display_name": "mit23", "link": "https://stackoverflow.com/users/2582701/mit23"}, "edited": false, "score": 1, "creation_date": 1469033227, "post_id": 38486192, "comment_id": 64374495, "body": "@user2582701 As I said, the last suggestion is to avoid <i>other unrelated</i> problems."}], "tags": [], "owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "is_accepted": false, "score": 4, "last_activity_date": 1469033481, "last_edit_date": 1469033481, "creation_date": 1469032819, "answer_id": 38486192, "question_id": 38486056, "link": "https://stackoverflow.com/questions/38486056/opearation-may-be-undefined-in-c/38486192#38486192", "title": "Opearation may be undefined in C", "body": "<p>The line:</p>\n\n<pre><code>*op |= INCREMENT(ip)&lt;&lt;20 | RETAIN(ip);\n</code></pre>\n\n<p>is preprocessed into</p>\n\n<pre><code>*op |= *ip++ &lt;&lt; 20 | *ip;\n</code></pre>\n\n<p>As there is no sequence point between the <code>*ip++ &lt;&lt; 20</code>and <code>*ip</code>, the postincrement of <code>ip</code> can be sequenced either before or after evaluation of <code>*ip</code>. So the operation has an undefined behavior.</p>\n\n<p>And as a side note: To avoid other(unrelated) troubles (<a href=\"https://gcc.gnu.org/onlinedocs/cpp/Macro-Pitfalls.html\" rel=\"nofollow\">Macro Pitfalls</a>), replace the macro definitions with these:</p>\n\n<pre><code>#define INCREMENT(ip) (*(ip)++)\n#define RETAIN(ip) (*(ip))\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 2582701, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/d4d3c357f5ea9f688060f9acf482938d?s=128&d=identicon&r=PG", "display_name": "mit23", "link": "https://stackoverflow.com/users/2582701/mit23"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1469033481, "creation_date": 1469032390, "last_edit_date": 1469032832, "question_id": 38486056, "link": "https://stackoverflow.com/questions/38486056/opearation-may-be-undefined-in-c", "title": "Opearation may be undefined in C", "body": "<p>I have macros like:</p>\n\n<pre><code>#define INCREMENT(ip) *ip++\n#define RETAIN(ip) *ip\n</code></pre>\n\n<p>and in code, I use them like: </p>\n\n<pre><code>*op |= INCREMENT(ip)&lt;&lt;15;\n*op |= INCREMENT(ip)&lt;&lt;20 | RETAIN(ip);\n</code></pre>\n\n<p>My issue is, I do not get any warning for first line where as I get a warning: </p>\n\n<blockquote>\n  <p>\"operation on \u2018*ip\u2019 may be undefined [-Wsequence-point]\"</p>\n</blockquote>\n\n<p>for second line.</p>\n\n<p>What is it going wrong?</p>\n\n<p>How should I change my macro to avoid that warning?</p>\n\n<p>Note: I have several statements in code which use macros. I can't change all of them(tidious task). So, please tell me the perfect way of writing macro to avaoid that warning.</p>\n"}, {"tags": ["c", "uart", "atmel", "atmelstudio"], "comments": [{"owner": {"reputation": 5662, "user_id": 5781248, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/712de4f2f811d1a400d3311c9cdd5836?s=128&d=identicon&r=PG&f=1", "display_name": "J.J. Hakala", "link": "https://stackoverflow.com/users/5781248/j-j-hakala"}, "edited": false, "score": 1, "creation_date": 1469040839, "post_id": 38485804, "comment_id": 64378966, "body": "Both handlers seem to share <code>read_buffer</code> and <code>read_buffer_index</code>, maybe those should be UART specific i.e. <code>read_buffer1</code> and <code>read_buffer2</code>."}, {"owner": {"reputation": 5662, "user_id": 5781248, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/712de4f2f811d1a400d3311c9cdd5836?s=128&d=identicon&r=PG&f=1", "display_name": "J.J. Hakala", "link": "https://stackoverflow.com/users/5781248/j-j-hakala"}, "edited": false, "score": 0, "creation_date": 1469040880, "post_id": 38485804, "comment_id": 64378991, "body": "What is the reason for using two UARTs?"}], "owner": {"reputation": 21, "user_id": 5572432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c7bfcfb39063637eda12df52f5d041e?s=128&d=identicon&r=PG&f=1", "display_name": "A Butera", "link": "https://stackoverflow.com/users/5572432/a-butera"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 200, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1469031591, "creation_date": 1469031591, "question_id": 38485804, "link": "https://stackoverflow.com/questions/38485804/atmel-asf-sam4e-uart0-firing-erratically", "title": "Atmel ASF SAM4E UART0 Firing Erratically", "body": "<p>I'm attempting to set up UART communication with a GPS module but keep running into some communication error. The GPS sends a packet approximately once a second to the SAM4E16E micro, which should be trigger an interrupt and read in the data. I have two UARTS which are configured like this </p>\n\n<p>conf_uart.h</p>\n\n<pre><code>#include \"asf.h\" //uart.h etc. included here\n\n#define UART_SERIAL_BAUDRATE        4800\n#define UART_SERIAL_CHANNEL_MODE   UART_MR_CHMODE_NORMAL\n#define UART_SERIAL_MODE         UART_MR_PAR_NO\n#define UART_SERIAL_STOP_BIT        US_MR_NBSTOP_1_BIT\n\n/* =============== UART0 =============== */ \n#define PINS_UART0          (PIO_PA9A_URXD0 | PIO_PA10A_UTXD0)\n#define PINS_UART0_FLAGS    (PIO_PERIPH_A | PIO_DEFAULT)\n#define PINS_UART0_MASK     (PIO_PA9A_URXD0 | PIO_PA9A_URXD0)\n#define PINS_UART0_PIO      PIOA\n#define PINS_UART0_ID       ID_PIOA\n#define PINS_UART0_TYPE     PIO_PERIPH_A\n#define PINS_UART0_ATTR     PIO_DEFAULT\n\n/* =============== UART1 =============== */ \n#define PINS_UART1          (PIO_PB2A_URXD1 | PIO_PB3A_UTXD1)\n#define PINS_UART1_FLAGS    (PIO_PERIPH_A | PIO_DEFAULT)\n#define PINS_UART1_MASK     (PIO_PB2A_URXD1 | PIO_PB3A_UTXD1)\n#define PINS_UART1_PIO      PIOB\n#define PINS_UART1_ID       ID_PIOB\n#define PINS_UART1_TYPE     PIO_PERIPH_A\n#define PINS_UART1_ATTR     PIO_DEFAULT\n</code></pre>\n\n<p>conf_uart.c</p>\n\n<pre><code>#include \"conf_uart.h\"\n\nvoid uart_custom_init_1(void) {\n\n     // set the pins to use the uart peripheral\n    pio_configure(PINS_UART1_PIO, PINS_UART1_TYPE, PINS_UART1_MASK, PINS_UART1_ATTR);\n\n    //enable the uart peripherial clock\n    pmc_enable_periph_clk(ID_UART1);\n\n    const sam_uart_opt_t uart1_settings =\n      { sysclk_get_cpu_hz(), UART_SERIAL_BAUDRATE, UART_SERIAL_MODE };\n\n    uart_init(UART1,&amp;uart1_settings);      //Init UART1 and enable Rx and Tx\n\n    uart_enable_interrupt(UART1,UART_IER_RXRDY);   //Interrupt reading ready\n    NVIC_EnableIRQ(UART1_IRQn);\n\n}\n\nuart_custom_init_0(void)\n{\n    // 1. Enable UART peripheral clock\n\n\n    //2. Enable the required PIO's\n    pio_configure(PINS_UART0_PIO, PINS_UART0_TYPE, PINS_UART0_MASK, PINS_UART0_ATTR);\n\n    pmc_enable_periph_clk(ID_UART0);\n    // 3. call init\n    const sam_uart_opt_t uart0_settings =\n    { sysclk_get_cpu_hz(), UART_SERIAL_BAUDRATE, UART_SERIAL_MODE };\n\n    uart_init(UART0,&amp;uart0_settings);      //Init UART1 and enable Rx and Tx\n\n    // read on interrupt\n    uart_enable_interrupt(UART0,UART_IER_RXRDY);   //Interrupt reading ready\n    NVIC_EnableIRQ(UART0_IRQn);\n\n\n}\n\nvoid UART1_Handler() {\n   uint32_t dw_status = uart_get_status(UART1);\n\n   if(dw_status &amp; UART_SR_RXRDY) {\n      uint8_t received_byte1;\n      uart_read(UART1, &amp;received_byte);\n      read_buffer[read_buffer_index] = received_byte;\n      read_buffer_index++;\n   }\n}\n\nvoid UART0_Handler() {\n    uint32_t dw_status = uart_get_status(UART0);\n\n    if(dw_status &amp; UART_SR_RXRDY)\n    {\n        uint8_t received_byte0;\n        uart_read(UART0, &amp;received_byte);\n        read_buffer[read_buffer_index] = received_byte;\n        read_buffer_index++;\n    }\n}\n</code></pre>\n\n<p>UART1 works perfectly. UART0 Only fires roughly once per packet, and is not even getting the first byte in the packet (should be 36, receives 16). As far as I can tell they are identical. The chip is working, I can see it transmitting on the scope. I'm basically fresh out of ideas.</p>\n"}, {"tags": ["c", "file", "buffer"], "comments": [{"owner": {"reputation": 13866, "user_id": 54200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6261c8ab215b8069e8290516c80445d8?s=128&d=identicon&r=PG", "display_name": "KevinDTimm", "link": "https://stackoverflow.com/users/54200/kevindtimm"}, "edited": false, "score": 0, "creation_date": 1469037292, "post_id": 38485796, "comment_id": 64376863, "body": "We need a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> to be able to help - too many unknowns at this time."}, {"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1469040915, "post_id": 38485796, "comment_id": 64379016, "body": "You need to show how you open the file."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1469126178, "post_id": 38485796, "comment_id": 64421185, "body": "If I understand your question correctly, some one is changing a file while it is &#39;open&#39; for reading.  To have the executing program see the latest file contents, close the file and then open it again."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 5153815, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/04b1a11ea26940c3491a6256b16d893f?s=128&d=identicon&r=PG&f=1", "display_name": "picklesrevil", "link": "https://stackoverflow.com/users/5153815/picklesrevil"}, "edited": false, "score": 0, "creation_date": 1469035808, "post_id": 38485942, "comment_id": 64375960, "body": "I tried reopening the file. It did not change the situation at all."}, {"owner": {"reputation": 1172, "user_id": 1076111, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/82509620e4f45b74c10054281b517574?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/1076111/alex"}, "reply_to_user": {"reputation": 25, "user_id": 5153815, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/04b1a11ea26940c3491a6256b16d893f?s=128&d=identicon&r=PG&f=1", "display_name": "picklesrevil", "link": "https://stackoverflow.com/users/5153815/picklesrevil"}, "edited": false, "score": 0, "creation_date": 1469043637, "post_id": 38485942, "comment_id": 64380543, "body": "If you reopened the file, and didn&#39;t see any changes, that means there were no changes written.  Are you sure you wrote the new values from the other process? Remember about buffering, you need to either call fclose() or fflush() from the other process, to flush out whatever you wrote to disk."}], "tags": [], "owner": {"reputation": 1172, "user_id": 1076111, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/82509620e4f45b74c10054281b517574?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/1076111/alex"}, "is_accepted": false, "score": 0, "last_activity_date": 1469032011, "creation_date": 1469032011, "answer_id": 38485942, "question_id": 38485796, "link": "https://stackoverflow.com/questions/38485796/c-changes-made-to-text-file-are-not-noticed-when-the-program-reads-the-file/38485942#38485942", "title": "C - Changes made to text file are not noticed when the program reads the file", "body": "<p>fgets, and the like buffer input.  So they may find end of file, and not be able to read past it.  You can for example re-open the file, and 'fseek' to position you got to last time.  Or maybe use a different mechanism such as pipes or sockets.</p>\n"}], "owner": {"reputation": 25, "user_id": 5153815, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/04b1a11ea26940c3491a6256b16d893f?s=128&d=identicon&r=PG&f=1", "display_name": "picklesrevil", "link": "https://stackoverflow.com/users/5153815/picklesrevil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 87, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1469127979, "creation_date": 1469031562, "last_edit_date": 1469127979, "question_id": 38485796, "link": "https://stackoverflow.com/questions/38485796/c-changes-made-to-text-file-are-not-noticed-when-the-program-reads-the-file", "title": "C - Changes made to text file are not noticed when the program reads the file", "body": "<p>I am making a local chat program where the program writes to the file, and then reads the file to see if others are editing the file. I have appending to the file down just fine. However, when the file is read, it only sees the file how it was when it was first opened.\nI am using <code>buffer = fopen(\"buffer.txt\", \"r+\");</code> to open the file.</p>\n\n<p>My reading algorithm looks like this:</p>\n\n<pre><code>void bufread(){\n    //READING BUFFER\n    fseek(buffer, -1-strlen(nick), SEEK_END);\n    fgets(readbuf, 0x5FF, buffer);\n    removeChar(readbuf, '\\n');\n    if (strcmp(readbuf, nick) == 0 )\n        ;\n    else{\n        i = 0;\n        strcpy(prevbuf, globalline);\n        while(c != '\\n'){\n            fseek(buffer, -2, SEEK_CUR);\n            c = getc(buffer);\n            i++;\n        }\n        fgets(globalline, i, buffer);\n        printf(\"%s\\n\", globalline);\n    }\n}\n</code></pre>\n\n<p>How do I refresh the file so that it reads the newest version of the file everytime the function is called?</p>\n\n<p>EDIT: I figured it out.\nThe while loop only runs when c is not a newline, but it also stops when c is a newline. I did not reset c, so it stays a newline and thus the while loop doesn't execute.</p>\n"}, {"tags": ["java", "android", "c", "java-native-interface"], "comments": [{"owner": {"reputation": 77347, "user_id": 1631193, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c713494416ceac454d71c524e15f1c6?s=128&d=identicon&r=PG&f=1", "display_name": "Gabe Sechan", "link": "https://stackoverflow.com/users/1631193/gabe-sechan"}, "edited": false, "score": 2, "creation_date": 1469032519, "post_id": 38485749, "comment_id": 64374096, "body": "This code doesn&#39;t store a method object, this creates a new class.  So yes, the constructor will be called immediately.  You can save the method id of a constructor by finding the &lt;init&gt; method.  But creating the object will create it immediately."}, {"owner": {"reputation": 77347, "user_id": 1631193, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c713494416ceac454d71c524e15f1c6?s=128&d=identicon&r=PG&f=1", "display_name": "Gabe Sechan", "link": "https://stackoverflow.com/users/1631193/gabe-sechan"}, "edited": false, "score": 2, "creation_date": 1469032995, "post_id": 38485749, "comment_id": 64374369, "body": "The mid in NewObject should be the mid of the construtor of the object, not of some method on the object.  If you&#39;re passing any method other than the constructor there, you&#39;re doing it wrong.  And if you want to call a constructor via CallVoidMethod, you&#39;re also doing it wrong-  a constructor cannot be called as a method."}, {"owner": {"reputation": 245, "user_id": 3885972, "user_type": "registered", "accept_rate": 79, "profile_image": "https://graph.facebook.com/100007551270084/picture?type=large", "display_name": "Stephan GM", "link": "https://stackoverflow.com/users/3885972/stephan-gm"}, "reply_to_user": {"reputation": 77347, "user_id": 1631193, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c713494416ceac454d71c524e15f1c6?s=128&d=identicon&r=PG&f=1", "display_name": "Gabe Sechan", "link": "https://stackoverflow.com/users/1631193/gabe-sechan"}, "edited": false, "score": 0, "creation_date": 1469037683, "post_id": 38485749, "comment_id": 64377113, "body": "Perfect, thanks man"}], "answers": [{"tags": [], "owner": {"reputation": 245, "user_id": 3885972, "user_type": "registered", "accept_rate": 79, "profile_image": "https://graph.facebook.com/100007551270084/picture?type=large", "display_name": "Stephan GM", "link": "https://stackoverflow.com/users/3885972/stephan-gm"}, "is_accepted": true, "score": 0, "last_activity_date": 1469037586, "last_edit_date": 1469037586, "creation_date": 1469037259, "answer_id": 38487546, "question_id": 38485749, "link": "https://stackoverflow.com/questions/38485749/jni-method-object-called-on-creation/38487546#38487546", "title": "JNI method object called on creation", "body": "<p>Thanks to Gabe Sechan's comments I was able to figure it out:</p>\n\n<pre><code>jmethodID construct = (*newEnv)-&gt;GetMethodID(newEnv,cls,\"&lt;init&gt;\",\"()V\");\njobject obj = (*newEnv)-&gt;NewObject(newEnv, cls, construct);\n</code></pre>\n\n<p>Then I can call the method I want using:</p>\n\n<pre><code>(*newEnv)-&gt;CallVoidMethod(newEnv, obj, mid);\n</code></pre>\n"}], "owner": {"reputation": 245, "user_id": 3885972, "user_type": "registered", "accept_rate": 79, "profile_image": "https://graph.facebook.com/100007551270084/picture?type=large", "display_name": "Stephan GM", "link": "https://stackoverflow.com/users/3885972/stephan-gm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 38487546, "answer_count": 1, "score": 0, "last_activity_date": 1469037586, "creation_date": 1469031393, "question_id": 38485749, "link": "https://stackoverflow.com/questions/38485749/jni-method-object-called-on-creation", "title": "JNI method object called on creation", "body": "<p>Using JNI I am storing a reference to a Java method object (<code>obj</code>) in order to call it later from C:</p>\n\n<pre><code> jobject obj = (*newEnv)-&gt;NewObject(newEnv, cls, mid);\n</code></pre>\n\n<p>where <code>newEnv</code> is my environment, <code>cls</code> is my class ID and <code>mid</code> is my method ID.</p>\n\n<p>Everything works fine except that upon creating this object to be used as a reference later, it actually calls the method right away. </p>\n\n<p>I would like to just create the object for later and not call the method immediately.</p>\n"}, {"tags": ["c", "x86", "interrupt-handling", "apic"], "owner": {"reputation": 3401, "user_id": 493371, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/fbe8f1da5df445a2f492154dab872ad8?s=128&d=identicon&r=PG", "display_name": "RRR", "link": "https://stackoverflow.com/users/493371/rrr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 525, "favorite_count": 0, "answer_count": 0, "score": 5, "last_activity_date": 1469031145, "creation_date": 1469031145, "question_id": 38485665, "link": "https://stackoverflow.com/questions/38485665/intel-local-apic-spurious-interrupt", "title": "Intel Local APIC Spurious Interrupt", "body": "<p>I'm developing now a code snippet that should enable\\disable local APIC. I've seen in the Intel manual that I have to set a spurious interrupt vector prior to enabling LoAPIC. In the Intel Manual I see the following explanation:   </p>\n\n<blockquote>\n  <p>A special situation may occur when a processor raises its task priority to be greater than or equal to the level of the \n  interrupt for which the processor INTR signal is currently being asserted. If at the time the INTA cycle is issued, the \n  interrupt that was to be dispensed has become masked (programmed by software), the local APIC will deliver a \n  spurious-interrupt vector. Dispensing the spurious-interrupt vector does not affect the ISR, so the handler for this \n  vector should return without an EOI.\n  Blockquote</p>\n</blockquote>\n\n<p>Can anyone please help me to understand what conditions lead the local APIC to issue a spurious interrupt? </p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "edited": false, "score": 3, "creation_date": 1469030806, "post_id": 38485509, "comment_id": 64373091, "body": "Don&#39;t cast the result of <code>malloc</code>, and don&#39;t forget to check it for <code>NULL</code>."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 4, "creation_date": 1469031006, "post_id": 38485509, "comment_id": 64373222, "body": "<code>scanf(&quot;%f&quot;,&amp;A[i][j]);</code> use <code>%lf</code>for double --&gt; <code>scanf(&quot;%lf&quot;,&amp;A[i][j]);</code>"}, {"owner": {"reputation": 481, "user_id": 5916150, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c209005186a84dd1820b220d7b78527e?s=128&d=identicon&r=PG&f=1", "display_name": "Arif Burhan", "link": "https://stackoverflow.com/users/5916150/arif-burhan"}, "edited": false, "score": 0, "creation_date": 1469031122, "post_id": 38485509, "comment_id": 64373303, "body": "Possibly a better way is to have <i>double Array[d1][d2];</i> followed by *double *ArrayPointer=malloc(d1*d2*sizeof(double)); * , and proceed from there."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "edited": false, "score": 0, "creation_date": 1469032517, "post_id": 38485509, "comment_id": 64374095, "body": "@JonathonReinhart on modern systems, checking it for null guarantees nothingin particular."}, {"owner": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1469036158, "post_id": 38485509, "comment_id": 64376168, "body": "@n.m. Care to elaborate? Are you suggesting we stop checking <code>malloc</code> result for <code>NULL</code>?"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "edited": false, "score": 0, "creation_date": 1469078184, "post_id": 38485509, "comment_id": 64391174, "body": "@JonathonReinhart no, but one should know that such checks do not always catch the out-of-memory condition."}], "answers": [{"comments": [{"owner": {"reputation": 142870, "user_id": 8747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1ee0402d24625f555c25ea8511aad31?s=128&d=identicon&r=PG", "display_name": "Rob\u1d69", "link": "https://stackoverflow.com/users/8747/rob%e1%b5%a9"}, "edited": false, "score": 2, "creation_date": 1469031679, "post_id": 38485755, "comment_id": 64373637, "body": "You are absolutely correct w.r.t. <code>scanf()</code>. But, in <code>printf()</code>, <code>%f</code> is identical to <code>%lf</code>. Both accept a <code>double</code>."}], "tags": [], "owner": {"reputation": 4232, "user_id": 5281962, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a29ae5ecb74bea23afa60d940edc0282?s=128&d=identicon&r=PG&f=1", "display_name": "Cherubim", "link": "https://stackoverflow.com/users/5281962/cherubim"}, "is_accepted": true, "score": 1, "last_activity_date": 1469034821, "last_edit_date": 1495542154, "creation_date": 1469031428, "answer_id": 38485755, "question_id": 38485509, "link": "https://stackoverflow.com/questions/38485509/reading-the-input-to-a-two-dimensional-array-created-using-malloc/38485755#38485755", "title": "Reading the input to a two dimensional array created using malloc", "body": "<ul>\n<li><p>You are using the <strong>wrong format specifier</strong> for scanning a <code>double</code> type variable here :</p>\n\n<pre><code>scanf(\"%f\",&amp;A[i][j]);\n        ^ \n</code></pre></li>\n<li><p>The correct format specifier is <code>%lf</code>, so instead scan this way into the array :</p>\n\n<pre><code>scanf(\"%lf\",&amp;A[i][j]);\n</code></pre></li>\n</ul>\n\n<hr>\n\n<ul>\n<li>You need not use <code>%lf</code> while using <code>printf()</code> because as <a href=\"https://stackoverflow.com/users/8747/rob%E1%B5%A9\"><em>@Rob\u1d69</em></a> suggested in the <a href=\"https://stackoverflow.com/questions/38485509/reading-the-input-to-a-two-dimensional-array-created-using-malloc#comment64373637_38485755\"><em>comment</em></a> : </li>\n</ul>\n\n<blockquote>\n  <p>in <code>printf()</code>, <code>%f</code> is identical to <code>%lf</code>. Both accept a <code>double</code></p>\n</blockquote>\n\n<p>to know more, see this : <a href=\"https://stackoverflow.com/questions/210590/why-does-scanf-need-lf-for-doubles-when-printf-is-okay-with-just-f\"><em>click</em></a></p>\n\n<hr>\n\n<ul>\n<li><p>further, don't use <code>main()</code> as it is <strong>not a valid signature for <code>main()</code></strong>, instead use <code>int main(void)</code>,because in standard C, the only valid signatures for main are:</p>\n\n<pre><code>int main(void) //when arguments are not required\n</code></pre></li>\n<li><p>And also,</p>\n\n<p>int main(int argc, char **argv) //when you require to send arguments</p></li>\n</ul>\n\n<p>to know more, see this : <a href=\"https://stackoverflow.com/a/18928287/5281962\"><em>click</em></a></p>\n\n<hr>\n\n<ul>\n<li><p>And always make sure to <strong>free the malloced memory</strong> at the end</p>\n\n<pre><code>  ..........  \n     printf(\"%lf\\t\",A[i][j]);\n    }printf(\"\\n\");\n  }\n\n  //freeing the malloced memory\n  for(i=0; i&lt;n; i++)\n  {\n      free(A[i]);\n  }\n  free(A);\n\n}//end of main\n</code></pre></li>\n</ul>\n\n<hr>\n\n<p>Making above changes, your <code>main()</code> function would be :</p>\n\n<pre><code>int main(void)\n{\n    int i,j;\n    int n=3;\n\n    double** A= Allocate(n,n);\n\n    for(i=0;i&lt;=n-1;i++)\n    {\n        for(j=0;j&lt;=n-1;j++)\n        {\n            scanf(\"%lf\",&amp;A[i][j]);\n        }\n    }\n\n    for(i=0;i&lt;=n-1;i++)\n    {\n        for(j=0;j&lt;=n-1;j++)\n        {\n             printf(\"%f\\t\",A[i][j]);\n        }\n        printf(\"\\n\");\n     }\n\n      for(i=0; i&lt;n; i++)\n      {\n          free(A[i]);\n      }\n      free(A);\n }\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 6613318, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-3JhgaF5AjgM/AAAAAAAAAAI/AAAAAAAAABs/hrCvHgySiJQ/photo.jpg?sz=128", "display_name": "Tilak Mallikarjun", "link": "https://stackoverflow.com/users/6613318/tilak-mallikarjun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 745, "favorite_count": 0, "accepted_answer_id": 38485755, "answer_count": 1, "score": 0, "last_activity_date": 1469035948, "creation_date": 1469030685, "last_edit_date": 1495539857, "question_id": 38485509, "link": "https://stackoverflow.com/questions/38485509/reading-the-input-to-a-two-dimensional-array-created-using-malloc", "title": "Reading the input to a two dimensional array created using malloc", "body": "<p>`Dear friends,\nI was trying to  define  a 2-D array named A using a dummy variable m through malloc.The variable A has been initialized to 0.\nIt is expected that new values get assigned to the matrix after the run .But that doesn't happen here.I would like to understand the correct way of doing this.I also tried method described in <a href=\"https://stackoverflow.com/questions/22508535/dynamic-memory-allocation-in-2d-array-and-using-scanf\">dynamic memory allocation in 2d array and using scanf</a> and also avoided casting malloc.\nHere is the code</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;math.h&gt;\n#include&lt;conio.h&gt;\n#include&lt;stdlib.h&gt;\ndouble** Allocate(int d1,int d2);\ndouble** Allocate(int d1,int d2)\n{  \n  double **m;\n  int i,j;\n  m = (double**)malloc(sizeof(double*)*d1);  \n  for(i=0;i&lt;d1;i++)\n  {\n    m[i]=(double*)malloc(sizeof(double)*d2);\n  }\n  for(i=0;i&lt;d1;i++)\n  {\n    for(j=0;j&lt;d2;j++)\n    {\n        m[i][j]=0.0;\n    }\n  }\n  return m;\n }\n main()\n{\nint i,j;\nint n=3;\nfloat x[n],y[n];\ndouble** A= Allocate(n,n);  \n    for(i=0;i&lt;=n-1;i++)\n   {\n    for(j=0;j&lt;=n-1;j++)\n    {\n     scanf(\"%f\",&amp;A[i][j]);\n    }\n  }\n  for(i=0;i&lt;=n-1;i++)\n   {\n    for(j=0;j&lt;=n-1;j++)\n    {\n     printf(\"%f\\t\",A[i][j]);\n    }printf(\"\\n\");\n  }\n }\n</code></pre>\n"}, {"tags": ["c", "hash", "struct"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 3, "creation_date": 1469030747, "post_id": 38485502, "comment_id": 64373048, "body": "<code>reinterpret_sol = (unsigned short*)&amp;_sol;</code> - Are you sure about <code>&amp;</code>? In any case looks like breaking the <i>strict aliasing</i> rule.."}, {"owner": {"reputation": 149, "user_id": 5363550, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-hoLlgAqOXCM/AAAAAAAAAAI/AAAAAAAAAPw/WUxTMfvC6nI/photo.jpg?sz=128", "display_name": "Anirban Mandal", "link": "https://stackoverflow.com/users/5363550/anirban-mandal"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1469030899, "post_id": 38485502, "comment_id": 64373153, "body": "Oh, thank you very much. I tried for hours what was wrong with the code, and you figured it out in less than a min :)"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1469030919, "post_id": 38485502, "comment_id": 64373162, "body": "&quot; Is there a better way to implement a hash function for a struct?&quot; Yes, but it depends on hashing goals: which are not yet stated."}, {"owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 1, "creation_date": 1469031039, "post_id": 38485502, "comment_id": 64373245, "body": "Even if you fix the <code>&amp;</code> and the strict aliasing violation, this looks like you could easily end up hashing the padding inside a struct. Also, simple addition is a pretty poor way to mix the <code>c</code> values."}, {"owner": {"reputation": 149, "user_id": 5363550, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-hoLlgAqOXCM/AAAAAAAAAAI/AAAAAAAAAPw/WUxTMfvC6nI/photo.jpg?sz=128", "display_name": "Anirban Mandal", "link": "https://stackoverflow.com/users/5363550/anirban-mandal"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1469031198, "post_id": 38485502, "comment_id": 64373358, "body": "@chux I wish to store in a simple manner that I have previously obtained, so I need more all less a bijection from the set of integers to the set of solutions."}, {"owner": {"reputation": 149, "user_id": 5363550, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-hoLlgAqOXCM/AAAAAAAAAAI/AAAAAAAAAPw/WUxTMfvC6nI/photo.jpg?sz=128", "display_name": "Anirban Mandal", "link": "https://stackoverflow.com/users/5363550/anirban-mandal"}, "reply_to_user": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 0, "creation_date": 1469031220, "post_id": 38485502, "comment_id": 64373372, "body": "@user2357112 Yes you&#39;re correct. I&#39;ll use a better hash function."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 0, "creation_date": 1469031250, "post_id": 38485502, "comment_id": 64373383, "body": "@user2357112 hashing the padding bytes are not necessarily a problem, if consistent. Though I can&#39;t find a reference regarding the <i>values</i> of the padding bytes.."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1469031359, "post_id": 38485502, "comment_id": 64373448, "body": "Isn&#39;t <i>bijection</i> attempting a one-to-one relationship, whereas hashing is a many-to-one?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1469031443, "post_id": 38485502, "comment_id": 64373502, "body": "So perhaps you want a <i>compression</i>, not <i>hashing</i>?"}, {"owner": {"reputation": 149, "user_id": 5363550, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-hoLlgAqOXCM/AAAAAAAAAAI/AAAAAAAAAPw/WUxTMfvC6nI/photo.jpg?sz=128", "display_name": "Anirban Mandal", "link": "https://stackoverflow.com/users/5363550/anirban-mandal"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1469031479, "post_id": 38485502, "comment_id": 64373520, "body": "@chux Yes, that is correct. A few collisions don&#39;t matter to me. I wish that the chances of two different solutions having the same hash value are as low as possible."}, {"owner": {"reputation": 149, "user_id": 5363550, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-hoLlgAqOXCM/AAAAAAAAAAI/AAAAAAAAAPw/WUxTMfvC6nI/photo.jpg?sz=128", "display_name": "Anirban Mandal", "link": "https://stackoverflow.com/users/5363550/anirban-mandal"}, "edited": false, "score": 0, "creation_date": 1469031541, "post_id": 38485502, "comment_id": 64373555, "body": "@EugeneSh.Yes, that is correct."}, {"owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1469031543, "post_id": 38485502, "comment_id": 64373556, "body": "@EugeneSh.: <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.2.6.1p6\" rel=\"nofollow noreferrer\">C11 final draft, section 6.2.6.1, part 6</a>: &quot;When a value is stored in an object of structure or union type, including in a member object, the bytes of the object representation that correspond to any padding bytes take unspecified values.&quot; The padding bytes aren&#39;t consistent."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 0, "creation_date": 1469031586, "post_id": 38485502, "comment_id": 64373572, "body": "@user2357112 Yep. That&#39;s what I was looking for. Thanks, it is useful."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1469031782, "post_id": 38485502, "comment_id": 64373693, "body": "For reference (to help with decision): <a href=\"http://stackoverflow.com/questions/996843/when-is-crc-more-appropriate-to-use-than-md5-sha1\" title=\"when is crc more appropriate to use than md5 sha1\">stackoverflow.com/questions/996843/&hellip;</a>"}, {"owner": {"reputation": 149, "user_id": 5363550, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-hoLlgAqOXCM/AAAAAAAAAAI/AAAAAAAAAPw/WUxTMfvC6nI/photo.jpg?sz=128", "display_name": "Anirban Mandal", "link": "https://stackoverflow.com/users/5363550/anirban-mandal"}, "edited": false, "score": 0, "creation_date": 1469031970, "post_id": 38485502, "comment_id": 64373787, "body": "@Everyone Thank you very much for your help."}], "answers": [{"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1469031075, "last_edit_date": 1495540737, "creation_date": 1469031075, "answer_id": 38485642, "question_id": 38485502, "link": "https://stackoverflow.com/questions/38485502/computing-hash-value-of-a-struct-in-c/38485642#38485642", "title": "Computing hash value of a struct in C", "body": "<p>Casting hid the problem as pointed out by <a href=\"https://stackoverflow.com/questions/38485502/computing-hash-value-of-a-struct-in-c#comment64373048_38485502\">@Eugene Sh.</a></p>\n\n<pre><code>// reinterpret_sol = (unsigned short*)&amp;_sol;\nreinterpret_sol = (unsigned short*) _sol;\n</code></pre>\n"}], "owner": {"reputation": 149, "user_id": 5363550, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-hoLlgAqOXCM/AAAAAAAAAAI/AAAAAAAAAPw/WUxTMfvC6nI/photo.jpg?sz=128", "display_name": "Anirban Mandal", "link": "https://stackoverflow.com/users/5363550/anirban-mandal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 603, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1469031075, "creation_date": 1469030661, "question_id": 38485502, "link": "https://stackoverflow.com/questions/38485502/computing-hash-value-of-a-struct-in-c", "title": "Computing hash value of a struct in C", "body": "<p>I have a struct defined in C as follows </p>\n\n<pre><code>typedef struct {\n    unsigned int size;\n    unsigned int pool_size;\n    route _routes[SIZE_OF_FLEET];\n    request _request_pool[SIZE_OF_PROBLEM];\n    /* stores which request is contained in which route */\n    unsigned int _request_map[SIZE_OF_PROBLEM];\n} solution;\n</code></pre>\n\n<p>I am trying to define a hash function for this struct as follows </p>\n\n<pre><code>unsigned long long solution_hash(solution const *_sol)\n{\n    unsigned long long hash = 0;\n    unsigned short c;\n    unsigned short *reinterpret_sol;\n    reinterpret_sol = (unsigned short*)&amp;_sol;\n    size_t size_ = sizeof(solution);\n    size_t elem_size_ = sizeof(unsigned short);\n    int len = (int)size_/elem_size_;\n\n    for (int i = 0; i &lt; len; i++) {\n        c = reinterpret_sol[i];\n        hash += c;\n    }\n    return hash;\n}\n</code></pre>\n\n<p>The problem is everytime I make a call to solution_hash function, the hash value of the same solution changes. Successive calls increment the value by 32 for the same solution.</p>\n\n<p>What is wrong with this code? Is there a better way to implement a hash function for a struct?</p>\n"}, {"tags": ["c", "ansi"], "comments": [{"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 1, "creation_date": 1469030242, "post_id": 38485287, "comment_id": 64372659, "body": "<code>int month, day;</code>.. <code>month_day(year, yearday, &amp;month, &amp;day);</code>"}, {"owner": {"reputation": 4888, "user_id": 5785362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a786fd81952576dc07942023bf8830b?s=128&d=identicon&r=PG", "display_name": "tofro", "link": "https://stackoverflow.com/users/5785362/tofro"}, "edited": false, "score": 0, "creation_date": 1469035651, "post_id": 38485287, "comment_id": 64375877, "body": "<code>*pmonth = i</code> is <b>not</b> a pointer assignment."}, {"owner": {"reputation": 5662, "user_id": 5781248, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/712de4f2f811d1a400d3311c9cdd5836?s=128&d=identicon&r=PG&f=1", "display_name": "J.J. Hakala", "link": "https://stackoverflow.com/users/5781248/j-j-hakala"}, "edited": false, "score": 0, "creation_date": 1469041363, "post_id": 38485287, "comment_id": 64379254, "body": "Most compilers should issue warnings for the code in question, some by default. gcc and clang need for example <code>-Wall</code> option. Then the question would hopefully be about what to do about <code>warning: &#39;month&#39; is used uninitialized in this function</code> warning"}], "answers": [{"comments": [{"owner": {"reputation": 26959, "user_id": 1294207, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Inny3.jpg?s=128&g=1", "display_name": "Fantastic Mr Fox", "link": "https://stackoverflow.com/users/1294207/fantastic-mr-fox"}, "edited": false, "score": 0, "creation_date": 1469030584, "post_id": 38485312, "comment_id": 64372908, "body": "Nice answer, Plus 1."}, {"owner": {"reputation": 45, "user_id": 6614509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ac455dba2de7f2d08e93cafcebdb99b?s=128&d=identicon&r=PG&f=1", "display_name": "Slavvio", "link": "https://stackoverflow.com/users/6614509/slavvio"}, "edited": false, "score": 0, "creation_date": 1469032950, "post_id": 38485312, "comment_id": 64374336, "body": "I see, thank you. The problem really is my unfamiliarity with pointers."}, {"owner": {"reputation": 748, "user_id": 6256059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a0ddcf115c1b5f22ab58a4d48260068?s=128&d=identicon&r=PG&f=1", "display_name": "blatinox", "link": "https://stackoverflow.com/users/6256059/blatinox"}, "reply_to_user": {"reputation": 45, "user_id": 6614509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ac455dba2de7f2d08e93cafcebdb99b?s=128&d=identicon&r=PG&f=1", "display_name": "Slavvio", "link": "https://stackoverflow.com/users/6614509/slavvio"}, "edited": false, "score": 0, "creation_date": 1469037824, "post_id": 38485312, "comment_id": 64377200, "body": "@Slavvio: you&#39;re welcome :). In my opinion pointers is the hardest concept to understand. It will be easier with more practice ;)"}], "tags": [], "owner": {"reputation": 748, "user_id": 6256059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a0ddcf115c1b5f22ab58a4d48260068?s=128&d=identicon&r=PG&f=1", "display_name": "blatinox", "link": "https://stackoverflow.com/users/6256059/blatinox"}, "is_accepted": true, "score": 2, "last_activity_date": 1469030787, "last_edit_date": 1469030787, "creation_date": 1469030174, "answer_id": 38485312, "question_id": 38485287, "link": "https://stackoverflow.com/questions/38485287/c-program-crashes-because-of-pointer-assignment/38485312#38485312", "title": "C program crashes because of pointer assignment", "body": "<p>The pointer <code>pmonth</code> is not initialized. So you <strong>should not dereference it</strong>. You should assign a valid address to your pointer. To do this you can either assign a variable address with the <code>&amp;</code> operator or call <code>malloc(1)</code>.</p>\n\n<p>Since you don't seems to need pointers in your main function, your code should be:</p>\n\n<pre><code>int main(int argc, char *argv[]){\n    int year = 1994;\n    int month;\n    int yearday = 288;\n    int day;\n    month_day(year, yearday, &amp;month, &amp;day);\n    printf(\"Month = %d, day = %d\", month, day);\n    return 1;\n}\n</code></pre>\n\n<p>In this code, we give to <code>pmonth</code> and <code>pday</code> the addresses of variables <code>month</code> and <code>day</code>. These variables exist in this context so their addresses are valid. This way, <code>pmonth</code> and <code>pday</code> points to valid memory.</p>\n\n<p>If you really need pointers in your main function, call <code>malloc(1)</code> to allocate memory to your program and store the address of this memory chunk into your pointer.</p>\n"}, {"tags": [], "owner": {"reputation": 26959, "user_id": 1294207, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Inny3.jpg?s=128&g=1", "display_name": "Fantastic Mr Fox", "link": "https://stackoverflow.com/users/1294207/fantastic-mr-fox"}, "is_accepted": false, "score": 1, "last_activity_date": 1469030275, "creation_date": 1469030275, "answer_id": 38485347, "question_id": 38485287, "link": "https://stackoverflow.com/questions/38485287/c-program-crashes-because-of-pointer-assignment/38485347#38485347", "title": "C program crashes because of pointer assignment", "body": "<p>This is because you never create any memory for <code>pmonth</code> to point to. You need to point any pointer at some memory for it to edit, if you  do not and the pointer is uninitialized or <code>NULL</code> then you have <strong>Undefined Behavior</strong>. Undefined behaviour means anything could happen, including the program crashing or stealing your car. </p>\n\n<p>Something like this would suffice:</p>\n\n<pre><code>int month; // Some actual memory.\nint *pmonth = &amp;month; // pmonth now points to something real.\n</code></pre>\n\n<p>But then again, the point of the <code>month_day</code> function is to provide output parameters, so even this would suffice:</p>\n\n<pre><code>int month, day;\n\nmonth_day( ..., &amp;month, &amp;day)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7405, "user_id": 5735010, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/znAEN.jpg?s=128&g=1", "display_name": "abhiarora", "link": "https://stackoverflow.com/users/5735010/abhiarora"}, "is_accepted": false, "score": 0, "last_activity_date": 1469031918, "last_edit_date": 1469031918, "creation_date": 1469031392, "answer_id": 38485748, "question_id": 38485287, "link": "https://stackoverflow.com/questions/38485287/c-program-crashes-because-of-pointer-assignment/38485748#38485748", "title": "C program crashes because of pointer assignment", "body": "<p><strong>Never use an uninitialized pointer or dereference a null pointer</strong>, what you have done is undefined behaviour, anything in the world could happen.</p>\n\n<p>You have defined a function <code>void month_day(int year, int yearday, int *pmonth, int *pday)</code> which requires two pointers to int (<code>pmonth and pday</code>) to be passed to it. You have passed pointer to int correctly and compiler has compiled your program successfully but these pointers doesn't point to correct memory addresses. When you access the address being pointed by your un-initialized pointer (which may be invalid or doesn't belong to you), you get <code>Segmentation Fault</code>. </p>\n\n<p>Segmentation fault is a specific kind of error caused by accessing memory that \u201cdoes not belong to you.\u201d It\u2019s a helper mechanism that keeps you from corrupting the memory and introducing hard-to-debug memory bugs. </p>\n\n<p>There are many ways to get a segfault. A common way to get a segfault is to dereference a null pointer:</p>\n\n<pre><code>int *p = NULL;\n*p = 1;\n</code></pre>\n\n<p>To solve your problem, your code should be like the one given below</p>\n\n<pre><code>int main(int argc, char *argv[])\n{\n    int year = 1994;\n    int month;\n    int yearday = 288;\n    int day;\n\n    month_day(year, yearday, &amp;month, &amp;day);\n    printf(\"Month = %d, day = %d\", month, day);\n\n    return 0;\n}\n</code></pre>\n\n<p>Or</p>\n\n<p>You can call <code>malloc</code> function to allocate memory dynamically and assign address returned by <code>malloc</code> function to your pointer variables. <code>Remember, to call free function to release memory allocated dynamically when you no longer need the memory</code>.</p>\n"}], "owner": {"reputation": 45, "user_id": 6614509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ac455dba2de7f2d08e93cafcebdb99b?s=128&d=identicon&r=PG&f=1", "display_name": "Slavvio", "link": "https://stackoverflow.com/users/6614509/slavvio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "accepted_answer_id": 38485312, "answer_count": 3, "score": 0, "last_activity_date": 1469033001, "creation_date": 1469030100, "last_edit_date": 1469033001, "question_id": 38485287, "link": "https://stackoverflow.com/questions/38485287/c-program-crashes-because-of-pointer-assignment", "title": "C program crashes because of pointer assignment", "body": "<p>I'm writing a program for one of the exercises in the ANSI C book, and the program crashes when I reach this line: </p>\n\n<pre><code>*pmonth = i;\n</code></pre>\n\n<p>in function month_day.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid month_day(int year, int yearday, int *pmonth, int *pday);\n\nint main(int argc, char *argv[]){\n    int year = 1994;\n    int *month;\n    int yearday = 288;\n    int *day;\n    month_day(year, yearday, month, day);\n    printf(\"Month = %d, day = %d\", *month, *day);\n    return 1;\n}\n\nstatic char daytab[2][14] = {\n        {0, 31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31},\n        {0, 31, 29, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31}\n};\n\nvoid month_day(int year, int yearday, int *pmonth, int *pday){\n    int i, leap;\n\n    leap = (year%4 == 0 &amp;&amp; year%100 != 0) || year%400 == 0;\n    char *p = &amp;daytab[leap][1];\n    for(i = 1; yearday&gt; (int) *p; i++){\n        yearday -= *p++;\n    }\n    *pmonth = i; /*CRASHES HERE*/\n    *pday = yearday;\n}\n</code></pre>\n\n<p>Any ideas why this is happening? I'm relatively new to pointers, so i could easily be making a stupid mistake. Thanks in advance.</p>\n\n<p><em>EDIT</em> Thank you guys for your answers and patience, trying to get the hang of pointers.</p>\n"}, {"tags": ["c", "arrays", "types", "integer"], "comments": [{"owner": {"reputation": 1283, "user_id": 3897333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51d784367ca82572dea0a2c43217770b?s=128&d=identicon&r=PG", "display_name": "Paul Stelian", "link": "https://stackoverflow.com/users/3897333/paul-stelian"}, "edited": false, "score": 3, "creation_date": 1469029409, "post_id": 38485015, "comment_id": 64372081, "body": "I think you may want to learn about malloc/realloc/free."}, {"owner": {"reputation": 27385, "user_id": 1382251, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/17622c39e8ead537a0944c767551b2fe?s=128&d=identicon&r=PG", "display_name": "barak manos", "link": "https://stackoverflow.com/users/1382251/barak-manos"}, "edited": false, "score": 1, "creation_date": 1469029490, "post_id": 38485015, "comment_id": 64372141, "body": "How about <code>int32_t* array = malloc(sizeof(int32_t)*N);</code>?"}, {"owner": {"reputation": 268334, "user_id": 4909087, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/LmD3e.png?s=128&g=1", "display_name": "cs95", "link": "https://stackoverflow.com/users/4909087/cs95"}, "edited": false, "score": 2, "creation_date": 1469029526, "post_id": 38485015, "comment_id": 64372165, "body": "I believe <code>int32_t* array = malloc(sizeof(*array) * N);</code> is better."}, {"owner": {"reputation": 5676, "user_id": 5023438, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uvlov.jpg?s=128&g=1", "display_name": "alter igel", "link": "https://stackoverflow.com/users/5023438/alter-igel"}, "reply_to_user": {"reputation": 268334, "user_id": 4909087, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/LmD3e.png?s=128&g=1", "display_name": "cs95", "link": "https://stackoverflow.com/users/4909087/cs95"}, "edited": false, "score": 1, "creation_date": 1469030484, "post_id": 38485015, "comment_id": 64372830, "body": "@Shiva a very interesting way to encourage type safety, I have not seen that before"}, {"owner": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "edited": false, "score": 0, "creation_date": 1469034545, "post_id": 38485015, "comment_id": 64375268, "body": "Actually you should use <a href=\"http://undeadly.org/cgi?action=article&amp;sid=20060330071917\" rel=\"nofollow noreferrer\"><code>calloc</code></a> instead of multiplying."}, {"owner": {"reputation": 268334, "user_id": 4909087, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/LmD3e.png?s=128&g=1", "display_name": "cs95", "link": "https://stackoverflow.com/users/4909087/cs95"}, "reply_to_user": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "edited": false, "score": 0, "creation_date": 1469045580, "post_id": 38485015, "comment_id": 64381628, "body": "@Zulan: It depends on the application imo. With <code>calloc</code>, you have the extra overhead of setting each element to its default value. <code>malloc</code> is faster and preferable if you don&#39;t need that initialisation."}, {"owner": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "reply_to_user": {"reputation": 268334, "user_id": 4909087, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/LmD3e.png?s=128&g=1", "display_name": "cs95", "link": "https://stackoverflow.com/users/4909087/cs95"}, "edited": false, "score": 0, "creation_date": 1469052348, "post_id": 38485015, "comment_id": 64384742, "body": "@Shiva It&#39;s about the overflow, not the zero initialization. Also the zero initialization can and is optimized away by common implementation"}], "answers": [{"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": true, "score": 0, "last_activity_date": 1470345369, "creation_date": 1470345369, "answer_id": 38777532, "question_id": 38485015, "link": "https://stackoverflow.com/questions/38485015/store-integers-32-bit-in-array-which-type-c-programming/38777532#38777532", "title": "Store integers (32 bit) in array (which type? ) C programming", "body": "<blockquote>\n  <p>... which type of data should i use so that i can have an array of size lets say , <code>N</code> with 32 bit integers?</p>\n</blockquote>\n\n<pre><code>// The type of `p` is a pointer to a 32-bit signed integer.\nint32 *p;\n</code></pre>\n\n<blockquote>\n  <p>How can this be implemented?</p>\n</blockquote>\n\n<pre><code>// No need to use `int32_t` in the next line of code\n//              size of 1 element ---v-------v * v--- element count\np = /* no cast needed here */ malloc(sizeof *p * N);\nif (p == NULL) return Handle_Failure();\n\nfor (size_t i=0; i&lt;N; i++) {\n  // do something with p[i]\n  p[i] = 42;\n}\n\n// free when done\nfree(p);\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 6391700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d4b92c6f8fd1fec8928f9bad3d6c83d?s=128&d=identicon&r=PG&f=1", "display_name": "BillG", "link": "https://stackoverflow.com/users/6391700/billg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 422, "favorite_count": 0, "accepted_answer_id": 38777532, "answer_count": 1, "score": -1, "last_activity_date": 1470345369, "creation_date": 1469029359, "last_edit_date": 1469029427, "question_id": 38485015, "link": "https://stackoverflow.com/questions/38485015/store-integers-32-bit-in-array-which-type-c-programming", "title": "Store integers (32 bit) in array (which type? ) C programming", "body": "<p>I got 32 bit integers that i want to store them <strong><em>in a dynamically allocated array</em></strong> and then send this array to others processes (in MPI )  </p>\n\n<pre><code>   int32_t data;\n</code></pre>\n\n<p>I am confused ,which type of data should i use so that i can have an array of size lets say , <strong><em>N</em></strong> with 32 bit integers?\nHow can this be implemented?</p>\n"}, {"tags": ["c", "pointers", "memory"], "comments": [{"owner": {"reputation": 5856, "user_id": 1616488, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/aCLot.jpg?s=128&g=1", "display_name": "Wakan Tanka", "link": "https://stackoverflow.com/users/1616488/wakan-tanka"}, "reply_to_user": {"reputation": 6975, "user_id": 3121023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f52448806175b9aa66c86d40cf0829f1?s=128&d=identicon&r=PG&f=1", "display_name": "user3121023", "link": "https://stackoverflow.com/users/3121023/user3121023"}, "edited": false, "score": 0, "creation_date": 1469029268, "post_id": 38484891, "comment_id": 64371983, "body": "@user3121023 oh that was scholar mistake thanks. I&#39;ve deleted 2nd question not to be confused."}, {"owner": {"reputation": 5856, "user_id": 1616488, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/aCLot.jpg?s=128&g=1", "display_name": "Wakan Tanka", "link": "https://stackoverflow.com/users/1616488/wakan-tanka"}, "reply_to_user": {"reputation": 6975, "user_id": 3121023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f52448806175b9aa66c86d40cf0829f1?s=128&d=identicon&r=PG&f=1", "display_name": "user3121023", "link": "https://stackoverflow.com/users/3121023/user3121023"}, "edited": false, "score": 0, "creation_date": 1469029449, "post_id": 38484891, "comment_id": 64372111, "body": "Person who down voted me please specify why, so I can improve the question. Thanks"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1469029997, "post_id": 38484891, "comment_id": 64372483, "body": "Post is now more confusing as <a href=\"http://stackoverflow.com/a/38485137/2410359\">@Xaver</a> answered a part of the post deleted.  Suggest bringing it back for good etiquette."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1469030161, "post_id": 38484891, "comment_id": 64372596, "body": "None of the example attempt to modify what <code>p</code> points to.  So why ask &quot;Isn&#39;t <code>char* p = &quot;Hello&quot;;</code> also pointing to some unknown memory which is not allowed to write ...&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 819, "user_id": 1393899, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df3288575e7215c9075292e937a3e244?s=128&d=identicon&r=PG", "display_name": "Xaver", "link": "https://stackoverflow.com/users/1393899/xaver"}, "is_accepted": false, "score": 2, "last_activity_date": 1469029678, "creation_date": 1469029678, "answer_id": 38485137, "question_id": 38484891, "link": "https://stackoverflow.com/questions/38484891/why-declaration-of-pointer-points-to-unknown-memory-while-definition-is-not/38485137#38485137", "title": "Why declaration of pointer points to unknown memory while definition is not?", "body": "<p>The code</p>\n\n<pre><code>char* p = \"Hello\";\n</code></pre>\n\n<p>creates an array of six chars and sets them to <code>\"Hello\"</code> (the sixth char is the null-char). Then, it writes the memory address of this array to <code>p</code>. So <code>p</code> points to an initialized memory segment.</p>\n\n<p>Concerning your second example: <code>p</code> contains the memory address of the char array <code>\"Hello\"</code>. If you want <code>q</code> to contain the same memory address, you have to use the command</p>\n\n<pre><code>q = p;\n</code></pre>\n\n<p>In the code</p>\n\n<pre><code>q = &amp;p;\n</code></pre>\n\n<p>the types are incompatible, because <code>q</code> has type <code>char*</code>, whereas <code>&amp;p</code> has type <code>char**</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 5676, "user_id": 5023438, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uvlov.jpg?s=128&g=1", "display_name": "alter igel", "link": "https://stackoverflow.com/users/5023438/alter-igel"}, "edited": false, "score": 0, "creation_date": 1469031656, "post_id": 38485342, "comment_id": 64373621, "body": "Why the down vote? Please tell me where I&#39;ve gone wrong."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1469031689, "post_id": 38485342, "comment_id": 64373647, "body": "The type of string literals is not const."}], "tags": [], "owner": {"reputation": 5676, "user_id": 5023438, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uvlov.jpg?s=128&g=1", "display_name": "alter igel", "link": "https://stackoverflow.com/users/5023438/alter-igel"}, "is_accepted": false, "score": 1, "last_activity_date": 1469031737, "last_edit_date": 1469031737, "creation_date": 1469030264, "answer_id": 38485342, "question_id": 38484891, "link": "https://stackoverflow.com/questions/38484891/why-declaration-of-pointer-points-to-unknown-memory-while-definition-is-not/38485342#38485342", "title": "Why declaration of pointer points to unknown memory while definition is not?", "body": "<p>When you write <code>char* p = \"Hello\";</code>, the compiler will create a <code>char</code> array in a part of memory that is read-only at runtime, filled as <code>{'H', 'e', 'l', 'l', 'o', '\\0'}</code>. The pointer <code>p</code> is filled with the address of this array. So the address is valid, it can be <em>read</em> from safely but not written to, it can be passed as a readable string to C's string functions, and you never need to worry about <code>malloc</code>ing and <code>free</code>ing string literals because they represent static arrays.</p>\n"}, {"comments": [{"owner": {"reputation": 5856, "user_id": 1616488, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/aCLot.jpg?s=128&g=1", "display_name": "Wakan Tanka", "link": "https://stackoverflow.com/users/1616488/wakan-tanka"}, "edited": false, "score": 0, "creation_date": 1469049133, "post_id": 38485395, "comment_id": 64383439, "body": "What is string litteral?"}], "tags": [], "owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "is_accepted": false, "score": 1, "last_activity_date": 1469032516, "last_edit_date": 1469032516, "creation_date": 1469030372, "answer_id": 38485395, "question_id": 38484891, "link": "https://stackoverflow.com/questions/38484891/why-declaration-of-pointer-points-to-unknown-memory-while-definition-is-not/38485395#38485395", "title": "Why declaration of pointer points to unknown memory while definition is not?", "body": "<p>When you write <code>char *p = \"Hello\";</code>, the compiler internally creates a <code>const char[6]</code> to hold the string litteral, and then copy its address to <code>p</code>. Unfortunately, the type of a string litteral is not const, so you do not get any warning telling you that you are dropping a <code>const</code> attribute, but the string litteral shall not be modified.</p>\n\n<p>So <code>p</code> point to a well defined memory zone and you can safely read from it for example with <code>printf(\"%s\\n\", p);</code></p>\n\n<p>The problem is that the string litteral shall not be modified, and trying to use the pointer for writing like in <code>p[1] = 'a';</code> invokes undefined behaviour. In common implementations, the compiler actually uses a read-only segment to store string litterals and you get a memory violation or segment violation error if you try to overwrite it.</p>\n\n<p>But it is not <em>unknown</em> memory simply <em>read-only</em> one.</p>\n"}], "owner": {"reputation": 5856, "user_id": 1616488, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/aCLot.jpg?s=128&g=1", "display_name": "Wakan Tanka", "link": "https://stackoverflow.com/users/1616488/wakan-tanka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1538731101, "creation_date": 1469029013, "last_edit_date": 1538731101, "question_id": 38484891, "link": "https://stackoverflow.com/questions/38484891/why-declaration-of-pointer-points-to-unknown-memory-while-definition-is-not", "title": "Why declaration of pointer points to unknown memory while definition is not?", "body": "<p>I understand that following code returns segmentation fault because it tries to write to the part of memory where <code>q</code> points to (some random address) and this part of memory is not allowed to write by given process:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint main(){\n  char* p = \"Hello\";\n  char* q;\n\n  strcpy(q, p);\n  printf(\"%s\\n\", q);\n}\n</code></pre>\n\n<p>I also understand that it can be easily fixed by dynamically allocating appropriate amount of memory and pointing <code>q</code> to this memory, so <code>p</code> content can be safely copied to <code>q</code>:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint main(){\n  char* p = \"Hello\";\n  char* q = (char*)malloc(6*sizeof(char));\n\n  strcpy(q, p);\n  printf(\"%s\\n\", q);\n}\n</code></pre>\n\n<p>But why following example is working?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(){\n  char* p = \"Hello\";\n  printf(\"%s\\n\", p);\n}\n</code></pre>\n\n<p>Isn't <code>char* p = \"Hello\";</code> also pointing to some unknown memory which is not allowed to write by given process?</p>\n"}, {"tags": ["c", "gcc", "linker"], "answers": [{"tags": [], "owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "is_accepted": false, "score": 0, "last_activity_date": 1469028599, "creation_date": 1469028599, "answer_id": 38484731, "question_id": 38484664, "link": "https://stackoverflow.com/questions/38484664/how-can-main-o-not-be-created-last-during-compilation-of-c-project/38484731#38484731", "title": "How can main.o not be created last during compilation of C project?", "body": "<p>The other files contain functions called by <code>main</code> directly or indirectly. Without them, <code>make</code> can't function.</p>\n"}, {"comments": [{"owner": {"reputation": 1168, "user_id": 1893768, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/dce74d5edb9d2f2598ce0925877209ca?s=128&d=identicon&r=PG", "display_name": "Ewan Delanoy", "link": "https://stackoverflow.com/users/1893768/ewan-delanoy"}, "edited": false, "score": 0, "creation_date": 1469029013, "post_id": 38484737, "comment_id": 64371800, "body": "Strictly speaking the main function is not contained in any object file in this situation, is it ?"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 1168, "user_id": 1893768, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/dce74d5edb9d2f2598ce0925877209ca?s=128&d=identicon&r=PG", "display_name": "Ewan Delanoy", "link": "https://stackoverflow.com/users/1893768/ewan-delanoy"}, "edited": false, "score": 0, "creation_date": 1469029180, "post_id": 38484737, "comment_id": 64371915, "body": "@EwanDelanoy What I mean is that while in your case, the <code>main</code> function resides in main.o, that doesn&#39;t mean a file of that name will always contain <code>main</code> in the general case.  There&#39;s nothing special about the name of the object file."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 3, "last_activity_date": 1469028606, "creation_date": 1469028606, "answer_id": 38484737, "question_id": 38484664, "link": "https://stackoverflow.com/questions/38484664/how-can-main-o-not-be-created-last-during-compilation-of-c-project/38484737#38484737", "title": "How can main.o not be created last during compilation of C project?", "body": "<p>The order in which object files are specified in the gcc command line are irrelevant.  All are linked into an executable, and that executable knows where the <code>main</code> function lives.  </p>\n\n<p>When all object files are read in, the linker ensures that the <code>main</code> function exists along with any functions called directly or indirectly from <code>main</code>.</p>\n\n<p>Just because an object file is called <code>main.o</code> doesn't necessarily mean that the <code>main</code> function lives in that file.</p>\n"}], "owner": {"reputation": 1168, "user_id": 1893768, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/dce74d5edb9d2f2598ce0925877209ca?s=128&d=identicon&r=PG", "display_name": "Ewan Delanoy", "link": "https://stackoverflow.com/users/1893768/ewan-delanoy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 38484737, "answer_count": 2, "score": 0, "last_activity_date": 1469028606, "creation_date": 1469028462, "question_id": 38484664, "link": "https://stackoverflow.com/questions/38484664/how-can-main-o-not-be-created-last-during-compilation-of-c-project", "title": "How can main.o not be created last during compilation of C project?", "body": "<p>I've watched the installation of GNU make on my computer wth some\nattention. It is a relatively simple compilation : it creates successively\nan .o file from each .c file, then creates an executable by linking\nall the .o files, in the order in which they were created :</p>\n\n<pre><code>gcc  -g -O2 -rdynamic  -o make ar.o arscan.o commands.o default.o dir.o expand.o \nfile.o function.o getopt.o getopt1.o guile.o implicit.o job.o load.o loadapi.o \nmain.o misc.o output.o read.o remake.o rule.o signame.o strcache.o variable.o \nversion.o vpath.o hash.o remote-stub.o glob/libglob.a\n</code></pre>\n\n<p>What I don't get here is the following : how can  main.o\nnot appear last on this list ? Because using the executable on\nsome arguments is equivalent to calling function main in \nmain.c on those arguments, so anything created after main.o\nseems useless. </p>\n"}, {"tags": ["c", "linux", "assembly", "cpuid"], "comments": [{"owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 5, "creation_date": 1469029516, "post_id": 38484616, "comment_id": 64372160, "body": "Inline asm is already gcc specific so you might as well use the <a href=\"http://stackoverflow.com/a/14266932/547981\">compiler builtin</a> instead. Other compilers also have similar builtins."}, {"owner": {"reputation": 2790, "user_id": 5137782, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/b8bQ8.jpg?s=128&g=1", "display_name": "8protons", "link": "https://stackoverflow.com/users/5137782/8protons"}, "reply_to_user": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 0, "creation_date": 1469030240, "post_id": 38484616, "comment_id": 64372658, "body": "@Jester Oh wow, that&#39;s amazing. Thank you!!"}, {"owner": {"reputation": 6093, "user_id": 2189500, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/109f747845a9ce762a1fff72eb8cf6f3?s=128&d=identicon&r=PG", "display_name": "David Wohlferd", "link": "https://stackoverflow.com/users/2189500/david-wohlferd"}, "edited": false, "score": 1, "creation_date": 1469037945, "post_id": 38484616, "comment_id": 64377283, "body": "I&#39;m not sure &#39;builtin&#39; is the right term here, since that normally refers to a function builtin to the compiler itself.  cpuid.h just creates a define which is the inline asm.  Also, unlike <code>native_cpuid</code> routine above, the <code>__cpuid</code> define doesn&#39;t allow you to input ecx."}], "answers": [{"comments": [{"owner": {"reputation": 2790, "user_id": 5137782, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/b8bQ8.jpg?s=128&g=1", "display_name": "8protons", "link": "https://stackoverflow.com/users/5137782/8protons"}, "edited": false, "score": 0, "creation_date": 1469113359, "post_id": 38500520, "comment_id": 64413581, "body": "Thank you so much, Mr. Cordes. I&#39;ve used assembly for an atmega128 and C of course for Linux OS but I&#39;ve never actually combined the two- it&#39;s all been a bit intimidating haha My concern with the <code>cpuid.h</code> includes was the fact that <code>__get_cpuid()</code> isn&#39;t portable, if I understand it correctly. So I was looking for something more reliable. Thank you so much for your answer which touched on the two solutions I posted; I learned a lot"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 2790, "user_id": 5137782, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/b8bQ8.jpg?s=128&g=1", "display_name": "8protons", "link": "https://stackoverflow.com/users/5137782/8protons"}, "edited": false, "score": 2, "creation_date": 1469133161, "post_id": 38500520, "comment_id": 64424712, "body": "@8protons: I think <code>cpuid.h</code> is about as portable as GNU C inline-asm syntax.  Both are supported in any GNU C compiler (gcc, clang, icc, some others), and not otherwise.  Actually <code>cpuid.h</code> might be more recent and maybe not always supported, so IDK."}, {"owner": {"reputation": 221394, "user_id": 366904, "user_type": "moderator", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3f8912af19fe86b7b34a0b011a962460?s=128&d=identicon&r=PG", "display_name": "Cody Gray", "link": "https://stackoverflow.com/users/366904/cody-gray"}, "reply_to_user": {"reputation": 2790, "user_id": 5137782, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/b8bQ8.jpg?s=128&g=1", "display_name": "8protons", "link": "https://stackoverflow.com/users/5137782/8protons"}, "edited": false, "score": 0, "creation_date": 1469489453, "post_id": 38500520, "comment_id": 64546932, "body": "CPUID is obviously not going to be <i>portable</i>, @8protons, as it is x86-specific. What exactly are your &quot;portability&quot; and &quot;reliability&quot; concerns?"}, {"owner": {"reputation": 2790, "user_id": 5137782, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/b8bQ8.jpg?s=128&g=1", "display_name": "8protons", "link": "https://stackoverflow.com/users/5137782/8protons"}, "reply_to_user": {"reputation": 221394, "user_id": 366904, "user_type": "moderator", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3f8912af19fe86b7b34a0b011a962460?s=128&d=identicon&r=PG", "display_name": "Cody Gray", "link": "https://stackoverflow.com/users/366904/cody-gray"}, "edited": false, "score": 0, "creation_date": 1469489728, "post_id": 38500520, "comment_id": 64546994, "body": "@CodyGray Basically I want to use RDRAND() but not all CPU&#39;s support it. To check if the current CPU does, one sees if bit 30 in ECX is set when the CPU standard function is called. (If the bit isn&#39;t set the  I&#39;ll use an alternative to RDRAND)"}], "tags": [], "owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "is_accepted": true, "score": 2, "last_activity_date": 1469165447, "last_edit_date": 1592644375, "creation_date": 1469093926, "answer_id": 38500520, "question_id": 38484616, "link": "https://stackoverflow.com/questions/38484616/differing-cpuid-usage-from-high-level-languages/38500520#38500520", "title": "Differing CPUID usage from high-level languages", "body": "<p>As Jester says, <strong>in GNU C the <a href=\"https://stackoverflow.com/a/14266932/547981\">cpuid.h</a> wrapper intrinsic is probably your best bet.</strong></p>\n<hr />\n<p>There's also <a href=\"https://gcc.gnu.org/onlinedocs/gcc/x86-Built-in-Functions.html\" rel=\"nofollow noreferrer\"><code>__builtin_cpu_supports(&quot;popcnt&quot;)</code></a> or <code>&quot;avx&quot;</code> or whatever, which works after you call <code>__builtin_cpu_init()</code>.  Only the really major feature-bits are supported, though.  For example, the docs don't mention the feature-bit for rdrand, so <code>__builtin_cpu_supports(&quot;rdrand&quot;)</code> probably doesn't work.</p>\n<hr />\n<h3>Custom <a href=\"/questions/tagged/inline-assembly\" class=\"post-tag\" title=\"show questions tagged &#39;inline-assembly&#39;\" rel=\"tag\">inline-assembly</a> versions:</h3>\n<p>The implementation from Linux can inline with no wasted instructions, and it looks well-written, so there's no reason to use anything else.  It's remotely possible that you might get a complaint about not being able to satisfy the <code>&quot;=b&quot;</code> constraint; if so see below for what clang's cpuid.h does.  (But I think that's never necessary and the result of a documentation mistake).</p>\n<p>It doesn't actually need <code>volatile</code>, though, if you're using it for the values produced rather than the serializing effect on the pipeline: Running CPUID with the same inputs will give the same result, so we can let the optimizer move it around or hoist it out of loops.  (So it runs fewer times).  This is probably not helpful because normal code won't use it in a loop in the first place, though.</p>\n<hr />\n<p><a href=\"http://clang.llvm.org/doxygen/cpuid_8h_source.html\" rel=\"nofollow noreferrer\">The source for clang's implementation of <code>cpuid.h</code></a> does some weird stuff, like preserving <code>%rbx</code> because apparently some x86-64 environments might not be able to satisfy a constraint that uses <code>%rbx</code> as an output operand?   The comment is <code>/* x86-64 uses %rbx as the base register, so preserve it. */</code>, but I have no idea what they're talking about.  If anything x86-32 PIC code in the SysV ABI uses <code>%ebx</code> for a fixed purpose (as a pointer to the GOT), but I don't know about anything like that for x86-64.  Perhaps that code is motivated by a mistake in the ABI documentation?  See <a href=\"https://gcc.gnu.org/ml/gcc/2014-11/msg00161.html\" rel=\"nofollow noreferrer\">HJ Lu's mailing list post about it</a>.</p>\n<hr />\n<p>Most importantly, <strong>the first version in the question</strong> (inside <code>main()</code>) <strong>is broken</strong> because it <a href=\"https://stackoverflow.com/questions/34520013/using-base-pointer-register-in-c-inline-asm/34522750#34522750\">clobbers the red-zone with <code>push</code></a>.</p>\n<p>To fix it, just tell the compiler the result will be in ebx (with <code>&quot;=b&quot;</code>), and let it worry about saving/restoring ebx/rbx at the start/end of the function.</p>\n"}], "owner": {"reputation": 2790, "user_id": 5137782, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/b8bQ8.jpg?s=128&g=1", "display_name": "8protons", "link": "https://stackoverflow.com/users/5137782/8protons"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 496, "favorite_count": 0, "accepted_answer_id": 38500520, "answer_count": 1, "score": 0, "last_activity_date": 1469165447, "creation_date": 1469028271, "question_id": 38484616, "link": "https://stackoverflow.com/questions/38484616/differing-cpuid-usage-from-high-level-languages", "title": "Differing CPUID usage from high-level languages", "body": "<p>I'm attempting to utilize an x86 ASM function that requires certain processor architecture. I understand that I need to check a specific bit after calling \"<strong>CPUID standard function 01H</strong>\". Below is a <strong>C</strong> implementation from the <a href=\"https://en.wikipedia.org/wiki/CPUID#CPUID_usage_from_high-level_languages\" rel=\"nofollow\">CPUID Wikipedia</a> page for calling CPUID: </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main() {\n    int i;\n    unsigned int index = 0;\n    unsigned int regs[4];\n    int sum;\n    __asm__ __volatile__(\n#if defined(__x86_64__) || defined(_M_AMD64) || defined (_M_X64)\n        \"pushq %%rbx     \\n\\t\" /* save %rbx */\n#else\n        \"pushl %%ebx     \\n\\t\" /* save %ebx */\n#endif\n        \"cpuid            \\n\\t\"\n        \"movl %%ebx ,%[ebx]  \\n\\t\" /* write the result into output var */\n#if defined(__x86_64__) || defined(_M_AMD64) || defined (_M_X64)\n        \"popq %%rbx \\n\\t\"\n#else\n        \"popl %%ebx \\n\\t\"\n#endif\n        : \"=a\"(regs[0]), [ebx] \"=r\"(regs[1]), \"=c\"(regs[2]), \"=d\"(regs[3])\n        : \"a\"(index));\n    for (i=4; i&lt;8; i++) {\n        printf(\"%c\" ,((char *)regs)[i]);\n    }\n    for (i=12; i&lt;16; i++) {\n        printf(\"%c\" ,((char *)regs)[i]);\n    }\n    for (i=8; i&lt;12; i++) {\n        printf(\"%c\" ,((char *)regs)[i]);\n    }\n    printf(\"\\n\");\n}\n</code></pre>\n\n<p>Though the <a href=\"http://lxr.linux.no/linux+v2.6.39/arch/x86/include/asm/processor.h#L173\" rel=\"nofollow\">Linux kernel</a> uses the function below: </p>\n\n<pre><code>static inline void native_cpuid(unsigned int *eax, unsigned int *ebx,\n                                unsigned int *ecx, unsigned int *edx)\n{\n        /* ecx is often an input as well as an output. */\n        asm volatile(\"cpuid\"\n            : \"=a\" (*eax),\n              \"=b\" (*ebx),\n              \"=c\" (*ecx),\n              \"=d\" (*edx)\n            : \"0\" (*eax), \"2\" (*ecx));\n}\n</code></pre>\n\n<p>Which one is better? Other they essentually equivalent?</p>\n"}, {"tags": ["c", "assembly", "machine-code"], "comments": [{"owner": {"reputation": 15145, "user_id": 4271923, "user_type": "registered", "profile_image": "https://graph.facebook.com/543414580/picture?type=large", "display_name": "Ped7g", "link": "https://stackoverflow.com/users/4271923/ped7g"}, "edited": false, "score": 1, "creation_date": 1469029876, "post_id": 38484606, "comment_id": 64372418, "body": "&quot;how the program get address previously stored in the stack if in the subprocedure, an instruction PUSHed something to the stack or overwrite the return address of CALL.&quot; ... CPU doesn&#39;t care, the next <code>RET</code> will return to the wrong address (the new/modified value in stack front, when ret is called)."}, {"owner": {"reputation": 5905, "user_id": 2104879, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/fnwnh.jpg?s=128&g=1", "display_name": "mertyildiran", "link": "https://stackoverflow.com/users/2104879/mertyildiran"}, "reply_to_user": {"reputation": 15145, "user_id": 4271923, "user_type": "registered", "profile_image": "https://graph.facebook.com/543414580/picture?type=large", "display_name": "Ped7g", "link": "https://stackoverflow.com/users/4271923/ped7g"}, "edited": false, "score": 0, "creation_date": 1469030096, "post_id": 38484606, "comment_id": 64372551, "body": "@Ped7g Then it will be the assembly program&#39;s fault not the assembler&#39;s, right?"}, {"owner": {"reputation": 15145, "user_id": 4271923, "user_type": "registered", "profile_image": "https://graph.facebook.com/543414580/picture?type=large", "display_name": "Ped7g", "link": "https://stackoverflow.com/users/4271923/ped7g"}, "edited": false, "score": 1, "creation_date": 1469030207, "post_id": 38484606, "comment_id": 64372630, "body": "<code>call label</code> can be break down for example as <code>push next_instruction</code> <code>jmp label</code> <code>next_instruction: ...</code> (<code>next_instruction:</code> being fictional implicit label used internally by assembler, actually you can do just <code>$+size_of_call</code> without defining the symbol) ... Yes, it&#39;s program responsibility to keep stack values meaningful, just as you have to keep meaningful value in registers and executed instructions. The CPU just does, what it is told to. So in sub-routine, if you <code>push</code> three words on stack, you should either <code>pop</code> size of three words, or <code>add sp,3*word</code>, before calling <code>ret</code>."}, {"owner": {"reputation": 15145, "user_id": 4271923, "user_type": "registered", "profile_image": "https://graph.facebook.com/543414580/picture?type=large", "display_name": "Ped7g", "link": "https://stackoverflow.com/users/4271923/ped7g"}, "edited": false, "score": 1, "creation_date": 1469030334, "post_id": 38484606, "comment_id": 64372723, "body": "and <code>ret</code> can be imagined as <code>pop ip</code> (where <code>ip</code> is instruction pointer register) .. so the next instruction will be fetched from the address, which was on &quot;top&quot; of stack."}, {"owner": {"reputation": 5905, "user_id": 2104879, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/fnwnh.jpg?s=128&g=1", "display_name": "mertyildiran", "link": "https://stackoverflow.com/users/2104879/mertyildiran"}, "reply_to_user": {"reputation": 15145, "user_id": 4271923, "user_type": "registered", "profile_image": "https://graph.facebook.com/543414580/picture?type=large", "display_name": "Ped7g", "link": "https://stackoverflow.com/users/4271923/ped7g"}, "edited": false, "score": 0, "creation_date": 1469030490, "post_id": 38484606, "comment_id": 64372835, "body": "@Ped7g One more thing, could you explain how an assembler pass label address to JMP instruction?"}, {"owner": {"reputation": 15145, "user_id": 4271923, "user_type": "registered", "profile_image": "https://graph.facebook.com/543414580/picture?type=large", "display_name": "Ped7g", "link": "https://stackoverflow.com/users/4271923/ped7g"}, "edited": false, "score": 0, "creation_date": 1469039908, "post_id": 38484606, "comment_id": 64378419, "body": "Added some more comments about source in answer.. But now I finally figured out, what I wanted to say about &quot;breaking down&quot; instructions into the basic ones. That should be not responsibility of assembler. Assembler should produce only direct 1:1 mapping from written instruction in text encoding into machine code binary bytes. What you are doing in your <code>push</code> handling can be viewed either as macro compiler, or higher level language compiler. In that case you may do two compilers, one translating extended asm into basic asm (push -&gt; store+4xdec), other to translate store/dec into binary bytes."}, {"owner": {"reputation": 15145, "user_id": 4271923, "user_type": "registered", "profile_image": "https://graph.facebook.com/543414580/picture?type=large", "display_name": "Ped7g", "link": "https://stackoverflow.com/users/4271923/ped7g"}, "edited": false, "score": 0, "creation_date": 1469052858, "post_id": 38484606, "comment_id": 64384938, "body": "For a detailed review, how relative jumps work in x86, you may want to check this neat answer on different topic. (I understand it&#39;s not directly relevant to your platform, but it may help to better understand what assemblers do): <a href=\"http://stackoverflow.com/a/38487923/4271923\">stackoverflow.com/a/38487923/4271923</a>"}], "answers": [{"comments": [{"owner": {"reputation": 5905, "user_id": 2104879, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/fnwnh.jpg?s=128&g=1", "display_name": "mertyildiran", "link": "https://stackoverflow.com/users/2104879/mertyildiran"}, "edited": false, "score": 0, "creation_date": 1469033656, "post_id": 38486001, "comment_id": 64374731, "body": "Could you explain the example in my question in machine(hexadecimal) from <code>lpp     st 1 2</code> to <code>jmp lpp</code>? Because I want to understand how <b>jmp</b> and <b>loop</b> works actually in machine code. Assembler is basically generating this file line by line machine code equivalent of assembly, so you can explain in this format: <a href=\"https://github.com/mertyildiran/DASM/blob/master/RAM\" rel=\"nofollow noreferrer\">github.com/mertyildiran/DASM/blob/master/RAM</a>"}, {"owner": {"reputation": 5905, "user_id": 2104879, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/fnwnh.jpg?s=128&g=1", "display_name": "mertyildiran", "link": "https://stackoverflow.com/users/2104879/mertyildiran"}, "edited": false, "score": 0, "creation_date": 1469033706, "post_id": 38486001, "comment_id": 64374770, "body": "I&#39;m sorry if I&#39;m asking too much but it&#39;s hard topic to understand for me. Please explain it like explaining to a dummy."}, {"owner": {"reputation": 15145, "user_id": 4271923, "user_type": "registered", "profile_image": "https://graph.facebook.com/543414580/picture?type=large", "display_name": "Ped7g", "link": "https://stackoverflow.com/users/4271923/ped7g"}, "reply_to_user": {"reputation": 5905, "user_id": 2104879, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/fnwnh.jpg?s=128&g=1", "display_name": "mertyildiran", "link": "https://stackoverflow.com/users/2104879/mertyildiran"}, "edited": false, "score": 1, "creation_date": 1469034117, "post_id": 38486001, "comment_id": 64375024, "body": "@mertyildiran I added one more paragraph, which sort of answers your &quot;line by line&quot;. That&#39;s not possible (only for jumps going back, to symbol which you already compiled and could have stored in symbol table). I have trouble to understand what you mean by <code>lpp st 1 2  jmp lpp</code> way... But the machine code should be like <code>&lt;st opcode&gt; &lt;1&gt; &lt;2&gt; &lt;jmp rel8 opcode&gt; &lt;-5&gt;</code> where <code>&lt;jmp rel8 opcode&gt; &lt;-2&gt;</code> is jumping to itself in infinite loop. I think you don&#39;t use three bytes for <code>st</code> and <code>1 2</code> is somehow encoded together with <code>&lt;st opcode&gt;</code>? So adjust it, but I hope the principle will be visible."}, {"owner": {"reputation": 15145, "user_id": 4271923, "user_type": "registered", "profile_image": "https://graph.facebook.com/543414580/picture?type=large", "display_name": "Ped7g", "link": "https://stackoverflow.com/users/4271923/ped7g"}, "reply_to_user": {"reputation": 5905, "user_id": 2104879, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/fnwnh.jpg?s=128&g=1", "display_name": "mertyildiran", "link": "https://stackoverflow.com/users/2104879/mertyildiran"}, "edited": false, "score": 0, "creation_date": 1469034405, "post_id": 38486001, "comment_id": 64375204, "body": "@mertyildiran so basically you should create a symbol table, where when label <code>lpp</code> is reached, the <code>counter</code> value is stored in the symbol table, for example <code>lpp = 54</code>. Then in second pass when <code>jmp lpp</code> at counter 33 is stored as two byte opcode (rel8), and the <code>pc</code> will point already behind <code>jmp</code> (architecture definition), you know you have to add 54-35 (=+19) to land at 54 <code>pc</code>. So you encode that <code>jmp lpp</code> in second pass as <code>&lt;jmp&gt; &lt;+19&gt;</code>. (encoded as <code>&lt;jmp&gt; &lt;?? or symbol index&gt;</code> during first pass)"}, {"owner": {"reputation": 15145, "user_id": 4271923, "user_type": "registered", "profile_image": "https://graph.facebook.com/543414580/picture?type=large", "display_name": "Ped7g", "link": "https://stackoverflow.com/users/4271923/ped7g"}, "reply_to_user": {"reputation": 5905, "user_id": 2104879, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/fnwnh.jpg?s=128&g=1", "display_name": "mertyildiran", "link": "https://stackoverflow.com/users/2104879/mertyildiran"}, "edited": false, "score": 2, "creation_date": 1469034759, "post_id": 38486001, "comment_id": 64375390, "body": "@mertyildiran But maybe I seriously misunderstood what your assembler is doing. Usually assembler is producing machine code bytes from assembly language. So I&#39;m confused why your <code>push</code> assembly creates <code>store + 4x dec</code> instructions, the target CPU does not have native <code>push</code>? Or <code>sub&#47;add</code> to do <code>sub sp,4&#47;add sp,-4</code>? I hope you will somehow manage to put it together, sorry if I confused you by something irrelevant to your project."}, {"owner": {"reputation": 5905, "user_id": 2104879, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/fnwnh.jpg?s=128&g=1", "display_name": "mertyildiran", "link": "https://stackoverflow.com/users/2104879/mertyildiran"}, "edited": false, "score": 0, "creation_date": 1469034939, "post_id": 38486001, "comment_id": 64375494, "body": "It has also native push OK I understood now. Thank you so much."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1469069461, "post_id": 38486001, "comment_id": 64388887, "body": "x86: <code>absolute jumps to address (encoded as jmp opcode byte, then as many bytes as needed to encode the address)</code>.  Only &quot;far&quot; jmp has an immediate absolute encoding.  &quot;near&quot; jumps are either short (rel8) or regular (rel32).  The opcode determines the length of the rest of the instruction, either rel8 or rel32, not like a null-terminated string or something!  <a href=\"http://www.felixcloutier.com/x86/JMP.html\" rel=\"nofollow noreferrer\">felixcloutier.com/x86/JMP.html</a> and <a href=\"http://www.felixcloutier.com/x86/Jcc.html\" rel=\"nofollow noreferrer\">felixcloutier.com/x86/Jcc.html</a>.  See also <a href=\"http://stackoverflow.com/q/38434627/224132.\">How do I know whether MASM encodes my JMP instruction using a relative or absolute offset?</a>"}, {"owner": {"reputation": 15145, "user_id": 4271923, "user_type": "registered", "profile_image": "https://graph.facebook.com/543414580/picture?type=large", "display_name": "Ped7g", "link": "https://stackoverflow.com/users/4271923/ped7g"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1469094551, "post_id": 38486001, "comment_id": 64400942, "body": "@PeterCordes thanks you for correction. BTW, <i>the opcode on x86 defines length of instruction</i> is OK for <code>jmp</code>, but generally would need explanation of prefixes, as <code>mov ax,#n</code> is the same opcode as <code>mov eax,#n</code> (if you don&#39;t count prefix as part of opcode). Hm, maybe I shouldn&#39;t have use the x86 at all, it&#39;s quite complicated after all those generations of backward compatibilities and extensions. While the OP is trying to work with fixed length made-up platform with much simpler architecture. Then again, if he can understand all this x86... his own platform should look easy after that. :D"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1469094929, "post_id": 38486001, "comment_id": 64401201, "body": "My point was that after looking at the prefixes + opcode and the current mode, the length of the rest of the instruction is always known without parsing the immediate.  rel8 and re16/32 use different opcodes.  If you want to talk about 16-bit mode vs. 32/64-bit modes (which I didn&#39;t :P), then in 16-bit mode it&#39;s <code>jmp rel16</code>.  In 32/64-bit modes, it&#39;s <code>jmp rel32</code>.  (So you potentially have to use <code>mov reg, imm64</code> / <code>jmp reg</code> to do an absolute indirect jump to reach code that&#39;s farther away than a 32bit relative displacement can reach)."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1469095190, "post_id": 38486001, "comment_id": 64401364, "body": "BTW, I also was totally confused by this question, and had serious doubts that the OP understood that each asm instruction normally translates to exactly one machine instruction.  (Although some RISC assembly languages have pseudo-instructions for things like loading constants that don&#39;t fit in an immediate, and even <a href=\"http://stackoverflow.com/a/38451961/224132\"><code>addiu</code> with a constant that doesn&#39;t fit in a sign-extended imm16 assembling to multiple MIPS instructions</a>)."}], "tags": [], "owner": {"reputation": 15145, "user_id": 4271923, "user_type": "registered", "profile_image": "https://graph.facebook.com/543414580/picture?type=large", "display_name": "Ped7g", "link": "https://stackoverflow.com/users/4271923/ped7g"}, "is_accepted": true, "score": 3, "last_activity_date": 1469039516, "last_edit_date": 1469039516, "creation_date": 1469032205, "answer_id": 38486001, "question_id": 38484606, "link": "https://stackoverflow.com/questions/38484606/how-to-implement-call-ret-to-an-assembler/38486001#38486001", "title": "How to implement CALL &amp; RET to an assembler?", "body": "<p><em>\"how an assembler pass label address to JMP instruction?\"</em></p>\n\n<p>That should be obvious from the machine/CPU architecture, how it does decode the instructions. I'm a bit confused from your question, whether the made-up CPU is already final (then it should describe, how you can load <code>pc</code> register = that's basically what jump does, plus it may be conditional), or you are doing two projects in one, creating both the HW machine specs, and an assembler for it. And I'm too lazy to read it again, so I will just show you common ways from real world.</p>\n\n<h1>ARM - RISC-like instruction set, fixed opcode size:</h1>\n\n<p>Both in 16b (thumb) and 32b mode the first few bits of opcode specify the instruction (<code>B, BL, BLX</code>, B is pure jump, BL is similar to CALL, but not using stack, a \"link\" register is used instead to store return address), the rest of bits specify either register holding the target address (so to call function <code>foo</code> you can do <code>load r0,foo</code> <code>bl r0</code>), or immediate value which is relative to current <code>PC</code>.</p>\n\n<p>Which means, that in 16b mode you can jump +-2kiB unconditionally, or <code>-252</code> to <code>+258</code> conditionally (the condition variant is encoded in further bits, taking away some from the immediate).</p>\n\n<p>This leads sometimes to situation, where high level compilers either use the register variant, or jump near enough to another jump instruction which hops even further.</p>\n\n<p>In 32b mode the remaining bits reserved for immediate give you much better range, about +-32MiB for all variants. (there's one more mode, 32b \"thumb\" which has one more different encoding, but that's irrelevant in this example).</p>\n\n<p>Fun fact, the bit-0 in address does specify whether the instruction there is in thumb mode, or full 32b mode, as all addresses must be aligned on ARM, so jump to address 0x00000001 is jump to 0x00000000 with switch of CPU to thumb mode.</p>\n\n<h1>x86 - CISC-like historically extended beyond good taste</h1>\n\n<p>this one has almost all possible variants (except the one you really need in that long .asm you have been writing last 3 months). Instructions encoding has variable length, so the instruction does use as many bytes, as decided by Intel to be needed.</p>\n\n<ul>\n<li>relative jumps (short with single byte -128 ... +127) - check</li>\n<li>absolute jumps to address (encoded as <code>jmp</code> opcode byte, then as many bytes as needed to encode the address)</li>\n<li>register jumps (to the address stored in register)</li>\n<li>conditional relative jumps (not just \"extended\" <code>jmp</code> encoding as in ARM case, but specific opcodes)</li>\n<li>extras like <code>loop</code>, <code>jcxz/jecxz</code> and maybe some more I even forgot.</li>\n</ul>\n\n<hr>\n\n<p>So it boils down either to load the value into some register, or encode the immediate into the instruction opcode, then either treat it as an absolute address (which for example on 32b platform, where you manage to encode 25 bits for address, would allow you to address 32MiB of RAM; instead of 4GiB), or as relative address (25bits => <code>pc</code>+-16Mi).</p>\n\n<hr>\n\n<p>Addendum, which is maybe part of your problem?\nLike how to \"know\" what address will be at some future label?</p>\n\n<p>Most of the assemblers are two-pass, so they first generate the instruction opcodes (and can calculate the length of each part of source), and collect all symbols in symbol table, then all address symbols are defined according to the opcodes lengths and <code>org</code> directives. Then in second pass you fill up all immediate values in opcodes by the particular symbol value.</p>\n\n<p>This also shows, why two-pass assemblers can't handle <code>jmp rel8/rel16</code> (relative jump defined either by 8b or 16b immediate) automatically, but programmer has to specify which one he wants to use. (or use multi-pass assembler, which will try <code>rel8</code> first, when failed, it will recode the jmp with <code>rel16</code> and move+recompile everything beyond that point).</p>\n\n<p>Looking at the example source of your <code>push</code> encoding I feel like there's some work for you to change the way your assembler works... (it's ugly anyway, like both creating opcodes and also printing output on screen - don't hesitate to write it one more time, I bet it will turn out more clean and simpler).</p>\n\n<hr>\n\n<p>edit: finally, I probably understand that piece of assembler better.</p>\n\n<p>So <code>program</code> is <code>uint16_t[]</code>, right? (should have been part of question).</p>\n\n<p>And the instruction machine codes are fixed size, 16b too.</p>\n\n<p>But then your <code>counter</code> counts in 16b words... so is that the addressing mode of the target architecture?</p>\n\n<p>That at address <code>0</code> is stored 16b word, and on address <code>1</code> is stored the next 16b word? (and it's not overlapping, as at x86, where addresses are counted in 8b bytes => in such case first instruction word would be at addresses <code>0</code> and <code>1</code> and second word would be at addresses <code>2</code> and <code>3</code>. Make sure your <code>counter</code> follows correct addressing scheme (or you will have to convert it when defining value of label symbols).</p>\n\n<p>And your asm is producing output like <code>0x0000 0x7802</code>: address 0, word 7802, doing some instruction 78 with params 2 (unclear endianness! Either you will be lucky to have the same one on compiling host, or you will end with wrong machine code with swapped bytes in each word), next opcode <code>0x0001 0x7803</code>, ... etc...</p>\n\n<p>So it looks like you have fixed 16b size for instruction encoding, not sure if <code>jmp</code> will eat whole 8b like store/load instructions, or that one is special, keeping more bits for immediate encoding. If only other byte is available, only meaningful way to use it is as signed 8b <code>-128..+127</code> relative jump.</p>\n\n<p>If addressing works with 16b words, then you can effectively jump -128..+127 instructions back/forward. If addressing works with 8b bytes, your range is down to -64..+63 instructions only. Hard to tell, as I didn't figure out any details about target platform (you should have added some link or something, at least example how <code>jmp</code> is encoded and how memory is mapped).</p>\n"}], "owner": {"reputation": 5905, "user_id": 2104879, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/fnwnh.jpg?s=128&g=1", "display_name": "mertyildiran", "link": "https://stackoverflow.com/users/2104879/mertyildiran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1071, "favorite_count": 0, "accepted_answer_id": 38486001, "answer_count": 1, "score": 1, "last_activity_date": 1469039516, "creation_date": 1469028249, "question_id": 38484606, "link": "https://stackoverflow.com/questions/38484606/how-to-implement-call-ret-to-an-assembler", "title": "How to implement CALL &amp; RET to an assembler?", "body": "<p>According to this made-up microprocessor architecture's instruction set:\n<a href=\"https://github.com/mertyildiran/DASM\" rel=\"nofollow\">https://github.com/mertyildiran/DASM</a></p>\n\n<p>In our toy assembler written in C, we have implemented PUSH &amp; POP instructions as shown below:</p>\n\n<p><strong>PUSH:</strong></p>\n\n<p>Which is basically the combination of 4 DEC and 1 ST instruction.</p>\n\n<pre><code>        else if (strcmp(token,\"push\")==0) // PUSH instruction: combination of 4 DEC and 1 ST instruction on Stack Pointer (SP)\n        {\n            op1 = strtok(NULL,\"\\n\\t\\r \");\n            op2[0] = sp; // Let's say address of SP is 9\n            printf(\"\\n\\t%s\\t%s\\n\",strupr(token),op1);\n            ch = (op2[0]-48) | ((op2[0]-48)&lt;&lt;3); // Prepare bitwise instruction format for DEC instructions\n            program[counter]=0x7800+((ch)&amp;0x00ff); // Decrease Stack Pointer 4 times\n            printf(\"&gt; %d\\t%04x\\n\",counter,program[counter]);\n            counter++;\n            program[counter]=0x7800+((ch)&amp;0x00ff); // Decrease Stack Pointer 4 times\n            printf(\"&gt; %d\\t%04x\\n\",counter,program[counter]);\n            counter++;\n            program[counter]=0x7800+((ch)&amp;0x00ff); // Decrease Stack Pointer 4 times\n            printf(\"&gt; %d\\t%04x\\n\",counter,program[counter]);\n            counter++;\n            program[counter]=0x7800+((ch)&amp;0x00ff); // Decrease Stack Pointer 4 times\n            printf(\"&gt; %d\\t%04x\\n\",counter,program[counter]);\n            counter++;\n\n            ch = ((op1[0]-48) &lt;&lt; 2) | ((op2[0]-48) &lt;&lt; 6); // Prepare bitwise instruction format for ST instruction\n            program[counter]=0x3000+((ch)&amp;0x00ff); // Store the value in Stack\n            printf(\"&gt; %d\\t%04x\\n\",counter,program[counter]);\n            counter++;\n        }\n</code></pre>\n\n<p><strong>POP:</strong></p>\n\n<p>Which is basically the combination of 1 LD and 4 INC instructions.</p>\n\n<pre><code>        else if (strcmp(token,\"pop\")==0) // POP instruction: combination of 1 LD and 4 INC instructions on Stack Pointer (SP)\n        {\n            op1 = strtok(NULL,\"\\n\\t\\r \");\n            op2[0] = sp; // Let's say address of SP is 9\n            printf(\"\\n\\t%s\\t%s\\n\",strupr(token),op1);\n\n            ch = (op1[0]-48) | ((op2[0]-48) &lt;&lt; 3); // Prepare bitwise instruction format for LD instruction\n            program[counter]=0x2000+((ch)&amp;0x00ff); // Store the value in Stack\n            printf(\"&gt; %d\\t%04x\\n\",counter,program[counter]);\n            counter++;\n\n            ch = (op2[0]-48) | ((op2[0]-48)&lt;&lt;3); // Prepare bitwise instruction format for INC instructions\n            program[counter]=0x7700+((ch)&amp;0x00ff); // Decrease Stack Pointer 4 times\n            printf(\"&gt; %d\\t%04x\\n\",counter,program[counter]);\n            counter++;\n            program[counter]=0x7700+((ch)&amp;0x00ff); // Decrease Stack Pointer 4 times\n            printf(\"&gt; %d\\t%04x\\n\",counter,program[counter]);\n            counter++;\n            program[counter]=0x7700+((ch)&amp;0x00ff); // Decrease Stack Pointer 4 times\n            printf(\"&gt; %d\\t%04x\\n\",counter,program[counter]);\n            counter++;\n            program[counter]=0x7700+((ch)&amp;0x00ff); // Decrease Stack Pointer 4 times\n            printf(\"&gt; %d\\t%04x\\n\",counter,program[counter]);\n            counter++;\n        }\n</code></pre>\n\n<p>So my question is how can we implement CALL &amp; RET instructions with using a stack?</p>\n\n<p>I'm aware that CALL instruction will store current state of PC in the stack so the program will be able to return where it left with RET instruction. But it's leading me to two subquestions:</p>\n\n<ol>\n<li>After CALL executed, how the program get address previously stored in the stack if in the subprocedure, an instruction PUSHed something to the stack or overwrite the return address of CALL.</li>\n<li>How can we pass the related label's address to CALL in machine code level? In our assembler JMP &amp; jZ instructions are also not completed, because of the same reason.</li>\n</ol>\n\n<p>If you want to look at the whole picture: <a href=\"https://github.com/mertyildiran/DASM/blob/master/assembler.c\" rel=\"nofollow\">https://github.com/mertyildiran/DASM/blob/master/assembler.c</a></p>\n\n<p>For 2. subquestion(JMP/CALL) you can explain it over this example with maybe <code>jmp lpp</code> line:</p>\n\n<pre><code>.data\n     count: 60\n     array: .space 10\n     char: 0xfe\n.code\n        ldi 0 count\n        ld  0 0\n        ldi 1 array\n        ldi 2 char\n        ld  2 2\nlpp     st 1 2\n        inc 1\n        dec 0\n        jz loop\n        jmp lpp\nloop    sub 1 2 3\nlp1     jmp lp1  \n</code></pre>\n"}, {"tags": ["c", "matlab", "mex"], "comments": [{"owner": {"reputation": 4480, "user_id": 2261062, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/15756b0278dbf58ae90d2ffe8accbb81?s=128&d=identicon&r=PG", "display_name": "Sembei Norimaki", "link": "https://stackoverflow.com/users/2261062/sembei-norimaki"}, "edited": false, "score": 1, "creation_date": 1469028783, "post_id": 38484590, "comment_id": 64371645, "body": "You could try to write a very easy Hello Word .c file and see if the problem persist when calling it from Matlab"}], "answers": [{"comments": [{"owner": {"reputation": 878, "user_id": 2976116, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/a053945565070408a43adcabba1c35c2?s=128&d=identicon&r=PG&f=1", "display_name": "Christina", "link": "https://stackoverflow.com/users/2976116/christina"}, "edited": false, "score": 0, "creation_date": 1469052478, "post_id": 38485205, "comment_id": 64384797, "body": "Hello dear rayryeng. I would like to thank you so much for your help!! please I just have one other problem. I edited my question in which I have added a hello2.c code. I applied your suggestions in hello2.c but I am still getting a segmentation violation. BTW the function hello1.c works well now thanks to you!! :)) Any other help from you will be very appreciated!!"}, {"owner": {"reputation": 96306, "user_id": 3250829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e2e07c34e170453eeea9e937a98f19b?s=128&d=identicon&r=PG", "display_name": "rayryeng", "link": "https://stackoverflow.com/users/3250829/rayryeng"}, "reply_to_user": {"reputation": 878, "user_id": 2976116, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/a053945565070408a43adcabba1c35c2?s=128&d=identicon&r=PG&f=1", "display_name": "Christina", "link": "https://stackoverflow.com/users/2976116/christina"}, "edited": false, "score": 1, "creation_date": 1469052761, "post_id": 38485205, "comment_id": 64384899, "body": "Hi there. You should check if your function in hello2.c is correct. For example, I don&#39;t see a reason why xtemp and ytemp is declared. You&#39;re doing computations and storing them in those variables but they&#39;re not being used for the output array. Also check your statement when assigning to x at the end of the loop. To me it&#39;s not doing anything meaningful. I&#39;ll wait until you verify if this is the code you want before editing my answer."}, {"owner": {"reputation": 96306, "user_id": 3250829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e2e07c34e170453eeea9e937a98f19b?s=128&d=identicon&r=PG", "display_name": "rayryeng", "link": "https://stackoverflow.com/users/3250829/rayryeng"}, "reply_to_user": {"reputation": 878, "user_id": 2976116, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/a053945565070408a43adcabba1c35c2?s=128&d=identicon&r=PG&f=1", "display_name": "Christina", "link": "https://stackoverflow.com/users/2976116/christina"}, "edited": false, "score": 1, "creation_date": 1469054269, "post_id": 38485205, "comment_id": 64385390, "body": "OK I&#39;ll have a look soon."}, {"owner": {"reputation": 96306, "user_id": 3250829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e2e07c34e170453eeea9e937a98f19b?s=128&d=identicon&r=PG", "display_name": "rayryeng", "link": "https://stackoverflow.com/users/3250829/rayryeng"}, "reply_to_user": {"reputation": 878, "user_id": 2976116, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/a053945565070408a43adcabba1c35c2?s=128&d=identicon&r=PG&f=1", "display_name": "Christina", "link": "https://stackoverflow.com/users/2976116/christina"}, "edited": false, "score": 1, "creation_date": 1469055232, "post_id": 38485205, "comment_id": 64385647, "body": "Figured it out. Look at your second for loop. There are no curly braces that surround that block of code."}, {"owner": {"reputation": 878, "user_id": 2976116, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/a053945565070408a43adcabba1c35c2?s=128&d=identicon&r=PG&f=1", "display_name": "Christina", "link": "https://stackoverflow.com/users/2976116/christina"}, "edited": false, "score": 0, "creation_date": 1469055600, "post_id": 38485205, "comment_id": 64385743, "body": "Yes!! it works now! BTW in hello1.c I didn&#39;t put a curly braces for the second loop. So why I should for hello2.c ?? Anw thank you a lot sincerely! You are the best"}, {"owner": {"reputation": 96306, "user_id": 3250829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e2e07c34e170453eeea9e937a98f19b?s=128&d=identicon&r=PG", "display_name": "rayryeng", "link": "https://stackoverflow.com/users/3250829/rayryeng"}, "reply_to_user": {"reputation": 878, "user_id": 2976116, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/a053945565070408a43adcabba1c35c2?s=128&d=identicon&r=PG&f=1", "display_name": "Christina", "link": "https://stackoverflow.com/users/2976116/christina"}, "edited": false, "score": 1, "creation_date": 1469055754, "post_id": 38485205, "comment_id": 64385776, "body": "Not using curly braces means the for loop will only execute the next statement for the loop. The rest of the code is not in the loop."}, {"owner": {"reputation": 96306, "user_id": 3250829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e2e07c34e170453eeea9e937a98f19b?s=128&d=identicon&r=PG", "display_name": "rayryeng", "link": "https://stackoverflow.com/users/3250829/rayryeng"}, "reply_to_user": {"reputation": 878, "user_id": 2976116, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/a053945565070408a43adcabba1c35c2?s=128&d=identicon&r=PG&f=1", "display_name": "Christina", "link": "https://stackoverflow.com/users/2976116/christina"}, "edited": false, "score": 0, "creation_date": 1469056170, "post_id": 38485205, "comment_id": 64385893, "body": "@Christina You&#39;re very welcome. I&#39;ve edited my answer to make this clear for you"}, {"owner": {"reputation": 878, "user_id": 2976116, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/a053945565070408a43adcabba1c35c2?s=128&d=identicon&r=PG&f=1", "display_name": "Christina", "link": "https://stackoverflow.com/users/2976116/christina"}, "edited": false, "score": 0, "creation_date": 1469056591, "post_id": 38485205, "comment_id": 64386012, "body": "I spent about 6 hours to resolve hello2.c (just after I recieved your answer for hello1.c). But it is weird that I didn&#39;t expect to add a a second curly braces for the second loop. Okay I am new in C language:)"}, {"owner": {"reputation": 96306, "user_id": 3250829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e2e07c34e170453eeea9e937a98f19b?s=128&d=identicon&r=PG", "display_name": "rayryeng", "link": "https://stackoverflow.com/users/3250829/rayryeng"}, "reply_to_user": {"reputation": 878, "user_id": 2976116, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/a053945565070408a43adcabba1c35c2?s=128&d=identicon&r=PG&f=1", "display_name": "Christina", "link": "https://stackoverflow.com/users/2976116/christina"}, "edited": false, "score": 0, "creation_date": 1469056668, "post_id": 38485205, "comment_id": 64386043, "body": "Ah got it. Actually you need braces in the first version too. I didn&#39;t catch that one."}, {"owner": {"reputation": 96306, "user_id": 3250829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e2e07c34e170453eeea9e937a98f19b?s=128&d=identicon&r=PG", "display_name": "rayryeng", "link": "https://stackoverflow.com/users/3250829/rayryeng"}, "reply_to_user": {"reputation": 878, "user_id": 2976116, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/a053945565070408a43adcabba1c35c2?s=128&d=identicon&r=PG&f=1", "display_name": "Christina", "link": "https://stackoverflow.com/users/2976116/christina"}, "edited": false, "score": 1, "creation_date": 1469056854, "post_id": 38485205, "comment_id": 64386109, "body": "Changed. Have a look at the first one now."}], "tags": [], "owner": {"reputation": 96306, "user_id": 3250829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e2e07c34e170453eeea9e937a98f19b?s=128&d=identicon&r=PG", "display_name": "rayryeng", "link": "https://stackoverflow.com/users/3250829/rayryeng"}, "is_accepted": true, "score": 2, "last_activity_date": 1469056835, "last_edit_date": 1469056835, "creation_date": 1469029866, "answer_id": 38485205, "question_id": 38484590, "link": "https://stackoverflow.com/questions/38484590/calling-a-c-file-from-matlab-yields-a-segmentation-violation/38485205#38485205", "title": "Calling a .c file from MATLAB yields a segmentation violation", "body": "<p>For <code>hello1.c</code>, <a href=\"http://www.mathworks.com/help/matlab/apiref/mxgetpr.html\" rel=\"nofollow\"><code>mxGetPr</code></a> in MEX does <strong>not</strong> give you a double pointer.  It gives you a <strong>single</strong> pointer and for 2D memory, it is in a column-major layout. You have to access the right value in the 2D array by the following syntax, given that <code>i</code> and <code>j</code> are the row and column in the 2D array you want to access:</p>\n\n<pre><code>ind = j*rows + i;\n</code></pre>\n\n<p>... and thus if you want location <code>(i,j)</code> in your 2D array <code>x</code>, simply do:</p>\n\n<pre><code>double val = x[j*rows + i];\n</code></pre>\n\n<p><code>rows</code> is the total number of rows in your 2D array.  As such, you will have to correct this in your code to be able to access the 2D array properly.  You'll also have to do the same for <code>f</code> as well.  In addition, you're missing a pair of curly braces around the second <code>for</code> loop and I'll explain why later. </p>\n\n<p>Therefore, your function becomes:</p>\n\n<pre><code>void funcc(double *f, double *x, long n, long b, double lambda, double theta) // Note change in function declaration\n{\n    long i;\n    long j;\n    double u,v,y,z,w;\n    y = theta*lambda;\n    w = lambda*lambda;\n    z = 0.5*(theta+1.0)*w;\n\n    u = 0.0;\n    // n is the rows, b is the columns\n    for(i=0;i&lt;n;i++)\n    {\n        for(j=0;j&lt;b;j++) { // Added\n        v = fabs(x[j*n + i]); // Change here\n        if (v &lt;= lambda)\n            u += lambda*v;\n        else if (v &gt; y)\n            u += z;\n        else\n            u += 0.5*(v*(2*y - v) - w)/(theta-1.0);\n        } // Added\n    } \n    *f = u; // Change\n    //return; // Superfluous\n}\n</code></pre>\n\n<p>Your <code>mexFunction</code> now becomes:</p>\n\n<pre><code>void mexFunction (int nlhs, mxArray* plhs[], int nrhs, const mxArray* prhs[])\n{\n    /*set up input arguments */\n    double *x       =            mxGetPr(prhs[0]); // Change\n    long     n      =      (long)mxGetScalar(prhs[1]);\n    long     b      =      (long)mxGetScalar(prhs[2]);\n    double  lambda  =            mxGetScalar(prhs[3]);\n    double  theta   =            mxGetScalar(prhs[4]);\n    int     type    =       (int)mxGetScalar(prhs[5]);\n\n    double *f; // Change\n\n    /* set up output arguments */\n    plhs[0] = mxCreateDoubleMatrix(1,1,mxREAL);\n\n    f=mxGetPr(plhs[0]);\n\n    funcc(f, x, n, b, lambda, theta);\n}\n</code></pre>\n\n<p>For <code>hello2.c</code>, everything is fine except for the second <code>for</code> loop. You simply need to surround the code block with curly braces:</p>\n\n<pre><code>           for(i=0;i&lt;n;i++)\n           {\n                for(j=0;j&lt;b;j++) { // added\n                u = fabs(d[j*n + i]);\n                xtemp[0] = min(lambda,max(0,u - lambda));\n                xtemp[1] = min(z,max(lambda,(u*(theta-1.0)-z)/(theta-2.0)));\n                xtemp[2] = max(z,u);\n\n                ytemp[0] = 0.5*(xtemp[0] - u)*(xtemp[0] - u) + lambda*xtemp[0];\n                ytemp[1] = 0.5*(xtemp[1] - u)*(xtemp[1] - u) + 0.5*(xtemp[1]*(-xtemp[1] + 2*z) - w)/(theta-1.0);\n                ytemp[2] = 0.5*(xtemp[2] - u)*(xtemp[2] - u) + 0.5*(theta+1.0)*w;\n                x[j*n + i] = xtemp[mymin(ytemp,3)];\n                x[j*n + i] = d[j*n + i]&gt;= 0 ? x[j*n + i] : -x[j*n + i];\n                } //added\n            } \n</code></pre>\n\n<p>The reason why you need the extra braces for both files is because if you omit them, C only considers the first line after the loop to be the loop body. The rest of the code after the <code>for</code> loop finishes is executed and not part of the loop which is the reason why you're getting segmentation faults.</p>\n"}], "owner": {"reputation": 878, "user_id": 2976116, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/a053945565070408a43adcabba1c35c2?s=128&d=identicon&r=PG&f=1", "display_name": "Christina", "link": "https://stackoverflow.com/users/2976116/christina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 2, "accepted_answer_id": 38485205, "answer_count": 1, "score": 2, "last_activity_date": 1469056835, "creation_date": 1469028212, "last_edit_date": 1469052880, "question_id": 38484590, "link": "https://stackoverflow.com/questions/38484590/calling-a-c-file-from-matlab-yields-a-segmentation-violation", "title": "Calling a .c file from MATLAB yields a segmentation violation", "body": "<p>I want to run a two C programs called \"hello1.c\" and \"hello2.c\" from matlab.</p>\n\n<p><strong>My <code>hello1.c</code> code is as follows:</strong></p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;time.h&gt;\n#include &lt;mex.h&gt;\n#include &lt;math.h&gt;\n#include \"matrix.h\"\n\n\nvoid funcc(double **f, double **x, long n, long b, double lambda, double theta)\n{\n    long i;\n    long j;\n    double u,v,y,z,w;\n    y = theta*lambda;\n    w = lambda*lambda;\n    z = 0.5*(theta+1.0)*w;\n\n    u = 0.0;\n    for(i=0;i&lt;n;i++)\n    {\n        for(j=0;j&lt;b;j++)\n        v = fabs(x[i][j]);\n        if (v &lt;= lambda)\n            u += lambda*v;\n        else if (v &gt; y)\n            u += z;\n        else\n            u += 0.5*(v*(2*y - v) - w)/(theta-1.0);\n        }\n    **f = u;\n    return;\n}\n\n\nvoid mexFunction (int nlhs, mxArray* plhs[], int nrhs, const mxArray* prhs[])\n{\n    /*set up input arguments */\n    double **x       =            mxGetPr(prhs[0]);\n    long     n      =      (long)mxGetScalar(prhs[1]);\n    long     b      =      (long)mxGetScalar(prhs[2]);\n    double  lambda  =            mxGetScalar(prhs[3]);\n    double  theta   =            mxGetScalar(prhs[4]);\n    int     type    =       (int)mxGetScalar(prhs[5]);\n\n    double **f;\n\n\n    /* set up output arguments */\n    plhs[0] = mxCreateDoubleMatrix(1,1,mxREAL);\n\n    f=mxGetPr(plhs[0]);\n\n    funcc(f, x, n, b, lambda, theta);\n    }\n</code></pre>\n\n<p><strong>My <code>hello2.c</code> code is as follows:</strong></p>\n\n<pre><code>long mymin(double *x, long n)\n{\n    long i, ind;\n    double temp;\n    temp = x[0];\n    ind = 0;\n    for (i=1;i&lt;n;i++)\n    {\n        if (x[i] &lt; temp)\n        {\n            ind = i;\n            temp = x[i];\n        }\n\n    }\n    return ind;\n}\n\n\n        void funnn(double *x, double *d, long n, long b, double lambda, double theta)\n        {\n            long i;\n            long j;\n            double u,z,w;\n            double xtemp[3],ytemp[3];\n            z = theta*lambda;\n            w = lambda*lambda;\n            for(i=0;i&lt;n;i++)\n            {\n                for(j=0;j&lt;b;j++)\n                u = fabs(d[j*n + i]);\n                xtemp[0] = min(lambda,max(0,u - lambda));\n                xtemp[1] = min(z,max(lambda,(u*(theta-1.0)-z)/(theta-2.0)));\n                xtemp[2] = max(z,u);\n\n                ytemp[0] = 0.5*(xtemp[0] - u)*(xtemp[0] - u) + lambda*xtemp[0];\n                ytemp[1] = 0.5*(xtemp[1] - u)*(xtemp[1] - u) + 0.5*(xtemp[1]*(-xtemp[1] + 2*z) - w)/(theta-1.0);\n                ytemp[2] = 0.5*(xtemp[2] - u)*(xtemp[2] - u) + 0.5*(theta+1.0)*w;\n                x[j*n + i] = xtemp[mymin(ytemp,3)];\n                x[j*n + i] = d[j*n + i]&gt;= 0 ? x[j*n + i] : -x[j*n + i];\n            }\n            //return;\n        }\n\n\n\n        void mexFunction (int nlhs, mxArray* plhs[], int nrhs, const mxArray* prhs[])\n        {\n            /*set up input arguments */\n            double* d       =            mxGetPr(prhs[0]);\n            long     n      =      (long)mxGetScalar(prhs[1]);\n            long     b      =      (long)mxGetScalar(prhs[2]);\n            double  lambda  =            mxGetScalar(prhs[3]);\n            double  theta   =            mxGetScalar(prhs[4]);\n\n            double *x;\n\n\n            /* set up output arguments */\n            plhs[0] = mxCreateDoubleMatrix(n,b,mxREAL);\n\n            x=mxGetPr(plhs[0]);\n\n            funnn(x, d, n, b, lambda, theta);\n        }\n</code></pre>\n\n<p>The problem is that when I compile my MATLAB code in which it calls my C functions (of course I have already written <code>mex hello1.c</code> and <code>mex hello2.c</code>), MATLAB returns me the screen which exhibits that MATLAB has encountered an internal problem and needs to close. In fact this error was detected while a MEX-file was running.</p>\n\n<p>Is this because my functions <code>mexFunction</code> are not written correctly? Can anyone who knows how to write MEX functions help me? </p>\n\n<p>Any help will be very appreciated!</p>\n"}, {"tags": ["c", "macos", "utf-8", "posix"], "comments": [{"owner": {"reputation": 486140, "user_id": 1187415, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/LpTRB.png?s=128&g=1", "display_name": "Martin R", "link": "https://stackoverflow.com/users/1187415/martin-r"}, "edited": false, "score": 2, "creation_date": 1469028206, "post_id": 38484369, "comment_id": 64371311, "body": "I <i>assume</i> that the path is always decomposed on the HFS+ file system level, so it does not matter what you pass in."}, {"owner": {"reputation": 269328, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "edited": false, "score": 1, "creation_date": 1469028437, "post_id": 38484369, "comment_id": 64371442, "body": "The file system is also case insensitive, isn&#39;t it? This would be the same as passing the wrong case letters to <code>fopen</code>. The internal mechanism to search for a filename probably handles both cases the same way."}, {"owner": {"reputation": 63488, "user_id": 729881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fdfaf0aad74fef442e2ffc9999ef9c1?s=128&d=identicon&r=PG", "display_name": "Edward Thomson", "link": "https://stackoverflow.com/users/729881/edward-thomson"}, "edited": false, "score": 0, "creation_date": 1469028520, "post_id": 38484369, "comment_id": 64371489, "body": "But what did <code>readdir</code> return?"}, {"owner": {"reputation": 6668, "user_id": 1197719, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/a11ff3ed53b29c71863d5e0f740e9c1d?s=128&d=identicon&r=PG", "display_name": "Andreas", "link": "https://stackoverflow.com/users/1197719/andreas"}, "reply_to_user": {"reputation": 63488, "user_id": 729881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fdfaf0aad74fef442e2ffc9999ef9c1?s=128&d=identicon&r=PG", "display_name": "Edward Thomson", "link": "https://stackoverflow.com/users/729881/edward-thomson"}, "edited": false, "score": 0, "creation_date": 1469031666, "post_id": 38484369, "comment_id": 64373632, "body": "@EdwardThomson: As I wrote in my original posting, POSIX APIs all return decomposed UTF-8. <code>readdir()</code> is no exception here."}, {"owner": {"reputation": 6668, "user_id": 1197719, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/a11ff3ed53b29c71863d5e0f740e9c1d?s=128&d=identicon&r=PG", "display_name": "Andreas", "link": "https://stackoverflow.com/users/1197719/andreas"}, "reply_to_user": {"reputation": 486140, "user_id": 1187415, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/LpTRB.png?s=128&g=1", "display_name": "Martin R", "link": "https://stackoverflow.com/users/1187415/martin-r"}, "edited": false, "score": 0, "creation_date": 1469031726, "post_id": 38484369, "comment_id": 64373667, "body": "@MartinR: I still don&#39;t understand this. Isn&#39;t it possible in this case that the string passed to <code>fopen()</code> matches two different files? How does <code>fopen()</code> choose a file then?"}, {"owner": {"reputation": 486140, "user_id": 1187415, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/LpTRB.png?s=128&g=1", "display_name": "Martin R", "link": "https://stackoverflow.com/users/1187415/martin-r"}, "edited": false, "score": 0, "creation_date": 1469034029, "post_id": 38484369, "comment_id": 64374962, "body": "@Andreas: fopen() does not &quot;choose a file&quot;. It passes the file name to the open() system call which in turn passes the file name to the file system. The file system does whatever is necessary to find and open the file. In the HFS+ case, the file name is normalised (decomposed). If successful, a file descriptor is passed back."}, {"owner": {"reputation": 6668, "user_id": 1197719, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/a11ff3ed53b29c71863d5e0f740e9c1d?s=128&d=identicon&r=PG", "display_name": "Andreas", "link": "https://stackoverflow.com/users/1197719/andreas"}, "reply_to_user": {"reputation": 486140, "user_id": 1187415, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/LpTRB.png?s=128&g=1", "display_name": "Martin R", "link": "https://stackoverflow.com/users/1187415/martin-r"}, "edited": false, "score": 0, "creation_date": 1469039935, "post_id": 38484369, "comment_id": 64378438, "body": "@MartinR: I don&#39;t really care who chooses the file in the end. The main issue I was trying to describe is this: Can&#39;t it happen that a string passed to fopen() describes two different files depending on whether the string is interpreted as precomposed UTF-8 or decomposed UTF-8? I don&#39;t know much about the internals of precomposed vs. decomposed UTF-8 so I can&#39;t tell. I was just wondering if this could happen in theory because AFAICS there&#39;s no reliable way for the file system to tell whether the string it got from fopen() or open() or whatever is precomposed or decomposed UTF-8..."}, {"owner": {"reputation": 6668, "user_id": 1197719, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/a11ff3ed53b29c71863d5e0f740e9c1d?s=128&d=identicon&r=PG", "display_name": "Andreas", "link": "https://stackoverflow.com/users/1197719/andreas"}, "reply_to_user": {"reputation": 486140, "user_id": 1187415, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/LpTRB.png?s=128&g=1", "display_name": "Martin R", "link": "https://stackoverflow.com/users/1187415/martin-r"}, "edited": false, "score": 0, "creation_date": 1469223887, "post_id": 38484369, "comment_id": 64465036, "body": "@MartinR: Behaviour doesn&#39;t seem limited to HFS+ interactions. It even happens with standard printf calls to stdout. See my edits in the OP."}], "answers": [{"tags": [], "owner": {"reputation": 579, "user_id": 5394746, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/8bb8432bfdfa5edf2c5c8b4e7f3a2ca6?s=128&d=identicon&r=PG&f=1", "display_name": "cesss", "link": "https://stackoverflow.com/users/5394746/cesss"}, "is_accepted": true, "score": 1, "last_activity_date": 1515327852, "creation_date": 1515327852, "answer_id": 48137055, "question_id": 38484369, "link": "https://stackoverflow.com/questions/38484369/why-does-the-c-runtime-on-mac-os-allow-both-precomposed-and-decomposed-utf-8/48137055#48137055", "title": "Why does the C runtime on Mac OS allow both precomposed and decomposed UTF-8?", "body": "<p>There're two different types of equivalence in Unicode strings: One thing is <em>canonical equivalence</em>, and another is <em>compatibility</em>. Since your question is about strings that seem to be considered identical by the software, let's focus in <strong>canonical equivalence</strong> (OTOH, <em>compatibility</em> allows for semantic differences, so it's off-topic in this question).</p>\n\n<p>Citing from <a href=\"https://en.wikipedia.org/wiki/Unicode_equivalence\" rel=\"nofollow noreferrer\">Unicode equivalence</a> in Wikipedia:</p>\n\n<blockquote>\n  <p>Code point sequences that are defined as <strong>canonically equivalent</strong> are\n  assumed to have the same appearance and meaning when printed or\n  displayed. For example, the code point U+006E (the Latin lowercase\n  \"n\") followed by U+0303 (the combining tilde \"\u25cc\u0303\") is defined by\n  Unicode to be canonically equivalent to the single code point U+00F1\n  (the lowercase letter \"\u00f1\" of the Spanish alphabet). <strong>Therefore, those\n  sequences should be displayed in the same manner, should be treated in\n  the same way by applications such as alphabetizing names or searching,\n  and may be substituted for each other</strong>.</p>\n</blockquote>\n\n<p>In other words, if two strings are <strong>canonically equivalent</strong>, the software should consider the two strings <strong>represent exactly the same thing</strong>. So, MacOS is doing the correct thing here: You have two different UTF-8 strings (one decomposed, another precomposed), but they are <strong>canonically equivalent</strong>, so they map to the same object (the same file name in your example). That's correct (remember the <em>\"should be treated in the same way by applications such as alphabetizing names or searching, and may be substituted for each other\"</em> line in the quote above).</p>\n\n<p>I don't really understand your second example about <code>printf()</code>. Yes, both a decomposed character and a precomposed character render the same output. That's precisely the point in the dual representation of characters supported by Unicode: You can choose whether to represent a combined character with a precomposed sequence of bytes, or a decomposed sequence of bytes. They print the same visual result, but their representation is different. If both representations are <strong>canonically equivalent</strong> (in some cases they are, in some cases they are not), then the system must consider them as two representations of the same object.</p>\n\n<p>In order to manage all of this more comfortably in your software, you should <a href=\"https://en.wikipedia.org/wiki/Unicode_equivalence#Normalization\" rel=\"nofollow noreferrer\">normalize your Unicode strings</a> before working with them.</p>\n"}], "owner": {"reputation": 6668, "user_id": 1197719, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/a11ff3ed53b29c71863d5e0f740e9c1d?s=128&d=identicon&r=PG", "display_name": "Andreas", "link": "https://stackoverflow.com/users/1197719/andreas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 153, "favorite_count": 2, "accepted_answer_id": 48137055, "answer_count": 1, "score": 3, "last_activity_date": 1515327852, "creation_date": 1469025678, "last_edit_date": 1469223846, "question_id": 38484369, "link": "https://stackoverflow.com/questions/38484369/why-does-the-c-runtime-on-mac-os-allow-both-precomposed-and-decomposed-utf-8", "title": "Why does the C runtime on Mac OS allow both precomposed and decomposed UTF-8?", "body": "<p>So we all know that the filesystem on Mac OS has this wacky feature of using fully decomposed UTF-8. If you call POSIX APIs like <code>realpath()</code>, for example, you'll get such a fully decomposed UTF-8 string back from Mac OS. When using APIs like <code>fopen()</code>, however, passing precomposed UTF-8 seems to work as well.</p>\n\n<p>Here is a little demo program which attempts to open a file named <code>\u00e4</code>. The first call to <code>fopen()</code> passes a precomposed UTF-8 string, the second call passes a decomposed UTF-8 string and to my surprise both work. I'd expect only the second one to work but precomposed UTF-8 works as well.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(int argc, char *argv[])\n{\n    FILE *fp, *fp2;\n\n    fp = fopen(\"\\xc3\\xa4\", \"rb\");       // \u00e4 as precomposed UTF-8\n    fp2 = fopen(\"\\x61\\xcc\\x88\", \"rb\");  // \u00e4 as decomposed UTF-8\n\n    printf(\"CHECK: %p %p\\n\", fp, fp2);\n\n    if(fp) fclose(fp);\n    if(fp2) fclose(fp2);\n\n    return 0;\n}\n</code></pre>\n\n<p>Now to my questions:</p>\n\n<ol>\n<li><p>Is this defined behaviour? i.e. is it allowed to pass precomposed UTF-8 to POSIX APIs or should I always pass decomposed UTF-8?</p></li>\n<li><p>How can functions like <code>fopen()</code> even know whether the file passed contains precomposed or decomposed UTF-8? Couldn't this even lead to all sorts of issues, e.g. wrong files being opened because the passed string can be interpreted in two different ways and thus potentially point to two different files? This is somewhat confusing me.</p></li>\n</ol>\n\n<p><strong><em>EDIT</em></strong></p>\n\n<p>To make the confusion complete, this weird behaviour doesn't even seem to be limited to file I/O. Take a look at this code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(int argc, char *argv[])\n{\n    printf(\"\\xc3\\xa4\\n\");\n    printf(\"\\x61\\xcc\\x88\\n\");\n\n    return 0;\n}\n</code></pre>\n\n<p>Both <code>printf</code> calls do exactly the same, i.e. they both print the character <code>\u00e4</code>, the first call using precomposed UTF-8 and the second one using decomposed UTF-8. It's really weird.</p>\n"}, {"tags": ["c", "snmp", "snmptrapd"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 4549959, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206299073342430/picture?type=large", "display_name": "Tarik", "link": "https://stackoverflow.com/users/4549959/tarik"}, "edited": false, "score": 0, "creation_date": 1470162285, "post_id": 38495948, "comment_id": 64831642, "body": "Hello, I wanted to thank you. It is working . Now what I get is bench of numbers. I think I am receiving the ASN.1 message. I think I have to decode the message in a script."}], "tags": [], "owner": {"reputation": 8116, "user_id": 909655, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70d8d9d24942b0fe339ecedeb2c4c5e7?s=128&d=identicon&r=PG", "display_name": "Mats", "link": "https://stackoverflow.com/users/909655/mats"}, "is_accepted": true, "score": 1, "last_activity_date": 1469080612, "creation_date": 1469080612, "answer_id": 38495948, "question_id": 38484287, "link": "https://stackoverflow.com/questions/38484287/how-to-decode-the-result-of-listenning-to-port-162-snmp-trap/38495948#38495948", "title": "how to decode the result of listenning to port 162 (Snmp Trap)?", "body": "<p>Short answer; it is the memory address of <code>msg</code> written in octal.</p>\n\n<p>If you are running this code on a little-endian machine with 32-bit <code>int</code> and 64-bit pointers, it is most likely the lower 32 bits of the address of <code>msg</code>.</p>\n\n<p>This is due to a combination of two thins:</p>\n\n<ol>\n<li><p>The <code>printf</code> format specifier <code>%o</code> interprets the next bytes in the argument data as an integer and prints it in octal.</p></li>\n<li><p>Passing an array as an argument to a function is converted into passing a pointer to the first element. So these statements are equivalent:</p>\n\n<pre><code>printf(\"%p\\n\", msg);\nprintf(\"%p\\n\", &amp;msg[0]);\n</code></pre></li>\n</ol>\n\n<p>To actually print the data you received, add the following:</p>\n\n<pre><code>for (int i = 0; i &lt; n; ++i) {\n    printf(\"%02x \", (unsigned char)msg[i]);\n}\nprintf(\"\\n\");\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 4549959, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206299073342430/picture?type=large", "display_name": "Tarik", "link": "https://stackoverflow.com/users/4549959/tarik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 839, "favorite_count": 1, "accepted_answer_id": 38495948, "answer_count": 1, "score": 1, "last_activity_date": 1469080612, "creation_date": 1469025480, "question_id": 38484287, "link": "https://stackoverflow.com/questions/38484287/how-to-decode-the-result-of-listenning-to-port-162-snmp-trap", "title": "how to decode the result of listenning to port 162 (Snmp Trap)?", "body": "<p>I want to get the snmp trap by using my own traplistener. In fact, I used a code found in internet I added some modifications and now it is working. I can listen through the port 162.</p>\n\n<pre><code>#include \"stdio.h\"\n#include \"winsock2.h\"\n#pragma comment(lib, \"ws2_32.lib\")\n#define SNMP_TRAP_PORT 162\n#define MAX_MSG 400\n\nstatic void init(void)\n{\n\n  WSADATA wsa;\n    int err = WSAStartup(MAKEWORD(2, 2), &amp;wsa);\n    if(err &lt; 0)\n    {\n        puts(\"WSAStartup failed !\");\n        exit(EXIT_FAILURE);\n    }\n\n}\n\nstatic void end(void)\n{\n\n    WSACleanup();\n\n}\n\nint main(int argc, char *argv[]) {\n\n\n  int sd, rc, n, cliLen;\n  struct sockaddr_in cliAddr, servAddr;\n  char msg[MAX_MSG];\n\n\n\n  /* socket creation */\n  init(); \n  sd= socket(AF_INET, SOCK_DGRAM, 0);\n  if(sd&lt;0) {\n    printf(\"can't open socket \\n\");\n    exit(1);\n  }\n\n  /* bind local server port */\n  servAddr.sin_family = AF_INET;\n  servAddr.sin_addr.s_addr = htonl(INADDR_ANY);\n  servAddr.sin_port = htons(SNMP_TRAP_PORT);\n  rc = bind (sd, (struct sockaddr *) &amp;servAddr,sizeof(servAddr));\n  if(rc&lt;0) {\n    printf(\"can't bind port number %d \\n\", SNMP_TRAP_PORT);\n    exit(1);\n  }\n\n  printf(\"waiting for SNMP Traps on UDP port %d\\n\", SNMP_TRAP_PORT);\n\n  /* server infinite loop */\n  while(1) {\n\n    /* init buffer */\n    memset(msg,0x0,MAX_MSG);\n\n\n    /* receive message */\n    cliLen = sizeof(cliAddr);\n    n = recvfrom(sd, msg, MAX_MSG, 0, (struct sockaddr *) &amp;cliAddr, &amp;cliLen);\n\n    if(n&lt;0) {\n      printf(\"%s: cannot receive data \\n\",argv[0]);\n      continue;\n    }\n    /*message is encoded with ASN1 and should be decoded*/  \n    /* print received message */\n    printf(\"SNMP Trap received from %s : %o\\n\", inet_ntoa(cliAddr.sin_addr),msg);\n\n\n  }/* end of server infinite loop */\nend();\nreturn 0;\n\n}\n</code></pre>\n\n<p>The code works fine now when I get traps I receive a number. Normally, I should get the trap in ASN1 (hex or bin) but I get just this: <a href=\"http://i.stack.imgur.com/bmXCq.png\" rel=\"nofollow\">Traplistner result</a>.\nI was wondering what does the 12175440 means.\nThx </p>\n"}, {"tags": ["c", "structure"], "comments": [{"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 1, "creation_date": 1469025490, "post_id": 38484213, "comment_id": 64370746, "body": "<code>scanf(&quot;%d&quot;, &amp;choice-&gt;numerator); ... scanf(&quot;%d&quot;, &amp;choice-&gt;denominator); </code>"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1469025606, "post_id": 38484213, "comment_id": 64370863, "body": "<code>simplify</code> is divided by the GCM."}, {"owner": {"reputation": 13866, "user_id": 54200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6261c8ab215b8069e8290516c80445d8?s=128&d=identicon&r=PG", "display_name": "KevinDTimm", "link": "https://stackoverflow.com/users/54200/kevindtimm"}, "edited": false, "score": 0, "creation_date": 1469029157, "post_id": 38484213, "comment_id": 64371899, "body": "<code>I tried running it and my program broke.</code> is not a problem statement. Please specify the actual errors you get in the future."}], "answers": [{"tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": false, "score": 2, "last_activity_date": 1469025548, "creation_date": 1469025548, "answer_id": 38484311, "question_id": 38484213, "link": "https://stackoverflow.com/questions/38484213/new-to-structs-how-come-my-program-is-not-running/38484311#38484311", "title": "New to structs, how come my program is not running?", "body": "<p><strong>Problem 1</strong></p>\n\n<p>The lines</p>\n\n<pre><code>    scanf(\"%d\", choice-&gt;numerator);\n    scanf(\"%d\", choice-&gt;denominator);\n</code></pre>\n\n<p>need to be:</p>\n\n<pre><code>    scanf(\"%d\", &amp;choice-&gt;numerator);\n    scanf(\"%d\", &amp;choice-&gt;denominator);\n    //         ^^ Missing\n</code></pre>\n\n<p><strong>Problem 2</strong></p>\n\n<p>The following lines:</p>\n\n<pre><code>    reduce-&gt;numerator = reduce-&gt;numerator / reduce-&gt;numerator;\n    reduce-&gt;denominator = reduce-&gt;denominator / reduce-&gt;denominator;\n</code></pre>\n\n<p>are equivalent to:</p>\n\n<pre><code>    reduce-&gt;numerator = 1.0;\n    reduce-&gt;denominator = 1.0;\n</code></pre>\n\n<p>You need code to compute the GCD of the numerator and denominator and then use:</p>\n\n<pre><code>    double gcd = get_gcd(reduce-&gt;numerator, reduce-&gt;denominator);\n    reduce-&gt;numerator = reduce-&gt;numerator/gcd;\n    reduce-&gt;denominator = reduce-&gt;denominator/gcd;\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6609798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85bbc45d9b544fa8857ce694b6f2c7c5?s=128&d=identicon&r=PG&f=1", "display_name": "Cnoobie", "link": "https://stackoverflow.com/users/6609798/cnoobie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1469025548, "creation_date": 1469025292, "last_edit_date": 1469025476, "question_id": 38484213, "link": "https://stackoverflow.com/questions/38484213/new-to-structs-how-come-my-program-is-not-running", "title": "New to structs, how come my program is not running?", "body": "<p>The program asks the user for a numerator and denominator in the enter function, then it needs to simplify and then display it.\nI tried running it and my program broke.</p>\n\n<p>Any tips on how to do this?</p>\n\n<p>I am still trying to learn how to do structures.</p>\n\n<pre><code>    #define _CRT_SECURE_NO_WARNINGS\n    #include &lt;stdio.h&gt;\n\n    struct Fraction\n    {\n        int numerator;\n        int denominator;\n    };\n\n    void enter(struct Fraction *choice)\n    {\n        printf(\"Numerator: \\n\");\n        scanf(\"%d\", choice-&gt;numerator);\n\n        printf(\"Denominator: \\n\");\n        scanf(\"%d\", choice-&gt;denominator);\n    }\n\n    void simplify(struct Fraction *reduce)\n    {\n        reduce-&gt;numerator = reduce-&gt;numerator / reduce-&gt;numerator;\n        reduce-&gt;denominator = reduce-&gt;denominator / reduce-&gt;denominator;\n    }\n\n    void display(const struct Fraction *show)\n    {\n        printf(\"%d / %d\", show-&gt;numerator, show-&gt;denominator);\n    }\n\n    int main(void)\n    {\n        struct Fraction f;\n\n        printf(\"Fraction Simplifier\\n\");\n        printf(\"===================\\n\");\n\n        enter(&amp;f);\n        simplify(&amp;f);\n        display(&amp;f);\n    }\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1469024478, "post_id": 38483867, "comment_id": 64369984, "body": "What from the man-page of <code>scanf</code> did you not understand?"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1469024832, "post_id": 38483867, "comment_id": 64370263, "body": "<a href=\"http://stackoverflow.com/questions/4264127/correct-format-specifier-for-double-in-printf\" title=\"correct format specifier for double in printf\">stackoverflow.com/questions/4264127/&hellip;</a> Read (at least the last part of) the accepted answer."}], "answers": [{"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 2, "last_activity_date": 1469025789, "creation_date": 1469025789, "answer_id": 38484405, "question_id": 38483867, "link": "https://stackoverflow.com/questions/38483867/error-in-c-concerning-double-float-variable-assignment/38484405#38484405", "title": "Error in C concerning double, float variable assignment", "body": "<p>The <code>%f</code> format specifier for <code>scanf</code> expects a pointer to a <code>float</code>, not a <code>double</code>.  This is significant because the two are different sizes.  Passing in the address of a <code>double</code> will result in some but not all of the bytes comprising the <code>double</code> to be populated, resulting in undefined behavior.</p>\n\n<p>To read a value into a <code>double</code>, use <code>%lf</code>.</p>\n\n<pre><code>double height;\nscanf(\"%lf\",&amp;height);\n</code></pre>\n"}], "owner": {"reputation": 1692, "user_id": 6588224, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/fa171624f6e8b69a48e9f0b71a5dcd1a?s=128&d=identicon&r=PG&f=1", "display_name": "Jin", "link": "https://stackoverflow.com/users/6588224/jin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 38484405, "answer_count": 1, "score": -2, "last_activity_date": 1469025789, "creation_date": 1469024431, "question_id": 38483867, "link": "https://stackoverflow.com/questions/38483867/error-in-c-concerning-double-float-variable-assignment", "title": "Error in C concerning double, float variable assignment", "body": "<pre><code>#include &lt;stdio.h&gt;\n\nint main(void)\n{\n    double height; //Error happens if I write double height instead of float height! \n    printf(\"Height(inch): \");\n    scanf(\"%f\",&amp;height);\n    printf(\"%f inch = %f cm \\n\",height,height*2.54);\n}\n</code></pre>\n\n<p>As you can see in the comment, error happens if I write double height instead of float height! What's wrong with my code? </p>\n"}, {"tags": ["c", "recursion"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1469024290, "post_id": 38483743, "comment_id": 64369823, "body": "Compare the two codes.  What do they do differently?  Since your question is related to the order of the output data, pay especial attention to the order of operations.  Hint: assigning the function result to a variable does not, in itself, have anything to do with it.  It wouldn&#39;t be hard to rewrite the second code to do that, too, without changing its observable behavior."}, {"owner": {"reputation": 4046, "user_id": 4971422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4abf51a937ddda51cc6813445605c50?s=128&d=identicon&r=PG&f=1", "display_name": "FredK", "link": "https://stackoverflow.com/users/4971422/fredk"}, "edited": false, "score": 0, "creation_date": 1469024470, "post_id": 38483743, "comment_id": 64369977, "body": "Try working it out with a pencil and a piece of paper. What happens when youcall function(12345) ? For case 2, it fails the n%10&lt;5 test, so it next calls function(1234). that passes the test, so it prints &quot;4&quot;. And so on."}], "answers": [{"tags": [], "owner": {"reputation": 13191, "user_id": 4990642, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/xY0PD.jpg?s=128&g=1", "display_name": "snr", "link": "https://stackoverflow.com/users/4990642/snr"}, "is_accepted": false, "score": 0, "last_activity_date": 1469024776, "creation_date": 1469024776, "answer_id": 38484000, "question_id": 38483743, "link": "https://stackoverflow.com/questions/38483743/assigning-a-function-call-to-a-variable-in-a-recursion-results-in-different-outp/38484000#38484000", "title": "Assigning a function call to a variable in a recursion results in different output", "body": "<p>Even if I like to deal with recursions, I sometimes still have difficulty in. In   <code>int r = function(n/10);</code> , your function goes until knock against <code>0</code>. When knocked, because of stack structure, numbers comes 1-2-3-4-5 in that order. (Look LIFO). In this order process going print 1-2-3-4-5. For second code, after checking <code>if(n%10&lt;5)</code> you are already running  first <code>printf(\"%d\", n%10);</code> so it begins with 5-4-3-2-1 then runnig <code>function(n/10)+1;</code> so it again divides <code>1234 / 10</code>, <code>123/10</code>, <code>....</code> in process until knock against <code>0</code>. IMHO, recursion can be better understood, if one gets stack structure well.</p>\n"}, {"tags": [], "owner": {"reputation": 2488, "user_id": 6600109, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60d018ddca1b281e434c1ae6696a0195?s=128&d=identicon&r=PG&f=1", "display_name": "Markus Laire", "link": "https://stackoverflow.com/users/6600109/markus-laire"}, "is_accepted": true, "score": 0, "last_activity_date": 1469025531, "creation_date": 1469025531, "answer_id": 38484305, "question_id": 38483743, "link": "https://stackoverflow.com/questions/38483743/assigning-a-function-call-to-a-variable-in-a-recursion-results-in-different-outp/38484305#38484305", "title": "Assigning a function call to a variable in a recursion results in different output", "body": "<p>In first example you call function before printing, so calls and prints happen in this order:</p>\n\n<pre><code>call function(12345)\n&gt; call function(1234)\n&gt;&gt; call function(123)\n&gt;&gt;&gt; call function(12)\n&gt;&gt;&gt;&gt; call function(1)\n&gt;&gt;&gt;&gt;&gt; call function(0)\n&gt;&gt;&gt;&gt;&gt;&gt; immediate return\n&gt;&gt;&gt;&gt;&gt; print 1\n&gt;&gt;&gt;&gt; print 2\n&gt;&gt;&gt; print 3\n&gt;&gt; print 4\n&gt; no print\n</code></pre>\n\n<p>In second example you print first and then call function, so order is:</p>\n\n<pre><code>call function(12345)\n&gt; no print\n&gt; call function(1234)\n&gt;&gt; print 4\n&gt;&gt; call function(123)\n&gt;&gt;&gt; print 3\n&gt;&gt;&gt; call function(12)\n&gt;&gt;&gt;&gt; print 2\n&gt;&gt;&gt;&gt; call function(1)\n&gt;&gt;&gt;&gt;&gt; print 1\n&gt;&gt;&gt;&gt;&gt; call function(0)\n&gt;&gt;&gt;&gt;&gt;&gt; immediate return\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 5740454, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20dd21bf5d782ad11489b8894c621df1?s=128&d=identicon&r=PG&f=1", "display_name": "John Gray", "link": "https://stackoverflow.com/users/5740454/john-gray"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 38484305, "answer_count": 2, "score": 0, "last_activity_date": 1469025531, "creation_date": 1469024050, "last_edit_date": 1469024449, "question_id": 38483743, "link": "https://stackoverflow.com/questions/38483743/assigning-a-function-call-to-a-variable-in-a-recursion-results-in-different-outp", "title": "Assigning a function call to a variable in a recursion results in different output", "body": "<p>Below are two similar examples that define a recursive function which will print the digits of a number that are smaller than 5  while also counting them.</p>\n\n<blockquote>\n  <p>Input: 12345<br>\n  Output: 1234  : 4         //There are 4 digits smaller than 5</p>\n</blockquote>\n\n<hr>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint function(int n) {\n    if(!n) return 0;\n\n    int r = function(n/10); \n\n    if ((n%10) &lt; 5) {\n        printf(\"%d\", n%10);\n        return r+1;\n    }\n    else return r;\n}\n\nint main() {\n    int  x;\n\n    scanf(\"%d\", &amp;x);\n    printf(\" : %d\\n\", function(x));\n\n    return 0;\n}\n</code></pre>\n\n<hr>\n\n<hr>\n\n<p>Second code which has the same functionality, <strong><em>but prints everything in reverse that I cannot seem to understand.</em></strong> I am not fluid in programming and still new to it so I hope the question is clearly stated.</p>\n\n<blockquote>\n  <p>Input: 12345<br>\n  Output: 4321: 4</p>\n</blockquote>\n\n<hr>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint function(int n) {\n    if(!n) return 0;\n\n    if(n%10&lt;5) {\n        printf(\"%d\", n%10);\n        return function(n/10)+1;\n    }\n    return function(n/10);\n}\n\nint main() {\n    int x;\n\n    scanf(\"%d\", &amp;x);\n    printf(\" : %d\\n\", function(x));\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "redirect", "process", "io"], "comments": [{"owner": {"reputation": 52445, "user_id": 1253222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3a62746fb04e19c1656cd1df560911f?s=128&d=identicon&r=PG", "display_name": "twalberg", "link": "https://stackoverflow.com/users/1253222/twalberg"}, "edited": false, "score": 1, "creation_date": 1469037362, "post_id": 38483740, "comment_id": 64376905, "body": "&quot;cannot use fork() as this leads to doubling the required memory&quot; - umm, no it doesn&#39;t. The only way it would do that is if you modified every single page of memory in your process memory map after the <code>fork()</code>. <code>fork()</code> under Linux uses copy-on-write semantics to share/duplicate the parents address space."}, {"owner": {"reputation": 51, "user_id": 28215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/654a9c1fb71551886da644b24736e111?s=128&d=identicon&r=PG", "display_name": "DaGN", "link": "https://stackoverflow.com/users/28215/dagn"}, "reply_to_user": {"reputation": 52445, "user_id": 1253222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3a62746fb04e19c1656cd1df560911f?s=128&d=identicon&r=PG", "display_name": "twalberg", "link": "https://stackoverflow.com/users/1253222/twalberg"}, "edited": false, "score": 0, "creation_date": 1469050366, "post_id": 38483740, "comment_id": 64383976, "body": "Thanks @twalberg ! I was under the impresion that <code>fork()</code> of a large process (large executable that uses a lot of memory for data) duplicate the entire process, at least until you run <code>exec()</code>, or one of derivatives."}], "owner": {"reputation": 51, "user_id": 28215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/654a9c1fb71551886da644b24736e111?s=128&d=identicon&r=PG", "display_name": "DaGN", "link": "https://stackoverflow.com/users/28215/dagn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1469024043, "creation_date": 1469024043, "question_id": 38483740, "link": "https://stackoverflow.com/questions/38483740/how-to-reacquire-stdin-in-a-restarted-process", "title": "How to reacquire stdin in a restarted process?", "body": "<p>I have written a C application that is started in a (gnome) terminal with 'sudo' and has an interactive CLI, to get user commands and print back feedback. It must be started under sudo as some of the internal operations require that.</p>\n\n<p>A possible command is to do (self) 'sw-upgrade' from a *.tar.gz file.\nSince the machine's memory is limited, I cannot use fork() as this leads to doubling the required memory. So I've written a bash script, invoked from the application by calling <code>posix_spawn(/bin/bash -c sw_load.sh)</code>, to kill the original application and start the new one.\nIt seems to be working except for...</p>\n\n<p>Issue#1: Ideally I would like to restart the application in the background (with an &amp; at the end) but then I loose stdin and the user cannot enter any commands (the CLI engine reports FALSE for <code>isatty(fileno(stdin))</code> as <code>ttyname(fileno(stdin))</code> is empty.\nIs there a way to pass the terminal's stdin (or maybe the TTY/PTY?) to a background process? Or even better, have the application get it by itself?</p>\n\n<p>Issue#2: So, due to issue#1, I'm <strong>not</strong> restarting the application in the <strong>background</strong>, but in the foreground.\nI've added a call to <code>setsid()</code> right at the beginning of <code>main()</code>, to become a session leader (I can leave the sw_load.sh running or kill it, it does not matter...). Now I have some stdin working, but it gets <strong>mixed</strong> up with the bash prompt: Sometimes I get the application prompt and sometimes (or after some  keys) the bash prompt! Sometimes a typed in command is parsed by the application's CLI engine and sometime by bash. Could not find any pattern when one or the other. Can anyone shed some light on why this happens and how to fix this?</p>\n\n<p><em>Note: I've running this either in a CentOS6.7 or Ubuntu12.04 VirtualBox VM</em></p>\n\n<p>Thanks!</p>\n"}, {"tags": ["c", "openssl", "x509", "der"], "comments": [{"owner": {"reputation": 3267, "user_id": 10992173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e89f4e8e1572a941554283f29a908620?s=128&d=identicon&r=PG&f=1", "display_name": "f9c69e9781fa194211448473495534", "link": "https://stackoverflow.com/users/10992173/f9c69e9781fa194211448473495534"}, "edited": false, "score": 1, "creation_date": 1599519843, "post_id": 38483638, "comment_id": 112792811, "body": "I understand the queston has been answered here: <a href=\"https://mta.openssl.org/pipermail/openssl-users/2016-July/004079.html\" rel=\"nofollow noreferrer\">mta.openssl.org/pipermail/openssl-users/2016-July/004079.htm&zwnj;&#8203;l</a>"}], "owner": {"reputation": 10100, "user_id": 590028, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/43c6ce77252e438b40b96f5c68cf3432?s=128&d=identicon&r=PG", "display_name": "user590028", "link": "https://stackoverflow.com/users/590028/user590028"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 390, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1469023773, "creation_date": 1469023773, "question_id": 38483638, "link": "https://stackoverflow.com/questions/38483638/how-to-convert-stack-ofx509-to-der-in-openssl-1-1-0", "title": "How to convert STACK_OF(X509) to DER in OpenSSL 1.1.0?", "body": "<p>While working on porting from OpenSSL 0.9.8 to 1.1.0, I have run into a missing function. The OpenSSL team has been busy cleaning up their code base, and one of the cleanups was to remove some ASN handling macros &amp; functions. We used to be able convert from a <code>STACK_OF(X509)</code> certs to <code>DER</code> with the following bit of code:</p>\n\n<p><em>note: error handling removed for brevity of the example</em></p>\n\n<pre><code>PyObject* get_der(STACK_OF(X509) *stack) {\n    unsigned char* enc\n    int len;\n    enc = ASN1_seq_pack_X509(stack, i2d_X509, NULL, &amp;len);\n    return PyString_FromString(enc, len)\n    }\n</code></pre>\n\n<p>This no longer links and the build process errors out with unresolved external symbol.</p>\n\n<p>I've checked the 0.9.8 code base, and found that <code>ASN1_seq_pack_X509</code> was a macro.  After tracking into deeply nested macros, I discovered that my call above would finally look like this:</p>\n\n<pre><code>ASN1_seq_pack(X509, stack, i2d_X509, NULL, &amp;len)\n</code></pre>\n\n<p>And <code>ASN1_seq_pack</code> no longer exists in OpenSSL 1.1.0.  So here's my question. How should one convert from <code>STACK_OF(X509)</code> to <code>DER</code>?</p>\n"}, {"tags": ["c", "arduino", "avr-gcc"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1469022964, "post_id": 38483311, "comment_id": 64368808, "body": "<i>I am wondering if there&#39;s any drawbacks in keeping Arduino as the framework?</i> - Arduino framework is a one big drawback."}, {"owner": {"reputation": 834, "user_id": 6331184, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/468bc3e65322011f19839ef9ab7acc38?s=128&d=identicon&r=PG", "display_name": "Cedric", "link": "https://stackoverflow.com/users/6331184/cedric"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1469023485, "post_id": 38483311, "comment_id": 64369224, "body": "To reformulate: <i>I am wondering if, by not using or including any of the Arduino framework stuff, the frameworks skips the drawbacks of Arduino.</i> On a personal note: I&#39;ve used Arduino and found it bulky and not really adaptable. Reading on embedded programming made me stop using it."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1469024376, "post_id": 38483311, "comment_id": 64369895, "body": "If you are asking if the AVR MCUs are any good without using Arduino stuff, I would say they are pretty capable by themselves. The problem, as I can recall, is with limited debugging capabilities."}, {"owner": {"reputation": 834, "user_id": 6331184, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/468bc3e65322011f19839ef9ab7acc38?s=128&d=identicon&r=PG", "display_name": "Cedric", "link": "https://stackoverflow.com/users/6331184/cedric"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1469024919, "post_id": 38483311, "comment_id": 64370341, "body": "Thanks for your reply! But it is not what I&#39;m asking. I programmed in ANSI-C without using any of the Arduino stuff (which means I&#39;m programming without a setup() and loop() block and using registers to set the pins, the ADC and the timers). PlatformIO only gives me the Arduino framework, but it builds my code nonetheless. I was wondering it there is any performance decrease in doing so (not directly compiling using avr-gcc). Thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1469024563, "post_id": 38483872, "comment_id": 64370050, "body": "AVRStudio is a good choice for working with AVRs on low level. Setting up the Eclipse to work with it is not trivial."}, {"owner": {"reputation": 834, "user_id": 6331184, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/468bc3e65322011f19839ef9ab7acc38?s=128&d=identicon&r=PG", "display_name": "Cedric", "link": "https://stackoverflow.com/users/6331184/cedric"}, "edited": false, "score": 0, "creation_date": 1469025372, "post_id": 38483872, "comment_id": 64370661, "body": "I should have emphasize on the fact that I am not using any Arduino framework tools. There&#39;s no such thing as SPI for the ATTiny on Arduino, as it uses a common bus for both SPI, I2C and USART. Thus, I&#39;ve really only used what is basically defined in avr-gcc. I felt like Platform.oi could be my got-to editor for any embedded projects (since it is built upon atom.io, with git integration and project management), without having to write a makefile to build and upload my code. Seems like I&#39;ll just get back to Sublime for now."}, {"owner": {"reputation": 22847, "user_id": 1290438, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b689dcfa3833cb016dfbc4cc82bb0eae?s=128&d=identicon&r=PG", "display_name": "zmo", "link": "https://stackoverflow.com/users/1290438/zmo"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1469028666, "post_id": 38483872, "comment_id": 64371577, "body": "@EugeneSh. I&#39;m not a windows user, and the few times I tried AVRStudio never convinced me to switch to it, far from that actually. TBH, I find it very bloated and inconvenient to use."}, {"owner": {"reputation": 22847, "user_id": 1290438, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b689dcfa3833cb016dfbc4cc82bb0eae?s=128&d=identicon&r=PG", "display_name": "zmo", "link": "https://stackoverflow.com/users/1290438/zmo"}, "reply_to_user": {"reputation": 834, "user_id": 6331184, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/468bc3e65322011f19839ef9ab7acc38?s=128&d=identicon&r=PG", "display_name": "Cedric", "link": "https://stackoverflow.com/users/6331184/cedric"}, "edited": false, "score": 1, "creation_date": 1469028761, "post_id": 38483872, "comment_id": 64371631, "body": "@Cedric for embedded dev, you&#39;d rather use your &quot;standard&quot; code completion/syntax checking tools along with your editor. What I&#39;ve done, is to use llvm-avr just for that (even though I&#39;m still compiling with avr-gcc)."}, {"owner": {"reputation": 834, "user_id": 6331184, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/468bc3e65322011f19839ef9ab7acc38?s=128&d=identicon&r=PG", "display_name": "Cedric", "link": "https://stackoverflow.com/users/6331184/cedric"}, "edited": false, "score": 0, "creation_date": 1469034846, "post_id": 38483872, "comment_id": 64375438, "body": "@zmo That&#39;s a good idea thanks, I&#39;ll look into that! Basically you used llvm-avr for it&#39;s clang integration into an editor?"}, {"owner": {"reputation": 22847, "user_id": 1290438, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b689dcfa3833cb016dfbc4cc82bb0eae?s=128&d=identicon&r=PG", "display_name": "zmo", "link": "https://stackoverflow.com/users/1290438/zmo"}, "edited": false, "score": 1, "creation_date": 1469035152, "post_id": 38483872, "comment_id": 64375599, "body": "I do! But as llvm-avr is still pretty immature, I wouldn&#39;t recommend it for anything else, like actually compiling the code. But most of the important stuff is there, like the registers and the important macros, so it&#39;s pretty decent for code completion and static code analysis\u2026 Given that I&#39;ve already been bitten hard by avr-gcc bugs, which maturity is worth years of development and bug hunting, I&#39;m not much curious to discover the novel ways llvm-avr will fail in real world usage."}], "tags": [], "owner": {"reputation": 22847, "user_id": 1290438, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b689dcfa3833cb016dfbc4cc82bb0eae?s=128&d=identicon&r=PG", "display_name": "zmo", "link": "https://stackoverflow.com/users/1290438/zmo"}, "is_accepted": false, "score": 2, "last_activity_date": 1511334213, "last_edit_date": 1511334213, "creation_date": 1469024449, "answer_id": 38483872, "question_id": 38483311, "link": "https://stackoverflow.com/questions/38483311/avr-gcc-vs-arduino-in-platform-io/38483872#38483872", "title": "avr-gcc vs Arduino in platform.io", "body": "<p>I have never used <code>PlatformIO</code>, and my answer is only based on my (extended) knowledge of AVR development and the Arduino mess\u2026err\u2026framework.</p>\n\n<p>The Arduino framework <em>is</em> using AVR-libc (the standard low level framework that gives you all the tools you need to program on AVR), and adds a layer of abstraction so you're not directly handling registers, but use a more easily understandable interface.</p>\n\n<p>So when you write on a pin, instead of looking at the AVR's IC leg number, looking for the matching <code>PORT</code> address to configure it and mutate it, you're using <code>digitalWrite()</code> on the <em>board</em>'s pin number. So, whatever the IC is, the pin will stay the same with consistent capabilities.</p>\n\n<p>The pin definition is done using a header file that's given to the compiler depending on your target setting in your IDE (so whether you use an Arduino Mega or a Leonardo the matching between AVR port/pin and board pinout will change radically).</p>\n\n<p>Given your description of <code>PlatformIO</code>, it's using that information to give you appropriate pinout completion based on the board configuration. It's also certainly taking advantage of the object oriented approach of the Arduino framework, so that you can easily have method completion when using singletons (like when you use <code>Serial</code>).</p>\n\n<p>Using raw AVR-libc, on the other hand, it's harder to get any meaningful completion, because most of the operations are being done on registers which are being declared through preprocessors aliases, and the whole code is pure C, so code completion is not really helpful (you cannot list all the methods that applies to a given object\u2026 like with the Serial example).</p>\n\n<p>Then, Arduino offers a nice high level approach to prototyping embedded code, that you can then curate when you need to optimise in time and/or space. And some projects (like the Marlin firmware for repraps) use some sort of hybrid approach, reimplementing many parts of the Arduino interface in a more optimised way (like <code>digitalWrite</code> or the <code>Serial</code> object).</p>\n\n<p>In the end, my advice to you would be to drop <code>platform.io</code> or the <code>arduino</code> IDE, and switch to eclipse if you're really into IDE GUIs, or better, use your preferred powerful editor (like vim/nvim, emacs, atom, sublime\u2026) to have it handle AVR code like any other C code.</p>\n"}, {"comments": [{"owner": {"reputation": 834, "user_id": 6331184, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/468bc3e65322011f19839ef9ab7acc38?s=128&d=identicon&r=PG", "display_name": "Cedric", "link": "https://stackoverflow.com/users/6331184/cedric"}, "edited": false, "score": 0, "creation_date": 1469025924, "post_id": 38483971, "comment_id": 64371086, "body": "Thanks for the suggestion! Might be of help to someone else, as I&#39;m on unix-based OS&#39;s."}], "tags": [], "owner": {"reputation": 1428, "user_id": 2819922, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e61964f3e5cdcde3dc90370e0cdfe2d4?s=128&d=identicon&r=PG&f=1", "display_name": "datafiddler", "link": "https://stackoverflow.com/users/2819922/datafiddler"}, "is_accepted": false, "score": 1, "last_activity_date": 1469024682, "creation_date": 1469024682, "answer_id": 38483971, "question_id": 38483311, "link": "https://stackoverflow.com/questions/38483311/avr-gcc-vs-arduino-in-platform-io/38483971#38483971", "title": "avr-gcc vs Arduino in platform.io", "body": "<p>If you work on an Arduino project including avr-gcc internals using VisualMicro plugin and VisualStudio (Community Edititon) all the code completion / syntax highlighting / goto declaration etc. works for anything in your project and all libraries.</p>\n\n<p>Is this what you're looking for?</p>\n\n<p>Of course, VisualMicro is annoying if you use them \"for free\"</p>\n"}, {"tags": [], "owner": {"reputation": 834, "user_id": 6331184, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/468bc3e65322011f19839ef9ab7acc38?s=128&d=identicon&r=PG", "display_name": "Cedric", "link": "https://stackoverflow.com/users/6331184/cedric"}, "is_accepted": true, "score": 5, "last_activity_date": 1511321677, "last_edit_date": 1511321677, "creation_date": 1469036758, "answer_id": 38487371, "question_id": 38483311, "link": "https://stackoverflow.com/questions/38483311/avr-gcc-vs-arduino-in-platform-io/38487371#38487371", "title": "avr-gcc vs Arduino in platform.io", "body": "<p>As pointed out by ivankravets on the <a href=\"https://platformio.org\" rel=\"nofollow noreferrer\">PlatformIO</a> community platform (see: <a href=\"https://community.platformio.org/t/avr-programming-without-arduino-framework/525/4\" rel=\"nofollow noreferrer\">https://community.platformio.org/t/avr-programming-without-arduino-framework/525/4</a>), it is as simple as removing the line <code>framework = arduino</code> from the <code>platformio.ini</code> file to get rid of the Arduino framework and work in bare C for avr-gcc.</p>\n"}], "owner": {"reputation": 834, "user_id": 6331184, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/468bc3e65322011f19839ef9ab7acc38?s=128&d=identicon&r=PG", "display_name": "Cedric", "link": "https://stackoverflow.com/users/6331184/cedric"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2407, "favorite_count": 0, "accepted_answer_id": 38487371, "answer_count": 3, "score": 3, "last_activity_date": 1511334213, "creation_date": 1469022912, "last_edit_date": 1469037963, "question_id": 38483311, "link": "https://stackoverflow.com/questions/38483311/avr-gcc-vs-arduino-in-platform-io", "title": "avr-gcc vs Arduino in platform.io", "body": "<p>I'm using <em>platform.io</em> as an IDE for programming AVR MCU's. I'm beginning AVR programming (I have a background in C/C++ and programming on OS's, not embedded, although I have done some Arduino stuff in the past) and using PlatformIO gives me code completion for the registers/pins, which is why I use it.</p>\n\n<p>It seems I can't switch framework from Arduino to avr-gcc in PlatformIO without losing code-completing.</p>\n\n<blockquote>\n  <p>I am wondering if there's any drawbacks in keeping Arduino as the\n  framework?</p>\n</blockquote>\n\n<p>I know Arduino uses avr-gcc in the back, but I read that it still does a bit of setup without the users knowing it (such as Timer0 setting for delays, which I need since I'm using it as a clock source for USI on my ATTiny85).</p>\n\n<blockquote>\n  <p>Otherwise, is there anyway in PlatformIO to keep code completion and\n  use avr-gcc instead of Arduino?</p>\n</blockquote>\n\n<p>Thanks!</p>\n\n<p>EDIT: I'm on either OSX or linux (ubuntu).</p>\n"}, {"tags": ["c", "gcc", "makefile", "architecture", "x86-64"], "comments": [{"owner": {"reputation": 26689, "user_id": 5769463, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/71a28b5fac23ee656a32cc7ea6df54ec?s=128&d=identicon&r=PG&f=1", "display_name": "ead", "link": "https://stackoverflow.com/users/5769463/ead"}, "edited": false, "score": 0, "creation_date": 1469025015, "post_id": 38483284, "comment_id": 64370420, "body": "how does <code>ssht_sampling_ind2elm</code> looks?"}, {"owner": {"reputation": 51, "user_id": 6614085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9bc49d146a607f9b35699b9521924619?s=128&d=identicon&r=PG&f=1", "display_name": "ben thorne", "link": "https://stackoverflow.com/users/6614085/ben-thorne"}, "reply_to_user": {"reputation": 26689, "user_id": 5769463, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/71a28b5fac23ee656a32cc7ea6df54ec?s=128&d=identicon&r=PG&f=1", "display_name": "ead", "link": "https://stackoverflow.com/users/5769463/ead"}, "edited": false, "score": 1, "creation_date": 1469028158, "post_id": 38483284, "comment_id": 64371287, "body": "@ead the function is just this: inline void ssht_sampling_elm2ind(int *ind, int el, int m) {    *ind = el * el + el + m;  }"}, {"owner": {"reputation": 26689, "user_id": 5769463, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/71a28b5fac23ee656a32cc7ea6df54ec?s=128&d=identicon&r=PG&f=1", "display_name": "ead", "link": "https://stackoverflow.com/users/5769463/ead"}, "edited": false, "score": 0, "creation_date": 1469028593, "post_id": 38483284, "comment_id": 64371529, "body": "Maybe you should build with GNU89 (I guess now it is building C99). See <a href=\"http://stackoverflow.com/questions/216510/extern-inline/216546#216546\" title=\"extern inline\">stackoverflow.com/questions/216510/extern-inline/216546#2165&zwnj;&#8203;46</a>"}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 6614085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9bc49d146a607f9b35699b9521924619?s=128&d=identicon&r=PG&f=1", "display_name": "ben thorne", "link": "https://stackoverflow.com/users/6614085/ben-thorne"}, "edited": false, "score": 0, "creation_date": 1469029764, "post_id": 38484787, "comment_id": 64372338, "body": "Thank you very much for the detailed response, this fixes the warnings and error!  I will file a bug report with the author."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1469088621, "post_id": 38484787, "comment_id": 64396869, "body": "Removing <code>inline</code> is definitely the wrong fix, because it&#39;s a trivial function (the OP copied the definition in a comment).  Instead, move the definition into the header, where all users of the function can see the definition instead of just the prototype."}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 1, "last_activity_date": 1469028736, "creation_date": 1469028736, "answer_id": 38484787, "question_id": 38483284, "link": "https://stackoverflow.com/questions/38483284/architecture-clash-symbols-not-found-for-architecture-x86-64-on-mac/38484787#38484787", "title": "Architecture clash? symbol(s) not found for architecture x86_64 on mac", "body": "<p>It appears that the code is broken, and the warning that you present is indeed a good clue.  The standard specifies:</p>\n\n<blockquote>\n  <p>For a function with external linkage, the following restrictions apply: If a function is declared with an <code>inline</code> function specifier, then it shall also be defined in the same translation unit.  If all of the file scope declarations for a function in a translation unit include the <code>inline</code> function specifier without <code>extern</code>, then the definition in that translation unit is an <em>inline definition</em>.  An inline definition does not provide an external definition for the function [...].</p>\n</blockquote>\n\n<p>[C2011, 6.7.4/7]</p>\n\n<p>The warning signals a violation of the cited restriction: the header file indicated in the warning contains the given function declaration, which  bears <code>inline</code> and <code>extern</code> specifiers.  Because of the <code>inline</code> specifier, C requires that every translation unit in which that declaration appears also provide a definition; since it appears in a header file, that applies to every source file that includes that header.  File <code>ssht_core.c</code> includes the header but does not provide a definition.</p>\n\n<p>Examination of the source shows that the designated function is defined only in file <code>../ssht/src/c/ssht_sampling.c</code>, but that that file <em>does not include the corresponding header</em>.  When a C source file has a corresponding header, it is customary and useful for it to include that header, for that helps catch discrepancies between declarations.  It is not obligatory to do so, however, so that omission is not wrong in itself.</p>\n\n<p>In this case, however, the only declaration of <code>ssht_sampling_ind2elm()</code> in <code>ssht_sampling.c</code> is its definition, and that bears an <code>inline</code> specifier without <code>extern</code>.  The second part of the above-quoted section of the standard therefore applies: the translation unit corresponding to that file does not provide an external definition of the function.  That is, the definition it provides is only visible from within the same translation unit, not from others, such as the one associated with <code>ssht_core.c</code>.</p>\n\n<p>The intention appears to be to provide a function definition in one file that can be inlined in other files, but that is not allowed, nor does it really make sense.  I'd file a bug report with the library's author.  One possible resolution would be to make <code>ssht_sampling.c</code> include its own header; that would not resolve the warning, but it ought to fix the linkage problem.  You could clear the warning by <em>also</em> removing the <code>inline</code> specifiers from the function declaration in the header.  Alternatively, you could remove the <code>inline</code> specifiers from the function in both the header and the main source, without changing which headers are included in which file.</p>\n"}], "owner": {"reputation": 51, "user_id": 6614085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9bc49d146a607f9b35699b9521924619?s=128&d=identicon&r=PG&f=1", "display_name": "ben thorne", "link": "https://stackoverflow.com/users/6614085/ben-thorne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1469028736, "creation_date": 1469022845, "question_id": 38483284, "link": "https://stackoverflow.com/questions/38483284/architecture-clash-symbols-not-found-for-architecture-x86-64-on-mac", "title": "Architecture clash? symbol(s) not found for architecture x86_64 on mac", "body": "<p>I'm trying to install a C library: <a href=\"https://github.com/astro-informatics/ssht\" rel=\"nofollow\">ssht</a></p>\n\n<p>I've set up the makefile and it's definitely finding the dependencies.  When I make it using gcc, however, I get some warnings:</p>\n\n<pre><code>In file included from ../ssht/src/c/ssht_core.c:23:0:\n../ssht/src/c/ssht_core.c: At top level:\n../ssht/src/c/ssht_sampling.h:39:20: warning: inline function \u2018ssht_sampling_ind2elm\u2019 declared but never defined\nextern inline void ssht_sampling_ind2elm(int *el, int *m, int ind);\n</code></pre>\n\n<p>And then when I make the test for the code I get the error:</p>\n\n<pre><code>\"_ssht_sampling_elm2ind\", referenced from:\n  _ssht_test_gen_flm_complex.constprop.1 in ssht_test.o\n  _ssht_test_gen_flm_real in ssht_test.o\n  _ssht_test_gen_lb_flm_real in ssht_test.o\n  _ssht_test_gen_flm_complex in ssht_test.o\n  _ssht_test_gen_lb_flm_complex in ssht_test.o\n  _main in ssht_test.o\n  _ssht_core_mwdirect_inverse in libssht.a(ssht_core.o)\n  ...\nld: symbol(s) not found for architecture x86_64\ncollect2: error: ld returned 1 exit status\nmake: *** [../ssht/bin/c/ssht_test] Error 1\n</code></pre>\n\n<p>I've haven't been able to find any solutions that I could understand.  By the way my gcc version is:</p>\n\n<pre><code>Using built-in specs.\nCOLLECT_GCC=gcc\nCOLLECT_LTO_WRAPPER=/usr/local/libexec/gcc/x86_64-apple-darwin14.4.0/5.1.0/lto-wrapper\nTarget: x86_64-apple-darwin14.4.0\nConfigured with: ../gcc-5.1.0/configure --enable-languages=c++,fortran\nThread model: posix\ngcc version 5.1.0 (GCC)\n</code></pre>\n\n<p>I've tried installing as a 32 bit installation with -m32 to see if that changed things, but I get the same error with i386 instead of x86_64.</p>\n\n<p>I have installed it on a Linux machine that I also have access to with a makefile which is identical except for the location of one of the dependencies.  </p>\n\n<p>Please help!</p>\n"}, {"tags": ["c++", "c", "windows", "winapi", "gdi"], "comments": [{"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1469023502, "post_id": 38483273, "comment_id": 64369243, "body": "As far as I know, there isn&#39;t even a supported way to create a child window for the desktop. But if you insist that you must Hack The Planet\u2122, consider creating the window without a redirection bitmap (<code>WS_EX_NOREDIRECTIONBITMAP</code>) and manually add a DirectX surface for rendering. That <i>might</i> give you more control over desktop composition. Or maybe you can use the DirectComposition API to control desktop composition, although I have no experience with that."}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1469029191, "post_id": 38483273, "comment_id": 64371927, "body": "Why are you attempting to do this unsupported thing? Do you realise that you are not supposed to do this?"}, {"owner": {"reputation": 40893, "user_id": 1386054, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/424ZW.jpg?s=128&g=1", "display_name": "Adrian McCarthy", "link": "https://stackoverflow.com/users/1386054/adrian-mccarthy"}, "edited": false, "score": 0, "creation_date": 1469046386, "post_id": 38483273, "comment_id": 64382062, "body": "Why make it a child?  What problem does that solve that simply placing the window causes?  Have you considered how this will work under Remote Desktop?  With Aero switche off?  With Windows 8, 8.1, and 10?"}, {"owner": {"reputation": 11, "user_id": 6613999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c9b08be6096ac2cd6ff19cccd8fed60?s=128&d=identicon&r=PG&f=1", "display_name": "shrln", "link": "https://stackoverflow.com/users/6613999/shrln"}, "edited": false, "score": 0, "creation_date": 1469049950, "post_id": 38483273, "comment_id": 64383789, "body": "Why should this be &quot;unsupported&quot;? Didn&#39; read anything about it in the docs. It&#39;s afaik the only way to pin a window to the desktop, placing it at the z-order (bottom) does not work reliably, see: Openhardwaremonitor gadget, Rainmeter, or even if you dare to still use it, the Windows 7 sidebar.exe. So if even the Microsoft executable struggles with pinning a window at a specific z-order, i didn&#39;t see another way of doing it. It doesn&#39;t have to work for 8-10. If anyone can contribute a way to pin a window at a specific z-order, then i will gladly implement it ;-)"}, {"owner": {"reputation": 11, "user_id": 6613999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c9b08be6096ac2cd6ff19cccd8fed60?s=128&d=identicon&r=PG&f=1", "display_name": "shrln", "link": "https://stackoverflow.com/users/6613999/shrln"}, "reply_to_user": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1469051543, "post_id": 38483273, "comment_id": 64384479, "body": "@IInspectable Isn&#39;t DirectComposition Win 8 or newer only?"}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1469051890, "post_id": 38483273, "comment_id": 64384585, "body": "<i>&quot;Why should this be &quot;unsupported&quot;?&quot;</i> - Because cross-thread parent/child relationships are not supported by Explorer (see <a href=\"https://blogs.msdn.microsoft.com/oldnewthing/20130412-00/?p=4683\" rel=\"nofollow noreferrer\">Is it legal to have a cross-process parent/child or owner/owned window relationship?</a>). And yes, DirectComposition was introduced in Windows 8, my bad."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 6613999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c9b08be6096ac2cd6ff19cccd8fed60?s=128&d=identicon&r=PG&f=1", "display_name": "shrln", "link": "https://stackoverflow.com/users/6613999/shrln"}, "edited": false, "score": 0, "creation_date": 1469272458, "post_id": 38541092, "comment_id": 64474667, "body": "btw. i tried every combination of the pixelFormat (DXGI_FORMAT &amp; D2D1_ALPHA_MODE) i could find in the documentation and it didnt change the behaviour as long as GDI was involved, so if no one comes up with a solution for GDI, the Direct2D approach seems to be the only &quot;answer&quot;"}], "tags": [], "owner": {"reputation": 11, "user_id": 6613999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c9b08be6096ac2cd6ff19cccd8fed60?s=128&d=identicon&r=PG&f=1", "display_name": "shrln", "link": "https://stackoverflow.com/users/6613999/shrln"}, "is_accepted": true, "score": 0, "last_activity_date": 1469272231, "creation_date": 1469272231, "answer_id": 38541092, "question_id": 38483273, "link": "https://stackoverflow.com/questions/38483273/disable-transparency-for-a-desktop-child-window/38541092#38541092", "title": "Disable transparency for a &quot;desktop&quot; child window", "body": "<p>Using Direct2D does the job as intended (100% opaque), as soon as i mix it with GDI (CreateDCRenderTarget or ID2D1GdiInteropRenderTarget) the whole transparency thing comes up again. So much for \"Direct2D and GDI Interoperability\"\nGuess it's time to port the legacy GDI code to Direct2D then ....</p>\n"}], "owner": {"reputation": 11, "user_id": 6613999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c9b08be6096ac2cd6ff19cccd8fed60?s=128&d=identicon&r=PG&f=1", "display_name": "shrln", "link": "https://stackoverflow.com/users/6613999/shrln"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 336, "favorite_count": 0, "accepted_answer_id": 38541092, "answer_count": 1, "score": 1, "last_activity_date": 1469274720, "creation_date": 1469022818, "question_id": 38483273, "link": "https://stackoverflow.com/questions/38483273/disable-transparency-for-a-desktop-child-window", "title": "Disable transparency for a &quot;desktop&quot; child window", "body": "<p>I pin a window to the desktop by making it a child of the WorkerW window that contains the desktop FolderView in Windows 7 Aero. So far this works perfectly for pinning the window to the desktop, but the window has some sort of transparency which it doesn't has as a topmost window.<a href=\"http://i.stack.imgur.com/KlBVT.png\" rel=\"nofollow\">Instead of a dark background RGB(0,21,32) the actual desktop background/wallpaper shines through</a></p>\n\n<pre><code>case WM_PAINT:\n    hdc = BeginPaint(hWnd, &amp;ps);\n    GetClientRect(hWnd, &amp;cr);\n    SelectObject(hdc, GetStockObject(DC_BRUSH));\n    SetDCBrushColor(hdc, RGB(0,21,32));\n    FillRect(hdc, &amp;cr, (HBRUSH) GetStockObject(DC_BRUSH));\n</code></pre>\n\n<p>The client area is drawn via GDI, i tried everything i could think of to make the window fully opaque: SetBkColor, SetLayeredWindowAttributes, WNDCLASSEX.style = CS_PARENTDC, using RGBA colors (only works to get even more transparency up to 100%, but setting it to opaque doesn't change the outcome)</p>\n\n<p><strong>Is there any way to draw an opaque window as a child of the Aero desktop?</strong></p>\n"}, {"tags": ["c", "pointers", "memory-management", "segmentation-fault", "constants"], "answers": [{"comments": [{"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1469029821, "post_id": 38484208, "comment_id": 64372377, "body": "You could emphasize the difference between a <i>const object</i> which is initialized at its point of definition, and a pointer to const <i>function parameter</i>. The <i>const object</i> may physically be in a read-only memory location. The <i>pointer</i> points to an existing object which itself may or may not be const. Declaring the pointer one way or another is only an indication of intent (and influences overload resolution). It does in no way change the character of the memory pointed to."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1469030586, "post_id": 38484208, "comment_id": 64372912, "body": "@Peter A. Schneider 1 ) Yes, &quot;The const object may physically be in a read-only memory location.&quot;, OP certainly knows that.  OP wants to know if that is <i>always</i> true - it is not.  2)  Unclear on &quot;influences overload resolution&quot; on this C post.  Perhaps you are thing of another language?  <code>const</code> has a more subtle meaning in C than other languages.  It is more like &quot;read-only&quot; than &quot;constant&quot;."}, {"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1469045064, "post_id": 38484208, "comment_id": 64381356, "body": "(1) Oh. C. Yes, no overload resolution.&quot; (2) OP certainly knows that&quot;: I had the hunch that he wanted to prevent a memory overwrite by declaring the <i>pointer</i> to be pointing to a const object, without changing the object definition (note the &quot; If I pass as void func1(const abc *const ptr)&quot; from the post). That would, of course, not do anything."}, {"owner": {"reputation": 19, "user_id": 6613229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8db72fb237cf0c32099b30a580f00034?s=128&d=identicon&r=PG&f=1", "display_name": "isarma", "link": "https://stackoverflow.com/users/6613229/isarma"}, "edited": false, "score": 1, "creation_date": 1469091197, "post_id": 38484208, "comment_id": 64398615, "body": "Thank you guys for the explanation. Guess I need to figure out the actual memory overwrite issue, rather than trying to cover it up! Thanks again.."}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 4, "last_activity_date": 1469028871, "last_edit_date": 1469028871, "creation_date": 1469025255, "answer_id": 38484208, "question_id": 38483224, "link": "https://stackoverflow.com/questions/38483224/does-const-struct-pointer-guarantee-safety-from-memory-corruption-crash-issues/38484208#38484208", "title": "Does const struct pointer guarantee safety from memory corruption / crash issues?", "body": "<blockquote>\n  <p>Does \"const\" ensure that struct abc,abc->xyz always gets stored in some read-only segment in memory, and hence safe from any memory corruption ?</p>\n</blockquote>\n\n<p>No, not <em>always</em>.  With <code>const</code>, diagnostics (warnings/errors) at compile time emit if code knowingly attempts to modify the variable.</p>\n\n<blockquote>\n  <p>If an attempt is made to modify an object defined with a const-qualified type through use of an lvalue with non-const-qualified type, the behavior is undefined.  C11 \u00a76.7.3 6</p>\n</blockquote>\n\n<p>Should code attempt, at run time, to modify a <code>const</code> variable, it might work, it may fail silently, it may crash the program.  It is undefined behavior.</p>\n\n<p>In OP's case, suspect code is writing outside bounds and into field <code>xyz</code>, so making <code>xyz</code> <code>const</code> is not going to help much.</p>\n"}], "owner": {"reputation": 19, "user_id": 6613229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8db72fb237cf0c32099b30a580f00034?s=128&d=identicon&r=PG&f=1", "display_name": "isarma", "link": "https://stackoverflow.com/users/6613229/isarma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1469028871, "creation_date": 1469022703, "question_id": 38483224, "link": "https://stackoverflow.com/questions/38483224/does-const-struct-pointer-guarantee-safety-from-memory-corruption-crash-issues", "title": "Does const struct pointer guarantee safety from memory corruption / crash issues?", "body": "<p>I have a code like below:</p>\n\n<pre><code>struct abc\n{\n    int *xyz;\n}\n\nvoid func1(abc *ptr, .... lots of other struct ptrs passed)\n{\n    func2(ptr-&gt;xyz) // some computation, only read from ptr-&gt;xyz\n    ...\n    ...\n    func3(ptr-&gt;xyz) // some computation, ptr-&gt;xyz is only read\n}\n\nvoid main()\n{ \n    abc *ptr;\n    // memory is allocated properly here for ptr and ptr-&gt;xyz.\n    func1(ptr,...);\n}\n</code></pre>\n\n<p>Problem: \nSeg fault happens at func3, due to ptr->xyz=0x0.\nTill func2, ptr->xyz address is proper. and no other related code before func3.\nNot reproducible. Not much info from core dump regarding start of memory corruption, or valgrind.</p>\n\n<p>Analysis: \nI ran GDB and used command awatch *(address of ptr->xyz) for normal working case.\nThroughout func1, func2, func3, we only read from ptr->xyz memory address. No write operation happens, in normal working scenario.\nSo I believe this might be due to some other memory corruption overlap.</p>\n\n<p>Question: \nIf I pass as void func1(const abc *const ptr). I dont want to change address/data of abc or abc->xyz.\nDoes \"const\" ensure that struct abc,abc->xyz always gets stored in some read-only segment in memory, and hence safe from any memory corruption ? maybe due to other struct memory address overlap write ?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["c", "bash", "command-line", "nsuserdefaults"], "comments": [{"owner": {"reputation": 6024, "user_id": 2417459, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/QcuXb.png?s=128&g=1", "display_name": "i486", "link": "https://stackoverflow.com/users/2417459/i486"}, "edited": false, "score": 1, "creation_date": 1469023123, "post_id": 38483064, "comment_id": 64368934, "body": "&quot;where&quot; - in a file like <code>~&#47;.my_app</code>."}, {"owner": {"reputation": 4380, "user_id": 3840981, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/uGzrp.png?s=128&g=1", "display_name": "Rob Sanders", "link": "https://stackoverflow.com/users/3840981/rob-sanders"}, "reply_to_user": {"reputation": 6024, "user_id": 2417459, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/QcuXb.png?s=128&g=1", "display_name": "i486", "link": "https://stackoverflow.com/users/2417459/i486"}, "edited": false, "score": 0, "creation_date": 1469023163, "post_id": 38483064, "comment_id": 64368957, "body": "So the norm is a hidden folder in the home directory?"}, {"owner": {"reputation": 6024, "user_id": 2417459, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/QcuXb.png?s=128&g=1", "display_name": "i486", "link": "https://stackoverflow.com/users/2417459/i486"}, "edited": false, "score": 0, "creation_date": 1469024358, "post_id": 38483064, "comment_id": 64369884, "body": "Not necessary, but one example. It can be also <code>.&#47;my_app</code>."}], "answers": [{"comments": [{"owner": {"reputation": 4380, "user_id": 3840981, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/uGzrp.png?s=128&g=1", "display_name": "Rob Sanders", "link": "https://stackoverflow.com/users/3840981/rob-sanders"}, "edited": false, "score": 0, "creation_date": 1469024428, "post_id": 38483558, "comment_id": 64369946, "body": "I already have a .bash_profile set up but I&#39;m writing scripts that need to modify values on the fly and persistently save them."}, {"owner": {"reputation": 4380, "user_id": 3840981, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/uGzrp.png?s=128&g=1", "display_name": "Rob Sanders", "link": "https://stackoverflow.com/users/3840981/rob-sanders"}, "edited": false, "score": 0, "creation_date": 1469028297, "post_id": 38483558, "comment_id": 64371364, "body": "Thanks this is a good solution. Is there any way of telling if a variable has already been defined."}, {"owner": {"reputation": 1523, "user_id": 2079373, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/etR7x.png?s=128&g=1", "display_name": "tale852150", "link": "https://stackoverflow.com/users/2079373/tale852150"}, "reply_to_user": {"reputation": 4380, "user_id": 3840981, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/uGzrp.png?s=128&g=1", "display_name": "Rob Sanders", "link": "https://stackoverflow.com/users/3840981/rob-sanders"}, "edited": false, "score": 0, "creation_date": 1469038078, "post_id": 38483558, "comment_id": 64377374, "body": "<code>if [ -z &quot;$YOUR_ENV_VAR&quot; ];</code> will return true if a variable is the empty string or unset."}], "tags": [], "owner": {"reputation": 1523, "user_id": 2079373, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/etR7x.png?s=128&g=1", "display_name": "tale852150", "link": "https://stackoverflow.com/users/2079373/tale852150"}, "is_accepted": true, "score": 2, "last_activity_date": 1469027931, "last_edit_date": 1469027931, "creation_date": 1469023559, "answer_id": 38483558, "question_id": 38483064, "link": "https://stackoverflow.com/questions/38483064/where-to-store-settings-for-c-command-line-apps-and-bash-scripts/38483558#38483558", "title": "Where to store settings for C command line apps and bash scripts?", "body": "<p>For the <code>bash</code> setup, the shell invocation normally reads <code>/etc/profile</code>, and the private equivalent <code>~/.bash_profile</code> or <code>~/.bashrc</code>, upon startup.  So look at these files and make the appropriate modifications.  If possible, I suggest making a backup of these files prior to making any changes.</p>\n\n<p>Be aware that the <code>/etc/profile</code> file will generally provide global settings while, if an equivalent file exists in your home directory, that file may override the global settings.</p>\n\n<p>If you wish to add or modify environment variables <em>on the fly</em>, try ...</p>\n\n<p>a. adding the following code to the end of your <code>~/.bash_profile</code> or <code>~/.bashrc</code> file</p>\n\n<pre><code>   if [ -e ./.bashadd ]\n   then\n        source ./.bashadd\n   fi\n</code></pre>\n\n<p>b. append additions or modifications to the file <code>./.bashadd</code> <em>on the fly</em> (NOTE: you'll have to handle this within your program)</p>\n\n<pre><code>   echo export NAME=John &gt;&gt; ./.bashadd\n</code></pre>\n\n<p>c. at login, when you invoke <code>bash</code> or when you source your <code>~/.bash_profile</code> or <code>~/.bashrc</code> file, the environment variables will be available</p>\n\n<p>Test:</p>\n\n<pre><code>[shell ~]$ echo export NAME=John &gt;&gt; ./.bashadd\n[shell ~]$ source ./.bashrc\n[shell ~]$ echo $NAME\nJohn\n[shell ~]$\n</code></pre>\n\n<p>Admittedly, not an ideal solution.  And I would suggest doing this only in your local environment and not globally (i.e. not with <code>/etc/profile</code>)</p>\n"}], "owner": {"reputation": 4380, "user_id": 3840981, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/uGzrp.png?s=128&g=1", "display_name": "Rob Sanders", "link": "https://stackoverflow.com/users/3840981/rob-sanders"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "accepted_answer_id": 38483558, "answer_count": 1, "score": 0, "last_activity_date": 1469027931, "creation_date": 1469022285, "question_id": 38483064, "link": "https://stackoverflow.com/questions/38483064/where-to-store-settings-for-c-command-line-apps-and-bash-scripts", "title": "Where to store settings for C command line apps and bash scripts?", "body": "<p>This may be an obvious question but I can't find a definitive answer. </p>\n\n<p>When making a command line utility in C or when writing bash scrips where can I save values for later reference?</p>\n\n<p>What I'm looking for is something similar to <code>NSUserDefaults</code>.</p>\n"}, {"tags": ["c", "pointers", "gcc", "c-preprocessor"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 3, "creation_date": 1469021905, "post_id": 38482876, "comment_id": 64367942, "body": "aren&#39;t you missing the allocation for <code>var_struct.x</code>?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1469022008, "post_id": 38482876, "comment_id": 64368033, "body": "2) No they are not. They refer to <code>var_struct.x[0]</code> through <code>var_struct.x[3]</code>"}, {"owner": {"reputation": 310, "user_id": 2302911, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/NDmaf.jpg?s=128&g=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/2302911/dave"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1469022088, "post_id": 38482876, "comment_id": 64368105, "body": "@SouravGhosh that&#39;s all...really...."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1469022091, "post_id": 38482876, "comment_id": 64368110, "body": "3) Macros are generally discouraged if can be avoided. Macros hiding important type information like these in question are highly discouraged.."}, {"owner": {"reputation": 310, "user_id": 2302911, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/NDmaf.jpg?s=128&g=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/2302911/dave"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1469022131, "post_id": 38482876, "comment_id": 64368142, "body": "@EugeneSh. Clear, but in the sctructur I have only one declared pointer and not an array of pointers"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1469022178, "post_id": 38482876, "comment_id": 64368185, "body": "As @SouravGhosh said - it&#39;s an invalid code, missing the proper allocations."}, {"owner": {"reputation": 310, "user_id": 2302911, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/NDmaf.jpg?s=128&g=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/2302911/dave"}, "edited": false, "score": 0, "creation_date": 1469022470, "post_id": 38482876, "comment_id": 64368447, "body": "Corrected with the missing line code"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1469022548, "post_id": 38482876, "comment_id": 64368501, "body": "It doesn&#39;t matter. <code>x</code> is still not allocated. Your code has an undefined behavior."}, {"owner": {"reputation": 310, "user_id": 2302911, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/NDmaf.jpg?s=128&g=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/2302911/dave"}, "edited": false, "score": 0, "creation_date": 1469022649, "post_id": 38482876, "comment_id": 64368577, "body": "This is really what I can extract from the original code!!!! Anyway your information about the allocation is really important!"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1469022688, "post_id": 38482876, "comment_id": 64368612, "body": "It is. Otherwise it is just broken. But I bet you can&quot;extract&quot; more."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 2, "creation_date": 1469022768, "post_id": 38482876, "comment_id": 64368646, "body": "There are two possibilities here.  You may have oversimplified your example, or there may be a bug in the original.  It would really help if you provided a link to the original, and the name of the specific source file that you started from when developing your example."}, {"owner": {"reputation": 8429, "user_id": 964080, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/136f4c71facafdb75bfaa0e4f047f1fc?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/964080/nick"}, "edited": false, "score": 0, "creation_date": 1469022827, "post_id": 38482876, "comment_id": 64368699, "body": "is it possible the struct to be placed &quot;over&quot; something else? e.g.  floar x[5];  mystruct *var_struct = &amp;x; Also I see var_struct declared twice."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1469022870, "post_id": 38482876, "comment_id": 64368735, "body": "I can answer your question #3 now, though: This sort of trickery with macros <b>used</b> to be normal and unremarkable, but nowadays it is strongly discouraged.  One reason it is no longer considered acceptable is that it confuses new readers of the code.  Back in the day (and I&#39;m talking 1985\u20132000 here) that was less important.  The primary rationales for doing this sort of thing, when it was normal, were terseness (very important when all you have is an 80x25 glass tty) and poor man&#39;s encapsulation (nowadays you&#39;re better off jumping to C++ if you need more encapsulation)."}, {"owner": {"reputation": 234, "user_id": 6180573, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/06c9b68ecb1a17f2b47231d3d700f020?s=128&d=identicon&r=PG&f=1", "display_name": "smrdo_prdo", "link": "https://stackoverflow.com/users/6180573/smrdo-prdo"}, "edited": false, "score": 0, "creation_date": 1469023532, "post_id": 38482876, "comment_id": 64369270, "body": "If it&#39;s under GPLv3, why couldn&#39;t you &quot;extract&quot; more, or link to the code in question?"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1469118375, "post_id": 38482876, "comment_id": 64416940, "body": "1) there is no pointer in the posted code, NOR in the linked header file, however, the posted code does say the field in the struct is a pointer and the other items say the field is a pointer to an array.  2) the posted code is not representative of the linked header file."}], "answers": [{"tags": [], "owner": {"reputation": 8429, "user_id": 964080, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/136f4c71facafdb75bfaa0e4f047f1fc?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/964080/nick"}, "is_accepted": false, "score": 0, "last_activity_date": 1469023194, "creation_date": 1469023194, "answer_id": 38483404, "question_id": 38482876, "link": "https://stackoverflow.com/questions/38482876/using-directive-define-for-defining-pointer-need-help-to-understand-this-piece/38483404#38483404", "title": "Using directive #define for defining pointer: need help to understand this piece of code", "body": "<p>Assuming original code is OK and working, there are two possibilities:</p>\n\n<ol>\n<li><p>Allocation - Probably struct is allocated in memory.</p>\n\n<pre><code>mystruct var_struct;\nvar_struct.x = malloc(5 * sizeof(float));\n\n// then you can do this:\nvar_struct.x[3] = 5.6f;\n</code></pre></li>\n<li><p>Struct is placed \"over\" something else:</p>\n\n<pre><code>float placeholder[5];\n\nmystruct var_struct;\nvar_struct.x = &amp;placeholder;\n\n// then you can do this:\nvar_struct.x[3] = 5.6f;\n</code></pre></li>\n</ol>\n\n<p>There is third possibility - this to be C++ code and instead of pointers they to use references. Result is same as in C with pointers.</p>\n"}, {"tags": [], "owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "is_accepted": true, "score": 2, "last_activity_date": 1469052824, "creation_date": 1469052824, "answer_id": 38491735, "question_id": 38482876, "link": "https://stackoverflow.com/questions/38482876/using-directive-define-for-defining-pointer-need-help-to-understand-this-piece/38491735#38491735", "title": "Using directive #define for defining pointer: need help to understand this piece of code", "body": "<p>In the original code, <code>navUkfData.x</code> <em>is</em> initialized before anything writes to it.  You may have missed this because you were searching only for the macros, not for direct use of <code>navUkfData.x</code> (which demonstrates one of the several reasons why this kind of code is considered poor style).  You did find the right function, though: the key lines of <code>navUkfInitState</code> are</p>\n\n<pre><code>navUkfData.kf = srcdkfInit(SIM_S, SIM_M, SIM_V, SIM_N, navUkfTimeUpdate);\nnavUkfData.x = srcdkfGetState(navUkfData.kf);\n</code></pre>\n\n<p><code>srcdkfGetState</code> is defined <a href=\"https://github.com/mpaperno/aq_flight_control/blob/39f44612d7379cf9e52b1087cbaa60c04aa83d45/src/math/srcdkf.c#L26\" rel=\"nofollow\">here</a>:</p>\n\n<pre><code>float *srcdkfGetState(srcdkf_t *f) {\n    return f-&gt;x.pData;\n}\n</code></pre>\n\n<p>and <code>srcdkfInit</code> is defined <a href=\"https://github.com/mpaperno/aq_flight_control/blob/39f44612d7379cf9e52b1087cbaa60c04aa83d45/src/math/srcdkf.c#L70\" rel=\"nofollow\">here</a>:</p>\n\n<pre><code>srcdkf_t *srcdkfInit(int s, int m, int v, int n, SRCDKFTimeUpdate_t *timeUpdate) {\n    ...\n    matrixInit(&amp;f-&gt;x, s, 1);\n    ...\n</code></pre>\n\n<p>and <code>matrixInit</code> is defined <a href=\"https://github.com/mpaperno/aq_flight_control/blob/39f44612d7379cf9e52b1087cbaa60c04aa83d45/src/math/algebra.c#L25\" rel=\"nofollow\">here</a>:</p>\n\n<pre><code>void matrixInit(arm_matrix_instance_f32 *m, int rows, int cols) {\n    float32_t *d;\n\n    d = (float32_t *)aqDataCalloc(rows*cols, sizeof(float32_t));\n\n    arm_mat_init_f32(m, rows, cols, d);\n    arm_fill_f32(0, d, rows*cols);\n}\n</code></pre>\n\n<p>and <code>arm_mat_init_f32</code> is defined <a href=\"https://github.com/mpaperno/aq_flight_control/blob/39f44612d7379cf9e52b1087cbaa60c04aa83d45/lib/CMSIS/DSP_Lib/Source/MatrixFunctions/arm_mat_init_f32.c#L70\" rel=\"nofollow\">here</a>:</p>\n\n<pre><code>void arm_mat_init_f32(\n  arm_matrix_instance_f32 * S,\n  uint16_t nRows,\n  uint16_t nColumns,\n  float32_t * pData)\n{\n  /* Assign Number of Rows */\n  S-&gt;numRows = nRows;\n\n  /* Assign Number of Columns */\n  S-&gt;numCols = nColumns;\n\n  /* Assign Data pointer */\n  S-&gt;pData = pData;\n}\n</code></pre>\n\n<p>So, ultimately, <code>navUkfData.x</code> will be set to point to memory allocated by \n<code>aqDataCalloc</code>, whose definition I will <em>not</em> quote because it appears to be specific to a particular piece of embedded hardware.</p>\n\n<p>So the answers to your questions are:</p>\n\n<blockquote>\n  <p>if I run the code on the platform architecture (ARM7) it compiles and runs. If I try the same code on the gcc (GCC) 5.3.1 20151207 (Red Hat 5.3.1-2) it compiles but it doesn't run (Segmentation fault).</p>\n</blockquote>\n\n<p>If this is talking about your cut-down example: it only <strong>appears</strong> to work, by accident, on the \"platform architecture\".  It is buggy, because it never initializes <code>x</code>.  The macros do not avoid the need to initialize <code>x</code>.</p>\n\n<p>If this is talking about the original program: It appears to have been written to run only on a specific piece of embedded hardware.  Making it work outside that context could be man-months of effort.</p>\n\n<blockquote>\n  <p>To me wanted the programmer to use one shared pointer to a variable, which is going to be overwritten simply using the MACROx defined macros. But in this case I never can be sure which value as been assigned to the pointer *x, if I didn't track which macro I have already used. Or am I wrong?</p>\n</blockquote>\n\n<p>I'm not sure I understand this question, but: Using the MACROx macros does not change the pointer <code>x</code> itself, only the elements of the array that <code>x</code> points to.  Your confusion is perhaps another reason why these macros are poor style.</p>\n\n<blockquote>\n  <p>The #define macro simply replace text in the code. So even if I used MACRO1, MACRO2 or MACRO3... they simply refer to the same variable</p>\n</blockquote>\n\n<p>They do all refer to the \"same variable\" in the sense that they all refer to <code>x</code>.  However, <code>x</code> is an array, and they refer to different elements of that array.</p>\n\n<blockquote>\n  <p>Is such a codestyle compatible with the most used and spreaded C techniques and C coding rules? I don't think so...but I m unsure. Maybe the programmer is using some very efficient methods for code writing, which are not very common.</p>\n</blockquote>\n\n<p>As I said in comments earlier: This sort of trickery with macros <strong>used</strong> to be normal and unremarkable, but nowadays it is strongly discouraged.  An important reason it is no longer considered acceptable is that it confuses new readers of the code, as this question demonstrates. Back in the day (and I'm talking 1985\u20132000 here) that was less important.</p>\n\n<p>The primary rationales for doing this sort of thing, when it was normal, were terseness (very important when all you have is an 80x25 glass tty) and poor man's encapsulation (nowadays you're better off jumping to C++ if you need more encapsulation).  It is <strong>not</strong> done for efficiency.</p>\n\n<blockquote>\n  <p>Why I didn't post the code?!? Because otherwise I would reminded to post just a minimal example and not the whole code. So, it is just to respect rules. I don't hide anything.</p>\n</blockquote>\n\n<p>It was appropriate to simplify the code in order to ask this question.  However, you should <em>also</em> have posted a link to the original, because you knew that you didn't understand the original code, and therefore you should also have known that you might have gotten the simplification wrong.  That would have saved everyone some time.</p>\n"}], "owner": {"reputation": 310, "user_id": 2302911, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/NDmaf.jpg?s=128&g=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/2302911/dave"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "accepted_answer_id": 38491735, "answer_count": 2, "score": 0, "last_activity_date": 1469052824, "creation_date": 1469021785, "last_edit_date": 1495541686, "question_id": 38482876, "link": "https://stackoverflow.com/questions/38482876/using-directive-define-for-defining-pointer-need-help-to-understand-this-piece", "title": "Using directive #define for defining pointer: need help to understand this piece of code", "body": "<p>In a very known <strong>C</strong> code distribuited under GPL3 I found the following program (I just report here a minimal example and not the whole code for simplifying).</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\ntypedef struct {\n\n    float *x;\n\n} mystruct;\n\nmystruct var_struct;\n\n#define ALPHA       0\n#define BETA        1\n#define GAMMA       2\n#define DELTA       3\n\n#define MACRO1      var_struct.x[ALPHA]\n#define MACRO2      var_struct.x[BETA]\n#define MACRO3      var_struct.x[GAMMA]\n#define MACRO4      var_struct.x[DELTA]\n\n\nint main()\n{\n    mystruct var_struct;\n\n    float a = 5.6f;\n\n    MACRO1 = a;\n\n    return 0;\n}\n</code></pre>\n\n<p>I admit that I'm quite confused about this style of writing and using pointers, since I had preferred each separated fields for pointers in the structure itself and not a shared pointer. But this is what I found and - since I don't think that it could work - I decided to analyse the code step by step, so I can learn something new or understand something that I don't know yet.</p>\n\n<p>Anyway if I run the code on the platform architecture (ARM7) it <strong>compiles</strong> and <strong>runs</strong>. If I try the same code on the gcc <em>(GCC) 5.3.1 20151207 (Red Hat 5.3.1-2)</em>  it <strong>compiles</strong> but it <strong>doesn't run</strong> (Segmentation fault).</p>\n\n<p><strong>Question #1:</strong>\nTo me wanted the programmer to use one shared pointer to a variable, which is going to be overwritten simply using the MACROx defined macros. But in this case I never can be sure which value as been assigned to the pointer *x, if I didn't track which macro I have already used. Or am I wrong?</p>\n\n<p><strong>Question #2:</strong>\nAs stated <a href=\"https://stackoverflow.com/questions/4467861/pointer-to-define\">here</a> the #define macro simply replace text in the code. So even if I used MACRO1, MACRO2 or MACRO3... they simply refer to the <strong>same</strong> variable. In this case through its address in the memory. Or not?</p>\n\n<p><strong>Question #3:</strong>\nIs such a codestyle compatible with the most used and spreaded C techniques and C coding rules? I don't think so...but I m unsure. Maybe the programmer is using some very efficient methods for code writing, which are not very common.</p>\n\n<hr>\n\n<p><strong>UPDATE</strong></p>\n\n<p>Thanks to the many answers and comments.\nWhy I didn't post the code?!? <strong>Because</strong> otherwise I would reminded to post just a minimal example and not the whole code. So, it is just to respect rules. I don't hide anything.\nSo <a href=\"https://github.com/mpaperno/aq_flight_control/blob/next/src/nav_ukf.h\" rel=\"nofollow noreferrer\">here</a> the code. The structure I'm talking about is in <code>nav_ukf.h</code> declared and it is called <code>navUkfStruct_t</code>\nIn the file <code>nav_ukf.c</code> you can read in the function <code>navUkfInitState()</code> how those defines are used.\nI couldn't find any <code>malloc</code> or <code>calloc</code>.</p>\n\n<p><strong>Question #4</strong>: Since pointers must be allocated using one of the functions above (malloc, calloc), why the minimal example works?!?</p>\n"}, {"tags": ["c", "algorithm", "mmap"], "answers": [{"comments": [{"owner": {"reputation": 35084, "user_id": 585411, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/xvEpe.jpg?s=128&g=1", "display_name": "btilly", "link": "https://stackoverflow.com/users/585411/btilly"}, "edited": false, "score": 1, "creation_date": 1469030410, "post_id": 38483862, "comment_id": 64372780, "body": "Another direction that this line of reasoning can lead to is cache-oblivious data structures.  These do not require you to know page size...and also take advantages of multiple levels of CPU cache.  See <a href=\"https://blogs.msdn.microsoft.com/devdev/2007/06/12/cache-oblivious-data-structures/\" rel=\"nofollow noreferrer\">blogs.msdn.microsoft.com/devdev/2007/06/12/&hellip;</a> for more."}, {"owner": {"reputation": 8429, "user_id": 964080, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/136f4c71facafdb75bfaa0e4f047f1fc?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/964080/nick"}, "edited": false, "score": 0, "creation_date": 1469046243, "post_id": 38483862, "comment_id": 64381980, "body": "<code>madvise(MADV_RANDOM)</code> speed it up 60%. Nice, but still slow."}], "tags": [], "owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "is_accepted": true, "score": 6, "last_activity_date": 1469024415, "creation_date": 1469024415, "answer_id": 38483862, "question_id": 38482855, "link": "https://stackoverflow.com/questions/38482855/optimizing-mmap-on-very-large-file/38483862#38483862", "title": "optimizing mmap on very large file", "body": "<p>You have stumbled upon the line of reasoning that leads to the <a href=\"https://en.wikipedia.org/wiki/B-tree\">B-tree</a> data structure.  The optimization you are imagining <em>is</em> worth doing, but to get as much as possible out of it, you will need to reorganize the data on disk substantially and use more complicated algorithms than binary search.  You should probably look into existing open source B-tree libraries rather than implementing from scratch.</p>\n\n<p>Because you are using <code>mmap</code>, the minimum granularity of access is not the disk block size, but the memory \"page\" size, which can be queried with <a href=\"http://linux.die.net/man/3/sysconf\"><code>sysconf(_SC_PAGESIZE)</code></a>.  Some OSes will read and populate a larger chunk of memory on random access to a file-backed region, but I don't know of any portable way to find out how much.  You might also get some benefit from <a href=\"http://linux.die.net/man/2/madvise\"><code>madvise(MADV_RANDOM)</code></a>.</p>\n"}], "owner": {"reputation": 8429, "user_id": 964080, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/136f4c71facafdb75bfaa0e4f047f1fc?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/964080/nick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 711, "favorite_count": 1, "accepted_answer_id": 38483862, "answer_count": 1, "score": 3, "last_activity_date": 1469024449, "creation_date": 1469021735, "last_edit_date": 1469024449, "question_id": 38482855, "link": "https://stackoverflow.com/questions/38482855/optimizing-mmap-on-very-large-file", "title": "optimizing mmap on very large file", "body": "<p>I have a very large file 150 GB. I use read-only <code>mmap</code> and I perform binary search into the file.</p>\n\n<p>Currently binary search perform quite slow.</p>\n\n<p>However I am thinking of following optimization - when I check (disk seek) some value, all values \"around\" this value are already into the memory because they belong to same disk block. Instead of jumping somewhere else in the file, I can check \"near\" values and jump after that.</p>\n\n<p>Is this optimization worth doing it?</p>\n\n<p>Also how I can estimate where disk block \"ends\".</p>\n"}, {"tags": ["c", "encoding", "struct", "types", "mpi"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1469021526, "post_id": 38482698, "comment_id": 64367639, "body": "<code>N=x*Max^2 + y*Max + z</code>"}, {"owner": {"reputation": 133, "user_id": 1357875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11add77d5129c6b14fd2c734a7fa41d7?s=128&d=identicon&r=PG", "display_name": "rtur", "link": "https://stackoverflow.com/users/1357875/rtur"}, "edited": false, "score": 0, "creation_date": 1469021547, "post_id": 38482698, "comment_id": 64367657, "body": "You could just bitshift them like : <code>int coordinates = x&lt;&lt;16 | y &lt;&lt; 8 | z</code>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1469021576, "post_id": 38482698, "comment_id": 64367680, "body": "@Eugene Sh.  Perhaps <code>N=x*(Max+1)^2 + y*(Max+1) + z</code> or <code>N=(x*(Max+1) + y)*(Max+1) + z</code>"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1469021605, "post_id": 38482698, "comment_id": 64367714, "body": "@chux Yes, you are right"}, {"owner": {"reputation": 4125, "user_id": 3426025, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yxLev.png?s=128&g=1", "display_name": "BeyelerStudios", "link": "https://stackoverflow.com/users/3426025/beyelerstudios"}, "edited": false, "score": 1, "creation_date": 1469021960, "post_id": 38482698, "comment_id": 64367995, "body": "There are already many similar questions like this on SO e.g.: <a href=\"http://stackoverflow.com/q/2397655/3426025\">bit-packing-of-array-of-integers</a> or <a href=\"http://stackoverflow.com/q/5291267/3426025\">using-1-int-to-send-2-numbers</a>"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "reply_to_user": {"reputation": 133, "user_id": 1357875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11add77d5129c6b14fd2c734a7fa41d7?s=128&d=identicon&r=PG", "display_name": "rtur", "link": "https://stackoverflow.com/users/1357875/rtur"}, "edited": false, "score": 0, "creation_date": 1469022044, "post_id": 38482698, "comment_id": 64368069, "body": "@rtur - As 2^8 is a legal value, the shift should be with 18 and 9 instead of 16 and 8"}, {"owner": {"reputation": 133, "user_id": 1357875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11add77d5129c6b14fd2c734a7fa41d7?s=128&d=identicon&r=PG", "display_name": "rtur", "link": "https://stackoverflow.com/users/1357875/rtur"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1469022277, "post_id": 38482698, "comment_id": 64368274, "body": "@4386427 I assumed the OP meant one byte, not one byte + 1, not sure why :). You are right, if 2^8 supposed to be valid then the shifting needs to be one bit further to the left."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1469022652, "post_id": 38482698, "comment_id": 64368582, "body": "@4386427 exactly, that&#39;s how I fixed my asnwer."}, {"owner": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "reply_to_user": {"reputation": 4125, "user_id": 3426025, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yxLev.png?s=128&g=1", "display_name": "BeyelerStudios", "link": "https://stackoverflow.com/users/3426025/beyelerstudios"}, "edited": false, "score": 1, "creation_date": 1469041472, "post_id": 38482698, "comment_id": 64379316, "body": "As is, this is a duplicate as highlighted by @BeyelerStudios. However I strongly need to emphasize that you do not need or even want do resort to bit manipulations for this particular use case. As said in your other question, MPI is perfectly capable of sending a struct, or array thereof, and there are existing answers that explain how to do that."}], "answers": [{"comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1469021704, "post_id": 38482822, "comment_id": 64367793, "body": "The problem (which is probably in the question, but anyway) that the range given is inclusive."}, {"owner": {"reputation": 31, "user_id": 6391700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d4b92c6f8fd1fec8928f9bad3d6c83d?s=128&d=identicon&r=PG&f=1", "display_name": "BillG", "link": "https://stackoverflow.com/users/6391700/billg"}, "edited": false, "score": 0, "creation_date": 1469023214, "post_id": 38482822, "comment_id": 64369001, "body": "Thanks for the answer! If i want to store32 bit integers in array,this should be done with an array of chars?"}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1469024171, "post_id": 38482822, "comment_id": 64369718, "body": "Of course you can use <code>char</code>, although it&#39;s better to use <code>unsigned char</code>. You can read about it online."}, {"owner": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "edited": false, "score": 2, "creation_date": 1469034708, "post_id": 38482822, "comment_id": 64375365, "body": "While this correctly and nicely answers the Y-question of the OP, this totally fails to recognize that it is completely unnecessary to do this in the first place. MPI is perfectly capable to send three integers, whether in a <code>struct</code>, array or whatever. There is no reason to resort to bit-magic, it is much better to use the appropriate abstractions. This is also <a href=\"http://stackoverflow.com/questions/18165277/how-to-send-a-variable-of-type-struct-in-mpi-send\">well</a> <a href=\"http://stackoverflow.com/a/9865041/620382\">documented</a> on SO as noted on the OPs other question about this."}, {"owner": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "edited": false, "score": 0, "creation_date": 1469034880, "post_id": 38482822, "comment_id": 64375459, "body": "P.S. I strongly assume that the OP meant 8-bit in the first place or at least has no reason to optimize away 2 unnecessarily transferred bytes."}, {"owner": {"reputation": 31, "user_id": 6391700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d4b92c6f8fd1fec8928f9bad3d6c83d?s=128&d=identicon&r=PG&f=1", "display_name": "BillG", "link": "https://stackoverflow.com/users/6391700/billg"}, "edited": false, "score": 0, "creation_date": 1469042160, "post_id": 38482822, "comment_id": 64379729, "body": "Zulan i understand what you say.But as i told before i use contiguous data to send each ROW of array.So i need standard mpi type(?) in segment"}, {"owner": {"reputation": 31, "user_id": 6391700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d4b92c6f8fd1fec8928f9bad3d6c83d?s=128&d=identicon&r=PG&f=1", "display_name": "BillG", "link": "https://stackoverflow.com/users/6391700/billg"}, "edited": false, "score": 0, "creation_date": 1469042178, "post_id": 38482822, "comment_id": 64379740, "body": "MPI_Type_contiguous(row,oldtype,&amp;newtype);"}, {"owner": {"reputation": 65854, "user_id": 1374437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/34xta.png?s=128&g=1", "display_name": "Hristo &#39;away&#39; Iliev", "link": "https://stackoverflow.com/users/1374437/hristo-away-iliev"}, "reply_to_user": {"reputation": 31, "user_id": 6391700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d4b92c6f8fd1fec8928f9bad3d6c83d?s=128&d=identicon&r=PG&f=1", "display_name": "BillG", "link": "https://stackoverflow.com/users/6391700/billg"}, "edited": false, "score": 2, "creation_date": 1469047937, "post_id": 38482822, "comment_id": 64382894, "body": "@BillG, MPI types can be nested. Just create a structure type for one point, then create a contiguous type for an array of points. Also, contiguous MPI types are simply for convenience - you do not need one in order to send an array."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1469056375, "post_id": 38482822, "comment_id": 64385951, "body": "Downvoter, please read the question carefully. I think I did answer it. If you have useful information you can post a comment on the question to help the OP, but downvoting this question makes no sense unless, something is wrong or bad about it I think. And it cerainly will NOT HELP THE OP."}, {"owner": {"reputation": 31, "user_id": 6391700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d4b92c6f8fd1fec8928f9bad3d6c83d?s=128&d=identicon&r=PG&f=1", "display_name": "BillG", "link": "https://stackoverflow.com/users/6391700/billg"}, "reply_to_user": {"reputation": 65854, "user_id": 1374437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/34xta.png?s=128&g=1", "display_name": "Hristo &#39;away&#39; Iliev", "link": "https://stackoverflow.com/users/1374437/hristo-away-iliev"}, "edited": false, "score": 0, "creation_date": 1469095919, "post_id": 38482822, "comment_id": 64401872, "body": "@Hristo Iliev . My problem is that when i useMPI_Type_contiguous(oldtype=PointType,newtype=rowOfArray etc..). i get garbage in recv code.And i thought that the nested type causes that."}], "tags": [], "owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "is_accepted": true, "score": 0, "last_activity_date": 1469022943, "last_edit_date": 1469022943, "creation_date": 1469021655, "answer_id": 38482822, "question_id": 38482698, "link": "https://stackoverflow.com/questions/38482698/encode-three-coordinates-x-y-z-in-one-integer-or-float-number/38482822#38482822", "title": "Encode three coordinates (x,y,z) in one integer or float number", "body": "<p>It's a very simple thing to do, you need to encode 3 bytes in a 32bit integer which allows 4. So what you need is</p>\n\n<pre><code>int32_t coordinates;\n\ncoordinates = x | (y &lt;&lt; 8) | (z &lt;&lt; 16);\n</code></pre>\n\n<p>and then you can access the coordinates with masks of bit flags.</p>\n\n<p>Test program:</p>\n\n<pre><code>#include &lt;stdint.h&gt;\n#include &lt;stdio.h&gt;\n\nint\nmain(void)\n{\n    int x = 16;\n    int y = 2;\n    int z = 4;\n    int32_t coordinates = x | (y &lt;&lt; 8) | (z &lt;&lt; 16);\n\n    fprintf(stdout, \"x = %d\\n\", (coordinates &amp; 0xFF));\n    fprintf(stdout, \"y = %d\\n\", ((coordinates &gt;&gt; 8) &amp; 0xFF));\n    fprintf(stdout, \"z = %d\\n\", ((coordinates &gt;&gt; 16) &amp; 0xFF));\n    return 0;\n}\n</code></pre>\n\n<p>But then you can't encode 256 because it requires one more bit, remember that you start at 2<sup>0</sup> so you can only represent 255 with 8 bits, so here is an idea</p>\n\n<pre><code>#include &lt;stdint.h&gt;\n#include &lt;stdio.h&gt;\n\n#define XSHIFT 0\n#define YSHIFT 9\n#define ZSHIFT 18\n\n#define GET_X(x) (((x) &gt;&gt; XSHIFT) &amp; 0x1FF)\n#define GET_Y(y) (((y) &gt;&gt; YSHIFT) &amp; 0x1FF)\n#define GET_Z(z) (((z) &gt;&gt; ZSHIFT) &amp; 0x1FF)\n#define ENCODE(x, y, z) (((x) &lt;&lt; XSHIFT) | ((y) &lt;&lt; YSHIFT) | ((z) &lt;&lt; ZSHIFT))\n\nint\nmain(void)\n{\n    int32_t coordinates = ENCODE(256, 0, 1);\n\n    fprintf(stdout, \"x = %d\\n\", GET_X(coordinates));\n    fprintf(stdout, \"y = %d\\n\", GET_Y(coordinates));\n    fprintf(stdout, \"z = %d\\n\", GET_Z(coordinates));\n    return 0;\n}\n</code></pre>\n\n<p>Use one extra bit from the remaining 8 bits that you have in a 32 bit integer.</p>\n\n<p><strong>NOTE</strong>: perhaps you (<em>and others</em>) think that defining <code>XSHIFT</code> is superflous but I think that the expressions then make more sense and are easier to read. It's something I believe I learned from studying physics and it's hard for me to see things like <code>x + 7</code> in code as it is in mathematical expressions derived from physical laws.</p>\n"}], "owner": {"reputation": 31, "user_id": 6391700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d4b92c6f8fd1fec8928f9bad3d6c83d?s=128&d=identicon&r=PG&f=1", "display_name": "BillG", "link": "https://stackoverflow.com/users/6391700/billg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1340, "favorite_count": 0, "accepted_answer_id": 38482822, "answer_count": 1, "score": -1, "last_activity_date": 1469022943, "creation_date": 1469021328, "last_edit_date": 1469022737, "question_id": 38482698, "link": "https://stackoverflow.com/questions/38482698/encode-three-coordinates-x-y-z-in-one-integer-or-float-number", "title": "Encode three coordinates (x,y,z) in one integer or float number", "body": "<p>I got a programm in C , that uses MPI in order to send coordinates of a specific point in (x,y,z) axis' between processes.Because the points sent,are in contiguous type (Rows of a 2d array) i want to encode the coordinates that are stored in a struct</p>\n\n<pre><code>  Struct pnts{\n\n    int x;\n    int y;\n    int z;\n  }pnt;\n</code></pre>\n\n<p>In one number (<em>INTEGER/FLOAT</em>) I need to encode these three coordinates\nCoordinates are integer numbers in the interval [0, 2<sup>8</sup>]\nFor example : <em>x</em> = 16, <em>y</em> = 2, <em>z</em> = 4 with respect to <em>x</em> &lt; <em>y</em> &lt; <em>z</em> </p>\n\n<p>Any ideas?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 95690, "user_id": 984823, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2KYN.jpg?s=128&g=1", "display_name": "Joop Eggen", "link": "https://stackoverflow.com/users/984823/joop-eggen"}, "edited": false, "score": 0, "creation_date": 1469021368, "post_id": 38482586, "comment_id": 64367487, "body": "What about <code>\\u00DFC</code>?"}, {"owner": {"reputation": 1017, "user_id": 2599537, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/bf6e2a137be7b8bd13d1f8efec703554?s=128&d=identicon&r=PG", "display_name": "devil0150", "link": "https://stackoverflow.com/users/2599537/devil0150"}, "edited": false, "score": 0, "creation_date": 1469021465, "post_id": 38482586, "comment_id": 64367577, "body": "have you tried using %c for the \\xDF?"}, {"owner": {"reputation": 71, "user_id": 6613818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/724b2ec264af02fd95974b5b2f9d9cc5?s=128&d=identicon&r=PG&f=1", "display_name": "Richard", "link": "https://stackoverflow.com/users/6613818/richard"}, "edited": false, "score": 0, "creation_date": 1469092236, "post_id": 38482586, "comment_id": 64399369, "body": "The unicode option does not work in my c compiler. It gives the following <b>warning: universal character names are only valid in C++ and C99</b>  Both octal and combining two adjacent string literals work well, thank you for the help!  Regards Richard"}], "answers": [{"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 8, "last_activity_date": 1469021359, "creation_date": 1469021359, "answer_id": 38482708, "question_id": 38482586, "link": "https://stackoverflow.com/questions/38482586/unknown-escape-sequence/38482708#38482708", "title": "Unknown escape sequence", "body": "<p>You can take advantage of the fact that consecutive string literals are automatically concatenated:</p>\n\n<pre><code> printf(\"**TABLE 24A (20\\xDF\" \"C)**\");\n</code></pre>\n\n<p>This prevents the parser from consuming more characters for the escape sequence than you want.</p>\n\n<p>You could also pass in the character as a parameter and use the <code>%c</code> format specifier to print it:</p>\n\n<pre><code>printf(\"**TABLE 24A (20%cC)**\", '\\xDF');\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 305833, "user_id": 68587, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/7d9fd158e03cbde94f7e0b33b78222af?s=128&d=identicon&r=PG", "display_name": "John Kugelman", "link": "https://stackoverflow.com/users/68587/john-kugelman"}, "is_accepted": true, "score": 7, "last_activity_date": 1469021420, "creation_date": 1469021420, "answer_id": 38482730, "question_id": 38482586, "link": "https://stackoverflow.com/questions/38482586/unknown-escape-sequence/38482730#38482730", "title": "Unknown escape sequence", "body": "<p><code>\\x</code> escape sequences consume as many adjacent hex digits as possible. The <code>C</code> is being parsed as a hex digit.</p>\n\n<p>With <code>\\x</code>, you could combine two adjacent string literals.</p>\n\n<pre><code>printf(\"**TABLE 24A (20\\xDF\"\"C)**\");\n</code></pre>\n\n<p>Or use a <code>\\unnnn</code> Unicode escape, which is limited to four hex characters.</p>\n\n<pre><code>printf(\"**TABLE 24A (20\\u00DFC)**\");\n</code></pre>\n\n<p>Or octal <code>\\nnn</code>:</p>\n\n<pre><code>printf(\"**TABLE 24A (20\\337C)**\");\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 6613818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/724b2ec264af02fd95974b5b2f9d9cc5?s=128&d=identicon&r=PG&f=1", "display_name": "Richard", "link": "https://stackoverflow.com/users/6613818/richard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1239, "favorite_count": 0, "accepted_answer_id": 38482730, "answer_count": 2, "score": 3, "last_activity_date": 1469024262, "creation_date": 1469021067, "last_edit_date": 1469024262, "question_id": 38482586, "link": "https://stackoverflow.com/questions/38482586/unknown-escape-sequence", "title": "Unknown escape sequence", "body": "<p>I am trying to printf a string that shows a temperature table \n<code>printf(\"TABLE 24A (20\\\u00b0C)\");</code></p>\n\n<p>The degree sign is a constant I have defined as <code>0xDF</code> so the the string looks like this: <code>\"TABLE 24A (20\\xDF C)\"</code></p>\n\n<p>This works but looks incorrect because of the space between the <code>\\xDF</code> and the <code>C</code>. \nIf I remove the space the compiler issues a warning <em>hex escape sequence out of range</em>.</p>\n\n<p>If I modify the string to <code>\"TABLE 24A (20\\xDF\\C)\"</code> I get the correct result but the compiler issues warning <em>unknown escape sequence: '\\C'</em></p>\n\n<p>Is there a way to get rid of the warnings but lose the space between the two characters?</p>\n"}, {"tags": ["python", "c", "memory-management", "cpython"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1469021761, "post_id": 38482327, "comment_id": 64367830, "body": "Your extension type contains a bunch of pointers.  It is unclear how these are used, but if any of them at any time get assigned the only pointer to a block of memory that must be freed, then the <code>dealloc</code> function must handle freeing that memory when appropriate.  Moreover, in that case, your type&#39;s methods must handle those members appropriately -- for example, freeing the pointed-to memory before overwriting the pointer value with a different one."}, {"owner": {"reputation": 2318, "user_id": 1435290, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/31dd6cc59842c1ab51e14b59348dfdee?s=128&d=identicon&r=PG&f=1", "display_name": "e-nouri", "link": "https://stackoverflow.com/users/1435290/e-nouri"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1469024800, "post_id": 38482327, "comment_id": 64370235, "body": "Thank you @JohnBollinger, They are deallocated in different methods, and the closeAll(). I am searching what references are not cleaned."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1469024803, "post_id": 38482327, "comment_id": 64370239, "body": "CPython uses reference counting, which means that data is deallocated as soon as possible, unless there are cycles.  If you never create cyclic data structures, the thing you are doing with <code>setrlimit</code> cannot possibly help.  If you do use cyclic data structures, the <a href=\"https://docs.python.org/3/library/gc.html\" rel=\"nofollow noreferrer\"><code>gc</code></a> interfaces are more likely to help."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1469024884, "post_id": 38482327, "comment_id": 64370320, "body": "It would be wise for the <code>dealloc</code> function to free any memory owned by the object that hasn&#39;t already been freed; this will provide a safety net against programming errors."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1469025071, "post_id": 38482327, "comment_id": 64370461, "body": "@e-nouri, I repeat,  if any of the pointers at any time get assigned the only pointer to a block of memory that must be freed, then <b><i>the dealloc function</i></b> must handle freeing that memory when appropriate.  It is acceptable for other functions also to deallocate as long as they have a means to indicate to the <code>dealloc</code> function that it should not deallocate the same memory again, but you should not rely for correct deallocation exclusively on methods that must be called by your module&#39;s user."}, {"owner": {"reputation": 2318, "user_id": 1435290, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/31dd6cc59842c1ab51e14b59348dfdee?s=128&d=identicon&r=PG&f=1", "display_name": "e-nouri", "link": "https://stackoverflow.com/users/1435290/e-nouri"}, "edited": false, "score": 0, "creation_date": 1469089062, "post_id": 38482327, "comment_id": 64397164, "body": "Thank you all, I actually missed the numpy array I was using <code>PyArrayObject </code> which is allocating the bigger memory (almost 100Mb for each read), so I modified the struct to keep track of the pointer and then free it before deallocating the Python object."}], "answers": [{"tags": [], "owner": {"reputation": 2318, "user_id": 1435290, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/31dd6cc59842c1ab51e14b59348dfdee?s=128&d=identicon&r=PG&f=1", "display_name": "e-nouri", "link": "https://stackoverflow.com/users/1435290/e-nouri"}, "is_accepted": true, "score": 0, "last_activity_date": 1469088775, "creation_date": 1469088775, "answer_id": 38498606, "question_id": 38482327, "link": "https://stackoverflow.com/questions/38482327/cpython-memory-management/38498606#38498606", "title": "CPython memory management", "body": "<p>I found the solution, I was using <code>PyArrayObject</code> that I did not keep a pointer for in the declared struct. The memory was not being released because of this huge numpy array.</p>\n\n<p>So my struct look like this now:</p>\n\n<pre><code>typedef struct {\n    PyObject_HEAD\n    AL_KEY ienaKey;\n    char* dataPath;\n    int nbParams;\n    char** pListOfParams;\n    CLIST_S* listParam;\n    AL_DEFP_S *pListeParamInfo;\n    int* pIndexParamIsTopana;\n    // Added this pointer to the numpy array\n    reel64* pValueArray;\n} libzihc_MRLoader;\n</code></pre>\n\n<p>And in the deallocate function, I called <code>free()</code> before destroying the <code>PyObject</code> self. Now the program does not uses more than 100Mb, the array is big.</p>\n\n<p>Deallocate function:</p>\n\n<pre><code>static void MRLoader_dealloc(MRLoader *self){\n    free(self-&gt;pValueArray)\n    self-&gt;ob_type-&gt;tp_free((PyObject *)self);\n}\n</code></pre>\n"}], "owner": {"reputation": 2318, "user_id": 1435290, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/31dd6cc59842c1ab51e14b59348dfdee?s=128&d=identicon&r=PG&f=1", "display_name": "e-nouri", "link": "https://stackoverflow.com/users/1435290/e-nouri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "accepted_answer_id": 38498606, "answer_count": 1, "score": 0, "last_activity_date": 1469088775, "creation_date": 1469020390, "question_id": 38482327, "link": "https://stackoverflow.com/questions/38482327/cpython-memory-management", "title": "CPython memory management", "body": "<p>I am writing a CPython module <code>mrloader</code> on top of a C library, I compiled source code and started making some tests.</p>\n\n<p>Python takes 4 Gb of RAM to run 100 iteration loop to get some data from network. This is a big problem, so I used <code>resource</code> to limit the amount of RAM and test if the Python GC's frees the memory. I got a <code>Segmentation fault</code>.</p>\n\n<p>I used <a href=\"https://docs.python.org/2/c-api/memory.html\" rel=\"nofollow\">this</a> documentation and <a href=\"https://docs.python.org/2/extending/newtypes.html\" rel=\"nofollow\">this</a> to write the module, and I think I am doing something wrong when the objects being collected, because if I don't limit the RAM it finishes the 100 loop but it uses 4Gb of memory.</p>\n\n<p>In the mrloader <code>CPython</code> code I have a struct like so:</p>\n\n<pre><code>typedef struct {\n    PyObject_HEAD\n    AL_KEY ienaKey;\n    char* dataPath;\n    int nbParams;\n    char** pListOfParams;\n    CLIST_S* listParam;\n    AL_DEFP_S *pListeParamInfo;\n    int* pIndexParamIsTopana;\n} MRLoader;\n</code></pre>\n\n<p>The Python test is like so:</p>\n\n<pre><code>def limit_memory(maxsize):\n    soft, hard = resource.getrlimit(resource.RLIMIT_AS)\n    resource.setrlimit(resource.RLIMIT_AS, (maxsize, hard))\n\nlimit_memory(8589934592/10)\n\nfor i in xrange(100):\n    print '----------------------------', i, '--------------------------' \n    obj = MRLoader.MRLoader(MR)\n    obj.initReaderCadence(paramList, cadence, zdtStart, zdtStop)\n    print obj.getData()\n    obj.closeAll()\n</code></pre>\n\n<p>In the CPython code, the <code>destructor</code> is declared like so:</p>\n\n<pre><code>static void MRLoader_dealloc(MRLoader *self){\n    self-&gt;ob_type-&gt;tp_free((PyObject *)self);\n}\n</code></pre>\n\n<p>Am I correctly deallocating the memory ?</p>\n\n<p>I appreciate your time helping me.</p>\n"}, {"tags": ["c", "automation", "switch-statement", "scanf", "ansi"], "comments": [{"owner": {"reputation": 7497, "user_id": 1213227, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/78179ef730f268752c0f6fdde3943b99?s=128&d=identicon&r=PG", "display_name": "Matthias", "link": "https://stackoverflow.com/users/1213227/matthias"}, "edited": false, "score": 0, "creation_date": 1469020454, "post_id": 38482058, "comment_id": 64366768, "body": "In my understanding, your second input is malformed. If you have a line with &quot;1&quot;, you need another line with the single appointment of that day, <i>before</i> you can announce that the next day has two appointments."}, {"owner": {"reputation": 9, "user_id": 6613738, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206716673181500/picture?type=large", "display_name": "Guilherme Nascimento", "link": "https://stackoverflow.com/users/6613738/guilherme-nascimento"}, "reply_to_user": {"reputation": 7497, "user_id": 1213227, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/78179ef730f268752c0f6fdde3943b99?s=128&d=identicon&r=PG", "display_name": "Matthias", "link": "https://stackoverflow.com/users/1213227/matthias"}, "edited": false, "score": 0, "creation_date": 1469021276, "post_id": 38482058, "comment_id": 64367412, "body": "I want to ignore the number &quot;1&quot; if I type a second number like &quot;2&quot; in example. So if my &quot;ret&quot; variable gets value &quot;1&quot; as I typed one thing, I want to recognize as my new testcase number"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1469021889, "post_id": 38482058, "comment_id": 64367934, "body": "Post definition of <code>appoint</code>, <code>schedule[]</code>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1469022082, "post_id": 38482058, "comment_id": 64368099, "body": "It does not make sense that code performs <code>if((initH &lt; INIT)...</code> and <code>if((initH*HOUR...</code> should <code>ret != 5</code>."}, {"owner": {"reputation": 9, "user_id": 6613738, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206716673181500/picture?type=large", "display_name": "Guilherme Nascimento", "link": "https://stackoverflow.com/users/6613738/guilherme-nascimento"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1469022276, "post_id": 38482058, "comment_id": 64368272, "body": "@chux , that&#39;s it!"}], "answers": [{"tags": [], "owner": {"reputation": 9, "user_id": 6613738, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206716673181500/picture?type=large", "display_name": "Guilherme Nascimento", "link": "https://stackoverflow.com/users/6613738/guilherme-nascimento"}, "is_accepted": true, "score": 0, "last_activity_date": 1469022144, "creation_date": 1469022144, "answer_id": 38483008, "question_id": 38482058, "link": "https://stackoverflow.com/questions/38482058/uva-longest-nap/38483008#38483008", "title": "UVa - Longest Nap", "body": "<p>Well, I've been stuck on this all day long yesterday and when I decide to ask for help I figure out a solution! Pretty easy actually!</p>\n\n<pre><code>if(ret == 5){ //only if I have 5 arguments in my scanf!\n    if((initH &lt; INIT) || (fintM + fintH*HOUR) &gt; ENDTIME) {error++; break;}\n    //10:00 &lt; time &lt; 18:00 \n    if((initH*HOUR + initM) &gt; (fintH*HOUR + fintM)) {error++; break;}\n    //initial hour in a schedule &lt; end time in a schedule\n}\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 6613738, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206716673181500/picture?type=large", "display_name": "Guilherme Nascimento", "link": "https://stackoverflow.com/users/6613738/guilherme-nascimento"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 222, "favorite_count": 0, "accepted_answer_id": 38483008, "answer_count": 1, "score": 1, "last_activity_date": 1469022532, "creation_date": 1469019688, "last_edit_date": 1469022532, "question_id": 38482058, "link": "https://stackoverflow.com/questions/38482058/uva-longest-nap", "title": "UVa - Longest Nap", "body": "<p>well it's been pretty hard find an answer since I don't know how to express this in english to find out! So,</p>\n\n<p>I'm trying to do the <strong>Longest Nap</strong> problem: \n<a href=\"https://uva.onlinejudge.org/external/101/10191.pdf\" rel=\"nofollow\">https://uva.onlinejudge.org/external/101/10191.pdf</a></p>\n\n<p>My code is working but I keep receiving wrong answer from judge and I think the problem is when I type two test cases in a row.</p>\n\n<p>I type:</p>\n\n<pre><code>1 \n12:00 13:00 schedule A\n</code></pre>\n\n<p>so:</p>\n\n<pre><code>Day #1: the longest nap starts at 13:00 and will last for 5 hours and 0 minutes.\n</code></pre>\n\n<p>but if I type:</p>\n\n<pre><code>1\n2\n</code></pre>\n\n<p>the number 2 is ignored as a new test case and I assume that's why I'm getting wrong answer from judge</p>\n\n<p>So I want the second number I type, that is caught by the second scanf in my code be the new testcase. I tried to add in my switch case a case 1: where I force testcase be the initH since the new test case I typed is caught by this variable but with no success</p>\n\n<pre><code>    while(scanf(\"%d\", &amp;testcase) == 1) {\n\n    int result = 0, start;\n\n    if(testcase &gt; MAXVALUE)  continue;\n     //here I ignore testcase &gt; 100\n    if(testcase == 0) {ret = SCANF; start = STARTIME; result = WORK;}\n     //if there's no testcase my longest nap will be the 8 hours! SCANF = 5\n\n    for(i = 0; i &lt; testcase; i++) {\n        ret = scanf(\"%d:%d %d:%d %255[a-zA-Z ]\", &amp;initH, &amp;initM, &amp;fintH, &amp;fintM, appoint);\n         //variables: H(hour), M(minute), appointment\n\n        switch (ret){\n        case 5:\n            schedule[i].start = initH*HOUR + initM; //struct here\n            schedule[i].endin = fintH*HOUR + fintM; //to keep this data\n            break;\n        default:\n            i = testcase;\n            break;\n        }\n\n        if((initH &lt; INIT) || (fintM + fintH*HOUR) &gt; ENDTIME) {error++; break;}\n         //10:00 &lt; time &lt; 18:00 \n        if((initH*HOUR + initM) &gt; (fintH*HOUR + fintM)) {error++; break;}\n         //initial hour in a schedule &lt; end time in a schedule\n\n        while(getchar() != '\\n');\n    }\n\n    if(error != 0) {error = 0; continue;} //if error then ignore everything!\n</code></pre>\n"}, {"tags": ["c", "algorithm", "matlab", "matlab-deployment", "matlab-coder"], "answers": [{"tags": [], "owner": {"reputation": 1539, "user_id": 5859283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/caadb9341d16d68d56caf9a874c97832?s=128&d=identicon&r=PG&f=1", "display_name": "4Oh4", "link": "https://stackoverflow.com/users/5859283/4oh4"}, "is_accepted": false, "score": 1, "last_activity_date": 1469025969, "creation_date": 1469025969, "answer_id": 38484489, "question_id": 38481619, "link": "https://stackoverflow.com/questions/38481619/using-matlab-coder-generated-algorithm-for-production/38484489#38484489", "title": "Using Matlab Coder generated algorithm for Production", "body": "<p>If the function call you refer to is the entry-point function, you can define the size when setting up Coder. The simplest way to run the Coder is using the GUI from the 'Apps' menu inside MATLAB (or type 'coder' at the console). After specifying the entry-point function, step 2 is to define the type and size for each of the input variables.</p>\n\n<p>For each dimension of your input variable (there can be more than 2 if necessary), you can specify the:</p>\n\n<pre><code> n  - dimension is exactly n long\n:n  - dimension is up to n long\ninf - dimension is unbounded\n</code></pre>\n\n<p>If the function call is not the entry-point function, and is buried inside your code (or if you are running the <em>codegen</em> function from the console), you can explicitly define variables as being of varying size:</p>\n\n<pre><code>coder.varsize('myVariableName');\n</code></pre>\n\n<p>Bear in mind that some functions can only be used (with Coder) with fixed-sized inputs.</p>\n\n<p>Fuller description here: \n<a href=\"http://uk.mathworks.com/help/fixedpoint/ug/defining-variable-size-data-for-code-generation.html#br9t627\" rel=\"nofollow\">http://uk.mathworks.com/help/fixedpoint/ug/defining-variable-size-data-for-code-generation.html#br9t627</a></p>\n\n<p>Not sure about the random constants unfortunately.</p>\n"}], "owner": {"reputation": 61, "user_id": 1608940, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/837e3245ab28f1e5eae96ee9986ce0de?s=128&d=identicon&r=PG", "display_name": "podon", "link": "https://stackoverflow.com/users/1608940/podon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1469025969, "creation_date": 1469018488, "last_edit_date": 1469018936, "question_id": 38481619, "link": "https://stackoverflow.com/questions/38481619/using-matlab-coder-generated-algorithm-for-production", "title": "Using Matlab Coder generated algorithm for Production", "body": "<p>I have a fine tuned algorithm in MATLAB that operates on matrices (ofcourse). I've used matlab coder to generate c code for this algorithm and it works as expected.</p>\n\n<p>Here's a function call that I used in Matlab</p>\n\n<pre><code>x = B/A \n</code></pre>\n\n<p>wherein </p>\n\n<ul>\n<li>B is of size 1*500 (rows * columns) </li>\n<li>A is of size 10*500 </li>\n<li>x, the result is of size 1*10</li>\n</ul>\n\n<p>When this is converted into C source using Matlab Coder. I noticed that the function definition accepts parameters that are same as above sizes. </p>\n\n<pre><code>void myfunction(const double B[500], const double A[5000], double x[10])\n</code></pre>\n\n<p>For prototype and testing purposes this seems okay. However, in production I prefer to have this function be used for different sizes too. For example 100 instead of 500 in above mentioned variables should also work. How can I remove dependence of matrix dimensions in my algorithm ?</p>\n\n<p>Additionally, there are few lines of code that use hard coded integers. For example, there is code like </p>\n\n<pre><code>if (rankR &lt;= 1.4903363393874656E-8)\n// Some internal function calls\nelse\n// Usage of standard sqrt\n</code></pre>\n\n<p>or</p>\n\n<pre><code>500.0 * fabs(A[0]) * 2.2204460492503131E-16\n</code></pre>\n\n<p>Could any one explain what are these hard coded integers ? Are these generated from the test data that I've used in MATLAB ?</p>\n"}, {"tags": ["c", "eclipse", "cygwin", "mingw32", "gprof"], "answers": [{"comments": [{"owner": {"reputation": 6281, "user_id": 5105383, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2YCB5.jpg?s=128&g=1", "display_name": "matzeri", "link": "https://stackoverflow.com/users/5105383/matzeri"}, "edited": false, "score": 0, "creation_date": 1469342408, "post_id": 38486072, "comment_id": 64490082, "body": "close it as self answered then."}, {"owner": {"reputation": 352, "user_id": 4312669, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ndg3j.png?s=128&g=1", "display_name": "sebkraemer", "link": "https://stackoverflow.com/users/4312669/sebkraemer"}, "edited": false, "score": 0, "creation_date": 1523348999, "post_id": 38486072, "comment_id": 86512190, "body": "Indeed. Had the same &quot;issue&quot;. Apparently, no function call took longer than the sampling time, which is 0.01 seconds. Also, it&#39;s not trivial to increase the sampling interval (<a href=\"http://binutils.sourceware.narkive.com/Qfwc5miT/help-change-the-sampling-time-in-gprof\" rel=\"nofollow noreferrer\">reference</a>)."}], "tags": [], "owner": {"reputation": 15, "user_id": 1935131, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/fIJ3Y.jpg?s=128&g=1", "display_name": "the_grandson", "link": "https://stackoverflow.com/users/1935131/the-grandson"}, "is_accepted": true, "score": 0, "last_activity_date": 1469032426, "creation_date": 1469032426, "answer_id": 38486072, "question_id": 38481261, "link": "https://stackoverflow.com/questions/38481261/report-shows-no-time-accumulated-for-gprof-using-eclipse-cdt/38486072#38486072", "title": "Report shows &quot;no time accumulated&quot; for gprof using Eclipse CDT", "body": "<p>Sorry for the question, seems that the code is faster than gprof can measure.</p>\n\n<p>As my application involves a neural network train with several iterations and further testing of kernels, I didn't suspected that a fast code could be causing the problem. I inserted a long loop in the main body and the gprof time was printed.</p>\n"}], "owner": {"reputation": 15, "user_id": 1935131, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/fIJ3Y.jpg?s=128&g=1", "display_name": "the_grandson", "link": "https://stackoverflow.com/users/1935131/the-grandson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1827, "favorite_count": 1, "accepted_answer_id": 38486072, "answer_count": 1, "score": 0, "last_activity_date": 1469032426, "creation_date": 1469017516, "last_edit_date": 1592644375, "question_id": 38481261, "link": "https://stackoverflow.com/questions/38481261/report-shows-no-time-accumulated-for-gprof-using-eclipse-cdt", "title": "Report shows &quot;no time accumulated&quot; for gprof using Eclipse CDT", "body": "<p>After compiling with flags: <code>-O0 -p -pg -Wall -c</code> on GCC and <code>-p -pg</code> on the MinGW linker, the eclipse plugin gprof for shows no results. After that I did a cmd call using <code>gprof my.exe gmon.out &gt; prof.txt</code>, which resulted in a report witth only the number of calls to functions.</p>\n<pre><code>Flat profile: \nEach sample counts as 0.01 seconds.\nno time accumulated\n\n  %   cumulative   self              self     total           \n time   seconds   seconds    calls  Ts/call  Ts/call  name    \n  0.00      0.00     0.00    16000     0.00     0.00  vector_norm\n  0.00      0.00     0.00       16     0.00     0.00  rbf_kernel\n  0.00      0.00     0.00        8     0.00     0.00  lubksb\n</code></pre>\n<p>I've came across this topic: <a href=\"https://stackoverflow.com/questions/1030829/gprof-reports-no-time-accumulated\">gprof reports no time accumulated</a>. But my program is terminating in a clear maner. Also, <a href=\"https://www.eclipse.org/forums/index.php/t/197494/\" rel=\"nofollow noreferrer\">gprof view show no data on MingW/Windows</a>, but I am using 32 bits GCC. I have previously tried to use Cygwin, same result.</p>\n<p>I am using eclipse Kepler with CDT version 8.3.0.201402142303 and MinGW with GCC 5.4.0.</p>\n<p>Any help is appreciated, thank you in advance.</p>\n"}, {"tags": ["android", "c", "linux", "filesystems", "chmod"], "comments": [{"owner": {"reputation": 5835, "user_id": 1446154, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/e203591509f88fc8c8aeadc01dc1a5d1?s=128&d=identicon&r=PG&f=1", "display_name": "Laser", "link": "https://stackoverflow.com/users/1446154/laser"}, "edited": false, "score": 0, "creation_date": 1469015652, "post_id": 38480567, "comment_id": 64363126, "body": "try to <code>chmod 777</code> instead of <code>chmod +x </code>"}, {"owner": {"reputation": 479, "user_id": 3270494, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/7e1c387b66eca45b8299bf301497f9e6?s=128&d=identicon&r=PG&f=1", "display_name": "Ankit Arora", "link": "https://stackoverflow.com/users/3270494/ankit-arora"}, "reply_to_user": {"reputation": 5835, "user_id": 1446154, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/e203591509f88fc8c8aeadc01dc1a5d1?s=128&d=identicon&r=PG&f=1", "display_name": "Laser", "link": "https://stackoverflow.com/users/1446154/laser"}, "edited": false, "score": 1, "creation_date": 1469015709, "post_id": 38480567, "comment_id": 64363190, "body": "doesn&#39;t let me execute it if i use chmod 777"}, {"owner": {"reputation": 5835, "user_id": 1446154, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/e203591509f88fc8c8aeadc01dc1a5d1?s=128&d=identicon&r=PG&f=1", "display_name": "Laser", "link": "https://stackoverflow.com/users/1446154/laser"}, "edited": false, "score": 0, "creation_date": 1469015744, "post_id": 38480567, "comment_id": 64363206, "body": "Yes it will let you execute"}, {"owner": {"reputation": 479, "user_id": 3270494, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/7e1c387b66eca45b8299bf301497f9e6?s=128&d=identicon&r=PG&f=1", "display_name": "Ankit Arora", "link": "https://stackoverflow.com/users/3270494/ankit-arora"}, "reply_to_user": {"reputation": 5835, "user_id": 1446154, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/e203591509f88fc8c8aeadc01dc1a5d1?s=128&d=identicon&r=PG&f=1", "display_name": "Laser", "link": "https://stackoverflow.com/users/1446154/laser"}, "edited": false, "score": 0, "creation_date": 1469015772, "post_id": 38480567, "comment_id": 64363229, "body": "gives this error CANNOT LINK EXECUTABLE: cannot locate symbol &quot;signal&quot; referenced by &quot;./ssh&quot;..."}, {"owner": {"reputation": 5835, "user_id": 1446154, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/e203591509f88fc8c8aeadc01dc1a5d1?s=128&d=identicon&r=PG&f=1", "display_name": "Laser", "link": "https://stackoverflow.com/users/1446154/laser"}, "edited": false, "score": 0, "creation_date": 1469015808, "post_id": 38480567, "comment_id": 64363253, "body": "please post full command"}, {"owner": {"reputation": 479, "user_id": 3270494, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/7e1c387b66eca45b8299bf301497f9e6?s=128&d=identicon&r=PG&f=1", "display_name": "Ankit Arora", "link": "https://stackoverflow.com/users/3270494/ankit-arora"}, "reply_to_user": {"reputation": 5835, "user_id": 1446154, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/e203591509f88fc8c8aeadc01dc1a5d1?s=128&d=identicon&r=PG&f=1", "display_name": "Laser", "link": "https://stackoverflow.com/users/1446154/laser"}, "edited": false, "score": 0, "creation_date": 1469015955, "post_id": 38480567, "comment_id": 64363360, "body": "so am using chmod 777 rsync on the terminal 1|root@rk3188:/data/data/com.ankit.sync/execute # chmod 777 rsync  and the result is root@rk3188:/data/data/com.ankit.sync/execute # ./rsync                CANNOT LINK EXECUTABLE: cannot locate symbol &quot;sigemptyset&quot; referenced by &quot;./rsync&quot;..."}, {"owner": {"reputation": 5835, "user_id": 1446154, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/e203591509f88fc8c8aeadc01dc1a5d1?s=128&d=identicon&r=PG&f=1", "display_name": "Laser", "link": "https://stackoverflow.com/users/1446154/laser"}, "edited": false, "score": 0, "creation_date": 1469016001, "post_id": 38480567, "comment_id": 64363396, "body": "could you please post exact command and output (in your question please)"}, {"owner": {"reputation": 479, "user_id": 3270494, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/7e1c387b66eca45b8299bf301497f9e6?s=128&d=identicon&r=PG&f=1", "display_name": "Ankit Arora", "link": "https://stackoverflow.com/users/3270494/ankit-arora"}, "reply_to_user": {"reputation": 5835, "user_id": 1446154, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/e203591509f88fc8c8aeadc01dc1a5d1?s=128&d=identicon&r=PG&f=1", "display_name": "Laser", "link": "https://stackoverflow.com/users/1446154/laser"}, "edited": false, "score": 0, "creation_date": 1469016043, "post_id": 38480567, "comment_id": 64363427, "body": "sure just editing the question, thanks"}], "answers": [{"tags": [], "owner": {"reputation": 7617, "user_id": 2878070, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/42b5fba5761d7e519d05b642be0b2e14?s=128&d=identicon&r=PG&f=1", "display_name": "Sergio", "link": "https://stackoverflow.com/users/2878070/sergio"}, "is_accepted": true, "score": 1, "last_activity_date": 1469016508, "creation_date": 1469016508, "answer_id": 38480892, "question_id": 38480567, "link": "https://stackoverflow.com/questions/38480567/how-to-run-executable-binaries-on-an-android-os-where-chmod-x-doesnt-work/38480892#38480892", "title": "How to run executable binaries on an android OS where chmod +x doesn&#39;t work?", "body": "<pre><code>CANNOT LINK EXECUTABLE: cannot locate symbol \"sigemptyset\" referenced by \"./rsync\"...\n</code></pre>\n\n<p>Probably you are trying to launch binary that was built for android-21 or above on older device. Try to rebuilt it for target platform android-19.</p>\n"}], "owner": {"reputation": 479, "user_id": 3270494, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/7e1c387b66eca45b8299bf301497f9e6?s=128&d=identicon&r=PG&f=1", "display_name": "Ankit Arora", "link": "https://stackoverflow.com/users/3270494/ankit-arora"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 466, "favorite_count": 0, "accepted_answer_id": 38480892, "answer_count": 1, "score": 0, "last_activity_date": 1469016508, "creation_date": 1469015568, "last_edit_date": 1469016116, "question_id": 38480567, "link": "https://stackoverflow.com/questions/38480567/how-to-run-executable-binaries-on-an-android-os-where-chmod-x-doesnt-work", "title": "How to run executable binaries on an android OS where chmod +x doesn&#39;t work?", "body": "<p>I built an rsync android application for syncing stuff from a linux computer to the android and the application is working fine on my phone which allows you to use chmod +x in the application folders. But the chmod +x command is not working on an android tablet i have, the chmod +x returns bad mode. \nAnd some of the partitions are in noexec mode plus when i remounted all of them to exec mode then it still wouldn't work and chmod +x is still giving me bad mode. \nI need to chmod +x those binaries to use them as executables, is there any other way i can do that? </p>\n\n<hr>\n\n<pre><code>root@rk3188:/ # mount\nrootfs / rootfs rw,relatime 0 0\ntmpfs /dev tmpfs rw,seclabel,nosuid,relatime,mode=755 0 0\ndevpts /dev/pts devpts rw,seclabel,relatime,mode=600 0 0\nproc /proc proc rw,relatime 0 0\nsysfs /sys sysfs rw,seclabel,relatime 0 0\nselinuxfs /sys/fs/selinux selinuxfs rw,relatime 0 0\nnone /acct cgroup rw,relatime,cpuacct 0 0\nnone /sys/fs/cgroup tmpfs rw,seclabel,relatime,mode=750,gid=1000 0 0\nnone /sys/fs/cgroup/memory cgroup rw,relatime,memory 0 0\ntmpfs /mnt/secure tmpfs rw,seclabel,relatime,mode=700 0 0\ntmpfs /mnt/asec tmpfs rw,seclabel,relatime,mode=755,gid=1000 0 0\ntmpfs /mnt/obb tmpfs rw,seclabel,relatime,mode=755,gid=1000 0 0\nnone /dev/cpuctl cgroup rw,relatime,cpu 0 0\n/dev/block/platform/emmc/by-name/system /system ext4 ro,seclabel,noatime,nodiratime,user_xattr,barrier=1,data=ordered,noauto_da_alloc,discard 0 0\n/dev/block/platform/emmc/by-name/cache /cache ext4 rw,seclabel,nosuid,nodev,noatime,nodiratime,user_xattr,barrier=1,data=ordered,noauto_da_alloc,discard 0 0\n/dev/block/platform/emmc/by-name/metadata /metadata ext4 rw,seclabel,nosuid,nodev,noatime,nodiratime,user_xattr,barrier=1,noauto_da_alloc,discard 0 0\n/dev/block/platform/emmc/by-name/userdata /data ext4 rw,seclabel,relatime,user_xattr,barrier=1,data=ordered,noauto_da_alloc,discard 0 0\nnone /proc/bus/usb usbfs rw,relatime,devmode=666 0 0\n/sys/kernel/debug /sys/kernel/debug debugfs rw,relatime 0 0\n/dev/fuse /mnt/shell/emulated fuse rw,nosuid,nodev,relatime,user_id=1023,group_id=1023,default_permissions,allow_other 0 0\n/dev/block/vold/179:11 /mnt/internal_sd vfat rw,dirsync,relatime,uid=1000,gid=1015,fmask=0002,dmask=0002,allow_utime=0020,codepage=cp437,iocharset=iso8859-1,shortname=mixed,utf8,errors=remount-ro 0 0\n/dev/block/vold/179:11 /mnt/secure/asec vfat rw,dirsync,relatime,uid=1000,gid=1015,fmask=0002,dmask=0002,allow_utime=0020,codepage=cp437,iocharset=iso8859-1,shortname=mixed,utf8,errors=remount-ro 0 0\n</code></pre>\n\n<hr>\n\n<p>Results of mount command </p>\n\n<p>When i try to run chmod 777 this happens </p>\n\n<pre><code>so am using chmod 777 rsync on the terminal\n1|root@rk3188:/data/data/com.ankit.sync/execute # chmod 777 rsync \nand the result is\nroot@rk3188:/data/data/com.ankit.sync/execute # ./rsync               \nCANNOT LINK EXECUTABLE: cannot locate symbol \"sigemptyset\" referenced by \"./rsync\"...\n</code></pre>\n"}, {"tags": ["c", "pointers", "memory-leaks", "dynamic-memory-allocation"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 3, "creation_date": 1469012739, "post_id": 38479492, "comment_id": 64361151, "body": "why there are <code>free(pair-&gt;key);   free(pair-&gt;count);</code> after the malloc?"}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1469012839, "post_id": 38479492, "comment_id": 64361211, "body": "^^^^^^ ... which invokes undefined behavior, as those pointers are indeterminate."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1469012984, "post_id": 38479492, "comment_id": 64361300, "body": "@WhozCraig Right sir, converted that to an answer already. :)"}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 1, "creation_date": 1469013034, "post_id": 38479492, "comment_id": 64361342, "body": "@SouravGhosh.. which has already been upticked =)"}, {"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 1, "creation_date": 1469018047, "post_id": 38479492, "comment_id": 64364850, "body": "is there any reason for not making <code>key</code> and <code>count</code> simply <code>int</code>s ?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1469020881, "post_id": 38479492, "comment_id": 64367081, "body": "As far as I can tell, you&#39;re making a great deal of trouble for yourself by making <code>pair_t.key</code> and <code>pair_t.count</code> be pointers.  You don&#39;t seem to be doing anything with them that benefits from the indirection, yet you need to do extra work to manage the associated memory."}], "answers": [{"comments": [{"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1469013769, "post_id": 38479587, "comment_id": 64361845, "body": "&quot;The variable <code>temp</code> remains allocated&quot; is <b><i>wrong</i></b>. The <i>node</i> remains allocated. This has nothing to do with variables."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1469014142, "post_id": 38479587, "comment_id": 64362097, "body": "@immibis I mentioned that in the context of the complete sentence. Why you are quoting only half of it?"}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 5, "last_activity_date": 1469012886, "creation_date": 1469012886, "answer_id": 38479587, "question_id": 38479492, "link": "https://stackoverflow.com/questions/38479492/memory-leak-because-of-seemingly-necessary-malloc-repetition/38479587#38479587", "title": "Memory leak because of seemingly necessary malloc repetition", "body": "<p>First of all, remove</p>\n\n<pre><code>free(pair-&gt;key);\nfree(pair-&gt;count);\n</code></pre>\n\n<p>after <code>malloc()</code>, as calling <code>free()</code> on the pointers not returned by memory management functions invokes <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\">undefined behavior</a>.</p>\n\n<p>That said, in the beginning, you <code>malloc()</code>-ed for the original variable and the members, and in the end, you are freeing only the pointer members <code>key</code> and <code>count</code> of the structure variable, but the actual variable <code>temp</code> remains allocated. This is what causing the leak.</p>\n\n<p>You have to free the <code>temp</code>, too.</p>\n"}, {"tags": [], "owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "is_accepted": false, "score": 2, "last_activity_date": 1469013578, "creation_date": 1469013578, "answer_id": 38479837, "question_id": 38479492, "link": "https://stackoverflow.com/questions/38479492/memory-leak-because-of-seemingly-necessary-malloc-repetition/38479837#38479837", "title": "Memory leak because of seemingly necessary malloc repetition", "body": "<blockquote>\n  <p>... i am left with memory that has not been freed at the end of the program. how can i fix this?</p>\n</blockquote>\n\n<p>You'll have to make a copy of <code>temp</code> before moving on to the next element and then free the element after you have moved <code>temp</code>to the next element.</p>\n\n<pre><code>pair_t *temp2 = temp;   // Add this before\ntemp = temp-&gt;next;\nfree(temp2);            // Add this after\n</code></pre>\n\n<p>Also see the answer from Sourav Ghosh about removing the illegal calls to <code>free</code></p>\n"}], "owner": {"reputation": 41, "user_id": 6612852, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8d3RRBOWPt0/AAAAAAAAAAI/AAAAAAAAAAA/vf0WtdzXDsY/photo.jpg?sz=128", "display_name": "dirtyb", "link": "https://stackoverflow.com/users/6612852/dirtyb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1469013578, "creation_date": 1469012621, "last_edit_date": 1469013201, "question_id": 38479492, "link": "https://stackoverflow.com/questions/38479492/memory-leak-because-of-seemingly-necessary-malloc-repetition", "title": "Memory leak because of seemingly necessary malloc repetition", "body": "<p>I have the following structures:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>typedef struct pair {\n  int *key;                // search key for this item\n  int *count;                  // pointer to data for this item\n  struct pair *next;   // children\n} pair_t;\n\ntypedef struct counters {\n  struct pair *head;\n} counters_t;\n</code></pre>\n\n<p>I have the following function:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>static pair_t * // not visible outside this file\npair_new(const int key)\n{\n\n  pair_t *pair = malloc(sizeof(pair_t));\n\n  free(pair-&gt;key);\n  free(pair-&gt;count);\n\n  if (pair == NULL) {\n    // error allocating memory for pair; return error\n    return NULL;\n  } else {\n\n      pair-&gt;key = malloc(sizeof(int));\n      pair-&gt;count = malloc(sizeof(int));\n\n      *(pair-&gt;key) = key;\n      *(pair-&gt;count) = 1;\n      pair-&gt;next = NULL;\n      return pair;\n\n  }\n}\n</code></pre>\n\n<p>notice that I allocate for a pair at first, check if the memory was properly allocated, and then if so I assign values to the elements of the instance of pair. In order to assign values to these elements (key and count) I have to allocate memory for them (the elements). Later on in my main program I call the delete function:</p>\n\n<p>(ctrs is a linked list of pairs)</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>void counters_delete(counters_t *ctrs){\n  if(ctrs!=NULL){\n    pair_t *temp = ctrs-&gt;head;\n    while(temp!=NULL){\n      printf(\"freeing for key %d\\n\",*(temp-&gt;key));\n      free(temp-&gt;count);\n      free(temp-&gt;key);\n      temp = temp-&gt;next;\n    }\n    ctrs-&gt;head=NULL;\n  }\n  return;\n}\n</code></pre>\n\n<p>in which i free each pair's key and count. </p>\n\n<p>because i allocated for the full size of a pair and then allocated again for the elements for each pair, i am left with memory that has not been freed at the end of the program. how can i fix this?</p>\n"}, {"tags": ["c", "unit-testing", "mmap", "device-driver", "userspace"], "comments": [{"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "edited": false, "score": 0, "creation_date": 1469012374, "post_id": 38479292, "comment_id": 64360917, "body": "Linux, presumably? Considering you&#39;re not going to hook into Apple or Windows kernel drivers."}, {"owner": {"reputation": 90851, "user_id": 27009, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/f0a29af415477aa8c498a4f41ffe6640?s=128&d=identicon&r=PG", "display_name": "Kornel", "link": "https://stackoverflow.com/users/27009/kornel"}, "edited": false, "score": 0, "creation_date": 1469012397, "post_id": 38479292, "comment_id": 64360935, "body": "mmap a FUSE-filesystem file maybe?"}, {"owner": {"reputation": 7630, "user_id": 709852, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/bf402f309d40d607a369395e32a984fc?s=128&d=identicon&r=PG", "display_name": "Henry Gomersall", "link": "https://stackoverflow.com/users/709852/henry-gomersall"}, "reply_to_user": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "edited": false, "score": 0, "creation_date": 1469012474, "post_id": 38479292, "comment_id": 64360970, "body": "@MSalters yes, Linux - apologies (I&#39;ve just edited in the info in)."}], "answers": [{"comments": [{"owner": {"reputation": 7630, "user_id": 709852, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/bf402f309d40d607a369395e32a984fc?s=128&d=identicon&r=PG", "display_name": "Henry Gomersall", "link": "https://stackoverflow.com/users/709852/henry-gomersall"}, "edited": false, "score": 0, "creation_date": 1469012859, "post_id": 38479460, "comment_id": 64361224, "body": "I assume in this case the mockery happens in the custom FUSE filesystem?"}, {"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "reply_to_user": {"reputation": 7630, "user_id": 709852, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/bf402f309d40d607a369395e32a984fc?s=128&d=identicon&r=PG", "display_name": "Henry Gomersall", "link": "https://stackoverflow.com/users/709852/henry-gomersall"}, "edited": false, "score": 0, "creation_date": 1469013453, "post_id": 38479460, "comment_id": 64361633, "body": "Yup, it gets told by the kernel that a page in the page cache is dirty (written to). The FUSE filesystem driver has to calculate a diff to see what changed. When it indicates the write succeeded, the kernel clears the dirty bit in the page cache again, Obvious warning: re-reading the same memory address will give the same results; there&#39;s no equivalent to <code>volatile</code> for FUSE files."}, {"owner": {"reputation": 7630, "user_id": 709852, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/bf402f309d40d607a369395e32a984fc?s=128&d=identicon&r=PG", "display_name": "Henry Gomersall", "link": "https://stackoverflow.com/users/709852/henry-gomersall"}, "edited": false, "score": 0, "creation_date": 1469014882, "post_id": 38479460, "comment_id": 64362599, "body": "I don&#39;t fully understand your point about <code>volatile</code>. Does this mean that the OS will cache what is written even though the accessing code has defined the memory to be <code>volatile</code>? Doesn&#39;t this make the approach rather useless?"}, {"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "reply_to_user": {"reputation": 7630, "user_id": 709852, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/bf402f309d40d607a369395e32a984fc?s=128&d=identicon&r=PG", "display_name": "Henry Gomersall", "link": "https://stackoverflow.com/users/709852/henry-gomersall"}, "edited": false, "score": 0, "creation_date": 1469015183, "post_id": 38479460, "comment_id": 64362794, "body": "<code>volatile</code> also means that repeated reads aren&#39;t cached. This can be an issue for e.g. status registers of a device. Reasonable device drivers may have a <code>while (! *data_avail) { &#47;*spin*&#47; }</code> loop. The <code>data_avail</code> pointer would be <code>volatile</code>, which means the compiler will emit a real memory read which then gets the value from a memory-mapped device register.  But in the mocked situation, only the first read will trigger a full-page FUSE read. The second memory read will find the page already mapped in, so FUSE doesn&#39;t call your driver. It thinks the data is still there."}, {"owner": {"reputation": 7630, "user_id": 709852, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/bf402f309d40d607a369395e32a984fc?s=128&d=identicon&r=PG", "display_name": "Henry Gomersall", "link": "https://stackoverflow.com/users/709852/henry-gomersall"}, "edited": false, "score": 0, "creation_date": 1469015515, "post_id": 38479460, "comment_id": 64363026, "body": "Ah, it seems <code>direct_io</code> might be the option that purports to address this issue..."}], "tags": [], "owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "is_accepted": false, "score": 2, "last_activity_date": 1469013229, "last_edit_date": 1469013229, "creation_date": 1469012525, "answer_id": 38479460, "question_id": 38479292, "link": "https://stackoverflow.com/questions/38479292/mocking-a-memory-mapped-device-in-c-in-userspace/38479460#38479460", "title": "Mocking a memory mapped device in C in userspace", "body": "<p>Considering it's a Linux system, you can implement a very simple FUSE filesystem with just one file on it. The kernel can handle it from there.</p>\n\n<p>The main issue is that you can expect the kernel to not flush every write. There's a <code>msync()</code> call to flush all outstanding writes, though, but your System Under Test isn't going to call that. However, I think you can get away with opening the file descriptor using <code>O_DIRECT | O_DSYNC</code> </p>\n"}], "owner": {"reputation": 7630, "user_id": 709852, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/bf402f309d40d607a369395e32a984fc?s=128&d=identicon&r=PG", "display_name": "Henry Gomersall", "link": "https://stackoverflow.com/users/709852/henry-gomersall"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 517, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1469013229, "creation_date": 1469012074, "last_edit_date": 1469012445, "question_id": 38479292, "link": "https://stackoverflow.com/questions/38479292/mocking-a-memory-mapped-device-in-c-in-userspace", "title": "Mocking a memory mapped device in C in userspace", "body": "<p>I wish to mock a memory mapped device in C in order to do effective unit testing of a device wrapping library (in Linux).</p>\n\n<p>Now, I know I can <code>mmap</code> a file descriptor into userspace which could in principle represent a mock of said device.</p>\n\n<p>So, AFAICT, my question comes down to this: Is it possible in userspace to create a file descriptor on which <code>mmap</code> can act, with the reading and writing being handled by suitable callbacks?</p>\n\n<p>Alternatively, perhaps this is a solved problem and there is a known kernel driver that can be hooked into?</p>\n"}, {"tags": ["c", "pointers", "constants"], "comments": [{"owner": {"reputation": 1884, "user_id": 3078414, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b1180f5e68d3542488d66de14ff53964?s=128&d=identicon&r=PG&f=1", "display_name": "user3078414", "link": "https://stackoverflow.com/users/3078414/user3078414"}, "edited": false, "score": 0, "creation_date": 1469012521, "post_id": 38479262, "comment_id": 64361001, "body": "Can you please be more precise about <i>&quot;Is there any way in C, to get an error for the NO_ERROR line&quot;</i>? Do you ask if <code>ptr-&gt;var = NULL</code> may cause undefined behavior?"}], "answers": [{"tags": [], "owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "is_accepted": false, "score": 2, "last_activity_date": 1469012481, "creation_date": 1469012481, "answer_id": 38479443, "question_id": 38479262, "link": "https://stackoverflow.com/questions/38479262/how-to-control-struct-member-behavior-with-struct-const-pointer-as-function-para/38479443#38479443", "title": "how to control struct member behavior with struct const pointer as function parameter?", "body": "<p>Just declare the parameter with const, so the <code>ptr</code> is a pointer to a const object:</p>\n\n<pre><code>void fun(const struct st* ptr)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7617, "user_id": 2878070, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/42b5fba5761d7e519d05b642be0b2e14?s=128&d=identicon&r=PG&f=1", "display_name": "Sergio", "link": "https://stackoverflow.com/users/2878070/sergio"}, "is_accepted": false, "score": 0, "last_activity_date": 1469012617, "creation_date": 1469012617, "answer_id": 38479491, "question_id": 38479262, "link": "https://stackoverflow.com/questions/38479262/how-to-control-struct-member-behavior-with-struct-const-pointer-as-function-para/38479491#38479491", "title": "how to control struct member behavior with struct const pointer as function parameter?", "body": "<p>Your declaration makes <code>ptr</code> to be constant, but not the object to which it points. Also don't miss <code>struct</code> keyword</p>\n\n<pre><code>void fun(struct st *const ptr);\n</code></pre>\n\n<p>Instead you should use</p>\n\n<pre><code>void fun(const struct st *ptr);\n</code></pre>\n\n<p>Such declaration allows to change pointer but not the object to which it points.</p>\n"}, {"tags": [], "owner": {"reputation": 27385, "user_id": 1382251, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/17622c39e8ead537a0944c767551b2fe?s=128&d=identicon&r=PG", "display_name": "barak manos", "link": "https://stackoverflow.com/users/1382251/barak-manos"}, "is_accepted": false, "score": 0, "last_activity_date": 1469013997, "last_edit_date": 1469013997, "creation_date": 1469013191, "answer_id": 38479690, "question_id": 38479262, "link": "https://stackoverflow.com/questions/38479262/how-to-control-struct-member-behavior-with-struct-const-pointer-as-function-para/38479690#38479690", "title": "how to control struct member behavior with struct const pointer as function parameter?", "body": "<p>Keep this in mind:</p>\n\n<ul>\n<li>With <code>type* const ptr</code>, you cannot change the pointer but you can change the pointed data</li>\n<li>With <code>const type* ptr</code>, you can change the pointer but you cannot change the pointed data</li>\n</ul>\n\n<p>So all you need is to replace <code>struct st* const ptr</code> with <code>const struct st* ptr</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 19, "user_id": 6613229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8db72fb237cf0c32099b30a580f00034?s=128&d=identicon&r=PG&f=1", "display_name": "isarma", "link": "https://stackoverflow.com/users/6613229/isarma"}, "is_accepted": false, "score": 0, "last_activity_date": 1469029849, "creation_date": 1469029849, "answer_id": 38485195, "question_id": 38479262, "link": "https://stackoverflow.com/questions/38479262/how-to-control-struct-member-behavior-with-struct-const-pointer-as-function-para/38485195#38485195", "title": "how to control struct member behavior with struct const pointer as function parameter?", "body": "<p>Superb! Thank you so much guys! \nI did this - \nvoid fun(const struct st *const ptr);\nand I was able to get an error while changing both ptr and ptr->var .. Just what I needed..</p>\n"}], "owner": {"reputation": 19, "user_id": 6613229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8db72fb237cf0c32099b30a580f00034?s=128&d=identicon&r=PG&f=1", "display_name": "isarma", "link": "https://stackoverflow.com/users/6613229/isarma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "answer_count": 4, "score": 1, "last_activity_date": 1469029849, "creation_date": 1469012004, "last_edit_date": 1469014417, "question_id": 38479262, "link": "https://stackoverflow.com/questions/38479262/how-to-control-struct-member-behavior-with-struct-const-pointer-as-function-para", "title": "how to control struct member behavior with struct const pointer as function parameter?", "body": "<p>I have a C code, somewhat similar to this:</p>\n\n<pre><code>struct st\n{\n    int *var;\n}\n\nvoid fun(st *const ptr)\n{\n    // considering memory for struct is already initialized properly.\n    ptr-&gt;var = NULL; // NO_ERROR\n    ptr = NULL; // ERROR, since its a const pointer.\n}\n\nvoid main()\n{ \n    //considering memory for struct is initialized properly\n    fun(ptr);\n}\n</code></pre>\n\n<p>I dont want to declare <code>int *var</code> as <code>const</code> in the structure definition, so as not to mess with the huge code base. Not looking to make any change in the structure definition\nIs there any way in C, to get an error for the <code>NO_ERROR</code> line\n<code>ptr-&gt;var = NULL; // NO_ERROR</code> ?</p>\n"}, {"tags": ["c", "arrays", "pointers", "static"], "comments": [{"owner": {"reputation": 7617, "user_id": 2878070, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/42b5fba5761d7e519d05b642be0b2e14?s=128&d=identicon&r=PG&f=1", "display_name": "Sergio", "link": "https://stackoverflow.com/users/2878070/sergio"}, "edited": false, "score": 3, "creation_date": 1469011588, "post_id": 38479107, "comment_id": 64360389, "body": "Yes, returning of local static object address is OK. But it is the same object for each call to the same function. And different if functions are different."}, {"owner": {"reputation": 2037, "user_id": 1468415, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/wx7N9.png?s=128&g=1", "display_name": "mvidelgauz", "link": "https://stackoverflow.com/users/1468415/mvidelgauz"}, "reply_to_user": {"reputation": 7617, "user_id": 2878070, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/42b5fba5761d7e519d05b642be0b2e14?s=128&d=identicon&r=PG&f=1", "display_name": "Sergio", "link": "https://stackoverflow.com/users/2878070/sergio"}, "edited": false, "score": 1, "creation_date": 1469011687, "post_id": 38479107, "comment_id": 64360454, "body": "@Serhio That&#39;s not what question is about. OP wants to return <b>new</b> array from <b>each invocation of a function</b>"}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 2, "creation_date": 1469011805, "post_id": 38479107, "comment_id": 64360533, "body": "No, there isn&#39;t. Objects with static storage are placed into a special memory section by the compiler. So they must all be known at build time."}, {"owner": {"reputation": 2037, "user_id": 1468415, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/wx7N9.png?s=128&g=1", "display_name": "mvidelgauz", "link": "https://stackoverflow.com/users/1468415/mvidelgauz"}, "edited": false, "score": 0, "creation_date": 1469011808, "post_id": 38479107, "comment_id": 64360534, "body": "@machine_1 Can you please describe your <b>actual</b> problem? Why do you want those arrays to be static? Short answer is no, static memory is not allocated at run time"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 1, "creation_date": 1469012973, "post_id": 38479107, "comment_id": 64361294, "body": "You don&#39;t get a <b>new</b> array for each invocation of the function. That is absolutely not what <code>static</code> does. In contrary <code>static</code> ensures it is the same array and that it exists for the whole program execution. So the answer is no."}, {"owner": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "reply_to_user": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1469014516, "post_id": 38479107, "comment_id": 64362345, "body": "@StoryTeller Is memory reserved for them even if i don&#39;t call the function ?"}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1469014665, "post_id": 38479107, "comment_id": 64362452, "body": "@machine_1, of course. Although it won&#39;t be initialized until you do enter."}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1469014744, "post_id": 38479107, "comment_id": 64362513, "body": "And if you are going the good path of dynamic allocations, please have a designated <code>CrArray1Release</code> function, even if it only calls <code>free</code>. It&#39;s good design."}], "answers": [{"tags": [], "owner": {"reputation": 90851, "user_id": 27009, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/f0a29af415477aa8c498a4f41ffe6640?s=128&d=identicon&r=PG", "display_name": "Kornel", "link": "https://stackoverflow.com/users/27009/kornel"}, "is_accepted": true, "score": 1, "last_activity_date": 1469013515, "creation_date": 1469013515, "answer_id": 38479807, "question_id": 38479107, "link": "https://stackoverflow.com/questions/38479107/can-we-return-pointer-to-new-static-array-from-the-same-function/38479807#38479807", "title": "Can we return pointer to new static array from the same function?", "body": "<p>No, <code>static</code> objects <em>by definition</em> have only one instance.</p>\n\n<p>You'll need to use <code>malloc()</code> and callers of your function will need to <code>free()</code> the memory.</p>\n"}, {"tags": [], "owner": {"reputation": 2104, "user_id": 4635537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cad50ed18dff8aaff0ff427ea7b1067d?s=128&d=identicon&r=PG", "display_name": "sameerkn", "link": "https://stackoverflow.com/users/4635537/sameerkn"}, "is_accepted": false, "score": 1, "last_activity_date": 1469015092, "creation_date": 1469015092, "answer_id": 38480401, "question_id": 38479107, "link": "https://stackoverflow.com/questions/38479107/can-we-return-pointer-to-new-static-array-from-the-same-function/38480401#38480401", "title": "Can we return pointer to new static array from the same function?", "body": "<p>If at compile time you know how many times you are going to call the function then following can be used:</p>\n\n<pre><code>#define NUMBER_OF_TIMES_FUNCTION_WILL_BE_CALLED 10\nchar *CrArray1(void)\n{\n    static int i = -1;\n    static char Array[NUMBER_OF_TIMES_FUNCTION_WILL_BE_CALLED][128];\n    ++i;\n    return Array[i];\n}\n</code></pre>\n\n<p>Note: <code>NUMBER_OF_TIMES_FUNCTION_WILL_BE_CALLED</code> has to be a reasonable number.</p>\n"}, {"tags": [], "owner": {"reputation": 329, "user_id": 4168837, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-b438yjiD4qs/AAAAAAAAAAI/AAAAAAAAAA8/spnTKZFwcLw/photo.jpg?sz=128", "display_name": "Jesse Chen", "link": "https://stackoverflow.com/users/4168837/jesse-chen"}, "is_accepted": false, "score": 0, "last_activity_date": 1469186718, "last_edit_date": 1495541685, "creation_date": 1469186718, "answer_id": 38525250, "question_id": 38479107, "link": "https://stackoverflow.com/questions/38479107/can-we-return-pointer-to-new-static-array-from-the-same-function/38525250#38525250", "title": "Can we return pointer to new static array from the same function?", "body": "<p>No, we can't.</p>\n\n<p>wikipedia:</p>\n\n<blockquote>\n  <p>static is used to store the variable in the statically allocated memory instead of the automatically allocated memory.</p>\n</blockquote>\n\n<p>so if you add after <code>q1</code>:</p>\n\n<pre><code>char *q2 = CrArray2();\nstrcpy(q2, \"Another String\");\n</code></pre>\n\n<p>and print <code>q2</code>, you will get:</p>\n\n<p><code>\n   p1 is : Hello, World\n   q1 is : Another String\n   q2 is : Another String\n</code></p>\n\n<p>That means the <code>local static</code> variable still points to the same memory.\nSo the result is not we want. </p>\n\n<p>But if you use the <code>malloc</code> to require a new memory in function. Each time the pointer that function returned will point to different memory. so there is no influence of those variables. </p>\n\n<p>More about <code>static</code> you can refer <a href=\"https://stackoverflow.com/a/572550/4168837\">what does static means in a C program</a></p>\n"}], "owner": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 148, "favorite_count": 0, "accepted_answer_id": 38479807, "answer_count": 3, "score": 3, "last_activity_date": 1469186718, "creation_date": 1469011533, "question_id": 38479107, "link": "https://stackoverflow.com/questions/38479107/can-we-return-pointer-to-new-static-array-from-the-same-function", "title": "Can we return pointer to new static array from the same function?", "body": "<p>Is there a way to return a new array allocated with the static keyword after each invocation of a function? I can create a new array if i make a clone to the function, but not from the same function.</p>\n\n<p>Consider the following program:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nchar *CrArray1(void);\nchar *CrArray2(void);\n\nint main(void)\n{\n    char *p1 = CrArray1();\n    strcpy(p1, \"Hello, \");\n\n    char *p2 = CrArray1();\n    strcat(p2, \"World\");\n\n    char *q1 = CrArray2();\n    strcpy(q1, \"Different String\");\n\n    printf(\"p1 is : %s\\n\", p1);\n    printf(\"q1 is : %s\\n\", q1);\n\n    return 0;\n}\n\nchar *CrArray1(void)\n{\n    static char Array[128];\n    return Array;\n}\n\nchar *CrArray2(void)\n{\n    static char Array[128];\n    return Array;\n}\n</code></pre>\n"}, {"tags": ["c", "fork"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1469011960, "post_id": 38478930, "comment_id": 64360631, "body": "I think you may find your output a bit different if you flush the stdout line buffer with each call. It should contain, one 1, two 2&#39;s, and four 3&#39;s."}, {"owner": {"reputation": 4593, "user_id": 105104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02b23920ac852e946b333d3f9d0d95c1?s=128&d=identicon&r=PG", "display_name": "dvhh", "link": "https://stackoverflow.com/users/105104/dvhh"}, "edited": false, "score": 0, "creation_date": 1469012790, "post_id": 38478930, "comment_id": 64361181, "body": "output buffering is involved"}], "answers": [{"tags": [], "owner": {"reputation": 221, "user_id": 5362973, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/f400Y.jpg?s=128&g=1", "display_name": "kishor", "link": "https://stackoverflow.com/users/5362973/kishor"}, "is_accepted": false, "score": 1, "last_activity_date": 1469011877, "creation_date": 1469011877, "answer_id": 38479225, "question_id": 38478930, "link": "https://stackoverflow.com/questions/38478930/confusing-behaviour-of-fork-system-call-in-c/38479225#38479225", "title": "confusing behaviour of fork() system call in c", "body": "<p>It will print like that<br>\n1  2  3  1  2  3  1  2  3  1  2  3  1  2  3  1  2  3  1  2  3  1  2  3<br>\nbecause 1 time for parent and 1 time for child.\nFork() :- for parent and child.</p>\n\n<p>So loop is rotating 4 times thats </p>\n\n<p>1 2 3   for parent 1 2 3 for child</p>\n\n<p>2(Parent and child)  * 4(Loop rotate) =  it will print 8 times (1 2 3)</p>\n"}, {"tags": [], "owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "is_accepted": true, "score": 2, "last_activity_date": 1469012393, "creation_date": 1469012393, "answer_id": 38479414, "question_id": 38478930, "link": "https://stackoverflow.com/questions/38478930/confusing-behaviour-of-fork-system-call-in-c/38479414#38479414", "title": "confusing behaviour of fork() system call in c", "body": "<p>First, your expectations are wrong, you will get more than just 3's output. Second, your <code>stdout</code> line buffer is retained when you fork, and thus will copy previously <code>printf</code>-ed content to the forked processes as part of the process duplicate. A modified version of your program below:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\nint main()\n{\n    int i;\n    for(i=1;i&lt;=3;++i)\n    {\n        printf(\"%d \", i);\n        fflush(stdout);\n        fork();\n    }\n}\n</code></pre>\n\n<p>will produce output <em>similar</em> to the following:</p>\n\n<pre><code>1 2 3 2 3 3 3 \n</code></pre>\n\n<p>The added flush empties the current-process' stdout line prior to the fork, thereby eliminating replicated output. The order may be slightly different, but will always start with <code>1</code>, end with <code>3</code>, Further, any <code>1</code> will always be followed by at least one <code>2</code>, and any <code>2</code> always followed by at least one <code>3</code></p>\n"}, {"tags": [], "owner": {"reputation": 182, "user_id": 6559553, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-uLVbM4t-pDI/AAAAAAAAAAI/AAAAAAAAAGE/0_yj2sLVOpc/photo.jpg?sz=128", "display_name": "Govind Madhu", "link": "https://stackoverflow.com/users/6559553/govind-madhu"}, "is_accepted": false, "score": 1, "last_activity_date": 1469012685, "last_edit_date": 1495542756, "creation_date": 1469012685, "answer_id": 38479517, "question_id": 38478930, "link": "https://stackoverflow.com/questions/38478930/confusing-behaviour-of-fork-system-call-in-c/38479517#38479517", "title": "confusing behaviour of fork() system call in c", "body": "<p>This questions has been asked before. You can find the similar question here.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/26793402/visually-what-happens-to-fork-in-a-for-loop\">Visually what happens to fork() in a For Loop</a></p>\n\n<p>I hope that helps^^</p>\n"}, {"tags": [], "owner": {"reputation": 4593, "user_id": 105104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02b23920ac852e946b333d3f9d0d95c1?s=128&d=identicon&r=PG", "display_name": "dvhh", "link": "https://stackoverflow.com/users/105104/dvhh"}, "is_accepted": false, "score": 1, "last_activity_date": 1469013228, "creation_date": 1469013228, "answer_id": 38479708, "question_id": 38478930, "link": "https://stackoverflow.com/questions/38478930/confusing-behaviour-of-fork-system-call-in-c/38479708#38479708", "title": "confusing behaviour of fork() system call in c", "body": "<p>because <code>stdout</code> output is buffered by default, forking the process will cause to  duplicate the buffer and when each process is finished each buffer will be flushed.</p>\n\n<p>using :</p>\n\n<pre><code>fprintf(stderr,\" %d \",i);\n</code></pre>\n\n<p>will make the program output :</p>\n\n<pre><code>1 2 2 3 3 3 3\n</code></pre>\n\n<p>because you are making the printf statement in the loop ( from 1 to 3 )</p>\n\n<p>the following statement would help you trace the output :</p>\n\n<pre><code>fprintf(stderr,\" %d:%d \",i,getpid());\n</code></pre>\n\n<p>which will output (example) :</p>\n\n<pre><code>1:24100  2:24100  2:24101  3:24100  3:24102  3:24101  3:24103\n</code></pre>\n"}], "owner": {"reputation": 357, "user_id": 4645774, "user_type": "registered", "accept_rate": 38, "profile_image": "https://lh6.googleusercontent.com/-d3Smk0ZUcoY/AAAAAAAAAAI/AAAAAAAAACQ/o9zz_Eket9o/photo.jpg?sz=128", "display_name": "Gadheyan .t.s", "link": "https://stackoverflow.com/users/4645774/gadheyan-t-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 171, "favorite_count": 0, "accepted_answer_id": 38479414, "answer_count": 4, "score": 0, "last_activity_date": 1469013228, "creation_date": 1469010982, "question_id": 38478930, "link": "https://stackoverflow.com/questions/38478930/confusing-behaviour-of-fork-system-call-in-c", "title": "confusing behaviour of fork() system call in c", "body": "<p>I was checking behaviour of fork system call. I executed the following program.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\nint count=0;\nint main()\n{\nint i;\nint n=3;\nfor(i=1;i&lt;=n;++i)\n{\nprintf(\" %d \",i);\nfork();\n} \n}\n</code></pre>\n\n<p>I had a thought that having <code>fork()</code> inside a <code>for loop</code> is similar to writing it in series i.e.</p>\n\n<pre><code>for(i=1;i&lt;=3;i++)\n   fork();\n</code></pre>\n\n<p>is similar to</p>\n\n<pre><code>fork();\nfork();\nfork();\n</code></pre>\n\n<p>I tried to draw a recursion tree for the same\n<a href=\"https://i.stack.imgur.com/L7pqI.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/L7pqI.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>I expected the output to be eight consecutive 3's. But output was following:</p>\n\n<pre><code> 1  2  3  1  2  3  1  2  3  1  2  3  1  2  3  1  2  3  1  2  3  1  2  3\n</code></pre>\n\n<p>Note:compiled and executed in gcc</p>\n"}, {"tags": ["c", "winapi", "usb", "usb-drive"], "comments": [{"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1469011045, "post_id": 38478645, "comment_id": 64360077, "body": "<i>&quot;I&#39;d prefer to have the application wait for all USB devices&quot;</i> - That&#39;d require that you provide a concise specification for what <i>&quot;all USB devices&quot;</i> encompasses. Since USB devices can support hot-plugging, this is pretty hard to specify. Also, your 1:1 mapping between USB drives and drive letters is flawed. A USB device can have zero or more drive letters assigned. And drive letters are assigned per user. So dealing with drive letters in a service is fairly meaningless. (Assuming that you are writing a service, since you talk about boot-time initialization.)"}, {"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "reply_to_user": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1469013883, "post_id": 38478645, "comment_id": 64361916, "body": "@IInspectable: Actually, drive letters are a union of systemwide assignments (local disks) and per-session assignments (remote shares, using user credentials). The USB disk is local. But there&#39;s some minor magic IIRC to avoid picking a letter that&#39;s already in use for a remote share."}, {"owner": {"reputation": 3420, "user_id": 1530134, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/d6b1b610a6302fd94ff9f8971a4f1899?s=128&d=identicon&r=PG", "display_name": "Alyssa Haroldsen", "link": "https://stackoverflow.com/users/1530134/alyssa-haroldsen"}, "reply_to_user": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1469014756, "post_id": 38478645, "comment_id": 64362524, "body": "@IInspectable Assume only &quot;removable&quot; volumes are enumerated, regardless of whether it has a drive letter. They still can&#39;t be accessed by Volume GUID. The drives also contain exactly one full-disk NTFS partition."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1469015040, "post_id": 38478645, "comment_id": 64362705, "body": "As I said, you need a <b>concise</b> specification. Repeating <i>&quot;all&quot;</i> doesn&#39;t explain much, as hot-plugging makes availability a function over time."}, {"owner": {"reputation": 3420, "user_id": 1530134, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/d6b1b610a6302fd94ff9f8971a4f1899?s=128&d=identicon&r=PG", "display_name": "Alyssa Haroldsen", "link": "https://stackoverflow.com/users/1530134/alyssa-haroldsen"}, "edited": false, "score": 0, "creation_date": 1469015616, "post_id": 38478645, "comment_id": 64363098, "body": "I&#39;m asking for the API equivalent of detecting if the &quot;Drive Software Installation&quot; in the notification area is currently showing any currently loading devices, and to receive a notification when the devices currently listed there are available to use (which is when the drive letter appears), or if the devices are disconnected. I&#39;m not sure of a precise (and concise) definition that would explain what I need. I want to know if there are USB mass storage devices attached but not finished loading, and to be notified when a volume might be available (or the drive is disconnected)."}, {"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "edited": false, "score": 0, "creation_date": 1469015876, "post_id": 38478645, "comment_id": 64363306, "body": "@Kupiakos: &quot;contain exactly one full-disk NTFS partition&quot; is not something that Windows will know up front. It will discover these things only in steps. In fact, I bet your drive won&#39;t contain a partition at all - USB drives usually aren&#39;t partitioned. It most likely just contains a single NTFS filesystem. Minor details, sure, but Windows has to deal with all such things. The NTFS driver needs to know whether to start at absolute 0, or at the first data block inside the first partition. And without a partition table, how does Windows even know it&#39;s an NTFS system? Trial and error, IIRC."}, {"owner": {"reputation": 3420, "user_id": 1530134, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/d6b1b610a6302fd94ff9f8971a4f1899?s=128&d=identicon&r=PG", "display_name": "Alyssa Haroldsen", "link": "https://stackoverflow.com/users/1530134/alyssa-haroldsen"}, "reply_to_user": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "edited": false, "score": 0, "creation_date": 1469016305, "post_id": 38478645, "comment_id": 64363609, "body": "@MSalters I&#39;m saying I know for a fact that the drives that will be connected are guaranteed to have an MBR partition table with one full-disk NTFS-formatted partition. I&#39;m not asking when Windows finds this out (although to be honest, I&#39;ve never once seen a non-partitioned USB disk). I want to know when the drive will be fully available for its intended use and any associated volumes ready to be accessed. This is a controlled, specialized scenario."}], "answers": [{"comments": [{"owner": {"reputation": 3420, "user_id": 1530134, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/d6b1b610a6302fd94ff9f8971a4f1899?s=128&d=identicon&r=PG", "display_name": "Alyssa Haroldsen", "link": "https://stackoverflow.com/users/1530134/alyssa-haroldsen"}, "edited": false, "score": 0, "creation_date": 1469015701, "post_id": 38480289, "comment_id": 64363179, "body": "I suppose I&#39;m asking for the API equivalent of detecting if the &quot;Drive Software Installation&quot; in the notification area is currently showing any currently loading devices, and to receive a notification when the devices currently listed there are available to use (which is when the drive letter appears)."}], "tags": [], "owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "is_accepted": false, "score": 0, "last_activity_date": 1469014746, "creation_date": 1469014746, "answer_id": 38480289, "question_id": 38478645, "link": "https://stackoverflow.com/questions/38478645/waiting-for-all-usb-drives-to-load/38480289#38480289", "title": "Waiting for all USB drives to load", "body": "<p>I don't think you can.</p>\n\n<p>The problem is that you're tyring to distinguish two cases which are not actually distinct, that of plugging in a USB device during boot and plugging it in later.</p>\n\n<p>You have to know that USB is a protocol which requires a non-trivial amount of intelligence in the USB slave devices. They exchange multiple messages with the USB host (i.e. your OS). This exchange isn't instant. For instance, your USB harddrive will need to ask for permission to draw more than 100mA power. To answer that, the power drivers of Windows must be up and running. The phsyical disk can only spin up when the answer arrives.</p>\n\n<p>So, there's a whole message sequence going on, and the drive letter shows up only fairly late. Windows must know how many partitions exist. So during this exchange, new devices are being created all the time.</p>\n\n<p>When you enumerate devices <em>while devices are actively being added</em>, you're really asking for troubles. The <code>SetupDiEnumDeviceInterfaces</code> API doesn't operate on a snapshot (which we know because there's no Close method); you're asking for the N'th device until you get an \"no more devices\" error an you know N was to big. But when devices are still actively being added, N changes. And I don't see a guarantee that the list order is by age; devices might be added in the middle as well.</p>\n"}, {"tags": [], "owner": {"reputation": 617, "user_id": 1891584, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99eeade16522a9f93e7c0a19bf476c60?s=128&d=identicon&r=PG", "display_name": "Martin Drab", "link": "https://stackoverflow.com/users/1891584/martin-drab"}, "is_accepted": false, "score": 0, "last_activity_date": 1469029450, "creation_date": 1469029450, "answer_id": 38485053, "question_id": 38478645, "link": "https://stackoverflow.com/questions/38478645/waiting-for-all-usb-drives-to-load/38485053#38485053", "title": "Waiting for all USB drives to load", "body": "<p>I don't think that getting notifications about drivers being installed for newly plugged-in devices would help you much. When you plug in the same device repeatedly, the drivers are usually installed only the first time. </p>\n\n<p>Also, an USB flash drive, although physically looks like one compact device, is represented by at least three PnP devices by Windows: an USB mass storage device (represents the USB endpoint), a disk device (represents the physical disk inside the flash drive) and one or multiple Volume devices (each represents one volume = partition in your case). Drive letters may be assigned to the Volume devices. </p>\n\n<p>What you can possibly do is monitoring the arrival and removal of Volume devices (RegisterDeviceNotification for GUID_DEVINTERFACE_VOLUME) and examining each volume device that arrives (I believe that Setup API allows you to track its \"parents\" to the USB stack). </p>\n"}], "owner": {"reputation": 3420, "user_id": 1530134, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/d6b1b610a6302fd94ff9f8971a4f1899?s=128&d=identicon&r=PG", "display_name": "Alyssa Haroldsen", "link": "https://stackoverflow.com/users/1530134/alyssa-haroldsen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 151, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1469029450, "creation_date": 1469010164, "last_edit_date": 1495542154, "question_id": 38478645, "link": "https://stackoverflow.com/questions/38478645/waiting-for-all-usb-drives-to-load", "title": "Waiting for all USB drives to load", "body": "<p>I'm currently working with an application that has branching logic depending on whether a specific USB drive is inserted into the system. It does this by polling all drive letters looking for a path on the root of each drive.</p>\n\n<p>This works for the majority of machines, but often, this application runs on startup with the USB drive inserted. In addition, some machines are especially slow and take a good minute to load the USB drive once Windows boots. In these machines, the code reaches the check of whether this drive exists, it can't find the drive, and the wrong branch is executed.</p>\n\n<p>It could be possible to wait a minute before checking for drives. I'd prefer to have the application wait for all USB devices (or simply only mass storage devices) to load before checking for the drives, or something even more intelligent.</p>\n\n<p>Unfortunately, I am unfamiliar with the methods needed to wait for all USB devices to finish loading, and with the DDK in general. I can <a href=\"https://stackoverflow.com/q/706352/1530134\" title=\"Use RegisterDeviceNotification&#40;&#41; for ALL USB devices\">see</a> that it's possible to register a window for device notifications with <a href=\"https://msdn.microsoft.com/en-us/library/windows/hardware/ff545972(v=vs.85).aspx\" rel=\"nofollow noreferrer\" title=\"GUID_DEVINTERFACE_USB_DEVICE\"><code>GUID_DEVINTERFACE_USB_DEVICE</code></a>, possibly receiving messages like <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa363205(v=vs.85).aspx\" rel=\"nofollow noreferrer\" title=\"DBT_DEVICEARRIVAL MSDN\"><code>DBT_DEVICEARRIVAL</code></a>, <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa363211(v=vs.85).aspx\" rel=\"nofollow noreferrer\" title=\"DBT_DEVNODES_CHANGED MSDN\"><code>DBT_DEVNODES_CHANGED</code></a>, and <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa363480(v=vs.85).aspx\" rel=\"nofollow noreferrer\" title=\"WM_DEVICECHANGE MSDN\"><code>WM_DEVICECHANGE</code></a>, the distinctions of which I do not know.</p>\n\n<p>However, the USB drive will likely be already inserted and detected (but not having a drive letter) into the system before the program executes. So, registering for all device change notifications would not make sense. If it's possible to identify devices which are inserted but not loaded (possibly with <a href=\"http://www.velleman.eu/images/tmp/usbfind.c\" rel=\"nofollow noreferrer\" title=\"usbfind.c\"><code>SetupDiEnumDeviceInterfaces</code></a>) and then register for \"loaded\" notifications on all of those devices, it might work. I don't have familiarity with any this, so pointers (or sample code) would be extremely helpful.</p>\n"}, {"tags": ["c++", "c", "linker", "libpcap"], "comments": [{"owner": {"reputation": 6899, "user_id": 1212012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gmBY7.png?s=128&g=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1212012/mathieu"}, "edited": false, "score": 0, "creation_date": 1469008587, "post_id": 38477902, "comment_id": 64358474, "body": "What are you trying to do? To build an arm software on a i386 computer?"}], "answers": [{"comments": [{"owner": {"reputation": 115, "user_id": 5556415, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a1c68f45771033f863d6e0f9a205ff24?s=128&d=identicon&r=PG&f=1", "display_name": "kmbm", "link": "https://stackoverflow.com/users/5556415/kmbm"}, "edited": false, "score": 0, "creation_date": 1469009573, "post_id": 38478090, "comment_id": 64359093, "body": "I try to cross compile it but when I use {CC=arm-linux-gcc ac_cv_linux_vers=2 ./configure --host=arm-linux --with-pcap=linux} I get: configure: error: in &#39;/.../libpcap-1.7.4 and C compiler cannot create executables"}, {"owner": {"reputation": 342, "user_id": 5071313, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-VjRd3caK_z8/AAAAAAAAAAI/AAAAAAAAAP8/LXAHpwQOYTA/photo.jpg?sz=128", "display_name": "mhk", "link": "https://stackoverflow.com/users/5071313/mhk"}, "reply_to_user": {"reputation": 115, "user_id": 5556415, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a1c68f45771033f863d6e0f9a205ff24?s=128&d=identicon&r=PG&f=1", "display_name": "kmbm", "link": "https://stackoverflow.com/users/5556415/kmbm"}, "edited": false, "score": 1, "creation_date": 1469009945, "post_id": 38478090, "comment_id": 64359361, "body": "@kmbm in configure log check what C compiler is used... maybe you should add a - to --host=arm-linux... further you should also add build option so that configure not tries to execute binary files... if none of this worked add --with-cc=... and with-ld=... to configure command."}, {"owner": {"reputation": 3067, "user_id": 3876138, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef65cd9182b4e7e297c6eef30b1dae1b?s=128&d=identicon&r=PG", "display_name": "nayana", "link": "https://stackoverflow.com/users/3876138/nayana"}, "reply_to_user": {"reputation": 115, "user_id": 5556415, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a1c68f45771033f863d6e0f9a205ff24?s=128&d=identicon&r=PG&f=1", "display_name": "kmbm", "link": "https://stackoverflow.com/users/5556415/kmbm"}, "edited": false, "score": 0, "creation_date": 1469012803, "post_id": 38478090, "comment_id": 64361191, "body": "@kmbm  agree with mhk .. you need to provide correct name of your gcc binary for arm - not just copy pasting the tutorial I linked.."}, {"owner": {"reputation": 115, "user_id": 5556415, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a1c68f45771033f863d6e0f9a205ff24?s=128&d=identicon&r=PG&f=1", "display_name": "kmbm", "link": "https://stackoverflow.com/users/5556415/kmbm"}, "edited": false, "score": 0, "creation_date": 1469014363, "post_id": 38478090, "comment_id": 64362249, "body": "You are, right. I have changed arm-linux-gcc to arm-linux-gnueabi-gcc and it works. But I have problem with &#39;make&#39;. I get an error &#39;./pcap-linux.c:254:14: conflicting types for socklen_t       /usr/arm-linux-gnueabi/include/unistd.h:275:21: note previous declaration of &#39;socklen_t&#39; was here       I didn&#39;t modify any files."}], "tags": [], "owner": {"reputation": 3067, "user_id": 3876138, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef65cd9182b4e7e297c6eef30b1dae1b?s=128&d=identicon&r=PG", "display_name": "nayana", "link": "https://stackoverflow.com/users/3876138/nayana"}, "is_accepted": false, "score": 3, "last_activity_date": 1469009064, "last_edit_date": 1469009064, "creation_date": 1469008723, "answer_id": 38478090, "question_id": 38477902, "link": "https://stackoverflow.com/questions/38477902/skipping-incompatible-libpcap-so-cross-compilation/38478090#38478090", "title": "Skipping incompatible libpcap.so - cross compilation", "body": "<p>You need to provide libpcap.so built for arm.. </p>\n\n<p>You can check for architecture by calling:</p>\n\n<pre><code>file libpcap.so\n</code></pre>\n\n<p>Output:</p>\n\n<p>/usr/lib/x86_64-linux-gnu/libpcap.so.1.5.3: ELF 64-bit LSB  shared object, <strong>x86-64</strong>, version 1 (SYSV), dynamically linked, BuildID[sha1]=916b377cfe593106dc0b054d63bc4ed0af4ad269, stripped</p>\n\n<p>You can <a href=\"https://emreboy.wordpress.com/2013/03/02/cross-compile-libpcap-source-code/\" rel=\"nofollow\">crosscompile</a> the pcap lib from <a href=\"http://www.tcpdump.org/release/libpcap-1.7.4.tar.gz\" rel=\"nofollow\">here</a></p>\n"}], "owner": {"reputation": 115, "user_id": 5556415, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a1c68f45771033f863d6e0f9a205ff24?s=128&d=identicon&r=PG&f=1", "display_name": "kmbm", "link": "https://stackoverflow.com/users/5556415/kmbm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 736, "favorite_count": 1, "closed_date": 1469044939, "answer_count": 1, "score": 0, "last_activity_date": 1469009064, "creation_date": 1469008279, "question_id": 38477902, "link": "https://stackoverflow.com/questions/38477902/skipping-incompatible-libpcap-so-cross-compilation", "closed_reason": "Needs details or clarity", "title": "Skipping incompatible libpcap.so - cross compilation", "body": "<p>I am trying to link libpcap to my project, but I achive an error </p>\n\n<pre><code>skipping incompatible /usr/lib/i386-linux-gnu/libpcap.so when searching for -lpcap\n</code></pre>\n\n<p>I'm using cross compiler arm linux gcc. </p>\n\n<p>I've found some topics with related problems but i haven't found solution for me.\nHow to link this lib correctly?</p>\n"}, {"tags": ["c", "pointers", "casting", "undefined-behavior"], "answers": [{"comments": [{"owner": {"reputation": 22751, "user_id": 2399879, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UxMS5.jpg?s=128&g=1", "display_name": "Crowman", "link": "https://stackoverflow.com/users/2399879/crowman"}, "reply_to_user": {"reputation": 3686, "user_id": 2510655, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460a7e6ff5c136b73116066c58a4a9eb?s=128&d=identicon&r=PG", "display_name": "Samuel Peter", "link": "https://stackoverflow.com/users/2510655/samuel-peter"}, "edited": false, "score": 0, "creation_date": 1473366122, "post_id": 39335779, "comment_id": 66125185, "body": "@SamuelPeter: Too much information was going into the comments, here, so I instead added some more explanation to my answer. Short response: I did read your answer, and I don&#39;t think it&#39;s right, which is why I wrote a different one. I think your assertion that &quot;there are no alignment requirements for an incomplete type&quot; is erroneous."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1473366886, "post_id": 39335779, "comment_id": 66125536, "body": "&quot;<i>Per C11 6.2.5.22, there are only three kinds of incomplete type</i>&quot; -- That list is not exhaustive. <code>void</code> is also an incomplete type (one that cannot be completed)."}, {"owner": {"reputation": 22751, "user_id": 2399879, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UxMS5.jpg?s=128&g=1", "display_name": "Crowman", "link": "https://stackoverflow.com/users/2399879/crowman"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1473368072, "post_id": 39335779, "comment_id": 66126122, "body": "@KeithThompson : fair comment, I updated the answer, ones that can be substantiated are the only ones were interested in, here, since although you can have a void pointer, you obviously can&#39;t point it at a void object."}], "tags": [], "owner": {"reputation": 22751, "user_id": 2399879, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UxMS5.jpg?s=128&g=1", "display_name": "Crowman", "link": "https://stackoverflow.com/users/2399879/crowman"}, "is_accepted": false, "score": 3, "last_activity_date": 1473368009, "last_edit_date": 1473368009, "creation_date": 1473098987, "answer_id": 39335779, "question_id": 38477854, "link": "https://stackoverflow.com/questions/38477854/does-casting-a-t-pointer-to-a-t-pointer-and-back-yield-the-original-pointer-if/39335779#39335779", "title": "Does casting a T pointer to a T&#39; pointer and back yield the original pointer if T&#39; is an incomplete type?", "body": "<p>I don't think it makes any difference whether or not a type is incomplete. </p>\n\n<p>Per C11 6.2.5.22, there are only three kinds of incomplete type that can be instantiated:</p>\n\n<ol>\n<li>An array type of unknown size</li>\n<li>A structure type of unknown content</li>\n<li>A union type of unknown content</li>\n</ol>\n\n<p>Further, per C11 6.2.5.28:</p>\n\n<blockquote>\n  <p>All pointers to structure types shall have the same representation and\n  alignment requirements as each other. All pointers to union types\n  shall have the same representation and alignment requirements as each\n  other.</p>\n</blockquote>\n\n<p>So the representation and alignment requirements for a pointer to a structure or a union are known, whether the type is complete or not, since you still know it's a pointer to a structure or union of some kind.</p>\n\n<p>For arrays, since we know from C11 6.3.2.1.3 that:</p>\n\n<blockquote>\n  <p>an expression that has type \"array of type\" is converted to an\n  expression with type \"pointer to type\" that points to the initial\n  element of the array object</p>\n</blockquote>\n\n<p>then we can conclude that a pointer to, say, <code>int</code>, and a pointer to an array of <code>int</code> must have the same alignment requirements, because you can use either to refer to the same object. In other words, all pointers to arrays of <code>int</code> have the same alignment requirements, whether the size is known or not.</p>\n\n<p>So if you know you have a pointer to a structure, or if you know you have a pointer to a union, or you know you have a pointer to an array of a specified type, then you know what the alignment requirements are. The fact that the type is incomplete doesn't matter. Indeed, if this were not true, incomplete types would not be useful, because you'd never be able to reliably use pointers to them. </p>\n\n<p>In your case, both <code>undef_t</code> and <code>other_t</code> are <code>typedef</code>d <em>somewhere</em> in your translation unit, so you know what kind of incomplete type you have, and you therefore know the alignment requirements for it, so there is no ambiguity created by the fact the type is incomplete. Of course, if you as the programmer <em>use</em> them without going to the trouble of finding this out for yourself, then you can still run into problems, if for example <code>other_t</code> is a pointer to a union and <code>undef_t</code> is a pointer to a structure. But this is just a normal problem of converting between pointers which may have different alignment requirements - nothing about this problem is made more difficult by one of more of the pointed-to types being incomplete.</p>\n\n<p>EDIT - some further elucidation, based on comments:</p>\n\n<p>A \"pointer to incomplete type\" can only ever point at an object of a complete type, because incomplete types obviously by definition cannot be instantiated (for the sake of brevity, I'm setting aside the possibility of <code>malloc()</code>ing an arbitrary amount of memory and pointing a pointer of incomplete type at it).</p>\n\n<p>Pointers to incomplete types exist for the sake of being able to have and pass around pointers to aggregate and compound types without needing to have the type definition available. In other words, when you don't have enough information to be able to instantiate a particular type, but you do have enough information to be able to point to one. Opaque types work on this basis, where all the actual work is done in functions where the type definition <em>is</em> available, and the code that uses those types only needs to be able to store the address of the object so it can be passed to and from these functions.</p>\n\n<p>In terms of alignment, the representation of a pointer can change depending on the alignment requirements of the object it points to. For instance, as pointed out in the comments, if all <code>int</code>s must be stored on 8-byte boundaries, then a pointer representation could potentially not store the 3 least significant bits, because they'll always be zero. But if you then attempt to convert a <code>char</code> pointer to an <code>int</code> pointer and back, you can lose information, because a <code>char</code> pointer must be able to point to individual bytes, and some of that information would be lost in this hypothetical conversion to <code>int *</code>.</p>\n\n<p>Similarly, it might be case that some small structures could be aligned on, say, 4 byte boundaries, and larger ones on 32 byte boundaries. But the alignment <em>requirements</em> for pointers to structures must all be the same, precisely because of these pointers to incomplete types. At the place where you use a pointer to an incomplete structure type, you don't have the type definition available (if you did, it would be a complete type), and so you don't know whether you can ignore the least significant 5 bits, or only the least significant 3 bits, for example. So the alignment requirements for a pointer to an incomplete structure type have to be sufficiently permissive that they can correctly hold the location of any conceivable structure type. To make passing these around easier, we can see from the above quote that C requires <em>all</em> pointers to structure types to have the same alignment requirements. Some structures might still actually <em>be</em> aligned on 32 byte boundaries, for instance, but a pointer to that structure cannot be permitted to take full advantage of this, and it must be capable of holding the location of any structure type.</p>\n\n<p>But, if all structure types were aligned on no smaller than 4 byte boundaries, for instance, then would be perfectly fine for pointers to structures, including pointers to incomplete structure types, to ignore the least significant 3 bits, because you can do that while still being sure that you can represent the location of any structure safely. Indeed the fact that C requires all pointers to structure types to have the same alignment requirements, and requires all pointers to union types to have the same alignment requirements, but does <em>not</em> require that the alignment requirements for pointers to structure types be the same as alignment requirements for pointers to union types, indicates that it would be possible for, say, pointers to structures to rely on a minimum 4 byte boundary, but for pointers to unions to rely on a minimum 8 byte boundary. In this case, you couldn't safely convert a pointer to an incomplete structure type to a pointer to an incomplete union type and back again.</p>\n\n<p>This is why it's not correct to say, as another answer currently does, that \"there are no alignment requirements for an incomplete type\". But it <em>does</em> mean that incomplete types are not problematic for the original question, because as already explained, when you have an incomplete type, you at least know whether its a structure, or a union, or an array, and that's all you need to have complete knowledge of the alignment requirements.</p>\n"}], "owner": {"reputation": 181, "user_id": 6612747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a4d019a48250a2689611ca78f82d7e6?s=128&d=identicon&r=PG&f=1", "display_name": "J. Doe", "link": "https://stackoverflow.com/users/6612747/j-doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 526, "favorite_count": 4, "answer_count": 1, "score": 18, "last_activity_date": 1473368009, "creation_date": 1469008163, "last_edit_date": 1469009249, "question_id": 38477854, "link": "https://stackoverflow.com/questions/38477854/does-casting-a-t-pointer-to-a-t-pointer-and-back-yield-the-original-pointer-if", "title": "Does casting a T pointer to a T&#39; pointer and back yield the original pointer if T&#39; is an incomplete type?", "body": "<p>Consider the following snippet which is adapted from <a href=\"https://github.com/torproject/tor/blob/master/src/common/aes.c#L89\" rel=\"noreferrer\">the Tor source code</a>:</p>\n\n<pre><code>/* This can be a malloc wrapper with minimal initialization. */\nother_t *make_other(void);\n\n/* This struct is never defined. */\nstruct undef;\ntypedef struct undef undef_t;\n\nundef_t *make_undef(void)\n{\n    other_t *other = make_other();\n    return (undef_t*)other;\n}\n</code></pre>\n\n<p>Assume that all <code>undef_t</code> pointers in the program are casted <code>other_t</code> pointers and assume further that all procedures which take <code>undef_t*</code> cast them to <code>other_t*</code> before use. </p>\n\n<p>According to section 6.3.2.3 of the C99 standard, the cast within the <code>return</code> statement invokes undefined behavior if <code>other</code> is not correctly aligned as a pointer to <code>undef_t</code>, but if it <em>is</em>, casting the result of <code>make_undef</code> back to <code>other_t*</code> yields the original pointer as returned by <code>make_other</code>. However, <code>undef_t</code> is an undefined type, and I cannot find any alignment rules regarding these. Do these conversions still work like they would if <code>undef_t</code> was defined and had the right alignment?</p>\n"}, {"tags": ["c", "makefile"], "comments": [{"owner": {"reputation": 4593, "user_id": 105104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02b23920ac852e946b333d3f9d0d95c1?s=128&d=identicon&r=PG", "display_name": "dvhh", "link": "https://stackoverflow.com/users/105104/dvhh"}, "edited": false, "score": 0, "creation_date": 1469007826, "post_id": 38477510, "comment_id": 64357965, "body": "The way you indicated for executable is fine, usually new header object would modify the the C source that are including them."}, {"owner": {"reputation": 4593, "user_id": 105104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02b23920ac852e946b333d3f9d0d95c1?s=128&d=identicon&r=PG", "display_name": "dvhh", "link": "https://stackoverflow.com/users/105104/dvhh"}, "edited": false, "score": 0, "creation_date": 1469007907, "post_id": 38477510, "comment_id": 64358015, "body": "By the explicit rule for generating the code object file, is also a default GNU Make rule and other Make variant"}, {"owner": {"reputation": 69991, "user_id": 939557, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/3VPea.png?s=128&g=1", "display_name": "MadScientist", "link": "https://stackoverflow.com/users/939557/madscientist"}, "edited": false, "score": 2, "creation_date": 1469021500, "post_id": 38477510, "comment_id": 64367614, "body": "The short answer to your specific question is no, there&#39;s no facility for make to automatically guess the objects it should be including in an executable based on the header files in the source."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1469082274, "post_id": 38477510, "comment_id": 64392905, "body": "actually, just create the &#39;dependency&#39; files, (usually designated with a <code>.d</code> extension) the include them in the <code>%.o:%.c %.d</code> as the first line of the compile rule.   For the linker rule, first create macros, one for each executable, that list the object files used by that executable.  then <code>executable: &amp;(themacro)</code>  and in the recipe use: <code>gcc -o $@ $&gt;</code>  followed by the needed <code>-Llibrarypaths</code> and <code>-llibrarynames</code>.  Then all you need to do is update the <code>themacro</code> contents as files are added/subracted/renamed. one possibility is include all the objects tell the linker to drop all &#39;dead&#39; code"}, {"owner": {"reputation": 86085, "user_id": 128940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d35101b4060dc3af0d5c1b7c42c4935?s=128&d=identicon&r=PG&f=1", "display_name": "Beta", "link": "https://stackoverflow.com/users/128940/beta"}, "edited": false, "score": 0, "creation_date": 1469145556, "post_id": 38477510, "comment_id": 64428969, "body": "There <i>might</i> be a way to do this. Is it the case that every new object file <code>foo.o</code> corresponds to a matching header file <code>foo.h</code>, #included in one of the other sources of the same executable?"}], "answers": [{"comments": [{"owner": {"reputation": 748, "user_id": 6256059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a0ddcf115c1b5f22ab58a4d48260068?s=128&d=identicon&r=PG&f=1", "display_name": "blatinox", "link": "https://stackoverflow.com/users/6256059/blatinox"}, "edited": false, "score": 2, "creation_date": 1469008518, "post_id": 38477841, "comment_id": 64358434, "body": "The OP cannot use wildcard since not all executables need all objects. And it is not a good idea to add a dependency on all headers for each object file. Use cpp option <code>-MD</code> instead."}, {"owner": {"reputation": 2604, "user_id": 93763, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/0398272b3bacf46c360bc7f17bfcc500?s=128&d=identicon&r=PG", "display_name": "GMichael", "link": "https://stackoverflow.com/users/93763/gmichael"}, "reply_to_user": {"reputation": 748, "user_id": 6256059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a0ddcf115c1b5f22ab58a4d48260068?s=128&d=identicon&r=PG&f=1", "display_name": "blatinox", "link": "https://stackoverflow.com/users/6256059/blatinox"}, "edited": false, "score": 0, "creation_date": 1469010134, "post_id": 38477841, "comment_id": 64359488, "body": "@blatinox You are not completely correct. Although not all objects depend on all headers, all objects must be rebuild if relevant headers changed. And then, only the relevant executable will be relinked. <code>-MD</code> is an option but it will make build much more complex. My method is very simple and works well for small projects. At least, I always work in this way"}, {"owner": {"reputation": 748, "user_id": 6256059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a0ddcf115c1b5f22ab58a4d48260068?s=128&d=identicon&r=PG&f=1", "display_name": "blatinox", "link": "https://stackoverflow.com/users/6256059/blatinox"}, "edited": false, "score": 1, "creation_date": 1469015293, "post_id": 38477841, "comment_id": 64362873, "body": "No, when you modify a header, only objects which include that header must be rebuilt. With your solution, you rebuild all objects ! It is useless, even if it works for small projects. Using <code>-MD</code> and other (<code>-MMD</code>, <code>-MP</code>,...) is not complex : you only have to add 3 lines in your Makefile and <code>make</code> and <code>cpp</code> do the job for you."}, {"owner": {"reputation": 2604, "user_id": 93763, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/0398272b3bacf46c360bc7f17bfcc500?s=128&d=identicon&r=PG", "display_name": "GMichael", "link": "https://stackoverflow.com/users/93763/gmichael"}, "reply_to_user": {"reputation": 748, "user_id": 6256059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a0ddcf115c1b5f22ab58a4d48260068?s=128&d=identicon&r=PG&f=1", "display_name": "blatinox", "link": "https://stackoverflow.com/users/6256059/blatinox"}, "edited": false, "score": 1, "creation_date": 1469015608, "post_id": 38477841, "comment_id": 64363087, "body": "It is a question of personal opinion. I prefer a simple makefile and I do not care that sometimes I&#39;m going to spend couple more seconds on compilation. I rarely change header files and this approach is the best for me. Let the OP to decide what is better for him."}], "tags": [], "owner": {"reputation": 2604, "user_id": 93763, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/0398272b3bacf46c360bc7f17bfcc500?s=128&d=identicon&r=PG", "display_name": "GMichael", "link": "https://stackoverflow.com/users/93763/gmichael"}, "is_accepted": false, "score": 0, "last_activity_date": 1469008123, "creation_date": 1469008123, "answer_id": 38477841, "question_id": 38477510, "link": "https://stackoverflow.com/questions/38477510/gnu-make-and-list-of-objects/38477841#38477841", "title": "GNU make and list of objects", "body": "<p>You can use <code>wildcard</code> function to automate file list maintenance like</p>\n\n<pre><code>sources := $(patsubst %.c,%.o,$(wildcard *.c))\n</code></pre>\n\n<p>You should also make a list of header files like</p>\n\n<pre><code>headers := $(wildcard *.h)\n</code></pre>\n\n<p>And add them to the compilation rule like </p>\n\n<pre><code>%.o : %.c $(headers)\n</code></pre>\n\n<p>GNU Make manual (<a href=\"https://www.gnu.org/software/make/manual/make.html\" rel=\"nofollow\">https://www.gnu.org/software/make/manual/make.html</a>) has more information, including possible pitfalls.</p>\n"}], "owner": {"reputation": 760, "user_id": 227797, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/906c88876bd65b9117af3fc27ddd3433?s=128&d=identicon&r=PG", "display_name": "Chris", "link": "https://stackoverflow.com/users/227797/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1083, "favorite_count": 1, "answer_count": 1, "score": 5, "last_activity_date": 1469008123, "creation_date": 1469007138, "question_id": 38477510, "link": "https://stackoverflow.com/questions/38477510/gnu-make-and-list-of-objects", "title": "GNU make and list of objects", "body": "<p>I have about 10 source files (.c) with headers (.h).\nOnly two source files (.c) are linked into executables (ELF) and contain the main function. Most of the files are compiled into objects (.o) and (re)used (statically linked) with the executables.</p>\n\n<p>I've tried to define a generic rule to build all objects:</p>\n\n<pre><code>%.o : %.c\n    $(CC) $(CCFLAGS) -c -o $@ $&lt;\n</code></pre>\n\n<p>This works great for the sources compiled into objects. I don't need to worry about updating make file every time I add a new source file.</p>\n\n<p>But I don't know what would be the best way to create rules for building executables?</p>\n\n<pre><code>exec1 : object1.o object2.o object3.o\n    call the linker\nexec2 : object1.o object2.o object4.o object5.o\n    call the linker\n</code></pre>\n\n<p>This will work; but, whenever I'll include a new header (foo.h) I will also need remember to update the list of objects for this rule (add foo.o).</p>\n\n<p>Is there any way make could automatically resolve required objects for a given target (maybe based on the included header files?) ?</p>\n\n<p>Is there a better way to define the target for an executable?</p>\n\n<p>Please note I can't use wildcard, since not all executables need all objects. Or could linker remove redundant objects?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["c", "pointers", "struct"], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 6612852, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8d3RRBOWPt0/AAAAAAAAAAI/AAAAAAAAAAA/vf0WtdzXDsY/photo.jpg?sz=128", "display_name": "dirtyb", "link": "https://stackoverflow.com/users/6612852/dirtyb"}, "edited": false, "score": 2, "creation_date": 1469006981, "post_id": 38477386, "comment_id": 64357419, "body": "thanks, i added : pair-&gt;key = malloc(sizeof(int)); pair-&gt;count = malloc(sizeof(int));  and it seems to work now"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 41, "user_id": 6612852, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8d3RRBOWPt0/AAAAAAAAAAI/AAAAAAAAAAA/vf0WtdzXDsY/photo.jpg?sz=128", "display_name": "dirtyb", "link": "https://stackoverflow.com/users/6612852/dirtyb"}, "edited": false, "score": 0, "creation_date": 1469008882, "post_id": 38477386, "comment_id": 64358650, "body": "@dirtyb You&#39;re welcome. You can also <a href=\"http://meta.stackexchange.com/q/5234/244062\">consider accepting an answer that helped you</a>."}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": true, "score": 3, "last_activity_date": 1469007421, "last_edit_date": 1469007421, "creation_date": 1469006752, "answer_id": 38477386, "question_id": 38477338, "link": "https://stackoverflow.com/questions/38477338/dereferencing-structure-instance-element-using-structure-instance-pointer/38477386#38477386", "title": "Dereferencing structure instance element using structure instance pointer", "body": "<p>No, there's no issue with <code>pair</code>, it's with <code>key</code> (and the <code>count</code>, too). The pointer is used uninitialized which invokes <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow\">undefined behavior</a>.</p>\n\n<p>At the point where you;re trying to dereference <code>key</code> </p>\n\n<pre><code> *(pair-&gt;key) = key;\n</code></pre>\n\n<p>there's no valid memory allocated to <code>key</code>, so the dereference invokes UB. You need to allocate memory to <code>key</code> before you can use it. same goes for the <code>count</code>, too.</p>\n"}], "owner": {"reputation": 41, "user_id": 6612852, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8d3RRBOWPt0/AAAAAAAAAAI/AAAAAAAAAAA/vf0WtdzXDsY/photo.jpg?sz=128", "display_name": "dirtyb", "link": "https://stackoverflow.com/users/6612852/dirtyb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "accepted_answer_id": 38477386, "answer_count": 1, "score": 2, "last_activity_date": 1469007421, "creation_date": 1469006640, "last_edit_date": 1469006939, "question_id": 38477338, "link": "https://stackoverflow.com/questions/38477338/dereferencing-structure-instance-element-using-structure-instance-pointer", "title": "Dereferencing structure instance element using structure instance pointer", "body": "<p>I have this function:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>static pair_t * // not visible outside this file\npair_new(const int key)\n{\n\n  pair_t *pair = malloc(sizeof(pair_t));\n\n  if (pair == NULL) {\n    // error allocating memory for pair; return error\n    return NULL;\n  } else {\n\n\n            printf(\"key is %d\\n\",key);\n\n      *(pair-&gt;key) = key;\n      *(pair-&gt;count) = 1;\n      pair-&gt;next = NULL;\n      return pair;\n\n  }\n}\n</code></pre>\n\n<p>but the way I am trying to dereference the key element of the instance of pair is giving me a seg fault. I think it is because 'pair' is a pointer.</p>\n\n<p>the pair structure is defined as follows:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>typedef struct pair {\n  int *key;                // search key for this item\n  int *count;                  // pointer to data for this item\n  struct pair *next;   // children\n} pair_t;\n</code></pre>\n\n<p>Any suggestions on how to properly change the value of <code>key</code> would be much appreciated</p>\n"}, {"tags": ["c", "matlab", "math", "microcontroller", "mathematical-optimization"], "answers": [{"tags": [], "owner": {"reputation": 41485, "user_id": 2521214, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/nd58V.jpg?s=128&g=1", "display_name": "Spektre", "link": "https://stackoverflow.com/users/2521214/spektre"}, "is_accepted": false, "score": 0, "last_activity_date": 1469031504, "creation_date": 1469031504, "answer_id": 38485774, "question_id": 38477188, "link": "https://stackoverflow.com/questions/38477188/implementing-matlab-mrdivide-using-qr-decomposition-and-solving-in-c/38485774#38485774", "title": "Implementing Matlab mrdivide using QR Decomposition and Solving in C", "body": "<p>just a silly suggestion:</p>\n\n<pre><code>x.A = B\nx.A.inverse(A) = B.inverse(A)\nx = B.inverse(A)\n</code></pre>\n\n<p>So you just need to compute <strong>Inverse matrix</strong> and <strong>matrix multiplication</strong> which are basic operations. Use Sub-determinant approach. Also if <code>A,B</code> are not square matrices resize them so they are.</p>\n"}], "owner": {"reputation": 23, "user_id": 1311684, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3e5428ecbdb28013f423baae27de82b0?s=128&d=identicon&r=PG", "display_name": "user1311684", "link": "https://stackoverflow.com/users/1311684/user1311684"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 94, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1469031504, "creation_date": 1469006262, "question_id": 38477188, "link": "https://stackoverflow.com/questions/38477188/implementing-matlab-mrdivide-using-qr-decomposition-and-solving-in-c", "title": "Implementing Matlab mrdivide using QR Decomposition and Solving in C", "body": "<p>I've used <code>x=B/A</code> (<a href=\"http://www.mathworks.com/help/matlab/ref/mrdivide.html\" rel=\"nofollow\">mrdivide</a>) in Matlab to find x in equation <code>xA=B</code>. I am trying to achieve this without Matlab environment using a C based fixed point library for microcontrollers called <a href=\"https://github.com/PetteriAimonen/libfixmatrix\" rel=\"nofollow\">libfixmatrix</a>.</p>\n\n<p>How would I proceed with using <a href=\"https://github.com/PetteriAimonen/libfixmatrix/blob/master/FUNCTIONS.rst#mf16-qr-decomposition\" rel=\"nofollow\">QR Decomposition</a> and <a href=\"https://github.com/PetteriAimonen/libfixmatrix/blob/master/FUNCTIONS.rst#mf16-solve\" rel=\"nofollow\">Solve</a> function's of libfixmatrix to solve <code>xA=B</code>?</p>\n\n<p>QR Decomposition and Solving is equivalent to solving for <code>Ax=B</code>. But I have a scenario where x is in equation <code>xA=B</code></p>\n\n<p>It was mentioned in the readme of the repository that :</p>\n\n<blockquote>\n  <p>Libfixmatrix is suited well for tasks involving small matrices (often\n  less than 10x10)</p>\n</blockquote>\n\n<p>Is it efficient to use libfixmatrix for say 80*80 ?</p>\n"}, {"tags": ["c", "memory", "microcontroller", "memory-address"], "comments": [{"owner": {"reputation": 7497, "user_id": 1213227, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/78179ef730f268752c0f6fdde3943b99?s=128&d=identicon&r=PG", "display_name": "Matthias", "link": "https://stackoverflow.com/users/1213227/matthias"}, "edited": false, "score": 1, "creation_date": 1469006185, "post_id": 38476918, "comment_id": 64356801, "body": "Please note that MMU and OS are distinguished concepts. You may have one without the other."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 2, "creation_date": 1469006584, "post_id": 38476918, "comment_id": 64357116, "body": "SoC and microcontroller are different term nowadays. Your question is very unclear. There is neiter a single SoC type, nor a single microcontroller. And FPGA based SoCs are even more flexible. You should learn more about the basics, you seem very confused (no offence)."}, {"owner": {"reputation": 1064, "user_id": 2317487, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/S9GeT.jpg?s=128&g=1", "display_name": "Aus", "link": "https://stackoverflow.com/users/2317487/aus"}, "edited": false, "score": 2, "creation_date": 1469007093, "post_id": 38476918, "comment_id": 64357496, "body": "Microcontrollers differes alot, you have to read their manuals. I mean since you don&#39;t have an OS to take care of the different architectures, you have to do it yourself. See if the manufacturer provides some dev kits."}, {"owner": {"reputation": 1, "user_id": 6593667, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-uCSf13VXuV0/AAAAAAAAAAI/AAAAAAAAAH0/1IwyqrdxLWo/photo.jpg?sz=128", "display_name": "vikas hurgat", "link": "https://stackoverflow.com/users/6593667/vikas-hurgat"}, "reply_to_user": {"reputation": 1064, "user_id": 2317487, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/S9GeT.jpg?s=128&g=1", "display_name": "Aus", "link": "https://stackoverflow.com/users/2317487/aus"}, "edited": false, "score": 0, "creation_date": 1469008889, "post_id": 38476918, "comment_id": 64358660, "body": "@AUS :you mean on micro controllers it can be done at manufacturer level.can i say,In ARM startup.s will do the same????"}, {"owner": {"reputation": 1064, "user_id": 2317487, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/S9GeT.jpg?s=128&g=1", "display_name": "Aus", "link": "https://stackoverflow.com/users/2317487/aus"}, "edited": false, "score": 0, "creation_date": 1469011185, "post_id": 38476918, "comment_id": 64360167, "body": "Don&#39;t know. But when I worked on an embedded system (ARM) I got the toolchain from the manufacturer. Then I was able to correctly cross compile an OS for it."}], "answers": [{"tags": [], "owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "is_accepted": false, "score": 1, "last_activity_date": 1469064628, "creation_date": 1469064628, "answer_id": 38493423, "question_id": 38476918, "link": "https://stackoverflow.com/questions/38476918/how-primary-memory-is-organised-in-a-microcontroller/38493423#38493423", "title": "How primary memory is organised in a microcontroller?", "body": "<p>Okay that is a cortex-A9, in no way shape or form is that a microcontroller.</p>\n\n<p>When you read the arm documentation for that architecture you will find the mmu in there.  It as expected is part of the Cortex-A core.</p>\n\n<p>Who/how/when is the ddr initialized?  Someone has to initialize it before you can write to it and read it back.  10 ones in decimal fits in a 32 bit write/read, 11 ones, takes 33 bits, what size write/read did you use?  How much ddr do you have?   I suspect you are not ready to be talking to ddr</p>\n\n<p>There is 256K of on chip ram, maybe you should mess with that first.</p>\n\n<p>All of this is in the zilinx and arm documentation.  Experienced bootloader developers can take months to get DDR initialized, how/who/when was that done, do you have dram tests to confirm that it is up and working if you werent the one to initialize it?  Has zilinx provided routines for that (how is your ddr initialized, who did it (your code, some code before yours, logic, etc) and when was it done, before your code ran?).  Maybe it is your job to initialize.</p>\n\n<p>the MMU you just read the arm docs as with everything about that core.  Then work with the xilinx docs for more, and then of course who did the rest of the fpga design to connect the arm core to the dram?  what address space are they using, what decoding, what alignments do they support, what axi transfers are supported, etc?  That is not something anyone here could do you have to talk to the fpga logic designers for your specific design.</p>\n\n<p>If you have no operating system then you are running bare metal.  You the programmer are responsible for memory management.  You dont need the mmu necessarily, sometimes it helps sometimes it just adds more work.  Depends completely on your programming task and overall design of the software and system.  The mmu is hardware, an operating system is software that runs on hardware.  One thing might use the other but they are in no way tied to each other any more than the interrupt controller or dram controller or uart, etc are tied to the operating system.  The operating system or other software may use that hardware, but you can use them with other software as well.</p>\n"}], "owner": {"reputation": 1, "user_id": 6593667, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-uCSf13VXuV0/AAAAAAAAAAI/AAAAAAAAAH0/1IwyqrdxLWo/photo.jpg?sz=128", "display_name": "vikas hurgat", "link": "https://stackoverflow.com/users/6593667/vikas-hurgat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "closed_date": 1469064664, "answer_count": 1, "score": -4, "last_activity_date": 1469064628, "creation_date": 1469005624, "question_id": 38476918, "link": "https://stackoverflow.com/questions/38476918/how-primary-memory-is-organised-in-a-microcontroller", "closed_reason": "Needs details or clarity", "title": "How primary memory is organised in a microcontroller?", "body": "<p>My query is :How the memory is organized and managed in the microcontroller?\n(It doesn't have any OS i.e no presence of MMU).</p>\n\n<p>I am working over zynq 7000 (ZC702) FPGA,It has seperate arm core and seperate DDR memory connected together with axi interconnects.</p>\n\n<p>I wrote 11 1111 1111 in decimal to DDR(10 1's),it is giving me same after reading.\nwhen i write 111 1111 1111 in decimal to DDR(11 1's),it gives me -1.</p>\n\n<p>here the whole physical memory is consumed.This will not be the case when i use any microcontroller.\nWho will manage the memory in microcontroller?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 23445, "user_id": 416224, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/8dc3ac9987d21288deea853f47d8dd6e?s=128&d=identicon&r=PG&f=1", "display_name": "kay", "link": "https://stackoverflow.com/users/416224/kay"}, "edited": false, "score": 3, "creation_date": 1469005067, "post_id": 38476698, "comment_id": 64355987, "body": "<code>0 == &#39;\\0&#39;</code>, <code>0x30 == &#39;0&#39;</code>."}, {"owner": {"reputation": 2037, "user_id": 1468415, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/wx7N9.png?s=128&g=1", "display_name": "mvidelgauz", "link": "https://stackoverflow.com/users/1468415/mvidelgauz"}, "edited": false, "score": 0, "creation_date": 1469005725, "post_id": 38476698, "comment_id": 64356464, "body": "Smells like you wanted to write <code>*strptr = &#39;0&#39;</code>?"}, {"owner": {"reputation": 21839, "user_id": 6521116, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/U2zHq.jpg?s=128&g=1", "display_name": "LF00", "link": "https://stackoverflow.com/users/6521116/lf00"}, "edited": false, "score": 0, "creation_date": 1469005786, "post_id": 38476698, "comment_id": 64356509, "body": "I am confuse here, 1 + 1 = 2, the ascii value of 1 is ?"}, {"owner": {"reputation": 27437, "user_id": 95954, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/iD0qO.png?s=128&g=1", "display_name": "Rudy Velthuis", "link": "https://stackoverflow.com/users/95954/rudy-velthuis"}, "edited": false, "score": 1, "creation_date": 1469009351, "post_id": 38476698, "comment_id": 64358969, "body": "@L.feir: The ASCII value of the <code>char</code> with value <code>&#39;1&#39;</code> is <code>0x31</code> (or <code>49</code> in decimal)."}, {"owner": {"reputation": 21839, "user_id": 6521116, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/U2zHq.jpg?s=128&g=1", "display_name": "LF00", "link": "https://stackoverflow.com/users/6521116/lf00"}, "edited": false, "score": 0, "creation_date": 1571046379, "post_id": 38476698, "comment_id": 103097509, "body": "It&#39;s unfair to downvoe without reason."}], "answers": [{"tags": [], "owner": {"reputation": 7617, "user_id": 2878070, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/42b5fba5761d7e519d05b642be0b2e14?s=128&d=identicon&r=PG&f=1", "display_name": "Sergio", "link": "https://stackoverflow.com/users/2878070/sergio"}, "is_accepted": false, "score": 3, "last_activity_date": 1469015220, "last_edit_date": 1469015220, "creation_date": 1469005120, "answer_id": 38476748, "question_id": 38476698, "link": "https://stackoverflow.com/questions/38476698/why-strptr-0-truncate-the-stringc/38476748#38476748", "title": "Why *strptr = 0 truncate the string?(C)", "body": "<p>All standard library string routines treat character <code>'\\0'</code> as string terminator, so if you put it at the beginning of the string - they all see no data to process, because first character is a terminator so effectively string is empty. And yes, per standard <code>'\\0'</code> is a character that has value <code>0</code>. As result: <code>'\\0' == 0</code> is true.</p>\n"}, {"tags": [], "owner": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "is_accepted": true, "score": 6, "last_activity_date": 1471404221, "last_edit_date": 1471404221, "creation_date": 1469005876, "answer_id": 38477031, "question_id": 38476698, "link": "https://stackoverflow.com/questions/38476698/why-strptr-0-truncate-the-stringc/38477031#38477031", "title": "Why *strptr = 0 truncate the string?(C)", "body": "<p>More precisely, there are three lexical elements that contain a zero character: <code>0</code> (unquoted), <code>'0'</code> (quoted, typically (but not always) equal to <code>48</code> or <code>0x30</code> unquoted) and <code>'\\0'</code> (equal to <code>0</code>, but in character notation).</p>\n\n<p>The question is talking about two distinct values...<code>'0' != '\\0'</code>. Forget about 30, 48, etc. Just remember <code>'0'</code> and <code>'\\0'</code> are different characters, and <code>'\\0'</code> is a string terminator that has a value of <code>0</code>...</p>\n\n<p>I think you meant to use <code>'0'</code> (emphasis on the quotation marks).</p>\n"}], "owner": {"reputation": 21839, "user_id": 6521116, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/U2zHq.jpg?s=128&g=1", "display_name": "LF00", "link": "https://stackoverflow.com/users/6521116/lf00"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 205, "favorite_count": 1, "accepted_answer_id": 38477031, "answer_count": 2, "score": -5, "last_activity_date": 1495699496, "creation_date": 1469004965, "last_edit_date": 1495699496, "question_id": 38476698, "link": "https://stackoverflow.com/questions/38476698/why-strptr-0-truncate-the-stringc", "title": "Why *strptr = 0 truncate the string?(C)", "body": "<p>Why <code>*strptr = 0</code> truncate the string?(C)</p>\n\n<p>Why the ascii value 30 of 0 become 0 of null?</p>\n\n<p>Here I'm confused with the number 0, string 0 and the string termianl 0.</p>\n\n<p>your explaination will be appreciated.</p>\n"}, {"tags": ["c", "embedded", "armclang"], "comments": [{"owner": {"reputation": 69870, "user_id": 457352, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/71fae1115a09663bed6c685c523cb0f0?s=128&d=identicon&r=PG", "display_name": "Benoit", "link": "https://stackoverflow.com/users/457352/benoit"}, "edited": false, "score": 0, "creation_date": 1469004063, "post_id": 38476278, "comment_id": 64355328, "body": "Casting to <code>const uintptr_t</code> keeps constness of the pointer, but discards constness of the pointee."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1469004353, "post_id": 38476278, "comment_id": 64355514, "body": "Did you look for -Wno-assume or similar?"}, {"owner": {"reputation": 686, "user_id": 4449225, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/5c26490e60a636f998bfd589d9555d2d?s=128&d=identicon&r=PG&f=1", "display_name": "Flip", "link": "https://stackoverflow.com/users/4449225/flip"}, "reply_to_user": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1469005137, "post_id": 38476278, "comment_id": 64356039, "body": "@2501 I don&#39;t want to disable the warning. Rather fix the code so that there isn&#39;t a warning."}, {"owner": {"reputation": 686, "user_id": 4449225, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/5c26490e60a636f998bfd589d9555d2d?s=128&d=identicon&r=PG&f=1", "display_name": "Flip", "link": "https://stackoverflow.com/users/4449225/flip"}, "reply_to_user": {"reputation": 69870, "user_id": 457352, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/71fae1115a09663bed6c685c523cb0f0?s=128&d=identicon&r=PG", "display_name": "Benoit", "link": "https://stackoverflow.com/users/457352/benoit"}, "edited": false, "score": 0, "creation_date": 1469005428, "post_id": 38476278, "comment_id": 64356242, "body": "@Benoit The pointer is never dereferenced, I&#39;m only interested in the pointer value itself. Would using uint8_t pointers work? I.e. <code>const uint8_t* const ptr = (uint8_t*)pointerToCheck;</code> work?"}], "answers": [{"comments": [{"owner": {"reputation": 686, "user_id": 4449225, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/5c26490e60a636f998bfd589d9555d2d?s=128&d=identicon&r=PG&f=1", "display_name": "Flip", "link": "https://stackoverflow.com/users/4449225/flip"}, "edited": false, "score": 0, "creation_date": 1469007121, "post_id": 38477470, "comment_id": 64357520, "body": "<code>__attribute__ ((pure))</code> and <code>__attribute__ ((const))</code> both seem to fix the issue."}, {"owner": {"reputation": 2286, "user_id": 3228495, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e0163d41bd310e00b055618846734b0?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew", "link": "https://stackoverflow.com/users/3228495/andrew"}, "reply_to_user": {"reputation": 686, "user_id": 4449225, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/5c26490e60a636f998bfd589d9555d2d?s=128&d=identicon&r=PG&f=1", "display_name": "Flip", "link": "https://stackoverflow.com/users/4449225/flip"}, "edited": false, "score": 0, "creation_date": 1469008690, "post_id": 38477470, "comment_id": 64358542, "body": "@Flip I have extended the answer to also mention the const attribute.  Thanks for pointing that out."}], "tags": [], "owner": {"reputation": 2286, "user_id": 3228495, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e0163d41bd310e00b055618846734b0?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew", "link": "https://stackoverflow.com/users/3228495/andrew"}, "is_accepted": false, "score": 2, "last_activity_date": 1469008651, "last_edit_date": 1469008651, "creation_date": 1469007000, "answer_id": 38477470, "question_id": 38476278, "link": "https://stackoverflow.com/questions/38476278/discarded-side-effects-with-argument-passed-to-assert/38477470#38477470", "title": "Discarded side effects with argument passed to assert", "body": "<p>The <a href=\"http://infocenter.arm.com/help/index.jsp?topic=/com.arm.doc.dui0774d/chr1383741543685.html\" rel=\"nofollow\">documentation</a> suggests that armclang supports the <code>__attribute__ ((pure))</code> and <code>__attribute__ ((const))</code> function attributes.  These attributes are for functions that don't have any side effect, their return value is based on the input parameters.  A pure function can also read global state, while a const function can only examine its function parameters.</p>\n\n<p>Adding one of these attributes to your <code>checkPtr</code> declaration and definition should silence the warning.</p>\n"}], "owner": {"reputation": 686, "user_id": 4449225, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/5c26490e60a636f998bfd589d9555d2d?s=128&d=identicon&r=PG&f=1", "display_name": "Flip", "link": "https://stackoverflow.com/users/4449225/flip"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 450, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1469008651, "creation_date": 1469003806, "question_id": 38476278, "link": "https://stackoverflow.com/questions/38476278/discarded-side-effects-with-argument-passed-to-assert", "title": "Discarded side effects with argument passed to assert", "body": "<p>I have a compiler warning I would like to get rid off. </p>\n\n<blockquote>\n  <p>warning: the argument to '__builtin_assume' has side effects that will be discarded [-Wassume]</p>\n  \n  <p>C:\\Keil_v5\\ARM\\ARMCLANG\\Bin..\\include\\assert.h(72): note: expanded from macro 'assert'</p>\n  \n  <p>define assert(e) ((e) ? (void)0 : _CLIBNS _aeabi_assert(e, _FILE__, _LINE__), (__ARM_PROMISE)((e)?1:0))</p>\n</blockquote>\n\n<p>The idea is to have no warning when compiled with warning set to \"pedantic\".\nThe cause is a recently added pointer check function to my embedded code. The idea is to improve the following:</p>\n\n<pre><code>void foo(int* const val)\n{    assert(val != NULL);\n\n     /*Use val etc.*/\n}\n</code></pre>\n\n<p>to something along the lines of:</p>\n\n<pre><code>void foo(int* const val)\n{    assert(checkPtr(val) == OK);\n\n     /*Use val etc.*/\n}\n</code></pre>\n\n<p>This is because automatic variables are not zero intialised. Thus, it is likely that an uninitialised pointer will not be NULL. This is a coding mistake that I would like to detect (not necessarily my own doing), hence the checks. The following is not perfect, but does seem to pick up more pointer errors (not dangling ones unfortunately).</p>\n\n<p>I have the following code in a header file to implement this:</p>\n\n<pre><code>#define INTERNAL_RAM_START ((uintptr_t)0x2000000UL)\n#define INTERNAL_RAM_END (INTERNAL_RAM_START + (uintptr_t)0x20000UL)\n#define INTERNAL_ROM_START ((uintptr_t)0x8000000UL)\n#define INTERNAL_ROM_END (INTERNAL_ROM_START + (uintptr_t)0x100000UL)\n\ntypedef enum{OK, NOT_OK}Status_t;\n\nstatic inline Status_t checkPtr(const void* const ptrToCheck)\n{\n    if(ptr == NULL)\n        return NOT_OK;\n\n    const uintptr_t ptr = (uintptr_t)ptrToCheck;\n\n    if((ptr &gt;= INTERNAL_RAM_START) &amp;&amp; (ptr &lt; INTERNAL_RAM_END))\n        return OK;\n\n    if((ptr &gt;= INTERNAL_ROM_START) &amp;&amp; (ptr &lt; INTERNAL_ROM_END))\n        return OK;\n\n    return NOT_OK\n}\n</code></pre>\n\n<p>I don't have any warnings with ARMCC 5.06 in my code. From what I can see, my checkPtr function does not have any side effects. It does not access any variables other than the pointer that was passed to it.</p>\n"}, {"tags": ["c", "codeblocks"], "comments": [{"owner": {"reputation": 4751, "user_id": 5649326, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/a82Se.jpg?s=128&g=1", "display_name": "Marievi", "link": "https://stackoverflow.com/users/5649326/marievi"}, "edited": false, "score": 0, "creation_date": 1469003839, "post_id": 38476263, "comment_id": 64355198, "body": "Please share your code or ask something more specific."}, {"owner": {"reputation": 23, "user_id": 6606817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed5508721c7ff6835e96a718ec7a7633?s=128&d=identicon&r=PG&f=1", "display_name": "Gayantha Akalanka", "link": "https://stackoverflow.com/users/6606817/gayantha-akalanka"}, "reply_to_user": {"reputation": 4751, "user_id": 5649326, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/a82Se.jpg?s=128&g=1", "display_name": "Marievi", "link": "https://stackoverflow.com/users/5649326/marievi"}, "edited": false, "score": 0, "creation_date": 1469003917, "post_id": 38476263, "comment_id": 64355247, "body": "#include&lt;stdio.h&gt; main(){ char a; a=&quot;S&quot;; printf(&quot;%s&quot;,a); }"}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1469003957, "post_id": 38476263, "comment_id": 64355263, "body": "It means (a) you&#39;re not just compiling and linking your program; you&#39;re also running it. And (b) your program is invoking <i>undefined behaviour</i> that is fortunately causing early termination by the OS. The code you just posted does just that. That code suggests a <a href=\"https://stackoverflow.com/questions/562303/the-definitive-c-book-guide-and-list?s=1|3.4128\">good book on the C language</a> is a sound investment."}, {"owner": {"reputation": 23, "user_id": 6606817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed5508721c7ff6835e96a718ec7a7633?s=128&d=identicon&r=PG&f=1", "display_name": "Gayantha Akalanka", "link": "https://stackoverflow.com/users/6606817/gayantha-akalanka"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1469004125, "post_id": 38476263, "comment_id": 64355367, "body": "@WhozCraig So isn&#39;t there a way to compile my code ?"}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1469004469, "post_id": 38476263, "comment_id": 64355568, "body": "As I said, your code is compiling <i>and</i> running. It&#39;s just plain bad code that invokes undefined behavior. Thus the suggestion for a book on the language. (and that code belongs in <i>your question</i>; not in a comment down here. And for goodness sake, <i>turn up your warning levels on your compiler</i>."}, {"owner": {"reputation": 23, "user_id": 6606817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed5508721c7ff6835e96a718ec7a7633?s=128&d=identicon&r=PG&f=1", "display_name": "Gayantha Akalanka", "link": "https://stackoverflow.com/users/6606817/gayantha-akalanka"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1469004704, "post_id": 38476263, "comment_id": 64355739, "body": "@WhozCraig ok..Thank you for your help! :D"}, {"owner": {"reputation": 32098, "user_id": 646887, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YJ0Ye.jpg?s=128&g=1", "display_name": "Klas Lindb&#228;ck", "link": "https://stackoverflow.com/users/646887/klas-lindb%c3%a4ck"}, "edited": false, "score": 1, "creation_date": 1469004873, "post_id": 38476263, "comment_id": 64355848, "body": "Please turn on/up compiler warnings! Your code should give 2 warnings, one for assignment of incompatible types (assigning a string to a char) and one for improper format code (printing a char with &quot;%s&quot;)."}], "answers": [{"comments": [{"owner": {"reputation": 4593, "user_id": 105104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02b23920ac852e946b333d3f9d0d95c1?s=128&d=identicon&r=PG", "display_name": "dvhh", "link": "https://stackoverflow.com/users/105104/dvhh"}, "edited": false, "score": 0, "creation_date": 1469005036, "post_id": 38476672, "comment_id": 64355968, "body": "although your code fixes one compiler warning, it does not fix the code"}, {"owner": {"reputation": 182, "user_id": 6559553, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-uLVbM4t-pDI/AAAAAAAAAAI/AAAAAAAAAGE/0_yj2sLVOpc/photo.jpg?sz=128", "display_name": "Govind Madhu", "link": "https://stackoverflow.com/users/6559553/govind-madhu"}, "reply_to_user": {"reputation": 4593, "user_id": 105104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02b23920ac852e946b333d3f9d0d95c1?s=128&d=identicon&r=PG", "display_name": "dvhh", "link": "https://stackoverflow.com/users/105104/dvhh"}, "edited": false, "score": 0, "creation_date": 1469005181, "post_id": 38476672, "comment_id": 64356071, "body": "Did not notice the double quotes until now. Fixed that as well."}, {"owner": {"reputation": 4593, "user_id": 105104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02b23920ac852e946b333d3f9d0d95c1?s=128&d=identicon&r=PG", "display_name": "dvhh", "link": "https://stackoverflow.com/users/105104/dvhh"}, "edited": false, "score": 0, "creation_date": 1469005381, "post_id": 38476672, "comment_id": 64356217, "body": "but are you sure that was the intended code ? maybe @gayantha-akalanka wanted to print a string, and not a single character only."}, {"owner": {"reputation": 182, "user_id": 6559553, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-uLVbM4t-pDI/AAAAAAAAAAI/AAAAAAAAAGE/0_yj2sLVOpc/photo.jpg?sz=128", "display_name": "Govind Madhu", "link": "https://stackoverflow.com/users/6559553/govind-madhu"}, "reply_to_user": {"reputation": 4593, "user_id": 105104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02b23920ac852e946b333d3f9d0d95c1?s=128&d=identicon&r=PG", "display_name": "dvhh", "link": "https://stackoverflow.com/users/105104/dvhh"}, "edited": false, "score": 0, "creation_date": 1469005716, "post_id": 38476672, "comment_id": 64356457, "body": "@dvhh I&#39;m going by the sample code he provided. He is using a character variable and not an array declared as char."}, {"owner": {"reputation": 23, "user_id": 6606817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed5508721c7ff6835e96a718ec7a7633?s=128&d=identicon&r=PG&f=1", "display_name": "Gayantha Akalanka", "link": "https://stackoverflow.com/users/6606817/gayantha-akalanka"}, "edited": false, "score": 0, "creation_date": 1469008658, "post_id": 38476672, "comment_id": 64358517, "body": "I want to print only a single character.so think @Govind Madhu your suggestion is ok..thank you very much guys!"}, {"owner": {"reputation": 13866, "user_id": 54200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6261c8ab215b8069e8290516c80445d8?s=128&d=identicon&r=PG", "display_name": "KevinDTimm", "link": "https://stackoverflow.com/users/54200/kevindtimm"}, "edited": false, "score": 0, "creation_date": 1469019822, "post_id": 38476672, "comment_id": 64366258, "body": "Unfortunately what you have done is given him a fish as opposed to teach him to fish as <code>monkeyStix</code> did in the accepted answer. The point of SO is not to blindly answer a question but explain why your answer solves the problem."}, {"owner": {"reputation": 23, "user_id": 6606817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed5508721c7ff6835e96a718ec7a7633?s=128&d=identicon&r=PG&f=1", "display_name": "Gayantha Akalanka", "link": "https://stackoverflow.com/users/6606817/gayantha-akalanka"}, "reply_to_user": {"reputation": 13866, "user_id": 54200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6261c8ab215b8069e8290516c80445d8?s=128&d=identicon&r=PG", "display_name": "KevinDTimm", "link": "https://stackoverflow.com/users/54200/kevindtimm"}, "edited": false, "score": 0, "creation_date": 1469024716, "post_id": 38476672, "comment_id": 64370172, "body": "@KevinDTimm It&#39;s ok.I followed both answers.But i have another question.@Govind Madhu@KevinDTimm  What happen if i use double quotes in a=&quot;S&quot;? ( I got $ sign as the output)"}, {"owner": {"reputation": 13866, "user_id": 54200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6261c8ab215b8069e8290516c80445d8?s=128&d=identicon&r=PG", "display_name": "KevinDTimm", "link": "https://stackoverflow.com/users/54200/kevindtimm"}, "reply_to_user": {"reputation": 23, "user_id": 6606817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed5508721c7ff6835e96a718ec7a7633?s=128&d=identicon&r=PG&f=1", "display_name": "Gayantha Akalanka", "link": "https://stackoverflow.com/users/6606817/gayantha-akalanka"}, "edited": false, "score": 0, "creation_date": 1469025606, "post_id": 38476672, "comment_id": 64370861, "body": "@GayanthaAkalanka - that is covered in <code>monkeyStix</code> answer"}, {"owner": {"reputation": 23, "user_id": 6606817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed5508721c7ff6835e96a718ec7a7633?s=128&d=identicon&r=PG&f=1", "display_name": "Gayantha Akalanka", "link": "https://stackoverflow.com/users/6606817/gayantha-akalanka"}, "reply_to_user": {"reputation": 13866, "user_id": 54200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6261c8ab215b8069e8290516c80445d8?s=128&d=identicon&r=PG", "display_name": "KevinDTimm", "link": "https://stackoverflow.com/users/54200/kevindtimm"}, "edited": false, "score": 0, "creation_date": 1469025729, "post_id": 38476672, "comment_id": 64370948, "body": "@KevinDTimm Gotcha! Thank you.."}], "tags": [], "owner": {"reputation": 182, "user_id": 6559553, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-uLVbM4t-pDI/AAAAAAAAAAI/AAAAAAAAAGE/0_yj2sLVOpc/photo.jpg?sz=128", "display_name": "Govind Madhu", "link": "https://stackoverflow.com/users/6559553/govind-madhu"}, "is_accepted": false, "score": -1, "last_activity_date": 1469005152, "last_edit_date": 1469005152, "creation_date": 1469004872, "answer_id": 38476672, "question_id": 38476263, "link": "https://stackoverflow.com/questions/38476263/runtime-error-when-running-my-code/38476672#38476672", "title": "Runtime error when running my code", "body": "<p>Change your code to</p>\n\n<pre><code>#include&lt;stdio.h&gt; \nint main()\n{ \n  char a; \n  a='S'; \n  printf(\"%c\",a);\n  return 0;\n } \n</code></pre>\n\n<p>and it will work fine.</p>\n"}, {"tags": [], "owner": {"reputation": 594, "user_id": 6040113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a03cab99436994f7bc68df23f674729?s=128&d=identicon&r=PG&f=1", "display_name": "monkeyStix", "link": "https://stackoverflow.com/users/6040113/monkeystix"}, "is_accepted": true, "score": 1, "last_activity_date": 1469006945, "last_edit_date": 1469006945, "creation_date": 1469006798, "answer_id": 38477411, "question_id": 38476263, "link": "https://stackoverflow.com/questions/38476263/runtime-error-when-running-my-code/38477411#38477411", "title": "Runtime error when running my code", "body": "<p>When you invoke printf with <code>%s</code> it means that <code>printf</code> will start printing at the given address and end when a null terminator is reached, because you are giving printf a <code>char</code> and not a <code>pointer</code> to a <code>char</code>, it tries to use the value written in <code>a</code> to start printing from. </p>\n\n<p><code>a</code> is a char taking up a space of one Byte while an address is 8 Bytes in a 64 bit system, so basically printf takes the value in 'a' and the the next 7 Bytes(which are random '<em>garbage</em>') and tries to use it as an address to stop printing.</p>\n\n<p>that is why it sometimes works as you said, sometimes those random addresses are fine to start printing from, but sometimes they are addresses that you are not authorized to access like areas of memory used by the OS or kernel.</p>\n\n<p>to solve the problem you need to make <code>a</code> a <code>char *</code> and <em>not</em> a <code>char</code>, and assign it with a string.</p>\n"}], "owner": {"reputation": 23, "user_id": 6606817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed5508721c7ff6835e96a718ec7a7633?s=128&d=identicon&r=PG&f=1", "display_name": "Gayantha Akalanka", "link": "https://stackoverflow.com/users/6606817/gayantha-akalanka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "closed_date": 1469646029, "accepted_answer_id": 38477411, "answer_count": 2, "score": -4, "last_activity_date": 1469006945, "creation_date": 1469003762, "last_edit_date": 1469004763, "question_id": 38476263, "link": "https://stackoverflow.com/questions/38476263/runtime-error-when-running-my-code", "closed_reason": "Needs details or clarity", "title": "Runtime error when running my code", "body": "<p>When I compile my C codes sometimes I get this error message.</p>\n\n<blockquote>\n  <p>Mycode.exe has stopped working..<br>\n  A problem caused the program to stop working correctly.<br>\n  Windows will close the program and notify you if a solution available.</p>\n</blockquote>\n\n<p>My C code :</p>\n\n<pre><code>#include&lt;stdio.h&gt; \n\nmain(){ \n    char a; \n    a=\"S\"; \n    printf(\"%s\",a); \n} \n</code></pre>\n\n<p>So what is the reason for this problem?<br>\nSyntax error, Runtime error or another reason?                    </p>\n"}, {"tags": ["c", "structure", "typecasting-operator"], "comments": [{"owner": {"reputation": 14710, "user_id": 5538420, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/oc81s.jpg?s=128&g=1", "display_name": "dxiv", "link": "https://stackoverflow.com/users/5538420/dxiv"}, "edited": false, "score": 1, "creation_date": 1468999916, "post_id": 38474881, "comment_id": 64352821, "body": "If <code>UCHAR</code> is the same type as <code>UINT8</code> on your compiler + platform, then try replacing <code>(unsigned char *)&amp;hsu_addr</code> with just <code>hsu_addr.addr</code>. Otherwise post a <i>lot</i> more context."}], "answers": [{"comments": [{"owner": {"reputation": 109, "user_id": 3583842, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/848e1219b7246300ed96762cfcf11fab?s=128&d=identicon&r=PG&f=1", "display_name": "Abhinav", "link": "https://stackoverflow.com/users/3583842/abhinav"}, "edited": false, "score": 0, "creation_date": 1469000059, "post_id": 38474964, "comment_id": 64352900, "body": "but hci_acl_connect(UCHAR *   bd_addr,UINT16 *  handle); Its first argument required a char pointer"}, {"owner": {"reputation": 36141, "user_id": 4354477, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/SuxtS.gif?s=128&g=1", "display_name": "ForceBru", "link": "https://stackoverflow.com/users/4354477/forcebru"}, "reply_to_user": {"reputation": 109, "user_id": 3583842, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/848e1219b7246300ed96762cfcf11fab?s=128&d=identicon&r=PG&f=1", "display_name": "Abhinav", "link": "https://stackoverflow.com/users/3583842/abhinav"}, "edited": false, "score": 0, "creation_date": 1469000142, "post_id": 38474964, "comment_id": 64352957, "body": "@Abhinav, you should probably refresh the page to see the latest edit to this answer"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 109, "user_id": 3583842, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/848e1219b7246300ed96762cfcf11fab?s=128&d=identicon&r=PG&f=1", "display_name": "Abhinav", "link": "https://stackoverflow.com/users/3583842/abhinav"}, "edited": false, "score": 0, "creation_date": 1469000183, "post_id": 38474964, "comment_id": 64352983, "body": "@Abhinav Unless e.g. <code>short</code> is 8 bits on your system, an <code>unsigned char</code> seems like the only reasonable way to define both <code>UINT8</code> and <code>UCHAR</code>, which means both types are the same."}], "tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": false, "score": 2, "last_activity_date": 1468999791, "creation_date": 1468999791, "answer_id": 38474964, "question_id": 38474881, "link": "https://stackoverflow.com/questions/38474881/typecasting-int-to-char/38474964#38474964", "title": "Typecasting int to char *", "body": "<p>Assuming that you want the function to do something with the array <code>addr</code> in the structure, then there is no need for the casting. Just pass the <code>addr</code> member:</p>\n\n<pre><code>hci_acl_connect(hsu_addr.addr, &amp;cont_hand);\n</code></pre>\n\n<p>That's assuming that both <code>UINT8</code> and <code>UCHAR</code> are both aliases of <code>unsigned char</code> (which seems like a safe assumption).</p>\n"}, {"tags": [], "owner": {"reputation": 39526, "user_id": 265804, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/156ef8708acdbf6a9ef76dad0d69609f?s=128&d=identicon&r=PG&f=1", "display_name": "Blagovest Buyukliev", "link": "https://stackoverflow.com/users/265804/blagovest-buyukliev"}, "is_accepted": false, "score": 1, "last_activity_date": 1468999965, "creation_date": 1468999965, "answer_id": 38475030, "question_id": 38474881, "link": "https://stackoverflow.com/questions/38474881/typecasting-int-to-char/38475030#38475030", "title": "Typecasting int to char *", "body": "<p>Casting from any other pointer type to a <code>char *</code> or <code>unsigned char *</code> is safe because <code>char</code> has the least strict alignment requirements, that is, it can be located at any address. It will also not break the strict aliasing rule.</p>\n\n<p>The inverse, however, is undefined behaviour. A larger type will usually have stricter alignment requirements and that will potentially result in an attempt to do an operation at a misaligned address. The new pointer could also possibly alias the old one and that would potentially mislead the compiler when doing optimisations.</p>\n"}, {"tags": [], "owner": {"reputation": 36141, "user_id": 4354477, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/SuxtS.gif?s=128&g=1", "display_name": "ForceBru", "link": "https://stackoverflow.com/users/4354477/forcebru"}, "is_accepted": true, "score": 1, "last_activity_date": 1468999984, "creation_date": 1468999984, "answer_id": 38475041, "question_id": 38474881, "link": "https://stackoverflow.com/questions/38474881/typecasting-int-to-char/38475041#38475041", "title": "Typecasting int to char *", "body": "<p>Yes, of course. Your variable resides on stack, but you need to provide a pointer, so you use <code>&amp;your_var</code>. You need a pointer to <code>UCHAR</code>, so you cast: <code>(UCHAR *)&amp;your_var</code>. </p>\n\n<p>The casting itself is OK, but we don't know what <code>UCHAR *   bd_addr</code> is supposed to represent. Perhaps you should pass <code>your_var.addr</code> instead?</p>\n"}], "owner": {"reputation": 109, "user_id": 3583842, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/848e1219b7246300ed96762cfcf11fab?s=128&d=identicon&r=PG&f=1", "display_name": "Abhinav", "link": "https://stackoverflow.com/users/3583842/abhinav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 181, "favorite_count": 1, "accepted_answer_id": 38475041, "answer_count": 3, "score": 1, "last_activity_date": 1468999984, "creation_date": 1468999566, "question_id": 38474881, "link": "https://stackoverflow.com/questions/38474881/typecasting-int-to-char", "title": "Typecasting int to char *", "body": "<p>Following definition of structure is defined in one of my header file</p>\n\n<pre><code>typedef struct REMDEV_ADDR {\nUINT8    addr[DEVICE_ADDR_SIZE];\n} RemDev_Addr;\n\ntypedef RemDev_Addr BTDEV_ADDR;\n</code></pre>\n\n<p>Now I have following function which I want to use.</p>\n\n<pre><code> hci_acl_connect(UCHAR *   bd_addr,UINT16 *  handle);\n</code></pre>\n\n<p>So I made a global instance of the above structure in my c file</p>\n\n<pre><code>BTDEV_ADDR hsu_addr\n</code></pre>\n\n<p>and calling the function like this</p>\n\n<pre><code>hci_acl_connect((unsigned char *)&amp;hsu_addr,&amp;cont_hand);\n</code></pre>\n\n<p>Is typecasting is correct \"(unsigned char *)&amp;hsu_addr\" ?</p>\n"}, {"tags": ["c", "pointers", "struct", "function-pointers"], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 6293480, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7d26bb100232219764ea20a7257de30?s=128&d=identicon&r=PG&f=1", "display_name": "bobbyyu10", "link": "https://stackoverflow.com/users/6293480/bobbyyu10"}, "edited": false, "score": 0, "creation_date": 1468999817, "post_id": 38474935, "comment_id": 64352768, "body": "The problem is that it has to operate on all datatypes, hence void*"}, {"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "reply_to_user": {"reputation": 25, "user_id": 6293480, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7d26bb100232219764ea20a7257de30?s=128&d=identicon&r=PG&f=1", "display_name": "bobbyyu10", "link": "https://stackoverflow.com/users/6293480/bobbyyu10"}, "edited": false, "score": 0, "creation_date": 1469000204, "post_id": 38474935, "comment_id": 64353000, "body": "@bobbyyu10 : I&#39;ve addressed that as well now"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1469000422, "post_id": 38474935, "comment_id": 64353140, "body": "Converting to and from <code>void *</code> doesn&#39;t require a cast, so <code>my_type *obj = vobj;</code> is sufficient."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 1, "creation_date": 1469002575, "post_id": 38474935, "comment_id": 64354475, "body": "Using (calling) a function pointer using the incorrect type will cause undefined behavior. Please amend the answer."}, {"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "reply_to_user": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1469003469, "post_id": 38474935, "comment_id": 64354980, "body": "@2501 : I didn&#39;t mention that, since I wasn&#39;t actually using the function pointer in the code samples (and as I&#39;m sure you know, the cast in itself is perfectly legal). But you&#39;re right that adding such warning is prudent, so I will. Thanks for pointing it out."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 1, "creation_date": 1469004932, "post_id": 38474935, "comment_id": 64355899, "body": "init probably doesn&#39;t call the function. <i>Anytime</i> the function is called via the member of my_struct_t it has to be of, or cast to, the correct type. The rest seems ok."}, {"owner": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "edited": false, "score": 2, "creation_date": 1469005142, "post_id": 38474935, "comment_id": 64356042, "body": "I think it would be best to put the better alternative at the start... except that the cast is unnecessary when converting between <code>void *</code> and other pointer-to-object types. Regarding the UB, you could trigger a warning with a bit of preprocessor abuse appended: <code>#define desired_func(value) do { mytype *v = value; desired_func(v); } while (0)</code>... Nice answer :)"}, {"owner": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "edited": false, "score": 1, "creation_date": 1469005347, "post_id": 38474935, "comment_id": 64356194, "body": "... or even an error with <code>#define desired_func(value) do { mytype v = *value; desired_func(value); } while (0)</code> hmmmm"}, {"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "reply_to_user": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "edited": false, "score": 0, "creation_date": 1469006194, "post_id": 38474935, "comment_id": 64356805, "body": "@Seb : interesting macro&#39;s ! Upvoted your comments to increase visibility. About the unnecessary cast from <code>void*</code>, that&#39;s just a habit. Since you&#39;re the second person to point it out, and I don&#39;t feel strongly either way, I&#39;ll remove the cast."}], "tags": [], "owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "is_accepted": true, "score": 5, "last_activity_date": 1469006224, "last_edit_date": 1469006224, "creation_date": 1468999723, "answer_id": 38474935, "question_id": 38474800, "link": "https://stackoverflow.com/questions/38474800/function-pointer-incompatible-pointer-types-void-void-from-void-my-type/38474935#38474935", "title": "function pointer incompatible pointer types void (*)(void *) from void (my_type *)", "body": "<p>Change the function pointer types to match the function, ie. :</p>\n\n<pre><code>void (*funcp)(my_type *data);\n</code></pre>\n\n<p>If you want to be able to use functions with different signatures (eg. different parameter types), you can add explicit casts. For example :</p>\n\n<pre><code>init(5, (void (*)(void*)) desired_func);\n</code></pre>\n\n<p>Note that any time the <code>desired_func</code> function (or any other function whose signature doesn't match the <code>funcp</code> function pointer) needs to be called through the function pointer, the function pointer will have to be cast back to its original type (<code>void (*)(my_type*)</code> in this case) before calling the function, or it invokes undefined behavior.</p>\n\n<p>Another (somewhat better) alternative is to change the <code>desired_func</code> definition like this :</p>\n\n<pre><code>void desired_func(void *vobj) {\n    my_type* obj = vobj;\n    /* rest of the code */\n}\n</code></pre>\n\n<p>Note that when calling <code>desired_func</code> (through a function pointer or directly), the type of the object whose address is passed as parameter needs to be <code>my_type</code>, or dereferencing <code>obj</code> inside the function (and if alignment differs even the cast itself) will invoke undefined behavior.</p>\n\n<p>The added complexity for dealing with the potential for undefined behavior when casting (as noted above) means that I would advise against casting - needing such casts is probably indicative of a problem in your design. Ie. there's probably a better solution if you think about your requirements a bit more.</p>\n"}], "owner": {"reputation": 25, "user_id": 6293480, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7d26bb100232219764ea20a7257de30?s=128&d=identicon&r=PG&f=1", "display_name": "bobbyyu10", "link": "https://stackoverflow.com/users/6293480/bobbyyu10"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4670, "favorite_count": 1, "accepted_answer_id": 38474935, "answer_count": 1, "score": 1, "last_activity_date": 1469006224, "creation_date": 1468999316, "last_edit_date": 1468999540, "question_id": 38474800, "link": "https://stackoverflow.com/questions/38474800/function-pointer-incompatible-pointer-types-void-void-from-void-my-type", "title": "function pointer incompatible pointer types void (*)(void *) from void (my_type *)", "body": "<p>I'm having getting the above warning and understand it, but just don't know how to fix it. My code is below, but basically what I'm doing is storing a function pointer in a struct, and initializing the struct in another function that I call from my main. The code seems to compile when I use it with a default function (i.e. free()) but not when I use it with the test_func function below. Thoughts?</p>\n\n<p>Struct:</p>\n\n<pre><code>  typedef struct my_struct {\n  my_type **double_pointed;\n  int num;\n  void (*funcp)(void *data);\n  } my_struct_t;\n</code></pre>\n\n<p>Init function:</p>\n\n<pre><code>my_struct_t *init(int num, void (*my_funcp)(void *data)) {\n\n    // unimportant code to the problem, but basically just some mallocs for the other data\n\n  my_struct_t *my_str;\n  my_str-&gt;funcp = my_funcp;\n\n  return struct;\n}\n</code></pre>\n\n<p>function I want to point to:</p>\n\n<pre><code>void desired_func(my_type *obj) {}\n</code></pre>\n\n<p>my call to the init func:</p>\n\n<pre><code>init(5, desired_func);\n</code></pre>\n\n<p>full error:</p>\n\n<p>incompatible pointer types assigning to 'void (*)(void *)' from\n      'void (my_type *)'</p>\n\n<p>on the line in the init function above:     </p>\n\n<pre><code>my_struct_t *my_str;\nmy_str-&gt;funcp = my_funcp;\n</code></pre>\n"}, {"tags": ["c", "arrays", "greatest-common-divisor"], "comments": [{"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 3, "creation_date": 1468998772, "post_id": 38474610, "comment_id": 64352112, "body": "Make a separate function to calculate GCDs and use it. Give your variables actual names. With these two steps, your bug has a much better chance of being obvious or resolved."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 4, "creation_date": 1468999487, "post_id": 38474610, "comment_id": 64352575, "body": "You were mislead by the sample input, the GCD is not just the smallest element in the array. A better example would be this array with four elements: {6,9,21,15}. The expected output is: {2,3,7,5}."}, {"owner": {"reputation": 42446, "user_id": 902497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff13ece6277497484bfa2911c6183a30?s=128&d=identicon&r=PG", "display_name": "Raymond Chen", "link": "https://stackoverflow.com/users/902497/raymond-chen"}, "edited": false, "score": 4, "creation_date": 1468999511, "post_id": 38474610, "comment_id": 64352594, "body": "Please give your question a better title. &quot;What is wrong with this code?&quot; basically describes everything on this site. Another user with the same problem will have no way of finding this question."}], "answers": [{"tags": [], "owner": {"reputation": 4593, "user_id": 105104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02b23920ac852e946b333d3f9d0d95c1?s=128&d=identicon&r=PG", "display_name": "dvhh", "link": "https://stackoverflow.com/users/105104/dvhh"}, "is_accepted": false, "score": 0, "last_activity_date": 1469003370, "creation_date": 1469003370, "answer_id": 38476160, "question_id": 38474610, "link": "https://stackoverflow.com/questions/38474610/cutting-recipes-exercise-on-codechef/38476160#38476160", "title": "Cutting Recipes exercise on CodeChef", "body": "<p>You were on the right track thinking it was an exercise involving CGD ( greatest common divisor ). </p>\n\n<p>However you misunderstand on how to calculate the GCD.<br>\nit is rarely the smallest element of an array . </p>\n\n<p>For example:</p>\n\n<pre><code>15, 6, 9\n</code></pre>\n\n<p>The smallest element is <code>6</code> and is not a common divisor of the other element ( and would have chosen <code>1</code> as a divisor in your case ), but the gcd in this case is <code>3</code> </p>\n\n<p>You could start by reading some information about calculating the <a href=\"https://en.wikipedia.org/wiki/Greatest_common_divisor\" rel=\"nofollow\">CGD</a> of a pair of element. And one <a href=\"https://en.wikipedia.org/wiki/Binary_GCD_algorithm\" rel=\"nofollow\">example implementation</a>.</p>\n\n<p>Then try to figure out how to calculate the GCD of all the element of an array. </p>\n\n<p>These hints could help </p>\n"}], "owner": {"reputation": 15, "user_id": 6488203, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b42f5df712454dad7567d611347c1441?s=128&d=identicon&r=PG&f=1", "display_name": "underdog_eagle", "link": "https://stackoverflow.com/users/6488203/underdog-eagle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 416, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1469003370, "creation_date": 1468998693, "last_edit_date": 1469001876, "question_id": 38474610, "link": "https://stackoverflow.com/questions/38474610/cutting-recipes-exercise-on-codechef", "title": "Cutting Recipes exercise on CodeChef", "body": "<p>The following is <a href=\"https://www.codechef.com/viewsolution/10859412\" rel=\"nofollow\">my solution</a> to <a href=\"https://www.codechef.com/problems/RECIPE/\" rel=\"nofollow\">a problem on codechef</a>.<br>\nI am getting the correct output on my computer but not on codechef.<br>\nI couldn't find the mistake in my code. </p>\n\n<p>The problem is to divide an array by the GCD of its elements and print it.</p>\n\n<p>I wrote the following code :</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\nint main(void)\n{\n  int t,n;\n  scanf(\"%d\",&amp;t);\n\n  while(t--)\n  {\n    scanf(\"%d\",&amp;n);\n    int a[n],i,divisor,curr,r;\n\n    for(i=0;i&lt;n;i++)\n    {\n      scanf(\"%d\",&amp;a[i]);\n    }\n\n    divisor = a[0];\n    for(i=1;i&lt;n;i++)\n    {\n      curr = a[i];\n      if(curr&lt;divisor)\n      {\n        divisor = curr;\n      }\n    }\n\n    for(i=0;i&lt;n;i++)\n    {\n      r = a[i]%divisor;\n      if(r != 0){\n        divisor = 1;\n        break;\n      }\n    }\n\n    for(i=0;i&lt;n-1;i++)\n    {\n      printf(\"%d \",a[i]/divisor);\n    }\n\n    printf(\"%d\\n\",a[n-1]/divisor);\n\n  }\n\n  return 0;\n}\n</code></pre>\n\n<ul>\n<li><code>t</code> is the number of test cases.  </li>\n<li><code>n</code> is the length of the array.  </li>\n<li><code>a[n]</code> is the array.  </li>\n<li><code>divisor</code> is the GCD of all the elements in the array.  </li>\n<li><code>curr</code> is the current number tested.  </li>\n<li><code>r</code> is the remainder. </li>\n</ul>\n\n<p><em>Sample Input</em></p>\n\n<pre><code>3  \n2 4 4  \n3 2 3 4  \n4 3 15 9 6  \n</code></pre>\n\n<p><em>Sample Output</em></p>\n\n<pre><code>1 1  \n2 3 4  \n1 5 3 2   \n</code></pre>\n"}, {"tags": ["c", "clang"], "comments": [{"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 9, "creation_date": 1468998305, "post_id": 38474450, "comment_id": 64351795, "body": "Don&#39;t you think it would be a good idea to tell us exactly what the error is?"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 5, "creation_date": 1468998556, "post_id": 38474450, "comment_id": 64351953, "body": "Step 1: compile with <code>-Wall</code> and fix all of the warnings."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5894602, "user_type": "registered", "profile_image": "https://graph.facebook.com/1690000557925537/picture?type=large", "display_name": "Prudhvi Samayamanthula", "link": "https://stackoverflow.com/users/5894602/prudhvi-samayamanthula"}, "edited": false, "score": 0, "creation_date": 1469031148, "post_id": 38476525, "comment_id": 64373319, "body": "thank you so much it was the 2 one I missed. It worked now."}], "tags": [], "owner": {"reputation": 4593, "user_id": 105104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02b23920ac852e946b333d3f9d0d95c1?s=128&d=identicon&r=PG", "display_name": "dvhh", "link": "https://stackoverflow.com/users/105104/dvhh"}, "is_accepted": false, "score": 0, "last_activity_date": 1469004466, "creation_date": 1469004466, "answer_id": 38476525, "question_id": 38474450, "link": "https://stackoverflow.com/questions/38474450/getting-runtime-error-in-terminal-whereas-its-okay-in-xcode/38476525#38476525", "title": "getting runtime error in terminal whereas it&#39;s okay in xcode", "body": "<p>Looking at the code I can see some errors</p>\n\n<ol>\n<li>Check the return values of your <code>scanf</code> calls as they should <a href=\"http://linux.die.net/man/3/scanf\" rel=\"nofollow\">return the number of values parsed</a></li>\n<li><code>ans</code> is not guaranteed to be initialized to <code>0</code> it could be any value left there ( I would guess hat running it in Xcode or a debugger would have initialized it )</li>\n<li>Put curly braces around your conditional statement, you are a beginner and putting curly braces would help you read your own code.</li>\n</ol>\n"}], "owner": {"reputation": 1, "user_id": 5894602, "user_type": "registered", "profile_image": "https://graph.facebook.com/1690000557925537/picture?type=large", "display_name": "Prudhvi Samayamanthula", "link": "https://stackoverflow.com/users/5894602/prudhvi-samayamanthula"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1469004466, "creation_date": 1468998250, "last_edit_date": 1469003210, "question_id": 38474450, "link": "https://stackoverflow.com/questions/38474450/getting-runtime-error-in-terminal-whereas-its-okay-in-xcode", "title": "getting runtime error in terminal whereas it&#39;s okay in xcode", "body": "<p>the below one is my code in a competition, i just started to do these things. so when i compiled this in xcode it is fine but when i compiled it in terminal it is giving as error. can some one spot the error please.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\nint main()\n{\n    int n, i,count=0,ans,prev=0;\n    scanf(\"%d\",&amp;n);\n    int a[n];\n    for(i=0;i&lt;n;i++)\n    {\n        scanf(\"%d\",&amp;a[i]);\n    }\n    for(i=0;i&lt;n;i++)\n    {\n        if(a[i]==0)\n            ans++;\n        else if(a[i]==3)\n        {\n            if(i&gt;=1)\n            {if(a[i-1]==1||a[i-1]==2)\n                prev=a[i-1];\n            }\n            count++;\n        }\n        else if(a[i]==2||a[i]==1)\n        {if(i!=0){\n            if(a[i]!=prev&amp;&amp;((count-1)%2)==0)\n                ans++;\n            if(a[i]==prev&amp;&amp;(count%2)==0)\n                ans++;\n            prev=a[i];\n            count=0;}\n        }\n    }   \n    printf(\"%d\",ans);\n}\n</code></pre>\n"}, {"tags": ["c", "sockets", "tcp"], "comments": [{"owner": {"reputation": 764, "user_id": 2899478, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/juuUm.jpg?s=128&g=1", "display_name": "o_weisman", "link": "https://stackoverflow.com/users/2899478/o-weisman"}, "edited": false, "score": 2, "creation_date": 1468998122, "post_id": 38474228, "comment_id": 64351682, "body": "TCP is a connection based protocol, so basically if you close the connection the server will stop sending eventually."}, {"owner": {"reputation": 226, "user_id": 6595268, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1f42c05270975ada25de03c72834e8e?s=128&d=identicon&r=PG&f=1", "display_name": "x82", "link": "https://stackoverflow.com/users/6595268/x82"}, "edited": false, "score": 2, "creation_date": 1468998674, "post_id": 38474228, "comment_id": 64352044, "body": "What makes you think that server will continue to send the packets ? At the worst case scenario, when you closed the client socket your server will get a socket error while sending, and stop sending data. You are worrying too much about details for such a basic requirement."}, {"owner": {"reputation": 226, "user_id": 6595268, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1f42c05270975ada25de03c72834e8e?s=128&d=identicon&r=PG&f=1", "display_name": "x82", "link": "https://stackoverflow.com/users/6595268/x82"}, "edited": false, "score": 0, "creation_date": 1468999275, "post_id": 38474228, "comment_id": 64352443, "body": "Also , never think about using UDP for sending a file. UDP is unreliable meaning you don&#39;t even get a response about the packet arrived the destination or not. It&#39;s not an option."}, {"owner": {"reputation": 189, "user_id": 2233736, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/PW9m9.png?s=128&g=1", "display_name": "Tiago.SR", "link": "https://stackoverflow.com/users/2233736/tiago-sr"}, "edited": false, "score": 0, "creation_date": 1468999399, "post_id": 38474228, "comment_id": 64352528, "body": "I&#39;ve mentioned UDP because of protocols like QUIC and some other used for streaming..."}, {"owner": {"reputation": 226, "user_id": 6595268, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1f42c05270975ada25de03c72834e8e?s=128&d=identicon&r=PG&f=1", "display_name": "x82", "link": "https://stackoverflow.com/users/6595268/x82"}, "edited": false, "score": 0, "creation_date": 1468999524, "post_id": 38474228, "comment_id": 64352601, "body": "It can be used for streaming because streaming does not need reliable connection. Think about a live Tv Show. If a few packets are lost, not a problem at all, you just see some defects. But if even a single packet is lost in a file transfer, the file will be corrupt."}, {"owner": {"reputation": 189, "user_id": 2233736, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/PW9m9.png?s=128&g=1", "display_name": "Tiago.SR", "link": "https://stackoverflow.com/users/2233736/tiago-sr"}, "edited": false, "score": 0, "creation_date": 1468999847, "post_id": 38474228, "comment_id": 64352784, "body": "What if my application is receiving a video streaming and it notices that it is already stored on disk and want to stop uselessly receiving that video. Wouldn&#39;t it be possible because it&#39;s UDP based?"}, {"owner": {"reputation": 226, "user_id": 6595268, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1f42c05270975ada25de03c72834e8e?s=128&d=identicon&r=PG&f=1", "display_name": "x82", "link": "https://stackoverflow.com/users/6595268/x82"}, "edited": false, "score": 1, "creation_date": 1469000133, "post_id": 38474228, "comment_id": 64352952, "body": "Not easy to answer, because if you use UDP to transfer that file, you will have no mechanism to detect if something went wrong or not. So &quot;unnecessarily&quot; becomes out of context, you have no choice to continue the transfer."}], "answers": [{"comments": [{"owner": {"reputation": 189, "user_id": 2233736, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/PW9m9.png?s=128&g=1", "display_name": "Tiago.SR", "link": "https://stackoverflow.com/users/2233736/tiago-sr"}, "edited": false, "score": 0, "creation_date": 1469000177, "post_id": 38474631, "comment_id": 64352980, "body": "That&#39;s nice. I don&#39;t know TCP so deeply. Thanks. About that nonsense: maybe it was about UDP and I didn&#39;t noticed..."}, {"owner": {"reputation": 189, "user_id": 2233736, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/PW9m9.png?s=128&g=1", "display_name": "Tiago.SR", "link": "https://stackoverflow.com/users/2233736/tiago-sr"}, "edited": false, "score": 0, "creation_date": 1469000385, "post_id": 38474631, "comment_id": 64353111, "body": "About TCP Flow Control: that means that if I slow down transfer speed (by reducing <code>recv()</code> calls with <code>sleep()</code>) too much, is there a risk of connection get closed? Or does this applies only to entirely stop calling <code>recv()</code>?"}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "reply_to_user": {"reputation": 189, "user_id": 2233736, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/PW9m9.png?s=128&g=1", "display_name": "Tiago.SR", "link": "https://stackoverflow.com/users/2233736/tiago-sr"}, "edited": false, "score": 1, "creation_date": 1469000663, "post_id": 38474631, "comment_id": 64353303, "body": "If you receive slower than the sender is sending, the sender will eventually get blocked if he&#39;s in blocking mode, or EAGAIN/EWOULDBLOCK if he&#39;s in non-blocking mode. That includes the case of not receiving at all."}], "tags": [], "owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "is_accepted": true, "score": 1, "last_activity_date": 1468998752, "creation_date": 1468998752, "answer_id": 38474631, "question_id": 38474228, "link": "https://stackoverflow.com/questions/38474228/interrupt-download-recv-of-a-file-through-socket/38474631#38474631", "title": "Interrupt download (recv) of a file through socket", "body": "<blockquote>\n  <p>I read somewhere that <code>close(fd)</code> or <code>shutdown(fd, SHUT_RD</code>) won't actually stop download as server will continue to <code>send()</code> file and this will continue to consume network bandwidth.</p>\n</blockquote>\n\n<p>If you <code>shutdown(fd, SHUT_RD)</code> your own <code>recv()</code> will unblock with a return code of zero, which will cause the code to close the socket, which will cause the localhost to issue an RST if any more data comes from the peer, which will cause an ECONNRESET at the sender (after a few more <code>send()</code> calls, not necessarily immediately).</p>\n\n<p>Where did you read this nonsense? </p>\n\n<blockquote>\n  <p>I became even more doubtful about if stop calling <code>recv()</code> would solve it</p>\n</blockquote>\n\n<p>It won't solve it, but it will eventually stop the sender from sending, because of TCP flow control. It isn't a solution to this problem.</p>\n"}], "owner": {"reputation": 189, "user_id": 2233736, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/PW9m9.png?s=128&g=1", "display_name": "Tiago.SR", "link": "https://stackoverflow.com/users/2233736/tiago-sr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "accepted_answer_id": 38474631, "answer_count": 1, "score": -1, "last_activity_date": 1469042536, "creation_date": 1468997502, "last_edit_date": 1469042536, "question_id": 38474228, "link": "https://stackoverflow.com/questions/38474228/interrupt-download-recv-of-a-file-through-socket", "title": "Interrupt download (recv) of a file through socket", "body": "<p>In an application I'm currently working on, I need to stop downloading some file if I realize it's not what I'm looking for. The protocol doesn't provide any way to know it before I start receiving the file (like headers or so).</p>\n\n<p>As an example, in some cases I might be looking for a file of exactly X bytes in size, but after I have downloaded X bytes and I keep getting more bytes, this is not the file I'm looking for as its size is greater than X. In this case, I want to stop downloading to free network bandwidth resources. The protocol doesn't provide any way to notify the server about this.</p>\n\n<p>I read somewhere that <code>close(fd)</code> or <code>shutdown(fd, SHUT_RD)</code> won't actually stop downloading as the server will continue to <code>send()</code> the file and this will continue to consume network bandwidth. I am also not sure about if I just stop calling <code>recv()</code> and packets still arrive, will they fill the buffer and then start to be discarded?  If it matters, the protocol used is based on TCP (but I would like some solution that can also be used for UDP based protocols).</p>\n\n<p>I became even more doubtful that stopping calls to <code>recv()</code> would solve it, after I searched for programmatic bandwidth control (<code>sleep()</code>, token bucket..) as an alternative solution (reduce download speed to about zero after I realize it's not the file I'm looking for). How can I control network bandwidth usage by reducing <code>recv()</code> calls if the server will still be <code>send()</code>ing? I didn't catch it.</p>\n\n<p>Main idea is to entirely stop the download.</p>\n\n<p>What would you suggest?</p>\n"}, {"tags": ["c", "formula"], "comments": [{"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 2, "creation_date": 1468996417, "post_id": 38473828, "comment_id": 64350652, "body": "You should provide: input, expected output, actual output"}, {"owner": {"reputation": 1, "user_id": 6575981, "user_type": "registered", "profile_image": "https://graph.facebook.com/1116874391718708/picture?type=large", "display_name": "Xavier Speropoulos", "link": "https://stackoverflow.com/users/6575981/xavier-speropoulos"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1468996528, "post_id": 38473828, "comment_id": 64350718, "body": "my buyPrice input was 20 1/2, my sellPrice was 40 1/2, so I expected an output for the APPLE stock to be 49% gain and it was actually 0.49%. I expected the total gainloss to also be 49% and it turned out to be .49%. The average should also be 49% because there was only one input but ended up being 2.03%"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 1, "creation_date": 1468996560, "post_id": 38473828, "comment_id": 64350746, "body": "To me this looks strange <code>return 1 - (buyPrice &#47; sellPrice);</code> So if you sell for 1.000.000 times more than buy, the GainLoss will be close to 1. Is that what you want?"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1468996621, "post_id": 38473828, "comment_id": 64350783, "body": "And &quot;sell price&quot; was ....?"}, {"owner": {"reputation": 1, "user_id": 6575981, "user_type": "registered", "profile_image": "https://graph.facebook.com/1116874391718708/picture?type=large", "display_name": "Xavier Speropoulos", "link": "https://stackoverflow.com/users/6575981/xavier-speropoulos"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1468996747, "post_id": 38473828, "comment_id": 64350871, "body": "well the formula my professor gave me to define gain was g = 1-(sellprice / buyprice) but that was giving me a negative value when it should have been a positive and the other way around also."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1468997182, "post_id": 38473828, "comment_id": 64351109, "body": "ok, I&#39;m not into the formulas used for calculating GainLoss  - I&#39;m also surprised that totalGainLoss can be calculated just by adding the individual GainLoss. But as I said - it&#39;s not my area so it may be correct. Anyway: For the 49% versus 0.49% it&#39;s just a matter of multiplying by 100. A number is not a percentage until you have multipled by 100."}, {"owner": {"reputation": 1, "user_id": 6575981, "user_type": "registered", "profile_image": "https://graph.facebook.com/1116874391718708/picture?type=large", "display_name": "Xavier Speropoulos", "link": "https://stackoverflow.com/users/6575981/xavier-speropoulos"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1468997297, "post_id": 38473828, "comment_id": 64351178, "body": "ok so <a href=\"https://gyazo.com/f14423bf52f3a8e08e3f80930cc4233a\" rel=\"nofollow noreferrer\">gyazo.com/f14423bf52f3a8e08e3f80930cc4233a</a> that works for the total gainloss but the average is .01% is that correct?"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1468997489, "post_id": 38473828, "comment_id": 64351289, "body": "Should <code>numOfTransactions &#47; totGainLoss</code>be <code>totGainLoss &#47; numOfTransactions</code> ?"}, {"owner": {"reputation": 1, "user_id": 6575981, "user_type": "registered", "profile_image": "https://graph.facebook.com/1116874391718708/picture?type=large", "display_name": "Xavier Speropoulos", "link": "https://stackoverflow.com/users/6575981/xavier-speropoulos"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1468998174, "post_id": 38473828, "comment_id": 64351727, "body": "yes you are correct. that worked on the change. thanks!"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1468998493, "post_id": 38473828, "comment_id": 64351912, "body": "I&#39;m not sure but I would expect: <code>gain = (sellprice - buyprice) &#47; buyprice</code> which is the same as <code>gain = sellprice &#47; buyprice - 1</code>. Are you sure you got the correct formula?"}, {"owner": {"reputation": 1, "user_id": 6575981, "user_type": "registered", "profile_image": "https://graph.facebook.com/1116874391718708/picture?type=large", "display_name": "Xavier Speropoulos", "link": "https://stackoverflow.com/users/6575981/xavier-speropoulos"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1468998666, "post_id": 38473828, "comment_id": 64352038, "body": "<a href=\"https://gyazo.com/f14423bf52f3a8e08e3f80930cc4233a\" rel=\"nofollow noreferrer\">gyazo.com/f14423bf52f3a8e08e3f80930cc4233a</a> with                100-(buyPrice/sellPrice), these are correct values right?"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1468998791, "post_id": 38473828, "comment_id": 64352127, "body": "do <code>return 100 * (1 - (buyPrice &#47; sellPrice));</code> (but I still think your formula must be wrong)"}, {"owner": {"reputation": 6595, "user_id": 5218277, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ZuEZa.jpg?s=128&g=1", "display_name": "Alex Lop.", "link": "https://stackoverflow.com/users/5218277/alex-lop"}, "edited": false, "score": 0, "creation_date": 1468998968, "post_id": 38473828, "comment_id": 64352245, "body": "The gain/loss percentage should be calculated like this: <code>((sellprice&#47;buyprice) - 1)*100</code> and total gain/loss is: <code>((totalSellPrices&#47;totalBuyPrices) - 1)*100</code>"}, {"owner": {"reputation": 1, "user_id": 6575981, "user_type": "registered", "profile_image": "https://graph.facebook.com/1116874391718708/picture?type=large", "display_name": "Xavier Speropoulos", "link": "https://stackoverflow.com/users/6575981/xavier-speropoulos"}, "edited": false, "score": 0, "creation_date": 1468999069, "post_id": 38473828, "comment_id": 64352315, "body": "<a href=\"https://gyazo.com/745a4187c6531c57a64a70f64671b70c\" rel=\"nofollow noreferrer\">gyazo.com/745a4187c6531c57a64a70f64671b70c</a> that isnt correct cause if i double my money thats 100% gain not 50% i think my original was correct at return 100 - (buyPrice / sellPrice);"}, {"owner": {"reputation": 1, "user_id": 6575981, "user_type": "registered", "profile_image": "https://graph.facebook.com/1116874391718708/picture?type=large", "display_name": "Xavier Speropoulos", "link": "https://stackoverflow.com/users/6575981/xavier-speropoulos"}, "reply_to_user": {"reputation": 6595, "user_id": 5218277, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ZuEZa.jpg?s=128&g=1", "display_name": "Alex Lop.", "link": "https://stackoverflow.com/users/5218277/alex-lop"}, "edited": false, "score": 0, "creation_date": 1468999283, "post_id": 38473828, "comment_id": 64352450, "body": "@AlexLop. so for the total gain/loss do i need to input that somewhere in my code? if so where lol"}, {"owner": {"reputation": 6595, "user_id": 5218277, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ZuEZa.jpg?s=128&g=1", "display_name": "Alex Lop.", "link": "https://stackoverflow.com/users/5218277/alex-lop"}, "edited": false, "score": 0, "creation_date": 1468999441, "post_id": 38473828, "comment_id": 64352548, "body": "Instead of <code>totGainLoss= totGainLoss + gainLoss;</code> do it separately for <code>sellprice</code> and <code>buyprice</code>. and calculate the <code>totalGainLoss</code> at the end"}, {"owner": {"reputation": 6595, "user_id": 5218277, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ZuEZa.jpg?s=128&g=1", "display_name": "Alex Lop.", "link": "https://stackoverflow.com/users/5218277/alex-lop"}, "edited": false, "score": 0, "creation_date": 1468999532, "post_id": 38473828, "comment_id": 64352606, "body": "Let me know if you want me to summarize all my comments in one answer to your question."}, {"owner": {"reputation": 1, "user_id": 6575981, "user_type": "registered", "profile_image": "https://graph.facebook.com/1116874391718708/picture?type=large", "display_name": "Xavier Speropoulos", "link": "https://stackoverflow.com/users/6575981/xavier-speropoulos"}, "reply_to_user": {"reputation": 6595, "user_id": 5218277, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ZuEZa.jpg?s=128&g=1", "display_name": "Alex Lop.", "link": "https://stackoverflow.com/users/5218277/alex-lop"}, "edited": false, "score": 0, "creation_date": 1468999596, "post_id": 38473828, "comment_id": 64352635, "body": "@AlexLop. im more confused on when you say separate them. i dont think i really know how to start something like that ha i was only really told this way."}], "answers": [{"tags": [], "owner": {"reputation": 6595, "user_id": 5218277, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ZuEZa.jpg?s=128&g=1", "display_name": "Alex Lop.", "link": "https://stackoverflow.com/users/5218277/alex-lop"}, "is_accepted": false, "score": -1, "last_activity_date": 1469000409, "last_edit_date": 1469000409, "creation_date": 1469000107, "answer_id": 38475080, "question_id": 38473828, "link": "https://stackoverflow.com/questions/38473828/calculating-total-and-average-of-stock-information/38475080#38475080", "title": "calculating total and average of stock information", "body": "<p>The gain/loss percentage should be calculated like this: <code>((sellprice/buyprice) - 1)*100</code> --&lt;<em>make sure <code>buyprice</code> is not 0!</em>>-- and total gain/loss is: <code>((totalSellPrices/totalBuyPrices) - 1)*100</code>.</p>\n\n<p>To do so, just modify a little your main loop:</p>\n\n<pre><code>float totalBuyPrice = 0.0f;\nfloat totalSellPrice = 0.0f;\ndo{\n    getInputs(ticker,&amp;buyPrice,&amp;sellPrice); //call 3.1/.1\n    gainLoss=calcGainLoss(buyPrice,sellPrice); //call 3.2\n    showTransactionReport(ticker,gainLoss); //call 3.3\n    //totGainLoss= totGainLoss + gainLoss;\n    totalBuyPrice += buyPrice;\n    totalSellPrice += sellPrice;\n    numOfTransactions++;\n    printf(\"Would you like to do another transaction? (Y/y or N/n) ==&gt; \");\n    fflush(stdin);\n    scanf(\" %c\", &amp;answer);\n}while (answer == 'Y' || answer == 'y');\n</code></pre>\n\n<p>then in <code>showSummaryReport</code> do the appropriate changes:</p>\n\n<pre><code>void showSummaryReport(float totalBuyPrice, float totalSellPrice, int numOfTransactions)\n{\n    float totGainLoss = 0.0f;\n    if (totalBuyPrice)\n    {\n        totGainLoss = (totalSellPrice/totalBuyPrice - 1)*100;\n    }\n    printf(\"Total Gain/Loss:                %10.2f %% \\n\",totGainLoss);\n    printf(\"Average Gain/Loss:              %10.2f %% \\n\",totGainLoss / numOfTransactions);\n}\n</code></pre>\n\n<p>Of course don't forget to update the functions and variable declarations.</p>\n"}], "owner": {"reputation": 1, "user_id": 6575981, "user_type": "registered", "profile_image": "https://graph.facebook.com/1116874391718708/picture?type=large", "display_name": "Xavier Speropoulos", "link": "https://stackoverflow.com/users/6575981/xavier-speropoulos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1469000409, "creation_date": 1468996156, "last_edit_date": 1468999323, "question_id": 38473828, "link": "https://stackoverflow.com/questions/38473828/calculating-total-and-average-of-stock-information", "title": "calculating total and average of stock information", "body": "<p>So i have my program up and running but I am not getting the correct values that I should be. \n<a href=\"https://i.stack.imgur.com/GNlVS.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/GNlVS.png\" alt=\"Here is the report\"></a> </p>\n\n<p>I am trying to get 49% instead of .49% and the average is also messed up? Is this just a simple messup on formulas or am i totally screwed? really confused and actually glad i got to this point but am feeling really stuck. any help would be greatful.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n//prototypes\nvoid getInputs(char*ticker,float*buyPrice,float*sellPrice);         //3.1\nfloat getPrice(int whole,int num,int dem);                          //3.1.1\nfloat calcGainLoss(float buyPrice,float sellPrice);                 //3.2\nvoid showTransactionReport(char ticker[],float gainLoss);           //3.3\nvoid showSummaryReport(float totGainLoss,int numOfTransactions);    //3.4\n\nint main(void)\n{\n    char ticker[15];\n    float gainLoss;\n    float buyPrice;\n    float sellPrice;\n    float totGainLoss=0;\n    int numOfTransactions=0;\n    char answer;\n    do{\n        getInputs(ticker,&amp;buyPrice,&amp;sellPrice); //call 3.1/.1\n        gainLoss=calcGainLoss(buyPrice,sellPrice); //call 3.2\n        showTransactionReport(ticker,gainLoss); //call 3.3\n        totGainLoss= totGainLoss + gainLoss;\n        numOfTransactions++;\n        printf(\"Would you like to do another transaction? (Y/y or N/n) ==&gt; \");\n        fflush(stdin);\n        scanf(\" %c\", &amp;answer);\n    }while (answer == 'Y' || answer == 'y');\n\n    showSummaryReport(totGainLoss,numOfTransactions);\n\n    fflush(stdin);\n    getchar();\n    return 0;\n}\n//function 3.1\nvoid getInputs(char*ticker,float*buyPrice,float*sellPrice)\n{\n    int whole=0;\n    int num=0;\n    int dem=0;\n    printf(\"Enter the stock ticker ==&gt; \");\n    scanf(\"%s\",ticker);\n    printf(\"Input buy price of %s ==&gt; \",ticker);\n    scanf(\"%d %d/%d\",&amp;whole,&amp;num,&amp;dem);\n    *buyPrice=getPrice(whole,num,dem);\n    printf(\"Input sell price==&gt; \");\n    scanf(\"%d %d/%d\",&amp;whole,&amp;num,&amp;dem);\n    *sellPrice=getPrice(whole,num,dem);\n}\nfloat getPrice(int whole,int num,int dem)\n{\n    return whole + float(num) / float(dem);\n}\nfloat calcGainLoss(float buyPrice,float sellPrice)\n{\n    return 1 - (buyPrice / sellPrice);\n}\nvoid showTransactionReport(char ticker[0],float gainLoss)\n{\n    printf(\"Stock Description               Gain/Loss%\\n\");\n    printf(\"=================               ==========\\n\");\n    printf(\"%-17s               %10.2f %% \\n\",ticker,gainLoss);\n}\nvoid showSummaryReport(float totGainLoss,int numOfTransactions)\n{\n    printf(\"Total Gain/Loss:                %10.2f %% \\n\",totGainLoss);\n    printf(\"Average Gain/Loss:              %10.2f %% \\n\",numOfTransactions / totGainLoss);\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 4224, "user_id": 3383213, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/91b489041a73ecbb02cc26af19b5f664?s=128&d=identicon&r=PG&f=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/3383213/himanshu"}, "edited": false, "score": 0, "creation_date": 1468995828, "post_id": 38473661, "comment_id": 64350334, "body": "Kindly Explain what problem you are getting."}, {"owner": {"reputation": 13, "user_id": 6575010, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-bY7MEgPIrF0/AAAAAAAAAAI/AAAAAAAAABY/Q1AYRc5fbRA/photo.jpg?sz=128", "display_name": "Cragger", "link": "https://stackoverflow.com/users/6575010/cragger"}, "reply_to_user": {"reputation": 4224, "user_id": 3383213, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/91b489041a73ecbb02cc26af19b5f664?s=128&d=identicon&r=PG&f=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/3383213/himanshu"}, "edited": false, "score": 0, "creation_date": 1468995904, "post_id": 38473661, "comment_id": 64350371, "body": "the code is running but when i give range like (50 t0 200) nothing happens in the output screen. it just take the input and is over. no errors nothing it just stays there."}, {"owner": {"reputation": 4224, "user_id": 3383213, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/91b489041a73ecbb02cc26af19b5f664?s=128&d=identicon&r=PG&f=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/3383213/himanshu"}, "edited": false, "score": 0, "creation_date": 1468996940, "post_id": 38473661, "comment_id": 64350964, "body": "Abhi change <code>i=j;</code> to <code>j=i;</code> in for loop."}, {"owner": {"reputation": 13, "user_id": 6575010, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-bY7MEgPIrF0/AAAAAAAAAAI/AAAAAAAAABY/Q1AYRc5fbRA/photo.jpg?sz=128", "display_name": "Cragger", "link": "https://stackoverflow.com/users/6575010/cragger"}, "reply_to_user": {"reputation": 4224, "user_id": 3383213, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/91b489041a73ecbb02cc26af19b5f664?s=128&d=identicon&r=PG&f=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/3383213/himanshu"}, "edited": false, "score": 0, "creation_date": 1468997546, "post_id": 38473661, "comment_id": 64351332, "body": "@Himanshu thanks man."}], "answers": [{"tags": [], "owner": {"reputation": 4224, "user_id": 3383213, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/91b489041a73ecbb02cc26af19b5f664?s=128&d=identicon&r=PG&f=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/3383213/himanshu"}, "is_accepted": true, "score": 0, "last_activity_date": 1468997504, "last_edit_date": 1468997504, "creation_date": 1468996707, "answer_id": 38473980, "question_id": 38473661, "link": "https://stackoverflow.com/questions/38473661/display-the-armstrong-number-between-the-range-specified-by-users-using-function/38473980#38473980", "title": "display the armstrong number between the range specified by users using function..some advice in this please to get the result", "body": "<p>you have done 1 mistake in your code.</p>\n\n<p>In for loop you need to assign value of <code>i</code> to <code>j</code> i.e <code>j = i</code></p>\n\n<p>But you are doing reverse, that is the problem.</p>\n\n<p>Use <code>j=i;</code> instead of <code>i=j;</code></p>\n"}], "owner": {"reputation": 13, "user_id": 6575010, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-bY7MEgPIrF0/AAAAAAAAAAI/AAAAAAAAABY/Q1AYRc5fbRA/photo.jpg?sz=128", "display_name": "Cragger", "link": "https://stackoverflow.com/users/6575010/cragger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 157, "favorite_count": 0, "accepted_answer_id": 38473980, "answer_count": 1, "score": 0, "last_activity_date": 1468997504, "creation_date": 1468995576, "last_edit_date": 1468995836, "question_id": 38473661, "link": "https://stackoverflow.com/questions/38473661/display-the-armstrong-number-between-the-range-specified-by-users-using-function", "title": "display the armstrong number between the range specified by users using function..some advice in this please to get the result", "body": "<p>////program to display armstrong numbers in given range by user and display their counts::::use of function and display from the main/////</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;conio.h&gt;\nint arm(int );\nvoid main()\n{\n    int a,b,i,x,c=0,j;\n    printf(\"enter the range\\n\");\n    scanf(\"%d%d\",&amp;a,&amp;b);\n    for(i=a;i&lt;b;i++)                                        ///loop to transfer all the number of range to function arm/////\n    {\n        i=j;\n        x=arm(j);                                           //calling function//\n        if(x==i)\n        {\n            printf(\"%d\\t\",x);                               ///printing armstrong numbers///\n            c++;                                            ///counting armstrong numbers/// \n        }\n    }\n    printf(\"the number of armstrong numbers is:%d\",c);      ///printing counts//\n}\n</code></pre>\n\n<hr>\n\n<pre><code>int arm(int j)                                               \n{\n    int sum=0,z;\n    while(j&gt;0)                                              ///armstrong number process loop///\n    {\n        z=j%10;\n        sum=sum+z*z*z;\n        j=j/10;\n    }\n    return sum;                                             ///return the value of sum obtained from while loop//\n}\n</code></pre>\n"}, {"tags": ["c", "dll", "visual-studio-2015"], "comments": [{"owner": {"reputation": 14710, "user_id": 5538420, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/oc81s.jpg?s=128&g=1", "display_name": "dxiv", "link": "https://stackoverflow.com/users/5538420/dxiv"}, "edited": false, "score": 0, "creation_date": 1468997236, "post_id": 38473382, "comment_id": 64351146, "body": "<code>__declspec(dllimport)</code> expects the function to have been exported with <code>__declspec(dllexport)</code> in the <code>DLL</code> whose import library <code>mydll.lib</code> you link to. Was it? Please post the complete, minimal code that reproduces the problem."}, {"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1469000632, "post_id": 38473382, "comment_id": 64353283, "body": "These declarations belong in a .h file.  That was also used to build the DLL.  When you start typing them yourself then the odds for mishaps dramatically increase.  Use Dumpbin.exe /exports on the .lib file and the DLL to get exported names, a basic check to verify that you are on the right track."}], "answers": [{"comments": [{"owner": {"reputation": 5956, "user_id": 1249472, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e7d2ac9163237829d11cbf4ee7d563d?s=128&d=identicon&r=PG", "display_name": "Nikita", "link": "https://stackoverflow.com/users/1249472/nikita"}, "reply_to_user": {"reputation": 14710, "user_id": 5538420, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/oc81s.jpg?s=128&g=1", "display_name": "dxiv", "link": "https://stackoverflow.com/users/5538420/dxiv"}, "edited": false, "score": 0, "creation_date": 1468998090, "post_id": 38474279, "comment_id": 64351667, "body": "@dxiv you right, it&#39;s ambiguous parameter, incorrectly copied from VS Command Line. I will remove it"}, {"owner": {"reputation": 297, "user_id": 3533030, "user_type": "registered", "accept_rate": 9, "profile_image": "https://graph.facebook.com/100003244312143/picture?type=large", "display_name": "user3533030", "link": "https://stackoverflow.com/users/3533030/user3533030"}, "edited": false, "score": 0, "creation_date": 1469028313, "post_id": 38474279, "comment_id": 64371379, "body": "That&#39;s it.  The name was mangled by C++.  Everything is working smoothly now.  Thanks!"}], "tags": [], "owner": {"reputation": 5956, "user_id": 1249472, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e7d2ac9163237829d11cbf4ee7d563d?s=128&d=identicon&r=PG", "display_name": "Nikita", "link": "https://stackoverflow.com/users/1249472/nikita"}, "is_accepted": false, "score": 1, "last_activity_date": 1469002927, "last_edit_date": 1469002927, "creation_date": 1468997702, "answer_id": 38474279, "question_id": 38473382, "link": "https://stackoverflow.com/questions/38473382/debugging-a-dll-for-c-w-visual-studio-2015/38474279#38474279", "title": "Debugging a DLL for C w/Visual Studio 2015", "body": "<p>Your dll import looks fine.</p>\n\n<p>Check the name of the exported function. Good tool for this task is \"<a href=\"http://www.dependencywalker.com/\" rel=\"nofollow\">Dependency Walker</a>\". If your dll compiled as C++, function name can be <a href=\"http://www.geeksforgeeks.org/extern-c-in-c/\" rel=\"nofollow\">mangled</a>. To prevent name mangling your export definition in DLL project should be:</p>\n\n<pre><code>extern \"C\" __declspec(dllexport) int UserDefinedSurface4(USER_DATA *UD, FIXED_DATA4 *FD);\n</code></pre>\n\n<p>In your application specify Linker -> Additional Library Directories to your library directory and in Linker -> Input specify additional dependency <strong>mydll.lib</strong>. After that check Linker -> Command Line parameter, it should contains:</p>\n\n<pre><code>\"mydll.lib\" /LIBPATH:\"d:\\yourlibrarydir\\\"\n</code></pre>\n"}], "owner": {"reputation": 297, "user_id": 3533030, "user_type": "registered", "accept_rate": 9, "profile_image": "https://graph.facebook.com/100003244312143/picture?type=large", "display_name": "user3533030", "link": "https://stackoverflow.com/users/3533030/user3533030"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1469002927, "creation_date": 1468994429, "question_id": 38473382, "link": "https://stackoverflow.com/questions/38473382/debugging-a-dll-for-c-w-visual-studio-2015", "title": "Debugging a DLL for C w/Visual Studio 2015", "body": "<p>I'm writing a DLL for an existing application.  The DLL is designed to interface to commercial software who's functionality can be enhanced by adding a user defined feature with a DLL.</p>\n\n<p>My DLL compiles and the application can utilize the features, but I want to debug it.  It is difficult for me to attach to the process and debug when the commercial software is calling the DLL.  Instead, I'd like to build separate code to test the DLL.</p>\n\n<p>All the examples I can find w/DLL's are for C# or C++.  I can't quite understand how to do this in C.  I seem to be stuck at importing the DLL or referencing the library in the linker.</p>\n\n<p>I've inserted:</p>\n\n<pre><code>__declspec(dllimport) int UserDefinedSurface4(USER_DATA *UD, FIXED_DATA4 *FD);\n</code></pre>\n\n<p>but I get:</p>\n\n<pre><code>LNK2019 unresolved external symbol \"__declspec(dllimport) int __cdecl UserDefinedSurface4(struct USER_DATA *,struct FIXED_DATA4 *)\" (__imp_?UserDefinedSurface4@@YAHPEAUUSER_DATA@@PEAUFIXED_DATA4@@@Z)\n</code></pre>\n\n<p>Following advice for C# and C++, I've added a path to the DLL in my project using:  Properties->Linker->Input->Additional Dependencies with an explicit path:  \"D:......\\mydll.lib\" (<em>that seems kind of brittle... is this right or should I use a relative path or ...?</em>)</p>\n\n<p>Furthermore, I also inserted:</p>\n\n<pre><code>#pragma comment(lib, \"D:\\\\...\\\\mydll.lib\")\n</code></pre>\n\n<p>and I have included the project with the DLL in my references.  What's missing?</p>\n"}, {"tags": ["c", "gcc", "macros", "cmake"], "comments": [{"owner": {"reputation": 16953, "user_id": 2799037, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2uPVa.png?s=128&g=1", "display_name": "usr1234567", "link": "https://stackoverflow.com/users/2799037/usr1234567"}, "edited": false, "score": 2, "creation_date": 1468996961, "post_id": 38473253, "comment_id": 64350978, "body": "You can use <code>config_file</code>. Check <a href=\"http://stackoverflow.com/questions/38419876/cmake-generate-config-h-like-from-autoconf/38423317#38423317\" title=\"cmake generate config h like from autoconf\">stackoverflow.com/questions/38419876/&hellip;</a> and <a href=\"http://stackoverflow.com/questions/647892/cmake-how-to-check-header-files-and-library-functions-like-in-autotools\" title=\"cmake how to check header files and library functions like in autotools\">stackoverflow.com/questions/647892/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 6611918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7505fa20d6d91ef58f5fb851bc811cc8?s=128&d=identicon&r=PG&f=1", "display_name": "A. Moran", "link": "https://stackoverflow.com/users/6611918/a-moran"}, "edited": false, "score": 0, "creation_date": 1469021152, "post_id": 38476954, "comment_id": 64367310, "body": "Thanks! For my use case the third option will do the trick. The main purpose was to make config file &#39;readable&#39; so I wanted to avoid the use #define or #cmakedefine ."}], "tags": [], "owner": {"reputation": 7497, "user_id": 1213227, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/78179ef730f268752c0f6fdde3943b99?s=128&d=identicon&r=PG", "display_name": "Matthias", "link": "https://stackoverflow.com/users/1213227/matthias"}, "is_accepted": true, "score": 0, "last_activity_date": 1469023332, "last_edit_date": 1469023332, "creation_date": 1469005711, "answer_id": 38476954, "question_id": 38473253, "link": "https://stackoverflow.com/questions/38473253/define-preprocessor-macros-in-a-config-file/38476954#38476954", "title": "Define preprocessor macros in a .config file", "body": "<p>I see at least three possibilities:</p>\n\n<ol>\n<li><p>Write your config file in the style of a normal header file and include it, i.e.</p>\n\n<pre><code>#define CONFIG_MACRO_A y\n#define CONFIG_MACRO_B y\n//#define CONFIG_MACRO_C # C is not set\n#define CONFIG_MACRO_D y\n</code></pre></li>\n<li><p>Use the config file mechanism as @usr1234567 suggested.</p></li>\n<li><p>Use shell processing in your compiler call (i.e., in the <code>makefile</code>), e.g. for bash:</p>\n\n<pre><code>gcc $(CFLAGS) `while read mac;  do echo -n \"-D$mac \"; done &lt; &lt;( grep -v \"#\" mymacro ) ` $(TARGET)\n</code></pre></li>\n</ol>\n"}], "owner": {"reputation": 21, "user_id": 6611918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7505fa20d6d91ef58f5fb851bc811cc8?s=128&d=identicon&r=PG&f=1", "display_name": "A. Moran", "link": "https://stackoverflow.com/users/6611918/a-moran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1294, "favorite_count": 0, "accepted_answer_id": 38476954, "answer_count": 1, "score": -1, "last_activity_date": 1469023332, "creation_date": 1468993954, "question_id": 38473253, "link": "https://stackoverflow.com/questions/38473253/define-preprocessor-macros-in-a-config-file", "title": "Define preprocessor macros in a .config file", "body": "<p>I'm coding in C using CMake and I would like to define sobre preprocessor macros in a separate file. The purpose of this is to have a main configuration file for my apps.</p>\n\n<p>I was tinking in doing something similar to the kernel .config files, but I didn't find how to pass a file with definitions to the compiler. I know the option -D of gcc to define a single macro, but it does not accept files as imput. I also know the ADD_DEFINITIONS utility of CMake but the usage but it is also expected to be used with a certain amount of macros, not a file.</p>\n\n<p>Summarizing, I would like to define a file .config with macro definitions:</p>\n\n<pre><code>CONFIG_MACRO_A=y\nCONFIG_MACRO_B=y\n# CONFIG_MACRO_C is not set\nCONFIG_MACRO_C=y\n</code></pre>\n\n<p>And employ each line as a preprocessor macro in compilation time.</p>\n\n<p>Thank you so much for the help.</p>\n"}, {"tags": ["c", "memory-management", "data-structures", "linked-list", "free"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1468993925, "post_id": 38473190, "comment_id": 64349433, "body": "Welcome to Stack Overflow.  Please read the <a href=\"https://stackoverflow.com/tour\">About</a> page soon and about how to create an MCVE (<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>) sooner.  You&#39;ve not shown us the definitions of the structure types.  Why do you need to free anything?  When you merge the two lists, each item in each of the lists should be in the result list, so none of the items should be freed.  If there&#39;s some sort of &#39;list head&#39; structure (there seems to be: you have <code>struct llist</code> and <code>struct llnode</code> types), the two old list head structures may need to be freed, but that&#39;s all."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1468994421, "post_id": 38473190, "comment_id": 64349640, "body": "What do you mean by &quot;<i>but I&#39;m not allowed to do that</i>&quot;?"}, {"owner": {"reputation": 77, "user_id": 2359693, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/fab08b10751a723dba2375be713215aa?s=128&d=identicon&r=PG", "display_name": "Bardia", "link": "https://stackoverflow.com/users/2359693/bardia"}, "edited": false, "score": 0, "creation_date": 1468994543, "post_id": 38473190, "comment_id": 64349698, "body": "the rules of the assignment don&#39;t allow us to leave useless memory un-free&#39;d. we have to free any unnecessary variable and pointer"}, {"owner": {"reputation": 4593, "user_id": 105104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02b23920ac852e946b333d3f9d0d95c1?s=128&d=identicon&r=PG", "display_name": "dvhh", "link": "https://stackoverflow.com/users/105104/dvhh"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1468994545, "post_id": 38473190, "comment_id": 64349700, "body": "@melpomene my guess would be that he need to reuse the node of the 2 inptu list in the destination list, and not create new ones"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1468994576, "post_id": 38473190, "comment_id": 64349715, "body": "You&#39;re not allowed to free either <code>tempsrc</code> or <code>tempdest</code> because they are not allocated by your code.  They are merely temporary pointers to items in the list.  If you free either of them, you will break things.  Please get <a href=\"http://valgrind.org/\" rel=\"nofollow noreferrer\"><code>valgrind</code></a> if at all possible and use it.  It will help you see the error of your ways.  By the end, you will need to ensure that <code>src1-&gt;front</code> is a null pointer, and that <code>src2-&gt;front</code> is a null pointer.  But that&#39;s all."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 3, "creation_date": 1468994585, "post_id": 38473190, "comment_id": 64349722, "body": "Your function doesn&#39;t <code>malloc</code> anything so I don&#39;t understand what you think you need to <code>free</code>."}, {"owner": {"reputation": 77, "user_id": 2359693, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/fab08b10751a723dba2375be713215aa?s=128&d=identicon&r=PG", "display_name": "Bardia", "link": "https://stackoverflow.com/users/2359693/bardia"}, "edited": false, "score": 0, "creation_date": 1468995413, "post_id": 38473190, "comment_id": 64350114, "body": "Jonathan, I already set them to NULL The problem is I have special cases where either of src1 or src2 is NULL, and the value that turns 0 is literally the last value before those happen. So 5 is the last value before the first list goes NULL and that&#39;s why it turns to 0, because that value is still depending on tempdest."}], "answers": [{"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1468997946, "post_id": 38473619, "comment_id": 64351573, "body": "Not my down-vote, but \u2026 did you compile the code in the Pastebin?  Does your compiler really accept <code>struct llnode current==NULL;</code>?  There should only be one <code>=</code> in there, and you can&#39;t just initialize a structure type with a pointer like that (you&#39;d need <code>struct llnode current = { 1, NULL };</code> or something similar)."}, {"owner": {"reputation": 4593, "user_id": 105104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02b23920ac852e946b333d3f9d0d95c1?s=128&d=identicon&r=PG", "display_name": "dvhh", "link": "https://stackoverflow.com/users/105104/dvhh"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1468998491, "post_id": 38473619, "comment_id": 64351910, "body": "From the top of my head, I was bound to make mistake I guess, thanks for pointing them out, and I assume the downvote, will correct the code tough"}], "tags": [], "owner": {"reputation": 4593, "user_id": 105104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02b23920ac852e946b333d3f9d0d95c1?s=128&d=identicon&r=PG", "display_name": "dvhh", "link": "https://stackoverflow.com/users/105104/dvhh"}, "is_accepted": false, "score": -1, "last_activity_date": 1468998513, "last_edit_date": 1468998513, "creation_date": 1468995421, "answer_id": 38473619, "question_id": 38473190, "link": "https://stackoverflow.com/questions/38473190/issue-freeing-memory-that-i-still-need-linked-list/38473619#38473619", "title": "Issue freeing memory that I still need, linked list", "body": "<p>You would need more temporary variable to store the pointer to the node node of each input lists you currently are.</p>\n\n<p><a href=\"http://pastebin.com/pi0c0UeS\" rel=\"nofollow\">For the lazy</a></p>\n"}, {"tags": [], "owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "is_accepted": false, "score": 1, "last_activity_date": 1468995741, "creation_date": 1468995741, "answer_id": 38473697, "question_id": 38473190, "link": "https://stackoverflow.com/questions/38473190/issue-freeing-memory-that-i-still-need-linked-list/38473697#38473697", "title": "Issue freeing memory that I still need, linked list", "body": "<blockquote>\n  <p>I mean the 2 pointers, <code>tempdest</code> and <code>tempsrc</code>, that I created for the sake of solving this question \u2014 those need to be freed.</p>\n</blockquote>\n\n<p>No, they don't. You don't free pointers, you free memory blocks allocated with <code>malloc</code>. Your function doesn't <code>malloc</code> any memory, so it has nothing to <code>free</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 77, "user_id": 2359693, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/fab08b10751a723dba2375be713215aa?s=128&d=identicon&r=PG", "display_name": "Bardia", "link": "https://stackoverflow.com/users/2359693/bardia"}, "edited": false, "score": 0, "creation_date": 1468996243, "post_id": 38473822, "comment_id": 64350560, "body": "So if I don&#39;t free them, no memory leak or anything of that sort will happen?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 77, "user_id": 2359693, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/fab08b10751a723dba2375be713215aa?s=128&d=identicon&r=PG", "display_name": "Bardia", "link": "https://stackoverflow.com/users/2359693/bardia"}, "edited": false, "score": 0, "creation_date": 1468996335, "post_id": 38473822, "comment_id": 64350611, "body": "There would not be any leak simply because of the <code>llmrg()</code> call, no.  You would need a function to release any dynamically allocated lists \u2014 and you&#39;d call that when you&#39;ve finished with the lists, but not until then.  And that&#39;s outside the <code>llmrg()</code> function. The merge itself doesn&#39;t allocate anything or free anything.  The test scenario shown with no dynamic allocation emphasizes the point \u2014 if there&#39;s nothing allocated with <code>malloc()</code>, there&#39;s nothing to release with <code>free()</code>.  But it is an extreme example!"}, {"owner": {"reputation": 77, "user_id": 2359693, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/fab08b10751a723dba2375be713215aa?s=128&d=identicon&r=PG", "display_name": "Bardia", "link": "https://stackoverflow.com/users/2359693/bardia"}, "edited": false, "score": 0, "creation_date": 1468996475, "post_id": 38473822, "comment_id": 64350680, "body": "Alright then. I think I&#39;ll do what you recommended."}, {"owner": {"reputation": 77, "user_id": 2359693, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/fab08b10751a723dba2375be713215aa?s=128&d=identicon&r=PG", "display_name": "Bardia", "link": "https://stackoverflow.com/users/2359693/bardia"}, "edited": false, "score": 0, "creation_date": 1468996484, "post_id": 38473822, "comment_id": 64350688, "body": "Thanks so much for all the help!"}], "tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": true, "score": 2, "last_activity_date": 1468999091, "last_edit_date": 1468999091, "creation_date": 1468996140, "answer_id": 38473822, "question_id": 38473190, "link": "https://stackoverflow.com/questions/38473190/issue-freeing-memory-that-i-still-need-linked-list/38473822#38473822", "title": "Issue freeing memory that I still need, linked list", "body": "<p>As I noted in the comments,</p>\n\n<blockquote>\n  <p>Why do you need to free anything? When you merge the two lists, each item in each of the lists should be in the result list, so none of the items should be freed.</p>\n</blockquote>\n\n<p>Since you have a 'list head' structure (<code>struct llist</code>), you have to set the two old list head structures passed into <code>llmrg()</code> so they don't point to anything any more.</p>\n\n<blockquote>\n  <p>You're not 'allowed' to free either <code>tempsrc</code> or <code>tempdest</code> because they are not allocated by your code. They are merely temporary pointers to items in the list. If you free either of them, you will break things. Please get <a href=\"http://valgrind.org/\" rel=\"nofollow\"><code>valgrind</code></a> if at all possible and use it. It will help you see the error of your ways. By the end of the merge function, you need to ensure that <code>src1-&gt;front</code> is a null pointer, and that <code>src2-&gt;front</code> is a null pointer. But that's all.  There's still nothing to free.</p>\n</blockquote>\n\n<p>This is your code adapted into a test harness.  Note that there is no call to <code>malloc()</code> anywhere in this code, and hence no need to call <code>free()</code> anywhere either.  This is mainly to make the point rather than because you would use non-dynamic memory allocation in genuine code (but you didn't show the list creation code, and doing things this way avoids having to write that, too).</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nstruct llnode { int item; struct llnode *next; };\nstruct llist { struct llnode *front; };\n\nstatic\nvoid llmrg(struct llist *dest, struct llist *src1, struct llist *src2)\n{\n    struct llnode *tempdest = dest-&gt;front;\n    struct llnode *tempsrc;\n\n    while (src1-&gt;front != NULL || src2-&gt;front != NULL)\n    {\n        if (src2-&gt;front == NULL)\n        {\n            tempdest-&gt;next = src1-&gt;front;\n            src1-&gt;front = NULL;\n        }\n        else if (src1-&gt;front == NULL)\n        {\n            tempdest-&gt;next = src2-&gt;front;\n            src2-&gt;front = NULL;\n        }\n        else\n        {\n            if ((src2-&gt;front == NULL) || (src1-&gt;front-&gt;item &lt; src2-&gt;front-&gt;item))\n            {\n                tempsrc = src1-&gt;front-&gt;next;\n                if (dest-&gt;front != NULL)\n                {\n                    tempdest-&gt;next = src1-&gt;front;\n                    tempdest = tempdest-&gt;next;\n                }\n                else\n                {\n                    dest-&gt;front = src1-&gt;front;\n                    tempdest = dest-&gt;front;\n                }\n                src1-&gt;front-&gt;next = NULL;\n                src1-&gt;front = tempsrc;\n            }\n            else\n            {\n                tempsrc = src2-&gt;front-&gt;next;\n                if (dest-&gt;front != NULL)\n                {\n                    tempdest-&gt;next = src2-&gt;front;\n                    tempdest = tempdest-&gt;next;\n                }\n                else\n                {\n                    dest-&gt;front = src2-&gt;front;\n                    tempdest = dest-&gt;front;\n                }\n                src2-&gt;front-&gt;next = NULL;\n                src2-&gt;front = tempsrc;\n            }\n        }\n    }\n    src1-&gt;front = NULL;\n    src2-&gt;front = NULL;\n}\n\nstatic void print_llist(const char *tag, struct llist *list)\n{\n    printf(\"%s:\", tag);\n    struct llnode *node = list-&gt;front;\n    while (node != 0)\n    {\n        printf(\" %d\", node-&gt;item);\n        node = node-&gt;next;\n    }\n    putchar('\\n');\n}\n\nint main(void)\n{\n    struct llnode data[] =\n    {\n        { 1, &amp;data[1] }, { 3, &amp;data[2] }, { 5, 0 },\n        { 2, &amp;data[4] }, { 4, &amp;data[5] }, { 6, 0 }\n    };\n    struct llist ll1 = { &amp;data[0] };\n    struct llist ll2 = { &amp;data[3] };\n    struct llist ll3 = { 0 };\n    printf(\"Before:\\n\");\n    print_llist(\"ll1\", &amp;ll1);\n    print_llist(\"ll2\", &amp;ll2);\n    print_llist(\"ll3\", &amp;ll3);\n\n    llmrg(&amp;ll3, &amp;ll1, &amp;ll2);\n\n    printf(\"After:\\n\");\n    print_llist(\"ll1\", &amp;ll1);\n    print_llist(\"ll2\", &amp;ll2);\n    print_llist(\"ll3\", &amp;ll3);\n\n    return 0;\n}\n</code></pre>\n\n<p>I added the two assignments at the end of the <code>llmrg()</code> function in lieu of your two <code>free()</code> calls.  I'm not sure whether they're necessary, but they certainly do the job.  Clearly, if the list structures or node structures were dynamically allocated, then they'd need to be freed, but not in the <code>llmrg()</code> code.</p>\n\n<p>Example output:</p>\n\n<pre><code>Before:\nll1: 1 3 5\nll2: 2 4 6\nll3:\nAfter:\nll1:\nll2:\nll3: 1 2 3 4 5 6\n</code></pre>\n\n<p>Note that you can simplify the merge function considerably \u2014 25 fewer lines of code. (It is generally easier to get small functions correct, and keep them correct.  However, using the <code>struct llnode **dest</code> is undeniably subtle, albeit effective.)  When the code contains <code>&amp;(*dest)-&gt;next</code>, this is equivalent to <code>&amp;((*dest)-&gt;next)</code> \u2014 the address of the <code>next</code> pointer pointed to by <code>*dest</code>.</p>\n\n<pre><code>#include &lt;assert.h&gt;\n#include &lt;stdio.h&gt;\n\nstruct llnode { int item; struct llnode *next; };\nstruct llist { struct llnode *front; };\n\nstatic\nvoid llmrg(struct llist *dst0, struct llist *src1, struct llist *src2)\n{\n    struct llnode *node1 =  src1-&gt;front;\n    struct llnode *node2 =  src2-&gt;front;\n    struct llnode **dest = &amp;dst0-&gt;front;\n\n    src1-&gt;front = NULL;\n    src2-&gt;front = NULL;\n\n    while (node1 != NULL &amp;&amp; node2 != NULL)\n    {\n        if (node1-&gt;item &lt; node2-&gt;item)\n        {\n            *dest = node1;\n            node1 = node1-&gt;next;\n        }\n        else\n        {\n            *dest = node2;\n            node2 = node2-&gt;next;\n        }\n        dest = &amp;(*dest)-&gt;next;\n    }\n\n    if (node1 != NULL)\n        *dest = node1;\n    if (node2 != NULL)\n        *dest = node2;\n}\n\nstatic void print_llist(const char *tag, struct llist *list)\n{\n    printf(\"%s:\", tag);\n    struct llnode *node = list-&gt;front;\n    while (node != 0)\n    {\n        printf(\" %d\", node-&gt;item);\n        node = node-&gt;next;\n    }\n    putchar('\\n');\n}\n\nint main(void)\n{\n    struct llnode data[] =\n    {\n        { 2, &amp;data[1] }, { 3, &amp;data[2] }, { 5, 0 },\n        { 1, &amp;data[4] }, { 4, &amp;data[5] }, { 6, &amp;data[6] }, { 8, 0 },\n    };\n    struct llist ll1 = { &amp;data[0] };\n    struct llist ll2 = { &amp;data[3] };\n    struct llist ll3 = { 0 };\n\n    printf(\"Before:\\n\");\n    print_llist(\"ll1\", &amp;ll1);\n    print_llist(\"ll2\", &amp;ll2);\n    print_llist(\"ll3\", &amp;ll3);\n\n    llmrg(&amp;ll3, &amp;ll1, &amp;ll2);\n\n    printf(\"After:\\n\");\n    print_llist(\"ll1\", &amp;ll1);\n    print_llist(\"ll2\", &amp;ll2);\n    print_llist(\"ll3\", &amp;ll3);\n\n    return 0;\n}\n</code></pre>\n\n<p>The test data is slightly different; it would work on the original just as happily as on this data.</p>\n\n<p>Example output:</p>\n\n<pre><code>Before:\nll1: 2 3 5\nll2: 1 4 6 8\nll3:\nAfter:\nll1:\nll2:\nll3: 1 2 3 4 5 6 8\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 379, "user_id": 6606312, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nK2RR.jpg?s=128&g=1", "display_name": "Khan Maxfield", "link": "https://stackoverflow.com/users/6606312/khan-maxfield"}, "is_accepted": false, "score": 1, "last_activity_date": 1468997127, "creation_date": 1468997127, "answer_id": 38474105, "question_id": 38473190, "link": "https://stackoverflow.com/questions/38473190/issue-freeing-memory-that-i-still-need-linked-list/38474105#38474105", "title": "Issue freeing memory that I still need, linked list", "body": "<p>There is no need to free tempsrc or tempdst. These pointers have not been allocated any memory but rather just point to memory you already had and need (llnodes in your lists). You actually don't need to free anything. Your situation is similar to this:</p>\n\n<pre><code>int* someInts = malloc(sizeof(int) * 10); // allocates memory for 10 ints\n\nint* tempInt = &amp;someInt[5]; // points to the 5th int someInts, no new memory allocated \n\n//free(tempInt);\n//There is no need to free this as it is just a pointer\n//to some memory already \"owned\" by someInts\n\nfree(someInts);\n//Freeing this pointer frees all the memory allocated in the first line.\n</code></pre>\n"}], "owner": {"reputation": 77, "user_id": 2359693, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/fab08b10751a723dba2375be713215aa?s=128&d=identicon&r=PG", "display_name": "Bardia", "link": "https://stackoverflow.com/users/2359693/bardia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 38473822, "answer_count": 4, "score": -1, "last_activity_date": 1468999091, "creation_date": 1468993724, "last_edit_date": 1468994479, "question_id": 38473190, "link": "https://stackoverflow.com/questions/38473190/issue-freeing-memory-that-i-still-need-linked-list", "title": "Issue freeing memory that I still need, linked list", "body": "<p>So I'm doing this assignment and as part of the rules, anything extra defined in helpers needs to be free'd at the end.\nthe question is: take a destination empty linked list, take 2 already sorted linked lists, and merge these two into the destination linked list with their already existing addresses, I'm not allowed to define new nodes.\nthis is what I have</p>\n\n<pre><code>void llmrg(struct llist *dest, struct llist *src1, struct llist *src2)\n{\n    struct llnode *tempdest = dest-&gt;front;\n    struct llnode *tempsrc;\n\n    while (src1-&gt;front != NULL || src2-&gt;front != NULL)\n    {\n        if (src2-&gt;front == NULL)\n        {\n            tempdest-&gt;next = src1-&gt;front;\n            src1-&gt;front = NULL;\n        }\n        else if (src1-&gt;front == NULL)\n        {\n            tempdest-&gt;next = src2-&gt;front;\n            src2-&gt;front = NULL;\n        }\n        else\n        {\n            if ((src2-&gt;front == NULL) || (src1-&gt;front-&gt;item &lt; src2-&gt;front-&gt;item))\n            {\n                tempsrc = src1-&gt;front-&gt;next;\n                if (dest-&gt;front != NULL)\n                {\n                    tempdest-&gt;next = src1-&gt;front;\n                    tempdest = tempdest-&gt;next;\n                }\n                else\n                {\n                    dest-&gt;front = src1-&gt;front;\n                    tempdest = dest-&gt;front;\n                }\n                src1-&gt;front-&gt;next = NULL;\n                src1-&gt;front = tempsrc;\n            }\n            else\n            {\n                tempsrc = src2-&gt;front-&gt;next;\n                if (dest-&gt;front != NULL)\n                {\n                    tempdest-&gt;next = src2-&gt;front;\n                    tempdest = tempdest-&gt;next;\n                }\n                else\n                {\n                    dest-&gt;front = src2-&gt;front;\n                    tempdest = dest-&gt;front;\n                }\n                src2-&gt;front-&gt;next = NULL;\n                src2-&gt;front = tempsrc;\n            }\n        }\n    }\n    free(tempsrc);\n    free(tempdest);\n}\n</code></pre>\n\n<p>So now my issue is if I don't do the 'free' statements, everything works, but I'm not allowed to do that, but if I free 'tempdest' (free'ing 'tempsrc' doesn't cause an issue), then 1 of the values goes away because it's still stored using tempdest.</p>\n\n<p>So if my lists are (1,3,5) and (2,4,6), result should be (1,2,3,4,5,6), and it works without free'ing,\nbut with free'ing I get (1,2,3,4,0,6).</p>\n\n<p>Also the data structures are:</p>\n\n<pre><code>struct llnode { int item; struct llnode *next; };\nstruct llist { struct llnode *front; };\n</code></pre>\n\n<p>By freeing, I don't mean the linked lists, those are obviously being used.  I mean the 2 pointers, <code>tempdest</code> and <code>tempsrc</code>, that I created for the sake of solving this question \u2014 those need to be freed.</p>\n\n<p>Can someone please help me somehow free <code>tempdest</code> and also keep the value 5?</p>\n"}, {"tags": ["c", "linker-errors", "keil", "nrf51"], "comments": [{"owner": {"reputation": 4888, "user_id": 5785362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a786fd81952576dc07942023bf8830b?s=128&d=identicon&r=PG", "display_name": "tofro", "link": "https://stackoverflow.com/users/5785362/tofro"}, "edited": false, "score": 1, "creation_date": 1469001020, "post_id": 38472854, "comment_id": 64353515, "body": "The header that you seem to have included and made its path known to the compiler is normally only <i>declaring</i> a function. It needs to be <i>defined</i> somewhere (the &quot;real code&quot;) - That would normally be in an object file or library that <b>you need to link</b> your code with."}], "answers": [{"tags": [], "owner": {"reputation": 3677, "user_id": 6556246, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IdyR7.jpg?s=128&g=1", "display_name": "Jens Meder", "link": "https://stackoverflow.com/users/6556246/jens-meder"}, "is_accepted": true, "score": 0, "last_activity_date": 1469220143, "creation_date": 1469220143, "answer_id": 38534951, "question_id": 38472854, "link": "https://stackoverflow.com/questions/38472854/undefined-symbol-while-using-keil-ide/38534951#38534951", "title": "Undefined symbol while using Keil IDE", "body": "<p>Depending on the SDK version you want to use you need to compile and link <code>device_manager_peripheral.c</code>. For NRF5 SDK version 11.0.0 it resides in the folder <code>&lt;path to sdk&gt;/nRF5_SDK_11/components/ble/device_manager</code>.</p>\n\n<p>You can find a tutorial <a href=\"https://devzone.nordicsemi.com/tutorials/15/\" rel=\"nofollow\">here</a>.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6064424"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 727, "favorite_count": 0, "accepted_answer_id": 38534951, "answer_count": 1, "score": 0, "last_activity_date": 1469220143, "creation_date": 1468991932, "last_edit_date": 1468998624, "question_id": 38472854, "link": "https://stackoverflow.com/questions/38472854/undefined-symbol-while-using-keil-ide", "title": "Undefined symbol while using Keil IDE", "body": "<p>I am using Nordic nRF51-DK SDK_11 and the soft device s130.</p>\n\n<p>I encountered the following error while adding device manager. I'm using Keil compiler.</p>\n\n<blockquote>\n  <p>._build\\nrf51422_xxac_s130.axf: Error: L6218E: Undefined symbol\n  dm_init (referred from main.o). ._build\\nrf51422_xxac_s130.axf: Error:\n  L6218E: Undefined symbol dm_register (referred from main.o). Not\n  enough information to list image symbols.</p>\n</blockquote>\n\n<p>I have included device_manager.h in the PATHS. Using Keil, I did it by going to Menu->Flash->Configure Flash Tools ... -> Include Paths -> Add components\\ble\\device_manager</p>\n\n<p>What else did I miss out?</p>\n"}, {"tags": ["c", "frameworks", "state-machine", "mplab", "pic32"], "answers": [{"comments": [{"owner": {"reputation": 1084, "user_id": 1411745, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/UELNE.jpg?s=128&g=1", "display_name": "The amateur programmer", "link": "https://stackoverflow.com/users/1411745/the-amateur-programmer"}, "edited": false, "score": 0, "creation_date": 1470200717, "post_id": 38728395, "comment_id": 64845053, "body": "Thank you, this seems to be currently the only framework/rtos provided way to communicate between these state machines. I have checked some of the examples provided with the harmony, and they seem to just use shared variables for this purpose, so I think I&#39;m going with that approach too as rtos would be somewhat overkill for the projects I&#39;m working with."}], "tags": [], "owner": {"reputation": 414, "user_id": 660867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c61bbbe4455a0faf0a5bb004513be15?s=128&d=identicon&r=PG", "display_name": "blsmit5728", "link": "https://stackoverflow.com/users/660867/blsmit5728"}, "is_accepted": true, "score": 1, "last_activity_date": 1470164117, "creation_date": 1470164117, "answer_id": 38728395, "question_id": 38472559, "link": "https://stackoverflow.com/questions/38472559/how-to-exchange-data-between-two-apps-state-machines-in-mplab-harmony-framewor/38728395#38728395", "title": "How to exchange data between two apps (state machines) in MPLAB Harmony framework?", "body": "<p>Look into using the FreeRTOS provided by Harmony. They have a data set called queues that would be perfect for what you are describing. I use them in my ISRs to queue data that a task periodically acts upon once the buffer is complete.</p>\n"}], "owner": {"reputation": 1084, "user_id": 1411745, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/UELNE.jpg?s=128&g=1", "display_name": "The amateur programmer", "link": "https://stackoverflow.com/users/1411745/the-amateur-programmer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 279, "favorite_count": 0, "accepted_answer_id": 38728395, "answer_count": 1, "score": 0, "last_activity_date": 1470164117, "creation_date": 1468990278, "last_edit_date": 1468992981, "question_id": 38472559, "link": "https://stackoverflow.com/questions/38472559/how-to-exchange-data-between-two-apps-state-machines-in-mplab-harmony-framewor", "title": "How to exchange data between two apps (state machines) in MPLAB Harmony framework?", "body": "<p>I'm implementing multiple state machines that run in parallel using the MPLAB Harmony framework, but some of my state machines need to get a message when the another applications state machine enters a specific state. I could not find any information considering any \"correct\" or framework provided way of doing this kind of simple data exchange between state machines in the framework.</p>\n\n<p>So basically, how do I exchange information about the event of state machine moving to a specific state (boolean type information, two possible values either in specific state or not in specific state) to another applications state machine whose operation depends on the the state of the other state machine. Is there a framework provided way of achieving this kind of simple information exchange? I'm writing my applications in C for the 32 bit Microchip microcontrollers.</p>\n"}, {"tags": ["c++", "c", "random", "permutation"], "comments": [{"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 0, "creation_date": 1468991618, "post_id": 38472504, "comment_id": 64348653, "body": "How about using a cryptographically secure PRNG? How many bits wide are your numbers? You could feed the output of the PRNG to a <code>sha1</code> secure hash. What is are ballbark values for <code>n</code> and <code>k</code>. Chances are fair to good that <code>k</code> will be below the periodicity of the PRNG. Do you care about time? Are you going the grab the random number, use it, and discard it? Can you accept a probability of uniqueness (vs. absolute)?"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1468993934, "post_id": 38472504, "comment_id": 64349438, "body": "While I haven&#39;t completely thought though all ways to doing it, it seems like the kicker is regardless whether you shuffle an array or generate the values and keep track of previous to insure uniqueness, you essentially require an array of <code>n</code>. The size issue can be addressed somewhat if you generate and use an array of <code>char</code> to keep track of the prior generated values. (storage is <code>1-byte</code> per value instead of 4, 8, etc..)"}, {"owner": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "edited": false, "score": 1, "creation_date": 1469033495, "post_id": 38472504, "comment_id": 64374630, "body": "If k can equal n, there&#39;s no avoiding O(n) memory."}, {"owner": {"reputation": 74843, "user_id": 2988730, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ZOX7t.jpg?s=128&g=1", "display_name": "Mad Physicist", "link": "https://stackoverflow.com/users/2988730/mad-physicist"}, "edited": false, "score": 0, "creation_date": 1469033869, "post_id": 38472504, "comment_id": 64374863, "body": "How do you intend to check what you already got/didn&#39;t get without using <code>O(k)</code> memory, with <code>k</code> being potentially as big as <code>n</code>?"}, {"owner": {"reputation": 3904, "user_id": 2417578, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d2e6626f1fc0b76fc7e8981687304f40?s=128&d=identicon&r=PG", "display_name": "sh1", "link": "https://stackoverflow.com/users/2417578/sh1"}, "edited": false, "score": 0, "creation_date": 1469034484, "post_id": 38472504, "comment_id": 64375240, "body": "OK, so as I explained in the question, there are a variety of algorithms that can iterate pseudo-randomly through a list and touch every point without repetition (up to n, but not beyond).  The problem with them is that they don&#39;t have free choice on the order of the results that they give, and so after seeing one or two results you can trivially predict all subsequent results.  <i>Completely</i> free choice seems impossible (though I can&#39;t prove it), but a demonstrably strong (hard to predict) randomised choice would be sufficient."}, {"owner": {"reputation": 3904, "user_id": 2417578, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d2e6626f1fc0b76fc7e8981687304f40?s=128&d=identicon&r=PG", "display_name": "sh1", "link": "https://stackoverflow.com/users/2417578/sh1"}, "edited": false, "score": 0, "creation_date": 1469040376, "post_id": 38472504, "comment_id": 64378705, "body": "The theory behind <a href=\"https://en.wikipedia.org/wiki/Format-preserving_encryption\" rel=\"nofollow noreferrer\">format-preserving encryption</a> looks promising.  Not that it&#39;s theoretically better than a transparent hash for quality distribution, but because ciphers can (must) be unpredictable and use keys so large that they inherently choose from a very large variety of orders."}, {"owner": {"reputation": 3904, "user_id": 2417578, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d2e6626f1fc0b76fc7e8981687304f40?s=128&d=identicon&r=PG", "display_name": "sh1", "link": "https://stackoverflow.com/users/2417578/sh1"}, "reply_to_user": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 0, "creation_date": 1469126642, "post_id": 38472504, "comment_id": 64421441, "body": "@CraigEstey, <code>n</code> will be about four billion (2**32, or a nearby value), fast-out tests may restrict <code>k</code> to being substantially smaller normally, but it should reach as high as <code>n</code> at least sometimes.  When <code>k</code> reaches <code>n</code> I really do need to know that I&#39;ve covered every possible value.  After that many operations time can&#39;t help but matter."}, {"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 0, "creation_date": 1469127856, "post_id": 38472504, "comment_id": 64422100, "body": "(1) Do you need to retain a list of the exact values? This would be O(n) integers or 17 GB. Or, (2) you want to generate the values one-at-a-time, guaranteeing uniqueness, and discard? I would assume (1) is <i>no</i> [based on your <b>bold</b> text :-)]. So, if (2), would 500 MB [or <i>less</i>] be acceptable? If so, I have a solution. Can you elaborate slightly on any additional constraints?"}, {"owner": {"reputation": 3904, "user_id": 2417578, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d2e6626f1fc0b76fc7e8981687304f40?s=128&d=identicon&r=PG", "display_name": "sh1", "link": "https://stackoverflow.com/users/2417578/sh1"}, "reply_to_user": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 0, "creation_date": 1469161181, "post_id": 38472504, "comment_id": 64432218, "body": "@CraigEstey, I&#39;ll use them and then throw them away, one at a time.  I just need to eventually visit every value in a randomised order (unless there&#39;s a fast-out condition that stops before the end).  500MB is too large, I think, unless I don&#39;t need to access the whole thing when a fast-out case stops k at a smaller value.  Unfortunately I don&#39;t have a distribution for those cases yet."}, {"owner": {"reputation": 3904, "user_id": 2417578, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d2e6626f1fc0b76fc7e8981687304f40?s=128&d=identicon&r=PG", "display_name": "sh1", "link": "https://stackoverflow.com/users/2417578/sh1"}, "edited": false, "score": 0, "creation_date": 1473893429, "post_id": 38472504, "comment_id": 66318964, "body": "I suspect the answer might be <a href=\"http://statweb.stanford.edu/~cgates/PERSI/papers/subgroup-rand-var.pdf\" rel=\"nofollow noreferrer\">here</a>, but I don&#39;t understand any of it.  However, I found that while searching for properties of random binary matrices, which would offer a reasonable parameter space for bijective transforms if I could select a good subset uniformly.  Things are looking positive!"}], "answers": [{"comments": [{"owner": {"reputation": 3904, "user_id": 2417578, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d2e6626f1fc0b76fc7e8981687304f40?s=128&d=identicon&r=PG", "display_name": "sh1", "link": "https://stackoverflow.com/users/2417578/sh1"}, "edited": false, "score": 0, "creation_date": 1469126893, "post_id": 38495493, "comment_id": 64421578, "body": "Shuffling the array probably won&#39;t be fast enough because it&#39;s around 16GB in size."}, {"owner": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "reply_to_user": {"reputation": 3904, "user_id": 2417578, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d2e6626f1fc0b76fc7e8981687304f40?s=128&d=identicon&r=PG", "display_name": "sh1", "link": "https://stackoverflow.com/users/2417578/sh1"}, "edited": false, "score": 0, "creation_date": 1469170795, "post_id": 38495493, "comment_id": 64435678, "body": "@sh1 Really?! You only need to shuffle once; after that, swap the items you drew randomly back into the array elsewhere and you have another randomly shuffled array."}, {"owner": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "reply_to_user": {"reputation": 3904, "user_id": 2417578, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d2e6626f1fc0b76fc7e8981687304f40?s=128&d=identicon&r=PG", "display_name": "sh1", "link": "https://stackoverflow.com/users/2417578/sh1"}, "edited": false, "score": 0, "creation_date": 1469171307, "post_id": 38495493, "comment_id": 64435942, "body": "Also, with such a large size you&#39;re obviously not using an array with <code>static</code> storage duration; that&#39;d be lunacy. <a href=\"https://gist.github.com/Sebbyastian/40be860d95f9df95f319a2f17dc74dde\" rel=\"nofollow noreferrer\">Shuffle the file as you read entries from it</a>."}, {"owner": {"reputation": 3904, "user_id": 2417578, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d2e6626f1fc0b76fc7e8981687304f40?s=128&d=identicon&r=PG", "display_name": "sh1", "link": "https://stackoverflow.com/users/2417578/sh1"}, "edited": false, "score": 0, "creation_date": 1469766365, "post_id": 38495493, "comment_id": 64683062, "body": "I actually need only the indices themselves.  There is no storage of an object referenced by the index.  Instead I calculate information directly from the numerical value.  So if I wanted to solve it by sorting a file, I would have to create that file in advance."}, {"owner": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "reply_to_user": {"reputation": 3904, "user_id": 2417578, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d2e6626f1fc0b76fc7e8981687304f40?s=128&d=identicon&r=PG", "display_name": "sh1", "link": "https://stackoverflow.com/users/2417578/sh1"}, "edited": false, "score": 0, "creation_date": 1469777818, "post_id": 38495493, "comment_id": 64687827, "body": "So you really have a 16GB allocation storing all of that? Sort it. Shuffle as you draw, as though the cards go back to the beginning of the deck and the card you select is at an increasing index... This way it stays shuffled and you can just start again at zero when you pick the last item. Why isn&#39;t a database an acceptable solution?"}], "tags": [], "owner": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "is_accepted": false, "score": 2, "last_activity_date": 1470810519, "last_edit_date": 1470810519, "creation_date": 1469078709, "answer_id": 38495493, "question_id": 38472504, "link": "https://stackoverflow.com/questions/38472504/return-non-duplicate-random-values-from-a-very-large-range/38495493#38495493", "title": "Return non-duplicate random values from a very large range", "body": "<p>First of all, it seems unreasonable to discount anything that uses O(n) memory and then discuss a solution that refers to an underlying array. You have an array. Shuffle it. If that doesn't work or isn't fast enough, come back to us with a question about it.</p>\n\n<p><strong>You only need to perform a complete shuffle once.</strong> After that, draw from index <code>n</code>, swap that element with an element located randomly before it and increase <code>n</code>, modulo element count. For example, with such a large dataset I'd use <a href=\"https://gist.github.com/Sebbyastian/40be860d95f9df95f319a2f17dc74dde\" rel=\"nofollow\">something like this</a>.</p>\n\n<p>Prime numbers are an option for hashes, but probably not the same way you think. Using two Mersenne primes (<code>low</code> and <code>high</code>, perhaps <code>0xefff</code> and <code>0xefffffff</code>) you should be able to come up with a much more general-purpose hashing algorithm.</p>\n\n<pre><code>size_t hash(unsigned char *value, size_t value_size, size_t low, size_t high) {\n    size_t x = 0;\n    while (value_size--) {\n        x += *value++;\n        x *= low;\n    }\n    return x % high;\n}\n#define hash(value, value_size, low, high) (hash((void *) value, value_size, low, high))\n</code></pre>\n\n<p>This should produce something fairly well distributed for all inputs larger than about two octets for example, with the minor troublesome exception for zero byte prefixes. You might want to treat those differently.</p>\n"}, {"comments": [{"owner": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "edited": false, "score": 0, "creation_date": 1469878439, "post_id": 38641624, "comment_id": 64727014, "body": "Which system are you running this on? You&#39;re using <code>int</code> in a way that potentially invokes UB, so for anyone to find this useful they&#39;d need more info, e.g. what is <code>sizeof (int)</code>?"}, {"owner": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "edited": false, "score": 0, "creation_date": 1469879072, "post_id": 38641624, "comment_id": 64727167, "body": "Also, what do you mean by &quot;selecting randomly&quot;? You&#39;re trying to develop a PRNG that has even distribution, right? Well if you&#39;re using such a PRNG for &quot;selecting randomly&quot; then you should see much less than 36-37% collisions."}, {"owner": {"reputation": 3904, "user_id": 2417578, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d2e6626f1fc0b76fc7e8981687304f40?s=128&d=identicon&r=PG", "display_name": "sh1", "link": "https://stackoverflow.com/users/2417578/sh1"}, "reply_to_user": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "edited": false, "score": 0, "creation_date": 1469902676, "post_id": 38641624, "comment_id": 64733756, "body": "@Seb, good spotting, fixed.  The size of the data type doesn&#39;t matter (ie., gives the same result) so long as it&#39;s at least as large as <code>BITS</code>, and unsigned so that it can overflow without UB."}, {"owner": {"reputation": 3904, "user_id": 2417578, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d2e6626f1fc0b76fc7e8981687304f40?s=128&d=identicon&r=PG", "display_name": "sh1", "link": "https://stackoverflow.com/users/2417578/sh1"}, "reply_to_user": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "edited": false, "score": 0, "creation_date": 1469902780, "post_id": 38641624, "comment_id": 64733796, "body": "The PRNG has even distribution over its period, but it&#39;s incapable of producing the same result twice within its period.  The collisions come when varying the <code>k</code> parameter and asking the question &quot;if I vary <code>k</code>, do I get a different value following <code>a</code> for every different <code>k</code>?&quot;.  Because the pairs are members of different sequences they&#39;re allowed to collide, (and when selecting from <i>all</i> possible sequences at random they would frequently collide); but if they were to collide too much it would be a symptom that different <code>k</code> were failing to produce significantly different sequences."}, {"owner": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "edited": false, "score": 0, "creation_date": 1471742026, "post_id": 38641624, "comment_id": 65469510, "body": "Is that an implication that when <code>k</code> is equal, not all values are produced? I&#39;m not mathematically gifted, but I&#39;d love to see a histogram of the first two cycles for a few poorly chosen values of <code>k</code>... I&#39;m not sure whether or not that&#39;d be useful for this answer, but people often look at the worst case when choosing an algorithm."}, {"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 0, "creation_date": 1472535930, "post_id": 38641624, "comment_id": 65777163, "body": "Sorry that this is [more than a little] late. I had been working on a solution to <i>your</i> problem, using a <i>linear congruential generator</i> but got bogged down implementing part of it. Your solution is similar. I was able to post a usable portion of my code [that I would have posted here] to answer another question here: <a href=\"http://stackoverflow.com/questions/39215891/generating-very-large-non-repeating-integer-sequence-without-pre-shuffling/39216211#39216211\" title=\"generating very large non repeating integer sequence without pre shuffling\">stackoverflow.com/questions/39215891/&hellip;</a> Hopefully, you&#39;ll still be able to get some benefit, but it sounds like you&#39;ve already got covered. It&#39;s 1 mul and 1 add per number, so fast"}], "tags": [], "owner": {"reputation": 3904, "user_id": 2417578, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d2e6626f1fc0b76fc7e8981687304f40?s=128&d=identicon&r=PG", "display_name": "sh1", "link": "https://stackoverflow.com/users/2417578/sh1"}, "is_accepted": false, "score": 0, "last_activity_date": 1469902117, "last_edit_date": 1469902117, "creation_date": 1469722281, "answer_id": 38641624, "question_id": 38472504, "link": "https://stackoverflow.com/questions/38472504/return-non-duplicate-random-values-from-a-very-large-range/38641624#38641624", "title": "Return non-duplicate random values from a very large range", "body": "<p>So... what I've ended up doing is digging deeper into pre-existing methods to\ntry to confirm their ability to approximate a fair shuffle.</p>\n\n<p>I take a simple counter, which itself is guaranteed to visit\nevery in-range value exactly once, and then 'encrypt' it with an n-bit block\ncypher.  Rather, I round the range up to a power of two, and apply some 1:1\nfunction; then if the result is out of range I repeat the permutation until the\nresult is in range.</p>\n\n<p>This can be guaranteed to complete eventually because there are only a finite\nnumber of out-of-range values within the power-of-two range, and they cannot\nenter into a always-out-of-range cycle because that would imply that something\nin the cycle was mapped from two different previous states (one from the\nin-range set, and another from the out-of-range set), which would make the\nfunction not bijective.</p>\n\n<p>So all I need to do is devise a parameterisable function which I can tune to an\narbitrary number of bits.  Like this one:</p>\n\n<pre><code>uint64_t mix(uint64_t x, uint64_t k) {\n  const int s0 = BITS * 4 / 5;\n  const int s1 = BITS / 5 + (k &amp; 1);\n  const int s2 = BITS * 2 / 5;\n  k |= 1;\n\n  x *= k;\n  x ^= (x &amp; BITMASK) &gt;&gt; s0;\n  x ^= (x &lt;&lt; s1) &amp; BITMASK;\n  x ^= (x &amp; BITMASK) &gt;&gt; s2;\n  x += 0x9e3779b97f4a7c15;\n\n  return x &amp; BITMASK;\n}\n</code></pre>\n\n<p>I know it's bijective because I happen to have its inverse function handy:</p>\n\n<pre><code>uint64_t unmix(uint64_t x, uint64_t k) {\n  const int s0 = BITS * 4 / 5;\n  const int s1 = BITS / 5 + (k &amp; 1);\n  const int s2 = BITS * 2 / 5;\n  k |= 1;\n  uint64_t kp = k * k;\n  while ((kp &amp; BITMASK) &gt; 1) {\n    k *= kp;\n    kp *= kp;\n  }\n\n  x -= 0x9e3779b97f4a7c15;\n  x ^= ((x &amp; BITMASK) &gt;&gt; s2) ^ ((x &amp; BITMASK) &gt;&gt; s2 * 2);\n  x ^= (x &lt;&lt; s1) ^ (x &lt;&lt; s1 * 2) ^ (x &lt;&lt; s1 * 3) ^ (x &lt;&lt; s1 * 4) ^ (x &lt;&lt; s1 * 5);\n  x ^= (x &amp; BITMASK) &gt;&gt; s0;\n  x *= k;\n\n  return x &amp; BITMASK;\n}\n</code></pre>\n\n<p>This allows me to define a simple parameterisable PRNG like this:</p>\n\n<pre><code>uint64_t key[ROUNDS];\nuint64_t seed = 0;\nuint64_t rand_no_rep(void) {\n  uint64_t x = seed++;\n  do {\n    for (int i = 0; i &lt; ROUNDS; i++) x = mix(x, key[i]);\n  } while (x &gt;= RANGE);\n  return x;\n}\n</code></pre>\n\n<p>Initialise <code>seed</code> and <code>key</code> to random values and you're good to go.</p>\n\n<p>Using the inverse function to lets me determine what <code>seed</code> must be to force\n<code>rand_no_rep()</code> to produce a given output; making it much easier to test.</p>\n\n<p>So far I've checked the cases where constant <code>a</code>, it is followed by constant\n<code>b</code>.  For <code>ROUNDS==1</code> pairs collide on exactly 50% of the keys (and each\npair of collisions is with a different pair of <code>a</code> and <code>b</code>; they don't all converge on 0, 1 or whatever).  That is, for\nvarious <code>k</code>, a specific <code>a</code>-followed-by-<code>b</code> cases occurs for more than one <code>k</code>\n(this <em>must</em> happen at least one).  Subsequent values values do not collide in\nthat case, so different keys aren't falling into the same cycle at different\npositions.  Every <code>k</code> gives a unique cycle.</p>\n\n<p>50% collisions comes from 25% being not unique when they're added to the list (count itself, and count the guy it ran into).  That might sound bad but it's actually lower than birthday paradox logic would suggest.  Selecting randomly, the percentage of new entries that fail to be unique looks to converge between 36% and 37%.  Being \"better than random\" is obviously <em>worse</em> than random, as far as randomness goes, but that's why they're called pseudo-random numbers.</p>\n\n<p>Extending that to <code>ROUNDS==2</code>, we want to make sure that a second round doesn't\ncancel out or simply repeat the effects of the first.</p>\n\n<p>This is important because it would mean that multiple rounds are a waste of\ntime and memory, and that the function cannot be paramaterised to any\nsubstantial degree.  It could happen trivially if <code>mix()</code> contained all linear\noperations (say, multiply and add, mod <code>RANGE</code>).  In that case all of the\nparameters could be multiplied/added together to produce a single parameter for\na single round that would have the same effect.  That would be disappointing,\nas it would reduce the number of attainable permutations to the size of just\nthat one parameter, and if the set is as small as that then more work would be\nneeded to ensure that it's a good, representative set.</p>\n\n<p>So what we want to see from two rounds is a large set of outcomes that could\nnever be achieved by one round.  One way to demonstrate this is to look for the\noriginal <code>b</code>-follows-<code>a</code> cases with an additional parameter <code>c</code>, where we want\nto see every possible <code>c</code> following <code>a</code> and <code>b</code>.</p>\n\n<p>We know from the one-round testing that in 50% of cases there is only one <code>c</code>\nthat can follow <code>a</code> and <code>b</code> because there is only one <code>k</code> that places <code>b</code>\nimmediately after <code>a</code>.  We also know that 25% of the pairs of <code>a</code> and <code>b</code> were\nunreachable (being the gap left behind by half the pairs that went into\ncollisions rather than new unique values), and the last 25% appear for two\ndifferent <code>k</code>.</p>\n\n<p>The result that I get is that given a free choice of both keys, it's possible\nto find about five eights of the values of <code>c</code> following a given <code>a</code> and <code>b</code>.\nAbout a quarter of the <code>a</code>/<code>b</code> pairs are unreachable (it's a less predictable,\nnow, because of the potential intermediate mappings into or out of the\nduplicate or unreachable cases) and a quarter have <code>a</code>, <code>b</code>, and <code>c</code> appear\ntogether in two sequences (which diverge afterwards).</p>\n\n<p>I think there's a lot to be inferred from the difference between one round and\ntwo, but I could be wrong about that and I need to double-check.  Further\ntesting gets harder; or at least slower unless I think more carefully about how\nI'm going to do it.</p>\n\n<p>I haven't yet demonstrated that amongst the set of permutations it can produce, that they're all equally likely; but this is normally not guaranteed for any other PRNG either.</p>\n\n<p>It's fairly slow for a PRNG, but it would fit SIMD trivially.</p>\n"}], "owner": {"reputation": 3904, "user_id": 2417578, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d2e6626f1fc0b76fc7e8981687304f40?s=128&d=identicon&r=PG", "display_name": "sh1", "link": "https://stackoverflow.com/users/2417578/sh1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 191, "favorite_count": 1, "answer_count": 2, "score": 4, "last_activity_date": 1470810519, "creation_date": 1468989967, "last_edit_date": 1469417546, "question_id": 38472504, "link": "https://stackoverflow.com/questions/38472504/return-non-duplicate-random-values-from-a-very-large-range", "title": "Return non-duplicate random values from a very large range", "body": "<p>I would like a function that will produce k pseudo-random values from a set of n integers, zero to n-1, without repeating any previous result.  k is less than or equal to n.  <strong>O(n) memory is unacceptable</strong> because of the large size of <code>n</code> and the frequency with which I'll need to re-shuffle.</p>\n\n<p>These are the methods I've considered so far:</p>\n\n<p><strong>Array</strong>:\nNormally if I wanted duplicate-free random values I'd shuffle an array, but that's O(n) memory.  n is likely to be too large for that to work.</p>\n\n<pre><code>long nextvalue(void) {\n  static long array[4000000000];\n  static int s = 0;\n  if (s == 0) {\n    for (int i = 0; i &lt; 4000000000; i++) array[i] = i;\n    shuffle(array, 4000000000);\n  }\n  return array[s++];\n}\n</code></pre>\n\n<p><strong>n-state PRNG</strong>:\nThere are a variety of random number generators that can be designed so as to have a period of <code>n</code> and to visit <code>n</code> unique states over that period.  The simplest example would be:</p>\n\n<pre><code>long nextvalue(void) {\nstatic long s = 0;\nstatic const long i = 1009; // assumed co-prime to n\n  s = (s + i) % n;\n  return s;\n}\n</code></pre>\n\n<p>The problem with this is that it's not necessarily easy to design a good PRNG on the fly for a given <code>n</code>, and it's unlikely that that PRNG will approximate a fair shuffle if it doesn't have a lot of variable parameters (even harder to design).  But maybe there's a good one I don't know about.</p>\n\n<p><strong>m-bit hash</strong>:\nIf the size of the set is a power of two, then it's possible to devise a perfect hash function <code>f()</code> which performs a 1:1 mapping from any value in the range to some other value in the range, where every input produces a unique output.  Using this function I could simply maintain a static counter <code>s</code>, and implement a generator as:</p>\n\n<pre><code>long nextvalue(void) {\n  static long s = 0;\n  return f(s++);\n}\n</code></pre>\n\n<p>This isn't ideal because the order of the results is determined by <code>f()</code>, rather than random values, so it's subject to all the same problems as above.</p>\n\n<p><strong>NPOT hash</strong>:\nIn principle I can use the same design principles as above to define a version of <code>f()</code> which works in an arbitrary base, or even a composite, that is compatible with the range needed; but that's potentially difficult, and I'm likely to get it wrong.  Instead a function can be defined for the next power of two greater than or equal to <code>n</code>, and used in this construction:</p>\n\n<pre><code>long nextvalue(void) {\n  static long s = 0;\n  long x = s++;\n  do { x = f(x); } while (x &gt;= n);\n}\n</code></pre>\n\n<p>But this <em>still</em> have the same problem (unlikely to give a good approximation of a fair shuffle).</p>\n\n<p>Is there a better way to handle this situation?  Or perhaps I just need a good function for <code>f()</code> that is highly parameterisable and easy to design to visit exactly <code>n</code> discrete states.</p>\n\n<p>One thing I'm thinking of is a hash-like operation where I contrive to have the first <code>j</code> results perfectly random through carefully designed mapping, and then any results between <code>j</code> and <code>k</code> would simply extrapolate on that pattern (albeit in a predictable way).  The value <code>j</code> could then be chosen to find a compromise between a fair shuffle and a tolerable memory footprint.</p>\n"}, {"tags": ["c", "macros"], "answers": [{"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1468990403, "post_id": 38472331, "comment_id": 64348299, "body": "\u2026so that reference to HFP_CIEV_CHELD` is not a reference to the macro and is left unchanged, ready to trigger the compilation error."}], "tags": [], "owner": {"reputation": 71857, "user_id": 47453, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412dc332ab3593c636e5a5202cf98870?s=128&d=identicon&r=PG", "display_name": "Bill Lynch", "link": "https://stackoverflow.com/users/47453/bill-lynch"}, "is_accepted": true, "score": 7, "last_activity_date": 1468988894, "creation_date": 1468988894, "answer_id": 38472331, "question_id": 38472292, "link": "https://stackoverflow.com/questions/38472292/undefined-error-with-macro-defined/38472331#38472331", "title": "undefined error with macro defined", "body": "<p>At the end of the line you have:</p>\n\n<pre><code>BT_str_len(HFP_CIEV_CHELD)\n</code></pre>\n\n<p>But your macro expects you to pass some arguments to <code>HFP_CIEV_CHELD</code>.</p>\n"}], "owner": {"reputation": 109, "user_id": 3583842, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/848e1219b7246300ed96762cfcf11fab?s=128&d=identicon&r=PG&f=1", "display_name": "Abhinav", "link": "https://stackoverflow.com/users/3583842/abhinav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 462, "favorite_count": 0, "accepted_answer_id": 38472331, "answer_count": 1, "score": -1, "last_activity_date": 1468988894, "creation_date": 1468988685, "last_edit_date": 1468988790, "question_id": 38472292, "link": "https://stackoverflow.com/questions/38472292/undefined-error-with-macro-defined", "title": "undefined error with macro defined", "body": "<p>I am getting the following error:</p>\n\n<blockquote>\n  <p>error: 'HFP_CIEV_CHELD' undeclared (first use in this function)</p>\n</blockquote>\n\n<p>I have defined a macro at the top of the files like this-</p>\n\n<pre><code>#define HFP_CIEV_CHELD(n)           (UCHAR*)\"\\r\\n+CIEV: 4,\" #n \"\\r\\n\"\n</code></pre>\n\n<p>and using in the function</p>\n\n<pre><code>switch(status-&gt;index)\n{\n    case AGABS_HFP_CALL_HELD_INDEX :\n    Ag_send_data(HFP_CIEV_CHELD(status-&gt;dwCievStatus),(UCHAR)BT_str_len(HFP_CIEV_CHELD));\n    break;\n</code></pre>\n\n<p>What is wrong in this ?</p>\n"}, {"tags": ["python", "c", "pointers", "ctypes"], "answers": [{"comments": [{"owner": {"reputation": 159, "user_id": 5847503, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0407adbd20973e532bd54b97bef08543?s=128&d=identicon&r=PG&f=1", "display_name": "user39602", "link": "https://stackoverflow.com/users/5847503/user39602"}, "edited": false, "score": 0, "creation_date": 1468996221, "post_id": 38472690, "comment_id": 64350543, "body": "Thanks a lot :) The problem got solved. As I&#39;m new to Python ,can you refer me any tutorials or any website where I can learn linking the shared libraries having structures,pointers etc. with the python script ? Because I&#39;m somewhere stuck with one of the structures code also."}, {"owner": {"reputation": 26167, "user_id": 736937, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/b3ccac435e2fd4eb9be62da7830d887c?s=128&d=identicon&r=PG", "display_name": "jedwards", "link": "https://stackoverflow.com/users/736937/jedwards"}, "reply_to_user": {"reputation": 159, "user_id": 5847503, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0407adbd20973e532bd54b97bef08543?s=128&d=identicon&r=PG&f=1", "display_name": "user39602", "link": "https://stackoverflow.com/users/5847503/user39602"}, "edited": false, "score": 0, "creation_date": 1468996460, "post_id": 38472690, "comment_id": 64350672, "body": "You&#39;ve seen the link I referenced in the question, right?  (<a href=\"http://chimera.labs.oreilly.com/books/1230000000393/ch15.html\" rel=\"nofollow noreferrer\">This</a>).  The <a href=\"https://docs.python.org/3/library/ctypes.html\" rel=\"nofollow noreferrer\">ctypes documentation</a> is quite helpful, as well as the <a href=\"https://docs.python.org/2/extending/index.html\" rel=\"nofollow noreferrer\">Extending Python...</a> section of the docs."}, {"owner": {"reputation": 159, "user_id": 5847503, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0407adbd20973e532bd54b97bef08543?s=128&d=identicon&r=PG&f=1", "display_name": "user39602", "link": "https://stackoverflow.com/users/5847503/user39602"}, "edited": false, "score": 0, "creation_date": 1468997686, "post_id": 38472690, "comment_id": 64351427, "body": "Ya I referred to the code that you had mentioned in the link :). Well again thanks, will have a look to the ctypes documentation and the extended python docs."}], "tags": [], "owner": {"reputation": 26167, "user_id": 736937, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/b3ccac435e2fd4eb9be62da7830d887c?s=128&d=identicon&r=PG", "display_name": "jedwards", "link": "https://stackoverflow.com/users/736937/jedwards"}, "is_accepted": true, "score": 0, "last_activity_date": 1468991412, "last_edit_date": 1495541287, "creation_date": 1468991065, "answer_id": 38472690, "question_id": 38472284, "link": "https://stackoverflow.com/questions/38472284/linking-pointer-arguments-from-a-c-function-with-a-ctype-argument-in-python-scri/38472690#38472690", "title": "Linking pointer arguments from a C function with a ctype argument in python script", "body": "<p><strong>Edit</strong></p>\n\n<p>It looks like you're calling your wrapped divide function with three integer arguments (<code>mydll.divide(4,32,3)</code>).  That won't work.  See the below code for how you probably want to specify the third argument.  The rest of my post may be unnecessary, but I'm leaving it anyway for any future readers with different problems.</p>\n\n<hr>\n\n<p>I'd first make sure you're compiling your DLL with the same bitness as your python distribution (e.g. 32 vs. 64 bit).</p>\n\n<p>Next, your code has an error in that <code>remainder = a % b;</code> should be <code>*remainder = a % b;</code> (Presumably you're working from <a href=\"http://chimera.labs.oreilly.com/books/1230000000393/ch15.html\" rel=\"nofollow noreferrer\">here</a>.)</p>\n\n<p>Lastly, the following code works for me (under Linux, so using gcc and .so files instead of .dll files):</p>\n\n<p><strong>pointer.c</strong></p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\nint divide(int a, int b, int *remainder)\n{\n    int quot = a / b;    \n    *remainder = a % b;\n    return quot;\n}\n</code></pre>\n\n<p><strong>test.py</strong></p>\n\n<pre><code>import ctypes as C\nfrom ctypes import *\nmydll=CDLL('pointer.so')\nmydll.divide.argtypes=(C.c_int, C.c_int, C.POINTER(C.c_int))\nmydll.divide.restype=C.c_int\n\nrem = C.c_int()\nres = mydll.divide(10, 3, rem)\n\nprint(res, rem.value)\n</code></pre>\n\n<p>When run, this correctly prints <code>(3, 1)</code>.</p>\n\n<hr>\n\n<p>Notes:</p>\n\n<ul>\n<li>Using gcc, this was compiled with: <code>gcc -g -Wall -shared -fPIC -I/usr/include/python2.7/ pointer.c -o pointer.so</code></li>\n<li>I was able to remove the <code>__declspec</code> because <a href=\"https://stackoverflow.com/questions/18276362/why-do-i-need-declspecdllexport-to-make-some-functions-accessible-from-ctype\">gcc exports all symbols by default</a>, if you're using a different compiler, you may need to leave it in.</li>\n<li>I didn't use a .h file</li>\n</ul>\n"}], "owner": {"reputation": 159, "user_id": 5847503, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0407adbd20973e532bd54b97bef08543?s=128&d=identicon&r=PG&f=1", "display_name": "user39602", "link": "https://stackoverflow.com/users/5847503/user39602"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 174, "favorite_count": 1, "accepted_answer_id": 38472690, "answer_count": 1, "score": 2, "last_activity_date": 1469356785, "creation_date": 1468988640, "last_edit_date": 1469356785, "question_id": 38472284, "link": "https://stackoverflow.com/questions/38472284/linking-pointer-arguments-from-a-c-function-with-a-ctype-argument-in-python-scri", "title": "Linking pointer arguments from a C function with a ctype argument in python script", "body": "<p>The following is a simple code showing division of a number: </p>\n\n<pre><code>//pointer.h\n#include&lt;stdio.h&gt;\nint divide(int , int , int *);\n\n//pointer.c\n#include&lt;stdio.h&gt;\n\n__declspec(dllexport) int divide(int a, int b, int *remainder)\n\n{\n    int quot = a / b;    \n    remainder = a % b;\n    return quot;\n}\n</code></pre>\n\n<p>As shown in the pointer.c, remainder is a pointer type argument whose value will be calculated in the function itself. Can anyone tell me how to get the value linked from this function to the python script as written below:</p>\n\n<pre><code>//python script\nimport ctypes as C\nfrom ctypes import *\nmydll=CDLL('pointer.dll')\nmydll.divide.argtypes=(C.c_int,C.c_int,C.POINTER(C.c_int))\nmydll.divide.restype=C.c_int\n</code></pre>\n\n<p>The below is the error that I'm getting.</p>\n\n<blockquote>\n  <blockquote>\n    <blockquote>\n      <p>mydll.divide(4,32,3)\n      Traceback (most recent call last):\n        File \"\", line 1, in \n          mydll.divide(4,32,3)\n      ctypes.ArgumentError: argument 3: : expected LP_c_long instance instead of int</p>\n    </blockquote>\n  </blockquote>\n</blockquote>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 19601, "user_id": 1620779, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/dlgGb.png?s=128&g=1", "display_name": "sjsam", "link": "https://stackoverflow.com/users/1620779/sjsam"}, "edited": false, "score": 1, "creation_date": 1468988334, "post_id": 38472226, "comment_id": 64347733, "body": "Who prevents you from putting the absolute path to the <code>csv file</code>?"}, {"owner": {"reputation": 4328, "user_id": 920069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd39f0db1f22e1314746491df063602a?s=128&d=identicon&r=PG", "display_name": "Retired Ninja", "link": "https://stackoverflow.com/users/920069/retired-ninja"}, "edited": false, "score": 1, "creation_date": 1468988350, "post_id": 38472226, "comment_id": 64347736, "body": "Or a proper relative path?"}, {"owner": {"reputation": 31, "user_id": 6151035, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/nOyEN.jpg?s=128&g=1", "display_name": "Piyush", "link": "https://stackoverflow.com/users/6151035/piyush"}, "edited": false, "score": 0, "creation_date": 1468988605, "post_id": 38472226, "comment_id": 64347797, "body": "I am running my program through cmd. Now problem is exe get generated in &quot;out&quot; folder, which I dont have before running the program. so i can not give absolute path."}, {"owner": {"reputation": 31, "user_id": 6151035, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/nOyEN.jpg?s=128&g=1", "display_name": "Piyush", "link": "https://stackoverflow.com/users/6151035/piyush"}, "edited": false, "score": 0, "creation_date": 1468989074, "post_id": 38472226, "comment_id": 64347924, "body": "i tried with dirent.h, to get directory path of cpp, but getting compilation error that dirent.h doesnt exist."}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 6151035, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/nOyEN.jpg?s=128&g=1", "display_name": "Piyush", "link": "https://stackoverflow.com/users/6151035/piyush"}, "edited": false, "score": 1, "creation_date": 1468989416, "post_id": 38472367, "comment_id": 64348011, "body": "Thanks Jeegar.. actually i dont want to give hard coded path. I will try this macro btw and let you know if things works for me"}, {"owner": {"reputation": 23469, "user_id": 775964, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/glHLl.jpg?s=128&g=1", "display_name": "Jeegar Patel", "link": "https://stackoverflow.com/users/775964/jeegar-patel"}, "reply_to_user": {"reputation": 31, "user_id": 6151035, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/nOyEN.jpg?s=128&g=1", "display_name": "Piyush", "link": "https://stackoverflow.com/users/6151035/piyush"}, "edited": false, "score": 0, "creation_date": 1468989608, "post_id": 38472367, "comment_id": 64348075, "body": "<b>FILE</b> it will give you full path of that cpp file then using basename() you can get it upto folder name...Updated demo code in answer ..."}, {"owner": {"reputation": 31, "user_id": 6151035, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/nOyEN.jpg?s=128&g=1", "display_name": "Piyush", "link": "https://stackoverflow.com/users/6151035/piyush"}, "edited": false, "score": 0, "creation_date": 1468990942, "post_id": 38472367, "comment_id": 64348465, "body": "jeegar this basename works in linux only i guess..my program is for cross platform. right now  &lt;libgen.h&gt; is doesnt exist for me."}], "tags": [], "owner": {"reputation": 23469, "user_id": 775964, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/glHLl.jpg?s=128&g=1", "display_name": "Jeegar Patel", "link": "https://stackoverflow.com/users/775964/jeegar-patel"}, "is_accepted": false, "score": 0, "last_activity_date": 1468989584, "last_edit_date": 1468989584, "creation_date": 1468989143, "answer_id": 38472367, "question_id": 38472226, "link": "https://stackoverflow.com/questions/38472226/how-to-make-fopen-works-if-working-directory-and-source-directory-are-different/38472367#38472367", "title": "how to make fopen works if working directory and source directory are different and file reside share the source directory?", "body": "<pre><code>#define PATH \"/home/logan/path_to_cpp_file/\"\n\nint main (int argc, char **argv)\n{\n   char file2open[256];\n\n   sprintf (file2open, \"%sfoo.csv\", PATH);\n   fd = open (file2open, O_RDONLY)\n      ......\n   close (fd);\n\n}\n</code></pre>\n\n<p>This way it will search for that file in cpp file folder.</p>\n\n<hr>\n\n<p>Or if you do not want to give the path of cpp file folder as above hard coded then you can use some macro like <code>__FILE__</code> which would you give the path of cpp file.</p>\n\n<pre><code>char* fileName = basename(__FILE__);\n</code></pre>\n\n<hr>\n\n<p>Or anothe way is to pass the file path as argument to command.</p>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 6151035, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/nOyEN.jpg?s=128&g=1", "display_name": "Piyush", "link": "https://stackoverflow.com/users/6151035/piyush"}, "is_accepted": false, "score": 0, "last_activity_date": 1468993415, "creation_date": 1468993415, "answer_id": 38473127, "question_id": 38472226, "link": "https://stackoverflow.com/questions/38472226/how-to-make-fopen-works-if-working-directory-and-source-directory-are-different/38473127#38473127", "title": "how to make fopen works if working directory and source directory are different and file reside share the source directory?", "body": "<p>here i am posting answer of my question so that someone get help from it</p>\n\n<pre><code>char path_buffer[] = __FILE__;\n    char drive[_MAX_DRIVE];\n    char dir[_MAX_DIR];\n    char fname[_MAX_FNAME];\n    char ext[_MAX_EXT];\n\n    _splitpath(path_buffer, drive, dir, fname, ext);\n\n    strcpy(fname, \"AvailableUsage\");\n    strcpy(ext, \".csv\");\n\n    _makepath(path_buffer, drive, dir, fname, ext);\n\n    FILE *fp = fopen(path_buffer, \"r\");\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 6151035, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/nOyEN.jpg?s=128&g=1", "display_name": "Piyush", "link": "https://stackoverflow.com/users/6151035/piyush"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 254, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1468993415, "creation_date": 1468988213, "question_id": 38472226, "link": "https://stackoverflow.com/questions/38472226/how-to-make-fopen-works-if-working-directory-and-source-directory-are-different", "title": "how to make fopen works if working directory and source directory are different and file reside share the source directory?", "body": "<p>I have a CSV file to read, which is in same directory of cpp. While building the code, exe get generated in different folder (out folder itself get generated). I know while running program current working directory is directory of exe thats why fopen returns null. How can i get the path of cpp and pass it in fopen to make it work. Note: \"I can not use iostream\"</p>\n"}, {"tags": ["c", "opengl-es-2.0"], "answers": [{"tags": [], "owner": {"reputation": 842, "user_id": 1085128, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9798134a47d85c790e2ee0da92f66a9e?s=128&d=identicon&r=PG", "display_name": "mako", "link": "https://stackoverflow.com/users/1085128/mako"}, "is_accepted": false, "score": 0, "last_activity_date": 1468986162, "creation_date": 1468986162, "answer_id": 38471942, "question_id": 38471941, "link": "https://stackoverflow.com/questions/38471941/mipmaps-in-gles2-coming-out-blank/38471942#38471942", "title": "Mipmaps in gles2 coming out blank", "body": "<p>the mipmap level argument of glImage2d doesn't mean what you think it means. It specifies the mipmap level of dat, not the desired lowest mipmap level associated with bigTex, so what you're saying there is that you want to define the fifth mipmap level of bigTex. You never see the fifth mipmap level of bigTex, so everything just looks blank- because you never defined the higher mipmap levels.</p>\n\n<p>Since dat is the most detailed level (<code>0</code>), that's the level you define. So get rid of <code>mipmapLevel</code>, and do</p>\n\n<pre><code>glTexImage2D(GL_TEXTURE_2D, 0, GL_ALPHA, texSpan.x, texSpan.y, 0, GL_ALPHA, GL_UNSIGNED_BYTE, dat);\n</code></pre>\n\n<p>You've seen that this works, but you think it's disabling mipmapping because the results of downscaling don't look good. Mipmaps should be in effect, at that point. Set your GL_TEXTURE_MIN_FILTER to GL_LINEAR_MIPMAP_NEAREST instead of GL_LINEAR, and throw in a <code>glHint(GL_GENERATE_MIPMAP_HINT, GL_NICEST);</code> for good measure, and you will see that.</p>\n"}], "owner": {"reputation": 842, "user_id": 1085128, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9798134a47d85c790e2ee0da92f66a9e?s=128&d=identicon&r=PG", "display_name": "mako", "link": "https://stackoverflow.com/users/1085128/mako"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1468986162, "creation_date": 1468986162, "question_id": 38471941, "link": "https://stackoverflow.com/questions/38471941/mipmaps-in-gles2-coming-out-blank", "title": "Mipmaps in gles2 coming out blank", "body": "<pre><code>glGenTextures(1, &amp;bigTex);\nglBindTexture(GL_TEXTURE_2D, bigTex);\nu32 mipmapLevel = max(0, (int)greaterOrEqualPowerOfTwoExponent(max(packing.bounds.x, packing.bounds.y)) - 4);\nglTexImage2D(GL_TEXTURE_2D, mipmapLevel, GL_ALPHA, texSpan.x, texSpan.y, 0, GL_ALPHA, GL_UNSIGNED_BYTE, dat);\nglGenerateMipmap(GL_TEXTURE_2D);\nglTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_S, GL_CLAMP_TO_EDGE);\nglTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_LINEAR);\nglTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_LINEAR);\n</code></pre>\n\n<p>This seems to be producing blank (and opaque) textures. Disabling mipmaps by setting mipmapLevel to zero causes it to render as normal, but of course, then there is no mipmapping.</p>\n"}, {"tags": ["c", "linux", "systems-programming"], "answers": [{"comments": [{"owner": {"reputation": 14710, "user_id": 5538420, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/oc81s.jpg?s=128&g=1", "display_name": "dxiv", "link": "https://stackoverflow.com/users/5538420/dxiv"}, "edited": false, "score": 2, "creation_date": 1468989294, "post_id": 38472218, "comment_id": 64347987, "body": "The question is a complete duplicate of <a href=\"http://stackoverflow.com/questions/16414622/array-initialization-c\">Array initialization C</a>. That said, I like your answer better than the ones given there."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1468991435, "post_id": 38472218, "comment_id": 64348605, "body": "The dup mentioned in the answer <a href=\"http://stackoverflow.com/q/7043372\">SO 7043372</a> is a C++ question, whereas this is for C.  It&#39;s preferable to keep C questions duplicated to other C questions."}], "tags": [], "owner": {"reputation": 1275, "user_id": 5058676, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-WPjsyC41Gy0/AAAAAAAAAAI/AAAAAAAABNY/Fs0vX3pO_wA/photo.jpg?sz=128", "display_name": "evaitl", "link": "https://stackoverflow.com/users/5058676/evaitl"}, "is_accepted": true, "score": 5, "last_activity_date": 1468988535, "last_edit_date": 1495535328, "creation_date": 1468988146, "answer_id": 38472218, "question_id": 38471904, "link": "https://stackoverflow.com/questions/38471904/initialize-array-in-c-in-the-format-int-a3-0/38472218#38472218", "title": "Initialize array in c in the format `int a[3]={0,};`", "body": "<p>This is probably a <a href=\"https://stackoverflow.com/q/7043372/5058676\">dup</a>, but I'll take a shot anyhow.</p>\n\n<p>There is no difference between   <code>int arr[3] ={0,};</code>  and   <code>int arr[3] ={0};</code>. </p>\n\n<p>Ref: C11 6.7.9:</p>\n\n<pre><code>    initializer:\n         assignment-expression\n         { initializer-list }\n         { initializer-list , }\n</code></pre>\n\n<p>Both forms of initializer lists are considered initializers.  The form with the comma at the end is preferred by many because it makes it easier to rearrange or add elements to the list during code maintenance. </p>\n\n<pre><code> int arr[3] ={0,}; \n</code></pre>\n\n<p>declares an array of three elements and initializes the first element to 0. When you do a partial initialization, the rest of the array is automatically initialized with zeros. </p>\n\n<p>Ref. C11 6.7.9:</p>\n\n<blockquote>\n  <p>If there are fewer initializers in a brace-enclosed list than there\n  are elements or members of an aggregate, or fewer characters in a\n  string literal used to initialize an array of known size than there\n  are elements in the array, the remainder of the aggregate shall be\n  initialized implicitly the same as objects that have static storage\n  duration.</p>\n</blockquote>\n"}], "owner": {"reputation": 297, "user_id": 3651370, "user_type": "registered", "accept_rate": 27, "profile_image": "https://graph.facebook.com/100001475058179/picture?type=large", "display_name": "Bhavith C Acharya", "link": "https://stackoverflow.com/users/3651370/bhavith-c-acharya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 1, "closed_date": 1468991454, "accepted_answer_id": 38472218, "answer_count": 1, "score": 2, "last_activity_date": 1501434903, "creation_date": 1468985888, "last_edit_date": 1501434903, "question_id": 38471904, "link": "https://stackoverflow.com/questions/38471904/initialize-array-in-c-in-the-format-int-a3-0", "closed_reason": "Duplicate", "title": "Initialize array in c in the format `int a[3]={0,};`", "body": "<p>I had seen a source where array initialize in <code>int arr[3] ={0,};</code> What does it mean ? I normally use this format <code>int arr[3]={0};</code> can i know what is the difference </p>\n"}, {"tags": ["c", "linux", "cmake", "openssl", "arm"], "comments": [{"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1469001040, "post_id": 38471414, "comment_id": 64353528, "body": "Drop the trailing <code>openssl</code> from <code>SET(OPENSSL_INCLUDE_DIR &quot;..&#47;..&#47;ssl&#47;usr&#47;local&#47;ssl&#47;include&#47;openssl&#47;&quot;)</code>. Source files will <code>#include &lt;openssl&#47;header.h&gt;</code>, and combined it results in a header path of <code>...&#47;ssl&#47;usr&#47;local&#47;ssl&#47;include&#47;openssl&#47;openssl&#47;header.h</code>. You might also try using <code>make V=1</code> or <code>make VERBOSE=1</code>. It will give you more information than the traditional and nearly useless Cmake output."}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1469003494, "post_id": 38471414, "comment_id": 64354992, "body": "You may also want to include <code>-mthumb -mcpu=cortex-m4</code> in <code>CFLAGS</code> and <code>CXXFLAGS</code> for the Cortex-M4. And possibly <code>-mfloat-abi=softfp -mfpu=fpv4-sp-d16</code> if there&#39;s a soft floating point unit and <code>-mfloat-abi=hard -mfpu=fpv4-sp-d16</code> for a hard floating point unit. Also see <a href=\"http://stackoverflow.com/q/10085945\">cmake CFLAGS CXXFLAGS modification</a>."}, {"owner": {"reputation": 5817, "user_id": 4742108, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/GvE0m.jpg?s=128&g=1", "display_name": "Velkan", "link": "https://stackoverflow.com/users/4742108/velkan"}, "edited": false, "score": 0, "creation_date": 1469082024, "post_id": 38471414, "comment_id": 64392782, "body": "Just debug the <code>&#47;usr&#47;share&#47;cmake-3.5&#47;Modules&#47;FindOpenSSL.cmake</code> by using <code>message()</code> function to output variables."}], "answers": [{"tags": [], "owner": {"reputation": 2823, "user_id": 1172181, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/84ac4d27e33d7761c73f78fa98f549b5?s=128&d=identicon&r=PG&f=1", "display_name": "Luis", "link": "https://stackoverflow.com/users/1172181/luis"}, "is_accepted": false, "score": 1, "last_activity_date": 1475007850, "creation_date": 1475007850, "answer_id": 39733678, "question_id": 38471414, "link": "https://stackoverflow.com/questions/38471414/cmake-errors-when-cross-compiling-libwebsockets-for-arm-cortex-m4/39733678#39733678", "title": "cmake errors when cross-compiling libwebsockets for arm cortex-m4", "body": "<p>I had the same issue. Setting the following variables in my <strong><em>toolchain.cmake</em></strong> file did the trick:</p>\n\n<pre><code>SET(ZLIB_INCLUDE_DIR ../../../build/buildroot-build/staging/usr/include)\nSET(ZLIB_LIBRARY ../../../build/buildroot-build/target/usr/lib/libz.so)\n\nSET(OPENSSL_ROOT_DIR ../../../build/buildroot-build/target/usr)\nSET(OPENSSL_LIBRARIES ../../../build/buildroot-build/target/usr/lib)\nSET(OPENSSL_INCLUDE_DIR ../../../build/buildroot-build/staging/usr/include/openssl)\nSET(OPENSSL_CRYPTO_LIBRARY ../../../build/buildroot-build/target/usr/lib/libcrypto.so)\nSET(OPENSSL_SSL_LIBRARY ../../../build/buildroot-build/target/usr/lib/libssl.so)\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 3720661, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvtyu.jpg?s=128&g=1", "display_name": "tphelican", "link": "https://stackoverflow.com/users/3720661/tphelican"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1084, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1475007850, "creation_date": 1468982321, "question_id": 38471414, "link": "https://stackoverflow.com/questions/38471414/cmake-errors-when-cross-compiling-libwebsockets-for-arm-cortex-m4", "title": "cmake errors when cross-compiling libwebsockets for arm cortex-m4", "body": "<p><em>Let me preface this question: I've spent hours today researching this problem, with many hits on stackoverflow. I feel like I'm close, but there's always something in the way. I wouldn't be asking if I didn't feel like I've exhausted what Google has to offer. I know my target intimately and have cross-compiled many open source packages successfully, however, given that libwebsockets uses cmake, which I'm unfamiliar with, the errors are quite alien to me; I suppose I could pour through cmake documentation, but I doubt I'd find the answer within the timeframe I have.</em> </p>\n\n<p>I'm trying to cross-compile libwebsockets for an ARM-Cortex-M4 platform. I've followed the instructions from the libwebsockets documentation:\n1) create a \"build\" directory above the libwebsockets source directory. \n2) From within the build directory, call cmake:</p>\n\n<pre><code>cmake .. -DCMAKE_TOOLCHAIN_FILE=../cross.cmake\n</code></pre>\n\n<p>3) I've used their ARM template to create cross.cmake </p>\n\n<pre><code>#\n# CMake Toolchain file for crosscompiling on ARM.\n#\n# This can be used when running cmake in the following way:\n#  cd build/\n#  cmake .. -DCMAKE_TOOLCHAIN_FILE=../cross-arm-linux-gnueabihf.cmake\n#\n\n\n# Name of C compiler.\nSET(CMAKE_C_COMPILER \"arm-uclinuxeabi-gcc\")\nSET(CMAKE_CXX_COMPILER \"arm-uclinuxeabi-g++\")\n\n\n# this one is important\nSET(CMAKE_SYSTEM_NAME Linux)\n#this one not so much\nSET(CMAKE_SYSTEM_VERSION 1)\nSET(BUILD_SHARED_LIBS OFF)\n\n# where is the target environment \nSET(CMAKE_FIND_ROOT_PATH  ../../../../A2F ../../../../tools ../../../xv-nic)\nSET(ZLIB_INCLUDE_DIR \"../lzo-2.09/\")\nSET(ZLIB_LIBRARY \"../../lib/libz.a\")\nSET(OPENSSL_ROOT_DIR \"../../ssl\")\nSET(OPENSSL_LIBRARIES \"../../ssl/usr/local/ssl/lib/\")\nSET(OPENSSL_INCLUDE_DIR \"../../ssl/usr/local/ssl/include/openssl/\")\n\n# search for programs in the build host directories\nSET(CMAKE_FIND_ROOT_PATH_MODE_PROGRAM NEVER)\n# for libraries and headers in the target directories\nSET(CMAKE_FIND_ROOT_PATH_MODE_LIBRARY ONLY)\nSET(CMAKE_FIND_ROOT_PATH_MODE_INCLUDE ONLY)\n</code></pre>\n\n<p>4) This fails with this complaint</p>\n\n<pre><code>Compiling with SSL support\nCMake Error at /usr/share/cmake-3.5/Modules/FindPackageHandleStandardArgs.cmake:148 (message):\n  Could NOT find OpenSSL, try to set the path to OpenSSL root folder in the\n  system variable OPENSSL_ROOT_DIR (missing: **OPENSSL_LIBRARIES**)\nCall Stack (most recent call first):\n  /usr/share/cmake-3.5/Modules/FindPackageHandleStandardArgs.cmake:388 (_FPHSA_FAILURE_MESSAGE)\n  /usr/share/cmake-3.5/Modules/FindOpenSSL.cmake:370 (find_package_handle_standard_args)\n  CMakeLists.txt:816 (find_package)\n</code></pre>\n\n<p>Now, what's curious/frustrating is that I <em>do</em> have openssl installed where I claim to; further, if I remove </p>\n\n<pre><code>SET(ZLIB_INCLUDE_DIR \"../lzo-2.09/\")\n</code></pre>\n\n<p>, I get a complaint similar to the libraries complaint. Further, cmake seems to find zlib which is present in a similar way. I've compiled several other applications with this ssl setup without trouble, though I'm unfamiliar with cmake in general.</p>\n\n<p>I've tried to be as verbose as possible without crafting a post too long to read, so if I've left something out, I'd be happy to provide more detail if anyone has fought through this. Thanks in advance! </p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 2, "creation_date": 1468979794, "post_id": 38471098, "comment_id": 64345920, "body": "<code>&quot;@&quot;</code> is not a character, it&#39;s a string. <code>&#39;@&#39;</code> is a character."}], "answers": [{"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1468992623, "post_id": 38471137, "comment_id": 64348944, "body": "Or use a string but tell <code>printf()</code> to expect a string: <code>printf(&quot;%s&quot;, &quot;@&quot;)</code> \u2014 or use <code>putchar(&#39;@&#39;)</code> to output single characters (and <code>putchar(&#39;\\n&#39;)</code> after the loop)."}, {"owner": {"reputation": 27437, "user_id": 95954, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/iD0qO.png?s=128&g=1", "display_name": "Rudy Velthuis", "link": "https://stackoverflow.com/users/95954/rudy-velthuis"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1469006262, "post_id": 38471137, "comment_id": 64356870, "body": "@Jonathan: correct, but I didn&#39;t want to confuse anyone. &lt;g&gt;"}], "tags": [], "owner": {"reputation": 27437, "user_id": 95954, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/iD0qO.png?s=128&g=1", "display_name": "Rudy Velthuis", "link": "https://stackoverflow.com/users/95954/rudy-velthuis"}, "is_accepted": false, "score": 5, "last_activity_date": 1468979983, "creation_date": 1468979983, "answer_id": 38471137, "question_id": 38471098, "link": "https://stackoverflow.com/questions/38471098/c-program-is-not-printing-character/38471137#38471137", "title": "C program is not printing &#39;@&#39; character", "body": "<p><code>\"@\"</code> is not a <code>char</code> literal, which <code>%c</code> expects, it is a string literal. Use single quotes for <code>char</code> literals:</p>\n\n<pre><code>printf(\"%c\", '@');\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 27437, "user_id": 95954, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/iD0qO.png?s=128&g=1", "display_name": "Rudy Velthuis", "link": "https://stackoverflow.com/users/95954/rudy-velthuis"}, "edited": false, "score": 1, "creation_date": 1468980824, "post_id": 38471185, "comment_id": 64346120, "body": "That will <b>not</b> print a number of &#39;@&#39; characters."}, {"owner": {"reputation": 85, "user_id": 6611261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4369b996dd26009a231173eabf801088?s=128&d=identicon&r=PG&f=1", "display_name": "prateek gurjar", "link": "https://stackoverflow.com/users/6611261/prateek-gurjar"}, "reply_to_user": {"reputation": 27437, "user_id": 95954, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/iD0qO.png?s=128&g=1", "display_name": "Rudy Velthuis", "link": "https://stackoverflow.com/users/95954/rudy-velthuis"}, "edited": false, "score": 0, "creation_date": 1468982696, "post_id": 38471185, "comment_id": 64346512, "body": "i don&#39;t get it what he want to do?"}, {"owner": {"reputation": 85, "user_id": 6611261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4369b996dd26009a231173eabf801088?s=128&d=identicon&r=PG&f=1", "display_name": "prateek gurjar", "link": "https://stackoverflow.com/users/6611261/prateek-gurjar"}, "reply_to_user": {"reputation": 27437, "user_id": 95954, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/iD0qO.png?s=128&g=1", "display_name": "Rudy Velthuis", "link": "https://stackoverflow.com/users/95954/rudy-velthuis"}, "edited": false, "score": 1, "creation_date": 1468982762, "post_id": 38471185, "comment_id": 64346532, "body": "if he want to print only &#39;@&#39; he can simply use :- printf(&quot;@&quot;); or puts(&quot;@&quot;);"}], "tags": [], "owner": {"reputation": 85, "user_id": 6611261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4369b996dd26009a231173eabf801088?s=128&d=identicon&r=PG&f=1", "display_name": "prateek gurjar", "link": "https://stackoverflow.com/users/6611261/prateek-gurjar"}, "is_accepted": false, "score": 0, "last_activity_date": 1468984970, "last_edit_date": 1468984970, "creation_date": 1468980367, "answer_id": 38471185, "question_id": 38471098, "link": "https://stackoverflow.com/questions/38471098/c-program-is-not-printing-character/38471185#38471185", "title": "C program is not printing &#39;@&#39; character", "body": "<p>Maybe that'll work:-</p>\n\n<pre><code>int ran;\nchar i;\nran = 1 + (rand() % 25 + 1 );\nfor (i = 0; i &lt; ran; i++)\n   {\n       printf(\"%c\", i);\n   }\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 4833386, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/75fd711cb5e4c23b481de0bd8a19b046?s=128&d=identicon&r=PG&f=1", "display_name": "user001", "link": "https://stackoverflow.com/users/4833386/user001"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 154, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1468984970, "creation_date": 1468979709, "last_edit_date": 1468984748, "question_id": 38471098, "link": "https://stackoverflow.com/questions/38471098/c-program-is-not-printing-character", "title": "C program is not printing &#39;@&#39; character", "body": "<p>I'm trying to print out a random number of \"@\" characters but my code is printing out random \"\\\\\" instead. Don't know whats going on here just need a little help.</p>\n\n<pre><code>int ran,i;\nran = 1 + (rand() % 25 + 1 );\nfor (i = 0; i &lt; ran; i++)\n    {\n        printf(\"%c\", \"@\");\n    }\nprintf(\"\\n\");\n</code></pre>\n"}, {"tags": ["c++", "c", "windows"], "comments": [{"owner": {"reputation": 25, "user_id": 6610980, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e785bea1b52b14ecb9cfcbc58ba12ac6?s=128&d=identicon&r=PG", "display_name": "user58337", "link": "https://stackoverflow.com/users/6610980/user58337"}, "edited": false, "score": 0, "creation_date": 1468972126, "post_id": 38470205, "comment_id": 64344352, "body": "What exactly is &quot;unclear?&quot; Come on guys."}, {"owner": {"reputation": 16949, "user_id": 7256, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zZFSI.jpg?s=128&g=1", "display_name": "janm", "link": "https://stackoverflow.com/users/7256/janm"}, "edited": false, "score": 0, "creation_date": 1468972149, "post_id": 38470205, "comment_id": 64344360, "body": "My reading is that you have a GUI program and you want to disable some keyboard based commands. Is that correct? If so, you should update your question. You should also state what platform you&#39;re using."}, {"owner": {"reputation": 16949, "user_id": 7256, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zZFSI.jpg?s=128&g=1", "display_name": "janm", "link": "https://stackoverflow.com/users/7256/janm"}, "edited": false, "score": 0, "creation_date": 1468972274, "post_id": 38470205, "comment_id": 64344398, "body": "The platform is unclear, and makes a big difference. Windows? Mac? X Windows? Etc."}, {"owner": {"reputation": 25, "user_id": 6610980, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e785bea1b52b14ecb9cfcbc58ba12ac6?s=128&d=identicon&r=PG", "display_name": "user58337", "link": "https://stackoverflow.com/users/6610980/user58337"}, "reply_to_user": {"reputation": 16949, "user_id": 7256, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zZFSI.jpg?s=128&g=1", "display_name": "janm", "link": "https://stackoverflow.com/users/7256/janm"}, "edited": false, "score": 1, "creation_date": 1468972326, "post_id": 38470205, "comment_id": 64344408, "body": "I didnt know there were exe files on mac or linux....."}, {"owner": {"reputation": 16949, "user_id": 7256, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zZFSI.jpg?s=128&g=1", "display_name": "janm", "link": "https://stackoverflow.com/users/7256/janm"}, "edited": false, "score": 0, "creation_date": 1468972404, "post_id": 38470205, "comment_id": 64344426, "body": "Well, there are executables but they don&#39;t have an exe extension. By saying &quot;Windows&quot; you make it clear. I&#39;ve voted to reopen -- your question seems reasonable to me: &quot;Can I write a program that will run an executable on Windows so that certain keystrokes are filtered out?&quot;"}, {"owner": {"reputation": 25, "user_id": 6610980, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e785bea1b52b14ecb9cfcbc58ba12ac6?s=128&d=identicon&r=PG", "display_name": "user58337", "link": "https://stackoverflow.com/users/6610980/user58337"}, "reply_to_user": {"reputation": 16949, "user_id": 7256, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zZFSI.jpg?s=128&g=1", "display_name": "janm", "link": "https://stackoverflow.com/users/7256/janm"}, "edited": false, "score": 0, "creation_date": 1468972525, "post_id": 38470205, "comment_id": 64344457, "body": "Updated. Thanks for the help boss."}, {"owner": {"reputation": 16949, "user_id": 7256, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zZFSI.jpg?s=128&g=1", "display_name": "janm", "link": "https://stackoverflow.com/users/7256/janm"}, "edited": false, "score": 0, "creation_date": 1468972590, "post_id": 38470205, "comment_id": 64344473, "body": "No problem. I agree someone should have given you feedback in comments rather than just closing."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 1, "creation_date": 1468972972, "post_id": 38470205, "comment_id": 64344553, "body": "Wow. A locked question that was unlocked. You must live well, for the gods truly favour you. Here&#39;s looking for a usable answer. Sadly I don&#39;t know of one."}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1468973340, "post_id": 38470205, "comment_id": 64344634, "body": "Your question is still pretty broad. While it may be possible to figure out what the IDs are of the menu items and send messages to the app to disable them, there&#39;s no guarantee that the app itself won&#39;t enable them again. Look at the case of items on the Edit menu in many apps that are enabled or disabled automatically depending on clipboard content, for instance. I have many apps I&#39;ve developed that dynamically enable/disable menu and toolbar buttons based on specific conditions at runtiime. There&#39;s no generic, one-size-fits-all answer to this question."}, {"owner": {"reputation": 16949, "user_id": 7256, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zZFSI.jpg?s=128&g=1", "display_name": "janm", "link": "https://stackoverflow.com/users/7256/janm"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1468973445, "post_id": 38470205, "comment_id": 64344655, "body": "@KenWhite There are other approaches. To disable keys entirely you could inject a DLL."}, {"owner": {"reputation": 3301, "user_id": 234946, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/6af8b76e0ae95edd533cf3a57e4294f8?s=128&d=identicon&r=PG", "display_name": "Olipro", "link": "https://stackoverflow.com/users/234946/olipro"}, "edited": false, "score": 0, "creation_date": 1468974591, "post_id": 38470205, "comment_id": 64344881, "body": "Do you not have access to the source code of the application? Is the binary obfuscated or protected? If not, it&#39;s probably easier to disassemble it and NOP/JMP out the branches where it looks for those keys."}], "answers": [{"tags": [], "owner": {"reputation": 16949, "user_id": 7256, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zZFSI.jpg?s=128&g=1", "display_name": "janm", "link": "https://stackoverflow.com/users/7256/janm"}, "is_accepted": false, "score": 1, "last_activity_date": 1469012287, "last_edit_date": 1469012287, "creation_date": 1468973380, "answer_id": 38470422, "question_id": 38470205, "link": "https://stackoverflow.com/questions/38470205/open-exe-from-another-exe-with-certain-keys-from-the-internal-exe-disabled/38470422#38470422", "title": "Open exe from another exe, with certain keys from the internal exe disabled", "body": "<p>The basic approach involves injecting a DLL into the process you are creating to hook the function call feeding keystrokes to the existing executable. </p>\n\n<p>You need to figure out what call(s) you need intercept, and then write a function that implements those calls and performs the filtering you need. That call should call the real implementation in the real DLL. Your new DLL contains the filtering call.</p>\n\n<p>I don't have time for a deeper answer now, may revisit later in the day.</p>\n\n<p>Update:</p>\n\n<p>I just had a look through some of my old code (from the late '90s) that injects a DLL to override various calls. It is more advanced that I remembered. The code overrode <code>GetProcAddress</code> and the <code>LoadLibrary*</code> functions with by iterating through the loaded modules an looking at the PE information. It found the exported symbols, changed the page protection and then updated the address to point to custom functions with hand-coded assembler prologs and epilogs. </p>\n\n<p>Given you have a single target executable, a simpler approach might be to modify the import table and make <code>GetMessage</code> and <code>PeekMesssage</code> point to your own version of the function that calls the real function but filters out messages with the keys you want to filter.</p>\n\n<p>Changing the import table is probably easier than trying to disassemble the application and NOP out the relevant branches. That way you just have a new DLL and you don't need a separate executable to launch the application. The import table format is documented, unlike your object code.</p>\n"}, {"tags": [], "owner": {"reputation": 191, "user_id": 5804032, "user_type": "registered", "profile_image": "https://graph.facebook.com/1086758154668612/picture?type=large", "display_name": "Junsuk Park", "link": "https://stackoverflow.com/users/5804032/junsuk-park"}, "is_accepted": false, "score": 0, "last_activity_date": 1468977458, "creation_date": 1468977458, "answer_id": 38470832, "question_id": 38470205, "link": "https://stackoverflow.com/questions/38470205/open-exe-from-another-exe-with-certain-keys-from-the-internal-exe-disabled/38470832#38470832", "title": "Open exe from another exe, with certain keys from the internal exe disabled", "body": "<p>I don't know how much skill level you have, but you can delete the code in the program.</p>\n\n<p>The code below is not specific GUI environment(MFC or Qt etc..) \nSome programs may include switch statment for handling keyboard events.</p>\n\n<pre><code>char inputKey = 'c';\nswitch(inputKey)\n{\n  case 'c':\n    //do something\n    break;\n  case 'd':\n    //do something\n    break;\n  default:\n    //do something\n}\n</code></pre>\n\n<p>If you want to filter out some key, just delete the case in switch statement code.</p>\n"}, {"tags": [], "owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "is_accepted": false, "score": 0, "last_activity_date": 1469004625, "creation_date": 1469004625, "answer_id": 38476574, "question_id": 38470205, "link": "https://stackoverflow.com/questions/38470205/open-exe-from-another-exe-with-certain-keys-from-the-internal-exe-disabled/38476574#38476574", "title": "Open exe from another exe, with certain keys from the internal exe disabled", "body": "<p>Given that it's a GUI EXE, that almost certainly means it's a Win32 executable. Keys are delivered to windows as messages, and windows process such messages in a <code>WindowProc</code>. You can create wrapper <code>WindowProc</code> functions that pre-process these messages and conditionally forward to the message. This is called <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms633570(v=vs.85).aspx#subclassing_window\" rel=\"nofollow\">\"subclassing\"</a>.</p>\n"}], "owner": {"reputation": 25, "user_id": 6610980, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e785bea1b52b14ecb9cfcbc58ba12ac6?s=128&d=identicon&r=PG", "display_name": "user58337", "link": "https://stackoverflow.com/users/6610980/user58337"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1469012287, "creation_date": 1468971596, "last_edit_date": 1468974806, "question_id": 38470205, "link": "https://stackoverflow.com/questions/38470205/open-exe-from-another-exe-with-certain-keys-from-the-internal-exe-disabled", "title": "Open exe from another exe, with certain keys from the internal exe disabled", "body": "<p>I have an exe (GUI) that the previous programmer left which was done in cpp, but I need to disable some of the keyboard keys in the program because when they are hit by accident, it is undesirable. I'm using Windows. <strong>Can I write a program that will run an executable on Windows so that certain keystrokes are filtered out?</strong></p>\n\n<p>Ultimately, I would just want to disable certain keys for my current exe, but I don't have the project files.</p>\n"}, {"tags": ["c", "macos", "makefile", "permissions"], "comments": [{"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1468972720, "post_id": 38469999, "comment_id": 64344498, "body": "Please show what command <code>make</code> was running when that error occurred and also show the exact directory ownership and permissions."}], "answers": [{"tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": true, "score": 1, "last_activity_date": 1468998129, "last_edit_date": 1495539858, "creation_date": 1468992172, "answer_id": 38472899, "question_id": 38469999, "link": "https://stackoverflow.com/questions/38469999/installing-c-library-but-permission-denied/38472899#38472899", "title": "Installing C library but Permission Denied?", "body": "<p>Welcome to Mac OS X 10.11 El Capitan and the SIP \u2014 System Integrity Protection \u2014 feature.</p>\n\n<p>You can't install software in <code>/usr/lib</code> \u2014 not even if you're <code>root</code>.</p>\n\n<p>You may install software under <code>/usr/local</code>, or under <code>/opt</code>.</p>\n\n<p>See the discussion in <a href=\"https://stackoverflow.com/questions/33074492/\">Can Mac OS X El Capitan run software compiled for Yosemite that expects libraries in <code>/usr/gnu64/lib</code>?</a>.  The short answer is \"No \u2014 you can't run software that was compiled to expect libraries in a sub-directory of <code>/usr</code> that is not under <code>/usr/local</code>\".  And the answer for \"can I install libraries in <code>/usr/lib</code>?\" is equally emphatically \"No\".  The question has some links to resources.</p>\n"}], "owner": {"reputation": 37, "user_id": 5221614, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/44900ca6c40aec80a2a2b20719e67d49?s=128&d=identicon&r=PG&f=1", "display_name": "Adam G.", "link": "https://stackoverflow.com/users/5221614/adam-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 38472899, "answer_count": 1, "score": 0, "last_activity_date": 1468998152, "creation_date": 1468970092, "last_edit_date": 1468998152, "question_id": 38469999, "link": "https://stackoverflow.com/questions/38469999/installing-c-library-but-permission-denied", "title": "Installing C library but Permission Denied?", "body": "<p>I'm trying to install this C library and I'm running:</p>\n\n<pre><code>sudo make  -f makefile.osx\n</code></pre>\n\n<p>but my terminal is telling me:</p>\n\n<pre><code>make: /usr/lib: Permission denied\n</code></pre>\n\n<p>My root user is enabled and my password is correct and everything, does anyone know what's wrong?</p>\n"}, {"tags": ["c", "operating-system"], "comments": [{"owner": {"reputation": 1275, "user_id": 5058676, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-WPjsyC41Gy0/AAAAAAAAAAI/AAAAAAAABNY/Fs0vX3pO_wA/photo.jpg?sz=128", "display_name": "evaitl", "link": "https://stackoverflow.com/users/5058676/evaitl"}, "edited": false, "score": 0, "creation_date": 1468970347, "post_id": 38469995, "comment_id": 64343935, "body": "Reading one byte at a time is incredibly slow. You have 3 traps to the kernel for every byte read."}, {"owner": {"reputation": 123967, "user_id": 251153, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4b25144c09555e7d5b5e288469e011ef?s=128&d=identicon&r=PG", "display_name": "zneak", "link": "https://stackoverflow.com/users/251153/zneak"}, "edited": false, "score": 0, "creation_date": 1468970365, "post_id": 38469995, "comment_id": 64343940, "body": "<code>Read</code>, <code>write</code> and <code>lseek</code> are all system calls, and system calls are slow. You would ideally read a lot of data and write a lot of data at once."}, {"owner": {"reputation": 13, "user_id": 6583767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8557de4de3c436fdaffaee12cd33b534?s=128&d=identicon&r=PG&f=1", "display_name": "Xeqtr", "link": "https://stackoverflow.com/users/6583767/xeqtr"}, "reply_to_user": {"reputation": 123967, "user_id": 251153, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4b25144c09555e7d5b5e288469e011ef?s=128&d=identicon&r=PG", "display_name": "zneak", "link": "https://stackoverflow.com/users/251153/zneak"}, "edited": false, "score": 0, "creation_date": 1468971898, "post_id": 38469995, "comment_id": 64344294, "body": "Thank you @zneak for the insights. I will keep this in mind programming forwards."}, {"owner": {"reputation": 13, "user_id": 6583767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8557de4de3c436fdaffaee12cd33b534?s=128&d=identicon&r=PG&f=1", "display_name": "Xeqtr", "link": "https://stackoverflow.com/users/6583767/xeqtr"}, "reply_to_user": {"reputation": 1275, "user_id": 5058676, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-WPjsyC41Gy0/AAAAAAAAAAI/AAAAAAAABNY/Fs0vX3pO_wA/photo.jpg?sz=128", "display_name": "evaitl", "link": "https://stackoverflow.com/users/5058676/evaitl"}, "edited": false, "score": 0, "creation_date": 1468971915, "post_id": 38469995, "comment_id": 64344297, "body": "Thank you @evaitl for the insights. I will keep this in mind programming forwards."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1468972675, "post_id": 38469995, "comment_id": 64344489, "body": "This will horrifically break utf-8 (or any other multibyte-encoding, as well as wide-character files)."}, {"owner": {"reputation": 13, "user_id": 6583767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8557de4de3c436fdaffaee12cd33b534?s=128&d=identicon&r=PG&f=1", "display_name": "Xeqtr", "link": "https://stackoverflow.com/users/6583767/xeqtr"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1468973000, "post_id": 38469995, "comment_id": 64344561, "body": "@EOF if I am not wrong will this happen because I am reading one byte at a time and characters (like wide characters ) have size greater than traditional 8-bit?"}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1468973337, "post_id": 38469995, "comment_id": 64344631, "body": "@Xeqtr: Yes, wide character encodings use more than one byte per character. Actually, utf-16 <i>might</i> work after reversing the file, because it&#39;s so poorly specified that the endianness of the encoding depends on the platform. utf-16 is <i>supposed</i> to have a  marker to specify the endianness at the beginning of the file, but it tends to be omitted. Anyway, utf-8 would <i>definitely</i> break."}, {"owner": {"reputation": 13, "user_id": 6583767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8557de4de3c436fdaffaee12cd33b534?s=128&d=identicon&r=PG&f=1", "display_name": "Xeqtr", "link": "https://stackoverflow.com/users/6583767/xeqtr"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1468973606, "post_id": 38469995, "comment_id": 64344682, "body": "@EOF this is amazing, I never thought this way , I will make sure to read regarding these formats and endian systems. Thank you again for this great insight!"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 6583767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8557de4de3c436fdaffaee12cd33b534?s=128&d=identicon&r=PG&f=1", "display_name": "Xeqtr", "link": "https://stackoverflow.com/users/6583767/xeqtr"}, "edited": false, "score": 0, "creation_date": 1468971997, "post_id": 38470058, "comment_id": 64344316, "body": "I get the idea now, I am new to the system calls and I should read more about efficiency also , Thank you so much for taking time out and answering."}], "tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": true, "score": 3, "last_activity_date": 1468970492, "creation_date": 1468970492, "answer_id": 38470058, "question_id": 38469995, "link": "https://stackoverflow.com/questions/38469995/c-reading-file-backwards-why-this-particular-method-is-not-considered-good/38470058#38470058", "title": "C: reading file backwards : why this particular method is not considered good?", "body": "<p>The method illustrated in your code is inefficient because you make 3 system calls for each byte in the file.  Furthermore, you do not check the return values of the <code>read()</code> and <code>write()</code> function calls, nor that the file was opened successfully.</p>\n\n<p>To improve efficiency, you should bufferize the input/output operations.</p>\n\n<ul>\n<li>Using <code>putchar()</code> instead of <code>write()</code> would be both more efficient and more reliable.</li>\n<li>Reading a chunk of file contents (from a few kilobytes to several megabytes) at a time would be more efficient too.</li>\n</ul>\n\n<p>As always, benchmark the resulting code to measure actual performance improvements.</p>\n"}], "owner": {"reputation": 13, "user_id": 6583767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8557de4de3c436fdaffaee12cd33b534?s=128&d=identicon&r=PG&f=1", "display_name": "Xeqtr", "link": "https://stackoverflow.com/users/6583767/xeqtr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 38470058, "answer_count": 1, "score": 0, "last_activity_date": 1468997059, "creation_date": 1468970073, "last_edit_date": 1468997059, "question_id": 38469995, "link": "https://stackoverflow.com/questions/38469995/c-reading-file-backwards-why-this-particular-method-is-not-considered-good", "title": "C: reading file backwards : why this particular method is not considered good?", "body": "<p>Hi I have a doubt regarding following question: In the OS textbook \"<strong>Operating Systems in Depth by Thomas W Doeppner</strong>\", one of the chapter exercise questions asks us to find fault with the given code for reading file contents backwards and also asks for a better way to do it. Now I have come across many ways to do that but cant really <em>find out why the following is not considered a good way of doing it</em>?</p>\n\n<p>Appreciate your time and help ,thank you!</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;unistd.h&gt;\n\nint main() {\n    int fd;\n    off_t fptr;\n    fd = open(\"./file.txt\", O_RDONLY);\n    char buf[3];\n    /* go to last char in file */\n    fptr = lseek(fd, (off_t)-1, SEEK_END);\n    while (fptr != -1) {\n        read(fd, buf, 1);\n        write(1, buf, 1);\n        fptr = lseek(fd, (off_t)-2, SEEK_CUR);\n    }\n    return 0;\n}\n</code></pre>\n"}]