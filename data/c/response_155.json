[{"tags": ["c", "malloc"], "answers": [{"comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 5, "creation_date": 1514419077, "post_id": 47999844, "comment_id": 82968494, "body": "Another reason on top of maintainability to use the form <code>source_t *temp = malloc( sizeof( *temp ) );</code>"}], "tags": [], "owner": {"reputation": 25589, "user_id": 15727, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/FFivc.jpg?s=128&g=1", "display_name": "Thomas Padron-McCarthy", "link": "https://stackoverflow.com/users/15727/thomas-padron-mccarthy"}, "is_accepted": true, "score": 5, "last_activity_date": 1514417718, "creation_date": 1514417718, "answer_id": 47999844, "question_id": 47999837, "link": "https://stackoverflow.com/questions/47999837/malloc-error-incorrect-checksum-for-freed-object-in-struct-for-reading-file/47999844#47999844", "title": "malloc error: incorrect checksum for freed object in struct for reading file", "body": "<p>This is probably not what you want to do:</p>\n\n<pre><code>source_t * temp = (source_t *) malloc(sizeof(source_t *));\n</code></pre>\n\n<p>That allocates space for a <em>pointer</em> to a source_t object, nor for a source_t object.</p>\n\n<p>Also, in C you shouldn't cast the return value of malloc. Doing so can hide errors, and make them very hard to find.</p>\n"}, {"comments": [{"owner": {"reputation": 14469, "user_id": 2191105, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/tPiCW.png?s=128&g=1", "display_name": "David Hoelzer", "link": "https://stackoverflow.com/users/2191105/david-hoelzer"}, "edited": false, "score": 0, "creation_date": 1514427236, "post_id": 47999881, "comment_id": 82970105, "body": "You said &quot;First of all&quot;... is there a second issue that you see?"}], "tags": [], "owner": {"reputation": 45, "user_id": 5654644, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5d01593bfc67aa8a430a8d10fecfc66c?s=128&d=identicon&r=PG", "display_name": "Guy Shilman", "link": "https://stackoverflow.com/users/5654644/guy-shilman"}, "is_accepted": false, "score": -1, "last_activity_date": 1514453222, "last_edit_date": 1514453222, "creation_date": 1514418087, "answer_id": 47999881, "question_id": 47999837, "link": "https://stackoverflow.com/questions/47999837/malloc-error-incorrect-checksum-for-freed-object-in-struct-for-reading-file/47999881#47999881", "title": "malloc error: incorrect checksum for freed object in struct for reading file", "body": "<p>In source_init() in the malloc() line you have a mistake.</p>\n\n<p>It should be:\n<code>source_t * temp = (source_t *) malloc(sizeof(source_t));</code></p>\n\n<p>and not:\n<code>source_t * temp = (source_t *) malloc(sizeof(source_t *));</code></p>\n"}, {"tags": [], "owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "is_accepted": false, "score": 2, "last_activity_date": 1519647002, "last_edit_date": 1519647002, "creation_date": 1514419249, "answer_id": 47999999, "question_id": 47999837, "link": "https://stackoverflow.com/questions/47999837/malloc-error-incorrect-checksum-for-freed-object-in-struct-for-reading-file/47999999#47999999", "title": "malloc error: incorrect checksum for freed object in struct for reading file", "body": "<p>Expanding on <a href=\"https://stackoverflow.com/a/47999844/1480131\">Thomas' answer</a></p>\n\n<ol>\n<li>Do not cast <code>malloc</code>, <code>calloc</code> or <code>realloc</code>. That just masks potential errors</li>\n<li>When possible, do not use <code>sizeof(&lt;data type&gt;)</code> when calculating the size. It's easy to make mistakes and makes re-factorization of your code a pain in the ****.</li>\n</ol>\n\n<p>Use this instead</p>\n\n<pre><code>source_t *temp = malloc(sizeof *temp);\n</code></pre>\n\n<p>This has the advantage that <code>sizeof *temp</code> returns exactly the correct number of bytes, you don't have to think about the correct type (like when you deal with double/triple pointers) and if you have to change the data type, let's say to <code>source2_t</code>, then you only have to change the type of the variable without worrying about pesky <code>sizeof(&lt;data type&gt;)</code> that can be overlooked easily.</p>\n"}], "owner": {"reputation": 65, "user_id": 9147089, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f604e995111aa8ef3895ea320bc3384?s=128&d=identicon&r=PG&f=1", "display_name": "SomBoii", "link": "https://stackoverflow.com/users/9147089/somboii"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2628, "favorite_count": 0, "accepted_answer_id": 47999844, "answer_count": 3, "score": 0, "last_activity_date": 1519647002, "creation_date": 1514417587, "question_id": 47999837, "link": "https://stackoverflow.com/questions/47999837/malloc-error-incorrect-checksum-for-freed-object-in-struct-for-reading-file", "title": "malloc error: incorrect checksum for freed object in struct for reading file", "body": "<p>So I have this function:</p>\n\n\n\n<pre><code>source_t * source_init(char * argsource)\n{\n    source_t * temp = (source_t *) malloc(sizeof(source_t *));\n    temp-&gt;path = realpath(argsource, NULL);\n    temp-&gt;dir = dirname(temp-&gt;path);\n    temp-&gt;name = basename(temp-&gt;path);\n    temp-&gt;ext = strrchr(temp-&gt;name, '.');\n    temp-&gt;content = read_file(temp-&gt;path); // here\n    temp-&gt;error = error_free();\n    return temp;\n}\n</code></pre>\n\n<p>It's calling function <code>read_file()</code>:</p>\n\n\n\n<pre><code>char * read_file(char * sourcepath)\n{\n    char * buffer = NULL;\n    long string_size, read_size;\n    FILE * file = fopen(sourcepath, \"r\");\n    fseek(file, 0, SEEK_END);\n    string_size = ftell(file);\n    rewind(file);\n    buffer = (char *) malloc(sizeof(char) * (string_size + 1) );\n    read_size = fread(buffer, sizeof(char), string_size, file);\n    buffer[string_size] = '\\0';\n    if (string_size != read_size)\n    {\n        free(buffer);\n        buffer = NULL;\n    }\n    fclose(file);\n    return buffer;\n}\n</code></pre>\n\n<p>and this error comes up: <code>malloc: *** error for object 0x7faf08402698: incorrect checksum for freed object - object was probably modified after being freed.</code> So my current solution is to separately initialise <code>content</code> after I have called <code>source_init()</code> in the main function. Although that solution works, I want <code>content</code> to be initialised in <code>source_init()</code>. Also it seems I can't directly call <code>source_init()</code> to initialise <code>content</code> because the same error comes up so I have to create a buffer to call <code>source_init()</code> and initialise <code>content</code> to buffer.</p>\n"}, {"tags": ["c", "gcc", "compilation", "pipe"], "comments": [{"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 1, "creation_date": 1514419270, "post_id": 47999819, "comment_id": 82968541, "body": "May I ask when you want to do this? I cannot see any use of it."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "reply_to_user": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 1, "creation_date": 1514445941, "post_id": 47999819, "comment_id": 82974846, "body": "@klutt: if the C code is generated by some program, you might want to do that. But indeed, it is not worth the pain"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "reply_to_user": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1514446283, "post_id": 47999819, "comment_id": 82974973, "body": "@klutt In general, pipelines are a Good Thing.  In general, any program should accept input from stdin, unless it has some very good reason for not doing so.  Just because you can&#39;t think of a good use for it, doesn&#39;t mean that having the general-purpose capability is not a good idea.  (Now, with that said, I agree it&#39;s hard to think of a situation where you&#39;d actually need to pipe C code into a C compiler.  I implemented the symbolic link trick -- as described in by answer -- many many years ago, just for fun, but I don&#39;t think I&#39;ve ever actually used it.)"}], "answers": [{"tags": [], "owner": {"reputation": 3928, "user_id": 7347631, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/905cba2c96dba01877d265382fd921a9?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Naguib", "link": "https://stackoverflow.com/users/7347631/andrew-naguib"}, "is_accepted": true, "score": 6, "last_activity_date": 1567636699, "last_edit_date": 1567636699, "creation_date": 1514417703, "answer_id": 47999843, "question_id": 47999819, "link": "https://stackoverflow.com/questions/47999819/pipeline-echo-to-gcc/47999843#47999843", "title": "pipeline echo to gcc?", "body": "<p>Yes, but you have to specify the language using the <code>-x</code> option. Specify input file as stdin, language as C using <code>-xc</code> (<em>if you want it to be C++, use <code>-xc++</code></em>). So in your case the command would be</p>\n\n<pre><code>echo '#include&lt;stdio.h&gt;\nvoid main()\n{\nprintf(\"Hello!\");\n}' | gcc -o output.o -xc -\n</code></pre>\n\n<p>You can read more about <a href=\"http://tigcc.ticalc.org/doc/comopts.html\" rel=\"nofollow noreferrer\">Command Line Compiler Arguments</a>: see <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Invoking-GCC.html\" rel=\"nofollow noreferrer\"><em>Invoking GCC</em></a> chapter.</p>\n\n<hr>\n\n<p>However, as @Basile says,  <strong>it is not worth the effort to avoid dealing with C files</strong>. <a href=\"https://stackoverflow.com/a/48003461/7347631\">Check his answer for more information</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "is_accepted": false, "score": 2, "last_activity_date": 1514471242, "last_edit_date": 1514471242, "creation_date": 1514445761, "answer_id": 48003330, "question_id": 47999819, "link": "https://stackoverflow.com/questions/47999819/pipeline-echo-to-gcc/48003330#48003330", "title": "pipeline echo to gcc?", "body": "<p>I have done this in the past by doing</p>\n\n<pre><code>ln -s /dev/stdin stdin.c\n</code></pre>\n\n<p>Now <code>stdin.c</code> is a symlink to <code>/dev/stdin</code>, i.e. a magic file \"containing\" anything I type or pipe to it.  But the filename ends in <code>.c</code>, so any C compiler should treat it as a C file.  Things like</p>\n\n<pre><code>(echo '#include &lt;stdio.h&gt;'\n echo 'int main(void) { printf(\"Hello, world!\\n\"); }') |\n    cc stdin.c\n</code></pre>\n\n<p>work just fine.</p>\n\n<p>(Obviously this assumes you're using a Unix-like system with symbolic links and <code>/dev/stdin</code>.)</p>\n"}, {"tags": [], "owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "is_accepted": false, "score": 3, "last_activity_date": 1514449353, "last_edit_date": 1514449353, "creation_date": 1514446367, "answer_id": 48003461, "question_id": 47999819, "link": "https://stackoverflow.com/questions/47999819/pipeline-echo-to-gcc/48003461#48003461", "title": "pipeline echo to gcc?", "body": "<p><a href=\"https://stackoverflow.com/a/47999843/841108\">Other</a> answers are explaining how to make <code>gcc</code> read C code from <em>stdin</em>, but notice that in practice <br/> <strong>it is not worth the effort to avoid dealing with C files</strong>.</p>\n\n<p><sup>(I am guessing you are using some POSIX operating system like Linux; if not, adapt my answer to your OS and compiler)</sup></p>\n\n<p>Emitting C code automatically is usual practice (and many academic programming languages are <a href=\"https://softwareengineering.stackexchange.com/a/257873/40065\">compiling to C</a>, and many builds are using generated C code, e.g. from <a href=\"https://www.gnu.org/software/bison/\" rel=\"nofollow noreferrer\">bison</a>). But there is no much gain to use pipes and <em>stdin</em>, because a C compiler takes a lot of time (notably for <a href=\"https://en.wikipedia.org/wiki/Optimizing_compiler\" rel=\"nofollow noreferrer\">optimization</a>, which you often want, e.g. by compiling with <code>gcc -O2</code>).</p>\n\n<p>So my recommendation is to put the generated C code in a genuine file (perhaps some temporary one which should be removed later appropriately). That file could be on some <a href=\"https://en.wikipedia.org/wiki/Tmpfs\" rel=\"nofollow noreferrer\">tmpfs</a> file system if disk performance is an issue (and in practice it never is for <code>gcc</code> compiled source code), and that file could be temporary (e.g. removed later) if you want it to.</p>\n\n<p>Notice that the <code>gcc</code> program is generally using temporary files internally itself (e.g. for generated assembler files or object files). You'll see them if you add <code>-v</code> to your <code>gcc</code> compilation command, e.g. if you compile <code>foo.c</code> with <code>gcc -v foo.c -o fooprog</code>. So there is no practical reason to avoid a C source file (since <code>gcc</code> uses temporary <em>files</em> anyway!).</p>\n\n<p>If you want to generate code on the fly in a running program, you could generate temporary C code then compile it as a temporary <a href=\"https://en.wikipedia.org/wiki/Plug-in_(computing)\" rel=\"nofollow noreferrer\">plugin</a> (with <a href=\"https://en.wikipedia.org/wiki/Position-independent_code\" rel=\"nofollow noreferrer\">position-independent code</a>) then <a href=\"https://en.wikipedia.org/wiki/Dynamic_loading\" rel=\"nofollow noreferrer\">dynamically load</a> that plugin (e.g. using <a href=\"http://man7.org/linux/man-pages/man3/dlopen.3.html\" rel=\"nofollow noreferrer\">dlopen(3)</a> &amp; <a href=\"http://man7.org/linux/man-pages/man3/dsym.3.html\" rel=\"nofollow noreferrer\">dlsym(3)</a> on Linux); but you could also use <a href=\"https://en.wikipedia.org/wiki/Just-in-time_compilation\" rel=\"nofollow noreferrer\">JIT compiling</a> libraries like <a href=\"https://gcc.gnu.org/onlinedocs/jit/\" rel=\"nofollow noreferrer\">GCCJIT</a> or <a href=\"http://llvm.org/\" rel=\"nofollow noreferrer\">LLVM</a> or <a href=\"https://github.com/asmjit/asmjit\" rel=\"nofollow noreferrer\">asmjit</a>, etc.... Of course this requires some support from your <a href=\"https://en.wikipedia.org/wiki/Operating_system\" rel=\"nofollow noreferrer\">operating system</a> (e.g. to grow your <a href=\"https://en.wikipedia.org/wiki/Virtual_address_space\" rel=\"nofollow noreferrer\">virtual address space</a>): in pure standard <a href=\"https://en.wikipedia.org/wiki/C11_(C_standard_revision)\" rel=\"nofollow noreferrer\">C11</a> (read <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"nofollow noreferrer\">n1570</a>), the set of functions is fixed at build time since defined in the union of your <a href=\"https://en.wikipedia.org/wiki/Translation_unit_(programming)\" rel=\"nofollow noreferrer\">translation units</a> (the set of <code>.c</code> files comprising your program), and you cannot generate code at runtime.</p>\n\n<p>If you want to generate some C program in some <a href=\"https://en.wikipedia.org/wiki/Shell_script\" rel=\"nofollow noreferrer\">shell script</a>, better use temporary files, e.g. with <code>tempfile</code>, <code>mktemp</code> etc... (and use <a href=\"https://www.gnu.org/software/bash/manual/html_node/Bourne-Shell-Builtins.html\" rel=\"nofollow noreferrer\"><code>trap</code> builtin</a> on <code>EXIT</code> and on <code>TERM</code> signal to remove the temporary files when the script terminates).</p>\n\n<p>If you generate some temporary C code in your <a href=\"https://en.wikipedia.org/wiki/Software_build\" rel=\"nofollow noreferrer\">build</a>, good <a href=\"https://en.wikipedia.org/wiki/Build_automation\" rel=\"nofollow noreferrer\">build automation</a> programs (e.g. <a href=\"https://www.gnu.org/software/make/\" rel=\"nofollow noreferrer\">GNU <code>make</code></a> or <a href=\"http://ninja-build.org/\" rel=\"nofollow noreferrer\"><code>ninja</code></a>) can be configured to remove these temporary C files (e.g. read about <a href=\"https://www.gnu.org/software/make/manual/html_node/Chained-Rules.html#index-intermediate-files\" rel=\"nofollow noreferrer\">intermediate files</a> for <code>make</code>).</p>\n\n<p>Look also into <a href=\"https://en.wikipedia.org/wiki/Homoiconicity\" rel=\"nofollow noreferrer\">homoiconic</a> programming languages like Common Lisp. For example <a href=\"http://sbcl.org/\" rel=\"nofollow noreferrer\">SBCL</a> is compiling into machine code at every <a href=\"https://en.wikipedia.org/wiki/Read%E2%80%93eval%E2%80%93print_loop\" rel=\"nofollow noreferrer\">REPL</a> interaction.</p>\n"}, {"tags": [], "owner": {"reputation": 641, "user_id": 4046647, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JRueZ.png?s=128&g=1", "display_name": "jianyongli", "link": "https://stackoverflow.com/users/4046647/jianyongli"}, "is_accepted": false, "score": 1, "last_activity_date": 1608789103, "creation_date": 1608789103, "answer_id": 65434499, "question_id": 47999819, "link": "https://stackoverflow.com/questions/47999819/pipeline-echo-to-gcc/65434499#65434499", "title": "pipeline echo to gcc?", "body": "<p>without echo something to pipeline, you can do like this:</p>\n<pre><code>gcc -x c - &lt;&lt;eof\n#include&lt;stdio.h&gt;\nvoid main()\n{\nprintf(&quot;Hello!&quot;);\n}\neof\n</code></pre>\n"}], "owner": {"reputation": 189, "user_id": 6560462, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001154412535/picture?type=large", "display_name": "Masoud Ghaderi", "link": "https://stackoverflow.com/users/6560462/masoud-ghaderi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1385, "favorite_count": 2, "accepted_answer_id": 47999843, "answer_count": 4, "score": 5, "last_activity_date": 1608789103, "creation_date": 1514417406, "last_edit_date": 1514811717, "question_id": 47999819, "link": "https://stackoverflow.com/questions/47999819/pipeline-echo-to-gcc", "title": "pipeline echo to gcc?", "body": "<p>To call <code>printf(\"Hello!\");</code> in C from terminal I use</p>\n\n<pre><code>echo '#include&lt;stdio.h&gt;\nvoid main()\n{\nprintf(\"Hello!\");\n}' &gt; foo.c\n</code></pre>\n\n<p>and then call <code>gcc foo.c</code> to make the output. Unfortunately, the pipelining </p>\n\n<pre><code>echo '#include&lt;stdio.h&gt;\nvoid main()\n{\nprintf(\"Hello!\");\n}' | gcc \n</code></pre>\n\n<p>fails complaining for no input file. Ultimately, I want to have a script where I can compile a C <code>command</code> from terminal with <code>./script [command]</code>. Any suggestion would be appreciated. </p>\n"}, {"tags": ["c", "gcc", "cmake", "configure"], "comments": [{"owner": {"reputation": 9602, "user_id": 7151494, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-a_FzvY-b2O0/AAAAAAAAAAI/AAAAAAAAAEw/kNwilSAvQTI/photo.jpg?sz=128", "display_name": "Fureeish", "link": "https://stackoverflow.com/users/7151494/fureeish"}, "edited": false, "score": 1, "creation_date": 1514416007, "post_id": 47999651, "comment_id": 82967797, "body": "&quot;<i>[...] C compiler [...]</i>&quot; - then <i>please</i> do not tag this as <code>C++</code>"}, {"owner": {"reputation": 7698, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "edited": false, "score": 2, "creation_date": 1514416203, "post_id": 47999651, "comment_id": 82967859, "body": "<code>void main(){printf(&quot;hello world\\n&quot;);}</code> is neither a complete and valid c or c++ program, so what do you actually expect?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 5, "creation_date": 1514416534, "post_id": 47999651, "comment_id": 82967955, "body": "You&#39;re missing <code>#include &lt;stdio.h&gt;</code>"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 2, "creation_date": 1514418355, "post_id": 47999651, "comment_id": 82968346, "body": "Start reading a good C book. And read the documeantion of the tools you use."}, {"owner": {"reputation": 27, "user_id": 9146971, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-uh-cGoFQ8Cc/AAAAAAAAAAI/AAAAAAAAABg/IPztVoO-4fg/photo.jpg?sz=128", "display_name": "CybernetiX S3C", "link": "https://stackoverflow.com/users/9146971/cybernetix-s3c"}, "edited": false, "score": 0, "creation_date": 1514430403, "post_id": 47999651, "comment_id": 82970727, "body": "not worried bout the hello crap. i just need to fix my compiler, to finish my ai"}, {"owner": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "edited": false, "score": 0, "creation_date": 1514432183, "post_id": 47999651, "comment_id": 82971044, "body": "<a href=\"https://stackoverflow.com/questions/16437383/linker-error-gcc\">stackoverflow.com/questions/16437383/linker-error-gcc</a>"}, {"owner": {"reputation": 27, "user_id": 9146971, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-uh-cGoFQ8Cc/AAAAAAAAAAI/AAAAAAAAABg/IPztVoO-4fg/photo.jpg?sz=128", "display_name": "CybernetiX S3C", "link": "https://stackoverflow.com/users/9146971/cybernetix-s3c"}, "reply_to_user": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "edited": false, "score": 0, "creation_date": 1514432475, "post_id": 47999651, "comment_id": 82971098, "body": "@MFisherKDX i have seen this. no avail"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1514438591, "post_id": 47999651, "comment_id": 82972409, "body": "I think you need to work out what the <code>this linker was not configured to use sysroots</code> message means.  Warnings are just warnings; they do not prevent the code from linking.  The linker prevents the code from linking because it isn&#39;t configured to use sysroots \u2014 whatever that means.  Have you ever been able to compile and run a C program on this machine?  If not, practice until you can.  Reinstall the tools as necessary."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1514439033, "post_id": 47999651, "comment_id": 82972522, "body": "Note that a Google search on the error message comes up with a number of sources of information, including <a href=\"https://stackoverflow.com/questions/16437383/linker-error-gcc\">Linker errorL <code>gcc</code></a> on SO.  You either need a compiler that doesn&#39;t run the linker with the <code>--sysroot=\u2026</code> option, or you need a linker that accepts the option.  So, at the moment, you have a non-working compilation system."}, {"owner": {"reputation": 27, "user_id": 9146971, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-uh-cGoFQ8Cc/AAAAAAAAAAI/AAAAAAAAABg/IPztVoO-4fg/photo.jpg?sz=128", "display_name": "CybernetiX S3C", "link": "https://stackoverflow.com/users/9146971/cybernetix-s3c"}, "edited": false, "score": 0, "creation_date": 1514441786, "post_id": 47999651, "comment_id": 82973264, "body": "yes, i knew this. i have my masters in cyber security. i know the dynamics of google. i have compiled many C programs as I said before. i have another machine running same everything and runs smoothly. if you read all i have entered in this page i have mentioned this earlier. i been working with linux since 1997. i have not come across this error. i have searched and found the usage --with-sysroot=/ but i still receive this error. this is a kali linux box with custom AI robot. building a robot to hack on its own. there already is almost everything on here i need. until this last 4 scripts."}, {"owner": {"reputation": 27, "user_id": 9146971, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-uh-cGoFQ8Cc/AAAAAAAAAAI/AAAAAAAAABg/IPztVoO-4fg/photo.jpg?sz=128", "display_name": "CybernetiX S3C", "link": "https://stackoverflow.com/users/9146971/cybernetix-s3c"}, "edited": false, "score": 0, "creation_date": 1514443264, "post_id": 47999651, "comment_id": 82973828, "body": "i have uninstalled and reinstalled binutils and the proper c packages. i even tried to cmake this. same errors. but my completed machines works fine. i need to finish this one so i can experiment with them on each other. im also kali linux certified, just to get the noob talk out of the way. and i teach it as well."}], "answers": [{"comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1514418411, "post_id": 47999865, "comment_id": 82968358, "body": "An empty paramter list is an obsolecent feature in C and strongly deprcated as it is to be removed in a future version of the language. C is not C++ (Yeah, I know you know, just ftr)."}, {"owner": {"reputation": 7698, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1514418979, "post_id": 47999865, "comment_id": 82968471, "body": "@Olaf Fixed that."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1514419063, "post_id": 47999865, "comment_id": 82968490, "body": "Hmm, that should give a warning for unused parameters (considering you enable recommended warnings (which are missing, too). Why not <code>void</code>?"}, {"owner": {"reputation": 7698, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1514419185, "post_id": 47999865, "comment_id": 82968520, "body": "@Olaf So <code>void main()</code>  return type is valid standard c? I always thought that&#39;s a MSVC extension."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1514419349, "post_id": 47999865, "comment_id": 82968564, "body": "I did not mean the result. And yes, it is - for a freestanding implementation it can have any signature, not even <code>main</code> is guaranteed. I&#39;m certain it is the same for C++, btw."}, {"owner": {"reputation": 7698, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1514419486, "post_id": 47999865, "comment_id": 82968582, "body": "@Olaf Well, at least I&#39;m trying to cover some minimum requirements now."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1514419638, "post_id": 47999865, "comment_id": 82968626, "body": "It&#39;s awfully formatted now. Anyway, I&#39;ll leave it at this. I CVed the question, let&#39;s hope 4 others think the same. Nix f&#252;r ungut."}, {"owner": {"reputation": 7698, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1514419797, "post_id": 47999865, "comment_id": 82968655, "body": "@Olaf <i>&quot;Nix f&#252;r ungut.&quot;</i> Never! Peers are able to agree to disagree ;-) ..."}, {"owner": {"reputation": 27, "user_id": 9146971, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-uh-cGoFQ8Cc/AAAAAAAAAAI/AAAAAAAAABg/IPztVoO-4fg/photo.jpg?sz=128", "display_name": "CybernetiX S3C", "link": "https://stackoverflow.com/users/9146971/cybernetix-s3c"}, "edited": false, "score": 0, "creation_date": 1514430212, "post_id": 47999865, "comment_id": 82970690, "body": "thanks for some rude comments. but i am compiling ai inside of kali linux. was done before. i just need to know how to fix   collect2: error: ld returned 1 exit status bash: /tmp/hello: No such file or directory"}, {"owner": {"reputation": 27, "user_id": 9146971, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-uh-cGoFQ8Cc/AAAAAAAAAAI/AAAAAAAAABg/IPztVoO-4fg/photo.jpg?sz=128", "display_name": "CybernetiX S3C", "link": "https://stackoverflow.com/users/9146971/cybernetix-s3c"}, "edited": false, "score": 0, "creation_date": 1514430270, "post_id": 47999865, "comment_id": 82970702, "body": "if this can be fixed my c compiler would be fixed."}, {"owner": {"reputation": 7698, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "reply_to_user": {"reputation": 27, "user_id": 9146971, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-uh-cGoFQ8Cc/AAAAAAAAAAI/AAAAAAAAABg/IPztVoO-4fg/photo.jpg?sz=128", "display_name": "CybernetiX S3C", "link": "https://stackoverflow.com/users/9146971/cybernetix-s3c"}, "edited": false, "score": 0, "creation_date": 1514431327, "post_id": 47999865, "comment_id": 82970893, "body": "@CybernetiXS3C I&#39;ve got no clue what you&#39;re talking about. Especially not, what you mean with <i>rude comments</i>."}, {"owner": {"reputation": 27, "user_id": 9146971, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-uh-cGoFQ8Cc/AAAAAAAAAAI/AAAAAAAAABg/IPztVoO-4fg/photo.jpg?sz=128", "display_name": "CybernetiX S3C", "link": "https://stackoverflow.com/users/9146971/cybernetix-s3c"}, "edited": false, "score": 0, "creation_date": 1514431564, "post_id": 47999865, "comment_id": 82970942, "body": "can we fix, or will ihave to reinstall. i been working and compiling for weeks."}, {"owner": {"reputation": 27, "user_id": 9146971, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-uh-cGoFQ8Cc/AAAAAAAAAAI/AAAAAAAAABg/IPztVoO-4fg/photo.jpg?sz=128", "display_name": "CybernetiX S3C", "link": "https://stackoverflow.com/users/9146971/cybernetix-s3c"}, "edited": false, "score": 0, "creation_date": 1514431600, "post_id": 47999865, "comment_id": 82970947, "body": "echo &quot;#include &lt;stdio.h&gt; &gt; int main(int argc, char* argv[]) {printf(\\&quot;hello world\\n\\&quot;);}&quot; | &gt; gcc -std=c99 -Wall -pedantic -x c - -o /tmp/hello; /tmp/hello    /usr/local/bin/ld: this linker was not configured to use sysroots collect2: error: ld returned 1 exit status bash: /tmp/hello: No such file or directory"}, {"owner": {"reputation": 7698, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "edited": false, "score": 0, "creation_date": 1514431685, "post_id": 47999865, "comment_id": 82970961, "body": "The only thing that&#39;s wrong is that c code passed with the <code>echo</code> statement. I don&#39;t see a need to reinstall your compiler. Fix your configure script instead."}, {"owner": {"reputation": 27, "user_id": 9146971, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-uh-cGoFQ8Cc/AAAAAAAAAAI/AAAAAAAAABg/IPztVoO-4fg/photo.jpg?sz=128", "display_name": "CybernetiX S3C", "link": "https://stackoverflow.com/users/9146971/cybernetix-s3c"}, "edited": false, "score": 1, "creation_date": 1514431694, "post_id": 47999865, "comment_id": 82970962, "body": "i have 4 more files to configure and make. same end results. i havent gotten this issue before the binutils, and this was necesary for dragonfire ."}, {"owner": {"reputation": 27, "user_id": 9146971, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-uh-cGoFQ8Cc/AAAAAAAAAAI/AAAAAAAAABg/IPztVoO-4fg/photo.jpg?sz=128", "display_name": "CybernetiX S3C", "link": "https://stackoverflow.com/users/9146971/cybernetix-s3c"}, "edited": false, "score": 0, "creation_date": 1514431751, "post_id": 47999865, "comment_id": 82970969, "body": "i have installed and removed and reinstalled many things, to no avail."}, {"owner": {"reputation": 27, "user_id": 9146971, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-uh-cGoFQ8Cc/AAAAAAAAAAI/AAAAAAAAABg/IPztVoO-4fg/photo.jpg?sz=128", "display_name": "CybernetiX S3C", "link": "https://stackoverflow.com/users/9146971/cybernetix-s3c"}, "edited": false, "score": 0, "creation_date": 1514431934, "post_id": 47999865, "comment_id": 82970999, "body": "@user0042 check the 2 config logs. i have same results with those."}, {"owner": {"reputation": 27, "user_id": 9146971, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-uh-cGoFQ8Cc/AAAAAAAAAAI/AAAAAAAAABg/IPztVoO-4fg/photo.jpg?sz=128", "display_name": "CybernetiX S3C", "link": "https://stackoverflow.com/users/9146971/cybernetix-s3c"}, "edited": false, "score": 0, "creation_date": 1514431967, "post_id": 47999865, "comment_id": 82971006, "body": "/usr/local/bin/ld: this linker was not configured to use sysroots collect2: error: ld returned 1 exit status bash: /tmp/hello: No such file or directory"}, {"owner": {"reputation": 27, "user_id": 9146971, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-uh-cGoFQ8Cc/AAAAAAAAAAI/AAAAAAAAABg/IPztVoO-4fg/photo.jpg?sz=128", "display_name": "CybernetiX S3C", "link": "https://stackoverflow.com/users/9146971/cybernetix-s3c"}, "edited": false, "score": 0, "creation_date": 1514432002, "post_id": 47999865, "comment_id": 82971012, "body": "minus hello part"}], "tags": [], "owner": {"reputation": 7698, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "is_accepted": true, "score": 0, "last_activity_date": 1514419711, "last_edit_date": 1514419711, "creation_date": 1514417957, "answer_id": 47999865, "question_id": 47999651, "link": "https://stackoverflow.com/questions/47999651/configure-error-installation-or-configuration-c-compiler-cannot-create-execu/47999865#47999865", "title": "configure: error: installation or configuration \u2014 C compiler cannot create executables", "body": "<p>The line </p>\n\n<blockquote>\n<pre><code>  echo \"void main(){printf(\\\"hello world\\n\\\");}\" |gcc -x c - -o /tmp/hello;/tmp/hello\n</code></pre>\n</blockquote>\n\n<p>will fail at the first statement </p>\n\n<pre><code>gcc -x c - -o /tmp/hello\n</code></pre>\n\n<p>because</p>\n\n<pre><code>void main(){ \n    printf(\"hello world\\n\");\n}\n</code></pre>\n\n<p>isn't valid c or c++ code. Hence no executable generated, hence no executable to execute (<code>/tmp/hello</code>).</p>\n\n<p>The simplest valid (shell embedded) c code I can think of to provide there would be</p>\n\n<pre><code>echo \"#include &lt;stdio.h&gt;\nint main(int argc, char* argv[]) {printf(\\\"hello world\\n\\\");}\" |\ngcc -std=c99 -Wall -pedantic -x c - -o /tmp/hello; /tmp/hello   \n</code></pre>\n\n<p>See the <a href=\"http://coliru.stacked-crooked.com/a/bafdc99f0da43744\" rel=\"nofollow noreferrer\"><strong>Live Demo</strong></a></p>\n"}, {"comments": [{"owner": {"reputation": 27, "user_id": 9146971, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-uh-cGoFQ8Cc/AAAAAAAAAAI/AAAAAAAAABg/IPztVoO-4fg/photo.jpg?sz=128", "display_name": "CybernetiX S3C", "link": "https://stackoverflow.com/users/9146971/cybernetix-s3c"}, "edited": false, "score": 0, "creation_date": 1514442169, "post_id": 48002175, "comment_id": 82973413, "body": "ld wasnt custom, and binutils was from MIT"}, {"owner": {"reputation": 27, "user_id": 9146971, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-uh-cGoFQ8Cc/AAAAAAAAAAI/AAAAAAAAABg/IPztVoO-4fg/photo.jpg?sz=128", "display_name": "CybernetiX S3C", "link": "https://stackoverflow.com/users/9146971/cybernetix-s3c"}, "edited": false, "score": 0, "creation_date": 1514443081, "post_id": 48002175, "comment_id": 82973752, "body": "also i am having same issue rebuilding binutils now. my brain hurts lol. a couple of decades of linux and this one is killing me. haha. did not have an issue on my other machine."}, {"owner": {"user_type": "does_not_exist", "display_name": "user933161"}, "reply_to_user": {"reputation": 27, "user_id": 9146971, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-uh-cGoFQ8Cc/AAAAAAAAAAI/AAAAAAAAABg/IPztVoO-4fg/photo.jpg?sz=128", "display_name": "CybernetiX S3C", "link": "https://stackoverflow.com/users/9146971/cybernetix-s3c"}, "edited": false, "score": 0, "creation_date": 1514443723, "post_id": 48002175, "comment_id": 82973978, "body": "Make a wrapper of ld to remove unsupported options before invoking real ld."}, {"owner": {"user_type": "does_not_exist", "display_name": "user933161"}, "reply_to_user": {"reputation": 27, "user_id": 9146971, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-uh-cGoFQ8Cc/AAAAAAAAAAI/AAAAAAAAABg/IPztVoO-4fg/photo.jpg?sz=128", "display_name": "CybernetiX S3C", "link": "https://stackoverflow.com/users/9146971/cybernetix-s3c"}, "edited": false, "score": 0, "creation_date": 1514444034, "post_id": 48002175, "comment_id": 82974087, "body": "How isn&#39;t ld custom? Why is it under /usr/local? You use kali, debian-based, you have linker as /usr/bin/ld"}, {"owner": {"reputation": 27, "user_id": 9146971, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-uh-cGoFQ8Cc/AAAAAAAAAAI/AAAAAAAAABg/IPztVoO-4fg/photo.jpg?sz=128", "display_name": "CybernetiX S3C", "link": "https://stackoverflow.com/users/9146971/cybernetix-s3c"}, "edited": false, "score": 0, "creation_date": 1514444498, "post_id": 48002175, "comment_id": 82974238, "body": "it was preinstalled. when i installed last working configure script it showed ld was installed. binutils not. thats where this problem started. it didnt have binutils already. so that script stopped there. i went to mit site and dug around google for the newest. matched it. dl it. and now i been getting above errors. i tried to grab from sources but not avail. thats why i had the dl version. i didnt configure it with sysroot at first. but each time i uninstall binutils it removes parts of kali packages and other shit i need."}, {"owner": {"reputation": 27, "user_id": 9146971, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-uh-cGoFQ8Cc/AAAAAAAAAAI/AAAAAAAAABg/IPztVoO-4fg/photo.jpg?sz=128", "display_name": "CybernetiX S3C", "link": "https://stackoverflow.com/users/9146971/cybernetix-s3c"}, "edited": false, "score": 0, "creation_date": 1514444687, "post_id": 48002175, "comment_id": 82974303, "body": "i havent gotten much sleep either. so i could have screwed something up or missed something. this has been a 4 week project and 8 days of trying to figure this error out. cant even install binutils --with-sysroot=/ because i still have this error"}, {"owner": {"reputation": 27, "user_id": 9146971, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-uh-cGoFQ8Cc/AAAAAAAAAAI/AAAAAAAAABg/IPztVoO-4fg/photo.jpg?sz=128", "display_name": "CybernetiX S3C", "link": "https://stackoverflow.com/users/9146971/cybernetix-s3c"}, "edited": false, "score": 0, "creation_date": 1514444903, "post_id": 48002175, "comment_id": 82974399, "body": "im wondering if i rm the ld directory from where its at i will be able configure the binutils again.idk, im out of ideas. honestly burnt out. just a huge year long project for an experiment."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user933161"}, "is_accepted": false, "score": 0, "last_activity_date": 1514439743, "creation_date": 1514439743, "answer_id": 48002175, "question_id": 47999651, "link": "https://stackoverflow.com/questions/47999651/configure-error-installation-or-configuration-c-compiler-cannot-create-execu/48002175#48002175", "title": "configure: error: installation or configuration \u2014 C compiler cannot create executables", "body": "<p>Do you use a custom linker (ld)? It seems so (/usr/local/bin/ld). Gcc passes some options to the linker (--sysroot in this case) and they are not supported by the linker. You have to either rebuild binutils (where the linker comes from) or pass some options to gcc (I don't know what). Search the Web for that error message regarding the linker.</p>\n"}], "owner": {"reputation": 27, "user_id": 9146971, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-uh-cGoFQ8Cc/AAAAAAAAAAI/AAAAAAAAABg/IPztVoO-4fg/photo.jpg?sz=128", "display_name": "CybernetiX S3C", "link": "https://stackoverflow.com/users/9146971/cybernetix-s3c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1317, "favorite_count": 0, "accepted_answer_id": 47999865, "answer_count": 2, "score": -4, "last_activity_date": 1514487673, "creation_date": 1514415957, "last_edit_date": 1514487673, "question_id": 47999651, "link": "https://stackoverflow.com/questions/47999651/configure-error-installation-or-configuration-c-compiler-cannot-create-execu", "title": "configure: error: installation or configuration \u2014 C compiler cannot create executables", "body": "<p>Every time I try to compile a configure sh, I am getting this error. It doesn't matter which one.<br>\nI installed and reinstalled g++ and cpp and many others. Here is an idea:</p>\n\n<pre><code>echo \"void main(){printf(\\\"hello world\\n\\\");}\" |gcc -x c - -o /tmp/hello;/tmp/hello\n\n&lt;stdin&gt;: In function \u2018main\u2019:\n&lt;stdin&gt;:1:13: warning: implicit declaration of function \u2018printf\u2019 [-Wimplicit-function-declaration]\n&lt;stdin&gt;:1:13: warning: incompatible implicit declaration of built-in function \u2018printf\u2019\n&lt;stdin&gt;:1:13: note: include \u2018&lt;stdio.h&gt;\u2019 or provide a declaration of \u2018printf\u2019\n/usr/local/bin/ld: this linker was not configured to use sysroots\ncollect2: error: ld returned 1 exit status\nbash: /tmp/hello: No such file or directory\n</code></pre>\n\n<p>config.log from one of the files.</p>\n\n<pre><code>This file contains any messages produced by compilers while\nrunning configure, to aid debugging if configure makes a mistake.\n\nconfigure:555: checking host system type\nconfigure:577: checking host specific optimization flag\nconfigure:593: checking for gcc\nconfigure:706: checking whether the C compiler (gcc -O6 -fomit frame-pointer ) wor$\nconfigure:722: gcc -o conftest -O6 -fomit-frame-pointer   conftest.c  1&gt;&amp;5\nconfigure:719:1: warning: return type defaults to 'int' [-Wimplicit-int]\n main(){return(0);}\n ^~~~\n/usr/local/bin/ld: this linker was not configured to use sysroots\ncollect2: error: ld returned 1 exit status\nconfigure: failed program was:\n\n#line 717 \"configure\"\n</code></pre>\n\n<p>here is another config.log</p>\n\n<pre><code>    This file contains any messages produced by compilers while\nrunning configure, to aid debugging if configure makes a mistake.\n\nIt was created by OpenFst configure 1.6.5, which was\ngenerated by GNU Autoconf 2.69.  Invocation command line was\n\n  $ configure \n\n## --------- ##\n## Platform. ##\n## --------- ##\n\nhostname = CybernetiX\nuname -m = x86_64\nuname -r = 4.14.0-kali1-amd64\nuname -s = Linux\nuname -v = #1 SMP Debian 4.14.2-1kali1 (2017-12-04)\n\n/usr/bin/uname -p = unknown\n/bin/uname -X     = unknown\n\n/bin/arch              = unknown\n/usr/bin/arch -k       = unknown\n/usr/convex/getsysinfo = unknown\n/usr/bin/hostinfo      = unknown\n/bin/machine           = unknown\n/usr/bin/oslevel       = unknown\n/bin/universe          = unknown\n\nPATH: /usr/local/sbin\nPATH: /usr/local/bin\nPATH: /usr/sbin\nPATH: /usr/bin\nPATH: /sbin\nPATH: /bin\n\n\n## ----------- ##\n## Core tests. ##\n## ----------- ##\n\nconfigure:2373: checking for a BSD-compatible install\nconfigure:2441: result: /usr/bin/install -c\nconfigure:2452: checking whether build environment is sane\nconfigure:2507: result: yes\nconfigure:2658: checking for a thread-safe mkdir -p\nconfigure:2697: result: /bin/mkdir -p\nconfigure:2704: checking for gawk\nconfigure:2720: found /usr/bin/gawk\nconfigure:2731: result: gawk\nconfigure:2742: checking whether make sets $(MAKE)\nconfigure:2764: result: yes\nconfigure:2793: checking whether make supports nested variables\nconfigure:2810: result: yes\nconfigure:2947: checking for style of include used by make\nconfigure:2975: result: GNU\nconfigure:3046: checking for gcc\nconfigure:3062: found /usr/bin/gcc\nconfigure:3073: result: gcc\nconfigure:3302: checking for C compiler version\nconfigure:3311: gcc --version &gt;&amp;5\ngcc (Debian 7.2.0-18) 7.2.0\nCopyright (C) 2017 Free Software Foundation, Inc.\nThis is free software; see the source for copying conditions.  There is NO\nwarranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n\nconfigure:3322: $? = 0\nconfigure:3311: gcc -v &gt;&amp;5\nUsing built-in specs.\nCOLLECT_GCC=gcc\nCOLLECT_LTO_WRAPPER=/usr/lib/gcc/x86_64-linux-gnu/7/lto-wrapper\nOFFLOAD_TARGET_NAMES=nvptx-none\nOFFLOAD_TARGET_DEFAULT=1\nTarget: x86_64-linux-gnu\nConfigured with: ../src/configure -v --with-pkgversion='Debian 7.2.0-18' --with-bugurl=file:///usr/share/doc/gcc-7/README.Bugs --enable-languages=c,ada,c++,go,brig,d,fortran,objc,obj-c++ --prefix=/usr --with-gcc-major-version-only --program-suffix=-7 --program-prefix=x86_64-linux-gnu- --enable-shared --enable-linker-build-id --libexecdir=/usr/lib --without-included-gettext --enable-threads=posix --libdir=/usr/lib --enable-nls --with-sysroot=/ --enable-clocale=gnu --enable-libstdcxx-debug --enable-libstdcxx-time=yes --with-default-libstdcxx-abi=new --enable-gnu-unique-object --disable-vtable-verify --enable-libmpx --enable-plugin --enable-default-pie --with-system-zlib --with-target-system-zlib --enable-objc-gc=auto --enable-multiarch --disable-werror --with-arch-32=i686 --with-abi=m64 --with-multilib-list=m32,m64,mx32 --enable-multilib --with-tune=generic --enable-offload-targets=nvptx-none --without-cuda-driver --enable-checking=release --build=x86_64-linux-gnu --host=x86_64-linux-gnu --target=x86_64-linux-gnu\nThread model: posix\ngcc version 7.2.0 (Debian 7.2.0-18) \nconfigure:3322: $? = 0\nconfigure:3311: gcc -V &gt;&amp;5\ngcc: error: unrecognized command line option '-V'\ngcc: fatal error: no input files\ncompilation terminated.\nconfigure:3322: $? = 1\nconfigure:3311: gcc -qversion &gt;&amp;5\ngcc: error: unrecognized command line option '-qversion'; did you mean '--version'?\ngcc: fatal error: no input files\ncompilation terminated.\nconfigure:3322: $? = 1\nconfigure:3342: checking whether the C compiler works\nconfigure:3364: gcc    conftest.c  &gt;&amp;5\n/usr/local/bin/ld: this linker was not configured to use sysroots\ncollect2: error: ld returned 1 exit status\nconfigure:3368: $? = 1\nconfigure:3406: result: no\nconfigure: failed program was:\n| /* confdefs.h */\n| #define PACKAGE_NAME \"OpenFst\"\n| #define PACKAGE_TARNAME \"openfst\"\n| #define PACKAGE_VERSION \"1.6.5\"\n| #define PACKAGE_STRING \"OpenFst 1.6.5\"\n| #define PACKAGE_BUGREPORT \"help@www.openfst.org\"\n| #define PACKAGE_URL \"\"\n| #define PACKAGE \"openfst\"\n| #define VERSION \"1.6.5\"\n| /* end confdefs.h.  */\n| \n| int\n| main ()\n| {\n| \n|   ;\n|   return 0;\n| }\nconfigure:3411: error: in `/root/Downloads/openfst-1.6.5':\nconfigure:3413: error: C compiler cannot create executables\nSee `config.log' for more details\n\n## ---------------- ##\n## Cache variables. ##\n## ---------------- ##\n\nac_cv_env_CCC_set=\nac_cv_env_CCC_value=\nac_cv_env_CC_set=\nac_cv_env_CC_value=\nac_cv_env_CFLAGS_set=\nac_cv_env_CFLAGS_value=\nac_cv_env_CPPFLAGS_set=\nac_cv_env_CPPFLAGS_value=\nac_cv_env_CPP_set=\nac_cv_env_CPP_value=\nac_cv_env_CXXCPP_set=\nac_cv_env_CXXCPP_value=\nac_cv_env_CXXFLAGS_set=\nac_cv_env_CXXFLAGS_value=\nac_cv_env_CXX_set=\nac_cv_env_CXX_value=\nac_cv_env_LDFLAGS_set=\nac_cv_env_LDFLAGS_value=\nac_cv_env_LIBS_set=\nac_cv_env_LIBS_value=\nac_cv_env_PYTHON_VERSION_set=\nac_cv_env_PYTHON_VERSION_value=\nac_cv_env_PYTHON_set=\nac_cv_env_PYTHON_value=\nac_cv_env_build_alias_set=\nac_cv_env_build_alias_value=\nac_cv_env_host_alias_set=\nac_cv_env_host_alias_value=\nac_cv_env_target_alias_set=\nac_cv_env_target_alias_value=\nac_cv_path_install='/usr/bin/install -c'\nac_cv_path_mkdir=/bin/mkdir\nac_cv_prog_AWK=gawk\nac_cv_prog_ac_ct_CC=gcc\nac_cv_prog_make_make_set=yes\nam_cv_make_support_nested_variables=yes\n\n## ----------------- ##\n## Output variables. ##\n## ----------------- ##\n\nACLOCAL='${SHELL} /root/Downloads/openfst-1.6.5/missing aclocal-1.14'\nAMDEPBACKSLASH='\\'\nAMDEP_FALSE='#'\nAMDEP_TRUE=''\nAMTAR='$${TAR-tar}'\nAM_BACKSLASH='\\'\nAM_DEFAULT_V='$(AM_DEFAULT_VERBOSITY)'\nAM_DEFAULT_VERBOSITY='1'\nAM_V='$(V)'\nAR=''\nAUTOCONF='${SHELL} /root/Downloads/openfst-1.6.5/missing autoconf'\nAUTOHEADER='${SHELL} /root/Downloads/openfst-1.6.5/missing autoheader'\nAUTOMAKE='${SHELL} /root/Downloads/openfst-1.6.5/missing automake-1.14'\nAWK='gawk'\nCC='gcc'\nCCDEPMODE=''\nCFLAGS=''\nCPP=''\nCPPFLAGS=''\nCXX=''\nCXXCPP=''\nCXXDEPMODE=''\nCXXFLAGS=''\nCYGPATH_W='echo'\nDEFS=''\nDEPDIR='.deps'\nDLLTOOL=''\nDL_LIBS=''\nDSYMUTIL=''\nDUMPBIN=''\nECHO_C=''\nECHO_N='-n'\nECHO_T=''\nEGREP=''\nEXEEXT=''\nFGREP=''\nGREP=''\nHAVE_BIN_FALSE=''\nHAVE_BIN_TRUE=''\nHAVE_COMPACT_FALSE=''\nHAVE_COMPACT_TRUE=''\nHAVE_COMPRESS_FALSE=''\nHAVE_COMPRESS_TRUE=''\nHAVE_CONST_FALSE=''\nHAVE_CONST_TRUE=''\nHAVE_FAR_FALSE=''\nHAVE_FAR_TRUE=''\nHAVE_GRM_FALSE=''\nHAVE_GRM_TRUE=''\nHAVE_LINEAR_FALSE=''\nHAVE_LINEAR_TRUE=''\nHAVE_LOOKAHEAD_FALSE=''\nHAVE_LOOKAHEAD_TRUE=''\nHAVE_MPDT_FALSE=''\nHAVE_MPDT_TRUE=''\nHAVE_NGRAM_FALSE=''\nHAVE_NGRAM_TRUE=''\nHAVE_PDT_FALSE=''\nHAVE_PDT_TRUE=''\nHAVE_PYTHON_FALSE=''\nHAVE_PYTHON_TRUE=''\nHAVE_SCRIPT_FALSE=''\nHAVE_SCRIPT_TRUE=''\nHAVE_SPECIAL_FALSE=''\nHAVE_SPECIAL_TRUE=''\nINSTALL_DATA='${INSTALL} -m 644'\nINSTALL_PROGRAM='${INSTALL}'\nINSTALL_SCRIPT='${INSTALL}'\nINSTALL_STRIP_PROGRAM='$(install_sh) -c -s'\nLD=''\nLDFLAGS=''\nLIBOBJS=''\nLIBS=''\nLIBTOOL=''\nLIPO=''\nLN_S=''\nLTLIBOBJS=''\nMAKEINFO='${SHELL} /root/Downloads/openfst-1.6.5/missing makeinfo'\nMANIFEST_TOOL=''\nMKDIR_P='/bin/mkdir -p'\nNM=''\nNMEDIT=''\nOBJDUMP=''\nOBJEXT=''\nOTOOL64=''\nOTOOL=''\nPACKAGE='openfst'\nPACKAGE_BUGREPORT='help@www.openfst.org'\nPACKAGE_NAME='OpenFst'\nPACKAGE_STRING='OpenFst 1.6.5'\nPACKAGE_TARNAME='openfst'\nPACKAGE_URL=''\nPACKAGE_VERSION='1.6.5'\nPATH_SEPARATOR=':'\nPYTHON=''\nPYTHON_CPPFLAGS=''\nPYTHON_EXEC_PREFIX=''\nPYTHON_EXTRA_LDFLAGS=''\nPYTHON_EXTRA_LIBS=''\nPYTHON_LDFLAGS=''\nPYTHON_PLATFORM=''\nPYTHON_PREFIX=''\nPYTHON_SITE_PKG=''\nPYTHON_VERSION=''\nRANLIB=''\nSED=''\nSET_MAKE=''\nSHELL='/bin/sh'\nSTRIP=''\nVERSION='1.6.5'\nac_ct_AR=''\nac_ct_CC='gcc'\nac_ct_CXX=''\nac_ct_DUMPBIN=''\nam__EXEEXT_FALSE=''\nam__EXEEXT_TRUE=''\nam__fastdepCC_FALSE=''\nam__fastdepCC_TRUE=''\nam__fastdepCXX_FALSE=''\nam__fastdepCXX_TRUE=''\nam__include='include'\nam__isrc=''\nam__leading_dot='.'\nam__nodep='_no'\nam__quote=''\nam__tar='$${TAR-tar} chof - \"$$tardir\"'\nam__untar='$${TAR-tar} xf -'\nbindir='${exec_prefix}/bin'\nbuild=''\nbuild_alias=''\nbuild_cpu=''\nbuild_os=''\nbuild_vendor=''\ndatadir='${datarootdir}'\ndatarootdir='${prefix}/share'\ndocdir='${datarootdir}/doc/${PACKAGE_TARNAME}'\ndvidir='${docdir}'\nexec_prefix='NONE'\nhost=''\nhost_alias=''\nhost_cpu=''\nhost_os=''\nhost_vendor=''\nhtmldir='${docdir}'\nincludedir='${prefix}/include'\ninfodir='${datarootdir}/info'\ninstall_sh='${SHELL} /root/Downloads/openfst-1.6.5/install-sh'\nlibdir='${exec_prefix}/lib'\nlibexecdir='${exec_prefix}/libexec'\nlibfstdir=''\nlocaledir='${datarootdir}/locale'\nlocalstatedir='${prefix}/var'\nmandir='${datarootdir}/man'\nmkdir_p='$(MKDIR_P)'\noldincludedir='/usr/include'\npdfdir='${docdir}'\npkgpyexecdir=''\npkgpythondir=''\nprefix='NONE'\nprogram_transform_name='s,x,x,'\npsdir='${docdir}'\npyexecdir=''\npythondir=''\nsbindir='${exec_prefix}/sbin'\nsharedstatedir='${prefix}/com'\nsysconfdir='${prefix}/etc'\ntarget_alias=''\n\n## ----------- ##\n## confdefs.h. ##\n## ----------- ##\n\n/* confdefs.h */\n#define PACKAGE_NAME \"OpenFst\"\n#define PACKAGE_TARNAME \"openfst\"\n#define PACKAGE_VERSION \"1.6.5\"\n#define PACKAGE_STRING \"OpenFst 1.6.5\"\n#define PACKAGE_BUGREPORT \"help@www.openfst.org\"\n#define PACKAGE_URL \"\"\n#define PACKAGE \"openfst\"\n#define VERSION \"1.6.5\"\n\nconfigure: exit 77\"\n</code></pre>\n\n<p>root@CybernetiX:~/Downloads/openfst-1.6.5# bash configure checking for a BSD-compatible install... /usr/bin/install -c checking whether build environment is sane... yes checking for a thread-safe mkdir -p... /bin/mkdir -p checking for gawk... gawk checking whether make sets $(MAKE)... yes checking whether make supports nested variables... yes checking for style of include used by make... GNU checking for gcc... gcc checking whether the C compiler works... no configure: error: in /root/Downloads/openfst-1.6.5':\nconfigure: error: C compiler cannot create executables\nSeeconfig.log' for more details</p>\n\n<p>up vote\n0\ndown vote\naccept</p>\n\n<p>root@CybernetiX:~/Downloads/julius-4.3.1# bash configure loading cache ./config.cache checking host system type... x86_64-unknown-linux-gnu checking host specific optimization flag... support/cflags.x86_64-unknown-linux-gnu checking for gcc... gcc checking whether the C compiler (gcc -O6 -fomit-frame-pointer ) works... no configure: error: installation or configuration problem: C compiler cannot create executables.</p>\n"}, {"tags": ["c", "linux", "struct"], "comments": [{"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 1, "creation_date": 1514412181, "post_id": 47999053, "comment_id": 82966784, "body": "That&#39;s so wrong on many levels, I don&#39;t know where to start. 1. What on earth are you trying to do with <code>readfile</code>? read the whole file in a variable? 2. <code>if(a-&gt;name &lt; b-&gt;name)</code> compares pointers, not the content. Use <code>strcmp</code> to compare two strings. 3. It would be much easier to declare an array of records (<code>record *record</code>), fill the array with the elements from the string, sort the array (not the string). Accessing is then very easy: <code>records[0]</code> for the first one, etc"}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1514413444, "post_id": 47999053, "comment_id": 82967133, "body": "Perhaps <code>nuvu</code> should <code>return 0;</code> at the end."}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1514413574, "post_id": 47999053, "comment_id": 82967177, "body": "Declare <code>nuvu</code> to take <code>const void *</code> arguments so that it matches what <code>qsort</code> expects. Inside the <code>nuvu</code> function, assign the arguments to <code>const record *</code>."}], "answers": [{"comments": [{"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 1, "creation_date": 1514412313, "post_id": 47999157, "comment_id": 82966820, "body": "Better still  <code>struct my_struct * ptr = malloc(10 * sizeof *ptr);</code>. If you later change the variable type, you don&#39;t have to worry about the pesky <code>sizeof(&lt;var types&gt;)</code>"}], "tags": [], "owner": {"reputation": 11238, "user_id": 7594711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7872c871b0431b72df6350dd0394bea?s=128&d=identicon&r=PG&f=1", "display_name": "SoronelHaetir", "link": "https://stackoverflow.com/users/7594711/soronelhaetir"}, "is_accepted": false, "score": 0, "last_activity_date": 1514412156, "creation_date": 1514412156, "answer_id": 47999157, "question_id": 47999053, "link": "https://stackoverflow.com/questions/47999053/how-to-access-struct-in-an-array-of-structs/47999157#47999157", "title": "How to access struct in an array of structs", "body": "<p>You can use the [] operator with a pointer:</p>\n\n<pre><code>struct my_struct {\n  int i, j;\n};\nstruct my_struct * ptr = malloc(sizeof(struct my_struct) * 10);\nfor(int n = 0; 10 &gt; n; ++ n)\n{\n  ptr[n].i = n;\n  ptr[n].j = n*2;\n}\nfree(ptr);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1514426102, "post_id": 48000648, "comment_id": 82969908, "body": "<code>record::name</code> in C?? (scope resolution operator does not appear in C)"}, {"owner": {"reputation": 26606, "user_id": 4603670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7eabc1427aa3c8185153cc81978289a?s=128&d=identicon&r=PG&f=1", "display_name": "Barmak Shemirani", "link": "https://stackoverflow.com/users/4603670/barmak-shemirani"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1514426377, "post_id": 48000648, "comment_id": 82969953, "body": "@DavidC.Rankin I am just indicating which name it is. It&#39;s not valid C++ code either unless <code>name</code> is static."}], "tags": [], "owner": {"reputation": 26606, "user_id": 4603670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7eabc1427aa3c8185153cc81978289a?s=128&d=identicon&r=PG&f=1", "display_name": "Barmak Shemirani", "link": "https://stackoverflow.com/users/4603670/barmak-shemirani"}, "is_accepted": true, "score": 0, "last_activity_date": 1514425461, "creation_date": 1514425461, "answer_id": 48000648, "question_id": 47999053, "link": "https://stackoverflow.com/questions/47999053/how-to-access-struct-in-an-array-of-structs/48000648#48000648", "title": "How to access struct in an array of structs", "body": "<p>Use the standard procedure for <code>qsort</code>, don't change its signature. Use <code>strcmp</code> as noted in comments. You have to figure out the logic of how the structure is to be sorted. The example below sorts by <code>record::name</code>, if <code>name</code> is the same, it tests <code>value</code>, in that order:</p>\n\n<pre><code>int nuvu(const void * a_, const void * b_)\n{\n    const record* a = a_;\n    const record* b = b_;\n    if(strcmp(a-&gt;name, b-&gt;name) == 0)\n        return a-&gt;value &gt; b-&gt;value;\n    return strcmp(a-&gt;name, b-&gt;name);\n}\n</code></pre>\n\n<p>Data is read as bytes in to <code>p</code>, it must be converted to <em>\"array of records\"</em> <code>record* arr = (record*)p;</code>. The number of items in the array should be <code>filesize/sizeof(record)</code> if everything went according to plan</p>\n\n<pre><code>int main(void)\n{\n    long filesize = 0;\n    unsigned char* p = readfile(\"d.bin\", &amp;filesize);\n    if(!p)\n        return 0;\n\n    int count = filesize / sizeof(record);\n    record* arr = (record*)p;\n\n    qsort(arr, count, sizeof(record), nuvu);\n\n    for(int i = 0; i &lt; count; i++)\n        printf(\"%s %f\\n\", arr[i].name, arr[i].value);\n\n    free(p);\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "is_accepted": false, "score": 1, "last_activity_date": 1514432473, "last_edit_date": 1514432473, "creation_date": 1514431864, "answer_id": 48001271, "question_id": 47999053, "link": "https://stackoverflow.com/questions/47999053/how-to-access-struct-in-an-array-of-structs/48001271#48001271", "title": "How to access struct in an array of structs", "body": "<p>The biggest confusion you seem to have is \"How do I read my array of structs back in?\"</p>\n\n<pre><code>unsigned char* p = readfile( \"d.bin\", &amp;N );\n</code></pre>\n\n<p>Is no way to begin. The concept of reading records from a binary file into an array of struct, is to read <code>sizeof (struct record)</code> bytes from the file into storage for type <code>struct record</code>. (<em>this will ignore for now the lack of serialization of the data, padding and portability issues, and the fact we are using a <code>typedef</code></em>).</p>\n\n<p>Knowing the file size, and knowing the <code>sizeof (struct record)</code> allows you to (1) validate the number of records you will read from the file, e.g. (<code>nbytes / sizeof (struct record)</code>) and (2) determine whether there are any stray bytes leftover that will not be part of the read (e.g. <code>if (nbytes / sizeof (struct record) != 0)</code>) which if present you should at least warn about.</p>\n\n<p>Depending on the number of records you have to read and whether there is an upper bound for that number will determine whether you can use a fixed size array (or VLA) or whether you need to dynamically allocate (and reallocate) to address an unknown number of records or to prevent StackOverflow..  Regardless how you handle creating storage for your records -- <em>It is up to you to make sure you do not write beyond the bounds of the storage you create</em>.</p>\n\n<p>Below, for example purposes we will simply work with an array of <code>100</code> records. The dividing line between what will fit on the stack and when you need to dynamically allocate will be compiler dependent, but any time you start thinking about tens of thousands of records, you need to consult your compiler documentation and start thinking about dynamic allocation.</p>\n\n<p><code>fread</code> provides a simple method to read binary records from a file and validate that you actually read the number of records you intended to read. For example, given a declaration of an array of <code>100</code> records in <code>rec</code>, you could do something like the following:</p>\n\n<pre><code>enum { MAXC = 32, MAXS = 100 }; /* if you need constants, define them */\n...\n    record rec[MAXS] = {{ .name = \"\" }};    /* array of 100 records */\n    ...\n    nrec = nbytes / sizeof *rec;   /* number of records based on file size */\n\n    /* read / validate nrec records from file */\n    if (fread (rec, sizeof *rec, nrec, fp) != nrec) {\n        perror (fn);\n        return 1;\n    }\n</code></pre>\n\n<p>With your records successfully read from your file, using <code>qsort</code> to sort the records (either by <code>name</code> or by <code>value</code>) requires you to understand that the <code>const void *</code> pointers to be compared in your comparison function will be <em>pointer to rec</em>, so you must provide an appropriate cast within your comparison function to access and compare the values. For example to perform a string comparison on <code>name</code>, you can do something similar to the following:</p>\n\n<pre><code>/** record string comparison on name */\nint reccmpname (const void *a, const void *b)\n{\n    const record *ra = a,\n                 *rb = b;\n    return strcmp (ra-&gt;name, rb-&gt;name);\n}\n</code></pre>\n\n<p>Other than that, the remainder of what your code lack is <strong><em>validation</em></strong> of each step in the process. Always, always, validate the return of any function you use and handle any errors you encounter. A minimal example, without splitting the code up between separate source files could be something like the following. Splitting up into separate source files is left to you. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nenum { MAXC = 32, MAXS = 100 }; /* if you need constants, define them */\n\ntypedef struct {\n    char name[MAXC];\n    double value;\n} record;\n\n/** record string comparison on name */\nint reccmpname (const void *a, const void *b)\n{\n    const record *ra = a,\n                 *rb = b;\n    return strcmp (ra-&gt;name, rb-&gt;name);\n}\n\nint main (int argc, char **argv) {\n\n    record rec[MAXS] = {{ .name = \"\" }};    /* array of 100 records */\n    size_t nrec = 0;                        /* number of records from file */\n    long nbytes = 0;                        /* number of bytes in file */\n    char *fn = argc &gt; 1 ? argv[1] : \"dat/records.bin\";\n    FILE *fp = fopen (fn, \"rb\");\n\n    if (!fp) {  /* validate file open for reading */\n        fprintf (stderr, \"error: file open failed '%s'.\\n\", argv[1]);\n        return 1;\n    }\n\n    if (fseek (fp, 0, SEEK_END) == -1) {    /* validate seek to end */\n        perror (\"fseek\");\n        return 1;\n    }\n    nbytes = ftell (fp);                    /* number of bytes in file */\n    if (nbytes == -1) {\n        perror (\"ftell\");\n        return 1;\n    }\n    if (fseek (fp, 0, SEEK_SET) == -1) {    /* validate seek to start */\n        perror (\"fseek\");\n        return 1;\n    }\n\n    if (nbytes % sizeof *rec != 0) /* does file contain even no. or records? */\n        fprintf (stderr, \"warning: file size not multiple of record size.\\n\");\n\n    nrec = nbytes / sizeof *rec;   /* number of records based on file size */\n\n    /* read / validate nrec records from file */\n    if (fread (rec, sizeof *rec, nrec, fp) != nrec) {\n        perror (fn);\n        return 1;\n    }\n    fclose (fp);    /* close file */\n\n    printf (\"\\n=== unsorted records ===\\n\\n\");  /* output unsorted */\n    for (size_t i = 0; i &lt; nrec; i++)\n        printf (\"%-32s  %g\\n\", rec[i].name, rec[i].value);\n\n    qsort (rec, nrec, sizeof *rec, reccmpname); /* qsort records */\n\n    printf (\"\\n=== sorted records ===\\n\\n\");    /* output sorted */\n    for (size_t i = 0; i &lt; nrec; i++)\n        printf (\"%-32s  %g\\n\", rec[i].name, rec[i].value);\n\n    return 0;\n}\n</code></pre>\n\n<p><strong>note:</strong> The data file used simply contained 100 struct records with dictionary words as <code>name</code> and random values as <code>value</code> shuffled before being written to the file.</p>\n\n<p><strong>Example Use/Output</strong></p>\n\n<pre><code>$ ./bin/struct_rd_name_val_recs\n\n=== unsorted records ===\n\nAbscess                           4.15871e+08\nAbject                            3.5743e+08\nAbo                               6.87659e+08\nAboard                            2.02028e+09\nAbase                             3.34319e+08\n...\n=== sorted records ===\n\nA                                 3.66907e+08\nAaa                               5.59224e+07\nAaas                              1.45617e+09\nAardvark                          1.72828e+09\nAarhus                            1.95723e+09\n</code></pre>\n\n<p>Let me know if you have any questions.</p>\n"}], "owner": {"reputation": 3, "user_id": 8967804, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbbb92784da8dc7ffc2b59991f99f311?s=128&d=identicon&r=PG&f=1", "display_name": "ashley", "link": "https://stackoverflow.com/users/8967804/ashley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1127, "favorite_count": 0, "accepted_answer_id": 48000648, "answer_count": 3, "score": 0, "last_activity_date": 1514438135, "creation_date": 1514411389, "last_edit_date": 1514438135, "question_id": 47999053, "link": "https://stackoverflow.com/questions/47999053/how-to-access-struct-in-an-array-of-structs", "title": "How to access struct in an array of structs", "body": "<p>In a school assignment, I have to sort elements of struct that are located  in binary file. I think I have managed to sort it, but I have a problem with printing the result. I don't know how to access elements of struct because data must be read from file, so I only have address of the first struct in a array. (I think it should stay in array so that I can use qsort.)</p>\n\n<p>This is the main code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include \"readfile.h\"\n\ntypedef struct {\nchar name[32];\ndouble value;\n} record;\n\nint nuvu(record* a, record* b){\n    if(a-&gt;name &lt; b-&gt;name) return -1;\n    if(a-&gt;name &gt; b-&gt;name) return 1;\n    if(a-&gt;value &lt; b-&gt;value) return -1;\n    if(a-&gt;value &gt; b-&gt;value) return 1;\n}\n\nint main()\n{\n    long N;\n    unsigned char* p = readfile( \"d.bin\", &amp;N );\n    char* s;\n    scanf(\"%s\",&amp;s);\n\n    int k= N/sizeof(record);\n    qsort(p,k,sizeof(record),(int(*)(const void*, const void *))nuvu);\n\n    printf???\n\n    free(p);\n    return 0;\n}\n</code></pre>\n\n<p>Additional:\nreadfile.c</p>\n\n<pre><code>#include \"readfile.h\"\nunsigned char* readfile( char* filename, long* pN )\n{\n    FILE* f= fopen(filename,\"rb\");\n    if(f==0){\n        *pN=-1;\n        return 0;\n    }\n    fseek(f,0,SEEK_END);\n    *pN=ftell(f);\n    fseek(f,0,SEEK_SET);\n\n    char*p=malloc(*pN);\n    if(p==0){\n        *pN=-2;\n        fclose(f);\n        return 0;\n    }\n    size_t r = fread(p,1,*pN,f);\n    if(r!=*pN){\n        *pN=-3;\n        fclose(f);\n        free(p);\n        return 0;\n    }\n    fclose(f);\n    return p;\n}\n</code></pre>\n\n<p>readfile.h</p>\n\n<pre><code>#ifndef __READFILE_H\n#define __READFILE_H\n\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\nunsigned char* readfile(char* filename, long* pN);\n\n#endif /* __READFILE_H */\n</code></pre>\n"}, {"tags": ["c#", "c", "interop"], "comments": [{"owner": {"reputation": 13909, "user_id": 162699, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/11d701f4f186f539521cde8050d0b341?s=128&d=identicon&r=PG", "display_name": "Gusman", "link": "https://stackoverflow.com/users/162699/gusman"}, "edited": false, "score": 0, "creation_date": 1514410395, "post_id": 47998864, "comment_id": 82966193, "body": "Without seeing the dllImport and the concrete exception is very hard to any one to help you"}, {"owner": {"reputation": 808, "user_id": 3360864, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/z8m64.jpg?s=128&g=1", "display_name": "Erik", "link": "https://stackoverflow.com/users/3360864/erik"}, "reply_to_user": {"reputation": 13909, "user_id": 162699, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/11d701f4f186f539521cde8050d0b341?s=128&d=identicon&r=PG", "display_name": "Gusman", "link": "https://stackoverflow.com/users/162699/gusman"}, "edited": false, "score": 0, "creation_date": 1514410967, "post_id": 47998864, "comment_id": 82966406, "body": "Here you are , the DLLImport."}], "answers": [{"comments": [{"owner": {"reputation": 808, "user_id": 3360864, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/z8m64.jpg?s=128&g=1", "display_name": "Erik", "link": "https://stackoverflow.com/users/3360864/erik"}, "edited": false, "score": 0, "creation_date": 1514412544, "post_id": 47999082, "comment_id": 82966880, "body": "I wrote the arrays element by element, one at a time, to the buffer. So the buffer has no clue that there is an array in it. C-Side, I read the arrays again element by element into C-arrays, knowing exactly what went into the buffer. The arrays that I return (Deflection and MemberEndForces, defined C#-side, filled C-side), came back OK when i had a string buffer, so that cannot be an issue, could it?"}, {"owner": {"reputation": 13909, "user_id": 162699, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/11d701f4f186f539521cde8050d0b341?s=128&d=identicon&r=PG", "display_name": "Gusman", "link": "https://stackoverflow.com/users/162699/gusman"}, "reply_to_user": {"reputation": 808, "user_id": 3360864, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/z8m64.jpg?s=128&g=1", "display_name": "Erik", "link": "https://stackoverflow.com/users/3360864/erik"}, "edited": false, "score": 1, "creation_date": 1514412805, "post_id": 47999082, "comment_id": 82966951, "body": "@Erik I can&#39;t see what your external function does, my cristal ball is under repair right now... In any case C# will not marshal correctly multidimensional arrays so it will fail, also adding the exception you receive may be of help, here on Stack Overflow we are programmers not crystal gazers..."}, {"owner": {"reputation": 808, "user_id": 3360864, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/z8m64.jpg?s=128&g=1", "display_name": "Erik", "link": "https://stackoverflow.com/users/3360864/erik"}, "edited": false, "score": 0, "creation_date": 1514413465, "post_id": 47999082, "comment_id": 82967142, "body": "Of course the problem might be somewhere in the C-function, but the thing is, that function seems to work well UNTIL returning to C#. Stepping shows the C part works, the data is read correctly from the binary buffer.  Besides, using a StringBuilder buffer works like a charm, returning the C# arrays Deflection and  MemberEndForces in excelent condition. Not surprising, since I only pass pointers,. From what you say I can, for now,  only conclude, that there is nothing wrong with what I do and I have to look elsewhere. That helps too."}, {"owner": {"reputation": 13909, "user_id": 162699, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/11d701f4f186f539521cde8050d0b341?s=128&d=identicon&r=PG", "display_name": "Gusman", "link": "https://stackoverflow.com/users/162699/gusman"}, "reply_to_user": {"reputation": 808, "user_id": 3360864, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/z8m64.jpg?s=128&g=1", "display_name": "Erik", "link": "https://stackoverflow.com/users/3360864/erik"}, "edited": false, "score": 1, "creation_date": 1514413925, "post_id": 47999082, "comment_id": 82967287, "body": "@Erik Again, C# WILL NOT marshall correctly the multidimensional arrays. If you post the exception you receive may be I can confirm if that&#39;s the problem."}, {"owner": {"reputation": 808, "user_id": 3360864, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/z8m64.jpg?s=128&g=1", "display_name": "Erik", "link": "https://stackoverflow.com/users/3360864/erik"}, "edited": false, "score": 0, "creation_date": 1514447778, "post_id": 47999082, "comment_id": 82975516, "body": "As I said before: no exception, just: &quot;MyProgram has stopped working A problem caused the program to stop working correctly. Windows will close the program and notify you is a solution is available&quot; and a button: &quot;Close program&quot;. Of course there is no subsequent notification."}, {"owner": {"reputation": 13909, "user_id": 162699, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/11d701f4f186f539521cde8050d0b341?s=128&d=identicon&r=PG", "display_name": "Gusman", "link": "https://stackoverflow.com/users/162699/gusman"}, "reply_to_user": {"reputation": 808, "user_id": 3360864, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/z8m64.jpg?s=128&g=1", "display_name": "Erik", "link": "https://stackoverflow.com/users/3360864/erik"}, "edited": false, "score": 0, "creation_date": 1514565672, "post_id": 47999082, "comment_id": 83020766, "body": "@Erik Are you running this in debug mode?"}, {"owner": {"reputation": 808, "user_id": 3360864, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/z8m64.jpg?s=128&g=1", "display_name": "Erik", "link": "https://stackoverflow.com/users/3360864/erik"}, "edited": false, "score": 0, "creation_date": 1514677588, "post_id": 47999082, "comment_id": 83047986, "body": "Yes. Strange, that the the byte[] did work and the ref byte[] did not, but only when returning to C#. INSIDE C, it did work. Anyway, I got the solution, as you can see above."}], "tags": [], "owner": {"reputation": 13909, "user_id": 162699, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/11d701f4f186f539521cde8050d0b341?s=128&d=identicon&r=PG", "display_name": "Gusman", "link": "https://stackoverflow.com/users/162699/gusman"}, "is_accepted": false, "score": 0, "last_activity_date": 1514412361, "last_edit_date": 1514412361, "creation_date": 1514411603, "answer_id": 47999082, "question_id": 47998864, "link": "https://stackoverflow.com/questions/47998864/crash-on-returning-from-c-why-of-course/47999082#47999082", "title": "Crash on returning from C: Why (of course)?", "body": "<p>According to <a href=\"https://social.msdn.microsoft.com/Forums/vstudio/en-US/6d1322ce-b1e6-4da4-92cf-366259510e48/passing-multidimensional-array-from-c-to-win32-c-dll?forum=clr\" rel=\"nofollow noreferrer\">this post</a> on MSDN multidimensional arrays aren't marshaled when calling an external function, so you must convert the array to a single dimensional one.</p>\n\n<p>As I see those arrays are output buffers, so for calling you can do this:</p>\n\n<pre><code>double[] MemberEndforces = new double[mbCount * 12];\ndouble[] Deflection = new double[(mbCount + 1) * 6];\n\n//...\n\ninfo = NativeMethods.Cr(\n                    ref buffer, NrOfMod, Eigenfreqs, ref error,\n                    ref rms_resid, MemberEndforces, Deflection);\n</code></pre>\n\n<p>Then you need to convert those arrays to multidimensional ones once the function has been called:</p>\n\n<pre><code>double[,] mMemberEndforces = new double[mbCount, 12];\ndouble[,] mDeflection = new double[mbCount + 1, 6];\n\nfor(int x = 0; x &lt; mbCount; x++)\n{\n    for(int y = 0; y &lt; 12; y++)\n        mMemberEndforces[x,y] = MemberEndforces[x * 12 + y];\n}\n\nfor(int x = 0; x &lt; mbCount + 1; x++)\n{\n    for(int y = 0; y &lt; 6; y++)\n        mDeflection[x,y] = Deflection[x * 6 + y];\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 808, "user_id": 3360864, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/z8m64.jpg?s=128&g=1", "display_name": "Erik", "link": "https://stackoverflow.com/users/3360864/erik"}, "is_accepted": false, "score": 0, "last_activity_date": 1514452038, "last_edit_date": 1514452038, "creation_date": 1514450332, "answer_id": 48004241, "question_id": 47998864, "link": "https://stackoverflow.com/questions/47998864/crash-on-returning-from-c-why-of-course/48004241#48004241", "title": "Crash on returning from C: Why (of course)?", "body": "<p>I found a solution:\nI removed the unsafe{}. It's not necessary.\nThen I \"de-referenced\" ref buffer in the call to the C-routine:</p>\n\n<pre><code> using (BinaryWriter binWriter = new BinaryWriter(new MemoryStream()))\n {\n     BuildExportBuffer(binWriter); // fill the buffer with doubles and floats ant ints\n     var buffer = ((MemoryStream)binWriter.BaseStream).GetBuffer(); // get the buffer's address\n     info = NativeMethods.Cr( buffer, NrOfMod, Eigenfreqs, ref error, ref rms_resid,\n MemberEndforces, Deflection);\n  .....\n    etc.\n</code></pre>\n\n<p>Same thing in the DLLImport, of course.</p>\n\n<p>Also in the C-function I changed some little things:</p>\n\n<pre><code>extern \"C\"\n{\nchar ** buffer;\n\n__declspec(dllexport) int __cdecl Cr(\n    char *_buffer,  // &lt;== here and\n    int n,\n    float * eigenFreq,\n    double * error,\n    double * rms_resid,\n    double * endforces,\n    double * deflection\n     )\n {\n\n    buffer = &amp;_buffer; // &lt;== here.\n</code></pre>\n\n<p>To show how I read a double from the buffer C-side:</p>\n\n<pre><code>double  readd(char **buffer)\n{\n   double *f = (double *) *buffer;\n   *buffer += 8;\n   return *f;\n}\n</code></pre>\n\n<p>Works like a charm. I still have to figure out the WHY.</p>\n"}], "owner": {"reputation": 808, "user_id": 3360864, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/z8m64.jpg?s=128&g=1", "display_name": "Erik", "link": "https://stackoverflow.com/users/3360864/erik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 86, "favorite_count": 0, "answer_count": 2, "score": -3, "last_activity_date": 1514452038, "creation_date": 1514410129, "last_edit_date": 1514410857, "question_id": 47998864, "link": "https://stackoverflow.com/questions/47998864/crash-on-returning-from-c-why-of-course", "title": "Crash on returning from C: Why (of course)?", "body": "<p>In C#  I fill a binary buffer (1.5 to 2 kB), to which I refer in a C DLL. All goes well (stepping through C says so), until I have to return to C#. At that very last moment, the program crashes (NO exception throwing, just a crash: \"Stopped working\").\nCr is the C routine, in a DLL.\nI work in Visual Studio Community 2017.\nEarlier, I passed the data via a string and sscanf_s in C, which worked well,  but wanted to speed up things a bit (and learn different things on the way).\nThe buffer contains all kinds of floats, ints and doubles, which are picked up C-side correctly (stepping says so). \nHere is the first piece of C# code:</p>\n\n<pre><code>    double[,] MemberEndforces = new double[mbCount, 12];\n            double[,] Deflection = new double[mbCount + 1, 6];\n            //double[] Reactions = new double[6];\n\n            unsafe\n            {\n                using (BinaryWriter binWriter = new BinaryWriter(new MemoryStream()))\n                {\n\n                    BuildExportBuffer(binWriter);\n                    var buffer = ((MemoryStream)binWriter.BaseStream).GetBuffer();\n                    info = NativeMethods.Cr(\n                        ref buffer, NrOfMod, Eigenfreqs, ref error,\n                        ref rms_resid, MemberEndforces, Deflection);\n                }  // end using\n                if (info != 0)\n                    throw new MyException(string.Format(ErrorMessages.SomeError, info));\n                bool converged = error &lt; tolerance;\n\n                ...\n            } // end unsafe\n</code></pre>\n\n<p>And here folllows the head of the receiving C-routine. Only at the last curly brace, and stepping back to C#, does the crash occur. It does so, with or without the safe{} block.</p>\n\n<pre><code>extern \"C\"\n{\n    char ** buffer;\n    //char * next_token;\n\n    __declspec(dllexport) int __cdecl Cr(\n        char **_buffer,\n        int n,\n        float * eigenFreq,\n        double * error,\n        double * rms_resid,\n        double * endforces,\n        double * deflection\n         )\n     { buffer = _buffer;\n        ...\n        // read stuff from  buffer and process it...\n        return ExitCode;\n\n     }\n</code></pre>\n\n<p>And here is the DLL import:</p>\n\n<pre><code>[DllImport(@\"Cr.dll\", CallingConvention = CallingConvention.Cdecl, EntryPoint = \"Cr\", \n        CharSet = CharSet.Ansi, BestFitMapping =false,ThrowOnUnmappableChar =true)]\n\n\n    public static extern int Cr([In] ref byte[] buffer,\n        [In] int n, \n        float[] eigenfreq, \n        ref double error, \n        ref double rms_resid,            \n        double[,] force,\n        double[,] defl);\n</code></pre>\n\n<p>So: Why? What do I do wrong ? If there's something wrong in the C-part, it would have shown earlier than the last curly brace, no? The last part of the C code does a lot of freeing malloc-ed blocks (not the buffer!).</p>\n"}, {"tags": ["c", "pointers", "free"], "comments": [{"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 1, "creation_date": 1514409977, "post_id": 47998777, "comment_id": 82966038, "body": "<i>Or did the writer did that checkup in case someone did something like this?</i> yes, that&#39;s exactly for that. Note that when you write functions, you may not be the user of your functions, for example if you are writing a library. Specially when dealing with pointers, it&#39;s always a good idea to explicitly check for <code>NULL</code> and react accordingly, in this case by doing nothing at all."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1514410104, "post_id": 47998777, "comment_id": 82966091, "body": "Yes, check the pointer value before dereferencing it. If a pointer to a pointer, check that too, although <code>free</code> is harmless when passed a <code>NULL</code> pointer. The catch is the first pointer, which when <code>NUL</code> will fail if you dereference it."}, {"owner": {"reputation": 25937, "user_id": 338904, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/dea29233fa03ea84f8a853102deb0344?s=128&d=identicon&r=PG", "display_name": "e2-e4", "link": "https://stackoverflow.com/users/338904/e2-e4"}, "edited": false, "score": 0, "creation_date": 1514432909, "post_id": 47998777, "comment_id": 82971188, "body": "The function frees a pointer and <i>sets it to NULL</i>. This is a way to avoid double free."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1514434303, "post_id": 47998777, "comment_id": 82971437, "body": "<code>&amp;&amp; *pp!= NULL</code> is not needed.  <code>free(NULL)</code> is OK."}], "answers": [{"tags": [], "owner": {"reputation": 11238, "user_id": 7594711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7872c871b0431b72df6350dd0394bea?s=128&d=identicon&r=PG&f=1", "display_name": "SoronelHaetir", "link": "https://stackoverflow.com/users/7594711/soronelhaetir"}, "is_accepted": false, "score": 0, "last_activity_date": 1514410181, "creation_date": 1514410181, "answer_id": 47998871, "question_id": 47998777, "link": "https://stackoverflow.com/questions/47998777/double-pointer-as-function-parameter/47998871#47998871", "title": "Double pointer as function parameter", "body": "<p>The function checks for NULL mainly for cases like your second. If an actual variable address is passed that check will not fail but never trust your caller to be sane.</p>\n"}, {"comments": [{"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1514411711, "post_id": 47998985, "comment_id": 82966654, "body": "Your scenarios do not make sense."}, {"owner": {"reputation": 18942, "user_id": 894328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3db17c5296335f63e856be44aa821bf6?s=128&d=identicon&r=PG", "display_name": "Ahmed Masud", "link": "https://stackoverflow.com/users/894328/ahmed-masud"}, "reply_to_user": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 1, "creation_date": 1514411938, "post_id": 47998985, "comment_id": 82966721, "body": "Yes they don&#39;t, that&#39;s exactly the point! the trouble with safeFree prototype is that it confuses the API user, and I created somewhat nonsensical scenario to show how it could be misinterpreted.  The word <i>safe</i> in safeFree misleads the API user to think that it will correctly handle goofy deallocation requests, and here are some (albeit silly) cases where there were mallocs that are mishandled."}], "tags": [], "owner": {"reputation": 18942, "user_id": 894328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3db17c5296335f63e856be44aa821bf6?s=128&d=identicon&r=PG", "display_name": "Ahmed Masud", "link": "https://stackoverflow.com/users/894328/ahmed-masud"}, "is_accepted": true, "score": 0, "last_activity_date": 1514410943, "creation_date": 1514410943, "answer_id": 47998985, "question_id": 47998777, "link": "https://stackoverflow.com/questions/47998777/double-pointer-as-function-parameter/47998985#47998985", "title": "Double pointer as function parameter", "body": "<p>Having said that <code>safeFree</code> is just confusing and does <em>not</em> provide safety. Because the code assumes that the API user will always pass a particularly constructed pointer. Consider these:</p>\n\n<h1>tricky 0 (screws up a)</h1>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n\nvoid safeFree(void **pp) {\n  if (pp != NULL &amp;&amp; *pp!= NULL) {\n      free(*pp);\n      *pp = NULL;\n  }\n}\n\nint main() {\n    int *a;\n    int **p;\n    a = malloc(5 * sizeof(int));\n    p = malloc(1 * sizeof(a));\n    a[0] = 10;\n    p[0] = a;\n    fprintf(stderr, \"%d\\n\", a[0]);\n    safeFree((void **)p); /* grrrr */\n    fprintf(stderr, \"%d\\n\", a[0]);\n}\n</code></pre>\n\n<h1>tricky 1 (crashes)</h1>\n\n<pre><code>int main() {\n    int a[] = { };\n    int b[] = { 1 };\n    int c[] = { 2 };\n\n    int **p = malloc(3 * sizeof(int *));\n    p[0] = a, p[1] = b, p[2] = c;\n\n    safeFree((void **)p); /* grrrr */\n}\n</code></pre>\n"}], "owner": {"reputation": 139, "user_id": 9069919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5998224f44d85dc35724d0810d20c98b?s=128&d=identicon&r=PG&f=1", "display_name": "Mart&#237;n", "link": "https://stackoverflow.com/users/9069919/mart%c3%adn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 166, "favorite_count": 0, "accepted_answer_id": 47998985, "answer_count": 2, "score": 1, "last_activity_date": 1514410943, "creation_date": 1514409638, "last_edit_date": 1514410488, "question_id": 47998777, "link": "https://stackoverflow.com/questions/47998777/double-pointer-as-function-parameter", "title": "Double pointer as function parameter", "body": "<p>I was reading a page of <a href=\"https://www.amazon.es/Understanding-Using-Pointers-Richard-Reese/dp/1449344186\" rel=\"nofollow noreferrer\">\"Understanding and Using C Pointers\"</a> when this function appeared:</p>\n\n<pre><code>void safeFree(void **pp) {\n  if (pp != NULL &amp;&amp; *pp!= NULL) {\n    free(*pp);\n    *pp = NULL;\n  }\n}\n</code></pre>\n\n<p>and an example code from it:</p>\n\n<pre><code>int main(int argc, char **argv) {\n  int* pi = (int*)malloc(sizeof(int));\n  *pi = 5;\n  safeFree((void**)&amp;pi);\n\n  return EXIT_SUCCESS;\n} \n</code></pre>\n\n<p>My point is, checking <code>pp != NULL</code> in the <code>if</code> condition in this scenario is useless, right? Because according to the way this code is written this condition will never be false. But there is a scenario in which this condition will be true, assuming <code>**pp</code> expects a memory address and (assumed by me) a memory address of a variable can never be <code>NULL</code>? Or did the writer did that checkup in case someone did something like this?</p>\n\n<pre><code>int main(int argc, char **argv) {\n  int **pi = NULL;\n  safeFree((void**)pi);\n\n  return EXIT_SUCCESS;\n}\n</code></pre>\n\n<p>Thanks. </p>\n"}, {"tags": ["c", "linker", "embedded", "linker-scripts"], "comments": [{"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 4, "creation_date": 1514408868, "post_id": 47998619, "comment_id": 82965647, "body": "&#39;length 00000000&#39;, I guess.  If it was 00040000/00040000, that would mean length  00000001, ie. &#39;first valid address is 00040000, last valid address is 00040000&#39;."}, {"owner": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 0, "creation_date": 1514431146, "post_id": 47998619, "comment_id": 82970854, "body": "Wonder if it might be more an oddity of the software outputting the sections. would be surprised if this is how it is represented in the actual generated file."}], "answers": [{"tags": [], "owner": {"reputation": 5314, "user_id": 5270581, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/leDO2.jpg?s=128&g=1", "display_name": "Laurent H.", "link": "https://stackoverflow.com/users/5270581/laurent-h"}, "is_accepted": false, "score": 1, "last_activity_date": 1514548189, "last_edit_date": 1514548189, "creation_date": 1514547798, "answer_id": 48022102, "question_id": 47998619, "link": "https://stackoverflow.com/questions/47998619/bss-section-end-address-is-less-than-start-address/48022102#48022102", "title": "bss section end address is less than start address", "body": "<p>This is a normal behavior.<br>\nThe formula to comply with is the following:  </p>\n\n<pre><code>length = \"end addr\" - \"start addr\" + 1\n</code></pre>\n\n<p>So:<br>\n- if the section is not empty, <code>end addr</code> corresponds to the last address that belongs to the section.<br>\n- if the section is empty, <code>end addr</code> equals <code>start addr - 1</code>, which means that <code>end addr</code> is NOT an end address in this case, as you observed for <em>RM0_SECTION</em>.</p>\n"}], "owner": {"reputation": 809, "user_id": 3889600, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/69eda5b79c7f2201428b83bf55d607d7?s=128&d=identicon&r=PG&f=1", "display_name": "electro", "link": "https://stackoverflow.com/users/3889600/electro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 122, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1514548189, "creation_date": 1514408538, "question_id": 47998619, "link": "https://stackoverflow.com/questions/47998619/bss-section-end-address-is-less-than-start-address", "title": "bss section end address is less than start address", "body": "<p>I am looking at ARC processor map file and found a section which end address is less than start address.</p>\n\n<p>Is this normal or a bug in the linker script or other issues?</p>\n\n<pre><code>Section name         type     start addr    end addr    length\nRM0_SECTION          bss       00040000    0003ffff     00000000\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 2, "creation_date": 1514407977, "post_id": 47998504, "comment_id": 82965353, "body": "That looks like a problem with the test, if you&#39;ve reproduced the <code>return #</code> line accurately. The <code>return</code> is missing a return value and a semicolon."}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 4, "creation_date": 1514408030, "post_id": 47998504, "comment_id": 82965372, "body": "I&#39;ve never seen that. My c compiler (gnu gcc 6.4.0) shows me this error: <b>error: stray \u2018#\u2019 in program</b>"}, {"owner": {"reputation": 530, "user_id": 2050326, "user_type": "registered", "accept_rate": 15, "profile_image": "https://www.gravatar.com/avatar/bcaf341befc72444d63ece72dadc5619?s=128&d=identicon&r=PG", "display_name": "Richard Johnson", "link": "https://stackoverflow.com/users/2050326/richard-johnson"}, "edited": false, "score": 0, "creation_date": 1514408105, "post_id": 47998504, "comment_id": 82965398, "body": "Okay, it must be a typo. This has been driving me buggy. Thanks."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 6, "creation_date": 1514408178, "post_id": 47998504, "comment_id": 82965417, "body": "The code that should be there is <code>return &amp;num;</code>. It looks like the instructor put that into an HTML page without proper encoding. <code>&amp;num;</code> is an HTML entity for the <code>#</code> character."}], "answers": [{"comments": [{"owner": {"reputation": 530, "user_id": 2050326, "user_type": "registered", "accept_rate": 15, "profile_image": "https://www.gravatar.com/avatar/bcaf341befc72444d63ece72dadc5619?s=128&d=identicon&r=PG", "display_name": "Richard Johnson", "link": "https://stackoverflow.com/users/2050326/richard-johnson"}, "edited": false, "score": 0, "creation_date": 1514408502, "post_id": 47998580, "comment_id": 82965534, "body": "Oh, that&#39;s interesting and now this all makes sense. Thanks very much."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 5, "creation_date": 1514408519, "post_id": 47998580, "comment_id": 82965539, "body": "They <i>should</i> have written C code as plain text and then used something that converts it to valid HTML."}, {"owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "edited": false, "score": 7, "creation_date": 1514408812, "post_id": 47998580, "comment_id": 82965625, "body": "Very nice catch! It&#39;s amazing how a tiny error like that gives you a pretty good idea of the quality of the entire site that tries to teach people programming :-)"}], "tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": true, "score": 23, "last_activity_date": 1514408305, "creation_date": 1514408305, "answer_id": 47998580, "question_id": 47998504, "link": "https://stackoverflow.com/questions/47998504/use-of-symbol-in-c/47998580#47998580", "title": "Use of # symbol in C", "body": "<p>Whoever created the test didn't properly encode their HTML. What they wanted that line to look like is:</p>\n\n<pre><code>return &amp;num;\n</code></pre>\n\n<p>They put that directly into the HTML of the test page, forgetting that <code>&amp;XXX;</code> is how HTML entities are entered. <code>&amp;num;</code> is the entity for the <code>#</code> character. They should have written:</p>\n\n<pre><code>return &amp;amp;num;\n</code></pre>\n\n<p><code>&amp;amp;</code> is the entity for the <code>&amp;</code> character.</p>\n"}, {"comments": [{"owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "edited": false, "score": 1, "creation_date": 1514409163, "post_id": 47998655, "comment_id": 82965741, "body": "This is a nice answer, but it explains something OP already knows. He wants to find out what&#39;s the deal with the <code>#</code> sign, which your answer does not explain."}, {"owner": {"reputation": 185, "user_id": 8496264, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ZN4cufHAnLM/AAAAAAAAAAI/AAAAAAAAFzU/jfHy_0-QcDA/photo.jpg?sz=128", "display_name": "Mitu Raj", "link": "https://stackoverflow.com/users/8496264/mitu-raj"}, "reply_to_user": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "edited": false, "score": 1, "creation_date": 1514409671, "post_id": 47998655, "comment_id": 82965934, "body": "I felt he might be wondering about how segmentation fault occured. Anyways edited."}], "tags": [], "owner": {"reputation": 185, "user_id": 8496264, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ZN4cufHAnLM/AAAAAAAAAAI/AAAAAAAAFzU/jfHy_0-QcDA/photo.jpg?sz=128", "display_name": "Mitu Raj", "link": "https://stackoverflow.com/users/8496264/mitu-raj"}, "is_accepted": false, "score": 0, "last_activity_date": 1514409527, "last_edit_date": 1514409527, "creation_date": 1514408817, "answer_id": 47998655, "question_id": 47998504, "link": "https://stackoverflow.com/questions/47998504/use-of-symbol-in-c/47998655#47998655", "title": "Use of # symbol in C", "body": "<p>The function func() returns a pointer that points to the variable num. But num is an auto variable inside the function func(). It's stored in stack and its lifetime is only the lifetime of the function itself. So if you try to access that pointer in the main() it will be segmentation fault cz num doesn't exist anymore and hence pointer doesn't really point to anything.</p>\n\n<p>Edit:</p>\n\n<p>Hash - # is used for defining macros and header files.  return # -->  it just seems to be typo in the question. So only error is the segmentation fault due to pointer.</p>\n"}], "owner": {"reputation": 530, "user_id": 2050326, "user_type": "registered", "accept_rate": 15, "profile_image": "https://www.gravatar.com/avatar/bcaf341befc72444d63ece72dadc5619?s=128&d=identicon&r=PG", "display_name": "Richard Johnson", "link": "https://stackoverflow.com/users/2050326/richard-johnson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 201, "favorite_count": 1, "accepted_answer_id": 47998580, "answer_count": 2, "score": 4, "last_activity_date": 1514480150, "creation_date": 1514407846, "last_edit_date": 1514480150, "question_id": 47998504, "link": "https://stackoverflow.com/questions/47998504/use-of-symbol-in-c", "title": "Use of # symbol in C", "body": "<p>I'm taking on an online C language test (not for a job, just for on my own) and I keep running into questions of this type using the hash symbol. I am assuming its not a typo and I am not familiar with this use of a hash symbol.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint* func()\n{\n    int num = 10;\n    return #\n}\nint main()\n{\n    int *ptr = func();\n    printf(\"%d\\n\", *ptr);\n    return 0;\n}\n</code></pre>\n\n<p>What is the output of the above C code?</p>\n\n<p>The answer is that it is a runtime error and the explanation is</p>\n\n<blockquote>\n  <p>The variable defined in a function will be allocated in stack segment, which will be removed when the function returns. So accessing the address of those  variables results in segmentation fault.</p>\n</blockquote>\n"}, {"tags": ["python", "c", "python-3.x", "module"], "comments": [{"owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 0, "creation_date": 1514408508, "post_id": 47998489, "comment_id": 82965536, "body": "Sounds like you&#39;re running different code from what you posted. Try rebuilding it."}, {"owner": {"reputation": 103, "user_id": 7487361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c53bd9d413dbf8452d85c8f6dfe7ee0?s=128&d=identicon&r=PG&f=1", "display_name": "Ilovescience", "link": "https://stackoverflow.com/users/7487361/ilovescience"}, "reply_to_user": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 0, "creation_date": 1514417918, "post_id": 47998489, "comment_id": 82968266, "body": "I did (see edit) but it still wont work"}], "answers": [{"comments": [{"owner": {"reputation": 103, "user_id": 7487361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c53bd9d413dbf8452d85c8f6dfe7ee0?s=128&d=identicon&r=PG&f=1", "display_name": "Ilovescience", "link": "https://stackoverflow.com/users/7487361/ilovescience"}, "edited": false, "score": 0, "creation_date": 1514418438, "post_id": 47999889, "comment_id": 82968362, "body": "I cant f**ing belive it XD. Hours of debugging and then its this. Thank you very much for your help and sorry for potentially wasting your time."}, {"owner": {"reputation": 35962, "user_id": 1399279, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/e2e566682f50d53a06a121d82f7ed8de?s=128&d=identicon&r=PG", "display_name": "SethMMorton", "link": "https://stackoverflow.com/users/1399279/sethmmorton"}, "reply_to_user": {"reputation": 103, "user_id": 7487361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c53bd9d413dbf8452d85c8f6dfe7ee0?s=128&d=identicon&r=PG&f=1", "display_name": "Ilovescience", "link": "https://stackoverflow.com/users/7487361/ilovescience"}, "edited": false, "score": 1, "creation_date": 1514430818, "post_id": 47999889, "comment_id": 82970793, "body": "@Ilovescience I would recommend that you take a look at Cython.  These types of errors are essentially impossible to make with Cython, and you still get the benefits of your algorithm being written in C."}], "tags": [], "owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "is_accepted": true, "score": 3, "last_activity_date": 1514418166, "creation_date": 1514418166, "answer_id": 47999889, "question_id": 47998489, "link": "https://stackoverflow.com/questions/47998489/c-extension-for-python-not-working/47999889#47999889", "title": "C extension for Python not working", "body": "<p>You forgot to null-terminate your <code>module_methods</code>:</p>\n\n<pre><code>static PyMethodDef module_methods[] = {\n    { \"func\", (PyCFunction)module_func, METH_VARARGS, NULL },\n    {NULL}\n};\n</code></pre>\n\n<p>Python looks for a null entry to determine the end of a <code>PyMethodDef</code> array. Without the null terminator, Python doesn't know where the array ends, and it walks off the end of the array looking for more methods.</p>\n"}], "owner": {"reputation": 103, "user_id": 7487361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c53bd9d413dbf8452d85c8f6dfe7ee0?s=128&d=identicon&r=PG&f=1", "display_name": "Ilovescience", "link": "https://stackoverflow.com/users/7487361/ilovescience"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 500, "favorite_count": 0, "accepted_answer_id": 47999889, "answer_count": 1, "score": 4, "last_activity_date": 1514418166, "creation_date": 1514407775, "last_edit_date": 1514417898, "question_id": 47998489, "link": "https://stackoverflow.com/questions/47998489/c-extension-for-python-not-working", "title": "C extension for Python not working", "body": "<p>The C extension installs fine (no warning and errors) but when I try to import it I get the following error: </p>\n\n<blockquote>\n  <p>File \"\", line 1, in  ValueError: module functions\n  cannot set METH_CLASS or METH_STATIC</p>\n</blockquote>\n\n<p>Here is the code, what could be the problem/what can I do to fix and avoid this error? Thank you very much in advance. \nEDIT: For some reason the compiler didnt show me all the warnings. I fixed the warnings and updated the code, but I still get the same error</p>\n\n<pre><code>#include&lt;math.h&gt;\n#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n#include&lt;time.h&gt;\n#include&lt;Python.h&gt;\n\n\nPyObject *makelist(unsigned int array[], size_t size) {\n    PyObject *l = PyList_New(size);\n    for (size_t i = 0; i != size; ++i) {\n        PyList_SET_ITEM(l, i, Py_BuildValue(\"i\", array[i]));\n    }\n    return l;\n}\n\nstatic PyObject *module_func(PyObject *self, PyObject *args) {\n    unsigned int n;\n\n    if (!PyArg_ParseTuple(args, \"i\", &amp;n)) {\n        return NULL;\n    }\n\n    const unsigned int size = n &gt;&gt; 3 + (n &amp; 15 ? 1 : 0);\n    const unsigned int arraySize = n &gt;&gt; 1;\n\n    char* bitArray = (char*)malloc(size);\n\n    for (unsigned int i = 0; i &lt; size; i++) {\n        *(bitArray + i) = 0b11111111;\n    }\n\n    int num;\n    for (unsigned int i = 1; i &lt;= ((unsigned int)sqrt(n)) &gt;&gt; 1; i++) {\n        int ni = i - 1;\n        if ((*(bitArray + (ni &gt;&gt; 3)) &gt;&gt; (ni &amp; 7)) &amp; 1) {\n            num = (i &lt;&lt; 1) | 1;\n            for (unsigned int j = num * num; j &lt;= n; j += num &lt;&lt; 1) {\n                *(bitArray + ((j - 3) &gt;&gt; 4)) &amp;= ~(1 &lt;&lt; (((j - 3) &gt;&gt; 1) &amp; 7));\n                // *(bitArray + ((((j - 1) &gt;&gt; 1) - 1) &gt;&gt; 3)) &amp;= ~(1 &lt;&lt; (((((j - 1) &gt;&gt; 1) - 1) &gt;&gt; 3) &amp; 7));\n            }\n        }\n    }\n\n    unsigned int* primes = (unsigned int*)malloc((arraySize * sizeof(int)));\n    *primes = 2;\n    int counter = 1;\n    for (unsigned int index = 1; index &lt; arraySize; index++) {\n        if ((*(bitArray + ((index - 1) &gt;&gt; 3)) &gt;&gt; ((index - 1) &amp; 7)) &amp; 1) {\n            *(primes + counter) = (index &lt;&lt; 1) | 1;\n            counter++;\n        }\n    }\n    *(primes + counter) = 0;\n    return Py_BuildValue(\"O\", makelist(primes, sizeof(primes)));\n}\n\nstatic PyMethodDef module_methods[] = {\n    { \"func\", (PyCFunction)module_func, METH_VARARGS, NULL }\n};\n\nstatic struct PyModuleDef func =\n{\n    PyModuleDef_HEAD_INIT,\n    \"module\",\n    \"Null\",\n    -1,\n    module_methods\n};\n\nPyMODINIT_FUNC PyInit_func(void) {\n    return PyModule_Create(&amp;func);\n}\n</code></pre>\n"}, {"tags": ["c", "pointers", "struct"], "comments": [{"owner": {"reputation": 11238, "user_id": 7594711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7872c871b0431b72df6350dd0394bea?s=128&d=identicon&r=PG&f=1", "display_name": "SoronelHaetir", "link": "https://stackoverflow.com/users/7594711/soronelhaetir"}, "edited": false, "score": 1, "creation_date": 1514407775, "post_id": 47998435, "comment_id": 82965284, "body": "Walk the code in your debugger, see where things go wrong."}, {"owner": {"reputation": 25744, "user_id": 2089675, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/sBz5q.jpg?s=128&g=1", "display_name": "smac89", "link": "https://stackoverflow.com/users/2089675/smac89"}, "edited": false, "score": 0, "creation_date": 1514407926, "post_id": 47998435, "comment_id": 82965334, "body": "This is the first one that jumped out at me: <code>student.lesson = lesson;</code>. What type is <code>lesson</code> and what type is <code>student.lesson</code>?"}, {"owner": {"reputation": 175, "user_id": 6906311, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/d14582c9b363d020ec12f6a14a106516?s=128&d=identicon&r=PG&f=1", "display_name": "Konstantinos Kosyfarinis", "link": "https://stackoverflow.com/users/6906311/konstantinos-kosyfarinis"}, "edited": false, "score": 0, "creation_date": 1514408037, "post_id": 47998435, "comment_id": 82965374, "body": "Corrected the          student.lesson = lesson;  to          student.lesson[i] = addLesson(); inside the for loop."}, {"owner": {"reputation": 175, "user_id": 6906311, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/d14582c9b363d020ec12f6a14a106516?s=128&d=identicon&r=PG&f=1", "display_name": "Konstantinos Kosyfarinis", "link": "https://stackoverflow.com/users/6906311/konstantinos-kosyfarinis"}, "reply_to_user": {"reputation": 25744, "user_id": 2089675, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/sBz5q.jpg?s=128&g=1", "display_name": "smac89", "link": "https://stackoverflow.com/users/2089675/smac89"}, "edited": false, "score": 0, "creation_date": 1514408391, "post_id": 47998435, "comment_id": 82965497, "body": "@smac89 , that student.lesson part could be bypassed by entering the amount of lessons to be 0. Though, the thing that I have problems with is the ID not being stored correctly, and being stored as a &quot;random&quot; number. That&#39;s what I cannot figure out"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1514408839, "post_id": 47998435, "comment_id": 82965633, "body": "You never allocates memory for <code>student.lesson</code> and your <code>realloc</code> is wrong - 1) never <code>realloc</code> to the same pointer 2) You have already done the increment"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1514409386, "post_id": 47998435, "comment_id": 82965823, "body": "<code>scanf(&quot;%s&quot;, &amp;lesson.name);</code> -&gt; <code>scanf(&quot;%s&quot;, lesson.name);</code> and btw: Never do ``scanf(&quot;%s&quot;,....` Always limit the input length, e.g. <code>scanf(&quot;%20s&quot;,</code>"}], "answers": [{"comments": [{"owner": {"reputation": 175, "user_id": 6906311, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/d14582c9b363d020ec12f6a14a106516?s=128&d=identicon&r=PG&f=1", "display_name": "Konstantinos Kosyfarinis", "link": "https://stackoverflow.com/users/6906311/konstantinos-kosyfarinis"}, "edited": false, "score": 0, "creation_date": 1514408582, "post_id": 47998609, "comment_id": 82965561, "body": "Yeah, just found that out myself. The smallest of mistakes :( Thank you though!"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "reply_to_user": {"reputation": 175, "user_id": 6906311, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/d14582c9b363d020ec12f6a14a106516?s=128&d=identicon&r=PG&f=1", "display_name": "Konstantinos Kosyfarinis", "link": "https://stackoverflow.com/users/6906311/konstantinos-kosyfarinis"}, "edited": false, "score": 0, "creation_date": 1514408901, "post_id": 47998609, "comment_id": 82965660, "body": "@KonstantinosKosyfarinis Notice that you have more errors than this"}, {"owner": {"reputation": 175, "user_id": 6906311, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/d14582c9b363d020ec12f6a14a106516?s=128&d=identicon&r=PG&f=1", "display_name": "Konstantinos Kosyfarinis", "link": "https://stackoverflow.com/users/6906311/konstantinos-kosyfarinis"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1514408953, "post_id": 47998609, "comment_id": 82965680, "body": "@4386427 still rather new to C. Would it be possible to mention of a few of them?"}], "tags": [], "owner": {"reputation": 25744, "user_id": 2089675, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/sBz5q.jpg?s=128&g=1", "display_name": "smac89", "link": "https://stackoverflow.com/users/2089675/smac89"}, "is_accepted": true, "score": 1, "last_activity_date": 1514408502, "creation_date": 1514408502, "answer_id": 47998609, "question_id": 47998435, "link": "https://stackoverflow.com/questions/47998435/c-pointer-inside-struct-error/47998609#47998609", "title": "C - Pointer inside Struct Error (?)", "body": "<pre><code>printf(\"ID of the student: \");\nscanf(\"%s\", &amp;student.id);\n</code></pre>\n\n<p><code>id</code> is a number, yet here, you read it as a string. Change the code to</p>\n\n<pre><code>printf(\"ID of the student: \");\nscanf(\"%d\", &amp;student.id);\n</code></pre>\n"}], "owner": {"reputation": 175, "user_id": 6906311, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/d14582c9b363d020ec12f6a14a106516?s=128&d=identicon&r=PG&f=1", "display_name": "Konstantinos Kosyfarinis", "link": "https://stackoverflow.com/users/6906311/konstantinos-kosyfarinis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 47998609, "answer_count": 1, "score": 1, "last_activity_date": 1514408502, "creation_date": 1514407520, "last_edit_date": 1514408308, "question_id": 47998435, "link": "https://stackoverflow.com/questions/47998435/c-pointer-inside-struct-error", "title": "C - Pointer inside Struct Error (?)", "body": "<p>I am trying to create a small program in C that will be reading a file, and it will be displaying, adding and removing data from that file. </p>\n\n<p>So, basically, I have a predefined file (it's supposed to work with any file of course) that is this one: <a href=\"https://hastebin.com/oficewuveh.pas\" rel=\"nofollow noreferrer\">https://hastebin.com/oficewuveh.pas</a></p>\n\n<p>When I try to use the getStudentByID() method, it works fine until I add another user to the file. I have stripped down the code to as little as I could, but it's still rather big, sorry about that. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\ntypedef struct Lesson {\n    char *name;\n    int semester;\n    float grade;\n} Lesson;\n\ntypedef struct Student {\n    char *name;\n    char *surname;\n    int id;\n    int numberOfLessons;\n    Lesson *lesson;\n} Student;\n\ntypedef struct Database {\n    int numberOfStudents;\n    Student *student;\n} StudentDB;\n\nstatic int maxNameSize = 100;\nstatic int autoclear = 0;\nstatic int enableTimeout = 0;\n\n\nvoid main() {\n\n    system(\"color 02\");\n    system(\"@echo off\");\n\n    FILE *studentFile;\n    StudentDB database;\n    //add = { 0, NULL} ?\n\n    studentFile = fopen(\"students.txt\", \"r+w\");\n\n    int numberOfStudents;\n\n    //Set the number of students\n    fscanf(studentFile, \"%d\", &amp;database.numberOfStudents);\n\n    //Prints the number of students\n    printf(\"Number of students: %d\\n\", database.numberOfStudents);\n\n    //Set the memory allocation\n    database.student = malloc(database.numberOfStudents * sizeof(Student));\n    if(!database.student) {\n        printf(\"The memory allocation has failed. Exiting the program!\");\n        exit(0);\n    }   \n\n    //Read the students\n    readData(studentFile, &amp;database);   \n    run(studentFile, &amp;database);\n\n}\n\nLesson addLesson() {\n    Lesson lesson;\n\n    lesson.name = malloc(maxNameSize * sizeof(char));\n    if(!lesson.name) { printf(\"Memory Allocation has failed. Exiting the program!\"); exit(0); }\n\n    printf(\"\\tName of the lesson: \");\n    scanf(\"%s\", &amp;lesson.name);\n\n    printf(\"\\tSemester: \");\n    scanf(\"%d\", &amp;lesson.semester);\n\n    printf(\"\\tGrade: \");\n    scanf(\"%f\", &amp;lesson.grade);\n\n    return lesson;\n}\n\nvoid addStudent(StudentDB *database) {\n    database-&gt;numberOfStudents = database-&gt;numberOfStudents + 1;\n    printf(\"\\nAdded +1 to number of students, now is %d\\n\", database-&gt;numberOfStudents);\n    int numOfStudents = database-&gt;numberOfStudents;\n    database-&gt;student = realloc(database-&gt;student, (numOfStudents + 1) * sizeof(Student));\n\n    Student student;\n    student.name = malloc(maxNameSize * sizeof(char));\n    student.surname = malloc(maxNameSize * sizeof(char));\n\n    if(!student.name) { printf(\"Memory Allocation has failed. Exiting the program!\"); exit(0); }\n    if(!student.surname) { printf(\"Memory Allocation has failed. Exiting the program!\"); exit(0); }\n\n    printf(\"\\tAdding a new Student\\n\\n\");\n\n    printf(\"Name of the student: \");\n    scanf(\"%s\", student.name);\n\n    printf(\"Surname of the student: \");\n    scanf(\"%s\", student.surname);\n\n    printf(\"ID of the student: \");\n    scanf(\"%s\", &amp;student.id);\n\n    int numOfLessons;\n    printf(\"How many classes does that student take: \");\n    scanf(\"%d\", &amp;numOfLessons);\n\n    int i;\n    //Lesson lesson[numOfLessons];\n    for(i = 0; i &lt; numOfLessons; i++) {\n        printf(\"Adding lesson %d\\n\", i);\n        student.lesson[i] = addLesson();\n    }\n    printf(\"%d\", numOfStudents);\n\n//  displayStudent(student);\n\n    database-&gt;student[numOfStudents - 1] = student;\n\n}\n\nvoid displayStudent(Student student) {\n    printf(\"Displaying all the info for the student with ID: %d\\n\", student.id);\n\n    printf(\"\\tID: \\t\\t %d  \\n\", student.id);\n    printf(\"\\tFull Name:\\t %s %s \\n\", student.name, student.surname);\n    printf(\"\\tLessons :\\t %d \\n\", student.numberOfLessons);\n    printf(\"\\t  \\n\");\n    printf(\"\\t\\tDisplaying Lessons\\n\");\n\n    int i;\n    for(i = 0; i &lt; student.numberOfLessons; i++) {\n        displayLesson(student.lesson[i]);\n    }\n\n    system(\"PAUSE\");\n}\n\nStudent getStudentByID(StudentDB *database) {\n    printf(\"Give us the ID of the student: \");\n    int id;\n    scanf(\"%d\", &amp;id);\n\n    printf(\"Done saving the id: %d\\n\", id);\n\n    int i;\n    for(i = 0; i &lt; database-&gt;numberOfStudents; i++) {\n        printf(\"Comparing %d and %d\\n\", id, database-&gt;student[i].id);\n        if(id == database-&gt;student[i].id) {\n            printf(\"ID found, returning student\\n\");\n            return database-&gt;student[i];\n        }\n    }\n    Student student;\n    student.name = malloc(4 * sizeof(char));\n    student.name = \"NULL\";\n    printf(\"ID not found, returning NULL\\n\");\n    return student;\n}\n\n//Successfully gets the lessons. Everything is fine here\nLesson getNextLesson(FILE *studentFile) {\n    //Code to read the lesson..\n    return lesson;\n}\n\n//Successfully gets a student and the lessons. Everything is fine here\nStudent getNextStudent(FILE *studentFile) {\n    //Code to read the student..\n    return student;\n}\n\nvoid run(FILE *studentFile, StudentDB *database) {\n    int answer;\n    //Menu and more code...\n    addStudent(database);\n}\n\nvoid readData(FILE *studentFile, StudentDB *db) {\n    int i;\n\n    printf(\"Running the loop\\n\");\n    for(i = 0; i &lt; db-&gt;numberOfStudents; i++) {\n        printf(\"=====================\\n\\n\\tStudent #%d\\n\", i);\n        db-&gt;student[i] = getNextStudent(studentFile);\n        printf(\"\\n\\tCompleted\\n\\n=====================\\n\");\n    }\n}\n\nvoid swapStudents(Student *student1, Student *student2) {\n    Student temp;\n    temp = *student1;\n    *student1 = *student2;\n    *student2 = temp;\n}\n</code></pre>\n\n<p>It is probably an error with a pointer somewhere, still rather new to pointers and C in general.</p>\n\n<p>So, when I add a new student it returns this: <a href=\"https://hastebin.com/uwequfiket.coffeescript\" rel=\"nofollow noreferrer\">https://hastebin.com/uwequfiket.coffeescript</a> (look towards the end of the file)</p>\n\n<p>I've been trying to figure out what I've done wrong, but I was not able to figure it out, thus I came here. Here's the full code if anyone is interested: <a href=\"https://hastebin.com/yolagekire.cpp\" rel=\"nofollow noreferrer\">https://hastebin.com/yolagekire.cpp</a></p>\n\n<p>Thanks in advance for any help!  </p>\n"}, {"tags": ["c", "x86", "inline-assembly", "att"], "comments": [{"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 1, "creation_date": 1514407684, "post_id": 47998177, "comment_id": 82965259, "body": "Where do you define <code>byte</code>?"}, {"owner": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 0, "creation_date": 1514408562, "post_id": 47998177, "comment_id": 82965552, "body": "With AT&amp;T syntax src and destination are reversed. Maybe you meant <code>&quot;rol $1, %0&quot;</code>"}, {"owner": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "edited": false, "score": 1, "creation_date": 1514408846, "post_id": 47998177, "comment_id": 82965637, "body": "<a href=\"https://godbolt.org/g/z6Qof7\" rel=\"nofollow noreferrer\">godbolt.org/g/z6Qof7</a> there&#39;s no need of inline assembly for this (at least for gcc and clang)"}], "answers": [{"comments": [{"owner": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "edited": false, "score": 0, "creation_date": 1514409268, "post_id": 47998628, "comment_id": 82965776, "body": "As said above, gcc <a href=\"https://godbolt.org/g/z6Qof7\" rel=\"nofollow noreferrer\">does seem to recognize the naive rotate by one</a>, so it doesn&#39;t even seem necessary to use any intrinsic; it&#39;s curious however that both VC++ and icc fail to recognize it."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "edited": false, "score": 0, "creation_date": 1514409379, "post_id": 47998628, "comment_id": 82965819, "body": "@MatteoItalia: It recognizes it, but it&#39;s hard to get it to emit just <code>rolb</code> without an <code>and</code> to mask a runtime-variable count.  And perhaps the builtins were added before the idiom recognizer could handle byte and 16-bit rotates; I didn&#39;t check old gcc versions."}, {"owner": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "edited": false, "score": 0, "creation_date": 1514409380, "post_id": 47998628, "comment_id": 82965820, "body": "Update: VC++ <a href=\"https://godbolt.org/g/fSn6YK\" rel=\"nofollow noreferrer\">does recognize it</a> if I add liberally some casts to <code>uint8_t</code> (even just one on the left shift seems to work fine)."}, {"owner": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "edited": false, "score": 0, "creation_date": 1514409431, "post_id": 47998628, "comment_id": 82965841, "body": "Uh yes, a runtime-known shift is more tricky; I was just testing the &quot;rotate by fixed one&quot; because that&#39;s what OP wrote in his question."}, {"owner": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "edited": false, "score": 0, "creation_date": 1514409537, "post_id": 47998628, "comment_id": 82965880, "body": "Still, 7.2 handles it just fine <a href=\"https://godbolt.org/g/9ZpN1d\" rel=\"nofollow noreferrer\">godbolt.org/g/9ZpN1d</a> - no <code>and</code> in sight. From a quick binary search, it seems it started to handle it smartly from 4.9.0; 4.8.5 still generated horrible code for that."}], "tags": [], "owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "is_accepted": true, "score": 3, "last_activity_date": 1514408611, "creation_date": 1514408611, "answer_id": 47998628, "question_id": 47998177, "link": "https://stackoverflow.com/questions/47998177/inline-assembly-size-mismatch-for-8-bit-rotate/47998628#47998628", "title": "Inline assembly size mismatch for 8-bit rotate", "body": "<p>AT&amp;T syntax uses the opposite order from Intel syntax.  The rotate count has to be first, not last:  <code>rol $1, %0</code>.</p>\n\n<hr>\n\n<p>Also, you don't need and shouldn't use inline asm for this: <a href=\"https://gcc.gnu.org/wiki/DontUseInlineAsm\" rel=\"nofollow noreferrer\">https://gcc.gnu.org/wiki/DontUseInlineAsm</a></p>\n\n<p>As described in <a href=\"https://stackoverflow.com/questions/776508/best-practices-for-circular-shift-rotate-operations-in-c\">Best practices for circular shift (rotate) operations in C++</a>, GNU C has intrinsics for narrow rotates, because the rotate-idiom recognition code fails to optimize away an <code>and</code> of the rotate count.  x86 shifts/rotates mask the count with <code>count &amp; 31</code> even for 8-bit and 16-bit, but rotates still wrap around.  It does matter for shifts though.</p>\n\n<p>Anyway, gcc has a builtin function for narrow rotates to avoid any overhead.  There's a <code>__rolb</code> wrapper for it in <code>x86intrin.h</code>, but MSVC uses its own <code>__rotr8</code> and so on from its <code>intrin.h</code>.  Anyway, clang doesn't support either the <code>__builtin</code> or the <code>x86intrin.h</code> wrappers for rotates, but gcc and ICC do.</p>\n\n<pre><code>#include &lt;stdint.h&gt;\nuint8_t rotate_left_byte_by1(uint8_t a) {\n    return __builtin_ia32_rolqi(a, 1);  // qi = quarter-integer\n}\n</code></pre>\n\n<p>I used <code>uint8_t</code> from <code>stdint.h</code> like a normal person instead of defining a <code>byte</code> type.</p>\n\n<p>This doesn't compile at all with clang, but <a href=\"https://gcc.godbolt.org/#g:!((g:!((g:!((h:codeEditor,i:(j:1,source:&#39;%23include+%3Cstdint.h%3E%0A%0Auint8_t+rotate_left_byte_by1(uint8_t+a)+%7B%0A++++return+__builtin_ia32_rolqi(a,+1)%3B++//+qi+%3D+quarter-integer%0A%7D%0A&#39;),l:&#39;5&#39;,n:&#39;0&#39;,o:&#39;C%2B%2B+source+%231&#39;,t:&#39;0&#39;)),k:31.30235729592831,l:&#39;4&#39;,m:100,n:&#39;0&#39;,o:&#39;&#39;,s:0,t:&#39;0&#39;),(g:!((h:compiler,i:(compiler:g72,filters:(b:&#39;0&#39;,binary:&#39;1&#39;,commentOnly:&#39;0&#39;,demangle:&#39;0&#39;,directives:&#39;0&#39;,execute:&#39;1&#39;,intel:&#39;1&#39;,trim:&#39;1&#39;),libs:!(),options:&#39;-xc+-Wall+-O3&#39;,source:1),l:&#39;5&#39;,n:&#39;0&#39;,o:&#39;x86-64+gcc+7.2+(Editor+%231,+Compiler+%232)&#39;,t:&#39;0&#39;)),header:(),k:35.36430937073837,l:&#39;4&#39;,m:100,n:&#39;0&#39;,o:&#39;&#39;,s:0,t:&#39;0&#39;),(g:!((h:compiler,i:(compiler:clang401,filters:(b:&#39;0&#39;,binary:&#39;1&#39;,commentOnly:&#39;0&#39;,demangle:&#39;0&#39;,directives:&#39;0&#39;,execute:&#39;1&#39;,intel:&#39;1&#39;,trim:&#39;1&#39;),libs:!(),options:&#39;-xc+-Wall+-O3&#39;,source:1),l:&#39;5&#39;,n:&#39;0&#39;,o:&#39;x86-64+clang+4.0.1+(Editor+%231,+Compiler+%231)&#39;,t:&#39;0&#39;)),k:33.33333333333333,l:&#39;4&#39;,n:&#39;0&#39;,o:&#39;&#39;,s:0,t:&#39;0&#39;)),l:&#39;2&#39;,n:&#39;0&#39;,o:&#39;&#39;,t:&#39;0&#39;)),version:4\" rel=\"nofollow noreferrer\">it compiles as you'd hope with gcc7.2</a>:</p>\n\n<pre><code>rotate_left_byte_by1:\n    movl    %edi, %eax\n    rolb    %al\n    ret\n</code></pre>\n\n<p>This gives you a function that compiles as efficiently as your inline asm ever could, but which can optimize away completely for compile-time constants, and the compiler knows how it works / what it does and can optimize accordingly.</p>\n"}], "owner": {"reputation": 103, "user_id": 7907202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eae919e524a3a99f832ea35cb2ff77fc?s=128&d=identicon&r=PG&f=1", "display_name": "Noam", "link": "https://stackoverflow.com/users/7907202/noam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 213, "favorite_count": 0, "accepted_answer_id": 47998628, "answer_count": 1, "score": 0, "last_activity_date": 1514408653, "creation_date": 1514406050, "last_edit_date": 1514408653, "question_id": 47998177, "link": "https://stackoverflow.com/questions/47998177/inline-assembly-size-mismatch-for-8-bit-rotate", "title": "Inline assembly size mismatch for 8-bit rotate", "body": "<p>I am trying to write the rotate left operation in C using inline assembly, like so:</p>\n\n<pre><code>byte rotate_left(byte a) {\n    __asm__(\"rol %0, $1\": \"=a\" (a) : \"a\" (a));\n    return a;\n}\n</code></pre>\n\n<p>(Where byte is typedefed as unsigned char).</p>\n\n<p>This raises the error</p>\n\n<blockquote>\n  <p>/tmp/ccKYcEHR.s:363: Error: operand size mismatch for `rol'.</p>\n</blockquote>\n\n<p>What is the problem here?</p>\n"}, {"tags": ["c", "ubuntu", "fifo"], "comments": [{"owner": {"reputation": 79096, "user_id": 865874, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ACMnN.png?s=128&g=1", "display_name": "rodrigo", "link": "https://stackoverflow.com/users/865874/rodrigo"}, "edited": false, "score": 1, "creation_date": 1514405700, "post_id": 47998055, "comment_id": 82964533, "body": "A couple of issues... why are you creating the fifo <code>mkfifo()</code> after opening it? And you are not checking the number of bytes read from each of the fds..."}], "answers": [{"tags": [], "owner": {"reputation": 18942, "user_id": 894328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3db17c5296335f63e856be44aa821bf6?s=128&d=identicon&r=PG", "display_name": "Ahmed Masud", "link": "https://stackoverflow.com/users/894328/ahmed-masud"}, "is_accepted": false, "score": 0, "last_activity_date": 1514409456, "creation_date": 1514409456, "answer_id": 47998738, "question_id": 47998055, "link": "https://stackoverflow.com/questions/47998055/fifo-with-dev-urandom/47998738#47998738", "title": "FIFO with /dev/urandom", "body": "<p>As rodrigo points out, your instructions <code>mkfifo</code> and <code>open(\"FIFO\"...)</code> are backwards, also if you are going to use a temporary fifo, you can simply use <code>pipe(2)</code> call rather than creating and deleting a fifo.</p>\n"}], "owner": {"reputation": 37, "user_id": 9128892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62aa8c2ddd3dc1bd9660e033c0219db7?s=128&d=identicon&r=PG&f=1", "display_name": "DrJoe", "link": "https://stackoverflow.com/users/9128892/drjoe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1514409456, "creation_date": 1514405350, "question_id": 47998055, "link": "https://stackoverflow.com/questions/47998055/fifo-with-dev-urandom", "title": "FIFO with /dev/urandom", "body": "<p>I got a problem. Trying to write a simple programm which forks once</p>\n\n<p>The parent proccess sends child bytes from /dev/urandom and child outputs them to screen (15 bytes in HEX per line). The problem is: when i first open the compiled programm the output looks like:</p>\n\n<p>B0 B0 B0 B0 B0 B0 B0 B0 B0 B0 B0 B0 B0 B0 B0\nB0 B0 B0 B0 B0 B0 B0 B0 B0 B0 B0 B0 B0 B0 B0\nB0 B0 B0 B0 B0 B0 B0 B0 B0 B0 B0 B0 B0 B0 B0\nB0 B0 B0 B0 B0 B0 B0 B0 B0 B0 B0 B0 B0 B0 B0\nB0 B0 B0 B0 B0 B0 B0 B0 B0 B0 B0 B0 B0 B0 B0\n...\nB0 B0 B0 B0 B0 B0 B0 B0 B0 B0 B0 B0 B0 B0 B0</p>\n\n<p>(not always \"B0\", but surely the same ONE byte)\nWhen I run the same program (not re-compiled) once again the output seems to be OK... Any ideas ?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/stat.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;termios.h&gt;\n\n\n\n\n\nint main(int argc, char *argv[])\n{\n\n        char bufforek[256];\n\n        printf(\"P1: READING /dev/urandom\\n\");\n\n        FILE *file_ptr = fopen(\"/dev/urandom\", \"r\");\n\n\n        int file=open(\"FIFO\",O_RDWR);\n        mkfifo(\"FIFO\",0666);\n        char pomoc;\n        int hexa;\n        int i=1;\n\n\n        if(fork()==0)\n        {\n\n            char bufforek1[256];\n            while(read(file,bufforek1,sizeof(bufforek1)))\n            {\n\n                pomoc = *bufforek1;\n                // printf(\"%hhX \", pom);\n\n                hexa = (int)pomoc;\n                pomoc = *bufforek1;\n                printf(\"%hhX \", pomoc);\n                if(i==15)\n                {\n                    printf(\"\\n\");\n                    i=1;\n                }\n                else i++;\n                // write(pipe_table[1],bufforek,sizeof(bufforek));\n\n            }\n            return 0;\n        }\n        while ((fgets(bufforek, sizeof(bufforek), file_ptr))!=NULL) write(file, bufforek, sizeof(bufforek));\n\n        unlink(\"FIFO\");\n\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 1178, "user_id": 1406668, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/T4b1f.jpg?s=128&g=1", "display_name": "Dave M.", "link": "https://stackoverflow.com/users/1406668/dave-m"}, "edited": false, "score": 0, "creation_date": 1514405371, "post_id": 47998026, "comment_id": 82964425, "body": "Add a hexdump of the first few lines of <code>studenti.txt</code> -- try <code>hexdump -C studenti.txt | head</code>.  That may show you the answer immediately, but in any case will be helpful to other people answering."}, {"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 1, "creation_date": 1514405446, "post_id": 47998026, "comment_id": 82964451, "body": "What does the data look like?  Perhaps you have a student with more or fewer than 2 name components?  You also aren&#39;t setting the sum (<code>somma</code>) back to zero.  And you never want to control a loop with <code>feof</code>, instead check the return value from <code>fscanf</code>, and when it processed fewer fields than requested, then <code>feof</code> will tell you if the reason is reaching the end of file."}, {"owner": {"reputation": 83, "user_id": 8868593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fed64ae28528b532f6846f3940d40145?s=128&d=identicon&r=PG&f=1", "display_name": "Teorema", "link": "https://stackoverflow.com/users/8868593/teorema"}, "edited": false, "score": 0, "creation_date": 1514405543, "post_id": 47998026, "comment_id": 82964483, "body": "Edit: the data looks like: (matricola) (nome) (cognome) (n.esami)&lt;eol&gt; n.esami-rows: (codice esame) (voto) ..."}, {"owner": {"reputation": 83, "user_id": 8868593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fed64ae28528b532f6846f3940d40145?s=128&d=identicon&r=PG&f=1", "display_name": "Teorema", "link": "https://stackoverflow.com/users/8868593/teorema"}, "edited": false, "score": 0, "creation_date": 1514405835, "post_id": 47998026, "comment_id": 82964573, "body": "the data does not have parenthesis. I wrote them for you to let you understand that is a &quot;campo&quot; to fill"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1514406054, "post_id": 47998026, "comment_id": 82964649, "body": "Please edit the question with the additional information."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 3, "creation_date": 1514406180, "post_id": 47998026, "comment_id": 82964696, "body": "<a href=\"https://stackoverflow.com/questions/5431941/while-feof-file-is-always-wrong\">why <code>while (!feof(cfPtr))</code> is wrong</a>"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1514406271, "post_id": 47998026, "comment_id": 82964733, "body": "Is that really the correct data? There are no numbers."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 2, "creation_date": 1514406780, "post_id": 47998026, "comment_id": 82964915, "body": "Always check that the value returned by <code>fscanf</code> is correct! Besides that you need to show us an example of studenti.txt where it fails"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1514406885, "post_id": 47998026, "comment_id": 82964962, "body": "<code>codice esame voto</code> Hmm... is that two or three values?"}], "answers": [{"tags": [], "owner": {"reputation": 6975, "user_id": 3121023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f52448806175b9aa66c86d40cf0829f1?s=128&d=identicon&r=PG&f=1", "display_name": "user3121023", "link": "https://stackoverflow.com/users/3121023/user3121023"}, "is_accepted": false, "score": 1, "last_activity_date": 1514408346, "last_edit_date": 1514408346, "creation_date": 1514407691, "answer_id": 47998470, "question_id": 47998026, "link": "https://stackoverflow.com/questions/47998026/i-am-unsure-how-to-use-fscanf-properly/47998470#47998470", "title": "I am unsure how to use fscanf properly", "body": "<p>Not clear but it seems the file contains a mix of line that have either four or two items.<br>\nConsider reading each line. Parse the line into up to four strings using sscanf. As needed use <code>sscanf</code> to capture the integers from the line. If there are two items, process them if <code>trovato</code> flag indicates a match has been found. If there are four items, see if there is a match and set <code>trovato</code>.</p>\n\n<pre><code>int main ()\n{\n    FILE *cfPtr;\n    int matricola_in, matricola, nEsami, codEsame, voto;\n    char nome[20], cognome[20];\n    char temp[4][20];\n    char line[200];\n    int result;\n    int i, j, trovato = 0;\n    float somma = 0.0;\n\n    printf(\"Inserisci una matricola:\\n\");\n    scanf(\"%d\", &amp;matricola_in);\n\n    if( (cfPtr = fopen(\"studenti.txt\", \"r\")) == NULL ) {\n        printf(\"Errore\");\n        return 0;\n    }\n\n    while( fgets ( line, sizeof line, cfPtr)){//read a line until end of file\n        result = sscanf ( line, \"%19s%19s%19s%19s\", temp[0], temp[1], temp[2], temp[3]);//scan up to four strings\n        if ( result == 2) {//the line has two items\n            if ( trovato) {// match was found\n                sscanf ( temp[0], \"%d\", &amp;codEsame);\n                sscanf ( temp[1], \"%d\", &amp;voto);\n                somma += voto;\n            }\n        }\n        if ( result == 4) {//the line has four items\n            if ( trovato) {\n                break;//there was a match so break\n            }\n            sscanf ( temp[0], \"%d\", &amp;matricola);\n            sscanf ( temp[3], \"%d\", &amp;nEsami);\n            if( matricola_in == matricola ){//see if there is a match\n                trovato = 1;//set the flag\n            }\n        }\n    }\n    printf(\"Media: %.1f\\n\", somma/nEsami);//print results\n\n    fclose(cfPtr);\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 83, "user_id": 8868593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fed64ae28528b532f6846f3940d40145?s=128&d=identicon&r=PG&f=1", "display_name": "Teorema", "link": "https://stackoverflow.com/users/8868593/teorema"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1514408346, "creation_date": 1514405193, "last_edit_date": 1514406711, "question_id": 47998026, "link": "https://stackoverflow.com/questions/47998026/i-am-unsure-how-to-use-fscanf-properly", "title": "I am unsure how to use fscanf properly", "body": "<p>This program should get in input a number and calculate the average value between a student's marks. This program works only with the former student, but not with the following ones. I think there's a mistake with that  fscanf. Can anybody help? </p>\n\n<pre><code>int main ()\n{\n    FILE *cfPtr;\n    int matricola_in, matricola, nEsami, codEsame, voto;\n    char nome[20], cognome[20];\n    int i, j, trovato = 0;\n    float somma = 0.0;\n\n    printf(\"Inserisci una matricola:\\n\");\n    scanf(\"%d\", &amp;matricola_in);\n\n    if( (cfPtr = fopen(\"studenti.txt\", \"r\")) == NULL )\n        printf(\"Errore\");\n\n    while( !feof(cfPtr) || trovato != 1 ){\n        fscanf(cfPtr, \"%d%s%s%d\\n\", &amp;matricola, nome, cognome, &amp;nEsami);\n        if( matricola_in == matricola ){\n            trovato = 1;\n            for( i = 0; i &lt; nEsami; i++ ){\n                fscanf(cfPtr, \"%d%d\\n\", &amp;codEsame, &amp;voto);\n                somma += voto;\n            }\n            printf(\"Media: %.1f\\n\", somma/nEsami);\n        }\n    }\n\n    fclose(cfPtr);\n\n    return 0;\n}\n</code></pre>\n\n<hr>\n\n<p>Edit: the data looks like:</p>\n\n<pre><code>matricola nome cognome n.esami`&lt;eol&gt;`\n(for n.esami-rows)codice esame voto`&lt;eol&gt;`\n...\n</code></pre>\n"}, {"tags": ["javascript", "c", "node.js", "architecture"], "comments": [{"owner": {"reputation": 11238, "user_id": 7594711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7872c871b0431b72df6350dd0394bea?s=128&d=identicon&r=PG&f=1", "display_name": "SoronelHaetir", "link": "https://stackoverflow.com/users/7594711/soronelhaetir"}, "edited": false, "score": 0, "creation_date": 1514403754, "post_id": 47997706, "comment_id": 82963762, "body": "What does this have to do with C?"}, {"owner": {"reputation": 6361, "user_id": 1333329, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b01d2e1bf9d99a4d8fee15badaa1b41?s=128&d=identicon&r=PG&f=1", "display_name": "Gntem", "link": "https://stackoverflow.com/users/1333329/gntem"}, "edited": false, "score": 1, "creation_date": 1514404825, "post_id": 47997706, "comment_id": 82964197, "body": "I don&#39;t believe you gonna get an nice answer for this, as from my point of view its way to low level and there are tons of documentation/tutorials/books explaining the internals and creating modules mostly in C++ i don&#39;t think anyone uses C to accomplish this anyways."}, {"owner": {"reputation": 43, "user_id": 1763735, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qi165.jpg?s=128&g=1", "display_name": "Nick Staggs", "link": "https://stackoverflow.com/users/1763735/nick-staggs"}, "reply_to_user": {"reputation": 6361, "user_id": 1333329, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b01d2e1bf9d99a4d8fee15badaa1b41?s=128&d=identicon&r=PG&f=1", "display_name": "Gntem", "link": "https://stackoverflow.com/users/1333329/gntem"}, "edited": false, "score": 0, "creation_date": 1514414555, "post_id": 47997706, "comment_id": 82967425, "body": "@Gntem I don&#39;t think I have seen any tutorials/documentation explaining what happens to the javascript in a nodejs application after it has been compiled into machine language by v8 but before it enters the event loop, I have looked for several hours, is there a particular tutorial/documentation you have in mind?"}, {"owner": {"reputation": 6361, "user_id": 1333329, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b01d2e1bf9d99a4d8fee15badaa1b41?s=128&d=identicon&r=PG&f=1", "display_name": "Gntem", "link": "https://stackoverflow.com/users/1333329/gntem"}, "edited": false, "score": 0, "creation_date": 1514481615, "post_id": 47997706, "comment_id": 82991810, "body": "@NickStaggs <a href=\"https://medium.com/@vardanator/node-js-v8-internals-an-illustrative-primer-83766e983bf6\" rel=\"nofollow noreferrer\">medium.com/@vardanator/&hellip;</a> , <a href=\"https://github.com/v8/v8/wiki\" rel=\"nofollow noreferrer\">github.com/v8/v8/wiki</a> , <a href=\"https://github.com/nodejs/node-addon-examples\" rel=\"nofollow noreferrer\">github.com/nodejs/node-addon-examples</a> , this is so v8 internals.."}], "owner": {"reputation": 43, "user_id": 1763735, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qi165.jpg?s=128&g=1", "display_name": "Nick Staggs", "link": "https://stackoverflow.com/users/1763735/nick-staggs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 402, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1514403459, "creation_date": 1514403459, "question_id": 47997706, "link": "https://stackoverflow.com/questions/47997706/how-do-the-node-js-bindings-work", "title": "How do the Node.js bindings work?", "body": "<p>I am trying to sure up my understanding of how exactly Node.js goes from JavaScript to an executed command on a machine. I have seen this workflow diagram: </p>\n\n<p><a href=\"https://i.stack.imgur.com/QRePV.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/QRePV.jpg\" alt=\"Node.js workflow\"></a></p>\n\n<p>My understanding is that first javascript get compiled into machine language via the V8 javascript engine. After that I am not exactly sure how the Node.js bindings work. Do they decompile the machine language into C that is entered into the Libuv event loop? Also if a certain line of javascript does not contain a I/O event is it just executed after being compiled by the V8 engine, bypassing the bindings and Libuv?</p>\n"}, {"tags": ["c", "windows", "visual-studio-2010", "winsock2"], "comments": [{"owner": {"reputation": 28355, "user_id": 4788546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2jWn.jpg?s=128&g=1", "display_name": "CristiFati", "link": "https://stackoverflow.com/users/4788546/cristifati"}, "edited": false, "score": 0, "creation_date": 1514404434, "post_id": 47997534, "comment_id": 82964022, "body": "The <i>UDP</i> packets vanish: that means that they are being sent by source, but they never arrive to destination. This is OK from <i>UDP</i>&#39;s <i>PoV</i>. If you&#39;re tweaking <code>recvfrom</code> (note: this function is perfectly fine, I have a feeling that <code>WSARecvFrom</code> is just a wrapper over it) you are doing it on the destination side as well, and if the packet didn&#39;t reach it there&#39;s a low chance you could find out smth new. Also: how do you call <code>Myrecvfrom</code>? what arguments (still 0 for <code>from</code> and <code>fromLen</code>)?"}, {"owner": {"reputation": 4522, "user_id": 5157478, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bBcym.png?s=128&g=1", "display_name": "Frankie_C", "link": "https://stackoverflow.com/users/5157478/frankie-c"}, "edited": false, "score": 0, "creation_date": 1514404933, "post_id": 47997534, "comment_id": 82964236, "body": "The full description for error <b>10014</b> is &quot;<b>The system detected an invalid pointer address in attempting to use a pointer argument in a call.</b>&quot; This seems more related to a memory violation due to process memory mapping problems with injected code than winsock code."}, {"owner": {"reputation": 946, "user_id": 4223401, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-3WX0FD-u_Jo/AAAAAAAAAAI/AAAAAAAAGjI/MQ0rBJdnvQk/photo.jpg?sz=128", "display_name": "Brian Cowan", "link": "https://stackoverflow.com/users/4223401/brian-cowan"}, "edited": false, "score": 0, "creation_date": 1514411871, "post_id": 47997534, "comment_id": 82966696, "body": "@christifati -- I&#39;m injecting this DLL and overriding the winsock2 recvfrom. And my objective is to eventually show that the packet sent by process1 never makes it to process 2, (or vice versa)."}, {"owner": {"reputation": 946, "user_id": 4223401, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-3WX0FD-u_Jo/AAAAAAAAAAI/AAAAAAAAGjI/MQ0rBJdnvQk/photo.jpg?sz=128", "display_name": "Brian Cowan", "link": "https://stackoverflow.com/users/4223401/brian-cowan"}, "reply_to_user": {"reputation": 4522, "user_id": 5157478, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bBcym.png?s=128&g=1", "display_name": "Frankie_C", "link": "https://stackoverflow.com/users/5157478/frankie-c"}, "edited": false, "score": 0, "creation_date": 1514412121, "post_id": 47997534, "comment_id": 82966770, "body": "@Frankie_C in theory, wouldn&#39;t the heap be the same in the injected DLL? If not, any ideas on how to get the address data? I guess I could do completely parallel read on the socket using MSG_PEEK..."}, {"owner": {"reputation": 28355, "user_id": 4788546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2jWn.jpg?s=128&g=1", "display_name": "CristiFati", "link": "https://stackoverflow.com/users/4788546/cristifati"}, "edited": false, "score": 0, "creation_date": 1514412702, "post_id": 47997534, "comment_id": 82966921, "body": "I am aware of the <i>dll</i> injection purpose, But that was kind of my point. If you send some msg from source, but <code>recvfrom</code> doesn&#39;t capture it on destination (meaning that it was discarded somewhere in between), all the code that you run on destination (e.g. <code>Myrecvfrom</code>) is  useless, since it won&#39;t be executed. Now, how does the original code call <code>recvfrom</code>? Do you have a snippet? Also any chance that the sender is an <i>IPv6</i>?"}, {"owner": {"reputation": 946, "user_id": 4223401, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-3WX0FD-u_Jo/AAAAAAAAAAI/AAAAAAAAGjI/MQ0rBJdnvQk/photo.jpg?sz=128", "display_name": "Brian Cowan", "link": "https://stackoverflow.com/users/4223401/brian-cowan"}, "edited": false, "score": 0, "creation_date": 1514413379, "post_id": 47997534, "comment_id": 82967110, "body": "And I just thought of something... What if my allocation of the from? buffer died... Nope. Pass a pointer to get the address, it dies with that error. If I pass NULLS, and peek the buffer, I get the contents. I guess I&#39;ll have to go with that. Luckily these are SunRPC formatted packets with RPC ID&#39;s and program/call numbers. So, I&#39;ll be able to get the data out that way if nothing else. Not exactly the way I WANT to do it, since I wanted the addresses too, but if that&#39;s how i HAVE to do it. So be it."}, {"owner": {"reputation": 946, "user_id": 4223401, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-3WX0FD-u_Jo/AAAAAAAAAAI/AAAAAAAAGjI/MQ0rBJdnvQk/photo.jpg?sz=128", "display_name": "Brian Cowan", "link": "https://stackoverflow.com/users/4223401/brian-cowan"}, "edited": false, "score": 0, "creation_date": 1514413612, "post_id": 47997534, "comment_id": 82967190, "body": "@christifati -- I can&#39;t really speak to how it&#39;s called without delving deep into a 3rd party library. I plan on putting similar debugging code in send/sendto and recv/rcvfrom so I can say &quot;here is the datagram that was sent at 3 second intervals w/o response, and we see in this other debug output that it did/didn&#39;t make it to the target process and the response did/didn&#39;t get sent and was/wasn&#39;t received...&quot; Since the missing packets are the start of the UDP &quot;handshake&quot; between the processes, I can filter based on the RPC info. I was just hoping to be able to filter on the address to."}, {"owner": {"reputation": 28355, "user_id": 4788546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2jWn.jpg?s=128&g=1", "display_name": "CristiFati", "link": "https://stackoverflow.com/users/4788546/cristifati"}, "edited": false, "score": 0, "creation_date": 1514413638, "post_id": 47997534, "comment_id": 82967197, "body": "This is where I was aiming. Check <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms740120(v=vs.85).aspx\" rel=\"nofollow noreferrer\">&#91;MSDN&#93;: recvfrom function</a>: the reason why it yields <code>WSAEFAULT</code>: &quot;<i>The buffer pointed to by the buf or from parameters are not in the user address space, or the fromlen parameter is too small to accommodate the source address of the peer address.</i>&quot;"}, {"owner": {"reputation": 946, "user_id": 4223401, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-3WX0FD-u_Jo/AAAAAAAAAAI/AAAAAAAAGjI/MQ0rBJdnvQk/photo.jpg?sz=128", "display_name": "Brian Cowan", "link": "https://stackoverflow.com/users/4223401/brian-cowan"}, "edited": false, "score": 0, "creation_date": 1514413759, "post_id": 47997534, "comment_id": 82967236, "body": "Well, since my allocated buf worked for my peek, I can try sending a random 1KB buffer with that as the &quot;addrlen&quot; parameter and see what happens. It&#39;s SUPPOSED TO be a struct sockaddr *, but if it wants more space, I can certainly give it to it."}, {"owner": {"reputation": 946, "user_id": 4223401, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-3WX0FD-u_Jo/AAAAAAAAAAI/AAAAAAAAGjI/MQ0rBJdnvQk/photo.jpg?sz=128", "display_name": "Brian Cowan", "link": "https://stackoverflow.com/users/4223401/brian-cowan"}, "edited": false, "score": 0, "creation_date": 1514414286, "post_id": 47997534, "comment_id": 82967372, "body": "OK, now I really am learning to hate WINSOCK.... The pointer is SUPPOSED TO BE to a struct sockaddr (size 16 bytes), It turns out to be a pointer to a 28 byte struct instead... Now I get to go spelunking in the header file to see what this alternate struct is supposed to be, or if I am somehow loading the wrong header file."}, {"owner": {"reputation": 28355, "user_id": 4788546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2jWn.jpg?s=128&g=1", "display_name": "CristiFati", "link": "https://stackoverflow.com/users/4788546/cristifati"}, "edited": false, "score": 0, "creation_date": 1514414613, "post_id": 47997534, "comment_id": 82967437, "body": "Shit! I don&#39;t know how to take this to chat without spamming the question with too many comments (when move to chat option automatically appears). I think I now know what you&#39;re on now, I thought that you control the source code of the 2 apps, but apparently you don&#39;t. Note that the 28 bytes might be the  <i>IPv6</i> that I was talking about. <code>sockaddr</code>, and <code>sockaddr_in</code> structs both have 16 bytes. So far, *VStudio2010` doesn&#39;t seem to like <code>sockaddr_in6</code> :) (most likely, I have to (un)define smth to make things right)."}, {"owner": {"reputation": 946, "user_id": 4223401, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-3WX0FD-u_Jo/AAAAAAAAAAI/AAAAAAAAGjI/MQ0rBJdnvQk/photo.jpg?sz=128", "display_name": "Brian Cowan", "link": "https://stackoverflow.com/users/4223401/brian-cowan"}, "edited": false, "score": 0, "creation_date": 1514415488, "post_id": 47997534, "comment_id": 82967665, "body": "I do and dont&#39; control the source code of the 2 applications. I can&#39;t currently build the 2 apps because the build environment is currently dead in the water with no ETA for coming online. So, I have to hack it this way instead. I have the address info now that I&#39;m aware of the differences in length from the size defined in the header file. (Thanks a LOT MS!) And from here I can dig through until I get the ports and IP addresses."}], "answers": [{"tags": [], "owner": {"reputation": 946, "user_id": 4223401, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-3WX0FD-u_Jo/AAAAAAAAAAI/AAAAAAAAGjI/MQ0rBJdnvQk/photo.jpg?sz=128", "display_name": "Brian Cowan", "link": "https://stackoverflow.com/users/4223401/brian-cowan"}, "is_accepted": false, "score": 0, "last_activity_date": 1514585720, "creation_date": 1514585720, "answer_id": 48029001, "question_id": 47997534, "link": "https://stackoverflow.com/questions/47997534/intercepting-winsock-recvfrom-function-gives-invalid-address-error/48029001#48029001", "title": "Intercepting winsock recvfrom function gives invalid address error", "body": "<p>The cause of the issue is that the ACTUAL size of the reply was more than the size of \"struct sockaddr.\" It in fact was a SOCKADDR_IN6 structure coming back. Used an arbitrary buffer of 200 bytes instead of the 28-byte sockaddr structure and I was able to pull in the data.</p>\n\n<p>In the process, I wound up converting to \"peeking\" the received data instead of processing it after it was pulled in. When the PC with the source code finishes installing updates, I'll post it.</p>\n\n<p>Working from home is fairly isolating, and there isn't anyone who lives in winsock in my office anyway. It was really helpful to \"chat\" in the comments.</p>\n"}], "owner": {"reputation": 946, "user_id": 4223401, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-3WX0FD-u_Jo/AAAAAAAAAAI/AAAAAAAAGjI/MQ0rBJdnvQk/photo.jpg?sz=128", "display_name": "Brian Cowan", "link": "https://stackoverflow.com/users/4223401/brian-cowan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 131, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1514585720, "creation_date": 1514402374, "question_id": 47997534, "link": "https://stackoverflow.com/questions/47997534/intercepting-winsock-recvfrom-function-gives-invalid-address-error", "title": "Intercepting winsock recvfrom function gives invalid address error", "body": "<p>I'm trying to intercept winsock2 calls to troubleshoot a case where UDP packets between processes on the same host intermittently vanish. When they \"vanish\" they vanish for something like 20 seconds, which is enough to abort the process being run. </p>\n\n<p>I managed to get the DLL injection to work, and 2 winsock calls are intercepted correctly (I hope) because I can do a simple print, but I need to be able to process the address information so I can track who sends what to whom...</p>\n\n<p>Unfortunately, the upstream process I'm injecting into is apparently calling recvfrom (Yes, not the WSA... equivalent, this is old ported POSIX code) with NULL's for the \"from\" and \"fromlen\" parameters. If I don't fiddle with them at all the receive works. If I do the below, I get \"Invalid Address\" errors (Winsock error 10014).</p>\n\n<p>An I doing something stupid here? Not that I would be surprised.... And yes, it would be easier to rebuild the target application with the desired debugging, but the build environment is down due to a data center migration, and I need ammunition to say \"it's not the application.\"</p>\n\n<pre><code>// dllmain.cpp : Defines the entry point for the DLL application.\n#include \"stdafx.h\"\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include \"mhook.h\"\n#include &lt;winsock2.h&gt;\n\n// typedefs for function pointers...\n\ntypedef int(WINAPI *rcvfrom_ptr) (\nSOCKET          s,\nchar            *buf,\nint             len,\nint             flags,\nstruct sockaddr *from,\nint             *fromlen\n);\n\ntypedef int(WINAPI *sendto_ptr) (\n_In_       SOCKET                s,\n_In_ const char                  *buf,\n_In_       int                   len,\n_In_       int                   flags,\n_In_       const struct sockaddr *to,\n_In_       int                   tolen\n);\n\n// Function pointers for original calls.\n\nrcvfrom_ptr orig_rcvfrom;\nsendto_ptr orig_sendto;\n\n//\n// Helper functions.\n//\n\ntypedef union sockaddrs {\n    struct sockaddr from;\n    struct sockaddr_in in_from;\n    // Need to verify Ipv6 support. may need to remigrate back to VS 2015\n    //struct sockaddr_in6 in6_from;\n} tsockaddrs;\n\nchar *printaddr(char *buff,const int buffsz, const tsockaddrs *addr)\n{\n    ...\n}\n\n// Shim functions.\n//\n// Still working on getting them to actually work and do what I need. \n// But I may as well develop the skeleton\n\nint WINAPI Myrecvfrom(SOCKET          s,\n                char            *buf,\n                int             len,\n                int             flags,\n                struct sockaddr *from,\n                int             *fromlen\n)\n{\n    int result;\n    struct sockaddr *all_froms;\n    char addrbuff[100] = \"\";\n    int newfromlen = sizeof(struct sockaddr);\n\n    all_froms = (struct sockaddr *)malloc(sizeof(struct sockaddr));\n    memset((void *)all_froms,0,sizeof(struct sockaddr));\n\n    printf(\"Receiving Packet!\\n\");\n    if (from == NULL) {\n        printf(\"\\tFrom addr == null, using internal structures\\n\");\n        result =  (orig_rcvfrom)(s, buf, len, flags, all_froms, &amp;newfromlen);\n    } else {\n        printf(\"\\tFrom addr != null, using passed structures\\n\");\n        result =  (orig_rcvfrom)(s, buf, len, flags, from, fromlen);\n        memcpy_s((void*)&amp;all_froms,sizeof(all_froms),(void *)from,*fromlen);\n        if (fromlen != NULL) {\n            newfromlen=*fromlen;\n        } else { \n            newfromlen=sizeof(struct sockaddr);\n        }\n    }\n\n    if (result &gt;0) {printf(\"received %d bytes\\n\",result);}\n    else if (result == SOCKET_ERROR) {printf(\"Socket Error %d occurred!\\n\",WSAGetLastError());}\n    if (newfromlen &gt;0) {\n        if (printaddr(addrbuff,sizeof(addrbuff),(tsockaddrs *)all_froms)!=NULL) {\n            printf(\"received %d bytes from on port %d from host %s\\n\",result,((tsockaddrs *)(all_froms))-&gt;in_from.sin_port,addrbuff);\n        }\n        if (from != NULL) {\n            memcpy_s((void*)from,sizeof(struct sockaddr),(void*)&amp;all_froms,newfromlen);\n        }\n        else\n        {\n\n        }\n        if (fromlen != NULL) *fromlen=newfromlen;\n    }\n    else {\n            printf(\"received %d bytes from unknown port and host\\n\",result);\n    }\n\n    if (all_froms != NULL) {free(all_froms);}\n    return result;\n}\n\nint WINAPI Mysendto(SOCKET                s,\n    const char                  *buf,\n    int                   len,\n    int                   flags,\n    const struct sockaddr *to,\n    int                   tolen\n)\n{\n    printf(\"Sending packet!\\n\");\n\n    return orig_sendto(s, buf, len, flags, to, tolen);\n}\n\nBOOL AttachHooks(void)\n{\n    BOOL sethooks;\n    orig_rcvfrom = (rcvfrom_ptr)GetProcAddress(GetModuleHandle(L\"ws2_32\"), \"recvfrom\");\n    sethooks = Mhook_SetHook((PVOID*)&amp;orig_rcvfrom, Myrecvfrom);\n    if (sethooks) {\n        orig_sendto = (sendto_ptr)GetProcAddress(GetModuleHandle(L\"ws2_32\"), \"sendto\");\n        sethooks &amp;= Mhook_SetHook((PVOID*)&amp;orig_sendto, Mysendto);\n    }\n    return sethooks;\n}\n\nBOOL APIENTRY DllMain( HMODULE hModule,\n                       DWORD  ul_reason_for_call,\n                       LPVOID lpReserved\n                     )\n{\n\n    switch (ul_reason_for_call)\n    {\n    case DLL_PROCESS_ATTACH:\n        printf_s(\"This is an attached DLL!\\n\");\n        AttachHooks();\n        break;\n    case DLL_THREAD_ATTACH:\n    case DLL_THREAD_DETACH:\n    case DLL_PROCESS_DETACH:\n        break;\n    }\n    return TRUE;\n}\n</code></pre>\n"}, {"tags": ["c", "matrix", "dynamic", "dynamic-arrays"], "comments": [{"owner": {"reputation": 787, "user_id": 7714006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2bf23fe02b176b9ec4b72f65570e0b5?s=128&d=identicon&r=PG&f=1", "display_name": "Aditi Rawat", "link": "https://stackoverflow.com/users/7714006/aditi-rawat"}, "edited": false, "score": 0, "creation_date": 1514402230, "post_id": 47997472, "comment_id": 82963143, "body": "<code>matriz = (int **)malloc(n_lines * 6 * sizeof(int *))</code>.. are you sure about <code>int *</code>"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1514402515, "post_id": 47997472, "comment_id": 82963266, "body": "I recommend printing the pointers (not what they point to, i.e. e.g. <code>matriz[i][0]</code>) each time you assign them, i.e. inside the inner loop, for n_lines &gt; 2. I bet the result will surprise you."}, {"owner": {"reputation": 3, "user_id": 8016573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44e523f34683fa81917939d54b0516b3?s=128&d=identicon&r=PG&f=1", "display_name": "SirDoge", "link": "https://stackoverflow.com/users/8016573/sirdoge"}, "edited": false, "score": 1, "creation_date": 1514404203, "post_id": 47997472, "comment_id": 82963935, "body": "Yes i understood both cases you mentioned and decided to go with the first one."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 8016573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44e523f34683fa81917939d54b0516b3?s=128&d=identicon&r=PG&f=1", "display_name": "SirDoge", "link": "https://stackoverflow.com/users/8016573/sirdoge"}, "edited": false, "score": 1, "creation_date": 1514403963, "post_id": 47997648, "comment_id": 82963852, "body": "Thank you so much @coderredoc , i apreciated your explanation as well"}], "tags": [], "owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "is_accepted": true, "score": 1, "last_activity_date": 1514403858, "last_edit_date": 1514403858, "creation_date": 1514403100, "answer_id": 47997648, "question_id": 47997472, "link": "https://stackoverflow.com/questions/47997472/creating-a-matrix-in-c/47997648#47997648", "title": "Creating a matrix in C", "body": "<p>Program crashed because you were accessing chunk of memory as if you have jagged allocated array which is not, resulting in invalid memory access in turn making your program crash.</p>\n\n<p>Well from what I see - you messed up type. Two ways to go about this.</p>\n\n<ol>\n<li><pre><code>int **matriz;\nmatriz = malloc(sizeof *matriz*nlines);\n// error check\nfor(size_t i=0; i&lt;nlines; i++){\n     matriz[i]= malloc(sizeof *matriz[i] * 6);\n     // error check\n}\n</code></pre></li>\n<li><pre><code>int *matriz = malloc(6*nlines*sizeof *matriz);\n// error check \nmatriz[r*6+c] = ... // accessing r-th row c-th column.\n</code></pre></li>\n</ol>\n\n<p>And based on case-1 it will be</p>\n\n<pre><code>matriz[i][j] =  current_year ;\n</code></pre>\n\n<p>And in case-2 similarly</p>\n\n<pre><code>matriz[i*6+j] = current_year;\n</code></pre>\n\n<p>General code structure would be</p>\n\n<pre><code>    if (current_year % 400 == 0)\n    {\n        ...\n        seconds = 31622400;\n    }\n    else\n    {\n        ...\n        seconds = 31536000;\n    }\n    for (j = 0; j &lt; 6; ++j)\n    {\n        matriz[i][j] = current_year ;\n        ...\n    }\n</code></pre>\n\n<p>To explain a bit - the first case is allocating a jagged array. First an array of pointers and then each of them are pointing to an array of 6 elements.</p>\n\n<p>Second case is basically allocating a chunk of memory which has <code>6*nlines</code> int and <code>matriz</code> is pointing to beginning of it. Now that's why you will have to access the elements first calculating the right index for it.</p>\n"}], "owner": {"reputation": 3, "user_id": 8016573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44e523f34683fa81917939d54b0516b3?s=128&d=identicon&r=PG&f=1", "display_name": "SirDoge", "link": "https://stackoverflow.com/users/8016573/sirdoge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 1, "accepted_answer_id": 47997648, "answer_count": 1, "score": 0, "last_activity_date": 1514403858, "creation_date": 1514402095, "question_id": 47997472, "link": "https://stackoverflow.com/questions/47997472/creating-a-matrix-in-c", "title": "Creating a matrix in C", "body": "<p>I\u00b4m trying to create a dynamic matrix with an user introduzed number of lines and 6 columns.\nI only want to create the matrix so I can get its values when I want to.\nI have tried this but the program crashes when it gets here.</p>\n\n<pre><code>matriz = (int **)malloc(n_lines * 6 * sizeof(int *));\nfor (i = 0; i &lt; n_lines; ++i)\n{\n    for (j = 0; j &lt; 6; ++j)\n    {\n        current_year = starting_year + i;\n        if (current_year % 400 == 0)\n        {\n            february = 29;\n            days = 366;\n            hours = 8784;\n            minutes = 527040;\n            seconds = 31622400;\n        }\n        else\n        {\n            february = 28;\n            days = 365;\n            hours = 8760;\n            minutes = 525600;\n            seconds = 31536000;\n        }\n        matriz[i][0] = { current_year };\n        matriz[i][1] = { february };\n        matriz[i][2] = { days };\n        matriz[i][3] = { hours };\n        matriz[i][4] = { minutes };\n        matriz[i][5] = { seconds };\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "llvm"], "answers": [{"comments": [{"owner": {"reputation": 145, "user_id": 9138616, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9fdd565ce3edf45d047e85604ed1ac8e?s=128&d=identicon&r=PG&f=1", "display_name": "Hif", "link": "https://stackoverflow.com/users/9138616/hif"}, "edited": false, "score": 0, "creation_date": 1514422818, "post_id": 47999009, "comment_id": 82969299, "body": "<code>isPointerTy()</code> returns a <code>bool</code>. I am interested in <code>i32</code>."}, {"owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "reply_to_user": {"reputation": 145, "user_id": 9138616, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9fdd565ce3edf45d047e85604ed1ac8e?s=128&d=identicon&r=PG&f=1", "display_name": "Hif", "link": "https://stackoverflow.com/users/9138616/hif"}, "edited": false, "score": 6, "creation_date": 1514439684, "post_id": 47999009, "comment_id": 82972656, "body": "Then there is <code>isIntegerTy()</code>. If you want to extract <code>i32</code> from <code>i32*</code>, use <code>getPointerElementType()</code>."}], "tags": [], "owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "is_accepted": false, "score": 3, "last_activity_date": 1514411105, "creation_date": 1514411105, "answer_id": 47999009, "question_id": 47997388, "link": "https://stackoverflow.com/questions/47997388/how-can-we-extract-pointer-type-in-llvm/47999009#47999009", "title": "How can we extract pointer type in LLVM", "body": "<p>First you access an operand you are interested in with <code>instruction-&gt;getOperand(i)</code> and then call <code>-&gt;getType()</code> on it. The <code>llvm::Type</code> class has a lot of helper classes and <code>-&gt;isPointerTy()</code> is what you are probably interested in.</p>\n"}], "owner": {"reputation": 145, "user_id": 9138616, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9fdd565ce3edf45d047e85604ed1ac8e?s=128&d=identicon&r=PG&f=1", "display_name": "Hif", "link": "https://stackoverflow.com/users/9138616/hif"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 841, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1514411105, "creation_date": 1514401634, "question_id": 47997388, "link": "https://stackoverflow.com/questions/47997388/how-can-we-extract-pointer-type-in-llvm", "title": "How can we extract pointer type in LLVM", "body": "<p>I have the following LLVM IR </p>\n\n<pre><code>%6 = load i32** %imw, align 8\n%arrayidx = getelementptr inbounds i32* %6, i64 10\n</code></pre>\n\n<p>I want to extract <code>i32</code> from these instructions in my LLVM pass. Can anyone guide me on how can I go about doing this?</p>\n"}, {"tags": ["c", "while-loop", "scanf"], "comments": [{"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 3, "creation_date": 1514399647, "post_id": 47997002, "comment_id": 82962126, "body": "Try <code>scanf(&quot; %c&quot;, &amp;ch);</code> See also: <a href=\"//stackoverflow.com/q/5240789\">scanf() leaves the new line char in the buffer</a>"}], "answers": [{"tags": [], "owner": {"reputation": 5349, "user_id": 5132337, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/fcj6b.jpg?s=128&g=1", "display_name": "Siraj Alam", "link": "https://stackoverflow.com/users/5132337/siraj-alam"}, "is_accepted": false, "score": 0, "last_activity_date": 1514399921, "last_edit_date": 1514399921, "creation_date": 1514399583, "answer_id": 47997033, "question_id": 47997002, "link": "https://stackoverflow.com/questions/47997002/scanf-function-in-a-while-loop/47997033#47997033", "title": "scanf function in a while loop", "body": "<p>Write this statement after your <code>scanf</code> statement.</p>\n\n<pre><code>while( getchar() != '\\n' );  /* flush to end of input line */\n</code></pre>\n\n<p>The next time the loop executes, it auto-fetch the character from the <a href=\"https://stackoverflow.com/questions/14068346/what-is-the-standard-input-buffer\">standard input buffer</a>, so you have to clear it after every <code>scanf</code>, so that it is not available for the next  <code>scanf</code>. Which is done by the line of code I have above.</p>\n"}], "owner": {"reputation": 1, "user_id": 9146348, "user_type": "registered", "profile_image": "https://graph.facebook.com/977221285749172/picture?type=large", "display_name": "Shrinath Raje Bhosale", "link": "https://stackoverflow.com/users/9146348/shrinath-raje-bhosale"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 807, "favorite_count": 0, "closed_date": 1514400106, "answer_count": 1, "score": 0, "last_activity_date": 1514400163, "creation_date": 1514399389, "last_edit_date": 1514400163, "question_id": 47997002, "link": "https://stackoverflow.com/questions/47997002/scanf-function-in-a-while-loop", "closed_reason": "Duplicate", "title": "scanf function in a while loop", "body": "<p>The output of the following code is very weird for me to understand.Can anybody explain me why it's behaving that way?</p>\n\n<pre><code>#include&lt;stdio.h&gt;\nint main()\n{\n    int i=0;\n    char ch='a';\n\n    while(ch!='q')\n    {\n       scanf(\"%c\",&amp;ch);\n       printf(\"\\t%d\\n\",i);\n       i++;\n    }\n\n}\n</code></pre>\n\n<p>Output</p>\n\n<p><a href=\"https://i.stack.imgur.com/UbB1J.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/UbB1J.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c", "arrays", "multidimensional-array", "encoder"], "comments": [{"owner": {"reputation": 509, "user_id": 8857328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a43855efb44db02b57d0f7253394882?s=128&d=identicon&r=PG&f=1", "display_name": "VladP", "link": "https://stackoverflow.com/users/8857328/vladp"}, "edited": false, "score": 9, "creation_date": 1514398758, "post_id": 47996835, "comment_id": 82961749, "body": "That is because the Morse code symbols are more than 1 character long. You need to make a space for them, and 10 is the worst case scenario for Morse code."}, {"owner": {"reputation": 2774, "user_id": 3363228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f2654f48d91375a43fa07e9ea616354?s=128&d=identicon&r=PG&f=1", "display_name": "ubadub", "link": "https://stackoverflow.com/users/3363228/ubadub"}, "edited": false, "score": 4, "creation_date": 1514398852, "post_id": 47996835, "comment_id": 82961797, "body": "Please for the love of God format your code"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1514400557, "post_id": 47996835, "comment_id": 82962474, "body": "Aside: I wonder why each Morse code needs a terminating comma, when each contains a terminating nul <code>&#39;\\0&#39;</code>."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1514401001, "post_id": 47996835, "comment_id": 82962664, "body": "There are some problems with the code: the <a href=\"https://stackoverflow.com/questions/1694036/why-is-the-gets-function-so-dangerous-that-it-should-not-be-used%5D\"><code>gets</code> function is so dangerous</a> that it is now obsolete, and <code>fflush(stdin)</code> is <a href=\"https://stackoverflow.com/questions/2979209/using-fflushstdin\">non-standard</a>, and your loop control <code>for(i=0; frase!=&#39;\\0&#39;; i++)</code> should be <code>for(i=0; frase[i]!=&#39;\\0&#39;; i++)</code>."}, {"owner": {"reputation": 25937, "user_id": 338904, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/dea29233fa03ea84f8a853102deb0344?s=128&d=identicon&r=PG", "display_name": "e2-e4", "link": "https://stackoverflow.com/users/338904/e2-e4"}, "edited": false, "score": 0, "creation_date": 1514433451, "post_id": 47996835, "comment_id": 82971287, "body": "<code>char *m[37] = { &quot;.-,&quot;, &quot;-...,&quot;, ... };</code> would have been safer and less space expensive (and the trailing <code>,</code> in each code should not be there)."}, {"owner": {"reputation": 25937, "user_id": 338904, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/dea29233fa03ea84f8a853102deb0344?s=128&d=identicon&r=PG", "display_name": "e2-e4", "link": "https://stackoverflow.com/users/338904/e2-e4"}, "edited": false, "score": 0, "creation_date": 1514433934, "post_id": 47996835, "comment_id": 82971377, "body": "<code>-... - .-- &#47;&#47; - .... . &#47;&#47; ..-. ..- -. -.-. - .. --- -. &#47;&#47; -.. --- . ... &#47;&#47; -. --- - &#47;&#47; .-- --- .-. -.-</code>"}], "answers": [{"tags": [], "owner": {"reputation": 4565, "user_id": 1134885, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c428466054762cf7d4b5fb5f4396fa2?s=128&d=identicon&r=PG", "display_name": "NovaDenizen", "link": "https://stackoverflow.com/users/1134885/novadenizen"}, "is_accepted": true, "score": 2, "last_activity_date": 1514420428, "creation_date": 1514420428, "answer_id": 48000145, "question_id": 47996835, "link": "https://stackoverflow.com/questions/47996835/text-to-morse-code-in-c/48000145#48000145", "title": "Text to Morse code in C", "body": "<p><code>m</code> is a two-dimensional array.  Think of it as having 37 rows, each with 10 characters.  A C string is encoded in each row and implicitly terminated by a <code>\\0</code> character you don't see.  For instance, the <code>{\".....,\"}</code> row contains 5 <code>'.'</code> characters, 1 <code>'.'</code> character, and a <code>'\\0'</code> terminating character.  The remaining 3 bytes in that row are filled in as <code>'\\0'</code> characters by default.</p>\n"}], "owner": {"reputation": 31, "user_id": 8968483, "user_type": "registered", "profile_image": "https://graph.facebook.com/1742943012385656/picture?type=large", "display_name": "Erick Pro", "link": "https://stackoverflow.com/users/8968483/erick-pro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1389, "favorite_count": 0, "accepted_answer_id": 48000145, "answer_count": 1, "score": 0, "last_activity_date": 1514420428, "creation_date": 1514398581, "last_edit_date": 1514399672, "question_id": 47996835, "link": "https://stackoverflow.com/questions/47996835/text-to-morse-code-in-c", "title": "Text to Morse code in C", "body": "<p>I have a function that translates text entered by the user (it also translates numbers) to Morse code, however I do not understand why the array that contains the alphabet in <strong>morse</strong> code: <strong>m [37] [10]</strong> is a two-dimensional array? I understand that the 37 is by the amount of letters, numbers and white space, make a total of 37, but why the 10? </p>\n\n<p>Here is my code:</p>\n\n<pre><code>void textoMorse(){\n    int i,j;\n    char texto[37] = {\n        'a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j', 'k', 'l', \n        'm', 'n', 'o', 'p', 'q', 'r', 's', 't', 'u', 'v', 'w', 'x', \n        'y', 'z', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', ' '\n     };\n    char m[37][10]={\n        {\".-,\"}, {\"-...,\"}, {\"-.-.,\"}, {\"-..,\"}, {\".,\"}, {\"..-.,\"},\n        {\"--.,\"}, {\"....,\"}, {\"..,\"}, {\".---,\"}, {\"-.-,\"}, {\".-..,\"},\n        {\"--,\"}, {\"-.,\"}, {\"---,\"}, {\".--.,\"}, {\"--.-,\"}, {\".-.,\"}, \n        {\"...,\"}, {\"-,\"}, {\"..-,\"}, {\"...-,\"}, {\".--,\"}, {\"-..-,\"},\n        {\"-.--,\"}, {\"--..,\"}, {\".----,\"}, {\"..---,\"}, {\"...--,\"}, \n        {\"....-,\"}, {\".....,\"}, {\"-....,\"}, {\"--...,\"}, {\"---..,\"}, \n        {\"---.,\"}, {\"-----,\"}, {\"//\"}\n    };\n    char frase[1000];\n    gets(frase);\n    fflush(stdin);\n    for(i=0; frase!='\\0'; i++){\n        for(j=0; j&lt;37; j++){\n            if(frase[i] == texto[j]){\n                printf(\"%s\",m[j]);\n            }\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "posix"], "comments": [{"owner": {"reputation": 307, "user_id": 9082567, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4b73499f293b4a840913620cd8b711b?s=128&d=identicon&r=PG&f=1", "display_name": "Fat-Zer", "link": "https://stackoverflow.com/users/9082567/fat-zer"}, "edited": false, "score": 0, "creation_date": 1514402237, "post_id": 47996499, "comment_id": 82963145, "body": "<code>scanf(&quot;%s&quot;, &amp;buffer);</code> the <code>&amp;</code> shouldn&#39;t be here. Is it a typo only here or in the code you are actually running as well?"}, {"owner": {"reputation": 31, "user_id": 9026565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79df86db94f44c827871d5abfbdd6c89?s=128&d=identicon&r=PG&f=1", "display_name": "LowProfile", "link": "https://stackoverflow.com/users/9026565/lowprofile"}, "reply_to_user": {"reputation": 307, "user_id": 9082567, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4b73499f293b4a840913620cd8b711b?s=128&d=identicon&r=PG&f=1", "display_name": "Fat-Zer", "link": "https://stackoverflow.com/users/9082567/fat-zer"}, "edited": false, "score": 0, "creation_date": 1514403734, "post_id": 47996499, "comment_id": 82963751, "body": "It was also in the code - but I tried it previously with and without it - it doesn&#39;t cause the actual error. Getting rid of all sem_wait and sem_post makes that the problem does not occur, just after that I&#39;m getting infinite loop with printing everything all over the terminal - because semaphores don&#39;t block anything as they should."}, {"owner": {"reputation": 307, "user_id": 9082567, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4b73499f293b4a840913620cd8b711b?s=128&d=identicon&r=PG&f=1", "display_name": "Fat-Zer", "link": "https://stackoverflow.com/users/9082567/fat-zer"}, "edited": false, "score": 0, "creation_date": 1514408322, "post_id": 47996499, "comment_id": 82965472, "body": "Also not likely related: the check <code>if(pamID &lt; 0)</code> should be before <code>shmat()</code>. Also you should check the return value of <code>shmat()</code> itself."}, {"owner": {"reputation": 31, "user_id": 9026565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79df86db94f44c827871d5abfbdd6c89?s=128&d=identicon&r=PG&f=1", "display_name": "LowProfile", "link": "https://stackoverflow.com/users/9026565/lowprofile"}, "reply_to_user": {"reputation": 307, "user_id": 9082567, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4b73499f293b4a840913620cd8b711b?s=128&d=identicon&r=PG&f=1", "display_name": "Fat-Zer", "link": "https://stackoverflow.com/users/9082567/fat-zer"}, "edited": false, "score": 0, "creation_date": 1514410897, "post_id": 47996499, "comment_id": 82966374, "body": "Okey, I&#39;m getting the idea. The program sort of worked after I reboot&#39;ed it - the problem with its memory comes after I already created some semaphores but I didn&#39;t clear em up properly - because of the problems - I had to turn it off in the terminal using &quot;CTRL+Z&quot; combination for example. The problem persist as long as they are semaphores in the system - so how could I get rid off them after failure of program (by failure I mean that I had to terminate it in an unusual way - like &quot;CTRL+Z&quot; methoded as I mentionet)? Shmat() works just fine as I checked."}, {"owner": {"reputation": 307, "user_id": 9082567, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4b73499f293b4a840913620cd8b711b?s=128&d=identicon&r=PG&f=1", "display_name": "Fat-Zer", "link": "https://stackoverflow.com/users/9082567/fat-zer"}, "edited": false, "score": 0, "creation_date": 1514411056, "post_id": 47996499, "comment_id": 82966439, "body": "Remove them from <code>&#47;dev&#47;shm</code>."}, {"owner": {"reputation": 31, "user_id": 9026565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79df86db94f44c827871d5abfbdd6c89?s=128&d=identicon&r=PG&f=1", "display_name": "LowProfile", "link": "https://stackoverflow.com/users/9026565/lowprofile"}, "reply_to_user": {"reputation": 307, "user_id": 9082567, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4b73499f293b4a840913620cd8b711b?s=128&d=identicon&r=PG&f=1", "display_name": "Fat-Zer", "link": "https://stackoverflow.com/users/9082567/fat-zer"}, "edited": false, "score": 0, "creation_date": 1514414162, "post_id": 47996499, "comment_id": 82967345, "body": "Yeah, that helped. Thank you very much - now everything is fine and program itself works as I wanted it to be (With a minor change in the way of reading input into shared memory). Anyway the main problem is gone. :D"}], "owner": {"reputation": 31, "user_id": 9026565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79df86db94f44c827871d5abfbdd6c89?s=128&d=identicon&r=PG&f=1", "display_name": "LowProfile", "link": "https://stackoverflow.com/users/9026565/lowprofile"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1505, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1514396834, "creation_date": 1514396834, "question_id": 47996499, "link": "https://stackoverflow.com/questions/47996499/using-posix-semaphores-between-processes-named-semaphores-linux-c", "title": "Using POSIX semaphores between processes (Named semaphores, Linux, C)", "body": "<p>The main idea of this simple program is to make communication between processes through the shared memory and limit their access by using semaphores. 'Forks' creating the main Parent Process and 3 Child Processes. Child are consumers and Parent is the producer. Child ought to get in the queue for every information that Parent produces for example: \"PP produces word 'thing' -> P1 recives 'thing' -> PP produces next word 'thing2' -> P2 recives 'thing2' -> PP produces next word 'thing3' -> P3 recives 'thing3'\" - whole thing goes in circle as long as I like - but its not the problem (I've got the thing working using semaphores from system V).</p>\n\n<p>The problem I encountered is the fact that using 'sem_post' and 'sem_wait' causes segmentation fault (core dumped) - without these program goes (of course it doesn't make much of a sense in that way). I'm not sure if I'm missing something over there, maybe I should open those semaphores inside the child processes (but how?). I'm not a quite expert on that, so I would like to ask somebody for help - maybe its just something simple. :)</p>\n\n<p>If anything needs elaboration I can write something more about it.</p>\n\n<pre><code>#include &lt;sys/types.h&gt;\n#include &lt;sys/ipc.h&gt;\n#include &lt;sys/shm.h&gt;\n#include &lt;semaphore.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;sys/stat.h&gt;\n#include &lt;sys/wait.h&gt;\n#include &lt;unistd.h&gt;\n\nchar tab[50]; //array for information sending through shared memory\nchar* buffer; //pointer using to actually send something through shared memory\n\nint main()\n{\npid_t P1, P2, P3;\nsem_t* mutex_prod;   //sem_t* for producer\nsem_t* mutex_kons;   //sem_t* for consumer\nkey_t pd;            //key for shared memory\nint pamID;\nchar STOP = '.';     //character using to stop input in console\n\n//two semaphores are beeing created - first for producer and second for consumers - both are getting 1 as value (since the main idea is to use binary semaphores)\nif ((mutex_prod = sem_open(\"mutex_prod\", O_CREAT | O_EXCL, 0666, 1)) == SEM_FAILED)\n{\n  perror(\"Semaphore init\");\n}\nif ((mutex_kons = sem_open(\"mutex_kons\", O_CREAT | O_EXCL, 0666, 1)) == SEM_FAILED)\n{\n  perror(\"Semaphore init\");\n}\n\npd = ftok(\"home/mrrobot/Pulpit/memsem/p.c\", 5); //some key for shared memory\n\n//creation of shared memory\npamID = shmget(pd, sizeof(char), IPC_CREAT | 0666);\nbuffer = (char*)shmat(pamID, NULL, 0);\n*buffer=0;\n\nif(pamID &lt; 0)\n  {\n    perror(\"shmget\");\n    exit(1);\n  }\n\nmemcpy(buffer, tab, 50);\n\nsem_wait(mutex_prod);   //here's problem starting I suppose and continue with every single next sem_wait or sem_post\n\nswitch(P1 = fork())\n{\n    case -1:\n    printf(\"Blad f. fork\");\n    exit(1);\n\n    case 0:\n    while(1)\n    {\n        sem_post(mutex_kons);        //post for consumer semaphore\n        if((char)*buffer == STOP)\n            break;\n        printf(\"PK1 (%d) odczytal dane:\\n\", getpid());\n        printf(\"%s\", buffer);\n        sem_wait(mutex_prod);   //wait for producer semaphore\n    }\n    shmdt(buffer);\n    exit(0);\n\n    default:\n    switch(P2 = fork())\n    {\n        case -1:\n        printf(\"Blad f. fork\");\n        exit(1);\n\n        case 0:\n        while(1)\n        {\n            sem_post(mutex_kons);\n            if((char)*buffer == STOP)\n                break;\n            printf(\"PK2 (%d) odczytal dane:\\n\", getpid());\n            printf(\"%s\", buffer);\n            sem_wait(mutex_prod);\n        }\n        shmdt(buffer);\n        exit(0);\n    }\n\n    switch(P3 = fork())\n    {\n        case -1:\n        printf(\"Blad f. fork\");\n        exit(1);\n\n        case 0:\n        while(1)\n        {\n            sem_post(mutex_kons);\n            if((char)*buffer == STOP)\n                break;\n            printf(\"PK3 (%d) odczytal dane:\\n\", getpid());\n            printf(\"%s\", buffer);\n            sem_wait(mutex_prod);\n        }\n        shmdt(buffer);\n        exit(0);\n    }\n}\nwhile(1) //main process - producer\n{\n    sem_post(mutex_prod); //post semaphore of producer\n    printf(\"PP (%d). Podaj dane:\\n\", getpid());  \n    printf(\"Aby zakonczyc, wcisnij %c i zatwierdz ENTERem\\n\", STOP); //printf informing about entering new data or ending program by taping '.'\n\n    scanf(\"%s\", &amp;buffer);    //scanf for new data typed in the terminal \n    if((char)*buffer == STOP)\n        break;\n\n    //wait for consumers' semaphore\n    sem_wait(mutex_kons);\n}\n//clearing the memory\nshmdt(buffer);\nshmctl(pamID, IPC_RMID, 0);\nsem_unlink(\"mutex_prod\");\nsem_unlink(\"mutex_kons\");\nsem_close(mutex_prod);\nsem_close(mutex_kons);\nwait(NULL);\nwait(NULL);\nwait(NULL);\n\nreturn 0;\n}\n</code></pre>\n"}, {"tags": ["c", "ipc", "waitpid", "sigaction"], "comments": [{"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 3, "creation_date": 1514395500, "post_id": 47996161, "comment_id": 82960520, "body": "I don\u2019t know why this doesn\u2019t happen with the <code>signal</code> function unless you just use that to ignore the signal, but when a system call like <code>waitpid</code> exits with <code>-1</code> you should check <code>errno</code>, which for <code>waitpid</code> can be <a href=\"http://man7.org/linux/man-pages/man2/waitpid.2.html#ERRORS\" rel=\"nofollow noreferrer\">one of these values</a>. In this case, I strongly expect the result will be <code>EINTR</code>, the system call was interrupted by a signal (in this case your <code>SIGALRM</code>). You need to re-start the <code>waitpid</code> system call; the program can\u2019t automatically jump back into it when the signal handler returns."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1514397306, "post_id": 47996161, "comment_id": 82961170, "body": "The <code>signal()</code> function on different systems does things differently, depending on the legacy of that system.  The standards allow great flexibility, but almost no control, over what happens.  Using <code>sigaction()</code> allows for basically all of the legacy operations, but allows you complete control over what happens.  If you want dependable behaviour, use <code>sigaction()</code> and be specific."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 9146108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30ec4fbe895d6b2d38d8e269995ef971?s=128&d=identicon&r=PG&f=1", "display_name": "gaet", "link": "https://stackoverflow.com/users/9146108/gaet"}, "edited": false, "score": 0, "creation_date": 1514396130, "post_id": 47996276, "comment_id": 82960735, "body": "to zwol and Daniel H. You&#39;ve been precious!! And you have avoided my madness!! Thanks very much, it works!!"}], "tags": [], "owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "is_accepted": false, "score": 3, "last_activity_date": 1514395740, "creation_date": 1514395740, "answer_id": 47996276, "question_id": 47996161, "link": "https://stackoverflow.com/questions/47996161/waitpid-and-signal-handler-c/47996276#47996276", "title": "waitpid and signal handler, C", "body": "<p>The default behavior of signal handlers established by <code>sigaction</code> is to <em>interrupt</em> blocking system calls; if you check <code>errno</code> after the alarm fires you should observe it to be set to <code>EINTR</code>.  This behavior is almost never what you want; it's only the default for backward compatibility's sake.  You can make it not do this by setting the <code>SA_RESTART</code> bit in <code>sa_flags</code>:</p>\n\n<pre><code>struct sigaction act;\nact.sa_flags = SA_RESTART;\nact.sa_handler = alarmHandler;\nsigemptyset(&amp;act.sa_mask);\nsigaction(SIGALRM, &amp;act, 0);\n</code></pre>\n\n<p>One of the most important reasons to use <code>sigaction</code> instead of <code>signal</code>, is that when you use <code>signal</code> it is <em>unpredictable</em> whether or not the signal handler will interrupt blocking system calls.  (The System V lineage picked one semantic and the BSD lineage picked the other.)</p>\n"}], "owner": {"reputation": 11, "user_id": 9146108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30ec4fbe895d6b2d38d8e269995ef971?s=128&d=identicon&r=PG&f=1", "display_name": "gaet", "link": "https://stackoverflow.com/users/9146108/gaet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 611, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1514397131, "creation_date": 1514395143, "last_edit_date": 1514397131, "question_id": 47996161, "link": "https://stackoverflow.com/questions/47996161/waitpid-and-signal-handler-c", "title": "waitpid and signal handler, C", "body": "<p>I tried to find an answer to my question at this post: <a href=\"https://stackoverflow.com/questions/29657624/signal-handler-and-waitpid-coexisting\">Signal handler and waitpid coexisting</a> but for me isn't very clear at the moment.</p>\n\n<p>I try to explain my problems:</p>\n\n<p>I'm trying to write a C program that concerns IPC between a parent process and its children. \nThe parent process creates N child processes, then it waits for the termination in a loop like this:</p>\n\n<pre><code>while((pid_term = waitpid(-1, &amp;status, 0)) != -1)\n</code></pre>\n\n<p>After X seconds, parent receives SIGALRM, then with the sigaction system call,\nit catches the alarm:</p>\n\n<pre><code>struct sigaction act;\nact.sa_handler = alarmHandler;\nsigemptyset(&amp;act.sa_mask);\n\nact.sa_flags = 0;\nsigaction(SIGALRM, &amp;act, NULL);  \n</code></pre>\n\n<p>But, when the handler function returns, the waitpid also returns -1, and the parent process exits from the while loop above.\nAt the moment, the handler function has an empty body.</p>\n\n<p>I ask myself what happened \u2014 why did <code>waitpid()</code> return -1 after the handler invocation even though most of the children are still alive? Why doesn't this happen with <code>signal()</code> function?</p>\n"}, {"tags": ["c", "arrays", "pipe", "fork"], "comments": [{"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 2, "creation_date": 1514394568, "post_id": 47995937, "comment_id": 82960153, "body": "Several issues: 1. Your <code>error</code> function in the parent will overwrite <code>errno</code> before printing it. 2. Your loops use <code>&lt;=</code> as the looping condition, meaning they try to set element 1000 of the array, which is UB because the maximum index is 999 (for 1000 total values in the arrays). 3. (this is <i>probably</i> where you\u2019re seeing the issues, but I\u2019m not sure) You\u2019re calling <code>read</code> once in the child process, but you don\u2019t verify that everything was read. <i>Always, <b>always</i></b> check the return value of <code>read</code> even if you ignore it for other system calls."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1514396916, "post_id": 47995937, "comment_id": 82961007, "body": "The <code>error</code> function <i>might</i> overwrite <code>errno</code>; it is not guaranteed to do so.  The <code>write(1, numeros, sizeof(numeros)+1);</code> is weird; it writes one byte more than there is space in the <code>numeros</code> array, which is undefined behaviour.  It isn&#39;t clear why you think the extra byte might be helpful.  You should also error check any open-like calls (as well as any input calls \u2014 like <code>read()</code>)."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1514397424, "post_id": 47995937, "comment_id": 82961234, "body": "<b>Rule of thumb</b>: If you <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/dup2.html\" rel=\"nofollow noreferrer\"><code>dup2()</code></a> one end of a pipe to standard input or standard output, close both ends of the pipe as soon as possible. That means before using any of the <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/execvp.html\" rel=\"nofollow noreferrer\"><code>exec*()</code></a> family of functions in particular.  It also includes using <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/dup.html\" rel=\"nofollow noreferrer\"><code>dup()</code></a> or <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/fcntl.html\" rel=\"nofollow noreferrer\"><code>fcntl()</code></a> with <code>F_DUPFD</code>."}, {"owner": {"reputation": 440, "user_id": 1216107, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5fb09216c1cd9675edfa10b4ac7f016a?s=128&d=identicon&r=PG", "display_name": "roof", "link": "https://stackoverflow.com/users/1216107/roof"}, "edited": false, "score": 0, "creation_date": 1514409164, "post_id": 47995937, "comment_id": 82965743, "body": "Thanks for your comments. After checking the read return value, it gives me a bad file descriptor error. I&#39;m trying to figure out why."}], "owner": {"reputation": 440, "user_id": 1216107, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5fb09216c1cd9675edfa10b4ac7f016a?s=128&d=identicon&r=PG", "display_name": "roof", "link": "https://stackoverflow.com/users/1216107/roof"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 107, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1514394035, "creation_date": 1514394035, "question_id": 47995937, "link": "https://stackoverflow.com/questions/47995937/child-process-not-reading-correct-values-from-pipe", "title": "Child process not reading correct values from pipe", "body": "<p>I have two processes:</p>\n\n<p><strong>Master.c</strong></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;string.h&gt;\n\nvoid error(char *m)\n{\n    write(2, m, strlen(m));\n    write(2, \"\\n\", 1);\n    write(2, strerror(errno), strlen(strerror(errno))); exit(1);\n\n}\n\nint main(int argc, char *argv[])\n{\n   int fd1[2],fd2[0];\nint numeros[1000];\nint val;\nint wpid;\nint status = 0;\n\nsignal(SIGINT, sigint_handler);\n\nif (pipe(fd1) &lt; 0) error(\"Pipe creation\");\n\npid1 = fork();\n\nswitch (pid1) {\n        case -1: error(\"Fork 1\");\n        case 0: /* Proc\u00e9s fill */\n              close(0);\n              dup(fd1[0]);\n              close(fd1[1]);\n              execv(\"./Second\",NULL);\n\n        default: /* Proc\u00e9s pare */\n            break;\n}\n\nclose(1);\ndup(fd1[1]);\nclose(fd1[0]);\n\nfor( val = 0; val &lt;= 1000; val++)\n     numeros[val]=val;\n\n\nwrite(1, numeros, sizeof(numeros)+1);\n\nwhile ((wpid = wait(&amp;status)) &gt; 0);\n\nexit(EXIT_SUCCESS);\n\nreturn 0;\n}\n</code></pre>\n\n<p><strong>Second:</strong></p>\n\n<pre><code>int main(int argc, char *argv[])\n{\n    int i,k = 0;\n    int num_rev[1000];\n    int num_pair[1000];\n\n    read(0, num_rev, sizeof(num_rev));\n\n    for( i = 1; i &lt;= 1000; i++){\n        int temp = num_rev[i];\n        printf(\"Child(%d) received value: %d\\n\", getpid(), temp);\n        int m = temp % 2;\n        if (m != 0){\n            num_pair[k]=temp;\n            printf(\"Second filtered value: %d\\n\", temp);\n            k++;\n        }\n    }\n\n    exit(EXIT_SUCCESS);\n\n    return 0;\n}\n</code></pre>\n\n<p>First as parent, creates Second as child and sends integers values from 1 to 1000 in a array, using a pipe, redirecting stdout and stdin. I have followed this post as example:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/47371735/using-a-pipe-to-write-and-read-array-of-int\">Using a Pipe to Write and Read Array of Int</a></p>\n\n<p>but Second process is receiving unexpected values: </p>\n\n<pre><code>Child(2370) received value: 32766\nChild(2370) received value: 6\nChild(2370) received value: 0\nChild(2370) received value: 14\nChild(2370) received value: 0\nChild(2370) received value: 354020744\nChild(2370) received value: 1\n</code></pre>\n\n<p>Thanks.</p>\n"}, {"tags": ["c", "string", "pointers"], "comments": [{"owner": {"reputation": 19, "user_id": 9146081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e391aa495e526adfea3efee4bbe1fbb?s=128&d=identicon&r=PG&f=1", "display_name": "JonnahMae", "link": "https://stackoverflow.com/users/9146081/jonnahmae"}, "reply_to_user": {"reputation": 787, "user_id": 7714006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2bf23fe02b176b9ec4b72f65570e0b5?s=128&d=identicon&r=PG&f=1", "display_name": "Aditi Rawat", "link": "https://stackoverflow.com/users/7714006/aditi-rawat"}, "edited": false, "score": 0, "creation_date": 1514393871, "post_id": 47995875, "comment_id": 82959830, "body": "sorry it should only be C."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1514393893, "post_id": 47995875, "comment_id": 82959843, "body": "<code>sEnteredString = (char*)malloc(sizeof(sEnteredString));</code>: is only allocating 4 or 8 bytes. You have to specify a size."}, {"owner": {"reputation": 2565, "user_id": 4781312, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/lDEcJ.jpg?s=128&g=1", "display_name": "Asesh", "link": "https://stackoverflow.com/users/4781312/asesh"}, "edited": false, "score": 1, "creation_date": 1514393931, "post_id": 47995875, "comment_id": 82959862, "body": "<code>sEnteredString = (char*)malloc(sizeof(sEnteredString));</code> That&#39;s the problem. <code>sEnteredString</code> is a pointer so it&#39;s going to allocate memory based on the size of that pointer"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "reply_to_user": {"reputation": 2565, "user_id": 4781312, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/lDEcJ.jpg?s=128&g=1", "display_name": "Asesh", "link": "https://stackoverflow.com/users/4781312/asesh"}, "edited": false, "score": 1, "creation_date": 1514394052, "post_id": 47995875, "comment_id": 82959918, "body": "@Asesh Please make an answer, in order to get this out of the list of unanswered questions."}, {"owner": {"reputation": 787, "user_id": 7714006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2bf23fe02b176b9ec4b72f65570e0b5?s=128&d=identicon&r=PG&f=1", "display_name": "Aditi Rawat", "link": "https://stackoverflow.com/users/7714006/aditi-rawat"}, "edited": false, "score": 0, "creation_date": 1514394560, "post_id": 47995875, "comment_id": 82960148, "body": "As you are saying <i>after entering a long string</i> and using <code>int sizeString;</code> are you sure <code>int</code> can store the length"}], "answers": [{"tags": [], "owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "is_accepted": false, "score": 1, "last_activity_date": 1514394450, "last_edit_date": 1514394450, "creation_date": 1514394109, "answer_id": 47995950, "question_id": 47995875, "link": "https://stackoverflow.com/questions/47995875/program-crashes-after-input-a-string-using-malloc/47995950#47995950", "title": "Program crashes after input a String using Malloc", "body": "<p>why are you (wrongly) allocating dynamic memory for this:</p>\n\n<pre><code>sEnteredString = (char*)malloc(sizeof(sEnteredString));\n</code></pre>\n\n<p>where <code>sizeof(sEnteredString)</code> is the size of the char pointer (which is usually 4 or 8) ? so too short when entering a string like \"hey! waffles!\".</p>\n\n<p>when you can do:</p>\n\n<pre><code>char sEnteredString[100];\n</code></pre>\n\n<p>then</p>\n\n<pre><code>scanf(\"%99s\",sEnteredString);\n</code></pre>\n\n<p>so you auto allocate your string and there's a safety in case someone enters a too big string.</p>\n\n<p>Important: don't <code>free(sEnteredString)</code> in the end</p>\n\n<p>Aside: use <code>toupper</code> along with a <code>switch/case</code> statement to avoid all those ifs. And remember to count consonants, not chars that aren't vowels (like spaces, punctuation, ...)</p>\n"}, {"tags": [], "owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "is_accepted": false, "score": 1, "last_activity_date": 1514397460, "last_edit_date": 1514397460, "creation_date": 1514394202, "answer_id": 47995978, "question_id": 47995875, "link": "https://stackoverflow.com/questions/47995875/program-crashes-after-input-a-string-using-malloc/47995978#47995978", "title": "Program crashes after input a String using Malloc", "body": "<p>The major problem is that you are allocating memory for only 8 chars or 4 chars based on the size of pointer. (varies due to 32-64 bit systems). It is unlikely that your  string would hold in 4 or 8 char's with the NUL terminating character. And then you try to read string larger than this , you have illegal memory access...accessing something you didn't allocate. You clearly have undefined behavior.(In your case program crashed).</p>\n\n<p>Second problem is your checking of <code>malloc</code> shouldn't it be before you use it? Yes..but you didn't follow that. </p>\n\n<pre><code>sEnteredString = malloc(50);\nif( sEnteredString == NULL){\n\n /* error */\n}\nelse{\n   if( scanf(\"49%s\",sEnteredString)!= 1){\n     // error\n   }\n   // at this point you are happy that sEnteredString points to\n   // a nul terminated char array \n   // strlen can be used safely here.\n   size_t sizestring  = strlen(sEnteredString);\n\n}\n...\nfree(sEnteredString);\n</code></pre>\n\n<p>Yes another thing is you shouldn't cast the return value of <code>malloc</code> - it's redundant.</p>\n\n<p>Also note I have used <code>size_t</code> to hold return value of <code>strlen</code>. </p>\n\n<p>And yes easy way to check what you did will be</p>\n\n<pre><code>   if( strchr(\"aAeEiIoOuU\",sEnteredString[i]) != NULL ){\n     // you got a vowel\n   }\n</code></pre>\n\n<p>Also keep in mind one thing <code>strlen</code> is supposed to get a pointer to a null terminated char array. If you don't provide that you will have undefined behavior. </p>\n\n<h3>Code</h3>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint main(void)\n{\n    char * s;\n\n    s = malloc(50);  \n    if (s == NULL)\n    {\n        perror(\"Malloc failed\\n\");\n        exit(EXIT_FAILURE);\n    }\n    else\n    {\n        printf(\"A program that counts the number of vowels and consonants in a string\\n\");\n        printf(\"Enter a string:\\t\");\n\n        if(scanf(\"%49s\",s)!= 1){\n            fprintf(stderr, \"%s\\n\", \"Error in input\");\n            free(s);\n            exit(EXIT_FAILURE);\n        }\n        size_t sz = strlen(s);\n        size_t vowel = 0,consonants = 0;\n        for (size_t i=0; i&lt;sz; i++)\n        {\n            strchr(\"aAeEiIoOuU\",s[i]) ? vowel++ : consonants++;\n        }\n        printf(\"Entered vowel: %zu \\nEntered constants: %zu\\n\", vowel, consonants);\n    }\n    free(s);\n    return EXIT_SUCCESS;\n}\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 9146081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e391aa495e526adfea3efee4bbe1fbb?s=128&d=identicon&r=PG&f=1", "display_name": "JonnahMae", "link": "https://stackoverflow.com/users/9146081/jonnahmae"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "closed_date": 1514404259, "answer_count": 2, "score": 0, "last_activity_date": 1514397460, "creation_date": 1514393758, "last_edit_date": 1514393976, "question_id": 47995875, "link": "https://stackoverflow.com/questions/47995875/program-crashes-after-input-a-string-using-malloc", "closed_reason": "Not suitable for this site", "title": "Program crashes after input a String using Malloc", "body": "<p>The program crashed after entering a long string. I think the program cannot handle a large amount of string entered by the user. Can you help me whats wrong on my code?</p>\n\n<p>a simple C-program that counts the vowel and consonants in a string using pointers.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint main()\n{\n    char * sEnteredString= NULL;\n    int i;\n    int sizeString;\n    int vowel=0;\n    int consonants=0;\n\n    printf(\"A program that counts the number of vowels and consonants in a string\\n\");\n    printf(\"Enter a string:\\t\");\n    sEnteredString = (char*)malloc(sizeof(sEnteredString));\n    scanf(\" %s\",sEnteredString);\n\n    if (sEnteredString==NULL)\n    {\n        printf(\"OUT OF MEMORY\\n\");\n    }\n    else\n    {\n        sizeString=strlen(sEnteredString);\n\n        for (i=0; i&lt;sizeString;i++)\n        {\n            if((sEnteredString[i] == 'A') || \\\n               (sEnteredString[i] == 'a') || \\\n               (sEnteredString[i] == 'E') || \\\n               (sEnteredString[i] == 'e') || \\\n               (sEnteredString[i] == 'I') || \\\n               (sEnteredString[i] == 'i') || \\\n               (sEnteredString[i] == 'O') || \\\n               (sEnteredString[i] == 'o') || \\\n               (sEnteredString[i] == 'U') || \\\n               (sEnteredString[i] == 'u'))\n            {\n                vowel ++;\n            }\n            else\n            {\n                consonants ++;\n            }\n        }\n            printf(\"Entered vowel: %d \\nEntered constants: %d\\n\", vowel, consonants);\n    }\n\n    free(sEnteredString);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "pipe", "fifo"], "comments": [{"owner": {"reputation": 86, "user_id": 4495512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd16c6f89d9e53b5d07e690597d857d2?s=128&d=identicon&r=PG&f=1", "display_name": "Yuval_Shi", "link": "https://stackoverflow.com/users/4495512/yuval-shi"}, "edited": false, "score": 1, "creation_date": 1514393881, "post_id": 47995790, "comment_id": 82959836, "body": "It&#39;s &quot;console&quot; with a &#39;c&#39;. Please format your code correctly."}, {"owner": {"reputation": 37, "user_id": 9128892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62aa8c2ddd3dc1bd9660e033c0219db7?s=128&d=identicon&r=PG&f=1", "display_name": "DrJoe", "link": "https://stackoverflow.com/users/9128892/drjoe"}, "reply_to_user": {"reputation": 86, "user_id": 4495512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd16c6f89d9e53b5d07e690597d857d2?s=128&d=identicon&r=PG&f=1", "display_name": "Yuval_Shi", "link": "https://stackoverflow.com/users/4495512/yuval-shi"}, "edited": false, "score": 0, "creation_date": 1514396902, "post_id": 47995790, "comment_id": 82961004, "body": "emm... it is &quot;Konsole&quot; bud ;)"}, {"owner": {"reputation": 86, "user_id": 4495512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd16c6f89d9e53b5d07e690597d857d2?s=128&d=identicon&r=PG&f=1", "display_name": "Yuval_Shi", "link": "https://stackoverflow.com/users/4495512/yuval-shi"}, "edited": false, "score": 0, "creation_date": 1514404730, "post_id": 47995790, "comment_id": 82964148, "body": "Not in English. You can print a string into a log-file to see if you are reaching child#2. I think you should take off the &#39;2&#39; from main2 for starter."}], "owner": {"reputation": 37, "user_id": 9128892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62aa8c2ddd3dc1bd9660e033c0219db7?s=128&d=identicon&r=PG&f=1", "display_name": "DrJoe", "link": "https://stackoverflow.com/users/9128892/drjoe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1514398813, "creation_date": 1514393348, "last_edit_date": 1514398813, "question_id": 47995790, "link": "https://stackoverflow.com/questions/47995790/fifo-multiplying-console-windows", "title": "FIFO multiplying console windows", "body": "<p>Im trying to write a simple program:</p>\n\n<p>Parent process forks twice:\n(child#1):\nreads bytes from /dev/urandom, converts them to hex and writes to child#2</p>\n\n<p>(child#2):\nreads from child#1 and printsf output to screen</p>\n\n<p>The problem is when i run my program the first forking happens \"too many\" times...</p>\n\n<p>file1.c (PARENT)</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/stat.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;termios.h&gt;\n\n\nint pipe_table[2];\nint main(int argc, char *argv[])\n{\n    char bufforek[256];\n    int file;\n\n\n\n        printf(\"LOL...\\n\");\n        int pom=pipe(pipe_table);\n        FILE *file2 = fopen(\"/dev/urandom\", \"rb\");\n\n        file=open(\"FIFO\",O_RDWR);\n        mkfifo(\"FIFO\",0666);\n\n\n        if(fork()==0)\n        {\n            execlp(\"/usr/bin/konsole\", \"konsole\", \"-e\", \"./file2\", NULL);\n            return 0;\n        }\n        //while (fgets(bufforek, sizeof(bufforek), file2)) write(file, bufforek, sizeof(bufforek));\n\n        if(fork()==0)\n        {\n            dup(pipe_table[0]);\n            execlp(\"/usr/bin/konsole\", \"konsole\", \"-e\", \"./file3\", NULL);\n        }\n        wait(NULL);\n        while (fgets(bufforek, sizeof(bufforek), file2)) write(file, bufforek, sizeof(bufforek));\n\n\n        close(file);\n        unlink(\"FIFO\");\n\n\n    return 0;\n}\n</code></pre>\n\n<p>Child#1:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/stat.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;termios.h&gt;\n//#include \"./file.c\"\n\nint main(int argc, char *argv[])\n{\n  char bufforek[256];\n  int tunel;\n  tunel=open(\"FIFO\",O_RDWR);\n  int i=1;\n  char pom;\n  int pipe_table[2];\n  mkfifo(\"FIFO\",0666);\n  int hexa;\n\n  while(read(tunel,bufforek,sizeof(bufforek)))\n  {\n    pom = *bufforek;\n    // printf(\"%hhX \", pom);\n    write(pipe_table[1],bufforek,sizeof(bufforek));\n    hexa = (int)pom;\n    printf(\"%X \", hexa);\n    if (i==15)\n     {\n       printf(\"\\n\");\n       i=1;\n     }\n    else i++;\n\n  }\n\nprintf(\"\\n\\n\\n\\nYOLO\\n\");\nsleep(20);\n  return 0;\n}\n</code></pre>\n\n<p>Child#2:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/stat.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;termios.h&gt;\n#include \"file.c\"\n\n\nint main2(int argc, char *argv[])\n{\n    char pom;\n\n\n      int bufforek[256];\n\n       int i=1;\n\n\n        while(read(pipe_table[0],bufforek,sizeof(bufforek)))\n        {\n      pom = *bufforek;\n      printf(\"%hhX \", pom);\n            sleep(3);\n      if(i==15)\n      {\n        printf(\"\\n\");\n        i=1;\n      }\n      else i++;\n        }\n\n\n    //close(pipe_table[0]);\n    //close(pipe_table[1]);\n\n    return 0;\n}\n</code></pre>\n\n<p>Why Child#2 doesn't launch at all? Can anyone help?</p>\n\n<p>I think the problem is in line:</p>\n\n<pre><code>while (fgets(bufforek, sizeof(bufforek), file2)) write(file, bufforek, sizeof(bufforek));\n</code></pre>\n"}, {"tags": ["c", "memory", "struct", "dynamic-memory-allocation", "realloc"], "comments": [{"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1514389965, "post_id": 47994979, "comment_id": 82958034, "body": "<code>*cityList = realloc(*cityList</code> - This is bad form. What happens in <code>realloc</code> fails"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 1, "creation_date": 1514389998, "post_id": 47994979, "comment_id": 82958052, "body": "<i>Questions seeking debugging help (why isn&#39;t this code working?) must include the desired behavior, a specific problem or error and the shortest code necessary to reproduce it in the question itself. Questions without a clear problem statement are not useful to other readers. See: How to create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>.</i>"}, {"owner": {"reputation": 17958, "user_id": 1971013, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/EtqFE.jpg?s=128&g=1", "display_name": "meaning-matters", "link": "https://stackoverflow.com/users/1971013/meaning-matters"}, "edited": false, "score": 0, "creation_date": 1514390008, "post_id": 47994979, "comment_id": 82958056, "body": "In code supplied you only allocate pointers to <code>CITY</code>. You don&#39;t allocate space for any structure. Is that correct and do you allocate space for the actual <code>CITY</code> structures elsewhere?"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1514390038, "post_id": 47994979, "comment_id": 82958072, "body": "Specifically, how <code>*cityList</code> is allocated in first place?"}, {"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 0, "creation_date": 1514391280, "post_id": 47994979, "comment_id": 82958636, "body": "\u201cI tried running the debugger and it crashes at the line with realloc, when I call the function for the second time.\u201d Saying it \u201ccrashes\u201d isn\u2019t particularly helpful. What <i>specifically</i> does the debugger say?"}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 1, "creation_date": 1514391372, "post_id": 47994979, "comment_id": 82958677, "body": "Voting to close for not including all relevant code, especially the declaration of the <code>cityList</code> in <code>main()</code>."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 1, "creation_date": 1514391573, "post_id": 47994979, "comment_id": 82958764, "body": "What is <code>N</code>? You need to give an <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 1, "creation_date": 1514391606, "post_id": 47994979, "comment_id": 82958783, "body": "Yes, please update your question with an example where all <i>irrelevant</i> code has been removed, <i>but all relevant code (like the declaration of <code>cityList</code> in <code>main</code>, and anywhere you set <code>*cityList</code>) is present</i> (and verify that you still see the problem)."}], "answers": [{"tags": [], "owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "is_accepted": false, "score": 2, "last_activity_date": 1514391482, "last_edit_date": 1514391482, "creation_date": 1514390888, "answer_id": 47995221, "question_id": 47994979, "link": "https://stackoverflow.com/questions/47994979/realloc-a-structure-in-c/47995221#47995221", "title": "Realloc a structure in c", "body": "<p>You reallocate <code>sizeof(CITY*)</code></p>\n\n<p>That should be <code>sizeof(CITY)</code>, otherwise you allocate the size of a pointer.</p>\n\n<p>That wouldn't be a problem if <code>cityList</code> is an array of poinetrs to <code>CITY</code>s, but from your code I do not see you next allocate memory for each <code>CITY</code>. So <code>citylist</code> is apparently an array of <code>CITY</code>s.</p>\n\n<p>Because you assume <code>realloc</code> gave you storage for your struct, you started filling it with data. That will now overwrite the heap, causing your program to abort upon the next call to <code>realloc</code> because <code>realloc</code> now works on a corrupted heap.</p>\n"}, {"tags": [], "owner": {"reputation": 1755, "user_id": 5598992, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Nxbrw.png?s=128&g=1", "display_name": "Sagi Forbes", "link": "https://stackoverflow.com/users/5598992/sagi-forbes"}, "is_accepted": false, "score": 1, "last_activity_date": 1514391007, "creation_date": 1514391007, "answer_id": 47995248, "question_id": 47994979, "link": "https://stackoverflow.com/questions/47994979/realloc-a-structure-in-c/47995248#47995248", "title": "Realloc a structure in c", "body": "<p>In the realloc, you use sizeof(CITY*). It seems to me that you tried to get the size of the CITY struct. So your code does not do that.</p>\n\n<p>The size of CITY* is the size of the pointer holding the CITY struct, which is based on your system architecture (64 or 32 bit).\nThis way the content of CITY cannot pass between the reallocation, causing a memory buffer override and crashing the application.</p>\n\n<p>If you need the size of the CITY struct just use sizeof(CITY)</p>\n"}, {"comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1514391277, "post_id": 47995269, "comment_id": 82958635, "body": "The de facto error return in C is 0 (FALSE). Only in <code>exit</code> is a non-zero value used as the failure exit of the program to the OS."}, {"owner": {"reputation": 6673, "user_id": 4213662, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/693430827/picture?type=large", "display_name": "Persixty", "link": "https://stackoverflow.com/users/4213662/persixty"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1514391405, "post_id": 47995269, "comment_id": 82958692, "body": "@PaulOgilvie In all my experience <code>return 0;</code> is success (no error) and any non-zero value indicates an error. That allows error information to be encoded in the return value - if useful. The same rule applies to <code>exit()</code> for the same rationale. It makes sense if you see the return value as an error code as false as &#39;False. There was no error&#39;."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1514391680, "post_id": 47995269, "comment_id": 82958813, "body": "Think of it as a bool, with 0 is false and non-zero is true. You may be using another convention, but that is not standard C in my experience. E.g. <code>if (myFunc())</code> must now be coded as <code>if (!myFunc())</code> which clearly reads oposite of the meaning."}, {"owner": {"reputation": 6673, "user_id": 4213662, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/693430827/picture?type=large", "display_name": "Persixty", "link": "https://stackoverflow.com/users/4213662/persixty"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1514392062, "post_id": 47995269, "comment_id": 82958983, "body": "@PaulOgilvie I&#39;m surprised. I&#39;ve never seen widespread use of 0 as failure in C code. I know it&#39;s slightly counter intuitive but as I said it allows richer error information. In the example one number could be &#39;out of memory&#39; and another &#39;file read error&#39;. But it is only norm. Tastes vary."}, {"owner": {"reputation": 6673, "user_id": 4213662, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/693430827/picture?type=large", "display_name": "Persixty", "link": "https://stackoverflow.com/users/4213662/persixty"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1514392317, "post_id": 47995269, "comment_id": 82959097, "body": "@PaulOgilvie Here&#39;s a thought. My background in Windows and the convention is pretty much institutionalised there. What&#39;s yours? <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa378137(v=vs.85).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/windows/desktop/&hellip;</a>.  See also <a href=\"https://en.wikipedia.org/wiki/HRESULT\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/HRESULT</a>"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 1, "creation_date": 1514395011, "post_id": 47995269, "comment_id": 82960323, "body": "@PaulOgilvie: My bet goes on <code>-1</code> to indicate an error in C. And: What is <code>FALSE</code>? ;-)"}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "reply_to_user": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1514398238, "post_id": 47995269, "comment_id": 82961548, "body": "@alk, <code>#define FALSE 0</code> and <code>#define TRUE 1</code>. Also: <code>#define VB_FALSE -1</code> which is either &quot;Variant Boolean FALSE&quot; or &quot;Visual Basic False&quot; and <code>#define VB_TRUE 0</code>. The fact that Micosoft uses that convention doesn&#39;t mean it is standard. If it were standard than the C standard would have defined true and false of boolean expresions differently."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "reply_to_user": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1514398527, "post_id": 47995269, "comment_id": 82961668, "body": "@alk, Note that error returns can indeed be coded but then any value can be success and any value can be error. If you deviate from the C interpretation of true and false boolean expressions of ints, then you should compare the function return to a value and not ever write <code>if (!myFunc())</code> to test for success, butalways write <code>if (myFunc()==MY_SUCCESS)</code>. Alternatively error information can be passed in global variables of the module, just like <code>errno</code>."}], "tags": [], "owner": {"reputation": 6673, "user_id": 4213662, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/693430827/picture?type=large", "display_name": "Persixty", "link": "https://stackoverflow.com/users/4213662/persixty"}, "is_accepted": false, "score": 1, "last_activity_date": 1514391445, "last_edit_date": 1514391445, "creation_date": 1514391106, "answer_id": 47995269, "question_id": 47994979, "link": "https://stackoverflow.com/questions/47994979/realloc-a-structure-in-c/47995269#47995269", "title": "Realloc a structure in c", "body": "<p>You're making a common mistake of allocating space for a pointer to <code>CITY</code> not the structure itself. You need to allocate <code>sizeof(CITY)</code>.</p>\n\n<p>But there's a couple of other points to make...</p>\n\n<pre><code>cityList = NULL;//No need allocate anything up front.\ndimCities=0u; //I'll assume this is size_t.\n for(...){\n     ...\n     if(next_city(&amp;cityList, &amp;dimCities /*, otherstuff*/)){\n         //There was an error. What to do now?\n     }\n }\n</code></pre>\n\n<p>And</p>\n\n<pre><code>int next_city(CITY** cityList, size_t *dimCities/*, otherstuff*/){\n    (*dimCities)++;\n    CITY* newList = realloc(*cityList, (*dimCities) * sizeof(CITY));\n    if(newList==NULL){\n        //out of memory..\n        return 1;//Error return...\n    }\n    *cityList=newList;\n\n    otherstuff...\n    return 0;//Good return...\n}\n</code></pre>\n\n<p>If you pass <code>NULL</code> to <code>realloc</code> it acts like <code>malloc()</code>.\nI don't know how you propose to handle errors but if there's insufficient memory to reallocate <code>realloc()</code> does nothing and returns <code>NULL</code>.\nYour way of allocating one object up front is fine. But personally this way is cleaner. Allocating at least one <code>CITY</code> may suit you because you never need to deal with <code>cityList==NULL</code>. </p>\n\n<p>If this is a simple program you might just give up and <code>exit()</code> at this point. I've returned a error flag (a de facto C standard) so the surrounding program can handle it.</p>\n"}, {"comments": [{"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1514394731, "post_id": 47995504, "comment_id": 82960218, "body": "&quot;<i>Assuming you are wanting to simply reallocate an array of pointers</i>&quot; why? <code>CITY * citylist</code> would not allow doing so."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 1, "creation_date": 1514394897, "post_id": 47995504, "comment_id": 82960274, "body": "In C only values of <code>void</code>-pointers may be printed. <code>u</code> is for unsigned integers. To print a <code>void</code>-pointer use <code>p</code> and cast the pointer to <code>void*</code>."}], "tags": [], "owner": {"reputation": 72, "user_id": 8900754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZDhvL.jpg?s=128&g=1", "display_name": "dernst", "link": "https://stackoverflow.com/users/8900754/dernst"}, "is_accepted": false, "score": -1, "last_activity_date": 1514472589, "last_edit_date": 1514472589, "creation_date": 1514392127, "answer_id": 47995504, "question_id": 47994979, "link": "https://stackoverflow.com/questions/47994979/realloc-a-structure-in-c/47995504#47995504", "title": "Realloc a structure in c", "body": "<p>Assuming you are wanting to simply reallocate an array of pointers (to CITY) then the following works when I tested it. But as someone mentioned above, perhaps you want to have an array of CITY then you would want to allocate memory for CITY as well. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\ntypedef struct{\n    char name[10];\n    int dimToys;\n    int toys[10];\n} CITY;\n\nvoid next_city(CITY *** cityList, int *dimCities) {\n    (*dimCities)++;\n    *cityList = realloc(*cityList, (*dimCities) * sizeof(CITY*));\n}\n\nmain(){\n    CITY ** cityList;\n    int dimCities=0;\n    int i;\n\n    cityList = malloc(sizeof(CITY*));\n    printf(\"%p\\n\",  (void *) cityList); // print out the address of the memory allocated\n    for (i = 0 ; i &lt; 10; i++){\n        next_city(&amp;cityList, &amp;dimCities);\n        malloc(1);  // malloc more data to force some fragmenation so that you can see that realloc does something interesting.\n        printf(\"%p\\n\",  cityList); // print out the address of the reallocated memory\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 9145811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cdf9c192a6a253bf37d0f8b4b73ea75b?s=128&d=identicon&r=PG&f=1", "display_name": "Andrei Trasca", "link": "https://stackoverflow.com/users/9145811/andrei-trasca"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1682, "favorite_count": 0, "answer_count": 4, "score": 2, "last_activity_date": 1514472589, "creation_date": 1514389899, "last_edit_date": 1514403445, "question_id": 47994979, "link": "https://stackoverflow.com/questions/47994979/realloc-a-structure-in-c", "title": "Realloc a structure in c", "body": "<p>So what I try to do is to dynamically allocate memory for a structure. The structure looks like this:</p>\n\n<pre><code>typedef struct{\n   char name[N];\n   int dimToys;\n   TOY toys[N];\n}CITY;\n</code></pre>\n\n<p>I read some input from a .txt file and copy it in my structure.</p>\n\n<p>Then I have a function in which I would like to reallocate memory(and do some other irrelevant stuff) but my program works only when I use this function one single time. If I try to realloc the memory multiple times, then my program crashes.</p>\n\n<p>It looks something like this:</p>\n\n<pre><code>void next_city(CITY** cityList, *dimCities, otherstuff){\n    (*dimCities)++;\n    *cityList = realloc(*cityList, (*dimCities) * sizeof(CITY*));\n    otherstuff...\n}\n</code></pre>\n\n<p>I tried running the debugger and it crashes at the line with realloc, when I call the function for the second time.\nThe call of the function in the main function looks like this:</p>\n\n<pre><code> cityList = malloc(sizeof(CITY*));\n for(...){\n     ...\n     next_city(&amp;cityList, &amp;dimCities, otherstuff);\n }\n</code></pre>\n\n<p>I've already tried using a temporary variable for the reallocation and then copy it in my original <code>cityList</code>, but it doesn't work neither.</p>\n\n<p><strong>LATER EDIT:</strong></p>\n\n<p>Because a lot of people told me to update my question with some clarifications, I'll just show my code more clear, after I made some modifications from what you all told me.</p>\n\n<pre><code>void next_city(char line[], CITY **cityList, int *dimCities){\n(*dimCities)++;\n*cityList = realloc(*cityList, (*dimCities) * sizeof(CITY)); //UPDATE CITYLIST DIMENSION\ncityList[(*dimCities) - 1]-&gt;dimToys = 0;\n\nchar *word = strtok(line, \" \");\nstrcpy((cityList[(*dimCities) - 1]-&gt;name), word); //INSERET NAME OF THE CITY\nword = strtok(NULL, \" \");\nstrcpy((cityList[(*dimCities) - 1]-&gt;toys[cityList[(*dimCities) - 1]-&gt;dimToys].toyType), word); //INSERT NAME OF THE TOY\n</code></pre>\n\n<p>}</p>\n\n<pre><code>int main(){\nint nrPasi;\nint dimCities = 0;\nscanf(\"%d\", &amp;nrPasi);\nfgetc(stdin);\nint i;\nCITY *cityList;\ncityList = NULL;\n\nchar line[100];\nfor(i = 0;i &lt; nrPasi;i++){\n    fgets(line, 100, stdin);\n    next_city1(line, &amp;cityList, &amp;dimCities);\n}\nreturn 0;\n</code></pre>\n\n<p>}</p>\n\n<p>So I basically read something like</p>\n\n<pre><code>3 \nBerlin car\nBerlin doll \nMadrid jacket\n</code></pre>\n\n<p>And I just want to read it step by step.\nAfter I switched CITY* with CITY now realloc doesn't break my program, but it happens on the next line, when I try to access it. I get SISGEV</p>\n"}, {"tags": ["c", "arm", "embedded", "sdl", "embedded-linux"], "comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 1, "creation_date": 1514389890, "post_id": 47994946, "comment_id": 82957996, "body": "Please approach a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>, as far as that is possible for a cross-compile siutation."}, {"owner": {"reputation": 181, "user_id": 2087573, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/LMQj0.gif?s=128&g=1", "display_name": "Ofer Orgal", "link": "https://stackoverflow.com/users/2087573/ofer-orgal"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1514450620, "post_id": 47994946, "comment_id": 82976595, "body": "I added my code. In my embedded system, I added to /lib the file libSDL-1.2.so.0"}, {"owner": {"reputation": 15473, "user_id": 744720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65030f1bd22dbb4d1e6976cfac08a1c5?s=128&d=identicon&r=PG", "display_name": "keltar", "link": "https://stackoverflow.com/users/744720/keltar"}, "edited": false, "score": 1, "creation_date": 1514451057, "post_id": 47994946, "comment_id": 82976798, "body": "I don&#39;t think your <code>system()</code> calls do anything as they execute in child shell. Use <code>setenv()</code>. Can you use debugger to see what it waits for?"}, {"owner": {"reputation": 181, "user_id": 2087573, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/LMQj0.gif?s=128&g=1", "display_name": "Ofer Orgal", "link": "https://stackoverflow.com/users/2087573/ofer-orgal"}, "edited": false, "score": 0, "creation_date": 1514474273, "post_id": 47994946, "comment_id": 82988198, "body": "I edited my question"}, {"owner": {"reputation": 181, "user_id": 2087573, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/LMQj0.gif?s=128&g=1", "display_name": "Ofer Orgal", "link": "https://stackoverflow.com/users/2087573/ofer-orgal"}, "edited": false, "score": 0, "creation_date": 1514709701, "post_id": 47994946, "comment_id": 83052592, "body": "Anyone knows why I have a limit on my screen resolution?"}], "owner": {"reputation": 181, "user_id": 2087573, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/LMQj0.gif?s=128&g=1", "display_name": "Ofer Orgal", "link": "https://stackoverflow.com/users/2087573/ofer-orgal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 270, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1594899678, "creation_date": 1514389746, "last_edit_date": 1514474259, "question_id": 47994946, "link": "https://stackoverflow.com/questions/47994946/working-with-sdl-on-hisilicon-hi3516", "title": "Working with SDL on Hisilicon - Hi3516", "body": "<p>I'm trying to use SDL library on my Hi3516 chip.</p>\n\n<p>I'm able to compile my code (after setting the SDL config to <code>arm-hisiv300-linux-gcc</code>).</p>\n\n<p>My code is:</p>\n\n<pre><code>int main(int argc, char *argv[]){\n    SDL_Surface *screen;\n    SDL_Event event;\n\n    int keypress = 0;\n    int h=0; \n    setenv(\"SDL_FBDEV\", \"/dev/fb0\", 1);\n    setenv(\"SDL_VIDEODRIVER\", \"fbcon\", 1);\n    setenv(\"SDL_MOUSEDEV\", \"/dev/input/event0\", 1);\n    if (SDL_Init(SDL_INIT_VIDEO) &lt; 0 ){\n        printf(\"BBB %s\\n\", SDL_GetError());\n        return 1;\n    }\n    if (!(screen = SDL_SetVideoMode(WIDTH, HEIGHT, DEPTH, \n        SDL_FULLSCREEN|SDL_HWSURFACE)))\n    {\n        printf(\"SDL_SetVideoMode fail\\n\");\n        printf(\"BBB %s\\n\", SDL_GetError());\n        SDL_Quit();\n        return 1;\n    }\n    printf(\"SDL_SetVideoMode pass\\n\");\n    SDL_Flip(screen); \n    SDL_Quit();\n    return 1;\n}\n</code></pre>\n\n<p>I see a small mouse cursor that moves when I move my mouse but in an not regular way.\nPlus, my screen resolution is 1920x1080 but it only allows me to set it to 640x480.</p>\n\n<p>I can elaborate about my code and my embedded system if anyone can help.</p>\n\n<p>Does someone have a sample code that uses SDL on Hi3516 chip?</p>\n"}, {"tags": ["c", "pointers", "structure"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1514387453, "post_id": 47994401, "comment_id": 82956959, "body": "You have to pass a pointer to the pointer to the function for the changes made in the function to affect the calling code.  It\u2019s a very common mistake in novice C code. It\u2019s a duplicate many roomed over."}], "answers": [{"tags": [], "owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "is_accepted": true, "score": 3, "last_activity_date": 1514387706, "last_edit_date": 1514387706, "creation_date": 1514387360, "answer_id": 47994420, "question_id": 47994401, "link": "https://stackoverflow.com/questions/47994401/allocate-structure-and-fill-fields-when-passed-by-reference-to-a-function/47994420#47994420", "title": "Allocate structure and fill fields when passed by reference to a function", "body": "<p>Well because C is pass by value so any change you made is to the local pointer variable. <code>main()</code> has nothing to do with it. If you return that pointer and assign it to one you want to change it would work.</p>\n\n<p>Or pass address of it and make changes to the original variable.</p>\n\n<pre><code>struct_constructor(&amp;myStruct, 1);\n</code></pre>\n\n<p>And</p>\n\n<pre><code>int struct_constructor(test_struct** myStruct, unsigned int field)\n{\n    *myStruct = malloc(sizeof(test_struct));\n\n    if(NULL == *myStruct)\n    {\n        ERROR(\"Error allocating memory for myStruct\\n\");\n        return ERR_MALLOC_FAIL;\n    }\n\n    INFO(\"passed field = %d\\n\", field);\n\n    myStruct-&gt;field = field;\n\n    INFO(\"struct field = %d\\n\", (*myStruct)-&gt;field);\n\n    return ERR_OK;\n}\n</code></pre>\n"}], "owner": {"reputation": 773, "user_id": 7991581, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/f0ffccced69419766694f1774f275a3a?s=128&d=identicon&r=PG&f=1", "display_name": "Arkaik", "link": "https://stackoverflow.com/users/7991581/arkaik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "closed_date": 1514389071, "accepted_answer_id": 47994420, "answer_count": 1, "score": 0, "last_activity_date": 1514387706, "creation_date": 1514387272, "question_id": 47994401, "link": "https://stackoverflow.com/questions/47994401/allocate-structure-and-fill-fields-when-passed-by-reference-to-a-function", "closed_reason": "Duplicate", "title": "Allocate structure and fill fields when passed by reference to a function", "body": "<p>I'm trying to fill a structure field from a function to which the structure is given by pointer.</p>\n\n<p>After allocating the structure with malloc the returned pointer is non null and the structure field is well initialized, however after returning to main. The pointer I passed to the function is null.</p>\n\n<p>Here a  simplified example</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n\n#define INFO(fmt, args...)      printf(fmt, ## args);\n#define ERROR(fmt, args...)     printf(\"In %s : \" fmt, __func__, ## args);\n\ntypedef enum \n{\n    ERR_OK = 0,\n    ERR_KO = -1,\n    ERR_MALLOC_FAIL = -2,\n\n}error_t;\n\ntypedef struct \n{\n    unsigned int field;\n}test_struct;\n\nint struct_constructor(test_struct* myStruct, unsigned int field)\n{\n    myStruct = malloc(sizeof(test_struct));\n\n    if(NULL == myStruct)\n    {\n        ERROR(\"Error allocating memory for myStruct\\n\");\n        return ERR_MALLOC_FAIL;\n    }\n\n    INFO(\"passed field = %d\\n\", field);\n\n    myStruct-&gt;field = field;\n\n    INFO(\"struct field = %d\\n\", myStruct-&gt;field);\n\n    return ERR_OK;\n}\n\nint main(void)\n{\n    test_struct* myStruct = NULL;\n\n    struct_constructor(myStruct, 1);\n\n    if(myStruct == NULL)\n    {\n        INFO(\"NULL structure in main\\n\");\n    }\n}\n</code></pre>\n\n<p>And here is the output : </p>\n\n<pre><code>passed field = 1\nstruct field = 1\nNULL structure in main\n</code></pre>\n\n<p>I don't understand why the structure's pointer is not null inside the function and is null in main. <br/>\nAlso I don't want to return the pointer as I'm using return code to check what's going wrong in my functions.</p>\n"}, {"tags": ["c", "path", "exec", "search-path"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1514386580, "post_id": 47993871, "comment_id": 82956559, "body": "Either put your programs in a directory that is on your <code>$PATH</code> or put the directory where the programs are on your <code>$PATH</code>, or use an appropriate pathname (relative or absolute) to identify the program to be run."}], "answers": [{"comments": [{"owner": {"reputation": 110, "user_id": 3078197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8681e2a9277b586e78b73f03a84d3edf?s=128&d=identicon&r=PG&f=1", "display_name": "LenweSeregon", "link": "https://stackoverflow.com/users/3078197/lenweseregon"}, "edited": false, "score": 0, "creation_date": 1514392582, "post_id": 47995370, "comment_id": 82959206, "body": "Oh yeah it\u2019s exactly what i was looking for ! Thank you everything is working now !"}], "tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": true, "score": 2, "last_activity_date": 1514391552, "creation_date": 1514391552, "answer_id": 47995370, "question_id": 47993871, "link": "https://stackoverflow.com/questions/47993871/allow-program-to-be-executed-with-execvp/47995370#47995370", "title": "Allow program to be executed with execvp", "body": "<p>To allow a program to be executed with <code>execvp()</code>, you must:</p>\n\n<ul>\n<li>Either put your programs in a directory already on your <code>$PATH</code>,</li>\n<li>Or put the directory where the programs live on your <code>$PATH</code>,</li>\n<li>Or arrange to use the absolute pathname to the programs (<code>/some/where/useful/myLs</code>),</li>\n<li>Or arrange to use a correct relative pathname to the programs (<code>../useful/myLs</code> or even <code>./myLs</code>).</li>\n</ul>\n\n<p>Note that <code>execvp()</code> only searches on <code>$PATH</code> when the command name it sees contains no <code>/</code> (so <code>./myLs</code> stops it looking on <code>$PATH</code>).  The relative names are typically least useful; if you change directory, it is likely that the relative pathname changes.</p>\n\n<p>In case of doubt, make sure you have a directory <code>$HOME/bin</code>, put your programs in there (or symlinks to your programs in there), and add <code>$HOME/bin</code> to your path.  It lives at the front of my PATH; I assume I know what I'm doing.</p>\n"}], "owner": {"reputation": 110, "user_id": 3078197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8681e2a9277b586e78b73f03a84d3edf?s=128&d=identicon&r=PG&f=1", "display_name": "LenweSeregon", "link": "https://stackoverflow.com/users/3078197/lenweseregon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "accepted_answer_id": 47995370, "answer_count": 1, "score": 0, "last_activity_date": 1514391748, "creation_date": 1514384872, "last_edit_date": 1514391748, "question_id": 47993871, "link": "https://stackoverflow.com/questions/47993871/allow-program-to-be-executed-with-execvp", "title": "Allow program to be executed with execvp", "body": "<p>I'm creating a shell copy and I have a problem to executable an homemade program. I mean, everything is OK when I want to execute somethings like <code>java</code>, <code>ls</code>, <code>wc</code>, etc... everything that is already present in the PATH variable. </p>\n\n<p>Now I want to be able to execute a \"myls\" command which is a copy of the original <code>ls</code>. The thing is that my program isn't registered in PATH variable, so when I try to <code>execvp(\"myls\", \u2026)</code>, I get an error \"no such file or directory\".</p>\n\n<p>I would like to know how can I manage this problem and be able to execute my command according this hierarchy :</p>\n\n<pre><code>src\ninclude\nbin\nmakefile\nexecutable &lt;- this one is my main executable\nmyLs\n    executableLS &lt;- would like to be able to call this one through execvp\nmyPs\n    executablePS &lt;- would like to be able to call this one through execvp\n</code></pre>\n"}, {"tags": ["c", "arrays", "pointers"], "comments": [{"owner": {"reputation": 1360, "user_id": 6593789, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-nfq6l0wyldk/AAAAAAAAAAI/AAAAAAAABY0/mHRz3aBVoLU/photo.jpg?sz=128", "display_name": "random_coder_101", "link": "https://stackoverflow.com/users/6593789/random-coder-101"}, "reply_to_user": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "edited": false, "score": 0, "creation_date": 1514386084, "post_id": 47993839, "comment_id": 82956352, "body": "@coderredoc What do you mean by full code? Is there something specific you want to see?"}, {"owner": {"reputation": 1360, "user_id": 6593789, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-nfq6l0wyldk/AAAAAAAAAAI/AAAAAAAABY0/mHRz3aBVoLU/photo.jpg?sz=128", "display_name": "random_coder_101", "link": "https://stackoverflow.com/users/6593789/random-coder-101"}, "reply_to_user": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "edited": false, "score": 0, "creation_date": 1514386323, "post_id": 47993839, "comment_id": 82956458, "body": "So, do you need me to post the code where I am actually building the struct by assigning values? I&#39;m just confused which part of the code you want me to post, sorry."}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 1, "creation_date": 1514386557, "post_id": 47993839, "comment_id": 82956549, "body": "Again: ideally, you&#39;ll post an <a href=\"https://stackoverflow.com/help/mcve\">MCVE</a>, i.e. <b>all</b> the code that readers need to replicate the problem, and no more code than that."}, {"owner": {"reputation": 1360, "user_id": 6593789, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-nfq6l0wyldk/AAAAAAAAAAI/AAAAAAAABY0/mHRz3aBVoLU/photo.jpg?sz=128", "display_name": "random_coder_101", "link": "https://stackoverflow.com/users/6593789/random-coder-101"}, "reply_to_user": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1514386826, "post_id": 47993839, "comment_id": 82956668, "body": "Okay, updated the question again. This should be enough to produce an MVCE."}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 2, "creation_date": 1514387009, "post_id": 47993839, "comment_id": 82956748, "body": "Thanks, but an MCVE is not something that readers should have to &quot;produce&quot; from materials you give them; it&#39;s a single piece of code they can immediately copy/paste and compile. In other words, there would be a <code>main()</code> function that would perform whatever steps you currently are and that replicate the issue. That&#39;s not this: for example, <code>DArray_create()</code> is totally missing, so what&#39;s the point of readers trying to guess what it&#39;s doing and how that may affect the observed output? Anyway, your &#39;good&#39; and &#39;bad&#39; examples are very different: the &#39;bad&#39; one prints <code>char</code>s as if <code>int</code>s, which is UB"}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 1, "creation_date": 1514387186, "post_id": 47993839, "comment_id": 82956832, "body": "The <i>intention</i> of the code is not very clear. Do you want to construct some kind of &quot;universal container&quot; ? (then:  <i>why</i> the <code>void**</code> ??)"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1514387315, "post_id": 47993839, "comment_id": 82956902, "body": "We shouldn\u2019t have to produce an MCVE; you should produce an MCVE. We can\u2019t tell what weird thing you\u2019ve done that we haven\u2019t guessed that is breaking things.  You don\u2019t seem to set <code>element_size</code> in the structure.  Is that part of the problem?"}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1514387482, "post_id": 47993839, "comment_id": 82956973, "body": "Also, what is the precise purpose of this overly elaborate dance? <code>*((char *)contents + (i * sizeof(int)))</code> Why not just index? You already did elsewhere. Do you have some grander plan that mandates such opaque code instead of the simpler solutions that everyone will keep recommending if you don&#39;t explain what you&#39;re trying to do and why?"}, {"owner": {"reputation": 1360, "user_id": 6593789, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-nfq6l0wyldk/AAAAAAAAAAI/AAAAAAAABY0/mHRz3aBVoLU/photo.jpg?sz=128", "display_name": "random_coder_101", "link": "https://stackoverflow.com/users/6593789/random-coder-101"}, "edited": false, "score": 0, "creation_date": 1514388282, "post_id": 47993839, "comment_id": 82957289, "body": "Okay, I have taken the comments into consideration, and tried once again to post an MVCE. This code should compile directly. Apologies for all the opaqueness earlier. Wasn&#39;t aware how much of a pain it was going to be to figure out how the code works."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1514388769, "post_id": 47993839, "comment_id": 82957517, "body": "Sry, had to rollback your last edit. As changing the question massively after answers /comments had been given might render those ununderstandable. Please add &quot;changes&quot; as additions."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 2, "creation_date": 1514399659, "post_id": 47993839, "comment_id": 82962130, "body": "<code>(arr + i * sizeof(int))</code> is non standard conforming."}], "answers": [{"tags": [], "owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "is_accepted": false, "score": 3, "last_activity_date": 1514402466, "last_edit_date": 1514402466, "creation_date": 1514387548, "answer_id": 47994464, "question_id": 47993839, "link": "https://stackoverflow.com/questions/47993839/how-to-reference-a-pointer-from-a-function/47994464#47994464", "title": "How to reference a pointer from a function?", "body": "<p>Here </p>\n\n<pre><code>DArray_push(result, (arr + i * sizeof(int)));\n</code></pre>\n\n<p>you pass addresses of a <em>local</em> variable, namely <code>initial</code>.</p>\n\n<p>The stuff they point to is dead and gone when <code>create_array()</code> had been left.</p>\n\n<p>No matter what you try those values pointed to may not be accessed any more then.</p>\n\n<hr>\n\n<p>Assuming the former would not be an issue, you do not treat the <code>int*</code>s stored as such when printing them here:</p>\n\n<pre><code>   printf(\"Value: %d\\n\", *((char *)contents + (i * sizeof(int))))\n</code></pre>\n\n<p>But instead of casting the <code>void</code>-pointers back to <code>int*</code>, the code casts them  back the to <code>char*</code> and dereferences them.</p>\n\n<hr>\n\n<p>Also you define</p>\n\n<pre><code>void *arr = ...\n</code></pre>\n\n<p>and afterwards apply pointer arithmetic to the <code>void</code>-pointer <code>arr</code>:</p>\n\n<pre><code>   *(int *)(arr + i * sizeof(int)) = ...\n</code></pre>\n\n<p>Doing so is <em>not</em> defined by the C Standard, but a vendor specific extension to the language.</p>\n"}], "owner": {"reputation": 1360, "user_id": 6593789, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-nfq6l0wyldk/AAAAAAAAAAI/AAAAAAAABY0/mHRz3aBVoLU/photo.jpg?sz=128", "display_name": "random_coder_101", "link": "https://stackoverflow.com/users/6593789/random-coder-101"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1514402466, "creation_date": 1514384746, "last_edit_date": 1514388682, "question_id": 47993839, "link": "https://stackoverflow.com/questions/47993839/how-to-reference-a-pointer-from-a-function", "title": "How to reference a pointer from a function?", "body": "<p>So, I have the following struct</p>\n\n<pre><code>typedef struct DArray {\n  int end;\n  int max;\n  size_t element_size;\n  size_t expand_rate;\n  void **contents;\n} DArray;\n</code></pre>\n\n<p><strong>The reason I am using <code>void **contents</code> is because that's the way I have been told to reference the array from within the struct</strong></p>\n\n<p>Here is how I am pushing values into contents</p>\n\n<pre><code>DArray *create_array() {\n  DArray *result = DArray_create(sizeof(int), 5);\n  int initial[] = {4,1,3,2,0};\n\n  void *arr = (void *)(malloc(sizeof(void *) * 5));\n  int i = 0;\n  for(i = 0; i &lt; 5; i++) {\n    *(int *)(arr + i * sizeof(int)) = initial[i];\n  }\n  for(i = 0; i &lt; 5; i++) {\n    printf(\"Pushing: %d\\n\", *(int *)(arr + i*sizeof(int)));\n    DArray_push(result, (arr + i * sizeof(int)));\n  }\n  return result;\n}\n\nint DArray_push(DArray *array, void *el) {\n    array-&gt;contents[array-&gt;end] = el;\n    array-&gt;end++;\n\n    if(DArray_end(array) &gt; DArray_max(array)) {\n      return DArray_expand(array);\n    } else {\n      return 0;\n    }\n}\n</code></pre>\n\n<p>I am then calling a quicksort function like so </p>\n\n<pre><code>int DArray_qsort(DArray *array, DArray_compare cmp) {\n  quicksort(array-&gt;contents, DArray_count(array), sizeof(void *), cmp);\n  return 0;\n}\n</code></pre>\n\n<p>Then I try to iterate over <code>array-&gt;contents</code> using the following function</p>\n\n<pre><code>void quicksort(void *contents, int count, size_t elem, DArray_compare cmp) {\n  int i = 0;\n  for(i = 0; i &lt; count; i++) {\n    printf(\"Value: %d\\n\", *((char *)contents + (i * sizeof(int))));\n  }\n  return;\n}\n</code></pre>\n\n<p>But, I end up with garbage values</p>\n\n<p>However, the following seems to work </p>\n\n<pre><code>int DArray_qsort(DArray *array, DArray_compare cmp) {\n  quicksort(array, DArray_count(array), sizeof(void *), cmp);\n  return 0;\n}\nvoid quicksort(DArray *array, int count, size_t elem, DArray_compare cmp) {\n  int i = 0;\n  for(i = 0; i &lt; count; i++) {\n    printf(\"Value: %d\\n\", *(int *)(array-&gt;contents[i]));\n  }\n  return;\n}\n</code></pre>\n\n<p>Why is this the case? </p>\n"}, {"tags": ["c", "undefined-behavior", "unspecified-behavior"], "comments": [{"owner": {"reputation": 37256, "user_id": 736308, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/o5EqQ.jpg?s=128&g=1", "display_name": "cdarke", "link": "https://stackoverflow.com/users/736308/cdarke"}, "edited": false, "score": 2, "creation_date": 1514385129, "post_id": 47993765, "comment_id": 82955915, "body": "What you can&#39;t trust across platforms is the exact layout of bitfields: <i>&quot;&quot;Almost everything about bitfields is implementation dependent&quot;</i> K&amp;R page 150."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1514385660, "post_id": 47993765, "comment_id": 82956144, "body": "Your question is IMHO too general to get a useful answer. You should explain what actual compiler and platform you use, and what is exactly your <code>struct S</code>."}, {"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "reply_to_user": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1514385994, "post_id": 47993765, "comment_id": 82956313, "body": "@BasileStarynkevitch Yeah, but I decided on alternative, hopefully robust approach."}], "answers": [{"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1514386938, "post_id": 47993830, "comment_id": 82956714, "body": "Note that padding bytes (or bits) within the structure have indeterminate values and while the <code>memset()</code> calls are not a problem, the <code>memcmp()</code> calls are not reliable because of them."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1514921412, "post_id": 47993830, "comment_id": 83106710, "body": "@JonathanLeffler: Action which modify a structure using its type might arbitrarily change the value of bytes which don&#39;t represent structure members.  On the other hand, if code uses memcpy to make two copies of a structure without having done anything else to it in the interim, I think the copies should be guaranteed to compare equal unless or until one (or both) of them is modified."}], "tags": [], "owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "is_accepted": true, "score": 1, "last_activity_date": 1514385819, "last_edit_date": 1514385819, "creation_date": 1514384710, "answer_id": 47993830, "question_id": 47993765, "link": "https://stackoverflow.com/questions/47993765/is-this-memset-memcmp-on-a-struct-variable-valid-c/47993830#47993830", "title": "Is this memset-memcmp on a struct variable valid C?", "body": "<blockquote>\n  <p>Is it legal to memset a struct to some value, then compare it with memcmp?</p>\n</blockquote>\n\n<p>Yes, since all of <a href=\"http://en.cppreference.com/w/c/string/byte/memset\" rel=\"nofollow noreferrer\">memset</a>, <a href=\"http://en.cppreference.com/w/c/string/byte/memcmp\" rel=\"nofollow noreferrer\">memcmp</a>, <a href=\"http://en.cppreference.com/w/c/string/byte/memcpy\" rel=\"nofollow noreferrer\">memcpy</a> are documented to work on arbitrary memory zones (provided the pointer and the size passed to them are pointing to a valid memory zone).</p>\n\n<p>However, in some cases, that might not be meaningful. For example, if you <code>memcpy</code> from some <em>uninitialized</em> memory, you'll get garbage in the destination, and using that garbage might be <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behavior</a>.</p>\n\n<p>You are using <code>memset</code> with <code>0xff</code>. In theory, you might have some implementations where a <code>char</code> is larger than 8 bits (but in practice that does not happen so you don't care).</p>\n\n<p>You might in theory have some implementation having trap representations for integral value. In practice, that does not happen.</p>\n\n<p>If you use <code>memcmp</code> on structures having <a href=\"https://en.wikipedia.org/wiki/Data_structure_alignment\" rel=\"nofollow noreferrer\">padding</a> that might not work as you expect. You may want to dive into the <a href=\"https://en.wikipedia.org/wiki/Application_binary_interface\" rel=\"nofollow noreferrer\">ABI</a> specification of your platform to understand how they are implemented (and bitfields might not be specified in your ABI and be compiler specific).</p>\n\n<p>I believe that in practice you need to understand well the exact layout of your particular <code>struct</code> with your particular compiler. It looks like your code might be hardware specific, then you don't care that much about portability. So in practice your <code>struct S</code> is <em>very</em> relevant (perhaps avoiding bitfields in it would be \"safer\").</p>\n"}, {"comments": [{"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 1, "creation_date": 1514385231, "post_id": 47993923, "comment_id": 82955953, "body": "Do you mean, for example, if there are padding bits, their values might change? Or something else/more?"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 2, "creation_date": 1514385445, "post_id": 47993923, "comment_id": 82956054, "body": "@hyde: Padding bits and bytes would be the most common things that an implementation might not copy. But types can have values that are represented in multiple ways. For example, the number .3 might be represented, in theory, with floating-point representations equivalent to 3*10**-1 or 30*10**-2. That is, two different byte patterns might both represent .3. When a C implementation is copying a value, it is only required to produce the same value, not the same bytes. So copying a .3 that is internally 30*10**-2 might produce 3*10**-1."}, {"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 0, "creation_date": 1514385730, "post_id": 47993923, "comment_id": 82956186, "body": "Right. As this is known platform and only integers (code would need some work to be portable), only padding bits are of interest here. Alas, I think it&#39;s enough of a worry about really obscure future bugs, that I will reject this approach."}], "tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": false, "score": 3, "last_activity_date": 1514385272, "last_edit_date": 1514385272, "creation_date": 1514385098, "answer_id": 47993923, "question_id": 47993765, "link": "https://stackoverflow.com/questions/47993765/is-this-memset-memcmp-on-a-struct-variable-valid-c/47993923#47993923", "title": "Is this memset-memcmp on a struct variable valid C?", "body": "<p>You say the function returns a \u201cbitfield struct\u201d. If you are truly returning a struct, that is, returning a struct by value, then no, the behavior is not guaranteed to be what you want. When a structure is copied, the implementation merely needs to reproduce the values in its members, not the actual bytes in its representation.</p>\n\n<p>The same applies in your line <code>value2 = invalid_S;</code>.</p>\n"}], "owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 288, "favorite_count": 0, "accepted_answer_id": 47993830, "answer_count": 2, "score": 0, "last_activity_date": 1514385896, "creation_date": 1514384455, "last_edit_date": 1514385896, "question_id": 47993765, "link": "https://stackoverflow.com/questions/47993765/is-this-memset-memcmp-on-a-struct-variable-valid-c", "title": "Is this memset-memcmp on a struct variable valid C?", "body": "<p>Is it legal to <code>memset</code> a struct to some value, then compare it with <code>memcmp</code>?</p>\n\n<pre><code>struct S {\n    // struct definition not relevant, but it has bitfields\n};\n\nstruct S invalid_S;\nmemset(&amp;invalid_S, 0xFF, sizeof invalid_S);\n\nstruct S value;\nmemset(&amp;value, 0, sizeof value); // actual data read would be here\n\nif (memcmp(&amp;invalid_S, &amp;value, sizeof(struct S) != 0) {\n    /// operate on fields of value\n}\n\nstruct S value2;\nvalue2 = invalid_S;\n\nif (memcmp(&amp;invalid_S, &amp;value2, sizeof(struct S) != 0) {\n    /// operate on fields of value, which doesn't happen now\n}\n</code></pre>\n\n<p>Is the above codes behavior well defined, undefined or implementation-specified? Does validity of above code depend on <code>struct S</code>?</p>\n\n<p>The reason for having a struct filled with 0xFF, and then comparing it with <code>memcmp</code>, is this: I have a function which returns a bitfield struct which matches what I read from a hardware device, with no wasted bits or bytes, and I want an efficient way to report error (the device can never return all 0xFF bytes). I have fixed platforms and toolchains, where the code works now, but can I trust it to not break if I for example increase optimization level?</p>\n\n<hr>\n\n<p>Verdict: While this code could be made to work if I made sure there are no padding bits, float fields etc possibly problematic, I decided to instead just set one particular struct field to a specific \"impossible\" value to indicate error.</p>\n"}, {"tags": ["c++", "c", "memory-management", "data-structures", "file-io"], "comments": [{"owner": {"reputation": 188064, "user_id": 635608, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIJia.png?s=128&g=1", "display_name": "Mat", "link": "https://stackoverflow.com/users/635608/mat"}, "edited": false, "score": 7, "creation_date": 1514383012, "post_id": 47993429, "comment_id": 82954972, "body": "C++ has <code>std::vector</code>, C has <code>realloc</code>."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1514383158, "post_id": 47993429, "comment_id": 82955032, "body": "&quot;automatically&quot; Please define what it means. What kind of interface would qualify?"}, {"owner": {"reputation": 3985, "user_id": 298171, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/fp85I.jpg?s=128&g=1", "display_name": "fish2000", "link": "https://stackoverflow.com/users/298171/fish2000"}, "reply_to_user": {"reputation": 188064, "user_id": 635608, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIJia.png?s=128&g=1", "display_name": "Mat", "link": "https://stackoverflow.com/users/635608/mat"}, "edited": false, "score": 0, "creation_date": 1514383180, "post_id": 47993429, "comment_id": 82955045, "body": "@Mat Right, rgr that \u2013 but how does one best track and algorithmically resize them in practice?"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 1, "creation_date": 1514383319, "post_id": 47993429, "comment_id": 82955106, "body": "&quot;<i>how problematic is my workaround?</i> it isn&#39;t at all, at least if performance is not an issue."}, {"owner": {"reputation": 3985, "user_id": 298171, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/fp85I.jpg?s=128&g=1", "display_name": "fish2000", "link": "https://stackoverflow.com/users/298171/fish2000"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1514383399, "post_id": 47993429, "comment_id": 82955150, "body": "@n.m. I was thinking of how e.g. <code>funopen()</code> allows for the use of the <code>FILE*</code> opaque handle as the front-end interface for an arbitrary structure \u2013 in such a context, what are some algorithmic methods for handling initial allocation sizes <i>qua</i> subsequent reallocations"}, {"owner": {"reputation": 3985, "user_id": 298171, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/fp85I.jpg?s=128&g=1", "display_name": "fish2000", "link": "https://stackoverflow.com/users/298171/fish2000"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1514383510, "post_id": 47993429, "comment_id": 82955204, "body": "@n.m. \u2026 also, what is a good strategy for expanding the buffer in-place, in terms of doing the least amount of copying?"}, {"owner": {"reputation": 20670, "user_id": 26039, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/15aacb48f4c894a6341e1013e9b5a42f?s=128&d=identicon&r=PG", "display_name": "eran", "link": "https://stackoverflow.com/users/26039/eran"}, "edited": false, "score": 2, "creation_date": 1514383593, "post_id": 47993429, "comment_id": 82955242, "body": "A simple linked list can provide the functionality you&#39;re looking for. Its memory layout is usually not what we&#39;d expect from a buffer, but so are files; they&#39;re just wrapped in an API that makes it look like a file is a single sequence of bytes. So basically you wanna separate the API, which should appear to manage a single buffer, from the implementation, which may manage multiple memory blocks. And using a file to store non-persistent data can be terribly slow."}, {"owner": {"reputation": 37256, "user_id": 736308, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/o5EqQ.jpg?s=128&g=1", "display_name": "cdarke", "link": "https://stackoverflow.com/users/736308/cdarke"}, "edited": false, "score": 1, "creation_date": 1514383652, "post_id": 47993429, "comment_id": 82955269, "body": "Did you consider memory mapping?  That way you don&#39;t need to allocate any memory, the file becomes part of the paging system.  See <code>mmap</code>:  <a href=\"http://man7.org/linux/man-pages/man2/mmap.2.html\" rel=\"nofollow noreferrer\">man7.org/linux/man-pages/man2/mmap.2.html</a>"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1514383771, "post_id": 47993429, "comment_id": 82955317, "body": "Ah OK so a stream-like interface. C++ has std::stringstream. Standard C has no such thing (funopen would qualify but it&#39;s not standard). You can wrap a realloc&#39;able buffer in a similar fashion that doesn&#39;t involve an actual FILE pointer."}, {"owner": {"reputation": 17958, "user_id": 1971013, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/EtqFE.jpg?s=128&g=1", "display_name": "meaning-matters", "link": "https://stackoverflow.com/users/1971013/meaning-matters"}, "edited": false, "score": 1, "creation_date": 1514383789, "post_id": 47993429, "comment_id": 82955324, "body": "How much data are you talking about? Do you need save the data on disk?"}, {"owner": {"reputation": 17958, "user_id": 1971013, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/EtqFE.jpg?s=128&g=1", "display_name": "meaning-matters", "link": "https://stackoverflow.com/users/1971013/meaning-matters"}, "edited": false, "score": 0, "creation_date": 1514383850, "post_id": 47993429, "comment_id": 82955349, "body": "What about C&#39;s <code>malloc()</code> and <code>realloc()</code>?"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 3, "creation_date": 1514383884, "post_id": 47993429, "comment_id": 82955365, "body": "Double the capacity each time you reallocate."}, {"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 2, "creation_date": 1514384099, "post_id": 47993429, "comment_id": 82955457, "body": "Curious: how can one program in C <b>and</b> C++? I do get the &quot;or&quot;; you can add &quot;or Java or Python or ...&quot;"}, {"owner": {"reputation": 140851, "user_id": 1120273, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/4cbcb185abce0204cf5ac705ba32d53a?s=128&d=identicon&r=PG", "display_name": "Dietmar K&#252;hl", "link": "https://stackoverflow.com/users/1120273/dietmar-k%c3%bchl"}, "edited": false, "score": 4, "creation_date": 1514384113, "post_id": 47993429, "comment_id": 82955464, "body": "An efficient strategy for a <i>contiguous</i> buffer is to increase the buffer size by a factor bigger than 1 when the buffer becomes full. The factor balances overallocation vs. effort copying the data: a small factor is expected to be more memory efficient but causes more copying. If you expect that the original size is about right you may want to choose a smaller factor (e.g., 1.5) while more uncertaintainty probably leads to a bigger value (e.g., 2). In either case, you\u2019d encapsulate the operation into an <code>insert()</code> operation (with C++ <code>std::vector</code> does just that)."}, {"owner": {"reputation": 3985, "user_id": 298171, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/fp85I.jpg?s=128&g=1", "display_name": "fish2000", "link": "https://stackoverflow.com/users/298171/fish2000"}, "reply_to_user": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 0, "creation_date": 1514385106, "post_id": 47993429, "comment_id": 82955892, "body": "@usr2564301 programming in \u201cC and C++\u201d is arguably possible due to the fact that C++ behaves much like a superset of C (although strictly speaking it isn\u2019t) \u2013 so, say, using the POSIX I/O C functions in a C++ program (like e.g. as I describe in my question) is something I could call \u201cC and C++ programming,\u201d if you will."}, {"owner": {"reputation": 3985, "user_id": 298171, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/fp85I.jpg?s=128&g=1", "display_name": "fish2000", "link": "https://stackoverflow.com/users/298171/fish2000"}, "reply_to_user": {"reputation": 140851, "user_id": 1120273, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/4cbcb185abce0204cf5ac705ba32d53a?s=128&d=identicon&r=PG", "display_name": "Dietmar K&#252;hl", "link": "https://stackoverflow.com/users/1120273/dietmar-k%c3%bchl"}, "edited": false, "score": 0, "creation_date": 1514385331, "post_id": 47993429, "comment_id": 82956001, "body": "@DietmarK&#252;hl thanks, these are exactly the kinds of implementation notes I am looking for. You don\u2019t suppose you have an example of this handy (one you\u2019d find exemplary)?"}, {"owner": {"reputation": 140851, "user_id": 1120273, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/4cbcb185abce0204cf5ac705ba32d53a?s=128&d=identicon&r=PG", "display_name": "Dietmar K&#252;hl", "link": "https://stackoverflow.com/users/1120273/dietmar-k%c3%bchl"}, "edited": false, "score": 0, "creation_date": 1514391866, "post_id": 47993429, "comment_id": 82958897, "body": "@fish2000: as already noted, <code>std::vector</code> is an example. <code>std::string</code> is another example. Just look at one of the open source implementations, e.g., <a href=\"https://github.com/gcc-mirror/gcc/blob/master/libstdc%2B%2B-v3/include/bits/vector.tcc#L713\" rel=\"nofollow noreferrer\">libstdc++</a>."}], "answers": [{"comments": [{"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 0, "creation_date": 1514390120, "post_id": 47994191, "comment_id": 82958112, "body": "In C++, if strict contiguity is not a requirement, a <code>deque</code> might be a good choice."}, {"owner": {"reputation": 4888, "user_id": 5785362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a786fd81952576dc07942023bf8830b?s=128&d=identicon&r=PG", "display_name": "tofro", "link": "https://stackoverflow.com/users/5785362/tofro"}, "reply_to_user": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 0, "creation_date": 1514390302, "post_id": 47994191, "comment_id": 82958196, "body": "@BenVoigt Strict contiguity is something I&#39;d assume when the OP is talking about image data. Otherwise, you&#39;re right."}, {"owner": {"reputation": 20670, "user_id": 26039, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/15aacb48f4c894a6341e1013e9b5a42f?s=128&d=identicon&r=PG", "display_name": "eran", "link": "https://stackoverflow.com/users/26039/eran"}, "edited": false, "score": 1, "creation_date": 1514446397, "post_id": 47994191, "comment_id": 82975015, "body": "Are you sure that &quot;the solution that has most probably the best performance&quot;? If the file was fully cached, it&#39;d match an in-memory dynamic data structure, but that&#39;s not guaranteed. Worse, he&#39;s calling <code>fsync</code>, which is a blocking I/O operation. A file might be a convenient abstraction to work with, but in this case that&#39;s all it gives. Any memory-based alternative will most likely be much faster."}, {"owner": {"reputation": 4888, "user_id": 5785362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a786fd81952576dc07942023bf8830b?s=128&d=identicon&r=PG", "display_name": "tofro", "link": "https://stackoverflow.com/users/5785362/tofro"}, "reply_to_user": {"reputation": 20670, "user_id": 26039, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/15aacb48f4c894a6341e1013e9b5a42f?s=128&d=identicon&r=PG", "display_name": "eran", "link": "https://stackoverflow.com/users/26039/eran"}, "edited": false, "score": 1, "creation_date": 1514456237, "post_id": 47994191, "comment_id": 82979440, "body": "@eran The comparison was  &quot;growing buffers&quot; vs. &quot;allocate all and load&quot;, i.e. the OP&#39;s algorithm vs. anything that uses dynamic buffers. <code>mmap</code> will indeed be a somewhat faster for the latter. On large blocks fully allocated and loaded in one go, <code>mmap</code> isn&#39;t significantly faster than traditional file-based operations. It plays its cards when random access to random portions in large files that don&#39;t fit in memory as a whole is required."}], "tags": [], "owner": {"reputation": 4888, "user_id": 5785362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a786fd81952576dc07942023bf8830b?s=128&d=identicon&r=PG", "display_name": "tofro", "link": "https://stackoverflow.com/users/5785362/tofro"}, "is_accepted": true, "score": 2, "last_activity_date": 1514387172, "last_edit_date": 1514387172, "creation_date": 1514386318, "answer_id": 47994191, "question_id": 47993429, "link": "https://stackoverflow.com/questions/47993429/creating-and-managing-a-byte-buffer-in-memory-in-c-and-or-c-that-can-automat/47994191#47994191", "title": "Creating and managing a byte buffer in memory, in C and/or C++, that can automatically resize as needed", "body": "<p>Nothing wrong with your approach as long as you can make sure the file doesn't change size between steps 3 and 5. It is, actually, the solution that has most probably the best performance.</p>\n\n<p>In case you realize (by counting bytes read vs. buffer size) while <code>read</code>ing the file that there is more to read but you run out of buffer space, you can always use <code>realloc</code> to increase the buffer by an arbitrary amount. How much that \"arbitrary amount\" would be depends on the nature of your application and your expected memory situation. If memory is plenty, you might want to over-allocate by factor 1.5 and <code>realloc</code> to the actual size once you have read the complete file.</p>\n\n<p>Dynamically re-allocating the buffer has, however, a bit of a speed penalty and might not always be possible when you are working with huge buffers and are already tight on memory (most implementations of <code>realloc</code> will temporarily need to hold both the too-small and the re-sized buffer in memory). </p>\n\n<p>Depending on the buffer sizes, your program might also suffer from a performance penalty when resizing the buffer - after all, the contents you already read needs to be copied over to the new, re-sized, buffer.</p>\n\n<p>In C++, you would probably use a <code>vector</code> to do the same thing and may run into the very same problems.  </p>\n\n<p>One last method to load large files is memory mapping - But this also has the requirement that you need to know how much space you need.</p>\n"}], "owner": {"reputation": 3985, "user_id": 298171, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/fp85I.jpg?s=128&g=1", "display_name": "fish2000", "link": "https://stackoverflow.com/users/298171/fish2000"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 495, "favorite_count": 1, "accepted_answer_id": 47994191, "answer_count": 1, "score": 2, "last_activity_date": 1514400844, "creation_date": 1514382908, "last_edit_date": 1514400844, "question_id": 47993429, "link": "https://stackoverflow.com/questions/47993429/creating-and-managing-a-byte-buffer-in-memory-in-c-and-or-c-that-can-automat", "title": "Creating and managing a byte buffer in memory, in C and/or C++, that can automatically resize as needed", "body": "<p>When programming in C and/or C++, how does one set up byte-buffer in-memory structure, such that it can automatically resize as the situation warrants?</p>\n\n<p>Often, I will want to write some unknown quantity bytes to a buffer, without knowing how much space is needed. I feel like this is a fundamental I/O programming concern \u2013 and I don\u2019t know how to approach the problem, let alone solve it.</p>\n\n<p>Specifically, I\u2019m doing this I/O to process image data \u2013 the sizes can vary from a few kilobytes on up to hundreds of megabytes, depending on compression settings and (many!) other factors.</p>\n\n<p>My current workaround, in many cases, is to:</p>\n\n<ol>\n<li><code>open()</code> a write-mode descriptor on a temporary file, and <code>write()</code> my indeterminate quantity of bytes to this file;</li>\n<li>then call <code>fsync()</code> and subsequently <code>close()</code> the descriptor;</li>\n<li>use <code>stat()</code> to get the size of the file;</li>\n<li>re-<code>open()</code> the temporary file in read mode;</li>\n<li>and <em>then</em> finally <code>read()</code> the entire file back into a newly allocated, properly-sized buffer.</li>\n</ol>\n\n<p>My question, therefore, is a two-parter: one, how problematic is my workaround? and two: how can I accomplish this task using only in-memory structures?</p>\n"}, {"tags": ["c", "arrays", "memory"], "comments": [{"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 2, "creation_date": 1514382540, "post_id": 47993225, "comment_id": 82954756, "body": "All of your sample values are the same. Should <code>0x01, 0x02</code> be paired as <code>0x0102</code> or as <code>0x0201</code>? Do you know the endianness of the data <i>and</i> of your own system?"}], "answers": [{"comments": [{"owner": {"reputation": 1699, "user_id": 4891815, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/niZw9.jpg?s=128&g=1", "display_name": "Gnqz", "link": "https://stackoverflow.com/users/4891815/gnqz"}, "edited": false, "score": 0, "creation_date": 1514382257, "post_id": 47993249, "comment_id": 82954616, "body": "All wise, a simple and sufficient answer."}, {"owner": {"reputation": 1791, "user_id": 794606, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9a1d5c337bdddae373bbdcb92fdb7077?s=128&d=identicon&r=PG", "display_name": "Jacek Cz", "link": "https://stackoverflow.com/users/794606/jacek-cz"}, "reply_to_user": {"reputation": 187, "user_id": 5468196, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/95f27a4f05a6dcaf98394e1d08b8f7a0?s=128&d=identicon&r=PG&f=1", "display_name": "Jan Parzyd\u0142o", "link": "https://stackoverflow.com/users/5468196/jan-parzyd%c5%82o"}, "edited": false, "score": 3, "creation_date": 1514382409, "post_id": 47993249, "comment_id": 82954689, "body": "@JanParzyd\u0142o Not so easy, propably You should read about endianess.  Think sample with different values { 0x11, 0x12, 0x13, 0x14 }"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1514389440, "post_id": 47993249, "comment_id": 82957785, "body": "Why is boost a reference when doing C?"}, {"owner": {"reputation": 29848, "user_id": 5958455, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lBWIE.png?s=128&g=1", "display_name": "iBug", "link": "https://stackoverflow.com/users/5958455/ibug"}, "reply_to_user": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1514389809, "post_id": 47993249, "comment_id": 82957955, "body": "@alk This is the same case across C and C++."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1514389861, "post_id": 47993249, "comment_id": 82957983, "body": "You never know ... ;-)"}, {"owner": {"reputation": 29848, "user_id": 5958455, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lBWIE.png?s=128&g=1", "display_name": "iBug", "link": "https://stackoverflow.com/users/5958455/ibug"}, "reply_to_user": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 1, "creation_date": 1514390627, "post_id": 47993249, "comment_id": 82958322, "body": "@alk Fine. <a href=\"https://stackoverflow.com/q/11373203/5958455\">I have to agree.</a>"}], "tags": [], "owner": {"reputation": 29848, "user_id": 5958455, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lBWIE.png?s=128&g=1", "display_name": "iBug", "link": "https://stackoverflow.com/users/5958455/ibug"}, "is_accepted": false, "score": 9, "last_activity_date": 1514390805, "last_edit_date": 1514390805, "creation_date": 1514382139, "answer_id": 47993249, "question_id": 47993225, "link": "https://stackoverflow.com/questions/47993225/read-two-bytes-at-once-from-a-byte-array-in-c/47993249#47993249", "title": "read two bytes at once from a byte array in C", "body": "<p>A piece of cake:</p>\n\n<pre><code>memcpy(&amp;d16, barr + n, sizeof(d16));\n</code></pre>\n\n<hr>\n\n<p>Don't try to convert pointers or use <code>union</code>s. Those either are undefined behaviors, or may trip trap representations. <code>memcpy()</code> is the \"canonical\" solution (as the C++ boost library does).</p>\n\n\n"}, {"comments": [{"owner": {"reputation": 29848, "user_id": 5958455, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lBWIE.png?s=128&g=1", "display_name": "iBug", "link": "https://stackoverflow.com/users/5958455/ibug"}, "edited": false, "score": 0, "creation_date": 1514416992, "post_id": 47995905, "comment_id": 82968063, "body": "<i>endianness-sa<b>v</b>e</i> or <i>endianness-sa<b>f</b>e</i>?"}], "tags": [], "owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "is_accepted": false, "score": 0, "last_activity_date": 1514448589, "last_edit_date": 1514448589, "creation_date": 1514393866, "answer_id": 47995905, "question_id": 47993225, "link": "https://stackoverflow.com/questions/47993225/read-two-bytes-at-once-from-a-byte-array-in-c/47995905#47995905", "title": "read two bytes at once from a byte array in C", "body": "<p>A linear and endianness-safe approach here:</p>\n\n<pre><code>#include &lt;stdint.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;arpa/inet.h&gt; /* for ntohs() */\n\nunion Convert\n{\n  uint16_t  to_integer_big_endian;\n  uint8_t barr[sizeof (uint16_t)];\n};\n\nuint16_t pick_and_convert(uint8_t * barr, size_t s, size_t n)\n{\n  union Convert c = {0};  /* Take out-of-bound bytes as 0s. */\n\n  for (size_t i = 0; i &lt; sizeof c.barr &amp;&amp; (n + i) &lt; s; ++i)\n  {\n    c.barr[i] = barr[n + i];\n  }\n\n  return ntohs(c.to_integer_big_endian);\n}\n\nint main(void)\n{\n   uint8_t barr[4] = {1, 2, 3, 4}; /* Assuming a binary sequence. */\n   size_t n;\n\n   scanf(\"%zu\", &amp;n);\n\n   uint16_t to_integer = pick_and_convert(barr, sizeof barr / sizeof *barr, n);\n\n   printf(\"result = 0x%hx\\n\", to_integer);\n }\n</code></pre>\n"}], "owner": {"reputation": 187, "user_id": 5468196, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/95f27a4f05a6dcaf98394e1d08b8f7a0?s=128&d=identicon&r=PG&f=1", "display_name": "Jan Parzyd\u0142o", "link": "https://stackoverflow.com/users/5468196/jan-parzyd%c5%82o"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2237, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1514448589, "creation_date": 1514382056, "last_edit_date": 1514382270, "question_id": 47993225, "link": "https://stackoverflow.com/questions/47993225/read-two-bytes-at-once-from-a-byte-array-in-c", "title": "read two bytes at once from a byte array in C", "body": "<p>Let's say I have the following array of bytes:</p>\n\n<pre><code>uint8_t barr[4] = {0xCE, 0xCE, 0xCE, 0xCE};\n</code></pre>\n\n<p>Given an index <code>n</code>, I want to be able to read two bytes:</p>\n\n<pre><code>uint16_t d16 = barr[0];\n</code></pre>\n\n<p>And have <code>d16</code> be equal to </p>\n\n<pre><code>0xCECE\n</code></pre>\n\n<p>Perhaps there is a function in the standard library that can perform such task?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "edited": false, "score": 0, "creation_date": 1514381671, "post_id": 47993127, "comment_id": 82954358, "body": "address of a pointer variable is double pointer - meaning <code>**</code>."}, {"owner": {"reputation": 1638, "user_id": 6579116, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/caf3bff5c0d3f1b528b086ae5163caf2?s=128&d=identicon&r=PG&f=1", "display_name": "Pirate", "link": "https://stackoverflow.com/users/6579116/pirate"}, "edited": false, "score": 0, "creation_date": 1514381881, "post_id": 47993127, "comment_id": 82954444, "body": "replace this  lotto(&amp;t, a, x, y, g, h); to  lotto(t, a, x, y, g, h);"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user9145308"}, "edited": false, "score": 0, "creation_date": 1514390310, "post_id": 47993192, "comment_id": 82958202, "body": "that makes it work BUT now it doesnt show the numbers i want (groups of 6 numbers that i gave), it  shows random numbers (memory locations since i removed the &amp;)"}, {"owner": {"reputation": 1638, "user_id": 6579116, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/caf3bff5c0d3f1b528b086ae5163caf2?s=128&d=identicon&r=PG&f=1", "display_name": "Pirate", "link": "https://stackoverflow.com/users/6579116/pirate"}, "edited": false, "score": 0, "creation_date": 1514447431, "post_id": 47993192, "comment_id": 82975392, "body": "then check your code. may be you are accessing the value of the location that doesn&#39;t have anything or initialize."}], "tags": [], "owner": {"reputation": 1638, "user_id": 6579116, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/caf3bff5c0d3f1b528b086ae5163caf2?s=128&d=identicon&r=PG&f=1", "display_name": "Pirate", "link": "https://stackoverflow.com/users/6579116/pirate"}, "is_accepted": false, "score": 1, "last_activity_date": 1514381907, "creation_date": 1514381907, "answer_id": 47993192, "question_id": 47993127, "link": "https://stackoverflow.com/questions/47993127/cant-seem-to-understand-this-last-remaining-error-in-c-program/47993192#47993192", "title": "Can&#39;t seem to understand this last remaining error in c program", "body": "<p>replace this <code>lotto(&amp;t, a, x, y, g, h);</code> to <code>lotto(t, a, x, y, g, h);</code></p>\n\n<p>In the function declaration, you have mentioned the input parameter as <strong>pointer to int</strong>, but again you are passing <strong>pointer to pointer to int</strong> and that is causing error.  </p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user9145308"}, "edited": false, "score": 0, "creation_date": 1514390305, "post_id": 47993229, "comment_id": 82958198, "body": "that makes it work BUT now it doesnt show the numbers i want (groups of 6 numbers that i gave), it  shows random numbers (memory locations since i removed the &amp;)"}], "tags": [], "owner": {"reputation": 44, "user_id": 8665576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/633615eda1f1a78079642f332cd9b3fb?s=128&d=identicon&r=PG", "display_name": "user8665576", "link": "https://stackoverflow.com/users/8665576/user8665576"}, "is_accepted": false, "score": 1, "last_activity_date": 1514382066, "creation_date": 1514382066, "answer_id": 47993229, "question_id": 47993127, "link": "https://stackoverflow.com/questions/47993127/cant-seem-to-understand-this-last-remaining-error-in-c-program/47993229#47993229", "title": "Can&#39;t seem to understand this last remaining error in c program", "body": "<p>The problem is '&amp;t' in your lotto() you're specifying 'int*' and sending an 'int**'. Try compiling without the '&amp;'</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9145308"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 1, "answer_count": 2, "score": -5, "last_activity_date": 1514388218, "creation_date": 1514381600, "last_edit_date": 1592644375, "question_id": 47993127, "link": "https://stackoverflow.com/questions/47993127/cant-seem-to-understand-this-last-remaining-error-in-c-program", "title": "Can&#39;t seem to understand this last remaining error in c program", "body": "<p>The error i don't understand how to fix and need help with is:</p>\n<blockquote>\n<p>in line 20 and column 28</p>\n<p>[Error] cannot convert 'int**' to 'int*' for argument '1' to 'void\nlotto(int*, int, int, int, int, int)'</p>\n</blockquote>\n<p><strong>In this part of the code:</strong></p>\n<pre><code>    #include &lt;stdio.h&gt;\n    #include &lt;stdlib.h&gt;\n    \n    int read1();\n    int even1();\n    int even2();\n    int sum1();\n    int sum2();\n    void lotto(int*, int, int, int, int, int);\n    int* table_num(int);\n    \n    int main()\n    {\n        int a=read1();\n        int* t = table_num(a);\n        int x=even1();\n        int y=even2();\n        int g=sum1();\n        int h=sum2();\n        lotto(&amp;t, a, x, y, g, h); /*error here*/\n        return 0;\n    }\n</code></pre>\n<p><strong>And here is the function:</strong></p>\n<pre><code>void lotto(int* a, int n, int armax, int armin, int atmax, int atmin)\n{\n    int q, w, z=1;\n\n    for (int i = 0; i &lt; n-5; ++i) \n    {\n        for (int j = i+1; j &lt; n-4 ; ++j) \n        {\n            for (int k = j+1; k &lt; n-3 ; ++k) \n            {\n                for (int l = k+1; l &lt; n-2 ; ++l) \n                {\n                    for (int m = l+1; m &lt; n-1 ; ++m) \n                    {\n                        for (int i1 = m+1; i1 &lt; n; ++i1) \n                        {\n\n                            q=0;\n\n                            (i%2==0)?q+=1:2;\n                            (j%2==0)?q+=1:2;\n                            (k%2==0)?q+=1:2;\n                            (l%2==0)?q+=1:2;\n                            (m%2==0)?q+=1:2;\n                            (i1%2==0)?q+=1:2;\n\n                            w=i+j+k+l+m+i1;\n\n                            if((q&lt;=armax||q&gt;=armin)&amp;&amp;(w&gt;=atmin||w&lt;=atmax))\n                            {\n\n                                printf(&quot;The %d st/nd/rd/th group of 6 numbers is :\\t&quot;,z);\n                                printf(&quot;%d ,%d ,%d ,%d ,%d ,%d \\n\\n&quot;,*(a+i), *(a+j), *(a+k), *(a+l), *(a+m), (a+i1));\n                                z++;\n\n                            }else\n                                continue;\n\n\n\n                        }\n\n                    }\n\n                }\n\n            }\n\n        }\n\n    }\n    \n}\n</code></pre>\n<p>if you want the whole code is needed to answer my question i can edit it in</p>\n"}, {"tags": ["c", "formatting", "string-formatting"], "comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1514382720, "post_id": 47992997, "comment_id": 82954831, "body": "You want to print a name and a corresponding hash into each line? What is the problem about that? I.e. what is special about the format you unsuccessfully try to achieve? Guessing the &quot;rule&quot; is hard from the few examples of desired output you gave."}], "answers": [{"comments": [{"owner": {"reputation": 59, "user_id": 9132867, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/7f306e047c408bd4be04366761f97cd7?s=128&d=identicon&r=PG&f=1", "display_name": "catmix", "link": "https://stackoverflow.com/users/9132867/catmix"}, "edited": false, "score": 0, "creation_date": 1514417391, "post_id": 47993582, "comment_id": 82968163, "body": "Hello ! I have followed your advice and I&#39;ve come up with this                        fprintf(resultfile,&quot;%-8s %8s\\n&quot;,buf, result);                                                                  However, it remains misaligned. Is it possible to pad output in fprintf and move the hash upwards ?"}, {"owner": {"reputation": 449, "user_id": 9131933, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/272423f6785184b9d180ef6a5bd16504?s=128&d=identicon&r=PG&f=1", "display_name": "newbie", "link": "https://stackoverflow.com/users/9131933/newbie"}, "reply_to_user": {"reputation": 59, "user_id": 9132867, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/7f306e047c408bd4be04366761f97cd7?s=128&d=identicon&r=PG&f=1", "display_name": "catmix", "link": "https://stackoverflow.com/users/9132867/catmix"}, "edited": false, "score": 0, "creation_date": 1514462314, "post_id": 47993582, "comment_id": 82982298, "body": "Can you paste in what you have now ? It is possible to make the first column a fixed size and add a tab in between the two strings"}, {"owner": {"reputation": 59, "user_id": 9132867, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/7f306e047c408bd4be04366761f97cd7?s=128&d=identicon&r=PG&f=1", "display_name": "catmix", "link": "https://stackoverflow.com/users/9132867/catmix"}, "edited": false, "score": 0, "creation_date": 1514463349, "post_id": 47993582, "comment_id": 82982869, "body": "Hi thanks for responding. Are you referring to my fprintf statements or my output in the mytab2411.txt file ?"}, {"owner": {"reputation": 449, "user_id": 9131933, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/272423f6785184b9d180ef6a5bd16504?s=128&d=identicon&r=PG&f=1", "display_name": "newbie", "link": "https://stackoverflow.com/users/9131933/newbie"}, "reply_to_user": {"reputation": 59, "user_id": 9132867, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/7f306e047c408bd4be04366761f97cd7?s=128&d=identicon&r=PG&f=1", "display_name": "catmix", "link": "https://stackoverflow.com/users/9132867/catmix"}, "edited": false, "score": 0, "creation_date": 1514477702, "post_id": 47993582, "comment_id": 82989983, "body": "Hi,  printf( &quot;%s\\t%s\\n&quot;, pchName, pchHash);  gave this   Ringo\t$1$$l1fRKKtYSfJOVyWKw3rFH1 Ringo\t$6$$9s3dCSxRBiVAzeBQR.bJLGdPL6VhH4p7fJu2aiaOLxcS4wLpWi&zwnj;&#8203;foWNxTtaOQGnIHOZadh5&zwnj;&#8203;rHhuuOOHEicLCV20 George\t$1$$l1fRKKtYSfJOVyWKw3rFH1 George\t$6$$9s3dCSxRBiVAzeBQR.bJLGdPL6VhH4p7fJu2aiaOLxcS4wLpW&zwnj;&#8203;ifoWNxTtaOQGnIHOZadh&zwnj;&#8203;5rHhuuOOHEicLCV20 Paul\t$1$$l1fRKKtYSfJOVyWKw3rFH1 Paul\t$6$$9s3dCSxRBiVAzeBQR.bJLGdPL6VhH4p7fJu2aiaOLxcS4wLpWif&zwnj;&#8203;oWNxTtaOQGnIHOZadh5r&zwnj;&#8203;HhuuOOHEicLCV20 Ringo\t$1$$l1fRKKtYSfJOVyWKw3rFH1 Ringo\t$6$$9s3dCSxRBiVAzeBQR.bJLGdPL6VhH4p7fJu2aiaOLxcS4wLpWi&zwnj;&#8203;foWNxTtaOQGnIHOZadh5&zwnj;&#8203;rHhuuOOHEicLCV20"}, {"owner": {"reputation": 449, "user_id": 9131933, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/272423f6785184b9d180ef6a5bd16504?s=128&d=identicon&r=PG&f=1", "display_name": "newbie", "link": "https://stackoverflow.com/users/9131933/newbie"}, "reply_to_user": {"reputation": 59, "user_id": 9132867, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/7f306e047c408bd4be04366761f97cd7?s=128&d=identicon&r=PG&f=1", "display_name": "catmix", "link": "https://stackoverflow.com/users/9132867/catmix"}, "edited": false, "score": 0, "creation_date": 1514477791, "post_id": 47993582, "comment_id": 82990023, "body": "which matches what I think your asking for in a terminal"}], "tags": [], "owner": {"reputation": 449, "user_id": 9131933, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/272423f6785184b9d180ef6a5bd16504?s=128&d=identicon&r=PG&f=1", "display_name": "newbie", "link": "https://stackoverflow.com/users/9131933/newbie"}, "is_accepted": true, "score": 0, "last_activity_date": 1514383636, "creation_date": 1514383636, "answer_id": 47993582, "question_id": 47992997, "link": "https://stackoverflow.com/questions/47992997/formatting-output-in-fprintf/47993582#47993582", "title": "Formatting output in fprintf", "body": "<p>If you add the newline to the format string \"%s \\n\" that will put the name at the beginning on the line if you want the key aligned you can play with \\t for tab or adding the specific size to the format string</p>\n"}], "owner": {"reputation": 59, "user_id": 9132867, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/7f306e047c408bd4be04366761f97cd7?s=128&d=identicon&r=PG&f=1", "display_name": "catmix", "link": "https://stackoverflow.com/users/9132867/catmix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 138, "favorite_count": 0, "closed_date": 1514385140, "accepted_answer_id": 47993582, "answer_count": 1, "score": -1, "last_activity_date": 1514414873, "creation_date": 1514381030, "last_edit_date": 1514414873, "question_id": 47992997, "link": "https://stackoverflow.com/questions/47992997/formatting-output-in-fprintf", "closed_reason": "Needs details or clarity", "title": "Formatting output in fprintf", "body": "<p>Thanks to your assistance earlier I was able to write a program that generates SHA 512 and MD5 hashes from text in a text file and place the output hashes in a seperate text file. I am very much grateful for that.\nThe program is as follows :</p>\n\n<p>File-name: hashgen.c</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;crypt.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt;\n\n\nint main (){\n\n    // Start : Display the time of starting the program\n    time_t starttime;\n    struct tm * starttimeinfo;\n\n    time ( &amp;starttime );\n    starttimeinfo = localtime ( &amp;starttime );\n    printf ( \"Program Started At: %s\", asctime (starttimeinfo) );\n        //declaring a file to be selected by user\n    FILE *user_file;\n    char buf[1000];\n\n    FILE *resultfile;\n    resultfile = fopen(\"mytab2411.txt\",\"w\");\n\n\n    // md5 hash\n    char * hash_md5 = \"$1$\";\n    // sha512 hash\n    char * hash_sha = \"$6$\";\n\n    //Specify Salt   \n    char * salt_1 =\"$\";     \n    char * result;\n    char encyption_scheme[20];\n    char userfilename[128];\n\n    //Prompt to enter file name\n     printf(\"Enter a file name\\n\");\n     scanf(\"%123s\",userfilename);\n\n    //opening the file  \n    user_file=fopen(userfilename,\"r\"); \n    //Error if file does not exist\n    if (!user_file){\n        printf(\"Could not find file: %123s\",userfilename);\n        printf(\"Please verify the file path\");\n\n\n        time_t exittime1;\n        struct tm *exittimeinfo1;\n\n        time ( &amp;exittime1 );\n        exittimeinfo1 = localtime ( &amp;exittime1 );\n\n\n        printf ( \"Program Ended At: %s\", asctime (exittimeinfo1) );\n            return (EXIT_FAILURE);\n            }\n        //reading from file\n        while (fgets(buf,1000, user_file)!=NULL){\n\n        /* hashing using md5 */\n\n            strcpy(encyption_scheme,hash_md5);\n            strcat(encyption_scheme,salt_1);\n            result = crypt(buf,encyption_scheme);\n            fprintf(resultfile,\"%s\",buf);\n            fprintf(resultfile,\"%s\",result);\n\n             /* hashing using sha-512 */ \n             strcpy(encyption_scheme,hash_sha);\n             strcat(encyption_scheme,salt_1);\n             result = crypt(buf,encyption_scheme);\n            fprintf(resultfile,\"%s\",buf);\n\n            fprintf(resultfile,\"%s\",result);\n            }\n            //closing file\n            fclose(resultfile);\n            //display time program ended\n            time_t endtime;\n            struct tm * endtimeinfo;\n\n            time ( &amp;endtime );\n            endtimeinfo = localtime ( &amp;endtime );\n\n\n            printf ( \"Program Ended At: %s\", asctime (endtimeinfo) );\n\n}\n</code></pre>\n\n<p>The text file used contained the following words:</p>\n\n<p>File-name: Sample.txt</p>\n\n<pre><code>John\nPaul\nRingo\nGeorge\n</code></pre>\n\n<p>Now, the hash values of the words in Sample.txt are stored in mytab2411.txt. The file appears as such.</p>\n\n<p>File-name : mytab2411.txt</p>\n\n<pre><code>John\n$1$$l1fRKKtYSfJOVyWKw3rFH1John\n$6$$9s3dCSxRBiVAzeBQR.bJLGdPL6VhH4p7fJu2aiaOLxcS4wLpWifoWNxTtaOQGnIHOZadh5rHhuuOOHEicLCV20Paul\n$1$$.NeC/EbTUibao2by.HNV01Paul\n$6$$qQs5aHFZX/2Iaz4Y1RIihRn./AszpUZnDfld0h5mrWEtAqRJPanIO3cpT3TOOKuFS5hpmLrKAb5MY2mGV2ato1Ringo\n$1$$CfsqYxqUQM5x0o.sjBMjV/Ringo\n$6$$iC4vLpyDb5gAw5b7roT79LxiEd3d4LTyi5ftrWW6mwyYHNHenMiaFav4wLR3Rnmut.gJfMHn.Zy.pki9.0OBb.George\n$1$$2ij/IqfPsZDlXFUEX7H82/George\n$6$$ixjdlMMt3jg1Yb6x91HpVmV3pc9q5o8xFwejxiIyU9yZAoSsiA6qBRuHYInPyQlP4XkrnhuIyUsryLfgtldO5/\n</code></pre>\n\n<p>I would like to use fprintf to ensure that the hash values and the original corresponding words are aligned together. For instance :</p>\n\n<p>File-name : mytab2411.txt</p>\n\n<pre><code>John $1$$l1fRKKtYSfJOVyWKw3rFH1    \nJohn $6$$9s3dCSxRBiVAzeBQR.bJLGdPL6VhH4p7fJu2aiaOLxcS4wLpWifoWNxTtaOQGnIHOZadh5rHhuuOOHEicLCV20\nPaul $1$$.NeC/EbTUibao2by.HNV01\nPaul $6$$qQs5aHFZX/2Iaz4Y1RIihRn./AszpUZnDfld0h5mrWEtAqRJPanIO3cpT3TOOKuFS5hpmLrKAb5MY2mGV2ato1\n</code></pre>\n\n<p>Could someone guide me on how to align the text as seen above using printf ? Thank you.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1514380585, "post_id": 47992622, "comment_id": 82953841, "body": "<i>&quot;i have problem with another logic&quot;</i> is very unclear. You have no question here. What are you asking?"}], "answers": [{"tags": [], "owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "is_accepted": true, "score": 1, "last_activity_date": 1514391030, "last_edit_date": 1514391030, "creation_date": 1514380998, "answer_id": 47992991, "question_id": 47992622, "link": "https://stackoverflow.com/questions/47992622/c-program-to-set-msb-and-lsb-of-a-number/47992991#47992991", "title": "C program to set MSB and LSB of a number", "body": "<p>First I think you have a problem with your function definition. Your code expects a <code>unsigned int</code> but in <code>main</code> you write that <code>171</code> shall result in <code>S</code> (i.e. both MSB and LSB set). That will not happen as an <code>unsigned int</code> is more than 8 bits. </p>\n\n<p>So my guess is that you want:</p>\n\n<pre><code>char set_reset(unsigned char number)\n                        ^^^^\n</code></pre>\n\n<p>In that case your program could be:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;limits.h&gt;\n\nchar set_reset(unsigned char number)\n{\n    unsigned int lsb = number &amp; 1;\n    unsigned int msb = number &amp; (1 &lt;&lt; (CHAR_BIT-1));\n\n    if (lsb &amp;&amp; msb) return 'S';\n    if (lsb) return 'L';\n    if (msb) return 'M';\n    return 'R';\n}\n\n int main (void)\n{\n    printf(\"%c\\n\", set_reset(150));\n    printf(\"%c\\n\", set_reset(11));\n    printf(\"%c\\n\", set_reset(171));\n    printf(\"%c\\n\", set_reset(42));\n\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>M\nL\nS\nR\n</code></pre>\n\n<p>Notice that CHAR_BIT from limits.h is the number of bits in a char. Normally it is 8 but that is not guaranteed. Therefore it is better to take it from limits.h</p>\n"}], "owner": {"reputation": 37, "user_id": 5347071, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/199b3741afa09ed6d6a84a155bb40282?s=128&d=identicon&r=PG&f=1", "display_name": "Bhagyasri patel", "link": "https://stackoverflow.com/users/5347071/bhagyasri-patel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 713, "favorite_count": 0, "accepted_answer_id": 47992991, "answer_count": 1, "score": -3, "last_activity_date": 1514391030, "creation_date": 1514379490, "question_id": 47992622, "link": "https://stackoverflow.com/questions/47992622/c-program-to-set-msb-and-lsb-of-a-number", "title": "C program to set MSB and LSB of a number", "body": "<p>I have to write a C program which returns \u2018S\u2019, if both LSB and MSB of a number are set, returns \u2018R\u2019, if both LSB and MSB of number are not set, returns \u2018L\u2019 if LSB is set but not the MSB and returns \u2018M\u2019 if MSB is set but not the LSB. Here I have made a program to set only LSB but i have problem with another logic. Please help me with this.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;conio.h&gt;\n\nchar result;   \nchar set_reset(unsigned int number)\n{\n\n    if(number &amp; 1)\n\n    result='L';\n\n\n    return result;  // Do not change the return\n}\n\n int main (void)\n{\n    char result_value;\n    result_value = set_reset(150); // it should return 'M'\n    result_value = set_reset(11); // it should return 'L'\n    result_value = set_reset(171); // it should return 'S'\n    result_value = set_reset(42); // it should return 'R'\n\n}\n</code></pre>\n"}, {"tags": ["python", "c", "anaconda", "md5", "pyopenssl"], "comments": [{"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1514379335, "post_id": 47992383, "comment_id": 82953281, "body": "The dynamic linker does not seem to find the shared library providing the implementation of <code>MD_Final()</code>."}, {"owner": {"reputation": 28355, "user_id": 4788546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2jWn.jpg?s=128&g=1", "display_name": "CristiFati", "link": "https://stackoverflow.com/users/4788546/cristifati"}, "edited": false, "score": 1, "creation_date": 1514379342, "post_id": 47992383, "comment_id": 82953283, "body": "Please pst the output of the following commands: <code>nm -S &#47;home&#47;palash&#47;Desktop&#47;pal&#47;hasher.cpython-36m-i386-linux-gnu.s&zwnj;&#8203;o | grep MD5</code>, <code>ldd &#47;home&#47;palash&#47;Desktop&#47;pal&#47;hasher.cpython-36m-i386-linux-gnu.s&zwnj;&#8203;o</code> to see which <i>OpenSSL</i> libs it loads at runtime. Side comment: that <code>filename</code> argument approach seems strange to me."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1514379688, "post_id": 47992383, "comment_id": 82953434, "body": "You might like to read <code>man ldconfig</code>."}, {"owner": {"reputation": 183, "user_id": 7917825, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ehaZN0Tk7iw/AAAAAAAAAAI/AAAAAAAAAHY/milK2Q04ybc/photo.jpg?sz=128", "display_name": "Palash Bauri", "link": "https://stackoverflow.com/users/7917825/palash-bauri"}, "reply_to_user": {"reputation": 28355, "user_id": 4788546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2jWn.jpg?s=128&g=1", "display_name": "CristiFati", "link": "https://stackoverflow.com/users/4788546/cristifati"}, "edited": false, "score": 0, "creation_date": 1514463770, "post_id": 47992383, "comment_id": 82983080, "body": "@CristiFati I added the output of <code>nm -S &#47;home&#47;palash&#47;Desktop&#47;pal&#47;hasher.cpython-36m-i386-linux-gnu.s&zwnj;&#8203;\u200c\u200bo | grep MD5</code>"}, {"owner": {"reputation": 28355, "user_id": 4788546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2jWn.jpg?s=128&g=1", "display_name": "CristiFati", "link": "https://stackoverflow.com/users/4788546/cristifati"}, "edited": false, "score": 0, "creation_date": 1514464972, "post_id": 47992383, "comment_id": 82983639, "body": "This is what I was expecting. The <code>ldd</code> output would be useful as well to see which <i>libcrypto</i> is using and why it doesn&#39;t find <code>MD5_Final</code> (The strange part is that it doesn&#39;t complain about the other 2 - or it might be that this is the 1st that it searches and if not found it stops)."}, {"owner": {"reputation": 183, "user_id": 7917825, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ehaZN0Tk7iw/AAAAAAAAAAI/AAAAAAAAAHY/milK2Q04ybc/photo.jpg?sz=128", "display_name": "Palash Bauri", "link": "https://stackoverflow.com/users/7917825/palash-bauri"}, "reply_to_user": {"reputation": 28355, "user_id": 4788546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2jWn.jpg?s=128&g=1", "display_name": "CristiFati", "link": "https://stackoverflow.com/users/4788546/cristifati"}, "edited": false, "score": 0, "creation_date": 1514525299, "post_id": 47992383, "comment_id": 83004682, "body": "@CristiFati output of <code>ldd</code> is added"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1514540654, "post_id": 47992383, "comment_id": 83010031, "body": "There must be a <code>hasher.o</code> somewhere. Run <code>ldd</code> on it. How do you compile <code>hasher.c</code>?"}, {"owner": {"reputation": 183, "user_id": 7917825, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ehaZN0Tk7iw/AAAAAAAAAAI/AAAAAAAAAHY/milK2Q04ybc/photo.jpg?sz=128", "display_name": "Palash Bauri", "link": "https://stackoverflow.com/users/7917825/palash-bauri"}, "reply_to_user": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1514542628, "post_id": 47992383, "comment_id": 83010900, "body": "@alk when run ldd on hasher.o i got <code>not a dynamic executable</code> and i compiled the hasher.c using the setup.py mentioned in the question details"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1514542868, "post_id": 47992383, "comment_id": 83011016, "body": "Ahwell, I see this now. Please excuse, my redundant question."}], "owner": {"reputation": 183, "user_id": 7917825, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ehaZN0Tk7iw/AAAAAAAAAAI/AAAAAAAAAHY/milK2Q04ybc/photo.jpg?sz=128", "display_name": "Palash Bauri", "link": "https://stackoverflow.com/users/7917825/palash-bauri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 465, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1514525266, "creation_date": 1514378439, "last_edit_date": 1592644375, "question_id": 47992383, "link": "https://stackoverflow.com/questions/47992383/undefined-symbol-md5-final-error-on-ubuntu-with-anaconda-while-a-compiling-a", "title": "undefined symbol: MD5_Final &gt; Error on Ubuntu with Anaconda while a compiling a python extension", "body": "<p>This is my hasher.c , source of python/c extension for my program</p>\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;openssl/md5.h&gt;\n#include &lt;Python.h&gt;\n\n\nstatic PyObject* gethash(PyObject* self , PyObject* args)\n{\n    // char inputfile;\n    char *filename;\n\n    if (!PyArg_ParseTuple(args, &quot;s&quot;, &amp;filename))\n        return NULL;\n\n    unsigned char c[MD5_DIGEST_LENGTH];\n    \n    int i;\n    FILE *inFile = fopen (filename, &quot;rb&quot;);\n    MD5_CTX mdContext;\n    int bytes;\n    unsigned char data[1024];\n\n    if (inFile == NULL) {\n        printf (&quot;%s can't be opened.\\n&quot;, filename);\n        return 0;\n    }\n\n    MD5_Init (&amp;mdContext);\n    while ((bytes = fread (data, 1, 1024, inFile)) != 0)\n        MD5_Update (&amp;mdContext, data, bytes);\n    MD5_Final (c,&amp;mdContext);\n    for(i = 0; i &lt; MD5_DIGEST_LENGTH; i++) printf(&quot;%02x&quot;, c[i]);\n    printf (&quot; %s\\n&quot;, filename);\n    fclose (inFile);\n    return 0;    \n\n}\n\nstatic PyMethodDef HelloMethods[] = {\n    {&quot;gethash&quot;, gethash, METH_VARARGS, &quot;Greet somebody (in C).&quot;},\n    {NULL, NULL, 0, NULL}  /* Sentinel */\n};\n\nstatic struct PyModuleDef HelloDemo =\n{\n    PyModuleDef_HEAD_INIT,\n    &quot;hellomodule&quot;, /* name of module */\n    &quot;&quot;,          /* module documentation, may be NULL */\n    -1,          /* size of per-interpreter state of the module, or -1 if the module keeps state in global variables. */\n    HelloMethods\n};\n\nPyMODINIT_FUNC PyInit_hasher(void)\n{\n    return PyModule_Create(&amp;HelloDemo);\n}\n</code></pre>\n<p>and this is my setup.py to build this extension:</p>\n<pre><code>from distutils.core import setup, Extension\n\nmodule = Extension(&quot;hasher&quot; , sources = [&quot;hasher.c&quot;] , extra_compile_args=[&quot;-lssl -lcrypto&quot;])\n\nsetup(name = &quot;hellomod&quot;,\n        version = '1.0',\n        description = &quot;hello&quot;,\n        ext_modules = [module])\n</code></pre>\n<p>but when i test my extension with this code it gave me error mentioned bellow</p>\n<h3>testing code</h3>\n<pre><code>import hasher\nhasher.gethash(&quot;hasher.c&quot;)\n</code></pre>\n<p>when i run i got this&gt;</p>\n<pre><code>$ py test.py\nTraceback (most recent call last):\n  File &quot;test.py&quot;, line 1, in &lt;module&gt;\n    import hasher\nImportError: /home/palash/Desktop/pal/hasher.cpython-36m-i386-linux-gnu.so: undefined symbol: MD5_Final\n</code></pre>\n<p>i'm running on ubuntu 17.04 , with anaconda , conda 4.4.4 and gcc version 7.0.1</p>\n<p>Help Me..</p>\n<h2>*Edit</h2>\n<p>output of,</p>\n<pre><code>$ nm -S hasher.cpython-36m-i386-linux-gnu.so | grep MD5\n</code></pre>\n<p>is</p>\n<pre><code>U MD5_Final\nU MD5_Init\nU MD5_Update\n</code></pre>\n<h2>Edit*</h2>\n<p>output of</p>\n<p><code>$ ldd hasher.cpython-36m-i386-linux-gnu.so</code></p>\n<p>is</p>\n<pre><code>linux-gate.so.1 =&gt;  (0xb7723000)\nlibpthread.so.0 =&gt; /lib/i386-linux-gnu/libpthread.so.0 (0xb76df000)\nlibc.so.6 =&gt; /lib/i386-linux-gnu/libc.so.6 (0xb7525000)\n/lib/ld-linux.so.2 (0x8008d000)\n</code></pre>\n"}, {"tags": ["c", "clang", "abi", "osdev", "freestanding"], "comments": [{"owner": {"reputation": 353, "user_id": 8290027, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh4.googleusercontent.com/-OGFlbb54fB8/AAAAAAAAAAI/AAAAAAAAABo/5nxOM9SSgUg/photo.jpg?sz=128", "display_name": "Rottenheimer2", "link": "https://stackoverflow.com/users/8290027/rottenheimer2"}, "edited": false, "score": 0, "creation_date": 1514385088, "post_id": 47991757, "comment_id": 82955881, "body": "@MichaelPetch I changed the order but nothing changed, same error message"}, {"owner": {"reputation": 353, "user_id": 8290027, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh4.googleusercontent.com/-OGFlbb54fB8/AAAAAAAAAAI/AAAAAAAAABo/5nxOM9SSgUg/photo.jpg?sz=128", "display_name": "Rottenheimer2", "link": "https://stackoverflow.com/users/8290027/rottenheimer2"}, "edited": false, "score": 0, "creation_date": 1514385534, "post_id": 47991757, "comment_id": 82956094, "body": "I created a branch in my github project so you can see this with more context: <a href=\"https://github.com/TheStr3ak5/CKA/tree/TheStr3ak5-newABI\" rel=\"nofollow noreferrer\">github.com/TheStr3ak5/CKA/tree/TheStr3ak5-newABI</a>, just build this branch following the BUILD file and you will see the errors."}, {"owner": {"reputation": 353, "user_id": 8290027, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh4.googleusercontent.com/-OGFlbb54fB8/AAAAAAAAAAI/AAAAAAAAABo/5nxOM9SSgUg/photo.jpg?sz=128", "display_name": "Rottenheimer2", "link": "https://stackoverflow.com/users/8290027/rottenheimer2"}, "reply_to_user": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 0, "creation_date": 1514393349, "post_id": 47991757, "comment_id": 82959584, "body": "@MichaelPetch yeah you are right, it solved my issues, Thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "is_accepted": true, "score": 2, "last_activity_date": 1514416276, "last_edit_date": 1514416276, "creation_date": 1514393790, "answer_id": 47995888, "question_id": 47991757, "link": "https://stackoverflow.com/questions/47991757/error-function-declared-ms-abi-here-was-previously-declared-without-calling-c/47995888#47995888", "title": "error: function declared &#39;ms_abi&#39; here was previously declared without calling convention (clang)", "body": "<p>Without having your build environment, an educated guess would be that you are redefining the built in functions that have prototypes that are incompatible with the <code>ms_abi</code> function attribute. If you are compiling with <code>-ffreestanding</code> and supplying your own functions like <code>memcpy</code>, <code>memset</code>, etc., you should consider compiling with <code>-fno-builtin</code> option so that CLANG/GCC doesn't use its built in forms of the functions that may conflict with your own.</p>\n"}], "owner": {"reputation": 353, "user_id": 8290027, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh4.googleusercontent.com/-OGFlbb54fB8/AAAAAAAAAAI/AAAAAAAAABo/5nxOM9SSgUg/photo.jpg?sz=128", "display_name": "Rottenheimer2", "link": "https://stackoverflow.com/users/8290027/rottenheimer2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 479, "favorite_count": 0, "accepted_answer_id": 47995888, "answer_count": 1, "score": 2, "last_activity_date": 1514416276, "creation_date": 1514375766, "last_edit_date": 1514415789, "question_id": 47991757, "link": "https://stackoverflow.com/questions/47991757/error-function-declared-ms-abi-here-was-previously-declared-without-calling-c", "title": "error: function declared &#39;ms_abi&#39; here was previously declared without calling convention (clang)", "body": "<p>when I try to compile C code that includes another C header I get this error:  </p>\n\n<pre><code>x86_64-uefi/../../libk/string.h:9:10: error: function declared 'ms_abi' here was\n      previously declared without calling convention\nKABI int memcmp(const void *d1, const void *d2, uint64_t len);\n         ^\nx86_64-uefi/../../libk/string.h:9:10: note: previous declaration is here\n</code></pre>\n\n<p>The compiler is clang and the involved files are the following:<br>\n<code>memcmp.c</code></p>\n\n<pre><code>#include \"../string.h\"\n\nKABI int memcmp(const void *d1, const void *d2, uint64_t len) {\n    const uint8_t *d1_ = d1, *d2_ = d2;\n    for(uint64_t i = 0; i &lt; len; i += 1, d1_++, d2_++){\n        if(*d1_ != *d2_) return *d1_ &lt; *d2_ ? -1 : 1;\n    }\n    return 0;\n}\n</code></pre>\n\n<p><code>string.h</code></p>\n\n<pre><code>#pragma once\n\n#include \"systemapi.h\"\n#include \"typedefs.h\"\n\nKABI int memcmp(const void *d1, const void *d2, uint64_t len);\n</code></pre>\n\n<p><code>systemapi.h</code> (typedefs just define the uintx_t types)</p>\n\n<pre><code>#pragma once\n\n#define KABI __attribute__((ms_abi))\n</code></pre>\n\n<p>Another header that includes <code>string.h</code>, <code>libk.h</code></p>\n\n<pre><code>#pragma once\n\n#include \"string.h\"\n#include \"systemapi.h\"\n#include \"typedefs.h\"\n</code></pre>\n\n<p>And the file that includes lib.h and that reports the error when compiling, <code>main.c</code> (but all files report the error when linking with <code>lib.h</code>)</p>\n\n<pre><code>KABI void arch_main(void)\n{\n     // The function does not uses memcmp, just uses the KABI part of lib.h\n     // Calling the whole lib.h is a convention \n\n}\n</code></pre>\n\n<p>Flags of the compiler: <code>-I/usr/include/efi -I/usr/include/efi/x86_64 -I/usr/include/efi/protocol -fno-stack-protector -fpic -fshort-wchar -mno-red-zone -DHAVE_USE_MS_ABI -c main.c -o main.o</code></p>\n"}, {"tags": ["c", "pointers", "random", "exec"], "comments": [{"owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "edited": false, "score": 0, "creation_date": 1514375293, "post_id": 47991612, "comment_id": 82951466, "body": "assigning an <code>int</code> to <code>char*</code>..not a good way to go. Well yes do you think those addresses are accessible? <code>0</code> to <code>RAND_MAX</code>?"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1514376181, "post_id": 47991612, "comment_id": 82951850, "body": "Pump up the compiler&#39;s warning level and take its warning(s) serious."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 1, "creation_date": 1514376594, "post_id": 47991612, "comment_id": 82952062, "body": "&quot;<i>can&#39;t actually figure out what it is</i>&quot; so what about learning C then?"}], "answers": [{"comments": [{"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1514472496, "post_id": 47993905, "comment_id": 82987334, "body": "<code>sizeof (char)</code>  equals 1 by definition."}], "tags": [], "owner": {"reputation": 9095, "user_id": 8542346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11b206b49cec657d28a5876f8330780e?s=128&d=identicon&r=PG&f=1", "display_name": "H.S.", "link": "https://stackoverflow.com/users/8542346/h-s"}, "is_accepted": false, "score": 1, "last_activity_date": 1514386225, "last_edit_date": 1592644375, "creation_date": 1514385046, "answer_id": 47993905, "question_id": 47991612, "link": "https://stackoverflow.com/questions/47991612/random-char-args-to-pass-to-execv/47993905#47993905", "title": "Random char* args[] to pass to execv", "body": "<p><strong><code>i get Error #014: Bad address.</code></strong></p>\n<p>The error message is very clear that your program is attempting to use an invalid address.</p>\n<p><code>errno</code> 14 represents <code>EFAULT</code>.</p>\n<p>From <a href=\"https://linux.die.net/man/2/execve\" rel=\"nofollow noreferrer\">execve</a></p>\n<blockquote>\n<p>EFAULT</p>\n<p>filename points outside your accessible address space.</p>\n</blockquote>\n<p>Your program is throwing this error because of these statements:</p>\n<pre><code>args[1]= name;\nargs[2]= type;\nargs[3]= rand_num;\n</code></pre>\n<p>Here <code>args</code> is of type <code>char (*)[]</code>, which is array of <code>char</code> pointers.\nSo, you are assigning integral type values to <code>char</code> pointers and compiler must be giving <strong>warning</strong> for this.</p>\n<p><code>execv()</code> access the arguments passed to it and it is giving <code>Bad address</code> error because it is considering the <code>args[1]</code> (<code>name</code>), <code>args[2]</code> (<code>type</code>) and <code>args[3]</code> (<code>rand_num</code>) as addresses and trying to access values at those addresses which is invalid.</p>\n<p>You can do:</p>\n<pre><code>void perform_exec(){\n    char type= 'A' + (random() % 2);\n    char name= 'A' + (random() % 64);\n    int rand_num= rand();\n\n    char *args[5];\n    args[0]= &quot;./test_exec&quot;;\n\n    args[1] = malloc (2 * sizeof(char)); //2 as it is either A or B\n    args[1][0] = type;\n    args[1][1] = '\\0';\n\n    args[2] = malloc (2 * sizeof(char)); //2 as it is a character\n    args[2][0] = name;\n    args[2][1] = '\\0';\n\n    args[3] = malloc (11 * sizeof(char)); //11 as INT_MAX is having 10 digits\n    snprintf (args[3], 11, &quot;%d&quot;, rand_num);\n\n    args[4]= NULL;\n\n    execv(args[0], args);\n    perror(&quot;execv failed:&quot;);\n\n    free(args[1]);\n    free(args[2]);\n    free(args[3]);\n\n    exit(EXIT_FAILURE);\n}\n</code></pre>\n<hr />\n<p>Additional:</p>\n<p>When you are running your program, you must be getting same values for <code>type</code>, <code>name</code> and <code>rand_num</code>. You might want to change the random number every time you want to run your program and to do so use <a href=\"http://www.cplusplus.com/reference/cstdlib/srand/\" rel=\"nofollow noreferrer\">srand()</a> and <a href=\"https://linux.die.net/man/3/srandom\" rel=\"nofollow noreferrer\">srandom()</a>.</p>\n"}], "owner": {"reputation": 11, "user_id": 7910265, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-uqHj7xQVdeI/AAAAAAAAAAI/AAAAAAAAADU/o-0DoW3y2s4/photo.jpg?sz=128", "display_name": "BUSHARI", "link": "https://stackoverflow.com/users/7910265/bushari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 178, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1514386225, "creation_date": 1514375215, "question_id": 47991612, "link": "https://stackoverflow.com/questions/47991612/random-char-args-to-pass-to-execv", "title": "Random char* args[] to pass to execv", "body": "<p>I need to create a char* array[] that i then have to pass to execv.</p>\n\n<ul>\n<li>the first element would be the path \"./exec_test\" </li>\n<li>for the second argument: pick randomly between A/B</li>\n<li>for the third argument: pick a random letter A - Z </li>\n<li>for the fourth argument: pick random integer between [2, 2+A_CONST]</li>\n<li><p>Then NULL</p>\n\n<pre><code>void perform_exec(){\n    char *type= 'A' + (random() % 2);\n    char *name= 'A' + (random() % 64);\n    int rand_num= rand(); \n\n    char *args[5];\n    args[0]= \"./test_exec\";\n    args[1]= name;\n    args[2]= type;\n    args[3]= rand_num;\n    args[4]= NULL;\n\n    execv(args[0], args);\n    printf(\"you souldn't see this. exec error\\n\");\n    exit(EXIT_FAILURE);\n</code></pre>\n\n<p>}</p></li>\n</ul>\n\n<p>I know there is something terribly wrong with this code, but can't actually figure out what it is.</p>\n\n<p>i get Error #014: Bad address.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 40001, "user_id": 2681632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YnXs3.png?s=128&g=1", "display_name": "Ilja Everil&#228;", "link": "https://stackoverflow.com/users/2681632/ilja-everil%c3%a4"}, "edited": false, "score": 0, "creation_date": 1514374494, "post_id": 47991383, "comment_id": 82951134, "body": "Please fix you post&#39;s formatting. Prefix lines in a code block with 4 spaces."}, {"owner": {"reputation": 89, "user_id": 4198565, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/15ae0d4ac0f40700e0184fedb3f11a93?s=128&d=identicon&r=PG&f=1", "display_name": "Johnney", "link": "https://stackoverflow.com/users/4198565/johnney"}, "reply_to_user": {"reputation": 40001, "user_id": 2681632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YnXs3.png?s=128&g=1", "display_name": "Ilja Everil&#228;", "link": "https://stackoverflow.com/users/2681632/ilja-everil%c3%a4"}, "edited": false, "score": 0, "creation_date": 1514374708, "post_id": 47991383, "comment_id": 82951229, "body": "Done.please check!"}, {"owner": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "edited": false, "score": 0, "creation_date": 1514388203, "post_id": 47991383, "comment_id": 82957252, "body": "See this related <a href=\"https://stackoverflow.com/q/32506643/1708801\">question in which a program steps outside array bounds and triggers gcc aggressive loop optimization</a> although in this example a cout obscures the warning and instead gcc turns it into an infinite loop whereas before it was finite."}, {"owner": {"reputation": 89, "user_id": 4198565, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/15ae0d4ac0f40700e0184fedb3f11a93?s=128&d=identicon&r=PG&f=1", "display_name": "Johnney", "link": "https://stackoverflow.com/users/4198565/johnney"}, "reply_to_user": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "edited": false, "score": 0, "creation_date": 1514443709, "post_id": 47991383, "comment_id": 82973974, "body": "@ShafikYaghmour ...Sure.i Will check.Thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 89, "user_id": 4198565, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/15ae0d4ac0f40700e0184fedb3f11a93?s=128&d=identicon&r=PG&f=1", "display_name": "Johnney", "link": "https://stackoverflow.com/users/4198565/johnney"}, "edited": false, "score": 0, "creation_date": 1514375049, "post_id": 47991498, "comment_id": 82951366, "body": "Eric,Thanks fro your reply.What should i need to do here to fix this?"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 89, "user_id": 4198565, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/15ae0d4ac0f40700e0184fedb3f11a93?s=128&d=identicon&r=PG&f=1", "display_name": "Johnney", "link": "https://stackoverflow.com/users/4198565/johnney"}, "edited": false, "score": 0, "creation_date": 1514375881, "post_id": 47991498, "comment_id": 82951721, "body": "@NaveenKumar: From the code you have shown, we can see <code>riv64[7-index]</code> is wrong. Without seeing more code, we cannot see why it is used or what the fix should be."}, {"owner": {"reputation": 89, "user_id": 4198565, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/15ae0d4ac0f40700e0184fedb3f11a93?s=128&d=identicon&r=PG&f=1", "display_name": "Johnney", "link": "https://stackoverflow.com/users/4198565/johnney"}, "edited": false, "score": 0, "creation_date": 1514376108, "post_id": 47991498, "comment_id": 82951811, "body": "Hi Eric, As you mentioned above riv64 is array with index 8,  snippet.                    void hdcp22UpdateConfigPseudoRandomNumberRiv( hdcp22PT hdcpP, guchar riv64[8],hdcp22T endianess) /*!endpublic*/     {    if ( endianess == P22_BIG_ENDIAN )         memcpy(hdcpP-&gt;hdcp22ConfigP-&gt;pseudoRandomNumberRiv, riv64, 8);     else {         guint index;         for ( index =0 ; index&lt;AES_BLOCK_SIZE; index++)              hdcpP-&gt;hdcp22ConfigP-&gt;pseudoRandomNumberRiv[index] = riv64[7-index];      } }"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 89, "user_id": 4198565, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/15ae0d4ac0f40700e0184fedb3f11a93?s=128&d=identicon&r=PG&f=1", "display_name": "Johnney", "link": "https://stackoverflow.com/users/4198565/johnney"}, "edited": false, "score": 0, "creation_date": 1514376860, "post_id": 47991498, "comment_id": 82952179, "body": "@NaveenKumar: That code appears to be reversing <code>riv64</code> to adjust for endianness. If so, the loop index should be limited by the size of <code>riv64</code>, not <code>AES_BLOCK_SIZE</code>. But that is still too small a portion of the code to judge well, and programs should not be debugged by means of Stack Overflow comments."}, {"owner": {"reputation": 89, "user_id": 4198565, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/15ae0d4ac0f40700e0184fedb3f11a93?s=128&d=identicon&r=PG&f=1", "display_name": "Johnney", "link": "https://stackoverflow.com/users/4198565/johnney"}, "edited": false, "score": 0, "creation_date": 1514378033, "post_id": 47991498, "comment_id": 82952726, "body": "I will check and confirm."}], "tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": false, "score": 3, "last_activity_date": 1514376594, "last_edit_date": 1514376594, "creation_date": 1514374742, "answer_id": 47991498, "question_id": 47991383, "link": "https://stackoverflow.com/questions/47991383/loop-control-is-throwing-undefined-behavior/47991498#47991498", "title": "loop control is throwing undefined behavior", "body": "<p>When <code>index</code> is 8; <code>riv64[7-index]</code> is <code>riv64[-1u]</code>, which is undefined. The <code>8u</code> in the message suggests the type of <code>index</code> is <code>unsigned int</code>, in which case <code>7-index</code> will evaluate to a very large value that is outside the array bounds. (<code>7-8u</code> will be evaluated as <code>7u-8u</code>, which is equivalent to <code>-1u</code>. Unsigned arithmetic wraps, so that produces a very large value, <code>UINT_MAX</code>.)</p>\n"}], "owner": {"reputation": 89, "user_id": 4198565, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/15ae0d4ac0f40700e0184fedb3f11a93?s=128&d=identicon&r=PG&f=1", "display_name": "Johnney", "link": "https://stackoverflow.com/users/4198565/johnney"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 322, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1514887019, "creation_date": 1514374190, "last_edit_date": 1514887019, "question_id": 47991383, "link": "https://stackoverflow.com/questions/47991383/loop-control-is-throwing-undefined-behavior", "title": "loop control is throwing undefined behavior", "body": "<p>I have upgraded my GCC compiler from 4.1.2 to 4.8.3, When i compile my source code with 4.8.3 version i am facing below issue.</p>\n\n<p>Error:\niteration 8u invokes undefined behavior [-Werror=aggressive-loop-optimizations]</p>\n\n<pre><code>{\nuint index;\nfor ( index =0 ; index&lt;BLOCK_SIZE; index++) \nltoP-&gt;kdlllp= riv64[7-index]; \n}\n</code></pre>\n\n<p>Can any one please help me in resolving this issue?</p>\n"}, {"tags": ["c", "linux"], "comments": [{"owner": {"reputation": 43, "user_id": 4804961, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/3b47e483d7580e9246b1bfea8a709cf8?s=128&d=identicon&r=PG", "display_name": "alpha0", "link": "https://stackoverflow.com/users/4804961/alpha0"}, "edited": false, "score": 0, "creation_date": 1514373573, "post_id": 47991183, "comment_id": 82950709, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/10776762/pointers-inside-shared-memory-segment\">Pointers inside shared memory segment</a>"}, {"owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "edited": false, "score": 2, "creation_date": 1514373761, "post_id": 47991183, "comment_id": 82950802, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/1561620/is-it-possible-to-use-function-pointers-across-processes\">Is it possible to use function pointers across processes?</a>"}, {"owner": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "reply_to_user": {"reputation": 43, "user_id": 4804961, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/3b47e483d7580e9246b1bfea8a709cf8?s=128&d=identicon&r=PG", "display_name": "alpha0", "link": "https://stackoverflow.com/users/4804961/alpha0"}, "edited": false, "score": 0, "creation_date": 1514373869, "post_id": 47991183, "comment_id": 82950858, "body": "@Aravind that asks about data, not function pointers."}, {"owner": {"reputation": 39, "user_id": 9050885, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e6d4918c4eb00b1d4c82541ac27a28d?s=128&d=identicon&r=PG&f=1", "display_name": "Black", "link": "https://stackoverflow.com/users/9050885/black"}, "reply_to_user": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "edited": false, "score": 0, "creation_date": 1514373875, "post_id": 47991183, "comment_id": 82950861, "body": "@Marc I am not using function pointer across application instead I am using between application and shared object"}, {"owner": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "edited": false, "score": 1, "creation_date": 1514373958, "post_id": 47991183, "comment_id": 82950898, "body": "You need to provide more information. &quot;Shared memory&quot; and &quot;shared objects&quot; are two <i>completely</i> different things."}, {"owner": {"reputation": 6746, "user_id": 1143634, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/e7lca.png?s=128&g=1", "display_name": "StaceyGirl", "link": "https://stackoverflow.com/users/1143634/staceygirl"}, "edited": false, "score": 0, "creation_date": 1514374145, "post_id": 47991183, "comment_id": 82950978, "body": "Only possible in a child-copy of its parent e.g. after <code>fork</code> not followed by <code>exec</code>."}, {"owner": {"reputation": 39, "user_id": 9050885, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e6d4918c4eb00b1d4c82541ac27a28d?s=128&d=identicon&r=PG&f=1", "display_name": "Black", "link": "https://stackoverflow.com/users/9050885/black"}, "reply_to_user": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "edited": false, "score": 0, "creation_date": 1514374508, "post_id": 47991183, "comment_id": 82951146, "body": "@Jonathon Reinhart Ok I am having a gsm library which access the gsm API. The GSM library is having a pthread and when ever an event occurs it should call a function in same format but in different applications."}], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 9050885, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e6d4918c4eb00b1d4c82541ac27a28d?s=128&d=identicon&r=PG&f=1", "display_name": "Black", "link": "https://stackoverflow.com/users/9050885/black"}, "edited": false, "score": 0, "creation_date": 1514373606, "post_id": 47991216, "comment_id": 82950726, "body": "I have access of my shared object to all the applications .But each applications are getting different instance of my .so library"}, {"owner": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "reply_to_user": {"reputation": 39, "user_id": 9050885, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e6d4918c4eb00b1d4c82541ac27a28d?s=128&d=identicon&r=PG&f=1", "display_name": "Black", "link": "https://stackoverflow.com/users/9050885/black"}, "edited": false, "score": 0, "creation_date": 1514373764, "post_id": 47991216, "comment_id": 82950804, "body": "Exactually - ld.so doesn&#39;t guarantee where the program/libraries will be loaded in a process. I think you should reconsider your design."}, {"owner": {"reputation": 39, "user_id": 9050885, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e6d4918c4eb00b1d4c82541ac27a28d?s=128&d=identicon&r=PG&f=1", "display_name": "Black", "link": "https://stackoverflow.com/users/9050885/black"}, "edited": false, "score": 0, "creation_date": 1514374156, "post_id": 47991216, "comment_id": 82950983, "body": "definitely I will consider your advice .I need to broadcast/multicast a data from ex.so to app1,app2 and app3. Can you suggest any better methodology for achieving that?"}, {"owner": {"reputation": 6746, "user_id": 1143634, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/e7lca.png?s=128&g=1", "display_name": "StaceyGirl", "link": "https://stackoverflow.com/users/1143634/staceygirl"}, "reply_to_user": {"reputation": 39, "user_id": 9050885, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e6d4918c4eb00b1d4c82541ac27a28d?s=128&d=identicon&r=PG&f=1", "display_name": "Black", "link": "https://stackoverflow.com/users/9050885/black"}, "edited": false, "score": 0, "creation_date": 1514374353, "post_id": 47991216, "comment_id": 82951073, "body": "@Black Are you looking for equivalent of Windows RWS (Read-Write-Shared) segments? There is not equivalent on Linux, you need to use this manually. And in both Windows and Linux this will not allow storing pointers in a shared segments."}, {"owner": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "edited": false, "score": 0, "creation_date": 1514374513, "post_id": 47991216, "comment_id": 82951148, "body": "Are those the same application? If a process forks multiple children, they will all have their code loaded at the same addresses. In that case, there&#39;s no need for &quot;shared memory&quot; (shm_get) - you could just <code>mmap(MAP_SHARED)</code> an anonymous region and use that between all child processes."}, {"owner": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "edited": false, "score": 0, "creation_date": 1514374592, "post_id": 47991216, "comment_id": 82951187, "body": "If these are different applications that aren&#39;t children of a single parent, then you will need to avoid putting pointers in the shared memory region."}, {"owner": {"reputation": 39, "user_id": 9050885, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e6d4918c4eb00b1d4c82541ac27a28d?s=128&d=identicon&r=PG&f=1", "display_name": "Black", "link": "https://stackoverflow.com/users/9050885/black"}, "edited": false, "score": 0, "creation_date": 1514374640, "post_id": 47991216, "comment_id": 82951206, "body": "@Jonathon Reinhart Nope they all are different applications but require some or other service of GSM API"}, {"owner": {"reputation": 39, "user_id": 9050885, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e6d4918c4eb00b1d4c82541ac27a28d?s=128&d=identicon&r=PG&f=1", "display_name": "Black", "link": "https://stackoverflow.com/users/9050885/black"}, "edited": false, "score": 0, "creation_date": 1514374791, "post_id": 47991216, "comment_id": 82951265, "body": "@Jonathon Reinhart the event is happening in the thread of gsmlib.so  .The   lib should inform the applications about the event and that is what I am trying to acheive. Hope u got me"}, {"owner": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "edited": false, "score": 0, "creation_date": 1514375013, "post_id": 47991216, "comment_id": 82951348, "body": "That thread exists in each process that is using the library then. It is not clear why shared memory is being used here."}, {"owner": {"reputation": 39, "user_id": 9050885, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e6d4918c4eb00b1d4c82541ac27a28d?s=128&d=identicon&r=PG&f=1", "display_name": "Black", "link": "https://stackoverflow.com/users/9050885/black"}, "edited": false, "score": 0, "creation_date": 1514375833, "post_id": 47991216, "comment_id": 82951692, "body": "@Jonathon Reinhart when i registered the call back in the library from different applications ,the call back happened only to one applications.So I thought if I save every function pointer registrations in shared memory then i can make an array like structure of function pointer and in loop i can call back the functions like broadcast/multicast"}, {"owner": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "edited": false, "score": 0, "creation_date": 1514402560, "post_id": 47991216, "comment_id": 82963283, "body": "Oh my god. Talk about an <a href=\"https://meta.stackexchange.com/questions/66377/what-is-the-xy-problem\">XY problem</a>."}], "tags": [], "owner": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "is_accepted": false, "score": 3, "last_activity_date": 1514373435, "creation_date": 1514373435, "answer_id": 47991216, "question_id": 47991183, "link": "https://stackoverflow.com/questions/47991183/save-function-pointer-in-shared-memory/47991216#47991216", "title": "Save function pointer in shared memory", "body": "<p>No.</p>\n\n<p>Unless you have somehow loaded your code into the shared memory region, or otherwise caused the code to be loaded at the same address in both processes, the function pointer will not be valid.</p>\n"}, {"tags": [], "owner": {"reputation": 43, "user_id": 4804961, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/3b47e483d7580e9246b1bfea8a709cf8?s=128&d=identicon&r=PG", "display_name": "alpha0", "link": "https://stackoverflow.com/users/4804961/alpha0"}, "is_accepted": false, "score": 0, "last_activity_date": 1514373873, "creation_date": 1514373873, "answer_id": 47991323, "question_id": 47991183, "link": "https://stackoverflow.com/questions/47991183/save-function-pointer-in-shared-memory/47991323#47991323", "title": "Save function pointer in shared memory", "body": "<p>Unless you are completely sure of what you are doing, It sounds a bad idea to me to save function pointers in shared memory segment, You may end up accessing a function pointer which your process doesn't have privilege of and may end up in crashing your program.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 6543429, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36fb6e1d1e4f487fc3f5745d61754232?s=128&d=identicon&r=PG&f=1", "display_name": "Masum", "link": "https://stackoverflow.com/users/6543429/masum"}, "is_accepted": false, "score": -1, "last_activity_date": 1514373897, "creation_date": 1514373897, "answer_id": 47991328, "question_id": 47991183, "link": "https://stackoverflow.com/questions/47991183/save-function-pointer-in-shared-memory/47991328#47991328", "title": "Save function pointer in shared memory", "body": "<p>no, cannot share the function pointer , if you want, u need to make library of that function and use it in your process</p>\n"}, {"tags": [], "owner": {"reputation": 4569, "user_id": 1282773, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/GFxGD.jpg?s=128&g=1", "display_name": "ivaigult", "link": "https://stackoverflow.com/users/1282773/ivaigult"}, "is_accepted": false, "score": 0, "last_activity_date": 1577992156, "last_edit_date": 1577992156, "creation_date": 1514393381, "answer_id": 47995801, "question_id": 47991183, "link": "https://stackoverflow.com/questions/47991183/save-function-pointer-in-shared-memory/47995801#47995801", "title": "Save function pointer in shared memory", "body": "<p>It is not guaranteed that a shared library will be loaded to the same address for two different applications. Even worse, a library could be loaded to any random address due to address space layout randomization. Hence, a function pointer is not invariant and hence can't be stored anywhere.</p>\n\n<p>As solution, you could create a function table with all possible callbacks in both processes and store offset to a function in shared memory. For sure, those tables should be <em>exactly</em> the same.</p>\n"}], "owner": {"reputation": 39, "user_id": 9050885, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e6d4918c4eb00b1d4c82541ac27a28d?s=128&d=identicon&r=PG&f=1", "display_name": "Black", "link": "https://stackoverflow.com/users/9050885/black"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 525, "favorite_count": 1, "answer_count": 4, "score": 2, "last_activity_date": 1577992156, "creation_date": 1514373272, "question_id": 47991183, "link": "https://stackoverflow.com/questions/47991183/save-function-pointer-in-shared-memory", "title": "Save function pointer in shared memory", "body": "<p>I know that data can be saved and utilized by multiple applications using shared memory .I would like to know is it possible to save the function pointer in shared memory?My purpose here is to make a call back from my shared object to functions with same return value and parameter of different applications.</p>\n"}, {"tags": ["python", "c", "gcc", "pip", "pysam"], "answers": [{"tags": [], "owner": {"reputation": 39, "user_id": 7580287, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-IpZKcRP6if0/AAAAAAAAAAI/AAAAAAAABkY/_MDAOKM-8Qs/photo.jpg?sz=128", "display_name": "Rafail Tasakis", "link": "https://stackoverflow.com/users/7580287/rafail-tasakis"}, "is_accepted": false, "score": 1, "last_activity_date": 1514383306, "last_edit_date": 1514383306, "creation_date": 1514373160, "answer_id": 47991147, "question_id": 47990935, "link": "https://stackoverflow.com/questions/47990935/failed-to-install-pysam-0-13/47991147#47991147", "title": "Failed to install pysam 0.13", "body": "<p>Actually I solved it So the problem was the htslib. Solved with:</p>\n\n<pre><code>export HTSLIB_LIBRARY_DIR=/usr/local/lib\nexport HTSLIB_INCLUDE_DIR=/usr/local/include\npip install pysam\n</code></pre>\n\n<p>The problem was the contradictory htslib libraries in the same directories. </p>\n"}, {"tags": [], "owner": {"reputation": 35789, "user_id": 1219295, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BmJq2.png?s=128&g=1", "display_name": "Roland Smith", "link": "https://stackoverflow.com/users/1219295/roland-smith"}, "is_accepted": false, "score": 1, "last_activity_date": 1514373601, "creation_date": 1514373601, "answer_id": 47991260, "question_id": 47990935, "link": "https://stackoverflow.com/questions/47990935/failed-to-install-pysam-0-13/47991260#47991260", "title": "Failed to install pysam 0.13", "body": "<p>Sometimes software needs modifications (patches) to work on a specific operating system. Or it won't build when you have older header files installed. Or it needs a different compiler.</p>\n\n<p>Since your system (macOS) lacks a good native package management, I would suggest that you use a Python distribution that has its own package manager, like e.g. <a href=\"https://www.anaconda.com/download/\" rel=\"nofollow noreferrer\">anaconda</a>.</p>\n\n<p>Such distributions have a lot of pre-compiled packages (like pysam) available. They can save you a lot of time.</p>\n"}], "owner": {"reputation": 39, "user_id": 7580287, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-IpZKcRP6if0/AAAAAAAAAAI/AAAAAAAABkY/_MDAOKM-8Qs/photo.jpg?sz=128", "display_name": "Rafail Tasakis", "link": "https://stackoverflow.com/users/7580287/rafail-tasakis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 369, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1514383306, "creation_date": 1514372191, "last_edit_date": 1514383254, "question_id": 47990935, "link": "https://stackoverflow.com/questions/47990935/failed-to-install-pysam-0-13", "title": "Failed to install pysam 0.13", "body": "<p>I keep on failing to install pysam 0.13 on macOS High Sierra. \nTo sum up my two errors: </p>\n\n<pre><code>htslib/htslib/hts.h:142:9: error: missing ',' between enumerators\n    json HTS_DEPRECATED_ENUM(\"Use htsExactFormat 'htsget' instead\") = htsget,\n        ^\n        ,  htslib/htslib/hts.h:142:29: error: expected '= constant-expression' or end of\n      enumerator definition\n    json HTS_DEPRECATED_ENUM(\"Use htsExactFormat 'htsget' instead\") = htsget,\n                        ^\n</code></pre>\n\n<p>2 errors generated.</p>\n\n<blockquote>\n  <p>error: command 'gcc' failed with exit status 1</p>\n</blockquote>\n\n<p>Any ideas what to do?</p>\n"}, {"tags": ["c", "embedded", "embedded-linux"], "comments": [{"owner": {"reputation": 3794, "user_id": 7256714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adeb98b0e8995d8576ad5f66c0f982e5?s=128&d=identicon&r=PG&f=1", "display_name": "Pras", "link": "https://stackoverflow.com/users/7256714/pras"}, "edited": false, "score": 2, "creation_date": 1514367738, "post_id": 47989701, "comment_id": 82947932, "body": "You can add version as member of your structure and assume number of fields accordingly"}, {"owner": {"reputation": 17958, "user_id": 1971013, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/EtqFE.jpg?s=128&g=1", "display_name": "meaning-matters", "link": "https://stackoverflow.com/users/1971013/meaning-matters"}, "edited": false, "score": 0, "creation_date": 1514371960, "post_id": 47989701, "comment_id": 82949955, "body": "Will you really downgrade firmware?"}, {"owner": {"reputation": 11, "user_id": 5897173, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WXrPI.jpg?s=128&g=1", "display_name": "Kuldip_036", "link": "https://stackoverflow.com/users/5897173/kuldip-036"}, "edited": false, "score": 0, "creation_date": 1514372338, "post_id": 47989701, "comment_id": 82950120, "body": "No I won&#39;t downgrade hardware. software only"}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1514376223, "post_id": 47989701, "comment_id": 82951872, "body": "when you re-compile it all works, if you are using structures across compile domains then that is your problem.  dont do that."}, {"owner": {"reputation": 4888, "user_id": 5785362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a786fd81952576dc07942023bf8830b?s=128&d=identicon&r=PG", "display_name": "tofro", "link": "https://stackoverflow.com/users/5785362/tofro"}, "edited": false, "score": 0, "creation_date": 1514385743, "post_id": 47989701, "comment_id": 82956191, "body": "If you make sure that you extend the structure at the end and are careful to never remove fields, you can copy over from config space into memory using <code>memset</code> to initialize the structure and <code>memcpy</code>. This covers only upgrades, though."}], "answers": [{"tags": [], "owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "is_accepted": false, "score": 1, "last_activity_date": 1514374336, "creation_date": 1514374336, "answer_id": 47991420, "question_id": 47989701, "link": "https://stackoverflow.com/questions/47989701/config-handling-in-structural-configuration-using-c-language/47991420#47991420", "title": "Config Handling in structural configuration using C language", "body": "<p>This can be done in several ways.</p>\n\n<p>One approach is to store configuration values as key:value pairs.\nFor instance:</p>\n\n<pre><code>\"biasVoltage1\":0.45\n\"biasVoltage2\":0.52\n\"nextKey\":value\n</code></pre>\n\n<p>First you initialize your struct members with default values.\nThen you read the key:value pairs one by one.\nIf a key is known by running SW version, you parse the value and write it to the struct.\nIf a key is unknown by running SW version, you ignore the value.</p>\n\n<p>In this way each SW version will get exactly the configuration values it knows about (or a default value if a key is missing).</p>\n\n<p>The keys doesn't have to be strings as indicated above. An alternative is to enumerate the keys.</p>\n"}, {"tags": [], "owner": {"reputation": 3209, "user_id": 5794048, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Egkox.jpg?s=128&g=1", "display_name": "Murphy", "link": "https://stackoverflow.com/users/5794048/murphy"}, "is_accepted": false, "score": 0, "last_activity_date": 1515588320, "creation_date": 1515588320, "answer_id": 48187803, "question_id": 47989701, "link": "https://stackoverflow.com/questions/47989701/config-handling-in-structural-configuration-using-c-language/48187803#48187803", "title": "Config Handling in structural configuration using C language", "body": "<p>Definitely don't store your configuration as binary, such as a memory dump of a struct; this will get you into maintenance hell in the mid term. Recommended reading:</p>\n\n<p><a href=\"http://www.catb.org/esr/writings/taoup/html/textualitychapter.html\" rel=\"nofollow noreferrer\">http://www.catb.org/esr/writings/taoup/html/textualitychapter.html</a></p>\n\n<p>A common pattern is to store config data in <a href=\"https://en.wikipedia.org/wiki/INI_file\" rel=\"nofollow noreferrer\">INI style files</a>, for which many plus one implementations exist for about every programming language in use, so no need to roll your own. Most config files in <code>/etc</code> are a good example for this practice.</p>\n"}], "owner": {"reputation": 11, "user_id": 5897173, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WXrPI.jpg?s=128&g=1", "display_name": "Kuldip_036", "link": "https://stackoverflow.com/users/5897173/kuldip-036"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 157, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1515588320, "creation_date": 1514367532, "question_id": 47989701, "link": "https://stackoverflow.com/questions/47989701/config-handling-in-structural-configuration-using-c-language", "title": "Config Handling in structural configuration using C language", "body": "<p>Working on Small Embedded System in which am storing configurations in structure.</p>\n\n<p>Now Suppose current config structure has 5 member and in future it will increase or decrease and in past might be it had 3 members only.</p>\n\n<p>So while Upgrading and Downgrading Firmware it is getting difficult to read configurations because we dont know how many members will be there in structure.</p>\n\n<p>please suggest way to handle</p>\n"}, {"tags": ["c++", "c", "timer", "signals", "solaris-10"], "comments": [{"owner": {"reputation": 17958, "user_id": 1971013, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/EtqFE.jpg?s=128&g=1", "display_name": "meaning-matters", "link": "https://stackoverflow.com/users/1971013/meaning-matters"}, "edited": false, "score": 0, "creation_date": 1514367395, "post_id": 47989417, "comment_id": 82947772, "body": "Where&#39;s the error?"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1514370226, "post_id": 47989417, "comment_id": 82949093, "body": "For your reference: <a href=\"https://docs.oracle.com/cd/E26505_01/html/816-5171/timer-create-3rt.html\" rel=\"nofollow noreferrer\">docs.oracle.com/cd/E26505_01/html/816-5171/&hellip;</a>"}, {"owner": {"reputation": 211, "user_id": 7961067, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6dd43dc48c51258a507eee761c7bc039?s=128&d=identicon&r=PG&f=1", "display_name": "Shivam", "link": "https://stackoverflow.com/users/7961067/shivam"}, "edited": false, "score": 0, "creation_date": 1514370391, "post_id": 47989417, "comment_id": 82949188, "body": "timer_id is a variable which i defined like this (timer_t  *timer_id)"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1514370441, "post_id": 47989417, "comment_id": 82949218, "body": "Where does it point to, before you pass it?"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1514370541, "post_id": 47989417, "comment_id": 82949282, "body": "Related: <a href=\"https://stackoverflow.com/q/47941299/694576\">stackoverflow.com/q/47941299/694576</a> if not a duplicate to."}, {"owner": {"reputation": 211, "user_id": 7961067, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6dd43dc48c51258a507eee761c7bc039?s=128&d=identicon&r=PG&f=1", "display_name": "Shivam", "link": "https://stackoverflow.com/users/7961067/shivam"}, "edited": false, "score": 0, "creation_date": 1514370689, "post_id": 47989417, "comment_id": 82949355, "body": "this is not pointing to anywhere i am declaring it like this timer_t  timerPostDeviceUpdate_id;"}, {"owner": {"reputation": 211, "user_id": 7961067, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6dd43dc48c51258a507eee761c7bc039?s=128&d=identicon&r=PG&f=1", "display_name": "Shivam", "link": "https://stackoverflow.com/users/7961067/shivam"}, "edited": false, "score": 0, "creation_date": 1514371118, "post_id": 47989417, "comment_id": 82949574, "body": "ya that one( stackoverflow.com/q/47941299/694576) is also mine  i want to get rid of this issue.. solaris 10 only returning EINVAL for timer_create i also checked code of timer.c to find out my mistake but i didn&#39;t get anything link of timer.c (<a href=\"https://code.woboq.org/userspace/glibc/sysdeps/pthread/timer_create.c.html\" rel=\"nofollow noreferrer\">code.woboq.org/userspace/glibc/sysdeps/pthread/&hellip;</a>)"}], "answers": [{"comments": [{"owner": {"reputation": 211, "user_id": 7961067, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6dd43dc48c51258a507eee761c7bc039?s=128&d=identicon&r=PG&f=1", "display_name": "Shivam", "link": "https://stackoverflow.com/users/7961067/shivam"}, "edited": false, "score": 0, "creation_date": 1514372113, "post_id": 47990578, "comment_id": 82950031, "body": "Thankyou so much for your help, according to my requirement i want to invoke a funtion at particular time period, i don&#39;t know much about SIGEV_PORT so can i use this, if yes then please guide me."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "reply_to_user": {"reputation": 211, "user_id": 7961067, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6dd43dc48c51258a507eee761c7bc039?s=128&d=identicon&r=PG&f=1", "display_name": "Shivam", "link": "https://stackoverflow.com/users/7961067/shivam"}, "edited": false, "score": 0, "creation_date": 1514375309, "post_id": 47990578, "comment_id": 82951472, "body": "Solaris 11 seem to support <code>SIGEV_THREAD</code>: <a href=\"https://docs.oracle.com/cd/E86824_01/html/E54772/signal.h-3head.html#scrolltoc\" rel=\"nofollow noreferrer\">docs.oracle.com/cd/E86824_01/html/E54772/&hellip;</a>"}, {"owner": {"reputation": 211, "user_id": 7961067, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6dd43dc48c51258a507eee761c7bc039?s=128&d=identicon&r=PG&f=1", "display_name": "Shivam", "link": "https://stackoverflow.com/users/7961067/shivam"}, "edited": false, "score": 0, "creation_date": 1514384145, "post_id": 47990578, "comment_id": 82955475, "body": "In solaris 11 my code is working fine. But my doubt is that timer.h and signal.h are defined under glibc then why arent they supported in solaris 10 but in solairs 11. I printed SIGEV_THREAD macro and its giving the value to be 3 in solaris 10."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "reply_to_user": {"reputation": 211, "user_id": 7961067, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6dd43dc48c51258a507eee761c7bc039?s=128&d=identicon&r=PG&f=1", "display_name": "Shivam", "link": "https://stackoverflow.com/users/7961067/shivam"}, "edited": false, "score": 0, "creation_date": 1514398058, "post_id": 47990578, "comment_id": 82961468, "body": "@ram: Headers are just sugar.  If the library implementing the cake does  not handle it, there  is no way to convince it to do so."}, {"owner": {"reputation": 211, "user_id": 7961067, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6dd43dc48c51258a507eee761c7bc039?s=128&d=identicon&r=PG&f=1", "display_name": "Shivam", "link": "https://stackoverflow.com/users/7961067/shivam"}, "edited": false, "score": 0, "creation_date": 1514468095, "post_id": 47990578, "comment_id": 82985083, "body": "Is there some other way to schedule my funtions in solaris 10??"}], "tags": [], "owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "is_accepted": false, "score": 1, "last_activity_date": 1514370758, "creation_date": 1514370758, "answer_id": 47990578, "question_id": 47989417, "link": "https://stackoverflow.com/questions/47989417/why-timer-create-throw-error-for-sigev-thread-in-solaris-10/47990578#47990578", "title": "Why timer_create throw error for SIGEV_THREAD in solaris 10?", "body": "<p>As per <a href=\"https://docs.oracle.com/cd/E26505_01/html/816-5173/signal.h-3head.html\" rel=\"nofollow noreferrer\">this man-page</a> Solaris 10 does not know <code>SIGEV_THREAD</code>, but only</p>\n\n<blockquote>\n  <p>The <code>sigev_notify</code> member specifies the notification mechanism to use when an asynchronous event occurs. The sigev_notify member may be defined with the following values:</p>\n  \n  <p><strong><code>SIGEV_NONE</code></strong></p>\n  \n  <p>No asynchronous notification is delivered when the event of interest occurs.</p>\n  \n  <p><strong><code>SIGEV_SIGNAL</code></strong></p>\n  \n  <p>A queued signal, with its value application-defined, is generated when the event of interest occurs.</p>\n  \n  <p><strong><code>SIGEV_PORT</code></strong></p>\n  \n  <p>An asynchronous notification is delivered to an event port when the event of interest occurs. The <code>sival_ptr</code> member points to a <code>port_notify_t</code> structure (see <code>port_associate(3C)</code>). The event port identifier as well as an application-defined cookie are part of the <code>port_notify_t</code> structure</p>\n</blockquote>\n"}], "owner": {"reputation": 211, "user_id": 7961067, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6dd43dc48c51258a507eee761c7bc039?s=128&d=identicon&r=PG&f=1", "display_name": "Shivam", "link": "https://stackoverflow.com/users/7961067/shivam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 179, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1514371139, "creation_date": 1514366317, "last_edit_date": 1514371139, "question_id": 47989417, "link": "https://stackoverflow.com/questions/47989417/why-timer-create-throw-error-for-sigev-thread-in-solaris-10", "title": "Why timer_create throw error for SIGEV_THREAD in solaris 10?", "body": "<p>I wrote a piece of by using timer_create for sets the timer to invoke a thread in which i set sigev_notify as SIGEV_THREAD, it is giving me error EINVAL(Invalid argument) but when i am setting sigev_notify as SIGEV_SIGNAL code is working fine.</p>\n\n<p>my this piece of code is working in all OS even in solaris 11 but for solaris 10 giving me error.</p>\n\n<p>code given below:</p>\n\n<pre><code>{\nint status =0;\nstruct itimerspec ts;\nstruct sigevent se;\n\nse.sigev_notify = SIGEV_THREAD;\nse.sigev_value.sival_int = val;\nse.sigev_notify_function = func;\nse.sigev_notify_attributes = NULL;\n\nstatus = timer_create(CLOCK_REALTIME, &amp;se, timer_id);\n\nts.it_value.tv_sec = abs(delay);\nts.it_value.tv_nsec = (delay-abs(delay)) * 1e09;\nts.it_interval.tv_sec = abs(interval);\nts.it_interval.tv_nsec = (interval-abs(interval)) * 1e09;\n\nstatus = timer_settime(*timer_id, 0, &amp;ts, 0);\n</code></pre>\n\n<p>}</p>\n\n<p>Please help me to solve this issue.</p>\n\n<p>Thanks in advance...</p>\n"}, {"tags": ["c", "hash"], "comments": [{"owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "edited": false, "score": 0, "creation_date": 1514365252, "post_id": 47989147, "comment_id": 82946860, "body": "maybe hash doesn&#39;t occur?"}, {"owner": {"reputation": 4251, "user_id": 4605105, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh4.googleusercontent.com/-_cFfGx1khYs/AAAAAAAAAAI/AAAAAAAAGt0/vfQ_28nwAEE/photo.jpg?sz=128", "display_name": "&#212;rel", "link": "https://stackoverflow.com/users/4605105/%c3%94rel"}, "edited": false, "score": 0, "creation_date": 1514365258, "post_id": 47989147, "comment_id": 82946863, "body": "The issue seems to be on the way you call your program with the hash. Try to print to input search string to check it."}, {"owner": {"reputation": 3794, "user_id": 7256714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adeb98b0e8995d8576ad5f66c0f982e5?s=128&d=identicon&r=PG&f=1", "display_name": "Pras", "link": "https://stackoverflow.com/users/7256714/pras"}, "edited": false, "score": 1, "creation_date": 1514365603, "post_id": 47989147, "comment_id": 82947005, "body": "You need to escape $ if it is part of your command line arguments"}, {"owner": {"reputation": 59, "user_id": 9132867, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/7f306e047c408bd4be04366761f97cd7?s=128&d=identicon&r=PG&f=1", "display_name": "catmix", "link": "https://stackoverflow.com/users/9132867/catmix"}, "edited": false, "score": 0, "creation_date": 1514366792, "post_id": 47989147, "comment_id": 82947514, "body": "Awesome ! There is an issue with how the program handles &#39;$&#39;. It prints out &quot;3242t8TX0OHN6Wsx6vlPZNKik1&quot;                                                      instead of &quot;$1$$t8TX0OHN6Wsx6vlPZNKik1&quot;                                                  What can I do to overcome this ?                                                                           Edit: Formatting and character length"}], "answers": [{"comments": [{"owner": {"reputation": 59, "user_id": 9132867, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/7f306e047c408bd4be04366761f97cd7?s=128&d=identicon&r=PG&f=1", "display_name": "catmix", "link": "https://stackoverflow.com/users/9132867/catmix"}, "edited": false, "score": 0, "creation_date": 1514366996, "post_id": 47989472, "comment_id": 82947599, "body": "Awesome ! Thank you. I&#39;ll figure out a way to add the backslash to each occurence of &#39;$&#39; :)"}], "tags": [], "owner": {"reputation": 3794, "user_id": 7256714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adeb98b0e8995d8576ad5f66c0f982e5?s=128&d=identicon&r=PG&f=1", "display_name": "Pras", "link": "https://stackoverflow.com/users/7256714/pras"}, "is_accepted": false, "score": 0, "last_activity_date": 1514366503, "creation_date": 1514366503, "answer_id": 47989472, "question_id": 47989147, "link": "https://stackoverflow.com/questions/47989147/matching-hashes-in-c/47989472#47989472", "title": "Matching hashes in C", "body": "<p>From comments you seem to agree your command lines have $, you dont need to handle it in code,rather while passing it from shell you need to escape them  like:</p>\n\n<pre><code>./test hashtext \\$1\\$\\$t8TX0OHN6Wsx6vlPZNKik1\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 563, "user_id": 5699882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-sPL4bZXU7W4/AAAAAAAAAAI/AAAAAAAAAWg/FOG3peQI48A/photo.jpg?sz=128", "display_name": "Mayank Verma", "link": "https://stackoverflow.com/users/5699882/mayank-verma"}, "is_accepted": true, "score": 0, "last_activity_date": 1514367659, "creation_date": 1514367659, "answer_id": 47989734, "question_id": 47989147, "link": "https://stackoverflow.com/questions/47989147/matching-hashes-in-c/47989734#47989734", "title": "Matching hashes in C", "body": "<p>Your hash string has '$'s in it. Bash considers it as a special character. Special characters need to be escaped in order to remove the special meaning of these characters.</p>\n\n<p>Depending on the situation you can do either of the following to handle them:</p>\n\n<ol>\n<li>Escape the special characters individually using <code>\\</code>. Your input string would look like <code>\\$1\\$\\$t8TX0OHN6Wsx6vlPZNKik1</code>.</li>\n<li>Escape the special characters from the entire string using <code>'</code>. Your input string would look like <code>'$1$$t8TX0OHN6Wsx6vlPZNKik1'</code>.</li>\n<li>Load the string from <code>stdin</code> by redirection. However, you'll need to edit your program for this. You won't need to escape the characters.</li>\n</ol>\n\n<p>Here's the comprehensive list of many special characters in bash: <a href=\"https://docstore.mik.ua/orelly/unix/upt/ch08_19.htm\" rel=\"nofollow noreferrer\">https://docstore.mik.ua/orelly/unix/upt/ch08_19.htm</a></p>\n"}], "owner": {"reputation": 59, "user_id": 9132867, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/7f306e047c408bd4be04366761f97cd7?s=128&d=identicon&r=PG&f=1", "display_name": "catmix", "link": "https://stackoverflow.com/users/9132867/catmix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 47989734, "answer_count": 2, "score": 0, "last_activity_date": 1514367659, "creation_date": 1514365038, "question_id": 47989147, "link": "https://stackoverflow.com/questions/47989147/matching-hashes-in-c", "title": "Matching hashes in C", "body": "<p>I am fairly new to C and am currently practicing by writing a program which that allows users to search for hashes written in a text file. I have come up with the following program:</p>\n\n<p>HashMatch.c</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;string.h&gt;\n#include&lt;stdlib.h&gt;\n\n//Declaring Functions\nint searchstringinfile(char *string, char *filename);\nvoid UsageInfo(char *filename);\n\n//Display usage info on arguements for program\nvoid UsageInfo(char *filename) {\n    printf(\"Usage: %s &lt;file&gt; &lt;string&gt;\\n\", filename);\n\n}\n\nint searchstringinfile(char *filename, char *string) {\n    //Define File\n    FILE *userfile;\n\n    int linenumber = 1;\n    int search_result = 0;\n    char temp[10000];\n\n    //Error handling for invalid file\n    if((userfile = fopen(filename, \"r\")) == NULL) {\n        return(-1);\n    }\n\n\n    //Matching words line-by-line\n    while(fgets(temp, 10000, userfile) != NULL) {\n        if((strstr(temp, string)) != NULL) {\n        //Display line in which matched word is found\n            printf(\"A match found on line: %d\\n\", linenumber);\n            printf(\"\\n%s\\n\", temp);\n            search_result++;\n    }\n    linenumber++;\n}\n\n\n    // Display message if no matches are found\n    if(search_result == 0) {\n        printf(\"\\nSorry, couldn't find a match.\\n\");\n    }\n\n    //Closes the file.\n    if(userfile) {\n        fclose(userfile);\n    }\n    return(0);\n}\n\n\n//main function.\nint main(int argc, char *argv[]) {\n    int result, errcode;\n    //Display format for user to enter arguements and\n    //End program if user does not enter exactly 3 arguements\n    if(argc &lt; 3 || argc &gt; 3) {\n        UsageInfo(argv[0]);\n        exit(1);\n}\n\n\n    system(\"cls\");\n//Pass command line arguements into searchstringinfile\n    result = searchstringinfile(argv[1], argv[2]);\n//Display error message\n        if(result == -1) {\n            perror(\"Error\");\n            printf(\"Error number = %d\\n\", errcode);\n            exit(1);\n    }\n    return(0);\n}\n</code></pre>\n\n<p>I have also come up with a file containing one string and one hash:</p>\n\n<p>Hashtext.txt</p>\n\n<pre><code>$1$$t8TX0OHN6Wsx6vlPZNKik1\nIce-Cream\nI SCREAM FOR Ice-Cream !\n</code></pre>\n\n<p>If I were to search for the word Ice-Cream as such:</p>\n\n<pre><code>./test hashtext Ice-Cream\n</code></pre>\n\n<p>I am able to find lines containing said word :</p>\n\n<pre><code>A match found on line: 2\n\nIce-Cream\n\nA match found on line: 3\n\nI SCREAM FOR Ice-Cream !\n</code></pre>\n\n<p>However if I were to search for the hash in the text , I am unable to do so.\nCould anyone enlighten me on why I am unable to search for the hash and guide me through the steps to allow me to do so ? </p>\n\n<p>Thank You.</p>\n"}, {"tags": ["c++", "c", "multithreading", "race-condition"], "comments": [{"owner": {"reputation": 9105, "user_id": 119861, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/O2tUa.png?s=128&g=1", "display_name": "hansaplast", "link": "https://stackoverflow.com/users/119861/hansaplast"}, "edited": false, "score": 1, "creation_date": 1514364774, "post_id": 47988994, "comment_id": 82946656, "body": "I guess the question is if <code>var++</code> is atomic, i.e. the write and the read of the variable can&#39;t be interrupted by another thread. If it can be interrupted, then both threads might read the same value of <code>var</code> and both increment it at the same time, thus var will not be 40 in the end"}, {"owner": {"reputation": 2760, "user_id": 1971003, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/g36XB.jpg?s=128&g=1", "display_name": "Guy Avraham", "link": "https://stackoverflow.com/users/1971003/guy-avraham"}, "reply_to_user": {"reputation": 9105, "user_id": 119861, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/O2tUa.png?s=128&g=1", "display_name": "hansaplast", "link": "https://stackoverflow.com/users/119861/hansaplast"}, "edited": false, "score": 3, "creation_date": 1514364938, "post_id": 47988994, "comment_id": 82946729, "body": "@hansaplast - As far as I know, you can never assume that the increment operation is atomic. Also, the two threads might run on two different cores so I think &quot;cache coherency&quot; issues should be considered here (might effect) the final value of var at the end of the program."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 3, "creation_date": 1514365472, "post_id": 47988994, "comment_id": 82946958, "body": "The behaviour is undefined. One possible final value for <code>var</code> is a bowl of petunias."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 2, "creation_date": 1514365819, "post_id": 47988994, "comment_id": 82947079, "body": "Speculating on the behaviour of acknowledged bad code is pointless and of no use to future SO users/visitors."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2672107"}, "edited": false, "score": 4, "creation_date": 1514370642, "post_id": 47988994, "comment_id": 82949333, "body": "<i>I encountered this question:</i> aka my homework is"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1514372339, "post_id": 47988994, "comment_id": 82950121, "body": "@n.m. Oh no, not again.  ;)"}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 1, "creation_date": 1514385689, "post_id": 47988994, "comment_id": 82956162, "body": "There is no synchronization between the threads, so the code produces a <b>data race</b>. As a result, the behavior <b>of the program</b> is undefined. That means that running <b>the program</b> can do anything and still conform to the language definition."}], "answers": [{"comments": [{"owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 2, "creation_date": 1514365081, "post_id": 47989110, "comment_id": 82946790, "body": "In C and C++ the code has a race condition, and it is therefore undefined behavior. With that in mind, it is not meaningful to give guarantees such as a minimum or maximum value, since any guarantees are forfeited when you encounter undefined behavior."}, {"owner": {"reputation": 9105, "user_id": 119861, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/O2tUa.png?s=128&g=1", "display_name": "hansaplast", "link": "https://stackoverflow.com/users/119861/hansaplast"}, "reply_to_user": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 1, "creation_date": 1514365242, "post_id": 47989110, "comment_id": 82946850, "body": "@nos Hmm.. can you come up with any race condition that would push the minimal end value below 20?"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1514365322, "post_id": 47989110, "comment_id": 82946890, "body": "@hansaplast it is also possible for the value to turn out to be negative, since the semantics of race conditions aren&#39;t defined in C."}, {"owner": {"reputation": 2760, "user_id": 1971003, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/g36XB.jpg?s=128&g=1", "display_name": "Guy Avraham", "link": "https://stackoverflow.com/users/1971003/guy-avraham"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1514365990, "post_id": 47989110, "comment_id": 82947149, "body": "@AjayBrahmakshatriya - How is it possible (negative value or even below 20 of var at the end of the program)?"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 2760, "user_id": 1971003, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/g36XB.jpg?s=128&g=1", "display_name": "Guy Avraham", "link": "https://stackoverflow.com/users/1971003/guy-avraham"}, "edited": false, "score": 2, "creation_date": 1514366155, "post_id": 47989110, "comment_id": 82947223, "body": "@GuyAvraham because race condition is undefined behavior and anything can happen. But to give you a case where it <b>can</b> happen, <code>int</code> is a multibyte data type in memory. On some platform and some representation of integers, it could lead to interleaved partial writes which can lead to a negative value."}, {"owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 1, "creation_date": 1514366257, "post_id": 47989110, "comment_id": 82947267, "body": "@hansaplast The compiler could analyze the program and determine that the global variable is not used and just eliminate the loop and assignment to the global variable (the compiler could make that assumption even if the there are code that actually uses the variable, as the compiler can also assume that no undefined behavior occurs). Some compilers have options that would halt or crash the program when it detects a race condition, in which case there would also be no value assigned to the global variable."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 1, "creation_date": 1514372241, "post_id": 47989110, "comment_id": 82950083, "body": "@AjayBrahmakshatriya <i>On some platform and some representation of integers, it could lead to interleaved partial writes which can lead to a negative value</i> Even x86 probably isn&#39;t immune to that, if the <code>int</code> value is misaligned in memory."}, {"owner": {"reputation": 9105, "user_id": 119861, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/O2tUa.png?s=128&g=1", "display_name": "hansaplast", "link": "https://stackoverflow.com/users/119861/hansaplast"}, "reply_to_user": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 0, "creation_date": 1514568376, "post_id": 47989110, "comment_id": 83021917, "body": "@nos I ran some tests on different environments and: indeed one can really not add guarantees. Any thoughts on the outcome?"}, {"owner": {"reputation": 9105, "user_id": 119861, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/O2tUa.png?s=128&g=1", "display_name": "hansaplast", "link": "https://stackoverflow.com/users/119861/hansaplast"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1514568422, "post_id": 47989110, "comment_id": 83021933, "body": "@AjayBrahmakshatriya: ping, I did some tests maybe you want to comment?"}], "tags": [], "owner": {"reputation": 9105, "user_id": 119861, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/O2tUa.png?s=128&g=1", "display_name": "hansaplast", "link": "https://stackoverflow.com/users/119861/hansaplast"}, "is_accepted": false, "score": 3, "last_activity_date": 1514568267, "last_edit_date": 1514568267, "creation_date": 1514364862, "answer_id": 47989110, "question_id": 47988994, "link": "https://stackoverflow.com/questions/47988994/final-value-of-a-global-variable-which-is-being-incremented-via-two-threads/47989110#47989110", "title": "Final value of a global variable which is being incremented via two threads", "body": "<p>If you don't do any locking, then <code>var++</code> is not atomic  i.e. the write and the read of the variable can be interrupted by another thread. That means both threads might read the same value of var and both increment it at the same time.</p>\n\n<p>Worst case the two threads are fully \"synchronized\" that is read and write the var at exactly same time and thus the minimal end value of <code>var</code> would be 20.</p>\n\n<p><strong>Update</strong>: Apparently, there are no guarantees about possible outcomes in these data races, see Bathsheba answer below and <a href=\"https://software.intel.com/en-us/blogs/2013/01/06/benign-data-races-what-could-possibly-go-wrong\" rel=\"nofollow noreferrer\">this article</a> he refers to.</p>\n\n<p><strong>Update 2</strong>: I was curious if in real world we would see values below 20. Test setup (details: see <a href=\"https://gist.github.com/philippkeller/98600abe00030e3e6e5791ce1b50f583\" rel=\"nofollow noreferrer\">this gist</a>)</p>\n\n<ul>\n<li>global <code>int var</code>. Tested with <code>long</code> and <code>long long</code>, didn't do any difference</li>\n<li>two <code>pthread</code>s doing 20'000 times <code>var++</code></li>\n<li>executable was started 10'000 times and smallest values was taken</li>\n</ul>\n\n<p>The expected outcome would be between 20'000 and 40'000:</p>\n\n<pre><code>|                    Computer                   | clang | clang -O3 |  gcc  | gcc -O0 | gcc -O2 |\n|-----------------------------------------------|-------|-----------|-------|---------|---------|\n| Linux, ThinkPad, x86_64, Intel I7, 4 cores    | 19402 |     20000 | 18760 |   16913 |   20000 |\n| Linux, Raspberry 3, ARMv7, 4 cores            | 19587 |     20000 | 19569 |   19904 |   20000 |\n| OSX,  Intel i5, 4 cores                       | 17609 |     20000 | 17206 |   18049 |   20000 |\n| Linux, EC2 t2.2xlarge, Intel Xeon E5, 8 cores | 19707 |     20000 | 19744 |   19881 |   40000 |\n</code></pre>\n\n<p>What seems interesting:</p>\n\n<ul>\n<li>yes, it <strong>can</strong> drop below 20'000, so the \"no guarantees\" claim is not just in theory</li>\n<li>with compiler optimizations above a certain level the behaviour looks more predictable</li>\n<li>strange, that on EC2 with 8 cores the min value for <code>gcc -O2</code> was 40'000.</li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 9105, "user_id": 119861, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/O2tUa.png?s=128&g=1", "display_name": "hansaplast", "link": "https://stackoverflow.com/users/119861/hansaplast"}, "edited": false, "score": 0, "creation_date": 1514365642, "post_id": 47989234, "comment_id": 82947018, "body": "I don&#39;t understand. C is compiling down the loop to read, increment and write operations. If single-threaded the outcome is deterministic, if multi-threaded then you have two lines of read, increment and write, the question then is how you aline the two lines, and that has a set of possible outcomes, so it is not fully undefined, no?"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 9105, "user_id": 119861, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/O2tUa.png?s=128&g=1", "display_name": "hansaplast", "link": "https://stackoverflow.com/users/119861/hansaplast"}, "edited": false, "score": 1, "creation_date": 1514365685, "post_id": 47989234, "comment_id": 82947032, "body": "@hansaplast: You can&#39;t reason about undefined behaviour like that. Informally speaking, you have a race condition, and that&#39;s broadly speaking undefined behaviour in C and C++."}, {"owner": {"reputation": 9105, "user_id": 119861, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/O2tUa.png?s=128&g=1", "display_name": "hansaplast", "link": "https://stackoverflow.com/users/119861/hansaplast"}, "edited": false, "score": 0, "creation_date": 1514365869, "post_id": 47989234, "comment_id": 82947106, "body": "my beliefs are shattered :) Judging from your C/C++ points on SO I believe you are right. Can you point me to any article/resource on why this kind of reasoning is wrong?"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 9105, "user_id": 119861, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/O2tUa.png?s=128&g=1", "display_name": "hansaplast", "link": "https://stackoverflow.com/users/119861/hansaplast"}, "edited": false, "score": 4, "creation_date": 1514365940, "post_id": 47989234, "comment_id": 82947133, "body": "@hansaplast: Yes it&#39;s a bit like discovering the truth about Father Christmas. Here&#39;s a starting link. <a href=\"https://software.intel.com/en-us/blogs/2013/01/06/benign-data-races-what-could-possibly-go-wrong\" rel=\"nofollow noreferrer\">software.intel.com/en-us/blogs/2013/01/06/&hellip;</a>"}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 7, "last_activity_date": 1514365440, "creation_date": 1514365440, "answer_id": 47989234, "question_id": 47988994, "link": "https://stackoverflow.com/questions/47988994/final-value-of-a-global-variable-which-is-being-incremented-via-two-threads/47989234#47989234", "title": "Final value of a global variable which is being incremented via two threads", "body": "<p>If <code>var</code> is <strong>not</strong> an atomic type then the behaviour is <em>undefined</em>. Questions about the <em>range</em> of possible final values are therefore ill-posed.</p>\n\n<p>If <code>var</code> is an atomic type, then the final result will be as if the threads were not ran concurrently.</p>\n"}], "owner": {"reputation": 1575, "user_id": 1673206, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/19382512e78f5e497f0dfbd170a09837?s=128&d=identicon&r=PG", "display_name": "user1673206", "link": "https://stackoverflow.com/users/1673206/user1673206"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 711, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1514568267, "creation_date": 1514364274, "last_edit_date": 1514365541, "question_id": 47988994, "link": "https://stackoverflow.com/questions/47988994/final-value-of-a-global-variable-which-is-being-incremented-via-two-threads", "title": "Final value of a global variable which is being incremented via two threads", "body": "<p>I encountered this question:</p>\n\n<blockquote>\n  <p>Given two threads and one global variable <code>var</code>, the two threads runs\n  the same code (C/C++ code):</p>\n\n<pre><code>for(int i=0; i&lt;20; i++)\n{\n  var++;\n}\n</code></pre>\n  \n  <p>What are the possible values of <code>var</code> at the end of the threads\n  execution?</p>\n</blockquote>\n\n<p>If each thread increments <code>var</code> \"correctly\" - I guess that the maximum value will be 40. </p>\n\n<p>But what about the minimum value? How is the increment operation implemented and actually being done?</p>\n\n<p>Note: There is no locking (of any type) on the increment operation on purpose (off course that the correct way would be to lock it - the question is for educational purposes).</p>\n"}, {"tags": ["c", "cmake"], "answers": [{"tags": [], "owner": {"reputation": 2014, "user_id": 6267288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f86a7e2f0811a9e18031ed7c0af917a?s=128&d=identicon&r=PG&f=1", "display_name": "OlivierM", "link": "https://stackoverflow.com/users/6267288/olivierm"}, "is_accepted": false, "score": 0, "last_activity_date": 1514385878, "creation_date": 1514385878, "answer_id": 47994116, "question_id": 47987946, "link": "https://stackoverflow.com/questions/47987946/cmake-multiple-targets-use-the-same-source-file/47994116#47994116", "title": "CMake: multiple targets use the same source file", "body": "<p>Either you have not given enough information in your question or adding <code>function.c</code> to <code>target1</code> and <code>target2</code> will not work when you will link them together with <code>main.out</code> because you will have duplicated symbols.</p>\n\n<p>If you are sure they will be no duplicated symbols (for instance because <code>function.c</code> is built with different compilation flags) then your example is correct.</p>\n"}, {"comments": [{"owner": {"reputation": 617, "user_id": 4180909, "user_type": "registered", "accept_rate": 88, "profile_image": "https://graph.facebook.com/100000556539205/picture?type=large", "display_name": "Samuel", "link": "https://stackoverflow.com/users/4180909/samuel"}, "edited": false, "score": 0, "creation_date": 1514427844, "post_id": 47995885, "comment_id": 82970218, "body": "Would it cause duplicated symbol if main.out link targe1 and target2, which both use function.c ?"}, {"owner": {"reputation": 4569, "user_id": 1282773, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/GFxGD.jpg?s=128&g=1", "display_name": "ivaigult", "link": "https://stackoverflow.com/users/1282773/ivaigult"}, "reply_to_user": {"reputation": 617, "user_id": 4180909, "user_type": "registered", "accept_rate": 88, "profile_image": "https://graph.facebook.com/100000556539205/picture?type=large", "display_name": "Samuel", "link": "https://stackoverflow.com/users/4180909/samuel"}, "edited": false, "score": 0, "creation_date": 1514447745, "post_id": 47995885, "comment_id": 82975502, "body": "Yes, this will lead to symbol duplication. Then you&#39;d better to use the first option (to move <code>function.c</code> to separate library and link <code>target1</code> and <code>target2</code> against it). CMake will take care that <code>function</code> is linked only once to your <code>main.out</code>"}], "tags": [], "owner": {"reputation": 4569, "user_id": 1282773, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/GFxGD.jpg?s=128&g=1", "display_name": "ivaigult", "link": "https://stackoverflow.com/users/1282773/ivaigult"}, "is_accepted": true, "score": 0, "last_activity_date": 1514393780, "creation_date": 1514393780, "answer_id": 47995885, "question_id": 47987946, "link": "https://stackoverflow.com/questions/47987946/cmake-multiple-targets-use-the-same-source-file/47995885#47995885", "title": "CMake: multiple targets use the same source file", "body": "<p>It's totally fine to use the same source file whatever number of times. Sometimes it's even necessary, if you want to compile the same source with different pre-processor/compiler flags.</p>\n\n<p>But if you are concerned with compilation time, you could:</p>\n\n<ul>\n<li>move <code>funtion.c</code> to separate static library and link <code>target1</code> and <code>target2</code> libraries against it.</li>\n<li>Use <a href=\"https://cmake.org/cmake/help/v3.5/command/add_library.html#object-libraries\" rel=\"nofollow noreferrer\">object library</a> for <code>function.c</code> and archive output object file to <code>target1</code> and <code>target2</code>.</li>\n</ul>\n"}], "owner": {"reputation": 617, "user_id": 4180909, "user_type": "registered", "accept_rate": 88, "profile_image": "https://graph.facebook.com/100000556539205/picture?type=large", "display_name": "Samuel", "link": "https://stackoverflow.com/users/4180909/samuel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1719, "favorite_count": 0, "accepted_answer_id": 47995885, "answer_count": 2, "score": 4, "last_activity_date": 1514393780, "creation_date": 1514358858, "question_id": 47987946, "link": "https://stackoverflow.com/questions/47987946/cmake-multiple-targets-use-the-same-source-file", "title": "CMake: multiple targets use the same source file", "body": "<pre><code>add_library(target1 funtion.c target1.c )\nadd_library(target2 funtion.c target2.c )\nadd_executable(main.out main.c) \ntarget_link_libraries(main.out target1 target2 ${LDFLAGS})\n</code></pre>\n\n<p>Here is my <code>CMakeLists.txt</code> above. </p>\n\n<p>Both targets need to use the source file <code>function.c</code>. It is able to run though. My concern is that maybe it is not a good behavior for writing <code>CMakeList.txt</code>?</p>\n"}, {"tags": ["c", "linux-kernel"], "comments": [{"owner": {"reputation": 1052, "user_id": 3698648, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/199b49d13342baa233c08aac5793ed4d?s=128&d=identicon&r=PG&f=1", "display_name": "ntshetty", "link": "https://stackoverflow.com/users/3698648/ntshetty"}, "edited": false, "score": 1, "creation_date": 1514356935, "post_id": 47987486, "comment_id": 82943741, "body": "can you point the source code of <code>simple_copy</code> ? which you used"}, {"owner": {"reputation": 91, "user_id": 6452895, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-oQmuwtk8PKg/AAAAAAAAAAI/AAAAAAAAAAA/MLExILE209k/photo.jpg?sz=128", "display_name": "Prakash Raghavendra", "link": "https://stackoverflow.com/users/6452895/prakash-raghavendra"}, "reply_to_user": {"reputation": 1052, "user_id": 3698648, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/199b49d13342baa233c08aac5793ed4d?s=128&d=identicon&r=PG&f=1", "display_name": "ntshetty", "link": "https://stackoverflow.com/users/3698648/ntshetty"}, "edited": false, "score": 0, "creation_date": 1514453696, "post_id": 47987486, "comment_id": 82978030, "body": "It is the same sample which comes in nvml library at path nvml/src/examples/libpmem/simple_copy.c. I have not modified the sample."}], "answers": [{"tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": false, "score": 0, "last_activity_date": 1514595428, "creation_date": 1514595428, "answer_id": 48029974, "question_id": 47987486, "link": "https://stackoverflow.com/questions/47987486/simple-copy-example-on-pmem-io/48029974#48029974", "title": "simple_copy example on pmem.io", "body": "<p>from the errors posted, is seems reasonable to believe:</p>\n\n<ol>\n<li>without the appropriate option, it will not create a directory</li>\n<li>without the appropriate option, it will not replace a file</li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 8805481, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83d568d9ba60d80f97bb9c99f2def17f?s=128&d=identicon&r=PG&f=1", "display_name": "Piotr Balcer", "link": "https://stackoverflow.com/users/8805481/piotr-balcer"}, "is_accepted": false, "score": 0, "last_activity_date": 1515524021, "creation_date": 1515524021, "answer_id": 48174909, "question_id": 47987486, "link": "https://stackoverflow.com/questions/47987486/simple-copy-example-on-pmem-io/48174909#48174909", "title": "simple_copy example on pmem.io", "body": "<p>If you open the example you are referring to, you will see the following:</p>\n\n<pre><code>if ((pmemaddr = pmem_map_file(argv[2], BUF_LEN,\n            PMEM_FILE_CREATE|PMEM_FILE_EXCL,\n            0666, &amp;mapped_len, &amp;is_pmem)) == NULL) {\n    perror(\"pmem_map_file\");\n    exit(1);\n}\n</code></pre>\n\n<p>This is the part that is giving you trouble. To understand why, let's look at the <code>man 7 libpmem</code>. You can find the relevant part <a href=\"http://pmem.io/pmdk/manpages/linux/master/libpmem/pmem_is_pmem.3\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>This is the paragraph we are interested in:</p>\n\n<blockquote>\n  <p>The pmem_map_file() function creates a new read/write mapping for a\n  file. If PMEM_FILE_CREATE is not specified in flags, the entire\n  existing file path is mapped, len must be zero, and mode is ignored.\n  Otherwise, path is opened or created as specified by flags and mode,\n  and len must be non-zero. pmem_map_file() maps the file using mmap(2),\n  but it also takes extra steps to make large page mappings more likely.</p>\n</blockquote>\n\n<p>So, the <code>pmem_map_file</code> function effectively calls <code>open(2)</code> and then <code>mmap(2)</code>. In the <code>simple_copy.c</code> example we can observe that the flags which were used are: <code>PMEM_FILE_CREATE</code> and <code>PMEM_FILE_EXCL</code>, and as we can learn from the manpage, they roughly translate to <code>O_CREAT</code> and <code>O_EXCL</code> respectively.\nThis means that the error messages are correct and you've received them because in your first attempt you've provided an existing file, whilst on the second attempt you tried a directory.</p>\n\n<p>There's an in-depth explanation of libpmem <a href=\"http://pmem.io/pmdk/libpmem/\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}], "owner": {"reputation": 91, "user_id": 6452895, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-oQmuwtk8PKg/AAAAAAAAAAI/AAAAAAAAAAA/MLExILE209k/photo.jpg?sz=128", "display_name": "Prakash Raghavendra", "link": "https://stackoverflow.com/users/6452895/prakash-raghavendra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 269, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1515524021, "creation_date": 1514356552, "last_edit_date": 1592644375, "question_id": 47987486, "link": "https://stackoverflow.com/questions/47987486/simple-copy-example-on-pmem-io", "title": "simple_copy example on pmem.io", "body": "<p>I have created the emulated device given at <a href=\"http://pmem.io/2016/02/22/pm-emulation.html\" rel=\"nofollow noreferrer\">http://pmem.io/2016/02/22/pm-emulation.html</a>, successfully.</p>\n<p>It shows the device correctly:</p>\n<pre><code>:~/Prakash/nvml/src/examples/libpmem$ mount | grep pmem\n</code></pre>\n<p>/dev/pmem0 on /mnt/pmemd type ext4 (rw,relatime,dax,errors=continue,data=ordered)</p>\n<p>However, when I execute the simple_copy sample given with pmem nvml, it gives this error:</p>\n<blockquote>\n<p>amd@amd:~/Prakash/nvml/src/examples/libpmem$ ./simple_copy logs</p>\n<p>/dev/pmem0 pmem_map_file: File exists</p>\n<p>amd@amd:~/Prakash/nvml/src/examples/libpmem$ ./simple_copy logs</p>\n<p>/dev/pmem0/logs pmem_map_file: Not a directory</p>\n</blockquote>\n<p>Am I not using the program correctly?</p>\n<p>Also, I have mounted the device as dax and I clearly see the performance advantage with</p>\n<pre><code>:~/Prakash/nvml/src/examples/libpmem$ sudo dd if=/dev/zero of=/dev/pmem0 bs=2G count=1\n0+1 records in\n0+1 records out\n2147479552 bytes (2.1 GB, 2.0 GiB) copied, 0.910729 s, 2.4 GB/s\n:~/Prakash/nvml/src/examples/libpmem$ sudo dd if=/dev/zero of=/mnt/pmem0/test bs=2G count=1\n0+1 records in\n0+1 records out\n2147479552 bytes (2.1 GB, 2.0 GiB) copied, 6.39032 s, 336 MB/s\n</code></pre>\n"}, {"tags": ["c", "file-handling"], "comments": [{"owner": {"reputation": 716, "user_id": 2031180, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jkKlR.jpg?s=128&g=1", "display_name": "campescassiano", "link": "https://stackoverflow.com/users/2031180/campescassiano"}, "edited": false, "score": 0, "creation_date": 1514352860, "post_id": 47986833, "comment_id": 82942449, "body": "Take a look <a href=\"https://stackoverflow.com/questions/5474232/how-to-loop-through-only-active-file-descriptors-from-fd-set-result-from-select\">here</a>"}, {"owner": {"reputation": 3794, "user_id": 7256714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adeb98b0e8995d8576ad5f66c0f982e5?s=128&d=identicon&r=PG&f=1", "display_name": "Pras", "link": "https://stackoverflow.com/users/7256714/pras"}, "edited": false, "score": 0, "creation_date": 1514354623, "post_id": 47986833, "comment_id": 82942939, "body": "You dont need to seek when you reach end of file, just sleep and read again"}], "answers": [{"comments": [{"owner": {"reputation": 139, "user_id": 5561224, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c5973048e8814a3a077e1e840b1dc8f4?s=128&d=identicon&r=PG&f=1", "display_name": "Sanket Joshi", "link": "https://stackoverflow.com/users/5561224/sanket-joshi"}, "edited": false, "score": 0, "creation_date": 1514357083, "post_id": 47987221, "comment_id": 82943803, "body": "I have made changes according to your code... and running that binary......writing manually in that file but my program is unable to read updated data"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 139, "user_id": 5561224, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c5973048e8814a3a077e1e840b1dc8f4?s=128&d=identicon&r=PG&f=1", "display_name": "Sanket Joshi", "link": "https://stackoverflow.com/users/5561224/sanket-joshi"}, "edited": false, "score": 0, "creation_date": 1514357266, "post_id": 47987221, "comment_id": 82943861, "body": "That&#39;s sad!  I tested on a Mac running macOS High Sierra 10.13.2, using GCC 7.2.0 as the compiler.  I&#39;m confident that it would work on Linux and other Unix-based platforms (though I&#39;ve not formally tested this code on any other platform today).  What platform are you working on?  What does your modified code look like?  (You could add it to the question if necessary \u2014 do not destroy what&#39;s already there, though.) . It&#39;s a bit hard to guess what you&#39;ve done wrong, but I guess that you have done something wrong, or you&#39;re working on an esoteric platform where this does not work."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 139, "user_id": 5561224, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c5973048e8814a3a077e1e840b1dc8f4?s=128&d=identicon&r=PG&f=1", "display_name": "Sanket Joshi", "link": "https://stackoverflow.com/users/5561224/sanket-joshi"}, "edited": false, "score": 0, "creation_date": 1514357529, "post_id": 47987221, "comment_id": 82943962, "body": "One way you can run into problems is if the program(s) writing to the file truncate it rather than always appending.  There may be other ways too."}, {"owner": {"reputation": 139, "user_id": 5561224, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c5973048e8814a3a077e1e840b1dc8f4?s=128&d=identicon&r=PG&f=1", "display_name": "Sanket Joshi", "link": "https://stackoverflow.com/users/5561224/sanket-joshi"}, "edited": false, "score": 0, "creation_date": 1514357797, "post_id": 47987221, "comment_id": 82944079, "body": "when i am appending to file with echo command it is working but when writing that file with vim editor its not working"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 139, "user_id": 5561224, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c5973048e8814a3a077e1e840b1dc8f4?s=128&d=identicon&r=PG&f=1", "display_name": "Sanket Joshi", "link": "https://stackoverflow.com/users/5561224/sanket-joshi"}, "edited": false, "score": 0, "creation_date": 1514358029, "post_id": 47987221, "comment_id": 82944179, "body": "That sounds plausible.  When you write with <code>vim</code>, is the file always longer than it was before you edited it?  If not, then the program won&#39;t spot the changed material.  But then, too, neither would <code>tail -f</code> (probably).  It would be possible to revise the program so that if the file was shorter than it was when EOF was last detected, then the program could restart reading at the beginning.  There presumably isn&#39;t a benefit to seeking to the new shorter end position as there&#39;s nothing to read after it \u2014 unless there&#39;s also a separate (non-<code>vim</code>) process appending to the file."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1514359855, "post_id": 47987221, "comment_id": 82944849, "body": "@JonathanLeffler <code>getline</code> works fine on Linux (with the above code) would there be any downside to using a <i>character oriented</i> approach like <code>fgetc</code> instead of <code>getline</code> (other than more trips through the <code>while</code> loop before sleeping)? Essentially the same setup, but with a <code>fgetc &#47; putchar</code> approach? (and maybe a flag to exit on two (or some number) of consecutive <code>EOF</code>s)"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1514360315, "post_id": 47987221, "comment_id": 82945026, "body": "@DavidC.Rankin: there&#39;s a marginal performance penalty, usually offset by the fact that the code gets to sleep periodically.  If it doesn&#39;t sleep periodically, it means the file is growing about as fast as it can be read.  But there&#39;s very little downside to a character-by-character approach.  The key trick is <code>clearerr()</code> \u2014 and the secondary trick is a suitable sleep (not necessarily a whole second \u2014 it could be more or less time).  The rest is incidental."}], "tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": true, "score": 4, "last_activity_date": 1514355820, "last_edit_date": 1514355820, "creation_date": 1514355191, "answer_id": 47987221, "question_id": 47986833, "link": "https://stackoverflow.com/questions/47986833/read-a-continuously-updated-file-and-wait-for-new-data-to-be-written-to-the-file/47987221#47987221", "title": "Read a continuously updated file and wait for new data to be written to the file in C", "body": "<p>When you reach the first end of file, the input stream flag for EOF is set.  That has to be cleared before you can resume operations (<code>clearerr(fp)</code>).  You should normally sleep, too.  (Using <code>lseek()</code> on the file descriptor associated with the stream won't help.)</p>\n\n<p>Here's a program based on your code \u2014 I had to change the value of PATH (which isn't a particularly good name):</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n\n#define PATH \"demo.txt\"\n\nint main(void)\n{\n    FILE * fp;\n    char * line = NULL;\n    size_t len = 0;\n\n    fp = fopen(PATH, \"r\");\n    if (fp == NULL)\n    {\n        perror(PATH);\n        exit(EXIT_FAILURE);\n    }\n\n    while (1)\n    {\n        if (getline(&amp;line, &amp;len, fp) != -1)\n            printf(\"%s\",line);\n        else\n        {\n            printf(\"EOF\\n\");\n            sleep(1);\n            clearerr(fp);\n        }\n    }\n\n    if (line)\n        free(line);\n    return(EXIT_SUCCESS);\n}\n</code></pre>\n\n<p>If you have a program that generates data to a file, you can test with it.  I have a program <code>dribbler</code> that does that:</p>\n\n<pre><code>$ dribbler -f demo.txt -s 1.5 -r 0.5 &amp;\n[1] 20678\n$ cat demo.txt\n0: message written to file\n1: message written to file\n2: message written to file\n$ tail11\n0: message written to file\n1: message written to file\n2: message written to file\n3: message written to file\n4: message written to file\n5: message written to file\nEOF\n6: message written to file\nEOF\nEOF\n7: message written to file\nEOF\n8: message written to file\nEOF\nEOF\n9: message written to file\nEOF\n10: message written to file\nEOF\n11: message written to file\nEOF\nEOF\n^C\n$\n</code></pre>\n\n<p>The options to <code>dribbler</code> are:</p>\n\n<pre><code>Usage: dribbler [-hlntV][-s nap.time][-r std.dev][-f outfile][-i infile][-m message][-o openstr][-F format]\n  -V           Print version information and exit\n  -f outfile   Write to named file (dribbler.out)\n  -h           Print this help message and exit\n  -i infile    Read lines from input file\n  -l           Loop back to start of input file on EOF\n  -m message   Write message on each line of output\n  -n           Number lines read from input file\n  -o openstr   Flags passed to fopen() (a+)\n  -s nap.time  Sleep for given interval between writes (1.000 second)\n  -r std.dev   Randomize the time (Gaussian around nap.time with std.dev)\n  -t           Write to standard output instead of file\n  -F format    Printf format to use instead of %zu\n</code></pre>\n\n<p>So, it was writing to the file <code>demo.txt</code> at a mean time of 1.5 seconds, with a Gaussian random distribution with 0.5 seconds standard deviation.\nThat's why there were sometimes 2 <code>EOF</code> messsages between successive lines of output.</p>\n"}], "owner": {"reputation": 139, "user_id": 5561224, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c5973048e8814a3a077e1e840b1dc8f4?s=128&d=identicon&r=PG&f=1", "display_name": "Sanket Joshi", "link": "https://stackoverflow.com/users/5561224/sanket-joshi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 901, "favorite_count": 0, "accepted_answer_id": 47987221, "answer_count": 1, "score": 0, "last_activity_date": 1514437946, "creation_date": 1514352761, "last_edit_date": 1514437946, "question_id": 47986833, "link": "https://stackoverflow.com/questions/47986833/read-a-continuously-updated-file-and-wait-for-new-data-to-be-written-to-the-file", "title": "Read a continuously updated file and wait for new data to be written to the file in C", "body": "<p>I have a log file and I want to write a program in C to read that log file and wait for new data if EOF is reached.\nI do not want to use <code>tail -f</code> in my code.\nI tried the following code but it is not working:</p>\n\n<pre><code>#define _GNU_SOURCE 1\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/inotify.h&gt;\n#include &lt;unistd.h&gt;\n\n#define PATH \"/home/sanket/demo.txt\"\n\nint main(void)\n{\n        FILE * fp;\n    int fd;\n    char * line = NULL;\n    size_t len = 0;\n    ssize_t read1;\n    int notify_fd;\n    int wd,length ,i=0;\n    char buffer[EVENT_BUF_LEN];\n\n    fp = fopen(PATH, \"r\");\n    if (fp == NULL)\n            exit(EXIT_FAILURE);\n\n    fd = fileno(fp);\n    while (1)\n    {\n            read1 = getline(&amp;line, &amp;len, fp);\n            if(read1 != -1)\n                    printf(\"%s\",line);\n            else\n            {\n                    lseek(fd,0,SEEK_DATA);\n            }\n    }\n\n    if (line)\n            free(line);\n    exit(EXIT_SUCCESS);\n}\n</code></pre>\n"}, {"tags": ["c", "function"], "comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1514352400, "post_id": 47986756, "comment_id": 82942312, "body": "Advantage in terms of what criteria?"}, {"owner": {"reputation": 157, "user_id": 8524363, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/NVtOB.png?s=128&g=1", "display_name": "arkdevelopment", "link": "https://stackoverflow.com/users/8524363/arkdevelopment"}, "edited": false, "score": 0, "creation_date": 1514352485, "post_id": 47986756, "comment_id": 82942334, "body": "What you have provided above main is a function declaration, not a function. What you have provided under main is a function, not a function declaration. There is no real advantage other than knowing that the function exists somewhere in the code if both exist in the same file."}, {"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "reply_to_user": {"reputation": 157, "user_id": 8524363, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/NVtOB.png?s=128&g=1", "display_name": "arkdevelopment", "link": "https://stackoverflow.com/users/8524363/arkdevelopment"}, "edited": false, "score": 0, "creation_date": 1514354483, "post_id": 47986756, "comment_id": 82942899, "body": "@arkdevelopment - the line above <code>main()</code> is a function declaration.   The implementation of <code>foo()</code>, below <code>main()</code>, is actually a function <i>definition</i>.   And a definition is a type of declaration.   An advantage of the preceding declaration is that the compiler has visibility of the argument types and return types of the function, and can check those at any statement which calls it.    It can also check the definition of <code>foo()</code> for consistency with the preceding declaration."}, {"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1514418554, "post_id": 47986756, "comment_id": 82968387, "body": "It is a tell for the way the programmer thinks.  Is he top-down or bottom-up?  Good to know, they create different kind of bugs."}], "answers": [{"tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": false, "score": 8, "last_activity_date": 1514356810, "creation_date": 1514356810, "answer_id": 47987541, "question_id": 47986756, "link": "https://stackoverflow.com/questions/47986756/does-putting-function-definitions-after-main-have-any-advantage-over-placing-t/47987541#47987541", "title": "Does putting function definitions after main() have any advantage over placing them before main()?", "body": "<p>Assuming you use old C (C99) or new C (C11) and not either ancient C (C90) or ante-diluvian C (pre-standard C), then the advantage of defining functions before <code>main()</code> is that you don't need to separately specify the prototypes of those functions \u2014 the definition also specifies the prototype.</p>\n\n<p>If the functions defined in the file containing <code>main()</code> are also used in other source files, then you'd have a header declaring the functions anyway, and that header would be used in both the file containing <code>main()</code> and in the other source files.</p>\n\n<p>If, as is probably the case, the functions are only used in the file containing <code>main()</code>, then you'd ensure that the functions are defined as <code>static</code>.</p>\n\n<p>If you place the function definitions after <code>main()</code>, you must declare the functions before they're used (e.g. by <code>main()</code>).  This is a consequence of not using ancient or ante-diluvian C \u2014 all functions must be declared before being used.</p>\n\n<p>Note that defining a function like this does <em>not</em> declare a prototype for the function:</p>\n\n<pre><code>void somefunc()\n{\n    \u2026operations\u2026\n}\n</code></pre>\n\n<p>It provides a declaration for the function, but it does not provide a prototype.  That means you can miscall it:</p>\n\n<pre><code>somefunc(1);\nsomefunc(\"a\", \"z\");\n</code></pre>\n\n<p>and the compiler is not required to complain about the misuse.  (The rules in C++ are different in this regard \u2014 all function definitions provide a prototype.  C had a legacy code base that C++ did not have which prevented that from being a sensible rule for C \u2014 so, the C standard committee being sensible people, the C standard does not include the non-sensible rule.)</p>\n\n<p>To make that into a prototype, you must write:</p>\n\n<pre><code>void somefunc(void)\n{\n    \u2026operations\u2026\n}\n</code></pre>\n\n<p>So, if functions are properly defined before <code>main()</code>, you don't need to repeat their declaration.  If you define the functions after <code>main()</code>, those functions called directly from <code>main()</code> must have a declaration (and should have a prototype declaration) in scope before <code>main()</code> is defined.</p>\n\n<p>Note that you should not declare functions within other functions, regardless of how permissible that is.  Such 'hidden' declarations are a major maintenance liability.  The declarations should be at file scope, usually at the top of the file or in a header.</p>\n\n<h3>TL;DR</h3>\n\n<p>Assuming you write in modern C:</p>\n\n<ul>\n<li>Effects: none.</li>\n<li>Advantages: you can study the code top-down starting at <code>main()</code>.</li>\n<li>Disadvantages: you have to declare functions as well as define them.</li>\n</ul>\n"}], "owner": {"reputation": 131, "user_id": 8630545, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/51098a8fe7cc3b8707a5fae8a258be30?s=128&d=identicon&r=PG&f=1", "display_name": "kron maz", "link": "https://stackoverflow.com/users/8630545/kron-maz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1633, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1514418181, "creation_date": 1514352272, "last_edit_date": 1514418181, "question_id": 47986756, "link": "https://stackoverflow.com/questions/47986756/does-putting-function-definitions-after-main-have-any-advantage-over-placing-t", "title": "Does putting function definitions after main() have any advantage over placing them before main()?", "body": "<p>Does placing functions after main have any affect on the program compared with placing them before main?</p>\n\n<p>Example \u2014 after:</p>\n\n<pre><code>    void foo(void);\n\n    int main(void){\n        \u2026\n    }\n\n    void foo(void){\n        \u2026\n    }\n</code></pre>\n\n<p>Example \u2014 before:</p>\n\n<pre><code>    void foo(void){\n        \u2026\n    }\n\n    int main(void){\n        \u2026\n    }\n</code></pre>\n"}, {"tags": ["c", "printf"], "comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1514356147, "post_id": 47986730, "comment_id": 82943476, "body": "Try using <code>%d</code> instead and see what happen"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 2, "creation_date": 1514356273, "post_id": 47986730, "comment_id": 82943517, "body": "The top answer on the duplicate is wrong &gt;.&gt;"}], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 8473737, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-5n1965JiH7U/AAAAAAAAAAI/AAAAAAAABAw/JNFFVnpClyo/photo.jpg?sz=128", "display_name": "Jeyasri .R", "link": "https://stackoverflow.com/users/8473737/jeyasri-r"}, "edited": false, "score": 0, "creation_date": 1514357219, "post_id": 47986773, "comment_id": 82943849, "body": "super .Thanks a lot @coderredoc"}, {"owner": {"reputation": 57, "user_id": 8473737, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-5n1965JiH7U/AAAAAAAAAAI/AAAAAAAABAw/JNFFVnpClyo/photo.jpg?sz=128", "display_name": "Jeyasri .R", "link": "https://stackoverflow.com/users/8473737/jeyasri-r"}, "edited": false, "score": 0, "creation_date": 1514357228, "post_id": 47986773, "comment_id": 82943852, "body": "@Gaurav Sehgal Thanks a lot"}], "tags": [], "owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "is_accepted": false, "score": 1, "last_activity_date": 1514363534, "last_edit_date": 1514363534, "creation_date": 1514352355, "answer_id": 47986773, "question_id": 47986730, "link": "https://stackoverflow.com/questions/47986730/why-using-c-for-formatting-instead-of-d/47986773#47986773", "title": "Why using %c for formatting instead of %d", "body": "<p>Here this is utilizing the return value of <code>printf</code>. Respectively <code>x-1</code> spaces(<code>' '</code>) and then again space (as you specified) and  <code>y-1</code> blanks and then again 1 space is being printed. And then the total number of characters written is returned. That is how the sum is being done. </p>\n\n<p>I just remember this rule </p>\n\n<pre><code>printf(\"%*c\",X,C) prints the char C in a field of size X\n</code></pre>\n\n<p>All these behavior is explained in C11 Standard.</p>\n\n<p>From standard <strong><a href=\"http://port70.net/~nsz/c/c11/n1570.html#7.21.6.1p4\" rel=\"nofollow noreferrer\"> \u00a77.21.6.1p4</a></strong></p>\n\n<blockquote>\n  <p>An optional minimum field width. <strong><em>If the converted value has fewer\n  characters than the field width, it is padded with spaces (by default)</em></strong>\n  on the left (or right, if the left adjustment flag, described later,\n  has been given) to the field width. <em>The field width takes the form of\n  an asterisk <code>*</code> (described later) or a nonnegative decimal integer.</em></p>\n</blockquote>\n\n<p>And in the same section <strong><a href=\"http://port70.net/~nsz/c/c11/n1570.html#7.21.6.1p5\" rel=\"nofollow noreferrer\"> \u00a77.21.6.1p5</a></strong></p>\n\n<blockquote>\n  <p>As noted above, <strong><em>a field width, or precision, or both, may be\n  indicated by an asterisk. In this case, an int argument supplies the\n  field width or precision</em></strong></p>\n</blockquote>\n\n<p>At last <a href=\"http://port70.net/~nsz/c/c11/n1570.html#7.21.6.1p14\" rel=\"nofollow noreferrer\"><strong>\u00a77.21.6.1.p14</strong></a></p>\n\n<blockquote>\n  <p><strong><em>The <code>fprintf</code> function returns the number of characters transmitted</em></strong>, or\n  a negative value if an output or encoding error occurred.</p>\n</blockquote>\n\n<h2>Why <code>%c</code> instead of <code>%d</code>?</h2>\n\n<p>One can argue that it is because it is not our intention to print those numbers or anything - it is just to <code>print</code> <code>x</code> number of something and <code>y</code> number of something so that we get the rturn value of <code>x+y</code>. You can try this and this one will also work but you will see some numbers in the screen with so large field witdh. Try this</p>\n\n<pre><code> return printf(\"%*d%*d\",  x, x,  y, y);\n</code></pre>\n\n<p>If <code>x = 10</code> and <code>y=2</code> then it will be</p>\n\n<pre><code>| | | | | | | | |1|0| |2|\n 1 2 3 4 5 6 7 8 9 10 \\ \\\n                      11 12\n\nThat's how 12 characters are printed.\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6951, "user_id": 3475381, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b6a1c5d19f4ae8c6a1dbf097487c96d7?s=128&d=identicon&r=PG&f=1", "display_name": "Gaurav Sehgal", "link": "https://stackoverflow.com/users/3475381/gaurav-sehgal"}, "is_accepted": false, "score": 1, "last_activity_date": 1514352452, "creation_date": 1514352452, "answer_id": 47986796, "question_id": 47986730, "link": "https://stackoverflow.com/questions/47986730/why-using-c-for-formatting-instead-of-d/47986796#47986796", "title": "Why using %c for formatting instead of %d", "body": "<p>Note two things here:</p>\n\n<p><code>printf(\"%*c\",x,' ')</code> specifies a width of <code>x</code> for printing <code>' '</code></p>\n\n<p><code>printf()</code> returns the character count.</p>\n\n<p>So</p>\n\n<pre><code>return printf(\"%*c%*c\",  x, ' ',  y, ' ');\n</code></pre>\n\n<p>returns total characters printed which is -</p>\n\n<p>width specified to print <code>' '</code> which is <code>x</code> + width specified to print <code>' '</code> which is <code>y</code> which is equivalent to returning <code>x+y</code></p>\n"}], "owner": {"reputation": 57, "user_id": 8473737, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-5n1965JiH7U/AAAAAAAAAAI/AAAAAAAABAw/JNFFVnpClyo/photo.jpg?sz=128", "display_name": "Jeyasri .R", "link": "https://stackoverflow.com/users/8473737/jeyasri-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "closed_date": 1514356096, "answer_count": 2, "score": -3, "last_activity_date": 1514363534, "creation_date": 1514352112, "last_edit_date": 1514352204, "question_id": 47986730, "link": "https://stackoverflow.com/questions/47986730/why-using-c-for-formatting-instead-of-d", "closed_reason": "Duplicate", "title": "Why using %c for formatting instead of %d", "body": "<p>This is code for To find sum of two numbers without using any operator,here why they are used %c instead of %d ? What is the features of %c compare to %d ? </p>\n\n<pre><code>int add(int x, int y)\n{\n    return printf(\"%*c%*c\",  x, ' ',  y, ' ');\n}\n\nint main()\n{\n    printf(\"Sum = %d\", add(3, 4));\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "gcc", "netbeans-8"], "comments": [{"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 1, "creation_date": 1514355755, "post_id": 47986488, "comment_id": 82943345, "body": "It can get a little hairy, but you might consider compiling with the <code>-E</code> option. This will show the source code after the preprocessor has run, so you should be able to see whether or not <code>-DMEMCHECK</code> is doing what you think it should be doing. Your code will be towards the end after the <code>#include</code>s. You can redirect the output to a file, <code>gcc -E code.c &gt; ppCode.c</code> <a href=\"https://stackoverflow.com/questions/3742822/preprocessor-output\">stackoverflow.com/questions/3742822/preprocessor-output</a>"}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1514356027, "post_id": 47986488, "comment_id": 82943438, "body": "also recommend compiling with the <code>-Wextra</code> flag to turn on more warnings."}, {"owner": {"reputation": 2449, "user_id": 500276, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/200bf76976f24add540182f5c3a42788?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Benningfield", "link": "https://stackoverflow.com/users/500276/mark-benningfield"}, "reply_to_user": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1514409274, "post_id": 47986488, "comment_id": 82965777, "body": "@yano: It seems to me that if there were a problem with the conditional, the Windows build would be wonky as well."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1514410055, "post_id": 47986488, "comment_id": 82966073, "body": "That would make the most sense certainly, but clearly something is happening. IDEs can #define stuff behind the scenes, who knows? Wouldn&#39;t bet my next paycheck that&#39;s the problem, but worth a look IMO. Just another variable in the chain to eliminate."}], "answers": [{"tags": [], "owner": {"reputation": 2449, "user_id": 500276, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/200bf76976f24add540182f5c3a42788?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Benningfield", "link": "https://stackoverflow.com/users/500276/mark-benningfield"}, "is_accepted": false, "score": 0, "last_activity_date": 1514420282, "creation_date": 1514420282, "answer_id": 48000120, "question_id": 47986488, "link": "https://stackoverflow.com/questions/47986488/symbols-missing-from-linux-static-library-using-netbeans/48000120#48000120", "title": "Symbols missing from Linux static library using NetBeans", "body": "<p>Well, I found the solution, but I'm not marking this as the accepted answer because I'm not sure exactly <em>why</em> it's the solution.</p>\n\n<p>I noticed the <code>-Mxx</code> flags on the compiler lines:</p>\n\n<pre><code>gcc    -c -g -Wall -DMEMCHECK -MMD -MP -MF \"build/...\n</code></pre>\n\n<p>So I went back to Google and found this site: <a href=\"http://make.mad-scientist.net/papers/advanced-auto-dependency-generation/#gcc\" rel=\"nofollow noreferrer\">Auto-Dependency Generation</a>, which covers having <code>Make</code> handle the generation and tracking of build dependencies.</p>\n\n<p>Then I starting combing through every single menu item in NetBeans until I found this one:</p>\n\n<blockquote>\n  <p>Tools->Options->C/C++->[on/off] Enable dependency checking in generated makefiles</p>\n</blockquote>\n\n<p>I cleared that switch, and all of the missing symbols appeared in the library. However, the <code>-Mxx</code> flags were still present on the compiler lines in the build output. Now, the makefile generation for NetBeans uses about 5 separate makefile templates and 3 or 4 different XML configuration files to generate the makefile at build time, based on build configuration and target. I couldn't figure out if the auto-dependency flags were rendered inert by flipping that switch or not.</p>\n\n<p>But, if I'm reading the information on the above-mentioned website correctly, those <code>-Mxx</code> flags are actually used by gcc in support of <code>Make</code>, so I'm not sure how they would have a different interpretation based on something that NetBeans did. Although, there are a LOT of substitutions in those makefile templates, and with me not being an Autoconfig/Make wizard, I may have simply missed it.</p>\n\n<p>So, apparently, since none of the source files actually included the function prototypes for the memory utilities -- because they are contained in the library header file, which none of the library source files include (it's meant for inclusion by client code) -- the NetBeans dependency checker decided that those functions weren't needed in the library.</p>\n"}], "owner": {"reputation": 2449, "user_id": 500276, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/200bf76976f24add540182f5c3a42788?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Benningfield", "link": "https://stackoverflow.com/users/500276/mark-benningfield"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 153, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1514420345, "creation_date": 1514350265, "last_edit_date": 1514420345, "question_id": 47986488, "link": "https://stackoverflow.com/questions/47986488/symbols-missing-from-linux-static-library-using-netbeans", "title": "Symbols missing from Linux static library using NetBeans", "body": "<p>I'm working on a C static library that's eventually going to be open-source, so I'm cross-compiling on Windows and Ubuntu to backstop for any portability issues.</p>\n\n<p>The problem I'm having is that the symbols from one of the object files are omitted from the Linux build. When I build the library using VS2015 on Windows, all symbols are present.</p>\n\n<p>I'm mostly used to developing for Windows, so I'm pretty spoiled to using an IDE for most build scenarios. On Ubuntu, I'm using NetBeans , and I'm not sure if the problem is with my understanding of gcc or if I don't have NetBeans set up correctly.</p>\n\n<p><strong>Details</strong></p>\n\n<p>Ubuntu 16.04LTS using gcc(Ubuntu) 5.4.0</p>\n\n<p>NetBeans IDE 8.1 C/C++</p>\n\n<p>The library consists of 3 source files and 2 header files:</p>\n\n<pre><code>queue.c  --&gt; queue implementation\nmemutil.c  --&gt; memory utilities\nmylib.c  --&gt; main library implementation\n\nqueue.h  --&gt; included by queue.c and mylib.c\nmylib.h  --&gt; header file for the static library\n</code></pre>\n\n<p>The <code>mylib.h</code> header contains the header information for the <code>memutil.c</code> source file, wrapped in a conditional that depends on the <code>MEMCHECK</code> symbol on the command line. Likewise for the code in the <code>memutil.c</code> source file. The <code>MEMCHECK</code> symbol is defined when building the library, but when I run <code>nm</code> on <code>libmylib.a</code> after the Linux build, no symbols are listed for the <code>memutil.o</code> object file. When i look at the <code>mylib.lib</code> file on Windows, all the symbols for <code>memutil.obj</code> are listed.</p>\n\n<p>Now, if I add a stubbed out source file that just includes the <code>mylib.h</code> header, all of the symbols are present in the <code>libmylib.a</code> library. I'm guessing there's some sort of header file interaction malfunction going on, but I don't where to look to find out what it is or how to fix it. I have Google'd the snot out of this with as many different phrasings as I can think of, but no joy.</p>\n\n<p>Here's the NetBeans build output, less all of the directory noise:</p>\n\n<pre><code>gcc    -c -g -Wall -DMEMCHECK -MMD -MP -MF \"build/queue.o.d\" -o build/queue.o queue.c\ngcc    -c -g -Wall -DMEMCHECK -MMD -MP -MF \"build/memutil.o.d\" -o build/memutil.o memutil.c\ngcc    -c -g -Wall -DMEMCHECK -MMD -MP -MF \"build/mylib.o.d\" -o build/mylib.o mylib.c\n\nar -rv dist/Debug/GNU-Linux/libmylib.a build/queue.o build/memutil.o build/mylib.o \nar: creating dist/Debug/GNU-Linux/libmylib.a\na - build/queue.o\na - build/memutil.o\na - build/mylib.o\nranlib dist/Debug/GNU-Linux/libmylib.a\n\nBUILD SUCCESSFUL (total time: 3s)\n</code></pre>\n\n<p>Stubbing in the header file inclusion can't be the fix for this, can it? It works, but it seems awfully crude. Besides, I can't really credit that it would be necessary with gcc and not necessary with VS2015.</p>\n"}, {"tags": ["c", "arrays", "cs50"], "comments": [{"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1514347363, "post_id": 47986167, "comment_id": 82941229, "body": "&#191;What is your question?"}], "answers": [{"comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 2, "creation_date": 1514348782, "post_id": 47986221, "comment_id": 82941487, "body": "<code>&quot;&amp;buffer, of course, explicitly tells the compiler to give you a pointer to the chunk of memory, and therefore it&#39;s the same as buffer&quot;</code> -- Huh?? That is not right. (an array passed as a parameter is converted to a pointer to the first element)"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1514349012, "post_id": 47986221, "comment_id": 82941530, "body": "That is because the address of an array is a pointer to the first element, but that does not make it the proper application or use of the pointer. If <code>buffer</code> were dynamically allocated, it would no longer be true. Proper use is to simply pass <code>buffer</code> not <code>&amp;buffer</code>."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1514349267, "post_id": 47986221, "comment_id": 82941580, "body": "That isn&#39;t a dynamic array, that is a VLA, Try <code>int *f = malloc (5 * sizeof *f); f[0] = 1, f[1] = 2; f[2] = 3; f[3] = 4; f[4] = 5;</code> and let me know how it works out."}, {"owner": {"reputation": 15118, "user_id": 7258538, "user_type": "registered", "profile_image": "https://graph.facebook.com/10102111546405895/picture?type=large", "display_name": "Charles Srstka", "link": "https://stackoverflow.com/users/7258538/charles-srstka"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1514349303, "post_id": 47986221, "comment_id": 82941590, "body": "@DavidC.Rankin If you&#39;re referring to a chunk of memory allocated using <code>malloc</code>, you are correct that <code>&amp;buffer</code> wouldn&#39;t work. But then it&#39;s not an array; it&#39;s a pointer, which follows different rules. A C array degrades to a pointer, but conceptually is not the same as a pointer (I&#39;ve been corrected on this in the past myself). I agree that <code>buffer</code> is better to use than <code>&amp;buffer</code>, but he was asking why both work."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1514349392, "post_id": 47986221, "comment_id": 82941613, "body": "That was the point. That regardless whether you have an array or pointer to int, <code>buffer</code> is the correct syntax. You don&#39;t want to create separate cases for &quot;If it&#39;s an array, do this...&quot;, &quot;If it is dynamically allocated, do that...&quot;, one works for all."}, {"owner": {"reputation": 15118, "user_id": 7258538, "user_type": "registered", "profile_image": "https://graph.facebook.com/10102111546405895/picture?type=large", "display_name": "Charles Srstka", "link": "https://stackoverflow.com/users/7258538/charles-srstka"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1514349441, "post_id": 47986221, "comment_id": 82941625, "body": "@DavidC.Rankin Again I agree, but I was explaining why you get the same behavior with the two when using an array. I wasn&#39;t really making a usage recommendation there, but I&#39;ve edited it now to add one and clear up any confusion."}, {"owner": {"reputation": 15118, "user_id": 7258538, "user_type": "registered", "profile_image": "https://graph.facebook.com/10102111546405895/picture?type=large", "display_name": "Charles Srstka", "link": "https://stackoverflow.com/users/7258538/charles-srstka"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1514349578, "post_id": 47986221, "comment_id": 82941656, "body": "@DavidC.Rankin You can also break it by explicitly making a pointer to the array and then taking the address of that; <code>char foo[512]; char *bar = foo; printf(&quot;%p %p\\n&quot;, bar, &amp;bar); &#47;&#47; this won&#39;t work.</code> It&#39;s because the behavior is different for an array versus a pointer."}, {"owner": {"reputation": 11, "user_id": 9143583, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5581b9fdc4b9fbac4f45747494edb631?s=128&d=identicon&r=PG&f=1", "display_name": "fang.", "link": "https://stackoverflow.com/users/9143583/fang"}, "edited": false, "score": 0, "creation_date": 1514430000, "post_id": 47986221, "comment_id": 82970660, "body": "Thank you - this clarified so much for me!! I guess for the last question I just wanted to know what this part of the code did:              char filename[8];             sprintf(filename, &quot;%03d.jpg&quot;, filecount);             picture = fopen(filename, &quot;w&quot;);  because arrays have fixed sizes but it seemed like this was fopen-ing an array to be written to? I&#39;m definitely understanding this wrongly and so I&#39;m just hoping for clarification haha"}, {"owner": {"reputation": 15118, "user_id": 7258538, "user_type": "registered", "profile_image": "https://graph.facebook.com/10102111546405895/picture?type=large", "display_name": "Charles Srstka", "link": "https://stackoverflow.com/users/7258538/charles-srstka"}, "reply_to_user": {"reputation": 11, "user_id": 9143583, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5581b9fdc4b9fbac4f45747494edb631?s=128&d=identicon&r=PG&f=1", "display_name": "fang.", "link": "https://stackoverflow.com/users/9143583/fang"}, "edited": false, "score": 0, "creation_date": 1514432751, "post_id": 47986221, "comment_id": 82971155, "body": "@FangShuo It creates an array, then it gives a pointer to the array to <code>sprintf</code>, which fills the array with the string it generates from <code>filecount</code>. Then, it passes the filename to <code>fopen</code>, which creates a file with that filename and opens it for writing."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1514934013, "post_id": 47986221, "comment_id": 83111702, "body": "Note that <code>printf(&quot;%p %p\\n&quot;, foo, &amp;foo);</code> is undefined behaviour and may do anything. (The argument to <code>%p</code> should have type <code>void *</code>)"}, {"owner": {"reputation": 15118, "user_id": 7258538, "user_type": "registered", "profile_image": "https://graph.facebook.com/10102111546405895/picture?type=large", "display_name": "Charles Srstka", "link": "https://stackoverflow.com/users/7258538/charles-srstka"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1514941055, "post_id": 47986221, "comment_id": 83113498, "body": "@M.M 6.9.1.10 in <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"nofollow noreferrer\">the C11 specification</a>: &quot;Array   expressions   and   function designators as arguments were converted to pointers before the call.&quot; Therefore the array should automatically be converted to a pointer before it&#39;s passed to <code>printf</code>."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1514941259, "post_id": 47986221, "comment_id": 83113542, "body": "@CharlesSrstka They are not converted to <code>void *</code> however. Read the specification of <code>printf</code>, it requires <code>void *</code> and not any other pointer type"}, {"owner": {"reputation": 15118, "user_id": 7258538, "user_type": "registered", "profile_image": "https://graph.facebook.com/10102111546405895/picture?type=large", "display_name": "Charles Srstka", "link": "https://stackoverflow.com/users/7258538/charles-srstka"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1514941602, "post_id": 47986221, "comment_id": 83113610, "body": "@M.M On pretty much every architecture you could be using, there&#39;s no practical difference between <code>void *</code> and any other type of pointer in this context. The only distinction between them is whether or not the compiler knows what the pointer points to; at runtime, they&#39;re both just an unsigned integer of whatever width the CPU uses for its pointer size. This is needlessly pedantic for something which is for demonstration purposes only and would not go into production code."}, {"owner": {"reputation": 18763, "user_id": 472495, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/4rtxd.png?s=128&g=1", "display_name": "halfer", "link": "https://stackoverflow.com/users/472495/halfer"}, "edited": false, "score": 0, "creation_date": 1516304106, "post_id": 47986221, "comment_id": 83643665, "body": "(Aside: I&#39;ve tweaked this to move the addendum to the correct chronological position, and I&#39;ve removed the meta/voting commentary, which tends to be discouraged in posts. It&#39;s worth noting that most Stack Overflow users do not sign in or vote, so this stuff is noise for most readers.)"}], "tags": [], "owner": {"reputation": 15118, "user_id": 7258538, "user_type": "registered", "profile_image": "https://graph.facebook.com/10102111546405895/picture?type=large", "display_name": "Charles Srstka", "link": "https://stackoverflow.com/users/7258538/charles-srstka"}, "is_accepted": true, "score": 1, "last_activity_date": 1516304017, "last_edit_date": 1516304017, "creation_date": 1514347857, "answer_id": 47986221, "question_id": 47986167, "link": "https://stackoverflow.com/questions/47986167/conceptual-basic-questions-about-arrays-in-c/47986221#47986221", "title": "Conceptual (Basic) Questions about Arrays in C", "body": "<blockquote>\n  <p>1 why does it not matter if its &amp;buffer and not buffer // #2 how does appending to an array work, conceptually</p>\n</blockquote>\n\n<p>Okay, here we go: Arrays in C are a rather confusing thing conceptually in a lot of ways. They share some characteristics with primitive types such as <code>char</code> and <code>int</code>, in that they're essentially values, they're allocated on the stack, and they're automatically deallocated when they go out of scope, so you don't have to worry about freeing them. However, they share their <em>interface</em> with pointers; the syntax, using square brackets, to access the first, second, third, etc. element of an array is the same as the syntax to access the first, second, third, etc. element of a buffer in the heap to which you have a pointer. This isn't necessarily terribly confusing in and of itself; it's not that unreasonable for there to be two distinct types that share a similar interface, if that interface makes sense in both cases.</p>\n\n<p>However: Arrays have a little piece of \"magic\" to them; if you assign an array to anything\u2014whether it's a variable, or an argument you're passing to a function\u2014it will automatically be converted into a pointer to the array's first element.</p>\n\n<pre><code>char foo[512];   // an array of size 512\nchar *bar = foo; // a *pointer* to the first element in the array\n</code></pre>\n\n<p>This automatic conversion is somewhat surprising in a \"close-to-the-metal\" language like C that usually has you spell out exactly what you're going to do; additionally, the fact that pointers and arrays are so interchangeable makes it easy to assume that arrays actually <em>are</em> pointers, and that pointers actually <em>are</em> arrays. However, they're not the same, and one noticeable difference is the answer to the question you asked here: why does your call to <code>fread</code> work no matter whether you pass <code>buffer</code> or <code>&amp;buffer</code>? Well, suppose you have the following variables:</p>\n\n<pre><code>int foo;\nchar bar[8];\nint baz;\n</code></pre>\n\n<p>Assuming a machine in which the size of <code>int</code> is 4, you can imagine these laid out in memory something like this:</p>\n\n<pre><code>-------------------------------------\n||f\u00a6o\u00a6o\u00a6 ||b\u00a6a\u00a6r\u00a6 \u00a6 \u00a6 \u00a6 \u00a6 ||b\u00a6a\u00a6z\u00a6 ||\n||1\u00a62\u00a63\u00a64||1\u00a62\u00a63\u00a64\u00a65\u00a66\u00a67\u00a68||1\u00a62\u00a63\u00a64||\n-------------------------------------\n</code></pre>\n\n<p>Looking at this visual abstraction, you can see something; the address where <code>bar</code> sits is (obviously) the same address where its first element, <code>b</code> lies, and therefore, when you pass <code>bar</code> to something taking a <code>char *</code> and it's converted to a pointer to its first element, <em>that's the same address as the address of the array itself.</em> This is why, if you log both an array and the address of the array, you get the same value both times:</p>\n\n<pre><code>char foo[512];\nprintf(\"%p %p\\n\", (void *)foo, (void *)&amp;foo); // these will both log the same address\n</code></pre>\n\n<p>By contrast, if <code>foo</code> is a <em>pointer</em> rather than an array (that is to say, it's typed as <code>char *</code> rather than <code>char []</code>), you will actually get <em>different</em> values for <code>foo</code> and <code>&amp;foo</code>, and passing <code>&amp;foo</code> to a function like <code>fread</code> will not work properly. This is because unlike an array, a pointer does not represent the data itself, but rather can be thought of as a signpost directing you towards data which is stored in some other location, and therefore, its address is <em>not</em> the address of the data.</p>\n\n<p>The reason this magic exists is basically for convenience, so that you can use an array as if it were a pointer. However, this creates new pitfalls for you to have to watch out for. For example, you can't return an array from a function:</p>\n\n<pre><code>char *foo() {\n    char bar[4] = \"Bar\";\n\n    return bar; // This won't work. Don't do this!\n}\n</code></pre>\n\n<p>Do you see the problem here? Basically, as soon as we try to return <code>bar</code>, it will be turned into a pointer to the first element in the array. However, as soon as <code>foo()</code> returns, the <code>bar</code> array will fall out of scope and be deallocated. The caller now has a pointer to garbage memory. This is particularly insidious since things <em>might still seem to work</em>; the memory formerly occupied by the array will continue to contain whatever values the array had until something else decides to overwrite that memory, and there's no guarantee whether this will happen sooner or later. This indeterminacy results in <em>undefined behavior</em>, which can be a source of very subtle and difficult-to-track-down bugs.</p>\n\n<p>So, in summary: passing an array gets you the same value whether you include an ampersand (<code>&amp;</code>) or not, simply because of the way arrays work. You can, and probably should, pass an array around as if it were a pointer, without the ampersand. However, you should nevertheless always be aware of whether you're dealing with a pointer or an array, in order to avoid causing undefined behavior.</p>\n\n<blockquote>\n  <p>This works, but I was just wondering:</p>\n  \n  <ol>\n  <li>When I use an unsigned char buffer[512], as I did in this case, it works, but when I try it with a char buffer[512], it breaks due to segmentation fault, and so I was just wondering what' the difference between a char and an unsigned char array in terms of memory?</li>\n  </ol>\n</blockquote>\n\n<p>Changing from <code>char</code> to <code>unsigned char</code> shouldn't cause a crash. What line does it crash on?</p>\n\n<blockquote>\n  <ol start=\"2\">\n  <li><p>I'm a little confused conceptually about why this would work, because I've always thought that arrays have a fixed size and yet in this case:</p>\n  \n  <p>char filename[8];\n  sprintf(filename, \"%03d.jpg\", count);\n  img = fopen(filename, \"a\");\n  count++;</p></li>\n  </ol>\n</blockquote>\n\n<p>This array does have a fixed size. Your sprintf statement generates a string with the following in it: three digits, a period, and then the characters \"jpg\". That's seven characters, and adding the null terminator required by C strings makes eight.</p>\n\n<p>Be <em>very</em> careful when doing things like this. If you accidentally try to write a string that's larger than the size of your array, C won't stop you, and then you'll overwrite whatever happens to come after the array in memory. This leads to undefined behavior, which means that there's no guarantee of what will happen. Your program may crash. You may silently corrupt some data somewhere else in your program. A wormhole may open to the fifth dimension, causing Earth to get invaded by evil man-eating space trilobytes. Pretty much anything goes, so be careful when working with buffers.</p>\n\n<p>There's a way for that to happen in this program, actually; if <code>count</code> becomes <code>1000</code> or larger, <code>sprintf</code> will give it more than three digits, even though you only asked for three. This will cause the buffer to overflow. In a production app, you'd want to either 1) add a check to make sure <code>count</code> never gets larger than <code>999</code>, 2) check the value of <code>count</code> to determine the appropriate size for the string, instead of hard-coding it to 8, or 3) hard-code the size of the string to be able to hold the number of digits in the largest value that an <code>int</code> can store (on Intel x86, that's <code>2147483647</code>, which is ten digits, so adding one for the dot, three for the extension, and one more for the terminator, you'd make the string 15 bytes long).</p>\n\n<h2>Edit</h2>\n\n<p>My original, hastily written answer to this question was misunderstood by some, so now that I have a bit more time, I'm rewriting it to be as clear and as detailed as I can make it. If you're still not convinced, please read <a href=\"http://c-faq.com/aryptr/index.html\" rel=\"nofollow noreferrer\">section 6 of the comp.lang.c FAQ</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 304, "user_id": 1561306, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/55f629698631e64c7a3983faeb05ae22?s=128&d=identicon&r=PG", "display_name": "Tsikon", "link": "https://stackoverflow.com/users/1561306/tsikon"}, "is_accepted": false, "score": 0, "last_activity_date": 1514369266, "creation_date": 1514369266, "answer_id": 47990170, "question_id": 47986167, "link": "https://stackoverflow.com/questions/47986167/conceptual-basic-questions-about-arrays-in-c/47990170#47990170", "title": "Conceptual (Basic) Questions about Arrays in C", "body": "<p>Using &amp;buffer and buffer are two different things.\n<strong>&amp;buffer</strong> gives you the memory address of buffer variable while using <strong>buffer</strong> gives you the value that is pointed by buffer (its value).\nfor fread you should use only buffer (or &amp;buffer[0]) and not &amp;buffer.</p>\n\n<p>I don't know exactly what you mean by \"appending to an array\" but I'll try to answer:\nArray is a fixed size of memory block that is stored continuously in memory.</p>\n\n<ol>\n<li>If you want to append some more data to it without exceed its size there are many ways to do that. One is to simply keep a pointer to the next index of the array (starting from 0) and every time you store more data to it increase the pointer with the amount of bytes written.</li>\n<li>If your amount of data exceeds the array size you should use a dynamically allocated array and reallocate it as needed.</li>\n</ol>\n\n<p>unsigned char buffer[512] and char buffer[512] are stored exactly the same in the memory. but notice that you use signed char, you store values that overflow.</p>\n\n<pre><code>char c = 0xff // Overflow\nunsigned char c = 0xff // OK\n</code></pre>\n\n<p>but that has nothing to do with segmentation fault.</p>\n\n<p>The last part of your question is not understood.</p>\n"}, {"tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": false, "score": 1, "last_activity_date": 1514933467, "last_edit_date": 1592644375, "creation_date": 1514933467, "answer_id": 48068904, "question_id": 47986167, "link": "https://stackoverflow.com/questions/47986167/conceptual-basic-questions-about-arrays-in-c/48068904#48068904", "title": "Conceptual (Basic) Questions about Arrays in C", "body": "<blockquote>\n<p>When I use an unsigned char buffer[512], as I did in this case, it works, but when I try it with a char buffer[512], it breaks due to segmentation fault, and so I was just wondering what' the difference between a char and an unsigned char array in terms of memory?</p>\n</blockquote>\n<p>None - <code>unsigned char</code> is no bigger than <code>signed char</code> or just plain <code>char</code>:</p>\n<blockquote>\n<strong>6.2.5 Types</strong><br>\n...<br>\n5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;An object declared as type <strong><code>signed char</code></strong> occupies the same amount of storage as a\n\u2018\u2018plain\u2019\u2019 <strong><code>char</code></strong> object. A \u2018\u2018plain\u2019\u2019 <strong><code>int</code></strong> object has the natural size suggested by the\narchitecture of the execution environment (large enough to contain any value in the range\n<strong><code>INT_MIN</code></strong> to <strong><code>INT_MAX</code></strong> as defined in the header <strong><code>&lt;limits.h&gt;</code></strong>).<br>\n<br>\n6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;For each of the signed integer types, there is a corresponding (but different) unsigned\ninteger type (designated with the keyword <strong><code>unsigned</code></strong>) that uses the same amount of\nstorage (including sign information) and has the same alignment requirements. The type\n<strong><code>_Bool</code></strong> and the unsigned integer types that correspond to the standard signed integer\ntypes are the <em>standard unsigned integer types</em>. The unsigned integer types that\ncorrespond to the extended signed integer types are the <em>extended unsigned integer types</em>.\nThe standard and extended unsigned integer types are collectively called <em>unsigned integer\ntypes</em>.\n<sup>40)</sup>\n<hr>\n<sup>\n40) Therefore, any statement in this Standard about unsigned integer types also applies to the extended\nunsigned integer types.\n</sup>\n</blockquote>\n<p><em><sup><a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"nofollow noreferrer\">C 2011 Online Draft</a></sup></em></p>\n<p>Just briefly looking at the code, I don't see any <em>obvious</em> reason why it should crash when <code>buffer</code> is signed vs. unsigned, but there could be something I'm missing.</p>\n<blockquote>\n<p>why does it not matter if its &amp;buffer and not buffer</p>\n</blockquote>\n<p>Sit down and get comfortable, this is going to take a while...</p>\n<p>Array expressions are special:</p>\n<blockquote>\n<strong>6.3.2.1 Lvalues, arrays, and function designators</strong><br>\n...<br>\n3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Except when it is the operand of the <strong><code>sizeof</code></strong> operator, the <strong><code>_Alignof</code></strong> operator, or the\nunary <strong><code>&</code></strong> operator, or is a string literal used to initialize an array, an expression that has\ntype \u2018\u2018array of <em>type</em>\u2019\u2019 is converted to an expression with type \u2018\u2018pointer to <em>type</em>\u2019\u2019 that points\nto the initial element of the array object and is not an lvalue. If the array object has\nregister storage class, the behavior is undefined.\n</blockquote>\n<p>The <em>expression</em> <code>buffer</code> has type <code>unsigned char [512]</code>.  When that expression is <em>not</em> the operand of the <code>sizeof</code> or unary <code>&amp;</code> operators, it is converted (&quot;decays&quot;) to an expression of type <code>unsigned char *</code>, and the value of the expression will be the address of the first element.</p>\n<p>So, if you wrote</p>\n<pre><code>fread( buffer, 512, 1, rem ); // do not use &amp; operator here\n</code></pre>\n<p>the function <code>fread</code> would receive a pointer as its first parameter, not an array object.  Given the declaration</p>\n<pre><code>unsigned char buffer[512];\n</code></pre>\n<p>all of the following are true:</p>\n<pre><code>Expression    Type                    &quot;Decays&quot; to        Value\n----------    ----                    -----------        -----\n    buffer    unsigned char [512]     unsigned char *    Address of first element\n   &amp;buffer    unsigned char (*)[512]  n/a                Address of array\n   *buffer    unsigned char           n/a                Value of first element\n buffer[i]    unsigned char           n/a                Value of i'th element\n</code></pre>\n<p>The <em>expressions</em> <code>buffer</code> and <code>&amp;buffer</code> both evaluate to the address of the first element of the array, but the <em>types</em> of the expressions are different - <code>unsigned char *</code> vs. <code>unsigned char (*)[512]</code>.  A pointer to <code>unsigned char</code> will be treated differently than a pointer to an <em>array</em> of <code>unsigned char</code> in some circumstances.  For functions like <code>fread</code>, they expect a pointer to an individual element, not a pointer to an array.</p>\n<p>At this point you're asking, &quot;<em>why</em> is this the case?&quot;</p>\n<p>C was derived from an ealier language called B.  In B, the result of a declaration like</p>\n<pre><code>auto vec[10];\n</code></pre>\n<p>would look like this:</p>\n<pre><code>     +---+      +---+\nvec: |   | ---&gt; |   | vec[0] \n     +---+      +---+\n                |   | vec[1]\n                +---+\n                 ...\n                +---+\n                |   | vec[9]\n                +---+\n       \n</code></pre>\n<p>B would set aside an extra memory cell to act as a (kind-of-sort-of) pointer to the first element of the array.  In B, the array subscript operation <code>a[i]</code> was defined as <code>*(a + i)</code> - that is, given a starting address <code>a</code>, offset <code>i</code> <em>elements</em> from that address and dereference the result.</p>\n<p>When Ritchie was designing C, he wanted to keep B's array semantics, but he didn't want to have to keep a separate pointer to the first element of the array.  So, he got rid of it - instead, he added a rule that any array expression that was not the operand of <code>sizeof</code> or unary <code>&amp;</code> would be converted to a pointer expression, and that the pointer would evaluate to the address of the first element.  So, when you declare an array in C such as</p>\n<pre><code>int vec[10];\n</code></pre>\n<p>it looks like this:</p>\n<pre><code>     +---+\nvec: |   | vec[0]\n     +---+\n     |   | vec[1]\n     +---+\n      ...\n     +---+\n     |   | vec[9]\n     +---+\n</code></pre>\n<p>No separate memory is set aside for a pointer - there is no <code>vec</code> object apart from the array elements themselves.  Whenever the compiler sees <code>vec</code> in a context that isn't the operand of the <code>sizeof</code> or unary <code>&amp;</code> operators, it converts it to an expression that's equivalent to <code>&amp;vec[0]</code>.  This is why <code>buffer</code> and <code>&amp;buffer</code> evaluate to the same thing - the address of the first element of the array is the same as the address of the entire array.</p>\n<p>Array subscripting works the same way in C as it did in B - <code>a[i] == *(a + i)</code>.  It's just that in this case, the array expression must be converted (&quot;decay&quot;) to a pointer expression first.</p>\n<p><em>This is only true for arrays</em> - no other aggregate type (such as <code>struct</code> or <code>union</code> types) is treated this way.  The mechanics of accessing members of a <code>struct</code> or <code>union</code> are different from accessing elements of an array.</p>\n<blockquote>\n<p>how does appending to an array work, conceptually</p>\n</blockquote>\n<p>Arrays are fixed in size over their lifetime - &quot;appending&quot; to an array typically means writing to available or unused elements.  For example, take the declaration</p>\n<pre><code>char buf[100] = &quot;foo&quot;;\n</code></pre>\n<p>which gives us</p>\n<pre><code>     +---+\nbuf: |'f'| buf[0]\n     +---+\n     |'o'| buf[1]\n     +---+\n     |'o'| buf[2]\n     +---+\n     | 0 | buf[3]\n     +---+\n     | ? | buf[4]\n     +---+\n      ...\n     +---+\n     | ? | buf[99]\n     +---+\n</code></pre>\n<p>Elements 4 through 99 haven't been written to yet, so we can add to the string:</p>\n<pre><code>strcat( buf, &quot;bar&quot; );\n</code></pre>\n<p>now gives us</p>\n<pre><code>     +---+\nbuf: |'f'| buf[0]\n     +---+\n     |'o'| buf[1]\n     +---+\n     |'o'| buf[2]\n     +---+\n     |'b'| buf[3]\n     +---+\n     |'a'| buf[4]\n     +---+\n     |'r'| buf[5]\n     +---+\n     | 0 | buf[6]\n     +---+\n     | ? | buf[7]\n     +---+\n      ...\n     +---+\n     | ? | buf[99]\n     +---+\n</code></pre>\n<p><code>buf</code> now contains the sequence <code>{'f', 'o', 'o', 'b', 'a', 'r', 0}</code>, leaving 93 elements available.  We can keep doing this until we have a string that's 99 characters long (leaving 1 element for the string terminator).  But the array's <em>size</em> is fixed at 100 and cannot be changed.  If we try to store more than 100 characters to <code>buf</code>, what will happen is that those extra characters will be stored beyond the array's bounds and overwrite other objects.  Depending on what gets clobbered, you may wind up with bad data, your program may crash, you may branch into a different routine, or your code <em>may appear to work correctly</em>.  This is what happens in the snippet where you try to create a file name longer than the buffer sized to hold it.  Whatever was in memory following the buffer wasn't &quot;important&quot;, so the code <em>appeared</em> to work with no issues.</p>\n<p>There is a thing called <em>variable-length arrays</em> that was introduced in C99, where an array's size isn't determined until runtime:</p>\n<pre><code>int n = get_some_value_at_runtime();\nint array[n];\n</code></pre>\n<p>However, like regular fixed-size arrays, you cannot change a VLA's length over its lifetime.  &quot;Variable-length&quot; simply means that each time you create an instance of the array, it can be a different size.</p>\n<p>If you need storage that can physically grow or shrink as necessary, you'll have to use dynamic memory management routines (<code>malloc</code>, <code>calloc</code>, <code>realloc</code>, and <code>free</code>).</p>\n"}], "owner": {"reputation": 11, "user_id": 9143583, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5581b9fdc4b9fbac4f45747494edb631?s=128&d=identicon&r=PG&f=1", "display_name": "fang.", "link": "https://stackoverflow.com/users/9143583/fang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 204, "favorite_count": 0, "accepted_answer_id": 47986221, "answer_count": 3, "score": -1, "last_activity_date": 1516304017, "creation_date": 1514347212, "last_edit_date": 1514348692, "question_id": 47986167, "link": "https://stackoverflow.com/questions/47986167/conceptual-basic-questions-about-arrays-in-c", "title": "Conceptual (Basic) Questions about Arrays in C", "body": "<p>I'm really new to C programming, and for 1 of our homework assignment we've basically had to recover a jpg images from a memory card. My code is this:</p>\n\n<pre><code>#include &lt;cs50.h&gt;       \n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n// typedef uint8_t BYTE; \n// #define BUFFER_SIZE 512\n\nint main(int argc, char *argv[])\n{\n    // ensure proper usage\n    if (argc != 2)\n    {\n        fprintf(stderr, \"Usage: ./recover image\\n\");\n        return 1;\n    }\n\n    //opens the memory card for reading\n    FILE* mem = fopen(argv[1], \"r\");\n    if (mem == NULL)\n    {\n        fprintf(stderr, \"Could not open %s.\\n\", argv[1]);\n        return 1;\n    }\n\n    unsigned char buffer[512];\n    FILE* img = NULL;\n    int found = 0;\n    int count = 0;\n\n    while (fread(&amp;buffer, 512,1,mem) == 1)\n    {\n        if (buffer[0] == 0xff &amp;&amp; buffer[1] == 0xd8 &amp;&amp; buffer[2] == 0xff &amp;&amp; (buffer[3] &amp; 0xe0) == 0xe0)\n        {\n            if (found == 1)\n                fclose(img);\n            else\n                found = 1;\n\n\n        char filename[8];\n        sprintf(filename, \"%03d.jpg\", count);\n        img = fopen(filename, \"a\");\n        count++;\n        }\n\n        if (found ==1)\n        {\n            fwrite(&amp;buffer,512,1,img);\n        }\n    }\n\n    fclose(mem);\n    fclose(img);\n    return 0;\n}\n</code></pre>\n\n<p>// #1 why does it not matter if its &amp;buffer and not buffer\n// #2 how does appending to an array work, conceptually</p>\n\n<p>This works, but I was just wondering:</p>\n\n<ol>\n<li><p>When I use an unsigned char buffer[512], as I did in this case, it works, but when I try it with a char buffer[512], it breaks due to segmentation fault, and so I was just wondering what' the difference between a char and an unsigned char array in terms of memory?</p></li>\n<li><p>I'm a little confused conceptually about why this would work, because I've always thought that arrays have a fixed size and yet in this case:</p>\n\n<p><code>char filename[8];\nsprintf(filename, \"%03d.jpg\", count);\nimg = fopen(filename, \"a\");\ncount++;</code></p></li>\n</ol>\n\n<p>I'm not exactly sure what's happening because i'm opening an array onto a block of memory and then... to that array?</p>\n\n<p>A portion of the code was given to us in a video walkthrough for the homework, and now that I've finished it I'm just a little confused by some of the concepts - appreciate any help I can get! </p>\n"}, {"tags": ["c", "linux"], "comments": [{"owner": {"reputation": 262, "user_id": 4671911, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f8ea67e9ae2150de4113dc3920ac86fc?s=128&d=identicon&r=PG&f=1", "display_name": "jess", "link": "https://stackoverflow.com/users/4671911/jess"}, "edited": false, "score": 1, "creation_date": 1514344793, "post_id": 47985861, "comment_id": 82940750, "body": "Use the information in the answer given <a href=\"https://stackoverflow.com/questions/7459259/inserting-characters-into-a-string\">here</a> and then use a loop to insert as many hyphens as you need rather than hard coding it like you&#39;re doing"}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1514344970, "post_id": 47985861, "comment_id": 82940796, "body": "turn on warnings.. you have one too many arguments in your <code>sprintf</code> line, both gcc and clang warned me... this is probably UB. But what output do you get? Looks like I&#39;m getting what you want"}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1514344999, "post_id": 47985861, "comment_id": 82940805, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/7459259/inserting-characters-into-a-string\">Inserting characters into a string</a>"}, {"owner": {"reputation": 31, "user_id": 9143466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5a3edf872659f26a23dfe1778cdf8e?s=128&d=identicon&r=PG&f=1", "display_name": "Djmc", "link": "https://stackoverflow.com/users/9143466/djmc"}, "edited": false, "score": 0, "creation_date": 1514345303, "post_id": 47985861, "comment_id": 82940858, "body": "The following code worked for me   for(int i = 0; i &lt; strlen(buf); i++){        if( (i % 5) == 0) {          buf[5] = &#39;-&#39;;        }    }"}], "answers": [{"comments": [{"owner": {"reputation": 6779, "user_id": 1342941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a77b35477fab1e681d7e14f7ea78b178?s=128&d=identicon&r=PG", "display_name": "happydave", "link": "https://stackoverflow.com/users/1342941/happydave"}, "edited": false, "score": 4, "creation_date": 1514346315, "post_id": 47986037, "comment_id": 82941051, "body": "Shouldn&#39;t it be <code>len + len &#47; 5</code>, not <code>% 5</code>?"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 6779, "user_id": 1342941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a77b35477fab1e681d7e14f7ea78b178?s=128&d=identicon&r=PG", "display_name": "happydave", "link": "https://stackoverflow.com/users/1342941/happydave"}, "edited": false, "score": 1, "creation_date": 1514348495, "post_id": 47986037, "comment_id": 82941437, "body": "Yep, we all have our moments <code>:)</code>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1514363399, "post_id": 47986037, "comment_id": 82946143, "body": "<code>char buf[len + len &#47; HYPHPOS]</code> appears 1 too small.  Consider <code>char str[] = &quot;1&quot;;</code>  <code>buf[]</code> should be at least size 2."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1514366131, "post_id": 47986037, "comment_id": 82947215, "body": "Yes, we can add one, but I was counting on the fact that you don&#39;t insert a hyphen unless you have at least <code>6</code> chars. (but even then you still need the <code>+1</code>... hmmm. too much egg nog) Thanks!"}], "tags": [], "owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "is_accepted": false, "score": 5, "last_activity_date": 1514389554, "last_edit_date": 1514389554, "creation_date": 1514345785, "answer_id": 47986037, "question_id": 47985861, "link": "https://stackoverflow.com/questions/47985861/insert-hyphens-after-fifth-character-in-c/47986037#47986037", "title": "Insert hyphens after fifth character in C", "body": "<p>You know you want <code>(length - 1) / 5</code> hyphens. So for buf, you need storage for <code>buf[len + (len -1) / 5 + 1];</code> characters. Then simply loop over the characters in <code>str</code> and (skipping the case where <code>i = 0</code>) if <code>i % 5 == 0</code> write a hyphen to <code>buf</code> <em>in addition to</em> copying the character from <code>str</code>.</p>\n\n<p>Putting it together, you can do something similar to:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\n#define HYPHPOS 5\n\nint main(void) {\n\n    char str[] = \"356a192b7913b04c54574d18c28d46e6395428ab\";\n    size_t len = strlen (str);\n    char buf[len + (len -1)/ HYPHPOS + 1], *p = buf;\n\n    for (size_t i = 0; i &lt; len; i++) {\n        if (i &amp;&amp; i % HYPHPOS == 0)\n            *p++ = '-';\n        *p++ = str[i];\n    }\n    *p = 0;\n\n    printf (\"str : %s\\nbuf : %s\\n\", str, buf);\n\n    return 0;\n}\n</code></pre>\n\n<p>You can also simply use <code>str[i]</code> as the loop test clause.</p>\n\n<p><strong>Example Use/Output</strong></p>\n\n<pre><code>$ ./bin/hyphenate\nstr : 356a192b7913b04c54574d18c28d46e6395428ab\nbuf : 356a1-92b79-13b04-c5457-4d18c-28d46-e6395-428ab\n</code></pre>\n\n<p>Look things over and let me know if you have further questions.</p>\n"}, {"comments": [{"owner": {"reputation": 31, "user_id": 9143466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5a3edf872659f26a23dfe1778cdf8e?s=128&d=identicon&r=PG&f=1", "display_name": "Djmc", "link": "https://stackoverflow.com/users/9143466/djmc"}, "edited": false, "score": 0, "creation_date": 1514385686, "post_id": 47986144, "comment_id": 82956158, "body": "Very nice function thank you, can you please provide me another example without putting it in a function just putting the code in the Main()"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 31, "user_id": 9143466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5a3edf872659f26a23dfe1778cdf8e?s=128&d=identicon&r=PG&f=1", "display_name": "Djmc", "link": "https://stackoverflow.com/users/9143466/djmc"}, "edited": false, "score": 0, "creation_date": 1514389764, "post_id": 47986144, "comment_id": 82957934, "body": "@Djmc: that\u2019s a nonsense request \u2014 or, a little more charitably, a sign of a novice.  You need code in functions, not in main.  You don\u2019t write code that could be in a function as the code in <code>main()</code>."}, {"owner": {"reputation": 31, "user_id": 9143466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5a3edf872659f26a23dfe1778cdf8e?s=128&d=identicon&r=PG&f=1", "display_name": "Djmc", "link": "https://stackoverflow.com/users/9143466/djmc"}, "edited": false, "score": 0, "creation_date": 1514406305, "post_id": 47986144, "comment_id": 82964745, "body": "Am asking for this cause I already have a function that generate a hardware based product keys and I want to incorporate this code into this function instead of jumping into another function. and off course am not coding this directly in the main function.so don&#39;t make assumptions."}, {"owner": {"reputation": 81087, "user_id": 104458, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/cc46b8a10ecb92e61aaeb1efe436a0c8?s=128&d=identicon&r=PG", "display_name": "selbie", "link": "https://stackoverflow.com/users/104458/selbie"}, "edited": false, "score": 0, "creation_date": 1514420304, "post_id": 47986144, "comment_id": 82968771, "body": "SO is not for you to ask others do your assignments or homework for you. In providing an answer, my hope was that you would study it, learn from it, apply to your own understanding, and incorporate into your immediate problem. It&#39;s debatable if it makes sense to inline the code or have it componentized into a separate helper function. <b>But the ability to refactor and merge working code from one source and put into another is fundamental to all aspects of programming.</b> You need to learn how to do this through practice, trial and error, and ask follow-up questions."}, {"owner": {"reputation": 31, "user_id": 9143466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5a3edf872659f26a23dfe1778cdf8e?s=128&d=identicon&r=PG&f=1", "display_name": "Djmc", "link": "https://stackoverflow.com/users/9143466/djmc"}, "edited": false, "score": 1, "creation_date": 1514432261, "post_id": 47986144, "comment_id": 82971056, "body": "Thank you for all your help and sorry for the misunderstanding, I code in C# so am new to C and still learning how to use pointers in functions, anyway I managed to finish my hobby project with your help and others here. thanks"}], "tags": [], "owner": {"reputation": 81087, "user_id": 104458, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/cc46b8a10ecb92e61aaeb1efe436a0c8?s=128&d=identicon&r=PG", "display_name": "selbie", "link": "https://stackoverflow.com/users/104458/selbie"}, "is_accepted": true, "score": 2, "last_activity_date": 1514347824, "last_edit_date": 1514347824, "creation_date": 1514347012, "answer_id": 47986144, "question_id": 47985861, "link": "https://stackoverflow.com/questions/47985861/insert-hyphens-after-fifth-character-in-c/47986144#47986144", "title": "Insert hyphens after fifth character in C", "body": "<p>Here's a helper function I whipped up for you.  It takes a string as a parameter along with the desired hyphens spacing and returns a new string with hyphens within it.  Notice it makes sure that there's no trailing hyphens at the end of the string.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n\nchar* hyphenize(const char* str, int spacing)\n{\n    size_t len, newlen;\n    char *ptr, *buf;\n\n    if (spacing &lt; 1)\n    {\n        return NULL; // error!\n    }\n\n    len = strlen(str);\n    newlen = len + (len / spacing) + 1;\n    buf = (char*)malloc(newlen);\n    ptr = buf;\n    for (size_t x = 0; x &lt; len; x++)\n    {\n        *ptr++ = str[x];\n        if ((x != 0) &amp;&amp; (x != (len - 1)) &amp;&amp; ((x + 1) % spacing == 0))\n        {\n            *ptr++ = '-';\n        }\n    }\n    *ptr = '\\0';\n    return buf;\n}\n\nint main()\n{\n    char str[] = \"356a192b7913b04c54574d18c28d46e6395428ab\";\n    char* p = hyphenize(str, 5);\n    printf(\"%s\\n\", p);\n    free(p);\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 9143466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5a3edf872659f26a23dfe1778cdf8e?s=128&d=identicon&r=PG&f=1", "display_name": "Djmc", "link": "https://stackoverflow.com/users/9143466/djmc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 143, "favorite_count": 0, "accepted_answer_id": 47986144, "answer_count": 2, "score": 0, "last_activity_date": 1514389554, "creation_date": 1514344100, "last_edit_date": 1514344320, "question_id": 47985861, "link": "https://stackoverflow.com/questions/47985861/insert-hyphens-after-fifth-character-in-c", "title": "Insert hyphens after fifth character in C", "body": "<p>I have a char array, and I want to insert hyphens after every five characters. I have tried the following code but am looking for a better way to accomplish this task, what string function should I use, and how? Thanks. :D</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\nint main()\n{\n    char str[]=\"356a192b7913b04c54574d18c28d46e6395428ab\";\n    char buf[50];\n\n    sprintf(buf, \"%.5s-%.5s-%.5s-%.5s-%.5s-%.5s-%.5s-%.5s\",str, str+5,str+10,str+15,str+20,str+25,str+30,str+35,str+40);\n    printf(\"%s\",buf);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "gcc", "gmp", "mpfr", "mpc"], "comments": [{"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 2, "creation_date": 1514339777, "post_id": 47985429, "comment_id": 82939899, "body": "Stop shouting PLEASE and write a title that is more meaningful. It&#39;s clear you <i>need help</i>, or you wouldn&#39;t be posting here, and screaming <i>PLEASE</i> is a little demanding and rude when you&#39;re asking people to <b>donate their time</b> to <b>help you for free</b>. The error message tells you what&#39;s wrong - it&#39;s not finding the <b>specific version</b> that it requires. <i>Latest</i> doesn&#39;t mean <i>correct</i>."}, {"owner": {"reputation": 1345, "user_id": 4554967, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/3e7affacfbfa560a3f2ca86204fb5b84?s=128&d=identicon&r=PG&f=1", "display_name": "zappy", "link": "https://stackoverflow.com/users/4554967/zappy"}, "edited": false, "score": 0, "creation_date": 1514347359, "post_id": 47985429, "comment_id": 82941228, "body": "How can someone answer this question  without knowing &#39;$TARGET&#39; , &#39;$PREFIX&#39; . ?  There might be some lines in log which says the package version needed and version it found on your PC."}, {"owner": {"reputation": 18763, "user_id": 472495, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/4rtxd.png?s=128&g=1", "display_name": "halfer", "link": "https://stackoverflow.com/users/472495/halfer"}, "edited": false, "score": 0, "creation_date": 1514359208, "post_id": 47985429, "comment_id": 82944610, "body": "Please read <a href=\"//meta.stackoverflow.com/q/326569\">Under what circumstances may I add \u201curgent\u201d or other similar phrases to my question, in order to obtain faster answers?</a> - the summary is that this is not an ideal way to address volunteers, and is probably counterproductive to obtaining answers. Please refrain from adding this to your questions."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 8928014, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/658879213d001eb254995700f6be0851?s=128&d=identicon&r=PG&f=1", "display_name": "Fathergorgi1", "link": "https://stackoverflow.com/users/8928014/fathergorgi1"}, "edited": false, "score": 0, "creation_date": 1517676260, "post_id": 47992009, "comment_id": 84195802, "body": "Thanks that helped!"}], "tags": [], "owner": {"reputation": 1359, "user_id": 8925428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d061456a532c466a047e03a9128f725f?s=128&d=identicon&r=PG&f=1", "display_name": "Kyrill", "link": "https://stackoverflow.com/users/8925428/kyrill"}, "is_accepted": false, "score": 2, "last_activity_date": 1514376786, "creation_date": 1514376786, "answer_id": 47992009, "question_id": 47985429, "link": "https://stackoverflow.com/questions/47985429/how-to-compile-gcc-cross-compiler/47992009#47992009", "title": "How to compile GCC cross-compiler?", "body": "<p>Unless you <em>really</em> care about specific gmp/mpfr etc versions I suggest you run the <code>contrib/download_prerequisites</code> script from the top-level GCC source directory and then omit the <code>--with-gmp=$PREFIX --with-mpc=$PREFIX --with-mpfr=$PREFIX</code> from your configure line. The <code>download_prerequisites</code> script will download and unpack the right versions of the libraries that your GCC version needs and it will create the right symlinks in the right places</p>\n"}], "owner": {"reputation": 33, "user_id": 8928014, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/658879213d001eb254995700f6be0851?s=128&d=identicon&r=PG&f=1", "display_name": "Fathergorgi1", "link": "https://stackoverflow.com/users/8928014/fathergorgi1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 774, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1514376786, "creation_date": 1514339414, "last_edit_date": 1514359172, "question_id": 47985429, "link": "https://stackoverflow.com/questions/47985429/how-to-compile-gcc-cross-compiler", "title": "How to compile GCC cross-compiler?", "body": "<p>I am trying to compile GCC for i586-elf but every time I run the 'configure' file with this command:</p>\n\n<pre><code>./configure --target=$TARGET --prefix=$PREFIX --disable-nls --enable\nlanguages=c --without-headers --with-gmp=$PREFIX --with-mpc=$PREFIX\n--with-mpfr=$PREFIX\n</code></pre>\n\n<p>Then it gives me this error:</p>\n\n<pre><code>checking for the correct version of gmp.h... yes\nchecking for the correct version of mpfr.h... yes\nchecking for the correct version of mpc.h... yes\nchecking for the correct version of the gmp/mpfr/mpc libraries... no.\n</code></pre>\n\n<p>Although I have specified where gmp, mpfr, and mpc are located. And I have the latest versions of them. Is there anything I am missing? </p>\n"}, {"tags": ["c", "llvm"], "comments": [{"owner": {"reputation": 31371, "user_id": 281108, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/b160d50a7ecfe6018348629cb8677538?s=128&d=identicon&r=PG", "display_name": "Ismail Badawi", "link": "https://stackoverflow.com/users/281108/ismail-badawi"}, "edited": false, "score": 0, "creation_date": 1514344647, "post_id": 47985414, "comment_id": 82940715, "body": "You haven&#39;t shown what <code>fn</code> is, but I&#39;m guessing it&#39;s the <code>Function</code> and not the <code>CallInst</code>. If so you&#39;re iterating over the parameters in the function definition or declaration, not the arguments to the call."}, {"owner": {"reputation": 145, "user_id": 9138616, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9fdd565ce3edf45d047e85604ed1ac8e?s=128&d=identicon&r=PG&f=1", "display_name": "Hif", "link": "https://stackoverflow.com/users/9138616/hif"}, "reply_to_user": {"reputation": 31371, "user_id": 281108, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/b160d50a7ecfe6018348629cb8677538?s=128&d=identicon&r=PG", "display_name": "Ismail Badawi", "link": "https://stackoverflow.com/users/281108/ismail-badawi"}, "edited": false, "score": 0, "creation_date": 1514345374, "post_id": 47985414, "comment_id": 82940870, "body": "Thanks. Can you guide me on how can I iterate over the arguments to the call?"}, {"owner": {"reputation": 145, "user_id": 9138616, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9fdd565ce3edf45d047e85604ed1ac8e?s=128&d=identicon&r=PG&f=1", "display_name": "Hif", "link": "https://stackoverflow.com/users/9138616/hif"}, "reply_to_user": {"reputation": 31371, "user_id": 281108, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/b160d50a7ecfe6018348629cb8677538?s=128&d=identicon&r=PG", "display_name": "Ismail Badawi", "link": "https://stackoverflow.com/users/281108/ismail-badawi"}, "edited": false, "score": 0, "creation_date": 1514346039, "post_id": 47985414, "comment_id": 82941004, "body": "@IsmailBadawi Thanks a lot. I get it that I should be using <code>CallInst</code> instead of <code>Function</code>. Can you write it as an answer so I can accept it?"}], "answers": [{"tags": [], "owner": {"reputation": 31371, "user_id": 281108, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/b160d50a7ecfe6018348629cb8677538?s=128&d=identicon&r=PG", "display_name": "Ismail Badawi", "link": "https://stackoverflow.com/users/281108/ismail-badawi"}, "is_accepted": true, "score": 0, "last_activity_date": 1514347457, "creation_date": 1514347457, "answer_id": 47986190, "question_id": 47985414, "link": "https://stackoverflow.com/questions/47985414/casting-function-arguments-in-llvm/47986190#47986190", "title": "Casting Function Arguments in LLVM", "body": "<p>You haven't shown what <code>fn</code> is, but I'm guessing it's the <code>Function</code> and not the <code>CallInst</code>. If so, you're iterating over the parameters in the function definition or declaration, not the arguments to the call. You can just use the <code>CallInst</code> instead of <code>fn</code> and the same code should work.</p>\n"}], "owner": {"reputation": 145, "user_id": 9138616, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9fdd565ce3edf45d047e85604ed1ac8e?s=128&d=identicon&r=PG&f=1", "display_name": "Hif", "link": "https://stackoverflow.com/users/9138616/hif"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 426, "favorite_count": 0, "accepted_answer_id": 47986190, "answer_count": 1, "score": 0, "last_activity_date": 1514347457, "creation_date": 1514339256, "last_edit_date": 1514345283, "question_id": 47985414, "link": "https://stackoverflow.com/questions/47985414/casting-function-arguments-in-llvm", "title": "Casting Function Arguments in LLVM", "body": "<p>I have LLVM IR that looks like </p>\n\n<pre><code>%7 = load i32** %ok, align 8\ncall void @free(i8* %7) #3\n</code></pre>\n\n<p>I want to extract <code>%7</code> from the argument list of <code>free</code> and check if the previous <code>Instruction</code> (%7) and the argument instruction are same. The part of my code for this purpose looks like</p>\n\n<pre><code>if(CallInst* call_inst = dyn_cast&lt;CallInst&gt;(&amp;I)) {   // I is the Instruction\n   Function* fn = call_inst-&gt;getCalledFunction();\n   StringRef fn_name = fn-&gt;getName();\n   if (fn_name == \"free\") {    // fn_name is the called function name\n       for(auto args = fn-&gt;arg_begin(); args != fn-&gt;arg_end(); ++args) {\n           Instruction* arg = dyn_cast&lt;Instruction&gt;(&amp;(*args));\n           if (arg != NULL)\n               errs() &lt;&lt; arg-&gt;getOperand(0)-&gt;getName() &lt;&lt; \"\\n\";  // to check\n           if (arg == parent_free_bitcast_inst) {\n               // do something\n        }\n    } \n</code></pre>\n\n<p>The code does not work. I have tried casting but still <code>arg-&gt;getOperand(0)-&gt;getName()</code> results in an error instead of <code>ok</code>. Can anyone guide me on how can I go about doing this?</p>\n"}, {"tags": ["c", "linux", "audio", "raspberry-pi", "alsa"], "comments": [{"owner": {"reputation": 509, "user_id": 8857328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a43855efb44db02b57d0f7253394882?s=128&d=identicon&r=PG&f=1", "display_name": "VladP", "link": "https://stackoverflow.com/users/8857328/vladp"}, "edited": false, "score": 0, "creation_date": 1514336836, "post_id": 47984823, "comment_id": 82939447, "body": "It appears that there are more answer on some other forums. Try this: <a href=\"https://unix.stackexchange.com/questions/74558/change-sampling-rate-in-alsa\" title=\"change sampling rate in alsa\">unix.stackexchange.com/questions/74558/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 157205, "user_id": 11654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/586424ca0847070dc1868aa58077003e?s=128&d=identicon&r=PG", "display_name": "CL.", "link": "https://stackoverflow.com/users/11654/cl"}, "is_accepted": false, "score": 1, "last_activity_date": 1514383824, "creation_date": 1514383824, "answer_id": 47993612, "question_id": 47984823, "link": "https://stackoverflow.com/questions/47984823/synchronizing-c-code-with-alsa/47993612#47993612", "title": "Synchronizing C code with ALSA", "body": "<p>To prevent underruns, you should try to keep the buffer as full as possible at all times.</p>\n\n<p>This happens automatically when the device is in the (default) blocking mode: when you try to write samples, but the ring buffer is full, the function sleeps until some space has become available. So just try to write samples as fast as possible.</p>\n"}], "owner": {"reputation": 37, "user_id": 9143161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a702d942c7680927195ec7ca4f05a3e7?s=128&d=identicon&r=PG&f=1", "display_name": "MarkBeauchene", "link": "https://stackoverflow.com/users/9143161/markbeauchene"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 139, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1514383824, "creation_date": 1514331791, "question_id": 47984823, "link": "https://stackoverflow.com/questions/47984823/synchronizing-c-code-with-alsa", "title": "Synchronizing C code with ALSA", "body": "<p>I am generating sound samples on the fly with C.  OS is Linux.  Hardware is Raspberry Pi 3 Model B.  I need to write the generated samples to the circular buffer synchronized to the sample rate.  ALSA seems quite sophisticated, so I imagine there is a flag or something that I can use to be sure I don't overrun or underrun the buffer.  So, if I am using 48000 samples per second I want to generate the next sample and write it 1/48000th of a second after the last sample was written.  Suggestions appreciated, as well as references to good ALSA docs.</p>\n"}, {"tags": ["c", "synchronization", "fork", "semaphore", "shared-memory"], "answers": [{"comments": [{"owner": {"reputation": 150, "user_id": 5856953, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a0a9fd2eb205f3728b6cebbf1a6fa68c?s=128&d=identicon&r=PG&f=1", "display_name": "M.Taki_Eddine", "link": "https://stackoverflow.com/users/5856953/m-taki-eddine"}, "edited": false, "score": 0, "creation_date": 1514367645, "post_id": 47988047, "comment_id": 82947898, "body": "Yes ipcrm -a does the job, I shoud&#39;v a least  used IPC_EXCL to prevent this problem from happening or free the semaphore and the shared memory for a correct code! Thank you"}], "tags": [], "owner": {"reputation": 26, "user_id": 7993944, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rJVWD2k4VDY/AAAAAAAAAAI/AAAAAAAAAAs/ZY1istaoBV0/photo.jpg?sz=128", "display_name": "Haadj", "link": "https://stackoverflow.com/users/7993944/haadj"}, "is_accepted": true, "score": 1, "last_activity_date": 1514361689, "last_edit_date": 1514361689, "creation_date": 1514359405, "answer_id": 47988047, "question_id": 47984534, "link": "https://stackoverflow.com/questions/47984534/inconsistency-when-using-sysv-semaphores/47988047#47988047", "title": "Inconsistency when using SysV semaphores", "body": "<p>I tried executing your code, it is printing 50000 as expected. \nTry to use ftok with the key to generate a non-redundant key between two different shared memories. </p>\n\n<pre><code>key_t key = ftok(FileName, AnyChar); // The program must have the right to access the file.\n</code></pre>\n\n<p>If you get these values when executing multiple times your executable, it's certainly because you didn't use ipcrm -a. This command will delete all new ipcs that your program creates. </p>\n"}], "owner": {"reputation": 150, "user_id": 5856953, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a0a9fd2eb205f3728b6cebbf1a6fa68c?s=128&d=identicon&r=PG&f=1", "display_name": "M.Taki_Eddine", "link": "https://stackoverflow.com/users/5856953/m-taki-eddine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 221, "favorite_count": 1, "accepted_answer_id": 47988047, "answer_count": 1, "score": 1, "last_activity_date": 1514361689, "creation_date": 1514328681, "question_id": 47984534, "link": "https://stackoverflow.com/questions/47984534/inconsistency-when-using-sysv-semaphores", "title": "Inconsistency when using SysV semaphores", "body": "<p>I'm trying to apply my theoretical knowledge of semaphores using SysV semaphores and shared memory APIs.</p>\n\n<p>Well briefly, I'm sharing an <code>int</code>-sized memory (which is guarded by a semaphore) between 50 processes, each one increments it 1000 times, so ultimately i must have a final value of <code>1000 * 50 = 50000</code> but weirdly I'm having values like : 49962, 49965, 49366...</p>\n\n<p>Here is my c code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/ipc.h&gt;\n#include &lt;sys/wait.h&gt;\n#include &lt;sys/ipc.h&gt;\n#include &lt;sys/shm.h&gt;\n#include &lt;sys/sem.h&gt;\n#define SHMSZ sizeof(int) /* Size of an integer*/\n\nint main(){\n    key_t key = 241096; /* Hard-coded key */\n    int shm_id, sem_id, *shm;\n    struct sembuf psem = {0, -1, 0};\n    struct sembuf vsem = {0, 1, 0};\n\n    if((shm_id = shmget(key, SHMSZ, IPC_CREAT | 0666)) == -1){\n        printf(\"Err shmget\");\n        exit(1);\n    }\n\n    if((shm = shmat(shm_id, NULL, 0)) == (int *) -1){\n        printf(\"Err shmat\");\n    }\n\n    *shm = 0; /*Initilize the shared memory*/\n\n    if((sem_id = semget(key, 1, IPC_CREAT | 0666)) == -1){\n        printf(\"Err semget prg\");\n        exit(1);\n    }\n\n    /***Semaphore initialization****/\n    semop(sem_id, &amp;vsem, 1); /*set sem_value to 1*/\n    /**********************************/\n\n    int i;\n    for (i = 0; i &lt; 50; i++){\n        pid_t pid = fork();\n        if (pid == 0){\n            int j;\n            for (j = 0; j &lt; 1000; j++){\n                semop(sem_id, &amp;psem, 1); /*wait for the semaphore*/\n                *shm = *shm + 1;\n                semop(sem_id, &amp;vsem, 1); /* signal the semaphore*/\n            }\n            return 0; /*Whene done incrementing, return */\n        }\n    }\n    while((wait(NULL) != -1)); /*Wait for all children to terminate*/\n    printf(\"--%i--\", *shm); /*Print the final value of the shared  memory*/\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "rest", "raspbian", "coap", "libcoap"], "comments": [{"owner": {"reputation": 5010, "user_id": 3150445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bfca2588483eadf6695a120cbcef1f8?s=128&d=identicon&r=PG&f=1", "display_name": "jwdonahue", "link": "https://stackoverflow.com/users/3150445/jwdonahue"}, "edited": false, "score": 0, "creation_date": 1514328942, "post_id": 47984333, "comment_id": 82938045, "body": "What version of libcoap are you using?"}, {"owner": {"reputation": 14339, "user_id": 1466970, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/V1J6z.jpg?s=128&g=1", "display_name": "Richard Chambers", "link": "https://stackoverflow.com/users/1466970/richard-chambers"}, "reply_to_user": {"reputation": 5010, "user_id": 3150445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bfca2588483eadf6695a120cbcef1f8?s=128&d=identicon&r=PG&f=1", "display_name": "jwdonahue", "link": "https://stackoverflow.com/users/3150445/jwdonahue"}, "edited": false, "score": 0, "creation_date": 1514333302, "post_id": 47984333, "comment_id": 82938837, "body": "@jwdonahue I believe it is 1.0.x, I installed it with <code>apt-get</code> using <code>sudo apt-get install libcoap-1-0-dev</code>. I do not have access to the Pi at the moment. What difference does that make?"}, {"owner": {"reputation": 14339, "user_id": 1466970, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/V1J6z.jpg?s=128&g=1", "display_name": "Richard Chambers", "link": "https://stackoverflow.com/users/1466970/richard-chambers"}, "reply_to_user": {"reputation": 5010, "user_id": 3150445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bfca2588483eadf6695a120cbcef1f8?s=128&d=identicon&r=PG&f=1", "display_name": "jwdonahue", "link": "https://stackoverflow.com/users/3150445/jwdonahue"}, "edited": false, "score": 0, "creation_date": 1514334036, "post_id": 47984333, "comment_id": 82938976, "body": "I found this, <a href=\"https://github.com/obgm/libcoap/blob/develop/examples/contiki/server.c\" rel=\"nofollow noreferrer\">github.com/obgm/libcoap/blob/develop/examples/contiki/server&zwnj;&#8203;.c</a> at line 131 using <code>coap_check_option()</code> in a decision <code>if (request != NULL &amp;&amp; (option = coap_check_option(request, COAP_OPTION_URI_QUERY, &amp;opt_iter)) &amp;&amp; memcmp(COAP_OPT_VALUE(option), &quot;ticks&quot;, min(5, COAP_OPT_LENGTH(option))) == 0) {</code>"}, {"owner": {"reputation": 5010, "user_id": 3150445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bfca2588483eadf6695a120cbcef1f8?s=128&d=identicon&r=PG&f=1", "display_name": "jwdonahue", "link": "https://stackoverflow.com/users/3150445/jwdonahue"}, "edited": false, "score": 0, "creation_date": 1514336361, "post_id": 47984333, "comment_id": 82939374, "body": "Well that&#39;s the develop branch, and you are think you have 1.0.x, so it may or may not be relevant.  Anyway, what point are you trying to make with that?"}, {"owner": {"reputation": 5010, "user_id": 3150445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bfca2588483eadf6695a120cbcef1f8?s=128&d=identicon&r=PG&f=1", "display_name": "jwdonahue", "link": "https://stackoverflow.com/users/3150445/jwdonahue"}, "edited": false, "score": 0, "creation_date": 1514347349, "post_id": 47984333, "comment_id": 82941226, "body": "Of course! Now I see it.  Well good luck.  I only poked my nose in to see if I could learn something and IETF-RFC-7252 looks like it was worth the effort.  Thanks!"}, {"owner": {"reputation": 14339, "user_id": 1466970, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/V1J6z.jpg?s=128&g=1", "display_name": "Richard Chambers", "link": "https://stackoverflow.com/users/1466970/richard-chambers"}, "reply_to_user": {"reputation": 5010, "user_id": 3150445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bfca2588483eadf6695a120cbcef1f8?s=128&d=identicon&r=PG&f=1", "display_name": "jwdonahue", "link": "https://stackoverflow.com/users/3150445/jwdonahue"}, "edited": false, "score": 0, "creation_date": 1514652519, "post_id": 47984333, "comment_id": 83041793, "body": "@jwdonahue just a note to say I have a solution with sample programs in my github repository if you are interested."}, {"owner": {"reputation": 5010, "user_id": 3150445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bfca2588483eadf6695a120cbcef1f8?s=128&d=identicon&r=PG&f=1", "display_name": "jwdonahue", "link": "https://stackoverflow.com/users/3150445/jwdonahue"}, "edited": false, "score": 0, "creation_date": 1514658988, "post_id": 47984333, "comment_id": 83043647, "body": "where would that be?"}, {"owner": {"reputation": 14339, "user_id": 1466970, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/V1J6z.jpg?s=128&g=1", "display_name": "Richard Chambers", "link": "https://stackoverflow.com/users/1466970/richard-chambers"}, "reply_to_user": {"reputation": 5010, "user_id": 3150445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bfca2588483eadf6695a120cbcef1f8?s=128&d=identicon&r=PG&f=1", "display_name": "jwdonahue", "link": "https://stackoverflow.com/users/3150445/jwdonahue"}, "edited": false, "score": 0, "creation_date": 1514675615, "post_id": 47984333, "comment_id": 83047670, "body": "@jwdonahue in the answer I posted the link. <a href=\"https://github.com/RichardChambers/raspberrypi/tree/master/coap\" rel=\"nofollow noreferrer\">github.com/RichardChambers/raspberrypi/tree/master/coap</a>  which should be the CoAP sample program that is part of my Raspberry Pi experiments, I plan to take the test program I did for MQTT and do something similar with CoAP in which a sensing device sends data to a server where it is stored in an SQLite database and available for retrieval."}], "answers": [{"tags": [], "owner": {"reputation": 14339, "user_id": 1466970, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/V1J6z.jpg?s=128&g=1", "display_name": "Richard Chambers", "link": "https://stackoverflow.com/users/1466970/richard-chambers"}, "is_accepted": true, "score": 2, "last_activity_date": 1514515734, "creation_date": 1514515734, "answer_id": 48016807, "question_id": 47984333, "link": "https://stackoverflow.com/questions/47984333/in-libcoap-coap-server-get-response-handler-how-to-access-query-additions-to-uri/48016807#48016807", "title": "In libcoap coap server GET response handler how to access query additions to URI?", "body": "<p>The <code>libcoap</code> functions for creating a server and a client require a few more steps as part of formatting and retrieving the URI and the URI query information into/from a CoAP request.</p>\n\n<p>The complete sample applications, client.c and server.c, are in my GitHub repository at <a href=\"https://github.com/RichardChambers/raspberrypi/tree/master/coap\" rel=\"nofollow noreferrer\">https://github.com/RichardChambers/raspberrypi/tree/master/coap</a> .</p>\n\n<p>On the server side the message handler will use an option iterator, a <code>coap_opt_iterator_t</code> struct object, to iterate over the options of the <code>coap_pdu_t</code> struct request object. While iterating, the server will be looking for options of type <code>COAP_OPTION_URI_QUERY</code> which will contain a query argument, usually a keyword equal value pair.</p>\n\n<p>So the function <code>hello_handler()</code> of the posted question could be rewritten with a helper function to obtain the list of URI query items as follows:</p>\n\n<pre><code>/*\n * The following helper function, printQueryOption(), is used to\n * iterate over the list of options looking for query type options\n * to the base URI. This is analogous to a web URL that contains\n * a question mark followed by options such as:\n *    http://www.server.com/hello?type=1,id=2345\n *\n * We will return a value of 1 (true) if we found something or a value\n * of 0 (false) if we do not.\n*/\nstatic int\nprintQueryOption (coap_pdu_t *request, coap_opt_iterator_t * popt_iter )\n{\n        int  iRet = 0;\n        coap_opt_t *option;\n\n        // iterate over the options looking for queries. If we find one\n        // then print it and return a value of 1, true, to indicate we\n        // found one. If we don't find any then return the default value\n        // of 0, false.\n        while (option = coap_option_next(popt_iter)) {\n                // found an option, is it a query option or not.\n                if (popt_iter-&gt;type != COAP_OPTION_URI_QUERY) continue;\n                // it is a query option so print out the query text.\n                char xBuff[128] = {0};\n                strncpy (xBuff, COAP_OPT_VALUE(option), COAP_OPT_LENGTH(option));\n                printf (\"    option  len %d\\n         %s \\n\", COAP_OPT_LENGTH(option), xBuff);\n\n                // indicate that we found a query option.\n                iRet = 1;\n                break;\n        }\n\n        return iRet;\n}\n\n/*\n * The resource handler which the libcoap library will invoke when the registered\n * URI is specified. This is a simple request handler which will just display some\n * of the information from the request.\n */\nstatic void\nhello_handler(coap_context_t *ctx, struct coap_resource_t *resource,\n              const coap_endpoint_t *local_interface, coap_address_t *peer,\n              coap_pdu_t *request, str *token, coap_pdu_t *response)\n{\n        static  int iCount = 0;   // a simple count to provide some kind of response data.\n        unsigned char buf[3];\n        const char* response_data     = \"{\\\"device\\\": \\\"DEV-01-123\\\", \\\"item\\\" : %d }\";\n        char response_buf[256] = {0};\n\n        // generate a response to this request. we have a hard coded JSON text that\n        // we are using as a stub for testing.\n        response-&gt;hdr-&gt;code           = COAP_RESPONSE_CODE(205);\n        coap_add_option(response, COAP_OPTION_CONTENT_TYPE, coap_encode_var_bytes(buf, COAP_MEDIATYPE_TEXT_PLAIN), buf);\n\n        sprintf (response_buf, response_data, iCount);\n        coap_add_data  (response, strlen(response_buf), (unsigned char *)response_buf);\n        iCount++;    // this count is some type of varying data so that we can see things are working.\n\n        if (request != NULL) {\n                // there is a request URI so lets print out the base URI and then\n                // iterate over the options looking for the Query type options.\n                coap_opt_iterator_t  opt_iter;\n\n                printf (\" request %s\\n\", resource-&gt;uri.s);\n                coap_option_iterator_init (request, &amp;opt_iter, COAP_OPT_ALL);\n\n                // iterate over the options of the request printing out any\n                // query text that may exist.\n                while (printQueryOption (request, &amp;opt_iter));\n        } else {\n                printf (\" request - NONE\\n\");\n        }\n}\n</code></pre>\n\n<p>On the client side we would build our request adding the queries we want to include in the request with a series of calls of function <code>coap_add_option()</code> as in:</p>\n\n<pre><code>coap_split_uri(server_uri, strlen(server_uri), &amp;uri);\nrequest            = coap_new_pdu();\nrequest-&gt;hdr-&gt;type = COAP_MESSAGE_CON;\nrequest-&gt;hdr-&gt;id   = coap_new_message_id(ctx);\nrequest-&gt;hdr-&gt;code = get_method;\n\nprintf (\" Request URI: path %d %s\\n\", uri.path.length, uri.path.s);\n\ncoap_add_option(request, COAP_OPTION_URI_PATH, uri.path.length, uri.path.s);\nsprintf (server_query, \"item=%d\", iItem);\ncoap_add_option(request, COAP_OPTION_URI_QUERY, strlen(server_query), server_query);\nprintf (\"         Query: len %d %s\\n\", strlen(server_query), server_query);\nsprintf (server_query, \"device=%s\", aszDevName);\ncoap_add_option(request, COAP_OPTION_URI_QUERY, strlen(server_query), server_query);\nprintf (\"         Query: len %d %s\\n\", strlen(server_query), server_query);\nsprintf (server_query, \"tempo=%s\", aszTempoName);\ncoap_add_option(request, COAP_OPTION_URI_QUERY, strlen(server_query), server_query);\nprintf (\"         Query: len %d %s\\n\", strlen(server_query), server_query);\n</code></pre>\n\n<p>These statements create a CoAP request to a particular URI with a set of arguments or query options so that the server's handler of the URI can provide a specific response back to the request. For this example the variables used are hard coded with values like the following:</p>\n\n<pre><code>char *aszDevName = \"DEV-01-203\";\nchar *aszTempoName = \"TEMPO-12345\";\nint  iItem = 5;\n\nconst char*       server_uri = \"coap://127.0.0.1/hello\";\n</code></pre>\n\n<p>The two sample programs can be run in two separate terminal windows, starting the server first. Trying the client three times, the first with a URI of \"hello\", the second with a URI of \"goodbye\", and the third time again with a URI of \"hello\" we see the following output.</p>\n\n<p>From the server:</p>\n\n<pre><code>pi@raspberrypi:~/Documents/raspberrypi/coap $ ./server\n request hello\n    option  len 6\n         item=5 \n    option  len 17\n         device=DEV-01-203 \n    option  len 17\n         tempo=TEMPO-12345 \n request hello\n    option  len 6\n         item=5 \n    option  len 17\n         device=DEV-01-203 \n    option  len 17\n         tempo=TEMPO-12345 \n</code></pre>\n\n<p>From the terminal window of the client:</p>\n\n<pre><code>pi@raspberrypi:~/Documents/raspberrypi/coap $ ./client\n Request URI: path 5 hello\n         Query: len 6 item=5\n         Query: len 17 device=DEV-01-203\n         Query: len 17 tempo=TEMPO-12345\nReceived: {\"device\": \"DEV-01-123\", \"item\" : 0 } -&gt; item = 0\npi@raspberrypi:~/Documents/raspberrypi/coap $ ./client goodbye\n Request URI: path 7 goodbye\n         Query: len 6 item=5\n         Query: len 17 device=DEV-01-203\n         Query: len 17 tempo=TEMPO-12345\n\nCOAP_RESPONSE_CLASS() unknown.\npi@raspberrypi:~/Documents/raspberrypi/coap $ ./client\n Request URI: path 5 hello\n         Query: len 6 item=5\n         Query: len 17 device=DEV-01-203\n         Query: len 17 tempo=TEMPO-12345\nReceived: {\"device\": \"DEV-01-123\", \"item\" : 1 } -&gt; item = 1\npi@raspberrypi:~/Documents/raspberrypi/coap $ \n</code></pre>\n"}], "owner": {"reputation": 14339, "user_id": 1466970, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/V1J6z.jpg?s=128&g=1", "display_name": "Richard Chambers", "link": "https://stackoverflow.com/users/1466970/richard-chambers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1309, "favorite_count": 1, "accepted_answer_id": 48016807, "answer_count": 1, "score": 1, "last_activity_date": 1514515734, "creation_date": 1514327051, "question_id": 47984333, "link": "https://stackoverflow.com/questions/47984333/in-libcoap-coap-server-get-response-handler-how-to-access-query-additions-to-uri", "title": "In libcoap coap server GET response handler how to access query additions to URI?", "body": "<p>I am working with the <code>libcoap-dev-1</code> library under Raspbian with a Raspberry Pi using the library with a simple client and simple server to implement the CoAP protocol. I have a working client and a working server and am now trying to modify the server so that it can accept a URI with a query string and I can then fetch the query string of the URI.</p>\n\n<p>The URI I am currently testing is <code>coap://127.0.0.1/hello?item=1</code> which has a query parameter, the <code>item=1</code> after the <code>?</code>.</p>\n\n<p>The request handler in the server is the following function which is a stub to test out sending a canned response back to the client as JSON text. This works fine and the client receives the JSON text and is able to use the Fast JSON library to parse it.</p>\n\n<pre><code>// header for the libcoap library. it should be in /usr/include/coap\n#include &lt;coap/coap.h&gt;\n\n/*\n * The resource handler which the libcoap library will invoke when the registered\n * URI is specified.\n */\nstatic void\nhello_handler(coap_context_t *ctx, struct coap_resource_t *resource,\n              const coap_endpoint_t *local_interface, coap_address_t *peer,\n              coap_pdu_t *request, str *token, coap_pdu_t *response)\n{\n        static  int iCount = 0;\n        unsigned char buf[3];\n        const char* response_data     = \"{\\\"device\\\": \\\"DEV-01-123\\\", \\\"item\\\" : %d }\";\n        char response_buf[256] = {0};\n\n        response-&gt;hdr-&gt;code           = COAP_RESPONSE_CODE(205);\n        coap_add_option(response, COAP_OPTION_CONTENT_TYPE, coap_encode_var_bytes(buf, COAP_MEDIATYPE_TEXT_PLAIN), buf);\n\n        sprintf (response_buf, response_data, iCount);\n        coap_add_data  (response, strlen(response_buf), (unsigned char *)response_buf);\n        iCount++;\n\n        printf (\" request %s\\n\", resource-&gt;uri.s);\n}\n</code></pre>\n\n<p>The <code>printf()</code> at the end of the function prints the URI without the query portion. So what is printed is <code>hello</code> and not <code>hello?item=1</code>.</p>\n\n<p>My question is how can I access the query portion of the URI the client is sending?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 40613, "user_id": 4099593, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zweIW.png?s=128&g=1", "display_name": "Bhargav Rao", "link": "https://stackoverflow.com/users/4099593/bhargav-rao"}, "edited": false, "score": 0, "creation_date": 1514338939, "post_id": 47984207, "comment_id": 82939755, "body": "Comments are not for extended discussion; this conversation has been <a href=\"http://chat.stackoverflow.com/rooms/162006/discussion-on-question-by-s-younas-need-to-call-function-defined-in-c-to-to-ano\">moved to chat</a>."}], "answers": [{"comments": [{"owner": {"reputation": 5010, "user_id": 3150445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bfca2588483eadf6695a120cbcef1f8?s=128&d=identicon&r=PG&f=1", "display_name": "jwdonahue", "link": "https://stackoverflow.com/users/3150445/jwdonahue"}, "edited": false, "score": 0, "creation_date": 1514431153, "post_id": 47985851, "comment_id": 82970857, "body": "On most modern compilers <code>#pragma once</code> is a sufficient include guard."}], "tags": [], "owner": {"reputation": 2737, "user_id": 913182, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/H12RK.jpg?s=128&g=1", "display_name": "Tanner Babcock", "link": "https://stackoverflow.com/users/913182/tanner-babcock"}, "is_accepted": false, "score": 0, "last_activity_date": 1514344018, "creation_date": 1514344018, "answer_id": 47985851, "question_id": 47984207, "link": "https://stackoverflow.com/questions/47984207/need-to-call-function-defined-in-c-to-to-another-c-file/47985851#47985851", "title": "Need to call function defined in .c to to another .c file", "body": "<p>How are you linking together your <code>ContactsHelpers.c</code>, <code>Contacts.c</code>, and your <code>main.c</code> ? Are you using Make with GCC, or some other compiler?</p>\n\n<p>Whatever you do, <strong>don't</strong> <code>#include</code> another .c file. This will cause your compiler to compile recursively and try to compile the same code twice. Something else about your code that jumped out at me: No header guards. You are at risk of including the same information twice, breaking your program and causing errors. Wrap these lines around your header files.</p>\n\n<pre><code>#ifndef CONTACTS_H\n#define CONTACTS_H\n\n// content of contacts.h here...\n\n#endif\n</code></pre>\n\n<p>And then for <code>contactHelpers.h</code>:</p>\n\n<pre><code>#ifndef CONTACTHELPERS_H\n#define CONTACTHELPERS_H\n\n// content of contactHelpers.h here...\n\n#endif\n</code></pre>\n\n<p>If you're using Make to compile this, you will want your Makefile to be something like this. This is written with the assumption that <code>main()</code> is in <code>main.c</code>:</p>\n\n<pre><code>ContactsHelpers.o:\n    gcc -o ContactsHelpers.o ContactsHelpers.c\n\nContacts.o:\n    gcc -o Contacts.o Contacts.c\n\nmain.o:\n    gcc -o main.o main.c\n\nall:\n    gcc -o Contacts ContactsHelpers.o Contacts.o main.o\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8821734, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/29781cacc6e091c9ad075917b47315a9?s=128&d=identicon&r=PG&f=1", "display_name": "s.younas", "link": "https://stackoverflow.com/users/8821734/s-younas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 548, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1514344018, "creation_date": 1514326029, "last_edit_date": 1514332446, "question_id": 47984207, "link": "https://stackoverflow.com/questions/47984207/need-to-call-function-defined-in-c-to-to-another-c-file", "title": "Need to call function defined in .c to to another .c file", "body": "<p>/****contacts.h***/</p>\n\n<pre><code>struct Name {\n    char firstName[31];\n    char middleInitial[7];\n    char lastName[36];\n};\n\n\n\nstruct Address {\n    char street[41];\n    int streetNumber;\n    int apartmentNumber;\n    char postalCode[8];\n    char city[41];\n};\n\nstruct Numbers {\n\n    char cell[10];\n    char home[10];\n    char business[10];\n};\n\n\nstruct Contact {\n\n    struct Name name;\n    struct Address address;\n    struct Numbers number;\n};\n\nvoid getName(struct Name *name);\n\nvoid getAddress(struct Address *address);\n\nvoid getNumbers(struct Numbers *number);\n\nvoid getContact(struct Contact *contact);\n</code></pre>\n\n<p>/****Contacts.c****/</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include \"contacts.h\"\n#include \"contactHelpers.h\"\nvoid getName(struct Name *name)\n{\n        printf(\"Please enter the contact's first name: \");\n        scanf(\" %30[^\\n]s\",name-&gt;firstName);\n        clearKeyboard();\n\n        printf(\"Do you want to enter a middle initial(s)? (y or n): \");\n        if(yes())\n        {\n                printf(\"Please enter the contact's middle initial(s): \");\n                scanf(\" %6[^\\n]s\",name-&gt;middleInitial);\n                clearKeyboard();\n        }\n        else\n        name-&gt;middleInitial[0]='\\0';\n\n        printf(\"Please enter the contact's last name: \");\n        scanf(\" %35[^\\n]s\",name-&gt;lastName);\n        clearKeyboard();\n}\n\n\nvoid getAddress(struct Address *address)\n{\n        printf(\"Please enter the contact's street number: \");\n        address-&gt;streetNumber=getInt();\n\n        printf(\"Please enter the contact's street name: \");\n        scanf(\" %40[^\\n]s\",address-&gt;street);\n        clearKeyboard();\n\n        printf(\"Do you want to enter an apartment number? (y or n): \");\n        if(yes())\n        {\n                printf(\"Please enter the contact's apartment number: \");\n                address-&gt;apartmentNumber=getInt();\n        }\n        else\n        address-&gt;apartmentNumber='\\0';\n\n        printf(\"Please enter the contact's postal code: \");\n        scanf(\" %7[^\\n]s\",address-&gt;postalCode);\n        clearKeyboard();\n\n        printf(\"Please enter the contact's city: \");\n        scanf(\" %40[^\\n]s\",address-&gt;city);\n        clearKeyboard();\n}\n\n\nvoid getNumbers(struct Numbers *numbers)\n{\n        printf(\"Please enter the contact's cell phone number: \");\n        getTenDigitPhone(numbers-&gt;cell);\n\n        printf(\"Do you want to enter a home phone number? (y or n): \");\n        if(yes())\n        {\n                printf(\"Please enter the contact's home phone number: \");\n               getTenDigitPhone(numbers-&gt;home);\n        }\n        else\n        numbers-&gt;home[0]='\\0';\n\n        printf(\"Do you want to enter a business phone number? (y or n): \");\n        if(yes())\n        {\n                printf(\"Please enter the contact's business phone number: \");\n               getTenDigitPhone(numbers-&gt;business);\n        }\n        else\n        numbers-&gt;business[0]='\\0';\n}\n\n    void getContact(struct Contact *contact)\n\n{\n\n  getName(&amp;(contact-&gt;name));    \n  getAddress(&amp;(contact-&gt;address));\n\n getNumbers(&amp;(contact-&gt;number));\n}\n</code></pre>\n\n<p>/****contactHelpers.h*****/</p>\n\n<pre><code>#include\"contacts.h\"\nvoid clearKeyboard(void);\nvoid pause(void);\nint getInt(void);\nint getIntInRange(int, int);\nint yes(void);\nint menu(void); \nvoid ContactManagerSystem(void);\nvoid getTenDigitPhone(char[11]);\nint findContactIndex(const struct Contact contacts[], int size, const char cellNum[]);\nvoid displayContactHeader(void);\nvoid displayContactFooter(int);\nvoid displayContact(const struct Contact* contacts);\nvoid displayContacts(const struct Contact[], int);\nvoid searchContacts(const struct Contact[], int);\nvoid addContact(struct Contact[], int);\nvoid updateContact(struct Contact[], int);\nvoid deleteContact(struct Contact[], int);\nvoid sortContacts(struct Contact[], int);\n</code></pre>\n\n<p>/****ContactsHelpers.c****/</p>\n\n<pre><code>#define _CRT_SECURE_NO_WARNINGS\n\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include \"contactHelpers.h\"\n#define MAXCONTACTS 5\nint a=5;\n\n\nvoid clearKeyboard(void)\n{\n    while (getchar() != '\\n')   ; \n}\n\nvoid pause(void)\n{\n\n\n    char ch;\n\n        printf(\"(Press Enter to continue)\");\n\n        scanf(\"%c\", &amp;ch);\n\n            if(ch==10)\n            {\n                clearKeyboard();\n            }\n\n\n\n\n}\n\n\nint getInt(void)\n\n{\n    int i;\n    char cha;\n    printf(\"&lt;Please enter an integer&gt;: \");\n    scanf(\"%d%c\", &amp;i,&amp;cha);\n\n        while (cha !='\\n')\n        {\n            clearKeyboard();\n            printf(\"*** INVALID INTEGER *** &lt;Please enter an integer&gt;: \");\n            scanf(\"%d%c\", &amp;i,&amp;cha);\n        }\n\n\n    return i;\n\n}\nint getIntInRange(int min, int max)\n\n\n{\n\n    int i;\n    i=getInt();\n    while(i&lt; min || i &gt; max)\n    {\n        printf(\"*** OUT OF RANGE *** &lt;Enter a number between %d and %d&gt;: \", min , max);\n        scanf(\"%d\", &amp;i);\n    }\n\n\n}\n\n\n\n\nint yes(void)\n{\n\n    char a,b;\n    printf(\"&lt;Please enter a character&gt;: \");\n    scanf(\"%c%c\", &amp;a,&amp;b);\n\n     while ((a !='Y' &amp;&amp; a !='y' &amp;&amp; a !='N' &amp;&amp; a!='n') || (b!='\\n'))\n    { \n       if (b!='\\n') ungetc(b, stdin),scanf(\"%*[^\\n]%c\", &amp;b);\n        a='n',b='\\n';\n\n\n            printf(\"*** INVALID ENTRY *** &lt;Only (Y)es or (N)o are acceptable&gt;: \");\n            scanf(\"%c%c\", &amp;a,&amp;b);\n\n        }\n        if (a =='Y' || a=='y')\n        {\n            return 1;\n            printf(\"Contact Management System: terminated\\n\");\n\n\n        }\n        else \n        {\n            if (a =='N' || a=='n')\n            {\n                return 0;\n            }\n\n        }\n\n}\n\n\n\nint menu(void)\n\n{\n\n    int i;\n    printf(\"Contact Management System\\n-------------------------\\n1. Display contacts\\n2. Add a contact\\n3. Update a contact\\n4. Delete a contact\\n5. Search contacts by cell phone number\\n6. Sort contacts by cell phone number\\n0. Exit\\n\\nSelect an option:&gt; \");\n    scanf(\"%d\", &amp;i);\n    while (i&lt;0 || i&gt;6)\n    {\n        printf(\"*** OUT OF RANGE *** &lt;Enter a number between 0 and 6&gt;: \");\n        scanf(\"%d\", &amp;i);\n    }\n    return i;\n}\n\nvoid ContactManagerSystem(void)\n\n{\n    struct Contact contacts[a];\n    int i=menu();\n    int choice, exit =0;\n    do\n    {\n\n    i = menu();\n    switch(i)\n    {\n      case 0 :\n        printf(\"Exit the program? (Y)es/(N)o: \");\n        choice=yes();\n        printf(\"\\n\");\n        if(choice == 1)\n        {\n            printf(\"Contact Management System: terminated\\n\");\n            exit = 1;\n        }\n        if (choice == 0)\n        {\n            break;\n        }\n\n      case 1 :\n         printf(\"\\n\");\n         displayContacts(contacts, a);\n         pause();\n         printf(\"\\n\");\n         break;\n      case 2 :\n         printf(\"\\n\");\n         addContact(contacts,a);\n         pause();\n         printf(\"\\n\");\n         break;\n      case 3 :\n         printf(\"\\n\");\n         updateContact(contacts,a);\n         pause();\n         printf(\"\\n\");\n         break;\n      case 4 :\n         printf(\"\\n\");\n         deleteContact(contacts,a);\n         pause();\n         printf(\"\\n\");\n         break;\n      case 5 :\n        printf(\"\\n\");\n         searchContacts(contacts,a);\n         pause();\n         printf(\"\\n\");\n         break;\n      case 6 :\n         printf(\"\\n\");\n         sortContacts(contacts,a);\n         pause();\n         printf(\"\\n\");\n         break;\n\n    }\n }\n    while (exit == 0);\n\n}\n\nvoid getTenDigitPhone(char telNum[11])\n{\n    int needInput = 1;\n\n    while (needInput == 1) {\n        scanf(\"%10s\", telNum);\n        clearKeyboard();\n        if (strlen(telNum) == 10)\n            needInput = 0;\n        else\n            printf(\"Enter a 10-digit phone number: \");\n    }\n}\n\n\nint findContactIndex(const struct Contact contacts[], int size, const char cellNum[])\n{\n    int i;\n    for( i=0; i&lt;=size; i++)\n    {\n        if( strcmp(contacts[i].number.cell, cellNum)==0)\n\n        {\n            return i;\n        }\n    }\n        return -1;\n\n}\n\n\nvoid displayContactHeader(void)\n{\n    printf(\"+-----------------------------------------------------------------------------+\\n\");\n    printf(\"|                              Contacts Listing                            |\\n\");\n    printf(\"+-----------------------------------------------------------------------------+ \\n\");\n\n}\n\n\n\nvoid displayContactFooter(int total)\n{\n    printf(\"+-----------------------------------------------------------------------------+\\n\");\n    printf(\"Total contacts: %d\\n\\n\", total);\n}\n\n\n\nvoid displayContact(const struct Contact* contacts)\n{\n     if(strcmp((*contacts).name.middleInitial,\"\")==0)\n           printf(\" %s %s\\n\",(*contacts).name.firstName,(*contacts).name.lastName);\n        else\n           printf(\" %s %s %s\\n\",(*contacts).name.firstName,(*contacts).name.middleInitial,(*contacts).name.lastName);\n\n        printf(\"    C: %-10s   H: %-10s   B: %-10s\\n\",(*contacts).number.cell,(*contacts).number.home,(*contacts).number.business);\n\n        if((*contacts).address.apartmentNumber&gt;0)\n        printf(\"       %d %s, Apt# %d, %s, %s\\n\",(*contacts).address.streetNumber,(*contacts).address.street,(*contacts).address.apartmentNumber,(*contacts).address.city,(*contacts).address.postalCode);\n        else\n        printf(\"       %d %s, %s, %s\\n\",(*contacts).address.streetNumber,(*contacts).address.street,(*contacts).address.city,(*contacts).address.postalCode);\n}\n\n\nvoid displayContacts(const struct Contact contacts [], int size)\n{\n    int i, tot=0;\n    displayContactHeader();\n    for(i=0;i&lt;size;i++)\n        {\n                if(strlen(contacts[i].number.cell)&gt;0)\n                {\n                        tot=tot+1;\n                        displayContact(&amp;contacts[i]);\n                }\n        }\n        displayContactFooter(tot);\n}\n\nvoid searchContacts(const struct Contact contacts[], int size)\n{\n    char num[11];\n    int result;\n    printf(\"Enter the cell number for the contact: \");\n    getTenDigitPhone(num);\n     result = findContactIndex(contacts,size, num);\n\n        if(result== -1)\n        {\n                printf(\"\\n\");\n                displayContact(&amp;contacts[result]);\n                printf(\"\\n\");\n        }\n        else\n                printf(\"*** Contact NOT FOUND ***\\n\");\n\n\n}\n\n\nvoid addContact(struct Contact contacts [], int size)\n{\n\n        int i, available=-1;\n        for(i=0;i&lt;size;i++)\n        {\n                if(strlen(contacts[i].number.cell)==0)\n                {\n                        available=i;\n                        break;\n                }\n        }\n        if(available&gt;-1)\n        {\n                getContact(&amp;contacts[available]);\n                printf(\"--- New contact added! ---\\n\");\n        }\n        else\n        {\n                printf(\"*** ERROR: The contact list is full! ***\");\n                printf(\"\\n\");\n        }\n}\n\nvoid updateContact(struct Contact contacts[], int size)\n{\n       char myNum[11];\n        int myIndex;\n        printf(\"Enter the cell number for the contact: \");\n        getTenDigitPhone(myNum);\n        myIndex = findContactIndex(contacts,size,myNum);\n\n        if(myIndex&gt;-1)\n        {\n                printf(\"\\nContact found:\\n\");\n                displayContact(&amp;contacts[myIndex]);\n\n                printf(\"\\nDo you want to update the name? (y or n): \");\n                if(yes())\n                getName(&amp;contacts[myIndex].name);\n\n                printf(\"Do you want to update the address? (y or n): \");\n                if(yes())\n                getAddress(&amp;contacts[myIndex].address);\n\n                printf(\"Do you want to update the numbers? (y or n): \");\n                if(yes())\n                getNumbers(&amp;contacts[myIndex].number);\n\n                printf(\"--- Contact Updated! ---\\n\");\n        }\n        else\n        printf(\"*** Contact NOT FOUND ***\\n\");\n}\n\nvoid deleteContact(struct Contact contacts [], int size)\n{\n    char num[11];\n    char c;\n    printf(\"Enter the cell number for the contact: \");\n    scanf(\"%s%c\", num), &amp;c;\n    getTenDigitPhone(num);\n\n    int b = findContactIndex(contacts, size ,num);\n    if(b == -1)\n    {\n        printf(\"*** Contact NOT FOUND ***\\n\");\n    }\n    else\n    {\n        printf(\"\\nContact found:\\n\");\n        displayContact(&amp;contacts[b]);\n        printf(\"CONFIRM: Delete this contact? (y or n): \");\n        int c = yes();\n        if( c == 1)\n        {\n            contacts[b].number.cell[0]='\\0';\n        }   printf(\"--- Contact deleted! ---\\n\");\n\n\n    }\n\n}\n\nvoid sortContacts(struct Contact contacts[], int a)\n{\n\n\n    int i, j;\n    struct Contact temp;\n\n    for (i = 0; i &lt; a - 1; i++)\n    {\n        for (j = 0; j &lt; (a - 1-i); j++)\n        {\n            if (contacts[j].number.cell &lt; contacts[j + 1].number.cell)\n            {\n                temp = contacts[j];\n                contacts[j] = contacts[j + 1];\n                contacts[j + 1] = temp;\n            } \n        }\n    }\n}\n</code></pre>\n\n<p>/****MAIN****/</p>\n\n<pre><code>int main(void)\n{\n    ContactManagerSystem();\n\n    return 0;\n}\n</code></pre>\n\n<p>So in my code I have two .c files. In contacts.c I have defined a function getContact and I am using it in ContactHelpers.c. Although I am including a header file(that incldes the prototype of getcontact) in contactHelpers.c but it gives ma an error undefined reference to `getContact(Contact*)' . if I include contacts.c in contactHelpers.c it never stops compiling. please help me out </p>\n"}, {"tags": ["c", "structure", "scanf", "fgetc"], "answers": [{"comments": [{"owner": {"reputation": 93, "user_id": 9142951, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1dcc29f1cb510c7b1d310eed47d7f618?s=128&d=identicon&r=PG&f=1", "display_name": "Real", "link": "https://stackoverflow.com/users/9142951/real"}, "edited": false, "score": 0, "creation_date": 1514327914, "post_id": 47984329, "comment_id": 82937824, "body": "wow, cheers, it works wonders! I completely forgot about sscanf because we didn&#39;t use it much in our course yet. Thanks a lot for the time you put in to answer my problem! Have a happy new year!"}], "tags": [], "owner": {"reputation": 6975, "user_id": 3121023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f52448806175b9aa66c86d40cf0829f1?s=128&d=identicon&r=PG&f=1", "display_name": "user3121023", "link": "https://stackoverflow.com/users/3121023/user3121023"}, "is_accepted": true, "score": 1, "last_activity_date": 1514327025, "creation_date": 1514327025, "answer_id": 47984329, "question_id": 47984059, "link": "https://stackoverflow.com/questions/47984059/issue-with-reading-a-file-and-saving-values-on-structure/47984329#47984329", "title": "Issue with reading a file and saving values on structure", "body": "<p>Use <code>fgets</code> to read each line from the file. Then you can check for a dot or use <code>strncmp</code> or <code>strcmp</code> to test for specific values. If the value is not detected, parse the line using <code>sscanf</code>.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n\ntypedef struct\n{\n    char type, name, noMaior, noMenor;\n    int value;\n}line;\n\nint main(void)\n{\n    line ramo[10];\n    FILE *ficheiro;\n    int i = 0, j;\n    char titulo[200];\n    char input[200];\n\n    if ((ficheiro = fopen(\"circuit.txt\", \"r\")) == NULL)\n        printf(\"Error opening file!\");\n\n    fgets(titulo, sizeof titulo, ficheiro);\n    printf(\"%s\", titulo);\n\n    while ( fgets ( input, sizeof input, ficheiro)) \n    {\n        if ( '.' == input[0]) {//test for a dot at start of line\n            break;\n        }\n        else {\n            if (( 5 == sscanf(input, \"%c%c %c %c %d\"\n            , &amp;ramo[i].type, &amp;ramo[i].name, &amp;ramo[i].noMaior, &amp;ramo[i].noMenor, &amp;ramo[i].value))) {\n                i++;\n            }\n        }\n    }\n    fclose(ficheiro);\n\n    for (j = 0; j &lt; i; j++)\n        printf(\"%c%c %c %c %d\\n\", ramo[j].type, ramo[j].name, ramo[j].noMaior, ramo[j].noMenor, ramo[j].value);\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 93, "user_id": 9142951, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1dcc29f1cb510c7b1d310eed47d7f618?s=128&d=identicon&r=PG&f=1", "display_name": "Real", "link": "https://stackoverflow.com/users/9142951/real"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 47984329, "answer_count": 1, "score": 2, "last_activity_date": 1514327025, "creation_date": 1514325071, "last_edit_date": 1514325397, "question_id": 47984059, "link": "https://stackoverflow.com/questions/47984059/issue-with-reading-a-file-and-saving-values-on-structure", "title": "Issue with reading a file and saving values on structure", "body": "<p>This is part of a project that i'm doing. Essentially i want to read a text file called \"Circuit\" that has this inside:</p>\n\n<p>Circuit title example</p>\n\n<p>V1 1 0 24</p>\n\n<p>V2 3 0 15</p>\n\n<p>R1 1 2 10000</p>\n\n<p>R2 2 3 8100</p>\n\n<p>R3 2 0 4700</p>\n\n<p>To give you some context, the values represent a circuit like this:\n<a href=\"https://i.stack.imgur.com/MUGM8.png\" rel=\"nofollow noreferrer\">Circuit example</a>\nI made a code to save all these values in a structure and printed them out to see if they were being saved correctly.</p>\n\n<pre><code>    #include &lt;stdio.h&gt;\n    #include &lt;string.h&gt;\n    #include &lt;stdlib.h&gt;\n\n    typedef struct\n    {\nchar type, name, noMaior, noMenor;\nint value;\n    }line;\n\n    int main(void)\n    {\nline ramo[10];\nFILE *ficheiro;\nint i = 0, j;\nchar titulo[200];\n\nif ((ficheiro = fopen(\"circuit.txt\", \"r\")) == NULL)\n    printf(\"Error opening file!\");\n\nfgets(titulo, 199, ficheiro);\n    printf(\"%s\", titulo);\n\nwhile ((fscanf(ficheiro, \"%c%c %c %c %d\\n\", &amp;ramo[i].type, &amp;ramo[i].name, &amp;ramo[i].noMaior, &amp;ramo[i].noMenor, &amp;ramo[i].value)) != EOF) \n    {\n        i++;\n        //if (fgetc(ficheiro)=='.')\n        //  break;  \n    }\n    fclose(ficheiro);\n\nfor (j = 0; j &lt; i; j++)\n    printf(\"%c%c %c %c %d\\n\", ramo[j].type, ramo[j].name, ramo[j].noMaior, ramo[j].noMenor, ramo[j].value);\n\nreturn 0;\n</code></pre>\n\n<p>}</p>\n\n<p>It outputs the same text that is in the file, which is what i intended. Now here comes the tricky part, we have to put \".end\" or \".END\" in the end of our file, so i made those two commented lines to scan the file for a dot and stop reading it if it encounters one but it causes me some problems when saving the values to the structure. This is what i get as an output:</p>\n\n<p>Circuit title example</p>\n\n<p>V1 1 0 24</p>\n\n<p>2 3 0 15</p>\n\n<p>1 1 2 10000</p>\n\n<p>2 2 3 8100</p>\n\n<p>3 2 0 4700</p>\n\n<p>The \"break\" works as intended, because if i put a dot in the middle of the file it will stop reading whatever comes after but sadly it is ignoring the first letter and according to the debug tool it is saving a ' ' (a space) in the place of the letters (ramo[].type). I tried to learn as much as i could about the behaviours of fscanf and fgetc but i can't draw any conclusion as to why this is happening.</p>\n\n<p>PS: tried to translate some of the variables to make it easier to read but some are still in portuguese, like \"ficheiro\"=file. Also take it easy on me folks, i just started learning coding!</p>\n"}, {"tags": ["c", "openssl", "cryptography", "sha", "sha512"], "comments": [{"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 1, "creation_date": 1514323443, "post_id": 47983721, "comment_id": 82936639, "body": "Also see Kelsey&#39;s talks on truncation hashes. Their is no reduction in proof that the truncated hash from SHA-1 and SHA-2 family have the same security as the full size hash. <a href=\"https://csrc.nist.gov/CSRC/media/Events/First-Cryptographic-Hash-Workshop/documents/Kelsey_Truncation.pdf\" rel=\"nofollow noreferrer\">Cryptographic Hash Workshop (2005) - Truncation Mode for SHA</a>."}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1514323922, "post_id": 47983721, "comment_id": 82936773, "body": "<i><code>return md</code></i> will probably break since the hash will likely have an embedded NULL. Or it won&#39;t have a NULL where you expect. Do you realize it is a binary string and not an ASCIIZ string? Also see <a href=\"https://stackoverflow.com/q/7853156/608639\">Calculate and print SHA256 hash of a file using OpenSSL</a>, <a href=\"https://stackoverflow.com/q/36381509/608639\">How to print SHA512 hash in C</a>, <a href=\"https://stackoverflow.com/q/918676/608639\">Generate SHA hash in C++ using OpenSSL library</a> (and friends)."}, {"owner": {"reputation": 903, "user_id": 2086073, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9be0cae032f465d2e76987ba73e9df2d?s=128&d=identicon&r=PG", "display_name": "Umayr", "link": "https://stackoverflow.com/users/2086073/umayr"}, "reply_to_user": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1514360864, "post_id": 47983721, "comment_id": 82945218, "body": "@jww That was something I came up with over the top of my head, I don&#39;t expect it to run the way its written. I was trying to achieve something like <a href=\"https://play.golang.org/p/qjLvPiRsj1e\" rel=\"nofollow noreferrer\">this</a> in C using OpenSSL. I couldn&#39;t find anything in APIs whatsoever. Is there a way I could do that even manually in C?"}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1514709599, "post_id": 47983721, "comment_id": 83052575, "body": "<i>&quot;Is there a way I could do that even manually in C&quot;</i> - Do what? OpenSSL has SHA-1 through SHA-512. The linked questions show you how to do it."}], "answers": [{"tags": [], "owner": {"reputation": 181, "user_id": 636980, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c9fa259bfadab25155a6dc49c2a3ef1?s=128&d=identicon&r=PG", "display_name": "wvh", "link": "https://stackoverflow.com/users/636980/wvh"}, "is_accepted": false, "score": 0, "last_activity_date": 1522840047, "creation_date": 1522840047, "answer_id": 49649446, "question_id": 47983721, "link": "https://stackoverflow.com/questions/47983721/how-to-calculate-sha512-224-and-sha512-256-hashes-using-openssl/49649446#49649446", "title": "How to calculate SHA512/224 and SHA512/256 hashes using OpenSSL?", "body": "<p>As you noticed, those truncated sha512 hashes use different initalisation vectors, probably to avoid giving away part of the actual sha512 hash if they would just literally truncate those bytes.</p>\n\n<p>Support for sha512_256 has been implemented in the OpenSSL master tree a few months ago and will likely be in OpenSSL 1.1.1.</p>\n\n<p>Check the changelog:\n<a href=\"https://www.openssl.org/news/changelog.txt\" rel=\"nofollow noreferrer\">https://www.openssl.org/news/changelog.txt</a></p>\n\n<p>Or the commit on Github:\n<a href=\"https://github.com/openssl/openssl/commit/4bed94f0c11ef63587c6b2edb03c3c438e221604\" rel=\"nofollow noreferrer\">https://github.com/openssl/openssl/commit/4bed94f0c11ef63587c6b2edb03c3c438e221604</a></p>\n\n<p>... so depending on the platform you're on, you could use those new functions in the near future just like you are doing with the sha512 example you provided.</p>\n"}], "owner": {"reputation": 903, "user_id": 2086073, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9be0cae032f465d2e76987ba73e9df2d?s=128&d=identicon&r=PG", "display_name": "Umayr", "link": "https://stackoverflow.com/users/2086073/umayr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2132, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1522840047, "creation_date": 1514322509, "question_id": 47983721, "link": "https://stackoverflow.com/questions/47983721/how-to-calculate-sha512-224-and-sha512-256-hashes-using-openssl", "title": "How to calculate SHA512/224 and SHA512/256 hashes using OpenSSL?", "body": "<p>Here's how I calculate a SHA512 hash in C.</p>\n\n<pre><code>#include &lt;openssl/sha.h&gt;\n#include &lt;stdio.h&gt;\n\nchar *calc_sha512(char *data) {\n    SHA512_CTX ctx;\n    char *md = malloc(sizeof(char)*(SHA512_DIGEST_LENGTH+1));\n\n    SHA512_Init(&amp;ctx);\n    SHA512_Update(&amp;ctx, data, strlen(data));\n    SHA512_Final(md, &amp;ctx);\n    md[SHA512_DIGEST_LENGTH] = '\\0';\n\n    return md;\n}\n\nint main() {\n    printf(\"%s\\n\", calc_sha512(\"foo\"));\n\n    return 1;\n}\n</code></pre>\n\n<p>Now when I try to transform it to 512/<em>t</em> (either 512/224 or 512/256), it doesn't work. I initially thought that for calculating a 512/t hash, you'd simply have to truncate the output to <em>t</em> bits, but upon further reading, it doesn't only truncate the output, it also have different initial constant values. So I'm trying to figure out any function in OpenSSL that supports that? So far I have looked into docs and header files, I can't find such method under either SHA or EVP. Does OpenSSL even support SHA512/<em>t</em> hashing algorithms? Does it provide the functionality out of the box? Any pointers to that would be helpful.</p>\n"}, {"tags": ["c", "multidimensional-array", "memmove"], "comments": [{"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1514324966, "post_id": 47983705, "comment_id": 82937062, "body": "You need to post a <a href=\"https://stackoverflow.com/help/mcve\">minimal, complete, and verifiable example</a> see we can see what you&#39;re working with. There are many ways that you could implement <code>vector</code>."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1514327189, "post_id": 47983705, "comment_id": 82937678, "body": "If it&#39;s dynamically-allocated, the first dimension should be an array of pointers. Why don&#39;t just just shift those pointers, instead of moving all the data?"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 9142855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12bd98520612a696d0e8aa1aee47a6f7?s=128&d=identicon&r=PG&f=1", "display_name": "Schueni1", "link": "https://stackoverflow.com/users/9142855/schueni1"}, "edited": false, "score": 0, "creation_date": 1514323678, "post_id": 47983766, "comment_id": 82936704, "body": "This creates the same result as the memmove in my question"}, {"owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "reply_to_user": {"reputation": 13, "user_id": 9142855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12bd98520612a696d0e8aa1aee47a6f7?s=128&d=identicon&r=PG&f=1", "display_name": "Schueni1", "link": "https://stackoverflow.com/users/9142855/schueni1"}, "edited": false, "score": 0, "creation_date": 1514323882, "post_id": 47983766, "comment_id": 82936760, "body": "@Schueni1.: This is the way to do. Provide more context."}], "tags": [], "owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "is_accepted": false, "score": 1, "last_activity_date": 1514324042, "last_edit_date": 1514324042, "creation_date": 1514322860, "answer_id": 47983766, "question_id": 47983705, "link": "https://stackoverflow.com/questions/47983705/shift-elements-by-one-index-with-memmove/47983766#47983766", "title": "Shift elements by one index with memmove", "body": "<p>Simply doing this would work (Illustrating in a 3d array)</p>\n\n<pre><code>memmove(arr[1], arr[0], Y*Z*sizeof(int));\n</code></pre>\n\n<p>where <code>Y</code> and <code>Z</code> denotes the other 2 dimensions of the 2d array.</p>\n\n<p>Here <code>arr[X][Y][Z]</code> is the <code>int</code> array where <code>X&gt;=2</code>.</p>\n\n<p>In case of dynamically allocated memory you need to do each continuous chunk one by one. Then it would work. </p>\n"}, {"tags": [], "owner": {"reputation": 4590, "user_id": 2879325, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2503121b7e7487cd870c8afe40f0cf21?s=128&d=identicon&r=PG", "display_name": "Ext3h", "link": "https://stackoverflow.com/users/2879325/ext3h"}, "is_accepted": false, "score": 1, "last_activity_date": 1514323680, "creation_date": 1514323680, "answer_id": 47983876, "question_id": 47983705, "link": "https://stackoverflow.com/questions/47983705/shift-elements-by-one-index-with-memmove/47983876#47983876", "title": "Shift elements by one index with memmove", "body": "<p>Compile with a higher optimization level (<code>-O3</code>). Obtain a direct reference on <code>vector-&gt;arr</code> instead of forcing dereferencing on every single array access.</p>\n\n<p>Your call to <code>memmove</code> looks half correct under the assumption that you allocated <code>arr</code> as continuous memory. However, since you said \"dynamic\", I very much doubt that. Plus the size calculation appears very much wrong, with the <code>sizeof(int*)</code>.</p>\n\n<p>I suppose <code>arr</code> is not <code>int arr[constexpr][constexpr][constexpr]</code> (single, continuous allocation), but rather <code>int ***arr</code>.</p>\n\n<p>In which case the <code>memmove</code> goes horribly wrong. After moving the <code>int**</code> contents of the <code>arr</code> field by one (which actually already did the move), it caused a nasty overflow on the heap, most likely by chance hitting also a majority of the <code>int*</code> allocations following.</p>\n\n<p>Looks like a double move, and leaves behind a completely destroyed heap.</p>\n"}, {"tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": true, "score": 2, "last_activity_date": 1514327783, "creation_date": 1514327783, "answer_id": 47984432, "question_id": 47983705, "link": "https://stackoverflow.com/questions/47983705/shift-elements-by-one-index-with-memmove/47984432#47984432", "title": "Shift elements by one index with memmove", "body": "<p>When you create a dynamic multi-dimensional array like this, the array contents are not contiguous -- each row is a separate allocation. So you can't move it all with a single <code>memmov()</code>.</p>\n\n<p>But you don't need to copy all the data, just shift the pointers in the top-level array.</p>\n\n<pre><code>int **temp = arr[l-1]; // save last pointer, which will be overwritten\nmemmov(&amp;arr[1], &amp;arr[0], sizeof(*arr[1]));\narr[0] = temp;\n</code></pre>\n\n<p>I've shifted the last element around to the first, to avoid having two elements that point to the same data. You could also free the old last element (including freeing the arrays it points to) and create a new first element, but this was simpler.</p>\n"}], "owner": {"reputation": 13, "user_id": 9142855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12bd98520612a696d0e8aa1aee47a6f7?s=128&d=identicon&r=PG&f=1", "display_name": "Schueni1", "link": "https://stackoverflow.com/users/9142855/schueni1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1465, "favorite_count": 0, "accepted_answer_id": 47984432, "answer_count": 3, "score": 1, "last_activity_date": 1514327783, "creation_date": 1514322419, "last_edit_date": 1514327744, "question_id": 47983705, "link": "https://stackoverflow.com/questions/47983705/shift-elements-by-one-index-with-memmove", "title": "Shift elements by one index with memmove", "body": "<p>I am trying to shift the elements in a dynamically created 3d array by one index, so that each element <code>[i][j][k]</code> should be on <code>[i+1][j][k]</code>.</p>\n\n<p>This is how my array creation looks like</p>\n\n<pre><code>typedef struct stencil{\nint ***arr;\nint l;\nint m;\nint n;}matrix;\n\nvoid createMatrix(matrix *vector){\n\nvector-&gt;arr = (int***) malloc(sizeof(int**) * (vector-&gt;l+2));\nfor (int i = 0; i&lt; vector-&gt;l+2; ++i) {\n    vector-&gt;arr[i] = (int**) malloc(sizeof(int*) * (vector-&gt;m+2));\n    for (int j = 0; j &lt; vector-&gt;m+2; ++j) {\n        vector-&gt;arr[i][j] = (int*) calloc((vector-&gt;n+2),sizeof(int));\n    }\n\n}\n}\n</code></pre>\n\n<p>This is basically what I want to achieve with memmove</p>\n\n<pre><code>for(int i = vector-&gt;l-1; i &gt;= 0; --i){\n    for(int j = vector-&gt;m; j &gt;= 0; --j){\n        for(int k = vector-&gt;n; k &gt;= 0; --k){\n            vector-&gt;arr[i+1][j][k] = vector-&gt;arr[i][j][k];\n        }\n    }\n}\n</code></pre>\n\n<p>for some reason memmove shifts 2 indices.</p>\n\n<pre><code>memmove(&amp;(vector-&gt;arr[1][1][1]), &amp;(vector-&gt;arr[0][1][1]), (vector-&gt;l+2)*(vector-&gt;m+2)*(vector-&gt;n)*sizeof(int*));\n</code></pre>\n\n<p>Could anyone give me a hint?</p>\n"}, {"tags": ["c", "linux", "makefile", "include", "c-preprocessor"], "comments": [{"owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "edited": false, "score": 0, "creation_date": 1514319962, "post_id": 47983356, "comment_id": 82935514, "body": "Have you tried <code>#include &quot;addFunc.h&quot;</code>?"}, {"owner": {"reputation": 8884, "user_id": 8372104, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/72UbV.png?s=128&g=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/8372104/simon"}, "edited": false, "score": 0, "creation_date": 1514320899, "post_id": 47983356, "comment_id": 82935774, "body": "You need to format your code"}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 3, "creation_date": 1514321978, "post_id": 47983356, "comment_id": 82936165, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/7581408/including-a-header-file-from-another-directory\">Including a header file from another directory</a>"}], "answers": [{"comments": [{"owner": {"reputation": 69991, "user_id": 939557, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/3VPea.png?s=128&g=1", "display_name": "MadScientist", "link": "https://stackoverflow.com/users/939557/madscientist"}, "edited": false, "score": 0, "creation_date": 1514320337, "post_id": 47983401, "comment_id": 82935614, "body": "They are using <code>&amp;</code> with <code>scanf</code>.  That&#39;s necessary."}, {"owner": {"reputation": 23, "user_id": 8724687, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VWINb.jpg?s=128&g=1", "display_name": "SRa", "link": "https://stackoverflow.com/users/8724687/sra"}, "edited": false, "score": 0, "creation_date": 1514320363, "post_id": 47983401, "comment_id": 82935619, "body": "now i get as error <code>mainProg.c:3:11: error: expected \u2018=\u2019, \u2018,\u2019, \u2018;\u2019, \u2018asm\u2019 or \u2018__attribute__\u2019 before \u2018{\u2019 token  int main(){            ^ mainProg.c:9:1: error: expected \u2018{\u2019 at end of input  } </code>"}, {"owner": {"reputation": 69991, "user_id": 939557, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/3VPea.png?s=128&g=1", "display_name": "MadScientist", "link": "https://stackoverflow.com/users/939557/madscientist"}, "reply_to_user": {"reputation": 23, "user_id": 8724687, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VWINb.jpg?s=128&g=1", "display_name": "SRa", "link": "https://stackoverflow.com/users/8724687/sra"}, "edited": false, "score": 0, "creation_date": 1514320441, "post_id": 47983401, "comment_id": 82935642, "body": "@SRa That&#39;s because you&#39;re missing a semicolon in your header file, I think."}, {"owner": {"reputation": 8884, "user_id": 8372104, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/72UbV.png?s=128&g=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/8372104/simon"}, "reply_to_user": {"reputation": 23, "user_id": 8724687, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VWINb.jpg?s=128&g=1", "display_name": "SRa", "link": "https://stackoverflow.com/users/8724687/sra"}, "edited": false, "score": 0, "creation_date": 1514320490, "post_id": 47983401, "comment_id": 82935663, "body": "@SRa  Yes you never closed the main function.  Add a <code>}</code> at the next line of <code>return 0;</code>"}, {"owner": {"reputation": 69991, "user_id": 939557, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/3VPea.png?s=128&g=1", "display_name": "MadScientist", "link": "https://stackoverflow.com/users/939557/madscientist"}, "edited": false, "score": 0, "creation_date": 1514320543, "post_id": 47983401, "comment_id": 82935673, "body": "I guess I was wrong when I thought you just had mistyped your examples due to all the syntax errors... you actually do have all those syntax errors in your code!!"}, {"owner": {"reputation": 8884, "user_id": 8372104, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/72UbV.png?s=128&g=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/8372104/simon"}, "reply_to_user": {"reputation": 69991, "user_id": 939557, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/3VPea.png?s=128&g=1", "display_name": "MadScientist", "link": "https://stackoverflow.com/users/939557/madscientist"}, "edited": false, "score": 0, "creation_date": 1514320608, "post_id": 47983401, "comment_id": 82935686, "body": "@MadScientist  This is confusing are you talking to me or SRa?"}, {"owner": {"reputation": 69991, "user_id": 939557, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/3VPea.png?s=128&g=1", "display_name": "MadScientist", "link": "https://stackoverflow.com/users/939557/madscientist"}, "reply_to_user": {"reputation": 23, "user_id": 8724687, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VWINb.jpg?s=128&g=1", "display_name": "SRa", "link": "https://stackoverflow.com/users/8724687/sra"}, "edited": false, "score": 0, "creation_date": 1514321117, "post_id": 47983401, "comment_id": 82935859, "body": "I&#39;m talking to @SRa"}, {"owner": {"reputation": 69991, "user_id": 939557, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/3VPea.png?s=128&g=1", "display_name": "MadScientist", "link": "https://stackoverflow.com/users/939557/madscientist"}, "reply_to_user": {"reputation": 23, "user_id": 8724687, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VWINb.jpg?s=128&g=1", "display_name": "SRa", "link": "https://stackoverflow.com/users/8724687/sra"}, "edited": false, "score": 0, "creation_date": 1514321596, "post_id": 47983401, "comment_id": 82936031, "body": "@SRa as I said in a comment above, the problem is not the missing close brace (although that is also a problem and does need to be fixed), the error messages you are reporting in your comment above are caused by not having a semicolon after the function declaration in your header file <code>addFunc.h</code>."}, {"owner": {"reputation": 69991, "user_id": 939557, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/3VPea.png?s=128&g=1", "display_name": "MadScientist", "link": "https://stackoverflow.com/users/939557/madscientist"}, "reply_to_user": {"reputation": 23, "user_id": 8724687, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VWINb.jpg?s=128&g=1", "display_name": "SRa", "link": "https://stackoverflow.com/users/8724687/sra"}, "edited": false, "score": 1, "creation_date": 1514322105, "post_id": 47983401, "comment_id": 82936216, "body": "@SRa I just created a short example locally by cutting and pasting your code above and (a) adding the missing close brace and (b) adding the missing semicolon, and the <code>mainProg.c</code> file compiled fine.  So, you must have done something wrong when you fixed it.  You should update your question, or probably ask a new question, with the current version of the code cut/pasted in."}, {"owner": {"reputation": 69991, "user_id": 939557, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/3VPea.png?s=128&g=1", "display_name": "MadScientist", "link": "https://stackoverflow.com/users/939557/madscientist"}, "reply_to_user": {"reputation": 23, "user_id": 8724687, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VWINb.jpg?s=128&g=1", "display_name": "SRa", "link": "https://stackoverflow.com/users/8724687/sra"}, "edited": false, "score": 1, "creation_date": 1514322565, "post_id": 47983401, "comment_id": 82936371, "body": "@SRa there is still no semicolon at the end of the function declaration in the <code>addFunc.h</code> file, which is what I said the problem was.  Until you add that semicolon you will always get compiler errors.  Also, it&#39;s always a bad idea to include hardcoded paths in your <code>#include</code> directives: if you ever move the code or change the directory name it won&#39;t compile anymore."}], "tags": [], "owner": {"reputation": 8884, "user_id": 8372104, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/72UbV.png?s=128&g=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/8372104/simon"}, "is_accepted": false, "score": 0, "last_activity_date": 1514321997, "last_edit_date": 1514321997, "creation_date": 1514320063, "answer_id": 47983401, "question_id": 47983356, "link": "https://stackoverflow.com/questions/47983356/fatal-error-addfunc-h-no-such-file-or-directory/47983401#47983401", "title": "fatal error: addFunc.h: No such file or directory", "body": "<p>It seems the problem you are getting is occurring because you are using <code>#include &lt;addFunc.h&gt;</code>.  You would use <code>&lt;&gt;</code> when you are using a system header file.  From your makefile it seems you are not.  </p>\n\n<p>The <code>#include</code> statement is a little different when you use header files of your own program because it searches in the dictionary your .c file is located. </p>\n\n<p>Using <code>#include \"addFunc.h\"</code> should do the trick.</p>\n\n<p>For more info on the <code>#include</code> directive <a href=\"https://gcc.gnu.org/onlinedocs/gcc-2.95.3/cpp_1.html\" rel=\"nofollow noreferrer\">see this page</a></p>\n"}, {"comments": [{"owner": {"reputation": 69991, "user_id": 939557, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/3VPea.png?s=128&g=1", "display_name": "MadScientist", "link": "https://stackoverflow.com/users/939557/madscientist"}, "reply_to_user": {"reputation": 23, "user_id": 8724687, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VWINb.jpg?s=128&g=1", "display_name": "SRa", "link": "https://stackoverflow.com/users/8724687/sra"}, "edited": false, "score": 0, "creation_date": 1514321217, "post_id": 47983414, "comment_id": 82935895, "body": "I didn&#39;t say add <code>-I</code> I said add <code>-I.</code> (note the period here: a period means &quot;current directory&quot;, just like <code>..</code> (two periods) means the parent directory, etc."}], "tags": [], "owner": {"reputation": 69991, "user_id": 939557, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/3VPea.png?s=128&g=1", "display_name": "MadScientist", "link": "https://stackoverflow.com/users/939557/madscientist"}, "is_accepted": true, "score": 1, "last_activity_date": 1514320131, "creation_date": 1514320131, "answer_id": 47983414, "question_id": 47983356, "link": "https://stackoverflow.com/questions/47983356/fatal-error-addfunc-h-no-such-file-or-directory/47983414#47983414", "title": "fatal error: addFunc.h: No such file or directory", "body": "<p>You really should be cutting and pasting, because clearly the text you've pasted here is nothing like what you're actually using (you have tons of syntax errors here).</p>\n\n<p>However, the problem is that the compiler can't find your header file.  This can be solved in one (or both) of two ways:</p>\n\n<p>First, you should use the <code>#include &lt;...&gt;</code> form only for system headers like <code>stdio.h</code> etc.  For your personal headers, you should use the form <code>#include \"...\"</code> instead.  The difference is implementation-specific but for most compilers it is that include files using <code>&lt;...&gt;</code> are never looked for in the current directory but only in system directories and directories given with <code>-I</code>, while include file using <code>\"...\"</code> are looked for also in the current directory.</p>\n\n<p>You could also simply ask the compiler to always look in the current directory by adding the <code>-I.</code> option to your compile line in your makefile.</p>\n"}], "owner": {"reputation": 23, "user_id": 8724687, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VWINb.jpg?s=128&g=1", "display_name": "SRa", "link": "https://stackoverflow.com/users/8724687/sra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2736, "favorite_count": 0, "accepted_answer_id": 47983414, "answer_count": 2, "score": 0, "last_activity_date": 1514323476, "creation_date": 1514319605, "last_edit_date": 1514323476, "question_id": 47983356, "link": "https://stackoverflow.com/questions/47983356/fatal-error-addfunc-h-no-such-file-or-directory", "title": "fatal error: addFunc.h: No such file or directory", "body": "<p>i have created a Makefile to run C program in shell script.but i get as error <code>fatal error: addFunc.h: No such file or directory</code> in <code>mainProg.c</code> page and <code>addFunc.c</code> page.i tried my best to solve this problem.but i didn't get a solution.i have mentioned my code below.</p>\n\n<p>mainProg.c</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include \"/home/name/Desktop/add/addFunc.h\"\nint main(){\nint a,b;\nprintf(\"Enter two numbers\\n\");\nscanf(\"%d%d\",&amp;a,&amp;b);\nprintf(\"sum:%d\\n\",add(a,b));\nreturn 0;\n}\n</code></pre>\n\n<p>addFunc.h</p>\n\n<pre><code>int add(int a, int b)\n</code></pre>\n\n<p>addFunc.c</p>\n\n<pre><code>#include \"/home/name/Desktop/add/addFunc.h\"\nint add(int a,int b){\nreturn (a+b);\n}\n</code></pre>\n\n<p>Makefile</p>\n\n<pre><code>Add: mainProg.c addFunc.c\n    gcc -o Add mainProg.c addFunc.c -I.\n</code></pre>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1514317736, "post_id": 47982892, "comment_id": 82934747, "body": "Both answers have been downvoted. I&#39;m guessing (with no real evidence) that it was done by the same person Would the downvoter care to explain?"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 2, "creation_date": 1514317783, "post_id": 47982892, "comment_id": 82934759, "body": "I disagree with the close vote. This is not a simple typographical error, it appears to be a misunderstanding about how strings work in C."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1514318040, "post_id": 47982892, "comment_id": 82934841, "body": "I am upvoting the question because it was well presented."}], "answers": [{"comments": [{"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 1, "creation_date": 1514318764, "post_id": 47982946, "comment_id": 82935122, "body": "The Grinch must have been browsing this question spreading DVs."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1514319422, "post_id": 47982946, "comment_id": 82935324, "body": "I didn&#39;t downvote, but the one by Keith is much better, for obvious reasons."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1514319631, "post_id": 47982946, "comment_id": 82935408, "body": "@AnttiHaapala I already acknowledged that, which you would have seen if you read the comments. This answer was converted from a comment that had several ticks. After that, the better answer came, and was improved. I wasn&#39;t prepared to have a race. You didn&#39;t downvote, thank you, but your comment was an unnecessary put-down. Have a nice Christmas."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1514320488, "post_id": 47982946, "comment_id": 82935661, "body": "@AnttiHaapala the comment chain since deleted by various parties. You missed it."}], "tags": [], "owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "is_accepted": false, "score": 4, "last_activity_date": 1514316690, "creation_date": 1514316690, "answer_id": 47982946, "question_id": 47982892, "link": "https://stackoverflow.com/questions/47982892/c-printf-prints-two-elements-from-array-when-it-only-should-print-one/47982946#47982946", "title": "C printf prints two elements from array when it only should print one", "body": "<p>The array length is too short, \"Wednesday\" has 9 letters and needs a nul string terminator.</p>\n\n<pre><code>char show_weekdays[7][9];\n</code></pre>\n\n<p>should be</p>\n\n<pre><code>char show_weekdays[7][10];\n</code></pre>\n\n<p>The C compiler only includes that string terminator <strong>if there is room for it in the array</strong>. The compiler only complains when there is not enough room for the data.</p>\n"}, {"comments": [{"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1514332473, "post_id": 47982971, "comment_id": 82938668, "body": "Strictly speaking I don&#39;t think it has UB, because the pointer <code>show_weekdays[2]</code> decays to is also a pointer into the representation array of the whole 2d array."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1514333067, "post_id": 47982971, "comment_id": 82938786, "body": "@R..: <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"nofollow noreferrer\">N1570</a> Annex J lists circumstances that cause undefined behavior. One of them is: &quot;An array subscript is out of range, even if an object is apparently accessible with the given subscript (as in the lvalue expression <code>a[1][7]</code> given the declaration int <code>a[4][5]</code>) (6.5.6).&quot; A 2d array is an array of arrays. It&#39;s not a long array of the element type. (But the fact that the element type here is <code>char</code> might invoke some special-case rules.)"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1514340934, "post_id": 47982971, "comment_id": 82940087, "body": "Note that on a 64-bit machine, the array of pointers occupies 56 bytes and the strings occupy just under 70 bytes, vs the 2D array only needing 70 bytes.  It isn\u2019t immediately clear that the pointers are better; even in a 32-bit machine, the array of pointers requires more storage."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1514342515, "post_id": 47982971, "comment_id": 82940293, "body": "@JonathanLeffler: Depends on what you mean by &quot;better&quot;. I&#39;ll gladly pay a few extra bytes for better clarity and maintainability."}], "tags": [], "owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "is_accepted": true, "score": 6, "last_activity_date": 1514342486, "last_edit_date": 1514342486, "creation_date": 1514316852, "answer_id": 47982971, "question_id": 47982892, "link": "https://stackoverflow.com/questions/47982892/c-printf-prints-two-elements-from-array-when-it-only-should-print-one/47982971#47982971", "title": "C printf prints two elements from array when it only should print one", "body": "<p>The string <code>\"Wednesday\"</code> requires 10 characters, not 9. A string is terminated by, and includes, a closing null character <code>'\\0'</code>.</p>\n\n<p>The declaration as you have it isn't illegal (which is why you didn't get a compile-time warning or error message). As a special case, C lets you use a string literal to initialize an array of the exact length of the literal (the length is 1 less than the size). The terminating <code>'\\0'</code> won't be stored. That's fine if you don't depend on the content being a valid string, but you do. (Strictly speaking your program's behavior is undefined, but that's a subtle point that we needn't get into.)</p>\n\n<p>A better way to define <code>show_weekdays</code> is as an array of pointers, each of which points to a string:</p>\n\n<pre><code>const char *const show_weekdays[] = {\n    \"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\", \"Sunday\"\n};\n</code></pre>\n\n<p>(When I say \"better\", I mean it's less error-prone and easier to maintain. There might be some cost in extra storage to hold the pointers, but it's trivial for something this size.)</p>\n\n<p>Computers are <em>really</em> good at counting things. Let them do it for you whenever possible.</p>\n\n<p>The two <code>const</code>s ensure that you won't accidentally try to modify either the pointers or the strings they point to.</p>\n"}], "owner": {"reputation": 45, "user_id": 9142696, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bebad5329a0f4ec3fc666c943c957036?s=128&d=identicon&r=PG&f=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/9142696/simon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 239, "favorite_count": 0, "closed_date": 1514345687, "accepted_answer_id": 47982971, "answer_count": 2, "score": 1, "last_activity_date": 1514342486, "creation_date": 1514316326, "question_id": 47982892, "link": "https://stackoverflow.com/questions/47982892/c-printf-prints-two-elements-from-array-when-it-only-should-print-one", "closed_reason": "Not suitable for this site", "title": "C printf prints two elements from array when it only should print one", "body": "<p>I am new to programming and have a little problem...</p>\n\n<p>My output when running the code is a bit wrong, there should only be Wednesday on line 3 in the output. What causes this problem?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(){\n\n    enum weekdays {Monday, Tuesday, Wednesday, Thursday, Friday, Saturday, Sunday};\n    enum weekdays current_day;\n\n    float highest_temperature = 0;\n    float average_temperature = 0;\n    float current_temperature = 0;\n\n    char show_weekdays[7][9] = {\"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\", \"Sunday\"};\n\n    for(current_day = Monday; current_day &lt;= Sunday; current_day++){\n\n        printf(\"Enter temperature for %s (in Celsius): \", show_weekdays[current_day]);\n        scanf(\"%f\", &amp;current_temperature);\n\n        average_temperature += current_temperature;\n\n        if(current_temperature &gt; highest_temperature){\n\n            highest_temperature = current_temperature;\n\n        }\n\n    }\n\n    average_temperature /= 7;\n\n    printf(\"The average temperature was: %.2f Celsius\\n\", average_temperature);\n    printf(\"The highest temperature was: %.2f Celsius\\n\", highest_temperature);\n\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>Enter temperature for Monday (in Celsius): 1\nEnter temperature for Tuesday (in Celsius): 2\nEnter temperature for WednesdayThursday (in Celsius): 3\nEnter temperature for Thursday (in Celsius): 4\nEnter temperature for Friday (in Celsius): 5\nEnter temperature for Saturday (in Celsius): 6\nEnter temperature for Sunday (in Celsius): 7\nThe average temperature was: 4.00 Celsius\nThe highest temperature was: 7.00 Celsius\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 787, "user_id": 7714006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2bf23fe02b176b9ec4b72f65570e0b5?s=128&d=identicon&r=PG&f=1", "display_name": "Aditi Rawat", "link": "https://stackoverflow.com/users/7714006/aditi-rawat"}, "edited": false, "score": 0, "creation_date": 1514315353, "post_id": 47982711, "comment_id": 82933974, "body": "Hint: <code>char *array[8];</code> is <b>definitely not</b> an array of <code>char</code> type and size 8"}, {"owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "edited": false, "score": 0, "creation_date": 1514315373, "post_id": 47982711, "comment_id": 82933984, "body": "<code>Declare an array of char type with size 8</code> is <b>not</b> <code>char *array[8]</code>"}, {"owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "edited": false, "score": 4, "creation_date": 1514315624, "post_id": 47982711, "comment_id": 82934056, "body": "I am not sure if I should answer this. There are lots of problems in this code."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1514315674, "post_id": 47982711, "comment_id": 82934075, "body": "On reading the code <code>char *array[8]</code> could be correct, but not the way it is used. Function is printing an array of strings - although that too is faulty."}, {"owner": {"reputation": 17958, "user_id": 1971013, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/EtqFE.jpg?s=128&g=1", "display_name": "meaning-matters", "link": "https://stackoverflow.com/users/1971013/meaning-matters"}, "edited": false, "score": 0, "creation_date": 1514315685, "post_id": 47982711, "comment_id": 82934078, "body": "I&#39;d expect <code>i = 0; i &lt;= 7; i++</code>. Just one of the issues."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1514315981, "post_id": 47982711, "comment_id": 82934185, "body": "Enable compiler warnings: <i>&#39;scanf&#39; : format string <code>%s</code> requires an argument of type <code>char *</code>, but variadic argument 1 has type <code>char **</code></i>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1514319665, "post_id": 47982711, "comment_id": 82935420, "body": "the first problem I see is: <code>char *array[8];</code>  is declaring an array of 8 pointers to char.   However, what you really want is <code>char array[8];</code> which declares an array of 8 characters"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1514319993, "post_id": 47982711, "comment_id": 82935526, "body": "the next problem I see is the signatures for the sub functions have a parameter like this: <code>char *a[]</code>.  Remember that referencing an array name returns the address of the first byte of the array.  so the parameter is the same as: <code>char **a</code>.   Definitely not what is needed.  Suggest: <code>char a[]</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1514320369, "post_id": 47982711, "comment_id": 82935621, "body": "regarding: <code>scanf(&quot;%s&quot;,array);</code>  1) the pointers in your declared array <code>a[]</code> have not been set to point to any memory that the program owns (I.E. missing a call to <code>malloc()</code> (or similar) for each entry.  2) the problem description indicates a single string of characters, NOT a series of strings.  3) when calling any of the <code>scanf()</code> family of functions, always check the returned value ( not the parameter values) to assure the operation was successful. 4) when using the &#39;%s&#39; input/format specifier, always include a MAX Characters modifier that is 1 less than the length (cont)"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1514320586, "post_id": 47982711, "comment_id": 82935683, "body": "(cont) of the input buffer, because that format specifier always appends a NUL byte to the input.  Suggest elimination of the <code>for()</code> loop and change the call to <code>scanf()</code> to:  if( 1 != scanf( &quot;%7s&quot;, array ) ) { // handle error then: exit( EXIT_FAILURE ); }`"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1514320810, "post_id": 47982711, "comment_id": 82935744, "body": "the posted code contains some &#39;magic&#39; numbers. &#39;magic&#39; numbers are numbers with no basis.  I.E. 7.  &#39;magic&#39; numbers make the code much more difficult to understand, debug, etc.  Suggest using a <code>#define</code> statement to give the &#39;magic&#39; number a meaningful name, then using that meaningful name throughout the code."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1514321109, "post_id": 47982711, "comment_id": 82935854, "body": "in C, an array index starts at 0 and continues to (number of elements in array -1.  So this statement: <code>if(strcmp(a[j],a[j+1])&gt;0)</code> will, on the last iteration, be accessing the NUL byte at the end of the string"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1514321339, "post_id": 47982711, "comment_id": 82935938, "body": "it is a good programming practice to limit the <code>scope</code> of variables.  In the posted code, in function: <code>arr_sort()</code>, the variables i, j, and temp are visible through the whole function.  the <code>i</code> variable only needs to be visible inside the outer <code>for()</code> loop, the <code>j</code> variable only needs to be visible inside the inner <code>for()</code> loop,  the <code>temp</code> variable only needs to be visible inside the body of the <code>if()</code> code block.  Similar considerations exist for function: <code>print()</code> and the variable <code>i</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1514322619, "post_id": 47982711, "comment_id": 82936398, "body": "the question states the prototype/signature for function: <code>arr_sort()</code> is <code>void arr_sort( char * cPtr )</code>   NOT `void arr_sort( char * cPtr[] )"}], "answers": [{"tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": true, "score": 0, "last_activity_date": 1514322440, "creation_date": 1514322440, "answer_id": 47983708, "question_id": 47982711, "link": "https://stackoverflow.com/questions/47982711/develop-a-user-defined-function-to-sort-the-array-in-a-non-decreasing-order/47983708#47983708", "title": "Develop a user-defined function to sort the array in a non-decreasing order", "body": "<p>doing a quick 'google' for a bubble sort, in C, results in:</p>\n\n<pre><code>// where 'n' is the number of entries in the array\n// where 'array' is declared as 'int array[n];\nfor ( int c = 0 ; c &lt; ( n - 1 ); c++ )\n{\n    for ( int d = 0 ; d &lt; n - c - 1; d++ )\n    {\n        if ( array[d] &gt; array[d+1] ) /* For decreasing order use &lt; */\n        {\n            int temp   = array[d];\n            array[d]   = array[d+1];\n            array[d+1] = temp;\n        }\n    }\n}\n</code></pre>\n\n<p>Notice the limits on the upper bound of the index variables.</p>\n\n<p>in your program you will be using <code>char</code> rather than <code>int</code> for <code>temp</code> and for the declaration of <code>array[]</code></p>\n\n<p>notice there is no need for anything in the <code>string.h</code> header file.</p>\n\n<p>notice the limiting of the scope of the local variables <code>c</code>, <code>d</code>, and <code>temp</code></p>\n\n<p>The comments on your posted question cover the problems in the posted code, so I will not repeat all of them here.</p>\n"}, {"tags": [], "owner": {"reputation": 13, "user_id": 8910733, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155931023788942/picture?type=large", "display_name": "Trace Myers", "link": "https://stackoverflow.com/users/8910733/trace-myers"}, "is_accepted": false, "score": 0, "last_activity_date": 1514323240, "last_edit_date": 1514323240, "creation_date": 1514322909, "answer_id": 47983773, "question_id": 47982711, "link": "https://stackoverflow.com/questions/47982711/develop-a-user-defined-function-to-sort-the-array-in-a-non-decreasing-order/47983773#47983773", "title": "Develop a user-defined function to sort the array in a non-decreasing order", "body": "<pre><code>for(i=0;i&lt;7;i++) {\n  scanf(\"%s\",array);\n}\n</code></pre>\n\n<p>If you want 8 strings of length 7, you can't scanf them into the array. Your array is an array of pointers as defined here:</p>\n\n<pre><code>char *array[8];\n</code></pre>\n\n<p>Which is very different from this:</p>\n\n<pre><code>char array[8];\n</code></pre>\n\n<p>The first is an array that stores 8 pointers to strings. The second is an array that stores 8 characters. If you wanted to store a single string, you would do this:</p>\n\n<pre><code>char array[8];\nprintf(\"Please input a string with size 7: \");\nscanf(\"%s\", array);\n</code></pre>\n\n<p>Which is probably what you're used to at this point.</p>\n\n<p>So, an array of pointers is just like a list of little arrows that point to blocks of memory. Your array doesn't store any characters itself, which is why you can't scanf directly into it.</p>\n\n<pre><code>int main(void) {\n  char *arr[8];\n  char new_word[8];\n\n  for(int i = 0; i &lt; 8; i++) {\n    printf(\"Enter a new word of length 7: \");\n    scanf(\"%s\", new_word);\n    arr[i] = malloc(strlen(new_word) + 1);\n    strcpy(arr[i], new_word);\n  }\n  for(int i = 0; i &lt; 8; i++) {\n    printf(\"%s\\n\", arr[i]);\n  }\n\n  return 0;\n}\n</code></pre>\n\n<p>This program creates two arrays: a pointer array (arr) and a character array (new_word). In the loop, you ask for seven strings of length 7, which is scanf'd into the character array. New memory is set aside for that string with malloc. Then, the string is copied into the block of memory that your first array pointer points to. We increment our array index with the for loop so that now we're using the next pointer, and so on. </p>\n\n<p>It's important to use strcpy and copy the string out of the character array every time, otherwise at the end, you will just have an array of pointers pointing to a single string, new_word.</p>\n"}], "owner": {"reputation": 3, "user_id": 9142646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c84f1063bdcf9959b1b0900556e2a668?s=128&d=identicon&r=PG&f=1", "display_name": "wanwei yu", "link": "https://stackoverflow.com/users/9142646/wanwei-yu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 380, "favorite_count": 0, "accepted_answer_id": 47983708, "answer_count": 2, "score": 0, "last_activity_date": 1514323240, "creation_date": 1514315220, "last_edit_date": 1514317974, "question_id": 47982711, "link": "https://stackoverflow.com/questions/47982711/develop-a-user-defined-function-to-sort-the-array-in-a-non-decreasing-order", "title": "Develop a user-defined function to sort the array in a non-decreasing order", "body": "<p>I just learned about pointer and tried the program on the textbook,</p>\n\n<p>\"Declare an array of <code>char</code> type with size 8, ask the user to input a\nstring and then assign to the array. Develop a user-defined\nfunction to sort the array in a non-decreasing order. Print the array\nbefore and after sorting in the main function. The function\nprototype is given as\n<code>void arr_sort( char * cPtr)</code>\"</p>\n\n<p>I don't know very clear what mistake I have made.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\nvoid print(char *a[]);\nvoid arr_sort( char *a[]);\nint main()\n{\n    int i;\n    char *array[8];\n    printf(\"Please input a string with size 7:\");\n    for(i=0;i&lt;7;i++)\n    {\n     scanf(\"%s\",array);\n    }\n    printf(\"the array before sorting is\");\n    print(array);\n    arr_sort(array);\n    print(array);\n    return 0;\n}\n\nvoid arr_sort( char *a[])\n{\n    int i,j;\n    char *temp;\n    for(i=0;i&lt;7;i++)\n    {\n        for(j=0;j&lt;7;j++)\n        {\n            if(strcmp(a[j],a[j+1])&gt;0)\n            {\n                temp=a[j];\n                a[j]=a[j+1];\n                a[j+1]=temp;\n            }\n        }\n    }\n}\nvoid print(char *a[])\n{\n    int i;\n    for(i=0;i&lt;7;i++)\n    {\n        printf(\"%s \",a[i]);\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "openacc", "pgi", "pgi-accelerator"], "answers": [{"comments": [{"owner": {"reputation": 3901, "user_id": 3204484, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F7Cc9.jpg?s=128&g=1", "display_name": "Mat Colgrove", "link": "https://stackoverflow.com/users/3204484/mat-colgrove"}, "edited": false, "score": 0, "creation_date": 1514399512, "post_id": 47983849, "comment_id": 82962068, "body": "FYI, I submitted a problem report for this issue (TPR#25047).  The compiler should automatically make &quot;priv&quot; private since it&#39;s declared in the loop, but isn&#39;t in this case."}], "tags": [], "owner": {"reputation": 3901, "user_id": 3204484, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F7Cc9.jpg?s=128&g=1", "display_name": "Mat Colgrove", "link": "https://stackoverflow.com/users/3204484/mat-colgrove"}, "is_accepted": true, "score": 2, "last_activity_date": 1514323512, "creation_date": 1514323512, "answer_id": 47983849, "question_id": 47982597, "link": "https://stackoverflow.com/questions/47982597/openacc-having-a-private-array-for-every-gpu-thread/47983849#47983849", "title": "OpenACC: having a private array for every GPU thread", "body": "<p>The declaration of \"priv\" is getting hoisted out of the loop thus making it shared between the threads.  The work around is to declare \"priv\" before the loop and then use the \"private\" clause to privatize it.  You'll also want to schedule the loop as \"gang vector\" to prevent the compiler from automatically parallelizing the two inner loops.</p>\n\n<p>For example:</p>\n\n<pre><code>% cat main.c\n#include \"header.h\"\nint main(void){\nint A[N];\nint priv[K];\n#pragma acc data copy(A)\n{\n#pragma acc parallel loop gang vector private(priv)\n     for(int i=0; i&lt;N;i++){\n       int sum=0;\n       int j=0;\n       while(1){\n       if(j&gt;=K) break;\n           assign_i_to_privj(priv, j, i);\n           j++;\n       }\n       j=0;\n       while(1){\n           if(j&gt;=K) break;\n           add_privi_to_sum(priv, j, &amp;sum);\n           j++;\n       }\n       sum/=K; // now sum == i;\n       A[i]=sum;\n     }\n   }\n   //now A[i] == i\n   for(int i=0; i&lt;123; i++) printf(\"A[%d]=%d \",i, A[i]);\n   printf(\"\\n\");\n   return 0;\n}\n% pgcc f.c main.c -Minfo=acc -ta=tesla:cc60 -fast -V17.10\nf.c:\nassign_i_to_privj:\n      2, Generating acc routine seq\n         Generating Tesla code\nadd_privi_to_sum:\n      5, Generating acc routine seq\n         Generating Tesla code\nmain.c:\nmain:\n      5, Generating copy(A[:])\n      7, Accelerator kernel generated\n         Generating Tesla code\n          8, #pragma acc loop gang, vector(128) /* blockIdx.x threadIdx.x */\n         11, #pragma acc loop seq\n         17, #pragma acc loop seq\n      7, Local memory used for priv\n     11, Loop is parallelizable\n     17, Loop is parallelizable\n% a.out\nA[0]=0 A[1]=1 A[2]=2 A[3]=3 A[4]=4 A[5]=5 A[6]=6 A[7]=7 A[8]=8 A[9]=9 A[10]=10 A[11]=11 A[12]=12 A[13]=13 A[14]=14 A[15]=15 A[16]=16 A[17]=17 A[18]=18 A[19]=19 A[20]=20 A[21]=21 A[22]=22 A[23]=23 A[24]=24 A[25]=25 A[26]=26 A[27]=27 A[28]=28 A[29]=29 A[30]=30 A[31]=31 A[32]=32 A[33]=33 A[34]=34 A[35]=35 A[36]=36 A[37]=37 A[38]=38 A[39]=39 A[40]=40 A[41]=41 A[42]=42 A[43]=43 A[44]=44 A[45]=45 A[46]=46 A[47]=47 A[48]=48 A[49]=49 A[50]=50 A[51]=51 A[52]=52 A[53]=53 A[54]=54 A[55]=55 A[56]=56 A[57]=57 A[58]=58 A[59]=59 A[60]=60 A[61]=61 A[62]=62 A[63]=63 A[64]=64 A[65]=65 A[66]=66 A[67]=67 A[68]=68 A[69]=69 A[70]=70 A[71]=71 A[72]=72 A[73]=73 A[74]=74 A[75]=75 A[76]=76 A[77]=77 A[78]=78 A[79]=79 A[80]=80 A[81]=81 A[82]=82 A[83]=83 A[84]=84 A[85]=85 A[86]=86 A[87]=87 A[88]=88 A[89]=89 A[90]=90 A[91]=91 A[92]=92 A[93]=93 A[94]=94 A[95]=95 A[96]=96 A[97]=97 A[98]=98 A[99]=99 A[100]=100 A[101]=101 A[102]=102 A[103]=103 A[104]=104 A[105]=105 A[106]=106 A[107]=107 A[108]=108 A[109]=109 A[110]=110 A[111]=111 A[112]=112 A[113]=113 A[114]=114 A[115]=115 A[116]=116 A[117]=117 A[118]=118 A[119]=119 A[120]=120 A[121]=121 A[122]=122\n</code></pre>\n"}], "owner": {"reputation": 2046, "user_id": 1833218, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/cf27b83d041c02d41c0025cfc1a0bdda?s=128&d=identicon&r=PG", "display_name": "Antonio Ragagnin", "link": "https://stackoverflow.com/users/1833218/antonio-ragagnin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 701, "favorite_count": 0, "accepted_answer_id": 47983849, "answer_count": 1, "score": -1, "last_activity_date": 1514323512, "creation_date": 1514314519, "last_edit_date": 1514315304, "question_id": 47982597, "link": "https://stackoverflow.com/questions/47982597/openacc-having-a-private-array-for-every-gpu-thread", "title": "OpenACC: having a private array for every GPU thread", "body": "<p>I am bringing a code to the GPU. This code has a kernel that makes use of a private array. This means that the array is declared inside the kernel loop.</p>\n\n<p>When I port the code to OpenACC   I get buggy  results. To me, \nit looks like the array is shared between GPU vector threads and this cause several race conditions.</p>\n\n<p>I organized the following example with also external calls because that's the way my original code looks like. </p>\n\n<p>header.h:</p>\n\n<pre><code>#define N 100000\n#define K 16\n#pragma acc routine\nvoid assign_i_to_privj(int * priv, int j, int i);\n#pragma acc routinetnumpy\nvoid add_privi_to_sum(int * priv, int i, int *sum);\n</code></pre>\n\n<p>main.c:</p>\n\n<pre><code>#include \"header.h\"\nint main(void){\nint A[N];\n#pragma acc data copy(A)\n{\n#pragma acc parallel loop\n     for(int i=0; i&lt;N;i++){\n       int priv[K];\n       int sum=0;\n       int j=0;\n       while(1){\n       if(j&gt;=K) break;\n           assign_i_to_privj(priv, j, i);\n           j++;\n       }\n       j=0;\n       while(1){\n           if(j&gt;=K) break;\n           add_privi_to_sum(priv, j, &amp;sum);\n           j++;\n       }\n       sum/=K; // now sum == i;\n       A[i]=sum;\n     }\n   }\n   //now A[i] == i\n   for(int i=0; i&lt;123; i++) printf(\"A[%d]=%d \",i, A[i]);\n   printf(\"\\n\");\n   return 0;\n}\n</code></pre>\n\n<p>f.c:</p>\n\n<pre><code>#include \"header.h\"\nvoid assign_i_to_privj(int *priv, int j, int i){\n       priv[j]=i;\n}\nvoid add_privi_to_sum(int *priv, int j, int *sum){\n      (*sum)+=priv[j];\n}\n</code></pre>\n\n<p>I can see the compiler version with <code>cc -v</code> that returns <code>Export PGI=/opt/pgi/17.5.0</code>.</p>\n\n<p>To compile:</p>\n\n<pre><code>cc -g -lnvToolsExt -O2  -acc  -ta=tesla:cc60  -c11 -mp -Minfo -Mlarge_arrays -c main.c &amp;&amp;\ncc -g -lnvToolsExt -O2 -acc  -ta=tesla:cc60  -c11 -mp -Minfo -Mlarge_arrays -c f.c &amp;&amp;\ncc -g -lnvToolsExt -O2 -acc  -ta=tesla:cc60 -c11 -mp -Minfo -Mlarge_arrays f.o main.o -o acc.exe &amp;&amp;\nsrun  -n 1 acc.exe\n</code></pre>\n\n<p>The code should set all <code>A[i]</code> elements equal to <code>i</code>. When I run this code with OpenACC support, I get completely wrong results. My guess is a race condition.\nThe version without <code>openacc</code>compile and runs correctly. At the end of the run <code>A[i]==i</code></p>\n\n<p>So, <strong>my question is:</strong> how can I make a small array to be private to <em>all</em> GPU threads with OpenACC?</p>\n"}, {"tags": ["c", "function", "file", "modulo"], "comments": [{"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 7, "creation_date": 1514313430, "post_id": 47982406, "comment_id": 82933265, "body": "count the characters you read, and act appropiately."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1514313615, "post_id": 47982406, "comment_id": 82933323, "body": "Function <code>fgetc</code> returns <code>int</code> so change <code>unsigned char character_read;</code> to <code>int character_read;</code>. Then you can control the loop by checking whether the function returns <code>EOF</code>, instead of the dreadful <code>while(!feof(fileToOpen))</code>. Also the function type <code>char</code> does not match what you are returning, a pointer decayed from <code>char[]</code>, and anyway: that array goes out of scope."}, {"owner": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 0, "creation_date": 1514313797, "post_id": 47982406, "comment_id": 82933389, "body": "Calling printf before calling &#39;errorfile&#39; is very likely a mistake, since &#39;errorfile&#39; probably wants to know the value of errno as set by <code>fopen</code>, but <code>printf</code> may change it."}, {"owner": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 1, "creation_date": 1514313909, "post_id": 47982406, "comment_id": 82933441, "body": "<code>do ... while (!feof(...))</code> will lead to an infinite loop on a read error.  (You could do <code>while(!feof(...) &amp;&amp; ! ferror(...))</code>, but it&#39;s a bad idiom.  See <a href=\"https://stackoverflow.com/questions/5431941/why-is-while-feof-file-always-wrong\" title=\"why is while feof file always wrong\">stackoverflow.com/questions/5431941/&hellip;</a>"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1514314018, "post_id": 47982406, "comment_id": 82933480, "body": "@LinuxCrusher a better idiom is <code>while((character_read = fgetc(fileToOpen)) != EOF) { &#47;* do stuff *&#47; }</code> since <code>feof</code> does not do what you imagine."}, {"owner": {"reputation": 37, "user_id": 7347010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7139241e275d1331831191ef59c2a4?s=128&d=identicon&r=PG&f=1", "display_name": "Flavien Chamay", "link": "https://stackoverflow.com/users/7347010/flavien-chamay"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1514317000, "post_id": 47982406, "comment_id": 82934490, "body": "@WeatherVane I want to have a char type in character_read so why would I change to int character_read? I need to keep the char type of character_read. If I want to return character_read in my function what should I do then?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1514317393, "post_id": 47982406, "comment_id": 82934629, "body": "@LinuxCrusher because that is the type returned by the function. Note that <code>EOF</code> is probably <code>-1</code> which is out of the range of <code>unsigned char</code>. That&#39;s the other reason why you should use <code>int</code>. BTW few of the C library functions take <code>char</code> as arguments, or return <code>char</code> as the function value. They mostly use <code>int</code>, so, go with the flow, not your own ideas. Aside: the value <code>&#39;a&#39;</code> has type <code>int</code> - not <code>char</code>."}, {"owner": {"reputation": 37, "user_id": 7347010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7139241e275d1331831191ef59c2a4?s=128&d=identicon&r=PG&f=1", "display_name": "Flavien Chamay", "link": "https://stackoverflow.com/users/7347010/flavien-chamay"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1514321677, "post_id": 47982406, "comment_id": 82936055, "body": "@WeatherVane Ok, so when my function will return this int, it will be an int corresponding to the ASCII code, right?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1514322013, "post_id": 47982406, "comment_id": 82936178, "body": "As I wrote, <code>&#39;a&#39;</code> has type <code>int</code>. If you don&#39;t believe me, try <code>printf(&quot;%zu\\n&quot;, sizeof(&#39;a&#39;));</code> which will not print <code>1</code>. Try using <code>int</code> and see if the C library writers know what they are doing!"}, {"owner": {"reputation": 37, "user_id": 7347010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7139241e275d1331831191ef59c2a4?s=128&d=identicon&r=PG&f=1", "display_name": "Flavien Chamay", "link": "https://stackoverflow.com/users/7347010/flavien-chamay"}, "reply_to_user": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1514322594, "post_id": 47982406, "comment_id": 82936387, "body": "@wildplasser thanks! I have found a way thanks to you. I will update to show if it is correct."}, {"owner": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 0, "creation_date": 1514325329, "post_id": 47982406, "comment_id": 82937174, "body": "I think you are looking to simply replace <code>&#47;&#47;something to do...</code> with <code>*(characters_ok++) = character_read</code>.  Note that you&#39;ll have to declare characters_ok as a pointer rather than an array to do that, which you need to do anyway if you want to return it from your function."}, {"owner": {"reputation": 37, "user_id": 7347010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7139241e275d1331831191ef59c2a4?s=128&d=identicon&r=PG&f=1", "display_name": "Flavien Chamay", "link": "https://stackoverflow.com/users/7347010/flavien-chamay"}, "reply_to_user": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 0, "creation_date": 1514391697, "post_id": 47982406, "comment_id": 82958822, "body": "@WilliamPursell Why writing ++ at the end of characters_ok ? I want that every valided character is put my array character_ok. Example: character_ok[0]=a , character_ok[1]=d, character_ok[2]=g and character_ok[3]=j. Does your code doing the same thing?"}, {"owner": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 0, "creation_date": 1514402298, "post_id": 47982406, "comment_id": 82963174, "body": "Yes.  In my example, I&#39;m assuming that you have declared characters_ok as a pointer.  Incrementing it is a common idiom for the more verbose <code>characters_ok[i] = character_read; i += 1</code>"}, {"owner": {"reputation": 37, "user_id": 7347010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7139241e275d1331831191ef59c2a4?s=128&d=identicon&r=PG&f=1", "display_name": "Flavien Chamay", "link": "https://stackoverflow.com/users/7347010/flavien-chamay"}, "reply_to_user": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 0, "creation_date": 1514404114, "post_id": 47982406, "comment_id": 82963900, "body": "@WilliamPursell Thanks! I have updated the code. It compile without problems. Thanks to all of you! If I understand, if a question has been answered I just have to delete it right?"}], "answers": [{"tags": [], "owner": {"reputation": 37, "user_id": 7347010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7139241e275d1331831191ef59c2a4?s=128&d=identicon&r=PG&f=1", "display_name": "Flavien Chamay", "link": "https://stackoverflow.com/users/7347010/flavien-chamay"}, "is_accepted": true, "score": 0, "last_activity_date": 1514648239, "last_edit_date": 1514648239, "creation_date": 1514454900, "answer_id": 48005286, "question_id": 47982406, "link": "https://stackoverflow.com/questions/47982406/how-to-use-modulo-while-browsing-a-file-in-a-function-in-c/48005286#48005286", "title": "How to use modulo while browsing a file in a function in C", "body": "<p><strong>Solved:</strong>\nThanks to people in the comments, the answer to my question is to simply count the character (with an incremented counter) I read and to use the test</p>\n\n<pre><code>compt % modulo) == 0\n</code></pre>\n\n<p>So, the complete answer is:</p>\n\n<pre><code>       int* f1(char* name_file, int modulo)\n{\n    int* characters_ok;\n    int compt=0;\n    int character_read;\n    fileToOpen=fopen(name_file,\"r\");\n    if (fileToOpen == NULL)\n    {\n        printf(\"%s : \",name_file);\n        errorfile();\n    }\n    while ((character_read = fgetc(fileToOpen)) != EOF)\n    {\n        if ((compt % modulo) == 0)\n        {\n           *(characters_ok++)=character_read;\n        }\n        compt++;\n    }\n    fclose(fileToOpen);\n    return characters_ok;\n}\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 7347010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7139241e275d1331831191ef59c2a4?s=128&d=identicon&r=PG&f=1", "display_name": "Flavien Chamay", "link": "https://stackoverflow.com/users/7347010/flavien-chamay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 48005286, "answer_count": 1, "score": -1, "last_activity_date": 1515791361, "creation_date": 1514313267, "last_edit_date": 1515791361, "question_id": 47982406, "link": "https://stackoverflow.com/questions/47982406/how-to-use-modulo-while-browsing-a-file-in-a-function-in-c", "title": "How to use modulo while browsing a file in a function in C", "body": "<p>I don't know how to code a function that browse a file with a specific modulo. </p>\n\n<p>Example, if I have 3 as modulo and a file is containing :</p>\n\n<pre><code>abcdefghijk \n</code></pre>\n\n<p>then, my function should returns :</p>\n\n<pre><code>adgj\n</code></pre>\n\n<p>My code of the function:</p>\n\n<pre><code>char f1(char* name_file, int modulo)\n{\n    char characters_ok[];\n    unsigned char character_read;\n    fileToOpen=fopen(name_file,\"r\");\n    do\n    {\n        character_read=fgetc(fileToOpen);\n        //and I don't know what to write...\n    }\n    while(!feof(fileToOpen));\n    fclose(fileToOpen);\n    return characters_ok;\n}\n</code></pre>\n"}, {"tags": ["c", "parameter-passing"], "comments": [{"owner": {"reputation": 787, "user_id": 7714006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2bf23fe02b176b9ec4b72f65570e0b5?s=128&d=identicon&r=PG&f=1", "display_name": "Aditi Rawat", "link": "https://stackoverflow.com/users/7714006/aditi-rawat"}, "edited": false, "score": 0, "creation_date": 1514316080, "post_id": 47982287, "comment_id": 82934216, "body": "recommended read: <a href=\"https://stackoverflow.com/questions/373419/whats-the-difference-between-passing-by-reference-vs-passing-by-value\">What&#39;s the difference between passing by reference vs. passing by value?</a>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1514316882, "post_id": 47982287, "comment_id": 82934451, "body": "&quot; why my code doesn&#39;t work&#39; --&gt; Code does work. &quot;yet the code doesn&#39;t what I want it to do&quot; --&gt; What did you want code to do?"}], "answers": [{"tags": [], "owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "is_accepted": false, "score": 1, "last_activity_date": 1514313101, "last_edit_date": 1514313101, "creation_date": 1514312649, "answer_id": 47982305, "question_id": 47982287, "link": "https://stackoverflow.com/questions/47982287/function-not-modyfing-a-character-array/47982305#47982305", "title": "Function not modyfing a character array", "body": "<p>Well because <code>C</code> is pass by value. You make changes to a local variable(<code>name</code> in function <code>swicth_name()</code>). To retain changes pass the address of the <code>char*</code> and assign the address of the string literal to the <code>char*</code> directly (By dereferencing the <code>char**</code>). For example this would work</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid switch_name(char** name)\n{\n     *name= \"testv2\";\n}\n\nint main(void)\n{\n   char *name1 = \"test_name\"; \n   printf(\"%s\\n\", name1);\n   switch_name(&amp;name1);\n   printf(\"%s\\n\", name1);\n   return 0;\n}\n</code></pre>\n\n<p>Here the function <code>swicth_name</code> got the address of the <code>char*</code> <code>name1</code>. Now when you dereference it using unary <code>*</code> in <code>switch_name</code> you assign the address of the string literal to the <code>name</code> variable of <code>main()</code>. That' swhy the change retains.</p>\n"}, {"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 0, "last_activity_date": 1514319549, "last_edit_date": 1514319549, "creation_date": 1514313035, "answer_id": 47982370, "question_id": 47982287, "link": "https://stackoverflow.com/questions/47982287/function-not-modyfing-a-character-array/47982370#47982370", "title": "Function not modyfing a character array", "body": "<p>Function parameters are its local variables. </p>\n\n<p>You can imagine the function call and its definition the following way</p>\n\n<pre><code>char *name1 = \"test_name\"; \nswitch_name(name1);\n\n//...\n\nvoid switch_name( /* char* name */ )\n{\n     char *name = name1;\n     name= \"testv2\";\n}\n</code></pre>\n\n<p>As you can see the original variable <code>name1</code> was not changed in the function. It is the variable <code>name</code> that is the parameter that was changed in the function.</p>\n\n<p>You have to pass the original variable by reference if you are going to change it in the function.</p>\n\n<p>For example</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid switch_name( char ** name)\n{\n    *name= \"testv2\";\n}\n\nint main( void )\n{\n    char *name1 = \"test_name\"; \n\n    printf(\"%s\\n\", name1);\n\n    switch_name( &amp;name1 );\n\n    printf(\"%s\\n\", name1);\n}\n</code></pre>\n\n<p>Compare the above program with the following program</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nvoid switch_name( char* name )\n{\n    strcpy( name, \"testv2\" );\n}\n\nint main(void) \n{\n    char s[] = \"test_name\"; \n    char *name1 = s;\n\n    printf( \"%s\\n\", name1 );\n\n    switch_name( name1 );\n\n    printf( \"%s\\n\", name1 );\n\n    return 0;\n}\n</code></pre>\n\n<p>In the first program you are going to reassign the original pointer itself using a function.</p>\n\n<p>In the second program it is the data pointed to by the pointer that are reassigned using the standard C function <code>strcpy</code>.</p>\n\n<p>Take into account that according to the C Standard the function <code>main</code> without parameters shall be declared like</p>\n\n<pre><code>int main( void )\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 9080307, "user_type": "registered", "profile_image": "https://graph.facebook.com/1473224019458322/picture?type=large", "display_name": "Jan Chabik", "link": "https://stackoverflow.com/users/9080307/jan-chabik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1514319549, "creation_date": 1514312582, "last_edit_date": 1514313188, "question_id": 47982287, "link": "https://stackoverflow.com/questions/47982287/function-not-modyfing-a-character-array", "title": "Function not modyfing a character array", "body": "<p>Im just starting to learn pointers and I'm trying to figure out why my code doesn't work. I get no compilation error yet the code doesn't what I want it to do. Why am I not passing the adress of an array? If I try to do so I get a compiilation error :(</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid switch_name(char* name)\n\n{\n     name= \"testv2\";\n}\n\nvoid main()\n{\nchar *name1 = \"test_name\"; \nprintf(\"%s\\n\", name1);\nswitch_name(name1);\nprintf(\"%s\\n\", name1);\n}\n</code></pre>\n"}, {"tags": ["c", "pointers", "struct"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 1, "creation_date": 1514308385, "post_id": 47981605, "comment_id": 82931703, "body": "Welcome to Stack Overflow! Kindly show your research / debugging effort so far. Please read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> page first."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1514308534, "post_id": 47981605, "comment_id": 82931758, "body": "a) you&#39;re printing the child&#39;s name before assigning anything to it, as the parent&#39;s name. b) the child pointer is not pointing anywhere. c) <code>char name[15]</code> doesn&#39;t do what you think it does."}], "answers": [{"comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 2, "creation_date": 1514355950, "post_id": 47981670, "comment_id": 82943416, "body": "Reason for DV, anyone?"}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": true, "score": 0, "last_activity_date": 1514355942, "last_edit_date": 1514355942, "creation_date": 1514308601, "answer_id": 47981670, "question_id": 47981605, "link": "https://stackoverflow.com/questions/47981605/c-struct-with-pointer-to-itself-accessing-values/47981670#47981670", "title": "C struct with pointer to itself - accessing values", "body": "<p>Inside your <code>add_chilld()</code> function, you are attempting to access <code>parent-&gt;child</code> but you never made it point to anything valid.</p>\n\n<p>So, you're dereferencing an uninitialized pointer, which holds an indeterminate value, i.e, an invalid memory address, which causes <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behavior</a></p>\n\n<p>In other words, before you can make use of something like <code>parent-&gt;child-&gt;name</code>, you need to make sure that the <code>child</code> member of the <code>parent</code> variable is actually set to some <em>child</em> (which you allocated earlier).</p>\n"}], "owner": {"reputation": 23, "user_id": 9142332, "user_type": "registered", "profile_image": "https://graph.facebook.com/1550029305111846/picture?type=large", "display_name": "Kostadin Kostadinov", "link": "https://stackoverflow.com/users/9142332/kostadin-kostadinov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 250, "favorite_count": 0, "accepted_answer_id": 47981670, "answer_count": 1, "score": 1, "last_activity_date": 1514355942, "creation_date": 1514308247, "last_edit_date": 1514318844, "question_id": 47981605, "link": "https://stackoverflow.com/questions/47981605/c-struct-with-pointer-to-itself-accessing-values", "title": "C struct with pointer to itself - accessing values", "body": "<p>I have a problem with structs. I must use a struct that has a pointer to itself. I have done this and I think it works:</p>\n\n<pre><code>typedef struct tag_t tag_t;\n    struct tag_t{\n    char name[15];\n    int is_self_closing;\n    tag_t *child;\n};\n</code></pre>\n\n<p>I am making a function that adds a child to a tag, like \"body\" is a child of the <strong>html</strong> tag, so my program core dumped and resulted in a segmentation fault when I tried to work with the \"name\" and \"is_self_closing\" variables of the child pointer. I don't know how to access them correctly. This is the entire code for the program.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\ntypedef struct tag_t tag_t;\nstruct tag_t{\n    char name[15];\n    int is_self_closing;\n    tag_t *child;\n};\n\nvoid add_chilld(tag_t *,char[15],int);\n\nvoid print_markup(tag_t);\n\nint main(int argc, char **argv){\n    tag_t parent,child;\n    strcpy(child.name,\"body\");\n    child.is_self_closing = 1;\n    strcpy(parent.name,\"html\");\n    parent.is_self_closing = 0;\n    add_chilld(&amp;parent,child.name,child.is_self_closing);\n    printf(\"child name = %s child closing = %d\\n\",child.name,child.is_self_closing);\n    printf(\"%s %d %s\\n\",parent.name,parent.is_self_closing,parent.child-&gt;name);\n    return 0;\n}\n\nvoid add_chilld(tag_t *parent,char name[15],int is_self_closing){\n    if(is_self_closing == 1){\n        printf(\"parent name = %s\\n\",parent-&gt;child-&gt;name);\n        strcpy(parent-&gt;child-&gt;name,name);\n        parent-&gt;child-&gt;is_self_closing = is_self_closing;\n    }else{\n        parent-&gt;child = NULL;\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "crypt"], "comments": [{"owner": {"reputation": 28355, "user_id": 4788546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2jWn.jpg?s=128&g=1", "display_name": "CristiFati", "link": "https://stackoverflow.com/users/4788546/cristifati"}, "edited": false, "score": 1, "creation_date": 1514309123, "post_id": 47981556, "comment_id": 82931935, "body": "According to the snippet, you only encrypt a string (<code>CryptProtectData</code>) then you&#39;re trying to print it. The encrypted string is <b>binary</b> (meaning that it&#39;s not suitable to be used by the <code>NULL</code> terminated strings function families (e.g. <code>strcpy_s</code> or <code>sprintf</code>) as it may contain <code>\\0</code>s; that&#39;s the reason why the <code>DATA_BLOB</code> structure has the <code>cbData</code> member). Also, no need to call <code>GetLastError</code> when a function succeeds. Pass <code>encrBlob</code> to <code>CryptUnprotectData</code> and only then try printing the result."}, {"owner": {"reputation": 21, "user_id": 510155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/430589a24e1db9d40109b7cb5a974797?s=128&d=identicon&r=PG", "display_name": "moakley", "link": "https://stackoverflow.com/users/510155/moakley"}, "reply_to_user": {"reputation": 28355, "user_id": 4788546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2jWn.jpg?s=128&g=1", "display_name": "CristiFati", "link": "https://stackoverflow.com/users/4788546/cristifati"}, "edited": false, "score": 0, "creation_date": 1514411076, "post_id": 47981556, "comment_id": 82966445, "body": "Description of the problem was incomplete and I left the clutter in the code sample include.  I wound up converting the binary to base64 in order to store and retrieve from a file.  Thanks for your help."}, {"owner": {"reputation": 28355, "user_id": 4788546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2jWn.jpg?s=128&g=1", "display_name": "CristiFati", "link": "https://stackoverflow.com/users/4788546/cristifati"}, "edited": false, "score": 0, "creation_date": 1514465415, "post_id": 47981556, "comment_id": 82983842, "body": "Good to hear you worked things up. Note: <i>base64</i> is not mandatory in order to save some data in files, the files can be opened as <i>binary</i>."}], "owner": {"reputation": 21, "user_id": 510155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/430589a24e1db9d40109b7cb5a974797?s=128&d=identicon&r=PG", "display_name": "moakley", "link": "https://stackoverflow.com/users/510155/moakley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 185, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1514307921, "creation_date": 1514307921, "question_id": 47981556, "link": "https://stackoverflow.com/questions/47981556/crypt32-function-cryptprotectdata-always-returning-x1", "title": "Crypt32 function CryptProtectData always returning &quot;\\x1&quot;", "body": "<p>Trying to use the Crypt32 functions CryptProtectData and CryptUnprotectData to encrypt and decrypt strings from a C program.  The encrypt claims to be successful, but the pbData in the output DATA_BLOB always contains just \"\\x1\". Below is what I am currently using for encryption.  Any suggestions on what I may be doing wrong?</p>\n\n<p>This is on Windows 7 using crypt32.dll v6.1.7601. </p>\n\n<pre><code>EXPORT short CALLBACK ASEncryptDPApiValue (char *pszEntropy, char *pszValue, char *pszEncryptValue, int iValueLen)\n{\n   short sRetCd = 0;\n   char szDecryptValue [MAX_INI_VALUE] = \"\";\n   DWORD dwLastErrorRC = 0;\n   DWORD dwFlags = CRYPTPROTECT_LOCAL_MACHINE;\n   CHAR szMsgBuffer[200] = \"\";\n\n   DATA_BLOB encrBlob;\n   DATA_BLOB decrBlob = {0, 0};\n   DATA_BLOB entropyBlob = {0, 0};\n   LPWSTR pDescrOut =  NULL;\n\n   if (pszValue[0] != '\\0')\n      {\n      decrBlob.pbData = (BYTE *)pszValue;\n      decrBlob.cbData = strlen((char *)decrBlob.pbData)+1;\n      }\n   // else return an error\n\n   if (pszEntropy[0] != '\\0')\n      {\n      entropyBlob.pbData = (BYTE *)pszEntropy;\n      entropyBlob.cbData = strlen((char *)entropyBlob.pbData)+1;\n      }\n\n   if (CryptProtectData(&amp;decrBlob,\n                        pDescrOut,\n                        &amp;entropyBlob, \n                        NULL,\n                        NULL,\n                        dwFlags,\n                        &amp;encrBlob))\n      {\n      strcpy_s(pszEncryptValue, iValueLen, (char *) encrBlob.pbData);\n      dwLastErrorRC = GetLastError();\n      LocalFree(encrBlob.pbData);\n      sprintf(szMsgBuffer, \n         _T(\"ASEncryptDPApiValue - Decrypting value - successful = %d  [%s]\\r\\n\"), dwLastErrorRC, pszEncryptValue);\n      OutputDebugString(szMsgBuffer);\n      }\n   else\n      {\n      sRetCd = TRUE;\n      dwLastErrorRC = GetLastError();\n      sprintf(szMsgBuffer, \n         _T(\"ASEncryptDPApiValue - error decrypting value - last OS error = %d\\r\\n\"), dwLastErrorRC);\n      OutputDebugString(szMsgBuffer);\n      LocalFree(encrBlob.pbData);\n      }\n\n    return sRetCd;\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "networking", "ioctl"], "owner": {"reputation": 627, "user_id": 6694404, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/bd260580a43b5bb091b40509eee0bfe9?s=128&d=identicon&r=PG&f=1", "display_name": "P.Carlino", "link": "https://stackoverflow.com/users/6694404/p-carlino"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 204, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1514306316, "creation_date": 1514304099, "last_edit_date": 1514306316, "question_id": 47980944, "link": "https://stackoverflow.com/questions/47980944/call-ioctl-with-siogcsiwfreq-return-0-but-dont-change-frequency", "title": "Call ioctl with SIOGCSIWFREQ return 0 but don&#39;t change frequency", "body": "<p>Hi i'm wroting something about network interfaces managment just to spend time. \nI wrote a functions in c that make me able to put down or up a interface or, talking about wlan interfaces, to change mode like monitor managed etc. Now i want to change the the listening channel of the wlan interface, so i surfed on the net and i found different solution like using the nl80211 etc. The most intersting one in my opinion is the one with ioctl. So i wrote these pieces of code </p>\n\n<pre><code>int changeChannel(int handler,int channel){\n  getChannel(handler);\n  wreq.u.freq.m=  RETRIEVE_FREQ(channel);\n  wreq.u.freq.e = 6;\n\n\n  short app = ioctl(sock,SIOCSIWFREQ,&amp;wreq);\n  if(app&lt;0){\n    fprintf(stderr,\"Error to change the on %i channel to %s\\n\",channel,interfaces[handler]);\n    return app;\n  }\n}\n\nint getChannel(int handler){\n  iw_get(handler);\n  register short app =ioctl(sock,SIOCGIWFREQ,&amp;wreq);\n  if(app&lt;0){\n    fprintf(stderr,\"Error to get the channel from %s\\n\",interfaces[handler]);\n    return app;\n  }\n\n  return RETRIEVE_CHANNEL(wreq.u.freq.m);\n}\n</code></pre>\n\n<p>where RETRIEVE_CHANNEL and RETRIEVE_FREQ are macros that i use to get the channel from the freq and the freq from the channel. \nDefined as follow </p>\n\n<pre><code>#define RETRIEVE_CHANNEL(freq) ({\\\nint _channel = -1;\\\nswitch(freq){\\\n    case CHANNEL1:\\\n        _channel = 1;\\\n        break;\\\n    case CHANNEL2:\\\n        _channel = 2;\\\n        break;\\\n    case CHANNEL3:\\\n        _channel = 3;\\\n        break;\\\n    case CHANNEL4:\\\n        _channel = 4;\\\n        break;\\\n    case CHANNEL5:\\\n        _channel = 5;\\\n        break;\\\n    case CHANNEL6:\\\n        _channel = 6;\\\n        break;\\\n    case CHANNEL7:\\\n        _channel = 7;\\\n        break;\\\n    case CHANNEL8:\\\n        _channel = 8;\\\n        break;\\\n    case CHANNEL9 :\\\n        _channel = 9;\\\n        break;\\\n    case CHANNEL10:\\\n        _channel = 10;\\\n        break;\\\n    case CHANNEL11:\\\n        _channel = 11;\\\n        break;\\\n    case CHANNEL12:\\\n        _channel = 12;\\\n        break;\\\n    case CHANNEL13:\\\n        _channel = 13;\\\n        break;\\\n    case CHANNEL14:\\\n        _channel = 14;\\\n        break;\\\n}\\\n_channel;\\\n});\n#define RETRIEVE_FREQ(channel) ({\\\n    int _freq = -1;\\\n    switch(channel){ \\\n        case 1:\\\n            _freq = CHANNEL1;\\\n            break;\\\n        case 2:\\\n            _freq = CHANNEL2;\\\n            break;\\\n        case 3:\\\n            _freq = CHANNEL3;\\\n            break;\\\n        case 4:\\\n            _freq = CHANNEL4;\\\n            break;\\\n        case 5:\\\n            _freq = CHANNEL5;\\\n            break;\\\n        case 6:\\\n            _freq = CHANNEL6;\\\n            break;\\\n        case 7:\\\n            _freq = CHANNEL7;\\\n            break;\\\n        case 8:\\\n            _freq = CHANNEL8;\\\n            break;\\\n        case 9:\\\n            _freq = CHANNEL9;\\\n            break;\\\n        case 10:\\\n            _freq = CHANNEL10;\\\n            break;\\\n        case 11:\\\n            _freq = CHANNEL11;\\\n            break;\\\n        case 12:\\\n            _freq = CHANNEL12;\\\n            break;\\\n        case 13:\\\n            _freq = CHANNEL13;\\\n            break;\\\n        case 14:\\\n            _freq = CHANNEL14;\\\n            break;\\\n    }\\\n    _freq;\\\n});\n</code></pre>\n\n<p>the CHANNELNUM are constants values that i define in a enum with the frequenties values associated with the channel</p>\n\n<p>Now my code works, or almost the getChannel does. With changeChannel ioctl return 0 but if i launch </p>\n\n<pre><code>iw interface info \n</code></pre>\n\n<p>The command show me always the same channel. \nWhere is my error? Sorry for the English and thanks to all for the patience</p>\n"}, {"tags": ["c", "arrays", "pointers"], "comments": [{"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1514303419, "post_id": 47980799, "comment_id": 82930100, "body": "The book is simplifying matters. <code>ar2[0]</code> is the first element of <code>ar2[3][2]</code> which is a 2-dimensional array; 2-dmensional arrays in C are arrays of 1-dimensional arrays though, so that the first element is a 1-dimensional array. You can easily check that by checking its size with <code>sizeof(ar2[0])</code>. Now in assignments and parameter passing arrays in C decay or are &quot;adjusted&quot; to pointers, so that the statement <code>*p2 = ar2[0];</code> is possible, but <code>ar2[0]</code> itself is not a pointer."}, {"owner": {"reputation": 457, "user_id": 8370202, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/25918f1d68b4bdb55f7afdd7673ef2e6?s=128&d=identicon&r=PG&f=1", "display_name": "AlexQualcosa", "link": "https://stackoverflow.com/users/8370202/alexqualcosa"}, "reply_to_user": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1514304026, "post_id": 47980799, "comment_id": 82930278, "body": "This is my answer, thank you @PeterA.Schneider"}, {"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "reply_to_user": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1514408396, "post_id": 47980799, "comment_id": 82965499, "body": "@PeterA.Schneider You should make that an actual answer."}], "answers": [{"comments": [{"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 0, "creation_date": 1514408327, "post_id": 47998159, "comment_id": 82965475, "body": "This is incorrect. As mentioned in the question comments, <code>arr2[0]</code> is an <i>array of 2 <code>int</code>s, not a pointer-to-<code>int</code></i>. It will <i>decay</i> to a pointer, which is why the assignment works, but it is itself an array."}, {"owner": {"reputation": 773, "user_id": 7906266, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/z10WK.png?s=128&g=1", "display_name": "Matias Haeussler", "link": "https://stackoverflow.com/users/7906266/matias-haeussler"}, "reply_to_user": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 0, "creation_date": 1571253283, "post_id": 47998159, "comment_id": 103182726, "body": "I have just improved my interpretation of arrays. I think it makes clear I do not think arr2[0] is a pointer."}], "tags": [], "owner": {"reputation": 773, "user_id": 7906266, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/z10WK.png?s=128&g=1", "display_name": "Matias Haeussler", "link": "https://stackoverflow.com/users/7906266/matias-haeussler"}, "is_accepted": false, "score": 0, "last_activity_date": 1571254186, "last_edit_date": 1571254186, "creation_date": 1514405950, "answer_id": 47998159, "question_id": 47980799, "link": "https://stackoverflow.com/questions/47980799/multidimensional-array-and-pointer-to-pointer-value/47998159#47998159", "title": "Multidimensional array and pointer to pointer value", "body": "<p><strong>What is a pointer</strong></p>\n\n<p>A 4/8 byte sized entity, variable or constant (<code>type * p</code> or <code>type const * p</code>), that must specify the type of the entities to which they point to. If variable it can change the entity to which it points to.</p>\n\n<p><strong>What is an array</strong></p>\n\n<p>An array always exists on stack, its memory size equals the count of its elements times the size of their type, and like const pointers, it can't stop pointing to its defining elements. A Multidimensional array can be seen as a tree of arrays: specifiying a position in its 0th dimension will return another with one less dimension.</p>\n\n<p><strong>Answer</strong></p>\n\n<p>In practice, arrays can work as specialized stack const pointers that point to the first element one level below in the hierarchy:</p>\n\n<ol>\n<li><code>type {*}</code> for <code>type {*} arr[]</code></li>\n<li><code>type {*} arr[]</code> for <code>type {*} arr2[][]</code></li>\n<li><code>type {*} arr2[][]</code> for <code>type {*} arr3[][][]</code></li>\n<li><code>Element 0 of 0th dimension</code> for <code>Any array</code></li>\n</ol>\n\n<p>That is why <code>arp</code> in <code>int (* arp)[2] = ar2</code> would be a pointer to the array <code>ar2[0]</code> (i.e. the first branch of <code>ar2</code>). </p>\n\n<p><strong>They are not pointers</strong>, but I believe this way of thinking improves the model one internally has of the language.</p>\n"}], "owner": {"reputation": 457, "user_id": 8370202, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/25918f1d68b4bdb55f7afdd7673ef2e6?s=128&d=identicon&r=PG&f=1", "display_name": "AlexQualcosa", "link": "https://stackoverflow.com/users/8370202/alexqualcosa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1571254186, "creation_date": 1514303208, "last_edit_date": 1514313764, "question_id": 47980799, "link": "https://stackoverflow.com/questions/47980799/multidimensional-array-and-pointer-to-pointer-value", "title": "Multidimensional array and pointer to pointer value", "body": "<p>Given the following:</p>\n\n<pre><code>int ar2[3][2];\nint * pt;\nint **p2;\np2 = &amp;pt;\n*p2 = ar2[0];\n</code></pre>\n\n<p>This is what my book says: </p>\n\n<blockquote>\n  <p>*p2 is type pointer-to-int, making it compatible with ar2[0].\n  <em>Recall that ar2[0] <strong>is a pointer</strong> to its first element</em>, art2[0][0], making ar2[0] type pointer-to-int also.</p>\n</blockquote>\n\n<p>Is it everything true?</p>\n"}, {"tags": ["c", "screenshot", "x11", "xlib"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1514822618, "post_id": 47980608, "comment_id": 83073978, "body": "FYI your program segfaults on my machine at <code>unsigned char outdata[attr.width * attr.height * 3];</code> The screen is 2560x1440, not big by modern standards but enough to blow the stack. Once I remove the VLA and replace it with normal heap allocation, all windows are dumped normally. Don&#39;t use VLAs."}, {"owner": {"reputation": 2988, "user_id": 329931, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5aad0bbc993dc5e201cced5e8cc26895?s=128&d=identicon&r=PG", "display_name": "Tom", "link": "https://stackoverflow.com/users/329931/tom"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1514965374, "post_id": 47980608, "comment_id": 83119844, "body": "im not sure thats actually used.. it was a legacy of the original code sample... the function <code>write_png_for_image</code> is using this <code>png_row = (png_bytep) malloc(3 * width * sizeof(png_byte));</code>"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1514965877, "post_id": 47980608, "comment_id": 83120051, "body": "I can only look at the code you have posted. If that&#39;s not what you are actually using, I can&#39;t help. The line in question is in <code>main</code> right before the call to <code>getScreen2</code>."}, {"owner": {"reputation": 2988, "user_id": 329931, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5aad0bbc993dc5e201cced5e8cc26895?s=128&d=identicon&r=PG", "display_name": "Tom", "link": "https://stackoverflow.com/users/329931/tom"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1514966212, "post_id": 47980608, "comment_id": 83120194, "body": "Apologies... I fixed up the code to remove those lines, as they were doing nothing. (other than allocate a bunch of unused memory...) basically main() loops over all the windows calling <code>getScreen2(0, 0, attr.width, attr.height, window);</code> and that calls for each loop <code>write_png_for_image(image, xid, W, H, filename);</code> which uses <code>png_row = (png_bytep) malloc(3 * width * sizeof(png_byte));</code> for the memory that the original example was using <code>outdata</code> for"}, {"owner": {"reputation": 2988, "user_id": 329931, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5aad0bbc993dc5e201cced5e8cc26895?s=128&d=identicon&r=PG", "display_name": "Tom", "link": "https://stackoverflow.com/users/329931/tom"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1514966325, "post_id": 47980608, "comment_id": 83120255, "body": "What I mean is, if you look at the original code, its passing <code>outdata</code> into <code>GetScreen2(xxx)</code> but it doesn&#39;t use it for anything"}, {"owner": {"reputation": 2988, "user_id": 329931, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5aad0bbc993dc5e201cced5e8cc26895?s=128&d=identicon&r=PG", "display_name": "Tom", "link": "https://stackoverflow.com/users/329931/tom"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1514966861, "post_id": 47980608, "comment_id": 83120468, "body": "<a href=\"https://gist.github.com/tolland/1819263833b15c34ca9fccd730b08b9b\" rel=\"nofollow noreferrer\">gist.github.com/tolland/1819263833b15c34ca9fccd730b08b9b</a>  gcc test2.c -O3 -lX11  -lXcomposite -lXrender -lpng -o test2.out  &amp;&amp; mkdir -p /tmp/png_out &amp;&amp; ./test2.out"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1514969399, "post_id": 47980608, "comment_id": 83121538, "body": "Not sure why this could happen. The program is working for me. Can you check whether mangled windows are on a different visual from all the rest, or all are on the same visual?"}], "owner": {"reputation": 2988, "user_id": 329931, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5aad0bbc993dc5e201cced5e8cc26895?s=128&d=identicon&r=PG", "display_name": "Tom", "link": "https://stackoverflow.com/users/329931/tom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 423, "favorite_count": 0, "answer_count": 0, "score": 4, "last_activity_date": 1514966246, "creation_date": 1514302162, "last_edit_date": 1514966246, "question_id": 47980608, "link": "https://stackoverflow.com/questions/47980608/xgetimage-is-mangled-for-chrome-firefox-electron-when-using-xcompositeredirec", "title": "XGetImage is mangled for chrome, firefox, electron, when using XCompositeRedirectWindow", "body": "<p>I am attempting to create a thumbnailer (for i3wm on linux) which generates an icon from a screenshot for all the available windows. The aim being to replicate something like how windows uses <code>Alt-Tab</code> to produce a pane of windows to choose from;</p>\n\n<p><a href=\"https://i.stack.imgur.com/PlfhI.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/PlfhI.png\" alt=\"enter image description here\"></a></p>\n\n<p>The current prototype uses pygtk to generate the dialog, and it creates thumbnails of the windows in the <code>_NET_CLIENT_LIST</code> using <code>XGetImage</code> where the windows have been redirected using <code>XCompositeRedirectWindow</code>. It works pretty well except for that images captured from windows which are browsers, (e.g. firefox, chrome, electron) are mangled, or wrong;</p>\n\n<p><a href=\"https://i.stack.imgur.com/dJtUR.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dJtUR.png\" alt=\"enter image description here\"></a></p>\n\n<p>Basically, tools like xwd, scrot and <code>import</code> don't work for the hidden windows in i3, presumably because they are unmapped. So I have pulled some code together to create the thumbnails. The core of it is based on an example using <code>XCompositeRedirectWindow</code> from <code>X11/extensions/Xcomposite.h</code> from <a href=\"https://stackoverflow.com/questions/21512177/get-a-screenshot-of-a-window-that-is-cover-or-not-visible-or-minimized-with-xcom\">here</a>.</p>\n\n<p>My attempt at creating a short example is here;<br>\n<a href=\"https://gist.github.com/tolland/4bb1e97db258b92618adfb783ce66fac\" rel=\"nofollow noreferrer\">https://gist.github.com/tolland/4bb1e97db258b92618adfb783ce66fac</a></p>\n\n<p>it can be compiled with;</p>\n\n<pre><code>$ gcc example.c -lX11 -lXcomposite -lXrender -lpng -o example\n</code></pre>\n\n<p>and then to output png files for each of the windows;   </p>\n\n<pre><code>$ mkdir -p /tmp/png_out &amp;&amp;  ./example\n</code></pre>\n\n<p>will produce pngs for each of the images</p>\n\n<pre><code>window found was 58720312 \nfound window name for 58720312  :  build : sudo  \nfilename /tmp/png_out/58720312_test3.png \nwindow found was 79691781 \nfound window name for 79691781  :  .xsession-errors - glogg  \nfilename /tmp/png_out/79691781_test3.png \nwindow found was 62914576 \nfound window name for 62914576  :  Edit - Stack Overflow - Mozilla Firefox  \nfilename /tmp/png_out/62914576_test3.png\n</code></pre>\n\n<p>So the code I am currently using to walk the <code>_NET_CLIENT_LIST</code> is this;   </p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;string.h&gt;\n#include &lt;libpng16/png.h&gt;\n\n#include &lt;X11/X.h&gt;\n#include &lt;X11/Xlib.h&gt;\n#include &lt;X11/Xutil.h&gt;\n#include &lt;X11/extensions/Xcomposite.h&gt;\n#include &lt;X11/extensions/Xrender.h&gt;\n//Compile hint: gcc -shared -O3 -lX11 -fPIC -Wl,-soname,prtscn -o prtscn.so prtscn.c\n\ntypedef int bool;\n#define true 1\n#define false 0\n\nconst int DEBUG = 0;\n\nvoid getScreen2(const int, const int, const int, const int, const XID);\nvoid write_png_for_image(XImage *image, XID xid, int width, int height,\n        char *filename);\ntypedef int (*handler)(Display *, XErrorEvent *);\nXID getWindows(Display *display, Window parent, Window window, XID xid,\n        int depth);\n\nint main() {\n\n    Display *display = XOpenDisplay(NULL);\n    Window root = DefaultRootWindow(display);\n\n    uint nwindows;\n    Window root_return, parent_return, *windows;\n\n    Atom a = XInternAtom(display, \"_NET_CLIENT_LIST\", true);\n    Atom actualType;\n\n    int format;\n    unsigned long numItems, bytesAfter;\n    unsigned char *data = 0;\n\n    int status = XGetWindowProperty(display, root, a, 0L, (~0L),\n    false,\n    AnyPropertyType, &amp;actualType, &amp;format, &amp;numItems, &amp;bytesAfter, &amp;data);\n\n    char* window_name_return;\n\n    if (status &gt;= Success &amp;&amp; numItems) {\n        long *array = (long*) data;\n        for (long k = 0; k &lt; numItems; k++) {\n            Window window = (Window) array[k];\n\n            //not finding chrome window name\n            printf(\"window found was %d \\n\", window);\n            if (XFetchName(display, window, &amp;window_name_return)) {\n                printf(\"found window name for %d  :  %s  \\n\", window,\n                        window_name_return);\n            }\n\n            //XMapWindow(display, parent);\n            XMapWindow(display, window);\n\n            XWindowAttributes attr;\n\n            Status status = XGetWindowAttributes(display, window, &amp;attr);\n            if (status == 0)\n                printf(\"Fail to get window attributes!\\n\");\n\n            getScreen2(0, 0, attr.width, attr.height, window);\n\n        }\n        XFree(data);\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>which calls this function to map the window and call <code>XCompositeRedirectWindow</code>;    </p>\n\n<pre><code>void getScreen2(const int xx, const int yy, const int W, const int H,\n        const XID xid) {\n\n    Display *display = XOpenDisplay(NULL);\n    Window root = DefaultRootWindow(display);\n\n    // turn on --sync to force error on correct method\n    //https://www.x.org/releases/X11R7.6/doc/man/man3/XSynchronize.3.xhtml\n    XSynchronize(display, True);\n\n    int counter = 1;\n\n    // select which xid to operate on, the winder or its parent\n    //XID xwid = fparent;\n    XID xwid = xid;\n\n    // Requests the X server to direct the hierarchy starting at window to off-screen storage\n    XCompositeRedirectWindow(display, xwid, CompositeRedirectAutomatic);\n\n    XWindowAttributes attr;\n    Status status = XGetWindowAttributes(display, xwid, &amp;attr);\n\n    int width = attr.width;\n    int height = attr.height;\n    int depth = attr.depth;\n\n    Pixmap xc_pixmap = XCompositeNameWindowPixmap(display, xwid);\n    if (!xc_pixmap) {\n        printf(\"xc_pixmap not found\\n\");\n    }\n\n    //XWriteBitmapFile(display, \"test1.xpm\", pixmap, W, H, -1, -1);\n\n    XRenderPictFormat *format = XRenderFindVisualFormat(display, attr.visual);\n\n    XRenderPictureAttributes pa;\n\n    pa.subwindow_mode = IncludeInferiors;\n\n    Picture picture = XRenderCreatePicture(display, xwid, format,\n    CPSubwindowMode, &amp;pa);\n\n    char buffer[50];\n    int n;\n    int file_counter = 1;\n\n    n = sprintf(buffer, \"/tmp/%d_test%d.xpm\", xid, file_counter++);\n    XWriteBitmapFile(display, buffer, xc_pixmap, W, H, -1, -1);\n\n    n = sprintf(buffer, \"/tmp/%d_test%d.xpm\", xid, file_counter++);\n    XWriteBitmapFile(display, buffer, xid, W, H, -1, -1);\n\n    XImage *image = XGetImage(display, xid, 0, 0, W, H, AllPlanes, ZPixmap);\n    if (!image) {\n        printf(\"XGetImage failed\\n\");\n    }\n\n    char filename[255];\n    int n2;\n\n    n2 = sprintf(filename, \"/tmp/png_out/%d_test%d.png\", xid, file_counter++);\n\n    printf(\"filename %s \\n\", filename);\n    write_png_for_image(image, xid, W, H, filename);\n\n    //XFree(image);\n    XDestroyImage(image);\n    XDestroyWindow(display, root);\n    XCloseDisplay(display);\n}\n</code></pre>\n\n<p>and then this to write out the png;   </p>\n\n<pre><code>void write_png_for_image(XImage *image, XID xid, int width, int height,\n        char *filename) {\n\n    int code = 0;\n    FILE *fp;\n    png_structp png_ptr;\n    png_infop png_info_ptr;\n    png_bytep png_row;\n\n    char buffer[50];\n    int n;\n\n    n = sprintf(buffer, filename, xid);\n\n// Open file\n    fp = fopen(buffer, \"wb\");\n    if (fp == NULL) {\n        fprintf(stderr, \"Could not open file for writing\\n\");\n        code = 1;\n    }\n\n// Initialize write structure\n    png_ptr = png_create_write_struct(PNG_LIBPNG_VER_STRING, NULL, NULL, NULL);\n    if (png_ptr == NULL) {\n        fprintf(stderr, \"Could not allocate write struct\\n\");\n        code = 1;\n    }\n\n// Initialize info structure\n    png_info_ptr = png_create_info_struct(png_ptr);\n    if (png_info_ptr == NULL) {\n        fprintf(stderr, \"Could not allocate info struct\\n\");\n        code = 1;\n    }\n\n// Setup Exception handling\n    if (setjmp(png_jmpbuf (png_ptr))) {\n        fprintf(stderr, \"Error during png creation\\n\");\n        code = 1;\n    }\n\n    png_init_io(png_ptr, fp);\n\n// Write header (8 bit colour depth)\n    png_set_IHDR(png_ptr, png_info_ptr, width, height, 8, PNG_COLOR_TYPE_RGB,\n    PNG_INTERLACE_NONE,\n    PNG_COMPRESSION_TYPE_BASE, PNG_FILTER_TYPE_BASE);\n\n// Set title\n    char *title = \"Screenshot\";\n    if (title != NULL) {\n        png_text title_text;\n        title_text.compression = PNG_TEXT_COMPRESSION_NONE;\n        title_text.key = \"Title\";\n        title_text.text = title;\n        png_set_text(png_ptr, png_info_ptr, &amp;title_text, 1);\n    }\n\n    png_write_info(png_ptr, png_info_ptr);\n\n// Allocate memory for one row (3 bytes per pixel - RGB)\n    png_row = (png_bytep) malloc(3 * width * sizeof(png_byte));\n\n    unsigned long red_mask = image-&gt;red_mask;\n    unsigned long green_mask = image-&gt;green_mask;\n    unsigned long blue_mask = image-&gt;blue_mask;\n\n// Write image data\n//int xxx, yyy;\n    for (int y = 0; y &lt; height; y++) {\n        for (int x = 0; x &lt; width; x++) {\n            unsigned long pixel = XGetPixel(image, x, y);\n            unsigned char blue = pixel &amp; blue_mask;\n            unsigned char green = (pixel &amp; green_mask) &gt;&gt; 8;\n            unsigned char red = (pixel &amp; red_mask) &gt;&gt; 16;\n            png_byte *ptr = &amp;(png_row[x * 3]);\n            ptr[0] = red;\n            ptr[1] = green;\n            ptr[2] = blue;\n        }\n        png_write_row(png_ptr, png_row);\n    }\n\n// End write\n    png_write_end(png_ptr, NULL);\n\n// Free\n    fclose(fp);\n    if (png_info_ptr != NULL)\n        png_free_data(png_ptr, png_info_ptr, PNG_FREE_ALL, -1);\n    if (png_ptr != NULL)\n        png_destroy_write_struct(&amp;png_ptr, (png_infopp) NULL);\n    if (png_row != NULL)\n        free(png_row);\n\n}\n</code></pre>\n\n<p>However when the windows is browser based, the image is mangled like so;\n<a href=\"https://i.stack.imgur.com/Y8HLh.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Y8HLh.png\" alt=\"enter image description here\"></a></p>\n\n<p>Do I need to do something special to get browser windows working?</p>\n\n<p>References;<br>\n<a href=\"https://www.talisman.org/~erlkonig/misc/x11-composite-tutorial/\" rel=\"nofollow noreferrer\">https://www.talisman.org/~erlkonig/misc/x11-composite-tutorial/</a><br>\n<a href=\"https://stackoverflow.com/questions/21512177/get-a-screenshot-of-a-window-that-is-cover-or-not-visible-or-minimized-with-xcom\">Get a screenshot of a window that is cover or not visible or minimized with Xcomposite extension for X11</a>    </p>\n"}, {"tags": ["c++", "c", "performance", "cross-platform", "clock"], "comments": [{"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 2, "creation_date": 1514301679, "post_id": 47980498, "comment_id": 82929503, "body": "Sounds to me like you want <a href=\"http://en.cppreference.com/w/cpp/chrono/steady_clock\" rel=\"nofollow noreferrer\">std::chrono::steady_clock</a>."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 4, "creation_date": 1514301991, "post_id": 47980498, "comment_id": 82929602, "body": "upvote for all the research"}, {"owner": {"reputation": 53, "user_id": 9141743, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B9AU0.png?s=128&g=1", "display_name": "Coroice", "link": "https://stackoverflow.com/users/9141743/coroice"}, "edited": false, "score": 0, "creation_date": 1514302098, "post_id": 47980498, "comment_id": 82929630, "body": "Sounds like it could be what I&#39;m looking for indeed... If I understood the documentation properly, you can set a specific period that&#39;s independent from the CPU&#39;s ticks, is that correct? If it&#39;s the case, then it might just be perfect."}, {"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 2, "creation_date": 1514302230, "post_id": 47980498, "comment_id": 82929687, "body": "<code>std::chrono::steady_clock</code> does not get set to anything. At any given point, it tells you what the value of the clock is. It&#39;s up to you to measure the clock at the beginning and at the end of the interval, and compute the elapsed time accordingly."}, {"owner": {"reputation": 53, "user_id": 9141743, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B9AU0.png?s=128&g=1", "display_name": "Coroice", "link": "https://stackoverflow.com/users/9141743/coroice"}, "edited": false, "score": 0, "creation_date": 1514302882, "post_id": 47980498, "comment_id": 82929906, "body": "Oh, ok then. Thanks for the clarification! But does it risk being affected by the CPU&#39;s frequency or not? This is what I&#39;m worrying about, since I think it could lead to pretty big differences between the wall clock time and the time counted by the clock over more or less long periods (an hour for instance)."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 1, "creation_date": 1514306828, "post_id": 47980498, "comment_id": 82931220, "body": "@Coroice <code>std::chrono::steady_clock</code> is a monotonically increasing clock that is not affected by outside factors like CPU speed or the user adjusting date/time settings or similar - yes."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1514307820, "post_id": 47980498, "comment_id": 82931539, "body": "This is still a <b>C++</b> question with the accepted answer. I have zero idea on how to apply any of this knowledge in my C programs."}, {"owner": {"reputation": 53, "user_id": 9141743, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B9AU0.png?s=128&g=1", "display_name": "Coroice", "link": "https://stackoverflow.com/users/9141743/coroice"}, "edited": false, "score": 0, "creation_date": 1514326854, "post_id": 47980498, "comment_id": 82937602, "body": "Thanks again for the clarification! And I agree it would also be interesting to have the equivalent for a C program, even though I already have the answer for a C++ one. Is <code>clock_gettime()</code> reliable enough (and portable)?"}, {"owner": {"reputation": 29002, "user_id": 2542702, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fW5ka.jpg?s=128&g=1", "display_name": "Z boson", "link": "https://stackoverflow.com/users/2542702/z-boson"}, "edited": false, "score": 0, "creation_date": 1514366394, "post_id": 47980498, "comment_id": 82947328, "body": "<code>omp_get_wtime()</code> is what I normally use."}, {"owner": {"reputation": 53, "user_id": 9141743, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B9AU0.png?s=128&g=1", "display_name": "Coroice", "link": "https://stackoverflow.com/users/9141743/coroice"}, "edited": false, "score": 0, "creation_date": 1514373499, "post_id": 47980498, "comment_id": 82950674, "body": "<code>omp_get_wtime()</code> seems to depend on the wall clock and to have a resolution of a second; it&#39;s good enough in some cases, but not really what I was looking for. Plus it sounds like it could measure the effective execution time, rather than having a duration between two points in time (at the beginning and end of the program respectively). <code>omp_get_wtick()</code> might be better for sub-second precision, but again, is it compatible with auto-overclock?"}, {"owner": {"reputation": 53, "user_id": 9141743, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B9AU0.png?s=128&g=1", "display_name": "Coroice", "link": "https://stackoverflow.com/users/9141743/coroice"}, "edited": false, "score": 0, "creation_date": 1514374025, "post_id": 47980498, "comment_id": 82950926, "body": "Can&#39;t edit the previous post so I have to write a new comment: <code>omp_get_wtick()</code> seems to also have a resolution of a second, so it&#39;s not good for all cases..."}, {"owner": {"reputation": 29002, "user_id": 2542702, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fW5ka.jpg?s=128&g=1", "display_name": "Z boson", "link": "https://stackoverflow.com/users/2542702/z-boson"}, "edited": false, "score": 0, "creation_date": 1514451404, "post_id": 47980498, "comment_id": 82976982, "body": "<code>omp_get_wtime()</code> has a resolution better than a micro second. I don&#39;t know where you got the idea that it has a resolution of second. Actually, it&#39;s just calls other functions. With GCC it calls <code>clock_gettime</code>. It&#39;s implementation defined but it has been precise for me. It&#39;s the most convenient cross platform and cross compiler (GCC, Claing, ICC, MSVC) method of I know to get the wall time. I would not use it for a big project but for small things  (especially on SO ) it works great. I did have one problem with it once though <a href=\"https://stackoverflow.com/a/43277581/2542702\">stackoverflow.com/a/43277581/2542702</a>"}, {"owner": {"reputation": 53, "user_id": 9141743, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B9AU0.png?s=128&g=1", "display_name": "Coroice", "link": "https://stackoverflow.com/users/9141743/coroice"}, "edited": false, "score": 0, "creation_date": 1515160953, "post_id": 47980498, "comment_id": 83206210, "body": "Sorry for the late reply... It&#39;s my bad, I misunderstood the documentation, as it says &quot;Returns a value in seconds of the time elapsed from some point&quot;, but it&#39;s actually a float with a better precision. And <code>clock_gettime</code> seems to work monotonically as well, so auto-OC shouldn&#39;t cause issues... Thanks a lot for the clarification, I&#39;ll keep this function in mind for C projects!"}], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 9141743, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B9AU0.png?s=128&g=1", "display_name": "Coroice", "link": "https://stackoverflow.com/users/9141743/coroice"}, "edited": false, "score": 0, "creation_date": 1514303254, "post_id": 47980690, "comment_id": 82930043, "body": "It looks like both the high-resolution clock and steady clock from the chrono library could be what I need; the only &quot;problem&quot; after that might be the conversion from seconds to minutes and hours. Thank you very much!"}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 2, "creation_date": 1514305290, "post_id": 47980690, "comment_id": 82930718, "body": "The problem with <code>std::chrono::high_resolution_clock</code> vs <code>std::chrono::steady_clock</code> is that the former is not guaranteed to never go backwards in time. The way <i>I</i> read OPs question, they want a steadily increasing clock that&#39;s not affected by the user adjusting the current date/time or CPUs changing frequency etc etc. <code>steady_clock</code> is just that , but <code>high_resolution_clock</code> is not (guaranteed to be)."}, {"owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "reply_to_user": {"reputation": 53, "user_id": 9141743, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B9AU0.png?s=128&g=1", "display_name": "Coroice", "link": "https://stackoverflow.com/users/9141743/coroice"}, "edited": false, "score": 1, "creation_date": 1514306388, "post_id": 47980690, "comment_id": 82931087, "body": "@Coroice the conversion between units of time is simple. See <a href=\"http://en.cppreference.com/w/cpp/chrono/duration/duration_cast\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/chrono/duration/duration_cast</a>"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1514314024, "post_id": 47980690, "comment_id": 82933482, "body": "@JesperJuhl like I said, on most modern platforms the high resolution clock is monotonically increased (and is in fact synonymous with steady_clock)."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1514314452, "post_id": 47980690, "comment_id": 82933657, "body": "@SergeyA sure, but that is not guaranteed. If you want a <i>guaranteed</i> monotonically increasing clock, then <code>std::steady_clock</code> is what you want."}, {"owner": {"reputation": 177852, "user_id": 576911, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2a2941970f141aad669d13375dc57c4f?s=128&d=identicon&r=PG", "display_name": "Howard Hinnant", "link": "https://stackoverflow.com/users/576911/howard-hinnant"}, "edited": false, "score": 2, "creation_date": 1514314476, "post_id": 47980690, "comment_id": 82933667, "body": "gcc aliases <code>high_resolution_clock</code> to <code>system_clock</code>.  Everyone else (libc++ / VS) aliases it to <code>steady_clock</code>.  I recommend choosing either <code>system_clock</code> or <code>steady_clock</code> in order to make code more portable.  <code>system_clock</code> is good if you need to relate a time to a human calendar (i.e. a wall clock).  <code>steady_clock</code> is good if you need only durations between two time points and/or a guarantee that time advances monotonically (i.e. a stopwatch)."}, {"owner": {"reputation": 53, "user_id": 9141743, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B9AU0.png?s=128&g=1", "display_name": "Coroice", "link": "https://stackoverflow.com/users/9141743/coroice"}, "edited": false, "score": 0, "creation_date": 1514326356, "post_id": 47980690, "comment_id": 82937457, "body": "It looks like I might not need the extra precision of <code>std::chrono::high_resolution_clock</code>, plus it <i>might</i> have side-effects (even though likely negligible, but still), so I think I am going to stick with <code>steady_clock</code>. The assisted conversion is nice to have, though. Thanks for the extra info!"}], "tags": [], "owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "is_accepted": true, "score": 2, "last_activity_date": 1514302682, "creation_date": 1514302682, "answer_id": 47980690, "question_id": 47980498, "link": "https://stackoverflow.com/questions/47980498/accurate-c-c-clock-on-a-multi-core-processor-with-auto-overclock/47980690#47980690", "title": "Accurate C/C++ clock on a multi-core processor with auto-overclock?", "body": "<p>The <code>std::chrono::high_resolution_clock</code> seems to be what you are looking for. On most modern CPUs it is going to be steady monotonically increased clock which would not be affected by overclocking of the CPU.</p>\n\n<p>Just keep in mind that it can't be used to tell time. It is only good for telling the time intervals, which is a great difference. For example:</p>\n\n<pre><code>using clock = std::chrono::high_resolution_clock;\nauto start = clock::now();\nperform_operation();\nauto end = clock::now();\nauto us = std::chrono::duration_cast&lt;std::chrono::microseconds&gt;(end - start).count();\nstd::cout &lt;&lt; \"Operation took \" &lt;&lt; us &lt;&lt; \" microseconds.\\n\";\n</code></pre>\n\n<p>If the clock checking itself is a performance-sensitive operation, you will have to resort to platform-specific tricks, of which the most popular is reading CPU tick counter directly (<code>RDTSC</code> in Intel family). This is very fast, and on modern CPUs very accurate way of measuring time intervals.</p>\n"}], "owner": {"reputation": 53, "user_id": 9141743, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B9AU0.png?s=128&g=1", "display_name": "Coroice", "link": "https://stackoverflow.com/users/9141743/coroice"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1378, "favorite_count": 1, "accepted_answer_id": 47980690, "answer_count": 1, "score": 5, "last_activity_date": 1514377243, "creation_date": 1514301511, "last_edit_date": 1514377243, "question_id": 47980498, "link": "https://stackoverflow.com/questions/47980498/accurate-c-c-clock-on-a-multi-core-processor-with-auto-overclock", "title": "Accurate C/C++ clock on a multi-core processor with auto-overclock?", "body": "<p>I have looked into several topics to try to get some ideas on how to make a reliable clock with C or C++. However, I also saw some functions used the processor's ticks and ticks per second to calculate the end result, which I think could be a problem on a CPU with auto-overclock like the one I have. I also saw one of them reset after a while, thus is not really reliable.</p>\n\n<p>The idea is to make a (preferably cross-platform) clock like an in-game one, with a precision better than a second in order to be able to add the elapsed time in the \"current session\" with the saved time at the end of the program. This would be to count the time spent on a console game that does not have an in-game clock, and on the long run to perhaps integrate it to actual PC games.</p>\n\n<p>It should be able to run without taking too much or all of the CPU's time (or a single core's time for multi-core CPUs) as it would be quite bad to use all these resources just for the clock, and also on systems with auto-overclock (which could otherwise cause inaccurate results).</p>\n\n<p>The program I would like to implement this feature into currently looks like this, but I might re-code it in C (since I have to get back to learning how to code in C++):</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;cstdlib&gt;\n\nusing namespace std;\n\nint main()\n{\n    cout &lt;&lt; \"In game\" &lt;&lt; endl;\n    system(\"PAUSE\");\n    return 0;\n}\n</code></pre>\n\n<p>On a side-note, I still need to get rid of the PAUSE feature which is Windows-specific, but I think that can be taken care of with a simple \"while (char != '\\n')\" loop.</p>\n\n<p>What I have already skimmed through:</p>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/questions/12743063/using-clock-to-measure-execution-time\">Using clock() to measure execution time</a></li>\n<li><a href=\"https://stackoverflow.com/questions/1468596/calculating-elapsed-time-in-a-c-program-in-milliseconds\">Calculating elapsed time in a C program in milliseconds</a></li>\n<li><a href=\"https://stackoverflow.com/questions/1444428/time-stamp-in-the-c-programming-language/1445808#1445808\">Time stamp in the C programming language</a></li>\n<li><a href=\"https://stackoverflow.com/questions/5248915/execution-time-of-c-program\">Execution time of C program</a></li>\n<li><a href=\"https://stackoverflow.com/questions/2962785/c-using-clock-to-measure-time-in-multi-threaded-programs\">C: using clock() to measure time in multi-threaded programs</a></li>\n<li><a href=\"https://stackoverflow.com/questions/88/is-gettimeofday-guaranteed-to-be-of-microsecond-resolution\">Is gettimeofday() guaranteed to be of microsecond resolution?</a></li>\n<li><a href=\"https://stackoverflow.com/questions/361363/how-to-measure-time-in-milliseconds-using-ansi-c/37920181#37920181\">How to measure time in milliseconds using ANSI C?</a></li>\n<li><a href=\"https://stackoverflow.com/questions/1487695/c-cross-platform-high-resolution-timer\">C++ Cross-Platform High-Resolution Timer</a></li>\n<li><a href=\"https://stackoverflow.com/questions/275004/timer-function-to-provide-time-in-nano-seconds-using-c\">Timer function to provide time in nano seconds using C++</a></li>\n<li><a href=\"https://stackoverflow.com/questions/17502263/how-to-measure-cpu-time-and-wall-clock-time\">How to measure cpu time and wall clock time?</a></li>\n<li><a href=\"https://stackoverflow.com/questions/17432502/how-can-i-measure-cpu-time-and-wall-clock-time-on-both-linux-windows\">How can I measure CPU time and wall clock time on both Linux/Windows?</a></li>\n<li><a href=\"https://stackoverflow.com/questions/23186287/how-to-measure-time\">how to measure time?</a></li>\n<li><a href=\"https://stackoverflow.com/questions/16299029/resolution-of-stdchronohigh-resolution-clock-doesnt-correspond-to-measureme\">resolution of std::chrono::high_resolution_clock doesn&#39;t correspond to measurements</a></li>\n<li><a href=\"https://stackoverflow.com/questions/46624865/c-how-to-make-timer-accurate-in-linux\">C++ How to make timer accurate in Linux</a></li>\n<li><a href=\"http://gameprogrammingpatterns.com/game-loop.html\" rel=\"nofollow noreferrer\">http://gameprogrammingpatterns.com/game-loop.html</a></li>\n<li><a href=\"https://stackoverflow.com/questions/7286787/clock-accuracy\">clock() accuracy</a></li>\n<li><a href=\"https://stackoverflow.com/questions/46567615/stdchrono-doesnt-seem-to-be-giving-accurate-clock-resolution-frequency\">std::chrono doesn&#39;t seem to be giving accurate clock resolution/frequency</a></li>\n<li><a href=\"https://stackoverflow.com/questions/35592502/clock-function-in-c-with-threads\">clock function in C++ with threads</a></li>\n</ul>\n\n<p>(Edit: Extra research, in particular for a C implementation:</p>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/questions/29261814/cross-platform-c-high-precision-event-timer-implementation\">Cross platform C++ High Precision Event Timer implementation</a> (no real answer)</li>\n<li><a href=\"https://stackoverflow.com/questions/13610471/calculating-function-time-in-nanoseconds-in-c-code\">Calculating Function time in nanoseconds in C code</a> (Windows)</li>\n<li><a href=\"https://stackoverflow.com/questions/16275444/how-to-print-time-difference-in-accuracy-of-milliseconds-and-nanoseconds\">How to print time difference in accuracy of milliseconds and nanoseconds?</a> (could be the best answer for a C implementation)</li>\n<li><a href=\"https://stackoverflow.com/questions/14391327/how-to-get-duration-as-int-millis-and-float-seconds-from-chrono\">How to get duration, as int milli&#39;s and float seconds from &lt;chrono&gt;?</a> (C++ again) )</li>\n</ul>\n\n<p>The problem is that it is not clear whether some of the mentioned methods, like Boost or SDL2, behave properly with auto-overclock in particular.</p>\n\n<p><strong>TL;DR</strong> : What cross-platform function should I use to make an accurate, sub-second precise counter in C/C++ that could work on multi-core and/or auto-overclocking processors please?</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["c", "struct", "realloc"], "answers": [{"comments": [{"owner": {"reputation": 175, "user_id": 6906311, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/d14582c9b363d020ec12f6a14a106516?s=128&d=identicon&r=PG&f=1", "display_name": "Konstantinos Kosyfarinis", "link": "https://stackoverflow.com/users/6906311/konstantinos-kosyfarinis"}, "edited": false, "score": 0, "creation_date": 1514301945, "post_id": 47980480, "comment_id": 82929585, "body": "Basically what I am trying to use realloc() for a pointer that is inside a struct"}, {"owner": {"reputation": 3699, "user_id": 375399, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/2ee1c857b767375e1fc848279f64584b?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/375399/nick"}, "reply_to_user": {"reputation": 175, "user_id": 6906311, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/d14582c9b363d020ec12f6a14a106516?s=128&d=identicon&r=PG&f=1", "display_name": "Konstantinos Kosyfarinis", "link": "https://stackoverflow.com/users/6906311/konstantinos-kosyfarinis"}, "edited": false, "score": 0, "creation_date": 1514556668, "post_id": 47980480, "comment_id": 83016883, "body": "Well the <code>-&gt;</code> operator already dereferences the <code>struct StudentDB* Database</code>."}], "tags": [], "owner": {"reputation": 3699, "user_id": 375399, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/2ee1c857b767375e1fc848279f64584b?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/375399/nick"}, "is_accepted": false, "score": 4, "last_activity_date": 1514301703, "last_edit_date": 1514301703, "creation_date": 1514301372, "answer_id": 47980480, "question_id": 47980403, "link": "https://stackoverflow.com/questions/47980403/c-crashing-when-using-realloc-on-a-pointer-inside-a-struct/47980480#47980480", "title": "C - Crashing when using Realloc on a Pointer inside a Struct", "body": "<p>You're two code blocks have differing lines. One of which (the larger one) is incorrect. You are passing in a dereference to the <code>student</code> pointer? That's not needed, just pass the pointer itself.</p>\n\n<pre><code>database-&gt;student = realloc(&amp;database-&gt;student, 10);\n</code></pre>\n\n<p>Should be:</p>\n\n<pre><code>database-&gt;student = realloc(database-&gt;student, 10);\n</code></pre>\n\n<p>You are also not passing in a realistic size, but your first code sample was. Does the following line not work?</p>\n\n<pre><code>database-&gt;students = realloc(database-&gt;students, (database-&gt;numberOfStudents + 1) * sizeof(Student));\n</code></pre>\n\n<p>That was just copied from your question. I'm confused as to what you have/have not tried and which one gives you the error.</p>\n\n<p>Also, in the future provide more of a <a href=\"https://stackoverflow.com/help/mcve\">minimal example</a> that still produces the error. There's also a chance you would figure out the issue while stripping the code down.</p>\n"}, {"comments": [{"owner": {"reputation": 175, "user_id": 6906311, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/d14582c9b363d020ec12f6a14a106516?s=128&d=identicon&r=PG&f=1", "display_name": "Konstantinos Kosyfarinis", "link": "https://stackoverflow.com/users/6906311/konstantinos-kosyfarinis"}, "edited": false, "score": 0, "creation_date": 1514302422, "post_id": 47980629, "comment_id": 82929752, "body": "Thank you! You are right, A pointer to a pointer. Thanks for that, still rather new to C. Will watch out for those in the future!"}], "tags": [], "owner": {"reputation": 17331, "user_id": 8950365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c6ba3b19f86f1bea8cf76e691db4349?s=128&d=identicon&r=PG&f=1", "display_name": "rafix07", "link": "https://stackoverflow.com/users/8950365/rafix07"}, "is_accepted": true, "score": 2, "last_activity_date": 1514302299, "creation_date": 1514302299, "answer_id": 47980629, "question_id": 47980403, "link": "https://stackoverflow.com/questions/47980403/c-crashing-when-using-realloc-on-a-pointer-inside-a-struct/47980629#47980629", "title": "C - Crashing when using Realloc on a Pointer inside a Struct", "body": "<p>What with this line ?</p>\n\n<pre><code> addStudent(studentFile, &amp;database);\n</code></pre>\n\n<p>in <code>run</code> function ? Where pointer to local variable is taken and passed to <code>addStudent</code> function </p>\n\n<pre><code>void run(FILE *studentFile, StudentDB *database) {\n   ...\n   case 3: {\n      addStudent(studentFile, &amp;database);  // &lt;-- get pointer to local variable\n</code></pre>\n\n<p>i think this code cannot work even with Nick's changes without this modification</p>\n\n<pre><code>addStudent(studentFile, database);\n</code></pre>\n"}], "owner": {"reputation": 175, "user_id": 6906311, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/d14582c9b363d020ec12f6a14a106516?s=128&d=identicon&r=PG&f=1", "display_name": "Konstantinos Kosyfarinis", "link": "https://stackoverflow.com/users/6906311/konstantinos-kosyfarinis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 150, "favorite_count": 0, "accepted_answer_id": 47980629, "answer_count": 2, "score": 0, "last_activity_date": 1514302299, "creation_date": 1514300985, "last_edit_date": 1514302006, "question_id": 47980403, "link": "https://stackoverflow.com/questions/47980403/c-crashing-when-using-realloc-on-a-pointer-inside-a-struct", "title": "C - Crashing when using Realloc on a Pointer inside a Struct", "body": "<p>I've been writing a small program that will allow the user to read a file, create a small \"database\" and the ability to create / delete entries, etc. When I try to use the </p>\n\n<pre><code>realloc()\n</code></pre>\n\n<p>function, it crashes.</p>\n\n<p>Not sure if I am doing something wrong, probably am though, since I'm rather new to C.</p>\n\n<p>So, I try to do it this way:</p>\n\n<pre><code>StudentDB database;\n//More code in between, that does include malloc()\ndatabase-&gt;students = realloc(database-&gt;students, (database-&gt;numberOfStudents + 1) * sizeof(Student));\n//It crashes when it gets to that part. \n</code></pre>\n\n<p>What I am trying to do is use the realloc() function for a pointer that's inside a struct.</p>\n\n<p>This is the entire program so far: </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\ntypedef struct Lesson {\n    char *name;\n    int semester;\n    float grade;\n} Lesson;\n\ntypedef struct Student {\n    char *name;\n    char *surname;\n    int id;\n    int numberOfLessons;\n    Lesson *lesson;\n} Student;\n\ntypedef struct Database {\n    int numberOfStudents;\n    Student *student;\n} StudentDB;\n\nstatic int maxNameSize = 100;\nstatic int autoclear = 1;\n\n\nvoid addStudent(FILE *studentFile, StudentDB *database) {\n    database-&gt;numberOfStudents++;\n    printf(\"\\nAdded +1 to number of students\");\n    database-&gt;student = realloc(&amp;database-&gt;student, 10);\n//  \n//  printf(\"Name of the student: \");\n//  scanf(\"%s\", database.student[database.numberOfStudents].name);\n}\n\nvoid clear() {\n    if(autoclear) {\n        system(\"cls\");\n    }\n}\n\nLesson getNextLesson(FILE *studentFile) {\n    Lesson lesson;\n\n    lesson.name = malloc(maxNameSize * sizeof(char));\n    if(!lesson.name) { printf(\"Memory Allocation has failed. Exiting the program!\"); exit(0); }\n    fscanf(studentFile, \"%s\", lesson.name);\n\n    fscanf(studentFile, \"%d\", &amp;lesson.semester);\n\n    fscanf(studentFile, \"%f\", &amp;lesson.grade);\n\n    printf(\"\\n\\t%s %d || %.2f\\n\", lesson.name, lesson.semester, lesson.grade);\n    return lesson;\n}\n\nStudent getNextStudent(FILE *studentFile) {\n    Student student;\n\n    student.name = malloc(maxNameSize * sizeof(char));\n    if(!student.name) { printf(\"Memory Allocation has failed. Exiting the program!\"); exit(0); }\n    fscanf(studentFile, \"%s\", student.name);\n\n    student.surname = malloc(maxNameSize * sizeof(char));\n    if(!student.surname) { printf(\"Memory Allocation has failed. Exiting the program!\"); exit(0); }\n    fscanf(studentFile, \"%s\", student.surname);\n\n    fscanf(studentFile, \"%d\", &amp;student.id);\n\n    fscanf(studentFile, \"%d\", &amp;student.numberOfLessons);\n\n    printf(\"%d || %s %s || %d\\n\", student.id, student.name, student.surname, student.numberOfLessons);\n\n    int lesson;\n\n    student.lesson = malloc(student.numberOfLessons * sizeof(Lesson));\n\n    for(lesson = 0; lesson &lt; student.numberOfLessons; lesson++) {\n        student.lesson[lesson] = getNextLesson(studentFile);\n    }\n    return student;\n}\n\nvoid loadStudents() {\n\n}\n\nvoid run(FILE *studentFile, StudentDB *database) {\n    int answer;\n    do {\n        clear();\n        answer = menu();\n        switch(answer) {\n            case 1: {\n\n                break;\n            }\n            case 2: {\n\n                break;\n            }\n            case 3: {\n                addStudent(studentFile, &amp;database);\n                break;\n            }\n            case 4: {\n\n                break;\n            }\n        }\n    } while(answer &lt; 0 || answer &gt; 9);\n}\n\nint menu() {\n    int answer;\n    printf(\"1. Load students records from file\\n\");\n    printf(\"2. Save students records to file\\n\");\n    printf(\"3. Add a student record\\n\");\n    printf(\"4. Delete a student record by student id\\n\");\n    printf(\"5. Display a student record by student id\\n\");\n    printf(\"6. Display a student record by student surname\\n\");\n    printf(\"7. Display all student records\\n\");\n    printf(\"8. Find the lesson average for all students\\n\");\n    printf(\"9. Exit\\n\");\n\n    printf(\"Enter the number of the thing you would like to do: \");\n//  scanf(\"%d\", &amp;answer);\n    return 3;\n}\n\nvoid programInfo() {\n    printf(\"\\n\\n====================================================\\n\\tProgram Info\\n\\n This program was created by KKosyfarinis\\n\\n KKosyfarinis@uth.gr\\n====================================================\\n\\n\");\n}\n\nvoid readData(FILE *studentFile, StudentDB *db) {\n    int i;\n\n    printf(\"Running the loop\\n\");\n    for(i = 0; i &lt; db-&gt;numberOfStudents; i++) {\n        printf(\"=====================\\n\\n\\tStudent #%d\\n\", i);\n        db-&gt;student[i] = getNextStudent(studentFile);\n        printf(\"\\n\\tCompleted\\n\\n=====================\\n\");\n    }\n\n    clear();\n}\n\nvoid saveStudents() {\n\n}\n\nvoid main() {\n\n    system(\"color 02\");\n    system(\"@echo off\");\n\n    FILE *studentFile;\n    StudentDB database;\n\n    studentFile = fopen(\"students.txt\", \"r+w\");\n\n    int numberOfStudents;\n\n    //Set the number of students\n    fscanf(studentFile, \"%d\", &amp;database.numberOfStudents);\n\n    //Prints the number of students\n    printf(\"Number of students: %d\\n\", database.numberOfStudents);\n\n    //Set the memory allocation\n    database.student = malloc(database.numberOfStudents * sizeof(Student));\n    if(!database.student) {\n        printf(\"The memory allocation has failed. Exiting the program!\");\n        exit(0);\n    }   \n\n    //Read the students\n    readData(studentFile, &amp;database);   \n\n    programInfo();\n    run(studentFile, &amp;database);\n\n}\n</code></pre>\n\n<p>Thanks in advance for any help!</p>\n"}, {"tags": ["c", "unicode", "character"], "comments": [{"owner": {"reputation": 17958, "user_id": 1971013, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/EtqFE.jpg?s=128&g=1", "display_name": "meaning-matters", "link": "https://stackoverflow.com/users/1971013/meaning-matters"}, "edited": false, "score": 0, "creation_date": 1514300298, "post_id": 47980182, "comment_id": 82929023, "body": "StackOverflow is not a programming service. Show code and where you get stuck."}, {"owner": {"reputation": 19, "user_id": 8104471, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-KULraSTJQbc/AAAAAAAAAAI/AAAAAAAAANo/eP7R52RS2vA/photo.jpg?sz=128", "display_name": "joe jordishon", "link": "https://stackoverflow.com/users/8104471/joe-jordishon"}, "reply_to_user": {"reputation": 17958, "user_id": 1971013, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/EtqFE.jpg?s=128&g=1", "display_name": "meaning-matters", "link": "https://stackoverflow.com/users/1971013/meaning-matters"}, "edited": false, "score": 1, "creation_date": 1514300912, "post_id": 47980182, "comment_id": 82929237, "body": "I thought that StackOverflow was not only an online debugger. I didn&#39;t ask to write a code for me, I just asked for a tip to help me continue. I wrote directly my problem instead of letting you to search errors in an incorrect part of my code."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1514316511, "post_id": 47980182, "comment_id": 82934336, "body": "Post more of your idea/problem - else this is too broad.  If only one vowel substitution is possible an <code>if()</code> works fine.  If there are dozens or hundreds of case considerations, then other approaches should be used.  C supports Unicode."}], "answers": [{"comments": [{"owner": {"reputation": 26606, "user_id": 4603670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7eabc1427aa3c8185153cc81978289a?s=128&d=identicon&r=PG&f=1", "display_name": "Barmak Shemirani", "link": "https://stackoverflow.com/users/4603670/barmak-shemirani"}, "edited": false, "score": 1, "creation_date": 1514307477, "post_id": 47980926, "comment_id": 82931445, "body": "Unicode code points have variable length in UTF-8 and UTF-16. They cannot be represented as single byte <code>char</code>, except a small subset of UTF-8. Also, C is a low level language and can easily handle Unicode, even the versions of C which are older than Unicode. But absent any additional information, your suggestion of picking another language probably fits the best."}], "tags": [], "owner": {"reputation": 17958, "user_id": 1971013, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/EtqFE.jpg?s=128&g=1", "display_name": "meaning-matters", "link": "https://stackoverflow.com/users/1971013/meaning-matters"}, "is_accepted": false, "score": 2, "last_activity_date": 1514304444, "last_edit_date": 1514304444, "creation_date": 1514303970, "answer_id": 47980926, "question_id": 47980182, "link": "https://stackoverflow.com/questions/47980182/greek-character-conversion/47980926#47980926", "title": "Greek Character Conversion", "body": "<p>Okay, here's some quick advice. I wouldn't use C <a href=\"https://stackoverflow.com/q/526430/1971013\">because Unicode is not wel supported (yet)</a>.</p>\n\n<p>A better language choice would be Python, Java, ..., anything with good Unicode support.</p>\n\n<p>I'd write a utility that reads from standard input and writes to standard output. This makes it easy to use from the command line and in scripts.</p>\n\n<p>I might be missing something but it's going to be something like this (in pseudo code):</p>\n\n<pre><code>while ((inCharacter = getCharacterFromStandardInput) != EOF\n{\n    switch (inCharacter)\n    {\n        case '\u1ff6': outCharacter = \u03ce; break\n        ...\n    }\n\n    writeCharacterToStandardOutput(outCharacter)\n}\n</code></pre>\n\n<p>You'll also need to select &amp; handle the format: UTF-8/16/32.</p>\n\n<p>That's it. Good luck!</p>\n"}, {"tags": [], "owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "is_accepted": true, "score": 3, "last_activity_date": 1514437099, "creation_date": 1514437099, "answer_id": 48001770, "question_id": 47980182, "link": "https://stackoverflow.com/questions/47980182/greek-character-conversion/48001770#48001770", "title": "Greek Character Conversion", "body": "<p>Assuming you use a sane operating system (meaning, not Windows), this is very easy to achieve using C99/C11 locale and wide character support. Consider <strong>filter.c</strong>:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;locale.h&gt;\n#include &lt;wchar.h&gt;\n#include &lt;stdio.h&gt;\n\nwint_t convert(const wint_t  wc)\n{\n    switch (wc) {\n    case L'\u1ff6': return L'\u1f7d';\n    default:   return wc;\n    }\n}\n\nint main(void)\n{\n    wint_t  wc;\n\n    if (!setlocale(LC_ALL, \"\")) {\n        fprintf(stderr, \"Current locale is unsupported.\\n\");\n        return EXIT_FAILURE;\n    }\n    if (fwide(stdin, 1) &lt;= 0) {\n        fprintf(stderr, \"Standard input does not support wide characters.\\n\");\n        return EXIT_FAILURE;\n    }\n    if (fwide(stdout, 1) &lt;= 0) {\n        fprintf(stderr, \"Standard output does not support wide characters.\\n\");\n        return EXIT_FAILURE;\n    }\n\n    while ((wc = fgetwc(stdin)) != WEOF)\n        fputwc(convert(wc), stdout);\n\n    return EXIT_SUCCESS;\n}\n</code></pre>\n\n<p>The above program reads standard input, converts each <code>\u1ff6</code> into a <code>\u1f7d</code>, and outputs the result. </p>\n\n<p>Note that wide character strings and characters have an <code>L</code> prefix; <code>L'\u1ff6'</code> is a wide character constant. These are only in Unicode if the execution character set (the character set the code is compiled for) is Unicode, and that depends on your development environment. (Fortunately, outside of Windows, UTF-8 is pretty much a standard nowadays -- <a href=\"http://utf8everywhere.org/\" rel=\"nofollow noreferrer\">and that is a good thing</a> -- so code like the above Just Works.)</p>\n\n<p>On POSIXy systems (like Linux, Android, Mac OS, BSDs), you can use the <a href=\"http://man7.org/linux/man-pages/man3/iconv.3.html\" rel=\"nofollow noreferrer\"><code>iconv()</code></a> facilities to convert from any input character set to Unicode, do the conversion there, and finally convert back to any output character set. Unfortunately, the question is not tagged <a href=\"/questions/tagged/posix\" class=\"post-tag\" title=\"show questions tagged &#39;posix&#39;\" rel=\"tag\">posix</a>, so that is outside this particular question.</p>\n\n<p>The above example uses a simple switch/case statement. If there are many replacement pairs, one could use e.g.</p>\n\n<pre><code>typedef struct {\n    wint_t  from;\n    wint_t  to;\n} widepair;\n\nstatic widepair  replace[] = {\n    { L'\u1ff6', L'\u1f7d' },\n    /* Others? */\n};\n#define  NUM_REPLACE  (sizeof replace / sizeof replace[0])\n</code></pre>\n\n<p>and at runtime, sort <code>replace[]</code> (using <code>qsort()</code> and a function that compares the <code>from</code> elements), and use binary search to quickly determine if a wide character is to be replaced (and if so, to which wide character). Because this is a <i>O(log<sub>2</sub>N)</i> operation with <i>N</i> being the number of pairs, and it utilizes cache okay, even thousands of replacement pairs is not a problem this way. (And of course, you can build the replacement array at runtime just as well, even from user input or command-line options.)</p>\n\n<p>For Unicode characters, we could use a <code>uint32_t map_to[0x110000];</code> to directly map each code point to another Unicode code point, but because we do not know whether wide characters are Unicode or not, we cannot do that; we do not know the code range of the wide characters until after compile time. Of course, we can do a multi-stage compilation, where a test program generates the <code>replace[]</code> array shown above, and outputs their codes in decimal; then do some kind of auto-grouping or clustering, for example bit maps or hash tables, to do it \"even faster\".</p>\n\n<p>However, in practice it usually turns out that the I/O (reading and writing the data) takes more real-world time than the conversion itself. Even when the conversion is the bottleneck, the conversion rate is sufficient for most humans. (As an example, when compiling C or C++ code with the GNU utilities, the preprocessor first converts the source code to UTF-8 internally.)</p>\n"}], "owner": {"reputation": 19, "user_id": 8104471, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-KULraSTJQbc/AAAAAAAAAAI/AAAAAAAAANo/eP7R52RS2vA/photo.jpg?sz=128", "display_name": "joe jordishon", "link": "https://stackoverflow.com/users/8104471/joe-jordishon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 168, "favorite_count": 0, "accepted_answer_id": 48001770, "answer_count": 2, "score": 0, "last_activity_date": 1514437099, "creation_date": 1514299818, "question_id": 47980182, "link": "https://stackoverflow.com/questions/47980182/greek-character-conversion", "title": "Greek Character Conversion", "body": "<p>I am trying to make a simple -ancient greek to modern greek- converter, in c, by changing the tones of the vowels. For example, the user types a text in greek which conains the character: \u1ff6 (unicode: U+1FF6), so the program converts it into: \u1f7d (unicode:U+1F7D). Greek are not sopported by c, so I don't know how to make it work. Any ideas? </p>\n"}, {"tags": ["c", "struct", "network-programming"], "comments": [{"owner": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "edited": false, "score": 1, "creation_date": 1514299814, "post_id": 47980134, "comment_id": 82928833, "body": "Because they are macros, which are expanded by the preprocessor to integer literals."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1514299847, "post_id": 47980134, "comment_id": 82928846, "body": "What else would they be? What else did you expect? You <i>do</i> know about symbolic constants and preprocessor macros?"}, {"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 3, "creation_date": 1514302925, "post_id": 47980134, "comment_id": 82929925, "body": "Just an historical artifact, it should have been an enum type.  But early K&amp;R compilers did not yet have support for them.  Sockets are about 1983, being able to count on enum types was 1989.  Also see <a href=\"https://stackoverflow.com/a/4970260/17034\">stackoverflow.com/a/4970260/17034</a>"}], "owner": {"reputation": 382, "user_id": 6467650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/992870038a0b255e16aeb239c06d6233?s=128&d=identicon&r=PG", "display_name": "Anubhav Das", "link": "https://stackoverflow.com/users/6467650/anubhav-das"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 200, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1514299639, "creation_date": 1514299639, "question_id": 47980134, "link": "https://stackoverflow.com/questions/47980134/why-the-af-inet-af-inet6-parameters-are-assigned-to-variables-of-int-type", "title": "Why the AF_INET, AF_INET6 parameters are assigned to variables of int type?", "body": "<p>I understand that this must be an extremely noob question. I've started reading a book on network programming &amp; I came to see that AF_INET, AF_INET6 are being assigned to variables of int type. I just want to know how they yield int values.</p>\n"}, {"tags": ["c", "data-structures", "binary-search-tree"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1514299367, "post_id": 47980061, "comment_id": 82928662, "body": "Somehow, maybe you need to set the <code>free()</code>-d node to <code>NULL</code>, otherewise, you&#39;ll be reading invalid memory."}, {"owner": {"reputation": 2162, "user_id": 7460927, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e2cb217286e43576c51e550e6cc794e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tushar Sharma", "link": "https://stackoverflow.com/users/7460927/tushar-sharma"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1514299439, "post_id": 47980061, "comment_id": 82928685, "body": "@SouravGhosh I tried root=NULL; but same result. How can I check for invalid memory?"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 1, "creation_date": 1514299460, "post_id": 47980061, "comment_id": 82928695, "body": "C uses pass by value...."}, {"owner": {"reputation": 2162, "user_id": 7460927, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e2cb217286e43576c51e550e6cc794e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tushar Sharma", "link": "https://stackoverflow.com/users/7460927/tushar-sharma"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1514299615, "post_id": 47980061, "comment_id": 82928759, "body": "@SouravGhosh oh I see. That means i still have a copy of value and not reference? How can I get one here?Any link to share?"}], "answers": [{"comments": [{"owner": {"reputation": 2162, "user_id": 7460927, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e2cb217286e43576c51e550e6cc794e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tushar Sharma", "link": "https://stackoverflow.com/users/7460927/tushar-sharma"}, "edited": false, "score": 0, "creation_date": 1514302091, "post_id": 47980539, "comment_id": 82929626, "body": "I guess I got your point, and which is absolutely correct here.Great!! let me check with this idea, and I will surely accept the answer. Thanks!!"}, {"owner": {"reputation": 2162, "user_id": 7460927, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e2cb217286e43576c51e550e6cc794e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tushar Sharma", "link": "https://stackoverflow.com/users/7460927/tushar-sharma"}, "edited": false, "score": 0, "creation_date": 1514305645, "post_id": 47980539, "comment_id": 82930836, "body": "Thanks sir that was it.:)"}], "tags": [], "owner": {"reputation": 4590, "user_id": 2879325, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2503121b7e7487cd870c8afe40f0cf21?s=128&d=identicon&r=PG", "display_name": "Ext3h", "link": "https://stackoverflow.com/users/2879325/ext3h"}, "is_accepted": true, "score": 3, "last_activity_date": 1514301779, "creation_date": 1514301779, "answer_id": 47980539, "question_id": 47980061, "link": "https://stackoverflow.com/questions/47980061/delete-a-leaf-node-in-binary-tree/47980539#47980539", "title": "Delete a leaf node in binary tree", "body": "<p><code>free</code> means pretty much \"I swear I will not use the memory any more, it may be free'd or reallocated arbitrarily\".</p>\n\n<p>You are violating that promise. After freeing the memory, you must also forget all references on that address. The parent node still remembers the address where the node used to be, and by chance the memory has not been recycled yet.</p>\n\n<p>You have a typical \"use after free\" error. If you had allocated another node in between, before traversing again, you would have noticed a memory corruption.</p>\n\n<p>You could add one more parameter to your function which points to the pointer in the parent object. That way you can modify the parent.</p>\n\n<p>Or store a reference back to the parent in the node.</p>\n\n<p>Either works.</p>\n"}, {"comments": [{"owner": {"reputation": 2162, "user_id": 7460927, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e2cb217286e43576c51e550e6cc794e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tushar Sharma", "link": "https://stackoverflow.com/users/7460927/tushar-sharma"}, "edited": false, "score": 2, "creation_date": 1514308757, "post_id": 47981656, "comment_id": 82931824, "body": "Thanks that&#39;s what I ended up with. +1"}], "tags": [], "owner": {"reputation": 2988, "user_id": 452414, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rDMfs.png?s=128&g=1", "display_name": "babon", "link": "https://stackoverflow.com/users/452414/babon"}, "is_accepted": false, "score": 2, "last_activity_date": 1514308528, "creation_date": 1514308528, "answer_id": 47981656, "question_id": 47980061, "link": "https://stackoverflow.com/questions/47980061/delete-a-leaf-node-in-binary-tree/47981656#47981656", "title": "Delete a leaf node in binary tree", "body": "<p>One approach would be to pass the pointer to the parent in the recursive call. Something like this:</p>\n\n<pre><code>void deleteNode(struct Nodes *root, struct Nodes *parent, int value){\n\n    // Check if root is null\n\n    if (root == NULL) {\n        return;\n    }\n\n    if ((root-&gt;info == value) &amp;&amp; (root-&gt;left == NULL) &amp;&amp; (root-&gt;right == NULL)) {\n        if (parent-&gt;left-&gt;info == value) {free(parent-&gt;left); parent-&gt;left = NULL;}\n        else {free(parent-&gt;right); parent-&gt;right = NULL;}\n    }\n    else if (root-&gt;info &lt; value) {\n        // check on right\n        deleteNode(root-&gt;right,root, value);\n    }else{\n        // check on left\n        deleteNode(root-&gt;left,root, value);\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 2162, "user_id": 7460927, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e2cb217286e43576c51e550e6cc794e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tushar Sharma", "link": "https://stackoverflow.com/users/7460927/tushar-sharma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2164, "favorite_count": 0, "accepted_answer_id": 47980539, "answer_count": 2, "score": 1, "last_activity_date": 1514308528, "creation_date": 1514299232, "last_edit_date": 1514301126, "question_id": 47980061, "link": "https://stackoverflow.com/questions/47980061/delete-a-leaf-node-in-binary-tree", "title": "Delete a leaf node in binary tree", "body": "<p>i am trying to delete a <code>leaf node</code> from <strong>binary search</strong> tree, and it is not working for me, i debugged the code and, i can't find the issue. I can see flow is going correct, call reaches to <code>leaf node</code> address, and then calls <code>free</code>. But after that when i execute <code>pre-order</code> traversal i see the value is still there.</p>\n\n<p>Binary tree i created(Its a simple one) -: </p>\n\n<pre><code>                           10\n                         /    \\\n                        6      14\n</code></pre>\n\n<p><code>Leaf Node</code> value to be deleted = <code>14</code>; </p>\n\n<p>Before deletion <code>Pre - order</code> traversal result = <code>10-&gt;6-&gt;14</code>. This is printed on my console.    </p>\n\n<p>Code to delete <code>leaf node</code> -: </p>\n\n<pre><code>// Delete a leaf node\n\nvoid deleteNode(struct Nodes * root,int value){\n\n    // Check if root is null\n\n    if (root == NULL) {\n        return;\n    }\n\n    // If no left and right node present, it's a leaf node. Perform delete.\n\n    while (root-&gt;left == NULL &amp;&amp; root-&gt;right == NULL) {\n\n        // Check if value at leaf node is same as value to be deleted. If yes, go inside (if).\n\n        if (root-&gt;info == value) {\n            printf(\"Delete the leaf node \\n\");\n\n            printf(\"delete node address is \\n %p\",root);\n\n            // free the root (which is currently a leaf node)\n            free(root);\n            return;\n        }\n    }\n\n    // keep checking if value to be deleted is on right or left, till a value is found.\n\n    if (root-&gt;info &lt; value) {\n        // Ccheck on right\n        deleteNode(root-&gt;right,value);\n    }else{\n        // check on left\n        deleteNode(root-&gt;left,value);\n    }\n\n}\n</code></pre>\n\n<p>I don't get any <code>errors</code>, so i am not able to guess <strong>root cause</strong>.</p>\n\n<p>After deletion <code>Pre - order</code> traversal result = <code>10-&gt;6-&gt;14</code>. Can anyone help me out? I know i am doing very silly mistake, or my concept is still not crystal clear.Thanks.</p>\n\n<blockquote>\n  <p>Please let me know if any other information is required.</p>\n</blockquote>\n\n<p>Image of output-: You can see I am on correct value, and the address for same.</p>\n\n<p><a href=\"https://i.stack.imgur.com/FmNT0.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/FmNT0.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c", "types", "atomic", "c11"], "comments": [{"owner": {"reputation": 40001, "user_id": 2681632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YnXs3.png?s=128&g=1", "display_name": "Ilja Everil&#228;", "link": "https://stackoverflow.com/users/2681632/ilja-everil%c3%a4"}, "edited": false, "score": 1, "creation_date": 1514301465, "post_id": 47980009, "comment_id": 82929424, "body": "What do you mean by &quot;I noticed atomic functions (ex: atomic_store, atomic_load, atomic_compare_exchange_weak) work without the passed types being _Atomic types&quot;? According to C11 draft for example <a href=\"http://port70.net/~nsz/c/c11/n1570.html#7.17.7.2\" rel=\"nofollow noreferrer\"><code>atomic_load()</code></a> expects a single argument that is a pointer to atomic type."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1514301935, "post_id": 47980009, "comment_id": 82929579, "body": "&quot;throws an error&quot; - what error does it throw?!"}, {"owner": {"reputation": 353, "user_id": 7290419, "user_type": "registered", "accept_rate": 56, "profile_image": "https://lh4.googleusercontent.com/-3qx2L_4dffE/AAAAAAAAAAI/AAAAAAAAARA/ey_BY9GeMKA/photo.jpg?sz=128", "display_name": "Alex Sim", "link": "https://stackoverflow.com/users/7290419/alex-sim"}, "reply_to_user": {"reputation": 40001, "user_id": 2681632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YnXs3.png?s=128&g=1", "display_name": "Ilja Everil&#228;", "link": "https://stackoverflow.com/users/2681632/ilja-everil%c3%a4"}, "edited": false, "score": 0, "creation_date": 1514302571, "post_id": 47980009, "comment_id": 82929799, "body": "@Ilja Everil&#228; I&#39;m passing any kind of pointer to it, still working as it should"}, {"owner": {"reputation": 40001, "user_id": 2681632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YnXs3.png?s=128&g=1", "display_name": "Ilja Everil&#228;", "link": "https://stackoverflow.com/users/2681632/ilja-everil%c3%a4"}, "edited": false, "score": 0, "creation_date": 1514303373, "post_id": 47980009, "comment_id": 82930084, "body": "In C a lot of times things might seem to work, until they don&#39;t, if you invoke UB."}, {"owner": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "edited": false, "score": 0, "creation_date": 1514307118, "post_id": 47980009, "comment_id": 82931327, "body": "Please don&#39;t ask several questions at once, really. This makes useful searching much more difficult. You could even split it up, now, given them useful question titles, and answer them yourself with what you now know from Antti&#39;s answer."}], "answers": [{"tags": [], "owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "is_accepted": true, "score": 4, "last_activity_date": 1514304255, "last_edit_date": 1592644375, "creation_date": 1514302604, "answer_id": 47980678, "question_id": 47980009, "link": "https://stackoverflow.com/questions/47980009/stdatomic-c11-three-questions-about-atomic-types/47980678#47980678", "title": "stdatomic (C11), three questions about _Atomic types", "body": "<p>First question:</p>\n<p><a href=\"http://port70.net/%7Ensz/c/c11/n1570.html#7.17.6p3\" rel=\"nofollow noreferrer\">C11 7.17.6p3</a>:</p>\n<blockquote>\n<p>NOTE The representation of atomic integer types <strong>need not</strong> have the same size as their corresponding regular types. They <strong>should</strong> have the same size whenever possible, as it eases effort required to port existing code.</p>\n</blockquote>\n<p>Second question:</p>\n<p><a href=\"http://port70.net/%7Ensz/c/c11/n1570.html#6.7.2.4p3\" rel=\"nofollow noreferrer\">C11 6.7.2.4p3</a>:</p>\n<blockquote>\n<p><strong>[Constraints]</strong></p>\n<p>3 The type name in an atomic type specifier <strong>shall not refer to</strong> an array type, a function type, an atomic type, or <strong>a qualified type.</strong></p>\n</blockquote>\n<p><code>volatile int</code> is a qualified type. A <strong>shall</strong> in a constraints section is violated, therefore the compiler needs to output a diagnostics message. Beyond that, the behaviour of such a construct is undefined.</p>\n<p>Third question:</p>\n<p><a href=\"http://port70.net/%7Ensz/c/c11/n1570.html#7.17.1p5\" rel=\"nofollow noreferrer\">C11 7.17.1.p5</a>:</p>\n<blockquote>\n<p>5 In the following synopses:</p>\n<ul>\n<li><strong>An <code>A</code> refers to one of the atomic types.</strong></li>\n</ul>\n</blockquote>\n<p>They expect an <code>_Atomic</code> type. You pass in a non-atomic variable, therefore undefined behaviour.</p>\n"}], "owner": {"reputation": 353, "user_id": 7290419, "user_type": "registered", "accept_rate": 56, "profile_image": "https://lh4.googleusercontent.com/-3qx2L_4dffE/AAAAAAAAAAI/AAAAAAAAARA/ey_BY9GeMKA/photo.jpg?sz=128", "display_name": "Alex Sim", "link": "https://stackoverflow.com/users/7290419/alex-sim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1044, "favorite_count": 0, "accepted_answer_id": 47980678, "answer_count": 1, "score": 1, "last_activity_date": 1514304255, "creation_date": 1514298923, "last_edit_date": 1514303156, "question_id": 47980009, "link": "https://stackoverflow.com/questions/47980009/stdatomic-c11-three-questions-about-atomic-types", "title": "stdatomic (C11), three questions about _Atomic types", "body": "<h2>First question</h2>\n\n<p>I found on cppreference</p>\n\n<ul>\n<li><p><code>_Atomic ( type-name )</code>   (since C11)</p>\n\n<p>Use as a type specifier; this designates a new atomic type</p></li>\n<li><p><code>_Atomic type-name</code>   (2) (since C11)</p>\n\n<p>Use as a type qualifier; this designates the atomic version of type-name. In this role, it may be mixed with const, volatile, and restrict), although unlike other qualifiers, the atomic version of type-name may have a different size, alignment, and object representation.</p></li>\n</ul>\n\n<p>So does using <code>_Atomic(int)</code> instead of <code>_Atomic int</code> \n guarantee it to be the same size as <code>int</code> or not?</p>\n\n<h2>Second question</h2>\n\n<p>Using a qualifier inside <code>_Atomic</code>\nEx:</p>\n\n<pre><code>_Atomic(volatile int)\n</code></pre>\n\n<p>Throws an error, but using it like this:</p>\n\n<pre><code>_Atomic(volatile _Atomic(int)*)\n</code></pre>\n\n<p>Does not; is this standard behaviour?</p>\n\n<h2>Last question</h2>\n\n<p>I noticed atomic functions (ex: <code>atomic_store</code>, <code>atomic_load</code>, <code>atomic_compare_exchange_weak</code>) work without the passed types being <code>_Atomic</code> types, and I can still manage race conditions with no problem.\nIs this standard behaviour? Does it have downsides or lead to any error?</p>\n"}, {"tags": ["c", "fseek", "feof"], "comments": [{"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1514298767, "post_id": 47979950, "comment_id": 82928458, "body": "<a href=\"https://stackoverflow.com/q/5431941/905902\">stackoverflow.com/q/5431941/905902</a>"}, {"owner": {"reputation": 439, "user_id": 2878161, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/06c8b670e1ddac2a549dd00cbaf2b873?s=128&d=identicon&r=PG&f=1", "display_name": "Sergey Zykov", "link": "https://stackoverflow.com/users/2878161/sergey-zykov"}, "reply_to_user": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1514299729, "post_id": 47979950, "comment_id": 82928800, "body": "@wildplasser the question you referenced seems to talk about my problem, but the discussion/ answers there are too advanced for me."}, {"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 2, "creation_date": 1514299734, "post_id": 47979950, "comment_id": 82928802, "body": "Uh, guys? Didn&#39;t you jump the gun with that <code>while(!feof())</code>? It&#39;s perfectly appropriate here..."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "reply_to_user": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 0, "creation_date": 1514300137, "post_id": 47979950, "comment_id": 82928963, "body": "@Quentin: the question is indeed different, and feof() <i>could</i> be usable here. But IMO it is either an overly complex way of doing it, or a learning exercise, in which case the other answers could help."}], "answers": [{"comments": [{"owner": {"reputation": 439, "user_id": 2878161, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/06c8b670e1ddac2a549dd00cbaf2b873?s=128&d=identicon&r=PG&f=1", "display_name": "Sergey Zykov", "link": "https://stackoverflow.com/users/2878161/sergey-zykov"}, "edited": false, "score": 0, "creation_date": 1514306415, "post_id": 47979982, "comment_id": 82931098, "body": "Do you no what the motivation for such unintuitive behavior of fseek is?"}, {"owner": {"reputation": 3699, "user_id": 375399, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/2ee1c857b767375e1fc848279f64584b?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/375399/nick"}, "reply_to_user": {"reputation": 439, "user_id": 2878161, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/06c8b670e1ddac2a549dd00cbaf2b873?s=128&d=identicon&r=PG&f=1", "display_name": "Sergey Zykov", "link": "https://stackoverflow.com/users/2878161/sergey-zykov"}, "edited": false, "score": 0, "creation_date": 1514306482, "post_id": 47979982, "comment_id": 82931118, "body": "No, but that sounds like a good SO question."}], "tags": [], "owner": {"reputation": 3699, "user_id": 375399, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/2ee1c857b767375e1fc848279f64584b?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/375399/nick"}, "is_accepted": true, "score": 3, "last_activity_date": 1514298774, "creation_date": 1514298774, "answer_id": 47979982, "question_id": 47979950, "link": "https://stackoverflow.com/questions/47979950/c-strange-behavior-of-feof/47979982#47979982", "title": "C: strange behavior of feof", "body": "<p>From the <a href=\"http://www.cplusplus.com/reference/cstdio/fseek/\" rel=\"nofollow noreferrer\"><code>fseek</code></a> docs:</p>\n\n<blockquote>\n  <p><strong>The end-of-file internal indicator of the stream is cleared after a successful call to this function</strong>, and all effects from previous calls to ungetc on this stream are dropped.</p>\n</blockquote>\n"}], "owner": {"reputation": 439, "user_id": 2878161, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/06c8b670e1ddac2a549dd00cbaf2b873?s=128&d=identicon&r=PG&f=1", "display_name": "Sergey Zykov", "link": "https://stackoverflow.com/users/2878161/sergey-zykov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "closed_date": 1514298856, "accepted_answer_id": 47979982, "answer_count": 1, "score": 0, "last_activity_date": 1514298774, "creation_date": 1514298581, "question_id": 47979950, "link": "https://stackoverflow.com/questions/47979950/c-strange-behavior-of-feof", "closed_reason": "Duplicate", "title": "C: strange behavior of feof", "body": "<p>I am new to C. I have stumbled upon certain behavior of <code>feof</code> I can't explain. Specifically in the code below I create a file, write one byte of information int it, then close and open it again, read the information (my 1 byte) till <code>EOF</code> is reached, then move the current position of the file pointer by <code>0</code> byte (i.e. do not change the current position at all) and suddenly I am not at the <code>EOF</code> any longer. How come? </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdint.h&gt;\ntypedef uint8_t BYTE;\n\nint main(void) {\n    FILE* f = fopen(\"myfile.txt\",\"w\");\n    BYTE b = 0x0000;\n    fwrite(&amp;b,1,1,f);\n    fclose(f);\n    f = fopen(\"myfile.txt\",\"r\");\n    while (!feof(f)){\n        fread(&amp;b,1,1,f);\n    }\n    printf(\"We have reached EOF: %i \\n\",feof(f));\n    fseek(f,0,SEEK_CUR);\n    printf(\"We have reached EOF: %i \\n\",feof(f));\n} \n</code></pre>\n\n<p>Output</p>\n\n<pre><code>We have reached EOF: 1 \nWe have reached EOF: 0 \n</code></pre>\n"}, {"tags": ["c", "linux", "filesystems", "partition", "ext4"], "comments": [{"owner": {"reputation": 53, "user_id": 7501166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67c67d24c2a36f63fccb49d7404e1382?s=128&d=identicon&r=PG&f=1", "display_name": "Rockietto", "link": "https://stackoverflow.com/users/7501166/rockietto"}, "reply_to_user": {"reputation": 2437, "user_id": 734154, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/11a507c170ee137d3c9606dfe744f6db?s=128&d=identicon&r=PG", "display_name": "Anon", "link": "https://stackoverflow.com/users/734154/anon"}, "edited": false, "score": 0, "creation_date": 1514298354, "post_id": 47979775, "comment_id": 82928332, "body": "I&#39;m searching for FileSystem creation datetime. The creation datetime of a file is easily editable."}, {"owner": {"reputation": 1038, "user_id": 600600, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/babddf0b75ed5d21c68a310100e46047?s=128&d=identicon&r=PG", "display_name": "xdebug", "link": "https://stackoverflow.com/users/600600/xdebug"}, "edited": false, "score": 1, "creation_date": 1514298886, "post_id": 47979775, "comment_id": 82928505, "body": "tune2fs supports ext2/ext3/ext4, so you want to know ext filesystem creation datetime ?"}, {"owner": {"reputation": 53, "user_id": 7501166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67c67d24c2a36f63fccb49d7404e1382?s=128&d=identicon&r=PG&f=1", "display_name": "Rockietto", "link": "https://stackoverflow.com/users/7501166/rockietto"}, "reply_to_user": {"reputation": 1038, "user_id": 600600, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/babddf0b75ed5d21c68a310100e46047?s=128&d=identicon&r=PG", "display_name": "xdebug", "link": "https://stackoverflow.com/users/600600/xdebug"}, "edited": false, "score": 0, "creation_date": 1514299059, "post_id": 47979775, "comment_id": 82928555, "body": "Yes. My HardDisk is an ext4."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 2, "creation_date": 1514299459, "post_id": 47979775, "comment_id": 82928694, "body": "On most Unix filesystems  you can&#39;t; there is only {ctime,mtime,atime} And ctime is not time_of_creation, but time_of_change of inode attributes (such as rwx)"}, {"owner": {"reputation": 7668, "user_id": 2554472, "user_type": "registered", "profile_image": "https://graph.facebook.com/1119155584/picture?type=large", "display_name": "Mark Plotnick", "link": "https://stackoverflow.com/users/2554472/mark-plotnick"}, "edited": false, "score": 1, "creation_date": 1514301603, "post_id": 47979775, "comment_id": 82929479, "body": "Can you clarify your question? Do you want to know the layout of the superblock so that you can extract the <code>s_mkfs_time</code> member? Do you need some sample GPL source code? Some sample non-GPL source code? The part of tune2fs that does what you want is <a href=\"https://github.com/tytso/e2fsprogs/blob/master/lib/e2p/ls.c#L314\" rel=\"nofollow noreferrer\">github.com/tytso/e2fsprogs/blob/master/lib/e2p/ls.c#L314</a>"}, {"owner": {"reputation": 53, "user_id": 7501166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67c67d24c2a36f63fccb49d7404e1382?s=128&d=identicon&r=PG&f=1", "display_name": "Rockietto", "link": "https://stackoverflow.com/users/7501166/rockietto"}, "edited": false, "score": 0, "creation_date": 1514301944, "post_id": 47979775, "comment_id": 82929584, "body": "This GitHub link is what I needed! Thank you! I can&#39;t add you reputation. Make an answer, and I will charge you reputation!"}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1514312494, "post_id": 47979775, "comment_id": 82932977, "body": "Could you motivate your question and explain why you need the creation date of the file system? On some filesystems, that information does not exist! What would you do in such case?"}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1514312657, "post_id": 47979775, "comment_id": 82933039, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/5929419/how-to-get-file-creation-date-in-linux\">How to get file creation date in Linux?</a>"}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1514313852, "post_id": 47979775, "comment_id": 82933416, "body": "Without motivations, your question is unclear, and has no sense on some file systems. What is your program trying to do ?"}], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 7501166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67c67d24c2a36f63fccb49d7404e1382?s=128&d=identicon&r=PG&f=1", "display_name": "Rockietto", "link": "https://stackoverflow.com/users/7501166/rockietto"}, "edited": false, "score": 0, "creation_date": 1514323842, "post_id": 47982223, "comment_id": 82936747, "body": "Thank you for your reply. I will check your samples."}], "tags": [], "owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "is_accepted": true, "score": 2, "last_activity_date": 1514313918, "last_edit_date": 1514313918, "creation_date": 1514312188, "answer_id": 47982223, "question_id": 47979775, "link": "https://stackoverflow.com/questions/47979775/get-filesystem-creation-date-in-c/47982223#47982223", "title": "Get filesystem creation date in C", "body": "<p>From a program coded in C (or in any language capable of calling C routines) you would use the <a href=\"http://man7.org/linux/man-pages/man2/stat.2.html\" rel=\"nofollow noreferrer\">stat(2)</a> system call (or, with <em>recent</em> kernels and <em>some</em> file systems, the <a href=\"http://man7.org/linux/man-pages/man2/statx.2.html\" rel=\"nofollow noreferrer\">statx(2)</a> one) to query the creation time of a given file (or directory). Of course, commands like <a href=\"http://man7.org/linux/man-pages/man1/ls.1.html\" rel=\"nofollow noreferrer\">ls(1)</a> or <a href=\"http://man7.org/linux/man-pages/man1/stat.1.html\" rel=\"nofollow noreferrer\">stat(1)</a> are using internally that <a href=\"http://man7.org/linux/man-pages/man2/stat.2.html\" rel=\"nofollow noreferrer\">stat(2)</a> system calll.</p>\n\n<p>There is no standard, and file system neutral, way to get the creation time of a given <a href=\"https://en.wikipedia.org/wiki/File_system\" rel=\"nofollow noreferrer\">file system</a>. That information is not always kept. I guess that <a href=\"https://en.wikipedia.org/wiki/File_Allocation_Table\" rel=\"nofollow noreferrer\">FAT</a> filesystems, or <a href=\"https://en.wikipedia.org/wiki/Clustered_file_system#Distributed_file_systems\" rel=\"nofollow noreferrer\">distributed file systems</a> such as <a href=\"https://en.wikipedia.org/wiki/Network_File_System\" rel=\"nofollow noreferrer\">NFS</a>, don't keep that.</p>\n\n<p>You might use <a href=\"http://man7.org/linux/man-pages/man2/stat.2.html\" rel=\"nofollow noreferrer\">stat(2)</a> on the mount point of that file system.</p>\n\n<p>The <a href=\"http://man7.org/linux/man-pages/man2/statfs.2.html\" rel=\"nofollow noreferrer\">statfs(2)</a> system call retrieves some filesystem information, but does not give any time stamps.</p>\n\n<p>For ext4 file systems, see <a href=\"http://man7.org/linux/man-pages/man5/ext4.5.html\" rel=\"nofollow noreferrer\">ext4(5)</a> and use <a href=\"http://man7.org/linux/man-pages/man5/ext4.5.html\" rel=\"nofollow noreferrer\">proc(5)</a>. You might parse <code>/proc/mounts</code>  and some <code>/proc/fs/ext4/*/</code> directory. The pseudofiles in <code>/proc/</code> can be <a href=\"https://stackoverflow.com/a/12237783/841108\">parsed quickly</a> and usually won't involve physical disk IO.</p>\n\n<p>You could also work at the ext2/3/4 <a href=\"https://en.wikipedia.org/wiki/Disk_partitioning\" rel=\"nofollow noreferrer\">disk partition</a> level, on an <em>unmounted</em> file <code>ext[234]</code> system, with a library like (or programs from) <a href=\"https://git.kernel.org/pub/scm/fs/ext2/e2fsprogs.git\" rel=\"nofollow noreferrer\">e2fsprogs</a>. You should not access (even just read) a disk partition containing some file system if that file system is mounted.</p>\n\n<p><sup>(your question should give some motivation and context)</sup></p>\n"}], "owner": {"reputation": 53, "user_id": 7501166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67c67d24c2a36f63fccb49d7404e1382?s=128&d=identicon&r=PG&f=1", "display_name": "Rockietto", "link": "https://stackoverflow.com/users/7501166/rockietto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1004, "favorite_count": 0, "accepted_answer_id": 47982223, "answer_count": 1, "score": 0, "last_activity_date": 1514313918, "creation_date": 1514297535, "last_edit_date": 1514308234, "question_id": 47979775, "link": "https://stackoverflow.com/questions/47979775/get-filesystem-creation-date-in-c", "title": "Get filesystem creation date in C", "body": "<p>I need to know the creation datetime of the filesystem on a disk (in a Linux machine) with C. I would like to avoid using shell commands, such as</p>\n\n<pre><code>tune2fs -l /dev/sdb2 | grep 'Filesystem created:' \n</code></pre>\n\n<p>and make a parser.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["c", "gcc"], "comments": [{"owner": {"reputation": 44000, "user_id": 535275, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/Ft2Mw.jpg?s=128&g=1", "display_name": "Scott Hunter", "link": "https://stackoverflow.com/users/535275/scott-hunter"}, "edited": false, "score": 0, "creation_date": 1514296796, "post_id": 47979573, "comment_id": 82927803, "body": "What part of this code is even attempting to &quot;clear&quot; anything?"}, {"owner": {"reputation": 310, "user_id": 6811933, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/1073602816008139/picture?type=large", "display_name": "Kshitij Kumar", "link": "https://stackoverflow.com/users/6811933/kshitij-kumar"}, "edited": false, "score": 0, "creation_date": 1514297937, "post_id": 47979573, "comment_id": 82928154, "body": "I have removed it. It was free(arr); free(newArr); free(newArr2);"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1514306739, "post_id": 47979573, "comment_id": 82931191, "body": "<code>void main()</code> is non-standard, use <code>int main(void)</code>. Never omit <code>#include</code> directives when showing your code to others."}], "answers": [{"comments": [{"owner": {"reputation": 310, "user_id": 6811933, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/1073602816008139/picture?type=large", "display_name": "Kshitij Kumar", "link": "https://stackoverflow.com/users/6811933/kshitij-kumar"}, "edited": false, "score": 0, "creation_date": 1514298055, "post_id": 47979680, "comment_id": 82928218, "body": "But when I read values on those old address, it is showing the same old value. Is it normal? I&#39;ll check few more things."}, {"owner": {"reputation": 310, "user_id": 6811933, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/1073602816008139/picture?type=large", "display_name": "Kshitij Kumar", "link": "https://stackoverflow.com/users/6811933/kshitij-kumar"}, "edited": false, "score": 0, "creation_date": 1514298876, "post_id": 47979680, "comment_id": 82928499, "body": "I was able to handle arr even after reallocating. I changed value, checked address and was able to do everything in runtime."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1514299144, "post_id": 47979680, "comment_id": 82928590, "body": "Max, note that <code>realloc</code> <i>may</i> return a new address, but it doesn&#39;t have to, for example when there was sufficient free memory after the currently allocated memory it will simply expand the allocation. In all cases, it is important to mention that there may be only <i>one</i> call to <code>free</code> to free the memory."}, {"owner": {"reputation": 310, "user_id": 6811933, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/1073602816008139/picture?type=large", "display_name": "Kshitij Kumar", "link": "https://stackoverflow.com/users/6811933/kshitij-kumar"}, "edited": false, "score": 0, "creation_date": 1514299425, "post_id": 47979680, "comment_id": 82928682, "body": "Even after it&#39;s relocating completely to a new address, it is not freeing the old array memory. It&#39;s still accessible and contains value. I think the only way to clear the memory completely is by comparing old and new address and then freeing them accordingly."}, {"owner": {"reputation": 372, "user_id": 9141855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a68f4ad4f0df2aaf0d37f23cf960ce52?s=128&d=identicon&r=PG&f=1", "display_name": "Max Forasteiro", "link": "https://stackoverflow.com/users/9141855/max-forasteiro"}, "edited": false, "score": 0, "creation_date": 1514301269, "post_id": 47979680, "comment_id": 82929357, "body": "<code>The content of the memory block is preserved up to the lesser of the new and old sizes, even if the block is moved to a new location. If the new size is larger, the value of the newly allocated portion is indeterminate. </code> from <a href=\"http://www.cplusplus.com/reference/cstdlib/realloc/\" rel=\"nofollow noreferrer\">cplusplus.com/reference/cstdlib/realloc</a> so, it&#39;s true"}, {"owner": {"reputation": 372, "user_id": 9141855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a68f4ad4f0df2aaf0d37f23cf960ce52?s=128&d=identicon&r=PG&f=1", "display_name": "Max Forasteiro", "link": "https://stackoverflow.com/users/9141855/max-forasteiro"}, "edited": false, "score": 0, "creation_date": 1514301349, "post_id": 47979680, "comment_id": 82929388, "body": "And yes, it not free the old portion of memory (in case of reallocating the portion)"}], "tags": [], "owner": {"reputation": 372, "user_id": 9141855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a68f4ad4f0df2aaf0d37f23cf960ce52?s=128&d=identicon&r=PG&f=1", "display_name": "Max Forasteiro", "link": "https://stackoverflow.com/users/9141855/max-forasteiro"}, "is_accepted": false, "score": 3, "last_activity_date": 1514299054, "last_edit_date": 1514299054, "creation_date": 1514297039, "answer_id": 47979680, "question_id": 47979573, "link": "https://stackoverflow.com/questions/47979573/how-should-i-free-all-memory-created-using-multiple-realloc/47979680#47979680", "title": "How should I free all memory created using multiple realloc?", "body": "<p>From my point of view, when you use malloc or realloc you're changing the memory reference, so, if you call realloc on a variable you are freeing the old space used and allocate new space, copying the old data to the new memory position, so, in your example, <code>arr</code> doesn't hold a valid memory address after first realloc. The same thing happen on <code>newArr</code></p>\n"}, {"comments": [{"owner": {"reputation": 92, "user_id": 2478767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b7beaf4325bd6de377d7cdcdf1b46e5?s=128&d=identicon&r=PG", "display_name": "mar77i", "link": "https://stackoverflow.com/users/2478767/mar77i"}, "edited": false, "score": 0, "creation_date": 1515197391, "post_id": 47980978, "comment_id": 83222829, "body": "Important to add here, I think you missed to point out properly that your pointer does not get <code>free()</code>d if any one call to <code>realloc()</code> failed; that is, if <code>newArr</code> turns out <code>NULL</code>, you have to still <code>free(arr)</code> and if <code>newArr2</code> turns out <code>NULL</code> you have to still <code>free(newArr)</code> respectively."}], "tags": [], "owner": {"reputation": 177, "user_id": 4792805, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uVG93.png?s=128&g=1", "display_name": "Neui", "link": "https://stackoverflow.com/users/4792805/neui"}, "is_accepted": true, "score": 2, "last_activity_date": 1514304284, "creation_date": 1514304284, "answer_id": 47980978, "question_id": 47979573, "link": "https://stackoverflow.com/questions/47979573/how-should-i-free-all-memory-created-using-multiple-realloc/47980978#47980978", "title": "How should I free all memory created using multiple realloc?", "body": "<p><code>realloc</code> is basically <code>malloc</code> with the new size, <code>memmove</code> the data to the new block and <code>free</code> the old one. (But implementation can optimize this process because they've got more information they can use, like just extending the current allocated block, producing the same pointer)</p>\n\n<p>So the pointers <code>arr</code> and <code>newArr</code> are invalid and shouldn't be accessed anymore because they might have been <code>free</code>d, so the pointer in <code>newArr2</code> is the current one and valid, if the previous allocations didn't fail. So <code>free(newArr2)</code> is the correct answer.</p>\n\n<p>Sure, you might access the memory from the old pointers, but it isn't guaranteed because it might've been allocated and overwritten for a different purpose or you might just be lucky to get the same pointer back from <code>realloc</code> (because from eg. the optimization above). It's just undefined behavior when accessing <code>free</code>d memory.</p>\n\n<p><sub><a href=\"https://www.reddit.com/r/C_Programming/comments/7m8d3x/how_to_release_memory_allocated_with_multiple/drs1wbc/\" rel=\"nofollow noreferrer\">Source on reddit</a></sub></p>\n"}], "owner": {"reputation": 310, "user_id": 6811933, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/1073602816008139/picture?type=large", "display_name": "Kshitij Kumar", "link": "https://stackoverflow.com/users/6811933/kshitij-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 387, "favorite_count": 0, "accepted_answer_id": 47980978, "answer_count": 2, "score": -1, "last_activity_date": 1514304284, "creation_date": 1514296478, "last_edit_date": 1514298703, "question_id": 47979573, "link": "https://stackoverflow.com/questions/47979573/how-should-i-free-all-memory-created-using-multiple-realloc", "title": "How should I free all memory created using multiple realloc?", "body": "<p>I created array with 10 integer size using malloc. I added values to the elements. Then, I reallocated it to 200 bytes into newArr. And then I reallocated newArr into newArr2 with size of 10 integers again. Code:</p>\n\n<pre><code>void main(){\n\n    int i, *arr = (int *)malloc(10* sizeof(int));\n\n    for(i=0; i&lt;10; i++){\n        arr[i] = i;\n    }\n\n    int *newArr = (int *)realloc(arr, 200);\n\n    int *newArr2 = (int *)realloc(newArr, 10* sizeof(int));\n\n}\n</code></pre>\n\n<p>How should I use free to remove all the allocated memory here? I'm getting error while clearing all of them.</p>\n\n<p>Edit: As per the accepted answer the old memory should've been cleared but it didn't. I was able to access memory and was able to change value on old address. </p>\n"}, {"tags": ["c", "linux"], "owner": {"reputation": 165, "user_id": 4601945, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72cbcc787034a74e7c84f1cf69a296f5?s=128&d=identicon&r=PG&f=1", "display_name": "valentin", "link": "https://stackoverflow.com/users/4601945/valentin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 188, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1514291355, "creation_date": 1514291355, "question_id": 47978690, "link": "https://stackoverflow.com/questions/47978690/how-to-manage-both-sockets-and-semaphores-in-a-single-thread", "title": "How to manage both sockets and semaphores in a single thread", "body": "<p>I want to use a single thread to process socket incoming data and do some actions when the semaphore gets unlocked. According to this thread</p>\n\n<p><a href=\"https://stackoverflow.com/questions/4335667/can-we-obtain-a-file-descriptor-for-a-semaphore-or-condition-variable\">Can we obtain a file descriptor for a semaphore or condition variable?</a></p>\n\n<p>I can't use the select system call for this. Now I'm trying something like this using signals instead of select(). But I can't get rid of possible race conditions.</p>\n\n<pre><code>static int         dataReady;  // Socket data ready flag\nstatic int         fd;         // Socket file descriptor\nstatic int32*      pldSemId;   // Semaphore identifier\n\nvoid sigioHandler(int /* sig */){\n    dataReady = 1;\n}\n\nvoid tryReceiveData(){\n    disableSignals();\n    int  len;\n    char buf[8192];\n\n    struct sockaddr_nl sourceaddr;\n    struct iovec iov = { buf, sizeof(buf) };\n    struct msghdr msg;\n    struct nlmsghdr *nh;\n\n    if (!dataReady){\n        enableSignals();\n        return;\n    }\n\n    msg = { &amp;sourceaddr, sizeof(sourceaddr), &amp;iov, 1, NULL, 0, 0 };\n    len = recvmsg(fd, &amp;msg, MSG_DONTWAIT);\n    ...        \n\n    dataReady = 0;\n    enableSignals();\n}\n\nvoid doSemaphoreActions(){\n    int r;\n    sops.sem_num = 0;\n    sops.sem_op = -1;\n    sops.sem_flg = 0; // wait and blocked\n\n    if (semop(*pldSemId, &amp;sops, 1) == -1) {\n        if (errno == EINTR){\n            return;\n        }\n        // Process other possible errors\n        ...\n    }\n\n    // Do something useful\n    ...\n}\n\nint main(){\n    // Open and configure the socket\n    fd = socket(...);\n    ...\n    // Configure the signal handler\n    signal(SIGIO, sigioHandler);\n    fcntl(fd, F_SETOWN, getpid());\n    fcntl(fd, F_SETFL, O_ASYNC);\n\n    // Configure the semaphore\n    ...\n\n    while (true){\n        tryReceiveData();\n        // SIGIO signal may be received here so we won't\n        // process socket data until the next SIGIO arrives\n        // or the semaphore gets unlocked\n        doSemaphoreActions();\n    }\n}\n</code></pre>\n\n<p>Is there a way to disable signal handlers when the thread is in the \"running\" state? Or maybe there is a better solution?</p>\n"}, {"tags": ["c", "string", "text-files", "stdio"], "comments": [{"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 3, "creation_date": 1514291564, "post_id": 47978599, "comment_id": 82926029, "body": "<code>!= EOF</code> --&gt; <code>== 4</code> Then you would have found the problem immediately."}, {"owner": {"reputation": 79, "user_id": 8919391, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Enipq.jpg?s=128&g=1", "display_name": "lefrost", "link": "https://stackoverflow.com/users/8919391/lefrost"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1514291733, "post_id": 47978599, "comment_id": 82926086, "body": "@4386427 By doing this the program outputs... nothing. I don&#39;t understand?"}, {"owner": {"reputation": 17958, "user_id": 1971013, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/EtqFE.jpg?s=128&g=1", "display_name": "meaning-matters", "link": "https://stackoverflow.com/users/1971013/meaning-matters"}, "edited": false, "score": 0, "creation_date": 1514291780, "post_id": 47978599, "comment_id": 82926108, "body": "That&#39;s because it only scans <code>id</code> and <code>name</code>; see my answer below."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1514292211, "post_id": 47978599, "comment_id": 82926268, "body": "Exactly - it would print nothing and therefore you would know that there was some problem with the <code>fscanf</code>"}, {"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 0, "creation_date": 1514292687, "post_id": 47978599, "comment_id": 82926414, "body": "The idea is that checking actual against expected number of arguments gives you the chance to print an error message. <code>fscanf</code> itself does not give an error, because this way a program <i>might</i> be able to continue. In your case, however, there is no point in trying to."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1514295033, "post_id": 47978599, "comment_id": 82927211, "body": "it is a poor programming practice to include header files those contents are not being used.  Suggest removing the statement: <code>#include &lt;string.h&gt;</code>"}, {"owner": {"reputation": 79, "user_id": 8919391, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Enipq.jpg?s=128&g=1", "display_name": "lefrost", "link": "https://stackoverflow.com/users/8919391/lefrost"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1514341486, "post_id": 47978599, "comment_id": 82940165, "body": "@user3629249 Understood, removed from this question."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1514343668, "post_id": 47978599, "comment_id": 82940515, "body": "one item you seem to misunderstand.  this:  <code>%[^\\n]</code>  is a complete input/format specifier.  So any character following that, in the format string, must actually be in the input stream.  So this: <code>%[\\n]s</code>  will never progress beyond the encounter with &#39;\\n&#39; so the next character will NEVER be <code>s</code> (it will be the white space: newline)"}], "answers": [{"comments": [{"owner": {"reputation": 17958, "user_id": 1971013, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/EtqFE.jpg?s=128&g=1", "display_name": "meaning-matters", "link": "https://stackoverflow.com/users/1971013/meaning-matters"}, "reply_to_user": {"reputation": 79, "user_id": 8919391, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Enipq.jpg?s=128&g=1", "display_name": "lefrost", "link": "https://stackoverflow.com/users/8919391/lefrost"}, "edited": false, "score": 2, "creation_date": 1514291515, "post_id": 47978655, "comment_id": 82926002, "body": "If it&#39;s always two words: <code>%s %s</code>, but if that&#39;s not the case (what I guess), you&#39;d need to redesign the format and add a delimiter (e.g. <code>,</code>) after the name part. Or you could scan until you see a free standing <code>F</code> or <code>M</code>; but that&#39;s a hack because some names might have that. Well, you could scan for the last occurrence of <code>F</code> or <code>M</code>, before you see a number; that would be acceptable, yet still a bit hacky."}, {"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "reply_to_user": {"reputation": 79, "user_id": 8919391, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Enipq.jpg?s=128&g=1", "display_name": "lefrost", "link": "https://stackoverflow.com/users/8919391/lefrost"}, "edited": false, "score": 1, "creation_date": 1514291694, "post_id": 47978655, "comment_id": 82926070, "body": "@Ryan: if the last 2 items are always there, perhaps you can clip them off and parse separately \u2013 say, using <code>strrchr</code> to locate the last space character. (There are multiple ways to do this.) That way, everything left after the first item is a name."}, {"owner": {"reputation": 79, "user_id": 8919391, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Enipq.jpg?s=128&g=1", "display_name": "lefrost", "link": "https://stackoverflow.com/users/8919391/lefrost"}, "edited": false, "score": 0, "creation_date": 1514292645, "post_id": 47978655, "comment_id": 82926401, "body": "@meaning-matters If I were to use delimiters, say <code>|</code>, to separate each variable in the text file, how would I fscanf it then? Would it be <code>%[^|] %[^|] %c %[^|]</code>..? I don&#39;t really understand how to scan it."}, {"owner": {"reputation": 79, "user_id": 8919391, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Enipq.jpg?s=128&g=1", "display_name": "lefrost", "link": "https://stackoverflow.com/users/8919391/lefrost"}, "reply_to_user": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 0, "creation_date": 1514293132, "post_id": 47978655, "comment_id": 82926546, "body": "@usr2564301 So if I were to use <code>strrchr</code>, how would my <code>fscanf</code> be like then? I tried <code>%s %[^\\n]s strrchr(%c) strrchr(%s)</code> and I got the same result as previously. I&#39;m probably using <code>strrchr</code> completely wrongly here... how exactly am I supposed to use it here?"}, {"owner": {"reputation": 17958, "user_id": 1971013, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/EtqFE.jpg?s=128&g=1", "display_name": "meaning-matters", "link": "https://stackoverflow.com/users/1971013/meaning-matters"}, "reply_to_user": {"reputation": 79, "user_id": 8919391, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Enipq.jpg?s=128&g=1", "display_name": "lefrost", "link": "https://stackoverflow.com/users/8919391/lefrost"}, "edited": false, "score": 1, "creation_date": 1514294569, "post_id": 47978655, "comment_id": 82927004, "body": "@Ryan With <code>|</code> as delimiters, you better write a custom scanner: Skip leading space, copy characters to token buffer until next <code>|</code>, remove trailing space from token buffer, assign token value to variable (depending on state, i.e. where you are on the line), clear token buffer, and start again."}], "tags": [], "owner": {"reputation": 17958, "user_id": 1971013, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/EtqFE.jpg?s=128&g=1", "display_name": "meaning-matters", "link": "https://stackoverflow.com/users/1971013/meaning-matters"}, "is_accepted": false, "score": 3, "last_activity_date": 1514291809, "last_edit_date": 1514291809, "creation_date": 1514291187, "answer_id": 47978655, "question_id": 47978599, "link": "https://stackoverflow.com/questions/47978599/after-reading-from-text-file-results-are-displayed-incorrectly/47978655#47978655", "title": "After reading from text file, results are displayed incorrectly", "body": "<p><code>%[^\\n]s</code> eats up everything from that point on and puts it in <code>name</code>. So only <code>id</code> and <code>name</code> are filled. <code>gender</code> and <code>contact</code> have 'random' contents coming from the program stack (as they are not initialized).</p>\n\n<p>By accident the your stack had <code>1/4</code> in <code>gender</code> + <code>contact</code>.</p>\n\n<p>On my machine, the program crashes.</p>\n"}, {"comments": [{"owner": {"reputation": 151, "user_id": 2110337, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d0bca9eb0936c1b5b6ac54554ffdda8?s=128&d=identicon&r=PG", "display_name": "Sudhee", "link": "https://stackoverflow.com/users/2110337/sudhee"}, "edited": false, "score": 0, "creation_date": 1514297575, "post_id": 47979411, "comment_id": 82928047, "body": "+1 for clean readable code and explanation. One doubt, Is there any way<code>%5s</code> be replaced w.r.t the enum <code>MAX_ID_LEN</code> ? Say - for some reason, the id length is changed, you have to modify in 2 places to make it work."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "reply_to_user": {"reputation": 151, "user_id": 2110337, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d0bca9eb0936c1b5b6ac54554ffdda8?s=128&d=identicon&r=PG", "display_name": "Sudhee", "link": "https://stackoverflow.com/users/2110337/sudhee"}, "edited": false, "score": 0, "creation_date": 1514318953, "post_id": 47979411, "comment_id": 82935170, "body": "@Sudhee, it used to be, in C, that this: <code>while (5 == fscanf(text, &quot;%5s %19s %19s %c %12s&quot;,</code>  could be written as: <code>while (5 == fscanf(text, &quot;%&quot;MAX_ID_LEN&quot;s %&quot;MAX_NAME_LEN&quot;s %&quot;MAX_NAME_LEN&quot;s %c %&quot;MAX_CONTACT_LEN&quot;s&quot;,</code>  However, that has not been working since the last time I received an update to the <code>gcc</code> compiler.  Rather the compiler outputs a message similar to: <code>.... error: expected &#39;)&#39; before &#39;MAX_ID_LEN&#39;</code>  and <code>...warning: spurious trailing &#39;&amp;&#39; in format [-Wformat=]</code>.  So far, I have not determined what changed in the syntax"}], "tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": true, "score": 5, "last_activity_date": 1514295953, "last_edit_date": 1514295953, "creation_date": 1514295551, "answer_id": 47979411, "question_id": 47978599, "link": "https://stackoverflow.com/questions/47978599/after-reading-from-text-file-results-are-displayed-incorrectly/47979411#47979411", "title": "After reading from text file, results are displayed incorrectly", "body": "<p>in the call to <code>fscanf()</code>, the format string: \"%s %[^\\n]s %c %s\\n\"  is not correct.  </p>\n\n<ol>\n<li>the '[^\\n]' will read to the end of the line (which will overflow the input buffer: `name'.  Then the next char is NOT an 's' because the next character is the newline.   </li>\n<li>should compare the returned value to 4, not EOF  </li>\n<li>the input/format specifiers '%[...]' and '%s' have no problem overflowing the input buffer, so should ALWAYS have a MAX_CHARACTERS modifier that is one less than the length of the input buffer (those format specifiers always append a NUL byte to the input</li>\n</ol>\n\n<p>The following proposed code:</p>\n\n<ol>\n<li>cleanly compiles</li>\n<li>documents why each header file is included</li>\n<li>performs the desired functionality</li>\n<li>splits the 'name' into 'firstname' and 'lastname' for easier handling and to match the format of the input data</li>\n<li>properly checks the returned value from <code>fscanf()</code></li>\n<li>properly checks for any error from <code>fopen()</code> and if an error is returned, properly outputs the error message and the text indicating why the system thinks the function failed to <code>stderr</code></li>\n<li>uses an appropriate format string for the calls to <code>fscanf()</code> and <code>printf()</code></li>\n<li>replaces 'magic' numbers with meaningful names via a <code>enum</code> statement</li>\n</ol>\n\n<p>And now the proposed code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;   // fopen(), fclose(), fscanf(), perror(), printf()\n#include &lt;stdlib.h&gt;  // exit(), EXIT_FAILURE\n\n\nenum{\n    MAX_ID_LEN = 6,\n    MAX_NAME_LEN = 20,\n    MAX_CONTACT_LEN = 13\n};\n\n\nint main( void )\n{\n    char id[ MAX_ID_LEN ];\n    char firstname[ MAX_NAME_LEN ];\n    char lastname[ MAX_NAME_LEN ];\n    char gender;\n    char contact[ MAX_CONTACT_LEN ];\n\n    FILE *text = fopen(\"test.txt\", \"r\");\n    if( !text )\n    {\n        perror( \"fopen to read 'test.txt' failed\" );\n        exit( EXIT_FAILURE );\n    }\n\n    // implied else, fopen successful\n\n    while (5 == fscanf(text, \"%5s %19s %19s %c %12s\",\n        id, firstname, lastname, &amp;gender, contact) )\n    {\n        printf(\"%s %s %s %c %s\\n\",\n            id, firstname, lastname, gender, contact);\n    }\n\n    fclose(text);\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "is_accepted": false, "score": 0, "last_activity_date": 1514295838, "creation_date": 1514295838, "answer_id": 47979474, "question_id": 47978599, "link": "https://stackoverflow.com/questions/47978599/after-reading-from-text-file-results-are-displayed-incorrectly/47979474#47979474", "title": "After reading from text file, results are displayed incorrectly", "body": "<p>As the number of space-delimited words in your name apparently is variable, you can only use <code>%[^\\n]s</code> to grab \"as much as possible\" \u2013 but that will also eat up any and all <em>following</em> relevant data. A quick solution would be to re-design the input format and place the name at the very end; then, your <code>fscanf</code> argument would be:</p>\n\n<pre><code>\"%s %c %s %s\\n\", id, &amp;gender, contact, name\n</code></pre>\n\n<p>Alternatively, rewrite the code to use less <code>fscanf</code> and more 'manual' parsing:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;ctype.h&gt;\n\nint main (void)\n{\n    FILE *text;\n    char id[6], name[101], gender, contact[13];\n    char *lookback;\n    int result;\n    unsigned int line_number = 0;\n\n    text = fopen (\"test.txt\", \"r\");\n    if (text == NULL)\n    {\n        printf (\"file not found!\\n\");\n        return EXIT_FAILURE;\n    }\n\n    do\n    {\n        result = fscanf(text, \"%s %[^\\n]s\\n\", id, name);\n        line_number++;\n        if (result == EOF)\n            break;\n\n        if (result != 2)\n        {\n            printf (\"error in data file on line %u (expected at least 2 items)\\n\", line_number);\n            break;\n        }\n\n        /* at this point, 'name' also contains 'gender' and 'contact' */\n        lookback = strrchr (name, ' ');\n        if (lookback == NULL || strlen(lookback+1) &gt; 12)\n        {\n            printf (\"error in data file on line %u (expected 'contact')\\n\", line_number);\n            break;\n        }\n        /* lookback+1 because lookback itself points to the space */\n        strcpy (contact, lookback+1);\n        /* cut off at lookback */\n        *lookback = 0;\n\n        lookback = strrchr (name, ' ');\n        if (lookback == NULL || strlen(lookback+1) != 1)\n        {\n            printf (\"error in data file on line %u (expected 'gender')\\n\", line_number);\n            break;\n        }\n        /* lookback now points to the space before the gender */\n        gender = toupper(lookback[1]);\n        if (gender != 'F' &amp;&amp; gender != 'M')\n        {\n            printf (\"error in data file on line %u (expected 'M' or 'F')\\n\", line_number);\n            break;\n        }\n        /* cut off again at lookback; now name is complete */\n        *lookback = 0;\n\n        printf (\"%s %s %c %s\\n\", id, name, gender, contact);\n    } while (1);\n    fclose(text);\n\n    return EXIT_SUCCESS;\n}\n</code></pre>\n\n<p>This method does have a couple of associated drawbacks. One of the perks of <code>scanf</code> is that it normalizes whitespace; multiple spaces and tabs (or even  returns) will silently be translated to a single space <em>before</em> scanning. This code, on the other hand, <em>explicitly</em> checks for a single space character. If there is variation in the whitespace in your data file, you must account for that as well.</p>\n\n<p>With the last two items 'manually' processed, you can opt to not use <code>fscanf</code> at all. You can read an entire line of text at once with <code>fgets</code> (which also has a line length check built in) and look for spaces using <code>strchr</code> and <code>strrchr</code>. To counter possible whitespace problems, search the line for tabs and double spaces and change these to a single space.</p>\n"}], "owner": {"reputation": 79, "user_id": 8919391, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Enipq.jpg?s=128&g=1", "display_name": "lefrost", "link": "https://stackoverflow.com/users/8919391/lefrost"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 153, "favorite_count": 0, "accepted_answer_id": 47979411, "answer_count": 3, "score": 2, "last_activity_date": 1514341460, "creation_date": 1514290935, "last_edit_date": 1514341460, "question_id": 47978599, "link": "https://stackoverflow.com/questions/47978599/after-reading-from-text-file-results-are-displayed-incorrectly", "title": "After reading from text file, results are displayed incorrectly", "body": "<p>I've written a program that reads four variables (three strings and one character) every line from a text file. But when I display the variables, an unexpected character pops up at the end of each line. (I've ensured that the lengths of the variables are large enough).</p>\n\n<p>Why is this? (Overflowing buffers, again?) And how do I fix this?</p>\n\n<p>Text file contents:</p>\n\n<pre>\nM0001 Cool Name F 123-456789\nM0002 Name Cool M 987-654321\n</pre>\n\n<p>Code:</p>\n\n<pre><code>    #include &lt;stdio.h&gt;\n    #include &lt;stdlib.h&gt;\n\n    int main() {\n        FILE *text;\n\n        char id[6], name[101], gender, contact[13];\n\n        text = fopen(\"test.txt\", \"r\");\n        while (fscanf(text, \"%s %[^\\n]s %c %s\\n\", id, name, &amp;gender, contact) != EOF)\n            printf(\"%s %s %c %s\\n\", id, name, gender, contact);\n        fclose(text);\n\n        return 0;\n\n}\n</code></pre>\n\n<p>The output I expect:</p>\n\n<pre>\nM0001 Cool Name F 123-456789\nM0002 Name Cool M 987-654321\n</pre>\n\n<p>What I get instead:</p>\n\n<pre>\nM0001 Cool Name F 123-456789 1\u20444\nM0002 Name Cool M 987-654321 1\u20444\n</pre>\n"}, {"tags": ["c", "loops", "matrix", "scanf"], "comments": [{"owner": {"reputation": 560, "user_id": 4226027, "user_type": "registered", "accept_rate": 89, "profile_image": "https://graph.facebook.com/100002406955866/picture?type=large", "display_name": "Bruno Braga", "link": "https://stackoverflow.com/users/4226027/bruno-braga"}, "edited": false, "score": 0, "creation_date": 1514291139, "post_id": 47978570, "comment_id": 82925879, "body": "how is this file? could you provide a small part of it please?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9141589"}, "reply_to_user": {"reputation": 560, "user_id": 4226027, "user_type": "registered", "accept_rate": 89, "profile_image": "https://graph.facebook.com/100002406955866/picture?type=large", "display_name": "Bruno Braga", "link": "https://stackoverflow.com/users/4226027/bruno-braga"}, "edited": false, "score": 0, "creation_date": 1514291567, "post_id": 47978570, "comment_id": 82926031, "body": "Sure! it&#39;s just a text file, like this.      2.0 4.0 7.0 1.5 6.7 9.1 2.0 4.0 7.0 1.5 6.7 9.1"}], "answers": [{"comments": [{"owner": {"reputation": 560, "user_id": 4226027, "user_type": "registered", "accept_rate": 89, "profile_image": "https://graph.facebook.com/100002406955866/picture?type=large", "display_name": "Bruno Braga", "link": "https://stackoverflow.com/users/4226027/bruno-braga"}, "edited": false, "score": 0, "creation_date": 1514293709, "post_id": 47979050, "comment_id": 82926729, "body": "i and j have to be defined from scratch"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9141589"}, "edited": false, "score": 0, "creation_date": 1514294775, "post_id": 47979050, "comment_id": 82927102, "body": "Got it! Thank you so much!!"}, {"owner": {"reputation": 86, "user_id": 4495512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd16c6f89d9e53b5d07e690597d857d2?s=128&d=identicon&r=PG&f=1", "display_name": "Yuval_Shi", "link": "https://stackoverflow.com/users/4495512/yuval-shi"}, "reply_to_user": {"reputation": 560, "user_id": 4226027, "user_type": "registered", "accept_rate": 89, "profile_image": "https://graph.facebook.com/100002406955866/picture?type=large", "display_name": "Bruno Braga", "link": "https://stackoverflow.com/users/4226027/bruno-braga"}, "edited": false, "score": 0, "creation_date": 1514295081, "post_id": 47979050, "comment_id": 82927230, "body": "@BrunoBraga, they can be defined at the beginning and later be used, that way they will not be initialized more than once. either way, it is solved."}], "tags": [], "owner": {"reputation": 86, "user_id": 4495512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd16c6f89d9e53b5d07e690597d857d2?s=128&d=identicon&r=PG&f=1", "display_name": "Yuval_Shi", "link": "https://stackoverflow.com/users/4495512/yuval-shi"}, "is_accepted": true, "score": 1, "last_activity_date": 1514293445, "creation_date": 1514293445, "answer_id": 47979050, "question_id": 47978570, "link": "https://stackoverflow.com/questions/47978570/reading-numbers-from-a-file-in-sets-of-6-into-a-2x3-matrix/47979050#47979050", "title": "Reading numbers from a file in sets of 6 into a 2x3 matrix?", "body": "<p>The break inside the inner if{} only breaks the for-loop, but there is another while(1) loop that doesn't break, so the loop just keeps going and going. In the beginning of the for-loop you define and initialize \"i\" and \"j\" from scratch, so it can be another logical mistake. A good idea is to place a debug point and see how it goes.</p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user9141589"}, "edited": false, "score": 0, "creation_date": 1514294913, "post_id": 47979165, "comment_id": 82927161, "body": "Yes that was the problem! Thank you, I hadn\u2019t thought about using a flag variable!"}], "tags": [], "owner": {"reputation": 560, "user_id": 4226027, "user_type": "registered", "accept_rate": 89, "profile_image": "https://graph.facebook.com/100002406955866/picture?type=large", "display_name": "Bruno Braga", "link": "https://stackoverflow.com/users/4226027/bruno-braga"}, "is_accepted": false, "score": 0, "last_activity_date": 1514294027, "creation_date": 1514294027, "answer_id": 47979165, "question_id": 47978570, "link": "https://stackoverflow.com/questions/47978570/reading-numbers-from-a-file-in-sets-of-6-into-a-2x3-matrix/47979165#47979165", "title": "Reading numbers from a file in sets of 6 into a 2x3 matrix?", "body": "<p>the problem was indeed your while loop, the break statement was only breaking the inner for loop, check this solution.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\n\ndouble dist(double p[2][3])\n{\n    double distance=((p[0][0]-p[1][0])*(p[0][0]-p[1][0]))+((p[0][1]-p[1][1])*(p[0][1]-p[1][1]))+((p[0][2]-p[1][2])*(p[0][2]-p[1][2]));\n    return distance;\n}\n\nint main()\n{\n    double p[2][3];\n    FILE*in;\n    in=fopen(\"file\",\"r\");\n    int flag = 1;\n    while(flag &gt; 0)\n    {\n        for(int i=0;i&lt;2;i++)\n        {\n            for(int j=0;j&lt;3;j++)\n            {\n                if(fscanf(in, \"%lf \", &amp;p[i][j])==EOF)\n                    {flag = 0;}\n            }\n        }\n        printf(\"the distance is %lf\\n\", dist(p));\n    }\n    fclose(in);\n}\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9141589"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 24, "favorite_count": 0, "accepted_answer_id": 47979050, "answer_count": 2, "score": 0, "last_activity_date": 1514294027, "creation_date": 1514290802, "question_id": 47978570, "link": "https://stackoverflow.com/questions/47978570/reading-numbers-from-a-file-in-sets-of-6-into-a-2x3-matrix", "title": "Reading numbers from a file in sets of 6 into a 2x3 matrix?", "body": "<p>I have to find the distance between two pairs of points, each point defined by three coordinates, using the function dist(double p[2][3]).\nI put the total 12 coordinates in a file, separating them with a space.\nI tried doing it like this but the loop never breaks, it just keeps printing the distance between the first two points over and over...</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\n\ndouble dist(double p[2][3])\n{\n    double distance=sqrt(((p[0][0]-p[1][0])*(p[0][0]-p[1][0]))+((p[0][1]-p[1][1])*(p[0][1]-p[1][1]))+((p[0][2]-p[1][2])*(p[0][2]-p[1][2])));\n    return distance;\n}\n\nint main()\n{\n    double p[2][3];\n    FILE*in;\n    in=fopen(\"file\",\"r\");\n\n    while(1)\n    {\n        for(int i=0;i&lt;2;i++)\n        {\n            for(int j=0;j&lt;3;j++)\n            {\n                if(fscanf(in, \"%lf \", &amp;p[i][j])==EOF)\n                    {break;}\n            }\n        }\n        printf(\"the distance is %lf\\n\", dist(p));\n    }\n    fclose(in);\n}\n</code></pre>\n"}, {"tags": ["java", "c", "algorithm", "math"], "answers": [{"tags": [], "owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "is_accepted": true, "score": 3, "last_activity_date": 1514290843, "last_edit_date": 1514290843, "creation_date": 1514290489, "answer_id": 47978515, "question_id": 47978447, "link": "https://stackoverflow.com/questions/47978447/get-index-of-combination-sequence/47978515#47978515", "title": "Get Index of Combination Sequence", "body": "<p>Your combinations correspond to base-3 numbers, which use letters <code>A</code>, <code>B</code>, and <code>C</code> for their digits:</p>\n\n<ul>\n<li><code>A</code> corresponds to 0</li>\n<li><code>B</code> corresponds to 1</li>\n<li><code>C</code> corresponds to 2</li>\n</ul>\n\n<p>If you convert an index to base-3, you would get the corresponding combination. You number combinations starting at 1, so you need to subtract 1 before the conversion.</p>\n\n<p>For example, to get your combination for row 6 subtract 1 to get 5, then convert 5 to base-3 to get 012, then replace digits with letters to get ABC.</p>\n\n<p>Similarly, you can convert a combination to base-3, e.g. CAB becomes 201, then convert it to decimal to get 19, add 1 to get 20 - the index of CAB in your list.</p>\n"}, {"tags": [], "owner": {"reputation": 426, "user_id": 2419751, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bUd5j.jpg?s=128&g=1", "display_name": "GuyKhmel", "link": "https://stackoverflow.com/users/2419751/guykhmel"}, "is_accepted": false, "score": 2, "last_activity_date": 1514290567, "creation_date": 1514290567, "answer_id": 47978530, "question_id": 47978447, "link": "https://stackoverflow.com/questions/47978447/get-index-of-combination-sequence/47978530#47978530", "title": "Get Index of Combination Sequence", "body": "<p>Let's look at the easy case of A and B</p>\n\n<p>You'll get </p>\n\n<pre><code>AA\nAB\nBA\nBB\n</code></pre>\n\n<p>But wait - that's just like binary</p>\n\n<pre><code>00\n01\n10\n11\n</code></pre>\n\n<p>So how in this case - if we'll write lines we'll get:</p>\n\n<pre><code>1 = AA\n2 = AB\n3 = BA\n4 = BB\n</code></pre>\n\n<p>So it's just like the binary representation of a line - 1;\nFor example <strong>Line 2 => 2-1 = 1 => 1 in binary is 01 => AB</strong></p>\n\n<p>So in a matter of fact you should do just the same but not binary, but trinary (is that a word?) - meaning index of 3 in your example</p>\n\n<p>the most right 'digit' is the alphabet size (3 in your example) in the power of 0\nthe next one is the alphabet size in the power of 1 </p>\n\n<p>So - <strong>CAC => 2*3^2 + 0*3^1 + 2*3^0 = 18 + 0 + 2 = 20 (+1 to fix that the lines start at 0) = 21</strong>\netc.</p>\n"}], "owner": {"reputation": 8802, "user_id": 2845414, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Zt44U.jpg?s=128&g=1", "display_name": "Sumeet", "link": "https://stackoverflow.com/users/2845414/sumeet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 139, "favorite_count": 0, "accepted_answer_id": 47978515, "answer_count": 2, "score": 3, "last_activity_date": 1514290843, "creation_date": 1514290149, "question_id": 47978447, "link": "https://stackoverflow.com/questions/47978447/get-index-of-combination-sequence", "title": "Get Index of Combination Sequence", "body": "<p>I am generating possible combination of three letters like (A,B,C ) in below pattern.  Fix outer letter and change inside . </p>\n\n<p>For (A,B,C) = 3*3*3 possibilities . </p>\n\n<p>I store all in array , now by sequence can we know in which index\n particular combination had occurred. Example : \"A B C\" at 6 the ,\n\"C C C\" at 27 .</p>\n\n<p>Also by index is it possible to derive in which index it appeared like 6 = \"A B C\" . </p>\n\n<p>Is there any pattern to find out? <strong>Not expecting code only formula</strong> </p>\n\n<pre><code>A A A\nA A B\nA A C\n\nA B A\nA B B\nA B C\n\nA C A\nA C B\nA C C\n\nB A A\nB A B\nB A C\n\nB B A\nB B B\nB B C\n\nB C A\nB C B\nB C C\n\nC A A\nC A B\nC A C\n\nC B A\nC B B\nC B C\n\nC C A\nC C B\nC C C\n</code></pre>\n"}, {"tags": ["c", "string", "algorithm"], "comments": [{"owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "edited": false, "score": 4, "creation_date": 1514290236, "post_id": 47978438, "comment_id": 82925550, "body": "Any attempt at solving this independently?"}], "answers": [{"comments": [{"owner": {"reputation": 3350, "user_id": 7332147, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e4GFL.png?s=128&g=1", "display_name": "linuxfan says Reinstate Monica", "link": "https://stackoverflow.com/users/7332147/linuxfan-says-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1514297767, "post_id": 47979511, "comment_id": 82928109, "body": "in find(), what happens if s1 or s2 are NULL? Apart from this, congratulations for the effort."}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 3350, "user_id": 7332147, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e4GFL.png?s=128&g=1", "display_name": "linuxfan says Reinstate Monica", "link": "https://stackoverflow.com/users/7332147/linuxfan-says-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1514298184, "post_id": 47979511, "comment_id": 82928262, "body": "@linuxfan Undefined behavior. As with standard C string functions it is the task of the client of the function to pass valid pointers."}], "tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": true, "score": 0, "last_activity_date": 1514297870, "last_edit_date": 1514297870, "creation_date": 1514296099, "answer_id": 47979511, "question_id": 47978438, "link": "https://stackoverflow.com/questions/47978438/c-how-to-compare-index-on-2-string/47979511#47979511", "title": "C - how to compare index on 2 string?", "body": "<p>We beginners should help each other.:)\nHere is my three cents.:)</p>\n\n<p>For starters indices in C start from zero.</p>\n\n<p>So it would be correctly to say that </p>\n\n<blockquote>\n  <p>the letter f, in place 7 in string 1, in place 8 in string 2</p>\n</blockquote>\n\n<p>Here is a demonstrative program.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;ctype.h&gt;\n\nint find_letter( const char *s1, const char *s2, size_t *i1, size_t *i2 )\n{\n    int success = *s1 &amp;&amp; *s2;\n\n    if ( success )\n    {\n        const char *p1 = s1;\n        const char *p2;\n\n        do\n        {\n            success = isalpha( ( unsigned char )*p1 ) &amp;&amp; \n                      ( p2 = strchr( s2, *p1 ) ) != NULL;  \n        } while ( !success &amp;&amp; *++p1 );\n\n        if ( success )\n        {\n            *i1 = p1 - s1;\n            *i2 = p2 - s2;\n        }\n    }\n\n    return success;\n}\n\nint main(void) \n{\n    char string1[] = \"ab cd efgf\";\n    char string2[] = \"mn go jpfgt\";\n    size_t i1;\n    size_t i2;\n\n    if ( find_letter( string1, string2, &amp;i1, &amp;i2 ) )\n    {\n        printf( \"%c at position %zu in the first string \"\n                \"and at position %zu in the second string\\n\",\n                string1[i1], i1, i2 );\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>The program output is</p>\n\n<pre><code>f at position 7 in the first string and at position 8 in the second string\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 9141558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0817cf4a6c9dab2b6f0825ef545918f1?s=128&d=identicon&r=PG&f=1", "display_name": "B RAMI", "link": "https://stackoverflow.com/users/9141558/b-rami"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 447, "favorite_count": 0, "accepted_answer_id": 47979511, "answer_count": 1, "score": -3, "last_activity_date": 1514297870, "creation_date": 1514290089, "last_edit_date": 1514297443, "question_id": 47978438, "link": "https://stackoverflow.com/questions/47978438/c-how-to-compare-index-on-2-string", "title": "C - how to compare index on 2 string?", "body": "<p>i have 2 string;</p>\n\n<p><code>string1[20] = \"ab cd efgf\";\nstring2[20] = \"mn go jpfgt\";</code></p>\n\n<p>Need to find the first letter in string1 that appears in string 2\nand after print the place(index) and the letter In each of the strings\nneed to find only letter not numbers or space  </p>\n\n<p>for example: the letter f, in place 8 in string 1, in place 9 in string 2</p>\n"}, {"tags": ["c", "llvm"], "answers": [{"tags": [], "owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "is_accepted": true, "score": 3, "last_activity_date": 1514304415, "creation_date": 1514304415, "answer_id": 47980991, "question_id": 47978363, "link": "https://stackoverflow.com/questions/47978363/get-variable-name-in-llvm-pass/47980991#47980991", "title": "Get variable name in LLVM pass", "body": "<p>After checking that <code>I</code> is a <code>StoreInst</code> you can iterate between <code>I.op_begin()</code> and <code>I.op_end()</code>:</p>\n\n<pre><code>for (auto op = I.op_begin(); op != I.op_end(); op++) {\n  Value* v = op.get();\n  StringRef name = v-&gt;getName();\n}\n</code></pre>\n"}], "owner": {"reputation": 145, "user_id": 9138616, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9fdd565ce3edf45d047e85604ed1ac8e?s=128&d=identicon&r=PG&f=1", "display_name": "Hif", "link": "https://stackoverflow.com/users/9138616/hif"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1462, "favorite_count": 0, "accepted_answer_id": 47980991, "answer_count": 1, "score": 4, "last_activity_date": 1514411160, "creation_date": 1514289639, "last_edit_date": 1514411160, "question_id": 47978363, "link": "https://stackoverflow.com/questions/47978363/get-variable-name-in-llvm-pass", "title": "Get variable name in LLVM pass", "body": "<p>I have following LLVM IR and I want to extract the variable name <code>string</code> from the store instruction. Please guide me on how can I do this.</p>\n\n<pre><code> %call = call noalias i8* @malloc(i64 100) #3\n store i8* %call, i8** %string, align 8\n</code></pre>\n\n<p>My LLVM pass looks like</p>\n\n<pre><code>virtual bool runOnModule(Module &amp;M) {\n  for (Function &amp;F: M) { \n    for (BasicBlock &amp;B: F) {\n        for (Instruction &amp;I: B) {\n            if(CallInst* call_inst = dyn_cast&lt;CallInst&gt;(&amp;I)) {\n                Function* fn = call_inst-&gt;getCalledFunction();\n                StringRef fn_name = fn-&gt;getName();\n                errs() &lt;&lt; fn_name &lt;&lt; \" : \" &lt;&lt; call_inst-&gt;getArgOperand(0) &lt;&lt; \"\\n\";\n                //for(auto args = fn-&gt;arg_begin(); args != fn-&gt;arg_end(); ++args) {\n                    //  ConstantInt* arg = dyn_cast&lt;ConstantInt&gt;(&amp;(*args));\n                    //  errs() &lt;&lt; arg-&gt;getValue() &lt;&lt; \"\\n\";\n                //}    \n            } else {\n                       errs() &lt;&lt; I.getName() &lt;&lt; \"\\n\" &lt;&lt; I.getOpcodeName();\n            }\n    }\n     }  \n  }\n  return false;\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "bash", "unix", "sh"], "comments": [{"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 1, "creation_date": 1514288324, "post_id": 47978025, "comment_id": 82924877, "body": "<code>#!b1n&#47;bash</code> --&gt;&gt; <code>#!&#47;bin&#47;bash</code>, for a start ..."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 1, "creation_date": 1514288459, "post_id": 47978025, "comment_id": 82924927, "body": "OT: Either change <code>scanf(&quot;%c&quot;, &amp;ans);</code> to be <code>scanf(&quot;%1s&quot;, ans);</code> or change <code>(strcmp(ans, &quot;Y&quot;)==0)</code> to be <code>(ans[0] == &#39;Y&#39;)</code> (mind the single quotes vs. double quotes)."}, {"owner": {"reputation": 1, "user_id": 8431953, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nxvAVAlSarQ/AAAAAAAAAAI/AAAAAAAABPY/QnWbTBii3-A/photo.jpg?sz=128", "display_name": "Sudarshan Kakoty", "link": "https://stackoverflow.com/users/8431953/sudarshan-kakoty"}, "edited": false, "score": 0, "creation_date": 1514289948, "post_id": 47978025, "comment_id": 82925454, "body": "Thank you guys for correcting my mistake. I appreciate it :)"}, {"owner": {"reputation": 233489, "user_id": 14122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5e2861b08f37fa306fbf5384994af688?s=128&d=identicon&r=PG", "display_name": "Charles Duffy", "link": "https://stackoverflow.com/users/14122/charles-duffy"}, "edited": false, "score": 0, "creation_date": 1514667031, "post_id": 47978025, "comment_id": 83045741, "body": "Neither of the uses of <code>eval</code> in your shell script call for it. Using <code>eval</code> <a href=\"http://mywiki.wooledge.org/BashFAQ/048\" rel=\"nofollow noreferrer\">creates substantial security risks</a> -- it should only be used when your script can&#39;t possibly be written without it, and that&#39;s certainly not the case here."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8431953, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nxvAVAlSarQ/AAAAAAAAAAI/AAAAAAAABPY/QnWbTBii3-A/photo.jpg?sz=128", "display_name": "Sudarshan Kakoty", "link": "https://stackoverflow.com/users/8431953/sudarshan-kakoty"}, "edited": false, "score": 0, "creation_date": 1514289409, "post_id": 47978168, "comment_id": 82925258, "body": "Oh that was very useful advice :)"}], "tags": [], "owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "is_accepted": true, "score": 0, "last_activity_date": 1514288968, "last_edit_date": 1514288968, "creation_date": 1514288658, "answer_id": 47978168, "question_id": 47978025, "link": "https://stackoverflow.com/questions/47978025/multiple-condition-check-in-c/47978168#47978168", "title": "Multiple condition check in C", "body": "<p>The correct one would be</p>\n\n<pre><code>if(scanf(\"%1s\",ans)!=1){\n   // error handle\n}\n</code></pre>\n\n<p>This will make you use it properly in the <code>strcmp</code> function.</p>\n\n<p>Or you can do this</p>\n\n<pre><code>if(scanf(\"%c\",&amp;ans[0])!=1){\n   // error handle\n}\nans[1]=0;\n</code></pre>\n\n<p>Then you can use it in <code>strcmp</code> or simply you can use </p>\n\n<pre><code>if(ans[0]=='Y'){\n   ...\n}\n</code></pre>\n\n<p>The return value of <code>scanf</code> is checked to know whether the <code>scanf</code> call is successful or not.</p>\n\n<p>Also instead of <code>strcpy</code> use <code>sprintf</code> or similar so that you won't run into buffer overrun. Here you know the length but in many siatuations you won't - it is good and safe to <code>sprintf</code> then.</p>\n\n<p>If you enable warning in compiler then you will see type mismatch warning. Something like </p>\n\n<pre><code>format '%s' expects argument of type 'char *', but argument 2 has type 'char (*)[2]' [-Wformat=]\n     scanf(\"%s\",&amp;ans);\n     ^\n</code></pre>\n\n<p>Try to compile the code with <code>-Wall -Werror</code> flags enabled.</p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 8431953, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nxvAVAlSarQ/AAAAAAAAAAI/AAAAAAAABPY/QnWbTBii3-A/photo.jpg?sz=128", "display_name": "Sudarshan Kakoty", "link": "https://stackoverflow.com/users/8431953/sudarshan-kakoty"}, "edited": false, "score": 0, "creation_date": 1514292372, "post_id": 47978478, "comment_id": 82926314, "body": "Hoho. This menu-driven design looks so pro. I didn&#39;t know that technique :)) Thanks a lot, Mukesh :))"}, {"owner": {"reputation": 1, "user_id": 8431953, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nxvAVAlSarQ/AAAAAAAAAAI/AAAAAAAABPY/QnWbTBii3-A/photo.jpg?sz=128", "display_name": "Sudarshan Kakoty", "link": "https://stackoverflow.com/users/8431953/sudarshan-kakoty"}, "edited": false, "score": 0, "creation_date": 1514293639, "post_id": 47978478, "comment_id": 82926703, "body": "Not sure what caused this in your code: <a href=\"https://imgur.com/a/jUCTt\" rel=\"nofollow noreferrer\">Screenshot View</a>"}, {"owner": {"reputation": 103, "user_id": 2347061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46e15ba92a6f6e0e469c56cf490ab556?s=128&d=identicon&r=PG", "display_name": "Mukesh Sai Kumar", "link": "https://stackoverflow.com/users/2347061/mukesh-sai-kumar"}, "reply_to_user": {"reputation": 1, "user_id": 8431953, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nxvAVAlSarQ/AAAAAAAAAAI/AAAAAAAABPY/QnWbTBii3-A/photo.jpg?sz=128", "display_name": "Sudarshan Kakoty", "link": "https://stackoverflow.com/users/8431953/sudarshan-kakoty"}, "edited": false, "score": 0, "creation_date": 1514665253, "post_id": 47978478, "comment_id": 83045306, "body": "@SudarshanKakoty Fixed the bug (added a few whitespaces in my program :P It doesn&#39;t look like edited) refer to the link in my edit notice"}, {"owner": {"reputation": 1, "user_id": 8431953, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nxvAVAlSarQ/AAAAAAAAAAI/AAAAAAAABPY/QnWbTBii3-A/photo.jpg?sz=128", "display_name": "Sudarshan Kakoty", "link": "https://stackoverflow.com/users/8431953/sudarshan-kakoty"}, "edited": false, "score": 0, "creation_date": 1514713590, "post_id": 47978478, "comment_id": 83053385, "body": "Lol. Okay. I got it. :)"}], "tags": [], "owner": {"reputation": 103, "user_id": 2347061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46e15ba92a6f6e0e469c56cf490ab556?s=128&d=identicon&r=PG", "display_name": "Mukesh Sai Kumar", "link": "https://stackoverflow.com/users/2347061/mukesh-sai-kumar"}, "is_accepted": false, "score": 0, "last_activity_date": 1514665171, "last_edit_date": 1514665171, "creation_date": 1514290300, "answer_id": 47978478, "question_id": 47978025, "link": "https://stackoverflow.com/questions/47978025/multiple-condition-check-in-c/47978478#47978478", "title": "Multiple condition check in C", "body": "<blockquote>\n  <p>Due to the while loop, I get trap if I try to add another condition inside the existing while loop.  </p>\n</blockquote>\n\n<p>I don't exactly get what you say there (I can see no <code>while</code> loops in there), but here goes my answer. You may use similar if-else constructs to prompt the user to list backups and to restore from them. Your final program will look something like:</p>\n\n<pre><code>#include&lt;ctype.h&gt;\n#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\nint main() {\n    char ans;    //You need only a char variable, not an array\n\n    printf(\"\\nYou are about to backup installed packages. Continue (Y/N)?:\");\n    scanf(\" %c\", &amp;ans);\n    if (toupper(ans) == 'Y') {\n        system(\"sudo pacman -Qqe | grep -vx '$(pacman -Qqm)' &gt; packages\");\n        printf(\"\\nBackup done! \\n\");\n    }\n    else\n        printf (\"\\nGot you, I won't backup \\n\");\n\n    printf(\"\\nView list? (y/n) \");\n    scanf(\" %c\",&amp;ans);\n    if(toupper(ans) == 'Y')\n        system(\"xargs -a packages\");\n\n    printf(\"\\nSo restore listed contents? (y/n) \");\n    scanf(\" %c\",&amp;ans);\n    if(toupper(ans) == 'Y')\n        system(\"sudo xargs -a packages pacman -S --needed\");\n    else\n        printf(\"\\nOK, no packages restored.\");\n}\n</code></pre>\n\n<p>Or else, you may use a menu-based approach to solve the problem:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n\nvoid backup(){\n    system(\"sudo pacman -Qqe | grep -vx \\\"$(pacman -Qqm)\\\" &gt; packages\");\n    printf(\"\\nBackup done!\");\n}\n\nvoid list(){\n    printf(\"\\nHere comes the listing:\\n\");\n    system(\"xargs -a packages\");\n}\n\nvoid restore(){\n    system(\"sudo xargs -a packages pacman -S --needed\");\n    printf(\"\\nRestore done!\");\n}\n\nint main(){\n    char choice;\n    do{\n        printf(\"\\nSelect any action from the following:\\n\\\n        1. Backup packages\\n\\\n        2. List packages\\n\\\n        3. Restore packages\\n\\\n        4. Exit\\\n    &gt;&gt;&gt; \");\n        scanf(\" %c\",&amp;choice);\n        switch(choice){\n            case '1': backup();\n                  break;\n            case '2': list();\n                  break;\n            case '3': restore();\n                  break;\n            default : printf(\"\\nIllegal choice!\");\n        }\n    }while(choice!='4');    \n    return 0;\n}\n</code></pre>\n\n<hr>\n\n<p><strong>EDIT</strong>:\nFixed <code>scanf()</code> bug, refer: <a href=\"https://gsamaras.wordpress.com/code/caution-when-reading-char-with-scanf-c/\" rel=\"nofollow noreferrer\">https://gsamaras.wordpress.com/code/caution-when-reading-char-with-scanf-c/</a></p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 8431953, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nxvAVAlSarQ/AAAAAAAAAAI/AAAAAAAABPY/QnWbTBii3-A/photo.jpg?sz=128", "display_name": "Sudarshan Kakoty", "link": "https://stackoverflow.com/users/8431953/sudarshan-kakoty"}, "is_accepted": false, "score": 0, "last_activity_date": 1514292289, "creation_date": 1514292289, "answer_id": 47978851, "question_id": 47978025, "link": "https://stackoverflow.com/questions/47978025/multiple-condition-check-in-c/47978851#47978851", "title": "Multiple condition check in C", "body": "<p>I ended up doing this :)</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include&lt;string.h&gt;\nint main() {\n    char ans[2];\n    char command[100];\n    printf(\"\\nYou are about to backup installed packages. Continue? (Y/N):\");\n    scanf(\"%1s\", ans);\n    if(ans[0]=='Y'|| ans[0]=='y') {\n        sprintf(command, \"sudo pacman -Qqe | grep -vx '$(pacman -Qqm)' &gt; packages\");\n        system(command);\n        printf(\"\\nBackup done! \\n\");\n    }\n    if(ans[0]=='N'|| ans[0]=='n') {\n        printf (\"\\nOk. Got you, I won't backup \\n\");\n        exit(EXIT_SUCCESS);     \n    }\n\n    printf (\"\\nView list? (Y/N):\\n\");\n    scanf(\"%1s\", ans);\n    if(ans[0]=='Y'|| ans[0]=='y') {\n    sprintf(command, \"xargs -a packages\");\n        system(command);\n        printf(\"\\n\");\n    }\n    else {\n        printf (\"\\nPreparing to restore \\n\");\n    }\n    printf (\"So restore list contents? (Y/N):\");\n    scanf(\"%1s\", ans);\n    if(ans[0]=='Y' || ans[0]=='y'){\n        sprintf(command, \"sudo xargs -a packages pacman -S --needed\");\n        system(command);\n        }\n        else {\n            printf (\"\\nOk. No packages restored!\\n\");\n        }\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8431953, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nxvAVAlSarQ/AAAAAAAAAAI/AAAAAAAABPY/QnWbTBii3-A/photo.jpg?sz=128", "display_name": "Sudarshan Kakoty", "link": "https://stackoverflow.com/users/8431953/sudarshan-kakoty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 47978168, "answer_count": 3, "score": -1, "last_activity_date": 1514665171, "creation_date": 1514288000, "last_edit_date": 1514288683, "question_id": 47978025, "link": "https://stackoverflow.com/questions/47978025/multiple-condition-check-in-c", "title": "Multiple condition check in C", "body": "<p>I made a shell script to backup, view and restore installed packages in my Linux system. The script looks like:</p>\n\n<pre><code>#!bin/bash\n\necho \"\"\nread -p \"You are about to backup installed packages. Continue (y/n)?:\" CONT\necho \"\"\nif [ \"$CONT\" = \"y\" ]; then\n  eval sudo pacman -Qqe | grep -vx \"$(pacman -Qqm)\" &gt; packages;\nelse\n  echo \"Ok. I got you, I won't backup\";\nfi\n\n    read -p \"View list? (y/n):?\" CONT\nif [ \"$CONT\" = \"y\" ]; then\n    eval xargs -a packages ;\nelse\n    echo \"Preparing to restore\"\nfi\necho \"\"\nread -p \"So restore list contents (y/n):?\" CONT\necho \"\"\nif [ \"$CONT\" = \"y\" ]; then\n    eval sudo xargs -a packages pacman -S --needed ;\nelse\n    echo \"Ok. No packages restored!\";\nfi\n</code></pre>\n\n<p>This script creates a textfile containing all the package names installed in a system, then prompt the user to view the list and at last allow him to restore the packages included in the backup list.\nThen, I decided to use C to do the same. I created a program like below:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include&lt;string.h&gt;\nint main() {\nchar ans[2];\nchar command[100];\nprintf(\"\\nYou are about to backup installed packages. Continue (Y/N)?:\");\nscanf(\"%1s\", ans);\nif (strcmp(ans, \"Y\")==0) {\n    strcpy(command, \"sudo pacman -Qqe | grep -vx '$(pacman -Qqm)' &gt; packages\");\n    system(command);\n    printf(\"\\nBackup done! \\n\");\n  }\nelse {\n    printf (\"\\nGot you, I won't backup \\n\");\n  }\n}\n</code></pre>\n\n<p>But this code can only give the user a single choice if he wants to back up the list or not. Due to the while loop, I get trap if I try to add another condition inside the existing while loop.</p>\n\n<p>I need some help in these matters to complete the conditions below. \nHow do one give a user some other choices such as : </p>\n\n<p>1) View the backup list?   2) Restore the packages that backup list contains?</p>\n\n<p>An example will be very helpful :))</p>\n"}, {"tags": ["c", "goto"], "comments": [{"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1514285611, "post_id": 47977463, "comment_id": 82923816, "body": "Why not change <code>alarm</code> and use <code>sleep</code> instead?"}, {"owner": {"reputation": 6855, "user_id": 3125194, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8ca2177750fa502328461e68d385e6d9?s=128&d=identicon&r=PG&f=1", "display_name": "Marian", "link": "https://stackoverflow.com/users/3125194/marian"}, "edited": false, "score": 0, "creation_date": 1514285756, "post_id": 47977463, "comment_id": 82923869, "body": "If there is  a danger that tested algorithms enter an infinite loop, you can use either long jumps (see <code>setjmp</code> and <code>longjmp</code>) or run the algos in a separate thread."}, {"owner": {"reputation": 75, "user_id": 7074209, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2985f884005cdcdd8dfb4f7a3c5e673b?s=128&d=identicon&r=PG&f=1", "display_name": "Meleadeles", "link": "https://stackoverflow.com/users/7074209/meleadeles"}, "edited": false, "score": 0, "creation_date": 1514285806, "post_id": 47977463, "comment_id": 82923890, "body": "How would you do that? Isn&#39;t <code>sleep</code> blocking the program? (sorry, I am not well versed in C at all)"}, {"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1514286256, "post_id": 47977463, "comment_id": 82924090, "body": "I do not know what you are trying to achieve. Perhaps using multiple threads. But goto is definitely the wrong solution"}, {"owner": {"reputation": 75, "user_id": 7074209, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2985f884005cdcdd8dfb4f7a3c5e673b?s=128&d=identicon&r=PG&f=1", "display_name": "Meleadeles", "link": "https://stackoverflow.com/users/7074209/meleadeles"}, "edited": false, "score": 1, "creation_date": 1514287709, "post_id": 47977463, "comment_id": 82924660, "body": "The solution with setjmp and longjmp worked for me. I know it&#39;s certainly not optimal and kinda dirty, but I am too inexperienced to go in threads and the like. Thanks to everyone."}], "owner": {"reputation": 75, "user_id": 7074209, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2985f884005cdcdd8dfb4f7a3c5e673b?s=128&d=identicon&r=PG&f=1", "display_name": "Meleadeles", "link": "https://stackoverflow.com/users/7074209/meleadeles"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1514285404, "creation_date": 1514285404, "question_id": 47977463, "link": "https://stackoverflow.com/questions/47977463/create-a-timer-triggering-next-iteration-of-a-loop", "title": "Create a timer triggering next iteration of a loop", "body": "<p>I have to realize a C program aimed at testing various sorting algorithms. I need to test each algorithm on 15 different array sizes, and do 20 tests for each size. The program then calculate the average time for the 20 tests.</p>\n\n<p>My problem is: I would want a 20-tests serie to stop if it goes for longer than five minutes, but I do not want to crash the program: I want to test the algorithm for the next array size.</p>\n\n<p>So, I put in place a five minute alarm in my main function:</p>\n\n<pre><code>signal(SIGALRM, alarmHandler);\n\n//Test loop\nNEXTTEST: while(maxValues[count + 1] &lt;= MAX){\n    ++count;\n    int max = maxValues[count];\n\n    alarm(60);\n..............\n</code></pre>\n\n<p>And here is my alarmHandler:</p>\n\n<pre><code>void alarmHandler(int sig){\n    printf(\"Signal %d d\u00e9tect\u00e9, arr\u00eat de la s\u00e9rie de test en cours...\\n\", sig);\n    goto NEXTTEST;\n}\n</code></pre>\n\n<p>As you can see, I would like to say, in my handler: \"If you are triggered (if the alarm goes off), then go back to the NEXTTEST label, increment the size of the array, and go on with the tests on this size\"</p>\n\n<p>Except that is of course impossible, knowing that the declaration of my NEXTTEST label is in my main, while my alarmHandler is a separate function.</p>\n\n<p>How could I go around this problem to create my timer?</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["c", "function", "struct", "typedef"], "answers": [{"comments": [{"owner": {"reputation": 79, "user_id": 8919391, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Enipq.jpg?s=128&g=1", "display_name": "lefrost", "link": "https://stackoverflow.com/users/8919391/lefrost"}, "edited": false, "score": 1, "creation_date": 1514285281, "post_id": 47977411, "comment_id": 82923662, "body": "Oh, I see! Thank you. And I&#39;ll take note of the <code>int main(void)</code>."}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": true, "score": 3, "last_activity_date": 1514285408, "last_edit_date": 1514285408, "creation_date": 1514285133, "answer_id": 47977411, "question_id": 47977372, "link": "https://stackoverflow.com/questions/47977372/getting-a-warning-when-passing-struct-through-function/47977411#47977411", "title": "Getting a warning when passing struct through function", "body": "<p>You have the <code>typedef</code> statement <em>after</em> the usage of the newly defined type (<em>synonym for another type, to be nitpicky</em>). At that point, in the function forward declaration, compiler does not know a type named <code>Info</code>. So, it assumes it to be a variable name.</p>\n\n<p>Move the <code>typedef</code> before function prototype.</p>\n\n<p>That said, <code>void main()</code> is not a valid signature for <code>main()</code> in a hosted environment. It should be <code>int main(void)</code>, at least.</p>\n"}, {"tags": [], "owner": {"reputation": 190, "user_id": 9140429, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eP9hT.gif?s=128&g=1", "display_name": "bhura", "link": "https://stackoverflow.com/users/9140429/bhura"}, "is_accepted": false, "score": 2, "last_activity_date": 1578480374, "last_edit_date": 1578480374, "creation_date": 1514285464, "answer_id": 47977479, "question_id": 47977372, "link": "https://stackoverflow.com/questions/47977372/getting-a-warning-when-passing-struct-through-function/47977479#47977479", "title": "Getting a warning when passing struct through function", "body": "<p>Because you are declare the function prototype before the Info structure declaration.</p>\n\n<p>An alternative could be the following code: </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\ntypedef struct \n{\n    char str[10];\n    int num;\n} Info;\n\nvoid pass(Info);\n\nvoid main() \n{\n      Info i;\n\n      strcpy(i.str, \"Hello!\");\n      i.num = 1;\n      pass(i)\n}\n\nvoid pass(Info i) \n{\n     printf(\"%s\\n\", i.str);\n     printf(\"%d\\n\", i.num);\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 2, "last_activity_date": 1514285965, "creation_date": 1514285965, "answer_id": 47977585, "question_id": 47977372, "link": "https://stackoverflow.com/questions/47977372/getting-a-warning-when-passing-struct-through-function/47977585#47977585", "title": "Getting a warning when passing struct through function", "body": "<p>The compiler considers this function declaration</p>\n\n<pre><code>void pass(Info);\n</code></pre>\n\n<p>as a function declaration with an identifier list. That is here <code>Info</code> is identifier of the parameter not its type.</p>\n\n<p>However according to the C Standard (6.7.6.3 Function declarators (including prototypes)):</p>\n\n<blockquote>\n  <p>3 <strong>An identifier list</strong> in a function declarator that is not part of a\n  definition of that function <strong>shall be empty</strong>.</p>\n</blockquote>\n\n<p>SO the compiler issues a warning that the identifier list is not empty for the function declaration that is not a function definition.</p>\n\n<pre><code>warning: parameter names (without types) in function declaration\n</code></pre>\n\n<p>Either you should write</p>\n\n<pre><code>void pass();\n</code></pre>\n\n<p>Or you should place the typedef of the structure declaration before the function declaration and in this case the name <code>Info</code>  will denote a type.</p>\n"}], "owner": {"reputation": 79, "user_id": 8919391, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Enipq.jpg?s=128&g=1", "display_name": "lefrost", "link": "https://stackoverflow.com/users/8919391/lefrost"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 358, "favorite_count": 0, "accepted_answer_id": 47977411, "answer_count": 3, "score": 1, "last_activity_date": 1578480374, "creation_date": 1514284967, "last_edit_date": 1592644375, "question_id": 47977372, "link": "https://stackoverflow.com/questions/47977372/getting-a-warning-when-passing-struct-through-function", "title": "Getting a warning when passing struct through function", "body": "<p>I'm trying to pass a whole structure through a function by value, and I test if the pass was successful by displaying the variables in the structure that was passed.</p>\n<p>When I compile and run the program, the variables display correctly, but I get a warning:</p>\n<blockquote>\n<p>warning: parameter names (without types) in function declaration</p>\n</blockquote>\n<p>So it refers to the function prototype being declared with parameter names that had no types? But if I declared the function correctly, why am I getting this warning?</p>\n<p>Also, in the short program I wrote to test this, the warning doesn't affect the fact that the output being displayed is correct.</p>\n<p>But if I were to get this warning under the same circumstances (passing struct through function) when writing a larger-scale program, will it affect the output in that program being correct?</p>\n<p>My code:</p>\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nvoid pass(Info);\n\ntypedef struct {\n    char str[10];\n    int num;\n} Info;\n\nvoid main() {\n    Info i;\n\n    strcpy(i.str, &quot;Hello!&quot;);\n    i.num = 1;\n\n    pass(i);\n}\n\nvoid pass(Info i) {\n    printf(&quot;%s\\n&quot;, i.str);\n    printf(&quot;%d\\n&quot;, i.num);\n}\n</code></pre>\n<p>Output:</p>\n<blockquote>\n<p>Hello!</p>\n<p>1</p>\n</blockquote>\n"}, {"tags": ["javascript", "c"], "answers": [{"comments": [{"owner": {"reputation": 111, "user_id": 7891235, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh5.googleusercontent.com/-FWU0sWOrCEA/AAAAAAAAAAI/AAAAAAAAAS0/DTZK7yGtRLY/photo.jpg?sz=128", "display_name": "Rushdiey", "link": "https://stackoverflow.com/users/7891235/rushdiey"}, "edited": false, "score": 0, "creation_date": 1514305962, "post_id": 47976838, "comment_id": 82930932, "body": "i got error when copy this. Do i need to modify something?"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "reply_to_user": {"reputation": 111, "user_id": 7891235, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh5.googleusercontent.com/-FWU0sWOrCEA/AAAAAAAAAAI/AAAAAAAAAS0/DTZK7yGtRLY/photo.jpg?sz=128", "display_name": "Rushdiey", "link": "https://stackoverflow.com/users/7891235/rushdiey"}, "edited": false, "score": 0, "creation_date": 1514306541, "post_id": 47976838, "comment_id": 82931134, "body": "You want to replace the three dots by any sane initialisations."}], "tags": [], "owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "is_accepted": false, "score": 2, "last_activity_date": 1514292566, "last_edit_date": 1514292566, "creation_date": 1514282494, "answer_id": 47976838, "question_id": 47976766, "link": "https://stackoverflow.com/questions/47976766/simple-c-programing-round-up-down-to-nearest-0-5/47976838#47976838", "title": "Simple C Programing Round up/down to nearest 0.5", "body": "<p>[for C]</p>\n\n<p>This would do for values greater or equal 0:</p>\n\n<pre><code>double to_be_rounded = ...;\ndouble rounded = trunc(2. * to_be_rounded + .5) / 2.;\n</code></pre>\n\n<p>For values less or equal 0 it should be:</p>\n\n<pre><code>double to_be_rounded = ...;\ndouble rounded = trunc(2. * to_be_rounded - .5) / 2.;\n</code></pre>\n\n<p>This would do for any:</p>\n\n<pre><code>double to_be_rounded = ...;\ndouble rounded = round(2. * to_be_rounded) / 2.;\n</code></pre>\n"}], "owner": {"reputation": 111, "user_id": 7891235, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh5.googleusercontent.com/-FWU0sWOrCEA/AAAAAAAAAAI/AAAAAAAAAS0/DTZK7yGtRLY/photo.jpg?sz=128", "display_name": "Rushdiey", "link": "https://stackoverflow.com/users/7891235/rushdiey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 717, "favorite_count": 0, "closed_date": 1514282852, "answer_count": 1, "score": -3, "last_activity_date": 1514292566, "creation_date": 1514282200, "last_edit_date": 1514284100, "question_id": 47976766, "link": "https://stackoverflow.com/questions/47976766/simple-c-programing-round-up-down-to-nearest-0-5", "closed_reason": "Duplicate", "title": "Simple C Programing Round up/down to nearest 0.5", "body": "<p>I need to create simple C programming which look like this</p>\n\n<pre><code>1.1 and 1.2 to 1.0\n1.3 and 1.4 to 1.5\n1.6 and 1.7 to 1.5\n1.8 and 1.9 to 2.0\n</code></pre>\n\n<p>This is my example</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\n int main()\n{\n       float i=1.3, j=1.7;\n       printf(\"round of  %f is  %f\\n\", i, round(i));\n       printf(\"round of  %f is  %f\\n\", j, round(j));\n       return 0;\n}\n</code></pre>\n\n<p>The answer for <code>i</code> become <code>1.0</code> but i am expecting <code>1.5</code> and <code>j</code> is <code>2.0</code> but my expectation is <code>1.5</code>\nI need a few line to make it happen right?</p>\n"}, {"tags": ["c", "arrays", "function", "matrix", "multidimensional-array"], "comments": [{"owner": {"reputation": 601, "user_id": 8150130, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/1629543837056783/picture?type=large", "display_name": "Treyten Carey", "link": "https://stackoverflow.com/users/8150130/treyten-carey"}, "edited": false, "score": 0, "creation_date": 1514277722, "post_id": 47975910, "comment_id": 82920959, "body": "Where is the crash occurring? Is it on line <code>board[i][j]=&#39;-&#39;;</code>?"}, {"owner": {"reputation": 11, "user_id": 9139747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42a3c625036acefd114226f860131f2e?s=128&d=identicon&r=PG&f=1", "display_name": "Dvir Moran", "link": "https://stackoverflow.com/users/9139747/dvir-moran"}, "reply_to_user": {"reputation": 601, "user_id": 8150130, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/1629543837056783/picture?type=large", "display_name": "Treyten Carey", "link": "https://stackoverflow.com/users/8150130/treyten-carey"}, "edited": false, "score": 0, "creation_date": 1514278397, "post_id": 47975910, "comment_id": 82921151, "body": "yes, it happens on line <code>board[i][j]=&#39;-&#39;;</code>  compiler is GNU GCC..? that&#39;s what it says in Codeblocks, not sure if should say something more specific"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1514279028, "post_id": 47975910, "comment_id": 82921343, "body": "You chose to make this question a moving target, by adding a second question (how should I design my code?) to the first one (Why does it crash as it is?). The alternative would have been to make a new separate question. Good luck with that strategy."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1514279251, "post_id": 47975910, "comment_id": 82921422, "body": "Compile with all warnings and debug info: <code>gcc -Wall -Wextra -g</code> with <a href=\"http://gcc.gnu.org/\" rel=\"nofollow noreferrer\">GCC</a>. Improve your code to get no warnings. <b>Use the debugger <code>gdb</code></b>. See also <a href=\"https://stackoverflow.com/a/47235897/841108\">this</a>"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1514281168, "post_id": 47975910, "comment_id": 82922130, "body": "<code>[MAX_SIZE]</code> in this context doesn&#39;t mean &quot;any size&quot; or &quot;any size up to MAX_SIZE&quot; or anything like that. It means &quot;exactly MAX_SIZE&quot;. 4 is not exactly MAX_SIZE."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 9139747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42a3c625036acefd114226f860131f2e?s=128&d=identicon&r=PG&f=1", "display_name": "Dvir Moran", "link": "https://stackoverflow.com/users/9139747/dvir-moran"}, "edited": false, "score": 0, "creation_date": 1514277949, "post_id": 47975969, "comment_id": 82921031, "body": "Oh I see, though I&#39;m not sure why... anyway how should I write my code differently to fix that?"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "reply_to_user": {"reputation": 11, "user_id": 9139747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42a3c625036acefd114226f860131f2e?s=128&d=identicon&r=PG&f=1", "display_name": "Dvir Moran", "link": "https://stackoverflow.com/users/9139747/dvir-moran"}, "edited": false, "score": 0, "creation_date": 1514278080, "post_id": 47975969, "comment_id": 82921073, "body": "For an answer to that new question (please make it one, instead of adding more questions to this one) you should provide more information on the scope and context. I.e. what are you trying to achieve. Try not to make that question an instance of the XY-problem. There is some probability of whatever you are trying to achieve requires a redesign of your API. Using a simple pointer to int and a struct of sizes as parameters is a first guess. You are experienced in the use of pointers in C, aren&#39;t you. If not <a href=\"https://ericlippert.com/2014/03/21/find-a-simpler-problem/\" rel=\"nofollow noreferrer\">ericlippert.com/2014/03/21/find-a-simpler-problem</a>"}, {"owner": {"reputation": 11, "user_id": 9139747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42a3c625036acefd114226f860131f2e?s=128&d=identicon&r=PG&f=1", "display_name": "Dvir Moran", "link": "https://stackoverflow.com/users/9139747/dvir-moran"}, "edited": false, "score": 0, "creation_date": 1514279189, "post_id": 47975969, "comment_id": 82921397, "body": "Sorry, I&#39;m new to this... I tried making a matrix that its values are assigned by the user (originally dims[] values were assigned through scanf) and then initialize it. I&#39;m not at all experienced with pointers. thx anyway..."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "reply_to_user": {"reputation": 297, "user_id": 9102877, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/074040db5e59bc608cfcebf9b259ebc7?s=128&d=identicon&r=PG", "display_name": "QuIcKmAtHs", "link": "https://stackoverflow.com/users/9102877/quickmaths"}, "edited": false, "score": 1, "creation_date": 1514279708, "post_id": 47975969, "comment_id": 82921570, "body": "@XcoderX Asking for the full code will usually result in &quot;I can&#39;t, because it is too long, or secret, or ...&quot;. You might want to recommend making a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> instead."}, {"owner": {"reputation": 297, "user_id": 9102877, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/074040db5e59bc608cfcebf9b259ebc7?s=128&d=identicon&r=PG", "display_name": "QuIcKmAtHs", "link": "https://stackoverflow.com/users/9102877/quickmaths"}, "edited": false, "score": 0, "creation_date": 1514279766, "post_id": 47975969, "comment_id": 82921588, "body": "Okay noted @Yunnosch!!"}, {"owner": {"reputation": 11, "user_id": 9139747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42a3c625036acefd114226f860131f2e?s=128&d=identicon&r=PG&f=1", "display_name": "Dvir Moran", "link": "https://stackoverflow.com/users/9139747/dvir-moran"}, "edited": false, "score": 0, "creation_date": 1514281728, "post_id": 47975969, "comment_id": 82922342, "body": "The reason I didn&#39;t post the full code is because I thought it would make it easier for the people who try to help me, no need to be a jerk. Anyway it&#39;s solved now."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1514283989, "post_id": 47975969, "comment_id": 82923122, "body": "Not sure who you are describing as a jerk, but making answering easier is best served by making a MCVE. If you have trouble understanding all the details of some code (which you most likely do, otherwise why ask a questions here), then it is risky to decide which parts are relevant and which are not. The (non-trivial) concept of a MCVE is the perfect synthesis of those two problems. If you can make small code which reproduces the problem, then nothing relevant is left out. Whatever you can delete is neither needed nor going to distract. And you do not let people do work which you can do."}], "tags": [], "owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "is_accepted": true, "score": 2, "last_activity_date": 1514277579, "creation_date": 1514277579, "answer_id": 47975969, "question_id": 47975910, "link": "https://stackoverflow.com/questions/47975910/c-program-crashes-when-assigning-values-to-a-matrix-using-a-function/47975969#47975969", "title": "C Program crashes when assigning values to a matrix using a function", "body": "<p>Your board is of size 3*4.<br>\nYour function accesses that small board at multiples of 25 entries behind start (for j>0 in the inner loop), i.e. some 13 entry behind entry number 3*4, i.e. 14 behind the last valid entry at index 11.</p>\n"}, {"tags": [], "owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "is_accepted": false, "score": 1, "last_activity_date": 1514282047, "creation_date": 1514282047, "answer_id": 47976725, "question_id": 47975910, "link": "https://stackoverflow.com/questions/47975910/c-program-crashes-when-assigning-values-to-a-matrix-using-a-function/47976725#47976725", "title": "C Program crashes when assigning values to a matrix using a function", "body": "<p>Here's how to pass a <em>variable length array</em> (VLA) to a function correctly.</p>\n\n<pre><code>void initialize_board(int m, int n, char board[m][n]) { ... }\n\nint main ()\n{\n   int m, n;\n   ... // initialize m and n here\n   char board[m][n];\n   initialize_board(m, n, board);\n}\n</code></pre>\n\n<p>VLAs can be dangerous when declared as automatic variables, because they can easily crash your program when the size gets a little bit too large (a few KB or MB, depending on your OS and hardware). </p>\n"}], "owner": {"reputation": 11, "user_id": 9139747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42a3c625036acefd114226f860131f2e?s=128&d=identicon&r=PG&f=1", "display_name": "Dvir Moran", "link": "https://stackoverflow.com/users/9139747/dvir-moran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 128, "favorite_count": 0, "accepted_answer_id": 47975969, "answer_count": 2, "score": 0, "last_activity_date": 1514306690, "creation_date": 1514277191, "last_edit_date": 1514306690, "question_id": 47975910, "link": "https://stackoverflow.com/questions/47975910/c-program-crashes-when-assigning-values-to-a-matrix-using-a-function", "title": "C Program crashes when assigning values to a matrix using a function", "body": "<p>I was trying to make a 2D-matrix with sizes of both dimensions selected by the user (i.e. the dims[] values were assigned through scanf), and then initialize it.</p>\n\n<p>My program compiles but crashes when I try to assign values to a char matrix using a function.<br>\nI guess it has something to do with the number of columns (the second brackets) and the fact that I used an array to define the size in two dimensions of the matrix.  The problem only occurs when assigning values (and not, say, when printing).  </p>\n\n<pre><code>int main()\n{\n    int dims[2] = {3,4}; \n//^The exact values are besides the point, chose some at random \n    char board[dims[0]][dims[1]];\n    initialize_board(board, dims);\n}\n</code></pre>\n\n<p>The function looks like this (MAX_SIZE is #defined as 25):</p>\n\n<pre><code>void initialize_board(char board[][MAX_SIZE], int board_side[])\n{\n    for(int i=0; i&lt;board_side[0]; i++)\n    {\n        for(int j=0; j&lt;board_side[1]; j++)\n        {\n            board[i][j]='-';\n        }\n    }\n}\n</code></pre>\n\n<p>The function is declared like this:</p>\n\n<pre><code>void initialize_board(char board[][MAX_SIZE], int board_side[]);\n</code></pre>\n\n<p>What should I do to fix this?</p>\n"}, {"tags": ["c", "llvm"], "comments": [{"owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 0, "creation_date": 1514282218, "post_id": 47975439, "comment_id": 82922516, "body": "Doesn&#39;t that loop over <code>args</code> give you an <code>ConstantInt</code> of 100?"}, {"owner": {"reputation": 145, "user_id": 9138616, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9fdd565ce3edf45d047e85604ed1ac8e?s=128&d=identicon&r=PG&f=1", "display_name": "Hif", "link": "https://stackoverflow.com/users/9138616/hif"}, "reply_to_user": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 0, "creation_date": 1514286309, "post_id": 47975439, "comment_id": 82924117, "body": "I am not able to print it correctly. The code gets dumped when I run this code because of some error in the loop"}, {"owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 0, "creation_date": 1514289676, "post_id": 47975439, "comment_id": 82925348, "body": "Well, post the error, then."}], "answers": [{"comments": [{"owner": {"reputation": 145, "user_id": 9138616, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9fdd565ce3edf45d047e85604ed1ac8e?s=128&d=identicon&r=PG&f=1", "display_name": "Hif", "link": "https://stackoverflow.com/users/9138616/hif"}, "edited": false, "score": 0, "creation_date": 1514308941, "post_id": 47980954, "comment_id": 82931882, "body": "I tried checking if it is NULL but then it never prints anything."}, {"owner": {"reputation": 145, "user_id": 9138616, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9fdd565ce3edf45d047e85604ed1ac8e?s=128&d=identicon&r=PG&f=1", "display_name": "Hif", "link": "https://stackoverflow.com/users/9138616/hif"}, "edited": false, "score": 0, "creation_date": 1514334095, "post_id": 47980954, "comment_id": 82938989, "body": "if (arg != NULL)           //errs() &lt;&lt; arg-&gt;getValue() &lt;&lt; &quot;\\n&quot;;"}], "tags": [], "owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "is_accepted": false, "score": 1, "last_activity_date": 1514304142, "creation_date": 1514304142, "answer_id": 47980954, "question_id": 47975439, "link": "https://stackoverflow.com/questions/47975439/writing-an-llvm-pass-to-detect-malloc-function-calls-number-of-bytes-assigned-a/47980954#47980954", "title": "Writing an LLVM pass to detect malloc function calls, number of bytes assigned and the variable name pointing to that memory", "body": "<p>You don't check the result of <code>dyn_cast&lt;ConstantInt&gt;(&amp;(*args))</code>. If casted type is not a <code>ConstantInt</code>, it returns <code>nullptr</code>. And in the next line (<code>arg-&gt;getValue()</code>) you dereference it.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 11755917, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-rykw08-suuY/AAAAAAAAAAI/AAAAAAAAAJc/I6IYoupHv_o/photo.jpg?sz=128", "display_name": "shrep", "link": "https://stackoverflow.com/users/11755917/shrep"}, "is_accepted": false, "score": 0, "last_activity_date": 1596562529, "last_edit_date": 1596562529, "creation_date": 1596562186, "answer_id": 63252156, "question_id": 47975439, "link": "https://stackoverflow.com/questions/47975439/writing-an-llvm-pass-to-detect-malloc-function-calls-number-of-bytes-assigned-a/63252156#63252156", "title": "Writing an LLVM pass to detect malloc function calls, number of bytes assigned and the variable name pointing to that memory", "body": "<p>I prefer detecting malloc calls,</p>\n<ol>\n<li>by first detecting store insts</li>\n<li>then checking whether LHS is a pointer</li>\n<li>then find out what is RHS (by using a stack approach to find actual value, since LLVM IR is a load-store architecture and hence we don't find the actual value in RHS, always)</li>\n<li>if I end up getting a call inst then</li>\n<li>check whether its malloc or not</li>\n</ol>\n<p>Once you have detected the malloc, you can simply fetch the bytes accessed by ip-&gt;getOperand(0)\nAnd the variable name pointing to the memory is nothing but the value returned by Store inst that you just started with - <strong>lhs</strong> in the code</p>\n<p>Am sharing the code snippet,which will also work for inter-procedural cases as well and also supports new operator .</p>\n<pre><code>void findOperand(Value *itVal) {\n            std::stack&lt;Value *&gt; st;\n            st.push(itVal);\n            while(!st.empty()) {\n\n                auto ele = st.top();\n                st.pop();\n\n                if(isa&lt;Instruction&gt;(ele)) {\n                    Instruction *tip = (Instruction *)ele;\n                    if(isa&lt;AllocaInst&gt;(tip)) {\n                        errs()&lt;&lt;&quot;others\\n&quot;;\n                        //opdSet.insert(ele);\n                    }else if(isa&lt;LoadInst&gt;(tip)) {\n                        Value *ti = tip-&gt;getOperand(0);\n                        if(!isa&lt;ConstantData&gt;(ti))\n                            st.push(ti);\n                    } else if(isa&lt;CallInst&gt;(tip)) {\n                        Function *calledFp = cast&lt;CallInst&gt;(tip)-&gt;getCalledFunction();\n                        \n                        errs()&lt;&lt;calledFp-&gt;getName()&lt;&lt;&quot;\\n&quot;;\n                        if(calledFp-&gt;getName() == &quot;malloc&quot; || calledFp-&gt;getName() == &quot;_Znwm&quot;) {\n                            errs()&lt;&lt;&quot;Dynamic memory allocation!\\n&quot;;\n                            errs()&lt;&lt;tip-&gt;getNumOperands()&lt;&lt;&quot;\\n&quot;;\n                            errs()&lt;&lt;tip-&gt;getOperand(0)&lt;&lt;&quot;\\n&quot;;\n                        } else {\n                            //fetch the last bb of the function\n                            auto bb = calledFp-&gt;end();\n                            if(bb != calledFp-&gt;begin()) {\n                                bb --;\n                                BasicBlock *bp = &amp;(*bb);\n                                //fetch the terminator\n                                Instruction *term = bp-&gt;getTerminator();\n                                if(isa&lt;ReturnInst&gt;(term)) {\n                                    //find Operand\n                                    findOperand(term-&gt;getOperand(0));\n                                    errs()&lt;&lt;&quot;done\\n&quot;;\n                                }\n                                \n                            }\n                        }\n                    } else {\n                        for(int i=0, numOp = tip-&gt;getNumOperands(); i &lt; numOp; i++) {\n                            Value *ti = tip-&gt;getOperand(i);                     \n                            if(!isa&lt;ConstantData&gt;(ti)) {\n                                st.push(ti);\n                            }\n                        }\n                    }\n                } else if (isa&lt;GlobalVariable&gt;(ele)) {\n                    errs()&lt;&lt;&quot;others\\n&quot;;\n                }\n            }\n            \n        }//findOperand\n\n        void visitStoreInst(StoreInst &amp;ip) {\n            \n            Value *lhs = ip.getOperand(1);\n            Value *rhs = ip.getOperand(0);\n            if(lhs-&gt;getType()-&gt;getContainedType(0)-&gt;isPointerTy()) {\n                //figure out rhs\n                errs()&lt;&lt;&quot;pointer assignment!&quot;&lt;&lt;lhs-&gt;getName()&lt;&lt;&quot;\\n&quot;;\n                findOperand(rhs);\n            }\n        }\n</code></pre>\n"}], "owner": {"reputation": 145, "user_id": 9138616, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9fdd565ce3edf45d047e85604ed1ac8e?s=128&d=identicon&r=PG&f=1", "display_name": "Hif", "link": "https://stackoverflow.com/users/9138616/hif"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1070, "favorite_count": 0, "answer_count": 2, "score": 5, "last_activity_date": 1596562529, "creation_date": 1514274206, "last_edit_date": 1514334875, "question_id": 47975439, "link": "https://stackoverflow.com/questions/47975439/writing-an-llvm-pass-to-detect-malloc-function-calls-number-of-bytes-assigned-a", "title": "Writing an LLVM pass to detect malloc function calls, number of bytes assigned and the variable name pointing to that memory", "body": "<p>I have recently begun working with LLVM. I am trying to write a pass in LLVM that given the following code</p>\n\n<pre><code>string = (char *)malloc(100);\nstring = NULL;\n</code></pre>\n\n<p>and the corresponding LLVM IR</p>\n\n<pre><code>%call = call noalias i8* @malloc(i64 100) #3\nstore i8* %call, i8** %string, align 8\nstore i8* null, i8** %string, align 8\n</code></pre>\n\n<p>detects instructions calling <code>malloc</code>, extracts <code>number of bytes</code> assigned (in this case 100), the <code>address</code> returned and the variable name that the address is assigned to. </p>\n\n<pre><code>std::map&lt;std::string, std::tuple&lt;size_t, int&gt; &gt; mem_addrs;  // stores pointer name, address and no. of bytes allocated\nCount() : ModulePass(ID) {}\n\nvirtual bool runOnModule(Module &amp;M) {\n  for (Function &amp;F: M) { \n    for (BasicBlock &amp;B: F) {\n        for (Instruction &amp;I: B) {\n            if(CallInst* call_inst = dyn_cast&lt;CallInst&gt;(&amp;I)) {\n                Function* fn = call_inst-&gt;getCalledFunction();\n                StringRef fn_name = fn-&gt;getName();\n                errs() &lt;&lt; fn_name &lt;&lt; \" : \" &lt;&lt; \"\\n\";\n                for(auto args = fn-&gt;arg_begin(); args != fn-&gt;arg_end(); ++args) {\n                    ConstantInt* arg = dyn_cast&lt;ConstantInt&gt;(&amp;(*args));\n                    if (arg != NULL)\n                            errs() &lt;&lt; arg-&gt;getValue() &lt;&lt; \"\\n\";\n                }    \n            }\n        }\n     }  \n  }\n</code></pre>\n\n<p>The output is </p>\n\n<pre><code>-VirtualBox:~/program_analysis$ opt -load $LLVMLIB/CSE231.so -analyze -count &lt; $BENCHMARKS/leaktest/leaktest.bc &gt; $OUTPUTLOGS/welcome.static.log\nok\nallocaimw\nallocaleak\nallocamalloc : 0x2f5d9e0\n0  opt             0x0000000001315cf2 llvm::sys::PrintStackTrace(_IO_FILE*) + 34\n1  opt             0x0000000001315914\n2  libpthread.so.0 0x00007f0b53f12330\n3  opt             0x00000000012ec78f llvm::APInt::toString(llvm::SmallVectorImpl&lt;char&gt;&amp;, unsigned int, bool, bool) const + 79\n4  opt             0x00000000012ed309 llvm::APInt::print(llvm::raw_ostream&amp;, bool) const + 57\n5  CSE231.so       0x00007f0b52f16661\n6  opt             0x00000000012ad6cd llvm::legacy::PassManagerImpl::run(llvm::Module&amp;) + 797\n7  opt             0x000000000058e190 main + 2752\n8  libc.so.6       0x00007f0b5313af45 __libc_start_main + 245\n9  opt             0x00000000005ab2ca\nStack dump:\n0.  Program arguments: opt -load /home/hifza/program_analysis/llvm/build/Release+Asserts/lib/CSE231.so -analyze -count \n1.  Running pass 'Instruction Counts Pass' on module '&lt;stdin&gt;'.\nSegmentation fault (core dumped)\n</code></pre>\n\n<p>I am able to detect <code>malloc</code> instructions, but I am not able to find out the corresponding memory address and the number of bytes assigned. Can anyone guide me on how can I go about doing this? Thanks. </p>\n"}, {"tags": ["c", "bluetooth", "arduino"], "owner": {"reputation": 1874, "user_id": 529690, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/cd99d469f1cc81ef5991b728b4bf548a?s=128&d=identicon&r=PG", "display_name": "eWizardII", "link": "https://stackoverflow.com/users/529690/ewizardii"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 116, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1514276307, "creation_date": 1514274159, "last_edit_date": 1514276307, "question_id": 47975432, "link": "https://stackoverflow.com/questions/47975432/pass-rr-in-ble-protocol-heart-rate-for-arduino", "title": "Pass RR in BLE Protocol [Heart Rate] for Arduino", "body": "<p><strong>code:</strong></p>\n\n<pre><code>#include &lt;BLEDevice.h&gt;\n#include &lt;BLEUtils.h&gt;\n#include &lt;BLEServer.h&gt;\n#include &lt;BLE2902.h&gt;\n\n\n\nbyte flags = 0b00011110;\nbyte bpm;\nbyte rr;\nbyte heart[8] = { 0b00011110, 60, 60, 60, 60 , 60, 60, 60};\nbyte hrmPos[1] = {2};\n\nbool _BLEClientConnected = false;\n\n#define heartRateService BLEUUID((uint16_t)0x180D)\nBLECharacteristic heartRateMeasurementCharacteristics(BLEUUID((uint16_t)0x2A37), BLECharacteristic::PROPERTY_NOTIFY);\nBLECharacteristic sensorPositionCharacteristic(BLEUUID((uint16_t)0x2A38), BLECharacteristic::PROPERTY_READ);\nBLEDescriptor heartRateDescriptor(BLEUUID((uint16_t)0x2901));\nBLEDescriptor sensorPositionDescriptor(BLEUUID((uint16_t)0x2901));\n\nclass MyServerCallbacks : public BLEServerCallbacks {\n    void onConnect(BLEServer* pServer) {\n      _BLEClientConnected = true;\n    };\n\n    void onDisconnect(BLEServer* pServer) {\n      _BLEClientConnected = false;\n    }\n};\n\nvoid InitBLE() {\n  BLEDevice::init(\"Sensor X\");\n  // Create the BLE Server\n  BLEServer *pServer = BLEDevice::createServer();\n  pServer-&gt;setCallbacks(new MyServerCallbacks());\n\n  // Create the BLE Service\n  BLEService *pHeart = pServer-&gt;createService(heartRateService);\n\n  pHeart-&gt;addCharacteristic(&amp;heartRateMeasurementCharacteristics);\n  heartRateMeasurementCharacteristics.addDescriptor(&amp;heartRateDescriptor);\n  heartRateMeasurementCharacteristics.addDescriptor(new BLE2902());\n\n  pHeart-&gt;addCharacteristic(&amp;sensorPositionCharacteristic);\n  sensorPositionCharacteristic.addDescriptor(&amp;sensorPositionDescriptor);\n\n  pServer-&gt;getAdvertising()-&gt;addServiceUUID(heartRateService);\n\n  pHeart-&gt;start();\n  // Start advertising\n  pServer-&gt;getAdvertising()-&gt;start();\n}\n\n\nvoid setup() {\n  Serial.begin(115200);\n  Serial.println(\"Start\");\n  InitBLE();\n  bpm = 1;\n  rr = 800;\n}\n\nvoid loop() {\n  // put your main code here, to run repeatedly:\n\n  heart[1] = (byte)bpm;\n  int energyUsed = 3000;\n  heart[3] = energyUsed / 256;\n  heart[6] = (byte)bpm;\n  heart[2] = energyUsed - (heart[2] * 256);\n  Serial.println(bpm);\n  Serial.println(rr);\n\n  heartRateMeasurementCharacteristics.setValue(heart, 8);\n  heartRateMeasurementCharacteristics.notify();\n\n  sensorPositionCharacteristic.setValue(hrmPos, 1);\n  rr++;\n  bpm++;\n  delay(2000);\n}\n</code></pre>\n\n<p>I have the above code - and I have been looking at this <a href=\"https://learn.adafruit.com/bluefruit-nrf52-feather-learning-guide/blecharacteristic\" rel=\"nofollow noreferrer\">here</a> but I can't figure out how do I pass the <code>RR</code> data over <code>BLE</code>. I set the flags according to the <code>BLE</code> spec shown <a href=\"https://www.bluetooth.com/specifications/gatt/viewer?attributeXmlFile=org.bluetooth.characteristic.heart_rate_measurement.xml\" rel=\"nofollow noreferrer\">here</a>. But whenever I use an app to see the data \"HRV Logger\", it says that I am not transmitted RR data. I thought all I had to do was pass heart[6] data and that would show up as <code>RR</code>. I have dummy information being passed since I'm not connected to any sensors. Help would be helpful, determining how to pass the <code>RR</code> data across, thanks! (for future reference I am using the <code>Sparkfun ESP32</code>, but this shouldn't affect solving the issue since it has to do with protocols)</p>\n"}, {"tags": ["c", "arrays", "loops", "sorting"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1514273508, "post_id": 47975324, "comment_id": 82919763, "body": "<code>if(i==1)</code>...why?"}, {"owner": {"reputation": 124, "user_id": 7104957, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ce08de2becc514346321bded3b1ade66?s=128&d=identicon&r=PG&f=1", "display_name": "rivar_", "link": "https://stackoverflow.com/users/7104957/rivar"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1514273615, "post_id": 47975324, "comment_id": 82919800, "body": "because i want to compare 2 values each time, 1-2,2-3,3-4 etc..by this way i can compare 1st value which I entered and continue then. if I wont do this, i dont have first value to compare with second value. the other option i can do this is only if i store the first number in some value."}, {"owner": {"reputation": 1052, "user_id": 3698648, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/199b49d13342baa233c08aac5793ed4d?s=128&d=identicon&r=PG&f=1", "display_name": "ntshetty", "link": "https://stackoverflow.com/users/3698648/ntshetty"}, "edited": false, "score": 0, "creation_date": 1514273840, "post_id": 47975324, "comment_id": 82919866, "body": "you are comparing every number with <code>1</code> i.e <code>i == 1</code> ??"}, {"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 3, "creation_date": 1514273891, "post_id": 47975324, "comment_id": 82919879, "body": "One way is to input the array, sort it, check for duplicates, remove the duplicates, repeat until required number of distinct values have been input.     Another way is, each time a value (after the first) is read, to check if it is already in the array, and discard it if it is.   I leave writing code for either approach as an exercise."}, {"owner": {"reputation": 124, "user_id": 7104957, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ce08de2becc514346321bded3b1ade66?s=128&d=identicon&r=PG&f=1", "display_name": "rivar_", "link": "https://stackoverflow.com/users/7104957/rivar"}, "reply_to_user": {"reputation": 1052, "user_id": 3698648, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/199b49d13342baa233c08aac5793ed4d?s=128&d=identicon&r=PG&f=1", "display_name": "ntshetty", "link": "https://stackoverflow.com/users/3698648/ntshetty"}, "edited": false, "score": 0, "creation_date": 1514278478, "post_id": 47975324, "comment_id": 82921170, "body": "@ThiruShetty no, my bad there i wanted to do this i&gt;=1, when iterator is larger/equals to 1(means we are on 2nd element in array)"}], "answers": [{"comments": [{"owner": {"reputation": 124, "user_id": 7104957, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ce08de2becc514346321bded3b1ade66?s=128&d=identicon&r=PG&f=1", "display_name": "rivar_", "link": "https://stackoverflow.com/users/7104957/rivar"}, "edited": false, "score": 0, "creation_date": 1514278547, "post_id": 47975598, "comment_id": 82921192, "body": "thanks, will check! Just wonder, does it effect efficiency if so much loops are used? I&#39;m just started with studying C so sorry if i might ask some stupid questions =/"}, {"owner": {"reputation": 297, "user_id": 9102877, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/074040db5e59bc608cfcebf9b259ebc7?s=128&d=identicon&r=PG", "display_name": "QuIcKmAtHs", "link": "https://stackoverflow.com/users/9102877/quickmaths"}, "reply_to_user": {"reputation": 124, "user_id": 7104957, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ce08de2becc514346321bded3b1ade66?s=128&d=identicon&r=PG&f=1", "display_name": "rivar_", "link": "https://stackoverflow.com/users/7104957/rivar"}, "edited": false, "score": 2, "creation_date": 1514278602, "post_id": 47975598, "comment_id": 82921212, "body": "Yes, I believe this is the most efficient one(at least that i know of)"}], "tags": [], "owner": {"reputation": 297, "user_id": 9102877, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/074040db5e59bc608cfcebf9b259ebc7?s=128&d=identicon&r=PG", "display_name": "QuIcKmAtHs", "link": "https://stackoverflow.com/users/9102877/quickmaths"}, "is_accepted": true, "score": 3, "last_activity_date": 1514275134, "creation_date": 1514275134, "answer_id": 47975598, "question_id": 47975324, "link": "https://stackoverflow.com/questions/47975324/input-array-in-c-and-check-for-same-values/47975598#47975598", "title": "Input Array in C and check for same values", "body": "<h1>Code</h1>\n\n<pre><code>#include&lt;stdio.h&gt;\nint main() {\n   int arr[20], i, j, k, size;\n   printf(\"\\nEnter array size:\");\n   scanf(\"%d\", &amp;size);\n   printf(\"\\nEnter Numbers:\");\n   for (i = 0; i &lt; size; i++)\n      scanf(\"%d\", &amp;arr[i]);\n   printf(\"\\nList of Unique Numbers:\");\n   for (i = 0; i &lt; size; i++) {\n      for (j = i + 1; j &lt; size;) {\n         if (arr[j] == arr[i]) {\n            for (k = j; k &lt; size; k++) {\n               arr[k] = arr[k + 1];\n            }\n            size--;\n         } else\n            j++;\n      }\n   }\n   for (i = 0; i &lt; size; i++) {\n      printf(\"%d \", arr[i]);\n   }\n}\n</code></pre>\n\n<h1>Explanation</h1>\n\n<p>After inputting, we start from the first element.  Then within that for loop, we have another for loop to check elements after that element.  If there is a duplicate, I remove it.  Hope this helps!</p>\n"}], "owner": {"reputation": 124, "user_id": 7104957, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ce08de2becc514346321bded3b1ade66?s=128&d=identicon&r=PG&f=1", "display_name": "rivar_", "link": "https://stackoverflow.com/users/7104957/rivar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 948, "favorite_count": 1, "accepted_answer_id": 47975598, "answer_count": 1, "score": -3, "last_activity_date": 1514278372, "creation_date": 1514273448, "last_edit_date": 1514278372, "question_id": 47975324, "link": "https://stackoverflow.com/questions/47975324/input-array-in-c-and-check-for-same-values", "title": "Input Array in C and check for same values", "body": "<p>how I can input an array of integers and check if 2 pairs of values are equal and I also want to remove the duplicated to have only 1 same value in array?\nI want to print the final result of the array without the duplicated values in it.\nI have something like this in mind: </p>\n\n<pre><code>int a[SIZE], i;\n printf(\"Enter %d numbers:\\n\", SIZE);\n for (i = 0; i &lt; SIZE; i++) {\n  scanf_s(\"%d\", a[i]);\n if(i&gt;=1){\n  if(a[i-1]==a[i]){\n  a[i-1]==a[i];\n  printf(\"%d\", a[i-1]);\n }\n}\n</code></pre>\n\n<p>this result gives me what I need but not completely. \ncan you assist with this? </p>\n"}, {"tags": ["c", "linux", "ipsec"], "answers": [{"comments": [{"owner": {"reputation": 1936, "user_id": 4265714, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh3.googleusercontent.com/-GWz2zlyQ_u0/AAAAAAAAAAI/AAAAAAAADH4/GRNAzkeBFx8/photo.jpg?sz=128", "display_name": "miradham", "link": "https://stackoverflow.com/users/4265714/miradham"}, "edited": false, "score": 0, "creation_date": 1514427928, "post_id": 47989577, "comment_id": 82970238, "body": "what would be null encryption for windows then? as per <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa366296(v=vs.85).aspx\" rel=\"nofollow noreferrer\">this page</a>  it does not provide null cipher"}], "tags": [], "owner": {"reputation": 456, "user_id": 1158499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c42143a04f2d260eaf0e818e4327a74d?s=128&d=identicon&r=PG", "display_name": "ecdsa", "link": "https://stackoverflow.com/users/1158499/ecdsa"}, "is_accepted": true, "score": 2, "last_activity_date": 1514366984, "creation_date": 1514366984, "answer_id": 47989577, "question_id": 47975159, "link": "https://stackoverflow.com/questions/47975159/ipsec-encryption-support-in-linux-sadb-ealg-none-vs-sadb-ealg-null/47989577#47989577", "title": "ipsec encryption support in linux: SADB_EALG_NONE vs SADB_EALG_NULL", "body": "<p><code>SADB_EALG_NONE</code> is used to indicate that no encryption applies for an SA, while <code>SADB_EALG_NULL</code> signifies the NULL encryption algorithm as specified in <a href=\"https://tools.ietf.org/html/rfc2410\" rel=\"nofollow noreferrer\">RFC 2410</a>. As stated in <a href=\"https://tools.ietf.org/html/rfc2367#section-3.5\" rel=\"nofollow noreferrer\">RFC 2367, section 3.5</a> the former must only be used if no encryption can apply for an SA (e.g. for AH), the latter may be used for ESP SAs and can be negotiated via IKE.</p>\n"}], "owner": {"reputation": 1936, "user_id": 4265714, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh3.googleusercontent.com/-GWz2zlyQ_u0/AAAAAAAAAAI/AAAAAAAADH4/GRNAzkeBFx8/photo.jpg?sz=128", "display_name": "miradham", "link": "https://stackoverflow.com/users/4265714/miradham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 47989577, "answer_count": 1, "score": 1, "last_activity_date": 1514366984, "creation_date": 1514272458, "question_id": 47975159, "link": "https://stackoverflow.com/questions/47975159/ipsec-encryption-support-in-linux-sadb-ealg-none-vs-sadb-ealg-null", "title": "ipsec encryption support in linux: SADB_EALG_NONE vs SADB_EALG_NULL", "body": "<p>In <code>linux/pfkeyv2.h</code> I can see following values:</p>\n\n<pre><code>#define SADB_EALG_NONE          0\n...\n#define SADB_EALG_NULL          11\n</code></pre>\n\n<p>Anyone can explain what is the difference between those values and how specifying those values in <code>sadb_sa.sadb_sa_encrypt</code> would affect ipsec encryption?</p>\n"}, {"tags": ["c", "realloc"], "comments": [{"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1514272140, "post_id": 47975074, "comment_id": 82919378, "body": "Please could you supply the link to the reference"}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 1, "creation_date": 1514272141, "post_id": 47975074, "comment_id": 82919379, "body": "yes, <code>realloc</code> can return a different address. When that happens, the old one is freed by <code>realloc</code> and can safely ignore it. However, if <code>realloc</code>fails, it will return <code>NULL</code> and the old address will still be valid."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1514272189, "post_id": 47975074, "comment_id": 82919395, "body": "But <code>realloc</code> can also return the <i>same</i> address (and still grow the memory zone...)"}, {"owner": {"reputation": 120, "user_id": 8165940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9TFAD.jpg?s=128&g=1", "display_name": "Pratik Bhatu", "link": "https://stackoverflow.com/users/8165940/pratik-bhatu"}, "reply_to_user": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1514272299, "post_id": 47975074, "comment_id": 82919430, "body": "@EdHeal <a href=\"http://en.cppreference.com/w/c/memory/realloc\" rel=\"nofollow noreferrer\">en.cppreference.com/w/c/memory/realloc</a>"}, {"owner": {"reputation": 11238, "user_id": 7594711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7872c871b0431b72df6350dd0394bea?s=128&d=identicon&r=PG&f=1", "display_name": "SoronelHaetir", "link": "https://stackoverflow.com/users/7594711/soronelhaetir"}, "edited": false, "score": 0, "creation_date": 1514272428, "post_id": 47975074, "comment_id": 82919469, "body": "And if realloc does fail then you had better have kept the old address (a in your case) because otherwise you have no way to recover it. so don&#39;t ever do &quot;a = realloc(a, newSize);&quot;"}, {"owner": {"reputation": 120, "user_id": 8165940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9TFAD.jpg?s=128&g=1", "display_name": "Pratik Bhatu", "link": "https://stackoverflow.com/users/8165940/pratik-bhatu"}, "reply_to_user": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1514272797, "post_id": 47975074, "comment_id": 82919576, "body": "@Pablo If it returns NULL old address will certainly be valid but since b is NULL it will not alias a right? i am more interested in the case where realloc is done in-place"}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1514313407, "post_id": 47975074, "comment_id": 82933253, "body": "@PratikBhatu I don&#39;t know what you mean by &quot;alias&quot;, don&#39;t know where you&#39;ve got this term. In any case, you are using the term wrong. <code>realloc</code> returns a pointer to a new object with the new size requirements. This object <b>may</b> be in the same memory position as the old one, it also may be in another position. That&#39;s all you need to know."}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1514313596, "post_id": 47975074, "comment_id": 82933318, "body": "@PratikBhatu In any case you should never do stuff like this: <code>a = realloc(a, newsize)</code> but declare a new pointer <code>tmp</code> and do <code>tmp = realloc(a, newsize);</code>. Afterwards check for <code>tmp == NULL</code>. If that&#39;s the case, <code>realloc</code> fail and <code>a</code> points to a valid region. If <code>tmp != NULL</code> then you can safely do <code>a = tmp;</code> and keep working."}, {"owner": {"reputation": 120, "user_id": 8165940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9TFAD.jpg?s=128&g=1", "display_name": "Pratik Bhatu", "link": "https://stackoverflow.com/users/8165940/pratik-bhatu"}, "reply_to_user": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1514350185, "post_id": 47975074, "comment_id": 82941782, "body": "@Pablo I had originally tagged the question with compiler-construction too, but a mod removed that tag. I mean aliasing from a compiler optimization point of view <a href=\"https://en.wikipedia.org/wiki/Alias_analysis\" rel=\"nofollow noreferrer\">wiki-link</a>. And yes, i understand why I should never do a = realloc(a,..). Thank you!"}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1514350375, "post_id": 47975074, "comment_id": 82941835, "body": "@PratikBhatu ok, that make sense. I didn&#39;t know the term <i>alias</i> in that context."}], "answers": [{"comments": [{"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "edited": false, "score": 0, "creation_date": 1514272327, "post_id": 47975105, "comment_id": 82919437, "body": "How the comparison is valid here after <code>a</code> is freed?"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 75299, "user_id": 139746, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/BhJLC.png?s=128&g=1", "display_name": "Pascal Cuoq", "link": "https://stackoverflow.com/users/139746/pascal-cuoq"}, "edited": false, "score": 0, "creation_date": 1514274123, "post_id": 47975105, "comment_id": 82919950, "body": "@PascalCuoq Yes, I see that now clearly after haccks&#39;s answer. The object it points to does not exist anymore, so the pointer is indeterminate. I&#39;ll update accordingly and thanks for the comment."}, {"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "reply_to_user": {"reputation": 75299, "user_id": 139746, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/BhJLC.png?s=128&g=1", "display_name": "Pascal Cuoq", "link": "https://stackoverflow.com/users/139746/pascal-cuoq"}, "edited": false, "score": 1, "creation_date": 1514274264, "post_id": 47975105, "comment_id": 82919991, "body": "@PascalCuoq; Man! I was looking upto that post to backup my answer because I remember I read somewhere about this where you refer this post once. Thanks a ton."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "edited": false, "score": 0, "creation_date": 1514274514, "post_id": 47975105, "comment_id": 82920057, "body": "@haccks Now both of us got to bookmark that one. :)"}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 2, "last_activity_date": 1514274973, "last_edit_date": 1514274973, "creation_date": 1514272122, "answer_id": 47975105, "question_id": 47975074, "link": "https://stackoverflow.com/questions/47975074/can-we-safely-say-that-the-result-of-realloc-does-not-alias-with-the-original-po/47975105#47975105", "title": "Can we safely say that the result of realloc does not alias with the original pointer?", "body": "<blockquote>\n  <p><em>Based on my understanding, the comparison of <code>a == b</code> itself would be UB..</em></p>\n</blockquote>\n\n<p>Well, yes.</p>\n\n<p>Regarding the \"why\" part, as mentioned in <a href=\"https://stackoverflow.com/a/47975328/2173917\">haccks's answer</a>, after a pointer has been <code>free()</code>d, the object it points to reaches the end of it's lifetime, thus making the pointer value <em>indeterminate</em>. So, any further use (<em>read</em>) of the pointer itself would be unspecified behavior at best and any attempted usage of the address pointed to by it, would invoke <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behavior</a>.</p>\n\n<p>So, technically, the optimization you expect, would be correct and would be a <strong>must</strong> to make the code exhibit a defined behavior, as the code is incorrect to start with. Do not expect the compiler to <em>correct</em> your code, it may not.</p>\n\n<p>That said, regarding</p>\n\n<blockquote>\n  <p><em>Can we safely say that \"b\" does not alias with \"a\"?</em></p>\n</blockquote>\n\n<p>I'm not very clear on what ground you used the <em>alias</em> here, but just to be sure, the official wording, from <code>C11</code>, chapter \u00a77.22.3.5,</p>\n\n<p>P2:</p>\n\n<blockquote>\n  <p>The <code>realloc</code> function deallocates the old object pointed to by <code>ptr</code> and returns a\n  pointer to a new object that has the size specified by <code>size</code>. The contents of the new\n  object shall be the same as that of the old object prior to deallocation, up to the lesser of\n  the new and old sizes. [...]</p>\n</blockquote>\n\n<p>P3:</p>\n\n<blockquote>\n  <p>[...]  If <code>ptr</code> is a null pointer, the <code>realloc</code> function behaves like the <code>malloc</code> function for the\n  specified <code>size</code>. Otherwise, if <code>ptr</code> does not match a pointer earlier returned by a memory\n  management function, or if the space has been deallocated by a call to the <code>free</code> or\n  <code>realloc</code> function, the behavior is undefined. If memory for the new object cannot be\n  allocated, the old object is not deallocated and its value is unchanged.</p>\n</blockquote>\n\n<p>and, P4:</p>\n\n<blockquote>\n  <p>The <code>realloc</code> function returns a pointer to the new object (which may have the same\n  value as a pointer to the old object), or a null pointer if the new object could not be\n  allocated.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "is_accepted": true, "score": 3, "last_activity_date": 1514281332, "last_edit_date": 1514281332, "creation_date": 1514273474, "answer_id": 47975328, "question_id": 47975074, "link": "https://stackoverflow.com/questions/47975074/can-we-safely-say-that-the-result-of-realloc-does-not-alias-with-the-original-po/47975328#47975328", "title": "Can we safely say that the result of realloc does not alias with the original pointer?", "body": "<p>After freeing, the value of <code>a</code> is indeterminate.  </p>\n\n<p>n1570-\u00a76.2.3 (p2):</p>\n\n<blockquote>\n  <p>[...] If an object is referred to outside of its lifetime, the behavior is undefined. The value of a pointer becomes indeterminate when the object it points to (or just past) reaches the end of its lifetime.</p>\n</blockquote>\n\n<p>If this indeterminate value becomes trap representation the comparison <code>a == b</code> will cause an undefined behavior. </p>\n\n<p>Note that the lifetime of the object pointed to by pointer reaches its end when the pointer is passed to <code>free</code>. </p>\n\n<p>Further readings:<br>\n1. <a href=\"http://c-faq.com/malloc/ptrafterfree.html\" rel=\"nofollow noreferrer\">Why isn't a pointer null after calling free? </a><br>\n2. <a href=\"http://trust-in-soft.com/dangling-pointer-indeterminate/\" rel=\"nofollow noreferrer\">A dangling pointer is indeterminate</a>.</p>\n"}], "owner": {"reputation": 120, "user_id": 8165940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9TFAD.jpg?s=128&g=1", "display_name": "Pratik Bhatu", "link": "https://stackoverflow.com/users/8165940/pratik-bhatu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 1, "accepted_answer_id": 47975328, "answer_count": 2, "score": 4, "last_activity_date": 1514281332, "creation_date": 1514271925, "last_edit_date": 1514272630, "question_id": 47975074, "link": "https://stackoverflow.com/questions/47975074/can-we-safely-say-that-the-result-of-realloc-does-not-alias-with-the-original-po", "title": "Can we safely say that the result of realloc does not alias with the original pointer?", "body": "<p>Say we have:</p>\n\n<pre><code>char *a = malloc(sizeof(char*));    \nchar *b = realloc(a,sizeof(char*));\n</code></pre>\n\n<p>Can we safely say that <code>b</code> does not alias with <code>a</code>? The <code>realloc</code> reference page says that</p>\n\n<blockquote>\n  <p>The original pointer ptr is invalidated and any access to it is\n  undefined behavior (even if reallocation was in-place).</p>\n</blockquote>\n\n<p>So can I mark <code>b</code> as not aliasing <code>a</code> as we cannot legally access <code>a</code> anymore? However this could result in a questionable optimization where the below branch would be eliminated:</p>\n\n<pre><code>if (a == b)\n  something..\n</code></pre>\n\n<p>Based on my understanding, the comparison of <code>a == b</code> itself would be UB so is this a technically correct optimization?</p>\n"}, {"tags": ["c", "string", "pointers", "malloc"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1514267936, "post_id": 47974423, "comment_id": 82918192, "body": "<code>I am writing a simple code which accepts a string from the user of any length and just displays it.</code>...to  much work you&#39;re doing here..."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1514267979, "post_id": 47974423, "comment_id": 82918196, "body": "<i>&quot;I don&#39;t know what&#39;s going wrong with this code?&quot;</i> - A mere question mark doesn&#39;t make that sentence into a question. Read <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">this post about debugging</a>."}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 1, "creation_date": 1514268253, "post_id": 47974423, "comment_id": 82918272, "body": "You want to <code>accepts a string from the user of any length</code> but you only have an array of 19 characters"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1514270064, "post_id": 47974423, "comment_id": 82918772, "body": "<code>fgets</code> is far more conducive to what you are doing here than <code>scanf</code> (and that is generally the case any time user-input is involved)"}, {"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 1, "creation_date": 1514281790, "post_id": 47974423, "comment_id": 82922370, "body": "One point subtracted for meaningless question title."}], "answers": [{"tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": true, "score": 4, "last_activity_date": 1514273344, "last_edit_date": 1514273344, "creation_date": 1514267987, "answer_id": 47974434, "question_id": 47974423, "link": "https://stackoverflow.com/questions/47974423/i-dont-know-whats-going-wrong-with-this-code/47974434#47974434", "title": "I don&#39;t know what&#39;s going wrong with this code?", "body": "<p>There are multiple issues, but at first look, the most prominent one is,</p>\n\n<pre><code>  s=malloc(5*sizeof(char));\n</code></pre>\n\n<p>is wrong. <code>s</code> is of type <code>char **</code>, so you'd need to allocate memory worth of <code>char *</code> there. In other words, you expect <code>s</code> to point to a <code>char *</code> element, so, you need to allocate memory accordingly.</p>\n\n<p>To avoid <em>these</em> sort of mistakes, never rely on <em>hardcoded</em> data types, rather, use the form</p>\n\n<pre><code> s = malloc( 5 * sizeof *s);  // same as s=malloc( 5 * sizeof (*s))\n</code></pre>\n\n<p>where, the size oid essentially determined from the type of the variable. Two advantages</p>\n\n<ul>\n<li>You avoid mistakes like above.</li>\n<li>The code becomes more resilient, you don;t need to change the <code>malloc()</code> statement in case you choose to change the data type </li>\n</ul>\n\n<p>That said, <code>scanf(\"%s\",a);</code> is also potentially dangerous and cause buffer overflow by longer-than-expected-input. You should always limit the input scanning length, using the maximum field width, like</p>\n\n<pre><code>scanf(\"%19s\",a);  // a is array of dimension 20, one for terminating null\n</code></pre>\n\n<hr>\n\n<p>That said, to advice about the logic, when you don't know or don't dictate the length of the input string beforehand, you cannot use a <em>string</em> type to <em>scan</em> the input. The basic way of getting this done would be</p>\n\n<ol>\n<li>Allocate a moderate length buffer, dynamically, using allocator functions like <code>malloc()</code>.</li>\n<li>Keep reading the input stream one by one, <code>fgetc()</code> or alike.</li>\n<li>If the read is complete (for example, return of <code>EOF</code>), you've read the complete input.</li>\n<li>If the allocated memory has run out, re-allocate the original buffer and continue to step 3.</li>\n</ol>\n\n<p>and, don't forget to <code>free()</code> the memory.</p>\n\n<p>Otherwise, you may use <code>fgets()</code> to read chunks of memory and keep realloacting as mentioned above.</p>\n"}], "owner": {"reputation": 125, "user_id": 8773110, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4fe788561ab3e97548601a14433e7875?s=128&d=identicon&r=PG&f=1", "display_name": "Coderandhacker", "link": "https://stackoverflow.com/users/8773110/coderandhacker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "accepted_answer_id": 47974434, "answer_count": 1, "score": -3, "last_activity_date": 1514273344, "creation_date": 1514267885, "last_edit_date": 1514268550, "question_id": 47974423, "link": "https://stackoverflow.com/questions/47974423/i-dont-know-whats-going-wrong-with-this-code", "title": "I don&#39;t know what&#39;s going wrong with this code?", "body": "<p>I am writing a simple code which accepts a string from the user of any length and just displays it. But my code is not doing it correctly as it accepts the string but not prints it correctly.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n#include&lt;string.h&gt;\nmain()\n{\n    int i,len;\n    static int n=5;\n    char a[20];\n    char **s;\n    s=malloc(5*sizeof(char));\n    char *p;\n    for(i=0;i&lt;n;i++)\n    {\n        scanf(\"%s\",a);\n        if(*a=='1')                   /*to exit from loop*/\n        {\n            break;\n        }\n        len=strlen(a);\n        p=malloc((len+1)*sizeof(char));\n        strcpy(p,a);\n        s[i]=p;\n        if(i==n-1)\n        {\n            s=realloc(s,(5+i*5)*sizeof(char));\n            n=5+i;\n        }\n    }\n    for(i=0;i&lt;n-1;i++)\n    {\n        printf(\"%s \",s[i]);\n    }\n    free(p);\n    p=NULL;\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "windows", "filesystems", "kernel", "wdk"], "comments": [{"owner": {"reputation": 11238, "user_id": 7594711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7872c871b0431b72df6350dd0394bea?s=128&d=identicon&r=PG&f=1", "display_name": "SoronelHaetir", "link": "https://stackoverflow.com/users/7594711/soronelhaetir"}, "edited": false, "score": 0, "creation_date": 1514267789, "post_id": 47974327, "comment_id": 82918160, "body": "I would certainly expect such a device to show in disk manager."}, {"owner": {"reputation": 29355, "user_id": 205580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460e6e299e385fd46df156c85a1dd55f?s=128&d=identicon&r=PG", "display_name": "Eryk Sun", "link": "https://stackoverflow.com/users/205580/eryk-sun"}, "edited": false, "score": 1, "creation_date": 1514269416, "post_id": 47974327, "comment_id": 82918593, "body": "A mount point is a reparse point, i.e. a path component at which the object manager restarts parsing. It should use the reparse tag <code>IO_REPARSE_TAG_MOUNT_POINT</code>. The mount-point manager should assign your device a GUID volume name, i.e. &quot;Volume{...}&quot;, associated with its <a href=\"https://msdn.microsoft.com/en-us/library/ff560441\" rel=\"nofollow noreferrer\">unique ID</a>. This can be used as the substitute name in the <a href=\"https://msdn.microsoft.com/en-us/library/ff552012\" rel=\"nofollow noreferrer\"><code>MountPointReparseBuffer</code></a>. NTFS and ReFS support NT reparse points, but FAT filesystems do not."}, {"owner": {"reputation": 1516, "user_id": 173586, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/d2eb309aa6ae765ae391a92058d303aa?s=128&d=identicon&r=PG", "display_name": "lundman", "link": "https://stackoverflow.com/users/173586/lundman"}, "edited": false, "score": 0, "creation_date": 1514364717, "post_id": 47974327, "comment_id": 82946637, "body": "Ah so they are connected, now I wish I had returned FILE_SUPPORTS_REPARSE_POINTS when I started looking at this 2 weeks ago.   I spent all day trying to get HLK to work, as I heard there was a tester in there. Hassle to do, but I can at least run ifstest.exe now, and it has not been hard to find tests that fail, so I have something to do for now."}, {"owner": {"reputation": 29355, "user_id": 205580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460e6e299e385fd46df156c85a1dd55f?s=128&d=identicon&r=PG", "display_name": "Eryk Sun", "link": "https://stackoverflow.com/users/205580/eryk-sun"}, "edited": false, "score": 0, "creation_date": 1514421712, "post_id": 47974327, "comment_id": 82969087, "body": "All Windows mount points are reparse points, but usually they&#39;re Object-Manager SymbolicLink objects. For example volume GUID names, DOS drive letters, and other DOS device names are persisted in the registry under &quot;HKLM\\System\\MountedDevices&quot; and &quot;HKLM\\System\\CurrentControlSet\\Control\\Session Manager\\DOS Devices&quot;. You mentioned <a href=\"https://msdn.microsoft.com/en-us/library/ff549043\" rel=\"nofollow noreferrer\"><code>IoCreateSymbolicLink</code></a>, which creates a link in the object manager&#39;s &quot;\\Global??&quot; object directory, e.g. for the &quot;C:&quot; drive, &quot;\\Global??\\C:&quot; may be reparsed as &quot;\\Device\\HarddiskVolume2&quot;."}, {"owner": {"reputation": 29355, "user_id": 205580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460e6e299e385fd46df156c85a1dd55f?s=128&d=identicon&r=PG", "display_name": "Eryk Sun", "link": "https://stackoverflow.com/users/205580/eryk-sun"}, "edited": false, "score": 0, "creation_date": 1514422429, "post_id": 47974327, "comment_id": 82969246, "body": "To connect this in one example, say you create a junction mount point &quot;C:\\Mount\\Spam&quot; that redirects to &quot;\\??\\Volume{...}&quot;, which in turn is associated with &quot;\\Device\\HarddiskVolume10&quot;. Accessing &quot;C:\\Mount\\Spam\\Dir\\File.ext&quot; has to be reparsed initially as &quot;\\Device\\HarddiskVolume2\\Mount\\Spam\\Dir\\File.ext&quot;. Then when the NTFS filesystem reaches &quot;Spam&quot;, it reads the junction reparse point, so parsing starts over with &quot;\\??\\Volume{...}\\Dir\\File.ext&quot;, which is finally reparsed as &quot;\\Device\\HarddiskVolume10\\Dir\\File.ext&quot;."}, {"owner": {"reputation": 1516, "user_id": 173586, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/d2eb309aa6ae765ae391a92058d303aa?s=128&d=identicon&r=PG", "display_name": "lundman", "link": "https://stackoverflow.com/users/173586/lundman"}, "edited": false, "score": 0, "creation_date": 1514509182, "post_id": 47974327, "comment_id": 83001612, "body": "Ok, sounds like they work a bit like vnode_mountedon in Unix, except instead of being &quot;mounted on&quot; when you issue a mount, you need to prepare a mountpoint by making it to a reparse point, which like a symlink, &quot;points&quot; to another place to continue name lookup. I&#39;ll continue using ifstest to make my code more correct, I only just learned about DELETE_ON_CLOSE on directories, surprise! :)"}, {"owner": {"reputation": 29355, "user_id": 205580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460e6e299e385fd46df156c85a1dd55f?s=128&d=identicon&r=PG", "display_name": "Eryk Sun", "link": "https://stackoverflow.com/users/205580/eryk-sun"}, "edited": false, "score": 0, "creation_date": 1514991534, "post_id": 47974327, "comment_id": 83133631, "body": "The difference to a Unix symlink is that reparse points are centralized in the filesystem, so <code>FindFirstVolumeMountPointW</code> can easily enumerate all mountpoints on a volume. It opens the special index stream &quot;$Extend\\$Reparse:$R:$INDEX_ALLOCATION&quot; and enumerates all reparse points via <code>NtQueryDirectoryFile</code>, <code>FileReparsePointInformation</code>. A volume mountpoint uses the tag <code>IO_REPARSE_TAG_MOUNT_POINT</code> with a substitute path that&#39;s a &quot;Volume{GUID}&quot; name."}, {"owner": {"reputation": 1516, "user_id": 173586, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/d2eb309aa6ae765ae391a92058d303aa?s=128&d=identicon&r=PG", "display_name": "lundman", "link": "https://stackoverflow.com/users/173586/lundman"}, "edited": false, "score": 0, "creation_date": 1515726569, "post_id": 47974327, "comment_id": 83419815, "body": "I got one more surprise discovery, like on Unix, I would just create the directory (mkdir, or Explorer new folder) then make it a REPARSE point - and not having much luck with it. But if I do as the examples, and call CreateFile to both create the dir, and mark it REPARSE things started working better.  It seems to open my volume with NULL name (volume open?) then call dirlist. But if I reply in dirlist, I see my files, so I feel confident something is working finally. But why should volumeopen return error if FILE_DIRECTORY_FILE, that is confusing..."}, {"owner": {"reputation": 1516, "user_id": 173586, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/d2eb309aa6ae765ae391a92058d303aa?s=128&d=identicon&r=PG", "display_name": "lundman", "link": "https://stackoverflow.com/users/173586/lundman"}, "edited": false, "score": 0, "creation_date": 1516783629, "post_id": 47974327, "comment_id": 83825937, "body": "So much learned. It uses SET_REPARSEPOINT and expects the FS to store the struct, which is returned with GET, or TagAttrInformation. The tag is also returned in EASize in dirlists. In MJ_CREATE, as you descend dirs, you need to check if each dir is a reparsepoint, and if so, return STATUS_REPARSE, setting the AuxBuf to the stored struct, and Reserved field to &#39;chars left in Filename&#39;."}, {"owner": {"reputation": 29355, "user_id": 205580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460e6e299e385fd46df156c85a1dd55f?s=128&d=identicon&r=PG", "display_name": "Eryk Sun", "link": "https://stackoverflow.com/users/205580/eryk-sun"}, "edited": false, "score": 0, "creation_date": 1517025784, "post_id": 47974327, "comment_id": 83938737, "body": "Are you trying to support reparse points in your own filesystem, or do you just need to support mounting your volume in an NTFS volume? For the latter your device just needs a &quot;Volume{GUID}&quot; name. Register support for <a href=\"https://msdn.microsoft.com/en-us/library/windows/hardware/ff561594\" rel=\"nofollow noreferrer\">mount manager IOCTLs</a> such as <code>IOCTL_MOUNTDEV_QUERY_UNIQUE_ID IOCTL</code> and <code>IOCTL_MOUNTDEV_QUERY_DEVICE_NAME IOCTL</code> (non-persistent). The mount manager creates and persists a &quot;Volume{GUID}&quot; name that&#39;s associated with the unique ID of your device, and maps this to the non-persistent device name that you provide."}, {"owner": {"reputation": 1516, "user_id": 173586, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/d2eb309aa6ae765ae391a92058d303aa?s=128&d=identicon&r=PG", "display_name": "lundman", "link": "https://stackoverflow.com/users/173586/lundman"}, "edited": false, "score": 0, "creation_date": 1517369587, "post_id": 47974327, "comment_id": 84063540, "body": "Yep, I have all of it working. Both to set reparse point in C: (ntfs) and to set it in my own FS (zfs). It surprised me I had to detect reparse points during lookup, and return STATUS_REPARSE &quot;manually&quot;."}, {"owner": {"reputation": 29355, "user_id": 205580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460e6e299e385fd46df156c85a1dd55f?s=128&d=identicon&r=PG", "display_name": "Eryk Sun", "link": "https://stackoverflow.com/users/205580/eryk-sun"}, "edited": false, "score": 0, "creation_date": 1517377134, "post_id": 47974327, "comment_id": 84065661, "body": "I assume for the second sentence you&#39;re talking about implementing support for reparse points in your own FS. Why does it surprise you that parsing the new path has to jump back to the top in the Object Manager?"}, {"owner": {"reputation": 29355, "user_id": 205580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460e6e299e385fd46df156c85a1dd55f?s=128&d=identicon&r=PG", "display_name": "Eryk Sun", "link": "https://stackoverflow.com/users/205580/eryk-sun"}, "edited": false, "score": 0, "creation_date": 1517377172, "post_id": 47974327, "comment_id": 84065678, "body": "It surprised me that the Object Manager limits the number of reparse attempts for an open to 64 (or 32 in older versions). It also surprised me that the reparse buffer is limited to 16KB, split between the display name and the substitute path. Since an NT path is up to 64KB, we can&#39;t directly symlink to very long NT paths. An 8KB path is still more than long enough, so in practice it&#39;s not an issue, but it&#39;s still an ugly wart in the design."}, {"owner": {"reputation": 1516, "user_id": 173586, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/d2eb309aa6ae765ae391a92058d303aa?s=128&d=identicon&r=PG", "display_name": "lundman", "link": "https://stackoverflow.com/users/173586/lundman"}, "edited": false, "score": 0, "creation_date": 1517389082, "post_id": 47974327, "comment_id": 84071222, "body": "Surprised in that &quot;clearly I&#39;ve been spoiled&quot;. All handled in VFS layer in Unix before calling the FS, so my FS would never see a &quot;mounted on&quot; vnode. Similarly, I discovered that my FS has to send all the fsevents as well (the DirectoryChangeNotify). Something I was previously used to VFS handling :)"}], "owner": {"reputation": 1516, "user_id": 173586, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/d2eb309aa6ae765ae391a92058d303aa?s=128&d=identicon&r=PG", "display_name": "lundman", "link": "https://stackoverflow.com/users/173586/lundman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 134, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1514267208, "creation_date": 1514267208, "question_id": 47974327, "link": "https://stackoverflow.com/questions/47974327/wdk-named-mounts-instead-of-drive-letters-winifs", "title": "WDK: &quot;named mounts&quot; instead of drive letters - WinIFS", "body": "<p>File-systems on Windows. </p>\n\n<p>So, I have written my own FSD, and it gets assigned a drive letter, and if I reply appropriately to <code>IOCTL_MOUNTDEV_QUERY_SUGGESTED_LINK_NAME</code> I can even change/set which drive letter to assign, for example by returning a string like \"\\DosDevices\\G:\".</p>\n\n<p>But I would also be able to use \"named mounts\", like that of \"C:\\directory\". I can not return that above (return buffer size is only enough to hold drive letter name). </p>\n\n<p>So I have been trying for a while to get named mounts to work, but there seems to be many parts to it.  For example, using <code>IOCTL_MOUNTMGR_CREATE_POINT</code> from kernel, IoCreateSymbolicLink() which some examples seem to use. Or is it better to use <code>FSCTL_SET_REPARSE_POINT</code> from userland with <code>SetVolumeMountPoint()</code> ?</p>\n\n<ul>\n<li>So, I think I should be able to managed to get a \"drive\" mounted as \"C:\\Some\\Directory\" without having a drive letter.</li>\n<li>Should I seek a kernel-space, or userland, approach to setting a \"named mount\" (or does it require both?)</li>\n<li>If my FSD is done right, should it show in \"Disk Manager\" or will only real physical disks show there. Is that desirable?</li>\n<li>Is a reparse-point connected to mounts at all?</li>\n</ul>\n\n<p>I do not think the MS Samples \"fastfat\" allows for named mounts, or I would follow its example.</p>\n"}]