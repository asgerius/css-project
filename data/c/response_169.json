[{"tags": ["c", "atomic", "c11"], "comments": [{"owner": {"reputation": 85822, "user_id": 597607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jCzJi.png?s=128&g=1", "display_name": "Bo Persson", "link": "https://stackoverflow.com/users/597607/bo-persson"}, "edited": false, "score": 0, "creation_date": 1522886158, "post_id": 49661987, "comment_id": 86334220, "body": "It might be that your system has no 32-bit types <i>at all</i>. Like if it is a <a href=\"https://stackoverflow.com/a/6972551/597607\">36-bit computer</a>,"}, {"owner": {"reputation": 4681, "user_id": 6651824, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/LWsU0.jpg?s=128&g=1", "display_name": "LWimsey", "link": "https://stackoverflow.com/users/6651824/lwimsey"}, "edited": false, "score": 3, "creation_date": 1522887584, "post_id": 49661987, "comment_id": 86334626, "body": "Note that <code>sig_atomic_t</code> is different from the types in <code>&lt;stdatomic.h&gt;</code>. It does not provide inter-thread synchronization and the only guarantee is that it&#39;s an indivisible type. Often used in combination with <code>volatile</code>"}], "answers": [{"comments": [{"owner": {"reputation": 522, "user_id": 2498993, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/8f881d06776cfe34de58faa0a1e8181d?s=128&d=identicon&r=PG", "display_name": "damingzi", "link": "https://stackoverflow.com/users/2498993/damingzi"}, "edited": false, "score": 0, "creation_date": 1523297936, "post_id": 49662023, "comment_id": 86492911, "body": "but I didn&#39;t find stdatomic.h packaged in my gcc. Which gcc version has it?"}, {"owner": {"reputation": 6746, "user_id": 1143634, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/e7lca.png?s=128&g=1", "display_name": "StaceyGirl", "link": "https://stackoverflow.com/users/1143634/staceygirl"}, "reply_to_user": {"reputation": 522, "user_id": 2498993, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/8f881d06776cfe34de58faa0a1e8181d?s=128&d=identicon&r=PG", "display_name": "damingzi", "link": "https://stackoverflow.com/users/2498993/damingzi"}, "edited": false, "score": 0, "creation_date": 1523299434, "post_id": 49662023, "comment_id": 86493677, "body": "@damingzi I don&#39;t know when it first appeared, but GCC 7.3 has it."}, {"owner": {"reputation": 170705, "user_id": 44330, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/dd5a7ef1476fb01998a215b1642dfd07?s=128&d=identicon&r=PG", "display_name": "Jason S", "link": "https://stackoverflow.com/users/44330/jason-s"}, "edited": false, "score": 0, "creation_date": 1594576583, "post_id": 49662023, "comment_id": 111167624, "body": "&quot;You can assume atomic_uint is 32-bit and use it as a replacement&quot; -- no, you can&#39;t. That&#39;s the whole point of <code>uint32_t</code>."}, {"owner": {"reputation": 6746, "user_id": 1143634, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/e7lca.png?s=128&g=1", "display_name": "StaceyGirl", "link": "https://stackoverflow.com/users/1143634/staceygirl"}, "reply_to_user": {"reputation": 170705, "user_id": 44330, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/dd5a7ef1476fb01998a215b1642dfd07?s=128&d=identicon&r=PG", "display_name": "Jason S", "link": "https://stackoverflow.com/users/44330/jason-s"}, "edited": false, "score": 0, "creation_date": 1594583966, "post_id": 49662023, "comment_id": 111169927, "body": "@JasonS Yes you can. In many cases <code>uint32_t</code> is <code>unsigned</code> and this is mandated by your platform."}, {"owner": {"reputation": 170705, "user_id": 44330, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/dd5a7ef1476fb01998a215b1642dfd07?s=128&d=identicon&r=PG", "display_name": "Jason S", "link": "https://stackoverflow.com/users/44330/jason-s"}, "edited": false, "score": 0, "creation_date": 1594662670, "post_id": 49662023, "comment_id": 111197861, "body": "I work on embedded processors. We cannot make such assumptions."}], "tags": [], "owner": {"reputation": 6746, "user_id": 1143634, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/e7lca.png?s=128&g=1", "display_name": "StaceyGirl", "link": "https://stackoverflow.com/users/1143634/staceygirl"}, "is_accepted": true, "score": 4, "last_activity_date": 1522885616, "last_edit_date": 1522885616, "creation_date": 1522885310, "answer_id": 49662023, "question_id": 49661987, "link": "https://stackoverflow.com/questions/49661987/do-we-have-atomic-uint32-type-in-c/49662023#49662023", "title": "Do we have atomic uint32 type in C?", "body": "<p>C11 defines following typedefs to atomic types in <code>&lt;stdatomic.h&gt;</code>:</p>\n\n<pre><code>atomic_bool\natomic_char\natomic_schar\natomic_uchar\natomic_short\natomic_ushort\natomic_int\natomic_uint\natomic_long\natomic_ulong\natomic_llong\natomic_ullong\natomic_char16_t\natomic_char32_t\natomic_wchar_t\natomic_int_least8_t\natomic_uint_least8_t\natomic_int_least16_t\natomic_uint_least16_t\natomic_int_least32_t\natomic_uint_least32_t\natomic_int_least64_t\natomic_uint_least64_t\natomic_int_fast8_t\natomic_uint_fast8_t\natomic_int_fast16_t\natomic_uint_fast16_t\natomic_int_fast32_t\natomic_uint_fast32_t\natomic_int_fast64_t\natomic_uint_fast64_t\natomic_intptr_t\natomic_uintptr_t\natomic_size_t\natomic_ptrdiff_t\natomic_intmax_t\natomic_uintmax_t\n</code></pre>\n\n<p>There is no <code>atomic_uint32_t</code>, so your options are:</p>\n\n<ul>\n<li>You can use <code>_Atomic(uint32_t)</code> directly.</li>\n<li>You can use one of existing alternative types (<code>atomic_uint_least32_t</code>, <code>atomic_uint_fast32_t</code> or even <code>atomic_char32_t</code>) if this fits your purpose (probably it doesn't).</li>\n<li>You can assume <code>atomic_uint</code> is 32-bit and use it as a replacement. This should be actually one of the most portable ways as most OS (*BSDs, Linux, Windows) assume <code>int</code> is a 32-bit type.</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 13984, "user_id": 501126, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/839de8a602b21abf36e020bcb32959fe?s=128&d=identicon&r=PG", "display_name": "nemequ", "link": "https://stackoverflow.com/users/501126/nemequ"}, "is_accepted": false, "score": 1, "last_activity_date": 1522891307, "creation_date": 1522891307, "answer_id": 49662754, "question_id": 49661987, "link": "https://stackoverflow.com/questions/49661987/do-we-have-atomic-uint32-type-in-c/49662754#49662754", "title": "Do we have atomic uint32 type in C?", "body": "<p>Ivan's answer is great (I hope you accept his, not this one), but it's worth mentioning that some compilers (I'm looking at you, MSVC) don't support C11 atomics.</p>\n\n<p>If you're not concerned with such compilers, use C11 atomics.</p>\n\n<p>If, OTOH, you need a bit portability, you may want to take a look at the <a href=\"https://github.com/nemequ/portable-snippets/tree/master/atomic\" rel=\"nofollow noreferrer\">atomic module</a> in <a href=\"https://github.com/nemequ/portable-snippets/\" rel=\"nofollow noreferrer\">Portable Snippets</a> (disclaimer: it's one of my projects, so take this suggestion with a grain of salt). There is no <em>unsigned</em> 32-bit atomic, but there are 32- and 64-bit <em>signed</em> atomic types which work well with a <em>lot</em> of compilers, including old (pre-C11) GCC, clang, and ICC, as well as suncc, ARM, and a few others.</p>\n"}], "owner": {"reputation": 522, "user_id": 2498993, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/8f881d06776cfe34de58faa0a1e8181d?s=128&d=identicon&r=PG", "display_name": "damingzi", "link": "https://stackoverflow.com/users/2498993/damingzi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1070, "favorite_count": 0, "accepted_answer_id": 49662023, "answer_count": 2, "score": 3, "last_activity_date": 1522891307, "creation_date": 1522885023, "last_edit_date": 1522885756, "question_id": 49661987, "link": "https://stackoverflow.com/questions/49661987/do-we-have-atomic-uint32-type-in-c", "title": "Do we have atomic uint32 type in C?", "body": "<p><code>sig_atomic_t</code> is a typedef of <code>int</code>. But I am curious do we have an atomic type which is matched to <code>uint32_t</code> ?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 3, "creation_date": 1522884877, "post_id": 49661944, "comment_id": 86333852, "body": "Bad compare (no zero): try <code>return (x &gt; y) - ( x &lt; y);</code>"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 4, "creation_date": 1522884884, "post_id": 49661944, "comment_id": 86333854, "body": "Your comparison function never returns 0, just -1 and +1. So it never tells <code>bsearch</code> it has found the item being sought."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 1, "creation_date": 1522886197, "post_id": 49661944, "comment_id": 86334228, "body": "Note: for a small array (N=10) linear search is probably optimal."}, {"owner": {"reputation": 19, "user_id": 9546602, "user_type": "registered", "profile_image": "https://graph.facebook.com/1242214812577087/picture?type=large", "display_name": "Ivan Pereyra", "link": "https://stackoverflow.com/users/9546602/ivan-pereyra"}, "edited": false, "score": 0, "creation_date": 1522888580, "post_id": 49661944, "comment_id": 86334892, "body": "The arrangement is 10 only to test but it can actually be a very large array with 25056012 elements, even more"}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "reply_to_user": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1522890495, "post_id": 49661944, "comment_id": 86335346, "body": "@wildplasser <a href=\"https://stackoverflow.com/q/22546024/995714\">Where to choose linear search over binary search</a>, <a href=\"https://stackoverflow.com/questions/1275665/at-which-n-does-binary-search-become-faster-than-linear-search-on-a-modern-cpu\">At which n does binary search become faster than linear search on a modern CPU?</a>"}, {"owner": {"reputation": 19, "user_id": 9546602, "user_type": "registered", "profile_image": "https://graph.facebook.com/1242214812577087/picture?type=large", "display_name": "Ivan Pereyra", "link": "https://stackoverflow.com/users/9546602/ivan-pereyra"}, "edited": false, "score": 0, "creation_date": 1522891237, "post_id": 49661944, "comment_id": 86335489, "body": "I will read it, thanks"}], "answers": [{"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1522887715, "post_id": 49662110, "comment_id": 86334662, "body": "While subtraction works when the numbers are small, it risks overflow if the numbers are large.  It isn&#39;t a good way to write a comparator."}, {"owner": {"reputation": 19, "user_id": 9546602, "user_type": "registered", "profile_image": "https://graph.facebook.com/1242214812577087/picture?type=large", "display_name": "Ivan Pereyra", "link": "https://stackoverflow.com/users/9546602/ivan-pereyra"}, "edited": false, "score": 0, "creation_date": 1522889108, "post_id": 49662110, "comment_id": 86335037, "body": "the comparator that I need must support large unsigned int numbers, in this case it must support an unsigned 32-bit integer"}, {"owner": {"reputation": 27279, "user_id": 857132, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4fd51ed5980999c7c6ce3729d6cb2184?s=128&d=identicon&r=PG", "display_name": "John3136", "link": "https://stackoverflow.com/users/857132/john3136"}, "reply_to_user": {"reputation": 19, "user_id": 9546602, "user_type": "registered", "profile_image": "https://graph.facebook.com/1242214812577087/picture?type=large", "display_name": "Ivan Pereyra", "link": "https://stackoverflow.com/users/9546602/ivan-pereyra"}, "edited": false, "score": 0, "creation_date": 1522889364, "post_id": 49662110, "comment_id": 86335100, "body": "@IvanPereyra Key point is you don&#39;t have a &quot;return 0 if equal&quot; case. Fix that and you&#39;re done."}], "tags": [], "owner": {"reputation": 27279, "user_id": 857132, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4fd51ed5980999c7c6ce3729d6cb2184?s=128&d=identicon&r=PG", "display_name": "John3136", "link": "https://stackoverflow.com/users/857132/john3136"}, "is_accepted": false, "score": 1, "last_activity_date": 1522889441, "last_edit_date": 1522889441, "creation_date": 1522885921, "answer_id": 49662110, "question_id": 49661944, "link": "https://stackoverflow.com/questions/49661944/bsearch-return-null-but-the-element-is-in-the-array/49662110#49662110", "title": "bsearch return NULL but the element is in the array", "body": "<p><code>return x &gt; y ? 1 : -1;</code> Never returns 0 (a match). Try <code>return (int)(x - y);</code> (just noted unsigned types so need to be aware of that - I've used a simple cast but there is likely a safer way)</p>\n\n<p>Comment re: overflow is correct (but unlikely in normal usage), if on is a huge positive and the other is a huge negative then you're going to have problems.</p>\n\n<p>A nice clear way to handle any size without overflow or sign issues:</p>\n\n<pre><code>if (x == y)\n    return 0;\nreturn x &gt; y ? 1 : -1;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1522891307, "post_id": 49662689, "comment_id": 86335504, "body": "<code>return (x &gt; y) - (x &lt; y);</code> will be much simpler and there&#39;s no overflow whatsoever"}, {"owner": {"reputation": 27279, "user_id": 857132, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4fd51ed5980999c7c6ce3729d6cb2184?s=128&d=identicon&r=PG", "display_name": "John3136", "link": "https://stackoverflow.com/users/857132/john3136"}, "edited": false, "score": 0, "creation_date": 1522892886, "post_id": 49662689, "comment_id": 86335846, "body": "What you have there is likely to cause compiler warnings about the fn not returning a value since the returns are buried in elses. I&#39;d refactor to <code>if (x != y) { ... } return 0;</code>"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 27279, "user_id": 857132, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4fd51ed5980999c7c6ce3729d6cb2184?s=128&d=identicon&r=PG", "display_name": "John3136", "link": "https://stackoverflow.com/users/857132/john3136"}, "edited": false, "score": 1, "creation_date": 1522944429, "post_id": 49662689, "comment_id": 86364915, "body": "@John3136: It is easy to see each case in the above returns a value. Can you cite any particular compiler and version which produces a warning for the code shown?"}, {"owner": {"reputation": 27279, "user_id": 857132, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4fd51ed5980999c7c6ce3729d6cb2184?s=128&d=identicon&r=PG", "display_name": "John3136", "link": "https://stackoverflow.com/users/857132/john3136"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1522967711, "post_id": 49662689, "comment_id": 86376782, "body": "@EricPostpischil - Easy for a person to see but not necessarily a compiler. You&#39;ll note I said warnings - not errors."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 27279, "user_id": 857132, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4fd51ed5980999c7c6ce3729d6cb2184?s=128&d=identicon&r=PG", "display_name": "John3136", "link": "https://stackoverflow.com/users/857132/john3136"}, "edited": false, "score": 0, "creation_date": 1522969059, "post_id": 49662689, "comment_id": 86377140, "body": "@John3136: This is easy for a compiler to see. In analyzing the source, compilers construct graphs (or other structures) of potential control flow. In this case, where every branch contains a return, the graph shows no control flow reaching the end of the function."}, {"owner": {"reputation": 27279, "user_id": 857132, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4fd51ed5980999c7c6ce3729d6cb2184?s=128&d=identicon&r=PG", "display_name": "John3136", "link": "https://stackoverflow.com/users/857132/john3136"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1522969830, "post_id": 49662689, "comment_id": 86377351, "body": "@EricPostpischil We&#39;ll have to agree to disagree. I&#39;m not going to try it on all the ancient compilers I currently have to use. Pretty sure one of the older solaris C compilers flags this. Perhaps I&#39;ll flip my comment. Perhaps the compiler can tell, but in a 1000+ line function (the joys of legacy code) the maintainer will have a lot of work to check ;-)"}], "tags": [], "owner": {"reputation": 19, "user_id": 9546602, "user_type": "registered", "profile_image": "https://graph.facebook.com/1242214812577087/picture?type=large", "display_name": "Ivan Pereyra", "link": "https://stackoverflow.com/users/9546602/ivan-pereyra"}, "is_accepted": false, "score": 0, "last_activity_date": 1522948899, "last_edit_date": 1522948899, "creation_date": 1522890672, "answer_id": 49662689, "question_id": 49661944, "link": "https://stackoverflow.com/questions/49661944/bsearch-return-null-but-the-element-is-in-the-array/49662689#49662689", "title": "bsearch return NULL but the element is in the array", "body": "<p>Thanks for the answers, they helped me find the solution.\nI still do not probe it for a large array.\nAnyway, the comparison function is:</p>\n\n<pre><code>int struct_cmp_by_v2(const void *i, const void *j) {\n  struct edge *a = (struct edge *)i;\n  struct edge *b = (struct edge *)j;\n  u32 x = a-&gt;v1;\n  u32 y = b-&gt;v1;\n  if (x == y)\n    return 0;\n  else {\n    if (x &gt; y)\n      return 1;\n    else\n      return -1;\n  }\n}\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 9546602, "user_type": "registered", "profile_image": "https://graph.facebook.com/1242214812577087/picture?type=large", "display_name": "Ivan Pereyra", "link": "https://stackoverflow.com/users/9546602/ivan-pereyra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 163, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1522948899, "creation_date": 1522884650, "last_edit_date": 1522888808, "question_id": 49661944, "link": "https://stackoverflow.com/questions/49661944/bsearch-return-null-but-the-element-is-in-the-array", "title": "bsearch return NULL but the element is in the array", "body": "<pre><code>#define u32 uint32_t\n#define Narray 10\n\nstruct edge {\n  u32 v1;\n  u32 v2;\n};\nint struct_cmp_by_v1(const void *i, const void *j) {\n  struct edge *a = (struct edge *)i;\n  struct edge *b = (struct edge *)j;\n  u32 x = a-&gt;v1;\n  u32 y = b-&gt;v1;\n  return x &gt; y ? 1 : -1;\n}\nstruct edge *array = malloc((sizeof(struct edge))*Narray);\nstruct edge *l = malloc(sizeof(struct edge));\nstruct edge *e = (struct edge *) bsearch(l, array, Narray, sizeof(struct edge), struct_cmp_by_v1);\n</code></pre>\n\n<p>The array is small with large numbers u32 but I only look for an element according to a field of the ,struct edge, that is v1 then the comparison is only made between v1.</p>\n\n<p>The key used by bsearch is, struct edge *l, where l->v1 contains the element to be searched.</p>\n\n<p>The ,array of struct edge, has element v1 to find but bserach does not find it and return NULL, I do not see the error that I'm committing</p>\n\n<p>Note: The array contains only 10 elements to test but it can be a very large array with 25056012 elements, even more</p>\n"}, {"tags": ["c", "macos", "named-pipes", "fread"], "comments": [{"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1522884735, "post_id": 49661928, "comment_id": 86333810, "body": "<code>(tens of MB per second),</code> is not a lot of data. I/O bandwidth could be in the range of 500MB/s <code>with very low latency.</code> : You cannot have both."}, {"owner": {"reputation": 2384, "user_id": 279538, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/b77fadd2ba791134ac40a9c184be1eda?s=128&d=identicon&r=PG", "display_name": "cedivad", "link": "https://stackoverflow.com/users/279538/cedivad"}, "reply_to_user": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1522884899, "post_id": 49661928, "comment_id": 86333859, "body": "It&#39;s in the order of 10 MB per second. While I agree it&#39;s not a lot of data, you need to unload the pipe at least every ~6ms considering a perfectly uniform data stream (if the pipe buffer is 65k). My usleep implementation somehow crashes just above 800 nanoseconds, that I believe might have something to do with the implementation of usleep (or the scheduler deciding to schedule something taking a long time in between)."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 1, "creation_date": 1522884966, "post_id": 49661928, "comment_id": 86333879, "body": "<code>However, I can&#39;t afford to keep a whole core busy repeating the read()</code> Blocking on I/O can be your friend."}, {"owner": {"reputation": 2384, "user_id": 279538, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/b77fadd2ba791134ac40a9c184be1eda?s=128&d=identicon&r=PG", "display_name": "cedivad", "link": "https://stackoverflow.com/users/279538/cedivad"}, "reply_to_user": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1522885020, "post_id": 49661928, "comment_id": 86333891, "body": "I&#39;m doing blocking I/O, but every single time I call my blocking read operation (with poll before it, too), I only retrieve a few bytes worth of data. I believe I explained that in the original question."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1522885171, "post_id": 49661928, "comment_id": 86333929, "body": "The solution is flow control, i.e. the process writing into the pipe needs to be more intelligent about how much data it puts into the pipe."}, {"owner": {"reputation": 2384, "user_id": 279538, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/b77fadd2ba791134ac40a9c184be1eda?s=128&d=identicon&r=PG", "display_name": "cedivad", "link": "https://stackoverflow.com/users/279538/cedivad"}, "edited": false, "score": 0, "creation_date": 1522885439, "post_id": 49661928, "comment_id": 86334003, "body": "I would really rather not hack an external program, even if I too was assuming there really wasn&#39;t another way."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1522886170, "post_id": 49661928, "comment_id": 86334224, "body": "<i>However, I can&#39;t afford to keep a whole core busy repeating the <code>read()</code> operation, as I would like to use that CPU for other operations.</i>  Why not?  Why don&#39;t you price out the marginal cost for one more CPU and compare it to the cost of the time you&#39;re spending developing more complex code to &quot;fix&quot; something that&#39;s not a problem? And then the cost of keeping that code working in the future? You&#39;re using 100% of a CPU?  So what. That&#39;s what it&#39;s <b>FOR</b>."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1522888165, "post_id": 49661928, "comment_id": 86334793, "body": "You can&#39;t require a lower-bound on the amount of data that will be read; the system is always capable of returning less than you could accept.  You could write a function that achieves the result by looping until it has read enough to satisfy you, but that doesn&#39;t affect the system calls.  If the data is being written in small batches (a few tens of bytes), then you will in general only get a few tens of bytes from a read.  Sometimes you may get a couple of batches in a single read, but that&#39;s about it.  Presumably you are using blocking I/O on the pipe?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1522888260, "post_id": 49661928, "comment_id": 86334812, "body": "You mention &quot;my implementation of <code>usleep</code>&quot; \u2014 macOS provides <code>usleep()</code>, so what are you doing implementing it?  And since 800 nanoseconds is less than 1 microsecond, you can&#39;t wait the little with <code>usleep()</code>.  Maybe you need to show your code so we can see whether there&#39;s something non-obvious that&#39;s wrong \u2014 an MCVE (<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>)."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1522888784, "post_id": 49661928, "comment_id": 86334947, "body": "I have a program <code>fifosize</code>, the source for which is available on GitHub in my <a href=\"https://github.com/jleffler/soq\" rel=\"nofollow noreferrer\">SOQ</a> (Stack Overflow Questions) repository as file <code>fifosize.c</code> in the <a href=\"https://github.com/jleffler/soq/tree/master/src/so-1936-1241\" rel=\"nofollow noreferrer\">src/so-1936-1241</a> sub-directory.  That tells me that the macOS FIFO buffer size is 8192 (contrasted with 65536 for an anonymous pipe \u2014 see <code>pipesize.c</code> in the same directory).  I&#39;m not sure that&#39;s a factor in your problem, beyond being an upper bound on how much data you&#39;d be able to read from a FIFO in a single <code>read</code> operation."}, {"owner": {"reputation": 2384, "user_id": 279538, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/b77fadd2ba791134ac40a9c184be1eda?s=128&d=identicon&r=PG", "display_name": "cedivad", "link": "https://stackoverflow.com/users/279538/cedivad"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1522919520, "post_id": 49661928, "comment_id": 86346817, "body": "By &quot;my implementation of <code>usleep</code>&quot; I meant my version of my program using <code>usleep</code>, sorry. @Jonathan, Thank you. That explains why I can only sleep around 800 microseconds instead of ~6ms before beginning dropping data (yes, I wanted to write micro instead of nano too, I was tired past midnight)."}], "owner": {"reputation": 2384, "user_id": 279538, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/b77fadd2ba791134ac40a9c184be1eda?s=128&d=identicon&r=PG", "display_name": "cedivad", "link": "https://stackoverflow.com/users/279538/cedivad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 221, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1522884557, "creation_date": 1522884557, "question_id": 49661928, "link": "https://stackoverflow.com/questions/49661928/read-at-least-n-bytes-from-a-named-pipe-in-c", "title": "Read at least n bytes from a named pipe in C", "body": "<p>I have a multithreaded (pthread) C application running on macos where I'm trying to read from a named pipe with very low latency. There is a lot of data written to the pipe (tens of MB per second), and macos only has a few tens of KB worth of pipe buffer, so it's important I keep the pipe clean.</p>\n\n<p>However, I can't afford to keep a whole core busy repeating the <code>read()</code> operation, as I would like to use that CPU for other operations.</p>\n\n<p>I've tried waiting on <code>poll()</code> for a write on the named pipe, to then <code>read()</code> only on <code>POLLIN</code> events. This works, as I went from the cycle running many million times per second down to just a million times a second. However it's still a gigantic waste, as every <code>read()</code> operation only unloads an average of 10-20 bytes from the pipe.</p>\n\n<p>I could <code>usleep()</code> in between reads, but I don't like this idea (and I tried it, I somehow can't get it to work reliably). </p>\n\n<p>I believe <code>fread()</code> implements a buffer (and you can ask it to block and only return when at least n bytes are ready to be copied), but somehow I can only get it to work (to wait) with (for a) small number of bytes, say 4 bytes, not 16 or 128.</p>\n"}, {"tags": ["c", "malloc"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1522877706, "post_id": 49660718, "comment_id": 86331265, "body": "You&#39;ve got a 64-bit machine, and <code>sizeof(double) == sizeof(double *)</code> so you get away with the mistake in the second <code>malloc()</code> in the first function, but <code>sizeof(int) != sizeof(int *)</code> so you don&#39;t get away with the mistake in the second <code>malloc()</code> in the second function.  (On a 32-bit machine, you&#39;d be wasting space with the second <code>malloc()</code> in the first function, allocating twice as much space as needed.)"}, {"owner": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "edited": false, "score": 0, "creation_date": 1522878895, "post_id": 49660718, "comment_id": 86331762, "body": "<a href=\"https://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc\">Do I cast the result of malloc?</a> <b>No.</b>"}], "answers": [{"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": true, "score": 1, "last_activity_date": 1522884685, "last_edit_date": 1522884685, "creation_date": 1522877814, "answer_id": 49660835, "question_id": 49660718, "link": "https://stackoverflow.com/questions/49660718/malloc-fails-with-memory-corruption-on-one-of-two-nearly-identical-functions/49660835#49660835", "title": "malloc fails with memory corruption on one of two (nearly) identical functions", "body": "<p><code>.                                               v----v</code>  wrong type.<br>\n<code>double** array = (double**)malloc(rows * sizeof(double));</code> is the wrong size calculation.  </p>\n\n<p>It allocates for <code>double</code> and not <code>double *</code>.  So if a <code>double</code> size is more or the same as a pointer, this is simply an over-allocation.</p>\n\n<p>With <code>int** array = (int**)malloc(rows * sizeof(int));</code> this could be under-allocating on a machine with 32-bit <code>int</code> and 64-bit pointers.  <a href=\"https://stackoverflow.com/questions/49660718/malloc-fails-with-memory-corruption-on-one-of-two-identical-functions/49660835#comment86331265_49660718\">@Jonathan Leffler</a></p>\n\n<p>Better to allocate to the size of the de-referenced pointer than the type to avoid this common mistake.  Using <code>sizeof *pointer</code> idiom is easier to code right, review and maintain.</p>\n\n<pre><code>// int** array = (int**)malloc(rows * sizeof(int));\n//                   v-----------v   size of the de-referenced pointer               \nint** array = malloc(sizeof *array * rows);\n</code></pre>\n\n<hr>\n\n<p>Minor points:</p>\n\n<p>Casting the return value of <code>malloc()</code> is not needed in C.</p>\n\n<p>Consider that <code>int * int * size_t</code> may <code>int</code> overflow when <code>size_t * int * int</code> does not. Begin the calculation with the widest type.  Recall the <code>sizeof</code> operator return type is <code>size_t</code>.</p>\n\n<pre><code>double** alloc_2d_double(int rows, int cols) {\n  // double* data = (double*)malloc(rows * cols * sizeof(double));\n  double* data = malloc(sizeof *data * rows * cols);\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 9361345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f84aa875cff2f6523a5f8b1ae1f352fd?s=128&d=identicon&r=PG&f=1", "display_name": "bburnett", "link": "https://stackoverflow.com/users/9361345/bburnett"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 295, "favorite_count": 0, "accepted_answer_id": 49660835, "answer_count": 1, "score": 0, "last_activity_date": 1522884685, "creation_date": 1522877228, "last_edit_date": 1522878270, "question_id": 49660718, "link": "https://stackoverflow.com/questions/49660718/malloc-fails-with-memory-corruption-on-one-of-two-nearly-identical-functions", "title": "malloc fails with memory corruption on one of two (nearly) identical functions", "body": "<p>I have two identical functions for allocating a contiguous block of memory for a matrix, one being for an <code>int</code> the other for a <code>double</code>. See below:</p>\n\n<pre><code>double** alloc_2d_double(int rows, int cols) {\n    double* data = (double*)malloc(rows * cols * sizeof(double));\n    double** array = (double**)malloc(rows * sizeof(double));\n    int i;\n    for (i = 0; i &lt; rows; i++) {\n            array[i] = &amp;(data[cols*i]);\n    }\n\n    return(array);\n}\n\nint** alloc_2d_int(int rows, int cols) {\n    int* data = (int*)malloc(rows * cols * sizeof(int));\n    int** array = (int**)malloc(rows * sizeof(int));\n    int i;\n    for (i = 0; i &lt; rows; i++) {\n            array[i] = &amp;(data[cols * i]);\n    }\n\n    return(array);\n}\n</code></pre>\n\n<p>The <code>double</code> function works just fine but the int function fails with <code>malloc()</code>: memory corruption. Why does the int function fail when the double doesn't?</p>\n\n<p>This code is for an mpi program and the <code>double</code> function sees calls with parameters 25, 25 and 60, 60 and the <code>int</code> function sees calls with parameters 27, 22 and 100, 100. </p>\n\n<p>Any advice would be greatly appreciated!</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 4, "creation_date": 1522875572, "post_id": 49660296, "comment_id": 86330208, "body": "<code>char letter = argv[4][0];</code> This should go after the <code>argc</code> check."}, {"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 3, "creation_date": 1522875587, "post_id": 49660296, "comment_id": 86330218, "body": "Why are you not checking  <code>argc</code>? <code>argv [4]</code> might not exist"}, {"owner": {"reputation": 36141, "user_id": 4354477, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/SuxtS.gif?s=128&g=1", "display_name": "ForceBru", "link": "https://stackoverflow.com/users/4354477/forcebru"}, "edited": false, "score": 1, "creation_date": 1522875610, "post_id": 49660296, "comment_id": 86330227, "body": "<code>char *argv[]</code> means, loosely speaking, &quot;an array of <i>strings</i>, or, an array of chains of characters&quot;. How do you extract a single character from a chain of chars, then?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1522875626, "post_id": 49660296, "comment_id": 86330236, "body": "Reverse two lines and add a 2nd dimension to the index. <code>if(argc &lt; 5) {&#47;* horror *&#47;} char letter = argv[4][0];</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1522895682, "post_id": 49660296, "comment_id": 86336446, "body": "Never access beyond <code>argv[0]</code> without first checking <code>argc</code> to assure the command line argument was actually entered by the user."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1522896027, "post_id": 49660296, "comment_id": 86336520, "body": "regarding: <code>if(letter != &#39;d&#39; || letter != &#39;D&#39; || letter != &#39;e&#39; || letter != &#39;E&#39;)</code> this statement will ALWAYS evaluate to <code>true</code>  perhaps you meant: `if(letter != &#39;d&#39; &amp;&amp; letter != &#39;D&#39; &amp;&amp; letter != &#39;e&#39; &amp;&amp; letter != &#39;E&#39;)"}], "answers": [{"comments": [{"owner": {"reputation": 3560, "user_id": 5550963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7jAip.png?s=128&g=1", "display_name": "CEPB", "link": "https://stackoverflow.com/users/5550963/cepb"}, "edited": false, "score": 0, "creation_date": 1522877645, "post_id": 49660334, "comment_id": 86331237, "body": "<code>if (argc &gt; 4)</code> does nto make sense when he has has <code>if (argc !=5)</code> clause."}, {"owner": {"reputation": 490, "user_id": 7602674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/193276783eb09a4a1b8c7f18b74a731a?s=128&d=identicon&r=PG&f=1", "display_name": "jjh", "link": "https://stackoverflow.com/users/7602674/jjh"}, "reply_to_user": {"reputation": 3560, "user_id": 5550963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7jAip.png?s=128&g=1", "display_name": "CEPB", "link": "https://stackoverflow.com/users/5550963/cepb"}, "edited": false, "score": 0, "creation_date": 1522877732, "post_id": 49660334, "comment_id": 86331286, "body": "@GRC The dereference happens before <code>if (argc != 5)</code>."}, {"owner": {"reputation": 3560, "user_id": 5550963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7jAip.png?s=128&g=1", "display_name": "CEPB", "link": "https://stackoverflow.com/users/5550963/cepb"}, "edited": false, "score": 1, "creation_date": 1522878097, "post_id": 49660334, "comment_id": 86331440, "body": "what I meant is that <code>if (argc &gt; 4)</code> would accept any number of arguments larger than 4, which is bad idea. I upvoted your answer but this is simply bad idea and you should always limit number of arguments or if you are planning on having no arguments at all put <code>int main (void)</code>"}], "tags": [], "owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "is_accepted": false, "score": 6, "last_activity_date": 1522875782, "last_edit_date": 1522875782, "creation_date": 1522875575, "answer_id": 49660334, "question_id": 49660296, "link": "https://stackoverflow.com/questions/49660296/converting-a-command-line-argument-into-char/49660334#49660334", "title": "Converting a command line argument into char", "body": "<p><code>argv</code> is of type <code>char **</code>, such that <code>char c = argv[4]</code> assigns a pointer to a character value; this should actually give a warning / error.</p>\n\n<p>If you want to assign the first letter of the 4th argument, write <code>char c = *(argv[4])</code> or <code>char c = argv[4][0]</code></p>\n\n<p>And dont't forget to check if you have enough arguments provided <em>before</em> accessing <code>argv[4]</code>, i.e.</p>\n\n<pre><code>if (argc &gt; 4) {\n  char c = *(argv[4]);\n  ...\n</code></pre>\n\n<p>Note  further that <code>if(letter != 'd' || letter != 'D' || letter != 'e' || letter != 'E')</code> rarely makes sense  since for any <code>letter</code> condition <code>letter != 'd' || letter != 'D'</code> is always true, because <code>letter</code> cannot be both <code>d</code> and <code>D</code> at the  same time. you probably meant <code>&amp;&amp;</code>...</p>\n"}, {"tags": [], "owner": {"reputation": 4966, "user_id": 3605497, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mV6Nc.jpg?s=128&g=1", "display_name": "Tripp Kinetics", "link": "https://stackoverflow.com/users/3605497/tripp-kinetics"}, "is_accepted": false, "score": 6, "last_activity_date": 1522876202, "last_edit_date": 1522876202, "creation_date": 1522875587, "answer_id": 49660339, "question_id": 49660296, "link": "https://stackoverflow.com/questions/49660296/converting-a-command-line-argument-into-char/49660339#49660339", "title": "Converting a command line argument into char", "body": "<p>A string is simply an array of characters, terminated by a null.  So, access the first character in the array:</p>\n\n<pre><code>char letter = argv[4][0];\n</code></pre>\n\n<p>Also <code>if(letter != 'd' || letter != 'D' || letter != 'e' || letter != 'E')</code>  is always true, because <code>letter</code> cannot be both d and D at the same time.  You probably meant <code>if(letter != 'd' &amp;&amp; letter != 'D' &amp;&amp; letter != 'e' &amp;&amp; letter != 'E')</code></p>\n"}, {"tags": [], "owner": {"reputation": 490, "user_id": 7602674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/193276783eb09a4a1b8c7f18b74a731a?s=128&d=identicon&r=PG&f=1", "display_name": "jjh", "link": "https://stackoverflow.com/users/7602674/jjh"}, "is_accepted": false, "score": 3, "last_activity_date": 1522875909, "creation_date": 1522875909, "answer_id": 49660417, "question_id": 49660296, "link": "https://stackoverflow.com/questions/49660296/converting-a-command-line-argument-into-char/49660417#49660417", "title": "Converting a command line argument into char", "body": "<p>To add to the current answers:</p>\n\n<p><code>if(letter != 'd' || letter != 'D' || letter != 'e' || letter != 'E')</code></p>\n\n<p>This expression will always evaluate to true. I think you mean to use <code>&amp;&amp;</code> here instead of <code>||</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 3560, "user_id": 5550963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7jAip.png?s=128&g=1", "display_name": "CEPB", "link": "https://stackoverflow.com/users/5550963/cepb"}, "is_accepted": false, "score": 1, "last_activity_date": 1522878763, "last_edit_date": 1522878763, "creation_date": 1522877980, "answer_id": 49660873, "question_id": 49660296, "link": "https://stackoverflow.com/questions/49660296/converting-a-command-line-argument-into-char/49660873#49660873", "title": "Converting a command line argument into char", "body": "<p>Since you are new to 'C' and I can see you are struggling with pointers, I will try to explain what <code>argv</code> is. In reality <code>argv</code> is of type <code>char **argv</code> which is the same as <code>char *argv[]</code> which is the same as <code>char argv[][]</code>. Also all arguments are terminated with <code>\\0</code> like any <code>C</code> string.</p>\n\n<p>However even if you do understand pointers and fix those problems you have logical errors. Some are given by answers (@Josh pointed for this)</p>\n\n<pre><code>if(letter != 'd' || letter != 'D' || letter != 'e' || letter != 'E')\n</code></pre>\n\n<p>should be:</p>\n\n<pre><code>if(letter != 'd' &amp;&amp; letter != 'D' &amp;&amp; letter != 'e' &amp;&amp; letter != 'E')\n</code></pre>\n\n<p>Another one is: \nYou want to capture <strong>ONE</strong> letter of an argument and check if it is <code>d</code> or <code>e</code> as pointed by others</p>\n\n<pre><code>char letter = argv[4]; \n</code></pre>\n\n<p>should be</p>\n\n<pre><code>char letter = argv[4][0];\n</code></pre>\n\n<p>but that would create another problem. What if you type <code>debug</code> as your  last argument first letter would still be 'd', but argument would not be 'd'. Which if you fix this line as suggested by Joshua from:</p>\n\n<p>your code would fail if your <code>argv[4]</code> is <code>debug</code>. What you need to do is check if it is exactly one letter.</p>\n\n<pre><code>if (argv[4][1] != '\\0') {\n   printf (\"5th argument is incomatible\\n\");\n   return -1;\n}\n</code></pre>\n\n<p>This checks if second character of argument is '\\0', thus meaning that argv[4] contains only one letter and terminates with '\\0'.</p>\n\n<p>And another problem is referencing before checking if you have enough arguments.</p>\n\n<pre><code>char letter = argv[4];\nif(argc != 5)\n{\n   printf(\"Error - wrong number of inputs args\\n\");\n   return -1;\n}\n\n/* more code */\n</code></pre>\n\n<p>This would give you <code>segfautl</code> if you are lucky :). So to avoid segfautl it should be:</p>\n\n<pre><code>if(argc != 5)\n{\n   printf(\"Error - wrong number of inputs args\\n\");\n   return -1;\n}\n\nchar letter = argv[4][0];\n\n/* more code */\n</code></pre>\n"}], "owner": {"reputation": 101, "user_id": 5993773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b76a9e386fce0bfbdbee5a890585d28?s=128&d=identicon&r=PG&f=1", "display_name": "von", "link": "https://stackoverflow.com/users/5993773/von"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6441, "favorite_count": 0, "answer_count": 4, "score": 4, "last_activity_date": 1522878763, "creation_date": 1522875400, "last_edit_date": 1522875878, "question_id": 49660296, "link": "https://stackoverflow.com/questions/49660296/converting-a-command-line-argument-into-char", "title": "Converting a command line argument into char", "body": "<p>I'm working with a command line arguments for the first time and I need to convert one of the string arguments to a character for testing. I tried testing it as a string and it wasn't working. In the program the user needs to enter an e or E or d or D (sample input at top of code). I haven't done much with conversions in C either so any help would be great. Thanks.</p>\n\n<p>Input is: <code>./filename 4 1 7 e</code> </p>\n\n<pre><code>int main(int argc, char *argv[])\n{\n   char letter = argv[4];\n   if(argc != 5)\n   {\n      printf(\"Error - wrong number of inputs args\\n\");\n      return -1;\n   }\n\n   if(letter != 'd' || letter != 'D' || letter != 'e' || letter != 'E')\n   {\n      printf(\"Error - E or D not entered\\n\");\n      return -1;\n   }\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 4, "creation_date": 1522875325, "post_id": 49660244, "comment_id": 86330094, "body": "This <code>while(c = *array) if(*array++ == &#39;\\0&#39;) return  c;</code> won&#39;t reach the <code>if</code> when <code>c == &#39;\\0&#39;</code> because the <code>while</code> condition must be true. Anyway, not all control paths return a value."}, {"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 1, "creation_date": 1522875371, "post_id": 49660244, "comment_id": 86330109, "body": "Why are you not using braces? Number two just do one thing at a time"}, {"owner": {"reputation": 5, "user_id": 9039098, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z8cll.jpg?s=128&g=1", "display_name": "Ahmad Raza", "link": "https://stackoverflow.com/users/9039098/ahmad-raza"}, "edited": false, "score": 0, "creation_date": 1522875659, "post_id": 49660244, "comment_id": 86330250, "body": "I&#39;ve tried while(1) and then assignment of c with *array and after that if, but that not worked too and same results."}, {"owner": {"reputation": 5, "user_id": 9039098, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z8cll.jpg?s=128&g=1", "display_name": "Ahmad Raza", "link": "https://stackoverflow.com/users/9039098/ahmad-raza"}, "edited": false, "score": 0, "creation_date": 1522875762, "post_id": 49660244, "comment_id": 86330314, "body": "Ed Heal, I&#39;ve used braces but same result, so for simplicity no braces."}, {"owner": {"reputation": 1053, "user_id": 7885081, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CZvVb.png?s=128&g=1", "display_name": "Jose Fernando Lopez Fernandez", "link": "https://stackoverflow.com/users/7885081/jose-fernando-lopez-fernandez"}, "edited": false, "score": 1, "creation_date": 1522875932, "post_id": 49660244, "comment_id": 86330399, "body": "@AhmadRaza some pretty nifty bugs have been introduced because of a lack of braces. Peter van der Linden would be disappointed"}], "answers": [{"comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1522876628, "post_id": 49660526, "comment_id": 86330725, "body": "Nice but missed the corner case of the empty string."}, {"owner": {"reputation": 5, "user_id": 9039098, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z8cll.jpg?s=128&g=1", "display_name": "Ahmad Raza", "link": "https://stackoverflow.com/users/9039098/ahmad-raza"}, "edited": false, "score": 0, "creation_date": 1522876712, "post_id": 49660526, "comment_id": 86330768, "body": "Right, but at first I&#39;ve tried what you are talking about, i used preincreament in an infinite loop to check, but that not worked so I tried this, that is still not working."}, {"owner": {"reputation": 5, "user_id": 9039098, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z8cll.jpg?s=128&g=1", "display_name": "Ahmad Raza", "link": "https://stackoverflow.com/users/9039098/ahmad-raza"}, "edited": false, "score": 0, "creation_date": 1522876960, "post_id": 49660526, "comment_id": 86330902, "body": "@squeamish ossifrage you&#39;re asking for while(1) { if(++*array == &#39;\\0&#39;) { return *array; } }, but this does&#39;t works."}, {"owner": {"reputation": 21326, "user_id": 1679849, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpvxY.png?s=128&g=1", "display_name": "r3mainer", "link": "https://stackoverflow.com/users/1679849/r3mainer"}, "reply_to_user": {"reputation": 5, "user_id": 9039098, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z8cll.jpg?s=128&g=1", "display_name": "Ahmad Raza", "link": "https://stackoverflow.com/users/9039098/ahmad-raza"}, "edited": false, "score": 0, "creation_date": 1522877010, "post_id": 49660526, "comment_id": 86330930, "body": "@AhmadRaza No, that&#39;s not what I suggested."}, {"owner": {"reputation": 5, "user_id": 9039098, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z8cll.jpg?s=128&g=1", "display_name": "Ahmad Raza", "link": "https://stackoverflow.com/users/9039098/ahmad-raza"}, "edited": false, "score": 0, "creation_date": 1522877163, "post_id": 49660526, "comment_id": 86331011, "body": "@squeamish ossifrage , great you&#39;ve solved my problem,"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1522877183, "post_id": 49660526, "comment_id": 86331022, "body": "The &#39;empty string&#39; solution (<code>char getlastc(char* array) {     while (*array) array++;     return *--array; }</code>) dereferences the element before the start of the array \u2014 which is not a good idea. I think you need a condition <code>if (*array == &#39;\\0&#39;) return 0;</code> before the loop.  Your call on whether to use <code>if (array == 0 || *array == &#39;\\0&#39;) return 0;</code> \u2014 I&#39;d at least prefix that with an <code>assert(array != 0);</code> since passing a null pointer is really not likely to be supported behaviour."}], "tags": [], "owner": {"reputation": 21326, "user_id": 1679849, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpvxY.png?s=128&g=1", "display_name": "r3mainer", "link": "https://stackoverflow.com/users/1679849/r3mainer"}, "is_accepted": false, "score": 1, "last_activity_date": 1522877196, "last_edit_date": 1522877196, "creation_date": 1522876392, "answer_id": 49660526, "question_id": 49660244, "link": "https://stackoverflow.com/questions/49660244/returned-character-is-not-being-displayed/49660526#49660526", "title": "Returned character is not being displayed", "body": "<p>The <code>if()</code> statement in <code>getlastc()</code> never evaluates to <code>true</code>.</p>\n\n<p>What you probably wanted to do is use a preincrement operator instead of a postincrement:</p>\n\n<pre><code>if(*++array == '\\0') return  c;\n</code></pre>\n\n<p>Otherwise, you are testing the same character twice at each iteration, except for the last iteration where <code>(c = *array)</code> evaluates to <code>false</code> and the function exits (without a return value).</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>There's still a problem in that the <code>while()</code> loop is never executed at all when an empty string is passed to this function. Here's a simpler alternative:</p>\n\n<pre><code>char getlastc(char* array) {\n    if (!*array) return '\\0';\n    while (*array) array++;\n    return *--array;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5, "user_id": 9039098, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z8cll.jpg?s=128&g=1", "display_name": "Ahmad Raza", "link": "https://stackoverflow.com/users/9039098/ahmad-raza"}, "edited": false, "score": 0, "creation_date": 1522877429, "post_id": 49660750, "comment_id": 86331128, "body": "You&#39;re right, I&#39;m still beginner, and you kind answers will let me up. Thanks."}], "tags": [], "owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "is_accepted": false, "score": 0, "last_activity_date": 1522877361, "creation_date": 1522877361, "answer_id": 49660750, "question_id": 49660244, "link": "https://stackoverflow.com/questions/49660244/returned-character-is-not-being-displayed/49660750#49660750", "title": "Returned character is not being displayed", "body": "<p>Already accepted answer, but the function must return a value in all cirumstances. This handles the empty string too (returning a printable character).</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nchar getlastc(char *array) {\n    char c = *array;\n    while(*++array) {\n        c = *array;\n    }\n    if(!c) {\n        c = '?';            // the empty string\n    }\n    return c;\n}\n\nint main()\n{\n    char array[50] = \"Hello World\";\n    char *array1 = \"Hello World\";\n    char *array2 = \"42\";\n    char *array3 = \"\";     // the empty string\n    printf(\"%c %c %c %c\\n\", getlastc(array), getlastc(array1), getlastc(array2), getlastc(array3));\n    return 0;\n}\n</code></pre>\n\n<p>Program output:</p>\n\n<pre>d d 2 ?\n</pre>\n"}, {"tags": [], "owner": {"reputation": 490, "user_id": 7602674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/193276783eb09a4a1b8c7f18b74a731a?s=128&d=identicon&r=PG&f=1", "display_name": "jjh", "link": "https://stackoverflow.com/users/7602674/jjh"}, "is_accepted": true, "score": 1, "last_activity_date": 1522899010, "last_edit_date": 1522899010, "creation_date": 1522877374, "answer_id": 49660751, "question_id": 49660244, "link": "https://stackoverflow.com/questions/49660244/returned-character-is-not-being-displayed/49660751#49660751", "title": "Returned character is not being displayed", "body": "<p>The character returned by <code>*array++</code> is going to be the same as the character assigned to <code>c</code>. This is because we are dereferencing the pointer returned by <code>array++</code>, which is the value of <code>array</code> <em>prior</em> to incrementing. </p>\n\n<p>Also, your function returns nothing in the case of an empty string as input. </p>\n\n<p>Using a pre-increment and a little shuffling, we can fix this nicely:</p>\n\n<pre><code>   char c;\n   while(c = *array) {\n      if(*++array == '\\0') {\n        break;\n      }\n   }\n   return c;\n</code></pre>\n\n<p>Now we will return the last character of the input string, or <code>'\\0'</code> in the case we were passed the empty string.</p>\n\n<p>As a side note, you probably want to add a newline character in your <code>printf()</code>.</p>\n"}], "owner": {"reputation": 5, "user_id": 9039098, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z8cll.jpg?s=128&g=1", "display_name": "Ahmad Raza", "link": "https://stackoverflow.com/users/9039098/ahmad-raza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 1, "accepted_answer_id": 49660751, "answer_count": 3, "score": 0, "last_activity_date": 1522899010, "creation_date": 1522875197, "last_edit_date": 1522876313, "question_id": 49660244, "link": "https://stackoverflow.com/questions/49660244/returned-character-is-not-being-displayed", "title": "Returned character is not being displayed", "body": "<p>I'm trying to return last character of passed array using \"char getlastc(char*)\" function, but it is not being displayed in main(it displays nothing), though I tried many time to look for bug but could not found. Please point me the problem.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nchar getlastc(char* array) {\n   char c;\n   while(c = *array) {\n      if(*array++ == '\\0') {\n          return  c;\n      }\n   }\n\n}\n\n\nint main() {\n    char array[50] = \"Hello World\";\n    char *array1 = \"Hello World\";\n    printf(\"%c %c\", getlastc(array), getlastc(array1));\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "llvm", "address-sanitizer", "leak-sanitizer"], "comments": [{"owner": {"reputation": 20930, "user_id": 6881240, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/dc1e27d7e9a3de2ca8e257cb7c72ff4a?s=128&d=identicon&r=PG&f=1", "display_name": "kabanus", "link": "https://stackoverflow.com/users/6881240/kabanus"}, "edited": false, "score": 0, "creation_date": 1522864717, "post_id": 49657428, "comment_id": 86324067, "body": "Isn&#39;t LSAN something you compile with? I mean isn&#39;t it determined in compilation, unlike Valgrind that runs your program so only in runtime?"}, {"owner": {"reputation": 20930, "user_id": 6881240, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/dc1e27d7e9a3de2ca8e257cb7c72ff4a?s=128&d=identicon&r=PG&f=1", "display_name": "kabanus", "link": "https://stackoverflow.com/users/6881240/kabanus"}, "edited": false, "score": 0, "creation_date": 1522864766, "post_id": 49657428, "comment_id": 86324092, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/31273016/how-can-i-know-if-leak-sanitizer-is-enabled-at-compile-time\">How can I know if Leak Sanitizer is enabled at compile time?</a> - this being my point."}, {"owner": {"reputation": 5076, "user_id": 2117998, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/33e568baba35cd1512dcd8adacc393d7?s=128&d=identicon&r=PG", "display_name": "Arran Cudbard-Bell", "link": "https://stackoverflow.com/users/2117998/arran-cudbard-bell"}, "reply_to_user": {"reputation": 20930, "user_id": 6881240, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/dc1e27d7e9a3de2ca8e257cb7c72ff4a?s=128&d=identicon&r=PG&f=1", "display_name": "kabanus", "link": "https://stackoverflow.com/users/6881240/kabanus"}, "edited": false, "score": 0, "creation_date": 1522864801, "post_id": 49657428, "comment_id": 86324112, "body": "Yes you need to link to the ASAN library for support, but no, it&#39;s toggle-able with <code>ASAN_OPTIONS=detect_leaks=(1|0)</code> and seems to default to 0 on my system."}, {"owner": {"reputation": 5076, "user_id": 2117998, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/33e568baba35cd1512dcd8adacc393d7?s=128&d=identicon&r=PG", "display_name": "Arran Cudbard-Bell", "link": "https://stackoverflow.com/users/2117998/arran-cudbard-bell"}, "reply_to_user": {"reputation": 20930, "user_id": 6881240, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/dc1e27d7e9a3de2ca8e257cb7c72ff4a?s=128&d=identicon&r=PG&f=1", "display_name": "kabanus", "link": "https://stackoverflow.com/users/6881240/kabanus"}, "edited": false, "score": 0, "creation_date": 1522864896, "post_id": 49657428, "comment_id": 86324172, "body": "Not a duplicate.  That question is asking about compile time checking, this is runtime."}, {"owner": {"reputation": 20930, "user_id": 6881240, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/dc1e27d7e9a3de2ca8e257cb7c72ff4a?s=128&d=identicon&r=PG&f=1", "display_name": "kabanus", "link": "https://stackoverflow.com/users/6881240/kabanus"}, "edited": false, "score": 0, "creation_date": 1522864937, "post_id": 49657428, "comment_id": 86324200, "body": "I see, retracted dup vote. So you compile with it, but the system can turn it of in runtime. Sounds difficult, thanks for the clarification."}, {"owner": {"reputation": 5076, "user_id": 2117998, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/33e568baba35cd1512dcd8adacc393d7?s=128&d=identicon&r=PG", "display_name": "Arran Cudbard-Bell", "link": "https://stackoverflow.com/users/2117998/arran-cudbard-bell"}, "reply_to_user": {"reputation": 20930, "user_id": 6881240, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/dc1e27d7e9a3de2ca8e257cb7c72ff4a?s=128&d=identicon&r=PG&f=1", "display_name": "kabanus", "link": "https://stackoverflow.com/users/6881240/kabanus"}, "edited": false, "score": 2, "creation_date": 1522865090, "post_id": 49657428, "comment_id": 86324295, "body": "The community tend to come up with creative solutions to these things. My favourite was one for detecting being run under GDB, where you fork and then try and <code>pattach()</code> to your parent.  Not at all reliable, but fun!"}, {"owner": {"reputation": 5076, "user_id": 2117998, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/33e568baba35cd1512dcd8adacc393d7?s=128&d=identicon&r=PG", "display_name": "Arran Cudbard-Bell", "link": "https://stackoverflow.com/users/2117998/arran-cudbard-bell"}, "reply_to_user": {"reputation": 20930, "user_id": 6881240, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/dc1e27d7e9a3de2ca8e257cb7c72ff4a?s=128&d=identicon&r=PG&f=1", "display_name": "kabanus", "link": "https://stackoverflow.com/users/6881240/kabanus"}, "edited": false, "score": 0, "creation_date": 1522865487, "post_id": 49657428, "comment_id": 86324498, "body": "<a href=\"https://llvm.org/svn/llvm-project/compiler-rt/trunk/include/sanitizer/lsan_interface.h\" rel=\"nofollow noreferrer\">llvm.org/svn/llvm-project/compiler-rt/trunk/include/sanitize&zwnj;&#8203;r/&hellip;</a>  This looks potentially promising `__lsan_is_turned_off`` ... I wonder if that&#39;s only called if LSAN is enabled..."}, {"owner": {"reputation": 12992, "user_id": 2170527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64f36e49ac8529003cf57c003746388b?s=128&d=identicon&r=PG", "display_name": "yugr", "link": "https://stackoverflow.com/users/2170527/yugr"}, "edited": false, "score": 0, "creation_date": 1522866072, "post_id": 49657428, "comment_id": 86324827, "body": "Is Valgrind workaround common? if yes, could you mention it in <a href=\"https://github.com/google/sanitizers/issues/89\" rel=\"nofollow noreferrer\">Asan tracker</a> for other poor souls who suffer from this?"}, {"owner": {"reputation": 5076, "user_id": 2117998, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/33e568baba35cd1512dcd8adacc393d7?s=128&d=identicon&r=PG", "display_name": "Arran Cudbard-Bell", "link": "https://stackoverflow.com/users/2117998/arran-cudbard-bell"}, "edited": false, "score": 0, "creation_date": 1522867332, "post_id": 49657428, "comment_id": 86325575, "body": "The approach is - not calling dlclose(). It&#39;s mentioned by @kcc in that GitHub issue.  Commented on the issue with link pointing back here."}], "answers": [{"comments": [{"owner": {"reputation": 5076, "user_id": 2117998, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/33e568baba35cd1512dcd8adacc393d7?s=128&d=identicon&r=PG", "display_name": "Arran Cudbard-Bell", "link": "https://stackoverflow.com/users/2117998/arran-cudbard-bell"}, "edited": false, "score": 0, "creation_date": 1522866146, "post_id": 49657802, "comment_id": 86324867, "body": "Ahh, nice.  I&#39;m not sure which of our methods is more reliable, but I think Stack Overflow etiquette dictates I should accept your answer :)"}, {"owner": {"reputation": 12992, "user_id": 2170527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64f36e49ac8529003cf57c003746388b?s=128&d=identicon&r=PG", "display_name": "yugr", "link": "https://stackoverflow.com/users/2170527/yugr"}, "reply_to_user": {"reputation": 5076, "user_id": 2117998, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/33e568baba35cd1512dcd8adacc393d7?s=128&d=identicon&r=PG", "display_name": "Arran Cudbard-Bell", "link": "https://stackoverflow.com/users/2117998/arran-cudbard-bell"}, "edited": false, "score": 0, "creation_date": 1522866745, "post_id": 49657802, "comment_id": 86325229, "body": "Both solutions have their own flaws :) Mine does not discern between <code>ASAN_OPTIONS=disable_leaks=0</code> and <code>ASAN_OPTIONS=disable_leaks=1</code> (so will fire even if Lsan is linked but disabled at runtime) and yours will detect Lsan too late (I believe <code>__lsan_is_turned_off</code> is called only at exit)."}, {"owner": {"reputation": 5076, "user_id": 2117998, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/33e568baba35cd1512dcd8adacc393d7?s=128&d=identicon&r=PG", "display_name": "Arran Cudbard-Bell", "link": "https://stackoverflow.com/users/2117998/arran-cudbard-bell"}, "edited": false, "score": 1, "creation_date": 1522867170, "post_id": 49657802, "comment_id": 86325477, "body": "Hmm no the callback is called on process start, process exit... and at a random point in between (not <code>fork()</code> not <code>pthread_create()</code>, not sure why).  It&#39;d need to be called on start right? To actually enable/disable the memory tracking."}, {"owner": {"reputation": 12992, "user_id": 2170527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64f36e49ac8529003cf57c003746388b?s=128&d=identicon&r=PG", "display_name": "yugr", "link": "https://stackoverflow.com/users/2170527/yugr"}, "reply_to_user": {"reputation": 5076, "user_id": 2117998, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/33e568baba35cd1512dcd8adacc393d7?s=128&d=identicon&r=PG", "display_name": "Arran Cudbard-Bell", "link": "https://stackoverflow.com/users/2117998/arran-cudbard-bell"}, "edited": false, "score": 0, "creation_date": 1522867797, "post_id": 49657802, "comment_id": 86325864, "body": "@ArranCudbard-Bell Weird, I can only see it being called atexit in source code (through <code>DoLeakCheck</code>) but I&#39;m probly too tired. If it&#39;s indeed called at startup (which makes sense), it might be a better solution even though <code>lsan_interface.h</code> does not promise this so it&#39;s technically an implementation detail (as well as default implementation of <code>__lsan_is_turned_off</code> not looking at <code>detect_leaks</code> environment setting). So I&#39;ll have no problem to removing answer status from my reply."}, {"owner": {"reputation": 5076, "user_id": 2117998, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/33e568baba35cd1512dcd8adacc393d7?s=128&d=identicon&r=PG", "display_name": "Arran Cudbard-Bell", "link": "https://stackoverflow.com/users/2117998/arran-cudbard-bell"}, "edited": false, "score": 0, "creation_date": 1522879240, "post_id": 49657802, "comment_id": 86331924, "body": "You&#39;re right.  I wrote a simple program and it was only called on exit. My guess is in my complex program there&#39;s some forking action going on.  Whilst the callback isn&#39;t executed on fork() it is executed when the child exits.  See the horror below."}], "tags": [], "owner": {"reputation": 12992, "user_id": 2170527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64f36e49ac8529003cf57c003746388b?s=128&d=identicon&r=PG", "display_name": "yugr", "link": "https://stackoverflow.com/users/2170527/yugr"}, "is_accepted": false, "score": 1, "last_activity_date": 1522905734, "last_edit_date": 1522905734, "creation_date": 1522865826, "answer_id": 49657802, "question_id": 49657428, "link": "https://stackoverflow.com/questions/49657428/runtime-check-for-leaksanitizer-detect-leaks-1/49657802#49657802", "title": "Runtime check for LeakSanitizer (detect_leaks=1)", "body": "<p>First of all, not printing stacktraces on <code>dlclose</code> (or printing incorrect ones) is a <a href=\"https://github.com/google/sanitizers/issues/89\" rel=\"nofollow noreferrer\">known issue</a> in all sanitizers (not just LSan).</p>\n\n<p>Secondly, as of now there's no API to detect that LeakSanitizer is enabled at runtime so your best bet is to manually check that program is linked against Lsan and <code>detect_leaks=0</code> isn't set in environment:</p>\n\n<pre><code>void (*__lsan_is_turned_off)() = dlsym(RTLD_DEFAULT, \"__lsan_is_turned_off\");\nconst char *lsan_opts = getenv(\"LSAN_OPTIONS\");\nconst char *asan_opts = getenv(\"ASAN_OPTIONS\");\nint disable_dlclose = __lsan_is_turned_off != 0 &amp;&amp; !__lsan_is_turned_off()\n  &amp;&amp; !(lsan_opts &amp;&amp; (strstr(lsan_opts, \"detect_leaks=0\") || strstr(lsan_opts, \"detect_leaks=false\"))\n  &amp;&amp; !(asan_opts &amp;&amp; (strstr(asan_opts, \"detect_leaks=0\") || strstr(asan_opts, \"detect_leaks=false\"));\n</code></pre>\n\n<p>(<code>__lsan_is_turned_off</code> is defined in <a href=\"https://github.com/gcc-mirror/gcc/blob/master/libsanitizer/include/sanitizer/lsan_interface.h\" rel=\"nofollow noreferrer\">sanitizer/lsan_interface.h</a>).</p>\n\n<p>If you enable LSan via <code>-fsanitize=address</code>, you can replace <code>__lsan_is_turned_off</code> check with <code>#ifdef __SANITIZE_ADDRESS__</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 5076, "user_id": 2117998, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/33e568baba35cd1512dcd8adacc393d7?s=128&d=identicon&r=PG", "display_name": "Arran Cudbard-Bell", "link": "https://stackoverflow.com/users/2117998/arran-cudbard-bell"}, "is_accepted": true, "score": 2, "last_activity_date": 1522880695, "last_edit_date": 1522880695, "creation_date": 1522866059, "answer_id": 49657857, "question_id": 49657428, "link": "https://stackoverflow.com/questions/49657428/runtime-check-for-leaksanitizer-detect-leaks-1/49657857#49657857", "title": "Runtime check for LeakSanitizer (detect_leaks=1)", "body": "<p>The LSAN interface headers allow the user to define a callback <code>__lsan_is_turned_off</code> to allow the program to disable the leak checker.  This callback is only executed if LSAN is enabled.</p>\n\n<pre><code>#include &lt;sanitizer/lsan_interface.h&gt;\n\nstatic bool running_under_lsan = false;\n\nint __attribute__((used)) __lsan_is_turned_off(void)\n{\n    running_under_lsan = true;\n    return 0;\n}\n</code></pre>\n\n<p>EDIT: It's actually more complicated than that.  As @yugr commented It appears <code>__lsan_is_turned_off</code> is only executed when a process or child process exits.</p>\n\n<p>There is however a solution!</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdbool.h&gt;\n#include &lt;unistd.h&gt;\n\n#include &lt;string.h&gt;\n#include &lt;errno.h&gt;\n\n#include &lt;sanitizer/common_interface_defs.h&gt;\n\nstatic int from_child[2] = {-1, -1};\nstatic int pid;\n\nint __attribute__((used)) __lsan_is_turned_off(void)\n{\n    uint8_t ret = 1;\n\n    /* Parent */\n    if (pid != 0) return 0;\n\n    /* Child */\n    if (write(from_child[1], &amp;ret, sizeof(ret)) &lt; 0) {\n        fprintf(stderr, \"Writing LSAN status failed: %s\", strerror(errno));\n    }\n    close(from_child[1]);\n    return 0;\n}\n\nint main(int argc, char **argv)\n{\n    uint8_t ret = 0;\n\n    if (pipe(from_child) &lt; 0) {\n        fprintf(stderr, \"Failed opening internal pipe: %s\", strerror(errno));\n        exit(EXIT_FAILURE);\n    }\n\n    pid = fork();\n    if (pid == -1) {\n        fprintf(stderr, \"Error forking: %s\", strerror(errno));\n        exit(EXIT_FAILURE);\n    }\n\n    /* Child */\n    if (pid == 0) {\n        close(from_child[0]);   /* Close parent's side */\n        exit(EXIT_SUCCESS);\n    }\n\n    /* Parent */\n    close(from_child[1]);       /* Close child's side */\n\n    while ((read(from_child[0], &amp;ret, sizeof(ret)) &lt; 0) &amp;&amp; (errno == EINTR));\n\n    close(from_child[0]);       /* Close our side (so we don't leak FDs) */\n\n    /* Collect child */\n    waitpid(pid, NULL, 0);\n\n    if (ret) {\n        printf(\"Running under LSAN\\n\");\n    } else {\n        printf(\"Not running under LSAN\\n\");\n    }\n\n    exit(EXIT_SUCCESS);\n}\n</code></pre>\n\n<p>Example:</p>\n\n<pre><code>clang -g3 -fsanitize=address foo.c\n\nASAN_OPTIONS='detect_leaks=1' ./a.out\nRunning under LSAN\n\nASAN_OPTIONS='detect_leaks=0' ./a.out\nNot running under LSAN\n</code></pre>\n"}], "owner": {"reputation": 5076, "user_id": 2117998, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/33e568baba35cd1512dcd8adacc393d7?s=128&d=identicon&r=PG", "display_name": "Arran Cudbard-Bell", "link": "https://stackoverflow.com/users/2117998/arran-cudbard-bell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1501, "favorite_count": 1, "accepted_answer_id": 49657857, "answer_count": 2, "score": 4, "last_activity_date": 1522905734, "creation_date": 1522864360, "question_id": 49657428, "link": "https://stackoverflow.com/questions/49657428/runtime-check-for-leaksanitizer-detect-leaks-1", "title": "Runtime check for LeakSanitizer (detect_leaks=1)", "body": "<p>I have an issue where any Leak Sanitizer backtraces that go through dynamically loaded libraries report <code>Unknown Module</code> for any function calls within that library.</p>\n\n<pre><code>Direct leak of 48 byte(s) in 1 object(s) allocated from:\n    #0 0x4e3e36 in malloc (/usr/sbin/radiusd+0x4e3e36)\n    #1 0x7fb406e95f69  (&lt;unknown module&gt;)\n    #2 0x7fb406eafc36  (&lt;unknown module&gt;)\n    #3 0x7fb406eafd40  (&lt;unknown module&gt;)\n    #4 0x7fb406ea3364  (&lt;unknown module&gt;)\n    #5 0x7fb4063de7d4  (&lt;unknown module&gt;)\n    #6 0x7fb4063c61c4  (&lt;unknown module&gt;)\n    #7 0x7fb406617863  (&lt;unknown module&gt;)\n    #8 0x7fb415620681 in dl_load_func /usr/src/debug/freeradius-server-4.0.0/src/main/dl.c:194:34\n    #9 0x7fb41561edab in dl_symbol_init_walk /usr/src/debug/freeradius-server-4.0.0/src/main/dl.c:301:7\n    #10 0x7fb41561df1e in dl_module /usr/src/debug/freeradius-server-4.0.0/src/main/dl.c:748:6\n    #11 0x7fb41561f3db in dl_instance /usr/src/debug/freeradius-server-4.0.0/src/main/dl.c:853:20\n    #12 0x7fb41564f4ab in module_bootstrap /usr/src/debug/freeradius-server-4.0.0/src/main/module.c:827:6\n    #13 0x7fb41564ed56 in modules_bootstrap /usr/src/debug/freeradius-server-4.0.0/src/main/module.c:1070:14\n    #14 0x5352bb in main /usr/src/debug/freeradius-server-4.0.0/src/main/radiusd.c:561:6\n    #15 0x7fb41282ab34 in __libc_start_main (/lib64/libc.so.6+0x21b34)\n    #16 0x4204ab in _start (/usr/sbin/radiusd+0x4204ab)\n</code></pre>\n\n<p>I've had an almost identical issue with valgrind before, and I know it's due to the libraries being unloaded with dlclose on exit, and the symbols being unavailable when the symbolizer runs.</p>\n\n<p>With valgrind the fix is simple</p>\n\n<pre><code>/*\n *  Only dlclose() handle if we're *NOT* running under valgrind\n *  as it unloads the symbols valgrind needs.\n */\nif (!RUNNING_ON_VALGRIND) dlclose(module-&gt;handle);        /* ignore any errors */\n</code></pre>\n\n<p><code>RUNNING_ON_VALGRIND</code> being a macro provided by the valgrind library for detecting if the program is being valground.</p>\n\n<p>I can't see anything in the LSAN docs for a similar feature for when <code>ASAN_OPTIONS=detect_leaks=1</code> is set.</p>\n\n<p>Does anyone know if it's possible to perform a runtime check for running under LSAN?</p>\n"}, {"tags": ["c", "struct", "ptrace"], "answers": [{"tags": [], "owner": {"reputation": 5010, "user_id": 773879, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zqTIy.jpg?s=128&g=1", "display_name": "Mark Segal", "link": "https://stackoverflow.com/users/773879/mark-segal"}, "is_accepted": false, "score": 0, "last_activity_date": 1522877575, "creation_date": 1522877575, "answer_id": 49660794, "question_id": 49657361, "link": "https://stackoverflow.com/questions/49657361/retrieve-information-from-a-structure-with-ptrace/49660794#49660794", "title": "retrieve information from a structure with ptrace", "body": "<p>From the <a href=\"http://man7.org/linux/man-pages/man2/ptrace.2.html\" rel=\"nofollow noreferrer\">man page</a>,</p>\n\n<blockquote>\n<pre><code>PTRACE_PEEKTEXT, PTRACE_PEEKDATA\n      Read a word at the address addr in the tracee's memory,\n      returning the word as the result of the ptrace() call.  Linux\n      does not have separate text and data address spaces, so these\n      two requests are currently equivalent.  (data is ignored; but\n      see NOTES.)\n</code></pre>\n</blockquote>\n\n<p>Thus you must understand that <code>tmp</code> would hold the actually value that was read.</p>\n\n<p>Your checks are wrong - you should set <code>errno = 0</code> before the call and then check if it has changed. If it has - you've got an error. If it hasn't - you can be assured that <code>tmp</code> has the word from the remote process.</p>\n\n<p>Try something like this:</p>\n\n<pre><code>int buffer(unsigned long long addr, pid_t child, size_t size, void *buffer)\n{\n    size_t byte = 0;\n    size_t data;\n    unsigned long tmp;\n\n    // support for word aligned sizes only\n    if (size % sizeof(long) != 0)\n        return -1;\n\n    long * buffer_int = (long*) buffer;\n\n    while (byte &lt; size) {\n        errno = 0;\n        tmp = ptrace(PTRACE_PEEKDATA, child, addr + byte);\n        if (errno)\n            return -1;\n        buffer_int[byte / sizeof(long)] = tmp;\n\n        byte += sizeof(long);\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 8046295, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df2d561d725e35f591cfd2b4b0c74886?s=128&d=identicon&r=PG&f=1", "display_name": "g0blin", "link": "https://stackoverflow.com/users/8046295/g0blin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 294, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1522920758, "creation_date": 1522864116, "question_id": 49657361, "link": "https://stackoverflow.com/questions/49657361/retrieve-information-from-a-structure-with-ptrace", "title": "retrieve information from a structure with ptrace", "body": "<p>Here, I explain my problem, I am a beginner on the ptrace function and I would like to succeed in recovering the hard information of a structure.\nFor example with this command, I will have strace -e trace = fstat ls\na line: fstat (3, {st_mode = ..., st_size = ...}\nand I would like to successfully retrieve the contents of the structure (st_mode) and (st_size).\nI try this but to no avail:</p>\n\n<pre><code>int buffer(unsigned long long addr, pid_t child, size_t size, void *buffer)\n{\n    size_t byte = 0;\n    size_t data;\n    unsigned long tmp;\n\n    while (byte &lt; size) {\n        tmp = ptrace(PTRACE_PEEKDATA, child, addr + byte);\n        if ((size - byte) / sizeof(tmp))\n            data = sizeof(tmp);\n        else\n          data = size % sizeof(tmp);\n        memcpy((void *)(buffer + byte), &amp;tmp, data);\n        byte += data;\n    }\n}\n</code></pre>\n\n<p>and in params :</p>\n\n<pre><code>struct stat stat_i;\nbuffer(addr, pid, sizeof(stat_i), &amp;stat_i);\nprintf(\"%lu\", stat_i.st_size); -&gt; fake value :/\n</code></pre>\n\n<p>Thank'ks ! </p>\n"}, {"tags": ["c", "unix", "operating-system", "unix-socket"], "comments": [{"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 5, "creation_date": 1522864101, "post_id": 49657313, "comment_id": 86323717, "body": "It will be filled in by <code>accept</code>. It is <i>either a null pointer, or a pointer to a sockaddr structure where the address of the connecting socket shall be returned.</i>"}], "answers": [{"comments": [{"owner": {"reputation": 18530, "user_id": 3344003, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/988af95d5692ee66b1fc2fe725ba738e?s=128&d=identicon&r=PG&f=1", "display_name": "user3344003", "link": "https://stackoverflow.com/users/3344003/user3344003"}, "edited": false, "score": 1, "creation_date": 1522879545, "post_id": 49657505, "comment_id": 86332063, "body": "To elaborate, it&#39;s like making a phone call. If you make a call, you need to know the other party&#39;s phone number. To receive a call, you just pick up the phone."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1522950926, "post_id": 49657505, "comment_id": 86368684, "body": "And if you want to know the caller&#39;s phone number, you look at the caller ID. But you don&#39;t have to if you don&#39;t want to. Same with <code>accept()</code>. The output <code>sockaddr</code> is like the caller ID. And if you do use it, you don&#39;t have to use <code>getpeername()</code> separately to get it"}], "tags": [], "owner": {"reputation": 84, "user_id": 4651296, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3K8Ms.jpg?s=128&g=1", "display_name": "Miguel Mota", "link": "https://stackoverflow.com/users/4651296/miguel-mota"}, "is_accepted": false, "score": 3, "last_activity_date": 1522864653, "creation_date": 1522864653, "answer_id": 49657505, "question_id": 49657313, "link": "https://stackoverflow.com/questions/49657313/why-does-the-accept-call-uses-an-empty-sockaddr-structure/49657505#49657505", "title": "Why does the accept() call uses an empty sockaddr structure?", "body": "<p>Weel, it is an output parameter, you can send it or not, but when you send it, it will be filled with the the connecting socket.</p>\n\n<p>Take a look here <a href=\"http://pubs.opengroup.org/onlinepubs/009695399/functions/accept.html\" rel=\"nofollow noreferrer\">http://pubs.opengroup.org/onlinepubs/009695399/functions/accept.html</a></p>\n\n<blockquote>\n  <p>If address is not a null pointer, the address of the peer for the\n  accepted connection shall be stored in the sockaddr structure pointed\n  to by address, and the length of this address shall be stored in the\n  object pointed to by address_len.</p>\n</blockquote>\n"}], "owner": {"reputation": 114, "user_id": 7476317, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/57cf6897b7513ad4e18faceaf9c9174a?s=128&d=identicon&r=PG&f=1", "display_name": "davigzzz", "link": "https://stackoverflow.com/users/7476317/davigzzz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 183, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1522866959, "creation_date": 1522863944, "last_edit_date": 1522866959, "question_id": 49657313, "link": "https://stackoverflow.com/questions/49657313/why-does-the-accept-call-uses-an-empty-sockaddr-structure", "title": "Why does the accept() call uses an empty sockaddr structure?", "body": "<p>I just got asked this question and couldn't answer it, I looked at how I've been coding it and was really confused.\nThis is how I have been programming the accept() call in a server:</p>\n\n<pre><code>struct sockaddr_in client;\n\nsize=sizeof(client);\nif(( nds=accept(ds,(struct sockaddr*)&amp;client,&amp;size)) &lt;0)\n{\nperror(\"accept\");\nclose(ds);\nexit(-1);\n}\n</code></pre>\n\n<p>Where ds is socket descriptor</p>\n\n<p>I know the second parameter of accept is a pointer to the struct but don't know why it should be empty.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 1131, "user_id": 3448634, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/c1b5b4e95d700f849977e3c3e99b4ff7?s=128&d=identicon&r=PG&f=1", "display_name": "Makketronix", "link": "https://stackoverflow.com/users/3448634/makketronix"}, "edited": false, "score": 0, "creation_date": 1522863723, "post_id": 49657202, "comment_id": 86323486, "body": "If you turn the compiler&#39;s warning on and make it verbose, does it generate warnings? There are also static tools out there. E.g. Look for MISRA C compliance software tools. I am not sure if you are willing to spend the money."}, {"owner": {"reputation": 8027, "user_id": 3282436, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e17caa3e07899b69539433130de1d420?s=128&d=identicon&r=PG&f=1", "display_name": "0x5453", "link": "https://stackoverflow.com/users/3282436/0x5453"}, "edited": false, "score": 1, "creation_date": 1522863737, "post_id": 49657202, "comment_id": 86323494, "body": "Do you have warnings turned on?  GCC should warn about this with <code>-Wsign-compare</code> or <code>-Wextra</code>."}, {"owner": {"reputation": 30558, "user_id": 1013719, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/U8X0A.jpg?s=128&g=1", "display_name": "Ryan Haining", "link": "https://stackoverflow.com/users/1013719/ryan-haining"}, "edited": false, "score": 0, "creation_date": 1522863895, "post_id": 49657202, "comment_id": 86323593, "body": "surprisingly this <a href=\"https://wandbox.org/permlink/LSePapaYpYtD8QLD\" rel=\"nofollow noreferrer\">warns if you use int</a> but not <a href=\"https://wandbox.org/permlink/i0KlmYR9o2jKQjGL\" rel=\"nofollow noreferrer\">if you use short</a>. This is true in both clang and gcc."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1522866519, "post_id": 49657202, "comment_id": 86325085, "body": "regarding: <code>unsigned short u16; short s16; u16 = 0x8000; s16 = u16;</code>  this is the very reason why the compiler outputs the warning message about interaction between <code>signed</code> and <code>unsigned</code> variables"}, {"owner": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "reply_to_user": {"reputation": 30558, "user_id": 1013719, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/U8X0A.jpg?s=128&g=1", "display_name": "Ryan Haining", "link": "https://stackoverflow.com/users/1013719/ryan-haining"}, "edited": false, "score": 0, "creation_date": 1522868674, "post_id": 49657202, "comment_id": 86326395, "body": "@RyanHaining: Not too suprising -- integer promotion means that the correct (signed) comparison happens for shorts, while the incorrect (unsigned) comparison happens for ints."}], "answers": [{"comments": [{"owner": {"reputation": 7453, "user_id": 57185, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c7c0bd3b1c62185784ed1d715352d7e1?s=128&d=identicon&r=PG", "display_name": "PaulH", "link": "https://stackoverflow.com/users/57185/paulh"}, "edited": false, "score": 0, "creation_date": 1522864633, "post_id": 49657345, "comment_id": 86324027, "body": "That&#39;s it. Thanks!"}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 1, "creation_date": 1522865712, "post_id": 49657345, "comment_id": 86324606, "body": "and of course -Werror , just to make sure you fix em"}], "tags": [], "owner": {"reputation": 6746, "user_id": 1143634, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/e7lca.png?s=128&g=1", "display_name": "StaceyGirl", "link": "https://stackoverflow.com/users/1143634/staceygirl"}, "is_accepted": true, "score": 6, "last_activity_date": 1522864050, "creation_date": 1522864050, "answer_id": 49657345, "question_id": 49657202, "link": "https://stackoverflow.com/questions/49657202/detecting-signed-vs-unsigned-comparison-bugs/49657345#49657345", "title": "Detecting signed vs. unsigned comparison bugs", "body": "<p>You can use <code>-Wsign-compare</code> with <code>-Wsign-conversion</code>.</p>\n\n<p>The first one warns you when you compare signed values with unsigned ones. The latter warns you about implicit conversions from unsigned to signed and from signed to unsigned.</p>\n\n<p>In your case <code>-Wsign-compare</code> won't do anything because of integer promotion, while <code>-Wsign-conversion</code> will warn about implicit conversion in <code>s16 = u16</code>.</p>\n"}], "owner": {"reputation": 7453, "user_id": 57185, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c7c0bd3b1c62185784ed1d715352d7e1?s=128&d=identicon&r=PG", "display_name": "PaulH", "link": "https://stackoverflow.com/users/57185/paulh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 220, "favorite_count": 0, "accepted_answer_id": 49657345, "answer_count": 1, "score": 4, "last_activity_date": 1522864050, "creation_date": 1522863591, "question_id": 49657202, "link": "https://stackoverflow.com/questions/49657202/detecting-signed-vs-unsigned-comparison-bugs", "title": "Detecting signed vs. unsigned comparison bugs", "body": "<p>I've found an issue in some code I'm working with that I'm concerned may be a problem in several areas of the codebase. The issue has to do with signed/unsigned comparisons:</p>\n\n<pre><code>unsigned short u16;\nshort s16;\nu16 = 0x8000;\ns16 = u16;\nif (u16 &gt; s16) {\n    /* This is what gets printed in GCC */\n    printf(\"u16 &gt; s16\\n\");\n} else if (u16 == s16) {\n    printf(\"u16 == s16\\n\");\n} else {\n    printf(\"u16 &lt; s16\\n\");\n}\n</code></pre>\n\n<p>I understand <a href=\"https://stackoverflow.com/questions/33043908/comparing-off-t-and-ssize-t-with-other-types\">why this is an issue</a>. Are there good ways of reliably locating this kind of issue in your codebase? Ideally, it would appear as a compiler warning or a static code analysis warning, but neither GCC nor Coverity say anything.</p>\n"}, {"tags": ["c", "struct", "compilation", "pthreads", "cpu-architecture"], "comments": [{"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 3, "creation_date": 1522863533, "post_id": 49657171, "comment_id": 86323367, "body": "Please show the declaration of the variable <code>arg</code>."}, {"owner": {"reputation": 41, "user_id": 4522354, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85b08d9ebdc755802e3f1b422231a2e2?s=128&d=identicon&r=PG&f=1", "display_name": "qwerty5683", "link": "https://stackoverflow.com/users/4522354/qwerty5683"}, "reply_to_user": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1522863907, "post_id": 49657171, "comment_id": 86323602, "body": "<code>void *multiplication(void *arg)</code> is the function"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1522863929, "post_id": 49657171, "comment_id": 86323621, "body": "How <code>void*</code> can have members?"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 1, "creation_date": 1522864032, "post_id": 49657171, "comment_id": 86323679, "body": "It is unclear what your question is. <code>arg</code> is a pointer to void, not a struct. Compiler tells you so. You do use it like a struct. What is unclear about that? It is not even a pointer to struct (as I wrongly guessed in my deleted comment)."}], "answers": [{"tags": [], "owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "is_accepted": true, "score": 3, "last_activity_date": 1522864200, "creation_date": 1522864200, "answer_id": 49657379, "question_id": 49657171, "link": "https://stackoverflow.com/questions/49657171/compilation-error-in-c-request-for-member-in-something-not-a-structure-o/49657379#49657379", "title": "Compilation Error in C: request for member \u2018____\u2019 in something not a structure or union", "body": "<p>It appears <code>arg</code> is an arugment passed to a thread function (which is a pointer to your struct).</p>\n\n<p>In that case, you can't directly dereference <code>arg</code> because it's a <code>void*</code>. Convert it to appropriate type (which must match the argument passed to pthread_create API) and then use:</p>\n\n<pre><code>void *multiplication(void *arg)\n{\n    struct pthread_arg *myarg = arg;\n    int first = myarg-&gt;threeds * N/number_of_the_threads;\n    ...\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 4522354, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85b08d9ebdc755802e3f1b422231a2e2?s=128&d=identicon&r=PG&f=1", "display_name": "qwerty5683", "link": "https://stackoverflow.com/users/4522354/qwerty5683"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 49657379, "answer_count": 1, "score": 0, "last_activity_date": 1522864200, "creation_date": 1522863475, "question_id": 49657171, "link": "https://stackoverflow.com/questions/49657171/compilation-error-in-c-request-for-member-in-something-not-a-structure-o", "title": "Compilation Error in C: request for member \u2018____\u2019 in something not a structure or union", "body": "<p>I am getting the following compilation error: <code>request for member \u2018threeds\u2019 in something not a structure or union</code></p>\n\n<p>here is my struct: </p>\n\n<pre><code>struct pthread_arg {\nint size;\nint threeds;\nint the_threads;\n\n};\n</code></pre>\n\n<p>Here is the line causing the issue:</p>\n\n<pre><code>    int first = *(arg.threeds) * N/number_of_the_threads;\n</code></pre>\n\n<p>I have looked at other similar questions on here, but still got the same error after making the changes suggested. </p>\n"}, {"tags": ["c", "linux", "framebuffer", "double-buffering"], "comments": [{"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1522866902, "post_id": 49657086, "comment_id": 86325310, "body": "Please post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> so we can help you determine the root cause of the problem"}, {"owner": {"reputation": 338, "user_id": 1164170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6805e7f90ad712fb6439644de41c7a71?s=128&d=identicon&r=PG", "display_name": "ktb92677", "link": "https://stackoverflow.com/users/1164170/ktb92677"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1522876201, "post_id": 49657086, "comment_id": 86330531, "body": "I have added some sample code as well."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1522885992, "post_id": 49657086, "comment_id": 86334158, "body": "regarding: <code>fb0 = open(&quot;&#47;dev&#47;fb0&quot;, O_RDWR);     if(fb0 == 0)         error(&quot;Could not open framebuffer located in &#47;dev&#47;fb0!&quot;);</code>  The function: <code>open()</code> always returns a &lt;0 value when it fails (then the code should be calling <code>perror()</code> so the text reason the system thinks the function failed is written to <code>stderr</code>  0 is a valid return value (although, the code should only see that value if <code>stdin</code> has been closed"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1522886128, "post_id": 49657086, "comment_id": 86334206, "body": "when the call to <code>open()</code> fails, after displaying the error message, the code should be calling <code>exit()</code> as there is no <code>file descriptor</code> available to enable access to the file."}, {"owner": {"reputation": 338, "user_id": 1164170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6805e7f90ad712fb6439644de41c7a71?s=128&d=identicon&r=PG", "display_name": "ktb92677", "link": "https://stackoverflow.com/users/1164170/ktb92677"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1522945556, "post_id": 49657086, "comment_id": 86365599, "body": "I appreciate the replies... but they do not address the question at all. My question is about double buffering with the framebuffer... not the open() function"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1522976147, "post_id": 49657086, "comment_id": 86378918, "body": "We are, in the comments, either asking for clarification or pointing out problems that are NOT the problem ask about."}], "answers": [{"comments": [{"owner": {"reputation": 338, "user_id": 1164170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6805e7f90ad712fb6439644de41c7a71?s=128&d=identicon&r=PG", "display_name": "ktb92677", "link": "https://stackoverflow.com/users/1164170/ktb92677"}, "edited": false, "score": 1, "creation_date": 1534186488, "post_id": 51810565, "comment_id": 90612126, "body": "Could you please try playing a video using this double buffering algorithm? You&#39;ll see that the screen does indeed tear. This basic double buffering algorithm is not good enough to avoid screen tearing with things like video on the framebuffer. Please try libdri if you want to get rid of all screen tearing for low level graphics programming."}], "tags": [], "owner": {"reputation": 1, "user_id": 6722204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/942dd2ea0daedbc3d6194492ddda373a?s=128&d=identicon&r=PG&f=1", "display_name": "KVS", "link": "https://stackoverflow.com/users/6722204/kvs"}, "is_accepted": false, "score": 0, "last_activity_date": 1534090646, "last_edit_date": 1534090646, "creation_date": 1534090190, "answer_id": 51810565, "question_id": 49657086, "link": "https://stackoverflow.com/questions/49657086/proper-double-buffering-with-linux-framebuffer/51810565#51810565", "title": "Proper double buffering with linux framebuffer", "body": "<p>The way I have solved the double buffering issue for framebuffer on linux is by using a separate back buffer, allocated using mmap for the same screensize:</p>\n\n<pre><code>bbp = mmap(0, screensize, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0);\n</code></pre>\n\n<p>(where <code>screensize = vinfo.yres_virtual * finfo.line_length;</code>)</p>\n\n<p>Then write all changes to this back buffer, and after all writes are over, copy the entire back buffer to the main framebuffer pointer location using say, an update() function:</p>\n\n<pre><code>memcpy(fbp, bbp, screensize);\n</code></pre>\n\n<p>You could, also have an updateRect() function that copies only a given area. This logic is working fine on my x64 PC gnu/linux platform.</p>\n"}], "owner": {"reputation": 338, "user_id": 1164170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6805e7f90ad712fb6439644de41c7a71?s=128&d=identicon&r=PG", "display_name": "ktb92677", "link": "https://stackoverflow.com/users/1164170/ktb92677"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2561, "favorite_count": 0, "answer_count": 1, "score": 6, "last_activity_date": 1534090646, "creation_date": 1522863195, "last_edit_date": 1522876180, "question_id": 49657086, "link": "https://stackoverflow.com/questions/49657086/proper-double-buffering-with-linux-framebuffer", "title": "Proper double buffering with linux framebuffer", "body": "<p>I am wondering how to properly double buffer the framebuffer to avoid tearing. I've done lots of research on this topic and I can't seem to find anything.</p>\n\n<p>I've tried FBIO_WAITFORVSYNC. But per this thread: <a href=\"https://stackoverflow.com/questions/39299251/how-to-query-vsync-phase-in-linux\">How to query Vsync phase in Linux</a> it seems that this won't work.</p>\n\n<p>I've also tried using FBIOGET_VSCREENINFO \n and FBIOPAN_DISPLAY per this thread: <a href=\"https://stackoverflow.com/questions/13907471/linux-framebuffer-graphics-and-vsync\">Linux framebuffer graphics and VSync</a>. But it failed due to an error discussed in this thread: <a href=\"https://stackoverflow.com/questions/15071583/invalid-argument-error-when-setting-yres-virtual-in-fb-var-screeninfo/15072545#15072545\">invalid argument error when setting yres_virtual in fb_var_screeninfo</a></p>\n\n<p>That thread suggested using a different driver (vesafb) to resolve the error. I managed to install uvesafb on my machine but the \"Invalid Argument\" error didn't go away.</p>\n\n<p>I've also tried just mmaping a larger buffer per this person's suggestion: <a href=\"http://betteros.org/tut/graphics1.php#doublebuffer\" rel=\"noreferrer\">http://betteros.org/tut/graphics1.php#doublebuffer</a> but mmap keeps returning -1.</p>\n\n<p>I've also tried to implement the solution discussed here: <a href=\"https://pyra-handheld.com/boards/threads/my-frustrating-experiences-with-dev-fb.21062/\" rel=\"noreferrer\">https://pyra-handheld.com/boards/threads/my-frustrating-experiences-with-dev-fb.21062/</a>. However the thread died without the actual solution being posted and I am doubtful of the efficiency of swapping hardware addresses (or if it can even be done).</p>\n\n<p>Any help would be so greatly appreciated on this topic!</p>\n\n<p>Due to a request here is the code I would ideally like to get to work:</p>\n\n<pre><code>fb0 = open(\"/dev/fb0\", O_RDWR);\n    if(fb0 == 0)\n        error(\"Could not open framebuffer located in /dev/fb0!\");\n\n    if (ioctl(fb0, FBIOGET_FSCREENINFO, &amp;screeninfo_fixed) == -1)\n        error(\"Could not retrive fixed screen info!\");\n\n    if (ioctl(fb0, FBIOGET_VSCREENINFO, &amp;screeninfo_var) == -1)\n        error(\"Could not retrive variable screen info!\");\n\n    screeninfo_var.xres_virtual = screeninfo_var.xres;\n    screeninfo_var.yres_virtual = screeninfo_var.yres * 2;\n    screeninfo_var.width = screeninfo_var.xres;\n    screeninfo_var.height = screeninfo_var.yres;\n    screeninfo_var.xoffset = 0;\n    screeninfo_var.yoffset = 0;\n\n    if (ioctl(fb0, FBIOPUT_VSCREENINFO, &amp;screeninfo_var) == -1)\n        error(\"Could not set variable screen info!\");\n</code></pre>\n\n<p>This will always print \"Could not set variable screen info!\" due to some issue extending the virtual framebuffer size.</p>\n"}, {"tags": ["c", "language-lawyer", "c11"], "comments": [{"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1522863490, "post_id": 49657053, "comment_id": 86323339, "body": "I agree it&#39;s a bad wording, but I don&#39;t think any competent programmer would interpret it the way you suggest they might."}, {"owner": {"reputation": 34086, "user_id": 787480, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/91cDR.png?s=128&g=1", "display_name": "Sneftel", "link": "https://stackoverflow.com/users/787480/sneftel"}, "reply_to_user": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1522863648, "post_id": 49657053, "comment_id": 86323436, "body": "Ideally one shouldn&#39;t have to &quot;interpret&quot; a spec, especially to mean something other than what it literally says."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1522863755, "post_id": 49657053, "comment_id": 86323505, "body": "This is what the committee calls an &quot;editorial defect&quot;.  The wording is bad and should be fixed, but there&#39;s no real question about what the behavior ought to be."}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1522863831, "post_id": 49657053, "comment_id": 86323548, "body": "Ideally. But human languages are not computer languages: they have ambiguity and nuance. If you have a better wording, feel free to suggest it to the committee."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1522867131, "post_id": 49657053, "comment_id": 86325460, "body": "the posted code for the union `foo&#39; is NOT an actual union.  Rather it only contains a single item (the anonymous struct)"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1522867410, "post_id": 49657053, "comment_id": 86325619, "body": "regarding: <code>&amp;f == &amp;(f.b))</code>  this expression will always fail, because the field &#39;b&#39; is the second field in the struct"}, {"owner": {"reputation": 34086, "user_id": 787480, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/91cDR.png?s=128&g=1", "display_name": "Sneftel", "link": "https://stackoverflow.com/users/787480/sneftel"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 2, "creation_date": 1522867785, "post_id": 49657053, "comment_id": 86325860, "body": "@user3629249 I don&#39;t think you&#39;ve quite understood the question. By the letter of the C standard, <code>Foo</code> is a union containing two members, <code>a</code> and <code>b</code>."}, {"owner": {"reputation": 14339, "user_id": 1466970, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/V1J6z.jpg?s=128&g=1", "display_name": "Richard Chambers", "link": "https://stackoverflow.com/users/1466970/richard-chambers"}, "edited": false, "score": 2, "creation_date": 1522868964, "post_id": 49657053, "comment_id": 86326553, "body": "&quot;are considered to be members of the containing structure or union&quot; is not the same thing as &quot;are members of the containing structure or union&quot;. It seems pretty clear that the anonymous struct is a unit that is inserted into the union as a unit and the members of which are addressed by the labels of the members of the anonymous struct. There is no other reasonable alternative to being able to access the members of the anonymous struct. The phrase &quot;are considered to be members of the containing structure or union&quot; indicates the syntax for accessing a member of an anonymous struct."}, {"owner": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "reply_to_user": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 9, "creation_date": 1522870824, "post_id": 49657053, "comment_id": 86327590, "body": "This is <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n2148.htm#dr_499\" rel=\"nofollow noreferrer\">DR 499</a>  ... <code>TL;DR;</code> they should not overlap. CC @LeeDanielCrocker"}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 14339, "user_id": 1466970, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/V1J6z.jpg?s=128&g=1", "display_name": "Richard Chambers", "link": "https://stackoverflow.com/users/1466970/richard-chambers"}, "edited": false, "score": 0, "creation_date": 1523314140, "post_id": 49657053, "comment_id": 86500227, "body": "@RichardChambers: I think the problem is that the Standard fails here and in many other places to properly separate the allocation of storage and the names/namespaces via which it can be accessed.  For purpose of allocation, members of an anonymous struct within a union are contained within the struct within the union.  For purposes of name space resolution, however, the members of the struct behave as members of the union."}, {"owner": {"reputation": 14339, "user_id": 1466970, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/V1J6z.jpg?s=128&g=1", "display_name": "Richard Chambers", "link": "https://stackoverflow.com/users/1466970/richard-chambers"}, "reply_to_user": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1523332393, "post_id": 49657053, "comment_id": 86504534, "body": "@supercat that sounds reasonable. I am under the impression that much of the history of C has been attempting to refine the description and improve the language of the description with some improvements to the language along the way. C is actually a fairly small language with a fairly restricted set of keywords and the assembler of the PDP that K &amp; R first worked with still exists in parts of the language. Like many things simple, a simple description has evolved into a more complex language description as the number of different target platforms increased uncovering ambiguities in the spec."}, {"owner": {"reputation": 833, "user_id": 5513492, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RBciv.png?s=128&g=1", "display_name": "Spenser Truex", "link": "https://stackoverflow.com/users/5513492/spenser-truex"}, "reply_to_user": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "edited": false, "score": 0, "creation_date": 1525618584, "post_id": 49657053, "comment_id": 87418642, "body": "@ShafikYaghmour That is the answer."}, {"owner": {"reputation": 1061, "user_id": 2624663, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2eb6e9838672eeb1357a2dd68b41f2a?s=128&d=identicon&r=PG", "display_name": "alexsh", "link": "https://stackoverflow.com/users/2624663/alexsh"}, "reply_to_user": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1527187259, "post_id": 49657053, "comment_id": 88044698, "body": "@zwol: <i>The wording is bad and should be fixed, but there&#39;s no real question about what the behavior ought to be.</i> is far from clear. DR499 mentions at least one compiler (for IBM AIX) that implements the behavior different from the &#39;obvious&#39; one. Of course, ShafikYaghmour is right on, as always."}, {"owner": {"reputation": 13980, "user_id": 3554264, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/TbLcc.jpg?s=128&g=1", "display_name": "Christian Hujer", "link": "https://stackoverflow.com/users/3554264/christian-hujer"}, "reply_to_user": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "edited": false, "score": 1, "creation_date": 1530820557, "post_id": 49657053, "comment_id": 89379623, "body": "@ShafikYaghmour Can you turn your comment into an answer? It deserves upvotes!"}, {"owner": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "reply_to_user": {"reputation": 13980, "user_id": 3554264, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/TbLcc.jpg?s=128&g=1", "display_name": "Christian Hujer", "link": "https://stackoverflow.com/users/3554264/christian-hujer"}, "edited": false, "score": 1, "creation_date": 1530822458, "post_id": 49657053, "comment_id": 89380445, "body": "@ChristianHujer done"}, {"owner": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "reply_to_user": {"reputation": 833, "user_id": 5513492, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RBciv.png?s=128&g=1", "display_name": "Spenser Truex", "link": "https://stackoverflow.com/users/5513492/spenser-truex"}, "edited": false, "score": 0, "creation_date": 1530859398, "post_id": 49657053, "comment_id": 89389830, "body": "@SpenserTruex done"}], "answers": [{"tags": [], "owner": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "is_accepted": true, "score": 10, "last_activity_date": 1603303814, "last_edit_date": 1603303814, "creation_date": 1530822445, "answer_id": 51199363, "question_id": 49657053, "link": "https://stackoverflow.com/questions/49657053/have-anonymous-structs-and-unions-in-c11-been-incorrectly-described/51199363#51199363", "title": "Have anonymous structs and unions in C11 been incorrectly described?", "body": "<h3>TL;DR</h3>\n<p>This looks like a wording issue, they should not overlap.</p>\n<h3>Details</h3>\n<p>This is covered in <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n2148.htm#dr_499\" rel=\"nofollow noreferrer\">Defect Report (DR) 499</a> which asks:</p>\n<blockquote>\n<p>Given the following code:</p>\n<pre><code>union U {   \n struct {\n   char B1;\n   char B2;\n   char B3;\n   char B4;  \n };  \nint word; \n} u;\n</code></pre>\n<p>Does the storage of B1, B2, B3 and B4 overlap?</p>\n<p>According to 6.7.2.1#13, the members should overlap in storage as they\nbecome members of 'union U'.<br />\nAt least one implementation (GCC) seems\nto NOT consider them to be overlapping.<br />\nAt least one implementation\n(IBM's XL LE AIX) considers them to be overlapping as the standard\ncurrently states.</p>\n</blockquote>\n<p>And the committees response was:</p>\n<blockquote>\n<p>The storage does not overlap.</p>\n</blockquote>\n<blockquote>\n<p>A related issue is to be found in <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n2148.htm#dr_502\" rel=\"nofollow noreferrer\">DR 502</a> and both may be resolved with coordinated wording changes.</p>\n</blockquote>\n<p>and (emphasis added)</p>\n<blockquote>\n<p>Change \u00a76.7.2.1 p13 from:</p>\n<blockquote>\n<p>An unnamed member of structure type with no tag is called an anonymous structure; an unnamed member of union type with no tag is\ncalled an anonymous union. The members of an anonymous structure or\nunion are <strong>considered to be members of</strong> the containing structure or\nunion. This applies recursively if the containing structure or union\nis also anonymous.</p>\n</blockquote>\n<p>to:</p>\n<blockquote>\n<p>An unnamed member of structure type with no tag is called an anonymous structure; an unnamed member of union type with no tag is\ncalled an anonymous union. The names of members of an anonymous\nstructure or union are <strong>added to the name space of</strong> the containing\nstructure or union. This applies recursively if the containing\nstructure or union is also anonymous.</p>\n</blockquote>\n<p>would adequately resolve the issue.</p>\n</blockquote>\n"}], "owner": {"reputation": 34086, "user_id": 787480, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/91cDR.png?s=128&g=1", "display_name": "Sneftel", "link": "https://stackoverflow.com/users/787480/sneftel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 670, "favorite_count": 0, "accepted_answer_id": 51199363, "answer_count": 1, "score": 19, "last_activity_date": 1603303814, "creation_date": 1522863050, "last_edit_date": 1530852756, "question_id": 49657053, "link": "https://stackoverflow.com/questions/49657053/have-anonymous-structs-and-unions-in-c11-been-incorrectly-described", "title": "Have anonymous structs and unions in C11 been incorrectly described?", "body": "<p>Sayeth the C standard, regarding anonymous structs and unions:</p>\n\n<blockquote>\n  <p><a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.7.2.1p13\" rel=\"nofollow noreferrer\">6.7.2.1 p13.</a>  An unnamed member whose type specifier is a structure specifier with\n  no tag is called an anonymous structure; an unnamed member whose type\n  specifier is a union specifier with no tag is called an anonymous\n  union. <strong>The members of an anonymous structure or union are considered\n  to be members of the containing structure or union.</strong> This applies\n  recursively if the containing structure or union is also anonymous.</p>\n</blockquote>\n\n<p>Note emphasis: rather than the members of the anonymous struct/union being in the <em>scope</em> of the containing struct/union, they are fully <em>members</em> of it. But there are responsibilities attached to that:</p>\n\n<blockquote>\n  <p><a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.7.2.1p16\" rel=\"nofollow noreferrer\">6.7.2.1 p16.</a> The size of a union is sufficient to contain the largest of its members. The value of at most one of the members can be stored in a union object at any time. A pointer to a union object, suitably converted, points to <strong>each of its members</strong> (or if a member is a bit-field, then to the unit in which it resides), and vice versa.</p>\n</blockquote>\n\n<p>Taken together, those seem to imply that the members of an anonymous struct within a (named) union behave like co-located, mutually-exclusive members of the union. So the following should work:</p>\n\n<pre><code>union Foo\n{\n    struct\n    {\n        char a;\n        char b;\n    };\n};\n\nint main(void) {\n    union Foo f;\n    assert(&amp;f == &amp;(f.a) &amp;&amp; &amp;f == &amp;(f.b));\n}\n</code></pre>\n\n<p>Of course, it doesn't, and we wouldn't want it to... there'd be no reason for anonymous structs/unions if they worked like the above. Still, the Standard seems unambiguous on that point. Is there something I'm missing?</p>\n"}, {"tags": ["c", "sockets", "tcp", "benchmarking"], "answers": [{"comments": [{"owner": {"reputation": 288, "user_id": 1188912, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/489c36c70a72120c26611237dd634427?s=128&d=identicon&r=PG", "display_name": "Joel no not that Joel", "link": "https://stackoverflow.com/users/1188912/joel-no-not-that-joel"}, "edited": false, "score": 0, "creation_date": 1522864404, "post_id": 49656896, "comment_id": 86323888, "body": "Thanks! So I was using the wrong file descriptor for the recv and send then."}, {"owner": {"reputation": 288, "user_id": 1188912, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/489c36c70a72120c26611237dd634427?s=128&d=identicon&r=PG", "display_name": "Joel no not that Joel", "link": "https://stackoverflow.com/users/1188912/joel-no-not-that-joel"}, "edited": false, "score": 0, "creation_date": 1522870530, "post_id": 49656896, "comment_id": 86327443, "body": "It seems that there is additional problems.  The client now exits with 141 exit code :(  Any idea about that?"}, {"owner": {"reputation": 872, "user_id": 8077259, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/E1wSe.jpg?s=128&g=1", "display_name": "caylee", "link": "https://stackoverflow.com/users/8077259/caylee"}, "reply_to_user": {"reputation": 288, "user_id": 1188912, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/489c36c70a72120c26611237dd634427?s=128&d=identicon&r=PG", "display_name": "Joel no not that Joel", "link": "https://stackoverflow.com/users/1188912/joel-no-not-that-joel"}, "edited": false, "score": 0, "creation_date": 1522870782, "post_id": 49656896, "comment_id": 86327569, "body": "When is the client dieing? (= What is the client&#39;s output?)"}, {"owner": {"reputation": 288, "user_id": 1188912, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/489c36c70a72120c26611237dd634427?s=128&d=identicon&r=PG", "display_name": "Joel no not that Joel", "link": "https://stackoverflow.com/users/1188912/joel-no-not-that-joel"}, "edited": false, "score": 0, "creation_date": 1522871063, "post_id": 49656896, "comment_id": 86327728, "body": "The only output i&#39;m getting is: srun: error: greencompute-2: task 1: Exited with exit code 141"}, {"owner": {"reputation": 872, "user_id": 8077259, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/E1wSe.jpg?s=128&g=1", "display_name": "caylee", "link": "https://stackoverflow.com/users/8077259/caylee"}, "reply_to_user": {"reputation": 288, "user_id": 1188912, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/489c36c70a72120c26611237dd634427?s=128&d=identicon&r=PG", "display_name": "Joel no not that Joel", "link": "https://stackoverflow.com/users/1188912/joel-no-not-that-joel"}, "edited": false, "score": 1, "creation_date": 1522871342, "post_id": 49656896, "comment_id": 86327900, "body": "You should debug where the crash occurs (e.g., by setting a <code>return 0</code> statement line by line, to see how far it runs before crashing). But now, I&#39;ll probably sleep, so don&#39;t expect an answer too early"}], "tags": [], "owner": {"reputation": 872, "user_id": 8077259, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/E1wSe.jpg?s=128&g=1", "display_name": "caylee", "link": "https://stackoverflow.com/users/8077259/caylee"}, "is_accepted": true, "score": 3, "last_activity_date": 1522862478, "creation_date": 1522862478, "answer_id": 49656896, "question_id": 49656812, "link": "https://stackoverflow.com/questions/49656812/tcp-socket-fails-with-endpoint-is-not-connected-in-c-program/49656896#49656896", "title": "TCP Socket fails with &quot;endpoint is not connected&quot; in C program", "body": "<p>The error is in the server thread. You use the wrong socket descriptor.</p>\n\n<p>From the manpage of <b>accept(2)</b>:</p>\n\n<blockquote>\n  <p>On success, these system calls return a nonnegative integer that is a\n  file descriptor for the accepted socket.  On error, -1 is returned,\n  and errno is set appropriately.</p>\n</blockquote>\n\n<p>So the return value (<code>remote_sockid</code>) should be used for read(2)/write(2) calls:</p>\n\n<pre><code>if ((remote_sockid=accept(sockid,(struct sockaddr*)&amp;remote_address,&amp;size_remote_address))&lt;0)\n    DieWithError(\"TCP server accept() failed\");\n\nif ((recvMsgSize = recv(remote_sockid, buffer, block_size, 0)) &lt; 0)\n    DieWithError(\"TCP server recv() failed\");\nif (block_size == 1){\n    if (send(remote_sockid, buffer, recvMsgSize, 0)!= recvMsgSize) {\n        DieWithError(\"TCP server send() failed\");\n    } \n}\n</code></pre>\n"}], "owner": {"reputation": 288, "user_id": 1188912, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/489c36c70a72120c26611237dd634427?s=128&d=identicon&r=PG", "display_name": "Joel no not that Joel", "link": "https://stackoverflow.com/users/1188912/joel-no-not-that-joel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 720, "favorite_count": 0, "accepted_answer_id": 49656896, "answer_count": 1, "score": 1, "last_activity_date": 1522862478, "creation_date": 1522862160, "question_id": 49656812, "link": "https://stackoverflow.com/questions/49656812/tcp-socket-fails-with-endpoint-is-not-connected-in-c-program", "title": "TCP Socket fails with &quot;endpoint is not connected&quot; in C program", "body": "<p>I'm having problems getting a socket connection to work.  I'm trying to have a client connect to a server and to send the server some data. If the data is 1 byte, the server will ping pong the byte back. This code is supposed to benchmark a network.</p>\n\n<p>Currently the code dies with the following error:</p>\n\n<pre><code>TCP server recv() failed: Transport endpoint is not connected\nTCP Sever send failed: Connection reset by peer\n</code></pre>\n\n<p>Why is the connection failing?</p>\n\n<p>This is the code for the server thread.</p>\n\n<pre><code>void *tcp_server(void * context){\n    printf(\"TCP Server has started\\n\");\n    struct thread_parameters * read_params = context;\n    int block_size = read_params-&gt;block_size;\n    int thread_id = read_params-&gt;thread_id;\n    int base_port = read_params-&gt;base_port;\n    struct sockaddr_in remote_address;\n    struct sockaddr_in my_address;\n    int recvMsgSize;\n    my_address.sin_family = AF_INET;\n    my_address.sin_port = htons(base_port + thread_id);\n    my_address.sin_addr.s_addr = htonl(INADDR_ANY);\n    int sockid = socket(PF_INET, SOCK_STREAM, 0);\n    int remote_sockid;\n    read_params-&gt;sockid = sockid;\n    char buffer[block_size];\n    socklen_t size_remote_address = sizeof(remote_address); \n    if (bind(sockid, (struct sockaddr *) &amp;my_address, sizeof(my_address))&lt;0)\n        DieWithError(\"TCP server Unable to bind socket.\\n\");\n    printf(\"TCP Server has bound\\n\");\n    if (listen(sockid, 5) &lt; 0) \n        DieWithError(\"TCP server Listen Failed\");\n    while(!read_params-&gt;work_done){\n        if ((remote_sockid=accept(sockid,(struct sockaddr *)&amp;remote_address,&amp;size_remote_address))&lt;0)\n            DieWithError(\"TCP server accept() failed\");\n        if ((recvMsgSize = recv(sockid, buffer, block_size, 0)) &lt; 0)\n            DieWithError(\"TCP server recv() failed\");\n        if (block_size == 1){\n            if (send(sockid, buffer, recvMsgSize, 0)!= recvMsgSize){\n                DieWithError(\"TCP server send() failed\");\n            } \n        }\n        close(remote_sockid);\n    }\n    return 0;\n}\n</code></pre>\n\n<p>The following is the client thread.</p>\n\n<pre><code>void *tcp_client(void * context){\n    printf(\"TCP Client has started\\n\");\n    struct thread_parameters * read_params = context;\n    int block_size = read_params-&gt;block_size;\n    char *work = read_params-&gt;work;\n    long work_size = read_params-&gt;size_of_subset;\n    int thread_id = read_params-&gt;thread_id;\n    int iterations = read_params-&gt;iterations;\n    int base_port = read_params-&gt;base_port;\n    char * server_address = read_params-&gt;server_address;\n    struct sockaddr_in my_address;\n    struct sockaddr_in remote_address;\n    my_address.sin_addr.s_addr = htonl(INADDR_ANY);\n    my_address.sin_family = AF_INET;\n    remote_address.sin_family = AF_INET;\n    my_address.sin_port = htons(base_port + thread_id);\n    remote_address.sin_port = htons(base_port + thread_id);\n    int sockid = socket(PF_INET, SOCK_STREAM, 0);\n    int sendMsgSize = block_size;\n    char buffer[block_size];\n    char * message; \n    socklen_t size_remote_address = sizeof(remote_address); \n    inet_pton(AF_INET, server_address, &amp;(remote_address.sin_addr)); \n    if (bind(sockid, (struct sockaddr *) &amp;my_address, sizeof(my_address))&lt;0){\n        DieWithError(\"TCP Client Unable to bind socket.\\n\");\n    }\n    printf(\"TCP Client TCP Client has bounded\\n\");\n    if (connect(sockid, (struct sockaddr *) &amp;remote_address, size_remote_address) &lt; 0)\n        DieWithError(\"TCP Client connect() failed\");\n    int j;\n    int i;\n    int sent_size;\n    for (j=0; j&lt;iterations; j++){\n        for(i=0;i&lt;work_size; i=i+block_size){\n            message = &amp;work[i];\n            sent_size = sendMsgSize;\n            while (sent_size &gt; 0) { /* zero indicates end of transmission */\n                sent_size = send(sockid, message, block_size, 0);\n            }\n        if(sent_size != 0) DieWithError(\"TCP Sever send failed\");\n            if (block_size == 1){\n               if (recv(sockid, buffer, sendMsgSize, 0) &gt; 0){\n                    DieWithError(\"TCP Client recv() failed\");\n                }\n            }\n        }\n    }\n    close(sockid);\n    printf(\"iterations: %i\\n\", j);\n    printf(\"work size: %i\\n\", i);\n    return 0;\n} \n</code></pre>\n"}, {"tags": ["c", "algorithm", "math"], "comments": [{"owner": {"reputation": 74843, "user_id": 2988730, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ZOX7t.jpg?s=128&g=1", "display_name": "Mad Physicist", "link": "https://stackoverflow.com/users/2988730/mad-physicist"}, "edited": false, "score": 1, "creation_date": 1522862933, "post_id": 49656788, "comment_id": 86323042, "body": "Why are you posting this on a programming site? It looks like you are very far from being able to write a program."}, {"owner": {"reputation": 74843, "user_id": 2988730, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ZOX7t.jpg?s=128&g=1", "display_name": "Mad Physicist", "link": "https://stackoverflow.com/users/2988730/mad-physicist"}, "edited": false, "score": 2, "creation_date": 1522863005, "post_id": 49656788, "comment_id": 86323080, "body": "Are bubbles spherical by the way?"}, {"owner": {"reputation": 317, "user_id": 1354810, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/01d8201cb21420eb91c229a0f0dd1d09?s=128&d=identicon&r=PG", "display_name": "Kaleo Brandt", "link": "https://stackoverflow.com/users/1354810/kaleo-brandt"}, "edited": false, "score": 0, "creation_date": 1522863017, "post_id": 49656788, "comment_id": 86323093, "body": "Could you clarify the statement, &quot;I need a way to compute a single layer with only the bubbles position and radius&quot;? Are you given this information about one bubble, or all the bubbles? What is the result of computing a single layer?"}, {"owner": {"reputation": 74843, "user_id": 2988730, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ZOX7t.jpg?s=128&g=1", "display_name": "Mad Physicist", "link": "https://stackoverflow.com/users/2988730/mad-physicist"}, "reply_to_user": {"reputation": 317, "user_id": 1354810, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/01d8201cb21420eb91c229a0f0dd1d09?s=128&d=identicon&r=PG", "display_name": "Kaleo Brandt", "link": "https://stackoverflow.com/users/1354810/kaleo-brandt"}, "edited": false, "score": 0, "creation_date": 1522863071, "post_id": 49656788, "comment_id": 86323123, "body": "@KaleoBrandt. Given the position and size of all the bubbles, where would you make cuts so that the cube is divided into n pieces of equal volume?"}, {"owner": {"reputation": 74843, "user_id": 2988730, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ZOX7t.jpg?s=128&g=1", "display_name": "Mad Physicist", "link": "https://stackoverflow.com/users/2988730/mad-physicist"}, "reply_to_user": {"reputation": 317, "user_id": 1354810, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/01d8201cb21420eb91c229a0f0dd1d09?s=128&d=identicon&r=PG", "display_name": "Kaleo Brandt", "link": "https://stackoverflow.com/users/1354810/kaleo-brandt"}, "edited": false, "score": 0, "creation_date": 1522863101, "post_id": 49656788, "comment_id": 86323138, "body": "@KaleoBrandt. This is fairly non-trivial, especially if you want a fast solution."}, {"owner": {"reputation": 1108, "user_id": 9296230, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/213kd.jpg?s=128&g=1", "display_name": "Eduardo Pascual Aseff", "link": "https://stackoverflow.com/users/9296230/eduardo-pascual-aseff"}, "edited": false, "score": 2, "creation_date": 1522863268, "post_id": 49656788, "comment_id": 86323215, "body": "This is like problem D - ACM ICPC World Final 2015. Check this video on youtube <a href=\"https://www.youtube.com/watch?v=ftJM6aNQzEA\" rel=\"nofollow noreferrer\">youtube.com/watch?v=ftJM6aNQzEA</a>"}, {"owner": {"reputation": 199, "user_id": 7091281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a827dc3d0b5c3af835aa1eb36e5115d?s=128&d=identicon&r=PG&f=1", "display_name": "Luk164", "link": "https://stackoverflow.com/users/7091281/luk164"}, "edited": false, "score": 0, "creation_date": 1522863415, "post_id": 49656788, "comment_id": 86323293, "body": "I am sorry if my question was wrong in some way, I have actually writing a program is not an issue for me, its the math behind this particular project I have problem with. Bubbles are spherical and I need to cut a layer off the material so its volume will be of certain size. And yes I need to cut this block into layers of equal volume, I just figured if I am able to make one layer, I can use the same code to make more."}, {"owner": {"reputation": 199, "user_id": 7091281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a827dc3d0b5c3af835aa1eb36e5115d?s=128&d=identicon&r=PG&f=1", "display_name": "Luk164", "link": "https://stackoverflow.com/users/7091281/luk164"}, "edited": false, "score": 0, "creation_date": 1522863755, "post_id": 49656788, "comment_id": 86323504, "body": "Eduardo thank you, please post it as an answer so I can upvote it, it really helped a lot."}, {"owner": {"reputation": 199, "user_id": 7091281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a827dc3d0b5c3af835aa1eb36e5115d?s=128&d=identicon&r=PG&f=1", "display_name": "Luk164", "link": "https://stackoverflow.com/users/7091281/luk164"}, "edited": false, "score": 0, "creation_date": 1522863972, "post_id": 49656788, "comment_id": 86323649, "body": "^^This happens when you remake your comment multiple times and dont read it afterwards... /facepalm/"}, {"owner": {"reputation": 15037, "user_id": 1111371, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/85fbe34f335b26ff6f6c8ef921a682ae?s=128&d=identicon&r=PG", "display_name": "ugoren", "link": "https://stackoverflow.com/users/1111371/ugoren"}, "edited": false, "score": 0, "creation_date": 1522872440, "post_id": 49656788, "comment_id": 86328577, "body": "I&#39;m voting to close this question as off-topic because it&#39;s a math question, not a programming question. Try <a href=\"https://mathoverflow.net/\">mathoverflow.net</a>"}, {"owner": {"reputation": 199, "user_id": 7091281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a827dc3d0b5c3af835aa1eb36e5115d?s=128&d=identicon&r=PG&f=1", "display_name": "Luk164", "link": "https://stackoverflow.com/users/7091281/luk164"}, "edited": false, "score": 0, "creation_date": 1522873088, "post_id": 49656788, "comment_id": 86328920, "body": "??? ugoren I asked about using the aforementioned formula to write a code for computing a volume of an object, I know it is related to math, but how can you say it is not a programming question? If I just had to solve it myself I would have been done long ago..."}, {"owner": {"reputation": 292363, "user_id": 37213, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/eeec80237213c91e5bab56b77ac5b8ca?s=128&d=identicon&r=PG", "display_name": "duffymo", "link": "https://stackoverflow.com/users/37213/duffymo"}, "edited": false, "score": 1, "creation_date": 1522873100, "post_id": 49656788, "comment_id": 86328922, "body": "Sounds like you want to think about Eshelby inclusions: <a href=\"https://en.wikipedia.org/wiki/Eshelby%27s_inclusion\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Eshelby%27s_inclusion</a> and Eshelby stress tensor: <a href=\"https://www.sciencedirect.com/science/article/pii/S0020768306002927\" rel=\"nofollow noreferrer\">sciencedirect.com/science/article/pii/S0020768306002927</a>"}, {"owner": {"reputation": 199, "user_id": 7091281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a827dc3d0b5c3af835aa1eb36e5115d?s=128&d=identicon&r=PG&f=1", "display_name": "Luk164", "link": "https://stackoverflow.com/users/7091281/luk164"}, "edited": false, "score": 0, "creation_date": 1522873185, "post_id": 49656788, "comment_id": 86328961, "body": "duffymo I am sorry but I do not see how elasticity is related to this problem..."}, {"owner": {"reputation": 292363, "user_id": 37213, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/eeec80237213c91e5bab56b77ac5b8ca?s=128&d=identicon&r=PG", "display_name": "duffymo", "link": "https://stackoverflow.com/users/37213/duffymo"}, "edited": false, "score": 1, "creation_date": 1522874041, "post_id": 49656788, "comment_id": 86329395, "body": "Eshelby inclusions can treat materials with voids in them.  It&#39;s a more general approach.  When I see someone say &quot;I was told this formula might help&quot; it suggests that the person has no idea what they&#39;re doing.  Consider this a bit of education."}, {"owner": {"reputation": 292363, "user_id": 37213, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/eeec80237213c91e5bab56b77ac5b8ca?s=128&d=identicon&r=PG", "display_name": "duffymo", "link": "https://stackoverflow.com/users/37213/duffymo"}, "edited": false, "score": 1, "creation_date": 1522874233, "post_id": 49656788, "comment_id": 86329489, "body": "There are lots of numerical integration algorithms out there.  The volume of the layer with holes is obviously equal to the volume of the layer without voids minus the total volume of the voids.  You don&#39;t say anything about the distribution, whether or not the void radius varies, etc.  But given those the calculation should be easy."}], "answers": [{"comments": [{"owner": {"reputation": 199, "user_id": 7091281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a827dc3d0b5c3af835aa1eb36e5115d?s=128&d=identicon&r=PG&f=1", "display_name": "Luk164", "link": "https://stackoverflow.com/users/7091281/luk164"}, "edited": false, "score": 0, "creation_date": 1522863589, "post_id": 49657073, "comment_id": 86323390, "body": "Thank you but that is not really what I had in mind, imagine this: Cube with a given size has bubbles is it, you know where and how big bubbles are, how do you compute a volume of a layer? - in this example I switched looking for thickness to looking for volume"}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "reply_to_user": {"reputation": 199, "user_id": 7091281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a827dc3d0b5c3af835aa1eb36e5115d?s=128&d=identicon&r=PG&f=1", "display_name": "Luk164", "link": "https://stackoverflow.com/users/7091281/luk164"}, "edited": false, "score": 2, "creation_date": 1522865506, "post_id": 49657073, "comment_id": 86324506, "body": "no idea - this is a c programming site not a math site. Give me the algorithm - i will give you the code"}, {"owner": {"reputation": 199, "user_id": 7091281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a827dc3d0b5c3af835aa1eb36e5115d?s=128&d=identicon&r=PG&f=1", "display_name": "Luk164", "link": "https://stackoverflow.com/users/7091281/luk164"}, "edited": false, "score": 0, "creation_date": 1522873308, "post_id": 49657073, "comment_id": 86329029, "body": "Thank you, if you check out the oroginal post I added a link to a code I found, looks like our teacher got lazy and flat out copied that competition."}], "tags": [], "owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "is_accepted": false, "score": 1, "last_activity_date": 1522863162, "creation_date": 1522863162, "answer_id": 49657073, "question_id": 49656788, "link": "https://stackoverflow.com/questions/49656788/c-how-to-compute-thickness-of-a-layer-when-object-in-material/49657073#49657073", "title": "C How to compute thickness of a layer when object in material", "body": "<p>well I can convert that formula to C for you if it helps</p>\n\n<pre><code>#include &lt;math.h&gt;\ndouble Func(double h)\n{\n    double ret = C_PI*(h - (1.0/3.0) + (pow(1.0-h, 3)/3.0);\n    return ret;\n}\n</code></pre>\n"}], "owner": {"reputation": 199, "user_id": 7091281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a827dc3d0b5c3af835aa1eb36e5115d?s=128&d=identicon&r=PG&f=1", "display_name": "Luk164", "link": "https://stackoverflow.com/users/7091281/luk164"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "closed_date": 1522872650, "answer_count": 1, "score": 0, "last_activity_date": 1522864461, "creation_date": 1522862078, "last_edit_date": 1522864461, "question_id": 49656788, "link": "https://stackoverflow.com/questions/49656788/c-how-to-compute-thickness-of-a-layer-when-object-in-material", "closed_reason": "Not suitable for this site", "title": "C How to compute thickness of a layer when object in material", "body": "<p>I was making a school project and I found myself in a tight spot. I have a block of material with given size (cube, 100 000 units) that has \"bubbles\" inside. I need to cut it to plates with equal volume. I need a way to compute a single layer with only the bubbles position and radius. Bubbles never interlap and they are always completely inside the block. I was told that this formula might help:</p>\n\n<p><a href=\"https://i.stack.imgur.com/O1UnJ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/O1UnJ.png\" alt=\"\\int_{x=1-h}^1 \\pi(1-x^2)dx = \\pi(h-\\frac13 + \\frac {(1-h)^3}3)\"></a></p>\n\n<p>I am thankful for any useful information and please do not bother writing complete code, just the basic principle will be more than enough for me. Thank you</p>\n\n<p>EDIT: I have found this implementation and I am currently trying to convert it to C and use its principle in my code:\n<a href=\"http://www.cs.ucf.edu/~dmarino/progcontests/mysols/worldfinals/2015/\" rel=\"nofollow noreferrer\">http://www.cs.ucf.edu/~dmarino/progcontests/mysols/worldfinals/2015/</a></p>\n"}, {"tags": ["c", "filesystems", "fuse"], "owner": {"reputation": 464, "user_id": 5803067, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/24c214b5a2bb45dabb3122be0dfef109?s=128&d=identicon&r=PG", "display_name": "Aneesh Durg", "link": "https://stackoverflow.com/users/5803067/aneesh-durg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1522861935, "creation_date": 1522861935, "question_id": 49656746, "link": "https://stackoverflow.com/questions/49656746/fuse-filesystem-not-calling-release", "title": "Fuse filesystem not calling release", "body": "<p>from <a href=\"https://libfuse.github.io/doxygen/structfuse__operations.html#abac8718cdfc1ee273a44831a27393419\" rel=\"nofollow noreferrer\">the fuse docs</a> I thought that on calling close, fuse would call release. However, this does not seem to be the case for my filsystem. I have registered my release function with the following code:</p>\n\n<pre><code>static int my_release( const char *path, struct fuse_file_info *fi)\n  if(!strcmp(path, \"/example\"))\n    return -ENOENT;\n  LOGGING(\"RELEASED %ld\\n\", fi-&gt;fh); // fh field set by my_open\n  // Cleaning up some allocated buffers for fh here\n  return 0;  \n}\nstatic struct fuse_operations fops = {\n  // ... other callbacks\n  .release  = my_release,\n}\n</code></pre>\n\n<p>Is there some other function I should be using to implement a close callback? </p>\n"}, {"tags": ["c", "arrays", "for-loop", "scanf"], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 9375699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/392a82162f249911e299f295f8a15628?s=128&d=identicon&r=PG", "display_name": "William", "link": "https://stackoverflow.com/users/9375699/william"}, "edited": false, "score": 0, "creation_date": 1522862655, "post_id": 49656743, "comment_id": 86322874, "body": "Did not realize that mistake, thanks! could you also tell me why the scores are being taken in but not printed correctly? <a href=\"http://tinypic.com/r/2nva5ag/9\" rel=\"nofollow noreferrer\">tinypic.com/r/2nva5ag/9</a> (not sure which link will work) <a href=\"http://oi68.tinypic.com/2nva5ag.jpg\" rel=\"nofollow noreferrer\">oi68.tinypic.com/2nva5ag.jpg</a>"}, {"owner": {"reputation": 1253, "user_id": 3596376, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aeldq.jpg?s=128&g=1", "display_name": "tom", "link": "https://stackoverflow.com/users/3596376/tom"}, "reply_to_user": {"reputation": 41, "user_id": 9375699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/392a82162f249911e299f295f8a15628?s=128&d=identicon&r=PG", "display_name": "William", "link": "https://stackoverflow.com/users/9375699/william"}, "edited": false, "score": 0, "creation_date": 1522863056, "post_id": 49656743, "comment_id": 86323113, "body": "@William Yes - I should have spotted that - I just edited the answer about that point. - You don&#39;t need the <code>&amp;</code> when you print out.... the <code>&amp;</code> means address of and <code>scanf</code> needs it, whereas <code>printf</code> just needs the value so last line should be <code>printf(&quot;%i\\n&quot;, scores{j]);</code> do put the <code>\\n</code> gives a newline after each score."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1522872217, "post_id": 49656743, "comment_id": 86328456, "body": "@tom Consider <a href=\"https://meta.stackoverflow.com/questions/305468/is-it-bad-form-to-ask-a-commentor-for-an-accept-upvote#comment243847_305468\">Don&#39;t ever ask someone to accept your own answer.</a>"}, {"owner": {"reputation": 1253, "user_id": 3596376, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aeldq.jpg?s=128&g=1", "display_name": "tom", "link": "https://stackoverflow.com/users/3596376/tom"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1522872910, "post_id": 49656743, "comment_id": 86328828, "body": "@chux - thanks for your message - I didn&#39;t realize the ettiquette. I won&#39;t do it again - except to ask for people to accept other people&#39;s answers to show that their question is solved, but is even that something that one should not do?  p.s. I love your profile picture. -- I am a bit younger perhaps, coding since ZX81"}], "tags": [], "owner": {"reputation": 1253, "user_id": 3596376, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aeldq.jpg?s=128&g=1", "display_name": "tom", "link": "https://stackoverflow.com/users/3596376/tom"}, "is_accepted": false, "score": 5, "last_activity_date": 1522862977, "last_edit_date": 1522862977, "creation_date": 1522861928, "answer_id": 49656743, "question_id": 49656723, "link": "https://stackoverflow.com/questions/49656723/c-why-is-my-for-loop-with-a-scanf-not-being-executed/49656743#49656743", "title": "c - why is my for loop with a scanf not being executed?", "body": "<p>change</p>\n\n<pre><code> for(i=0;i&gt;6;i++)\n</code></pre>\n\n<p>and </p>\n\n<pre><code> for(j=0;j&gt;6;j++)\n</code></pre>\n\n<p>to</p>\n\n<pre><code> for(i=0;i&lt;6;i++)\n</code></pre>\n\n<p>and</p>\n\n<pre><code> for(j=0;j&lt;6;j++)\n</code></pre>\n\n<p>the loop only runs while the condition is true and at the start <code>i=0</code> so <code>i&gt;6</code> is false... or in English the way you have written it the loop runs whilst i is greater than 6 - i starts at 0 so it does not run the loop - same issue with your next loop.</p>\n\n<p>There are some other things - like in the first loop I would put in a line to say</p>\n\n<pre><code>  printf(\"please enter score %d: \",i); \n</code></pre>\n\n<p>because then it will make more sense as you enter numbers and you will see what is happening better.</p>\n\n<p>Edited code below....  ** plus note the <code>&amp;</code> is only for <code>scanf</code> not <code>printf</code> ** see in code below it has been removed for the <code>printf</code> in the final loop.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint main()\n{\n    char firstName1[20];\n    char lastName1[20];\n    char firstName2[20];\n    char lastName2[20];\n    char firstName3[20];\n    char lastName3[20];\n\n\n    int scores[18];\n\n    scanf(\"%s\", &amp;firstName1[0]);\n    scanf(\"%s\", &amp;lastName1[0]);\n\n    printf(\"%s \", &amp;firstName1[0]);\n    printf(\"%s \", &amp;lastName1[0]);\n\n    //this for loop here is not being executed, could it be a formatting \n    issue? \n    //%i or %d?\n    int i=0;\n    for(i=0;i&lt;6;i++)\n    {\n        printf(\"please enter score %d: \",i);       \n        scanf(\" %d \", &amp;scores[i]);\n    }\n\n\n    int j=0;\n    for(j=0;j&lt;6;j++)\n    {\n        printf(\"score %i: %i\\n\", j, scores{j]);\n    }\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 9375699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/392a82162f249911e299f295f8a15628?s=128&d=identicon&r=PG", "display_name": "William", "link": "https://stackoverflow.com/users/9375699/william"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "closed_date": 1522892140, "answer_count": 1, "score": 2, "last_activity_date": 1522862977, "creation_date": 1522861845, "question_id": 49656723, "link": "https://stackoverflow.com/questions/49656723/c-why-is-my-for-loop-with-a-scanf-not-being-executed", "closed_reason": "Not suitable for this site", "title": "c - why is my for loop with a scanf not being executed?", "body": "<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint main()\n{\n    char firstName1[20];\n    char lastName1[20];\n    char firstName2[20];\n    char lastName2[20];\n    char firstName3[20];\n    char lastName3[20];\n\n\n    int scores[18];\n\n    scanf(\"%s\", &amp;firstName1[0]);\n    scanf(\"%s\", &amp;lastName1[0]);\n\n    printf(\"%s \", &amp;firstName1[0]);\n    printf(\"%s \", &amp;lastName1[0]);\n\n    //this for loop here is not being executed, could it be a formatting \n    issue? \n    //%i or %d?\n    int i=0;\n    for(i=0;i&gt;6;i++)\n    {\n        scanf(\" %d \", &amp;scores[i]);\n    }\n\n\n    int j=0;\n    for(j=0;j&gt;6;j++)\n    {\n        printf(\"%i\", &amp;scores{j]);\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>The picture provided shows the output result, the taking in name and printing name works but the loop with the scanf to take in scores is not being executed</p>\n\n<p><a href=\"https://i.stack.imgur.com/6ufJ3.png\" rel=\"nofollow noreferrer\">The first part of the code taking in the name and printing it back works, however the rest of the code (being the for loops) are not being executed.</a></p>\n"}, {"tags": ["c", "arrays", "string", "sorting"], "comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 3, "creation_date": 1522861728, "post_id": 49656674, "comment_id": 86322393, "body": "This might sound unhelpful, but I honestly recommend to use pen and paper and simulate an easy case."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 1, "creation_date": 1522861801, "post_id": 49656674, "comment_id": 86322431, "body": "I&#39;d say we don&#39;t really have ideologies in programming :o"}], "answers": [{"tags": [], "owner": {"reputation": 352, "user_id": 2123548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf77cf1daaa005dafb62e9d9ab94690c?s=128&d=identicon&r=PG", "display_name": "Anirudh", "link": "https://stackoverflow.com/users/2123548/anirudh"}, "is_accepted": false, "score": 0, "last_activity_date": 1522862069, "creation_date": 1522862069, "answer_id": 49656784, "question_id": 49656674, "link": "https://stackoverflow.com/questions/49656674/understanding-2d-char-array-in-c/49656784#49656784", "title": "Understanding 2D Char Array in C", "body": "<p>So a 2D array is a contiguous block of memory that is not demarcated by the language as such. When you refer to arr[i] it assumes the string to start from arr[i] which in terms of memory location is (arr + (i-1) * MAX). </p>\n"}, {"comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1522880536, "post_id": 49659496, "comment_id": 86332401, "body": "And the arrays passed to the functions <code>strcmp</code> and <code>strcpy</code> -- had better be <i>nul-terminated</i> as &quot;<i>string</i>&quot; functions do not accept arrays as arguments -- unless they are properly nul-terminated."}, {"owner": {"reputation": 298, "user_id": 4206613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc66dc117a13e548d125f627589ad817?s=128&d=identicon&r=PG", "display_name": "doppelheathen", "link": "https://stackoverflow.com/users/4206613/doppelheathen"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1522882731, "post_id": 49659496, "comment_id": 86333227, "body": "Nice catch.  Thanks."}], "tags": [], "owner": {"reputation": 298, "user_id": 4206613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc66dc117a13e548d125f627589ad817?s=128&d=identicon&r=PG", "display_name": "doppelheathen", "link": "https://stackoverflow.com/users/4206613/doppelheathen"}, "is_accepted": false, "score": 1, "last_activity_date": 1525200620, "last_edit_date": 1525200620, "creation_date": 1522872261, "answer_id": 49659496, "question_id": 49656674, "link": "https://stackoverflow.com/questions/49656674/understanding-2d-char-array-in-c/49659496#49659496", "title": "Understanding 2D Char Array in C", "body": "<p>What other languages consider multi-dimensional arrays are implemented in C as arrays of arrays.  For example, an array int foo[3][3] is implemented as an array of size 3 whose elements are of array type (an array of size 3 of int type).</p>\n\n<p>Putting aside that array expressions are converted to pointers in parameters, what is happening in the example is that arr[i] and arr[j] are referring to the arrays of size MAX of char type at offsets i and j of array arr, thus passing arrays to the functions strcmp and strcpy to use to compare the strings stored in those arrays.</p>\n"}, {"tags": [], "owner": {"reputation": 9095, "user_id": 8542346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11b206b49cec657d28a5876f8330780e?s=128&d=identicon&r=PG&f=1", "display_name": "H.S.", "link": "https://stackoverflow.com/users/8542346/h-s"}, "is_accepted": true, "score": 2, "last_activity_date": 1522897060, "last_edit_date": 1522897060, "creation_date": 1522896658, "answer_id": 49663374, "question_id": 49656674, "link": "https://stackoverflow.com/questions/49656674/understanding-2d-char-array-in-c/49663374#49663374", "title": "Understanding 2D Char Array in C", "body": "<p>The in-memory view of <code>arr</code> will be something like this:</p>\n\n<pre><code>index   0 1 2 3 4 5 6 7 8...............99\n       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\narr[0] |G|e|e|k|s|f|o|r|G|e|e|k|s|0|...|0|\n       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\narr[1] |Q|u|i|z|0|.....................|0|\n       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\narr[2] |P|r|a|c|t|i|c|e|0|.............|0|\n       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\narr[3] |G|b|l|o|g|s|0|.................|0|\n       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\narr[4] |C|o|d|i|n|g|0|.................|0|\n       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n</code></pre>\n\n<p><code>arr[i]</code> represents the string at <code>i</code><sup>th</sup> index of array <code>arr</code> (considering the value of <code>i</code> is a valid index w.r.t to array <code>arr</code>).</p>\n\n<blockquote>\n  <p>However, I am confused as to what is happening when....</p>\n</blockquote>\n\n<p>Let's take an example, assume <code>j=2</code> and <code>i=3</code> and the contents of the array of strings <code>arr</code> is same as shown above (in-memory view).<br>\nThe statement</p>\n\n<pre><code>if (strcmp(arr[j], arr[i]) &gt; 0)\n</code></pre>\n\n<p>will be</p>\n\n<pre><code>if (strcmp(\"Practice\", \"Gblogs\") &gt; 0)\n</code></pre>\n\n<p>because</p>\n\n<pre><code>arr[j] --&gt; arr[2] --&gt; \"Practice\"\nand\narr[i] --&gt; arr[3] --&gt; \"Gblogs\"\n</code></pre>\n\n<p>In this case, the <code>strcmp()</code> will return value <code>&gt; 0</code> and the <code>if</code> condition resulting in <code>true</code> and the two strings will be swapped like this:</p>\n\n<pre><code>strcpy(temp, arr[j]);\n</code></pre>\n\n<p>This will copy the content of <code>arr[2]</code> (<code>\"Practice\"</code>) to array <code>temp</code>.\nNote: <code>strcpy()</code> copies the source to destination including terminating null character.</p>\n\n<pre><code>strcpy(arr[j], arr[i]);\n</code></pre>\n\n<p>This will copy the content of <code>arr[3]</code> to <code>arr[2]</code>. After this both <code>arr[3]</code> to <code>arr[2]</code> will have same value i.e. <code>\"Gblogs\"</code></p>\n\n<pre><code>strcpy(arr[i], temp);\n</code></pre>\n\n<p>This will copy the content of array <code>temp</code> to <code>arr[3]</code>. After this the <code>arr[3]</code> will have <code>\"Practice\"</code>.<br>\nSo, after swapping the content of <code>arr[2]</code> and <code>arr[3]</code> will be</p>\n\n<pre><code>arr[2] --&gt; \"Gblogs\"\narr[3] --&gt; \"Practice\"\n</code></pre>\n\n<p>This way the strings are getting swapped in <code>sortStrings()</code> function.</p>\n\n<p>Hope this clarifies your doubts.</p>\n"}], "owner": {"reputation": 135, "user_id": 9278761, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d986832959069c6aac01a9f3e3adb7b2?s=128&d=identicon&r=PG&f=1", "display_name": "ancd3ea4", "link": "https://stackoverflow.com/users/9278761/ancd3ea4"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1020, "favorite_count": 0, "accepted_answer_id": 49663374, "answer_count": 3, "score": 1, "last_activity_date": 1525200620, "creation_date": 1522861644, "question_id": 49656674, "link": "https://stackoverflow.com/questions/49656674/understanding-2d-char-array-in-c", "title": "Understanding 2D Char Array in C", "body": "<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#define MAX 100\n/* run this program using the console pauser or add your own getch, system(\"pause\") or input loop */\nvoid sortStrings(char arr[][MAX], int n)\n{\n    char temp[MAX];\n    int j, i;\n    // Sorting strings using bubble sort\n    for (j=0; j&lt;n-1; j++)\n    {\n        for (i=j+1; i&lt;n; i++)\n        {\n            if (strcmp(arr[j], arr[i]) &gt; 0)\n            {\n                strcpy(temp, arr[j]);\n                strcpy(arr[j], arr[i]);\n                strcpy(arr[i], temp);\n            }\n        }\n    }\n}\nint main(int argc, char *argv[]) \n{       \n    char arr[][MAX] = {\"GeeksforGeeks\",\"Quiz\",\"Practice\",\"Gblogs\",\"Coding\"};\n    int n = sizeof(arr)/sizeof(arr[0]);\n    int i;\n    sortStrings(arr, n);\n\n    printf(\"Strings in sorted order are : \");\n    for (i=0; i&lt;n; i++)\n        printf(\"\\n String %d is %s\", i+1, arr[i]);\n\n    return 0;\n}\n</code></pre>\n\n<p>I got this code directly from GeeksForGeeks for Bubble sort \"<a href=\"https://www.geeksforgeeks.org/sorting-strings-using-bubble-sort-2/\" rel=\"nofollow noreferrer\">https://www.geeksforgeeks.org/sorting-strings-using-bubble-sort-2/</a>\"\nAnd I'm trying to make sense of it. I understand the basic ideology of how 2D arrays work where the first array is the index, and the second array is the contents of the index. However, I am confused as to what is happening when </p>\n\n<pre><code>if (strcmp(arr[j], arr[i]) &gt; 0)\n            {\n                strcpy(temp, arr[j]);\n                strcpy(arr[j], arr[i]);\n                strcpy(arr[i], temp);\n            }\n</code></pre>\n\n<p>I don't understand what arr[j] or arr[i] is referring to in arr[][MAX]</p>\n\n<pre><code>printf(\"\\n String %d is %s\", i+1, arr[i]);\n</code></pre>\n\n<p>I'm also confused as to what is going on in the print of arr[i] as well. Shouldn't it be identified which index containing which contents is being printed? Sorry if my questions are confusing, I am new to 2D arrays. </p>\n"}, {"tags": ["c", "macos", "gcc", "cmake", "opencl"], "comments": [{"owner": {"reputation": 6533, "user_id": 1918193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b70a14318e0f417ecac47809f38fafc?s=128&d=identicon&r=PG", "display_name": "Marc Glisse", "link": "https://stackoverflow.com/users/1918193/marc-glisse"}, "edited": false, "score": 4, "creation_date": 1522860901, "post_id": 49656430, "comment_id": 86321963, "body": "Did you try just removing <code>-lrt</code>? It is part of the standard C library, other platforms may have those functions somewhere linked by defaut."}, {"owner": {"reputation": 32882, "user_id": 1870760, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/NAAkp.png?s=128&g=1", "display_name": "Hatted Rooster", "link": "https://stackoverflow.com/users/1870760/hatted-rooster"}, "edited": false, "score": 2, "creation_date": 1522860949, "post_id": 49656430, "comment_id": 86321988, "body": "<a href=\"https://stackoverflow.com/questions/1505402/library-not-found-for-lrt-with-qtcreator-mac-os\" title=\"library not found for lrt with qtcreator mac os\">stackoverflow.com/questions/1505402/&hellip;</a> might help"}, {"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 0, "creation_date": 1522861170, "post_id": 49656430, "comment_id": 86322111, "body": "Note that even on Ubuntu 16.04, it&#39;d work with <code>-lrt</code> if you&#39;re using glibc because it&#39;s <a href=\"https://stackoverflow.com/a/32649327/1275169\">no longer a separate library</a>. Since you are MacOS, you can just remove it and compile - if it compiles then you don&#39;t need it at all!"}, {"owner": {"reputation": 771, "user_id": 7299097, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/29f4433d0679a2b6b45bf601d6cf184e?s=128&d=identicon&r=PG&f=1", "display_name": "jackxujh", "link": "https://stackoverflow.com/users/7299097/jackxujh"}, "edited": false, "score": 0, "creation_date": 1522861895, "post_id": 49656430, "comment_id": 86322483, "body": "Thanks for pointing out that!"}, {"owner": {"reputation": 771, "user_id": 7299097, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/29f4433d0679a2b6b45bf601d6cf184e?s=128&d=identicon&r=PG&f=1", "display_name": "jackxujh", "link": "https://stackoverflow.com/users/7299097/jackxujh"}, "edited": false, "score": 0, "creation_date": 1522861908, "post_id": 49656430, "comment_id": 86322489, "body": "I just found that I have a new issue regarding to the <code>-lOpenCL</code> option... Which also says not found..."}], "owner": {"reputation": 771, "user_id": 7299097, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/29f4433d0679a2b6b45bf601d6cf184e?s=128&d=identicon&r=PG&f=1", "display_name": "jackxujh", "link": "https://stackoverflow.com/users/7299097/jackxujh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 6062, "favorite_count": 0, "closed_date": 1522861212, "answer_count": 0, "score": 2, "last_activity_date": 1522860826, "creation_date": 1522860748, "last_edit_date": 1522860826, "question_id": 49656430, "link": "https://stackoverflow.com/questions/49656430/what-is-the-c-library-rt", "closed_reason": "Duplicate", "title": "What is the C library &quot;rt&quot;?", "body": "<p>I was trying to run a simple OpenCL test program for a course assignment. But I got an error when running <code>make</code>.</p>\n\n<p>The error is:</p>\n\n<blockquote>\n  <p><code>ld: library not found for -lrt</code></p>\n</blockquote>\n\n<p>I checked the <code>Makefile</code>, and found the related line was:</p>\n\n<pre><code>cl-demo: cl-demo.c cl-helper.c\ngcc $(CL_CFLAGS) $(CL_LDFLAGS) -std=gnu99 -o$@ $^ -lrt -lOpenCL -v\n</code></pre>\n\n<p>While my fellow classmates using Ubuntu 16.04 managed to run this test program just fine, I am using macOS High Sierra. The TAs nor the professor cannot figure it out (unfortunately, they only have experience of OpenCL on Ubuntu). </p>\n\n<p>It feels like that the missing library <code>rt</code> seems be a library from some common package, but I don't know which package it comes from. Is it exclusive to Ubuntu or Linux? Does anybody knows where it comes from? Thanks!</p>\n"}, {"tags": ["c", "gcc", "macos-high-sierra", "bochs"], "comments": [{"owner": {"reputation": 10953, "user_id": 776473, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/dbfcfc0e3c4b2b0baef2383fbc97f687?s=128&d=identicon&r=PG", "display_name": "acm", "link": "https://stackoverflow.com/users/776473/acm"}, "edited": false, "score": 2, "creation_date": 1522860817, "post_id": 49656306, "comment_id": 86321916, "body": "GCC 4.2 was released more than a decade ago. Why on earth are you required to use such an out of date toolchain?"}, {"owner": {"reputation": 5996, "user_id": 1152524, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b2e23f3f9bf82e6fe806261f50b2f9b6?s=128&d=identicon&r=PG&f=1", "display_name": "txtechhelp", "link": "https://stackoverflow.com/users/1152524/txtechhelp"}, "reply_to_user": {"reputation": 10953, "user_id": 776473, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/dbfcfc0e3c4b2b0baef2383fbc97f687?s=128&d=identicon&r=PG", "display_name": "acm", "link": "https://stackoverflow.com/users/776473/acm"}, "edited": false, "score": 0, "creation_date": 1522870772, "post_id": 49656306, "comment_id": 86327566, "body": "@acm .. it might be &#39;out of date&#39;, but that doesn&#39;t mean it doesn&#39;t work great as a compiler .. to wit, OpenBSD still uses 4.2.1(for many reasons)."}, {"owner": {"reputation": 5996, "user_id": 1152524, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b2e23f3f9bf82e6fe806261f50b2f9b6?s=128&d=identicon&r=PG&f=1", "display_name": "txtechhelp", "link": "https://stackoverflow.com/users/1152524/txtechhelp"}, "edited": false, "score": 0, "creation_date": 1522871306, "post_id": 49656306, "comment_id": 86327881, "body": "A good point is made though .. is there a <i>specific</i> reason you <i>need</i> 4.2.1 versus just using what comes on the mac? That is to say, are you writing C code that uses gcc 4.2.1 compiler specific code, or is the code your writing ANSI/ISO C that could compile just as well on any other compiler? If you <i>need</i> 4.2.1, you might need to utilize <a href=\"http://caiustheory.com/install-gcc-421-apple-build-56663-with-xcode-42/\" rel=\"nofollow noreferrer\">homebrew</a>"}, {"owner": {"reputation": 10953, "user_id": 776473, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/dbfcfc0e3c4b2b0baef2383fbc97f687?s=128&d=identicon&r=PG", "display_name": "acm", "link": "https://stackoverflow.com/users/776473/acm"}, "edited": false, "score": 0, "creation_date": 1522873982, "post_id": 49656306, "comment_id": 86329369, "body": "I agree GCC 4.2.1 was a great vintage of GCC. But I&#39;m hard pressed to think of reasons it might be <i>required</i> for a student project."}, {"owner": {"reputation": 99, "user_id": 5648802, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wMsuz.png?s=128&g=1", "display_name": "thelostmachine", "link": "https://stackoverflow.com/users/5648802/thelostmachine"}, "edited": false, "score": 0, "creation_date": 1522949034, "post_id": 49656306, "comment_id": 86367640, "body": "We\u2019re writing components of an operating system in Bochs using a virtual machine, and I thought we were using gcc was 4.2.1 but it\u2019s actually 4.6.3, sorry. A classmate told me he compiled the projects with gcc 5.4 on the VM, but I believe my main issue is compiling Bochs itself to get it running."}, {"owner": {"reputation": 10953, "user_id": 776473, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/dbfcfc0e3c4b2b0baef2383fbc97f687?s=128&d=identicon&r=PG", "display_name": "acm", "link": "https://stackoverflow.com/users/776473/acm"}, "edited": false, "score": 0, "creation_date": 1522949248, "post_id": 49656306, "comment_id": 86367755, "body": "Why don&#39;t you just install bochs from homebrew?"}, {"owner": {"reputation": 99, "user_id": 5648802, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wMsuz.png?s=128&g=1", "display_name": "thelostmachine", "link": "https://stackoverflow.com/users/5648802/thelostmachine"}, "edited": false, "score": 0, "creation_date": 1522949764, "post_id": 49656306, "comment_id": 86368066, "body": "AH never mind  So I had installed Bochs from homebrew but thought it wasn&#39;t working because my project wasn&#39;t compiling. But that&#39;s just the C code not compiling. Bochs actually DOES run. I just need to compile my C code with the right compiler.  I suppose my point still stands, how would I go about compiling with GCC 4.6.3?"}, {"owner": {"reputation": 10953, "user_id": 776473, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/dbfcfc0e3c4b2b0baef2383fbc97f687?s=128&d=identicon&r=PG", "display_name": "acm", "link": "https://stackoverflow.com/users/776473/acm"}, "edited": false, "score": 0, "creation_date": 1522951031, "post_id": 49656306, "comment_id": 86368746, "body": "At least for me brew seems to have a gcc@4.9 package, but nothing older. You could always build GCC from source, but that is a chore. I still want to know why you need to use any specific version of GCC though. What happens if you build and compile your code with a newer version and try to run it in bochs? Does it work? If not, how does it fail?"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user9478968"}, "is_accepted": true, "score": 1, "last_activity_date": 1522957580, "creation_date": 1522957580, "answer_id": 49680361, "question_id": 49656306, "link": "https://stackoverflow.com/questions/49656306/how-can-i-install-gcc-4-2-1-on-osx-sierra/49680361#49680361", "title": "How can I install gcc 4.2.1 on OSX Sierra?", "body": "<p>You can install previous version of gcc pretty easily using <a href=\"https://brew.sh/\" rel=\"nofollow noreferrer\">homebrew</a>.</p>\n\n<p>If you have homebrew installed you can get gcc 4.9 by running</p>\n\n<pre><code>brew install gcc@4.9\n</code></pre>\n\n<p>After it is installed <code>gcc</code> will still map to the clang that came with your mac. The newly installed <code>gcc</code> will be installed at <code>/usr/local/bin</code> and be called something like <code>gcc-4</code>.</p>\n\n<p>You can find the exact executable name using </p>\n\n<p><code>ls /usr/local/bin | grep gcc</code></p>\n\n<p>Hopefully 4.9 is close enough to 4.6 for your purposes.</p>\n"}], "owner": {"reputation": 99, "user_id": 5648802, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wMsuz.png?s=128&g=1", "display_name": "thelostmachine", "link": "https://stackoverflow.com/users/5648802/thelostmachine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2590, "favorite_count": 0, "accepted_answer_id": 49680361, "answer_count": 1, "score": 2, "last_activity_date": 1522957580, "creation_date": 1522860376, "last_edit_date": 1522949086, "question_id": 49656306, "link": "https://stackoverflow.com/questions/49656306/how-can-i-install-gcc-4-2-1-on-osx-sierra", "title": "How can I install gcc 4.2.1 on OSX Sierra?", "body": "<p>I'm using the Bochs emulator and for my class we're using gcc 4.2.1. I believe I've gotten Bochs running, but now I need to compile our programs which are compatible with gcc 4.2/.1.</p>\n\n<p>I understand OSX uses an alias for gcc 4.2.1, but how can I use gcc specifically and not clang?</p>\n\n<p>Edit: GCC 4.6.3 not 4.2.1 sorry</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 1, "creation_date": 1522860493, "post_id": 49655991, "comment_id": 86321720, "body": "Whether char is signed or unsigned is not standardized and left to the implementation.  Often unsigned by default in older compilers, today compilers usually have an option to change it.  That won&#39;t do for the return value of strcmp(), you are seeing the library implementer picking a predictable value."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "is_accepted": true, "score": 9, "last_activity_date": 1522860376, "last_edit_date": 1522860376, "creation_date": 1522859418, "answer_id": 49656030, "question_id": 49655991, "link": "https://stackoverflow.com/questions/49655991/using-unsigned-char-and-char/49656030#49656030", "title": "Using unsigned char and char", "body": "<blockquote>\n  <p>My question is why \"unsigned\" used in return even though if we didn't use it we will get the same result (based on the tests I did)?</p>\n</blockquote>\n\n<p>Arithmetics are done with the type <code>int</code>, so <strong>if</strong> <code>char</code> is signed, you will get wrong values for negative chars because of sign extending them.</p>\n\n<p>Example: assume your chars are 8 bits wide and signed with 2's complement. Then the character at code point 128 would have an integer value of <code>-128</code> and therefore compare <em>smaller</em> than any in the range [0,127], not what you want. Casting to <code>unsigned char</code> first makes sure the integer value is <code>128</code>.</p>\n\n<blockquote>\n  <p>Lastly, is char unsigned or signed by default?</p>\n</blockquote>\n\n<p>This is, in fact, <em>implementation defined</em>. So, explicitly use <em>unsigned char</em> to be sure.</p>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 1, "last_activity_date": 1522872890, "creation_date": 1522872890, "answer_id": 49659667, "question_id": 49655991, "link": "https://stackoverflow.com/questions/49655991/using-unsigned-char-and-char/49659667#49659667", "title": "Using unsigned char and char", "body": "<blockquote>\n  <p>I looked at many implementations of strCmp() and found that most of the pointers implementations are done using unsigned char</p>\n</blockquote>\n\n<p>Code that implements the standard C library function <code>int strcmp(const char *s1, const char *s2);</code> is <strong>specified</strong> to perform the comparison as if the string was composed of <code>unsigned char</code> characters.  This applies if <code>char</code> is implemented as <code>signed char</code> or <code>unsigned char</code>.</p>\n\n<blockquote>\n  <p>For all functions in this subclause, each character shall be interpreted as if it had the type <code>unsigned char</code>  C11 \u00a77.24.1 3</p>\n</blockquote>\n\n<pre><code>// Example that performs the correct compare without a possibility of overflow.\nint strCmp(const char* s1, const char* s2) {\n  const unsigned char *u1 = (const unsigned char *) s1;\n  const unsigned char *u2 = (const unsigned char *) s2;\n  while((*u1 == *u2) &amp;&amp; *u1) {\n    u1++;\n    u2++;\n  }    \n  return (*u1 &gt; *u2) - (*u1 &lt; *u2);\n}\n</code></pre>\n\n<hr>\n\n<p>Below fails on rare machines where range of <code>unsigned char</code> == range of <code>unsigned</code>.</p>\n\n<pre><code>return *(const unsigned char*)s1 - *(const unsigned char*)s2;\n</code></pre>\n"}], "owner": {"reputation": 97, "user_id": 9135835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d75d645d05e5617b18a5f1ffee95b620?s=128&d=identicon&r=PG&f=1", "display_name": "Mohan", "link": "https://stackoverflow.com/users/9135835/mohan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 313, "favorite_count": 0, "accepted_answer_id": 49656030, "answer_count": 2, "score": 4, "last_activity_date": 1522872890, "creation_date": 1522859279, "question_id": 49655991, "link": "https://stackoverflow.com/questions/49655991/using-unsigned-char-and-char", "title": "Using unsigned char and char", "body": "<p>I looked at many implementations of strCmp() and found that most of the pointers implementations are done using unsigned char</p>\n\n<p>My question is why \"unsigned\" used in return even though if we didn't use it we will get the same result (based on the tests I did)? </p>\n\n<p>if I didn't use it, will I get a wrong result for some values? </p>\n\n<p>Lastly, is char unsigned or signed by default?</p>\n\n<p>Example 1 </p>\n\n<pre><code>int strCmp(const char* s1, const char* s2)\n{\n    while(*s1 &amp;&amp; (*s1 == *s2))\n    {\n        s1++;\n        s2++;\n    }    \n    return *(const unsigned char*)s1 - *(const unsigned char*)s2;\n}\n</code></pre>\n\n<p>Example 2</p>\n\n<pre><code>int strCmp(const char *S1, const char *S2)\n{\n\n  for(; *S1 == *S2; ++S1, ++S2)\n    if(*S1 == 0)\n      return 0;\n  return *(unsigned char *)S1 &lt; *(unsigned char *)S2 ? -1 : 1;\n  }\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1522858672, "post_id": 49655797, "comment_id": 86320645, "body": "why do you copy your input to another array? Anyways, this comparison is wrong: <code>if(temp==num[i])</code> ... you compare the address of <code>temp</code> to an address of one of the strings in <code>num</code>. if you want to compare strings, use <a href=\"https://linux.die.net/man/3/strcmp\" rel=\"nofollow noreferrer\"><code>strcmp</code></a>."}, {"owner": {"reputation": 15946, "user_id": 4606734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/858769040849894/picture?type=large", "display_name": "ameyCU", "link": "https://stackoverflow.com/users/4606734/ameycu"}, "edited": false, "score": 1, "creation_date": 1522858805, "post_id": 49655797, "comment_id": 86320738, "body": "<code>temp</code> is not allocated any memory. Dereferencing it will cause undefined behaviour.  Allocate memory to it first."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1522858810, "post_id": 49655797, "comment_id": 86320745, "body": "side note: <code>scanf(&quot;%s&quot;, ...)</code> is, just like <code>gets()</code>, a guaranteed buffer overflow, never use it! You might want to read my <a href=\"http://sekrit.de/webdocs/c/beginners-guide-away-from-scanf.html\" rel=\"nofollow noreferrer\">beginners&#39; guide away from scanf</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 15946, "user_id": 4606734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/858769040849894/picture?type=large", "display_name": "ameyCU", "link": "https://stackoverflow.com/users/4606734/ameycu"}, "edited": false, "score": 1, "creation_date": 1522858863, "post_id": 49655797, "comment_id": 86320780, "body": "@ameyCU good catch ... should just be an array as well. Or shouldn&#39;t even be there in the first place, copying is just pointless here."}, {"owner": {"reputation": 648, "user_id": 5694959, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-TN18H3fTni4/AAAAAAAAAAI/AAAAAAAAAA8/HH8MErbPvAI/photo.jpg?sz=128", "display_name": "Monk", "link": "https://stackoverflow.com/users/5694959/monk"}, "edited": false, "score": 0, "creation_date": 1522859528, "post_id": 49655797, "comment_id": 86321121, "body": "Three thing... 1. remove void before main to int, 2. assign memory to temp, 3. use strcmp() to compare two strings."}, {"owner": {"reputation": 13, "user_id": 2758424, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001936511759/picture?type=large", "display_name": "Mrunal Deole", "link": "https://stackoverflow.com/users/2758424/mrunal-deole"}, "edited": false, "score": 0, "creation_date": 1522864719, "post_id": 49655797, "comment_id": 86324069, "body": "Input may contain more than one words separated by space,(I haven&#39;t implemented that in the above program though) thats why I am using temp to temporarily store an individual world and convert temp into an integer."}], "owner": {"reputation": 13, "user_id": 2758424, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001936511759/picture?type=large", "display_name": "Mrunal Deole", "link": "https://stackoverflow.com/users/2758424/mrunal-deole"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "closed_date": 1522858701, "answer_count": 0, "score": 0, "last_activity_date": 1522858489, "creation_date": 1522858489, "question_id": 49655797, "link": "https://stackoverflow.com/questions/49655797/converting-digits-spelling-to-integer-in-c", "closed_reason": "Duplicate", "title": "Converting digit&#39;s spelling to integer in C", "body": "<p>I want to convert a digit's spelling to an integer using C.For example \"one\" => 1,\"two\"=> 2 etc.I wrote the following program but it's not working.</p>\n\n<pre><code>    #include&lt;stdio.h&gt;\n    #include&lt;string.h&gt;\n\n    void main()\n    {\n      int a=0,iplen=0,j=0;\n      char *num[]={\"zero\", \"one\", \"two\", \"three\", \"four\", \"five\", \"six\", \"seven\", \"eight\", \"nine\"};\n      char input[100],*temp;\n\n      scanf(\"%s\",input);\n      iplen=strlen(input);\n\n      for(int i=0;i&lt;iplen;i++)\n      {\n        temp[j]=input[i];\n        j++;\n      }\n\n      for(int i=0;i&lt;10;i++)\n      {\n        if(temp==num[i])\n        {\n          a=i;\n          break;\n        }\n      }\n      printf(\"\\n%d\",a);\n    }\n</code></pre>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 30558, "user_id": 1013719, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/U8X0A.jpg?s=128&g=1", "display_name": "Ryan Haining", "link": "https://stackoverflow.com/users/1013719/ryan-haining"}, "edited": false, "score": 3, "creation_date": 1522858436, "post_id": 49655746, "comment_id": 86320509, "body": "shouldn&#39;t the check for <code>if (toDelete == NULL)</code> come before the call to <code>removeChild</code>? and shouldn&#39;t you only call <code>removeChild</code> if <code>toDelete != NULL</code> ?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 2, "creation_date": 1522858454, "post_id": 49655746, "comment_id": 86320520, "body": "Please create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. Don&#39;t clutter it with <code>scanf</code> and similar, but make it complete, so people can test it, and add sample input and expected output."}, {"owner": {"reputation": 8984, "user_id": 2485966, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dZj6A.jpg?s=128&g=1", "display_name": "Ruud Helderman", "link": "https://stackoverflow.com/users/2485966/ruud-helderman"}, "edited": false, "score": 0, "creation_date": 1522858800, "post_id": 49655746, "comment_id": 86320732, "body": "You never clear the links pointing to the target person, coming from target person&#39;s parents. You only clear a local variable: <code>toDelete</code>."}, {"owner": {"reputation": 55, "user_id": 9375647, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "antelemon", "link": "https://stackoverflow.com/users/9375647/antelemon"}, "edited": false, "score": 0, "creation_date": 1522858816, "post_id": 49655746, "comment_id": 86320751, "body": "Correct, as for the second post I&#39;ll try to construct something"}, {"owner": {"reputation": 5338, "user_id": 4594973, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/USV9e.jpg?s=128&g=1", "display_name": "code_dredd", "link": "https://stackoverflow.com/users/4594973/code-dredd"}, "edited": false, "score": 2, "creation_date": 1522858835, "post_id": 49655746, "comment_id": 86320764, "body": "You may want to double-check the phrasing here: <i>&quot;I set the ... node I&#39;m trying to delete, to <code>NULL</code> and free it&quot;</i>. If you&#39;re indeed doing that <i>in that order</i>, then you need to reverse it, i.e. you must first free the node, and then set it to <code>null</code>."}, {"owner": {"reputation": 55, "user_id": 9375647, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "antelemon", "link": "https://stackoverflow.com/users/9375647/antelemon"}, "reply_to_user": {"reputation": 5338, "user_id": 4594973, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/USV9e.jpg?s=128&g=1", "display_name": "code_dredd", "link": "https://stackoverflow.com/users/4594973/code-dredd"}, "edited": false, "score": 0, "creation_date": 1522859053, "post_id": 49655746, "comment_id": 86320890, "body": "@ray ah yes a typo sorry, just fixed"}, {"owner": {"reputation": 55, "user_id": 9375647, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "antelemon", "link": "https://stackoverflow.com/users/9375647/antelemon"}, "reply_to_user": {"reputation": 8984, "user_id": 2485966, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dZj6A.jpg?s=128&g=1", "display_name": "Ruud Helderman", "link": "https://stackoverflow.com/users/2485966/ruud-helderman"}, "edited": false, "score": 0, "creation_date": 1522859103, "post_id": 49655746, "comment_id": 86320919, "body": "@RuudHelderman how/where would I clear those links"}, {"owner": {"reputation": 5092, "user_id": 5481471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf6efc50461d3521db348bf483652040?s=128&d=identicon&r=PG&f=1", "display_name": "G. Sliepen", "link": "https://stackoverflow.com/users/5481471/g-sliepen"}, "edited": false, "score": 1, "creation_date": 1522860350, "post_id": 49655746, "comment_id": 86321624, "body": "Please be aware that family trees are actually <a href=\"https://en.wikipedia.org/wiki/Family_tree#Graph_theory\" rel=\"nofollow noreferrer\">directed acyclic graphs</a>."}, {"owner": {"reputation": 957, "user_id": 2729876, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tTIEO.png?s=128&g=1", "display_name": "SIGSTACKFAULT", "link": "https://stackoverflow.com/users/2729876/sigstackfault"}, "edited": false, "score": 0, "creation_date": 1522861701, "post_id": 49655746, "comment_id": 86322377, "body": "When you delete a node, you want to delete all it&#39;s children (parents), right?"}, {"owner": {"reputation": 957, "user_id": 2729876, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tTIEO.png?s=128&g=1", "display_name": "SIGSTACKFAULT", "link": "https://stackoverflow.com/users/2729876/sigstackfault"}, "edited": false, "score": 0, "creation_date": 1522861752, "post_id": 49655746, "comment_id": 86322406, "body": "<a href=\"https://xkcd.com/379/\" rel=\"nofollow noreferrer\">Relevant xkcd</a>"}, {"owner": {"reputation": 8984, "user_id": 2485966, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dZj6A.jpg?s=128&g=1", "display_name": "Ruud Helderman", "link": "https://stackoverflow.com/users/2485966/ruud-helderman"}, "edited": false, "score": 0, "creation_date": 1522876237, "post_id": 49655746, "comment_id": 86330546, "body": "@antelemon Sorry, I meant to say &quot;coming from target&#39;s <i>children</i>&quot;. As pointed out by others, you still have references to the target person; unless you are willing to store a child list for each person, you&#39;ll have to scan the tree in search of target&#39;s children."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1522877294, "post_id": 49655746, "comment_id": 86331071, "body": "@antelemon <code>struct node {     char *data;     struct node *left;     struct node *right; };</code> is curious as it has no children.  I&#39;d expect <code>struct person {     char *data;     struct person *father; struct person *mother; struct family *family; }</code> and <code>struct family {     char *data;     struct person *spouse[2];  struct person **children; }</code> or the like."}, {"owner": {"reputation": 55, "user_id": 9375647, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "antelemon", "link": "https://stackoverflow.com/users/9375647/antelemon"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1522879219, "post_id": 49655746, "comment_id": 86331917, "body": "@chux my bad i forgot to include the child at the end, i have updated"}], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 9375647, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "antelemon", "link": "https://stackoverflow.com/users/9375647/antelemon"}, "edited": false, "score": 0, "creation_date": 1522865063, "post_id": 49656851, "comment_id": 86324277, "body": "So obliterate is essentially just a replacement for removeChild right? Confused on removing the reference"}, {"owner": {"reputation": 957, "user_id": 2729876, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tTIEO.png?s=128&g=1", "display_name": "SIGSTACKFAULT", "link": "https://stackoverflow.com/users/2729876/sigstackfault"}, "reply_to_user": {"reputation": 55, "user_id": 9375647, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "antelemon", "link": "https://stackoverflow.com/users/9375647/antelemon"}, "edited": false, "score": 0, "creation_date": 1522865674, "post_id": 49656851, "comment_id": 86324583, "body": "<code>free</code> leaves anything that still points to that address intact, so a parser might still descend the tree and try to access the node we just deleted."}, {"owner": {"reputation": 957, "user_id": 2729876, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tTIEO.png?s=128&g=1", "display_name": "SIGSTACKFAULT", "link": "https://stackoverflow.com/users/2729876/sigstackfault"}, "reply_to_user": {"reputation": 55, "user_id": 9375647, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "antelemon", "link": "https://stackoverflow.com/users/9375647/antelemon"}, "edited": false, "score": 0, "creation_date": 1522865746, "post_id": 49656851, "comment_id": 86324621, "body": "Oh I see your real problem now."}, {"owner": {"reputation": 55, "user_id": 9375647, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "antelemon", "link": "https://stackoverflow.com/users/9375647/antelemon"}, "edited": false, "score": 0, "creation_date": 1522866110, "post_id": 49656851, "comment_id": 86324848, "body": "Yeah so when I print, everything still is outputted. Do I need to unreferenced things somehow?"}, {"owner": {"reputation": 55, "user_id": 9375647, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "antelemon", "link": "https://stackoverflow.com/users/9375647/antelemon"}, "edited": false, "score": 0, "creation_date": 1522870463, "post_id": 49656851, "comment_id": 86327405, "body": "so there is a free method replacing the default free method?"}, {"owner": {"reputation": 957, "user_id": 2729876, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tTIEO.png?s=128&g=1", "display_name": "SIGSTACKFAULT", "link": "https://stackoverflow.com/users/2729876/sigstackfault"}, "reply_to_user": {"reputation": 55, "user_id": 9375647, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "antelemon", "link": "https://stackoverflow.com/users/9375647/antelemon"}, "edited": false, "score": 0, "creation_date": 1522870495, "post_id": 49656851, "comment_id": 86327423, "body": "No; I&#39;m using the usual one. Why?"}, {"owner": {"reputation": 55, "user_id": 9375647, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "antelemon", "link": "https://stackoverflow.com/users/9375647/antelemon"}, "edited": false, "score": 0, "creation_date": 1522872946, "post_id": 49656851, "comment_id": 86328843, "body": "void free(node **n)"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1522873276, "post_id": 49656851, "comment_id": 86329013, "body": "Did you want <code>void free(node ** n){</code> to be <code>void obliterate(node ** n){</code>?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1522873391, "post_id": 49656851, "comment_id": 86329074, "body": "&quot;<code>free</code> leaves anything that still points to that address intact&quot; is not quite right.  The contents of the free&#39;d memory are not specified.  The free&#39;d memory is not specified to be intact -it might be - it might not."}, {"owner": {"reputation": 55, "user_id": 9375647, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "antelemon", "link": "https://stackoverflow.com/users/9375647/antelemon"}, "edited": false, "score": 0, "creation_date": 1522874318, "post_id": 49656851, "comment_id": 86329524, "body": "So I&#39;m still having troubles removing the node. The nodes before it are changed to null, but the node I&#39;m trying to delete itself is still intact. Also is <code>free_node_date</code> just <code>free_node</code>?"}, {"owner": {"reputation": 957, "user_id": 2729876, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tTIEO.png?s=128&g=1", "display_name": "SIGSTACKFAULT", "link": "https://stackoverflow.com/users/2729876/sigstackfault"}, "edited": false, "score": 0, "creation_date": 1522877840, "post_id": 49656851, "comment_id": 86331332, "body": "<code>free_node_data</code> should free <code>data</code>, e.g., <code>void free_node_data(node *n){free(n-&gt;data);}</code>"}], "tags": [], "owner": {"reputation": 957, "user_id": 2729876, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tTIEO.png?s=128&g=1", "display_name": "SIGSTACKFAULT", "link": "https://stackoverflow.com/users/2729876/sigstackfault"}, "is_accepted": false, "score": 3, "last_activity_date": 1531848473, "last_edit_date": 1531848473, "creation_date": 1522862331, "answer_id": 49656851, "question_id": 49655746, "link": "https://stackoverflow.com/questions/49655746/family-tree-in-c/49656851#49656851", "title": "Family Tree in C", "body": "<p><a href=\"https://xkcd.com/379/\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7Rf0N.png\" alt=\"enter image description here\"></a></p>\n\n<p>Sorry.</p>\n\n<p>Anyways,</p>\n\n<pre><code>// free a node and all its children.\n// Return # of nodes freed.\nint free_node_recursive(node * n){\n    int total_freed = 1;\n\n    // free the left child (if any)\n    if(n-&gt;left != NULL){\n        free_node_data(n-&gt;left);\n        total_freed += free_node_recursive(n-&gt;left);\n        n-&gt;left = NULL;\n    }\n\n    // free the right child (if any)\n    if(n-&gt;right != NULL){\n        free_node_data(n-&gt;right);\n        total_freed += free_node_recursive(n-&gt;right);\n        n-&gt;right = NULL;\n    }\n\n    // actually free the thing.\n    free(n);\n\n    return total_freed;\n}\n</code></pre>\n\n<p>Eg. </p>\n\n<pre><code>void delete(node* root){\n    char array[13];\n    node *toDelete;\n    printf (\"Please specify a name to delete\\n\");\n    scanf(\"%s\", array);\n    toDelete = scan(root, array); \n    if(toDelete == NULL) {\n        printf(\"ERROR -- Node does not exist\");\n    } else {\n        free_node_recursive(&amp;toDelete); \n    }\n}\n</code></pre>\n\n<p>Your problem was that, in the global tree (<code>root</code>), the reference to the node just deleted would <em>still be there</em>. A parser descending the tree would find the reference in the parent still intact, and try to descend into it, finding the data already <code>free</code>'d and inaccessible; segfault. </p>\n"}, {"comments": [{"owner": {"reputation": 1473, "user_id": 9541310, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ux53p.png?s=128&g=1", "display_name": "terry.qiao", "link": "https://stackoverflow.com/users/9541310/terry-qiao"}, "edited": false, "score": 0, "creation_date": 1522892382, "post_id": 49661977, "comment_id": 86335755, "body": "This is the right answer. You can set it to <code>NULL</code> only on the <code>left &#47; right</code> pointer itself, not a copy variable, i.e.: <code>toDelete</code>. So <code>toDelete</code> needs to be a <code>node **</code> so that the original pointer can be deleted from the tree by <code>*toDelete = NULL;</code>."}, {"owner": {"reputation": 55, "user_id": 9375647, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "antelemon", "link": "https://stackoverflow.com/users/9375647/antelemon"}, "edited": false, "score": 0, "creation_date": 1522948016, "post_id": 49661977, "comment_id": 86367048, "body": "Thanks for the response, I&#39;m trying to fix it, but am ending up with a ton of errors sadly"}], "tags": [], "owner": {"reputation": 5867, "user_id": 2252087, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/020cbe41b02f03d59f3adae022c0ce7d?s=128&d=identicon&r=PG", "display_name": "ensc", "link": "https://stackoverflow.com/users/2252087/ensc"}, "is_accepted": true, "score": 1, "last_activity_date": 1522884901, "creation_date": 1522884901, "answer_id": 49661977, "question_id": 49655746, "link": "https://stackoverflow.com/questions/49655746/family-tree-in-c/49661977#49661977", "title": "Family Tree in C", "body": "<p>Your recursive calls to <code>removeChild()</code> are broken; they should contain a reference to <code>left</code>/<code>right</code>;  compile should warn about it.  But a more simple implementation would be</p>\n\n<pre><code>void removeChild(node **trash) \n{\n    if (!*trash)\n        return;\n\n    removeChild(&amp;(*trash)-&gt;right);    \n    removeChild(&amp;(*trash)-&gt;left);\n    free(*trash);\n    *thrash = NULL;\n}\n</code></pre>\n\n<p>But the <code>free()</code> is probably wrong for your \"family tree\" where a node can be a parent of multiple children.  You could implement some reference counting here.</p>\n\n<p>The </p>\n\n<pre><code>node *toDelete;\n...\ntoDelete = scan(root, array);\n...\nremoveChild(&amp;toDelete);\n</code></pre>\n\n<p>needs to be changed too:  <code>scan()</code> should return <code>node **</code> so that <code>&amp;root</code> can be passed to <code>removeChild()</code> (when it matches <code>array</code>).</p>\n\n<p>And, \"<code>mother</code>\" and \"<code>father</code>\" might be more suitable names instead of <code>left</code> and <code>right</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 1473, "user_id": 9541310, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ux53p.png?s=128&g=1", "display_name": "terry.qiao", "link": "https://stackoverflow.com/users/9541310/terry-qiao"}, "is_accepted": false, "score": 1, "last_activity_date": 1522897838, "creation_date": 1522897838, "answer_id": 49663538, "question_id": 49655746, "link": "https://stackoverflow.com/questions/49655746/family-tree-in-c/49663538#49663538", "title": "Family Tree in C", "body": "<p>Below is my solution:</p>\n\n<pre><code>void delete(node* root){\n    ......\n\n    node** toDelete;\n    toDelete = scan(root, array); \n    if(toDelete == NULL) {\n        printf(\"ERROR -- Node does not exist\");\n    } else {\n        removeChild(*toDelete);\n        *toDelete = NULL;\n    }\n}\n\nvoid removeChild(struct node *trash){\n    if(trash-&gt;left != NULL) {\n        removeChild(trash-&gt;left);\n        // no need to write trash-&gt;left = NULL here,\n        // as the whole subtree would be removed after all done.\n    }\n    if(trash-&gt;right != NULL) {\n        removeChild(trash-&gt;right);\n    }\n\n    free(trash);\n}\n</code></pre>\n\n<p>And as a reminder, your <code>scan</code> must return a <code>node**</code> instead of <code>node*</code>.</p>\n"}], "owner": {"reputation": 55, "user_id": 9375647, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "antelemon", "link": "https://stackoverflow.com/users/9375647/antelemon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 893, "favorite_count": 0, "accepted_answer_id": 49661977, "answer_count": 3, "score": 1, "last_activity_date": 1531890831, "creation_date": 1522858248, "last_edit_date": 1531890831, "question_id": 49655746, "link": "https://stackoverflow.com/questions/49655746/family-tree-in-c", "title": "Family Tree in C", "body": "<p>I'm writing a family tree program and I'm having troubles deleting a node off of the family tree. I have a <code>delete</code> method, which takes the name of the node to delete, finds it, then removes it. I free the <code>trash</code> node, the node I'm trying to delete, and set it to <code>NULL</code>, but it is still there when I test it. Am I supposed to assign new left and right paths for a node rather than trying to set it to <code>NULL</code>?</p>\n\n<pre><code>struct node {\n    char *data;\n    struct node *left;\n    struct node *right;\n}*child;\n\n\nvoid delete(node* root){\n    char array[13];\n    node *toDelete;\n    printf (\"Please specify a name to delete\\n\");\n    scanf(\"%s\", array);\n    toDelete = scan(root, array); \n    if(toDelete == NULL) {\n            printf(\"ERROR -- Node does not exist\");\n    } else {\n    removeChild(&amp;toDelete); \n    }\n}\n\nvoid removeChild(node **trash){\n    if((*trash)-&gt;left == NULL &amp;&amp; (*trash)-&gt;right == NULL) { //no parents\n            free(*trash);\n            *trash = NULL;\n    }\n    else if((*trash)-&gt;left == NULL &amp;&amp; (*trash)-&gt;right != NULL) { //have mother\n            removeChild((*trash)-&gt;right);\n    }\n    else if((*trash)-&gt;left != NULL &amp;&amp; (*trash)-&gt;right == NULL) { //have father\n            removeChild((*trash)-&gt;left);\n    } else{  //have both\n            removeChild((*trash)-&gt;left);\n            removeChild((*trash)-&gt;right);\n    }\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1523059395, "post_id": 49655428, "comment_id": 86418627, "body": "Using <code>-pedantic</code> compiler switch will diagnose the problem"}], "answers": [{"tags": [], "owner": {"reputation": 1053, "user_id": 7885081, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CZvVb.png?s=128&g=1", "display_name": "Jose Fernando Lopez Fernandez", "link": "https://stackoverflow.com/users/7885081/jose-fernando-lopez-fernandez"}, "is_accepted": true, "score": 2, "last_activity_date": 1522878806, "creation_date": 1522878806, "answer_id": 49661026, "question_id": 49655428, "link": "https://stackoverflow.com/questions/49655428/char-automatically-converts-to-int-i-guess/49661026#49661026", "title": "Char automatically converts to int (I guess)", "body": "<p>The answer you're getting, <code>FFFFFFAE</code>, is a result of the <code>char</code> data type being signed. If you check the value, you'll notice that it's equal to -82, where -82 + 256 = 174, or <code>0xAE</code> in hexadecimal.</p>\n\n<p>The reason you get the correct output when you print <code>0b10101110</code> or even 174 is because you're using the literal values directly, whereas in your example you're first putting the 0xAE value in a <code>signed char</code> where the value is then being sort of \"reinterpreted modulo 128\", if you wanna think of it that way.</p>\n\n<p>So in other words:</p>\n\n<pre><code>    0   =    0 = 0x00 \n    127 =  127 = 0x7F\n    128 = -128 = 0xFFFFFF80\n    129 = -127 = 0xFFFFFF81\n    174 =  -82 = 0xFFFFFFAE\n    255 =   -1 = 0xFFFFFFFF\n    256 =    0 = 0x00\n</code></pre>\n\n<p>To fix this \"problem\", you could declare the same array you initially did, just make sure to use an <code>unsigned char</code> type array and your values should print as you expect.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n\nint main()\n{\n    unsigned char temp[] = { 0xAE, 0xFF };\n\n    printf(\"%X\\n\", temp[0]);\n    printf(\"%d\\n\\n\", temp[0]);\n\n    printf(\"%X\\n\", temp[1]);\n    printf(\"%d\\n\\n\", temp[1]);\n\n    return EXIT_SUCCESS;\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>AE\n174\n\nFF\n255\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5010, "user_id": 773879, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zqTIy.jpg?s=128&g=1", "display_name": "Mark Segal", "link": "https://stackoverflow.com/users/773879/mark-segal"}, "is_accepted": false, "score": 1, "last_activity_date": 1522878912, "creation_date": 1522878912, "answer_id": 49661045, "question_id": 49655428, "link": "https://stackoverflow.com/questions/49655428/char-automatically-converts-to-int-i-guess/49661045#49661045", "title": "Char automatically converts to int (I guess)", "body": "<p><a href=\"https://linux.die.net/man/3/printf\" rel=\"nofollow noreferrer\">https://linux.die.net/man/3/printf</a></p>\n\n<p>According to the man page, <code>%x</code> or <code>%X</code> accept an <code>unsigned integer</code>. Thus it will read 4 bytes from the stack.</p>\n\n<p>In any case, under most architectures you can't pass a parameter that is less then a <code>word</code> (i.e. <code>int</code> or <code>long</code>) in size, and in your case it will be converted to <code>int.</code></p>\n\n<p>In the first case, you're passing a <code>char</code>, so it will be casted to <code>int</code>. Both are signed, so a signed cast is performed, thus you see preceding <code>FF</code>s.</p>\n\n<p>In your second example, you're actually passing an <code>int</code> all the way, so no cast is performed.</p>\n\n<p>If you'd try:</p>\n\n<pre><code>printf(\"%X\\n\", (char) 0b10101110);\n</code></pre>\n\n<p>You'd see that <code>FFFFFFAE</code> will be printed.</p>\n"}, {"tags": [], "owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "is_accepted": false, "score": 1, "last_activity_date": 1523056247, "creation_date": 1523056247, "answer_id": 49702119, "question_id": 49655428, "link": "https://stackoverflow.com/questions/49655428/char-automatically-converts-to-int-i-guess/49702119#49702119", "title": "Char automatically converts to int (I guess)", "body": "<p>When you pass a smaller than <code>int</code> data type (as <code>char</code> is) to a variadic function (as <code>printf(3)</code> is) the parameter is converted to <code>int</code> in case the parameter is <code>signed</code> and to <code>unsigned int</code> in the case it is unsigned.  What is being done and you observe is a <strong>sign extension</strong>, as the most significative bit of the <code>char</code> variable is active, it is replicated to the thre bytes needed to complete an <code>int</code>.</p>\n\n<p>To solve this and to have the data in 8 bits, you have two possibilities:</p>\n\n<ul>\n<li><p>Allow your <code>signed char</code> to convert to an int (with sign extension) then mask the bits 8 and above.</p>\n\n<pre><code>printf(\"%X\\n\", (int) my_char &amp; 0xff);\n</code></pre></li>\n<li><p>Declare your variable as <code>unsigned</code>, so it is promoted to an <code>unsigned int</code>.</p>\n\n<pre><code>unsigned char my_char;\n...\nprintf(\"%X\\n\", my_char);\n</code></pre></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "is_accepted": false, "score": 0, "last_activity_date": 1523059236, "creation_date": 1523059236, "answer_id": 49702464, "question_id": 49655428, "link": "https://stackoverflow.com/questions/49655428/char-automatically-converts-to-int-i-guess/49702464#49702464", "title": "Char automatically converts to int (I guess)", "body": "<p>This code causes <a href=\"https://stackoverflow.com/a/4105123/1505939\"><strong>undefined behaviour</strong></a>. The argument to <code>%X</code> must have type <code>unsigned int</code>, but you supply <code>char</code>.</p>\n\n<p>Undefined behaviour means that anything can happen; including, but not limited to, extra F's appearing in the output.</p>\n"}], "owner": {"reputation": 77, "user_id": 9182799, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d76c475cda93b7a172c35a2c8978f3d1?s=128&d=identicon&r=PG", "display_name": "\u041e\u043b\u0435\u0433", "link": "https://stackoverflow.com/users/9182799/%d0%9e%d0%bb%d0%b5%d0%b3"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 49661026, "answer_count": 4, "score": 2, "last_activity_date": 1523059236, "creation_date": 1522857179, "last_edit_date": 1522943590, "question_id": 49655428, "link": "https://stackoverflow.com/questions/49655428/char-automatically-converts-to-int-i-guess", "title": "Char automatically converts to int (I guess)", "body": "<p>I have following code</p>\n\n<pre><code>char temp[] = { 0xAE, 0xFF };\nprintf(\"%X\\n\", temp[0]);\n</code></pre>\n\n<p>Why output is <code>FFFFFFAE</code>, not just <code>AE</code>?</p>\n\n<p>I tried</p>\n\n<pre><code>printf(\"%X\\n\", 0b10101110);\n</code></pre>\n\n<p>And output is correct: <code>AE</code>.</p>\n\n<p>Suggestions?</p>\n"}, {"tags": ["c", "linux", "sockets", "network-programming"], "comments": [{"owner": {"reputation": 1065, "user_id": 3845747, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/9u54v.jpg?s=128&g=1", "display_name": "MrPickles", "link": "https://stackoverflow.com/users/3845747/mrpickles"}, "edited": false, "score": 0, "creation_date": 1522858645, "post_id": 49655198, "comment_id": 86320632, "body": "Have you tried debugging using <code>gdb</code>?  You can manually disable <code>SIGPIPE</code> with <code>gdb handle SIGPIPE nostop</code>."}, {"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 0, "creation_date": 1522859329, "post_id": 49655198, "comment_id": 86321035, "body": "You have attempted to do the same in multiple ways (ignore SIGPIPE, block SIGPIPE, <i>and</i> tell <code>send</code> to ignore SIGPIPE) So it should <i>really</i> work ;-) Are you sure the program exits because of SIGPIPE and not due to some other problem? How did you determine SIGPIPE is the cause for exit?"}, {"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "edited": false, "score": 0, "creation_date": 1522861716, "post_id": 49655198, "comment_id": 86322385, "body": "Have your rebuilt your application after making this change?"}, {"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "edited": false, "score": 0, "creation_date": 1522861857, "post_id": 49655198, "comment_id": 86322461, "body": "<code>send</code> may do only a partial send and your code cannot handle that because it does not check the return value of <code>send</code> calls."}, {"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "edited": false, "score": 1, "creation_date": 1522861892, "post_id": 49655198, "comment_id": 86322477, "body": "You should also post your code here."}], "answers": [{"comments": [{"owner": {"reputation": 175, "user_id": 8946047, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mUnWs.jpg?s=128&g=1", "display_name": "jl0x61", "link": "https://stackoverflow.com/users/8946047/jl0x61"}, "edited": false, "score": 0, "creation_date": 1522901238, "post_id": 49658289, "comment_id": 86337778, "body": "I use <code>gcc -g httpd.c -lphtread</code> to compile my code, and use <code>strace -i .&#47;httpd</code> to trace my program and it was killed by SIGPIPE. But the new program is <code>a.out</code>. So I was stracing the old program. \u03a3(\u3063&#176;\u0414&#176;;)\u3063.  When strace the correct program, It prevent SIGPIPE successfully."}], "tags": [], "owner": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "is_accepted": true, "score": 1, "last_activity_date": 1522867645, "creation_date": 1522867645, "answer_id": 49658289, "question_id": 49655198, "link": "https://stackoverflow.com/questions/49655198/how-to-prevent-sigpipe-in-multi-thread-program/49658289#49658289", "title": "How to prevent SIGPIPE in multi-thread program?", "body": "<p>The usual way is just ignore SIGPIPE (<code>signal(SIGPIPE, SIG_IGN);</code> -- which you say you've done), and then <em>CAREFULLY</em> check <em>EVERY</em> write and send call to ensure you are checking the return value properly and dealing with any EPIPE (or other) errors you get.</p>\n\n<p>The danger of ignoring SIGPIPE is that it's easy to get a program that runs off writing to a closed connection, ignoring errors, and never terminates.</p>\n\n<p>Once you ignore SIGPIPE, your program will never exit due to a SIGPIPE.</p>\n"}], "owner": {"reputation": 175, "user_id": 8946047, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mUnWs.jpg?s=128&g=1", "display_name": "jl0x61", "link": "https://stackoverflow.com/users/8946047/jl0x61"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 367, "favorite_count": 0, "accepted_answer_id": 49658289, "answer_count": 1, "score": 0, "last_activity_date": 1522867645, "creation_date": 1522856437, "question_id": 49655198, "link": "https://stackoverflow.com/questions/49655198/how-to-prevent-sigpipe-in-multi-thread-program", "title": "How to prevent SIGPIPE in multi-thread program?", "body": "<p>I wrote a tiny httpd. But if I send many request to httpd in a short period of time, httpd will exit because of SIGPIPE.</p>\n\n<p>After searching on Google, I add</p>\n\n<pre><code>signal(SIGPIPE, SIG_IGN);\nsigset_t signal_mask; \nsigemptyset(&amp;signal_mask); \nsigaddset(&amp;signal_mask, SIGPIPE); \nif(pthread_sigmask(SIG_BLOCK, &amp;signal_mask, NULL) == -1) \nperror(\"SIGPIPE\"); \n</code></pre>\n\n<p>and</p>\n\n<pre><code>send(fd, buf, strlen(buf), MSG_NOSIGNAL);\n</code></pre>\n\n<p>in my code to prevent SIGPIPE.</p>\n\n<p>But httpd still exit because of SIGPIPE.</p>\n\n<p>Can anyone help me solve the problem?</p>\n\n<p>my code:</p>\n\n<p><a href=\"https://paste.ubuntu.com/p/9fxR8YB9CT/\" rel=\"nofollow noreferrer\">httpd.c</a></p>\n\n<p><a href=\"https://paste.ubuntu.com/p/DxNHPXyMm7/\" rel=\"nofollow noreferrer\">threadpool.c</a></p>\n"}, {"tags": ["c++", "c", "bash", "tcl"], "comments": [{"owner": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "edited": false, "score": 6, "creation_date": 1522856565, "post_id": 49655160, "comment_id": 86319302, "body": "Eh, how about picking <i>one</i> language?"}, {"owner": {"reputation": 306, "user_id": 9464761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98021f004e15acd14387c43c77356d16?s=128&d=identicon&r=PG&f=1", "display_name": "NetJohn", "link": "https://stackoverflow.com/users/9464761/netjohn"}, "edited": false, "score": 1, "creation_date": 1522856596, "post_id": 49655160, "comment_id": 86319329, "body": "Have you looked at all at the library provided in &lt;time.h&gt;? <a href=\"https://en.wikibooks.org/wiki/C_Programming/time.h\" rel=\"nofollow noreferrer\">en.wikibooks.org/wiki/C_Programming/time.h</a>"}, {"owner": {"reputation": 387, "user_id": 9540923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d48a552370030dd69ae1d9ba44d88fd?s=128&d=identicon&r=PG&f=1", "display_name": "Some progammer", "link": "https://stackoverflow.com/users/9540923/some-progammer"}, "edited": false, "score": 1, "creation_date": 1522856679, "post_id": 49655160, "comment_id": 86319392, "body": "Using C++, you can use the <a href=\"https://www.boost.org/\" rel=\"nofollow noreferrer\">Boost</a> library or <a href=\"http://en.cppreference.com/w/cpp/header/ctime\" rel=\"nofollow noreferrer\">ctime</a>."}, {"owner": {"reputation": 205702, "user_id": 7552, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b60298053f87465641c1b1192338c8cd?s=128&d=identicon&r=PG", "display_name": "glenn jackman", "link": "https://stackoverflow.com/users/7552/glenn-jackman"}, "edited": false, "score": 0, "creation_date": 1522858064, "post_id": 49655160, "comment_id": 86320305, "body": "For Tcl, read <a href=\"http://www.tcl-lang.org/man/tcl8.6/TclCmd/clock.htm\" rel=\"nofollow noreferrer\">tcl-lang.org/man/tcl8.6/TclCmd/clock.htm</a>"}, {"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 0, "creation_date": 1522861584, "post_id": 49655160, "comment_id": 86322315, "body": "May be of help <a href=\"https://stackoverflow.com/questions/24686846/get-current-time-in-milliseconds-or-hhmmssmmm-format/35157784#35157784\" title=\"get current time in milliseconds or hhmmssmmm format\">stackoverflow.com/questions/24686846/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 10469, "user_id": 519360, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f90aeb577f276cbaee4db1b7bdf622a?s=128&d=identicon&r=PG", "display_name": "Adam Katz", "link": "https://stackoverflow.com/users/519360/adam-katz"}, "edited": false, "score": 1, "creation_date": 1522857107, "post_id": 49655319, "comment_id": 86319699, "body": "The epoch date in the question is in microseconds, not seconds.  If you treat it as seconds, <code>date</code> presents the year as 48254773."}, {"owner": {"reputation": 6202, "user_id": 2494754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeXuj.png?s=128&g=1", "display_name": "NVRM", "link": "https://stackoverflow.com/users/2494754/nvrm"}, "reply_to_user": {"reputation": 10469, "user_id": 519360, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f90aeb577f276cbaee4db1b7bdf622a?s=128&d=identicon&r=PG", "display_name": "Adam Katz", "link": "https://stackoverflow.com/users/519360/adam-katz"}, "edited": false, "score": 0, "creation_date": 1522857217, "post_id": 49655319, "comment_id": 86319776, "body": "Ah thanks mate for precision."}], "tags": [], "owner": {"reputation": 6202, "user_id": 2494754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeXuj.png?s=128&g=1", "display_name": "NVRM", "link": "https://stackoverflow.com/users/2494754/nvrm"}, "is_accepted": false, "score": 0, "last_activity_date": 1550642426, "last_edit_date": 1550642426, "creation_date": 1522856797, "answer_id": 49655319, "question_id": 49655160, "link": "https://stackoverflow.com/questions/49655160/how-can-i-convert-epoch-time-in-microseconds-to-readable-format/49655319#49655319", "title": "How can I convert epoch time in microseconds to readable format", "body": "<p>In the shell:</p>\n\n<pre><code>date -d @1522711404881438\n</code></pre>\n\n<p>From javascript:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>console.log(new Date(1522711404881438).toLocaleString('fr-FR'))\r\nconsole.log(new Date(1522711404881438).toLocaleString('en-US'))</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"tags": [], "owner": {"reputation": 10469, "user_id": 519360, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f90aeb577f276cbaee4db1b7bdf622a?s=128&d=identicon&r=PG", "display_name": "Adam Katz", "link": "https://stackoverflow.com/users/519360/adam-katz"}, "is_accepted": false, "score": 2, "last_activity_date": 1522857021, "creation_date": 1522857021, "answer_id": 49655383, "question_id": 49655160, "link": "https://stackoverflow.com/questions/49655160/how-can-i-convert-epoch-time-in-microseconds-to-readable-format/49655383#49655383", "title": "How can I convert epoch time in microseconds to readable format", "body": "<p>I don't think you were looking for a bash answer, but you included that in your list of tags and it's pretty simple:</p>\n\n<pre><code>t=1522711404881438\ndate -d @${t%??????}\n</code></pre>\n\n<p>(Using BSD date, you want <code>date -jf %s {t%??????}</code>)</p>\n\n<p>Given this <code>$t</code> and <code>TZ=PST8PDT</code>, this results in</p>\n\n<blockquote>\n  <p>Mon Apr  2 16:23:24 PDT 2018</p>\n</blockquote>\n\n<p>To get the format you want, specify it to date:</p>\n\n<pre><code>t=1522711404881438\ndate -d @${t%??????}.${t:10} +\"%Y-%m-%d %T.%N\"\n</code></pre>\n\n<blockquote>\n  <p>2018-04-02 16:23:24.881438000</p>\n</blockquote>\n\n<p>(This requires GNU date)</p>\n"}], "owner": {"reputation": 2625, "user_id": 996371, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/1ee29a8958d7782b7a83b665e83976ee?s=128&d=identicon&r=PG", "display_name": "my_question", "link": "https://stackoverflow.com/users/996371/my-question"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 389, "favorite_count": 0, "closed_date": 1522858163, "answer_count": 2, "score": -3, "last_activity_date": 1550642426, "creation_date": 1522856331, "question_id": 49655160, "link": "https://stackoverflow.com/questions/49655160/how-can-i-convert-epoch-time-in-microseconds-to-readable-format", "closed_reason": "Needs more focus", "title": "How can I convert epoch time in microseconds to readable format", "body": "<p>I have integer like this, 1522711404881438, it is the epoch time in microseconds. How can I convert it to human readable format, something like, <code>2018-04-03 11:22:33.123456</code>. My local time is GMT-7:00 time zone.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["c", "qt-creator", "avr", "avrdude"], "comments": [{"owner": {"reputation": 8919, "user_id": 8873508, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2uDHi.png?s=128&g=1", "display_name": "p-a-o-l-o", "link": "https://stackoverflow.com/users/8873508/p-a-o-l-o"}, "edited": false, "score": 0, "creation_date": 1522856808, "post_id": 49655101, "comment_id": 86319493, "body": "<a href=\"https://github.com/eng-mg/CuteAVR\" rel=\"nofollow noreferrer\">github.com/eng-mg/CuteAVR</a>"}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1522860078, "post_id": 49655101, "comment_id": 86321441, "body": "Are you sure your chip does in fact have the Arduino bootloader installed on it? What&#39;s your actual avrdude command line?"}, {"owner": {"reputation": 2744, "user_id": 2610019, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5koUj.png?s=128&g=1", "display_name": "Mali", "link": "https://stackoverflow.com/users/2610019/mali"}, "edited": false, "score": 0, "creation_date": 1522922115, "post_id": 49655101, "comment_id": 86348675, "body": "Maybe have a look here : <a href=\"https://github.com/arduino/Arduino/pull/5427\" rel=\"nofollow noreferrer\">github.com/arduino/Arduino/pull/5427</a>"}], "owner": {"reputation": 11, "user_id": 9146544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2becbba1b91b876d0b71bf03ffd7820c?s=128&d=identicon&r=PG&f=1", "display_name": "Rufusy", "link": "https://stackoverflow.com/users/9146544/rufusy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 294, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1522870207, "creation_date": 1522856166, "last_edit_date": 1522870207, "question_id": 49655101, "link": "https://stackoverflow.com/questions/49655101/flashing-a-hex-file-into-avr-microcontroller", "title": "Flashing a hex file into AVR microcontroller", "body": "<p>I am using a QT creator to program for AVR (ATMEGA328P) to be specific. I have linked to the toolchain and included the libraries. I have specified my programmer as arduino in the .pro file. However, avrdude displays an error that programmer is not specified. I have tried flashing the hex code via my ubuntu terminal and it is working fine, however I cannot do the same via QT creator.\nKindly help me out.</p>\n\n<p>Below are the details in my .pro file</p>\n\n<p><strong><em>programmer as -c arduino\nbaudrate as 115200\nprocessor as ATMEGA328P\nport as /dev/ttyACM0</em></strong></p>\n\n<p>This is the error that I get:</p>\n\n<p>The image of the error that i get</p>\n\n<p><img src=\"https://i.stack.imgur.com/rqTfh.png\" alt=\"\"></p>\n"}, {"tags": ["c++", "c", "cmake", "fortran"], "answers": [{"comments": [{"owner": {"reputation": 5586, "user_id": 3309610, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4329755c47f01a17242610d2fac65859?s=128&d=identicon&r=PG", "display_name": "bremen_matt", "link": "https://stackoverflow.com/users/3309610/bremen-matt"}, "edited": false, "score": 0, "creation_date": 1522856964, "post_id": 49655275, "comment_id": 86319612, "body": "I could not find that &quot;CMAKE_FORTRAN_FLAGS&quot; when I was googling. Thanks for that. Also, it feels to me like that should be something like CMAKE_FLAGS which sets flags for all languages, but I cannot find it."}, {"owner": {"reputation": 13520, "user_id": 2315602, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/8rKPi.jpg?s=128&g=1", "display_name": "lisyarus", "link": "https://stackoverflow.com/users/2315602/lisyarus"}, "reply_to_user": {"reputation": 5586, "user_id": 3309610, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4329755c47f01a17242610d2fac65859?s=128&d=identicon&r=PG", "display_name": "bremen_matt", "link": "https://stackoverflow.com/users/3309610/bremen-matt"}, "edited": false, "score": 0, "creation_date": 1522857155, "post_id": 49655275, "comment_id": 86319734, "body": "@bremen_matt It is actually <code>CMAKE_Fortran_FLAGS</code>, I&#39;v finally found this in the docs: <a href=\"https://cmake.org/cmake/help/v3.11/envvar/FFLAGS.html?highlight=cmake_fortran_flags\" rel=\"nofollow noreferrer\">cmake.org/cmake/help/v3.11/envvar/&hellip;</a> . I don&#39;t think something like <code>CMAKE_FLAGS</code> exists: different languages usually need way different flags."}], "tags": [], "owner": {"reputation": 13520, "user_id": 2315602, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/8rKPi.jpg?s=128&g=1", "display_name": "lisyarus", "link": "https://stackoverflow.com/users/2315602/lisyarus"}, "is_accepted": true, "score": 1, "last_activity_date": 1522857246, "last_edit_date": 1522857246, "creation_date": 1522856645, "answer_id": 49655275, "question_id": 49654905, "link": "https://stackoverflow.com/questions/49654905/gcc-bprefix-in-cmake/49655275#49655275", "title": "GCC -Bprefix in Cmake", "body": "<p>You can set the corresponding <code>CMAKE_&lt;LANG&gt;_FLAGS</code> variables, like</p>\n\n<pre><code>set(PREFIX \"your prefix\")\n\nset(CMAKE_C_FLAGS       \"-B${PREFIX}\")\nset(CMAKE_CXX_FLAGS     \"-B${PREFIX}\")\nset(CMAKE_Fortran_FLAGS \"-B${PREFIX}\")\n</code></pre>\n\n<p>Or, if you wish to <em>append</em> this flag to existing flags, do</p>\n\n<pre><code>set(CMAKE_C_FLAGS       \"${CMAKE_C_FLAGS}       -B${PREFIX}\")\nset(CMAKE_CXX_FLAGS     \"${CMAKE_CXX_FLAGS}     -B${PREFIX}\")\nset(CMAKE_Fortran_FLAGS \"${CMAKE_Fortran_FLAGS} -B${PREFIX}\")\n</code></pre>\n\n<p>See the documentation for <a href=\"https://cmake.org/cmake/help/v3.11/envvar/CFLAGS.html\" rel=\"nofollow noreferrer\">CMAKE_C_FLAGS</a>, <a href=\"https://cmake.org/cmake/help/v3.11/envvar/CXXFLAGS.html\" rel=\"nofollow noreferrer\">CMAKE_CXX_FLAGS</a>, and <a href=\"https://cmake.org/cmake/help/v3.11/envvar/FFLAGS.html\" rel=\"nofollow noreferrer\">CMAKE_Fortran_FLAGS</a>.</p>\n\n<p>It seems to me that there should be more direct and CMake-ish ways of doing this, like, probably, setting the <code>CMAKE_PROGRAM_PATH</code> variable to <code>${PREFIX}</code> or something like that, but I am not sure.</p>\n"}], "owner": {"reputation": 5586, "user_id": 3309610, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4329755c47f01a17242610d2fac65859?s=128&d=identicon&r=PG", "display_name": "bremen_matt", "link": "https://stackoverflow.com/users/3309610/bremen-matt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "accepted_answer_id": 49655275, "answer_count": 1, "score": 0, "last_activity_date": 1522857246, "creation_date": 1522855579, "question_id": 49654905, "link": "https://stackoverflow.com/questions/49654905/gcc-bprefix-in-cmake", "title": "GCC -Bprefix in Cmake", "body": "<p>I need to use the '-B' prefix when compiling a project. I ran a test with a small hello world program, but I need to incorporate this into the CMakeLists file for a large project now. The project uses C, C++, and Fortran code. I need the same prefix for all languages. How should I specify that? </p>\n"}, {"tags": ["c", "struct"], "comments": [{"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 3, "creation_date": 1522854353, "post_id": 49654347, "comment_id": 86317650, "body": "you cannot initialize struct members in the declaration. That syntax (tho maybe useful) does not exist"}], "answers": [{"tags": [], "owner": {"reputation": 1119, "user_id": 5046042, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lo5M0.jpg?s=128&g=1", "display_name": "galfisher", "link": "https://stackoverflow.com/users/5046042/galfisher"}, "is_accepted": true, "score": 3, "last_activity_date": 1522854499, "creation_date": 1522854499, "answer_id": 49654513, "question_id": 49654347, "link": "https://stackoverflow.com/questions/49654347/error-expected-or-attribute-before-token/49654513#49654513", "title": "error: expected \u2018:\u2019, \u2018,\u2019, \u2018;\u2019, \u2018}\u2019 or \u2018__attribute__\u2019 before \u2018=\u2019 token", "body": "<p>The problem is in</p>\n\n<pre><code>struct page\n{\n    int index = -1;\n    int frame = -1;\n    int dirty = 0; //0 is clean, 1 is dirty\n    int valid = 0; //0 is not, 1 is valid\n    int referenced = 0; //0 is not, 1 is referenced\n};\n</code></pre>\n\n<p>You define a new type <code>struct page</code> and try to initialize it at the same declaration. Types don't have default values. The right way to do it is to define the new type <code>struct page</code> without initial values, and then initiate a new <code>struct page</code> variable with those values.</p>\n"}], "owner": {"reputation": 13, "user_id": 9597475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4c84dfe8219bb578d1431e5dfab5751?s=128&d=identicon&r=PG&f=1", "display_name": "kyhart", "link": "https://stackoverflow.com/users/9597475/kyhart"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 472, "favorite_count": 0, "closed_date": 1522855276, "accepted_answer_id": 49654513, "answer_count": 1, "score": 1, "last_activity_date": 1522855330, "creation_date": 1522854056, "last_edit_date": 1522855330, "question_id": 49654347, "link": "https://stackoverflow.com/questions/49654347/error-expected-or-attribute-before-token", "closed_reason": "Duplicate", "title": "error: expected \u2018:\u2019, \u2018,\u2019, \u2018;\u2019, \u2018}\u2019 or \u2018__attribute__\u2019 before \u2018=\u2019 token", "body": "<p>Why this error is popping up (for int index = -1). Here's the segment of code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;limits.h&gt;\n\n#define Offset 12\n\nint num_frames;\n\nstruct node\n    {\n        struct node* next;\n        long data;\n    };\n\nstruct page\n{\n    int index = -1;\n    int frame = -1;\n    int dirty = 0; //0 is clean, 1 is dirty\n    int valid = 0; //0 is not, 1 is valid\n    int referenced = 0; //0 is not, 1 is referenced\n};\n</code></pre>\n\n<p>Any insight would be appreciated!</p>\n"}, {"tags": ["c", "exception", "opengl"], "comments": [{"owner": {"reputation": 38487, "user_id": 2327517, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0Bulc.jpg?s=128&g=1", "display_name": "derhass", "link": "https://stackoverflow.com/users/2327517/derhass"}, "edited": false, "score": 0, "creation_date": 1522853397, "post_id": 49653978, "comment_id": 86316926, "body": "So, what exception do you get, and at which point in your code?"}, {"owner": {"reputation": 1389, "user_id": 8423261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd03cb068df0f15a5de2a53ed8149eea?s=128&d=identicon&r=PG&f=1", "display_name": "Ruks", "link": "https://stackoverflow.com/users/8423261/ruks"}, "reply_to_user": {"reputation": 38487, "user_id": 2327517, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0Bulc.jpg?s=128&g=1", "display_name": "derhass", "link": "https://stackoverflow.com/users/2327517/derhass"}, "edited": false, "score": 0, "creation_date": 1522853630, "post_id": 49653978, "comment_id": 86317092, "body": "&#39;Exception thrown at 0x010F59C7 in spritetest.exe: 0xC0000005: Access violation reading location 0xFFFFFFFF&#39; is said by the compiler instanly after I run it, pointing over here:- <a href=\"https://github.com/recp/cglm/blob/master/include/cglm/vec4.h#L169\" rel=\"nofollow noreferrer\">github.com/recp/cglm/blob/master/include/cglm/vec4.h#L169</a>"}, {"owner": {"reputation": 38487, "user_id": 2327517, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0Bulc.jpg?s=128&g=1", "display_name": "derhass", "link": "https://stackoverflow.com/users/2327517/derhass"}, "edited": false, "score": 0, "creation_date": 1522853727, "post_id": 49653978, "comment_id": 86317150, "body": "By the compiler? certainly not. But really, use a debugger and lock at the stack trace"}, {"owner": {"reputation": 1389, "user_id": 8423261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd03cb068df0f15a5de2a53ed8149eea?s=128&d=identicon&r=PG&f=1", "display_name": "Ruks", "link": "https://stackoverflow.com/users/8423261/ruks"}, "reply_to_user": {"reputation": 38487, "user_id": 2327517, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0Bulc.jpg?s=128&g=1", "display_name": "derhass", "link": "https://stackoverflow.com/users/2327517/derhass"}, "edited": false, "score": 0, "creation_date": 1522853859, "post_id": 49653978, "comment_id": 86317255, "body": "@derhass I just added the link to the line which causes the exception."}, {"owner": {"reputation": 38487, "user_id": 2327517, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0Bulc.jpg?s=128&g=1", "display_name": "derhass", "link": "https://stackoverflow.com/users/2327517/derhass"}, "edited": false, "score": 0, "creation_date": 1522854096, "post_id": 49653978, "comment_id": 86317455, "body": "Why would the <code>glUniform...</code> call end up in a cglm vector addition? That doesn&#39;t make sense."}], "answers": [{"comments": [{"owner": {"reputation": 1389, "user_id": 8423261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd03cb068df0f15a5de2a53ed8149eea?s=128&d=identicon&r=PG&f=1", "display_name": "Ruks", "link": "https://stackoverflow.com/users/8423261/ruks"}, "edited": false, "score": 0, "creation_date": 1522854302, "post_id": 49654305, "comment_id": 86317618, "body": "But why is it still crashing?"}, {"owner": {"reputation": 2354, "user_id": 9428851, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-MBhDff_bdY0/AAAAAAAAAAI/AAAAAAAACAY/lx7DUTjS350/photo.jpg?sz=128", "display_name": "Victor Gubin", "link": "https://stackoverflow.com/users/9428851/victor-gubin"}, "reply_to_user": {"reputation": 1389, "user_id": 8423261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd03cb068df0f15a5de2a53ed8149eea?s=128&d=identicon&r=PG&f=1", "display_name": "Ruks", "link": "https://stackoverflow.com/users/8423261/ruks"}, "edited": false, "score": 0, "creation_date": 1522854416, "post_id": 49654305, "comment_id": 86317694, "body": "Which source line ?"}, {"owner": {"reputation": 1389, "user_id": 8423261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd03cb068df0f15a5de2a53ed8149eea?s=128&d=identicon&r=PG&f=1", "display_name": "Ruks", "link": "https://stackoverflow.com/users/8423261/ruks"}, "edited": false, "score": 0, "creation_date": 1522854603, "post_id": 49654305, "comment_id": 86317819, "body": "This one right here <code>model = glm::translate(model, glm::vec3(-0.5f * scale.x, -0.5f * scale.y, 0.0f));</code>"}, {"owner": {"reputation": 2354, "user_id": 9428851, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-MBhDff_bdY0/AAAAAAAAAAI/AAAAAAAACAY/lx7DUTjS350/photo.jpg?sz=128", "display_name": "Victor Gubin", "link": "https://stackoverflow.com/users/9428851/victor-gubin"}, "reply_to_user": {"reputation": 1389, "user_id": 8423261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd03cb068df0f15a5de2a53ed8149eea?s=128&d=identicon&r=PG&f=1", "display_name": "Ruks", "link": "https://stackoverflow.com/users/8423261/ruks"}, "edited": false, "score": 0, "creation_date": 1522854809, "post_id": 49654305, "comment_id": 86318000, "body": "@Ruks I suppose you have a problem in the <code>C</code> code don&#39;t you ? glm_scale(model, (vec3){ scale[0] * width, scale[1] * height, 1.0f });"}, {"owner": {"reputation": 2354, "user_id": 9428851, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-MBhDff_bdY0/AAAAAAAAAAI/AAAAAAAACAY/lx7DUTjS350/photo.jpg?sz=128", "display_name": "Victor Gubin", "link": "https://stackoverflow.com/users/9428851/victor-gubin"}, "reply_to_user": {"reputation": 1389, "user_id": 8423261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd03cb068df0f15a5de2a53ed8149eea?s=128&d=identicon&r=PG&f=1", "display_name": "Ruks", "link": "https://stackoverflow.com/users/8423261/ruks"}, "edited": false, "score": 0, "creation_date": 1522854901, "post_id": 49654305, "comment_id": 86318069, "body": "The same things for vectors, i.e. vec3 init = GLM_VEC3_ZERO; etc."}, {"owner": {"reputation": 2354, "user_id": 9428851, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-MBhDff_bdY0/AAAAAAAAAAI/AAAAAAAACAY/lx7DUTjS350/photo.jpg?sz=128", "display_name": "Victor Gubin", "link": "https://stackoverflow.com/users/9428851/victor-gubin"}, "reply_to_user": {"reputation": 1389, "user_id": 8423261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd03cb068df0f15a5de2a53ed8149eea?s=128&d=identicon&r=PG&f=1", "display_name": "Ruks", "link": "https://stackoverflow.com/users/8423261/ruks"}, "edited": false, "score": 2, "creation_date": 1522855165, "post_id": 49654305, "comment_id": 86318269, "body": "&#39;C&#39; don&#39;t have any exceptions at all. Exceptions is a C++ feature. It it crashes - glm code, written using assembly to accelerate performance bring to undefined behavior, since data is not properly initialized (aligned). <code>C</code> is not a C++ is much closer to assembly, so try to avoid tricks like (vec3) { .... }, this is not a constructor call with std::initialized_list unlike the same in <code>C++</code>."}, {"owner": {"reputation": 1389, "user_id": 8423261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd03cb068df0f15a5de2a53ed8149eea?s=128&d=identicon&r=PG&f=1", "display_name": "Ruks", "link": "https://stackoverflow.com/users/8423261/ruks"}, "edited": false, "score": 0, "creation_date": 1522855365, "post_id": 49654305, "comment_id": 86318395, "body": "It is with the rotation, not the scale."}, {"owner": {"reputation": 2354, "user_id": 9428851, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-MBhDff_bdY0/AAAAAAAAAAI/AAAAAAAACAY/lx7DUTjS350/photo.jpg?sz=128", "display_name": "Victor Gubin", "link": "https://stackoverflow.com/users/9428851/victor-gubin"}, "reply_to_user": {"reputation": 1389, "user_id": 8423261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd03cb068df0f15a5de2a53ed8149eea?s=128&d=identicon&r=PG&f=1", "display_name": "Ruks", "link": "https://stackoverflow.com/users/8423261/ruks"}, "edited": false, "score": 1, "creation_date": 1522856089, "post_id": 49654305, "comment_id": 86318944, "body": "It dosn&#39;t really meter,  assembly code expecting aligned memory. <code>(vec3){ 0.0f, 0.0f, 1.0f }</code> this is an stack object array, and compiler crossing the aliment. Assembly function expecting memory address  on array with the exact alignment. Simply don&#39;t pass the formal parameter arrays, use variables."}], "tags": [], "owner": {"reputation": 2354, "user_id": 9428851, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-MBhDff_bdY0/AAAAAAAAAAI/AAAAAAAACAY/lx7DUTjS350/photo.jpg?sz=128", "display_name": "Victor Gubin", "link": "https://stackoverflow.com/users/9428851/victor-gubin"}, "is_accepted": true, "score": 4, "last_activity_date": 1522853933, "creation_date": 1522853933, "answer_id": 49654305, "question_id": 49653978, "link": "https://stackoverflow.com/questions/49653978/how-to-properly-initialize-a-model-matrix-in-c/49654305#49654305", "title": "How to properly initialize a model matrix in C?", "body": "<p>See <a href=\"http://cglm.readthedocs.io/en/latest/mat4.html#c.glm_mat4_identity\" rel=\"nofollow noreferrer\">CGLM documentation</a></p>\n\n<p>According to the <a href=\"http://cglm.readthedocs.io/en/latest/getting_started.html\" rel=\"nofollow noreferrer\">getting started</a></p>\n\n<blockquote>\n  <p>Aligment is Required: vec4 and mat4 requires 16 byte aligment because\n  vec4 and mat4 operations are vectorized by SIMD instructions\n  (SSE/AVX).</p>\n</blockquote>\n\n<p>So you need to initialize identity matrix like:</p>\n\n<pre><code>mat4 model;\nglm_mat4_identity(model);\n....\nmat4 projection;\nglm_mat4_identity(projection);\nglm_ortho(0.0f, (GLfloat)(WIDTH), (GLfloat)(HEIGHT), 0.0f, -1.0f, 1.0f, projection);\n</code></pre>\n"}], "owner": {"reputation": 1389, "user_id": 8423261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd03cb068df0f15a5de2a53ed8149eea?s=128&d=identicon&r=PG&f=1", "display_name": "Ruks", "link": "https://stackoverflow.com/users/8423261/ruks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 792, "favorite_count": 0, "accepted_answer_id": 49654305, "answer_count": 1, "score": 1, "last_activity_date": 1523354755, "creation_date": 1522852954, "last_edit_date": 1523354755, "question_id": 49653978, "link": "https://stackoverflow.com/questions/49653978/how-to-properly-initialize-a-model-matrix-in-c", "title": "How to properly initialize a model matrix in C?", "body": "<p>I tried to convert the code of the question I asked over <a href=\"https://stackoverflow.com/questions/49651388/why-is-the-sprite-not-rendering-in-opengl\">here</a>.</p>\n\n<p>But when I try to run it, I run into an exception and it points to the mat4(which is an 2-d array of 4x4 floats) header of <a href=\"https://github.com/recp/cglm\" rel=\"nofollow noreferrer\">this</a>(CGLM, which is use for OpenGL math in C as GLM is C++ only library) library.</p>\n\n<p>The C++ code works fine and runs perfectly but why does it crash in C.</p>\n\n<p>Here is the C snippet of the code where 'CGLM' is used(this is the code that crashes):-</p>\n\n<pre><code>glUseProgram(shaderProgram);\nmat4 model =\n{\n    { 1.0f, 0.0f, 0.0f, 0.0f },\n    { 0.0f, 1.0f, 0.0f, 0.0f },\n    { 0.0f, 0.0f, 1.0f, 0.0f },\n    { 0.0f, 0.0f, 0.0f, 1.0f },\n};\nmat4 projection;\nglm_ortho(0.0f, (GLfloat)(WIDTH), (GLfloat)(HEIGHT), 0.0f, -1.0f, 1.0f, projection);\n\nvect2 scale = { 2.0f, 2.0f };\nvect2 position = { 50.0f, 0.0f };\nvec4 color = { 1.0f, 1.0f, 1.0f, 0.5f };\nGLfloat rotation = 0.0f;\n\nglm_translate(model, (vec3){ position[0], position[1], 0.0f });\n\nglm_translate(model, (vec3){ 0.5f * scale[0], 0.5f * scale[1], 0.0f });\nglm_rotate(model, rotation, (vec3){ 0.0f, 0.0f, 1.0f }); // Why is this function crashing?\nglm_translate(model, (vec3){ -0.5f * scale[0], -0.5f * scale[1], 0.0f });\n\nglm_scale(model, (vec3){ scale[0] * width, scale[1] * height, 1.0f });\n\nglUniformMatrix4fv(glGetUniformLocation(shaderProgram, \"projection\"), 1, GL_FALSE, (GLfloat *)projection);\nglUniformMatrix4fv(glGetUniformLocation(shaderProgram, \"model\"), 1, GL_FALSE, (GLfloat *)model);\nglUniform4f(glGetUniformLocation(shaderProgram, \"spriteColor\"), color[0], color[1], color[2], color[3]);\n</code></pre>\n\n<p>Here is the C++ snippet of the code where GLM is used:-</p>\n\n<pre><code>glUseProgram(shaderProgram);\nglm::mat4 model(1.0f);\nglm::mat4 projection = glm::ortho(0.0f, static_cast&lt;GLfloat&gt;(WIDTH), static_cast&lt;GLfloat&gt;(HEIGHT), 0.0f, -1.0f, 1.0f);\n\nglm::vec2 scale = glm::vec2(2.0f, 2.0f);\nglm::vec2 position = glm::vec2(50.0f, 0.0f);\nglm::vec4 color = glm::vec4(1.0f, 1.0f, 1.0f, 0.5f);\nGLfloat rotation = 0.0f;\n\nmodel = glm::translate(model, glm::vec3(position, 0.0f));\n\nmodel = glm::translate(model, glm::vec3(0.5f * scale.x, 0.5f * scale.y, 0.0f));\nmodel = glm::rotate(model, rotation, glm::vec3(0.0f, 0.0f, 1.0f));\nmodel = glm::translate(model, glm::vec3(-0.5f * scale.x, -0.5f * scale.y, 0.0f));\n\nmodel = glm::scale(model, glm::vec3(scale * glm::vec2(width, height), 1.0f));\n\nglUniformMatrix4fv(glGetUniformLocation(shaderProgram, \"projection\"), 1, GL_FALSE, glm::value_ptr(projection));\nglUniformMatrix4fv(glGetUniformLocation(shaderProgram, \"model\"), 1, GL_FALSE, glm::value_ptr(model));\nglUniform4f(glGetUniformLocation(shaderProgram, \"spriteColor\"), color.x, color.y, color.z, color.w);\n</code></pre>\n"}, {"tags": ["c", "unit-testing", "googletest", "gmock"], "comments": [{"owner": {"reputation": 12749, "user_id": 7976805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92a559df8b4b287aad23724b4c66d67c?s=128&d=identicon&r=PG&f=1", "display_name": "Yksisarvinen", "link": "https://stackoverflow.com/users/7976805/yksisarvinen"}, "edited": false, "score": 0, "creation_date": 1523100002, "post_id": 49653734, "comment_id": 86426801, "body": "Not sure if I understand your question. It seems that your problem is about double definition of <code>open()</code> function. I suppose you don&#39;t <code>#include &lt;fcntl.h&gt;</code> in your test function, otherwise it shouldn&#39;t compile. What happens here is: when you call your function manually in test, your own implementation is called. But your production code has no idea about existance of your own implementation and always uses <code>&lt;fcntl.h&gt;</code> for it&#39;s purposes.   What you should do: change your production code to inject mock into it (wrapper design pattern may come in useful)."}, {"owner": {"reputation": 12749, "user_id": 7976805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92a559df8b4b287aad23724b4c66d67c?s=128&d=identicon&r=PG&f=1", "display_name": "Yksisarvinen", "link": "https://stackoverflow.com/users/7976805/yksisarvinen"}, "edited": false, "score": 1, "creation_date": 1523100226, "post_id": 49653734, "comment_id": 86426851, "body": "You can wrap all calls to functions from <code>fctnl.h</code>in an abstract class, and make two children of it: implementation, which calls real <code>fcntl.h</code> functions, and mock, which is just a GMock class."}, {"owner": {"reputation": 166, "user_id": 3045049, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-GlzEGF4N6Uo/AAAAAAAAAAI/AAAAAAAAABM/5udFY6WUjdE/photo.jpg?sz=128", "display_name": "Volker Weber", "link": "https://stackoverflow.com/users/3045049/volker-weber"}, "reply_to_user": {"reputation": 12749, "user_id": 7976805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92a559df8b4b287aad23724b4c66d67c?s=128&d=identicon&r=PG&f=1", "display_name": "Yksisarvinen", "link": "https://stackoverflow.com/users/7976805/yksisarvinen"}, "edited": false, "score": 0, "creation_date": 1523252610, "post_id": 49653734, "comment_id": 86466176, "body": "@Yksisarvinen thanks for your input. Indeed your second answer matches the solution for my problem, that&#39;s what I was also thinking about."}], "owner": {"reputation": 166, "user_id": 3045049, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-GlzEGF4N6Uo/AAAAAAAAAAI/AAAAAAAAABM/5udFY6WUjdE/photo.jpg?sz=128", "display_name": "Volker Weber", "link": "https://stackoverflow.com/users/3045049/volker-weber"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 513, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1594067586, "creation_date": 1522852299, "last_edit_date": 1522924687, "question_id": 49653734, "link": "https://stackoverflow.com/questions/49653734/gmock-c-framework-functions", "title": "GMock C Framework Functions", "body": "<p>At the moment I am a little bit stucked with the following problem, as I currently do not know on which way to solve it. The aim is to mock some c functions which come along with <strong>fcntl.h</strong>, like open a file. As a result, I build up a GMock structure that looks like this:</p>\n\n<p>Mock Class:</p>\n\n<pre><code>class FileHandlingLib_MOCK\n{\npublic:\n    virtual ~FileHandlingLib_MOCK() {}\n\n    //mock\n    MOCK_METHOD2(open, int(const char* t1, int i1));\n};\n</code></pre>\n\n<p>A Fixture:</p>\n\n<pre><code>class TestFixture : public ::testing::Test\n{\n    ...\n}\n</code></pre>\n\n<p>Mocked open function:</p>\n\n<pre><code>int open(const char* t1, int i1)\n{\n    return TestFixture::_fileHandlingMock-&gt;open(t1, i1);\n}   \n</code></pre>\n\n<p>If I do something like this, it works flawless:</p>\n\n<pre><code>TEST_F(FileHandlingUnitTesting, openMatch)\n{\n    EXPECT_CALL(*_fileHandlingMock, open(\"path_to_file\", ::testing::Matcher&lt;int&gt;(1))).WillRepeatedly(::testing::Return(int(12)));\n\n    int a = open(\"path_to_file\", 1);\n}\n</code></pre>\n\n<p>However, if the open function is nested into another function (where the fcntl.h is included, the code itself), the mock will never be called. Does that mean that the expected call \"scope\" is limited to the TEST_F itself?</p>\n"}, {"tags": ["c", "assembly"], "comments": [{"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 3, "creation_date": 1522852844, "post_id": 49653728, "comment_id": 86316484, "body": "<code>%rbp</code> is pointing to the previous stack frame, you are overwriting addresses you don&#39;t know. You should probably add <code>movq %rsp, %rbp</code>."}, {"owner": {"reputation": 21, "user_id": 9597257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c04c623466b5eebd644c6a988c92b2d6?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Adams", "link": "https://stackoverflow.com/users/9597257/steve-adams"}, "edited": false, "score": 0, "creation_date": 1522860215, "post_id": 49653728, "comment_id": 86321531, "body": "Since I am an asembly novice, I took a code snippet and altered it. The code snippit only included this."}], "answers": [{"tags": [], "owner": {"reputation": 872, "user_id": 8077259, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/E1wSe.jpg?s=128&g=1", "display_name": "caylee", "link": "https://stackoverflow.com/users/8077259/caylee"}, "is_accepted": false, "score": 4, "last_activity_date": 1522853273, "last_edit_date": 1522853273, "creation_date": 1522852429, "answer_id": 49653783, "question_id": 49653728, "link": "https://stackoverflow.com/questions/49653728/segmentation-fault-sigsev-in-assembly-code/49653783#49653783", "title": "Segmentation Fault/ SIGSEV in assembly code", "body": "<p>I'm not quite sure what your assembly code is actually <em>doing</em>, but it misses an <code>ret</code> statement (and needs to restore the stack). There is no \"implicit return\" in assembly as known from C code. Also, it looks like the setup of the stack frame has not finished.</p>\n\n<p>So you will need to add some code lines as this at the top and bottom of your assembly function (you can also compare to compiled, but not assembled or disassembled C functions, which have a similar structure as hand-written):</p>\n\n<pre><code>push %rbp\nmov %rsp, %rbp\n\n...\n\nmov %rbp, %rsp\npop %rbp\nret\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 9597257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c04c623466b5eebd644c6a988c92b2d6?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Adams", "link": "https://stackoverflow.com/users/9597257/steve-adams"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1522853273, "creation_date": 1522852278, "question_id": 49653728, "link": "https://stackoverflow.com/questions/49653728/segmentation-fault-sigsev-in-assembly-code", "title": "Segmentation Fault/ SIGSEV in assembly code", "body": "<p>I am working on a project that calls an assembly function from c code. When running the code I made I am getting segmentation faults and I am not sure why.</p>\n\n<p>file.c:</p>\n\n<pre><code>#include &lt;stdio.h&gt; \n#include &lt;time.h&gt;\n#include &lt;unistd.h&gt;\n\n\nextern void asmFunction();\n\nvoid callAsmFunction(){\n  while(1){\n    asmFunction();\n}\n\nreturn;\n}\n\n\nint main(int argc, char* argv[]){\n  callAsmFunction();\n}\n</code></pre>\n\n<p>asmFunction.s:</p>\n\n<pre><code>.global asmFunction\nasmFunction:\n    push %rbp\n    movl $0x1,-0x8(%rbp)\n    cmpl $0x0,-0x8(%rbp)\n    jne .L2\n    nop\n    nop\n    nop\n.L2:\n    cmpl $0x0,-0x8(%rbp)\n    jne .L3\n    nop\n    nop\n    nop\n.L3:\n    cmpl $0x0,-0x8(%rbp)\n</code></pre>\n\n<p>I compiled my code the following way: gcc -o file file.c asmFunction.s. </p>\n\n<p>I debugged my code and saw that I would get a SIGSEV signal occurring after the last line \"cmpl $0x0,-0x8(%rbp)\". I do not understand why though. Is it how I am compiling my code?</p>\n"}, {"tags": ["c", "types"], "comments": [{"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 1, "creation_date": 1522851946, "post_id": 49653592, "comment_id": 86315712, "body": "it&#39;s platform dependent. Use <code>stdint.h</code> and <code>uint64_t</code> (note that <code>uint32_t</code> is enough for such ranges)"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1522852122, "post_id": 49653592, "comment_id": 86315843, "body": "1e10 is outside 32 bit range, yes."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 1, "creation_date": 1522852179, "post_id": 49653592, "comment_id": 86315895, "body": "@Jean-Fran&#231;oisFabre: But you&#39;re correct here of course. I&#39;ll stop trolling your comments ;-)"}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1522852246, "post_id": 49653592, "comment_id": 86315953, "body": "No, don&#39;t use <code>uint64_t</code> unless you need a type with 64 bits <i>and no more</i>.  <code>uint_least64_t</code> is more portable (at least theoretically)."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1522854791, "post_id": 49653592, "comment_id": 86317985, "body": "What does \u201ceach integer\u201d mean? Each integer your program will read and store in an object? Or will your program do various arithmetic on the values, so that, although the input values are limited to 10^9, more bits are needed to accommodate the arithmetic that will be performed on them?"}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1522857049, "post_id": 49653592, "comment_id": 86319656, "body": "@Jean-Fran&#231;oisFabre: It&#39;s not platform-dependent. The C language defines minimum acceptable ranges for each type, and even plain <code>long</code> is sufficient for OP&#39;s needs."}], "answers": [{"comments": [{"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1522998619, "post_id": 49653611, "comment_id": 86385684, "body": "and even <code>signed long</code> is capable of storing a number over <code>1e9</code>."}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 5, "last_activity_date": 1522852587, "last_edit_date": 1522852587, "creation_date": 1522851970, "answer_id": 49653611, "question_id": 49653592, "link": "https://stackoverflow.com/questions/49653592/type-unsigned-long-long-int-is-it-enough-for-1-109-range/49653611#49653611", "title": "type unsigned long long int is it enough for 1 - 10^9 range?", "body": "<p>Yes it is (assuming that you are adopting the notation <code>10^9</code> to mean <code>1e9</code> - <code>^</code> is the XOR operator in C, and <code>10^9</code> is <code>3</code>).</p>\n\n<p>An <code>unsigned long long</code> has to be capable of storing a number between 0 and 2<sup>64</sup> - 1. Your maximum is much smaller than this.</p>\n\n<p>Note also that an <code>unsigned long</code> has to be capable of storing a number between 0 and 2<sup>32</sup> - 1. Your maximum is also smaller than this.</p>\n"}, {"comments": [{"owner": {"reputation": 1746, "user_id": 1012586, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdb64d89a4b59bd145b3c10392ece1b7?s=128&d=identicon&r=PG", "display_name": "Morty", "link": "https://stackoverflow.com/users/1012586/morty"}, "edited": false, "score": 0, "creation_date": 1522852347, "post_id": 49653670, "comment_id": 86316044, "body": "As the page says: That applies to C99. Before that the rules were something something like 16 bit &lt;= int &lt;= long &lt;= long long But it&#39;s always best to use the uintXX_t types from stdint.h"}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1522998725, "post_id": 49653670, "comment_id": 86385740, "body": "I&#39;m not sure, but correct me if I&#39;m wrong.  In pre C99, the type <code>long long</code> did actually exist? or was it only a <code>gcc</code> extension?"}], "tags": [], "owner": {"reputation": 11, "user_id": 8861253, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bELkj.png?s=128&g=1", "display_name": "BJTH", "link": "https://stackoverflow.com/users/8861253/bjth"}, "is_accepted": false, "score": 1, "last_activity_date": 1522852119, "creation_date": 1522852119, "answer_id": 49653670, "question_id": 49653592, "link": "https://stackoverflow.com/questions/49653592/type-unsigned-long-long-int-is-it-enough-for-1-109-range/49653670#49653670", "title": "type unsigned long long int is it enough for 1 - 10^9 range?", "body": "<p>Long long\u00a0unsigned integer type. Contains\u00a0at least\u00a0the [0, +18,446,744,073,709,551,615] range;\nSpecified since the\u00a0C99\u00a0version of the standard.</p>\n\n<p>source: <a href=\"https://en.m.wikipedia.org/wiki/C_data_types\" rel=\"nofollow noreferrer\">https://en.m.wikipedia.org/wiki/C_data_types</a></p>\n"}, {"comments": [{"owner": {"reputation": 156300, "user_id": 1782465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b45d92faaf9d122bfed585490e0bafc5?s=128&d=identicon&r=PG", "display_name": "Angew is no longer proud of SO", "link": "https://stackoverflow.com/users/1782465/angew-is-no-longer-proud-of-so"}, "edited": false, "score": 2, "creation_date": 1522852370, "post_id": 49653735, "comment_id": 86316070, "body": "10^10 is more than 2^32, though."}], "tags": [], "owner": {"reputation": 9690, "user_id": 1707560, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/8VK4M.jpg?s=128&g=1", "display_name": "imreal", "link": "https://stackoverflow.com/users/1707560/imreal"}, "is_accepted": false, "score": 0, "last_activity_date": 1522854335, "last_edit_date": 1522854335, "creation_date": 1522852300, "answer_id": 49653735, "question_id": 49653592, "link": "https://stackoverflow.com/questions/49653592/type-unsigned-long-long-int-is-it-enough-for-1-109-range/49653735#49653735", "title": "type unsigned long long int is it enough for 1 - 10^9 range?", "body": "<p>The answer is yes, but you don't need <code>unsigned long long</code>, <code>unsigned long</code> would be enough.</p>\n\n<p>A 32 bit number can represent over 4 * 10^9. Up to 4 294 967 296.</p>\n"}, {"comments": [{"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 1, "creation_date": 1522852382, "post_id": 49653757, "comment_id": 86316080, "body": "Prefer <code>uint_least32_t</code> (or <code>uint_fast32_t</code>) for portable code."}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1522857124, "post_id": 49653757, "comment_id": 86319710, "body": "<code>uint_fast32_t</code> is a bad idea. It&#39;s misdefined on many real implementations including glibc/x86_64 in ways that both waste memory and hurt performance. Use <code>uint_least32_t</code> or just <code>unsigned long</code> or even <code>long</code>."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1522857356, "post_id": 49653757, "comment_id": 86319865, "body": "you&#39;re right, <code>long</code> is simple and 32 bit at least. Why bother with normalized types?"}], "tags": [], "owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "is_accepted": true, "score": 5, "last_activity_date": 1522857304, "last_edit_date": 1522857304, "creation_date": 1522852345, "answer_id": 49653757, "question_id": 49653592, "link": "https://stackoverflow.com/questions/49653592/type-unsigned-long-long-int-is-it-enough-for-1-109-range/49653757#49653757", "title": "type unsigned long long int is it enough for 1 - 10^9 range?", "body": "<p>10^9 is way smaller than 2^32</p>\n\n<p>So in your case, no need to use <code>unsigned long long</code> (it fits, yes), which is overkill and can lead to slower operation.</p>\n\n<p>Use the proper type, normalized in <code>stdint.h</code> include: <code>uint32_t</code> or <code>uint_least32_t</code> (<a href=\"https://stackoverflow.com/questions/19779537/uint32-t-vs-uint-fast32-t-vs-uint-least32-t\">uint32_t vs uint_fast32_t vs uint_least32_t</a>)</p>\n\n<p><code>long</code> is also guaranteed to be <a href=\"https://en.wikipedia.org/wiki/C_data_types\" rel=\"nofollow noreferrer\">at least 32 bits</a>, so it's a good &amp; simple choice as well.</p>\n"}], "owner": {"reputation": 183, "user_id": 8154570, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2Jruf.png?s=128&g=1", "display_name": "Melinsuna", "link": "https://stackoverflow.com/users/8154570/melinsuna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 509, "favorite_count": 0, "accepted_answer_id": 49653757, "answer_count": 4, "score": 3, "last_activity_date": 1547548668, "creation_date": 1522851895, "last_edit_date": 1547548668, "question_id": 49653592, "link": "https://stackoverflow.com/questions/49653592/type-unsigned-long-long-int-is-it-enough-for-1-109-range", "title": "type unsigned long long int is it enough for 1 - 10^9 range?", "body": "<p><strong>Consigne</strong>: each integer is in the inclusive range 1 - 10<sup>9</sup>.</p>\n\n<p>I use variable with the type <code>unsigned long long int</code></p>\n\n<p>Is it enough for the stated range?</p>\n"}, {"tags": ["c++", "c", "encryption", "openssl", "rsa"], "answers": [{"tags": [], "owner": {"reputation": 5562, "user_id": 1946679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed74e2cdc59d058b76a76c90dd3c3bdc?s=128&d=identicon&r=PG", "display_name": "Matt Caswell", "link": "https://stackoverflow.com/users/1946679/matt-caswell"}, "is_accepted": true, "score": 5, "last_activity_date": 1522866502, "creation_date": 1522866502, "answer_id": 49657981, "question_id": 49653346, "link": "https://stackoverflow.com/questions/49653346/how-to-do-rsa-public-key-encryption-using-openssl-evp-routines/49657981#49657981", "title": "How to do RSA public key encryption using OpenSSL EVP routines?", "body": "<p>To do asymmetric encryption you need to use different EVP routines than for symmetric crypto. In particular see the EVP_PKEY_encrypt() function. The man page is here, and it contains an example.</p>\n\n<p><a href=\"https://www.openssl.org/docs/man1.1.0/crypto/EVP_PKEY_encrypt.html\" rel=\"noreferrer\">https://www.openssl.org/docs/man1.1.0/crypto/EVP_PKEY_encrypt.html</a></p>\n"}], "owner": {"reputation": 21118, "user_id": 157971, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/8cbf41a630b52f45e9b54e0ee1445f76?s=128&d=identicon&r=PG", "display_name": "void.pointer", "link": "https://stackoverflow.com/users/157971/void-pointer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2939, "favorite_count": 0, "accepted_answer_id": 49657981, "answer_count": 1, "score": 2, "last_activity_date": 1522866502, "creation_date": 1522851223, "question_id": 49653346, "link": "https://stackoverflow.com/questions/49653346/how-to-do-rsa-public-key-encryption-using-openssl-evp-routines", "title": "How to do RSA public key encryption using OpenSSL EVP routines?", "body": "<p>I am using the <a href=\"https://www.openssl.org/docs/man1.1.0/crypto/EVP_EncryptInit.html\" rel=\"nofollow noreferrer\">EVP high-level functions in OpenSSL</a>. I haven't found any examples online showing how to use these functions (e.g. <code>EVP_EncryptInit_ex()</code>, <code>EVP_EncryptUpdate()</code>, <code>EVP_EncryptFinal_ex()</code>) to encrypt data using an RSA public key. Specifically, I do not see a <code>EVP_CIPHER</code> type that matches RSA, similar to what you see for AES like: <code>const EVP_CIPHER *EVP_aes_128_cbc(void);</code> in <code>evp.h</code>. I think one for RSA is required to initialize EVP for encryption using that method.</p>\n\n<p>Can anyone help me understand how to use an RSA existing key to encrypt data using OpenSSL's EVP routines? Examples would be <em>extremely</em> helpful.</p>\n"}, {"tags": ["c", "linux", "system-calls", "glibc", "stdio"], "comments": [{"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1522850460, "post_id": 49652943, "comment_id": 86314501, "body": "Does <i><a href=\"https://stackoverflow.com/questions/6906238/where-is-stdin-defined-in-c-standard-library\">this</a></i> or <i><a href=\"https://opensource.com/article/17/2/linux-boot-and-startup\" rel=\"nofollow noreferrer\">this</a></i> help? (the second link points to the boot process.)"}, {"owner": {"reputation": 11569, "user_id": 502399, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ccf39757e9c47ae99df42bdb286c6e5c?s=128&d=identicon&r=PG", "display_name": "Tavian Barnes", "link": "https://stackoverflow.com/users/502399/tavian-barnes"}, "edited": false, "score": 3, "creation_date": 1522850513, "post_id": 49652943, "comment_id": 86314544, "body": "The standard file descriptors are already open when a process starts executing.  Otherwise, how would the libc know what to open?"}, {"owner": {"reputation": 872, "user_id": 8077259, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/E1wSe.jpg?s=128&g=1", "display_name": "caylee", "link": "https://stackoverflow.com/users/8077259/caylee"}, "edited": false, "score": 0, "creation_date": 1522850546, "post_id": 49652943, "comment_id": 86314572, "body": "Thanks, I already read that post. I&#39;m looking for the file descriptor itself, not for the FILE structure which points to fd 0,1,2."}, {"owner": {"reputation": 872, "user_id": 8077259, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/E1wSe.jpg?s=128&g=1", "display_name": "caylee", "link": "https://stackoverflow.com/users/8077259/caylee"}, "reply_to_user": {"reputation": 11569, "user_id": 502399, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ccf39757e9c47ae99df42bdb286c6e5c?s=128&d=identicon&r=PG", "display_name": "Tavian Barnes", "link": "https://stackoverflow.com/users/502399/tavian-barnes"}, "edited": false, "score": 0, "creation_date": 1522850790, "post_id": 49652943, "comment_id": 86314755, "body": "@TavianBarnes: So the code is in the kernel? And if yes, the code is quite long to find the lines for defining the descriptors anyway. How can I find them?"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 11569, "user_id": 502399, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ccf39757e9c47ae99df42bdb286c6e5c?s=128&d=identicon&r=PG", "display_name": "Tavian Barnes", "link": "https://stackoverflow.com/users/502399/tavian-barnes"}, "edited": false, "score": 0, "creation_date": 1522850933, "post_id": 49652943, "comment_id": 86314861, "body": "@TavianBarnes: While shells typically create children with <code>stdin</code> and <code>stdout</code> already open, the reasoning you offer that this must be so because otherwise <code>libc</code> would not know what to open is invalid. Information about what to open (the terminal, a file, a pipe,\u2026) could be passed to the child process in various ways, and the child process would then use that information to prepare the streams."}], "owner": {"reputation": 872, "user_id": 8077259, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/E1wSe.jpg?s=128&g=1", "display_name": "caylee", "link": "https://stackoverflow.com/users/8077259/caylee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 495, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1522850212, "creation_date": 1522850212, "question_id": 49652943, "link": "https://stackoverflow.com/questions/49652943/where-are-standard-c-descriptors-stdin-stdout-stderr-opened-in-linux-glibc-s", "title": "Where are standard C descriptors (stdin, stdout, stderr) opened in Linux/Glibc stack?", "body": "<p>I'd like to know where to find the code lines that actually open the standard file descriptors (stdin, stdout, stderr) in a Linux/Glibc stack. I expect them to be in the glibc, but it would also be possible that they are written in the kernel and standard file descriptors are already open on spawning the process.</p>\n\n<p>If it is in the libc, I'm specifically interested in the syscall parameters. (I assume it to be a \"open\" syscall.)</p>\n\n<p>FYI, I want to use this as an inspiration for coding a libc for my x86 kernel.</p>\n\n<p>Thanks in advance,</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 10, "creation_date": 1522850042, "post_id": 49652820, "comment_id": 86314146, "body": "Writing pointer values to file is not the way to go. You need to write the data that the pointer points to. Pointer values changes each time you run the program. Maybe google for &quot;serialization&quot;"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1522850051, "post_id": 49652820, "comment_id": 86314156, "body": "<code>fread(&amp;P, sizeof(t_p_r) , numElem, f);</code> =&gt; <code>fread(P, sizeof(t_p_r) , numElem, f);</code> same for <code>fwrite</code>"}, {"owner": {"reputation": 328, "user_id": 5999841, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/MRgjN.jpg?s=128&g=1", "display_name": "pacmaninbw", "link": "https://stackoverflow.com/users/5999841/pacmaninbw"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1522852544, "post_id": 49652820, "comment_id": 86316235, "body": "Try writing it to a text file first. When you have all the issues ironed out you can switch to writing to a binary file. When you look at the text file what you will see is that you are writing numbers that are the address of the structure. As @4386427 said you need to write each field to the file to get what you are looking for. To write an array of structures you will need to process the array and write each of the structures separately."}], "answers": [{"tags": [], "owner": {"reputation": 244, "user_id": 9177735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c90311d812036b4debfcf7aa866dec22?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/9177735/ben"}, "is_accepted": false, "score": 1, "last_activity_date": 1522851512, "creation_date": 1522851512, "answer_id": 49653454, "question_id": 49652820, "link": "https://stackoverflow.com/questions/49652820/reading-structure-with-char-from-binary-file/49653454#49653454", "title": "Reading structure with char* from binary file", "body": "<p>You need to write the actual strings to the file</p>\n\n<pre><code>fputc(strlen(P-&gt;P),  f); fwrite(P-&gt;P,  strlen(P-&gt;P),  1, f);\nfputc(strlen(P-&gt;R1), f); fwrite(P-&gt;R1, strlen(P-&gt;R1), 1, f);\nfputc(strlen(P-&gt;R2), f); fwrite(P-&gt;R2, strlen(P-&gt;R2), 1, f);\nfputc(strlen(P-&gt;R3), f); fwrite(P-&gt;R3, strlen(P-&gt;R3), 1, f);\n</code></pre>\n\n<p>There might be better ways to deal with it, but I couldn't comment without more of your code.</p>\n"}, {"tags": [], "owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "is_accepted": true, "score": 2, "last_activity_date": 1522856170, "creation_date": 1522856170, "answer_id": 49655103, "question_id": 49652820, "link": "https://stackoverflow.com/questions/49652820/reading-structure-with-char-from-binary-file/49655103#49655103", "title": "Reading structure with char* from binary file", "body": "<p>When saving the state of a program to file, it never makes sense to save the value of pointers. The value of a pointer is never consistent from program invocation to program invocation.</p>\n\n<p>What you must do is to save the actual data values. In many cases it is not enough to just save data values. You may also need some kind of meta-data to explain what is coming next. Examples of meta-data is \"type\" (i.e. are the next bytes a int32 or int16 or a string) and \"number of bytes\" (i.e. how many bytes does the next variable occupy). This is often referred to as serialization. </p>\n\n<p>You can find libs that have such functionality for almost any kind of data type.</p>\n\n<p>If you want to write it yourself, you need to figure out what you want to write to the file and how you'll identify the fields when you read it back.</p>\n\n<p>Let us say that all you want is to save objects of your rype <code>t_p_r</code>. The first questions to answer is \"what are those char pointers pointing to\" and \"how will you identify the values when reading a file\".</p>\n\n<p>Let us say they point to C type strings. Then your approach could be to save each variable on a new line. That is - each <code>t_p_r</code> will take 4 lines in the file.</p>\n\n<p>So in pseudo code your write function would be:</p>\n\n<pre><code>for each t_p_r variable:\n    write to file the string that P points and a newline\n    write to file the string that R1 points and a newline\n    write to file the string that R2 points and a newline\n    write to file the string that R3 points and a newline\n</code></pre>\n\n<p>The reading is a bit more complicated:</p>\n\n<pre><code>while not end of file:\n    allocate memory for a t_p_r variable\n\n    read a line from the file\n    t_p_r-&gt;P = allocate memory to hold the line\n    strcpy(t_p_r-&gt;P, line)\n\n    read a line from the file\n    t_p_r-&gt;R1 = allocate memory to hold the line\n    strcpy(t_p_r-&gt;R1, line)\n\n    read a line from the file\n    t_p_r-&gt;R2 = allocate memory to hold the line\n    strcpy(t_p_r-&gt;R2, line)\n\n    read a line from the file\n    t_p_r-&gt;R3 = allocate memory to hold the line\n    strcpy(t_p_r-&gt;R3, line)\n</code></pre>\n"}], "owner": {"reputation": 305, "user_id": 8236050, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/49d48a4c0f99a6ce2acf88fa9c03c6b5?s=128&d=identicon&r=PG&f=1", "display_name": "pepito", "link": "https://stackoverflow.com/users/8236050/pepito"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 49655103, "answer_count": 2, "score": 0, "last_activity_date": 1522856170, "creation_date": 1522849902, "last_edit_date": 1522851074, "question_id": 49652820, "link": "https://stackoverflow.com/questions/49652820/reading-structure-with-char-from-binary-file", "title": "Reading structure with char* from binary file", "body": "<p>I\u00b4m trying to save and read <code>struct</code>s from a binary file and I'm having problems. The thing is that it seems that it is being saved properly. Nevertheless, when reading it, it either shows weird characters or throw a \"segmentation fault\" error.</p>\n\n<p>This is my struct:</p>\n\n<pre><code>typedef struct\n{\n    char* P;\n    char* R1;\n    char* R2;\n    char* R3;\n} t_p_r;\n</code></pre>\n\n<p>These are the methods I am using for reading and writing them:  </p>\n\n<p>Method for saving/reading singular structures:</p>\n\n<pre><code>void saveSing(t_p_r P)\n{\n  FILE* f = fopen(\"PR.dat\", \"wb\"); \n  fputc(1, fichero);\n  fwrite(&amp;P, sizeof(t_p_r), 1, f);\n  fclose(f);\n}\n\nvoid ReadSing(t_p_r* P)\n{\n  FILE* f = fopen(\"PR.dat\", \"rb\");\n  fread(P, sizeof(t_p_r) , 1, f);\n  fclose(f);\n}\n</code></pre>\n\n<p>Methods I have tried to save arrays of t_p_r</p>\n\n<pre><code>void SaveR(t_p_r P[], int num)\n{\n  FILE* f= fopen(\"PR.dat\", \"wb\");  \n  fputc(num, f);\n  fwrite(&amp;P, sizeof( t_p_r), num, f);\n  fclose(f);\n}\n\nint ReadR(t_p_r* P)\n{\n  int numElem;\n  FILE* f= fopen(\"PR.dat\", \"rb\");\n  numElem = fgetc(f);\n  P= (t_p_r*) malloc((numElem) * sizeof(t_p_r));\n  fread(&amp;P, sizeof(t_p_r) , numElem, f);\n  fclose(f);\n  return numElem;\n}\n</code></pre>\n\n<p>In the case of the first set of methods, I have the problem of getting rare symbols (not the ones entered in the <code>char*</code> that are being saved. In the second one, instead, I get A segmentation fault when trying to read them. </p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1522849221, "post_id": 49652485, "comment_id": 86313449, "body": "<code>sizeof(tm-&gt;tm_mon+1)</code> is the size of an (int) expression. (which is the size of an int)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1522849229, "post_id": 49652485, "comment_id": 86313455, "body": "&quot;<i>Is it right way to do so?</i>&quot; no. Is it hard to find a usage example of <code>fwrite()</code>? Also make sure to learn what a <i>string constant</i> is in C."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 1, "creation_date": 1522849234, "post_id": 49652485, "comment_id": 86313458, "body": "You are writing <code>sizeof(tm-&gt;tm_mon+1)</code> bytes from a buffer containing the string <code>&quot;&amp;tm-&gt;tm_mon+1&quot;</code> to the file."}, {"owner": {"reputation": 2244, "user_id": 5520680, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/C1jQH.png?s=128&g=1", "display_name": "Tom&#39;s", "link": "https://stackoverflow.com/users/5520680/toms"}, "edited": false, "score": 0, "creation_date": 1522849238, "post_id": 49652485, "comment_id": 86313464, "body": "Did you have read tutorial or other ressouce ? Because it seem you don&#39;t understand the difference between binary read/write and text read/write."}, {"owner": {"reputation": 322, "user_id": 6409591, "user_type": "registered", "accept_rate": 38, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "jenny", "link": "https://stackoverflow.com/users/6409591/jenny"}, "edited": false, "score": 0, "creation_date": 1522849852, "post_id": 49652485, "comment_id": 86313964, "body": "No I didnot... I will do it now. Thanks"}], "answers": [{"comments": [{"owner": {"reputation": 322, "user_id": 6409591, "user_type": "registered", "accept_rate": 38, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "jenny", "link": "https://stackoverflow.com/users/6409591/jenny"}, "edited": false, "score": 0, "creation_date": 1522858641, "post_id": 49652813, "comment_id": 86320625, "body": "How can I write my time(date+hours+min+sec) followed by frame id and followed by data. For example, the timestamp is of size 32 bits, ID is of size 16bits and data is of size 8bytes. Can I use single fwrite function to write all these ?Thanks in advance"}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "reply_to_user": {"reputation": 322, "user_id": 6409591, "user_type": "registered", "accept_rate": 38, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "jenny", "link": "https://stackoverflow.com/users/6409591/jenny"}, "edited": false, "score": 0, "creation_date": 1522913068, "post_id": 49652813, "comment_id": 86342648, "body": "Jenny, a time <i>stamp</i> is not the same as a date-and-time. First look up the definition of the CAN bus timestamp, then think about how to generate it."}, {"owner": {"reputation": 322, "user_id": 6409591, "user_type": "registered", "accept_rate": 38, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "jenny", "link": "https://stackoverflow.com/users/6409591/jenny"}, "edited": false, "score": 0, "creation_date": 1522918175, "post_id": 49652813, "comment_id": 86345889, "body": "Yeah, I meant to say not a real timestamp, but the time when the CAN bus frame has occurred."}], "tags": [], "owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "is_accepted": true, "score": 0, "last_activity_date": 1522849894, "creation_date": 1522849894, "answer_id": 49652813, "question_id": 49652485, "link": "https://stackoverflow.com/questions/49652485/how-to-write-data-to-a-binary-file-using-c/49652813#49652813", "title": "How to write data to a binary file using C", "body": "<p>A few hints (not a complete solution):</p>\n\n<p>The fact that <code>tm-&gt;tm_mon</code> is zero-based and thus requires <code>+1</code> to make sense as a month number jan...dec, does not mean that you must write <code>sizeof(tm-&gt;tm_mon+1)</code>.</p>\n\n<p>In the same way, if you want to write its value and take its address, that does not mean you have to add 1. Think what you are doing: to <em>what</em> are you adding this 1??? (just as think about what you were taking the size of.)</p>\n\n<p>And if you want to write this value, then do not mix a function like <code>printf</code> which requires a format string (the <code>f</code> meaning \"print formatted\") with <code>fwrite</code> (the <code>f</code> meaning File Write). Thus you don't provide a format string with what you want to write, you just provide the address of what needs to be written. And of course without any +1 (what would you be adding this 1 to?)</p>\n\n<p>With these hints I hope you can find your answer. And remember, If nothing helps, Read the Manual!</p>\n"}], "owner": {"reputation": 322, "user_id": 6409591, "user_type": "registered", "accept_rate": 38, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "jenny", "link": "https://stackoverflow.com/users/6409591/jenny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 49652813, "answer_count": 1, "score": -6, "last_activity_date": 1522849894, "creation_date": 1522849020, "last_edit_date": 1522849140, "question_id": 49652485, "link": "https://stackoverflow.com/questions/49652485/how-to-write-data-to-a-binary-file-using-c", "title": "How to write data to a binary file using C", "body": "<p>I want to write the CAN frames to binary file including the current timestamp and CAN ID followed by 8bytes data frame. I have following in my program,</p>\n\n<pre><code>fwrite(\"&amp;tm-&gt;tm_mon+1\", sizeof(tm-&gt;tm_mon+1),1,fptr);\nfwrite(\"&amp;tm-&gt;tm_mday\", sizeof(tm-&gt;tm_mday+1),1,fptr);\nfwrite(\"&amp;tm-&gt;tm_hour\", sizeof(tm-&gt;tm_hour+1),1,fptr);\nfwrite(\"&amp;tm-&gt;tm_sec\", sizeof(tm-&gt;tm_sec+1),1,fptr);\nfwrite(\"&amp;frame_rd-&gt;can_id\", sizeof(frame_rd-&gt;can_id),1,fptr);\nfwrite(\"&amp;frame_rd-&gt;data\", sizeof(frame_rd-&gt;data),1,fptr);\n</code></pre>\n\n<p>Is it right way to do so? Can anyone help me in doing it. Thanks in advance.</p>\n"}, {"tags": ["c", "dynamic-memory-allocation"], "comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1522849049, "post_id": 49652452, "comment_id": 86313312, "body": "If malloc returned null, and you dereference null, you get a segmentation fault or undefined behavior."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1522849058, "post_id": 49652452, "comment_id": 86313318, "body": "Is this a homework question?"}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1522849108, "post_id": 49652452, "comment_id": 86313350, "body": "Do you mean: <code>if(p==NULL){ break; }</code> ?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 1, "creation_date": 1522849128, "post_id": 49652452, "comment_id": 86313373, "body": "1. you probably mean <code>if (p == NULL)</code> (or simply <code>if (!p)</code>). 2. <a href=\"https://linux.die.net/man/3/malloc\" rel=\"nofollow noreferrer\">man malloc</a> should be enough to answer this question."}, {"owner": {"reputation": 2287, "user_id": 5267751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd62e8fd8fbb37abc7e2a39d23828047?s=128&d=identicon&r=PG&f=1", "display_name": "user202729", "link": "https://stackoverflow.com/users/5267751/user202729"}, "edited": false, "score": 0, "creation_date": 1522849231, "post_id": 49652452, "comment_id": 86313457, "body": "We expect <a href=\"https://stackoverflow.com\">Stack Overflow</a> users to <a href=\"https://meta.stackoverflow.com/questions/261592/how-much-research-effort-is-expected-of-stack-overflow-users\">research</a> before asking."}, {"owner": {"reputation": 79, "user_id": 5077178, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-6t9H7bJkv-I/AAAAAAAAAAI/AAAAAAAAC1U/LbwDkgWAOuU/photo.jpg?sz=128", "display_name": "Utkarsh Patel", "link": "https://stackoverflow.com/users/5077178/utkarsh-patel"}, "edited": false, "score": 0, "creation_date": 1522849321, "post_id": 49652452, "comment_id": 86313539, "body": "What i am asking is what happens if heap memory gets full. by mistake i wrote *p."}, {"owner": {"reputation": 79, "user_id": 5077178, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-6t9H7bJkv-I/AAAAAAAAAAI/AAAAAAAAC1U/LbwDkgWAOuU/photo.jpg?sz=128", "display_name": "Utkarsh Patel", "link": "https://stackoverflow.com/users/5077178/utkarsh-patel"}, "edited": false, "score": 0, "creation_date": 1522849523, "post_id": 49652452, "comment_id": 86313695, "body": "I tried in my PC. Its not giving any error. but my PC got hang."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 2, "creation_date": 1522851140, "post_id": 49652452, "comment_id": 86315032, "body": "@FelixPalmen: It&#39;s not that obvious, especially on platforms which don&#39;t give you the memory until you actually use it."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1522853284, "post_id": 49652452, "comment_id": 86316842, "body": "@Bathsheba even then, the runtime must allocate SOME memory for a valid pointer to return ... so it might just take (much) longer."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1522853353, "post_id": 49652452, "comment_id": 86316891, "body": "@FelixPalmen: That&#39;s a question in itself. I can&#39;t see why a compiler cannot model a machine with infinite memory; the &quot;as-if&quot; rule would still apply, but alas I&#39;m far from being an expert in this field."}], "answers": [{"comments": [{"owner": {"reputation": 79, "user_id": 5077178, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-6t9H7bJkv-I/AAAAAAAAAAI/AAAAAAAAC1U/LbwDkgWAOuU/photo.jpg?sz=128", "display_name": "Utkarsh Patel", "link": "https://stackoverflow.com/users/5077178/utkarsh-patel"}, "edited": false, "score": 0, "creation_date": 1522849823, "post_id": 49652624, "comment_id": 86313939, "body": "In 1st case it will return null. but i have not used if(p==NULL){break;}. So it wont exit the loop. So what happens in memory?"}, {"owner": {"reputation": 7975, "user_id": 5660517, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/1iIxK.jpg?s=128&g=1", "display_name": "Ronan Boiteau", "link": "https://stackoverflow.com/users/5660517/ronan-boiteau"}, "reply_to_user": {"reputation": 79, "user_id": 5077178, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-6t9H7bJkv-I/AAAAAAAAAAI/AAAAAAAAC1U/LbwDkgWAOuU/photo.jpg?sz=128", "display_name": "Utkarsh Patel", "link": "https://stackoverflow.com/users/5077178/utkarsh-patel"}, "edited": false, "score": 0, "creation_date": 1522850002, "post_id": 49652624, "comment_id": 86314108, "body": "@UtkarshPatel Even though you keep on calling <code>malloc()</code>, it won&#39;t be able to allocate. Instead, it will return a <code>NULL</code> pointer each time it is called. So as Felix said, nothing will happen."}], "tags": [], "owner": {"reputation": 7975, "user_id": 5660517, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/1iIxK.jpg?s=128&g=1", "display_name": "Ronan Boiteau", "link": "https://stackoverflow.com/users/5660517/ronan-boiteau"}, "is_accepted": true, "score": 0, "last_activity_date": 1522849418, "creation_date": 1522849418, "answer_id": 49652624, "question_id": 49652452, "link": "https://stackoverflow.com/questions/49652452/what-will-happen-if-heap-memory-gets-full/49652624#49652624", "title": "What will happen if heap memory gets full?", "body": "<blockquote>\n  <p>What will happen in below case?</p>\n</blockquote>\n\n<p>Your heap will get full. When this happens, <code>malloc()</code> won't be able to allocate memory anymore and it's going to return <code>NULL</code> pointers indefinitely.</p>\n\n<blockquote>\n  <p>What will happen if I write <code>if (p == NULL) { break; }</code>?</p>\n</blockquote>\n\n<p>Your heap will get full. But here, your program will exit, since you're breaking out of the <code>while</code> loop in case <code>malloc()</code> fails to allocate memory.</p>\n"}, {"tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 1, "last_activity_date": 1522851246, "last_edit_date": 1522851246, "creation_date": 1522850799, "answer_id": 49653184, "question_id": 49652452, "link": "https://stackoverflow.com/questions/49652452/what-will-happen-if-heap-memory-gets-full/49653184#49653184", "title": "What will happen if heap memory gets full?", "body": "<ol>\n<li><p>You might expect to run out of memory eventually, and <code>malloc</code> must return <code>NULL</code> in that case. But note that some C runtime libraries and operating systems will not actually allocate the memory until you use it. Since you're not using the memory, you might find that the loops runs forever, but not due to the explicit failure of <code>malloc</code>.</p></li>\n<li><p>Inclusion of the <code>if</code> statement will end the program if <code>malloc</code> fails to allocate. If the C runtime libary and operating system are behaving in the way I've mentioned, then <code>malloc</code> may well never fail to allocate and your program <em>could</em> loop infinitely <em>despite</em> the <code>if</code> conditional.</p></li>\n</ol>\n"}], "owner": {"reputation": 79, "user_id": 5077178, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-6t9H7bJkv-I/AAAAAAAAAAI/AAAAAAAAC1U/LbwDkgWAOuU/photo.jpg?sz=128", "display_name": "Utkarsh Patel", "link": "https://stackoverflow.com/users/5077178/utkarsh-patel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2364, "favorite_count": 0, "accepted_answer_id": 49652624, "answer_count": 2, "score": 0, "last_activity_date": 1522851246, "creation_date": 1522848932, "last_edit_date": 1522850274, "question_id": 49652452, "link": "https://stackoverflow.com/questions/49652452/what-will-happen-if-heap-memory-gets-full", "title": "What will happen if heap memory gets full?", "body": "<ol>\n<li>What will happen in below case?</li>\n<li><p>What will happen if I write <code>if (p == NULL) { break; }</code>?</p>\n\n<pre><code>#include &lt;stdio.h&gt;  \nvoid main()  \n{  \n    int *p;  \n    while (1)  \n    {  \n        p = malloc(1024); // allocating memory in infinite while loop  \n        // if (p == NULL) { break; }\n    }  \n}  \n</code></pre></li>\n</ol>\n"}, {"tags": ["c", "eclipse", "stm32"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 1, "creation_date": 1522848272, "post_id": 49652058, "comment_id": 86312696, "body": "Then don&#39;t use <code>-l</code> -- this flag <i>prepends</i> a &quot;lib&quot; to the name and searches for it in the library search path. Instead, just add the plain full pathname to your lib at the end of the command line, without any flag."}, {"owner": {"reputation": 35, "user_id": 3810317, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/100001289235970/picture?type=large", "display_name": "user3810317", "link": "https://stackoverflow.com/users/3810317/user3810317"}, "edited": false, "score": 0, "creation_date": 1522912503, "post_id": 49652058, "comment_id": 86342298, "body": "@FelixPalmen, I tried to do so. I used this command : arm-none-eabi-gcc -mcpu=cortex-m7 -mthumb -mfloat-abi=hard -mfpu=fpv5-sp-d16 -L&quot;C:\\Users\\q73624\\Documents\\STM32_Workspace\\Wallbox_Sys_Wor&zwnj;&#8203;kbench\\Middlewares\\S&zwnj;&#8203;T\\STemWin\\Lib&quot; -specs=nosys.specs -specs=nano.specs -T&quot;../STM32F746NGHx_FLASH.ld&quot; -Wl,-Map=output.map -Wl,--gc-sections -o &quot;Wallbox_Sys_Workbench.elf&quot; @&quot;objects.list&quot;   . I get an undefined reference for each function call from the libraries."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1522917283, "post_id": 49652058, "comment_id": 86345256, "body": "There are no libs on that command line..."}, {"owner": {"reputation": 35, "user_id": 3810317, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/100001289235970/picture?type=large", "display_name": "user3810317", "link": "https://stackoverflow.com/users/3810317/user3810317"}, "edited": false, "score": 0, "creation_date": 1523339657, "post_id": 49652058, "comment_id": 86506795, "body": "@FelixPalmen, I added them this time : arm-none-eabi-gcc -mcpu=cortex-m7 -mthumb -mfloat-abi=hard -mfpu=fpv5-sp-d16 -L&quot;C:\\Users\\q73624\\Documents\\STM32_Workspace\\Wallbox_Sys_Wor&zwnj;&#8203;kbench\\Middlewares&quot; -specs=nosys.specs -specs=nano.specs -T&quot;../STM32F746NGHx_FLASH.ld&quot; -Wl,-Map=output.map -Wl,--gc-sections -o &quot;Wallbox_Sys_Workbench.elf&quot; @&quot;objects.list&quot;  &quot;C:/Users/q73624/Documents/STM32_Workspace/Wallbox_Sys_Workb&zwnj;&#8203;ench/Middlewares/Thi&zwnj;&#8203;rd_Party/libfreertos&zwnj;&#8203;.a&quot; &quot;C:/Users/q73624/Documents/STM32_Workspace/Wallbox_Sys_Workb&zwnj;&#8203;ench/Middlewares/Thi&zwnj;&#8203;rd_Party/STemWin532_&zwnj;&#8203;CM7_IAR.a&quot; . It still can&#39;t find the files."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1523423141, "post_id": 49652058, "comment_id": 86549077, "body": "Then the path is not correct! Problem could be the forward slash vs backslash confusion, as well as a shell &quot;eating&quot; backslashes (so you would need to write double-backslash). Without access to your system, I can&#39;t tell for sure, try to experiment yourself."}, {"owner": {"reputation": 35, "user_id": 3810317, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/100001289235970/picture?type=large", "display_name": "user3810317", "link": "https://stackoverflow.com/users/3810317/user3810317"}, "edited": false, "score": 0, "creation_date": 1523514723, "post_id": 49652058, "comment_id": 86593869, "body": "Thank you, @FelixPalmen . I finally got it to work by using the library names without &quot;lib&quot; prefix and without &quot;.a&quot; extension."}], "owner": {"reputation": 35, "user_id": 3810317, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/100001289235970/picture?type=large", "display_name": "user3810317", "link": "https://stackoverflow.com/users/3810317/user3810317"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 113, "favorite_count": 0, "closed_date": 1522883117, "answer_count": 0, "score": 0, "last_activity_date": 1522847787, "creation_date": 1522847787, "question_id": 49652058, "link": "https://stackoverflow.com/questions/49652058/windows-eclipse-c-c-cannot-find-external-library", "closed_reason": "Duplicate", "title": "Windows Eclipse C/C++ cannot find external library", "body": "<p>I am trying to add two libraries, libfreertos.a and STemWin532_CM7_IAR.a to an Eclipse C/C++ project in order to program a STM32f7 board.\nI keep getting </p>\n\n<blockquote>\n  <p>cannot find -llibfreertos.a</p>\n</blockquote>\n\n<p>and </p>\n\n<blockquote>\n  <p>cannot find -lSTemWin532_CM7_IAR.a</p>\n</blockquote>\n\n<p>errors.</p>\n\n<p>This is the command Eclipse tries to execute:</p>\n\n<pre><code>arm-none-eabi-gcc -mcpu=cortex-m7 -mthumb -mfloat-abi=hard -mfpu=fpv5-sp-d16 -L\"C:\\Users\\q73624\\Documents\\STM32_Workspace\\Wallbox_Sys_Workbench\\Middlewares\\ST\\STemWin\\Lib\" -specs=nosys.specs -specs=nano.specs -T\"../STM32F746NGHx_FLASH.ld\" -Wl,-Map=output.map -Wl,--gc-sections -o \"Wallbox_Sys_Workbench.elf\" @\"objects.list\"  -l\"libfreertos.a\" -l\"STemWin532_CM7_IAR.a\"\n</code></pre>\n\n<p>I am aware of <a href=\"https://stackoverflow.com/questions/8834883/c-external-library-in-eclipse-cdt\">C++: External library in eclipse CDT</a></p>\n\n<p>[1]: <a href=\"https://stackoverflow.com/questions/8834883/c-external-library-in-eclipse-cdt\">C++: External library in eclipse CDT</a>, but that post was for linux, so I am not sure what applies to my case. \nI also tried with full path and without the '.a' extension, nothing seemed to work. Please give some advice.</p>\n"}, {"tags": ["c", "arrays", "pointers"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 1, "creation_date": 1522847628, "post_id": 49651929, "comment_id": 86312154, "body": "You do exactly what you&#39;re asking in the first two lines. But you use <code>n</code> before it is declared -- and it doesn&#39;t make any sense to make this a variable length array if you have a compile time constant number of elements anyways, so just leave out <code>n</code> in the declaration."}, {"owner": {"reputation": 3, "user_id": 9593345, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Yass", "link": "https://stackoverflow.com/users/9593345/yass"}, "edited": false, "score": 0, "creation_date": 1522847730, "post_id": 49651929, "comment_id": 86312238, "body": "thak you for replaying"}, {"owner": {"reputation": 3, "user_id": 9593345, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Yass", "link": "https://stackoverflow.com/users/9593345/yass"}, "edited": false, "score": 0, "creation_date": 1522847775, "post_id": 49651929, "comment_id": 86312286, "body": "i&#39;ve tried it . char *array[3]={str1, str2, str3};  but without  success"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1522847904, "post_id": 49651929, "comment_id": 86312388, "body": "Hint: you need a couple of &#39;const&#39;."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 1, "creation_date": 1522848045, "post_id": 49651929, "comment_id": 86312502, "body": "what do you mean by &quot;without success&quot;? Of course, your variables <code>strX</code> are a bit pointless, but of course this works."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1522848050, "post_id": 49651929, "comment_id": 86312510, "body": "Please edit your question and fix the indention. And it isn&#39;t clear what exactly you don&#39;t understand here."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1522848088, "post_id": 49651929, "comment_id": 86312545, "body": "@MartinJames no <code>const</code>s needed for these declarations..."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1522848185, "post_id": 49651929, "comment_id": 86312620, "body": "@FelixPalmen Not needed to sate the C standard, but needed to achieve decent code quality."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1522848314, "post_id": 49651929, "comment_id": 86312734, "body": "@Lundin of course, but without stating that, it&#39;s misleading as a comment :)"}, {"owner": {"reputation": 3, "user_id": 9593345, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Yass", "link": "https://stackoverflow.com/users/9593345/yass"}, "edited": false, "score": 0, "creation_date": 1522848601, "post_id": 49651929, "comment_id": 86312952, "body": "i want to access  the diefferent pointers in the array using the ( for ) loop   and dereference the pointers in order to display the strings they point to . is the initialisation of the array of pointers ok ?? <code>char *str1 = NULL, *str2 = NULL, *str3 = NULL ;     char  *(*array)[3]={str1, str2, str3};</code>"}, {"owner": {"reputation": 4974, "user_id": 2587816, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d0ec5b10cbc8a9a5b707ea67ea60f84d?s=128&d=identicon&r=PG", "display_name": "Jiminion", "link": "https://stackoverflow.com/users/2587816/jiminion"}, "edited": false, "score": 0, "creation_date": 1522849155, "post_id": 49651929, "comment_id": 86313404, "body": "I don&#39;t like:  char *array[n]={str1, str2, str3};"}, {"owner": {"reputation": 4974, "user_id": 2587816, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d0ec5b10cbc8a9a5b707ea67ea60f84d?s=128&d=identicon&r=PG", "display_name": "Jiminion", "link": "https://stackoverflow.com/users/2587816/jiminion"}, "edited": false, "score": 0, "creation_date": 1522849235, "post_id": 49651929, "comment_id": 86313460, "body": "char *array[3];"}, {"owner": {"reputation": 3, "user_id": 9593345, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Yass", "link": "https://stackoverflow.com/users/9593345/yass"}, "edited": false, "score": 0, "creation_date": 1522849263, "post_id": 49651929, "comment_id": 86313489, "body": "how can i then initialize the array then ??"}, {"owner": {"reputation": 4974, "user_id": 2587816, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d0ec5b10cbc8a9a5b707ea67ea60f84d?s=128&d=identicon&r=PG", "display_name": "Jiminion", "link": "https://stackoverflow.com/users/2587816/jiminion"}, "edited": false, "score": 0, "creation_date": 1522849287, "post_id": 49651929, "comment_id": 86313513, "body": "array[0] = str1; array[1] = str2; array[2] = str3;  // actually, this is wrong"}, {"owner": {"reputation": 4974, "user_id": 2587816, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d0ec5b10cbc8a9a5b707ea67ea60f84d?s=128&d=identicon&r=PG", "display_name": "Jiminion", "link": "https://stackoverflow.com/users/2587816/jiminion"}, "edited": false, "score": 0, "creation_date": 1522849378, "post_id": 49651929, "comment_id": 86313585, "body": "You don&#39;t need to initialize the array.  It is already an array of char pointers.  Just assign to the array as you would to str1, str2, str3."}, {"owner": {"reputation": 4974, "user_id": 2587816, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d0ec5b10cbc8a9a5b707ea67ea60f84d?s=128&d=identicon&r=PG", "display_name": "Jiminion", "link": "https://stackoverflow.com/users/2587816/jiminion"}, "edited": false, "score": 0, "creation_date": 1522849467, "post_id": 49651929, "comment_id": 86313651, "body": "If you want to access the pointers using str1, it would make more sense to:   str1 = array[0];"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1522849703, "post_id": 49651929, "comment_id": 86313842, "body": "OT: write English code - that is, names of variables and functions should be English"}, {"owner": {"reputation": 3, "user_id": 9593345, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Yass", "link": "https://stackoverflow.com/users/9593345/yass"}, "edited": false, "score": 0, "creation_date": 1522850555, "post_id": 49651929, "comment_id": 86314581, "body": "Sorry i&#39;ve already written the code in the German Language . thank you all for the answers ."}], "answers": [{"comments": [{"owner": {"reputation": 4974, "user_id": 2587816, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d0ec5b10cbc8a9a5b707ea67ea60f84d?s=128&d=identicon&r=PG", "display_name": "Jiminion", "link": "https://stackoverflow.com/users/2587816/jiminion"}, "edited": false, "score": 0, "creation_date": 1522849969, "post_id": 49652823, "comment_id": 86314082, "body": "array[i][0]=zeichenketteEinlesen()); //This is a big problem."}, {"owner": {"reputation": 1473, "user_id": 9541310, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ux53p.png?s=128&g=1", "display_name": "terry.qiao", "link": "https://stackoverflow.com/users/9541310/terry-qiao"}, "reply_to_user": {"reputation": 4974, "user_id": 2587816, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d0ec5b10cbc8a9a5b707ea67ea60f84d?s=128&d=identicon&r=PG", "display_name": "Jiminion", "link": "https://stackoverflow.com/users/2587816/jiminion"}, "edited": false, "score": 0, "creation_date": 1522850169, "post_id": 49652823, "comment_id": 86314256, "body": "@Jiminion yeah, you are right. There are several problems in his code. So I think he might be a new in C."}, {"owner": {"reputation": 4974, "user_id": 2587816, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d0ec5b10cbc8a9a5b707ea67ea60f84d?s=128&d=identicon&r=PG", "display_name": "Jiminion", "link": "https://stackoverflow.com/users/2587816/jiminion"}, "edited": false, "score": 0, "creation_date": 1522850307, "post_id": 49652823, "comment_id": 86314380, "body": "Wouldn&#39;t it just be: (array[i])=zeichenketteEinlesen()) ;  ?"}, {"owner": {"reputation": 3, "user_id": 9593345, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Yass", "link": "https://stackoverflow.com/users/9593345/yass"}, "edited": false, "score": 0, "creation_date": 1522850347, "post_id": 49652823, "comment_id": 86314405, "body": "Thank you . I&#39;ve been trying to figure it out for 2 days . This helped me a lot thank you for the explanation too ."}, {"owner": {"reputation": 1473, "user_id": 9541310, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ux53p.png?s=128&g=1", "display_name": "terry.qiao", "link": "https://stackoverflow.com/users/9541310/terry-qiao"}, "reply_to_user": {"reputation": 4974, "user_id": 2587816, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d0ec5b10cbc8a9a5b707ea67ea60f84d?s=128&d=identicon&r=PG", "display_name": "Jiminion", "link": "https://stackoverflow.com/users/2587816/jiminion"}, "edited": false, "score": 0, "creation_date": 1522850557, "post_id": 49652823, "comment_id": 86314585, "body": "@Jiminion As he want to assign values to str1 / str2 / ..., not to the elements of the array. So <code>array</code> must be declared to <code>char **</code> instead of <code>char *</code>."}, {"owner": {"reputation": 3, "user_id": 9593345, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Yass", "link": "https://stackoverflow.com/users/9593345/yass"}, "edited": false, "score": 0, "creation_date": 1522851644, "post_id": 49652823, "comment_id": 86315451, "body": "is it possible to free the Pointers str1, str2, and str3 . in the same (for) loop ?? i mean without the &quot; if else &quot; . would this be a solution:  ` free(*(array[i]));`  ??"}, {"owner": {"reputation": 1473, "user_id": 9541310, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ux53p.png?s=128&g=1", "display_name": "terry.qiao", "link": "https://stackoverflow.com/users/9541310/terry-qiao"}, "reply_to_user": {"reputation": 3, "user_id": 9593345, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Yass", "link": "https://stackoverflow.com/users/9593345/yass"}, "edited": false, "score": 0, "creation_date": 1522851988, "post_id": 49652823, "comment_id": 86315757, "body": "@Yass Yes, absolutely right. Actually you can replace strx with <code>*(array[i])</code> anywhere, as they 2 are completely same."}, {"owner": {"reputation": 3, "user_id": 9593345, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Yass", "link": "https://stackoverflow.com/users/9593345/yass"}, "edited": false, "score": 0, "creation_date": 1522852827, "post_id": 49652823, "comment_id": 86316470, "body": "I appreciate your help"}, {"owner": {"reputation": 1473, "user_id": 9541310, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ux53p.png?s=128&g=1", "display_name": "terry.qiao", "link": "https://stackoverflow.com/users/9541310/terry-qiao"}, "reply_to_user": {"reputation": 3, "user_id": 9593345, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Yass", "link": "https://stackoverflow.com/users/9593345/yass"}, "edited": false, "score": 0, "creation_date": 1522853042, "post_id": 49652823, "comment_id": 86316656, "body": "@Yass You are welcome :)"}, {"owner": {"reputation": 4974, "user_id": 2587816, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d0ec5b10cbc8a9a5b707ea67ea60f84d?s=128&d=identicon&r=PG", "display_name": "Jiminion", "link": "https://stackoverflow.com/users/2587816/jiminion"}, "edited": false, "score": 0, "creation_date": 1522855344, "post_id": 49652823, "comment_id": 86318384, "body": "terry.qiao,  I am glad you were able to help Yass out."}], "tags": [], "owner": {"reputation": 1473, "user_id": 9541310, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ux53p.png?s=128&g=1", "display_name": "terry.qiao", "link": "https://stackoverflow.com/users/9541310/terry-qiao"}, "is_accepted": true, "score": 0, "last_activity_date": 1522850817, "last_edit_date": 1522850817, "creation_date": 1522849914, "answer_id": 49652823, "question_id": 49651929, "link": "https://stackoverflow.com/questions/49651929/initialization-of-an-array-of-pointers-with-predefined-pointers-to-strings/49652823#49652823", "title": "Initialization of an array of pointers with predefined pointers to strings?", "body": "<pre><code>char *str1 = NULL, *str2 = NULL, *str3 = NULL ;\nchar *array[n]={str1, str2, str3};\nint n=3;\n</code></pre>\n\n<ol>\n<li>You should initialize an array with a constant, e.g., 3, not a variable.</li>\n<li>defining array in this way is ok in syntax, though it is not logically correct.</li>\n</ol>\n\n<p>Below is my code (I refactor the format for a better look):</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nchar* zeichenketteEinlesen(void){\n    int i=0;\n    char c ;\n    char *Z_Kette = NULL ;\n    Z_Kette = (char*)malloc(sizeof(char)) ;\n    if(NULL == Z_Kette) {\n        printf(\"Kein virtueller RAM mehr verfuegbar ...\\n\");\n        // incompatible return type\n        exit(EXIT_FAILURE);\n    }\n    printf(\"Geben Sie Die Zeichenkette ein bitte ! :\");\n    while ( (c = getchar()) != '\\n' ){\n        Z_Kette=(char*)realloc(Z_Kette, (i+2)*sizeof(char));\n        if(NULL == Z_Kette) {\n            printf(\"Kein virtueller RAM mehr verfuegbar ...\\n\");\n            // incompatible return type too\n            exit(EXIT_FAILURE);\n        }\n        Z_Kette [i++] = (char)c ;\n    }\n    Z_Kette[i] = '\\0' ;\n    return Z_Kette ;\n}\n\nint main() {\n    char *str1 = NULL, *str2 = NULL, *str3 = NULL ;\n    // logic error, what you want is to change strx, while in your way it changes array elements.\n    char **array[3]={&amp;str1, &amp;str2, &amp;str3};\n    int n=3;\n    printf(\"\\n\\t\\t\\t *** Zeile als Zeichenkette einlesen *** \\n\");\n    for(int i=0;i&lt;n ;i++){\n        // you should not use array[i][0], since array[i] is not an array\n        printf(\"Die eingelesene Zeichenkette ist : %s \\n\", *(array[i])=zeichenketteEinlesen());\n        // here, you should use / free an appropriate pointer in every loop cycle.\n        // (but below is not a good way to do this, you can improve it)\n        if (i == 0) {\n            printf(\"test %s \\n\",str1);\n            free(str1);\n        } else if (i == 1) {\n            printf(\"test %s \\n\",str2);\n            free(str2);\n        } else {\n            printf(\"test %s \\n\",str3);\n            free(str3);\n        }\n    }\n    getchar();\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9593345, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Yass", "link": "https://stackoverflow.com/users/9593345/yass"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "closed_date": 1522862314, "accepted_answer_id": 49652823, "answer_count": 1, "score": -2, "last_activity_date": 1522851281, "creation_date": 1522847401, "last_edit_date": 1522851281, "question_id": 49651929, "link": "https://stackoverflow.com/questions/49651929/initialization-of-an-array-of-pointers-with-predefined-pointers-to-strings", "closed_reason": "Needs details or clarity", "title": "Initialization of an array of pointers with predefined pointers to strings?", "body": "<p>How to initialize an array of pointers with predefined pointers to strings . Please can some one Help me with it and explain to me the logic behind it . thank you in advance I appreciate your help.</p>\n\n<pre><code>char *str1 = NULL, *str2 = NULL, *str3 = NULL ;\nchar *array[n]={str1, str2, str3};\nint n=3;\nprintf(\"\\n\\t\\t\\t *** Zeile als Zeichenkette einlesen *** \\n\");\nfor(int i=0;i&lt;n ;i++) {\n    printf(\"Die eingelesene Zeichenkette ist : %s \\n\", array[i] [0]=zeichenketteEinlesen());\n    printf(\"test %s \\n\",str1);\n    free(str1);\n}\n</code></pre>\n\n<p>this is my whole Program</p>\n\n<pre><code>char* zeichenketteEinlesen(void){\n    int i=0;\n    char c ;\n    char *Z_Kette = NULL ;\n    Z_Kette = (char*)malloc(sizeof(char)) ;\n    if(NULL == Z_Kette) {\n        printf(\"Kein virtueller RAM mehr verfuegbar ...\\n\");\n        return EXIT_FAILURE;\n    }\n    printf(\"Geben Sie Die Zeichenkette ein bitte ! :\");\n    while ( (c = getchar()) != '\\n' ){\n         Z_Kette=(char*)realloc(Z_Kette, (i+2)*sizeof(char));\n            if(NULL == Z_Kette) {\n                printf(\"Kein virtueller RAM mehr verfuegbar ...\\n\");\n                    return EXIT_FAILURE;\n            }\n            Z_Kette [i++] = (char)c ;\n    }\n    Z_Kette[i] = '\\0' ;\n    return Z_Kette ;\n}\nint main()\n{\n    char *str1 = NULL, *str2 = NULL, *str3 = NULL ;\n    char *array[n]={str1, str2, str3};\n    int n=3;\n    printf(\"\\n\\t\\t\\t *** Zeile als Zeichenkette einlesen *** \\n\");\n    for(int i=0;i&lt;n ;i++) {\n        printf(\"Die eingelesene Zeichenkette ist : %s \\n\", array[i][0]=zeichenketteEinlesen());\n        printf(\"test %s \\n\",str1);\n        free(str1);\n    }\n    getchar();\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "edited": false, "score": 2, "creation_date": 1522846411, "post_id": 49651520, "comment_id": 86311260, "body": "<code>int* p_number = number;</code> should be <code>int* p_number = &amp;number;</code>"}, {"owner": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 0, "creation_date": 1522847073, "post_id": 49651520, "comment_id": 86311735, "body": "Although it&#39;s probably more idiomatic and simpler to skip <code>p_number</code> completely and just write <code>hello(&amp;number);</code>"}], "answers": [{"tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": true, "score": 2, "last_activity_date": 1522846425, "creation_date": 1522846425, "answer_id": 49651587, "question_id": 49651520, "link": "https://stackoverflow.com/questions/49651520/whats-wrong-why-pointer-stays-constant/49651587#49651587", "title": "What&#39;s wrong? Why pointer stays constant?", "body": "<p>You need</p>\n\n<pre><code>int* p_number = &amp;number;\n</code></pre>\n\n<p>and</p>\n\n<pre><code>hello(p_number);\n</code></pre>\n\n<p>at the calling site.</p>\n\n<p>i.e. set <code>p_number</code> to the <em>address</em> of <code>number</code>. And do turn up the warning level on your compile <em>and read them</em>! There is a fair amount of redundancy in maintaining a pointer in <code>hello</code>; presumably this is for an exercise? </p>\n"}, {"tags": [], "owner": {"reputation": 1380, "user_id": 9590708, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jxgY5.jpg?s=128&g=1", "display_name": "Prostagma", "link": "https://stackoverflow.com/users/9590708/prostagma"}, "is_accepted": false, "score": 0, "last_activity_date": 1522846849, "creation_date": 1522846849, "answer_id": 49651743, "question_id": 49651520, "link": "https://stackoverflow.com/questions/49651520/whats-wrong-why-pointer-stays-constant/49651743#49651743", "title": "What&#39;s wrong? Why pointer stays constant?", "body": "<pre><code>#include &lt;stdio.h&gt;\nvoid hello(int *p_number);\n\nint main(void) {\n\n    int number = 1, i;\n    int *p_number = &amp;number;\n\n    for (i = 1; i &lt;= 10; i++) {\n        hello(p_number);\n        printf(\"Number in cyclus = %d\\n\", number);\n        number++;\n    }\n\n    return 0;\n}\n\nvoid hello(int *p_number) {\n    printf(\"number of calling = %d, Hello :)\\n\", *p_number);\n}\n</code></pre>\n\n<p>Set the pointer to point at the address of number, pass pointer address to function.</p>\n"}], "owner": {"reputation": 1, "user_id": 9596720, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-s4jFpWEVvIM/AAAAAAAAAAI/AAAAAAAAARs/dgmgrtsdc3A/photo.jpg?sz=128", "display_name": "Zuzana", "link": "https://stackoverflow.com/users/9596720/zuzana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "closed_date": 1522847635, "accepted_answer_id": 49651587, "answer_count": 2, "score": -2, "last_activity_date": 1522846849, "creation_date": 1522846258, "question_id": 49651520, "link": "https://stackoverflow.com/questions/49651520/whats-wrong-why-pointer-stays-constant", "closed_reason": "Duplicate", "title": "What&#39;s wrong? Why pointer stays constant?", "body": "<p>I learn C programming for a while and I had to create a program, which contains a function void hello() displays word 'Hello :)' and the number, how many time the function hello() was called. The code bellow displays 'Hello' but the number of function calling stays constant. I just want to know, what's wrong and why it isn't working as it should. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void) {\n\nvoid hello(int *p_number);\nint number = 1, i;\nint* p_number = number;\n\nfor (i = 1; i &lt;= 10; i++){\n    hello(&amp;p_number);\n    printf(\"Number in cyclus = %d\\n\", number);\n    number++;\n}\n\nreturn 0;\n}\n\nvoid hello(int *p_number){\n    printf(\"number of calling = %d, Hello :)\\n\", *p_number);\n}\n</code></pre>\n"}, {"tags": ["java", "c", "visual-studio", "java-native-interface"], "comments": [{"owner": {"reputation": 2354, "user_id": 9428851, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-MBhDff_bdY0/AAAAAAAAAAI/AAAAAAAACAY/lx7DUTjS350/photo.jpg?sz=128", "display_name": "Victor Gubin", "link": "https://stackoverflow.com/users/9428851/victor-gubin"}, "edited": false, "score": 0, "creation_date": 1522845273, "post_id": 49651123, "comment_id": 86310403, "body": "Are you sure that you jvm is 32bit ? In 2018 it sounds strange, i.e. in most cases you need vcvars64.bat"}, {"owner": {"reputation": 519, "user_id": 5701640, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/J7ybb.jpg?s=128&g=1", "display_name": "Ahmed Salah", "link": "https://stackoverflow.com/users/5701640/ahmed-salah"}, "reply_to_user": {"reputation": 2354, "user_id": 9428851, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-MBhDff_bdY0/AAAAAAAAAAI/AAAAAAAACAY/lx7DUTjS350/photo.jpg?sz=128", "display_name": "Victor Gubin", "link": "https://stackoverflow.com/users/9428851/victor-gubin"}, "edited": false, "score": 0, "creation_date": 1522845403, "post_id": 49651123, "comment_id": 86310487, "body": "I tried vcvars64.bat, vcvarsall.bat and even VsDevCmd.bat too but unfortunately it didn&#39;t help too"}, {"owner": {"reputation": 2354, "user_id": 9428851, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-MBhDff_bdY0/AAAAAAAAAAI/AAAAAAAACAY/lx7DUTjS350/photo.jpg?sz=128", "display_name": "Victor Gubin", "link": "https://stackoverflow.com/users/9428851/victor-gubin"}, "edited": false, "score": 0, "creation_date": 1522845454, "post_id": 49651123, "comment_id": 86310525, "body": "Ok, let&#39;s make some simple nmake file and check:"}, {"owner": {"reputation": 2354, "user_id": 9428851, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-MBhDff_bdY0/AAAAAAAAAAI/AAAAAAAACAY/lx7DUTjS350/photo.jpg?sz=128", "display_name": "Victor Gubin", "link": "https://stackoverflow.com/users/9428851/victor-gubin"}, "edited": false, "score": 0, "creation_date": 1522846704, "post_id": 49651123, "comment_id": 86311470, "body": "make a file like <code>link: compile ln  &#47;DLL &#47;LTCG &#47;LIBPATH:&quot;C:\\Program Files\\Java\\jdk1.8.0_151\\lib&quot;  OUT:factorial.dll msvcrt.lib kernel32.lib  jvm.lib Factorial.obj    compile: cl &#47;c &#47;nologo &#47;GL &#47;Zl   Factorial.c &#47;FoFactorial.obj</code> and Use nmake to build it. The Nmake manuals <a href=\"https://docs.microsoft.com/en-us/cpp/build/nmake-reference\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/cpp/build/nmake-reference</a> <a href=\"http://www.engr.iupui.edu/~dskim/downloadable/reference_Nmake.pdf\" rel=\"nofollow noreferrer\">engr.iupui.edu/~dskim/downloadable/reference_Nmake.pdf</a>"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1522854519, "post_id": 49651123, "comment_id": 86317764, "body": "<i>I removed the including of stdio.h library in my C code but it didn&#39;t help.</i>  You&#39;re not going to be able to compile 32- or 64-bit without the standard C headers. Something is likely wrong with your Visual Studio install.  What&#39;s the full path to the <code>vcvars32.bat</code> file that you used to set up your environment?  Can you try another one?  Can you compile a simple &quot;Hello World!&quot; C program in the Visual Studio GUI that has <code>#include &lt;stdio.h&gt;</code> in it?"}, {"owner": {"reputation": 519, "user_id": 5701640, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/J7ybb.jpg?s=128&g=1", "display_name": "Ahmed Salah", "link": "https://stackoverflow.com/users/5701640/ahmed-salah"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1522927149, "post_id": 49651123, "comment_id": 86352151, "body": "@AndrewHenle the full path is &quot;C:\\Program Files (x86)\\Microsoft Visual Studio\\2017\\Enterprise\\VC\\Auxiliary\\Build&quot; , there are vcvars, vcvars32, vcvars64, vcvarsall, vcvarsamd64_arm, vcvarsamd64_x86, vcvarsx86_amd64 and vcvarsx86_arm and none of them works, yea I can create WindowsDesktopWizard and run C project"}, {"owner": {"reputation": 1908, "user_id": 2543253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a87e0065d4c5036eb7adabe2edfd187?s=128&d=identicon&r=PG", "display_name": "user2543253", "link": "https://stackoverflow.com/users/2543253/user2543253"}, "edited": false, "score": 0, "creation_date": 1522937033, "post_id": 49651123, "comment_id": 86359443, "body": "IIRC, with VS2107 you need to use a batch called <code>(something)devenv.bat</code> to get the correct environment"}], "answers": [{"comments": [{"owner": {"reputation": 519, "user_id": 5701640, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/J7ybb.jpg?s=128&g=1", "display_name": "Ahmed Salah", "link": "https://stackoverflow.com/users/5701640/ahmed-salah"}, "edited": false, "score": 0, "creation_date": 1523307951, "post_id": 49674691, "comment_id": 86497927, "body": "I could do it with VS15 too."}], "tags": [], "owner": {"reputation": 519, "user_id": 5701640, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/J7ybb.jpg?s=128&g=1", "display_name": "Ahmed Salah", "link": "https://stackoverflow.com/users/5701640/ahmed-salah"}, "is_accepted": true, "score": 1, "last_activity_date": 1522938684, "last_edit_date": 1522938684, "creation_date": 1522937993, "answer_id": 49674691, "question_id": 49651123, "link": "https://stackoverflow.com/questions/49651123/jni-vcvars32-bat-gives-me-cannot-open-include-file-stdio-h-no-such-file-or/49674691#49674691", "title": "JNI: vcvars32.bat gives me &quot;Cannot open include file: &#39;stdio.h&#39;: No such file or directory&quot;", "body": "<p>After sometime of searching and failing I had to generate it by VS13 vsvars32.bat note that vsvars not VS17's vcvars that generated 32-bit dll and because my platform is 64-bit I had to install and switch to 32-bit JVM and problem is resolved.</p>\n"}], "owner": {"reputation": 519, "user_id": 5701640, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/J7ybb.jpg?s=128&g=1", "display_name": "Ahmed Salah", "link": "https://stackoverflow.com/users/5701640/ahmed-salah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 478, "favorite_count": 0, "accepted_answer_id": 49674691, "answer_count": 1, "score": 1, "last_activity_date": 1522938684, "creation_date": 1522845144, "last_edit_date": 1522854564, "question_id": 49651123, "link": "https://stackoverflow.com/questions/49651123/jni-vcvars32-bat-gives-me-cannot-open-include-file-stdio-h-no-such-file-or", "title": "JNI: vcvars32.bat gives me &quot;Cannot open include file: &#39;stdio.h&#39;: No such file or directory&quot;", "body": "<p>I am trying to use JNI to integrate a .C code with my Java project.</p>\n\n<p>While trying to generate the .dll file using vcvars32.bat in visual studio 2017 it gives me an error message tells:</p>\n\n<p>\"C:\\Program Files\\Java\\jdk1.8.0_151\\include\\jni.h(39): fatal error C1083: Cannot open include file: 'stdio.h': No such file or directory\"</p>\n\n<p>I removed the including of stdio.h library in my C code but it didn't help.</p>\n\n<p>My command is:</p>\n\n<p>\"cl -I\"C:\\Program Files\\Java\\jdk1.8.0_151\\include\" -I\"C:\\Program Files\\Java\\jdk1.8.0_151\\include\\win32\" -LD \"Factorial.c\" -Fe\"Factorial.dll\"\"</p>\n"}, {"tags": ["c++", "c", "callback", "member"], "comments": [{"owner": {"reputation": 91, "user_id": 4243460, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ifPush5tI4o/AAAAAAAAAAI/AAAAAAAAABw/SNUb77E6g-U/photo.jpg?sz=128", "display_name": "Arnaud Loonstra", "link": "https://stackoverflow.com/users/4243460/arnaud-loonstra"}, "edited": false, "score": 0, "creation_date": 1522867480, "post_id": 49650662, "comment_id": 86325661, "body": "Ok, back to the drawing board. It seems this method only works once. All my callbacks end up being the last registered callback."}], "answers": [{"comments": [{"owner": {"reputation": 91, "user_id": 4243460, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ifPush5tI4o/AAAAAAAAAAI/AAAAAAAAABw/SNUb77E6g-U/photo.jpg?sz=128", "display_name": "Arnaud Loonstra", "link": "https://stackoverflow.com/users/4243460/arnaud-loonstra"}, "edited": false, "score": 0, "creation_date": 1522867547, "post_id": 49651025, "comment_id": 86325702, "body": "Thanks for that. I&#39;d better dive a bit more into lambdas as my original method was flawed."}, {"owner": {"reputation": 91, "user_id": 4243460, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ifPush5tI4o/AAAAAAAAAAI/AAAAAAAAABw/SNUb77E6g-U/photo.jpg?sz=128", "display_name": "Arnaud Loonstra", "link": "https://stackoverflow.com/users/4243460/arnaud-loonstra"}, "edited": false, "score": 0, "creation_date": 1522932934, "post_id": 49651025, "comment_id": 86356346, "body": "Isn&#39;t this a capturing lambda and isn&#39;t it that capturing lambdas cannot be converted to a function pointer? I tried using a lambda like this: <code>auto myCB = [this](int &amp;param1, UIevent &amp;param2 ) { return this-&gt;buttonPressed2(param1, param2);};</code> but I can&#39;t pass it as a callback: <code>no matching function for call to \u2018ofxBlui::button(BNDicon, const char [8], ofApp::setup()::&lt;lambda(int&amp;, UIevent&amp;)&gt;&amp;)\u2019      blui.column_append(col, blui.button(BND_ICON_HELP, &quot;Ghost 2&quot;, myCB ));</code>"}], "tags": [], "owner": {"reputation": 493, "user_id": 3054091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bab064ad4f537f85ea321a063203a28a?s=128&d=identicon&r=PG&f=1", "display_name": "yosim", "link": "https://stackoverflow.com/users/3054091/yosim"}, "is_accepted": false, "score": 1, "last_activity_date": 1523043870, "last_edit_date": 1523043870, "creation_date": 1522844835, "answer_id": 49651025, "question_id": 49650662, "link": "https://stackoverflow.com/questions/49650662/feedback-on-a-cpp-member-to-c-callback-wrapper/49651025#49651025", "title": "Feedback on a CPP member to C callback wrapper", "body": "<p>If I understand you correctly, you want to pass member function, and for this you need to \"bind\" to it <code>this</code>.</p>\n\n<p>There are two easy ways to do so. If you can get the <code>this</code> pointer, simply create a static wrapper function, that will call the member, usiht this <code>this</code> pointer.</p>\n\n<p>In the more likely event that you cannot do so, create a lambda that will capture <code>this</code>, and will accept the arguments you want to pass to your CB. use this lambda to as your CB.</p>\n\n<pre><code>auto myCB = [this](auto &amp; param1) { this-&gt;member(param1);}\n</code></pre>\n\n<p>BTW, whenever you see <code>bind</code>, check if you cannot create simpler code using lambdas. In most cases you will. </p>\n\n<p>This has the drawback that it cannot be used there C style function pointers are expected.</p>\n\n<p>To get around this you can wrap each CB with the relevant instance. for example:</p>\n\n<pre><code>struct Wrapper{\n  static CB_instance* instance;\n  static void myCallback(Param1 p1, Param2 p2) {\n      instance-&gt;callback(p1, p2);\n}\n</code></pre>\n\n<p>now, <code>Wrapper::myCallback</code> can be used as C function pointer.\nIf you will templetize it, you will get to code, very similar to the code you started with...</p>\n"}], "owner": {"reputation": 91, "user_id": 4243460, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ifPush5tI4o/AAAAAAAAAAI/AAAAAAAAABw/SNUb77E6g-U/photo.jpg?sz=128", "display_name": "Arnaud Loonstra", "link": "https://stackoverflow.com/users/4243460/arnaud-loonstra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1523043870, "creation_date": 1522843762, "question_id": 49650662, "link": "https://stackoverflow.com/questions/49650662/feedback-on-a-cpp-member-to-c-callback-wrapper", "title": "Feedback on a CPP member to C callback wrapper", "body": "<p>I've been wrapping my head around using a C library with callbacks in C++. For example I have the following method:</p>\n\n<p><code>int button(int iconid, const char *label, UIhandler handler);</code></p>\n\n<p>which I can use as:</p>\n\n<p><code>button(ICON_COLOR, \"Some text\", callback);</code></p>\n\n<p>I now want to use a C++ member but I can't pass its pointer as is. Therefore I have the following wrapper code based on findings on SO and reading other implementations:</p>\n\n<pre><code>template &lt;typename T&gt;\nstruct Callback;\n\ntemplate &lt;typename Ret, typename... Params&gt;\nstruct Callback&lt;Ret(Params...)&gt; {\n    template &lt;typename... Args&gt;\n    static Ret callback(Args... args) { return func(args...); }\n    static std::function&lt;Ret(Params...)&gt; func;\n};\n\n// Initialize the static member.\ntemplate &lt;typename Ret, typename... Params&gt;\nstd::function&lt;Ret(Params...)&gt; Callback&lt;Ret(Params...)&gt;::func;\n\ntemplate &lt;class InstanceClass&gt;\nUIhandler ofxBluiCptr(InstanceClass  * instance, void (InstanceClass::*instanceMethod)(int, UIevent))\n{\n    Callback&lt;void(int, UIevent)&gt;::func = std::bind( instanceMethod, instance, std::placeholders::_1, std::placeholders::_2 );\n    void (*c_func)(int, UIevent) = static_cast&lt;decltype(c_func)&gt;(Callback&lt;void(int, UIevent)&gt;::callback);\n    return c_func;\n}\n</code></pre>\n\n<p>I can now use the C library as follows:</p>\n\n<p><code>button(ICON_COLOR, \"Some text\", ofxBluiCptr(this, &amp;ofApp::buttonPressed ))</code></p>\n\n<p>It works however I can hardly grasp how. Can anybody provide feedback on this and perhaps comment os whether it is safe to  use this way? </p>\n"}, {"tags": ["c", "stdstring", "crt"], "comments": [{"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 2, "creation_date": 1522842443, "post_id": 49650088, "comment_id": 86308418, "body": "<code>man 3 string</code> Enjoy!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1522842464, "post_id": 49650088, "comment_id": 86308428, "body": "There&#39;s no such function in the C standard library, but isn&#39;t it trivial to do yourself?"}, {"owner": {"reputation": 301, "user_id": 3512369, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/3b70522213339802d94d05dbe4db73b7?s=128&d=identicon&r=PG&f=1", "display_name": "Anurag S Sharma", "link": "https://stackoverflow.com/users/3512369/anurag-s-sharma"}, "edited": false, "score": 1, "creation_date": 1522842539, "post_id": 49650088, "comment_id": 86308477, "body": "It&#39;s damn trivial. But i wanted to use the standard stuff from library."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1522842604, "post_id": 49650088, "comment_id": 86308516, "body": "well, it&#39;s not in the <i>standard</i> library (as specified by the C standard), so ... do it yourself :)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1522842803, "post_id": 49650088, "comment_id": 86308644, "body": "q&amp;d sketch: <code>const char *strlastnotin(const char *s, const char *list){ const char *res = 0; for(const char *p = s; *p; ++p){ if (!strchr(list, p) res = p; } return res; }</code>"}], "owner": {"reputation": 301, "user_id": 3512369, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/3b70522213339802d94d05dbe4db73b7?s=128&d=identicon&r=PG&f=1", "display_name": "Anurag S Sharma", "link": "https://stackoverflow.com/users/3512369/anurag-s-sharma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 90, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1522842067, "creation_date": 1522842067, "question_id": 49650088, "link": "https://stackoverflow.com/questions/49650088/c-equivalent-for-stdbasic-stringfind-last-not-of", "title": "C equivalent for std::basic_string::find_last_not_of", "body": "<p>I want to know if CRT offers a function similar to find_last_not_of() offered by STL. I searched but found equivalents of searching (for the first non-occurence) from the beginning of the string. but none of them searched backwards (starting from the end of the string). All of them searched in the forward direction starting from the first char.</p>\n"}, {"tags": ["c", "linux", "performance", "epoll", "event-loop"], "comments": [{"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1522845192, "post_id": 49649253, "comment_id": 86310339, "body": "Compare <code>strace -tt</code> output for both tests."}, {"owner": {"reputation": 662, "user_id": 1984766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ff111893f024a88150673280c824c24?s=128&d=identicon&r=PG", "display_name": "Xatian", "link": "https://stackoverflow.com/users/1984766/xatian"}, "reply_to_user": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 1, "creation_date": 1522849108, "post_id": 49649253, "comment_id": 86313351, "body": "added the output of -tt"}, {"owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 0, "creation_date": 1522849865, "post_id": 49649253, "comment_id": 86313979, "body": "What does the test results timings from ab say ? Are your own code (which is much simpler than that of nginx) able to handle more requests/sec ? I would expect nginx to spend more CPU time internally and take a bit longer, lessening the momentary load on the OS(ksoftirqd)."}, {"owner": {"reputation": 662, "user_id": 1984766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ff111893f024a88150673280c824c24?s=128&d=identicon&r=PG", "display_name": "Xatian", "link": "https://stackoverflow.com/users/1984766/xatian"}, "edited": false, "score": 0, "creation_date": 1522851433, "post_id": 49649253, "comment_id": 86315272, "body": "That is actually the reason why I am asking this ... in a single threading context (so telling &quot;ab&quot; to just use one thread to generate the load) my code is faster (15.5k req/sec vs. 13k req/sec) which is totally as expected since nginx does actually parse the request :-). On the other hand with e.g. 4 threads nginx is faster (25k req/sec vs 32k req/sec) and I don&#39;t understand why."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1522852912, "post_id": 49649253, "comment_id": 86316543, "body": "[not the cause] <code>listen (servFd, 511);</code> I don;t think you need 511 here. Why?"}, {"owner": {"reputation": 662, "user_id": 1984766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ff111893f024a88150673280c824c24?s=128&d=identicon&r=PG", "display_name": "Xatian", "link": "https://stackoverflow.com/users/1984766/xatian"}, "edited": false, "score": 0, "creation_date": 1522853252, "post_id": 49649253, "comment_id": 86316814, "body": "I used 511 because since as you can see in the strace nginx uses 511 too."}, {"owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 0, "creation_date": 1522877236, "post_id": 49649253, "comment_id": 86331049, "body": "If your code uses less total time than nginx to service the same number of requests, it&#39;s quite natural that ksoftirq uses more CPU, as it has more work to do per second, it just spends less total seconds to do it (i.e. if you spend 10 seconds of CPU time over 10 seconds, that&#39;s 100% CPU usage, if you spend those 10 seconds of CPU time over 20 seconds, that&#39;s 50% CPU usage). As for why nginx is faster when the tests are run in multi threaded, I don&#39;t know - nginx can be configured in numerous ways to take advantage of multiple cores , while your program does not."}, {"owner": {"reputation": 662, "user_id": 1984766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ff111893f024a88150673280c824c24?s=128&d=identicon&r=PG", "display_name": "Xatian", "link": "https://stackoverflow.com/users/1984766/xatian"}, "edited": false, "score": 0, "creation_date": 1522916410, "post_id": 49649253, "comment_id": 86344729, "body": "I updated the question to make it more clear and address your points."}, {"owner": {"reputation": 2361, "user_id": 5809597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d43b1c037d08a423aeb6ee10fc922437?s=128&d=identicon&r=PG&f=1", "display_name": "Jorge Bellon", "link": "https://stackoverflow.com/users/5809597/jorge-bellon"}, "edited": false, "score": 1, "creation_date": 1522916474, "post_id": 49649253, "comment_id": 86344775, "body": "Have you tried using <code>perf record</code>? <a href=\"http://www.brendangregg.com/flamegraphs.html\" rel=\"nofollow noreferrer\">Flame graphs</a> might be very helpful for this. If I remember correctly, nginx uses a master/follower thread pool. The master listens for new requests and offloads them to the followers, so it is a pretty lightweight multithreading model."}, {"owner": {"reputation": 662, "user_id": 1984766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ff111893f024a88150673280c824c24?s=128&d=identicon&r=PG", "display_name": "Xatian", "link": "https://stackoverflow.com/users/1984766/xatian"}, "edited": false, "score": 0, "creation_date": 1522965736, "post_id": 49649253, "comment_id": 86376199, "body": "Ages ago it used this model even on linux. Not with threads but with processes. But since SO_REUSEPORT every worker can bind to the same port and the kernel does the load-balancing. But that is all besides the point ... if nginx did anything like it you would see it in the strace which I don&#39;t."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1523027507, "post_id": 49649253, "comment_id": 86404489, "body": "What are the compiler options for <code>nginx</code>?  Your <code>gcc -Wall test.c -o test</code> isn&#39;t going to do <i>any</i> optimizations,  I&#39;d also check the alignment of the buffers both you and <code>nginx</code> pass to <code>recvfrom</code> and <code>writev</code>.  Also, is it safe to assume the servers are identical? I don&#39;t see any mention that the tests are run on the same server."}, {"owner": {"reputation": 662, "user_id": 1984766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ff111893f024a88150673280c824c24?s=128&d=identicon&r=PG", "display_name": "Xatian", "link": "https://stackoverflow.com/users/1984766/xatian"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1523028154, "post_id": 49649253, "comment_id": 86404908, "body": "@AndrewHenle You are correct ... I forgot to add the flag in this post but haven&#39;t while generating the numbers. My recv-buffer is on the stack so ... it shouldn&#39;t be a problem. Also this would not explain the high load of ksoftirqd. Yeah ... the server is the same. I ran both my test-application and nginx on the same server."}, {"owner": {"reputation": 662, "user_id": 1984766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ff111893f024a88150673280c824c24?s=128&d=identicon&r=PG", "display_name": "Xatian", "link": "https://stackoverflow.com/users/1984766/xatian"}, "edited": false, "score": 0, "creation_date": 1523029579, "post_id": 49649253, "comment_id": 86405809, "body": "Just for fun I tested again without any optimisation and the difference is unnoticeable (which makes sense). Regarding your question about the compiler options of nginx ... I used the standard build that is shipped with the repo (I tested alpine and ubuntu btw)"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1523030716, "post_id": 49649253, "comment_id": 86406548, "body": "@Xatian <i>My recv-buffer is on the stack so ... it shouldn&#39;t be a problem.</i>  Maybe, maybe not.  Your test code is getting interrupts that correspond to network activity, right?  Maybe your NIC likes to have buffers that are of a certain alignment? There&#39;s apparently <i>something</i> different in your userspace code from what <code>nginx</code> is doing that causes those interrupts, and memory alignment is easy to check.  The only difference I see is <code>nginx</code> has <code>socket(AF_INET, SOCK_STREAM, IPPROTO_IP)</code> to your <code>socket(AF_INET, SOCK_STREAM|SOCK_CLOEXEC|SOCK_NONBLOCK, IPPROTO_IP)</code>.  Maybe <code>SOCK_NONBLOCK</code> is it?"}, {"owner": {"reputation": 662, "user_id": 1984766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ff111893f024a88150673280c824c24?s=128&d=identicon&r=PG", "display_name": "Xatian", "link": "https://stackoverflow.com/users/1984766/xatian"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1523031077, "post_id": 49649253, "comment_id": 86406765, "body": "@AndrewHenle That makes sense ... how can I check memory alignment? I removed SOCK_CLOEXEC and SOCK_NONBLOCK from the accept socket ... makes no difference."}, {"owner": {"reputation": 662, "user_id": 1984766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ff111893f024a88150673280c824c24?s=128&d=identicon&r=PG", "display_name": "Xatian", "link": "https://stackoverflow.com/users/1984766/xatian"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1523031553, "post_id": 49649253, "comment_id": 86407043, "body": "@AndrewHenle I added +1/+2/+3/+4 to the address of the recvBuffer when passing it to recvfrom ... makes no difference. (Did the same with writev as well). Is there something else to test regarding memory alignment?"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1523031698, "post_id": 49649253, "comment_id": 86407123, "body": "Per <a href=\"http://man7.org/linux/man-pages/man1/strace.1.html\" rel=\"nofollow noreferrer\">the man page</a>, something like <code>strace -e raw=recvfrom|writev ...</code> should give you the raw values passed to those system calls.  I don&#39;t have access to a Linux system right now to test."}, {"owner": {"reputation": 662, "user_id": 1984766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ff111893f024a88150673280c824c24?s=128&d=identicon&r=PG", "display_name": "Xatian", "link": "https://stackoverflow.com/users/1984766/xatian"}, "edited": false, "score": 0, "creation_date": 1523033175, "post_id": 49649253, "comment_id": 86407907, "body": "Thank you for the suggestion ... I updated the question with the results."}, {"owner": {"reputation": 12697, "user_id": 4994021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/159a6a0bd0b0b5ab92e0dc66d936cc7c?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Brittain", "link": "https://stackoverflow.com/users/4994021/peter-brittain"}, "edited": false, "score": 0, "creation_date": 1523144459, "post_id": 49649253, "comment_id": 86439468, "body": "What does your multithreaded code look like?  I&#39;m wondering about CPU cache issues owing to page clashes..."}, {"owner": {"reputation": 5986, "user_id": 1010175, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/26b622e6f69528866cb2f8426ec3a38b?s=128&d=identicon&r=PG", "display_name": "cegfault", "link": "https://stackoverflow.com/users/1010175/cegfault"}, "edited": false, "score": 0, "creation_date": 1523160485, "post_id": 49649253, "comment_id": 86441773, "body": "@Xatian what is your nginx configuration?  Nginx often uses multiple threads, and your code is clearly running in only one."}, {"owner": {"reputation": 662, "user_id": 1984766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ff111893f024a88150673280c824c24?s=128&d=identicon&r=PG", "display_name": "Xatian", "link": "https://stackoverflow.com/users/1984766/xatian"}, "reply_to_user": {"reputation": 12697, "user_id": 4994021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/159a6a0bd0b0b5ab92e0dc66d936cc7c?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Brittain", "link": "https://stackoverflow.com/users/4994021/peter-brittain"}, "edited": false, "score": 0, "creation_date": 1523160730, "post_id": 49649253, "comment_id": 86441811, "body": "@PeterBrittain Neither the posted code nor nginx is running any multithreaded stuff."}, {"owner": {"reputation": 662, "user_id": 1984766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ff111893f024a88150673280c824c24?s=128&d=identicon&r=PG", "display_name": "Xatian", "link": "https://stackoverflow.com/users/1984766/xatian"}, "reply_to_user": {"reputation": 5986, "user_id": 1010175, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/26b622e6f69528866cb2f8426ec3a38b?s=128&d=identicon&r=PG", "display_name": "cegfault", "link": "https://stackoverflow.com/users/1010175/cegfault"}, "edited": false, "score": 0, "creation_date": 1523161235, "post_id": 49649253, "comment_id": 86441900, "body": "@cegfault strace would show the creation of any thread or process nginx could spawn. I don&#39;t see nginx spawning multiple threads and I configured nginx to spawn just one worker process (which you can see in the strace). So ... the event loop of nginx is equally single-threaded as is my test-code --&gt; which is the point."}, {"owner": {"reputation": 5986, "user_id": 1010175, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/26b622e6f69528866cb2f8426ec3a38b?s=128&d=identicon&r=PG", "display_name": "cegfault", "link": "https://stackoverflow.com/users/1010175/cegfault"}, "edited": false, "score": 0, "creation_date": 1523162366, "post_id": 49649253, "comment_id": 86442086, "body": "@Xatian a slight correction - if it spawns one worker process then nginx is using TWO threads - one to <code>accept()</code> (the main process, usually running as <code>root</code>), and the <i>second</i> thread to handle the connections.  This is very different from what you are doing; you are performing <code>accept()</code> and <code>recvfrom()</code> in the same thread."}, {"owner": {"reputation": 5986, "user_id": 1010175, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/26b622e6f69528866cb2f8426ec3a38b?s=128&d=identicon&r=PG", "display_name": "cegfault", "link": "https://stackoverflow.com/users/1010175/cegfault"}, "edited": false, "score": 0, "creation_date": 1523162441, "post_id": 49649253, "comment_id": 86442104, "body": "In other words, when you say <code>I configured nginx to spawn .... </code> then you&#39;re configuring nginx to <b>create</b> a thread, and you are not creating a thread, so it&#39;s very much possible there&#39;s a difference there.  If you post your nginx configuration, then I will be able to test on my systems and see what&#39;s going on."}, {"owner": {"reputation": 662, "user_id": 1984766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ff111893f024a88150673280c824c24?s=128&d=identicon&r=PG", "display_name": "Xatian", "link": "https://stackoverflow.com/users/1984766/xatian"}, "reply_to_user": {"reputation": 5986, "user_id": 1010175, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/26b622e6f69528866cb2f8426ec3a38b?s=128&d=identicon&r=PG", "display_name": "cegfault", "link": "https://stackoverflow.com/users/1010175/cegfault"}, "edited": false, "score": 0, "creation_date": 1523163292, "post_id": 49649253, "comment_id": 86442232, "body": "@cegfault That is not true. Nginx uses a master/worker process model. The master does no work on incoming connections (it does not accept new connections) ... it just monitors the workers and spawns new ones in case one crashes or the admin reloads the config. The workers are doing the actual work and as you can see in the strace there is just one worker. The master does nothing after the worker is created. Furthermore you would see the creation of threads in the strace since a thread is created via the system-call clone --&gt; I don&#39;t see any clone so there are no threads :-)"}, {"owner": {"reputation": 662, "user_id": 1984766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ff111893f024a88150673280c824c24?s=128&d=identicon&r=PG", "display_name": "Xatian", "link": "https://stackoverflow.com/users/1984766/xatian"}, "reply_to_user": {"reputation": 5986, "user_id": 1010175, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/26b622e6f69528866cb2f8426ec3a38b?s=128&d=identicon&r=PG", "display_name": "cegfault", "link": "https://stackoverflow.com/users/1010175/cegfault"}, "edited": false, "score": 0, "creation_date": 1523164113, "post_id": 49649253, "comment_id": 86442367, "body": "@cegfault Updated the post with a minimum config."}, {"owner": {"reputation": 3180, "user_id": 6716781, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpIoT.jpg?s=128&g=1", "display_name": "Jonah Benton", "link": "https://stackoverflow.com/users/6716781/jonah-benton"}, "edited": false, "score": 0, "creation_date": 1523377055, "post_id": 49649253, "comment_id": 86531857, "body": "@xatian. Good question. I see that nginx is returning an HTTP/1.1 response, while the test code is returning an HTTP/1.0 response. That may be a confounding factor in the way the client operates. For instance, HTTP/1.1 can include keepalive- though I see ab is not being run with keepalive, still, there may be a different and less efficient code path involved. I would suggest returning <i>exactly</i> the same content and headers as nginx, and see if the results even out."}, {"owner": {"reputation": 662, "user_id": 1984766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ff111893f024a88150673280c824c24?s=128&d=identicon&r=PG", "display_name": "Xatian", "link": "https://stackoverflow.com/users/1984766/xatian"}, "reply_to_user": {"reputation": 3180, "user_id": 6716781, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpIoT.jpg?s=128&g=1", "display_name": "Jonah Benton", "link": "https://stackoverflow.com/users/6716781/jonah-benton"}, "edited": false, "score": 0, "creation_date": 1523383552, "post_id": 49649253, "comment_id": 86535617, "body": "@JonahBenton Well ... yeah ... good point. I tested again by returning the exact same thing as nginx --&gt; same result. I will update the question with the string I used. Thanks for your suggestion!"}, {"owner": {"reputation": 1639, "user_id": 2073349, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0266d3aafa1813f794a5b71058d5cd27?s=128&d=identicon&r=PG", "display_name": "Ritesh", "link": "https://stackoverflow.com/users/2073349/ritesh"}, "edited": false, "score": 0, "creation_date": 1523399405, "post_id": 49649253, "comment_id": 86543146, "body": "From the nginx traces, it looks like that nginx is doing 2 forks. Did you make sure that Nginx is having only one monitor process and only one worker. (And not 2 workers)"}, {"owner": {"reputation": 662, "user_id": 1984766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ff111893f024a88150673280c824c24?s=128&d=identicon&r=PG", "display_name": "Xatian", "link": "https://stackoverflow.com/users/1984766/xatian"}, "reply_to_user": {"reputation": 1639, "user_id": 2073349, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0266d3aafa1813f794a5b71058d5cd27?s=128&d=identicon&r=PG", "display_name": "Ritesh", "link": "https://stackoverflow.com/users/2073349/ritesh"}, "edited": false, "score": 0, "creation_date": 1523429337, "post_id": 49649253, "comment_id": 86551718, "body": "@Ritesh You are correct ... I think the first fork is to detach from the console since the main process exits soon after the first fork. (at 13:28:20.449046) Furthermore you can see when the strace goes on that a single worker (pid 2188) is doing all the work. If I throw more requests at it during the strace just this one process is working ... I haven&#39;t included that since the body of the question is limited."}, {"owner": {"reputation": 3180, "user_id": 6716781, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpIoT.jpg?s=128&g=1", "display_name": "Jonah Benton", "link": "https://stackoverflow.com/users/6716781/jonah-benton"}, "edited": false, "score": 0, "creation_date": 1523447199, "post_id": 49649253, "comment_id": 86563331, "body": "Given that nginx is able to consume 99% of a cpu, along with the ksoftirq findings, might try binding your app to a core and preventing that core from servicing interrupts. I also see the use of FIONBIO and some signal masking. Maybe worth doing the same."}, {"owner": {"reputation": 1639, "user_id": 2073349, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0266d3aafa1813f794a5b71058d5cd27?s=128&d=identicon&r=PG", "display_name": "Ritesh", "link": "https://stackoverflow.com/users/2073349/ritesh"}, "edited": false, "score": 0, "creation_date": 1523484961, "post_id": 49649253, "comment_id": 86585780, "body": "I see a significant time differences in last 3 syscalls. recvfrom, writev, and close. For the case of nginx , the time diff is 217 usec and 140 usec, but for the testcode, the difference become, 1002 usec and 2372 usec."}, {"owner": {"reputation": 1639, "user_id": 2073349, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0266d3aafa1813f794a5b71058d5cd27?s=128&d=identicon&r=PG", "display_name": "Ritesh", "link": "https://stackoverflow.com/users/2073349/ritesh"}, "edited": false, "score": 0, "creation_date": 1523485768, "post_id": 49649253, "comment_id": 86586043, "body": "I also see difference in epoll_pwait arguments"}, {"owner": {"reputation": 3180, "user_id": 6716781, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpIoT.jpg?s=128&g=1", "display_name": "Jonah Benton", "link": "https://stackoverflow.com/users/6716781/jonah-benton"}, "edited": false, "score": 1, "creation_date": 1525064511, "post_id": 49649253, "comment_id": 87204432, "body": "I fiddled with this code a bit. I was able to replicate OP&#39;s finding- this code is faster than nginx with a single client or small number of clients, but nginx- even running in foreground- is faster with a large number of concurrent clients. There is a huge difference in context switch numbers- nginx requires only about 60% of the context switches. I have blocked signals, added cpu affinity, added more non-blocking io hints, reordered the code to get as much as possible out of the hot path, but have not been able to reproduce nginx&#39;s low context switch numbers."}, {"owner": {"reputation": 662, "user_id": 1984766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ff111893f024a88150673280c824c24?s=128&d=identicon&r=PG", "display_name": "Xatian", "link": "https://stackoverflow.com/users/1984766/xatian"}, "reply_to_user": {"reputation": 3180, "user_id": 6716781, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpIoT.jpg?s=128&g=1", "display_name": "Jonah Benton", "link": "https://stackoverflow.com/users/6716781/jonah-benton"}, "edited": false, "score": 0, "creation_date": 1525065512, "post_id": 49649253, "comment_id": 87204684, "body": "@JonahBenton Wow thank you! How do you know about the context switches? How do you measure that? Do you also see the high ksoftirqd load?"}, {"owner": {"reputation": 662, "user_id": 1984766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ff111893f024a88150673280c824c24?s=128&d=identicon&r=PG", "display_name": "Xatian", "link": "https://stackoverflow.com/users/1984766/xatian"}, "reply_to_user": {"reputation": 3180, "user_id": 6716781, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpIoT.jpg?s=128&g=1", "display_name": "Jonah Benton", "link": "https://stackoverflow.com/users/6716781/jonah-benton"}, "edited": false, "score": 0, "creation_date": 1525066200, "post_id": 49649253, "comment_id": 87204886, "body": "@JonahBenton I believe the context switches are because of ksoftirqd running on the same core as the application forcing it to switch. As far as I understand it this process is per CPU and does some network-related stuff in kernel-space. It does less work when nginx is running so therefore nginx is getting more CPU-time and is therefore faster. But this is where my ideas end ... I don&#39;t know how to find out what ksoftirqd is doing or at least confirm this hypothesis ... so it could be totally unrelated :-)"}, {"owner": {"reputation": 3180, "user_id": 6716781, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpIoT.jpg?s=128&g=1", "display_name": "Jonah Benton", "link": "https://stackoverflow.com/users/6716781/jonah-benton"}, "edited": false, "score": 0, "creation_date": 1525089256, "post_id": 49649253, "comment_id": 87216448, "body": "Context switches- watching the reporting by vmstat 1 (which is systemwide). Systemwide interrupt and context switch counts are significantly higher with ./test than with /usr/sbin/nginx when handling the same workload. I don&#39;t think ksoftirq is a cause, it&#39;s more of an effect, of the higher interrupt count. Something nginx is doing is reducing the system cost of handling requests."}, {"owner": {"reputation": 3180, "user_id": 6716781, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpIoT.jpg?s=128&g=1", "display_name": "Jonah Benton", "link": "https://stackoverflow.com/users/6716781/jonah-benton"}, "edited": false, "score": 0, "creation_date": 1525113222, "post_id": 49649253, "comment_id": 87229745, "body": "I&#39;m seeing different results using hey instead of ab: <a href=\"https://github.com/rakyll/hey\" rel=\"nofollow noreferrer\">github.com/rakyll/hey</a>. In testing under hey, performance is difficult to distinguish between the code above and nginx at varying levels of concurrency. In looking closer at the results for ab, I&#39;m also seeing some anomalies that lead me to believe it may have some subtle concurrency problems in its accounting. That&#39;s unexpected because I have used it for years. I will try to look deeper and write something up."}, {"owner": {"reputation": 3180, "user_id": 6716781, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpIoT.jpg?s=128&g=1", "display_name": "Jonah Benton", "link": "https://stackoverflow.com/users/6716781/jonah-benton"}, "edited": false, "score": 1, "creation_date": 1525113267, "post_id": 49649253, "comment_id": 87229765, "body": "There is also an interesting result in that nginx produces only 60% as many voluntary context switches as the code above- as reported through /proc/$pid/status- but i think this has to do with the way that nginx&#39; event loop works- <a href=\"http://nginx.org/en/docs/dev/development_guide.html#event_loop\" rel=\"nofollow noreferrer\">nginx.org/en/docs/dev/development_guide.html#event_loop</a>. It maintains its own timers, which, if in userspace, will result in many fewer calls to epoll_wait, and thus many fewer context switches."}, {"owner": {"reputation": 662, "user_id": 1984766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ff111893f024a88150673280c824c24?s=128&d=identicon&r=PG", "display_name": "Xatian", "link": "https://stackoverflow.com/users/1984766/xatian"}, "reply_to_user": {"reputation": 3180, "user_id": 6716781, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpIoT.jpg?s=128&g=1", "display_name": "Jonah Benton", "link": "https://stackoverflow.com/users/6716781/jonah-benton"}, "edited": false, "score": 0, "creation_date": 1525787830, "post_id": 49649253, "comment_id": 87488158, "body": "@JonahBenton since you suspect that ab has something to do with the difference I wrote a small load-generator app (same style as the test-application in my question) --&gt; produces the exact same result as ab."}, {"owner": {"reputation": 662, "user_id": 1984766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ff111893f024a88150673280c824c24?s=128&d=identicon&r=PG", "display_name": "Xatian", "link": "https://stackoverflow.com/users/1984766/xatian"}, "reply_to_user": {"reputation": 3180, "user_id": 6716781, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpIoT.jpg?s=128&g=1", "display_name": "Jonah Benton", "link": "https://stackoverflow.com/users/6716781/jonah-benton"}, "edited": false, "score": 0, "creation_date": 1525788348, "post_id": 49649253, "comment_id": 87488474, "body": "@JonahBenton I can&#39;t follow with what you said about the user space-timers. Why does this reduce the number of calls to epoll_wait? It should reduce the number of calls to clock_gettime and family but not the number of epoll_wait calls. BTW --&gt; in my second edit I traced with &quot;-c&quot; where you get a summary. In the result you can see that nginx does the same number of epoll_wait calls as the test-application."}, {"owner": {"reputation": 558, "user_id": 4207183, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-FlaU_rcEFmQ/AAAAAAAAAAI/AAAAAAAAF-Y/UVEWfvV4tKE/photo.jpg?sz=128", "display_name": "Alejandro Visiedo Garc&#237;a", "link": "https://stackoverflow.com/users/4207183/alejandro-visiedo-garc%c3%ada"}, "edited": false, "score": 0, "creation_date": 1526590975, "post_id": 49649253, "comment_id": 87816820, "body": "About the memory alignment, sometimes to get a better performance with some buffers is good if they are aligned on cache line boundaries (because of DMA transfers). If I am not mistake the alignment for cache line on x86 architecture is 64 bytes. If you are using the stack, try <b><i>_attribute_</i> ((aligned (64)));</b> for your buffers (I am not sure if it works for 64 bytes). <a href=\"https://gcc.gnu.org/onlinedocs/gcc-4.0.2/gcc/Type-Attributes.html\" rel=\"nofollow noreferrer\">gcc.gnu.org/onlinedocs/gcc-4.0.2/gcc/Type-Attributes.html</a> Have a look to the linker documentation, this alignment could depend on it. Maybe it could help to get a better result."}, {"owner": {"reputation": 4651, "user_id": 4262344, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/70dad663dd1685c6b4f9675d01253e78?s=128&d=identicon&r=PG&f=1", "display_name": "Goswin von Brederlow", "link": "https://stackoverflow.com/users/4262344/goswin-von-brederlow"}, "edited": false, "score": 0, "creation_date": 1528705651, "post_id": 49649253, "comment_id": 88592671, "body": "Sometimes slower is faster. When you generate requests from many clients the epoll_wait can return multiple events at a time. If your code is fast the event count will be low or even just 1 and you soon end up doing another epoll_wait syscall. On the other hand if your code is slow then the event count will be higher. You then handle many requests before doing another epoll_wait syscall. And doing many requests takes time so more events have collected for the next epoll_wait call.  Compare the results for epoll_wait in both cases to see how many events per call both cases have."}, {"owner": {"reputation": 662, "user_id": 1984766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ff111893f024a88150673280c824c24?s=128&d=identicon&r=PG", "display_name": "Xatian", "link": "https://stackoverflow.com/users/1984766/xatian"}, "reply_to_user": {"reputation": 4651, "user_id": 4262344, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/70dad663dd1685c6b4f9675d01253e78?s=128&d=identicon&r=PG&f=1", "display_name": "Goswin von Brederlow", "link": "https://stackoverflow.com/users/4262344/goswin-von-brederlow"}, "edited": false, "score": 0, "creation_date": 1528746692, "post_id": 49649253, "comment_id": 88616090, "body": "@GoswinvonBrederlow You can see in the first edit that both my test-application and nginx both do 40k epoll_wait calls for 40k requests ... so no ... this is not what is happening. But you are close ... I actually solved the mystery already but haven&#39;t had time to answer my own question. Thank you for your comment!"}, {"owner": {"reputation": 4651, "user_id": 4262344, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/70dad663dd1685c6b4f9675d01253e78?s=128&d=identicon&r=PG&f=1", "display_name": "Goswin von Brederlow", "link": "https://stackoverflow.com/users/4262344/goswin-von-brederlow"}, "edited": false, "score": 0, "creation_date": 1528788205, "post_id": 49649253, "comment_id": 88628156, "body": "If not already mentioned: To avoid alignment to affect your tests be sure to turn off address space randomization and use <code>env -i</code>. Something as simple as <code>export CFLAGS=-O2 -W -Wall</code> changes alignment and can have more effect than switching between -O2 and -O3."}, {"owner": {"reputation": 1632, "user_id": 2429333, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5eb897104dc190de7ea7da0ac29a59ae?s=128&d=identicon&r=PG", "display_name": "pbn", "link": "https://stackoverflow.com/users/2429333/pbn"}, "edited": false, "score": 1, "creation_date": 1530606411, "post_id": 49649253, "comment_id": 89283326, "body": "@Xatian What was the explanation for this?"}, {"owner": {"reputation": 662, "user_id": 1984766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ff111893f024a88150673280c824c24?s=128&d=identicon&r=PG", "display_name": "Xatian", "link": "https://stackoverflow.com/users/1984766/xatian"}, "reply_to_user": {"reputation": 3180, "user_id": 6716781, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpIoT.jpg?s=128&g=1", "display_name": "Jonah Benton", "link": "https://stackoverflow.com/users/6716781/jonah-benton"}, "edited": false, "score": 0, "creation_date": 1532588800, "post_id": 49649253, "comment_id": 90033365, "body": "Thank you @JonahBenton and to anyone else who ran the code and helped me solve this mystery."}], "answers": [{"comments": [{"owner": {"reputation": 3180, "user_id": 6716781, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpIoT.jpg?s=128&g=1", "display_name": "Jonah Benton", "link": "https://stackoverflow.com/users/6716781/jonah-benton"}, "edited": false, "score": 0, "creation_date": 1532806234, "post_id": 51519449, "comment_id": 90114894, "body": "Solid analysis!"}], "tags": [], "owner": {"reputation": 662, "user_id": 1984766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ff111893f024a88150673280c824c24?s=128&d=identicon&r=PG", "display_name": "Xatian", "link": "https://stackoverflow.com/users/1984766/xatian"}, "is_accepted": true, "score": 3, "last_activity_date": 1532523286, "creation_date": 1532523286, "answer_id": 51519449, "question_id": 49649253, "link": "https://stackoverflow.com/questions/49649253/eventloop-has-high-ksoftirqd-load-nginx-does-not-but-does-same-system-calls-wh/51519449#51519449", "title": "Eventloop has high ksoftirqd load; nginx does not but does same system-calls. Why?", "body": "<p>The short answer:<br>\nSometimes being faster means being slower.</p>\n\n<hr>\n\n<p>The long answer:</p>\n\n<p>In a single-request setting (one request at a time) <code>epoll_wait</code> always blocks and forces a context-switch. The client (<code>ab</code> in this case) has to receive and process the response + send the next request before the server is woke up again and <code>epoll_wait</code> returns the pending socket. The speed in which the server generates the response does not change this behaviour since the client always waits for the server to respond before sending the next request.</p>\n\n<p>In a multi-request setting it depends on the performance of the server if <code>epoll_wait</code> forces a context-switch or not. If the server-application is slower the chance of there being the next request already waiting is higher; in which case no  context switch is necessary since <code>epoll_wait</code> can return immediately. A context-switch is expensive and may take longer than it takes the next request to arrive wasting time.</p>\n\n<p>I realised this when I eliminated the chance of <code>epoll_wait</code> making a context-switch by setting the timeout to zero. This forces <code>epoll_wait</code> to return immediately even if there is no pending request (so it never waits and therefore there is no forced context-switch). In this case the test-application way outperforms nginx even in a multi-request setting.</p>\n\n<p>I further confirmed my theory by:</p>\n\n<ul>\n<li><strong>removing work</strong> from nginx (disabling the access-log) which <strong>made it slower</strong></li>\n<li><strong>adding work</strong> to the test-application (spin-loop) which <strong>made it faster</strong></li>\n</ul>\n\n<p>in a multi-request setting.</p>\n\n<hr>\n\n<p>For this answer I retook all measurements. All tests were ran on an updated ubuntu-box with 8 cores (so more than 5) with the server and the client running on this machine at the same time. The test-application is unchanged.</p>\n\n<ul>\n<li>gcc (Ubuntu 7.3.0-16ubuntu3) 7.3.0</li>\n<li>nginx version: nginx/1.14.0 (Ubuntu)</li>\n</ul>\n\n<p>I wrote a small script to come up with the request/second number below that runs <code>ab</code> with 60.000 requests 100 times picking the fastest outcome.</p>\n\n<pre><code>maxRequests=0\nfor ((i = 0; i &lt; 100; ++i)); do\n    requests=$(ab -n 60000 -c (1 or 4) http://127.0.0.1:8081/index.html 2&gt;&amp;1 | grep \"Requests per second\" | cut -d\" \" -f7)\n    requests=${requests%.*}\n    maxRequests=$(( maxRequests &gt; requests ? maxRequests : requests ))\ndone\necho ${maxRequests}\n</code></pre>\n\n<p><br></p>\n\n<hr>\n\n<p>Here again the base-values with the same settings like in the question.</p>\n\n<pre><code>Requests per second: 13507 (test-application, 1c)\nRequests per second: 27648 (test-application, 4c)\nRequests per second: 11755 (nginx, 1c)\nRequests per second: 31446 (nginx, 4c)\n</code></pre>\n\n<p>To make nginx faster (and therefore slower with 4c) I disabled the access-log.</p>\n\n<pre><code>Requests per second: 12028 (nginx, 1c, no access-log)\nRequests per second: 28976 (nginx, 4c, no access-log)\n</code></pre>\n\n<p>Here is the result if the test-application never sleeps by settings the <code>epool_wait</code> - time to zero.\n<br>Whats interesting is the difference in the 1c setting showing how much it costs to wake up the test-application when a new request arrives.</p>\n\n<pre><code>Requests per second: 20079 (test-application, 1c, spinning)\nRequests per second: 34522 (test-application, 4c, spinning)\n</code></pre>\n\n<p>For these last measurements I added some work to the test-application making it artificially slower to increase the chance of preventing a context-switch. I added the code below to the end of the inner for-loop (after the <code>close</code>) and varied the initial value of <code>j</code> to get to the different results</p>\n\n<pre><code>uint8_t j = 50;\nwhile (--j != 0) {\n    uint8_t i = 0;\n    while (--i != 0)\n        asm(\"\");\n}\n</code></pre>\n\n\n\n<pre><code>Requests per second: 12910 (test-application, 1c, j=50)\nRequests per second: 12126 (test-application, 1c, j=100)\nRequests per second: 11634 (test-application, 1c, j=150)\nRequests per second: 11020 (test-application, 1c, j=200)\nRequests per second: 10235 (test-application, 1c, j=250)\nRequests per second: 27447 (test-application, 4c, j=25)\nRequests per second: 29464 (test-application, 4c, j=50)\nRequests per second: 31334 (test-application, 4c, j=75)\nRequests per second: 32079 (test-application, 4c, j=100)\nRequests per second: 33510 (test-application, 4c, j=125)\nRequests per second: 34241 (test-application, 4c, j=150)\nRequests per second: 34189 (test-application, 4c, j=175)\nRequests per second: 33855 (test-application, 4c, j=200)\nRequests per second: 33328 (test-application, 4c, j=250)\n</code></pre>\n"}], "owner": {"reputation": 662, "user_id": 1984766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ff111893f024a88150673280c824c24?s=128&d=identicon&r=PG", "display_name": "Xatian", "link": "https://stackoverflow.com/users/1984766/xatian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 919, "favorite_count": 2, "accepted_answer_id": 51519449, "answer_count": 1, "score": 19, "last_activity_date": 1532523286, "creation_date": 1522839457, "last_edit_date": 1523383842, "question_id": 49649253, "link": "https://stackoverflow.com/questions/49649253/eventloop-has-high-ksoftirqd-load-nginx-does-not-but-does-same-system-calls-wh", "title": "Eventloop has high ksoftirqd load; nginx does not but does same system-calls. Why?", "body": "<p>I wrote some code that has an epoll-eventloop, accepts new connections and pretends to be a http-server.\nThe posted code is the absolute minimum ... I removed everything (including all error-checks) to make it as short and to the point as possible:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;sys/epoll.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;netinet/ip.h&gt;\n#include &lt;netinet/in.h&gt;\n#include &lt;sys/uio.h&gt;\n#include &lt;unistd.h&gt;\n\n\nint main () {\n    int servFd = socket (AF_INET, SOCK_STREAM | SOCK_NONBLOCK | SOCK_CLOEXEC, IPPROTO_IP);\n    int value = 1;\n    setsockopt (servFd, SOL_SOCKET, SO_REUSEADDR, &amp;value, sizeof (value));\n\n    struct sockaddr_in servAddr;\n    memset (&amp;servAddr, 0, sizeof (servAddr));\n    servAddr.sin_family = AF_INET;\n    servAddr.sin_addr.s_addr = 0;\n    servAddr.sin_port = htons (8081);\n    bind (servFd, (struct sockaddr*)&amp;servAddr, sizeof (servAddr));\n    listen (servFd, 511);\n\n    int efd = epoll_create1 (EPOLL_CLOEXEC);\n    struct epoll_event epollEvt;\n    epollEvt.events = EPOLLIN | EPOLLRDHUP;\n    epollEvt.data.u32 = servFd;\n    epoll_ctl (efd, EPOLL_CTL_ADD, servFd, &amp;epollEvt);\n\n    for (;;) {\n        struct epoll_event pollEvent[512];\n        int eventCount = epoll_wait (efd, pollEvent, 512, -1);\n        for (int i = 0; i &lt; eventCount; ++i) {\n            struct epoll_event* curEvent = &amp;pollEvent[i];\n            if (curEvent-&gt;data.u32 == servFd) {\n                int clientFd = accept4 (servFd, NULL, NULL, SOCK_NONBLOCK | SOCK_CLOEXEC);\n                struct epoll_event epollEvt;\n                epollEvt.events = EPOLLIN | EPOLLRDHUP | EPOLLET;\n                epollEvt.data.u32 = clientFd;\n                epoll_ctl (efd, EPOLL_CTL_ADD, clientFd, &amp;epollEvt);\n                continue;\n            }\n\n            int clientFd = curEvent-&gt;data.u32;\n            char recvBuffer[2048];\n            recvfrom (clientFd, recvBuffer, 2048, 0, NULL, NULL);\n            char sndMsg[] = \"HTTP/1.1 200 OK\\r\\nServer: nginx/1.12.2\\r\\nDate: Tue, 10 Apr 2018 17:41:57 GMT\\r\\nContent-Type: text/plain\\r\\nContent-Length: 0\\r\\nConnection: close\\r\\n\\r\\n\";\n            size_t sndMsgLength = sizeof (sndMsg) - 1;\n            struct iovec sndBuffer;\n            sndBuffer.iov_base = sndMsg;\n            sndBuffer.iov_len = sndMsgLength;\n            writev (clientFd, &amp;sndBuffer, 1);\n            close (clientFd);\n        }\n    }\n    return 0;\n}\n</code></pre>\n\n<hr>\n\n<pre><code>localhost:~# gcc -Wall -O2 test.c -o test\n</code></pre>\n\n<hr>\n\n<pre><code>localhost:~# gcc --version\ngcc (Alpine 6.4.0) 6.4.0\nCopyright (C) 2017 Free Software Foundation, Inc.\nThis is free software; see the source for copying conditions.  There is NO\nwarranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n</code></pre>\n\n<hr>\n\n<p>I did some load-testing of this code and compared it with nginx to see if I did something wrong or if there is something to improve. I expected this code to be the fastest possible implementation since every other \"real\" webserver has to do a lot more stuff in userspace. But still ... somehow nginx beats it in requests per second when using multiple load-generator threads. (Note that I configured nginx to use just one worker to handle every request)</p>\n\n<pre><code>//ab running 1 worker from local machine \nlocalhost:~# ab -n 100000 -c 1 http://10.0.0.111:8081/index.html\nRequests per second:    13228.07 [#/sec] (mean)  //[to nginx]\nRequests per second:    15300.35 [#/sec] (mean)  //[to testcode]\n//ab running 4 worker from local machine \nlocalhost:~# ab -n 100000 -c 4 http://10.0.0.111:8081/index.html\nRequests per second:    30902.63 [#/sec] (mean)  //[to nginx]\nRequests per second:    24734.76 [#/sec] (mean)  //[to testcode]\n</code></pre>\n\n<p>The first test has the expected result ... the test code is faster since it doesn't do anything except generating a hard-coded response. But why is nginx faster in a multi-threading setting? How can that be? <br/>\nThe only explanation I can come up with is that there is something different in kernel-space and that nginx uses some sockopts (like TCP_FASTOPEN or TCP_DEFER_ACCEPT) or maybe some other system-calls to do its thing. Thats why I did some straces and made my code do the exact same thing as nginx does (from a kernel-perspective) --> you can see the strace attached below. Still ... it is faster and I don't understand why.</p>\n\n<pre><code>//ab running 50 worker from remote machine \nlocalhost:~# ab -n 100000 -c 50 http://10.0.0.111:8081/index.html\nRequests per second:    27507.60 [#/sec] (mean)  //[to nginx]\nRequests per second:    24208.51 [#/sec] (mean)  //[to testcode]\n</code></pre>\n\n<p>This test-cast has the exact same result but I noticed some difference in CPU-usage.</p>\n\n<ul>\n<li>My test-code runs at about 60% CPU-load and ksoftirqd/0 runs at about 80%</li>\n<li>nginx runs at about 99% CPU-load and ksoftirqd/0 runs at just 30%</li>\n<li>ksoftirqd/0 has no noticeable CPU-load in the local-host setting in both cases</li>\n</ul>\n\n<hr>\n\n<p>sTrace of nginx:</p>\n\n<pre><code>localhost:~# strace -tt -f /usr/sbin/nginx \n//Removed loading of libraries to stay under the 30k char body limit for this question\n13:28:20.426369 open(\"/etc/localtime\", O_RDONLY|O_NONBLOCK|O_CLOEXEC) = 3\n13:28:20.426549 fstat(3, {st_mode=S_IFREG|0644, st_size=127, ...}) = 0\n13:28:20.426723 mmap(NULL, 127, PROT_READ, MAP_SHARED, 3, 0) = 0x74ae1cf8c000\n13:28:20.426847 close(3)                = 0\n13:28:20.427023 getpid()                = 2186\n13:28:20.427164 open(\"/var/lib/nginx/logs/error.log\", O_WRONLY|O_CREAT|O_APPEND, 0644) = 3\n13:28:20.427341 brk(0xd104603e000)      = 0xd104603e000\n13:28:20.427503 open(\"/etc/ssl/openssl.cnf\", O_RDONLY) = 4\n13:28:20.427680 brk(0xd104603f000)      = 0xd104603f000\n13:28:20.427819 readv(4, [{iov_base=\"\", iov_len=0}, {iov_base=\"[ req ]\\n#default_bits\\t\\t= 2048\\n#d\"..., iov_len=1024}], 2) = 745\n13:28:20.428089 brk(0xd1046040000)      = 0xd1046040000\n13:28:20.428243 readv(4, [{iov_base=\"\", iov_len=0}, {iov_base=\"\", iov_len=1024}], 2) = 0\n13:28:20.428476 close(4)                = 0\n13:28:20.428718 brk(0xd1046041000)      = 0xd1046041000\n13:28:20.428880 brk(0xd1046042000)      = 0xd1046042000\n13:28:20.429179 brk(0xd1046043000)      = 0xd1046043000\n13:28:20.429319 brk(0xd1046044000)      = 0xd1046044000\n13:28:20.429552 brk(0xd1046045000)      = 0xd1046045000\n13:28:20.429775 brk(0xd1046046000)      = 0xd1046046000\n13:28:20.429935 brk(0xd1046047000)      = 0xd1046047000\n13:28:20.430220 brk(0xd1046048000)      = 0xd1046048000\n13:28:20.430391 brk(0xd1046049000)      = 0xd1046049000\n13:28:20.430515 brk(0xd104604b000)      = 0xd104604b000\n13:28:20.430796 brk(0xd104604c000)      = 0xd104604c000\n13:28:20.431042 brk(0xd104604d000)      = 0xd104604d000\n13:28:20.431238 brk(0xd104604e000)      = 0xd104604e000\n13:28:20.431396 brk(0xd104604f000)      = 0xd104604f000\n13:28:20.431581 brk(0xd1046050000)      = 0xd1046050000\n13:28:20.431820 brk(0xd1046051000)      = 0xd1046051000\n13:28:20.432112 brk(0xd1046054000)      = 0xd1046054000\n13:28:20.432374 brk(0xd1046055000)      = 0xd1046055000\n13:28:20.432509 brk(0xd1046056000)      = 0xd1046056000\n13:28:20.432666 brk(0xd1046057000)      = 0xd1046057000\n13:28:20.432836 brk(0xd1046058000)      = 0xd1046058000\n13:28:20.433004 brk(0xd1046059000)      = 0xd1046059000\n13:28:20.433203 brk(0xd104605a000)      = 0xd104605a000\n13:28:20.433400 brk(0xd104605b000)      = 0xd104605b000\n13:28:20.433610 brk(0xd104605c000)      = 0xd104605c000\n13:28:20.433740 brk(0xd104605d000)      = 0xd104605d000\n13:28:20.433895 brk(0xd104605e000)      = 0xd104605e000\n13:28:20.434020 brk(0xd104605f000)      = 0xd104605f000\n13:28:20.434240 brk(0xd1046060000)      = 0xd1046060000\n13:28:20.434419 brk(0xd1046061000)      = 0xd1046061000\n13:28:20.434622 uname({sysname=\"Linux\", nodename=\"localhost\", ...}) = 0\n13:28:20.434801 sched_getaffinity(0, 128, [0, 1, 2, 3, 4, 5]) = 32\n13:28:20.435077 prlimit64(0, RLIMIT_NOFILE, NULL, {rlim_cur=1024, rlim_max=4*1024}) = 0\n13:28:20.435260 brk(0xd1046066000)      = 0xd1046066000\n13:28:20.435424 uname({sysname=\"Linux\", nodename=\"localhost\", ...}) = 0\n13:28:20.435578 brk(0xd104606b000)      = 0xd104606b000\n13:28:20.435700 open(\"/etc/nginx/nginx.conf\", O_RDONLY) = 4\n13:28:20.435912 fstat(4, {st_mode=S_IFREG|0644, st_size=2781, ...}) = 0\n13:28:20.436115 pread64(4, \"\\n\\n\\nuser nginx;\\npcre_jit on;\\n#tim\"..., 2781, 0) = 2781\n13:28:20.436284 geteuid()               = 0\n13:28:20.436440 open(\"/etc/passwd\", O_RDONLY|O_CLOEXEC) = 5\n13:28:20.436596 fcntl(5, F_SETFD, FD_CLOEXEC) = 0\n13:28:20.436725 fcntl(5, F_SETFD, FD_CLOEXEC) = 0\n13:28:20.436857 readv(5, [{iov_base=\"\", iov_len=0}, {iov_base=\"root:x:0:0:root:/root:/bin/ash\\nb\"..., iov_len=1024}], 2) = 1024\n13:28:20.437047 readv(5, [{iov_base=\"\", iov_len=0}, {iov_base=\"sbin/nologin\\nntp:x:123:123:NTP:/\"..., iov_len=1024}], 2) = 397\n13:28:20.437235 lseek(5, -43, SEEK_CUR) = 1378\n13:28:20.437353 close(5)                = 0\n13:28:20.437520 open(\"/etc/group\", O_RDONLY|O_CLOEXEC) = 5\n13:28:20.437684 fcntl(5, F_SETFD, FD_CLOEXEC) = 0\n13:28:20.437800 fcntl(5, F_SETFD, FD_CLOEXEC) = 0\n13:28:20.437933 readv(5, [{iov_base=\"\", iov_len=0}, {iov_base=\"root:x:0:root\\nbin:x:1:root,bin,d\"..., iov_len=1024}], 2) = 776\n13:28:20.438097 close(5)                = 0\n13:28:20.438240 epoll_create1(0)        = 5\n13:28:20.438429 close(5)                = 0\n13:28:20.438681 brk(0xd1046070000)      = 0xd1046070000\n13:28:20.438842 brk(0xd1046072000)      = 0xd1046072000\n13:28:20.439053 brk(0xd1046074000)      = 0xd1046074000\n13:28:20.439175 brk(0xd1046076000)      = 0xd1046076000\n13:28:20.439418 brk(0xd104607b000)      = 0xd104607b000\n13:28:20.439655 mmap(NULL, 1052672, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x74ae1ce8b000\n13:28:20.439886 brk(0xd1046080000)      = 0xd1046080000\n13:28:20.440020 brk(0xd1046085000)      = 0xd1046085000\n13:28:20.440225 open(\"/etc/nginx/mime.types\", O_RDONLY) = 5\n13:28:20.440380 fstat(5, {st_mode=S_IFREG|0644, st_size=3957, ...}) = 0\n13:28:20.440523 pread64(5, \"\\ntypes {\\n    text/html          \"..., 3957, 0) = 3957\n13:28:20.440725 close(5)                = 0\n13:28:20.440977 brk(0xd104608a000)      = 0xd104608a000\n13:28:20.441297 brk(0xd104608c000)      = 0xd104608c000\n13:28:20.441453 close(4)                = 0\n13:28:20.441587 mkdir(\"/var/tmp/nginx/client_body\", 0700) = -1 EEXIST (File exists)\n13:28:20.441814 stat(\"/var/tmp/nginx/client_body\", {st_mode=S_IFDIR|0700, st_size=4096, ...}) = 0\n13:28:20.442022 mkdir(\"/var/tmp/nginx/proxy\", 0700) = -1 EEXIST (File exists)\n13:28:20.442149 stat(\"/var/tmp/nginx/proxy\", {st_mode=S_IFDIR|0700, st_size=4096, ...}) = 0\n13:28:20.442257 mkdir(\"/var/tmp/nginx/fastcgi\", 0700) = -1 EEXIST (File exists)\n13:28:20.442407 stat(\"/var/tmp/nginx/fastcgi\", {st_mode=S_IFDIR|0700, st_size=4096, ...}) = 0\n13:28:20.442568 mkdir(\"/var/tmp/nginx/uwsgi\", 0700) = -1 EEXIST (File exists)\n13:28:20.442732 stat(\"/var/tmp/nginx/uwsgi\", {st_mode=S_IFDIR|0700, st_size=4096, ...}) = 0\n13:28:20.442945 mkdir(\"/var/tmp/nginx/scgi\", 0700) = -1 EEXIST (File exists)\n13:28:20.443051 stat(\"/var/tmp/nginx/scgi\", {st_mode=S_IFDIR|0700, st_size=4096, ...}) = 0\n13:28:20.443229 open(\"/var/log/nginx/access.log\", O_WRONLY|O_CREAT|O_APPEND, 0644) = 4\n13:28:20.443417 fcntl(4, F_SETFD, FD_CLOEXEC) = 0\n13:28:20.443586 open(\"/var/log/nginx/error.log\", O_WRONLY|O_CREAT|O_APPEND, 0644) = 5\n13:28:20.443750 fcntl(5, F_SETFD, FD_CLOEXEC) = 0\n13:28:20.443889 open(\"/var/lib/nginx/logs/error.log\", O_WRONLY|O_CREAT|O_APPEND, 0644) = 6\n13:28:20.444040 fcntl(6, F_SETFD, FD_CLOEXEC) = 0\n13:28:20.444197 mmap(NULL, 2097152, PROT_READ|PROT_WRITE, MAP_SHARED|MAP_ANONYMOUS, -1, 0) = 0x74ae1c0a0000\n13:28:20.444382 socket(AF_INET, SOCK_STREAM, IPPROTO_IP) = 7\n13:28:20.444515 setsockopt(7, SOL_SOCKET, SO_REUSEADDR, [1], 4) = 0\n13:28:20.444680 ioctl(7, FIONBIO, [1])  = 0\n13:28:20.444808 bind(7, {sa_family=AF_INET, sin_port=htons(8081), sin_addr=inet_addr(\"0.0.0.0\")}, 16) = 0\n13:28:20.445015 listen(7, 511)          = 0\n13:28:20.445140 listen(7, 511)          = 0\n13:28:20.445326 mmap(NULL, 65536, PROT_READ|PROT_WRITE|PROT_EXEC, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x74ae1ce7b000\n13:28:20.445493 prlimit64(0, RLIMIT_NOFILE, NULL, {rlim_cur=1024, rlim_max=4*1024}) = 0\n13:28:20.445671 mmap(NULL, 1280, PROT_READ|PROT_WRITE, MAP_SHARED|MAP_ANONYMOUS, -1, 0) = 0x74ae1ce7a000\n13:28:20.445817 rt_sigprocmask(SIG_UNBLOCK, [RT_1 RT_2], NULL, 8) = 0\n13:28:20.445977 rt_sigaction(SIGHUP, {sa_handler=0xd1041f1f3fc, sa_mask=[], sa_flags=SA_RESTORER, sa_restorer=0x74ae1cd4a6cf}, NULL, 8) = 0\n13:28:20.446097 rt_sigaction(SIGUSR1, {sa_handler=0xd1041f1f3fc, sa_mask=[], sa_flags=SA_RESTORER, sa_restorer=0x74ae1cd4a6cf}, NULL, 8) = 0\n13:28:20.446247 rt_sigaction(SIGWINCH, {sa_handler=0xd1041f1f3fc, sa_mask=[], sa_flags=SA_RESTORER, sa_restorer=0x74ae1cd4a6cf}, NULL, 8) = 0\n13:28:20.446438 rt_sigaction(SIGTERM, {sa_handler=0xd1041f1f3fc, sa_mask=[], sa_flags=SA_RESTORER, sa_restorer=0x74ae1cd4a6cf}, NULL, 8) = 0\n13:28:20.446635 rt_sigaction(SIGQUIT, {sa_handler=0xd1041f1f3fc, sa_mask=[], sa_flags=SA_RESTORER, sa_restorer=0x74ae1cd4a6cf}, NULL, 8) = 0\n13:28:20.446886 rt_sigaction(SIGUSR2, {sa_handler=0xd1041f1f3fc, sa_mask=[], sa_flags=SA_RESTORER, sa_restorer=0x74ae1cd4a6cf}, NULL, 8) = 0\n13:28:20.447093 rt_sigaction(SIGALRM, {sa_handler=0xd1041f1f3fc, sa_mask=[], sa_flags=SA_RESTORER, sa_restorer=0x74ae1cd4a6cf}, NULL, 8) = 0\n13:28:20.447236 rt_sigaction(SIGINT, {sa_handler=0xd1041f1f3fc, sa_mask=[], sa_flags=SA_RESTORER, sa_restorer=0x74ae1cd4a6cf}, NULL, 8) = 0\n13:28:20.447446 rt_sigaction(SIGIO, {sa_handler=0xd1041f1f3fc, sa_mask=[], sa_flags=SA_RESTORER, sa_restorer=0x74ae1cd4a6cf}, NULL, 8) = 0\n13:28:20.447767 rt_sigaction(SIGCHLD, {sa_handler=0xd1041f1f3fc, sa_mask=[], sa_flags=SA_RESTORER, sa_restorer=0x74ae1cd4a6cf}, NULL, 8) = 0\n13:28:20.447888 rt_sigaction(SIGSYS, {sa_handler=SIG_IGN, sa_mask=[], sa_flags=SA_RESTORER, sa_restorer=0x74ae1cd4a6cf}, NULL, 8) = 0\n13:28:20.448094 rt_sigaction(SIGPIPE, {sa_handler=SIG_IGN, sa_mask=[], sa_flags=SA_RESTORER, sa_restorer=0x74ae1cd4a6cf}, NULL, 8) = 0\n13:28:20.448253 rt_sigprocmask(SIG_BLOCK, ~[], [], 8) = 0\n13:28:20.448396 fork(strace: Process 2187 attached\n)                  = 2187\n[pid  2187] 13:28:20.448594 gettid( &lt;unfinished ...&gt;\n[pid  2186] 13:28:20.448643 rt_sigprocmask(SIG_SETMASK, [],  &lt;unfinished ...&gt;\n[pid  2187] 13:28:20.448671 &lt;... gettid resumed&gt; ) = 2187\n[pid  2186] 13:28:20.448700 &lt;... rt_sigprocmask resumed&gt; NULL, 8) = 0\n[pid  2187] 13:28:20.448765 rt_sigprocmask(SIG_SETMASK, [],  &lt;unfinished ...&gt;\n[pid  2186] 13:28:20.448792 exit_group(0 &lt;unfinished ...&gt;\n[pid  2187] 13:28:20.448812 &lt;... rt_sigprocmask resumed&gt; NULL, 8) = 0\n[pid  2186] 13:28:20.448836 &lt;... exit_group resumed&gt;) = ?\n[pid  2187] 13:28:20.448854 getpid()    = 2187\n[pid  2187] 13:28:20.448951 setsid( &lt;unfinished ...&gt;\n[pid  2186] 13:28:20.449046 +++ exited with 0 +++\n13:28:20.449055 &lt;... setsid resumed&gt; )  = 2187\n13:28:20.449107 umask(000)              = 022\n13:28:20.449212 open(\"/dev/null\", O_RDWR) = 8\n13:28:20.449309 dup2(8, 0)              = 0\n13:28:20.449455 dup2(8, 1)              = 1\n13:28:20.449573 close(8)                = 0\n13:28:20.449692 open(\"/run/nginx/nginx.pid\", O_RDWR|O_CREAT|O_TRUNC, 0644) = 8\n13:28:20.449848 pwrite64(8, \"2187\\n\", 5, 0) = 5\n13:28:20.449978 close(8)                = 0\n13:28:20.450111 dup2(6, 2)              = 2\n13:28:20.450218 close(3)                = 0\n13:28:20.450376 rt_sigprocmask(SIG_BLOCK, [HUP INT QUIT USR1 USR2 ALRM TERM CHLD WINCH IO], NULL, 8) = 0\n13:28:20.450499 socketpair(AF_UNIX, SOCK_STREAM, 0, [3, 8]) = 0\n13:28:20.450603 ioctl(3, FIONBIO, [1])  = 0\n13:28:20.450696 ioctl(8, FIONBIO, [1])  = 0\n13:28:20.450830 ioctl(3, FIOASYNC, [1]) = 0\n13:28:20.450964 fcntl(3, F_SETOWN, 2187) = 0\n13:28:20.451079 fcntl(3, F_SETFD, FD_CLOEXEC) = 0\n13:28:20.451148 fcntl(8, F_SETFD, FD_CLOEXEC) = 0\n13:28:20.451244 rt_sigprocmask(SIG_BLOCK, ~[], [HUP INT QUIT USR1 USR2 ALRM TERM CHLD WINCH IO], 8) = 0\n13:28:20.451379 fork(strace: Process 2188 attached\n &lt;unfinished ...&gt;\n[pid  2188] 13:28:20.451596 gettid( &lt;unfinished ...&gt;\n[pid  2187] 13:28:20.451615 &lt;... fork resumed&gt; ) = 2188\n[pid  2187] 13:28:20.451727 rt_sigprocmask(SIG_SETMASK, [HUP INT QUIT USR1 USR2 ALRM TERM CHLD WINCH IO],  &lt;unfinished ...&gt;\n[pid  2188] 13:28:20.451754 &lt;... gettid resumed&gt; ) = 2188\n[pid  2187] 13:28:20.451774 &lt;... rt_sigprocmask resumed&gt; NULL, 8) = 0\n[pid  2188] 13:28:20.451942 rt_sigprocmask(SIG_SETMASK, [HUP INT QUIT USR1 USR2 ALRM TERM CHLD WINCH IO],  &lt;unfinished ...&gt;\n[pid  2187] 13:28:20.451969 rt_sigsuspend([], 8 &lt;unfinished ...&gt;\n[pid  2188] 13:28:20.451985 &lt;... rt_sigprocmask resumed&gt; NULL, 8) = 0\n[pid  2188] 13:28:20.452053 getpid()    = 2188\n[pid  2188] 13:28:20.452330 rt_sigprocmask(SIG_BLOCK, ~[RTMIN RT_1 RT_2], [HUP INT QUIT USR1 USR2 ALRM TERM CHLD WINCH IO], 8) = 0\n[pid  2188] 13:28:20.452621 rt_sigprocmask(SIG_BLOCK, ~[], NULL, 8) = 0\n[pid  2188] 13:28:20.452893 prlimit64(0, RLIMIT_NOFILE, {rlim_cur=8*1024, rlim_max=8*1024}, NULL) = 0\n[pid  2188] 13:28:20.453075 futex(0x74ae1cf95064, FUTEX_WAKE_PRIVATE, 2147483647) = 0\n[pid  2188] 13:28:20.453279 rt_sigprocmask(SIG_SETMASK, [HUP INT QUIT USR1 USR2 ALRM TERM CHLD WINCH IO], NULL, 8) = 0\n[pid  2188] 13:28:20.453487 geteuid()   = 0\n[pid  2188] 13:28:20.453667 rt_sigprocmask(SIG_BLOCK, ~[RTMIN RT_1 RT_2], [HUP INT QUIT USR1 USR2 ALRM TERM CHLD WINCH IO], 8) = 0\n[pid  2188] 13:28:20.453861 rt_sigprocmask(SIG_BLOCK, ~[], NULL, 8) = 0\n[pid  2188] 13:28:20.454091 setgid(103) = 0\n[pid  2188] 13:28:20.454335 futex(0x74ae1cf95064, FUTEX_WAKE_PRIVATE, 2147483647) = 0\n[pid  2188] 13:28:20.454583 rt_sigprocmask(SIG_SETMASK, [HUP INT QUIT USR1 USR2 ALRM TERM CHLD WINCH IO], NULL, 8) = 0\n[pid  2188] 13:28:20.454822 socket(AF_UNIX, SOCK_STREAM|SOCK_CLOEXEC, 0) = 9\n[pid  2188] 13:28:20.455183 connect(9, {sa_family=AF_UNIX, sun_path=\"/var/run/nscd/socket\"}, 24) = -1 ENOENT (No such file or directory)\n[pid  2188] 13:28:20.455537 close(9)    = 0\n[pid  2188] 13:28:20.455800 open(\"/etc/group\", O_RDONLY|O_CLOEXEC) = 9\n[pid  2188] 13:28:20.456030 fcntl(9, F_SETFD, FD_CLOEXEC) = 0\n[pid  2188] 13:28:20.456331 fcntl(9, F_SETFD, FD_CLOEXEC) = 0\n[pid  2188] 13:28:20.456544 readv(9, [{iov_base=\"\", iov_len=0}, {iov_base=\"root:x:0:root\\nbin:x:1:root,bin,d\"..., iov_len=1024}], 2) = 776\n[pid  2188] 13:28:20.456799 readv(9, [{iov_base=\"\", iov_len=0}, {iov_base=\"\", iov_len=1024}], 2) = 0\n[pid  2188] 13:28:20.456956 close(9)    = 0\n[pid  2188] 13:28:20.457134 setgroups(3, [103, 82, 103]) = 0\n[pid  2188] 13:28:20.457365 rt_sigprocmask(SIG_BLOCK, ~[RTMIN RT_1 RT_2], [HUP INT QUIT USR1 USR2 ALRM TERM CHLD WINCH IO], 8) = 0\n[pid  2188] 13:28:20.457534 rt_sigprocmask(SIG_BLOCK, ~[], NULL, 8) = 0\n[pid  2188] 13:28:20.457818 setuid(102) = 0\n[pid  2188] 13:28:20.457990 futex(0x74ae1cf95064, FUTEX_WAKE_PRIVATE, 2147483647) = 0\n[pid  2188] 13:28:20.458159 rt_sigprocmask(SIG_SETMASK, [HUP INT QUIT USR1 USR2 ALRM TERM CHLD WINCH IO], NULL, 8) = 0\n[pid  2188] 13:28:20.458378 prctl(PR_SET_DUMPABLE, SUID_DUMP_USER) = 0\n[pid  2188] 13:28:20.458598 chdir(\"/var/www\") = 0\n[pid  2188] 13:28:20.458868 rt_sigprocmask(SIG_SETMASK, [], NULL, 8) = 0\n[pid  2188] 13:28:20.459703 epoll_create1(0) = 9\n[pid  2188] 13:28:20.459994 eventfd2(0, 0) = 10\n[pid  2188] 13:28:20.460340 epoll_ctl(9, EPOLL_CTL_ADD, 10, {EPOLLIN|EPOLLET, {u32=1109208384, u64=14363479846208}}) = 0\n[pid  2188] 13:28:20.460600 eventfd2(0, 0) = 11\n[pid  2188] 13:28:20.460878 ioctl(11, FIONBIO, [1]) = 0\n[pid  2188] 13:28:20.461043 io_setup(32, [0x74ae1ce79000]) = 0\n[pid  2188] 13:28:20.461389 epoll_ctl(9, EPOLL_CTL_ADD, 11, {EPOLLIN|EPOLLET, {u32=1109208032, u64=14363479845856}}) = 0\n[pid  2188] 13:28:20.461729 socketpair(AF_UNIX, SOCK_STREAM, 0, [12, 13]) = 0\n[pid  2188] 13:28:20.462043 epoll_ctl(9, EPOLL_CTL_ADD, 12, {EPOLLIN|EPOLLRDHUP|EPOLLET, {u32=1109208032, u64=14363479845856}}) = 0\n[pid  2188] 13:28:20.462255 close(13)   = 0\n[pid  2188] 13:28:20.462608 epoll_pwait(9, [{EPOLLIN|EPOLLHUP|EPOLLRDHUP, {u32=1109208032, u64=14363479845856}}], 1, 5000, NULL, 8) = 1\n[pid  2188] 13:28:20.462969 close(12)   = 0\n[pid  2188] 13:28:20.463325 mmap(NULL, 987136, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x74ae1bfaf000\n[pid  2188] 13:28:20.463517 mmap(NULL, 397312, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x74ae1ce18000\n[pid  2188] 13:28:20.464039 mmap(NULL, 397312, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x74ae1cdb7000\n[pid  2188] 13:28:20.466039 epoll_ctl(9, EPOLL_CTL_ADD, 7, {EPOLLIN|EPOLLRDHUP, {u32=469430304, u64=128291142561824}}) = 0\n[pid  2188] 13:28:20.466432 close(3)    = 0\n[pid  2188] 13:28:20.466763 epoll_ctl(9, EPOLL_CTL_ADD, 8, {EPOLLIN|EPOLLRDHUP, {u32=469430544, u64=128291142562064}}) = 0\n//Eventloop starts here\n[pid  2188] 13:28:20.467046 epoll_pwait(9, [{EPOLLIN, {u32=469430304, u64=128291142561824}}], 512, -1, NULL, 8) = 1\n[pid  2188] 13:28:34.390021 accept4(7, {sa_family=AF_INET, sin_port=htons(54280), sin_addr=inet_addr(\"10.0.0.15\")}, [112-&gt;16], SOCK_NONBLOCK) = 3\n[pid  2188] 13:28:34.390110 epoll_ctl(9, EPOLL_CTL_ADD, 3, {EPOLLIN|EPOLLRDHUP|EPOLLET, {u32=469430784, u64=128291142562304}}) = 0\n[pid  2188] 13:28:34.390188 epoll_pwait(9, [{EPOLLIN, {u32=469430784, u64=128291142562304}}], 512, 30000, NULL, 8) = 1\n[pid  2188] 13:28:34.390245 recvfrom(3, \"GET /index.html HTTP/1.0\\r\\nHost: \"..., 2048, 0, NULL, NULL) = 93\n[pid  2188] 13:28:34.390462 writev(3, [{iov_base=\"HTTP/1.1 200 OK\\r\\nServer: nginx/1\"..., iov_len=142}], 1) = 142\n[pid  2188] 13:28:34.390602 close(3)    = 0\n</code></pre>\n\n<p>sTrace of the test-code:</p>\n\n<pre><code>localhost:/~# strace -tt -f ./test \n18:07:49.511351 execve(\"./test\", [\"./test\"], 0x735df8f6c0a0 /* 16 vars */) = 0\n18:07:49.514382 arch_prctl(ARCH_SET_FS, 0x71a7644fdb88) = 0\n18:07:49.515405 set_tid_address(0x71a7644fdbc0) = 2325\n18:07:49.515983 mprotect(0x71a7644fa000, 4096, PROT_READ) = 0\n18:07:49.516742 mprotect(0x322e536d000, 4096, PROT_READ) = 0\n18:07:49.517329 socket(AF_INET, SOCK_STREAM|SOCK_CLOEXEC|SOCK_NONBLOCK, IPPROTO_IP) = 3\n18:07:49.518692 setsockopt(3, SOL_SOCKET, SO_REUSEADDR, [1], 4) = 0\n18:07:49.519955 bind(3, {sa_family=AF_INET, sin_port=htons(8080), sin_addr=inet_addr(\"0.0.0.0\")}, 16) = 0\n18:07:49.521092 listen(3, 511)          = 0\n18:07:49.521764 epoll_create1(EPOLL_CLOEXEC) = 4\n18:07:49.522239 epoll_ctl(4, EPOLL_CTL_ADD, 3, {EPOLLIN|EPOLLRDHUP, {u32=3, u64=3}}) = 0\n18:07:49.523392 epoll_pwait(4, [{EPOLLIN, {u32=3, u64=3}}], 512, -1, NULL, 8) = 1\n18:07:52.616270 accept4(3, NULL, NULL, SOCK_CLOEXEC|SOCK_NONBLOCK) = 5\n18:07:52.617149 epoll_ctl(4, EPOLL_CTL_ADD, 5, {EPOLLIN|EPOLLRDHUP|EPOLLET, {u32=5, u64=5}}) = 0\n18:07:52.618188 epoll_pwait(4, [{EPOLLIN, {u32=5, u64=5}}], 512, -1, NULL, 8) = 1\n18:07:52.619472 recvfrom(5, \"GET /index.html HTTP/1.0\\r\\nHost: \"..., 2048, 0, NULL, NULL) = 93\n18:07:52.620474 writev(5, [{iov_base=\"HTTP/1.1 200 OK\\r\\nServer: nginx/1.12\"..., iov_len=142}], 1) = 142\n18:07:52.622846 close(5)                = 0\n</code></pre>\n\n<p><br/>Edit:<br/>\nI did some more traceing ... 400000 request from a remote host ... still no clue why this happens:</p>\n\n<pre><code>localhost:/~# strace -c -f /usr/sbin/nginx \n% time     seconds  usecs/call     calls    errors syscall\n------ ----------- ----------- --------- --------- ----------------\n 47.11    0.040309           0    400000           writev\n 44.55    0.038115           0    400021           close\n  3.11    0.002658           0    400002           accept4\n  1.80    0.001538           0    400002           recvfrom\n  1.74    0.001486           0    400007           epoll_ctl\n  1.69    0.001450           0    400008           epoll_pwait\n\nlocalhost:/~# strace -c -f ./test \n% time     seconds  usecs/call     calls    errors syscall\n------ ----------- ----------- --------- --------- ----------------\n 47.90    0.042760           0    400002           writev\n 44.27    0.039518           0    400002           close\n  3.13    0.002793           0    400002           accept4\n  1.80    0.001610           0    400002           recvfrom\n  1.57    0.001400           0    400005           epoll_pwait\n  1.33    0.001183           0    400003           epoll_ctl\n</code></pre>\n\n<p><br/>Edit:<br/>\nAs suggested in the comment-section I tested again regarding memory-alignment ...</p>\n\n<pre><code>localhost:~# strace -e raw=recvfrom,writev ./test \nrecvfrom(0x5, 0x7c7364ae2ee0, 0x800, 0, 0, 0) = 0x5d\nwritev(0x5, 0x7c7364ae1650, 0x1)        = 0x69\n\nlocalhost:~# strace -f -e raw=recvfrom,writev /usr/sbin/nginx \n[pid  2381] recvfrom(0x3, 0x2344ebbd6a0, 0x800, 0, 0, 0) = 0x5d\n[pid  2381] writev(0x3, 0x7df116c39f90, 0x1) = 0x86\n</code></pre>\n\n<p><br/>Edit:<br/>\nAs requested the config of nginx:</p>\n\n<pre><code>user nginx;\nworker_processes 1;\nworking_directory /var/www;\n\nevents {\n    accept_mutex off;\n    worker_connections 4096;\n}\nhttp {\n    include /etc/nginx/mime.types;\n    server {\n        listen 8081;\n        server_name \"10.0.0.110\";\n        return 200;\n    }\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 1, "creation_date": 1522837395, "post_id": 49648509, "comment_id": 86305111, "body": "Doesn&#39;t your compiler already warn at the very first line?"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 1, "creation_date": 1522837547, "post_id": 49648509, "comment_id": 86305199, "body": "Welcome to SO. Please turn on all warnings in your compiler. For GCC use <code>-Wall</code> and <code>-Wextra</code>. Then if you get a warning, read it carefully."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1522848411, "post_id": 49648509, "comment_id": 86312824, "body": "<code>char* test[3][1024]</code> -&gt; <code>char* test[3]</code>. Then <code>printf(&quot;%s&quot;, transactions[0]);</code>."}], "answers": [{"comments": [{"owner": {"reputation": 154, "user_id": 6708476, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/35fefeff0f21ee566df4cbe2a670cf17?s=128&d=identicon&r=PG&f=1", "display_name": "gerrard2461", "link": "https://stackoverflow.com/users/6708476/gerrard2461"}, "edited": false, "score": 0, "creation_date": 1524732507, "post_id": 49650242, "comment_id": 87093422, "body": "If you have another type try to change the %s if you used in another contexte"}], "tags": [], "owner": {"reputation": 154, "user_id": 6708476, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/35fefeff0f21ee566df4cbe2a670cf17?s=128&d=identicon&r=PG&f=1", "display_name": "gerrard2461", "link": "https://stackoverflow.com/users/6708476/gerrard2461"}, "is_accepted": false, "score": 0, "last_activity_date": 1522842538, "creation_date": 1522842538, "answer_id": 49650242, "question_id": 49648509, "link": "https://stackoverflow.com/questions/49648509/how-to-access-a-pointer-array-in-a-function-in-c/49650242#49650242", "title": "How to access a pointer array in a function in c", "body": "<p>you should use</p>\n\n<pre><code>printf(\"%s\", *transactions);   \n</code></pre>\n\n<p>for the first element \nand</p>\n\n<pre><code>printf(\"%s\", *(transactions+1));\n</code></pre>\n\n<p>for the second element.\nBecause trasactions has a type char *</p>\n"}, {"tags": [], "owner": {"reputation": 77, "user_id": 8461805, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-0WaBG8FaYgw/AAAAAAAAAAI/AAAAAAAAAIc/AgJDcLwwuFM/photo.jpg?sz=128", "display_name": "Timoth&#233;e", "link": "https://stackoverflow.com/users/8461805/timoth%c3%a9e"}, "is_accepted": false, "score": 0, "last_activity_date": 1522852892, "last_edit_date": 1522852892, "creation_date": 1522851771, "answer_id": 49653551, "question_id": 49648509, "link": "https://stackoverflow.com/questions/49648509/how-to-access-a-pointer-array-in-a-function-in-c/49653551#49653551", "title": "How to access a pointer array in a function in c", "body": "<p>Since <strong>char*</strong> can be an array, by writing <strong>char* test[3][1024]</strong> you are creating a triple dimensionned array. You should choose between <strong>char* test[3]</strong> and <strong>char test[3][1024]</strong>.</p>\n\n<p>Then you can use :</p>\n\n<pre><code>printf(\"%s\", transactions[0]);\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9595943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d044650e9fa1c0ae31eac2ef342b0a6?s=128&d=identicon&r=PG&f=1", "display_name": "Antar&#232;s Be", "link": "https://stackoverflow.com/users/9595943/antar%c3%a8s-be"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 84, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1522852892, "creation_date": 1522836985, "last_edit_date": 1522837249, "question_id": 49648509, "link": "https://stackoverflow.com/questions/49648509/how-to-access-a-pointer-array-in-a-function-in-c", "title": "How to access a pointer array in a function in c", "body": "<p>I have a pointer array then I try to access the value of the pointer array in the function but it crashes.\nWhy and how can I access the values pls?</p>\n\n<pre><code>char* test[3][1024]={\"Trans1\",\"Trans2\",\"Trans3\"};\ncreerBlock(test,3, NULL,1);\nextern BLOCK* creerBlock(char* transactions[], int nbTransactions, char *pHashCodePrec, int numBloc)\n</code></pre>\n\n<p>I tried:</p>\n\n<pre><code>printf(\"%s\", *transactions[0]);\n</code></pre>\n\n<p>And:    </p>\n\n<pre><code>printf(\"%s\", transactions[0]);\n</code></pre>\n"}, {"tags": ["c", "memory", "allocation"], "comments": [{"owner": {"reputation": 61304, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 7, "creation_date": 1522836605, "post_id": 49648343, "comment_id": 86304601, "body": "there is no language called c/c++ (should be part of any interview ;)"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1522836698, "post_id": 49648343, "comment_id": 86304674, "body": "The interviewer didn&#39;t want you to use <code>malloc</code> &amp;c. Solving an O(N) problem using recursion is never a particularly good idea. If I were you I&#39;d read K &amp; R from cover to cover, completing all the example exercises, then reapply. You&#39;d crush it then."}, {"owner": {"reputation": 61304, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 1, "creation_date": 1522836706, "post_id": 49648343, "comment_id": 86304679, "body": "frankly your question is extremely vague. Why dont you show the code and then we can tell you where the allocation is and how to avoid it"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1522836719, "post_id": 49648343, "comment_id": 86304687, "body": "it probably means <b>dynamically</b> allocate memory, that is, using one of the <code>malloc()</code> functions or the <code>new</code> operator in C++"}, {"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 2, "creation_date": 1522836785, "post_id": 49648343, "comment_id": 86304731, "body": "You could have pushed back -- variables on the stack <i>are</i> allocated. They&#39;re allocated on the stack. If the interviewer said the wrong thing, you could hold them to that, or get them to correct their requirements."}, {"owner": {"reputation": 762, "user_id": 2493292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f39ea4f86f873cca1afd4a02edff6483?s=128&d=identicon&r=PG&f=1", "display_name": "jamek", "link": "https://stackoverflow.com/users/2493292/jamek"}, "edited": false, "score": 0, "creation_date": 1522836788, "post_id": 49648343, "comment_id": 86304737, "body": "read here <a href=\"https://en.wikipedia.org/wiki/C_dynamic_memory_allocation\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/C_dynamic_memory_allocation</a>"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 5, "creation_date": 1522836801, "post_id": 49648343, "comment_id": 86304748, "body": "The question should have been clearer.  If no memory can be allocated, you cannot run your program at all.  I guess they meant &#39;no malloc/calloc/realloc/free&#39; but hey, just a guess:)"}, {"owner": {"reputation": 59, "user_id": 3678912, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/T057M.png?s=128&g=1", "display_name": "user3678912", "link": "https://stackoverflow.com/users/3678912/user3678912"}, "edited": false, "score": 0, "creation_date": 1522837013, "post_id": 49648343, "comment_id": 86304867, "body": "I&#39;m aware that recursion is a poor solution and I know how to solve it iteratively ;) it seems too obvious to specify that memory shouldn&#39;t be allocated on the heap. Local variables are allocated on the stack are they not?"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "reply_to_user": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 1, "creation_date": 1522837457, "post_id": 49648343, "comment_id": 86305149, "body": "@KerrekSB If variables count as allocation, recursive function calls must count as well. They eat up much more stack memory than a few variables for a non-recursive approach."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 3, "creation_date": 1522837999, "post_id": 49648343, "comment_id": 86305472, "body": "Beyond no malloc/calloc I suppose they also meant no VLA&#39;s. Ultimately, I think the requirement would have been better expressed as &quot;your memory usage should be O(1)&quot;, i.e. independent of the input size."}, {"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "reply_to_user": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1522843867, "post_id": 49648343, "comment_id": 86309365, "body": "@Gerhardh: Yes, true, I was thinking that too."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1522845912, "post_id": 49648343, "comment_id": 86310883, "body": "If I see recursive functions - I know someone has no programming experience at all. I do not understand why the recursive evil is still taught as a main solution for many algorithms. So I am not surprised that the interviewer was not impressed."}, {"owner": {"reputation": 59, "user_id": 3678912, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/T057M.png?s=128&g=1", "display_name": "user3678912", "link": "https://stackoverflow.com/users/3678912/user3678912"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 1, "creation_date": 1522846440, "post_id": 49648343, "comment_id": 86311278, "body": "@PeterJ_01 bit rude"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1522848968, "post_id": 49648343, "comment_id": 86313254, "body": "@user3678912 What is rude in it? Your answer shows lack of the programming experience. I did not write anything rude."}, {"owner": {"reputation": 59, "user_id": 3678912, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/T057M.png?s=128&g=1", "display_name": "user3678912", "link": "https://stackoverflow.com/users/3678912/user3678912"}, "edited": false, "score": 0, "creation_date": 1522851472, "post_id": 49648343, "comment_id": 86315301, "body": "&quot;no programming experience at all&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 355, "user_id": 9515951, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-m53-xNkMviQ/AAAAAAAAAAI/AAAAAAAAAW0/rfDtMQwohLs/photo.jpg?sz=128", "display_name": "Umaiki", "link": "https://stackoverflow.com/users/9515951/umaiki"}, "is_accepted": false, "score": 1, "last_activity_date": 1522843302, "creation_date": 1522843302, "answer_id": 49650488, "question_id": 49648343, "link": "https://stackoverflow.com/questions/49648343/what-does-memory-allocation-actually-mean-in-c/49650488#49650488", "title": "What does &quot;memory allocation&quot; actually mean in C", "body": "<p>Allocate memory means you keep for your program an amount of memory situated in the HEAP section. On the contrary, when you don't allocate memory, new variables are stored in the STACK section.</p>\n\n<p>See <a href=\"https://stackoverflow.com/questions/79923/what-and-where-are-the-stack-and-heap\">What and where are the stack and heap?</a></p>\n"}], "owner": {"reputation": 59, "user_id": 3678912, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/T057M.png?s=128&g=1", "display_name": "user3678912", "link": "https://stackoverflow.com/users/3678912/user3678912"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 121, "favorite_count": 0, "closed_date": 1522853019, "answer_count": 1, "score": -4, "last_activity_date": 1522843302, "creation_date": 1522836502, "last_edit_date": 1522836719, "question_id": 49648343, "link": "https://stackoverflow.com/questions/49648343/what-does-memory-allocation-actually-mean-in-c", "closed_reason": "Needs details or clarity", "title": "What does &quot;memory allocation&quot; actually mean in C", "body": "<p>I was in an interview recently where I was given a piece of paper with a few function signatures and asked to fill in the code, I was also instructed not to \"allocate memory\".</p>\n\n<p>The question was relatively simple (Smallest value in a list) so I solved it recursively which the interviewers seemed unimpressed by, they seemed to suggest that I could have declared variables on the stack but i was nervous and regrettably didn't press the interviewer on it. </p>\n\n<p>What does it mean to \"allocate\" memory in C? </p>\n"}, {"tags": ["c", "arrays", "memory", "memory-management"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 1, "creation_date": 1522836599, "post_id": 49648301, "comment_id": 86304589, "body": "filling only ONE of two arrays and then incrementing a shared <code>index</code> looks a bit fishy to me, sure this is what you want to do?"}, {"owner": {"reputation": 4165, "user_id": 7489488, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/d045abb9b1a093eef729729702d11cea?s=128&d=identicon&r=PG&f=1", "display_name": "p4t", "link": "https://stackoverflow.com/users/7489488/p4t"}, "edited": false, "score": 0, "creation_date": 1522837028, "post_id": 49648301, "comment_id": 86304873, "body": "I guess I used the same index since I thought I could reset it once the first was filled and didn&#39;t think it was too big of an issue. Are you saying that using a separate index would make it more readable and less confusing?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1522837134, "post_id": 49648301, "comment_id": 86304941, "body": "I just say your code will leave <code>0</code> bytes in your <code>str1</code> and <code>str2</code>."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1522837359, "post_id": 49648301, "comment_id": 86305092, "body": "you don&#39;t initialise <code>str2</code>, but <code>str1</code> twice."}], "answers": [{"comments": [{"owner": {"reputation": 4165, "user_id": 7489488, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/d045abb9b1a093eef729729702d11cea?s=128&d=identicon&r=PG&f=1", "display_name": "p4t", "link": "https://stackoverflow.com/users/7489488/p4t"}, "edited": false, "score": 0, "creation_date": 1522836558, "post_id": 49648345, "comment_id": 86304566, "body": "Facepalm, I&#39;m an idiot. Thanks for the quick pickup."}], "tags": [], "owner": {"reputation": 17175, "user_id": 1756636, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/92f14a1f21e57ba761c7163b2d00a78a?s=128&d=identicon&r=PG&f=1", "display_name": "SomeWittyUsername", "link": "https://stackoverflow.com/users/1756636/somewittyusername"}, "is_accepted": false, "score": 4, "last_activity_date": 1522836504, "creation_date": 1522836504, "answer_id": 49648345, "question_id": 49648301, "link": "https://stackoverflow.com/questions/49648301/why-does-my-array-still-contain-garbage-values-even-after-clearing-them-in-c/49648345#49648345", "title": "Why does my array still contain garbage values even after &quot;clearing&quot; them in C", "body": "<p>You have a typo and instead of zeroing the second string you're zeroing the first one twice.</p>\n"}, {"comments": [{"owner": {"reputation": 17175, "user_id": 1756636, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/92f14a1f21e57ba761c7163b2d00a78a?s=128&d=identicon&r=PG&f=1", "display_name": "SomeWittyUsername", "link": "https://stackoverflow.com/users/1756636/somewittyusername"}, "edited": false, "score": 0, "creation_date": 1522836760, "post_id": 49648364, "comment_id": 86304717, "body": "As a sidenote: 0 is redundant in {0}"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 17175, "user_id": 1756636, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/92f14a1f21e57ba761c7163b2d00a78a?s=128&d=identicon&r=PG&f=1", "display_name": "SomeWittyUsername", "link": "https://stackoverflow.com/users/1756636/somewittyusername"}, "edited": false, "score": 1, "creation_date": 1522836789, "post_id": 49648364, "comment_id": 86304738, "body": "@SomeWittyUsername: It&#39;s required in C. In C++ you can write <code>{}</code>."}, {"owner": {"reputation": 4165, "user_id": 7489488, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/d045abb9b1a093eef729729702d11cea?s=128&d=identicon&r=PG&f=1", "display_name": "p4t", "link": "https://stackoverflow.com/users/7489488/p4t"}, "edited": false, "score": 0, "creation_date": 1522836839, "post_id": 49648364, "comment_id": 86304766, "body": "Do you mind elaborating on why you would do this rather than memsetting? Your solution and memset was provided in the following SO post but I&#39;m not sure why one would pick one over the other <a href=\"https://stackoverflow.com/questions/632846/clearing-a-char-array-c\" title=\"clearing a char array c\">stackoverflow.com/questions/632846/clearing-a-char-array-c</a>"}, {"owner": {"reputation": 17175, "user_id": 1756636, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/92f14a1f21e57ba761c7163b2d00a78a?s=128&d=identicon&r=PG&f=1", "display_name": "SomeWittyUsername", "link": "https://stackoverflow.com/users/1756636/somewittyusername"}, "edited": false, "score": 0, "creation_date": 1522836936, "post_id": 49648364, "comment_id": 86304822, "body": "@Bathsheba Correct, my mistake"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 17175, "user_id": 1756636, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/92f14a1f21e57ba761c7163b2d00a78a?s=128&d=identicon&r=PG&f=1", "display_name": "SomeWittyUsername", "link": "https://stackoverflow.com/users/1756636/somewittyusername"}, "edited": false, "score": 0, "creation_date": 1522837020, "post_id": 49648364, "comment_id": 86304869, "body": "@SomeWittyUsername: This subtle difference between C and C++ goes down a hoot in a pub quiz."}, {"owner": {"reputation": 4165, "user_id": 7489488, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/d045abb9b1a093eef729729702d11cea?s=128&d=identicon&r=PG&f=1", "display_name": "p4t", "link": "https://stackoverflow.com/users/7489488/p4t"}, "edited": false, "score": 0, "creation_date": 1522837083, "post_id": 49648364, "comment_id": 86304913, "body": "@Bathsheba thanks for the clarification"}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 1, "last_activity_date": 1522836986, "last_edit_date": 1522836986, "creation_date": 1522836576, "answer_id": 49648364, "question_id": 49648301, "link": "https://stackoverflow.com/questions/49648301/why-does-my-array-still-contain-garbage-values-even-after-clearing-them-in-c/49648364#49648364", "title": "Why does my array still contain garbage values even after &quot;clearing&quot; them in C", "body": "<p>Ditch the <code>memset</code> calls (one of them has a typo as you are setting the same array twice), and write</p>\n\n<pre><code>char str1[MAX_LINE_LEN] = {0};\n</code></pre>\n\n<p>&amp;c. instead. That will zero-initialise all the elements in the array. This is superior to using <code>memset</code>:</p>\n\n<ol>\n<li>It reduces the possibility for bugs such as the one you have.</li>\n<li><code>str1</code> and <code>str2</code> are never in an uninitialised state.</li>\n<li>You don't have to repeat the length of the array or conjure an expression (e.g. <code>sizeof</code> idioms) to impute it.</li>\n</ol>\n\n<p>Reference for (3): <a href=\"https://en.wikipedia.org/wiki/Don%27t_repeat_yourself\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/Don%27t_repeat_yourself</a></p>\n"}], "owner": {"reputation": 4165, "user_id": 7489488, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/d045abb9b1a093eef729729702d11cea?s=128&d=identicon&r=PG&f=1", "display_name": "p4t", "link": "https://stackoverflow.com/users/7489488/p4t"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 628, "favorite_count": 0, "closed_date": 1522837180, "answer_count": 2, "score": 0, "last_activity_date": 1522836986, "creation_date": 1522836384, "question_id": 49648301, "link": "https://stackoverflow.com/questions/49648301/why-does-my-array-still-contain-garbage-values-even-after-clearing-them-in-c", "closed_reason": "Not suitable for this site", "title": "Why does my array still contain garbage values even after &quot;clearing&quot; them in C", "body": "<p>I am trying to obtain the first two strings from the first line of stdin using the following code.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt; // for memset\n\nint main(void) {\n\n    #define MAX_LINE_LEN 20\n\n    char heightWidth[MAX_LINE_LEN]; // allocate 50 chars to heightWidth\n    memset(heightWidth, 0, MAX_LINE_LEN);\n\n    fgets(heightWidth, MAX_LINE_LEN, stdin); // first line stored in heightWidth\n\n    char str1[MAX_LINE_LEN];\n    char str2[MAX_LINE_LEN];\n    memset(str1, 0, MAX_LINE_LEN);\n    memset(str1, 0, MAX_LINE_LEN);\n\n    int index = 0; // stores the current char index of str array\n    int strNumber = 1;\n    char currChar;\n    for (int i = 0; i &lt; MAX_LINE_LEN; i++) {\n        if (strNumber &gt; 2) { // if we've read two strings, break\n            break;\n        }\n        currChar = heightWidth[i]; // asssign current char to currChar\n        if (currChar == ' ') { // if current character is a space, continue\n            strNumber++; // increment strNumber\n            index = 0; // reset the index\n            continue;\n        }\n        // otherwise add it to one of our arrays\n        if (strNumber == 1) {\n            str1[index] = currChar;\n        } else {\n            str2[index] = currChar;\n        }\n        index++; // increment index\n    }\n    puts(str1);\n    puts(str2);\n    return 0;\n}\n</code></pre>\n\n<p>However, when I enter three space separated strings or more, I sometimes get garbage values appended to the second string. </p>\n\n<pre><code>asdf 234 sdf // user input\nasdf // first string printed is ok\n234\ufffd\ufffd // second string has garbage appended\n</code></pre>\n\n<p>I initially though this was because the memory allocated to those arrays still had their previous values in them (hence my use of memset to \"clear\" them) but adding memset didn't seem to fix my issue.</p>\n\n<p><strong>What is the problem here and how can I edit my code to obtain two strings that are space separated?</strong></p>\n"}, {"tags": ["c", "linked-list", "segmentation-fault", "malloc"], "comments": [{"owner": {"reputation": 2048, "user_id": 4961259, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9b82c25cbde4d52888e6eccc44764b80?s=128&d=identicon&r=PG&f=1", "display_name": "Kami Kaze", "link": "https://stackoverflow.com/users/4961259/kami-kaze"}, "edited": false, "score": 5, "creation_date": 1522835978, "post_id": 49648018, "comment_id": 86304151, "body": "please post your code here and not as an image"}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 1, "creation_date": 1522848196, "post_id": 49648018, "comment_id": 86312630, "body": "Please <a href=\"https://stackoverflow.com/posts/49648018/edit\">edit</a> your question to show us what kind of debugging you&#39;ve done.  I expect you to have run your <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> within Valgrind or a similar checker, and to have investigated with a debugger such as GDB, for example.  Ensure you&#39;ve enabled a full set of compiler warnings, too.  What did the tools tell you, and what information are they missing?  And read Eric Lippert&#39;s <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">How to debug small programs</a>."}, {"owner": {"reputation": 611, "user_id": 4975410, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/CThkY.jpg?s=128&g=1", "display_name": "Saeed Rahmani", "link": "https://stackoverflow.com/users/4975410/saeed-rahmani"}, "reply_to_user": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1522848643, "post_id": 49648018, "comment_id": 86312990, "body": "@TobySpeight Ok. But I do not familiar with some of them that you mentioned. I am using NetBeans. The problem is out of memory access. When I use <code>malloc</code> after a long time it returns <code>Null</code>. IS there any way to share my code completely and talk about it?"}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1522848939, "post_id": 49648018, "comment_id": 86313219, "body": "If <code>malloc()</code> returns <code>NULL</code> that means it can&#39;t allocate any memory for you.  You can&#39;t use the returned null pointer for anything.  You might be able to find a configurable <code>malloc</code> to stress your code (or just <code>ulimit</code> your process&#39;s memory so that it can fail on a small example program)."}, {"owner": {"reputation": 611, "user_id": 4975410, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/CThkY.jpg?s=128&g=1", "display_name": "Saeed Rahmani", "link": "https://stackoverflow.com/users/4975410/saeed-rahmani"}, "reply_to_user": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1522852156, "post_id": 49648018, "comment_id": 86315875, "body": "@TobySpeight But when I see the <code>Memory</code> usage percent in <code>Task Manager</code> it is near 68%! And so there is capacity!"}, {"owner": {"reputation": 611, "user_id": 4975410, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/CThkY.jpg?s=128&g=1", "display_name": "Saeed Rahmani", "link": "https://stackoverflow.com/users/4975410/saeed-rahmani"}, "reply_to_user": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1522852813, "post_id": 49648018, "comment_id": 86316465, "body": "@TobySpeight What do you think about the second struct without <code>path_tail</code>? But I think everytime I must read all list to access the last node to add a new node. Is it correct?"}], "answers": [{"comments": [{"owner": {"reputation": 611, "user_id": 4975410, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/CThkY.jpg?s=128&g=1", "display_name": "Saeed Rahmani", "link": "https://stackoverflow.com/users/4975410/saeed-rahmani"}, "edited": false, "score": 0, "creation_date": 1522835813, "post_id": 49648057, "comment_id": 86304011, "body": "Why for a small file is correct? What should I do?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 1, "creation_date": 1522835995, "post_id": 49648057, "comment_id": 86304167, "body": "1. add error checking, so your program can give a meaningful error instead of just crashing when memory runs out, 2. try not tu use more memory than available."}, {"owner": {"reputation": 2244, "user_id": 5520680, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/C1jQH.png?s=128&g=1", "display_name": "Tom&#39;s", "link": "https://stackoverflow.com/users/5520680/toms"}, "edited": false, "score": 0, "creation_date": 1522836125, "post_id": 49648057, "comment_id": 86304254, "body": "And if you can, try to have a ligth struct for your linked list (I don&#39;t know how you have declared your structure)"}, {"owner": {"reputation": 611, "user_id": 4975410, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/CThkY.jpg?s=128&g=1", "display_name": "Saeed Rahmani", "link": "https://stackoverflow.com/users/4975410/saeed-rahmani"}, "edited": false, "score": 0, "creation_date": 1522836275, "post_id": 49648057, "comment_id": 86304347, "body": "Yes, it has <code>out of memory</code> error and temp is NULL. Is there any way to share my code and talk about it?"}, {"owner": {"reputation": 611, "user_id": 4975410, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/CThkY.jpg?s=128&g=1", "display_name": "Saeed Rahmani", "link": "https://stackoverflow.com/users/4975410/saeed-rahmani"}, "edited": false, "score": 0, "creation_date": 1522836397, "post_id": 49648057, "comment_id": 86304439, "body": "I checked it and it returns <code>12 errno</code>."}], "tags": [], "owner": {"reputation": 7975, "user_id": 5660517, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/1iIxK.jpg?s=128&g=1", "display_name": "Ronan Boiteau", "link": "https://stackoverflow.com/users/5660517/ronan-boiteau"}, "is_accepted": true, "score": 4, "last_activity_date": 1522848974, "last_edit_date": 1522848974, "creation_date": 1522835742, "answer_id": 49648057, "question_id": 49648018, "link": "https://stackoverflow.com/questions/49648018/segmentation-fault-in-c-when-process-large-scale-files/49648057#49648057", "title": "Segmentation fault in C when process large scale files", "body": "<p><strong>This means <code>malloc()</code> failed and returned <code>NULL</code>.</strong> This is probably happening because you're <strong>out of memory</strong>.</p>\n\n<hr>\n\n<p>From <a href=\"https://linux.die.net/man/3/malloc\" rel=\"nofollow noreferrer\"><strong><code>malloc()</code>'s man pages</strong></a>:</p>\n\n<blockquote>\n  <p>The <code>malloc()</code> and <code>calloc()</code> functions return a pointer to the allocated memory that is suitably aligned for any kind of variable. <strong>On error, these functions return <code>NULL</code>.</strong></p>\n</blockquote>\n\n<p>You can check <code>malloc()</code>'s return value and handle this case so that your program doesn't segfault:</p>\n\n<pre><code>if ((temp = malloc(sizeof(struct path))) == NULL)\n  {\n    printf(\"%s\", \"malloc() failed!\");\n    // Clean exit?\n  }\n</code></pre>\n\n<p>You could also use <a href=\"https://en.wikipedia.org/wiki/Errno.h\" rel=\"nofollow noreferrer\"><strong>errno</strong></a> for error handling.</p>\n\n<hr>\n"}, {"tags": [], "owner": {"reputation": 2244, "user_id": 5520680, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/C1jQH.png?s=128&g=1", "display_name": "Tom&#39;s", "link": "https://stackoverflow.com/users/5520680/toms"}, "is_accepted": false, "score": 1, "last_activity_date": 1523301062, "last_edit_date": 1523301062, "creation_date": 1522835782, "answer_id": 49648077, "question_id": 49648018, "link": "https://stackoverflow.com/questions/49648018/segmentation-fault-in-c-when-process-large-scale-files/49648077#49648077", "title": "Segmentation fault in C when process large scale files", "body": "<p>The main reason for why a call to <code>malloc</code> returns <code>NULL</code>?</p>\n\n<p>Well, not enough memory.</p>\n\n<p>But you know, you can keep yourself out of this kind of pain by checking the return value of your <code>malloc</code> call and if it fails, print why it has failed.</p>\n\n<p>Use <code>errno</code> (and <code>strerror</code>).</p>\n"}], "owner": {"reputation": 611, "user_id": 4975410, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/CThkY.jpg?s=128&g=1", "display_name": "Saeed Rahmani", "link": "https://stackoverflow.com/users/4975410/saeed-rahmani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 318, "favorite_count": 0, "closed_date": 1522860245, "accepted_answer_id": 49648057, "answer_count": 2, "score": -3, "last_activity_date": 1523301062, "creation_date": 1522835628, "last_edit_date": 1522852674, "question_id": 49648018, "link": "https://stackoverflow.com/questions/49648018/segmentation-fault-in-c-when-process-large-scale-files", "closed_reason": "Not suitable for this site", "title": "Segmentation fault in C when process large scale files", "body": "<p>I wrote a program to work with large scale files (as graph). I used a linked list for this purpose. When I run it on a small file everything is good and the result is correct. When I run it on large file it has a problem that you can see in the following picture:</p>\n\n<p><a href=\"https://i.stack.imgur.com/5MIvA.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5MIvA.png\" alt=\"Segmentation fault error\"></a></p>\n\n<p>And before the error, <code>temp</code> variable is ok and at each iteration, it has the correct value. But, when the error happens it is <code>0x0</code>!</p>\n\n<p><a href=\"https://i.stack.imgur.com/7mjFV.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7mjFV.png\" alt=\"My code\"></a></p>\n\n<p>What is the main reason for this problem?</p>\n\n<p>The struct that I use it is:</p>\n\n<pre><code>struct path {\n int node;\n struct path *next;\n};\n\n/* Head and Tail for Paths List */\nstruct path *pathHead = NULL;\nstruct path *pathTail = NULL;\n\n/* Path List structure */\nstruct path_list {\n  struct path *path_head;\n  struct path *path_tail;\n  struct path_list *next;\n};\n\n/* Head and Tail for Path List Linked Lists */\nstruct path_list *path_list_head = NULL;\nstruct path_list *path_list_tail = NULL;\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1522835420, "post_id": 49647858, "comment_id": 86303733, "body": "if it&#39;s C source code, it&#39;s very very likely not a <i>script</i>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 2, "creation_date": 1522835476, "post_id": 49647858, "comment_id": 86303762, "body": "And your <code>a</code> is not an array, so what did you expect and <b>why</b>?"}, {"owner": {"reputation": 2048, "user_id": 4961259, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9b82c25cbde4d52888e6eccc44764b80?s=128&d=identicon&r=PG&f=1", "display_name": "Kami Kaze", "link": "https://stackoverflow.com/users/4961259/kami-kaze"}, "edited": false, "score": 1, "creation_date": 1522835482, "post_id": 49647858, "comment_id": 86303765, "body": "in which line do you get the error? And yes what Felix says, why do you treat an int as a string array? Maybe try <code>sheetstore a;</code> instead"}, {"owner": {"reputation": 9, "user_id": 9595867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3adffe0e00fac75d6066142e5b44236c?s=128&d=identicon&r=PG&f=1", "display_name": "point5", "link": "https://stackoverflow.com/users/9595867/point5"}, "edited": false, "score": 0, "creation_date": 1522835659, "post_id": 49647858, "comment_id": 86303907, "body": "I get an error in every line that i use a[i]. how can i declare this so its seen as an array and still stores the information i need?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 4, "creation_date": 1522835849, "post_id": 49647858, "comment_id": 86304043, "body": "Alright, I didn&#39;t even see that global. Well, then it&#39;s time to learn about scopes and shadowing and why to avoid it. While you&#39;re at it, start using <b>meaningful variable names</b>, then such things won&#39;t happen :o"}, {"owner": {"reputation": 2048, "user_id": 4961259, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9b82c25cbde4d52888e6eccc44764b80?s=128&d=identicon&r=PG&f=1", "display_name": "Kami Kaze", "link": "https://stackoverflow.com/users/4961259/kami-kaze"}, "reply_to_user": {"reputation": 6975, "user_id": 3121023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f52448806175b9aa66c86d40cf0829f1?s=128&d=identicon&r=PG&f=1", "display_name": "user3121023", "link": "https://stackoverflow.com/users/3121023/user3121023"}, "edited": false, "score": 0, "creation_date": 1522835850, "post_id": 49647858, "comment_id": 86304045, "body": "@user3121023 Good catch, I totally didn&#39;t see the global declaration..."}, {"owner": {"reputation": 9, "user_id": 9595867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3adffe0e00fac75d6066142e5b44236c?s=128&d=identicon&r=PG&f=1", "display_name": "point5", "link": "https://stackoverflow.com/users/9595867/point5"}, "edited": false, "score": 0, "creation_date": 1522837024, "post_id": 49647858, "comment_id": 86304872, "body": "Does anyone know why when ive made the changes, the if statement has stopped working?"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1522937387, "post_id": 49647858, "comment_id": 86359727, "body": "the posted code does not compile! It causes the compiler to output several &#39;error&#39; messages and several &#39;warning&#39; messages.  Please correct and re-post."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1522937630, "post_id": 49647858, "comment_id": 86359900, "body": "when calling <code>fopen()</code>, always check (!=NULL) the returned value to assure the operation was successful"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1522938014, "post_id": 49647858, "comment_id": 86360194, "body": "the function: <code>getchar()</code> returns a <code>int</code>, not a <code>char</code>  So this statement: <code>char enter = 0;</code> should be: <code>int enter = 0;</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1522938290, "post_id": 49647858, "comment_id": 86360414, "body": "when calling any of the <code>scanf()</code> family of functions: 1) always check the returned value (not the parameter values) to assure the operation was successful.  2) when using the input format specifiers <code>%s</code> and/or <code>%[...]</code> always include a MAX CHARACTERs modifier that is 1 less than the length of the input buffer.  Because those specifiers always append a NUL byte to the input"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1522938791, "post_id": 49647858, "comment_id": 86360807, "body": "in the struct definition, this field: <code>char comp2[200];;</code> contains a stray semicolon"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1522938916, "post_id": 49647858, "comment_id": 86360900, "body": "regarding: <code>char yes[10] = &quot;yes&quot;;</code> the array <code>yes[]</code> is not used, so should be eliminated"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1522940271, "post_id": 49647858, "comment_id": 86361980, "body": "regarding: <code>fwrite(&amp;a[i], sizeof(a), 1, fp);</code>  this will output the whole array <code>a[]</code> when all that is ready to be output is the first instance of the struct: sheetstore.  Suggest: <code>fwrite(&amp;a[i], sizeof(sheetstore), 1, fp);</code> and be sure to check the returned value (==1) to assure the operation was successful."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1522940810, "post_id": 49647858, "comment_id": 86362405, "body": "this statement: <code>int i, a;</code>  masks the prior definition of <code>a[]</code> &quot;sheetstore a[ARRAYLEN];&quot;.   While correcting this error, strongly suggest using variable names that indicate <code>content</code> or <code>usage</code> (or better, both)"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1522940921, "post_id": 49647858, "comment_id": 86362498, "body": "for ease of readability and understanding: 1) separate code blocks ( <code>for</code> <code>if</code> <code>else</code> <code>while</code> <code>do...while``switch</code> <code>case</code> <code>default</code> ) via a single blank line. 2) follow the axiom: <i>only one statement per line and (at most) one variable declaration per statement.</i>"}], "answers": [{"tags": [], "owner": {"reputation": 610, "user_id": 8979940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DmzYf.jpg?s=128&g=1", "display_name": "Omer Dagan", "link": "https://stackoverflow.com/users/8979940/omer-dagan"}, "is_accepted": false, "score": 1, "last_activity_date": 1522845208, "creation_date": 1522845208, "answer_id": 49651145, "question_id": 49647858, "link": "https://stackoverflow.com/questions/49647858/storing-user-input-whilst-still-asking-questions/49651145#49651145", "title": "Storing user input whilst still asking questions", "body": "<p>the main issue that i saw in your code, is that you shadowed the array <code>a</code> (<code>sheetstore a[ARRAYLEN];</code>) by declaring an <code>int</code> with the same name in your <code>main()</code>. </p>\n\n<p>you also had a <code>scanf</code> stament mislocated.</p>\n\n<p>i fixed your code and put in a comment for every change - now, i don't persume to check the functionality of your code but at least this will compile and hopefully will give you a better understanding where you were wrong - from here it is up to you:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;string.h&gt;\n\nint c_s(char*, char*);\n\ntypedef struct\n{\n    char constab[30];\n    char vicwit[15];\n    char witdet[200];\n    char incdest[300];\n    char comp1[15];\n    char comp2[200];;\n} sheetstore;\n\n#define ARRAYLEN 2\n\nsheetstore sheetArr[ARRAYLEN]; //change this 'a' to avoid shadowing by the decleration on 'int a' in main\nFILE *fp;\n\nint main()\n{\n    int i, a;\n    char wit[10] = \"witness\";\n    char yes[10] = \"yes\";\n    char comp1[10];\n\n    fp = fopen(\"sheetstore.dat\",\"a+\");\n\n    printf(\"Hate crime reporting system\\n\\n\\n\");\n\n    printf(\"If the crime you are reporting is an emergency,\\nplease call 999, do not proceed any further with this form\\n\\n\\n\\nPlease press enter to confirm you have read the above and continue\\n\");\n    char enter = 0;\n    while (enter != '\\r' &amp;&amp; enter != '\\n') { enter = getchar(); }\n\n    for( i=0; i&lt;ARRAYLEN ; i++)\n    {\n        printf(\"Which police constabulary did the offence take place in?\\n\\n\");\n        scanf(\"%s\", sheetArr[i].constab);//change name from 'a'\n        printf(\"Are you a victim or witness of the crime?\\nPlease answer victim/witness\\n\\n\");\n        scanf(\"%s\", sheetArr[i].comp1);//change name from 'a'\n        int res1 = (strcmp (sheetArr[i].comp1, wit));//compare with the value set in the struct\n        if(res1 == 0){\n            printf(\"Please enter the details including phone number and address of any other witnesses that were present\\n\");\n            /*this scanf should be inside the brackets of 'if(res1 == 0)' */\n            scanf(\"%s\", sheetArr[i].witdet);//change name from 'a'\n        }\n        else{\n            printf(\"Where did the incident take place?\\nIf in a house please provide the full address including postcode\\n\");\n            scanf(\"%s\", sheetArr[i].incdest);//change name from 'a'\n        }\n\n        fwrite(&amp;sheetArr[i], sizeof(sheetstore), 1, fp);//write a single struct\n    }\n    fclose(fp);\n\n    fopen(\"sheetstore.dat\", \"r\");\n    for(i=0; i&lt;ARRAYLEN; i++)\n    {\n        fread(&amp;sheetArr[i], sizeof(sheetstore), 1, fp );//read a single struct\n        printf(\"Which police constabulary did the offence take place in? : %s\\n\", sheetArr[i].constab);\n        printf(\"Are you a victim or witness of the crime? : %s\\n\", sheetArr[i].comp1);\n        printf(\"Please enter the details including phone number and address of any other witnesses that were present : %s\\n\", sheetArr[i].witdet);\n        printf(\"Where did the incident take place? : %s\\n\", sheetArr[i].incdest);\n    }\n    fclose(fp);\n\n    return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 509, "user_id": 3487040, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qS36g.jpg?s=128&g=1", "display_name": "eapetcho", "link": "https://stackoverflow.com/users/3487040/eapetcho"}, "edited": false, "score": 0, "creation_date": 1522990234, "post_id": 49675311, "comment_id": 86382241, "body": "your counsels above are very good, but your proposed code will compile properly since you&#39;re using <b>exit</b> and <b>EXIT_FAILURE</b> both of which are in <b>stdlib.h</b>, which you didn&#39;t <i>include</i>. In addition, there is not such <code>array of struct</code> <b>a</b> available in your stack (body of the main function)."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "reply_to_user": {"reputation": 509, "user_id": 3487040, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qS36g.jpg?s=128&g=1", "display_name": "eapetcho", "link": "https://stackoverflow.com/users/3487040/eapetcho"}, "edited": false, "score": 0, "creation_date": 1523019979, "post_id": 49675311, "comment_id": 86399383, "body": "@eapetcho,  coded edited per your comment,  Note the array of struct is still in the global data, as the OP originally placed it,   Also this answer is just for the first (approx) 50 lines of the code, to point the OP in the right direction,  I.E. it is not a complete code"}], "tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": false, "score": 0, "last_activity_date": 1523020246, "last_edit_date": 1523020246, "creation_date": 1522939759, "answer_id": 49675311, "question_id": 49647858, "link": "https://stackoverflow.com/questions/49647858/storing-user-input-whilst-still-asking-questions/49675311#49675311", "title": "Storing user input whilst still asking questions", "body": "<p>The following proposed code:</p>\n\n<ol>\n<li>corrects the first 50+ lines of your code.</li>\n<li>Please correct your posted code so it cleanly compiles</li>\n<li>for flexibility, separates the definition of the struct from the typedef of the struct</li>\n<li>properly checks for error indications from system functions</li>\n<li>honors the right margin (usually 72 or 80 characters)</li>\n<li>replaces the CPU cycle intensive calls to <code>printf()</code> with calls to <code>puts()</code> when appropriate</li>\n<li>This is only a guide for the first 50 lines of the OPs code.  It is not a complete code replacement.</li>\n</ol>\n\n<p>and now the proposed code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\n// prototypes\nint c_s(char*, char*);\n\nstruct sSheet\n{\n    char constab[30];\n    char vicwit[15];\n    char witdet[200];\n    char incdest[300];\n    char comp1[15];\n    char comp2[200];\n};\ntypedef struct sSheet sheetstore;\n\n#define ARRAYLEN 2\n\nsheetstore a[ARRAYLEN];\n\n\nFILE *fp;\n\nint main( void )\n{\n    int i;\n    char wit[10] = \"witness\";\n    //char yes[10] = \"yes\";\n    char comp1[10];\n\n    fp = fopen(\"sheetstore.dat\",\"a+\");\n    if( !fp )\n    {\n        perror( \"fopen for appending to 'sheetstore.dat' failed\" );\n        exit( EXIT_FAILURE );\n    }\n\n    // implied else, fopen successful\n\n    puts(\"Hate crime reporting system\\n\\n\\n\");\n\n    puts(\"If the crime you are reporting is an emergency,\\n\"\n         \"please call 999, \"\n         \" do not proceed any further with this form\\n\\n\\n\\n\"\n         \"Please press enter\"\n         \" to confirm you have read the above and continue\\n\");\n    int enter = 0;\n\n    while (enter != '\\r' &amp;&amp; enter != '\\n')\n    {\n        enter = getchar();\n    }\n\n    for( i=0; i&lt;ARRAYLEN ; i++)\n    {\n        puts(\"Which police constabulary did the offence take place in?\\n\\n\");\n        if( scanf(\"%29s\", a[i].constab) != 1)\n        {\n            fprintf( stderr, \"scanf for which police constabulary failed\" );\n            fclose( fp );  // cleanup\n            exit( EXIT_FAILURE );\n        }\n\n        // implied else, scanf successful\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 509, "user_id": 3487040, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qS36g.jpg?s=128&g=1", "display_name": "eapetcho", "link": "https://stackoverflow.com/users/3487040/eapetcho"}, "is_accepted": false, "score": 0, "last_activity_date": 1522989853, "creation_date": 1522989853, "answer_id": 49685451, "question_id": 49647858, "link": "https://stackoverflow.com/questions/49647858/storing-user-input-whilst-still-asking-questions/49685451#49685451", "title": "Storing user input whilst still asking questions", "body": "<p>In addition to some useful comments posted above (meaningful variable names, line width not to be too long for readability), in general sense, your problem is due to two thing: in the body of the <strong>main</strong> function you declare an <strong>int  a</strong> which is used instead of your global array <strong>a[ARRAYLEN]</strong>. Hence, you cannot refence <strong>a[i].incdet</strong> etc. Just comment or remove the <strong>int a</strong> from the <strong>main</strong> function. Secondly, your <strong>scanf(\"%s\", a[i].witdet);</strong> should be in the body of the if statement above according to the program logic. I you do these two changes, the code will compile. However if you pass <strong>-Wall -Werror</strong> to the compiler, it will yields an error like <strong>error: unused variable \u2018yes\u2019 [-Werror=unused-variable]\n     char yes[10] = \"yes\";</strong>. Just comment this line to avoid using uncessary memory space on the stack.    </p>\n"}], "owner": {"reputation": 9, "user_id": 9595867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3adffe0e00fac75d6066142e5b44236c?s=128&d=identicon&r=PG&f=1", "display_name": "point5", "link": "https://stackoverflow.com/users/9595867/point5"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1523020246, "creation_date": 1522835244, "last_edit_date": 1522839873, "question_id": 49647858, "link": "https://stackoverflow.com/questions/49647858/storing-user-input-whilst-still-asking-questions", "title": "Storing user input whilst still asking questions", "body": "<p>Firstly, i know the source code below is long and you're not really supposed to post code like this, but i really don't understand why it's not working or how i could explain my issue without posting it like this. </p>\n\n<p>Im trying to store the answer to each of the questions asked in it and display them at the end of the script. The biggest problem im having is that i get the error<br>\n<code>\"subscripted value is neither array nor pointer nor vector scanf(\"%s\", a[i].incdest);\"</code></p>\n\n<p>The program doesn't accept a[i].incdest. it does this for all of the array values. </p>\n\n<p>it is also saying that in function main variable \"comp1\" is undeclared. </p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;string.h&gt;\n\nint c_s(char*, char*);\n\ntypedef struct\n{\n    char constab[30];\n    char vicwit[15];\n    char witdet[200];\n    char incdest[300];\n    char comp1[15];\n    char comp2[200];;\n} sheetstore;\n\n#define ARRAYLEN 2\n\nsheetstore a[ARRAYLEN];\nFILE *fp;\n\nint main()\n{\n    int i, a;\n    char wit[10] = \"witness\";\n    char yes[10] = \"yes\";\n    char comp1[10];\n\n    fp = fopen(\"sheetstore.dat\",\"a+\");\n\n    printf(\"Hate crime reporting system\\n\\n\\n\");\n\n    printf(\"If the crime you are reporting is an emergency,\\nplease call 999, do not proceed any further with this form\\n\\n\\n\\nPlease press enter to confirm you have read the above and continue\\n\");\n    char enter = 0;\n    while (enter != '\\r' &amp;&amp; enter != '\\n') { enter = getchar(); }\n\n    for( i=0; i&lt;ARRAYLEN ; i++)\n    {\n        printf(\"Which police constabulary did the offence take place in?\\n\\n\");\n        scanf(\"%s\", a[i].constab);\n        printf(\"Are you a victim or witness of the crime?\\nPlease answer victim/witness\\n\\n\");\n        scanf(\"%s\", a[i].comp1);\n        int res1 = (strcmp (comp1, wit));\n        if(res1 == 0){\n            printf(\"Please enter the details including phone number and address of any other witnesses that were present\\n\");\n        }\n        scanf(\"%s\", a[i].witdet);\n        else{\n            printf(\"Where did the incident take place?\\nIf in a house please provide the full address including postcode\\n\");\n            scanf(\"%s\", a[i].incdest);\n        }\n\n        fwrite(&amp;a[i], sizeof(a), 1, fp);\n    }\n    fclose(fp);\n\n    fopen(\"sheetstore.dat\", \"r\");\n    for(i=0; i&lt;ARRAYLEN; i++)\n    {\n        fread(&amp;a[i], sizeof(a), 1, fp );\n        printf(\"Which police constabulary did the offence take place in? : %s\\n\", a[i].constab);\n        printf(\"Are you a victim or witness of the crime? : %s\\n\", a[i].comp1);\n        printf(\"Please enter the details including phone number and address of any other witnesses that were present : %s\\n\", a[i].witdet);\n        printf(\"Where did the incident take place? : %s\\n\", a[i].incdest);\n    }\n    fclose(fp);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "multidimensional-array", "size"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 1, "creation_date": 1522834970, "post_id": 49647627, "comment_id": 86303429, "body": "first of all, <code>sizeof(char)</code> is by definition <code>1</code>. Then, your <code>params</code> is an array of pointers, which you overwrite with your <code>memcpy()</code>, this is just undefined behavior. Anything can happen, even what you expected -- your program is still horribly broken."}, {"owner": {"reputation": 764, "user_id": 4791682, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lzGgn.png?s=128&g=1", "display_name": "ci7i2en4", "link": "https://stackoverflow.com/users/4791682/ci7i2en4"}, "edited": false, "score": 0, "creation_date": 1522835046, "post_id": 49647627, "comment_id": 86303481, "body": "So, what would be the best way to copy the content of tmp to params?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1522835129, "post_id": 49647627, "comment_id": 86303535, "body": "So, what <b>is</b> <code>tmp</code>? I can&#39;t figure out what you&#39;re actually <i>trying</i> to accomplish with that code..."}, {"owner": {"reputation": 3002, "user_id": 4228131, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RyKUe.jpg?s=128&g=1", "display_name": "WedaPashi", "link": "https://stackoverflow.com/users/4228131/wedapashi"}, "edited": false, "score": 0, "creation_date": 1522835292, "post_id": 49647627, "comment_id": 86303645, "body": "Not entirely related, but if I had written this code, it would have at least checked if <code>calloc()</code> returned anything other than <code>NULL</code>."}, {"owner": {"reputation": 764, "user_id": 4791682, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lzGgn.png?s=128&g=1", "display_name": "ci7i2en4", "link": "https://stackoverflow.com/users/4791682/ci7i2en4"}, "edited": false, "score": 0, "creation_date": 1522835308, "post_id": 49647627, "comment_id": 86303658, "body": "The goal is to get all 6 key: value pairs from parseFile() such that I can access the keys and values individually. I thought that by passing an empty two-dimensional array (tmp) to the function, let the function fill and return it, and then copying it to another local two-dimensional array in main(), I could work with the latter array."}, {"owner": {"reputation": 764, "user_id": 4791682, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lzGgn.png?s=128&g=1", "display_name": "ci7i2en4", "link": "https://stackoverflow.com/users/4791682/ci7i2en4"}, "reply_to_user": {"reputation": 3002, "user_id": 4228131, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RyKUe.jpg?s=128&g=1", "display_name": "WedaPashi", "link": "https://stackoverflow.com/users/4228131/wedapashi"}, "edited": false, "score": 0, "creation_date": 1522835409, "post_id": 49647627, "comment_id": 86303725, "body": "@WedaPashi The code produces the desired result every time I run it, and I have run it many times already. This is not meant to be an excuse but because of that it just didn&#39;t occur to me until now that something could be wrong with it. I&#39;m happy to hear suggestions on how to improve it."}, {"owner": {"reputation": 764, "user_id": 4791682, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lzGgn.png?s=128&g=1", "display_name": "ci7i2en4", "link": "https://stackoverflow.com/users/4791682/ci7i2en4"}, "edited": false, "score": 0, "creation_date": 1522835895, "post_id": 49647627, "comment_id": 86304081, "body": "When I saw that 384 didn&#39;t work, I started trying other values that would make any sense in the given mathematical context. 56 was the first and only value that led to a working code. PARAMS is the number of keys and values in the file I&#39;m reading in parseFile(). PARAMS/2 would be the number of key: value pairs."}, {"owner": {"reputation": 764, "user_id": 4791682, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lzGgn.png?s=128&g=1", "display_name": "ci7i2en4", "link": "https://stackoverflow.com/users/4791682/ci7i2en4"}, "edited": false, "score": 0, "creation_date": 1522835963, "post_id": 49647627, "comment_id": 86304142, "body": "sizeof(char *) is 8 byte"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1522836365, "post_id": 49647627, "comment_id": 86304413, "body": "@4386427 and then it would be a shallow copy at best, overwriting the pointers that were assigned with <code>params[i] = (char *)calloc(32, sizeof(char))</code>, therefore leaking memory ... so I still can&#39;t make sense out of that code (I doubt it does what was intended)."}, {"owner": {"reputation": 764, "user_id": 4791682, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lzGgn.png?s=128&g=1", "display_name": "ci7i2en4", "link": "https://stackoverflow.com/users/4791682/ci7i2en4"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1522836420, "post_id": 49647627, "comment_id": 86304458, "body": "@4386427 I have added the part where tmp is updated to the code, please see the original posting."}, {"owner": {"reputation": 764, "user_id": 4791682, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lzGgn.png?s=128&g=1", "display_name": "ci7i2en4", "link": "https://stackoverflow.com/users/4791682/ci7i2en4"}, "edited": false, "score": 0, "creation_date": 1522836485, "post_id": 49647627, "comment_id": 86304509, "body": "@FelixPalmen Like I said, the code gets me exactly the desired result every time I run my program. But if you do know how to correct what you believe to be wrong, I would be more than happy to hear it."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1522836658, "post_id": 49647627, "comment_id": 86304642, "body": "@ci7i2en4 I can&#39;t tell you because I still don&#39;t get the <i>intention</i> behind that code.... Code doing what you expect doesn&#39;t mean anything in C :o"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1522836930, "post_id": 49647627, "comment_id": 86304815, "body": "@4386427 so do I, but maybe in this case, a concise description of the use case would tell more than this weird code ;)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1522837181, "post_id": 49647627, "comment_id": 86304965, "body": "@ci7i2en4 a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> could help as well, including a <i>sample input</i> and the <i>desired output</i>..."}, {"owner": {"reputation": 764, "user_id": 4791682, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lzGgn.png?s=128&g=1", "display_name": "ci7i2en4", "link": "https://stackoverflow.com/users/4791682/ci7i2en4"}, "edited": false, "score": 0, "creation_date": 1522839517, "post_id": 49647627, "comment_id": 86306466, "body": "I have added the use case to my original posting."}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1522848774, "post_id": 49647627, "comment_id": 86313100, "body": "Please read and understand <a href=\"/q/605845\">the question on why not to cast the return value of <code>malloc()</code> and family in C</a>."}], "answers": [{"comments": [{"owner": {"reputation": 764, "user_id": 4791682, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lzGgn.png?s=128&g=1", "display_name": "ci7i2en4", "link": "https://stackoverflow.com/users/4791682/ci7i2en4"}, "edited": false, "score": 0, "creation_date": 1522839403, "post_id": 49648622, "comment_id": 86306399, "body": "You are starting to see what I want but I think I&#39;m already ahead of you: I&#39;m not trying to copy the pairs, I&#39;m already trying to copy a key, than (to the next position of the array) a value, a key, a value, ... until I have all parameters. Ultimately, I need an array (params) that looks like: params[0] = key1, params[1] = value1, params[2] = key2, etc."}, {"owner": {"reputation": 764, "user_id": 4791682, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lzGgn.png?s=128&g=1", "display_name": "ci7i2en4", "link": "https://stackoverflow.com/users/4791682/ci7i2en4"}, "edited": false, "score": 0, "creation_date": 1522839685, "post_id": 49648622, "comment_id": 86306574, "body": "^^ If we imagine this two-dimensional array with an x and y axis, my thought was that I have 12 (PARAMS macro) elements (pointers to char arrays) on the x axis, and each of those elements has 32 byte on the y axis as this is the amount of memory I&#39;m allocating (for each array within the one holding the char pointers)."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "reply_to_user": {"reputation": 764, "user_id": 4791682, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lzGgn.png?s=128&g=1", "display_name": "ci7i2en4", "link": "https://stackoverflow.com/users/4791682/ci7i2en4"}, "edited": false, "score": 0, "creation_date": 1522840172, "post_id": 49648622, "comment_id": 86306906, "body": "@ci7i2en4 Well, you can see it like that. But it&#39;s more common to talk about rows and columns. You would have 12 rows, each with 32 columns."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "reply_to_user": {"reputation": 764, "user_id": 4791682, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lzGgn.png?s=128&g=1", "display_name": "ci7i2en4", "link": "https://stackoverflow.com/users/4791682/ci7i2en4"}, "edited": false, "score": 0, "creation_date": 1522840295, "post_id": 49648622, "comment_id": 86306989, "body": "@ci7i2en4 BTW: Why do you have both <code>tmp</code> and <code>params</code>? Why don&#39;t you read directly into <code>params</code>? Another thing - since you deal with key:value pairs, why not define a struct with a key and a value"}, {"owner": {"reputation": 764, "user_id": 4791682, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lzGgn.png?s=128&g=1", "display_name": "ci7i2en4", "link": "https://stackoverflow.com/users/4791682/ci7i2en4"}, "edited": false, "score": 0, "creation_date": 1522840383, "post_id": 49648622, "comment_id": 86307058, "body": "Yes, you are right. In any case it&#39;s a two-dimensional matrix and those do have rows and columns. I&#39;m still trying to figure out your solution, and how it differs from what I&#39;m doing. I thought that I had already allocated two 2D arrays (params, tmp), one of which I pass to parseFile()?!"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "reply_to_user": {"reputation": 764, "user_id": 4791682, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lzGgn.png?s=128&g=1", "display_name": "ci7i2en4", "link": "https://stackoverflow.com/users/4791682/ci7i2en4"}, "edited": false, "score": 0, "creation_date": 1522841130, "post_id": 49648622, "comment_id": 86307501, "body": "@ci7i2en4 You don&#39;t allocate a 2D array. You allocate a 1D array of 12 pointers. Then you set each of these pointers to point a 1D array of 32 chars. Functionally yours can be used as a 2D array (i.e. array[x][y]) but memory wise the layout is very different. A 2D array use a single contiguous memory area. Your method uses 13 different memory areas (which is why you can&#39;t do the memcpy)"}, {"owner": {"reputation": 764, "user_id": 4791682, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lzGgn.png?s=128&g=1", "display_name": "ci7i2en4", "link": "https://stackoverflow.com/users/4791682/ci7i2en4"}, "edited": false, "score": 0, "creation_date": 1522841302, "post_id": 49648622, "comment_id": 86307616, "body": "Okay, now I finally understand what the problem is! Thank you. I was (wrongly) assuming that my params and tmp arrays were being allocated as matrixes, one area in memory for each matrix. But now I see that the 12 arrays (the pointer array is pointing to) each can be anywhere ... So, the solution, as you have pointed out, is either using two true 2D arrays, or structs. I&#39;ll try that."}], "tags": [], "owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "is_accepted": true, "score": 1, "last_activity_date": 1522838009, "last_edit_date": 1522838009, "creation_date": 1522837381, "answer_id": 49648622, "question_id": 49647627, "link": "https://stackoverflow.com/questions/49647627/how-does-this-array-size-come-about/49648622#49648622", "title": "How does this array size come about?", "body": "<p>I assume that your aim is to copy all key:value pairs from <code>tmp</code> to <code>params</code>.</p>\n\n<p>You can't copy all the key:value pairs from <code>tmp</code> to <code>params</code> with a single <code>memcpy</code>. You can't be sure that <code>malloc</code> have given you two consecutive memory areas.</p>\n\n<p>You have to copy the strings one-by-one.</p>\n\n<pre><code>parseFile(tmp, argv[1]);\nfor (i=0; i&lt;PARAMS; i++) {\n    memcpy(params[i], tmp[i], 32);\n}\n</code></pre>\n\n<p>In order to get two consecutive memory areas (so that you can copy with a single <code>memcpy</code>), you need to allocate the variables as 2D arrays (<a href=\"https://stackoverflow.com/a/40847465/4386427\">https://stackoverflow.com/a/40847465/4386427</a> and <a href=\"https://stackoverflow.com/a/42094467/4386427\">https://stackoverflow.com/a/42094467/4386427</a>).</p>\n"}], "owner": {"reputation": 764, "user_id": 4791682, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lzGgn.png?s=128&g=1", "display_name": "ci7i2en4", "link": "https://stackoverflow.com/users/4791682/ci7i2en4"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 163, "favorite_count": 0, "accepted_answer_id": 49648622, "answer_count": 1, "score": 0, "last_activity_date": 1522839184, "creation_date": 1522834691, "last_edit_date": 1522839184, "question_id": 49647627, "link": "https://stackoverflow.com/questions/49647627/how-does-this-array-size-come-about", "title": "How does this array size come about?", "body": "<p>I have managed to produced a code that works perfectly fine and does exactly what it should. My problem is: I absolutely don't understand why. In my understanding it should NOT work.</p>\n\n<pre><code>#define PARAMS 12\n\nchar** parseFile(char* tmp[], char* location) {\n\n    // Parse a file at &lt;location&gt; and retrieve 6 key: value pairs from it.\n    // All key: value pairs are stored in tmp, resulting in an array of\n    // 12 char pointers, each pointing to a char array that contains either\n    // a key or a value.\n\n    // ...\n\n    do {\n        yaml_parser_scan(&amp;parser, &amp;token);\n        if (token.type == YAML_SCALAR_TOKEN &amp;&amp; i&lt;PARAMS) {\n            strcpy(tmp[i], (char*)token.data.scalar.value);\n            i++;\n        }\n        if (token.type != YAML_STREAM_END_TOKEN) {\n            yaml_token_delete(&amp;token);\n        }\n    } while (token.type != YAML_STREAM_END_TOKEN);\n\n    // ...\n\n    return tmp;\n}\n\nint main(int argc, char* argv[]) {\n    int i=0;\n    char **tmp = (char **)calloc(PARAMS, sizeof(char *));\n    char **params = (char **)calloc(PARAMS, sizeof(char *));\n    for (i=0; i&lt;PARAMS; i++) {\n        tmp[i] = (char *)calloc(32, sizeof(char));\n        params[i] = (char *)calloc(32, sizeof(char));\n    }\n\n    memcpy(params, parseFile(tmp, argv[1]), sizeof(char) * 56); // WHY 56?\n    for (i=0; i&lt;PARAMS; i++) {\n        printf(\"PARAM_[%d] = %s\\n\", i, params[i]);\n    }\n\n    free(tmp);\n    free(params);\n\n    return 0;\n}\n</code></pre>\n\n<p>I could swear that I would have to specify a size of <code>sizeof(char) * 384</code> (1 * 12 * 32) in memcpy for the code to work. But if I do, it doesn't. It only works and produces the correct result if I specify <code>sizeof(char) * 56</code>. Why 56? What's that value supposed to mean? I do realise that I have 6 key: value pairs and that 6 * 8 + 8 is 56, but I still don't get it.</p>\n\n<p><strong>[EDIT]</strong></p>\n\n<p>The use case is this:</p>\n\n<p>The program connects to a server based on connection parameters (IP address, port) that are provided in a yaml configuration file. A minimalistic version of that file could look like this:</p>\n\n<pre><code>---\n  # Connection parameters\n  tx_addr: 192.168.1.124\n  tx_port: 8080\n</code></pre>\n\n<p>The program needs the values of the key:value pairs as those are passed to functions which establish the connection to the server. So, what I need to do is to parse the configuration file and look for allowed keys (the parameters could be anything; I only know the keys). E.g., if the key \"tx_addr\" is found, the program knows that the value to that key shall be passed as the IP address parameter of the functions establishing the server connection.</p>\n"}, {"tags": ["c", "input", "exit"], "comments": [{"owner": {"reputation": 4031, "user_id": 7640269, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/szGUJ.png?s=128&g=1", "display_name": "danglingpointer", "link": "https://stackoverflow.com/users/7640269/danglingpointer"}, "edited": false, "score": 1, "creation_date": 1522828033, "post_id": 49645374, "comment_id": 86299002, "body": "Use char format specifier not int."}, {"owner": {"reputation": 6023, "user_id": 2417459, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/QcuXb.png?s=128&g=1", "display_name": "i486", "link": "https://stackoverflow.com/users/2417459/i486"}, "edited": false, "score": 3, "creation_date": 1522828461, "post_id": 49645374, "comment_id": 86299277, "body": "What you expect from <code>%d</code> scanf? It is for numeric value and <code>&#47;</code> is invalid char in this case. Use <code>%c</code>."}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 6498307, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MEEWr.png?s=128&g=1", "display_name": "fremonta", "link": "https://stackoverflow.com/users/6498307/fremonta"}, "edited": false, "score": 0, "creation_date": 1522831931, "post_id": 49645422, "comment_id": 86301325, "body": "Thanks! But this works only when the input is between 0-9."}, {"owner": {"reputation": 7975, "user_id": 5660517, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/1iIxK.jpg?s=128&g=1", "display_name": "Ronan Boiteau", "link": "https://stackoverflow.com/users/5660517/ronan-boiteau"}, "reply_to_user": {"reputation": 41, "user_id": 6498307, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MEEWr.png?s=128&g=1", "display_name": "fremonta", "link": "https://stackoverflow.com/users/6498307/fremonta"}, "edited": false, "score": 0, "creation_date": 1522832021, "post_id": 49645422, "comment_id": 86301387, "body": "Yes. If you want to input multiple characters, then you need to read a string. See the answer from @Mulliganaceous"}], "tags": [], "owner": {"reputation": 7975, "user_id": 5660517, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/1iIxK.jpg?s=128&g=1", "display_name": "Ronan Boiteau", "link": "https://stackoverflow.com/users/5660517/ronan-boiteau"}, "is_accepted": false, "score": 1, "last_activity_date": 1522830921, "last_edit_date": 1522830921, "creation_date": 1522827817, "answer_id": 49645422, "question_id": 49645374, "link": "https://stackoverflow.com/questions/49645374/enter-to-exit-a-program-in-c/49645422#49645422", "title": "Enter &#39;/&#39; to exit a program in C", "body": "<p>If you want to compare against <code>'/'</code>, you should use a <code>char</code> variable, not an <code>int</code>. And so use <code>\"%c\"</code> as <code>scanf()</code>'s format string. Otherwise, <code>scanf()</code> won't read your <code>'/'</code> since it is not an integer.</p>\n\n<p>This snippet will have the behavior you expect:</p>\n\n<pre><code>while (!quit) {\n    char input;\n    scanf(\"%c\", &amp;input);\n    if (input == '/')\n        quit = 1;\n</code></pre>\n\n<hr>\n\n<p>If you read a digit, then you can subtract the ASCII value of <code>0</code> (<code>48</code> or <code>'0'</code>) to your <code>char</code> so you will end up with its <code>int</code> equivalent:</p>\n\n<pre><code>show(input - '0');\nshow(input - 48);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "is_accepted": false, "score": 1, "last_activity_date": 1522828300, "creation_date": 1522828300, "answer_id": 49645575, "question_id": 49645374, "link": "https://stackoverflow.com/questions/49645374/enter-to-exit-a-program-in-c/49645575#49645575", "title": "Enter &#39;/&#39; to exit a program in C", "body": "<p><code>%d</code> in <code>scanf</code> expects an <code>int</code> data type. When you enter <code>'/'</code>, it skips <code>'/'</code> and look for the <code>int</code> data type. It found nothing and this <code>'\\'</code> is left in the buffer. In the next iteration it find the same <code>char</code> type and again skip this character and this cycle goes on causing an infinite loop.</p>\n"}, {"tags": [], "owner": {"reputation": 1390, "user_id": 6804762, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b41e265dcfe306ac9138ed4bca68c0ce?s=128&d=identicon&r=PG", "display_name": "xoxel", "link": "https://stackoverflow.com/users/6804762/xoxel"}, "is_accepted": false, "score": 0, "last_activity_date": 1522828380, "creation_date": 1522828380, "answer_id": 49645603, "question_id": 49645374, "link": "https://stackoverflow.com/questions/49645374/enter-to-exit-a-program-in-c/49645603#49645603", "title": "Enter &#39;/&#39; to exit a program in C", "body": "<p>You should use <code>%c</code> for a single character or <code>%s</code> for a string, <code>%d</code> is looking for a number.</p>\n"}, {"comments": [{"owner": {"reputation": 41, "user_id": 6498307, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MEEWr.png?s=128&g=1", "display_name": "fremonta", "link": "https://stackoverflow.com/users/6498307/fremonta"}, "edited": false, "score": 0, "creation_date": 1522839518, "post_id": 49645868, "comment_id": 86306469, "body": "Thank you for the tip! Now I can exit with &#39;/&#39;, but show() broke. How do I convert my char* input into int so that show() will work?"}, {"owner": {"reputation": 41, "user_id": 6498307, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MEEWr.png?s=128&g=1", "display_name": "fremonta", "link": "https://stackoverflow.com/users/6498307/fremonta"}, "edited": false, "score": 0, "creation_date": 1522840894, "post_id": 49645868, "comment_id": 86307367, "body": "I used atoi(n) - convert array string to int and exit the loop! Thank you so much!"}], "tags": [], "owner": {"reputation": 2267, "user_id": 8242447, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M6884.gif?s=128&g=1", "display_name": "\u1e42\u0173\u1efb\u1ecbg\u01fb\u0148\u1ea1c\u1ec3\u01a1\u1eed\u1e69", "link": "https://stackoverflow.com/users/8242447/%e1%b9%82%c5%b3%e1%bb%bb%e1%bb%8bg%c7%bb%c5%88%e1%ba%a1c%e1%bb%83%c6%a1%e1%bb%ad%e1%b9%a9"}, "is_accepted": true, "score": 1, "last_activity_date": 1532457574, "last_edit_date": 1532457574, "creation_date": 1522829401, "answer_id": 49645868, "question_id": 49645374, "link": "https://stackoverflow.com/questions/49645374/enter-to-exit-a-program-in-c/49645868#49645868", "title": "Enter &#39;/&#39; to exit a program in C", "body": "<p>You have an error regarding the input type inside the while loop:</p>\n\n<pre><code>int input;\nscanf(\"%d\", &amp;input);\n</code></pre>\n\n<p>Entering '/' here causes <em>undefined</em> behavior when it is asking for an int!</p>\n\n<p>Instead, you have to let the input be a <strong>string</strong> (type <code>char *</code>), <strong>check</strong> whether the string equals ('/') either manually or through <code>strncmp(input, \"/\", 1)</code>, check if it represents an integer and then create <strong>another int value</strong> using <code>strtol(input, NULL, 10)</code> to convert to int if your input is valid and does not equal '/'.</p>\n\n<p>Error checking can be involved (unfortunately), such as handling foreign characters, and verifying that your number is in the form of regex -?(\\d) (single optional minus sign before numeric string).</p>\n"}], "owner": {"reputation": 41, "user_id": 6498307, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MEEWr.png?s=128&g=1", "display_name": "fremonta", "link": "https://stackoverflow.com/users/6498307/fremonta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 521, "favorite_count": 0, "accepted_answer_id": 49645868, "answer_count": 4, "score": 0, "last_activity_date": 1575590790, "creation_date": 1522827642, "last_edit_date": 1575590790, "question_id": 49645374, "link": "https://stackoverflow.com/questions/49645374/enter-to-exit-a-program-in-c", "title": "Enter &#39;/&#39; to exit a program in C", "body": "<p>I am stuck in an exercise. Whenever I enter a slash (<code>/</code>) in my input, the loop won't end. </p>\n\n<p>Is it possible to check the input datatype? So that if it's number, then the <code>show()</code> executes. When it's <code>character('/')</code> then exit.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nvoid show(int);\n\nint main(){\n    int quit = 0;\n\n    printf(\"Enter a number to display: \\n* times the input number\\n\");\n    printf(\"Enter '/' to exit.\\n\");\n    printf(\"======================\\n\\n\");\n\n    while(!quit) {\n        printf(\"Input: \");\n        int input;\n        scanf(\"%d\", &amp;input);\n        if (input == '/')\n            quit = 1; // Suppose to exit when input = '/'\n        else \n            show(input);\n\n        printf(\"\\n\\n\");\n    }\n}\n\nvoid show(int n) {\n    for (int i=1; i&lt;=n; i++)\n        printf(\"*\");\n}\n</code></pre>\n"}, {"tags": ["c", "memory", "linked-list", "runtime-error", "dynamic-allocation"], "comments": [{"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1522827243, "post_id": 49645198, "comment_id": 86298457, "body": "This is copying pointers instead of copying char arrays.  Always is."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1522827256, "post_id": 49645198, "comment_id": 86298465, "body": "Unrelated to your problem, but note that <a href=\"http://en.cppreference.com/w/c/io/getchar\" rel=\"nofollow noreferrer\"><code>getchar</code></a> returns an <i><code>int</code></i>. It&#39;s because it should be comparable with <code>EOF</code>."}, {"owner": {"reputation": 19, "user_id": 6450248, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-uPDEFL_dIh8/AAAAAAAAAAI/AAAAAAAAA9Q/KLLuHCUDP3s/photo.jpg?sz=128", "display_name": "Eric Geerts", "link": "https://stackoverflow.com/users/6450248/eric-geerts"}, "edited": false, "score": 0, "creation_date": 1522827393, "post_id": 49645198, "comment_id": 86298559, "body": "Martin James i dont know what that means"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 2, "creation_date": 1522827481, "post_id": 49645198, "comment_id": 86298626, "body": "You mallocate space fo the node, but not for the char array members.  So, you end up just copying pointers to local vars, and it all goes PHP-shaped:("}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1522827743, "post_id": 49645198, "comment_id": 86298826, "body": "Please read the man page for<code>strcmp</code> to see what value it returns."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1522828596, "post_id": 49645198, "comment_id": 86299365, "body": "... with is less than 0, 0, or more than 0, but unlikely to be 1, which is inappropriate for your search."}], "answers": [{"comments": [{"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1522834336, "post_id": 49645704, "comment_id": 86302998, "body": "@WeatherVane oh dear... of cause :-) Corrected. Thanks."}], "tags": [], "owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "is_accepted": false, "score": 0, "last_activity_date": 1522834305, "last_edit_date": 1522834305, "creation_date": 1522828778, "answer_id": 49645704, "question_id": 49645198, "link": "https://stackoverflow.com/questions/49645198/linked-lists-node-being-overwritten-incorrectly/49645704#49645704", "title": "Linked lists Node being overwritten incorrectly", "body": "<p>This is one example of what's wrong: </p>\n\n<pre><code>current-&gt;genre = newGenre;\n</code></pre>\n\n<p>You saving the value of the pointer <code>newGenre</code> (which is pointing to <code>input3</code>). So all nodes will end pointing to same object, i.e. when changing <code>input3</code> all nodes will point the new value.</p>\n\n<p>Try:</p>\n\n<pre><code>typedef struct node\n{\n    char artist[MAX_LENGTH + 1];\n    char songName[MAX_LENGTH + 1];\n    char genre[MAX_LENGTH + 1];\n    struct node* nextNode;\n} Node;\n</code></pre>\n\n<p>and then do:</p>\n\n<pre><code>strcpy(current-&gt;genre, newGenre);\n</code></pre>\n\n<p>to <strong>copy</strong> the value into the node.</p>\n\n<p>Alternatively, you can keep the pointers and use dynamic memory allocation.</p>\n"}], "owner": {"reputation": 19, "user_id": 6450248, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-uPDEFL_dIh8/AAAAAAAAAAI/AAAAAAAAA9Q/KLLuHCUDP3s/photo.jpg?sz=128", "display_name": "Eric Geerts", "link": "https://stackoverflow.com/users/6450248/eric-geerts"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 127, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1522834305, "creation_date": 1522827041, "question_id": 49645198, "link": "https://stackoverflow.com/questions/49645198/linked-lists-node-being-overwritten-incorrectly", "title": "Linked lists Node being overwritten incorrectly", "body": "<p>I am creating a music library program in C using linked lists. Users should be able to create a node containing: song name, artists, and genre. These nodes should be sorted alphabetically by song name. </p>\n\n<p>I am having trouble, however, creating new nodes without affecting my current head node. The picture below will illustrate this better. I call a line of code that is meant to receive a new value from the user and it resets the song name value in the head node and I have no clue why. Any help is appreciated.</p>\n\n<p>(Problem occurs between Test Point 1 and Test Point 2 printf statements, I intend for Test Point 2 to display \"zz\" instead of \"aa\").</p>\n\n<p><a href=\"https://i.stack.imgur.com/4EZvo.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4EZvo.png\" alt=\"Code Output\"></a></p>\n\n<pre><code>Code:\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;ctype.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdbool.h&gt;\n\ntypedef struct node\n{\n    char* artist;\n    char* songName;\n    char* genre;\n    struct node* nextNode;\n} Node;\n\nconst int MAX_LENGTH = 1024;\nvoid inputStringFromUser(char prompt[], char s[], int arraySize);\n\nint main(void)\n{\n    // Declare the head of the linked list.\n    //   ADD YOUR STATEMENT(S) HERE\n    Node* head = NULL;\n\n    // Announce the start of the program\n    printf(\"Personal Music Library.\\n\\n\");\n    printf(\"%s\",\n           \"Commands are I (insert), D (delete), S (search by song name),\\n\"\n           \"P (print), Q (quit).\\n\");\n\n    char response;\n    char input[MAX_LENGTH + 1];\n    char input4[MAX_LENGTH + 1];\n    char input2[MAX_LENGTH + 1];\n    char input3[MAX_LENGTH + 1];\n\n        inputStringFromUser(\"\\nCommand\", input, MAX_LENGTH);\n\n        response = toupper(input[0]);\n\n        if (response == 'I') {\n//insert a node code\n            char* promptName = \"Song name\";\n            char* promptArtist = \"Artist\";\n            char* promptGenre = \"Genre\";\n            char* newName;\n            char* newArtist;\n            char* newGenre;\n//test points for the songname in the head node\n            if (head != NULL) {\n                printf(\"Test Point 1: %s\\n\", head-&gt;songName);\n            }\n            inputStringFromUser(promptName, input4, MAX_LENGTH);\n            newName = input4;\n            if (head != NULL) {\n                printf(\"Test Point 2: %s\\n\", head-&gt;songName);\n            }\n            inputStringFromUser(promptArtist, input2, MAX_LENGTH);\n            newArtist = input2;\n            inputStringFromUser(promptGenre, input3, MAX_LENGTH);\n            newGenre = input3;\n            //if it is the first node then just create a node then assign the values to the user input\n            if (head == NULL) {\n                head = malloc(sizeof(Node));\n                head-&gt;artist = newArtist;\n                head-&gt;genre = newGenre;\n                head-&gt;songName = newName;\n            } else {\n//sorts through list until it finds the first node where the song name is not alphabetically ahead\n//of the current entered name\n                Node* current = head;\n                while (strcmp(current-&gt;songName, newName) == 1) {\n\n\n                //if the loop goes to the end of the list place the new node at the end\n                    if (current-&gt;nextNode != NULL) {\n                        current = current-&gt;nextNode;\n                    } else {\n                        current-&gt;nextNode = malloc(sizeof(Node));\n                        current = current-&gt;nextNode;\n                        current-&gt;artist = newArtist;\n                        current-&gt;genre = newGenre;\n                        current-&gt;songName = newName;\n                        break;\n                    }\n                }\n//if the loop finds the correct place for a node it shifts all the other ones down\n//then create a new end node\n                char* tempName = \"  \";\n                char* tempName2 = \"  \";\n                char* tempArtist = \"  \";\n                char* tempArtist2 = \"  \";\n                char* tempGenre = \"  \";\n                char* tempGenre2 = \"  \";\n\n                tempName = current-&gt;songName;\n                tempArtist = current-&gt;artist;\n                tempGenre = current-&gt;genre;\n\n                current-&gt;artist = newArtist;\n                current-&gt;genre = newGenre;\n                current-&gt;songName = newName;\n\n                while (current-&gt;nextNode != NULL) {\n                    current = current-&gt;nextNode;\n\n                    tempName2 = current-&gt;songName;\n                    tempArtist2 = current-&gt;artist;\n                    tempGenre2 = current-&gt;genre;\n\n                    current-&gt;songName = tempName;\n                    current-&gt;artist = tempArtist;\n                    current-&gt;genre = tempGenre;\n\n                    tempName = tempName2;\n                    tempGenre = tempGenre2;\n                    tempArtist = tempArtist2;\n                }\n\n                current-&gt;nextNode = malloc(sizeof(Node));\n                current = current-&gt;nextNode;\n                current-&gt;songName = tempName;\n                current-&gt;artist = tempArtist;\n                current-&gt;genre = tempGenre;\n            }\n        } \n}\n\n// Support Function Definitions\n\n// Prompt the user for a string safely, without buffer overflow\nvoid inputStringFromUser(char prompt[], char s[], int maxStrLength)\n{\n    int i = 0;\n    char c;\n\n    printf(\"%s --&gt; \", prompt);\n    while (i &lt; maxStrLength &amp;&amp; (c = getchar()) != '\\n')\n        s[i++] = c;\n    s[i] = '\\0';\n}\n</code></pre>\n"}, {"tags": ["c", "macros", "linker"], "comments": [{"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "edited": false, "score": 0, "creation_date": 1522826583, "post_id": 49644948, "comment_id": 86298024, "body": "You really need to show more code, and include the exact linking error, for a start."}, {"owner": {"reputation": 793, "user_id": 3565150, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/3b6d7de9652d4f46423efe1308d3ebaf?s=128&d=identicon&r=PG&f=1", "display_name": "user3565150", "link": "https://stackoverflow.com/users/3565150/user3565150"}, "reply_to_user": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "edited": false, "score": 0, "creation_date": 1522831802, "post_id": 49644948, "comment_id": 86301240, "body": "Added more code and also the linking error"}], "owner": {"reputation": 793, "user_id": 3565150, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/3b6d7de9652d4f46423efe1308d3ebaf?s=128&d=identicon&r=PG&f=1", "display_name": "user3565150", "link": "https://stackoverflow.com/users/3565150/user3565150"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1522831762, "creation_date": 1522826123, "last_edit_date": 1522831762, "question_id": 49644948, "link": "https://stackoverflow.com/questions/49644948/resolving-nested-macro-linking-error", "title": "Resolving Nested macro linking error", "body": "<p>I am getting a linking error because a function is declared in a .h file but its definition is commented. \nBelow is the linking error:\n          --- Linking Error --- \n          Error: L6218E: Undefined symbol clk_SetHMSSAPMFreqPlan (referred \n          from VVDRV_clk_glue.o).</p>\n\n<p>Now, the file where the function is being called has multiple nested if blocks like below:</p>\n\n<pre><code> #if defined(COMPILING_APPS_PROC) || defined(COMPILING_SPM_PROC)\n #ifndef AXF_BUILD\n    eClkResult clk_SetFreqPlan(eClockFrequencyType eFreqPlan, uint32 eSubsystemLists) {\n      ----some code----\n        #if defined(COMPILING_APPS_PROC) &amp;&amp; !defined(AXF_BUILD)\n            clk_SetHMSSAPMFreqPlan(0, eFreqPlan); /* This function is giving a linking error */\n        #endif\n #endif /*AXF_BUILD*/\n #endif /*COMPILING_APPS_PROC*/\n</code></pre>\n\n<p>To get over the linking error, on top of the file I am declaring the macro:\n            #ifndef AXF_BUILD\n            #define AXF_BUILD 1\n            #endif</p>\n\n<p>Because the other macro COMPILING_APPS_PROC has to be kept defined, I cannot change it.</p>\n\n<p>Since, AXF_BUILD is now defined, I am expecting the function clk_SetHMSSAPMFreqPlan(0, eFreqPlan) will not be compiled and compilation should be clean. But, I am still getting the same linking error. What might be the reason?</p>\n"}, {"tags": ["c", "if-statement", "c-preprocessor"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 1, "creation_date": 1522825067, "post_id": 49644634, "comment_id": 86297083, "body": "I have seen some dupes, but can&#39;t find them right now. <code>#if</code> is a <b>preprocessor</b> directive, it&#39;s executed <b>before</b> compilation and does no longer exist in the final program. You get <code>f==0</code> because <code>VAR</code> is nothing, the preprocessor doesn&#39;t even know <code>a</code> or <code>b</code>."}, {"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "edited": false, "score": 1, "creation_date": 1522826669, "post_id": 49644634, "comment_id": 86298072, "body": "Uh, you&#39;re kidding with those unbraced <code>if&#47;else</code> lines in <code>foo()</code>, right?"}, {"owner": {"reputation": 69, "user_id": 3623498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5ae017d88a9a993aa70a535206e916e0?s=128&d=identicon&r=PG&f=1", "display_name": "user3623498", "link": "https://stackoverflow.com/users/3623498/user3623498"}, "edited": false, "score": 0, "creation_date": 1522827853, "post_id": 49644634, "comment_id": 86298893, "body": "It&#39;s just a sample"}], "answers": [{"comments": [{"owner": {"reputation": 69, "user_id": 3623498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5ae017d88a9a993aa70a535206e916e0?s=128&d=identicon&r=PG&f=1", "display_name": "user3623498", "link": "https://stackoverflow.com/users/3623498/user3623498"}, "edited": false, "score": 0, "creation_date": 1522825494, "post_id": 49644707, "comment_id": 86297357, "body": "Can I go something like: <code>#define VAR(a,b) (a | b) </code> then <code>#define BIGVAR VAR</code>  And <code>#if (BIGVAR !=0)</code>?"}, {"owner": {"reputation": 7975, "user_id": 5660517, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/1iIxK.jpg?s=128&g=1", "display_name": "Ronan Boiteau", "link": "https://stackoverflow.com/users/5660517/ronan-boiteau"}, "reply_to_user": {"reputation": 69, "user_id": 3623498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5ae017d88a9a993aa70a535206e916e0?s=128&d=identicon&r=PG&f=1", "display_name": "user3623498", "link": "https://stackoverflow.com/users/3623498/user3623498"}, "edited": false, "score": 0, "creation_date": 1522825657, "post_id": 49644707, "comment_id": 86297462, "body": "@user3623498 No you can&#39;t. Don&#39;t try to find a hack like this, it won&#39;t work. You will need to pass parameters to your macro at some point."}, {"owner": {"reputation": 755, "user_id": 6139796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70e8ec623799f48125b0aa020475091d?s=128&d=identicon&r=PG", "display_name": "Holger", "link": "https://stackoverflow.com/users/6139796/holger"}, "edited": false, "score": 0, "creation_date": 1522828154, "post_id": 49644707, "comment_id": 86299076, "body": "But <code>#if....</code> is still a preprocessor directive and foo() won&#39;t be able to change anything relevant for this <code>#if</code>"}], "tags": [], "owner": {"reputation": 7975, "user_id": 5660517, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/1iIxK.jpg?s=128&g=1", "display_name": "Ronan Boiteau", "link": "https://stackoverflow.com/users/5660517/ronan-boiteau"}, "is_accepted": true, "score": 0, "last_activity_date": 1522825494, "last_edit_date": 1522825494, "creation_date": 1522825177, "answer_id": 49644707, "question_id": 49644634, "link": "https://stackoverflow.com/questions/49644634/problems-changing-variable-in-if/49644707#49644707", "title": "Problems changing variable in #if", "body": "<p><strong>Preprocessor directives are interpreted before compiling your program.</strong> So <code>VAR</code> has no knowledge of <code>a</code> and <code>b</code>. See <a href=\"https://en.wikipedia.org/wiki/C_preprocessor\" rel=\"nofollow noreferrer\">C preprocessor on Wikipedia</a>.</p>\n\n<hr>\n\n<p>Instead, you could create a macro that takes parameters, like this:</p>\n\n<pre><code>#define VAR(a,b) (a | b)\n</code></pre>\n\n<p>...and use it like that:</p>\n\n<pre><code>#if (VAR(a,b) != 0)\n</code></pre>\n\n<p>You would have to adapt your program, since <code>a</code> and <code>b</code> don't belong to the scope of your <code>main()</code> function.</p>\n"}], "owner": {"reputation": 69, "user_id": 3623498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5ae017d88a9a993aa70a535206e916e0?s=128&d=identicon&r=PG&f=1", "display_name": "user3623498", "link": "https://stackoverflow.com/users/3623498/user3623498"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 49644707, "answer_count": 1, "score": -5, "last_activity_date": 1522825494, "creation_date": 1522824944, "last_edit_date": 1522825462, "question_id": 49644634, "link": "https://stackoverflow.com/questions/49644634/problems-changing-variable-in-if", "title": "Problems changing variable in #if", "body": "<p>I have some problems in understanding how the <code>#if</code> preprocessor directive works.</p>\n\n<p>From this code: </p>\n\n<pre><code>int a, b;\n\n#define VAR (a | b) \n\nvoid foo(int x)\n{\n    if(x)\n        a = smth;\n        b = smth2;\n    else\n        a = xmth;\n        b = xmth2;\n}   \nint main()\n{\n    foo(x);\n    #if(VAR != 0)\n    {\n        f = VAR;\n    }\n}\n</code></pre>\n\n<p>I can only change <code>foo()</code>, but whatever the values for <code>xmth/smth</code> I get <code>f=0</code>. Why?</p>\n"}, {"tags": ["c", "cygwin", "automake"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1522824529, "post_id": 49644430, "comment_id": 86296733, "body": "The single quote at the beginning of the line is peculiar. It suggests that there&#39;s a problem with line endings or something. You may need to use some tools to make the output readable. You say it used to work but now it doesn&#39;t. What changed? What did you change?  That is likely to be the problem. Since it is an existing project, presumably you have the source tarball. Could you create a new directory and extract the tarball again and build in that directory? Or is the trouble that it was built to use an antique version of the auto tools and it no longer works with the most recent versions?"}, {"owner": {"reputation": 6281, "user_id": 5105383, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2YCB5.jpg?s=128&g=1", "display_name": "matzeri", "link": "https://stackoverflow.com/users/5105383/matzeri"}, "edited": false, "score": 0, "creation_date": 1522920149, "post_id": 49644430, "comment_id": 86347262, "body": "<code>&#47;usr&#47;src&#47;ports&#47;autoconf2.5</code> is not the location of the cygwin autoconf package. It seems you are mixing packages. See <a href=\"https://cygwin.com/packages/x86_64/autoconf2.5/autoconf2.5-2.69-3\" rel=\"nofollow noreferrer\">cygwin.com/packages/x86_64/autoconf2.5/autoconf2.5-2.69-3</a>"}], "owner": {"reputation": 1604, "user_id": 2251250, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/10101633b337743c6b2beb5ad96d7ef7?s=128&d=identicon&r=PG", "display_name": "arslan", "link": "https://stackoverflow.com/users/2251250/arslan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 116, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1522824236, "creation_date": 1522824236, "question_id": 49644430, "link": "https://stackoverflow.com/questions/49644430/an-issue-with-automake", "title": "an Issue with automake", "body": "<p>I am running an existing C project, and having an error. It was used to have no problem, and I could not fix it even after reading similar issues and trying their solutions.</p>\n\n<pre><code>./autogen.sh\nrunning: aclocal\n' is already registered with AC_CONFIG_FILES.\n/usr/src/ports/autoconf2.5/autoconf2.5-2.69-3.noarch/src/autoconf2.69/lib/autoconf/status.m4:288: AC_CONFIG_FILES is \nexpanded from...\nconfigure.ac:890: the top level\nautom4te-2.69: /usr/bin/m4 failed with exit status: 1\naclocal-1.15: error: echo failed with exit status: 1\nerror: while running 'aclocal'\n</code></pre>\n\n<p>As shown, the \"autom4te-2.69\" is failing, and I did not see any hints about what to do. I am using \"Cygwin\" on windows 10.  </p>\n\n<p>Any idea about how to fix this?</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["c", "multithreading", "memory-management", "queue", "posix"], "comments": [{"owner": {"reputation": 7497, "user_id": 1213227, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/78179ef730f268752c0f6fdde3943b99?s=128&d=identicon&r=PG", "display_name": "Matthias", "link": "https://stackoverflow.com/users/1213227/matthias"}, "edited": false, "score": 1, "creation_date": 1522824746, "post_id": 49644362, "comment_id": 86296881, "body": "Since your producer activates the consumer it can simply send a signal to the respective consumer. No priorities are needed."}, {"owner": {"reputation": 108, "user_id": 5975999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LgsI3.jpg?s=128&g=1", "display_name": "Nishant Bijani A", "link": "https://stackoverflow.com/users/5975999/nishant-bijani-a"}, "reply_to_user": {"reputation": 7497, "user_id": 1213227, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/78179ef730f268752c0f6fdde3943b99?s=128&d=identicon&r=PG", "display_name": "Matthias", "link": "https://stackoverflow.com/users/1213227/matthias"}, "edited": false, "score": 0, "creation_date": 1522825371, "post_id": 49644362, "comment_id": 86297277, "body": "this seems perfect but can i have any identification about consumer? like thread id or consumer id? which is suitable solution for real time systems?"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 1, "creation_date": 1522827845, "post_id": 49644362, "comment_id": 86298887, "body": "Unclear - do you want both C1 and C2 to get the same data, but C1 to get it first?  Please explain with more context."}, {"owner": {"reputation": 108, "user_id": 5975999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LgsI3.jpg?s=128&g=1", "display_name": "Nishant Bijani A", "link": "https://stackoverflow.com/users/5975999/nishant-bijani-a"}, "reply_to_user": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1522828197, "post_id": 49644362, "comment_id": 86299112, "body": "@Martin James yes C1 to get first and then C2. in Real scenario, C2 needs to get data after C1 completes processing. any advise will be helpful."}, {"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "edited": false, "score": 0, "creation_date": 1522828304, "post_id": 49644362, "comment_id": 86299184, "body": "Title suggests C, code is C. Why is there a C++ tag? POSIX would be a useful tag OTOH."}, {"owner": {"reputation": 108, "user_id": 5975999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LgsI3.jpg?s=128&g=1", "display_name": "Nishant Bijani A", "link": "https://stackoverflow.com/users/5975999/nishant-bijani-a"}, "reply_to_user": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "edited": false, "score": 0, "creation_date": 1522828427, "post_id": 49644362, "comment_id": 86299256, "body": "@MSalters updated Thanks. any idea about Audio Buffer efficient management in the context of Priority of Threads in above mentioned scenario?"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 1, "creation_date": 1523044664, "post_id": 49644362, "comment_id": 86413554, "body": "@NishantBijaniA no problem, then,  Queue it to C1.  When C1 is done with it, C1 queues it to C2.  With audio, (and certainly with video), the buffers are not small, so you will probably be allocating and.or pooling buffers and so queueing pointers only.   I don&#39;t see how thread priority matters much, as you have described the system..."}], "owner": {"reputation": 108, "user_id": 5975999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LgsI3.jpg?s=128&g=1", "display_name": "Nishant Bijani A", "link": "https://stackoverflow.com/users/5975999/nishant-bijani-a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1523283922, "creation_date": 1522823953, "last_edit_date": 1523283922, "question_id": 49644362, "link": "https://stackoverflow.com/questions/49644362/memory-management-of-audio-buffers-between-modules-using-c", "title": "Memory management of Audio Buffers between modules using c", "body": "<p>i am working on architecture part of designing queue management &amp; memory management, while creating data queue of some data type e.g int. now in multithreaded environment currently i will be having one consumer and one producer. in this case i am going to create two thread: one producer &amp; one consumer in following way :</p>\n\n<pre><code>thread 1:\npthread_mutex_lock(&amp;mutex);\nwhile (!condition)\n    pthread_cond_wait(&amp;cond, &amp;mutex);\n/* do something that requires holding the mutex and condition is true */\npthread_mutex_unlock(&amp;mutex);\n\nthread2:\n\npthread_mutex_lock(&amp;mutex);\n/* do something that might make condition true */\npthread_cond_signal(&amp;cond);\npthread_mutex_unlock(&amp;mutex);\n</code></pre>\n\n<p>when producer produces data then it locks using mutex, put data in queue, signal using conditional variable &amp; then release lock. consumer who waits for this signal it gets signal from producer thread, it locks queue internally, get data from queue &amp; then release lock.</p>\n\n<p>now here my question is if there are multiple consumer then how would i give them priority to give data them one by one. e.g if C1,C2 are consumers then how would i get priority to C1 first &amp; then C2.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1522821895, "post_id": 49643862, "comment_id": 86295326, "body": "Why are you trying to squeeze 16 characters of hex into a 12 byte string, which can only really handle 11 characters plus a null terminator.  It also helps readability of output if you include newlines at appropriate points.  And you would probably do better with with <code>unsigned long long</code> and <code>strtoull()</code> \u2014 <code>int</code> won&#39;t hold 16 hex digits on most machines."}, {"owner": {"reputation": 32098, "user_id": 646887, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YJ0Ye.jpg?s=128&g=1", "display_name": "Klas Lindb&#228;ck", "link": "https://stackoverflow.com/users/646887/klas-lindb%c3%a4ck"}, "edited": false, "score": 2, "creation_date": 1522821902, "post_id": 49643862, "comment_id": 86295330, "body": "<code>int</code> is probably not wide enough. Your platform seems to have 32 bit <code>int</code>s and your input is 64 bits."}], "answers": [{"comments": [{"owner": {"reputation": 2084, "user_id": 1394504, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7d8c9a8ffeeed1b0a6c18c54a4a94f9c?s=128&d=identicon&r=PG", "display_name": "Mithrand1r", "link": "https://stackoverflow.com/users/1394504/mithrand1r"}, "edited": false, "score": 0, "creation_date": 1522822925, "post_id": 49644026, "comment_id": 86295814, "body": "ahhh it is so much more to learn. I missed not only long long int but also long long hex. Naturally Your code works like charm. Thank You very much !"}], "tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": true, "score": 3, "last_activity_date": 1522824248, "last_edit_date": 1522824248, "creation_date": 1522822473, "answer_id": 49644026, "question_id": 49643862, "link": "https://stackoverflow.com/questions/49643862/convert-binary-to-hex-and-make-operation/49644026#49644026", "title": "Convert binary to hex and make operation", "body": "<p>Why are you trying to squeeze 16 characters of hex into a 12 byte string, which can only really handle 11 characters plus a null terminator. It also helps readability of output if you include newlines at appropriate points. And you would probably do better with with <code>unsigned long long</code> and <code>strtoull()</code> \u2014 <code>int</code> won't hold 16 hex digits on most machines.  It is also conventional to write expected output on standard output; use standard error for error messages.</p>\n\n<p>Putting those changes together yields an MCVE (<a href=\"https://stackoverflow.com/help/mcve\">Minimal, Complete, Verifiable Example</a>) like this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main(void)\n{\n    const char lm_bin[] = \"0110110000001110110000010100111000110011110110110111000110111000\";\n    unsigned long long lm_dec = strtoull(lm_bin, NULL, 2);\n    char lm_hex[17];\n    sprintf(lm_hex, \"%llx\", lm_dec);\n    printf(\"binary %s\\n\", lm_bin);\n    printf(\"hex %s\\n\", lm_hex);\n    return 0;\n}\n</code></pre>\n\n<p>And the output from that is what you sought, I believe:</p>\n\n<pre><code>binary 0110110000001110110000010100111000110011110110110111000110111000\nhex 6c0ec14e33db71b8\n</code></pre>\n\n<p>That code doesn't check for conversion errors and could use <code>snprintf()</code> instead of <code>sprintf()</code>, and could do all the printing in a single call to <code>printf()</code> \u2014 and doesn't need to use the string for the hex-formatted output (it could format <code>lm_dec</code> directly).  So, there's lots of room for changes and improvements in the code.</p>\n"}], "owner": {"reputation": 2084, "user_id": 1394504, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7d8c9a8ffeeed1b0a6c18c54a4a94f9c?s=128&d=identicon&r=PG", "display_name": "Mithrand1r", "link": "https://stackoverflow.com/users/1394504/mithrand1r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 49644026, "answer_count": 1, "score": 1, "last_activity_date": 1525492617, "creation_date": 1522821705, "last_edit_date": 1525492617, "question_id": 49643862, "link": "https://stackoverflow.com/questions/49643862/convert-binary-to-hex-and-make-operation", "title": "Convert binary to hex and make operation", "body": "<p>I am new to <code>C</code> and I have already tried many ways to convert <code>char*</code> variable which store <code>binary</code> representation into <code>hex</code> value.</p>\n\n<p>The variable is for example:</p>\n\n<pre><code>0110110000001110110000010100111000110011110110110111000110111000\n</code></pre>\n\n<p>which stands for</p>\n\n<pre><code>6C 0E  C1 4E 33 DB  71 B8\n</code></pre>\n\n<p>where</p>\n\n<pre><code>0110- 6, 1100 - C, 0000 - 0, 1110 - E and so on...  \n</code></pre>\n\n<p>However when I want to use <code>fprintf</code> format or <code>strtol</code>, which I found recommended for this kind of problems, I get:</p>\n\n<pre><code>char* lm_bin = \"0110110000001110110000010100111000110011110110110111000110111000\";\n//convert to dec\nint lm_dec = (int)strtol(lm_bin, NULL, 2);\nchar lm_hex[12];\n//convert to hex\nsprintf(lm_hex, \"%x\", lm_dec);\nfprintf(stderr, \"binary %s\", lm_bin);\nfprintf(stderr, \"hex %s\", lm_hex);\n</code></pre>\n\n<p>the output is:</p>\n\n<blockquote>\n  <p>binary\n  0110110000001110110000010100111000110011110110110111000110111000 hex\n  33db71b8</p>\n</blockquote>\n\n<p>which is not correct. Can anyone point me where I am making a mistake?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 17713, "user_id": 226648, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/3196df423fd95dc4fce7dfadb8ec9953?s=128&d=identicon&r=PG", "display_name": "el.pescado", "link": "https://stackoverflow.com/users/226648/el-pescado"}, "edited": false, "score": 1, "creation_date": 1522820755, "post_id": 49643599, "comment_id": 86294802, "body": "And your question is?"}, {"owner": {"reputation": 2022, "user_id": 1236128, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/DxsJR.png?s=128&g=1", "display_name": "Jonathan Komar", "link": "https://stackoverflow.com/users/1236128/jonathan-komar"}, "reply_to_user": {"reputation": 17713, "user_id": 226648, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/3196df423fd95dc4fce7dfadb8ec9953?s=128&d=identicon&r=PG", "display_name": "el.pescado", "link": "https://stackoverflow.com/users/226648/el-pescado"}, "edited": false, "score": 2, "creation_date": 1522820833, "post_id": 49643599, "comment_id": 86294830, "body": "@el.pescado Frankly, I don&#39;t see how you could have read anything I wrote and not see my question."}, {"owner": {"reputation": 6940, "user_id": 1559401, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/t9DjW.jpg?s=128&g=1", "display_name": "rbaleksandar", "link": "https://stackoverflow.com/users/1559401/rbaleksandar"}, "edited": false, "score": 2, "creation_date": 1522820911, "post_id": 49643599, "comment_id": 86294860, "body": "@JonathanKomar No, it&#39;s not clear since you have answered your own question (even posted a link to another question here on SO that gives you the same answer). :P"}, {"owner": {"reputation": 2022, "user_id": 1236128, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/DxsJR.png?s=128&g=1", "display_name": "Jonathan Komar", "link": "https://stackoverflow.com/users/1236128/jonathan-komar"}, "edited": false, "score": 0, "creation_date": 1522821014, "post_id": 49643599, "comment_id": 86294913, "body": "Try reading it like a human rather than a machine. Provide an instructional answer. I have not answered my own question. I still do not know whether [fill in question title here] which would follow that &quot;But are two pointers really created?&quot;"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1522821290, "post_id": 49643599, "comment_id": 86295038, "body": "Your &quot;if I may lazily borrow&quot; example refers to <code>&amp;value</code>, but it does not show where <code>&amp;value</code> is defined.  This causes disorientation.  You then have a &quot;Would it \u2026 be fair to say \u2026&quot; paragraph that discusses <code>int *var</code> and a copy of <code>*var</code>, and it is not clear what that <code>int *var</code> refers to, or the <code>*var</code>.  The <code>change()</code> example isn&#39;t clearly hooked into your question.  You might be assuming people will look at and remember the content of the other question \u2014 that is a bad assumption to make.  Your question should be complete as a standalone question.  The tail end of it is not fully coherent."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1522821325, "post_id": 49643599, "comment_id": 86295048, "body": "The basic answer is &quot;Yes&quot; \u2014 that is, all function arguments are copies of something, either a value or a pointer."}, {"owner": {"reputation": 1052, "user_id": 3698648, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/199b49d13342baa233c08aac5793ed4d?s=128&d=identicon&r=PG&f=1", "display_name": "ntshetty", "link": "https://stackoverflow.com/users/3698648/ntshetty"}, "edited": false, "score": 0, "creation_date": 1522821569, "post_id": 49643599, "comment_id": 86295163, "body": "As per my understanding. at the bottom line. Yes all the arguments passed by reference of the value between function calls. When Function <code>FuncA</code> calls <code>FuncB(A,B)</code>, which means <code>FuncA</code> push the values of <code>A &amp; B</code> to stack and calls the <code>FuncB</code>, which copies value from stack to process further."}, {"owner": {"reputation": 2048, "user_id": 4961259, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9b82c25cbde4d52888e6eccc44764b80?s=128&d=identicon&r=PG&f=1", "display_name": "Kami Kaze", "link": "https://stackoverflow.com/users/4961259/kami-kaze"}, "edited": false, "score": 3, "creation_date": 1522821993, "post_id": 49643599, "comment_id": 86295367, "body": "So many words with so few meaning.... All it boils down to is. Does C pass by value? And yes it does. Please be brief with your question and dont try to sound bold, it just makes it difficult to understand what you really want."}, {"owner": {"reputation": 2048, "user_id": 4961259, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9b82c25cbde4d52888e6eccc44764b80?s=128&d=identicon&r=PG&f=1", "display_name": "Kami Kaze", "link": "https://stackoverflow.com/users/4961259/kami-kaze"}, "edited": false, "score": 0, "creation_date": 1522822330, "post_id": 49643599, "comment_id": 86295518, "body": "And what do you mean with <code>are two pointers really created?</code> There are two variables <code>value</code> in <code>main</code>and <code>var</code>in <code>change</code> they are completly independend from each other. You could for example change <code>var</code> and it would not affect <code>value</code>"}, {"owner": {"reputation": 2048, "user_id": 4961259, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9b82c25cbde4d52888e6eccc44764b80?s=128&d=identicon&r=PG&f=1", "display_name": "Kami Kaze", "link": "https://stackoverflow.com/users/4961259/kami-kaze"}, "edited": false, "score": 2, "creation_date": 1522822666, "post_id": 49643599, "comment_id": 86295665, "body": "It is not a generalisation. Using more words does not change the question. Every function gets a copy of the parameters, that is not a generalisation. That&#39;s just how it is. At least in C."}, {"owner": {"reputation": 2022, "user_id": 1236128, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/DxsJR.png?s=128&g=1", "display_name": "Jonathan Komar", "link": "https://stackoverflow.com/users/1236128/jonathan-komar"}, "reply_to_user": {"reputation": 2048, "user_id": 4961259, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9b82c25cbde4d52888e6eccc44764b80?s=128&d=identicon&r=PG&f=1", "display_name": "Kami Kaze", "link": "https://stackoverflow.com/users/4961259/kami-kaze"}, "edited": false, "score": 0, "creation_date": 1522823259, "post_id": 49643599, "comment_id": 86296017, "body": "@KamiKaze It is my intention to describe the background of my question and then limit its scope. From my understanding, that corresponds to the rules on StackExchange.  Anyway, if \u201dpass by value\u201c is unclear as to not answer my question, then your simplified phrase does not carry enough semantic value ie it is an oversimplification of a technical process. Grammar: \u201dfew\u201c can only be used when the noun that follows is not collective. Furthermore, \u201dbold\u201c does not work in the context of your sentence. Bold, however, does work here,  as I am bold in correcting your grammatical mistakes ;)"}, {"owner": {"reputation": 2048, "user_id": 4961259, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9b82c25cbde4d52888e6eccc44764b80?s=128&d=identicon&r=PG&f=1", "display_name": "Kami Kaze", "link": "https://stackoverflow.com/users/4961259/kami-kaze"}, "edited": false, "score": 1, "creation_date": 1522825285, "post_id": 49643599, "comment_id": 86297220, "body": "My bad. Call it &quot;fancy language&quot; and &quot;little meaning&quot;. Still it is not a oversimplification, it is a precise description. If your question is what <code>pass by value</code> means, then quite a few seemed to misunderstand your question. All I wanted was telling you that by being brief and more precise in your question, it is easier to answer and help you."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1522842013, "post_id": 49643599, "comment_id": 86308093, "body": "If you would &quot;Star Trek pass&quot; variables to a function, then wouldn&#39;t they stop to exist in the caller function? C doesn&#39;t work like that, no..."}, {"owner": {"reputation": 2022, "user_id": 1236128, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/DxsJR.png?s=128&g=1", "display_name": "Jonathan Komar", "link": "https://stackoverflow.com/users/1236128/jonathan-komar"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1522849464, "post_id": 49643599, "comment_id": 86313649, "body": "@Lundin Good point. Maybe one of those broken transporter episodes would work better: C is a like a malfunctioning transporter that assembles new particles (bytes) somewhere else but leaves the original particles where they were. Copies of pointers are like particles in quantom entanglement. How\u2019s that?"}], "answers": [{"comments": [{"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1522822572, "post_id": 49644000, "comment_id": 86295630, "body": "You might want to say something about arrays that are not passed by value, but decay into a pointer to their first element."}, {"owner": {"reputation": 17713, "user_id": 226648, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/3196df423fd95dc4fce7dfadb8ec9953?s=128&d=identicon&r=PG", "display_name": "el.pescado", "link": "https://stackoverflow.com/users/226648/el-pescado"}, "reply_to_user": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1522823097, "post_id": 49644000, "comment_id": 86295914, "body": "@BasileStarynkevitch Thanks, you&#39;re right, although I don&#39;t think at this general level there&#39;s much difference."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 1, "creation_date": 1522823210, "post_id": 49644000, "comment_id": 86295987, "body": "There is a <i>lot of differences</i> between variables (which are <i>names</i> occurring in source code) and values. At runtime variables do not exist (you only have locations, the compiler forgot the variables), but values do exist. Study the <a href=\"https://en.wikipedia.org/wiki/Semantics_(computer_science)\" rel=\"nofollow noreferrer\">semantics</a> of some programming language (e.g. <a href=\"http://www.schemers.org/Documents/Standards/R5RS/\" rel=\"nofollow noreferrer\">R5RS</a>)"}, {"owner": {"reputation": 2022, "user_id": 1236128, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/DxsJR.png?s=128&g=1", "display_name": "Jonathan Komar", "link": "https://stackoverflow.com/users/1236128/jonathan-komar"}, "reply_to_user": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1522823614, "post_id": 49644000, "comment_id": 86296195, "body": "@BasileStarynkevitch I welcome other answers (as does the community, I hope) I\u2019d like your insight here. (afterall, it is about learning and not about checkmarks)"}, {"owner": {"reputation": 2022, "user_id": 1236128, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/DxsJR.png?s=128&g=1", "display_name": "Jonathan Komar", "link": "https://stackoverflow.com/users/1236128/jonathan-komar"}, "edited": false, "score": 0, "creation_date": 1522823747, "post_id": 49644000, "comment_id": 86296269, "body": "@el.pescado My question implies; Are things really \u201dpassed\u201c? or just \u201dcopied\u201c? Could you please address this?"}, {"owner": {"reputation": 17713, "user_id": 226648, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/3196df423fd95dc4fce7dfadb8ec9953?s=128&d=identicon&r=PG", "display_name": "el.pescado", "link": "https://stackoverflow.com/users/226648/el-pescado"}, "edited": false, "score": 1, "creation_date": 1522824878, "post_id": 49644000, "comment_id": 86296960, "body": "It depends on what you mean by &quot;passed&quot;. I understand &quot;passing&quot; as action of associating function with actual arguments, regardless whether they are copied/referenced/aliased etc. So, I&#39;d say &quot;copies of arguments are passed into function&quot;."}, {"owner": {"reputation": 17713, "user_id": 226648, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/3196df423fd95dc4fce7dfadb8ec9953?s=128&d=identicon&r=PG", "display_name": "el.pescado", "link": "https://stackoverflow.com/users/226648/el-pescado"}, "reply_to_user": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1522825088, "post_id": 49644000, "comment_id": 86297095, "body": "@BasileStarynkevitch I&#39;m not arguing that there&#39;s no difference. I just think that the difference is not significant when explaining &quot;passing by value&quot;. I agree that correct terminology should be used when possible though, so I updated my answer."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1522825122, "post_id": 49644000, "comment_id": 86297114, "body": "The difference is absolutely essential. Variables do not exist at runtime."}, {"owner": {"reputation": 17713, "user_id": 226648, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/3196df423fd95dc4fce7dfadb8ec9953?s=128&d=identicon&r=PG", "display_name": "el.pescado", "link": "https://stackoverflow.com/users/226648/el-pescado"}, "reply_to_user": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1522825302, "post_id": 49644000, "comment_id": 86297235, "body": "@BasileStarynkevitch the same way general relativity is &quot;absolutely essential&quot; but we still teach Newtonian physics at school."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1522825478, "post_id": 49644000, "comment_id": 86297348, "body": "No, I strongly disagree. Even a beginner should know and <b>think about locations</b> and should be told that in C <b>variables do not exist at runtime</b>. In particular, a pointer could point (and very often is pointing) to a location which is not a variable (e.g. result of <code>malloc</code>, or field of some <code>struct</code>, or component of some array). Teaching that pointers point to variables is a horrible mistake and confuses even the beginner."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1522842247, "post_id": 49644000, "comment_id": 86308259, "body": "Funny how C answers tend to go &quot;In C, things <i>always</i> work like x. Except...&quot; :) Although in this case, the correct answer is rather &quot;In C, things are <i>always</i> passed by value. Except for arrays, they don&#39;t get passed by value. Except when they are passed by value.&quot; <code>typedef struct { int array[666]; } arr_t; ... void func (arr_t look_ma_im_passing_arrays_by_value);</code>"}], "tags": [], "owner": {"reputation": 17713, "user_id": 226648, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/3196df423fd95dc4fce7dfadb8ec9953?s=128&d=identicon&r=PG", "display_name": "el.pescado", "link": "https://stackoverflow.com/users/226648/el-pescado"}, "is_accepted": true, "score": 2, "last_activity_date": 1522847553, "last_edit_date": 1522847553, "creation_date": 1522822351, "answer_id": 49644000, "question_id": 49643599, "link": "https://stackoverflow.com/questions/49643599/is-it-fair-to-say-that-all-parameters-or-arguments-are-copied-when-passed-to-fun/49644000#49644000", "title": "Is it fair to say that all parameters or arguments are copied when passed to functions in C?", "body": "<p>Yes, everything* in C is passed by value, which means that copies of arguments are passed to function - that's the only way of passing values to functions. \"Pass by pointer\" (or \"reference\") doesn't really exist - it's still \"passing by value\", where \"value\" is pointer. Pointers are values after all.</p>\n\n<hr>\n\n<p><strong>Linguistic note:</strong> when we say \"<em>could you pass me some sugar please</em>\" we expect someone to temporarily transfer possession of sugar bowl to us, so at any moment of time there's only one sugar bowl. In other words, we expect sugar bowl to be <em>moved</em> to us. That's not the case in programming. \"Passing\" in this context means merely \"associating parameters with function being called\", and doesn't necessarily involve moving. That's why we differentiate between \"pass-by-value\", \"pass-by-reference\", \"pass-by-name\" etc.</p>\n\n<hr>\n\n<p>Example:</p>\n\n<pre><code>/* I have 2 apples, 3 oranges and one pear */\nint apple = 2;\nint orange = 3;\nint pear = 1;\n\n/* Apples are my favorite fruit */\nint *my_favorite_fruit = &amp;apple;\n\nvoid no_eat_fruit (int fruit) {\n    /* Does not work, \"fruit\" is copy, so changes to it have no effect outside function */\n    fruit--;\n}\nno_eat_fruit(apple);\n/* No apples have been eaten at this point */\n\n\nvoid eat_fruit(int *fruit) {\n    /* Here, \"fruit\" is copy, but \"*fruit\" refers to original object */\n    *fruit--;\n}\neat_fruit(&amp;apple);\neat_fruit(my_favorite_fruit);\n/* I have no apples left */\n\n/* Let's change my mind, now I like oranges */\n\nvoid no_change_my_mind(int *favorite) {\n    /* Doesn't work, \"favorite\" is copy, so changes to it have no effect outside function */\n    favorite = &amp;orange;\n}\nno_change_my_mind(my_favorite_fruit);\n/* I still like apples, LOL! */\n\nvoid change_my_mind(int **favorite) {\n    /* In order to change pointer, we have pass pointer-to-pointer.\n       Here, \"favorite\" is copy, but \"*favorite\" points to original pointer */\n    *favorite = &amp;orange;\n}\nchange_my_mind(&amp;my_favorite_fruit);\n</code></pre>\n\n<hr>\n\n<p><code>*</code> with exception to arrays. Arrays \"<a href=\"https://stackoverflow.com/questions/1461432/what-is-array-decaying\">decay into pointers</a>\" when passed into function.</p>\n"}, {"tags": [], "owner": {"reputation": 2022, "user_id": 1236128, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/DxsJR.png?s=128&g=1", "display_name": "Jonathan Komar", "link": "https://stackoverflow.com/users/1236128/jonathan-komar"}, "is_accepted": false, "score": 0, "last_activity_date": 1523263711, "last_edit_date": 1523263711, "creation_date": 1522995327, "answer_id": 49686519, "question_id": 49643599, "link": "https://stackoverflow.com/questions/49643599/is-it-fair-to-say-that-all-parameters-or-arguments-are-copied-when-passed-to-fun/49686519#49686519", "title": "Is it fair to say that all parameters or arguments are copied when passed to functions in C?", "body": "<p>This question has been racking my brains. I had to prove it. Out of respect for el.pescado's efforts, I am leaving his or her answer as accepted answer.</p>\n\n<h1>Code</h1>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n\nvoid copy( int * memoryslot )\n{\n  /* This does not prove that * memoryslot is a copied pointer */\n  printf(\"copy:              ValueCopied:        %p\\n\", memoryslot);  /* memoryslot is a ptr    */\n  printf(\"copy: CalculatedPointerAddress:        %p &lt;- Well, it is not. Here is the proof.\\n\", &amp;memoryslot); /* get address of pointer */\n  * memoryslot = 30; /* To prove I can still use a copy to change the original value */\n  return;\n}\n\nint main(void) \n{\n  int memoryslot = 20;\n  int * memoryslotPtr = &amp;memoryslot;\n  printf(\"Caller                 Pointer to memory slot\\n\");\n  printf(\"-------------------------------------\\n\");\n  printf(\"main:                    Value:        %d\\n\", memoryslot);\n  printf(\"main:   CalculatedValueAddress:        %p\\n\", &amp;memoryslot);\n  printf(\"main: CalculatedPointerAddress:        %p &lt;- If * memoryslot were the same, it would be this.\\n\", &amp;memoryslotPtr);\n\n  /* Pass address, yields same as &amp;memoryslot */\n  copy( memoryslotPtr ); \n\n  printf(\"main:                    Value:        %d\\n\", memoryslot);\n\n\n  return EXIT_SUCCESS;\n}\n</code></pre>\n\n<h1>Output</h1>\n\n<pre><code>Caller                 Pointer to memory slot\n-------------------------------------\nmain:                    Value:        20\nmain:   CalculatedValueAddress:        0x7ffee9134c48\nmain: CalculatedPointerAddress:        0x7ffee9134c40 &lt;- If * memoryslot were the same, it would be this.\ncopy:              ValueCopied:        0x7ffee9134c48\ncopy: CalculatedPointerAddress:        0x7ffee9134c08 &lt;- Well, it is not. Here is the proof.\nmain:                    Value:        30\n</code></pre>\n"}], "owner": {"reputation": 2022, "user_id": 1236128, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/DxsJR.png?s=128&g=1", "display_name": "Jonathan Komar", "link": "https://stackoverflow.com/users/1236128/jonathan-komar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 137, "favorite_count": 2, "accepted_answer_id": 49644000, "answer_count": 2, "score": 1, "last_activity_date": 1523263711, "creation_date": 1522820552, "last_edit_date": 1522942991, "question_id": 49643599, "link": "https://stackoverflow.com/questions/49643599/is-it-fair-to-say-that-all-parameters-or-arguments-are-copied-when-passed-to-fun", "title": "Is it fair to say that all parameters or arguments are copied when passed to functions in C?", "body": "<p>From <a href=\"https://stackoverflow.com/questions/10597606/why-does-scanf-require\">Why does <code>scanf()</code> require <code>&amp;</code>?</a>, it is mentioned that </p>\n\n<blockquote>\n  <p>all arguments in C are passed by value.</p>\n</blockquote>\n\n<pre><code>void change( int * var ) {\n    // Here, var is a pointer to the original number. var == &amp;value\n    // Writing to `*var` modifies the variable the pointer points to\n    *var = 1337;\n}\n</code></pre>\n\n<p>Could I write instead</p>\n\n<pre><code>void change( int * var ) {\n    // Here, var is a copy of a pointer that happens to point to the same memory block as the original pointer. var == &amp;value\n    // Writing to `*var` modifies the variable the pointer points to\n    *var = 1337;\n}\n</code></pre>\n\n<p>Assuming</p>\n\n<pre><code>int main() {\n    int value = 42;\n    change(&amp;value);\n    return 0;\n}\n</code></pre>\n\n<p><em>Nothing can be passed in C</em> is a correct statement using the conventional meaning of \"pass\". Is my understanding sound?</p>\n\n<hr>\n\n<p>My question rephrased is: Can anything truely be <em>passed</em> in C (the conventional use of \"pass\")?</p>\n"}, {"tags": ["c", "embedded", "uart", "mplab", "pic32"], "comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1522823195, "post_id": 49643295, "comment_id": 86295976, "body": "The code in main looks indeed like it should not increment x. I am afraid you are looking at something evil, stackoverflow, wild pointer, UB, ... Good luck (no sarcasm intended)."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1522823360, "post_id": 49643295, "comment_id": 86296058, "body": "You might want to upgrade your code quote to a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. I am missing the declaration and definition of <code>lineIndex</code> and <code>currentLine</code>; without this <code>currentLine[--lineIndex] = 0;</code> looks fishy."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1522823411, "post_id": 49643295, "comment_id": 86296084, "body": "Please take the <a href=\"https://stackoverflow.com/tour\">tour</a> at your convenience."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1522823494, "post_id": 49643295, "comment_id": 86296132, "body": "Looks fishy, because with a corrupted <code>lineIndex</code> below 0, this one could write something other than 0 to x <code>currentLine[--lineIndex] = c;</code>."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1522833917, "post_id": 49643295, "comment_id": 86302680, "body": "@Yunnosch : Need not be &quot;corrupted&quot; as such - if the first character received were <code>\\n</code>, it would be decremented from zero."}, {"owner": {"reputation": 1, "user_id": 9594624, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39ec2f97fd50cfe8350b5c62d14df338?s=128&d=identicon&r=PG&f=1", "display_name": "K. Crow", "link": "https://stackoverflow.com/users/9594624/k-crow"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1522850814, "post_id": 49643295, "comment_id": 86314778, "body": "@Yunnosch I have updated my question to include a more minimal ISR that still gives me the same error without needing the <code>currentLine</code> or <code>lineIndex</code> variables."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "reply_to_user": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1522873570, "post_id": 49643295, "comment_id": 86329146, "body": "@Clifford Without meaning to contradict you, my meaning is that anything which is used as an array index is corrupted (for that purpose) if &lt;0."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1522874191, "post_id": 49643295, "comment_id": 86329469, "body": "@Yunnosch : I appreciate that, but there is a clear and useful distinction between explicitly but erroneously assigning a value, and a value being changed indirectly. From that distinction, the index is incorrectly assigned rather than corrupted, whilst any subsequent write to the array via the incorrect index, will corrupt whatever it resolves to.  I say the distinction is useful, because invalid assignment is a predictable semantic error, you can determine where and when it will happen, and can reproduce it reliably.  Corruption on the other hand leads to undefined behaviour."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "reply_to_user": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1522875654, "post_id": 49643295, "comment_id": 86330247, "body": "@Clifford I agree. Using &quot;corrupted&quot; as I did was misleading."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9594624, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39ec2f97fd50cfe8350b5c62d14df338?s=128&d=identicon&r=PG&f=1", "display_name": "K. Crow", "link": "https://stackoverflow.com/users/9594624/k-crow"}, "edited": false, "score": 0, "creation_date": 1522850531, "post_id": 49647112, "comment_id": 86314557, "body": "I updated and added some information to my question. I certainly will need to fix the issue you have pointed out, but unfortunately it is not the root cause of an unreachable code block being executed, as I can run the more simplified ISR now posted in the question and get the same results."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "reply_to_user": {"reputation": 1, "user_id": 9594624, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39ec2f97fd50cfe8350b5c62d14df338?s=128&d=identicon&r=PG&f=1", "display_name": "K. Crow", "link": "https://stackoverflow.com/users/9594624/k-crow"}, "edited": false, "score": 0, "creation_date": 1522851433, "post_id": 49647112, "comment_id": 86315273, "body": "@K.Crow : If you have the necessary debug tools, set a data access breakpoint on the variable  x to see what is writing to it.  Failing that make it static to move it off the stack, and see what happens.  If it is no longer corrupted, then it is a stack error.  Do you have other interrupts active?"}, {"owner": {"reputation": 1, "user_id": 9594624, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39ec2f97fd50cfe8350b5c62d14df338?s=128&d=identicon&r=PG&f=1", "display_name": "K. Crow", "link": "https://stackoverflow.com/users/9594624/k-crow"}, "edited": false, "score": 0, "creation_date": 1522853106, "post_id": 49647112, "comment_id": 86316714, "body": "I was able to solve the issue just now. It seems that I had not configured the interrupt to use the shadow register set, and so changing <code>IPL7SRS</code> to <code>IPL7SOFT</code> fixed the issue. It seems that attempting to use the shadow register set without proper configuration was causing the issue."}], "tags": [], "owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "is_accepted": true, "score": 3, "last_activity_date": 1522834350, "last_edit_date": 1522834350, "creation_date": 1522833190, "answer_id": 49647112, "question_id": 49643295, "link": "https://stackoverflow.com/questions/49643295/not-equals-operator-not-working-when-interrupts-are-enabled-on-pic32/49647112#49647112", "title": "Not Equals Operator not working when interrupts are enabled on PIC32", "body": "<p>Here:</p>\n\n<pre><code>    if (c == '\\n') {\n        currentLine[--lineIndex] = 0; //Overwrite /r as null terminator for string\n</code></pre>\n\n<p>If the first character received were <code>\\n</code> and <code>lineIndex</code> is initialised zero, <code>lineIndex</code> will be decremeted from zero.  Assuming it is unsigned, then <code>lineIndex &lt; MAX_LINE_LENGTH</code> will be false and:</p>\n\n<pre><code>    } else {\n        currentLine[--lineIndex] = c;\n    }\n</code></pre>\n\n<p>will run repeatedly until <code>lineIndex</code> is eventually decremented to <code>MAX_LINE_LENGTH - 1</code> - stomping over a large swathe of memory - which is most likely what is happening in this case.</p>\n\n<p>Suggest:</p>\n\n<pre><code>    if( lineIndex != 0 &amp;&amp; c == '\\n' &amp;&amp; ) \n    {\n        currentLine[--lineIndex] = 0; //Overwrite /r as null terminator for \n</code></pre>\n\n<p>or:</p>\n\n<pre><code>    if( c == '\\n' ) \n    {\n        if( lineIndex != 0 ) \n        {\n            lineindex-- ;\n        }\n        currentLine[lineIndex] = 0; //Overwrite /r as null terminator for \n</code></pre>\n\n<p>depending on the semantics you require.  It is not a given that the sending system uses CR+LF pairs for line-ends, and you should not assume that. The code should probably be further modified to check that the preceding character was indeed a CR before decrementing <code>lineindex</code>.  An exercise for the reader.</p>\n\n<p>And similarly for the final else:</p>\n\n<pre><code>    } \n    else if( lineIndex != 0 )\n    {\n        currentLine[--lineIndex] = c;\n    }\n</code></pre>\n\n<p>or</p>\n\n<pre><code>    } \n    else\n    {\n        if( lineIndex != 0 ) \n        {\n            lineindex-- ;\n        }\n        currentLine[lineIndex] = c;\n    }\n</code></pre>\n\n<p>It is possible that the latter protection is not necessary, but the protection is useful perhaps for clarity and maintenance - it is <em>defensive code</em> - your call.</p>\n\n<p>It may be a safer and more interrupt efficient design to have the ISR simply place any received character into a ring-buffer, and then deal with line-input outside of the interrupt context.  You might increment a counter on every received <code>\\n</code> and decrement it when <code>\\n</code> were unbuffered so that the receiver will know how many lines are currently buffered for processing.</p>\n"}], "owner": {"reputation": 1, "user_id": 9594624, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39ec2f97fd50cfe8350b5c62d14df338?s=128&d=identicon&r=PG&f=1", "display_name": "K. Crow", "link": "https://stackoverflow.com/users/9594624/k-crow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 0, "closed_date": 1522873957, "accepted_answer_id": 49647112, "answer_count": 1, "score": -2, "last_activity_date": 1522850414, "creation_date": 1522819010, "last_edit_date": 1522850414, "question_id": 49643295, "link": "https://stackoverflow.com/questions/49643295/not-equals-operator-not-working-when-interrupts-are-enabled-on-pic32", "closed_reason": "Not suitable for this site", "title": "Not Equals Operator not working when interrupts are enabled on PIC32", "body": "<p>I am currently trying to parse a string received via UART from a GPS module on a PIC32MZ2048EFG100 micro-controller via a UART receive interrupt protocol. I am using MPLAB X IDE v4.10 and XC32 v2.05 for my IDE and compiler.</p>\n\n<p>When I enabled the UART4 receive interrupt, the != operator stops functioning as it should. I have a block of code within my main function that should never be executed, but yet it is.</p>\n\n<p>I have narrowed it down to enabling interrupts being the problem. If I comment out all working code in my ISR, I still face the issue of myCounter being incremented.</p>\n\n<p>Here is the code I have in my main function.</p>\n\n<pre><code>int myCounter = 0;\n\nvoid main ( void ){\n\n    hal_sys_init();\n    hal_uart4_init();\n    gps_init();\n\n    //Setup interrupt\n    asm volatile(\"di\"); //Disable all interrupts\n    asm volatile(\"ehb\"); //Disable all interrupts\n\n    INTCON = 0; //Clear interrupt control register\n\n    IEC0 = 0;\n    IEC1 = 0;\n    IEC2 = 0;\n    IEC3 = 0;\n    IEC4 = 0;\n    IEC5 = 0;\n    IEC6 = 0;\n\n    INTCONbits.MVEC = 1; //Enable multi-vectored interrupts\n\n    IFS5bits.U4RXIF = 0; //Clear interrupt flag\n    IPC42bits.U4RXIP = 1; //Set priority level to 7\n    IPC42bits.U4RXIS = 0; //Set sub-priority to 0\n    IEC5bits.U4RXIE = 1; //Enable interrupt\n\n    asm volatile(\"ei\"); //Enable all interrupts\n\n    while(1){\n        int x = 0;\n        if(x != 0){\n            myCounter++;  //Should never be executed\n        }\n    }\n}\n</code></pre>\n\n<p>When running this code on my PIC with interrupts enabled, myCounter gets incremented. <img src=\"https://i.stack.imgur.com/deuq2.png\" alt=\"myCounter has a value of 0x275 after running for a few seconds\"></p>\n\n<p>Here is the code for my interrupt service routine. </p>\n\n<pre><code>void __ISR(_UART4_RX_VECTOR, ipl7SRS) UART4_Interrupt(void) {\n    while (U4STAbits.URXDA) {\n        char c = U4RXREG;\n        if (c == '\\n') {\n            currentLine[--lineIndex] = 0; //Overwrite /r as null terminator for string\n            parseStringFlag = 1;\n            lineIndex = 0;\n\n            if (currentLine == buff_1) {\n                currentLine = buff_2;\n                previousLine = buff_1;\n            } else {\n                currentLine = buff_1;\n                previousLine = buff_2;\n            }\n\n        } else if (lineIndex &lt; MAX_LINE_LENGTH) {\n            currentLine[lineIndex++] = c;\n        } else {\n            currentLine[--lineIndex] = c;\n        }\n    }\n    IFS5bits.U4RXIF = 0; //Clear interrupt flag\n    return;\n}\n</code></pre>\n\n<p>Here is the basic ISR code that still makes myCounter increment.</p>\n\n<pre><code>void __ISR(_UART4_RX_VECTOR, ipl7SRS) UART4_Interrupt(void) {\n    while (U4STAbits.URXDA) {\n        char c = U4RXREG;\n    }\n    IFS5bits.U4RXIF = 0; //Clear interrupt flag\n    return;\n}\n</code></pre>\n\n<p>What could be causing the code that should never be executed to execute? If I run the interrupt code in main with interrupts disabled the code works and the code that should never be executed is not executed. </p>\n"}, {"tags": ["c", "pointers", "doubly-linked-list"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1522816634, "post_id": 49642853, "comment_id": 86293258, "body": "For case <code>iii</code>, the <code>data_node</code> structure is a way to emulate inheritance in C."}, {"owner": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "edited": false, "score": 0, "creation_date": 1522816951, "post_id": 49642853, "comment_id": 86293374, "body": "Are you sure that in <code>sys_dlist_is_head</code> should be comparison with <code>tail</code>?"}, {"owner": {"reputation": 1142, "user_id": 6089653, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vaKuF.jpg?s=128&g=1", "display_name": "nj2237", "link": "https://stackoverflow.com/users/6089653/nj2237"}, "reply_to_user": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "edited": false, "score": 0, "creation_date": 1522817025, "post_id": 49642853, "comment_id": 86293391, "body": "@freestyle oh you&#39;re right. let me correct that"}, {"owner": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "edited": false, "score": 0, "creation_date": 1522817453, "post_id": 49642853, "comment_id": 86293556, "body": "In a circular doubly-linked list, it&#39;s so convenient to do, since you can look at the list structure as a pseudo node. But from your description, I do not understand if this list is circular. Can you show list initialization?"}, {"owner": {"reputation": 1142, "user_id": 6089653, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vaKuF.jpg?s=128&g=1", "display_name": "nj2237", "link": "https://stackoverflow.com/users/6089653/nj2237"}, "reply_to_user": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "edited": false, "score": 0, "creation_date": 1522817753, "post_id": 49642853, "comment_id": 86293681, "body": "@freestyle I have added the initialization part, correct me if I am wrong, but it does look like a circular dll"}, {"owner": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "edited": false, "score": 0, "creation_date": 1522817822, "post_id": 49642853, "comment_id": 86293713, "body": "Yes, it should be circular."}, {"owner": {"reputation": 4505, "user_id": 1168733, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5ewxJ.jpg?s=128&g=1", "display_name": "Sigi", "link": "https://stackoverflow.com/users/1168733/sigi"}, "edited": false, "score": 0, "creation_date": 1523449796, "post_id": 49642853, "comment_id": 86565146, "body": "<code>i</code>: there is a subtle difference from &quot;reuse&quot; and &quot;misuse&quot;. In the 80&#39;s the idea of &quot;reuse&quot; was &quot;write as less code as possible&quot;. However &quot;a list is not a node&quot;, but &quot;a list contains nodes&quot; or &quot;a list contains the references to head and tail nodes&quot;, so in modern list implementations, the concepts (classes/structs) of list and nodes are usually kept separated, with more code written but no &quot;discouraged&quot; code written (read: type casting). The fact that node and list have the same &quot;shape&quot; (two pointers to nodes) is not sufficient to let the two types collapse into one, today, usually, IMHO."}], "answers": [{"comments": [{"owner": {"reputation": 1142, "user_id": 6089653, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vaKuF.jpg?s=128&g=1", "display_name": "nj2237", "link": "https://stackoverflow.com/users/6089653/nj2237"}, "edited": false, "score": 0, "creation_date": 1522819873, "post_id": 49643173, "comment_id": 86294445, "body": "wow, thank you for this detailed explanation, it is clear to me now. So if it is not the first field, then I would need to use <code>offsetof</code> while typecasting it, right?"}, {"owner": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "reply_to_user": {"reputation": 1142, "user_id": 6089653, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vaKuF.jpg?s=128&g=1", "display_name": "nj2237", "link": "https://stackoverflow.com/users/6089653/nj2237"}, "edited": false, "score": 1, "creation_date": 1522820029, "post_id": 49643173, "comment_id": 86294510, "body": "Yes. More over. If it the first filed then <code>offsetof</code> will work too, because <code>offsetof</code> will be 0."}], "tags": [], "owner": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "is_accepted": true, "score": 1, "last_activity_date": 1573287824, "last_edit_date": 1573287824, "creation_date": 1522818275, "answer_id": 49643173, "question_id": 49642853, "link": "https://stackoverflow.com/questions/49642853/interpreting-circular-doubly-linked-list-implementation-which-uses-union/49643173#49643173", "title": "Interpreting circular doubly linked list implementation which uses union", "body": "<blockquote>\n  <p>(i) Why would we need a union here? That too, in this specific way?</p>\n</blockquote>\n\n<p>So convenient, since this list is cyclic. The list structure is a pseudo node in the list. Therefore, the node can be viewed as a list structure and as node in a list.</p>\n\n<p>Another definition might be:</p>\n\n<pre><code>union _dnode {\n    struct {\n        union _dnode *head;\n        union _dnode *tail;\n    };\n    struct {\n        union _dnode *next;\n        union _dnode *prev;\n    };\n};\n\ntypedef union _dnode sys_dlist_t;\ntypedef union _dnode sys_dnode_t;\n</code></pre>\n\n<blockquote>\n  <p>(ii) How come both the list and node of the list are going to be pointers of same type? (see typedef declaration)</p>\n</blockquote>\n\n<p>This is also convenient to do, since these pointers refer to the same structure in memory.</p>\n\n<blockquote>\n  <p>(iii) If I declare a list of such a type, ie. the data_node items will be the elements of the sys_dlist_t type... Can I do that by typecasting node (which is currently a pointer to type sys_dnode_t) to a pointer to type data_node?</p>\n</blockquote>\n\n<p>You can, because the pointer to the first field in the structure and the pointer to the structure are the same.</p>\n\n<p>A node field need not be the first, but then a simple typecasting can not do that. For example:</p>\n\n<pre><code>struct list_elem {\n    int foo;\n    char *bar;\n    ...\n    sys_dnode_t siblings;\n};\n\nsys_dnode_t *node;\nstruct list_elem *elem;\n\nelem = (struct list_elem *)((char *)node - offsetof(struct list_elem, siblings));\n</code></pre>\n\n<p>or if you define macro:</p>\n\n<pre><code>#define objectof(_ObjectT,_Field,x) \\\n    ((_ObjectT *)((char *)(x) - offsetof(_ObjectT,_Field)))\n\nelem = objectof(struct list_elem, siblings, node);\n</code></pre>\n"}], "owner": {"reputation": 1142, "user_id": 6089653, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vaKuF.jpg?s=128&g=1", "display_name": "nj2237", "link": "https://stackoverflow.com/users/6089653/nj2237"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 49643173, "answer_count": 1, "score": 0, "last_activity_date": 1573287824, "creation_date": 1522816482, "last_edit_date": 1522819991, "question_id": 49642853, "link": "https://stackoverflow.com/questions/49642853/interpreting-circular-doubly-linked-list-implementation-which-uses-union", "title": "Interpreting circular doubly linked list implementation which uses union", "body": "<p>I am having some trouble interpreting this doubly-linked list:</p>\n\n<pre><code>struct _dnode {\n    union {\n        struct _dnode *head;\n        struct _dnode *next;\n    };\n    union {\n        struct _dnode *tail;\n        struct _dnode *prev;\n    };\n};\n\ntypedef struct _dnode sys_dlist_t;\ntypedef struct _dnode sys_dnode_t;\n</code></pre>\n\n<p>And further functions are defined on this list, like, for example finding if given node is head of the list:</p>\n\n<pre><code>static inline int sys_dlist_is_head(sys_dlist_t *list, sys_dnode_t *node)\n{\n    return list-&gt;head == node;\n}\n</code></pre>\n\n<p>Now, my questions are -</p>\n\n<p>(i) Why would we need a union here? That too, in this specific way?</p>\n\n<p>(ii) How come both the <code>list</code> and <code>node</code> of the list are going to be pointers of same type? (see <code>typedef</code> declaration)</p>\n\n<p>(iii) If I declare a list of such a type, ie. the <code>data_node</code> items will be the elements of the <code>sys_dlist_t</code> type:</p>\n\n<pre><code>struct data_node{\n    sys_dnode_t node;\n    int data = 0;\n} data_node[2];\n</code></pre>\n\n<p>and I declare a node such that:</p>\n\n<pre><code>sys_dnode_t *node = NULL;\n</code></pre>\n\n<p>and then if I want to iterate over my list to check if the <code>data</code> of the <code>data_node</code> element matches say, a number 3. Can I do that by typecasting <code>node</code> (which is currently a pointer to type <code>sys_dnode_t</code>) to a pointer to type <code>data_node</code>?</p>\n\n<p>Now, in the code, this has been done, and it is like:</p>\n\n<pre><code>if (((struct data_node *)node)-&gt;data == 3) {\n    break;\n}\n</code></pre>\n\n<p>This bewilders me. I may have missed some code to figure this out, so please tell me if you need more information. Can we typecast a <code>node</code> pointer to point to some struct that contains <code>node</code> and then access other data of the struct? How does this work?</p>\n\n<p><strong>EDIT 1:</strong>\nFew more info on this list:</p>\n\n<p><em>\"The lists are expected to be initialized such that both the head and tail pointers point to the list itself. Initializing the lists in such a fashion simplifies the adding and removing of nodes to/from the list.\"</em></p>\n\n<p>The initialization is as follows:</p>\n\n<pre><code>static inline void sys_dlist_init(sys_dlist_t *list)\n{\n    list-&gt;head = (sys_dnode_t *)list;\n    list-&gt;tail = (sys_dnode_t *)list;\n}\n</code></pre>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 0, "creation_date": 1522815179, "post_id": 49642612, "comment_id": 86292825, "body": "Your string is 15 bytes long but you allocate only 9."}, {"owner": {"reputation": 1, "user_id": 9594485, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Shah Jee", "link": "https://stackoverflow.com/users/9594485/shah-jee"}, "reply_to_user": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 0, "creation_date": 1522815236, "post_id": 49642612, "comment_id": 86292840, "body": "I am sorry, i mistakenly allocated 9 bytes. It should be 15 in malloc(). Even after that its not working"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9594485, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Shah Jee", "link": "https://stackoverflow.com/users/9594485/shah-jee"}, "edited": false, "score": 0, "creation_date": 1522815353, "post_id": 49642644, "comment_id": 86292883, "body": "So, what&#39;s the solution to this issue?"}, {"owner": {"reputation": 1686, "user_id": 3551483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/I4c4V.png?s=128&g=1", "display_name": "Fang", "link": "https://stackoverflow.com/users/3551483/fang"}, "reply_to_user": {"reputation": 1, "user_id": 9594485, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Shah Jee", "link": "https://stackoverflow.com/users/9594485/shah-jee"}, "edited": false, "score": 0, "creation_date": 1522815507, "post_id": 49642644, "comment_id": 86292926, "body": "@ShahJee: You could just return a char pointer from function a."}, {"owner": {"reputation": 1, "user_id": 9594485, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Shah Jee", "link": "https://stackoverflow.com/users/9594485/shah-jee"}, "edited": false, "score": 0, "creation_date": 1522815969, "post_id": 49642644, "comment_id": 86293049, "body": "I tried the above solution. Now the main() is printing fine but a() is printing weird characters. Note: My &quot;q&quot; is still defined as single pointer in the main() function."}, {"owner": {"reputation": 529, "user_id": 6101580, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205983900385237/picture?type=large", "display_name": "Tom&#225;\u0161 Zahradn&#237;\u010dek", "link": "https://stackoverflow.com/users/6101580/tom%c3%a1%c5%a1-zahradn%c3%ad%c4%8dek"}, "edited": false, "score": 0, "creation_date": 1522816031, "post_id": 49642644, "comment_id": 86293064, "body": "yes, i forgot that you use that q on next line. You have to dereference <code>q</code> in <code>a</code> there too."}, {"owner": {"reputation": 1, "user_id": 9594485, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Shah Jee", "link": "https://stackoverflow.com/users/9594485/shah-jee"}, "edited": false, "score": 0, "creation_date": 1522816113, "post_id": 49642644, "comment_id": 86293085, "body": "Perfect. Working great now. Thanks geek. You are a smart guy. :)"}, {"owner": {"reputation": 1, "user_id": 9594485, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Shah Jee", "link": "https://stackoverflow.com/users/9594485/shah-jee"}, "edited": false, "score": 0, "creation_date": 1522816153, "post_id": 49642644, "comment_id": 86293101, "body": "Just a little question, what was i doing wrong initially? I just want to clear my concepts."}, {"owner": {"reputation": 529, "user_id": 6101580, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205983900385237/picture?type=large", "display_name": "Tom&#225;\u0161 Zahradn&#237;\u010dek", "link": "https://stackoverflow.com/users/6101580/tom%c3%a1%c5%a1-zahradn%c3%ad%c4%8dek"}, "edited": false, "score": 0, "creation_date": 1522816305, "post_id": 49642644, "comment_id": 86293145, "body": "I have pointed that out at the beginning of my answer. all changes to <code>p</code> or <code>q</code> in <code>a</code> does not change <code>p</code> or <code>q</code> in <code>main</code>. This is because when calling <code>a(p,q)</code>, values <code>p</code> and <code>q</code> are copied. <code>a</code> only modifies these copies, and not origianl values."}, {"owner": {"reputation": 1, "user_id": 9594485, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Shah Jee", "link": "https://stackoverflow.com/users/9594485/shah-jee"}, "edited": false, "score": 0, "creation_date": 1522817064, "post_id": 49642644, "comment_id": 86293403, "body": "I used to think that when ptr is passed to the function, it is passed by reference and not the value. Thank you for clarifying my concept."}], "tags": [], "owner": {"reputation": 529, "user_id": 6101580, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205983900385237/picture?type=large", "display_name": "Tom&#225;\u0161 Zahradn&#237;\u010dek", "link": "https://stackoverflow.com/users/6101580/tom%c3%a1%c5%a1-zahradn%c3%ad%c4%8dek"}, "is_accepted": false, "score": 4, "last_activity_date": 1522816573, "last_edit_date": 1522816573, "creation_date": 1522815186, "answer_id": 49642644, "question_id": 49642612, "link": "https://stackoverflow.com/questions/49642612/c-pointer-lost-after-multiple-assignments/49642644#49642644", "title": "C pointer lost after multiple assignments", "body": "<p><code>q</code> in <code>main()</code> is uninitialized. You probably assume that <code>q</code> is changed after <code>a(p,q)</code>, but as that pointer is passed by value (as everything in C), after returning from <code>a</code>, any changes done to <code>q</code> are discarded (they were local to <code>a</code>)</p>\n\n<p>To solve this, while preserving most of your function signatures, you would have to add another level of pointers</p>\n\n<p>In following code, <code>p</code> and <code>q</code> in <code>a</code> are local to <code>a</code>, but you are not directly changing any of them, insted, you are modifying value, that is pointed at by <code>q</code> (that value is of type <code>*char</code>, so another ponter, easy to get lost)</p>\n\n<pre><code>void a(char *p, char **q) {\n\n     *q = b(p);\n     printf(\"a(): %s\\n\", q);\n}\n\nvoid main(void) {\n    ...\n    a(p,&amp;q);\n\n    printf(\"main(): %s\\n\", *q);\n\n    ....\n}\n</code></pre>\n\n<p>Or simply return that pointer, and assign to <code>q</code> in <code>main</code> (as you have done in <code>b</code>)</p>\n\n<p>To better understand why this is happening, consider this simpler example:</p>\n\n<pre><code>void foo(int a) {\n    print(\"value is %d\\n\", a);\n    a = 42; // modifies only a local copy of passed parameter a\n    print(\"modified value is %d\\n\", a);\n}\n\nint main() {\n    int a = 0\n    printf(\"initial value is %d\\n\", a);\n    foo(a);\n    printf(\"value after returning is (still) %d\\n, a\");\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9594485, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Shah Jee", "link": "https://stackoverflow.com/users/9594485/shah-jee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1522816831, "creation_date": 1522814934, "last_edit_date": 1522816831, "question_id": 49642612, "link": "https://stackoverflow.com/questions/49642612/c-pointer-lost-after-multiple-assignments", "title": "C pointer lost after multiple assignments", "body": "<p>I am new to C programming and having some issues with the pointers in the following code. I am using the C89 standard. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n\nchar * b(char *p) {\n\n    char *z;\n\n    z = p;\n\n    printf(\"b(): %s\\n\", z);\n\n    return z;\n\n}\n\nvoid a(char *p, char *q) {\n\n     q = b(p);\n     printf(\"a(): %s\\n\", q);\n}\n\nvoid main(void) {\n\n    char *p = (char *) malloc(15);\n    char *q;\n\n    strcpy(p, \"This is a test\");\n\n    a(p,q);\n\n    printf(\"main(): %s\\n\", q);\n\n    free(p);\n}\n</code></pre>\n\n<p>For some reason, my <code>printf</code> function is printing nothing in the <code>main()</code> function. The <code>printf</code> calls in both of the functions <code>a()</code> and <code>b()</code> are working. I am not sure why my pointer \"q\" is lost in the main function. I even tried allocation dynamic memory to \"q\" in main() function but still no results.</p>\n"}, {"tags": ["c", "arrays", "function", "pointers"], "comments": [{"owner": {"reputation": 10010, "user_id": 1894021, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JXt2j.jpg?s=128&g=1", "display_name": "Isaac", "link": "https://stackoverflow.com/users/1894021/isaac"}, "edited": false, "score": 0, "creation_date": 1522812219, "post_id": 49642235, "comment_id": 86292037, "body": "<a href=\"https://stackoverflow.com/help/mcve\">stackoverflow.com/help/mcve</a>"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1522812509, "post_id": 49642235, "comment_id": 86292112, "body": "Welcome to Stack Overflow.  Please read the <a href=\"https://stackoverflow.com/tour\">About</a> and <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> pages soon.  <a href=\"http://mattgemmell.com/2008/12/08/what-have-you-tried/\" rel=\"nofollow noreferrer\">What have you tried?</a> We&#39;ll help you fix an honest attempt at solving the problem, but we won&#39;t write the code for you."}, {"owner": {"reputation": 370, "user_id": 3180983, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b6ef922c5ca8a066d895479aad2f2b10?s=128&d=identicon&r=PG&f=1", "display_name": "BananaBuisness", "link": "https://stackoverflow.com/users/3180983/bananabuisness"}, "edited": false, "score": 0, "creation_date": 1522813418, "post_id": 49642235, "comment_id": 86292332, "body": "Are you willing to use rand() function? e.g. Use a library function that generates a random number?  If you want to make the randomization by yourself, your question should be totally different. The question should be: How do I generate a random number with no external libraries with C?"}, {"owner": {"reputation": 58292, "user_id": 34824, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/ri8DI.jpg?s=128&g=1", "display_name": "abelenky", "link": "https://stackoverflow.com/users/34824/abelenky"}, "edited": false, "score": 0, "creation_date": 1522813926, "post_id": 49642235, "comment_id": 86292451, "body": "<b><i>Show Code</i></b> What exactly do you need help with?  You&#39;ve given us a spec, but no code, and no question."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1522813964, "post_id": 49642235, "comment_id": 86292468, "body": "<code>&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;[randon_number]</code> - repeat this 40 times."}, {"owner": {"reputation": 13, "user_id": 9593492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cac4dd69ba5307faa48a230330732092?s=128&d=identicon&r=PG&f=1", "display_name": "user9593492", "link": "https://stackoverflow.com/users/9593492/user9593492"}, "edited": false, "score": 0, "creation_date": 1522814845, "post_id": 49642235, "comment_id": 86292725, "body": "This is what I have so far, Im not very good with arrays.       int s1 [41] srand(time(NULL));  int i; for (i = 0; i &lt; 41; i++) {     s1 [i] = rand(); }"}, {"owner": {"reputation": 58292, "user_id": 34824, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/ri8DI.jpg?s=128&g=1", "display_name": "abelenky", "link": "https://stackoverflow.com/users/34824/abelenky"}, "edited": false, "score": 0, "creation_date": 1522815173, "post_id": 49642235, "comment_id": 86292823, "body": "So... you don&#39;t even have <code>int main(void)</code> yet?  Cause you&#39;re definitely going to need that.   Maybe also a <code>return 0;</code>?"}, {"owner": {"reputation": 7273, "user_id": 2193968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1beed39f2b04409ff584a0af1d59325c?s=128&d=identicon&r=PG", "display_name": "Jerry Jeremiah", "link": "https://stackoverflow.com/users/2193968/jerry-jeremiah"}, "edited": false, "score": 0, "creation_date": 1522815393, "post_id": 49642235, "comment_id": 86292895, "body": "Not related to your question, but something to keep in the back of your mind: rand() doesn&#39;t have the same probability of selecting every possible letter so it isn&#39;t truly random."}, {"owner": {"reputation": 370, "user_id": 3180983, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b6ef922c5ca8a066d895479aad2f2b10?s=128&d=identicon&r=PG&f=1", "display_name": "BananaBuisness", "link": "https://stackoverflow.com/users/3180983/bananabuisness"}, "reply_to_user": {"reputation": 7273, "user_id": 2193968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1beed39f2b04409ff584a0af1d59325c?s=128&d=identicon&r=PG", "display_name": "Jerry Jeremiah", "link": "https://stackoverflow.com/users/2193968/jerry-jeremiah"}, "edited": false, "score": 0, "creation_date": 1522816273, "post_id": 49642235, "comment_id": 86293143, "body": "@JerryJeremiah A true random number does not exist (;"}, {"owner": {"reputation": 13, "user_id": 9593492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cac4dd69ba5307faa48a230330732092?s=128&d=identicon&r=PG&f=1", "display_name": "user9593492", "link": "https://stackoverflow.com/users/9593492/user9593492"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1522817126, "post_id": 49642235, "comment_id": 86293427, "body": "@4386427 Do I have to assign s1 that many times? I understand s1[41]is  null since we want the last cell to be terminated  by null since its a string"}, {"owner": {"reputation": 13, "user_id": 9593492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cac4dd69ba5307faa48a230330732092?s=128&d=identicon&r=PG&f=1", "display_name": "user9593492", "link": "https://stackoverflow.com/users/9593492/user9593492"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1522817747, "post_id": 49642235, "comment_id": 86293680, "body": "@4386427 Thank you, that helps with the start, i appreciate it"}, {"owner": {"reputation": 13, "user_id": 9593492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cac4dd69ba5307faa48a230330732092?s=128&d=identicon&r=PG&f=1", "display_name": "user9593492", "link": "https://stackoverflow.com/users/9593492/user9593492"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1522898300, "post_id": 49642235, "comment_id": 86337028, "body": "@4386427 I no longer see the example you sent me?"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1522909996, "post_id": 49642235, "comment_id": 86340901, "body": "@user9593492 It&#39;s gone. Always remember to copy stuff in comments if you want to save it. Comments may disappear at any time and can&#39;t be recovered. Anyway, see <a href=\"https://ideone.com/4pV9dF\" rel=\"nofollow noreferrer\">ideone.com/4pV9dF</a>"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 9593492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cac4dd69ba5307faa48a230330732092?s=128&d=identicon&r=PG&f=1", "display_name": "user9593492", "link": "https://stackoverflow.com/users/9593492/user9593492"}, "edited": false, "score": 0, "creation_date": 1522816222, "post_id": 49642579, "comment_id": 86293123, "body": "Is this using a mix of arrays and pointers? I&#39;m just beginning to learn pointers, how would this look like with pure arrays?"}, {"owner": {"reputation": 370, "user_id": 3180983, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b6ef922c5ca8a066d895479aad2f2b10?s=128&d=identicon&r=PG&f=1", "display_name": "BananaBuisness", "link": "https://stackoverflow.com/users/3180983/bananabuisness"}, "edited": false, "score": 0, "creation_date": 1522816544, "post_id": 49642579, "comment_id": 86293231, "body": "As you can see, A string is simply and array of chars. Now, there is a use of pointers here, <code>char* inputString</code> is a declaration of a  pointer (named <code>inputString</code>) that points to the beginning of the array. So inputString is a pointer. inputString&#39;s value is an address (that points to a &#39;cell&#39; that contains the first letter of the array) Therefore if i will do for  example: <code>printf(%c,*inputString);</code> it will print the first character inthe array. *inputString is also equivilant to <code>inputString[0]</code>. it is acctually EXACTLY the same thing."}, {"owner": {"reputation": 370, "user_id": 3180983, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b6ef922c5ca8a066d895479aad2f2b10?s=128&d=identicon&r=PG&f=1", "display_name": "BananaBuisness", "link": "https://stackoverflow.com/users/3180983/bananabuisness"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1522817292, "post_id": 49642579, "comment_id": 86293492, "body": "@4386427 Would you believe me if I told you that I wrote that with a BlackBerry phone? Fixed..."}, {"owner": {"reputation": 370, "user_id": 3180983, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b6ef922c5ca8a066d895479aad2f2b10?s=128&d=identicon&r=PG&f=1", "display_name": "BananaBuisness", "link": "https://stackoverflow.com/users/3180983/bananabuisness"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1522817396, "post_id": 49642579, "comment_id": 86293536, "body": "@4386427 You should try one, you&#39;ll feel 3% freeEr"}, {"owner": {"reputation": 13, "user_id": 9593492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cac4dd69ba5307faa48a230330732092?s=128&d=identicon&r=PG&f=1", "display_name": "user9593492", "link": "https://stackoverflow.com/users/9593492/user9593492"}, "edited": false, "score": 0, "creation_date": 1522817529, "post_id": 49642579, "comment_id": 86293575, "body": "@AsafFisher I understand that, * is to dereference and get the content of that cell. It&#39;s just understanding the whole thing that gets confusing. Im also supposed to use gets and puts"}, {"owner": {"reputation": 370, "user_id": 3180983, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b6ef922c5ca8a066d895479aad2f2b10?s=128&d=identicon&r=PG&f=1", "display_name": "BananaBuisness", "link": "https://stackoverflow.com/users/3180983/bananabuisness"}, "edited": false, "score": 0, "creation_date": 1522817902, "post_id": 49642579, "comment_id": 86293737, "body": "Use the documentation. gets (which should not be used anymore in general) get a pointer as a parameter (pointer to a char array). It does not return anything because it manipulate the array on the address you sent to it... lets say i have <code>char arr[255];</code> now call <code>gets(arr);</code>  gets will assign the <code>stdin</code> string into <code>arr</code> and will terminate (assign <code>NULL</code>) to the last place. If you  <code>printf</code> arr now, it will show the input string... (Please upvote I worked hard with my BlackBerry producing this explanations...)"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1522817972, "post_id": 49642579, "comment_id": 86293756, "body": "<code>randomString</code> should be void or <code>return arr;</code> If void you need to fix main"}, {"owner": {"reputation": 13, "user_id": 9593492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cac4dd69ba5307faa48a230330732092?s=128&d=identicon&r=PG&f=1", "display_name": "user9593492", "link": "https://stackoverflow.com/users/9593492/user9593492"}, "edited": false, "score": 0, "creation_date": 1522819388, "post_id": 49642579, "comment_id": 86294265, "body": "@AsafFisher is upvoting simply hitting the up arrow on your answer? And how does that benefit you if i may ask, im new to all this sorry. Also all the function calling and execution has to be done through main function"}, {"owner": {"reputation": 370, "user_id": 3180983, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b6ef922c5ca8a066d895479aad2f2b10?s=128&d=identicon&r=PG&f=1", "display_name": "BananaBuisness", "link": "https://stackoverflow.com/users/3180983/bananabuisness"}, "edited": false, "score": 0, "creation_date": 1522819900, "post_id": 49642579, "comment_id": 86294461, "body": "Upvotes add me points, V mark, mark&#39;s my post as a solution. If you did  not find my post helpful, you dont marked as solved. If it helped you but did not answer the question in your opinion, you just upvote. If post answered your question, upvote and mark V"}, {"owner": {"reputation": 58292, "user_id": 34824, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/ri8DI.jpg?s=128&g=1", "display_name": "abelenky", "link": "https://stackoverflow.com/users/34824/abelenky"}, "edited": false, "score": 0, "creation_date": 1522851103, "post_id": 49642579, "comment_id": 86315000, "body": "Read the <a href=\"https://stackoverflow.com/tour\">Tour</a> for basic information about upvoting, accepting answers and using this site.   When presented with working code, you should be able to understand the basics from it.   We should not need to explain it line-by-line to you."}], "tags": [], "owner": {"reputation": 370, "user_id": 3180983, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b6ef922c5ca8a066d895479aad2f2b10?s=128&d=identicon&r=PG&f=1", "display_name": "BananaBuisness", "link": "https://stackoverflow.com/users/3180983/bananabuisness"}, "is_accepted": false, "score": 0, "last_activity_date": 1522818800, "last_edit_date": 1522818800, "creation_date": 1522814734, "answer_id": 49642579, "question_id": 49642235, "link": "https://stackoverflow.com/questions/49642235/c-programming-function-to-generate-a-string-of-random-letters-using-only-arrays/49642579#49642579", "title": "C programming. Function to generate a string of random letters using only arrays and then pointers", "body": "<p>Please note that I did not compile any of this code. It might have some typo and/or runtime errors. The concept is correct though and you should understand the code first and not just copy it.</p>\n\n<p>Function 1:</p>\n\n<pre><code>    #include &lt;stdlib.h&gt; // Important! rand() function that generate random function is in that library!\n    //This function returns a pointer of an array (arr). In other words it returns the **address** of the first character of the array.\n// Assuming arr is valid!\n    char* randomString(char* arr){\n       // This part does not REALLLYY matters it just makes sure the random will truly be random...\n        time_t t;\n        srand((unsigned) time(&amp;t)); // Seeds the random function.\n       //------------------\n//Looping the array assigning random letters:\n        int i = 0;\n        while(i&lt;SIZE){\n            arr[i] = 'A'+(rand()%('Z'-'A'+1));// 'A' has a numerical value, we want the range from 'A' to 'Z' to be random. 'Z'-'A' is the range of letters (26) because its a modulu if the modulu was just 'Z'-'A' (26) it wouldnt print Z. 'Z' is the 26th letter, 26%26 is zero, it will not give 'Z' this is why I increased 'Z'-'A' by 1 so the modulu will include 'Z' as random latter. \n            i = i + 1;\n        }\n        arr[i] = 0;// String terminator also called NULL.\n        return \"lol\";\n    }\n</code></pre>\n\n<p>Function 2:</p>\n\n<pre><code>#include &lt;string.h&gt;\nint replace(char* inputString, char* userInput,char replacement ){\n    /* e.g. \n       inputString = \"ABSDSADASBBBAA\";//Generate yourself... (Might want to user function 1)\n       userInput = \"AB\"; // You need to do the user input yourself...\n       replacement = 'D';\n    */\n    int i = 0;\n    while(i&lt;strlen(inputString)){\n        int j = 0;\n        while(j&lt;strlen(userInput)){\n            if(inputString[i]==userInput[j]){\n                inputString[i] = replacement;\n            }\n            j = j+1;\n        }\n        i = i + 1;\n    }\n}\n</code></pre>\n\n<p>Function 3:</p>\n\n<pre><code> int main(){\n    // Just use regular IO libraries to get user's input...\n    // Assuming you did that, I will hard code the values (you need to do the IO e.g. gets())\n    char str[SIZE];\n    randomString(str); // Requirement #1 reuse of function 1\n    char * userInput = \"AB\"; // You need to do the user input yourself...\n    char replacement = 'D';// You need to do the user input yourself...\n    replace(str, userInput, replacement)//Requirement #2\n    return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 58292, "user_id": 34824, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/ri8DI.jpg?s=128&g=1", "display_name": "abelenky", "link": "https://stackoverflow.com/users/34824/abelenky"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1522815586, "post_id": 49642670, "comment_id": 86292945, "body": "String termination is in there. :)  <code>srand</code> is a minor detail compared to how much help he needs."}, {"owner": {"reputation": 13, "user_id": 9593492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cac4dd69ba5307faa48a230330732092?s=128&d=identicon&r=PG&f=1", "display_name": "user9593492", "link": "https://stackoverflow.com/users/9593492/user9593492"}, "edited": false, "score": 0, "creation_date": 1522816430, "post_id": 49642670, "comment_id": 86293189, "body": "Im sorry for my lack of knowledge, Im just having a hard time with arrays and pointers. Does what I have above look right? Will it work for function 1?"}, {"owner": {"reputation": 58292, "user_id": 34824, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/ri8DI.jpg?s=128&g=1", "display_name": "abelenky", "link": "https://stackoverflow.com/users/34824/abelenky"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1522817174, "post_id": 49642670, "comment_id": 86293440, "body": "@4386427 I try to be creative and sneaky with my code, but still correct.  If he tries to turn my code in as homework, he wont be able to explain it."}, {"owner": {"reputation": 370, "user_id": 3180983, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b6ef922c5ca8a066d895479aad2f2b10?s=128&d=identicon&r=PG&f=1", "display_name": "BananaBuisness", "link": "https://stackoverflow.com/users/3180983/bananabuisness"}, "edited": false, "score": 0, "creation_date": 1522817537, "post_id": 49642670, "comment_id": 86293580, "body": "@abelenky My rand is sneakier :P"}, {"owner": {"reputation": 13, "user_id": 9593492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cac4dd69ba5307faa48a230330732092?s=128&d=identicon&r=PG&f=1", "display_name": "user9593492", "link": "https://stackoverflow.com/users/9593492/user9593492"}, "edited": false, "score": 0, "creation_date": 1522817793, "post_id": 49642670, "comment_id": 86293702, "body": "I do appreciate your help guys"}, {"owner": {"reputation": 370, "user_id": 3180983, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b6ef922c5ca8a066d895479aad2f2b10?s=128&d=identicon&r=PG&f=1", "display_name": "BananaBuisness", "link": "https://stackoverflow.com/users/3180983/bananabuisness"}, "reply_to_user": {"reputation": 13, "user_id": 9593492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cac4dd69ba5307faa48a230330732092?s=128&d=identicon&r=PG&f=1", "display_name": "user9593492", "link": "https://stackoverflow.com/users/9593492/user9593492"}, "edited": false, "score": 1, "creation_date": 1522818224, "post_id": 49642670, "comment_id": 86293842, "body": "@user9593492 Than show it!, upvote, upvote, upvote!!"}, {"owner": {"reputation": 13, "user_id": 9593492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cac4dd69ba5307faa48a230330732092?s=128&d=identicon&r=PG&f=1", "display_name": "user9593492", "link": "https://stackoverflow.com/users/9593492/user9593492"}, "reply_to_user": {"reputation": 370, "user_id": 3180983, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b6ef922c5ca8a066d895479aad2f2b10?s=128&d=identicon&r=PG&f=1", "display_name": "BananaBuisness", "link": "https://stackoverflow.com/users/3180983/bananabuisness"}, "edited": false, "score": 0, "creation_date": 1522818266, "post_id": 49642670, "comment_id": 86293859, "body": "@asafFisher @ abelenky @ 4386427 I want to understand the code though, I dont benefit if I dont get it. Im new to coding and would appreciate explanations along with code."}, {"owner": {"reputation": 370, "user_id": 3180983, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b6ef922c5ca8a066d895479aad2f2b10?s=128&d=identicon&r=PG&f=1", "display_name": "BananaBuisness", "link": "https://stackoverflow.com/users/3180983/bananabuisness"}, "edited": false, "score": 0, "creation_date": 1522818326, "post_id": 49642670, "comment_id": 86293874, "body": "Upvote does not mean Solved... its just an appreciation thingy... Read my explanation about <code>gets</code>"}, {"owner": {"reputation": 13, "user_id": 9593492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cac4dd69ba5307faa48a230330732092?s=128&d=identicon&r=PG&f=1", "display_name": "user9593492", "link": "https://stackoverflow.com/users/9593492/user9593492"}, "edited": false, "score": 0, "creation_date": 1522899983, "post_id": 49642670, "comment_id": 86337437, "body": "@abelenky while ( (strchr(txt, *tgt)? *strchr(txt, *tgt) = repl : NULL) == repl ); keeps getting a compiler error"}, {"owner": {"reputation": 13, "user_id": 9593492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cac4dd69ba5307faa48a230330732092?s=128&d=identicon&r=PG&f=1", "display_name": "user9593492", "link": "https://stackoverflow.com/users/9593492/user9593492"}, "edited": false, "score": 0, "creation_date": 1522903192, "post_id": 49642670, "comment_id": 86338271, "body": "@abelenky I get C2100 illegal indirection and C2106 &#39;=&#39;:left operand must be l-value. And on char txt[41] = {}; \tchar tgt[40] = {}; im guessing the &quot; &quot; was missed withing brackets cus also had an error"}, {"owner": {"reputation": 58292, "user_id": 34824, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/ri8DI.jpg?s=128&g=1", "display_name": "abelenky", "link": "https://stackoverflow.com/users/34824/abelenky"}, "edited": false, "score": 0, "creation_date": 1522903842, "post_id": 49642670, "comment_id": 86338435, "body": "You are using a strange compiler! But i made some changes that might help."}, {"owner": {"reputation": 13, "user_id": 9593492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cac4dd69ba5307faa48a230330732092?s=128&d=identicon&r=PG&f=1", "display_name": "user9593492", "link": "https://stackoverflow.com/users/9593492/user9593492"}, "edited": false, "score": 0, "creation_date": 1522904341, "post_id": 49642670, "comment_id": 86338575, "body": "@abelenky Im using visual studios. I am still getting the same errors along with warnings &#39;strchr&#39; undefined, assuming extern return unit and operand of &#39;*&#39; must be a pointer (these were also there before, not new after update)"}, {"owner": {"reputation": 58292, "user_id": 34824, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/ri8DI.jpg?s=128&g=1", "display_name": "abelenky", "link": "https://stackoverflow.com/users/34824/abelenky"}, "edited": false, "score": 0, "creation_date": 1522930163, "post_id": 49642670, "comment_id": 86354315, "body": "I&#39;m getting the same errors in Visual Studio, but not with other compilers.   I changed it to work in Visual Studio now. (But I&#39;m very confident my original code was valid C)"}, {"owner": {"reputation": 13, "user_id": 9593492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cac4dd69ba5307faa48a230330732092?s=128&d=identicon&r=PG&f=1", "display_name": "user9593492", "link": "https://stackoverflow.com/users/9593492/user9593492"}, "edited": false, "score": 0, "creation_date": 1522979002, "post_id": 49642670, "comment_id": 86379565, "body": "@abelenky So im getting C2113 error. on the same line &#39;-&#39;: pointer can only be subtracted from another pointer. So i added an asterisk on (tgt[strchr(txt, *tgt) - *tgt] and now it runs but when i enter all user entries it gives me an &quot;exception thrown&quot; and before i see my filtered string it just closes out and returns to source code. AH"}, {"owner": {"reputation": 58292, "user_id": 34824, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/ri8DI.jpg?s=128&g=1", "display_name": "abelenky", "link": "https://stackoverflow.com/users/34824/abelenky"}, "edited": false, "score": 0, "creation_date": 1522983239, "post_id": 49642670, "comment_id": 86380468, "body": "I&#39;m sorry, but I&#39;m not getting that error on either of my compilers.  I&#39;m not sure how else to help you."}, {"owner": {"reputation": 13, "user_id": 9593492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cac4dd69ba5307faa48a230330732092?s=128&d=identicon&r=PG&f=1", "display_name": "user9593492", "link": "https://stackoverflow.com/users/9593492/user9593492"}, "edited": false, "score": 0, "creation_date": 1522984108, "post_id": 49642670, "comment_id": 86380663, "body": "It&#39;s ok, youve been a huge help!"}], "tags": [], "owner": {"reputation": 58292, "user_id": 34824, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/ri8DI.jpg?s=128&g=1", "display_name": "abelenky", "link": "https://stackoverflow.com/users/34824/abelenky"}, "is_accepted": true, "score": 0, "last_activity_date": 1522984681, "last_edit_date": 1522984681, "creation_date": 1522815376, "answer_id": 49642670, "question_id": 49642235, "link": "https://stackoverflow.com/questions/49642235/c-programming-function-to-generate-a-string-of-random-letters-using-only-arrays/49642670#49642670", "title": "C programming. Function to generate a string of random letters using only arrays and then pointers", "body": "<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\nvoid rand_str(char* txt, size_t sz)\n{\n    int i=sz-1;\n    while( i --&gt; 0 )\n    {\n        txt[i] = 'A' + rand() % 26;\n    }\n    printf(\"Random Str: %.*s\\n\", sz+i, txt);\n}\n\nvoid fn2(char* tgt, size_t sz, char* repl )\n{\n    puts(\"String 2: \");\n    fgets(tgt, sz, stdin);\n\n    puts(\"Replacement Char: \");\n    *repl = getchar();\n}\n\nvoid search_replace(char* txt, char* tgt, char repl)\n{\n    while(*tgt != '\\0')\n    {\n        while ((strchr(txt, *tgt) ? (tgt[strchr(txt, *tgt)-tgt] = repl) : 0) == repl);\n        tgt++;\n    }\n}\n\nint main(void)\n{\n    char txt[41] = {0};\n    char tgt[40] = {0};\n    char repl;\n\n    rand_str(txt, sizeof(txt));\n    fn2(tgt, sizeof(tgt), &amp;repl);\n    search_replace(txt, tgt, repl);\n    return !printf(\"Filtered String: %s\\n\", txt);\n}\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 9593492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cac4dd69ba5307faa48a230330732092?s=128&d=identicon&r=PG&f=1", "display_name": "user9593492", "link": "https://stackoverflow.com/users/9593492/user9593492"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1346, "favorite_count": 0, "accepted_answer_id": 49642670, "answer_count": 2, "score": -2, "last_activity_date": 1522984681, "creation_date": 1522812179, "last_edit_date": 1522815532, "question_id": 49642235, "link": "https://stackoverflow.com/questions/49642235/c-programming-function-to-generate-a-string-of-random-letters-using-only-arrays", "title": "C programming. Function to generate a string of random letters using only arrays and then pointers", "body": "<p>Im trying to code a program in C to generate a string containing random letters using only arrays first and then again using pointers. I've looked at many other questions but is not quite what I'm trying to accomplish. I can really use help please.</p>\n\n<ul>\n<li><p>Function 1- Generates a string with random upper \ncase letter A-Z with 40 characters.</p></li>\n<li><p>Function 2- Function to let user enter a string\nwith random upper case letter and a replacement character.</p></li>\n<li><p>Function 3- Searches string1 from function 1 and replaces\noccurences of any character from string 2 (user entered) with \nreplacement character.</p></li>\n</ul>\n\n<p><strong>OUTPUT EX.</strong> </p>\n\n<pre><code>String 1- \"AABBCCDDEEFFGGHHABCDEFGH\"\n\nString 2- \"BE\"\n\nReplacement char- \"3\"\n\nFiltered string- AA33CCDD33FFGGHHA3CD3FGH.\n</code></pre>\n\n<p>This is what I have so far, Im not very good with arrays.      </p>\n\n<pre><code>    #include &lt;stdio.h&gt;\n    #include &lt;stdlib.h&gt;\n\n    int main()\n\n{\n\nint s1 [41];\n\n    srand(time(NULL));  \n    int i;\n\n    for (i = 0; i &lt; 41; i++)\n\n     {\n\n    s1 [i] = rand();\n\n    }\n\nreturn 0;\n\n}\n</code></pre>\n\n<p>Any help will be appreciated. \n     Thanks alot.</p>\n"}, {"tags": ["c", "data-structures", "linked-list"], "comments": [{"owner": {"reputation": 279739, "user_id": 16076, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D29fm.jpg?s=128&g=1", "display_name": "Mitch Wheat", "link": "https://stackoverflow.com/users/16076/mitch-wheat"}, "edited": false, "score": 0, "creation_date": 1522807626, "post_id": 49641623, "comment_id": 86290859, "body": "question makes zero sense. your code clearly shows that 61 will be printed."}, {"owner": {"reputation": 1505, "user_id": 4344586, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zmULe.png?s=128&g=1", "display_name": "Frank AK", "link": "https://stackoverflow.com/users/4344586/frank-ak"}, "edited": false, "score": 0, "creation_date": 1522807739, "post_id": 49641623, "comment_id": 86290888, "body": "Assign with <code>61</code> but expect <code>100</code> output, how could do this?"}, {"owner": {"reputation": 43, "user_id": 7045130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/befb359d320b133b0e52995dd16a957e?s=128&d=identicon&r=PG&f=1", "display_name": "prestigem", "link": "https://stackoverflow.com/users/7045130/prestigem"}, "edited": false, "score": 0, "creation_date": 1522809486, "post_id": 49641623, "comment_id": 86291340, "body": "My mistake, I accidentally deleted the insert(first, 100) line that should be below first-&gt;next = NULL; when editing the code. I will change it in the main post as well"}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 7045130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/befb359d320b133b0e52995dd16a957e?s=128&d=identicon&r=PG&f=1", "display_name": "prestigem", "link": "https://stackoverflow.com/users/7045130/prestigem"}, "edited": false, "score": 0, "creation_date": 1522809689, "post_id": 49641683, "comment_id": 86291416, "body": "I just tried this out, and it seems like the value that is stored ends up being some random long number. Any idea why this might be?"}, {"owner": {"reputation": 43, "user_id": 7045130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/befb359d320b133b0e52995dd16a957e?s=128&d=identicon&r=PG&f=1", "display_name": "prestigem", "link": "https://stackoverflow.com/users/7045130/prestigem"}, "edited": false, "score": 0, "creation_date": 1522811026, "post_id": 49641683, "comment_id": 86291720, "body": "I found my error, I was passing in first rather than &amp;first in my insert function. Thanks!"}], "tags": [], "owner": {"reputation": 74, "user_id": 6111379, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iSB7h.jpg?s=128&g=1", "display_name": "nabhiraj jain", "link": "https://stackoverflow.com/users/6111379/nabhiraj-jain"}, "is_accepted": true, "score": 0, "last_activity_date": 1522810574, "last_edit_date": 1522810574, "creation_date": 1522807881, "answer_id": 49641683, "question_id": 49641623, "link": "https://stackoverflow.com/questions/49641623/issue-inserting-node-in-linked-list/49641683#49641683", "title": "Issue inserting node in linked list", "body": "<p>your passing a pointer to the node as a argument to the function and changing the value of formal parameter does not change the value of the actual parameter do this it should work.</p>\n\n<pre><code>enter code here\n\n\n\n#include &lt;stdio.h&gt;  \n#include &lt;stdlib.h&gt;\n\n   typedef struct node *nodePtr;\n   typedef struct node node;\n\n  struct node {\n  int value;\n  nodePtr next;\n   };\n\n\n void insert(node **first, int value)\n {\n nodePtr temp;\n temp = malloc(sizeof(node));\n temp-&gt;value = value;\n temp-&gt;next = *first;\n *first = temp;\n  }\n\n int main()\n {\n\nnodePtr first;\nfirst = malloc(sizeof(node));\nfirst-&gt;value = 61;\nfirst-&gt;next = NULL;\ninsert(&amp;first, 100);\nprintf(\"%d\",first-&gt;value);\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 648, "user_id": 5694959, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-TN18H3fTni4/AAAAAAAAAAI/AAAAAAAAAA8/HH8MErbPvAI/photo.jpg?sz=128", "display_name": "Monk", "link": "https://stackoverflow.com/users/5694959/monk"}, "is_accepted": false, "score": 0, "last_activity_date": 1522811130, "creation_date": 1522811130, "answer_id": 49642079, "question_id": 49641623, "link": "https://stackoverflow.com/questions/49641623/issue-inserting-node-in-linked-list/49642079#49642079", "title": "Issue inserting node in linked list", "body": "<p>You have passed a pointer to function <em>insert()</em> and stored it in a variable <em>first</em> whose scope is local to function <em>insert()</em>. Now you have\nupdated pointer <em>first</em> in function <em>insert()</em>.</p>\n\n<p>When you will return to <em>main()</em> function updated value of pointer <em>next</em> is lost that is why you are getting unexpected result while printing value in main().</p>\n\n<p>To summarise:</p>\n\n<pre><code>first = malloc(sizeof(node)); // let's say first is p1\n...\ninsert(first, 100); // first is P1\n....\n\nnode insert(node *first, int value) // first is p1\n....\ntmp = malloc(sizeof(node)); // let's say tmp is p2\nfirst = temp; // Now first has become p2 but its scope is local to insert()\n\n....\nprintf(\"%d\", first-&gt;value); // first is still p1 here\n</code></pre>\n\n<p><strong>Solution</strong></p>\n\n<pre><code>node* insert(node *first, int value)\n{\n    nodePtr temp;\n    temp = malloc(sizeof(node));\n    temp-&gt;value = value;\n    temp-&gt;next = first;\n    first = temp;\n    return first;\n}\n\nint main()\n{\n\n    nodePtr first;\n    first = malloc(sizeof(node));\n    first-&gt;value = 61;\n    first-&gt;next = NULL;\n    first = insert(first, 100);\n\n    printf(\"%d\", first-&gt;value);\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 7045130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/befb359d320b133b0e52995dd16a957e?s=128&d=identicon&r=PG&f=1", "display_name": "prestigem", "link": "https://stackoverflow.com/users/7045130/prestigem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 49641683, "answer_count": 2, "score": 0, "last_activity_date": 1522811130, "creation_date": 1522807479, "last_edit_date": 1522809510, "question_id": 49641623, "link": "https://stackoverflow.com/questions/49641623/issue-inserting-node-in-linked-list", "title": "Issue inserting node in linked list", "body": "<p>I am practicing creating a link list, but encountered a problem when trying to insert an item to the front of the list. The code in my insert function works properly if I put it within main, but not when run separately as a function.</p>\n\n<p>I am using a pointer as a argument in the function so I don't understand why the value in my print statement isn't changing to 100 which should be at the front of the linked list using the insert function (When I run the function 61 is printed, I am aiming for 100 to be printed).</p>\n\n<p>Thanks for the help!</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\ntypedef struct node *nodePtr;\ntypedef struct node node;\n\nstruct node {\n    int value;\n    nodePtr next;\n};\n\n\nnode insert(node *first, int value)\n{\n    nodePtr temp;\n    temp = malloc(sizeof(node));\n    temp-&gt;value = value;\n    temp-&gt;next = first;\n    first = temp;\n}\n\nint main()\n{\n\n    nodePtr first;\n    first = malloc(sizeof(node));\n    first-&gt;value = 61;\n    first-&gt;next = NULL;\n    insert(first, 100);\n\n    printf(\"%d\", first-&gt;value);\n}\n</code></pre>\n"}, {"tags": ["c++", "mysql", "c", "encryption"], "comments": [{"owner": {"reputation": 30756, "user_id": 5389997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d227900a17ca5c34bad6d2b27122c7f?s=128&d=identicon&r=PG&f=1", "display_name": "Shadow", "link": "https://stackoverflow.com/users/5389997/shadow"}, "edited": false, "score": 0, "creation_date": 1522818149, "post_id": 49641278, "comment_id": 86293814, "body": "What&#39;s the point of encrypting data on mysql field level? None of the above fields warrant such treatment."}, {"owner": {"reputation": 2467, "user_id": 1716525, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/Fn3LA.jpg?s=128&g=1", "display_name": "Roshan Mehta", "link": "https://stackoverflow.com/users/1716525/roshan-mehta"}, "reply_to_user": {"reputation": 30756, "user_id": 5389997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d227900a17ca5c34bad6d2b27122c7f?s=128&d=identicon&r=PG&f=1", "display_name": "Shadow", "link": "https://stackoverflow.com/users/5389997/shadow"}, "edited": false, "score": 0, "creation_date": 1522819653, "post_id": 49641278, "comment_id": 86294367, "body": "The requirements is to store the membership table or uid in membership table encrypted."}, {"owner": {"reputation": 30756, "user_id": 5389997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d227900a17ca5c34bad6d2b27122c7f?s=128&d=identicon&r=PG&f=1", "display_name": "Shadow", "link": "https://stackoverflow.com/users/5389997/shadow"}, "edited": false, "score": 0, "creation_date": 1522820293, "post_id": 49641278, "comment_id": 86294605, "body": "Then your requirements are probably wrong. The uid field is a key in several fields. If you encrypt it in the membership table then either you cannot maintain referential integrity, or you need to encrypt the uid field in every single table. But in the latter case, the encryption is pointless since the encrypted value acts as a reference point. Moreover, uid column seems to be a generated id field, so its value is meaningless without the data within the user table. Again, what&#39;s the point of field level encryption? What do you try to protect the data from?"}, {"owner": {"reputation": 2467, "user_id": 1716525, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/Fn3LA.jpg?s=128&g=1", "display_name": "Roshan Mehta", "link": "https://stackoverflow.com/users/1716525/roshan-mehta"}, "reply_to_user": {"reputation": 30756, "user_id": 5389997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d227900a17ca5c34bad6d2b27122c7f?s=128&d=identicon&r=PG&f=1", "display_name": "Shadow", "link": "https://stackoverflow.com/users/5389997/shadow"}, "edited": false, "score": 0, "creation_date": 1522820534, "post_id": 49641278, "comment_id": 86294707, "body": "I want no one(db admin) to know which user is member of which group."}, {"owner": {"reputation": 30756, "user_id": 5389997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d227900a17ca5c34bad6d2b27122c7f?s=128&d=identicon&r=PG&f=1", "display_name": "Shadow", "link": "https://stackoverflow.com/users/5389997/shadow"}, "edited": false, "score": 0, "creation_date": 1522834791, "post_id": 49641278, "comment_id": 86303313, "body": "Yeah, but the DBA is allowed to sell your users&#39; email addresses, right? The solution to this is not a field level encryption. First of all, a DBA can switch on query logging, which would capture your key to the encryption in plain text and can reverse the data using that. So, the whole idea is pointless. This falls into the area of privileged user access and data loss prevention. Both are lot more complex topics than what a simple symmetric encryption would be able to handle."}, {"owner": {"reputation": 2467, "user_id": 1716525, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/Fn3LA.jpg?s=128&g=1", "display_name": "Roshan Mehta", "link": "https://stackoverflow.com/users/1716525/roshan-mehta"}, "reply_to_user": {"reputation": 30756, "user_id": 5389997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d227900a17ca5c34bad6d2b27122c7f?s=128&d=identicon&r=PG&f=1", "display_name": "Shadow", "link": "https://stackoverflow.com/users/5389997/shadow"}, "edited": false, "score": 0, "creation_date": 1522835618, "post_id": 49641278, "comment_id": 86303872, "body": "So you mean to say, I am helpless here."}, {"owner": {"reputation": 30756, "user_id": 5389997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d227900a17ca5c34bad6d2b27122c7f?s=128&d=identicon&r=PG&f=1", "display_name": "Shadow", "link": "https://stackoverflow.com/users/5389997/shadow"}, "edited": false, "score": 0, "creation_date": 1522837277, "post_id": 49641278, "comment_id": 86305034, "body": "Not helpless. You are using a wrong approach. You need to do some proper thinking, rather than jumping to conclusions. I would even challenge that if you do not know anything else about your customers than their email addresses, then protecting group memberships is quite of an overreaction."}, {"owner": {"reputation": 2467, "user_id": 1716525, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/Fn3LA.jpg?s=128&g=1", "display_name": "Roshan Mehta", "link": "https://stackoverflow.com/users/1716525/roshan-mehta"}, "reply_to_user": {"reputation": 30756, "user_id": 5389997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d227900a17ca5c34bad6d2b27122c7f?s=128&d=identicon&r=PG&f=1", "display_name": "Shadow", "link": "https://stackoverflow.com/users/5389997/shadow"}, "edited": false, "score": 0, "creation_date": 1522837378, "post_id": 49641278, "comment_id": 86305101, "body": "Asking for a guideline, if you could."}, {"owner": {"reputation": 2467, "user_id": 1716525, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/Fn3LA.jpg?s=128&g=1", "display_name": "Roshan Mehta", "link": "https://stackoverflow.com/users/1716525/roshan-mehta"}, "reply_to_user": {"reputation": 30756, "user_id": 5389997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d227900a17ca5c34bad6d2b27122c7f?s=128&d=identicon&r=PG&f=1", "display_name": "Shadow", "link": "https://stackoverflow.com/users/5389997/shadow"}, "edited": false, "score": 0, "creation_date": 1522852885, "post_id": 49641278, "comment_id": 86316517, "body": "Is there a way I could hide user&#39;s membership details."}, {"owner": {"reputation": 2467, "user_id": 1716525, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/Fn3LA.jpg?s=128&g=1", "display_name": "Roshan Mehta", "link": "https://stackoverflow.com/users/1716525/roshan-mehta"}, "reply_to_user": {"reputation": 30756, "user_id": 5389997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d227900a17ca5c34bad6d2b27122c7f?s=128&d=identicon&r=PG&f=1", "display_name": "Shadow", "link": "https://stackoverflow.com/users/5389997/shadow"}, "edited": false, "score": 0, "creation_date": 1522939693, "post_id": 49641278, "comment_id": 86361508, "body": "Anyways, how the crud operation with mysql done when the fields are encrypted."}], "owner": {"reputation": 2467, "user_id": 1716525, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/Fn3LA.jpg?s=128&g=1", "display_name": "Roshan Mehta", "link": "https://stackoverflow.com/users/1716525/roshan-mehta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1522813612, "creation_date": 1522804749, "last_edit_date": 1522813612, "question_id": 49641278, "link": "https://stackoverflow.com/questions/49641278/crud-encrypted-mysql", "title": "CRUD encrypted MYSQL", "body": "<p><a href=\"https://i.stack.imgur.com/gmUfY.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/gmUfY.png\" alt=\"enter image description here\"></a>How to perform CRUD with MySQL when I wanted to store:</p>\n\n<ol>\n<li>All columns of a row as encrypted</li>\n<li>Only a specific column as encrypted.</li>\n</ol>\n\n<p>Do I have to use blob as datatype for the columns while creating the table? or it works with varchar, int, and other datatypes. Where should I specify encryption key, I am thinking of keeping it as a hardcoded value in the program. </p>\n\n<p>I am using C MYSQL connector(can change to C++ connector). A sample is much appreciated. At present my schema looks like this, please ignore row_hash column.</p>\n"}, {"tags": ["c", "arrays", "64-bit"], "comments": [{"owner": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "edited": false, "score": 1, "creation_date": 1522803306, "post_id": 49641062, "comment_id": 86289904, "body": "Do you want to multiply 64 bit integer with 64 bit OR 64 bit with 32 bit?"}, {"owner": {"reputation": 43, "user_id": 9593975, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6cfaff5240c546d1a8067327fff4f3b?s=128&d=identicon&r=PG&f=1", "display_name": "Khosrow", "link": "https://stackoverflow.com/users/9593975/khosrow"}, "reply_to_user": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "edited": false, "score": 0, "creation_date": 1522803711, "post_id": 49641062, "comment_id": 86289990, "body": "64 bit with 32 bit"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 2, "creation_date": 1522806220, "post_id": 49641062, "comment_id": 86290539, "body": "You need to split the two 32-bit numbers into four 16-bit numbers. That way, you can multiply two 16-bit <i>&quot;digits&quot;</i> without overflowing a 32-bit value. The rest is just grade school math: multiply the digits, add the results, handle the carries."}, {"owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1522810093, "post_id": 49641062, "comment_id": 86291513, "body": "<code>( a * 2^32 + b ) * c = ( a * c ) * 2^32 + ( b * c )</code>, leaving you with the need two perform two 32-bit multiplications and handle their carry. <a href=\"https://stackoverflow.com/q/1815367/589924\">This</a> shows how to multiply two 64-bit nums into two 64-bit nums. You would use the same approach to multiply two 32-bit nums into two 32-bit nums. This is the approach user3386109 describes."}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1522815515, "post_id": 49641062, "comment_id": 86292930, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/1355461/multiplying-two-32-bit-numbers-without-using-64-bit-int\">Multiplying two 32 bit numbers without using 64 bit int</a>"}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1522817534, "post_id": 49641062, "comment_id": 86293579, "body": "<a href=\"https://stackoverflow.com/q/7570005/995714\">algorithm to multiply 64 bit numbers using 32 bit unsigned integers</a>"}], "answers": [{"tags": [], "owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "is_accepted": false, "score": 3, "last_activity_date": 1522818815, "last_edit_date": 1522818815, "creation_date": 1522812197, "answer_id": 49642238, "question_id": 49641062, "link": "https://stackoverflow.com/questions/49641062/how-can-i-multiply-a-64-bit-unsigned-int-with-a-32-bit-unsigned-int-on-c-without/49642238#49642238", "title": "How can I multiply a 64-bit unsigned int with a 32-bit unsigned int on C without using long long?", "body": "<p>The first thing to realize is that we'll obtain a 96-bit number, as the following shows:</p>\n\n<p>(2<sup>64</sup> - 1) &times; (2<sup>32</sup> - 1)<br>\n= 2<sup>64</sup> &times; 2<sup>32</sup> - 2<sup>64</sup> - 2<sup>32</sup> + 1<br>\n= 2<sup>96</sup> - 2<sup>64</sup> - 2<sup>32</sup> + 1<br>\n&lt; 2<sup>96</sup></p>\n\n<p>The next thing to realize is that we can't use 32-bit multiplication. Even without a carry, the results are too large.</p>\n\n<p>(2<sup>32</sup> - 1) &times; (2<sup>32</sup> - 1)<br>\n= 2<sup>32</sup> &times; 2<sup>32</sup> - 2<sup>32</sup> - 2<sup>32</sup> + 1<br>\n= 2<sup>64</sup> - 2<sup>33</sup> + 1<br>\n&ge; 2<sup>32</sup></p>\n\n<p>We'll need to perform 16-bit multiplications instead. 16-bit multiplication can be done using 32-bit numbers without the possibility of overflow, even with a 16-bit carry.</p>\n\n<p>FFFF<sub>16</sub> &times; FFFF<sub>16</sub> + FFFF<sub>16</sub><br>\n= FFFF_0000<sub>16</sub><br>\n&lt; 2<sup>32</sup></p>\n\n<p>If we view the numbers as 16-bit values, the multiplication looks like:</p>\n\n<pre><code>                  +-----+-----+-----+-----+\n                  | ahi | alo | bhi | blo |\n                  +-----+-----+-----+-----+\n\n                              +-----+-----+\n                           \u00d7  | chi | clo |\n                              +-----+-----+\n\n===========================================\n\n      +-----+-----+-----+-----+-----+-----+\n      | dhi | dlo | ehi | elo | fhi | flo |\n      +-----+-----+-----+-----+-----+-----+\n</code></pre>\n\n<p>We all know how to do the above multiplication from elementary school, right?</p>\n\n<pre><code>      +-----+-----+-----+-----+     +-----+\n      | ahi | alo | bhi | blo |  \u00d7  | clo |\n      +-----+-----+-----+-----+     +-----+\n\n      +-----+-----+-----+-----+-----+     +-----+\n   +  | ahi | alo | bhi | blo |  0  |  \u00d7  | chi |\n      +-----+-----+-----+-----+-----+     +-----+\n</code></pre>\n\n<p>The means the following are all the tools we need:</p>\n\n<pre><code>void mul16c(\n   uint16_t i, uint16_t j, uint16_t cin,\n   uint16_t *prod_ptr, uint16_t *cout_ptr\n) {\n   uint32_t prod = i * j + cin;\n   *prod_ptr = prod &amp; 0xFFFF:\n   *cout_ptr = prod &gt;&gt; 16;\n}\n\nvoid add16c(\n   uint16_t i, uint16_t j, uint16_t cin,\n   uint16_t *sum_ptr, uint16_t* cout_ptr\n) {\n   uint32_t sum = i + j + cin;\n   *sum_ptr = sum &amp; 0xFFFF:\n   *cout_ptr = sum &gt;&gt; 16;\n}\n</code></pre>\n\n<p>And we can use them as follows:</p>\n\n<pre><code>void mul64x32(\n   uint32_t i[2], uint32_t j,\n   uint32_t (*prod_ptr)[2], uint32_t *cout_ptr\n) {\n   uint16_t i16[4];\n   i16[3] = i[1] &gt;&gt; 16;\n   i16[2] = i[1] &amp; 0xFFFF;\n   i16[1] = i[0] &gt;&gt; 16;\n   i16[0] = i[0] &amp; 0xFFFF;\n\n   uint16_t j16[2];\n   j16[1] = j[0] &gt;&gt; 16;\n   j16[0] = j[0] &amp; 0xFFFF;\n\n   uint16_t p[6];\n   {\n      uint16_t carry = 0;\n      mul16c(i16[0], j16[0], carry, &amp;(p[0]), &amp;carry);\n      mul16c(i16[1], j16[0], carry, &amp;(p[1]), &amp;carry);\n      mul16c(i16[2], j16[0], carry, &amp;(p[2]), &amp;carry);\n      mul16c(i16[3], j16[0], carry, &amp;(p[3]), &amp;carry);\n      p[4] = carry;\n      p[5] = 0;\n   }\n\n   uint16_t q[6];\n   {\n      uint16_t carry = 0;\n      q[0] = 0;\n      mul16c(i16[0], j16[1], carry, &amp;(q[1]), &amp;carry);\n      mul16c(i16[1], j16[1], carry, &amp;(q[2]), &amp;carry);\n      mul16c(i16[2], j16[1], carry, &amp;(q[3]), &amp;carry);\n      mul16c(i16[3], j16[1], carry, &amp;(q[4]), &amp;carry);\n      q[5] = carry;\n   }\n\n   uint16_t product[6];\n   {\n      uint16_t carry = 0;\n      add16c(p[0], q[0], carry, &amp;(product[0]), &amp;carry);\n      add16c(p[1], q[1], carry, &amp;(product[1]), &amp;carry);\n      add16c(p[2], q[2], carry, &amp;(product[2]), &amp;carry);\n      add16c(p[3], q[3], carry, &amp;(product[3]), &amp;carry);\n      add16c(p[4], q[4], carry, &amp;(product[4]), &amp;carry);\n      add16c(p[5], q[5], carry, &amp;(product[5]), &amp;carry);\n   }\n\n   (*prod_ptr)[0] = ( product[1] &lt;&lt; 16 ) | product[0];\n   (*prod_ptr)[1] = ( product[3] &lt;&lt; 16 ) | product[2];\n   *cout_ptr      = ( product[5] &lt;&lt; 16 ) | product[4];\n}\n</code></pre>\n\n<p>Element zero of each array is expected to be the least significant portion of the number.</p>\n"}], "owner": {"reputation": 43, "user_id": 9593975, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6cfaff5240c546d1a8067327fff4f3b?s=128&d=identicon&r=PG&f=1", "display_name": "Khosrow", "link": "https://stackoverflow.com/users/9593975/khosrow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 303, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1522818815, "creation_date": 1522802833, "last_edit_date": 1522812178, "question_id": 49641062, "link": "https://stackoverflow.com/questions/49641062/how-can-i-multiply-a-64-bit-unsigned-int-with-a-32-bit-unsigned-int-on-c-without", "title": "How can I multiply a 64-bit unsigned int with a 32-bit unsigned int on C without using long long?", "body": "<p>How can I multiply a 64-bit unsigned int with a 32-bit unsigned int without using <code>long long</code>. The 64-bit number is stored as an array of two 32-bit numbers.</p>\n\n<p>In other words, how I can I obtain <code>e</code> and <code>f</code> from <code>a</code>, <code>b</code> and <code>c</code> given the following:</p>\n\n<pre><code>( a * 2^32 + b ) * c = e * 2^32 + f\n</code></pre>\n\n<p><code>a</code>, <code>b</code>, <code>c</code>, <code>e</code> and <code>f</code> are all 32-bit unsigned integers, and only 32-bit math operations are available.</p>\n"}, {"tags": ["c", "arrays", "sorting"], "comments": [{"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1522801404, "post_id": 49640865, "comment_id": 86289532, "body": "You seem to be assuming that your inner &quot;x&quot; loop finds the smallest remaining item. It doesn&#39;t--it finds the highest-indexed item that happens to be smaller than the i-th item, but might be larger than some others."}, {"owner": {"reputation": 524, "user_id": 2123477, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/M59hC.jpg?s=128&g=1", "display_name": "woz", "link": "https://stackoverflow.com/users/2123477/woz"}, "edited": false, "score": 0, "creation_date": 1522803542, "post_id": 49640865, "comment_id": 86289953, "body": "<code>if (list[i].price &gt; list[x].price)</code> should be <code>if (list[x].price &lt; list[smallPosition].price)</code> . That should be enough. Otherwise, if you&#39;re not interested in your Selection Sort implementation, the answer below is a Bubble Sort implementation and should work."}], "answers": [{"comments": [{"owner": {"reputation": 524, "user_id": 2123477, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/M59hC.jpg?s=128&g=1", "display_name": "woz", "link": "https://stackoverflow.com/users/2123477/woz"}, "edited": false, "score": 2, "creation_date": 1522803873, "post_id": 49640974, "comment_id": 86290016, "body": "Even tough this should work, it&#39;s nice to point out that this is a BubbleSort implementation, and OP&#39;s original attempt was to create a SelectionSort implementation."}], "tags": [], "owner": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "is_accepted": false, "score": 0, "last_activity_date": 1522801998, "creation_date": 1522801998, "answer_id": 49640974, "question_id": 49640865, "link": "https://stackoverflow.com/questions/49640865/c-program-numbers-not-sorting-array-correctly/49640974#49640974", "title": "C Program numbers not sorting array correctly", "body": "<p>You should move the swap code inside the if statement:</p>\n\n<pre><code>for (int i = 0; i &lt; numProducts; i++)\n{\n    for (int x = i + 1; x &lt; numProducts; x++)\n    {\n        if (list[i].price &gt; list[x].price)\n        {\n            temp = list[i];\n            list[i] = list[X];\n            list[X] = temp;\n        }\n    }\n\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 524, "user_id": 2123477, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/M59hC.jpg?s=128&g=1", "display_name": "woz", "link": "https://stackoverflow.com/users/2123477/woz"}, "edited": false, "score": 1, "creation_date": 1522804158, "post_id": 49641158, "comment_id": 86290077, "body": "And a just a small improvement: before swap the elements check <code>if (smallPosition != i)</code>, then swap if true. This will prevent your swap operations to be done in case your array is already sorted."}], "tags": [], "owner": {"reputation": 41, "user_id": 7626496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9be5c508c07f304afb118a45cb883515?s=128&d=identicon&r=PG&f=1", "display_name": "Gabriel", "link": "https://stackoverflow.com/users/7626496/gabriel"}, "is_accepted": false, "score": 3, "last_activity_date": 1522803603, "creation_date": 1522803603, "answer_id": 49641158, "question_id": 49640865, "link": "https://stackoverflow.com/questions/49640865/c-program-numbers-not-sorting-array-correctly/49641158#49641158", "title": "C Program numbers not sorting array correctly", "body": "<p>Following up on <a href=\"https://stackoverflow.com/users/2192494/lee-daniel-crocker\">Lee Daniel Crocker</a>'s comment, you should dynamically compare with the value at <code>smallPosition</code> instead of <code>i</code> so that it will always point to the smallest remaining item:</p>\n\n<pre><code>    int smallPosition = i;\n    for (int x = i + 1; x &lt; numProducts; x++)\n    {\n        if (list[smallPosition].price &gt; list[x].price)\n        {\n            smallPosition = x;\n        }\n    }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 524, "user_id": 2123477, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/M59hC.jpg?s=128&g=1", "display_name": "woz", "link": "https://stackoverflow.com/users/2123477/woz"}, "edited": false, "score": 0, "creation_date": 1522839861, "post_id": 49641280, "comment_id": 86306686, "body": "I&#39;m downvoting this answer for two reasons:  1) That&#39;s exactly what @bruceg answers&#39; doing.  2) Also, OPs original idea is to implement a SelectionSort, as I commented on bruceg answer. Even tough they&#39;re both worst-case O(n&#178;) algorithms, when it comes to the avg. case, SelectionSort is fairly better than Bubble (read: <a href=\"https://en.wikipedia.org/wiki/Selection_sort#Comparison_to_other_sorting_algorithms\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/&hellip;</a>)"}], "tags": [], "owner": {"reputation": 9, "user_id": 9594005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aff24410c07c4d68eded39d0c6479630?s=128&d=identicon&r=PG", "display_name": "user9594005", "link": "https://stackoverflow.com/users/9594005/user9594005"}, "is_accepted": false, "score": 0, "last_activity_date": 1522804775, "creation_date": 1522804775, "answer_id": 49641280, "question_id": 49640865, "link": "https://stackoverflow.com/questions/49640865/c-program-numbers-not-sorting-array-correctly/49641280#49641280", "title": "C Program numbers not sorting array correctly", "body": "<p>Just use bubble sort.</p>\n\n<p>In the bubble sort you swap the values of the current value is bigger than the next one, if you do this action until you get to the end of the array then the array will be sorted.</p>\n"}], "owner": {"reputation": 11, "user_id": 9593932, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Frank Gatto", "link": "https://stackoverflow.com/users/9593932/frank-gatto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1522804775, "creation_date": 1522801059, "question_id": 49640865, "link": "https://stackoverflow.com/questions/49640865/c-program-numbers-not-sorting-array-correctly", "title": "C Program numbers not sorting array correctly", "body": "<p>I have an array of structs for products that I am trying to sort by name, type, price, and quantity. Name and type work, but price and quantity aren't working.\nMy code is: </p>\n\n<pre><code>else if (sort == sortByPrice)\n{\n    for (int i = 0; i &lt; numProducts; i++)\n    {\n        int smallPosition = i;\n        for (int x = i + 1; x &lt; numProducts; x++)\n        {\n            if (list[i].price &gt; list[x].price)\n            {\n                smallPosition = x;\n            }\n        }\n\n        temp = list[i];\n        list[i] = list[smallPosition];\n        list[smallPosition] = temp;\n    }\n\n}\nelse if (sort == sortByQty)\n{\n    for (int i = 0; i &lt; numProducts; i++)\n    {\n        int smallPosition = i;\n        for (int x = i + 1; x &lt; numProducts; x++)\n        {\n            if (list[i].qty &gt; list[x].qty)\n            {\n                smallPosition = x;\n            }\n        }\n\n        temp = list[i];\n        list[i] = list[smallPosition];\n        list[smallPosition] = temp;\n    }\n}\n</code></pre>\n\n<p>Can anyone tell me why it doesn't work/how to fix it?</p>\n"}, {"tags": ["c", "arrays", "memory", "stack", "memory-address"], "comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1522799090, "post_id": 49640614, "comment_id": 86288939, "body": "You assumed <code>arr</code> needs to exist at address <code>100</code>. That&#39;s a baseless assumption."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1522799342, "post_id": 49640614, "comment_id": 86289003, "body": "You can read several bytes in 1 memory access ; e.g. on 32-bit CPU it&#39;s normal to do a 32-bit read"}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1522799360, "post_id": 49640614, "comment_id": 86289006, "body": "It&#39;s hard to follow your broken English, but I think you&#39;re asking about how arrays are stored and accessed in memory. That&#39;s a very architecture- and implementation-specific thing. Most modern architectures have many addressing modes so they can access stack-relative addresses easily for variables declared auto, and index registers that make it easy for variables declared static. Very rarely should it be necessary to store the actual address of an array in memory anywhere."}, {"owner": {"reputation": 51, "user_id": 7110415, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/71df795b1d0639ea77e06516545f1405?s=128&d=identicon&r=PG&f=1", "display_name": "slowjams", "link": "https://stackoverflow.com/users/7110415/slowjams"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 1, "creation_date": 1522799368, "post_id": 49640614, "comment_id": 86289009, "body": "@StoryTeller   yes I know, it can exist in your reasonable address, but array&#39;s address is not important in the context, isn&#39;t it?"}, {"owner": {"reputation": 51, "user_id": 7110415, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/71df795b1d0639ea77e06516545f1405?s=128&d=identicon&r=PG&f=1", "display_name": "slowjams", "link": "https://stackoverflow.com/users/7110415/slowjams"}, "reply_to_user": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1522799640, "post_id": 49640614, "comment_id": 86289091, "body": "@LeeDanielCrocker sorry for the hard understanding, so what&#39;s the value of arr in  modern architectures? I understand assembly language a little bit, so do you mean arr is not saved on the stack?"}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1522799789, "post_id": 49640614, "comment_id": 86289132, "body": "&quot;arr&quot; is a symbol the compiler uses to refer to some piece of memory--it might be a stack offset, it might be a physical ram address. But the compiler will generate appropriate code to access it--its address is not necessarily stored anywhere at runtime. Compile some code and look at the assembly generated. Why ask us humans when you can get the answer from the source?"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1522800566, "post_id": 49640614, "comment_id": 86289328, "body": "Dump the assembly code generated by your program. I suspect you will find access to each element uses a single - <code>lea</code> instruction (<i>load effective address</i>). In that case, the single-access is correct."}, {"owner": {"reputation": 51, "user_id": 7110415, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/71df795b1d0639ea77e06516545f1405?s=128&d=identicon&r=PG&f=1", "display_name": "slowjams", "link": "https://stackoverflow.com/users/7110415/slowjams"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1522819694, "post_id": 49640614, "comment_id": 86294383, "body": "@DavidC.Rankin  yes there was lea instruction like lea arr(%eax...) which is arr + offset address, but I don&#39;t understand that arr seems to be 8, which means that arr has been memory access to get value of 8"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1522820651, "post_id": 49640614, "comment_id": 86294750, "body": "<code>lea</code> is a special function that can compute+load. So instead of 2 instruction 1 for offset and 2 to load, lea does it all in one. <code>:)</code>"}, {"owner": {"reputation": 1034897, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 0, "creation_date": 1581062454, "post_id": 49640614, "comment_id": 106311295, "body": "@slowjams Don&#39;t forget, for this question and your other questions, to select an answer, as explained in <a href=\"https://stackoverflow.com/help/someone-answers\">stackoverflow.com/help/someone-answers</a>."}], "answers": [{"comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1522800433, "post_id": 49640784, "comment_id": 86289296, "body": "What if <code>LEA</code> is used? That would be a single-instruction and single access."}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1522801073, "post_id": 49640784, "comment_id": 86289437, "body": "You&#39;re neither wrong nor right--it&#39;s entirely up to the compiler/architecture."}, {"owner": {"reputation": 51, "user_id": 7110415, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/71df795b1d0639ea77e06516545f1405?s=128&d=identicon&r=PG&f=1", "display_name": "slowjams", "link": "https://stackoverflow.com/users/7110415/slowjams"}, "edited": false, "score": 0, "creation_date": 1522818977, "post_id": 49640784, "comment_id": 86294122, "body": "@Vimarsh  thats not what the text book mean, the textbook is comparing multi level array(one memory access) and multi dimension array(two memory access)"}], "tags": [], "owner": {"reputation": 95, "user_id": 9478461, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1a804a10301b719aa18cdb407db4cd3?s=128&d=identicon&r=PG&f=1", "display_name": "Vimarsh", "link": "https://stackoverflow.com/users/9478461/vimarsh"}, "is_accepted": false, "score": 0, "last_activity_date": 1522800289, "creation_date": 1522800289, "answer_id": 49640784, "question_id": 49640614, "link": "https://stackoverflow.com/questions/49640614/why-memory-access-only-once-for-accessing-arrays-elements/49640784#49640784", "title": "why memory access only once for accessing array&#39;s elements", "body": "<p>Yes, you are correct. There will be two memory access.</p>\n\n<p>But what textbooks mean by single memory access is that once you have value of arr (the memory address from where array starts) and you know the offset, you require only one memory access, unlike in data structure like linked list where you will have to make 3 calls.</p>\n\n<p>For your other question, first the array will be allocated the memory. This will happen as soon as the scope of this array begins, and when it reaches the particular command, the values will be copied to the allocated address.</p>\n"}], "owner": {"reputation": 51, "user_id": 7110415, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/71df795b1d0639ea77e06516545f1405?s=128&d=identicon&r=PG&f=1", "display_name": "slowjams", "link": "https://stackoverflow.com/users/7110415/slowjams"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 98, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1522800289, "creation_date": 1522798971, "question_id": 49640614, "link": "https://stackoverflow.com/questions/49640614/why-memory-access-only-once-for-accessing-arrays-elements", "title": "why memory access only once for accessing array&#39;s elements", "body": "<p>I was reading a textbook says that it only need one memory access when accessing an array's element? I don't quite get it especially when it is associated with assembly language and stack, let say we declare an array </p>\n\n<pre><code>char arr[3] = {'a','b','c'};\n</code></pre>\n\n<p>Lets say on the stack, first array's element a's address on the stack is 8 (I know it shoud be hex 0x...., for simplicity's sake), so b's address is 9, c is 10, so variable arr holds value of 8(first element's address) and arr itself address is something like 100. so to get the second element of the array:</p>\n\n<ol>\n<li>we get the arr's holding value which is 8 (this is the first memory access as we get the value of arr, isn't it? )</li>\n<li>once we have the address 8, then we offset 1 to get address 9, then we read this address's value(second memory access, so why the textbook says it only need one memory access)?</li>\n<li>when we declare the array, is the values(a, b,c) pushed to the stack first or the point variable arr is pushed to the stack first?</li>\n</ol>\n"}, {"tags": ["c", "gcc", "makefile", "cross-compiling", "mingw32"], "comments": [{"owner": {"reputation": 79096, "user_id": 865874, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ACMnN.png?s=128&g=1", "display_name": "rodrigo", "link": "https://stackoverflow.com/users/865874/rodrigo"}, "edited": false, "score": 1, "creation_date": 1522793346, "post_id": 49639796, "comment_id": 86287311, "body": "I seem to remember that the <code>-lwhatever</code> options must be after the object files, due to the way the linker works in Windows. It is usually better to separate <code>CFLAGS</code> and <code>LDFLAGS</code> for the compiler and linker options."}, {"owner": {"reputation": 63, "user_id": 2559392, "user_type": "registered", "profile_image": "https://graph.facebook.com/606277883/picture?type=large", "display_name": "Jeremy Gilbert", "link": "https://stackoverflow.com/users/2559392/jeremy-gilbert"}, "reply_to_user": {"reputation": 79096, "user_id": 865874, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ACMnN.png?s=128&g=1", "display_name": "rodrigo", "link": "https://stackoverflow.com/users/865874/rodrigo"}, "edited": false, "score": 0, "creation_date": 1522793553, "post_id": 49639796, "comment_id": 86287386, "body": "Thank you for the input, I moved things around so <code>-lfiles</code> are after objects, but still getting the same error."}, {"owner": {"reputation": 79096, "user_id": 865874, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ACMnN.png?s=128&g=1", "display_name": "rodrigo", "link": "https://stackoverflow.com/users/865874/rodrigo"}, "edited": false, "score": 0, "creation_date": 1522793594, "post_id": 49639796, "comment_id": 86287396, "body": "Can you post the full linker command that is actually running?"}, {"owner": {"reputation": 63, "user_id": 2559392, "user_type": "registered", "profile_image": "https://graph.facebook.com/606277883/picture?type=large", "display_name": "Jeremy Gilbert", "link": "https://stackoverflow.com/users/2559392/jeremy-gilbert"}, "reply_to_user": {"reputation": 79096, "user_id": 865874, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ACMnN.png?s=128&g=1", "display_name": "rodrigo", "link": "https://stackoverflow.com/users/865874/rodrigo"}, "edited": false, "score": 0, "creation_date": 1522793759, "post_id": 49639796, "comment_id": 86287455, "body": "Are you referring to what the output I see in terminal is when I type make?"}, {"owner": {"reputation": 79096, "user_id": 865874, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ACMnN.png?s=128&g=1", "display_name": "rodrigo", "link": "https://stackoverflow.com/users/865874/rodrigo"}, "edited": false, "score": 0, "creation_date": 1522793989, "post_id": 49639796, "comment_id": 86287536, "body": "Well, yes, the most interesting line is that call to <code>x86_64-w64-mingw32-gcc</code> with <code>-o main</code> and all the other stuff."}, {"owner": {"reputation": 79096, "user_id": 865874, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ACMnN.png?s=128&g=1", "display_name": "rodrigo", "link": "https://stackoverflow.com/users/865874/rodrigo"}, "edited": false, "score": 2, "creation_date": 1522794138, "post_id": 49639796, "comment_id": 86287579, "body": "But you still have the <code>-l*</code> before the object files!"}, {"owner": {"reputation": 63, "user_id": 2559392, "user_type": "registered", "profile_image": "https://graph.facebook.com/606277883/picture?type=large", "display_name": "Jeremy Gilbert", "link": "https://stackoverflow.com/users/2559392/jeremy-gilbert"}, "reply_to_user": {"reputation": 79096, "user_id": 865874, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ACMnN.png?s=128&g=1", "display_name": "rodrigo", "link": "https://stackoverflow.com/users/865874/rodrigo"}, "edited": false, "score": 0, "creation_date": 1522794275, "post_id": 49639796, "comment_id": 86287620, "body": "Ah, I copied the code from BEFORE I changed that, haha. ok what about now?"}, {"owner": {"reputation": 79096, "user_id": 865874, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ACMnN.png?s=128&g=1", "display_name": "rodrigo", "link": "https://stackoverflow.com/users/865874/rodrigo"}, "edited": false, "score": 0, "creation_date": 1522794559, "post_id": 49639796, "comment_id": 86287702, "body": "I guessed so much... could you post that command line AFTER the change? And also could you check any error messages are different with that change?"}], "answers": [{"tags": [], "owner": {"reputation": 63, "user_id": 2559392, "user_type": "registered", "profile_image": "https://graph.facebook.com/606277883/picture?type=large", "display_name": "Jeremy Gilbert", "link": "https://stackoverflow.com/users/2559392/jeremy-gilbert"}, "is_accepted": false, "score": 0, "last_activity_date": 1522794772, "creation_date": 1522794772, "answer_id": 49640039, "question_id": 49639796, "link": "https://stackoverflow.com/questions/49639796/whats-wrong-with-my-cross-compiling-makefile/49640039#49640039", "title": "What&#39;s wrong with my cross compiling makefile?", "body": "<p>I switched the objects and cflags at the top, but forgotten to switch objects and cflags in </p>\n\n<p><code>main : $(OBJECTS)\n$(CC) $(OBJECTS) $(CFLAGS) -o main</code> </p>\n\n<p>Now I only get a undefined reference to WinMain</p>\n\n<pre><code>$ make\nx86_64-w64-mingw32-gcc -Wall -O2 -lmingw32 -lm -lGL -lGLU -lSDL_image - \nlfftw3 -lftdi1 -mwindows `sdl-config --cflags --libs` -c main.c\nx86_64-w64-mingw32-gcc -Wall -O2 -lmingw32 -lm -lGL -lGLU -lSDL_image - \nlfftw3 -lftdi1 -mwindows `sdl-config --cflags --libs` -c fft.c\nx86_64-w64-mingw32-gcc -Wall -O2 -lmingw32 -lm -lGL -lGLU -lSDL_image - \nlfftw3 -lftdi1 -mwindows `sdl-config --cflags --libs` -c draw.c\nx86_64-w64-mingw32-gcc -Wall -O2 -lmingw32 -lm -lGL -lGLU -lSDL_image - \nlfftw3 -lftdi1 -mwindows `sdl-config --cflags --libs` -c table.c\nx86_64-w64-mingw32-gcc -Wall -O2 -lmingw32 -lm -lGL -lGLU -lSDL_image - \nlfftw3 -lftdi1 -mwindows `sdl-config --cflags --libs` -c serial.c\nx86_64-w64-mingw32-gcc main.o fft.o draw.o table.o serial.o -Wall -O2 - \nlmingw32 -lm -lGL -lGLU -lSDL_image -lfftw3 -lftdi1 -mwindows `sdl-config -- \ncflags --libs` -o main\n/usr/x86_64-w64-mingw32/sys- \nroot/mingw/lib/../lib/libmingw32.a(lib64_libmingw32_a-crt0_c.o): In function \n`main':\n/usr/src/debug/mingw64-x86_64-runtime-5.0.3-1/crt/crt0_c.c:18: undefined \nreference to `WinMain'\ncollect2: error: ld returned 1 exit status\nmake: *** [makefile:6: main] Error 1\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 63, "user_id": 2559392, "user_type": "registered", "profile_image": "https://graph.facebook.com/606277883/picture?type=large", "display_name": "Jeremy Gilbert", "link": "https://stackoverflow.com/users/2559392/jeremy-gilbert"}, "edited": false, "score": 0, "creation_date": 1522795311, "post_id": 49640090, "comment_id": 86287935, "body": "Ah ok, I see the difference there. Layout looks more organized too. I tried changing -mwindows to -mconsole and no change to error"}, {"owner": {"reputation": 63, "user_id": 2559392, "user_type": "registered", "profile_image": "https://graph.facebook.com/606277883/picture?type=large", "display_name": "Jeremy Gilbert", "link": "https://stackoverflow.com/users/2559392/jeremy-gilbert"}, "edited": false, "score": 0, "creation_date": 1522798339, "post_id": 49640090, "comment_id": 86288764, "body": "Still no advance on the <code>WinMain</code> reference. I&#39;ve tried adding <code>#include &lt;windows.h&gt;</code> into my main.c file that I read somewhere. also, my main.c does have a line that says <code>int main</code> so could that be causing some problem? do I need to do something to cygwin to make it look for something else?"}, {"owner": {"reputation": 79096, "user_id": 865874, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ACMnN.png?s=128&g=1", "display_name": "rodrigo", "link": "https://stackoverflow.com/users/865874/rodrigo"}, "reply_to_user": {"reputation": 63, "user_id": 2559392, "user_type": "registered", "profile_image": "https://graph.facebook.com/606277883/picture?type=large", "display_name": "Jeremy Gilbert", "link": "https://stackoverflow.com/users/2559392/jeremy-gilbert"}, "edited": false, "score": 1, "creation_date": 1522798695, "post_id": 49640090, "comment_id": 86288848, "body": "Ahh! You are using SDL so you have that infamous <code>SDL_main</code> issue. You can try linking with <code>SDL_main.a</code> OR adding <code>#undef main</code> just before your <code>main</code> function."}, {"owner": {"reputation": 63, "user_id": 2559392, "user_type": "registered", "profile_image": "https://graph.facebook.com/606277883/picture?type=large", "display_name": "Jeremy Gilbert", "link": "https://stackoverflow.com/users/2559392/jeremy-gilbert"}, "edited": false, "score": 0, "creation_date": 1522798722, "post_id": 49640090, "comment_id": 86288855, "body": "hey! <code>#ifdef main # undef main #endif &#47;* main *&#47;</code> worked!"}, {"owner": {"reputation": 63, "user_id": 2559392, "user_type": "registered", "profile_image": "https://graph.facebook.com/606277883/picture?type=large", "display_name": "Jeremy Gilbert", "link": "https://stackoverflow.com/users/2559392/jeremy-gilbert"}, "edited": false, "score": 0, "creation_date": 1522798843, "post_id": 49640090, "comment_id": 86288880, "body": "Now I have my .exe! but when I try to run it, I get several missing .dll errors including cygftdi-1.2.dll cygGLU-1.dll cygfftw3-3.dll cygGL-1.dll"}, {"owner": {"reputation": 79096, "user_id": 865874, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ACMnN.png?s=128&g=1", "display_name": "rodrigo", "link": "https://stackoverflow.com/users/865874/rodrigo"}, "reply_to_user": {"reputation": 63, "user_id": 2559392, "user_type": "registered", "profile_image": "https://graph.facebook.com/606277883/picture?type=large", "display_name": "Jeremy Gilbert", "link": "https://stackoverflow.com/users/2559392/jeremy-gilbert"}, "edited": false, "score": 0, "creation_date": 1522799096, "post_id": 49640090, "comment_id": 86288942, "body": "Sorry, I&#39;m not familiar with Cygwin internals, just with MinGW... But do you have those DLLs in the PATH? Also I have heard that you can have problems if you mix MinGW and Cygwin improperly..."}, {"owner": {"reputation": 63, "user_id": 2559392, "user_type": "registered", "profile_image": "https://graph.facebook.com/606277883/picture?type=large", "display_name": "Jeremy Gilbert", "link": "https://stackoverflow.com/users/2559392/jeremy-gilbert"}, "edited": false, "score": 0, "creation_date": 1522799309, "post_id": 49640090, "comment_id": 86288994, "body": "I find them in my ..\\cygwin\\lib directory but they all have <code>.dll.a</code> can I copy these to another location so the .exe can find them?"}, {"owner": {"reputation": 79096, "user_id": 865874, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ACMnN.png?s=128&g=1", "display_name": "rodrigo", "link": "https://stackoverflow.com/users/865874/rodrigo"}, "reply_to_user": {"reputation": 63, "user_id": 2559392, "user_type": "registered", "profile_image": "https://graph.facebook.com/606277883/picture?type=large", "display_name": "Jeremy Gilbert", "link": "https://stackoverflow.com/users/2559392/jeremy-gilbert"}, "edited": false, "score": 0, "creation_date": 1522799471, "post_id": 49640090, "comment_id": 86289038, "body": "I don&#39;t think so, you need the real DLL. I think Cygwin comes with a package manager, so that is where to begin. Then you have to add the directory to the PATH or copy the DLLs to the same directory where the EXE is."}, {"owner": {"reputation": 63, "user_id": 2559392, "user_type": "registered", "profile_image": "https://graph.facebook.com/606277883/picture?type=large", "display_name": "Jeremy Gilbert", "link": "https://stackoverflow.com/users/2559392/jeremy-gilbert"}, "edited": false, "score": 0, "creation_date": 1522799617, "post_id": 49640090, "comment_id": 86289081, "body": "Ok, I did use the package manager to add fftw3, ftdi1, GLU, and GL, so now I just need to figure out how to add them to the PATH. Is that something I need to go back and add to the makefile?"}, {"owner": {"reputation": 79096, "user_id": 865874, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ACMnN.png?s=128&g=1", "display_name": "rodrigo", "link": "https://stackoverflow.com/users/865874/rodrigo"}, "reply_to_user": {"reputation": 63, "user_id": 2559392, "user_type": "registered", "profile_image": "https://graph.facebook.com/606277883/picture?type=large", "display_name": "Jeremy Gilbert", "link": "https://stackoverflow.com/users/2559392/jeremy-gilbert"}, "edited": false, "score": 0, "creation_date": 1522799864, "post_id": 49640090, "comment_id": 86289154, "body": "No, the PATH is an environment variable, nothing to do with the Makefile."}, {"owner": {"reputation": 63, "user_id": 2559392, "user_type": "registered", "profile_image": "https://graph.facebook.com/606277883/picture?type=large", "display_name": "Jeremy Gilbert", "link": "https://stackoverflow.com/users/2559392/jeremy-gilbert"}, "edited": false, "score": 0, "creation_date": 1522800032, "post_id": 49640090, "comment_id": 86289193, "body": "Ok now I found all the .dll files without the .a in my cygwin/bin folder"}], "tags": [], "owner": {"reputation": 79096, "user_id": 865874, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ACMnN.png?s=128&g=1", "display_name": "rodrigo", "link": "https://stackoverflow.com/users/865874/rodrigo"}, "is_accepted": true, "score": 1, "last_activity_date": 1522795091, "creation_date": 1522795091, "answer_id": 49640090, "question_id": 49639796, "link": "https://stackoverflow.com/questions/49639796/whats-wrong-with-my-cross-compiling-makefile/49640090#49640090", "title": "What&#39;s wrong with my cross compiling makefile?", "body": "<p>When you link to a SO in Linux , for example with <code>-lGL</code>, you are linking the shared object directly <code>libGL.so</code>.</p>\n\n<p>But in Windows, when you link a DLL you are actually linking a static library <code>libGL.a</code> (<code>libGL.lib</code> in native Windows) that contains one thunk per imported function.</p>\n\n<p>And as it happens, linker rules are different between shared and static libraries. Static libraries are linked using the order in the linker command line.</p>\n\n<p><strong>TL;DR;</strong> You have to put the <code>-l*</code> at the end of the linker command. Also, it is a good practice to separate <code>CFLAGS</code> and <code>LDFLAGS</code>:</p>\n\n<pre><code>CC = x86_64-w64-mingw32-gcc\nCFLAGS = -Wall -O2 `sdl-config --cflags`\nLDFLAGS = -lmingw32 -lGL -lGLU -lm -lSDL_image -lfftw3 -lftdi1 -mwindows `sdl-config --libs`\n\nOBJECTS = main.o fft.o draw.o table.o serial.o\n\nmain : $(OBJECTS)\n$(CC) -o $@ $(CFLAGS) $(OBJECTS) $(LDFLAGS)\n\n%.o : %.c\n$(CC) $(CFLAGS) -c $&lt;\n</code></pre>\n\n<p>About the <code>WinMain</code> reference, that is because you wrote <code>-mwindows</code>: that is to build a Windows application, that is one that starts with <code>WinMain()</code> instead of <code>main()</code>. If you want to stick to your <code>main()</code> you can use <code>-mconsole</code> instead.</p>\n"}], "owner": {"reputation": 63, "user_id": 2559392, "user_type": "registered", "profile_image": "https://graph.facebook.com/606277883/picture?type=large", "display_name": "Jeremy Gilbert", "link": "https://stackoverflow.com/users/2559392/jeremy-gilbert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 421, "favorite_count": 0, "accepted_answer_id": 49640090, "answer_count": 2, "score": 1, "last_activity_date": 1522795091, "creation_date": 1522793000, "last_edit_date": 1522794387, "question_id": 49639796, "link": "https://stackoverflow.com/questions/49639796/whats-wrong-with-my-cross-compiling-makefile", "title": "What&#39;s wrong with my cross compiling makefile?", "body": "<p>I have spent several days now trying to cross compile a c program on my windows machine. the code runs fine on my linux machine but I had too many errors trying to cross compile it on that machine. Now I'm using Cygwin and Mingw32.</p>\n\n<pre><code>    CC = x86_64-w64-mingw32-gcc\n    CFLAGS = -Wall -O2 -lmingw32 -lGL -lGLU -lm -lSDL_image -lfftw3 -lftdi1 \n    -mwindows `sdl-config --cflags --libs`\n\n    OBJECTS = main.o fft.o draw.o table.o serial.o\n\n    main : $(OBJECTS)\n    $(CC) $(CFLAGS) $(OBJECTS) -o main\n\n    %.o : %.c\n    $(CC) $(CFLAGS) -c $&lt;\n\n    clean:\n    @echo Cleaning up...\n    rm -fr *.o main\n    @echo Done.\n</code></pre>\n\n<p>This is what my makefile looks like after editing it to what I thought was needed to cross compile it. But I get many undefined reference errors. I realize this question is very similar to a few others I've looked over on SO, but I cannot seem to find my mistake.</p>\n\n<pre><code> $ make\n x86_64-w64-mingw32-gcc -Wall -O2 -lmingw32 -lGL -lGLU -lm -lSDL_image - \n lfftw3 -lftdi1 -mwindows `sdl-config --cflags --libs` -c main.c\n x86_64-w64-mingw32-gcc -Wall -O2 -lmingw32 -lGL -lGLU -lm -lSDL_image - \n lfftw3 -lftdi1 -mwindows `sdl-config --cflags --libs` -c fft.c\n x86_64-w64-mingw32-gcc -Wall -O2 -lmingw32 -lGL -lGLU -lm -lSDL_image - \n lfftw3 -lftdi1 -mwindows `sdl-config --cflags --libs` -c draw.c\n x86_64-w64-mingw32-gcc -Wall -O2 -lmingw32 -lGL -lGLU -lm -lSDL_image - \n lfftw3 -lftdi1 -mwindows `sdl-config --cflags --libs` -c table.c\n x86_64-w64-mingw32-gcc -Wall -O2 -lmingw32 -lGL -lGLU -lm -lSDL_image - \n lfftw3 - \n lftdi1 -mwindows `sdl-config --cflags --libs` -c serial.c\n x86_64-w64-mingw32-gcc -Wall -O2 -lmingw32 -lGL -lGLU -lm -lSDL_image - \n lfftw3 - \n lftdi1 -mwindows `sdl-config --cflags --libs` main.o fft.o draw.o table.o \n serial.o -o main\n/usr/x86_64-w64-mingw32/sys-root/mingw/lib/../lib/libmingw32.a(lib64_libmingw32_a-crt0_c.o): In function `main':\n/usr/src/debug/mingw64-x86_64-runtime-5.0.3-1/crt/crt0_c.c:18: undefined reference to `WinMain'\nfft.o:fft.c:(.text+0xa): undefined reference to `fftw_malloc'\nfft.o:fft.c:(.text+0x1b): undefined reference to `fftw_malloc'\nfft.o:fft.c:(.text+0x2c): undefined reference to `fftw_malloc'\nfft.o:fft.c:(.text+0x4d): undefined reference to `fftw_plan_dft_r2c_1d'\nfft.o:fft.c:(.text+0x73d): undefined reference to `fftw_execute'\ndraw.o:draw.c:(.text+0xb): undefined reference to `__imp_glShadeModel'\ndraw.o:draw.c:(.text+0x1e): undefined reference to `__imp_glClearColor'\ndraw.o:draw.c:(.text+0x43): undefined reference to `gluOrtho2D'\ndraw.o:draw.c:(.text+0x4e): undefined reference to `__imp_glDisable'\ndraw.o:draw.c:(.text+0x5e): undefined reference to `__imp_glEnable'\ndraw.o:draw.c:(.text+0x82): undefined reference to `__imp_glViewport'\ndraw.o:draw.c:(.text+0x8e): undefined reference to `__imp_glMatrixMode'\ndraw.o:draw.c:(.text+0x97): undefined reference to `__imp_glLoadIdentity'\ndraw.o:draw.c:(.text+0xbe): undefined reference to `gluOrtho2D'\ndraw.o:draw.c:(.text+0xeb): undefined reference to `SDL_Init'\ndraw.o:draw.c:(.text+0xf4): undefined reference to `SDL_GetVideoInfo'\ndraw.o:draw.c:(.text+0x11c): undefined reference to `SDL_GL_SetAttribute'\ndraw.o:draw.c:(.text+0x13a): undefined reference to `SDL_SetVideoMode'\ndraw.o:draw.c:(.text+0x171): undefined reference to `SDL_GetError'\ndraw.o:draw.c:(.text+0x1a1): undefined reference to `SDL_GetError'\ndraw.o:draw.c:(.text+0x1d1): undefined reference to `SDL_GetError'\ndraw.o:draw.c:(.text+0x244): undefined reference to `__imp_glBegin'\ndraw.o:draw.c:(.text+0x24b): undefined reference to `__imp_glColor3ub'\ndraw.o:draw.c:(.text+0x252): undefined reference to `__imp_glVertex2f'\ndraw.o:draw.c:(.text+0x29f): undefined reference to `__imp_glEnd'\ndraw.o:draw.c:(.text+0x415): undefined reference to `__imp_glBegin'\ndraw.o:draw.c:(.text+0x42c): undefined reference to `__imp_glColor3ub'\ndraw.o:draw.c:(.text+0x447): undefined reference to `__imp_glVertex2f'\ndraw.o:draw.c:(.text+0x4ef): undefined reference to `__imp_glEnd'\ndraw.o:draw.c:(.text+0x55b): undefined reference to `__imp_glColor3ub'\ndraw.o:draw.c:(.text+0x574): undefined reference to `__imp_glBegin'\ndraw.o:draw.c:(.text+0x580): undefined reference to `__imp_glVertex2f'\ndraw.o:draw.c:(.text+0x5e4): undefined reference to `__imp_glEnd'\ndraw.o:draw.c:(.text+0x602): undefined reference to `__imp_glColor3ub'\ndraw.o:draw.c:(.text+0x638): undefined reference to `__imp_glBegin'\ndraw.o:draw.c:(.text+0x648): undefined reference to `__imp_glColor3ub'\ndraw.o:draw.c:(.text+0x664): undefined reference to `__imp_glVertex2f'\ndraw.o:draw.c:(.text+0x6b8): undefined reference to `__imp_glEnd'\ndraw.o:draw.c:(.text+0x6e8): undefined reference to `__imp_glBegin'\ndraw.o:draw.c:(.text+0x6fb): undefined reference to `__imp_glColor3ub'\ndraw.o:draw.c:(.text+0x717): undefined reference to `__imp_glVertex2f'\ndraw.o:draw.c:(.text+0x76b): undefined reference to `__imp_glEnd'\ndraw.o:draw.c:(.text+0x7b5): undefined reference to `__imp_glBegin'\ndraw.o:draw.c:(.text+0x80d): undefined reference to `__imp_glColor3ub'\ndraw.o:draw.c:(.text+0x814): undefined reference to `__imp_glVertex2f'\ndraw.o:draw.c:(.text+0x935): undefined reference to `__imp_glEnd'\ndraw.o:draw.c:(.text+0xa00): undefined reference to `__imp_glBegin'\ndraw.o:draw.c:(.text+0xa07): undefined reference to `__imp_glColor3ub'\ndraw.o:draw.c:(.text+0xa0e): undefined reference to `__imp_glVertex2f'\ndraw.o:draw.c:(.text+0xb0b): undefined reference to `__imp_glEnd'\ndraw.o:draw.c:(.text+0xc09): undefined reference to `__imp_glBegin'\ndraw.o:draw.c:(.text+0xc10): undefined reference to `__imp_glColor3ub'\ndraw.o:draw.c:(.text+0xc19): undefined reference to `__imp_glVertex2f'\ndraw.o:draw.c:(.text+0xc20): undefined reference to `__imp_glEnd'\ndraw.o:draw.c:(.text+0xea7): undefined reference to `__imp_glClear'\ndraw.o:draw.c:(.text+0xeb2): undefined reference to `__imp_glMatrixMode'\ndraw.o:draw.c:(.text+0xeb8): undefined reference to `__imp_glLoadIdentity'\ndraw.o:draw.c:(.text+0xec7): undefined reference to `__imp_glTranslatef'\ndraw.o:draw.c:(.text+0xf48): undefined reference to `__imp_glBegin'\ndraw.o:draw.c:(.text+0xf72): undefined reference to `__imp_glColor3ub'\ndraw.o:draw.c:(.text+0xf8f): undefined reference to `__imp_glVertex2f'\ndraw.o:draw.c:(.text+0xfba): undefined reference to `__imp_glEnd'\ndraw.o:draw.c:(.text+0x1089): undefined reference to `SDL_GL_SwapBuffers'\ndraw.o:draw.c:(.text+0x10c3): undefined reference to `__imp_glColor3ub'\ndraw.o:draw.c:(.text+0x10d8): undefined reference to `SDL_GetKeyState'\ndraw.o:draw.c:(.text+0x133d): undefined reference to `SDL_WM_ToggleFullScreen'\ndraw.o:draw.c:(.text+0x1364): undefined reference to `SDL_PollEvent'\ndraw.o:draw.c:(.text+0x1385): undefined reference to `SDL_PollEvent'\ndraw.o:draw.c:(.text+0x13ab): undefined reference to `SDL_SetVideoMode'\ndraw.o:draw.c:(.text+0x13e1): undefined reference to `SDL_GetError'\nserial.o:serial.c:(.text+0x11): undefined reference to `ftdi_init'\nserial.o:serial.c:(.text+0x1f): undefined reference to `ftdi_set_interface'\nserial.o:serial.c:(.text+0x32): undefined reference to `ftdi_usb_open'\nserial.o:serial.c:(.text+0x45): undefined reference to `ftdi_set_baudrate'\nserial.o:serial.c:(.text+0x94): undefined reference to `ftdi_get_error_string'\nserial.o:serial.c:(.text+0xc7): undefined reference to `ftdi_get_error_string'\nserial.o:serial.c:(.text+0x139): undefined reference to `ftdi_write_data'\nserial.o:serial.c:(.text+0x233): undefined reference to `ftdi_write_data'\ncollect2: error: ld returned 1 exit status\nmake: *** [makefile:6: main] Error 1\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 1, "creation_date": 1522792786, "post_id": 49639736, "comment_id": 86287130, "body": "Why are you using <code>void *</code>?"}, {"owner": {"reputation": 1461, "user_id": 5641188, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9bab5cda330ff2a8e1f909f3c2ac7700?s=128&d=identicon&r=PG&f=1", "display_name": "pavikirthi", "link": "https://stackoverflow.com/users/5641188/pavikirthi"}, "reply_to_user": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1522792892, "post_id": 49639736, "comment_id": 86287165, "body": "@Ed Heal, because it can be any type of value and currently I have the need to use this void* to assign strings"}, {"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 1, "creation_date": 1522792940, "post_id": 49639736, "comment_id": 86287184, "body": "Perhaps using <code>union</code> would be better"}, {"owner": {"reputation": 1461, "user_id": 5641188, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9bab5cda330ff2a8e1f909f3c2ac7700?s=128&d=identicon&r=PG&f=1", "display_name": "pavikirthi", "link": "https://stackoverflow.com/users/5641188/pavikirthi"}, "reply_to_user": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1522793152, "post_id": 49639736, "comment_id": 86287249, "body": "I did like this val-&gt;ptr = (void *)(strcat(&quot;hello&quot;,&quot;world&quot;));"}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1522793377, "post_id": 49639736, "comment_id": 86287327, "body": "<code>val-&gt;ptr</code> points to <code>NULL</code>, you cannot use <code>snprintf</code> on that. You would need to allocate memory for it first."}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1522793706, "post_id": 49639736, "comment_id": 86287433, "body": "You need to allocate memory for ptr, then cast it to char* to use sprintf."}, {"owner": {"reputation": 75299, "user_id": 139746, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/BhJLC.png?s=128&g=1", "display_name": "Pascal Cuoq", "link": "https://stackoverflow.com/users/139746/pascal-cuoq"}, "edited": false, "score": 0, "creation_date": 1522825794, "post_id": 49639736, "comment_id": 86297553, "body": "Your code is not even close to being syntactically correct."}], "answers": [{"comments": [{"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "reply_to_user": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1522795042, "post_id": 49639894, "comment_id": 86287843, "body": "@SteveSummit right you are, the man page says <i>including the terminating null byte</i>. Thanks for the feedback, I fixed the answer."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1522839875, "post_id": 49639894, "comment_id": 86306698, "body": "Thanks for fixing."}], "tags": [], "owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "is_accepted": true, "score": 2, "last_activity_date": 1522794996, "last_edit_date": 1522794996, "creation_date": 1522793611, "answer_id": 49639894, "question_id": 49639736, "link": "https://stackoverflow.com/questions/49639736/how-to-concatenate-strings-to-a-void-in-a-struct-using-snprintf-in-c/49639894#49639894", "title": "how to concatenate strings to a void* in a struct using snprintf in C", "body": "<p>By doing</p>\n\n<pre><code>buf val = {NULL, 100};\n</code></pre>\n\n<p><code>val.ptr</code> is pointing to <code>NULL</code>, of course <code>snprintf</code> will fail. You need to\nallocate memory for it:</p>\n\n<pre><code>int main(void)\n{\n    val.ptr = calloc(val.len, 1);\n    if(val.ptr == NULL)\n    {\n        fprintf(stderr, \"not enough memory\\n\");\n        return 1;\n    }\n\n    snprintf(val-&gt;ptr, val-&gt;len, \"%s%s\", \"hello\", \"world\");\n\n    free(val.ptr);\n\n    return 0;\n}\n</code></pre>\n\n<p>Note that </p>\n\n<pre><code>val-&gt;ptr = (void *)(strcat(\"hello\",\"world\"));\n</code></pre>\n\n<p>is very wrong. The first argument of <code>strcat</code> cannot be a pointer to a string\nliteral, because modifying string literals yields undefined behaviour and on most systems string literals are stored on read-only memory.\nYou'll need an array where you can modify the characters in the array:</p>\n\n<pre><code>char str[20] = \"hello\";\nstrcat(str, \"world\");\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 1, "last_activity_date": 1522795026, "creation_date": 1522795026, "answer_id": 49640079, "question_id": 49639736, "link": "https://stackoverflow.com/questions/49639736/how-to-concatenate-strings-to-a-void-in-a-struct-using-snprintf-in-c/49640079#49640079", "title": "how to concatenate strings to a void* in a struct using snprintf in C", "body": "<blockquote>\n  <p>how to concatenate strings to a void* in a struct using snprintf in C</p>\n</blockquote>\n\n<p>The below is like <code>snprintf(NULL, 100, \"%s%s\", \"hello\", \"world\");</code> which attempts to write data to <code>NULL</code> - undefined behavior.</p>\n\n<pre><code>buf val = {NULL, 100};\nsnprintf(val-&gt;ptr, val-&gt;len, \"%s%s\", \"hello\", \"world\");\n</code></pre>\n\n<p>Instead allocate data as mentioned by <a href=\"https://stackoverflow.com/a/49639894/2410359\">@Pablo</a></p>\n\n<hr>\n\n<p>To determine the memory needed, code can use the return value of <code>snprintf()</code> with first passing 0.</p>\n\n<blockquote>\n  <p>The <code>snprintf</code> function returns the number of characters that would have been written had <code>n</code> been sufficiently large, not counting the terminating null character, or a negative value if an encoding error occurred.   C11dr \u00a77.21.6.5 3</p>\n</blockquote>\n\n<pre><code>int len = snprintf(NULL, 0, \"%s%s\", \"hello\", \"world\");\n\nif (len &gt;= 0 &amp;&amp; (val-&gt;ptr = malloc(len + 1u)) != NULL) {\n  val-&gt;len = len + 1u;\n  snprintf(val-&gt;ptr, 0, \"%s%s\", \"hello\", \"world\");\n}\n....\n// Later free the memory.\nfree(val-&gt;ptr);\nval-&gt;ptr = NULL;\nval-&gt;len = 0;\n</code></pre>\n\n<hr>\n\n<p>BTW, recommend to use <code>size</code> in <code>struct __buf</code> is the <em>size</em> of the buffer is to be saved.</p>\n"}], "owner": {"reputation": 1461, "user_id": 5641188, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9bab5cda330ff2a8e1f909f3c2ac7700?s=128&d=identicon&r=PG&f=1", "display_name": "pavikirthi", "link": "https://stackoverflow.com/users/5641188/pavikirthi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 142, "favorite_count": 0, "accepted_answer_id": 49639894, "answer_count": 2, "score": 0, "last_activity_date": 1522795026, "creation_date": 1522792679, "question_id": 49639736, "link": "https://stackoverflow.com/questions/49639736/how-to-concatenate-strings-to-a-void-in-a-struct-using-snprintf-in-c", "title": "how to concatenate strings to a void* in a struct using snprintf in C", "body": "<p>I am trying to concatenate string to a void* using snprintf but I am getting segmentation fault for it.</p>\n\n<pre><code>  typedef struct __buf{\n      void* ptr;\n      size_t len;\n    }\n\n    buf val = {NULL, 100};\n\n    int main(){\n     snprintf(val-&gt;ptr, val-&gt;len, \"%s%s\", \"hello\", \"world\");\n     return 0;\n    }\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 3, "creation_date": 1522793884, "post_id": 49639732, "comment_id": 86287499, "body": "Functions must be declared before being used. You can solve the problem by moving the <code>main</code> function to the end of the code."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1522800964, "post_id": 49639732, "comment_id": 86289410, "body": "<i>Enable Compiler Warnings!</i> (and read them). For your code, you should be compiling with <code>gcc -Wall -Wextra -pedantic -Ofast -o test testowe.c</code> (you can add additional warnings as desired, e.g. <code>-Wshadow</code>, etc.)  Then do not accept code until it compiles cleanly without warning. (you can even be lazy and create a short shell script to handle the options for you, e.g. <code>gcc -Wall -Wextra -pedantic -Ofast -o &quot;$1&quot; &quot;$2&quot;</code> and then enter <code>.&#47;script test testowe.c</code> to compile.)"}], "answers": [{"tags": [], "owner": {"reputation": 27279, "user_id": 857132, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4fd51ed5980999c7c6ce3729d6cb2184?s=128&d=identicon&r=PG", "display_name": "John3136", "link": "https://stackoverflow.com/users/857132/john3136"}, "is_accepted": false, "score": 3, "last_activity_date": 1522795009, "creation_date": 1522795009, "answer_id": 49640075, "question_id": 49639732, "link": "https://stackoverflow.com/questions/49639732/conflicting-types-when-returning-array-of-strings/49640075#49640075", "title": "Conflicting types when returning array of strings", "body": "<p>Read the warnings: <code>implicit declaration of function \u2018getListOfFiles\u2019</code>.</p>\n\n<p>You are using getListOfFiles() not seen it before and so assumes that it returns an int. You can solve by either declaring the function before defining it.  <code>char** getListOfFiles(char *path)</code> near the top of your file or for this simple case just move the whole definition before <code>main()</code></p>\n"}], "owner": {"reputation": 7, "user_id": 7483161, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fb7Tb.jpg?s=128&g=1", "display_name": "gypsy0ne", "link": "https://stackoverflow.com/users/7483161/gypsy0ne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1522795009, "creation_date": 1522792666, "last_edit_date": 1522793922, "question_id": 49639732, "link": "https://stackoverflow.com/questions/49639732/conflicting-types-when-returning-array-of-strings", "title": "Conflicting types when returning array of strings", "body": "<p>I want to catch an array of filenames(strings)  from getListOfFiles() and use it in my main. I have tried my every idea and there is still appearing an error:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>gcc testowe.c -o test testowe.c: In function \u2018main\u2019:\ntestowe.c:8:15: warning: implicit declaration of function \u2018getListOfFiles\u2019 [-Wimplicit-function-declaration]\n char **list = getListOfFiles(argv[1]);\n\ntestowe.c:8:15: warning: initialization makes pointer from integer without a cast [-Wint-conversion]\n\ntestowe.c: At top level:\ntestowe.c:11:8: error: conflicting types for \u2018getListOfFiles\u2019\n char** getListOfFiles(char *path) {\n\ntestowe.c:8:15: note: previous implicit declaration of \u2018getListOfFiles\u2019 was here\n char **list = getListOfFiles(argv[1]);\n</code></pre>\n\n\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;dirent.h&gt;\n\nint main(int argc, char *argv[])\n{\nchar **list = getListOfFiles(argv[1]);\n}\n\nchar** getListOfFiles(char *path) {\n    int n=0, i=0;\n    DIR *d;\n    struct dirent *dir;\n    d = opendir(path);\n\n    while((dir = readdir(d)) != NULL) {\n        if ( !strcmp(dir-&gt;d_name, \".\") || !strcmp(dir-&gt;d_name, \"..\") )\n        {\n\n        } else {\n            n++;\n        }\n    }\n    rewinddir(d);\n\n    char **filesList;\n    filesList = malloc((n + 1)*sizeof(char*));\n\n    while((dir = readdir(d)) != NULL) {\n        if ( !strcmp(dir-&gt;d_name, \".\") || !strcmp(dir-&gt;d_name, \"..\") ){\n\n        }else {\n            filesList[i] = (char*) malloc (strlen(dir-&gt;d_name)+1);\n            strncpy (filesList[i],dir-&gt;d_name, strlen(dir-&gt;d_name) );\n            i++;\n        }\n    }\n    filesList[i] = NULL;\n    closedir(d);\n    return filesList;\n}\n</code></pre>\n\n<p>What's the real problem cause I think all types and pointers look fine?</p>\n"}, {"tags": ["c", "arrays", "realloc"], "comments": [{"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 2, "creation_date": 1522788366, "post_id": 49638832, "comment_id": 86285375, "body": "If you comment out code and it magically works, that&#39;s usually a sign of UB"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 2, "creation_date": 1522788442, "post_id": 49638832, "comment_id": 86285417, "body": "@yano If it is crashing it is definitely UB :) The OP is asking why... I guess <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> is needed"}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 2, "creation_date": 1522788451, "post_id": 49638832, "comment_id": 86285425, "body": "your <code>for</code> loop starts at <code>i=size</code>,, I suspect <code>vec[size]</code> is out of bounds... but there could be UB in code not shown also."}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "reply_to_user": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 1, "creation_date": 1522788550, "post_id": 49638832, "comment_id": 86285460, "body": "@yano <code>vec[size]</code> would be in bounds after the <code>realloc</code>. @Adonai how did you initialize <code>vec</code> when you pass to <code>insertVector</code>?"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 1, "creation_date": 1522788687, "post_id": 49638832, "comment_id": 86285511, "body": "if first init of <code>vec-&gt;vec</code> is a static array (not dynamically allocated) then the problem is explained."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "reply_to_user": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1522788987, "post_id": 49638832, "comment_id": 86285655, "body": "@Pablo ah yes, you are correct"}, {"owner": {"reputation": 129, "user_id": 8586164, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/2e0b3a992b034f9bf299b914feeb74f5?s=128&d=identicon&r=PG&f=1", "display_name": "Adonai", "link": "https://stackoverflow.com/users/8586164/adonai"}, "reply_to_user": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1522789454, "post_id": 49638832, "comment_id": 86285863, "body": "@Pablo I created a new vector setting to zero every field, then i used this function:  void initVector(const Vector vec,const size_t size)  {     vec-&gt;vec=calloc(size,sizeof(item));     vec-&gt;elements=size;     vec-&gt;size=size*2; }"}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1522789626, "post_id": 49638832, "comment_id": 86285927, "body": "@Adonai please put that code in your question"}, {"owner": {"reputation": 9367, "user_id": 4454124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c094d8979fb41b789a7c7f21d9329359?s=128&d=identicon&r=PG&f=1", "display_name": "mnistic", "link": "https://stackoverflow.com/users/4454124/mnistic"}, "edited": false, "score": 0, "creation_date": 1522789748, "post_id": 49638832, "comment_id": 86285983, "body": "So you are setting your <code>vec-&gt;size</code> to twice what you allocated in <code>initVector</code>"}, {"owner": {"reputation": 129, "user_id": 8586164, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/2e0b3a992b034f9bf299b914feeb74f5?s=128&d=identicon&r=PG&f=1", "display_name": "Adonai", "link": "https://stackoverflow.com/users/8586164/adonai"}, "reply_to_user": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1522789893, "post_id": 49638832, "comment_id": 86286050, "body": "@Pablo done, mnistic size is not the number of elements, it is the size of the memory buffer, i made the function so that when the number of element are equal to the buffer the buffer doubles."}, {"owner": {"reputation": 9367, "user_id": 4454124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c094d8979fb41b789a7c7f21d9329359?s=128&d=identicon&r=PG&f=1", "display_name": "mnistic", "link": "https://stackoverflow.com/users/4454124/mnistic"}, "edited": false, "score": 0, "creation_date": 1522790033, "post_id": 49638832, "comment_id": 86286114, "body": "Yes but you are setting to twice what it should be"}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1522790276, "post_id": 49638832, "comment_id": 86286225, "body": "yeah in <code>initVector</code> seems like to me that should be <code>vec-&gt;elements = 0;</code> and <code>vec-&gt;size = size;</code>. If you&#39;re only allocating <code>size</code> space for <code>vec-&gt;vec</code> and then access <code>size*2</code>, you&#39;re out of bounds."}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 1, "creation_date": 1522790278, "post_id": 49638832, "comment_id": 86286227, "body": "if you are on linux run your program under valgrind"}, {"owner": {"reputation": 129, "user_id": 8586164, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/2e0b3a992b034f9bf299b914feeb74f5?s=128&d=identicon&r=PG&f=1", "display_name": "Adonai", "link": "https://stackoverflow.com/users/8586164/adonai"}, "reply_to_user": {"reputation": 9367, "user_id": 4454124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c094d8979fb41b789a7c7f21d9329359?s=128&d=identicon&r=PG&f=1", "display_name": "mnistic", "link": "https://stackoverflow.com/users/4454124/mnistic"}, "edited": false, "score": 0, "creation_date": 1522790302, "post_id": 49638832, "comment_id": 86286238, "body": "@mnistic OMG you are right!!!!!! i just have to put size*2 inside calloc. Thanks!"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1522943311, "post_id": 49638832, "comment_id": 86364200, "body": "when calling any of the heap allocation functions: ( <code>malloc</code> <code>calloc</code> <code>realloc</code> ) always check (!=NULL) the returned value to assure the operation was successful"}], "answers": [{"comments": [{"owner": {"reputation": 129, "user_id": 8586164, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/2e0b3a992b034f9bf299b914feeb74f5?s=128&d=identicon&r=PG&f=1", "display_name": "Adonai", "link": "https://stackoverflow.com/users/8586164/adonai"}, "edited": false, "score": 0, "creation_date": 1522790434, "post_id": 49639269, "comment_id": 86286291, "body": "yes i managed to see that, i put size*2 inside calloc, and now it works."}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 1, "creation_date": 1522790574, "post_id": 49639269, "comment_id": 86286369, "body": "I still think that <code>vec-&gt;elements</code> should be initialized with 0, because you have only allocated space, not assign any <code>item</code>, so you have 0 elements."}, {"owner": {"reputation": 129, "user_id": 8586164, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/2e0b3a992b034f9bf299b914feeb74f5?s=128&d=identicon&r=PG&f=1", "display_name": "Adonai", "link": "https://stackoverflow.com/users/8586164/adonai"}, "edited": false, "score": 0, "creation_date": 1522791002, "post_id": 49639269, "comment_id": 86286528, "body": "it actually doesn&#39;t cause problems, because once the vector is initialised, i use elements as an upper bound for a for loop with which i fill the vector... but this is just for test purposes otherwise i should have put the element one by one."}], "tags": [], "owner": {"reputation": 9367, "user_id": 4454124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c094d8979fb41b789a7c7f21d9329359?s=128&d=identicon&r=PG&f=1", "display_name": "mnistic", "link": "https://stackoverflow.com/users/4454124/mnistic"}, "is_accepted": false, "score": 0, "last_activity_date": 1522790270, "creation_date": 1522790270, "answer_id": 49639269, "question_id": 49638832, "link": "https://stackoverflow.com/questions/49638832/problems-with-realloc-makes-program-crash/49639269#49639269", "title": "Problems with realloc, makes program crash", "body": "<p>In your <code>initVector</code> function, you set the size incorrectly, to two times what you allocated with <code>calloc</code>. This memory then gets overwritten as you are adding new elements and this is the reason the <code>free</code> fails when you finally invoke <code>realloc</code>. Change <code>initVector</code> to:</p>\n\n<pre><code>void initVector(const Vector vec,const size_t size) \n{\n    vec-&gt;vec=calloc(size,sizeof(item));\n    vec-&gt;elements=size;\n    vec-&gt;size=size;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 129, "user_id": 8586164, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/2e0b3a992b034f9bf299b914feeb74f5?s=128&d=identicon&r=PG&f=1", "display_name": "Adonai", "link": "https://stackoverflow.com/users/8586164/adonai"}, "edited": false, "score": 0, "creation_date": 1522791524, "post_id": 49639319, "comment_id": 86286707, "body": "now that i think about it, i don&#39;t get why it works anyway with const..."}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "reply_to_user": {"reputation": 129, "user_id": 8586164, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/2e0b3a992b034f9bf299b914feeb74f5?s=128&d=identicon&r=PG&f=1", "display_name": "Adonai", "link": "https://stackoverflow.com/users/8586164/adonai"}, "edited": false, "score": 0, "creation_date": 1522792267, "post_id": 49639319, "comment_id": 86286966, "body": "@Adonai  I realized now, that&#39;s because of the <code>typedef</code>, the <code>const</code> applies to the pointer. If you did <code>vec = malloc(sizeof *vec)</code> then you would get this error: <i>error: assignment of read-only parameter <code>vec</code></i>. If you would declare <code>insertVector</code> as <code>int insertVector(const struct  _vector *vec, ...)</code> then your would get an error telling you cannot change the contents."}], "tags": [], "owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "is_accepted": true, "score": 0, "last_activity_date": 1522790523, "creation_date": 1522790523, "answer_id": 49639319, "question_id": 49638832, "link": "https://stackoverflow.com/questions/49638832/problems-with-realloc-makes-program-crash/49639319#49639319", "title": "Problems with realloc, makes program crash", "body": "<p>Based of your comment</p>\n\n<blockquote>\n  <p>I created a new vector setting to zero every field, then i used this function: </p>\n\n<pre><code>void initVector(const Vector vec,const size_t size) \n{ \n    vec-&gt;vec=calloc(size,sizeof(item));\n    vec-&gt;elements=size;\n    vec-&gt;size=size*2; \n}\n</code></pre>\n</blockquote>\n\n<p>I think you are treating the size and the number of elements incorrectly. The\n<code>initVector</code> function just allocates memory for the <code>vec-&gt;vec</code> array, so\n<code>vec-&gt;elements</code> should be 0, not <code>size</code>. And <code>vec-&gt;size</code> should be <code>size</code>, not\n<code>size*2</code>. So the correct function should be</p>\n\n<pre><code>// remove the const, you are modifying the data vec is pointing to\nint initVector(Vector vec, size_t size)\n{\n    if(vec == NULL)\n        return 0;\n\n    vec-&gt;vec = calloc(size, sizeof *vec-&gt;vec);\n    if(vec-&gt;vec == NULL)\n        return 0;\n\n    vec-&gt;elements = 0;\n    vec-&gt;size = size;\n    return 1;\n}\n</code></pre>\n\n<p>Now the <code>insertVector</code> would only allocate new space, when all allocated spaces\nare used.</p>\n\n<p>And I suggest you use <code>memmove</code> to copy the memory:</p>\n\n<pre><code>// again, remove the const here\nint insertVector(Vector vec, const size_t pos, const item a)\n{\n    if(vec == NULL)\n        return 0;\n\n    if(vec-&gt;elements==vec-&gt;size)\n    {\n        item* temp=realloc(vec-&gt;vec,(vec-&gt;size*2)*sizeof *temp);\n        if(temp==NULL)\n        {\n            fprintf(stderr, \"Error: space unavailable\\n\");\n            return 0;\n        }\n\n        vec-&gt;vec=temp;\n        vec-&gt;size*=2;\n    }\n\n    // I use vec-&gt;elements as upper limit,\n    // otherwise you could have \"holes\" in the array and\n    // you wouldn't realize it.\n    if(pos &lt; 0 || pos &gt; vec-&gt;elements)\n    {\n        fprintf(stderr, \"invalid position\\n\");\n        return 0;\n    }\n\n    memmove(vec-&gt;vec + pos + 1, vec-&gt;vec + pos, (vec-&gt;elements - pos) * sizeof *vec-&gt;vec);\n\n    vec-&gt;vec[pos] = a;\n    vec-&gt;elements += 1;\n\n    printf(\"size is %lu\\nelements are %lu\\n\",vec-&gt;size,vec-&gt;elements);\n\n    return 1;\n}\n</code></pre>\n"}], "owner": {"reputation": 129, "user_id": 8586164, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/2e0b3a992b034f9bf299b914feeb74f5?s=128&d=identicon&r=PG&f=1", "display_name": "Adonai", "link": "https://stackoverflow.com/users/8586164/adonai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "accepted_answer_id": 49639319, "answer_count": 2, "score": 0, "last_activity_date": 1522790523, "creation_date": 1522788045, "last_edit_date": 1522789786, "question_id": 49638832, "link": "https://stackoverflow.com/questions/49638832/problems-with-realloc-makes-program-crash", "title": "Problems with realloc, makes program crash", "body": "<p>Hello i'implementing a smart vector in c, and i'm having problems with the reallocation of the buffer.</p>\n\n<p>this is the struct that contains the array and its infos:</p>\n\n<pre><code>struct _vector\n{\n    item* vec;\n    size_t elements;\n    size_t size;\n};\n</code></pre>\n\n<p>item is just a typedef that in this case happens to be int.\nI made several function to manage the array, but the one that should resize it, gives me problems.</p>\n\n<p>(Vector is also a typedef for struct _vector* by the way)</p>\n\n<p>This is the function:</p>\n\n<pre><code>void insertVector(const Vector vec,const int pos,const item a)\n{\n    if(vec-&gt;elements==vec-&gt;size)\n    {\n        item* temp=realloc(vec-&gt;vec,(vec-&gt;size*2)*sizeof(item));\n        if(temp==NULL)\n        {\n            puts(\"Error: space unavailable\");\n            return;\n        }\n        //vec-&gt;vec=realloc(vec-&gt;vec,(vec-&gt;size*2)*sizeof(item));\n        vec-&gt;vec=temp;\n        vec-&gt;size*=2;\n    }\n    int size=vec-&gt;elements;\n    if(pos&gt;=0&amp;&amp;pos&lt;=size)\n    {\n        for(int i=size;i&gt;pos;i--)\n        {\n            vec-&gt;vec[i]=vec-&gt;vec[i-1];\n        }\n        vec-&gt;vec[pos]=a;\n        vec-&gt;elements+=1;\n        printf(\"size is %lu\\nelements are %lu\\n\",vec-&gt;size,vec-&gt;elements);\n    }\n}\n</code></pre>\n\n<p>I just shift the contents to make space for the new element, and it works fine, the problem is when the array is reallocated.\nwhen the number of valid elements is equal to the actual size of the array,\ni do a realloc to double the actual size.\nAs soon as that if activates though the realloc makes the program crash with this error:incorrect checksum for freed object.</p>\n\n<p>The problem is in the if, because it only crashes when the size and elements are equal, if i comment out that section, everything works\nI don't know what could it be.</p>\n\n<p>EDIT:\nThe functions that i used to create and the initialise the instance i'm working with are:</p>\n\n<pre><code>Vector newVector(void)\n{\n    Vector new=malloc(sizeof(*new));\n    new-&gt;vec=NULL;\n    new-&gt;elements=0;\n    new-&gt;size=0;\n    return new;\n}\n</code></pre>\n\n<p>and</p>\n\n<pre><code>void initVector(const Vector vec,const size_t size) \n{\n    vec-&gt;vec=calloc(size,sizeof(item));\n    vec-&gt;elements=size;\n    vec-&gt;size=size*2;\n}\n</code></pre>\n"}, {"tags": ["c", "parallel-processing", "openacc"], "answers": [{"tags": [], "owner": {"reputation": 3901, "user_id": 3204484, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F7Cc9.jpg?s=128&g=1", "display_name": "Mat Colgrove", "link": "https://stackoverflow.com/users/3204484/mat-colgrove"}, "is_accepted": false, "score": 1, "last_activity_date": 1522791544, "creation_date": 1522791544, "answer_id": 49639522, "question_id": 49638621, "link": "https://stackoverflow.com/questions/49638621/parallelizing-nested-loops-with-openacc/49639522#49639522", "title": "Parallelizing nested loops with OpenACC", "body": "<p>An \"illegal address\" means that your program is accessing a bad address on the GPU.  Typically this is caused by an out-of-bounds access, accessing a host address on the device, using an aggregate data structure with dynamic data members and not \"attaching\" the members (i.e. setting the device pointers in the parent structure).  Less common cases are heap or stack overflows.</p>\n\n<p>How are you managing your data?  Data regions elsewhere in your code? </p>\n\n<p>If using PGI, try first targeting a multicore CPU (-ta=multicore) so you don't need to worry about data movement.  Once you have the parallel regions working, you can then go back to using the GPU and work on the data movement.  I'd recommend you start by using CUDA Unified Memory (-ta=tesla:managed) so the CUDA driver handles the data movement for you (dynamic data only).  Then once this is working, try adding data regions to manually manage the data.</p>\n\n<p>Other things I see:</p>\n\n<p>The parallel construct needs a loop directive on the outer loops.  </p>\n\n<pre><code>#pragma acc parallel loop\nfor(int j = 0; j &lt; a; j++){\n    for(int i = 0; i &lt; b; i++){\n</code></pre>\n\n<p>You may consider collapsing the loops depending on the loop trip count:</p>\n\n<pre><code>#pragma acc parallel loop collapse(2)\nfor(int j = 0; j &lt; a; j++){\n    for(int i = 0; i &lt; b; i++){\n</code></pre>\n\n<p>Also, the \"routine\" directive should decorate the routine's prototype or definition but shouldn't be used in a compute regions.</p>\n\n<p>If you are using any global variables in your device routines, be sure to put then into \"declare\" directives so a global copy of the data is created on the device.  </p>\n\n<p>If you are using PGI, add the \"-Minfo=accel\" option to the compiler.  This will give you the compiler feedback messages on how the compiler is parallelizing your code.  </p>\n\n<p>If you aren't using data directives, the compiler will need to implicitly copy the data.  The messages will tell you what arrays are being copied along with the size being copied.  </p>\n\n<p>If you have trouble understanding the feedback messages, post the output from your compilation and I'll help you walk through them.</p>\n"}], "owner": {"reputation": 91, "user_id": 5641144, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/140ba197c2cd1509058667af3f83c1a5?s=128&d=identicon&r=PG&f=1", "display_name": "ERohan", "link": "https://stackoverflow.com/users/5641144/erohan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 690, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1522791544, "creation_date": 1522787264, "question_id": 49638621, "link": "https://stackoverflow.com/questions/49638621/parallelizing-nested-loops-with-openacc", "title": "Parallelizing nested loops with OpenACC", "body": "<p>I've written a serial method that involves four nested for loops - I'd like to parallelize this method using OpenACC (this is the first time I've tried using it and I'm not very familiar with all the directives).</p>\n\n<p>I tried the following but see the following error: <code>call to cuStreamSynchronize returned error 700: Illegal address during kernel execution</code></p>\n\n<p>I've pasted a simplified pseudocode version of my method below, I'd really appreciate help figuring out the best way to parallelize this four nested loop structure.</p>\n\n<pre><code>// a, b, and c are input arguments to this method\n#pragma acc parallel\nfor(int j = 0; j &lt; a; j++){\n    for(int i = 0; i &lt; b; i++){\n\n        // computing mins and maxs based on formulas with i, j, a, b, and c\n        int minX = ...\n        int maxX = ...\n        int minY = ...\n        int maxY = ...\n\n        double count = (maxX - minX + 1)*(maxY - minY + 1);\n        int sum1 = 0;\n        int sum2 = 0;\n        int sum3 = 0;\n\n        #pragma acc loop\n        for (int y = minY; y &lt; maxY; y++) {\n          for (int x = minX; x &lt; maxX; x++) {\n            #pragma acc routine(function_call_name) seq\n            sum1 += // some function call;\n            sum2 += // some function call;\n            sum3 += // some function call;\n          }\n        }\n        int result1 = (int)(sum1/count);\n        int result2 = (int)(sum2/count);\n        int result3 = (int)(sum3/count);\n\n        #pragma acc routine(function_call_name) seq\n        // calling some function call to store result1, result2, result3 in the output\n    }\n}\n</code></pre>\n"}, {"tags": ["python", "c"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1522786757, "post_id": 49638408, "comment_id": 86284624, "body": "Python doesn&#39;t really have abstract classes. See the <code>abc</code> module for how they are faked."}, {"owner": {"reputation": 6206, "user_id": 663279, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/75e80ff9348edc07c6e1fed85986323e?s=128&d=identicon&r=PG", "display_name": "David Mulder", "link": "https://stackoverflow.com/users/663279/david-mulder"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1522786973, "post_id": 49638408, "comment_id": 86284730, "body": "@chepner I&#39;m aware of the abc module. I wonder, can decorators be applied to functions via the c-api?"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1522787032, "post_id": 49638408, "comment_id": 86284754, "body": "I assume so, since it&#39;s just function application."}], "owner": {"reputation": 6206, "user_id": 663279, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/75e80ff9348edc07c6e1fed85986323e?s=128&d=identicon&r=PG", "display_name": "David Mulder", "link": "https://stackoverflow.com/users/663279/david-mulder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 70, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1522786412, "creation_date": 1522786412, "question_id": 49638408, "link": "https://stackoverflow.com/questions/49638408/can-i-write-a-python-abstract-class-via-the-c-api", "title": "Can I write a Python Abstract class via the c api?", "body": "<p>I'm working with some c code, which I'd like to wrap into a python abstract class via the c api.</p>\n\n<p>The source I'm working with is here: <a href=\"https://github.com/samba-team/samba/tree/master/libgpo/gpext\" rel=\"nofollow noreferrer\">https://github.com/samba-team/samba/tree/master/libgpo/gpext</a> (part of the samba project)</p>\n\n<p>I have 2 structures, a gp_extension struct and a gp_extension_methods struct. The gp_extension struct contains a reference to a gp_extension_methods struct.</p>\n\n<pre><code>struct gp_extension {\n    struct GUID *guid;\n    const char *name;\n    struct gp_extension_methods *methods;\n    struct gp_extension *prev, *next;\n};\n\nstruct gp_extension_methods {\n\n    NTSTATUS (*initialize)(TALLOC_CTX *mem_ctx);\n\n    NTSTATUS (*process_group_policy)(TALLOC_CTX *mem_ctx,\n                     uint32_t flags,\n                     struct registry_key *root_key,\n                     const struct security_token *token,\n                     const struct GROUP_POLICY_OBJECT *deleted_gpo_list,\n                     const struct GROUP_POLICY_OBJECT *changed_gpo_list);\n\n    NTSTATUS (*get_reg_config)(TALLOC_CTX *mem_ctx,\n                   struct gp_extension_reg_info **info);\n\n    NTSTATUS (*shutdown)(void);\n};\n</code></pre>\n\n<p>I'd like to combine these via the c api and create a gp_extension abstract base class with the gp_extension_methods as abstract methods that the derivative classes would have to implement.</p>\n\n<p>My question is, does anyone know if this is possible via the python c api? If it is, does anyone know where I might find an example (I have searched and haven't found anything)?</p>\n"}, {"tags": ["c", "linux", "shell", "gcc"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 3, "creation_date": 1522786467, "post_id": 49638350, "comment_id": 86284464, "body": "First of all - you don&#39;t need to compile a header file."}, {"owner": {"reputation": 17992, "user_id": 278326, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/29b774f602a4e39d45f5c4f142566f2b?s=128&d=identicon&r=PG", "display_name": "Arun", "link": "https://stackoverflow.com/users/278326/arun"}, "edited": false, "score": 1, "creation_date": 1522786568, "post_id": 49638350, "comment_id": 86284518, "body": "Are you sure you are reporting the exact command line and the exact error? The <code>gcc</code> command you mentioned is expected to work."}, {"owner": {"reputation": 245, "user_id": 3879867, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9970f1c50e892b65550fd5e0b0226825?s=128&d=identicon&r=PG&f=1", "display_name": "RothX", "link": "https://stackoverflow.com/users/3879867/rothx"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1522786591, "post_id": 49638350, "comment_id": 86284527, "body": "@EugeneSh. Yup this fixes it. Feel a bit silly, but thanks for the help."}, {"owner": {"reputation": 19779, "user_id": 878532, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/5fbebb625a289267abd098c0e676c760?s=128&d=identicon&r=PG", "display_name": "Klaus", "link": "https://stackoverflow.com/users/878532/klaus"}, "edited": false, "score": 1, "creation_date": 1522786617, "post_id": 49638350, "comment_id": 86284539, "body": "BTW: you should not name your program &quot;test&quot;. If you try to invoke it, the name &quot;test&quot; colides with the shell command &quot;test&quot;. So you every have to type &quot;./test&quot; to get that problem away. :-)"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1522786620, "post_id": 49638350, "comment_id": 86284542, "body": "I actually didn&#39;t expect it to fix it :)"}, {"owner": {"reputation": 245, "user_id": 3879867, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9970f1c50e892b65550fd5e0b0226825?s=128&d=identicon&r=PG&f=1", "display_name": "RothX", "link": "https://stackoverflow.com/users/3879867/rothx"}, "reply_to_user": {"reputation": 17992, "user_id": 278326, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/29b774f602a4e39d45f5c4f142566f2b?s=128&d=identicon&r=PG", "display_name": "Arun", "link": "https://stackoverflow.com/users/278326/arun"}, "edited": false, "score": 0, "creation_date": 1522786687, "post_id": 49638350, "comment_id": 86284582, "body": "@Arun Yeah, I provided it exactly as run."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "reply_to_user": {"reputation": 19779, "user_id": 878532, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/5fbebb625a289267abd098c0e676c760?s=128&d=identicon&r=PG", "display_name": "Klaus", "link": "https://stackoverflow.com/users/878532/klaus"}, "edited": false, "score": 2, "creation_date": 1522786756, "post_id": 49638350, "comment_id": 86284623, "body": "@Klaus it has to be run that way regardless.  I doubt a test program such as this is going to be installed into the run-path anywhere."}, {"owner": {"reputation": 19779, "user_id": 878532, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/5fbebb625a289267abd098c0e676c760?s=128&d=identicon&r=PG", "display_name": "Klaus", "link": "https://stackoverflow.com/users/878532/klaus"}, "reply_to_user": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1522786821, "post_id": 49638350, "comment_id": 86284651, "body": "@ChristianGibbons: or you have . in PATH and the problem starts... ;)"}, {"owner": {"reputation": 17992, "user_id": 278326, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/29b774f602a4e39d45f5c4f142566f2b?s=128&d=identicon&r=PG", "display_name": "Arun", "link": "https://stackoverflow.com/users/278326/arun"}, "edited": false, "score": 0, "creation_date": 1522787003, "post_id": 49638350, "comment_id": 86284745, "body": "@RothX: The problem is due to a difference in behavior between <code>gcc</code> and <code>clang</code>. Adding an answer"}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "reply_to_user": {"reputation": 19779, "user_id": 878532, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/5fbebb625a289267abd098c0e676c760?s=128&d=identicon&r=PG", "display_name": "Klaus", "link": "https://stackoverflow.com/users/878532/klaus"}, "edited": false, "score": 1, "creation_date": 1522787029, "post_id": 49638350, "comment_id": 86284751, "body": "@Klaus is that a thing people do?  That would be more of a red flag to me than naming your test binary whatever."}, {"owner": {"reputation": 245, "user_id": 3879867, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9970f1c50e892b65550fd5e0b0226825?s=128&d=identicon&r=PG&f=1", "display_name": "RothX", "link": "https://stackoverflow.com/users/3879867/rothx"}, "reply_to_user": {"reputation": 19779, "user_id": 878532, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/5fbebb625a289267abd098c0e676c760?s=128&d=identicon&r=PG", "display_name": "Klaus", "link": "https://stackoverflow.com/users/878532/klaus"}, "edited": false, "score": 0, "creation_date": 1522787731, "post_id": 49638350, "comment_id": 86285095, "body": "@Klaus Don&#39;t worry, these are not my actual filenames. I just put placeholders for the purpose of this question."}], "answers": [{"comments": [{"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1522787179, "post_id": 49638572, "comment_id": 86284819, "body": "You should specify what the issue is in why it doesn&#39;t work (for clang) beyond the fact that clang and gcc handle it differently."}, {"owner": {"reputation": 245, "user_id": 3879867, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9970f1c50e892b65550fd5e0b0226825?s=128&d=identicon&r=PG&f=1", "display_name": "RothX", "link": "https://stackoverflow.com/users/3879867/rothx"}, "edited": false, "score": 0, "creation_date": 1522787686, "post_id": 49638572, "comment_id": 86285074, "body": "Hm, it&#39;s possible that my gcc is pointing to clang, and it would explain the error, but how would that have happened? I can&#39;t recall every intentionally doing something like that."}, {"owner": {"reputation": 17992, "user_id": 278326, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/29b774f602a4e39d45f5c4f142566f2b?s=128&d=identicon&r=PG", "display_name": "Arun", "link": "https://stackoverflow.com/users/278326/arun"}, "reply_to_user": {"reputation": 245, "user_id": 3879867, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9970f1c50e892b65550fd5e0b0226825?s=128&d=identicon&r=PG&f=1", "display_name": "RothX", "link": "https://stackoverflow.com/users/3879867/rothx"}, "edited": false, "score": 0, "creation_date": 1522788107, "post_id": 49638572, "comment_id": 86285261, "body": "@RothX: You can check by running <code>which gcc</code> and <code>gcc --version</code>."}], "tags": [], "owner": {"reputation": 17992, "user_id": 278326, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/29b774f602a4e39d45f5c4f142566f2b?s=128&d=identicon&r=PG", "display_name": "Arun", "link": "https://stackoverflow.com/users/278326/arun"}, "is_accepted": false, "score": 2, "last_activity_date": 1522787812, "last_edit_date": 1522787812, "creation_date": 1522787072, "answer_id": 49638572, "question_id": 49638350, "link": "https://stackoverflow.com/questions/49638350/using-gcc-with-multiple-files/49638572#49638572", "title": "Using gcc with multiple files", "body": "<p>The difference seems to be due to a difference of behavior between <code>gcc</code> and <code>clang</code> as shown in the following example.</p>\n\n<pre><code>~/test $ ls -ltr\ntotal 4\n-rw-rw-r-- 1 arusaha arusaha  0 Apr  3 13:19 b.h\n-rw-rw-r-- 1 arusaha arusaha  0 Apr  3 13:19 b.c\n-rw-rw-r-- 1 arusaha arusaha 14 Apr  3 13:20 a.c\n\n~/test $ clang -Wall -std=c99 b.c b.h a.c -o ab\nclang: error: cannot specify -o when generating multiple output files\n\n~/test $ gcc -Wall -std=c99 b.c b.h a.c -o ab\n~/test $ ls -ltr\ntotal 16\n-rw-rw-r-- 1 arusaha arusaha    0 Apr  3 13:19 b.h\n-rw-rw-r-- 1 arusaha arusaha    0 Apr  3 13:19 b.c\n-rw-rw-r-- 1 arusaha arusaha   14 Apr  3 13:20 a.c\n-rwxrwxr-x 1 arusaha arusaha 8576 Apr  3 13:21 ab\n~/test $ \n</code></pre>\n\n<p>Compiling multiple files is supported in <code>gcc</code>, see <a href=\"http://www.network-theory.co.uk/docs/gccintro/gccintro_11.html\" rel=\"nofollow noreferrer\">http://www.network-theory.co.uk/docs/gccintro/gccintro_11.html</a></p>\n\n<p>I was curious how <code>gcc</code> command can throw a <code>clang</code> error and that turned out to be a clue :). It is possible that OP's <code>gcc</code> is pointing to <code>clang</code> (and that can be confusing).</p>\n\n<p>From <code>gcc</code> manpage at <a href=\"http://man7.org/linux/man-pages/man1/gcc.1.html\" rel=\"nofollow noreferrer\">http://man7.org/linux/man-pages/man1/gcc.1.html</a></p>\n\n<blockquote>\n<pre><code>   -o file\n       Place output in file file.  This applies to whatever sort of\n       output is being produced, whether it be an executable file, an\n       object file, an assembler file or preprocessed C code.\n\n       If -o is not specified, the default is to put an executable file\n       in a.out, the object file for source.suffix in source.o, its\n       assembler file in source.s, a precompiled header file in\n       source.suffix.gch, and all preprocessed C source on standard\n       output.\n</code></pre>\n</blockquote>\n\n<p>From <code>clang</code> manpage at <a href=\"https://clang.llvm.org/docs/CommandGuide/clang.html\" rel=\"nofollow noreferrer\">https://clang.llvm.org/docs/CommandGuide/clang.html</a></p>\n\n<blockquote>\n<pre><code>-o &lt;file&gt; Write output to file.\n</code></pre>\n</blockquote>\n\n<p>To me, the difference of behavior is not exactly clear by just reading the <code>man</code> page but I could be wrong.</p>\n"}, {"tags": [], "owner": {"reputation": 3560, "user_id": 5550963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7jAip.png?s=128&g=1", "display_name": "CEPB", "link": "https://stackoverflow.com/users/5550963/cepb"}, "is_accepted": true, "score": 1, "last_activity_date": 1522789414, "last_edit_date": 1522789414, "creation_date": 1522789011, "answer_id": 49639032, "question_id": 49638350, "link": "https://stackoverflow.com/questions/49638350/using-gcc-with-multiple-files/49639032#49639032", "title": "Using gcc with multiple files", "body": "<p>Here are your errors</p>\n\n<ol>\n<li><p>you are not suppose to compile <code>.h</code> files in c so try this:</p>\n\n<p><code>gcc -Wall -std=c99 stuff.c test.c -o test</code></p></li>\n<li><p><code>gcc</code> depends also on environment that you run it on. On my system if I do <code>gcc -Wall -std=c99 stuff.c stuff.h test.c -o test</code> it will work, because compiler is set that way. On some machines it might be different. So if for some strange reason #1 does not work you have to do following:</p>\n\n<p><code>gcc -Wall -std=c99 -c stuff.c test.c</code></p>\n\n<p><code>gcc -Wall -std=c99 stuff.o test.o -o test</code></p>\n\n<p><code>./test</code></p></li>\n<li><p>But your error <code>clang: error: cannot specify -o when generating multiple output files</code> is due to some code error, perhaps header file problems. So <strong>post your code</strong></p></li>\n</ol>\n"}], "owner": {"reputation": 245, "user_id": 3879867, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9970f1c50e892b65550fd5e0b0226825?s=128&d=identicon&r=PG&f=1", "display_name": "RothX", "link": "https://stackoverflow.com/users/3879867/rothx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 216, "favorite_count": 0, "accepted_answer_id": 49639032, "answer_count": 2, "score": 1, "last_activity_date": 1522798610, "creation_date": 1522786159, "last_edit_date": 1522798610, "question_id": 49638350, "link": "https://stackoverflow.com/questions/49638350/using-gcc-with-multiple-files", "title": "Using gcc with multiple files", "body": "<p>I am trying to generate an executable file test from a c file <code>test.c</code>. </p>\n\n<p><code>test.c</code> includes the <code>main()</code> function, but I also want to include functions from <code>stuff.c</code>. I was told to declare functions in <code>stuff.h</code> and then run the command <code>gcc -Wall -std=c99 stuff.c stuff.h test.c -o test</code>.</p>\n\n<p>I know what each component of this does, but this is the first time I've tried to use gcc with multiple input files. When I try to run this command, it fails, and I get the error <code>clang: error: cannot specify -o when generating multiple output files</code>.</p>\n\n<p>As far as I'm aware, I'm only trying to generate one output file, so I assume this command is set up incorrectly. How can I fix it?</p>\n"}, {"tags": ["c", "pointers", "increment"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1522786204, "post_id": 49638313, "comment_id": 86284355, "body": "Because <code>*(p + x)</code> is defined to be the same as <code>p[x]</code>. And you have no reason to <i>expect</i> what you expect."}, {"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1522786287, "post_id": 49638313, "comment_id": 86284388, "body": "This someone expects it to go to the next int. I guess the people that developed the language thought the same way"}, {"owner": {"reputation": 85822, "user_id": 597607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jCzJi.png?s=128&g=1", "display_name": "Bo Persson", "link": "https://stackoverflow.com/users/597607/bo-persson"}, "edited": false, "score": 0, "creation_date": 1522786931, "post_id": 49638313, "comment_id": 86284710, "body": "You&#39;d then probably be surprised to learn that <code>ptr += 1;</code> <i>also</i> makes it point to the next element. It is &quot;add one position&quot;, not &quot;add one byte&quot;."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1522787622, "post_id": 49638313, "comment_id": 86285036, "body": "Note that code did not demonstrate &quot;the pointer was incremented by the size of an int&quot; as it shows the result of what the pointer referenced and not the value of the pointer. On novel systems, <code>int*</code> lives in a different place that <code>char *</code> and truly does increment by 1, yet behaves just like OP&#39;s code.  C supports many architectures."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 1, "creation_date": 1522795166, "post_id": 49638313, "comment_id": 86287889, "body": "Because &quot;what you expect&quot; for HLL code is not necessarily what you&#39;d expect if you were programming in assembler.  <i>If</i> you were programming in assembler, you wouldn&#39;t be thinking of pointers, you&#39;d be thinking of addresses, and you&#39;d expect adding 1 to add 1.  But in a high-level language like C (and even though C is relatively low-level, as HLL&#39;s go), if you have a pointer to some ints, and you add 1 to it, you expect the pointer to be incremented to point to the next int.  If you wanted to step through the bytes of the int, you would say <code>unsigned char *cp = (unsigned char *)a</code>."}], "owner": {"reputation": 129, "user_id": 6311705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16d118e3b68d08d54b961465f22b8e18?s=128&d=identicon&r=PG&f=1", "display_name": "Luca S.", "link": "https://stackoverflow.com/users/6311705/luca-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "closed_date": 1522786328, "answer_count": 0, "score": 3, "last_activity_date": 1522786028, "creation_date": 1522786028, "question_id": 49638313, "link": "https://stackoverflow.com/questions/49638313/in-c-why-does-incrementing-a-pointer-adds-the-size-of-the-type-the-pointer-is-r", "closed_reason": "Duplicate", "title": "In C, why does incrementing a pointer adds the size of the type the pointer is referring to instead of 1?", "body": "<p>in C(and possibly C++) if you increment a pointer like this:</p>\n\n<pre><code>int a[2];\na[0] = 1;\na[1] = 2;\nint* ptr = (int*) a;\nprintf(\"%d\\n\", *ptr);\nptr++;\nprintf(\"%d\\n\", *ptr);\n</code></pre>\n\n<p>You will see that the pointer was incremented by the size of an int(Indicated by the output:</p>\n\n<pre><code>1\n2\n</code></pre>\n\n<p>). I would expect it to increase the pointer by one and therefore be in the middle of the two ints printing different values.</p>\n\n<p>My question is: Why does it do this instead of increasing the pointer by 1 as someone would expect?</p>\n"}, {"tags": ["c", "user-interface", "segmentation-fault", "gtk3"], "comments": [{"owner": {"reputation": 1804, "user_id": 754147, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OQkUn.jpg?s=128&g=1", "display_name": "prmottajr", "link": "https://stackoverflow.com/users/754147/prmottajr"}, "edited": false, "score": 0, "creation_date": 1522786220, "post_id": 49638307, "comment_id": 86284362, "body": "Isn&#39;t *widget the object that was truly clicked by the user?"}, {"owner": {"reputation": 3108, "user_id": 5288867, "user_type": "registered", "accept_rate": 77, "profile_image": "https://lh3.googleusercontent.com/-zd2wZZ4VrjY/AAAAAAAAAAI/AAAAAAAADiM/koENXn3dc8s/photo.jpg?sz=128", "display_name": "dangee1705", "link": "https://stackoverflow.com/users/5288867/dangee1705"}, "reply_to_user": {"reputation": 1804, "user_id": 754147, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OQkUn.jpg?s=128&g=1", "display_name": "prmottajr", "link": "https://stackoverflow.com/users/754147/prmottajr"}, "edited": false, "score": 0, "creation_date": 1522786286, "post_id": 49638307, "comment_id": 86284387, "body": "@prmottajr yeah widget is the radio button, and then im trying to set an entrys sensitivity based on that radio button changing"}, {"owner": {"reputation": 1804, "user_id": 754147, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OQkUn.jpg?s=128&g=1", "display_name": "prmottajr", "link": "https://stackoverflow.com/users/754147/prmottajr"}, "edited": false, "score": 0, "creation_date": 1522787181, "post_id": 49638307, "comment_id": 86284820, "body": "Maybe it is not null but in an invalid state, is it possible to print the current value of the entry for example before setting its sensitivity?"}, {"owner": {"reputation": 3108, "user_id": 5288867, "user_type": "registered", "accept_rate": 77, "profile_image": "https://lh3.googleusercontent.com/-zd2wZZ4VrjY/AAAAAAAAAAI/AAAAAAAADiM/koENXn3dc8s/photo.jpg?sz=128", "display_name": "dangee1705", "link": "https://stackoverflow.com/users/5288867/dangee1705"}, "reply_to_user": {"reputation": 1804, "user_id": 754147, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OQkUn.jpg?s=128&g=1", "display_name": "prmottajr", "link": "https://stackoverflow.com/users/754147/prmottajr"}, "edited": false, "score": 0, "creation_date": 1522787357, "post_id": 49638307, "comment_id": 86284927, "body": "@prmottajr entry is 0x93a200 in main and 0xd8458b48d8558948 in use_key. now im even more confused"}, {"owner": {"reputation": 1804, "user_id": 754147, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OQkUn.jpg?s=128&g=1", "display_name": "prmottajr", "link": "https://stackoverflow.com/users/754147/prmottajr"}, "edited": false, "score": 0, "creation_date": 1522789106, "post_id": 49638307, "comment_id": 86285698, "body": "Just for investigation purposes, if you set gui_ctx ctx; to be static and global, and use it inside the use_key, does it work? (it should)"}, {"owner": {"reputation": 3108, "user_id": 5288867, "user_type": "registered", "accept_rate": 77, "profile_image": "https://lh3.googleusercontent.com/-zd2wZZ4VrjY/AAAAAAAAAAI/AAAAAAAADiM/koENXn3dc8s/photo.jpg?sz=128", "display_name": "dangee1705", "link": "https://stackoverflow.com/users/5288867/dangee1705"}, "reply_to_user": {"reputation": 1804, "user_id": 754147, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OQkUn.jpg?s=128&g=1", "display_name": "prmottajr", "link": "https://stackoverflow.com/users/754147/prmottajr"}, "edited": false, "score": 0, "creation_date": 1522789603, "post_id": 49638307, "comment_id": 86285920, "body": "@prmottajr yeah that works"}, {"owner": {"reputation": 1804, "user_id": 754147, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OQkUn.jpg?s=128&g=1", "display_name": "prmottajr", "link": "https://stackoverflow.com/users/754147/prmottajr"}, "edited": false, "score": 1, "creation_date": 1522790805, "post_id": 49638307, "comment_id": 86286458, "body": "What is the value of the address of *event? The documentation that I found only had 2 parameters."}, {"owner": {"reputation": 3108, "user_id": 5288867, "user_type": "registered", "accept_rate": 77, "profile_image": "https://lh3.googleusercontent.com/-zd2wZZ4VrjY/AAAAAAAAAAI/AAAAAAAADiM/koENXn3dc8s/photo.jpg?sz=128", "display_name": "dangee1705", "link": "https://stackoverflow.com/users/5288867/dangee1705"}, "reply_to_user": {"reputation": 1804, "user_id": 754147, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OQkUn.jpg?s=128&g=1", "display_name": "prmottajr", "link": "https://stackoverflow.com/users/754147/prmottajr"}, "edited": false, "score": 0, "creation_date": 1522843020, "post_id": 49638307, "comment_id": 86308791, "body": "@prmottajr this actually fixed my error. The callback function was supposed to only have two params and i was trying to read a third, hence the random address. thanks"}], "owner": {"reputation": 3108, "user_id": 5288867, "user_type": "registered", "accept_rate": 77, "profile_image": "https://lh3.googleusercontent.com/-zd2wZZ4VrjY/AAAAAAAAAAI/AAAAAAAADiM/koENXn3dc8s/photo.jpg?sz=128", "display_name": "dangee1705", "link": "https://stackoverflow.com/users/5288867/dangee1705"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 258, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1522786011, "creation_date": 1522786011, "question_id": 49638307, "link": "https://stackoverflow.com/questions/49638307/gtk-widget-set-sensitive-crashes-program", "title": "gtk_widget_set_sensitive crashes program", "body": "<p>I have a program written in C using the GTK library. In the GUI I have a set of radio buttons, and depending on what button is selected changes if an entry can be edited (or sensitive as gtk calls it).</p>\n\n<p>I have made a struct with all the widgets that I need to pass to my signal handlers. It looks like this (with other widgets removed for simplicity).</p>\n\n<pre><code>typedef struct _gui_ctx {\n    // more widgets in here\n    GtkWidget *entry;\n} gui_ctx;\n</code></pre>\n\n<p>And in <code>main</code> I define one like so</p>\n\n<pre><code>gui_ctx ctx;\n</code></pre>\n\n<p>My entry looks like</p>\n\n<pre><code>GtkWidget *entry = gtk_entry_new();\nctx.entry = entry; //add it to the ctx\n</code></pre>\n\n<p>My radio buttons look like</p>\n\n<pre><code>GtkWidget *radio_key = gtk_radio_button_new_with_label(NULL, \"Key\");\nGtkWidget *radio_password = gtk_radio_button_new_with_label_from_widget(GTK_RADIO_BUTTON(radio_key), \"Password\");\nGtkWidget *radio_random = gtk_radio_button_new_with_label_from_widget(GTK_RADIO_BUTTON(radio_key), \"Random\");\n</code></pre>\n\n<p>I attach the signal handlers as such</p>\n\n<pre><code>g_signal_connect(radio_key, \"toggled\", G_CALLBACK(use_key), &amp;ctx);\ng_signal_connect(radio_password, \"toggled\", G_CALLBACK(use_password), &amp;ctx);\ng_signal_connect(radio_random, \"toggled\", G_CALLBACK(use_random), &amp;ctx);\n</code></pre>\n\n<p>The signal handlers are all basically the same. They are all the same type like so</p>\n\n<pre><code>void use_key(GtkWidget *widget, GdkEvent *event, gpointer data){\n    gui_ctx *ctx = (gui_ctx *) data;\n    GtkWidget *entry = ctx-&gt;entry;\n    gtk_widget_set_sensitive(entry, TRUE); // crashes here\n}\n</code></pre>\n\n<p>The program crashes on the last line of the handler function. It says</p>\n\n<pre><code>Segmentation fault (core dumped)\n</code></pre>\n\n<p>I have tried to find why the issue is happening but it always crashes on that line. Both <code>data</code> and <code>entry</code> are not null so I don't know what's going wrong. </p>\n"}, {"tags": ["c++", "c", "c-strings"], "comments": [{"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1522786115, "post_id": 49638296, "comment_id": 86284305, "body": "Did you try stepping through your code with a debugger?"}, {"owner": {"reputation": 45, "user_id": 8833430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a82c62d34fec83d729462a9a053b8ab2?s=128&d=identicon&r=PG", "display_name": "new User", "link": "https://stackoverflow.com/users/8833430/new-user"}, "reply_to_user": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1522786184, "post_id": 49638296, "comment_id": 86284339, "body": "yes and suddenly at the critical line it gets &quot;truncated&quot; into desirable output when it exits from last for loop"}, {"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 2, "creation_date": 1522786283, "post_id": 49638296, "comment_id": 86284385, "body": "If does anything suddenly, you are not <b>stepping through</b> your code. Step through it line-by-line., while observing values of all local variables."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 2, "creation_date": 1522786608, "post_id": 49638296, "comment_id": 86284535, "body": "You\u2019re copying the terminating zero."}, {"owner": {"reputation": 1190, "user_id": 3207828, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1EPkw.jpg?s=128&g=1", "display_name": "Dan Korn", "link": "https://stackoverflow.com/users/3207828/dan-korn"}, "edited": false, "score": 0, "creation_date": 1522786672, "post_id": 49638296, "comment_id": 86284573, "body": "How is this a C++ question?  You&#39;re not using any C++ objects, other than cout in main().  The only thing about the trim function that&#39;s not pure C is that you declare the for loop counter variables in the for statements."}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "reply_to_user": {"reputation": 1190, "user_id": 3207828, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1EPkw.jpg?s=128&g=1", "display_name": "Dan Korn", "link": "https://stackoverflow.com/users/3207828/dan-korn"}, "edited": false, "score": 1, "creation_date": 1522787088, "post_id": 49638296, "comment_id": 86284783, "body": "@DanKorn and using  cout"}, {"owner": {"reputation": 45, "user_id": 8833430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a82c62d34fec83d729462a9a053b8ab2?s=128&d=identicon&r=PG", "display_name": "new User", "link": "https://stackoverflow.com/users/8833430/new-user"}, "reply_to_user": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1522787289, "post_id": 49638296, "comment_id": 86284890, "body": "Thanks @molbdnilo ! I know now why it works partly. I dont know how it works under the hood but ill figure something out with google probly."}, {"owner": {"reputation": 45, "user_id": 8833430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a82c62d34fec83d729462a9a053b8ab2?s=128&d=identicon&r=PG", "display_name": "new User", "link": "https://stackoverflow.com/users/8833430/new-user"}, "reply_to_user": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1522787614, "post_id": 49638296, "comment_id": 86285033, "body": "@AlgirdasPreid\u017eius Im stepping through line by line and it really gets suddenly truncated as soon as it exits out of the for loop."}, {"owner": {"reputation": 811, "user_id": 9493582, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bfI3b.jpg?s=128&g=1", "display_name": "Arndt Jonasson", "link": "https://stackoverflow.com/users/9493582/arndt-jonasson"}, "edited": false, "score": 0, "creation_date": 1522788182, "post_id": 49638296, "comment_id": 86285293, "body": "It&#39;s certainly C++ and not C. If you make a minimal example out of it that uses nothing that C doesn&#39;t have, it&#39;s still C++. And maybe C also. The declaration of the loop variable is actually C, though, C99."}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 8833430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a82c62d34fec83d729462a9a053b8ab2?s=128&d=identicon&r=PG", "display_name": "new User", "link": "https://stackoverflow.com/users/8833430/new-user"}, "edited": false, "score": 0, "creation_date": 1522788764, "post_id": 49638972, "comment_id": 86285544, "body": "Is there any way to iterate over leftovers to see it with my own eyes?"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 45, "user_id": 8833430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a82c62d34fec83d729462a9a053b8ab2?s=128&d=identicon&r=PG", "display_name": "new User", "link": "https://stackoverflow.com/users/8833430/new-user"}, "edited": false, "score": 0, "creation_date": 1522789001, "post_id": 49638972, "comment_id": 86285662, "body": "@newUser As you step through the code, you&#39;ll see on the last iteration of the second loop that <code>*(str + firstChar + i)</code> contains the value 0.  Once that gets copied over, the string is terminated and the point where the 0 is.  Any bytes in the array after that don&#39;t matter."}, {"owner": {"reputation": 46, "user_id": 9592669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8503f7bf4321cce1115204a80f85925a?s=128&d=identicon&r=PG&f=1", "display_name": "user95asf", "link": "https://stackoverflow.com/users/9592669/user95asf"}, "reply_to_user": {"reputation": 45, "user_id": 8833430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a82c62d34fec83d729462a9a053b8ab2?s=128&d=identicon&r=PG", "display_name": "new User", "link": "https://stackoverflow.com/users/8833430/new-user"}, "edited": false, "score": 1, "creation_date": 1522789419, "post_id": 49638972, "comment_id": 86285845, "body": "@newUser well if you want to print those leftovers for dubugging reasons you can either replace &lt;= with &lt; inside the for loop to get the whole string. Or just cout &lt;&lt; str+lenStr+1 to print only the leftovers."}, {"owner": {"reputation": 45, "user_id": 8833430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a82c62d34fec83d729462a9a053b8ab2?s=128&d=identicon&r=PG", "display_name": "new User", "link": "https://stackoverflow.com/users/8833430/new-user"}, "reply_to_user": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1522789426, "post_id": 49638972, "comment_id": 86285849, "body": "@dbush apparently so because i tried to get them like this after the second loop: <code>int leftovers = 5; \t\tfor (int i = 1; i &lt; leftovers; i++) { \t\t\tcout &lt;&lt; *(str + lenStr + i); \t\t}</code>                                                                                                        I thought going over the &#39;\\0&#39; would give me those but they are already lost apparently"}, {"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "reply_to_user": {"reputation": 45, "user_id": 8833430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a82c62d34fec83d729462a9a053b8ab2?s=128&d=identicon&r=PG", "display_name": "new User", "link": "https://stackoverflow.com/users/8833430/new-user"}, "edited": false, "score": 1, "creation_date": 1522793278, "post_id": 49638972, "comment_id": 86287288, "body": "@newUser One doesn&#39;t need to &quot;iterate over leftovers&quot;, to see that they are, actually, there. One can open memory window (or equivalent) in a debugger, navigate to the location of the array, and look at what is, actually, stored in memory."}], "tags": [], "owner": {"reputation": 46, "user_id": 9592669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8503f7bf4321cce1115204a80f85925a?s=128&d=identicon&r=PG&f=1", "display_name": "user95asf", "link": "https://stackoverflow.com/users/9592669/user95asf"}, "is_accepted": true, "score": 3, "last_activity_date": 1522788704, "creation_date": 1522788704, "answer_id": 49638972, "question_id": 49638296, "link": "https://stackoverflow.com/questions/49638296/trimming-start-of-cstring-without-copying/49638972#49638972", "title": "Trimming start of Cstring without copying", "body": "<p>The reason why it works is because as you trim the string by shifting each character you also shift the terminating null character <code>'\\0'</code>. As you probably know c-strings are array of characters terminated by <code>'\\0'</code>, so as you print <code>str</code> with <code>cout</code> all characters are printed until the null value is reached: that is way the leftovers are not printed.</p>\n"}], "owner": {"reputation": 45, "user_id": 8833430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a82c62d34fec83d729462a9a053b8ab2?s=128&d=identicon&r=PG", "display_name": "new User", "link": "https://stackoverflow.com/users/8833430/new-user"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "accepted_answer_id": 49638972, "answer_count": 1, "score": 1, "last_activity_date": 1522788704, "creation_date": 1522785941, "last_edit_date": 1522788215, "question_id": 49638296, "link": "https://stackoverflow.com/questions/49638296/trimming-start-of-cstring-without-copying", "title": "Trimming start of Cstring without copying", "body": "<p>I managed to get my homework to work but It shouldn't work because i have not finished it. I don't know why it does. I need help.</p>\n\n<pre><code>#include&lt;iostream&gt;\nusing namespace std;\n\nchar* trim(char* str) {\n    const int lenStr = strlen(str);\n    int characters = 0;\n    bool trimmableFront = false;\n    int firstChar;\n\n    //check if trimmableFront + location of first char\n    for (int i = 0; i &lt; lenStr; i++) {\n        if (*(str + i) != ' ') {\n            if (characters == 0)\n                firstChar = i;\n            characters++;\n        }\n        if (characters == 0) {\n            trimmableFront = true;\n        }\n    }\n\n    //trim Front //THIS PART SHOULD BEHAVE DIFFERENTLY\n    if (trimmableFront) {\n        for (int i = 0; i &lt; lenStr; i++) {\n            if((firstChar + i &lt;= lenStr))\n                *(str + i) = *(str + firstChar + i); \n        }\n    }\n    return str;\n}\n\n\nint main() {\n\n    char str[] = \"       why does it work?\";\n    trim(str);\n    cout&lt;&lt; str &lt;&lt;endl;\n    return 0;\n}\n</code></pre>\n\n<p>At the end of trim(*char) function, trimmed string should have still leftovers from previous locations. \nFor some reason it is perfectly trimmed and works as intended printing \"why does it work?\" but it should print something like \"why does it workt work?\"</p>\n"}, {"tags": ["c", "function", "multidimensional-array"], "comments": [{"owner": {"reputation": 811, "user_id": 9493582, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bfI3b.jpg?s=128&g=1", "display_name": "Arndt Jonasson", "link": "https://stackoverflow.com/users/9493582/arndt-jonasson"}, "edited": false, "score": 0, "creation_date": 1522787594, "post_id": 49638260, "comment_id": 86285025, "body": "Do you really mean <code>array[i][-1]</code>? If so, why?"}, {"owner": {"reputation": 1, "user_id": 9590878, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-P5IZMzCCP6Y/AAAAAAAAAAI/AAAAAAAADkg/F1IXaOmDFHA/photo.jpg?sz=128", "display_name": "Chris G", "link": "https://stackoverflow.com/users/9590878/chris-g"}, "reply_to_user": {"reputation": 811, "user_id": 9493582, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bfI3b.jpg?s=128&g=1", "display_name": "Arndt Jonasson", "link": "https://stackoverflow.com/users/9493582/arndt-jonasson"}, "edited": false, "score": 0, "creation_date": 1522787731, "post_id": 49638260, "comment_id": 86285096, "body": "@ArndtJonasson Well i got this from an earlier work piece which i believed the code could be used in this too, what would be the correct or more useful way?"}, {"owner": {"reputation": 811, "user_id": 9493582, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bfI3b.jpg?s=128&g=1", "display_name": "Arndt Jonasson", "link": "https://stackoverflow.com/users/9493582/arndt-jonasson"}, "edited": false, "score": 0, "creation_date": 1522788514, "post_id": 49638260, "comment_id": 86285446, "body": "If it&#39;s not your code, I suggest you write your own, only perhaps getting some ideas from this one."}, {"owner": {"reputation": 1, "user_id": 9590878, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-P5IZMzCCP6Y/AAAAAAAAAAI/AAAAAAAADkg/F1IXaOmDFHA/photo.jpg?sz=128", "display_name": "Chris G", "link": "https://stackoverflow.com/users/9590878/chris-g"}, "reply_to_user": {"reputation": 811, "user_id": 9493582, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bfI3b.jpg?s=128&g=1", "display_name": "Arndt Jonasson", "link": "https://stackoverflow.com/users/9493582/arndt-jonasson"}, "edited": false, "score": 0, "creation_date": 1522789835, "post_id": 49638260, "comment_id": 86286020, "body": "@ArndtJonasson Well i am using it the code from an unrelated project. But i will take a crack at sorting it out"}], "owner": {"reputation": 1, "user_id": 9590878, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-P5IZMzCCP6Y/AAAAAAAAAAI/AAAAAAAADkg/F1IXaOmDFHA/photo.jpg?sz=128", "display_name": "Chris G", "link": "https://stackoverflow.com/users/9590878/chris-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1522786600, "creation_date": 1522785769, "last_edit_date": 1522786600, "question_id": 49638260, "link": "https://stackoverflow.com/questions/49638260/sorting-a-2d-array-into-ascending-order", "title": "Sorting a 2D-Array into Ascending order", "body": "<ul>\n<li>I am trying to print out the contents of an Array into Ascending order, i am also using Functions (part of a task i have been assigned) - i am fairly new to C/C++ hence if anything is a mess.</li>\n<li>The Sorting algorithm i have used just outputs all the numbers into a random order, any way to resolve or correct this? - Ideally this needs to output into the 2x2 grid as the Array Displays.</li>\n</ul>\n\n<p><a href=\"https://i.stack.imgur.com/WgDbX.jpg\" rel=\"nofollow noreferrer\">Ascending Order Output</a></p>\n\n<pre><code>include &lt;stdio.h&gt;/*Seperate Function for Input ArrayInt */\nint main(){\nint arrayHeight, array[100][2], xCoord, yCoord, i;\nprintf (\"***** Bubble Sort ***** \\n\");  \nprintf(\"\\n How many items of data do you wish to enter? \");\nscanf(\"%d\",&amp;arrayHeight);\nfor(i=0; i&lt;arrayHeight; i++){\n    printf(\"Please enter in the X coordinate: \");\n    scanf(\"%d\", &amp;xCoord);\n    printf(\"Please enter in the Y coordinate: \");\n    scanf(\"%d\", &amp;yCoord);\n    array[i][0] = xCoord;\n    array[i][1] = yCoord;\n}\nDisplayArray(array, arrayHeight);\nBubbleSort(array, arrayHeight);\n}\nint DisplayArray(int array[100][2],int arrayHeight, int swap) {\n/*Displaying Array elements*/\nint i, j;\nprintf(\"\\n The 2-D Array contains : \\n\");\nfor(i=0; i&lt;arrayHeight; i++)\n{\n    printf(\"[%d][%d]\\n\\r\", array[i][1], array[i][0]);\n}\n}  \n int BubbleSort(int array[100][2], int arrayHeight)\n{   \n/*Sorts the Array elements into appropriate chosen sorting order - Ascending*/\nint swap, i, j, k;\nfor(k =0; k&lt; arrayHeight; k++) {\n            for (i = 0; i &lt;arrayHeight; i++) {\n            for (j = i+1; j &lt; 3; ++j) {\n            if (array[i][0] &gt; array[i][-1])  {\n                array[i][1] = swap;\n                swap = array[i][0]; /*Array = Array Name*/\n             }\n         }  \n     }\n }    \nprintf(\"\\n Printing in Asending Order: \");\n{\nfor (i=0; i&lt;arrayHeight; i++)\n    {\n        for (j=0; j&lt;arrayHeight; j++)\n        {\n            printf(\"\\n [%d][%d] \", array[i][-1], array[i][1]);  \n        }\n    }\n}\n}\n</code></pre>\n"}, {"tags": ["c", "makefile", "cuda", "dynamic-parallelism"], "comments": [{"owner": {"reputation": 119299, "user_id": 1695960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f9f557c03db19232aa410540af2f966?s=128&d=identicon&r=PG", "display_name": "Robert Crovella", "link": "https://stackoverflow.com/users/1695960/robert-crovella"}, "edited": false, "score": 0, "creation_date": 1522785646, "post_id": 49638064, "comment_id": 86284096, "body": "1. add <code>-dlink</code> to your 2nd <code>(NVCC)</code> line.  2. change <code>main.c</code> to <code>main.cpp</code>, both the filename itself as well as all references in the makefile.  3. switch from <code>mpicc</code> to <code>mpicxx</code>  Note that you don&#39;t show <code>g.o</code> getting built anywhere,  and you don&#39;t show <code>io.o</code> getting used anywhere, so I&#39;m guessing this not really the makefile you are using."}, {"owner": {"reputation": 7, "user_id": 2330963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2e9cd33c86591fbde80b02a8b060d61?s=128&d=identicon&r=PG", "display_name": "user2330963", "link": "https://stackoverflow.com/users/2330963/user2330963"}, "reply_to_user": {"reputation": 119299, "user_id": 1695960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f9f557c03db19232aa410540af2f966?s=128&d=identicon&r=PG", "display_name": "Robert Crovella", "link": "https://stackoverflow.com/users/1695960/robert-crovella"}, "edited": false, "score": 0, "creation_date": 1522787750, "post_id": 49638064, "comment_id": 86285104, "body": "Thanks Robert. I&#39;ve made the edits you suggested (see edited file above). Now, I get the following errors: &quot;undefined reference to cudaFree, cudaSetDevice&quot;)"}, {"owner": {"reputation": 119299, "user_id": 1695960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f9f557c03db19232aa410540af2f966?s=128&d=identicon&r=PG", "display_name": "Robert Crovella", "link": "https://stackoverflow.com/users/1695960/robert-crovella"}, "edited": false, "score": 0, "creation_date": 1522788372, "post_id": 49638064, "comment_id": 86285377, "body": "add <code>-lcudart</code> to <code>LIBS</code>"}, {"owner": {"reputation": 7, "user_id": 2330963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2e9cd33c86591fbde80b02a8b060d61?s=128&d=identicon&r=PG", "display_name": "user2330963", "link": "https://stackoverflow.com/users/2330963/user2330963"}, "reply_to_user": {"reputation": 119299, "user_id": 1695960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f9f557c03db19232aa410540af2f966?s=128&d=identicon&r=PG", "display_name": "Robert Crovella", "link": "https://stackoverflow.com/users/1695960/robert-crovella"}, "edited": false, "score": 0, "creation_date": 1522790243, "post_id": 49638064, "comment_id": 86286207, "body": "Thanks Robert. Even after adding -lcudart to libs, I get linking errors (as shown above). Thanks for helping again!"}, {"owner": {"reputation": 119299, "user_id": 1695960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f9f557c03db19232aa410540af2f966?s=128&d=identicon&r=PG", "display_name": "Robert Crovella", "link": "https://stackoverflow.com/users/1695960/robert-crovella"}, "edited": false, "score": 0, "creation_date": 1522792190, "post_id": 49638064, "comment_id": 86286941, "body": "1. define your <code>LIBS</code> variable like this: <code>LIBS=-lcublas_device -lcudadevrt -lmpi -lcudart</code> 2. In your final link step, move the <code>$(LIBS)</code> reference to the end of the line, like so: <code>mpicxx $(INCFILES) $(LIBFILES)  cudafiles.o a.o b.o c.o d.o e.o f.o io.o main.o -o exec $(LIBS)</code>"}, {"owner": {"reputation": 7, "user_id": 2330963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2e9cd33c86591fbde80b02a8b060d61?s=128&d=identicon&r=PG", "display_name": "user2330963", "link": "https://stackoverflow.com/users/2330963/user2330963"}, "reply_to_user": {"reputation": 119299, "user_id": 1695960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f9f557c03db19232aa410540af2f966?s=128&d=identicon&r=PG", "display_name": "Robert Crovella", "link": "https://stackoverflow.com/users/1695960/robert-crovella"}, "edited": false, "score": 0, "creation_date": 1522792575, "post_id": 49638064, "comment_id": 86287076, "body": "That worked! Thanks a lot!"}], "answers": [{"tags": [], "owner": {"reputation": 119299, "user_id": 1695960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f9f557c03db19232aa410540af2f966?s=128&d=identicon&r=PG", "display_name": "Robert Crovella", "link": "https://stackoverflow.com/users/1695960/robert-crovella"}, "is_accepted": true, "score": 0, "last_activity_date": 1522797361, "last_edit_date": 1522797361, "creation_date": 1522794093, "answer_id": 49639953, "question_id": 49638064, "link": "https://stackoverflow.com/questions/49638064/compile-multiple-cuda-files-that-have-dynamic-parallelism-and-mpi-code/49639953#49639953", "title": "compile multiple cuda files (that have dynamic parallelism) and MPI code", "body": "<ol>\n<li><p>The original problem reported was an undefined reference to <code>main</code>.  This was arising from this line in the <code>Makefile</code>:</p>\n\n<pre><code>$(NVCC) -std=c++11 $(ARCH) $(INCFILES) $(LIBFILES) $(LIBS) -rdc=true a.o b.o c.o d.o e.o f.o io.o -o cudafiles.o\n</code></pre>\n\n<p>As constructed, this actually instructs <code>nvcc</code> to perform full/final linking.  However the intent of this line was to perform the device-link step only, required when compiling with <code>-rdc=true</code> or <code>-dc</code>, and when not performing the final link with <code>nvcc</code>.  In this case, the final link was being performed by <code>mpicc</code>/<code>mpicxx</code>.  To perform the device-link step only, we need to specify <code>-dlink</code>.  Without that switch, <code>nvcc</code> expects to do final linking, but fails because none of the supplied objects contain a <code>main</code> function.  The correct solution, since we have no intent to do final link at this point, is to use the <code>-dlink</code> switch.</p></li>\n<li><p>I also suggested converting everything to C++ style linking, since <code>nvcc</code> links that way.  It might be possible to sort out a C-style link with a C++-style link, but this just seems troublesome to me.  Therefore I suggested converting the only <code>.c</code> file (<code>main.c</code>) to a <code>.cpp</code> file, and convert from <code>mpicc</code> to <code>mpicxx</code></p></li>\n<li><p>The next problem that arose was undefined references to e.g. <code>cudaSetDevice()</code> and <code>cudaFree()</code>.  These are part of the CUDA runtime API library (\"libcudart\").  When performing final link with <code>nvcc</code>, these are linked automatically.  But since final link is being performed by <code>mpicxx</code> (basically a wrapper on <code>g++</code>), it's necessary to call out the link against that library specifically with <code>-lcudart</code>.</p></li>\n<li><p>Finally, the remaining problem was a link-order problem.  In a nutshell, link dependencies need to be satisfied from left to right in the linker command line.  Different compilers are more or less picky about this.  The final reordering changes were to specify the libraries to link against in the correct order, and also to specify these libraries at the end of the link command line, so that any dependencies on these libraries, to their left in the link command line, are satisfied.</p></li>\n</ol>\n"}], "owner": {"reputation": 7, "user_id": 2330963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2e9cd33c86591fbde80b02a8b060d61?s=128&d=identicon&r=PG", "display_name": "user2330963", "link": "https://stackoverflow.com/users/2330963/user2330963"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 495, "favorite_count": 1, "accepted_answer_id": 49639953, "answer_count": 1, "score": 0, "last_activity_date": 1522797361, "creation_date": 1522784908, "last_edit_date": 1522790126, "question_id": 49638064, "link": "https://stackoverflow.com/questions/49638064/compile-multiple-cuda-files-that-have-dynamic-parallelism-and-mpi-code", "title": "compile multiple cuda files (that have dynamic parallelism) and MPI code", "body": "<p>I have a bunch of .cu files that use dynamic parallelism (a.cu, b.cu, c.cu.., e.cu, f.cu), and a main.c file that uses MPI to call functions from a.cu on multiple nodes. I'm trying to write a make file to compile the executable, but I keep facing the following errors:</p>\n\n<pre><code>cudafiles.o: In function `__cudaRegisterLinkedBinary_66_tmpxft_00001a84_00000000_17_cuda_device_runtime_compute_61_cpp1_ii_8b1a5d37':\nlink.stub:(.text+0x1fb): undefined reference to `__fatbinwrap_66_tmpxft_00001a84_00000000_17_cuda_device_runtime_compute_61_cpp1_ii_8b1a5d37'\n</code></pre>\n\n<p>Here is my makefile:</p>\n\n<pre><code>INCFILES=-I/usr/local/cuda-8.0/include -I/opt/mpi/mvapich2-gnu/2.2/include -I./\nLIBFILES=-L/usr/local/cuda-8.0/lib64 -L/opt/mpi/mvapich2-gnu/2.2/lib\nLIBS=-lcudart -lcudadevrt -lcublas_device -lmpi \nARCH=-gencode arch=compute_60,code=sm_60\nNVCC=nvcc -ccbin g++\n\n\ndefault: all\n\nall: clean final.o\n\nio.o: io.cpp\n        g++ -c -std=c++11  io.cpp \n\n\nfinal.o: io.o a.cu b.cu c.cu d.cu e.cu f.cu main.cpp\n        $(NVCC) -std=c++11 $(INCFILES) $(LIBFILES) $(LIBS) -g -G -Xptxas -v -dc $(ARCH) a.cu b.cu c.cu d.cu e.cu f.cu\n        $(NVCC) -std=c++11 $(ARCH) $(INCFILES) $(LIBFILES) $(LIBS) -rdc=true -dlink a.o b.o c.o d.o e.o f.o io.o -o cudafiles.o\n        mpicxx -O3 $(INCFILES) $(LIBFILES) -c main.cpp -o main.o\n        mpicxx $(INCFILES) $(LIBFILES) $(LIBS) cudafiles.o a.o b.o c.o d.o e.o f.o io.o main.o -o exec\n\nclean:\n        rm -rf *.o exec\n</code></pre>\n"}, {"tags": ["c", "sockets", "select"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1522784620, "post_id": 49637893, "comment_id": 86283622, "body": "Why don&#39;t you add <code>FD_ISSET</code> check for the connected sockets in the set? You do know that sockets by default are <i>blocking</i> which means if you call <code>read</code> on a socket without receiving anything, it will block forever (until there&#39;s an error or connection is closed). That will halt the execution of your server program, blocking all other connection attempts and putting all already connected clients data in buffers that will slowly fill up."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1522784743, "post_id": 49637893, "comment_id": 86283698, "body": "And if you want each connection to have a state (like possibly <code>STATE_GETTING_NAME</code>, <code>STATE_CHATTING</code>, etc. in your case), then I suggest you start learning about <i>structures</i>, and store the socket descriptor and the state in a structure, and have a list of such structures that you go through as needed."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 2, "creation_date": 1522785728, "post_id": 49637893, "comment_id": 86284133, "body": "&lt;O/T&gt; suffixing your executable with <code>.c</code> is quite misleading"}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 1, "creation_date": 1522799472, "post_id": 49637893, "comment_id": 86289039, "body": "&#39;At the same time&#39; implies threads. <code>select()</code> implies sequential scanning of the FD_SET and reading the sockets accordingly."}], "answers": [{"tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": true, "score": 0, "last_activity_date": 1522794211, "last_edit_date": 1522794211, "creation_date": 1522793881, "answer_id": 49639931, "question_id": 49637893, "link": "https://stackoverflow.com/questions/49637893/how-to-read-connections-at-the-same-time-using-select-sockets-c/49639931#49639931", "title": "How to read connections at the same time using select? sockets/c", "body": "<blockquote>\n  <p>How do I make it so the clients can run concurrently without waiting for the first client to finish?</p>\n</blockquote>\n\n<p>By paying attention to which sockets <code>select()</code> reports to you.  You are asking <code>select()</code> to monitor multiple sockets for readability, but you are only checking if the listening socket is readable, you are not checking the client sockets.  You need to keep track of the connected clients so you can enumerate them when needed.</p>\n\n<p>Try something like this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;ctype.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;netinet/in.h&gt;\n#include &lt;arpa/inet.h&gt;\n\nint port = 3008;\n#define MAX_CLIENTS (FD_SETSIZE - 1)\n\nint listenfd = -1;\n\nextern void makelistener();\n\nint main(int argc, char **argv)\n{\n    int clientfd, nready;\n    socklen_t len;\n    struct sockaddr_in q;\n    int i, j, ret;\n    fd_set allset;\n    fd_set rset;\n    int clients[MAX_CLIENTS];\n    int num_clients = 0;\n    int maxfd;\n    char buf[256];\n\n    makelistener();\n\n    // initialize allset and add listenfd to the\n    // set of file descriptors passed into select\n    FD_ZERO(&amp;allset);\n    FD_SET(listenfd, &amp;allset);\n    maxfd = listenfd;\n\n    while (1)\n    {\n        // make a copy of the set before we pass it into select\n        FD_COPY(&amp;allset, &amp;rset);\n\n        // select will wait until an exceptional event occurs when tv is NULL\n        nready = select(maxfd + 1, &amp;rset, NULL, NULL, NULL);\n\n        if (nready &lt; 0) {\n            perror(\"select\");\n            continue;\n        }\n\n        if (nready == 0) { // should never happen since no timeout was requested\n            continue;\n        }\n\n        //FD_ISSET returns 1 when a socket is readable\n\n        if (FD_ISSET(listenfd, &amp;rset)) {\n            //printf(\"a new client is connecting\\n\");\n            len = sizeof(q); //accept connection of listenfd stream socket\n            if ((clientfd = accept(listenfd, (struct sockaddr *)&amp;q, &amp;len)) &lt; 0) {\n                perror(\"accept\");\n                exit(1);\n            }\n\n            printf(\"Client %d connected from %s\\n\", clientfd, inet_ntoa(q.sin_addr));\n\n            if (num_clients == MAX_CLIENTS) {\n                static char msg[] = \"Max number of clients are already connected\\r\\n\";\n                write(clientfd, msg, sizeof(msg)-1);\n                close(clientfd);\n            }\n            else {\n                static char msg[] = \"What is your name?\\r\\n\";\n                if (write(clientfd, msg, sizeof(msg)-1) &lt; 0) {\n                    close(clientfd);\n                }\n                else {\n                    clients[num_clients++] = clientfd;\n                    FD_SET(clientfd, &amp;allset);\n                    if (clientfd &gt; maxfd) {\n                        maxfd = clientfd;\n                    }\n                }\n            }\n        }\n\n        for (i = 0; i &lt; num_clients; ++i) {\n            clientfd = clients[i];\n\n            if (!FD_ISSET(clientfd, &amp;rset)) {\n                continue;\n            }\n\n            ret = read(clientfd, buf, sizeof(buf));\n            if (ret &lt;= 0) {\n                //printf(\"a client has disconnected\\n\");\n                close(clientfd);\n                FD_CLR(clientfd, &amp;allset);\n                for (j = i + 1; j &lt; num_clients; ++j) {\n                    clients[j-1] = clients[j];\n                }\n                --num_clients;\n\n                if (clientfd == maxfd) {\n                    maxfd = listenfd;\n                    for (j = 0; j &lt; num_clients; ++j) {\n                        if (clients[j] &gt; maxfd) {\n                            maxfd = clients[j];\n                        }\n                    }\n                }\n\n                --i;\n                continue;\n            }\n\n            printf(\"Client %d: %.*s\", clientfd, ret, buf);\n        }\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>Note that <code>poll()</code> or <code>epoll()</code> would generally be a better choice to use than <code>select()</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": false, "score": 0, "last_activity_date": 1522942420, "creation_date": 1522942420, "answer_id": 49676275, "question_id": 49637893, "link": "https://stackoverflow.com/questions/49637893/how-to-read-connections-at-the-same-time-using-select-sockets-c/49676275#49676275", "title": "How to read connections at the same time using select? sockets/c", "body": "<p><em>How do I make it so the clients can run concurrently without waiting for the first client to finish?</em></p>\n\n<p>every time that the call to <code>accept()</code> returns, start a thread <code>pthread_create()</code> to handle the actual communication with the client.</p>\n\n<p>Note: creating/destroying a thread is very time consuming, so suggest learning about <code>thread pools</code> and how to use them.</p>\n\n<p>When using threads, there is no call to <code>select()</code> (nor <code>poll()</code>)  Rather the main function gets blocked on the call to <code>accept()</code> and when that function returns, pass the associated socket to a thread to handle</p>\n\n<p>There are lots of example code for how a server should communicate with multiple clients on stackoverflow.com</p>\n"}], "owner": {"reputation": 233, "user_id": 8658491, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e1c86647a34b4c0a2df1e6c282b07fd4?s=128&d=identicon&r=PG&f=1", "display_name": "e t", "link": "https://stackoverflow.com/users/8658491/e-t"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 49639931, "answer_count": 2, "score": 0, "last_activity_date": 1522942420, "creation_date": 1522784216, "last_edit_date": 1522787178, "question_id": 49637893, "link": "https://stackoverflow.com/questions/49637893/how-to-read-connections-at-the-same-time-using-select-sockets-c", "title": "How to read connections at the same time using select? sockets/c", "body": "<pre><code>#include &lt;stdio.h&gt;\n#include &lt;ctype.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;netinet/in.h&gt;\n#include &lt;arpa/inet.h&gt;\n\n\nint port = 3008;\nint listenfd;\n\nextern void makelistener();\nint main(int argc, char **argv)\n{\n    makelistener();\n    int clientfd, nready;\n    socklen_t len;\n    struct sockaddr_in q;\n    int i;\n\n    // initialize allset and add listenfd to the\n    // set of file descriptors passed into select\n    fd_set allset;\n    fd_set rset;\n    int maxfd;\n    FD_ZERO(&amp;allset);\n    FD_SET(listenfd, &amp;allset); // set of file descriptors\n\n    maxfd = listenfd;\n    int ret;\n\n    while (1)\n    {\n        // make a copy of the set before we pass it into select\n        rset = allset;\n        /*select will wait until an exceptional event occurs when tv is NULL*/\n\n\n        nready = select(maxfd + 1, &amp;rset, NULL, NULL, NULL);\n        if (nready == 0) {\n            continue;\n        }\n\n        if (nready == -1) {\n            perror(\"select\");\n            continue;\n        }\n\n        //FD_ISSET returns 1 when a new connection is attempted\n        if(FD_ISSET(listenfd, &amp;rset)){\n            //printf(\"a new client is connecting\\n\");\n            len = sizeof(q); //accept connection of listenfd stream socket\n            if ((clientfd = accept(listenfd, (struct sockaddr *)&amp;q, &amp;len)) &lt; 0) {\n                perror(\"accept\");\n                exit(1);\n            }\n            FD_SET(clientfd, &amp;allset);\n            if (clientfd &gt; maxfd) {\n                maxfd = clientfd;\n            }\n\n            static char msg[] = \"What is your name?\\r\\n\";\n            write(clientfd, msg, sizeof msg - 1);\n            printf(\"connection from %s\\n\", inet_ntoa(q.sin_addr));\n            char buf[256];\n            ret = read(clientfd, buf, sizeof(buf));\n            buf[ret] = '\\0';\n            printf(\"%s\", buf);\n       }\n\n\n\n   }\n\n\n\n\n\n}\n\n\nvoid makelistener()\n{\n    struct sockaddr_in r;\n\n    if ((listenfd = socket(AF_INET, SOCK_STREAM, 0)) &lt; 0) {\n        perror(\"socket\");\n        exit(1);\n    }\n\n    memset(&amp;r, '\\0', sizeof r);\n    r.sin_family = AF_INET;\n    r.sin_addr.s_addr = INADDR_ANY;\n    r.sin_port = htons(port);\n    if (bind(listenfd, (struct sockaddr *)&amp;r, sizeof r)) {\n        perror(\"bind\");\n        exit(1);\n    };\n\n    if (listen(listenfd, 5)) {\n        perror(\"listen\");\n        exit(1);\n    }\n}\n</code></pre>\n\n<p>above code is for the server and it does this</p>\n\n<pre><code>$ ./above.c\n(does nothing but runs forever)\n</code></pre>\n\n<p>How to connect as a client:</p>\n\n<pre><code>$ nc 127.0.0.1 3000\nWhat is your name?\n(waiting for my input) so if I put bob, it would output it to the server\n</code></pre>\n\n<p>It works as intended. But I want it too work concurrently with multiple clients.</p>\n\n<p>for example:</p>\n\n<p>server</p>\n\n<pre><code>$ ./above.c\n(does nothing but runs forever)\n</code></pre>\n\n<p>client1</p>\n\n<pre><code>$ nc 127.0.0.1 3000\nWhat is your name?\n</code></pre>\n\n<p>client 2  </p>\n\n<pre><code>$ nc 127.0.0.1 3000\nWhat is your name? (Currently client2 wont show up until client1 is answered which is what I'm trying to fix)\n</code></pre>\n\n<p>How do I make it so the clients can run concurrently without waiting for the first client to finish? To explain the code a little bit, listener just binds and listens to a connection. Inside the while(1) is where select and calls are.</p>\n"}, {"tags": ["c", "printf"], "comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1522783271, "post_id": 49637644, "comment_id": 86282980, "body": "What are the return values of all called functions?"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 3, "creation_date": 1522783290, "post_id": 49637644, "comment_id": 86282989, "body": "Please upgrade to a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1522783298, "post_id": 49637644, "comment_id": 86282993, "body": "if <code>dtm</code> contains only one word, then <code>second_word</code> is garbage, yes. check return value of <code>scanf</code>. It must be 2."}, {"owner": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "edited": false, "score": 0, "creation_date": 1522783353, "post_id": 49637644, "comment_id": 86283024, "body": "Load your Minimal, Complete, and Verifiable example into a debugger and look at all the variables."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1522783362, "post_id": 49637644, "comment_id": 86283028, "body": "You do know that the <code>&quot;%s&quot;</code> format stops on <i>space</i>? Perhaps you want <a href=\"http://en.cppreference.com/w/c/io/fgets\" rel=\"nofollow noreferrer\"><code>fgets</code></a> to read a whole line?"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1522783413, "post_id": 49637644, "comment_id": 86283061, "body": "yeah, so <code>dtm</code> <i>always</i> contains one word, the second one is garabge"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 1, "creation_date": 1522783468, "post_id": 49637644, "comment_id": 86283086, "body": "I&#39;m voting to close this question as off-topic because OP cannot spell &quot;garbage&quot;"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1522783616, "post_id": 49637644, "comment_id": 86283155, "body": "Checking the return value from <code>sscanf</code> (should be <code>2</code>) would have told you this. Always check user input, because <b><i>that</i></b> is the usual source of garbage, either accidentally, by misunderstanding, or mischief."}], "answers": [{"comments": [{"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 2, "creation_date": 1522783768, "post_id": 49637744, "comment_id": 86283236, "body": "Do not suggest using the deprecated function <code>gets</code>, you should suggest using <code>fgets</code>"}], "tags": [], "owner": {"reputation": 47, "user_id": 9439574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a3f1322aa40c1e9f199d6c924031a83?s=128&d=identicon&r=PG&f=1", "display_name": "Flabian", "link": "https://stackoverflow.com/users/9439574/flabian"}, "is_accepted": false, "score": 1, "last_activity_date": 1522783601, "creation_date": 1522783601, "answer_id": 49637744, "question_id": 49637644, "link": "https://stackoverflow.com/questions/49637644/printf-producing-garbage/49637744#49637744", "title": "printf() producing garbage", "body": "<p>Replace <code>scanf(\"%s\", username);</code> with <code>gets(username);</code>(line 3).\nThats where your problem is. Scanf is only taking the first word.</p>\n"}, {"comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1522783903, "post_id": 49637771, "comment_id": 86283300, "body": "<code>memset</code> works but is OTT. <code>char dtm[50] = &quot;&quot;;</code> reads better."}, {"owner": {"reputation": 5000, "user_id": 8405835, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sN3eq.png?s=128&g=1", "display_name": "Abhijit Pritam Dutta", "link": "https://stackoverflow.com/users/8405835/abhijit-pritam-dutta"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1522784068, "post_id": 49637771, "comment_id": 86283381, "body": "Yes true. Thanks for your comments. I have modified my answer based on your advice."}], "tags": [], "owner": {"reputation": 5000, "user_id": 8405835, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sN3eq.png?s=128&g=1", "display_name": "Abhijit Pritam Dutta", "link": "https://stackoverflow.com/users/8405835/abhijit-pritam-dutta"}, "is_accepted": false, "score": 0, "last_activity_date": 1522783949, "last_edit_date": 1522783949, "creation_date": 1522783730, "answer_id": 49637771, "question_id": 49637644, "link": "https://stackoverflow.com/questions/49637644/printf-producing-garbage/49637771#49637771", "title": "printf() producing garbage", "body": "<p>Please always keep in my that <code>printf</code> never produce any garbage. It is we creates these issues by our self. While playing with string always be careful and to instruct <code>printf</code> end of a string we must put a end of string character at the end of a string and that is call null character <code>\\0</code> or 0. Some of the C function does not insert a <code>\\0</code> character at the end of the string and hence it is our duty to take care of it. Better always initialize a string with 0 in all the location like below, this is one of the good practice to avoid side effect like this.</p>\n\n<pre><code>char dtm[50];\nchar first_word[50];\nchar second_word[50];\n\nmemset(dtm, 0, 50);//or memset(dtm, 0, sizeof(dtm));\nmemset(first_word, 0, 50);//or memset(first_word, 0, sizeof(first_word));\nmemset(second_word, 0, 50);// or memset(second_word, 0, sizeof(second_word));\n</code></pre>\n\n<p>Below practice is also safe.</p>\n\n<pre><code>char dtm[50] = \"\";\nchar first_word[50] = \"\";\nchar second_word[50] = \"\";\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 9581310, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91e0c8847eb9acefc1d9f52da2ba5aff?s=128&d=identicon&r=PG&f=1", "display_name": "static", "link": "https://stackoverflow.com/users/9581310/static"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 191, "favorite_count": 0, "closed_date": 1522795396, "answer_count": 2, "score": -5, "last_activity_date": 1522783949, "creation_date": 1522783171, "last_edit_date": 1522783737, "question_id": 49637644, "link": "https://stackoverflow.com/questions/49637644/printf-producing-garbage", "closed_reason": "Not suitable for this site", "title": "printf() producing garbage", "body": "<pre><code>char username[50];\n\nprintf(\"[Enter Command]: \\n\");\nscanf(\"%s\", username);\n\nif (strcmp(\"exit\", username) == 0) {\n    exit(0);\n}\n\nif (strcmp(\"jobs\", username) == 0) {\n    printf(\"[SERVER] No currently running jobs\\n\");\n}\n\nchar dtm[50];\nchar first_word[50];\nchar second_word[50];\n\n\nstrcpy(dtm, username);\nsscanf(dtm, \"%s %s\", first_word, second_word);\n\nprintf(\"%s %s\\n\", first_word, second_word);\n</code></pre>\n\n<p>I want to extract the first and second word of my inputted string. I don't understand why my printf() statement is producing garbage outputs</p>\n"}, {"tags": ["c", "dynamic-allocation", "heap-corruption"], "comments": [{"owner": {"reputation": 1273, "user_id": 8285732, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edc625d1ed5c36dfef98d17dfeac7fe7?s=128&d=identicon&r=PG&f=1", "display_name": "milbrandt", "link": "https://stackoverflow.com/users/8285732/milbrandt"}, "edited": false, "score": 2, "creation_date": 1522782699, "post_id": 49637454, "comment_id": 86282701, "body": "In your Code snippets I don&#39;t see any <code>free</code>. I assume some relevant part is missing."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 2, "creation_date": 1522783185, "post_id": 49637454, "comment_id": 86282950, "body": "tons of variables here, we don&#39;t know what any of your arguments, structures, or typedefs are, an <a href=\"https://stackoverflow.com/help/mcve\">MCVE</a> would be most helpful. But in your <code>temprijec</code> function, allocating <code>temp</code> based on <code>*len</code>, then changing <code>*len</code> to some other value, then filling <code>temp</code> based on the new value of <code>*len</code>,,, that seems awfully dangerous to me."}, {"owner": {"reputation": 800, "user_id": 729457, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cbcbb32c1ac3370b009fea522c482a04?s=128&d=identicon&r=PG", "display_name": "Evan Darwin", "link": "https://stackoverflow.com/users/729457/evan-darwin"}, "edited": false, "score": 0, "creation_date": 1522787353, "post_id": 49637454, "comment_id": 86284925, "body": "What steps have you taken to try and debug this? I&#39;d recommend reading <a href=\"https://stackoverflow.com/help/mcve\">stackoverflow.com/help/mcve</a> to learn how to narrow this issue down."}, {"owner": {"reputation": 4654, "user_id": 332733, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BR7yE.jpg?s=128&g=1", "display_name": "Mgetz", "link": "https://stackoverflow.com/users/332733/mgetz"}, "edited": false, "score": 1, "creation_date": 1522789179, "post_id": 49637454, "comment_id": 86285734, "body": "The error you&#39;re getting is pretty clear, you&#39;re writing out of bounds and triggering UB. Check your memory accesses."}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 1, "creation_date": 1522793318, "post_id": 49637454, "comment_id": 86287306, "body": "you just have to slog through to find out where you go off the end of temp. The free is raising the error simply because thats when the debug CRT gets a change to look see if you wrote off the end of your space. If you were on linux you could use valgrind"}, {"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 1, "creation_date": 1522803326, "post_id": 49637454, "comment_id": 86289908, "body": "It does not make sense to use strlen() to calculate <code>*len</code> <i>after</i> the calloc() call.  Swap the two statements."}, {"owner": {"reputation": 21, "user_id": 9592807, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Mx2uler", "link": "https://stackoverflow.com/users/9592807/mx2uler"}, "reply_to_user": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 1, "creation_date": 1523116737, "post_id": 49637454, "comment_id": 86431838, "body": "@yano Sry for late response.I  copied that <code>*len</code> part to wrong place here.I did like you said,I have created MCVE but without all those pointers and it worked,so I passed structure with needed variables to function instead of pointers and now it works. Tnx for your comment it helped me alot."}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 9592807, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Mx2uler", "link": "https://stackoverflow.com/users/9592807/mx2uler"}, "is_accepted": true, "score": 1, "last_activity_date": 1523117039, "creation_date": 1523117039, "answer_id": 49709254, "question_id": 49637454, "link": "https://stackoverflow.com/questions/49637454/heap-corruption-when-freeing-allocated-memory/49709254#49709254", "title": "Heap-corruption when freeing allocated memory", "body": "<p>I fixed the error by changing the way I am passing variables to function,structure instead of pointers and now it works idk why but it works :).Tnx everyone for help.</p>\n\n<p>Changed code:</p>\n\n<pre><code>VARIJABLE temprijec(VARIJABLE V, RIJEC *B) {\n    int i;\n    V.len = strlen((B + V.rng)-&gt;rijec);\n    V.temp = (char*)calloc(V.len + 1, sizeof(char));\n\n    for (i = 0; i &lt; V.len + 1; i++) {\n        if (i == 0) {\n            V.temp[i] = (B + V.rng)-&gt;rijec[i];\n        }\n        else if (i == (V.len)) {\n            V.temp[i] = '\\0';\n        }\n        else {\n            V.temp[i] = '_';\n        }\n    }\n    return V;\n}\n</code></pre>\n\n<p>and</p>\n\n<pre><code>VARIJABLE tijek_igre(RIJEC *B, VARIJABLE V) {\n    int i;\n    printf(\"\\nPogodi slovo ili rijec!\");\n    V.ch = _getch();\n    for (i = 0; (B + V.rng)-&gt;rijec[i] != '\\0'; i++) {\n        if (V.ch == (B + V.rng)-&gt;rijec[i]) {\n            V.temp[i] = V.ch;\n        }\n    }\n    for (i = 0; (B + V.rng)-&gt;rijec[i] != '\\0'; i++) {\n        if (V.ch != (B + V.rng)-&gt;rijec[i]) {\n            (V.pogresno_slovo)++;\n            if (V.pogresno_slovo == V.len) {\n                (V.pogreska)++;\n            }\n        }\n    }\n    for (i = 0; V.temp[i] != '\\0'; i++) {\n        if (V.temp[i] != '_') {\n            (V.tocno_slovo)++;\n        }\n    }\n    return V;\n}\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 9592807, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Mx2uler", "link": "https://stackoverflow.com/users/9592807/mx2uler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 282, "favorite_count": 0, "accepted_answer_id": 49709254, "answer_count": 1, "score": 0, "last_activity_date": 1523117039, "creation_date": 1522782422, "last_edit_date": 1522802303, "question_id": 49637454, "link": "https://stackoverflow.com/questions/49637454/heap-corruption-when-freeing-allocated-memory", "title": "Heap-corruption when freeing allocated memory", "body": "<p>I am writing small school project, and I got stuck with error that I can't fix. When I try to free allocated memory, I get this error:</p>\n\n<p><a href=\"https://i.stack.imgur.com/fhIa9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/fhIa9.png\" alt=\"Heap Corruption Error\"></a></p>\n\n<p>Here is the code that involves my <code>char</code> pointer <code>temp</code>:</p>\n\n<p><strong>1. Allocation of memory and setting starting value:</strong></p>\n\n<pre><code> char *temprijec(int rng, RIJEC *B, int *len) {\n    int i;\n    char *temp=(char*)calloc(*len + 1, sizeof(char));\n    *len = strlen((B + rng)-&gt;rijec);\n    for (i = 0; i &lt; *len; i++) {\n        if (i == 0) {\n            temp[i] = (B + rng)-&gt;rijec[i];\n        }\n        else if (i == (*len)) {\n            temp[i] = '\\0';\n        }\n        else {\n            temp[i] = '_';\n        }\n    }\n    return temp;\n }\n</code></pre>\n\n<p><strong>2. Working with char pointer <code>temp</code>:</strong></p>\n\n<pre><code>void tijek_igre(char*temp,RIJEC *B,int rng,int len,int*br2pok,int *pokpogreska,int *pokbr,char*pokch) {\n    int i;\n    printf(\"\\nPogodi slovo ili rijec!\");\n    *pokch = _getch();\n    for (i = 0; (B + rng)-&gt;rijec[i] != '\\0'; i++) {\n        if (*pokch == (B + rng)-&gt;rijec[i]) {\n            temp[i] = *pokch;\n        }\n    }\n    for (i = 0; (B + rng)-&gt;rijec[i] != '\\0'; i++) {\n        if (*pokch != (B + rng)-&gt;rijec[i]) {\n            (*br2pok)++;\n            if (*br2pok == len) {\n                (*pokpogreska)++;\n            }\n        }\n    }\n    for (i = 0; temp[i] != '\\0'; i++) {\n        if (temp[i] != '_') {\n            (*pokbr)++;\n        }\n    }\n}\n</code></pre>\n\n<p>Everything is fine until I try to free it with <code>free(temp);</code></p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 4993, "user_id": 885605, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c16c5ec313530f501f11c809ee6c8473?s=128&d=identicon&r=PG", "display_name": "Andreas Grapentin", "link": "https://stackoverflow.com/users/885605/andreas-grapentin"}, "edited": false, "score": 1, "creation_date": 1522781285, "post_id": 49637131, "comment_id": 86281958, "body": "you are trying to print the string at address <code>45</code> - what do you expect the output to be?"}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 4, "creation_date": 1522781289, "post_id": 49637131, "comment_id": 86281960, "body": "Your functions are already receiving a pointer.  just pass the pointer. to the next function.  For example <code>func2(&amp;*x);</code> -&gt; <code>func2(x);</code>"}, {"owner": {"reputation": 15260, "user_id": 1968182, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/E5nF2.jpg?s=128&g=1", "display_name": "Ulrich Eckhardt", "link": "https://stackoverflow.com/users/1968182/ulrich-eckhardt"}, "edited": false, "score": 0, "creation_date": 1522781404, "post_id": 49637131, "comment_id": 86282014, "body": "What happens if you don&#39;t pass the pointer along but put the code inline? If you did that, you&#39;d see that the argument passing isn&#39;t the problem. Also, it&#39;s irrelevant that it&#39;s a pointer to a struct. It&#39;s for that reason that you are required to provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>!"}, {"owner": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 0, "creation_date": 1522781549, "post_id": 49637131, "comment_id": 86282090, "body": "When you dereference <code>x-ptr</code> in <code>func3</code> you are asking to see what is at memory location <code>45</code>, which almost certainly will cause an exception/"}], "answers": [{"tags": [], "owner": {"reputation": 992, "user_id": 3444956, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45650f2170663c203fd5d87b44580c64?s=128&d=identicon&r=PG&f=1", "display_name": "harmands", "link": "https://stackoverflow.com/users/3444956/harmands"}, "is_accepted": true, "score": 1, "last_activity_date": 1522781746, "creation_date": 1522781746, "answer_id": 49637277, "question_id": 49637131, "link": "https://stackoverflow.com/questions/49637131/pass-by-reference-a-struct-through-multiple-functions-in-c/49637277#49637277", "title": "pass by reference a struct through multiple functions in C", "body": "<p>Without many changes to your code, I have fixed two things here.</p>\n\n<p>1) You are trying to print a string starting from the address <code>45</code>.\nThat is an issue, obviously it will print garbage.</p>\n\n<p>2) You can pass the pointer forward as it is.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\ntypedef struct _buf {\n   void  *ptr;\n   size_t len;\n} buf;\n\n\nint func3(buf *x){\n  x-&gt;ptr = (void*)\"hello\";\n  printf(\"func3 %s \\n\", (char *)x-&gt;ptr);\n  return 0;\n}\n\nint func2(buf *x){\n  func3(x);\n  printf(\"func2 %s \\n\", (char *)x-&gt;ptr);\n  return 0;\n}\n\n\nint func1(buf *x) {\n  func2(x);\n  printf(\"func1 %s \\n\", (char *)x-&gt;ptr);\n  return 0;\n}\n\n\nint main() {\n  buf x = {NULL, 0};\n  func1(&amp;x);\n  printf(\"main %s \\n\",(char*) x.ptr);\n  return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 1461, "user_id": 5641188, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9bab5cda330ff2a8e1f909f3c2ac7700?s=128&d=identicon&r=PG&f=1", "display_name": "pavikirthi", "link": "https://stackoverflow.com/users/5641188/pavikirthi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 151, "favorite_count": 0, "accepted_answer_id": 49637277, "answer_count": 1, "score": 0, "last_activity_date": 1522781746, "creation_date": 1522781159, "question_id": 49637131, "link": "https://stackoverflow.com/questions/49637131/pass-by-reference-a-struct-through-multiple-functions-in-c", "title": "pass by reference a struct through multiple functions in C", "body": "<p>I am trying to pass a struct by reference through multiple functions but I am getting garbage value when I try to print the value of the struct in each function. How to correctly pass it by reference, so that the value is passed back until from <code>func3() -&gt; func2() -&gt; func1()-&gt; main()</code> function</p>\n\n<pre><code>typedef struct _buf {\n   void  *ptr;\n   size_t len;\n} buf;\n\n\nint func3(buf *x){\n  x-&gt;ptr = 45;\n  printf(\"func3 %s \\n\", (char *)x-&gt;ptr);\n  return 0;\n}\n\nint func2(buf *x){\n  func3(&amp;* x);\n  printf(\"func2 %s \\n\", (char *)x-&gt;ptr);\n  return 0;\n}\n\n\nint func1(buf *x) {\n  func2(&amp;*x);\n  printf(\"func1 %s \\n\", (char *)x-&gt;ptr);\n  return 0;\n}\n\n\nint main() {\n  buf x = {NULL, 0};\n  func1(&amp;x);\n  printf(\"main %s \\n\", (char *)x.ptr);\n  return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "macos", "sockets", "arp"], "comments": [{"owner": {"reputation": 2592, "user_id": 2963819, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bcc08ce2a4490cf3496020812fe10ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Ishay Peled", "link": "https://stackoverflow.com/users/2963819/ishay-peled"}, "edited": false, "score": 0, "creation_date": 1522781095, "post_id": 49636765, "comment_id": 86281852, "body": "Check out this: <a href=\"https://stackoverflow.com/questions/10593736/mac-address-from-interface-on-os-x-c\" title=\"mac address from interface on os x c\">stackoverflow.com/questions/10593736/&hellip;</a> and if it helped you, close this question as duplicate"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8379153"}, "reply_to_user": {"reputation": 2592, "user_id": 2963819, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bcc08ce2a4490cf3496020812fe10ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Ishay Peled", "link": "https://stackoverflow.com/users/2963819/ishay-peled"}, "edited": false, "score": 0, "creation_date": 1522781348, "post_id": 49636765, "comment_id": 86281983, "body": "I checked it before asking, It is not working."}, {"owner": {"reputation": 144819, "user_id": 2836621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/suHg4.jpg?s=128&g=1", "display_name": "Mark Setchell", "link": "https://stackoverflow.com/users/2836621/mark-setchell"}, "edited": false, "score": 0, "creation_date": 1522784630, "post_id": 49636765, "comment_id": 86283628, "body": "You do realise a machine may have multiple network interfaces (e.g. wired and wifi) and each will have a distinct MAC address..."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8379153"}, "edited": false, "score": 0, "creation_date": 1522786377, "post_id": 49636765, "comment_id": 86284425, "body": "its argc is different than 2. Thus, program is exiting at the begining. If I turn these lines to comment line, it returns the Mac value 00:00:00:00:00:00"}, {"owner": {"reputation": 811, "user_id": 9493582, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bfI3b.jpg?s=128&g=1", "display_name": "Arndt Jonasson", "link": "https://stackoverflow.com/users/9493582/arndt-jonasson"}, "edited": false, "score": 0, "creation_date": 1522845769, "post_id": 49636765, "comment_id": 86310765, "body": "What happens if you give it an interface name, as designed? You can find out which are available with the <code>ifconfig</code> command. (I think - I don&#39;t have a Mac to test on right now.)"}], "owner": {"user_type": "does_not_exist", "display_name": "user8379153"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1522865636, "creation_date": 1522779653, "last_edit_date": 1522865636, "question_id": 49636765, "link": "https://stackoverflow.com/questions/49636765/getting-mac-adds-of-machine-in-c-with-macos", "title": "Getting MAC adds of machine in C with MacOS", "body": "<p>I am dealing with socket programming with C language and Xcode. I can open socket, server and client. I need to learn my machine's Mac address and then, I will send Arp request for server machine. </p>\n\n<p>Almost all examples had been written for linux. I need to solve it in Mac OS. </p>\n\n<p>Currently, I am using these codes with opening two projects and they are able to communicate. </p>\n\n<p><a href=\"https://www.geeksforgeeks.org/socket-programming-cc/\" rel=\"nofollow noreferrer\">https://www.geeksforgeeks.org/socket-programming-cc/</a></p>\n\n<p>Could you give some example or information about this problem?</p>\n"}, {"tags": ["c", "struct"], "comments": [{"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 0, "creation_date": 1522779547, "post_id": 49636650, "comment_id": 86281007, "body": "Please condense your code to a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> and post it."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1522779617, "post_id": 49636650, "comment_id": 86281041, "body": "Not clear what your problem is. If you want to clear an object, the best way is to clear the object. You can&#39;t delete members from a <code>struct</code>. What&#39;s your problem not mentioned in the obscure youtube video you might try to learn C from?"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1522779821, "post_id": 49636650, "comment_id": 86281139, "body": "I don&#39;t get it. Why do want &quot;the field&quot; to become blank  if you choose not to edit it? To me it makes no sense. Try to explain in more details"}, {"owner": {"reputation": 811, "user_id": 9493582, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bfI3b.jpg?s=128&g=1", "display_name": "Arndt Jonasson", "link": "https://stackoverflow.com/users/9493582/arndt-jonasson"}, "edited": false, "score": 0, "creation_date": 1522779939, "post_id": 49636650, "comment_id": 86281208, "body": "What do you want &quot;the field&quot; (which field?) to be if you don&#39;t enter it? An empty string? NULL?"}], "answers": [{"tags": [], "owner": {"reputation": 152, "user_id": 9325070, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uwiQy.png?s=128&g=1", "display_name": "PizzaBeer", "link": "https://stackoverflow.com/users/9325070/pizzabeer"}, "is_accepted": true, "score": 0, "last_activity_date": 1522780129, "creation_date": 1522780129, "answer_id": 49636871, "question_id": 49636650, "link": "https://stackoverflow.com/questions/49636650/deleting-a-member-of-a-struct-in-c/49636871#49636871", "title": "Deleting a member of a struct in C", "body": "<p>Set the struct field to a null pointer, or a pointer to \"my blank string\"<br>\n<code>*num-&gt;cell = 0;</code></p>\n\n<p>If you do this, you'll have to check for null later.  </p>\n\n<p>Or you can do  <code>*num-&gt;cell = myBlankString;</code>  , where blank string is defined as<br>\n<code>char myBlankString[1] = \"\";</code>\nThis is a printable, blank string.</p>\n"}], "owner": {"reputation": 31, "user_id": 9497976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dd20a0b24225157d3e361737ddbb052?s=128&d=identicon&r=PG&f=1", "display_name": "C. Cunanan", "link": "https://stackoverflow.com/users/9497976/c-cunanan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1596, "favorite_count": 0, "accepted_answer_id": 49636871, "answer_count": 1, "score": 0, "last_activity_date": 1522780129, "creation_date": 1522779174, "last_edit_date": 1522779952, "question_id": 49636650, "link": "https://stackoverflow.com/questions/49636650/deleting-a-member-of-a-struct-in-c", "title": "Deleting a member of a struct in C", "body": "<p><strong>Problem:</strong> Struct keeps the data in it after being edited.</p>\n\n<p>I have a program where it manages Contacts in a struct and for some reason when I update a contact, it doesn't reset or leave the field blank if I choose not to edit it.</p>\n\n<p>Update function:</p>\n\n<pre><code>void updateContact(struct Contact contact[], int update) {\n    char contactInput[11] = { '\\0' };\n    int ans = 0;\n    int contactIndex;\n    int contactx;\n\n    printf(\"Enter the cell number for the contact: \");\n    getTenDigitPhone(contactInput);\n\n    contactIndex = findContactIndex(contact, update, contactInput);\n    contactx = findContactIndex(contact, update, contactInput);\n\n    if (contactx == -1) {\n        printf(\"*** Contact NOT FOUND ***\\n\");\n    }\n    else {\n        printf(\"\\nContact found:\\n\");\n        displayContact(&amp;contact[contactIndex]);\n\n        printf(\"\\nDo you want to update the name? (y or n): \");\n        ans = yes();\n\n        if (ans == 1) {\n            getName(&amp;contact[contactIndex].name);\n        }\n\n        printf(\"Do you want to update the address? (y or n): \");\n        ans = yes();\n\n        if (ans == 1) {\n            getAddress(&amp;contact[contactIndex].address);\n        }\n\n        printf(\"Do you want to update the numbers? (y or n): \");\n        ans = yes();\n\n        if (ans == 1) {\n                getNumber(&amp;contact[contactIndex].numbers);\n        }      \n    }    \n}\n</code></pre>\n\n<p>Struct:</p>\n\n<pre><code>struct Contact contact[MAXCONTACTS] =\n{       {           { \"Rick\", { '\\0' }, \"Grimes\" },\n        { 11, \"Trailer Park\", 0, \"AJA 2J2\", \"King City\" },\n        { \"4161112222\", \"2162223333\", \"4163334444\" }        },\n\n    {           { \"Maggie\", \"R.\", \"Greene\" },\n        { 55, \"Hightop House\", 0, \"A9A 3K3\", \"Bolton\" },\n        { \"9051112222\", \"9052223333\", \"9053334444\" }        },\n</code></pre>\n\n<p>getNumber Function:</p>\n\n<pre><code>void getNumber(struct Number *num) {\n    int response;\n\n    printf(\"Please enter the contact's cell phone number: \");\n    getTenDigitPhone(num-&gt;cell);\n    //      scanf(\"%10s\", num-&gt;cell);\n    //      *num-&gt;cell = getInt();\n\n    printf(\"Do you want to enter a home phone number? (y or n): \");\n    response = yes();\n\n    if (response == 1) {\n        printf(\"Please enter the contact's home phone number: \");\n        getTenDigitPhone(num-&gt;home);\n        //      scanf(\"%10s\", num-&gt;home);\n        //      *num-&gt;home = getInt();\n    }\n\n    printf(\"Do you want to enter a business phone number? (y or n): \");\n    response = yes();\n\n    if (response == 1) {\n        printf(\"Please enter the contact's business phone number: \");\n        getTenDigitPhone(num-&gt;business);\n        //      scanf(\"%10s\", num-&gt;business);\n        //      *num-&gt;business = getInt();\n    }    }\n</code></pre>\n\n<p>I want to leave the field blank (if I didn't update it) after I update the contact. I don't know how to delete a member struct so please help me, I will really appreciate it.</p>\n"}, {"tags": ["c", "segmentation-fault", "malloc", "clock", "time.h"], "comments": [{"owner": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "edited": false, "score": 0, "creation_date": 1522779291, "post_id": 49636628, "comment_id": 86280866, "body": "Impossible to answer without a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 45, "user_id": 8777086, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/984c585cfd208da7a0e9702d7761cf5a?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/8777086/chris"}, "reply_to_user": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "edited": false, "score": 0, "creation_date": 1522779539, "post_id": 49636628, "comment_id": 86281000, "body": "@FredLarson I have added the complete code."}, {"owner": {"reputation": 811, "user_id": 9493582, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bfI3b.jpg?s=128&g=1", "display_name": "Arndt Jonasson", "link": "https://stackoverflow.com/users/9493582/arndt-jonasson"}, "edited": false, "score": 0, "creation_date": 1522780028, "post_id": 49636628, "comment_id": 86281264, "body": "Where in the program does the segmentation fault occur? Use gdb to find out."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1522780167, "post_id": 49636628, "comment_id": 86281340, "body": "<a href=\"http://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc\">don&#39;t cast malloc</a>"}, {"owner": {"reputation": 45, "user_id": 8777086, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/984c585cfd208da7a0e9702d7761cf5a?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/8777086/chris"}, "reply_to_user": {"reputation": 811, "user_id": 9493582, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bfI3b.jpg?s=128&g=1", "display_name": "Arndt Jonasson", "link": "https://stackoverflow.com/users/9493582/arndt-jonasson"}, "edited": false, "score": 0, "creation_date": 1522780325, "post_id": 49636628, "comment_id": 86281422, "body": "@ArndtJonasson I have commented which line is causing the segmenttion fault."}], "answers": [{"comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1522780271, "post_id": 49636858, "comment_id": 86281387, "body": "Just to be clear, that line is fine in the loop, but when the loop ends <code>i</code> and <code>x</code> are outside the bounds."}, {"owner": {"reputation": 45, "user_id": 8777086, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/984c585cfd208da7a0e9702d7761cf5a?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/8777086/chris"}, "edited": false, "score": 0, "creation_date": 1522780276, "post_id": 49636858, "comment_id": 86281389, "body": "That is there because it is what I am trying to find the computation time of."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 45, "user_id": 8777086, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/984c585cfd208da7a0e9702d7761cf5a?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/8777086/chris"}, "edited": false, "score": 0, "creation_date": 1522780305, "post_id": 49636858, "comment_id": 86281409, "body": "@Chris You should be getting the computation time of the loop, that&#39;s where all the work is."}], "tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": false, "score": 2, "last_activity_date": 1522780470, "last_edit_date": 1522780470, "creation_date": 1522780086, "answer_id": 49636858, "question_id": 49636628, "link": "https://stackoverflow.com/questions/49636628/seg-fault-when-trying-to-compute-arithmetic-operation-time-in-c/49636858#49636858", "title": "Seg fault when trying to compute Arithmetic Operation Time in C", "body": "<blockquote>\n<pre><code> //the following line is what was causing the seg fault\n  arr3[i][x] = arr3[i][x] + arr1[i][y] * arr2[y][x];\n</code></pre>\n</blockquote>\n\n<p>That's because you are accessing the arrays using out of bounds indices for all the arrays.</p>\n\n<p>Remove that line. It does not seem to be doing anything useful.</p>\n\n<hr>\n\n<p>Couple more observations.</p>\n\n<ol>\n<li><p>Your computations are likely causing integer overflow since <code>rand()</code> can return anything between <code>[0 - RAND_MAX]</code>. You may want to use a smaller number for the elements of your matrix, such as <code>rand() % 100000</code>.</p></li>\n<li><p>The <code>printf</code> call creates output without any whitespace between elements. You may want to to add a space between the elements. </p>\n\n<pre><code> printf (\"%4d \", arr3[i][x]);\n</code></pre></li>\n</ol>\n"}], "owner": {"reputation": 45, "user_id": 8777086, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/984c585cfd208da7a0e9702d7761cf5a?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/8777086/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1522780857, "creation_date": 1522779085, "last_edit_date": 1522780857, "question_id": 49636628, "link": "https://stackoverflow.com/questions/49636628/seg-fault-when-trying-to-compute-arithmetic-operation-time-in-c", "title": "Seg fault when trying to compute Arithmetic Operation Time in C", "body": "<p>I am writing a program that multiplies two Matrice's and the third Matrix prints the results. Along with that I want to compute the arithmetic operation time that I specified in my code below, however I keep getting a segmentation fault and I believe I am using the time.h/clock() library function correctly. Ive provided a snippet of the section giving me problems.</p>\n\n<pre><code>    /**  Third Matrix  **/ \n    for (i = 0; i &lt; N; i++) {\n        for (x = 0; x &lt; N; x++) {\n            arr3[i][x] = 0;\n            for (y = 0; y &lt; N; y++)\n                arr3[i][x] = arr3[i][x] + arr1[i][y] * arr2[y][x];\n        }\n    }\n\n    arithmeticBegin = clock(); //begins the clock for arithmetic time\n\n    //the following line is what was causing the seg fault\n    arr3[i][x] = arr3[i][x] + arr1[i][y] * arr2[y][x];\n\n    arithmetic_endTime = clock(); //stops the clock for the end of arithmetic time\n    /**  The following computers total arithmetic Time **/\n    arithmeticTime += (double)(arithmetic_endTime - arithmeticBegin) / CLOCKS_PER_SEC;\n</code></pre>\n"}, {"tags": ["c", "malloc", "heap", "glibc", "heap-corruption"], "comments": [{"owner": {"reputation": 79096, "user_id": 865874, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ACMnN.png?s=128&g=1", "display_name": "rodrigo", "link": "https://stackoverflow.com/users/865874/rodrigo"}, "edited": false, "score": 1, "creation_date": 1522779232, "post_id": 49636591, "comment_id": 86280836, "body": "A quick google search hints at <code>per thread cache</code>. I&#39;m guessing that this <code>malloc</code> implementation keeps a smallish pool of preallocated blocks of various sizes for each thread. That way many calls can be satisfied without locks."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1522779540, "post_id": 49636591, "comment_id": 86281001, "body": "Welcome to the world of exploits.  Each exploit has to be tailored to the specific implementation of <code>malloc()</code> \u2014 different implementations have different vulnerabilities and what works for one won&#39;t necessarily work for others."}, {"owner": {"reputation": 22020, "user_id": 194894, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/5e5b6587ba56fcaae86fe5db95248e98?s=128&d=identicon&r=PG", "display_name": "Flow", "link": "https://stackoverflow.com/users/194894/flow"}, "edited": false, "score": 0, "creation_date": 1528808261, "post_id": 49636591, "comment_id": 88640666, "body": "Isn&#39;t the real question why the tool you have used doesn&#39;t detect the double free any more? (Probably because the malloc() was served from tcache)"}, {"owner": {"reputation": 338, "user_id": 7245311, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/A1AsA.png?s=128&g=1", "display_name": "poming", "link": "https://stackoverflow.com/users/7245311/poming"}, "reply_to_user": {"reputation": 22020, "user_id": 194894, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/5e5b6587ba56fcaae86fe5db95248e98?s=128&d=identicon&r=PG", "display_name": "Flow", "link": "https://stackoverflow.com/users/194894/flow"}, "edited": false, "score": 1, "creation_date": 1528832318, "post_id": 49636591, "comment_id": 88654165, "body": "@Flow no, actually I had figured out how tcache exploitation works, in short it discards many security checks since glibc 2.26 (like the case in my question), a lot of exploits become more powerful."}], "owner": {"reputation": 338, "user_id": 7245311, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/A1AsA.png?s=128&g=1", "display_name": "poming", "link": "https://stackoverflow.com/users/7245311/poming"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 4051, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1522779378, "creation_date": 1522778941, "last_edit_date": 1522779378, "question_id": 49636591, "link": "https://stackoverflow.com/questions/49636591/what-is-tcache", "title": "What is TCACHE?", "body": "<p>I'm playing around with binary exploitation on linux for a long time, and recently I'm writing some heap exploitation notes based on <strong>ptmalloc</strong>, so I go back to view some payloads from past security challenges I've solved and astonishingly they didn't work anymore.  </p>\n\n<p>For example, the basic double free corruption (not fastbin)</p>\n\n<pre><code>char *chunk1 = malloc(0xc0);\nfree(chunk1);\nfree(chunk1);\n</code></pre>\n\n<p>I expected to see something like  </p>\n\n<pre><code>*** Error in `main': double free or corruption (top): 0x0000000000c85010 ***  \n</code></pre>\n\n<p>But no, there's nothing happen and the program exit normally.   </p>\n\n<p>For that I go to check the glibc source code corresponding to my machine - <code>Debian GLIBC 2.27-2</code>, and found very difference in <code>malloc.c</code>.  </p>\n\n<pre><code>void *\n__libc_malloc (size_t bytes)\n{     \n...\n#if USE_TCACHE\n  /* int_free also calls request2size, be careful to not pad twice.  */\n  size_t tbytes;\n  checked_request2size (bytes, tbytes);\n  size_t tc_idx = csize2tidx (tbytes);\n\n  MAYBE_INIT_TCACHE ();\n\n  DIAG_PUSH_NEEDS_COMMENT;\n  if (tc_idx &lt; mp_.tcache_bins\n      /*&amp;&amp; tc_idx &lt; TCACHE_MAX_BINS*/ /* to appease gcc */\n      &amp;&amp; tcache\n      &amp;&amp; tcache-&gt;entries[tc_idx] != NULL)\n    {\n      return tcache_get (tc_idx);\n    }\n  DIAG_POP_NEEDS_COMMENT;\n#endif\n</code></pre>\n\n<p>the <code>USE_TCACHE</code> also appears in many other places.  </p>\n\n<p>then I went back my program above and found <code>chunk1</code> was not placed in <code>small bin</code> but in <code>tcache_entry</code>.  </p>\n\n<p>what's the purpose of <code>TCACHE</code> ? I search a lot and still confused.</p>\n"}, {"tags": ["c", "linux", "serial-port"], "comments": [{"owner": {"reputation": 5092, "user_id": 5481471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf6efc50461d3521db348bf483652040?s=128&d=identicon&r=PG&f=1", "display_name": "G. Sliepen", "link": "https://stackoverflow.com/users/5481471/g-sliepen"}, "edited": false, "score": 1, "creation_date": 1522821837, "post_id": 49636520, "comment_id": 86295303, "body": "This might be a duplicate of <a href=\"https://stackoverflow.com/questions/17980725/locking-linux-serial-port\" title=\"locking linux serial port\">stackoverflow.com/questions/17980725/locking-linux-serial-po&zwnj;&#8203;rt</a>"}, {"owner": {"reputation": 1081, "user_id": 468603, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/d863f374f48bdb8cc516e006dc5196f4?s=128&d=identicon&r=PG", "display_name": "Xofo", "link": "https://stackoverflow.com/users/468603/xofo"}, "reply_to_user": {"reputation": 5092, "user_id": 5481471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf6efc50461d3521db348bf483652040?s=128&d=identicon&r=PG&f=1", "display_name": "G. Sliepen", "link": "https://stackoverflow.com/users/5481471/g-sliepen"}, "edited": false, "score": 0, "creation_date": 1522871494, "post_id": 49636520, "comment_id": 86327985, "body": "It looks similar, but does not provide the solution as this is how to check if the port is open. It just provides a way to exclusively lock it."}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 1, "creation_date": 1522908704, "post_id": 49636520, "comment_id": 86340280, "body": "@Xofo: Applications should exclusively lock the port (via the TIOCEXCL ioctl and/or flock()/fcntl() on the open file descriptor) to avoid others being able to open the device and mess with its settings, input, or output. <i>That is the standard solution</i>. To check if the port is in use, you simply try to open it. If you can open it, it is not used by any other application. All other solutions are wrong, because they contain race conditions, or are otherwise unreliable or conflict with e.g. device discovery daemons."}, {"owner": {"reputation": 1081, "user_id": 468603, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/d863f374f48bdb8cc516e006dc5196f4?s=128&d=identicon&r=PG", "display_name": "Xofo", "link": "https://stackoverflow.com/users/468603/xofo"}, "reply_to_user": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 0, "creation_date": 1522963782, "post_id": 49636520, "comment_id": 86375437, "body": "@NominalAnimal - Thank you for your comment. Your comment is a solution. You are saying that your solution is a &quot;best practices&quot; solution. What are the other solutions? I think they merit some discussion. You say TIOCEXCL ioctl AND/OR flock()/fcntl() - Is it safe one or both functions?"}, {"owner": {"reputation": 37211, "user_id": 60075, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/da582d6fbfa2ae515004ef49fcb7c281?s=128&d=identicon&r=PG", "display_name": "Craig McQueen", "link": "https://stackoverflow.com/users/60075/craig-mcqueen"}, "edited": false, "score": 0, "creation_date": 1618886329, "post_id": 49636520, "comment_id": 118732478, "body": "Duplicate of <a href=\"https://stackoverflow.com/questions/30316722/what-is-the-best-practice-for-locking-serial-ports-and-other-devices-in-linux\">What is the best practice for locking serial ports and other devices in Linux? - Stack Overflow</a>"}], "answers": [{"tags": [], "owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "is_accepted": true, "score": 6, "last_activity_date": 1522998385, "creation_date": 1522998385, "answer_id": 49687230, "question_id": 49636520, "link": "https://stackoverflow.com/questions/49636520/how-do-you-check-if-a-serial-port-is-open-in-linux/49687230#49687230", "title": "How do you check if a serial port is open in Linux?", "body": "<p>There are two aspects to the stated question, which really require two different solutions:</p>\n\n<ol>\n<li><p>An application or service daemon using a serial port should exclude other processes from using the port concurrently.</p>\n\n<p>There are two ways of doing this: exclusive mode, and an advisory lock. An application can choose to do one, or both.</p>\n\n<ul>\n<li><p>After opening the device, use <a href=\"http://man7.org/linux/man-pages/man4/tty_ioctl.4.html\" rel=\"noreferrer\"><code>ioctl(fd, TIOCEXCL)</code></a> to put the serial port into exclusive mode. Until the descriptor is closed, or the process issues <code>ioctl(fd, TIOCNXCL)</code>, any attempt to open the device will fail with <code>EBUSY</code> error code.</p></li>\n<li><p>After opening the device, use <a href=\"http://man7.org/linux/man-pages/man2/flock.2.html\" rel=\"noreferrer\"><code>flock(fd, LOCK_EX | LOCK_NB)</code></a> to try and place an exclusive advisory lock on the open device. Other processes can still open the device normally, and even read and write to it, but trying to place an advisory flock lock on it will fail with <code>EWOULDBLOCK</code> (or block until unlocked or closed if placed without <code>LOCK_NB</code>).<br>&nbsp;</p></li>\n</ul>\n\n<p>The difference between the above two approaches is that the latter is co-operative, allowing other processes to open the device; while the former disallows further opens.</p>\n\n<p>The reason to use both, is to detect if another process has already opened the device without putting it into exclusive mode, but has hopefully set the advisory lock. In that case, the open() and ioctl() both succeed, but the flock() fails.</p>\n\n<p>(We can use the second aspect of this question discussed below &mdash; after having opened the device, set it to exclusive mode, and even obtained the exclusive lock on it &mdash;, to detect if other processes have the device open but not exclusive or locked. Personally, I wouldn't bother; I do expect users to only use sane applications on their systems. If they really did that, I'd expect them to have a reason for it, so I'd prefer to allow that oddball scenario. It definitely should not occur with standard utilities.)<br>&nbsp;</p></li>\n<li><p>An application or daemon can use <code>lsof</code> (from the lsof package) to examine if any process has the specified file or device open.</p>\n\n<p>The idea is to run the equivalent of <code>LANG=C LC_ALL=C lsof -F -p DEVICE</code> with root privileges. The output will contain zero or more lines. The lines beginning with <code>p</code> (and immediately followed with the PID and a newline <code>\\n</code>) specify the processes that have <code>DEVICE</code> open. (Each such line is followed by one or more lines starting with <code>f</code>, describing which descriptor in that process refer to the device.)</p>\n\n<p>If the application or daemon does not have root privileges, a helper program that is installed setuid root is needed. It is supplied with one or more device names. The helper program verifies each one is a character device using <code>stat()</code> and <code>S_IFCHR(st_mode)</code> (to avoid the helper being used in security exploits); and if they are, executes the above-mentioned command. In Linux, such helpers are usually installed in <code>/usr/lib/APPLICATION/</code>, where <code>APPLICATION</code> is the name of the application or daemon.</p>\n\n<p>The application or daemon itself can execute the helper via <a href=\"http://man7.org/linux/man-pages/man3/popen.3.html\" rel=\"noreferrer\"><code>popen(\"/path/to/helper 2&gt;/dev/null\", \"r\")</code></a>, and read the input using for example <code>fscanf()</code>. (Remember to use <a href=\"http://man7.org/linux/man-pages/man3/pclose.3.html\" rel=\"noreferrer\"><code>pclose()</code></a> to obtain the status, and use e.g. <a href=\"http://man7.org/linux/man-pages/man2/waitpid.2.html\" rel=\"noreferrer\"><code>(WIFEXITED(status) &amp;&amp; !WEXITSTATUS(status))</code></a> to verify the command was successful.</p>\n\n<p>Note that the helper program approach allows easier portability to other POSIXy systems from Linux, by simply replacing the helper program with one appropriate to the new system. Even if it is not installed as setuid root, it gives system maintainers an easy hook to modify the behaviour of the application or service, if such need arises.  I personally warmly recommend the helper approach.</p></li>\n</ol>\n"}], "owner": {"reputation": 1081, "user_id": 468603, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/d863f374f48bdb8cc516e006dc5196f4?s=128&d=identicon&r=PG", "display_name": "Xofo", "link": "https://stackoverflow.com/users/468603/xofo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5705, "favorite_count": 3, "accepted_answer_id": 49687230, "answer_count": 1, "score": 5, "last_activity_date": 1522998385, "creation_date": 1522778661, "question_id": 49636520, "link": "https://stackoverflow.com/questions/49636520/how-do-you-check-if-a-serial-port-is-open-in-linux", "title": "How do you check if a serial port is open in Linux?", "body": "<p>How does one check if a serial port is already open in Linux using Posix/C functions? I want to check the status of the serial port to check if the serial port is open or not.</p>\n\n<p>I would like to know what methods work for:</p>\n\n<ol>\n<li><p>Checking the <strong>file descriptor</strong> to see if the serial port is open and</p></li>\n<li><p>Checking the <strong>serial port file name</strong> to see if the the serial port is open which in the example below is \"/dev/ttyUSB0\"</p></li>\n</ol>\n\n<p>--</p>\n\n<pre><code>// This code is for example purposes only\n\nint open_port()\n{\n  int fd;\n\n  fd = open(\"/dev/ttyUSB0\", O_RDWR | O_NOCTTY | O_NDELAY);\n  if (fd &lt; 0)\n  {\n    perror(\"open_port: Unable to open /dev/ttyf1 - \");\n  }\n\n  return fd;\n} \n</code></pre>\n\n<p>I imagine there is a \"standard\" way of doing this, and that is what I am trying to get to.</p>\n"}, {"tags": ["c", "file"], "comments": [{"owner": {"reputation": 4966, "user_id": 3605497, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mV6Nc.jpg?s=128&g=1", "display_name": "Tripp Kinetics", "link": "https://stackoverflow.com/users/3605497/tripp-kinetics"}, "edited": false, "score": 0, "creation_date": 1522777743, "post_id": 49636259, "comment_id": 86279988, "body": "Never use a float for a dollar amount."}, {"owner": {"reputation": 1828, "user_id": 2584754, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/Q3gFD.jpg?s=128&g=1", "display_name": "sturcotte06", "link": "https://stackoverflow.com/users/2584754/sturcotte06"}, "edited": false, "score": 0, "creation_date": 1522777847, "post_id": 49636259, "comment_id": 86280040, "body": "Yet another <code>strtok</code> question."}, {"owner": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 2, "creation_date": 1522778508, "post_id": 49636259, "comment_id": 86280402, "body": "with printf you use <code>%f</code> to print out a float, not <code>%d</code>"}], "answers": [{"tags": [], "owner": {"reputation": 1828, "user_id": 2584754, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/Q3gFD.jpg?s=128&g=1", "display_name": "sturcotte06", "link": "https://stackoverflow.com/users/2584754/sturcotte06"}, "is_accepted": true, "score": -1, "last_activity_date": 1522778647, "last_edit_date": 1522778647, "creation_date": 1522778173, "answer_id": 49636394, "question_id": 49636259, "link": "https://stackoverflow.com/questions/49636259/how-to-read-a-variable-found-in-the-middle-of-a-file/49636394#49636394", "title": "How to read a variable found in the middle of a file", "body": "<p>You can use <code>fgets</code> to read a file line by line.</p>\n\n<pre><code>ssize_t read = -1;\n\nsize_t len = 0;\n\nFILE * file = NULL;\n\nfile = fopen(\"file.txt\", \"r\");\n\nif (file == NULL)\n{\n    // handle error\n}\n\nchar line[256];\n\nsize_t line_sz = sizeof(line) - 1;\n\nwhile (fgets(line, line_sz, file) != NULL)\n{\n    char *key = NULL;\n\n    char *value = NULL;\n\n    sscanf(line, \"%s:%s\", &amp;key, &amp;value);\n\n    // handle key and value\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 13, "user_id": 9592583, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Ibpx0aIw4r0/AAAAAAAAAAI/AAAAAAAAADU/DJz1K4y2NrM/photo.jpg?sz=128", "display_name": "Justin Rickman", "link": "https://stackoverflow.com/users/9592583/justin-rickman"}, "edited": false, "score": 0, "creation_date": 1522785241, "post_id": 49636505, "comment_id": 86283923, "body": "@JustinRickman, if you need to extract the name and store in some variable or an element of an array, you will have to write code to take care of that. You may have to pass some arguments to <code>processLine</code> in order to do that. You can also leave that block empty and ignore the line."}], "tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": false, "score": 1, "last_activity_date": 1522778994, "last_edit_date": 1522778994, "creation_date": 1522778620, "answer_id": 49636505, "question_id": 49636259, "link": "https://stackoverflow.com/questions/49636259/how-to-read-a-variable-found-in-the-middle-of-a-file/49636505#49636505", "title": "How to read a variable found in the middle of a file", "body": "<p>The best strategy for dealing with such files is:</p>\n\n<ol>\n<li>Read a line of text.</li>\n<li>Decide how to interpret the contents of the line.</li>\n<li>Repeat until there are no more lines.</li>\n</ol>\n\n<hr>\n\n<pre><code>// Make it as large as you need\n#define LINE_SIZE 200\n\nchar line[LINE_SIZE];\nFILE *fp;\nfp = fopen(query, \"r\");\nif ( fp == NULL )\n{\n   // Deal with error\n   exit(1);\n}\n\nwhile ( fgets(line, LINE_SIZE, fp) != NULL )\n{\n    processLine(line);\n}\n\nfclose(fp);\n</code></pre>\n\n<p>where <code>processLine</code> can be defined as:</p>\n\n<pre><code>void processLine(char* line)\n{\n    char const* nameToken = \"Name:\";\n    char const* addressToken = \"Address:\";\n    char const* ageToken = \"Age:\";\n    char const* telNumToken = \"Tel num:\";\n    char const* balanceToken = \"Balance:\";\n\n    if ( startsWith(line, nameToken) )\n    {\n        // Deal with name\n    }\n\n    else if ( startsWith(line, addressToken) )\n    {\n        // Deal with address\n    }\n\n    else if ( startsWith(line, ageToken) )\n    {\n        // Deal with age\n    }\n\n    else if ( startsWith(line, telNumToken) )\n    {\n        // Deal with tel number\n    }\n\n    else if ( startsWith(line, balanceToken) )\n    {\n        // Deal with balance\n    }\n}\n</code></pre>\n\n<p>and  <code>startsWith</code> can be defined as:</p>\n\n<pre><code>bool startsWith(char* line, char const* token)\n{\n   return (strncmp(line, token, strlen(token)) == 0);\n}\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 9592583, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Ibpx0aIw4r0/AAAAAAAAAAI/AAAAAAAAADU/DJz1K4y2NrM/photo.jpg?sz=128", "display_name": "Justin Rickman", "link": "https://stackoverflow.com/users/9592583/justin-rickman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "closed_date": 1522796786, "accepted_answer_id": 49636394, "answer_count": 2, "score": -2, "last_activity_date": 1523139877, "creation_date": 1522777668, "last_edit_date": 1523139877, "question_id": 49636259, "link": "https://stackoverflow.com/questions/49636259/how-to-read-a-variable-found-in-the-middle-of-a-file", "closed_reason": "Needs more focus", "title": "How to read a variable found in the middle of a file", "body": "<p>So my file has this content: </p>\n\n<pre class=\"lang-none prettyprint-override\"><code>Name: Bob Charles\nAddress: 10 strawberry avenue, port\nAge: 19\nTel num: 2383234\nBalance: $100.00\n</code></pre>\n\n<p>I want to read the balance and store it in a float variable. If I use fseek it will only work for this specific person, as another person may have a different address, balance etc. I've tried to following as a second option: </p>\n\n<pre><code>FILE *fp;\nfp = fopen(query, \"r\");\nfscanf(fp, \"\\n\\n\\n\\n Balance: $%f\", &amp;newBal);    \nfclose(fp);\nprintf(\"bal: %d\", newBal);\n</code></pre>\n\n<p>This prints newBal as 0</p>\n\n<p>Any help is appreciated</p>\n"}, {"tags": ["c", "function", "multidimensional-array"], "comments": [{"owner": {"reputation": 613, "user_id": 3112926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b33809c5d0f78b110e8613c9e5972dd5?s=128&d=identicon&r=PG&f=1", "display_name": "JGroven", "link": "https://stackoverflow.com/users/3112926/jgroven"}, "edited": false, "score": 0, "creation_date": 1522775194, "post_id": 49635521, "comment_id": 86278503, "body": "When you output <code>swap</code> in the second loop, it is always <code>array[arrayHeight-1][0]</code>.  Are you sure that <code>swap</code> is what you want to output here?"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 3, "creation_date": 1522775221, "post_id": 49635521, "comment_id": 86278520, "body": "Welcome to SO. Here is a few advices for writing better questions. 1) Format your code. Use 4 spaces to get a correct indentation. As it is now, it&#39;s unreadable for humans 2) Explain your input. Explain you desired output. Explain your actual output."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1522775271, "post_id": 49635521, "comment_id": 86278545, "body": "OT: What is <code>swap</code> doing in the definition of <code>DisplayArray</code> ?"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1522775357, "post_id": 49635521, "comment_id": 86278600, "body": "Also there is a lot of &quot;commented out code&quot; in the end. Why is that posted?"}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 1, "creation_date": 1522776501, "post_id": 49635521, "comment_id": 86279278, "body": "Welcome to Stack Overflow! It is difficult to offer solutions when the problem statement is simply, <a href=\"http://idownvotedbecau.se/itsnotworking/\" rel=\"nofollow noreferrer\">&quot;it doesn&#39;t work&quot;</a>.  Please <a href=\"https://stackoverflow.com/posts/49635521/edit\">edit</a> your question to give a more complete description of what you expected to happen and how that differs from the actual results.  See <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> for hints on what makes a good explanation."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1522776993, "post_id": 49635521, "comment_id": 86279555, "body": "Please read about how to create an MCVE (<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>)."}, {"owner": {"reputation": 1, "user_id": 9590878, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-P5IZMzCCP6Y/AAAAAAAAAAI/AAAAAAAADkg/F1IXaOmDFHA/photo.jpg?sz=128", "display_name": "Chris G", "link": "https://stackoverflow.com/users/9590878/chris-g"}, "reply_to_user": {"reputation": 613, "user_id": 3112926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b33809c5d0f78b110e8613c9e5972dd5?s=128&d=identicon&r=PG&f=1", "display_name": "JGroven", "link": "https://stackoverflow.com/users/3112926/jgroven"}, "edited": false, "score": 0, "creation_date": 1522777627, "post_id": 49635521, "comment_id": 86279919, "body": "@JGroven Well i am using Swap as a variable to swap over the numbers into Ascending order, that for me is the only way i know. What would you recommend?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9590878, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-P5IZMzCCP6Y/AAAAAAAAAAI/AAAAAAAADkg/F1IXaOmDFHA/photo.jpg?sz=128", "display_name": "Chris G", "link": "https://stackoverflow.com/users/9590878/chris-g"}, "edited": false, "score": 0, "creation_date": 1522778583, "post_id": 49636199, "comment_id": 86280458, "body": "Well that bunch of code is used to calculate and sort out the ascending order which late gets printed out.. i am not sure how else to structure my work"}], "tags": [], "owner": {"reputation": 74, "user_id": 6111379, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iSB7h.jpg?s=128&g=1", "display_name": "nabhiraj jain", "link": "https://stackoverflow.com/users/6111379/nabhiraj-jain"}, "is_accepted": false, "score": 1, "last_activity_date": 1522777455, "creation_date": 1522777455, "answer_id": 49636199, "question_id": 49635521, "link": "https://stackoverflow.com/questions/49635521/functions-not-being-called-in-c/49636199#49636199", "title": "Functions not being Called in C", "body": "<ol>\n<li><p>of all declare the prototype of the function or write the function above the main</p></li>\n<li><p>first call the Bubblesort and then call the DisplayArray function</p></li>\n<li><p>i think the logic of the program is broken here</p>\n\n<pre><code>enter code here\n //this is wrong code logically  !!!!!!!!!\nfor (i = 0; i &lt;arrayHeight ; i++) {\nfor (j = i+1; j &lt; 3; ++j) {\n   if (array[i][0] &gt; array[i][1])  {\n       swap = array[i][0];\n       array[i][0] = array[i][1];\n       array[i][1] = swap;\n    }\n}\n</code></pre>\n\n<p>}</p></li>\n</ol>\n\n<p>the looping done using j but it is not used anywhere in the program i think it is a mistake</p>\n"}], "owner": {"reputation": 1, "user_id": 9590878, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-P5IZMzCCP6Y/AAAAAAAAAAI/AAAAAAAADkg/F1IXaOmDFHA/photo.jpg?sz=128", "display_name": "Chris G", "link": "https://stackoverflow.com/users/9590878/chris-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 0, "closed_date": 1522785079, "answer_count": 1, "score": 0, "last_activity_date": 1522779373, "creation_date": 1522774910, "last_edit_date": 1522779373, "question_id": 49635521, "link": "https://stackoverflow.com/questions/49635521/functions-not-being-called-in-c", "closed_reason": "Not suitable for this site", "title": "Functions not being Called in C", "body": "<p>Hi i am trying to use Functions to output the contents of an array through ascending order but the Function is incorrectly working to my specific outcome, specifically inside the Bubblesort Function Does anyone know why?</p>\n\n<ul>\n<li><p>I have been trying to figure this out for numerous hours, so would be great to get some emphasis.\nThe comments towards the bottom are for the descending order output.\n<a href=\"https://i.stack.imgur.com/X9aGd.jpg\" rel=\"nofollow noreferrer\">current output of Ascending Function</a></p>\n\n<pre><code>int main() \n{\n   int arrayHeight, array[100][2], xCoord, yCoord, i;\n   printf (\"***** Bubble Sort ***** \\n\");\n   printf(\"How many items of data do you wish to enter? \");\n   scanf(\"%d\",&amp;arrayHeight);\n   for(i=0; i&lt;arrayHeight; i++)\n   {\n      printf(\"Please enter in the X coordinate: \");\n      scanf(\"%d\", &amp;xCoord);\n      printf(\"Please enter in the Y coordinate: \");\n      scanf(\"%d\", &amp;yCoord);\n      array[i][0] = xCoord;\n      array[i][1] = yCoord;\n   }\n   DisplayArray(array,arrayHeight);\n   Bubblesort (array, arrayHeight);\n}\n\nint DisplayArray(int array[100][2],int arrayHeight, int swap) \n{\n   /*Displaying Array elements*/\n   int i, j;\n   printf(\"\\n The 2-D Array contains : \\n\");\n   for(i=0; i&lt;arrayHeight; i++)\n   {\n      printf(\"[%d][%d]\\n\\r\", array[i][0], array[i][1]);\n   }\n}  \n\nint BubbleSort(int array[100][2], int arrayHeight) /*Start of the Function Usage*/\n{   \n   /*Sorts the Array elements into appropriate chosen sorting order - Ascending*/\n   int swap, i, j;\n   /*for(k =0; k&lt; arrayHeight; k++) {*/\n      for (i = 0; i &lt;arrayHeight ; i++) {\n         for (j = i+1; j &lt; 3; ++j) {\n            if (array[i][0] &gt; array[i][1])  {\n               swap = array[i][0];\n               array[i][0] = array[i][1];\n               array[i][1] = swap;\n            }\n         }  \n      }\n      (\"\\n Printing in Asending Order: \");\n      for (i=0; i&lt;arrayHeight; i++)\n      {\n         for (j=0; j&lt;arrayHeight; j++)\n         {\n            printf(\"\\n %d \", swap);\n         }\n      }\n   BubbleSort(array, swap);  \n   }\n   for(k =0; k&lt; 2; k++) {/* These lines of code sort out the stored array \nnumber into the appropriate order - Descending\n   for (i = 0; i &lt; 3; i++) {\n      for (j = i+1; j &lt; 3; ++j) {\n         if (a[k][j] &gt; a[k][i])  {\n            int swap = a[k][j];\n            a[k][j] = a[k][i];\n            a[k][i] = swap;\n         }\n      }\n   } \n}   \nprintf(\"\\n Printing in Descending Order: \");\nfor (j=0; j&lt;2; j++)\n{\n    for (i=0; i&lt;3; i++)\n    {\n        printf(\"\\n %d \", a[j][i]);\n        if (i==2)\n        {\n            printf(\"\\n\");\n        }   \n    }\n}\n</code></pre></li>\n</ul>\n"}, {"tags": ["c", "recursion", "assembly", "arm"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1522774410, "post_id": 49635351, "comment_id": 86278048, "body": "Recursive function would need to have <i>some</i> stack usage..."}, {"owner": {"reputation": 15145, "user_id": 4271923, "user_type": "registered", "profile_image": "https://graph.facebook.com/543414580/picture?type=large", "display_name": "Ped7g", "link": "https://stackoverflow.com/users/4271923/ped7g"}, "edited": false, "score": 0, "creation_date": 1522782233, "post_id": 49635351, "comment_id": 86282442, "body": "link register is only one (think of it like global variable in high level language), i.e. the very first subroutine call will exhaust its storage potential. For further subroutine calls you will have to first &quot;empty&quot; it by copying the link register value into some other storage, then calling the subroutine (which will replace the link register value with new one), then restore previous. Because of recursion the possible call-depth is unlimited, so you will need dynamic storage for those linked-register values. Usually &quot;stack memory&quot; concept is used for this kind of tasks, read some tutorial."}, {"owner": {"reputation": 15145, "user_id": 4271923, "user_type": "registered", "profile_image": "https://graph.facebook.com/543414580/picture?type=large", "display_name": "Ped7g", "link": "https://stackoverflow.com/users/4271923/ped7g"}, "edited": false, "score": 0, "creation_date": 1522782572, "post_id": 49635351, "comment_id": 86282635, "body": "And you will have to also store/restore any other register values, which are locally used, so the recursive sub-call will not destroy your current values. With smart rearranging of code you can often minimize the local values which need to be preserved = minimizing the total amount of storage per nested-call, improving the possible limit of maximal depth (which is limited by amount of free stack memory). With <code>power</code> function you don&#39;t need to worry about maximum depth (if <code>n</code> is 32 bit, then 32 is max depth, should fit into stack even if you use it carelessly)."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1522857956, "post_id": 49635351, "comment_id": 86320245, "body": "@EugeneSh. A sane way to implement this would be tail-recursive, which does <i>not</i> require multiple stack frames, and can be done using only caller-saved registers in the default ARM calling convention."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1522859719, "post_id": 49635351, "comment_id": 86321229, "body": "@EOF That would be iterative."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1522869100, "post_id": 49635351, "comment_id": 86326645, "body": "@EugeneSh. If words don&#39;t have any meaning to you, then you can call it iterative."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1522869796, "post_id": 49635351, "comment_id": 86327034, "body": "@EOF Please explain, how a tail recursion (or to be more precise - an optimized tail recursion) is different from loop. It will not perform a self <i>call</i>, it will perform a <i>jump</i> to it&#39;s start. Which is a loop. Tail recursion <i>is</i> a recursion with all of the consequences including the space complexity. It is just such a nice kind of recursion which can be easily optimized to be a loop without this space complexity."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1522869959, "post_id": 49635351, "comment_id": 86327118, "body": "@EugeneSh. Clearly tail-<i>recursion</i> is recursion. It&#39;s part of the name. If it compiles to the same assembly sequence as an iteration statement that does not make it an iteration statement."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1522870212, "post_id": 49635351, "comment_id": 86327260, "body": "@EOF We are not talking here about what the C code is compiling to but about the direct Asm implementation. You are suggesting to implement it as an iteration and call it tail recursion. I think it might be not clear enough what the OP is asking - to have a recursive ASM function or have just some ASM function with the same result."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1522870931, "post_id": 49635351, "comment_id": 86327647, "body": "@EugeneSh. Ok, but if I replace the <code>bx func; bx lr;</code> at the end of my hand-written assembly with <code>b func</code>, I will continue calling the code tail-recursive, because that is what it is."}], "answers": [{"comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1522871754, "post_id": 49644931, "comment_id": 86328157, "body": "<i>Which</i> RISC architecture(s) offer 30 registers? Not SPARC, not MIPS, and certainly not ARM."}, {"owner": {"reputation": 14998, "user_id": 212378, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/185aae2d842026d2eefa7528b00b394b?s=128&d=identicon&r=PG", "display_name": "Alexis Wilke", "link": "https://stackoverflow.com/users/212378/alexis-wilke"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1522880110, "post_id": 49644931, "comment_id": 86332260, "body": "Out of the 32, there are 2 that are used for things that you cannot in any way change, so you are stuck with 30. There are generally 1 or 2 others used for things you can&#39;t change either, but those registers are still somewhat available."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1522905270, "post_id": 49644931, "comment_id": 86338866, "body": "SPARC has a variable number of registers that are available in register windows. MIPS <i>does</i> have 3<b>1</b> GPRs. 32-bit ARM has a whopping <b>15</b> GPRs (some of which are banked for exceptions)."}], "tags": [], "owner": {"reputation": 14998, "user_id": 212378, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/185aae2d842026d2eefa7528b00b394b?s=128&d=identicon&r=PG", "display_name": "Alexis Wilke", "link": "https://stackoverflow.com/users/212378/alexis-wilke"}, "is_accepted": false, "score": -1, "last_activity_date": 1522826044, "creation_date": 1522826044, "answer_id": 49644931, "question_id": 49635351, "link": "https://stackoverflow.com/questions/49635351/arm-assembly-recursive-power-function/49644931#49644931", "title": "ARM assembly recursive power function", "body": "<p>The <code>BL</code> instruction does not automatically push or pop anything from the stack. This saves a memory access. It's the way it works with RISC processors (in part because they offer 30 general purpose registers.)</p>\n\n<pre><code>STR   lr, [sp, #-4]!   ; \"PUSH lr\"\nBL    pow\nLDR   lr, [sp], #4     ; \"POP lr\"\n</code></pre>\n\n<p>If you repeat a <code>BL</code> call, then you want to <code>STR</code>/<code>LDR</code> on the stack outside of the loop.</p>\n"}], "owner": {"reputation": 31, "user_id": 7223218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3395ff8c02e2a6b43c8dab32f15c9a1?s=128&d=identicon&r=PG&f=1", "display_name": "cannerwagon", "link": "https://stackoverflow.com/users/7223218/cannerwagon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1787, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1522826044, "creation_date": 1522774332, "last_edit_date": 1522779998, "question_id": 49635351, "link": "https://stackoverflow.com/questions/49635351/arm-assembly-recursive-power-function", "title": "ARM assembly recursive power function", "body": "<p>Need to convert the following C code into ARM assembly subroutine:</p>\n\n<pre><code> int power(int x, unsigned int n) \n {          \n   int y; \n   if (n == 0)  \n     return 1; \n   if (n &amp; 1) \n     return x * power(x, n - 1); \n   else \n   { y = power(x, n &gt;&gt; 1); \n     return y * y; \n   } \n }     \n</code></pre>\n\n<p>Here's what I have so far but cant figure out how to get the link register to increment after each return (keeps looping back to the same point)</p>\n\n<pre><code>pow             CMP             r0, #0\n                MOVEQ           r0, #1\n                BXEQ            lr\n                TST             r0, #1\n                BEQ             skip\n                SUB             r0, r0, #1\n                BL              pow\n                MUL             r0, r1, r0\n                BX              lr\nskip            LSR             r0, #1\n                BL              pow\n                MUL             r3, r0, r3\n                BX              lr\n</code></pre>\n"}, {"tags": ["c", "header-files"], "comments": [{"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 0, "creation_date": 1522773803, "post_id": 49635140, "comment_id": 86277692, "body": "You way want to read up function/variable declaration and definition."}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 0, "creation_date": 1522773859, "post_id": 49635140, "comment_id": 86277732, "body": "<a href=\"https://stackoverflow.com/questions/1410563/what-is-the-difference-between-a-definition-and-a-declaration\" title=\"what is the difference between a definition and a declaration\">stackoverflow.com/questions/1410563/&hellip;</a>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 2, "creation_date": 1522773944, "post_id": 49635140, "comment_id": 86277783, "body": "Do you know what <b>linking</b> means?"}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1522774005, "post_id": 49635140, "comment_id": 86277830, "body": "If you are writing a large software, you should consider studying -at least for inspiration- the source code of some <a href=\"https://en.wikipedia.org/wiki/Free_software\" rel=\"nofollow noreferrer\">free software</a> -similar in domain or in ambition- to yours. You&#39;ll find many of them, e.g. on <a href=\"http://github.com/\" rel=\"nofollow noreferrer\">github</a>"}, {"owner": {"reputation": 244, "user_id": 9177735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c90311d812036b4debfcf7aa866dec22?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/9177735/ben"}, "edited": false, "score": 0, "creation_date": 1522774080, "post_id": 49635140, "comment_id": 86277869, "body": "<a href=\"https://stackoverflow.com/questions/49542064/does-every-h-file-have-a-corresponding-object-file/49542618#49542618\" title=\"does every h file have a corresponding object file\">stackoverflow.com/questions/49542064/&hellip;</a>"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1522774223, "post_id": 49635140, "comment_id": 86277927, "body": "The header declares what&#39;s available elsewhere. For example, <code>&lt;stdio.h&gt;</code> tells the compiler about the functions etc available from the standard C library for doing I/O operations. The header is used where the functions are defined (to check that the definition matches the declaration), and where the functions are used. Your code will be similar; your <code>main.c</code> code uses the declarations from <code>myfun.h</code>, but you have to supply the implementations when the code is linked. The <code>&lt;stdio.h&gt;</code> header is special; the standard C library is linked automatically. You must link your functions explicitly."}], "answers": [{"tags": [], "owner": {"reputation": 1053, "user_id": 7885081, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CZvVb.png?s=128&g=1", "display_name": "Jose Fernando Lopez Fernandez", "link": "https://stackoverflow.com/users/7885081/jose-fernando-lopez-fernandez"}, "is_accepted": false, "score": 1, "last_activity_date": 1522780874, "last_edit_date": 1522780874, "creation_date": 1522777999, "answer_id": 49636348, "question_id": 49635140, "link": "https://stackoverflow.com/questions/49635140/mechanism-for-including-header-files-in-c-main-body/49636348#49636348", "title": "Mechanism for including header files in C main body", "body": "<p>When you say \"it will search the library for the function details\" you're not far off, but that isn't quite right. A function <i>declaration</i>, i.e.. a function prototype only contains enough information for the compiler to do two things:</p>\n\n<ul>\n<li><p>First, the compiler will register the function as a known identifier so that it knows what you're taking about when you call it, as opposed to a random string of letters with parentheses (to the compiler, they are essentially the same thing without a function prototype for either - an error). </p></li>\n<li><p>Second, the compiler uses the function prototype for checking code correctness. Correctness in this sense means that a function call will match the prototype in both arity and type. In other words a function call to <code>int square(int a, int b);</code> will have two arguments, both integers.</p></li>\n</ul>\n\n<p>The program doesn't \"search the library,\" though. Function names without parentheses are not function calls but rather function's address. Therefore, when you call a function, the processor jumps to the memory location of the function. (<i>This assumes the function has not been inlined.</i>)</p>\n\n<p>Where is this function located though? It depends. If you wrote the function in the same module, i.e... a .c file that got compiled into an object linked with the main.c file into a single executable, then the location of the function will be somewhere in the .TEXT section of the executable. In other words, it's just a slight offset from the main function's entry point. In a huge project this offset won't be so slight, but it will be shorter than the offset of separate objects.</p>\n\n<p>Having said that, if you compiled this hypothetical function into a DLL which you call from your main program, then the function's address will be determined in one of two ways:</p>\n\n<ol>\n<li>Either you will have generated a .lib/.a? (depending on whether you're on Windows or Linux) file containing the function declaration's and addresses, or:</li>\n<li>You will use run-time linking where the main program will calculate the function addresses when it loads the .dll/.so into its address space. First, it will determine where to load it. You can set DLL's to have preferred offsets to optimize load time. Otherwise, libraries will start loading from the first segment available and any additional libraries will need their function address recalculated using this new address, hampering initial load times. Once they are loaded into the program's memory though, there shouldn't be any performance hits thereafter.</li>\n</ol>\n\n<hr />\n\n<p>Going back to the preprocessor, it's important to note two things. First, it runs before any compilation takes place. This is important. Since the program is not really being \"compiled\" when the preprocessor is doing its thing, macros are not type-safe. (<i>Insert Haskell joke about C \"type safety\"</i>) This is why you don't -or shouldn't- see macros in C++. Anything that can be accomplished with macros in C can be accomplished by <code>const</code> and inline functions in C++, with the added benefit of type safety.</p>\n\n<p>Second, the preprocessor is almost just a search and replace engine. For example, in the following code, nothing happens because the preprocessor <code>if</code> statement evaluates to false, since I never defined anything. The preprocessor removes the code in this section. Remember that since the compiler has not run in earnest yet, this removed code will not be compiled. This fact is usually utilized to implement functions for debugging or logging in debug builds. In release builds the preprocessor definition is then manipulated such that the debug code is not included.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main()\n{\n    #if TRUE\n    printf(\"Hello, World!\");\n    #endif\n\nreturn EXIT_SUCCESS;\n}\n</code></pre>\n\n<p>In fact, the <code>EXIT_SUCCESS</code> macro I used is defined in stdlib.h, and replaced by <code>0</code>. (EXIT_FAILURE =1).</p>\n\n<p>Back in the day, the preprocessor was used as duct tape, basically, to compensate for faults in C.</p>\n\n<p>For example, since const values can't be used as array sizes, macros were used instead, like this:</p>\n\n<pre><code>// Not valid C89, possibly even C99\nconst int DEFAULT_BUFFER_SIZE = 128;\nchar user_input[DEFAULT_BUFFER_SIZE]; \n\n// Legal since the dawn of time\n#define DEFAULT_BUFFER_SIZE 128\nchar user_input[DEFAULT_BUFFER_SIZE];\n</code></pre>\n\n<p>Another significant use of the preprocessor was for code portability, for example:</p>\n\n<pre><code>#ifdef WIN32 \n// Do windows things\n#elif\n// Handle other OS\n#endif\n</code></pre>\n\n<p>One trick was to define a generic function and set it to the appropriate OS-dependent one (Remember that functions without the parentheses represent the function's address, not an actual function call), like this:</p>\n\n<pre><code>void RequestSomeKernelAction();\n\n#ifdef WIN32\nRequestSomeKernelAction = WindowsVersion;\n#else\nRequestSomeKernelAction = OtherOSFunction;\n#endif\n</code></pre>\n\n<p>This is all to say that the code you see in header files follows these same rules. If I have the following header file:</p>\n\n<pre><code>#ifndef SRC_INCLUDES_TEST_H\n#define SRC_INCLUDES_TEST_H\n\nint square(int a);\n\n#endif /** SRC_INCLUDES_TEST_H */\n</code></pre>\n\n<p>And I have this main.c file:</p>\n\n<pre><code>#define SRC_INCLUDES_TEST_H\n#include \"test.h\"\n\nint main()\n{\n    int n = square(4);\n}\n</code></pre>\n\n<p>This program will not compile. The square function will not be known to main.c because while I did include the header file where <code>square</code> is declared, my <code>#define SRC_INCLUDES_TEST_H</code> statement tells the preprocessor to copy all the header file contents over to main except those in the block where <code>SRC_INCLUDES_TEST_H</code> is defined, i.e... nothing.</p>\n\n<p>These preprocessor commands can be nested, and there are several, which I highly recommend you look up, if only for historical or pedagogical reasons.</p>\n\n<p>The last point I will make is that while the C preprocessor has its faults, it was a powerful tool in the right hands, and in fact, the first C++ compiler Bjarne Stroustroup wrote was essentially just a  preprocessor.</p>\n"}], "owner": {"reputation": 57, "user_id": 9436858, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/04842621c06bf13ecf1889ae6e57bfb2?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas", "link": "https://stackoverflow.com/users/9436858/thomas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 142, "favorite_count": 1, "answer_count": 1, "score": -2, "last_activity_date": 1522780874, "creation_date": 1522773634, "question_id": 49635140, "link": "https://stackoverflow.com/questions/49635140/mechanism-for-including-header-files-in-c-main-body", "title": "Mechanism for including header files in C main body", "body": "<p>For a large software developed by C, we first declare all the self-defined functions in a separate header file (e.g. <code>myfun.h</code>). After that, once we write a code (e.g. <code>main.c</code>) that uses the functions listed in <code>myfun.h</code>, we have to <code>#include \"myfun.h\"</code>. I'm wondering how it works, because even if I include the function names declared in header file before the main body, the code cannot see the function details in <code>main.c</code>. I guess it will search the library to get the function details...Am I right?</p>\n"}, {"tags": ["c", "linux", "sockets", "tcp"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1522773062, "post_id": 49634924, "comment_id": 86277271, "body": "With the server, did you press enter?"}, {"owner": {"reputation": 845, "user_id": 7632699, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9ad6e931e258bb710bb5f26f8f577466?s=128&d=identicon&r=PG", "display_name": "TsReaper", "link": "https://stackoverflow.com/users/7632699/tsreaper"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1522773475, "post_id": 49634924, "comment_id": 86277512, "body": "Yes. I pressed enter."}], "owner": {"reputation": 845, "user_id": 7632699, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9ad6e931e258bb710bb5f26f8f577466?s=128&d=identicon&r=PG", "display_name": "TsReaper", "link": "https://stackoverflow.com/users/7632699/tsreaper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "closed_date": 1522773065, "answer_count": 0, "score": 0, "last_activity_date": 1522772894, "creation_date": 1522772894, "question_id": 49634924, "link": "https://stackoverflow.com/questions/49634924/why-send-doesnt-trigger-sigpipe-for-a-closed-tcp-connection", "closed_reason": "Duplicate", "title": "Why send() doesn&#39;t trigger SIGPIPE for a closed TCP connection?", "body": "<p>I'm writing a simple server and a simple client based on TCP connection in Linux. I discover that when the server is closed, the first following <code>send()</code> from the client will be successful (and return the bytes send). Only the second following <code>send()</code> from the client will trigger SIGPIPE.</p>\n\n<p>The following code illustrates this phenomenon. After the client is connected to the server, I close the socket of the server, and then let the client send two successive messages to the server. The first <code>send()</code> will be successful, while the second <code>send()</code> will trigger SIGPIPE.</p>\n\n<p>Server code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#include &lt;unistd.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;arpa/inet.h&gt;\n\n#define SERVER_SOCK 32413\n#define LISTEN_BACKLOG 20\n\nint main() {\n    int server_sock, client_sock;\n    struct sockaddr_in server_addr, client_addr;\n    socklen_t client_len = sizeof(client_addr);\n\n    // Create socket\n    server_sock = socket(AF_INET, SOCK_STREAM, 0);\n\n    // Set address and port\n    server_addr.sin_family = AF_INET;\n    server_addr.sin_addr.s_addr = INADDR_ANY;\n    server_addr.sin_port = htons(SERVER_SOCK);\n\n    // Bind to port and begin listening\n    bind(server_sock, (struct sockaddr*) &amp;server_addr, sizeof(server_addr));\n    listen(server_sock, LISTEN_BACKLOG);\n    printf(\"Server is listening\\n\");\n\n    // Accept client socket\n    client_sock = accept(server_sock, (struct sockaddr*) &amp;client_addr, &amp;client_len);\n    printf(\"Connection accepted\\n\");\n\n    // Close all socket after pressing enter\n    printf(\"Press enter to close server\");\n    getchar();\n    close(server_sock);\n    close(client_sock);\n\n    return 0;\n}\n</code></pre>\n\n<p>Client code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#include &lt;unistd.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;arpa/inet.h&gt;\n\n#define SERVER_SOCK 32413\n\nint main() {\n    // Create socket\n    int sock = socket(AF_INET, SOCK_STREAM, 0);\n\n    // Connect to server\n    struct sockaddr_in server_addr;\n    server_addr.sin_family = AF_INET;\n    server_addr.sin_addr.s_addr = inet_addr(\"127.0.0.1\");\n    server_addr.sin_port = htons(SERVER_SOCK);\n    connect(sock, (struct sockaddr*) &amp;server_addr, sizeof(server_addr));\n    printf(\"Connected\\n\");\n\n    // Send message after pressing enter\n    printf(\"Press enter to send message\");\n    getchar();\n    printf(\"1st send: %ld\\n\", send(sock, \"one\", 3, 0));\n    printf(\"2nd send: %ld\\n\", send(sock, \"two\", 3, 0));\n\n    close(sock);\n    return 0;\n}\n</code></pre>\n\n<p>The output of the server is:</p>\n\n<pre><code>Server is listening\nConnection accepted\nPress enter to close server\n</code></pre>\n\n<p>The output of the client is:</p>\n\n<pre><code>Connected\nPress enter to send message\n1st send: 3\n</code></pre>\n\n<p>So what's going on? Why is the first <code>send()</code> successful? Isn't it supposed to trigger SIGPIPE?</p>\n"}, {"tags": ["c", "string"], "comments": [{"owner": {"reputation": 18804, "user_id": 3225, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/cplXg.png?s=128&g=1", "display_name": "kenny", "link": "https://stackoverflow.com/users/3225/kenny"}, "edited": false, "score": 0, "creation_date": 1522772777, "post_id": 49634854, "comment_id": 86277123, "body": "did you mean to print s2?"}, {"owner": {"reputation": 17, "user_id": 8832600, "user_type": "registered", "profile_image": "https://graph.facebook.com/316993225443624/picture?type=large", "display_name": "Siri", "link": "https://stackoverflow.com/users/8832600/siri"}, "reply_to_user": {"reputation": 18804, "user_id": 3225, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/cplXg.png?s=128&g=1", "display_name": "kenny", "link": "https://stackoverflow.com/users/3225/kenny"}, "edited": false, "score": 0, "creation_date": 1522772855, "post_id": 49634854, "comment_id": 86277160, "body": "yes.................."}, {"owner": {"reputation": 78095, "user_id": 2847, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zNdvw.jpg?s=128&g=1", "display_name": "John Boker", "link": "https://stackoverflow.com/users/2847/john-boker"}, "edited": false, "score": 2, "creation_date": 1522772909, "post_id": 49634854, "comment_id": 86277190, "body": "you&#39;ll probably want to use strcpy <a href=\"https://www.tutorialspoint.com/c_standard_library/c_function_strcpy.htm\" rel=\"nofollow noreferrer\">tutorialspoint.com/c_standard_library/c_function_strcpy.htm</a>"}, {"owner": {"reputation": 18804, "user_id": 3225, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/cplXg.png?s=128&g=1", "display_name": "kenny", "link": "https://stackoverflow.com/users/3225/kenny"}, "edited": false, "score": 0, "creation_date": 1522772959, "post_id": 49634854, "comment_id": 86277212, "body": "one thing you need to change is char* str()  you&#39;re currently saying it rturns 1 character. You also need to assign the result to a char* s2; in main() and John Boker has good advice."}, {"owner": {"reputation": 17, "user_id": 8832600, "user_type": "registered", "profile_image": "https://graph.facebook.com/316993225443624/picture?type=large", "display_name": "Siri", "link": "https://stackoverflow.com/users/8832600/siri"}, "edited": false, "score": 0, "creation_date": 1522773571, "post_id": 49634854, "comment_id": 86277566, "body": "tq guys..... :)"}, {"owner": {"reputation": 524, "user_id": 2123477, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/M59hC.jpg?s=128&g=1", "display_name": "woz", "link": "https://stackoverflow.com/users/2123477/woz"}, "edited": false, "score": 0, "creation_date": 1522773743, "post_id": 49634854, "comment_id": 86277672, "body": "also, be careful with <code>scanf</code>. You might consider using <code>fgets</code> as suggested here: <a href=\"https://stackoverflow.com/questions/3302255/c-scanf-vs-gets-vs-fgets/3302594#3302594\" title=\"c scanf vs gets vs fgets\">stackoverflow.com/questions/3302255/c-scanf-vs-gets-vs-fgets&zwnj;&#8203;/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 78095, "user_id": 2847, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zNdvw.jpg?s=128&g=1", "display_name": "John Boker", "link": "https://stackoverflow.com/users/2847/john-boker"}, "is_accepted": false, "score": 0, "last_activity_date": 1522773642, "creation_date": 1522773642, "answer_id": 49635141, "question_id": 49634854, "link": "https://stackoverflow.com/questions/49634854/how-to-return-a-string-by-replacing-with-another-string-in-c/49635141#49635141", "title": "How to return a string by replacing with another string in c", "body": "<p>What you're going to want to do is copy the values of the characters in <code>s1</code> into your <code>s</code> variable. not just set one equal to the other. either using <code>strcpy</code> or looping through your characters in <code>s1</code> and copying them directly to the correct locations in <code>s</code>.</p>\n\n<p><a href=\"https://www.tutorialspoint.com/c_standard_library/c_function_strcpy.htm\" rel=\"nofollow noreferrer\">https://www.tutorialspoint.com/c_standard_library/c_function_strcpy.htm</a></p>\n\n<p>this works for me without using <code>strcpy</code>:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\nvoid str(char *s) {  \n    char s1[100];\n    printf(\"another string to replace:\");\n    scanf(\"%s\",s1);  \n    // not real safe but we know s and s1 have 100 characters.\n    for(int i = 0; i &lt; 100; i++) {\n        s[i] = s1[i];\n    }   \n}\n\nint main() {  \n    char s[100],s2[100];  \n    scanf(\"%s\",s);  \n    str(s);  \n    printf(\"%s\",s);\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "is_accepted": true, "score": 0, "last_activity_date": 1522774382, "last_edit_date": 1522774382, "creation_date": 1522773650, "answer_id": 49635147, "question_id": 49634854, "link": "https://stackoverflow.com/questions/49634854/how-to-return-a-string-by-replacing-with-another-string-in-c/49635147#49635147", "title": "How to return a string by replacing with another string in c", "body": "<p>There a several things to say about your code.</p>\n\n<ol>\n<li><p>You can't copy strings using <code>=</code></p></li>\n<li><p>The return type is wrong. Must be <code>char*</code></p></li>\n<li><p>The <code>scanf</code> format string is wrong. Use <code>%s</code> for strings.</p></li>\n<li><p>You don't need an extra array in the function. Just <code>scanf</code> directly into <code>s</code></p></li>\n<li><p>Never do <code>scanf(\"%s\", ...</code> Always put a limit to it like <code>scanf(\"%99s\", ...</code></p></li>\n</ol>\n\n<p>Something like:</p>\n\n<pre><code>char* str(char *s) {  \n    printf(\"another string to replace:\");\n    scanf(\"%99s\",s);  \n    return s;\n}\n\nvoid main() {  \n    char s[100],s2[100];  \n    scanf(\"%99s\",s);    \n    strcpy(s2, str(s));  \n    printf(\"%s\",s);\n}\n</code></pre>\n\n<p>I am, however, not sure what you want the code to do. As it is now <code>s</code> and <code>s2</code> just end as identical strings.</p>\n\n<p>If you just want a function that can read a new value into <code>s</code> it can be done like:</p>\n\n<pre><code>void str(char *s) {  \n    printf(\"another string to replace:\");\n    scanf(\"%99s\",s);  \n}\n\nvoid main() {  \n    char s[100];  \n    scanf(\"%99s\",s);    \n    str(s);\n    printf(\"%s\",s);\n}\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 8832600, "user_type": "registered", "profile_image": "https://graph.facebook.com/316993225443624/picture?type=large", "display_name": "Siri", "link": "https://stackoverflow.com/users/8832600/siri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 49635147, "answer_count": 2, "score": -2, "last_activity_date": 1522774382, "creation_date": 1522772641, "last_edit_date": 1522772778, "question_id": 49634854, "link": "https://stackoverflow.com/questions/49634854/how-to-return-a-string-by-replacing-with-another-string-in-c", "title": "How to return a string by replacing with another string in c", "body": "<pre><code>#include&lt;stdio.h&gt;\n\nchar str(char *s) {  \n    char s1[100];\n    printf(\"another string to replace:\");\n    scanf(\"%d\",s1);  \n    s=s1;  \n    return s;\n}\n\nvoid main() {  \n    char s[100],s2[100];  \n    scanf(\"%s\",s);  \n    s2=str(s);  \n    printf(\"%s\",s);\n}\n</code></pre>\n\n<p>How to return a string by replacing with another string in c??I'm unable to replace the string using functions</p>\n"}, {"tags": ["c", "arrays", "dynamic-allocation"], "comments": [{"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1522772304, "post_id": 49634681, "comment_id": 86276872, "body": "<code>memset</code> would only work here if <code>sizeof(fruit) == 1</code>, which is not guaranteed at all."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 1, "creation_date": 1522772554, "post_id": 49634681, "comment_id": 86277007, "body": "<code>Smoothie init(size_t n)</code> Hmmm... are you sure that is what you want? I would expect <code>Smoothie* init(size_t n)</code> and just <code>return juice;</code>"}, {"owner": {"reputation": 153, "user_id": 9279884, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-L4zJ4AHCX1E/AAAAAAAAAAI/AAAAAAAAGO8/UmQjO3RADOk/photo.jpg?sz=128", "display_name": "Skyris", "link": "https://stackoverflow.com/users/9279884/skyris"}, "edited": false, "score": 0, "creation_date": 1522772780, "post_id": 49634681, "comment_id": 86277125, "body": "&quot;<code>Smoothie init(size_t n)</code> Hmmm... are you sure that is what you want? I would expect <code>Smoothie* init(size_t n)</code> and just <code>return juice</code>, ? &quot; Yes I am sure. I want the combination, not a pointer to the combination after using the function. (Although I could do it your way, it doesn&#39;t really matter)."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 3, "creation_date": 1522772782, "post_id": 49634681, "comment_id": 86277126, "body": "<code>Smoothie init(size_t n)</code> would be fine if <code>juice</code> was a local variable of type <code>Smoothie</code> instead of type <code>Smoothie *</code>. The current code leaks memory. In other words, replace <code>Smoothie *juice = malloc(sizeof(Smoothie));</code> with <code>Smoothie juice;</code>, replace <code>juice-&gt;tab</code> with <code>juice.tab</code> and replace <code>return *juice;</code> with <code>return juice;</code>."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1522772918, "post_id": 49634681, "comment_id": 86277195, "body": "@Skyris - as Ian Abbott writes: If you use <code>Smoothie init(size_t n)</code> you have a memory leak as the function returns a copy and then the <code>juice</code> pointer is lost. If you actually want to return a <code>Smoothie</code>don&#39;t allocate it dynamic. Just use a local variable."}, {"owner": {"reputation": 153, "user_id": 9279884, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-L4zJ4AHCX1E/AAAAAAAAAAI/AAAAAAAAGO8/UmQjO3RADOk/photo.jpg?sz=128", "display_name": "Skyris", "link": "https://stackoverflow.com/users/9279884/skyris"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1522773147, "post_id": 49634681, "comment_id": 86277334, "body": "@4386427 Ok. Then how am I supposed to only use the local variable ? I don&#39;t get it (Sorry, I&#39;m new to C)"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1522773270, "post_id": 49634681, "comment_id": 86277401, "body": "@Skyris <code>Smoothie* juice = malloc(sizeof(Smoothie));</code> -&gt; <code>Smoothie juice;</code> and <code>return *juice;</code> -&gt; <code>return juice;</code>"}, {"owner": {"reputation": 153, "user_id": 9279884, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-L4zJ4AHCX1E/AAAAAAAAAAI/AAAAAAAAGO8/UmQjO3RADOk/photo.jpg?sz=128", "display_name": "Skyris", "link": "https://stackoverflow.com/users/9279884/skyris"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1522773339, "post_id": 49634681, "comment_id": 86277437, "body": "@4386427 Wait... Actually I have an idea. What if I do this: <code>Smoothie juice;</code> then <code>juice.tab = calloc(n,sizeof(fruit));</code> ?"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1522773432, "post_id": 49634681, "comment_id": 86277482, "body": "@Skyris - yep, that&#39;s it. Correct it shall be <code>juice.tab</code> instead of <code>juice-&gt;tab</code>"}, {"owner": {"reputation": 153, "user_id": 9279884, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-L4zJ4AHCX1E/AAAAAAAAAAI/AAAAAAAAGO8/UmQjO3RADOk/photo.jpg?sz=128", "display_name": "Skyris", "link": "https://stackoverflow.com/users/9279884/skyris"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1522773604, "post_id": 49634681, "comment_id": 86277582, "body": "@4386427 Thank you, I get it. One more question though. Is it really a good idea to return the combination then ? Wouldn&#39;t it be better to return a pointer ? (I guess that&#39;s what you were telling me at first). Because, I will be creating a copy of it. Is that right ?"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 1, "creation_date": 1522774009, "post_id": 49634681, "comment_id": 86277832, "body": "@Skyris It&#39;s fine to return a struct. It is most likely less expensive than calling <code>malloc</code>. You return a pointer when you <code>malloc</code> an array of <code>Smoothie</code> but since you only have one, it&#39;s better just to return it."}], "answers": [{"comments": [{"owner": {"reputation": 153, "user_id": 9279884, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-L4zJ4AHCX1E/AAAAAAAAAAI/AAAAAAAAGO8/UmQjO3RADOk/photo.jpg?sz=128", "display_name": "Skyris", "link": "https://stackoverflow.com/users/9279884/skyris"}, "edited": false, "score": 0, "creation_date": 1522773480, "post_id": 49634773, "comment_id": 86277516, "body": "Just a question though. So let&#39;s say I don&#39;t use the <code>memset()</code>,and now that I have my array initialized at 0 everywhere, how do I make the compiler understand that each 0 is a <code>color</code> and not an <code>int</code> ? Do I have to do some kind of typecasting?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 153, "user_id": 9279884, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-L4zJ4AHCX1E/AAAAAAAAAAI/AAAAAAAAGO8/UmQjO3RADOk/photo.jpg?sz=128", "display_name": "Skyris", "link": "https://stackoverflow.com/users/9279884/skyris"}, "edited": false, "score": 1, "creation_date": 1522773717, "post_id": 49634773, "comment_id": 86277654, "body": "An enum uses an integer type for representation and all bits 0 means <code>0</code> in any integer type, so it&#39;s just the same."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "is_accepted": true, "score": 4, "last_activity_date": 1522772354, "creation_date": 1522772354, "answer_id": 49634773, "question_id": 49634681, "link": "https://stackoverflow.com/questions/49634681/initializing-a-dynamically-allocated-array-with-a-specific-value-in-c/49634773#49634773", "title": "Initializing a dynamically allocated array with a specific value in C", "body": "<blockquote>\n  <p>So, since I want to initialize all the values of my array to <code>APPLE</code>, is it very useful to use <code>memset()</code>?</p>\n</blockquote>\n\n<p>No. <code>memset()</code> fills an area with a <em>byte</em> value. The size of an <code>enum</code> can vary, but it is normally an <code>int</code>, which is larger than a byte. You will fill your memory with something undefined. (Except of course for the enum member with the value <code>0</code>)</p>\n\n<blockquote>\n  <p>How can I be sure that the compiler will understand that the values in my array are <code>fruit</code> variables and not just integers?</p>\n</blockquote>\n\n<p>You already did that by declaring it of type <code>fruit</code>. But it doesn't help much, because the conversion between integer and enum value in C is implicit.</p>\n\n<hr>\n\n<p>All in all, if you need to initialize memory to an enum value other than <code>0</code>, you will need to write a loop. If you indeed want the value corresponding to <code>0</code>, <code>calloc()</code> will do, it doesn't matter as <code>0</code> is still <code>0</code> :)</p>\n"}], "owner": {"reputation": 153, "user_id": 9279884, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-L4zJ4AHCX1E/AAAAAAAAAAI/AAAAAAAAGO8/UmQjO3RADOk/photo.jpg?sz=128", "display_name": "Skyris", "link": "https://stackoverflow.com/users/9279884/skyris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 49634773, "answer_count": 1, "score": 0, "last_activity_date": 1522772625, "creation_date": 1522772037, "last_edit_date": 1522772625, "question_id": 49634681, "link": "https://stackoverflow.com/questions/49634681/initializing-a-dynamically-allocated-array-with-a-specific-value-in-c", "title": "Initializing a dynamically allocated array with a specific value in C", "body": "<p>So, I have dynamically allocated memory for an array and I want initialize all its values to a specific value (which is an element of an enumeration).</p>\n\n<p>Here's what I've done so far:</p>\n\n<pre><code>    typedef enum{APPLE, BANANA, ORANGE} fruit;\n    typedef struct Smoothie Smoothie;\n    struct Smoothie {\n        fruit* tab;\n    };\n</code></pre>\n\n<p>This is all the structures I've defined so far. Now, to create the \"Smoothie\", I do the following:</p>\n\n<pre><code>    Smoothie init(size_t n) {\n         Smoothie* juice = malloc(sizeof(Smoothie));\n         if (juice == NULL) {\n             //error msg in case the allocation has failed.\n         }\n         juice-&gt;tab = calloc(n, sizeof(fruit));\n         if (juice-&gt;tab == NULL) {\n              //error msg in case the allocation has failed.\n         }\n         memset(juice-&gt;tab, APPLE, n*sizeof(fruit));\n         return *juice;\n    }\n</code></pre>\n\n<p>My question is the following. From what I've been able to read on the internet, I know that  <code>calloc()</code> already initializes all the values of the array at 0. In an enumeration, all the elements have a numerical value (by default, my enumeration has the following values: <code>Apple = 0  BANANA = 1  ORANGE  = 2</code>). So, since I want to initialize all the values of my array to <code>APPLE</code>, is it very useful to use <code>memset()</code> ?</p>\n\n<p>In other words, what happens if I do not use <code>memset()</code>? How can I be sure that the compiler will understand that the values in my array are <code>fruit</code> variables and not just integers?</p>\n\n<p>PS: I know that I could use a loop ot initilize my array, but the whole point of this is to actually avoid using the loop.</p>\n"}, {"tags": ["c", "file", "printf"], "comments": [{"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1522771040, "post_id": 49634309, "comment_id": 86276131, "body": "Show some <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. You should read documentation of <a href=\"http://en.cppreference.com/w/c/io/fprintf\" rel=\"nofollow noreferrer\">fprintf</a>, and check against its failure. On the server you probably run your program with different permissions than on your laptop. At last, your question is OS specific."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 5, "creation_date": 1522771229, "post_id": 49634309, "comment_id": 86276270, "body": "Run the program under <code>valgrind</code> on your laptop to rule out memory corruption."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1522771244, "post_id": 49634309, "comment_id": 86276281, "body": "BTW compile your own code with all warnings and debug info (e.g.  <code>gcc -Wall -Wextra -g</code> with <a href=\"http://gcc.gnu.org/\" rel=\"nofollow noreferrer\">GCC</a>...). Then <a href=\"https://sourceware.org/gdb/current/onlinedocs/gdb/\" rel=\"nofollow noreferrer\">use the <code>gdb</code> debugger</a> - even on the server."}, {"owner": {"reputation": 391, "user_id": 7233104, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/si3wu.jpg?s=128&g=1", "display_name": "GRquanti", "link": "https://stackoverflow.com/users/7233104/grquanti"}, "reply_to_user": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1522771283, "post_id": 49634309, "comment_id": 86276308, "body": "@BasileStarynkevitch I don&#39;t know how to produce such an example: in my life fprintf always worked and indeed if I produce a small code which does just a print on a file, it works (also on the server). I&#39;m saying because I tried."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1522771305, "post_id": 49634309, "comment_id": 86276317, "body": "Also change <code>printf(&quot;Impossible to open the fitness data file\\n&quot;);</code> and <code>printf(&quot;Impossible to open the meme data file\\n&quot;);</code> to <code>perror(&quot;Impossible to open the fitness data file&quot;);</code> and <code>perror(&quot;Impossible to open the meme data file&quot;);</code> respectively, so that, if opening the files fails, it tells you <i>why</i> it failed."}, {"owner": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "edited": false, "score": 0, "creation_date": 1522771307, "post_id": 49634309, "comment_id": 86276320, "body": "It&#39;s impossible to tell why it&#39;s not working from the description and code you&#39;ve given ... I suggest writing a minimal verifiable example."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1522771326, "post_id": 49634309, "comment_id": 86276329, "body": "It is most unlinkely <code>fprintf</code> does <b>not</b> work. It is almost definitively that your code is bugged."}, {"owner": {"reputation": 391, "user_id": 7233104, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/si3wu.jpg?s=128&g=1", "display_name": "GRquanti", "link": "https://stackoverflow.com/users/7233104/grquanti"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1522771378, "post_id": 49634309, "comment_id": 86276364, "body": "@Olaf why on the laptop the bug disappear?"}, {"owner": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "edited": false, "score": 0, "creation_date": 1522771476, "post_id": 49634309, "comment_id": 86276422, "body": "It&#39;s hard to speculate why the behavior is different on the laptop ... could be many reasons.  Try removing the stochastic process and just writing pre-defined statistics at the end."}, {"owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "edited": false, "score": 1, "creation_date": 1522771495, "post_id": 49634309, "comment_id": 86276436, "body": "<i>whose code is not interesting for the question&#39;s purposes</i>, it may happen that some overflow in your non interesting code destroys your file handles, so that <code>fprintf</code> doesn&#39;t work... Different machines, different conditions..."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 3, "creation_date": 1522771518, "post_id": 49634309, "comment_id": 86276451, "body": "@DanieleNotarmuzi: I already wrote the reason. Without a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> as requested by others, I&#39;d say you invoke undefined behaviour. We are neither a clairvoyant, nor a debugging service. If you don&#39;t provide the requested information, that&#39;s all. For the future: learn to use your debugger."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1522772206, "post_id": 49634309, "comment_id": 86276813, "body": "If the server is running Linux (very probable) consider also using <a href=\"http://man7.org/linux/man-pages/man1/strace.1.html\" rel=\"nofollow noreferrer\">strace(1)</a>"}, {"owner": {"reputation": 391, "user_id": 7233104, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/si3wu.jpg?s=128&g=1", "display_name": "GRquanti", "link": "https://stackoverflow.com/users/7233104/grquanti"}, "edited": false, "score": 0, "creation_date": 1522772296, "post_id": 49634309, "comment_id": 86276868, "body": "The server is Imac :("}], "answers": [{"tags": [], "owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "is_accepted": false, "score": 4, "last_activity_date": 1522771899, "creation_date": 1522771899, "answer_id": 49634632, "question_id": 49634309, "link": "https://stackoverflow.com/questions/49634309/c-fprintf-does-not-work/49634632#49634632", "title": "C: fprintf does not work", "body": "<p>We can't say for certain what's going on here, because we don't have your full program nor do we have access to the server where the problem happens.  But, we can give you some debugging advice.</p>\n\n<ul>\n<li><p>When a C program behaves differently on one computer than another, the very first thing you should suspect is memory corruption.  The best available tool for finding memory corruption is <a href=\"http://valgrind.org\" rel=\"nofollow noreferrer\"><code>valgrind</code></a>.  Fix the <em>first</em> invalid operation it reports and repeat until it reports no more invalid operations.  There are excellent odds that the problem will have then gone away.</p></li>\n<li><p>Turn up the warning levels as high as they can go and fix all of the complaints, even the ones that look silly.</p></li>\n<li><p>You say you are calling <code>fflush</code> and <code>fclose</code>, but are you checking whether they <em>failed</em>?  Check thoroughly, like this:</p>\n\n<pre><code>if (ferror(ffitness_data) || fflush(ffitness_data) || fclose(ffitness_data)) {\n    perror(\"write error on fitness_data.txt\");\n    exit(1);\n}\n</code></pre></li>\n<li><p>Does the problem go away if you change the optimization level you are compiling with?  If so, you may have a bug that causes \"undefined behavior\".  Unfortunately there are a <em>lot</em> of possible ways to do that and I can't easily explain how to look for them.</p></li>\n<li><p>Use a tool like <a href=\"https://embed.cs.utah.edu/creduce/\" rel=\"nofollow noreferrer\">C-Reduce</a> to cut your program down to a smaller program that still doesn't work correctly but is short enough to post here in its entirety.</p></li>\n<li><p>Read and follow the instructions in the article \"<a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">How to Debug Small Programs</a>\"..</p></li>\n</ul>\n"}], "owner": {"reputation": 391, "user_id": 7233104, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/si3wu.jpg?s=128&g=1", "display_name": "GRquanti", "link": "https://stackoverflow.com/users/7233104/grquanti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 170, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1522771899, "creation_date": 1522770794, "last_edit_date": 1522771040, "question_id": 49634309, "link": "https://stackoverflow.com/questions/49634309/c-fprintf-does-not-work", "title": "C: fprintf does not work", "body": "<p>I have a long C code. At the beginning I open two files and write something on them:  </p>\n\n<pre><code>  ffitness_data = fopen(\"fitness_data.txt\",\"w\");\n  if( ffitness_data == NULL){\n    printf(\"Impossible to open the fitness data file\\n\");\n    exit(1);\n  }else{\n    fprintf(ffitness_data,\"#This file contains all the data that are function of fitness.\\n\");\n    fprintf(ffitness_data,\"#Columns: f,&lt;p&gt;(f),&lt;l&gt;(f).\\n\\n\");\n  }\n  fmeme_data = fopen(\"meme_data.txt\",\"w\");\n  if( fmeme_data == NULL){\n    printf(\"Impossible to open the meme data file\\n\");\n    exit(1);\n  }else{\n    fprintf(fmeme_data,\"#This file contains all the data relative to memes.\\n\");\n    fprintf(fmeme_data,\"#Columns: fitness, popularity, lifetime.\\n\\n\");\n  }  \n</code></pre>\n\n<p>Everything is fine at this step: files are open and two lines are written on them. </p>\n\n<p>Then I have a long simluation of a stochastic process, whose code is not interesting for the question's purposes: the files and their pointers are never used. At the end of the process I have:</p>\n\n<pre><code>for(i=0;i&lt;data;i++){ \n fprintf(fmeme_data,\"%f\\t%d\\t%f\\n\",meme[i].fitness,meme[i].popularity,meme[i].lifetime);\n}\nfor(i=0;i&lt;40;i++){\n fprintf(ffitness_data,\"%f\\t%f\\t%f\\n\",(1.0/40)*(i+0.5),popularity_histo[i],lifetime_histo[i]);\n}\n</code></pre>\n\n<p>Then I DO <code>fflush()</code> and <code>fclose()</code> of both files. </p>\n\n<p>If I make the code run on my laptop, both files are filled. If the code runs on a remote server, the file <code>fitness_data.txt</code> contains only the first print, i.e. the print starting with <code>#</code> but doesn't contain the data. I want you to note that:</p>\n\n<ul>\n<li>The other file never gives me problems.</li>\n<li>I'm used to this server. Something similar never happened.</li>\n</ul>\n\n<p>Given all these information, the question is: </p>\n\n<p><strong>Why it is happening that a certain command, used always in the same way and in the same code, always works on a server while on a different server it works sometime but sometime it doesn't?</strong></p>\n\n<p>Admins: I don't think this question is a duplicate. All similar questions were solved by asjusting the code (<a href=\"https://stackoverflow.com/questions/36878213/fprintf-not-writing-to-file\">here</a>) or adding <code>fflush()</code> (<a href=\"https://stackoverflow.com/questions/14364210/fprintf-not-working\">here</a>) and similar things. Here is not a problem in the code (in my modest opinion) because on my laptop it works. I bet it works on most.</p>\n"}, {"tags": ["c", "visual-studio-2017", "zlib"], "comments": [{"owner": {"reputation": 28528, "user_id": 3780494, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vqia1.jpg?s=128&g=1", "display_name": "Chuck Walbourn", "link": "https://stackoverflow.com/users/3780494/chuck-walbourn"}, "edited": false, "score": 0, "creation_date": 1522770854, "post_id": 49634228, "comment_id": 86276006, "body": "The easiest way to consume zlib for Windows is just use a <a href=\"https://www.nuget.org/packages?q=zlib\" rel=\"nofollow noreferrer\">NuGet package</a>. I personally use <a href=\"https://www.nuget.org/packages/zlib-msvc14-x86/\" rel=\"nofollow noreferrer\">x86</a> or <a href=\"https://www.nuget.org/packages/zlib-msvc14-x64/\" rel=\"nofollow noreferrer\">x64</a> which are compatible with both VS 2015 Update 3 and VS 2017.and use a static library instead of a DLL."}, {"owner": {"reputation": 2244, "user_id": 5520680, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/C1jQH.png?s=128&g=1", "display_name": "Tom&#39;s", "link": "https://stackoverflow.com/users/5520680/toms"}, "reply_to_user": {"reputation": 28528, "user_id": 3780494, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vqia1.jpg?s=128&g=1", "display_name": "Chuck Walbourn", "link": "https://stackoverflow.com/users/3780494/chuck-walbourn"}, "edited": false, "score": 0, "creation_date": 1522835624, "post_id": 49634228, "comment_id": 86303878, "body": "@ChuckWalbourn Thanks ! It seem to have worked for me. If you put your comment into a answer, I will gladly upvote &amp; accept it. So long short story : what I want to do is not trivial at all and using a tierce party is the easiest way. I can&#39;t believe it ... There is surely something that my ignorance keep me from understanting that something as basic should be simple."}], "answers": [{"tags": [], "owner": {"reputation": 28528, "user_id": 3780494, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vqia1.jpg?s=128&g=1", "display_name": "Chuck Walbourn", "link": "https://stackoverflow.com/users/3780494/chuck-walbourn"}, "is_accepted": true, "score": 6, "last_activity_date": 1605818320, "last_edit_date": 1605818320, "creation_date": 1522857327, "answer_id": 49655472, "question_id": 49634228, "link": "https://stackoverflow.com/questions/49634228/how-to-compile-zlib-into-a-dll-on-visual-studio-2017/49655472#49655472", "title": "How to compile zlib into a DLL on Visual Studio 2017?", "body": "<p>Open source projects can be a challenge to build as their support tends to lag well behind the latest versions of Visual Studio. This is one reason why Visual Studio now supports <a href=\"https://blogs.msdn.microsoft.com/vcblog/2016/10/05/cmake-support-in-visual-studio/\" rel=\"nofollow noreferrer\">cmake</a> directly.</p>\n<p>That said, the easiest way to build zlib for Windows is just use a <a href=\"https://www.nuget.org/packages?q=zlib\" rel=\"nofollow noreferrer\">NuGet package</a>. I personally use <a href=\"https://www.nuget.org/packages/zlib-msvc14-x86/\" rel=\"nofollow noreferrer\">zlib-msvc14-x86</a> or <a href=\"https://www.nuget.org/packages/zlib-msvc14-x64/\" rel=\"nofollow noreferrer\">zlib-msvc14-x64</a> which are <a href=\"https://docs.microsoft.com/en-us/cpp/porting/binary-compat-2015-2017\" rel=\"nofollow noreferrer\">binary compatible</a> with VS 2015 Update 3, VS 2017, and VS 2019. They also provide a static library instead of a DLL.</p>\n"}], "owner": {"reputation": 2244, "user_id": 5520680, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/C1jQH.png?s=128&g=1", "display_name": "Tom&#39;s", "link": "https://stackoverflow.com/users/5520680/toms"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5978, "favorite_count": 0, "accepted_answer_id": 49655472, "answer_count": 1, "score": 0, "last_activity_date": 1605818320, "creation_date": 1522770541, "last_edit_date": 1522846941, "question_id": 49634228, "link": "https://stackoverflow.com/questions/49634228/how-to-compile-zlib-into-a-dll-on-visual-studio-2017", "title": "How to compile zlib into a DLL on Visual Studio 2017?", "body": "<p>I have a hard time trying to do something I think is really simple (I must not be the first one to want to do that). I use Visual Studio 2017 on Windows 7 to do some C code, and I need inflate/deflate for zip.</p>\n\n<p>I search a little, and I found <a href=\"https://zlib.net/\" rel=\"nofollow noreferrer\">zlib</a>. It seem to be exactly what I search: free, cool copyright, no patent and extensively used and tested in other project.</p>\n\n<p>So, I start to download the latest version (<a href=\"https://zlib.net/zlib1211.zip\" rel=\"nofollow noreferrer\">zip of 1.2.11</a>) and here I go, trying to \"simply\" get the DLL.</p>\n\n<p>However, the documentation state that in order to compile \"zlib1.dll\", I have to use \"./contrib/vstudio/vc..\", with \"..\" the right Visual Studio. But I have Visual Studio 2017 and there are only \"vc9\" to \"vc14\", \"vc14\" being Visual Studio 2015.</p>\n\n<p>The doc say that I have to use Microsoft Visual C++ 2015, and indeed, when I force open with vs2017, I have integrity error.</p>\n\n<p>So I try to install MVC++ 2015, but then it say that I can't install it because I already have something (VS2017) installed.</p>\n\n<p>Is there really no way to achieve something so basic, or there is knowledge that I don't know?</p>\n"}, {"tags": ["c", "qsort"], "comments": [{"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 1, "creation_date": 1522770371, "post_id": 49634114, "comment_id": 86275698, "body": "&quot;<i>Is there any restriction about the compare function used in qsort()</i>&quot; Did you try reading the documentation of <a href=\"http://en.cppreference.com/w/cpp/algorithm/qsort\" rel=\"nofollow noreferrer\"><code>std::qsort</code></a>?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1522770459, "post_id": 49634114, "comment_id": 86275754, "body": "There&#39;s no reason to declare that function <code>static</code>. That looks like cargo-cult programming where it was used without understanding why."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 2, "creation_date": 1522770813, "post_id": 49634114, "comment_id": 86275982, "body": "@tadman: It might be not understood why, but making functions used in a single compilation unit only <code>static</code> is strongly recommended for not polluting the program&#39;s namestpace. Sometimes good comes from cargo-cult. E.g. Reggae."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1522770937, "post_id": 49634114, "comment_id": 86276058, "body": "@Olaf If this was a complex multi-file application the use would be easily justified, but this is a single file program where it&#39;s completely out of place. I worry people use these things because they saw someone do it once, and then absorb it into some kind of ritual. That later leads to confusion when your function acts strangely."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1522771117, "post_id": 49634114, "comment_id": 86276188, "body": "@tad: Does it cause problems in any way? No! So no harm done. Your argument does not make sense and better had pointed out that an empty parameter list is an obsolescense feature and strongly deprecated. It should be <code>int main(void)</code>."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1522771277, "post_id": 49634114, "comment_id": 86276304, "body": "@Olaf When people do things without understanding why there&#39;s no immediate problems, but down the road they can cause serious trouble. The naive approach is better than one that&#39;s cluttered with poorly understood rituals."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1522771725, "post_id": 49634114, "comment_id": 86276573, "body": "@tadman: 1) This one will not cause trouble without notification. 2) Instead of discouraging it&#39;s usage, one should make sure they understand why it is here 3) We are not a tutoring site; telling people why certain constructs are used (or not) beyond the specific question is off scope on this site. As are such discussions. Feel free to have the last word"}], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 3596491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2bDzo.jpg?s=128&g=1", "display_name": "SolskGaer", "link": "https://stackoverflow.com/users/3596491/solskgaer"}, "edited": false, "score": 0, "creation_date": 1522771676, "post_id": 49634359, "comment_id": 86276543, "body": "But the cmpstr function worked, when treat p1 as char**, I got segment fault. Now I am more confused."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 61, "user_id": 3596491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2bDzo.jpg?s=128&g=1", "display_name": "SolskGaer", "link": "https://stackoverflow.com/users/3596491/solskgaer"}, "edited": false, "score": 0, "creation_date": 1522771953, "post_id": 49634359, "comment_id": 86276692, "body": "@SolskGaer: Either it worked or you get segfault. That&#39;s latter is just one possible outcome for your code invoking undefined behaviour. To deepen your knowledge, learn about it. Also, <code>qsort</code> is well documented; I&#39;d recommed you read it and learn about pointers. Because that&#39;s your problem understanding."}, {"owner": {"reputation": 61, "user_id": 3596491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2bDzo.jpg?s=128&g=1", "display_name": "SolskGaer", "link": "https://stackoverflow.com/users/3596491/solskgaer"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1522772680, "post_id": 49634359, "comment_id": 86277067, "body": "@Olaf Is it correct that as long as cmpstr&#39;s behavior is right, qsort should work properly?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 61, "user_id": 3596491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2bDzo.jpg?s=128&g=1", "display_name": "SolskGaer", "link": "https://stackoverflow.com/users/3596491/solskgaer"}, "edited": false, "score": 0, "creation_date": 1522772843, "post_id": 49634359, "comment_id": 86277152, "body": "@SolskGaer: Are you asking if you write correct code, your program behaves correctly? Yes, that&#39;s the definition of &quot;correct code&quot;."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "reply_to_user": {"reputation": 61, "user_id": 3596491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2bDzo.jpg?s=128&g=1", "display_name": "SolskGaer", "link": "https://stackoverflow.com/users/3596491/solskgaer"}, "edited": false, "score": 1, "creation_date": 1522774449, "post_id": 49634359, "comment_id": 86278073, "body": "@SolskGaer To avoid the segmentation fault, you will need store the &quot;pointer plus length&quot; value in a local variable and pass the address of that variable to the recursive call to <code>cmpstr</code>."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 3, "last_activity_date": 1522803345, "last_edit_date": 1522803345, "creation_date": 1522770942, "answer_id": 49634359, "question_id": 49634114, "link": "https://stackoverflow.com/questions/49634114/is-there-any-restriction-about-the-compare-function-used-in-qsort/49634359#49634359", "title": "Is there any restriction about the compare function used in qsort()", "body": "<p>The comparison function passed to <code>qsort</code> receives the <em>address</em> of the two array elements to compare.  Since each array element is a <code>char *</code>, the address of each of these elements is a <code>char **</code>.  So you're missing one level of indirection.</p>\n\n<p>You need to cast each parameter to a <code>char * const *</code>, then dereference to get the pointer to the string:</p>\n\n<pre><code>int cmpstr(const void* p1p, const void* p2p){\n    char *p1 = *(char * const *)p1p;\n    char *p2 = *(char * const *)p2p;\n    ...\n}\n</code></pre>\n\n<p>EDIT:</p>\n\n<p>Because you want to call this function recursively, you need a non-recursive wrapper function around your recursive function since the parameters they take are not the same:</p>\n\n<pre><code>// internal recursive function that takes two strings\nstatic int cmpstr_int(const char* p1, const char* p2){\n    int p1l = strlen(p1);\n    int p2l = strlen(p2);\n    int r = strncmp(p1, p2, p1l&lt;p2l?p1l:p2l);\n    if(r == 0 &amp;&amp; p1l != p2l){\n        if(p1l &lt; p2l){\n            return cmpstr_int(p1, p2 + p1l);\n        }\n        return cmpstr_int(p1 + p2l, p2);\n    }\n    return r;\n}\n\n// comparison function that extracts desired datatype from void * params\n// and passes them to recursive function\nstatic int cmpstr(const void* p1p, const void* p2p){\n    const char *p1 = *(char * const *)p1p;\n    const char *p2 = *(char * const *)p2p;\n    return cmpstr_int(p1, p2);\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 61, "user_id": 3596491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2bDzo.jpg?s=128&g=1", "display_name": "SolskGaer", "link": "https://stackoverflow.com/users/3596491/solskgaer"}, "edited": false, "score": 0, "creation_date": 1522773702, "post_id": 49634992, "comment_id": 86277640, "body": "Thanks for your answer, but the result I expected is 15 152 936 946 93"}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "reply_to_user": {"reputation": 61, "user_id": 3596491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2bDzo.jpg?s=128&g=1", "display_name": "SolskGaer", "link": "https://stackoverflow.com/users/3596491/solskgaer"}, "edited": false, "score": 0, "creation_date": 1522773883, "post_id": 49634992, "comment_id": 86277748, "body": "Could you edit the question to explain the sorting criterion, as I&#39;ve obviously misunderstood what you&#39;re trying to achieve?  Thanks."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1522773976, "post_id": 49634992, "comment_id": 86277807, "body": "@Toby Oh right. I&#39;m still trying to figure out why OP thinks 93 should be sorted last!"}, {"owner": {"reputation": 61, "user_id": 3596491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2bDzo.jpg?s=128&g=1", "display_name": "SolskGaer", "link": "https://stackoverflow.com/users/3596491/solskgaer"}, "reply_to_user": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1522803330, "post_id": 49634992, "comment_id": 86289909, "body": "@Ian Abbott sorry about the confusion. I was too sleepy last night"}], "tags": [], "owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "is_accepted": true, "score": 2, "last_activity_date": 1522831612, "last_edit_date": 1522831612, "creation_date": 1522773160, "answer_id": 49634992, "question_id": 49634114, "link": "https://stackoverflow.com/questions/49634114/is-there-any-restriction-about-the-compare-function-used-in-qsort/49634992#49634992", "title": "Is there any restriction about the compare function used in qsort()", "body": "<p>Your comparison function receives pointers to the elements of the array.  Each element is a pointer to char, so you'll get a pointer to a pointer to char.</p>\n\n<p>The comparison logic is also somewhat over-complicated; here's a working version:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;string.h&gt;\n#include&lt;stdlib.h&gt;\n\nint cmpstr(const void* a_, const void* b_)\n{\n    const char *const *a = a_;\n    const char *const *b = b_;\n    int la = strlen(*a);\n    int lb = strlen(*b);\n\n    if (la == lb) {\n        /* same length - sort lexicographically */\n        return strcmp(*a, *b);\n    }\n\n    if (la &lt; lb) {\n        /* a is shorter */\n        int result = strncmp(*a, *b, la);\n        if (!result) {\n            /* a is a prefix of b */\n            result = strcmp(*a, *b + la);\n        }\n        return result;\n    }\n\n    /* else, b is shorter - re-enter with arguments swapped,\n       and negate the result */\n    return -cmpstr(b_, a_);\n}\n\nint main() {\n    const char* arrstr[] = {\"93\", \"936\", \"15\", \"152\", \"946\"};\n    const size_t num = sizeof arrstr / sizeof *arrstr;\n    qsort(arrstr, num, sizeof *arrstr, cmpstr);\n    for (size_t i = 0; i &lt; num; i++) {\n        printf(\"%s\\n\", arrstr[i]);\n    }\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>15\n152\n936\n93\n946\n</code></pre>\n\n<p>If you think that my <code>cmpstr()</code> above deviates too far from the original, consider this less intrusively-modified code, which uses the recursive comparison that you intended, with a separate wrapper to adapt it to fit <code>qsort()</code>:</p>\n\n<pre><code>int compare_strings(const char *a, const char *b)\n{\n    int la = strlen(a);\n    int lb = strlen(b);\n    int r = strncmp(a, b, la&lt;lb?la:lb);\n    if (r == 0 &amp;&amp; la != lb) {\n        if (la &lt; lb) {\n            return compare_strings(a, b + la);\n        }\n        return compare_strings(a + lb, b);\n    }\n    return r;\n}\n\nint compare_strings_qsort(const void* a_, const void* b_)\n{\n    const char *const *a = a_;\n    const char *const *b = b_;\n    return compare_strings(*a, *b);\n}\n</code></pre>\n\n<p>I still had to change your variable names, as I find <code>p1l</code> and the like hard to read.  I could simplify a bit further, which I think is clearer than both the original function and my first attempt above (but probably needs some comments):</p>\n\n<pre><code>int compare_strings(const char *a, const char *b)\n{\n    const int la = strlen(a);\n    const int lb = strlen(b);\n    const int r = strncmp(a, b, la&lt;lb?la:lb);\n\n    return (la == lb || r)\n        ? r\n        : (la &lt; lb)\n        ? compare_strings(a, b + la)\n        : compare_strings(a + lb, b);\n}\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 3596491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2bDzo.jpg?s=128&g=1", "display_name": "SolskGaer", "link": "https://stackoverflow.com/users/3596491/solskgaer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 170, "favorite_count": 0, "accepted_answer_id": 49634992, "answer_count": 2, "score": 1, "last_activity_date": 1522831840, "creation_date": 1522770192, "last_edit_date": 1522831840, "question_id": 49634114, "link": "https://stackoverflow.com/questions/49634114/is-there-any-restriction-about-the-compare-function-used-in-qsort", "title": "Is there any restriction about the compare function used in qsort()", "body": "<p>I wrote this code snippet to sort an array of strings into an order that minimises their concatenation:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;string.h&gt;\n#include&lt;stdlib.h&gt;\n\nint cmpstr(const void* p1, const void* p2){\n    int p1l = strlen((const char*)p1);\n    int p2l = strlen((const char*)p2);\n    int r = strncmp((const char*)p1, (const char*)p2, p1l&lt;p2l?p1l:p2l);\n    if(r == 0 &amp;&amp; p1l != p2l){\n        if(p1l &lt; p2l){\n            return cmpstr(p1, (const char*)p2 + p1l);\n        }\n        return cmpstr((const char*)p1 + p2l, p2);\n    }\n    return r;\n}\n\nint main(){\n    const char* arrstr[] = {\"93\", \"936\", \"15\", \"152\", \"946\"};\n    int num = sizeof(arrstr) / sizeof(char*);\n    qsort(arrstr, num, sizeof(char*), cmpstr);\n    for(int i = 0; i &lt; num; i++){\n        printf(\"%s\\n\", arrstr[i]);\n    }\n}\n</code></pre>\n\n<p>These strings should sort in the order <strong><code>15 152 936 93 946</code></strong>.  We want <code>93</code> to be between <code>936</code> and <code>946</code> because <code>936 93</code> &lt; <code>93 936</code> and <code>93 946</code> &lt; <code>946 93</code> (ignoring the spaces added for clarity).</p>\n\n<p>But the code didn't work as expected. The array didn't get sorted at all, although my tests of <code>cmpstr()</code> worked exactly as I expected.</p>\n\n<p>What did I get wrong?</p>\n\n<p>I noticed that when I change the cast part of the <code>cmpstr()</code> from <code>*(char* const*)</code> to <code>(char*)</code>, <code>qsort()</code> doesn't work as well.  Why is that?</p>\n"}, {"tags": ["python", "c", "pointers", "cython", "ctypes"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1522769951, "post_id": 49633964, "comment_id": 86275432, "body": "C does not support pass-by reference. It is <b>strictly</b> pass-by-value. A pointer is not a reference."}], "answers": [{"comments": [{"owner": {"reputation": 131156, "user_id": 235698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KjvlE.png?s=128&g=1", "display_name": "Mark Tolonen", "link": "https://stackoverflow.com/users/235698/mark-tolonen"}, "edited": false, "score": 0, "creation_date": 1522795905, "post_id": 49639175, "comment_id": 86288089, "body": "Your solution is close.  I made some edits.  The type of <code>buf</code> is <code>POINTER(c_uint8)</code>.  What you had was equivalent to <code>(uint8_t*)[10]</code> in C."}], "tags": [], "owner": {"reputation": 73, "user_id": 8126762, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SCJWy.jpg?s=128&g=1", "display_name": "Redherring", "link": "https://stackoverflow.com/users/8126762/redherring"}, "is_accepted": true, "score": 0, "last_activity_date": 1522795903, "last_edit_date": 1522795903, "creation_date": 1522789723, "answer_id": 49639175, "question_id": 49633964, "link": "https://stackoverflow.com/questions/49633964/pass-a-pointer-to-an-array-value-from-cython-to-c/49639175#49639175", "title": "Pass a pointer to an array value from Cython to C", "body": "<p>I'm open to accepting other answers, but for now I thought I would post my solution in the hopes it might help someone else. </p>\n\n<p>I solved it using cytpes and not Cython. <strong>I would really like to see a Cython solution though</strong>. </p>\n\n<pre><code>from ctypes import CDLL, Structure, POINTER, c_uint8, c_uint32, byref\n\nclass Msg(Structure):\n    _fields_ = [(\"id\", c_uint32), (\"buf\", POINTER(c_uint8))]\n\nlib = CDLL('this_example.so')\nget_msg = lib.recv_msg\nget_msg.argtypes = [POINTER(Msg)]\nget_msg.restype = None\n\ndata = (c_uint8 * 8)()\nsample_msg = Msg(1, data)\nget_msg(byref(sample_msg))\nprint sample_msg.id, sample_msg.buf[0]  # Should see changed data\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 8126762, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SCJWy.jpg?s=128&g=1", "display_name": "Redherring", "link": "https://stackoverflow.com/users/8126762/redherring"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 313, "favorite_count": 0, "accepted_answer_id": 49639175, "answer_count": 1, "score": -1, "last_activity_date": 1522795903, "creation_date": 1522769739, "last_edit_date": 1522789818, "question_id": 49633964, "link": "https://stackoverflow.com/questions/49633964/pass-a-pointer-to-an-array-value-from-cython-to-c", "title": "Pass a pointer to an array value from Cython to C", "body": "<p>I have a structure in C that looks like this:</p>\n\n<pre><code>typedef struct {\n    uint32_t id;\n    uint8_t *buf; // pointer to message data\n} msg_t;\n</code></pre>\n\n<p>and some function that receives that a pointer to such structure and modifies it.</p>\n\n<pre><code>void recv_msg( msg_t *msg ) {\n    // Stuff happens to message here\n    return;\n}\n</code></pre>\n\n<p>With cytpes I tried something like this:</p>\n\n<pre><code>from cytpes import CDLL, Structure, POINTER, c_ubyte, c_uint32\n\nclass Msg(Structure):\n    _fields_ = [(\"id\", c_uint32), (\"buf\", POINTER(c_ubyte * 10))]\n\nlib = CDLL(\"this_example.so\")\nget_msg = lib.recv_msg\nget_msg.argtypes = [POINTER(Msg)]\nget_msg.restype = None\n\nsample_data_array = POINTER(c_ubyte * 10)()\ndata = sample_data_array(0, 0, 0, 0, 0, 0, 0, 0, 0, 0)\nsample_msg = Msg(1, data)\nget_msg(sample_msg)\nprint sample_msg.id, sample_msg.buf[0]  # Should change data\n</code></pre>\n\n<p>I'm getting a TypeError('expected LP_c_ubyte_Array_10 instance, got list',)</p>\n\n<p>I've also tried a similar approach using Cython:</p>\n\n<pre><code>from libc.stdint cimport uint8_t, uint32_t\n\ncdef extern from \"this_example.h\":\n    ctypedef struct msg_t:\n        uint32_t id;\n        uint8_t *buf;\n\n    void get_msg (msg_t *)\n\ndef recv_msg():\n    # How I would do this I don't know\n    print msg.id, msg.buf[0]\n</code></pre>\n\n<p>I should also add, I don't want use numpy (but would reluctantly if I have to). Also, the length of the data array can vary, but I also have a length variable in the msg structure, so I can initialise it to the right length for sending, and just set it to default values and max length for receiving. </p>\n\n<p>Any clues? Thanks!</p>\n"}]