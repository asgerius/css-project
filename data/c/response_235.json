[{"tags": ["c++", "c", "pointers", "video", "ffmpeg"], "comments": [{"owner": {"reputation": 61761, "user_id": 5726027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a15e6b3536ef969cf3a9828a0542aac2?s=128&d=identicon&r=PG", "display_name": "Gyan", "link": "https://stackoverflow.com/users/5726027/gyan"}, "edited": false, "score": 2, "creation_date": 1562820831, "post_id": 56980003, "comment_id": 100499033, "body": "See metadata.c example."}, {"owner": {"reputation": 3341, "user_id": 3204706, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/GIk0b.jpg?s=128&g=1", "display_name": "Tina J", "link": "https://stackoverflow.com/users/3204706/tina-j"}, "reply_to_user": {"reputation": 61761, "user_id": 5726027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a15e6b3536ef969cf3a9828a0542aac2?s=128&d=identicon&r=PG", "display_name": "Gyan", "link": "https://stackoverflow.com/users/5726027/gyan"}, "edited": false, "score": 0, "creation_date": 1562857250, "post_id": 56980003, "comment_id": 100518797, "body": "@Gyan Thanks. Yes <code>av_dict_get(frame-&gt;metadata, &quot;myfreezekey&quot;, tag, 0)</code> was a life saver! But I see the filter metadata <code>[freezedetect @ 0x25b91c0] lavfi.freezedetect.freeze_start: 5.005</code> is also printed by default! Any ways to disable that?"}, {"owner": {"reputation": 61761, "user_id": 5726027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a15e6b3536ef969cf3a9828a0542aac2?s=128&d=identicon&r=PG", "display_name": "Gyan", "link": "https://stackoverflow.com/users/5726027/gyan"}, "edited": false, "score": 1, "creation_date": 1562858959, "post_id": 56980003, "comment_id": 100519798, "body": "No, that&#39;s supplied by the filter and formatted by av_log"}, {"owner": {"reputation": 3341, "user_id": 3204706, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/GIk0b.jpg?s=128&g=1", "display_name": "Tina J", "link": "https://stackoverflow.com/users/3204706/tina-j"}, "reply_to_user": {"reputation": 61761, "user_id": 5726027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a15e6b3536ef969cf3a9828a0542aac2?s=128&d=identicon&r=PG", "display_name": "Gyan", "link": "https://stackoverflow.com/users/5726027/gyan"}, "edited": false, "score": 0, "creation_date": 1562861920, "post_id": 56980003, "comment_id": 100521322, "body": "@Gyan Got it. It&#39;s weird. I remove <code>av_log</code> in the <code>set_meta</code> function of the filter C file. And make. But still see the same logs printed. Shouldn&#39;t it work?"}], "owner": {"reputation": 3341, "user_id": 3204706, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/GIk0b.jpg?s=128&g=1", "display_name": "Tina J", "link": "https://stackoverflow.com/users/3204706/tina-j"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 184, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1562820652, "creation_date": 1562802896, "last_edit_date": 1562820652, "question_id": 56980003, "link": "https://stackoverflow.com/questions/56980003/problems-in-my-sample-c-code-using-ffmpeg-api", "title": "Problems in my sample C code using FFmpeg API", "body": "<p>I've been trying to change an FFmpeg's example code <a href=\"https://github.com/FFmpeg/FFmpeg/blob/master/doc/examples/filtering_video.c\" rel=\"nofollow noreferrer\">HERE</a> to call <strong>other</strong> filters using its C APIs. Say the filter be <code>freezedetect=n=-60dB:d=8</code> which normally runs like this:</p>\n\n<pre><code>ffmpeg -i small.mp4 -vf \"freezedetect=n=-60dB:d=8\" -map 0:v:0 -f null -\n</code></pre>\n\n<p>And prints outputs like this:</p>\n\n<pre><code>[freezedetect @ 0x25b91c0] lavfi.freezedetect.freeze_start: 5.005\n[freezedetect @ 0x25b91c0] lavfi.freezedetect.freeze_duration: 2.03537\n[freezedetect @ 0x25b91c0] lavfi.freezedetect.freeze_end: 7.04037\n</code></pre>\n\n<p>However, the original example displays frames, not these metadata information. How can I change the code to print this metadata information (and not the frames)? </p>\n\n<p>I've been trying to change the <code>display_frame</code> function below into a <code>display_metadata</code> function. Looks like the <code>frame</code> variable has a <code>metadata</code> dictionary which looks promising, but my attempts failed to use it. I'm also new to C language.</p>\n\n<p>Original <code>display_frame</code> function:</p>\n\n<pre><code>static void display_frame(const AVFrame *frame, AVRational time_base)\n{\n    int x, y;\n    uint8_t *p0, *p;\n    int64_t delay;\n\n    if (frame-&gt;pts != AV_NOPTS_VALUE) {\n        if (last_pts != AV_NOPTS_VALUE) {\n            /* sleep roughly the right amount of time;\n             * usleep is in microseconds, just like AV_TIME_BASE. */\n            delay = av_rescale_q(frame-&gt;pts - last_pts,\n                                 time_base, AV_TIME_BASE_Q);\n            if (delay &gt; 0 &amp;&amp; delay &lt; 1000000)\n                usleep(delay);\n        }\n        last_pts = frame-&gt;pts;\n    }\n\n    /* Trivial ASCII grayscale display. */\n    p0 = frame-&gt;data[0];\n    puts(\"\\033c\");\n    for (y = 0; y &lt; frame-&gt;height; y++) {\n        p = p0;\n        for (x = 0; x &lt; frame-&gt;width; x++)\n            putchar(\" .-+#\"[*(p++) / 52]);\n        putchar('\\n');\n        p0 += frame-&gt;linesize[0];\n    }\n    fflush(stdout);\n}\n</code></pre>\n\n<p>My new <code>display_metadata</code> function that needs to be completed:</p>\n\n<pre><code>static void display_metadata(const AVFrame *frame)\n{\n\n//    printf(\"%d\\n\",frame-&gt;height);\n\n    AVDictionary* dic = frame-&gt;metadata;\n\n    printf(\"%d\\n\",*(dic-&gt;count));\n\n//    fflush(stdout);\n} \n</code></pre>\n"}, {"tags": ["c"], "answers": [{"tags": [], "owner": {"reputation": 79, "user_id": 10616174, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82f94a59a724570eba9271e2d877ac07?s=128&d=identicon&r=PG&f=1", "display_name": "adeishs", "link": "https://stackoverflow.com/users/10616174/adeishs"}, "is_accepted": false, "score": 0, "last_activity_date": 1562805637, "creation_date": 1562805637, "answer_id": 56980252, "question_id": 56979957, "link": "https://stackoverflow.com/questions/56979957/how-can-i-end-a-loop-once-each-row-and-column-in-a-3x3-tic-tac-toe-board-is-fill/56980252#56980252", "title": "How can I end a loop once each row and column in a 3x3 tic tac toe board is filled with X&#39;s and O&#39;s?", "body": "<p>You have an off-by-one problem.</p>\n\n<p>Let\u2019s deskcheck it:</p>\n\n<p>When the <code>do</code> block starts, <code>count</code> is 0. At the end of the block, it\u2019s 1. Is <code>1 == 10</code>? Nope. Next.</p>\n\n<p><code>count</code> is 1. At the end, it\u2019s 2. Is <code>2 == 10</code>? Nope. Next.</p>\n\n<p><code>count</code> is 2. At the end, it\u2019s 3. Is <code>3 == 10</code>? Nope. Next.</p>\n\n<p>etc. until:</p>\n\n<p><code>count</code> is 9. At the end, it\u2019s 10. Is <code>10 == 10</code>? Yes. Out.</p>\n\n<p>Let\u2019s count how many times you\u2019re inside the block: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9. It\u2019s 10.</p>\n\n<p>So, 10 is one too many. You know the fix.</p>\n"}, {"tags": [], "owner": {"reputation": 4332, "user_id": 1517244, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/69e56ba57db6774aa70eca1d8d5684aa?s=128&d=identicon&r=PG", "display_name": "Jimbo", "link": "https://stackoverflow.com/users/1517244/jimbo"}, "is_accepted": false, "score": 0, "last_activity_date": 1562809426, "last_edit_date": 1562809426, "creation_date": 1562808014, "answer_id": 56980483, "question_id": 56979957, "link": "https://stackoverflow.com/questions/56979957/how-can-i-end-a-loop-once-each-row-and-column-in-a-3x3-tic-tac-toe-board-is-fill/56980483#56980483", "title": "How can I end a loop once each row and column in a 3x3 tic tac toe board is filled with X&#39;s and O&#39;s?", "body": "<p>The answer from adeishs contains the solution to your problem. I just wanted to, if I may, make a few observations that may be helpful.</p>\n\n<h2>Use of <code>goto</code></h2>\n\n<p>First is the use of the <code>goto</code> keyword. It is generally considered bad practice to use it on a loop in the way that you have. You would be better off not using it, and using another conditional structure. For example (<a href=\"https://ideone.com/xM15y8\" rel=\"nofollow noreferrer\"><strong><em>see here</em></strong></a>),</p>\n\n<pre><code>// See it in action here https://ideone.com/xM15y8\ndo\n{\n    printf(\"Enter the number of the cell y....\");\n    scanf(\"%d\", &amp;position);\n    const bool input_is_valid = (position == -1) || ((position &gt; 0) &amp;&amp; (position &lt; 10));\n    if (input_is_valid)\n        break;\n    printf(\"\\nInput invalid, try again\\n\"); \n} while(true);\n</code></pre>\n\n<p>I have added a check for the input of a zero as this is also an invalid input to your program, as far as I can see.</p>\n\n<h2>Use of <code>scanf()</code></h2>\n\n<p>There is a further improvement you could make too. There is a problem with <code>scanf()</code>... the standard says this:</p>\n\n<blockquote>\n  <blockquote>\n    <p>...the result of the conversion is placed in the object pointed to by the first argument following the format argument that has not already received a conversion result. If this object does not have an appropriate type, or if the result of the conversion cannot be represented in the object, the behaviour is undefined...</p>\n  </blockquote>\n</blockquote>\n\n<p>So if a user were to type something like 8589934592, although they'd clearly be rather silly to, the is no telling what the variable <code>position</code> may hold as the value entered cannot be represented by an <code>int</code> because it is too large. A safer way might be to use <code>fgets()</code> to read stdin into a small buffer and then use <code>strtol()</code> to parse the input.</p>\n\n<h2>Board Size Is Restricted</h2>\n\n<p>One other limitation of the function <code>CreateBoard()</code> is that is accepts a board of any dimension, but the function only allows positions 1 - 9 to be input. The <code>switch</code> statement can't do anything more than this. You could deal with this in two ways.</p>\n\n<p>The row index into your board is integer division of <code>zero_indexed_position/num_cols</code>. This translates to <code>(position - 1) / n</code>.</p>\n\n<p>The column index is the remainder of the above - <code>(position - 1) % n</code>.</p>\n\n<p>So we could write, intead of the <code>switch</code> (<a href=\"https://ideone.com/L30oHE\" rel=\"nofollow noreferrer\"><strong><em>tested here</em></strong></a> ),</p>\n\n<pre><code>const int row = (position - 1) / n;\nconst int col = (position - 1) % n;\nscanf(\" %c\", &amp;board[row][col]);\n</code></pre>\n\n<p>The other way would be to index the board using <code>*((int *)board + (position -1))</code>, taking advantage of how the array is laid out in memory.</p>\n"}], "owner": {"reputation": 1, "user_id": 10942427, "user_type": "registered", "profile_image": "https://graph.facebook.com/1569921146485760/picture?type=large", "display_name": "Asad Jawaid", "link": "https://stackoverflow.com/users/10942427/asad-jawaid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1562809426, "creation_date": 1562802485, "last_edit_date": 1562803690, "question_id": 56979957, "link": "https://stackoverflow.com/questions/56979957/how-can-i-end-a-loop-once-each-row-and-column-in-a-3x3-tic-tac-toe-board-is-fill", "title": "How can I end a loop once each row and column in a 3x3 tic tac toe board is filled with X&#39;s and O&#39;s?", "body": "<p>So I ask the user to enter X's and O's after the tic tac toe board is completely filled with X's and O's I want the program to end and not continue asking to input values into the board after they already been filled. So I made an integer variable count and set it to 0. After each time both players get asked to enter an either X or O, I want it to increment each round and once count is equal to 10 I want the entire it to break out of the do while loop and end the function. But this seems to not work and keeps asking the user to enter X's and O's. Any suggestions would be helpful, thanks. </p>\n\n<pre><code>void CreateBoard(int m, int n, char board[][n])\n{\n    int i, j, position;\n    int count = 0;\n    do {\n        SCAN:\n        printf(\"Enter the number of the cell you want to insert X or O or enter -1 to exit: \\n\");\n        scanf(\"%d\", &amp;position);\n\n        if(position &lt; 0){\n            break;\n        }\n        if(position &gt; 9){\n            goto SCAN;\n        }\n\n        printf(\"Type X or O: \\n\");\n\n        switch(position)\n        {\n            case 1: scanf(\" %c\", &amp;board[0][0]); break;\n            case 2: scanf(\" %c\", &amp;board[0][1]); break;\n            case 3: scanf(\" %c\", &amp;board[0][2]); break;\n            case 4: scanf(\" %c\", &amp;board[1][0]); break;\n            case 5: scanf(\" %c\", &amp;board[1][1]); break;\n            case 6: scanf(\" %c\", &amp;board[1][2]); break;\n            case 7: scanf(\" %c\", &amp;board[2][0]); break;\n            case 8: scanf(\" %c\", &amp;board[2][1]); break;\n            case 9: scanf(\" %c\", &amp;board[2][2]); break;\n        }\n\n        for (int i = 0; i &lt; m; i++)\n        {\n            for (int j = 0; j &lt; n; j++)\n            {\n            printf(\"%c \", board[i][j]);\n            if (j != 2)\n                printf(\" | \");\n            }      \n            if (i != 2)\n                printf(\"\\n------------\");\n            printf(\"\\n\");\n        }\n\n        count++;\n\n        if(count == 10){\n            break;\n        }\n    }while(position != -1);\n\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 27279, "user_id": 857132, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4fd51ed5980999c7c6ce3729d6cb2184?s=128&d=identicon&r=PG", "display_name": "John3136", "link": "https://stackoverflow.com/users/857132/john3136"}, "edited": false, "score": 4, "creation_date": 1562802545, "post_id": 56979885, "comment_id": 100495664, "body": "<code>if (&amp;sex == &quot;m&quot;) {</code> Should be <code>if (sex == &#39;m&#39;) {</code> - you are comparing characters not strings (and even if you wanted to compare strings, what you have is not how to do it ;-)"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 27279, "user_id": 857132, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4fd51ed5980999c7c6ce3729d6cb2184?s=128&d=identicon&r=PG", "display_name": "John3136", "link": "https://stackoverflow.com/users/857132/john3136"}, "edited": false, "score": 0, "creation_date": 1562803074, "post_id": 56979885, "comment_id": 100495761, "body": "@John3136: Right. <code>if (&amp;sex == &quot;m&quot;)</code> actually compares <i>addresses</i>, not strings. It tests whether the array corresponding to the string literal <code>&quot;m&quot;</code> has the same address as the <code>char</code> object <code>sex</code>. It doesn&#39;t."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1562803512, "post_id": 56979885, "comment_id": 100495860, "body": "<code>int mat[2][2] = { NULL };</code> should be <code>int mat[2][2] = {{0}};</code> You initialize each element to a <code>int</code> value (by initializing the first value to <code>0</code> and the remaining values are initialized to zero by default), not the pointer value <code>NULL</code>. This will allow you to print all elements. Also <b>note:</b> if your next attempted read is with <code>&quot;%c&quot;</code> (or <code>&quot;%[...]&quot;</code>) you will read the <code>&#39;\\n&#39;</code> you have left in your input buffer (<code>stdin</code>). For reading a single-char from <code>stdin</code>, <code>getchar()</code> is proper. (note the return type)."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1562803593, "post_id": 56979885, "comment_id": 100495879, "body": "You are, for some strange reason, comparing the addresses of characters with string constants."}, {"owner": {"reputation": 5760, "user_id": 1863564, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/XU4XS.png?s=128&g=1", "display_name": "Fund Monica&#39;s Lawsuit", "link": "https://stackoverflow.com/users/1863564/fund-monicas-lawsuit"}, "reply_to_user": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1562805837, "post_id": 56979885, "comment_id": 100496290, "body": "@DavidSchwartz Presumably because the compiler complained about <code>sex == &quot;m&quot;</code>."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "reply_to_user": {"reputation": 5760, "user_id": 1863564, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/XU4XS.png?s=128&g=1", "display_name": "Fund Monica&#39;s Lawsuit", "link": "https://stackoverflow.com/users/1863564/fund-monicas-lawsuit"}, "edited": false, "score": 0, "creation_date": 1562808342, "post_id": 56979885, "comment_id": 100496716, "body": "@NicHartley Hence the rule that if you make any changes you don&#39;t understand, you must revert them before asking for help."}], "answers": [{"tags": [], "owner": {"reputation": 16020, "user_id": 9716597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f97c613dca0b157b40551a0d756abeb?s=128&d=identicon&r=PG&f=1", "display_name": "L. F.", "link": "https://stackoverflow.com/users/9716597/l-f"}, "is_accepted": false, "score": 0, "last_activity_date": 1562803267, "creation_date": 1562803267, "answer_id": 56980043, "question_id": 56979885, "link": "https://stackoverflow.com/questions/56979885/how-to-insert-int-values-into-matrix-by-using-if-statement-with-char-conditionin/56980043#56980043", "title": "How to insert int values into matrix by using if statement with char conditioning?", "body": "<p><code>&amp;sex == \"m\"</code> compares the address of <code>sex</code> with the address of the string literal <code>\"m\"</code>, which will presumably evaluate to false.  This is not what you want.</p>\n\n<p>You should compare the value of <code>sex</code> with the <em>character</em> literal <code>'m'</code>, as in:</p>\n\n<pre><code>if (&amp;sex == \"m\") {\n    // ...\n}\n</code></pre>\n\n<p>The same goes for <code>&amp;sex == \"f\"</code>, which should be <code>sex == 'f'</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1562804057, "post_id": 56980088, "comment_id": 100495969, "body": "<code>int mat[2][2] = {{0}};</code> will suffice. You should always check the return of <code>scanf</code> to protect against the (1) user canceling input with a manual <code>EOF</code>, (2) a <i>matching-failure</i> (not relevant to <code>&quot;%c&quot;</code>) or (3) an <i>input-failure</i>. A <code>switch</code> does work nicely there. (some with quibble that a <code>break;</code> is proper even in the <code>default</code> case -- even though case-fallthough isn&#39;t possible as the last expression)"}], "tags": [], "owner": {"reputation": 366, "user_id": 8366717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yY4lP.png?s=128&g=1", "display_name": "Jango", "link": "https://stackoverflow.com/users/8366717/jango"}, "is_accepted": true, "score": 1, "last_activity_date": 1596809129, "last_edit_date": 1596809129, "creation_date": 1562803744, "answer_id": 56980088, "question_id": 56979885, "link": "https://stackoverflow.com/questions/56979885/how-to-insert-int-values-into-matrix-by-using-if-statement-with-char-conditionin/56980088#56980088", "title": "How to insert int values into matrix by using if statement with char conditioning?", "body": "<p>In C, operator == cannot be used to compare strings. To do so, you should use the function <em>strcmp</em> from <em>string.h</em>. In any case, what you need is not to compare strings, but to compare characters (and what you are doing is to compare an address with a string). My suggestion: scan a char instead of a string (using <em>scanf</em> instead of <em>scanf_s</em>) and change your equality tests from <em>&amp;var == &quot;val&quot;</em> to <em>var == 'val'</em>. Also some tips in the code below:</p>\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n\nint main()\n{\n    //name your variables properly\n    //initialize them immediately to avoid undefined values\n    //respect its types: use '\\0' instead of 0 for chars, and 0 instead of NULL for ints\n\n    char gender = '\\0';\n    int matrix[2][2] = {{0, 0}, {0, 0}};\n    \n    //display accurate messages to the user\n    \n    printf(&quot;Select a gender (m or f): &quot;);\n    \n    //don't scan a string if you only need a char\n    //always check the return of a scan\n    \n    if(scanf(&quot;%c&quot;, &amp;gender) &lt;= 0)\n    {\n         printf(&quot;Input error\\n&quot;);\n         return 0;\n    }\n    \n    //switch is usually more efficient than else-ifs\n    \n    switch(gender)\n    {\n        case 'm':\n            matrix[0][0] = 1;\n            break;\n        \n        case 'f':\n            matrix[0][0] = 2;\n            break;\n        \n        default:\n            printf(&quot;Invalid gender\\n&quot;);\n            return 0;\n    }\n    \n    printf(&quot;Selected gender: %c\\n&quot;, gender);\n    printf(&quot;Value on matrix[0][0]: %d\\n&quot;, matrix[0][0]);\n    \n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 11580143, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-8HWlzFFN1cg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf7HMHua-VmqON7ui_MXnsEiH8LhA/mo/photo.jpg?sz=128", "display_name": "Jo&#227;o Carlos", "link": "https://stackoverflow.com/users/11580143/jo%c3%a3o-carlos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 56980088, "answer_count": 2, "score": 1, "last_activity_date": 1596809129, "creation_date": 1562801904, "last_edit_date": 1562803121, "question_id": 56979885, "link": "https://stackoverflow.com/questions/56979885/how-to-insert-int-values-into-matrix-by-using-if-statement-with-char-conditionin", "title": "How to insert int values into matrix by using if statement with char conditioning?", "body": "<p>I'm learning C and I'm having trouble with this situation where I need to put values inside a matrix based on user char input, here is the code:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n\nint main() {\n\n    int mat[2][2] = { NULL };\n    char sex;\n\n    printf(\"Insert gender (m or f):\");\n    scanf_s(\"%c\", &amp;sex);\n    if (&amp;sex == \"m\") {\n        mat[0][0] = 1;\n        }\n    if (&amp;sex == \"f\") {\n        mat[0][0] = 2;\n    }\n    else{\n        mat[0][0] = 3;\n        printf(\"invalid\\n\");\n    }\n    printf(\"inserted: %c \\n\", sex);\n\n    printf(\"value on matrix 00: %i\\t\", mat[0][0]);\n    //printf(\"%i\\n\", mat[0][1]);\n    //printf(\"%i\\t\", mat[1][0]);\n    //printf(\"%i\", mat[1][1]);\n\n    return 0;\n}\n</code></pre>\n\n<p>The values at the end seem to be right but the program don't runs as I expected and I can't see my mistake, any help?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1562801137, "post_id": 56979793, "comment_id": 100495440, "body": "It&#39;s the starting point of your program - where the operating system knows to go to start executing your code."}, {"owner": {"reputation": 3, "user_id": 8477462, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-pIm0E-lSeWU/AAAAAAAAAAI/AAAAAAAAAEk/kWjlapjDGhE/photo.jpg?sz=128", "display_name": "script kiddie", "link": "https://stackoverflow.com/users/8477462/script-kiddie"}, "reply_to_user": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1562801300, "post_id": 56979793, "comment_id": 100495468, "body": "Is there any reason that it is &quot;main&quot; and not something like &quot;start&quot; or &quot;beginning&quot; instead, Im guessing theres not?"}, {"owner": {"reputation": 1101, "user_id": 3958521, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GorZx.jpg?s=128&g=1", "display_name": "bigwillydos", "link": "https://stackoverflow.com/users/3958521/bigwillydos"}, "edited": false, "score": 0, "creation_date": 1562801639, "post_id": 56979793, "comment_id": 100495526, "body": "@scriptkiddie its because <code>crt0</code> calls <code>main</code> see: <a href=\"https://www.embecosm.com/appnotes/ean9/html/ch05s02.html\" rel=\"nofollow noreferrer\">embecosm.com/appnotes/ean9/html/ch05s02.html</a>"}, {"owner": {"reputation": 7273, "user_id": 2193968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1beed39f2b04409ff584a0af1d59325c?s=128&d=identicon&r=PG", "display_name": "Jerry Jeremiah", "link": "https://stackoverflow.com/users/2193968/jerry-jeremiah"}, "edited": false, "score": 0, "creation_date": 1562802111, "post_id": 56979793, "comment_id": 100495597, "body": "As to why it is called main take a look at this <a href=\"https://stackoverflow.com/questions/1688338/why-the-name-main-for-function-main\" title=\"why the name main for function main\">stackoverflow.com/questions/1688338/&hellip;</a>"}, {"owner": {"reputation": 7273, "user_id": 2193968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1beed39f2b04409ff584a0af1d59325c?s=128&d=identicon&r=PG", "display_name": "Jerry Jeremiah", "link": "https://stackoverflow.com/users/2193968/jerry-jeremiah"}, "edited": false, "score": 0, "creation_date": 1562802322, "post_id": 56979793, "comment_id": 100495628, "body": "main is the first function executed that i s written by you - it isn&#39;t the first function executed because there is code that is run before your program starts that, for example. reads the command line and puts it into the argv array."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1562806516, "post_id": 56979793, "comment_id": 100496411, "body": "It&#39;s called <code>main</code> for the more or less the same reason you&#39;re called script kiddie.  It&#39;s not called <code>start</code> or <code>beginning</code> for more or less the same reason you&#39;re not called Tiggles or Sean the Avenger."}, {"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "edited": false, "score": 0, "creation_date": 1562817683, "post_id": 56979793, "comment_id": 100498345, "body": "@scriptkiddie: The entry point needs to be called <i>something</i>.  <code>main</code> was as good a name as any, and it makes sense, as it\u2019s the \u201cmain\u201d part of your program."}], "answers": [{"tags": [], "owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "is_accepted": false, "score": 1, "last_activity_date": 1562801512, "creation_date": 1562801512, "answer_id": 56979837, "question_id": 56979793, "link": "https://stackoverflow.com/questions/56979793/what-does-the-main-that-is-put-in-the-beginning-of-programs-in-c-mean/56979837#56979837", "title": "What does the &quot;main()&quot; that is put in the beginning of programs in C mean?", "body": "<p>It's the starting point for your program.  <a href=\"https://port70.net/~nsz/c/c11/n1570.html#5.1.2.2.1\" rel=\"nofollow noreferrer\">Per <strong>5.1.2.2.1 Program startup</strong> of the C standard</a>:</p>\n\n<blockquote>\n  <p>The function called at program startup is named <code>main</code>. The\n  implementation declares no prototype for this function. It shall be\n  defined with a return type of <code>int</code> and with no parameters:</p>\n\n<pre><code>     int main(void) { /* ... */ }\n</code></pre>\n  \n  <p>or with two parameters (referred to here as <code>argc</code> and <code>argv</code>, though any\n  names may be used, as they are local to the function in which they are\n  declared):</p>\n\n<pre><code>     int main(int argc, char *argv[]) { /* ... */ }\n</code></pre>\n  \n  <p>or equivalent; or in some other implementation-defined manner.</p>\n  \n  <p>If they are declared, the parameters to the main function shall obey\n  the following constraints:</p>\n  \n  <ul>\n  <li>The value of <code>argc</code> shall be nonnegative.</li>\n  <li><code>argv[argc]</code> shall be a null pointer.</li>\n  <li>If the value of <code>argc</code> is greater than zero, the array members <code>argv[0]</code> through <code>argv[argc-1]</code> inclusive shall contain pointers to\n  strings, which are given implementation-defined values by the host\n  environment prior to program startup. The intent is to supply to the\n  program information determined prior to program startup from elsewhere\n  in the hosted environment. If the host environment is not capable of\n  supplying strings with letters in both uppercase and lowercase, the\n  implementation shall ensure that the strings are received in\n  lowercase.</li>\n  <li>If the value of <code>argc</code> is greater than zero, the string pointed to by <code>argv[0]</code> represents the program name; <code>argv[0][0]</code> shall be the\n  null character if the program name is not available from the host\n  environment. If the value of <code>argc</code> is greater than one, the strings\n  pointed to by <code>argv[1]</code> through <code>argv[argc-1]</code> represent the program\n  parameters.</li>\n  <li>The parameters <code>argc</code> and <code>argv</code> and the strings pointed to by the <code>argv</code> array shall be modifiable by the program, and retain their\n  last-stored values between program startup and program termination.</li>\n  </ul>\n</blockquote>\n"}], "owner": {"reputation": 3, "user_id": 8477462, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-pIm0E-lSeWU/AAAAAAAAAAI/AAAAAAAAAEk/kWjlapjDGhE/photo.jpg?sz=128", "display_name": "script kiddie", "link": "https://stackoverflow.com/users/8477462/script-kiddie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1562801512, "creation_date": 1562801049, "question_id": 56979793, "link": "https://stackoverflow.com/questions/56979793/what-does-the-main-that-is-put-in-the-beginning-of-programs-in-c-mean", "title": "What does the &quot;main()&quot; that is put in the beginning of programs in C mean?", "body": "<p>I just want to learn the basics thoroughly and what some simple codes refer to.</p>\n\n<p>I was able to find a short description at \n<a href=\"https://www.dummies.com/programming/c/looking-at-the-c-language/\" rel=\"nofollow noreferrer\">https://www.dummies.com/programming/c/looking-at-the-c-language/</a> but I dont think I fully understand it with the help of just that.</p>\n"}, {"tags": ["c", "segmentation-fault", "malloc", "breadth-first-search"], "comments": [{"owner": {"reputation": 6882, "user_id": 3403834, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xpA5S.jpg?s=128&g=1", "display_name": "user58697", "link": "https://stackoverflow.com/users/3403834/user58697"}, "edited": false, "score": 1, "creation_date": 1562799314, "post_id": 56979534, "comment_id": 100495077, "body": "You never set any visitado to <code>true</code>."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1562799609, "post_id": 56979534, "comment_id": 100495130, "body": "Segfault with what input?"}, {"owner": {"reputation": 314, "user_id": 12103577, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAM1fyJtJUzP2YAgkNOOk4yA2WWUp9Py5LaCLoyzw=k-s128", "display_name": "George Ogden", "link": "https://stackoverflow.com/users/12103577/george-ogden"}, "edited": false, "score": 0, "creation_date": 1613984987, "post_id": 56979534, "comment_id": 117235161, "body": "Stack Overflow error on Stack Overflow!"}], "answers": [{"tags": [], "owner": {"reputation": 6882, "user_id": 3403834, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xpA5S.jpg?s=128&g=1", "display_name": "user58697", "link": "https://stackoverflow.com/users/3403834/user58697"}, "is_accepted": false, "score": 0, "last_activity_date": 1562800987, "creation_date": 1562800987, "answer_id": 56979789, "question_id": 56979534, "link": "https://stackoverflow.com/questions/56979534/segmentation-fault-in-dfs-function/56979789#56979789", "title": "Segmentation fault in DFS function", "body": "<p>You never set any visited to <code>true</code>, so the recursion into <code>dfs</code> never terminates. Until the stack overflow, of course.</p>\n"}], "owner": {"reputation": 23, "user_id": 10172484, "user_type": "registered", "profile_image": "https://graph.facebook.com/2163071843735168/picture?type=large", "display_name": "Jo&#227;o Victor Vilar", "link": "https://stackoverflow.com/users/10172484/jo%c3%a3o-victor-vilar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1562800987, "creation_date": 1562798594, "question_id": 56979534, "link": "https://stackoverflow.com/questions/56979534/segmentation-fault-in-dfs-function", "title": "Segmentation fault in DFS function", "body": "<p>I'm getting a segmentation fault error when first calling the function dfs.</p>\n\n<p>I've tried using dynamic and static arrays for it, but both ended up with the same error.</p>\n\n<pre><code>void dfs(int **g,int *visitados,int prim,int nAlunos){\n    int k;\n    for(k=0;k&lt;nAlunos;k++){\n        if(!visitados[k] &amp;&amp; g[prim][k] == true){\n            dfs(g,visitados,k,nAlunos);\n        }\n    }\n }\n</code></pre>\n\n<p>main:</p>\n\n<pre><code>    scanf(\"%d %d\",&amp;nAlunos,&amp;    nLinhas);\n\n   int **g = (int**)malloc(sizeof(int*)*nAlunos);  //matrix allocation\n    for(a=0;a&lt;nAlunos;a++)\n        g[a] = (int *)malloc(nAlunos * sizeof(int));\n\n    int *visitados = (int*)malloc(nAlunos * sizeof(int)); // visited array\n\n    for(a=0;a&lt;nAlunos;a++)      //set the full matrix as false\n        for(b=0;b&lt;nAlunos;b++)\n            g[a][b] = false;\n\n    for(a=0;a&lt;nAlunos;a++)      //set the full array as false\n        visitados[a] = false;\n\n    for(a=0;a&lt;nLinhas;a++){\n        scanf(\"%d%d\",&amp;i,&amp;j);\n        g[i-1][j-1] = true; //input starts with 1\n    }\n\n    int grupos = 0;\n    for(a=0;a&lt;nLinhas;a++){\n            if(visitados[a] == false){\n                 dfs(g,visitados,a,nAlunos); //segfault when 1st calling this\n                grupos++;\n            }\n</code></pre>\n\n<p>Program received signal SIGSEGV, Segmentation fault.\n0x000000000800095c in main ()</p>\n"}, {"tags": ["c", "linux", "screen-brightness"], "comments": [{"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1562798730, "post_id": 56979485, "comment_id": 100494940, "body": "Why are you using rw mode?"}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1562798893, "post_id": 56979485, "comment_id": 100494972, "body": "And what is <code>errno</code> after it fails (your code doesn&#39;t check for <code>fprintf()</code> failure...)? Use <code>sterror()</code> or <code>perror()</code> to get a human readable error."}, {"owner": {"reputation": 7668, "user_id": 2554472, "user_type": "registered", "profile_image": "https://graph.facebook.com/1119155584/picture?type=large", "display_name": "Mark Plotnick", "link": "https://stackoverflow.com/users/2554472/mark-plotnick"}, "edited": false, "score": 0, "creation_date": 1562803166, "post_id": 56979485, "comment_id": 100495778, "body": "Does <code>fprintf(f, &quot;%d\\n&quot;, i);</code> work any better?"}, {"owner": {"reputation": 2385, "user_id": 10306503, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31c5d6c9b08dd045f4876591d703bda6?s=128&d=identicon&r=PG", "display_name": "mosvy", "link": "https://stackoverflow.com/users/10306503/mosvy"}, "reply_to_user": {"reputation": 7668, "user_id": 2554472, "user_type": "registered", "profile_image": "https://graph.facebook.com/1119155584/picture?type=large", "display_name": "Mark Plotnick", "link": "https://stackoverflow.com/users/2554472/mark-plotnick"}, "edited": false, "score": 0, "creation_date": 1562803435, "post_id": 56979485, "comment_id": 100495848, "body": "@MarkPlotnick The values written in <code>&#47;sys</code> and <code>&#47;proc</code> filelets don&#39;t have to be terminated by a newline."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1562805302, "post_id": 56979485, "comment_id": 100496202, "body": "To write to <code>&#47;proc</code>, your process must run with <code>root</code> privileges. Have you confirmed that <code># echo 5 &gt; &#47;sys&#47;class&#47;backlight&#47;intel_backlight&#47;brightness</code> actually changes the brightness? Some distro implementations do not actually accept changes to <code>brightness</code>. You should read <code>&#47;sys&#47;class&#47;backlight&#47;intel_backlight&#47;max_brightness</code> to set the upper limit of acceptable values."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1562812317, "post_id": 56979485, "comment_id": 100497402, "body": "I have looked a bit further at this. I do the same thing but with a shell script for controlling brightness in KDE3 with the Nvidia driver through <code>...&#47;acpi_video0&#47;brightness</code>. It seems there are certain rules you must follow (that the shell is already written to follow) when you attempt to write to <code>sysfs</code>. Specifically from <code>kernel.org</code> itself, <a href=\"https://www.kernel.org/doc/html/latest/admin-guide/sysfs-rules.html\" rel=\"nofollow noreferrer\">Rules on how to access information in sysfs</a>. The biggest issues is you cannot use <code>&#47;sys&#47;class&#47;backlight&#47;intel_backlight&#47;brightness</code> (it is a <code>link</code>)"}], "answers": [{"comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1562812363, "post_id": 56979940, "comment_id": 100497409, "body": "I believe this answer misses the mark, see <a href=\"https://www.kernel.org/doc/html/latest/admin-guide/sysfs-rules.html\" rel=\"nofollow noreferrer\">Rules on how to access information in sysfs</a> (not that the issue you identified is wrong...)"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1562813829, "post_id": 56979940, "comment_id": 100497656, "body": "Really, did you miss <i>&quot;all elements of a devpath must be real directories. Symlinks pointing to /sys/devices must always be resolved to their real target and the target path must be used to access the device. That way the devpath to the device matches the devpath of the kernel used at event time.&quot;</i>?"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1562814331, "post_id": 56979940, "comment_id": 100497747, "body": "I do, and a simple <code>strace</code> (or proper validation after <code>fclose</code>) after an attempted write to a path on <code>sysfs</code> that contains a symlink with result in <code>EINVAL</code> (invalid access) of the path containing a symlink. If you truly think that is just a recommendation, you can test, and then go tell the folks at <code>kernel.org</code>, that they got their documentation wrong. ?"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1562814548, "post_id": 56979940, "comment_id": 100497787, "body": "Don&#39;t get me wrong, I&#39;m not criticizing you. This is very non-apparent behavior from a normal file read/write standpoint. Normally, a link is the file for all practical purposes, accept in this case."}, {"owner": {"reputation": 2385, "user_id": 10306503, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31c5d6c9b08dd045f4876591d703bda6?s=128&d=identicon&r=PG", "display_name": "mosvy", "link": "https://stackoverflow.com/users/10306503/mosvy"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1562814549, "post_id": 56979940, "comment_id": 100497788, "body": "strace is tracing system calls like open(2) or write(2), not library functions like fprintf(3) or fclose(3). And you never write to a <i>path</i>, but you open(2) a path (which, if a symlink, will be resolved by the kernel), and then write to the file descriptors returned by open(2). And <code>EINVAL</code> is <b>not</b> invalid access, but &quot;invalid argument&quot;."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1562814723, "post_id": 56979940, "comment_id": 100497822, "body": "You can adapt and test: <a href=\"http://susepaste.org/71797495\" rel=\"nofollow noreferrer\">C - Write sysfs brightness</a> - expires: Wed Aug  7 22:10:39 CDT 2019"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1562815505, "post_id": 56979940, "comment_id": 100497958, "body": "@David have you straced <code>echo 42 &gt; class&#47;backlight&#47;acpi_video0&#47;brightness</code>? Does it do any of what you suggest?"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1562818153, "post_id": 56979940, "comment_id": 100498436, "body": "@n.m. Range here is <code>0-20</code> and <code>echo</code> any value in between appropriately sets the backlight (as root). The same applies to the posted code with the proper device ID. However, if you replace the full path with the symlink version  (e.g. <code>&#47;sys&#47;class&#47;backlight&#47;acpi_video0&#47;brightness</code>) the change from the C code fails as the kernel refuses the mismatch between the <code>&#47;sys&#47;class</code> link and the actual <code>&#47;sys&#47;devices</code> ID. What that tells me is the shell either uses <code>readlink -f</code> before redirection (or in the special case where the destination is on <code>sysfs</code>). Will have to pull bash code to see."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1562820019, "post_id": 56979940, "comment_id": 100498861, "body": "I can produce differing results between SuSE and Arch, (4.4 v. 5.1 kernels), so I&#39;m not sure whether this is kernel version of config dependent."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1562822418, "post_id": 56979940, "comment_id": 100499426, "body": "@n.m. - yes, no problem reading with the symlink. The problem was trying to write to the symlink on opensuse, but the write to the <code>&#47;sys&#47;devices</code> directory works (I also have Nvidia involved). On Arch, I can read and write with the symlink itself, so I&#39;m not sure where the difference is. I cannot pin it down in the documentation as I initially thought when testing opensuse alone."}, {"owner": {"reputation": 2385, "user_id": 10306503, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31c5d6c9b08dd045f4876591d703bda6?s=128&d=identicon&r=PG", "display_name": "mosvy", "link": "https://stackoverflow.com/users/10306503/mosvy"}, "edited": false, "score": 0, "creation_date": 1562823424, "post_id": 56979940, "comment_id": 100499773, "body": "Probably some selinux/systap/fanotify/audit/etc framework gone amok. FWIW, trying to resolve links by hand may be actually harmful on linux -- many <code>&#47;proc</code> and <code>&#47;sys</code> files are implemented as fake &quot;magical&quot; symlinks where the target path is purely informative."}], "tags": [], "owner": {"reputation": 2385, "user_id": 10306503, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31c5d6c9b08dd045f4876591d703bda6?s=128&d=identicon&r=PG", "display_name": "mosvy", "link": "https://stackoverflow.com/users/10306503/mosvy"}, "is_accepted": true, "score": 1, "last_activity_date": 1562803814, "last_edit_date": 1562803814, "creation_date": 1562802360, "answer_id": 56979940, "question_id": 56979485, "link": "https://stackoverflow.com/questions/56979485/can-read-but-not-write-proc-file-in-c/56979940#56979940", "title": "Can read but not write proc file in C", "body": "<pre><code>f = fopen(brightness, (!strncmp(argv[1], \"get\", 3)) ? \"r\" : \"rw\");\n</code></pre>\n\n<p><code>\"rw\"</code> is not a valid argument for the <code>mode</code> argument of <code>fopen(3)</code>. To open a file in read/write mode with <code>fopen(3)</code>, you should use <code>\"r+\"</code>.</p>\n\n<p>Using <code>\"rw\"</code> is undefined behaviour -- in Linux/glibc it will be treated just as a single <code>\"r\"</code>, the file will be opened in read-only mode, and the <code>printf</code> -> <code>write</code> will fail.</p>\n\n<p>Generally, it's not a very smart idea to use buffered i/o with such tiny files. You should look into <code>dprintf(3)</code>, if you need to write formatted data to a file descriptor.</p>\n\n<p>Also, I would just use a list of fixed values in a setuid program, instead of having to validate arguments, and take care that the validating code don't become itself a liability, etc.</p>\n"}], "owner": {"reputation": 3, "user_id": 10634890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bc41d78300f948bf68dd67a8252ee4c?s=128&d=identicon&r=PG&f=1", "display_name": "Sermak", "link": "https://stackoverflow.com/users/10634890/sermak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 326, "favorite_count": 0, "accepted_answer_id": 56979940, "answer_count": 1, "score": 0, "last_activity_date": 1562819962, "creation_date": 1562798165, "question_id": 56979485, "link": "https://stackoverflow.com/questions/56979485/can-read-but-not-write-proc-file-in-c", "title": "Can read but not write proc file in C", "body": "<p>I am writing a C program to change the screen brightness as xbacklight does not work in my circumstance. The solution should be native C (no system() function), because the program should be executable as a normal user via setuid. Calling external shell commands or scripts causes the kernel to ignore this bit.</p>\n\n<p>Reading the proc file that controls the brightness works fine, but writing to it using C produces no result, even if I run the program as root. The fprintf call returns -130, indicating an error. As a sanity check, I included a working solution using system() as a comment.</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>[...]\nconst char* brightness = \"/sys/class/backlight/intel_backlight/brightness\";\nf = fopen(brightness, (!strncmp(argv[1], \"get\", 3)) ? \"r\" : \"rw\");\n[...]\n\nint get_brightness() {\n  int buff;\n  fscanf(f, \"%d\", &amp;buff);\n  return buff;\n}\n\nint set(int i) {\n  i = MAX(0, MIN(255, i));\n  fprintf(f, \"%d\", i);\n  printf(\"%d\", i);\n  //char *cmd = (char*) malloc(59 *sizeof(char));\n  //snprintf(cmd, 59, \"echo %d &gt; %s\", i, brightness);\n  //system(cmd);\n  //free(cmd);\n}\n\n</code></pre>\n"}, {"tags": ["c", "assembly", "gdb", "x86-64"], "comments": [{"owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 2, "creation_date": 1562797946, "post_id": 56979432, "comment_id": 100494748, "body": "Not sure why it&#39;s stopped (that&#39;s usually a background job thingy) but due to PIE and ASLR the address you are using is just an offset and not the correct memory address hence it won&#39;t work. You can stop at the first instruction then disassemble or otherwise determine correct address. You can see in your last line, the actual address for that run is <code>0x0000555555555130</code>."}, {"owner": {"reputation": 5, "user_id": 6477231, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DEphkPGBA6g/AAAAAAAAAAI/AAAAAAAABAg/HoixxVobNzU/photo.jpg?sz=128", "display_name": "Trojan Batman", "link": "https://stackoverflow.com/users/6477231/trojan-batman"}, "reply_to_user": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 0, "creation_date": 1562798220, "post_id": 56979432, "comment_id": 100494824, "body": "Ah, I just noticed that. How would I find the actual address then for a line?"}, {"owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 1, "creation_date": 1562798534, "post_id": 56979432, "comment_id": 100494901, "body": "As I said, that&#39;s only established once the process is started. Hence use <code>starti</code> to do that, then you can use disassembly or some other method depending on your circumstances to get the correct address. Sounds like an XY problem though, you should tell us <b>why</b> you want to use addresses instead of line numbers or symbols."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1562832459, "post_id": 56979432, "comment_id": 100503918, "body": "To run and stop in <code>main</code>, use <code>start</code>.  Using <code>starti</code> will stop in the very first instruction in user-space, at the process entry point in <code>_start</code> which eventually calls main."}], "answers": [{"comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1562832558, "post_id": 56984409, "comment_id": 100503969, "body": "Yes GDB disables ASLR, but <code>0x0000000000001130</code> is still relative to the base address (start of the executable file).  Disabling ASLR just fixes the base address at <code>0x005555555...</code> or something.  You can&#39;t get the executable mapped to the zero page."}], "tags": [], "owner": {"reputation": 2286, "user_id": 3228495, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e0163d41bd310e00b055618846734b0?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew", "link": "https://stackoverflow.com/users/3228495/andrew"}, "is_accepted": true, "score": 2, "last_activity_date": 1562832740, "last_edit_date": 1562832740, "creation_date": 1562832299, "answer_id": 56984409, "question_id": 56979432, "link": "https://stackoverflow.com/questions/56979432/gdb-stops-program-when-i-break-at-an-address-while-it-works-with-an-offset/56984409#56984409", "title": "gdb stops program when I break at an address while it works with an offset", "body": "<p>As was pointed out in the comments, the address you are using in the first case is incorrect, probably due to something like PIE (GDB usually disables ASLR if it can).  This means you are trying to place a breakpoint at an invalid address, which is triggering a GDB bug that was fixed recently:</p>\n\n<p><a href=\"https://sourceware.org/ml/gdb-patches/2019-05/msg00361.html\" rel=\"nofollow noreferrer\">https://sourceware.org/ml/gdb-patches/2019-05/msg00361.html</a></p>\n\n<p>Once you see GDB stopped like this:</p>\n\n<pre><code>  [1]+  Stopped                 gdb soQuestionProgram\n</code></pre>\n\n<p>you should be dropped back to a shell.  Just resume GDB with the <code>fg</code> command and continue your debug session.  Once GDB 8.4 is out this bug will be fixed.</p>\n\n<hr>\n\n<p>Use the GDB <code>start</code> or <code>starti</code> command to run the program but stop at the top of <code>main</code> or before the first instruction in userspace, respectively.  Once the program is running, GDB will have real addresses in its disassembly, not just relative offsets relative to the start of the file.</p>\n\n<p>Or compile+link with <code>gcc -fno-pie -no-pie</code> to build a non-PIE executable with a fixed load address selected at link time.</p>\n"}], "owner": {"reputation": 5, "user_id": 6477231, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DEphkPGBA6g/AAAAAAAAAAI/AAAAAAAABAg/HoixxVobNzU/photo.jpg?sz=128", "display_name": "Trojan Batman", "link": "https://stackoverflow.com/users/6477231/trojan-batman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 56984409, "answer_count": 1, "score": 0, "last_activity_date": 1562832740, "creation_date": 1562797762, "question_id": 56979432, "link": "https://stackoverflow.com/questions/56979432/gdb-stops-program-when-i-break-at-an-address-while-it-works-with-an-offset", "title": "gdb stops program when I break at an address while it works with an offset", "body": "<p>I'm using GNU gdb (GDB) 8.3 on Kali Linux Rolling 2019.2. I have the following C code</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint main(int argc, char **argv) {\n    int x = 5;\n    int y = 3;\n}\n</code></pre>\n\n<p>And assembly</p>\n\n<pre><code>Dump of assembler code for function main:\n   0x0000000000001125 &lt;+0&gt;:     push   rbp\n   0x0000000000001126 &lt;+1&gt;:     mov    rbp,rsp\n   0x0000000000001129 &lt;+4&gt;:     mov    DWORD PTR [rbp-0x14],edi\n   0x000000000000112c &lt;+7&gt;:     mov    QWORD PTR [rbp-0x20],rsi\n   0x0000000000001130 &lt;+11&gt;:    mov    DWORD PTR [rbp-0x4],0x5\n   0x0000000000001137 &lt;+18&gt;:    mov    DWORD PTR [rbp-0x8],0x3\n   0x000000000000113e &lt;+25&gt;:    mov    eax,0x0\n   0x0000000000001143 &lt;+30&gt;:    pop    rbp\n   0x0000000000001144 &lt;+31&gt;:    ret    \nEnd of assembler dump.\n</code></pre>\n\n<p>When I break at a memory address, the program stops.</p>\n\n<pre><code>(gdb) break *0x0000000000001130\nBreakpoint 1 at 0x1130\n(gdb) r\nStarting program: /root/Documents/soQuestionProgram \n\n[1]+  Stopped                 gdb soQuestionProgram\n</code></pre>\n\n<p>However, when I break at the same memory address using an offset of <code>main</code>, the breakpoint works.</p>\n\n<pre><code>(gdb) break *main+11\nBreakpoint 1 at 0x1130\n(gdb) r\nStarting program: /root/Documents/soQuestionProgram \n\nBreakpoint 1, 0x0000555555555130 in main ()\n</code></pre>\n\n<p>Why does this happen, and how would I make breaking at a memory address work?</p>\n"}, {"tags": ["c", "file", "character-encoding", "ascii", "special-characters"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1562792692, "post_id": 56978586, "comment_id": 100493231, "body": "Using control-A <code>&#39;\\001&#39;</code> or <code>&#39;\\1&#39;</code> is OK.  Any of the control characters except control-G (<code>&#39;\\007&#39;</code>) through control-M (<code>&#39;\\015&#39;</code>) \u2014 alert, backspace, tab, newline, vertical tab, form feed, carriage return \u2014 could be used reasonably sanely."}, {"owner": {"reputation": 26680, "user_id": 1806780, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/NCB41.jpg?s=128&g=1", "display_name": "Sami Kuhmonen", "link": "https://stackoverflow.com/users/1806780/sami-kuhmonen"}, "edited": false, "score": 0, "creation_date": 1562792739, "post_id": 56978586, "comment_id": 100493250, "body": "You can write any character code in hexadecimal inside a string with <code>\\x01</code> style"}, {"owner": {"reputation": 61, "user_id": 11121537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd462db1921900266a96519037dcad1d?s=128&d=identicon&r=PG&f=1", "display_name": "ABC", "link": "https://stackoverflow.com/users/11121537/abc"}, "edited": false, "score": 0, "creation_date": 1562792829, "post_id": 56978586, "comment_id": 100493277, "body": "Ok perfect so I can use &#39;\\1&#39; without problems? Moreover, what are all the possible characters I can use in c? More precisely where can I find a list of them?"}, {"owner": {"reputation": 61, "user_id": 11121537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd462db1921900266a96519037dcad1d?s=128&d=identicon&r=PG&f=1", "display_name": "ABC", "link": "https://stackoverflow.com/users/11121537/abc"}, "reply_to_user": {"reputation": 26680, "user_id": 1806780, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/NCB41.jpg?s=128&g=1", "display_name": "Sami Kuhmonen", "link": "https://stackoverflow.com/users/1806780/sami-kuhmonen"}, "edited": false, "score": 0, "creation_date": 1562793017, "post_id": 56978586, "comment_id": 100493341, "body": "@SamiKuhmonen Ok, but what is the limit?"}, {"owner": {"reputation": 26680, "user_id": 1806780, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/NCB41.jpg?s=128&g=1", "display_name": "Sami Kuhmonen", "link": "https://stackoverflow.com/users/1806780/sami-kuhmonen"}, "edited": false, "score": 0, "creation_date": 1562793062, "post_id": 56978586, "comment_id": 100493357, "body": "Any byte can be written like that, and multibyte with multiple bytes. So there\u2019s no limit."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1562793464, "post_id": 56978586, "comment_id": 100493492, "body": "Just realize that other applications won&#39;t understand what you&#39;re doing. You might as well write a binary file instead of mixing text with special characters."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1562793500, "post_id": 56978586, "comment_id": 100493513, "body": "The choice is largely up to you.  The control characters (bytes) 0x00..0x1F are good choices, and largely independent of code set.  Bytes from 0x7F up to 0xFF are more problematic \u2014 their interpretation (at least from 0x80 up) depends heavily on the code set.  What works OK in ISO 8859-1 doesn&#39;t work well in UTF-8, for example (whereas the control characters are the same in both).  Also consider whether using <code>Section 1:\\n</code> to introduce section one would work OK."}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 2, "creation_date": 1562794929, "post_id": 56978586, "comment_id": 100493955, "body": "Byte values 0x00 to 0x1F are reserved in ASCII (and therefore standards based on it like ISO-8859, Unicode, etc.), but only a few are commonly used in text (CR, LF, Tab, maybe FF, BS, Esc). Any of the others (including 0x01 &quot;Start of Header&quot;) would probably be OK. If you want to stay true to the spirit of ASCII, I suggest 0x1E &quot;Record Separator&quot;."}, {"owner": {"reputation": 2385, "user_id": 10306503, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31c5d6c9b08dd045f4876591d703bda6?s=128&d=identicon&r=PG", "display_name": "mosvy", "link": "https://stackoverflow.com/users/10306503/mosvy"}, "edited": false, "score": 0, "creation_date": 1562796993, "post_id": 56978586, "comment_id": 100494498, "body": "I see no point in doing that; wouldn&#39;t be much better if you wrote your sections in the <code>length text newline</code> format, eg. with <code>printf(&quot;%zu %s\\n&quot;, strlen(str), str)</code>? That would be much more robust and easier to parse. If space <i>really</i> is at a premium, you can omit the extra space and newline and use some variable length integer encoding like <a href=\"https://sqlite.org/src4/doc/trunk/www/varint.wiki\" rel=\"nofollow noreferrer\">this</a> for the length."}], "answers": [{"tags": [], "owner": {"reputation": 1544, "user_id": 7095433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69e608c3fba680f67e2997cae63cf626?s=128&d=identicon&r=PG", "display_name": "landru27", "link": "https://stackoverflow.com/users/7095433/landru27"}, "is_accepted": true, "score": 2, "last_activity_date": 1562797111, "creation_date": 1562797111, "answer_id": 56979349, "question_id": 56978586, "link": "https://stackoverflow.com/questions/56978586/use-special-characters-other-than-n-and-0-in-c/56979349#56979349", "title": "Use special characters other than &quot;\\n&quot; and &quot;\\0&quot; in C", "body": "<p>I hear two different questions where you ask <strong>\"Or It is wrong?\"</strong></p>\n\n<p>I hear you asking \"how can I designate a separator byte in my code?\", and I hear you asking \"what is a good choice for a separator byte?\"</p>\n\n<p><strong>First</strong>, fundamentally, what you are asking about is covered in section 6.4.4.4 of the C language specification, which covers \"C Character Constants\".  There are various places you can look up the formal C language spec, or you can search for \"C Character Constants\" for perhaps a friendlier description, etc.</p>\n\n<p>In detail, a handful of letters can be used in escape sequences to stand in for single bytes of specific values; e.g., <code>\\n</code> is one of those, as a stand-in for <code>0x0a</code> (decimal 10), a byte designated (in ASCII) as a newline.  Here are the legal ones:</p>\n\n<pre><code>\\a \\b \\f \\n \\r \\t \\v\n</code></pre>\n\n<p>The escape sequences <code>\\0</code> and <code>\\1</code> work because C supports using <code>\\</code> followed by digits as an octal value.  So, that'll also work with, say, <code>\\3</code> and <code>\\35</code>, but not <code>\\9</code>, and note that <code>\\35</code> has a decimal value of 29.  (Google \"octal values\" if you don't immediately see why that's the case.)</p>\n\n<p>There are other legal escape sequences:</p>\n\n<pre><code>\\' \\\" \\\\ \\?    :   '  \"  \\  and  ?, respectively\n\\xNNNN...      :   each 'N' can be a hexadecimal digit\n</code></pre>\n\n<p>And, of course, escape sequences are just one aspect of C character constants.</p>\n\n<p><strong>Second</strong>, whether or not you <em>should</em> use a given byte value as your file's section separator depends entirely on how your program will be used.  As others have pointed out in the comments, there are commonplace prevailing practices on what sort of byte value to use for this sort of thing.</p>\n\n<p>I personally agree that <code>0x1e</code> makes perhaps the most sense since in ASCII it is the \"record separator\".  Conforming to ASCII can matter if the data will need to be understood by other programs, or if your program will need to be understood by other people.</p>\n\n<p>On the other hand, a simple code comment can make it clear to anyone reading your code what byte value you are using for separating sections of your data file, and any program that needs to understand your data files needs to 'know' a lot more about the file format than just what the record separator is.  There is nothing magical about <code>0x1e</code> : it is merely a convention, and a reserved spot on the ASCII table to facilitate a common need -- that is, record separation of text that could contain normal text separators like space, newline, and null.</p>\n\n<p>Broadly, any byte value that won't show up in the contents of your sections would make a fine section separator.  Since you say those contents will be text, there are well over 100 choices, even if you exclude <code>\\0</code> (<code>0x00</code>) and <code>\\n</code> (<code>0x0a</code>).  In ASCII, a handful of byte values have been set aside for this sort of purpose, so that helps reduce the choice from several dozen to just several.  Even among those several, there are only a few commonly used as separators.</p>\n"}], "owner": {"reputation": 61, "user_id": 11121537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd462db1921900266a96519037dcad1d?s=128&d=identicon&r=PG&f=1", "display_name": "ABC", "link": "https://stackoverflow.com/users/11121537/abc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 165, "favorite_count": 0, "accepted_answer_id": 56979349, "answer_count": 1, "score": 0, "last_activity_date": 1562797111, "creation_date": 1562792523, "question_id": 56978586, "link": "https://stackoverflow.com/questions/56978586/use-special-characters-other-than-n-and-0-in-c", "title": "Use special characters other than &quot;\\n&quot; and &quot;\\0&quot; in C", "body": "<p>I have one question.\nI'm writing some code in C, on UNIX.\nI need to write a special character in a file, because I need to divide my file in small sections.</p>\n\n<p>Example:</p>\n\n<pre><code>'SPECIAL_CHARACTER'\nsection 1 with some text\n'SPECIAL_CHARACTER'\nsection 2 with some text\n</code></pre>\n\n<p>etc..</p>\n\n<p>I was thinking to use character '\\1'.It seems to work, but it is ok? Or It is wrong?</p>\n\n<p>To do these things without using characters like \"\\0\" or \"\\n\" what should I do?</p>\n"}, {"tags": ["c", "parsing", "strtok"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1562792448, "post_id": 56978186, "comment_id": 100493136, "body": "On Unix, you&#39;re getting into &#39;raw mode&#39; input from your terminal, which is moderately fraught \u2014 be cautious.  For the most part, you should assume that the input lines will be terminated by a newline.  You can use semicolons as an intermediate separator, so you could have <code>add 1 2 3; sub 2 4; div 9 4</code> all on a single line."}, {"owner": {"reputation": 115, "user_id": 7260556, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/accb313b0a000cd9fad61af73c51770f?s=128&d=identicon&r=PG&f=1", "display_name": "Hamza Siddiqui", "link": "https://stackoverflow.com/users/7260556/hamza-siddiqui"}, "edited": false, "score": 0, "creation_date": 1562822927, "post_id": 56978186, "comment_id": 100499587, "body": "Oh yea I forgot, it&#39;s for linux."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1563210366, "post_id": 56978186, "comment_id": 100616387, "body": "Your program won&#39;t see any input before the user presses enter, so no. And please do NOT do anything with ncurses. Terminal line editing exists for a reason. Don&#39;t mess with it."}], "answers": [{"comments": [{"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 1, "creation_date": 1562792463, "post_id": 56978396, "comment_id": 100493144, "body": "The main issue is getting the read to return when a semicolon is typed. The parsing part is easy."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1562792523, "post_id": 56978396, "comment_id": 100493165, "body": "This is skipping the issue of reading the data when the semicolon is pressed.  Once you&#39;ve got the string, what you&#39;re doing is more or less right, but the question is more, I think, about how to get the input without hitting return."}], "tags": [], "owner": {"reputation": 199, "user_id": 7043401, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a69ceceae43c69068f9a38c636c85419?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/7043401/nick"}, "is_accepted": false, "score": 0, "last_activity_date": 1562791546, "creation_date": 1562791546, "answer_id": 56978396, "question_id": 56978186, "link": "https://stackoverflow.com/questions/56978186/c-parser-program-to-add-sub-div-mul-reading-input-from-user-want-to-terminate-m/56978396#56978396", "title": "C parser program to add/sub/div/mul. Reading input from user want to terminate my program on semicolon instead of pressing enter", "body": "<p>Here's an example that might help, you can pass whatever terminating character into it as you please:</p>\n\n<pre><code>int add(char *str, char term)\n{\n    int res = 0;\n    while (*str)\n    {\n        while (*str &amp;&amp; !isdigit(*str))\n             str++;\n        if (*str &amp;&amp; isdigit(*str))\n             res += atoi(*str);\n        if (*str == term)\n             break ;\n        while (*str &amp;&amp; isdigit(*str))\n             str++;\n    }\n    return res;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8402, "user_id": 4664415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hsfxj.jpg?s=128&g=1", "display_name": "mevets", "link": "https://stackoverflow.com/users/4664415/mevets"}, "is_accepted": false, "score": 0, "last_activity_date": 1562807165, "creation_date": 1562807165, "answer_id": 56980405, "question_id": 56978186, "link": "https://stackoverflow.com/questions/56978186/c-parser-program-to-add-sub-div-mul-reading-input-from-user-want-to-terminate-m/56980405#56980405", "title": "C parser program to add/sub/div/mul. Reading input from user want to terminate my program on semicolon instead of pressing enter", "body": "<p>try man ncurses for more information, but this should work on most unixes:</p>\n\n<pre><code>  cc g.c -lncurses\n  ./a.out\n  cat g.c:  \n    #include &lt;ncurses.h&gt;\n    void main(void) {\n        initscr();\n        cbreak();\n        while (getch() != ';') {\n        }\n        nocbreak();\n        endwin();\n    }\n</code></pre>\n"}], "owner": {"reputation": 115, "user_id": 7260556, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/accb313b0a000cd9fad61af73c51770f?s=128&d=identicon&r=PG&f=1", "display_name": "Hamza Siddiqui", "link": "https://stackoverflow.com/users/7260556/hamza-siddiqui"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1563202906, "creation_date": 1562790559, "last_edit_date": 1563202906, "question_id": 56978186, "link": "https://stackoverflow.com/questions/56978186/c-parser-program-to-add-sub-div-mul-reading-input-from-user-want-to-terminate-m", "title": "C parser program to add/sub/div/mul. Reading input from user want to terminate my program on semicolon instead of pressing enter", "body": "<p>I have written C program that will read using read() user input for e.g:</p>\n\n<p><code>add 1 2 3\nResult: 6</code></p>\n\n<p>Now the thing is, read will stop the read once enter is pressed. What if I want to terminate using any other character other than pressing an enter?\nFor e.g:</p>\n\n<p><code>add 1 2 3;\nResult: 6</code></p>\n\n<p>Note--> As I press ; the read should stop reading and result should be displayed. </p>\n\n<pre><code>#include &lt;unistd.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main(void) {\nwhile(1) {\nchar buff[50];\nint rcount = read(STDIN_FILENO, buff, 50); //Reading user input\n//write(1, buff, rcount);\nbuff[rcount - 1] = '\\0'; //Converting user input as a string(char array)\n\n/*If nothing is given and user press enter*/\nif(strcasecmp(buff, \"\") == 0) {\n    write(1, \"Invalid argument\\n\", sizeof(\"Invalid argument\\n\"));\n}\n\n/*Getting the first argument*/\nchar *arr = strtok(buff, \" \");\n\nif(strcasecmp(arr, \"exit\") == 0) {\n    break; //Break out of loop when exit is typed in\n}\nif(strcasecmp(arr, \"add\") == 0) {\n    add(arr); //When first arg is add, call to add func\n}\nelse if(strcasecmp(arr, \"sub\") == 0) {\n    subtract(arr); //When first arg is sub, call to sub func\n}\nelse if(strcasecmp(arr, \"mul\") == 0) {\n    multiply(arr); //When first arg is mul, call to mul func\n}\nelse if(strcasecmp(arr, \"div\") == 0) {\n    divide(arr); //When first arg is div, call to div func\n}\n/*When first argument is anything else*/\nelse {\n       write(1, \"Invalid argument\\n\", sizeof(\"Invalid argument\\n\"));\n}\n\nprintf(\"\\n\");\n\n\n}\n}\n\nvoid add(char *arr) { //To add numbers --&gt; args &gt; 1\n\nint sum = 0;\nwhile(arr != NULL) { //Loop to get all the numbers and using them to   perform task\n    //printf(\"%s\\n\", arr);\n    int a = atoi(arr); //Converting arg/number to int\n    sum += a;\n    arr = strtok(NULL, \" \\n;\");\n}\nchar w[50];\nint count = sprintf(w, \"Result: %d\\n\", sum); //to use 'write', need to store sum as result so using sprintf instead of printf. Guess we've got no other option? \nwrite(1, w, count);\nreturn;\n}\n\nvoid subtract(char *arr) { //To subtract numbers --&gt; args &gt; 1\n\n    arr = strtok(NULL, \" \\n\"); //To move to second arg\nint subt = (int) atoi(arr); //to get the first number/2nd arg, as we will subtract remaining nums from this\n\narr = strtok(NULL, \" \\n\"); //To move to remaining numbers, args &gt; 2\n    while (arr != NULL) {\n    //printf(\"%s\\n\", arr);\n        int a = atoi(arr);\n        subt = subt - a;\n        arr = strtok(NULL, \" \\n\");\n    }\n\nchar w[50];\nint count=sprintf(w, \"Result: %d\\n\", subt);\nwrite(1, w, count);\nreturn;\n}\n\nvoid multiply(char *arr) { //To multiply numbers --&gt; args &gt; 1\n\nint mult = 1;\narr = strtok(NULL, \" \\n\");\nwhile (arr != NULL) {\n//printf(\"%s\\n\", arr);\n    int a = atoi(arr);\n    mult = mult * a;\n    arr = strtok(NULL, \" \\n\");\n}\nchar w[50];\nint count=sprintf(w, \"Result: %d\\n\", mult);\nwrite(1, w, count);\nreturn;\n}\n\nvoid divide(char *arr) { //To divide numbers --&gt; args &gt; 1\n\narr = strtok(NULL, \" \\n\");\nfloat div = (float) atoi(arr);\n//printf(\"%f\", div);\n//printf(\"\\n\");\narr = strtok(NULL, \" \\n\");\n    while (arr != NULL) {\n    //printf(\"%s\\n\", arr);\n        float a = (float) atoi(arr);\n        div = div / a;\n        arr = strtok(NULL, \" \\n\");\n    }\n\nchar w[50];\nint count=sprintf(w, \"Result: %f\\n\", div);\nwrite(1, w, count);\nreturn;\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "visual-studio-code"], "answers": [{"tags": [], "owner": {"reputation": 41, "user_id": 9721479, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1810040a856ad59547ffc862a31c667f?s=128&d=identicon&r=PG&f=1", "display_name": "Carsten H", "link": "https://stackoverflow.com/users/9721479/carsten-h"}, "is_accepted": false, "score": 3, "last_activity_date": 1576340437, "creation_date": 1576340437, "answer_id": 59336936, "question_id": 56978097, "link": "https://stackoverflow.com/questions/56978097/how-to-add-gtk-lib-in-visual-studio-code/59336936#59336936", "title": "How to add gtk lib in Visual studio code?", "body": "<p>Add <code>/usr/lib/glib-2.0/include/</code> to the include paths.</p>\n\n<p>Basically one wants to add the output from <a href=\"https://www.freedesktop.org/wiki/Software/pkg-config/\" rel=\"nofollow noreferrer\">pkg-config</a> to the VSCode includes.<br>\nTo dump the output on a shell, use:<br>\n<code>echo $(pkg-config --libs --cflags gtk+-3.0)</code></p>\n\n<p>If you want to provide <code>pkg-config</code> as a VSCode task argument see <a href=\"https://stackoverflow.com/a/49771627/9721479\">this answer</a>.\nI am happily using this <a href=\"https://marketplace.visualstudio.com/items?itemName=ms-vscode.cpptools\" rel=\"nofollow noreferrer\">VSCode extension</a> with GCC and Clang.\nHere is my <a href=\"https://gist.github.com/Acry/e0a167f6d323feb0519edb47248ab3bf\" rel=\"nofollow noreferrer\">gist to kick off coding GTK 3 in C with VSCode.</a></p>\n\n<p>Happy hacking!</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user12581835"}, "is_accepted": false, "score": 1, "last_activity_date": 1598763292, "last_edit_date": 1598763292, "creation_date": 1598691785, "answer_id": 63645252, "question_id": 56978097, "link": "https://stackoverflow.com/questions/56978097/how-to-add-gtk-lib-in-visual-studio-code/63645252#63645252", "title": "How to add gtk lib in Visual studio code?", "body": "<p>I added this to the include path inside <code>.vscode/c_cpp_properties.json</code>:</p>\n<pre><code>        &quot;includePath&quot;: [\n            &quot;${workspaceFolder}/**&quot;,\n            &quot;/usr/include/gtk-3.0&quot;,\n            &quot;/usr/include/glib-2.0&quot;,\n            &quot;/usr/lib/x86_64-linux-gnu/glib-2.0/include&quot;,\n            &quot;/usr/include/pango-1.0&quot;,\n            &quot;/usr/include/harfbuzz&quot;,\n            &quot;/usr/include/cairo&quot;,\n            &quot;/usr/include/gdk-pixbuf-2.0&quot;,\n            &quot;/usr/include/atk-1.0&quot;\n        ],\n</code></pre>\n<p>If you need gtkmm:</p>\n<pre><code>&quot;/usr/include/gtkmm-3.0&quot;,\n&quot;/usr/include/glibmm-2.4&quot;,\n&quot;/usr/include/sigc++-2.0&quot;,\n&quot;/usr/lib/x86_64-linux-gnu/sigc++-2.0/include&quot;,\n&quot;/usr/lib/x86_64-linux-gnu/glibmm-2.4/include&quot;,\n&quot;/usr/include/giomm-2.4/giomm&quot;,\n&quot;/usr/include/giomm-2.4&quot;,\n&quot;/usr/include/glibmm-2.4&quot;,\n&quot;/usr/include/glibmm-2.4/glibmm&quot;,\n&quot;/usr/lib/x86_64-linux-gnu/giomm-2.4/include&quot;,\n&quot;/usr/include/gdkmm-3.0&quot;,\n&quot;/usr/lib/x86_64-linux-gnu/gdkmm-3.0/include&quot;,\n&quot;/usr/include/pangomm-1.4&quot;,\n&quot;/usr/lib/x86_64-linux-gnu/pangomm-1.4/include&quot;,\n&quot;/usr/include/cairomm-1.0&quot;,\n&quot;/usr/include/freetype2&quot;,\n&quot;/usr/lib/x86_64-linux-gnu/gtkmm-3.0/include&quot;,\n&quot;/usr/lib/x86_64-linux-gnu/atkmm-1.6/include&quot;,\n&quot;/usr/include/atkmm-1.6&quot;\n</code></pre>\n"}], "owner": {"reputation": 93, "user_id": 11648861, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-hFIdTAiz4XY/AAAAAAAAAAI/AAAAAAAAEzg/adDaeuofm2k/photo.jpg?sz=128", "display_name": "Mihail HRS", "link": "https://stackoverflow.com/users/11648861/mihail-hrs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4342, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1598763292, "creation_date": 1562790135, "question_id": 56978097, "link": "https://stackoverflow.com/questions/56978097/how-to-add-gtk-lib-in-visual-studio-code", "title": "How to add gtk lib in Visual studio code?", "body": "<p>I try to add gtk library to my file in Visual Studio code on my Arch Linux ,but it underlines \"#include  line and writes:  </p>\n\n<pre>\n#include errors detected. Please update your includePath. Squiggles are disabled for this translation unit (/home/mikhailkhr/My projects/C projects/Test/Test.c).\ncannot open source file \"glibconfig.h\" (dependency of \"gtk/gtk.h\")\n</pre>\n\n<p>It does compile this file with:</p>\n\n<pre>\n gcc `pkg-config gtk+-3.0 --cflags` ProgName.c `pkg-config gtk+-3.0 --libs`\n</pre>\n\n<p>But why does it underline this?<br>\nAnd how to fix this?</p>\n\n<p>Thanks.</p>\n\n<p>Sorse code:</p>\n\n<pre><code>#define _PROGRAM_NAME \"whoami\"\n#include &lt;stdlib.h&gt;\n#include &lt;pwd.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;gtk/gtk.h&gt;\n\nconst char *getUserName()\n{\n  uid_t uid = geteuid();\n  struct passwd *pw = getpwuid(uid);\n  if (pw)\n  {\n    return pw-&gt;pw_name;\n  }\n\n  return \"\";\n}\n\nstatic void\nprint_hello (GtkWidget *widget,\n             gpointer   data)\n{\n  g_print (\"Hello %s\\n\", getUserName());\n}\n\nstatic void\nactivate (GtkApplication *app,\n          gpointer        user_data)\n{\n  GtkWidget *window;\n  GtkWidget *button;\n  GtkWidget *button_box;\n\n  window = gtk_application_window_new (app);\n  gtk_window_set_title (GTK_WINDOW (window), \"Window\");\n  gtk_window_set_default_size (GTK_WINDOW (window), 200, 200);\n\n  button_box = gtk_button_box_new (GTK_ORIENTATION_HORIZONTAL);\n  gtk_container_add (GTK_CONTAINER (window), button_box);\n\n  button = gtk_button_new_with_label (getUserName());\n  g_signal_connect (button, \"clicked\", G_CALLBACK (print_hello), NULL);\n  g_signal_connect_swapped (button, \"clicked\", G_CALLBACK (gtk_widget_destroy), window);\n  gtk_container_add (GTK_CONTAINER (button_box), button);\n\n  gtk_widget_show_all (window);\n}\n\nint\nmain (int    argc,\n      char **argv)\n{\n  GtkApplication *app;\n  int status;\n\n  app = gtk_application_new (\"org.gtk.example\", G_APPLICATION_FLAGS_NONE);\n  g_signal_connect (app, \"activate\", G_CALLBACK (activate), NULL);\n  status = g_application_run (G_APPLICATION (app), argc, argv);\n  g_object_unref (app);\n\n\n\n    return status;\n\n}\n</code></pre>\n"}, {"tags": ["php", "c", "exception", "deserialization", "magic-methods"], "answers": [{"comments": [{"owner": {"reputation": 190, "user_id": 4224741, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PgR0B.png?s=128&g=1", "display_name": "Awaaaaarghhh", "link": "https://stackoverflow.com/users/4224741/awaaaaarghhh"}, "edited": false, "score": 0, "creation_date": 1562792683, "post_id": 56978473, "comment_id": 100493228, "body": "Well, you&#39;re describing the code of <code>CHECK_EXC_TYPE</code>. But I&#39;m curious why <code>__wakeup</code> method of <i>Exception</i> class needs to be defined already at C level and not later at PHP level, where we can e.g. define such <i>magic methods</i> like <code>__destruct</code>. So I understand, that we are checking types in lines 306-333. But what is the point of defining <code>__wakeup</code> here? In lines 788-801: <code>ZEND_ME(exception, __wakeup, NULL, ZEND_ACC_PUBLIC)</code> is just saying that <code>__wakeup</code> is part of <i>Exception</i> class and is public. That&#39;s it. It&#39;s just so unclear what it is doing here."}, {"owner": {"reputation": 190, "user_id": 4224741, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PgR0B.png?s=128&g=1", "display_name": "Awaaaaarghhh", "link": "https://stackoverflow.com/users/4224741/awaaaaarghhh"}, "edited": false, "score": 0, "creation_date": 1562792961, "post_id": 56978473, "comment_id": 100493316, "body": "Is the point of having <code>__wakeup</code> there is that it just enables deserialisation natively, (without defining own <i>Exception</i> classes) ? But since it doesn&#39;t have <code>__sleep</code> method it actually shouldn&#39;t be serialized (but it still works). So it just makes no sense to me."}, {"owner": {"reputation": 170455, "user_id": 149341, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/omfTQ.png?s=128&g=1", "display_name": "duskwuff -inactive-", "link": "https://stackoverflow.com/users/149341/duskwuff-inactive"}, "reply_to_user": {"reputation": 190, "user_id": 4224741, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PgR0B.png?s=128&g=1", "display_name": "Awaaaaarghhh", "link": "https://stackoverflow.com/users/4224741/awaaaaarghhh"}, "edited": false, "score": 0, "creation_date": 1562793265, "post_id": 56978473, "comment_id": 100493426, "body": "&quot;But I&#39;m curious why <code>__wakeup</code> method of Exception class needs to be defined already at C level and not later at PHP level&quot; -- Because there is no PHP code corresponding to the <code>Exception</code> class. The class is defined entirely within PHP, so any methods must be defibned there."}, {"owner": {"reputation": 190, "user_id": 4224741, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PgR0B.png?s=128&g=1", "display_name": "Awaaaaarghhh", "link": "https://stackoverflow.com/users/4224741/awaaaaarghhh"}, "edited": false, "score": 0, "creation_date": 1562794459, "post_id": 56978473, "comment_id": 100493814, "body": "I think you&#39;re right. I think the point is that since <i>Exception</i> class should be deserializable it needs to have <code>__wakeup()</code> method added already at C level (since <i>Exception</i> class properties are defined in C too)."}, {"owner": {"reputation": 190, "user_id": 4224741, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PgR0B.png?s=128&g=1", "display_name": "Awaaaaarghhh", "link": "https://stackoverflow.com/users/4224741/awaaaaarghhh"}, "edited": false, "score": 0, "creation_date": 1562794534, "post_id": 56978473, "comment_id": 100493841, "body": "Maybe you can move your comment to your answer above, modify it a bit and I&#39;ll just mark it as answered. Thank you again."}], "tags": [], "owner": {"reputation": 170455, "user_id": 149341, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/omfTQ.png?s=128&g=1", "display_name": "duskwuff -inactive-", "link": "https://stackoverflow.com/users/149341/duskwuff-inactive"}, "is_accepted": false, "score": 0, "last_activity_date": 1562829729, "last_edit_date": 1562829729, "creation_date": 1562791964, "answer_id": 56978473, "question_id": 56978005, "link": "https://stackoverflow.com/questions/56978005/whats-the-point-of-having-wakeup-in-source-code-of-php-7-4-exceptions/56978473#56978473", "title": "What&#39;s the point of having __wakeup in source code of PHP 7.4 Exceptions?", "body": "<p>As best I can tell, this code is verifying the types of the exception's properties and setting them to <code>null</code> if the type is incorrect. For example:</p>\n\n<pre><code>CHECK_EXC_TYPE(ZEND_STR_MESSAGE,  IS_STRING);\n</code></pre>\n\n<p>is roughly equivalent to the PHP code:</p>\n\n<pre><code>if (!is_string($this-&gt;message))\n    $this-&gt;message = null;\n</code></pre>\n\n<p>Similarly, the code at the end, beginning with <code>pvalue = zend_read_property(\u2026)</code>, is checking that <code>$this-&gt;previous</code> is an object which implements <code>Throwable</code>. In PHP, it'd be roughly equivalent to:</p>\n\n<pre><code>if (!is_object($this-&gt;previous) || !($this-&gt;previous instanceof Throwable)\n    $this-&gt;previous = null;\n</code></pre>\n\n<p>As to why this code is part of the PHP interpreter? The entirety of the <code>Exception</code> class is defined there, in C code. None of the built-in classes or methods are written in PHP -- they cannot be, because the language provides no way to install a PHP implementation of a method to a class declared in C.</p>\n"}, {"tags": [], "owner": {"reputation": 190, "user_id": 4224741, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PgR0B.png?s=128&g=1", "display_name": "Awaaaaarghhh", "link": "https://stackoverflow.com/users/4224741/awaaaaarghhh"}, "is_accepted": false, "score": 0, "last_activity_date": 1563705015, "creation_date": 1563705015, "answer_id": 57132302, "question_id": 56978005, "link": "https://stackoverflow.com/questions/56978005/whats-the-point-of-having-wakeup-in-source-code-of-php-7-4-exceptions/57132302#57132302", "title": "What&#39;s the point of having __wakeup in source code of PHP 7.4 Exceptions?", "body": "<p>I think the point is that since Exception class should be deserializable it needs to have <code>__wakeup()</code> method added already at C level (since <em>Exception class</em> properties are defined in C too).</p>\n"}], "owner": {"reputation": 190, "user_id": 4224741, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PgR0B.png?s=128&g=1", "display_name": "Awaaaaarghhh", "link": "https://stackoverflow.com/users/4224741/awaaaaarghhh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 219, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1563705015, "creation_date": 1562789734, "last_edit_date": 1563614940, "question_id": 56978005, "link": "https://stackoverflow.com/questions/56978005/whats-the-point-of-having-wakeup-in-source-code-of-php-7-4-exceptions", "title": "What&#39;s the point of having __wakeup in source code of PHP 7.4 Exceptions?", "body": "<p>There exists a (rather new) exploitation technique called <a href=\"https://raw.githubusercontent.com/s-n-t/presentations/master/us-18-Thomas-It&#39;s-A-PHP-Unserialization-Vulnerability-Jim-But-Not-As-We-Know-It.pdf\" rel=\"nofollow noreferrer\">phar</a> <a href=\"https://cdn2.hubspot.net/hubfs/3853213/us-18-Thomas-It&#39;s-A-PHP-Unserialization-Vulnerability-Jim-But-Not-As-We-....pdf\" rel=\"nofollow noreferrer\">deserialisation</a> which gets triggered by PHP's <a href=\"https://www.php.net/manual/en/ref.filesystem.php\" rel=\"nofollow noreferrer\">file system functions</a> like <code>file_exists</code>, <code>unlink</code>, ... and then the unserialized code gets executed inside instantiated class which needs to contain at least one of two magic methods <code>__wakeup</code> and <code>__destruct</code>.</p>\n\n<p>My idea was to search in PHP's source code for builtin PHP classes which might have such magic methods natively implemented (<code>__wakeup</code> and <code>__destruct</code>) as part of such classes and could be somehow exploited during deserialization process during <em>Exception</em> handling (which might trigger e.g. some use-after-free bugs). Indeed I found <code>__wakeup</code> in several <em>Exception</em> classes (Easy way of getting all builtin classes and check them for having <code>__wakeup</code> and <code>__destruct</code> methods is to use PHP function <code>get_declared_classes()</code>). But at current point it seems to be unexploitable.</p>\n\n<p>So the question is not about exploiting things.</p>\n\n<p>Question: What i don't understand is why e.g. <code>__wakeup</code> implemented in <em>Exceptions</em>? Is it just a placeholder method for extending such <em>Exception</em> classes and writing later own <code>__wakeup</code>/<code>__destruct</code> methods?</p>\n\n<p>Source code:\n<a href=\"https://github.com/php/php-src/blob/master/Zend/zend_exceptions.c#L316\" rel=\"nofollow noreferrer\">https://github.com/php/php-src/blob/master/Zend/zend_exceptions.c#L316</a></p>\n\n<p>In lines 306-333 (<em>php-src/Zend/zend_exceptions.c</em>, PHP 7.4):</p>\n\n<pre><code>/* }}} */\n\n/* {{{ proto Exception::__wakeup()\n   Exception unserialize checks */\n#define CHECK_EXC_TYPE(id, type) \\\n    pvalue = zend_read_property_ex(i_get_exception_base(object), (object), ZSTR_KNOWN(id), 1, &amp;value); \\\n    if (Z_TYPE_P(pvalue) != IS_NULL &amp;&amp; Z_TYPE_P(pvalue) != type) { \\\n        zend_unset_property(i_get_exception_base(object), object, ZSTR_VAL(ZSTR_KNOWN(id)), ZSTR_LEN(ZSTR_KNOWN(id))); \\\n    }\n\nZEND_METHOD(exception, __wakeup)\n{\n    zval value, *pvalue;\n    zval *object = ZEND_THIS;\n    CHECK_EXC_TYPE(ZEND_STR_MESSAGE,  IS_STRING);\n    CHECK_EXC_TYPE(ZEND_STR_STRING,   IS_STRING);\n    CHECK_EXC_TYPE(ZEND_STR_CODE,     IS_LONG);\n    CHECK_EXC_TYPE(ZEND_STR_FILE,     IS_STRING);\n    CHECK_EXC_TYPE(ZEND_STR_LINE,     IS_LONG);\n    CHECK_EXC_TYPE(ZEND_STR_TRACE,    IS_ARRAY);\n    pvalue = zend_read_property(i_get_exception_base(object), object, \"previous\", sizeof(\"previous\")-1, 1, &amp;value);\n    if (pvalue &amp;&amp; Z_TYPE_P(pvalue) != IS_NULL &amp;&amp; (Z_TYPE_P(pvalue) != IS_OBJECT ||\n            !instanceof_function(Z_OBJCE_P(pvalue), zend_ce_throwable) ||\n            pvalue == object)) {\n        zend_unset_property(i_get_exception_base(object), object, \"previous\", sizeof(\"previous\")-1);\n    }\n}\n/* }}} */\n</code></pre>\n\n<p>and later in lines 788-801:\n<a href=\"https://github.com/php/php-src/blob/master/Zend/zend_exceptions.c#L788\" rel=\"nofollow noreferrer\">https://github.com/php/php-src/blob/master/Zend/zend_exceptions.c#L788</a></p>\n\n<pre><code>static const zend_function_entry default_exception_functions[] = {\n    ZEND_ME(exception, __clone, NULL, ZEND_ACC_PRIVATE|ZEND_ACC_FINAL)\n    ZEND_ME(exception, __construct, arginfo_exception___construct, ZEND_ACC_PUBLIC)\n    ZEND_ME(exception, __wakeup, NULL, ZEND_ACC_PUBLIC)\n    ZEND_ME(exception, getMessage, NULL, ZEND_ACC_PUBLIC|ZEND_ACC_FINAL)\n    ZEND_ME(exception, getCode, NULL, ZEND_ACC_PUBLIC|ZEND_ACC_FINAL)\n    ZEND_ME(exception, getFile, NULL, ZEND_ACC_PUBLIC|ZEND_ACC_FINAL)\n    ZEND_ME(exception, getLine, NULL, ZEND_ACC_PUBLIC|ZEND_ACC_FINAL)\n    ZEND_ME(exception, getTrace, NULL, ZEND_ACC_PUBLIC|ZEND_ACC_FINAL)\n    ZEND_ME(exception, getPrevious, NULL, ZEND_ACC_PUBLIC|ZEND_ACC_FINAL)\n    ZEND_ME(exception, getTraceAsString, NULL, ZEND_ACC_PUBLIC|ZEND_ACC_FINAL)\n    ZEND_ME(exception, __toString, NULL, 0)\n    ZEND_FE_END\n};\n</code></pre>\n"}, {"tags": ["c", "mips"], "comments": [{"owner": {"reputation": 199, "user_id": 7043401, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a69ceceae43c69068f9a38c636c85419?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/7043401/nick"}, "edited": false, "score": 0, "creation_date": 1562790877, "post_id": 56977960, "comment_id": 100492523, "body": "MIPs uses v0 as the return register, if you want to avoid using it it might be worth changing the function type to void, you can increment var5 in place with (*var5)++ if that&#39;s what you&#39;re looking for."}, {"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 0, "creation_date": 1562791152, "post_id": 56977960, "comment_id": 100492625, "body": "C is pass ny value, there is no way to change the <i>var5</i> passed by the caller. You have to change function signature (pointer to pointer as argument, or returning modified pointer as the normal return value) to do what you want."}, {"owner": {"reputation": 71, "user_id": 8440657, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c0c54df687648b253c2bf6ce2c36612e?s=128&d=identicon&r=PG&f=1", "display_name": "Walrfi", "link": "https://stackoverflow.com/users/8440657/walrfi"}, "edited": false, "score": 0, "creation_date": 1562791287, "post_id": 56977960, "comment_id": 100492685, "body": "Thanks for the reply. I actually use v0 for another returning value. I need to increase var5 inside the mips function. I&#39;m new to mips, I tried this:  addiu t1, sp, 16 ; addiu t2, t1, INCREASE_POINTER_VALUE;  sw t2, 0(t1)  but the value of the pointer does not get modify. Not sure how else I can do it"}, {"owner": {"reputation": 71, "user_id": 8440657, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c0c54df687648b253c2bf6ce2c36612e?s=128&d=identicon&r=PG&f=1", "display_name": "Walrfi", "link": "https://stackoverflow.com/users/8440657/walrfi"}, "edited": false, "score": 0, "creation_date": 1562791389, "post_id": 56977960, "comment_id": 100492739, "body": "Ok, thanks hyde. Then I could move var5 to any of the first 4 arguments and would get passed by reference?"}, {"owner": {"reputation": 8506, "user_id": 10808674, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j1tGB.jpg?s=128&g=1", "display_name": "Alain Merigot", "link": "https://stackoverflow.com/users/10808674/alain-merigot"}, "edited": false, "score": 0, "creation_date": 1562795242, "post_id": 56977960, "comment_id": 100494036, "body": "The passing mechanism does not change with the position of the parameter (fortunately). In C, <i>all</i> is passed by value. If you want to modify something, pass a pointer to it and modify what is pointed by it. In C, this requires the use of the <code>*</code> operator. In MIPS, if a pointer is in a register, you must load the content of the pointer (with <code>lw</code>) in a reg, modify it and store it back (with <code>sw</code>). If the pointer is stored in the stack (5th arg), there is an extra <code>lw</code> to store the pointer in a register, but after that, the mechanism is unchanged."}, {"owner": {"reputation": 71, "user_id": 8440657, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c0c54df687648b253c2bf6ce2c36612e?s=128&d=identicon&r=PG&f=1", "display_name": "Walrfi", "link": "https://stackoverflow.com/users/8440657/walrfi"}, "edited": false, "score": 0, "creation_date": 1562846648, "post_id": 56977960, "comment_id": 100512040, "body": "Thanks Alain. Sorry I think I haven&#39;t explained myself correctly, I don&#39;t want to change the content the pointer is &quot;pointing at&quot;, that I can do, I want to change the address of the pointer. In C that would be ++var5 and then the pointer would now point at the original address +(sizeof var5 type) while keeping the content those pointers point at unchanged."}, {"owner": {"reputation": 71, "user_id": 8440657, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c0c54df687648b253c2bf6ce2c36612e?s=128&d=identicon&r=PG&f=1", "display_name": "Walrfi", "link": "https://stackoverflow.com/users/8440657/walrfi"}, "edited": false, "score": 0, "creation_date": 1562849119, "post_id": 56977960, "comment_id": 100513628, "body": "nevermind, I was passing the first argument as pointer, instead of pointer to pointer... duh"}], "owner": {"reputation": 71, "user_id": 8440657, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c0c54df687648b253c2bf6ce2c36612e?s=128&d=identicon&r=PG&f=1", "display_name": "Walrfi", "link": "https://stackoverflow.com/users/8440657/walrfi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 108, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1562789520, "creation_date": 1562789520, "question_id": 56977960, "link": "https://stackoverflow.com/questions/56977960/modifying-value-of-5th-argument-from-mips-to-c", "title": "Modifying value of 5th argument from MIPS to C", "body": "<p>Assuming you have a function in MIPs that is called from C like this:</p>\n\n<pre><code>extern int test(int *var1, int *var1, int *var3, int *var4, int *var5);\n</code></pre>\n\n<p>Is it possible in MIPS to increase the value of the pointer *var5 (in C: ++var5) and return it to C (not using the $v0, $v1 registers, they are used for something else)?</p>\n"}, {"tags": ["c", "arrays", "linked-list"], "comments": [{"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1562789662, "post_id": 56977942, "comment_id": 100492043, "body": "Your function should retutn a <i>pointer</i>. It is defined to return a <i>node</i>, and in practice, it returns <i>nothing</i>."}], "answers": [{"comments": [{"owner": {"reputation": 157, "user_id": 7654532, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b0a0a27b8314cff7b82c67e9a5e32f2?s=128&d=identicon&r=PG&f=1", "display_name": "shiv", "link": "https://stackoverflow.com/users/7654532/shiv"}, "edited": false, "score": 0, "creation_date": 1562790596, "post_id": 56978094, "comment_id": 100492415, "body": "Thank you! I like the creative solution. Also, could you also pinpoint what went wrong in my code? It&#39;s probably around the time where I declare ListNode temp but I can&#39;t figure out how to fix it."}], "tags": [], "owner": {"reputation": 5360, "user_id": 9435815, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xaQWU.jpg?s=128&g=1", "display_name": "r3mus n0x", "link": "https://stackoverflow.com/users/9435815/r3mus-n0x"}, "is_accepted": true, "score": 4, "last_activity_date": 1562791369, "last_edit_date": 1562791369, "creation_date": 1562790126, "answer_id": 56978094, "question_id": 56977942, "link": "https://stackoverflow.com/questions/56977942/array-to-linked-list-function-in-c-how-to-iterate-over-list-to-attach-the-node/56978094#56978094", "title": "array to linked list function in C; how to iterate over list to attach the node?", "body": "<p>You won't have to iterate over the list at all if you do it backwards:</p>\n\n<pre><code>struct ListNode* populateLinkedList(int arr[], int arraysize) {\n    struct ListNode* head = NULL;\n    for (int i = arraysize; i &gt; 0; i--) {\n        struct ListNode* tempNodePtr = (struct ListNode*) malloc(sizeof(*tempNodePtr));\n        tempNodePtr-&gt;data = arr[i - 1];\n        tempNodePtr-&gt;next = head;\n        head = tempNodePtr;\n    }\n    return head;\n}\n</code></pre>\n\n<p>As you can see this is a lot simpler because there are no checks since you always replace the <code>head</code> and there's no need to iterate over already inserted elements so it's also more efficient.\n<hr/>\nAs for what's wrong with your solution:</p>\n\n<pre><code>struct ListNode* temp = *node-&gt;next;\n//                      ^~~~~~~~~~~\n// you definitely shouldn't dereferrence anything here\n\n// This condition is wrong because when you exit the loop \"temp\" will be NULL\nwhile (temp!=NULL) {\n    temp = temp-&gt;next;\n}\ntemp-&gt;next = tempNodePtr;\nnode-&gt;next = temp; // &lt;-- this is definitely not needed\n</code></pre>\n\n<p>So your code should've been something like this:</p>\n\n<pre><code>struct ListNode* temp = node;\nwhile (temp-&gt;next != NULL) {\n    temp = temp-&gt;next;\n}\ntemp-&gt;next = tempNodePtr;\n</code></pre>\n"}], "owner": {"reputation": 157, "user_id": 7654532, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b0a0a27b8314cff7b82c67e9a5e32f2?s=128&d=identicon&r=PG&f=1", "display_name": "shiv", "link": "https://stackoverflow.com/users/7654532/shiv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 198, "favorite_count": 0, "accepted_answer_id": 56978094, "answer_count": 1, "score": 1, "last_activity_date": 1562791369, "creation_date": 1562789414, "last_edit_date": 1562790298, "question_id": 56977942, "link": "https://stackoverflow.com/questions/56977942/array-to-linked-list-function-in-c-how-to-iterate-over-list-to-attach-the-node", "title": "array to linked list function in C; how to iterate over list to attach the node?", "body": "<p>I am constructing some code that would basically take in an arrray, and return a linked list in the same order. I'm stuck in a conditional with no way out. How to attach the temp to node? I know I have to traverse by ->next till its not null but I can't figure out how.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n#include &lt;stdbool.h&gt;\n\n\nstruct ListNode{\n\n    int data;\n    struct ListNode* next;\n\n};\n\nstruct ListNode populateLinkedList(int arr[], int arraysize){\n    struct ListNode* head = NULL;\n    struct ListNode* lastNodePtr = NULL;\n    struct ListNode* node = NULL;\n\n    for(int i=0; i&lt;arraysize; i++){\n\n        struct ListNode* tempNodePtr = (struct ListNode*) malloc(sizeof(struct ListNode));\n        tempNodePtr-&gt;data = arr[i];\n        tempNodePtr-&gt;next = NULL;\n\n        //if header is empty assign new node to header\n        if(head==NULL) {\n            head = tempNodePtr;\n        }\n            //if the temp node is empty assign new node to temp node\n        else if(node==NULL) {\n            node = tempNodePtr;\n        }\n            //if both header and temp node are not empty, attach the temp to node. This is where I get an error.\n        else {\n            struct ListNode* temp = *node-&gt;next;\n            while (temp!=NULL){\n                temp = temp-&gt;next;\n            }\n            temp-&gt;next = tempNodePtr;\n            node-&gt;next = temp;\n\n        }\n    }\n\n    //connect head with nodes after index 0\n    head-&gt;next = node;\n    return head\n}\n\nint main() {\n    printf(\"Entering program 2\\n\");\n\n    int array[] = {5,8,2,4,12,97,25,66};\n    int arraysize = (int)( sizeof(array) / sizeof(array[0]));\n    printf(\"mainSize: %d \\n\", arraysize);\n\n    populateLinkedList(array, arraysize);\n    return 0;\n} \n</code></pre>\n"}, {"tags": ["c", "language-lawyer"], "comments": [{"owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 4, "creation_date": 1562786614, "post_id": 56977340, "comment_id": 100490849, "body": "I don&#39;t take that as saying that the two can exist in a program. Rather, I&#39;d interpret that as saying that the stdint ones don&#39;t exist on sign-and-magnitude representation."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 2, "creation_date": 1562787258, "post_id": 56977340, "comment_id": 100491087, "body": "How could the compiler not know the binary representation of <code>int</code>?"}, {"owner": {"reputation": 1233, "user_id": 2614160, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7e0c3e2e0d321d8ae7c6cf34caa8e363?s=128&d=identicon&r=PG", "display_name": "Jan", "link": "https://stackoverflow.com/users/2614160/jan"}, "edited": false, "score": 1, "creation_date": 1562787623, "post_id": 56977340, "comment_id": 100491235, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/18112109/can-a-int16-t-to-int-conversation-result-in-implementation-defined-behavior\">Can a int16_t to int conversation result in implementation-defined behavior?</a>"}, {"owner": {"reputation": 8402, "user_id": 4664415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hsfxj.jpg?s=128&g=1", "display_name": "mevets", "link": "https://stackoverflow.com/users/4664415/mevets"}, "edited": false, "score": 1, "creation_date": 1562787816, "post_id": 56977340, "comment_id": 100491322, "body": "In that case, the compiler would have to know both formats, and generate whatever intermediate code was required to work between them.   It isn\u2019t incredibly different from supporting floats on a machine with no floating point hardware (eg. z80, 6809, 68000).   Standards are not intended to hold up to such a level of scrutiny; they are guidelines."}, {"owner": {"reputation": 3510, "user_id": 2162550, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f74689baa9af8a44163fa395c457212f?s=128&d=identicon&r=PG", "display_name": "user2162550", "link": "https://stackoverflow.com/users/2162550/user2162550"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1562789559, "post_id": 56977340, "comment_id": 100491996, "body": "@melpomene does the compiler must know the <code>int</code> representation in a specific  machine in order to construct a conforming program? I don&#39;t think so, but I&#39;m not 100% certain"}, {"owner": {"reputation": 2216, "user_id": 9585016, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Language Lawyer", "link": "https://stackoverflow.com/users/9585016/language-lawyer"}, "edited": false, "score": 0, "creation_date": 1562792182, "post_id": 56977340, "comment_id": 100493051, "body": "1s&#39;, not 1&#39;s..."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1562805909, "post_id": 56977340, "comment_id": 100496301, "body": "@user2162550: It is not technically necessary for a compiler to know what representation a machine uses for integers in order to be part of a conforming C implementation. It could provide C semantics for <code>int</code> by emulating them. In other words, it could implement <code>int</code> by manipulating bits itself instead of by using machine instructions such as <code>add</code> or <code>neg</code>."}], "answers": [{"comments": [{"owner": {"reputation": 5101, "user_id": 700170, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gZ8hw.png?s=128&g=1", "display_name": "Morten Jensen", "link": "https://stackoverflow.com/users/700170/morten-jensen"}, "edited": false, "score": 1, "creation_date": 1562788333, "post_id": 56977554, "comment_id": 100491554, "body": "Honest question: Are you 100% sure about this? I was under the impression that C99 requires the compiler to define/support <code>int{8,16,32}_t</code> and <code>uint{8,16,32}_t</code> in <code>&lt;stdint.h&gt;</code>. EDIT: thank you for reference/clarification"}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "reply_to_user": {"reputation": 5101, "user_id": 700170, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gZ8hw.png?s=128&g=1", "display_name": "Morten Jensen", "link": "https://stackoverflow.com/users/700170/morten-jensen"}, "edited": false, "score": 0, "creation_date": 1562789019, "post_id": 56977554, "comment_id": 100491816, "body": "@MortenJensen Positive.  See my edit.  The <code>int_fastN_t</code> and <code>int_leastN_t</code> types are required, but not the exact-width types.  If you had an architecture where <code>CHAR_BIT = 9</code>, you wouldn&#39;t have any native 8,16,32,64 bit types, but rather 9,18,36,and 72 bit types.  Worth noting that the least/fast types that <i>are</i> required don&#39;t come with the constraint that they must be two&#39;s complement."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1563310172, "post_id": 56977554, "comment_id": 100655539, "body": "A C99 or C11 compiler could theoretically exist for a platform that isn&#39;t two&#39;s-complement, but any almost any realistically-imaginable practical platform that could efficiently support <code>uint_least64_t</code> would be able to efficiently support two&#39;s-complement math.  Making two&#39;s-complement optional would make sense if and only if <code>uint_least64_t</code> and <code>unsigned long long</code> were likewise."}], "tags": [], "owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "is_accepted": true, "score": 3, "last_activity_date": 1563140684, "last_edit_date": 1563140684, "creation_date": 1562787495, "answer_id": 56977554, "question_id": 56977340, "link": "https://stackoverflow.com/questions/56977340/program-with-two-different-binary-representations-for-signed-integers/56977554#56977554", "title": "Program with two different binary representations for signed integers", "body": "<p><code>int32_t</code> is not guaranteed to exist on a given platform.  Presumably, if you had a non twos-complement architecture, <code>int32_t</code> would not be defined.</p>\n\n<p>From 7.20.1.1 of the standard describing exact-width integers:</p>\n\n<blockquote>\n  <p>The typedef name intN_t designates a signed integer type with width N, no padding bits, and a two\u2019s complement representation. Thus, int8_t denotes such a signed integer type with a width of exactly 8 bits.</p>\n  \n  <p>The  typedef  name uintN_t designates  an  unsigned  integer  type  with  width N and  no padding  bits.  Thus, uint24_t denotes  such  an  unsigned  integer  type  with  a  width  of\n  exactly 24 bits.</p>\n  \n  <p><strong>These types are optional.</strong> However, if an implementation provides integer types with widths of 8, 16, 32, or 64 bits, no padding bits, and (for the signed types) that have a two\u2019s complement representation, it shall define the corresponding typedef names.</p>\n</blockquote>\n\n<p>If, for whatever reason, a machine with sign-and-magnitude or ones-complement architecture was to be created and a compiler adapted for it, and that compiler decided it would choose to create the option exact-width types, the compiler writer would find themselves having to convert the exact-width integers to native integral types whenever they wanted to perform arithmetic on them and then convert back to store in the variable.  It could be particularly troublesome since two's complement can represent a wider range of values than sign-and-magnitude and one's complement.</p>\n\n<p>tl;dr: A compiler could <em>possibly</em> make an implementation of exact-width integers on a platform that is not two's complement, but nobody would actually bother to do so because they're optional and the implementation would be rather inefficient.</p>\n"}, {"tags": [], "owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "is_accepted": false, "score": 2, "last_activity_date": 1562787868, "last_edit_date": 1562787868, "creation_date": 1562787532, "answer_id": 56977562, "question_id": 56977340, "link": "https://stackoverflow.com/questions/56977340/program-with-two-different-binary-representations-for-signed-integers/56977562#56977562", "title": "Program with two different binary representations for signed integers", "body": "<p>Even if a compiler would use two different ways of representing integers, the compiler would still know how to compare them or how to use them in calculations.<br>\nThis is guaranteed by the compiler having to obey the corresponding other parts of the standard, i.e. it is defined how the resulting behaviour of a comparison or a calculation should be. </p>\n\n<p>The C standard leaves many implementation details open, in order to allow creation of efficient compilers. The resulting behaviour however is defined and the implementation details, which are of course know to the compiler, cannot change that. Two different integer representations would usually result in a more complex method to use them together, i.e. it probably is avoided by compiler suppliers.</p>\n"}], "owner": {"reputation": 3510, "user_id": 2162550, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f74689baa9af8a44163fa395c457212f?s=128&d=identicon&r=PG", "display_name": "user2162550", "link": "https://stackoverflow.com/users/2162550/user2162550"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "accepted_answer_id": 56977554, "answer_count": 2, "score": 2, "last_activity_date": 1563140684, "creation_date": 1562786469, "last_edit_date": 1562786715, "question_id": 56977340, "link": "https://stackoverflow.com/questions/56977340/program-with-two-different-binary-representations-for-signed-integers", "title": "Program with two different binary representations for signed integers", "body": "<p>From standard, regarding fixed-width data types:</p>\n\n<blockquote>\n  <p>[7.20.1.1 Exact-width integer types] The typedef name intN_t\n  designates a signed integer type with width N , no padding bits, and a\n  <strong>two's complement representation</strong></p>\n</blockquote>\n\n<p>Also from the standard [6.2.6.2 Integer types] a number can be represented by <strong>sign-and-magnitude, 1's complement or 2's complement</strong>.</p>\n\n<p>So according to standard we can have a program with <code>int32_t</code> in 2's complement representation, and <code>int</code> with, let's say 1's complement representation. Now, what will happen if we compare them? or perform arithmetics with both of them? integer promotion rules will take place but how will the compiler (who does not know the <code>int</code> binary representation of the machine) compose the result given two different representations?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1562785594, "post_id": 56977127, "comment_id": 100490434, "body": "Your <code>argv</code> argument is of the wrong type."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1562785730, "post_id": 56977127, "comment_id": 100490481, "body": "<a href=\"https://pubs.opengroup.org/onlinepubs/9699919799/functions/getline.html\" rel=\"nofollow noreferrer\">Read the <code>getline()</code> documentation</a>:  &quot;The application shall ensure that <code>*lineptr</code> is a valid argument that could be passed to the <code>free()</code> function.&quot;.  Your code is a <code>SIGSEGV</code> waiting to happen."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1562785738, "post_id": 56977127, "comment_id": 100490483, "body": "As for the error, you&#39;re supposed to pass a pointer to a pointer variable (that is either pointing to some dynamically allocated memory, or is initialized to <code>NULL</code>)."}], "answers": [{"tags": [], "owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "is_accepted": true, "score": 4, "last_activity_date": 1562789305, "last_edit_date": 1562789305, "creation_date": 1562785997, "answer_id": 56977234, "question_id": 56977127, "link": "https://stackoverflow.com/questions/56977127/incompatible-pointer-types-passing-char-128-to-parameter-of-type-char/56977234#56977234", "title": "incompatible pointer types passing &#39;char (*)[128]&#39; to parameter of type &#39;char **&#39;", "body": "<p><code>getline</code> will allocate a buffer for you (that you should free when you are finished with it).  Instead of passing it a pointer to a statically allocated buffer, just pass it a pointer to a <code>char *</code>.  If the pointer is NULL, it'll allocate a new buffer and point you to it.  Changing <code>char line[128];</code> to <code>char *line = NULL;</code> should do the trick; just remember to free it when you're done with it.</p>\n\n<p>From the man page:</p>\n\n<blockquote>\n  <p>If *lineptr is NULL, then getline() will allocate a buffer for storing the line, which should be freed by the user program.  (In this case, the value in *n is ignored.)</p>\n  \n  <p>Alternatively,  before  calling  getline(), *lineptr can contain a pointer to a malloc(3)-allocated buffer *n bytes in size.  If the buffer is not large enough to hold the line, getline() resizes it with realloc(3), updating\n         *lineptr and *n as necessary.</p>\n  \n  <p>In either case, on a successful call, *lineptr and *n will be updated to reflect the buffer address and allocated size respectively.</p>\n</blockquote>\n\n<p>How it might look in your example <code>main</code> function:</p>\n\n<pre><code>int main(int argc, char **argv) \n{\n    char *line = NULL;\n    size_t n;\n\n    FILE *fp = fopen(argv[1], \"r\");\n    if (NULL == fp)\n    {\n        log_error(\"%d. %s\", errno, strerror(errno));\n        exit(EXIT_FAILURE);\n    }\n\n    while(-1 != getline(&amp;line, &amp;n, fp))\n    {\n        // do something\n    }\n    free(line);\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 3198, "user_id": 1636521, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/2116626f42d8a2f87ee420ecefb1ec0c?s=128&d=identicon&r=PG", "display_name": "flashburn", "link": "https://stackoverflow.com/users/1636521/flashburn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 679, "favorite_count": 0, "accepted_answer_id": 56977234, "answer_count": 1, "score": 0, "last_activity_date": 1562789305, "creation_date": 1562785435, "last_edit_date": 1562785929, "question_id": 56977127, "link": "https://stackoverflow.com/questions/56977127/incompatible-pointer-types-passing-char-128-to-parameter-of-type-char", "title": "incompatible pointer types passing &#39;char (*)[128]&#39; to parameter of type &#39;char **&#39;", "body": "<p>I can't figure out why does the following code generates this error:</p>\n\n<p><code>incompatible pointer types passing 'char (*)[128]' to parameter of type 'char **'</code></p>\n\n<pre><code>int main(int argc, char *argv) \n{\n    char line[128];\n    size_t n;\n\n    FILE *fp = fopen(argv[1], \"r\");\n    if (NULL == fp)\n    {\n        log_error(\"%d. %s\", errno, strerror(errno));\n        exit(EXIT_FAILURE);\n    }\n\n    while(-1 != getline(&amp;line, &amp;n, fp))\n    {\n        // do something\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>The error is generated by the following line <code>-1 != getline(&amp;line, &amp;n, fp)</code> Here is the prototype for <code>getline,</code></p>\n\n<pre><code>ssize_t getline(char **lineptr, size_t *n, FILE *stream);\n</code></pre>\n\n<p>What am I doing wrong?</p>\n"}, {"tags": ["c", "elf"], "comments": [{"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1562787019, "post_id": 56977107, "comment_id": 100491000, "body": "This looks on purpose. If the array has more then one element, gcc inserts NULL when concatenating sections, see <a href=\"https://onlinegdb.com/SJIc2nmZr\" rel=\"nofollow noreferrer\">this source</a>. This makes __libc_csu_init jump to NULL."}, {"owner": {"reputation": 741, "user_id": 5852134, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/akGlF.jpg?s=128&g=1", "display_name": "Viktor Khristenko", "link": "https://stackoverflow.com/users/5852134/viktor-khristenko"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1562787333, "post_id": 56977107, "comment_id": 100491112, "body": "regarding NULL it&#39;s clear, but you do not insert that into <code>.init&#47;fini\\_array</code>. the answer regarding alignment was correct 100%."}], "answers": [{"comments": [{"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1562787282, "post_id": 56977449, "comment_id": 100491100, "body": "Och, wow, <a href=\"https://onlinegdb.com/Sy9ap2XWr\" rel=\"nofollow noreferrer\">it works</a>. With current C you rather should <code>aligned(_Alignof(void*))</code>."}], "tags": [], "owner": {"reputation": 2385, "user_id": 10306503, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31c5d6c9b08dd045f4876591d703bda6?s=128&d=identicon&r=PG", "display_name": "mosvy", "link": "https://stackoverflow.com/users/10306503/mosvy"}, "is_accepted": true, "score": 2, "last_activity_date": 1562791338, "last_edit_date": 1562791338, "creation_date": 1562787029, "answer_id": 56977449, "question_id": 56977107, "link": "https://stackoverflow.com/questions/56977107/segmentation-fault-using-init-array-section/56977449#56977449", "title": "Segmentation fault using .init_array section", "body": "<p>The <code>init_array</code> should be aligned to size of a pointer; if you change that to:</p>\n\n<pre><code>__attribute__((section(\".init_array\"), aligned(sizeof (void*)))) init init_arr[2] = {another_init1, another_init2};\n</code></pre>\n\n<p>it will work.</p>\n\n<p>If not (at least on x86-64) <code>gcc</code> will align your array to a 16 bytes boundary, creating a 8 bytes gap in the <code>.init_array</code> section between the 3 function pointers already there (<code>frame_dummy</code> + your <code>init1</code> and <code>init2</code>) and the 2 new functions, which will appear to the dynamic linker as a <code>NULL</code> pointer.</p>\n"}], "owner": {"reputation": 741, "user_id": 5852134, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/akGlF.jpg?s=128&g=1", "display_name": "Viktor Khristenko", "link": "https://stackoverflow.com/users/5852134/viktor-khristenko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 164, "favorite_count": 0, "accepted_answer_id": 56977449, "answer_count": 1, "score": 0, "last_activity_date": 1562791338, "creation_date": 1562785360, "question_id": 56977107, "link": "https://stackoverflow.com/questions/56977107/segmentation-fault-using-init-array-section", "title": "Segmentation fault using .init_array section", "body": "<p>I'm learning <strong>ELF</strong> a bit and ran into a strange seg fault</p>\n\n<p>code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdint.h&gt;\n\n__attribute__((constructor(102))) static void init1() {\n    printf(\"%s\\n\", __FUNCTION__);\n}\n\n__attribute__((constructor(101))) static void init2() {\n    printf(\"%s\\n\", __FUNCTION__);\n}\n\nvoid another_init1() {\n    printf(\"%s\\n\", __FUNCTION__);\n}\n\nvoid another_init2() {\n    printf(\"%s\\n\", __FUNCTION__);\n}\n\ntypedef void (*init)();\n__attribute__((section(\".init_array\"))) init init_arr[2] = {another_init1, another_init2};\n\nstatic void my_function_1() {}\n\nint main() {\n    printf(\"hello world\\n\");\n    return 0;\n}\n</code></pre>\n\n<p>compiling this with <code>gcc -o hello hello.c</code> and running <code>./hello</code> I see </p>\n\n<pre><code>[root@20f890034489 ch5]# ./hello \ninit2\ninit1\nSegmentation fault\n</code></pre>\n\n<p>this is coming from the <em>.init_arr</em>. If I make this array contain a single function ptr, everything works as expected, but with 2 ptrs in there, it seg faults.</p>\n\n<p>Any suggestion? Just find this strange</p>\n\n<p>VK</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1562785662, "post_id": 56977030, "comment_id": 100490451, "body": "What happened when you tried <code>ss</code>, <code>ss+1</code> and <code>ss+2</code>?"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 3, "creation_date": 1562786251, "post_id": 56977030, "comment_id": 100490693, "body": "It depends on what <code>ss</code> is actually declared as.  If it is a <code>char[]</code> or <code>char*</code>, then the <code>+1</code> is performing pointer arithmetic, the result of which is equivilent to doing <code>&amp;ss[1]</code> instead."}, {"owner": {"reputation": 657, "user_id": 1258571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42e9eb313ff66930b0196ea969337010?s=128&d=identicon&r=PG", "display_name": "SolutionMill", "link": "https://stackoverflow.com/users/1258571/solutionmill"}, "edited": false, "score": 0, "creation_date": 1562787650, "post_id": 56977030, "comment_id": 100491248, "body": "Could you please add declaration of <code>ss</code> to your post?"}], "answers": [{"tags": [], "owner": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "is_accepted": false, "score": 0, "last_activity_date": 1562785155, "creation_date": 1562785155, "answer_id": 56977066, "question_id": 56977030, "link": "https://stackoverflow.com/questions/56977030/what-ss1-means-in-scanfs-ss1/56977066#56977066", "title": "what &quot;ss+1&quot; means in scanf(&quot;%s&quot;, ss+1)?", "body": "<p>It simply skips the first character of the string.</p>\n"}, {"tags": [], "owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "is_accepted": true, "score": 4, "last_activity_date": 1562812278, "last_edit_date": 1562812278, "creation_date": 1562808751, "answer_id": 56980543, "question_id": 56977030, "link": "https://stackoverflow.com/questions/56977030/what-ss1-means-in-scanfs-ss1/56980543#56980543", "title": "what &quot;ss+1&quot; means in scanf(&quot;%s&quot;, ss+1)?", "body": "<p>Suppose you have this array:</p>\n\n<pre><code>char a[10];\n</code></pre>\n\n<p>We can imagine it looks like this:</p>\n\n<pre><code>   +---+---+---+---+---+---+---+---+---+---+\na: |   |   |   |   |   |   |   |   |   |   |\n   +---+---+---+---+---+---+---+---+---+---+\n</code></pre>\n\n<p>Suppose you call <code>scanf</code> to read a string into the array:</p>\n\n<pre><code>scanf(\"%s\", a);\n</code></pre>\n\n<p>Suppose you type \"hello\".  The array is filled in like this:</p>\n\n<pre><code>   +---+---+---+---+---+---+---+---+---+---+\na: | h | e | l | l | o |\\0 |   |   |   |   |\n   +---+---+---+---+---+---+---+---+---+---+\n</code></pre>\n\n<p>Suppose you set up a pointer pointing to an array, and pass that pointer to <code>scanf</code>:</p>\n\n<pre><code>char b[10];\nchar *p = b;\n\nscanf(\"%s\", p);\n</code></pre>\n\n<p>Now exactly the same thing happens: <code>p</code> points to the beginning of the string, so that's where <code>scanf</code> stores the string it reads:</p>\n\n<pre><code>       +---+---+---+---+---+---+---+---+---+---+\n    b: | h | e | l | l | o |\\0 |   |   |   |   |\n       +---+---+---+---+---+---+---+---+---+---+\n         ^\n   +-----|-----+\np: |     *     |\n   +-----------+\n</code></pre>\n\n<p>Finally, suppose we have another array and another pointer, but instead of passing the pointer to <code>scanf</code>, we add 1 to the pointer before passing it to <code>scanf</code>:</p>\n\n<pre><code>char c[10];\nchar *ss = c;\n\nscanf(\"%s\", ss + 1);\n</code></pre>\n\n<p>Now <code>scanf</code> receives a pointer to the <em>second</em> cell in the array, so that's where it writes the string:</p>\n\n<pre><code>        +---+---+---+---+---+---+---+---+---+---+\n     c: |   | h | e | l | l | o |\\0 |   |   |   |\n        +---+---+---+---+---+---+---+---+---+---+\n          ^\n    +-----|-----+\nss: |     *     |\n    +-----------+\n</code></pre>\n\n<p>This is a little confusing.  It's easier to see if we do the addition off to the side.  It's also easier to see if we pre-fill the array with some other characters:</p>\n\n<pre><code>char d[10] = \"rstuvwxyz\";\n</code></pre>\n\n<p>So initially <code>d</code> looks like this:</p>\n\n<pre><code>        +---+---+---+---+---+---+---+---+---+---+\n     d: | r | s | t | u | v | w | x | y | z |\\0 |\n        +---+---+---+---+---+---+---+---+---+---+\n</code></pre>\n\n<p>Now if we do this, and type \"hello\" again:</p>\n\n<pre><code>char *p1 = d;\nchar *p2 = p1 + 1;\n\nscanf(\"%s\", p2);\n</code></pre>\n\n<p>we end up with a picture that looks like this:</p>\n\n<pre><code>    +-----------+\np1: |     *     |\n    +-----|-----+\n          |\n          v\n        +---+---+---+---+---+---+---+---+---+---+\n     d: | r | h | e | l | l | o |\\0 | y | z |\\0 |\n        +---+---+---+---+---+---+---+---+---+---+\n              ^\n        +-----|-----+\n    p2: |     *     |\n        +-----------+\n</code></pre>\n\n<p><code>scanf</code> reads to where <code>p2</code> points, which is one past where <code>p1</code> points, which is to the beginning of array <code>d</code>.</p>\n\n<p>If you want to confirm what's going on, you can do <code>printf(\"%s\\n\", d)</code>.\nIf you do that before the <code>scanf</code> call it should print <code>rstuvwxyz</code>, and if you do it after the <code>scanf</code> call (and if you continue to type \"hello\") it should print <code>rhello</code>.</p>\n\n<p>This may all look rather mysterious at first, but it's a straightforward application of <em>pointer arithmetic</em>.  (There's also some slight magic going on when I say things like <code>p = b</code>, where <code>p</code> is a pointer and <code>b</code> is an array, and the pointer ends up pointing to the first character of the array.  That's a hugely important special rule in C, which you'll want to learn about at some point pretty soon.)</p>\n\n<p>There's also another big question unanswered, namely <em>why</em> someone would want to write the code this way.  That's harder to explain.  One possibility I can imagine is that it was part of a larger program, that for some reason was trying to store lots of strings into the same array, like this:</p>\n\n<pre><code>              +---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+\nlonger_array: | c | a | t |\\0 | d | o | g |\\0 | c | o | w |\\0 | b | e | a | r |\\0 |\n              +---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+\n</code></pre>\n\n<p>If in the larger program, the pointer <code>ss</code> points to the <code>\\0</code> a the end of the previous string that was read, then <code>ss + 1</code> is indeed the right place to start reading the next one.</p>\n\n<p>(But I'm speculating.  Without seeing the larger program, there's no way of knowing why it wanted to read into <code>ss + 1</code>.  Indeed it's an unusual thing to do.)</p>\n"}], "owner": {"reputation": 125, "user_id": 8695842, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-1ZobEkvsTzc/AAAAAAAAAAI/AAAAAAAAAEs/XxCxr2tjXTs/photo.jpg?sz=128", "display_name": "Adarsh Pandey", "link": "https://stackoverflow.com/users/8695842/adarsh-pandey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 402, "favorite_count": 0, "accepted_answer_id": 56980543, "answer_count": 2, "score": -3, "last_activity_date": 1562812278, "creation_date": 1562784981, "last_edit_date": 1562785035, "question_id": 56977030, "link": "https://stackoverflow.com/questions/56977030/what-ss1-means-in-scanfs-ss1", "title": "what &quot;ss+1&quot; means in scanf(&quot;%s&quot;, ss+1)?", "body": "<p>I want to know what do it means to put \"+1\" in</p>\n\n<pre><code>scanf(\"%s\", ss+1)\n</code></pre>\n\n<p>where ss is a string input.</p>\n\n<p>I was solving a question on codechef and when i tried to read some other solutions to get idea about other possible solutions/approaches i fond this in a code.</p>\n"}, {"tags": ["c", "loops", "io"], "comments": [{"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 3, "creation_date": 1562783700, "post_id": 56976576, "comment_id": 100489622, "body": "The simple assignment <code>temp = tok</code> is useless...it just copies the address of your buffer. What you really want is to allocate some memory for temp and strcpy() to it."}], "answers": [{"tags": [], "owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "is_accepted": true, "score": 1, "last_activity_date": 1562784092, "last_edit_date": 1562784092, "creation_date": 1562783524, "answer_id": 56976690, "question_id": 56976576, "link": "https://stackoverflow.com/questions/56976576/iterating-through-rows-in-a-file-and-comparing-with-the-previous-row/56976690#56976690", "title": "Iterating through rows in a file and comparing with the previous row", "body": "<p>Store the first token of the first line (\"Config\" in your example), and compare it against the next line. When you find a change, replace the stored token. Use a counter to count the changes (how many times you replaced the stored token).</p>\n\n<p>You were close, but the way you think you are copying the token to the temporary is not correct. An easy fix would be to use a fixed-size array for that temporary, and when you want to copy, use <a href=\"http://www.cplusplus.com/reference/cstring/strcpy/\" rel=\"nofollow noreferrer\"><code>strcpy()</code></a>.</p>\n\n<p>Full example:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main(void)\n{\n    FILE* fp;\n    const int sz = 256;\n    char buffer[sz], tmp[sz] = {0};\n\n    fp = fopen(\"file.txt\", \"r\");\n\n    int changes = 0;\n    while(fgets(buffer, sz, (FILE*) fp))\n    {\n        // Eat trailining newline of fgets()\n        if(buffer[strlen(buffer) - 1] == '\\n')\n            buffer[strlen(buffer) - 1] = '\\0';\n        const char* token = strtok(buffer, \",\");\n        if(strcmp(tmp, token) != 0)\n        {\n            strcpy(tmp, token);\n            changes++;\n        }\n    }\n    // changes - 1, because we always count the first line as a change\n    printf(\"Changes = %d\\n\", --changes);\n    fclose(fp);\n    return 0;\n}\n</code></pre>\n\n<p>Output:</p>\n\n<blockquote>\n  <p>Changes = 2</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 408, "user_id": 11762199, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SPIzL.jpg?s=128&g=1", "display_name": "mhrsalehi", "link": "https://stackoverflow.com/users/11762199/mhrsalehi"}, "is_accepted": false, "score": 0, "last_activity_date": 1562790786, "creation_date": 1562790786, "answer_id": 56978232, "question_id": 56976576, "link": "https://stackoverflow.com/questions/56976576/iterating-through-rows-in-a-file-and-comparing-with-the-previous-row/56978232#56978232", "title": "Iterating through rows in a file and comparing with the previous row", "body": "<p>you can also use <code>fscanf()</code> functions family, the code is much simpler and shorter! :</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main(){\n    FILE* file = fopen(\"data.txt\", \"r\");\n    char token[256];\n    char tmp[256];\n    int  read = -1;\n    int  n    = 0;\n\n    while (1){\n        read = fscanf(file, \"%[^,]\", token);\n        fscanf(file, \"%*[^\\n]\\n\");/*go to next line*/\n        if(read != 1)\n            break;\n        if(strcmp(token, tmp) != 0){\n            ++n;\n            strcpy(tmp, token);\n        }\n    }\n    fclose(file);\n    printf(\"n = %d\\n\", --n);\n    return 0;\n}\n</code></pre>\n\n<p>output : </p>\n\n<pre><code>n = 2\nProcess finished with exit code 0\n</code></pre>\n"}], "owner": {"reputation": 609, "user_id": 11171682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80b4b97bc5566dbe16f0e5f8eeaeb6d5?s=128&d=identicon&r=PG&f=1", "display_name": "hkj447", "link": "https://stackoverflow.com/users/11171682/hkj447"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 56976690, "answer_count": 2, "score": 1, "last_activity_date": 1562790786, "creation_date": 1562783029, "question_id": 56976576, "link": "https://stackoverflow.com/questions/56976576/iterating-through-rows-in-a-file-and-comparing-with-the-previous-row", "title": "Iterating through rows in a file and comparing with the previous row", "body": "<p>I would like to check if the first entry of the previous row is equivalent to the next row. Here is some of the data I am using:</p>\n\n<pre><code>Config,Prob,MAN,ATL,CVERT,TVERT,RIB,SCAP,PHUM,DHUM,PRAD,DRAD,CARP,PMC,DMC,PHX\nLH,1,2,2,7,13,13,2,2,2,1,1,6,2,2,24\nLH,1,0,0,0,0,9,1,2,2,2,2,12,2,2,18\nLH,3,0,0,0,0,4,0,0,0,0,0,0,0,0,0\nLH,1,0,0,0,13,24,2,2,2,2,2,12,2,2,24\nLH,1,0,0,1,13,15,2,0,0,2,2,0,0,0,6\nLH,1,0,0,0,0,10,0,1,1,0,0,0,0,0,18\nLH,1,0,2,7,3,7,2,2,2,2,2,12,2,2,24\nLH,1,0,0,2,0,14,1,2,2,2,2,0,0,0,18\nLK,1,0,0,0,0,13,0,0,0,1,1,6,0,0,0\nLK,1,2,2,7,13,17,1,0,0,0,0,0,0,0,6\nLK,1,0,0,0,10,23,1,1,1,1,1,6,1,1,18\nLK,1,2,2,7,0,18,2,0,0,1,1,12,2,2,24\nLK,1,0,0,3,0,8,0,0,0,2,2,12,2,2,24\nLK,1,2,2,7,0,8,0,0,0,2,2,12,2,2,24\nLK,3,2,2,7,13,22,2,2,2,2,2,12,2,2,24\nLK,1,2,2,7,0,2,0,0,0,0,0,0,0,0,0\nLK,1,2,2,6,0,11,0,2,2,0,0,12,2,2,18\n</code></pre>\n\n<p>So in this case, I would like to count all the times the first entry of row changes. In this data, that would be equivalent to two (From Config to LH, then from LH to LK). Here is my attempted code:</p>\n\n<pre><code>int agents = 0;\nint nrows = 0;\nchar buf[1024];\nchar *temp;\nconst char *tok;\n\nwhile (fgets(buf, 1024, ifp)){\n    tok = strtok(buf,\",\");\n    if(nrows&gt;0){\n        if(strcmp(temp,tok) != 0){\n            ++agents;\n        }\n    }\n\n    temp = tok;\n    nrows++;\n}\n</code></pre>\n\n<p>My logic was that we want to skip the first iteration since <code>temp</code> doesn't contain anything, but will get assigned after the loop is finished. The next time the loop starts, we get the next row assigned to <code>tok</code>, compare with <code>temp</code>, which has the previous row. If they are different, increment, if not, continue. Assign <code>temp</code> to <code>tok</code> and repeat again. However, <code>agents</code> still returns 0 after looping through. </p>\n\n<p>Therefore my logic is flawed, though I am not sure what part is. Any help is appreciated, thank you.</p>\n"}, {"tags": ["c", "arrays", "memory"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1562781925, "post_id": 56976285, "comment_id": 100488801, "body": "You should post an example."}, {"owner": {"reputation": 25637, "user_id": 6243352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/715f60f9edc65642a6805752cfeebb27?s=128&d=identicon&r=PG&f=1", "display_name": "ggorlen", "link": "https://stackoverflow.com/users/6243352/ggorlen"}, "edited": false, "score": 3, "creation_date": 1562782299, "post_id": 56976285, "comment_id": 100488983, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/21691924/why-must-i-provide-a-dimension-when-passing-a-two-dimensional-array-to-a-c-funct\">Why must I provide a dimension when passing a two-dimensional array to a C function?</a>"}, {"owner": {"reputation": 1422, "user_id": 4538770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adfd2f0b91001372439c7e23c60e4c52?s=128&d=identicon&r=PG", "display_name": "Jo&#235;l Hecht", "link": "https://stackoverflow.com/users/4538770/jo%c3%abl-hecht"}, "edited": false, "score": 0, "creation_date": 1562782300, "post_id": 56976285, "comment_id": 100488985, "body": "The compiler does not keep track of the first dimension, because it dos not need it to access a cell in the array. It only needs the second dimension, since the address of a (row,col) cell is : address of the array + row * nb columns + col. Where nb columns is you guessed the second dimension."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1562782967, "post_id": 56976285, "comment_id": 100489321, "body": "It&#39;s the same reason you don&#39;t have to specify the length of a 1-dimensional array argument."}, {"owner": {"reputation": 21, "user_id": 11724408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e3aa5a1774bf248ba51b6e352e7fadd?s=128&d=identicon&r=PG&f=1", "display_name": "parham", "link": "https://stackoverflow.com/users/11724408/parham"}, "reply_to_user": {"reputation": 1422, "user_id": 4538770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adfd2f0b91001372439c7e23c60e4c52?s=128&d=identicon&r=PG", "display_name": "Jo&#235;l Hecht", "link": "https://stackoverflow.com/users/4538770/jo%c3%abl-hecht"}, "edited": false, "score": 0, "creation_date": 1562783059, "post_id": 56976285, "comment_id": 100489361, "body": "@Jo&#235;lHecht How does the compiler know where the array ends then? if it doesn&#39;t then what happens when you try to read an out of range row?"}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 3, "creation_date": 1562784195, "post_id": 56976285, "comment_id": 100489867, "body": "(1) It doesn&#39;t know. (2) Chaos happens, so don&#39;t do that. It&#39;s your responsibility to ensure that."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1562784870, "post_id": 56976285, "comment_id": 100490125, "body": "@parham even if you provide a function with a length say <code>void func(char arr[100])</code> the <code>100</code> is ignored."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1562806748, "post_id": 56976285, "comment_id": 100496454, "body": "@WeatherVane: The <code>100</code> is evaluated and then discarded. For example, with Apple LLVM 10.0.1 and clang-1001.0.46.4, <code>#include &lt;stdio.h&gt;</code> / <code>void foo(char arr[printf(&quot;Hello, world.\\n&quot;)]) {}</code> / <code>int main(void) { foo(0); }</code> prints \u201cHello, world.\u201d Some compilers might not do this; the C standard is not clear, but I think Clang and GCC both do."}, {"owner": {"reputation": 4562, "user_id": 9254539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b45538511384660bfaef5092e30b7ea?s=128&d=identicon&r=PG&f=1", "display_name": "BessieTheCookie", "link": "https://stackoverflow.com/users/9254539/bessiethecookie"}, "edited": false, "score": 0, "creation_date": 1562807520, "post_id": 56976285, "comment_id": 100496580, "body": "In C, arrays don&#39;t check if indices are in bounds for you. If you access an out-of-bounds index, you get <a href=\"https://en.cppreference.com/w/c/language/behavior\" rel=\"nofollow noreferrer\">undefined behavior</a> which means the C standard doesn&#39;t restrict the behavior of your program at all, so anything can happen. Because the C standard and potentially your compiler doesn&#39;t care what UB does, weird things can happen. For example, reading past the end of an array may result in a garbage value or a segmentation fault among many other things especially if the compiler optimizes based on the assumption that UB never happens."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1562828564, "post_id": 56976285, "comment_id": 100502012, "body": "@EricPostpischil that&#39;s interesting, MSVC doesn&#39;t support variable length arrays and generates two errors for your function definition: <i>expected constant expression</i>, and <i>cannot allocate an array of constant size 0</i>. Defining as <code>void foo(char arr[0])</code> gives the second error. It&#39;s only happy with a non-0 length or <code>[]</code> none. I had thought that a VLA&#39;s length must be passed as another function argument, such as <code>void foo(int x, int a[][x]);</code> although maybe that&#39;s not the case for a 1-dimensional array, whose length isn&#39;t actually needed."}], "answers": [{"tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": true, "score": 2, "last_activity_date": 1562806565, "creation_date": 1562806565, "answer_id": 56980343, "question_id": 56976285, "link": "https://stackoverflow.com/questions/56976285/how-declaring-an-array-as-argument-doesnt-need-a-bound-for-the-1st-dimension/56980343#56980343", "title": "how declaring an array as argument doesn&#39;t need a bound for the 1st dimension?", "body": "<p>In general, the compiler does not keep track of the first dimension of an array argument/parameter. (If it does, this is an extension to what the C standard requires, possibly as part of a feature to provide bounds checking.) It is actually impossible to pass an array as an argument in C, and it is impossible for a routine to declare an array as a parameter.</p>\n\n<p>When a function parameter is declared as an array, it is automatically adjusted to be a pointer, per C 2018 6.7.6.3 7:</p>\n\n<blockquote>\n  <p>A declaration of a parameter as \u201carray of <em>type</em>\u201d shall be adjusted to \u201cqualified pointer to <em>type</em>\u201d, where the type qualifiers (if any) are those specified within the <code>[</code> and <code>]</code> of the array type derivation\u2026</p>\n</blockquote>\n\n<p>When an array is given as a function argument, it is automatically converted to a pointer to its first element, per C 2018 6.3.2.1 3:</p>\n\n<blockquote>\n  <p>Except when it is the operand of the <code>sizeof</code> operator, or the unary <code>&amp;</code> operator, or is a string literal used to initialize an array, an expression that has type \"array of <em>type</em>\" is converted to an expression with type \"pointer to <em>type</em>\" that points to the initial element of the array object\u2026</p>\n</blockquote>\n\n<p>Thus an array is never passed as an argument nor received as a parameter. Only pointers are passed.</p>\n\n<p>The C implementation never needs the length of the array to provide any standard C behavior. Suppose, for example, a parameter is declared as <code>int x[3][4]</code>. This is automatically adjusted to be <code>int (*x)[4]</code>. Then, if the code in the function uses <code>x[i][j]</code>, the C implementation needs to find that element in memory. It is <code>i*4+j</code> elements beyond where <code>x</code> points. The implementation needs the second dimension to do the calculation, because it has to increment by <code>i</code> subarrays to find element <code>x[i][j]</code>. Since it is increment by subarrays, it needs to know how big the subarrays are.</p>\n\n<p>However, the C implementation does not need to know how big the array is. No expression will require it to use the size of the array. So having just the pointer to the first element of the array is enough.</p>\n"}], "owner": {"reputation": 21, "user_id": 11724408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e3aa5a1774bf248ba51b6e352e7fadd?s=128&d=identicon&r=PG&f=1", "display_name": "parham", "link": "https://stackoverflow.com/users/11724408/parham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "accepted_answer_id": 56980343, "answer_count": 1, "score": 1, "last_activity_date": 1562910508, "creation_date": 1562781724, "last_edit_date": 1562910508, "question_id": 56976285, "link": "https://stackoverflow.com/questions/56976285/how-declaring-an-array-as-argument-doesnt-need-a-bound-for-the-1st-dimension", "title": "how declaring an array as argument doesn&#39;t need a bound for the 1st dimension?", "body": "<p>In C it's not possible to declare a 2D array as an argument without bounding the second dimension, while it's possible for the first dimension to have no bounds.\nI was wondering how does the compiler keeps track of the first dimension's length and why it doesn't do the same for further dimensions?</p>\n\n<p>As compiling the following code wouldn't work:</p>\n\n<pre><code>int func(int array[][]) {\n  return 0;\n}\n</code></pre>\n\n<p>and would yield </p>\n\n<pre><code>error: declaration of \u2018array\u2019 as multidimensional array must have bounds for all dimensions except the first\n</code></pre>\n"}, {"tags": ["java", "android", "c", "java-native-interface", "exit"], "comments": [{"owner": {"reputation": 77347, "user_id": 1631193, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c713494416ceac454d71c524e15f1c6?s=128&d=identicon&r=PG&f=1", "display_name": "Gabe Sechan", "link": "https://stackoverflow.com/users/1631193/gabe-sechan"}, "edited": false, "score": 0, "creation_date": 1562780936, "post_id": 56976010, "comment_id": 100488415, "body": "Your question isn&#39;t making sense to me.  exit kills the current process.  that isn&#39;t what you want to do with your library stop call-  you want to kill whatever you started up, not yourself.  Which we can&#39;t tell you how to do because we don&#39;t see how/what you started, but in any case you wouldn&#39;t call exit to do so."}, {"owner": {"reputation": 107, "user_id": 2268383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b3599f5b0629200d32f381257b362ea?s=128&d=identicon&r=PG", "display_name": "Mike", "link": "https://stackoverflow.com/users/2268383/mike"}, "reply_to_user": {"reputation": 77347, "user_id": 1631193, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c713494416ceac454d71c524e15f1c6?s=128&d=identicon&r=PG&f=1", "display_name": "Gabe Sechan", "link": "https://stackoverflow.com/users/1631193/gabe-sechan"}, "edited": false, "score": 0, "creation_date": 1562781007, "post_id": 56976010, "comment_id": 100488437, "body": "SO, what  would like to do is do everything exit() does manually. but not exit() the process. just cleaning up the resources."}, {"owner": {"reputation": 77347, "user_id": 1631193, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c713494416ceac454d71c524e15f1c6?s=128&d=identicon&r=PG&f=1", "display_name": "Gabe Sechan", "link": "https://stackoverflow.com/users/1631193/gabe-sechan"}, "edited": false, "score": 0, "creation_date": 1562781053, "post_id": 56976010, "comment_id": 100488452, "body": "exit normally does nothing except temrinate the current process.  It was never the right thing to do, although terminating the current process may have done what you wanted as a side effect."}, {"owner": {"reputation": 107, "user_id": 2268383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b3599f5b0629200d32f381257b362ea?s=128&d=identicon&r=PG", "display_name": "Mike", "link": "https://stackoverflow.com/users/2268383/mike"}, "reply_to_user": {"reputation": 77347, "user_id": 1631193, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c713494416ceac454d71c524e15f1c6?s=128&d=identicon&r=PG&f=1", "display_name": "Gabe Sechan", "link": "https://stackoverflow.com/users/1631193/gabe-sechan"}, "edited": false, "score": 0, "creation_date": 1562781280, "post_id": 56976010, "comment_id": 100488534, "body": "the above library doesn&#39;t run as a separate process but runs from a thread call. So, when I call exit() it is terminating the entire parent android application too. Is there any way to terminate the library without terminating my application? I dont think exit() abort() works. both terminate my parent process i.e my android application."}, {"owner": {"reputation": 77347, "user_id": 1631193, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c713494416ceac454d71c524e15f1c6?s=128&d=identicon&r=PG&f=1", "display_name": "Gabe Sechan", "link": "https://stackoverflow.com/users/1631193/gabe-sechan"}, "edited": false, "score": 0, "creation_date": 1562781406, "post_id": 56976010, "comment_id": 100488587, "body": "Just end the thread? Hard to answer what to do when I don&#39;t have the code of what you&#39;re actually doing. But it looks like your library assumed it was going to be always running as long as the app was, did you may have some rewriting to do around removing that assumption"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 77347, "user_id": 1631193, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c713494416ceac454d71c524e15f1c6?s=128&d=identicon&r=PG&f=1", "display_name": "Gabe Sechan", "link": "https://stackoverflow.com/users/1631193/gabe-sechan"}, "edited": false, "score": 0, "creation_date": 1562781878, "post_id": 56976010, "comment_id": 100488771, "body": "@GabeSechan: They are asking for a routine that performs only the clean-up functions (up to but not including process termination) of <code>exit</code> for a single thread: Close the files it opened, release memory it allocated, and so on. I doubt such a service exists. Files and other resources can be opened/allocated by one thread and handed off to another, so standard library routines would have no way of knowing what to close. The library must be designed to keep track of its own resources and provide its own routine to close/release them."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1562785399, "post_id": 56976010, "comment_id": 100490354, "body": "Your signal handler has serious issues.  You can only safely call async-signal-safe functions from within a signal handler.  I suspect none of your function calls are async-signal-safe.  I <b>know</b> <code>exit()</code> is <b>not</b> safe.  For a signal handler running inside a JVM or JVM-like process, correct implementation of a signal handler is especially critical."}], "owner": {"reputation": 107, "user_id": 2268383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b3599f5b0629200d32f381257b362ea?s=128&d=identicon&r=PG", "display_name": "Mike", "link": "https://stackoverflow.com/users/2268383/mike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 86, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1562780584, "creation_date": 1562780584, "question_id": 56976010, "link": "https://stackoverflow.com/questions/56976010/exiting-the-method-process-without-calling-exit-method", "title": "Exiting the method/process without calling exit() method", "body": "<p>I am writing an android application where I use a C code as a library through JNI. I start the library as a separate thread as shown below.</p>\n\n<pre><code>    public class LibraryHandler implements Runnable {\n        private static final String TAG = \"LibraryHandler\";\n        @Override\n        public void run() {\n                Log.w(TAG, \"Starting library\");\n                testJNILib.startlibrary();\n        Log.e(TAG, \"Bounced out of library Handler loop. Exiting....\");\n      }\n    }\n</code></pre>\n\n<p>and I stop the thread by interrupting it when my application closes and assign it to null. </p>\n\n<p>But the method doesnt library when the thread stops as it runs coitnuuosly and only stops when I terminate it manually using the \"stoplibary()\" call. But when I call the stoplibrary call, it calls exit() function and therefore shuts down the whole app. I want to stop only the library and not the entire process. I have to clean up all the resources so I just can't use return instead of exit(). CAn someone please let me know any approach that I can follow to clean up all the resources instead of exit. </p>\n\n<p>The \"startLibrary()\" &amp; \"stoplibrary()\" goes to the JNI as shown</p>\n\n<pre><code>    extern \"C\" JNIEXPORT jint JNICALL Java_com_test_android_client_testJNILib_startlibrary(JNIEnv * je, jclass jc)\n{\n   char *argv[] = {\"libproxyd\", \"-o\", \"unix:/data/data/com.adaranet.android.droidproxyclient2/files/proxy_db.sock\"};\n   int ret = start(3, argv);\n   return ret;\n}\n extern \"C\" JNIEXPORT jint JNICALL Java_com_test_android_client_testJNILib_stoplibrary(JNIEnv * je, jclass jc){\n   library_signal_handler(SIGTERM);\n   LOGE(\"CAlled library_signal_handler\");\n   return 1;\n}\n</code></pre>\n\n<p>The library_signal_handler() is as follows:</p>\n\n<pre><code>    void\n    library_signal_handler (int signo)\n{\n  int ret;\n  __android_log_print (ANDROID_LOG_ERROR, \"LIBRARY_MAIN\", \"Got signal %d \\n\", signo);\n  switch (signo) {\n case SIGTERM:\n    __android_log_print (ANDROID_LOG_INFO, \"LIBRARY_MAIN\", \"signal received sigterm\\n\");\n  delete_all_alias_interface(alias_count);\n  exit_stage_left();\n  exit (0);\n  break;\n</code></pre>\n\n<p>}</p>\n\n<p>Kindly let me know how to overcome this.</p>\n"}, {"tags": ["c", "sockets", "tcp", "client-server"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2191247"}, "edited": false, "score": 0, "creation_date": 1562780578, "post_id": 56975888, "comment_id": 100488266, "body": "It probably won&#39;t make a difference, but can you try <code>fsync(connfd)</code> after your second <code>write</code>? <code>fsync</code> shouldn&#39;t matter in your case, but just in case."}, {"owner": {"reputation": 48201, "user_id": 1250772, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/633e1f643d2c9b043231b4a32b078907?s=128&d=identicon&r=PG", "display_name": "Kaz", "link": "https://stackoverflow.com/users/1250772/kaz"}, "edited": false, "score": 0, "creation_date": 1562795448, "post_id": 56975888, "comment_id": 100494096, "body": "What do you achieve using <code>strcpy(sendBuff, chr_count1);  write(connfd, sendBuff, strlen(sendBuff));</code> over just <code>write(connfd, chr_count1, strlen(chr_count1))</code>?"}, {"owner": {"reputation": 48201, "user_id": 1250772, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/633e1f643d2c9b043231b4a32b078907?s=128&d=identicon&r=PG", "display_name": "Kaz", "link": "https://stackoverflow.com/users/1250772/kaz"}, "edited": false, "score": 0, "creation_date": 1562795539, "post_id": 56975888, "comment_id": 100494124, "body": "You could use <code>fdopen(connfd)</code> to obtain a <code>FILE *</code> <code>stdio</code> file handle for the connected socket; then just use <code>fprintf</code> to send output. The benefit is that the stream will do block buffering and call <code>write</code> in buffer-sized chunks."}, {"owner": {"reputation": 1, "user_id": 9959956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a98445b747e42533098c3045229c619?s=128&d=identicon&r=PG&f=1", "display_name": "dipin", "link": "https://stackoverflow.com/users/9959956/dipin"}, "reply_to_user": {"reputation": 48201, "user_id": 1250772, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/633e1f643d2c9b043231b4a32b078907?s=128&d=identicon&r=PG", "display_name": "Kaz", "link": "https://stackoverflow.com/users/1250772/kaz"}, "edited": false, "score": 0, "creation_date": 1562835706, "post_id": 56975888, "comment_id": 100505612, "body": "@Kaz :: I am not that fluent in c. I got a program from internet and then made changes for my requirements. anyway your first suggestion is same as my program right. I think it wont make any difference in speed. so can you please give some more information about your second suggestion ? I think I need something much much <b>faster</b>"}, {"owner": {"reputation": 358, "user_id": 1149948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/49a9c5ca86812dbc680e1930a239bdd1?s=128&d=identicon&r=PG", "display_name": "muaz", "link": "https://stackoverflow.com/users/1149948/muaz"}, "edited": false, "score": 0, "creation_date": 1562886017, "post_id": 56975888, "comment_id": 100530238, "body": "Many things may play major roles in your case e.g. the load on client/server machines, the specs of those machines.. Actually your code looks like has serious issues like the while loop in your server code which does not pause at all, my suggestion is to specify your requirements well i.e. specify the bandwidth you really need and see whither Linux/Windows machines can meet that bandwidth and then start your measurements again and analyse the results."}, {"owner": {"reputation": 1, "user_id": 9959956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a98445b747e42533098c3045229c619?s=128&d=identicon&r=PG&f=1", "display_name": "dipin", "link": "https://stackoverflow.com/users/9959956/dipin"}, "reply_to_user": {"reputation": 358, "user_id": 1149948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/49a9c5ca86812dbc680e1930a239bdd1?s=128&d=identicon&r=PG", "display_name": "muaz", "link": "https://stackoverflow.com/users/1149948/muaz"}, "edited": false, "score": 0, "creation_date": 1562913312, "post_id": 56975888, "comment_id": 100535868, "body": "@muaz yes I don&#39;t want to pause the while loop, once its starts, it should be continues. I will implement the pause thing by sending something from client to server, that&#39;s the later part. how can I can the bandwidth of the server, can you please give any tips ?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9959956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a98445b747e42533098c3045229c619?s=128&d=identicon&r=PG&f=1", "display_name": "dipin", "link": "https://stackoverflow.com/users/9959956/dipin"}, "edited": false, "score": 0, "creation_date": 1562835408, "post_id": 56976450, "comment_id": 100505445, "body": "actually the <b>write</b> function in the server side is responsible for printing in the client side"}, {"owner": {"reputation": 7495, "user_id": 11527076, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xqgpS.png?s=128&g=1", "display_name": "prog-fh", "link": "https://stackoverflow.com/users/11527076/prog-fh"}, "reply_to_user": {"reputation": 1, "user_id": 9959956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a98445b747e42533098c3045229c619?s=128&d=identicon&r=PG&f=1", "display_name": "dipin", "link": "https://stackoverflow.com/users/9959956/dipin"}, "edited": false, "score": 0, "creation_date": 1562840342, "post_id": 56976450, "comment_id": 100508380, "body": "@dipin Yes, I know that. But since it&#39;s TCP, two consecutive writes should not be considered different from one single. And you could just receive in the client but not actually print to the console what is received (during timing)."}], "tags": [], "owner": {"reputation": 7495, "user_id": 11527076, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xqgpS.png?s=128&g=1", "display_name": "prog-fh", "link": "https://stackoverflow.com/users/11527076/prog-fh"}, "is_accepted": false, "score": 0, "last_activity_date": 1562782445, "creation_date": 1562782445, "answer_id": 56976450, "question_id": 56975888, "link": "https://stackoverflow.com/questions/56975888/low-speed-on-client-server-programming-using-c/56976450#56976450", "title": "low speed on client server programming using c", "body": "<p>Without knowing the properties and limits of your server, may be could you save a bit of computing power (not sure it is relevant in this case).</p>\n\n<pre><code>int len=sprintf(sendBuff, \"%d\\n\\t%d\\n\", ++count1, ++count);  \nwrite(connfd, sendBuff, len);\n</code></pre>\n\n<p><code>sprintf()</code> returns the length of the generated string (no need to recompute with <code>strlen()</code>).<br>\nOnly one call to <code>write()</code> can save a system call.</p>\n\n<p>How do you measure timings? Aren't the <code>fputs()</code>/<code>printf()</code> (in the client) called during timing? That could have a non negligible influence. </p>\n"}], "owner": {"reputation": 1, "user_id": 9959956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a98445b747e42533098c3045229c619?s=128&d=identicon&r=PG&f=1", "display_name": "dipin", "link": "https://stackoverflow.com/users/9959956/dipin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1571231989, "creation_date": 1562780083, "last_edit_date": 1571231989, "question_id": 56975888, "link": "https://stackoverflow.com/questions/56975888/low-speed-on-client-server-programming-using-c", "title": "low speed on client server programming using c", "body": "<p>I am not an expert in C. I am using a client server code which will be sending 2-32 bit numbers from server(running in a remote system::a Linux system running inside an FPGA) to client program running in PC. Both are connected to a router using Ethernet cables. I was expecting at least a speed of 150k+, but barely i am getting 1k. There is a read function inside my client program(in a while loop) is the cause of delay.\nSo can anybody suggest anything to speed up my data transfer ?\nMy intention is high speed real time data transfer between server and client. </p>\n\n<p>My both client and server programs are running successfully.  But at low speed.  </p>\n\n<p>My server code:</p>\n\n<pre><code>#include &lt;sys/socket.h&gt;\n#include &lt;netinet/in.h&gt;\n#include &lt;arpa/inet.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;string.h&gt;\n#include &lt;sys/types.h&gt;\n\nint main(void)\n{\n  int listenfd = 0,connfd = 0; \n  int count1=0;\n  int count2=100;\n  char chr_count1[50];//increase 50 if you going for more than 32 bit\n  char chr_count2[50];// \n  struct sockaddr_in serv_addr;\n  char sendBuff[50];  \n  listenfd = socket(AF_INET, SOCK_STREAM, 0);\n  printf(\"socket retrieve success\\n\");\n\n  memset(&amp;serv_addr, '0', sizeof(serv_addr));\n  memset(sendBuff, '0', sizeof(sendBuff));\n\n  serv_addr.sin_family = AF_INET;    \n  serv_addr.sin_addr.s_addr = htonl(INADDR_ANY); \n  serv_addr.sin_port = htons(5000);    \n\n  bind(listenfd, (struct sockaddr*)&amp;serv_addr,sizeof(serv_addr));\n\n  if(listen(listenfd, 10) == -1){\n      printf(\"Failed to listen\\n\");\n      return -1;\n  } \n  connfd = accept(listenfd, (struct sockaddr*)NULL ,NULL); // accept awaiting request   \n  while(1)\n    {  \n      count1 = count1+1;\n      count2 = count2+1;\n      sprintf(chr_count1, \"%d\\n\\t\",count1);\n      sprintf(chr_count2, \"%d\\n\",count2);  \n      strcpy(sendBuff, chr_count1);\n      write(connfd, sendBuff, strlen(sendBuff));\n      strcpy(sendBuff, chr_count2);\n      write(connfd, sendBuff, strlen(sendBuff));\n    } \n\n  return 0;\n}\n</code></pre>\n\n<p>My client code:</p>\n\n<pre><code>#include &lt;sys/socket.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;netinet/in.h&gt;\n#include &lt;netdb.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;arpa/inet.h&gt;\n\nint main(void)\n{\n  int sockfd = 0,n = 0;\n  char recvBuff[50];\n  struct sockaddr_in serv_addr;\n\n  memset(recvBuff, '0' ,sizeof(recvBuff));\n  if((sockfd = socket(AF_INET, SOCK_STREAM, 0))&lt; 0)\n    {\n      printf(\"\\n Error : Could not create socket \\n\");\n      return 1;\n    }\n\n  serv_addr.sin_family = AF_INET;\n  serv_addr.sin_port = htons(5000);\n  serv_addr.sin_addr.s_addr = inet_addr(\"10.56.17.39\");\n\n  if(connect(sockfd, (struct sockaddr *)&amp;serv_addr, sizeof(serv_addr))&lt;0)\n    {\n      printf(\"\\n Error : Connect Failed \\n\");\n      return 1;\n    } \n  while(1)\n    {\n      n = read(sockfd, recvBuff, sizeof(recvBuff)-1);\n      recvBuff[n] = 0;\n      if(fputs(recvBuff, stdout) == EOF)\n    {\n      printf(\"\\n Error : Fputs error\");\n    }\n      printf(\"\\n\");\n    }\n\n  if( n &lt; 0)\n    {\n      printf(\"\\n Read Error \\n\");\n    }\n\n  return 0;\n}\n</code></pre>\n\n<p>I think write and read functions are responsible for the lower speed, so how can in increase the speed. will read and write functions always have this bottle neck or is it because of my system requirements. (I am using an embedded command shell in my client side)</p>\n"}, {"tags": ["c", "windows", "dev-c++"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 3, "creation_date": 1562780462, "post_id": 56975795, "comment_id": 100488215, "body": "Do you mean, for example, in <a href=\"https://docs.microsoft.com/en-us/cpp/c-runtime-library/reference/qsort?view=vs-2019\" rel=\"nofollow noreferrer\">qsort()</a> which needs a function as an argument? The user function is called by <code>qsort</code> to make a comparison of the data items, which are otherwise meaningless to the function, which only provides the sorting mechanism."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1562780587, "post_id": 56975795, "comment_id": 100488271, "body": "... or do you mean, where the only job of the function is to call another function? This is done so that the call can be &quot;patched&quot; to another function, or its arguments checked or modified on the way. For example I might intend to write a replacement for a library function, but for now I just call the original function. Please provide an example, as your question has an example of both situations."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1562782906, "post_id": 56975795, "comment_id": 100489298, "body": "Because: passing the function as an argument allows you to do different things with the same array. You might have one sub-function that increments an <code>int</code> and another one that decrements an <code>int</code>. You have a function that parses an array and can modifiy each element in the way it is told to."}, {"owner": {"reputation": 9, "user_id": 11290800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9a34951e9cce42a442a31e474af38a0?s=128&d=identicon&r=PG&f=1", "display_name": "wisepeople", "link": "https://stackoverflow.com/users/11290800/wisepeople"}, "edited": false, "score": 0, "creation_date": 1562783062, "post_id": 56975795, "comment_id": 100489363, "body": "nameofyourfunc(yourargs) &lt;---  it&#39;s not better than ---&gt;  type(*newnamefunc)(typeofargument)? only this thing. it&#39;s only less code to write or im wrong?"}, {"owner": {"reputation": 35849, "user_id": 1424875, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/HFA9w.png?s=128&g=1", "display_name": "nanofarad", "link": "https://stackoverflow.com/users/1424875/nanofarad"}, "edited": false, "score": 0, "creation_date": 1562783343, "post_id": 56975795, "comment_id": 100489488, "body": "@wisepeople You&#39;re overlooking the fact that you simply use <code>function_name(args)</code> you&#39;re stuck with that one function. By <i>passing</i> a function as a <i>parameter</i>, callers can vary the choice of function to call. It&#39;s not that different from passing an <code>int</code> parameter rather than hardcoding an integer in your function body."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1562783397, "post_id": 56975795, "comment_id": 100489510, "body": "The first example allows you to have a &quot;soft&quot; function that can do differnt things to the array. The second example has &quot;hard&quot; coded the function to be called, so this can only do one job."}], "answers": [{"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 1, "last_activity_date": 1562783837, "creation_date": 1562783837, "answer_id": 56976772, "question_id": 56975795, "link": "https://stackoverflow.com/questions/56975795/why-pass-as-argument-of-a-function-a-function/56976772#56976772", "title": "why pass as argument of a function a function?", "body": "<p>You can use a function pointer as a parameter if you want your function to do different things depending on what the user wants.</p>\n\n<p>Here's a simple example:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint add(int x, int y)\n{\n    return x + y;\n}\n\nint subtract(int x, int y)\n{\n    return x - y;\n}\n\nint multiply(int x, int y)\n{\n    return x * y;\n}\n\nint divide(int x, int y)\n{\n    return x / y;\n}\n\nint operation(int x, int y, int (*func)(int, int))\n{\n    printf(\"  x=%d, y=%d\\n\", x, y);\n    return func(x,y);\n}\n\nint main()\n{\n    int x = 8, y = 4;\n\n    printf(\"x+y=%d\\n\", operation(x,y,add));\n    printf(\"x-y=%d\\n\", operation(x,y,subtract));\n    printf(\"x*y=%d\\n\", operation(x,y,multiply));\n    printf(\"x/y=%d\\n\", operation(x,y,divide));\n    return 0;\n }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "is_accepted": false, "score": 1, "last_activity_date": 1562786376, "creation_date": 1562786376, "answer_id": 56977322, "question_id": 56975795, "link": "https://stackoverflow.com/questions/56975795/why-pass-as-argument-of-a-function-a-function/56977322#56977322", "title": "why pass as argument of a function a function?", "body": "<p>A very good example is the classic sorting function <code>qsort</code>. It's a library function, which means that you only have access to it's prototype. In order to make <code>qsort</code> general, you have to write your own compare function. A typical implementation looks like this for regular integers: </p>\n\n<pre><code>int cmpfunc (const void * a, const void * b)\n{\n   return ( *(int*)a - *(int*)b ); \n}\n</code></pre>\n\n<p>And then, if you have an array <code>arr</code> of integers you can sort it with <code>qsort(arr, sizeof(arr), cmpfunc)</code></p>\n\n<p>You might ask why this is not built in the <code>qsort</code> function? After all, it would be easy to make it work for both floats and integers. Yes, but imagine if you have an array of structs that look like this:</p>\n\n<pre><code>struct {\n    char *firstname;\n    char *lastname;\n    int age;\n} persons[10];\n</code></pre>\n\n<p>How would you sort this? Well, that's not obvious. You might want all three. In that case, write three different compare functions. </p>\n"}, {"tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": false, "score": 0, "last_activity_date": 1562794314, "creation_date": 1562794314, "answer_id": 56978927, "question_id": 56975795, "link": "https://stackoverflow.com/questions/56975795/why-pass-as-argument-of-a-function-a-function/56978927#56978927", "title": "why pass as argument of a function a function?", "body": "<blockquote>i want only know\n\n<pre><code>void map (int (*fun) (int),int x[ ], int l) {\n    for(i = 0; i &lt; l; i++)\n    x[i] = fun(x[i]);\n}</code></pre>\nwhy u use this instead of:\n\n<pre><code>void map (int x[ ], int l) {\n    for(i = 0; i &lt; l; i++)\n    x[i] = nameoffunction(yourargument);\n}</code></pre>\n</blockquote>\n\n<p>Let's answer the question with a question - what if you want to perform more than one type of mapping?  What if you want to map both <em>x<sup>2</sup></em> and <em>&radic;x</em>?  </p>\n\n<p>You could certainly do something like</p>\n\n<pre><code>void map( int x[], int l, int type )\n{\n  for ( int i = 0; i &lt; l; i++ )\n  {\n    if ( type == MAP_SQUARED )\n      x[i] = int_square( x );\n    else if ( type == MAP_ROOT )\n      x[i] = int_root( x );\n    ...\n  }\n}\n</code></pre>\n\n<p>which works, but is hard to read and cumbersome to maintain - every time you want to perform a new mapping, you have to add a new case to the <code>map</code> function.   </p>\n\n<p>Compare that to </p>\n\n<pre><code>void map( int x[], int l, int (*fun)(int) )\n{\n  for ( int i = 0; i &lt; l; i++ )\n    x[i] = fun( x[i] );\n}\n...\nmap( x, l, int_square );\nmap( y, l, int_root );\n</code></pre>\n\n<p>You don't have to hack the <code>map</code> function to get different mappings - you only have to pass the function that operates on the individual elements.  If you want to perform a new mapping, all you have to do is write a new function - you don't have to edit the <code>map</code> function at all.  </p>\n\n<p>The C standard library uses this form of delegation in several places, including the <code>qsort</code> function (allowing you to sort arrays of any type in any order) and the <code>signal</code> function (allowing you to change how a program reacts to interrupts dynamically).  </p>\n"}], "owner": {"reputation": 9, "user_id": 11290800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9a34951e9cce42a442a31e474af38a0?s=128&d=identicon&r=PG&f=1", "display_name": "wisepeople", "link": "https://stackoverflow.com/users/11290800/wisepeople"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1562794314, "creation_date": 1562779645, "last_edit_date": 1562782919, "question_id": 56975795, "link": "https://stackoverflow.com/questions/56975795/why-pass-as-argument-of-a-function-a-function", "title": "why pass as argument of a function a function?", "body": "<p>i have a little question.\ni'm studying C with devc++ (as start) and i have seen  as argument function you can pass a function, this is ok but  why?\nfor example u can write as argument:</p>\n\n<pre><code>void myfunc(void(*func)(int)){}\n</code></pre>\n\n<p>but if u simple call function with his name and argument it is not better?</p>\n\n<p>like example: </p>\n\n<pre><code>void myfunction (){name of func to call(myargs);  }\n</code></pre>\n\n<p>there's a difference?\nit seems the same thing but with more simple and short code</p>\n\n<p>edit:</p>\n\n<p>i want  only know</p>\n\n<pre><code>void map (int (*fun) (int),int x[ ], int l) {\n    for(i = 0; i &lt; l; i++)\n    x[i] = fun(x[i]);\n}\n</code></pre>\n\n<p>why u use this instead of:</p>\n\n<pre><code>void map (int x[ ], int l) {\n    for(i = 0; i &lt; l; i++)\n    x[i] = nameoffunction(yourargument);\n}\n</code></pre>\n"}, {"tags": ["c", "embedded", "stm32"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9206984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c20cd9a7005b18095ec609b02d6b760f?s=128&d=identicon&r=PG&f=1", "display_name": "Jon", "link": "https://stackoverflow.com/users/9206984/jon"}, "edited": false, "score": 0, "creation_date": 1563046162, "post_id": 56976291, "comment_id": 100574782, "body": "Ok so I have solved the compilation problem, it was due to me not adding the path to the specific sub folder, I added the main folder&#39;s path thinking that it will include all the sub folders. Now that that is out of the way, I find all sorts of compilation error when I try to call any function. I don&#39;t think that a library would be so user unfriendly, so I must be missing something here."}], "tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": 1, "last_activity_date": 1562781738, "creation_date": 1562781738, "answer_id": 56976291, "question_id": 56975771, "link": "https://stackoverflow.com/questions/56975771/how-do-i-include-vl53l0x-headers-into-my-stm32l-project/56976291#56976291", "title": "How do I include VL53L0X headers into my STM32L project", "body": "<p>You need to add the path where the header file is to the project. Right click on the project > properties > build  > paths and symbols</p>\n"}], "owner": {"reputation": 1, "user_id": 9206984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c20cd9a7005b18095ec609b02d6b760f?s=128&d=identicon&r=PG&f=1", "display_name": "Jon", "link": "https://stackoverflow.com/users/9206984/jon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 270, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1566476187, "creation_date": 1562779562, "last_edit_date": 1562785012, "question_id": 56975771, "link": "https://stackoverflow.com/questions/56975771/how-do-i-include-vl53l0x-headers-into-my-stm32l-project", "title": "How do I include VL53L0X headers into my STM32L project", "body": "<p>Language: C<br>\nMCU: STM32L151C8T6<br>\nIDE: Atollic TRUEstudio<br>\nLibrary: <a href=\"https://www.st.com/content/st_com/en/products/embedded-software/proximity-sensors-software/stsw-img005.html\" rel=\"nofollow noreferrer\">https://www.st.com/content/st_com/en/products/embedded-software/proximity-sensors-software/stsw-img005.html</a></p>\n\n<p>Problem: <code>\"fatal error: vl53l0x_api.h: No such file or directory #include \"vl53l0x_api.h\"</code></p>\n\n<p>I have included the library(core &amp; platform folder) that was extracted from \"en.STSW-IMG005\" into my project, I have checked my [build settings > include directories] and both the folders are there, however it keeps failing to compile.</p>\n\n<p>It always show \"fatal error: vl53l0x_api.h\" but it jumps from file to file every time I compile eg. \"vl53l0x_api_core.c\", \"vl53l0x_api_calibration.c\", etc.</p>\n\n<p>Reason why I must use the library provided by STM is because they did not release the I2C registers for this distance sensor, so I'm forced to use their library. I have tried referencing guides provided for <strong>VL53L1X</strong> but it didnt quite work. </p>\n"}, {"tags": ["c", "command-line", "strcmp"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 4, "creation_date": 1562777586, "post_id": 56975313, "comment_id": 100486906, "body": "<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> please.."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1562777801, "post_id": 56975313, "comment_id": 100486999, "body": "What is <code>case 3-8;</code> ??"}, {"owner": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "edited": false, "score": 3, "creation_date": 1562777817, "post_id": 56975313, "comment_id": 100487007, "body": "Probably the shell replaces <code>*</code> with all file names. Try <code>.&#47;program_name 2 &#39;*&#39; 2</code>. You can print <code>argv[1]</code> etc. to find out if this is the case."}, {"owner": {"reputation": 23, "user_id": 10909203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dad42b0c11d8df960456ccd1b677365c?s=128&d=identicon&r=PG&f=1", "display_name": "Omorio", "link": "https://stackoverflow.com/users/10909203/omorio"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1562777881, "post_id": 56975313, "comment_id": 100487031, "body": "@EugeneSh. Well it\u2019s right there, sorry if I wasn\u2019t clear. What I mean is that when I write something like  ./\u201dprogram_name\u201d 2 + 2 it outputs it properly as 4 but if I do ./\u201cprogram_name\u201d 2 * 2 it gives 0 as the output. However when compiling I don\u2019t have any errors. Should I post the program?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1562777938, "post_id": 56975313, "comment_id": 100487061, "body": "It&#39;s not there - no complete program that can be copy/pasted and compiled. For example it does not show if you check <code>argc</code> or how you call <code>OTabCheck()</code>"}, {"owner": {"reputation": 23, "user_id": 10909203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dad42b0c11d8df960456ccd1b677365c?s=128&d=identicon&r=PG&f=1", "display_name": "Omorio", "link": "https://stackoverflow.com/users/10909203/omorio"}, "reply_to_user": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "edited": false, "score": 0, "creation_date": 1562778043, "post_id": 56975313, "comment_id": 100487103, "body": "@Bodo yea this is it works with the &#39; &#39; marks. Thank you so much!!"}, {"owner": {"reputation": 23, "user_id": 10909203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dad42b0c11d8df960456ccd1b677365c?s=128&d=identicon&r=PG&f=1", "display_name": "Omorio", "link": "https://stackoverflow.com/users/10909203/omorio"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1562778122, "post_id": 56975313, "comment_id": 100487135, "body": "@WeatherVane oh sorry, yea it does check for enough argumments I can edit in some more information :)"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1562778221, "post_id": 56975313, "comment_id": 100487169, "body": "You probably have your answer, but for future reference the <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">MRE</a> is <i>de rigueur</i>. It stops a flurry of questions, and typos introduced while posting."}, {"owner": {"reputation": 23, "user_id": 10909203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dad42b0c11d8df960456ccd1b677365c?s=128&d=identicon&r=PG&f=1", "display_name": "Omorio", "link": "https://stackoverflow.com/users/10909203/omorio"}, "edited": false, "score": 0, "creation_date": 1562778377, "post_id": 56975313, "comment_id": 100487237, "body": "Alright, I&#39;m quite new here so sorry about that. yea I have my answer but I&#39;ll add the MRE to clarify for future references. :)"}, {"owner": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "edited": false, "score": 2, "creation_date": 1562778409, "post_id": 56975313, "comment_id": 100487253, "body": "@Omorio Instead of answering in comments, <b><a href=\"https://stackoverflow.com/posts/56975313/edit\">edit</a> your question and add all information there.</b>"}], "owner": {"reputation": 23, "user_id": 10909203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dad42b0c11d8df960456ccd1b677365c?s=128&d=identicon&r=PG&f=1", "display_name": "Omorio", "link": "https://stackoverflow.com/users/10909203/omorio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 83, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1562780483, "creation_date": 1562777499, "last_edit_date": 1562780483, "question_id": 56975313, "link": "https://stackoverflow.com/questions/56975313/using-in-main-parameters-for-command-line-calculator", "title": "Using * in main() parameters for command-line calculator", "body": "<p>I'm doing a homework problem which is to create a calculator using the argc and argv[] parameters in the main function.</p>\n\n<p>What we were supposed to do, and I did, was to create a char pointer array containing the operators I want to use.\nthis is what I have:</p>\n\n<pre><code>const int OTabMax = 10;\nconst char *OTab[] = {\n                      \"+\",\n                      \"-\",\n                      \"*\",\n                      \"/\",\n                      \"quad\",\n                      \"wurz\",\n                      \"sinR\",\n                      \"sinG\",\n                      \"cosR\",\n                      \"cosG\" \n                     };\n\nint OTabCheck(char S[]) // char *S\n{\n    int n;\n    for (n = 0; n &lt; OTabMax; n++){\n        if (strcmp(S, OTab[n]) == 0) {break;}\n    }\nreturn n;\n}\n\n</code></pre>\n\n<p>It returns a number depending on which operator was used, which goes into a switch case where the calculation is done.</p>\n\n<p>looks like this:</p>\n\n<pre><code>switch(key){\n\n            case 0:\n            break;\n\n            case 1:\n            break;\n\n            case 2:\n                x = atof(argv[1]);\n                y = atof(argv[3]);\n                z = 0;\n                z = x*y;\n                printf(\"%f * %f = %f\\n\",x,y,z);\n            break;\n\n            case 3-8;\n            break;\n\n            case 9:\n            break;\n\n            default: printf(\"Wrong input!\\n\"); exit(0); break;\n        }\n</code></pre>\n\n<p>The case in question is case 2: which whenever I do a calculation like calling the program through the terminal with <code>./\"program_name\" 2 * 2</code></p>\n\n<p>it printf's 2.000000 * 0.000000 = 2.000000</p>\n\n<p>here is the MRE:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;math.h&gt;\n#include &lt;string.h&gt;\n\n    const int OTabMax = 10;\n    const char *OTab[] = {\n                            \"+\",\n                            \"-\",\n                            \"*\",\n                            \"/\",\n                            \"quad\",\n                            \"wurz\",\n                            \"sinR\",\n                            \"sinG\",\n                            \"cosR\",\n                            \"cosG\" };\n\nint OTabCheck(char S[]) // char *S\n{\n    int n;\n    for (n = 0; n &lt; OTabMax; n++){\n        if (strcmp(S, OTab[n]) == 0) {break;}\n    }\n    return n;\n}\n\nint main(int argc,char *argv[]){\n    float x = 0;\n    float y = 0;\n    float z = 0;\n    int key = 0;\n\n    if(argc &lt; 3){\n        exit(0);\n    }\n\n    if(argc == 4){\n\n    key = OTabCheck(argv[2]);\n\n    }else if(argc == 3){\n    key = OTabCheck(argv[1]);\n\n    }\n        switch(key){\n\n            case 2:\n                x = atof(argv[1]);\n                y = atof(argv[3]);\n                z = 0;\n                z = x*y;\n                printf(\"%f * %f = %f\\n\",x,y,z);\n                exit(0);\n            break;\n\n            default: printf(\"Wrong input!\\n\"); exit(0); break;\n        }\n\n}\n</code></pre>\n"}, {"tags": ["c", "utf-8", "libxml2"], "comments": [{"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 1, "creation_date": 1562777992, "post_id": 56975184, "comment_id": 100487081, "body": "If the string is UTF-8 with the possibility of invalid bytes, <a href=\"http://icu-project.org/apiref/icu4c/utf8_8h.html#a7dda2b78867c9d648ad5a0f400fdb1b4\" rel=\"nofollow noreferrer\">U8_NEXT_OR_FFFD()</a> from ICU is something I&#39;ve found useful before for iterating through the codepoints."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1562792151, "post_id": 56975184, "comment_id": 100493036, "body": "<a href=\"http://xmlsoft.org/html/libxml-encoding.html#xmlCharEncodingHandler\" rel=\"nofollow noreferrer\">This</a> and the following functions appear related \u2013 but you need to test yourself if they help you out..."}], "answers": [{"comments": [{"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1562780362, "post_id": 56975331, "comment_id": 100488173, "body": "Windows: Not necessarily. If you have unicode build enabled and use the wide string API, yes, if not, it uses regional encodings still today (like CP1252)..."}, {"owner": {"reputation": 9817, "user_id": 1467997, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/6c72d7139086df4435a1067a66b02fff?s=128&d=identicon&r=PG", "display_name": "limp_chimp", "link": "https://stackoverflow.com/users/1467997/limp-chimp"}, "edited": false, "score": 0, "creation_date": 1562780459, "post_id": 56975331, "comment_id": 100488214, "body": "Unfortunately, the string is in this case not valid ASCII (which is why it&#39;s also not valid UTF-8). Hence the issue."}, {"owner": {"reputation": 436, "user_id": 7642575, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yy1r5.jpg?s=128&g=1", "display_name": "Strong will", "link": "https://stackoverflow.com/users/7642575/strong-will"}, "edited": false, "score": 0, "creation_date": 1562807418, "post_id": 56975331, "comment_id": 100496575, "body": "Well to help you I would  have to know where do you get the string from."}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1562876809, "post_id": 56975331, "comment_id": 100527629, "body": "well, let&#39;s say that the codepoints of the ASCII character set just match in value to the ascii codes of the same characters.  Windows doesn&#39;t use utf-16 encoding.  It uses codepages, all of them based on one byte character sets.  Mainly code page 1250 (iso-8859-1) and 437 (ibm charset)  Only recently has adopted unicode, so recently that 98% of the software still uses codepages."}, {"owner": {"reputation": 436, "user_id": 7642575, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yy1r5.jpg?s=128&g=1", "display_name": "Strong will", "link": "https://stackoverflow.com/users/7642575/strong-will"}, "edited": false, "score": 0, "creation_date": 1563072174, "post_id": 56975331, "comment_id": 100578383, "body": "You need to write some platform specific code and use some native functions to find the encoding of the text. There is just no way of knowing how the text is encoded without contacting the source of the data. Once you found out what encoding is used by the string, you can use some library to do the conversion for you."}], "tags": [], "owner": {"reputation": 436, "user_id": 7642575, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yy1r5.jpg?s=128&g=1", "display_name": "Strong will", "link": "https://stackoverflow.com/users/7642575/strong-will"}, "is_accepted": false, "score": 0, "last_activity_date": 1562777918, "last_edit_date": 1562777918, "creation_date": 1562777554, "answer_id": 56975331, "question_id": 56975184, "link": "https://stackoverflow.com/questions/56975184/convert-a-char-to-utf-8-in-c-or-when-using-xmlwriter/56975331#56975331", "title": "Convert a `char *` to UTF-8 in C, or when using xmlwriter?", "body": "<p>In case the string is encoded in ASCII, then it will always be valid UTF-8 string.\nThis is because UTF-8 is backwards compatible with ASCII encoding.</p>\n\n<p>See the second paragraph on Wikipedia <a href=\"https://en.wikipedia.org/wiki/UTF-8\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>Windows primarily works with UTF-16, this means you will have to convert from UTF-16 to UTF-8 before you pass the string to the XML library.</p>\n"}, {"comments": [{"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1562788392, "post_id": 56977587, "comment_id": 100491570, "body": "<code>If the next byte is &gt;= 128+64 then it is a proper UTF-8 introducer</code> is not entirely true. Only byte values in the range <code>192..247</code> inclusive are valid for the &quot;introducer&quot;, as you call it (most people would more likely call it a &quot;lead byte&quot; instead)."}, {"owner": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1562788600, "post_id": 56977587, "comment_id": 100491656, "body": "Yes, &quot;lead byte&quot; is good. It depends what you mean by the valid utf encoding I guess - giving it any more trailing bytes just produces values that are even more out of range. Ok I&#39;ll change it to &quot;probably valid&quot;. mbrlen() will fail if it is out of range anyway."}], "tags": [], "owner": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "is_accepted": false, "score": 0, "last_activity_date": 1562788952, "last_edit_date": 1562788952, "creation_date": 1562787615, "answer_id": 56977587, "question_id": 56975184, "link": "https://stackoverflow.com/questions/56975184/convert-a-char-to-utf-8-in-c-or-when-using-xmlwriter/56977587#56977587", "title": "Convert a `char *` to UTF-8 in C, or when using xmlwriter?", "body": "<p>If you have 8-bit ascii input then you can simply junk any character code > 127.</p>\n\n<p>If you have some dodgy UTF-8 it is quite easy to parse, but the widechar symbol number that you generate might be out of the unicode range. You can use <a href=\"http://man7.org/linux/man-pages/man3/mbrlen.3.html\" rel=\"nofollow noreferrer\"><code>mbrlen()</code></a> to individually validate each character.</p>\n\n<p>I am describing this using unsigned chars. If you must use signed chars, then >128 means &lt;0.</p>\n\n<p>At its simplest:</p>\n\n<pre><code>Until the null byte\n 1 If the next byte is 0, then end the loop\n 2 If the next byte is &lt; 128 then it is ascii, so keep it\n 3 If the next byte is &gt;=128 &lt; 128+64 it is invalid - discard it\n 4 If the next byte is &gt;= 128+64 then it is probably a proper UTF-8 lead byte\n   call size_t mbrlen(const char *s, size_t n, mbstate_t *ps);\n   to see how many bytes to keep \n   if mbrlen says the code is bad (either the lead byte or the trail bytes),\n     skip 1 byte. Rule 3 will skip the rest.\n</code></pre>\n\n<p>Even simpler logic just calls mbrlen repeatedly, as it can accept the low ascii range.</p>\n\n<p>You can assume that all the \"furniture\" of the file (eg xml &lt;>/ symbols, spaces, quotes and newlines) won't be altered by this edit, as they are all valid 7-bit ascii codes.</p>\n"}, {"tags": [], "owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "is_accepted": false, "score": 0, "last_activity_date": 1562877028, "last_edit_date": 1562877028, "creation_date": 1562876669, "answer_id": 56996806, "question_id": 56975184, "link": "https://stackoverflow.com/questions/56975184/convert-a-char-to-utf-8-in-c-or-when-using-xmlwriter/56996806#56996806", "title": "Convert a `char *` to UTF-8 in C, or when using xmlwriter?", "body": "<p><code>char</code> is a single byte character, while UTF codepoints range from <code>0</code> to <code>0x10FFFFF</code>, so how do you represent a UTF character in only one byte?</p>\n\n<p>First of all you need a <code>wchar_t</code> character.  Those are used with <code>wprintf(3)</code> versions of the normal <code>printf(3)</code> routines.  If you dig a little on this, you'll see that mapping your UTF codepoints into valid <code>UTF-8</code> encoding is straigtforward, based on your <code>setlocale(3)</code> settings.  Look at those manual pages referenced, and you'll get an idea of the task you are facing.</p>\n\n<p>There's full support for wide character sets in the C standard... but you have to use it through the internationalization libraries and locales availables.</p>\n"}], "owner": {"reputation": 9817, "user_id": 1467997, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/6c72d7139086df4435a1067a66b02fff?s=128&d=identicon&r=PG", "display_name": "limp_chimp", "link": "https://stackoverflow.com/users/1467997/limp-chimp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 665, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1562877028, "creation_date": 1562776976, "question_id": 56975184, "link": "https://stackoverflow.com/questions/56975184/convert-a-char-to-utf-8-in-c-or-when-using-xmlwriter", "title": "Convert a `char *` to UTF-8 in C, or when using xmlwriter?", "body": "<p>I'm using <code>libxml/xmlwriter</code> to generate an XML file within a program. </p>\n\n<pre><code>const char *s = someCharactersFromSomewhere();\nxmlTextWriterWriteAttribute (writer, _xml (\"value\"), _xml (s));\n</code></pre>\n\n<p>In general I don't have much control over the contents of <code>s</code>, so I can't guarantee that it will be well-formatted in UTF-8. Mostly it is, but if not, the XML which is generated will be malformed.</p>\n\n<p>What I'd like to find is a way to convert <code>s</code> to valid UTF-8, with any invalid character sequences in <code>s</code> replaced with escapes or removed.</p>\n\n<p>Alternatively, if there is an alternative to <code>xmlTextWriterWriteAttribute</code>, or some option I can pass in when initializing the XML writer, such that it guarantees that it will always write valid UTF-8, that would be even better.</p>\n\n<p>One more thing to mention is that the solution must work with both Linux and OSX. Ideally writing as little of my own code as possible! :P</p>\n"}, {"tags": ["c", "mips"], "comments": [{"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1562776829, "post_id": 56975081, "comment_id": 100486544, "body": "Did you try step through your code in a debugger? Do your register contents match expectation? Does <code>$a1</code> really point to <code>b</code>?"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 1, "creation_date": 1562776876, "post_id": 56975081, "comment_id": 100486558, "body": "Maybe you should add the initialization of your registers. Not just as comments but as active code."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1562777002, "post_id": 56975081, "comment_id": 100486624, "body": "Not related to your problem, but aren&#39;t you missing some jump back to <code>loop:</code>?"}, {"owner": {"reputation": 1360, "user_id": 11608064, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-6vNDnlV3OuY/AAAAAAAAAAI/AAAAAAAAPZs/ncdvjh0w7ak/photo.jpg?sz=128", "display_name": "DenverCoder1", "link": "https://stackoverflow.com/users/11608064/denvercoder1"}, "edited": false, "score": 1, "creation_date": 1562777046, "post_id": 56975081, "comment_id": 100486649, "body": "$a1 is set to 0 at the beginning of your program. You need to load the address of b. Same with $a0."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1562777062, "post_id": 56975081, "comment_id": 100486659, "body": "You don&#39;t seem to branch back to <code>loop</code>. Shouldn&#39;t provoke the issue you have, but will result in another error later. If existing, perhaps better: <code>bne ..., loop</code>"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 1, "creation_date": 1562777184, "post_id": 56975081, "comment_id": 100486720, "body": "Why do you compare <code>$t0 (==i)</code> with <code>$s0 (==C)</code>? <code>$t3 (==101)</code> should be the limit for the loop"}], "owner": {"reputation": 63, "user_id": 8902623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab0b6a6e870108ecc483dedae5cb4f82?s=128&d=identicon&r=PG&f=1", "display_name": "RobertLD", "link": "https://stackoverflow.com/users/8902623/robertld"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1562776489, "creation_date": 1562776489, "question_id": 56975081, "link": "https://stackoverflow.com/questions/56975081/how-do-i-find-out-why-a-address-out-of-range-in-mips-although-temporary-varia", "title": "How do I find out why a &quot;address out of range in MIPS&quot;, although temporary variables are declared", "body": "<p>I am doing a homework problem for the computer design and architecture class where we are required to implement a simple for loop in C, into MIPS using the MARSim. I implemented the for loop step by step, initialized (if that is the proper term) the variables in memory, yet when I assemble and run it throws this error: question1.asm line 11: Runtime exception at 0x00400008: address out of range 0x00000000</p>\n\n<p>I've looked at line 11 : lw $t1, 0($a1), \nand as I understand it, this should work properly. As I understand here we are setting our t1 value to a1 (b[i]).</p>\n\n<p>Here is the C we have to reproduce:</p>\n\n<pre><code>for (i=0; i&lt;=100; i++) { a[i] = b[i] + C ; }\n</code></pre>\n\n<p>Here is my attempt:</p>\n\n<pre><code># t0 = i\n# t1 = b[i]\n# t2 = a[i]\n# t3 = 101 (the end value of i)\n# s0 = c\n# $a0 = a\n# $a1 = b\nbegin:\naddi $t3, $zero, 101 #loop terminate value\nadd $t0, $zero, $zero # set our counter to zero\nloop: lw $t1, 0($a1) # set t1 to b[i]\nadd $t1, $t1, $s0 # B[i] + c\nsw $t1, 0($a0) #store $t1 into a[i]\naddi $t0, $t0, 1  # loop increment\naddi $a0,$a0,4 # increment a0 to point to the next block in the array (4 bits)\naddi $a1, $a1, 4 # likewise with b[i]\nbeq $t0, $s0, finish    \nfinish:\n</code></pre>\n\n<p>The MIPS code I've written, should mimic the action of the C code w/o error. However on the first iteration of the loop it states it is accessing an out of range address 0x00000000. Could someone shine some light on what I am doing wrong? I would really appreciate a thorough explanation so I can understand this better for my class. Thanks for your assistance and much love.\nCheers.</p>\n"}, {"tags": ["c", "postgresql", "libpq"], "comments": [{"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1562776910, "post_id": 56975043, "comment_id": 100486577, "body": "libpq is for frontend-programs. Your function will become part of the DBMS backend, <a href=\"https://www.postgresql.org/docs/current/xfunc-c.html\" rel=\"nofollow noreferrer\">postgresql.org/docs/current/xfunc-c.html</a>"}], "answers": [{"tags": [], "owner": {"reputation": 125670, "user_id": 6464308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/12PVX.jpg?s=128&g=1", "display_name": "Laurenz Albe", "link": "https://stackoverflow.com/users/6464308/laurenz-albe"}, "is_accepted": true, "score": 0, "last_activity_date": 1562778236, "creation_date": 1562778236, "answer_id": 56975467, "question_id": 56975043, "link": "https://stackoverflow.com/questions/56975043/postgresql-says-symbol-not-found-when-i-try-to-use-pqnfelds/56975467#56975467", "title": "PostgreSQL says &#39;symbol not found&#39; when I try to use PQnfelds", "body": "<p>You'll have to put the directory containing <code>libpq.so.*</code> on PostgreSQL's shared library path, either by setting <code>LD_LIBRARY_PATH</code> in the server's environment or by adding <code>-Wl,-rpath,/path/to/so</code> to the compile line.</p>\n\n<p>Are you using the PGXS framework to build the shared library? That gives you most of the proper flags automatically.</p>\n\n<p>Look at <code>postgres_fdw</code>'s <code>Makefile</code> for inspiration, it links with <code>libpq</code> too.</p>\n\n<p>Taking a step back: are you sure that you need a function called <code>crossdb</code> that calls the client? I would investigate if a foreign table or <code>dblink</code> can do what you are trying to achieve.</p>\n"}], "owner": {"reputation": 496, "user_id": 10374425, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/--YB_KZl4maM/AAAAAAAAAAI/AAAAAAAAAMU/i5E22qzXSo8/photo.jpg?sz=128", "display_name": "thebuleon29", "link": "https://stackoverflow.com/users/10374425/thebuleon29"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "accepted_answer_id": 56975467, "answer_count": 1, "score": 0, "last_activity_date": 1562778236, "creation_date": 1562776361, "question_id": 56975043, "link": "https://stackoverflow.com/questions/56975043/postgresql-says-symbol-not-found-when-i-try-to-use-pqnfelds", "title": "PostgreSQL says &#39;symbol not found&#39; when I try to use PQnfelds", "body": "<p>I wrote a C function to be executed from within PostgreSQL (with a <code>CREATE FUNCTION ... LANGUAGE C;</code> command) but when I do so, it responds 'PQnfields: symbol not found'.\nI tried to include the path to where the libpq library is when I compile, like this:</p>\n\n<pre><code> gcc -lpq -fpic -c crossdb.c -I`pg_config --includedir-server` -I /usr/include/ -std=c99\n</code></pre>\n\n<p>But it didn't work. \nI think that it is simply not possible to use libpq to query the database from a function... So if you know how to do it or what is causing this error message, I'd be happy to ear it from you.</p>\n"}, {"tags": ["c", "printf", "c-strings"], "comments": [{"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 3, "creation_date": 1562776317, "post_id": 56974973, "comment_id": 100486312, "body": "It is not atypical that multiple identical string literals point to the same memory location."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1562776399, "post_id": 56974973, "comment_id": 100486356, "body": "Which memory usage did you check? Are you sure that you didn&#39;t introduce extra RAM usage for your array? Instead of an array you could also use a pointer."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 1, "creation_date": 1562776444, "post_id": 56974973, "comment_id": 100486375, "body": "As you already mentioned: Don&#39;t expect anything. But common (sub)string usage is not too exotic. It might even happen that <code>&quot;hello world&quot;</code> and <code>&quot;world&quot;</code> share same memory"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1562776487, "post_id": 56974973, "comment_id": 100486399, "body": "You could investigate this by doing <code>char *p1 = &quot;ping %s 3 1\\r&quot;, *p2 = &quot;ping %s 3 1\\r&quot;; printf(&quot;%p %p\\n&quot;, p1, p2);</code>."}, {"owner": {"reputation": 23, "user_id": 10089814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd2665eba30d519ef2e8db743c11698a?s=128&d=identicon&r=PG&f=1", "display_name": "Roy", "link": "https://stackoverflow.com/users/10089814/roy"}, "reply_to_user": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1562781488, "post_id": 56974973, "comment_id": 100488620, "body": "@Gerhardh I should have mentioned that both ro and rw memory were consistent between compilations"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1562831772, "post_id": 56974973, "comment_id": 100503569, "body": "Did you also check stack usage?"}], "answers": [{"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 3, "last_activity_date": 1562776435, "creation_date": 1562776435, "answer_id": 56975065, "question_id": 56974973, "link": "https://stackoverflow.com/questions/56974973/repeated-sprintf-format-pattern-string-literals-versus-const-char-string-and-c/56975065#56975065", "title": "Repeated sprintf format pattern - string literals versus const char string and compiler optimization", "body": "<p>Constant folding is common, even without optimizations enabled.</p>\n\n<p>For example, with the following code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n    const char *str1=\"hello\";\n    const char *str2=\"hello\";\n    printf(\"%p\\n\", (void *)str1);\n    printf(\"%p\\n\", (void *)str2);\n    printf(\"%p\\n\", (void *)\"hello\");\n    printf(\"%p\\n\", (void *)\"hello\");\n    return 0;\n}\n</code></pre>\n\n<p>Built on CentOS 7.2 with gcc 4.8.5 as <code>gcc -g  -Wall -Wextra -o x1 x1.c</code>, it outputs:</p>\n\n<pre><code>0x400630\n0x400630\n0x400630\n0x400630\n</code></pre>\n\n<p>As you can see, in each of the 4 places <code>\"hello\"</code> appears in the code it refers to the same string literal.</p>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 10089814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd2665eba30d519ef2e8db743c11698a?s=128&d=identicon&r=PG&f=1", "display_name": "Roy", "link": "https://stackoverflow.com/users/10089814/roy"}, "edited": false, "score": 0, "creation_date": 1562781534, "post_id": 56975086, "comment_id": 100488639, "body": "Thanks for the suggestion, sendPing() is a really elegant way to consolidate the code."}], "tags": [], "owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "is_accepted": false, "score": 1, "last_activity_date": 1562776501, "creation_date": 1562776501, "answer_id": 56975086, "question_id": 56974973, "link": "https://stackoverflow.com/questions/56974973/repeated-sprintf-format-pattern-string-literals-versus-const-char-string-and-c/56975086#56975086", "title": "Repeated sprintf format pattern - string literals versus const char string and compiler optimization", "body": "<p>I am not a ware of a compiler not doing this optimisation \u2013 but if I remember correctly, it is not mandated by the standard.</p>\n\n<p>If it is for readability:</p>\n\n<pre><code>void createPingString(char const* address)\n{\n    sprintf(pingString, \"ping %s 3 1\\r\", address);\n}\n</code></pre>\n\n<p>Maybe even better:</p>\n\n<pre><code>void sendPing(char const* address);\n</code></pre>\n\n<p>containing all the rest of the procedure as well...</p>\n"}], "owner": {"reputation": 23, "user_id": 10089814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd2665eba30d519ef2e8db743c11698a?s=128&d=identicon&r=PG&f=1", "display_name": "Roy", "link": "https://stackoverflow.com/users/10089814/roy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 193, "favorite_count": 1, "accepted_answer_id": 56975065, "answer_count": 2, "score": 0, "last_activity_date": 1562784830, "creation_date": 1562776004, "last_edit_date": 1562784830, "question_id": 56974973, "link": "https://stackoverflow.com/questions/56974973/repeated-sprintf-format-pattern-string-literals-versus-const-char-string-and-c", "title": "Repeated sprintf format pattern - string literals versus const char string and compiler optimization", "body": "<p>In C, is it common that the compilers will optimize repeated string literals? I was working with sprintf statements that repeated the same string literal for the format with a const char array and noticed that the memory usage did not change in the map file. The compiler used in this test is IAR for embedded systems. </p>\n\n<p>To elaborate, there are six sprintf statements used for creating a ping string to different addresses similar to:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>sprintf(pingString, \"ping %s 3 1\\r\", \"127.0.0.1\");\nsprintf(pingString, \"ping %s 3 1\\r\", primaryDNS);\n</code></pre>\n\n<p>I replaced the format strings with a const char:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>const char pingCommandFormat[] = \"ping %s 3 1\\r\";\nsprintf(pingString, pingCommandFormat, \"127.0.0.1\");\nsprintf(pingString, pingCommandFormat, primaryDNS);\n</code></pre>\n\n<p>Then compiled and checked the mapping file and noted that there were no changes in memory used.</p>\n\n<p>Keeping the string literals instead of using the const char string is ideal for readability, but optimizing memory usage is prudent in embedded systems. Optimizations should never be expected from compiler behavior but is this type of behavior common in different compilers?</p>\n"}, {"tags": ["c", "arrays", "struct", "memcpy", "compound-literals"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1562775092, "post_id": 56974620, "comment_id": 100485674, "body": "Either set the array cells one at a time or use a fill/copy method like <code>memcpy</code>. In C arrays are not modifiable lvalues. They cannot appear on the left side of an assignment operation as you&#39;re doing."}], "answers": [{"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 1, "last_activity_date": 1562774743, "creation_date": 1562774743, "answer_id": 56974656, "question_id": 56974620, "link": "https://stackoverflow.com/questions/56974620/how-to-change-array-member-of-a-structure-in-c/56974656#56974656", "title": "How to change array member of a structure in C", "body": "<p>You cannot assign to an array as a whole.  You need to assign to each array element.</p>\n\n<pre><code>temp.address[0] = 0x1F;\ntemp.address[1] = 0x03;\ntemp.address[2] = 0xC2;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 1, "last_activity_date": 1562775691, "last_edit_date": 1562775691, "creation_date": 1562775350, "answer_id": 56974817, "question_id": 56974620, "link": "https://stackoverflow.com/questions/56974620/how-to-change-array-member-of-a-structure-in-c/56974817#56974817", "title": "How to change array member of a structure in C", "body": "<p>Arrays do not have the assignment operator. You have to copy elements of one array into another array.</p>\n\n<p>To do so you can use for example a compound literal and the standard function <code>memcpy</code> declared in header <code>&lt;string.h&gt;</code>.</p>\n\n<p>Here is a demonstrative program</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main( void )\n{\n    struct Command_order \n    {\n        unsigned char opcode;\n        unsigned char address[3];\n        unsigned char data[5];\n    };    \n\n    struct Command_order temp;\n\n    memcpy( temp.address, ( unsigned char[] ) { 0x1F, 0x03, 0xC2 }, 3 * sizeof( unsigned char ) );\n}    \n</code></pre>\n\n<p>Or you can rewrite the call of <code>memcpy</code> in the following way if the number of initializers is equal to the number of elements in the array</p>\n\n<pre><code>memcpy( temp.address, ( unsigned char[] ) { 0x1F, 0x03, 0xC2 }, sizeof( temp.address ) );\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 11126317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da7f48bda31f0d07ca59a56913ff2754?s=128&d=identicon&r=PG&f=1", "display_name": "John Lenon", "link": "https://stackoverflow.com/users/11126317/john-lenon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 56974656, "answer_count": 2, "score": -1, "last_activity_date": 1562775760, "creation_date": 1562774607, "last_edit_date": 1562775760, "question_id": 56974620, "link": "https://stackoverflow.com/questions/56974620/how-to-change-array-member-of-a-structure-in-c", "title": "How to change array member of a structure in C", "body": "<p>I am trying to program a microcontroller to be able to communicate with external flash memory chip which utilizes SPI. The operation code (opcode) followed by address bytes then data bytes has to be sent in order. \nInstead of defining these bytes each time for different commands I want to create a structure which holds this specific order. Also I want to change the whole array inside the struct.</p>\n\n<p>I have tried to create structure which has three members like opcode, address and data.</p>\n\n<pre><code>void main (void)\n{\n//Defining Structure\nstruct Command_order {\n    unsigned char opcode;\n    unsigned char address[3];\n    unsigned char data[5];\n };\n\n while(1)\n {\n   struct Command_order temp = {0x02, {0x00,0x17,0x00} , {0x01,0x02,0x03,0x04,0x05}}; //Initialization of structure\n\n   temp.address = {0x1F,0x03,0xC2}; //Trying to change only address \n\n }\n}\n</code></pre>\n\n<p>However this won't work, Do I get structure idea wrong or is it syntax. I am new to the concept.</p>\n"}, {"tags": ["c", "arrays", "sorting", "quicksort", "partitioning"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 9, "creation_date": 1562770853, "post_id": 56973517, "comment_id": 100483268, "body": "Your <code>main</code> is never calling any sorting function."}, {"owner": {"reputation": 284, "user_id": 11562467, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dVLZx.png?s=128&g=1", "display_name": "rjg", "link": "https://stackoverflow.com/users/11562467/rjg"}, "edited": false, "score": 1, "creation_date": 1562771415, "post_id": 56973517, "comment_id": 100483596, "body": "It&#39;s good idea to learn using a debugger. This way you can see what functions are called, what the intermediate state is and pinpoint errors much easier."}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 2, "creation_date": 1562772306, "post_id": 56973517, "comment_id": 100484124, "body": "@Lelre Ferreira It is evident that the function QuickSortPartition is incorrect."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1562772307, "post_id": 56973517, "comment_id": 100484125, "body": "Please read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1562772809, "post_id": 56973517, "comment_id": 100484394, "body": "OT: regarding: <code>int main (int argc, const char * argv[]){</code>  This will cause the compiler to output two warning messages about unused parameters. ( <code>argc</code> and <code>argv</code> )  Suggest using the other valid signature for <code>main()</code>  -- <code>int  main( void )</code>"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 2, "creation_date": 1562772841, "post_id": 56973517, "comment_id": 100484412, "body": "It appears that <code>QuickSortFunction</code> is intended to recurse, which would be common, <i>but it doesn&#39;t</i>.  Where it ought to be calling itself (twice), it is instead calling <code>QuickSortPartition</code>."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1562772953, "post_id": 56973517, "comment_id": 100484470, "body": "OT: regarding: <code>int i = 0;     for (i = 0; i &lt; size; i++) {</code>  it is best to limit the scope of a variable.  Suggest: <code>for (int i = 0; i &lt; size; i++) {</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1562773184, "post_id": 56973517, "comment_id": 100484604, "body": "OT:  regarding: <code>scanf(&quot;%d&quot;, &amp;array[i]);</code>  always check the returned value (not the parameter values) to assure the operation was successful.  The <code>scanf()</code> family of functions return the number of successful &#39;input format conversions&#39;.  Suggest: <code>if( scanf(&quot;%d&quot;, &amp;array[i]) != 1 ) { fprintf( stderr, &quot;scanf for array entry failed\\n&quot; );  exit( EXIT_FAILURE );}</code>  Where <code>exit()</code> and <code>EXIT_FAILURE</code> are exposed in the <code>stdlib.h</code> header file"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1562773407, "post_id": 56973517, "comment_id": 100484754, "body": "The quicksort()` function is &#39;normally&#39; accompanied by a function that actually compares a pair of entries and returns an indication: -1 or 0 or +1 to indicate which is larger, smaller, equal"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1562773600, "post_id": 56973517, "comment_id": 100484863, "body": "regarding: <code>for (j = begin; j &lt;= end - 1; j++) {         if (array[j] &lt;= pivot) {             i++;             array[i] = array[j];         }     }     array[i + 1] = array[end];</code>  this fails to swap the two &#39;target&#39; entries in the array.  Suggest something like: <code>int temp = array[end];  array[end] = array[i];  array[i] = temp</code>"}], "answers": [{"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 1, "last_activity_date": 1562774788, "last_edit_date": 1562774788, "creation_date": 1562773489, "answer_id": 56974304, "question_id": 56973517, "link": "https://stackoverflow.com/questions/56973517/quicksort-implementation-not-sorting-in-c/56974304#56974304", "title": "Quicksort implementation not sorting in C", "body": "<p>When you wrote a function then test it before using it in a program.</p>\n\n<p>The function <code>QuickSortPartition</code> is evidently wrong.</p>\n\n<p>Consider the following demonstrative program with your function implementation</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint QuickSortPartition(int *array, int begin, int end){\n\n\n    int pivot = array[end];\n    int i = (begin - 1), j = 0;\n\n    for (j = begin; j &lt;= end - 1; j++) {\n        if (array[j] &lt;= pivot) {\n            i++;\n            array[i] = array[j];\n        }\n    }\n    array[i + 1] = array[end];\n    return (i + 1);\n}\n\nint main( void )\n{\n    int a[] = { 5, 4, 2, 1, 3 };\n    const size_t N = sizeof( a ) / sizeof( *a );\n\n    for ( size_t i = 0; i &lt; N; i++ ) printf( \"%d \", a[i] );\n    putchar( '\\n' );\n\n    QuickSortPartition( a, 0, ( int )( N - 1 ) );\n\n    for ( size_t i = 0; i &lt; N; i++ ) printf( \"%d \", a[i] );\n    putchar( '\\n' );\n}    \n</code></pre>\n\n<p>Its output is</p>\n\n<pre><code>5 4 2 1 3 \n2 1 3 1 3 \n</code></pre>\n\n<p>You need to swap values in the function instead of using a simple assignment. For example</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nsize_t QuickSortPartition( int *array, size_t begin, size_t end )\n{\n    const int pivot = array[end];\n\n    size_t i = begin - 1;\n\n    for ( size_t j = begin; j &lt; end; j++ ) \n    {\n        if ( array[j] &lt;= pivot ) \n        {\n            int tmp = array[++i];\n            array[i] = array[j];\n            array[j] = tmp;\n        }\n    }\n\n    int tmp = array[++i];\n    array[i] = array[end];\n    array[end] = tmp;\n\n    return i;\n}\n\nint main( void )\n{\n    int a[] = { 5, 4, 2, 1, 3 };\n    const size_t N = sizeof( a ) / sizeof( *a );\n\n    for ( size_t i = 0; i &lt; N; i++ ) printf( \"%d \", a[i] );\n    putchar( '\\n' );\n\n    size_t partition = QuickSortPartition( a, 0, N - 1 );\n\n    printf( \"%zu: \", partition );\n    for ( size_t i = 0; i &lt; N; i++ ) printf( \"%d \", a[i] );\n    putchar( '\\n' );\n}    \n</code></pre>\n\n<p>Its output is</p>\n\n<pre><code>5 4 2 1 3 \n2: 2 1 3 4 5\n</code></pre>\n\n<p>For indices I used the type <code>size_t</code> (and you should do the same) instead of the type <code>int</code>.</p>\n\n<p>And within the function <code>QuickSortFunction</code> you need call it itself instead of the function <code>QuickSortPartition</code>.</p>\n\n<pre><code>void QuickSortFunction(int *array, size_t begin, size_t end){\n\n    if (begin &lt; end) {\n        size_t pivot = QuickSortPartition(array, begin, end);\n        QuickSortFunction(array, begin, pivot - 1);\n        QuickSortFunction(array, pivot + 1, end);\n    }\n\n}\n</code></pre>\n\n<p>Take into account that this initialization in the declaration of the function <code>QuickSortPartition</code></p>\n\n<pre><code>int i = (begin - 1), j = 0;\n        ^^^^^^^^^^^\n</code></pre>\n\n<p>is bad.  (It seems everyone copies the algorithm from a bad example:)). And the function is inefficient when all elements is less or equal to the value of pivot.</p>\n\n<p>Also you could write a separate function that swaps two elements of an array.</p>\n\n<p>Below there is a demonstrative program that shows how the code of the function <code>QuickSortPartition</code> can be made better.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid swap( int *a, int *b )\n{\n    int tmp = *a;\n    *a = *b;\n    *b = tmp;\n}\n\nsize_t QuickSortPartition( int *array, size_t begin, size_t end )\n{\n    const int pivot = array[end];\n\n    size_t i = begin;\n\n    for ( size_t j = begin; j &lt; end; j++ ) \n    {\n        if ( array[j] &lt;= pivot ) \n        {\n            if ( i != j ) swap( &amp;array[i], &amp;array[j] );\n            ++i;\n        }\n    }\n\n    if ( i != end ) swap( &amp;array[i], &amp;array[end] );\n\n    return i;\n}\n\nint main( void )\n{\n    int a[] = { 5, 4, 2, 1, 3 };\n    const size_t N = sizeof( a ) / sizeof( *a );\n\n    for ( size_t i = 0; i &lt; N; i++ ) printf( \"%d \", a[i] );\n    putchar( '\\n' );\n\n    size_t partition = QuickSortPartition( a, 0, N - 1 );\n\n    printf( \"%zu: \", partition );\n    for ( size_t i = 0; i &lt; N; i++ ) printf( \"%d \", a[i] );\n    putchar( '\\n' );\n}    \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 8108118, "user_type": "registered", "profile_image": "https://graph.facebook.com/1457468444298426/picture?type=large", "display_name": "Lelre Ferreira", "link": "https://stackoverflow.com/users/8108118/lelre-ferreira"}, "edited": false, "score": 0, "creation_date": 1562862182, "post_id": 56974385, "comment_id": 100521435, "body": "Thank for your help, I&#39;ve done some mistakes, I was sort of tired of writing the code over and over again. I made the corrections are it&#39;s working as it should now."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "reply_to_user": {"reputation": 11, "user_id": 8108118, "user_type": "registered", "profile_image": "https://graph.facebook.com/1457468444298426/picture?type=large", "display_name": "Lelre Ferreira", "link": "https://stackoverflow.com/users/8108118/lelre-ferreira"}, "edited": false, "score": 0, "creation_date": 1562862507, "post_id": 56974385, "comment_id": 100521566, "body": "@LelreFerreira This is actually even easier in C, which allows rebasing the array pointer argument to the recursive calls. It means you can do this with only two arguments (a pointer to/in the array, and a length argument. If you&#39;re interested in seeing what that looks like I can update this answer with an addendum, but a little searching of quicksort questions/answers in C on this site will just-as-well lead you to what I&#39;m describing. Regardless, glad it helped."}], "tags": [], "owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "is_accepted": true, "score": 0, "last_activity_date": 1562773747, "creation_date": 1562773747, "answer_id": 56974385, "question_id": 56973517, "link": "https://stackoverflow.com/questions/56973517/quicksort-implementation-not-sorting-in-c/56974385#56974385", "title": "Quicksort implementation not sorting in C", "body": "<p>Two things wrong:</p>\n\n<ol>\n<li>You never call your sorting function.</li>\n<li>Once you fix (1), you'll find your partition function is completely broken. You're trying to use the <a href=\"https://en.wikipedia.org/wiki/Quicksort#Lomuto_partition_scheme\" rel=\"nofollow noreferrer\">Lomuto partition scheme</a> and it doesn't match anywhere close to what it should be.</li>\n</ol>\n\n<p>Whatever translation you performed for that algorithm for (2), it's wrong. The general algorithm for a Lomuto partition with a fixed pivot selection always at the end (a terrible choice, but that's beyond the scope of this question) is as follows:</p>\n\n<p><strong>Updated Partition Function</strong></p>\n\n<pre><code>// added to make the partition algorithm easier to understand.\nvoid swap_int(int *a, int *b)\n{\n    int tmp = *a;\n    *a  = *b;\n    *b = tmp;\n}\n\nint QuickSortPartition(int *array, int begin, int end){\n\n    int i=begin, j;\n\n    for (j = begin; j &lt;= end; j++)\n    {\n        if (array[j] &lt; array[end])\n            swap_int(array+j, array + i++);\n    }\n    swap_int(array+i, array+end);\n\n    return i;\n}\n</code></pre>\n\n<p>Here <code>i</code> denotes the active slot where the pivot value will eventually reside. Initially the pivot is stored at <code>array[end]</code>. Once the for-loop sweep is done, <code>i</code> is sitting on the slot where the final swap will put the pivot into place. It is also the return value of the function, used by the caller to denote what <em>not</em> to include in later recursions (because its value is already home).</p>\n\n<p>The final result looks like this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid printfArrays(int *array);\nvoid receiveArray(int *array);\nint QuickSortPartition(int *array, int begin, int end);\nvoid QuickSortFunction(int *array, int begin, int end);\n\n#define size 5\n\nint main (int argc, const char * argv[]){\n\n    int array[size];\n\n    receiveArray(array);\n    QuickSortFunction(array, 0, size-1);\n    printfArrays(array);\n\n    return 0;\n}\n\nvoid receiveArray(int* array){\n\n    int i = 0;\n    for (i = 0; i &lt; size; i++) {\n        printf(\"Insert value of [%d]: \", i);\n        scanf(\"%d\", array+i);\n    }\n}\n\nvoid printfArrays(int *array){\n\n    int i = 0;\n    for (i = 0; i &lt; size; i++) {\n        printf(\"Value sorted: %d\\n\", array[i]);\n    }\n}\n\nstatic void swap_int(int *a, int *b)\n{\n    int tmp = *a;\n    *a  = *b;\n    *b = tmp;\n}\n\nint QuickSortPartition(int *array, int begin, int end){\n\n    int i=begin, j;\n\n    for (j = begin; j &lt;= end; j++)\n    {\n        if (array[j] &lt; array[end])\n            swap_int(array+j, array + i++);\n    }\n    swap_int(array+i, array+end);\n\n    return i;\n}\n\nvoid QuickSortFunction(int *array, int begin, int end){\n\n    if (begin &lt; end) {\n        int pivot = QuickSortPartition(array, begin, end);\n        QuickSortFunction(array, begin, pivot - 1);\n        QuickSortFunction(array, pivot + 1, end);\n    }\n}\n</code></pre>\n\n<p><strong>Input</strong></p>\n\n<pre><code> 4 1 3 5 2\n</code></pre>\n\n<p><strong>Output</strong></p>\n\n<pre><code>Value sorted: 1\nValue sorted: 2\nValue sorted: 3\nValue sorted: 4\nValue sorted: 5\n</code></pre>\n\n<p>There are a <em>multitude</em> of other unrelated things in this code that would be wise to address (checking IO, a better pivot selection scheme such as median-of-three, etc.), but the basic problems are addressed above. </p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 8108118, "user_type": "registered", "profile_image": "https://graph.facebook.com/1457468444298426/picture?type=large", "display_name": "Lelre Ferreira", "link": "https://stackoverflow.com/users/8108118/lelre-ferreira"}, "is_accepted": false, "score": 0, "last_activity_date": 1562873228, "creation_date": 1562873228, "answer_id": 56996084, "question_id": 56973517, "link": "https://stackoverflow.com/questions/56973517/quicksort-implementation-not-sorting-in-c/56996084#56996084", "title": "Quicksort implementation not sorting in C", "body": "<p>Thank you all! I fixed the issues in the previous code and I ended up making another one using while, I will leave both here.</p>\n\n<pre><code>//\n//  Quick sort V2 fixed.c\n//  IFTM Exercises\n//\n//  Created by Lelre Ferreira on 7/11/19.\n//  Copyright \u00a9 2019 Lelre Ferreira. All rights reserved.\n//\n\n#define size 5\n#include &lt;stdio.h&gt;\n\nvoid printArray(int *array);\nvoid receiveArray(int *array);\n\nvoid QuickSwap(int* a, int* b);\nvoid QuickSort(int *array, int begin, int end);\nint  QuickSortPartition(int *array, int begin, int end);\n\nint main (int argc, const char * argv[]){\n\n    int array[size];\n\n    receiveArray(array);\n    QuickSort(array, 0, size-1);\n    printArray(array);\n\n    return 0;\n}\n\nvoid printArray(int *array){\n\n    int i = 0;\n    for (i = 0; i &lt; size; i++) {\n        printf(\"Value sorted: %d\\n\", array[i]);\n    }\n}\n\nvoid receiveArray(int *array){\n\n    int i = 0;\n    for (i = 0; i &lt; size; i++) {\n        printf(\"Insert value of [%d]: \", i);\n        scanf(\"%d\", &amp;array[i]);\n    }\n}\n\nvoid QuickSwap(int* a, int* b){\n\n    int x = *a;\n    *a = *b;\n    *b = x;\n}\n\nvoid QuickSort(int *array, int begin, int end){\n\n    if (begin &lt; end) {\n        int pivot = QuickSortPartition(array, begin, end);\n        QuickSort(array, begin, pivot - 1);\n        QuickSort(array, pivot + 1, end);\n    }\n}\n\nint QuickSortPartition(int *array, int begin, int end){\n\n    int pivot = array[end];\n    int i = begin - 1, j = 0;\n\n    for (j = begin; j &lt;= end - 1; j++) {\n        if (array[j] &lt;= pivot) {\n            i++;\n            QuickSwap(&amp;array[i], &amp;array[j]);\n        }\n    }\n    QuickSwap(&amp;array[i + 1], &amp;array[j]);\n    return (i + 1);\n}\n</code></pre>\n\n<p>Second version: </p>\n\n<pre><code>//\n//  Quick sort V1.c\n//  IFTM Exercises\n//\n//  Created by Lelre Ferreira on 7/8/19.\n//  Copyright \u00a9 2019 Lelre Ferreira. All rights reserved.\n//\n\n#define size 5\n#include &lt;stdio.h&gt;\n\nvoid printArray(int *array);\nvoid QuickSortFunction(int *array, int begin, int end);\nint QuickSortPartition(int *array, int begin, int end);\n\nint main (int argc, const char * argv[]){\n\n    int array[] = {2, 3, 1, 5, 4};\n\n        QuickSortFunction (array, 0, size-1);\n        printArray(array);\n\n    return 0;\n}\n\nvoid printArray(int* array){\n\n    int i = 0;\n    for (i = 0; i &lt; size; i++) {\n        printf(\"Value sorted: %d\\n\", array[i]);\n    }\n}\n\nint QuickSortPartition(int *array, int begin, int end){\n\n    int left, right;\n    int pivot, aux;\n\n    right = end;\n    left = begin;\n    pivot = array[begin];\n\n    while (left &lt; right) {\n        while (array[left] &lt;= pivot)\n            left++;\n        while (array[right] &gt; pivot)\n                right--;\n                if (left &lt; right) {\n                    aux = array[left];\n                    array[left] = array[right];\n                    array[right] = aux;\n                }\n            }\n\n            array[begin] = array[right];\n            array[right] = pivot;\n            return right;\n}\n\nvoid QuickSortFunction(int *array, int begin, int end){\n\n    if (begin &lt; end) {\n        int pivot = QuickSortPartition(array, begin, end);\n        QuickSortFunction(array, begin, pivot - 1);\n        QuickSortFunction(array, pivot + 1, end);\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8108118, "user_type": "registered", "profile_image": "https://graph.facebook.com/1457468444298426/picture?type=large", "display_name": "Lelre Ferreira", "link": "https://stackoverflow.com/users/8108118/lelre-ferreira"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "accepted_answer_id": 56974385, "answer_count": 3, "score": -1, "last_activity_date": 1562873228, "creation_date": 1562770769, "last_edit_date": 1562773650, "question_id": 56973517, "link": "https://stackoverflow.com/questions/56973517/quicksort-implementation-not-sorting-in-c", "title": "Quicksort implementation not sorting in C", "body": "<p>It's been 2 days I'm trying to write a quicksort implementation in C but it does not work. I mean, it does compile but the output is not what I expected.</p>\n\n<p>I have been studying a Data Struct book, it's translated to portuguese tho, my native language, anyway... I'll past the instructions here below along with my code.</p>\n\n<p><a href=\"https://i.stack.imgur.com/Tb2NU.png\" rel=\"nofollow noreferrer\">QuickSort Image</a>\n<a href=\"https://i.stack.imgur.com/AdMdl.png\" rel=\"nofollow noreferrer\">Partition Image</a></p>\n\n<pre><code>//\n//  Quick sort V2.c\n//  IFTM Exercises\n//\n//  Created by Lelre Ferreira on 7/9/19.\n//  Copyright \u00a9 2019 Lelre Ferreira. All rights reserved.\n//\n\n#define size 5\n#include &lt;stdio.h&gt;\n\nvoid printfArrays(int *array);\nvoid receiveArray(int *array);\nint QuickSortPartition(int *array, int begin, int end);\nvoid QuickSortFunction(int *array, int begin, int end);\n\n\nint main (int argc, const char * argv[]){\n\n    int array[size];\n\n    receiveArray(array);\n    printfArrays(array);\n\n    return 0;\n}\n\nvoid receiveArray(int* array){\n\n    int i = 0;\n    for (i = 0; i &lt; size; i++) {\n        printf(\"Insert value of [%d]: \", i);\n        scanf(\"%d\", &amp;array[i]);\n    }\n}\n\nvoid printfArrays(int *array){\n\n    int i = 0;\n    for (i = 0; i &lt; size; i++) {\n        printf(\"Value sorted: %d\\n\", array[i]);\n    }\n}\n\nint QuickSortPartition(int *array, int begin, int end){\n\n\n    int pivot = array[end];\n    int i = (begin - 1), j = 0;\n\n    for (j = begin; j &lt;= end - 1; j++) {\n        if (array[j] &lt;= pivot) {\n            i++;\n            array[i] = array[j];\n        }\n    }\n    array[i + 1] = array[end];\n    return (i + 1);\n}\n\nvoid QuickSortFunction(int *array, int begin, int end){\n\n    if (begin &lt; end) {\n        int pivot = QuickSortPartition(array, begin, end);\n        QuickSortPartition(array, begin, pivot - 1);\n        QuickSortPartition(array, pivot + 1, end);\n    }\n\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1562770245, "post_id": 56973310, "comment_id": 100482928, "body": "So. what type is <code>op</code> and which values can it have? What is the return type of your function and which values can it return?"}, {"owner": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "edited": false, "score": 2, "creation_date": 1562770274, "post_id": 56973310, "comment_id": 100482944, "body": "<code>op</code> is a single character, so you can&#39;t <code>strcat()</code> it."}, {"owner": {"reputation": 1, "user_id": 11754703, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6de76fb96e874d883e601ab159886610?s=128&d=identicon&r=PG&f=1", "display_name": "ilvba0102", "link": "https://stackoverflow.com/users/11754703/ilvba0102"}, "edited": false, "score": 0, "creation_date": 1562770435, "post_id": 56973310, "comment_id": 100483033, "body": "Please tell me specifically. How to modify it."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1562772296, "post_id": 56973310, "comment_id": 100484116, "body": "You need to go back to your textbook or tutorial and study the difference between characters and strings."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1562773395, "post_id": 56973310, "comment_id": 100484747, "body": "There are lots of questions with solutions to this problem"}], "answers": [{"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1562775170, "post_id": 56974241, "comment_id": 100485721, "body": "When is the string null-terminated?  Well, it isn&#39;t null-terminated, so it isn&#39;t actually a string \u2014 by definition, a string is null-terminated.  You could use <code>printf(&quot;%8.8s\\n&quot;, str);</code> to safely print the byte array without spaces between the digits."}], "tags": [], "owner": {"reputation": 1898, "user_id": 10911932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iZ5XI.gif?s=128&g=1", "display_name": "j23", "link": "https://stackoverflow.com/users/10911932/j23"}, "is_accepted": false, "score": 1, "last_activity_date": 1562775208, "last_edit_date": 1562775208, "creation_date": 1562773233, "answer_id": 56974241, "question_id": 56973310, "link": "https://stackoverflow.com/questions/56973310/how-to-convert-to-binary-as-string-in-code-c/56974241#56974241", "title": "How to convert to binary as string in code C", "body": "<p>I have tried to modify your solution with minimal changes to make it work. There are elegant solutions to convert Integer to Binary for example using shift operators. </p>\n\n<p>One of the main issue in the code was you were using character instead of character array.\ni.e <code>char str;</code> instead of <code>char str[SIZE];</code> \nAlso you were performing string operations on a single character. Additionally, iostream header file is for C++. </p>\n\n<p>There is room for lot of improvements in the solution posted below (I only made your code work with minimal changes). </p>\n\n<p>My suggestion is to make your C basics strong and approach this problem again.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nvoid converttobinary(int n, char *op)\n{\n    int i;\n    int a[8];\n    for (i = 0; i &lt; 8; i++)\n    {\n        a[i] = n % 2;\n        n = (n - a[i]) / 2;\n    }\n    for (i = 7; i &gt;= 0; i--)\n    {\n        op[i]=a[i];\n    }\n\n}\nint main()\n{\n    int n,i;\n    char str[8];\n    n = 8;\n    converttobinary(n,str);\n    for (i = 7; i &gt;= 0; i--)\n    {\n        printf(\" %d \",str[i]);\n    }\n    return 0;\n\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": 0, "last_activity_date": 1562773665, "creation_date": 1562773665, "answer_id": 56974360, "question_id": 56973310, "link": "https://stackoverflow.com/questions/56973310/how-to-convert-to-binary-as-string-in-code-c/56974360#56974360", "title": "How to convert to binary as string in code C", "body": "<pre><code>char *rev(char *str)\n{\n    char *end = str + strlen(str) - 1;\n    char *saved = str;\n    while(end &gt; str)\n    {\n        int tmp = *str;\n        *str++ = *end;\n        *end-- = tmp;\n    }\n    return saved;\n}\n\nchar *tobin(char *buff, unsigned long long data)\n{\n    char *saved = buff;\n\n    while(data)\n    {\n        *buff++ = (data &amp; 1) + '0';\n        data &gt;&gt;= 1;\n    }\n    *buff = 0;\n    return rev(saved);\n}\n\nint main()\n{\n\n    char x[128];\n    unsigned long long z = 0x103;\n    printf(\"%llu is 0b%s\\n\", z, tobin(x, z));\n\n    return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1562775281, "post_id": 56974757, "comment_id": 100485785, "body": "The output &#39;string&#39; isn&#39;t null terminated, so it isn&#39;t a string, and you can&#39;t safely print it with <code>%s</code>.  You could use <code>printf(&quot;%8.8s\\n&quot;, op);</code> to print the byte-array."}, {"owner": {"reputation": 33, "user_id": 11333415, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-UvVTCu-hA9c/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdWBfhosrxq3DqXgbHTX6ehjOu-Hg/mo/photo.jpg?sz=128", "display_name": "Marc Aynes", "link": "https://stackoverflow.com/users/11333415/marc-aynes"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1562775688, "post_id": 56974757, "comment_id": 100486014, "body": "@JonathanLeffler thats true i just fix it thanks :)"}], "tags": [], "owner": {"reputation": 33, "user_id": 11333415, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-UvVTCu-hA9c/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdWBfhosrxq3DqXgbHTX6ehjOu-Hg/mo/photo.jpg?sz=128", "display_name": "Marc Aynes", "link": "https://stackoverflow.com/users/11333415/marc-aynes"}, "is_accepted": false, "score": 0, "last_activity_date": 1562776155, "last_edit_date": 1562776155, "creation_date": 1562775148, "answer_id": 56974757, "question_id": 56973310, "link": "https://stackoverflow.com/questions/56973310/how-to-convert-to-binary-as-string-in-code-c/56974757#56974757", "title": "How to convert to binary as string in code C", "body": "<p>I modify your code a little bit to make what you want,\nthe result of this code with </p>\n\n<pre><code>n = 10\n</code></pre>\n\n<p>is </p>\n\n<pre><code>00001010\n</code></pre>\n\n<p>In this code i shift the bits n positions of the imput and compare if there is 1 or 0 in this position and write a '1' if there is a 1 or a '0' if we have a 0.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nvoid converttobinary(int n, char op[8]){\n    int auxiliar = n;\n    int i;\n\n    for (i = 0; i &lt; 8; i++) {\n        auxiliar = auxiliar &gt;&gt; i;\n        if (auxiliar &amp; 1 == 1){\n            op[7-i] = '1';\n        } else{\n            op[7-i] = '0';\n        }\n        auxiliar = n;\n    }\n\n}\n\nint main (void){\n    int n = 10;\n    int i;\n    char op[8];\n\n    converttobinary(n, op);\n\n    for(i = 7; i &gt; -1; i--){\n        printf(\"%c\",op[i]);\n    }\n\n    return 0;\n\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11754703, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6de76fb96e874d883e601ab159886610?s=128&d=identicon&r=PG&f=1", "display_name": "ilvba0102", "link": "https://stackoverflow.com/users/11754703/ilvba0102"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 415, "favorite_count": 0, "answer_count": 3, "score": -1, "last_activity_date": 1562776155, "creation_date": 1562770169, "last_edit_date": 1562775010, "question_id": 56973310, "link": "https://stackoverflow.com/questions/56973310/how-to-convert-to-binary-as-string-in-code-c", "title": "How to convert to binary as string in code C", "body": "<p>I am trying to convert int to binary as string but I can not.\nPlease help me. How to convert integer to binary, please tell me.</p>\n\n<pre><code>Input: 32\nOutput: 00100000\n</code></pre>\n\n<p>My code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\nchar converttobinary(int n)\n{\n    int i;\n    int a[8];\n    char op;\n    for (i = 0; i &lt; 8; i++)\n    {\n        a[i] = n % 2;\n        n = (n - a[i]) / 2;\n    }\n    for (i = 7; i &gt;= 0; i--)\n    {\n        op = strcat(op, a[i]);\n    }\n    return op;\n}\nint main()\n{\n    int n;\n    char str;\n    n = 254;\n    str = converttobinary(n);\n    printf(\"%c\", str);\n    return 0;\n\n}\n\n</code></pre>\n"}, {"tags": ["c", "arduino", "esp32"], "comments": [{"owner": {"reputation": 1426, "user_id": 9513106, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-kE-fGMmORt4/AAAAAAAAAAI/AAAAAAAAAY4/juZ7cF2UgAQ/photo.jpg?sz=128", "display_name": "Kentaro Okuda", "link": "https://stackoverflow.com/users/9513106/kentaro-okuda"}, "edited": false, "score": 0, "creation_date": 1562769382, "post_id": 56972560, "comment_id": 100482400, "body": "Is ESP32 5V tolerant?"}, {"owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "reply_to_user": {"reputation": 1426, "user_id": 9513106, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-kE-fGMmORt4/AAAAAAAAAAI/AAAAAAAAAY4/juZ7cF2UgAQ/photo.jpg?sz=128", "display_name": "Kentaro Okuda", "link": "https://stackoverflow.com/users/9513106/kentaro-okuda"}, "edited": false, "score": 0, "creation_date": 1562769523, "post_id": 56972560, "comment_id": 100482494, "body": "@KentaroOkuda No, it is not 5V-tolerant."}, {"owner": {"reputation": 1426, "user_id": 9513106, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-kE-fGMmORt4/AAAAAAAAAAI/AAAAAAAAAY4/juZ7cF2UgAQ/photo.jpg?sz=128", "display_name": "Kentaro Okuda", "link": "https://stackoverflow.com/users/9513106/kentaro-okuda"}, "edited": false, "score": 0, "creation_date": 1562769596, "post_id": 56972560, "comment_id": 100482540, "body": "Then, the pin may have been damaged when 5V was applied."}, {"owner": {"reputation": 45, "user_id": 3756137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f457c903e8ead44664914d90e1c663e?s=128&d=identicon&r=PG&f=1", "display_name": "Praveen", "link": "https://stackoverflow.com/users/3756137/praveen"}, "edited": false, "score": 0, "creation_date": 1562777141, "post_id": 56972560, "comment_id": 100486692, "body": "No. It is not damaged. I try using the same sensor after disabling Bluetooth and it works. I can assure pin is not damaged as it is able to read everything without Bluetooth. If someone knows about the library, please confirm if it is using some kind of a timer or interrupt which is disturbing these two pins."}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 3756137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f457c903e8ead44664914d90e1c663e?s=128&d=identicon&r=PG&f=1", "display_name": "Praveen", "link": "https://stackoverflow.com/users/3756137/praveen"}, "edited": false, "score": 0, "creation_date": 1589187900, "post_id": 57163513, "comment_id": 109182985, "body": "This makes sense. Thanks. Checking the ESP32 documentation again now."}], "tags": [], "owner": {"reputation": 126, "user_id": 6544572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/211b7a2910b433a4583d64fbfec62908?s=128&d=identicon&r=PG&f=1", "display_name": "Rudy", "link": "https://stackoverflow.com/users/6544572/rudy"}, "is_accepted": true, "score": 0, "last_activity_date": 1563882344, "creation_date": 1563882344, "answer_id": 57163513, "question_id": 56972560, "link": "https://stackoverflow.com/questions/56972560/esp32-analog-pin-not-reading-when-bluetooth-is-connected/57163513#57163513", "title": "ESP32 Analog pin not reading when bluetooth is connected", "body": "<p>There are two A/D converters in the ESP32 chip, ADC1 and ADC2. ADC2 pins can not be used when Wi-Fi or Bluetooth is used. Pins connected to ADC1 do work. These are GPIO32-36 and GPIO39.</p>\n"}], "owner": {"reputation": 45, "user_id": 3756137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f457c903e8ead44664914d90e1c663e?s=128&d=identicon&r=PG&f=1", "display_name": "Praveen", "link": "https://stackoverflow.com/users/3756137/praveen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 728, "favorite_count": 0, "accepted_answer_id": 57163513, "answer_count": 1, "score": 0, "last_activity_date": 1563882344, "creation_date": 1562767788, "last_edit_date": 1562773019, "question_id": 56972560, "link": "https://stackoverflow.com/questions/56972560/esp32-analog-pin-not-reading-when-bluetooth-is-connected", "title": "ESP32 Analog pin not reading when bluetooth is connected", "body": "<p>I have been using ESP32 and writing code in Arduino. However, when I enable Bluetooth, GPIO4 and GPIO15 does not work to read analog inputs. I have connected IR LED's on both pins and reading analog signals. If Bluetooth code is not used, ESP32 is reading the analog signals and displaying it on serial monitor. If the below Bluetooth code is used, the reading is shown as 255 on both pins (reading 5v. Yes, they are 5v for now and will be level shifted to 3.3v). </p>\n\n<p>Can someone please check and suggest a solution?</p>\n\n<p>I have switched the sensors, removed them and whatever I do, the reading is the same when Bluetooth is read</p>\n\n<p>Bluetooth code:</p>\n\n<pre><code>void init_bluetooth() {\n      ESP_BT.begin(\"EKA Robot\"); //Name of your Bluetooth Signal\n      Serial.println(\"Bluetooth Device is Ready to Pair\");\n}\n</code></pre>\n\n<p>IR code:</p>\n\n<pre><code>    // Read Infrared LED on GPIO4. Similar function exists to read GPIO15\n    int readIR() {\n      int sensorValue = analogRead(oaPinL);\n      delay(5);\n      sensorValue = map(sensorValue, 0, 4095, 0, 255);\n      return (sensorValue);\n    }\n</code></pre>\n\n<p>I expect to read the sensor values. However, all it shows is 255. Does it mean it is somehow pulled high?</p>\n"}, {"tags": ["c", "pointers", "struct", "malloc"], "comments": [{"owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 4, "creation_date": 1562767664, "post_id": 56972477, "comment_id": 100481331, "body": "The return type should match the thing you return. You don&#39;t return a <code>int</code>, you don&#39;t return a <code>int*</code>, so why did you try these return types? You&#39;re returning a <code>struct book*</code> so thats what your return type should be..."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1562767679, "post_id": 56972477, "comment_id": 100481349, "body": "<code>int init_book(struct book *p_book, ...</code> means your function returns <code>int</code>.  <code>p_book</code> is a pointer, so what do you expect <code>return p_book;</code> to do?  And if you&#39;re passing the address of an actual <code>struct book</code> to your function, this line means you don&#39;t initialize the <code>struct</code> that you passed the address of."}, {"owner": {"reputation": 1340, "user_id": 7218062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0e0d5a2d3c49c93f1aafd67adaaca59?s=128&d=identicon&r=PG&f=1", "display_name": "jmq", "link": "https://stackoverflow.com/users/7218062/jmq"}, "edited": false, "score": 1, "creation_date": 1562767682, "post_id": 56972477, "comment_id": 100481351, "body": "Show us the definition of book.  You probably don&#39;t need to malloc space for each field in the book structure."}, {"owner": {"reputation": 9, "user_id": 11511504, "user_type": "registered", "profile_image": "https://graph.facebook.com/2350608004962661/picture?type=large", "display_name": "vNdong", "link": "https://stackoverflow.com/users/11511504/vndong"}, "edited": false, "score": 0, "creation_date": 1562767997, "post_id": 56972477, "comment_id": 100481546, "body": "<code>&#47;&#47; Single book entry     struct book {         char id[10];         const char *title;         const char *author;         struct date release_date;     };</code>"}, {"owner": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 1, "creation_date": 1562771402, "post_id": 56972477, "comment_id": 100483586, "body": "In <code>struct book</code>, <code>title</code> and <code>author</code> are declared as <code>const char *</code>. Is that part of the assignment or an idea of yours?"}], "answers": [{"comments": [{"owner": {"reputation": 367, "user_id": 10930163, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a82a32b93373e472ee666e96b00d1b5?s=128&d=identicon&r=PG&f=1", "display_name": "anonmess", "link": "https://stackoverflow.com/users/10930163/anonmess"}, "reply_to_user": {"reputation": 480272, "user_id": 1968, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd630f72eef3790bfb4ef38d08c7f85?s=128&d=identicon&r=PG", "display_name": "Konrad Rudolph", "link": "https://stackoverflow.com/users/1968/konrad-rudolph"}, "edited": false, "score": 0, "creation_date": 1562768176, "post_id": 56972551, "comment_id": 100481667, "body": "@KonradRudolph thanks for the catch, I removed that part"}, {"owner": {"reputation": 9, "user_id": 11511504, "user_type": "registered", "profile_image": "https://graph.facebook.com/2350608004962661/picture?type=large", "display_name": "vNdong", "link": "https://stackoverflow.com/users/11511504/vndong"}, "edited": false, "score": 0, "creation_date": 1562768231, "post_id": 56972551, "comment_id": 100481705, "body": "It was specified in the assignment that the function should be of type <code>int init_book()</code> so I dont think that would work in the automatic check"}, {"owner": {"reputation": 367, "user_id": 10930163, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a82a32b93373e472ee666e96b00d1b5?s=128&d=identicon&r=PG&f=1", "display_name": "anonmess", "link": "https://stackoverflow.com/users/10930163/anonmess"}, "reply_to_user": {"reputation": 9, "user_id": 11511504, "user_type": "registered", "profile_image": "https://graph.facebook.com/2350608004962661/picture?type=large", "display_name": "vNdong", "link": "https://stackoverflow.com/users/11511504/vndong"}, "edited": false, "score": 1, "creation_date": 1562768313, "post_id": 56972551, "comment_id": 100481752, "body": "@vNdong then, as others have mentioned, look into passing the <code>struct book</code> by reference, then you won&#39;t need to return it and could instead return, for example, a success/failure integer"}], "tags": [], "owner": {"reputation": 367, "user_id": 10930163, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a82a32b93373e472ee666e96b00d1b5?s=128&d=identicon&r=PG&f=1", "display_name": "anonmess", "link": "https://stackoverflow.com/users/10930163/anonmess"}, "is_accepted": false, "score": 0, "last_activity_date": 1562768149, "last_edit_date": 1562768149, "creation_date": 1562767751, "answer_id": 56972551, "question_id": 56972477, "link": "https://stackoverflow.com/questions/56972477/return-makes-integer-from-pointer-without-a-cast-when-returning-a-struct/56972551#56972551", "title": "return makes integer from pointer without a cast when returning a struct", "body": "<p>The return type of a function should match the type of whatever you're trying to return. So to return <code>p_book</code>, of type <code>struct book *</code>, then your return type should be <code>struct book *</code>. </p>\n"}, {"tags": [], "owner": {"reputation": 480272, "user_id": 1968, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd630f72eef3790bfb4ef38d08c7f85?s=128&d=identicon&r=PG", "display_name": "Konrad Rudolph", "link": "https://stackoverflow.com/users/1968/konrad-rudolph"}, "is_accepted": true, "score": 1, "last_activity_date": 1562774550, "last_edit_date": 1562774550, "creation_date": 1562768183, "answer_id": 56972703, "question_id": 56972477, "link": "https://stackoverflow.com/questions/56972477/return-makes-integer-from-pointer-without-a-cast-when-returning-a-struct/56972703#56972703", "title": "return makes integer from pointer without a cast when returning a struct", "body": "<p>You are attempting to return a <code>struct book *</code> but you declared the function as returning <code>int</code> (or <code>int *</code>). This can\u2019t work.</p>\n\n<p>You need to change the return type to <code>struct book *</code>. Next, remove the unnecessary <code>p_book</code> parameter and convert it into a local variable: It has no use. The result looks like this:</p>\n\n<pre><code>struct book *init_book(const char *p_id, const char *p_title, const char * p_author, struct date p_release) {\n    struct book *p_book = malloc(sizeof *p_book);\n    for (int i = 0; i &lt; 10; i++) {\n        p_book-&gt;id[i] = p_id[i];\n    }\n    p_book-&gt;title = malloc(strlen(p_title) + 1);\n    p_book-&gt;author = malloc(strlen(p_author) + 1);\n    strcpy(p_book-&gt;title, p_title);\n    strcpy(p_book-&gt;author, p_author);\n    p_book-&gt;release_date = p_release;\n    return p_book;\n}\n</code></pre>\n\n<p>(I\u2019ve also fixed the errors in the string allocation and copying in your code: your code didn\u2019t allocate sufficient space, but the allocation was leaked anyway since you moved pointers instead of copying the contents.)</p>\n\n<p>And it\u2019s called like this:</p>\n\n<pre><code>struct book *p_book = init_book(\"000000009\", \"Harry Potter and the Philosopher's Stone\", \"J. K. Rowling\", a1date);\n\nif (p_book) {\n    printf(\"Initialization succeeded\\n\");\n    printf(\"%s\\n\", a1.title); \n} else {\n    printf(\"Initialization failed\\n\");\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "is_accepted": false, "score": 1, "last_activity_date": 1562776502, "last_edit_date": 1562776502, "creation_date": 1562775265, "answer_id": 56974795, "question_id": 56972477, "link": "https://stackoverflow.com/questions/56972477/return-makes-integer-from-pointer-without-a-cast-when-returning-a-struct/56974795#56974795", "title": "return makes integer from pointer without a cast when returning a struct", "body": "<p>I'm going to take a different approach to the other answers.  I think the return value of your function is intended to be a status rather than the initialized <code>struct book</code> since you are passing in a pointer to the <code>struct book</code> you wish to initialize.  In that case, you should not be <code>malloc</code>ing the book because the pointer you are passing in should already be to a valid memory location of a <code>struct book</code>.</p>\n\n<p>Use the return value to indicate whether an error has occurred in initialization.</p>\n\n<p>Without knowing more about your <code>struct book</code> it's hard to tell if you need to <code>malloc</code> any of the member variables, or just assign pointers.  If you do need to use <code>malloc</code>, then you can use the return code from your calls to <code>malloc</code> to set your own return value to indicate whether or not there was an error.</p>\n"}], "owner": {"reputation": 9, "user_id": 11511504, "user_type": "registered", "profile_image": "https://graph.facebook.com/2350608004962661/picture?type=large", "display_name": "vNdong", "link": "https://stackoverflow.com/users/11511504/vndong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 425, "favorite_count": 0, "accepted_answer_id": 56972703, "answer_count": 3, "score": 0, "last_activity_date": 1562776502, "creation_date": 1562767500, "last_edit_date": 1562773100, "question_id": 56972477, "link": "https://stackoverflow.com/questions/56972477/return-makes-integer-from-pointer-without-a-cast-when-returning-a-struct", "title": "return makes integer from pointer without a cast when returning a struct", "body": "<p>Im writing a code for a school project where we are defining a library and I cant get my function to return correctly</p>\n\n<p>I have tried to redefine my code and change int init_book to int *init_book but that only gives me other errors </p>\n\n<pre><code>int init_book(struct book *p_book, const char *p_id, const char *p_title, const char * p_author, struct date p_release) {\n    p_book = malloc(sizeof(struct book));\n    for (int i = 0; i &lt; 10; i++) {\n        p_book-&gt;id[i] = p_id[i];\n    }\n    p_book-&gt;title = malloc(strlen(p_title) * sizeof(char));\n    p_book-&gt;author = malloc(strlen(p_author) * sizeof(char));\n    p_book-&gt;title = p_title;\n    p_book-&gt;author = p_author;\n    p_book-&gt;release_date = p_release;\n    return p_book;\n}\n\n//a part of my main function that initiates the function\n\nif (init_book(&amp;a1, \"000000009\", \"Harry Potter and the Philosopher's Stone\", \"J. K. Rowling\", a1date)) {\n        printf(\"Initialization succeeded\\n\");\n        printf(\"%s\\n\", a1.title); \n                //it prints initialization succeeded but not a1.title\n    }\n    else {\n        printf(\"Initialization failed\\n\");\n    }\n</code></pre>\n"}, {"tags": ["c++", "c", "linux", "bash", "shell"], "comments": [{"owner": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "edited": false, "score": 0, "creation_date": 1562764811, "post_id": 56971631, "comment_id": 100479746, "body": "When you invoke the shell script child process, set up the environment variables to be used by the child process."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1562764848, "post_id": 56971631, "comment_id": 100479761, "body": "Environment variables are inherited by child processes created by <a href=\"http://man7.org/linux/man-pages/man2/fork.2.html\" rel=\"nofollow noreferrer\"><code>fork</code></a>."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1562765864, "post_id": 56971631, "comment_id": 100480288, "body": "... which includes those launched by a shell."}, {"owner": {"reputation": 1800, "user_id": 4769313, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/gFISt.png?s=128&g=1", "display_name": "Sir Jo Black", "link": "https://stackoverflow.com/users/4769313/sir-jo-black"}, "edited": false, "score": 0, "creation_date": 1562769924, "post_id": 56971631, "comment_id": 100482728, "body": "Why do you execute a script (shell script) that executes an executable? Why don&#39;t you call directly the executable? How does the executable called by the script receive the values!?"}, {"owner": {"reputation": 1800, "user_id": 4769313, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/gFISt.png?s=128&g=1", "display_name": "Sir Jo Black", "link": "https://stackoverflow.com/users/4769313/sir-jo-black"}, "edited": false, "score": 0, "creation_date": 1562770073, "post_id": 56971631, "comment_id": 100482811, "body": "A way to pass values to the shell script might be to call it passing all values on the shell command line something such: system(&quot;script.sh a b c d e f&quot;) ... but maybe is to broad."}, {"owner": {"reputation": 7, "user_id": 6330494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7dde6466a464867a479bbb4ae825b6e0?s=128&d=identicon&r=PG&f=1", "display_name": "Dilip ", "link": "https://stackoverflow.com/users/6330494/dilip"}, "edited": false, "score": 0, "creation_date": 1562839700, "post_id": 56971631, "comment_id": 100508018, "body": "My requirement is such that the script has to invoke the executable."}], "answers": [{"tags": [], "owner": {"reputation": 4854, "user_id": 11714114, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qKzVA.jpg?s=128&g=1", "display_name": "mario", "link": "https://stackoverflow.com/users/11714114/mario"}, "is_accepted": false, "score": 1, "last_activity_date": 1562771174, "creation_date": 1562771174, "answer_id": 56973654, "question_id": 56971631, "link": "https://stackoverflow.com/questions/56971631/how-to-share-my-cli-information-variable-etc-to-child-process-which-is-a-bash/56973654#56973654", "title": "How to share my cli information (variable, etc) to child process which is a bash shell script", "body": "<p>Simple <code>export</code> of your variables should do the job e.g.:</p>\n\n<p><code>export MY_VAR=my_value</code></p>\n\n<p>Exported variables are available for all subshells i.e. subshell spawned by your current shell, the subsequent shell spawned but the subshell and so on.</p>\n\n<p>Everything that is available in your current environment as <code>environment variable</code> ( which you can display it using <code>env</code> command ) is already exported and available for all subshells. Notice that any variable you have defined and exported is also on the list.</p>\n"}], "owner": {"reputation": 7, "user_id": 6330494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7dde6466a464867a479bbb4ae825b6e0?s=128&d=identicon&r=PG&f=1", "display_name": "Dilip ", "link": "https://stackoverflow.com/users/6330494/dilip"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1562771174, "creation_date": 1562764730, "question_id": 56971631, "link": "https://stackoverflow.com/questions/56971631/how-to-share-my-cli-information-variable-etc-to-child-process-which-is-a-bash", "title": "How to share my cli information (variable, etc) to child process which is a bash shell script", "body": "<p>I have a command-line interface (let's say mycli) which has its own properties (env variable, etc). mycli have a command which invokes a shell script (child process) which in turn invokes a c/cpp executable which wants to use variables/properties from mycli.</p>\n\n<p>Is there any way to pass such information in shell scripts which could be used by the invoked executable?</p>\n\n<p>Already browsed a lot but no luck.</p>\n"}, {"tags": ["c", "buffer"], "comments": [{"owner": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "edited": false, "score": 2, "creation_date": 1562764017, "post_id": 56970964, "comment_id": 100479231, "body": "I suggest to read the whole line with <code>fgets</code> and parse it with the help of <code>strtok</code> or <code>strchr</code>."}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1562776291, "post_id": 56970964, "comment_id": 100486299, "body": "Even if you get this working, it will be a truly abysmal translator. Why not use existing tools like Google&#39;s translation API?"}], "answers": [{"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 1, "last_activity_date": 1562765382, "creation_date": 1562765382, "answer_id": 56971823, "question_id": 56970964, "link": "https://stackoverflow.com/questions/56970964/how-to-read-word-for-word-that-are-only-separated-by-a-from-the-buffer/56971823#56971823", "title": "How to read word for word that are only separated by a &quot;:&quot; from the buffer?", "body": "<p>There are multiple problems with your code, among them</p>\n\n<ul>\n<li><p>On each loop iteration, you read from the <em>beginning</em> of the buffer.  It is natural, then, that each iteration extracts the same key and value.</p></li>\n<li><p>More generally, your read loop iteration variable seems to have no relationship with the data read.  It appears to be a per-byte iteration, but you seem to want a per-<em>line</em> iteration.  You might want to look into <code>scanf</code>'s <code>%n</code> directive to help you track progress through the buffer.</p></li>\n<li><p>You are scanning each key / value pair into the same local <code>k</code> and <code>v</code> variables, then you are assigning pointers to those variables to your structures.  The resulting pointers are all the same, <em>and</em> they will become invalid when the function returns.  I suggest giving <code>struct</code>key_value` arrays for its members instead of pointers, and copying the data into them.</p></li>\n<li><p>Your <code>sscanf</code> format reads up to 21 characters each for key and value, but the provided destination arrays are not long enough for that.  You need them to be dimensioned for at least 22 characters to hold 21 plus a string terminator.</p></li>\n<li><p>Your <code>sscanf()</code> format and usage do not support recognition of malformed input, especially overlength keys or values.  You need to check the return value, and you probably need to match the trailing newline with a <code>%c</code> field (the literal newline in the format does not mean what you think it means).</p></li>\n</ul>\n\n<p>Tokenizing (the whole buffer) with <code>strtok_r</code> or <code>strtok</code> or even <code>strchr</code> instead of <code>sscanf()</code> might be easier for you.</p>\n\n<p>Also, style note: your expressions of the form <code>(kv + i)-&gt;key</code> are valid, but it would be more idiomatic to write <code>kv[i].key</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 1800, "user_id": 4769313, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/gFISt.png?s=128&g=1", "display_name": "Sir Jo Black", "link": "https://stackoverflow.com/users/4769313/sir-jo-black"}, "is_accepted": true, "score": 0, "last_activity_date": 1562767948, "last_edit_date": 1562767948, "creation_date": 1562767198, "answer_id": 56972376, "question_id": 56970964, "link": "https://stackoverflow.com/questions/56970964/how-to-read-word-for-word-that-are-only-separated-by-a-from-the-buffer/56972376#56972376", "title": "How to read word for word that are only separated by a &quot;:&quot; from the buffer?", "body": "<p>I've written a simple piece of code that may help you to solve your problem. I've used the function <code>fgets</code> to read from a file named \"file.txt\" and the function <code>strchr</code> to individuate the 1st occurence of the separator <code>':'</code>.</p>\n\n<p>Here the code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;errno.h&gt;\n\n#define MAX_LINE_SIZE       256\n#define MAX_DECODED_LINE    1024\n\nstruct decod {\n    char key[MAX_LINE_SIZE];\n    char value[MAX_DECODED_LINE];\n};\n\nstatic struct decod decod[1024];\n\nint main(void)\n{\n    FILE * fptr = NULL;\n\n    char fbuf[MAX_LINE_SIZE];\n    char * value;\n    int cnt=0,i;\n\n    if ( !(fptr=fopen(\"file.txt\",\"r\")) )\n    {\n        perror(\"\");\n        return errno;\n    }\n\n    while( fgets(fbuf,MAX_LINE_SIZE,fptr)) {\n        // Eliminate UNIX/DOS line terminator\n        value=strrchr(fbuf,'\\n');\n        if (value) *value=0;\n        value=strrchr(fbuf,'\\r');\n        if (value) *value=0;\n\n        //Find first occurrence of the separator ':'\n        value=strchr(fbuf,':');\n        if (value) {\n            // Truncates fbuf string to first word\n            // and (++) points second word\n            *value++=0;\n        }\n\n        if (cnt&lt;MAX_DECODED_LINE) {\n            strcpy(decod[cnt].key,fbuf);\n            if (value!=NULL) {\n                strcpy(decod[cnt].value,value);\n            } else {\n                decod[cnt].value[0]=0;\n            }\n            cnt++;\n        } else {\n            fprintf(stderr,\n                 \"Cannot read more than %d lines\\n\", MAX_DECODED_LINE);\n            break;\n        }\n    }\n\n    if (fptr)\n        fclose(fptr);\n\n    for(i=0;i&lt;cnt;i++) {\n        printf(\"key:%s\\tvalue:%s\\n\",decod[i].key,decod[i].value);\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>This code reads all the lines (max 1024) that the file named file.txt contains, loads all individuated couples (max 1024) into the <code>struct array</code> <code>decod</code> and then printouts the content of the structure.</p>\n"}, {"comments": [{"owner": {"reputation": 4026, "user_id": 182811, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/96b3b4a6c0c2288b29164f36cd4fbfb7?s=128&d=identicon&r=PG", "display_name": "David M", "link": "https://stackoverflow.com/users/182811/david-m"}, "edited": false, "score": 0, "creation_date": 1562775416, "post_id": 56974648, "comment_id": 100485862, "body": "It&#39;s terribly nice of you to write a complete program for someone, but it may be difficult for them to compare their program to yours to see what the problem was. Brevity is the soul of both wit and good answers."}], "tags": [], "owner": {"reputation": 408, "user_id": 11762199, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SPIzL.jpg?s=128&g=1", "display_name": "mhrsalehi", "link": "https://stackoverflow.com/users/11762199/mhrsalehi"}, "is_accepted": false, "score": 0, "last_activity_date": 1562775342, "last_edit_date": 1562775342, "creation_date": 1562774725, "answer_id": 56974648, "question_id": 56970964, "link": "https://stackoverflow.com/questions/56970964/how-to-read-word-for-word-that-are-only-separated-by-a-from-the-buffer/56974648#56974648", "title": "How to read word for word that are only separated by a &quot;:&quot; from the buffer?", "body": "<p>I wrote this code, I think it does the job! this is simpler than the accepted answer I think! and it uses just as much as memory is needed, no more.  </p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\n\nstruct key_value{\n    char key[22];\n    char value[22];\n};\n\nvoid parse_str(char* str, struct key_value** kv_arr, int* num){\n\n    int  n    = 0;\n    int  read = -1;\n    char k[22];\n    char v[22];\n    int current_pos = 0;\n    int consumed    = 0;\n\n    /*counting number of key-value pairs*/\n    while (1){\n        if(current_pos &gt; strlen(str)){\n            break;\n        }\n        read = sscanf(str + current_pos, \"%21[^:]:%21[^\\n]\\n%n\", k, v, &amp;consumed);\n        current_pos += consumed;\n\n        if(read == 2){\n            ++n;\n        }\n    }\n    printf(\"n = %d\\n\", n);\n    *kv_arr = malloc(sizeof(struct key_value) * n);\n\n\n\n    /*filling key_value array*/\n    int i       = 0;\n    read        = -1;\n    current_pos = 0;\n    consumed    = 0;\n    while (1){\n        if(current_pos &gt; strlen(str)){\n            break;\n        }\n        read = sscanf(str + current_pos, \"%21[^:]:%21[^\\n]\\n%n\", k, v, &amp;consumed);\n        current_pos += consumed;\n\n        if(read == 2){\n            struct key_value* kv = &amp;((*kv_arr)[i]);\n            strncpy(kv-&gt;key, k, 22);\n            strncpy(kv-&gt;value, v, 22);\n            ++i;\n        }\n    }\n\n    *num = n;\n}\n\n\nint main(){\n\n    char* str = \"hola:hello\\n\"\n                \"que:what\\n\";\n\n    int n;\n    struct key_value* kv_arr;\n\n    parse_str(str, &amp;kv_arr, &amp;n);\n\n    for (int i = 0; i &lt; n; ++i) {\n        printf(\"%s  &lt;---&gt;  %s\\n\", kv_arr[i].key, kv_arr[i].value);\n    }\n\n\n    free(kv_arr);\n    return 0;\n}\n</code></pre>\n\n<p><strong>output :</strong> </p>\n\n<pre><code>n = 2\nhola  &lt;---&gt;  hello\nque  &lt;---&gt;  what\n</code></pre>\n\n<p>Process finished with exit code 0</p>\n\n<hr>\n\n<p><strong>Note</strong>: <code>sscanf</code> operates on a <code>const char*</code>, not an input stream from a file, so it will <strong>NOT</strong> store any information about what it has consumed.</p>\n\n<p><strong>solution</strong> :  I used <code>%n</code> in the format string to get the number of characters that it has consumed so far (C89 standard).</p>\n"}], "owner": {"reputation": 29, "user_id": 11755286, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-pBqCRUURAqY/AAAAAAAAAAI/AAAAAAAAATA/9n5KS1E1hao/photo.jpg?sz=128", "display_name": "Nacho Sanjose", "link": "https://stackoverflow.com/users/11755286/nacho-sanjose"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "accepted_answer_id": 56972376, "answer_count": 3, "score": 0, "last_activity_date": 1562775342, "creation_date": 1562762548, "last_edit_date": 1562763154, "question_id": 56970964, "link": "https://stackoverflow.com/questions/56970964/how-to-read-word-for-word-that-are-only-separated-by-a-from-the-buffer", "title": "How to read word for word that are only separated by a &quot;:&quot; from the buffer?", "body": "<p>I am making a language translator, and want to read from the buffer word by word and store them in a key-value struct.</p>\n\n<p>The buffer contains such a file: </p>\n\n<pre><code>hola:hello\nque:what\n</code></pre>\n\n<p>and so on. I already tried everything and I keep errors such as segmentation fault: 11 or just reading the same line again and again. </p>\n\n<pre><code>struct key_value{\nchar *key;\nchar *value;\n};\n</code></pre>\n\n<p>...</p>\n\n<pre><code>struct key_value *kv = malloc(sizeof(struct key_value) * count);\nchar k[20]; //key\nchar v[20]; //value\nint x = 0;\nfor(i = 0; i &lt; numbytes; i++){\n    sscanf(buffer,\"%21[^:]:%21[^\\n]\\n\",k,v);\n    (kv + i)-&gt;key = k;\n    (kv + i)-&gt;value = v;\n}\n\nfor(i = 0; i &lt; count; i++){\n    printf(\"key:  %s, value:  %s\\n\",(kv + i)-&gt;key,(kv + i)-&gt;value);\n}\n\nfree(buffer);\nfree(kv);\n</code></pre>\n\n<p>I expect the output to be <code>key: hola, value: hello key: que, value: what</code>,\nbut the actual output is just <code>key: hola, value: hello</code> again and again.</p>\n\n<p>Which is the right way to do it?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 1, "creation_date": 1562762292, "post_id": 56970844, "comment_id": 100478226, "body": "Welcome to SO. What does &quot;not working&quot; mean? What input do you provide, what output do you expect and what output did you get?"}, {"owner": {"reputation": 915, "user_id": 3254536, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c4d61200a78c3d51c929553f2a3c5de8?s=128&d=identicon&r=PG&f=1", "display_name": "Neijwiert", "link": "https://stackoverflow.com/users/3254536/neijwiert"}, "edited": false, "score": 0, "creation_date": 1562762449, "post_id": 56970844, "comment_id": 100478324, "body": "<code>strcmp</code> is case-sensitive, in case you&#39;re inputting &#39;John&#39; or something like that"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 2, "creation_date": 1562762450, "post_id": 56970844, "comment_id": 100478325, "body": "Did you take into account that <code>fgets</code> will store the newline character in the buffer? See <a href=\"http://man7.org/linux/man-pages/man3/fgets.3p.html\" rel=\"nofollow noreferrer\">manpage</a>"}, {"owner": {"reputation": 3, "user_id": 11230922, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tdo2F.jpg?s=128&g=1", "display_name": "someoneidontwanttosay", "link": "https://stackoverflow.com/users/11230922/someoneidontwanttosay"}, "edited": false, "score": 0, "creation_date": 1562762797, "post_id": 56970844, "comment_id": 100478541, "body": "i means in output when i write john , i don&#39;t see any hello john print"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1562831817, "post_id": 56970844, "comment_id": 100503597, "body": "You probably mean, when you input <code>&quot;john\\n&quot;</code>"}, {"owner": {"reputation": 3, "user_id": 11230922, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tdo2F.jpg?s=128&g=1", "display_name": "someoneidontwanttosay", "link": "https://stackoverflow.com/users/11230922/someoneidontwanttosay"}, "edited": false, "score": 0, "creation_date": 1562842895, "post_id": 56970844, "comment_id": 100509906, "body": "Gerhardh thank you bro. you made my way easier"}], "answers": [{"comments": [{"owner": {"reputation": 915, "user_id": 3254536, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c4d61200a78c3d51c929553f2a3c5de8?s=128&d=identicon&r=PG&f=1", "display_name": "Neijwiert", "link": "https://stackoverflow.com/users/3254536/neijwiert"}, "edited": false, "score": 1, "creation_date": 1562762958, "post_id": 56971021, "comment_id": 100478634, "body": "What happens if <code>fgets</code> fails?"}, {"owner": {"reputation": 3, "user_id": 11230922, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tdo2F.jpg?s=128&g=1", "display_name": "someoneidontwanttosay", "link": "https://stackoverflow.com/users/11230922/someoneidontwanttosay"}, "edited": false, "score": 0, "creation_date": 1562763236, "post_id": 56971021, "comment_id": 100478805, "body": "Thank you very much. GOOD LUCK"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1562763548, "post_id": 56971021, "comment_id": 100478967, "body": "From the docs: &quot;<i>If the stream is        at end-of-file [...] fgets() shall return a null pointer.</i>&quot; IF  the user just pressed Ctrl-D (UNIX) or Ctrl-Z (Windows) EOF is set."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1562763820, "post_id": 56971021, "comment_id": 100479111, "body": "... which in turn mean nothing is read into <code>str</code> and this <code>str[strcspn(str, &quot;\\n&quot;)] = 0;</code> would invoke undefined behaviour and the program in the best case would just crash."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1562763974, "post_id": 56971021, "comment_id": 100479201, "body": "The same would happen if input to the program had been redirect to an empty file. All in all  <code>fixedFgets()</code>  is good example how exactly <b><i>not</i></b> to do it, namely <i>not</i> to check the outcome of a relevant function call."}, {"owner": {"reputation": 64, "user_id": 11755527, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pEPIG.png?s=128&g=1", "display_name": "Slack Bot", "link": "https://stackoverflow.com/users/11755527/slack-bot"}, "reply_to_user": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1562764007, "post_id": 56971021, "comment_id": 100479223, "body": "Thanks for your point. You can add a simple <code>if (fgets(str, n, stdin) != NULL)</code> @alk"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1562764071, "post_id": 56971021, "comment_id": 100479273, "body": "<i>I</i> know this, but <i>you</i> give bad advise to the world. Please you fix your proposal."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1562764171, "post_id": 56971021, "comment_id": 100479337, "body": "And in any case another call to <code>ferror()</code> is strongly recommended if <code>fgets()</code> returned <code>NULL</code>, to exactly distinguish between EOF and an error."}, {"owner": {"reputation": 64, "user_id": 11755527, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pEPIG.png?s=128&g=1", "display_name": "Slack Bot", "link": "https://stackoverflow.com/users/11755527/slack-bot"}, "reply_to_user": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1562764238, "post_id": 56971021, "comment_id": 100479378, "body": "Great. Thank you very much @alk"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1562764519, "post_id": 56971021, "comment_id": 100479559, "body": "The last change makes things even worth as the caller has no clue if the string passed in has successfully been set or not."}], "tags": [], "owner": {"reputation": 64, "user_id": 11755527, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pEPIG.png?s=128&g=1", "display_name": "Slack Bot", "link": "https://stackoverflow.com/users/11755527/slack-bot"}, "is_accepted": false, "score": 1, "last_activity_date": 1563035244, "last_edit_date": 1563035244, "creation_date": 1562762769, "answer_id": 56971021, "question_id": 56970844, "link": "https://stackoverflow.com/questions/56970844/why-strcmp-or-strncmp-not-working-on-c-programming-language/56971021#56971021", "title": "why strcmp or strncmp not working on c programming language?", "body": "<p>The problem is with the <code>fgets</code>.\nFix the new line bug:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint fixedFgets(char str[], int n);\n\nint main() {\n    char name[20];\n    printf(\"Whats your name: \");\n\n    if (fixedFgets(name, 20))\n    {\n        printf(\"hello, %s\\n\", name);\n\n        if (strcmp(name, \"john\") == 0) {\n            printf(\"hello john.\");\n        }\n    }\n\n    return 0;\n}\n\n/*\n    Function will perform the fgets command and also remove the newline\n    that might be at the end of the string - a known issue with fgets.\n*/\nint fixedFgets(char str[], int n)\n{\n    int success = 1;\n\n    // Check that fgets worked\n    if (fgets(str, n, stdin) != NULL)\n    {\n         str[strcspn(str, \"\\n\")] = 0;\n    }\n    else\n    {\n        success = 0;\n    }\n\n    return success;\n}\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11230922, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tdo2F.jpg?s=128&g=1", "display_name": "someoneidontwanttosay", "link": "https://stackoverflow.com/users/11230922/someoneidontwanttosay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "closed_date": 1562763022, "answer_count": 1, "score": 0, "last_activity_date": 1563035244, "creation_date": 1562762113, "question_id": 56970844, "link": "https://stackoverflow.com/questions/56970844/why-strcmp-or-strncmp-not-working-on-c-programming-language", "closed_reason": "Duplicate", "title": "why strcmp or strncmp not working on c programming language?", "body": "<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\nint main(){\n    char name[20];\n    printf(\"Whats your name: \");\n    fgets(name,20,stdin);\n    printf(\"hello, %s\", name);\n    if(strcmp(name, \"john\")==0){\n        printf(\"hello john.\");\n    }\n    return 0;\n}\n</code></pre>\n\n<p>im a java developer an newly in C . why strcmp not working. help me please</p>\n"}, {"tags": ["c++", "c", "wix", "windows-installer", "custom-action"], "comments": [{"owner": {"reputation": 8766, "user_id": 451321, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/7Sdao.jpg?s=128&g=1", "display_name": "Michael Chourdakis", "link": "https://stackoverflow.com/users/451321/michael-chourdakis"}, "edited": false, "score": 1, "creation_date": 1562758802, "post_id": 56969925, "comment_id": 100476315, "body": "That&#39;s why digital signatures are there."}, {"owner": {"reputation": 81, "user_id": 2302219, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/idYX4.jpg?s=128&g=1", "display_name": "slayer69", "link": "https://stackoverflow.com/users/2302219/slayer69"}, "reply_to_user": {"reputation": 8766, "user_id": 451321, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/7Sdao.jpg?s=128&g=1", "display_name": "Michael Chourdakis", "link": "https://stackoverflow.com/users/451321/michael-chourdakis"}, "edited": false, "score": 0, "creation_date": 1562758920, "post_id": 56969925, "comment_id": 100476379, "body": "Yeah but it is still executable..."}, {"owner": {"reputation": 8766, "user_id": 451321, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/7Sdao.jpg?s=128&g=1", "display_name": "Michael Chourdakis", "link": "https://stackoverflow.com/users/451321/michael-chourdakis"}, "edited": false, "score": 0, "creation_date": 1562758948, "post_id": 56969925, "comment_id": 100476398, "body": "So ? Instead of the blue the user will get an ugly yellow warning. You cannot prevent one from modifying and/or executing anything."}, {"owner": {"reputation": 81, "user_id": 2302219, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/idYX4.jpg?s=128&g=1", "display_name": "slayer69", "link": "https://stackoverflow.com/users/2302219/slayer69"}, "reply_to_user": {"reputation": 8766, "user_id": 451321, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/7Sdao.jpg?s=128&g=1", "display_name": "Michael Chourdakis", "link": "https://stackoverflow.com/users/451321/michael-chourdakis"}, "edited": false, "score": 0, "creation_date": 1562760651, "post_id": 56969925, "comment_id": 100477359, "body": "Blue or yellow, most of users doesn&#39;t care or don&#39;t notice it. At last I would like to suspend the installation in this case. But it is hard, because every custom action which could do it could be removed"}, {"owner": {"reputation": 8766, "user_id": 451321, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/7Sdao.jpg?s=128&g=1", "display_name": "Michael Chourdakis", "link": "https://stackoverflow.com/users/451321/michael-chourdakis"}, "edited": false, "score": 1, "creation_date": 1562764345, "post_id": 56969925, "comment_id": 100479446, "body": "You are wrong. If the user doesn&#39;t notice it, it would happily accept a modified (even by a virus) item."}, {"owner": {"reputation": 34253, "user_id": 129130, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/FJpdt.gif?s=128&g=1", "display_name": "Stein &#197;smul", "link": "https://stackoverflow.com/users/129130/stein-%c3%85smul"}, "edited": false, "score": 0, "creation_date": 1562769778, "post_id": 56969925, "comment_id": 100482645, "body": "Updated answer with some more malware scanning tips."}, {"owner": {"reputation": 34253, "user_id": 129130, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/FJpdt.gif?s=128&g=1", "display_name": "Stein &#197;smul", "link": "https://stackoverflow.com/users/129130/stein-%c3%85smul"}, "edited": false, "score": 1, "creation_date": 1562787996, "post_id": 56969925, "comment_id": 100491400, "body": "I guess I forgot to ask what the actual problem really is. Are you trying to prevent people from modifying an MSI and then running it elevated? In a corporate setting?"}], "answers": [{"tags": [], "owner": {"reputation": 34253, "user_id": 129130, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/FJpdt.gif?s=128&g=1", "display_name": "Stein &#197;smul", "link": "https://stackoverflow.com/users/129130/stein-%c3%85smul"}, "is_accepted": false, "score": 5, "last_activity_date": 1563031664, "last_edit_date": 1563031664, "creation_date": 1562760698, "answer_id": 56970435, "question_id": 56969925, "link": "https://stackoverflow.com/questions/56969925/how-to-protect-msi-against-modification/56970435#56970435", "title": "How to protect MSI against modification", "body": "<blockquote>\n  <p><strong><em>Short Answer</em></strong>: You can't really protect it, and you shouldn't either, and the below tries to explain why. You can, however, sign the MSI with a digital certificate in order to ensure the file is unchanged in transit to the customer, hence protecting file integrity and facilitating better security.</p>\n</blockquote>\n\n<hr>\n\n<p><strong><em>Transparency</em></strong>: MSI files are transparent for a reason - corporate application packagers want to be able to modify the package to fit corporate standards. <a href=\"https://stackoverflow.com/a/49632260/129130\"><strong>This transparency is in fact a core advantage of MSI</strong></a>. As such I wouldn't work to protect the MSI. Compiled custom actions are still \"black box\" (not inspectable, but they can be disabled).</p>\n\n<p><strong><em>Documentation &amp; Comments</em></strong>: If your MSI has custom actions that are critical, you can indicate this with \"inline\" comments in the MSI, or perhaps in the name assigned to the custom action. You can also deliver a one page PDF file (call it <strong><em><code>Large Scale Deployment Guide.pdf</code></em></strong>?) along with your setup where you describe how to best deploy your application - and crucially what not to do with the MSI. I prefer to embed this document in the MSI so it comes out with an <a href=\"https://stackoverflow.com/questions/5564619/what-is-the-purpose-of-administrative-installation-initiated-using-msiexec-a/5751980#5751980\"><strong><em>administrative installation</em></strong></a> - which is MSI's file extraction mechanism - for the packager to see. The first thing a corporate packager generally does is extract the files from the MSI using an admin installation.</p>\n\n<p><strong><em>Digital Signatures</em></strong>: As has been mentioned by others a <a href=\"https://stackoverflow.com/questions/50407893/how-to-add-publisher-in-installshield-2018/50414337#50414337\"><strong><em>digital signature</em></strong></a> (<a href=\"https://www.advancedinstaller.com/user-guide/faq-digital-signature.html\" rel=\"nofollow noreferrer\">details from Advanced Installer</a>, <a href=\"https://helpnet.flexerasoftware.com/installshield24helplib/installshield24helplib.htm#helplibrary/IHelpReleaseDigitalSignature.htm#buildingtestingdistributing_401868635_wp0720\" rel=\"nofollow noreferrer\">details from Installshield</a>) helps to ensure the MSI is unchanged on delivery to customers. This is obviously of major importance security-wise. This is even more of an issue with new features such as <a href=\"https://stackoverflow.com/a/50414337/129130\"><strong><em>SmartScreen</em></strong></a> (reputation-based security - an <a href=\"https://en.wikipedia.org/wiki/Extended_Validation_Certificate\" rel=\"nofollow noreferrer\">EV code-signing certificate</a> <em>\"buys trust\"</em> - interesting concept? Who smells a racket? :-) ). <strong>Be sure that your setup is malware free or a digital certificate is proof positive that you delivered the malware (until that is hackable too)</strong>. And speak of the.... <a href=\"https://stackoverflow.com/a/24010770/129130\">Hmmm</a>.</p>\n\n<p><strong><em>Malware Detection</em></strong>: Remember that it is also necessary to deal with <a href=\"https://www.advancedinstaller.com/false-positive-virus-detection.html\" rel=\"nofollow noreferrer\">false positives</a>. The online tools with file upload are great for testing this. File size upload limits apply. Just a couple of links:</p>\n\n<ul>\n<li><strong><a href=\"https://www.virustotal.com\" rel=\"nofollow noreferrer\">https://www.virustotal.com</a></strong> (scans using a number of malware scanning suites)</li>\n<li><a href=\"https://virusdesk.kaspersky.com\" rel=\"nofollow noreferrer\">https://virusdesk.kaspersky.com</a> (major anti-virus vendor)</li>\n</ul>\n\n<p>A tool such as <a href=\"https://docs.microsoft.com/en-us/sysinternals/downloads/process-explorer\" rel=\"nofollow noreferrer\"><strong><em>Process Explorer</em></strong></a> from <a href=\"https://docs.microsoft.com/en-us/sysinternals/\" rel=\"nofollow noreferrer\"><strong><em>SysInternals</em></strong></a> also makes it possible to scan for malware processes by running your application and then selecting <strong><code>Options</code></strong> <strong><code>=&gt;</code></strong> <strong><code>VirusTotal.com</code></strong> <strong><code>=&gt;</code></strong> <strong><code>Check VirusTotal.com</code></strong>. <a href=\"https://www.youtube.com/watch?v=RnPtuTbqzd4\" rel=\"nofollow noreferrer\">Video tutorial here</a> (I didn't look too much at it, not familiar with the other products discussed). <em><code>Use this method to save your application from false-positive nightmares (and also for real malware infections of course)</code></em>.</p>\n\n<blockquote>\n  <p><strong><em>Application Launch</em></strong>: If you have something you need to run for sure, you could potentially add it to your application launch sequence\n  instead of your setup. This definitely works if you don't need admin\n  rights. If you need to write something to HKLM you can open ACL write\n  access there for regular users - not ideal at all, but possible.\n  Application launch code is just easier to deal with. Easier to debug\n  and no impersonation, sequencing and conditioning concerns (when\n  action runs) like you have in a setup.</p>\n</blockquote>\n\n<p><a href=\"http://www.installsite.org/pages/en/tt_nonmsi.htm\" rel=\"nofollow noreferrer\"><strong><em>Legacy Setup.exe</em></strong></a>: If you insist on doing \"secret stuff\" in your setup, then you could use a legacy tool to make a regular setup.exe (not an MSI). Be aware that with tightening security scans and malware detection your setup could be even more prone to the problem of <a href=\"https://stackoverflow.com/a/48835413/129130\">false positives</a> for malware detection. A very serious bump in the road for selling software. With real malware you tell the customer to rebuild the PC, with false positive <strong>you</strong> have to do something to fix the problem. Corporate acceptance could also depend on MSI format or other inspectable formats (\"<em>that is our standard</em>\"). And you should be aware that capture tools in corporate settings will see what the setup did in detail as they convert it to MSI (or other formats these days for example AppV and MSIX).</p>\n\n<p>And one more issue thrown in: <a href=\"https://stackoverflow.com/questions/51619358/does-an-universal-cross-platform-installer-exists/51624645#51624645\">Cross platform installers</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 15266, "user_id": 89999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26e95045ab2611253f7dcd8b71e2174c?s=128&d=identicon&r=PG", "display_name": "Michael Urman", "link": "https://stackoverflow.com/users/89999/michael-urman"}, "is_accepted": true, "score": 2, "last_activity_date": 1562808494, "creation_date": 1562808494, "answer_id": 56980526, "question_id": 56969925, "link": "https://stackoverflow.com/questions/56969925/how-to-protect-msi-against-modification/56980526#56980526", "title": "How to protect MSI against modification", "body": "<p>The short answer is no, you cannot prevent someone from editing a .msi file. There are various approaches you can take to minimize the likelihood of someone doing so, or approaches that increase the difficulties associated with any edit, but you cannot fully prevent it.</p>\n\n<p>To answer this better, one must refine the question you are asking. \"Protect\" sounds like a security sort of question, so it helps to establish at least an armchair threat model. For instance, here are three things you may be trying to prevent:</p>\n\n<ol>\n<li>an interested user altering the bits that are installed to that user's system</li>\n<li>a corporate user modifying what his system administrators install to the user's machine</li>\n<li>a malicious party altering and providing bits masquerading as your app that someone else mistakenly installs</li>\n</ol>\n\n<p>Of those three, the first isn't really a security boundary, so there's not much you can do. Either it's an install that requires administrative privileges and the user has them, or it's a per-user install that allows users without administrative privileges to use it. In either case, the .msi has no more access to the system than the user who altered it already had.</p>\n\n<p>The second crosses a boundary, but involves someone who should be diligent about verifying signatures, and may likely acquire the installation from the source instead of the user. The third is a clear security concern, and unfortunately involves people you cannot reliably expect to be diligent about verifying signatures.</p>\n\n<p>So what can you do?</p>\n\n<ul>\n<li>You can sign the .msi file. This leaves indications that the file was altered, if it was. Note that transforms (.mst files) <a href=\"https://docs.microsoft.com/en-us/windows/win32/msi/applying-transforms\" rel=\"nofollow noreferrer\">can alter</a> what the .msi does without altering the file itself; however this also affects the representation of the signed status.</li>\n<li>You can try to educate your prospective users about the importance of verifying the digital signature before accepting a UAC prompt. This won't stop someone who's trying to subvert your licensing, but may help someone avoid installing malware instead of your actual program.</li>\n<li>You can wrap the .msi in a signed .exe bootstrap. This makes things harder to access; attempts to use the normal tooling won't work directly, and instead require the altering party to figure out how to extract the .msi file. While that's typically not very difficult, it's at least another hurdle.</li>\n<li>You can try to inject signature verifications into the .msi file. As you say, these are likely to be easy to defeat by further alterations to the .msi file, unless you can couple them with important and hard to duplicate other code. That, of course, merely makes it harder to alter; but not impossible. Again you'll have to consider the .mst case, and whether you want to support <a href=\"https://docs.microsoft.com/en-us/windows/win32/msi/administrative-installation\" rel=\"nofollow noreferrer\">administrative installations</a> and installations from those caches.</li>\n<li>You can add relevant signature or other verifications to the app itself. If the .msi file is altered, but it doesn't alter what is installed to the machine, does your app care? The answer depends on what exactly you're trying to protect against; for instance it won't help prevent tag-along malware.</li>\n<li>Consider other packaging or deployment options, whether from Microsoft (like .appx / .msix) or from third parties. Each comes with their own set of advantages and disadvantages, and their own level of susceptibility to each thing I've discussed here.</li>\n<li>Run your app somewhere else; for example, rewrite your app as a web application so that there is no installation. Obviously this can only work for certain kinds of applications, but that list continues to grow.</li>\n</ul>\n\n<p>What you can't do?</p>\n\n<ul>\n<li>Make all users pay enough attention</li>\n<li>Prevent a malicious party from creating an installer that pretends to be for your app but has only a malicious payload</li>\n<li>Prevent a machine's owner from altering the machine either before or after the .msi runs</li>\n<li>Support <em>all</em> of the ways people use .msi files without just using a .msi file (administrative installs, transforms, \"repackaging\", various .msi-specific deployment utilities, etc. are all normal use patterns for certain classes of software)</li>\n</ul>\n\n<p>At the end of this exercise, you'll have to decide whether this is a deal breaker for you, or something you can accept. Make sure you understand why someone would want to alter your .msi file, and before focusing on the .msi file itself, consider whether they can have the same effect through non-.msi means. If it's specific to .msi and is a deal breaker, look into other installation technologies. If nothing can prevent the scenario you seek to prevent, perhaps you can find ways to reduce the incentive for people to attempt it.</p>\n"}], "owner": {"reputation": 81, "user_id": 2302219, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/idYX4.jpg?s=128&g=1", "display_name": "slayer69", "link": "https://stackoverflow.com/users/2302219/slayer69"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 487, "favorite_count": 1, "accepted_answer_id": 56980526, "answer_count": 2, "score": 1, "last_activity_date": 1563031664, "creation_date": 1562758704, "last_edit_date": 1562763732, "question_id": 56969925, "link": "https://stackoverflow.com/questions/56969925/how-to-protect-msi-against-modification", "title": "How to protect MSI against modification", "body": "<p>I would like to protect the MSI file against modification. It could be easily done with ORCA or with MSI API. It is sad because anyone can modify/add/remove windows installer custom actions or properties who have admin rights.</p>\n\n<p>Is there any way to set an MSI file to some read-only mode or somehow protect its content?</p>\n"}, {"tags": ["c", "parameter-passing", "scanf"], "comments": [{"owner": {"reputation": 5101, "user_id": 700170, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gZ8hw.png?s=128&g=1", "display_name": "Morten Jensen", "link": "https://stackoverflow.com/users/700170/morten-jensen"}, "edited": false, "score": 1, "creation_date": 1562758691, "post_id": 56969837, "comment_id": 100476259, "body": "I suggest you research the difference between passing by reference vs by value: <a href=\"https://stackoverflow.com/questions/13654138/what-exactly-is-the-difference-between-pass-by-reference-in-c-and-in-c\" title=\"what exactly is the difference between pass by reference in c and in c\">stackoverflow.com/questions/13654138/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 5813, "user_id": 1075282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70efe94a6c2237ec96f429402a03a27d?s=128&d=identicon&r=PG", "display_name": "Renat", "link": "https://stackoverflow.com/users/1075282/renat"}, "is_accepted": false, "score": 3, "last_activity_date": 1562758508, "creation_date": 1562758508, "answer_id": 56969868, "question_id": 56969837, "link": "https://stackoverflow.com/questions/56969837/why-is-the-function-not-mapping-the-input-to-my-variable/56969868#56969868", "title": "Why is the function not mapping the input to my variable?", "body": "<p><code>x</code> was passing by value, <code>scanf</code> changed the local copy of <code>x</code>. You need to return user input instead:</p>\n\n<pre><code>int input();\n\nint main (void)\n{\n    int h;\n    h = input();\n    printf(\"%d\\n\", h);\n}\n\nint input()\n{\n    int x;\n    printf(\"Enter a number: \");\n    scanf(\"%d\", &amp;x);\n    return x;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "is_accepted": false, "score": 2, "last_activity_date": 1562758560, "creation_date": 1562758560, "answer_id": 56969881, "question_id": 56969837, "link": "https://stackoverflow.com/questions/56969837/why-is-the-function-not-mapping-the-input-to-my-variable/56969881#56969881", "title": "Why is the function not mapping the input to my variable?", "body": "<p>This is because parameters in C are passed by copy. So the <code>x</code> that you modify is just a copy of what you passed, and at the end of <code>input</code>, that copy is discarded. Instead, you could pass a pointer. Since <code>scanf</code> already operates on a pointer, the fix is simple:</p>\n\n<pre><code>void input(int *x);    // parameter is now a pointer to an int\n\nint main(void)\n{\n    int h = 0;\n    input(&amp;h); // pass the address instead of the value\n    printf(\"%d\\n\", h);\n}\n\nvoid input(int *x)\n{\n    printf(\"Enter a number: \");\n    scanf(\"%d\", x); // no need to take the address again\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": false, "score": 1, "last_activity_date": 1562758668, "creation_date": 1562758668, "answer_id": 56969912, "question_id": 56969837, "link": "https://stackoverflow.com/questions/56969837/why-is-the-function-not-mapping-the-input-to-my-variable/56969912#56969912", "title": "Why is the function not mapping the input to my variable?", "body": "<p>Any decent book, tutorial or class should have mentioned that arguments in C are passed by value. That means the value is copied into the local argument variable, and any modifications to that local variable won't reflect on the original variable.</p>\n\n<p>There are two possible solutions:</p>\n\n<ol>\n<li><p>The simple one: Return the value from the function</p>\n\n<pre><code>int input(void)\n{\n    int x;\n    printf(\"Enter a number: \");\n    scanf(\"%d\", &amp;x);\n    return x;\n}\n\n...\n\nint h = input();\nprintf(\"%d\\n\", h);\n</code></pre></li>\n<li><p>The complicated solution: Emulate <em>pass by reference</em></p>\n\n<pre><code>void input(int *x)\n{\n    printf(\"Enter a number: \");\n    scanf(\"%d\", x);\n}\n\n...\n\nint h;\ninput(&amp;h);  // Pass a pointer to the variable\nprintf(\"%d\\n\", h);\n</code></pre></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 13228, "user_id": 8398549, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8tzrl.jpg?s=128&g=1", "display_name": "Cid", "link": "https://stackoverflow.com/users/8398549/cid"}, "is_accepted": false, "score": 1, "last_activity_date": 1562758737, "creation_date": 1562758737, "answer_id": 56969936, "question_id": 56969837, "link": "https://stackoverflow.com/questions/56969837/why-is-the-function-not-mapping-the-input-to-my-variable/56969936#56969936", "title": "Why is the function not mapping the input to my variable?", "body": "<p>You call <code>input(h);</code> and then <code>void input(int x) { ... }</code>. The <strong>value</strong> of <code>h</code> is <strong>copied</strong> into <code>x</code></p>\n\n<p>If you want to get back the changed value, you can either :</p>\n\n<p><code>return</code> a value from the function <code>input()</code> :</p>\n\n<pre><code>// notice the int before function name\nint input();\n\nint main (void)\n{\n    int h = 0;\n    // notice h = ...\n    h = input(h);\n    printf(\"%d\\n\", h);\n}\n\n// notice the int before function name\nint input()\n{\n    int x;\n    printf(\"Enter a number: \");\n    scanf(\"%d\", &amp;x);\n    // notice the return\n    return x;\n}\n</code></pre>\n\n<p>Or, pass the variable as reference (pointer) :</p>\n\n<pre><code>// notice int *\nvoid input(int *x);\n\nint main (void)\n{\n    int h = 0;\n    // notice the &amp;h this is used to pass addresses of variables\n    input(&amp;h);\n    printf(\"%d\\n\", h);\n}\n\n// notice int *\nvoid input(int *x)\n{\n    printf(\"Enter a number: \");\n    // notice the &amp; removed\n    scanf(\"%d\", x);\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1562776592, "post_id": 56969967, "comment_id": 100486437, "body": "Slightly better, but since your function is now returning a value, there&#39;s no need for any argument to it."}, {"owner": {"reputation": 1646, "user_id": 7552217, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1565798300116209/picture?type=large", "display_name": "Sagun Raj Lage", "link": "https://stackoverflow.com/users/7552217/sagun-raj-lage"}, "reply_to_user": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1562780270, "post_id": 56969967, "comment_id": 100488133, "body": "Yeah. :) Thank you for the suggestion!"}], "tags": [], "owner": {"reputation": 1646, "user_id": 7552217, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1565798300116209/picture?type=large", "display_name": "Sagun Raj Lage", "link": "https://stackoverflow.com/users/7552217/sagun-raj-lage"}, "is_accepted": false, "score": 0, "last_activity_date": 1562780248, "last_edit_date": 1562780248, "creation_date": 1562758818, "answer_id": 56969967, "question_id": 56969837, "link": "https://stackoverflow.com/questions/56969837/why-is-the-function-not-mapping-the-input-to-my-variable/56969967#56969967", "title": "Why is the function not mapping the input to my variable?", "body": "<p>The problem is that you didn't understand the basic workflow of functions. Maybe you should once again revise your basics and theory.\nThis is how your code should have been written (I have tried my best to make minimal changes to your code):</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint input();\n\nint main (void)\n{\n    int y;\n    y = input();\n    printf(\"%d\\n\", y);\n}\n\nint input()\n{\n    printf(\"Enter a number: \");\n    scanf(\"%d\", &amp;x);\n    return x;\n}\n</code></pre>\n\n<p>You should have set the return type of function <code>input()</code> as <code>int</code>. Then, a variable (<code>y</code> in this case) could get the value returned by <code>input()</code> and use it in the <code>main()</code> function to display the actual input that the user had given.</p>\n"}], "owner": {"reputation": 19, "user_id": 11764673, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62f82d7ef59c2d9dc84064051d190bf4?s=128&d=identicon&r=PG&f=1", "display_name": "Anew", "link": "https://stackoverflow.com/users/11764673/anew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "closed_date": 1562759137, "answer_count": 5, "score": 1, "last_activity_date": 1569585112, "creation_date": 1562758381, "last_edit_date": 1569585112, "question_id": 56969837, "link": "https://stackoverflow.com/questions/56969837/why-is-the-function-not-mapping-the-input-to-my-variable", "closed_reason": "Duplicate", "title": "Why is the function not mapping the input to my variable?", "body": "<p>The function is not mapping the user input to the variable</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid input(int x);\n\nint main (void)\n{\n    int h = 0;\n    input(h);\n    printf(\"%d\\n\", h);\n}\n\nvoid input(int x)\n{\n    printf(\"Enter a number: \");\n    scanf(\"%d\", &amp;x);\n}\n</code></pre>\n\n<p>When entering something like 5, I expect 5 to be printed</p>\n"}, {"tags": ["c", "gcc", "c-preprocessor"], "comments": [{"owner": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "edited": false, "score": 2, "creation_date": 1562756878, "post_id": 56969307, "comment_id": 100475331, "body": "It is defined, but with the value &quot;empty&quot;, because the make replaces any missing variables with empty. I am actually not sure if the compiler will then define it as empty, or as the default, 1, when no assignment is given. You could explore this in the C code using the expression  <code>MACRO_TEST+0</code>"}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1562769070, "post_id": 56969307, "comment_id": 100482226, "body": "There is a duplicate question which asked how to differentiate when a macro is unset, empty, zero or anything else. But I can&#39;t find it."}, {"owner": {"reputation": 90, "user_id": 1659436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bde70c5d1d7752d9f6d3f97b42e46be9?s=128&d=identicon&r=PG", "display_name": "Sheetal T", "link": "https://stackoverflow.com/users/1659436/sheetal-t"}, "reply_to_user": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "edited": false, "score": 0, "creation_date": 1562838006, "post_id": 56969307, "comment_id": 100506980, "body": "@GemTaylor, It works for me. However, before i tired I was thinking it will give compile time error as <code>+</code> op needs 2 args and when MACRO_TEST is set to &quot;empty&quot;. How will this work."}], "answers": [{"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1562773513, "post_id": 56969569, "comment_id": 100484810, "body": "Note that the <code>#if MACRO_TEST</code> will work if <code>MACRO_TEST</code> is not defined at all; the preprocessor will convert the name to <code>0</code> and evaluate the condition appropriately.  If <code>MACRO_TEST</code> is defined, it must not be empty (so <code>-DMACRO_TEST</code> is OK; <code>-DMACRO_TEST=</code> is not), and it must be defined as a numeric value or an identifier; it should not be a string <code>-DMACRO_TEST=&#39;&quot;string&quot;&#39;</code> (beware the single and double quotes in that!)."}, {"owner": {"reputation": 7495, "user_id": 11527076, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xqgpS.png?s=128&g=1", "display_name": "prog-fh", "link": "https://stackoverflow.com/users/11527076/prog-fh"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1562773827, "post_id": 56969569, "comment_id": 100485000, "body": "@Jonathan Leffler Thank you for the clarification. I edited the answer accordingly."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1562774243, "post_id": 56969569, "comment_id": 100485231, "body": "Note that if there&#39;s a macro <code>-Dwhat=1</code>, then the <code>-DMACRO_TEST=what</code> will expand the <code>what</code> to <code>1</code>, etc.  I&#39;m not sure whether that needs to be called out in the answer (maybe this comment suffices).  &#39;Tis tricky stuff \u2014 the preprocessor leads to intricate problems on occasion."}], "tags": [], "owner": {"reputation": 7495, "user_id": 11527076, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xqgpS.png?s=128&g=1", "display_name": "prog-fh", "link": "https://stackoverflow.com/users/11527076/prog-fh"}, "is_accepted": false, "score": 2, "last_activity_date": 1562780550, "last_edit_date": 1562780550, "creation_date": 1562757469, "answer_id": 56969569, "question_id": 56969307, "link": "https://stackoverflow.com/questions/56969307/how-to-check-if-cli-defined-macro-dmacro-is-defined-or-not/56969569#56969569", "title": "How to check if CLI defined MACRO (-DMACRO=) is defined or not", "body": "<p>Some common cases for testing macros:</p>\n\n<pre><code>#ifdef MACRO_TEST\n  // MACRO_TEST is defined, whatever its content, even empty\n  // for example:\n  //   -DMACRO_TEST\n  //   -DMACRO_TEST=\n  //   -DMACRO_TEST=0\n  //   -DMACRO_TEST=1\n  //   -DMACRO_TEST=abcd\n#else\n  // MACRO_TEST is not defined, not even with an empty content\n#endif\n\n#if MACRO_TEST // it must not be defined as empty (-DMACRO_TEST= --&gt; error)\n  // MACRO_TEST has a non-zero integer value\n  // for example:\n  //   -DMACRO_TEST\n  //   -DMACRO_TEST=1    -- equivalent to -DMACRO_TEST\n  //   -DMACRO_TEST=23\n#else\n  // MACRO_TEST has a zero integer value\n  // for example:\n  //   (not defined at all, then considered as zero)\n  //   -DMACRO_TEST=0\n  //   -DMACRO_TEST=what\n#endif\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4832, "user_id": 258894, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/4e52f8ae459fe3a2793b570a851275e6?s=128&d=identicon&r=PG", "display_name": "GaryO", "link": "https://stackoverflow.com/users/258894/garyo"}, "edited": false, "score": 0, "creation_date": 1562763932, "post_id": 56969646, "comment_id": 100479173, "body": "This is almost right, but if he wants 0 to be a valid value, a multi-part test should work: <code>#if defined(MACRO_TEST) &amp;&amp; MACRO_TEST != &quot;&quot;</code> will accept all definitions except empty string (just as an example)."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "reply_to_user": {"reputation": 4832, "user_id": 258894, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/4e52f8ae459fe3a2793b570a851275e6?s=128&d=identicon&r=PG", "display_name": "GaryO", "link": "https://stackoverflow.com/users/258894/garyo"}, "edited": false, "score": 0, "creation_date": 1562764358, "post_id": 56969646, "comment_id": 100479453, "body": "No,it is completely right, and it avoids the three-valued-logic. I even tested it!"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 4832, "user_id": 258894, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/4e52f8ae459fe3a2793b570a851275e6?s=128&d=identicon&r=PG", "display_name": "GaryO", "link": "https://stackoverflow.com/users/258894/garyo"}, "edited": false, "score": 1, "creation_date": 1562767148, "post_id": 56969646, "comment_id": 100481011, "body": "The string comparison is dubious, @GaryO."}, {"owner": {"reputation": 4832, "user_id": 258894, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/4e52f8ae459fe3a2793b570a851275e6?s=128&d=identicon&r=PG", "display_name": "GaryO", "link": "https://stackoverflow.com/users/258894/garyo"}, "edited": false, "score": 0, "creation_date": 1562768084, "post_id": 56969646, "comment_id": 100481594, "body": "He wants a value of 0 to trigger his &quot;is defined&quot; branch. Using <code>#if MACRO_TEST</code> alone will cause a value of 0 to go into his &quot;NOT-defined&quot; branch."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1562768553, "post_id": 56969646, "comment_id": 100481900, "body": "IMHO the  OP just wants to  have only two cases. Ok, To prove mypoint, I&#39;ll update the answer. ..."}], "tags": [], "owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "is_accepted": false, "score": 0, "last_activity_date": 1562768865, "last_edit_date": 1562768865, "creation_date": 1562757726, "answer_id": 56969646, "question_id": 56969307, "link": "https://stackoverflow.com/questions/56969307/how-to-check-if-cli-defined-macro-dmacro-is-defined-or-not/56969646#56969646", "title": "How to check if CLI defined MACRO (-DMACRO=) is defined or not", "body": "<p>Just use <code>#if xxx</code>. Undefined <code>xxx</code> is treated as zero by the preprocessor.</p>\n\n<hr>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#if MACRO_TEST\nchar msg[] = \"MACRO_TEST is defined\";\n#else\nchar msg[] = \"MACRO_TEST is NOT-defined\";\n#endif\n\nint main ()\n{\n    printf(\"msg = %s\\n\", msg);\n    return 0;\n}\n</code></pre>\n\n<hr>\n\n<p>And, you don't have to supply a value on the commandline, just<code>-Dxxx</code> is sufficient, and the compiler/preprocessor will assume <code>1</code>:</p>\n\n<pre><code>cc -Wall -DMACRO_TEST defined.c\n</code></pre>\n\n<hr>\n\n<p>UPDATE. All four cases:</p>\n\n<hr>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#if MACRO_TEST\nchar msg[] = \"MACRO_TEST is defined and non-zero\";\n#else\nchar msg[] = \"MACRO_TEST is NOT-defined or zero\";\n#endif\n\nint main (int argc, char**argv)\n{\n    printf(\"%s: msg = %s\\n\", argv[0], msg);\n    return 0;\n}\n</code></pre>\n\n<hr>\n\n<pre><code>#!bin/sh\n\ncc -Wall defined.c -o x\ncc -Wall -DMACRO_TEST defined.c -o xd\ncc -Wall -DMACRO_TEST=0 defined.c -o xd0\ncc -Wall -DMACRO_TEST=1 defined.c -o xd1\n\n./x\n./xd\n./xd0\n./xd1\n\nrm x xd xd0 xd1\n</code></pre>\n\n<hr>\n\n<p>result:</p>\n\n<hr>\n\n<pre><code>./x: msg = MACRO_TEST is NOT-defined or zero\n./xd: msg = MACRO_TEST is defined and non-zero\n./xd0: msg = MACRO_TEST is NOT-defined or zero\n./xd1: msg = MACRO_TEST is defined and non-zero\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 90, "user_id": 1659436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bde70c5d1d7752d9f6d3f97b42e46be9?s=128&d=identicon&r=PG", "display_name": "Sheetal T", "link": "https://stackoverflow.com/users/1659436/sheetal-t"}, "edited": false, "score": 0, "creation_date": 1562839115, "post_id": 56969826, "comment_id": 100507695, "body": "I know i&#39;ve mentioned CLI in summary. but the end compilation process is done by using Makefile, which i don&#39;t want to update."}, {"owner": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "reply_to_user": {"reputation": 90, "user_id": 1659436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bde70c5d1d7752d9f6d3f97b42e46be9?s=128&d=identicon&r=PG", "display_name": "Sheetal T", "link": "https://stackoverflow.com/users/1659436/sheetal-t"}, "edited": false, "score": 0, "creation_date": 1562839250, "post_id": 56969826, "comment_id": 100507766, "body": "@SheetalT Then show the Makefile (or the file from which it was generated) in your question. How do you get the macro definition into your Makefile? What are the possible macro definitions you want to distinguish."}], "tags": [], "owner": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "is_accepted": false, "score": 2, "last_activity_date": 1562758327, "creation_date": 1562758327, "answer_id": 56969826, "question_id": 56969307, "link": "https://stackoverflow.com/questions/56969307/how-to-check-if-cli-defined-macro-dmacro-is-defined-or-not/56969826#56969826", "title": "How to check if CLI defined MACRO (-DMACRO=) is defined or not", "body": "<p>If you omit any option <code>-DMACRO_TEST</code> or explicitly add <code>-UMACRO_TEST</code> (= undefine macro) in the <code>gcc</code> command line, the macro will not be defined. In this case the preprocessor directive <code>#ifdef MACRO_TEST</code> will be FALSE, and you will get </p>\n\n<pre><code>char msg[] = \"MACRO_TEST is NOT-defined\";\n</code></pre>\n\n<p>in the <code>#else</code> branch.</p>\n\n<p>(Assuming you don't define this macro in the code.)</p>\n"}], "owner": {"reputation": 90, "user_id": 1659436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bde70c5d1d7752d9f6d3f97b42e46be9?s=128&d=identicon&r=PG", "display_name": "Sheetal T", "link": "https://stackoverflow.com/users/1659436/sheetal-t"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 444, "favorite_count": 1, "answer_count": 3, "score": 2, "last_activity_date": 1562780550, "creation_date": 1562756523, "last_edit_date": 1562773386, "question_id": 56969307, "link": "https://stackoverflow.com/questions/56969307/how-to-check-if-cli-defined-macro-dmacro-is-defined-or-not", "title": "How to check if CLI defined MACRO (-DMACRO=) is defined or not", "body": "<p>How to check if a macro is defined or not, when the definition is provided in compile time.</p>\n\n<p>I've Makefile which resolves and passes this string (\"<code>-DMACRO_TEST=${DEFINED}</code>\") when compiling sample C file.\nThe variable DEFINED may or may not have a value (0 or non-zero). \nI wanted to know how to check if the <code>MACRO_TEST</code> is defined or not, when variable DEFINED itself doesn't have any value. This is similar to passing \"-DMACRO_TEST=\" when compiling the C file.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#ifdef MACRO_TEST\nchar msg[] = \"MACRO_TEST is defined\";\n#else\nchar msg[] = \"MACRO_TEST is NOT-defined\";\n#endif\n\nint main ()\n{\n    printf(\"msg = %s\\n\", msg);\n    return 0;\n}\n</code></pre>\n\n<p>Command line output</p>\n\n<pre><code>$ gcc tmp.c -DMACRO_TEST=0\n$ ./a.out\nmsg = MACRO_TEST is defined\n$ gcc tmp.c -DMACRO_TEST=\n$ ./a.out\nmsg = MACRO_TEST is defined\n</code></pre>\n\n<p>when compiling in 2nd case, I was expecting it would return</p>\n\n<pre><code>msg = MACRO_TEST is NOT-defined\n</code></pre>\n"}, {"tags": ["c", "shell", "console", "termcap"], "comments": [{"owner": {"reputation": 42737, "user_id": 4518274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UPurS.png?s=128&g=1", "display_name": "Thomas Dickey", "link": "https://stackoverflow.com/users/4518274/thomas-dickey"}, "edited": false, "score": 0, "creation_date": 1562972087, "post_id": 56969150, "comment_id": 100561449, "body": "You can do this with xterm (see <a href=\"https://invisible-island.net/xterm/ctlseqs/ctlseqs.html#h2-Functions-using-CSI-_-ordered-by-the-final-character_s_\" rel=\"nofollow noreferrer\"><i>Reverse-wraparound Mode</i></a>), but none of its imitators provide that feature."}], "answers": [{"tags": [], "owner": {"reputation": 13767, "user_id": 2413201, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/rxfuw.jpg?s=128&g=1", "display_name": "Armali", "link": "https://stackoverflow.com/users/2413201/armali"}, "is_accepted": true, "score": 0, "last_activity_date": 1562758209, "creation_date": 1562758209, "answer_id": 56969794, "question_id": 56969150, "link": "https://stackoverflow.com/questions/56969150/hot-to-set-termcap-capability-bw-flag/56969794#56969794", "title": "Hot to set termcap capability &#39;bw&#39; flag?", "body": "<blockquote>\n  <p>How can i set <code>bw</code> flag?</p>\n</blockquote>\n\n<p><code>auto_left_margin</code> (<code>bw</code>) is one of the terminal <em>capabilities</em>, i. e. it only indicates whether <em><code>cub1</code> wraps from column 0 to last column</em>. You cannot change that behavior of the terminal, you can only query it and adapt your program appropriately, e. g. by positioning one line up and to its end with other capabilities.</p>\n"}], "owner": {"reputation": 13, "user_id": 9807070, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-VGmmFs3OS4s/AAAAAAAAAAI/AAAAAAAAAEM/GHP8ktjMWPA/photo.jpg?sz=128", "display_name": "\u0412\u043e\u0432\u0430 \u0429\u0451\u0433\u043e\u043b\u0435\u0432", "link": "https://stackoverflow.com/users/9807070/%d0%92%d0%be%d0%b2%d0%b0-%d0%a9%d1%91%d0%b3%d0%be%d0%bb%d0%b5%d0%b2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "accepted_answer_id": 56969794, "answer_count": 1, "score": 1, "last_activity_date": 1562767129, "creation_date": 1562755952, "last_edit_date": 1562767129, "question_id": 56969150, "link": "https://stackoverflow.com/questions/56969150/hot-to-set-termcap-capability-bw-flag", "title": "Hot to set termcap capability &#39;bw&#39; flag?", "body": "<p>I'm studying termcap library. And I'm trying to do a line editor in the terminal. I have a cursor that can move on the line. Everything works great with one line. But if my line is bigger than terminal width, I can't return my cursor from the second line to the first using <code>le</code> command (move cursor to the left). I need to set <code>bw</code> flag to do this. function <code>tgetflag()</code> only return a value. I think that I need to set this flag using <code>tcsetsttr()</code> but can't find the right flag-macro. How can I set <code>bw</code> flag?</p>\n\n<pre><code>struct termios  stored_settings;\nstruct termios  new_settings;\n\ntcgetattr(0, &amp;stored_settings);\nnew_settings = stored_settings;\nnew_settings.c_lflag &amp;= (~ICANON &amp; ~ECHO);\nnew_settings.c_cc[VTIME] = 0;\nnew_settings.c_cc[VMIN] = 1;\ntcsetattr(0, TCSANOW, &amp;new_settings);\n</code></pre>\n"}, {"tags": ["c", "linux", "linux-kernel", "linux-device-driver"], "comments": [{"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1562765703, "post_id": 56969014, "comment_id": 100480206, "body": "If it&#39;s crashing, you are probably using a return value without checking it. For example, the value returned from <code>lookup_bdev()</code> in the <code>bdev</code> variable might be an error code encoded as a pointer. Use <code>IS_ERR(bdev)</code> to check for that. If <code>IS_ERR(bdev)</code> is true, use <code>PTR_ERR(bdev)</code> to get the error value."}, {"owner": {"reputation": 2126, "user_id": 4407613, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/k0ty3.png?s=128&g=1", "display_name": "Devidas", "link": "https://stackoverflow.com/users/4407613/devidas"}, "reply_to_user": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1562830335, "post_id": 56969014, "comment_id": 100502861, "body": "Let me check that. but interesting question here is why this different behavior in these two cases?"}], "owner": {"reputation": 2126, "user_id": 4407613, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/k0ty3.png?s=128&g=1", "display_name": "Devidas", "link": "https://stackoverflow.com/users/4407613/devidas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1562784273, "creation_date": 1562755445, "last_edit_date": 1562784273, "question_id": 56969014, "link": "https://stackoverflow.com/questions/56969014/blk-get-request-crashes-when-used-on-unpartiotioned-block-device", "title": "blk_get_request crashes when used on unpartiotioned block device", "body": "<pre><code>struct block_device *bdev = lookup_bdev(\"/dev/sdc\");\nstruct request_queue *rq = bdev_get_queue(bdev);\nreq = blk_get_request(rq, READ, __GFP_RECLAIM);\n</code></pre>\n\n<p>above code works fine when I have partition on /dev/sdc but crashes when that partition is not there.</p>\n\n<p>Strangely if I delete partition this code works without crash. until I restart machine.</p>\n\n<pre><code>[ 2238.666563] Hi. /dev/sdc\n[ 2238.666591] BUG: unable to handle kernel NULL pointer dereference at 00000000000003e0\n[ 2238.666600] IP: [&lt;ffffffffa06e7029&gt;] local_block_execute+0x29/0xe6 [inquiry]\n[ 2238.666610] PGD 80000000b6a80067 PUD b5bb7067 PMD 0\n[ 2238.666616] Oops: 0000 [#1] SMP\n</code></pre>\n"}, {"tags": ["c", "macos", "pipe", "fork", "file-descriptor"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1562766672, "post_id": 56968975, "comment_id": 100480725, "body": "Good job on closing file descriptors etc. The only minor quibble is that you should write an error and exit if either <code>execlp()</code> fails."}], "answers": [{"tags": [], "owner": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "is_accepted": true, "score": 1, "last_activity_date": 1562756558, "creation_date": 1562756558, "answer_id": 56969318, "question_id": 56968975, "link": "https://stackoverflow.com/questions/56968975/child-process-execution-order-seems-wrong-but-works/56969318#56969318", "title": "Child-Process execution order seems wrong, but works", "body": "<p>The use of <code>pipe</code>, <code>dup2</code> and <code>close</code> determines how the two processes are connected, not the order of execution. The process which runs first may block in a <code>read</code> or <code>write</code> access to the pipe until the other one sends or receives data respectively.</p>\n\n<p>The execution order cannot be wrong because it is not specified. Any of parent or child may have to wait for something, and the scheduler does not guarantee fair distribution of resources. Maybe the creation of a child process takes some time, so the parent may reach  </p>\n\n<pre><code>write(stdOut, \"b\\n\", 2);\n</code></pre>\n\n<p>before the child reaches </p>\n\n<pre><code>write(stdOut, \"a\\n\", 2);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7495, "user_id": 11527076, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xqgpS.png?s=128&g=1", "display_name": "prog-fh", "link": "https://stackoverflow.com/users/11527076/prog-fh"}, "is_accepted": false, "score": 1, "last_activity_date": 1562756596, "creation_date": 1562756596, "answer_id": 56969325, "question_id": 56968975, "link": "https://stackoverflow.com/questions/56968975/child-process-execution-order-seems-wrong-but-works/56969325#56969325", "title": "Child-Process execution order seems wrong, but works", "body": "<p>The order in which the markers <code>a</code> and <code>b</code> are displayed is not correlated with what happens through the pipe.<br>\nAt the moment they are produced, there is no synchronisation between the two processes.<br>\nThe <code>cat</code> command writes to its standard output which is redirected to the <em>write</em> side of the pipe.<br>\nThe <code>wc</code> command reads from its standard input which is redirected from the <em>read</em> side of the pipe.<br>\nThus, in any case, data will go from <code>cat</code> to <code>wc</code> through the pipe.</p>\n"}], "owner": {"reputation": 43, "user_id": 11764336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82f843847f7e6da4bf13bb494fd2a887?s=128&d=identicon&r=PG&f=1", "display_name": "GoodCoffee", "link": "https://stackoverflow.com/users/11764336/goodcoffee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 56969318, "answer_count": 2, "score": 3, "last_activity_date": 1562756596, "creation_date": 1562755340, "question_id": 56968975, "link": "https://stackoverflow.com/questions/56968975/child-process-execution-order-seems-wrong-but-works", "title": "Child-Process execution order seems wrong, but works", "body": "<p>Why does the following code execute the command:</p>\n\n<blockquote>\n  <p>\"cat /etc/passwd | wc -l\"</p>\n</blockquote>\n\n<p>and not </p>\n\n<blockquote>\n  <p>\"wc -l | cat /etc/passwd\"?</p>\n</blockquote>\n\n<p>Even though the debugging statements are in the order </p>\n\n<blockquote>\n  <p>b</p>\n  \n  <p>a </p>\n</blockquote>\n\n<pre class=\"lang-c prettyprint-override\"><code> int main() {\n    pid_t pid;\n    int fd[2];\n\n    int stdOut = dup(1);\n\n    pid = fork();\n    if (pid == 0) {\n        pipe(fd);\n        pid = fork();\n        if (pid == 0) {\n            close(fd[0]);\n            dup2(fd[1], STDOUT_FILENO);\n            close(fd[1]);\n\n            write(stdOut, \"a\\n\", 2);\n\n            execlp(\"cat\", \"cat\", \"/etc/passwd\", NULL);\n        }\n        close(fd[1]);\n        dup2(fd[0], STDIN_FILENO);\n        close(fd[0]);\n\n        write(stdOut, \"b\\n\", 2);\n\n        execlp(\"wc\", \"wc\", \"-l\", NULL);\n    }\n    wait(NULL);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "tdd"], "comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1562755390, "post_id": 56968954, "comment_id": 100474581, "body": "Your code is not complete.  For example, what &#39;s <code>FAKE_VOID_FUNC2_VARARG</code>?  Post your <b>complete</b> code."}, {"owner": {"reputation": 119, "user_id": 6621062, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-rpT7TNZ1tfk/AAAAAAAAAAI/AAAAAAAAAPw/byuO9zlPUH8/photo.jpg?sz=128", "display_name": "Nico W.", "link": "https://stackoverflow.com/users/6621062/nico-w"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1562756771, "post_id": 56968954, "comment_id": 100475270, "body": "I just update my complete code with some automatic created mock files from ceedling."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 1, "creation_date": 1562759257, "post_id": 56968954, "comment_id": 100476576, "body": "Nope it still lacks a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 119, "user_id": 6621062, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-rpT7TNZ1tfk/AAAAAAAAAAI/AAAAAAAAAPw/byuO9zlPUH8/photo.jpg?sz=128", "display_name": "Nico W.", "link": "https://stackoverflow.com/users/6621062/nico-w"}, "edited": false, "score": 0, "creation_date": 1562759297, "post_id": 56968954, "comment_id": 100476596, "body": "Just updated to a basic minimal example. Add missing some.c."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 1, "creation_date": 1562762348, "post_id": 56968954, "comment_id": 100478266, "body": "I guess you should change <code>debug_printf_custom</code> to use a <code>va_list</code> parameter."}, {"owner": {"reputation": 119, "user_id": 6621062, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-rpT7TNZ1tfk/AAAAAAAAAAI/AAAAAAAAAPw/byuO9zlPUH8/photo.jpg?sz=128", "display_name": "Nico W.", "link": "https://stackoverflow.com/users/6621062/nico-w"}, "edited": false, "score": 0, "creation_date": 1562762452, "post_id": 56968954, "comment_id": 100478326, "body": "Yes, just hit this also. I&#39;m checking my &quot;ceedling&quot; test. The minimal example will work with this change."}], "answers": [{"tags": [], "owner": {"reputation": 119, "user_id": 6621062, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-rpT7TNZ1tfk/AAAAAAAAAAI/AAAAAAAAAPw/byuO9zlPUH8/photo.jpg?sz=128", "display_name": "Nico W.", "link": "https://stackoverflow.com/users/6621062/nico-w"}, "is_accepted": true, "score": 0, "last_activity_date": 1562764298, "creation_date": 1562764298, "answer_id": 56971482, "question_id": 56968954, "link": "https://stackoverflow.com/questions/56968954/assignment-of-variadic-function-fails-with-incompatible-pointer-type/56971482#56971482", "title": "Assignment of variadic function fails with incompatible pointer type", "body": "<p>Got all together.</p>\n\n<p>First of all:</p>\n\n<pre><code>void debug_printf_custom(const char* fmt, ...)\n{\n  va_list ap;\n\n  va_start(ap, fmt);\n  vprintf(fmt, ap);\n  va_end(ap);\n}\n</code></pre>\n\n<p>must be</p>\n\n<pre><code>void debug_printf_custom(const char* fmt, va_list ap)\n{\n  vprintf(fmt, ap);\n}\n</code></pre>\n\n<p>as pointed by @ianabbott.</p>\n\n<p>Unfortunately the minimal example will work, but not the one with Ceedling.\nThe solution when using the <a href=\"https://github.com/ElectronVector/fake_function_framework\" rel=\"nofollow noreferrer\">fff-plugin</a> from ElectronVector. </p>\n\n<p>The fff.h is outdated and should be updated. \nIn your project folder:</p>\n\n<pre><code>cd vendor/ceedling/plugins/fake_function_framework/vendor/fff \ngit fetch\ngit checkout master\n</code></pre>\n"}], "owner": {"reputation": 119, "user_id": 6621062, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-rpT7TNZ1tfk/AAAAAAAAAAI/AAAAAAAAAPw/byuO9zlPUH8/photo.jpg?sz=128", "display_name": "Nico W.", "link": "https://stackoverflow.com/users/6621062/nico-w"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 142, "favorite_count": 0, "accepted_answer_id": 56971482, "answer_count": 1, "score": -1, "last_activity_date": 1562764298, "creation_date": 1562755254, "last_edit_date": 1562759387, "question_id": 56968954, "link": "https://stackoverflow.com/questions/56968954/assignment-of-variadic-function-fails-with-incompatible-pointer-type", "title": "Assignment of variadic function fails with incompatible pointer type", "body": "<p>I'm using ceedling with the 'fake funcion framework'(<a href=\"https://github.com/meekrosoft/fff/blob/master/fff.h\" rel=\"nofollow noreferrer\">fff</a>).</p>\n\n<p>I declare a custom fake for my debug_printf function.</p>\n\n<p>My debug.h</p>\n\n<pre><code>#ifndef DEBUG_H\n#define DEBUG_H\n\nvoid debug_printf(const char*, ...);\n\n#endif // DEBUG_H\n</code></pre>\n\n<p>My some.h</p>\n\n<pre><code>#ifndef SOME_H\n#define SOME_H\n\nvoid f(void);\n\n#endif // SOME_H\n</code></pre>\n\n<p>My some.c</p>\n\n<pre><code>#include \"some.h\"\n\n#include \"debug.h\"\n\nvoid f()\n{\n  debug_printf(\"test\");\n}\n</code></pre>\n\n<p>My test_some.c</p>\n\n<pre><code>#include \"fff.h\"\n\n#include \"some.h\"\n\n#include &lt;stdio.h&gt;\n#include &lt;stdarg.h&gt;\n\nDEFINE_FFF_GLOBALS;\n\nFAKE_VOID_FUNC2_VARARG(debug_printf, const char*, ...);\n\nvoid debug_printf_custom(const char* fmt, ...)\n{\n  va_list ap;\n\n  va_start(ap, fmt);\n  vprintf(fmt, ap);\n  va_end(ap);\n}\n\nvoid test_f(void)\n{\n  debug_printf_fake.custom_fake = debug_printf_custom;\n  f();\n}\n\nint main(void)\n{\n  test_f();\n  return 0;\n}\n</code></pre>\n\n<p>When I try to run the test I've got the message:</p>\n\n<pre><code>&gt; gcc test_some.c some.c -o test\n\ntest_some.c: In function \u2018test_f\u2019:\ntest_some.c:23:35: warning: assignment from incompatible pointer type [-Wincompatible-pointer-types]\n     debug_printf_fake.custom_fake = debug_printf_custom;\n                                   ^\n</code></pre>\n\n<p>What should I change to get the correct pointer type.</p>\n"}, {"tags": ["c++", "c", "visual-studio", "include", "documentation"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1562755637, "post_id": 56968809, "comment_id": 100474690, "body": "You can look them up in the Microsoft <a href=\"https://docs.microsoft.com/en-us/cpp/c-runtime-library/reference/crt-alphabetical-function-reference?view=vs-2017\" rel=\"nofollow noreferrer\">2017 Alphabetical Function Reference</a>."}], "answers": [{"tags": [], "owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "is_accepted": true, "score": 3, "last_activity_date": 1562755887, "creation_date": 1562755887, "answer_id": 56969131, "question_id": 56968809, "link": "https://stackoverflow.com/questions/56968809/microsoft-headers-have-no-comments-on-declarations-so-where-is-the-documentation/56969131#56969131", "title": "Microsoft headers have no comments on declarations so where is the documentation?", "body": "<p>The Microsoft code is not self-documenting in this way. They're not intended to be read by mere mortals. That's just a choice that was made by the developers. Different projects take different approaches to documentation. Some sprinkle comments liberally, others write out-of-band documentation (such as <a href=\"https://docs.microsoft.com/en-us/cpp/c-runtime-library/reference/printf-printf-l-wprintf-wprintf-l?view=vs-2019\" rel=\"nofollow noreferrer\">on Microsoft Docs</a>), and some don't bother providing any at all!</p>\n\n<p>For Windows stuff I will typically Google e.g. <code>printf visual studio</code>.</p>\n"}], "owner": {"reputation": 588, "user_id": 7217855, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e2c5e5ef71e4763ece906a0c66cd8552?s=128&d=identicon&r=PG&f=1", "display_name": "Lemonbonbon", "link": "https://stackoverflow.com/users/7217855/lemonbonbon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 56969131, "answer_count": 1, "score": 2, "last_activity_date": 1562755961, "creation_date": 1562754716, "last_edit_date": 1562755961, "question_id": 56968809, "link": "https://stackoverflow.com/questions/56968809/microsoft-headers-have-no-comments-on-declarations-so-where-is-the-documentation", "title": "Microsoft headers have no comments on declarations so where is the documentation?", "body": "<p>Typically (as far as I know), in Visual Stdio I often right-click on a function \"go to definition\" or \"go to declaration\" with open source libraries. This leads me to the header files where I usually find a lot of documentation about the specific functions. If I try this with functions from Microsoft-headers, I get just some strange code, but no documentation about that function. </p>\n\n<p>For example if I choose \"go to declaration\" with <code>printf</code>, I get this:</p>\n\n<pre><code>_Check_return_opt_\n    _CRT_STDIO_INLINE int __CRTDECL printf(\n        _In_z_ _Printf_format_string_ char const* const _Format,\n        ...)\n</code></pre>\n\n<p>Do I miss something here? Does there exist another way? Where do you to look up these things?</p>\n"}, {"tags": ["c", "configuration", "stm32", "clock"], "comments": [{"owner": {"reputation": 3648, "user_id": 4931630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4290ddd0630dd0091e3b9713a23c3434?s=128&d=identicon&r=PG&f=1", "display_name": "AterLux", "link": "https://stackoverflow.com/users/4931630/aterlux"}, "edited": false, "score": 1, "creation_date": 1562758229, "post_id": 56968322, "comment_id": 100476021, "body": "You have no PLL source selected. Please see update to my answer"}], "answers": [{"comments": [{"owner": {"reputation": 147, "user_id": 11681090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcbd712770f6d2bc37de2c27ec4ef8ec?s=128&d=identicon&r=PG&f=1", "display_name": "arry_h", "link": "https://stackoverflow.com/users/11681090/arry-h"}, "edited": false, "score": 0, "creation_date": 1562756623, "post_id": 56969052, "comment_id": 100475194, "body": "Yes, thank you, this is what I usually use but I am trying to learn how to configure without this."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 147, "user_id": 11681090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcbd712770f6d2bc37de2c27ec4ef8ec?s=128&d=identicon&r=PG&f=1", "display_name": "arry_h", "link": "https://stackoverflow.com/users/11681090/arry-h"}, "edited": false, "score": 0, "creation_date": 1562757211, "post_id": 56969052, "comment_id": 100475516, "body": "I am not saying to use HAL to initialize - just to see the values :)"}], "tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": 0, "last_activity_date": 1562755582, "last_edit_date": 1592644375, "creation_date": 1562755582, "answer_id": 56969052, "question_id": 56968322, "link": "https://stackoverflow.com/questions/56968322/why-is-the-pll-not-locking-is-my-clock-configuration-correct/56969052#56969052", "title": "Why is the PLL not locking? Is my clock configuration correct?", "body": "<p>I always use Cube to see the clock tree. I also use registers - but that tool is very convenient and it prevents many stupid errors as it will let you know if the values are outside the recommended ones.</p>\n<p><a href=\"https://i.stack.imgur.com/CDTzc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/CDTzc.png\" alt=\"enter image description here\" /></a></p>\n<p>PS it should be a comment but I wanted to put the picture. So please do not UV or accept</p>\n"}, {"comments": [{"owner": {"reputation": 147, "user_id": 11681090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcbd712770f6d2bc37de2c27ec4ef8ec?s=128&d=identicon&r=PG&f=1", "display_name": "arry_h", "link": "https://stackoverflow.com/users/11681090/arry-h"}, "edited": false, "score": 0, "creation_date": 1562757524, "post_id": 56969389, "comment_id": 100475679, "body": "Many thanks, the code no longer sticks there. The code does not get past the second check however."}], "tags": [], "owner": {"reputation": 6873, "user_id": 5131711, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z5oP7.png?s=128&g=1", "display_name": "followed Monica to Codidact", "link": "https://stackoverflow.com/users/5131711/followed-monica-to-codidact"}, "is_accepted": false, "score": 2, "last_activity_date": 1562757446, "last_edit_date": 1562757446, "creation_date": 1562756825, "answer_id": 56969389, "question_id": 56968322, "link": "https://stackoverflow.com/questions/56968322/why-is-the-pll-not-locking-is-my-clock-configuration-correct/56969389#56969389", "title": "Why is the PLL not locking? Is my clock configuration correct?", "body": "<p>After disabling the PLL with <code>RCC-&gt;CR &amp;= ~(RCC_CR_PLLON_Msk);</code> <strong>wait until <code>PLLRDY</code> is cleared</strong>.</p>\n\n<p>Your code does the opposite, waits until <code>PLLRDY</code> is set, meaning it's locked. But you've just disabled it, so it's not going to lock.</p>\n\n<p>After setting up <code>PLLCFGR</code>, turn it back on, and wait until <code>PLLRDY</code> is set. This part looks OK in the code.</p>\n\n<hr>\n\n<p>When the PLL is running at the required speed, you should set the <strong>System clock switch</strong> (<code>RCC_CFGR_SW</code>) to PLL instead of the Microcontroller clock output to have your system run on the PLL clock.</p>\n\n<p>Microcontroller clock output does something else. It can be connected to an external pin, to <em>output</em> the clock signal for using it outside the MCU, e.g. to synchronise several MCUs.</p>\n"}, {"comments": [{"owner": {"reputation": 147, "user_id": 11681090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcbd712770f6d2bc37de2c27ec4ef8ec?s=128&d=identicon&r=PG&f=1", "display_name": "arry_h", "link": "https://stackoverflow.com/users/11681090/arry-h"}, "edited": false, "score": 0, "creation_date": 1562759306, "post_id": 56969523, "comment_id": 100476601, "body": "A huge thank you for this help. I had certainly missed setting the MSI as the PLLSRC. The code now runs well!"}], "tags": [], "owner": {"reputation": 3648, "user_id": 4931630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4290ddd0630dd0091e3b9713a23c3434?s=128&d=identicon&r=PG&f=1", "display_name": "AterLux", "link": "https://stackoverflow.com/users/4931630/aterlux"}, "is_accepted": true, "score": 3, "last_activity_date": 1562757895, "last_edit_date": 1562757895, "creation_date": 1562757302, "answer_id": 56969523, "question_id": 56968322, "link": "https://stackoverflow.com/questions/56968322/why-is-the-pll-not-locking-is-my-clock-configuration-correct/56969523#56969523", "title": "Why is the PLL not locking? Is my clock configuration correct?", "body": "<p>Please refer to the <a href=\"https://www.st.com/content/ccc/resource/technical/document/reference_manual/group0/b0/ac/3e/8f/6d/21/47/af/DM00151940/files/DM00151940.pdf/jcr:content/translations/en.DM00151940.pdf\" rel=\"nofollow noreferrer\">Reference Manual</a> (pdf) section 6.2.3 \"MSI clock\", \"Hardware auto calibration with LSE (PLL-mode)\" and section 6.4.1 \"Clock control register (RCC_CR)\"</p>\n\n<p>There is in your code:</p>\n\n<pre><code>RCC-&gt;CR |= RCC_CR_MSIPLLEN;\n</code></pre>\n\n<p>But before enabling PLL mode on the MSI clock you have two things to be done:</p>\n\n<ol>\n<li>External low-frequency resonator or oscillator should be installed (e.g. 32768Hz clock quartz)</li>\n<li>As said in the <strong>Bit 2 MSIPLLEN</strong> description: <em>MSIPLLEN must be enabled after LSE is enabled (LSEON enabled) and ready (LSERDY set\nby hardware).There is a hardware protection to avoid enabling MSIPLLEN if LSE is not\nready.</em> </li>\n</ol>\n\n<p>So, if you have LSE installed, first you have to turn it on, and wait until it ready:</p>\n\n<pre><code>RCC-&gt;BDCR |= (RCC_BDCR_LSEON);\n/*Make sure LSE is ready*/\nwhile(!(RCC-&gt;BDCR &amp; RCC_BDCR_LSERDY));\n</code></pre>\n\n<p>But probably you don't have to use PLL function of the MSI, because USART much more tolerant to frequency deviations. Then MSI-PLL mode should be kept disabled.</p>\n\n<p>STM32 MCUs have some protection mechanics to avoid wrongly switch the clock source. Some bits cannot be set until clock source is ready, or cannot be cleared if the clock source is in use. They are described in the reference manual in bit descriptions.</p>\n\n<p>So, please, carefully compare all steps you're doing to the manual.</p>\n\n<p><strong>UPD</strong> \nAs pointed out in another answer</p>\n\n<pre><code>/*Turn off PLL to allow to make changes*/\nRCC-&gt;CR &amp;= ~(RCC_CR_PLLON_Msk);\n\n\n/*Make sure PLL is locked*/\nwhile(!(RCC-&gt;CR &amp; RCC_CR_PLLRDY));\n</code></pre>\n\n<p>You cannot have PLL locked when it is disabled. So, the while-loop will run forever.</p>\n\n<p><strong>UPD2</strong></p>\n\n<p>Before enabling the PLL you forget to set up it's source (bits PLLSRC in PLLCFGR). I.e.:</p>\n\n<pre><code>// set MSI as the source for PLL\nRCC-&gt;PLLCFGR = (RCC-&gt;PLLCFGR &amp; ~RCC_PLLCFGR_PLLSRC_Msk) | RCC_PLLCFGR_PLLSRC_MSI; \n</code></pre>\n"}], "owner": {"reputation": 147, "user_id": 11681090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcbd712770f6d2bc37de2c27ec4ef8ec?s=128&d=identicon&r=PG&f=1", "display_name": "arry_h", "link": "https://stackoverflow.com/users/11681090/arry-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1066, "favorite_count": 1, "accepted_answer_id": 56969523, "answer_count": 3, "score": 2, "last_activity_date": 1562757895, "creation_date": 1562752991, "last_edit_date": 1562757216, "question_id": 56968322, "link": "https://stackoverflow.com/questions/56968322/why-is-the-pll-not-locking-is-my-clock-configuration-correct", "title": "Why is the PLL not locking? Is my clock configuration correct?", "body": "<p>I am using the stm32l412kb for UART communication. I am trying to configure the USART2 peripheral clock to a 72MHz frequency. The stm32, after reset, uses the MSI at 4MHz, which I then use the PLL to extend to 72MHz when reaching the peripheral. </p>\n\n<p>The code holds at the first PLLRDY check, as the PLL I assume is not locking. Could this be due to a too high a frequency output? Have I configure everything correctly? How do I know that the PLL is then being used instead of the 4MHz MSI, or the 24MHz HSE?</p>\n\n<p>'''</p>\n\n<pre><code>void configureClocks(){\n/*Clock Configuration\n * The MSI (at 4MHz) is used as system clock source after startup from Reset.\n * */\n\n/*Turning on the medium speed internal clock (making sure it's on)*/\nRCC-&gt;CR |= RCC_CR_MSION;\nRCC-&gt;CR |= RCC_CR_MSIPLLEN;\n\n/*Waiting until clock is ready*/\nwhile(!(RCC-&gt;CR &amp; RCC_CR_MSIRDY));\n\n/*Selecting the MSI (0010) as the MCU clock output*/\nRCC-&gt;CFGR   &amp;= RCC_CFGR_MCOSEL_Msk;\nRCC-&gt;CFGR   |= (0b0010&lt;&lt;RCC_CFGR_MCOSEL_Pos);\n\n\n/*Turn off PLL to allow to make changes*/\nRCC-&gt;CR &amp;= ~(RCC_CR_PLLON_Msk);\n\n\n/*Make sure PLL is locked*/\nwhile(!(RCC-&gt;CR &amp; RCC_CR_PLLRDY));\n\n/*At 4Mhz, (4*36/2 = 72Mhz)*/\nRCC-&gt;PLLCFGR &amp;= ~(RCC_PLLCFGR_PLLN_Msk | RCC_PLLCFGR_PLLM_Msk);\nRCC-&gt;PLLCFGR |= (2 &lt;&lt; RCC_PLLCFGR_PLLM_Pos) | (36 &lt;&lt; RCC_PLLCFGR_PLLN_Pos);\n\n/*Turning back on the PLL clock*/\nRCC-&gt;CR |= RCC_CR_PLLON;\n\n\n/*Waiting until clock is ready*/\nwhile(!(RCC-&gt;CR &amp; RCC_CR_PLLRDY));\n\n/*Selecting the PLL (0101) as the microcontroller clock output*/\nRCC-&gt;CFGR   &amp;= RCC_CFGR_MCOSEL_Msk;\nRCC-&gt;CFGR   |= (0b0101&lt;&lt;RCC_CFGR_MCOSEL_Pos);\n\n/*Enabling the USART2 peripheral clock.*/\nRCC-&gt;APB1ENR1 &amp;= ~(RCC_APB1ENR1_USART2EN_Msk);\nRCC-&gt;APB1ENR1 |= (0b1 &lt;&lt; RCC_APB1ENR1_USART2EN_Pos);\n\n/*Enabling the GPIOA port peripheral clock*/\nRCC-&gt;AHB2ENR &amp;= ~(RCC_AHB2ENR_GPIOAEN_Msk);\nRCC-&gt;AHB2ENR |= (0b1 &lt;&lt; RCC_AHB2ENR_GPIOAEN_Pos);\nreturn;\n}\n</code></pre>\n\n<p>'''</p>\n\n<p>Your responses are always much appreciated,</p>\n\n<p>Many thanks,</p>\n\n<p>Harry</p>\n\n<p>Update, thanks to comments:\nThe first PLL check has been changed from:</p>\n\n<pre><code>while(!(RCC-&gt;CR &amp; RCC_CR_MSIRDY));\n</code></pre>\n\n<p>to:</p>\n\n<pre><code>while(RCC-&gt;CR &amp; RCC_CR_MSIRDY);\n</code></pre>\n\n<p>However, the PLL check still gets stuck on the second one.</p>\n"}, {"tags": ["c++", "c", "mpi"], "comments": [{"owner": {"reputation": 32078, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 6, "creation_date": 1562752643, "post_id": 56968131, "comment_id": 100473084, "body": "<code>__cplusplus</code> is defined when you are compiling translation unit as C++ code. <code>extern &quot;C&quot; { }</code> does not make code inside compile as C"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1562752964, "post_id": 56968131, "comment_id": 100473296, "body": "__cplusplus is a macro. It is defined and used by the preprocessor. The preprocessor has no idea about curly braces or C++ keywords. So whatever you expect of __cplusplus is fundamentally impossible."}, {"owner": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "edited": false, "score": 3, "creation_date": 1562754435, "post_id": 56968131, "comment_id": 100474067, "body": "The question is a prime example of an XY-Problem. You didn&#39;t include any code or error message - now you got <i>four correct answers</i> addressing your <i>question</i>, but probably not your <i>problem</i>. Please <a href=\"https://stackoverflow.com/posts/56968131/edit\">edit</a> your question to make it more useful and to avoid that for any further questions."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1562755665, "post_id": 56968131, "comment_id": 100474700, "body": "<i>this will not work as <code>mpi.h</code> still finds <code>__cplusplus</code> and will still load like it was opened by C++.</i>  If <code>__cplusplus</code> was defined at compile time, and you didn&#39;t improperly define it yourself in C code, the library <b>is being opened by C++ code.</b>  <code>#undef __cplusplus</code> is <a href=\"http://www.catb.org/~esr/jargon/html/E/Easter-egging.html\" rel=\"nofollow noreferrer\">Easter egging</a> - you are blindly changing things you don&#39;t understand trying to fix something."}], "answers": [{"comments": [{"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 1, "creation_date": 1562754082, "post_id": 56968247, "comment_id": 100473895, "body": "Do you play nice with a C compiler?"}, {"owner": {"reputation": 32882, "user_id": 1870760, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/NAAkp.png?s=128&g=1", "display_name": "Hatted Rooster", "link": "https://stackoverflow.com/users/1870760/hatted-rooster"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1562754686, "post_id": 56968247, "comment_id": 100474177, "body": "@Bathsheba Only on sundays."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1562755541, "post_id": 56968247, "comment_id": 100474655, "body": "I don&#39;t think that it is important that it is a C++ <i>compiler</i> but whether it is C++ <i>compiling</i> (i.e. a <code>.cpp</code> file)."}], "tags": [], "owner": {"reputation": 32882, "user_id": 1870760, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/NAAkp.png?s=128&g=1", "display_name": "Hatted Rooster", "link": "https://stackoverflow.com/users/1870760/hatted-rooster"}, "is_accepted": false, "score": 7, "last_activity_date": 1562752784, "creation_date": 1562752784, "answer_id": 56968247, "question_id": 56968131, "link": "https://stackoverflow.com/questions/56968131/why-is-cplusplus-defined-within-extern-c/56968247#56968247", "title": "Why is __cplusplus defined within extern &quot;C&quot;", "body": "<p><code>__cplusplus</code> will always be defined by the compiler if the compiler is a C++ compiler. <code>extern \"C\" {}</code> only gives you C linkage so the code inside plays nice with a C compiler.</p>\n"}, {"tags": [], "owner": {"reputation": 9079, "user_id": 73299, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/ae887ea49a5c212e2ab407d90eba4c8c?s=128&d=identicon&r=PG", "display_name": "tstenner", "link": "https://stackoverflow.com/users/73299/tstenner"}, "is_accepted": false, "score": 3, "last_activity_date": 1562752792, "creation_date": 1562752792, "answer_id": 56968249, "question_id": 56968131, "link": "https://stackoverflow.com/questions/56968131/why-is-cplusplus-defined-within-extern-c/56968249#56968249", "title": "Why is __cplusplus defined within extern &quot;C&quot;", "body": "<p>Because they are different things. <code>extern \"C\" {}</code> tells the compiler how to export symbols (<a href=\"https://stackoverflow.com/q/1041866/73299\">see here</a>), whereas <code>__cplusplus</code> tells you that you can use C++ code so your library can use different code paths inbetween <code>#ifdef</code>s.</p>\n"}, {"comments": [{"owner": {"reputation": 32882, "user_id": 1870760, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/NAAkp.png?s=128&g=1", "display_name": "Hatted Rooster", "link": "https://stackoverflow.com/users/1870760/hatted-rooster"}, "edited": false, "score": 0, "creation_date": 1562752852, "post_id": 56968253, "comment_id": 100473215, "body": "Can I wrap you up inside <code>extern &quot;ST&quot;</code> ?"}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 32882, "user_id": 1870760, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/NAAkp.png?s=128&g=1", "display_name": "Hatted Rooster", "link": "https://stackoverflow.com/users/1870760/hatted-rooster"}, "edited": false, "score": 3, "creation_date": 1562752874, "post_id": 56968253, "comment_id": 100473234, "body": "@SombreroChicken - ST linkage results in UB."}], "tags": [], "owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "is_accepted": false, "score": 2, "last_activity_date": 1562752807, "creation_date": 1562752807, "answer_id": 56968253, "question_id": 56968131, "link": "https://stackoverflow.com/questions/56968131/why-is-cplusplus-defined-within-extern-c/56968253#56968253", "title": "Why is __cplusplus defined within extern &quot;C&quot;", "body": "<p>Of course it's defined. It's still a C++ compiler that compiled the code inside the <code>extern \"C\"</code> block. It doesn't stop treating the code as C++, only makes sure to use a C calling/naming convention.</p>\n\n<p>If the header cannot be compiled by a C++ compiler, the only recourse is to create a <strong>C</strong> wrapper that exposes a C++ compatible API.</p>\n"}, {"tags": [], "owner": {"reputation": 592, "user_id": 4264155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00606b6f44e3bb6dcce12d100b01f3a6?s=128&d=identicon&r=PG", "display_name": "Shrikanth N", "link": "https://stackoverflow.com/users/4264155/shrikanth-n"}, "is_accepted": false, "score": 3, "last_activity_date": 1562752937, "creation_date": 1562752937, "answer_id": 56968305, "question_id": 56968131, "link": "https://stackoverflow.com/questions/56968131/why-is-cplusplus-defined-within-extern-c/56968305#56968305", "title": "Why is __cplusplus defined within extern &quot;C&quot;", "body": "<p>The point of using </p>\n\n<pre><code>#ifdef __cplusplus\nextern \"C\" {\n#endif\n\n...\n\n#ifdef __cplusplus\n}\n#endif\n</code></pre>\n\n<p>is to prevent the name mangling that C++ does. We are basically saying dont use the name mangling like a traditional C++ function call instead leave it undecorated.\nThis link could be useful <a href=\"https://en.wikipedia.org/wiki/Name_mangling\" rel=\"nofollow noreferrer\">Name mangling</a></p>\n\n<p>It is used to make C headers compatible with C++.\nThe flag <code>__cplusplus</code> is automatically defined in C++ compiler.</p>\n"}, {"tags": [], "owner": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "is_accepted": false, "score": 1, "last_activity_date": 1562766271, "last_edit_date": 1562766271, "creation_date": 1562754268, "answer_id": 56968694, "question_id": 56968131, "link": "https://stackoverflow.com/questions/56968131/why-is-cplusplus-defined-within-extern-c/56968694#56968694", "title": "Why is __cplusplus defined within extern &quot;C&quot;", "body": "<p>If you <code>#include &lt;mpi.h&gt;</code> from a C++ program, just don't put <code>extern \"C\"</code> around it. At least OpenMPI and Intel MPI do this for you in the header itself - if <code>__cplusplus</code> is defined.</p>\n\n<p>You probably get into trouble because some MPI implementations still define the C++ interface in <code>mpi.h</code> that was deleted from the standard. This obviously breaks under <code>extern \"C\"</code>. For instance with OpenMP you can skip this by setting <code>OMPI_SKIP_MPICXX</code>. Then the double <code>extern \"C\"</code> works, but I still wouldn't recommend it.</p>\n\n<p>Update: In case you can't modify the library header, just <code>#include &lt;mpi.h&gt;</code> before <code>#include &lt;lib.h&gt;</code>. </p>\n\n<p>That said, you should not use the C++ bindings for MPI. They were <strong>removed</strong> from the standard more than 6 years ago, after being for 3 years...</p>\n"}, {"comments": [{"owner": {"reputation": 87, "user_id": 2722085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea3920cf6e72b830706b4223c4f2b302?s=128&d=identicon&r=PG&f=1", "display_name": "user2722085", "link": "https://stackoverflow.com/users/2722085/user2722085"}, "edited": false, "score": 0, "creation_date": 1562766313, "post_id": 56971529, "comment_id": 100480501, "body": "The problem still persists in the real world program which loads a cpp library that again depends on the C library using mpi. The error is <code>libbla_plugin.so: undefined symbol: _ZN3MPI3Win4FreeEv</code>"}, {"owner": {"reputation": 87, "user_id": 2722085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea3920cf6e72b830706b4223c4f2b302?s=128&d=identicon&r=PG&f=1", "display_name": "user2722085", "link": "https://stackoverflow.com/users/2722085/user2722085"}, "edited": false, "score": 0, "creation_date": 1562768041, "post_id": 56971529, "comment_id": 100481567, "body": "Finally found the error for this too: I linked against the C version of MPI lib in the cpp library in cmake."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 2, "last_activity_date": 1562764408, "creation_date": 1562764408, "answer_id": 56971529, "question_id": 56968131, "link": "https://stackoverflow.com/questions/56968131/why-is-cplusplus-defined-within-extern-c/56971529#56971529", "title": "Why is __cplusplus defined within extern &quot;C&quot;", "body": "<p>The compiler outputs the following:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>In file included from /usr/include/c++/4.8.2/bits/stl_algobase.h:61:0,\n                 from /usr/include/c++/4.8.2/bits/stl_tree.h:61,\n                 from /usr/include/c++/4.8.2/map:60,\n                 from /usr/include/openmpi-x86_64/openmpi/ompi/mpi/cxx/mpicxx.h:38,\n                 from /usr/include/openmpi-x86_64/mpi.h:2674,\n                 from x1.cpp:6:\n/usr/include/c++/4.8.2/bits/cpp_type_traits.h:72:3: error: template with C linkage\n   template&lt;typename _Iterator, typename _Container&gt;\n   ^\n/usr/include/c++/4.8.2/bits/cpp_type_traits.h:85:3: error: template with C linkage\n   template&lt;bool&gt;\n   ^\n...\n</code></pre>\n\n<p>The mpi.h header detects that it's being compiled as C++ and so includes C++ specific features.  However templates (among other things) don't work with C linkage (i.e. if the header is within an <code>extern \"C\"</code> block).  </p>\n\n<p>Move the include above <code>extern \"C\"</code>:</p>\n\n<pre><code>#include &lt;mpi.h&gt;\n\n#ifdef __cplusplus\nextern \"C\" {\n#endif\n\nvoid library_do(MPI_Comm comm);\n\n#ifdef __cplusplus\n}\n#endif\n</code></pre>\n"}], "owner": {"reputation": 87, "user_id": 2722085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea3920cf6e72b830706b4223c4f2b302?s=128&d=identicon&r=PG&f=1", "display_name": "user2722085", "link": "https://stackoverflow.com/users/2722085/user2722085"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 600, "favorite_count": 0, "accepted_answer_id": 56971529, "answer_count": 6, "score": 4, "last_activity_date": 1562766271, "creation_date": 1562752510, "last_edit_date": 1562764070, "question_id": 56968131, "link": "https://stackoverflow.com/questions/56968131/why-is-cplusplus-defined-within-extern-c", "title": "Why is __cplusplus defined within extern &quot;C&quot;", "body": "<p>Within extern <code>\"C\" { }</code> the macro <code>__cplusplus</code> is still defined. When I want to include the C version of <code>mpi.h</code> in the header of my library which is dynamically load this will not work as <code>mpi.h</code> still finds <code>__cplusplus</code> and will still load like it was opened by C++.</p>\n\n<p><code>#undef __cplusplus</code> works with gcc. But I do not want to rely on this.</p>\n\n<p>So how to write a C++ program that \n - uses the C++ version of mpi and\n - is linked against a C-library that uses the C-Version of mpi (where <code>#include &lt;mpi.h&gt;</code> appears already in the header?</p>\n\n<p><strong>Example code:</strong></p>\n\n<p>library.h:</p>\n\n<pre><code>#ifdef __cplusplus\nextern \"C\" {\n#endif\n\n#include &lt;mpi.h&gt;\n\nvoid library_do(MPI_Comm comm);\n\n#ifdef __cplusplus\n}\n#endif\n</code></pre>\n\n<p>program.cpp:</p>\n\n<pre><code>#include &lt;library.h&gt;\n\n#include &lt;mpi.h&gt;\n\nint main() {\n  MPI::Init();\n  // do some mpi C++ calls...  \n  library_do(MPI::COMM_WORLD);\n  MPI::Finalize();\n}\n</code></pre>\n\n<p>In case somebody wants to play the example here the library.c:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include \"library.h\"\n\nvoid library_do(MPI_Comm comm)\n{\n    int rank;\n    MPI_Comm_rank(comm, &amp;rank);\n    printf(\"MPI Rank: %d\", rank);\n}\n</code></pre>\n\n<p>And to compile everything I try with</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>mpicc -shared library.c -o lib.so\nmpicxx program.cpp -l lib.so\n</code></pre>\n"}, {"tags": ["c", "floating-point", "precision", "floating-accuracy"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1562752601, "post_id": 56968111, "comment_id": 100473055, "body": "Very related: <a href=\"https://stackoverflow.com/questions/588004/is-floating-point-math-broken\">Is floating point math broken?</a>"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1562752672, "post_id": 56968111, "comment_id": 100473100, "body": "And for floating point values, you should almost never do direct comparison for equality. Use an <i>epsilon</i> to compare for closeness instead."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 2055, "user_id": 6564148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u3HL5.png?s=128&g=1", "display_name": "George", "link": "https://stackoverflow.com/users/6564148/george"}, "edited": false, "score": 0, "creation_date": 1562752847, "post_id": 56968111, "comment_id": 100473211, "body": "@George: Some programmer dude said &quot;an epsilon&quot;, not a particular epsilon."}, {"owner": {"reputation": 2055, "user_id": 6564148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u3HL5.png?s=128&g=1", "display_name": "George", "link": "https://stackoverflow.com/users/6564148/george"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1562752961, "post_id": 56968111, "comment_id": 100473293, "body": "@Bathsheba Ah yep missed that. Though i&#39;d argue it&#39;s confusing since C++ defines FLT_EPSILON and std::numeric_limits&lt;float/double&gt;::epsilon."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 2055, "user_id": 6564148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u3HL5.png?s=128&g=1", "display_name": "George", "link": "https://stackoverflow.com/users/6564148/george"}, "edited": false, "score": 0, "creation_date": 1562753052, "post_id": 56968111, "comment_id": 100473360, "body": "@George: As I&#39;m sure you know, neither have any bearing at all on a choice of multiplicative, additive, or other type of <i>epsilon</i> one could consider using when comparing numerical quantities,"}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1562753126, "post_id": 56968111, "comment_id": 100473384, "body": "This question is very close (to the point I&#39;d probably say duplicate) to <a href=\"https://stackoverflow.com/questions/41691261/strange-output-when-comparing-same-float-values\">this</a> and <a href=\"https://stackoverflow.com/questions/1839422/strange-output-in-comparison-of-float-with-float-literal\">this</a>."}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1562755667, "post_id": 56968111, "comment_id": 100474702, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/9461744/explain-this-floating-point-behavior\">Explain this floating point behavior</a>"}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1562755717, "post_id": 56968111, "comment_id": 100474727, "body": "<a href=\"https://stackoverflow.com/q/16698198/995714\">Can someone please explain me that in java why 0.6 is &lt;0.6f but 0.7is &gt;=0.7f</a>, <a href=\"https://stackoverflow.com/q/6883306/995714\">Floating point comparison <code>a != 0.7</code></a>, <a href=\"https://stackoverflow.com/q/1839422/995714\">strange output in comparison of float with float literal</a>"}, {"owner": {"reputation": 24610, "user_id": 270986, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c49652c88a43a35bbf0095abfdae3515?s=128&d=identicon&r=PG", "display_name": "Mark Dickinson", "link": "https://stackoverflow.com/users/270986/mark-dickinson"}, "edited": false, "score": 0, "creation_date": 1562779722, "post_id": 56968111, "comment_id": 100487903, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/1839422/strange-output-in-comparison-of-float-with-float-literal\">strange output in comparison of float with float literal</a>"}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 10081769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/011da060645bb715604dff814b44d201?s=128&d=identicon&r=PG&f=1", "display_name": "Artho Cruz", "link": "https://stackoverflow.com/users/10081769/artho-cruz"}, "edited": false, "score": 0, "creation_date": 1562752760, "post_id": 56968146, "comment_id": 100473162, "body": "SO only for 0.5 the if part will work and for all other comparisons the else part will work, isn&#39;t it??@Bathsheba"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 31, "user_id": 10081769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/011da060645bb715604dff814b44d201?s=128&d=identicon&r=PG&f=1", "display_name": "Artho Cruz", "link": "https://stackoverflow.com/users/10081769/artho-cruz"}, "edited": false, "score": 0, "creation_date": 1562752801, "post_id": 56968146, "comment_id": 100473188, "body": "Other numbers will work too, e.g. small integers, rationals like 0.25, large integral powers of 2."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 31, "user_id": 10081769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/011da060645bb715604dff814b44d201?s=128&d=identicon&r=PG&f=1", "display_name": "Artho Cruz", "link": "https://stackoverflow.com/users/10081769/artho-cruz"}, "edited": false, "score": 0, "creation_date": 1562753615, "post_id": 56968146, "comment_id": 100473662, "body": "@Downvoter if I&#39;ve slipped something please let me know."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 2, "creation_date": 1562754423, "post_id": 56968146, "comment_id": 100474060, "body": "I did not down vote, but being a dyadic rational is a necessary but not sufficient condition that a number is exactly representable both as a <code>float</code> and a <code>double</code> (even assuming the C implementation uses base two). So this answer does not contain a full explanation."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1562764238, "post_id": 56968146, "comment_id": 100479379, "body": "I&#39;ve addressed that by adding &quot;of an appropriate magnitude&quot;."}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": true, "score": 4, "last_activity_date": 1562754526, "last_edit_date": 1562754526, "creation_date": 1562752534, "answer_id": 56968146, "question_id": 56968111, "link": "https://stackoverflow.com/questions/56968111/wrong-result-when-comparing-0-55-and-0-55f/56968146#56968146", "title": "Wrong result when comparing 0.55 and 0.55f", "body": "<p><code>0.5</code> is a <a href=\"https://en.wikipedia.org/wiki/Dyadic_rational\" rel=\"nofollow noreferrer\"><em>dyadic rational</em></a> and of an appropriate magnitude so <code>0.5</code> is exactly one-half either as a <code>float</code> or a <code>double</code>.</p>\n\n<p>The same cannot be said for <code>0.55</code>. A <code>double</code> will store that number with no less precision than a <code>float</code>, and most likely more.</p>\n\n<p>In both cases, the <code>float</code> is implicitly converted to a <code>double</code> prior to <code>==</code>, but by then any truncation has taken place.</p>\n"}, {"tags": [], "owner": {"reputation": 1549, "user_id": 8549281, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Jykz4.jpg?s=128&g=1", "display_name": "GOVIND DIXIT", "link": "https://stackoverflow.com/users/8549281/govind-dixit"}, "is_accepted": false, "score": 4, "last_activity_date": 1562753265, "last_edit_date": 1562753265, "creation_date": 1562752900, "answer_id": 56968290, "question_id": 56968111, "link": "https://stackoverflow.com/questions/56968111/wrong-result-when-comparing-0-55-and-0-55f/56968290#56968290", "title": "Wrong result when comparing 0.55 and 0.55f", "body": "<p>You are comparing two different types of values which are double and float. Think about the limitations of size with inexact numbers.</p>\n\n<h2>Exact values (decimal)</h2>\n\n<p>A -> 1/2 with 5 decimals is 0.5000</p>\n\n<p>B -> 1/2 with 10 decimals is 0.5000000000</p>\n\n<p>A == B will always return true</p>\n\n<h2>Inexact values (decimal)</h2>\n\n<p>A -> 1/3 with 5 decimals is 0.33333</p>\n\n<p>B -> 1/3 with 10 decimals is 0.3333333333</p>\n\n<p>A == B -> will always return false because they aren't the same.</p>\n\n<p>Similarly, 0.55 cannot be represented exactly in binary but 0.5 can be.</p>\n\n<p>The binary representation of 0.55d -> 0.10001100110011001101...</p>\n\n<p>So they will not be equal  </p>\n\n<p>The binary representation of 0.5d -> 0.1</p>\n\n<p>So they will be equal</p>\n\n<p>Hope It clears your doubt</p>\n"}], "owner": {"reputation": 31, "user_id": 10081769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/011da060645bb715604dff814b44d201?s=128&d=identicon&r=PG&f=1", "display_name": "Artho Cruz", "link": "https://stackoverflow.com/users/10081769/artho-cruz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 454, "favorite_count": 0, "accepted_answer_id": 56968146, "answer_count": 2, "score": 1, "last_activity_date": 1562754526, "creation_date": 1562752456, "last_edit_date": 1562754300, "question_id": 56968111, "link": "https://stackoverflow.com/questions/56968111/wrong-result-when-comparing-0-55-and-0-55f", "title": "Wrong result when comparing 0.55 and 0.55f", "body": "<p>In C, <code>0.55 == 0.55f</code> is false while <code>0.5 == 0.5f</code> is true. Why is it different?</p>\n\n<ol>\n<li><p>Comparing <code>0.55</code>:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main() {\n    if (0.55 == 0.55f)\n        printf(\"Hi\");\n    else\n        printf(\"Hello\");\n}\n</code></pre>\n\n<p>Outputs <code>Hello</code>.</p></li>\n<li><p>Comparing <code>0.5</code>:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main() {\n    if (0.5 == 0.5f)\n        printf(\"Hi\");\n    else\n        printf(\"Hello\");\n}\n</code></pre>\n\n<p>Outputs <code>Hi</code>.</p></li>\n</ol>\n\n<p>For both the code snippets, I expected <code>Hello</code>.<br>\nWhy this difference?</p>\n"}, {"tags": ["c", "malloc", "out-of-memory"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 3, "creation_date": 1562752399, "post_id": 56968032, "comment_id": 100472938, "body": "This should be easy to figure out if you just stepped through the code, line by line, in a debugger. And know how <a href=\"https://en.cppreference.com/w/c/io/fgets\" rel=\"nofollow noreferrer\"><code>fgets</code></a> really works."}], "answers": [{"comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1562752757, "post_id": 56968187, "comment_id": 100473159, "body": "Actually the buffer is big enough for three characters plus terminator, leaving the newline to be read in the next iteration as an empty line."}, {"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1562752898, "post_id": 56968187, "comment_id": 100473245, "body": "@Someprogrammerdude : sure, but that doesn&#39;t appear to be the desired behavior here - the code won&#39;t handle reading an empty line in the second iteration very well."}, {"owner": {"reputation": 141, "user_id": 11527052, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-lS_-2UaV8G0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcje4dKnsWqzoTS4MSOeukJWFHTwA/mo/photo.jpg?sz=128", "display_name": "Michaelangelo Meucci", "link": "https://stackoverflow.com/users/11527052/michaelangelo-meucci"}, "edited": false, "score": 0, "creation_date": 1562756056, "post_id": 56968187, "comment_id": 100474918, "body": "thank you for pointing out also that issue, but there must be another problem because the program already worked well even if argv[2]=3 which is less than 4 characters"}, {"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "reply_to_user": {"reputation": 141, "user_id": 11527052, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-lS_-2UaV8G0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcje4dKnsWqzoTS4MSOeukJWFHTwA/mo/photo.jpg?sz=128", "display_name": "Michaelangelo Meucci", "link": "https://stackoverflow.com/users/11527052/michaelangelo-meucci"}, "edited": false, "score": 0, "creation_date": 1562757368, "post_id": 56968187, "comment_id": 100475594, "body": "@MichaelangeloMeucci : if <code>argv[2]</code> is <code>3</code>, then <code>maxc</code> is <code>9</code>. I assume none of the lines in your file has more than 7 characters ?"}, {"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "reply_to_user": {"reputation": 141, "user_id": 11527052, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-lS_-2UaV8G0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcje4dKnsWqzoTS4MSOeukJWFHTwA/mo/photo.jpg?sz=128", "display_name": "Michaelangelo Meucci", "link": "https://stackoverflow.com/users/11527052/michaelangelo-meucci"}, "edited": false, "score": 0, "creation_date": 1562760343, "post_id": 56968187, "comment_id": 100477200, "body": "@MichaelangeloMeucci : time to follow Someprogrammerdude&#39;s advice then, and bring out the debugger."}, {"owner": {"reputation": 141, "user_id": 11527052, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-lS_-2UaV8G0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcje4dKnsWqzoTS4MSOeukJWFHTwA/mo/photo.jpg?sz=128", "display_name": "Michaelangelo Meucci", "link": "https://stackoverflow.com/users/11527052/michaelangelo-meucci"}, "edited": false, "score": 0, "creation_date": 1562760536, "post_id": 56968187, "comment_id": 100477293, "body": "you&#39;re right I&#39;ve forgotten I&#39;m doing the square of that value. But the program still doesn&#39;t work. I&#39;ve updated <a href=\"https://ideone.com/Z7UtiR\" rel=\"nofollow noreferrer\">ideone.com/Z7UtiR</a> with your correction"}], "tags": [], "owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "is_accepted": false, "score": 1, "last_activity_date": 1562752625, "creation_date": 1562752625, "answer_id": 56968187, "question_id": 56968032, "link": "https://stackoverflow.com/questions/56968032/memory-allocation-problem-while-reading-a-file/56968187#56968187", "title": "memory allocation problem while reading a file", "body": "<p>Your read buffer only has room for <code>maxc</code> (ie. <code>4</code>) characters :</p>\n\n<pre><code>char buf[maxc]; /*to store each lines of file */\n</code></pre>\n\n<p>You then attempt to get a line from the file into that buffer :</p>\n\n<pre><code>while (fgets (buf, maxc, fp)){\n</code></pre>\n\n<p>But that buffer is only large enough for 2 characters, followed by a newline, and then a <code>'\\0'</code> terminator.</p>\n\n<p>Looking at your sample file, the longest line has 4 characters : <code>\"-4 1\"</code>. So, your buffer needs to at least be able to hold 6 (including the newline and <code>'\\0'</code> terminator).</p>\n\n<p>It's probably better to make your buffer quite a bit larger.</p>\n"}, {"tags": [], "owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "is_accepted": false, "score": 0, "last_activity_date": 1562761514, "creation_date": 1562761514, "answer_id": 56970658, "question_id": 56968032, "link": "https://stackoverflow.com/questions/56968032/memory-allocation-problem-while-reading-a-file/56970658#56970658", "title": "memory allocation problem while reading a file", "body": "<p>The problem is entirely in reading the arrays.</p>\n\n<p>The <code>maxc = 4</code> and the buffer <code>char buf[maxc];</code> has place only for 3 characters and terminating character.</p>\n\n<p>So <code>fgets (buf, maxc, fp)</code>:</p>\n\n<ul>\n<li>on the first will read <code>buf = \"1 2\"</code> (3 characters and zero byte)</li>\n<li>on the second will read <code>buf = \"\\n\"</code> (1 newline character, fgets terminates)</li>\n<li>then reads <code>buf = \"2 3\"</code></li>\n<li>then reads <code>buf = \"\\n\"</code></li>\n<li><code>buf = \"*\\n\"</code></li>\n<li><code>buf = \"-4 \"</code></li>\n<li>and so on</li>\n</ul>\n\n<p>Because of the empty line, inside this code snipped:</p>\n\n<pre><code>    else /* read integers in a line into d */\n    {\n        while (sscanf (p + off, \"%lf%n\", d, &amp;n) == 1) {\n            d++;\n            if(nrow == 0)\n                ncol++;\n            off += n;\n        }\n        nrow++;\n        off = 0;\n    }\n</code></pre>\n\n<p>The variable <code>nrow</code> will be incremented 4 times (2 times for rows, and 2 times for empty lines with only newlines read), which will be 2 times too many. The second matrix will have 1 column, because you will read only <code>-4</code> from the line, so your <code>while(sscanf</code> loop will scan only one number, so <code>ncol</code> will be only 1.</p>\n\n<p>Your fix you posted in the comment is invalid, because you only increased buffer size, but didn't increase the <code>size</code> argument you pass to <code>fgets</code>. If you did <code>char buf[2*maxc];</code> you also should <code>fgets (buf, 2 * maxc, fp)</code>, which will \"fix\" the current problem. I would rather re-write the whole thing or rather write <code>fgets(buf, sizeof(buf)/sizeof(buf[0]), fp)</code> to accommodate future changes. </p>\n\n<p>Don't use <a href=\"https://en.cppreference.com/w/c/language/array#Variable-length_arrays\" rel=\"nofollow noreferrer\">VLAs</a> ex. <code>char buf[maxc];</code>. For simplicity you can use arbitrary long buffer for the line, ex. <code>#define LINE_MAX 1024</code> and <code>char buf[LINE_MAX]</code> and then <code>fgets(buf, sizeof(buf)/sizeof(buf[0]), file)</code>. Or use or rewrite function that will dynamically resize memory and read line, like <a href=\"http://man7.org/linux/man-pages/man3/getline.3.html\" rel=\"nofollow noreferrer\">GNUs getline</a>.</p>\n"}], "owner": {"reputation": 141, "user_id": 11527052, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-lS_-2UaV8G0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcje4dKnsWqzoTS4MSOeukJWFHTwA/mo/photo.jpg?sz=128", "display_name": "Michaelangelo Meucci", "link": "https://stackoverflow.com/users/11527052/michaelangelo-meucci"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1562852718, "creation_date": 1562752190, "last_edit_date": 1562852718, "question_id": 56968032, "link": "https://stackoverflow.com/questions/56968032/memory-allocation-problem-while-reading-a-file", "title": "memory allocation problem while reading a file", "body": "<p>I'm trying to multiply two matrices stored in a file thus formatted:</p>\n\n<pre>\n1 2\n2 3\n*\n-4 1\n1 0\n</pre>\n\n<p>I do not know initially what the dimension of each matrix is. But I let the user define it or otherwise a default value of <code>100</code> is taken.</p>\n\n<pre><code>int maxc = argc &gt; 2 ? atoi(argv[2]) * atoi(argv[2]) : 100;\n</code></pre>\n\n<p>I can already perform the calculation correctly, but I've noticed that if I enter the dimension <code>argv[2] = \"2\"</code> so that <code>maxc = 8</code>, (that should be enough for this example), errors are produced in reading or printing the file. But if I enter <code>argv[2] = \"3\"</code> everything works out fine for this example. Since <code>maxc</code> is used to allocate memory here: <code>matrix = malloc(maxc * sizeof *matrix)</code>, I suspect the problem could be located on that line. Should I allocate memory also for  <code>size_t row; size_t col;</code>?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;ctype.h&gt;\n#include &lt;math.h&gt;\n#include &lt;string.h&gt;\n\n#define MAXNOP 50 /*Max number of operations allowed */\n#define MAXNMATR 20 /*Max number of matrices */\n\nstruct m {\n    size_t row;\n    size_t col;\n    double *data;\n};\n\nstruct m multiply(struct m *A, struct m *B);\nvoid f(double x);\nvoid print_matrix(struct m *A);\nvoid read_file(int maxc, FILE *fp);\nvoid scalar_product(double scalar, struct m *B);\nvoid calculate(struct m *matrix, int nop, int id, char *op);\n\nint main(int argc, char *argv[]) {\n\n    FILE *file = argc &gt; 1 ? fopen(argv[1], \"rb\") : stdin;\n\n    /* define max dimension of a matrix */\n    int maxc = argc &gt; 2 ? atoi(argv[2]) * atoi(argv[2]) : 100;\n    read_file(maxc, file);       \n\n    return 0;\n}\n\nvoid read_file(int maxc, FILE *fp) {\n    struct m *matrix;\n    int id = 0; /* id of a matrix */\n    size_t ncol, nrow; /* No of columns of a matrix*/\n    ncol = nrow = 0;\n    int nop = 0; /*No of operators*/\n    int off = 0;\n    int i;\n    int n;\n    double *d;\n    char buf[2 * maxc]; /*to store each lines of file */\n    char *p = buf;\n    char op[MAXNOP];\n\n    for (i = 0; i &lt; MAXNOP; i++)\n        op[i] = '?';    \n\n    if (!(matrix = malloc(maxc * sizeof *matrix))) {\n        perror(\"malloc-matrix\");\n        exit(1);\n    }\n\n    /* Read file line by line */\n    while (fgets(buf, maxc, fp)) {\n        if (nrow == 0) {\n            /* allocate/validate max no. of matrix */\n            d = matrix[id].data = malloc(sizeof(double) * MAXNMATR);\n        }     \n        /* check if line contains operator */\n        if ((!isdigit(*buf) &amp;&amp; buf[1] =='\\n')) {      \n            op[nop++] = *buf;\n            matrix[id].col = ncol;\n            matrix[id].row = nrow;\n            nrow = ncol = 0;\n            id++;\n            continue;\n        } else {\n            /* read integers in a line into d */\n            while (sscanf(p + off, \"%lf%n\", d, &amp;n) == 1) {\n                d++;\n                if (nrow == 0)\n                    ncol++;\n                off += n;\n            }\n            nrow++;\n            off = 0;\n        }\n    } /*end of while fgets cycle */\n\n    /* Assign last matrix No of columns and rows */\n    matrix[id].col = ncol;\n    matrix[id].row = nrow;\n\n    /* Printing the matrices and operations */\n    for (i = 0; i &lt;= id; i++) {  \n        if (op[i] == '*' || op[i] == '-' || op[i] =='+') {\n            print_matrix(&amp;matrix[i]);\n            if (op[i-1] != 'i')\n                printf(\"%c\\n\", op[i]);\n            else\n                continue;\n        } else      \n        if (op[i] == '?') {\n             print_matrix(&amp;matrix[i]);\n        }        \n    }\n\n    calculate(matrix, nop, id, op);\n}\n\nvoid calculate(struct m *matrix, int nop, int id, char *op) {    \n    int i;\n\n    for (i = 0; i &lt;= nop; i += 2) {        \n        if (op[i] == '*' &amp;&amp; op[i+1] == '?') {\n             if (matrix[i].row == 1 &amp;&amp; matrix[i].col == 1)\n                 scalar_product(matrix[i].data[0], &amp;matrix[i + 1]); //Multiplication of Scalar per matrix\n             else {                 \n                 matrix[i + 1] = multiply(&amp;matrix[i], &amp;matrix[i + 1]);\n                 matrix[i + 2] = multiply(&amp;matrix[i + 1], &amp;matrix[i + 2]);\n             }\n             break;\n         }       \n    }\n\n    printf(\"=\\n\");\n    print_matrix(&amp;matrix[id]); /* Print the result */\n    free(matrix);\n}\n\nstruct m multiply(struct m *A, struct m *B) { \n    size_t i, j, k;\n    struct m C;\n    C.data = malloc(sizeof(double) * A-&gt;row * B-&gt;col);\n\n    C.row = A-&gt;row;\n    C.col = B-&gt;col;\n\n    for (i = 0; i &lt; C.row; i++)\n        for (j= 0 ; j &lt; C.col; j++)\n            C.data[i * C.col + j] = 0;\n\n    // Multiplying matrix A and B and storing in C.\n    for (i = 0; i &lt; A-&gt;row; ++i)\n        for (j = 0; j &lt; B-&gt;col; ++j)\n            for (k = 0; k &lt; A-&gt;col; ++k)\n              C.data[i * C.col + j] += A-&gt;data[i * A-&gt;col + k] * B-&gt;data[k * B-&gt;col + j];\n\n    return C;\n}\n\nvoid f(double x) {\n    double i, f = modf(x, &amp;i);\n\n    if (f &lt; .00001)\n        printf(\"%.f \", i);\n    else\n        printf(\"%f \", x);\n}\n\n/* printing a Matrix */\n\nvoid print_matrix(struct m *A) {\n     size_t i, j;\n     double *tmp = A-&gt;data;\n\n     for (i = 0; i &lt; A-&gt;row; i++) {\n        for (j = 0; j &lt; A-&gt;col; j++) {\n            f(*(tmp++));\n        }\n        putchar('\\n');\n    }\n}\n\nvoid scalar_product(double scalar, struct m *B) {\n     size_t i, j;\n\n     for (i = 0; i &lt; B-&gt;row; i++)\n        for (j = 0; j &lt; B-&gt;col; j++)\n           B-&gt;data[i * B-&gt;col + j] = scalar * B-&gt;data[i * B-&gt;col + j];\n}\n</code></pre>\n\n<p>The expected result is this: <a href=\"https://ideone.com/Z7UtiR\" rel=\"nofollow noreferrer\">https://ideone.com/Z7UtiR</a></p>\n\n<p>here <code>argv[2]</code> is not read so there is enough memory to store all data.</p>\n"}, {"tags": ["javascript", "java", "c", "linked-list"], "comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 4, "creation_date": 1562752236, "post_id": 56967927, "comment_id": 100472838, "body": "Do not post images of code.  Post the code itself.  You&#39;re going to get downvoted for that...."}, {"owner": {"reputation": 1036, "user_id": 11655094, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FDZH9.jpg?s=128&g=1", "display_name": "Saeid Amini", "link": "https://stackoverflow.com/users/11655094/saeid-amini"}, "edited": false, "score": 3, "creation_date": 1562752632, "post_id": 56967927, "comment_id": 100473075, "body": "You can get help here to ask the better way your question:  <a href=\"https://stackoverflow.com/help/how-to-ask\">stackoverflow.com/help/how-to-ask</a>"}, {"owner": {"reputation": 1674, "user_id": 2726561, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8305eb6b7caf74b7d5e75989d8ec09fe?s=128&d=identicon&r=PG&f=1", "display_name": "Vovan", "link": "https://stackoverflow.com/users/2726561/vovan"}, "edited": false, "score": 2, "creation_date": 1562752803, "post_id": 56967927, "comment_id": 100473189, "body": "Guys, thanks for your comments, but i think the question is clear here"}, {"owner": {"reputation": 364, "user_id": 11216297, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb8380466303f4fccb68a2d43a9051a6?s=128&d=identicon&r=PG&f=1", "display_name": "StackLloyd", "link": "https://stackoverflow.com/users/11216297/stacklloyd"}, "edited": false, "score": 0, "creation_date": 1562753121, "post_id": 56967927, "comment_id": 100473382, "body": "I might&#39;ve missed something, but it seems to me that the code doesn&#39;t redirect the previous entry to the one next to the removed entry."}, {"owner": {"reputation": 1074, "user_id": 2185630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/798165e76261cc1d73e033d815effdf9?s=128&d=identicon&r=PG", "display_name": "dbl", "link": "https://stackoverflow.com/users/2185630/dbl"}, "reply_to_user": {"reputation": 364, "user_id": 11216297, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb8380466303f4fccb68a2d43a9051a6?s=128&d=identicon&r=PG&f=1", "display_name": "StackLloyd", "link": "https://stackoverflow.com/users/11216297/stacklloyd"}, "edited": false, "score": 0, "creation_date": 1562753321, "post_id": 56967927, "comment_id": 100473522, "body": "@StackLloyd,  you are wrong as <code>entry</code> param is a valid reference to a member of the list. Either <code>entry-&gt;next</code> is pointing to <b>nothing</b> as it&#39;s the last element in the list or it is pointing to another valid member from that list."}, {"owner": {"reputation": 364, "user_id": 11216297, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb8380466303f4fccb68a2d43a9051a6?s=128&d=identicon&r=PG&f=1", "display_name": "StackLloyd", "link": "https://stackoverflow.com/users/11216297/stacklloyd"}, "reply_to_user": {"reputation": 1074, "user_id": 2185630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/798165e76261cc1d73e033d815effdf9?s=128&d=identicon&r=PG", "display_name": "dbl", "link": "https://stackoverflow.com/users/2185630/dbl"}, "edited": false, "score": 0, "creation_date": 1562754090, "post_id": 56967927, "comment_id": 100473901, "body": "@dbl Yes, but my question was about the element previous to the entry being removed. It still points to the deleted one, doesn&#39;t it?"}, {"owner": {"reputation": 1074, "user_id": 2185630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/798165e76261cc1d73e033d815effdf9?s=128&d=identicon&r=PG", "display_name": "dbl", "link": "https://stackoverflow.com/users/2185630/dbl"}, "edited": false, "score": 0, "creation_date": 1562754728, "post_id": 56967927, "comment_id": 100474202, "body": "Example 1: either <code>head = entry-&gt;next</code> (no prev element to point to head) or <code>prev-&gt;next = entry-&gt;next</code> (prev point to the element after next now). Example 2: <code>indirect</code> is actually a pointer to the <code>next</code> ref of the current element unless it&#39;s still pointing to the head..."}, {"owner": {"reputation": 364, "user_id": 11216297, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb8380466303f4fccb68a2d43a9051a6?s=128&d=identicon&r=PG&f=1", "display_name": "StackLloyd", "link": "https://stackoverflow.com/users/11216297/stacklloyd"}, "edited": false, "score": 0, "creation_date": 1562755305, "post_id": 56967927, "comment_id": 100474522, "body": "It checks for <code>(*indirect) != entry</code> to run the loop, which means that <code>(*indirect) == entry</code> when it eventually finds it and does its job. Fine, alright, no problem. What about the previous element in the list, which pointed <b>TO</b> <code>entry</code>? Is its reference updated as well?"}, {"owner": {"reputation": 13306, "user_id": 162698, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HnjBG.png?s=128&g=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/162698/rob"}, "edited": false, "score": 2, "creation_date": 1562760273, "post_id": 56967927, "comment_id": 100477161, "body": "Your question will be closed. NEVER post images of code, errors or output! <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> Your question is also opinion based and broad. In addition, the link to the talk is pointless as it may go dead over time so it adds nothing to the question. <a href=\"https://stackoverflow.com/help/how-to-ask\">stackoverflow.com/help/how-to-ask</a>"}, {"owner": {"reputation": 13306, "user_id": 162698, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HnjBG.png?s=128&g=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/162698/rob"}, "reply_to_user": {"reputation": 21158, "user_id": 1552534, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uAEcW.jpg?s=128&g=1", "display_name": "WJS", "link": "https://stackoverflow.com/users/1552534/wjs"}, "edited": false, "score": 1, "creation_date": 1562760685, "post_id": 56967927, "comment_id": 100477382, "body": "@WJS It&#39;s a direct violation of SO rules and a common error by new people who never took <a href=\"https://stackoverflow.com/tour\">The Tour</a>. You should read <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 21158, "user_id": 1552534, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uAEcW.jpg?s=128&g=1", "display_name": "WJS", "link": "https://stackoverflow.com/users/1552534/wjs"}, "edited": false, "score": 2, "creation_date": 1562760804, "post_id": 56967927, "comment_id": 100477447, "body": "And you&#39;re not supposed to put code in comments either.  But I see folks with very high reps do it all the time and never get flagged.  The application of rules on this site are very inconsistent."}, {"owner": {"reputation": 13306, "user_id": 162698, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HnjBG.png?s=128&g=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/162698/rob"}, "reply_to_user": {"reputation": 21158, "user_id": 1552534, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uAEcW.jpg?s=128&g=1", "display_name": "WJS", "link": "https://stackoverflow.com/users/1552534/wjs"}, "edited": false, "score": 2, "creation_date": 1562760866, "post_id": 56967927, "comment_id": 100477487, "body": "@WJS Yes. It&#39;s led to many of us getting frustrated and leaving SO in droves. But do not jump off the cliff just because others are doing so."}, {"owner": {"reputation": 21158, "user_id": 1552534, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uAEcW.jpg?s=128&g=1", "display_name": "WJS", "link": "https://stackoverflow.com/users/1552534/wjs"}, "reply_to_user": {"reputation": 13306, "user_id": 162698, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HnjBG.png?s=128&g=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/162698/rob"}, "edited": false, "score": 0, "creation_date": 1562761122, "post_id": 56967927, "comment_id": 100477613, "body": "@Rob  Good point!"}, {"owner": {"reputation": 2353, "user_id": 1529061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38f872870bf727d505514e2609ddd74c?s=128&d=identicon&r=PG", "display_name": "ttzn", "link": "https://stackoverflow.com/users/1529061/ttzn"}, "reply_to_user": {"reputation": 364, "user_id": 11216297, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb8380466303f4fccb68a2d43a9051a6?s=128&d=identicon&r=PG&f=1", "display_name": "StackLloyd", "link": "https://stackoverflow.com/users/11216297/stacklloyd"}, "edited": false, "score": 0, "creation_date": 1562764595, "post_id": 56967927, "comment_id": 100479616, "body": "@StackLloyd it doesn&#39;t need to be updated. The code is directly substituting the value at the memory location. All references that pointed to <code>entry</code> still point at the same location, but the content at that location was replaced with <code>entry-&gt;next</code>."}, {"owner": {"reputation": 364, "user_id": 11216297, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb8380466303f4fccb68a2d43a9051a6?s=128&d=identicon&r=PG&f=1", "display_name": "StackLloyd", "link": "https://stackoverflow.com/users/11216297/stacklloyd"}, "reply_to_user": {"reputation": 2353, "user_id": 1529061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38f872870bf727d505514e2609ddd74c?s=128&d=identicon&r=PG", "display_name": "ttzn", "link": "https://stackoverflow.com/users/1529061/ttzn"}, "edited": false, "score": 0, "creation_date": 1562766282, "post_id": 56967927, "comment_id": 100480481, "body": "@Arminius Thank you, I finally understood."}, {"owner": {"reputation": 21158, "user_id": 1552534, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uAEcW.jpg?s=128&g=1", "display_name": "WJS", "link": "https://stackoverflow.com/users/1552534/wjs"}, "edited": false, "score": 3, "creation_date": 1562766449, "post_id": 56967927, "comment_id": 100480590, "body": "You can write a solution in Java that emulates this process.  Basically, you would need something like a <code>Pointer Node</code> that points to the <code>real node</code> which points to the <code>entry</code>.  But I wouldn&#39;t say it is worth doing.  That is a limitation of not being able to use <code>references</code> like C pointers.  On the other hand, I have never had a <code>segmentation violation</code>  or <code>bus error</code>in Java."}, {"owner": {"reputation": 1674, "user_id": 2726561, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8305eb6b7caf74b7d5e75989d8ec09fe?s=128&d=identicon&r=PG&f=1", "display_name": "Vovan", "link": "https://stackoverflow.com/users/2726561/vovan"}, "reply_to_user": {"reputation": 21158, "user_id": 1552534, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uAEcW.jpg?s=128&g=1", "display_name": "WJS", "link": "https://stackoverflow.com/users/1552534/wjs"}, "edited": false, "score": 0, "creation_date": 1562779481, "post_id": 56967927, "comment_id": 100487800, "body": "Thanks @WJS it makes sense"}], "answers": [{"tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": false, "score": 1, "last_activity_date": 1562807392, "creation_date": 1562807392, "answer_id": 56980425, "question_id": 56967927, "link": "https://stackoverflow.com/questions/56967927/remove-item-from-linked-list-in-a-good-way/56980425#56980425", "title": "Remove item from linked list in a good way", "body": "<p>regarding your question: </p>\n\n<p><em>is this possible to write \"smart\" solution without using if statement for special case on a programming language without C-style pointers</em>   </p>\n\n<p>The answer:</p>\n\n<p>Almost anything is possible when writing code.  </p>\n"}, {"comments": [{"owner": {"reputation": 1674, "user_id": 2726561, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8305eb6b7caf74b7d5e75989d8ec09fe?s=128&d=identicon&r=PG&f=1", "display_name": "Vovan", "link": "https://stackoverflow.com/users/2726561/vovan"}, "edited": false, "score": 1, "creation_date": 1587319784, "post_id": 61288721, "comment_id": 108459532, "body": "I think your <code>remove_list_entry_good</code> method will not work, as references in java passed by value, so if you change  <code>indirect = entry.next</code> reference it will not be changed on the original Node object"}], "tags": [], "owner": {"reputation": 37, "user_id": 9921927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8kaTr.jpg?s=128&g=1", "display_name": "duckbjarne", "link": "https://stackoverflow.com/users/9921927/duckbjarne"}, "is_accepted": false, "score": 1, "last_activity_date": 1617304942, "last_edit_date": 1617304942, "creation_date": 1587211177, "answer_id": 61288721, "question_id": 56967927, "link": "https://stackoverflow.com/questions/56967927/remove-item-from-linked-list-in-a-good-way/61288721#61288721", "title": "Remove item from linked list in a good way", "body": "<p>I extended your code snippets to a whole .c-file to make it more understandable in the context:</p>\n<pre><code>struct node {\n    int data;\n    struct node* next;\n}\n\ntypedef struct node nodde_t;\n\nnode_t* head;\n\n/*bad code*/\nvoid remove_list_entry_bad(node_t* entry){\n    node_t* prev = NULL;\n    node_t* walk = head;\n\n    while(walk != entry){\n        prev = walk;\n        walk = walk-&gt;next;\n    }\n\n    if(!prev)\n        head = entry-&gt;next;\n    else\n        prev-&gt;next = entry-&gt;next;\n}\n\n/*good code*/\nvoid remove_list_entry_good(node_t* entry){\n    \n    node_t** indirect = &amp;head;\n\n    while ((*indirect) != entry)\n        indirect = &amp;(*indirect)-&gt;next;\n\n    *indirect = entry-&gt;next;\n}\n\nint main(){\n\n    node_t n1, n2, n3;\n    \n    n1.data = 45;\n    n2.data = 8;\n    n3.data = 32;\n\n    head = &amp;n1; \n    n1.next = &amp;n2;\n    n2.next = &amp;n3;\n    n3.next = NULL;\n    \n    remove_list_entry_good(&amp;n2); /* instead : n1.next = &amp;n3; */\n\n    return 0;\n\n}\n</code></pre>\n<p>I decided for Integers as the data, for simplicity.\nThe typedef thingy is for being able to write node_t instead of struct node. Yes, in C, you'd have to write the struct word every time you're using the type node. If your even unfamiliar with pointers, consider this code written in Java, with references instead of pointers:</p>\n<pre><code>package linked;\nclass Node {\n    int data;\n    Node next;\n}\npublic class Test {\n    Node head;\n\n    /* bad code */\n    void remove_list_entry_bad(Node entry) {\n        Node prev = null;\n        Node walk = head;\n\n        while (walk != entry) {\n            prev = walk;\n            walk = walk.next;\n        }\n\n        if (prev == null)\n            head = entry.next;\n        else\n            prev.next = entry.next;\n    }\n\n    /* good code */\n    void remove_list_entry_good(Node entry) {\n        Node indirect = head;\n\n        //Node indirect = head;\n        while (indirect.next != entry)\n            indirect = indirect.next;\n\n        indirect.next = entry.next;\n    }\n\n    public static void main(String[] args) {\n\n        Node n1, n2, n3;\n        \n        n1 = new Node();\n        n2 = new Node();\n        n3 = new Node();\n\n        n1.data = 45;\n        n2.data = 8;\n        n3.data = 32;\n\n        Test list = new Test();\n        list.head = new Node();\n        list.head.next = n1;\n        n1.next = n2;\n        n2.next = n3;\n        n3.next = null;\n\n\n        list.remove_list_entry_good(n1);\n\n        Node walk = list.head.next;\n        while (walk != null) {\n            System.out.println(&quot;&quot; + walk.data);\n            walk = walk.next;\n        }\n\n    }\n}\n</code></pre>\n<p>The Node class uses a recursive definition, like methods that call themselves over and over. If you wonder, why the Node class is written inside the MyList class, this is called a private class.</p>\n<p><strong>Edit</strong>\nI have found something very interesting in C. The type of indirect must be node_t** with double stars. Don't know what that means, but it works.</p>\n<p><strong>Edit</strong>\nI found something on the web that works and is simple at the same time! <a href=\"https://www.dineshonjava.com/delete-given-node-from-singly-linked-list/\" rel=\"nofollow noreferrer\">https://www.dineshonjava.com/delete-given-node-from-singly-linked-list/</a></p>\n<pre><code>void remove_list_entry_good(Node entry) {\n    Node temp = entry.next; \n    entry.value = temp.value; \n    entry.next = temp.next; \n    temp = null; \n}\n</code></pre>\n"}], "owner": {"reputation": 1674, "user_id": 2726561, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8305eb6b7caf74b7d5e75989d8ec09fe?s=128&d=identicon&r=PG&f=1", "display_name": "Vovan", "link": "https://stackoverflow.com/users/2726561/vovan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 304, "favorite_count": 2, "closed_date": 1617553522, "answer_count": 2, "score": 1, "last_activity_date": 1617304942, "creation_date": 1562751896, "last_edit_date": 1562756534, "question_id": 56967927, "link": "https://stackoverflow.com/questions/56967927/remove-item-from-linked-list-in-a-good-way", "closed_reason": "Not suitable for this site", "title": "Remove item from linked list in a good way", "body": "<p>in <a href=\"https://www.ted.com/talks/linus_torvalds_the_mind_behind_linux/transcript\" rel=\"nofollow noreferrer\">this</a> TED talk Linus Torvalds showed \"poor\" and \"good\" programming tastes on example with removing item from linked list.</p>\n\n<p>So the poor taste example:</p>\n\n<p><a href=\"https://i.stack.imgur.com/pgZTo.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pgZTo.png\" alt=\"enter image description here\"></a></p>\n\n<p>And here goes the good taste:</p>\n\n<p><a href=\"https://i.stack.imgur.com/6RUWe.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6RUWe.png\" alt=\"enter image description here\"></a></p>\n\n<p>Main point here is last if statement in bad taste example.</p>\n\n<p>I am not a C/C++ developer and unfortunately for me i am thinking in \"bad\" taste.</p>\n\n<p>My question here: is this possible to write \"smart\" solution without using if statement for special case on a programming language without C-style pointers ?\nFor example on java or javascript.</p>\n"}, {"tags": ["c", "pointers", "memory-management", "struct", "memory-leaks"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1562752262, "post_id": 56967878, "comment_id": 100472855, "body": "You need to call <code>free</code> exactly as many times as you call <code>malloc</code>. It doesn&#39;t get much simpler than that."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 1, "creation_date": 1562752340, "post_id": 56967878, "comment_id": 100472897, "body": "Rule of thumb: allocate:top-to-bottom; free:bottom-to-top. And: you can create a function for every &quot;constructor&quot;/&quot;destructor&quot;."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 1, "creation_date": 1562756574, "post_id": 56967878, "comment_id": 100475171, "body": "The code in the previous question shows array members, such as <code>college *Colleges[MAX_COLLEGES];</code>, inside other structures. With array members, the members are part of the enclosing structure, and allocating memory in the enclosing structure allocates memory for its members. In this question, you might have changed those array members to be pointers, but you have not shown the code for that, so we are not sure."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1562756696, "post_id": 56967878, "comment_id": 100475227, "body": "Overall, it looks like you are thinking about memory allocation and layout in unclear ways. If a structure contains a pointer, that pointer is uninitialized until it is given a value. If you have structures containing pointers to structures that contain pointers to structures, then certainly you must initialize each and every pointer (and each and every object of any sort) before using it."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1562756771, "post_id": 56967878, "comment_id": 100475271, "body": "Generally, it is bad practice to allocate a constant number of items such as students for a college. Good practice is to adapt the size as need grows. Using constants for maximum numbers of colleges or students is something early programming students do. It is tolerable for getting started and novice level projects."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 1, "creation_date": 1562756866, "post_id": 56967878, "comment_id": 100475321, "body": "Re \u201cIt seems even if we allocate a certain amount of memory to a pointer, we still can&#39;t prevent segfault\u201d and \u201cSometimes, the compiler may throw an error but sometimes may not\u201d: Segmentation faults and errors are not random. If you handle memory correctly, they do not occur. You need to get your thinking about how memory is allocated and freed straight\u2014it is <b>your</b> job to write code that precisely allocates each piece of memory you want and that frees each piece of memory you no longer want."}, {"owner": {"reputation": 169, "user_id": 11247758, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-hG7wudQVdj4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfXqhECLCTahOEJxPH0f2SdKHIv6g/mo/photo.jpg?sz=128", "display_name": "Natarich J", "link": "https://stackoverflow.com/users/11247758/natarich-j"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1562778920, "post_id": 56967878, "comment_id": 100487523, "body": "@EricPostpischil Yeah. I ended up using just pointers to structures instead of an array of pointers (as shown in the <b>Definition:</b> part of the ticked answer), cuz the guy who gave the answer to my previous question said there was no need of an array of pointers (I&#39;m convinced). The definitions of structures used in this question are exactly as shwon in <b>Definition</b> in the answer to my previous question \u2014 structA has a pointer (that is allocated some amount of memory) to structB as one of its properties (could have more props); each structB has a pointer (allocated some memory) to structC."}, {"owner": {"reputation": 169, "user_id": 11247758, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-hG7wudQVdj4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfXqhECLCTahOEJxPH0f2SdKHIv6g/mo/photo.jpg?sz=128", "display_name": "Natarich J", "link": "https://stackoverflow.com/users/11247758/natarich-j"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1562779380, "post_id": 56967878, "comment_id": 100487747, "body": "@EricPostpischil Your second response is helpful. When a pointer to structures is malloc&#39;ed, is it then considered initialized? I think yes. Though, we don&#39;t know what address it points to. But say if there&#39;s a <code>char* str</code> in a struct, after allocating some memory to <code>str</code>, it also points to an address that we don&#39;t know. So, is this string considered initialized simply after malloc&#39;ing? Or we still need to write <code>str = &#39;&#39;</code> after malloc&#39;ing, as the string&#39;s initialization?"}, {"owner": {"reputation": 169, "user_id": 11247758, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-hG7wudQVdj4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfXqhECLCTahOEJxPH0f2SdKHIv6g/mo/photo.jpg?sz=128", "display_name": "Natarich J", "link": "https://stackoverflow.com/users/11247758/natarich-j"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1562779670, "post_id": 56967878, "comment_id": 100487881, "body": "@EricPostpischil Got your third and fourth points. To clarify your third point, do you mean we usally use <code>realloc()</code> to deal with dynamic memory allocation rather than a fixed <code>MAX_NUM</code>?"}, {"owner": {"reputation": 169, "user_id": 11247758, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-hG7wudQVdj4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfXqhECLCTahOEJxPH0f2SdKHIv6g/mo/photo.jpg?sz=128", "display_name": "Natarich J", "link": "https://stackoverflow.com/users/11247758/natarich-j"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1562779804, "post_id": 56967878, "comment_id": 100487934, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/196274/discussion-between-spitty-dog-and-eric-postpischil\">continue this discussion in chat</a>."}], "owner": {"reputation": 169, "user_id": 11247758, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-hG7wudQVdj4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfXqhECLCTahOEJxPH0f2SdKHIv6g/mo/photo.jpg?sz=128", "display_name": "Natarich J", "link": "https://stackoverflow.com/users/11247758/natarich-j"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 222, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1562751771, "creation_date": 1562751771, "question_id": 56967878, "link": "https://stackoverflow.com/questions/56967878/how-is-memory-allocated-to-multi-nested-structs-in-c", "title": "How is memory allocated to multi-nested structs in C?", "body": "<p>A couple of days ago, I asked this <a href=\"https://stackoverflow.com/questions/56898313/how-to-correctly-and-safely-free-all-memory-used-a-nested-struct-in-c\">question</a>. I duplicated 90% of the code given in the answer to my previous question. However, when I used Valgrind to do memcheck, it told me that there were memory leaks. But I don't think it was that 10% difference that caused the memory leaks. In addition to the memory leak issue, I have a couple of other questions.</p>\n\n<p>A brief summary of my previous post:\nI have a multi-nested struct. I need to correctly allocate memory to it and free the memory later on. The structure of the entire struct should look like this:</p>\n\n<pre><code>                          College Sys\n           |           |           |      ...      |\n        ColleA       ColleB      ColleC   ...     ColleX\n    |  |  |  |    |  |  |  |   |  |  |  |  ...  |  |  |  |\n   sA sB sC  sD  sA sB sC  sD sA sB sC  sD ... sA sB sC  sD\n    |  |  |  |    |  |  |  |   |  |  |  |  ...  |  |  |  | \n   fam fam ...\n// Colle is short for college\n// s is short for stu (which is short for student)\n</code></pre>\n\n<p>There could be arbitrary number of colleges and students, which is controllable by <code>#define MAX_NUM _num_</code>.\n<hr/>\nAs per the previous answer, I should allocate memory in the order of \"outermost to innermost\" and free the memory \"innermost to outermost\". I basically understand the logic behind the pattern. The following questions are extensions to it.</p>\n\n<p>1) Does </p>\n\n<pre><code>CollegeSys -&gt; Colle = malloc(sizeof(*(CollegeSys -&gt; Colle)) * MAX_NUM);\nCollegeSys -&gt; Colle -&gt; stu = malloc(sizeof(*(CollegeSys -&gt; Colle -&gt; stu)) * MAX_NUM);\nCollegeSys -&gt; Colle -&gt; stu -&gt; fam = malloc(sizeof(*(CollegeSys -&gt; Colle -&gt; stu -&gt; fam)));\n</code></pre>\n\n<p>mean \" there are <code>MAX_NUM</code> colleges under the college system, each of which has <code>MAX_NUM</code> students \u2014 each of which has one family\"? </p>\n\n<p>1.a)If yes, do I still need <strong>for loops</strong> to initialize every single value contained in this huge struct? \nFor example, the possibly correct way:</p>\n\n<pre><code>for (int i = 0; i &lt; MAX_NUM; i++) {\n    strcpy(CollegeSys -&gt; Colle[i].name, \"collestr\");\n    for (int n = 0; n &lt; MAX_NUM; n++) {\n        strcpy(system -&gt; Colle[i].stu[n].name, \"stustr\");\n        ...\n    }\n}\n</code></pre>\n\n<p>the possibly incorrect way:</p>\n\n<pre><code>strcpy(CollegeSys -&gt; Colle -&gt; name, \"collestr\");\nstrcpy(CollegeSys -&gt; Colle -&gt; stu -&gt; name, \"stustr\");\n</code></pre>\n\n<p>I tried the \"possibly incorrect way\". There was no syntax error, but it would only initialize <code>CollegeSys -&gt; Colle[0].name</code> and <code>... -&gt; stu[0].name</code>. So, the second approach is very likely to be incorrect if I want to initialize every single attribute.</p>\n\n<p>2) If I modularize this whole process, separating the process into several functions that return corresponding struct pointers \u2014 <code>newSystem(void)</code>, <code>newCollege(void)</code>, <code>newStudent(void)</code> (arguments might not necessarily be void; we might also pass a <code>str</code> as the <code>name</code> to the functions; besides, there might be a series of <code>addStu()</code>, etc... to assign those returned pointers to the corresponding part of <code>CollegeSys</code>). When I create a new CollegeSys in <code>newSystem()</code>, is it correct to malloc memory to every nested struct once and for all within <code>newSystem()</code>?</p>\n\n<p>2.a) If I allocate memory to all parts of the struct in <code>newSystem()</code>, the possible consequence I can think of so far is there would be memory leaks. Since we've allocated memory to all parts when creating the system, we inevitably have to create a new struct pointer and allocate adequate memory to it in the other two functions too. For instance,</p>\n\n<pre><code>struct Student* newStudent(void) {\n   struct Student* newStu = malloc(sizeof(struct Student));\n   newStu -&gt; fam = malloc(sizeof(*(newStu -&gt; fam)));\n   // I'm not sure if I'm supposed to also allocate memoty to fam struct\n   ...\n   return newStu;\n}\n</code></pre>\n\n<p>If so, we actually allocate the same amount of memory to an instance at least twice \u2014 one in the <code>newSystem(void)</code>, the other in <code>newStudent(void)</code>. If I'm correct so far, this is definitely memory leak. And the memory we allocate to the pointer <code>newStu</code> in <code>newStudent(void)</code> can never be freed (I think so). Then, what is the correct way to allocate memory to the whole structure when we separate the whole memory allocation process into several small steps? </p>\n\n<p>3) Do we have to use <code>sizeof(*(layer1 -&gt; layer2 -&gt; ...))</code> when malloc'ing memory to a struct nested in a struct? Can we directly specify the type of it? For example, doing this</p>\n\n<pre><code>CollegeSys -&gt; Colle = malloc(sizeof(struct College) * MAX_NUM);\n// instead of \n// CollegeSys -&gt; Colle = malloc(sizeof(*(CollegeSys -&gt; Colle)) * MAX_NUM);\n</code></pre>\n\n<p>4) It seems even if we allocate a certain amount of memory to a pointer, we still can't prevent segfault. For example, we code</p>\n\n<pre><code>// this is not completely correct C code, just to show what I mean\nstruct* ptr = malloc(sizeof(struct type) * 3);\n</code></pre>\n\n<p>We still could call <code>ptr[3]</code>, <code>ptr[4]</code> and so on, and the compiler will print out nonsense. Sometimes, the compiler may throw an error but sometimes may not. So, essentially, we can't rely on <code>malloc</code> (or <code>calloc</code> and so forth) to avoid the appearance of segfault?</p>\n\n<p>I'm sorry about writing such a long text. Thanks for your patience.</p>\n"}, {"tags": ["c", "xml", "xml-parsing", "libxml2", "xml-encoding"], "comments": [{"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 1, "creation_date": 1562759432, "post_id": 56967822, "comment_id": 100476682, "body": "Can you give any more details?  Which characters are we talking about?  How do they appear in the XML file?  How are they being misdisplayed?  Which software is misdisplaying them?  What OS is this running under, and with what display environment?  If under Unix or Linux, what are your locale settings?"}, {"owner": {"reputation": 53, "user_id": 11095648, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f53238cd173b2ee315ab9e78fdd1ceb9?s=128&d=identicon&r=PG&f=1", "display_name": "Jam12345", "link": "https://stackoverflow.com/users/11095648/jam12345"}, "reply_to_user": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1562760343, "post_id": 56967822, "comment_id": 100477201, "body": "@SteveSummit characters like &#39;&#225;&#233;&#237;&#243;&#250;&#241;&#252;&#39; they are displayed with another in correct capitalised spanish character (not correct), I&#39;m using a linux OS"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1562769106, "post_id": 56967822, "comment_id": 100482242, "body": "One possibility is that the environment variables <code>LANG</code> or <code>LC_ALL</code> need to be set correctly, probably to a UTF-8 variant, possibly to an es_ variant.  Running the <code>locale</code> command at the command prompt might tell you something, too."}, {"owner": {"reputation": 53, "user_id": 11095648, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f53238cd173b2ee315ab9e78fdd1ceb9?s=128&d=identicon&r=PG&f=1", "display_name": "Jam12345", "link": "https://stackoverflow.com/users/11095648/jam12345"}, "reply_to_user": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1562769874, "post_id": 56967822, "comment_id": 100482709, "body": "@SteveSummit what would u suggest LC_ALL to be set to? The rest of these varaibles are set to &quot;en_GB.UTF-8&quot;"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1562772068, "post_id": 56967822, "comment_id": 100483981, "body": "If the rest are all set to something with UTF-8 in them then LC_ALL is not needed, and this is probably not your problem after all.  Sorry for the false alarm."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1562772124, "post_id": 56967822, "comment_id": 100484017, "body": "We&#39;re probably going to need to see some sample input and output, and probably some code."}, {"owner": {"reputation": 53, "user_id": 11095648, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f53238cd173b2ee315ab9e78fdd1ceb9?s=128&d=identicon&r=PG&f=1", "display_name": "Jam12345", "link": "https://stackoverflow.com/users/11095648/jam12345"}, "reply_to_user": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1562772161, "post_id": 56967822, "comment_id": 100484036, "body": "@SteveSummit no worries give me a couple mins"}], "owner": {"reputation": 53, "user_id": 11095648, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f53238cd173b2ee315ab9e78fdd1ceb9?s=128&d=identicon&r=PG&f=1", "display_name": "Jam12345", "link": "https://stackoverflow.com/users/11095648/jam12345"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1562772795, "creation_date": 1562751548, "last_edit_date": 1562772795, "question_id": 56967822, "link": "https://stackoverflow.com/questions/56967822/xmltv-spanish-characters-not-appearing-correctly", "title": "XMLTV spanish characters not appearing correctly", "body": "<p>I have been working with XMLTV and I have found that Spanish characters are not appearing in the EPG correctly, I believe this will be an issue with the xml encoding but I have tested this with both:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"ISO-8859-1\"?&gt;\n&lt;?xml version=\"1.0\" encoding=\"UTF-8\" ?&gt;\n</code></pre>\n\n<p>And I am still having issues with Spanish characters, any suggestions?</p>\n\n<p>Update:</p>\n\n<p>I am reading in an xml file and converting it to XMLTV, everything works correctly as expected apart from the spanish characters.</p>\n\n<pre><code>void parseStory( xmlDocPtr doc, xmlNodePtr cur, char szFilename[256] ) {\n\ntvNode        = xmlNewTextChild( cur, NULL, \"tv\", NULL);\nchannelNode   = xmlNewTextChild( tvNode, NULL, \"channel\", NULL );\nprogTitle = xmlNewTextChild( programmeNode, NULL, \"title\", title );\nxmlNewProp( progTitle, \"lang\", \"es\" );\n\ndisplayName = xmlNewTextChild( channelNode, NULL, \"display-name\", key );\nxmlNewProp( channelNode, \"id\", key );\nxmlFree( key );\n\nxmlDocSetRootElement( doc, tvNode );\n\n//Saving (overwriting) file after changes\n//xmlSaveFormatFile( (const xmlChar *) szFilename, doc, 1 );\nint count;\ncount = xmlSaveFormatFileEnc( (const xmlChar *) szFilename, doc, \"UTF-8\", 1 );\nsyslog( LOG_INFO, \"File: %s\", szFilename );\nsyslog( LOG_INFO, \"Count: %d\", count );\n\n}\n</code></pre>\n\n<p>This is just a snippet and won't make perfect sense without all but the areas I think affect the spanish characters are the lang props and xmlSaveFormatFileEnc()</p>\n"}, {"tags": ["c++", "c", "libqmi"], "comments": [{"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "edited": false, "score": 3, "creation_date": 1562752002, "post_id": 56967760, "comment_id": 100472715, "body": "Post the exact error message."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1562808475, "post_id": 56967760, "comment_id": 100496740, "body": "Please post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> so we can reproduce the problem and help you debug it."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1562808532, "post_id": 56967760, "comment_id": 100496745, "body": "<code>C</code> and <code>C++</code> are two different languages.  Please pick one"}, {"owner": {"reputation": 21, "user_id": 11764088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bafc5f920681ca99792b55965426f169?s=128&d=identicon&r=PG&f=1", "display_name": "PPawe\u0142", "link": "https://stackoverflow.com/users/11764088/ppawe%c5%82"}, "edited": false, "score": 0, "creation_date": 1562841050, "post_id": 56967760, "comment_id": 100508814, "body": "Exact error message is:     /tmp/ccdei99o.o: In function <code>main&#39;:     whatever.c:(.text+0x17): undefined reference to </code>g_file_new_for_path&#39;     whatever.c:(.text+0x3f): undefined reference to `g_object_unref&#39;     collect2: error: ld returned 1 exit status  And yes, C and C++ are different languages. This code can be compiled by both of them and as a final target it&#39;d be C++."}], "answers": [{"tags": [], "owner": {"reputation": 520, "user_id": 2538048, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RoGbp.png?s=128&g=1", "display_name": "Aleksander", "link": "https://stackoverflow.com/users/2538048/aleksander"}, "is_accepted": false, "score": 0, "last_activity_date": 1582103559, "creation_date": 1582103559, "answer_id": 60296629, "question_id": 56967760, "link": "https://stackoverflow.com/questions/56967760/how-should-the-libqmi-be-linked/60296629#60296629", "title": "How should the libqmi be linked?", "body": "<p>You're missing the link to <code>libgobject-2</code> and <code>libgio-2</code>.</p>\n\n<p>Anyway, the best way to compile a program using libqmi is to use pkg-config as that knows all the cflags and ldflags you should be using; e.g. you could probably do this, assuming you installed libqmi in /usr/local:</p>\n\n<pre><code>PKG_CONFIG_PATH=/usr/local/lib/pkgconfig gcc $(pkg-config --cflags qmi-glib) whatever.c $(pkg-config --libs qmi-glib)\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 11764088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bafc5f920681ca99792b55965426f169?s=128&d=identicon&r=PG&f=1", "display_name": "PPawe\u0142", "link": "https://stackoverflow.com/users/11764088/ppawe%c5%82"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 203, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1582103559, "creation_date": 1562751352, "last_edit_date": 1562751991, "question_id": 56967760, "link": "https://stackoverflow.com/questions/56967760/how-should-the-libqmi-be-linked", "title": "How should the libqmi be linked?", "body": "<p>I've tried to use libqmi but I can't get through the linker. It keeps saying \"undefined reference\" on libqmi functions. Any suggestions what is needed?</p>\n\n<p>Paths and libraries are available for gcc, the symbols are inside libqmi-glib, looks like everything is in place. </p>\n\n<p>The code is the simplest possible, I think. </p>\n\n<pre><code>int main(int argc, char **argv)\n{\n    GFile *qmi = g_file_new_for_path(\"/dev/cdc-wdm0\");\n    printf(\"%li\\r\\n\", (long int)(qmi));\n    g_object_unref(qmi);\n    return 0;\n}\n</code></pre>\n\n<p>And the build goes like this:</p>\n\n<pre><code>gcc -I/usr/local/include/libqmi-glib/ -I/usr/include/glib-2.0/ -I/usr/lib/x86_64-linux-gnu/glib-2.0/include/ whatever.c -L/usr/local/lib/ -L/usr/lib/x86_64-linux-gnu/ -lqmi-glib -lglib-2.0\n</code></pre>\n"}, {"tags": ["c", "openssl", "macros"], "comments": [{"owner": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "edited": false, "score": 0, "creation_date": 1562748702, "post_id": 56966677, "comment_id": 100470717, "body": "can you show the code for <code>SSL_R_APPLICATION_DATA_AFTER_CLOSE_NOTIFY</code> macro. You said it is an integer and also a string."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 1, "creation_date": 1562748808, "post_id": 56966677, "comment_id": 100470777, "body": "If an API function expects an integer, why do you think you can pass a string? And why would you want to do this it in the first place?"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1562749027, "post_id": 56966677, "comment_id": 100470920, "body": "&quot;why this string is not getting expanded to an integer&quot; How should this happen? IStrings are never &quot;expanded&quot; automatically. Macros are replaced by preprocessor, strings aren&#39;t."}, {"owner": {"reputation": 203, "user_id": 8758528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c5rcJ.jpg?s=128&g=1", "display_name": "VVish", "link": "https://stackoverflow.com/users/8758528/vvish"}, "reply_to_user": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1562749057, "post_id": 56966677, "comment_id": 100470945, "body": "@Gerhardh ... As I mentioned I am implementing a error handler for my application and to see that it can handle all the errors first I need to produce them...there are over 200 errors in openssl and each is defined with the macros as mentioned in the question"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1562749130, "post_id": 56966677, "comment_id": 100470979, "body": "I do not see how this might make any sense. Maybe you could provide some code how you intent to call the function and combine with your array of strings."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1562749300, "post_id": 56966677, "comment_id": 100471086, "body": "Update the answer with the exact error message copied from your terminal."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 2, "creation_date": 1562749804, "post_id": 56966677, "comment_id": 100471406, "body": "<i>&quot;Now as I am giving input as a string(passing the integer input to the error array and obtaining the name) that has the same name as SSL_R_APPLICATION_DATA_AFTER_CLOSE_NOTIFY.&quot;</i> - Show the code"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1562749885, "post_id": 56966677, "comment_id": 100471448, "body": "Implementing an error handler is no reason to pass strings. You can use your array of strings to create some output but then pass the real value (=integer) to openssl. If there are 200 errors defined, how would using strings reduce the effort?"}], "answers": [{"comments": [{"owner": {"reputation": 203, "user_id": 8758528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c5rcJ.jpg?s=128&g=1", "display_name": "VVish", "link": "https://stackoverflow.com/users/8758528/vvish"}, "edited": false, "score": 1, "creation_date": 1562750212, "post_id": 56967181, "comment_id": 100471649, "body": "I was implementing it the first way char err[256] = &quot;SSL_R_APPLICATION_DATA_AFTER_CLOSE_NOTIFY &quot;....That&#39;s what I was doing wrong..I should have created an array of macros(as you mentioned) rather than an array containing the names of the errors in string format. Thanks"}], "tags": [], "owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "is_accepted": true, "score": 2, "last_activity_date": 1562749434, "creation_date": 1562749434, "answer_id": 56967181, "question_id": 56966677, "link": "https://stackoverflow.com/questions/56966677/how-to-pass-a-string-as-an-argument-when-the-function-has-integer-as-parameter/56967181#56967181", "title": "How to pass a string as an argument when the function has integer as parameter?", "body": "<blockquote>\n  <p>I have created a character array containing the name of all the errors.</p>\n</blockquote>\n\n<p>Did you mean this?</p>\n\n<pre><code>  char err[256] = \"SSL_R_APPLICATION_DATA_AFTER_CLOSE_NOTIFY \"\n                  \"SSL_R_APP_DATA_IN_HANDSHAKE \"\n                  \"SSL_R_ATTEMPT_TO_REUSE_SESSION_IN_DIFFERENT_CONTEXT\"\n                  \"SSL_R_AT_LEAST_TLS_1_0_NEEDED_IN_FIPS_MODE\"\n                  \"SSL_R_AT_LEAST_TLS_1_2_NEEDED_IN_SUITEB_MODE\"\n                  \"SSL_R_BAD_CHANGE_CIPHER_SPEC\"\n                  \"SSL_R_BAD_CIPHER\"\n                  \"SSL_R_BAD_DATA\";\n</code></pre>\n\n<p>or this?</p>\n\n<pre><code>  char err[256] = {SSL_R_APPLICATION_DATA_AFTER_CLOSE_NOTIFY,\n                  SSL_R_APP_DATA_IN_HANDSHAKE,\n                  SSL_R_ATTEMPT_TO_REUSE_SESSION_IN_DIFFERENT_CONTEXT,\n                  SSL_R_AT_LEAST_TLS_1_0_NEEDED_IN_FIPS_MODE,\n                  SSL_R_AT_LEAST_TLS_1_2_NEEDED_IN_SUITEB_MODE,\n                  SSL_R_BAD_CHANGE_CIPHER_SPEC,\n                  SSL_R_BAD_CIPHER,\n                  SSL_R_BAD_DATA\n                  };\n</code></pre>\n\n<p>In both the case below call will not work.</p>\n\n<pre><code>ERR_put_error(ERR_LIB_SSL,\n              SSL_F_SSL3_GET_RECORD,\n              err,\n              OPENSSL_FILE,\n              OPENSSL_LINE);\n</code></pre>\n\n<p>since <code>err</code> is of type <code>char *</code> but function accepts <code>int</code>.</p>\n\n<hr>\n\n<p>You can try defining as below and call the function in loop.</p>\n\n<pre><code>   int err[8] = {SSL_R_APPLICATION_DATA_AFTER_CLOSE_NOTIFY,\n                  SSL_R_APP_DATA_IN_HANDSHAKE,\n                  SSL_R_ATTEMPT_TO_REUSE_SESSION_IN_DIFFERENT_CONTEXT,\n                  SSL_R_AT_LEAST_TLS_1_0_NEEDED_IN_FIPS_MODE,\n                  SSL_R_AT_LEAST_TLS_1_2_NEEDED_IN_SUITEB_MODE,\n                  SSL_R_BAD_CHANGE_CIPHER_SPEC,\n                  SSL_R_BAD_CIPHER,\n                  SSL_R_BAD_DATA\n                  };\n\n    for (int i = 0; i&lt; 8; i++) {\n         ERR_put_error(ERR_LIB_SSL,\n                    SSL_F_SSL3_GET_RECORD,\n                    err[i],\n                    OPENSSL_FILE,\n                    OPENSSL_LINE);\n    }\n</code></pre>\n"}], "owner": {"reputation": 203, "user_id": 8758528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c5rcJ.jpg?s=128&g=1", "display_name": "VVish", "link": "https://stackoverflow.com/users/8758528/vvish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 448, "favorite_count": 0, "accepted_answer_id": 56967181, "answer_count": 1, "score": -1, "last_activity_date": 1562749434, "creation_date": 1562747885, "last_edit_date": 1562749188, "question_id": 56966677, "link": "https://stackoverflow.com/questions/56966677/how-to-pass-a-string-as-an-argument-when-the-function-has-integer-as-parameter", "title": "How to pass a string as an argument when the function has integer as parameter?", "body": "<p>I am trying to implement error handling for OpenSSL, to generate an error in OpenSSL I looked into a function ERR_put_error which puts the error specified in the arguments in the error queue of the thread. This function has a definition of:</p>\n\n<pre><code> void ERR_put_error(int lib, int func, int reason, const char *file, int line);\n</code></pre>\n\n<p>As you can see it accepts func as an integer argument. But we call this function as :</p>\n\n<pre><code>ERR_put_error(ERR_LIB_SSL,\n              SSL_F_SSL3_GET_RECORD,\n              SSL_R_APPLICATION_DATA_AFTER_CLOSE_NOTIFY,\n              OPENSSL_FILE,\n              OPENSSL_LINE);\n</code></pre>\n\n<p>SSL_R_APPLICATION_DATA_AFTER_CLOSE_NOTIFY is defined in openssl code at include/openssl/sslerr.h and it looks like this:</p>\n\n<p><code>#define SSL_R_APPLICATION_DATA_AFTER_CLOSE_NOTIFY        291</code></p>\n\n<p>This is because SSL_R_APPLICATION_DATA_AFTER_CLOSE_NOTIFY is a macro which corresponds to an integer. I have created a character array containing the name of all the errors. Now as I am giving input as a string(passing the integer input to the error array and obtaining the name) that has the same name as SSL_R_APPLICATION_DATA_AFTER_CLOSE_NOTIFY. </p>\n\n<p>When I pass it to this function it throws an error as it expects an integer but argument is of type char *. So my question is why this string is not getting expanded to an integer? Also, how can I implement this by taking input as a string?</p>\n"}, {"tags": ["c", "algorithm", "binary-search", "standard-library"], "comments": [{"owner": {"reputation": 28131, "user_id": 1956010, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bfdcb4596e9da98cccbf9a0069fdff6c?s=128&d=identicon&r=PG", "display_name": "nwellnhof", "link": "https://stackoverflow.com/users/1956010/nwellnhof"}, "edited": false, "score": 0, "creation_date": 1562749271, "post_id": 56966432, "comment_id": 100471055, "body": "C doesn&#39;t have methods, only functions."}, {"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "reply_to_user": {"reputation": 28131, "user_id": 1956010, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bfdcb4596e9da98cccbf9a0069fdff6c?s=128&d=identicon&r=PG", "display_name": "nwellnhof", "link": "https://stackoverflow.com/users/1956010/nwellnhof"}, "edited": false, "score": 2, "creation_date": 1562749573, "post_id": 56966432, "comment_id": 100471261, "body": "I always thought that these two are synonymous, similarly to parameters and arguments.."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 1, "creation_date": 1562751715, "post_id": 56966432, "comment_id": 100472564, "body": "<code>man -k search</code> yields bsearch. (and many more)"}, {"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "reply_to_user": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1562754782, "post_id": 56966432, "comment_id": 100474238, "body": "@wildplasser I didn&#39;t know that flag, nice! I surfed the Internet and couldn&#39;t find an answer, thus my question - sorry if it appears silly! Lesson to be learned: sometimes the traditional methods work better \ud83d\ude09"}, {"owner": {"reputation": 121669, "user_id": 56778, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/34b152ef95a49568ce45df38cd87e54b?s=128&d=identicon&r=PG", "display_name": "Jim Mischel", "link": "https://stackoverflow.com/users/56778/jim-mischel"}, "edited": false, "score": 0, "creation_date": 1562766065, "post_id": 56966432, "comment_id": 100480374, "body": "A Google search for [c binary search function] reveals <a href=\"https://stackoverflow.com/questions/47320667/built-in-function-for-searching-sorted-array-in-c\" title=\"built in function for searching sorted array in c\">stackoverflow.com/questions/47320667/&hellip;</a> on the first page of results."}, {"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "reply_to_user": {"reputation": 121669, "user_id": 56778, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/34b152ef95a49568ce45df38cd87e54b?s=128&d=identicon&r=PG", "display_name": "Jim Mischel", "link": "https://stackoverflow.com/users/56778/jim-mischel"}, "edited": false, "score": 0, "creation_date": 1562770775, "post_id": 56966432, "comment_id": 100483215, "body": "I didn&#39;t use these search terms, so not for me @JimMischel. It could also be because I searched from a PC I had never used before, I don&#39;t know."}], "answers": [{"comments": [{"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "edited": false, "score": 2, "creation_date": 1562747399, "post_id": 56966478, "comment_id": 100469966, "body": "I used Yahoo, Google and Stack overflow search, and yet couldn&#39;t find it-awesome answer! I really hope that this post will help others, upvote it if you agree!"}, {"owner": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "edited": false, "score": 0, "creation_date": 1562747505, "post_id": 56966478, "comment_id": 100470015, "body": "This function finds the occurrence of <code>key</code> in the array. Is there any way to find the first element less than <code>key</code> and/or the first element greater than <code>key</code>?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "edited": false, "score": 0, "creation_date": 1562747953, "post_id": 56966478, "comment_id": 100470232, "body": "@RishikeshRaje not if <code>key</code> does not occur in the array. Otherwise, you can use the next element (if there is one, and if <code>key</code> is unique - which it must be anyway)."}, {"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1562748155, "post_id": 56966478, "comment_id": 100470355, "body": "@WeatherVane there can be duplicates of the <code>key</code> on the array, so I don&#39;t see what you mean by it must be unique anyway. Except if I am misreading your comment."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "edited": false, "score": 0, "creation_date": 1562748258, "post_id": 56966478, "comment_id": 100470416, "body": "@gsamaras I was going by the <a href=\"https://docs.microsoft.com/en-us/cpp/c-runtime-library/reference/bsearch?view=vs-2017\" rel=\"nofollow noreferrer\">Visual C page</a> which says <i>If the array is not in ascending sort order or contains duplicate records with identical keys, the result is unpredictable.</i> What I meant was that if the key is not unique the next lower, or greater key might not be adjacent."}, {"owner": {"reputation": 3300, "user_id": 5166387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4c101d57cdeeeabd02376fb96951672?s=128&d=identicon&r=PG&f=1", "display_name": "AAA", "link": "https://stackoverflow.com/users/5166387/aaa"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1562748373, "post_id": 56966478, "comment_id": 100470496, "body": "@WeatherVane, @gsamaras, this is why the array should be sorted in ascending order. In this case, it returns a pointer to the <i>*first</i> element that matches <code>key</code>."}, {"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1562748385, "post_id": 56966478, "comment_id": 100470505, "body": "@WeatherVane if the array is not sorted, you cannot use binary search. If they are duplicates you can though. Is the reference of the Visual C applicable in standard C too? I hope not."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "edited": false, "score": 0, "creation_date": 1562748460, "post_id": 56966478, "comment_id": 100470542, "body": "@gsamaras I am not querying the need to be sorted - that is <b><i>obvious</i></b>. I only meant that if there are duplicate keys, the next lower value (or greater) might not be the adjacent element."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1562748687, "post_id": 56966478, "comment_id": 100470704, "body": "@AAA the page I linked says <i><code>bsearch</code> returns a pointer to <b>an</b> occurrence of <code>key</code>.</i> It does not say &quot;the first&quot; and a typical binary search won&#39;t always find the first occurrence if there are duplicate values."}, {"owner": {"reputation": 3300, "user_id": 5166387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4c101d57cdeeeabd02376fb96951672?s=128&d=identicon&r=PG&f=1", "display_name": "AAA", "link": "https://stackoverflow.com/users/5166387/aaa"}, "edited": false, "score": 0, "creation_date": 1562748734, "post_id": 56966478, "comment_id": 100470739, "body": "If you are searching for <code>key</code> and your array is sorted in ascending order, you get the first matching element. If <code>key</code> occurs, and you want to find the first element greater than <code>key</code>, a dirty solution would be to perform successive searches, each using the index returned by the previous search as a start point (<code>base</code>)."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1562748905, "post_id": 56966478, "comment_id": 100470835, "body": "@AA your <a href=\"http://www.cplusplus.com/reference/cstdlib/bsearch/\" rel=\"nofollow noreferrer\">link</a> likewise does not say &quot;the first&quot; but &quot;<b>a</b> matching element&quot;."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1562749044, "post_id": 56966478, "comment_id": 100470933, "body": "The array has to be sorted in ascending order, that too is obvious."}, {"owner": {"reputation": 2385, "user_id": 10306503, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31c5d6c9b08dd045f4876591d703bda6?s=128&d=identicon&r=PG", "display_name": "mosvy", "link": "https://stackoverflow.com/users/10306503/mosvy"}, "edited": false, "score": 0, "creation_date": 1562855787, "post_id": 56966478, "comment_id": 100517883, "body": "&quot;The type <code>size_t</code> is defined in <code>&lt;stdlib.h&gt;</code> as <code>unsigned int</code>&quot;. Maybe on your system. On mine it&#39;s defined as <b><code>long</code></b> <code>unsigned int</code> in <code>&lt;stddef.h&gt;</code> and is double the size of <code>unsigned int</code>."}, {"owner": {"reputation": 2385, "user_id": 10306503, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31c5d6c9b08dd045f4876591d703bda6?s=128&d=identicon&r=PG", "display_name": "mosvy", "link": "https://stackoverflow.com/users/10306503/mosvy"}, "edited": false, "score": 0, "creation_date": 1562857384, "post_id": 56966478, "comment_id": 100518869, "body": "The info from that link is outdated; in c99 and later <code>size_t</code> is required to be defined in <code>&lt;sttdef.h&gt;</code>, and on ~90% of systems in use now <code>size_t</code> is 64bit and <code>unsigned int</code> is 32bit."}], "tags": [], "owner": {"reputation": 3300, "user_id": 5166387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4c101d57cdeeeabd02376fb96951672?s=128&d=identicon&r=PG&f=1", "display_name": "AAA", "link": "https://stackoverflow.com/users/5166387/aaa"}, "is_accepted": true, "score": 16, "last_activity_date": 1562792858, "last_edit_date": 1562792858, "creation_date": 1562747214, "answer_id": 56966478, "question_id": 56966432, "link": "https://stackoverflow.com/questions/56966432/is-there-a-binary-search-method-in-the-c-standard-library/56966478#56966478", "title": "Is there a Binary Search method in the C standard library?", "body": "<p>There is the <code>bsearch()</code> method in the same <code>&lt;stdlib.h&gt;</code>, as is listed <a href=\"http://www.cplusplus.com/reference/cstdlib/bsearch/\" rel=\"nofollow noreferrer\">here</a>, <a href=\"https://www.tutorialspoint.com/c_standard_library/c_function_bsearch\" rel=\"nofollow noreferrer\">here</a> and <a href=\"https://en.wikibooks.org/wiki/C_Programming/stdlib.h\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>The <code>bsearch()</code> function uses the binary search algorithm to find an element that matches key in a sorted array of n elements of size size. (The type size_t is defined in <code>&lt;stdlib.h&gt;</code> as unsigned int.) The last argument, <code>compare</code>, gives <code>bsearch()</code> a pointer to a function that it calls to compare the search key with any array element. This function must return a value that indicates whether its first argument, the search key, is less than, equal to, or greater than its second argument, an array element to test..</p>\n\n<p>You should generally use <code>qsort()</code> before <code>bsearch()</code>, because the array <em>should</em> be <strong>sorted</strong> (should be in ascending order, ordered with the same criteria used by <code>compare</code>) before searching. This step is necessary because the binary search algorithm tests whether the search key is higher or lower than the middle element in the array, then eliminates half of the array, tests the middle of the result, eliminates half again, and so forth. If you define the comparison function for <code>bsearch()</code> with identical types for its two arguments, then <code>qsort()</code> can use the same comparison function.</p>\n\n<p>The <code>bsearch()</code> function returns a pointer to an array element found that matches the search key. If no matching element is found, <code>bsearch()</code> returns a null pointer.<sup><a href=\"https://www.oreilly.com/library/view/c-in-a/0596006977/re17.html\" rel=\"nofollow noreferrer\">[a]</a></sup></p>\n\n<p><strong>Example Use</strong>:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>/* bsearch example */\n#include &lt;stdio.h&gt;      /* printf */\n#include &lt;stdlib.h&gt;     /* qsort, bsearch, NULL */\n\nint compareints (const void * a, const void * b)\n{\n  return ( *(int*)a - *(int*)b );\n}\n\nint values[] = { 50, 20, 60, 40, 10, 30 };\n\nint main ()\n{\n  int * pItem;\n  int key = 40;\n  qsort (values, 6, sizeof (int), compareints);\n  pItem = (int*) bsearch (&amp;key, values, 6, sizeof (int), compareints);\n  if (pItem!=NULL)\n    printf (\"%d is in the array.\\n\",*pItem);\n  else\n    printf (\"%d is not in the array.\\n\",key);\n  return 0;\n}\n</code></pre>\n\n<p>Output:</p>\n\n<blockquote>\n  <p>40 is in the array.</p>\n</blockquote>\n\n<p><strong>In response to a comment below</strong> as to how to find the first element that is less/greater than <code>key</code>, here is a (<em>probably dirty</em>) workaround: you can iterate over the sorted array and compare its elements to <code>key</code> using the same <code>compare</code> function passed to this method, until you find an element less/greater than <code>key</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "edited": false, "score": 0, "creation_date": 1562825529, "post_id": 56978777, "comment_id": 100500551, "body": "Hi and thanks for upvoting my question! Are you sure about the duplicates issue? It would be nice to provide some reference. I couldn&#39;t find anything like this here <a href=\"http://www.cplusplus.com/reference/cstdlib/bsearch/\" rel=\"nofollow noreferrer\">cplusplus.com/reference/cstdlib/bsearch</a>"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "edited": false, "score": 0, "creation_date": 1563014506, "post_id": 56978777, "comment_id": 100567566, "body": "@gsamaras: I updated the question with the specification from the C Standard that is explicit about duplicates: <i>If two elements compare as equal, which element is matched is unspecified.</i>"}, {"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "edited": false, "score": 1, "creation_date": 1563019264, "post_id": 56978777, "comment_id": 100568641, "body": "You mean your answer:) Ah OK now I see what you mean, sure, I agree.. However, I had already upvoted your answer, so thanks again! :)"}], "tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 4, "last_activity_date": 1563014419, "last_edit_date": 1563014419, "creation_date": 1562793490, "answer_id": 56978777, "question_id": 56966432, "link": "https://stackoverflow.com/questions/56966432/is-there-a-binary-search-method-in-the-c-standard-library/56978777#56978777", "title": "Is there a Binary Search method in the C standard library?", "body": "<p>The C library has a standard function <code>bsearch</code>, declared in <code>&lt;stdlib.h&gt;</code>, for exactly this purpose: locate a matching entry in a table of entries sorted in ascending order according to a given comparison function. </p>\n\n<p>Here is the specification in the C Standard:</p>\n\n<blockquote>\n  <p><strong>7.22.5.1 The <code>bsearch</code> function</strong></p>\n  \n  <p><strong>Synopsis</strong></p>\n\n<pre><code>#include &lt;stdlib.h&gt;\nvoid *bsearch(const void *key, const void *base,\n              size_t nmemb, size_t size,\n              int (*compar)(const void *, const void *));\n</code></pre>\n  \n  <p><strong>Description</strong></p>\n  \n  <p>The <code>bsearch</code> function searches an array of <code>nmemb</code> objects, the initial element of which is pointed to by <code>base</code>, for an element that matches the object pointed to by <code>key</code>. The size of each element of the array is specified by <code>size</code>.</p>\n  \n  <p>The comparison function pointed to by <code>compar</code> is called with two arguments that point to the key object and to an array element, in that order. The function shall return an integer less than, equal to, or greater than zero if the key object is considered, respectively, to be less than, to match, or to be greater than the array element. The array shall consist of: all the elements that compare less than, all the elements that compare equal to, and all the elements that compare greater than the key object, in that order.<sup>308)</sup></p>\n  \n  <p><strong>Returns</strong></p>\n  \n  <p>The <code>bsearch</code> function returns a pointer to a matching element of the array, or a null pointer if no match is found. <em>If two elements compare as equal, which element is matched is unspecified.</em></p>\n  \n  <hr>\n  \n  <p><sub>308) In practice, the entire array is sorted according to the comparison function.</sub></p>\n</blockquote>\n\n<p>This function has 2 shortcomings:</p>\n\n<ul>\n<li>if the table contains duplicate matching entries, it is unspecified which entry will be returned, as emphasised in the last paragraph above.</li>\n<li>the function cannot be used to locate the position where to insert the entry if it is not found in the table, it just returns a null pointer.</li>\n</ul>\n\n<p>Here is a simple implementation that fixes the first point (it is coded to always return the matching entry closest to the beginning of the array) and can be modified to address the second:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdlib.h&gt;\n\nvoid *bsearch(const void *key, const void *base,\n              size_t nmemb, size_t size,\n              int (*compar)(const void *, const void *))\n{\n    const unsigned char *p;\n    size_t m;\n    int r;\n\n    while (nmemb &gt; 0) {\n        m = (nmemb - 1) &gt;&gt; 1;\n        p = (const unsigned char *)base + m * size;\n        if ((r = compar(key, p)) &lt; 0) {\n            nmemb = m;\n        } else\n        if (r &gt; 0) {\n            base = p + size;\n            nmemb -= m + 1;\n        } else\n        if (m == 0) {\n            return (void *)p;\n        } else {\n            /* continue search to return first matching entry */\n            nmemb = m + 1;\n        }\n    }\n    // if you want the insertion point, you can return p here\n    return NULL;\n}\n</code></pre>\n"}], "owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1988, "favorite_count": 0, "accepted_answer_id": 56966478, "answer_count": 2, "score": 7, "last_activity_date": 1563014419, "creation_date": 1562747058, "last_edit_date": 1562749009, "question_id": 56966432, "link": "https://stackoverflow.com/questions/56966432/is-there-a-binary-search-method-in-the-c-standard-library", "title": "Is there a Binary Search method in the C standard library?", "body": "<p>I cannot find any method implementing binary search. Is that because I failed to locate it, or is it because it doesn't exist?</p>\n\n<p><sub>I think the second, but I couldn't find a duplicate question, so maybe I am wrong.</sub></p>\n"}, {"tags": ["c", "sensors", "i2c", "mikroc", "dspic"], "comments": [{"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1562747062, "post_id": 56966348, "comment_id": 100469784, "body": "it may be stupid but have you included <code>math.h</code> ?"}, {"owner": {"reputation": 1, "user_id": 11763643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4e29296d0d85a4424d8cd5338ea9712?s=128&d=identicon&r=PG&f=1", "display_name": "SheldonNyce", "link": "https://stackoverflow.com/users/11763643/sheldonnyce"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1562783685, "post_id": 56966348, "comment_id": 100489611, "body": "Definitely not a stupid question. Yes I have included the math library in MikroC - thanks for the comment."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1562787639, "post_id": 56966348, "comment_id": 100491241, "body": "<code>FloatToStr(luminance, lux);</code> can you show us this code?"}, {"owner": {"reputation": 1, "user_id": 11763643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4e29296d0d85a4424d8cd5338ea9712?s=128&d=identicon&r=PG&f=1", "display_name": "SheldonNyce", "link": "https://stackoverflow.com/users/11763643/sheldonnyce"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1562912830, "post_id": 56966348, "comment_id": 100535650, "body": "I can&#39;t show you exactly what the code is, as it is part of the mikroC library &quot;Conversions Library&quot;, but I can tell you what the &quot;Help&quot; file says with regards to the function? Not sure if it will help at all, but:"}, {"owner": {"reputation": 1, "user_id": 11763643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4e29296d0d85a4424d8cd5338ea9712?s=128&d=identicon&r=PG&f=1", "display_name": "SheldonNyce", "link": "https://stackoverflow.com/users/11763643/sheldonnyce"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1562912938, "post_id": 56966348, "comment_id": 100535695, "body": "FloatToStr: Prototype -  unsigned char FloatToStr(float fnum, unsigned char*str);"}, {"owner": {"reputation": 1, "user_id": 11763643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4e29296d0d85a4424d8cd5338ea9712?s=128&d=identicon&r=PG&f=1", "display_name": "SheldonNyce", "link": "https://stackoverflow.com/users/11763643/sheldonnyce"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1562913005, "post_id": 56966348, "comment_id": 100535731, "body": "Description - Converts a floating point number to a string. The output string is left justified and null terminated after the last digit."}, {"owner": {"reputation": 1, "user_id": 11763643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4e29296d0d85a4424d8cd5338ea9712?s=128&d=identicon&r=PG&f=1", "display_name": "SheldonNyce", "link": "https://stackoverflow.com/users/11763643/sheldonnyce"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1562913081, "post_id": 56966348, "comment_id": 100535765, "body": "Parameters - fnum: floating point number to be converted, str: destination string"}, {"owner": {"reputation": 1, "user_id": 11763643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4e29296d0d85a4424d8cd5338ea9712?s=128&d=identicon&r=PG&f=1", "display_name": "SheldonNyce", "link": "https://stackoverflow.com/users/11763643/sheldonnyce"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1562913189, "post_id": 56966348, "comment_id": 100535815, "body": "Returns: 3 if the input number is NaN, 2 if the input number is -INF, 1 if the input number is +INF, 0 if the conversion was successful"}, {"owner": {"reputation": 1, "user_id": 11763643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4e29296d0d85a4424d8cd5338ea9712?s=128&d=identicon&r=PG&f=1", "display_name": "SheldonNyce", "link": "https://stackoverflow.com/users/11763643/sheldonnyce"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1562913225, "post_id": 56966348, "comment_id": 100535830, "body": "Requires - Destination string should be at least 14 characters in length"}, {"owner": {"reputation": 1, "user_id": 11763643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4e29296d0d85a4424d8cd5338ea9712?s=128&d=identicon&r=PG&f=1", "display_name": "SheldonNyce", "link": "https://stackoverflow.com/users/11763643/sheldonnyce"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1562913329, "post_id": 56966348, "comment_id": 100535871, "body": "Example:   float ff1 = -374.2; float ff2 = 123.45678; float ff3 = 0.000001234; char txt[15];"}, {"owner": {"reputation": 1, "user_id": 11763643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4e29296d0d85a4424d8cd5338ea9712?s=128&d=identicon&r=PG&f=1", "display_name": "SheldonNyce", "link": "https://stackoverflow.com/users/11763643/sheldonnyce"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1562913385, "post_id": 56966348, "comment_id": 100535893, "body": "FloatToStr(ff1, txt);      // txt is &quot;-374.2&quot;"}, {"owner": {"reputation": 1, "user_id": 11763643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4e29296d0d85a4424d8cd5338ea9712?s=128&d=identicon&r=PG&f=1", "display_name": "SheldonNyce", "link": "https://stackoverflow.com/users/11763643/sheldonnyce"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1562913443, "post_id": 56966348, "comment_id": 100535922, "body": "FloatToStr(ff2, txt);   // txt is &quot;123.4567&quot;"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1562913451, "post_id": 56966348, "comment_id": 100535924, "body": "please <a href=\"https://stackoverflow.com/posts/56966348/edit\">edit</a> your question instead of adding a million comments. It&#39;ll be much clearer."}, {"owner": {"reputation": 1, "user_id": 11763643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4e29296d0d85a4424d8cd5338ea9712?s=128&d=identicon&r=PG&f=1", "display_name": "SheldonNyce", "link": "https://stackoverflow.com/users/11763643/sheldonnyce"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1562913487, "post_id": 56966348, "comment_id": 100535942, "body": "FloatToStr(ff3, txt);    // txt is &quot;1.234e-6&quot;"}, {"owner": {"reputation": 1, "user_id": 11763643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4e29296d0d85a4424d8cd5338ea9712?s=128&d=identicon&r=PG&f=1", "display_name": "SheldonNyce", "link": "https://stackoverflow.com/users/11763643/sheldonnyce"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1562913557, "post_id": 56966348, "comment_id": 100535971, "body": "Sorry - It&#39;s done now though, that&#39;s what the help file says."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1562913572, "post_id": 56966348, "comment_id": 100535978, "body": "see my comment above :)"}], "owner": {"reputation": 1, "user_id": 11763643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4e29296d0d85a4424d8cd5338ea9712?s=128&d=identicon&r=PG&f=1", "display_name": "SheldonNyce", "link": "https://stackoverflow.com/users/11763643/sheldonnyce"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1562746737, "creation_date": 1562746737, "question_id": 56966348, "link": "https://stackoverflow.com/questions/56966348/have-you-ever-interfaced-a-max44009-sensor-with-a-uc", "title": "Have you ever interfaced a MAX44009 sensor with a uC?", "body": "<p>I recently tried to program, using the free download version of MikroC for dsPIC IDE, a MAX44009 sensor to interface with PIC24FJ64GB002 microcontroller. The lux result of the sensor should be displayed on an LCD. The code compiles without failure, but it's not working. When I view the SDA and SCL lines using an oscilloscope, they are always held high. But if I convert:</p>\n\n<p>float luminance --> int luminance</p>\n\n<p>and </p>\n\n<p>FloatToStr (luminance, lux) --> IntToString (luminance, lux)</p>\n\n<p>then the code is loaded onto the embedded device, and the oscilloscope shows that the I2C communication is taking place, but the value the LCD displays does not give any valuable data. The lux display is -17204 and it never changes. </p>\n\n<p>I tried to display \"exponent\" on the LCD and it displayed: -17204\nI tried to display \"mantissa\" on the LCD and it displayed: 255</p>\n\n<p>When I tried to debug the code, when luminence is declared as a float, I get an error: \"Simulation Error: PC out of scope [0x0011F0]\"\nWhen I change from float to int; I can debug the code, but the value output on the LCD is useless.</p>\n\n<pre><code>//LCD module connections\nsbit LCD_RS at LATB2_bit;\nsbit LCD_EN at LATB3_bit;\nsbit LCD_D4 at LATB5_bit;\nsbit LCD_D5 at LATB7_bit;\nsbit LCD_D6 at LATB13_bit;\nsbit LCD_D7 at LATB14_bit;\n\nsbit LCD_RS_Direction at TRISB2_bit;\nsbit LCD_EN_Direction at TRISB3_bit;\nsbit LCD_D4_Direction at TRISB5_bit;\nsbit LCD_D5_Direction at TRISB7_bit;\nsbit LCD_D6_Direction at TRISB13_bit;\nsbit LCD_D7_Direction at TRISB14_bit;\n//End LCD Module connections\n\n//Global Constants\nchar txt1[] = \"LUX:\";\nchar txt2[] = \"check\";\n//End Global Constants\n\n\n// Global var.\nunsigned int buff[2];\n//unsigned char b1Index;\nint mantissa;\nint exponent;\nfloat luminance;\nchar lux[16];\n//end of Global variable declaration\n\n//Function declaration\nvoid MAX44009_getvalue();\n//end of function declaration\n\nvoid main(){\nAD1PCFG = 0xffff;                        //Configure AN pins as digital \nI/O\nDelay_ms(500);\nI2C1_Init(100000);                       //Initialize I2C communication \non SDA1 and SCL1\nI2C1_Start();                  //Wake-up I2C components\nI2C1_Write(0x96);              //Address MAX44009 lux sensor \nspecifically, and prepare for write command\nI2C1_Write(0x02);              //Address specific register 02 (interupt \nregister) for MAX44009\nI2C1_Write(0x40);              //Continuous mode, 100ms integration time\nI2C1_Stop();                   //issue I2C stop signal\nDelay_ms(300);                 //Because Arduino said so....\n\nLcd_Init();                              //Initialize LCD\nLcd_Cmd(_LCD_CLEAR);                     //Clear LCD\nLcd_Cmd(_LCD_CURSOR_OFF);                //Cursor Off\n\n/*Delay_ms(1000);\nLcd_Out(2,1,txt2);\nDelay_ms(1000);*/\n\nwhile (1){\n    MAX44009_getvalue();\n    exponent = (buff[0] &amp; 0xF0) &gt;&gt; 4;\n    mantissa = ((buff[0] &amp; 0x0F ) &lt;&lt; 4) | (buff[1] &amp; 0x0F);\n    luminance = pow(2, exponent)*mantissa*0.045;\n\n    FloatToStr(luminance, lux);\n\n    Lcd_Out(1,1,txt1);\n    Lcd_Out(2,1,lux);\n    Delay_ms(500);\n}\n}\n\nvoid MAX44009_getvalue(){\n\nI2C1_Start();\nI2C1_Write(0x96);\nI2C1_Write(0x03);             //MAX44009 LUX High-Byte Register 0x03\nI2C1_Restart();\nI2C1_Write(0x97);\n\nbuff[0] = I2C1_Read(0);\n\nI2C1_Restart();\n\nI2C1_Write(0x96);\nI2C1_Write(0x04);              //MAX44009 LUX Low-Byte Register 0x04\nI2C1_Restart();\nI2C1_Write(0x97);\n\nbuff[1] = I2C1_Read(0);\n\nI2C1_Stop();\n}     \n</code></pre>\n\n<p>Expected Results: Working MAX44009 lux sensor code, displaying lux values on an LCD </p>\n\n<p>Simulation Error: PC out of scope [0x0011F0]</p>\n"}, {"tags": ["c", "winapi", "dll-injection"], "comments": [{"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 4, "creation_date": 1562746307, "post_id": 56966165, "comment_id": 100469394, "body": "This really feels like the wrong solution to the problem, no matter what the problem actually is!"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1562750027, "post_id": 56966165, "comment_id": 100471535, "body": "If you don&#39;t want people printing from <b>their</b> computers, don&#39;t give them applications to run there.  Because whatever you do, they can undo.  And you will have annoyed your customers along the way.  Because guess what?  If it displays on <b>their</b> screen, they can <b>always</b> print it."}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1562953249, "post_id": 56966165, "comment_id": 100556025, "body": "I&#39;ve rolled back your edit. If you want to add the solution you&#39;ve found, write it up in the form of an answer and post it in the space below intended for that purpose. See <a href=\"http://stackoverflow.com/help/self-answer\">Can I answer my own question?</a> for more information. It is not appropriate to edit the solution into the question itself."}], "answers": [{"comments": [{"owner": {"reputation": 1081, "user_id": 5532266, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ysTfd.gif?s=128&g=1", "display_name": "DevMJ", "link": "https://stackoverflow.com/users/5532266/devmj"}, "edited": false, "score": 0, "creation_date": 1562951790, "post_id": 56970730, "comment_id": 100555482, "body": "Windows application to block CTRL + P using WH_KEYBORAD_LL hook works. Updated solution in question. Thanks Castorix"}], "tags": [], "owner": {"reputation": 1239, "user_id": 4452971, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/og0oX.png?s=128&g=1", "display_name": "Castorix", "link": "https://stackoverflow.com/users/4452971/castorix"}, "is_accepted": false, "score": 1, "last_activity_date": 1562761717, "creation_date": 1562761717, "answer_id": 56970730, "question_id": 56966165, "link": "https://stackoverflow.com/questions/56966165/how-to-block-printing-functionalityctrl-p-on-windows-text-editors/56970730#56970730", "title": "How to block printing functionality(CTRL + P) on windows text editors?", "body": "<blockquote>\n  <p>I want to block printing functionality(CTRL + P) on windows platform\n  for specific applications. I am doing it using keyboard hook. I am\n  able to detect CTRL + P but I am not able to stop it.</p>\n</blockquote>\n\n<p>This blocks [Ctrl] + \"P\" in a <strong>WH_KEYBOARD_LL</strong> hook... but won't prevent printing by [File] [Print] or other way of course... =></p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>    LRESULT CALLBACK LowLevelKeyboardProc(int nCode, WPARAM wParam, LPARAM lParam)\n    {\n        DWORD dwKey = 0;\n        if (HC_ACTION == nCode)\n        {\n            KBDLLHOOKSTRUCT *pkbdll = (KBDLLHOOKSTRUCT*)lParam;\n            dwKey = pkbdll-&gt;vkCode;\n            BOOL bCtlDown = GetKeyState(VK_CONTROL) &lt; 0;\n            if (bCtlDown &amp;&amp; dwKey == 'P')\n            {           \n                Beep(6000, 10);\n                return 1;\n            }\n        }\n        return CallNextHookEx(hKeyboardHook, nCode, wParam, lParam);\n    }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1081, "user_id": 5532266, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ysTfd.gif?s=128&g=1", "display_name": "DevMJ", "link": "https://stackoverflow.com/users/5532266/devmj"}, "is_accepted": false, "score": 0, "last_activity_date": 1563165071, "creation_date": 1563165071, "answer_id": 57033274, "question_id": 56966165, "link": "https://stackoverflow.com/questions/56966165/how-to-block-printing-functionalityctrl-p-on-windows-text-editors/57033274#57033274", "title": "How to block printing functionality(CTRL + P) on windows text editors?", "body": "<p>Windows application to block CTRL + P using WH_KEYBORAD_LL hook works. So working code snippet will be as follows:</p>\n\n<pre><code>#include&lt;fstream&gt;\n#include&lt;windows.h&gt;\n\nusing namespace std;\n\nofstream out(\"logs.txt\", ios::out);\n\nLRESULT CALLBACK keyboardHookProc(int nCode, WPARAM wParam, LPARAM lParam)\n{\n    static bool controlPressed = false;\n    PKBDLLHOOKSTRUCT p = (PKBDLLHOOKSTRUCT)(lParam);\n\n    if (wParam == WM_KEYDOWN)\n    {\n        if (p-&gt;vkCode == VK_LCONTROL || p-&gt;vkCode == VK_RCONTROL)\n        {\n            controlPressed = true;\n        }\n        else if (char(tolower(p-&gt;vkCode)) == 'p' &amp;&amp; true == controlPressed)\n        {\n            out &lt;&lt; \"&lt;CONTROL + P Detected&gt;\";\n                return 1;\n        }\n        else\n        {\n            controlPressed = false;\n        }\n\n    }\n    return CallNextHookEx(NULL, nCode, wParam, lParam);\n}\n\nint APIENTRY wWinMain(_In_ HINSTANCE hInstance,\n    _In_opt_ HINSTANCE hPrevInstance,\n    _In_ LPWSTR    lpCmdLine,\n    _In_ int       nCmdShow)\n{\n    UNREFERENCED_PARAMETER(hPrevInstance);\n    UNREFERENCED_PARAMETER(lpCmdLine);\n\n    HHOOK keyboardHook = SetWindowsHookEx(WH_KEYBOARD_LL,\n        keyboardHookProc,\n        hInstance,\n        0\n    );\n\n    MessageBox(NULL, TEXT(\"Press OK to stop blocking of printing.\"), TEXT(\"Information\"), MB_OK);\n    out.close();\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 1081, "user_id": 5532266, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ysTfd.gif?s=128&g=1", "display_name": "DevMJ", "link": "https://stackoverflow.com/users/5532266/devmj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 163, "favorite_count": 1, "answer_count": 2, "score": 2, "last_activity_date": 1563165071, "creation_date": 1562746106, "last_edit_date": 1562953170, "question_id": 56966165, "link": "https://stackoverflow.com/questions/56966165/how-to-block-printing-functionalityctrl-p-on-windows-text-editors", "title": "How to block printing functionality(CTRL + P) on windows text editors?", "body": "<p>I want to block printing functionality(CTRL + P) on windows platform for specific applications. I am doing it using keyboard hook. I am able to detect CTRL + P but I am not able to stop it. I am returning from hook procedure in case of CTRL + P but application still receives this message and process printing.</p>\n\n<pre><code>LRESULT __declspec(dllexport)__stdcall  CALLBACK KeyboardProc(\n    int nCode,\n    WPARAM wParam,\n    LPARAM lParam)\n{\n    FILE* f1;\n    static WPARAM wPrevParam;\n\n    if (((DWORD)lParam &amp; 0x40000000) &amp;&amp; (HC_ACTION == nCode))\n    {\n        if ((wParam == VK_SPACE) || (wParam == VK_RETURN) || (wParam == VK_CONTROL) || (wParam &gt;= 0x2f) &amp;&amp; (wParam &lt;= 0x100))\n        {\n            char ch;\n            f1 = fopen(\"d:\\\\report.txt\", \"a+\");\n            if (wParam == VK_CONTROL)\n            {\n                if (wPrevParam == 0x50)// 0x50 = P\n                {\n                    const char* text = \"CTRL-P detected.\";\n                    fwrite(text, strlen(text), 1, f1);\n                    fclose(f1);\n                    wParam = 0;\n                    lParam = 0;\n                    return 1;\n                }\n\n                const char *text = \"CTRL\";\n                fwrite(text, strlen(text), 1, f1);\n                fprintf(f1, \"%02X\\n\", (unsigned char)wParam);\n            }\n            else\n            {\n                wPrevParam = wParam;\n            }\n\n            fclose(f1);\n        }\n\n    }\n\n    LRESULT RetVal = CallNextHookEx(hkb, nCode, wParam, lParam);\n\n    return  RetVal;\n\n}\n</code></pre>\n"}, {"tags": ["c", "string", "integer", "scanf"], "comments": [{"owner": {"reputation": 5813, "user_id": 1075282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70efe94a6c2237ec96f429402a03a27d?s=128&d=identicon&r=PG", "display_name": "Renat", "link": "https://stackoverflow.com/users/1075282/renat"}, "edited": false, "score": 0, "creation_date": 1562744710, "post_id": 56965717, "comment_id": 100468590, "body": "Looks like this is related <a href=\"https://stackoverflow.com/questions/15330047/understanding-scanf-dealing-with-formatted-input\" title=\"understanding scanf dealing with formatted input\">stackoverflow.com/questions/15330047/&hellip;</a>"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1562744725, "post_id": 56965717, "comment_id": 100468599, "body": "The <code>&quot;%s&quot;</code> format read <i>space-delimited</i> strings. You need to to some manual parsing. I recommend using <a href=\"https://en.cppreference.com/w/c/io/fgets\" rel=\"nofollow noreferrer\"><code>fgets</code></a> to read the line, and then e.g. <a href=\"https://en.cppreference.com/w/c/string/byte/strtok\" rel=\"nofollow noreferrer\"><code>strtok</code></a> for the parsing. Or you can learn about the <code>scanf</code> <code>&quot;%[&quot;</code> format specifier."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1562744803, "post_id": 56965717, "comment_id": 100468633, "body": "Please see <a href=\"http://stackoverflow.com/questions/5431941/why-is-while-feof-file-always-wrong\">Why is <code>while ( !feof (file) )</code> always wrong?</a> Use the return value from <code>fscanf</code> or <code>fgets</code> to drive the loop. Also as the last comment: if you use <code>%s</code> then you won&#39;t read a country name of two words such as <code>New Zealand</code>."}, {"owner": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 2, "creation_date": 1562744967, "post_id": 56965717, "comment_id": 100468711, "body": "<code>char currency[3];</code> is 1 element too small to store <code>&quot;AUD&quot;</code>, <code>&quot;CAD&quot;</code> etc. because of the <code>&#39;\\0&#39;</code>-terminator of the string."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1562746325, "post_id": 56965717, "comment_id": 100469405, "body": "There need not be a separate question for every possible separator character..."}], "owner": {"reputation": 61, "user_id": 4457957, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/518f49201bc249e3af98d203dfd169df?s=128&d=identicon&r=PG&f=1", "display_name": "omicito", "link": "https://stackoverflow.com/users/4457957/omicito"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "closed_date": 1562746304, "answer_count": 0, "score": 0, "last_activity_date": 1562746456, "creation_date": 1562744494, "last_edit_date": 1562744644, "question_id": 56965717, "link": "https://stackoverflow.com/questions/56965717/read-integers-and-strings-from-file-with-fscanf-separated-with", "closed_reason": "Duplicate", "title": "Read integers and strings from file with fscanf separated with #", "body": "<p>I need some help...\nI have to read a file in which the data is formatted like this:</p>\n\n<pre>\n#Country#Code#Currency#\n#Country#Code#Currency#\n...\n</pre>\n\n<p>example:</p>\n\n<pre>\n#Australia#039#AUD#\n#Canada#109#CAD#\n</pre>\n\n<p>Country and Currency should be a string, while the Code is int.\nHow should I write the fscanf to read and save all this data in their variables?</p>\n\n<p>I already tried formatting fscanf like this: <code>fscanf(f, \"#%s#%d#%s#\\n\", country, &amp;code, currency);</code></p>\n\n<pre><code>FILE *f;\nchar country[20];\nint code;\nchar currency[3];\nf = fopen(\"dat.txt\", \"r\");\n\nwhile (!feof(f))\n        fscanf(f, \"#%s#%d#%s#\\n\", country, &amp;code,currency);\n</code></pre>\n\n<p>When I try to run it, I see that the whole line is saved in the variable country, instead of only the first part between #.</p>\n\n<p>When i have only integers or floats between #, this principle works like a charm.</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["c", "embedded", "googletest"], "answers": [{"tags": [], "owner": {"reputation": 5101, "user_id": 700170, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gZ8hw.png?s=128&g=1", "display_name": "Morten Jensen", "link": "https://stackoverflow.com/users/700170/morten-jensen"}, "is_accepted": false, "score": 0, "last_activity_date": 1562754059, "creation_date": 1562754059, "answer_id": 56968639, "question_id": 56965708, "link": "https://stackoverflow.com/questions/56965708/testing-a-c-function-with-google-test/56968639#56968639", "title": "Testing a C function with Google Test", "body": "<p>Easy way to cover all options in the <code>switch</code> would be to change <code>MPS__enGetPowerUpTrigger</code> to something like this:</p>\n\n<pre><code>MPS__tenPowerUpTrigger MPS__enGetPowerUpTrigger(void)\n{\n    const MPS__tenPowerUpTrigger return_values[3] = { \n      enPowerUpTriggerFstp,\n      enPowerUpTriggerWakeUp,\n      enPowerUpTriggerReset\n    };\n    static int idx = 0;\n\n    MPS__tenPowerUpTrigger return_value = return_values[idx];\n    idx += 1;\n    if (idx &gt;= 3) idx = 0;\n    return return_value;\n}\n</code></pre>\n\n<p>... and then call <code>MPS__vOnEnterStateAcPu1</code> 3 times?</p>\n"}], "owner": {"reputation": 163, "user_id": 4299323, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh5.googleusercontent.com/-8QQSPW-vFEs/AAAAAAAAAAI/AAAAAAAAAB8/BBl6jcXyZ0I/photo.jpg?sz=128", "display_name": "Mike B.", "link": "https://stackoverflow.com/users/4299323/mike-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 72, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1562754059, "creation_date": 1562744472, "question_id": 56965708, "link": "https://stackoverflow.com/questions/56965708/testing-a-c-function-with-google-test", "title": "Testing a C function with Google Test", "body": "<p>I'm trying to use Google Test to test some C code but I'm struggling. I don't really understand how to test the code. I've tried something but I don't know if it's OK or not. Can someone explain to me if it's OK what I've done and how could I test the switch part?</p>\n\n<p>This is the Test I wrote:</p>\n\n<pre><code>    TEST_F(MPS_Tests, Wai_for_discharging_of_several_rails) {\n\n\n        MPS__tenPowerUpTrigger enTrigger = MPS__enGetPowerUpTrigger();\n        EXPECT_EQ(enPowerUpTriggerFstp, enTrigger);\n        MPS__vOnEnterStateAcPu1();\n        EXPECT_EQ(MPS__enGetInternalState(enAC), enStateAcPu1);\n        EXPECT_EQ(MPS__u16GetSmEvent(enAC), enStateAcPu1);\n\n</code></pre>\n\n<p>This is the tested code:</p>\n\n<pre><code>MPS__tenPowerUpTrigger MPS__enGetPowerUpTrigger(void)\n{\n    /* TODO: rework after startup trigger is considerd by design */\n    return enPowerUpTriggerFstp;\n}\n\n/* Wait for discharging of several rails */\nvoid MPS__vOnEnterStateAcPu1(void)\n{\n    MPS__tenPowerUpTrigger enTrigger = MPS__enGetPowerUpTrigger();\n    MPS__vSetInternalState(enAC, enStateAcPu1);\n\n    switch (enTrigger)\n    {\n    case enPowerUpTriggerFstp:\n        MPS__vSetWait(enAC, u16Time_AC1ASU_t4);\n        break;\n    case enPowerUpTriggerWakeUp:\n        MPS__vSetWait(enAC, MPS_TIMER_NOWAIT);\n        break;\n    case enPowerUpTriggerReset:\n        MPS__vSetWait(enAC, u16Time_AC1CSU_t2);\n        break;\n    default:\n        /* error handling */\n        break;\n    }\n}\n</code></pre>\n\n<p>Thank you!</p>\n"}, {"tags": ["python", "c", "network-programming"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1562744219, "post_id": 56965577, "comment_id": 100468351, "body": "The error &quot;Network is unreachable&quot; means that there&#39;s no route to the destination host. A router somewhere along the way simply don&#39;t know how to forward your message."}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1562744706, "post_id": 56965577, "comment_id": 100468584, "body": "Or maybe your own host doesn&#39;t have a route to that mcast address. You are correct in that you don&#39;t  have to join the mcast group. NB it should be <code>emit.sin_port = htons(port);</code>."}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1562874684, "post_id": 56965577, "comment_id": 100526817, "body": "Well, you have said it... IGMP is at the same level as UDP.  it is like trying to send a UDP packet to TCP.  You can do it, but with what sense?  PROTOCOLS are protocols, and you have to follow the rules to use them."}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1562875063, "post_id": 56965577, "comment_id": 100526963, "body": "You are not sending your UDP packet to IGMP, but to UDP, destination port 6680.  To send a packet to IGMP, you need to select IGMP protocol, in the <code>socket(2)</code> call, if the kernel has support fot IGMP sockets.)  protocol 0 is the default <code>AF_INET</code> datagram protocol, which is <code>UDP</code>, not <code>IGMP</code>.  I think you have a little mesh with protocols."}, {"owner": {"reputation": 1, "user_id": 11763401, "user_type": "registered", "profile_image": "https://graph.facebook.com/894614767551436/picture?type=large", "display_name": "Quentin de Saint-Christophe", "link": "https://stackoverflow.com/users/11763401/quentin-de-saint-christophe"}, "reply_to_user": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1562909471, "post_id": 56965577, "comment_id": 100534547, "body": "Ok @LuisColorado, I think I haven&#39;t clearly exposed my issue. I know that UDP is the transport layer (4th) and IGMP is as the same level as routers. But I do not know how to send datas to any route without working on IP protocol. Both the device (radar) and my display unit (pc) work with UDP and IGMP."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11763401, "user_type": "registered", "profile_image": "https://graph.facebook.com/894614767551436/picture?type=large", "display_name": "Quentin de Saint-Christophe", "link": "https://stackoverflow.com/users/11763401/quentin-de-saint-christophe"}, "edited": false, "score": 0, "creation_date": 1562915123, "post_id": 57001287, "comment_id": 100536645, "body": "And so, I do not succeed to translate it\u2026"}], "tags": [], "owner": {"reputation": 1, "user_id": 11763401, "user_type": "registered", "profile_image": "https://graph.facebook.com/894614767551436/picture?type=large", "display_name": "Quentin de Saint-Christophe", "link": "https://stackoverflow.com/users/11763401/quentin-de-saint-christophe"}, "is_accepted": false, "score": 0, "last_activity_date": 1562915698, "last_edit_date": 1562915698, "creation_date": 1562912855, "answer_id": 57001287, "question_id": 56965577, "link": "https://stackoverflow.com/questions/56965577/how-to-send-an-udp-datagram-to-an-igmp-device/57001287#57001287", "title": "How to send an UDP datagram to an IGMP device?", "body": "<p>I have advanced in my issue, that is why I want to partially answer: I managed to do the connection in python. It cannot be a computer's settings' problem.</p>\n\n<p>Here is the code that works:</p>\n\n<pre><code>import socket\nimport struct\n\nMCAST_GRP = '236.6.7.8'\nMCAST_PORT = 6678\n\nHOST2 = '236.6.7.10'\nPORT2 = 6680\n\nsock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM, socket.IPPROTO_UDP)\n\nsock.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)\n\n\n\nsock.bind(('', MCAST_PORT))  # use MCAST_GRP instead of '' to listen only\n                         # to MCAST_GRP, not all groups on MCAST_PORT\n\n\nmreq = struct.pack(\"4sl\", socket.inet_aton(MCAST_GRP), socket.INADDR_ANY)\n\nsock.setsockopt(socket.IPPROTO_IP, socket.IP_ADD_MEMBERSHIP, mreq)\n\nsock2 = socket.socket(socket.AF_INET,socket.SOCK_DGRAM)\n\nreg0=bytes([0x00, 0xC1, 0x01])               #turn_on\nreg1=bytes([0x01, 0xC1, 0x01])               #turn_on\n\n\nsock2.sendto(reg0, (HOST2, PORT2))\nsock2.sendto(reg1, (HOST2, PORT2))\nsock2.sendto(reg3, (HOST2, PORT2))\npcapfile = open('ragar.txt', 'w')\nwhile True:\n  pcapfile.write(str(sock.recv(65536)))\npcapfile.close()\nprint('the end')\n</code></pre>\n\n<p>The <code>sock2</code> manages to send the registers to the device whereas the <code>sock</code> receives the datas correctly.  </p>\n"}], "owner": {"reputation": 1, "user_id": 11763401, "user_type": "registered", "profile_image": "https://graph.facebook.com/894614767551436/picture?type=large", "display_name": "Quentin de Saint-Christophe", "link": "https://stackoverflow.com/users/11763401/quentin-de-saint-christophe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1562915698, "creation_date": 1562744000, "last_edit_date": 1562912878, "question_id": 56965577, "link": "https://stackoverflow.com/questions/56965577/how-to-send-an-udp-datagram-to-an-igmp-device", "title": "How to send an UDP datagram to an IGMP device?", "body": "<p>I have a broadband Radar that I want to turn on. To turn it on I have to send two registers like following:</p>\n\n<pre><code>    int reg0[3] = {0x00, 0xC1, 0x01};      \n    int reg1[3] = {0x01, 0xC1, 0x01};\n</code></pre>\n\n<p>The main issue is that my Radar device is working on UDP protocol and works in IGMP (3rd layer of the ISO model). I have read a lot about UDP sending in these sites from the IBM support:\n<a href=\"https://www.ibm.com/support/knowledgecenter/en/SSLTBW_2.3.0/com.ibm.zos.v2r3.hala001/cskudp.htm\" rel=\"nofollow noreferrer\">https://www.ibm.com/support/knowledgecenter/en/SSLTBW_2.3.0/com.ibm.zos.v2r3.hala001/cskudp.htm</a>\n<a href=\"https://www.ibm.com/support/knowledgecenter/en/SSLTBW_2.3.0/com.ibm.zos.v2r3.bpxbd00/setopt.htm\" rel=\"nofollow noreferrer\">https://www.ibm.com/support/knowledgecenter/en/SSLTBW_2.3.0/com.ibm.zos.v2r3.bpxbd00/setopt.htm</a>\n\u2026and others.</p>\n\n<p>I fathom it is neither obliged to create a <code>struct ip_mreq</code> nor add options with <code>setsockopt()</code> for I only want to send a datagram.</p>\n\n<p>I have already tried to do this sort of things:</p>\n\n<pre><code>    #define IPM struct ip_mreq\n    IPM mcast;\n    int sock_err = bind(skemit, (SA *) &amp;emit, lemit);\n    mcast.imr_multiaddr.s_addr = MCAST_JOIN_GROUP;//multicastaddress \n    mcast.imr_interface.s_addr = add1;\n    setsockopt(semit, IPPROTO_IP, IP_ADD_MEMBERSHIP, (char*)&amp;mcast, sizeof(IPM)); //sizeof(mcast)\n</code></pre>\n\n<p>This is my code:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n\n#include &lt;unistd.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\n#include &lt;sys/types.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;netdb.h&gt;\n#include &lt;netinet/in.h&gt;\n#include &lt;arpa/inet.h&gt;\n#include &lt;time.h&gt;\n#include &lt;signal.h&gt;\n\n#define SAI struct sockaddr_in\n#define SA struct sockaddr\n\nint main(){\n\n  SAI emit;\n  uint32_t add1 = htonl(inet_addr(\"236.6.7.10\")); //host address\n  unsigned short port = htons(6680); // port\n\n  memset(&amp;emit, '\\0', sizeof(emit));\n  emit.sin_family = AF_INET;\n  emit.sin_port = port;\n  emit.sin_addr.s_addr = add1;\n  socklen_t lemit = sizeof(SAI);\n\n  int skemit = socket(AF_INET, SOCK_DGRAM, 0);\n  if (skemit == -1){ perror(\"creating socket\"); }\n  /*\n  * Send a message to the multicast address specified by the\n  * emit sockaddr structure.\n  */\n\n  int reg0[3] = {0x00, 0xC1, 0x01};        //turn_on\n  int reg1[3] = {0x01, 0xC1, 0x01};        //turn_on\n\n\n  /* Send the message in reg0 and reg1 to the server */\n\n  if (sendto(skemit, reg0, sizeof(reg0), 0, (SA*)&amp;emit, lemit) &lt; 0){perror(\"sending datagram message reg0\");}\n  if (sendto(skemit, reg1, sizeof(reg1), 0, (SA*)&amp;emit, lemit) &lt; 0){perror(\"sending datagram message reg1\");}\n}\n</code></pre>\n\n<p>I receive this errors:</p>\n\n<pre><code>sending datagram message reg0: Network is unreachable\nsending datagram message reg1: Network is unreachable\n</code></pre>\n\n<p>Could you help me?</p>\n"}, {"tags": ["c", "memory-management", "pthreads", "free"], "comments": [{"owner": {"reputation": 7495, "user_id": 11527076, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xqgpS.png?s=128&g=1", "display_name": "prog-fh", "link": "https://stackoverflow.com/users/11527076/prog-fh"}, "edited": false, "score": 2, "creation_date": 1562741036, "post_id": 56964745, "comment_id": 100466805, "body": "You wrote <code>int sum</code>, I guess a pointer is needed here."}, {"owner": {"reputation": 335, "user_id": 5675033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/002e7d178f95b928f4ec88ea7c2d1235?s=128&d=identicon&r=PG&f=1", "display_name": "Nouman Tajik", "link": "https://stackoverflow.com/users/5675033/nouman-tajik"}, "reply_to_user": {"reputation": 7495, "user_id": 11527076, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xqgpS.png?s=128&g=1", "display_name": "prog-fh", "link": "https://stackoverflow.com/users/11527076/prog-fh"}, "edited": false, "score": 0, "creation_date": 1562741123, "post_id": 56964745, "comment_id": 100466842, "body": "@prog-fh. You are right, Its a typo error, let me correct this"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1562744917, "post_id": 56964745, "comment_id": 100468688, "body": "Please do not fix those bugs in your code that are essential for asking the question"}], "answers": [{"tags": [], "owner": {"reputation": 7495, "user_id": 11527076, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xqgpS.png?s=128&g=1", "display_name": "prog-fh", "link": "https://stackoverflow.com/users/11527076/prog-fh"}, "is_accepted": true, "score": 3, "last_activity_date": 1562766723, "last_edit_date": 1562766723, "creation_date": 1562741305, "answer_id": 56964848, "question_id": 56964745, "link": "https://stackoverflow.com/questions/56964745/how-to-free-memory-allocated-by-thread-function-in-the-main/56964848#56964848", "title": "How to free memory allocated by thread-function in the main", "body": "<p>You should send back the pointer, not its address</p>\n\n<pre><code>pthread_exit(sum);\n...\npthread_join(tid1, &amp;sum1);\n</code></pre>\n\n<p>From the thread function you want to send back (with <code>return</code> or <code>pthread_exit()</code>) a pointer.<br>\nAt <code>pthread_join()</code> you want to obtain this pointer but the result of <code>pthread_join()</code> is an integer to report success/failure.<br>\nThen we have to declare a pointer variable (<code>sum1</code> here) to store the expected result and provide <code>pthread_join()</code> with the address of this variable so that it could be updated (the same way we provide addresses to <code>scanf()</code> in order to update the extracted variables).</p>\n"}, {"tags": [], "owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "is_accepted": false, "score": 4, "last_activity_date": 1562744616, "creation_date": 1562744616, "answer_id": 56965750, "question_id": 56964745, "link": "https://stackoverflow.com/questions/56964745/how-to-free-memory-allocated-by-thread-function-in-the-main/56965750#56965750", "title": "How to free memory allocated by thread-function in the main", "body": "<p>The problem in your code is the use of <strong>casts</strong>. In C most of the time a pointer cast signifies an <strong>erroneous construct</strong>. Notably in this example no casts are required if the constructs are used correctly:</p>\n\n<pre><code>// no cast required because malloc returns void * and void * can be converted\n// to a pointer to int without a cast\nint *sum = malloc(sizeof (int));\n\n// no cast required because int * can be converted to a void * without a cast\npthread_exit(sum);\n\nvoid *sum1;\n\n// no cast required because the address of void * is a void **!\npthread_join(tid1, &amp;sum1);\n</code></pre>\n\n<p>The only place where you require a cast is if you now convert this <code>void *</code> <strong>value</strong> to <code>int *</code> inline:</p>\n\n<pre><code>int value = *(int *)sum1;\n</code></pre>\n\n<p>but you can convert it by assignment too, and then again, no cast is required:</p>\n\n<pre><code>int *value_ptr = sum1;\nprintf(\"The value was %d\\n\", *value_ptr);\nfree(value_ptr);\n</code></pre>\n\n<p>The rule of thumb is that a cast is OK if you know something better than a compiler - like \"truncate this value to <code>uint8_t</code>\" or \"this void pointer actually points to an <code>int</code>, but I am not assigning it to one to save keystrokes\" - but it is usually not OK just to silence a warning.</p>\n\n<hr>\n\n<p>Some programmers write code like this:</p>\n\n<pre><code>int *ptr;\npthread_join(tid1, (void **)&amp;ptr);\n</code></pre>\n\n<p>Such code is not strictly conforming as an <code>int *</code> and <code>void *</code> are not compatible types, may have or not have the same representation or even size, and especially may not alias each other.</p>\n"}], "owner": {"reputation": 335, "user_id": 5675033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/002e7d178f95b928f4ec88ea7c2d1235?s=128&d=identicon&r=PG&f=1", "display_name": "Nouman Tajik", "link": "https://stackoverflow.com/users/5675033/nouman-tajik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 696, "favorite_count": 0, "accepted_answer_id": 56964848, "answer_count": 2, "score": 3, "last_activity_date": 1562766723, "creation_date": 1562740928, "last_edit_date": 1562766332, "question_id": 56964745, "link": "https://stackoverflow.com/questions/56964745/how-to-free-memory-allocated-by-thread-function-in-the-main", "title": "How to free memory allocated by thread-function in the main", "body": "<p>I have allocated <code>heap</code> memory in the thread function <code>f1</code>, this storage is used to calculate the value in the heap region so that the main function can see it.</p>\n\n<p>Here is the thread function definition:</p>\n\n<pre><code>void *f1(void *input){\n\n\n        int sum = (int*)malloc(sizeof(int));\n        /* Do calculation */   \n        pthread_exit((void*)&amp;sum);\n}\n</code></pre>\n\n<p>In the above code, the <code>sum</code> is the heap allocated storage, whose address is passed as a return value to the <code>sum1</code> in the <code>main()</code>.</p>\n\n<p>I <code>join</code> the thread in the <code>main()</code> like this:</p>\n\n<pre><code>void *sum1;\npthread_join(tid1,(void**)&amp;sum1);\n</code></pre>\n\n<p>Once i retrieved the value, i want to <code>free</code> the allocated memory.\nWhen i use <code>free</code> in the main, it complains like <code>munmap_chunk(): invalid pointer</code></p>\n\n<p>How can i explicitly and safely <code>free</code> this memory ?</p>\n"}, {"tags": ["c", "profiling", "macos-mojave", "gprof"], "comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 1, "creation_date": 1562740751, "post_id": 56964661, "comment_id": 100466667, "body": "I believe you&#39;re not using GCC..."}, {"owner": {"reputation": 33241, "user_id": 297131, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/c9b911baaad69b64f3cc6754db12c82e?s=128&d=identicon&r=PG", "display_name": "Evgenii", "link": "https://stackoverflow.com/users/297131/evgenii"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1562741539, "post_id": 56964661, "comment_id": 100467015, "body": "@AnttiHaapala you are right, thanks. When I type <code>gcc -v</code> it says it&#39;s some weird Apple LLVM thing, not GNU Compiler Collection. WTF?! I want GCC! What should I do now. Install GCC?"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 1, "creation_date": 1562741676, "post_id": 56964661, "comment_id": 100467090, "body": "fortunately to me and unfortunately for you I am not using a Mac myself."}, {"owner": {"reputation": 33241, "user_id": 297131, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/c9b911baaad69b64f3cc6754db12c82e?s=128&d=identicon&r=PG", "display_name": "Evgenii", "link": "https://stackoverflow.com/users/297131/evgenii"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1562742036, "post_id": 56964661, "comment_id": 100467275, "body": "Lucky duck haha. Ok, I&#39;m screwd."}], "owner": {"reputation": 33241, "user_id": 297131, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/c9b911baaad69b64f3cc6754db12c82e?s=128&d=identicon&r=PG", "display_name": "Evgenii", "link": "https://stackoverflow.com/users/297131/evgenii"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 376, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1562740535, "creation_date": 1562740535, "question_id": 56964661, "link": "https://stackoverflow.com/questions/56964661/how-to-use-gnu-gprof-profiler-on-macos-mojave", "title": "How to use GNU gprof profiler on macOS Mojave?", "body": "<p>I want to use GNU gprof that comes with GCC to profile my C program. However, it returns <code>__dyld section not supported</code> error when I compile with the <code>-pg</code> flag and try to run the program:</p>\n\n<pre><code>$ gcc -pg main.c \n$ ./a.out \ndyld: __dyld section not supported in /Users/evgenii/Downloads/c_profile/./a.out\n</code></pre>\n\n<p>This error has been reported <a href=\"https://stackoverflow.com/questions/52519907/dyld-section-not-supported-after-mojave-upgrade\">here</a>. Is there a way to use the GNU profiler on macOS Mojave? I'm aware that there are alternative tools for profiling, but I want to use gprof.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 6, "creation_date": 1562738310, "post_id": 56964088, "comment_id": 100465740, "body": "Why do you need to create a copy of a structure? Why can&#39;t you use the actual structure itself? Having a copy of a structure will just lead to maintenance nightmares if they ever get out of sync."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 4, "creation_date": 1562738379, "post_id": 56964088, "comment_id": 100465764, "body": "And besides, two different structures are two different structures. For the C compiler they really are two different structures, there&#39;s no relationship between them at all. Which of course means there&#39;s no way to get build errors if they don&#39;t match."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1562738410, "post_id": 56964088, "comment_id": 100465776, "body": "You could use some kind of <code>diff</code> tool, but I don&#39;t think there&#39;s any way to do it in the language itself."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 1, "creation_date": 1562738573, "post_id": 56964088, "comment_id": 100465856, "body": "This <code>struct* err</code> is not valid C, BTW."}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 1, "creation_date": 1562739005, "post_id": 56964088, "comment_id": 100466007, "body": "` of size 1 byte` - how do you know that? Are you sure?"}, {"owner": {"reputation": 3856, "user_id": 4188894, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Jj4yA.jpg?s=128&g=1", "display_name": "Gyapti Jain", "link": "https://stackoverflow.com/users/4188894/gyapti-jain"}, "edited": false, "score": 2, "creation_date": 1562739422, "post_id": 56964088, "comment_id": 100466136, "body": "<code>if (((*err_ptr) &amp; ERR_MASK) != 0U)</code> Not portable. You are assuming about the bit layout which actually is implementation dependent. BTW to check such thing one way is to rely on manual and reliable (Does it exist) versioning."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1562740444, "post_id": 56964088, "comment_id": 100466552, "body": "Two different structs that are atually exactly the same? Why?"}, {"owner": {"reputation": 97, "user_id": 8059679, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/1380038392052408/picture?type=large", "display_name": "Girish Onte", "link": "https://stackoverflow.com/users/8059679/girish-onte"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1562757272, "post_id": 56964088, "comment_id": 100475547, "body": "@Someprogrammerdude I am using the actual structure from file1.h but if its type is modified by file1 owner (which is not me), I want it to be notified to me in the form of compilation error. That is the reason why I want to keep a copy of it in my file (file2.c or file2.h) and do a pre-compile check."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1562784963, "post_id": 56964088, "comment_id": 100490169, "body": "Why don&#39;t you just use the one definition from the other file?  It would be far more sensible than what you&#39;re trying.  Do you really distrust your colleagues that much?"}, {"owner": {"reputation": 97, "user_id": 8059679, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/1380038392052408/picture?type=large", "display_name": "Girish Onte", "link": "https://stackoverflow.com/users/8059679/girish-onte"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1562932820, "post_id": 56964088, "comment_id": 100545757, "body": "@JonathanLeffler I think you didn&#39;t understand my question. I am using the same definition from the other file. if the type is changed, it may be possible that the owner my forget to inform others and in this scenario, the check whatever i am doing using mask would lead to wrong results. To avoid this I want to put a check. it is not about trust, it is about miscommunication and possible error."}], "answers": [{"comments": [{"owner": {"reputation": 97, "user_id": 8059679, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/1380038392052408/picture?type=large", "display_name": "Girish Onte", "link": "https://stackoverflow.com/users/8059679/girish-onte"}, "edited": false, "score": 0, "creation_date": 1562757018, "post_id": 56964635, "comment_id": 100475426, "body": "thanks for the answer. I forgot to clarify that the size of &quot;struct errors&quot; and &quot;struct copy_errors&quot; is always 1-byte. I want to identify if its elements have got interchanged or replaced with new elements."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "reply_to_user": {"reputation": 97, "user_id": 8059679, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/1380038392052408/picture?type=large", "display_name": "Girish Onte", "link": "https://stackoverflow.com/users/8059679/girish-onte"}, "edited": false, "score": 0, "creation_date": 1562776068, "post_id": 56964635, "comment_id": 100486182, "body": "@GirishOnte Well, forget about <code>copy_errors</code>, it doesn&#39;t serve you anything at all. All the checks you want/need can be done on <code>struct errors</code> directly \u2013 but apart from the size check, none of them directly from within C. It&#39;s not supported. Fullstop. So you need a separate tool for, like forementioned python script (or any other scripting language or even a <i>separate</i> executable written in C)."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "reply_to_user": {"reputation": 97, "user_id": 8059679, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/1380038392052408/picture?type=large", "display_name": "Girish Onte", "link": "https://stackoverflow.com/users/8059679/girish-onte"}, "edited": false, "score": 0, "creation_date": 1562776164, "post_id": 56964635, "comment_id": 100486236, "body": "@GirishOnte  Size will always be 1 byte? Are you sure? What about this: <code>struct errors { unsigned char err0:1; &#47;* ... *&#47; unsigned char err5:1; unsigned char err6:1; unsigned char err7:1; unsigned char err8:1; &#47;* and a bunch of reserved bits *&#47; };</code>..."}, {"owner": {"reputation": 97, "user_id": 8059679, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/1380038392052408/picture?type=large", "display_name": "Girish Onte", "link": "https://stackoverflow.com/users/8059679/girish-onte"}, "edited": false, "score": 0, "creation_date": 1562932565, "post_id": 56964635, "comment_id": 100545624, "body": "Yes. I got to know that this is not possible from C language. I will check for the tool solution as you suggested. thanks. To clarify you regarding size, the number of elements of the structure are always fixed in my application. They are not going to vary. but the position of existing elements can be altered inside the structure. hope it is clear."}], "tags": [], "owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "is_accepted": false, "score": 2, "last_activity_date": 1562741052, "last_edit_date": 1562741052, "creation_date": 1562740439, "answer_id": 56964635, "question_id": 56964088, "link": "https://stackoverflow.com/questions/56964088/how-to-check-whether-two-structure-types-are-equal-in-c/56964635#56964635", "title": "How to check whether two structure types are equal in c?", "body": "<p>C doesn't support anything equivalent. If you have a tool chain that supports custom build events, you could introduce a pre-build step calling e. g. a python script (or any other language you prefer). This script then would:</p>\n\n<ul>\n<li>load the header file</li>\n<li>iterate over all lines until it finds the structure in question</li>\n<li>check for all known members in desired order (i. e. no members replaced)</li>\n<li>finally check, if end of structure is reached (i. e. no new members added)</li>\n</ul>\n\n<p>If your tool chain stops, if the pre-build task fails, you are out already (just return 0 on success and anything else on failure), otherwise you could create a simple C-File, empty on success and containing an <code>#error</code> directive on failure.</p>\n\n<p>Within your C code, you could additionally assure that the size of your struct matches:</p>\n\n<pre><code>#define CONCATENATE(X, Y) CONCATENATE_(X, Y)\n#define CONCATENATE_(X, Y) X##Y\n\n#define STATIC_ASSERT(CONDITION) \\\n    typedef int(CONCATENATE(_static_assert_, __LINE__))[(CONDITION)? 1 : -1]\n\nSTATIC_ASSERT(sizeof(struct errors) == sizeof(unsigned char));\n</code></pre>\n\n<p>The macro is defined to be re-usable, as is, though, might produce additional warnings if used within function body (because of unused local type).</p>\n"}], "owner": {"reputation": 97, "user_id": 8059679, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/1380038392052408/picture?type=large", "display_name": "Girish Onte", "link": "https://stackoverflow.com/users/8059679/girish-onte"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1562741052, "creation_date": 1562737721, "last_edit_date": 1562739037, "question_id": 56964088, "link": "https://stackoverflow.com/questions/56964088/how-to-check-whether-two-structure-types-are-equal-in-c", "title": "How to check whether two structure types are equal in c?", "body": "<p>I have a bit-field structure \"struct errors\" of size 1 byte and I am using its data using a mask \"ERR_MASK\" as shown in below code.\nMy requirement is that if the type of the structure is changed, the mask need to be adapted accordingly. </p>\n\n<p>Since I am importing this structure type from another component or module (file1.h in below code), \nI want to define a copy of this structure type \"struct copy_errors\" in my source file (file2.c in below code) and check if it has got changed with original type in file1.h, \nIf there is a mismatch, I want to throw an compilation error from file2.c. Can anyone tell me how do I achieve this? Or is there any other way to do this? \nNote: I don't want to access \"struct errors\" with its elements.</p>\n\n<pre><code>    /*file1.h*/\n    struct errors\n    {\n      unsigned char err0  :1;\n      unsigned char err1  :1;\n      unsigned char err2  :1;\n      unsigned char err3  :1;\n      unsigned char err4  :1;\n      unsigned char err5  :1;\n      unsigned char reserved1   :1;\n      unsigned char reserved2   :1;\n\n    };\n\n    /*file2.c*/\n    #include \"file1.h\"\n    #define ERR_MASK 0xFCU\n\n    struct copy_errors\n    {\n      unsigned char err0  :1;\n      unsigned char err1  :1;\n      unsigned char err2  :1;\n      unsigned char err3  :1;\n      unsigned char err4  :1;\n      unsigned char err5  :1;\n      unsigned char reserved1   :1;\n      unsigned char reserved2   :1;\n\n    };\n\n    bool function(struct err*)\n    {\n      bool ret=0;\n      unsigned char * err_ptr;\n\n      err_ptr = (unsigned char *) err;\n\n      if (((*err_ptr) &amp; ERR_MASK) != 0U)\n      {\n        ret = 1;\n      }\n\n      return ret;\n    }\n</code></pre>\n"}, {"tags": ["c", "arrays", "string", "pointers", "memory-management"], "comments": [{"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 1, "creation_date": 1562738287, "post_id": 56964075, "comment_id": 100465731, "body": "Retagged as C, since the examples provided are not valid C++."}, {"owner": {"reputation": 3839, "user_id": 9171697, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/475b59ee1312dc014fbe1eebcd91d307?s=128&d=identicon&r=PG&f=1", "display_name": "Meowmere", "link": "https://stackoverflow.com/users/9171697/meowmere"}, "edited": false, "score": 0, "creation_date": 1562738317, "post_id": 56964075, "comment_id": 100465744, "body": "The error is that you are trying to assign a <code>const char*</code> to a <code>char</code>."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1562748498, "post_id": 56964075, "comment_id": 100470567, "body": "And what was the error"}], "answers": [{"comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1562745017, "post_id": 56964185, "comment_id": 100468735, "body": "There is no overloading of assignment operator in C... .. the code was never valid C++."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1562747971, "post_id": 56964185, "comment_id": 100470241, "body": "@AnttiHaapala it was originally taged c++"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1562748425, "post_id": 56964185, "comment_id": 100470519, "body": "Yes, it was originally tagged both C and C++ but with code that would compile as C and would not compile as C++"}], "tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": 1, "last_activity_date": 1562742229, "last_edit_date": 1562742229, "creation_date": 1562738297, "answer_id": 56964185, "question_id": 56964075, "link": "https://stackoverflow.com/questions/56964075/using-malloc-to-initialize-char-pointer-vs-not-using-malloc-and-just-assign-a-st/56964185#56964185", "title": "Using malloc to initialize char pointer VS not using malloc and just assign a string directly to the char pointer", "body": "<p>Long question but the answer is very easy. Firstly you need to understand what the pointer is. </p>\n\n<pre><code> *pointer = \"Hello world\";\n</code></pre>\n\n<p>Here you try to assign a pointer to the char. If you remove the * then you will assign the pointer to the string literal to the <code>pointer</code>.</p>\n\n<p>Unless you have overloaded the assign operator it will not copy it to the allocated memory. Your malloc is pointless as you assign new value to the pointer and the memory allocated by the malloc is lost</p>\n\n<p>You need to strcpy it instead</p>\n\n<blockquote>\n  <p>where is this information living?</p>\n</blockquote>\n\n<p>It is implementation dependant where the string literals are stored. It can be anywhere. Remember that you can't modify the string literals. Attempt to do so is an Undefined Behaviour </p>\n"}, {"tags": [], "owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "is_accepted": false, "score": 1, "last_activity_date": 1562739642, "creation_date": 1562739642, "answer_id": 56964452, "question_id": 56964075, "link": "https://stackoverflow.com/questions/56964075/using-malloc-to-initialize-char-pointer-vs-not-using-malloc-and-just-assign-a-st/56964452#56964452", "title": "Using malloc to initialize char pointer VS not using malloc and just assign a string directly to the char pointer", "body": "<blockquote>\n  <p>1) If I just initialize a char pointer and assign a string to it, <strong>where is this information living?</strong> In the heap? In the stack? Ex: char *pointer = \"Hello world\";</p>\n</blockquote>\n\n<p>The string literal <code>\"Hello world\"</code> has static storage duration.   This means it exists somewhere in memory accessible to your program, for as long as your program is running.</p>\n\n<p>The exact place where it is located is implementation specific.</p>\n\n<blockquote>\n  <p>2) I tried to use malloc to initialize my char pointer and use it later to assign a string to it, but I can't compile it, I get error, <strong>what is wrong with this logic?</strong> this is what I'm trying to do:</p>\n\n<pre><code>char *pointer = malloc(sizeof(char) * 12);\n*pointer = \"Hello world\";\n</code></pre>\n</blockquote>\n\n<p>This doesn't work, since <code>*pointer</code> is the first <code>char</code> in the dynnamically allocated memory (returned by <code>malloc()</code>).    The string literal <code>\"Hello world\"</code> is represented as an array of characters.   An array of characters cannot be stored in a single <code>char</code>.</p>\n\n<p>What you actually need to do in this case is copy data from the string literal to the dynamically allocated memory.</p>\n\n<pre><code>char *pointer = malloc(sizeof(char) * 12);\nstrcpy(pointer, \"Hello world\");            /* strcpy() is declared in standard header &lt;string.h&gt; *\n</code></pre>\n\n<p>Note that this doesn't change the data that represents the string literal.  It copies the data in that string literal into the memory pointed at by <code>pointer</code> (and allocated dynamically by <code>malloc()</code>).</p>\n\n<p>If you really want <code>pointer</code> to point at the (first character of) the string literal, then do</p>\n\n<pre><code>const char *pointer = \"Hello world\";\n</code></pre>\n\n<p>The <code>const</code> represents the fact that modifying a string literal gives undefined behaviour  (and means the above prevents using <code>pointer</code> to modify that string literal).</p>\n\n<p>If you want to write really bad code you could also do</p>\n\n<pre><code>char *pointer = \"Hello world\";   /*  Danger Will Robinson !!!! */\n</code></pre>\n\n<p>or (same net effect)</p>\n\n<pre><code>char *pointer;\npointer = \"Hello world\";     /*  Danger Will Robinson !!!! */\n</code></pre>\n\n<p>This <code>pointer</code> can now be used to modify contents of the string literal - but that causes undefined behaviour.    Most compilers (if appropriately configured) will give warnings about this - which is one of many hints that you should not do this.</p>\n"}, {"comments": [{"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1562742418, "post_id": 56964538, "comment_id": 100467471, "body": "<code>and then assigns the beginning address for that new block of storage to pointer as its value.</code> no it does not.  Read this line of the OPs code more carefully"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1562742506, "post_id": 56964538, "comment_id": 100467505, "body": "Thanks, but that comment refers to this line alone <code>char *pointer = malloc(12);</code>"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1562742973, "post_id": 56964538, "comment_id": 100467759, "body": "But the rest of the answer is partially wrong . <code>*pointer = </code> does not assign the pointer only the <code>char</code> referenced by it. And that was my point actually"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1562743225, "post_id": 56964538, "comment_id": 100467868, "body": "This point <code>*pointer = &quot;Hello world&quot;;    &#47;* (invalid conversion between pointer and </code>char<code>) *&#47;</code> does nothing. It is a big error. What come next has to do with copying character to the new block of memory referenced by <code>pointer</code> with <code>memcpy (pointer, &quot;Hello world&quot;, 12);</code>. I don&#39;t see anything wrong there -- do you?"}], "tags": [], "owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "is_accepted": false, "score": 1, "last_activity_date": 1562741030, "last_edit_date": 1562741030, "creation_date": 1562740045, "answer_id": 56964538, "question_id": 56964075, "link": "https://stackoverflow.com/questions/56964075/using-malloc-to-initialize-char-pointer-vs-not-using-malloc-and-just-assign-a-st/56964538#56964538", "title": "Using malloc to initialize char pointer VS not using malloc and just assign a string directly to the char pointer", "body": "<blockquote>\n  <p>1) If I just initialize a char pointer and assign a string to it,\n  where is this information living? In the heap? In the stack? Ex: <code>char\n  *pointer = \"Hello world\";</code></p>\n</blockquote>\n\n<p>Neither on the stack or on the heap. <code>\"Hello world\"</code> is a <em>string literal</em>, generally created in the <code>rodata</code> (read-only data) segment of the executable. In fact, unless you specify differently, the compiler is free to only store a single copy of <code>\"Hello world\"</code> even if you assign it to multiple pointers. While typically you cannot assign strings to pointers, since this is a <em>string literal</em>, you are actually assigning the address for the literal itself -- which is the only reason that works. Otherwise, as P__J__ notes, you must copy strings from one location to another.</p>\n\n<blockquote>\n  <p>2) I tried to use <code>malloc</code> to initialize my char pointer and use it\n  later to assign a string to it, but I can't compile it, I get error,\n  <strong>what is wrong with this logic?</strong> this is what I'm trying to do:</p>\n\n<pre><code>char *pointer = malloc(sizeof(char) * 12);\n*pointer = \"Hello world\";\n</code></pre>\n</blockquote>\n\n<p>You are mixing apples and oranges here. <code>char *pointer = malloc (12);</code> allocates storage for 12-characters (bytes) and then assigns the beginning address for that new block of storage to <code>pointer</code> as its value. (remember, a pointer is just a normal variable that holds the address to something else as its value) </p>\n\n<p>For every allocation, there must be a <strong><em>validation</em></strong> that the call succeeded, or you will need to handle the failure. Allocation can, and does fail, and when it fails, <code>malloc, calloc * realloc</code> all return <code>NULL</code>. So each time you allocate, you</p>\n\n<pre><code>char *pointer = malloc(12);       /* note: sizeof (char) is always 1 */\nif (pointer == NULL) {            /* you VALIDATE each allocation */\n    perror (\"malloc-pointer\");\n    return 1;\n}\n</code></pre>\n\n<p>Continuing with your case above, you have allocated 12-bytes and assigned the starting address for the new memory block to <code>pointer</code>. Then, you inexplicably, derefernce <code>pointer</code> (e.g. <code>*pointer</code> which now has type <code>char</code>) and attempt to assign the address of the <em>string literal</em> as that character.</p>\n\n<pre><code>*pointer = \"Hello world\";    /* (invalid conversion between pointer and `char`) */\n</code></pre>\n\n<p>What you look like you want to do is to copy <code>\"Hello world\"</code> to the new block of memory held by pointer. To do so, since you already know <code>\"Hello world\"</code> is 12-characters (including the <em>nul-terminating</em> character), you can simply:</p>\n\n<pre><code>memcpy (pointer, \"Hello world\", 12);\n</code></pre>\n\n<p>(<strong>note:</strong> if you already have the length, there is no need to call <code>strcpy</code> and cause it to scan for the end-of-string, again)</p>\n\n<p>Now your new allocated block of memory contains <code>\"Hello world\"</code>, and the memory is mutable, so you can change any of the characters you like.</p>\n\n<p>Since you have allocated the storage, it is up to you to <code>free (pointer);</code> when that memory is no longer in use.</p>\n\n<p>That in a nutshell is the difference between assigning the address of a string literal to a pointer, or allocating storage and assigning the first address in the block of new storage to your pointer, and then copying anything you like to that new block (so long as you remain within the allocated bounds of the memory block allocated).</p>\n\n<p>Look things over and let me know if you have further questions.</p>\n"}, {"tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": false, "score": 1, "last_activity_date": 1562756236, "creation_date": 1562756236, "answer_id": 56969216, "question_id": 56964075, "link": "https://stackoverflow.com/questions/56964075/using-malloc-to-initialize-char-pointer-vs-not-using-malloc-and-just-assign-a-st/56969216#56969216", "title": "Using malloc to initialize char pointer VS not using malloc and just assign a string directly to the char pointer", "body": "<blockquote>\n  <p>I know that the name of a declared array is just like a pointer to the first element of the array,\u2026</p>\n</blockquote>\n\n<p>This is not correct. An array behaves <strong>similarly</strong> to a pointer in many expressions (because it is automatically converted), but it is not <strong>just like</strong> a pointer to the first element. When used as the operand of <code>sizeof</code> or unary <code>&amp;</code>, an array will be an array; it will not be converted to a pointer. Additionally, an array cannot be assigned just like a pointer can; you cannot assign a value to an array.</p>\n\n<blockquote>\n  <p>\u2026 but that array will live in the stack of the memory.</p>\n</blockquote>\n\n<p>The storage of an array depends on its definition. If an object is defined outside of any function, it has static storage duration, meaning it exists for the entire execution of the program. If it is defined inside a function without <code>_Thread_local</code> or <code>static</code> has automatic storage duration, meaning it exists until execution of its associated block of code ends. C implementations overwhelmingly use the stack for objects of automatic storage duration (neglecting the fact that optimization can often make use of the stack unnecessary), but alternatives are possible.</p>\n\n<blockquote>\n  <p>On the other hand, we use malloc when we want to use the heap of the memory, but I found that you can just initialize a char pointer and assign a string to it on the very same declaration line, so I have some questions regarding this matter:</p>\n  \n  <p>1) If I just initialize a char pointer and assign a string to it, where is this information living? In the heap? In the stack? Ex: char *pointer = \"Hello world\";</p>\n</blockquote>\n\n<p>For the string literal <code>\"Hello world\"</code>, the C implementation creates an array of characters with static storage duration, the same as if you had written <code>char MyString[12];</code> or <code>int x;</code> at file scope. Assuming this array is not eliminated or otherwise altered by optimization, it is in some general area of memory that the C implementation uses for data built into the program (possibly a \u201c.rodata\u201d or similar read-only section).</p>\n\n<p>Then, for <code>char *pointer</code>, the C implementation creates a pointer. If this definition appears outside a function, it has static storage duration, and the C implementation uses some general area of memory for that. If it appears inside a function, it has automatic storage duration, and the C implementation likely uses stack space for it.</p>\n\n<p>Then, for the <code>= \"Hello world\"</code>, the C implementation uses the array to initialize <code>pointer</code>. To do this, it converts the array to a pointer to its first element, and it uses that pointer as the initial value of <code>pointer</code>.</p>\n\n<blockquote>\n  <p>2) I tried to use malloc to initialize my char pointer and use it later to assign a string to it, but I can't compile it, I get error, what is wrong with this logic? this is what I'm trying to do:</p>\n  \n  <p><code>char *pointer = malloc(sizeof(char) * 12);</code></p>\n  \n  <p><code>*pointer = \"Hello world\";</code></p>\n</blockquote>\n\n<p>The second line is wrong because <code>*pointer</code> has a different role in a declaration than it does in an expression statement.</p>\n\n<p>In <code>char *pointer = \u2026;</code>, <code>*pointer</code> presents a \u201cpicture\u201d of what should be a <code>char</code>. This is how declarations work in C. It says <code>*pointer</code> is a <code>char</code>, and therefore <code>pointer</code> is a pointer to a <code>char</code>. However, the thing being defined and initialized is not <code>*pointer</code> but is <code>pointer</code>.</p>\n\n<p>In contrast, in <code>*pointer = \"Hello world\";</code>, <code>*pointer</code> is an expression. It takes the pointer <code>pointer</code> and applies the <code>*</code> operator to it. Since <code>pointer</code> is a pointer to <code>char</code>, <code>*pointer</code> is a <code>char</code>. Then <code>*pointer = \"Hello world\";</code> attempts to assign <code>\"Hello world\"</code> to a <code>char</code>. This is an error because <code>\"Hello world\"</code> is not a <code>char</code>.</p>\n\n<p>What you are attempting to do is to assign a pointer to <code>\"Hello world\"</code> to <code>pointer</code>. (More properly, a pointer to the first character of <code>\"Hello world\"</code>.) To do this, use:</p>\n\n<pre><code>pointer = \"Hello world\";\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11716370, "user_type": "registered", "profile_image": "https://graph.facebook.com/10157558261982873/picture?type=large", "display_name": "Kenji Emura", "link": "https://stackoverflow.com/users/11716370/kenji-emura"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1949, "favorite_count": 0, "answer_count": 4, "score": -1, "last_activity_date": 1562756236, "creation_date": 1562737646, "last_edit_date": 1562738258, "question_id": 56964075, "link": "https://stackoverflow.com/questions/56964075/using-malloc-to-initialize-char-pointer-vs-not-using-malloc-and-just-assign-a-st", "title": "Using malloc to initialize char pointer VS not using malloc and just assign a string directly to the char pointer", "body": "<p>I'm trying to understand how this memory allocation thing works when it comes to char and strings.</p>\n\n<p>I know that the name of a declared array is just like a pointer to the first element of the array, but that array will live in the <strong>stack</strong> of the memory.</p>\n\n<p>On the other hand, we use malloc when we want to use the heap of the memory, but I found that you can just initialize a char pointer and assign a string to it on the very same declaration line, so I have some questions regarding this matter:</p>\n\n<p><strong>1)</strong> If I just initialize a char pointer and assign a string to it, <strong>where is this information living?</strong> In the heap? In the stack?\nEx: <code>char *pointer = \"Hello world\";</code></p>\n\n<p><strong>2)</strong> I tried to use malloc to initialize my char pointer and use it later to assign a string to it, but I can't compile it, I get error, <strong>what is wrong with this logic?</strong> this is what I'm trying to do:</p>\n\n<p><code>char *pointer = malloc(sizeof(char) * 12);\n*pointer = \"Hello world\";</code></p>\n\n<p>Can you please help me understand more about pointers and memory allocation? Thank you very much! :)</p>\n"}, {"tags": ["c", "bison", "lex"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1562737399, "post_id": 56963865, "comment_id": 100465416, "body": "Can you use <code>yywrap()</code>?  Your parser gets a first packet of data, and doles out the data one byte at a time.  When it&#39;s all gone, <code>yywrap()</code> is called to see if there&#39;s more data, so you check and act accordingly.  Your grammar may have issues, though \u2014 you&#39;ll need to know when it&#39;s recognized something complete, and then go back to recognize the next chunk of data, repeating ad nauseam, or something similar."}, {"owner": {"reputation": 12448, "user_id": 516813, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/76a7c0468617c5faed9b74821f7ae56a?s=128&d=identicon&r=PG&f=1", "display_name": "chacham15", "link": "https://stackoverflow.com/users/516813/chacham15"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1562737888, "post_id": 56963865, "comment_id": 100465581, "body": "The problem with yywrap is that it doesnt let me say: &quot;i dont have any more bytes right now, but will later&quot; yywrap will also reset the state of the lexer if i understood the docs correctly"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1562738453, "post_id": 56963865, "comment_id": 100465791, "body": "You can simply not return until there will be more data \u2014 unless the grammar needs to know about &#39;no more at the moment&#39; somehow.  And yes, it might well reset the state.  If it&#39;s no help, sorry.  It was just an idea that might have been relevant.  But there was a reason for not making it an answer; I wasn&#39;t sure it was on the right track for you.  I&#39;m not sure what else to suggest."}, {"owner": {"reputation": 12448, "user_id": 516813, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/76a7c0468617c5faed9b74821f7ae56a?s=128&d=identicon&r=PG&f=1", "display_name": "chacham15", "link": "https://stackoverflow.com/users/516813/chacham15"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1562738699, "post_id": 56963865, "comment_id": 100465895, "body": "Thanks for trying, yeah, the problem is that the stream api only notifies more data by calling the callback meaning that if the previous callback simply didnt return the thread isnt available to call the callback again with the new data."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 1, "creation_date": 1562773190, "post_id": 56963865, "comment_id": 100484607, "body": "Unrelated: you&#39;re not using <code>getline</code> correctly. The <code>size</code> argument is the current size of the allocation, which is often much larger than the amount of space actually used by the line just read because <code>getline</code> does not normally shrink the allocation when a short line is read. You must use the return value from <code>getline</code> to know how many valid characters were read. (I&#39;m working on an actual answer but it might take a while.)"}], "answers": [{"comments": [{"owner": {"reputation": 12448, "user_id": 516813, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/76a7c0468617c5faed9b74821f7ae56a?s=128&d=identicon&r=PG&f=1", "display_name": "chacham15", "link": "https://stackoverflow.com/users/516813/chacham15"}, "edited": false, "score": 0, "creation_date": 1562809524, "post_id": 56979427, "comment_id": 100496927, "body": "Your comment gave me the following idea: could I buffer the stream before this and then call parse on the same buffered stream which accumulates the data until parse succeeds at which point ill advance the buffer by the amount that parse parsed?"}, {"owner": {"reputation": 48201, "user_id": 1250772, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/633e1f643d2c9b043231b4a32b078907?s=128&d=identicon&r=PG", "display_name": "Kaz", "link": "https://stackoverflow.com/users/1250772/kaz"}, "reply_to_user": {"reputation": 12448, "user_id": 516813, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/76a7c0468617c5faed9b74821f7ae56a?s=128&d=identicon&r=PG&f=1", "display_name": "chacham15", "link": "https://stackoverflow.com/users/516813/chacham15"}, "edited": false, "score": 0, "creation_date": 1562824057, "post_id": 56979427, "comment_id": 100500018, "body": "@chacham15 You likely can, and you will likely have the most success if you either buffer everything, or your buffering system is able to do enough superficial lexical analysis to at least recognize major syntactic divisions that can be handled cleanly by separate <code>yyparse</code> calls. Of course, the whole approach assumes that the parsing doesn&#39;t have to be timely, or drive some sort of feedback events that generate the input itself."}], "tags": [], "owner": {"reputation": 48201, "user_id": 1250772, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/633e1f643d2c9b043231b4a32b078907?s=128&d=identicon&r=PG", "display_name": "Kaz", "link": "https://stackoverflow.com/users/1250772/kaz"}, "is_accepted": true, "score": 1, "last_activity_date": 1562797695, "creation_date": 1562797695, "answer_id": 56979427, "question_id": 56963865, "link": "https://stackoverflow.com/questions/56963865/how-can-i-feed-a-lexer-bytes-of-data-at-a-time/56979427#56979427", "title": "How can I feed a lexer bytes of data at a time?", "body": "<p>From a comment:</p>\n\n<blockquote>\n  <p><em>The problem is that the stream api only notifies more data by calling the callback meaning that if the previous callback simply didnt return the thread isnt available to call the callback again with the new data</em></p>\n</blockquote>\n\n<p>This comment suggests that the lexing is being done in the context of the callback. The callback must process all of the bytes; there won't be another callback until that callback returns.</p>\n\n<p>Lex (and Yacc) cannot be used in this way. You have to build either a blocking API on top of this input mechanism (wait on some semaphore that his hit by the callback), or else use polling (spin in a loop with some sleep until the API indicates bytes are available).</p>\n\n<p>With Lex and Yacc, it is quite difficult to continue parsing on predictable chunks of input, such that <code>yyparse</code> returns in between them. For example, if you want it so that scanning each top-level definition in a language requires a separate <code>yyparse</code> call. Hacks are required to ensure that the parsing can continue where the previous call left off.</p>\n\n<p>If the input is arbitrarily divided into chunks provided by some callback that don't follow any syntactic boundaries, forget it.</p>\n"}], "owner": {"reputation": 12448, "user_id": 516813, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/76a7c0468617c5faed9b74821f7ae56a?s=128&d=identicon&r=PG&f=1", "display_name": "chacham15", "link": "https://stackoverflow.com/users/516813/chacham15"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 122, "favorite_count": 0, "accepted_answer_id": 56979427, "answer_count": 1, "score": 1, "last_activity_date": 1562797695, "creation_date": 1562736038, "question_id": 56963865, "link": "https://stackoverflow.com/questions/56963865/how-can-i-feed-a-lexer-bytes-of-data-at-a-time", "title": "How can I feed a lexer bytes of data at a time?", "body": "<p>I am trying to adapt a lexer + parser into a streaming interface in my system which has the following interface:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>bool writeData(stream *obj, char *data, size_t length); //lets the stream know of data coming from upstream so that it prepare it to be read from downstream\nvoid read(stream *obj, char *data, size_t length); //read the processed data\nsize_t readLengthAvailable(stream *obj); //return the amount of data available to be read\n</code></pre>\n\n<p>I have a grammar which is implemented with flex + bison as a re-entrant scanner, but the problem that i have is that there doesnt seem to be an interface to feed the lexer pieces of data at a time.</p>\n\n<pre><code>[ \\t]   ; // ignore all whitespace\n[0-9]+\\.[0-9]+  {yylval-&gt;fval = atof(yytext); return T_FLOAT;}\n[0-9]+      {yylval-&gt;ival = atoi(yytext); return T_INT;}\n\\n      {return T_NEWLINE;}\n\"+\"     {return T_PLUS;}\n\"-\"     {return T_MINUS;}\n\"*\"     {return T_MULTIPLY;}\n\"/\"     {return T_DIVIDE;}\n\"(\"     {return T_LEFT;}\n\")\"     {return T_RIGHT;}\n</code></pre>\n\n<pre><code>calculation: line { *(int*)out = $1; $$ = $1; YYACCEPT ; }\n;\n\nline: T_NEWLINE\n    | mixed_expression T_NEWLINE { $$ = (int)$1; }\n    | expression T_NEWLINE { $$ = $1; }\n    | T_QUIT T_NEWLINE { printf(\"bye!\\n\"); exit(0); }\n;\n\nmixed_expression: T_FLOAT                        { $$ = $1; }\n      | mixed_expression T_PLUS mixed_expression     { $$ = $1 + $3; }\n      | mixed_expression T_MINUS mixed_expression    { $$ = $1 - $3; }\n      | mixed_expression T_MULTIPLY mixed_expression { $$ = $1 * $3; }\n      | mixed_expression T_DIVIDE mixed_expression   { $$ = $1 / $3; }\n      | T_LEFT mixed_expression T_RIGHT      { $$ = $2; }\n      | expression T_PLUS mixed_expression       { $$ = $1 + $3; }\n      | expression T_MINUS mixed_expression      { $$ = $1 - $3; }\n      | expression T_MULTIPLY mixed_expression   { $$ = $1 * $3; }\n      | expression T_DIVIDE mixed_expression     { $$ = $1 / $3; }\n      | mixed_expression T_PLUS expression       { $$ = $1 + $3; }\n      | mixed_expression T_MINUS expression      { $$ = $1 - $3; }\n      | mixed_expression T_MULTIPLY expression   { $$ = $1 * $3; }\n      | mixed_expression T_DIVIDE expression     { $$ = $1 / $3; }\n      | expression T_DIVIDE expression       { $$ = $1 / (float)$3; }\n;\n\nexpression: T_INT               { $$ = $1; }\n      | expression T_PLUS expression    { $$ = $1 + $3; }\n      | expression T_MINUS expression   { $$ = $1 - $3; }\n      | expression T_MULTIPLY expression    { $$ = $1 * $3; }\n      | T_LEFT expression T_RIGHT       { $$ = $2; }\n;\n</code></pre>\n\n<p>currently my code to feed data to the parser looks like:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>    FILE* yyin = stdin;\n    int result = 0;\n\n    yyscan_t scanner;\n    yy_lex_init(&amp;scanner);\n    do {\n        result = 0;\n        char *line = NULL;\n        size_t size = 0;\n        if (getline(&amp;line, &amp;size, stdin) == -1) {\n            printf(\"No line\\n\");\n            fflush(0);\n            continue;\n        }\n        yy_scan_bytes(line, size - 2, scanner); // - 2 to remove CRLF\n        int parseResult = yy_parse(scanner, &amp;result);\n        printf(\"[Result (%d)]: %d\\n\", parseResult, result);\n        fflush(0);\n    } while(!feof(yyin));\n</code></pre>\n\n<p>however when I try to do things like \"1 +  CRLF\" followed by \"1\" i would expect to get error followed by 2, but I get syntax error followed by 1.</p>\n\n<pre><code>1    +     1\n[Result (0)]: 2\n1 +\nParse error: syntax error\n[Result (1)]: 0\n1\n[Result (0)]: 1\n</code></pre>\n\n<p>Is there any way to get flex to pick up where it left off?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 1, "user_id": 10176448, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-cVF8-QpD4UA/AAAAAAAAAAI/AAAAAAAAABs/mnUJ_-lTCO0/photo.jpg?sz=128", "display_name": "kahila kalombo", "link": "https://stackoverflow.com/users/10176448/kahila-kalombo"}, "edited": false, "score": 0, "creation_date": 1562735550, "post_id": 56963738, "comment_id": 100464808, "body": "sorry if possible can you please point out redundant code or unnecessary code.  The read line function and the get_next_line functions are the main functions the other functions where just added from other files for clarity"}, {"owner": {"reputation": 19358, "user_id": 3049655, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ZLzeP.jpg?s=128&g=1", "display_name": "Spikatrix", "link": "https://stackoverflow.com/users/3049655/spikatrix"}, "edited": false, "score": 1, "creation_date": 1562735707, "post_id": 56963738, "comment_id": 100464868, "body": "<code>str[strlen(str) + 1] = &#39;\\0&#39;;</code> is wrong because <code>str</code> is not assigned any value, just memory is allocated for it. This means that <code>strlen</code> will go on to search for a NUL-terminator checking uninitialized memory locations invoking Undefined Behavior"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1562735823, "post_id": 56963738, "comment_id": 100464907, "body": "There is no need to cast the return of <code>malloc</code>, it is unnecessary. See: <a href=\"http://stackoverflow.com/q/605845/995714\">Do I cast the result of malloc?</a> E.g. <code>str = malloc(size + 1); if (!str) return (NULL); *str = 0; return (str);</code>"}, {"owner": {"reputation": 1, "user_id": 10176448, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-cVF8-QpD4UA/AAAAAAAAAAI/AAAAAAAAABs/mnUJ_-lTCO0/photo.jpg?sz=128", "display_name": "kahila kalombo", "link": "https://stackoverflow.com/users/10176448/kahila-kalombo"}, "edited": false, "score": 0, "creation_date": 1562735972, "post_id": 56963738, "comment_id": 100464954, "body": "ohh thanks that makes lots of sense"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1562736083, "post_id": 56963738, "comment_id": 100465003, "body": "You can&#39;t <code>strlen(str)</code> when <code>str</code> only contains garbage values. Where does <code>strlen</code> stop? (in other words <code>str</code> doesn&#39;t contain a valid string immediately after a call to <code>malloc</code>) You can use <code>calloc</code> to zero all bytes in the new memory, but that renders <code>strlen(str)</code> unnecessary."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1562740774, "post_id": 56963738, "comment_id": 100466683, "body": "Duplicate of <a href=\"https://stackoverflow.com/questions/56960927/how-can-i-break-up-the-get-next-line-functon-and-also-can-you-help-remove-redund\" title=\"how can i break up the get next line functon and also can you help remove redund\">stackoverflow.com/questions/56960927/&hellip;</a>."}], "answers": [{"comments": [{"owner": {"reputation": 1780, "user_id": 10988580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9885afb3fe782ac4c8e89a3b5904b8f6?s=128&d=identicon&r=PG&f=1", "display_name": "virolino", "link": "https://stackoverflow.com/users/10988580/virolino"}, "edited": false, "score": 0, "creation_date": 1562741706, "post_id": 56963875, "comment_id": 100467106, "body": "<code>str[strlen(str) + 1] = &#39;\\0&#39;;</code> : I was convinced that a series of characters ending with a NULL was actually a string in C!! And that is exactly what the OP is doing - making sure that the parsing will finish at the right character. Will you please explain why your argument is valid? Why is it wrong to count the amount of garbage, as long as it does the job and does nothing bad - out of boundary stuff, over / under-flows... It is definitely inefficient, but efficiency is not the topic of the question. For the second statement, <code>var</code> is not initialized before <code>strlen()</code>, so the answer stands."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "reply_to_user": {"reputation": 1780, "user_id": 10988580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9885afb3fe782ac4c8e89a3b5904b8f6?s=128&d=identicon&r=PG&f=1", "display_name": "virolino", "link": "https://stackoverflow.com/users/10988580/virolino"}, "edited": false, "score": 1, "creation_date": 1562742550, "post_id": 56963875, "comment_id": 100467542, "body": "@virolino This series of characters does not end with NUL, so it is not a string, so you can&#39;t pass it to <code>strlen</code>, which expects a string."}, {"owner": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "reply_to_user": {"reputation": 1780, "user_id": 10988580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9885afb3fe782ac4c8e89a3b5904b8f6?s=128&d=identicon&r=PG&f=1", "display_name": "virolino", "link": "https://stackoverflow.com/users/10988580/virolino"}, "edited": false, "score": 1, "creation_date": 1562748282, "post_id": 56963875, "comment_id": 100470429, "body": "@virolino Let&#39;s put it this way: given <code>char *str = malloc(size + 1); if (!str) return NULL;</code>, what would be the <i>expected</i> result of <code>strlen(str)</code>? Is there any? Why don&#39;t  just use <code>str[size] = &#39;\\0&#39;;</code> or <code>calloc</code>?"}, {"owner": {"reputation": 1780, "user_id": 10988580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9885afb3fe782ac4c8e89a3b5904b8f6?s=128&d=identicon&r=PG&f=1", "display_name": "virolino", "link": "https://stackoverflow.com/users/10988580/virolino"}, "edited": false, "score": 0, "creation_date": 1562748549, "post_id": 56963875, "comment_id": 100470594, "body": "Wow! I was so impressed that OP cared to add a NULL that I did not notice the horror of the <code>strlen()</code>. Sorry for my &quot;slip&quot;, entire answer is actually correct. <code>str[size]</code> would be the correct way to do it, agree. +1"}], "tags": [], "owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "is_accepted": false, "score": 4, "last_activity_date": 1562736103, "creation_date": 1562736103, "answer_id": 56963875, "question_id": 56963738, "link": "https://stackoverflow.com/questions/56963738/my-code-keeps-on-giving-me-segfaults-when-i-try-to-break-it-up-into-three-smalle/56963875#56963875", "title": "my code keeps on giving me segfaults when I try to break it up into three smaller functions", "body": "<p>In both <code>str[strlen(str) + 1] = '\\0';</code> and <code>s = strlen(var.temp) - var.j;</code>, you call <code>strlen</code> on things that are <em>not</em> strings. Only a valid string may be passed to <code>strlen</code>. Look at this code:</p>\n\n<pre><code>str = (char *)malloc(size + 1);\nif (!str)\n    return (NULL);\nstr[strlen(str) + 1] = '\\0';\n</code></pre>\n\n<p>You pass <code>str</code> to <code>strlen</code> even though you just allocated it and it points to a buffer that contains random garbage. You cannot do that. The interface contract for <code>strlen</code> says that you must pass it a pointer to memory that contains a string. Random garbage may or may not be a valid string.</p>\n\n<p>The same is true of <code>var.temp</code> when you pass it to <code>strlen</code>. It doesn't contain a valid string because you haven't placed a valid string in it yet.</p>\n"}], "owner": {"reputation": 1, "user_id": 10176448, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-cVF8-QpD4UA/AAAAAAAAAAI/AAAAAAAAABs/mnUJ_-lTCO0/photo.jpg?sz=128", "display_name": "kahila kalombo", "link": "https://stackoverflow.com/users/10176448/kahila-kalombo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1562739783, "creation_date": 1562735340, "last_edit_date": 1562739783, "question_id": 56963738, "link": "https://stackoverflow.com/questions/56963738/my-code-keeps-on-giving-me-segfaults-when-i-try-to-break-it-up-into-three-smalle", "title": "my code keeps on giving me segfaults when I try to break it up into three smaller functions", "body": "<p>I've tried passing the values by reference. the program reads a single line every time the function get_next_line is called and returns <code>1</code> if a line is found, <code>0</code> if a line is not found and <code>-1</code> for other errors such as failed memory allocation. the code leaks but for now my main problem is breaking up the get_next_line function.</p>\n\n<pre><code>#include \"get_next_line.h\"\n\nchar *ft_strnew(size_t size)\n{\n    char *str;\n\n    str = (char *)malloc(size + 1);\n    if (!str)\n        return (NULL);\n    str[strlen(str) + 1] = '\\0';\n    return (str);\n}\n\nvoid *ft_memset(void *start, int init, size_t size)\n{\n    unsigned char *ptr;\n\n    ptr = (unsigned char*)start;\n    while (size &gt; 0)\n    {\n        *ptr++ = (unsigned char)init;\n        size--;\n    }\n    return (start);\n}\n\nvoid ft_bzero(void *s, size_t size)\n{\n    ft_memset(s, '\\0', size);\n}\n\nchar *ft_strjoin(char const *s1, char const *s2)\n{\n    char    *new;\n    size_t  len;\n\n    if (!s1 || !s2)\n        return (NULL);\n    len = strlen((char *)s1) + strlen((char *)s2);\n    new = (char *)malloc(len + 1);\n    if (!new)\n        return (NULL);\n    while (*s1 != '\\0')\n        *new++ = *s1++;\n    while (*s2 != '\\0')\n        *new++ = *s2++;\n    *new = '\\0';\n    return (new - len);\n}\n\nchar *ft_strdup(const char *str)\n{\n    char    *strdup;\n    int     i;\n\n    strdup = (char *)malloc(strlen(str) + 1);\n    if (strdup == NULL)\n        return (NULL);\n    i = 0;\n    while (str[i] != '\\0')\n    {\n        strdup[i] = str[i];\n        i++;\n    }\n    strdup[i] = '\\0';\n    return (strdup);\n}\n\nstatic char *read_line(int f, int fd, char *buff, char *temp)\n{\n    int i;\n\n    i = 0;\n    while (f &gt; 0)\n    {\n        if (buff[i] == '\\n'){\n            break;\n        }\n        else if (i == BUFF_SIZE)\n        {\n            f = read(fd, buff, BUFF_SIZE);\n            if (f == 0)\n            {\n                if (BUFF_SIZE == 1)\n                    return (temp);      \n                return ((char *)LINE_NOT_FOUND);\n            }\n            temp = ft_strjoin(temp, buff);\n            i = -1;\n        }\n        i++;\n    }\n    return (temp);\n}\n\nint get_next_line(const int fd, char **line)\n{\n    static t_var var;\n    char buff[BUFF_SIZE + 1];\n    char *new;\n    int i;\n    int f = 0;\n    int s = 0;\n    int w = 0;\n    i = 0;\n\n    if (fd &lt;  0 || line == NULL)\n        return (INVALID);\n    ft_bzero(buff, BUFF_SIZE + 1);\n    if (var.j &gt; 0)\n    {\n        new = (char *)malloc(sizeof(char) * (var.j + 1));\n        if (!new)\n            return (INVALID);\n        s = strlen(var.temp) - var.j;\n        f = s;\n        w = var.j;\n        while (var.temp[s] != '\\0')\n        {\n            new[i] = var.temp[s];\n            if (var.temp[s] == '\\n')\n            {\n                if(!(*line = (char *)malloc(sizeof(char) * (i + 1))))\n                    return (INVALID);\n                *line = strncpy(*line, new, i);\n                var.j--;\n                return (LINE_FOUND);\n            }\n            s++;\n            var.j--;\n            i++;\n        }\n        s = f;\n        var.temp = ft_strdup(new);\n    }//first read after this if statement\n    if (w == 0)\n        var.temp = ft_strnew(BUFF_SIZE);\n    f = read(fd, buff, BUFF_SIZE);\n    if (f == 0)\n        return (LINE_NOT_FOUND);\n    var.temp = ft_strjoin(var.temp, buff);\n    var.temp = read_line(f, fd, buff, var.temp);//function call \n    if (var.temp == (char *)LINE_NOT_FOUND)\n        return (0);\n    s = 0;\n    if (var.temp[s])\n    {\n        while (var.temp[s] != '\\n')\n            s++;\n    }\n    s++;\n    if(var.j == 0)\n        *line = (char *)malloc(sizeof(char) * (s + 1));\n    *line = strncat(*line, var.temp, s - 1);\n    var.j = strlen(var.temp) - s;\n    return (LINE_FOUND);\n}\n\n#include &lt;fcntl.h&gt;\nint main(int argc, char **argv)\n{\n    int     fd;\n    char    *line;\n    int     x = 1;\n\n    if (argc &gt; 1)\n    {\n        fd = open(argv[1], O_RDONLY);\n        while (x == 1)\n        {\n            x = get_next_line(fd, &amp;line);\n            if (x &gt; 0)\n                printf(\"%s\\n\", line);\n        }\n        close(fd);\n    }\n    return (0);\n}\n</code></pre>\n"}, {"tags": ["c", "windows", "macos"], "comments": [{"owner": {"reputation": 2988, "user_id": 452414, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rDMfs.png?s=128&g=1", "display_name": "babon", "link": "https://stackoverflow.com/users/452414/babon"}, "edited": false, "score": 1, "creation_date": 1562734595, "post_id": 56963581, "comment_id": 100464577, "body": "<code>ra</code> is local to <code>delete_str()</code> and will / may be cleared when the function returns."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1562736424, "post_id": 56963581, "comment_id": 100465092, "body": "It is not clear why you have the variable <code>a</code> inside the function; you could use a loop condition such as <code>while (str[i] != &#39;\\0&#39;)</code> instead.  As long as you don&#39;t pass a character literal to the function, the <code>strcpy(str, ra);</code> call that you say won&#39;t work should be fine.  Your program is passing a string literal; that should crash on a Mac (and probably on Windows too)."}, {"owner": {"reputation": 61700, "user_id": 5291015, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ZFijZ.jpg?s=128&g=1", "display_name": "Inian", "link": "https://stackoverflow.com/users/5291015/inian"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1562736719, "post_id": 56963581, "comment_id": 100465177, "body": "@JonathanLeffler: Wanted to know your feedback on my answer for educational purposes :) The first or the second approach (making <code>delete_str</code> as <code>void</code>) is valid here?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 61700, "user_id": 5291015, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ZFijZ.jpg?s=128&g=1", "display_name": "Inian", "link": "https://stackoverflow.com/users/5291015/inian"}, "edited": false, "score": 1, "creation_date": 1562736986, "post_id": 56963581, "comment_id": 100465264, "body": "@Inian\u2014 there are a couple of possibilities.  Since the parameter is declared non-const, it is modifiable, and the copying could be done in situ without any intermediate variable <code>ra</code>.  You simply have two indexes into <code>str</code>, and while they&#39;re the same for a couple of iterations (so you copy <code>str[0]</code> over <code>str[0]</code>, which does no harm, even if it also does no good), but then the two diverge.  This function can return <code>void</code>.  The alternative is that the input string is const.  Then you have two options.  You could pass a target string and its size to the delete function, or you could allocate."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1562737103, "post_id": 56963581, "comment_id": 100465315, "body": "If you allocate \u2014 with <code>malloc()</code> or equivalent \u2014 then you return the allocated memory via the function return value.  If you pass the space into the function, it could be <code>void</code>, or you could return the length needed for the copied data, being careful not to write beyond the end of the space provided.  All sorts of ways of doing it, in other words.  But the simplest is an in situ modification, in which case the function can be <code>void delete_every_third_char(char *v)</code>, or thereabouts."}, {"owner": {"reputation": 1, "user_id": 11762871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2055fc21c0e5ff159d458ef97993dbc5?s=128&d=identicon&r=PG&f=1", "display_name": "crunchisimo", "link": "https://stackoverflow.com/users/11762871/crunchisimo"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1563067872, "post_id": 56963581, "comment_id": 100577913, "body": "@JonathanLeffler Thanks for the replies, I did not write the whole code just made some modifications. So, the problem originates from pass the string literal. Would change char *b to char b[] work?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1563068202, "post_id": 56963581, "comment_id": 100577947, "body": "In <code>main()</code>?  Yes. Changing <code>b</code> to an array would work in the sense that you can then safely modify the string."}, {"owner": {"reputation": 1, "user_id": 11762871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2055fc21c0e5ff159d458ef97993dbc5?s=128&d=identicon&r=PG&f=1", "display_name": "crunchisimo", "link": "https://stackoverflow.com/users/11762871/crunchisimo"}, "edited": false, "score": 0, "creation_date": 1563130843, "post_id": 56963581, "comment_id": 100589521, "body": "Yeah, I should have done that from the beginning. I was trying to make the fewest modifications to the original code of my friend. Thanks a lot. I forgot how tricky pointers can get if you don&#39;t use them often."}], "owner": {"reputation": 1, "user_id": 11762871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2055fc21c0e5ff159d458ef97993dbc5?s=128&d=identicon&r=PG&f=1", "display_name": "crunchisimo", "link": "https://stackoverflow.com/users/11762871/crunchisimo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 25, "favorite_count": 0, "closed_date": 1562736119, "answer_count": 0, "score": 0, "last_activity_date": 1562735900, "creation_date": 1562734252, "question_id": 56963581, "link": "https://stackoverflow.com/questions/56963581/char-string-manipulation-works-in-macos-but-returns-gibberish-when-ran-in-window", "closed_reason": "Duplicate", "title": "char string manipulation works in MacOs but returns gibberish when ran in Windows", "body": "<p>I was trying to help someone with their C code where you send a string to a function and it returns a the original string but with each third character removed. Her original issue was trying to modify a string literal. I thought I fixed that and I ran my code and got the correct string. However, I'm on MacOs and she's on Windows, when she ran the code it had the correct string inside the function but the one returned to main printed out gibberish. </p>\n\n<p>I went into Windows, installed Visual Studio and I now I also get gibberish. Is the compiler causing this? Or am I making a dumb mistake(wouldn't be the first time). </p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nchar * delete_str(char *str);\nint main()\n{\n    char  *b = \"I am learning so much in my C programming class.\"; //String literal\n\n    b = delete_str(b); \n    printf(\"The new string in main is: \\n%s\\n\", b);\n    return 0;\n}\n\n//This function (is supposed to) delete every third character of a string and returns the pointer (but crashes instead)\nchar *  delete_str(char *str)\n{\n    int i = 0, j = 0;\n    char *a = str;\n\n    //determine length of string\n    int n = strlen(str);\n\n    /* Changed to a char array of spaces of size n. This way you can modify\n    its contents. String literals cannot be modified with dealing with the \n    alloc functions. Also, I'm not sure if the array iss filled with spaces or \n    just garbage, so don't quote me on that. */\n    char ra [n];// a string of spaces to start\n\n\n    while(*a)\n    {\n        if((i+1)%3 != 0)\n        {\n            ra[j] = str[i]; //we access the char at each position just like an array  \n            j++;\n        }\n        a++;\n        i++;\n    } //end while\n\n    //put the null in at the last element in the ra\n    ra[j] = '\\0'; //the null element is now at the end of the new string\n    printf(\"inside function, ra is: %s\\n\", ra);\n\n    //strcpy(str, ra);  won't work since destination is a pointer apparently\n    /*This could work with the char array, but not with the string literal.*/\n\n    str = ra;\n    return  str;\n}\n\n</code></pre>\n\n<p>inside the function, the new string is in fact \"Delete the c's\" but in main it's just gibberish.</p>\n"}, {"tags": ["c", "arrays", "pointers", "constants", "qa-c"], "comments": [{"owner": {"reputation": 61700, "user_id": 5291015, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ZFijZ.jpg?s=128&g=1", "display_name": "Inian", "link": "https://stackoverflow.com/users/5291015/inian"}, "edited": false, "score": 0, "creation_date": 1562733325, "post_id": 56963446, "comment_id": 100464349, "body": "What is <code>value</code> then? Doesn&#39;t it represent the number of elements to be accessed from <code>x</code>?"}, {"owner": {"reputation": 26680, "user_id": 1806780, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/NCB41.jpg?s=128&g=1", "display_name": "Sami Kuhmonen", "link": "https://stackoverflow.com/users/1806780/sami-kuhmonen"}, "edited": false, "score": 0, "creation_date": 1562733506, "post_id": 56963446, "comment_id": 100464379, "body": "Note that null check doesn\u2019t help anything since contents are not pointers and you\u2019re already accessing the element when doing a comparison. Also nulls have no relation to accessing arrays out of bounds. If the analyzer can\u2019t figure out where the pointer comes from and how much data is allocated where it points to it may warn about it even if it weren\u2019t true"}, {"owner": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "edited": false, "score": 0, "creation_date": 1562733760, "post_id": 56963446, "comment_id": 100464425, "body": "You should check the calling function and a few levels up. Is there a link between the <code>value</code> and the size of the array <code>x</code>? Is it statically known that <code>value</code> will be always less than the size?"}, {"owner": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "edited": false, "score": 0, "creation_date": 1562733971, "post_id": 56963446, "comment_id": 100464465, "body": "Please show examples of how <code>x</code> is allocated.  If using dynamic allocation, polyspace may be picking up on classic programming errors such as <code>x = malloc(value)</code> (instead of <code>value * sizeof(int)</code>) and then issuing this warning as a result."}, {"owner": {"reputation": 7, "user_id": 2513784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc421c1ee8078c5fb21afc3d4eb259f1?s=128&d=identicon&r=PG", "display_name": "Rakesh Menon", "link": "https://stackoverflow.com/users/2513784/rakesh-menon"}, "reply_to_user": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "edited": false, "score": 0, "creation_date": 1562734898, "post_id": 56963446, "comment_id": 100464645, "body": "@RishikeshRaje: <code>value</code> is dynamic and  coming from another interface, and there is no link between size of the array <code>x</code>. We can&#39;t assume the the content of  <code>value</code> to be static."}, {"owner": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "edited": false, "score": 0, "creation_date": 1562735826, "post_id": 56963446, "comment_id": 100464909, "body": "@RakeshMenon How do you ensure that the <code>value</code> is always less than the size of the array? You should consider adding a check for this if the two are independently generated variables."}, {"owner": {"reputation": 7, "user_id": 2513784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc421c1ee8078c5fb21afc3d4eb259f1?s=128&d=identicon&r=PG", "display_name": "Rakesh Menon", "link": "https://stackoverflow.com/users/2513784/rakesh-menon"}, "reply_to_user": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "edited": false, "score": 0, "creation_date": 1562735918, "post_id": 56963446, "comment_id": 100464940, "body": "@RishikeshRaje@paddy <code>x</code> is allocated based on user input, when user gives particular input, the row of a 2D array gets assigned to <code>x</code>. But I cant limit the value with respect to the table size as it is in another module and if some one adds something into that table, it will create a dependency in this module."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1562737500, "post_id": 56963446, "comment_id": 100465454, "body": "Would you avoid the warning if you changed <code>value</code> to an unsigned type such as <code>size_t</code>?  Is the concern that you could be given a negative <code>value</code> and your code does not protect against that misuse of the interface?"}, {"owner": {"reputation": 7, "user_id": 2513784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc421c1ee8078c5fb21afc3d4eb259f1?s=128&d=identicon&r=PG", "display_name": "Rakesh Menon", "link": "https://stackoverflow.com/users/2513784/rakesh-menon"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1562737751, "post_id": 56963446, "comment_id": 100465532, "body": "@JonathanLeffler The <code>value</code> is already declared as unsigned in the actual code, for making an example I just typed int. I will edit the question."}, {"owner": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "edited": false, "score": 0, "creation_date": 1562738415, "post_id": 56963446, "comment_id": 100465778, "body": "@RakeshMenon I am not sure what is the 2D array here or the table, but in general if you have a user input, you should always sanity check the values. e.g. size is from user and user gives a small number for size. then <code>x[value-1]</code> may go out of bounds for the array."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1562738637, "post_id": 56963446, "comment_id": 100465876, "body": "It&#39;s really hard to help when we&#39;re not shown the code that generates the error but something vaguely similar."}], "owner": {"reputation": 7, "user_id": 2513784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc421c1ee8078c5fb21afc3d4eb259f1?s=128&d=identicon&r=PG", "display_name": "Rakesh Menon", "link": "https://stackoverflow.com/users/2513784/rakesh-menon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 917, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1562737796, "creation_date": 1562733060, "last_edit_date": 1562737796, "question_id": 56963446, "link": "https://stackoverflow.com/questions/56963446/how-to-solve-polyspace-warning-array-index-out-of-bounds", "title": "How to solve polyspace warning &quot;array index out of bounds", "body": "<p>While doing Poly-space analysis on the code base, I am getting an orange check warning on below snippet saying that the pointer may be outside its bounds.</p>\n\n<p>I've tried adding a null check before accessing the array like if( x[i] != NULL), but it doesn't help.The pointer which is passed as an argument to the function is also declared as a pointer, so that I'm not able to determine the size of buffer being passed to the function.</p>\n\n<pre><code>void foo(const int *x, unsigned int value)\n{\n   int i, data;\n   for(i=0;i&lt;value;i++)\n   {\n      data = x[i]; // pointer may be out of bounds here\n   }\n   sendToSomeOtherInterface(data);\n}\n</code></pre>\n\n<p>I can understand that polyspace might be assuming that at some point of time, the pointer may point to an invalid memory and code may crash, but how to write code more cleanly to avoid the problem? I can't change usage of pointers as it has an impact over huge files.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 2, "creation_date": 1562732148, "post_id": 56963234, "comment_id": 100464043, "body": "Tony, please provide <a href=\"http://stackoverflow.com/help/mcve\">A Minimal, Complete, and Verifiable Example (MCVE)</a>. You are forking a new process right? It is unclear how you end up at the conditional shown."}, {"owner": {"reputation": 140, "user_id": 11031025, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-G0E69dIUmZc/AAAAAAAAAAI/AAAAAAAAAI0/x45Z7IK0ZAY/photo.jpg?sz=128", "display_name": "Tony Lucas", "link": "https://stackoverflow.com/users/11031025/tony-lucas"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1562741478, "post_id": 56963234, "comment_id": 100466984, "body": "@DavidC.Rankin I think it is not very hard to understand, I still don&#39;t know what to do."}], "answers": [{"comments": [{"owner": {"reputation": 140, "user_id": 11031025, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-G0E69dIUmZc/AAAAAAAAAAI/AAAAAAAAAI0/x45Z7IK0ZAY/photo.jpg?sz=128", "display_name": "Tony Lucas", "link": "https://stackoverflow.com/users/11031025/tony-lucas"}, "edited": false, "score": 0, "creation_date": 1562766492, "post_id": 56966558, "comment_id": 100480618, "body": "thanks, your answer is correct, but do you know how to stop a child process from printing output so that it won&#39;t mess up my next command?"}, {"owner": {"reputation": 131, "user_id": 7790591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e98c9fc4c2a2928d9a7c95a774c8a65?s=128&d=identicon&r=PG&f=1", "display_name": "GMoney", "link": "https://stackoverflow.com/users/7790591/gmoney"}, "reply_to_user": {"reputation": 140, "user_id": 11031025, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-G0E69dIUmZc/AAAAAAAAAAI/AAAAAAAAAI0/x45Z7IK0ZAY/photo.jpg?sz=128", "display_name": "Tony Lucas", "link": "https://stackoverflow.com/users/11031025/tony-lucas"}, "edited": false, "score": 0, "creation_date": 1562827575, "post_id": 56966558, "comment_id": 100501526, "body": "User has made a second question to follow this up at <a href=\"https://stackoverflow.com/questions/56948207/dont-know-how-to-use-tcsetpgrp/56983129#56983129\">link</a>  Please accept this answer if it is correct"}], "tags": [], "owner": {"reputation": 131, "user_id": 7790591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e98c9fc4c2a2928d9a7c95a774c8a65?s=128&d=identicon&r=PG&f=1", "display_name": "GMoney", "link": "https://stackoverflow.com/users/7790591/gmoney"}, "is_accepted": false, "score": 0, "last_activity_date": 1562747495, "creation_date": 1562747495, "answer_id": 56966558, "question_id": 56963234, "link": "https://stackoverflow.com/questions/56963234/how-to-make-my-child-process-run-in-the-background/56966558#56966558", "title": "how to make my child process run in the background?", "body": "<p>According to this answer:</p>\n\n<p><a href=\"https://stackoverflow.com/a/7000742/7790591\">How do I get tcsetpgrp() to work in C?</a></p>\n\n<p>It is not possible to create a child process whilst in the child process already, but rather needs to be called in the parent process.</p>\n"}], "owner": {"reputation": 140, "user_id": 11031025, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-G0E69dIUmZc/AAAAAAAAAAI/AAAAAAAAAI0/x45Z7IK0ZAY/photo.jpg?sz=128", "display_name": "Tony Lucas", "link": "https://stackoverflow.com/users/11031025/tony-lucas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 131, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1562747495, "creation_date": 1562731176, "last_edit_date": 1562741409, "question_id": 56963234, "link": "https://stackoverflow.com/questions/56963234/how-to-make-my-child-process-run-in-the-background", "title": "how to make my child process run in the background?", "body": "<p>I want to send my child process to the background when there is a &amp; symbol at the end.</p>\n\n<p>I tried to do the following code in my child process, currently, the shell has a foreground gid of 1000, and the child also has a foreground group id of 1000. But since now the child has a pgid of 2000, which is not the same as the parent's pgid, it would be easy if I just change my child process's foreground gid to <strong>NOT</strong> be the same as the shell's.</p>\n\n<pre><code>// we are in the child process.\n/* if it is in the background mode, we want to set the child process's\n   foreground id to not be the same as the terminal's foreground id, so\n   that the child process can run in the background. */\n   if(back_signal){\n       tcsetpgrp(0, child_gpid);\n   }\n\n</code></pre>\n\n<p>But, I think the above is wrong, because <em>the function tcsetpgrp() makes the process group with process group ID pgrp the foreground process group on the terminal associated to fd,</em> which means, <code>tcsetpgrp(0, child_gpid)</code> only set the child process to be another foreground process.</p>\n\n<p>In short, I am stuck on how to make a child process running in the background. In addition, I didn't find any source code for fg and bg yet, if you know, please help me.\nThanks in advance.</p>\n"}, {"tags": ["c", "arrays", "struct", "typedef"], "comments": [{"owner": {"reputation": 4400, "user_id": 681444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccf4662e1bc928723d74099d0b51df24?s=128&d=identicon&r=PG&f=1", "display_name": "racraman", "link": "https://stackoverflow.com/users/681444/racraman"}, "edited": false, "score": 4, "creation_date": 1562729647, "post_id": 56963030, "comment_id": 100463591, "body": "On the contrary, keeping related data items together like this is exactly what should be being done."}, {"owner": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "edited": false, "score": 3, "creation_date": 1562729986, "post_id": 56963030, "comment_id": 100463648, "body": "No, but you should remember to allocate the memory for the arrays and free when done. You can even consider making functions to allocate and resize the <code>struct Array</code>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 3, "creation_date": 1562730050, "post_id": 56963030, "comment_id": 100463663, "body": "A length of type <code>size_t</code> will accommodate all array sizes.  <code>long</code> may be excessive - or too small."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 4, "creation_date": 1562731010, "post_id": 56963030, "comment_id": 100463830, "body": "Consider recording two numbers \u2014 the number of elements allocated, and the number in use.  Clearly, the number in use should never exceed the number allocated, but quite often you&#39;ll need to add to an array as you read data, and you don&#39;t want to increase the array size by one every time you read a new number.  You should double the number of allocated elements when you need more space."}, {"owner": {"reputation": 2385, "user_id": 10306503, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31c5d6c9b08dd045f4876591d703bda6?s=128&d=identicon&r=PG", "display_name": "mosvy", "link": "https://stackoverflow.com/users/10306503/mosvy"}, "edited": false, "score": 0, "creation_date": 1562737369, "post_id": 56963030, "comment_id": 100465404, "body": "There&#39;s no problem with that, but that doesn&#39;t declare an array type. This declares some array types: <code>typedef int aint64[64], aint32[32]; ... aint64 foo;</code>. And yes, some people will hate your guts if you do such a thing ;-)"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1562742131, "post_id": 56963030, "comment_id": 100467333, "body": "What Jonathan said, but also, it is not necessary to <i>double</i> the array size each time, just use a fractional factor. And if your array shrinks too, you&#39;d want to use something like <code>N&#47;(2 * factor)</code> for the shrinking guide - shrink the array only below this limit when the original array was N items long. That way you will keep amortized constant time insertions and deletiones to the end."}], "answers": [{"tags": [], "owner": {"reputation": 46, "user_id": 3000741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2cd4ab5e7a4e76e31f0c560ac2f9f67e?s=128&d=identicon&r=PG&f=1", "display_name": "Marthinwurer", "link": "https://stackoverflow.com/users/3000741/marthinwurer"}, "is_accepted": true, "score": 2, "last_activity_date": 1562730990, "creation_date": 1562730990, "answer_id": 56963215, "question_id": 56963030, "link": "https://stackoverflow.com/questions/56963030/is-it-bad-programming-practice-to-declare-an-array-type-in-c/56963215#56963215", "title": "Is it bad programming practice to declare an array type in C?", "body": "<p>No, not necessarily. You will need to pass the length of a buffer around with the pointer to make sure that you don't overrun it. It would be a slight performance hit due to the extra dereference, but that can be a worthwhile tradeoff if always having the length available avoids causing bugs. You would need to make sure that the length gets updated if you resize the buffer, and make sure that the buffer gets freed if you free your struct. Other than that, it makes sense to me, and it's what a lot of other higher-level languages do in their array implementations.</p>\n"}, {"tags": [], "owner": {"reputation": 3759, "user_id": 5362795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50680477fe78fb526c5f28ea7f7dfad5?s=128&d=identicon&r=PG&f=1", "display_name": "Nagev", "link": "https://stackoverflow.com/users/5362795/nagev"}, "is_accepted": false, "score": 1, "last_activity_date": 1562744419, "last_edit_date": 1562744419, "creation_date": 1562743642, "answer_id": 56965485, "question_id": 56963030, "link": "https://stackoverflow.com/questions/56963030/is-it-bad-programming-practice-to-declare-an-array-type-in-c/56965485#56965485", "title": "Is it bad programming practice to declare an array type in C?", "body": "<p>This is fine, a similar structure is commonly used for counted strings, aka vectors, which are not null terminated, hence the need to store their length. I wouldn't bother with this approach if the arrays are only used locally, though.</p>\n\n<p>As it's been noted, it would be better to use an unsigned type such as <code>size_t</code> or <code>uint32_t</code> for the length.</p>\n\n<p>When dealing with pointers one needs to take the usual precautions to ensure that it always has a valid reference before using or passing around, that allocated memory is freed, etc. Using <em>valgrind</em> is highly recommended.</p>\n"}], "owner": {"reputation": 434, "user_id": 5693199, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153748534338959/picture?type=large", "display_name": "Fish11", "link": "https://stackoverflow.com/users/5693199/fish11"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "accepted_answer_id": 56963215, "answer_count": 2, "score": 1, "last_activity_date": 1562744419, "creation_date": 1562729250, "question_id": 56963030, "link": "https://stackoverflow.com/questions/56963030/is-it-bad-programming-practice-to-declare-an-array-type-in-c", "title": "Is it bad programming practice to declare an array type in C?", "body": "<p>I have a bunch of arrays of various lengths and I'd like to keep the length close to the array, is it bad programming practice to define something like this?</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>typedef struct Array {\n  long len;\n  int* buf;\n} Array;\n</code></pre>\n\n<p>Are there any obvious downsides or pitfalls to this? </p>\n"}, {"tags": ["c", "arrays", "string", "char", "scanf"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1562728336, "post_id": 56962777, "comment_id": 100463357, "body": "You use fgets, not scanf."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 11762547, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ivQq6dYgel8/AAAAAAAAAAI/AAAAAAAAANs/qsguDP1kx3A/photo.jpg?sz=128", "display_name": "Jonathan Bailey", "link": "https://stackoverflow.com/users/11762547/jonathan-bailey"}, "edited": false, "score": 0, "creation_date": 1562727993, "post_id": 56962835, "comment_id": 100463294, "body": "This worked perfectly. Thank you. I also found that with visual studio 2019, it doesn&#39;t like you using just scanf(), but if I add &quot;#pragma warning(disable:4996)&quot; (which I found online somewhere when searching for the error it gives me) it allows me to use scanf(), and it works just like you said it would. Much appreciation."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 23, "user_id": 11762547, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ivQq6dYgel8/AAAAAAAAAAI/AAAAAAAAANs/qsguDP1kx3A/photo.jpg?sz=128", "display_name": "Jonathan Bailey", "link": "https://stackoverflow.com/users/11762547/jonathan-bailey"}, "edited": false, "score": 1, "creation_date": 1562728840, "post_id": 56962835, "comment_id": 100463441, "body": "You can also use <code>#define _CRT_SECURE_NO_WARNINGS</code> to disable the warnings about &#39;insecure&#39; functions.  You can also look at the specification of <a href=\"https://docs.microsoft.com/en-us/cpp/c-runtime-library/reference/scanf-s-scanf-s-l-wscanf-s-wscanf-s-l?view=vs-2019\" rel=\"nofollow noreferrer\"><code>scanf_s()</code></a> at the Microsoft Documentation site."}], "tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": true, "score": 1, "last_activity_date": 1562730758, "last_edit_date": 1562730758, "creation_date": 1562727561, "answer_id": 56962835, "question_id": 56962777, "link": "https://stackoverflow.com/questions/56962777/how-do-you-use-scanf-or-scanf-s-to-ask-the-user-for-a-string-of-characters/56962835#56962835", "title": "How do you use scanf() or scanf_s() to ask the user for a string of characters?", "body": "<p>You do it differently when using <code>scanf_s()</code> from the way you do it with <code>scanf()</code>.  You should use:</p>\n\n<pre><code>if (scanf_s(\"%19s\", name, sizeof(name)) == 1)\n{\n    \u2026got valid string\u2026\n}\nelse\n{\n    \u2026error handling\u2026\n}\n</code></pre>\n\n<p>or thereabouts.  With <code>scanf()</code>, you'd omit the <code>sizeof(name)</code> argument.</p>\n\n<p>The <code>\"%19s\"</code> format will skip leading white space and then start saving non-white space characters and stop reading at the first white space character, so typing <code>Jonathan Bailey</code> would only read <code>Jonathan</code> into <code>name</code>.  If you want any characters including spaces, then you need to change the format to <code>\" %19[^\\n]\"</code> (where the space between the quote and the percent is very important) and make sure you read the residue of the line (including the newline) somehow.  The leading space in the format skips leading white space in the input, including newlines.  Do not add trailing white space to the format; that is a UI disaster.</p>\n\n<p>Also, consider the merits of reading an entire line with <code>fgets()</code> and then processing the result \u2014 it avoids some complications.  You could use <code>sscanf()</code> to read the result \u2014 or custom parsing of your own choosing.  Use a big enough buffer:</p>\n\n<pre><code>char buffer[4096];\n\nif (fgets(buffer, sizeof(buffer), stdin) != NULL)\n{\n    buffer[strcspn(buffer, \"\\n\")] = '\\0';  // Zap newline\n    \u2026process line\u2026\n}\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 11762547, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ivQq6dYgel8/AAAAAAAAAAI/AAAAAAAAANs/qsguDP1kx3A/photo.jpg?sz=128", "display_name": "Jonathan Bailey", "link": "https://stackoverflow.com/users/11762547/jonathan-bailey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 132, "favorite_count": 0, "accepted_answer_id": 56962835, "answer_count": 1, "score": 1, "last_activity_date": 1562730758, "creation_date": 1562726908, "question_id": 56962777, "link": "https://stackoverflow.com/questions/56962777/how-do-you-use-scanf-or-scanf-s-to-ask-the-user-for-a-string-of-characters", "title": "How do you use scanf() or scanf_s() to ask the user for a string of characters?", "body": "<p>I will start out by saying that I am new to C and programming in general, and this is the first time I've asked a question about programming online.</p>\n\n<p>I am using Visual Studio 2019.</p>\n\n<p>I am trying to find a way to ask the user for a word, such as their name, and then have it printed out afterwards, like how I feel my following code -should- work.</p>\n\n<p>I've looked around online and all of the examples I have found crash either when I try to run the code, or crash when I type in a word after it asks for a name.\nI have tried using both scanf() and scanf_s().</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nmain()\n{\n    char name[20];\n    printf(\"Enter name: \");\n    scanf_s(\"%s\", name);\n    printf(\"Your name is %s.\", name);\n    system(\"pause\");\n}\n</code></pre>\n\n<p>I expect the output to be \"Your name is (name you typed in).\"\nBut, I can't seem to make it work at all.\nAny help is appreciated.</p>\n"}, {"tags": ["c", "arduino", "microcontroller"], "answers": [{"tags": [], "owner": {"reputation": 2639, "user_id": 7994837, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87d3c6ba4c6f0d695832df4b32b03814?s=128&d=identicon&r=PG&f=1", "display_name": "Delta_G", "link": "https://stackoverflow.com/users/7994837/delta-g"}, "is_accepted": false, "score": 0, "last_activity_date": 1562728444, "creation_date": 1562728444, "answer_id": 56962948, "question_id": 56962670, "link": "https://stackoverflow.com/questions/56962670/stopping-and-starting-loops-in-arduino/56962948#56962948", "title": "Stopping and starting loops in arduino", "body": "<p>I assume that the part you want to run once is in the section at the end in the if(on == true) section.  If you don't want that to repeat, then how about setting on to false in that section.  Then next time loop repeats it won't go into that section.  </p>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 11762504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c59383a65fa34d78f1329d2da7d0b1a7?s=128&d=identicon&r=PG&f=1", "display_name": "McBreez", "link": "https://stackoverflow.com/users/11762504/mcbreez"}, "edited": false, "score": 0, "creation_date": 1562875563, "post_id": 56963143, "comment_id": 100527200, "body": "Thank you sir! very much appreciated!"}], "tags": [], "owner": {"reputation": 4897, "user_id": 6700019, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1ba979f781d106a9db9b35fc6ff518b2?s=128&d=identicon&r=PG", "display_name": "Masoud Rahimi", "link": "https://stackoverflow.com/users/6700019/masoud-rahimi"}, "is_accepted": true, "score": 0, "last_activity_date": 1562730317, "creation_date": 1562730317, "answer_id": 56963143, "question_id": 56962670, "link": "https://stackoverflow.com/questions/56962670/stopping-and-starting-loops-in-arduino/56963143#56963143", "title": "Stopping and starting loops in arduino", "body": "<p>You are making the logic too much complicated. Just read the button state in your loop and if it was <code>HIGH</code> do your motorcycle job. The next time loop runs as you haven't pressed the button it would become <code>LOW</code> and won't go into if statement.</p>\n\n<pre><code>const int pwm_pin = 9;\nconst int dir_1a_pin = 8;\nconst int dir_2a_pin = 7;\nint buttonPin = 2;\n\nvoid MotorCycle()\n{\n    digitalWrite(dir_1a_pin, HIGH);\n    digitalWrite(dir_2a_pin, LOW);\n    analogWrite(pwm_pin, 255);\n    delay(8000);\n\n    digitalWrite(dir_1a_pin, LOW);\n    digitalWrite(dir_2a_pin, HIGH);\n    analogWrite(pwm_pin, 255);\n    delay(12000);\n}\n\nvoid setup()\n{\n    pinMode(buttonPin, INPUT);\n    pinMode(pwm_pin, OUTPUT);\n    pinMode(dir_1a_pin, OUTPUT);\n    pinMode(dir_2a_pin, OUTPUT);\n}\n\nvoid loop()\n{\n    // if button pressed\n    if (digitalRead(buttonPin) == HIGH)\n    {\n        MotorCycle();\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11762504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c59383a65fa34d78f1329d2da7d0b1a7?s=128&d=identicon&r=PG&f=1", "display_name": "McBreez", "link": "https://stackoverflow.com/users/11762504/mcbreez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 56963143, "answer_count": 2, "score": 0, "last_activity_date": 1562730317, "creation_date": 1562725933, "question_id": 56962670, "link": "https://stackoverflow.com/questions/56962670/stopping-and-starting-loops-in-arduino", "title": "Stopping and starting loops in arduino", "body": "<p>I need a motor to cycle forward, then backward when the user pushes a once. the problem is, the arduino will run in loops after it is presses and wont stop.</p>\n\n<p>How can i make it only cycle through once each time the button is pushed?</p>\n\n<p>Ive tried exit(0), stop_it, etc, but those just exit the loop instead of starting back up when the button is pressed another time.</p>\n\n<pre><code>const int pwm_pin = 9;\nconst int dir_1a_pin = 8;\nconst int dir_2a_pin = 7;\nint buttonPin = 2;\nboolean on=false;\nint buttonState = 0;\n\nvoid setup() {\npinMode(buttonPin, INPUT);\npinMode(pwm_pin, OUTPUT);\npinMode(dir_1a_pin, OUTPUT);\npinMode(dir_2a_pin, OUTPUT);\n\n}\n\nvoid loop() {\n\nbuttonState = digitalRead(buttonPin);\n\nif (buttonState == HIGH){\n  if (on==true){\n    on=false;\n  } else{\n    on=true;\n  }\n }\nif(on == true){ \ndigitalWrite(dir_1a_pin, HIGH);\ndigitalWrite(dir_2a_pin, LOW);\nanalogWrite(pwm_pin, 255);\ndelay (8000);\n\ndigitalWrite(dir_1a_pin, LOW);\ndigitalWrite(dir_2a_pin, HIGH);\nanalogWrite(pwm_pin, 255);\ndelay (12000);\n\n}\n}\n</code></pre>\n"}, {"tags": ["c", "windows", "cmd", "tabs"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user10957435"}, "edited": false, "score": 0, "creation_date": 1562725838, "post_id": 56962594, "comment_id": 100462890, "body": "Is this C code, or C++? They are not the same thing. Which one you&#39;re using may affect the answer of some questions."}, {"owner": {"reputation": 1, "user_id": 3340218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22f0172e5c2dffa8c05917d2bbf7a8c0?s=128&d=identicon&r=PG&f=1", "display_name": "Eddy", "link": "https://stackoverflow.com/users/3340218/eddy"}, "edited": false, "score": 1, "creation_date": 1562726761, "post_id": 56962594, "comment_id": 100463061, "body": "Since it&#39;s win32 api, I think it is C code. I will edit the tag."}, {"owner": {"reputation": 29355, "user_id": 205580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460e6e299e385fd46df156c85a1dd55f?s=128&d=identicon&r=PG", "display_name": "Eryk Sun", "link": "https://stackoverflow.com/users/205580/eryk-sun"}, "edited": false, "score": 0, "creation_date": 1562730172, "post_id": 56962594, "comment_id": 100463693, "body": "CMD&#39;s autocomplete is implemented via console functions such as <code>ReadConsoleW</code>, so it only works when CMD is attached to a console and the process <code>StandardInput</code> and <code>StandardOutput</code> are console handles. In Windows 10 you should be able to implement this using a pseudoconsole. In this case, to CMD and child processes, it&#39;s just a regular console connection, but for the console host on the other end (an instance of conhost.exe), instead of rendering output to and reading input from a window, it renders output to and reads input from UTF-8 streams over pipes provided by your application."}], "owner": {"reputation": 1, "user_id": 3340218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22f0172e5c2dffa8c05917d2bbf7a8c0?s=128&d=identicon&r=PG&f=1", "display_name": "Eddy", "link": "https://stackoverflow.com/users/3340218/eddy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1562726779, "creation_date": 1562725184, "last_edit_date": 1562726779, "question_id": 56962594, "link": "https://stackoverflow.com/questions/56962594/is-there-any-way-to-use-autocomplete-with-cmd-created-by-createprocessasuser-in", "title": "Is there any way to use autocomplete with cmd created by CreateProcessAsUser in windows?", "body": "<p>According to <a href=\"https://support.microsoft.com/en-us/help/190351/how-to-spawn-console-processes-with-redirected-standard-handles\" rel=\"nofollow noreferrer\">this example</a>, I spawn a windows cmd.exe with CreateProcessAsUser.</p>\n\n<p>And I redirect its handle to my console application, so my application \nlooks just liked a cmd.exe.</p>\n\n<p>My question is, is there any to let my console application to use the \ntab autocompletion, just like the original cmd.exe ?</p>\n\n<p>What it does now when I press the tab key is only to input the \"tab blank\".</p>\n\n<p>Here is the main code snippet for this example:</p>\n\n<pre><code>  PROCESS_INFORMATION pi;\n  STARTUPINFO si;\n\n  // Set up the start up info struct.\n  ZeroMemory(&amp;si,sizeof(STARTUPINFO));\n  si.cb = sizeof(STARTUPINFO);\n  si.dwFlags = STARTF_USESTDHANDLES;\n  si.hStdOutput = hChildStdOut;\n  si.hStdInput  = hChildStdIn;\n  si.hStdError  = hChildStdErr;\n\n  if(!CreateProcess(NULL,\"C:\\\\Windows\\\\System32\\\\cmd.exe\",NULL,NULL,TRUE,\n                     CREATE_NEW_CONSOLE,NULL,NULL,&amp;si,&amp;pi))\n     DisplayError(\"CreateProcess\");\n\n  // Set global child process handle to cause threads to exit.\n  hChildProcess = pi.hProcess;\n\n  // Close any unnecessary handles.\n  if (!CloseHandle(pi.hThread)) DisplayError(\"CloseHandle\");\n</code></pre>\n"}, {"tags": ["c", "debugging", "gdb"], "comments": [{"owner": {"reputation": 13984, "user_id": 501126, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/839de8a602b21abf36e020bcb32959fe?s=128&d=identicon&r=PG", "display_name": "nemequ", "link": "https://stackoverflow.com/users/501126/nemequ"}, "edited": false, "score": 1, "creation_date": 1562724532, "post_id": 56962432, "comment_id": 100462672, "body": "Try with -fno-builtins.  If that doesn&#39;t work, post the disassembly."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10598786"}, "reply_to_user": {"reputation": 13984, "user_id": 501126, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/839de8a602b21abf36e020bcb32959fe?s=128&d=identicon&r=PG", "display_name": "nemequ", "link": "https://stackoverflow.com/users/501126/nemequ"}, "edited": false, "score": 0, "creation_date": 1562726664, "post_id": 56962432, "comment_id": 100463041, "body": "I posted the disassembly of the code. Hope it helps."}, {"owner": {"reputation": 13984, "user_id": 501126, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/839de8a602b21abf36e020bcb32959fe?s=128&d=identicon&r=PG", "display_name": "nemequ", "link": "https://stackoverflow.com/users/501126/nemequ"}, "edited": false, "score": 0, "creation_date": 1562730048, "post_id": 56962432, "comment_id": 100463662, "body": "It works for me, and it looks like I get basically the same assembly.  Did you try setting the breakpoint on the version compiled with <code>-fno-builtin</code>?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10598786"}, "reply_to_user": {"reputation": 13984, "user_id": 501126, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/839de8a602b21abf36e020bcb32959fe?s=128&d=identicon&r=PG", "display_name": "nemequ", "link": "https://stackoverflow.com/users/501126/nemequ"}, "edited": false, "score": 0, "creation_date": 1562730309, "post_id": 56962432, "comment_id": 100463714, "body": "Yes, still skips the breakpoint."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user10598786"}, "edited": false, "score": 0, "creation_date": 1562730602, "post_id": 56963026, "comment_id": 100463753, "body": "The Os that im using is called &quot;Parrot OS&quot;, which is based on debian, hope this helps. Also, the debugger spits out this error whenever it reaches breakpoint 2, &quot;../sysdeps/x86_64/multiarch/strcpy-sse2-unaligned.S: No such file or directory. &quot;"}, {"owner": {"reputation": 13984, "user_id": 501126, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/839de8a602b21abf36e020bcb32959fe?s=128&d=identicon&r=PG", "display_name": "nemequ", "link": "https://stackoverflow.com/users/501126/nemequ"}, "edited": false, "score": 0, "creation_date": 1562732309, "post_id": 56963026, "comment_id": 100464082, "body": "It&#39;s reaching the breakpoint, you just don&#39;t have debugging symbols for libc installed.  Fedora&#39;s gdb will tell you the exact command you should use to install them, but IIRC on Debian it should be <code>apt-get install libc6-dbg</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10598786"}, "edited": false, "score": 0, "creation_date": 1562732898, "post_id": 56963026, "comment_id": 100464254, "body": "I installed this but it still spits out the same error message."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10598786"}, "edited": false, "score": 0, "creation_date": 1562733691, "post_id": 56963026, "comment_id": 100464415, "body": "The message &quot;Pending breakpoint &quot;strcpy&quot; resolved&quot; does not show up when running the program. This might be an important detail."}, {"owner": {"reputation": 162629, "user_id": 50617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YFykQ.png?s=128&g=1", "display_name": "Employed Russian", "link": "https://stackoverflow.com/users/50617/employed-russian"}, "edited": false, "score": 0, "creation_date": 1562734258, "post_id": 56963026, "comment_id": 100464522, "body": "@highboi I&#39;ve updated the answer. You are now getting the breakpoint you wanted, and should also understand what was happening."}], "tags": [], "owner": {"reputation": 162629, "user_id": 50617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YFykQ.png?s=128&g=1", "display_name": "Employed Russian", "link": "https://stackoverflow.com/users/50617/employed-russian"}, "is_accepted": false, "score": 1, "last_activity_date": 1562734194, "last_edit_date": 1562734194, "creation_date": 1562729224, "answer_id": 56963026, "question_id": 56962432, "link": "https://stackoverflow.com/questions/56962432/gdb-skips-shared-library-breakpoint/56963026#56963026", "title": "GDB skips shared library breakpoint", "body": "<p>You didn't specify your platform. I suspect it's Linux with GLIBC.</p>\n\n<p>The reason GDB behaves this way is that <code>strcpy</code> is not a normal function, but a GNU <code>IFUNC</code>.</p>\n\n<p>Try setting breakpoint on <code>__strcpy_sse2_unaligned</code> and see <a href=\"https://stackoverflow.com/questions/47119328/strcpy-sse2-unaligned-with-fno-builtin\">this</a> answer.</p>\n\n<p><strong>Update:</strong></p>\n\n<blockquote>\n  <p>the debugger spits out this error whenever it reaches breakpoint 2, <code>\"../sysdeps/x86_64/multiarch/strcpy-sse2-unaligned.S: No such file or directory.</code></p>\n</blockquote>\n\n<ol>\n<li>That isn't an error.</li>\n<li>The fact that it reaches that breakpoint confirms that this answer is correct.</li>\n<li>You can simply treat <code>__strcpy_sse2_unaligned</code> as an alias to <code>strcpy</code>. Setting a breakpoint there is (on your system) equivalent to setting it on <code>strcpy</code>.</li>\n</ol>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10598786"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 177, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1562734194, "creation_date": 1562723516, "last_edit_date": 1562726340, "question_id": 56962432, "link": "https://stackoverflow.com/questions/56962432/gdb-skips-shared-library-breakpoint", "title": "GDB skips shared library breakpoint", "body": "<p>Im using a debugger with a simple C program, im trying to set a breakpoint with a shared library, but GDB skips this breakpoint entirely.</p>\n\n<p>Im trying to use GDB with a simple C program to learn about GDB. I set 3 breakpoints, 1 at line 7, one at the strcpy function, and one at line 8. I try to set a breakpoint in my program involving a shared library (specifically \"break strcpy\"), but every time I run the program and press \"c\", the program skips breakpoint 2 entirely</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main() {\n    char str_a[20];\n\n    strcpy(str_a, \"Hello, world!\\n\");\n    printf(str_a);\n}\n</code></pre>\n\n<p>Whenever I run the program in the debugger, it stops normally at breakpoint 1, which is expected, but then whenever I press \"c\" to continue to breakpoint 2, it skips breakpoint 2 entirely and just shows the output breakpoint 3 is supposed to have. Is this something to do with GDB's handling of shared libraries?</p>\n\n<p>EDIT: Here is the disassembly</p>\n\n<pre><code>    0x0000555555555145 &lt;+0&gt;:    push   rbp\n    0x0000555555555146 &lt;+1&gt;:    mov    rbp,rsp\n    0x0000555555555149 &lt;+4&gt;:    sub    rsp,0x20\n    0x000055555555514d &lt;+8&gt;:    lea    rax,[rbp-0x20]\n    0x0000555555555151 &lt;+12&gt;:   lea    rsi,[rip+0xeac]        # 0x555555556004\n    0x0000555555555158 &lt;+19&gt;:   mov    rdi,rax\n    0x000055555555515b &lt;+22&gt;:   call   0x555555555030 &lt;strcpy@plt&gt;\n    0x0000555555555160 &lt;+27&gt;:   lea    rax,[rbp-0x20]\n    0x0000555555555164 &lt;+31&gt;:   mov    rdi,rax\n    0x0000555555555167 &lt;+34&gt;:   mov    eax,0x0\n    0x000055555555516c &lt;+39&gt;:   call   0x555555555040 &lt;printf@plt&gt;\n    0x0000555555555171 &lt;+44&gt;:   mov    eax,0x0\n    0x0000555555555176 &lt;+49&gt;:   leave  \n    0x0000555555555177 &lt;+50&gt;:   ret   \n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 8, "creation_date": 1562720073, "post_id": 56962081, "comment_id": 100461888, "body": "You&#39;re already fouled up. <code>char name[20]</code> and <code>fgets(name, 200, stdin);</code> don&#39;t work, because if you get more than 20 characters you&#39;ve already corrupted memory by writing to memory you didn&#39;t allocate."}, {"owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "edited": false, "score": 1, "creation_date": 1562721257, "post_id": 56962081, "comment_id": 100462096, "body": "Could you please format your code properly? And the plain text out of the format, please"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1562722673, "post_id": 56962081, "comment_id": 100462344, "body": "<code>char name[20];</code> would work much better as <code>char name[200];</code> (<i>Don&#39;t skimp on buffer size!</i>) <code>fgets (..., len, ...)</code> where <code>len</code> can never be greater than buffer size."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1562727161, "post_id": 56962081, "comment_id": 100463136, "body": "Remember that <code>fgets()</code> includes the newline in the string, if there&#39;s enough space. If you supply a string of length 20, you could get 18 characters for the file name, one for the newline, and one for the terminal null. But if you want to know about the user entering more than that, you have to look for the absence of newline, which will tell you that the user typed at least 19 characters plus a newline to send the data to the program. You should read the rest of the line (e.g. <code>{ int c; while ((c = getchar()) != EOF &amp;&amp; c != &#39;\\n&#39;) ; }</code> and try again.  Better to use 4096 for the buffer size."}], "answers": [{"tags": [], "owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "is_accepted": false, "score": 1, "last_activity_date": 1562735239, "last_edit_date": 1562735239, "creation_date": 1562728656, "answer_id": 56962971, "question_id": 56962081, "link": "https://stackoverflow.com/questions/56962081/reading-in-name-of-a-file-using-fgets-and-checking-if-the-string-name-is-longe/56962971#56962971", "title": "Reading in name of a file using &quot;fgets&quot; and checking if the string name is longer then 20 characters make user re enter", "body": "<p>Your code invokes <em>Undefined Behavior</em> if the user enters more than <code>18-characters</code> and presses <kbd>Enter</kbd>. Why? You declare <code>char name[20];</code> meaning there is only storage for <code>20-characters</code> total (including the <em>nul-terminating</em> character). However, you then tell <code>fgets</code> to read up to <code>200</code> characters with <code>fgets(name,200,stdin);</code>.</p>\n\n<p><code>fgets</code> will do just what you told it to do. If your user enters <code>19-characters</code>, <code>fgets</code> will attempt to write <code>21-characters</code> to <code>name</code>, writing beyond the bounds of <code>name</code> and invoking <em>Undefined Behavior</em>.</p>\n\n<p>Why <code>21-characters</code> if the user only enters <code>19-characters</code>?</p>\n\n<p>Recall what occurs when the user presses <kbd>Enter</kbd> indicating end-of-input. <code>fgets</code> (in fact all <em>line-oriented</em> input functions, including POSIX <code>getline</code>) will include the <code>'\\n'</code> in the buffer filled (provided there is sufficient space) -- and you have told <code>fgets</code> there are <code>200-characters</code> available. However, <code>name</code> only has a total of <code>20</code>, e.g.</p>\n\n<pre><code>        20 characters total\n\n first          +---+---+---+---+---+\n   15       ... | . | . | x | \\n| \\0|\n characters     +---+---+---+---+---+\n</code></pre>\n\n<p>To remedy your problem, you must always ensure that your storage <strong>equals or exceeds</strong> the number of characters you tell <code>fgets</code> to read. As a rule of thumb, <em>don't skimp on buffer size</em>. If you plan on reading <code>20-characters</code> as a <code>name</code>, then provide a buffer of at least double the length of the longest name you can find. I'd rather be 10,000 bytes too long and 1-byte to short....</p>\n\n<p>To take input, you control your input loop with the return of your input function (either in the loop conditional, or as a conditional within the loop) that will handle <code>EOF</code>, empty-input, as well as length too long.</p>\n\n<p>When you have certain conditions you want to user input to satisfy, looping continually until the user enter appropriate input (or cancels with <code>EOF</code>) is generally a good approach, e.g.</p>\n\n<pre><code>#define MAXC 256    /* if you need a constant, #define one (or more) */\n...\n    for (;;) {  /* loop continually until good input or user cancels */\n        fputs (\"enter name: \", stdout);     /* prompt */\n        if (!fgets (name, MAXC, stdin)) {   /* handle manual EOF */\n            fputs (\"(user canceled)\\n\", stdout);\n            return 1;\n        }\n        ...\n    }\n</code></pre>\n\n<p>Within the loop, you simply check the length of <code>name</code> with <code>strlen</code> and trim the <code>'\\n'</code> from the end of the buffer. If the length exceeds <code>19-characters</code>, simply handle the error and <code>continue</code> prompting for another entry.</p>\n\n<p>Putting it altogether, you could do something similar to:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\n#define MAXC 256    /* if you need a constant, #define one (or more) */\n#define MAXN  20\n\nint main (void) {\n\n    char name[MAXC] = {0};\n    size_t len = 0;\n\n    for (;;) {  /* loop continually until good input or user cancels */\n        fputs (\"enter name: \", stdout);     /* prompt */\n        if (!fgets (name, MAXC, stdin)) {   /* handle manual EOF */\n            fputs (\"(user canceled)\\n\", stdout);\n            return 1;\n        }\n        len = strlen (name);                /* get length of name */\n        if (len &gt; MAXN || *name == '\\n') {  /* exceeds length or empty */\n            fputs (\"  error: name exceeds 20 char or empty\\n\", stderr);\n            continue;\n        }\n        else {      /* good name, trim \\n, break loop */\n            if (len &amp;&amp; name[len - 1] == '\\n')   /* check last char '\\n' */\n                name[--len] = 0;                /* overwrite '\\n' with \\0 */\n            break;\n        }\n    }\n\n    printf (\"\\nname: %s  (%zu chars)\\n\", name, len);\n\n    return 0;\n}\n</code></pre>\n\n<p>(<strong>note:</strong> above if the user generates a manual <code>EOF</code> with <kbd>Ctrl+d</kbd> or <kbd>Ctrl+z</kbd> on windows, the read stops and the program exits. If the length exceeds the desired length, or if the user simply presses <kbd>Enter</kbd> resulting in the buffer containing only a <code>'\\n'</code> [of empty-string below], an error is generated and the user asked to re-enter the name.)</p>\n\n<p><strong>Example Use/Output</strong></p>\n\n<p>Exercising the input routine, 20-characters are entered, then <kbd>Enter</kbd> alone and finally a valid 19-character string.</p>\n\n<pre><code>$ ./bin/namelen\nenter name: 12345678901234567890\n  error: name exceeds 20 char or empty\nenter name: \n  error: name exceeds 20 char or empty\nenter name: 1234567890123456789\n\nname: 1234567890123456789  (19 chars)\n</code></pre>\n\n<p>You can adjust the length as desired.</p>\n\n<p>If the user cancels at any point, the following is displayed before exit:</p>\n\n<pre><code>$ ./bin/namelen\nenter name: (user canceled)\n</code></pre>\n\n<p>As an alternative to calling <code>strlen</code> and then a manual check whether the <code>'\\n'</code> is included in the buffer, you can make use of <code>strcspn</code> to both obtain the length and trim the trailing <code>'\\n'</code> with, e.g.:</p>\n\n<pre><code>    for (;;) {  /* loop continually until good input or user cancels */\n        fputs (\"enter name: \", stdout);     /* prompt */\n        if (!fgets (name, MAXC, stdin)) {   /* handle manual EOF */\n            fputs (\"(user canceled)\\n\", stdout);\n            return 1;\n        }\n        name[(len = strcspn (name, \"\\n\"))] = 0; /* save len, trim '\\n' */\n        if (len &gt; MAXN - 1 || !*name) {         /* exceeds length/empty */\n            fputs (\"  error: name exceeds 20 char or empty\\n\", stderr);\n            continue;\n        }\n        else        /* good name, break loop */\n            break;\n    }\n</code></pre>\n\n<p>Let me know if you have questions. Rule of thumb - <em>Don't skimp on buffer size!</em></p>\n"}], "owner": {"reputation": 57, "user_id": 9561857, "user_type": "registered", "profile_image": "https://graph.facebook.com/1669956509758091/picture?type=large", "display_name": "Haider Bokhari", "link": "https://stackoverflow.com/users/9561857/haider-bokhari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 350, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1562735239, "creation_date": 1562719588, "last_edit_date": 1562725731, "question_id": 56962081, "link": "https://stackoverflow.com/questions/56962081/reading-in-name-of-a-file-using-fgets-and-checking-if-the-string-name-is-longe", "title": "Reading in name of a file using &quot;fgets&quot; and checking if the string name is longer then 20 characters make user re enter", "body": "<p>I am trying to get the input from the user on the <code>stdin</code>, using <code>fgets()</code>. If the user enters more than 20 characters I have read it again using <code>fgets()</code>. But the second time it simply doesn't read in but repeats the print statement before the <code>fgets</code> and moves on to the code below. I have tried flushing the buffer but it doesn't work.</p>\n\n<p>The whole program reads in from a file after checking and then flips the bits and writes those in another file. That part works fine. I have a while loop checking if the file does not exist and I ask the user to enter again using fgets that works fine too.</p>\n\n<pre><code>FILE *fp,*fp1;\nchar name[20];\n\nprintf(\"File name please\\n\");\nfgets(name,200,stdin);\nwhile (strlen(name) &gt; 19) {\n  name[0] = '\\0';\n  printf (\"Too long please change\\n\");\n  fgets(name,200,stdin);\n}\n\n// posting the other check statement that works fine\nwhile (fp == NULL){\n  printf(\"Re-enter the file name\\n\");\n  fgets(name,2000,stdin);\n  for (i = 0;i &lt; 200; i++){\n    if (name[i] == '\\n'){\n      name[i] = '\\0';\n      break;\n    }\n  }\n</code></pre>\n\n<p>I expected the first while loop to check if the length of the string is more than 19 and take the input from the user again but it is printing the printf statement before the second gets and then moving on.</p>\n"}, {"tags": ["c++", "c", "callback", "function-pointers"], "comments": [{"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 1, "creation_date": 1562718924, "post_id": 56961977, "comment_id": 100461686, "body": "1) Why swearing in the function names? 2) What is <code>callbackMotherFucker</code>? 3) What are those &quot;compilation problems&quot; you experience? Do you get errors? What are those? 4) Please provide <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 1, "creation_date": 1562723668, "post_id": 56961977, "comment_id": 100462524, "body": "Is English your first language?  You do know that those names are expletives in English, right?  English not being your first language and just picking up words from movies maybe an excuse, but just barely."}, {"owner": {"reputation": 33, "user_id": 5277916, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Lf_NS59bbJ0/AAAAAAAAAAI/AAAAAAAAW8U/T5tqI_-SZQI/photo.jpg?sz=128", "display_name": "monovox", "link": "https://stackoverflow.com/users/5277916/monovox"}, "edited": false, "score": 1, "creation_date": 1562724992, "post_id": 56961977, "comment_id": 100462748, "body": "I&#39;m really sorry, but If I was really intend to offend somebody, I would not risk my low (but hard labored) reputation . I would just say what I have to say. And what I have to say is &quot;I need help with a programming problem&quot; that unfortunately leaked to the forum with a bad name. I think we all understand. Thanks to point me that. It was a mistake. I fixed. And I&#39;ll please ask you to think about consider the edit and remove the down vote. It is hard to ask hard things. It is not like &quot;how to print a hello world concatenated with an integer?&quot;. Ok?"}], "answers": [{"tags": [], "owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "is_accepted": false, "score": 0, "last_activity_date": 1562718971, "creation_date": 1562718971, "answer_id": 56962024, "question_id": 56961977, "link": "https://stackoverflow.com/questions/56961977/how-to-use-c-function-pointer-as-parameter-to-a-c-funcion-pointer-callback/56962024#56962024", "title": "How to use C++ Function Pointer as Parameter to a C Funcion Pointer/Callback", "body": "<p>Pay attention to the fact that the last parameter to <code>jack_set_process_callback</code>() is a <code>void *</code>, and it gets passed through to the callback function.</p>\n\n<p>This is a common design pattern with C libraries to make them usable with C++.</p>\n\n<p>What you are going to do is pass <code>this</code> of the object whose method you wish to invoke, as a callback, as the <code>void *</code> with the callback pointer to an <code>extern \"C\"</code> linkage wrapper function that takes the <code>void *</code>, then <code>reinterpret_cast</code>s it back to a class instance pointer, and then invokes its method, something like:</p>\n\n<pre><code>extern \"C\" {\n\nint fwd_callback(jack_nframes_t nframes, void *arg)\n{\n    FormQStudio *p=reintrerpret_cast&lt;FormQStudio *&gt;(arg);\n\n    return p-&gt;theCallback(nframes);\n}\n\n};\n\n// ...\n\nFormQStudio *some_object;\n\n// ...\n\njack_set_process_callback(client, fwd_callback, reinterpret_cast&lt;void *&gt;(some_object));\n</code></pre>\n\n<p>Of course, it's on you to make sure that the <code>some_object</code> still exist and is a valid object, when the callback gets invoked.</p>\n"}, {"comments": [{"owner": {"reputation": 33, "user_id": 5277916, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Lf_NS59bbJ0/AAAAAAAAAAI/AAAAAAAAW8U/T5tqI_-SZQI/photo.jpg?sz=128", "display_name": "monovox", "link": "https://stackoverflow.com/users/5277916/monovox"}, "edited": false, "score": 0, "creation_date": 1562723426, "post_id": 56962127, "comment_id": 100462478, "body": "Thank you very much, @rici for the clarification. I was not aware of that. It does compile well using static member function ."}, {"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 0, "creation_date": 1562724187, "post_id": 56962127, "comment_id": 100462610, "body": "A C and a C++ compiler from the same vendor, targeting the same platform, will normally use the same calling convention for an &quot;ordinary&quot; (to use your description) function. So passing a static member function of a C++ class to C will work, if the types of arguments and return value make sense in both C and C++ (e.g. built-in types on C and C++, trivial C++ class types).   All bets are off, even between C compilers from different vendors, unless there is documented compatibility (which thankfully is common practice on a number of platforms, but is not guaranteed)."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "reply_to_user": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 0, "creation_date": 1562725946, "post_id": 56962127, "comment_id": 100462916, "body": "@peter if the platform abi specifies that c and c++ use the same calling convention, which I think is usual, then it should interop both between languages and between vendors. All I said is that it is not guaranteed, which I think is also your conclusion. If you have a specific edit in mind, I&#39;m certainly open to suggestions."}], "tags": [], "owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "is_accepted": true, "score": 0, "last_activity_date": 1562727016, "last_edit_date": 1562727016, "creation_date": 1562720067, "answer_id": 56962127, "question_id": 56961977, "link": "https://stackoverflow.com/questions/56961977/how-to-use-c-function-pointer-as-parameter-to-a-c-funcion-pointer-callback/56962127#56962127", "title": "How to use C++ Function Pointer as Parameter to a C Funcion Pointer/Callback", "body": "<p><code>FormQStudio::theCallback</code> is not a function. It's a non-static member function, which means that it can only be called through an object of type <code>FormQStudio</code>, a pointer to which is passed as <code>this</code> to the function.</p>\n\n<p>C doesn't know anything about C++ classes or class members. So it's not capable of calling such a function.</p>\n\n<p>Moreover, the <code>&amp;</code> operator applied to <code>FormQStudio::theCallback</code> produces a <a href=\"https://isocpp.org/wiki/faq/pointers-to-members\" rel=\"nofollow noreferrer\">\"pointer-to-member-function\"</a> (PMF), which is not at all the same thing as a pointer to a function. (That's probably why you're seeing compiler errors, although it's hard to know exactly what you tried from the code sample in your question.) So even C++ programs couldn't use that as a stand-alone callback, although they could use the <code>.*</code>/<code>-&gt;*</code> syntax to invoke it with a provided class intance object reference/pointer.. (Note: these days it's better to use <code>std::invoke</code> rather than the rather obscure operators.)</p>\n\n<p>If it turns out that <code>FormQStudio::theCallback</code> doesn't actually use <code>this</code> at all, then make it <code>static</code>. Then you can take its address and use that as a function pointer. (Although I think it's not guaranteed that C and C++ functions have the same calling conventions, so it's conceivable that you could still have problems passing it to a C function expecting a callback.) </p>\n"}], "owner": {"reputation": 33, "user_id": 5277916, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Lf_NS59bbJ0/AAAAAAAAAAI/AAAAAAAAW8U/T5tqI_-SZQI/photo.jpg?sz=128", "display_name": "monovox", "link": "https://stackoverflow.com/users/5277916/monovox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 203, "favorite_count": 0, "accepted_answer_id": 56962127, "answer_count": 2, "score": 0, "last_activity_date": 1562727016, "creation_date": 1562718524, "last_edit_date": 1562724674, "question_id": 56961977, "link": "https://stackoverflow.com/questions/56961977/how-to-use-c-function-pointer-as-parameter-to-a-c-funcion-pointer-callback", "title": "How to use C++ Function Pointer as Parameter to a C Funcion Pointer/Callback", "body": "<p>I do know about C++ lambdas or C function pointers, but I don't know how to mix them together. I already found <a href=\"https://stackoverflow.com/questions/8901882/mixing-c-instance-methods-with-c-callback-functions\">Mixing C++ instance methods with C callback functions</a> , but it does not relies to my needs.</p>\n\n<p>I have a C++ class the include C headers, like these:</p>\n\n<pre><code>extern \"C\" {\n#include &lt;jack/jack.h&gt;\n#include &lt;jack/types.h`enter code here`&gt;\n#include &lt;jack/ringbuffer.h&gt;\n#include &lt;jack/midiport.h&gt;\n}\n#include &lt;QDialog&gt;\n#include &lt;QFile&gt;\n#include &lt;QString&gt;\n#include \"Cliente.h\"\n\nclass FormQStudio : public QDialog\n{\n     Q_OBJECT\n\npublic:\n    explicit FormQStudio(QWidget *parent = nullptr);\n    ~FormQStudio();\n\n    void playMIDIFile(QString file) noexcept(false);\n\n    int theCallback(jack_nframes_t nframes, void *arg);\n};\n</code></pre>\n\n<p>The C headers defines some types :</p>\n\n<pre><code>typedef uint32_t         jack_nframes_t;\ntypedef int  (*JackProcessCallback)(jack_nframes_t nframes, void *arg);\n\nint jack_set_process_callback (jack_client_t *client,\n                   JackProcessCallback process_callback,\n                   void *arg) JACK_OPTIONAL_WEAK_EXPORT;\n</code></pre>\n\n<p>The implementaion of my C++ class needs to pass <code>theCallback(jack_nframes_t nframes, void *arg)</code> as a parameter to C function <code>jack_set_process_callback</code>. But I don't know how to do it.</p>\n\n<pre><code>#include \"FormQStudio.h\"\nFormQStudio::FormQStudio(QWidget *parent) :\n    QDialog(parent),\n    ui(new Ui::FormQStudio)\n{\n    ui-&gt;setupUi(this);\n}\n\nvoid FormQStudio::playMIDIFile(QString file) noexcept(false){\n    smf_t *smf = smf_load(file.toUtf8());\n    smf_event_t *event;\n\n    Cliente *c = new Cliente(\"QStudio\");\n    c-&gt;inicializarCliente( \n       /* HOW TO REFERENCE this-&gt;processJackCallback as a parameter? */\n   );\n\n}\n};\n</code></pre>\n\n<p>The class \"Cliente\" is this:</p>\n\n<pre><code>extern \"C\" {\n#include &lt;jack/jack.h&gt;\n#include &lt;jack/types.h&gt;\n#include &lt;jack/ringbuffer.h&gt;\n#include &lt;jack/midiport.h&gt;\n}\n\n#include &lt;QString&gt;\n#include &lt;QMap&gt;\n\n#include \"ClientePorta.h\"\n#include \"QStageException.h\"\n\nclass Cliente\n{\npublic:\n    Cliente(QString clientName);\n\n    struct MidiMessage {\n        jack_nframes_t  time;\n        int     len;    /* Length of MIDI message, in bytes. */\n        unsigned char   data[3];\n    };\n\n\n    jack_client_t *getClient();\n\n    void conectar(QString portaOrigem, QString clienteDestino, QString portaDestino) noexcept(false);\n\n\n\n    void inicializarCliente(JackProcessCallback callback) noexcept(false);\n\n    void addClientePorta(ClientePorta * cp);\n\n    ClientePorta* getClientePorta(QString nomePorta);\n\n    void sendMIDI(QString outputPortName, jack_nframes_t nframes ) noexcept(false);\n\nprivate:\n    QString clientName;\n    QString inputPortName;\n    QString outputPortName;\n    QMap&lt;QString,ClientePorta*&gt; portas;\n    jack_client_t   *jackClient = NULL;\n\n};\n</code></pre>\n\n<p>The Cliente.cpp is:</p>\n\n<pre><code>#include \"Cliente.h\"\n#include &lt;QDebug&gt;\n\nCliente::Cliente(QString clientName)\n{\n    this-&gt;clientName = clientName;\n}\n\nvoid Cliente::inicializarCliente(JackProcessCallback callback) noexcept(false){\n    jackClient = jack_client_open(clientName.toUtf8().data(), JackNoStartServer, NULL);\n\n    int err = jack_set_process_callback(jackClient, callback , this);\n}\n};\n</code></pre>\n\n<p>I'm ommiting the rest of the implementation since it is not relevant. I'm also not asking about lib jack. The focus is how to pass a C++ function as parameter to a C callback as show above.</p>\n"}, {"tags": ["c", "function-pointers", "function-prototypes"], "answers": [{"tags": [], "owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "is_accepted": false, "score": 10, "last_activity_date": 1607468070, "last_edit_date": 1607468070, "creation_date": 1562715798, "answer_id": 56961715, "question_id": 56961714, "link": "https://stackoverflow.com/questions/56961714/how-can-a-parameter-have-type-but-no-name/56961715#56961715", "title": "How can a parameter have type but no name?", "body": "<p>It can easiest be explained with <em>function prototypes</em>. A function prototype <em>declares</em> a function but does not <em>define</em> it.</p>\n<p>One purpose of prototypes is that it makes it possible with different compilation units. You put the prototypes in a header file and the definition in the source file. This makes it possible to compile an object file. When you then include the header file and link with the object file, you don't need to recompile the functions.</p>\n<p>Another reason is that it allows for one-pass compilation. The compiler only needs to read the source once. Read more about it here: <a href=\"https://pediaa.com/what-is-the-difference-between-single-pass-and-multipass-compiler/\" rel=\"nofollow noreferrer\">https://pediaa.com/what-is-the-difference-between-single-pass-and-multipass-compiler/</a></p>\n<p>They are also useful if you for some reason want two functions to call each other. Consider this example:</p>\n<pre><code>void fun1(void) {\n    fun2();\n}\n\nvoid fun2(void) {\n    fun1();\n}\n</code></pre>\n<p>Sure it would be an endless loop, but the point is that this would not compile. <code>fun2</code> would compile, but when we come to <code>fun1</code> we don't know that <code>fun2</code> exists. The solution is to use function prototypes.</p>\n<pre><code>void fun2(void);\n\nvoid fun1(void) {\n    fun2();\n}\n\nvoid fun2(void) {\n    fun1();\n}\n</code></pre>\n<p>When you see that this is the purpose, it is quite obvious that function prototypes is just a declaration. It does not <em>do</em> anything. The declaration <code>int f(float, char*);</code> simply says that there exists a function with the name <code>f</code>. It returns an <code>int</code>, and it takes <code>float</code> and a <code>char*</code> as argument. So for your question, since it never do anything with the parameters, it does not need to have a name to reference them by. Only the definition does. That's why you can get the compiler error <code>error: parameter name omitted</code>that you posted in the question:</p>\n<p>Your example is not a function, but a function pointer. The same reason applies there. You can make a function pointer point at a function, but it is only the function definition that needs identifiers for the parameters. Read more about function pointers <a href=\"https://stackoverflow.com/q/840501/6699433\">here</a></p>\n<p>You can actually use different names for the parameters in the declaration and definition if you want. One potential use for this (I'm not saying if it is good or bad. Just showing that it's possible) is to use descriptive names for the variables in the prototype but shorter in the definition. This compiles well for example:</p>\n<pre><code>void backwards(const char *inputString, char *outputString);\n\nvoid backwards(const char *is, char *os) {\n    size_t l = strlen(is);\n    for(size_t n=0; n&lt;l; n++)\n        os[l-n-1]=is[n];\n    os[l]='\\0';\n}\n</code></pre>\n<p>One valid reason to to this is that the header file is usually used as an interface, so it makes sense to say that the identifiers have to be more descriptive there. Again, I'm just showing that it is possible and does not say that you should or should not do this.</p>\n<p>While speaking of prototypes, it can be worth mentioning a fact many people don't know. The prototype <code>void f();</code> does NOT declare a function taking no arguments. It declares a function taking an unspecified number of arguments. The correct way to declare a function taking no arguments is <code>void f(void);</code>. This can be important when it comes to function pointers. Look at this example that I copied from another answer I made:</p>\n<pre><code>$ cat main.c \nint foo() { return 0; }\nint bar(int a) { return a; }\n\nint main(void)\n{\n    int (*f)();\n    f=foo;\n    f=bar;\n    int(*g)(void);\n    g=foo;\n    g=bar;\n}\n</code></pre>\n<p>This generates this warning:</p>\n<pre><code>$ gcc main.c \nmain.c: In function \u2018main\u2019:\nmain.c:11:3: warning: assignment to \u2018int (*)(void)\u2019 from incompatible pointer type \u2018int (*)(int)\u2019 [-Wincompatible-pointer-types]\n  g=bar;\n   ^\n</code></pre>\n<p>When it comes to regular function prototypes, you can skip the arguments completely if you wish. This compiles and runs just fine:</p>\n<pre><code>void foo();\n\nint main() {\n    foo(5,6);\n}\n\nvoid foo(int x, int y) {\n    printf(&quot;The sum is: %d\\n&quot;, x+y);\n}\n</code></pre>\n<p>The above does not work in C++, as C++ does not support prototypes with unspecified arguments. In C++, <code>void f();</code> is exactly the same thing as <code>void f(void);</code>. This is the reason why C cannot support function overloading while C++ can.</p>\n<p>Lastly, one compiling example with the snippet you provided:</p>\n<pre><code>// Declaration of function pointer\nint (*function)(int, float);\n// Declaration of function\nint foo(int, float);\n// Definition of function\nint foo(int x, float y) {\n    return x;\n}\n// Assign the function pointer\nfunction = foo;\n</code></pre>\n<h1>TL;DR</h1>\n<p>You can basically declare a function prototype in two (excluding variadic functions) ways:</p>\n<ol>\n<li><code>&lt;return type&gt; &lt;name&gt;();</code> which declares a function with <em>unspecified</em> arguments, and will fit with any function definition with proper name and return type, irregardless of the arguments.</li>\n<li><code>&lt;return type&gt; &lt;name&gt;(&lt;type&gt; [&lt;name&gt;], &lt;type&gt; [&lt;name&gt;] ... );</code> which declare a function with <em>specified</em> argument types. The names are not mandatory, and can be different from those in the definition. The proper way of declaring a function with NO arguments is <code>&lt;return type&gt; &lt;name&gt;(void);</code></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 13264766, "user_type": "registered", "profile_image": "https://graph.facebook.com/176424936750561/picture?type=large", "display_name": "Sushil Gyawali", "link": "https://stackoverflow.com/users/13264766/sushil-gyawali"}, "is_accepted": false, "score": 0, "last_activity_date": 1599135240, "creation_date": 1599135240, "answer_id": 63723451, "question_id": 56961714, "link": "https://stackoverflow.com/questions/56961714/how-can-a-parameter-have-type-but-no-name/63723451#63723451", "title": "How can a parameter have type but no name?", "body": "<p>in function declaration/prototyping the parameter name is optional .Declaration must have parameters data type but identifier name is optional ...</p>\n"}], "owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2318, "favorite_count": 1, "answer_count": 2, "score": 7, "last_activity_date": 1607468070, "creation_date": 1562715798, "last_edit_date": 1562717066, "question_id": 56961714, "link": "https://stackoverflow.com/questions/56961714/how-can-a-parameter-have-type-but-no-name", "title": "How can a parameter have type but no name?", "body": "<p>I saw a question that got marked as a dupe, but one part of the question did not get answered by the dupe, and I did not find a suitable dupe to correct it. So here goes.</p>\n\n<p>I once saw a declaration like this:</p>\n\n<pre><code>int (*function)(int, float);\n</code></pre>\n\n<p>I don't really understand it. It takes two arguments, but they have no name. How does that work? I mean, when declaring a function like this:</p>\n\n<pre><code>int f(int x, int y) {\n    return x+y;\n}\n</code></pre>\n\n<p>How would that even be possible without identifiers? I have noticed that this don't work and even gives a compiler error for the first line saying that </p>\n\n<pre><code>int f(int, int) {\n    return /* What should I even write here? */ ;\n}\n</code></pre>\n\n<p>I get two errors:</p>\n\n<pre><code>f.c:1:7: error: parameter name omitted\n int f(int, int)\n       ^~~\nf.c:1:7: error: parameter name omitted\n int f(int, int)\n            ^~~\n</code></pre>\n"}, {"tags": ["c", "raspberry-pi", "gpio", "wiringpi"], "comments": [{"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 3, "creation_date": 1562709971, "post_id": 56961041, "comment_id": 100460025, "body": "Why do you keep setting the speed in a loop? It should suffice to set it once"}, {"owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "edited": false, "score": 0, "creation_date": 1562710859, "post_id": 56961041, "comment_id": 100460230, "body": "Have you tried different speeds? Maybe it&#39;s the hardware (the motors) that can&#39;t follow the speed"}, {"owner": {"reputation": 69, "user_id": 8424708, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uFYYH.jpg?s=128&g=1", "display_name": "goose", "link": "https://stackoverflow.com/users/8424708/goose"}, "edited": false, "score": 0, "creation_date": 1562715639, "post_id": 56961041, "comment_id": 100461051, "body": "The speed should be set in the line <code>delayMicroseconds(1100);</code> where the value is 1100. But when i change the value, speed doesn&#39;t change"}], "answers": [{"tags": [], "owner": {"reputation": 2348, "user_id": 5820440, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-eQxPRvll8zs/AAAAAAAAAAI/AAAAAAAAFZ8/meZGJQSwVro/photo.jpg?sz=128", "display_name": "Sami Sallinen", "link": "https://stackoverflow.com/users/5820440/sami-sallinen"}, "is_accepted": false, "score": 0, "last_activity_date": 1562733361, "creation_date": 1562733361, "answer_id": 56963479, "question_id": 56961041, "link": "https://stackoverflow.com/questions/56961041/esc-motor-dont-change-speed/56963479#56963479", "title": "ESC motor don&#39;t change speed", "body": "<p>It is hard to achieve good servo/esc control with a busy loop. Even if your program is otherwise correct, the os will at times run other processes and your timing will suffer. </p>\n\n<p>I would recommend using the servoblaster software : <a href=\"https://github.com/richardghirst/PiBits/tree/master/ServoBlaster\" rel=\"nofollow noreferrer\">https://github.com/richardghirst/PiBits/tree/master/ServoBlaster</a> . It uses interrupts and dma hardware in the pi to maintain good accuracy. </p>\n"}, {"comments": [{"owner": {"reputation": 69, "user_id": 8424708, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uFYYH.jpg?s=128&g=1", "display_name": "goose", "link": "https://stackoverflow.com/users/8424708/goose"}, "edited": false, "score": 0, "creation_date": 1562755348, "post_id": 56968957, "comment_id": 100474555, "body": "And it is not entirely clear how to remove the lock from the motors? Maybe someone give a link to the instructions?"}], "tags": [], "owner": {"reputation": 69, "user_id": 8424708, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uFYYH.jpg?s=128&g=1", "display_name": "goose", "link": "https://stackoverflow.com/users/8424708/goose"}, "is_accepted": false, "score": 0, "last_activity_date": 1562755264, "creation_date": 1562755264, "answer_id": 56968957, "question_id": 56961041, "link": "https://stackoverflow.com/questions/56961041/esc-motor-dont-change-speed/56968957#56968957", "title": "ESC motor don&#39;t change speed", "body": "<p>Thanks a lot, I used the pigpio.h library.\nCompile comand: <code>gcc pulse.c -pthread -lpigpio -lrt</code>\nIt is necessary to use the gpioServo <code>function (pin, pulse);</code>\nThe values \u200b\u200bshould be in the range from 1000 to 2000, since when working with these motors a signal with a different time interval is needed, the speed depends on it. From 1000 to 2000 are microseconds. Here is a small diagram:\nBut with PWM SIGNAL, I didn\u2019t quite understand how to change the PWM frequency, or is it 50 by default?</p>\n\n<p><a href=\"https://i.stack.imgur.com/PbsET.png\" rel=\"nofollow noreferrer\">Scheme ESC to Arduino or Raspbarry Pi</a></p>\n\n<p><strong>VERY IMPORTANT!!! WARGNING !!!</strong>\nI highly recommend setting microsecond values \u200b\u200b(speeds) to no more than 1000-1200, as the speed is very high and you can injure yourself. Be careful.</p>\n\n<p>There are still different libraries and other languages, they are presented on this site:</p>\n\n<p><a href=\"https://elinux.org/RPi_GPIO_Code_Samples\" rel=\"nofollow noreferrer\">Other lib and lan</a></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;pigpio.h&gt;\n\nint main(){\n\n    if(gpioInitialise() &lt; 0){\n        fprintf(stderr, \"pigpio initialisation faled\\n\");\n        return 1;\n    }\n\n    gpioSetMode(23, PI_OUTPUT);\n\n    //Unlock ESC\n    gpioServo(23, 1500);\n    time_sleep(1);\n\n    int speed = 1200;        \n\n    while(1){\n        //for(int speed = 1100; speed &lt; 2000; speed+=100){\n            //for(int i = 0; i &lt; 20; i++){\n                gpioServo(23, speed);\n                //time_sleep(0.2);\n            //}\n            //printf(\"us = %d\\n\", speed);\n        //}\n    }\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 69, "user_id": 8424708, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uFYYH.jpg?s=128&g=1", "display_name": "goose", "link": "https://stackoverflow.com/users/8424708/goose"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 98, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1562755264, "creation_date": 1562709777, "question_id": 56961041, "link": "https://stackoverflow.com/questions/56961041/esc-motor-dont-change-speed", "title": "ESC motor don&#39;t change speed", "body": "<p>I connected the motors from the quadcopter to the Raspberry Pi Zero. But when I try to rotate the motor, i.e. setting the speed, it turns out, the motors start spinning very quickly, they can also turn off periodically, and then start spinning again at high speeds. How can I change the speed? And why do they turn off sometimes?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt;\n#include &lt;math.h&gt;\n#include &lt;wiringPi.h&gt;\n\n#define RIGHT_MOTOR 1\n#define LEFT_MOTOR 4\n\nvoid init_ESC(int num);\nvoid set_speed(int num, int speed);\n\nint main ()\n{\n\n  int speed = 3320;\n\n  wiringPiSetup();\n\n  pinMode(RIGHT_MOTOR, PWM_OUTPUT);\n  pinMode(LEFT_MOTOR, OUTPUT);\n\n  //pwmSetMode(PWM_MODE_MS);\n  //pwmSetClock(50 * pow(10, 6) / 1920 / 1024);\n\n  init_ESC(RIGHT_MOTOR);\n  delay(1000);\n\n  while (1)\n  {\n    set_speed(RIGHT_MOTOR, speed);\n    //set_speed(LEFT_MOTOR, speed);\n    //printf(\"speed = %d\\n\", speed);\n\n  }\n\n  return 0;\n}\n\nvoid init_ESC(int num){\n        pwmWrite(num, 0);\n        delay(20);\n        pwmWrite(num, 1024);\n        delay(1);\n}\n\nvoid set_speed(int num, int speed){\n    pwmWrite(num, 0);\n    delay(20);\n    pwmWrite(num, 1024);\n    pwmWrite(num, 0);\n    delay(20);\n    pwmWrite(num, 1024);\n    delayMicroseconds(1100);\n}\n</code></pre>\n"}, {"tags": ["c", "debugging", "gdb"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1562705882, "post_id": 56960386, "comment_id": 100458787, "body": "Line 6 is empty. You can&#39;t break on empty lines."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1562706752, "post_id": 56960386, "comment_id": 100459098, "body": "<i>This line is spit out whenever I try to add breakpoints at all the lines above line 7 as well.</i> At which line above line 7 can a breakpoint be placed? Not at <code>int main()</code> because that is not a function called by C code. Not at <code>char str_a[20];</code> because the stack space is reserved before the function executes. Not at a blank line either."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1562707769, "post_id": 56960386, "comment_id": 100459438, "body": "OT: Prefer using <code>puts(str_a)</code> over <code>printf(str_a)</code>. This <code>f</code> in <code>printf</code>stands for &quot;<i>formatted</i>&quot;. No formatting is done here."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1562710331, "post_id": 56960386, "comment_id": 100460107, "body": "@WeatherVane breakpoints do not have to be set at code called from the c code. It can be set on the main as well"}], "answers": [{"comments": [{"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1562706140, "post_id": 56960429, "comment_id": 100458884, "body": "That&#39;s correct, but nevertheless could gdb claim, that it has set a breakpoint on line 6 instead of line 7. The effect is the same, but it wouldn&#39;t confuse the user and it would seem more consistent."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1562706282, "post_id": 56960429, "comment_id": 100458937, "body": "Ok, you got me there. It&#39;s fine as it is ;)"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1562706307, "post_id": 56960429, "comment_id": 100458942, "body": "@Ctx Consider there is a 100 empty lines in the source. Then GDB claiming to be setting a break on one of these will be confusing as hell."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1562706503, "post_id": 56960429, "comment_id": 100459012, "body": "@EugeneSh. To be honest, I don&#39;t quite get that argument. User asks for bp on line x, gdb confirms bp on line x. Where&#39;s the issue? However, I am aware that this probabl collides with the internal implementation of gdb, where the breakpoint is stored as an opcode address, which in turn is associated with a line number."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 1, "creation_date": 1562706592, "post_id": 56960429, "comment_id": 100459039, "body": "@Ctx The next logical step would be to make it step through empty lines. We don&#39;t want to get there :)"}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1562706677, "post_id": 56960429, "comment_id": 100459070, "body": "@EugeneSh. Yes, I also think, I like it as it is ;)"}], "tags": [], "owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "is_accepted": false, "score": 2, "last_activity_date": 1562706200, "last_edit_date": 1562706200, "creation_date": 1562705939, "answer_id": 56960429, "question_id": 56960386, "link": "https://stackoverflow.com/questions/56960386/gdb-keeps-setting-a-breakpoint-on-line-7-instead-of-the-line-i-specify/56960429#56960429", "title": "GDB keeps setting a breakpoint on line 7 instead of the line i specify", "body": "<p>You can only set a breakpoint where there's something that executes. </p>\n\n<p>Line 6 is blank. It never gets executed. So you can't put a breakpoint there.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10598786"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 208, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1562706200, "creation_date": 1562705738, "question_id": 56960386, "link": "https://stackoverflow.com/questions/56960386/gdb-keeps-setting-a-breakpoint-on-line-7-instead-of-the-line-i-specify", "title": "GDB keeps setting a breakpoint on line 7 instead of the line i specify", "body": "<p>Whenever I set a breakpoint in my c program in gdb, it sets the breakpoint one line after the line I specify in the \"break\" command.</p>\n\n<p>So I want to examine some simple c code just to get me started in debugging in c, I set a breakpoint at line 6 in the code, but it keeps setting the breakpoint on line 7 instead.</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main() {\n    char str_a[20];\n\n    strcpy(str_a, \"Hello, world!\\n\");\n    printf(str_a);\n}\n</code></pre>\n\n<p>I first list the lines of code using \"list\", then I use the command \"break 6\" to add a breakpoint at line 6, I would expect the output to be something like this: \"Breakpoint 1 at 0x000d: file char_array.c, line 6.\" but the output for this command is actually \"Breakpoint 1 at 0x113d: file char_array.c, line 7.\" This line is spit out whenever I try to add breakpoints at all the lines above line 7 as well. Could this be a bug?</p>\n"}, {"tags": ["c", "linux", "windows", "debugging"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1562705740, "post_id": 56960319, "comment_id": 100458737, "body": "What range do you expect <code>Ergebnis</code> to be? You should check what your <code>RAND_MAX</code> is."}, {"owner": {"reputation": 22751, "user_id": 2399879, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UxMS5.jpg?s=128&g=1", "display_name": "Crowman", "link": "https://stackoverflow.com/users/2399879/crowman"}, "edited": false, "score": 7, "creation_date": 1562705759, "post_id": 56960319, "comment_id": 100458749, "body": "<code>RAND_MAX</code> in the C library you&#39;re using on Windows is 32,767, so <code>rand() % (2147483646 - 1 + 1) + 1</code> will generate numbers between 1 and 32,768 inclusive, and your <code>do</code> loop will therefore repeat forever, because you&#39;re telling it to."}, {"owner": {"reputation": 11, "user_id": 11761691, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dwsVu.png?s=128&g=1", "display_name": "Diamond", "link": "https://stackoverflow.com/users/11761691/diamond"}, "edited": false, "score": 0, "creation_date": 1562705941, "post_id": 56960319, "comment_id": 100458807, "body": "What would be a replacement for <code>rand()</code>? Would be great if I could use it on Linux and Windows"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1562706047, "post_id": 56960319, "comment_id": 100458840, "body": "<code>RAND_MAX</code> <i>is</i> on both Linux and Windows. It is standard. It might have different values though."}, {"owner": {"reputation": 22751, "user_id": 2399879, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UxMS5.jpg?s=128&g=1", "display_name": "Crowman", "link": "https://stackoverflow.com/users/2399879/crowman"}, "edited": false, "score": 0, "creation_date": 1562706067, "post_id": 56960319, "comment_id": 100458854, "body": "@Diamond: You&#39;ll need to use a different random number generator. <a href=\"https://stackoverflow.com/questions/822323/how-to-generate-a-random-int-in-c/822361\">This question</a> can get you started."}, {"owner": {"reputation": 11, "user_id": 11761691, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dwsVu.png?s=128&g=1", "display_name": "Diamond", "link": "https://stackoverflow.com/users/11761691/diamond"}, "reply_to_user": {"reputation": 22751, "user_id": 2399879, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UxMS5.jpg?s=128&g=1", "display_name": "Crowman", "link": "https://stackoverflow.com/users/2399879/crowman"}, "edited": false, "score": 0, "creation_date": 1562706579, "post_id": 56960319, "comment_id": 100459037, "body": "@PaulGriffiths Thank you very much, now it did work properly (^.^)"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 11761691, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dwsVu.png?s=128&g=1", "display_name": "Diamond", "link": "https://stackoverflow.com/users/11761691/diamond"}, "edited": false, "score": 0, "creation_date": 1562717059, "post_id": 56961438, "comment_id": 100461330, "body": "Oh nice, I will consider it, thank you very much (^.^)"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1563196973, "post_id": 56961438, "comment_id": 100609107, "body": "Note that the range 0..32767 uses 15-bit numbers, not 16-bit numbers.  It&#39;s the positive part of the range of 16-bit signed values.  The code shown really only generates 30-bit numbers, and bits 15 and 31 will both be zero, always.  A 32-bit random number generator that only generates positive numbers would have bit 15 set and not set randomly, of course."}], "tags": [], "owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "is_accepted": false, "score": 0, "last_activity_date": 1562713565, "last_edit_date": 1562713565, "creation_date": 1562713256, "answer_id": 56961438, "question_id": 56960319, "link": "https://stackoverflow.com/questions/56960319/why-does-the-code-run-on-linux-but-not-on-windows/56961438#56961438", "title": "Why does the Code run on Linux but not on Windows?", "body": "<p>Looks like <code>rand()</code> is only 16 bits in that library. Make it 32 bits by calling it twice:</p>\n\n<pre><code>int rand32() {\n    return rand() ^ (rand() &lt;&lt; 16);\n}\n</code></pre>\n\n<p>Also, consider eliminating the inner duplicate-search loop by using Bob Floyd's algorithm: <a href=\"https://blog.acolyer.org/2018/01/30/a-sample-of-brilliance/\" rel=\"nofollow noreferrer\">https://blog.acolyer.org/2018/01/30/a-sample-of-brilliance/</a></p>\n"}], "owner": {"reputation": 11, "user_id": 11761691, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dwsVu.png?s=128&g=1", "display_name": "Diamond", "link": "https://stackoverflow.com/users/11761691/diamond"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 122, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1562713565, "creation_date": 1562705365, "last_edit_date": 1562706907, "question_id": 56960319, "link": "https://stackoverflow.com/questions/56960319/why-does-the-code-run-on-linux-but-not-on-windows", "title": "Why does the Code run on Linux but not on Windows?", "body": "<p>Well, I wrote a little Program that should generate random values, but no value should be in the output file twice.\nOn Linux it's running perfectly, but on Windows it just runs infinity long on the 32768th value.\nThat means, that cmd is open but nothing really happens from that point.</p>\n\n<p>I already did debug it 30 times by now but it never had any problem (it was hell do debug it)\nI wrote it new, recompiled it, even changed values under it was running through the debugger</p>\n\n<p>Here is the Code:</p>\n\n<pre><code> #include &lt;stdio.h&gt;\n #include &lt;stdlib.h&gt;\n #include &lt;time.h&gt;\n #include &lt;stdbool.h&gt;\n\nint intlen(int[]);\n\nint main(int argc, char *argv[]) {\n    FILE *fp;\n    int percent = 0;\n    int Ergebnis = 0, length = 0, lenNow = 0;\n    bool proof = true;\n    srand(time(NULL));\n    fp = fopen(\"ranGen.txt\", \"w\");\n    length = atoi(argv[1]);\n    int Lookup[length];\n    for (int x = 0; x &lt; length; x++){\n        Lookup[x] = 0;\n    }\n    for (int i = 0; i &lt; length; i++) {\n        do {\n            proof = true;\n            Ergebnis = rand() % (2147483646 - 1 + 1) + 1;\n\n            for (int j = 0; j &lt; length &amp;&amp; Lookup[j] != 0 &amp;&amp; proof != false; j++) {\n                if (Ergebnis == Lookup[j]) {\n                    proof = false;\n                }\n            }\n        }while(proof == false);\n        Lookup[lenNow] = Ergebnis;\n        lenNow++;\n        fprintf(fp,\"%i \",Ergebnis);\n    }\n    return 0;\n}\n</code></pre>\n\n<p>posted everything, but the output because I don't really know where the problem is and I think you will need the most of it reproduce my problem.\nif you compiled it, run it through cmd with something like 50000, so that it is higher than 32768.</p>\n\n<p>(like this: example.exe 50000)</p>\n\n<p>Expected was, that it will create a File named RanGen.txt with 200000 random values (200000 was my test value)</p>\n\n<p>But the output was 32767 Values in the text Document and then the program just did nothing more.</p>\n\n<p>Solution: used <code>rand() % 214748346;</code> instead of <code>rand() % (214748346 - 1 + 1) + 1;</code></p>\n"}, {"tags": ["python", "c", "pycparser"], "comments": [{"owner": {"reputation": 1340, "user_id": 7218062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0e0d5a2d3c49c93f1aafd67adaaca59?s=128&d=identicon&r=PG&f=1", "display_name": "jmq", "link": "https://stackoverflow.com/users/7218062/jmq"}, "edited": false, "score": 0, "creation_date": 1562703566, "post_id": 56959907, "comment_id": 100457958, "body": "Another option is let cscope do the work for you and parse the cscope databases.  This <a href=\"https://stackoverflow.com/questions/6494302/how-to-parse-a-cscopes-database\" title=\"how to parse a cscopes database\">stackoverflow.com/questions/6494302/&hellip;</a> may be useful."}, {"owner": {"reputation": 59, "user_id": 6397938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c47034ec6c684a6ddeba6016df87b03d?s=128&d=identicon&r=PG&f=1", "display_name": "sachet_mittal", "link": "https://stackoverflow.com/users/6397938/sachet-mittal"}, "reply_to_user": {"reputation": 1340, "user_id": 7218062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0e0d5a2d3c49c93f1aafd67adaaca59?s=128&d=identicon&r=PG&f=1", "display_name": "jmq", "link": "https://stackoverflow.com/users/7218062/jmq"}, "edited": false, "score": 0, "creation_date": 1562706661, "post_id": 56959907, "comment_id": 100459065, "body": "Thanks for the suggestion. But I am not sure how to parse the cscope.out file. And If I were to parse, wouldn&#39;t it be better to just parse source code?"}, {"owner": {"reputation": 1340, "user_id": 7218062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0e0d5a2d3c49c93f1aafd67adaaca59?s=128&d=identicon&r=PG&f=1", "display_name": "jmq", "link": "https://stackoverflow.com/users/7218062/jmq"}, "edited": false, "score": 0, "creation_date": 1562707808, "post_id": 56959907, "comment_id": 100459444, "body": "I would think parsing code would be more difficult since you would have to ignore comments and quoted strings as well as handle macros and #ifdefs.  I created a tool years ago which had to store the function trees.  What I did was use the C compiler to generate assembly code for each function and then parse the result.  Since assembly has a generally small instruction set and a fixed format it was much easier to parse than C."}, {"owner": {"reputation": 59, "user_id": 6397938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c47034ec6c684a6ddeba6016df87b03d?s=128&d=identicon&r=PG&f=1", "display_name": "sachet_mittal", "link": "https://stackoverflow.com/users/6397938/sachet-mittal"}, "reply_to_user": {"reputation": 1340, "user_id": 7218062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0e0d5a2d3c49c93f1aafd67adaaca59?s=128&d=identicon&r=PG&f=1", "display_name": "jmq", "link": "https://stackoverflow.com/users/7218062/jmq"}, "edited": false, "score": 0, "creation_date": 1562708372, "post_id": 56959907, "comment_id": 100459594, "body": "pycparser takes care of these things for me. So I don&#39;t have to worry about it. Moving to assembly is my back-up plan which I really want to avoid."}], "answers": [{"comments": [{"owner": {"reputation": 230005, "user_id": 8206, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/fc761ccaf6c0d7d977e2959f9bfebd06?s=128&d=identicon&r=PG", "display_name": "Eli Bendersky", "link": "https://stackoverflow.com/users/8206/eli-bendersky"}, "edited": false, "score": 0, "creation_date": 1562804985, "post_id": 56977444, "comment_id": 100496152, "body": "There is also an example right here: <a href=\"https://github.com/eliben/pycparser/blob/master/examples/func_calls.py\" rel=\"nofollow noreferrer\">github.com/eliben/pycparser/blob/master/examples/func_calls.&zwnj;&#8203;py</a>"}, {"owner": {"reputation": 59, "user_id": 6397938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c47034ec6c684a6ddeba6016df87b03d?s=128&d=identicon&r=PG&f=1", "display_name": "sachet_mittal", "link": "https://stackoverflow.com/users/6397938/sachet-mittal"}, "reply_to_user": {"reputation": 230005, "user_id": 8206, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/fc761ccaf6c0d7d977e2959f9bfebd06?s=128&d=identicon&r=PG", "display_name": "Eli Bendersky", "link": "https://stackoverflow.com/users/8206/eli-bendersky"}, "edited": false, "score": 0, "creation_date": 1562951675, "post_id": 56977444, "comment_id": 100555451, "body": "Thanks. The example is slightly different than what I am looking for. The example lists all the function calls in a file. I want all the function calls in a function definition."}], "tags": [], "owner": {"reputation": 59, "user_id": 6397938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c47034ec6c684a6ddeba6016df87b03d?s=128&d=identicon&r=PG&f=1", "display_name": "sachet_mittal", "link": "https://stackoverflow.com/users/6397938/sachet-mittal"}, "is_accepted": false, "score": 0, "last_activity_date": 1562786996, "creation_date": 1562786996, "answer_id": 56977444, "question_id": 56959907, "link": "https://stackoverflow.com/questions/56959907/getting-all-the-functions-called-in-the-specified-function/56977444#56977444", "title": "Getting all the functions called in the specified function", "body": "<p>I solved it. The below visitor class prints each function call for all the functions in the code base</p>\n\n<pre><code>class Visitor(c_ast.NodeVisitor):\n    def visit_FuncDef(self, node):\n        for stmt in node.body.block_items or []:\n            if isinstance(stmt, c_ast.FuncCall):\n                print (f\"Function {node.decl.name} calls {stmt.name.name}\")\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 59, "user_id": 6397938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c47034ec6c684a6ddeba6016df87b03d?s=128&d=identicon&r=PG&f=1", "display_name": "sachet_mittal", "link": "https://stackoverflow.com/users/6397938/sachet-mittal"}, "edited": false, "score": 0, "creation_date": 1563212732, "post_id": 57026950, "comment_id": 100617305, "body": "Do you mean function definitions within a function definition? Is that even allowed in C?"}, {"owner": {"reputation": 11, "user_id": 5773270, "user_type": "registered", "profile_image": "https://graph.facebook.com/1031512916912780/picture?type=large", "display_name": "Kakarun", "link": "https://stackoverflow.com/users/5773270/kakarun"}, "reply_to_user": {"reputation": 59, "user_id": 6397938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c47034ec6c684a6ddeba6016df87b03d?s=128&d=identicon&r=PG&f=1", "display_name": "sachet_mittal", "link": "https://stackoverflow.com/users/6397938/sachet-mittal"}, "edited": false, "score": 0, "creation_date": 1563285727, "post_id": 57026950, "comment_id": 100643668, "body": "no, i mean funccall in another funccall, or funccall in if statement...or something else."}, {"owner": {"reputation": 59, "user_id": 6397938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c47034ec6c684a6ddeba6016df87b03d?s=128&d=identicon&r=PG&f=1", "display_name": "sachet_mittal", "link": "https://stackoverflow.com/users/6397938/sachet-mittal"}, "edited": false, "score": 0, "creation_date": 1563298826, "post_id": 57026950, "comment_id": 100650739, "body": "Ok. Yeah It works for funccalls in loops, if statements and other blocks.  But I don&#39;t see how it works for funccalls within funccalls. You mean the callees for main should be all the functions which will be called right?"}, {"owner": {"reputation": 11, "user_id": 5773270, "user_type": "registered", "profile_image": "https://graph.facebook.com/1031512916912780/picture?type=large", "display_name": "Kakarun", "link": "https://stackoverflow.com/users/5773270/kakarun"}, "reply_to_user": {"reputation": 59, "user_id": 6397938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c47034ec6c684a6ddeba6016df87b03d?s=128&d=identicon&r=PG&f=1", "display_name": "sachet_mittal", "link": "https://stackoverflow.com/users/6397938/sachet-mittal"}, "edited": false, "score": 0, "creation_date": 1563350072, "post_id": 57026950, "comment_id": 100665973, "body": "<code>outer_func(inner_func(param))</code> in this case, FuncCallVisitor will only visit outer_func if you don&#39;t call self.visit(node.args) or self.generic_visit().  see <a href=\"https://github.com/eliben/pycparser/blob/master/pycparser/c_ast.py#L134\" rel=\"nofollow noreferrer\">link</a>"}, {"owner": {"reputation": 59, "user_id": 6397938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c47034ec6c684a6ddeba6016df87b03d?s=128&d=identicon&r=PG&f=1", "display_name": "sachet_mittal", "link": "https://stackoverflow.com/users/6397938/sachet-mittal"}, "edited": false, "score": 0, "creation_date": 1563475996, "post_id": 57026950, "comment_id": 100722994, "body": "Yes but the <code>inner_func</code> is a FuncCall, not a FuncDef. So the functions called in the inner function won&#39;t be listed."}, {"owner": {"reputation": 11, "user_id": 5773270, "user_type": "registered", "profile_image": "https://graph.facebook.com/1031512916912780/picture?type=large", "display_name": "Kakarun", "link": "https://stackoverflow.com/users/5773270/kakarun"}, "reply_to_user": {"reputation": 59, "user_id": 6397938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c47034ec6c684a6ddeba6016df87b03d?s=128&d=identicon&r=PG&f=1", "display_name": "sachet_mittal", "link": "https://stackoverflow.com/users/6397938/sachet-mittal"}, "edited": false, "score": 0, "creation_date": 1563492541, "post_id": 57026950, "comment_id": 100728418, "body": "<code>int main() {    outer_func(inner_func()) } int outer_func() {} int inner_func() {} </code>  in main function, there are two funccall [outer_func, inner_func].  but if visitor do not visit children, inner_func will be ignore. That&#39;s what i meant."}], "tags": [], "owner": {"reputation": 11, "user_id": 5773270, "user_type": "registered", "profile_image": "https://graph.facebook.com/1031512916912780/picture?type=large", "display_name": "Kakarun", "link": "https://stackoverflow.com/users/5773270/kakarun"}, "is_accepted": false, "score": 1, "last_activity_date": 1563227039, "last_edit_date": 1563227039, "creation_date": 1563103309, "answer_id": 57026950, "question_id": 56959907, "link": "https://stackoverflow.com/questions/56959907/getting-all-the-functions-called-in-the-specified-function/57026950#57026950", "title": "Getting all the functions called in the specified function", "body": "<p>Nested visitor will do.\nVisit FuncCall in FuncDef Visitor like below.</p>\n\n<p>your code will visit only 1-depth funccall.</p>\n\n<pre><code>class FuncCallVisitor(c_ast.NodeVisitor):\n    def __init__(self):\n        self.callees = []  \n    def visit_FuncCall(self, node):\n        self.callees.append(node.name.name)\n\n        # nested funccall\n        if node.args:\n            self.visit(node.args)\n\nclass FuncDefVisitor(c_ast.NodeVisitor):\n    def visit_FuncDef(self, node):\n        fcv = FuncCallVisitor()\n        fcv.visit(node.body)\n\n        print(fcv.callees) # calles has all funccall in this funcdef\n</code></pre>\n"}], "owner": {"reputation": 59, "user_id": 6397938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c47034ec6c684a6ddeba6016df87b03d?s=128&d=identicon&r=PG&f=1", "display_name": "sachet_mittal", "link": "https://stackoverflow.com/users/6397938/sachet-mittal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 380, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1563227039, "creation_date": 1562703130, "question_id": 56959907, "link": "https://stackoverflow.com/questions/56959907/getting-all-the-functions-called-in-the-specified-function", "title": "Getting all the functions called in the specified function", "body": "<p>I am using pycparser to parse a C code. My goal is that given a C code and a function name, list out all the functions called in the specified function.</p>\n\n<p>I looked at the documentation for the pycparser but I couldn't find anything to solve specifically this problem. </p>\n\n<p>I want the same functionality as cscope:</p>\n\n<pre><code>Functions called by this function: ksw_extd2_sse41\n\n  File             Function          Line\n0 ksw2_extd2_sse.c ksw_reset_extz     59 ksw_reset_extz(ez);\n1 ksw2_extd2_sse.c _mm_set1_epi8      64 zero_ = _mm_set1_epi8(0);\n2 ksw2_extd2_sse.c _mm_set1_epi8      65 q_ = _mm_set1_epi8(q);\n3 ksw2_extd2_sse.c _mm_set1_epi8      66 q2_ = _mm_set1_epi8(q2);\n4 ksw2_extd2_sse.c _mm_set1_epi8      67 qe_ = _mm_set1_epi8(q + e);\n5 ksw2_extd2_sse.c _mm_set1_epi8      68 qe2_ = _mm_set1_epi8(q2 + e2);\n6 ksw2_extd2_sse.c _mm_set1_epi8      69 sc_mch_ = _mm_set1_epi8(mat[0]);\n7 ksw2_extd2_sse.c _mm_set1_epi8      70 sc_mis_ = _mm_set1_epi8(mat[1]);\n8 ksw2_extd2_sse.c _mm_set1_epi8      71 sc_N_ = mat[m*m-1] == 0? _mm_set1_epi8(-e2) : _mm_set1_epi8(mat[m*m-1]);\n9 ksw2_extd2_sse.c _mm_set1_epi8      72 m1_ = _mm_set1_epi8(m - 1);\na ksw2_extd2_sse.c kcalloc            92 mem = (uint8_t*)kcalloc(km, tlen_ * 8 + qlen_ + 1, 16);\nb ksw2_extd2_sse.c memset             97 memset(u, -q - e, tlen_ * 16);\nc ksw2_extd2_sse.c memset             98 memset(v, -q - e, tlen_ * 16);\nd ksw2_extd2_sse.c memset             99 memset(x, -q - e, tlen_ * 16);\ne ksw2_extd2_sse.c memset            100 memset(y, -q - e, tlen_ * 16);\n\n* Lines 1-16 of 278, 263 more - press the space bar to display more *\n</code></pre>\n"}, {"tags": ["c", "opencv", "tesseract"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 3, "creation_date": 1562702535, "post_id": 56959738, "comment_id": 100457575, "body": "Sounds like a Masters level research subject."}, {"owner": {"reputation": 144819, "user_id": 2836621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/suHg4.jpg?s=128&g=1", "display_name": "Mark Setchell", "link": "https://stackoverflow.com/users/2836621/mark-setchell"}, "edited": false, "score": 1, "creation_date": 1562702728, "post_id": 56959738, "comment_id": 100457649, "body": "Maybe you could share a sample image please?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1562702907, "post_id": 56959738, "comment_id": 100457707, "body": "How would you tell? It&#39;s a matter of resolution. My inkjet is also a dot printer, and you can see that with a glass. Sometimes people insist on an original document, not a scan, and because the original was printed at perhaps 300 dpi, and the scanner is also 300dpi, there will be interference. Perhaps the low resolution ribbon printer output scans better than the inkjet output."}], "answers": [{"tags": [], "owner": {"reputation": 144819, "user_id": 2836621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/suHg4.jpg?s=128&g=1", "display_name": "Mark Setchell", "link": "https://stackoverflow.com/users/2836621/mark-setchell"}, "is_accepted": false, "score": 1, "last_activity_date": 1562709107, "creation_date": 1562709107, "answer_id": 56960944, "question_id": 56959738, "link": "https://stackoverflow.com/questions/56959738/how-to-identify-that-an-image-comes-from-a-dot-matrix-printer/56960944#56960944", "title": "How to identify that an image comes from a dot matrix printer", "body": "<p>I had a few thoughts and decided to put them down in <strong>ImageMagick</strong> but you can equally do this sort of thing with <strong>OpenCV</strong> and its <code>findContours()</code>.</p>\n\n<p>I used this as an input image:</p>\n\n<p><a href=\"https://i.stack.imgur.com/on0GG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/on0GG.png\" alt=\"enter image description here\"></a></p>\n\n<p>If you erode the black areas a little using morphology (or alternatively  dilate the white, it comes to the same thing) each of the dots will become separated from adjacent ones. If you then do a <em>\"Connected Component Analysis\"</em> you will see that the image has an abnormally large number of very small dots which are roughly the same height as width - characteristic of circles or dots.</p>\n\n<p>Here is the code I used in Terminal to run <strong>ImageMagick</strong>:</p>\n\n<pre><code>magick  dotmatrix.png -threshold 50% -morphology dilate disk:1 \\\n       -define connected-components:verbose=true               \\\n       -connected-components 8 -auto-level result.png\n</code></pre>\n\n<p>The output is this image wherein each detected blob gets a successively brighter shade of white:</p>\n\n<p><a href=\"https://i.stack.imgur.com/1SjDF.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1SjDF.png\" alt=\"enter image description here\"></a></p>\n\n<p>More interesting though is the verbose output, which has one line of output per blob detected in the image. It shows lots of small 2x2, 3x2 and similarly sized dots with an area around 7 pixels, circled in red. I would use this as a base for exploring some more...</p>\n\n<p><a href=\"https://i.stack.imgur.com/KG3sL.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/KG3sL.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 9, "user_id": 8670085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd251484bbb6fd94949883b7d52edaae?s=128&d=identicon&r=PG&f=1", "display_name": "JockyMac", "link": "https://stackoverflow.com/users/8670085/jockymac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 323, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1562709107, "creation_date": 1562702223, "question_id": 56959738, "link": "https://stackoverflow.com/questions/56959738/how-to-identify-that-an-image-comes-from-a-dot-matrix-printer", "title": "How to identify that an image comes from a dot matrix printer", "body": "<p>I am using Tesseract for OCR character recognition using the Charles Weld C# wrapper.  I am pre-processing the images with Open CV.</p>\n\n<p>My issue is that I need to pre-process the image differently if it came from a dot matrix printout.  Is there a way, using OpenCV, to tell that the image was scanned from a dot matrix printout?</p>\n\n<p>I have tried blurring the image once and counting the differences using AbsDiff which is the technique I use to detect if an image needs to be despeckled but there is no consitent result that indicates dot matrix.</p>\n"}, {"tags": ["c", "bash", "csh"], "comments": [{"owner": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 1, "creation_date": 1562703110, "post_id": 56959503, "comment_id": 100457789, "body": "I would shorten this question to &quot;Is there a way to redirect stderr that works in csh?&quot;  Follow the advice given below; ignore csh."}, {"owner": {"reputation": 43, "user_id": 11756787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c65e1b95d1a4a1f24ed3be7409236be?s=128&d=identicon&r=PG&f=1", "display_name": "Kirill Sokolovsky", "link": "https://stackoverflow.com/users/11756787/kirill-sokolovsky"}, "reply_to_user": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 0, "creation_date": 1562709306, "post_id": 56959503, "comment_id": 100459849, "body": "Indeed, realization that <code>&#47;bin&#47;sh</code> cannot point to <code>csh</code> so I should use POSIX (<code>bash</code>-like) syntax for redirection solved the problem! Thanks everyone for the detailed answers!"}, {"owner": {"reputation": 43, "user_id": 11756787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c65e1b95d1a4a1f24ed3be7409236be?s=128&d=identicon&r=PG&f=1", "display_name": "Kirill Sokolovsky", "link": "https://stackoverflow.com/users/11756787/kirill-sokolovsky"}, "reply_to_user": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 0, "creation_date": 1562710199, "post_id": 56959503, "comment_id": 100460081, "body": "The example from @thatotherguy is very useful as, counter to my intuition, <code>system(&quot;some_program &gt; output.txt 2&gt;&amp;1&quot;);</code> has the desired effect when <code>&#47;bin&#47;sh</code> points to <code>dash</code> while <code>system(&quot;some_program 2&gt;&amp;1 &gt; output.txt&quot;);</code> somehow does not redirect <code>stderr</code> to the file."}, {"owner": {"reputation": 43, "user_id": 11756787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c65e1b95d1a4a1f24ed3be7409236be?s=128&d=identicon&r=PG&f=1", "display_name": "Kirill Sokolovsky", "link": "https://stackoverflow.com/users/11756787/kirill-sokolovsky"}, "reply_to_user": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 0, "creation_date": 1562710648, "post_id": 56959503, "comment_id": 100460169, "body": "@WilliamPursell, this would be a slightly different question as it would be <code>csh</code>-specific. Mine was about a portable way to redirect <code>stderr</code> and the correct answer was, indeed, to use the <code>bash</code>-like syntax and forget <code>csh</code>."}, {"owner": {"reputation": 2385, "user_id": 10306503, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31c5d6c9b08dd045f4876591d703bda6?s=128&d=identicon&r=PG", "display_name": "mosvy", "link": "https://stackoverflow.com/users/10306503/mosvy"}, "edited": false, "score": 1, "creation_date": 1562738335, "post_id": 56959503, "comment_id": 100465752, "body": "@KirillSokolovsky every time you have trouble understanding shell redirections think of them as of variable assignments, because that&#39;s how they work, basically: <code>&gt;output 2&gt;&amp;1</code> is <code>fd1=&quot;output.txt&quot;; fd2=fd1</code> and <code>2&gt;&amp;1 &gt;output</code> is <code>fd2=fd1; fd1=&quot;output.txt&quot;</code>. You won&#39;t get confused by the difference between <code>a = &quot;foo&quot;; b = a</code> and <code>b = a; a = &quot;foo&quot;</code> in C, would you? ;-)"}], "answers": [{"tags": [], "owner": {"reputation": 100758, "user_id": 1899640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47374ccb28e4b0d2454b64f7b975bc66?s=128&d=identicon&r=PG", "display_name": "that other guy", "link": "https://stackoverflow.com/users/1899640/that-other-guy"}, "is_accepted": true, "score": 3, "last_activity_date": 1562701931, "creation_date": 1562701931, "answer_id": 56959668, "question_id": 56959503, "link": "https://stackoverflow.com/questions/56959503/is-there-a-way-to-redirect-stderr-to-a-file-that-works-in-bash-csh-and-dash/56959668#56959668", "title": "Is there a way to redirect stderr to a file that works in bash, csh and dash?", "body": "<p>On any POSIX-like system, you can use </p>\n\n<pre><code>system(\"some_program &gt; output.txt 2&gt;&amp;1\");\n</code></pre>\n\n<p>This is because POSIX <code>system</code> is <a href=\"https://pubs.opengroup.org/onlinepubs/9699919799/functions/system.html\" rel=\"nofollow noreferrer\">equivalent to calling <code>sh</code></a>, and POSIX <code>sh</code> <a href=\"https://pubs.opengroup.org/onlinepubs/9699919799/utilities/V3_chap02.html#tag_18_07\" rel=\"nofollow noreferrer\">supports this kind of redirection</a>. This works independently of whether or not a user opening a terminal on the system will see a Csh prompt.</p>\n"}, {"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 4, "last_activity_date": 1562701992, "creation_date": 1562701992, "answer_id": 56959678, "question_id": 56959503, "link": "https://stackoverflow.com/questions/56959503/is-there-a-way-to-redirect-stderr-to-a-file-that-works-in-bash-csh-and-dash/56959678#56959678", "title": "Is there a way to redirect stderr to a file that works in bash, csh and dash?", "body": "<blockquote>\n  <p>How do I redirect stderr (or stdout+stderr) to a file if I don't know which shell (bash, csh, dash) is interpreting my command?</p>\n</blockquote>\n\n<p>You don't.  Bourne-family shells and csh-family shells have different, incompatible syntax for redirecting stderr.  In fact, <code>csh</code> and <code>tcsh</code> do not have a syntax to redirect only stderr at all -- they can redirect it only together with stdout.</p>\n\n<p>If you really could be in any shell at all, then you're pretty much hosed with respect to doing much of anything.  One could imagine an obscure, esoteric shell with completely incompatible syntax.  For that matter, even an unusual configuration of a standard shell could trip you up -- for example if the <code>IFS</code> variable is set to an unusual value in a Bourne-family shell, then you'll have trouble executing any commands that don't take that into account.</p>\n\n<p>If you can count on executing at least simple commands, then you could execute a known shell within the unknown one to process your command, but that oughtn't to be necessary for the case that seems to interest you.</p>\n\n<blockquote>\n  <p>Alternatively, is there a way to tell system() (or some other similar\n  C function?) to use /usr/bin/env bash instead of /bin/sh to interpret\n  the supplied command line?</p>\n</blockquote>\n\n<p>Not on a POSIX-conforming system.  POSIX specifies explicitly that the <code>system()</code> function executes the command by use of <code>/bin/sh -c [the_command]</code>.  But this <em>shouldn't</em> be something to worry about, as <code>/bin/sh</code> <em>should</em> be a conforming POSIX shell, or at least pretty close to one.  Definitely it should be a Bourne-family shell, which both <code>bash</code> and <code>dash</code> are, but <code>tcsh</code> most definitely is not.</p>\n\n<p>The way to redirect the standard error stream in a POSIX shell is to use the <code>2&gt;</code> redirection operator (which is a special case of a more general redirection feature applicable to <em>any</em> file descriptor).  Whatever shell <code>/bin/sh</code> actually is should recognize that syntax, and in particular <code>bash</code> and <code>dash</code> both do:</p>\n\n<pre><code>some_program 2&gt; output.txt\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "is_accepted": false, "score": 6, "last_activity_date": 1562702693, "creation_date": 1562702693, "answer_id": 56959830, "question_id": 56959503, "link": "https://stackoverflow.com/questions/56959503/is-there-a-way-to-redirect-stderr-to-a-file-that-works-in-bash-csh-and-dash/56959830#56959830", "title": "Is there a way to redirect stderr to a file that works in bash, csh and dash?", "body": "<p>You have a mistaken assumption, that <code>/bin/sh</code> can be an \"alternate\" shell like <code>csh</code> that's incompatible with the standard shell syntax. If you had a system setup like that, it would be unusably broken; no shell scripts would work. Pretty much all modern systems attempt to conform, at least superficially, to the POSIX standard, where the <code>sh</code> command processes the Shell Command Language specified in POSIX, which is roughly equivalent to the historical Bourne shell and which <code>bash</code>, <code>dash</code>, <code>ash</code>, etc. (shells which are commonly installed as <code>/bin/sh</code>) are all 99.9% compatible with.</p>\n\n<p>You can completely ignore <code>csh</code> and similar. They're never installed as <code>sh</code>, and only folks who actually want to use them, or who get stuck using them as their interactive shell because some evil sysadmin setup the login shell defaults that way, ever have to care about them.</p>\n"}, {"tags": [], "owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "is_accepted": false, "score": 1, "last_activity_date": 1562709440, "creation_date": 1562709440, "answer_id": 56960997, "question_id": 56959503, "link": "https://stackoverflow.com/questions/56959503/is-there-a-way-to-redirect-stderr-to-a-file-that-works-in-bash-csh-and-dash/56960997#56960997", "title": "Is there a way to redirect stderr to a file that works in bash, csh and dash?", "body": "<p>I think, there is another possibility worth mentioning: You could open the file you want to redirect on stderr in your c-code prior to calling <code>system()</code>. You can <code>dup()</code> the original stderr first, and then restore it again.</p>\n\n<pre><code>fflush(stderr); // Flush pending output\nint saved_stderr = dup(fileno(stderr));\nint fd = open(\"output.txt\", O_RDWR|O_CREAT|O_TRUNC, 0600);\ndup2(fd, fileno(stderr));\nclose(fd);\nsystem(\"some_program\");\ndup2(saved_stderr, fileno(stderr));\nclose(saved_stderr);\n</code></pre>\n\n<p>This should perform the output redirection as you need it.</p>\n"}, {"tags": [], "owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "is_accepted": false, "score": 1, "last_activity_date": 1562874204, "last_edit_date": 1592644375, "creation_date": 1562872306, "answer_id": 56995895, "question_id": 56959503, "link": "https://stackoverflow.com/questions/56959503/is-there-a-way-to-redirect-stderr-to-a-file-that-works-in-bash-csh-and-dash/56995895#56995895", "title": "Is there a way to redirect stderr to a file that works in bash, csh and dash?", "body": "<p>If you don't know the shell.... of course you don't know how to redirect from it, despite of the fact that you can see what value the <code>$SHELL</code> has, and act in consequence:</p>\n<pre><code>char *shell = getenv(&quot;SHELL&quot;);\nif (*shell) { /* no SHELL variable defined */\n    /* ... */\n} else if (!strcmp(shell, &quot;/bin/sh&quot;)) { /* bourne shell */\n    /* ... */\n} /* ... more shells */\n</code></pre>\n<p>Despite of what you say in your question, it is quite unusual to rename <code>/bin/sh</code> to use another shell, as shell scripts use syntax that depends on that.  The only case I know is with <code>bash(1)</code>, and I have seen this only in Linux (and remarkably, last versions of solaris), but the syntax of <code>bash(1)</code> is a superset of the syntax of <code>sh(1)</code>, making it possible to run shell scripts made for <code>sh(1)</code> with it.  Renaming <code>/bin/sh</code> to <code>perl</code> for example, would make your system probably completely unusable, as many system tools depend of <code>/bin/sh</code> to be a bourne compatible shell.</p>\n<p>By the way, the <code>system(3)</code> library function always calls <code>sh(1)</code> as the command interpreter, so there should be no problem to use it, but there's no solution to capture the output and process it by the parent process (indeed, the parent process is the <code>sh(1)</code> that <code>system(3)</code> <code>fork(2)</code>s)</p>\n<p>Another thing you can do is to <code>popen(3)</code> a process.  This call gives you a <code>FILE</code> pointer to a pipe of a process.  You popen its input in case you <code>popen(3)</code> it for writing, and you popen its output if you want or read its output.  Look at the manual for details, as I don't know now if it redirects only its standard output or it also redirects the standard error (I think only redirects standard output, for reasons discussed below, and only if you <code>popen(3)</code> it with a <code>&quot;r&quot;</code> flag).</p>\n<pre><code>FILE *f_in = popen(&quot;ps aux&quot;, &quot;r&quot;);\n/* read standard output of 'ps aux' command. */\npclose(f_in);  /* closes the descriptor and waits for the child to finish */\n</code></pre>\n<p>Another thing you can do is to redirect yourself after <code>fork(2)</code>ing the child, and before the <code>exec(2)</code> call  (this way you can decide if you want only <code>stdout</code> or if you want also <code>stderr</code> redirected back to you):</p>\n<pre><code>int fd[2];\nint res = pipe(fd);\nif (res &lt; 0) {\n    perror(&quot;pipe&quot;);\n    exit(EXIT_FAILURE);\n}\nif ((res = fork()) &lt; 0) {\n    perror(&quot;fork&quot;);\n    exit(EXIT_FAILURE);\n} else if (res == 0) { /* child process */\n    dup2(fd[1], 1); /* redirect pipe to stdout */\n    dup2(fd[1], 2); /* redirect pipe also to stderr */\n    close(fd[1]); close(fd[0]); /* we don't need these */\n    execvp(program, argv);\n    perror(&quot;execvp&quot;);\n    exit(EXIT_FAILURE);\n} else { /* parent process */\n    close(fd[1]); /* we are not going to write in the pipe */\n    FILE *f_in = fdopen(fd[0]);\n    /* read standard output and standard error from program from f_in FILE descriptor */\n    fclose(f_in);\n    wait(NULL); /* wait for child to finish */\n}\n</code></pre>\n<p>You can see a complete example of this (not reading standard error, but it is easy to add --- you have only to add the second dup2() call from above) <a href=\"https://github.com/mojadita/cont.git\" rel=\"nofollow noreferrer\">here</a>.  The program executes repeatedly a command you pass to it on the command line.  It needs to get access to the output of the subprocess to count the lines, as between invocations, the program goes up as many lines as the program output, to make the next invocation to overlap the output of the last invocation.  You can try it and play, making modifications as you like.</p>\n<h1>NOTE</h1>\n<p>In your sample redirection, when you use <code>&gt;&amp;</code>, you need to add a number after the ampersand, to indicate which descriptor you are <code>dup()</code>ing.  As the number before the <code>&gt;</code> is optional, the one after the <code>&amp;</code> is mandatory.  So, if you have not used it, prepare to receive an error (which probably you don't see if you are redirecting <code>stderr</code>)  The idea of having two separate output descriptors is to allow you to redirect <code>stdout</code> and at the same time, conserve a channel where to put error messages.</p>\n"}], "owner": {"reputation": 43, "user_id": 11756787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c65e1b95d1a4a1f24ed3be7409236be?s=128&d=identicon&r=PG&f=1", "display_name": "Kirill Sokolovsky", "link": "https://stackoverflow.com/users/11756787/kirill-sokolovsky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 375, "favorite_count": 0, "accepted_answer_id": 56959668, "answer_count": 5, "score": 4, "last_activity_date": 1562874204, "creation_date": 1562701023, "question_id": 56959503, "link": "https://stackoverflow.com/questions/56959503/is-there-a-way-to-redirect-stderr-to-a-file-that-works-in-bash-csh-and-dash", "title": "Is there a way to redirect stderr to a file that works in bash, csh and dash?", "body": "<p>How do I redirect <code>stderr</code> (or <code>stdout</code>+<code>stderr</code>) to a file if I don't know which shell (<code>bash</code>, <code>csh</code>, <code>dash</code>) is interpreting my command?</p>\n\n<p>My C code running on Linux/FreeBSD/OSX needs to call an external program via the <code>system()</code> function, which will use <code>/bin/sh</code> to interpret the supplied command line. I would like to capture the messages printed by that external program to <code>stderr</code> and save them to a file. The problem is that on different systems <code>/bin/sh</code> points to different shells that have different syntax for redirecting the <code>stderr</code> stream to a file.</p>\n\n<p>The closest thing I found is that bash actually understands the <code>csh</code>-style syntax for redirecting <code>stderr</code>+<code>stdout</code> to a file: </p>\n\n<pre><code>some_program &gt;&amp; output.txt\n</code></pre>\n\n<p>but <code>dash</code>, which is the default shell on Ubuntu (i.e. very common), does not understand this syntax.</p>\n\n<p>Is there a syntax for <code>stderr</code> redirection that would be correctly interpreted by all common shells? Alternatively, is there a way to tell <code>system()</code> (or some other similar C function?) to use <code>/usr/bin/env bash</code> instead of <code>/bin/sh</code> to interpret the supplied command line?</p>\n"}, {"tags": ["c#", "c", "pinvoke"], "comments": [{"owner": {"reputation": 30819, "user_id": 47589, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/16703987f5d8e44af08a28f4942ec0f1?s=128&d=identicon&r=PG", "display_name": "Rainbow Dash", "link": "https://stackoverflow.com/users/47589/rainbow-dash"}, "edited": false, "score": 1, "creation_date": 1562704054, "post_id": 56959296, "comment_id": 100458132, "body": "What I&#39;ve done in the past is, if you can find a WINAPI function with a similar signature, <a href=\"https://pinvoke.net/\" rel=\"nofollow noreferrer\">pinvoke.net</a> will give you the approximate code.  Big <i>if</i> maybe, but it&#39;s worked for me so far.  In your case, I don&#39;t think the <code>ref</code> keyword is warranted."}, {"owner": {"reputation": 235601, "user_id": 60761, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5bf43bae0431d8f4a062234b5e3a0cb9?s=128&d=identicon&r=PG&f=1", "display_name": "Henk Holterman", "link": "https://stackoverflow.com/users/60761/henk-holterman"}, "edited": false, "score": 0, "creation_date": 1562704977, "post_id": 56959296, "comment_id": 100458446, "body": "I find that <code>ref</code> looking a little out of place too. It shoud probably be an <code>IntPtr*</code> . But I&#39;m no interop expert."}, {"owner": {"reputation": 116623, "user_id": 403671, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/454HU.jpg?s=128&g=1", "display_name": "Simon Mourier", "link": "https://stackoverflow.com/users/403671/simon-mourier"}, "edited": false, "score": 0, "creation_date": 1562709618, "post_id": 56959296, "comment_id": 100459943, "body": "Since C allocates, just declare as <code>out IntPtr listPtr</code> not ref. Then Marshal.PtrToStructure on the returned pointer. Don&#39;t forget to add StructLayout Sequential to the struct: <a href=\"https://docs.microsoft.com/en-us/dotnet/api/system.runtime.interopservices.layoutkind?view=netframework-4.8\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/dotnet/api/&hellip;</a> also since C doesn&#39;t use a .NET-compatible allocator, you must provide to .NET side a free DLL export as well for the allocated structure."}], "owner": {"reputation": 95, "user_id": 768492, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YEZYz.jpg?s=128&g=1", "display_name": "Tylor Pater", "link": "https://stackoverflow.com/users/768492/tylor-pater"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1562699919, "creation_date": 1562699919, "question_id": 56959296, "link": "https://stackoverflow.com/questions/56959296/how-to-get-result-from-void-pointer-pointer-in-c-p-invoke", "title": "How to get result from void pointer pointer in C# P/Invoke", "body": "<p>I'm trying to write a C# wrapper around the Windows candlelight library and I've gotten stuck on this function:</p>\n\n<pre><code>typedef void* candle_list_handle;\n\nDLL bool __stdcall candle_list_scan(candle_list_handle *list);\n\n</code></pre>\n\n<p>Here is what I have tried:</p>\n\n<pre><code>        [DllImport(\"candle_api.dll\", CallingConvention = CallingConvention.StdCall)]\n        public static extern bool candle_list_scan(ref IntPtr listPtr);\n\n        public candle_list_t? Scan()\n        {\n            IntPtr ptr = new IntPtr();\n            var res = candle_list_scan(ref ptr);\n\n            var list = Marshal.PtrToStructure&lt;candle_list_t&gt;(ptr);\n\n\n            if (res)\n            {\n                return list;\n            }\n            else\n                return null;\n        }\n</code></pre>\n\n<p>I also tried:</p>\n\n<pre><code>        [DllImport(\"candle_api.dll\", CallingConvention = CallingConvention.StdCall)]\n        public static extern bool candle_list_scan(ref IntPtr listPtr);\n\n        public candle_list_t? Scan()\n        {\n            IntPtr ptr = new IntPtr();\n            var res = candle_list_scan(ref ptr);\n\n            var list = Marshal.PtrToStructure&lt;candle_list_t&gt;(ptr);\n\n            if (res)\n            {\n                return list;\n            }\n            else\n                return null;\n        }\n</code></pre>\n\n<p>But neither have worked properly. Here is the C code where it sets the list:</p>\n\n<pre><code>\nbool __stdcall candle_list_scan(candle_list_handle *list)\n{\n    if (list==NULL) {\n        return false;\n    }\n\n    candle_list_t *l = (candle_list_t *)calloc(1, sizeof(candle_list_t));\n    *list = l;\n    if (l==NULL) {\n        return false;\n    }\n....\n</code></pre>\n\n<p>and candle_list_t is:</p>\n\n<pre><code>\ntypedef struct {\n    uint8_t num_devices;\n    candle_err_t last_error;\n    candle_device_t dev[CANDLE_MAX_DEVICES];\n} candle_list_t;\n</code></pre>\n\n<p>which I converted to</p>\n\n<pre><code>\n    public struct candle_list_t\n    {\n        public byte num_devices;\n        public candle_err_t last_error;\n        [MarshalAs(UnmanagedType.ByValArray, SizeConst = 32)]\n        public candle_device_t[] dev;\n    }\n</code></pre>\n\n<p>Using my first method, the num_devices value has a value but it is invalid as it is over the limit of what num_devices can be per the code in the C library. Using the second method, I just get an empty struct.</p>\n"}, {"tags": ["c", "comma", "parentheses", "curly-braces"], "comments": [{"owner": {"reputation": 42446, "user_id": 902497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff13ece6277497484bfa2911c6183a30?s=128&d=identicon&r=PG", "display_name": "Raymond Chen", "link": "https://stackoverflow.com/users/902497/raymond-chen"}, "edited": false, "score": 0, "creation_date": 1562700103, "post_id": 56959290, "comment_id": 100456637, "body": "<a href=\"https://gcc.godbolt.org/z/fSP4uT\" rel=\"nofollow noreferrer\">Read the compiler warnings</a>. They&#39;re there for a reason."}, {"owner": {"reputation": 42446, "user_id": 902497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff13ece6277497484bfa2911c6183a30?s=128&d=identicon&r=PG", "display_name": "Raymond Chen", "link": "https://stackoverflow.com/users/902497/raymond-chen"}, "edited": false, "score": 4, "creation_date": 1562700309, "post_id": 56959290, "comment_id": 100456719, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/28412577/int-q-1-2-peculiar-initialization-list\">int q = {1,2}; peculiar initialization list</a>"}], "answers": [{"comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 3, "creation_date": 1562700867, "post_id": 56959353, "comment_id": 100456954, "body": "Nitpick: the standard says &quot;The initializer for a scalar shall be <b>a single expression</b>, optionally enclosed in braces,&quot; where &quot;expression&quot; must be interpreted in light of the formal syntax as an <code>assignment-expression</code>, which cannot contain a comma operator at the outermost level.  Thus the behavior of the OP&#39;s brace-enclosed initializer is <i>undefined</i>.  It is not safe to assume that the extra initializer inside the braces will simply be discarded.  It might, in fact, be used instead of the first by some implementations, and of course any manner of wilder behavior might also be observed."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 5, "last_activity_date": 1562700188, "creation_date": 1562700188, "answer_id": 56959353, "question_id": 56959290, "link": "https://stackoverflow.com/questions/56959290/whats-the-relation-between-comma-and-parentheses-and-curly-braces-in-c/56959353#56959353", "title": "What&#39;s the relation between comma and parentheses and curly braces in C?", "body": "<p>In the first case:</p>\n\n<pre><code>int a =(3,4);\n</code></pre>\n\n<p>The variable is initialized with an expression consisting of a comma operator and parenthesis.  This expression evaluates to 4 as you correctly surmised which is what is assigned to <code>a</code>.</p>\n\n<p>In the second case:</p>\n\n<pre><code>int a={3,4};\n</code></pre>\n\n<p>The variable is initialized with an <strong>initializer list</strong> which is what the curly braces denote, and the comma separates the initializers.  If the variable in question was a struct or array, the values in the initializer list would be assigned to each member.  If there are more initializers than members, the excess values are discarded.</p>\n\n<p>So <code>a</code> is assigned the first value in the initializer list, namely 3, and the value 4 is discarded.</p>\n\n<p>Had you done this:</p>\n\n<pre><code>int a[2] = {3, 4};\n</code></pre>\n\n<p>Then <code>a[0]</code> would be 3 and <code>a[1]</code> would be 4.</p>\n"}], "owner": {"reputation": 67, "user_id": 10379216, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Yasser Mohamed", "link": "https://stackoverflow.com/users/10379216/yasser-mohamed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 56959353, "answer_count": 1, "score": 3, "last_activity_date": 1562700188, "creation_date": 1562699875, "question_id": 56959290, "link": "https://stackoverflow.com/questions/56959290/whats-the-relation-between-comma-and-parentheses-and-curly-braces-in-c", "title": "What&#39;s the relation between comma and parentheses and curly braces in C?", "body": "<p>I've the following two lines , and could not find a good explanation</p>\n\n<p>I did read about the dual nature of comma as operator and separator , and priority precedence of parentheses , and comma as a sequence point . </p>\n\n<pre><code>int a =(3,4) // here a is 4 because comma here is an operator first a=3 , then a = 4 \nint a={3,4} // here is the problem , should not a=3 and then a =4 too because comma is a sequence point or it's undefined behavior or what ?\n</code></pre>\n\n<p>I expected </p>\n\n<pre><code>a=4\na=4 , \nbut the actual output is \na=4 , a=3\n</code></pre>\n"}, {"tags": ["c", "function", "pointers"], "answers": [{"tags": [], "owner": {"reputation": 284, "user_id": 11562467, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dVLZx.png?s=128&g=1", "display_name": "rjg", "link": "https://stackoverflow.com/users/11562467/rjg"}, "is_accepted": false, "score": 1, "last_activity_date": 1562702133, "last_edit_date": 1562702133, "creation_date": 1562699323, "answer_id": 56959182, "question_id": 56959126, "link": "https://stackoverflow.com/questions/56959126/struct-pointer-passed-to-a-function/56959182#56959182", "title": "struct pointer passed to a function", "body": "<p>You pass the address of the struct into the function. This argument is incremented within the function and not accessible from the outside. Similar to what would happend if you'd pass and integer and increment it inside the function. If you want to increment <code>data</code> then you need to access it through the pointer passed into the function. For example <code>node-&gt;data = 0;</code> which is equivalent to <code>(*node).data = 0;</code>.</p>\n\n<p><code>&amp;node</code> is the address of the node struct. This parameter is pushed onto the call stack before writing the return address and jumping to the function. See this explanation of the <a href=\"https://softwareengineering.stackexchange.com/questions/195385/understanding-stack-frame-of-function-call-in-c-c\">C calling convention</a>. <code>change_addr()</code> can now read and write this value without the <code>main()</code> ever seeing the value, because it's popped from the stack after the execution of <code>change_addr()</code> is finished.</p>\n"}, {"tags": [], "owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "is_accepted": false, "score": 1, "last_activity_date": 1562701646, "last_edit_date": 1562701646, "creation_date": 1562701287, "answer_id": 56959557, "question_id": 56959126, "link": "https://stackoverflow.com/questions/56959126/struct-pointer-passed-to-a-function/56959557#56959557", "title": "struct pointer passed to a function", "body": "<p>The declaration</p>\n\n<pre><code>node x = { 100 };\n</code></pre>\n\n<p>allocates memory for a node structure, and initializes it. The statement</p>\n\n<pre><code>change_addr(&amp;x);\n</code></pre>\n\n<p>takes the memory address of that structure, which is just a number like, say, 1000, and passes it <em>by value</em> into the change_addr() function. Inside that function, you add 100 to <em>your local copy</em> of the pointer, named <code>ptr</code>, which makes it point to an area of memory far beyond where x is located (if x had been an array rather than a single struct, it would point to the 101st element). You then return, which discards your local copy of the address, and returns to your initial stack frame where x was never modified. </p>\n\n<p>Inside the change_addr() function, you could have changed the <em>content</em> of the structure by accessing it through the pointer. For example, <code>ptr-&gt;data = 200</code> would have changed its data. But if you want change a pointer address itself for some reason, then you'd have to create a pointer to the pointer, and pass that to a function taking the appropriate argument type.</p>\n"}], "owner": {"reputation": 11, "user_id": 6534623, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-TKqS8SPm_Z8/AAAAAAAAAAI/AAAAAAAAAP0/P1wFtRvKy60/photo.jpg?sz=128", "display_name": "Prince Daniel", "link": "https://stackoverflow.com/users/6534623/prince-daniel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1562702133, "creation_date": 1562699047, "last_edit_date": 1562700577, "question_id": 56959126, "link": "https://stackoverflow.com/questions/56959126/struct-pointer-passed-to-a-function", "title": "struct pointer passed to a function", "body": "<p>I have trouble understanding pointers being passed to the function. Here there's a struct pointer, which is passed to a function and the pointer is incremented by some value and it doesn't get reflected in the pointer variable. I guess this is call by value but how? Can you please explain?</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n\ntypedef struct node{\n    int data;\n}node;\n\nvoid change_addr(node *ptr){\n    ptr += 10;\n    printf(\"Inside Address : %p\\n\",ptr);\n}\n\nint main(){\n    node x = {100};\n    printf(\"Address : %p\\n\",x);\n    change_addr(&amp;x);\n    printf(\"Address : %p\\n\",x);\n    return 7;\n}\n</code></pre>\n"}, {"tags": ["c", "windows", "batch-file"], "comments": [{"owner": {"reputation": 796419, "user_id": 34397, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/7deca8ec973c3c0875e9a36e1e3e2c44?s=128&d=identicon&r=PG", "display_name": "SLaks", "link": "https://stackoverflow.com/users/34397/slaks"}, "edited": false, "score": 0, "creation_date": 1562698035, "post_id": 56958897, "comment_id": 100455782, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/26551/how-can-i-pass-arguments-to-a-batch-file\">How can I pass arguments to a batch file?</a>"}, {"owner": {"reputation": 2636, "user_id": 3985011, "user_type": "registered", "profile_image": "https://graph.facebook.com/1706647339/picture?type=large", "display_name": "Ben Personick", "link": "https://stackoverflow.com/users/3985011/ben-personick"}, "edited": false, "score": 0, "creation_date": 1562698794, "post_id": 56958897, "comment_id": 100456109, "body": "You want to change the file association for <code>.C</code> files to be a call to a script?"}, {"owner": {"reputation": 2393, "user_id": 3116731, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fqjdb.jpg?s=128&g=1", "display_name": "Se&#241;or CMasMas", "link": "https://stackoverflow.com/users/3116731/se%c3%b1or-cmasmas"}, "edited": false, "score": 0, "creation_date": 1562699103, "post_id": 56958897, "comment_id": 100456229, "body": "I find that inferred duplicate a complete mess when I think all he is asking is that in a batch file, your passed commands are %1 %2 ... %8 %9.  Also, just like C, argv[0] represents your app while in batch it is %0."}, {"owner": {"reputation": 35, "user_id": 10956604, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-PutabkKHNZQ/AAAAAAAAAAI/AAAAAAAAABU/y2ixiG3WTZk/photo.jpg?sz=128", "display_name": "Yassine Safraoui", "link": "https://stackoverflow.com/users/10956604/yassine-safraoui"}, "reply_to_user": {"reputation": 2636, "user_id": 3985011, "user_type": "registered", "profile_image": "https://graph.facebook.com/1706647339/picture?type=large", "display_name": "Ben Personick", "link": "https://stackoverflow.com/users/3985011/ben-personick"}, "edited": false, "score": 0, "creation_date": 1562710834, "post_id": 56958897, "comment_id": 100460224, "body": "@BenPersonick yes"}, {"owner": {"reputation": 2636, "user_id": 3985011, "user_type": "registered", "profile_image": "https://graph.facebook.com/1706647339/picture?type=large", "display_name": "Ben Personick", "link": "https://stackoverflow.com/users/3985011/ben-personick"}, "edited": false, "score": 0, "creation_date": 1562712050, "post_id": 56958897, "comment_id": 100460427, "body": "@YassineSafraoui, Good, then you&#39;ll be happy to find, I&#39;ve posted an Answer that Allows you to associate the Files with a CMD Script, and an n Example CMD Script I used on my System to Generate some outputs of the results once it is associated"}], "answers": [{"tags": [], "owner": {"reputation": 2636, "user_id": 3985011, "user_type": "registered", "profile_image": "https://graph.facebook.com/1706647339/picture?type=large", "display_name": "Ben Personick", "link": "https://stackoverflow.com/users/3985011/ben-personick"}, "is_accepted": false, "score": 1, "last_activity_date": 1562711914, "last_edit_date": 1562711914, "creation_date": 1562701674, "answer_id": 56959621, "question_id": 56958897, "link": "https://stackoverflow.com/questions/56958897/how-to-open-files-using-a-batch-file-in-sort-of-an-input-to-the-batch-file/56959621#56959621", "title": "How to open files using a batch file, in sort of an input to the batch file", "body": "<p>I believe you want to Associate .C Files with a batch script.</p>\n\n<p>EG: So that if you double-click the .c file, or call the .c file on the command line, it will be passed as an argument to the CMD Script which you will have GCC run in.</p>\n\n<p>This is possible, both through GUI and through CMD.</p>\n\n<p><strong>Here is an example of how you would accomplish this:</strong></p>\n\n<p>Optional: Backup old association for .c files to be able to restore it later if you want:</p>\n\n<pre><code>REM Backup old association for .c files to be able to restore it later if you want:\n\nAssoc .c &gt;&gt;\"%temp%\\BKP_Assocs.txt\"\n</code></pre>\n\n<p><strong>Create Custom FileType that points to your CMD Script.</strong> -- This links the Filetype to the CMD Script, you will need to provide the full path with quotes for the cmd script:</p>\n\n<pre><code>FType c.cmd=\"C:\\Path\\To\\YourScript.cmd\"\n</code></pre>\n\n<p><strong>Associate the .c file extension with the custom file type created in FType, allowing it to open in the CMD Script:</strong></p>\n\n<pre><code>Assoc .c=c.cmd\n</code></pre>\n\n<p><strong>Once you have run the above, you may Double-click on any <code>.c</code> file</strong> say \"C:\\Somefile.c\" and <strong>it will have it's address passed to the <code>.CMD</code> Script you specified</strong> eg <code>C:\\Path\\To\\YourScript.cmd</code></p>\n\n<p>You can also type <code>\"C:\\Somefile.c\"</code> on the CLI and get the file to open in the <code>C:\\Path\\To\\YourScript.cmd</code> script as a path passed as an argument.</p>\n\n<p><strong>Below is an example script to allow me to show you it works</strong> in the Example output following this script, it will spit out the info provided when you double-click a <code>.c</code> file of your choice for testing:</p>\n\n<pre><code>@ECHO OFF\nECHO(%~n0:\nECHO(%~n0: =====================\nECHO(%~n0: Begin Script \"%~f0\"\nECHO(%~n0: =====================\nECHO(%~n0:\nECHO(%~n0: The Full File Path That opened this script is:\nECHO(%~n0:   %1\nECHO(%~n0:\nECHO(%~n0: The Full File Path That opened this script, without Quotes, is:\nECHO(%~n0:   %~1\nECHO(%~n0:\nECHO(%~n0: ---------------------------------------------------------\nECHO(%~n0: File Name: \"%~n1\"\nECHO(%~n0: File Path: \"%~dp1\"\nECHO(%~n0: File Size: \"%~z1\"\nECHO(%~n0: File Ext:  \"%~x1\"\nECHO(%~n0: File Date: \"%~t1\"\nPAUSE\n</code></pre>\n\n<p><strong>When I double-click on an Example .c File The result is:</strong></p>\n\n<pre><code>C_Parser:\nC_Parser: =====================\nC_Parser: Begin Script \"C:\\Admin\\C_Parser.cmd\"\nC_Parser: =====================\nC_Parser:\nC_Parser: The Full File Path That opened this script is:\nC_Parser:   \"C:\\Admin\\testfile.c\"\nC_Parser:\nC_Parser: The Full File Path That opened this script, without Quotes, is:\nC_Parser:   C:\\Admin\\testfile.c\nC_Parser:\nC_Parser: ---------------------------------------------------------\nC_Parser: File Name: \"testfile\"\nC_Parser: File Path: \"C:\\Admin\\\"\nC_Parser: File Size: \"35\"\nC_Parser: File Ext:  \".c\"\nC_Parser: File Date: \"07/09/2019 03:20 PM\"\nPress any key to continue . . .\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 10956604, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-PutabkKHNZQ/AAAAAAAAAAI/AAAAAAAAABU/y2ixiG3WTZk/photo.jpg?sz=128", "display_name": "Yassine Safraoui", "link": "https://stackoverflow.com/users/10956604/yassine-safraoui"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1562711914, "creation_date": 1562697917, "question_id": 56958897, "link": "https://stackoverflow.com/questions/56958897/how-to-open-files-using-a-batch-file-in-sort-of-an-input-to-the-batch-file", "title": "How to open files using a batch file, in sort of an input to the batch file", "body": "<p>While I started learning C programming language, I hated the tedious process of compiling c files using the command line using gcc, I know that there are better other programs that can solve this issue, but I thought it would be pretty challenging to use batch files to do this process since it as well works in the command prompt, the first problem I found myself unable to solve is to open the c file using the batch file in sort of an input, like when you open text files using a text editor other than notepad, it would be awesome to do that for c files.</p>\n\n<p>I know that in this situation we can make the batch open the command window and wait for the input of the path of the c file, since we can drag the c file from the  file explorer window the command window and it's gonna write the path of the file in the command line, but I had rather use the first method since it's easier and it can help in other situations where the click and drag method might not help, especially when wanting to open files with something other than a batch file, for example, a python file.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 367, "user_id": 10930163, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a82a32b93373e472ee666e96b00d1b5?s=128&d=identicon&r=PG&f=1", "display_name": "anonmess", "link": "https://stackoverflow.com/users/10930163/anonmess"}, "edited": false, "score": 0, "creation_date": 1562697748, "post_id": 56958788, "comment_id": 100455642, "body": "What do you mean by &quot;break the program&quot;? I ran the code, and it ran fine, aside from the logic being wrong."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1562697779, "post_id": 56958788, "comment_id": 100455659, "body": "<code>scanf</code> <code>%s</code> is required? This is a bad exercise."}, {"owner": {"reputation": 55, "user_id": 11505346, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-KnqcLz9qHP8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdaG8JPE6mfBPK7mwc8Yq5gZP2Kuw/mo/photo.jpg?sz=128", "display_name": "Andrei Jarca", "link": "https://stackoverflow.com/users/11505346/andrei-jarca"}, "edited": false, "score": 0, "creation_date": 1562697910, "post_id": 56958788, "comment_id": 100455708, "body": "yeah, that&#39;s what the exercise requires"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1562697931, "post_id": 56958788, "comment_id": 100455719, "body": "<code>char s[20][20];</code> is a real bad match for <code>scanf(&quot;%s&quot;,s);</code> ... and <code>scanf(&quot;%s&quot;,s);</code> is a sin anyway"}, {"owner": {"reputation": 55, "user_id": 11505346, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-KnqcLz9qHP8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdaG8JPE6mfBPK7mwc8Yq5gZP2Kuw/mo/photo.jpg?sz=128", "display_name": "Andrei Jarca", "link": "https://stackoverflow.com/users/11505346/andrei-jarca"}, "edited": false, "score": 0, "creation_date": 1562697932, "post_id": 56958788, "comment_id": 100455720, "body": "can you tell me where I did wrong in my logic pls?"}, {"owner": {"reputation": 55, "user_id": 11505346, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-KnqcLz9qHP8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdaG8JPE6mfBPK7mwc8Yq5gZP2Kuw/mo/photo.jpg?sz=128", "display_name": "Andrei Jarca", "link": "https://stackoverflow.com/users/11505346/andrei-jarca"}, "edited": false, "score": 0, "creation_date": 1562697970, "post_id": 56958788, "comment_id": 100455746, "body": "Yeah well, I started from the required block of code and I don&#39;t know to do else than that"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1562697983, "post_id": 56958788, "comment_id": 100455754, "body": "@AndreiJarca You have not told which input that causes a failure..."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1562697989, "post_id": 56958788, "comment_id": 100455756, "body": "The first problem is <code>char s[20][20];</code>. That&#39;s the wrong type."}, {"owner": {"reputation": 55, "user_id": 11505346, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-KnqcLz9qHP8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdaG8JPE6mfBPK7mwc8Yq5gZP2Kuw/mo/photo.jpg?sz=128", "display_name": "Andrei Jarca", "link": "https://stackoverflow.com/users/11505346/andrei-jarca"}, "edited": false, "score": 0, "creation_date": 1562698049, "post_id": 56958788, "comment_id": 100455788, "body": "By the way, can you please explain to me why scanf(&quot;%s&quot;,s); is very bad and why it is a bad match? I&#39;m pretty bad at these. Only if you want to"}, {"owner": {"reputation": 55, "user_id": 11505346, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-KnqcLz9qHP8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdaG8JPE6mfBPK7mwc8Yq5gZP2Kuw/mo/photo.jpg?sz=128", "display_name": "Andrei Jarca", "link": "https://stackoverflow.com/users/11505346/andrei-jarca"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1562698113, "post_id": 56958788, "comment_id": 100455811, "body": "@4386427 I said in the text, if you put a word which does not end in &quot;are&quot; , it will return some error"}, {"owner": {"reputation": 367, "user_id": 10930163, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a82a32b93373e472ee666e96b00d1b5?s=128&d=identicon&r=PG&f=1", "display_name": "anonmess", "link": "https://stackoverflow.com/users/10930163/anonmess"}, "edited": false, "score": 0, "creation_date": 1562698451, "post_id": 56958788, "comment_id": 100455960, "body": "@AndreiJarca &quot;it will return some error&quot; - what is the error?"}, {"owner": {"reputation": 4667, "user_id": 268673, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/33abb5182937ebcc3765f224aa74c16d?s=128&d=identicon&r=PG", "display_name": "AndreDurao", "link": "https://stackoverflow.com/users/268673/andredurao"}, "edited": false, "score": 0, "creation_date": 1562698999, "post_id": 56958788, "comment_id": 100456194, "body": "maybe an implementation that resembles Boyer-Moore starting directly to the end of the string for larger suffixes?"}], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 11505346, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-KnqcLz9qHP8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdaG8JPE6mfBPK7mwc8Yq5gZP2Kuw/mo/photo.jpg?sz=128", "display_name": "Andrei Jarca", "link": "https://stackoverflow.com/users/11505346/andrei-jarca"}, "edited": false, "score": 0, "creation_date": 1562698803, "post_id": 56958992, "comment_id": 100456116, "body": "Oh ok, it worked with &quot;s&quot;, not &quot;s[i]&quot; and I made a char s[20];"}, {"owner": {"reputation": 55, "user_id": 11505346, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-KnqcLz9qHP8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdaG8JPE6mfBPK7mwc8Yq5gZP2Kuw/mo/photo.jpg?sz=128", "display_name": "Andrei Jarca", "link": "https://stackoverflow.com/users/11505346/andrei-jarca"}, "edited": false, "score": 0, "creation_date": 1562698827, "post_id": 56958992, "comment_id": 100456125, "body": "why is it required to put those separated?"}, {"owner": {"reputation": 55, "user_id": 11505346, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-KnqcLz9qHP8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdaG8JPE6mfBPK7mwc8Yq5gZP2Kuw/mo/photo.jpg?sz=128", "display_name": "Andrei Jarca", "link": "https://stackoverflow.com/users/11505346/andrei-jarca"}, "edited": false, "score": 0, "creation_date": 1562698920, "post_id": 56958992, "comment_id": 100456166, "body": "I mean, what does the if(tmp) do? Why is that required"}, {"owner": {"reputation": 55, "user_id": 11505346, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-KnqcLz9qHP8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdaG8JPE6mfBPK7mwc8Yq5gZP2Kuw/mo/photo.jpg?sz=128", "display_name": "Andrei Jarca", "link": "https://stackoverflow.com/users/11505346/andrei-jarca"}, "edited": false, "score": 0, "creation_date": 1562699060, "post_id": 56958992, "comment_id": 100456218, "body": "If you put s[i] it will put error invalid conversion, but it works with <i>s</i>"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "reply_to_user": {"reputation": 55, "user_id": 11505346, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-KnqcLz9qHP8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdaG8JPE6mfBPK7mwc8Yq5gZP2Kuw/mo/photo.jpg?sz=128", "display_name": "Andrei Jarca", "link": "https://stackoverflow.com/users/11505346/andrei-jarca"}, "edited": false, "score": 1, "creation_date": 1562699092, "post_id": 56958992, "comment_id": 100456226, "body": "@AndreiJarca The <code>if (tmp)</code> makes sure that <code>tmp</code> is <b>not</b> NULL when calling <code>strcmp</code> It could also be written like <code>if (tmp != NULL)</code>"}, {"owner": {"reputation": 55, "user_id": 11505346, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-KnqcLz9qHP8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdaG8JPE6mfBPK7mwc8Yq5gZP2Kuw/mo/photo.jpg?sz=128", "display_name": "Andrei Jarca", "link": "https://stackoverflow.com/users/11505346/andrei-jarca"}, "edited": false, "score": 0, "creation_date": 1562699192, "post_id": 56958992, "comment_id": 100456269, "body": "oh ok , thats like tmp != NULL, yeah, that makes a lot of sense, thanks a lot for all the help, it&#39;s very useful, you should usually go for gets(s); I suppose?"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "reply_to_user": {"reputation": 55, "user_id": 11505346, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-KnqcLz9qHP8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdaG8JPE6mfBPK7mwc8Yq5gZP2Kuw/mo/photo.jpg?sz=128", "display_name": "Andrei Jarca", "link": "https://stackoverflow.com/users/11505346/andrei-jarca"}, "edited": false, "score": 1, "creation_date": 1562699253, "post_id": 56958992, "comment_id": 100456299, "body": "@AndreiJarca I strongly prefer <code>fgets</code> for reading user input. After that <code>sscanf</code> is very handy"}], "tags": [], "owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "is_accepted": true, "score": 1, "last_activity_date": 1562699116, "last_edit_date": 1562699116, "creation_date": 1562698330, "answer_id": 56958992, "question_id": 56958788, "link": "https://stackoverflow.com/questions/56958788/how-to-count-the-amount-of-words-which-have-only-a-specific-word-as-a-suffix-and/56958992#56958992", "title": "How to count the amount of words which have only a specific word as a suffix and only as a suffix?", "body": "<p>One problem is that <code>strstr</code> returns NULL if the needle is not found. Then you pass a NULL pointer to <code>strcmp</code> which will go all wrong.</p>\n\n<p>You need to split it like:</p>\n\n<pre><code>    char* tmp = strstr(\"are\",s[i]);\n    if (tmp)\n    {\n        if (strcmp ( tmp ,\"are\") ==0 )\n        {\n            n++;\n        }\n    }\n</code></pre>\n\n<p>And this</p>\n\n<pre><code>char s[20][20];\n</code></pre>\n\n<p>shall just be:</p>\n\n<pre><code>char s[20];\n</code></pre>\n\n<p>and please <strong>never, never ever</strong> do <code>scanf(\"%s\",s);</code> Always - like in <strong>always, allways, allways</strong> - put a limit - like <code>scanf(\"%19s\",s);</code> so that the user can't overflow your input buffer.</p>\n"}], "owner": {"reputation": 55, "user_id": 11505346, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-KnqcLz9qHP8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdaG8JPE6mfBPK7mwc8Yq5gZP2Kuw/mo/photo.jpg?sz=128", "display_name": "Andrei Jarca", "link": "https://stackoverflow.com/users/11505346/andrei-jarca"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 56958992, "answer_count": 1, "score": 1, "last_activity_date": 1562699116, "creation_date": 1562697457, "question_id": 56958788, "link": "https://stackoverflow.com/questions/56958788/how-to-count-the-amount-of-words-which-have-only-a-specific-word-as-a-suffix-and", "title": "How to count the amount of words which have only a specific word as a suffix and only as a suffix?", "body": "<p>So I have this and I want to:</p>\n\n<pre><code>For the word \"are\":\n\ncaramare\naresdn\nlasrare\naresare\nmare\n</code></pre>\n\n<p><code>We have n=3</code> as only 3 words end in our specific word and have it inside only once.\nIf I read a wrong word, like \"ares\", <code>it will break the program.</code> Why is that?\nIt is required to start the program from:</p>\n\n<pre><code>n=.....;\nfor(i=1;i&lt;=11;i++)\n{ cin&gt;&gt;s; | scanf(\u201c%s\u201d,s);\n ............\n}\n</code></pre>\n\n<p>This is what I have tried:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\nint main()\n{\n    char s[20][20];\n    int n=0;\n    int i;\n    for(i=1;i&lt;=11;i++)\n    {\n        scanf(\"%s\",s);\n        if(strcmp ( strstr(\"are\",s[i]) ,\"are\") ==0 )\n        {\n            n++;\n        }\n\n    }\n    printf(\"%d\",n);\n}\n</code></pre>\n"}, {"tags": ["c", "epoll", "multiplexing", "epollet"], "comments": [{"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1562706015, "post_id": 56958623, "comment_id": 100458823, "body": "Borken anyway.  You have only one buffer for all clients, into which you recv() data from all clients, interleaving it, and thin printffing it as if it&#39;s guaranteed NUL terminated.  You understand that select/epoll &#39;non blocking&#39; servers require you to implement your own message-handling state-machine per socket, yes?"}, {"owner": {"reputation": 247, "user_id": 8310085, "user_type": "registered", "profile_image": "https://graph.facebook.com/1789907944358222/picture?type=large", "display_name": "Alex Erling", "link": "https://stackoverflow.com/users/8310085/alex-erling"}, "reply_to_user": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1562707647, "post_id": 56958623, "comment_id": 100459385, "body": "@MartinJames Thanks for the information. I will look more into it. Regarding the main question, would you have any suggestions on the best way to be able to send messages out to specific clients. Can I do it through epoll, or is there a better solution?"}], "owner": {"reputation": 247, "user_id": 8310085, "user_type": "registered", "profile_image": "https://graph.facebook.com/1789907944358222/picture?type=large", "display_name": "Alex Erling", "link": "https://stackoverflow.com/users/8310085/alex-erling"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 239, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1562696781, "creation_date": 1562696781, "question_id": 56958623, "link": "https://stackoverflow.com/questions/56958623/is-it-possible-to-use-epoll-to-send-tasks-to-multiple-client", "title": "Is it possible to use EPOLL to send tasks to multiple client", "body": "<p>I am building a server/client application. The server will need to deal with less than 1000+ clients. I currently have a simple EPOLL implementation to be able to receive information from the clients to the server. However, I will need to be able to send tasks to specific clients as well. My question is there a way to use EPOLL to identify which clients I need to send a task too (potentially using the EPOLLOUT flag) and send the message out. I've attached the snippet of what I currently have. If possible, how would I go about implementing this. It would be great to be able to have one epoll for all the sending an the receiving if it could work like that.</p>\n\n<p>Thanks for any help/recommendations!</p>\n\n<pre><code>void epoll(int listening_port)\n{\n    char buffer[500];       //buffer for message\n    int listen_sock = 0;    //file descriptor (fd) for listening socket\n    int conn_sock = 0;      //fd for connecting socket\n    int epollfd = 0;         // fd for epoll\n    int nfds = 0;           //number of fd's ready for i/o\n    int i = 0;              //index to which file descriptor we are lookng at\n    int curr_fd = 0;        //fd for socket we are currently looking at\n    bool loop = 1;          //boolean value to help identify whether to keep in loop or not\n    socklen_t address_len;\n    struct sockaddr_in serv_addr;\n    struct epoll_event ev, events[EPOLL_MAX_EVENTS];\n    ssize_t result = 0;\n\n\n    bzero(buffer, sizeof(buffer));\n    bzero(&amp;serv_addr, sizeof(serv_addr));\n\n    serv_addr.sin_family = AF_INET;\n    serv_addr.sin_port = listening_port;\n    serv_addr.sin_addr.s_addr = INADDR_ANY;\n\n    listen_sock = create_socket();\n\n\n    if(bind(listen_sock, SA &amp;serv_addr, sizeof(serv_addr)) != 0)\n    {\n        perror(\"Bind failed\");\n    }\n    else\n    {\n        printf(\"Bind successful\\n\");\n    }\n\n\n    set_socket_nonblocking(listen_sock);\n\n    listen_on_socket(listen_sock, SOMAXCONN); //specifying max connections in backlog\n\n    epollfd = initialize_epoll();\n\n    ev.events = EPOLLIN | EPOLLOUT | EPOLLET | EPOLLRDHUP;\n    ev.data.fd = listen_sock;\n\n    if(epoll_ctl(epollfd, EPOLL_CTL_ADD, listen_sock, &amp;ev) == ERROR)\n    {\n        perror(\"Epoll_ctl: listen sock\");\n    }\n    else\n    {\n        printf(\"Successfully added listen socket to epoll\\n\");\n    }\n\n    while (RUN_EPOLL)\n    {\n        nfds = epoll_wait(epollfd, events, EPOLL_MAX_EVENTS, 0); //waiting for incoming connection;\n        if(nfds == ERROR)\n        {\n            perror(\"EPOLL_Wait\");\n        }\n        //printf(\"Finished waiting\\i\");\n\n        for(i = 0; i &lt; nfds; ++i)\n        {\n            curr_fd = events[i].data.fd;\n            loop = true; //reset looping flag\n            //Notification from Listening Socket - Process Incoming Connections\n\n            if (curr_fd == listen_sock) {\n\n                while(loop)\n                {\n                    conn_sock = accept(listen_sock, SA &amp;serv_addr, &amp;address_len); //accept incoming connection\n                    printf(\"Accepted new incoming connection - socket fd: %d\\n\", conn_sock);\n                    if (conn_sock &gt; 0) //if successful set socket nonblocking and add it to epoll\n                    {\n\n                        set_socket_nonblocking(conn_sock);\n\n                        ev.events = EPOLLIN | EPOLLOUT| EPOLLET | EPOLLRDHUP; //setting flags\n                        ev.data.fd = conn_sock; //specify fd of new connection in event to follow\n                        if (epoll_ctl(epollfd, EPOLL_CTL_ADD, conn_sock, &amp;ev) == ERROR) //add fd to monitored fd's\n                        {\n                            perror(\"epoll_ctl: conn_sck\");\n                        }\n                        else\n                        {\n                            printf(\"Added %d to monitor list\\n\", conn_sock);\n                        }\n\n\n                    }\n                    else if (conn_sock == ERROR)\n                    {\n                        if ((errno == EAGAIN) || (errno == EWOULDBLOCK))\n                        {\n                            printf(\"All incoming connections processed\\n\");\n                            loop = false;\n                        }\n                        else\n                        {\n                            perror(\"Accept remote socket\");\n                            loop = false;\n                        }\n                    }\n                }\n            }\n            else if(events[i].events &amp; EPOLLRDHUP) //detecting if peer shutdown\n            {\n                printf(\"Detected socket peer shutdown. Closing now. \\n\");\n\n                if (epoll_ctl(epollfd, EPOLL_CTL_DEL, curr_fd, NULL) == ERROR) {\n                    perror(\"epoll_ctl: conn_sck\");\n                }\n\n                close_socket(curr_fd);\n            }\n            else if(events[i].events &amp; EPOLLIN)\n            {\n                while(loop)\n                {\n                    result = recv(curr_fd, buffer, sizeof(buffer), 0);\n                    //printf(\"Length of incoming message is %d\\i\", result);\n\n                    if(result &gt; 0) //\n                    {\n                        printf(\"File Descriptor: %d. Message: %s\\n\", curr_fd, buffer);\n                        bzero(buffer, sizeof(buffer));\n                    }\n                    else if(result == ERROR) //Message is completely sent\n                    {\n\n                        if(errno == EAGAIN)\n                        {\n\n\n                            send_message(curr_fd, \"Success\", strlen(\"Success\"));\n                            loop = false;\n\n                        }\n                    }\n                    else if(result == 0)\n                    {\n                        //Removing the fd from the monitored descriptors in epoll\n                        if (epoll_ctl(epollfd, EPOLL_CTL_DEL, curr_fd, NULL) == ERROR) {\n                            perror(\"epoll_ctl: conn_sck\");\n                        }\n                        close_socket(curr_fd); //Closing the fd\n                        loop = false;\n                    }\n\n                }\n\n            }\n        }\n\n    }\n\n    close_socket(listen_sock);\n    //need to develop way to gracefully close out of epoll\n\n    return;\n\n}\n</code></pre>\n"}, {"tags": ["c", "assembly", "vga"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1562696102, "post_id": 56958455, "comment_id": 100454997, "body": "How do you expect your <code>puts</code> to work with a pointer?"}, {"owner": {"reputation": 440, "user_id": 10596072, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-IBAii-KTB6g/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbCAEN8Kxifugym2iZ9c8WqEyplpuA/mo/photo.jpg?sz=128", "display_name": "Roman Kwa\u015bniewski", "link": "https://stackoverflow.com/users/10596072/roman-kwa%c5%9bniewski"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1562696230, "post_id": 56958455, "comment_id": 100455042, "body": "As I wrote I expect that it&#39;ll display first letter of given string. For puts(&quot;AaLqw&quot;, 7) it should display A"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1562696301, "post_id": 56958455, "comment_id": 100455075, "body": "And what is the second parameter to <code>putc</code>? Looks like you need to introduce some loops."}, {"owner": {"reputation": 440, "user_id": 10596072, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-IBAii-KTB6g/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbCAEN8Kxifugym2iZ9c8WqEyplpuA/mo/photo.jpg?sz=128", "display_name": "Roman Kwa\u015bniewski", "link": "https://stackoverflow.com/users/10596072/roman-kwa%c5%9bniewski"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1562696344, "post_id": 56958455, "comment_id": 100455095, "body": "character color - <a href=\"https://wiki.osdev.org/Printing_To_Screen\" rel=\"nofollow noreferrer\">wiki.osdev.org/Printing_To_Screen</a>"}, {"owner": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 2, "creation_date": 1562698670, "post_id": 56958455, "comment_id": 100456058, "body": "The code you left out is important. But I&#39;m going to guess you entered 32-bit protected mode and didn&#39;t enter 64-bit long mode. If true, that may be why you are getting strange output - you can&#39;t properly run 64-bit code in 32-bit protected mode. This may be a duplicate of: <a href=\"https://stackoverflow.com/questions/43477719/why-does-passing-a-char-to-a-function-change-its-value-in-c\" title=\"why does passing a char to a function change its value in c\">stackoverflow.com/questions/43477719/&hellip;</a> and related to <a href=\"https://stackoverflow.com/questions/56892797/something-strange-with-pointer-to-video-memory-0xb8000#comment100357623_56892797\" title=\"something strange with pointer to video memory 0xb8000%23comment100357623_56892797\">stackoverflow.com/questions/56892797/&hellip;</a> ."}, {"owner": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 0, "creation_date": 1562699107, "post_id": 56958455, "comment_id": 100456231, "body": "If you wrote a custom bootloader make sure that you read enough sectors to load the entire kernel. You can get strange behaviour if you read only part of your kernel. The other concern I have without seeing your bootloader (or early stages) is whether you placed the code at 0x100000 in memory or not. Is that where you loaded it in memory? The origin point in the linker script has to be where you loaded the program in memory (assuming you aren&#39;t using paging)"}, {"owner": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 2, "creation_date": 1562703043, "post_id": 56958455, "comment_id": 100457758, "body": "Your putc has a loop for a purpose I don&#39;t understand. Then you mov ESI and EDI which are 32-bit registers to video memory. You need to be moving 1 byte not 4 bytes."}, {"owner": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 0, "creation_date": 1562703085, "post_id": 56958455, "comment_id": 100457773, "body": "And you seem to be mixing 32-bit and 64-bit code (64-bit calling convention, 32-bit code although that may work depending on design intent)"}, {"owner": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 0, "creation_date": 1562707161, "post_id": 56958455, "comment_id": 100459215, "body": "Your <code>start.asm</code> (in your recent edit) code is wrong if you are intending to get into 64-bit long mode. Your code actually keeps you in 32-bit mode (A Mulitboot loader) only starts you in 32-bit protected mode, not 64-bit (long mode). You have to properly change into it which also involves enabling paging. Please see this article: <a href=\"https://wiki.osdev.org/Setting_Up_Long_Mode\" rel=\"nofollow noreferrer\">wiki.osdev.org/Setting_Up_Long_Mode</a> . One of the side effects of running 64-bit generated code in 32-bit protected mode is improper instruction decoding which often first manifests itself as a problem when writing to video memory."}], "owner": {"reputation": 440, "user_id": 10596072, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-IBAii-KTB6g/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbCAEN8Kxifugym2iZ9c8WqEyplpuA/mo/photo.jpg?sz=128", "display_name": "Roman Kwa\u015bniewski", "link": "https://stackoverflow.com/users/10596072/roman-kwa%c5%9bniewski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 335, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1562706826, "creation_date": 1562696006, "last_edit_date": 1562706826, "question_id": 56958455, "link": "https://stackoverflow.com/questions/56958455/linking-c-c-and-assembly", "title": "Linking C, C++ and assembly", "body": "<p>I'm writing little \"kernel\" that displays \"Hello world!\" on the screen. I have working putc (put char) function so I can do it (and I did it) with 12 putc function calls but I want do it with puts (put string) function and I want to write it in C++. I know that I can make it in C but I'll need C with C++ linking in the future... So why not do it right now?</p>\n\n<p>Here is my kernel.c code:</p>\n\n<pre><code>extern void putc(char, char);\nextern void puts(char*, char);\nextern void clear(void);\n\nvoid start_kernel(void)\n{\n\n  clear();\n  puts(\"Hello world!\", 7);\n  putc('H', 7);\n  putc('e', 7);\n  putc('l', 7);\n  putc('l', 7);\n  putc('o', 7);\n  putc(' ', 7);\n  putc('w', 7);\n  putc('o', 7);\n  putc('r', 7);\n  putc('l', 7);\n  putc('d', 7);\n  putc('!', 7);\n\n  for(;;);\n\n}\n</code></pre>\n\n<p>I changed the puts.cpp code so that it should display the first letter of the string on the screen... but it doesn't...</p>\n\n<p>puts.cpp:</p>\n\n<pre><code>extern \"C\" void putc(char, char);\n\nextern \"C\"\n{\n\n  void puts(char *s, char color)\n  {\n\n    putc(*s, 7);\n\n  }\n\n}\n</code></pre>\n\n<p>This function clears 80x25 VGA buffor it have 4000 bytes size</p>\n\n<p>clear.asm:</p>\n\n<pre><code>BITS 32\n\nGLOBAL clear\n\nclear:\n\n  push eax\n\n  mov eax, 0xb8000\n  dec eax\n\n  L1:\n\n    inc eax\n    mov byte [eax], 0\n    cmp eax, 0xb8fa0\n    jb L1\n\n  pop eax\n\n  ret\n</code></pre>\n\n<p>putc.asm:</p>\n\n<pre><code>BITS 32\n\nGLOBAL putc\n\nputc:\n\n  push eax\n\n  mov eax, 0xb8000\n  dec eax\n\n  L1:\n\n    inc eax\n    cmp byte [eax], 0\n    jnz L1\n\n  mov [eax], edi\n  mov [eax+1], esi\n\n  pop eax\n\n  ret\n</code></pre>\n\n<p>kernel.ld:</p>\n\n<pre><code>OUTPUT_FORMAT(\"binary\")\nENTRY(\"_start\")\nSECTIONS {\n.text 0x100000 : {\ncode = . ; _code = . ;\n*(.text)\n}\n.data : {\n*(.data)\n}\n.bss : {\nbss = . ; _bss = . ;\n*(.bss)\n*(.COMMON)\n}\nend = . ; _end = . ;\n}\n</code></pre>\n\n<p>start.asm:</p>\n\n<pre><code>BITS 64\n\nsection .text\n\n  EXTERN code,bss,end\n\n  mboot:\n\n    dd 0x1BADB002\n    dd 0x10001\n    dd -(0x1BADB002+0x10001)\n    dd mboot\n    dd code\n    dd bss\n    dd end\n    dd _start\n\n  GLOBAL _start\n\n  _start:\n\n    cli\n    mov esp,kstack+4096\n    mov ax,0x10\n    mov ds,ax\n    mov es,ax\n    mov fs,ax\n    mov gs,ax\n    lgdt [gdt_descr]\n    jmp .1\n    .1:\n    push dword 0\n    push dword 0\n    push dword 0\n    push dword L6\n\n    EXTERN start_kernel\n    push dword start_kernel\n    ret\n\n    L6:\n\n      jmp L6\n\nsection .bss\n\n  kstack: resd 1024\n\nsection .data\n\n  gdt_descr:\n\n    dw 256*8-1\n    dd _gdt\n\n  GLOBAL _gdt\n\n  _gdt:\n\n    dd 0,0\n    dd 0x0000FFFF,0x00CF9A00\n    dd 0x0000FFFF,0x00CF9200\n    dd 0,0\n    times 254 dd 0,0\n</code></pre>\n\n<p>link.bash script:</p>\n\n<pre><code>nasm start.asm -f elf64 -o start.o\nnasm putc.asm -f elf64 -o putc.o\nnasm clear.asm -f elf64 -o clear.o\ngcc puts.cpp -std=c++0x -c -o puts.o\ngcc kernel.c -O3 -fomit-frame-pointer -masm=intel -c -o kernel.o\nld -Tkernel.ld -o kernel.bin start.o kernel.o putc.o puts.o clear.o\n</code></pre>\n\n<p>After generating iso running it with qemu-system-x86_64 -hdd kernel.iso , it displays weird character (each time this same) and Hello world!\nOf course after placing this function in kernel.c file it displays HHello world!</p>\n\n<p>Interesting thing is that after replacing gcc with clang++ (for puts.cpp) it displays another weird character (also each time this same)</p>\n\n<p>After replacing puts() function content with putc('a', 7); it displays this letter correctly so it looks like there is a problem with passing arguments between C and C+++ not C++ and assembly but maybe I'm wrong...</p>\n"}, {"tags": ["c++", "c", "linux", "multithreading", "pthreads"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1562695354, "post_id": 56958293, "comment_id": 100454659, "body": "<code>pthread_setschedparam</code>"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 5, "creation_date": 1562695416, "post_id": 56958293, "comment_id": 100454693, "body": "This sounds like <a href=\"https://meta.stackexchange.com/questions/66377/what-is-the-xy-problem\">an XY problem</a>.  For what <b>problem</b> have you decided that lowering thread priority is the solution?"}, {"owner": {"reputation": 56858, "user_id": 131930, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/91536fe27d32713b8a154a0bf42f6748?s=128&d=identicon&r=PG", "display_name": "Jeremy Friesner", "link": "https://stackoverflow.com/users/131930/jeremy-friesner"}, "edited": false, "score": 0, "creation_date": 1562697937, "post_id": 56958293, "comment_id": 100455722, "body": "Note that in Linux (and most other Unix OS&#39;s), the default scheduler (aka SCHED_OTHER) will automatically reduce a thread&#39;s priority when it sees that the thread is using up lots of CPU cycles.  Therefore, if your concern is that a CPU-heavy computational thread might hold off a mostly-idle e.g. GUI thread that requires low latency, then the OS may have already dealt with that problem for you automatically."}, {"owner": {"reputation": 2017, "user_id": 6861219, "user_type": "registered", "accept_rate": 88, "profile_image": "https://graph.facebook.com/141586299631822/picture?type=large", "display_name": "Ziqi Liu", "link": "https://stackoverflow.com/users/6861219/ziqi-liu"}, "reply_to_user": {"reputation": 56858, "user_id": 131930, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/91536fe27d32713b8a154a0bf42f6748?s=128&d=identicon&r=PG", "display_name": "Jeremy Friesner", "link": "https://stackoverflow.com/users/131930/jeremy-friesner"}, "edited": false, "score": 0, "creation_date": 1562701174, "post_id": 56958293, "comment_id": 100457070, "body": "@JeremyFriesner I&#39;ve updated some description about my situation, the default system scheduling might not be able to handle my problem, so I want to manually lower the priority of the thread. Any advice based on my situation?"}, {"owner": {"reputation": 2017, "user_id": 6861219, "user_type": "registered", "accept_rate": 88, "profile_image": "https://graph.facebook.com/141586299631822/picture?type=large", "display_name": "Ziqi Liu", "link": "https://stackoverflow.com/users/6861219/ziqi-liu"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1562701267, "post_id": 56958293, "comment_id": 100457106, "body": "@AndrewHenle thanks for the advice, I&#39;ve updated my question to clarify my situation, any advice based on that?"}], "answers": [{"tags": [], "owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "is_accepted": false, "score": 1, "last_activity_date": 1562696311, "creation_date": 1562696311, "answer_id": 56958513, "question_id": 56958293, "link": "https://stackoverflow.com/questions/56958293/how-to-lower-thread-priority-in-c-c/56958513#56958513", "title": "how to lower thread priority in C/C++", "body": "<p>Indeed, the situation with scheduling priorities on Linux is a huge mess of confusion over what applies to processes vs threads. At the specification level, <code>nice</code> and <code>setpriority</code> apply to processes, but Linux doesn't actually support doing that, so it interprets the argument as a kernel-level thread id instead (not same as <code>pthread_t</code>, and there's no standard userspace API to request the kernel-level tid of a thread!).</p>\n\n<p>You might be able to achieve what you want with <code>SCHED_IDLE</code> or <code>SCHED_BATCH</code>, but they don't really work right either.</p>\n"}, {"comments": [{"owner": {"reputation": 2017, "user_id": 6861219, "user_type": "registered", "accept_rate": 88, "profile_image": "https://graph.facebook.com/141586299631822/picture?type=large", "display_name": "Ziqi Liu", "link": "https://stackoverflow.com/users/6861219/ziqi-liu"}, "edited": false, "score": 0, "creation_date": 1562778955, "post_id": 56961036, "comment_id": 100487536, "body": "Thanks for the solution! Set idle partially relieve the periodic performance downgrade, I think that&#39;s one potential solution to my problem, since I simply want that thread not making CPU burst periodically, but amortize its computation smoothly, so it won&#39;t take too much computing resource from other worker threads when it burst. And also thanks to your advice about memory issue, I bench the memory usage of my whole program and I think memory is not the bottleneck, I&#39;m still investigate other potential approach to smooth the CPU burst of this thread."}, {"owner": {"reputation": 56858, "user_id": 131930, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/91536fe27d32713b8a154a0bf42f6748?s=128&d=identicon&r=PG", "display_name": "Jeremy Friesner", "link": "https://stackoverflow.com/users/131930/jeremy-friesner"}, "reply_to_user": {"reputation": 2017, "user_id": 6861219, "user_type": "registered", "accept_rate": 88, "profile_image": "https://graph.facebook.com/141586299631822/picture?type=large", "display_name": "Ziqi Liu", "link": "https://stackoverflow.com/users/6861219/ziqi-liu"}, "edited": false, "score": 0, "creation_date": 1562792017, "post_id": 56961036, "comment_id": 100492992, "body": "I don&#39;t think there is any advantage in ramping a thread&#39;s CPU usage up and down gradually over time.  CPUs aren&#39;t like cars that can travel at different speeds; rather a CPU is either in use at its normal speed, or it is idle; there is no &quot;running at half speed&quot;; if you see 50% indicated on a CPU graph, that meant the CPU was in in use for half of the sampling period and was idle for the other half.  Also, a low-priority thread will never &quot;steal&quot; CPU cycles from a higher priority thread; as soon as the higher-priority thread wants to run, the lower-priority one gets kicked off the CPU."}, {"owner": {"reputation": 2017, "user_id": 6861219, "user_type": "registered", "accept_rate": 88, "profile_image": "https://graph.facebook.com/141586299631822/picture?type=large", "display_name": "Ziqi Liu", "link": "https://stackoverflow.com/users/6861219/ziqi-liu"}, "edited": false, "score": 0, "creation_date": 1562792545, "post_id": 56961036, "comment_id": 100493175, "body": "Thank you for the explanation! Then I think my program might have some other problems that will cause slowing down periodically, I&#39;ll investigate into it, thanks!"}, {"owner": {"reputation": 1090, "user_id": 1983398, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bba922326537fd12144b9a2587f742f?s=128&d=identicon&r=PG", "display_name": "ssbssa", "link": "https://stackoverflow.com/users/1983398/ssbssa"}, "edited": false, "score": 0, "creation_date": 1592806837, "post_id": 56961036, "comment_id": 110545005, "body": "What&#39;s variable <code>&amp;m</code>?"}, {"owner": {"reputation": 56858, "user_id": 131930, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/91536fe27d32713b8a154a0bf42f6748?s=128&d=identicon&r=PG", "display_name": "Jeremy Friesner", "link": "https://stackoverflow.com/users/131930/jeremy-friesner"}, "edited": false, "score": 0, "creation_date": 1592833890, "post_id": 56961036, "comment_id": 110558343, "body": "&amp;m was a typo; it should have been &amp;param.  I\u2019ve fixed it."}], "tags": [], "owner": {"reputation": 56858, "user_id": 131930, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/91536fe27d32713b8a154a0bf42f6748?s=128&d=identicon&r=PG", "display_name": "Jeremy Friesner", "link": "https://stackoverflow.com/users/131930/jeremy-friesner"}, "is_accepted": true, "score": 1, "last_activity_date": 1592833859, "last_edit_date": 1592833859, "creation_date": 1562709743, "answer_id": 56961036, "question_id": 56958293, "link": "https://stackoverflow.com/questions/56958293/how-to-lower-thread-priority-in-c-c/56961036#56961036", "title": "how to lower thread priority in C/C++", "body": "<p>Assuming you are running a fairly recent version of the Linux kernel, you can try setting your thread to SCHED_IDLE as shown at <a href=\"https://www.systutorials.com/241669/how-to-set-process-with-lowest-priority/\" rel=\"nofollow noreferrer\">this link</a>, i.e.:</p>\n<pre><code>void set_idle_priority() {                                              \n   struct sched_param param;\n   param.sched_priority = 0;\n   if (pthread_setschedparam(pthread_self(), SCHED_IDLE, &amp;param) != 0)\n      perror(&quot;pthread_setschedparam&quot;);\n} \n</code></pre>\n<p>In that mode, your thread will only run when nothing else in the system wants to run.</p>\n<p>... that said, I'm not confident that doing so will actually solve your problem, since from your description you shouldn't be having that problem in the first place.  In particular, the presence of a CPU-hogging thread running at normal/default priority should not significantly slow down your system, since the scheduler should automatically detect its CPU-hogging nature and implicitly deprioritize it, without you having to take any special steps.  That makes me think that your problem probably isn't the thread's CPU usage, but rather something else, like maybe your thread is using up all of the system's available RAM capacity, causing the system to have to page memory to disk.  That would definitely cause the system to slow down considerably.  Another possibility would be if your thread is doing a lot of disk I/O (although that seems less likely, since in that case it would probably not be pinning a CPU core).</p>\n<p>You might try temporarily replacing your thread's computations with a trivial CPU-burning loop, e.g.:</p>\n<pre><code>void my_thread_entry_func()\n{\n   while(1) {/* empty */}\n}\n</code></pre>\n<p>... and run that just to see if it also provokes the slowdown.  If not, then it's not the CPU-usage itself that is causing the slowdown, but rather something else your thread is doing, and you'll want to do further testing to narrow down exactly which part(s) of your thread's execution-path are the culprits.</p>\n"}], "owner": {"reputation": 2017, "user_id": 6861219, "user_type": "registered", "accept_rate": 88, "profile_image": "https://graph.facebook.com/141586299631822/picture?type=large", "display_name": "Ziqi Liu", "link": "https://stackoverflow.com/users/6861219/ziqi-liu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 992, "favorite_count": 0, "accepted_answer_id": 56961036, "answer_count": 2, "score": 1, "last_activity_date": 1592833859, "creation_date": 1562695275, "last_edit_date": 1562704629, "question_id": 56958293, "link": "https://stackoverflow.com/questions/56958293/how-to-lower-thread-priority-in-c-c", "title": "how to lower thread priority in C/C++", "body": "<p>I want to lower the priority of a thread. </p>\n\n<p>The default policy of my thread is <code>SCHED_OTHER</code>, and the range of priority under my system(Ubuntu) is [0,0] (I get the range by <code>sched_get_priority_min(SCHED_OTHER)</code> and <code>sched_get_priority_max(SCHED_OTHER)</code>) which means all threads with <code>SCHED_OTHER</code> will have the same priority. </p>\n\n<p>Is there any approach to lower the priority with <code>SCHED_OTHER</code>? I've been searching for a while and I found the <code>nice</code> value system, but not sure if it's the correct way to do this, since the <a href=\"http://man7.org/linux/man-pages/man2/nice.2.html\" rel=\"nofollow noreferrer\">man page</a> said nice value is for process, instead of thread, I'm confused...</p>\n\n<p>Could anyone give the correct solution to do this, and maybe with a short code snippet? Thanks!</p>\n\n<p><strong>Added:</strong></p>\n\n<p>why I want to lower the priority of thread: </p>\n\n<p>I have a worker thread, which is doing some intensive computation periodically (say, a few seconds every minute, thus will cause some CPU usage peak), and my whole system will experience periodically downgrade in performance.  But the priority of this worker thread is low, as long as it can finish computation before next minute, it should be fine. so I want to amortize the computation of this task over this time window smoothly.</p>\n"}, {"tags": ["c", "loops", "random", "srand"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 7, "creation_date": 1562694707, "post_id": 56958134, "comment_id": 100454369, "body": "<code>5</code> is a number. <code>&#39;5&#39;</code> is a character. The difference between the two is <code>&#39;0&#39;</code>. I.e. <code>&#39;5&#39; == 5 + &#39;0&#39;</code>"}, {"owner": {"reputation": 27, "user_id": 6944487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fcde2e2867fa2641dce79b55c500208?s=128&d=identicon&r=PG&f=1", "display_name": "mrMatrix", "link": "https://stackoverflow.com/users/6944487/mrmatrix"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1562695108, "post_id": 56958134, "comment_id": 100454546, "body": "so , what should i do is to modify the condition in the for loop to be like that <code>c if(temp[i] == c+&#39;0&#39; ) </code> or what ? :D  i&#39;ll appreciate if you give me an example :)"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1562695241, "post_id": 56958134, "comment_id": 100454612, "body": "^ This is one of the solutions."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1563179966, "post_id": 56958134, "comment_id": 100600401, "body": "@Ahmedhamdy: you can accept the answer by clicking on the grey checkmark below its score"}], "answers": [{"comments": [{"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "edited": false, "score": 0, "creation_date": 1562695852, "post_id": 56958320, "comment_id": 100454867, "body": "Suggestion on the second solution: use <code>sizeof(temp)</code> instead of the constant <code>5</code>, especially since you recommend changing the size of <code>temp</code>. Asking the maintainer to figure out which constants in the program are supposed to be the size of <code>temp</code> or half the size of <code>temp</code>, and which mean something else, is just asking for bugs. Or even <code>sizeof(temp)&#47;sizeof(temp[0])</code>, if it\u2019s possible the algorithm could be changed to use wide characters. If that\u2019s too much to type, <code>#define NDIGITS (sizeof(temp)&#47;sizeof(temp[0]))</code> or something."}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "edited": false, "score": 0, "creation_date": 1562696142, "post_id": 56958320, "comment_id": 100455013, "body": "Looks much better, although as a stylistic choice, I never write <code>for (;;)</code>.  I prefer <code>while (true)</code>.  In this case, I personally would have written <code>do {&#47;*...*&#47;} while (memchr(temp, c, sizeof temp));</code>."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "edited": false, "score": 0, "creation_date": 1562696443, "post_id": 56958320, "comment_id": 100455129, "body": "@Davislor: Your alternative works fines, but I have strong feelings against <code>do</code>/<code>while</code>: this construct is very often misused by newbie programmers and sometimes savvy programmers alike. I don&#39;t ike <code>while (true)</code> either for 2 reasons: <code>true</code> is a recent addition to the standard, and <code>for (;;)</code> is an eye catcher."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "edited": false, "score": 0, "creation_date": 1562696640, "post_id": 56958320, "comment_id": 100455193, "body": "@Davislor: since we are nitpicking, I would definitely prefer <code>countof(temp)</code> or <code>const size_t ndigits = sizeof(temp) &#47; sizeof(temp[0])</code> over <code>#define NDIGITS (sizeof(temp)&#47;sizeof(temp[0]))</code>"}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "edited": false, "score": 0, "creation_date": 1562697238, "post_id": 56958320, "comment_id": 100455448, "body": "I don\u2019t think those alternatives are standard C11? But yes, in C++, I would definitely write a <code>constexpr</code> expression for <code>ndigits</code>. I typically use signed math and <code>ptrdiff_t</code> for my indices to avoid bugs like the notorious <code>3U &lt; -1</code>."}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "edited": false, "score": 0, "creation_date": 1562697351, "post_id": 56958320, "comment_id": 100455495, "body": "And your code is fine; it comes down to personal coding style."}, {"owner": {"reputation": 27, "user_id": 6944487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fcde2e2867fa2641dce79b55c500208?s=128&d=identicon&r=PG&f=1", "display_name": "mrMatrix", "link": "https://stackoverflow.com/users/6944487/mrmatrix"}, "edited": false, "score": 0, "creation_date": 1562697367, "post_id": 56958320, "comment_id": 100455503, "body": "Thanks all your answers helped me  a lot :)"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "edited": false, "score": 0, "creation_date": 1562697751, "post_id": 56958320, "comment_id": 100455644, "body": "@Davislor: sadly <code>countof</code> is not a C Standard operator, it should be defined as  a macro as <code>#define countof(a)  (sizeof(a)&#47;sizeof(*(a)))</code> and applying it to a pointer will produce a confusing error that may go unnoticed. Regarding the <code>const</code> variable definition, it is perfectly correct C code and will be optimized out at compile time."}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "edited": false, "score": 0, "creation_date": 1562701089, "post_id": 56958320, "comment_id": 100457033, "body": "Standard C does let you use <code>ndigits</code>, declared that way, as a function argument. So, yes, it works fine here. I\u2019m in the habit of using <code>#define</code> because some C compilers don\u2019t treat a <code>const size_t</code> as an integer constant expression that you can use in array declarations. So I needed a <code>#define NDIGITS</code> to declare multiple arrays that are the same size. Or I could switch to C++."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "edited": false, "score": 0, "creation_date": 1562704681, "post_id": 56958320, "comment_id": 100458346, "body": "@Davislor: of course using <code>ndigits</code> as the size of the array in not C89 conformant. <code>ndigits</code> is computed from the array size. The definition does not require an explicit size, the size is determined from the initializer."}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "edited": false, "score": 0, "creation_date": 1562705444, "post_id": 56958320, "comment_id": 100458625, "body": "Right, but I\u2019m sure we\u2019ve both run into situations where we needed a <code>#define</code> for an array size.  This is getting off-topic, though. Good answer, fine as it is."}], "tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 4, "last_activity_date": 1562696801, "last_edit_date": 1562696801, "creation_date": 1562695422, "answer_id": 56958320, "question_id": 56958134, "link": "https://stackoverflow.com/questions/56958134/why-do-while-loop-doesnt-work-correctly/56958320#56958320", "title": "Why do while loop doesn&#39;t work correctly?", "body": "<p>There are multiple problems:</p>\n\n<ul>\n<li><code>5</code> and <code>'5'</code> are not the same thing. <code>'5'</code> is a character value whereas <code>5</code> is a numeric value. Character values depend on the character encoding, most likely ASCII on current systems, where <code>'5'</code> has a numeric value of <code>53</code> (<code>0x35</code>).</li>\n<li>the C Standard guarantees that the character digits <code>'0'</code> to <code>'9'</code> are contiguous, so you can draw a character digit by adding <code>'0'</code> to the random number.</li>\n<li>you should set <code>flag</code> to <code>1</code> before the <code>for</code> loop and only clear it when you find the character.</li>\n<li>note that you draw a character among <code>0</code>, <code>1</code>, <code>2</code>, <code>3</code> and <code>4</code>. You might instead want all character digits included?</li>\n</ul>\n\n<p>Here is a modified version:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt;\n\nint main() {\n    char temp[] = { '3', '2', '5', '9', '1' };\n    const size_t temp_len = sizeof(temp) / sizeof(temp[0]);\n    char c;\n    int flag;\n\n    srand(time(NULL));\n\n    do {\n        // select a random digit character \n        c = '0' + rand() % 10;\n        flag = 1;\n        for (size_t i = 0; i &lt; temp_len; i++) {\n            if (temp[i] == c) {\n                flag = 0;\n                break;\n            }\n        }\n    } while (flag == 0);\n\n    printf(\"character is: %c\\n\", c);\n    return 0;\n}\n</code></pre>\n\n<p>Note that you can use <code>memchr()</code> to search for the character and avoid using <code>do</code>/<code>while</code> loops that tend to cause confusion. Here is a simpler alternative:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;time.h&gt;\n\nint main() {\n    char temp[] = { '3', '2', '5', '9', '1' };\n    char c;\n\n    srand(time(NULL));\n\n    for (;;) {\n        // select a random digit character \n        c = '0' + rand() % 10;\n        if (!memchr(temp, c, sizeof temp))\n            break;\n    }\n    printf(\"character is: %c\\n\", c);\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 6944487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fcde2e2867fa2641dce79b55c500208?s=128&d=identicon&r=PG&f=1", "display_name": "mrMatrix", "link": "https://stackoverflow.com/users/6944487/mrmatrix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1562696801, "creation_date": 1562694614, "last_edit_date": 1562695068, "question_id": 56958134, "link": "https://stackoverflow.com/questions/56958134/why-do-while-loop-doesnt-work-correctly", "title": "Why do while loop doesn&#39;t work correctly?", "body": "<p>I wrote some C code to generate a random character and check if this character exists in an array. If it exist, I want to re-generate a new char. I'm using a flag as an indicator and used a <code>do</code>/<code>while</code> loop to check this flag, but unfortunately the code doesn't work as desired and I get a character that already exist in the array.</p>\n\n<p>I need your help to understand and solve this problem.</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt;\n\nint main() {\n    char c;\n    int num;\n    int flag = -1;\n    char temp[5] = { '3', '2', '5', '9', '1' };\n    srand(time(NULL));\n    do {\n        num = rand() % 5;\n        c = num;\n        for (int i = 0; i &lt; 5; i++) {\n            if (temp[i] == c) {\n                flag = 0;\n                break;\n            } else {\n                flag = 1;\n            }\n        }\n    } while (0 == flag);\n\n    printf(\"number is : %d\\n\", c);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "algorithm", "struct", "time-complexity", "binary-search"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 11637906, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-xOTjhlon5v8/AAAAAAAAAAI/AAAAAAAAK0Y/cDyFMpXOC2s/photo.jpg?sz=128", "display_name": "Ben Keene", "link": "https://stackoverflow.com/users/11637906/ben-keene"}, "edited": false, "score": 1, "creation_date": 1562694027, "post_id": 56957968, "comment_id": 100454067, "body": "This is exactly what I had in mind but you managed to put it succinctly and clearly. Reaffirms that I&#39;m on the right path, thank you!"}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 3, "last_activity_date": 1562693900, "creation_date": 1562693900, "answer_id": 56957968, "question_id": 56957894, "link": "https://stackoverflow.com/questions/56957894/implementing-binary-search-on-an-array-of-ordered-pair-structs/56957968#56957968", "title": "Implementing binary-search on an array of ordered-pair structs", "body": "<p>Your structs already have an ordering defined as follows:</p>\n\n<p>For structs A and B:</p>\n\n<ul>\n<li>if A.x > B.x then A is greater</li>\n<li>if A.x &lt; B.x then B is greater</li>\n<li>if A.x == B.x then:\n\n<ul>\n<li>if A.y > B.y then A is greater</li>\n<li>if A.y &lt; B.y then B is greater</li>\n<li>if A.y == B.y then A and B are equivalent</li>\n</ul></li>\n</ul>\n\n<p>So when you perform your binary search, use the above to determine whether one struct is greater than, less than, or equal to another.</p>\n"}, {"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 0, "last_activity_date": 1562694457, "creation_date": 1562694457, "answer_id": 56958098, "question_id": 56957894, "link": "https://stackoverflow.com/questions/56957894/implementing-binary-search-on-an-array-of-ordered-pair-structs/56958098#56958098", "title": "Implementing binary-search on an array of ordered-pair structs", "body": "<blockquote>\n  <p>However, my understanding of binary-search only extends to arrays of ints, not structs.</p>\n</blockquote>\n\n<p>The binary search <em>algorithm</em> is not specific to any particular data type.  It requires only that there be a total ordering of the objects to be searched (which sorting them also requires), and for them to be arranged in that order.  You may have implemented it only for <code>int</code>s in the past, but I'm inclined to think that among the purposes of the exercise is to drive home the generic applicability of the binary search algorithm.  It works for structs just the same as it does for <code>int</code>s, as long as you have a suitable means by which to compute the relative order of pairs of structs -- and you <em>do</em>, because you needed just such a thing to perform your sort.</p>\n\n<blockquote>\n  <p>Looking at what I've written for binary-search in the past I compare\n  the middle of my array with what I'm searching for, however that\n  comparison falls apart for ordered-pairs.</p>\n</blockquote>\n\n<p>No, it doesn't.  You cannot perform the comparison with C's built-in relational operators, but that does not mean you cannot compare.</p>\n\n<p>I suspect that you're focusing too much on a specific past implementation.  I would hope that you were first taught the algorithm, and only then shown or induced to discover an implementation for <code>int</code>s.  The problem defines an appropriate ordering of the ordered pairs.  Use it.</p>\n\n<blockquote>\n  <p>I cannot say that one\n  ordered-pair is \"less than\" or \"greater than\" another, unless I break\n  it down.</p>\n</blockquote>\n\n<p>Well yes, you need to look at the components of each pair to determine which one is \"less\".  So?  The details of how you make that determination don't matter, as long as you get the right answer.  This in no way interferes with implementing binary search, any more than it did (or should have done) for implementing the sorting.  Indeed, if you wrote a comparison function for use in the sorting, then you should be able to re-use the same function for performing comparisons in the binary search.</p>\n"}, {"tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 0, "last_activity_date": 1562694906, "last_edit_date": 1562694906, "creation_date": 1562694488, "answer_id": 56958105, "question_id": 56957894, "link": "https://stackoverflow.com/questions/56957894/implementing-binary-search-on-an-array-of-ordered-pair-structs/56958105#56958105", "title": "Implementing binary-search on an array of ordered-pair structs", "body": "<p>You can use the same comparison function to sort the reference array with <code>qsort()</code> and search the sorted array with <code>bsearch()</code>:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>int point_cmp(const void *a, const void *b) {\n    const pair *aa = a;\n    const pair *bb = b;\n    if (aa-&gt;x == bb-&gt;x)\n        return (aa-&gt;y &gt; bb-&gt;y) - (aa-&gt;y &lt; bb-&gt;y);\n    else\n        return (aa-&gt;x &gt; bb-&gt;x) - (aa-&gt;x &lt; bb-&gt;x);\n}\n</code></pre>\n\n<p>You will get the index of the match by subtracting the array's address from the pointer returned by <code>bsearch()</code> if it succeeds:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\ntypedef struct ordPair {\n    int x, y;\n} point;\n\nint point_cmp(const void *a, const void *b) {\n    const pair *aa = a;\n    const pair *bb = b;\n    if (aa-&gt;x == bb-&gt;x)\n        return (aa-&gt;y &gt; bb-&gt;y) - (aa-&gt;y &lt; bb-&gt;y);\n    else\n        return (aa-&gt;x &gt; bb-&gt;x) - (aa-&gt;x &lt; bb-&gt;x);\n}\n\n...\n\nint main(void) {\n    size_t numOfPoints;\n    ...\n    point *pointArray = malloc(numOfPoints * sizeof(point));\n    ...\n    qsort(pointArray, numOfPoints, sizeof(point), point_cmp);\n    ...\n    point userInput;\n    ...\n    point *p = bsearch(userPoint, pointArray, numOfPoints, sizeof(point), point_cmp);\n    if (p != NULL) {\n        // point was found: compute the index\n        size_t found_index = p - pointArray;\n        ...\n    }\n    ...\n}\n\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 11637906, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-xOTjhlon5v8/AAAAAAAAAAI/AAAAAAAAK0Y/cDyFMpXOC2s/photo.jpg?sz=128", "display_name": "Ben Keene", "link": "https://stackoverflow.com/users/11637906/ben-keene"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 175, "favorite_count": 0, "accepted_answer_id": 56957968, "answer_count": 3, "score": 2, "last_activity_date": 1562694906, "creation_date": 1562693599, "last_edit_date": 1562694236, "question_id": 56957894, "link": "https://stackoverflow.com/questions/56957894/implementing-binary-search-on-an-array-of-ordered-pair-structs", "title": "Implementing binary-search on an array of ordered-pair structs", "body": "<p>I'm writing some code for a homework assignment that involves receiving a list of ordered-pairs, sorting them in ascending x-order first, and for identical x-values sort the points by ascending y-order.  I've successfully accomplished that and have no issue.  Assume that I have an array of ordered-pair structs sorted.</p>\n\n<p>I need to receive input from the user in the form of an ordered-pair, and perform binary-search to determine if the user's ordered-pair exists in my array.  However, my understanding of binary-search only extends to arrays of ints, not structs.</p>\n\n<p>Do I need to use binary-search to find <em>all</em> ordered-pairs that have the same x-value as the user and only <em>then</em> search among those ordered-pairs for matching y-values?</p>\n\n<p>Looking at what I've written for binary-search in the past I compare the middle of my array with what I'm searching for, however that comparison falls apart for ordered-pairs.  I cannot say that one ordered-pair is \"less than\" or \"greater than\" another, unless I break it down.</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>\ntypedef struct ordPair {\n        int x, y;\n} point;\n...\n\nint main(void){\n...\npointArray = (point*)malloc(numOfPoints * sizeof(point));\n...\n}\n\n</code></pre>\n\n<p>I'm expect the output of my search to return the place i for which pointArray[i] is equivalent to the user submitted point, otherwise it'll return -1.</p>\n"}, {"tags": ["c", "mpi"], "comments": [{"owner": {"reputation": 7287, "user_id": 8062491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rd6rD.png?s=128&g=1", "display_name": "Gilles Gouaillardet", "link": "https://stackoverflow.com/users/8062491/gilles-gouaillardet"}, "edited": false, "score": 0, "creation_date": 1562719956, "post_id": 56957812, "comment_id": 100461866, "body": "intrinsics are implemented by the compiler (e.g. <code>icc</code>). You do not have to use Intel MPI in order to use Intel compilers."}, {"owner": {"reputation": 3, "user_id": 11519449, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-9wC50c5MHN0/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7qjAD2QheOImDgv9mprluQ3yEZTdw/mo/photo.jpg?sz=128", "display_name": "mimi", "link": "https://stackoverflow.com/users/11519449/mimi"}, "reply_to_user": {"reputation": 7287, "user_id": 8062491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rd6rD.png?s=128&g=1", "display_name": "Gilles Gouaillardet", "link": "https://stackoverflow.com/users/8062491/gilles-gouaillardet"}, "edited": false, "score": 0, "creation_date": 1562781216, "post_id": 56957812, "comment_id": 100488507, "body": "@Gilles Gouaillardet yes, I written as shout as I could, sometimes not so clear. I wanted to say that (in one hand) I use intel compiler because has all inside (intrinsics, mpi optimized libraries...) If I use gcc with openmpi, maybe they are not so well integrated as intel and running time is bigger. On the other hand , the problem with intel is they are changing variables more often as openmpi or mpich (maybe I&#39;m wrong). So, I&#39;ve tried to explain why I want to avoid variables and find a classical way."}, {"owner": {"reputation": 7287, "user_id": 8062491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rd6rD.png?s=128&g=1", "display_name": "Gilles Gouaillardet", "link": "https://stackoverflow.com/users/8062491/gilles-gouaillardet"}, "edited": false, "score": 0, "creation_date": 1562810512, "post_id": 56957812, "comment_id": 100497078, "body": "my point was an other approach is to use Open MPI and the Intel compilers. I have a really hard time understanding what your problem is, so you might want to edit your question Keep in mind that MPI task binding is not part of the standard, and hence each MPI implementation has its own way of doing it."}, {"owner": {"reputation": 3, "user_id": 11519449, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-9wC50c5MHN0/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7qjAD2QheOImDgv9mprluQ3yEZTdw/mo/photo.jpg?sz=128", "display_name": "mimi", "link": "https://stackoverflow.com/users/11519449/mimi"}, "reply_to_user": {"reputation": 7287, "user_id": 8062491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rd6rD.png?s=128&g=1", "display_name": "Gilles Gouaillardet", "link": "https://stackoverflow.com/users/8062491/gilles-gouaillardet"}, "edited": false, "score": 0, "creation_date": 1562860793, "post_id": 56957812, "comment_id": 100520787, "body": "@Gilles Gouaillardet I&#39;ve cleared up everything (including my mind :-))"}, {"owner": {"reputation": 7287, "user_id": 8062491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rd6rD.png?s=128&g=1", "display_name": "Gilles Gouaillardet", "link": "https://stackoverflow.com/users/8062491/gilles-gouaillardet"}, "edited": false, "score": 0, "creation_date": 1562891301, "post_id": 56957812, "comment_id": 100531201, "body": "MPI oversubscribtion is when you ask more MPI tasks than slots. What is the problem you are trying to fix ?"}, {"owner": {"reputation": 3, "user_id": 11519449, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-9wC50c5MHN0/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7qjAD2QheOImDgv9mprluQ3yEZTdw/mo/photo.jpg?sz=128", "display_name": "mimi", "link": "https://stackoverflow.com/users/11519449/mimi"}, "reply_to_user": {"reputation": 7287, "user_id": 8062491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rd6rD.png?s=128&g=1", "display_name": "Gilles Gouaillardet", "link": "https://stackoverflow.com/users/8062491/gilles-gouaillardet"}, "edited": false, "score": 0, "creation_date": 1562907394, "post_id": 56957812, "comment_id": 100533944, "body": "@Gilles Gouaillardet I know you can do more than &quot;overquestioning&quot;, you helped me 2 months ago on other mpi post. So, do you need a code? The code what I have is long and reads some data from txt files, it takes me a bit to clean it up. Or is my post still not clear enough, now? anyway, thank you for supporting me"}, {"owner": {"reputation": 7287, "user_id": 8062491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rd6rD.png?s=128&g=1", "display_name": "Gilles Gouaillardet", "link": "https://stackoverflow.com/users/8062491/gilles-gouaillardet"}, "edited": false, "score": 0, "creation_date": 1562909509, "post_id": 56957812, "comment_id": 100534559, "body": "I do not understand your problem statement yet."}, {"owner": {"reputation": 7287, "user_id": 8062491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rd6rD.png?s=128&g=1", "display_name": "Gilles Gouaillardet", "link": "https://stackoverflow.com/users/8062491/gilles-gouaillardet"}, "edited": false, "score": 0, "creation_date": 1562985372, "post_id": 56957812, "comment_id": 100563084, "body": "oversubscription is when <b>you</b> decide to start more MPI tasks than available slots. It is trivial to avoid it : do not start more MPI tasks than available slots. If a naive implementation of your algorithm would require more MPI tasks than available slots, then change your implementation. A typical approach is to use a pool of workers (1 worker = 1 MPI task running on a dedicated slot). An example is at <a href=\"http://etutorials.org/Linux+systems/cluster+computing+with+linux/Part+II+Parallel+Programming/Chapter+8+Parallel+Programming+with+MPI/8.2+Manager+Worker+Example/\" rel=\"nofollow noreferrer\">etutorials.org/Linux+systems/cluster+computing+with+linux/&hellip;</a>"}, {"owner": {"reputation": 3, "user_id": 11519449, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-9wC50c5MHN0/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7qjAD2QheOImDgv9mprluQ3yEZTdw/mo/photo.jpg?sz=128", "display_name": "mimi", "link": "https://stackoverflow.com/users/11519449/mimi"}, "reply_to_user": {"reputation": 7287, "user_id": 8062491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rd6rD.png?s=128&g=1", "display_name": "Gilles Gouaillardet", "link": "https://stackoverflow.com/users/8062491/gilles-gouaillardet"}, "edited": false, "score": 0, "creation_date": 1563017317, "post_id": 56957812, "comment_id": 100568207, "body": "@Gilles Gouaillardet, this is my first &quot;date&quot; with oversubscription, so I agree it is naive. thank you for putting me on the right track again, we can consider this post solved !"}], "owner": {"reputation": 3, "user_id": 11519449, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-9wC50c5MHN0/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7qjAD2QheOImDgv9mprluQ3yEZTdw/mo/photo.jpg?sz=128", "display_name": "mimi", "link": "https://stackoverflow.com/users/11519449/mimi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 94, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1562945758, "creation_date": 1562693275, "last_edit_date": 1562945758, "question_id": 56957812, "link": "https://stackoverflow.com/questions/56957812/solving-mpi-oversubscribtion-using-other-methods-than-mpi-variables-in-c", "title": "solving mpi oversubscribtion using other methods than mpi variables in c", "body": "<p><strong>version 2 of my question, I hope more clear this time</strong></p>\n\n<p>is there any method to avoid mpi oversubscription other than mpi global/local variables?</p>\n\n<p>oversubscription comes with severe degradation of performance, in my case form 30 minutes in one node without mpi, to more than 3 hours in 2 nodes</p>\n\n<p>this is because more than one processes are trying to access in the same time, the same node</p>\n\n<p>maybe a loop which splits 300 processes in portions equal to number of nodes, or spawn a number of processes egual with number of nodes ... can avoid oversubscription</p>\n\n<p>any hint/example/link would be good</p>\n\n<p>thank you</p>\n"}, {"tags": ["c", "bit-manipulation", "bit-fields", "bitmask"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 5, "creation_date": 1562693000, "post_id": 56957720, "comment_id": 100453656, "body": "Bitmasks approach is much more portable and robust. Stick with it. Even though bitfields look convenient. Unless you don&#39;t care about the layout of the bits."}, {"owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 1, "creation_date": 1562693004, "post_id": 56957720, "comment_id": 100453657, "body": "Your first example is incorrect. You want to shift by the number that you use to shift in the <code>#define</code>, not by <code>FIELD_X</code> itself."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1562693392, "post_id": 56957720, "comment_id": 100453821, "body": "<code>int bool_a = (flags &amp; FIELD_A) &gt;&gt; FIELD_A_BIT_POS</code>; shorter <code>int bool_a = !!(flags &amp; FIELD_A);</code>. If you do not need to have 0 or 1 value (in C the <code>true</code> is any nonzero value) you can drop <code>&gt;&gt;</code> or <code>!!</code>"}, {"owner": {"reputation": 181, "user_id": 8351650, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2979e9f1415e57e46ad3e7cad184f91b?s=128&d=identicon&r=PG&f=1", "display_name": "nanoman", "link": "https://stackoverflow.com/users/8351650/nanoman"}, "edited": false, "score": 0, "creation_date": 1562693434, "post_id": 56957720, "comment_id": 100453839, "body": "Thank you for the corrections. I will edit my code to reflect them."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1562693516, "post_id": 56957720, "comment_id": 100453868, "body": "@EugeneSh. it is a very pedantic approach. If the OP is going the use the same toolchain (for example in the uC development) the positions are very well-defined."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 3, "creation_date": 1562694148, "post_id": 56957720, "comment_id": 100454120, "body": "@P__J__ This is true for any &quot;non-portable&quot; claim. But in the case of bit-fields it is not even clear right from the code which bit is going to be LSB and which is MSB. Also it is not clear what width of the whole bitfield would be. And some other funny things, discoverable only by experimentation or deep digging in the compiler documentation."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 3, "creation_date": 1562695306, "post_id": 56957720, "comment_id": 100454641, "body": "@P__J__ when coding, pedantry wins first place."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1562696090, "post_id": 56957720, "comment_id": 100454993, "body": "@EugeneSh. It is rather difficult to program uCs without knowing the compiler. C standard knowledge is definitely no sufficient"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 1, "creation_date": 1562697046, "post_id": 56957720, "comment_id": 100455383, "body": "<code>int field_a : 1;</code> is actually incorrect: an <code>int</code> bitfield with a single bit might be read as <code>-1</code> instead of <code>1</code> if set. You should write <code>unsigned int field_a : 1;</code>"}], "answers": [{"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 0, "last_activity_date": 1562695379, "creation_date": 1562695379, "answer_id": 56958310, "question_id": 56957720, "link": "https://stackoverflow.com/questions/56957720/bitfields-vs-bitmasks/56958310#56958310", "title": "Bitfields VS. Bitmasks", "body": "<blockquote>\n  <p>I know one can use bitmasks to isolate certain bits in a data structure, but why then bother with bitfields?</p>\n</blockquote>\n\n<p>One uses bitfields either to map a data structure whose field sizes do not all match your C implementation's built-in types, such as a TCP header, or simply to shrink the size of your data structure.</p>\n\n<p>You can indeed pack and unpack data manually by using masks and shifting, but bitfields provide a more convenient syntax for that.  In addition to just hiding the shifting and masking, bitfield access transparently handles sign extension issues and the special characteristics of <code>_Bool</code>, where appropriate.</p>\n\n<p>The tradeoff is a loss of control over the details.  If you pack and unpack manually, then you can have complete confidence and control of the layout, with great portability.  If you use bitfields, on the other hand, <em>and</em> you care about the details of how the bits are arranged, then you need to rely on implementation details or on extensions to ensure that you have the layout you want, if that's even possible from your implementation at all.</p>\n"}, {"comments": [{"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1562705082, "post_id": 56958790, "comment_id": 100458484, "body": "Maybe my interpretation of the standard is off here, but I think it&#39;s only implementation defined whether a bit-field is signed if you don&#39;t explicitly qualify its signedness.  From C11 standard 6.7.2.1p5: <i>A bit-field shall have a type that is a qualified or unqualified version of <code>_Bool</code>, <code>signed int</code>, <code>unsigned  int</code>, or some other implementation-defined type.</i>"}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 1, "creation_date": 1562705478, "post_id": 56958790, "comment_id": 100458643, "body": "Combine with footnote 125 to get a clearer picture:  <i>As specified in 6.7.2 above, if the actual type specifier used is <code>int</code> or a <code>typedef</code>-name defined as <code>int</code>, then it is implementation-defined whether the bit-field is signed or unsigned.</i>"}], "tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 4, "last_activity_date": 1562697465, "creation_date": 1562697465, "answer_id": 56958790, "question_id": 56957720, "link": "https://stackoverflow.com/questions/56957720/bitfields-vs-bitmasks/56958790#56958790", "title": "Bitfields VS. Bitmasks", "body": "<p>Bitfields are more handy to use than explicit bit masks, especially for lengths greater than 1. Hand coded bit twiddling is quite often broken in subtile ways.</p>\n\n<p>The main problem with bitfields is the imprecise specification:</p>\n\n<ul>\n<li><p>it is implementation defined whether signed typed bitfields can have negative values.</p></li>\n<li><p>the order and position of the bitfields in memory is implementation defined, which removes makes hardware mapping more risky. Even for a given endianness, the positions and order of bitfields are not specified precisely, which is a major shortcoming.</p></li>\n</ul>\n\n<p>Note in particular that <code>int field_a : 1;</code> is actually incorrect: an <code>int</code> bitfield with a single bit might be read as <code>-1</code> instead of <code>1</code> if set. You should write <code>unsigned int field_a : 1;</code></p>\n"}], "owner": {"reputation": 181, "user_id": 8351650, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2979e9f1415e57e46ad3e7cad184f91b?s=128&d=identicon&r=PG&f=1", "display_name": "nanoman", "link": "https://stackoverflow.com/users/8351650/nanoman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1203, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1562697465, "creation_date": 1562692928, "last_edit_date": 1562693504, "question_id": 56957720, "link": "https://stackoverflow.com/questions/56957720/bitfields-vs-bitmasks", "title": "Bitfields VS. Bitmasks", "body": "<p>I've had some experience in C before, however I have never seen the bitfields feature before. I know one can use bitmasks to isolate certain bits in a data structure, but why then bother with bitfields?</p>\n\n<p>For example, say the bits we want to isolate are the first 3 least significant bits. Then we can write:</p>\n\n<pre><code>/* our bitmasks */\n#define FIELD_A (1 &lt;&lt; 0)\n#define FIELD_B (1 &lt;&lt; 1)\n#define FIELD_C (1 &lt;&lt; 2)\n\nint main(void) \n{ \n    /* the data structure that contains our three fields */\n    uint8_t flags;\n\n    /* accessing field A (as a boolean) */\n    int bool_a = !!(flags &amp; FIELD_A);\n\n    /* accessing field B (as a boolean) */\n    int bool_b = !!(flags &amp; FIELD_B);\n\n    /* accessing field C (as a boolean) */\n    int bool_c = !!(flags &amp; FIELD_C);\n\n    return 0;\n}\n</code></pre>\n\n<p>Why would we choose to write this as:</p>\n\n<pre><code>static struct fields {\n    int field_a : 1;\n    int field_b : 1;\n    int field_c : 1;\n};\n\nint main(void) \n{ \n    /* the data structure that contains our three fields */\n    struct fields flags;\n\n    /* accessing field A */\n    int bit_a = flags.a;\n\n    /* accessing field B */\n    int bit_b = flags.b;\n\n    /* accessing field C */\n    int bit_c = flags.c;\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c#", "c", "interop"], "comments": [{"owner": {"reputation": 1151, "user_id": 9748260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cff9651774a7d2b50fe1d8d8ad30e57?s=128&d=identicon&r=PG&f=1", "display_name": "Sohaib Jundi", "link": "https://stackoverflow.com/users/9748260/sohaib-jundi"}, "edited": false, "score": 0, "creation_date": 1562693438, "post_id": 56957459, "comment_id": 100453842, "body": "Check this question: <a href=\"https://stackoverflow.com/q/1246486/9748260\">stackoverflow.com/q/1246486/9748260</a>"}, {"owner": {"reputation": 702, "user_id": 4261713, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/da2aa22c6a639ac66ac9f6e7a1436ed3?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Watts", "link": "https://stackoverflow.com/users/4261713/chris-watts"}, "reply_to_user": {"reputation": 1151, "user_id": 9748260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cff9651774a7d2b50fe1d8d8ad30e57?s=128&d=identicon&r=PG&f=1", "display_name": "Sohaib Jundi", "link": "https://stackoverflow.com/users/9748260/sohaib-jundi"}, "edited": false, "score": 0, "creation_date": 1562693842, "post_id": 56957459, "comment_id": 100453991, "body": "Thanks, i had seen this question already on my investigations, but i cannot identify any dependencies in the C code that arent being pulled in. If i call the c code from bash in the same folder it returns successfully."}, {"owner": {"reputation": 1151, "user_id": 9748260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cff9651774a7d2b50fe1d8d8ad30e57?s=128&d=identicon&r=PG&f=1", "display_name": "Sohaib Jundi", "link": "https://stackoverflow.com/users/9748260/sohaib-jundi"}, "edited": false, "score": 0, "creation_date": 1562693922, "post_id": 56957459, "comment_id": 100454021, "body": "Then try printing the working directory from the C# code an verify is it where the dll exists"}], "answers": [{"comments": [{"owner": {"reputation": 702, "user_id": 4261713, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/da2aa22c6a639ac66ac9f6e7a1436ed3?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Watts", "link": "https://stackoverflow.com/users/4261713/chris-watts"}, "edited": false, "score": 0, "creation_date": 1562703251, "post_id": 56958717, "comment_id": 100457838, "body": "Hi, thanks for this! Ill give it a go tomorrow.. Im not particularly good with C though, so that <code>extern</code> declaration, is that per function? Or per file? Is that basically making it cpp compatible?"}, {"owner": {"reputation": 702, "user_id": 4261713, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/da2aa22c6a639ac66ac9f6e7a1436ed3?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Watts", "link": "https://stackoverflow.com/users/4261713/chris-watts"}, "edited": false, "score": 0, "creation_date": 1562705339, "post_id": 56958717, "comment_id": 100458591, "body": "I guess it would look like this.. <a href=\"https://stackoverflow.com/questions/538134/exporting-functions-from-a-dll-with-dllexport\" title=\"exporting functions from a dll with dllexport\">stackoverflow.com/questions/538134/&hellip;</a> would declaring functions like that be compatible with linux/arm os? I see in the chosen answer that they ifdef win32 so makes me curious!"}, {"owner": {"reputation": 1151, "user_id": 9748260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cff9651774a7d2b50fe1d8d8ad30e57?s=128&d=identicon&r=PG&f=1", "display_name": "Sohaib Jundi", "link": "https://stackoverflow.com/users/9748260/sohaib-jundi"}, "reply_to_user": {"reputation": 702, "user_id": 4261713, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/da2aa22c6a639ac66ac9f6e7a1436ed3?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Watts", "link": "https://stackoverflow.com/users/4261713/chris-watts"}, "edited": false, "score": 0, "creation_date": 1562722402, "post_id": 56958717, "comment_id": 100462296, "body": "I&#39;m not really sure, never tried on linux.  It think the way of exporting the function from dll can be different than exporting from so."}], "tags": [], "owner": {"reputation": 1151, "user_id": 9748260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cff9651774a7d2b50fe1d8d8ad30e57?s=128&d=identicon&r=PG&f=1", "display_name": "Sohaib Jundi", "link": "https://stackoverflow.com/users/9748260/sohaib-jundi"}, "is_accepted": false, "score": 0, "last_activity_date": 1562697209, "creation_date": 1562697209, "answer_id": 56958717, "question_id": 56957459, "link": "https://stackoverflow.com/questions/56957459/dllimport-for-dotnet-core-returning-dllnotfoundexception-for-present-dll/56958717#56958717", "title": "DllImport for Dotnet core returning DLLNotFoundException for present DLL", "body": "<p>After some playing around, I managed to get an example to work.<br>\nFollow these steps:<br>\n1. export your function from the dll, i.e: add <code>extern \"C\" __declspec(dllexport)</code> to the function signature<br>\n2. Make sure that both the dll and your dotnet core application have the same architecture. don't keep the dotnet core as \"Any CPU\", force it to the same architecture as the dll. (project properties -> build -> platform target = x86 or x64)</p>\n"}, {"tags": [], "owner": {"reputation": 702, "user_id": 4261713, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/da2aa22c6a639ac66ac9f6e7a1436ed3?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Watts", "link": "https://stackoverflow.com/users/4261713/chris-watts"}, "is_accepted": true, "score": 0, "last_activity_date": 1562862428, "creation_date": 1562862428, "answer_id": 56993604, "question_id": 56957459, "link": "https://stackoverflow.com/questions/56957459/dllimport-for-dotnet-core-returning-dllnotfoundexception-for-present-dll/56993604#56993604", "title": "DllImport for Dotnet core returning DLLNotFoundException for present DLL", "body": "<p>I have found the solution.. the library was being compiled as a <code>.la</code> (statically linked library) rather than a <code>.so</code> (shared object) library. The <code>DllImport</code> doesnt work with statically linked libraries so.. a recompilation of the library into a shared object library has meant it will now find the dll (I also exported <code>LD_LIBRARY_PATH</code> as <code>pwd</code> to make sure it was in the search path..).</p>\n\n<p>Once this was in, the rest of the code fell into place. The matching dll import declaration for the version above was correct (from <strong>*EDIT 2 *</strong>) - using <code>ref uint</code>. So now I have to extend the methods supported in my interop class to fully support the library.</p>\n\n<p>Thanks for your help @Sohaib Jundi</p>\n"}], "owner": {"reputation": 702, "user_id": 4261713, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/da2aa22c6a639ac66ac9f6e7a1436ed3?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Watts", "link": "https://stackoverflow.com/users/4261713/chris-watts"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 359, "favorite_count": 0, "accepted_answer_id": 56993604, "answer_count": 2, "score": 0, "last_activity_date": 1562862428, "creation_date": 1562691773, "last_edit_date": 1562837664, "question_id": 56957459, "link": "https://stackoverflow.com/questions/56957459/dllimport-for-dotnet-core-returning-dllnotfoundexception-for-present-dll", "title": "DllImport for Dotnet core returning DLLNotFoundException for present DLL", "body": "<p>Over the past few days I have been trying to interface with a C library (built for an ARM platform) on linux, in dotnet core. All I am trying to do is call a simple function which (essentially) returns a string.</p>\n\n<p>However, I have no experience of using <code>DLLImport</code> or interop on the whole in C# and I am struggling.</p>\n\n<p>The C code looks like (with substitute names as I am using a work platform):</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>int version(int argc, char *argv[])\n{\n    return READ_DATA(0,\n            version, //callbackfunction\n            \"version: 0x%04x\\n\"); //formatting string\n}\n</code></pre>\n\n<pre class=\"lang-cs prettyprint-override\"><code>    public class Board\n    {\n        private Interop_Commands _commands = new Interop_Commands();\n\n        public string GetVersion()\n        {\n            return _commands.GetVersion();\n        }\n    }\n    internal class Interop_Commands\n    {\n        public const string LIBRARYPATH = \"libname\";\n        [DllImport(LIBRARYPATH,CharSet=CharSet.Unicode, CallingConvention =CallingConvention.Cdecl)]\n        public static extern int version(int argc, StringBuilder argv);\n\n        public string GetVersion()\n        {\n            var sb = new StringBuilder();\n            Console.WriteLine($\"Calling {nameof(version)}\");\n            version(0, sb);\n            Console.WriteLine($\"Called {nameof(version)}, got: {sb.ToString()}\");\n            return sb.ToString();\n        }\n    }\n</code></pre>\n\n<p>with the calling class (main for this very simple proof of concept/trial code):</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>    static void Main(string[] args)\n    {\n        Console.WriteLine(\"Getting Version from board..\");\n\n        var board = new Board();\n        Console.WriteLine(board.GetVersion());\n\n        Console.WriteLine(\"done\");\n        Console.ReadLine();\n    }\n</code></pre>\n\n<p>The folder structure is (simplified):</p>\n\n<blockquote>\n  <p>folder<br>\n  |--> Dll/runtime<br>\n  |--> libname   (note no .so here, just libname)</p>\n</blockquote>\n\n<p>Any help would be appreciated, I am finding examples of C imports/usages limited, and also finding examples limited for how to use custom libraries in dotnet core.</p>\n\n<p><strong><em>EDIT 1:</em></strong></p>\n\n<p>Following help from @Sohaib Jundi, I have added the <code>extern</code> so the signature is now: (it wouldnt compile with extern \"C\")</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>extern int version(int argc, char *argv[])\n</code></pre>\n\n<p>I am unsure what to try next.</p>\n\n<p>but dotnet core wont publish with x86 and target runtime set to <code>linux-arm</code>, just throws an unknown exception, with the log file not being very helpful..\nIf i use the compiled library with the previous code (<code>AnyCPU</code> + <code>linux-arm</code>), then the <code>DllNotFoundException</code> is still thrown</p>\n\n<p><strong>* EDIT 2: *</strong></p>\n\n<p>As it turns out, the original no extension file i was using appears to be an executable referencing a static library (which ends up compiled into the executable). rebuilding I have managed to get the static library separate, but still get the same <code>DllNotFoundException</code>. Does anyone know what the search procedure is for the <code>DllImport</code> on dotnet core?</p>\n\n<p>The interop/import code now looks like:</p>\n\n<pre><code>[DllImport(\"libname\", \n           CallingConvention =CallingConvention.Cdecl,\n           EntryPoint= \"version\")]\npublic static extern int version(ref uint val);\n</code></pre>\n\n<p>where the static lib code looks like:</p>\n\n<pre><code>extern int version(uint32_t *);\n</code></pre>\n"}, {"tags": ["c", "security", "encryption", "openssl"], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 11599880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6549f16f6e52e062a67348fd8cd52498?s=128&d=identicon&r=PG&f=1", "display_name": "moonking1863", "link": "https://stackoverflow.com/users/11599880/moonking1863"}, "edited": false, "score": 0, "creation_date": 1562746310, "post_id": 56965592, "comment_id": 100469395, "body": "Thanks for the comments. <code>EVP_ENCODE_CTX_new</code> and <code>EVP_ENCODE_CTX_free</code> are not available to me."}, {"owner": {"reputation": 17201, "user_id": 9014097, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2dJaU.png?s=128&g=1", "display_name": "Topaco", "link": "https://stackoverflow.com/users/9014097/topaco"}, "reply_to_user": {"reputation": 29, "user_id": 11599880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6549f16f6e52e062a67348fd8cd52498?s=128&d=identicon&r=PG&f=1", "display_name": "moonking1863", "link": "https://stackoverflow.com/users/11599880/moonking1863"}, "edited": false, "score": 0, "creation_date": 1562757038, "post_id": 56965592, "comment_id": 100475441, "body": "As a reminder: You can also use the <code>-A</code>-option when decrypting with <code>openssl</code>! Otherwise, you will need to find a Base64 encoding compatible with your environment that takes line breaks into account. It&#39;s hard to recommend anything because I don&#39;t know your environment, but there are a number of implementations on the Internet, e.g. <a href=\"https://gist.github.com/barrysteyn/7308212\" rel=\"nofollow noreferrer\">gist.github.com/barrysteyn/7308212</a>. Here the flag <code>BIO_FLAGS_BASE64_NO_NL</code> is set in the <code>Base64Encode</code> function to write the Base64 string in one line. Possibly this method can be adapted to take line breaks into account (I haven&#39;t tried it though)."}], "tags": [], "owner": {"reputation": 17201, "user_id": 9014097, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2dJaU.png?s=128&g=1", "display_name": "Topaco", "link": "https://stackoverflow.com/users/9014097/topaco"}, "is_accepted": false, "score": 0, "last_activity_date": 1562745315, "last_edit_date": 1562745315, "creation_date": 1562744052, "answer_id": 56965592, "question_id": 56957238, "link": "https://stackoverflow.com/questions/56957238/encryption-using-openssl-evp-library-and-decryption-using-openssl-enc-terminal-c/56965592#56965592", "title": "Encryption using Openssl EVP library and decryption using openssl enc terminal command fails", "body": "<p>I suspect it's the Base64-encoding.</p>\n\n<p>In the <code>openssl</code> statement for decryption, the <code>-base64</code> option is used without the <code>-A</code> option. Therefore, a formatted Base64-string is expected, i.e. after each 64 byte and at the end there are line breaks, see <a href=\"https://www.openssl.org/docs/man1.0.2/man1/openssl-enc.html\" rel=\"nofollow noreferrer\"><code>-A</code>-Option</a>.</p>\n\n<p>However, the current <code>encode</code> function does <em>not</em> do this, but writes the entire Base64-string in a <em>single</em> line.</p>\n\n<p>The problem can be solved by</p>\n\n<ul>\n<li><p>either adding the <code>-A</code> option to the <code>openssl</code> statement for decryption: <code>-base64 -A</code></p></li>\n<li><p>or modifying the <code>encode</code> method to include line breaks, e.g. with <a href=\"https://www.openssl.org/docs/man1.0.2/man3/EVP_EncodeUpdate.html\" rel=\"nofollow noreferrer\"><code>EVP_EncodeUpdate</code></a> etc.):</p>\n\n<pre><code>int CBase64::encode(const unsigned char* msg, const size_t msg_len, char** b64_msg) {\n    int len, total = 0;\n    EVP_ENCODE_CTX *ectx = EVP_ENCODE_CTX_new();\n    EVP_EncodeInit(ectx);\n    EVP_EncodeUpdate(ectx, (unsigned char *)*b64_msg, &amp;len, msg, msg_len);\n    total += len;\n    EVP_EncodeFinal(ectx, (unsigned char *)*b64_msg + len, &amp;len);\n    total += len;\n    EVP_ENCODE_CTX_free(ectx);\n    return total;\n}\n</code></pre></li>\n</ul>\n"}], "owner": {"reputation": 29, "user_id": 11599880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6549f16f6e52e062a67348fd8cd52498?s=128&d=identicon&r=PG&f=1", "display_name": "moonking1863", "link": "https://stackoverflow.com/users/11599880/moonking1863"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 345, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1562745315, "creation_date": 1562690822, "last_edit_date": 1562692961, "question_id": 56957238, "link": "https://stackoverflow.com/questions/56957238/encryption-using-openssl-evp-library-and-decryption-using-openssl-enc-terminal-c", "title": "Encryption using Openssl EVP library and decryption using openssl enc terminal command fails", "body": "<p>I am trying to encrypt a string using OpenSSL EVP library, and decrypt subsequently using the openssl command from a linux terminal.\nOpenSSL command for decryption:</p>\n\n<pre><code>openssl enc -aes-256-cbc -base64 -salt -d -md md5 -k &lt;passphrase&gt; -in encrypt.txt -out plain.txt\n</code></pre>\n\n<p>Encryption code:</p>\n\n<pre><code>int CAES::encrypt(const char* msg, unsigned char** encrypted_message, const size_t msg_len, const unsigned char *key, unsigned char *iv, const unsigned char* salt) \n{\n    //this buffer will hold the salt and the cipher\n    const int buffer_len ( CAES::salt_info_size + std::max((int)(msg_len * 2), EVP_MAX_KEY_LENGTH) );\n    unsigned char* buffer = new unsigned char[buffer_len];\n    //this will be a pointer to the cipher only\n    unsigned char* cipher = CAES::salt_info_size + buffer;\n    size_t bytes_encrypted(0);\n    bool encryption_error(true);\n    EVP_CIPHER_CTX *cipher_ctx( create_cipher_ctx(encryption, key, iv) );\n    (void) EVP_CIPHER_CTX_set_key_length(cipher_ctx, EVP_MAX_KEY_LENGTH);\n        size_t cipher_len(0);\n    int temp_len(0);\n    if( EVP_EncryptUpdate(cipher_ctx, cipher, &amp;temp_len, (unsigned char *)msg, strlen(msg)) )\n    {\n        cipher_len = temp_len;\n        if( EVP_EncryptFinal_ex(cipher_ctx, cipher + temp_len, &amp;temp_len) )\n        {\n            cipher_len += temp_len;\n        }\n        cipher[cipher_len] = '\\0';\n        encryption_error = false;\n        bytes_encrypted = cipher_len;\n    }\n    memcpy(buffer + 0 , CAES::salt_tag, CAES::salt_tag_size);\n    memcpy(buffer + CAES::salt_tag_size, salt, CAES::salt_size);\n    memcpy(*encrypted_message, buffer, CAES::salt_info_size + bytes_encrypted);\n    EVP_CIPHER_CTX_free(cipher_ctx);\n    delete[] buffer;\n    return CAES::salt_info_size + bytes_encrypted;\n}\n</code></pre>\n\n<p>Code to encode the encrypted string from above to base64:</p>\n\n<pre><code>int CBase64::encode(const unsigned char* msg, const size_t msg_len, char** b64_msg) {\n  size_t bytes_encoded = 0;\n  bytes_encoded = EVP_EncodeBlock((unsigned char *) *b64_msg, msg, msg_len);\n  return bytes_encoded;\n}\n</code></pre>\n\n<p>Key and IV derivation</p>\n\n<pre><code>void CAES::init_key_iv(const std::string&amp; pass, const unsigned char* salt, unsigned char* key, unsigned char* iv )\n{\n  const unsigned char * pass_key = reinterpret_cast&lt;const unsigned char*&gt;( pass.c_str() );\n  const size_t pass_key_len ( pass.size() );\n  EVP_BytesToKey(CAES::cipher_type, CAES::msg_digest_type, salt, pass_key, pass_key_len, 1, key, iv);\n}\n</code></pre>\n\n<p>The following are the key sizes and salt derivation:</p>\n\n<pre><code>unsigned char salt[8] = {};\nunsigned char key[32] = {};\nunsigned char iv_enc[16] = {};\nRAND_bytes(salt, 8);\n</code></pre>\n\n<p>Case 1:</p>\n\n<pre><code>const char* password = \"@N\";\nconst char* msg = \"neo4j\";\n</code></pre>\n\n<p>On trying to decrypt I get the following:</p>\n\n<pre><code>bad decrypt\n140589946300064:error:06065064:digital envelope routines:EVP_DecryptFinal_ex:bad decrypt:evp_enc.c:539:\n</code></pre>\n\n<p>Case 2:</p>\n\n<pre><code>const char* password = \"eemnsis\";\nconst char* msg = \"This is long message, repeating 10 times.This is long message, repeating 10 times.This is long message, repeating 10 times.This is long message, repeating 10 times.This is long message, repeating 10 times.This is long message, repeating 10 times.This is long message, repeating 10 times.This is long message, repeating 10 times.This is long message, repeating 10 times.This is long message, repeating 10 times.\";\n</code></pre>\n\n<p>On trying to decrypt I get the following:</p>\n\n<pre><code>error reading input file\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 4, "creation_date": 1562689663, "post_id": 56956953, "comment_id": 100452265, "body": "<code>total</code> is uninitialized. Also performing <code>==</code> on floats is a dangerous game."}, {"owner": {"reputation": 5101, "user_id": 700170, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gZ8hw.png?s=128&g=1", "display_name": "Morten Jensen", "link": "https://stackoverflow.com/users/700170/morten-jensen"}, "edited": false, "score": 1, "creation_date": 1562689745, "post_id": 56956953, "comment_id": 100452297, "body": "<code>total += (avg * grade)</code> &lt;- this is undefined behavior when <code>total</code> is uninitialized"}, {"owner": {"reputation": 77, "user_id": 9338516, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e6e83c118ccd26434de73f0d4971f62?s=128&d=identicon&r=PG&f=1", "display_name": "ido91198", "link": "https://stackoverflow.com/users/9338516/ido91198"}, "edited": false, "score": 0, "creation_date": 1562690156, "post_id": 56956953, "comment_id": 100452479, "body": "Thank you! I&#39;ll change it! And why is it dangerous to perform == on floats?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1562690217, "post_id": 56956953, "comment_id": 100452505, "body": "Because <code>float</code> representation is imprecise and may not have the <i>exact</i> same value as the one you are comparing to."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1562690771, "post_id": 56956953, "comment_id": 100452755, "body": "Please read <a href=\"https://stackoverflow.com/questions/4682889/is-floating-point-ever-ok\">this</a> for more about comparing floating point values. There is a lot of information about it, very easy to find. In this case, <code>if(grade &lt; 0)</code> is safer, <i>even though</i> <code>-1</code> entered will be an exact representation. It&#39;s a better catch."}, {"owner": {"reputation": 77, "user_id": 9338516, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e6e83c118ccd26434de73f0d4971f62?s=128&d=identicon&r=PG&f=1", "display_name": "ido91198", "link": "https://stackoverflow.com/users/9338516/ido91198"}, "edited": false, "score": 0, "creation_date": 1562690829, "post_id": 56956953, "comment_id": 100452783, "body": "Thanks! I&#39;ll read!"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1562692682, "post_id": 56956953, "comment_id": 100453522, "body": "@EugeneSh.: When the user enters \u201c-1\u201d for the <code>scanf</code> to <code>grade</code>, <code>grade</code> will have the value \u22121, and comparing it with <code>==</code> is not dangerous."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1562692789, "post_id": 56956953, "comment_id": 100453558, "body": "@EricPostpischil Won&#39;t the RHS of <code>==</code> be converted to <code>double</code>? While LHS to <code>float</code> and then to <code>double</code>."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1562693058, "post_id": 56956953, "comment_id": 100453679, "body": "@EugeneSh.: So? The result of converting a <code>float</code> value of \u22121 to <code>double</code> is \u22121."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1562693189, "post_id": 56956953, "comment_id": 100453729, "body": "@EricPostpischil I am not talking about the specific value, but about general approach. This is why I said it is dangerous and not wrong in this case. In the previous comment I assumed you are pointing to the rule saying that conversion of the literal <code>1</code> to <code>double</code> will follow the same rules as the conversion performed by <code>scanf</code>"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1562693488, "post_id": 56956953, "comment_id": 100453859, "body": "@EugeneSh.: It is not dangerous. <code>==</code> is in fact one floating-point operation that is performed perfectly\u2014it has no error. If the two operands are equal, it evaluates to true. Otherwise, it evaluates to false. And the statement that the <code>float</code> representation is imprecise is false. Per the IEEE-754 specification, and the C standard\u2019s description of floating-point, a floating-point object represents one specific number (or NaN or infinity) exactly. It is not imprecise at all. The <b>operations</b>, not the <b>numbers</b>, introduce rounding. And there is not going to be any rounding error with \u22121."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1562693609, "post_id": 56956953, "comment_id": 100453900, "body": "@EugeneSh.: Furthermore, your question about converting to <code>double</code> suggests you think that might cause some sort of error. But every value representable in <code>float</code> is representable in <code>double</code> (C 2018 6.2.5 10). So the conversion never rounds anything; the conversion of an actual <code>float</code> value (versus temporary values that C permits with excess precision) to <code>double</code> is always exact."}], "answers": [{"comments": [{"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1562874496, "post_id": 56957232, "comment_id": 100526741, "body": "Better if you use a float literal, like <code>0.0F</code> to initialize <code>total</code>.  Initializing floating point variables with integer literals is good just to impress students because C is capable of doing it.  Something that has given far more problems than solved them."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1562881695, "post_id": 56957232, "comment_id": 100529299, "body": "@LuisColorado: you have a point, making floating point constants more explicit is better. On the same note, type <code>float</code> is not a good choice anyway, <code>double</code> would be much better suited for most floating point uses."}], "tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": true, "score": 3, "last_activity_date": 1562881709, "last_edit_date": 1562881709, "creation_date": 1562690792, "answer_id": 56957232, "question_id": 56956953, "link": "https://stackoverflow.com/questions/56956953/is-there-a-problem-with-this-code-sometimes-i-get-the-correct-answer-and-someti/56957232#56957232", "title": "Is there a problem with this code? Sometimes I get the correct answer and sometimes a really big number", "body": "<p>The program has undefined behavior because the local variable <code>total</code> is uninitialized.</p>\n\n<p>Initialize it to <code>0</code> and test the return value of <code>scanf()</code> to avoid undefined behavior, which explains your observations.</p>\n\n<p>Here is a corrected version:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdio.h&gt;\n\nint main() {\n    float pts = 0.0;\n    float total = 0.0;\n    float avg;\n    float grade;\n\n    for (;;) {\n        printf(\"Enter a Course Grade or -1 to exit: \");\n        if (scanf(\"%f\", &amp;grade) != 1 || grade == -1)\n            break;\n        printf(\"Enter a the amount of points that the course is worth: \");\n        if (scanf(\"%f\", &amp;avg) != 1)\n            break\n        pts += avg;\n        total += avg * grade;\n        printf(\"%f\\n\", total);\n    }\n    printf(\"%f\\n\", total / pts);\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 77, "user_id": 9338516, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e6e83c118ccd26434de73f0d4971f62?s=128&d=identicon&r=PG&f=1", "display_name": "ido91198", "link": "https://stackoverflow.com/users/9338516/ido91198"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 56957232, "answer_count": 1, "score": 0, "last_activity_date": 1562881709, "creation_date": 1562689609, "last_edit_date": 1562691189, "question_id": 56956953, "link": "https://stackoverflow.com/questions/56956953/is-there-a-problem-with-this-code-sometimes-i-get-the-correct-answer-and-someti", "title": "Is there a problem with this code? Sometimes I get the correct answer and sometimes a really big number", "body": "<p>Sometimes I get the right answer, like when I enter <code>87</code> and <code>3</code> it gives me back <code>261, but when I exit the program and re-run it, sometimes it returns</code>45481185383493847891312640.000000`, or some other crazy number.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main() {\n    float pts = 0;\n    float avg;\n    float grade;\n    float total;\n    int f = 1;\n\n    while (f == 1) {\n        printf(\"Choose a Course Grade, and the amount of points that the course is worth: \\n\"\n               \"Enter -1 at the beginning if you want to exit\\n\");\n        scanf(\"%f %f\", &amp;grade, &amp;avg);\n        if (grade == -1) {\n            break;\n        }\n        pts += avg;\n        total += (avg * grade);\n        printf(\"%f\\n\", total);\n    }\n    printf(\"%f\\n\", (total / pts));\n}\n</code></pre>\n"}, {"tags": ["c", "gcc", "makefile", "cmake"], "comments": [{"owner": {"reputation": 152528, "user_id": 981959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04798ba8ef6591a9c23c5868dc0bf664?s=128&d=identicon&r=PG", "display_name": "Jonathan Wakely", "link": "https://stackoverflow.com/users/981959/jonathan-wakely"}, "edited": false, "score": 2, "creation_date": 1562689015, "post_id": 56956729, "comment_id": 100451920, "body": "The CMake file uses <code>${LIBRARY_NAME}static</code> which means it is supposed to be using <code>-lccurlstatic</code> but the <code>LIBRARY_NAME</code> variable is not set. Either it&#39;s a bug in the CMake config, or you&#39;re not following the instructions properly."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1562689569, "post_id": 56956729, "comment_id": 100452219, "body": "Also, <code>$LD_LIBRARY_PATH</code> deals with finding shared libraries <i>at run time</i>.  It is not typically related to finding development libraries at link time, or to static libraries at all."}, {"owner": {"reputation": 13, "user_id": 10858386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d483e45e004883cf978059eff7ac5514?s=128&d=identicon&r=PG&f=1", "display_name": "Brodario", "link": "https://stackoverflow.com/users/10858386/brodario"}, "reply_to_user": {"reputation": 152528, "user_id": 981959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04798ba8ef6591a9c23c5868dc0bf664?s=128&d=identicon&r=PG", "display_name": "Jonathan Wakely", "link": "https://stackoverflow.com/users/981959/jonathan-wakely"}, "edited": false, "score": 0, "creation_date": 1562691602, "post_id": 56956729, "comment_id": 100453133, "body": "Thanks @JonathanWakely. The instructions say : &quot;This requires iotaledger/ccurl to be built (done) and in the library path&quot;. My LD_LIBRARY_PATH setting is useless, according to JohnBollinger. So what should I do?"}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1562701551, "post_id": 56956729, "comment_id": 100457213, "body": "&quot;So what should I do?&quot; - Report the problem to the project&#39;s developers."}], "owner": {"reputation": 13, "user_id": 10858386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d483e45e004883cf978059eff7ac5514?s=128&d=identicon&r=PG&f=1", "display_name": "Brodario", "link": "https://stackoverflow.com/users/10858386/brodario"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 122, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1562688749, "creation_date": 1562688749, "question_id": 56956729, "link": "https://stackoverflow.com/questions/56956729/cannot-find-lstatic", "title": "Cannot find -lstatic", "body": "<p>I'm trying to install ccurl-cli from this git repo:\n<a href=\"https://github.com/iotaledger/ccurl/tree/master/src/cli\" rel=\"nofollow noreferrer\">https://github.com/iotaledger/ccurl/tree/master/src/cli</a></p>\n\n<p>Following the README.md I get this error:</p>\n\n<pre><code>[ 10%] Linking C executable ccurld\n/usr/bin/ld: cannot find -lstatic\ncollect2: error: ld returned 1 exit status\nCMakeFiles/ccurld.dir/build.make:83: recipe for target 'ccurld' failed\nmake[2]: *** [ccurld] Error 1\nCMakeFiles/Makefile2:83: recipe for target 'CMakeFiles/ccurld.dir/all' failed\nmake[1]: *** [CMakeFiles/ccurld.dir/all] Error 2\nMakefile:129: recipe for target 'all' failed\nmake: *** [all] Error 2\n</code></pre>\n\n<p>I have already built ccurl and added it in the library path in this way:</p>\n\n<pre><code># set PATH so it includes user's private bin directories\nPATH=\"$HOME/bin:$HOME/.local/bin:$PATH\"\nLD_LIBRARY_PATH=/home/dario/ccurl\nexport LD_LIBRARY_PATH=$LD_LIBRARY_PATH\n</code></pre>\n\n<p>I can find libstatic.a (-lstatic) nowhere.\nIt is only mentioned in file ccurl/src/cli/CMakeFiles/ccurld.dir/link.txt</p>\n\n<blockquote>\n  <p>/usr/bin/cc   -rdynamic -Wl,-lpthread CMakeFiles/ccurld.dir/ccurld.o  -o ccurld -lstatic </p>\n</blockquote>\n"}, {"tags": ["c", "performance", "function-pointers"], "comments": [{"owner": {"reputation": 5813, "user_id": 1075282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70efe94a6c2237ec96f429402a03a27d?s=128&d=identicon&r=PG", "display_name": "Renat", "link": "https://stackoverflow.com/users/1075282/renat"}, "edited": false, "score": 1, "creation_date": 1562688428, "post_id": 56956260, "comment_id": 100451591, "body": "The issue with pointers to functions is that concrete function is not known at compile time. Such a knowledge about specific function at compile time allows for compiler to make optimizations (I would guess that for O3 option compiler parallelized computations by using <a href=\"https://en.wikipedia.org/wiki/SIMD\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/SIMD</a> feature of CPU). You might try to use <code>c++</code> with its templates, which are compile time polymorphism"}, {"owner": {"reputation": 2174, "user_id": 3349368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57c9f50cb5783614c67eef86caf63139?s=128&d=identicon&r=PG", "display_name": "Paul Belanger", "link": "https://stackoverflow.com/users/3349368/paul-belanger"}, "edited": false, "score": 1, "creation_date": 1562688655, "post_id": 56956260, "comment_id": 100451719, "body": "With -O3, the compiler may also be inlining the function calls -- this generally can&#39;t be done with function pointers, as the actual code of the function being called can&#39;t be known ahead of time."}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 9649858, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "koipond", "link": "https://stackoverflow.com/users/9649858/koipond"}, "edited": false, "score": 0, "creation_date": 1562788830, "post_id": 56956969, "comment_id": 100491758, "body": "Thanks for your reply! So the main thing seems to be the inlining of the function, which is not happening when I use function pointers. Also, I have not profiled my code yet, because it not yet finshed... But I will definately do that once I have a functioning version. Is inlining always faster, or does it depend on the size of the function and the amount of iterations in the for loop. And what about while loops?"}, {"owner": {"reputation": 2174, "user_id": 3349368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57c9f50cb5783614c67eef86caf63139?s=128&d=identicon&r=PG", "display_name": "Paul Belanger", "link": "https://stackoverflow.com/users/3349368/paul-belanger"}, "reply_to_user": {"reputation": 43, "user_id": 9649858, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "koipond", "link": "https://stackoverflow.com/users/9649858/koipond"}, "edited": false, "score": 1, "creation_date": 1562849885, "post_id": 56956969, "comment_id": 100514135, "body": "Generally the compiler is pretty smart about deciding when to inline functions, usually based on their assembly length. The amount of iterations of the for loop shouldn&#39;t matter too much."}, {"owner": {"reputation": 2174, "user_id": 3349368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57c9f50cb5783614c67eef86caf63139?s=128&d=identicon&r=PG", "display_name": "Paul Belanger", "link": "https://stackoverflow.com/users/3349368/paul-belanger"}, "reply_to_user": {"reputation": 43, "user_id": 9649858, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "koipond", "link": "https://stackoverflow.com/users/9649858/koipond"}, "edited": false, "score": 1, "creation_date": 1562850021, "post_id": 56956969, "comment_id": 100514229, "body": "If you want to still use function pointers and get some of the performance benefits of static dispatch (ie your method1), consider keeping the dynamic dispatch in the level above the for loop - so each implementation of the method has its own for loop. This way you&#39;ll only have to pay the penalty of the dynamic dispatch once before the loop starts instead of every iteration of the loop, and you give back the compiler&#39;s ability to inline the function call into the loop."}, {"owner": {"reputation": 2174, "user_id": 3349368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57c9f50cb5783614c67eef86caf63139?s=128&d=identicon&r=PG", "display_name": "Paul Belanger", "link": "https://stackoverflow.com/users/3349368/paul-belanger"}, "reply_to_user": {"reputation": 43, "user_id": 9649858, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "koipond", "link": "https://stackoverflow.com/users/9649858/koipond"}, "edited": false, "score": 1, "creation_date": 1562850141, "post_id": 56956969, "comment_id": 100514324, "body": "Here&#39;s a good video that describes some of the things that happen on the low-level CPU side that you can exploit to make code run faster in some situations: <a href=\"https://www.youtube.com/watch?v=BP6NxVxDQIs\" rel=\"nofollow noreferrer\">youtube.com/watch?v=BP6NxVxDQIs</a>. Keep in mind though that optimizations like this should only be considered after you&#39;ve done all the other stuff, like reducing the algorighmic complexity of your functions, etc."}, {"owner": {"reputation": 43, "user_id": 9649858, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "koipond", "link": "https://stackoverflow.com/users/9649858/koipond"}, "edited": false, "score": 0, "creation_date": 1562867880, "post_id": 56956969, "comment_id": 100524069, "body": "Ahh so then I would just move the for into the functions and then I still get the inling benefits, or rather I am inlining it myself. I think I will try to never call a function pointer inside a loop but rather move the loop into the function and call the function pointer instead. Thanks for the video, that is some powerful knowledge for when the code is finished! I will definitely have a go at those optimization strategies :)"}], "tags": [], "owner": {"reputation": 2174, "user_id": 3349368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57c9f50cb5783614c67eef86caf63139?s=128&d=identicon&r=PG", "display_name": "Paul Belanger", "link": "https://stackoverflow.com/users/3349368/paul-belanger"}, "is_accepted": true, "score": 4, "last_activity_date": 1562690127, "last_edit_date": 1562690127, "creation_date": 1562689682, "answer_id": 56956969, "question_id": 56956260, "link": "https://stackoverflow.com/questions/56956260/how-to-optimize-a-decision-in-a-cfd-c-code/56956969#56956969", "title": "How to optimize a decision in a CFD C code", "body": "<p>Here is a disassembly view of two implementations of similar functions: <a href=\"https://c.godbolt.org/z/l24Zhl\" rel=\"nofollow noreferrer\">https://c.godbolt.org/z/l24Zhl</a></p>\n\n<p>Note that with -O2, the first method inlines the calls to <code>f_cube</code> and <code>f_square</code> (note no calls to the functions in the assembly), but the second version does not. </p>\n\n<p>Most likely, the first version is then further sped-up due to <a href=\"https://en.wikipedia.org/wiki/Branch_predictor\" rel=\"nofollow noreferrer\">Branch Prediction</a> on the processor. </p>\n\n<p>Have you profiled your code and found that this area is a bottleneck? Remember that you make the greatest speed gains by optimizing the most-used code first. Remember: first make it work, then make it fast.</p>\n"}], "owner": {"reputation": 43, "user_id": 9649858, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "koipond", "link": "https://stackoverflow.com/users/9649858/koipond"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 56956969, "answer_count": 1, "score": 3, "last_activity_date": 1562690127, "creation_date": 1562687065, "last_edit_date": 1562688013, "question_id": 56956260, "link": "https://stackoverflow.com/questions/56956260/how-to-optimize-a-decision-in-a-cfd-c-code", "title": "How to optimize a decision in a CFD C code", "body": "<p>I want to optimize the use of different functions in a <a href=\"https://en.m.wikipedia.org/wiki/Computational_fluid_dynamics\" rel=\"nofollow noreferrer\">CFD</a> code, which the user can choose at runtime via a config file which is read by the program.</p>\n\n<p>I came up with a minimal working example, where there are two separate functions with one input. One squares the input and one cubes it. Via command line option the user can choose which function to use. The code the squares/cubes a bunch of numbers (it calculates the integral from 0 to 1 of either x^2 or x^3, depending which function was chosen) in a for loop and outputs the results. The first variant is just a switch case in a for loop (case1). The second thing I tries was a function pointer, which is set before the loop (case2). The third thing I did was selectively compiling only the function that the user intends to use with the use of preprocessor commands (case3). </p>\n\n<p>case1:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt;\n\ndouble f_square(double x) {return x * x;}\n\ndouble f_cube(double x) {return x * x * x;}\n\nint main(int argc, char *argv[])\n{\n    double x;\n    double sum = 0;\n    double del_x = 4e-10;\n\n    printf(\"Speed test -- no optimisation\\n\");\n\n    clock_t startClock = clock();\n    for (x = 0; x &lt; 1; x += del_x) {\n        switch (argv[1][0]) {\n        case '2':\n            sum += f_square(x) * del_x;\n            break;\n        case '3':\n            sum += f_cube(x) * del_x;\n            break;\n        default:\n            printf(\"Invalid choice! Abort\\n\");\n            exit(1);\n        }\n    }\n    clock_t endClock = clock();\n\n    printf(\"Int_{0}^{1} x^%c: %.8g\\n\", argv[1][0], sum);\n    printf(\"Execution time: %.6f\\n\", (endClock - startClock) / (double)CLOCKS_PER_SEC);\n}\n\n</code></pre>\n\n<p>case2:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt;\n\ndouble f_square(double x) {return x * x;}\n\ndouble f_cube(double x) {return x * x * x;}\n\nint main(int argc, char *argv[])\n{\n    double x;\n    double sum = 0;\n    double del_x = 4e-10;\n    double (*f)(double);\n\n    printf(\"Speed test -- function pointers\\n\");\n\n    switch (argv[1][0]) {\n    case '2':\n        f = &amp;f_square;\n        break;\n    case '3':\n        f = &amp;f_cube;\n        break;\n    default:\n        printf(\"Invalid choice! Abort\\n\");\n        exit(1);\n    }\n\n    clock_t startClock = clock();\n    for (x = 0; x &lt; 1; x += del_x) {\n        sum += f(x) * del_x;\n    }\n    clock_t endClock = clock();\n\n    printf(\"Int_{0}^{1} x^%c: %.8g\\n\", argv[1][0], sum);\n    printf(\"Execution time: %.6f\\n\", (endClock - startClock) / (double)CLOCKS_PER_SEC);\n}\n\n</code></pre>\n\n<p>case3:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt;\n\n#ifdef SQUARE\ndouble f(double x) {return x * x;}\n#endif\n\n#ifdef CUBE\ndouble f(double x) {return x * x * x;}\n#endif\n\nint main(void)\n{\n    double x;\n    double sum = 0;\n    double del_x = 4e-10;\n\n    printf(\"Speed test -- selective compilation\\n\");\n\n    clock_t startClock = clock();\n    for (x = 0; x &lt; 1; x += del_x) {\n        sum += f(x) * del_x;\n    }\n    clock_t endClock = clock();\n\n    #ifdef SQUARE\n    printf(\"Int_{0}^{1} x^2: %.8g\\n\", sum);\n    #endif\n    #ifdef CUBE\n    printf(\"Int_{0}^{1} x^3: %.8g\\n\", sum);\n    #endif\n    printf(\"Execution time: %.6f\\n\", (endClock - startClock) / (double)CLOCKS_PER_SEC);\n}\n\n</code></pre>\n\n<p>When measuring the execution times I found something odd:</p>\n\n<ul>\n<li>with O0 I got the distribution I expected, case3 was the fastest, followed by case2 and then case1</li>\n<li>with O1--O3 case2 always performed significantly worse than case1 and  case3</li>\n</ul>\n\n<p>Here are some images comparing the execution times</p>\n\n<ul>\n<li><a href=\"https://i.stack.imgur.com/jspk9.png\" rel=\"nofollow noreferrer\">Compiled with O0</a></li>\n<li><a href=\"https://i.stack.imgur.com/1cdVI.png\" rel=\"nofollow noreferrer\">Compiled with O1</a></li>\n<li><a href=\"https://i.stack.imgur.com/nWLDz.png\" rel=\"nofollow noreferrer\">Compiled with O3</a>.</li>\n</ul>\n\n<p>This confuses me and I would like to know what I can do in order to use function pointers without losing performance, because for flexibility reasons I really want to use function pointers.</p>\n\n<p>=> Why are function pointers so slow?</p>\n\n<p>I want to add that I am not a software engineer but rather an aerospace engineering student and sadly we do not get a lot of programming lessons,\nso every little detail might be helpful.</p>\n"}, {"tags": ["c", "stm32", "uart", "stm32f4discovery", "hal"], "comments": [{"owner": {"reputation": 5101, "user_id": 700170, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gZ8hw.png?s=128&g=1", "display_name": "Morten Jensen", "link": "https://stackoverflow.com/users/700170/morten-jensen"}, "edited": false, "score": 0, "creation_date": 1562690210, "post_id": 56956006, "comment_id": 100452503, "body": "Is the GPIO interrupt edge or level triggered?"}, {"owner": {"reputation": 3, "user_id": 11443498, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-UOsQ54YMU9M/AAAAAAAAAAI/AAAAAAAAAEM/373hjusAD1o/photo.jpg?sz=128", "display_name": "Samuel Martel", "link": "https://stackoverflow.com/users/11443498/samuel-martel"}, "reply_to_user": {"reputation": 5101, "user_id": 700170, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gZ8hw.png?s=128&g=1", "display_name": "Morten Jensen", "link": "https://stackoverflow.com/users/700170/morten-jensen"}, "edited": false, "score": 0, "creation_date": 1562693442, "post_id": 56956006, "comment_id": 100453844, "body": "It is rising edge triggered and I make sure the pin is <code>high</code> before rising the flag in the interrupt"}, {"owner": {"reputation": 2561, "user_id": 11476836, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c679da3a7b9adc6f980fb698e3f46b0b?s=128&d=identicon&r=PG&f=1", "display_name": "Marcos G.", "link": "https://stackoverflow.com/users/11476836/marcos-g"}, "edited": false, "score": 0, "creation_date": 1562705905, "post_id": 56956006, "comment_id": 100458795, "body": "I think you missed (or did not show on your code) clearing the interruption bits. Shouldn&#39;t that be done manually?"}, {"owner": {"reputation": 3, "user_id": 11443498, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-UOsQ54YMU9M/AAAAAAAAAAI/AAAAAAAAAEM/373hjusAD1o/photo.jpg?sz=128", "display_name": "Samuel Martel", "link": "https://stackoverflow.com/users/11443498/samuel-martel"}, "edited": false, "score": 0, "creation_date": 1562767345, "post_id": 56956006, "comment_id": 100481123, "body": "Clearing the interruption bits? If you meant for the EXTI interrupt, I left out <code>HAL_GPIO_EXTI_IRQHandler(GPIO_PIN_11);</code> from the <code>EXTI15_10_IRQHandler</code> call, is that what you mean?"}, {"owner": {"reputation": 1701, "user_id": 5836577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/931236857b09c3b0aea0f29fb5a23cbc?s=128&d=identicon&r=PG&f=1", "display_name": "Guillaume Petitjean", "link": "https://stackoverflow.com/users/5836577/guillaume-petitjean"}, "reply_to_user": {"reputation": 2561, "user_id": 11476836, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c679da3a7b9adc6f980fb698e3f46b0b?s=128&d=identicon&r=PG&f=1", "display_name": "Marcos G.", "link": "https://stackoverflow.com/users/11476836/marcos-g"}, "edited": false, "score": 0, "creation_date": 1562830845, "post_id": 56956006, "comment_id": 100503098, "body": "I agree with @MarcosG about IT flag management. You should check that he function <code>EXTI15_10_IRQHandler</code> is clearing the flag corresponding to the GPIO pin properly. I suggest you add a (static or global) counter in the IRQ handler to check if you execute it several times. If not, there is probably a race conditions between your flags <code>is_sending_data&#39;</code> and <code>should_send_data</code>"}, {"owner": {"reputation": 3, "user_id": 11443498, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-UOsQ54YMU9M/AAAAAAAAAAI/AAAAAAAAAEM/373hjusAD1o/photo.jpg?sz=128", "display_name": "Samuel Martel", "link": "https://stackoverflow.com/users/11443498/samuel-martel"}, "reply_to_user": {"reputation": 1701, "user_id": 5836577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/931236857b09c3b0aea0f29fb5a23cbc?s=128&d=identicon&r=PG&f=1", "display_name": "Guillaume Petitjean", "link": "https://stackoverflow.com/users/5836577/guillaume-petitjean"}, "edited": false, "score": 0, "creation_date": 1562939796, "post_id": 56956006, "comment_id": 100549521, "body": "could you explain what you mean by race condition @GuillaumePetitjean? I&#39;m not sure what you mean by that"}, {"owner": {"reputation": 1701, "user_id": 5836577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/931236857b09c3b0aea0f29fb5a23cbc?s=128&d=identicon&r=PG&f=1", "display_name": "Guillaume Petitjean", "link": "https://stackoverflow.com/users/5836577/guillaume-petitjean"}, "edited": false, "score": 0, "creation_date": 1562940564, "post_id": 56956006, "comment_id": 100550006, "body": "Race condition was perhaps a bad expression. I just meant that your flags are modified in handler mode (UART callback called by UART IRQ handler and GPIO handler) and thread mode. But there is no synchro mechanism like mutex. It&#39;s just an hypothesis, I didn&#39;t analyse deeply."}, {"owner": {"reputation": 3, "user_id": 11443498, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-UOsQ54YMU9M/AAAAAAAAAAI/AAAAAAAAAEM/373hjusAD1o/photo.jpg?sz=128", "display_name": "Samuel Martel", "link": "https://stackoverflow.com/users/11443498/samuel-martel"}, "edited": false, "score": 0, "creation_date": 1562946229, "post_id": 56956006, "comment_id": 100553221, "body": "oh I think I understand, thank you for your answer!"}], "answers": [{"tags": [], "owner": {"reputation": 3, "user_id": 11443498, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-UOsQ54YMU9M/AAAAAAAAAAI/AAAAAAAAAEM/373hjusAD1o/photo.jpg?sz=128", "display_name": "Samuel Martel", "link": "https://stackoverflow.com/users/11443498/samuel-martel"}, "is_accepted": true, "score": 0, "last_activity_date": 1562940592, "creation_date": 1562940592, "answer_id": 57008704, "question_id": 56956006, "link": "https://stackoverflow.com/questions/56956006/hal-uart-transmit-it-sending-data-twice/57008704#57008704", "title": "HAL_UART_Transmit_IT sending data twice", "body": "<p>Alright so I found a solution, but it involved just rethinking my approach, so sorry for those looking for an answer to this problem.</p>\n\n<p>I removed the arduino middle man by replacing it with a USB to RS232 converter and made UART reception work by interrupt. The STM detects the 'r' character which triggers the data communication. \nHere is the interrupt part:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>void USART3_IRQHandler(void)\n{\n    if (USART3-&gt;SR &amp; UART_IT_RXNE) {    // If a byte is received\n        rxBuff[0] = (uint8_t) (huart3.Instance-&gt;DR &amp; (uint8_t) 0xFF);   // Read it.\n        __HAL_UART_FLUSH_DRREGISTER(&amp;huart3);   // Clear the buffer to avoid errors.\n        rx_new_char_flag = TRUE;    // Raise the new_char flag.\n        return; // Stops the IRQHandler from disabling interrupts.\n    }\n}\n</code></pre>\n\n<p>and the gestion of that in the main</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>while (1) {\n    if (rx_new_char_flag == TRUE) {\n        rx_new_char_flag = FALSE;\n        if (rxBuff[0] == 'r') {\n            rxBuff[0] = 0;\n            HAL_UART_Transmit_IT(&amp;huart3, matrice, 480); // Start transmission by interrupt.\n            }\n        }\n</code></pre>\n\n<p>On the PC side, to optimize performance, instead of waiting for the full 480 bytes, I wait for only one character, if one is received I keep reading the serial port, as shown in the code bellow</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>int i = 0;\ndo {\n    ReadFile(m_hSerial, &amp;temp_rx[i], 1, &amp;dwBytesRead, NULL);\n    i++;\n} while (dwBytesRead &gt; 0 &amp;&amp; i &lt; 480);\nfor (int j = i; j &lt; 480; j++)  // If the transmission is incomplete, fill the buffer with 0s to avoid garbage data.\n    temp_rx[j] = 0;\n\nif(i&gt;=480)  // If all the bytes has been received, copy the data in the working buffer.\n    std::copy(std::begin(temp_rx), std::end(temp_rx), std::begin(m_touch_state));\n</code></pre>\n\n<p>This works well with pretty decent performance, so that may be a permanent solution to my problem.</p>\n"}], "owner": {"reputation": 3, "user_id": 11443498, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-UOsQ54YMU9M/AAAAAAAAAAI/AAAAAAAAAEM/373hjusAD1o/photo.jpg?sz=128", "display_name": "Samuel Martel", "link": "https://stackoverflow.com/users/11443498/samuel-martel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 930, "favorite_count": 0, "accepted_answer_id": 57008704, "answer_count": 1, "score": 0, "last_activity_date": 1562940592, "creation_date": 1562686204, "question_id": 56956006, "link": "https://stackoverflow.com/questions/56956006/hal-uart-transmit-it-sending-data-twice", "title": "HAL_UART_Transmit_IT sending data twice", "body": "<p>I am trying to establish UART communication between a PC and a STM32f407-DISC1 board using an arduino nano as a middle man.\nThe PC sends 'r' to the arduino to indicate a request.\nThe request is then communicated to the stm32 with a GPIO interrupt, which then should be transmitting 480 bytes of data using HAL_UART_Transmit_IT.\nIt however sends the data twice, with only a single request made.</p>\n\n<p>The code on the STM32 is generated by STM32CubeMX</p>\n\n<p>Data request made by the arduino</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>void loop() {\n    digitalWrite(4, 0); // Clear EXTI11 line.\n\n    if (mySerial.available() &amp;&amp; received &lt; 480) {   // STM32 sending data and is not done.\n        buff[received] = mySerial.read();           // Append received data to the buffer.\n        received++;\n    }\n    if (received &gt;= 480) {                          // If the buffer is full\n        received = 0;                               // transmit it to PC.\n        Serial.println(buff);\n    }\n\n\n    if (Serial.available()) {\n        if (Serial.read() == 'r') {     // PC requests data from the STM32\n            digitalWrite(4, 1);         // Triggers STM32 EXTI11 line.\n            while (Serial.available())  // Empty the buffer.\n                Serial.read();\n        }\n    }\n}\n</code></pre>\n\n<p>data transmission on the STM32</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>void EXTI15_10_IRQHandler(void)\n{\n    // Make sure that the interrupt is the good one.\n    if (HAL_GPIO_ReadPin(data_req_IRQ_GPIO_Port, data_req_IRQ_Pin)) {\n        if (is_sending_data == FALSE)   // If no transmission is happening\n            should_send_data = TRUE;    // raise transmission flag.\n    }\n\n    // IRQ handling stuff...\n}\n\nvoid HAL_UART_TxCpltCallback(UART_HandleTypeDef * huart) {\n    is_sending_data = FALSE;    // Transmition is completed, unblock requests.\n}\n\nvoid main(void){\n    // Init and other stuff...\n\n    while (1) {\n        if (should_send_data == TRUE) { // If data was requested\n            HAL_GPIO_WritePin(LD5_GPIO_Port, LD5_Pin, GPIO_PIN_RESET);\n            HAL_UART_Transmit_IT(&amp;huart3, matrice, 480);    // Start transmission by interrupt.\n            is_sending_data = TRUE;                         // Block requests.\n            should_send_data = FALSE;                       // Clear flag.\n        }\n    // matrice acquisition stuff here\n    }\n}\n</code></pre>\n"}]