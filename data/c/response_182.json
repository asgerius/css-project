[{"tags": ["c", "graphviz"], "comments": [{"owner": {"reputation": 18238, "user_id": 15275, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/WNTZ3.jpg?s=128&g=1", "display_name": "VZ.", "link": "https://stackoverflow.com/users/15275/vz"}, "reply_to_user": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1530787188, "post_id": 51181364, "comment_id": 89359962, "body": "This is exactly what I was looking for, thanks! I&#39;ve somehow managed to miss it, even after staring at the man page for so long... Could you please make this the answer so that I could accept it?"}], "answers": [{"tags": [], "owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "is_accepted": true, "score": 2, "last_activity_date": 1530800924, "creation_date": 1530800924, "answer_id": 51193867, "question_id": 51181364, "link": "https://stackoverflow.com/questions/51181364/how-to-get-the-node-name-with-graphviz-and-libcgraph/51193867#51193867", "title": "How to get the node name with Graphviz and libcgraph?", "body": "<p>You can use the function <code>agnameof</code>, which is listed in the \"Generic Objects\" section of the <code>cgraph</code> manpage:</p>\n\n<pre><code>char      *agnameof(void*);\n</code></pre>\n"}], "owner": {"reputation": 18238, "user_id": 15275, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/WNTZ3.jpg?s=128&g=1", "display_name": "VZ.", "link": "https://stackoverflow.com/users/15275/vz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 178, "favorite_count": 0, "accepted_answer_id": 51193867, "answer_count": 1, "score": 1, "last_activity_date": 1530874543, "creation_date": 1530742936, "last_edit_date": 1530874543, "question_id": 51181364, "link": "https://stackoverflow.com/questions/51181364/how-to-get-the-node-name-with-graphviz-and-libcgraph", "title": "How to get the node name with Graphviz and libcgraph?", "body": "<p>I'm trying to update some old code which used to work with Graphviz 2.26 and iterated over all the nodes of a graph and did something with their names:</p>\n\n<pre><code>for (Agnode_t *n = agfstnode(graph); n; n = agnxtnode(graph, n)) {\n    ... use n-&gt;name ...\n}\n</code></pre>\n\n<p>However in recent (2.30+?) versions of Graphviz, cgraph library is used for node representation and it doesn't have <code>name</code> field in its <code>Agnode_t</code> struct. </p>\n\n<p>I know about <code>agnode()</code> function which allows to lookup the node by name, but there doesn't seem to be any function to go in the other direction. Am I missing something or is there really no way to access the name of the existing node with cgraph?</p>\n"}, {"tags": ["c", "regex", "visual-studio"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user557597"}, "edited": false, "score": 0, "creation_date": 1530740944, "post_id": 51181060, "comment_id": 89344637, "body": "Find <code>xorFunction\\s*\\(\\s*([^,]*?)\\s*,\\s*([^,]*?)\\s*,\\s*([^,]*?)\\s*&zwnj;&#8203;,\\s*([^)]*?)\\s*\\)\\s*&zwnj;&#8203;;</code> Replace with whatever you want. A,B,C,D are in groups 1,2,3,4 respectively."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1530741041, "post_id": 51181060, "comment_id": 89344657, "body": "The answer will depend on which editor is your text editor. With simple calls like those shown, it isn&#39;t very hard. If you have calls like <code>xorFunction(someFunc(arg1, arg2), otherFunc(arg3, arg4), mask_generator(i), 16)</code>, then the regex needed to isolate the arguments to <code>xorFunction</code> become profoundly tricky. (Note that the nested commas in my example break the suggested regex in this <a href=\"https://stackoverflow.com/questions/51181060/variables-in-regular-expressions#comment89344637_51181060\">comment</a>. It likely works for the shown code; I may be raising an irrelevant issue. But you need to know.)"}, {"owner": {"reputation": 275, "user_id": 8145784, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/d03231b4f907072b4af34ee5f9f05643?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Clabault", "link": "https://stackoverflow.com/users/8145784/tom-clabault"}, "edited": false, "score": 0, "creation_date": 1530741222, "post_id": 51181060, "comment_id": 89344697, "body": "@sln I tried your code but it doesn&#39;t seem to work. Jonathan Leffler, I am under Visual Studio and my calls are of the kind shown, no problem about that"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1530741502, "post_id": 51181060, "comment_id": 89344768, "body": "You need an MSVS user \u2014 that isn&#39;t me.  But if your calls are as simple as shown, something along the general lines of @sin&#39;s regex will work.  The <code>\\s</code> (white space) and <code>*?</code> (non-greedy match) notations have the potential to be problematic (misunderstood)."}, {"owner": {"reputation": 427, "user_id": 8834967, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Xrf_YCVb2Vw/AAAAAAAAAAI/AAAAAAAAAAc/K52j8i_sYWw/photo.jpg?sz=128", "display_name": "Joy Allen", "link": "https://stackoverflow.com/users/8834967/joy-allen"}, "edited": false, "score": 0, "creation_date": 1530753024, "post_id": 51181060, "comment_id": 89346719, "body": "How about using <code>gcc -E</code>? Replace your <code>xorFunction</code> with <code>#define xorFunction(a, b, c, d) ...</code>, then run <code>gcc -E -o main.i main.c</code>. You will get what you want in <code>main.i</code>."}, {"owner": {"reputation": 275, "user_id": 8145784, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/d03231b4f907072b4af34ee5f9f05643?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Clabault", "link": "https://stackoverflow.com/users/8145784/tom-clabault"}, "edited": false, "score": 0, "creation_date": 1530753172, "post_id": 51181060, "comment_id": 89346744, "body": "gcc ? This is for Code Block right ? If so, I could try"}], "answers": [{"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1530741732, "post_id": 51181126, "comment_id": 89344818, "body": "Hmmm; intriguing, though I note it requires OCaml, which makes it (a little) trickier to use than some other programs \u2014 I can&#39;t use it immediately, for example (I have to find/install OCaml, at minimum, first)."}, {"owner": {"reputation": 21663, "user_id": 9305398, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cqJvE.png?s=128&g=1", "display_name": "Acorn", "link": "https://stackoverflow.com/users/9305398/acorn"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1530741928, "post_id": 51181126, "comment_id": 89344870, "body": "@JonathanLeffler: Yeah, it has a dependency on OCaml and another library (Menhir from inria), indeed. However, it is available in several Linux distributions (e.g. in Ubuntu&#39;s <code>universe&#47;devel</code>). For huge C code bases like the Linux kernel is a very nice tool to have."}, {"owner": {"reputation": 275, "user_id": 8145784, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/d03231b4f907072b4af34ee5f9f05643?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Clabault", "link": "https://stackoverflow.com/users/8145784/tom-clabault"}, "edited": false, "score": 0, "creation_date": 1530742514, "post_id": 51181126, "comment_id": 89345004, "body": "Isn&#39;t there an other software that accomplishes the same job? Because the dependency on OCaml is a problem since I&#39;m not very familiar with building libraries and so and plus, I&#39;m under Windows which makes things even more complicated"}, {"owner": {"reputation": 21663, "user_id": 9305398, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cqJvE.png?s=128&g=1", "display_name": "Acorn", "link": "https://stackoverflow.com/users/9305398/acorn"}, "reply_to_user": {"reputation": 275, "user_id": 8145784, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/d03231b4f907072b4af34ee5f9f05643?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Clabault", "link": "https://stackoverflow.com/users/8145784/tom-clabault"}, "edited": false, "score": 0, "creation_date": 1530772597, "post_id": 51181126, "comment_id": 89351265, "body": "@TomClabault: Added another option to the answer :-)"}], "tags": [], "owner": {"reputation": 21663, "user_id": 9305398, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cqJvE.png?s=128&g=1", "display_name": "Acorn", "link": "https://stackoverflow.com/users/9305398/acorn"}, "is_accepted": false, "score": 2, "last_activity_date": 1530772588, "last_edit_date": 1530772588, "creation_date": 1530741069, "answer_id": 51181126, "question_id": 51181060, "link": "https://stackoverflow.com/questions/51181060/automatically-transforming-c-code/51181126#51181126", "title": "Automatically Transforming C code", "body": "<p><a href=\"http://coccinelle.lip6.fr/\" rel=\"nofollow noreferrer\">Coccinelle (\"semantic patches for C\")</a> is great for this kind of transformation:</p>\n\n<blockquote>\n  <p>Coccinelle is a program matching and transformation engine which provides the language SmPL (Semantic Patch Language) for specifying desired matches and transformations in C code. Coccinelle was initially targeted towards performing collateral evolutions in Linux. Such evolutions comprise the changes that are needed in client code in response to evolutions in library APIs, and may include modifications such as renaming a function, adding a function argument whose value is somehow context-dependent, and reorganizing a data structure. Beyond collateral evolutions, Coccinelle is successfully used (by us and others) for finding and fixing bugs in systems code.</p>\n</blockquote>\n\n<hr>\n\n<p>Another option is <a href=\"https://clang.llvm.org/docs/index.html#using-clang-as-a-library\" rel=\"nofollow noreferrer\">Using Clang as a Library</a>. While in general it is more involved than writing a Coccinelle's semantic patch (even considering Clang Python bindings), in this case it should not be too hard. It has the advantage that you can parse C++ as well.</p>\n"}, {"comments": [{"owner": {"reputation": 275, "user_id": 8145784, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/d03231b4f907072b4af34ee5f9f05643?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Clabault", "link": "https://stackoverflow.com/users/8145784/tom-clabault"}, "edited": false, "score": 0, "creation_date": 1530742194, "post_id": 51181139, "comment_id": 89344932, "body": "Too bad. Imagine I have a thousand of call to xorFunction, everywhere in my code, that wouldn&#39;t be too practical to replace every one of them one by one hence my question. I&#39;ll use some external software then."}, {"owner": {"reputation": 2382, "user_id": 9414889, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/--7r4JaWADqA/AAAAAAAAAAI/AAAAAAAAFYw/DV7r38djnk4/photo.jpg?sz=128", "display_name": "Sheshank S.", "link": "https://stackoverflow.com/users/9414889/sheshank-s"}, "reply_to_user": {"reputation": 275, "user_id": 8145784, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/d03231b4f907072b4af34ee5f9f05643?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Clabault", "link": "https://stackoverflow.com/users/8145784/tom-clabault"}, "edited": false, "score": 0, "creation_date": 1530744124, "post_id": 51181139, "comment_id": 89345298, "body": "Yes, that was what I meant, the external software is the best way to go :(, sorry about that."}], "tags": [], "owner": {"reputation": 2382, "user_id": 9414889, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/--7r4JaWADqA/AAAAAAAAAAI/AAAAAAAAFYw/DV7r38djnk4/photo.jpg?sz=128", "display_name": "Sheshank S.", "link": "https://stackoverflow.com/users/9414889/sheshank-s"}, "is_accepted": false, "score": 0, "last_activity_date": 1530741197, "creation_date": 1530741197, "answer_id": 51181139, "question_id": 51181060, "link": "https://stackoverflow.com/questions/51181060/automatically-transforming-c-code/51181139#51181139", "title": "Automatically Transforming C code", "body": "<p>You can't have variables in regex.</p>\n\n<p><code>xorFunction \\(\\s*[^,]+,\\s*[^,]+,\\s*[^,]+,\\s*[^\\)]+\\)</code> That would be regex for catching the xorFunction block, but you can't have variables in plain regex. You could try finding something else to do it, but I think it would be faster to just do it manually (copy arguments, use regex, replace)</p>\n"}, {"comments": [{"owner": {"reputation": 275, "user_id": 8145784, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/d03231b4f907072b4af34ee5f9f05643?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Clabault", "link": "https://stackoverflow.com/users/8145784/tom-clabault"}, "edited": false, "score": 1, "creation_date": 1530742821, "post_id": 51181307, "comment_id": 89345070, "body": "That would be nice in the case I mentioned but the xorFunction was just an example. Also, I&#39;d like the code to be replaced so it&#39;s clean but with a macro, that&#39;s just &quot;code redirection&quot;"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 275, "user_id": 8145784, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/d03231b4f907072b4af34ee5f9f05643?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Clabault", "link": "https://stackoverflow.com/users/8145784/tom-clabault"}, "edited": false, "score": 0, "creation_date": 1530743081, "post_id": 51181307, "comment_id": 89345125, "body": "I was afraid that you wanted that change to be permanent and a macro wasn&#39;t OK.  I&#39;m not sure it&#39;s a good idea with the sample code.   A <code>static inline</code> function would be better.  However, if you&#39;re sure about the change, you need a system along the lines of the Coccinelle system suggested by <a href=\"https://stackoverflow.com/users/9305398/acorn\">Acorn</a> in their <a href=\"https://stackoverflow.com/a/51181126/15168\">answer</a>.  I know you&#39;ve said that could be a problem.  Consider whether you can install an Ubuntu VM under your Windows machine, and then run Coccinelle on the code inside the VM."}, {"owner": {"reputation": 275, "user_id": 8145784, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/d03231b4f907072b4af34ee5f9f05643?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Clabault", "link": "https://stackoverflow.com/users/8145784/tom-clabault"}, "edited": false, "score": 0, "creation_date": 1530743441, "post_id": 51181307, "comment_id": 89345182, "body": "That would be quite an effort for a straightforward text replacer. I&#39;ll search for a Windows compatible Coccinelle-like software."}], "tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": false, "score": 0, "last_activity_date": 1530743864, "last_edit_date": 1530743864, "creation_date": 1530742518, "answer_id": 51181307, "question_id": 51181060, "link": "https://stackoverflow.com/questions/51181060/automatically-transforming-c-code/51181307#51181307", "title": "Automatically Transforming C code", "body": "<p>Can you use a macro?  This might be sufficient:</p>\n\n<pre><code>#define xorFunction(a, b, c, d) for (int i = 0; i &lt; d; i++) a[i] = b[i] ^ c[i]\n</code></pre>\n\n<p>A more nearly bullet-proof version would add some macro-verbiage:</p>\n\n<pre><code>#define xorFunction(a, b, c, d) do { for (int i = 0; i &lt; (d); i++) (a)[i] = (b)[i] ^ (c)[i]; } while (0)\n</code></pre>\n\n<p>This would still run into problems if you have an expression that uses <code>i</code> as a variable in the call to <code>xorFunction()</code> \u2014 e.g. <code>xorFunction(\u2026, &amp;data[i], \u2026)</code>.  Avoiding that is hard \u2014 using a macro to concatenate <code>i</code> with a line number or thereabouts might be a sufficiently robust alternative.</p>\n\n<hr>\n\n<p>The more robust code might use:</p>\n\n<pre><code>#define CONCATENATE(v, n) v ## _ ## n\n#define EVALUATE(v, n) CONCATENATE(v, n)\n#define V(x) EVALUATE(x, __LINE__)\n\n#define xorFunction(a, b, c, d) \\\n    do { \\\n        for (int V(i) = 0; V(i) &lt; (d); V(i)++) \\\n            (a)[V(i)] = (b)[V(i)] ^ (c)[V(i)]; \\\n    } while (0)\n\nint main(void)\n{\n    unsigned char input[16] = { ... };\n    unsigned char mask[16] = { ... };\n    unsigned char output[16];\n\n    xorFunction(output, input, mask, 16);\n    xorFunction(mask, output, input, 16);\n    xorFunction(input, mask, output, 16);\n    for (int i = 4; i &lt; 8; i++)\n        xorFunction(&amp;ouput[i], &amp;input[i], &amp;mask[i], sizeof(mask)-i);\n\n    return 0;\n}\n</code></pre>\n\n<p>The output from the <code>cpp</code> I use is:</p>\n\n<pre><code># 1 \"xx.c\"\n# 1 \"&lt;built-in&gt;\"\n# 1 \"&lt;command-line&gt;\"\n# 1 \"xx.c\"\n# 11 \"xx.c\"\nint main(void)\n{\n    unsigned char input[16] = { ... };\n    unsigned char mask[16] = { ... };\n    unsigned char output[16];\n\n    do { for (int i_17 = 0; i_17 &lt; (16); i_17++) (output)[i_17] = (input)[i_17] ^ (mask)[i_17]; } while (0);\n    do { for (int i_18 = 0; i_18 &lt; (16); i_18++) (mask)[i_18] = (output)[i_18] ^ (input)[i_18]; } while (0);\n    do { for (int i_19 = 0; i_19 &lt; (16); i_19++) (input)[i_19] = (mask)[i_19] ^ (output)[i_19]; } while (0);\n    for (int i = 4; i &lt; 8; i++)\n        do { for (int i_21 = 0; i_21 &lt; (sizeof(mask)-i); i_21++) (&amp;ouput[i])[i_21] = (&amp;input[i])[i_21] ^ (&amp;mask[i])[i_21]; } while (0);\n\n    return 0;\n}\n</code></pre>\n\n<p>Note that without the variable naming via the <code>V</code> macro, expressions such as <code>(&amp;mask[i])[i]</code> would access data outside the bounds of the <code>mask</code> array if <code>i</code> reaches <code>8</code>, and doesn't access what's expected when <code>i</code> is less than <code>8</code> except when <code>i</code> is <code>0</code>.</p>\n"}], "owner": {"reputation": 275, "user_id": 8145784, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/d03231b4f907072b4af34ee5f9f05643?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Clabault", "link": "https://stackoverflow.com/users/8145784/tom-clabault"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1530772633, "creation_date": 1530740667, "last_edit_date": 1530772633, "question_id": 51181060, "link": "https://stackoverflow.com/questions/51181060/automatically-transforming-c-code", "title": "Automatically Transforming C code", "body": "<p>Let's suppose I have this simple code:</p>\n\n<pre><code>void xorFunction (unsigned char output[], unsigned char a[], unsigned char b[], size_t length)\n{\n    for(unsigned int i = 0; i &lt; length; i++)\n        output[i] = a[i] ^ b[i];\n}\n\nint main()\n{\n    unsigned char input[16] = { ... };\n    unsigned char mask[16] = { ... };\n    unsigned char output[16];\n\n    xorFunction(output, input, mask, 16);\n    xorFunction(mask, output, input, 16);\n    xorFunction(input, mask, output, 16);\n\n    return 0;\n}\n</code></pre>\n\n<p>and that suddenly, I want to get rid of the <code>xorFunction</code> so I decide to write <code>for(i = 0; i &lt; length; i++) ...</code> instead of <code>xorFunction(...);</code></p>\n\n<p>How can I do it with the find and replace tool of my text editor?</p>\n\n<p>It could look like something like this: </p>\n\n<pre><code>Find: xorFunction(a, b, c, d);\n\nReplace with: for(unsigned int i = 0; i &lt; d; i++) a[i] = b[i] ^ c[i];\nwith a, b, c and d parameters of xorFunction.\n</code></pre>\n\n<p>How can <code>a</code>, <code>b</code>, <code>c</code> and <code>d</code> be variables handled by the find and replace tool? I suppose that regex would be useful in this case but I don't know how.</p>\n"}, {"tags": ["c", "arrays", "pointers", "segmentation-fault", "malloc"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1530740694, "post_id": 51181037, "comment_id": 89344578, "body": "The code you posted is correct. The problem must be in other code that writes into them. You should be using something like <code>strcpy(recipe.ingredients[i], some_ingredient);</code>"}, {"owner": {"reputation": 31, "user_id": 10018348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3de2c963a0fe84b1b93effc23f851523?s=128&d=identicon&r=PG&f=1", "display_name": "Goner", "link": "https://stackoverflow.com/users/10018348/goner"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1530740790, "post_id": 51181037, "comment_id": 89344597, "body": "@Barmar So I should create another string in which put the string so I don&#39;t get memory leaks and things like that? Sorry if I&#39;m ignorant, I&#39;m new on the use of dinamic memory"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1530740832, "post_id": 51181037, "comment_id": 89344608, "body": "<code>some_ingredient</code> is the variable that holds the input that you want put into the structure."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1530740868, "post_id": 51181037, "comment_id": 89344615, "body": "Show the code that&#39;s filling in the recipes, that&#39;s where your problem is."}, {"owner": {"reputation": 31, "user_id": 10018348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3de2c963a0fe84b1b93effc23f851523?s=128&d=identicon&r=PG&f=1", "display_name": "Goner", "link": "https://stackoverflow.com/users/10018348/goner"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1530740916, "post_id": 51181037, "comment_id": 89344629, "body": "@Barmar I use a loop for the input and the function <code>fgets</code> to save the input inside the string"}, {"owner": {"reputation": 31, "user_id": 10018348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3de2c963a0fe84b1b93effc23f851523?s=128&d=identicon&r=PG&f=1", "display_name": "Goner", "link": "https://stackoverflow.com/users/10018348/goner"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1530741028, "post_id": 51181037, "comment_id": 89344654, "body": "@Barmar <code>do{ \t\t\tprintf(&quot;Write the ingredient:\\n&quot;); \t\t\tfgets(recipe.ingredients[j],30,stdin); \t\t\tj++; \t\t\tprintf(&quot;Do you want to continue?(yes&#47;no)&quot;); \t\t\tgets(sentinel); \t\t} while(strcmp(&quot;yes&quot;, sentinel) == 0);</code>"}, {"owner": {"reputation": 31, "user_id": 10018348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3de2c963a0fe84b1b93effc23f851523?s=128&d=identicon&r=PG&f=1", "display_name": "Goner", "link": "https://stackoverflow.com/users/10018348/goner"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1530741073, "post_id": 51181037, "comment_id": 89344665, "body": "@Barmar It&#39;s the sasme with the procedure, just changing the value on fgets and the name of variables"}, {"owner": {"reputation": 31, "user_id": 10018348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3de2c963a0fe84b1b93effc23f851523?s=128&d=identicon&r=PG&f=1", "display_name": "Goner", "link": "https://stackoverflow.com/users/10018348/goner"}, "reply_to_user": {"reputation": 6975, "user_id": 3121023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f52448806175b9aa66c86d40cf0829f1?s=128&d=identicon&r=PG&f=1", "display_name": "user3121023", "link": "https://stackoverflow.com/users/3121023/user3121023"}, "edited": false, "score": 0, "creation_date": 1530741287, "post_id": 51181037, "comment_id": 89344712, "body": "@user3121023 Okay thank you, I&#39;ll edit on my code"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1530741511, "post_id": 51181037, "comment_id": 89344771, "body": "<code>fgets(recipe.ingredients[j], 30, stdin);</code> should work. Please provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> that demonstrates the problem you&#39;re having."}, {"owner": {"reputation": 31, "user_id": 10018348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3de2c963a0fe84b1b93effc23f851523?s=128&d=identicon&r=PG&f=1", "display_name": "Goner", "link": "https://stackoverflow.com/users/10018348/goner"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1530742256, "post_id": 51181037, "comment_id": 89344951, "body": "@Barmar I tried inputting different strings and I saw that the ingredients aren&#39;t print at all, I just see few buch of symbols while in the procedures I can see few of the procedures I put on input but I also see a lot of garbage values and there is a lot of space between the values"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1530742600, "post_id": 51181037, "comment_id": 89345015, "body": "Don\u2019t describe the code, show the code.  Describing says \u201c this is basically what my code does.\u201d  Problem is, computers don\u2019t do <i>basically</i> what you tell them.  They do <b>exactly</b> what you tell them.  So tell us <b>exactly</b> what you\u2019re telling the computer to do, i.e. show your code."}, {"owner": {"reputation": 33821, "user_id": 45685, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/y4RJr.jpg?s=128&g=1", "display_name": "AndersK", "link": "https://stackoverflow.com/users/45685/andersk"}, "edited": false, "score": 0, "creation_date": 1530743267, "post_id": 51181037, "comment_id": 89345155, "body": "debuggers are great in helping to solving these kinds of problems."}, {"owner": {"reputation": 31, "user_id": 10018348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3de2c963a0fe84b1b93effc23f851523?s=128&d=identicon&r=PG&f=1", "display_name": "Goner", "link": "https://stackoverflow.com/users/10018348/goner"}, "reply_to_user": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1530743454, "post_id": 51181037, "comment_id": 89345186, "body": "@dbush I edited the thread to show my output"}, {"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 0, "creation_date": 1530744425, "post_id": 51181037, "comment_id": 89345363, "body": "In your free loop you start with <code>i=50</code> which is out of bound. BTW thats not what dereferencing pointers means."}, {"owner": {"reputation": 31, "user_id": 10018348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3de2c963a0fe84b1b93effc23f851523?s=128&d=identicon&r=PG&f=1", "display_name": "Goner", "link": "https://stackoverflow.com/users/10018348/goner"}, "reply_to_user": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 0, "creation_date": 1530744591, "post_id": 51181037, "comment_id": 89345390, "body": "@Osiris even if I put 49 on the index, I get the same output I posted on my thread"}, {"owner": {"reputation": 31, "user_id": 10018348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3de2c963a0fe84b1b93effc23f851523?s=128&d=identicon&r=PG&f=1", "display_name": "Goner", "link": "https://stackoverflow.com/users/10018348/goner"}, "reply_to_user": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 0, "creation_date": 1530744647, "post_id": 51181037, "comment_id": 89345400, "body": "@Osiris I&#39;ve always had problems with dereferencing as we can see in my code, that&#39;s the part I can&#39;t deal with"}, {"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 1, "creation_date": 1530744814, "post_id": 51181037, "comment_id": 89345428, "body": "@Goner dereferencing pointers and freeing allocated memory are two completly different things. But we would need more code to find your problem, please post a <a href=\"https://stackoverflow.com/help/mcve\">MCVE</a>."}, {"owner": {"reputation": 31, "user_id": 10018348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3de2c963a0fe84b1b93effc23f851523?s=128&d=identicon&r=PG&f=1", "display_name": "Goner", "link": "https://stackoverflow.com/users/10018348/goner"}, "reply_to_user": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 0, "creation_date": 1530745707, "post_id": 51181037, "comment_id": 89345550, "body": "@Osiris I put my code on the thread, hope this was what you meant"}, {"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 0, "creation_date": 1530745908, "post_id": 51181037, "comment_id": 89345585, "body": "@Goner You cant access the memory you already freed. And also please fix your variable naming."}, {"owner": {"reputation": 31, "user_id": 10018348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3de2c963a0fe84b1b93effc23f851523?s=128&d=identicon&r=PG&f=1", "display_name": "Goner", "link": "https://stackoverflow.com/users/10018348/goner"}, "reply_to_user": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 0, "creation_date": 1530746143, "post_id": 51181037, "comment_id": 89345620, "body": "@Osiris so I should free all the memory at the end of all the process?"}, {"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 0, "creation_date": 1530746190, "post_id": 51181037, "comment_id": 89345623, "body": "@Goner If you free memory you can not use it anymore, it leads to undefined behavior. So yes, free it where you dont need it anymore."}, {"owner": {"reputation": 31, "user_id": 10018348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3de2c963a0fe84b1b93effc23f851523?s=128&d=identicon&r=PG&f=1", "display_name": "Goner", "link": "https://stackoverflow.com/users/10018348/goner"}, "reply_to_user": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 0, "creation_date": 1530746463, "post_id": 51181037, "comment_id": 89345672, "body": "@Osiris I think I got what&#39;s the problem: using for to print both ingredients and procedures, I access to few blocks I didn&#39;t use but I need to understand what kind of loop I may use to print them without going through all the elements"}, {"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 0, "creation_date": 1530746693, "post_id": 51181037, "comment_id": 89345722, "body": "@Goner You need to remember how many elements of ingredients and procedures are relevant and only output these. You output uninitialized variables which is garbage."}, {"owner": {"reputation": 31, "user_id": 10018348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3de2c963a0fe84b1b93effc23f851523?s=128&d=identicon&r=PG&f=1", "display_name": "Goner", "link": "https://stackoverflow.com/users/10018348/goner"}, "reply_to_user": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 0, "creation_date": 1530747014, "post_id": 51181037, "comment_id": 89345798, "body": "@Osiris I thought about a counter for each of them and put it on a for loop to print just the relevant elements, do you think it&#39;s a solution?"}, {"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 0, "creation_date": 1530747151, "post_id": 51181037, "comment_id": 89345833, "body": "@Goner Yes you should do that, but i think you will still have some issues with reading your text from stdin."}, {"owner": {"reputation": 31, "user_id": 10018348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3de2c963a0fe84b1b93effc23f851523?s=128&d=identicon&r=PG&f=1", "display_name": "Goner", "link": "https://stackoverflow.com/users/10018348/goner"}, "reply_to_user": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 0, "creation_date": 1530747360, "post_id": 51181037, "comment_id": 89345869, "body": "@Osiris I tried to set the for loop in this way <code>for(i= 0; i &lt; 3; i++)</code> of course this was just a way to try how the output would look and if I put three strings there&#39;s no garbage value on the screen, but I had to remove the newline from the printf because it puts two newlines instead of one"}, {"owner": {"reputation": 31, "user_id": 10018348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3de2c963a0fe84b1b93effc23f851523?s=128&d=identicon&r=PG&f=1", "display_name": "Goner", "link": "https://stackoverflow.com/users/10018348/goner"}, "reply_to_user": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 0, "creation_date": 1530747540, "post_id": 51181037, "comment_id": 89345897, "body": "@Osiris I was wandering...I have to put all the struct in a binary file, do you think I could have some kind of issues this way?"}, {"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 0, "creation_date": 1530747588, "post_id": 51181037, "comment_id": 89345907, "body": "@Goner Depends on how you write the struct to a binary file."}, {"owner": {"reputation": 31, "user_id": 10018348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3de2c963a0fe84b1b93effc23f851523?s=128&d=identicon&r=PG&f=1", "display_name": "Goner", "link": "https://stackoverflow.com/users/10018348/goner"}, "reply_to_user": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 0, "creation_date": 1530747717, "post_id": 51181037, "comment_id": 89345924, "body": "@Osiris is it correct to use the <code>fwrite(&amp;recipe,sizeof(recipe),1,fbr)</code>? At least, I&#39;ve always written structs this way"}, {"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 0, "creation_date": 1530747776, "post_id": 51181037, "comment_id": 89345939, "body": "@Goner It seems correct to write structs this way, but in your case your struct contains pointers so you would write the adresses which the pointers hold in the binary file, which are meaningless."}, {"owner": {"reputation": 31, "user_id": 10018348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3de2c963a0fe84b1b93effc23f851523?s=128&d=identicon&r=PG&f=1", "display_name": "Goner", "link": "https://stackoverflow.com/users/10018348/goner"}, "reply_to_user": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 0, "creation_date": 1530747888, "post_id": 51181037, "comment_id": 89345956, "body": "@Osiris that&#39;s why I have doubts since I&#39;ve never used pointers inside a struct and written it on a file"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1530756025, "post_id": 51181037, "comment_id": 89347175, "body": "In current code <code>recipe.c:43:15: error: \u2018recip\u2019 undeclared</code>, and <code>recipe.c:53:19: error: \u2018ricetta\u2019 undeclared</code>, and <code>recipe.c:71:24: error: \u2018SIZE\u2019 undeclared</code> -- what you have posted does not compile. See <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\"><b>How to debug small programs</b></a>"}, {"owner": {"reputation": 31, "user_id": 10018348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3de2c963a0fe84b1b93effc23f851523?s=128&d=identicon&r=PG&f=1", "display_name": "Goner", "link": "https://stackoverflow.com/users/10018348/goner"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1530772719, "post_id": 51181037, "comment_id": 89351329, "body": "@DavidC.Rankin Actually it does, I just forgot to edit few pieces of the code, I have to translate them so I had few problems with it, I edited now and this works"}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1530784213, "post_id": 51181037, "comment_id": 89358048, "body": "Welcome to Stack Overflow! Please <a href=\"https://stackoverflow.com/posts/51181037/edit\">edit</a> your code to reduce it to a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> of your problem.  Your current code includes much that is peripheral to your problem - a minimal sample normally looks similar to a good unit test: only performing one task, with input values specified for reproducibility."}, {"owner": {"reputation": 31, "user_id": 10018348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3de2c963a0fe84b1b93effc23f851523?s=128&d=identicon&r=PG&f=1", "display_name": "Goner", "link": "https://stackoverflow.com/users/10018348/goner"}, "reply_to_user": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1530784715, "post_id": 51181037, "comment_id": 89358343, "body": "@TobySpeight Now I have solved the problem with dynamic allocation, but I can&#39;t write both of the pointers inside a binary file and I&#39;m having a struggle with them"}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1530785008, "post_id": 51181037, "comment_id": 89358540, "body": "You need to provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>.  I tried to reproduce your problem, but couldn&#39;t, as the program just sits waiting for input (and you didn&#39;t provide any).  Much better to reduce your code to something that demonstrates the problem without needing any input."}, {"owner": {"reputation": 31, "user_id": 10018348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3de2c963a0fe84b1b93effc23f851523?s=128&d=identicon&r=PG&f=1", "display_name": "Goner", "link": "https://stackoverflow.com/users/10018348/goner"}, "reply_to_user": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1530786633, "post_id": 51181037, "comment_id": 89359607, "body": "@TobySpeight I&#39;m thinking about it, but I don&#39;t know how to provide an example without an input because if I try to put a value on one of the dynamic array, it gives me a segmentation fault"}], "answers": [{"comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 1, "creation_date": 1530741579, "post_id": 51181180, "comment_id": 89344784, "body": "please do not guess in answers. Wait for clarifications instead. If you&#39;ve got the reputation, then comment."}, {"owner": {"reputation": 31, "user_id": 10018348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3de2c963a0fe84b1b93effc23f851523?s=128&d=identicon&r=PG&f=1", "display_name": "Goner", "link": "https://stackoverflow.com/users/10018348/goner"}, "edited": false, "score": 0, "creation_date": 1530741886, "post_id": 51181180, "comment_id": 89344858, "body": "I know this way works, but I&#39;m working on a school project and I rather prefer learning to use dynamic memory, but thanks for the answer"}, {"owner": {"reputation": 103, "user_id": 5942913, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/f768a8117cce4903d9f470c70860c888?s=128&d=identicon&r=PG&f=1", "display_name": "rated2016", "link": "https://stackoverflow.com/users/5942913/rated2016"}, "edited": false, "score": 0, "creation_date": 1530758077, "post_id": 51181180, "comment_id": 89347490, "body": "The above example is of dynamic memory, I used your code with malloc calls."}], "tags": [], "owner": {"reputation": 103, "user_id": 5942913, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/f768a8117cce4903d9f470c70860c888?s=128&d=identicon&r=PG&f=1", "display_name": "rated2016", "link": "https://stackoverflow.com/users/5942913/rated2016"}, "is_accepted": false, "score": -1, "last_activity_date": 1530741528, "creation_date": 1530741528, "answer_id": 51181180, "question_id": 51181037, "link": "https://stackoverflow.com/questions/51181037/how-to-manage-a-dynamic-array-of-strings-in-c/51181180#51181180", "title": "How to manage a dynamic array of strings in C", "body": "<p>Your code is correct, maybe it's the way your de-referencing?</p>\n\n<p>The following works:</p>\n\n<pre><code> for(int i = 0; i &lt; 50; i++)\n    {\n        for(int j = 0; j &lt; 30; j++){\n            recipe.ingredients[i][j] = 'a';\n        }\n    }\nprintf(\"Hello %c\", recipe.ingredients[3][4]);\n</code></pre>\n\n<p>If you post the code of how you're de-referencing then we can help you further.</p>\n"}], "owner": {"reputation": 31, "user_id": 10018348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3de2c963a0fe84b1b93effc23f851523?s=128&d=identicon&r=PG&f=1", "display_name": "Goner", "link": "https://stackoverflow.com/users/10018348/goner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 101, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1530772768, "creation_date": 1530740451, "last_edit_date": 1530772768, "question_id": 51181037, "link": "https://stackoverflow.com/questions/51181037/how-to-manage-a-dynamic-array-of-strings-in-c", "title": "How to manage a dynamic array of strings in C", "body": "<p>I have a struct that represents a recipe. I don't know how to deal with ingredients and procedure because I don't know in the first place how much memory I need to store all the information.\nI initialized the struct this way</p>\n\n<pre><code>struct _recipe\n{\n    char name[50];\n    char** ingredients;\n    char diff[12];\n    int time;\n    int calories;\n    char** procedure;   \n} recipe;\n</code></pre>\n\n<p>And I tried to allocate both of them in this way</p>\n\n<pre><code>recipe.ingredients = malloc(sizeof(char*) * 50);\nrecipe.procedure = malloc(sizeof(char*) * 50);\n\nfor(i = 0; i &lt; 50; i++)\n{\n    recipe.ingredients[i] = malloc(sizeof(char) * 30);\n    recipe.procedure[i] = malloc(sizeof(char) * 500);\n}\n</code></pre>\n\n<p>But then I have a strange output after I try to write inside of them. I let go the memory in the end of process after I printed out the strings, but I have a strange behaviour of the program most probably because I get segmentation fault but I don't get it why actually. Is that because I allocate the memory in the wrong way?\nAfter I ended the process, it says the return value is 1.</p>\n\n<p>That's the way I dereference the pointers</p>\n\n<pre><code>for(i = 50; i &gt;= 0; i--){\n    free(recipe.ingredients[i]);\n}\n\nfor(j = 50; j &gt;= 0; j--)\n{\n    free(recipe.procedure[j]);\n}\nfree(recipe.ingredients);\nfree(recipe.procedure);\n</code></pre>\n\n<p>After I tried to put a counter to memorize how much memory I used and only free the unsed memory, I got this output</p>\n\n<pre><code>Apple pie\np\u00f8\u2514\np\u00f8\u2514\nP\u2514\nP\u2514\nP\u2514\nP\u00c3\u2514\nP\u00c3\u2514\nP\u00c3\u2514\nP\u00c3\u2514\n\u2514\u00ffc\n\u2514\u00ffc\n\u2514\u00ffc\np\u00f8\u2514\np\u00f8\u2514\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nEasy\n60 min\n230 kcal\nMix milk and flour\n\nP\u2514\nBake them\n\nP\u2514\nP\u2514\nP\u2514\nP\u2514\nP\u2514\nP\u2514\nP\u2514\nP\u2514\nP\u2514\nP\u2514\nP\u2514\n\u2514\u00ffc\n\u2514\u00ffc\n\u2514\u00ffc\n</code></pre>\n\n<p>I know I dereferenced in a bad way using counters, but if I editer and dereferenced all the 50 elements, the program crashes. Anyway to have this result I put this in input:\n-Name: Apple Pie\nIngredients: Apples\n             Sugar\n             Flour\n             Milk\nDifficulty: Easy\nTime in minutes (for preparation): 60\nCalories: 230\nProcedure: Mix milk and flour\n           Add apples\n           Bake them\nAnd the process returns 1. I know that's an horrible way to describe a recipe, I just put few strings in input to show how it ends</p>\n\n<p>That's all my code, I don't know how to get rid of the error</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint main()\n{\n    struct _recipe\n{\n    char name[50];\n    char** ingredients;\n    char diff[12];\n    int time;\n    int calories;\n    char** procedure;   \n} recipe;\n    int i = 0;\n    int j = 0;\n    char sentinel[] = \"yes\";\n    char stop[] = \"yes\";\n    char space = '\\n';\n    int counter = 0;\n    int total = 0;\nrecipe.ingredients = malloc(sizeof(char*) * 50);\nrecipe.procedure = malloc(sizeof(char*) * 50);\n\nfor(i = 0; i &lt; 50; i++)\n{\n    recipe.ingredients[i] = malloc(sizeof(char) * 30);\n    recipe.procedure[i] = malloc(sizeof(char) * 500);\n}\n\n\n        printf(\"Put the name of recipe:\\n\");\n        fgets(recipe.name,30,stdin);\n        do{\n            printf(\"Put the ingredient:\\n\");\n            fgets(recipe.ingredients[j],30,stdin);\n            j++;\n            counter++;\n            printf(\"Do you want to continue? (yes/no)\");\n            gets(sentinel);\n        } while(strcmp(\"yes\",sentinel) == 0);\n\n\n        printf(\"Put difficulty (Easy Medium Hard):\\n\");\n        fgets(recipe.diff,11,stdin);\n        printf(\"Put time for preparation(in minutes):\\n\");\n        scanf(\"%d\", &amp;recipe.time);\n        space = getchar();\n        printf(\"Inserisci l'apporto calorico:\\n\");\n        scanf(\"%d\", &amp;recipe.calories);\n        space = getchar();\n        i = 0;\n        do{\n            printf(\"Put the procedure:\\n\");\n            fgets(recipe.procedure[i],1000,stdin);\n            i++;\n            total++;\n            printf(\"Do you want to continue? (yes/no)\\n\");\n            gets(stop);\n        } while(strcmp(\"yes\", stop) == 0);\n\n\n\n\n\n        printf(\"%s\", recipe.name);\n        for(i = 0; i &lt; counter; i++)\n        {\n            printf(\"%s\", recipe.ingredients[i]);\n        }\n        printf(\"%s\\n\", recipe.diff);\n        printf(\"%d min\\n\", recipe.time);\n        printf(\"%d kcal\\n\", recipe.calories);\n        for (j = 0; j &lt; total; j++)\n        {\n            printf(\"%s\", recipe.procedure[j]);\n        }\n\n            for(i = 49; i &gt;= 0; i--){\n        free(recipe.ingredients[i]);\n    }\n\n    for(j = 49; j &gt;= 0; j--)\n    {\n        free(recipe.procedure[j]);\n    }\n    free(recipe.ingredients);\n    free(recipe.procedure);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "sockets", "telnet"], "comments": [{"owner": {"reputation": 44820, "user_id": 4492932, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e8938ef2681650e100bc9f83434ef272?s=128&d=identicon&r=PG", "display_name": "DYZ", "link": "https://stackoverflow.com/users/4492932/dyz"}, "edited": false, "score": 1, "creation_date": 1530739608, "post_id": 51180899, "comment_id": 89344268, "body": "As a side note, you have a bunch of calls to <code>perror</code> that are bot followed by <code>exit</code> or some other error handling routine. In other words, your program may report an error and then continue as if nothing happened."}, {"owner": {"reputation": 201, "user_id": 9299616, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51bd9b697648d23a43e0348cca3677a6?s=128&d=identicon&r=PG&f=1", "display_name": "k33n", "link": "https://stackoverflow.com/users/9299616/k33n"}, "reply_to_user": {"reputation": 44820, "user_id": 4492932, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e8938ef2681650e100bc9f83434ef272?s=128&d=identicon&r=PG", "display_name": "DYZ", "link": "https://stackoverflow.com/users/4492932/dyz"}, "edited": false, "score": 0, "creation_date": 1530739718, "post_id": 51180899, "comment_id": 89344298, "body": "I am aware of that, but thank you anyway :)"}], "answers": [{"comments": [{"owner": {"reputation": 201, "user_id": 9299616, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51bd9b697648d23a43e0348cca3677a6?s=128&d=identicon&r=PG&f=1", "display_name": "k33n", "link": "https://stackoverflow.com/users/9299616/k33n"}, "edited": false, "score": 0, "creation_date": 1530742406, "post_id": 51180976, "comment_id": 89344984, "body": "Oh god.. thanks a lot :,)"}], "tags": [], "owner": {"reputation": 2065, "user_id": 85696, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9d5b650b104a98538d5aab145ea192d?s=128&d=identicon&r=PG", "display_name": "danadam", "link": "https://stackoverflow.com/users/85696/danadam"}, "is_accepted": true, "score": 0, "last_activity_date": 1530740026, "creation_date": 1530740026, "answer_id": 51180976, "question_id": 51180899, "link": "https://stackoverflow.com/questions/51180899/c-socket-not-accepting-connection-via-telnet/51180976#51180976", "title": "C | socket not accepting connection via telnet", "body": "<p>You should actually call <code>bind()</code> in this line:</p>\n\n<pre><code>binden = (pop3socket, (struct sockaddr*)&amp;mailserver, sizeof(mailserver));\n</code></pre>\n\n<p>:-)</p>\n"}], "owner": {"reputation": 201, "user_id": 9299616, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51bd9b697648d23a43e0348cca3677a6?s=128&d=identicon&r=PG&f=1", "display_name": "k33n", "link": "https://stackoverflow.com/users/9299616/k33n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "closed_date": 1530794021, "accepted_answer_id": 51180976, "answer_count": 1, "score": -1, "last_activity_date": 1530740026, "creation_date": 1530739402, "question_id": 51180899, "link": "https://stackoverflow.com/questions/51180899/c-socket-not-accepting-connection-via-telnet", "closed_reason": "Not suitable for this site", "title": "C | socket not accepting connection via telnet", "body": "<p>First of all, this is my code:</p>\n\n<pre><code>#include \"database.h\"\n#include \"pop3.h\"\n#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;netinet/in.h&gt;\n#include &lt;arpa/inet.h&gt;\n#include &lt;sys/stat.h&gt;\n#include &lt;fcntl.h&gt;\n\n#define PORT 1234\n\nDBRecord fbPopHost = { \"host\", \"pop3\", \"localhost\" };\nDBRecord fbPopPort = { \"port\", \"pop3\", \"8110\" };\n\n\nint main(void) {\n    int pop3socket;\n    int clientSocket;\n    int len;\n    int binden;\n    int zuhoeren;\n\n    struct sockaddr_in mailserver;\n\n    /* Socket erstellen */\n    pop3socket = socket(AF_INET, SOCK_STREAM, 0);\n    if(pop3socket &lt; 0) {\n        perror(\"Fehler beim Erstellen des Sockets!\");\n    }\n\n    /* IP und Port festlegen mithilfe von Bind */\n    memset(&amp;mailserver, 0, sizeof(mailserver)); \n    mailserver.sin_family = AF_INET;\n    mailserver.sin_addr.s_addr = htonl(INADDR_ANY);\n    mailserver.sin_port = htons(1234);\n    binden = (pop3socket, (struct sockaddr*)&amp;mailserver, sizeof(mailserver));\n    if(binden &lt; 0) {\n        perror(\"Fehler beim Binden des Sockets\");\n    }\n\n    /* Warteschlange einrichten */\n    zuhoeren = listen(pop3socket, 5);\n    if(zuhoeren == -1) {\n        perror(\"Fehler beim Listen\");\n    }\n\n    /* Verbindung(en) akzeptieren */\n    struct sockaddr_in pop3client; /* Client Infos */\n\n    for(;;) {\n        len = sizeof(struct sockaddr);\n        clientSocket = accept(pop3socket, (struct sockaddr*)&amp;pop3client, &amp;len);\n        if(clientSocket &lt; 0) {\n            perror(\"Fehler beim Accepten der Verbindung\");\n        }\n        process_pop3(clientSocket);\n    }\n\n\n}\n</code></pre>\n\n<p>When I try to open up a connection via telnet:</p>\n\n<blockquote>\n  <p>telnet localhost 1234</p>\n</blockquote>\n\n<p>it sadly says:</p>\n\n<blockquote>\n  <p>Trying 127.0.0.1... telnet: Unable to connect to remote host:\n  Connection refused</p>\n</blockquote>\n\n<p>When I am starting the program it listens to connections, so I don't know what is wrong. Can somebody help me please, it is getting frustrating?</p>\n\n<p>Thanks for the help!</p>\n"}, {"tags": ["c", "expression"], "comments": [{"owner": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 1, "creation_date": 1530738632, "post_id": 51180749, "comment_id": 89343976, "body": "Your &quot;it is known&quot; assumption isn&#39;t always true. For example, <code>short</code> + <code>short</code> = <code>int</code>."}, {"owner": {"reputation": 185, "user_id": 9929801, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/90yR8.png?s=128&g=1", "display_name": "Paul Ankman", "link": "https://stackoverflow.com/users/9929801/paul-ankman"}, "reply_to_user": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 0, "creation_date": 1530738722, "post_id": 51180749, "comment_id": 89344005, "body": "Hum.. yes you talk about integer promotions ?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1530738751, "post_id": 51180749, "comment_id": 89344013, "body": "Like this: <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.3.1.8\" rel=\"nofollow noreferrer\">port70.net/~nsz/c/c11/n1570.html#6.3.1.8</a>"}, {"owner": {"reputation": 4328, "user_id": 920069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd39f0db1f22e1314746491df063602a?s=128&d=identicon&r=PG", "display_name": "Retired Ninja", "link": "https://stackoverflow.com/users/920069/retired-ninja"}, "edited": false, "score": 0, "creation_date": 1530738765, "post_id": 51180749, "comment_id": 89344021, "body": "<a href=\"https://stackoverflow.com/questions/28142902/are-the-usual-arithmetic-conversions-and-the-integer-promotions-the-same-thi\" title=\"are the usual arithmetic conversions and the integer promotions the same thi\">stackoverflow.com/questions/28142902/&hellip;</a>"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1530739814, "post_id": 51180749, "comment_id": 89344332, "body": "Integers that are signed get promoted to unsigned integers, but the result might not be in range. Better is not to mix types. If you have to, convert them to a larger type than will hold the input and ouput values, and then test if it will fit the target type, which you have not mentioned."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1530741261, "post_id": 51180749, "comment_id": 89344706, "body": "Please read <a href=\"https://stackoverflow.com/a/46073296/918959\">Lundin&#39;s answer</a> in  the duplicate. In particular from it it will follow that <code>signed int + unsigned int</code> has type <code>unsigned int</code>, and <code>wchar_t + short</code> is either of type <code>signed int</code> or <code>unsigned int</code> depending on the bitness of these types."}], "answers": [{"comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 1, "creation_date": 1530740586, "post_id": 51180905, "comment_id": 89344548, "body": "This really doesn&#39;t even answer the question. It does talk about integer conversions superficially but not even about the <i>usual arithmetic conversions</i> that the OP asks about."}], "tags": [], "owner": {"reputation": 325, "user_id": 9900875, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-rhxM-SVSbsQ/AAAAAAAAAAI/AAAAAAAAAFo/n1-jj0Xou34/photo.jpg?sz=128", "display_name": "OregonJim", "link": "https://stackoverflow.com/users/9900875/oregonjim"}, "is_accepted": true, "score": 0, "last_activity_date": 1530739441, "creation_date": 1530739441, "answer_id": 51180905, "question_id": 51180749, "link": "https://stackoverflow.com/questions/51180749/whats-the-type-of-an-expression-with-two-operandes-of-the-same-size/51180905#51180905", "title": "What&#39;s the type of an expression with two operandes of the same size?", "body": "<p><a href=\"http://publications.gbdirect.co.uk/c_book/chapter2/expressions_and_arithmetic.html\" rel=\"nofollow noreferrer\">From Here</a></p>\n\n<p>2.8.1.2. Signed and unsigned integers\nA lot of conversions between different types of integers are caused by mixing the various flavours of integers in expressions. Whenever these happen, the integral promotions will already have been done. For all of them, if the new type can hold all of the values of the old type, then the value remains unchanged.</p>\n\n<p>When converting from a signed integer to an unsigned integer whose length is equal to or longer than the original type, then if the signed value was nonnegative, its value is unchanged. If the value was negative, then it is converted to the signed form of the longer type and then made unsigned by conceptually adding it to one greater than the maximum that can be held in the unsigned type. In a twos complement system, this preserves the original bit-pattern for positive numbers and guarantees \u2018sign-extension\u2019 of negative numbers.</p>\n\n<p>Whenever an integer is converted into a shorter unsigned type, there can be no \u2018overflow\u2019, so the result is defined to be \u2018the non-negative remainder on division by the number one greater than the largest unsigned number that can be represented in the shorter type\u2019. That simply means that in a two's complement environment the low-order bits are copied into the destination and the high-order ones discarded.</p>\n\n<p>Converting an integer to a shorter signed type runs into trouble if there is not enough room to hold the value. In that case, the result is implementation defined (although most old-timers would expect that simply the low-order bit pattern is copied).</p>\n\n<p>That last item could be a bit worrying if you remember the integral promotions, because you might interpret it as follows\u2014if I assign a char to another char, then the one on the right is first promoted to one of the kinds of int; could doing the assignment result in converting (say) an int to a char and provoking the \u2018implementation defined\u2019 clause? The answer is no, because assignment is specified not to involve the integral promotions, so you are safe.</p>\n"}], "owner": {"reputation": 185, "user_id": 9929801, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/90yR8.png?s=128&g=1", "display_name": "Paul Ankman", "link": "https://stackoverflow.com/users/9929801/paul-ankman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "closed_date": 1530740889, "accepted_answer_id": 51180905, "answer_count": 1, "score": 1, "last_activity_date": 1530739441, "creation_date": 1530738420, "question_id": 51180749, "link": "https://stackoverflow.com/questions/51180749/whats-the-type-of-an-expression-with-two-operandes-of-the-same-size", "closed_reason": "Duplicate", "title": "What&#39;s the type of an expression with two operandes of the same size?", "body": "<p>It is known that if you have an expression of two operands, the type of the computed value will be the larger (in bytes) type of them with integers or the one with the best precision if there's a real.</p>\n\n<p>For example :</p>\n\n<pre><code>( 1   +   2L )  =  3L\n int  +  long   =  long\n\n( 1L   +   1.0 )  =  1.0\n long  +  double  =  double\n</code></pre>\n\n<hr>\n\n<p>But if you have :</p>\n\n<pre><code>(signed int + unsigned int)\n</code></pre>\n\n<p>or</p>\n\n<pre><code>(wchar_t + short)\n</code></pre>\n\n<ul>\n<li>How does the compiler decide ?</li>\n</ul>\n"}, {"tags": ["c", "linux", "linux-kernel"], "comments": [{"owner": {"reputation": 5010, "user_id": 3150445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bfca2588483eadf6695a120cbcef1f8?s=128&d=identicon&r=PG&f=1", "display_name": "jwdonahue", "link": "https://stackoverflow.com/users/3150445/jwdonahue"}, "edited": false, "score": 1, "creation_date": 1530749434, "post_id": 51180640, "comment_id": 89346181, "body": "So virtual and physical addresses are both linear, though the physical address space may have some gaps in it (unlikely on most systems). What do you mean by &quot;logical address&quot;?"}, {"owner": {"reputation": 320, "user_id": 9892803, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-BbRHrblhIfc/AAAAAAAAAAI/AAAAAAAAIz8/KinSdAS0q1o/photo.jpg?sz=128", "display_name": "Pratik Sampat", "link": "https://stackoverflow.com/users/9892803/pratik-sampat"}, "reply_to_user": {"reputation": 5010, "user_id": 3150445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bfca2588483eadf6695a120cbcef1f8?s=128&d=identicon&r=PG&f=1", "display_name": "jwdonahue", "link": "https://stackoverflow.com/users/3150445/jwdonahue"}, "edited": false, "score": 0, "creation_date": 1530749676, "post_id": 51180640, "comment_id": 89346220, "body": "Logical address that the CPU generates which this then passed on the segmentation unit to generate the linear address and which passes on the paging unit to generate the physical address.  Now I understand I can always extract the logical address using a <code>&amp;var</code> but I need to see a mapping from which pages are the ones used by my allocation"}], "answers": [{"tags": [], "owner": {"reputation": 320, "user_id": 9892803, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-BbRHrblhIfc/AAAAAAAAAAI/AAAAAAAAIz8/KinSdAS0q1o/photo.jpg?sz=128", "display_name": "Pratik Sampat", "link": "https://stackoverflow.com/users/9892803/pratik-sampat"}, "is_accepted": true, "score": 0, "last_activity_date": 1530892174, "creation_date": 1530892174, "answer_id": 51213883, "question_id": 51180640, "link": "https://stackoverflow.com/questions/51180640/translate-the-linear-address-to-the-corresponding-logical-address-in-linux-kerne/51213883#51213883", "title": "Translate the linear address to the corresponding logical address in Linux kernel", "body": "<p>So on surfing through the code, I found a function called <code>struct page *\nalloc_pages_vma(gfp_t gfp, int order, struct vm_area_struct *vma,\n                unsigned long addr, int node, bool hugepage)</code> in <code>mm/mempolicy.c</code> on my linux kernel 4.14.4+ <br>\nThe parameter unsigned long addr is the logical address. The page can be accessed from the function from which the physical address and the linear address(virtual) can be extracted too with the functions already mentioned in the question.</p>\n"}], "owner": {"reputation": 320, "user_id": 9892803, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-BbRHrblhIfc/AAAAAAAAAAI/AAAAAAAAIz8/KinSdAS0q1o/photo.jpg?sz=128", "display_name": "Pratik Sampat", "link": "https://stackoverflow.com/users/9892803/pratik-sampat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 242, "favorite_count": 0, "accepted_answer_id": 51213883, "answer_count": 1, "score": -1, "last_activity_date": 1530892174, "creation_date": 1530737601, "last_edit_date": 1530738600, "question_id": 51180640, "link": "https://stackoverflow.com/questions/51180640/translate-the-linear-address-to-the-corresponding-logical-address-in-linux-kerne", "title": "Translate the linear address to the corresponding logical address in Linux kernel", "body": "<p>In the function <code>struct page *rmqueue(..)</code> I am extracting the physical address using <code>page_to_phys(page)</code> and the linear address (also called as <a href=\"https://www.win.tue.nl/~aeb/linux/lk/lk-9.html\" rel=\"nofollow noreferrer\">virtual address</a>) using <code>page_address(page)</code>. My question is how do I extract the logical address generated by the OS so that I can complete my mapping overview from Logical ---> linear ---> Physical address space.</p>\n\n<p>Is it just an offset for the x86 that I need to subtract from the segmantation unit or is it something else?</p>\n"}, {"tags": ["c", "multithreading", "errno"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1530726614, "post_id": 51178801, "comment_id": 89340216, "body": "That doesn&#39;t look like the <a href=\"https://stackoverflow.com/questions/1694164/is-errno-thread-safe\">thread safe definition</a>."}, {"owner": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1530726680, "post_id": 51178801, "comment_id": 89340238, "body": "@tadman Ah, I did not notice <code>define errno (*__errno_location ())</code> which may be a thread safe."}], "owner": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "closed_date": 1530726760, "answer_count": 0, "score": 1, "last_activity_date": 1530726521, "creation_date": 1530726521, "question_id": 51178801, "link": "https://stackoverflow.com/questions/51178801/what-does-make-errno-thread-safe", "closed_reason": "Duplicate", "title": "What does make errno thread safe?", "body": "<p>I'm a beginner in C programming and came across <code>errno</code> declaration. I read man page of POSIX <code>errno</code> and it is required to be thread-local. Here is the quote from man page:</p>\n\n<blockquote>\n  <p>errno  is  defined  by  the  ISO C standard to be a modifiable lvalue of type int, and must not be explicitly declared; errno may be a macro.  errno is thread-local; setting it in one thread does not\n         affect its value in any other thread.</p>\n</blockquote>\n\n<p>Now taking a look at <code>errno.h</code> I found this:</p>\n\n<pre><code>/* Declare the `errno' variable, unless it's defined as a macro by\n   bits/errno.h.  This is the case in GNU, where it is a per-thread\n   variable.  This redeclaration using the macro still works, but it\n   will be a function declaration without a prototype and may trigger\n   a -Wstrict-prototypes warning.  */\n#ifndef errno\nextern int errno;\n#endif\n</code></pre>\n\n<p>And to my knowledge it does not look like a thread local variable. What does make <code>errno</code> being thread-local?</p>\n"}, {"tags": ["c", "gcc", "segmentation-fault", "nfa"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 4, "creation_date": 1530725360, "post_id": 51178581, "comment_id": 89339754, "body": "Debug it. And make sure your indices are not going out of the bounds of the arrays. This seem to be the only possible cause for segfault here."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 3, "creation_date": 1530725461, "post_id": 51178581, "comment_id": 89339788, "body": "Ah... and this: <code>while(!feof(file))</code>. <a href=\"https://stackoverflow.com/questions/5431941/why-is-while-feof-file-always-wrong\">Why is \u201cwhile ( !feof (file) )\u201d always wrong?</a>"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 4, "creation_date": 1530725630, "post_id": 51178581, "comment_id": 89339863, "body": "&quot;<i>Please bear with me because it&#39;s a fairly long program.</i>&quot; No. Please post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> instead."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 2, "creation_date": 1530725756, "post_id": 51178581, "comment_id": 89339904, "body": "Your mixture of  global <code>i</code> and several loop-local <code>i</code> isn&#39;t exactly helping bring clarity to this, btw. Likewise for <code>j</code>."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1530726867, "post_id": 51178581, "comment_id": 89340297, "body": "Compile with <code>-fsanitize=undefined -Wall -Werror -pedantic-errors</code> flags"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1530741714, "post_id": 51178581, "comment_id": 89344813, "body": "when compiling, always enable the warnings, then fix those warnings.  (for <code>gcc</code>, at a minimum use: <code>-Wall -Wextra -Wconversion -pedantic -std=gnu11</code> )"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1530742104, "post_id": 51178581, "comment_id": 89344907, "body": "regarding: <code>fscanf(file,&quot;%s&quot;,a);</code>  1) use this function call in the <code>while()</code> statement and forget about <code>feof()</code> as it does not do what you seem to think it does.  2) when calling any of the <code>scanf()</code> family of functions a) always check the returned value (not the parameter values) to assure the operation was successful. b) when using the format specifiers: <code>%s</code> and <code>%[...]</code> always include a MAX CHARACTERS modifier that is one less than the length of the input buffer to avoid buffer overflows and the resulting undefined behavior"}, {"owner": {"reputation": 53, "user_id": 6762280, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-38PTKMnGoQY/AAAAAAAAAAI/AAAAAAAAAQc/OMEZxIxqm5w/photo.jpg?sz=128", "display_name": "Akhil V", "link": "https://stackoverflow.com/users/6762280/akhil-v"}, "edited": false, "score": 0, "creation_date": 1530785150, "post_id": 51178581, "comment_id": 89358619, "body": "Okay...I will look it up. Thank you"}], "answers": [{"comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 2, "creation_date": 1530726324, "post_id": 51178690, "comment_id": 89340136, "body": "Worth noting, this function also declares a <code>int</code> return type, but makes no attempts whatsoever to fulfill that. A similar problem happens in one of the control paths of <code>pop</code>, which is considerably more disastrous, as its return result is actually used by the caller."}, {"owner": {"reputation": 53, "user_id": 6762280, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-38PTKMnGoQY/AAAAAAAAAAI/AAAAAAAAAQc/OMEZxIxqm5w/photo.jpg?sz=128", "display_name": "Akhil V", "link": "https://stackoverflow.com/users/6762280/akhil-v"}, "edited": false, "score": 0, "creation_date": 1530784891, "post_id": 51178690, "comment_id": 89358459, "body": "Thanks for pointing it out....The program now works for the input as expected.But push or pop wasn&#39;t the problem. Appreciate your help."}], "tags": [], "owner": {"reputation": 8154, "user_id": 2470782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/921783e0584f9ace7e05d303e4d48869?s=128&d=identicon&r=PG", "display_name": "Ingo Leonhardt", "link": "https://stackoverflow.com/users/2470782/ingo-leonhardt"}, "is_accepted": true, "score": 4, "last_activity_date": 1530725884, "creation_date": 1530725884, "answer_id": 51178690, "question_id": 51178581, "link": "https://stackoverflow.com/questions/51178581/my-program-gives-the-correct-output-in-windowsgcc-but-in-linuxgcc-it-leads-t/51178690#51178690", "title": "My program gives the correct output in windows(gcc) but in Linux(gcc) it leads to segmentation fault", "body": "<p>There is a bug here:</p>\n\n<pre><code>int push(int data) {\n\n   if(!isfull()) {\n      top = top + 1;   \n      stack[top] = data;  \n   }\n   else \n      printf(\"Could not insert data, Stack is full.\\n\");  \n}\n</code></pre>\n\n<p>If <code>top == MAXSIZE-1</code>, <code>isfull()</code> will return false, then you increment <code>top</code> to <code>MAXSIZE</code> and assign <code>stack[MAXSIZE]</code> what is out of bounds and invokes UB. Not having checked the complete source code, I could imagine that incrementing <code>top</code> after assigning would be correct or you have to change <code>isfull()</code> to return true if <code>top &gt;= MAXSIZE-1</code></p>\n"}], "owner": {"reputation": 53, "user_id": 6762280, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-38PTKMnGoQY/AAAAAAAAAAI/AAAAAAAAAQc/OMEZxIxqm5w/photo.jpg?sz=128", "display_name": "Akhil V", "link": "https://stackoverflow.com/users/6762280/akhil-v"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 0, "accepted_answer_id": 51178690, "answer_count": 1, "score": 0, "last_activity_date": 1530725884, "creation_date": 1530725272, "question_id": 51178581, "link": "https://stackoverflow.com/questions/51178581/my-program-gives-the-correct-output-in-windowsgcc-but-in-linuxgcc-it-leads-t", "title": "My program gives the correct output in windows(gcc) but in Linux(gcc) it leads to segmentation fault", "body": "<p>This program is to find the epsilon closure of all states of an NFA. I have used the stack to get this done.The program gives the right output when I compiled it using gcc and ran it Windows 10(Command Prompt). But when I compiled with the same compiler and ran it in Linux it results in segmentation fault. I have used any dynamic memory allocation for that matter.</p>\n\n<p>I tried to debug using gdb but not able to find the problem. Detected a segmentation fault after a printf(\"\\n\") when displaying the transitions matrix.\nIt would be very helpful for someone could find the fault. Thanks in advance.</p>\n\n<p>The input is read from a file : nfa.txt.</p>\n\n<pre><code>//states\nq0 q1 q2\n//input_symbols \n0 1\n//start_state       \nq0\n//final_state       \nq2      \n//transitions of the form : intial_state  input  final_state\nq0 0 q0     \nq0 e q1\nq1 1 q1     \nq1 e q2\nq2 2 q2\n</code></pre>\n\n<p>The output is as follows:</p>\n\n<p>232 is to represent null transition(\u03a6) and -1 for \u03b5.</p>\n\n<pre><code>States:\nq0\nq1\nq2\nTransitions read\n232  0    1    2    -1\n0    0    232  232   1\n1    232  1    232   2\n2    232  232  2     232\n\ne-closure(0) : 0 1 2\ne-closure(1) : 1 2\ne-closure(2) : 2\n</code></pre>\n\n<p>Please bear with me because it's a fairly long program.</p>\n\n<pre><code>#include &lt;stdio.h&gt;     \n#include &lt;string.h&gt;     //REMEMBER ME WHILE I'M GONE \n#include &lt;errno.h&gt;\n#include &lt;stdlib.h&gt;\n\nFILE *file;\nint  numberOfStates = 0;\nint  flag = 0;\nint  states[20];\n\nint  j = 0;\nint  i = 0;\nint  k = 0;\n\nchar a[20];\n\nint  transitions[4][5];\nint  visited[10];\n\nint  MAXSIZE = 8;       \nint  stack[8];     \nint  top = -1;            \n\nint isempty()\n{\n   if(top == -1)\n      return 1;\n   else\n      return 0;\n}\n\nint isfull()\n{\n   if(top == MAXSIZE)\n      return 1;\n   else\n      return 0;\n}\n\nint pop() \n{\n   int data;\n\n   if(!isempty()) {\n      data = stack[top];\n      top = top - 1;   \n      return data;\n   }\n   else\n         printf(\"Could not retrieve data, Stack is empty.\\n\");\n }\n\n\nint push(int data) {\n\n   if(!isfull()) {\n      top = top + 1;   \n      stack[top] = data;\n   }\n   else \n      printf(\"Could not insert data, Stack is full.\\n\");\n}\n\nint IsVisited(int edge)\n{\n    for(int i = 0; i &lt; 10; i++)\n        if(visited[edge] == 1)\n            return 1;\n\n    return 0;\n}\n\nvoid epsilon_closure(int state)\n{\n    int  e_closure[10];\n\n\n    for(int i = 0; i &lt; 10; i++ )\n    {   e_closure[i] = -1;\n        visited[i] = 0;\n    }\n\n    push(state);\n    visited[state] = 1;\n\n    while(top != -1)\n    {\n        int u = pop();\n\n        j = 1;\n        while(j &lt; 5)\n        {\n            //if there is an epsilon transition from the state 'u' to 'v'\n            if(transitions[j][0] == u &amp;&amp; transitions[j][4] != 232) //ASCII of \u03a6 = 232\n            {\n                if(! IsVisited(transitions[j][4]))\n                {\n                    visited[transitions[j][4]] = 1;\n                    push(transitions[j][4]);\n                }\n\n            }\n            j++;\n        }\n    }\n\n    j = 0;\n    for(int edge = 0; edge &lt; 10; edge++)\n    {\n        if(visited[edge] == 1)\n            e_closure[j++] = edge;\n    }\n    printf(\"e-closure(%d) : \",state);\n    for (i = 0; e_closure[i] != -1; ++i)\n        printf(\"%d \", e_closure[i]);\n    printf(\"\\n\");\n} \n\nint main()\n{\n    file = fopen(\"nfa.txt\",\"r\");\n\n    if (file == NULL) {\n        perror(\"fopen\");\n        return -1;\n    }\n\n\n    //Reading the states \n    while(!feof(file))\n    {\n        fscanf(file,\"%s\",a);\n        if(strcmp(\"//states\",a) == 0)\n            flag = 1;\n        else if(strcmp(\"//input_symbols\",a) == 0)\n            break;\n        if (flag == 1 &amp;&amp; a[0] != '/')\n        {\n            states[i++] = a[1] - '0';\n\n        }\n        numberOfStates = i; \n    }\n\n    //Display the states of the e-NFA\n    printf(\"\\nStates : \\n\");\n    for(i = 0; i &lt; numberOfStates; i++ )\n    {   \n        printf(\"q%d\\n\",states[i]);\n    }\n\n    i = 1;\n    flag = 0;\n    //Reading the transition table\n\n    for(int i = 0; i &lt; 4; i++){\n        for(int j = 0; j &lt; 5; j++)\n        {\n            transitions[i][j] = 232;\n        }\n\n    }   \n    while(!feof(file))\n    {\n        fgets(a,100,file);\n        if(a[0] == '/')\n        {   \n            flag = 1;\n        }\n        if(flag == 1 &amp;&amp; a[0] != '/')\n        {   \n            j = 0;\n            //found a way to store the transition table in a matrix\n            if(a[3] == 'e')\n                transitions[(a[1] - '0') + 1][4] = a[6] - '0';\n\n            else    \n                transitions[(a[1] - '0') + 1][(a[3] - '0') + 1] = a[6] - '0';\n            if(a[3] != 'e')\n                transitions[0][a[3] - '0' + 1] = a[3] - '0';        //input\n            else\n                transitions[0][4] = -1;     // epsilon input\n            transitions[(a[1] - '0') + 1][0] = a[1] - '0'; //initial state\n\n        }\n    }\n    printf(\"\\nTransitions read\\n\");\n    for(int i = 0; i &lt; 4; i++){\n        for(int j = 0; j &lt; 5; j++)\n        {\n            printf(\"%d\\t\",transitions[i][j]);\n        }\n        printf(\"\\n\"); //detected segmentation fault here\n    }   \n\n    //Calling e-closure for all the states  \n    for(k = 0; k &lt; numberOfStates; k++)\n    {\n        epsilon_closure(states[k]);\n    }\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "stdint", "cstdint"], "comments": [{"owner": {"reputation": 26680, "user_id": 1806780, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/NCB41.jpg?s=128&g=1", "display_name": "Sami Kuhmonen", "link": "https://stackoverflow.com/users/1806780/sami-kuhmonen"}, "edited": false, "score": 0, "creation_date": 1530724038, "post_id": 51178314, "comment_id": 89339215, "body": "Because that\u2019s the fastest at least 16but datatype on that platform. It fits in a register so it can be handled efficiently."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 3, "creation_date": 1530724051, "post_id": 51178314, "comment_id": 89339220, "body": "Haven&#39;t you answered your own question? the _<code>fast</code> thing is telling the compiler to pick the most &quot;convenient&quot; type for the architecture. Yours is 64-bit. So it is piking 64 bit type."}, {"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 2, "creation_date": 1530724400, "post_id": 51178314, "comment_id": 89339362, "body": "&quot;Fixed&quot; bit widths have nothing to do with this. The sizes are <i>guaranteed</i> to be <i>at least</i> that size by the official specifications. However, there are many, many CPUs that do not natively have (for example) 8-bit sized registers or memory cells. In such cases, the compiler has to provide code to make <code>unsigned char c=255; c++;</code> appear as if it <i>is</i> just 8 bits wide."}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "edited": false, "score": 2, "creation_date": 1530724460, "post_id": 51178314, "comment_id": 89339383, "body": "<code>intN_t </code> types have fixed size if they&#39;re available. Fast and least types are always available and implementation defined."}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "reply_to_user": {"reputation": 26680, "user_id": 1806780, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/NCB41.jpg?s=128&g=1", "display_name": "Sami Kuhmonen", "link": "https://stackoverflow.com/users/1806780/sami-kuhmonen"}, "edited": false, "score": 0, "creation_date": 1530732908, "post_id": 51178314, "comment_id": 89342244, "body": "@SamiKuhmonen: It&#39;s not. This is just a bug in the gcc/glibc definitions where somebody did not think through the consequences. 16-bit types are the same speed for basically everything, and <b>a lot faster</b> for division or use in large arrays (where larger type will blow away the cache). <code>int_fastN_t</code> should never be defined as anything but <code>int_leastN_t</code> except on archs that completely lack N-bit store/load operations."}, {"owner": {"reputation": 1810, "user_id": 5500589, "user_type": "registered", "accept_rate": 35, "profile_image": "https://i.stack.imgur.com/IldVR.jpg?s=128&g=1", "display_name": "Galaxy", "link": "https://stackoverflow.com/users/5500589/galaxy"}, "edited": false, "score": 0, "creation_date": 1530733399, "post_id": 51178314, "comment_id": 89342395, "body": "Is a 64-bit data type the fastest integer data type on a 64-bit system? Is a 16-bit data type really slower? What do you want by the term that a data type is &quot;fast&quot;? Is it faster to load a [u]int_fastN_t data type from the main memory into the CPU than a regular data type?"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1530735251, "post_id": 51178314, "comment_id": 89342980, "body": "The question is good except for the <b>last sentence</b>. Could we remove the <b>last sentence</b> and ask why is <code>int_fast32_t</code> 8 bytes when <code>int</code> is 4 bytes on GCC Linux x86-64? Because as far as I know it really isn&#39;t fastest!"}, {"owner": {"reputation": 1810, "user_id": 5500589, "user_type": "registered", "accept_rate": 35, "profile_image": "https://i.stack.imgur.com/IldVR.jpg?s=128&g=1", "display_name": "Galaxy", "link": "https://stackoverflow.com/users/5500589/galaxy"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1530735682, "post_id": 51178314, "comment_id": 89343122, "body": "@AnttiHaapala: I assume that <code>int</code> is 4 bytes on GCC Linux x86-64 because of tradition. Experienced programmers were used to <code>int</code> being 4 bytes, and they wanted to keep it that way to prevent code from potentially breaking. Because then each array takes up twice as much space. Backwards compatibility was probably chosen over speed of accessing the data type. A 64-bit int may also cause issues in structure padding. <a href=\"https://www.youtube.com/watch?v=TtAsN0ptKcw&amp;index=37&amp;list=PL0oekSefhQVJdk0hSRu6sZ2teWM740NtL\" rel=\"nofollow noreferrer\">youtube.com/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1530732419, "post_id": 51178452, "comment_id": 89342090, "body": "To add: <code>int_fastN_t</code> are required. <code>intN_t</code> are not - they are optional for select platforms.  Still <code>intN_t</code> are very commonly available.    (N = 8,16,32, 64)"}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 5, "last_activity_date": 1530724606, "creation_date": 1530724606, "answer_id": 51178452, "question_id": 51178314, "link": "https://stackoverflow.com/questions/51178314/why-is-int-fast16-t-64-bits-on-a-64-bit-system/51178452#51178452", "title": "Why is int_fast16_t 64 bits on a 64-bit system?", "body": "<p>These types are <em>not</em> a fixed size.  They are the type that is <em>at least</em> the given size that will tend to be fastest.</p>\n\n<p>These types are defined in section 7.20.1.3 of the C standard:</p>\n\n<blockquote>\n  <p><em>1</em> Each of the following types designates an integer type that is usually fastest to operate with among all integer types that have at\n  least the specified width.</p>\n  \n  <p><em>2</em> The typedef name <strong>int_fast<em>N</em>_t</strong> designates the fastest signed integer type with a width of at least <em>N</em>.  The typedef name\n  <strong>uint_fast<em>N</em>_t</strong> designates the fastest unsigned integer type with a\n  width of at least <em>N</em>.</p>\n</blockquote>\n"}], "owner": {"reputation": 1810, "user_id": 5500589, "user_type": "registered", "accept_rate": 35, "profile_image": "https://i.stack.imgur.com/IldVR.jpg?s=128&g=1", "display_name": "Galaxy", "link": "https://stackoverflow.com/users/5500589/galaxy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 191, "favorite_count": 0, "accepted_answer_id": 51178452, "answer_count": 1, "score": -2, "last_activity_date": 1530735489, "creation_date": 1530723878, "last_edit_date": 1530735489, "question_id": 51178314, "link": "https://stackoverflow.com/questions/51178314/why-is-int-fast16-t-64-bits-on-a-64-bit-system", "title": "Why is int_fast16_t 64 bits on a 64-bit system?", "body": "<p>I looked inside the header file <code>&lt;stdint.h&gt;</code> on my implementation. I see the following: </p>\n\n<pre><code>typedef long int int_fast16_t;\ntypedef long int int_fast32_t;\ntypedef long int int_fast64_t;\n</code></pre>\n\n<p>I have a 64-bit system, so a long int occupies 64 bits. Why are all three data types typedefed as being long ints? I understand the case of the int_fast64_t, which is 64 bits. But why are the 16 and 32-bit data types having 64 bits? Is this some kind of error? I created a small program to check if this is the case:</p>\n\n<pre><code>sizeof(int_fast8_t) : 1\nsizeof(int_fast16_t) : 8\nsizeof(int_fast32_t) : 8\nsizeof(int_fast64_t) : 8\n</code></pre>\n\n<p>Are the sizes of these data types implementation defined? What features or characteristics defines a data type as being \"fast\"? Is it the speed that chunks of data get loaded from the RAM to the CPU? If <code>int_fast16_t</code> and <code>int_fast32_t</code> are 8 bytes wide, what are the benefits in performance? Is it really faster to access a 64-bit data type on a <strong>64-bit system</strong>?</p>\n"}, {"tags": ["python", "c", "shared-libraries", "ctypes"], "comments": [{"owner": {"reputation": 14113, "user_id": 13824, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/592c1eaba2f1a52a9469c3ff0380cb1f?s=128&d=identicon&r=PG", "display_name": "billjamesdev", "link": "https://stackoverflow.com/users/13824/billjamesdev"}, "edited": false, "score": 0, "creation_date": 1530723932, "post_id": 51178284, "comment_id": 89339176, "body": "Sorry if this is off-topic, but having memory allocated out in the C space seems leaky.  How would that memory be freed?  Do C and python allocate memory in the same way?"}, {"owner": {"reputation": 513, "user_id": 8496533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74532556cdd9291325ce050e1008eaf6?s=128&d=identicon&r=PG&f=1", "display_name": "Anshuman Manral", "link": "https://stackoverflow.com/users/8496533/anshuman-manral"}, "reply_to_user": {"reputation": 14113, "user_id": 13824, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/592c1eaba2f1a52a9469c3ff0380cb1f?s=128&d=identicon&r=PG", "display_name": "billjamesdev", "link": "https://stackoverflow.com/users/13824/billjamesdev"}, "edited": false, "score": 0, "creation_date": 1530769579, "post_id": 51178284, "comment_id": 89349959, "body": "@billjamesdev - You are right. This is leaky as of now. Ideally I want to allocate the memory in python and pass it to the C library function. Is that possible?"}, {"owner": {"reputation": 513, "user_id": 8496533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74532556cdd9291325ce050e1008eaf6?s=128&d=identicon&r=PG&f=1", "display_name": "Anshuman Manral", "link": "https://stackoverflow.com/users/8496533/anshuman-manral"}, "reply_to_user": {"reputation": 14113, "user_id": 13824, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/592c1eaba2f1a52a9469c3ff0380cb1f?s=128&d=identicon&r=PG", "display_name": "billjamesdev", "link": "https://stackoverflow.com/users/13824/billjamesdev"}, "edited": false, "score": 0, "creation_date": 1530798041, "post_id": 51178284, "comment_id": 89367129, "body": "@billjamesdev - See my answer below. Now the buffer memory is allocated in the Python program and the pointer-to-pointer is passed to the C function. Hope this looks better?"}], "answers": [{"comments": [{"owner": {"reputation": 513, "user_id": 8496533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74532556cdd9291325ce050e1008eaf6?s=128&d=identicon&r=PG&f=1", "display_name": "Anshuman Manral", "link": "https://stackoverflow.com/users/8496533/anshuman-manral"}, "edited": false, "score": 0, "creation_date": 1530798002, "post_id": 51192616, "comment_id": 89367105, "body": "And yes, the C program is modified to comment out the malloc there"}, {"owner": {"reputation": 131156, "user_id": 235698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KjvlE.png?s=128&g=1", "display_name": "Mark Tolonen", "link": "https://stackoverflow.com/users/235698/mark-tolonen"}, "edited": false, "score": 0, "creation_date": 1530860008, "post_id": 51192616, "comment_id": 89390133, "body": "If you allocate the memory in Python, it is sufficient to use <code>char* output</code>.   Then use <code>encrypted_pswd</code> to pass the output buffer.  It&#39;s already an array and its address will be passed to the function."}, {"owner": {"reputation": 513, "user_id": 8496533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74532556cdd9291325ce050e1008eaf6?s=128&d=identicon&r=PG&f=1", "display_name": "Anshuman Manral", "link": "https://stackoverflow.com/users/8496533/anshuman-manral"}, "reply_to_user": {"reputation": 131156, "user_id": 235698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KjvlE.png?s=128&g=1", "display_name": "Mark Tolonen", "link": "https://stackoverflow.com/users/235698/mark-tolonen"}, "edited": false, "score": 0, "creation_date": 1531390944, "post_id": 51192616, "comment_id": 89582868, "body": "My C library is a third party code which I cannot modify and it expects the output to be a string pointer to pointer. Also it expects the calling program to allocate the memory. Hence used the <code>pointer(pointer(encrypted_pswd))</code> in the python program"}, {"owner": {"reputation": 131156, "user_id": 235698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KjvlE.png?s=128&g=1", "display_name": "Mark Tolonen", "link": "https://stackoverflow.com/users/235698/mark-tolonen"}, "edited": false, "score": 0, "creation_date": 1531424683, "post_id": 51192616, "comment_id": 89603382, "body": "The third party library is doing unnecessary work and making the API more complicated then. As I showed, you don&#39;t need char** if the buffer is user allocated. You mentioned commenting out the malloc which implied you could change the code."}], "tags": [], "owner": {"reputation": 513, "user_id": 8496533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74532556cdd9291325ce050e1008eaf6?s=128&d=identicon&r=PG&f=1", "display_name": "Anshuman Manral", "link": "https://stackoverflow.com/users/8496533/anshuman-manral"}, "is_accepted": false, "score": 0, "last_activity_date": 1531391255, "last_edit_date": 1531391255, "creation_date": 1530797371, "answer_id": 51192616, "question_id": 51178284, "link": "https://stackoverflow.com/questions/51178284/need-to-pass-pointer-to-pointer-to-a-c-shared-lib-function-from-python/51192616#51192616", "title": "Need to pass pointer-to-pointer to a C shared lib function from Python", "body": "<p>The problem gets solved by doing the following changes in the python program:</p>\n\n<pre><code>import ctypes\nfrom ctypes import *\n\nplainText_pswd = \"hellWithTheWorld\"\nencrypted_pswd = create_string_buffer(32)\n\ntestlib = ctypes.CDLL('/home/amanral/testlib.so')\ntestlib.myprint(plainText_pswd, pointer(pointer(encrypted_pswd)))\nprint \"Recvd encrypted password in python program:\" + encrypted_pswd.value\n</code></pre>\n\n<p>The char pointer-to-pointer required by my C library function is achieved by using \n<code>pointer(pointer(encrypted_pswd))</code> as the argument to the C function. I am not sure if it is the correct way to use but it works alright for my requirement. I am able to print the value returned by the C function as <code>encrypted_pswd.value</code></p>\n\n<p>Any comments/suggestions are still welcome. </p>\n"}, {"tags": [], "owner": {"reputation": 131156, "user_id": 235698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KjvlE.png?s=128&g=1", "display_name": "Mark Tolonen", "link": "https://stackoverflow.com/users/235698/mark-tolonen"}, "is_accepted": false, "score": 0, "last_activity_date": 1530861062, "creation_date": 1530861062, "answer_id": 51204863, "question_id": 51178284, "link": "https://stackoverflow.com/questions/51178284/need-to-pass-pointer-to-pointer-to-a-c-shared-lib-function-from-python/51204863#51204863", "title": "Need to pass pointer-to-pointer to a C shared lib function from Python", "body": "<p>If you allocate the memory in Python you can implement more directly as the following.  Note I used Python 3 and explicitly pass byte strings.</p>\n\n<p><strong>test.c</strong></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n#define API __declspec(dllexport)  // Windows-specific export\n\nAPI void myprint(const char* input, char* output)\n{\n    printf(\"hello world\\n\");\n    printf(\"input string: %s\\n\",input);\n    sprintf(output,\"Life is cheap\\n\");\n    printf(\"output string in C program: %s\\n\",output);\n}\n</code></pre>\n\n<p><strong>test.py</strong></p>\n\n<pre><code>import ctypes\ntestlib = ctypes.CDLL('test')\nmem = ctypes.create_string_buffer(32)\ntestlib.myprint(b'hell with the world',mem)\nprint(mem.value)\n</code></pre>\n\n<p><strong>Output</strong></p>\n\n<pre><code>hello world\ninput string: hell with the world\noutput string in C program: Life is cheap\n\nb'Life is cheap\\n'\n</code></pre>\n\n<p>If you still want to have C allocate the memory you'll have to provide a function to free it if you don't want to leak:</p>\n\n<p><strong>test.c</strong></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n#define API __declspec(dllexport)  // Windows-specific export\n\nAPI void myprint(const char* input, char** output)\n{\n    printf(\"hello world\\n\");\n    printf(\"input string: %s\\n\",input);\n    *output = malloc(32);\n    printf(\"output address: %p\\n\",*output);\n    sprintf(*output,\"Life is cheap\\n\");\n    printf(\"output string in C program: %s\\n\",*output);\n}\n\nAPI void myfree(char* mem)\n{\n    printf(\"freeing %p\\n\",mem);\n    free(mem);\n}\n</code></pre>\n\n<p><strong>test.py</strong></p>\n\n<pre><code>import ctypes\ntestlib = ctypes.CDLL('test')\n\n# allocate a pointer to hold the result\nmem = ctypes.c_char_p()\n\n# Pass it by reference to be modified\ntestlib.myprint(b'hell with the world',ctypes.byref(mem))\nprint(mem.value)\ntestlib.myfree(mem)\n</code></pre>\n\n<p><strong>Output</strong></p>\n\n<pre><code>hello world\ninput string: hell with the world\noutput address: 0000028CEE9BAE50\noutput string in C program: Life is cheap\n\nb'Life is cheap\\n'\nfreeing 0000028CEE9BAE50\n</code></pre>\n"}], "owner": {"reputation": 513, "user_id": 8496533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74532556cdd9291325ce050e1008eaf6?s=128&d=identicon&r=PG&f=1", "display_name": "Anshuman Manral", "link": "https://stackoverflow.com/users/8496533/anshuman-manral"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 281, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1531391255, "creation_date": 1530723731, "last_edit_date": 1530797515, "question_id": 51178284, "link": "https://stackoverflow.com/questions/51178284/need-to-pass-pointer-to-pointer-to-a-c-shared-lib-function-from-python", "title": "Need to pass pointer-to-pointer to a C shared lib function from Python", "body": "<p>I have a small Python program which needs to call a function from my C shared library:</p>\n\n<p>C program first:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nvoid myprint(const char*, char**);\n\nvoid myprint(const char* input, char** output)\n{\nprintf(\"hello world\\n\");\nprintf(\"input string: %s\\n\",input);\n*output = (char*) malloc(20);\nsprintf(*output,\"Life is cheap\\n\");\nprintf(\"output string in C program: %s\\n\",*output);\n}\n</code></pre>\n\n<p>It is compiled to a shared library:</p>\n\n<pre><code>gcc -shared -Wl,-soname,testlib -o testlib.so -fPIC testlib.c\n</code></pre>\n\n<p>As you will notice the function needs a char pointer-to-pointer as it's second argument. It will fill this argument and I expect the python program which calls it to be able to print it.</p>\n\n<p>I am trying to achieve this from the caller python program by passing a reference to a pointer:</p>\n\n<pre><code>import ctypes\nmem = POINTER( c_ubyte )()\ntestlib = ctypes.CDLL('/home/amanral/testlib.so')\ntestlib.myprint(\"hell with the world\",byref(mem))\n#print mem   ===&gt; This is where I want to print back the value filled by the C function\n</code></pre>\n\n<p>I know print mem is wrong because it just prints:</p>\n\n<pre><code>&lt;__main__.LP_c_ubyte object at 0x7f6460246560&gt;\n</code></pre>\n\n<p>Is it even possible to print back the actual string stored in the memory?\nIs there a better solution?</p>\n"}, {"tags": ["c", "gnu-make"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 5, "creation_date": 1530723278, "post_id": 51178163, "comment_id": 89338923, "body": "This is a question to the software developer/maintainer."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 3, "creation_date": 1530726458, "post_id": 51178163, "comment_id": 89340176, "body": "Old school: try <code>$(LL) $(CCFLAGS)  $(OBJS) $(LIBS) -o $(EXE)</code>"}, {"owner": {"reputation": 69991, "user_id": 939557, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/3VPea.png?s=128&g=1", "display_name": "MadScientist", "link": "https://stackoverflow.com/users/939557/madscientist"}, "edited": false, "score": 1, "creation_date": 1530727525, "post_id": 51178163, "comment_id": 89340507, "body": "WhozCraig is correct.  Libraries have to come <i>after</i> object files on the link line.  This makefile is wrong."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1530730176, "post_id": 51178163, "comment_id": 89341465, "body": "<a href=\"https://stackoverflow.com/questions/7826448/linking-libraries-with-gcc-order-of-arguments\" title=\"linking libraries with gcc order of arguments\">stackoverflow.com/questions/7826448/&hellip;</a>"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1530749044, "post_id": 51178163, "comment_id": 89346132, "body": "The functions such as <code>log</code> are definitely missing because <code>-lm</code> appears before any object files, so there are no outstanding (undefined) references to the functions in the library when the library is searched. (Some systems handle it; they&#39;re an exception, not the rule, and for good reason.)  Put the libraries after the object files on the linker command line.  It is not so obvious why the other functions (<code>HairpinE</code> and <code>LoopEnergy</code>) are missed.  The line <code>OBJS = $(foreach file, $(SRCS:.c=.o), $(file))</code> in the makefile is a convoluted way of writing <code>OBJS = $(SRCS:.c=.o)</code>."}], "owner": {"reputation": 1, "user_id": 10033192, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-mIPevaIxHdU/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7pxM66sYFafc8K5TUaHAeiuUYS6Mg/mo/photo.jpg?sz=128", "display_name": "Gilberto P&#233;rez Morales", "link": "https://stackoverflow.com/users/10033192/gilberto-p%c3%a9rez-morales"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 468, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1530723824, "creation_date": 1530723190, "last_edit_date": 1530723824, "question_id": 51178163, "link": "https://stackoverflow.com/questions/51178163/undefined-references-in-make", "title": "Undefined references in make", "body": "<p>I'm having some trouble compiling a program called RNASalsa (source code <a href=\"http://www.bioinf.uni-leipzig.de/Software/RNAsalsa/RNAsalsa_0.8.1.tar.gz\" rel=\"nofollow noreferrer\">here</a>).\nAccording to the manual, all I heve to do is download the tar.gz file and do</p>\n\n<pre><code>tar zxvf RNAsalsa_xxx.tar.gz\ncd RNAsalsa_xxx\nmake\n</code></pre>\n\n<p>The output from make generates the following error:</p>\n\n<pre><code>    gcc -O1 -DUNUSED='' -g -lm -o RNAsalsa  main.o  alifold.o  align.o  constraint.o  energy_par.o  fold.o  fold_vars.o  makeMx6.o  params.o  read_input.o  sequences.o  structaln.o  scoring10.o  multiple8.o  makeMx7.o  PS_dot.o  utilities.o  utils.o  naview.o  final_consensus.o\nalifold.o: In function `alifold':\nRNAsalsa_0.8.1/alifold.c:186: undefined reference to `HairpinE'\nRNAsalsa_0.8.1/alifold.c:203: undefined reference to `LoopEnergy'\nRNAsalsa_0.8.1/alifold.c:465: undefined reference to `HairpinE'\nRNAsalsa_0.8.1/alifold.c:479: undefined reference to `LoopEnergy'\nfold.o: In function `ML_Energy':\nRNAsalsa_0.8.1/fold.c:1242: undefined reference to `log'\nfold.o: In function `HairpinE':\nRNAsalsa_0.8.1/fold.c:789: undefined reference to `log'\nfold.o: In function `LoopEnergy':\nRNAsalsa_0.8.1/fold.c:869: undefined reference to `log'\nRNAsalsa_0.8.1/fold.c:893: undefined reference to `log'\nfold.o: In function `HairpinE':\nRNAsalsa_0.8.1/fold.c:789: undefined reference to `log'\nPS_dot.o: In function `PS_color_dot_plot':\nRNAsalsa_0.8.1/PS_dot.c:764: undefined reference to `sqrt'\nPS_dot.o: In function `simple_xy_coordinates':\nRNAsalsa_0.8.1/PS_dot.c:805: undefined reference to `sincos'\nPS_dot.o: In function `PS_dot_plot_list':\nRNAsalsa_0.8.1/PS_dot.c:908: undefined reference to `sqrt'\nPS_dot.o: In function `PS_color_dot_plot_turn':\nRNAsalsa_0.8.1/PS_dot.c:997: undefined reference to `sqrt'\nPS_dot.o: In function `PS_dot_plot_turn':\nRNAsalsa_0.8.1/PS_dot.c:1027: undefined reference to `sqrt'\nnaview.o: In function `construct_circle_segment':\nRNAsalsa_0.8.1/naview.c:981: undefined reference to `sqrt'\nnaview.o: In function `find_center_for_arc':\nRNAsalsa_0.8.1/naview.c:1123: undefined reference to `sqrt'\nRNAsalsa_0.8.1/naview.c:1130: undefined reference to `acos'\nRNAsalsa_0.8.1/naview.c:1132: undefined reference to `acos'\nnaview.o: In function `construct_circle_segment':\nRNAsalsa_0.8.1/naview.c:1006: undefined reference to `sqrt'\nRNAsalsa_0.8.1/naview.c:1007: undefined reference to `atan2'\nRNAsalsa_0.8.1/naview.c:1011: undefined reference to `sincos'\nnaview.o: In function `traverse_loop':\nRNAsalsa_0.8.1/naview.c:467: undefined reference to `sincos'\nRNAsalsa_0.8.1/naview.c:467: undefined reference to `sincos'\nRNAsalsa_0.8.1/naview.c:463: undefined reference to `sqrt'\nRNAsalsa_0.8.1/naview.c:466: undefined reference to `atan2'\nRNAsalsa_0.8.1/naview.c:586: undefined reference to `asin'\nRNAsalsa_0.8.1/naview.c:586: undefined reference to `sincos'\nRNAsalsa_0.8.1/naview.c:587: undefined reference to `asin'\nRNAsalsa_0.8.1/naview.c:587: undefined reference to `sincos'\nRNAsalsa_0.8.1/naview.c:601: undefined reference to `sincos'\nRNAsalsa_0.8.1/naview.c:628: undefined reference to `sincos'\nRNAsalsa_0.8.1/naview.c:685: undefined reference to `sqrt'\nRNAsalsa_0.8.1/naview.c:690: undefined reference to `sqrt'\nRNAsalsa_0.8.1/naview.c:696: undefined reference to `sqrt'\nRNAsalsa_0.8.1/naview.c:704: undefined reference to `atan2'\nRNAsalsa_0.8.1/naview.c:708: undefined reference to `atan2'\nRNAsalsa_0.8.1/naview.c:742: undefined reference to `sqrt'\nRNAsalsa_0.8.1/naview.c:743: undefined reference to `atan2'\nRNAsalsa_0.8.1/naview.c:747: undefined reference to `sqrt'\nRNAsalsa_0.8.1/naview.c:748: undefined reference to `atan2'\nnaview.o: In function `construct_extruded_segment':\nRNAsalsa_0.8.1/naview.c:1046: undefined reference to `sqrt'\nRNAsalsa_0.8.1/naview.c:1068: undefined reference to `atan2'\nRNAsalsa_0.8.1/naview.c:1077: undefined reference to `atan2'\nRNAsalsa_0.8.1/naview.c:1083: undefined reference to `sincos'\nRNAsalsa_0.8.1/naview.c:1087: undefined reference to `sincos'\nnaview.o: In function `traverse_loop':\nRNAsalsa_0.8.1/naview.c:774: undefined reference to `sincos'\ncollect2: error: ld returned 1 exit status\n</code></pre>\n\n<p>So, it seems that there is something wrong in the order it is calling certain functions. For instance, function 'alifold' has an undefined reference to 'HairpinE'  before this function is defined.\nAlso, the undefined references to 'log' and 'sqrt' imply that it is failing to include 'math.h' (yes \"include \" is in the .c files).</p>\n\n<p>Any ideas why this may happen?\nThe makefile given by the developers is as follows:</p>\n\n<pre><code>EXE     = RNAsalsa\nCC      = gcc\nLL      = gcc\nVERSION = 0.8.1\nDISTNAME= RNAsalsa_0.8.1\nCCFLAGS = -O1 -DUNUSED='' -g\nLIBS    = -lm\nINCS    = alifold.h energy_const.h \\\n          energy_par.h fold.h fold_vars.h intloops.h \\\n          pair_mat.h params.h scoretable.h \\\n          utils.h circfold.inc PS_dot.h structs.h\nSRCS    = main.c alifold.c align.c constraint.c energy_par.c fold.c \\\n          fold_vars.c makeMx6.c params.c read_input.c sequences.c \\\n          structaln.c scoring10.c multiple8.c makeMx7.c PS_dot.c\\\n          utilities.c utils.c naview.c final_consensus.c\nOBJS    = $(foreach file, $(SRCS:.c=.o), $(file))\nall: $(EXE)\n$(EXE): $(OBJS)\n        $(LL) $(CCFLAGS) $(LIBS) -o $(EXE) $(OBJS)\n$(OBJS): %.o: %.c\n        $(CC) -c $(CCFLAGS) $&lt; -o $@\nveryclean:\n        rm -f $(OBJS) $(EXE)\nclean:\n        rm -f $(OBJS) core\n</code></pre>\n\n<p>I'm using gcc 5.4.0, in ubuntu 16.04.1, build-essential is installed</p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["c", "static", "initialization", "static-analysis"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1530722526, "post_id": 51177998, "comment_id": 89338600, "body": "I believe not zeroing out static variables is &quot;fooling&quot; your compiler (and the programmer), that is assuming they are zero. So if you explicitly setting some variable like this to zero elsewhere, it might just optimize away this operation as it thinks it is zero anyway."}, {"owner": {"reputation": 5570, "user_id": 281460, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/cU05x.jpg?s=128&g=1", "display_name": "jwir3", "link": "https://stackoverflow.com/users/281460/jwir3"}, "edited": false, "score": 2, "creation_date": 1530722595, "post_id": 51177998, "comment_id": 89338628, "body": "I think this question is a duplicate of: <a href=\"https://stackoverflow.com/q/7822740/281460\">stackoverflow.com/q/7822740/281460</a>"}, {"owner": {"reputation": 417, "user_id": 1303568, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/5hdar.jpg?s=128&g=1", "display_name": "Ian Brockbank", "link": "https://stackoverflow.com/users/1303568/ian-brockbank"}, "reply_to_user": {"reputation": 5570, "user_id": 281460, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/cU05x.jpg?s=128&g=1", "display_name": "jwir3", "link": "https://stackoverflow.com/users/281460/jwir3"}, "edited": false, "score": 0, "creation_date": 1530723513, "post_id": 51177998, "comment_id": 89339019, "body": "@jwir3 I looked at that, but that was talking about local static variables within functions, rather than global static variables."}, {"owner": {"reputation": 417, "user_id": 1303568, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/5hdar.jpg?s=128&g=1", "display_name": "Ian Brockbank", "link": "https://stackoverflow.com/users/1303568/ian-brockbank"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1530723623, "post_id": 51177998, "comment_id": 89339060, "body": "@eugene sh. That&#39;s exactly the problem. If we know we have it, we can handle it, but we want a tool which could tell us we potentially have the problem case for any changes in future."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1530723690, "post_id": 51177998, "comment_id": 89339093, "body": "@IanBrockbank It won&#39;t help. The tool will analyze the source code, which might have the initialization. But the compiler will optimize this initialization out. Better find the resources to properly initialize the <code>.data</code> and <code>.bss</code>. Or don&#39;t use static variables if you can&#39;t."}], "owner": {"reputation": 417, "user_id": 1303568, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/5hdar.jpg?s=128&g=1", "display_name": "Ian Brockbank", "link": "https://stackoverflow.com/users/1303568/ian-brockbank"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 1, "closed_date": 1530722748, "answer_count": 0, "score": 1, "last_activity_date": 1530722395, "creation_date": 1530722395, "question_id": 51177998, "link": "https://stackoverflow.com/questions/51177998/is-there-a-static-c-analyzer-which-detects-uninitialized-static-variables", "closed_reason": "Duplicate", "title": "Is there a static C analyzer which detects uninitialized static variables?", "body": "<p>We have hit a problem with some C code in embedded firmware which only occurred on 1 in 200 systems, and boiled down to use of a global static variable before it had been initialized.</p>\n\n<p>In normal C, this wouldn't be a problem because static variables get initialized to 0, but this embedded system is so space/time-constrained that there is no cinit, so static variables do not get zeroed.</p>\n\n<p>Now that we have spotted the problem, we have been able to fix it, but we want to spot it in future 100% - 1 in 200 systems was painful to hunt down, and next time it might be 1 in 5000, 1 in a million or less, so no amount of testing can give us complete confidence.</p>\n\n<p>We use cppcheck and SonarQube for static analysis, but we haven't found how to catch this error with those.</p>\n\n<ol>\n<li>Is there an option in either cppcheck or SonarQube which would detect use of static global variables before initialization?  If so, how do we use it?</li>\n<li>If not, is there any other static analysis tool which does provide this warning?</li>\n</ol>\n"}, {"tags": ["c", "r", "rstudio"], "comments": [{"owner": {"reputation": 170794, "user_id": 190277, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dcf9672c1893e4b7c5d86ca1bc2bf88f?s=128&d=identicon&r=PG", "display_name": "Ben Bolker", "link": "https://stackoverflow.com/users/190277/ben-bolker"}, "edited": false, "score": 0, "creation_date": 1530718258, "post_id": 51176970, "comment_id": 89336698, "body": "you almost certainly need to install the <a href=\"https://cran.r-project.org/bin/windows/Rtools/installer.html\" rel=\"nofollow noreferrer\">R tools</a>. Once you&#39;ve done that, you can <code>devtools::install_github(&quot;hafen&#47;operator&quot;); library(&quot;operator&quot;)</code>."}, {"owner": {"reputation": 170794, "user_id": 190277, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dcf9672c1893e4b7c5d86ca1bc2bf88f?s=128&d=identicon&r=PG", "display_name": "Ben Bolker", "link": "https://stackoverflow.com/users/190277/ben-bolker"}, "edited": false, "score": 0, "creation_date": 1530718467, "post_id": 51176970, "comment_id": 89336795, "body": "<a href=\"https://stackoverflow.com/questions/42565317/error-installing-old-packages-in-r\" title=\"error installing old packages in r\">stackoverflow.com/questions/42565317/&hellip;</a>"}, {"owner": {"reputation": 170794, "user_id": 190277, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dcf9672c1893e4b7c5d86ca1bc2bf88f?s=128&d=identicon&r=PG", "display_name": "Ben Bolker", "link": "https://stackoverflow.com/users/190277/ben-bolker"}, "edited": false, "score": 0, "creation_date": 1530797468, "post_id": 51176970, "comment_id": 89366764, "body": "install the R tools! link in my first comment"}, {"owner": {"reputation": 1, "user_id": 6166901, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f1d76c21d71519c49a0b437456a7b04?s=128&d=identicon&r=PG&f=1", "display_name": "Bnakey", "link": "https://stackoverflow.com/users/6166901/bnakey"}, "reply_to_user": {"reputation": 170794, "user_id": 190277, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dcf9672c1893e4b7c5d86ca1bc2bf88f?s=128&d=identicon&r=PG", "display_name": "Ben Bolker", "link": "https://stackoverflow.com/users/190277/ben-bolker"}, "edited": false, "score": 0, "creation_date": 1530817087, "post_id": 51176970, "comment_id": 89378103, "body": "Sadly, I cannot download R tools and directly download from github due to specifc software/security restrictions."}, {"owner": {"reputation": 170794, "user_id": 190277, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dcf9672c1893e4b7c5d86ca1bc2bf88f?s=128&d=identicon&r=PG", "display_name": "Ben Bolker", "link": "https://stackoverflow.com/users/190277/ben-bolker"}, "edited": false, "score": 0, "creation_date": 1530820651, "post_id": 51176970, "comment_id": 89379650, "body": "Then you&#39;re stuck unless you can convince someone else to compile a binary version of the package for you. You could try to get it compiled on win-builder, but it might fail because of R version mismatches. If no-one else comes forward and I have time I can post that as an answer, but I think the odds are at best 50/50 that it will work. Basically, you need to (1) edit the DESCRIPTION file of the package so that it lists you as the maintainer (and gives your e-mail); (2) build the package &amp; upload it via ftp to <code>win-builder.r-project.org</code> (see <a href=\"https://win-builder.r-project.org/\" rel=\"nofollow noreferrer\">win-builder.r-project.org</a>) ..."}, {"owner": {"reputation": 170794, "user_id": 190277, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dcf9672c1893e4b7c5d86ca1bc2bf88f?s=128&d=identicon&r=PG", "display_name": "Ben Bolker", "link": "https://stackoverflow.com/users/190277/ben-bolker"}, "edited": false, "score": 0, "creation_date": 1530820699, "post_id": 51176970, "comment_id": 89379668, "body": "(3) ask for it to be compiled/checked on &quot;oldrelease&quot; (R 3.4.4); (4) wait for an e-mail saying it has been built; (5) download the binary and hope it works on your system."}], "answers": [{"tags": [], "owner": {"reputation": 503, "user_id": 8080276, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0nu3y.jpg?s=128&g=1", "display_name": "Akhzar Nazir", "link": "https://stackoverflow.com/users/8080276/akhzar-nazir"}, "is_accepted": false, "score": 0, "last_activity_date": 1553005175, "creation_date": 1553005175, "answer_id": 55243157, "question_id": 51176970, "link": "https://stackoverflow.com/questions/51176970/failed-with-error-operator-is-not-a-valid-installed-package/55243157#55243157", "title": "Failed with error: \u2018\u2018operator\u2019 is not a valid installed package", "body": "<p>I was facing the same issue with RTextTools, as RTextTools is now not available on CRAN.</p>\n\n<p>I have Download RTextTools From Given Link</p>\n\n<p>\u2028<a href=\"https://cran.r-project.org/src/contrib/Archive/RTextTools/\" rel=\"nofollow noreferrer\">https://cran.r-project.org/src/contrib/Archive/RTextTools/</a></p>\n\n<p>and copy \nRTextTools_1.4.2.tar.gz file in project root folder\nthen \nrun this command in project folder in terminal<br>\n\"R CMD INSTALL RTextTools_1.4.2.tar.gz\"\n After running this command I receive below error\n\"ERROR: dependencies \u2018SparseM\u2019, \u2018randomForest\u2019, \u2018tree\u2019, \u2018e1071\u2019, \u2018ipred\u2019, \u2018caTools\u2019, \u2018maxent\u2019, \u2018glmnet\u2019, \u2018tau\u2019 are not available for package \u2018RTextTools\u2019\"</p>\n\n<p>Now install each dependencies from RStudio or RConsole (Any Editor used by you) by simply running this code</p>\n\n<blockquote>\n  <p>install.packages(\"caTools\")\n  Install all 9 required packages One By One (In My Case it was 9 Packages Dependencies required by RTextTools)\n  all packages will be installed except 'maxent'</p>\n</blockquote>\n\n<p>Now download maxent from the given link\n<a href=\"https://cran.r-project.org/src/contrib/Archive/maxent/\" rel=\"nofollow noreferrer\">https://cran.r-project.org/src/contrib/Archive/maxent/</a></p>\n\n<p>and copy maxent_1.3.3.1.tar file in project folder then\nrun this command in project folder in terminal<br>\n\"R CMD INSTALL maxent_1.3.3.1.tar\"</p>\n\n<p>Now For RTextTools Run this command again in Terminal\n\"R CMD INSTALL RTextTools_1.4.2.tar.gz\"</p>\n\n<p>All is done Now..</p>\n\n<p>But the Last Step is</p>\n\n<p>Load the RTextTools using </p>\n\n<blockquote>\n  <p>library(RTextTools)</p>\n</blockquote>\n\n<p>You will see one more Error: <strong>Load SparseM</strong>\nNow Loading SparseM use code below</p>\n\n<blockquote>\n  <p>library(SparseM)</p>\n</blockquote>\n\n<p>and in the last Load RTextTools</p>\n\n<blockquote>\n  <p>library(RTextTools)</p>\n</blockquote>\n"}], "owner": {"reputation": 1, "user_id": 6166901, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f1d76c21d71519c49a0b437456a7b04?s=128&d=identicon&r=PG&f=1", "display_name": "Bnakey", "link": "https://stackoverflow.com/users/6166901/bnakey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 935, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1553005175, "creation_date": 1530717997, "last_edit_date": 1530797421, "question_id": 51176970, "link": "https://stackoverflow.com/questions/51176970/failed-with-error-operator-is-not-a-valid-installed-package", "title": "Failed with error: \u2018\u2018operator\u2019 is not a valid installed package", "body": "<p>Currently I am having problems with loading an R package that I downloaded from github (<a href=\"https://github.com/hafen/operator\" rel=\"nofollow noreferrer\">https://github.com/hafen/operator</a>). I downloaded the package and put it in my local R folder: \"C:/..../Documents/R/win-library/3.2/operator\". </p>\n\n<p>However, I have not been able to load said package into R. I keep on receiving the following errors when trying to load the package. Can anyone help me. I found an error that I though was somewhat relevant that suggest updating \"Rcpp\" which I have already done with no success. Thank you in advance for any and all help!</p>\n\n<p>I should add. I looked into this a bit more and realized the issue I am having is revolving around the C script that is contained within the package. If I remove the C script I can load the package, however, some of the package functions are dependent on the script and will not run as a result.</p>\n\n<pre><code>&gt; require(operator)\nLoading required package: operator\nFailed with error:  \u2018\u2018operator\u2019 is not a valid installed package\u2019\n</code></pre>\n\n<p>or</p>\n\n<pre><code>&gt; devtools::load_all(\"C:/..../Documents/R/win-library/3.2/operator\")\nLoading operator\nRe-compiling operator\n\"C:/PROGRA~1/R/R-32~1.2/bin/x64/R\" --no-site-file --no-environ --no-save --no-restore --quiet CMD INSTALL  \\\n\"C:\\Users\\blakey1\\Documents\\R\\win-library\\3.2\\operator\"  \\\n--library=\"C:\\Users\\blakey1\\AppData\\Local\\Temp\\Rtmpe611i9\\devtools_install_499c5059149c\" --no-R --no-data  \\\n--no-help --no-demo --no-inst --no-docs --no-exec --no-multiarch --no-test-load \n\n* installing *source* package 'operator' ...\n** libs\nWarning: running command 'make -f \"C:/PROGRA~1/R/R-32~1.2/etc/x64/Makeconf\" -f \"C:/PROGRA~1/R/R-32~1.2/share/make/winshlib.mk\" SHLIB=\"operator.dll\" WIN=64 TCLBIN=64 OBJECTS=\"loess_op.o\"' had status 127\nERROR: compilation failed for package 'operator'\n* removing 'C:/Users/blakey1/AppData/Local/Temp/Rtmpe611i9/devtools_install_499c5059149c/operator'\nError: Command failed (1)\n</code></pre>\n"}, {"tags": ["c", "linux-kernel", "kernel-module", "usb-drive"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 3, "creation_date": 1530716626, "post_id": 51176520, "comment_id": 89335825, "body": "Why not just write an udev script?"}, {"owner": {"reputation": 26, "user_id": 10032821, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-WPfMyQOVfUU/AAAAAAAAAAI/AAAAAAAAAKY/5EvWFoHxcag/photo.jpg?sz=128", "display_name": "Tziii", "link": "https://stackoverflow.com/users/10032821/tziii"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1530718627, "post_id": 51176520, "comment_id": 89336869, "body": "I already did, also a Perl script which is listening on syslog. But I really want a Kernel Modul for that."}], "answers": [{"comments": [{"owner": {"reputation": 26, "user_id": 10032821, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-WPfMyQOVfUU/AAAAAAAAAAI/AAAAAAAAAKY/5EvWFoHxcag/photo.jpg?sz=128", "display_name": "Tziii", "link": "https://stackoverflow.com/users/10032821/tziii"}, "edited": false, "score": 0, "creation_date": 1530736675, "post_id": 51178244, "comment_id": 89343408, "body": "ok, could you pls explain how I have to create the udev rule and how it looks like? I never used udev"}, {"owner": {"reputation": 26, "user_id": 10032821, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-WPfMyQOVfUU/AAAAAAAAAAI/AAAAAAAAAKY/5EvWFoHxcag/photo.jpg?sz=128", "display_name": "Tziii", "link": "https://stackoverflow.com/users/10032821/tziii"}, "edited": false, "score": 0, "creation_date": 1530773562, "post_id": 51178244, "comment_id": 89351747, "body": "I just found some examples where I have to hand over the Vendor an Product ID but I want the rule for all USB Sticks"}, {"owner": {"reputation": 26, "user_id": 10032821, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-WPfMyQOVfUU/AAAAAAAAAAI/AAAAAAAAAKY/5EvWFoHxcag/photo.jpg?sz=128", "display_name": "Tziii", "link": "https://stackoverflow.com/users/10032821/tziii"}, "edited": false, "score": 0, "creation_date": 1530826233, "post_id": 51178244, "comment_id": 89381961, "body": "Doesn&#39;t matter anymore, will use the Perl script for that. But thx for your help"}], "tags": [], "owner": {"reputation": 587, "user_id": 9703208, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/168cfbdd659ac8a46446ecf97727f78b?s=128&d=identicon&r=PG&f=1", "display_name": "Vinay P", "link": "https://stackoverflow.com/users/9703208/vinay-p"}, "is_accepted": true, "score": 1, "last_activity_date": 1530775231, "last_edit_date": 1530775231, "creation_date": 1530723548, "answer_id": 51178244, "question_id": 51176520, "link": "https://stackoverflow.com/questions/51176520/kernel-module-which-opens-a-script-when-inserting-an-usb-stick/51178244#51178244", "title": "Kernel Module which opens a script when inserting an USB-Stick", "body": "<p>Consider adding a Udev <a href=\"https://wiki.archlinux.org/index.php/udev\" rel=\"nofollow noreferrer\">rule</a>. Writing a kernel module is not good option as its not a good idea to run scripts in Kernel mode, Kernel mode is not intended to do that.</p>\n\n<p>There is an answered question <a href=\"https://stackoverflow.com/questions/8190542/how-do-i-detect-usb-drive-insertion-in-linux\">How to do I detect USB drive</a> </p>\n"}], "owner": {"reputation": 26, "user_id": 10032821, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-WPfMyQOVfUU/AAAAAAAAAAI/AAAAAAAAAKY/5EvWFoHxcag/photo.jpg?sz=128", "display_name": "Tziii", "link": "https://stackoverflow.com/users/10032821/tziii"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "closed_date": 1530740989, "accepted_answer_id": 51178244, "answer_count": 1, "score": 0, "last_activity_date": 1530775231, "creation_date": 1530716364, "last_edit_date": 1530717258, "question_id": 51176520, "link": "https://stackoverflow.com/questions/51176520/kernel-module-which-opens-a-script-when-inserting-an-usb-stick", "closed_reason": "Needs more focus", "title": "Kernel Module which opens a script when inserting an USB-Stick", "body": "<p>I need to write a Kernel-Module which do something like open a script when an USB-Stick got inserted. I can't find any Header-File or smth i can use to check, if a USB-Stick got inserted, not first time initialized. I found a function for disconnects, but not for connects but the disconnect function also doesn't work because the usbhid is Blocking it (I think so, I'm not sure). Tried to unload the Driver but doesn't helped. Did anyone know where I can find a function for USB-Connection? Or send me a code example? I don't mean probe functions!</p>\n\n<p>Thank you community </p>\n"}, {"tags": ["c", "linux", "sockets", "raw-ethernet"], "answers": [{"tags": [], "owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "is_accepted": true, "score": 3, "last_activity_date": 1530715924, "creation_date": 1530715924, "answer_id": 51176390, "question_id": 51176250, "link": "https://stackoverflow.com/questions/51176250/ethernet-type-0x0101-not-working-with-raw-socket/51176390#51176390", "title": "Ethernet type 0x0101 not working with raw socket", "body": "<p>Tcpdump interprets the value <code>0x0101</code> in this position as <em>Ethernet Frame Length</em>. </p>\n\n<p>Values smaller than 0x600 (1536 decimal) are assumed to be the frame length (parsed as Frametype IEEE 802.2 LLC) instead of the next protocol id (parsed as Frametype Ethernet II).</p>\n\n<p>Here you see, that tcpdump indeed interprets 0x101 (257 decimal) as the length:</p>\n\n<p>00:00:01.001914 aa:00:00:2e:00:02 > 08:00:27:0b:ed:84, 802.3, <strong>length 257</strong>: LLC, dsap Null (0x00) Individual, ssap Null (0x00) Command, ctrl 0x0000: Information, send s0</p>\n\n<p>But your frame should be correctly on-wire as you intended it.</p>\n"}], "owner": {"reputation": 108, "user_id": 7362958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/590adbee41464bc855623cde5b6adfc9?s=128&d=identicon&r=PG&f=1", "display_name": "ieio", "link": "https://stackoverflow.com/users/7362958/ieio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 145, "favorite_count": 0, "accepted_answer_id": 51176390, "answer_count": 1, "score": 1, "last_activity_date": 1530715924, "creation_date": 1530715434, "question_id": 51176250, "link": "https://stackoverflow.com/questions/51176250/ethernet-type-0x0101-not-working-with-raw-socket", "title": "Ethernet type 0x0101 not working with raw socket", "body": "<p>I tried to send a raw packet with ethernet type 0x0101 but it seems not to be working, if I use ethernet type 0x1000 it is working properly.\nBasically I open a raw socket:</p>\n\n<pre><code>int sd = socket(AF_PACKET, SOCK_RAW | SOCK_CLOEXEC, htons(0x0101));\nint r = sendmsg(sd, msgSend, 0);\n</code></pre>\n\n<p>accordingly with <a href=\"https://www.iana.org/assignments/ieee-802-numbers/ieee-802-numbers.xhtml\" rel=\"nofollow noreferrer\">iana</a> ethernet type 0101-01FF are experimental, so to my understating can be used for experiments.</p>\n\n<p>If I use 0x0101 tcpdump shows:</p>\n\n<pre><code>00:00:01.001914 aa:00:00:2e:00:02 &gt; 08:00:27:0b:ed:84, 802.3, length 257: LLC, dsap Null (0x00) Individual, ssap Null (0x00) Command, ctrl 0x0000: Information, send s0\n        0x0000:  0000 0000 efbe adde aaaa db00 0000 0000  ................                                                                                              \n        0x0010:  0000 0000 0000 0000 0000 0000 0000 0000  ................                                                                                              \n        0x0020:  0000 0000 0000 0000 0000 0000 0000 0000  ................                                                                                              \n        0x0030:  0000\n</code></pre>\n\n<p>while when I use 0x1000 is shows:</p>\n\n<pre><code>00:00:00.439876 aa:00:00:2e:00:02 &gt; 08:00:27:0b:ed:84, ethertype Trail (0x1000), length 64:                                                                            \n        0x0000:  0000 0000 efbe adde aaaa db00 0000 0000  ................                                                                                              \n        0x0010:  0000 0000 0000 0000 0000 0000 0000 0000  ................                                                                                              \n        0x0020:  0000 0000 0000 0000 0000 0000 0000 0000  ................                                                                                              \n        0x0030:  0000 \n</code></pre>\n\n<p>What am I missing?</p>\n"}, {"tags": ["c", "date", "time"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user9999696"}, "edited": false, "score": 0, "creation_date": 1530714559, "post_id": 51176003, "comment_id": 89334708, "body": "I want to send the time and the date to different columns in my database table called Logs"}, {"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "edited": false, "score": 4, "creation_date": 1530714588, "post_id": 51176003, "comment_id": 89334725, "body": "<i>Why</i> do you not want to use <code>struct tm</code>?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1530714622, "post_id": 51176003, "comment_id": 89334747, "body": "All of the standard time functions in C are documented here: <a href=\"http://port70.net/~nsz/c/c11/n1570.html#7.27.2\" rel=\"nofollow noreferrer\">port70.net/~nsz/c/c11/n1570.html#7.27.2</a> Pick the one you like."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1530714694, "post_id": 51176003, "comment_id": 89334791, "body": "Please <a href=\"https://stackoverflow.com/posts/51176003/edit\">edit</a>  your question, format it correctly and add all necessary information <i>there</i> and not in a comment."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9999696"}, "edited": false, "score": 0, "creation_date": 1530714732, "post_id": 51176003, "comment_id": 89334809, "body": "the structure does not cater for the two columns in my database"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 4, "creation_date": 1530715070, "post_id": 51176003, "comment_id": 89335004, "body": "I still don&#39;t understand why you can&#39;t use <code>struct tm</code>.  You can use the <code>tm_year</code>, <code>tm_mon</code>, and <code>tm_mday</code> fields to construct the data to insert into your date column, and then you can turn around and use the <code>tm_hour</code>, <code>tm_min</code>, and <code>tm_sec</code> fields (from the exact same <code>struct tm</code> instance, that is) to construct the data to insert into your time column."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1530715278, "post_id": 51176003, "comment_id": 89335114, "body": "stackoverflow is not a free coding service.  Please post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> showing what you have done and state the problem your having.  Then we can help you."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9999696"}, "reply_to_user": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1530715284, "post_id": 51176003, "comment_id": 89335120, "body": "@Steve Summit Does that mean i declare a new variable for date and another for time and store there the respective components of each?"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1530715548, "post_id": 51176003, "comment_id": 89335273, "body": "regarding: <code>duration = clock() - duration;</code>  this will not compile nor work correctly as <code>duration</code> is not declared and does not contain an initial value."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9999696"}, "reply_to_user": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1530716174, "post_id": 51176003, "comment_id": 89335604, "body": "@Steve Summit. It has worked as desired, Thanx"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 2, "creation_date": 1530716175, "post_id": 51176003, "comment_id": 89335605, "body": "Beware that <code>clock()</code> gives an approximate measure of CPU time.  If you want &quot;real time&quot; or &quot;wall clock time&quot;, you probably want to use <code>time()</code> (or maybe <code>gettimeofday()</code> or <code>clock_gettime()</code>) instead."}], "answers": [{"tags": [], "owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "is_accepted": true, "score": 2, "last_activity_date": 1530716294, "creation_date": 1530716294, "answer_id": 51176494, "question_id": 51176003, "link": "https://stackoverflow.com/questions/51176003/what-function-in-c-can-i-use-to-get-the-date-alone-separate-from-time/51176494#51176494", "title": "What function in C can I use to get the date alone separate from time?", "body": "<p>You might want to declare two character arrays, one for the date string and one for the time string, and call <code>strftime</code> twice to construct them.\nSomething like this:</p>\n\n<pre><code>char SubmissionDate[20], SubmissionTime[20];\nstrftime(SubmissionDate, sizeof(SubmissionDate), \"%Y-%m-%d\", &amp;tm); \nstrftime(SubmissionTime, sizeof(SubmissionTime), \"%H:%M:%S\", &amp;tm);\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9999696"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 51176494, "answer_count": 1, "score": 0, "last_activity_date": 1530736357, "creation_date": 1530714498, "last_edit_date": 1530736357, "question_id": 51176003, "link": "https://stackoverflow.com/questions/51176003/what-function-in-c-can-i-use-to-get-the-date-alone-separate-from-time", "title": "What function in C can I use to get the date alone separate from time?", "body": "<p>I am building a C program and I need to use time separately and also the date separately. I want to do this without using the structure <code>struct tm</code> since I have to send the time and the date to different columns in my database table called <code>Logs</code>:</p>\n\n<pre><code>int main(){       \n\n       duration = clock() - duration;\n       double Duration = ((double)duration)/CLOCKS_PER_SEC;\n\n       char* IPaddr = inet_ntoa(newAddr.sin_addr);\n        int PortNo = ntohs(newAddr.sin_port);\n        printf(\"\\n%s %s %d %f\\n\", task, IPaddr, PortNo, Duration);\n        printf(\"now: %d-%d-%d %d:%d:%d\\n\",tm.tm_mday,tm.tm_mon+1,tm.tm_year+1900,tm.tm_hour,tm.tm_min,tm.tm_sec);\n\n        if (mysql_query(con, \"INSERT INTO Logs(ClientIP, ClientPort, Job_type, SubmissionTime, SubmissionDate, Duration)\n                VALUES(%s, %d, %s, %, %, %f)\")) {\n                    finish_with_error(con);\n                }\n\n        return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "data-structures"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1530714128, "post_id": 51175867, "comment_id": 89334425, "body": "So the time is <code>nc</code> as you calculated. So what is the complexity then?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1530714215, "post_id": 51175867, "comment_id": 89334475, "body": "Each adding to the array is O(1), but you&#39;re doing it n times, which means it all in all have to be O(n) (for a standard &quot;array&quot; that have a fixed size, and you&#39;re not reallocating it dynamically)."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1530717724, "post_id": 51175867, "comment_id": 89336423, "body": "The speed of inserting items into an array depends on things like data cache, data size, parallelism options, available CPU registers etc etc. It does not depend on some theoretical &quot;big O&quot; nonsense from the 1960s. Focus on real-world computers instead of fictional &quot;computer science computers&quot;. &quot;Big O&quot; theory has been dead for some 30 years."}], "answers": [{"comments": [{"owner": {"reputation": 1684, "user_id": 4204198, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9936c35f88885edbcca58942c24abed2?s=128&d=identicon&r=PG&f=1", "display_name": "Manoj Kumar Dhakad", "link": "https://stackoverflow.com/users/4204198/manoj-kumar-dhakad"}, "edited": false, "score": 4, "creation_date": 1530714338, "post_id": 51175899, "comment_id": 89334555, "body": "In Linked list if you are keep tracking of last added node so it will be same O(n) for linked list as well means you are maintaining tail pointer"}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 2, "last_activity_date": 1530714147, "creation_date": 1530714147, "answer_id": 51175899, "question_id": 51175867, "link": "https://stackoverflow.com/questions/51175867/what-is-the-time-complexity-of-inserting-n-elements-to-the-end-of-an-array/51175899#51175899", "title": "What is the time complexity of inserting n elements to the end of an array?", "body": "<p>Unlike a linked list, which requires traversing the list to add to the end, arrays have constant time access to any array member.</p>\n\n<p>So assuming the array doesn't need to be resized, adding an element to the end is O(1), meaning that adding n elements is O(n).</p>\n"}, {"comments": [{"owner": {"reputation": 36328, "user_id": 5483526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec50563f80bacd2a7fed69bd31d0c810?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Timmermans", "link": "https://stackoverflow.com/users/5483526/matt-timmermans"}, "edited": false, "score": 1, "creation_date": 1530752463, "post_id": 51176054, "comment_id": 89346629, "body": "This answer is too good for the question :)   It needs to be somewhere on SO, but not here."}], "tags": [], "owner": {"reputation": 42504, "user_id": 1161878, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/0157ddd785dc01e95342e3661d34b42a?s=128&d=identicon&r=PG", "display_name": "Gene", "link": "https://stackoverflow.com/users/1161878/gene"}, "is_accepted": false, "score": 2, "last_activity_date": 1530715708, "last_edit_date": 1530715708, "creation_date": 1530714701, "answer_id": 51176054, "question_id": 51175867, "link": "https://stackoverflow.com/questions/51175867/what-is-the-time-complexity-of-inserting-n-elements-to-the-end-of-an-array/51176054#51176054", "title": "What is the time complexity of inserting n elements to the end of an array?", "body": "<p>Yes, adding <code>n</code> elements requires O(n) time, but adding an individual item is not O(1). It's <em>amortized</em> O(1).</p>\n\n<p>Any given add may require O(n) time by itself because the current array's space has been filled, so it must be copied to another, larger space. </p>\n\n<p>But if the new space allocation is a <em>constant factor greater than one</em> of the original (2 is often used), then the copy costs amortize so that average time per add is constant as you say, and <code>n</code> adds are O(n).</p>\n\n<p>To make this clearer, consider the case where the factor is 2 and initial array size is 1. Then consider copy costs to grow the array from size 1 to where it's large enough to hold, 2^k+1 elements for any k>=0. This size is 2^(k+1). Total copy costs will include all the copying to become that big in factor-of-2 steps: </p>\n\n<pre><code>1 + 2 + 4 + ... + 2^k = 2^(k+1) - 1 = 2n - 1\n</code></pre>\n\n<p>The equalities are due to basic algebra. The result is O(n). However, the last copy itself has n = 2^k elements, which is also O(n).</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9926417"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3200, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1534556099, "creation_date": 1530714036, "question_id": 51175867, "link": "https://stackoverflow.com/questions/51175867/what-is-the-time-complexity-of-inserting-n-elements-to-the-end-of-an-array", "title": "What is the time complexity of inserting n elements to the end of an array?", "body": "<p>i know that inserting an element to an array takes a constant time let us say c.</p>\n\n<p>What I have tried:</p>\n\n<p>for inserting n element\n     <code>time=c+c+c+.......n times =nc</code> </p>\n\n<p>i want to ask that will it be big O of n or o(1).</p>\n"}, {"tags": ["python", "c", "struct", "floating-point", "ieee-754"], "comments": [{"owner": {"reputation": 1202, "user_id": 5902284, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/f8e7e787671552bbc854ddf9f675185a?s=128&d=identicon&r=PG&f=1", "display_name": "nicoco", "link": "https://stackoverflow.com/users/5902284/nicoco"}, "edited": false, "score": 4, "creation_date": 1530712322, "post_id": 51175298, "comment_id": 89333361, "body": "No screenshot of text please. Just copy paste it!"}, {"owner": {"reputation": 97835, "user_id": 355230, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/VjcbL.jpg?s=128&g=1", "display_name": "martineau", "link": "https://stackoverflow.com/users/355230/martineau"}, "edited": false, "score": 3, "creation_date": 1530713138, "post_id": 51175298, "comment_id": 89333853, "body": "<a href=\"https://meta.stackoverflow.com/questions/285551/why-not-upload-images-of-code-on-so-when-asking-a-question\"><b>Why not upload images of code on SO when asking a question?</b></a>"}, {"owner": {"reputation": 2480, "user_id": 2496333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c7ec55c68fb65605cd8350519d09b08?s=128&d=identicon&r=PG", "display_name": "d-stroyer", "link": "https://stackoverflow.com/users/2496333/d-stroyer"}, "edited": false, "score": 1, "creation_date": 1530713606, "post_id": 51175298, "comment_id": 89334150, "body": "First suggestion : take a couple of reference numbers (2.0 ; 3.14159 ; 1000000) and check their HEX representation on both sides. I mean : independantly of the transmission line. In many cases, there is a simple problem of endiannes and all you have to do is to revert the bytes (or the bits) order."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1530713805, "post_id": 51175298, "comment_id": 89334261, "body": "Yeah, most likely an endian issue."}], "answers": [{"tags": [], "owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "is_accepted": true, "score": 0, "last_activity_date": 1530714353, "creation_date": 1530714353, "answer_id": 51175961, "question_id": 51175298, "link": "https://stackoverflow.com/questions/51175298/float-to-embedded-c-float-over-uart/51175961#51175961", "title": "float to embedded c float over UART", "body": "<p>You cannot convert an integer bitpattern to a <code>float</code> by means of a cast. That just converts the integer to the nearest floating-point number, it does <em>not</em> re-interpret the bits as being a <code>float</code>. If it worked like you think, this:</p>\n\n<pre><code>const float x = 512;\n</code></pre>\n\n<p>would set <code>x</code> to <code>7.175E-43</code>, which would not be very convenient.</p>\n\n<p>The best way is probably to just copy the bits, so replace</p>\n\n<pre><code>SUS_Data.Longitude = ((float)Longitude);\n</code></pre>\n\n<p>by:</p>\n\n<pre><code>memcpy(&amp;SUS_Data.Longitude, &amp;Longitude, sizeof SUS_Data.Longitude);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 35, "user_id": 7166917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2fe9fa020fbaf7c129f1cef469d7822?s=128&d=identicon&r=PG&f=1", "display_name": "kuch3n", "link": "https://stackoverflow.com/users/7166917/kuch3n"}, "is_accepted": false, "score": 2, "last_activity_date": 1530715313, "last_edit_date": 1530715313, "creation_date": 1530714744, "answer_id": 51176064, "question_id": 51175298, "link": "https://stackoverflow.com/questions/51175298/float-to-embedded-c-float-over-uart/51176064#51176064", "title": "float to embedded c float over UART", "body": "<p>Get the pointer and typecast to a float pointer:</p>\n\n<pre><code>uint32 tmp = 1085256688;\nfloat f;\n\nf = *((float *) &amp;tmp); // 5.490715\n</code></pre>\n\n<p>or use a union:</p>\n\n<pre><code>union test {\n  uint32_t u;\n  float f;\n};\nunion test tmp;\ntmp.u = 1085256688; // tmp.f == 5.490715\n</code></pre>\n\n<p>in your case:</p>\n\n<pre><code>SUS_Data.Longitude = *((float *) &amp;Longitude);\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10032466, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-HMTeB8jTKYc/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq04uDSqT8IuCAy_cuXZU_zpyiZ8Cw/mo/photo.jpg?sz=128", "display_name": "R Coppens", "link": "https://stackoverflow.com/users/10032466/r-coppens"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 205, "favorite_count": 0, "closed_date": 1530748972, "accepted_answer_id": 51175961, "answer_count": 2, "score": -5, "last_activity_date": 1530715313, "creation_date": 1530712207, "last_edit_date": 1530713125, "question_id": 51175298, "link": "https://stackoverflow.com/questions/51175298/float-to-embedded-c-float-over-uart", "closed_reason": "Not suitable for this site", "title": "float to embedded c float over UART", "body": "<p>I am trying to send python float's over UART to an Embedded c processor, the MKE14 from NXP. In python I am using the Struct library to make a 32 bit float and send this over UART. I checked both float impelementations and there both \"IEEE-754\".</p>\n\n<p>I send Decimal: 5.490715       Hex: 0x40, 0xAF, 0xB3, 0xF0</p>\n\n<p>I receive in \"Longitude\"      Decimal: 1085256688 Hex: 0x40, 0xAF, 0xB3, 0xF0</p>\n\n<p>After float conv              Decimal: 1085256704 Hex: 0x40, 0xAF, 0xB4, 0x00</p>\n\n<p>It must be some conversion problem, I receive the right packet but the representation is tottaly different. </p>\n\n<p>The used code on both systems are in the attached file. </p>\n\n<p><a href=\"https://i.stack.imgur.com/ftt5T.png\" rel=\"nofollow noreferrer\">Python code image</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/pIEG5.png\" rel=\"nofollow noreferrer\">Embedded C code</a></p>\n"}, {"tags": ["c", "memory", "structure", "allocation"], "comments": [{"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 3, "creation_date": 1530712142, "post_id": 51175222, "comment_id": 89333226, "body": "It doesn\u2019t have an element. <code>e.a[0] = 2;</code> is undefined behaviour. Empty arrays and structs are also not standard C."}], "answers": [{"tags": [], "owner": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "is_accepted": false, "score": 4, "last_activity_date": 1530712130, "creation_date": 1530712130, "answer_id": 51175259, "question_id": 51175222, "link": "https://stackoverflow.com/questions/51175222/can-you-please-give-information-on-why-the-variable-value-is-stored-but-the-siz/51175259#51175259", "title": "Can you please give information on why the variable value is stored, but the size of the structure is still 0 bytes?", "body": "<p>You are over-running the buffer here:</p>\n\n<pre><code>e.a[0] = 2;\n</code></pre>\n\n<p>This invokes <em>undefined behavior</em>.</p>\n\n<p>The program is not required to crash. In fact it may seem to run just fine, but you're trashing some other memory and the program could explode at any time.</p>\n\n<p>To do this safely you must increase the size of your array to hold at least one element:</p>\n\n<pre><code>struct e1\n{\n    int a[1];\n};\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "is_accepted": false, "score": 2, "last_activity_date": 1530712144, "creation_date": 1530712144, "answer_id": 51175265, "question_id": 51175222, "link": "https://stackoverflow.com/questions/51175222/can-you-please-give-information-on-why-the-variable-value-is-stored-but-the-siz/51175265#51175265", "title": "Can you please give information on why the variable value is stored, but the size of the structure is still 0 bytes?", "body": "<p>This is <strong>undefined behavior</strong>. Your array has no elements, still you write one -- this is illegal and anything can happen. It's quite probable to <strong>seem</strong> working (might write some memory on the stack directly after your zero-sized struct, where maybe the next declared variable would be placed as well), but expect crashes soon...</p>\n\n<p><strong>Something to remember now:</strong> C never checks for errors like this, it just declares the behavior undefined. Be careful when programming in C.</p>\n\n<p>As a side note: An array or struct of size zero doesn't even exist in standard C, so your compiler could reject this code as well.</p>\n"}, {"comments": [{"owner": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "edited": false, "score": 0, "creation_date": 1530712303, "post_id": 51175308, "comment_id": 89333345, "body": "But obviously the code compiled, because he&#39;s probably using GCC which <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Zero-Length.html\" rel=\"nofollow noreferrer\">supports it as an extension</a>."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "edited": false, "score": 0, "creation_date": 1530712348, "post_id": 51175308, "comment_id": 89333376, "body": "@JonathonReinhart Agree, but that does not change the fact."}, {"owner": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "edited": false, "score": 0, "creation_date": 1530712396, "post_id": 51175308, "comment_id": 89333402, "body": "Sure, but your answer doesn&#39;t explain the actual problem: that he&#39;s over-running the buffer. Why didn&#39;t you point out that his <code>main</code> isn&#39;t providing a prototype, or returning a value?"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "edited": false, "score": 0, "creation_date": 1530712459, "post_id": 51175308, "comment_id": 89333445, "body": "@JonathonReinhart regarding the second comment, any strictly conforming compiler would have rejected the code, so no question of running the binary. :)"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1530727117, "post_id": 51175308, "comment_id": 89340387, "body": "Your quote is discussing variable-length arrays in <a href=\"https://port70.net/~nsz/c/c11/n1570.html#6.7.6.2p5\" rel=\"nofollow noreferrer\">&#167;6.7.6.2 &#182;5</a> and non-constant dimensions.  <a href=\"https://port70.net/~nsz/c/c11/n1570.html#6.7.6.2p1\" rel=\"nofollow noreferrer\">C11 &#167;6.7.26.2 Array declarators &#182;1</a> is more relevant for fixed size arrays: <i>In addition to optional type qualifiers and the keyword <code>static</code>, the <code>[</code> and <code>]</code> may delimit an expression or <code>*</code>. If they delimit an expression (which specifies the size of an array), the expression shall have an integer type. If the expression is a constant expression, it shall have a value greater than zero.</i>"}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 1, "last_activity_date": 1530713528, "last_edit_date": 1530713528, "creation_date": 1530712234, "answer_id": 51175308, "question_id": 51175222, "link": "https://stackoverflow.com/questions/51175222/can-you-please-give-information-on-why-the-variable-value-is-stored-but-the-siz/51175308#51175308", "title": "Can you please give information on why the variable value is stored, but the size of the structure is still 0 bytes?", "body": "<p>Your code is <strong>not valid C</strong>. An array cannot have a zero as size.</p>\n\n<p>Quoting <code>C11</code>, chapter </p>\n\n<blockquote>\n  <p>If the size is an expression that is not an integer constant expression: if it occurs in a\n  declaration at function prototype scope, it is treated as if it were replaced by <code>*</code>; <strong>otherwise,\n  each time it is evaluated it shall have a value greater than zero.</strong></p>\n</blockquote>\n\n<p>Considering your <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Zero-Length.html\" rel=\"nofollow noreferrer\">compiler supports a zero-length array</a> as the last element of a structure, you need to allocate memory first before you can actually make use of it.</p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 1, "creation_date": 1530713592, "post_id": 51175684, "comment_id": 89334145, "body": "FAMs are a <b>completely</b> different thing than 0-sized arrays."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1530716911, "post_id": 51175684, "comment_id": 89335981, "body": "So I wrote - similar not identical. BTW zero length arrays are IMO 100% C valid (at least gcc valid) and widely used in many programs (especially network stacks) in the pre C99 era."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1530721191, "post_id": 51175684, "comment_id": 89338045, "body": "Although GCC without the <code>-pedantic</code> option accepts zero-size arrays, the standard says they\u2019re forbidden. You should not put spaces around the dot <code>.</code> or arrow <code>-&gt;</code> operators. They bind very tightly indeed."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1530725973, "post_id": 51175684, "comment_id": 89340005, "body": "@JonathanLeffler <code>-&gt;</code> without the spaces looks horrible for me. Dot is a different story. Arrow without the spaces is just your liking and style  and is not the &quot;absolute truth&quot;. You should write: <code>I do not like spaces around the arrow</code> instead of &quot;You should not&quot;"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1530726236, "post_id": 51175684, "comment_id": 89340101, "body": "Remind me never to review your code. No one will be happy.  It is extremely unorthodox to use spaces around arrows; normally, one only sees it in beginner&#39;s code.  The first C book counselled against spaces around arrows and dots; you should follow the guidance of the deities who created C."}], "tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": 0, "last_activity_date": 1530713418, "creation_date": 1530713418, "answer_id": 51175684, "question_id": 51175222, "link": "https://stackoverflow.com/questions/51175222/can-you-please-give-information-on-why-the-variable-value-is-stored-but-the-siz/51175684#51175684", "title": "Can you please give information on why the variable value is stored, but the size of the structure is still 0 bytes?", "body": "<p>in your case it ivokes an undefined behavior. But very similar structs are used if you fave some data which has be stored in the struct but the size of it is unknown. But of course you need to allocate space for it</p>\n\n<p>Example:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\ntypedef struct\n{\n    size_t size;\n    char string[];\n}string;\n\nstring *String(void)\n{\n    string *s = malloc(sizeof(string));\n    if(s) s -&gt; size = 0;\n    return s;\n}\n\nstring *StringCopy(string *dest, const string *src)\n{\n    if(!src || !dest) return NULL;\n    if(dest -&gt; size &lt; src -&gt; size)\n    {\n        dest = realloc(dest, src -&gt; size + sizeof(string));\n        if(!dest) return NULL;\n    }\n    memcpy(dest -&gt; string, src -&gt; string, src -&gt; size);\n    dest -&gt; size = src -&gt; size;\n    return dest;\n}\n\nstring *StringCstringCopy(string *dest, const char *src)\n{\n    size_t srcLength;\n    if(!src || !dest) return NULL;\n\n    srcLength = strlen(src);\n    if(dest -&gt; size &lt; srcLength)\n    {\n        dest = realloc(dest, srcLength + sizeof(string));\n        if(!dest) return NULL;\n    }\n    memcpy(dest -&gt; string, src, srvLength);\n    dest -&gt; size = srcLength;\n    return dest;\n}\n\n\nint main(void) {\n\n    string *s = String();\n\n    s = StringCstringCopy(s, \"Hello\");\n    // your code goes here\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9762938, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "raj naregal", "link": "https://stackoverflow.com/users/9762938/raj-naregal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1530713528, "creation_date": 1530712030, "last_edit_date": 1530712218, "question_id": 51175222, "link": "https://stackoverflow.com/questions/51175222/can-you-please-give-information-on-why-the-variable-value-is-stored-but-the-siz", "title": "Can you please give information on why the variable value is stored, but the size of the structure is still 0 bytes?", "body": "<p>Why is the structure variable 'e' have no size, while its element is declared and initialized?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main ()\n{\n  struct e1\n  {\n    int a[0];\n  };\n  struct e1 e;\n  e.a[0] = 2;\n  printf (\"%d\\n\", e.a[0]);\n  printf (\"%d\", sizeof (e));\n}\n</code></pre>\n\n<p>Output is<br>\n2<br>\n0</p>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "edited": false, "score": 1, "creation_date": 1530711588, "post_id": 51175062, "comment_id": 89332884, "body": "You already seem to understand the problem... Move the enum definition out of the function, before your prototypes."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1530712148, "post_id": 51175062, "comment_id": 89333233, "body": "In this line: <code>automate(tddv_estime, tab_para_automate, &amp;Etat);</code> what is <code>Etat</code>? there is no such symbol in the scope of <code>fct_test</code>?"}, {"owner": {"reputation": 69, "user_id": 9729288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16b85b6c05b29106d1fca65b089221a2?s=128&d=identicon&r=PG&f=1", "display_name": "Mathieu TSH", "link": "https://stackoverflow.com/users/9729288/mathieu-tsh"}, "edited": false, "score": 0, "creation_date": 1530712161, "post_id": 51175062, "comment_id": 89333245, "body": "I moved the enum definition before the prototypes and i added : Etat etat = INIT; to instanciate the variables but i still have problems..."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1530712210, "post_id": 51175062, "comment_id": 89333283, "body": "<i>I still have problems</i>: that is...?"}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1530713236, "post_id": 51175062, "comment_id": 89333915, "body": "Note: <code>16 &gt; 15</code>"}], "answers": [{"comments": [{"owner": {"reputation": 69, "user_id": 9729288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16b85b6c05b29106d1fca65b089221a2?s=128&d=identicon&r=PG&f=1", "display_name": "Mathieu TSH", "link": "https://stackoverflow.com/users/9729288/mathieu-tsh"}, "edited": false, "score": 0, "creation_date": 1530712798, "post_id": 51175270, "comment_id": 89333654, "body": "Thanks, the problem was that i didn&#39;t instanciate an enum object before calling my function. I have another question, once an enum object is instanciated, can i use it in another function calling ?"}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "reply_to_user": {"reputation": 69, "user_id": 9729288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16b85b6c05b29106d1fca65b089221a2?s=128&d=identicon&r=PG&f=1", "display_name": "Mathieu TSH", "link": "https://stackoverflow.com/users/9729288/mathieu-tsh"}, "edited": false, "score": 0, "creation_date": 1530712853, "post_id": 51175270, "comment_id": 89333686, "body": "Yes, you can treat an enum object just like every other object (i.e. a struct), there is not much difference."}], "tags": [], "owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "is_accepted": true, "score": 1, "last_activity_date": 1530712152, "creation_date": 1530712152, "answer_id": 51175270, "question_id": 51175062, "link": "https://stackoverflow.com/questions/51175062/passing-enum-pointer-in-parameters-in-c-programming/51175270#51175270", "title": "Passing enum pointer in parameters in C programming", "body": "<p>You have to declare the type <code>enum Etat</code> before the first usage (i.e. directly after your includes):</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdbool.h&gt;\n\nenum Etat {INIT, DECREMENT_PARA_1, INCREMENT_PARA_1, ETAT_INVARIANT_1, DECREMENT_PARA_2, ETAT_INVARIANT_2, INCREMENT_PARA_2, RADAR_SATURE};\n</code></pre>\n\n<p>and fix the prototype and definition to use the new type (remember: the <em>type</em> is <code>enum Etat</code>)</p>\n\n<pre><code>//Prototypes\nvoid automate(int tddv_estime, int tab_para_automate[][3], enum Etat *etat);\nvoid fct_test(int scenario[]);\n</code></pre>\n\n<p>Then you have to instantiate an enum object before calling automate:</p>\n\n<pre><code>enum Etat etat;\nautomate(tddv_estime, tab_para_automate, &amp;etat);\n</code></pre>\n\n<p>This is how you use enums correctly.</p>\n"}], "owner": {"reputation": 69, "user_id": 9729288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16b85b6c05b29106d1fca65b089221a2?s=128&d=identicon&r=PG&f=1", "display_name": "Mathieu TSH", "link": "https://stackoverflow.com/users/9729288/mathieu-tsh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 51175270, "answer_count": 1, "score": 1, "last_activity_date": 1530715054, "creation_date": 1530711457, "last_edit_date": 1530715054, "question_id": 51175062, "link": "https://stackoverflow.com/questions/51175062/passing-enum-pointer-in-parameters-in-c-programming", "title": "Passing enum pointer in parameters in C programming", "body": "<p>I have some problems passing my enum pointer to a function parameters.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdbool.h&gt;\n\n//Prototypes\nvoid automate(int tddv_estime, int tab_para_automate[][3], enum* Etat);\nvoid fct_test(int scenario[]);\n\n\n/*-----------------------------------------------------------------------\nmain()\n-------------------------------------------------------------------------*/\nint main()\n{ \nint scenario[15] = {21, 21, 20, 12, 12, 20, 22, 22, 22, 22, 22, 22, 22, 22, 500};\n\nfct_test(scenario);\nreturn 0;\n}\n\n/*-----------------------------------------------------------------------\nFonction fct_test\n-------------------------------------------------------------------------*/\nvoid fct_test(int scenario[])\n{\n    //PARAMETRES\n    int increment = 1;\n    int tddv_estime;\n\n\nint para_1_min = 5;\nint para_1_max = 10;\n\nint para_2_min = 1;\nint para_2_max = 4;\n\nint tab_para_automate[2][3] = {{0}};\nint tab_para_application[2][2] = {{0}};\n\nint i,j,k;\n\nenum Etat {INIT, DECREMENT_PARA_1, INCREMENT_PARA_1, ETAT_INVARIANT_1, DECREMENT_PARA_2, ETAT_INVARIANT_2, INCREMENT_PARA_2, RADAR_SATURE};\n\n/*printf(\"ETAT INITIAL\\n\");\nprintf(\"Para_1_courant = %d\\n\" , para_1_courant);\nprintf(\"Para_2_courant = %d\\n\\n\\n\" , para_2_courant);*/\n\nfor (k=0 ; k&lt;16 ;k++)\n{\n    tab_para_automate[k][0] = para_1_min;\n    tab_para_automate[k][1] = para_1_max;\n}\n\n\nfor (j=1 ; j&lt;16 ;j++)\n{\n    tab_para_automate[j][0] = para_2_min;\n    tab_para_automate[j][1] = para_2_max;\n}\n\n\n    do {\n    for (i=0 ; i&lt;16 ; i++)\n   {\n        tddv_estime = scenario[i];\n        automate(tddv_estime, tab_para_automate, &amp;Etat);\n   }\n        }while (scenario[i] != 500);\n}\n\n/*-----------------------------------------------------------------------\nFonction automate\n-------------------------------------------------------------------------*/\n\nvoid automate(int tddv_estime, int tab_para_automate[][3], enum* Etat)\n{\nint evenement;\n\nint tddv_worst = 20;\nint para_1_min = tab_para_automate[0][0];\nint para_1_max = tab_para_automate[0][1];\n\nint para_2_min = tab_para_automate[1][0];\nint para_2_max = tab_para_automate[1][1];\n\nint para_2_courant = para_2_max;\nint para_1_courant = para_2_max;\n\nif (tddv_estime &lt; tddv_worst)\n    evenement = 1; //Etat initial\n\nif (tddv_estime &gt; tddv_worst)\n    evenement = 2; //Decrement para1\n\nif (tddv_estime &lt; tddv_worst &amp;&amp; tab_para_automate[0][0] &lt; tab_para_automate[0][1])\n    evenement = 3; //Increment para1\n\nif (tddv_estime == tddv_worst)\n    evenement = 4; //Etat Invariant 1\n\nif (tddv_estime &gt; tddv_worst &amp;&amp; tab_para_automate[0][0] &lt;= tab_para_automate[0][0])\n    evenement = 5; //Decrement para_2\n\nif (tddv_estime &lt; tddv_worst &amp;&amp; para_2_courant &lt; tab_para_automate[1][1])\n    evenement = 6; //Increment para2\n\nif (tddv_estime == tddv_worst)\n    evenement = 7; //Etat Invariant 2\n\nif (tddv_estime &gt; tddv_worst &amp;&amp; tab_para_automate[0][0] &lt;= para_1_min &amp;&amp; para_2_courant &lt;= para_2_min)\n    evenement = 8; //Etat radar sature\n\n\n}\n</code></pre>\n\n<p>I can't pass my enum pointer in parameters, i don't know why. I've been looking for the solution for a while now, can someone help me on this please ?\nMaybe the problem is in the prototypes, maybe i don't declare well my enum variable, i can't find the solution.</p>\n"}, {"tags": ["c", "file"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1530711965, "post_id": 51175055, "comment_id": 89333102, "body": "I can&#39;t see any trace of C++ in this question, so I removed the tag..."}, {"owner": {"reputation": 255, "user_id": 5442752, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh5.googleusercontent.com/-90-MMiaxQOY/AAAAAAAAAAI/AAAAAAAAATY/hAuskwRegdM/photo.jpg?sz=128", "display_name": "Nitescu Lucian", "link": "https://stackoverflow.com/users/5442752/nitescu-lucian"}, "edited": false, "score": 0, "creation_date": 1530712013, "post_id": 51175055, "comment_id": 89333134, "body": "@FelixPalmen Thx"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "is_accepted": true, "score": 2, "last_activity_date": 1530711642, "creation_date": 1530711642, "answer_id": 51175116, "question_id": 51175055, "link": "https://stackoverflow.com/questions/51175055/aes256-hex-print-to-hex-tofile-using-enc-out/51175116#51175116", "title": "AES256 hex_print to hex_tofile using enc_out", "body": "<p>Use <a href=\"https://linux.die.net/man/3/fprintf\" rel=\"nofollow noreferrer\"><code>fprintf()</code></a> instead of <code>printf()</code>, and pass an additional <code>FILE *</code> parameter:</p>\n\n<pre><code>static void hex_print(FILE *out, const void* pv, size_t len)\n{\n     // ...\n     fprintf(out, \"%02X \", *p++);\n     // ...\n</code></pre>\n\n<p>When calling this, pass an opened <code>FILE *</code> for <code>out</code>. You can also pass <code>stdout</code> or <code>stderr</code>, so this will be more flexible anyways.</p>\n"}], "owner": {"reputation": 255, "user_id": 5442752, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh5.googleusercontent.com/-90-MMiaxQOY/AAAAAAAAAAI/AAAAAAAAATY/hAuskwRegdM/photo.jpg?sz=128", "display_name": "Nitescu Lucian", "link": "https://stackoverflow.com/users/5442752/nitescu-lucian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "accepted_answer_id": 51175116, "answer_count": 1, "score": 0, "last_activity_date": 1530711942, "creation_date": 1530711441, "last_edit_date": 1530711942, "question_id": 51175055, "link": "https://stackoverflow.com/questions/51175055/aes256-hex-print-to-hex-tofile-using-enc-out", "title": "AES256 hex_print to hex_tofile using enc_out", "body": "<p>Given the variable enc_out as the output of an AES256 encryption algorithm, and the function: </p>\n\n<pre><code>static void hex_print(const void* pv, size_t len)\n{\n    const unsigned char * p = (const unsigned char*)pv;\n    if (NULL == pv)\n        printf(\"NULL\");\n    else\n    {\n        size_t i = 0;\n        for (; i&lt;len;++i)\n            printf(\"%02X \", *p++);\n    }\n    printf(\"\\n\");\n}\n</code></pre>\n\n<p>Which is used to print the output AES256 encryption in hex, How can I change the above function to output the hex to a file?</p>\n"}, {"tags": ["c", "gcc", "type-conversion", "gcc-warning"], "comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 1, "creation_date": 1530709604, "post_id": 51174412, "comment_id": 89331608, "body": "Yeah, but <code>int</code> is probably 32 bits or more."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "is_accepted": true, "score": 6, "last_activity_date": 1530709711, "creation_date": 1530709711, "answer_id": 51174502, "question_id": 51174412, "link": "https://stackoverflow.com/questions/51174412/gcc-wconversion-warning-for-16-bit-addition/51174502#51174502", "title": "GCC -Wconversion warning for 16-bit addition", "body": "<blockquote>\n  <p>Should I cast in all such cases? Casting feels like I am doing something wrong.</p>\n</blockquote>\n\n<p>It's the correct thing to do here, at least if the code should be portable. If it's only ever compiled for 16bit platforms, there shouldn't be a warning, otherwise, silence the warning with an explicit cast to <code>uint16_t</code>:</p>\n\n<pre><code>uint16_t value = (uint16_t) (x + 1) * y;\n</code></pre>\n\n<p>There's nothing better you can do: all arithmetic operations are carried out as (at least) <code>int</code> and the compiler reminds you of it. Depending on the values of <code>x</code> and <code>y</code>, it's quite possible the result doesn't fit in an <code>uint16_t</code>. Explicitly writing the cast documents you're aware of that and either want the truncation or assure it won't happen.</p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1530710249, "post_id": 51174633, "comment_id": 89332029, "body": "This would only make sense with 16bit <code>int</code>, and the question doesn&#39;t read like this was assumed/guaranteed. Not my DV though ..."}, {"owner": {"reputation": 545, "user_id": 9266860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef5206d6fd79c294c934bf07fd5e2ed4?s=128&d=identicon&r=PG&f=1", "display_name": "Gunther Schulz", "link": "https://stackoverflow.com/users/9266860/gunther-schulz"}, "edited": false, "score": 0, "creation_date": 1530710331, "post_id": 51174633, "comment_id": 89332085, "body": "@FelixPalmen OP said platform&#39;s int was 16 bit"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 1, "creation_date": 1530710426, "post_id": 51174633, "comment_id": 89332143, "body": "&quot;<i>would be performed correctly without warnings it this platform&#39;s int was 16-bit</i>&quot; sounds subjunctive to me. Plus good compilers typically have explicit warnings about signed/unsigned conversions."}, {"owner": {"reputation": 545, "user_id": 9266860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef5206d6fd79c294c934bf07fd5e2ed4?s=128&d=identicon&r=PG&f=1", "display_name": "Gunther Schulz", "link": "https://stackoverflow.com/users/9266860/gunther-schulz"}, "edited": false, "score": 0, "creation_date": 1530710484, "post_id": 51174633, "comment_id": 89332181, "body": "@FelixPalmen, not my first language :), had to google subjunctive"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1530710555, "post_id": 51174633, "comment_id": 89332230, "body": "You can never be sure, that&#39;s why I think your answer should explicitly state it&#39;s <b>only</b> about the special case of a 16bit platform :) (in all other cases, casting <b>is</b> required to avoid the typical warnings)"}, {"owner": {"reputation": 3792, "user_id": 1488067, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/8JllV.jpg?s=128&g=1", "display_name": "Lou", "link": "https://stackoverflow.com/users/1488067/lou"}, "edited": false, "score": 0, "creation_date": 1530710863, "post_id": 51174633, "comment_id": 89332416, "body": "Sorry for the confusion, @Felix is right, my platform is 32-bit, I was just trying to say that integer promotion happens here even if it doesn&#39;t bring any benefits. But both snippets will still cause warnings on 32-bit gcc."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 3792, "user_id": 1488067, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/8JllV.jpg?s=128&g=1", "display_name": "Lou", "link": "https://stackoverflow.com/users/1488067/lou"}, "edited": false, "score": 0, "creation_date": 1530710940, "post_id": 51174633, "comment_id": 89332476, "body": "@Lou &quot;<i>even if it doesn&#39;t bring any benefits.</i>&quot; &lt;- how can you know? 32bits are probably the &quot;natural word size&quot; of the machine, and with 32 bit registers, arithmetic operations might be fastest when carried out as 32 bits."}, {"owner": {"reputation": 545, "user_id": 9266860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef5206d6fd79c294c934bf07fd5e2ed4?s=128&d=identicon&r=PG&f=1", "display_name": "Gunther Schulz", "link": "https://stackoverflow.com/users/9266860/gunther-schulz"}, "reply_to_user": {"reputation": 3792, "user_id": 1488067, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/8JllV.jpg?s=128&g=1", "display_name": "Lou", "link": "https://stackoverflow.com/users/1488067/lou"}, "edited": false, "score": 0, "creation_date": 1530710962, "post_id": 51174633, "comment_id": 89332491, "body": "@Lou happy to help refine the question then :)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1530710988, "post_id": 51174633, "comment_id": 89332513, "body": "@GuntherSchulz the second (in your edit) won&#39;t do any good with 32bit <code>int</code>. Any arithmetic operation triggers the promotion to <code>int</code>."}, {"owner": {"reputation": 545, "user_id": 9266860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef5206d6fd79c294c934bf07fd5e2ed4?s=128&d=identicon&r=PG&f=1", "display_name": "Gunther Schulz", "link": "https://stackoverflow.com/users/9266860/gunther-schulz"}, "edited": false, "score": 0, "creation_date": 1530711033, "post_id": 51174633, "comment_id": 89332533, "body": "I meant in the 16 bit case. You got a UV from me, you absolutely right! Edited mine to remove confusion"}, {"owner": {"reputation": 3792, "user_id": 1488067, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/8JllV.jpg?s=128&g=1", "display_name": "Lou", "link": "https://stackoverflow.com/users/1488067/lou"}, "edited": false, "score": 0, "creation_date": 1530711109, "post_id": 51174633, "comment_id": 89332578, "body": "@Felix: well I am aware of the performance benefits, what I wanted to say is that (unless I am wrong) the integer-promoted version can have UB if both values are 0xFFFF due to signed integer overflow, while the 16-bit platform version would be fine."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 3792, "user_id": 1488067, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/8JllV.jpg?s=128&g=1", "display_name": "Lou", "link": "https://stackoverflow.com/users/1488067/lou"}, "edited": false, "score": 0, "creation_date": 1530711206, "post_id": 51174633, "comment_id": 89332640, "body": "@Lou when promoting, <i>unsigned</i> int is chosen if the value can&#39;t be represented as a signed int. <b>edit</b>: did you mean <code>INT_MAX</code>?"}, {"owner": {"reputation": 3792, "user_id": 1488067, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/8JllV.jpg?s=128&g=1", "display_name": "Lou", "link": "https://stackoverflow.com/users/1488067/lou"}, "edited": false, "score": 0, "creation_date": 1530711295, "post_id": 51174633, "comment_id": 89332709, "body": "It says &quot;conversion to <code>uint16_t</code> from <b><code>int</code></b> may alter its value&quot;, so I believe both values are promoted to <code>int</code> before multiplication?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1530711376, "post_id": 51174633, "comment_id": 89332752, "body": "of course, because you&#39;re on a 32bit platform. <b>Any</b> <code>uint16_t</code> value will fit in an <code>int</code>. This wouldn&#39;t be the case on 16bit platforms..."}, {"owner": {"reputation": 3792, "user_id": 1488067, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/8JllV.jpg?s=128&g=1", "display_name": "Lou", "link": "https://stackoverflow.com/users/1488067/lou"}, "edited": false, "score": 0, "creation_date": 1530711531, "post_id": 51174633, "comment_id": 89332853, "body": "I was referring to the <code>((int)0xFFFF + 1) * (int)0xFFFF</code> case, both values fit into <code>int</code>, the product is UB, and is then casted back to <code>uint16_t</code>, which on 16-bit platforms doesn&#39;t happen because everything stays <code>unsigned int</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 3792, "user_id": 1488067, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/8JllV.jpg?s=128&g=1", "display_name": "Lou", "link": "https://stackoverflow.com/users/1488067/lou"}, "edited": false, "score": 0, "creation_date": 1530711831, "post_id": 51174633, "comment_id": 89333029, "body": "@Lou ok, if you have <b>this</b> as a possible pair of values, you need more casts for &quot;safe&quot; code. I assumed you can assure that your result never overflows."}], "tags": [], "owner": {"reputation": 545, "user_id": 9266860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef5206d6fd79c294c934bf07fd5e2ed4?s=128&d=identicon&r=PG&f=1", "display_name": "Gunther Schulz", "link": "https://stackoverflow.com/users/9266860/gunther-schulz"}, "is_accepted": false, "score": 3, "last_activity_date": 1530711219, "last_edit_date": 1530711219, "creation_date": 1530710087, "answer_id": 51174633, "question_id": 51174412, "link": "https://stackoverflow.com/questions/51174412/gcc-wconversion-warning-for-16-bit-addition/51174633#51174633", "title": "GCC -Wconversion warning for 16-bit addition", "body": "<p><strong><em>Note: the following is only true in the 16-bit int case</em></strong></p>\n\n<p>warning: was about implicit conversion of <code>x</code> to <code>int</code> because <code>1</code> is of type <code>int</code>.\nLater conversion of <code>y</code> to <code>int</code> for same reason would also trigger this.</p>\n\n<p>Simply mark the <code>1</code> as unsigned</p>\n\n<pre><code>void test(uint16_t x, uint16_t y)\n{\n    uint16_t value = (x + 1u) * y;\n    ...\n}\n</code></pre>\n\n<p>No casting required.</p>\n\n<p>This will also work in <em>16 bit case</em>:</p>\n\n<pre><code>void test(uint16_t x, uint16_t y)\n{\n    uint16_t value = x * y + y;\n    ...\n}\n</code></pre>\n"}], "owner": {"reputation": 3792, "user_id": 1488067, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/8JllV.jpg?s=128&g=1", "display_name": "Lou", "link": "https://stackoverflow.com/users/1488067/lou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 131, "favorite_count": 0, "accepted_answer_id": 51174502, "answer_count": 2, "score": 0, "last_activity_date": 1530711219, "creation_date": 1530709441, "question_id": 51174412, "link": "https://stackoverflow.com/questions/51174412/gcc-wconversion-warning-for-16-bit-addition", "title": "GCC -Wconversion warning for 16-bit addition", "body": "<p>What would be the proper way to resolve warnings of this kind in the existing codebase?</p>\n\n<pre><code>void test(uint16_t x, uint16_t y)\n{\n    // warning: conversion to 'uint16_t' from 'int' may alter its value\n    uint16_t value = (x + 1) * y;\n    ...\n}\n</code></pre>\n\n<p>All three values are unsigned 16-bit integers and any arithmetical overflows would be performed correctly without warnings it this platform's <code>int</code> was 16-bit, and I don't see another way this piece of code should be written, apart from casting the result due to integer promotion.</p>\n\n<ol>\n<li>Should I cast in all such cases? Casting feels like I am doing something wrong.</li>\n<li>Disabling the warning? I would prefer not to disable the warning completely, as it might be useful in some cases.</li>\n</ol>\n"}, {"tags": ["c", "bare-metal", "stm32f4", "libtomcrypt"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 4, "creation_date": 1530709417, "post_id": 51174303, "comment_id": 89331488, "body": "Even though this description looks quite clear, I guess a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> would still help. Think about people trying to reproduce the exact problem ..."}, {"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 1, "creation_date": 1530709886, "post_id": 51174303, "comment_id": 89331779, "body": "I can tell you that at some point your code is not doing what you think it is doing. However, since you only told us what you think your code is doing, it&#39;s hard to tell where your code does not do what you think it&#39;s doing. ;-)"}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1530710031, "post_id": 51174303, "comment_id": 89331868, "body": "Are you sure the declaration of your function match with the definition of your function ?"}, {"owner": {"reputation": 3544, "user_id": 6445597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aRvT8.png?s=128&g=1", "display_name": "John Burger", "link": "https://stackoverflow.com/users/6445597/john-burger"}, "edited": false, "score": 1, "creation_date": 1530710504, "post_id": 51174303, "comment_id": 89332197, "body": "Out of curiosity: what <i>is</i> the value of <code>&amp;sha256_desc</code>? It\u2019s not <code>0x00000000</code>, is it? I mean, it <i>is</i> a <code>static const</code> variable, which may be stored in Flash, which on the STM32F4xx starts at <code>0x00000000</code>. Is it the first constant static variable you create? What does the linker\u2019s <code>.ld</code> and <code>.map</code> files show?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1530710753, "post_id": 51174303, "comment_id": 89332354, "body": "Interesting, but if an all-zero-bits pointer is valid for that platform, shouldn&#39;t the null pointer be encoded differently?"}, {"owner": {"reputation": 164, "user_id": 9378365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99f70539d19679f31a15d834c719815c?s=128&d=identicon&r=PG&f=1", "display_name": "Damien", "link": "https://stackoverflow.com/users/9378365/damien"}, "edited": false, "score": 0, "creation_date": 1530714274, "post_id": 51174303, "comment_id": 89334518, "body": "@FelixPalmen I am facing this issue in a work context so I am unfortunately not able to provide some example code. I tried to just use this failing function in a minimal code example and this time it worked (this was expected as the library has been working on other platforms)"}, {"owner": {"reputation": 164, "user_id": 9378365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99f70539d19679f31a15d834c719815c?s=128&d=identicon&r=PG&f=1", "display_name": "Damien", "link": "https://stackoverflow.com/users/9378365/damien"}, "reply_to_user": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1530714319, "post_id": 51174303, "comment_id": 89334544, "body": "@Stargateur Yes, you can find the declaration <a href=\"https://github.com/libtom/libtomcrypt/blob/develop/src/headers/tomcrypt_hash.h#L492\" rel=\"nofollow noreferrer\">here</a> and the definition <a href=\"https://github.com/libtom/libtomcrypt/blob/develop/src/misc/crypt/crypt_register_hash.c#L21\" rel=\"nofollow noreferrer\">here</a>"}, {"owner": {"reputation": 164, "user_id": 9378365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99f70539d19679f31a15d834c719815c?s=128&d=identicon&r=PG&f=1", "display_name": "Damien", "link": "https://stackoverflow.com/users/9378365/damien"}, "reply_to_user": {"reputation": 3544, "user_id": 6445597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aRvT8.png?s=128&g=1", "display_name": "John Burger", "link": "https://stackoverflow.com/users/6445597/john-burger"}, "edited": false, "score": 0, "creation_date": 1530714404, "post_id": 51174303, "comment_id": 89334596, "body": "@JohnBurger No the value is not 0x00000000. This address is the one of the isr_vector. The sha256_desc const static variable is coming from a static library that i compile externally and link to my project."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1530715126, "post_id": 51174303, "comment_id": 89335037, "body": "Smells like the external linking is somehow broken; maybe you should dive into the assembler code of the resulting binary (caller and callee) to find the rootcause of this issue."}, {"owner": {"reputation": 164, "user_id": 9378365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99f70539d19679f31a15d834c719815c?s=128&d=identicon&r=PG&f=1", "display_name": "Damien", "link": "https://stackoverflow.com/users/9378365/damien"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1530721419, "post_id": 51174303, "comment_id": 89338141, "body": "Thanks for your suggestion @Ctx, I tried to compile everything at the same time and the issue was gone !"}], "answers": [{"comments": [{"owner": {"reputation": 3544, "user_id": 6445597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aRvT8.png?s=128&g=1", "display_name": "John Burger", "link": "https://stackoverflow.com/users/6445597/john-burger"}, "edited": false, "score": 0, "creation_date": 1530757048, "post_id": 51177861, "comment_id": 89347314, "body": "The problem was (almost certainly) that the two different compiles used different compiler options, that conflicted when the linker tried to link everything together. By compiling everything together, you ensure that the same compiler options are used throughout"}, {"owner": {"reputation": 164, "user_id": 9378365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99f70539d19679f31a15d834c719815c?s=128&d=identicon&r=PG&f=1", "display_name": "Damien", "link": "https://stackoverflow.com/users/9378365/damien"}, "reply_to_user": {"reputation": 3544, "user_id": 6445597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aRvT8.png?s=128&g=1", "display_name": "John Burger", "link": "https://stackoverflow.com/users/6445597/john-burger"}, "edited": false, "score": 0, "creation_date": 1530771122, "post_id": 51177861, "comment_id": 89350559, "body": "I agree with this idea @JohnBurger but I literally used the exact same flags at some point to avoid any issue from this, except maybe the level of optimisations. Maybe I could quickly give it a look"}], "tags": [], "owner": {"reputation": 164, "user_id": 9378365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99f70539d19679f31a15d834c719815c?s=128&d=identicon&r=PG&f=1", "display_name": "Damien", "link": "https://stackoverflow.com/users/9378365/damien"}, "is_accepted": true, "score": 0, "last_activity_date": 1530721679, "creation_date": 1530721679, "answer_id": 51177861, "question_id": 51174303, "link": "https://stackoverflow.com/questions/51174303/pointer-parameter-null-when-entering-in-function-scope-but-not-at-function-call/51177861#51177861", "title": "Pointer parameter NULL when entering in function scope but not at function call", "body": "<p>Thanks to @Ctx's comment I solved the issue by compiling all the files in one place instead of compiling a static library later linked to my program.</p>\n\n<p>I don't know what was the problem and because I have new issues blocking me I won't try to investigate further.</p>\n"}], "owner": {"reputation": 164, "user_id": 9378365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99f70539d19679f31a15d834c719815c?s=128&d=identicon&r=PG&f=1", "display_name": "Damien", "link": "https://stackoverflow.com/users/9378365/damien"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 51177861, "answer_count": 1, "score": 0, "last_activity_date": 1530721679, "creation_date": 1530709153, "last_edit_date": 1530709642, "question_id": 51174303, "link": "https://stackoverflow.com/questions/51174303/pointer-parameter-null-when-entering-in-function-scope-but-not-at-function-call", "title": "Pointer parameter NULL when entering in function scope but not at function call", "body": "<p>I'm working on stm32f469 doing some bare metal code to try to use the libtomcrypt / libtomfastmath libraries. The code I'm trying to debug has been checked by valgrind and is working on many platforms like macos, raspberrypi, ios, android.</p>\n\n<p>To keep things simple, I am doing the following which is calling this function <code>int register_hash(const struct ltc_hash_descriptor *hash)</code> with a const static variable by giving it's adress : <code>register_hash(&amp;sha256_desc)</code>. The problem is, once I am inside the function, the <code>hash</code> pointer is <code>NULL</code> and I cannot figure out why.</p>\n\n<p>I was thinking It would be a stack overflow so I pre-filled the stack with the constant value <code>0xdeadbeef</code> and I checked if all these values were erased or not and the result is the stack is not overflowed.</p>\n\n<p>When debugging, I can verify the value at the address returned by <code>&amp;sha256_desc</code> and the memory is not corrupted there either.</p>\n\n<p>I am not doing dynamic allocations nor buffer filling that could be overflowing and corrupting the memory.</p>\n\n<p>I'm compiling with <code>arm-none-eabi-gcc</code>, version 7-2017-q4-major.</p>\n\n<p>I am mainly looking for some possible sources of issue as I am running out of ideas.</p>\n"}, {"tags": ["c", "switch-statement"], "comments": [{"owner": {"reputation": 6899, "user_id": 1212012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gmBY7.png?s=128&g=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1212012/mathieu"}, "edited": false, "score": 0, "creation_date": 1530708736, "post_id": 51174095, "comment_id": 89331053, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/8281054/scanf-causes-c-program-to-crash\">Scanf causes c program to crash</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 3, "creation_date": 1530708751, "post_id": 51174095, "comment_id": 89331070, "body": "<code>return 7</code>? Just for fun? Try 42 ... :o"}, {"owner": {"reputation": 6899, "user_id": 1212012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gmBY7.png?s=128&g=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1212012/mathieu"}, "edited": false, "score": 0, "creation_date": 1530708812, "post_id": 51174095, "comment_id": 89331102, "body": "<code>scanf(&quot;%d&quot;, num1);</code> --&gt; <code>scanf(&quot;%d&quot;, &amp;num1);</code> in many places...."}, {"owner": {"reputation": 19358, "user_id": 3049655, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ZLzeP.jpg?s=128&g=1", "display_name": "Spikatrix", "link": "https://stackoverflow.com/users/3049655/spikatrix"}, "edited": false, "score": 0, "creation_date": 1530708874, "post_id": 51174095, "comment_id": 89331141, "body": "Also <code>return 20;</code> in <code>Calulator</code>? :o"}, {"owner": {"reputation": 6899, "user_id": 1212012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gmBY7.png?s=128&g=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1212012/mathieu"}, "edited": false, "score": 1, "creation_date": 1530709085, "post_id": 51174095, "comment_id": 89331277, "body": "Some reading: <a href=\"http://sekrit.de/webdocs/c/beginners-guide-away-from-scanf.html\" rel=\"nofollow noreferrer\">sekrit.de/webdocs/c/beginners-guide-away-from-scanf.html</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 6899, "user_id": 1212012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gmBY7.png?s=128&g=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1212012/mathieu"}, "edited": false, "score": 0, "creation_date": 1530709481, "post_id": 51174095, "comment_id": 89331530, "body": "@purplepsycho thanks for referencing my doc ;) Unfortunately, it doesn&#39;t really cover this <b>very</b> basic stuff (like having to pass a pointer) ..."}, {"owner": {"reputation": 13, "user_id": 10032086, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HwW0F.png?s=128&g=1", "display_name": "William", "link": "https://stackoverflow.com/users/10032086/william"}, "edited": false, "score": 0, "creation_date": 1530778877, "post_id": 51174095, "comment_id": 89354896, "body": "Thanks everyone. I just missed the &quot;&amp;&quot; sign. Its working smoothly now"}], "answers": [{"tags": [], "owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "is_accepted": true, "score": 2, "last_activity_date": 1530709225, "last_edit_date": 1530709225, "creation_date": 1530708723, "answer_id": 51174168, "question_id": 51174095, "link": "https://stackoverflow.com/questions/51174095/my-program-crashed-and-stopped-working-after-reaching-scanf-statement-in-c/51174168#51174168", "title": "My program crashed and stopped working after reaching scanf() statement in C", "body": "<p>Your <code>scanf</code> calls inside the <code>switch</code> are wrong. You need <code>&amp;</code>.</p>\n\n<p><strong>Change</strong>:</p>\n\n<pre><code>scanf(\"%d\", num1);\nscanf(\"%d\", num2);\n</code></pre>\n\n<p><strong>to</strong>:</p>\n\n<pre><code>scanf(\"%d\", &amp;num1);\nscanf(\"%d\", &amp;num2);\n</code></pre>\n\n<p>I suggest you to check the return of <code>scanf</code>.</p>\n\n<p>Try to understand this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint Calculator( void );\n\nint main( void )\n{\n    Calculator();\n}\n\nint Calculator( void )\n{\n    int num1;\n    int num2;\n    int operation;\n\n    printf(\"Hello. I am a calculator.\\nChoose any operation you want to carry out- \\n 1.Addition \\n 2.Subtraction \\n 3.Multiplication \\n 4.Division \\n\");\n    if ( scanf(\"%d\", &amp;operation) != 1 ){\n        printf( \"Error scanf() ==&gt;&gt; on Operation\" );\n        exit( 1 );\n    }\n\n    switch (operation)\n    {\n        case 1:\n            printf(\"OK. You have chosen addition. \\nEnter any 2 numbers to be added \\n\");\n            if ( scanf(\"%d\", &amp;num1) != 1 ){\n                printf( \"Error scanf() ==&gt;&gt; switch - case 1 ==&gt;&gt; 1\" );\n                exit( 1 );\n            }\n            if ( scanf(\"%d\", &amp;num2) != 1 ){\n                printf( \"Error scanf() ==&gt;&gt; switch - case 1 ==&gt;&gt; 2\" );\n                exit( 1 );\n            }\n            printf(\"%d + %d is = %d. \\n Thank you. \", num1, num2, num1 + num2);\n            break;\n\n        case 2:\n            printf(\"OK. You have chosen subtraction. \\nEnter any 2 numbers to be subtracted \\n\");\n            if ( scanf(\"%d\", &amp;num1) != 1 ){\n                printf( \"Error scanf() ==&gt;&gt; switch - case 2 ==&gt;&gt; 1\" );\n                exit( 1 );\n            }\n            if ( scanf(\"%d\", &amp;num2) != 1 ){\n                printf( \"Error scanf() ==&gt;&gt; switch - case 2 ==&gt;&gt; 2\" );\n                exit( 1 );\n            }\n            printf(\"%d - %d is = %d. \\n Thank you. \", num1, num2, num1 - num2);\n            break;\n\n        case 3:\n            printf(\"OK. You have chosen multiplication. \\nEnter any 2 numbers to be multiplied \\n\");\n            if ( scanf(\"%d\", &amp;num1) != 1 ){\n                printf( \"Error scanf() ==&gt;&gt; switch - case 3 ==&gt;&gt; 1\" );\n                exit( 1 );\n            }\n            if ( scanf(\"%d\", &amp;num2) != 1 ){\n                printf( \"Error scanf() ==&gt;&gt; switch - case 3 ==&gt;&gt; 2\" );\n                exit( 1 );\n            }\n            printf(\"%d x %d is = %d. \\n Thank you. \", num1, num2, num1 * num2);\n            break;\n\n        case 4:\n            printf(\"OK. You have chosen division. \\nEnter any 2 numbers to be divided \\n\");\n            if ( scanf(\"%d\", &amp;num1) != 1 ){\n                printf( \"Error scanf() ==&gt;&gt; switch - case 4 ==&gt;&gt; 1\" );\n                exit( 1 );\n            }\n            if ( scanf(\"%d\", &amp;num2) != 1 ){\n                printf( \"Error scanf() ==&gt;&gt; switch - case 4 ==&gt;&gt; 2\" );\n                exit( 1 );\n            }\n            printf(\"%d \u00f7 %d is = %d. \\n Thank you. \", num1, num2, num1 / num2);\n            break;\n\n        default:\n            printf(\"\\nHUH?\\n\\n\");\n            break;\n    }\n    return 20;\n}\n</code></pre>\n\n<p>You should reconsider your <code>return</code> statements from <code>main</code> and <code>Calculator</code></p>\n"}, {"tags": [], "owner": {"reputation": 545, "user_id": 9266860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef5206d6fd79c294c934bf07fd5e2ed4?s=128&d=identicon&r=PG&f=1", "display_name": "Gunther Schulz", "link": "https://stackoverflow.com/users/9266860/gunther-schulz"}, "is_accepted": false, "score": 2, "last_activity_date": 1530708749, "creation_date": 1530708749, "answer_id": 51174181, "question_id": 51174095, "link": "https://stackoverflow.com/questions/51174095/my-program-crashed-and-stopped-working-after-reaching-scanf-statement-in-c/51174181#51174181", "title": "My program crashed and stopped working after reaching scanf() statement in C", "body": "<p>You want to</p>\n\n<pre><code>scanf(\"%d\", &amp;num1);\nscanf(\"%d\", &amp;num2);\n</code></pre>\n\n<p>at each instance.</p>\n\n<p>Also, if you want to prevent other crashes, watch out for division by zero :)</p>\n"}], "owner": {"reputation": 13, "user_id": 10032086, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HwW0F.png?s=128&g=1", "display_name": "William", "link": "https://stackoverflow.com/users/10032086/william"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 51174168, "answer_count": 2, "score": -3, "last_activity_date": 1530709225, "creation_date": 1530708488, "last_edit_date": 1530708720, "question_id": 51174095, "link": "https://stackoverflow.com/questions/51174095/my-program-crashed-and-stopped-working-after-reaching-scanf-statement-in-c", "title": "My program crashed and stopped working after reaching scanf() statement in C", "body": "<p>I was just building a simple calculator in C using CodeBlocks. After building and running it it went smoothly till the scanf() statement. After i put in 2 numbers for my program to scan and hit enter the program crashed and sent a message \"C.exe has stopped working.\"Please help. Here is the code -</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint Calculator();\n\nint main()\n{\n    Calculator();\n    return 7;\n}\n\nint Calculator()\n{\n    int num1;\n    int num2;\n    int operation;\n\n    printf(\"Hello. I am a calculator.\\nChoose any operation you want to carry out- \\n 1.Addition \\n 2.Subtraction \\n 3.Multiplication \\n 4.Division \\n\");\n    scanf(\"%d\", &amp;operation);\n\n    switch (operation)\n    {\n        case 1:\n            printf(\"OK. You have chosen addition. \\nEnter any 2 numbers to be added \\n\");\n            scanf(\"%d\", num1);\n            scanf(\"%d\", num2);\n            printf(\"%d + %d is = %d. \\n Thank you. \", num1, num2, num1 + num2);\n            break;\n\n        case 2:\n            printf(\"OK. You have chosen subtraction. \\nEnter any 2 numbers to be subtracted \\n\");\n            scanf(\"%d\", num1);\n            scanf(\"%d\", num2);\n            printf(\"%d - %d is = %d. \\n Thank you. \", num1, num2, num1 - num2);\n            break;\n\n        case 3:\n            printf(\"OK. You have chosen multiplication. \\nEnter any 2 numbers to be multiplied \\n\");\n            scanf(\"%d\", num1);\n            scanf(\"%d\", num2);\n            printf(\"%d x %d is = %d. \\n Thank you. \", num1, num2, num1 * num2);\n            break;\n\n        case 4:\n            printf(\"OK. You have chosen division. \\nEnter any 2 numbers to be divided \\n\");\n            scanf(\"%d\", num1);\n            scanf(\"%d\", num2);\n            printf(\"%d \u00f7 %d is = %d. \\n Thank you. \", num1, num2, num1 / num2);\n            break;\n\n        default:\n            printf(\"\\nHUH?\\n\\n\");\n            break;\n    }\n    return 20;\n}\n</code></pre>\n"}, {"tags": ["c", "sizeof"], "comments": [{"owner": {"reputation": 19358, "user_id": 3049655, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ZLzeP.jpg?s=128&g=1", "display_name": "Spikatrix", "link": "https://stackoverflow.com/users/3049655/spikatrix"}, "edited": false, "score": 6, "creation_date": 1530708230, "post_id": 51173976, "comment_id": 89330734, "body": "You should be using <code>%zu</code> as <code>sizeof</code> returns <code>size_t</code> not <code>int</code>"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 24, "creation_date": 1530708333, "post_id": 51173976, "comment_id": 89330800, "body": "You need to tag this either C or C++, because this code will give very different answers depending on language. Basically C++ recognized that C was being stupid and fixed various obvious language flaws, while C refuses to admits that it is stupid."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 1, "creation_date": 1530708479, "post_id": 51173976, "comment_id": 89330897, "body": "@Sam Varshavchik Not necessarily a dupe because the first two rows will give 1 vs 4 in C, but 1 vs 1 in C++. The 3rd row will indeed mess around with implicit promotion in C++, but not in C."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 7, "creation_date": 1530708748, "post_id": 51173976, "comment_id": 89331064, "body": "Odd interpretation of the word &quot;duplicate&quot; here. I&#39;ve reopened. Disk is cheap. Search engines are powerful. Let&#39;s only close as duplicates if it&#39;s a duplicate."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1530708981, "post_id": 51173976, "comment_id": 89331212, "body": "in that case, maybe the <i>question</i> needs upvoting."}, {"owner": {"reputation": 2287, "user_id": 5267751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd62e8fd8fbb37abc7e2a39d23828047?s=128&d=identicon&r=PG&f=1", "display_name": "user202729", "link": "https://stackoverflow.com/users/5267751/user202729"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 9, "creation_date": 1530718525, "post_id": 51173976, "comment_id": 89336819, "body": "@Bathsheba &quot;Disk is cheap&quot; is a non-reason..."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 2287, "user_id": 5267751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd62e8fd8fbb37abc7e2a39d23828047?s=128&d=identicon&r=PG&f=1", "display_name": "user202729", "link": "https://stackoverflow.com/users/5267751/user202729"}, "edited": false, "score": 0, "creation_date": 1530718586, "post_id": 51173976, "comment_id": 89336850, "body": "@user202729: In your opinion, with respect. When researching, it&#39;s always good to have a selection of sources. This quixotic closing to broad so-called duplicates is the thing that makes no sense."}, {"owner": {"reputation": 2287, "user_id": 5267751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd62e8fd8fbb37abc7e2a39d23828047?s=128&d=identicon&r=PG&f=1", "display_name": "user202729", "link": "https://stackoverflow.com/users/5267751/user202729"}, "edited": false, "score": 0, "creation_date": 1530719051, "post_id": 51173976, "comment_id": 89337078, "body": "I can find 3 partial duplicate targets, each answer a part of the question. I am flagging to close as <b>too broad</b>."}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "reply_to_user": {"reputation": 2287, "user_id": 5267751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd62e8fd8fbb37abc7e2a39d23828047?s=128&d=identicon&r=PG&f=1", "display_name": "user202729", "link": "https://stackoverflow.com/users/5267751/user202729"}, "edited": false, "score": 6, "creation_date": 1530745803, "post_id": 51173976, "comment_id": 89345569, "body": "@user202729 It\u2019s not too broad. It asks a very specific, real-world question about software engineering. And it does not appear to have an exact duplicate."}, {"owner": {"reputation": 2287, "user_id": 5267751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd62e8fd8fbb37abc7e2a39d23828047?s=128&d=identicon&r=PG&f=1", "display_name": "user202729", "link": "https://stackoverflow.com/users/5267751/user202729"}, "reply_to_user": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "edited": false, "score": 0, "creation_date": 1530761451, "post_id": 51173976, "comment_id": 89348023, "body": "@Davislor If it can be splitted into 3 different questions (each of which is on-topic for <a href=\"https://stackoverflow.com\">Stack Overflow</a>), it&#39;s too broad."}, {"owner": {"reputation": 2287, "user_id": 5267751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd62e8fd8fbb37abc7e2a39d23828047?s=128&d=identicon&r=PG&f=1", "display_name": "user202729", "link": "https://stackoverflow.com/users/5267751/user202729"}, "edited": false, "score": 0, "creation_date": 1530774810, "post_id": 51173976, "comment_id": 89352486, "body": "Also, it doesn&#39;t have an exact duplicate precisely because it&#39;s too broad, in this case."}, {"owner": {"reputation": 1368, "user_id": 2333290, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oeSaj.jpg?s=128&g=1", "display_name": "kotlomoy", "link": "https://stackoverflow.com/users/2333290/kotlomoy"}, "edited": false, "score": 0, "creation_date": 1531043044, "post_id": 51173976, "comment_id": 89440712, "body": "I don&#39;t get why is this duplicate. The answer to this question is &quot;Because C characters literals are ints&quot;. &quot;Why are C characters literals ints&quot; is different question which I can not ask before I know that C characters literals are ints. Right? The seconds question implies that you already know the answer to the first question. But you don&#39;t."}, {"owner": {"reputation": 703, "user_id": 9999814, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D0vR5.jpg?s=128&g=1", "display_name": "AmanSharma", "link": "https://stackoverflow.com/users/9999814/amansharma"}, "reply_to_user": {"reputation": 1368, "user_id": 2333290, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oeSaj.jpg?s=128&g=1", "display_name": "kotlomoy", "link": "https://stackoverflow.com/users/2333290/kotlomoy"}, "edited": false, "score": 0, "creation_date": 1531190874, "post_id": 51173976, "comment_id": 89491920, "body": "@kotlomoy I searched a lot before asking this question .I aint sure what two users felt before marking this as duplicate."}], "answers": [{"comments": [{"owner": {"reputation": 5668, "user_id": 4083309, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6b4ef5a2e912153069b82607789a717?s=128&d=identicon&r=PG&f=1", "display_name": "Arne Vogel", "link": "https://stackoverflow.com/users/4083309/arne-vogel"}, "edited": false, "score": 2, "creation_date": 1530713188, "post_id": 51173999, "comment_id": 89333888, "body": "Great answer but for the very minor issue of not being explicit about <code>&#39;a&#39;+&#39;b&#39;+&#39;C&#39;</code> being an example of <i>integral promotion</i>, not <i>integral conversion</i>, in standard terms. (Both are <i>conversions</i> though, because this is also used as an umbrella term. The naming is\u2026 interesting.)"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 5668, "user_id": 4083309, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6b4ef5a2e912153069b82607789a717?s=128&d=identicon&r=PG&f=1", "display_name": "Arne Vogel", "link": "https://stackoverflow.com/users/4083309/arne-vogel"}, "edited": false, "score": 1, "creation_date": 1530713229, "post_id": 51173999, "comment_id": 89333909, "body": "@ArneVogel: Thank you, if I had a dollar every time I say or write that incorrectly..."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1530735038, "post_id": 51173999, "comment_id": 89342903, "body": "@chux Thanks, I\u2019ve fixed but I think I\u2019ll leave all the C++ stuff up - the joys of a moving question!"}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 23, "last_activity_date": 1530735004, "last_edit_date": 1530735004, "creation_date": 1530708191, "answer_id": 51173999, "question_id": 51173976, "link": "https://stackoverflow.com/questions/51173976/confusing-behavior-of-sizeof-with-chars/51173999#51173999", "title": "Confusing behavior of sizeof with chars", "body": "<p>In C, <code>'a'</code> is <em>constant</em> of type <code>int</code>. It is <strong>not</strong> a <code>char</code>. So <code>sizeof('a')</code> will be the same as <code>sizeof(int)</code>.</p>\n\n<p><code>sizeof(ch)</code> is the same as <code>sizeof(char)</code>. (The C standard guarantees that all alphanumeric constants - and some others - of the form <code>'a'</code> can fit into a <code>char</code>, so <code>char ch='a';</code> is always well-defined.)</p>\n\n<p>Note that in C++, <code>'a'</code> is a <em>literal</em> of type <code>char</code>; yet another difference between C and C++.</p>\n\n<p>In C, <code>sizeof(\"a\")</code> is <code>sizeof(char[2])</code> which is 2. <code>sizeof</code> does not instigate  the <em>decay</em> of an array type to a pointer.</p>\n\n<p>In C++, <code>sizeof(\"a\")</code> is <code>sizeof(const char[2])</code> which is 2. <code>sizeof</code> does not instigate the  <em>decay</em> of an array type to a pointer.</p>\n\n<p>In both languages, <code>'a'+'b'+'C'</code> is an <code>int</code> type due, in C++, to implicit promotion of integral types.</p>\n"}, {"comments": [{"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1530727488, "post_id": 51174007, "comment_id": 89340496, "body": "I wonder in what problems, if any, would have resulted from making <code>sizeof</code> operate only on lvalues?  Especially on systems that use FLT_EVAL_METHOD==2 and have a <code>long double</code> type which is bigger than <code>double</code>, it would seem a bit weird to suggest that <code>sizeof (1.0&#47;10.0)</code> should report 8 even if <code>long double d = (1.0&#47;10.0);</code> would store a value that cannot be represented in an 8-byte &quot;double&quot;."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1530734638, "post_id": 51174007, "comment_id": 89342783, "body": "Suggest &quot;character constant has type integer&quot; --&gt; &quot;character constant has type <code>int</code>&quot;."}, {"owner": {"reputation": 2649, "user_id": 4022617, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/nk22l.png?s=128&g=1", "display_name": "dgnuff", "link": "https://stackoverflow.com/users/4022617/dgnuff"}, "reply_to_user": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 1, "creation_date": 1530763268, "post_id": 51174007, "comment_id": 89348336, "body": "@supercat Among other things it would probably have made the following construct illegal: <code>sizeof(type)</code>."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 2649, "user_id": 4022617, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/nk22l.png?s=128&g=1", "display_name": "dgnuff", "link": "https://stackoverflow.com/users/4022617/dgnuff"}, "edited": false, "score": 0, "creation_date": 1530773991, "post_id": 51174007, "comment_id": 89352013, "body": "@dgnuff: Mea culpa.  What I meant was excluding the operator on values that aren&#39;t lvalues."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1530798822, "post_id": 51174007, "comment_id": 89367665, "body": "@supercat, relatively few problems, I suspect.  A bit of cognitive dissonance, for one: it is nicely consistent that <code>sizeof</code> works on <i>all</i> expressions.  As for practical programming issues, the one I see is the case where you want the size of a string literal, and especially where that literal is conveyed via a macro, so that its size may be changed at some location distant from its use -- maybe even on the compiler command line."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1530801515, "post_id": 51174007, "comment_id": 89369543, "body": "@JohnBollinger: From what I can tell, what makes sizeof is useful with string literals is that they are <code>char[] const</code> lvalues (which would be allowed if sizeof were restricted to lvalues) rather than <code>char const*</code> values.  As for having it work on &quot;all&quot; expressions, the <code>&amp;</code> operator doesn&#39;t, so why should <code>sizeof</code> be special in that regard?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1530802539, "post_id": 51174007, "comment_id": 89370332, "body": "You&#39;re right, @supercat, a string literal is an lvalue, so that&#39;s not a problem.  As for working with all expressions, however, I submit that many C operators work with any operand of suitable type.  Among the unary operators, for example, there are <code>-</code>, <code>!</code>, and <code>~</code>, and even the function-call operator, <code>()</code>.  C requires operands to be lvalues only where it needs to refer to <i>storage</i>, which, of course, is what distinguishes lvalues from non-lvalue expressions.  All expressions have sizes as determined by their types, whether or not they have any associated storage."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1530809015, "post_id": 51174007, "comment_id": 89374290, "body": "@JohnBollinger: Within a function like <code>void foo(someArrayType arr);</code> the expression <code>arr</code> is clearly a value, but attempting to use <code>sizeof</code> on that type is unlikely to yield an intended result.  IMHO, a clean way of preventing such nonsense would be to say that within such a function, the expression <code>arr</code> would not be an lvalue, but would instead yield a value of pointer-to-member type, but only if <code>sizeof</code> required an lvalue."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1530813357, "post_id": 51174007, "comment_id": 89376417, "body": "@supercat, I take your point, but I observe that C says that there are no functions with parameters of array type, because declarations that have a form that would declare other identifiers as arrays declare function parameters as pointers, instead.  I think I understand why that decision was made, but I&#39;d say that the nonsense in this area is in allowing such a deceptive form of declaration in the first place, not in handling the resulting parameters according to the type with which they are (actually) declared."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1530815077, "post_id": 51174007, "comment_id": 89377194, "body": "@JohnBollinger: If a function&#39;s parameters is <i>declared</i> as being an array type, it may not be necessary to have the parameter &quot;pre-decomposed&quot; into a pointer, rather than having it be an array lvalue which gets converted into a pointer value in many contexts, but treating it as an lvalue of pointer type was an &quot;unforced error&quot;."}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 52, "last_activity_date": 1530768615, "last_edit_date": 1530768615, "creation_date": 1530708208, "answer_id": 51174007, "question_id": 51173976, "link": "https://stackoverflow.com/questions/51173976/confusing-behavior-of-sizeof-with-chars/51174007#51174007", "title": "Confusing behavior of sizeof with chars", "body": "<p><strong>TL;DR</strong> - <code>sizeof</code> works on the <em>type</em> of the operand.</p>\n\n<ul>\n<li><code>sizeof(ch)</code> == <code>sizeof (char)</code>-------------------(1)</li>\n<li><code>sizeof('a')</code> == <code>sizeof(int)</code> --------------------(2)</li>\n<li><code>sizeof ('a'+ 'b' + 'c')</code> == <code>sizeof(int)</code> ---(3)</li>\n<li><code>sizeof (\"a\")</code> == <code>sizeof (char [2])</code> ----------(4)</li>\n</ul>\n\n<p>Let's see each case now.</p>\n\n<ol>\n<li><p><code>ch</code> is defined to be of <code>char</code> type, so , pretty straightforward. </p></li>\n<li><p>In C, <code>sizeof('a')</code> is the same as <code>sizeof (int)</code>, as a character constant has type integer.</p>\n\n<p>Quoting <code>C11</code>,</p>\n\n<blockquote>\n  <p>An integer character constant has type <code>int</code>. [...]</p>\n</blockquote>\n\n<p>In C++, a character <em>literal</em> has type <code>char</code>.</p></li>\n<li><p><code>sizeof</code> is a compile-time operator (except when the operand is a VLA), so the type of the expression is used. As earlier , all the integer character constants are of type <code>int</code>, so <code>int</code> + <code>int</code> + <code>int</code> produces <code>int</code>. So the type of the operand is taken as <code>int</code>.</p></li>\n<li><p><code>\"a\"</code> is an array of two <code>char</code>s, <code>'a'</code> and <code>0</code> (null-terminator) (<em>no, it does not decay to pointer to the first element of the array type</em>), hence the size is the same as of an array with two <code>char</code> elements.</p></li>\n</ol>\n\n<hr>\n\n<p>That said, finally, <code>sizeof</code> produces a result of type <code>size_t</code>, so you must use <code>%zu</code> format specifier to print the result.</p>\n"}, {"comments": [{"owner": {"reputation": 19358, "user_id": 3049655, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ZLzeP.jpg?s=128&g=1", "display_name": "Spikatrix", "link": "https://stackoverflow.com/users/3049655/spikatrix"}, "edited": false, "score": 6, "creation_date": 1530708994, "post_id": 51174210, "comment_id": 89331222, "body": "&quot;<i>int has a size of 4</i>&quot; Usually, yes. But not always."}, {"owner": {"reputation": 600, "user_id": 5725780, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FKaUq.png?s=128&g=1", "display_name": "pipe", "link": "https://stackoverflow.com/users/5725780/pipe"}, "edited": false, "score": 1, "creation_date": 1530734127, "post_id": 51174210, "comment_id": 89342612, "body": "I have a platform where <code>sizeof(int)==1</code>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 600, "user_id": 5725780, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FKaUq.png?s=128&g=1", "display_name": "pipe", "link": "https://stackoverflow.com/users/5725780/pipe"}, "edited": false, "score": 1, "creation_date": 1530735267, "post_id": 51174210, "comment_id": 89342988, "body": "@pipe What platform/compiler is that with <code>sizeof(int)==1</code>?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1530743985, "post_id": 51174210, "comment_id": 89345273, "body": "@chux: I believe Cray XMP used <code>CHAR_BIT == 32</code> so <code>sizeof(int) == 1</code>.  Most people don&#39;t have one of those kicking around any more \u2014 or the power or water supply necessary to keep it happy."}, {"owner": {"reputation": 600, "user_id": 5725780, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FKaUq.png?s=128&g=1", "display_name": "pipe", "link": "https://stackoverflow.com/users/5725780/pipe"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1530773220, "post_id": 51174210, "comment_id": 89351569, "body": "@chux A custom core in a small embedded chip where <code>CHAR_BIT==16</code> and an int is 16 bits."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1530816809, "post_id": 51174210, "comment_id": 89377976, "body": "@chux: I&#39;ve written code for a DSP where a <code>char</code> is a 16-bit signed integer type, and <code>int</code> is likewise.  The only way the hardware could support changing an octet in memory would be to do a 16-bit load, change 8 bits of the loaded value, and then do a 16-bit store.  It may have been possible for a compiler to generate code to process character-type writes with a read-modify-write sequence, but that would have made code that operates on a sequence of character-type values <i>really</i> slow."}], "tags": [], "owner": {"reputation": 91, "user_id": 9954565, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gptsY.jpg?s=128&g=1", "display_name": "Wolf", "link": "https://stackoverflow.com/users/9954565/wolf"}, "is_accepted": false, "score": 0, "last_activity_date": 1530709454, "last_edit_date": 1530709454, "creation_date": 1530708835, "answer_id": 51174210, "question_id": 51173976, "link": "https://stackoverflow.com/questions/51173976/confusing-behavior-of-sizeof-with-chars/51174210#51174210", "title": "Confusing behavior of sizeof with chars", "body": "<p>I'm assuming the code was compiled in C.<br>\nIn C, <code>'a'</code> is treated as an <code>int</code> type and <code>int</code> has a size of 4.\nIn C++, <code>'a'</code> is treated as a <code>char</code> type, and if you try compiling your code in cpp.sh, it should return 1.</p>\n"}, {"comments": [{"owner": {"reputation": 4035, "user_id": 478891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df15c8847129ee12937d3e62b84a3a4f?s=128&d=identicon&r=PG", "display_name": "Eric Towers", "link": "https://stackoverflow.com/users/478891/eric-towers"}, "edited": false, "score": 0, "creation_date": 1530731288, "post_id": 51174614, "comment_id": 89341825, "body": "My copies of the C89 and C99 standard define <code>sizeof</code> to return counts of &quot;storage units&quot;, not &quot;bytes&quot;, whatever those are."}, {"owner": {"reputation": 600, "user_id": 5725780, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FKaUq.png?s=128&g=1", "display_name": "pipe", "link": "https://stackoverflow.com/users/5725780/pipe"}, "reply_to_user": {"reputation": 4035, "user_id": 478891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df15c8847129ee12937d3e62b84a3a4f?s=128&d=identicon&r=PG", "display_name": "Eric Towers", "link": "https://stackoverflow.com/users/478891/eric-towers"}, "edited": false, "score": 0, "creation_date": 1530734066, "post_id": 51174614, "comment_id": 89342594, "body": "@EricTowers &quot;byte&quot; is today typically only used for 8 bits, but <code>sizeof</code> returns the number of <code>char</code>s - and a C <code>char</code> can be larger than 8 bits (it&#39;s 16 bits on a CPU I&#39;m working with, for example)."}, {"owner": {"reputation": 4035, "user_id": 478891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df15c8847129ee12937d3e62b84a3a4f?s=128&d=identicon&r=PG", "display_name": "Eric Towers", "link": "https://stackoverflow.com/users/478891/eric-towers"}, "reply_to_user": {"reputation": 600, "user_id": 5725780, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FKaUq.png?s=128&g=1", "display_name": "pipe", "link": "https://stackoverflow.com/users/5725780/pipe"}, "edited": false, "score": 0, "creation_date": 1530734218, "post_id": 51174614, "comment_id": 89342647, "body": "@pipe : And a byte has been 9-bits on architectures I&#39;ve worked on.  My point is that, since the standard does not define or use &quot;byte&quot;s it is incorrect to have &quot;is per definition guaranteed to be 1 byte&quot;."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1530735139, "post_id": 51174614, "comment_id": 89342931, "body": "Detail: C standard does not have <i>character literals</i>.  It does have <i>character constants</i> which are type <code>int</code>.  C&#39;s 2 literals: <i>string</i> and <i>compound</i> can have their address taken, unlike constants."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 4035, "user_id": 478891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df15c8847129ee12937d3e62b84a3a4f?s=128&d=identicon&r=PG", "display_name": "Eric Towers", "link": "https://stackoverflow.com/users/478891/eric-towers"}, "edited": false, "score": 0, "creation_date": 1530771316, "post_id": 51174614, "comment_id": 89350656, "body": "@EricTowers C11/C99 6.5.3.4/2 or C90 6.3.3.4 &quot;The sizeof operator yields the size (in bytes) of its operand&quot;. Maybe cite the standard next time before making up such statements."}, {"owner": {"reputation": 4035, "user_id": 478891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df15c8847129ee12937d3e62b84a3a4f?s=128&d=identicon&r=PG", "display_name": "Eric Towers", "link": "https://stackoverflow.com/users/478891/eric-towers"}, "edited": false, "score": 0, "creation_date": 1530774088, "post_id": 51174614, "comment_id": 89352078, "body": "ISO/IEC 9899:1990 3.6.  Summarizing: &quot;bytes&quot; != bytes.  For more on this discrepancy, see <a href=\"https://www.misra.org.uk/forum/viewtopic.php?t=973\" rel=\"nofollow noreferrer\">misra.org.uk/forum/viewtopic.php?t=973</a>"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 4035, "user_id": 478891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df15c8847129ee12937d3e62b84a3a4f?s=128&d=identicon&r=PG", "display_name": "Eric Towers", "link": "https://stackoverflow.com/users/478891/eric-towers"}, "edited": false, "score": 0, "creation_date": 1530774624, "post_id": 51174614, "comment_id": 89352378, "body": "@EricTowers Yes I am well-aware that the standard allows a byte to be something else than 8 bits. Nothing in this answer contradicts that. As proven by quoting normative text in the 3 latest C standards, the sizeof operator returns the size in bytes. I have only ever spoken about bytes."}, {"owner": {"reputation": 4035, "user_id": 478891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df15c8847129ee12937d3e62b84a3a4f?s=128&d=identicon&r=PG", "display_name": "Eric Towers", "link": "https://stackoverflow.com/users/478891/eric-towers"}, "edited": false, "score": 0, "creation_date": 1530775556, "post_id": 51174614, "comment_id": 89352944, "body": "@Lundin : You have not spoken about bytes.  You have spoken about &quot;bytes&quot;.  And as cited, using Standard meanings of plain language words in semantically conflatable settings is misleading."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 4035, "user_id": 478891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df15c8847129ee12937d3e62b84a3a4f?s=128&d=identicon&r=PG", "display_name": "Eric Towers", "link": "https://stackoverflow.com/users/478891/eric-towers"}, "edited": false, "score": 0, "creation_date": 1530776804, "post_id": 51174614, "comment_id": 89353676, "body": "@EricTowers What it boils down to is that anyone designing C programs for compatibility with wildly exotic DSP:s are wasting their time almost as much as people writing pedantic comments on internet sites along the lines of: &quot;but a byte might be 57 bits!&quot;, &quot;but an int might have padding bits and there will be trap representations!&quot;, &quot;but this system might be a 33 bit CPU signed magnitude computer!&quot; etc. Sure the standard allows it, but wasting energy caring about it is a huge waste of everyone&#39;s time. Focus on portability to mainstream computers."}, {"owner": {"reputation": 4035, "user_id": 478891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df15c8847129ee12937d3e62b84a3a4f?s=128&d=identicon&r=PG", "display_name": "Eric Towers", "link": "https://stackoverflow.com/users/478891/eric-towers"}, "edited": false, "score": 0, "creation_date": 1530804693, "post_id": 51174614, "comment_id": 89371830, "body": "What it boils down to is anyone reading the term &quot;bytes&quot; in your Answer without comment that the Standard doesn&#39;t mean bytes will think you mean bytes.  While you say <i>you</i> are aware of this defect of the Standard, you are apparently unaware of the widespread confusion on the issue.  It&#39;s related to your undocumented claim &quot;Then when Dennis Ritchie started to cook together some manner of de facto standard for C, he apparently decided that character literals should always be promoted to int.&quot;, which is in direct contrast with the documented reason : the PDP-11 had no 8-bit GP register."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1530809417, "post_id": 51174614, "comment_id": 89374506, "body": "@Lundin: Unfortunately, the authors of the C Standard seem opposed to the idea of recognizing mainstream compilers and platforms, and would rather saddle the 99% of programs that nobody would ever have any interest in running on anything other than octet-based linear-address architectures with two&#39;s-complement silent-wraparound integer semantics, with the limitations of quirky architectures which in some cases might not even exist [e.g. those where left-shifting a negative number would do anything other than multiply be a power of two in cases where such a multiply would not overflow]."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1530816992, "post_id": 51174614, "comment_id": 89378054, "body": "When C was first designed, there were only three kinds of <i>values</i>: pointers, integers, and double-precision floating-point.  Evaluating an object would promote its value to the largest type of the appropriate kind.  The type of a character literal value had to be <code>int</code> because there was no such thing as a <i>value</i> of <code>char</code> type."}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 9, "last_activity_date": 1530710022, "creation_date": 1530710022, "answer_id": 51174614, "question_id": 51173976, "link": "https://stackoverflow.com/questions/51173976/confusing-behavior-of-sizeof-with-chars/51174614#51174614", "title": "Confusing behavior of sizeof with chars", "body": "<p>First of all, the result of <code>sizeof</code> is type <code>size_t</code>, which should be printed with the <code>%zu</code> format specifier. Ignoring that part and assuming <code>int</code> is 4 bytes, then</p>\n\n<ul>\n<li><p><code>printf(\"sizeof(ch) %d\\n\",sizeof(ch));</code> will print 1 in C and 1 in C++. </p>\n\n<p>This is because a <code>char</code> is per definition guaranteed to be 1 byte in both languages.</p></li>\n<li><p><code>printf(\"sizeof('a')  %d\\n\",sizeof('a'));</code> will print 4 in C and 1 in C++. </p>\n\n<p>This is because character literals are of type <code>int</code> in C, for historical reasons<sup>1)</sup>, but they are of type <code>char</code> in C++, because that's what common sense (and ISO 14882) dictates.</p></li>\n<li><p><code>printf(\"sizeof('a'+'b'+'C)  %d\\n\",sizeof('a'+'b'+'C'));</code> will print 4 in both languages. </p>\n\n<p>In C, the resulting type of <code>int + int + int</code> is naturally <code>int</code>. In C++, we have <code>char + char + char</code>. But the + invokes <a href=\"https://stackoverflow.com/questions/46073295/implicit-type-promotion-rules\">implicit type promotion rules</a> so we end up with <code>int</code> in the end no matter.</p></li>\n<li><p><code>printf(\"sizeof(\\\"a\\\") %d\\n\",sizeof(\"a\"));</code> will print 2 in both languages.</p>\n\n<p>The string literal <code>\"a\"</code> is of type <code>char[]</code> in C and <code>const char[]</code> in C++. In either case we have an array consisting of an <code>a</code> and a null terminator: two characters.</p>\n\n<p>As a side note, this happens because the array <code>\"a\"</code> does not decay into a pointer to the first element when operand to <code>sizeof</code>. Should we provoke an array decay by for example writing <code>sizeof(\"a\"+0)</code>, then we would get the size of a pointer instead (likely 4 or 8).</p></li>\n</ul>\n\n<hr>\n\n<p><sup>1)</sup> Somewhere in the dark ages there were no types and everything you wrote would boil down to <code>int</code> no matter. Then when Dennis Ritchie started to cook together some manner of de facto standard for C, he apparently decided that character literals should always be <em>promoted</em> to <code>int</code>. And then later when C was standardized, they said that character literals are simply <code>int</code>.</p>\n\n<p>Upon creating C++, Bjarne Stroustrup recognize that all of this didn't make much sense and made character literals type <code>char</code> as they ought to be. But the C committee stubbornly refuses to fix this language flaw.</p>\n"}, {"comments": [{"owner": {"reputation": 703, "user_id": 9999814, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D0vR5.jpg?s=128&g=1", "display_name": "AmanSharma", "link": "https://stackoverflow.com/users/9999814/amansharma"}, "edited": false, "score": 0, "creation_date": 1530774261, "post_id": 51181857, "comment_id": 89352179, "body": "Thanx..Good Research though"}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1530809902, "post_id": 51181857, "comment_id": 89374763, "body": "Note that the authors of the Standard have expressly recognized the possibility that an implementation may be conforming and yet be of such poor quality as to be useless, but assume that quality implementations won&#39;t go out of their way to behave in the least-useful fashion the Standard would permit.  The Rationales for all versions of the Standard describe expressions where they would expect quality commonplace implementations to treat signed and unsigned math identically.  The UB resulting from unwanted promotions to signs will only be a problem when using low-quality compilers..."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1530809926, "post_id": 51181857, "comment_id": 89374776, "body": "...(which, for whatever reason, programmers have become all too willing to tolerate).  The fact that a piece of code won&#39;t work on a compiler that designed to be of needlessly-poor quality doesn&#39;t mean the code is broken.  It would be impossible to write any program that couldn&#39;t be sunk by a &quot;conforming implementation&quot; of sufficiently poor quality."}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "reply_to_user": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1530811494, "post_id": 51181857, "comment_id": 89375534, "body": "@supercat <a href=\"https://cs.stackexchange.com/a/93817/40057\">It was your answer about how C is not a \u201csafe\u201d programming language</a> that brought that example to mind. :)"}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "reply_to_user": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1530812983, "post_id": 51181857, "comment_id": 89376253, "body": "@supercat I agree that a lot of language-lawyering isn\u2019t especially relevant to coding today. Sometimes, for fun, I point out loopholes based on the fact that one\u2019s-complement or sign-and-magnitude arithmetic are still technically allowed. But they\u2019re only used in a few mainframe architectures from the \u201960s (although UNIVAC does still support one of those). Or that there is an implementation that supports EBCDIC as the source and execution character set"}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1530815817, "post_id": 51181857, "comment_id": 89377529, "body": "@Davislor: If the Standard recognized a concept of a &quot;limited implementation&quot; which can&#39;t support all features, but will reject programs that require or may require features it can&#39;t support, then a C99 implementation could be practical on the Univac.  I don&#39;t think there&#39;s any practical way a ones&#39;-complement or sign-magnitude machine can efficiently handle a uint64_least_t or unsigned long long type without also being able to efficiently process two&#39;s-complement arithmetic unless its basic word size was 65 bits or longer."}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "reply_to_user": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1530815999, "post_id": 51181857, "comment_id": 89377611, "body": "@supercat It does recognize a distinction between a hosted and freestanding implementation, but yes. Emulating higher-precision math would be difficult, and you couldn\u2019t have the exact-width types we were talking about anyway, because padding bits are not allowed."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 1, "creation_date": 1530816610, "post_id": 51181857, "comment_id": 89377892, "body": "@Davislor: The latest Univac C implementation I&#39;ve read about supported a 72-bit &quot;long long&quot; type, but not an unsigned equivalent.  The documentation didn&#39;t say how the &quot;long long&quot; was stored, but I would guess it probably used a non-binary representation with the upper word being (2**36-1) times the lower.  Such an approach would be allowable for an extended signed integer type, but would not be allowable for an unsigned type."}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "reply_to_user": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1530817239, "post_id": 51181857, "comment_id": 89378176, "body": "@supercat Interesting! I did not know that. But we\u2019re getting off-topic."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1530817627, "post_id": 51181857, "comment_id": 89378371, "body": "@Davislor: My intended point was that the requirement that implementations must support a 64-bit unsigned data type made it impractical to produce a meaningfully-conforming C99 implementation on any existing sign-magnitude or ones&#39;-complement hardware.  As a consequence,  concessions elsewhere in the Standard which were made to accommodate such machines serve no useful purpose unless weakening the language for no apparent reason is considered an &quot;useful purpose&quot;."}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "reply_to_user": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1530817771, "post_id": 51181857, "comment_id": 89378437, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/174446/discussion-between-davislor-and-supercat\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "is_accepted": false, "score": 2, "last_activity_date": 1530748327, "creation_date": 1530748327, "answer_id": 51181857, "question_id": 51173976, "link": "https://stackoverflow.com/questions/51173976/confusing-behavior-of-sizeof-with-chars/51181857#51181857", "title": "Confusing behavior of sizeof with chars", "body": "<p>As others have mentioned, the C language standard defines the type of a character constant to be <code>int</code>.  The historical reason for this is that C, and its predecessor B, were originally developed on DEC PDP minicomputers with various word sizes, which supported 8-bit ASCII but could only perform arithmetic on registers.  Early versions of C defined <code>int</code> to be the native word size of the machine, and any value smaller than an <code>int</code> needed to be widened to <code>int</code> in order to be passed to or from a function, or used in a bitwise, logical or arithmetic expression, because that was how the underlying hardware worked.</p>\n\n<p>That is also why the integer promotion rules still say that any data type smaller than an <code>int</code> is promoted to <code>int</code>.  C implementations are also allowed to use one\u2019s-complement math instead of two\u2019s-complement for similar historical reasons, and the fact that character escapes default to octal and octal constants start with just <code>0</code> and hex needs <code>\\x</code> or <code>0x</code> is that those early DEC minicomputers had word sizes divisible into three-byte chunks but not four-byte nibbles.</p>\n\n<p>Automatic promotion to <code>int</code> causes nothing but trouble today.  (How many programmers are aware that multiplying two <code>uint32_t</code> expressions together is undefined behavior, because some implementations define <code>int</code> as 64 bits wide, the language requires that any type of lower rank than <code>int</code> must be promoted to a <em>signed</em> <code>int</code>, the result of multiplying two <code>int</code> multiplicands has type <code>int</code>, the multiplication can overflow a signed 64-bit product, and this is undefined behavior?)  But that\u2019s the reason C and C++ are stuck with it.</p>\n"}], "owner": {"reputation": 703, "user_id": 9999814, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D0vR5.jpg?s=128&g=1", "display_name": "AmanSharma", "link": "https://stackoverflow.com/users/9999814/amansharma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2869, "favorite_count": 7, "closed_date": 1530798229, "answer_count": 5, "score": 45, "last_activity_date": 1530768615, "creation_date": 1530708087, "last_edit_date": 1530718411, "question_id": 51173976, "link": "https://stackoverflow.com/questions/51173976/confusing-behavior-of-sizeof-with-chars", "closed_reason": "Duplicate", "title": "Confusing behavior of sizeof with chars", "body": "<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main(void)\n{\n    char ch='a';\n\n    printf(\"sizeof(ch)          = %d\\n\", sizeof(ch));\n    printf(\"sizeof('a')         = %d\\n\", sizeof('a'));\n    printf(\"sizeof('a'+'b'+'C') = %d\\n\", sizeof('a'+'b'+'C'));\n    printf(\"sizeof(\\\"a\\\")       = %d\\n\", sizeof(\"a\"));\n}\n</code></pre>\n\n<p>This program uses <code>sizeof</code> to calculate sizes. Why is the size of <code>'a'</code> different from the size of <code>ch</code> (where <code>ch='a'</code>)?</p>\n\n<pre><code>sizeof(ch)          = 1\nsizeof('a')         = 4\nsizeof('a'+'b'+'C') = 4\nsizeof(\"a\")         = 2\n</code></pre>\n"}, {"tags": ["c++", "c", "freertos"], "comments": [{"owner": {"reputation": 5143, "user_id": 600351, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7a2a3b9fd62972fa271deb3d0e31256c?s=128&d=identicon&r=PG", "display_name": "Geob-o-matic", "link": "https://stackoverflow.com/users/600351/geob-o-matic"}, "edited": false, "score": 0, "creation_date": 1530707976, "post_id": 51173936, "comment_id": 89330553, "body": "Release is set at &quot;-O1&quot; if it helps"}, {"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 0, "creation_date": 1530708227, "post_id": 51173936, "comment_id": 89330732, "body": "You fix it using <code>new</code>? Then tag the question as C++"}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 1, "creation_date": 1530708604, "post_id": 51173936, "comment_id": 89330976, "body": "If I undertand the documentation corectly then <code>xTaskCreate</code> does not block and returns after creating the task. Then <code>main</code> is exited and now <code>MyStruct s;</code>, which was on the stack of <code>main</code> doesn&#39;t exist anymore. I also wonder what happens when <code>main</code> is exited as normally the program now ends."}, {"owner": {"reputation": 2298, "user_id": 7699037, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ae22aa9776941949ddf401f3eb7fc318?s=128&d=identicon&r=PG&f=1", "display_name": "Mike van Dyke", "link": "https://stackoverflow.com/users/7699037/mike-van-dyke"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1530708790, "post_id": 51173936, "comment_id": 89331091, "body": "@PaulOgilvie normally, there is a <code>vTaskStartScheduler()</code> function that needs to be called in the main after creating the tasks, not really sure if this is the missing point."}, {"owner": {"reputation": 5143, "user_id": 600351, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7a2a3b9fd62972fa271deb3d0e31256c?s=128&d=identicon&r=PG", "display_name": "Geob-o-matic", "link": "https://stackoverflow.com/users/600351/geob-o-matic"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1530708822, "post_id": 51173936, "comment_id": 89331111, "body": "@PaulOgilvie : I should have mentioned that main does not exist, I&#39;ve stripped out the code to only show how I&#39;m passing the struct, sorry"}, {"owner": {"reputation": 5143, "user_id": 600351, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7a2a3b9fd62972fa271deb3d0e31256c?s=128&d=identicon&r=PG", "display_name": "Geob-o-matic", "link": "https://stackoverflow.com/users/600351/geob-o-matic"}, "reply_to_user": {"reputation": 2298, "user_id": 7699037, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ae22aa9776941949ddf401f3eb7fc318?s=128&d=identicon&r=PG&f=1", "display_name": "Mike van Dyke", "link": "https://stackoverflow.com/users/7699037/mike-van-dyke"}, "edited": false, "score": 0, "creation_date": 1530708848, "post_id": 51173936, "comment_id": 89331123, "body": "@MikevanDyke: yes exactly, I&#39;ll edit my code"}], "answers": [{"comments": [{"owner": {"reputation": 2298, "user_id": 7699037, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ae22aa9776941949ddf401f3eb7fc318?s=128&d=identicon&r=PG&f=1", "display_name": "Mike van Dyke", "link": "https://stackoverflow.com/users/7699037/mike-van-dyke"}, "edited": false, "score": 0, "creation_date": 1530780902, "post_id": 51176465, "comment_id": 89355958, "body": "hmm, but the variable should still exist when the task is executing, since the stack frame of the main function is the last one to be exited?"}, {"owner": {"reputation": 5143, "user_id": 600351, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7a2a3b9fd62972fa271deb3d0e31256c?s=128&d=identicon&r=PG", "display_name": "Geob-o-matic", "link": "https://stackoverflow.com/users/600351/geob-o-matic"}, "reply_to_user": {"reputation": 2298, "user_id": 7699037, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ae22aa9776941949ddf401f3eb7fc318?s=128&d=identicon&r=PG&f=1", "display_name": "Mike van Dyke", "link": "https://stackoverflow.com/users/7699037/mike-van-dyke"}, "edited": false, "score": 0, "creation_date": 1530781029, "post_id": 51176465, "comment_id": 89356039, "body": "It&#39;s what we though :-/"}], "tags": [], "owner": {"reputation": 5143, "user_id": 600351, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7a2a3b9fd62972fa271deb3d0e31256c?s=128&d=identicon&r=PG", "display_name": "Geob-o-matic", "link": "https://stackoverflow.com/users/600351/geob-o-matic"}, "is_accepted": false, "score": 3, "last_activity_date": 1530716171, "creation_date": 1530716171, "answer_id": 51176465, "question_id": 51173936, "link": "https://stackoverflow.com/questions/51173936/freertos-crash-only-in-release/51176465#51176465", "title": "FreeRTOS crash only in Release", "body": "<p>I'm so stupid, it's written on FreeRTOS' doc:\n<a href=\"https://www.freertos.org/a00125.html\" rel=\"nofollow noreferrer\">https://www.freertos.org/a00125.html</a></p>\n\n<blockquote>\n  <p>so it is not valid to pass the address of a stack variable.</p>\n</blockquote>\n"}], "owner": {"reputation": 5143, "user_id": 600351, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7a2a3b9fd62972fa271deb3d0e31256c?s=128&d=identicon&r=PG", "display_name": "Geob-o-matic", "link": "https://stackoverflow.com/users/600351/geob-o-matic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 134, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1530716171, "creation_date": 1530707952, "last_edit_date": 1530708899, "question_id": 51173936, "link": "https://stackoverflow.com/questions/51173936/freertos-crash-only-in-release", "title": "FreeRTOS crash only in Release", "body": "<p>I have this code that crash only in Release:</p>\n\n<pre><code>int main() \n{\n  MyStruct s;\n  s.field = bla;\n\n  xTaskCreate(TestTask, \"TestTask\", 2000, &amp;s, 1, 0);\n\n  // other tasks creation\n  vTaskStartScheduler();\n}\n\n\nvoid TestTask(void *p) \n{\n  // some delay\n  MyStruct* s = (MyStruct*)p;\n  another_func(s-&gt;field); // hard fault\n}\n</code></pre>\n\n<p>I manage to fix it like this:</p>\n\n<pre><code>int main()\n{\n  MyStruct* s = new MyStruct();\n  s-&gt;field = bla;\n  xTaskCreate(TestTask, \"TestTask\", 2000, s, 1, 0);\n\n  // other tasks creation\n  vTaskStartScheduler();\n}\n</code></pre>\n\n<p>I don't understand why. Did I fixed it or workaround a memory corruption that can still be there?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 3, "creation_date": 1530703644, "post_id": 51172537, "comment_id": 89327773, "body": "There&#39;s no <code>getche()</code> nor <code>getch()</code> function in (standard) C."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 1, "creation_date": 1530703682, "post_id": 51172537, "comment_id": 89327787, "body": "As for <code>getchar()</code>, <a href=\"https://port70.net/~nsz/c/c11/n1570.html#7.21.7.6\" rel=\"nofollow noreferrer\">here&#39;s the documentation</a>."}, {"owner": {"reputation": 151, "user_id": 5701631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd4416b47b386a7e776f9a2e1596d6fb?s=128&d=identicon&r=PG&f=1", "display_name": "Nova Ardent", "link": "https://stackoverflow.com/users/5701631/nova-ardent"}, "edited": false, "score": 0, "creation_date": 1530703852, "post_id": 51172537, "comment_id": 89327897, "body": "I&#39;m kind of curious who told you getche, and getch existed, and or for which systems."}, {"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 3, "creation_date": 1530703857, "post_id": 51172537, "comment_id": 89327901, "body": "<a href=\"https://en.cppreference.com/w/c/io/getchar\" rel=\"nofollow noreferrer\"><code>getchar</code></a> is part of C - the other two came from the ancient (non-standard) <a href=\"https://en.wikipedia.org/wiki/Conio.h\" rel=\"nofollow noreferrer\">conio.h</a> from the MS-DOS era."}, {"owner": {"reputation": 151, "user_id": 5701631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd4416b47b386a7e776f9a2e1596d6fb?s=128&d=identicon&r=PG&f=1", "display_name": "Nova Ardent", "link": "https://stackoverflow.com/users/5701631/nova-ardent"}, "edited": false, "score": 0, "creation_date": 1530703884, "post_id": 51172537, "comment_id": 89327916, "body": "well, that was quick"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "reply_to_user": {"reputation": 151, "user_id": 5701631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd4416b47b386a7e776f9a2e1596d6fb?s=128&d=identicon&r=PG&f=1", "display_name": "Nova Ardent", "link": "https://stackoverflow.com/users/5701631/nova-ardent"}, "edited": false, "score": 2, "creation_date": 1530704064, "post_id": 51172537, "comment_id": 89328041, "body": "@NovaArdent I get the impression that <code>getch</code> is still wildly popular, at least among beginning C programmers on Windows platforms."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1530704412, "post_id": 51172537, "comment_id": 89328272, "body": "I closed as dupe to an existing question and added an answer of my own also addressing <code>getche</code>."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 3, "creation_date": 1530704662, "post_id": 51172537, "comment_id": 89328427, "body": "I get the impression that Turbo C is still wildly popular... caused by an abundance of completely incompetent teachers in a certain eastern country where programming is popular."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1530705545, "post_id": 51172537, "comment_id": 89329004, "body": "I know what you are talking about @Lundin. Sad, but true."}, {"owner": {"reputation": 19358, "user_id": 3049655, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ZLzeP.jpg?s=128&g=1", "display_name": "Spikatrix", "link": "https://stackoverflow.com/users/3049655/spikatrix"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1530705974, "post_id": 51172537, "comment_id": 89329287, "body": "@Lundin Yes, true. Institutions blindly hire people without proper knowledge/expertise at all. I&#39;ve seen and experienced a number of them too :-("}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1530708627, "post_id": 51172537, "comment_id": 89330987, "body": "I&#39;ve also added <a href=\"https://stackoverflow.com/questions/9180001/what-is-the-difference-between-getch-and-getchar/51173273#51173273\">a longish answer</a> at the <a href=\"https://stackoverflow.com/questions/9180001/what-is-the-difference-between-getch-and-getchar\">duplicate question</a>."}], "owner": {"reputation": 11, "user_id": 10031834, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-cUmJeJlb1f4/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq2gav0M0cKXwktcc1PexOvZMAMQGA/mo/photo.jpg?sz=128", "display_name": "Damian Wayne", "link": "https://stackoverflow.com/users/10031834/damian-wayne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 109, "favorite_count": 0, "closed_date": 1530703910, "answer_count": 0, "score": 0, "last_activity_date": 1530703518, "creation_date": 1530703518, "question_id": 51172537, "link": "https://stackoverflow.com/questions/51172537/c-programming-getch-getchar-getche", "closed_reason": "Duplicate", "title": "C programming getch(), getchar(), getche()", "body": "<p>In C programming, there is a getche(), getch(), getchar(). I have seen these three but I'm confused. What's the difference?What are their function?</p>\n"}, {"tags": ["c++", "c", "openssl", "dtls", "wolfssl"], "answers": [{"tags": [], "owner": {"reputation": 648, "user_id": 9968825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6d0332ac7d53381e1a5b84b320fd135?s=128&d=identicon&r=PG", "display_name": "chrysn", "link": "https://stackoverflow.com/users/9968825/chrysn"}, "is_accepted": true, "score": 0, "last_activity_date": 1532522053, "creation_date": 1532522053, "answer_id": 51519020, "question_id": 51172291, "link": "https://stackoverflow.com/questions/51172291/how-detect-received-message-in-dtls/51519020#51519020", "title": "How detect received message in DTLS?", "body": "<p>In nonblocking operation, you typically have a point in the program where it waits for any of the nonblocking file descriptors to report availability of data.</p>\n\n<p>In the example you linked, that's the <code>select(...)</code> line. In practice, you either have such a central select yourself, or have the main loop run by another library to which you pass the descriptors of whose readiness you want to be notified (eg. in GTK that might be <a href=\"https://developer.gnome.org/glib/stable/glib-The-Main-Event-Loop.html#g-source-add-unix-fd\" rel=\"nofollow noreferrer\">g_source_add_unix_fd</a>).</p>\n"}], "owner": {"reputation": 13, "user_id": 9940905, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Y78EdRswvfw/AAAAAAAAAAI/AAAAAAAAAAA/JcjcDgE3aGU/photo.jpg?sz=128", "display_name": "Anton", "link": "https://stackoverflow.com/users/9940905/anton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "accepted_answer_id": 51519020, "answer_count": 1, "score": -6, "last_activity_date": 1532522053, "creation_date": 1530702743, "last_edit_date": 1530704733, "question_id": 51172291, "link": "https://stackoverflow.com/questions/51172291/how-detect-received-message-in-dtls", "title": "How detect received message in DTLS?", "body": "<p>I implement DTLS protocol for CoAP on C, C++.\nAs I see I can use OpenSSL or WolfSSL.\nFor example WolfSSL:</p>\n\n<p><a href=\"https://github.com/wolfSSL/wolfssl-examples/blob/master/dtls/client-dtls-nonblocking.c\" rel=\"nofollow noreferrer\">https://github.com/wolfSSL/wolfssl-examples/blob/master/dtls/client-dtls-nonblocking.c</a></p>\n\n<p>But how I can detect that some message has been sent to me?</p>\n"}, {"tags": ["c", "xc8"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 5, "creation_date": 1530702486, "post_id": 51172200, "comment_id": 89327028, "body": "<code>uint16ByteT</code> vs <code>uint16Byte</code>. If this is just a typo here, the error doesn&#39;t seem related to the code shown."}, {"owner": {"reputation": 41428, "user_id": 440564, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/e3dbcb5159c02d59f52159faa8437c97?s=128&d=identicon&r=PG", "display_name": "blue112", "link": "https://stackoverflow.com/users/440564/blue112"}, "edited": false, "score": 2, "creation_date": 1530702646, "post_id": 51172200, "comment_id": 89327116, "body": "Which compiler are you use ?"}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 3, "creation_date": 1530702714, "post_id": 51172200, "comment_id": 89327160, "body": "<i>for &quot;@&quot;</i>? Can you please copy and paste the error message verbatim? It will help making this a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 3478, "user_id": 9061264, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TPing.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/9061264/mike"}, "edited": false, "score": 0, "creation_date": 1530703838, "post_id": 51172200, "comment_id": 89327881, "body": "It&#39;s exactly the error message a wrote above, Sorry about the typo"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1530704037, "post_id": 51172200, "comment_id": 89328009, "body": "I sense some fuzziness in the meaning of &quot;exactly the same&quot;, please copy&amp;paste the literal error output of your compiler. Also show how you invoke the compiler, @KeineLust might have a point in his answer -- what you do here requires C11."}, {"owner": {"reputation": 3478, "user_id": 9061264, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TPing.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/9061264/mike"}, "edited": false, "score": 0, "creation_date": 1530704588, "post_id": 51172200, "comment_id": 89328377, "body": "my compiler: xc8"}, {"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 2, "creation_date": 1530704863, "post_id": 51172200, "comment_id": 89328542, "body": "It seems that xc8 doesn&#39;t support C11: <i>This compiler conforms to the ISO/IEC 9899:1990 Standard for programming languages. This is commonly called the C90 Standard. It is referred to as the ANSI C  Standard in this manual.</i> In this case you can not use anonym <code>struct</code>s (use a name for the inner anonym <code>struct</code>)"}, {"owner": {"reputation": 3478, "user_id": 9061264, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TPing.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/9061264/mike"}, "edited": false, "score": 0, "creation_date": 1530705578, "post_id": 51172200, "comment_id": 89329027, "body": "I have looked in the manual:  XC8 supports anonym structures"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 2, "creation_date": 1530703088, "post_id": 51172378, "comment_id": 89327394, "body": "The initializer from the question should be just as good for initializing to 0."}, {"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 0, "creation_date": 1530703221, "post_id": 51172378, "comment_id": 89327472, "body": "@FelixPalmen, maybe is enough, but in this way you skip the warning: <code>warning: (near initialization for \u2018myVariable.&lt;anonymous&gt;\u2019) [-Wmissing-braces]</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 1, "creation_date": 1530703285, "post_id": 51172378, "comment_id": 89327520, "body": "Yes, some compilers will show this. But still not related to the (quite obscure) problem in the question. OP should clarify."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1530705330, "post_id": 51172378, "comment_id": 89328872, "body": "@KeineLust: You can silence a compiler complaining about missing braces by just giving it what it asks for like: <code>...  = {{0}};</code> in this case"}], "tags": [], "owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "is_accepted": true, "score": 1, "last_activity_date": 1530705488, "last_edit_date": 1530705488, "creation_date": 1530703020, "answer_id": 51172378, "question_id": 51172200, "link": "https://stackoverflow.com/questions/51172200/which-is-the-correct-way-to-initialize-a-union-struct/51172378#51172378", "title": "Which is the correct way to initialize a union/struct?", "body": "<p>To initialize an anonym <code>struct</code>/<code>union</code> you can use:</p>\n\n<pre><code>uint16ByteT myVariable = {{0}, .complete = 0};\n</code></pre>\n\n<p>or simply</p>\n\n<pre><code>uint16ByteT myVariable = {{0}};\n</code></pre>\n\n<p>Notice <code>uint16ByteT</code> instead of <code>uint16Byte</code></p>\n\n<p>Also notice that you need to compile in C11 mode since anonym <code>struct</code>s/<code>union</code>s was introduced in this version.</p>\n"}], "owner": {"reputation": 3478, "user_id": 9061264, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TPing.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/9061264/mike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 358, "favorite_count": 1, "accepted_answer_id": 51172378, "answer_count": 1, "score": 0, "last_activity_date": 1540905826, "creation_date": 1530702409, "last_edit_date": 1540905826, "question_id": 51172200, "link": "https://stackoverflow.com/questions/51172200/which-is-the-correct-way-to-initialize-a-union-struct", "title": "Which is the correct way to initialize a union/struct?", "body": "<p>I have got the following union:</p>\n\n<pre><code>typedef union\n{\n    struct\n    {\n        uint8_t LSB;\n        uint8_t MSB;\n    };\n    int16_t     complete;\n}uint16ByteT;\n</code></pre>\n\n<p>Know I want to use my type and initialize the variable. After scanning SO  ( I thought) I found the solution:</p>\n\n<pre><code>uint16ByteT   myVariable  = {0};\n</code></pre>\n\n<p>But my compiler gives me an Error message:</p>\n\n<blockquote>\n  <p>simple type required for \"@\"</p>\n</blockquote>\n\n<p>Normally the xc8 compiler uses the \"@\" to bring a variable at a specific address.</p>\n"}, {"tags": ["c", "linux"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 4, "creation_date": 1530702275, "post_id": 51172150, "comment_id": 89326897, "body": "start it with <code>&lt;&#47;dev&#47;null</code>. Oh, and show code. For a problem like this, workarounds are a really bad idea."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 1, "creation_date": 1530707556, "post_id": 51172150, "comment_id": 89330304, "body": "Or you could try closing fd 0 immediately after process start. Depending on the nature of the bug  you observe this might be sufficient."}, {"owner": {"reputation": 1632, "user_id": 2429333, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5eb897104dc190de7ea7da0ac29a59ae?s=128&d=identicon&r=PG", "display_name": "pbn", "link": "https://stackoverflow.com/users/2429333/pbn"}, "edited": false, "score": 1, "creation_date": 1530708177, "post_id": 51172150, "comment_id": 89330701, "body": "This is a wild guess, but is it possible that there is a STDIN_FILENO descriptor in your pollfd set?"}, {"owner": {"reputation": 385, "user_id": 7114946, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-FbfhnUgQmLU/AAAAAAAAAAI/AAAAAAAAARc/EdBSHus7rDU/photo.jpg?sz=128", "display_name": "Daniel Ortega", "link": "https://stackoverflow.com/users/7114946/daniel-ortega"}, "reply_to_user": {"reputation": 1632, "user_id": 2429333, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5eb897104dc190de7ea7da0ac29a59ae?s=128&d=identicon&r=PG", "display_name": "pbn", "link": "https://stackoverflow.com/users/2429333/pbn"}, "edited": false, "score": 0, "creation_date": 1530709323, "post_id": 51172150, "comment_id": 89331431, "body": "It happened that @pbn was right. This is code I am debugging but I have not develiped myself and indeed, there was a STDIN_FILENO in the pollfd set and this was causing it to fail.  Thank you for the solution. Best regards!"}, {"owner": {"reputation": 1632, "user_id": 2429333, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5eb897104dc190de7ea7da0ac29a59ae?s=128&d=identicon&r=PG", "display_name": "pbn", "link": "https://stackoverflow.com/users/2429333/pbn"}, "edited": false, "score": 0, "creation_date": 1530709615, "post_id": 51172150, "comment_id": 89331618, "body": "I posted it as an answer then"}], "answers": [{"comments": [{"owner": {"reputation": 385, "user_id": 7114946, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-FbfhnUgQmLU/AAAAAAAAAAI/AAAAAAAAARc/EdBSHus7rDU/photo.jpg?sz=128", "display_name": "Daniel Ortega", "link": "https://stackoverflow.com/users/7114946/daniel-ortega"}, "edited": false, "score": 0, "creation_date": 1530710153, "post_id": 51174414, "comment_id": 89331959, "body": "This was indeed the problem.  Thank you"}], "tags": [], "owner": {"reputation": 1632, "user_id": 2429333, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5eb897104dc190de7ea7da0ac29a59ae?s=128&d=identicon&r=PG", "display_name": "pbn", "link": "https://stackoverflow.com/users/2429333/pbn"}, "is_accepted": true, "score": 1, "last_activity_date": 1530709446, "creation_date": 1530709446, "answer_id": 51174414, "question_id": 51172150, "link": "https://stackoverflow.com/questions/51172150/unbind-key-strokes-from-process/51174414#51174414", "title": "Unbind key strokes from process", "body": "<p>It's possible that there is a STDIN_FILENO descriptor in your pollfd set.</p>\n"}], "owner": {"reputation": 385, "user_id": 7114946, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-FbfhnUgQmLU/AAAAAAAAAAI/AAAAAAAAARc/EdBSHus7rDU/photo.jpg?sz=128", "display_name": "Daniel Ortega", "link": "https://stackoverflow.com/users/7114946/daniel-ortega"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 51174414, "answer_count": 1, "score": 0, "last_activity_date": 1530709446, "creation_date": 1530702219, "question_id": 51172150, "link": "https://stackoverflow.com/questions/51172150/unbind-key-strokes-from-process", "title": "Unbind key strokes from process", "body": "<p>I have a process that works in a loop good except when any key is accidentally pressed in the keyboard, in which case, the program crashes.</p>\n\n<p>I still need to debug this but it is basically caused by the function poll().</p>\n\n<p>I am not sure yet why this happens, but I would like to unbind all the key strokes happened in the terminal so they are not sent to the process and this crash will not occur.</p>\n\n<p>How can I do that?</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["c++", "c", "swift"], "comments": [{"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1530705793, "post_id": 51171787, "comment_id": 89329161, "body": "This is not C.. it&#39;s C++ or C# i guess."}, {"owner": {"reputation": 2473, "user_id": 1824565, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e2c67135c7db0abfe784397503f20733?s=128&d=identicon&r=PG", "display_name": "Reimond Hill", "link": "https://stackoverflow.com/users/1824565/reimond-hill"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1530709936, "post_id": 51171787, "comment_id": 89331808, "body": "sorry i am go change the tag then"}], "answers": [{"comments": [{"owner": {"reputation": 2473, "user_id": 1824565, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e2c67135c7db0abfe784397503f20733?s=128&d=identicon&r=PG", "display_name": "Reimond Hill", "link": "https://stackoverflow.com/users/1824565/reimond-hill"}, "edited": false, "score": 0, "creation_date": 1530970195, "post_id": 51216612, "comment_id": 89427645, "body": "I see, I have been doing some testing and I more or less assumed It was something like that but that explanation makes it more understandable! Thank you"}], "tags": [], "owner": {"reputation": 1323, "user_id": 6900902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96a5448d619d9cd1bd6341a384301587?s=128&d=identicon&r=PG&f=1", "display_name": "bscothern", "link": "https://stackoverflow.com/users/6900902/bscothern"}, "is_accepted": true, "score": 2, "last_activity_date": 1530905275, "creation_date": 1530905275, "answer_id": 51216612, "question_id": 51171787, "link": "https://stackoverflow.com/questions/51171787/takeretainedvalue-or-takeunretainedvalue-in-swift-with-c-library/51216612#51216612", "title": "takeRetainedValue() or takeUnretainedValue() in Swift with C++ Library", "body": "<p>You need to pass in a retained value if you want your <code>ClassCallback</code> to exist even if all your Swift references to it go away, this creates a memory leak without proper cleanup logic also being added in. If you pass an unretained value then if all of your swift references have gone away when you try to get back your <code>ClassCallback</code> you will crash.</p>\n\n<p>In your callback, you can take an unretained reference to get the object assuming you want it to continue to exist with its current reference count at the end of scope. If you take a retained reference the reference count will decrement and destroy the object if that was the last reference.</p>\n\n<p>What I generally do is pass in a retained reference and take an unretained reference until I am ready to dispose of the callback object. When that happens I take the retained value of the context pointer (<code>aPtr</code> in your case) to balance the retained pass and replace it with a new appropriate value.</p>\n"}], "owner": {"reputation": 2473, "user_id": 1824565, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e2c67135c7db0abfe784397503f20733?s=128&d=identicon&r=PG", "display_name": "Reimond Hill", "link": "https://stackoverflow.com/users/1824565/reimond-hill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 324, "favorite_count": 1, "accepted_answer_id": 51216612, "answer_count": 1, "score": 0, "last_activity_date": 1530905275, "creation_date": 1530701068, "last_edit_date": 1530710066, "question_id": 51171787, "link": "https://stackoverflow.com/questions/51171787/takeretainedvalue-or-takeunretainedvalue-in-swift-with-c-library", "title": "takeRetainedValue() or takeUnretainedValue() in Swift with C++ Library", "body": "<p>I am working on a Swift project that uses a C library wrapped In a C++. </p>\n\n<ul>\n<li><p>The library offers you the possibility to get/set variables synchronously and asynchronously. </p></li>\n<li><p>The Library as callback methods that notifies when and even has happened.</p></li>\n</ul>\n\n<p>I have this function in swift:</p>\n\n<pre><code>/*** Convert const void* To Any T ***/\n\nfunc bridgeToTypeRetained&lt;T : AnyObject&gt;(ptr : UnsafeMutableRawPointer) -&gt; T {\n   return Unmanaged&lt;T&gt;.fromOpaque(ptr).takeRetainedValue()\n}\n\nfunc bridgeToTypeUnretained&lt;T : AnyObject&gt;(ptr : UnsafeRawPointer) -&gt; T {\n   return Unmanaged&lt;T&gt;.fromOpaque(ptr).takeUnretainedValue()\n}\n</code></pre>\n\n<p>and </p>\n\n<pre><code>/*** Convert const void* To Any T ***/\nfunc bridgeToPointerRetained&lt;T : AnyObject&gt;(obj : T) -&gt; UnsafeMutableRawPointer {\n    return UnsafeMutableRawPointer(Unmanaged.passRetained(obj).toOpaque())\n}\n\nfunc bridgeToPointerUnretained&lt;T : AnyObject&gt;(obj : T) -&gt; UnsafeMutableRawPointer {\n    return UnsafeMutableRawPointer(Unmanaged.passUnretained(obj).toOpaque())\n}\n</code></pre>\n\n<p>For Implementing Callbacks from the Library, In the Library I have the following definitions:</p>\n\n<pre><code>DllExport void STDCALL CpProxyAvOpenhomeOrgInfo1SetPropertyTrackCountChanged(THandle aHandle, OhNetCallback aCallback, void* aPtr);\n\ntypedef void (STDCALL *OhNetCallback)(void* aPtr);\n</code></pre>\n\n<p>Then in swift I use the following Code:</p>\n\n<pre><code> CpProxyAvOpenhomeOrgInfo1SetPropertyTrackCountChanged(myHandle, { (pointer) in\n\n if pointer != nil{\n    let myClass:MyClass = bridgeToTypeRetained(ptr: pointer!)\n    myClass.aValu = 0 //CRASH BAD ACCESS\n    let myClass:MyClass = bridgeToTypeUnretained(ptr: pointer!)\n    myClass.aValu = 0 //NO CRASH\n }\n\n }, bridgeToPointerRetained(obj: self))\n</code></pre>\n\n<p>And for implementing an asynchronously action, In the Library I have they following definitions:</p>\n\n<pre><code>DllExport void STDCALL CpProxyAvOpenhomeOrgInfo1BeginCounters(THandle aHandle, OhNetCallbackAsync aCallback, void* aPtr);\n\ntypedef void (STDCALL *OhNetCallbackAsync)(void* aPtr, OhNetHandleAsync aAsync);\n</code></pre>\n\n<p>Then swift I use the following code</p>\n\n<pre><code>    let classCallback = ClassCallback()\n    classCallback.classObject = self\n\n    CpProxyAvOpenhomeOrgInfo1BeginCounters(prxHandleId, { (pointer, ohNetAsync) in\n\n        if pointer != nil &amp;&amp; ohNetAsync != nil{\n\n            let classCallback : ClassCallback = bridgeToTypeRetained(ptr: pointer!)\n            classCallback.classObject.aValue = 1 //NO CRASH\n\n        }\n\n\n    }, bridgeToPointerRetained(obj: classCallback))\n</code></pre>\n\n<p>So My questions would be: </p>\n\n<ul>\n<li>When do I have to use takeRetainedValue() or takeUnretainedValue() according to info I can get from the C++ Library?</li>\n</ul>\n\n<p>Thank you.</p>\n"}, {"tags": ["c", "segmentation-fault", "undefined-behavior", "divide-by-zero"], "comments": [{"owner": {"reputation": 31483, "user_id": 502381, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/74b99e687909be449e0130a50950eac7?s=128&d=identicon&r=PG&f=1", "display_name": "JJJ", "link": "https://stackoverflow.com/users/502381/jjj"}, "edited": false, "score": 2, "creation_date": 1530699839, "post_id": 51171327, "comment_id": 89325356, "body": "A floating point exception is not a segmentation fault."}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1530700857, "post_id": 51171327, "comment_id": 89325945, "body": "If you are asking of effects on specific system, then please <a href=\"https://stackoverflow.com/posts/51171327/edit\">edit</a> your question and tell us what system."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1530700876, "post_id": 51171327, "comment_id": 89325957, "body": "The CPU handles it by tossing out a hardware exception. And that&#39;s it, it has nothing to do with the C language or the OS."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 2, "creation_date": 1530701997, "post_id": 51171327, "comment_id": 89326705, "body": "pointless UB question, see the meaning of <b>undefined</b>. What exactly happens depends on your machine and environment. BTW, a division by 0 <b>can</b> be well-defined on floating-point types, if IEEE-754 format is used."}], "answers": [{"comments": [{"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1530700965, "post_id": 51171722, "comment_id": 89326034, "body": "It is UB: <i>&quot;The result of the / operator is the quotient from the division of the first operand by the second; the result of the % operator is the remainder. In both operations, <b>if the value of the second operand is zero, the behavior is undefined.</b>&quot;</i>"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "reply_to_user": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1530701589, "post_id": 51171722, "comment_id": 89326444, "body": "@user694733 Thanks. (You&#39;ve saved me a trip downstairs to fetch my copy of the Standard.) Sentence deleted."}, {"owner": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "edited": false, "score": 0, "creation_date": 1530770141, "post_id": 51171722, "comment_id": 89350165, "body": "FYI <a href=\"https://twitter.com/shafikyaghmour/status/990937975595843584\" rel=\"nofollow noreferrer\">SIGFPE is a misnomer and is not limited to floating pointer errors but general erroneous arithmetic operations. Apparently goes back to PDP-11</a>"}, {"owner": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "edited": false, "score": 0, "creation_date": 1530770568, "post_id": 51171722, "comment_id": 89350338, "body": "Also note <a href=\"https://twitter.com/shafikyaghmour/status/1000222871434575873\" rel=\"nofollow noreferrer\">that is the implementation support Annex F then floating point divide by zero is not undefined behavior</a>"}], "tags": [], "owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "is_accepted": false, "score": 5, "last_activity_date": 1530702927, "last_edit_date": 1530702927, "creation_date": 1530700842, "answer_id": 51171722, "question_id": 51171327, "link": "https://stackoverflow.com/questions/51171327/any-number-divided-by-0-in-c-does-it-come-under-segmentation-fault/51171722#51171722", "title": "Any number divided by 0 in C ,does it come under segmentation fault?", "body": "<p>In general, a floating point exception is an example of the more general class of exceptions.  The specifics will vary from machine to machine.</p>\n\n<p>There are a number of things that can \"kill\" your program, and all of these can be classified as exceptions in this regard:</p>\n\n<ul>\n<li>access to nonexistent memory</li>\n<li>improper access to memory (misaligned, write to read-only, etc.)</li>\n<li>divide by 0</li>\n<li>illegal instruction</li>\n<li>resource limit exceeded (e.g. CPU time)</li>\n<li>arithmetic overflow</li>\n</ul>\n\n<p>Under Unix-like operating systems, access to nonexistent memory is typically a \"segmentation violation\", while improper access to memory is typically a \"bus error\".  (Under Windows they are/were a General Protection Violation, and/or a <a href=\"https://en.wikipedia.org/wiki/Blue_Screen_of_Death\" rel=\"nofollow noreferrer\">BSOD</a>.)</p>\n\n<p>And as you can see, although dividing by 0 is an exception, it's a sibling of a segmentation violation, not a subset.</p>\n\n<p>(I've listed arithmetic overflow as an exception because it <em>could</em> be, not because it usually is.  Most of today's systems do not treat overflow as an exception, of course.  But by the rules of C they could, with the exception of overflows on unsigned integers, which are required by C to be defined and well-behaved.)</p>\n\n<p>Under Unix-like operating systems, most/all of these exceptions tend to be mapped to <em>signals</em>, which your program can catch so that it can (attempt to) continue rather than dying.</p>\n\n<p>(Ironically, on the system where I just tried it, <em>integer</em> divide-by-0 gives me a \"floating point exception\", while a floating-point divide-by-0 gives me an IEEE-754 <code>inf</code>, which is not an exception at all.  But that's a <a href=\"https://stackoverflow.com/questions/37262572/\">different question</a>.)</p>\n"}, {"comments": [{"owner": {"reputation": 12931, "user_id": 1472222, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b0970aeafe38e05589964ef6ec1ec3b4?s=128&d=identicon&r=PG", "display_name": "theMayer", "link": "https://stackoverflow.com/users/1472222/themayer"}, "edited": false, "score": 0, "creation_date": 1535062248, "post_id": 51171748, "comment_id": 90939488, "body": "This answer is really more of a comment, and kinda snarky one at that. Can you reword?"}], "tags": [], "owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "is_accepted": false, "score": 7, "last_activity_date": 1530700935, "creation_date": 1530700935, "answer_id": 51171748, "question_id": 51171327, "link": "https://stackoverflow.com/questions/51171327/any-number-divided-by-0-in-c-does-it-come-under-segmentation-fault/51171748#51171748", "title": "Any number divided by 0 in C ,does it come under segmentation fault?", "body": "<p>If the behavior is undefined, it means there is no definition for what happens. So posing the question \"does it mean segmentation fault\" means you're missing the point. Anything can happen.</p>\n\n<p>Also, there are many CPUs, and you don't specify one, so answering \"how does CPU handle divide by 0\" is of course also impossible.</p>\n\n<p>You can catch exceptions, and handle them in code.</p>\n"}], "owner": {"reputation": 21, "user_id": 6112966, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d47ad84522cb203eb5d69d8a698a932?s=128&d=identicon&r=PG&f=1", "display_name": "Ayushi", "link": "https://stackoverflow.com/users/6112966/ayushi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1298, "favorite_count": 1, "answer_count": 2, "score": 2, "last_activity_date": 1530702927, "creation_date": 1530699571, "last_edit_date": 1530700747, "question_id": 51171327, "link": "https://stackoverflow.com/questions/51171327/any-number-divided-by-0-in-c-does-it-come-under-segmentation-fault", "title": "Any number divided by 0 in C ,does it come under segmentation fault?", "body": "<pre><code>int main()\n{\n    int x = 5, y = 0;\n    int z = x / y;\n    return 0;\n}\n</code></pre>\n\n<p>I know that it comes under undefined behavior, but does it mean segmentation  fault? And how does CPU handle divided by 0 case?</p>\n\n<p>When I run this I get Floating point exception (core dumped).</p>\n"}, {"tags": ["c++", "c", "sse", "avx"], "comments": [{"owner": {"reputation": 32078, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 0, "creation_date": 1530695311, "post_id": 51169688, "comment_id": 89322424, "body": "Use of uninitialized variable is always UB."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 2, "creation_date": 1530700733, "post_id": 51169688, "comment_id": 89325861, "body": "This is what <a href=\"https://software.intel.com/sites/landingpage/IntrinsicsGuide/#expand=2912,5562&amp;text=undefined_ps\" rel=\"nofollow noreferrer\"><code>_mm_undefined_ps</code></a> is for (but it only actually helps code-gen with Intel&#39;s compiler).  And besides that, <b>you want a <code>movsd</code> load of two floats that zero-extends and breaks the false dependency on the old value of a register, not a <code>movlps</code> that merges.</b>  Cast to <code>double *</code> and use <code>_mm_load_sd</code>"}], "owner": {"reputation": 484, "user_id": 7473688, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06d59a75869bae02d0696acb268413c4?s=128&d=identicon&r=PG&f=1", "display_name": "Owen Morgan", "link": "https://stackoverflow.com/users/7473688/owen-morgan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "closed_date": 1530695275, "answer_count": 0, "score": 1, "last_activity_date": 1530694633, "creation_date": 1530694633, "question_id": 51169688, "link": "https://stackoverflow.com/questions/51169688/using-intrinsics-in-their-own-initialisation", "closed_reason": "Duplicate", "title": "Using intrinsics in their own initialisation", "body": "<p>I have a piece of code that does this:</p>\n\n<pre><code>__m128i a = _mm_loadl_pi(a, (__m64 *)ptr);\n</code></pre>\n\n<p>Where ptr is some memory address. I get a compiler warning about <code>a</code> being used in its own initialisation. Essentially what I wanted to do was just set the lower two elements and set the upper two elements later. </p>\n\n<p>Is this kosher/will it cause problems later?</p>\n"}, {"tags": ["c", "arrays", "struct"], "comments": [{"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 2, "creation_date": 1530693974, "post_id": 51169412, "comment_id": 89321577, "body": "The last element is <code>table[x - 1]</code>, <code>table[x]</code> is out of the bounds and can contain anything."}, {"owner": {"reputation": 53, "user_id": 9845200, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Y0pFp.jpg?s=128&g=1", "display_name": "Tanjamado", "link": "https://stackoverflow.com/users/9845200/tanjamado"}, "reply_to_user": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 0, "creation_date": 1530694041, "post_id": 51169412, "comment_id": 89321621, "body": "Then why table[X] even exists if it contains anything ?"}, {"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 0, "creation_date": 1530694225, "post_id": 51169412, "comment_id": 89321712, "body": "What do you mean with <i>table[X] even exists</i>? <code>table[x + 1000]</code> also exists (contains data or garbage) but you are not allowed to access it because is out of the limits of the array."}, {"owner": {"reputation": 185, "user_id": 9929801, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/90yR8.png?s=128&g=1", "display_name": "Paul Ankman", "link": "https://stackoverflow.com/users/9929801/paul-ankman"}, "edited": false, "score": 0, "creation_date": 1530694236, "post_id": 51169412, "comment_id": 89321724, "body": "<code>table[X]</code> is equivalent to access to the case at <code>table + X</code>. So if the adress is in your acceptable memory, it will work."}, {"owner": {"reputation": 53, "user_id": 9845200, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Y0pFp.jpg?s=128&g=1", "display_name": "Tanjamado", "link": "https://stackoverflow.com/users/9845200/tanjamado"}, "reply_to_user": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 0, "creation_date": 1530694415, "post_id": 51169412, "comment_id": 89321843, "body": "@KeineLust I mean why is table[x] a part of the array if it does not contain something &#39;usual&#39; or something that makes sense?"}, {"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 0, "creation_date": 1530694465, "post_id": 51169412, "comment_id": 89321865, "body": "@OthmaneAllamou, <code>table[x]</code> is not part of the array, arrays are base 0 in C, so the range is <code>[0 ... n-1]</code>"}, {"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "reply_to_user": {"reputation": 185, "user_id": 9929801, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/90yR8.png?s=128&g=1", "display_name": "Paul Ankman", "link": "https://stackoverflow.com/users/9929801/paul-ankman"}, "edited": false, "score": 0, "creation_date": 1530694475, "post_id": 51169412, "comment_id": 89321877, "body": "@PaulAnkman It is undefined behavior. It cannot &quot;work&quot;; since there is no way to figure out (within the bounds of the C programming language) what is should do."}, {"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 0, "creation_date": 1530694565, "post_id": 51169412, "comment_id": 89321930, "body": "@OthmaneAllamou : there is no &quot;out of bounds&quot; exception like you might be accustomed to in other languages. You as the programmer need to ensure not to go beyond the bounds of an array."}], "answers": [{"tags": [], "owner": {"reputation": 151, "user_id": 5701631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd4416b47b386a7e776f9a2e1596d6fb?s=128&d=identicon&r=PG&f=1", "display_name": "Nova Ardent", "link": "https://stackoverflow.com/users/5701631/nova-ardent"}, "is_accepted": false, "score": 0, "last_activity_date": 1530694494, "last_edit_date": 1530694494, "creation_date": 1530694190, "answer_id": 51169527, "question_id": 51169412, "link": "https://stackoverflow.com/questions/51169412/last-element-of-a-struct-array-c/51169527#51169527", "title": "Last element of a struct array - C", "body": "<p>Structs work in memory the same way that an integer or some other basic data type would in this instances. Your array would just be separated by sizeof(struct) instead of sizeof(the basic data type). </p>\n\n<p>It'd still start at 0, and end at X - 1. The type of arrays usually just really defined 2 things:</p>\n\n<p>The amount of bytes per index, and how to treat the data. </p>\n\n<p>Picture an array of size 3 with structs that contain 5 bytes of data. Your array would just be set as follows:</p>\n\n<pre><code>-----|-----|-----|????|\ns1   |s2   |s3   |????|\n</code></pre>\n\n<p>Just because it exists, doesn't mean our program knows what it is. the 4th [3] index (????) would be an index out of bounds of our array. It is possible however you could get some meaningful value here, but very unlikely. Most of the time it will either be garbage, or cause an error. </p>\n"}, {"tags": [], "owner": {"reputation": 369, "user_id": 7400340, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a6380568a3888fda9ed87f3e4f13ea4?s=128&d=identicon&r=PG&f=1", "display_name": "sdobak", "link": "https://stackoverflow.com/users/7400340/sdobak"}, "is_accepted": true, "score": 1, "last_activity_date": 1530694203, "creation_date": 1530694203, "answer_id": 51169532, "question_id": 51169412, "link": "https://stackoverflow.com/questions/51169412/last-element-of-a-struct-array-c/51169532#51169532", "title": "Last element of a struct array - C", "body": "<p>The indexing of array in C starts with zero, i.e. the first element will be in <code>table[0]</code>, the second in <code>table[1]</code>, the third in <code>table[2]</code> ... and the last on in <code>table[X-1]</code>.</p>\n\n<p><code>table[X]</code> is outside of the arrays bounds. C does not have bounds checking, so compiler allows accessing it, but this is an undefined behaviour, i.e. you will never know what happens. Reading it can give back memory garbage or can lead to an OS exception like segmentation fault.</p>\n"}, {"tags": [], "owner": {"reputation": 1820, "user_id": 3849158, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/q1Gcg.png?s=128&g=1", "display_name": "izlin", "link": "https://stackoverflow.com/users/3849158/izlin"}, "is_accepted": false, "score": 0, "last_activity_date": 1530694273, "creation_date": 1530694273, "answer_id": 51169559, "question_id": 51169412, "link": "https://stackoverflow.com/questions/51169412/last-element-of-a-struct-array-c/51169559#51169559", "title": "Last element of a struct array - C", "body": "<p>The answer is the same for any kind of array. If you have one with the size \n<code>X</code> :</p>\n\n<pre><code>int a[5];\nstruct my_struct ms[10];\n...\n</code></pre>\n\n<p>you specify the amount of elements in that array. Because the 1st element is element 0, the last element is always <code>X - 1</code>.</p>\n\n<p>If you try to access the element <code>a[X]</code> you will get <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behavior</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 0, "last_activity_date": 1530697722, "creation_date": 1530697722, "answer_id": 51170738, "question_id": 51169412, "link": "https://stackoverflow.com/questions/51169412/last-element-of-a-struct-array-c/51170738#51170738", "title": "Last element of a struct array - C", "body": "<p>Arrays in C use zero indexing, meaning they start with <code>0</code> and end with <code>n-1</code>. Not to be confused with array declarations, where you write the size expressed in number of items. The syntax for accessing an array and declaring one looks similar, which is why this can be confusing for beginners.</p>\n\n<p>Example:</p>\n\n<pre><code>int main (void)\n{\n  int array[5]; // allocate an array with 5 elements\n  array[0] = 0; // access first element\n  array[4] = 0; // access last element (index 4)\n\n  array[5] = 0; // BAD, accessing the array out of bounds: index 5 gives item number 6\n}\n</code></pre>\n\n<p>And this is why the canonical way to write for loops in C is this:</p>\n\n<pre><code>for(int i=0; i&lt;n; i++)\n</code></pre>\n\n<p>where <code>n</code> is the size of the array, and the iterator <code>i</code> will have the values from <code>0</code> to <code>n-1</code>.</p>\n"}], "owner": {"reputation": 53, "user_id": 9845200, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Y0pFp.jpg?s=128&g=1", "display_name": "Tanjamado", "link": "https://stackoverflow.com/users/9845200/tanjamado"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1087, "favorite_count": 0, "accepted_answer_id": 51169532, "answer_count": 4, "score": 0, "last_activity_date": 1530697722, "creation_date": 1530693861, "last_edit_date": 1530694271, "question_id": 51169412, "link": "https://stackoverflow.com/questions/51169412/last-element-of-a-struct-array-c", "title": "Last element of a struct array - C", "body": "<p>I'm a bit confused about a thing :</p>\n\n<p>If I have an array of structs: <code>table</code> whith a length of <code>X</code> and I want to access the last element of it: <code>table[X]</code> or <code>table[X-1]</code>. If it's <code>table[X-1]</code>, what <code>table[X]</code> contains ? </p>\n"}, {"tags": ["c", "timer", "embedded", "pic", "xc8"], "comments": [{"owner": {"reputation": 6899, "user_id": 1212012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gmBY7.png?s=128&g=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1212012/mathieu"}, "edited": false, "score": 1, "creation_date": 1530708580, "post_id": 51169269, "comment_id": 89330958, "body": "Since there is no wait condition in <code>get_courant()</code> function, and that you check always that something is readable on UART before reading it, the execution time of <code>get_courant()</code> should be constant, isn&#39;t?"}, {"owner": {"reputation": 19, "user_id": 9967905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28b9012405570173b76b185cf703e6b6?s=128&d=identicon&r=PG&f=1", "display_name": "F Pierron", "link": "https://stackoverflow.com/users/9967905/f-pierron"}, "reply_to_user": {"reputation": 6899, "user_id": 1212012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gmBY7.png?s=128&g=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1212012/mathieu"}, "edited": false, "score": 1, "creation_date": 1530710820, "post_id": 51169269, "comment_id": 89332385, "body": "That should be the case indeed, however I have to consider that my trinket can possibly be busy (lots of interrupts there) and thus cannot answer in time !"}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 9967905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28b9012405570173b76b185cf703e6b6?s=128&d=identicon&r=PG&f=1", "display_name": "F Pierron", "link": "https://stackoverflow.com/users/9967905/f-pierron"}, "edited": false, "score": 0, "creation_date": 1530878072, "post_id": 51193712, "comment_id": 89400322, "body": "So you are suggesting me to start the timer <b>inside</b> my get_courant() function, then check inside of that function (for example before every if) if the timer exeeded 10Us ?   Woudn&#39;t that condiderably slower my code ? This function is supposed to get cqlled 1000 times per sec."}], "tags": [], "owner": {"reputation": 17, "user_id": 10024796, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-fOLUifPnUIc/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq02MhWJVD4eJVeLWe6vmXCiRjDo1g/mo/photo.jpg?sz=128", "display_name": "u\u011fur &#246;zdemir", "link": "https://stackoverflow.com/users/10024796/u%c4%9fur-%c3%b6zdemir"}, "is_accepted": false, "score": 1, "last_activity_date": 1530800505, "creation_date": 1530800505, "answer_id": 51193712, "question_id": 51169269, "link": "https://stackoverflow.com/questions/51169269/how-to-use-pic18f87k22-timer-as-interrupt/51193712#51193712", "title": "How to use PIC18f87k22 timer as interrupt", "body": "<p>according to PIC18f87k22 datasheet page 193 in T0CON register's 7th bit TMR0ON is activating the timer to count or stop it.\nRespect to that u can set that TMR0ON in the function that u want to measure the staying time and check the 10uS and u gotta reset it after u leave the function(in 10uS or after 10uS in anyway) u should also make sure after Clearing TMR0ON or before seting TMR0ON u must clean the old value that timer hold to not affect from previous measurement </p>\n"}], "owner": {"reputation": 19, "user_id": 9967905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28b9012405570173b76b185cf703e6b6?s=128&d=identicon&r=PG&f=1", "display_name": "F Pierron", "link": "https://stackoverflow.com/users/9967905/f-pierron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 169, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1530800505, "creation_date": 1530693412, "last_edit_date": 1530708331, "question_id": 51169269, "link": "https://stackoverflow.com/questions/51169269/how-to-use-pic18f87k22-timer-as-interrupt", "title": "How to use PIC18f87k22 timer as interrupt", "body": "<p>This is a generic question regarding the way to use timer0 on PIC.</p>\n\n<p>I'm trying to build a dc motor control system using a PIC18f87k22 and an arduino pro trinket.</p>\n\n<p>In my program, I have a function called <code>get_courant()</code>.\nThis function sends requests to the trinket and reads the answer received (by uart) and stores that value in one of my global variables, thus actualizing it.</p>\n\n<p>What I would like to do is use the timer as follows:</p>\n\n<p>If <code>get_courant()</code> takes more than 10us to proceed, then skip it, and go directly to the rest of the instructions in my main.</p>\n\n<p>I know I'm supposed to start a timer before calling the function, and somehow read the timer value to decide rather to skip it or not.</p>\n\n<p>However, if I check the timer value <em>after</em> the function is called, then my time could be waisted if the execution of `get_courant() exceeded 10us, in which case the timer is useless.</p>\n\n<p>Any tip to help me realize what I want to achieve (IDK if that was clear with my bad english)? \nHere is the code of <code>get_courant()</code> if that can be of any help:</p>\n\n<pre><code>int16_t get_courant()\n{\n uint8_t courant1;\n uint8_t courant2;\n int16_t courant;\n\n if(EUSART1_is_tx_ready())\n        {\n            EUSART1_Write(0b00000001);\n        }\n if(EUSART1_is_rx_ready())\n        {\n        courant1= EUSART1_Read(); \n        }\n\n if(EUSART1_is_tx_ready())\n        {\n            EUSART1_Write(0b00000010);\n        }\n if(EUSART1_is_rx_ready())\n        {\n        courant2= EUSART1_Read(); \n        }\n if (CheckBit(courant1,7))\n {\n    bit_clr(courant1,7);\n    courant = (courant1 &lt;&lt; 8) | courant2;\n    courant = - courant;\n }\n else \n {\n    courant = (courant1 &lt;&lt; 8) | courant2;\n }\n\n return courant;   \n }\n</code></pre>\n\n<p>and this is the part of my main function where I call get_courant() :</p>\n\n<pre><code>while(!Stop_flag)\n{   \n    int i=0;\n    do\n    {\n\n\n        Mesure_courant=get_courant();\n        Tension_initiale = PID_Courant(Mesure_courant,Erreur_courant,Consigne_courant,Integrale_courant,Kp_courant,Ki_courant,Kd_courant,Wind_up_flag_courant);\n        i++;\n        Put_Rapport_Cyclique(Tension_initiale, Choix_Mode);\n\n    } while(i&lt;10);\n</code></pre>\n"}, {"tags": ["c", "arrays", "pointers"], "comments": [{"owner": {"reputation": 151, "user_id": 5701631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd4416b47b386a7e776f9a2e1596d6fb?s=128&d=identicon&r=PG&f=1", "display_name": "Nova Ardent", "link": "https://stackoverflow.com/users/5701631/nova-ardent"}, "edited": false, "score": 1, "creation_date": 1530692634, "post_id": 51168890, "comment_id": 89320876, "body": "yes you can, int ** val, is logically equivalent to int val[n][m]; They&#39;re not the same, but can be treated as such. It should be noted however, your method of retrieving said size of the two D array seems a bit dodgy in nature because it looks like you only find the size of one of the dimensions, and set one of the 2 dimensions."}, {"owner": {"reputation": 185, "user_id": 9929801, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/90yR8.png?s=128&g=1", "display_name": "Paul Ankman", "link": "https://stackoverflow.com/users/9929801/paul-ankman"}, "edited": false, "score": 1, "creation_date": 1530692698, "post_id": 51168890, "comment_id": 89320901, "body": "The only thing here is that you can&#39;t allocate on the heap directly the  <code>int *</code>."}], "answers": [{"tags": [], "owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "is_accepted": true, "score": 5, "last_activity_date": 1530695501, "last_edit_date": 1530695501, "creation_date": 1530692658, "answer_id": 51169040, "question_id": 51168890, "link": "https://stackoverflow.com/questions/51168890/passing-1d-array-2d-arrays-and-pointer-arrays/51169040#51169040", "title": "Passing 1D array, 2D arrays and pointer Arrays", "body": "<p>In your last example, you have an <strong>array of pointers</strong>.</p>\n\n<p>And yes, that would work, check for example this toy example:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nvoid func(int **arr, int n) {\n\n    // print equal to arr[0][1] \n    printf(\"%d %d\\n\", n, *arr[1]);\n}\n\nint main(void) {\n    int a = 1, b = 2, c = 3;\n\n    // set the points of a, b, and c, to arr[0][0..2];\n    int *arr[] = {&amp;a, &amp;b, &amp;c};\n    int n = sizeof(arr)/sizeof(arr[0]);\n    printf(\"%d %d\\n\", n, *arr[1]);\n\n    func(arr, n);\n\n    return 0;\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>3 2\n3 2\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "is_accepted": false, "score": 4, "last_activity_date": 1530696207, "creation_date": 1530696207, "answer_id": 51170197, "question_id": 51168890, "link": "https://stackoverflow.com/questions/51168890/passing-1d-array-2d-arrays-and-pointer-arrays/51170197#51170197", "title": "Passing 1D array, 2D arrays and pointer Arrays", "body": "<blockquote>\n  <p>I am confused with pointers and arrays to be honest. It took me a long time to figure out how to pass a 2D array.</p>\n</blockquote>\n\n<p>This confusion is very widespread. It stems from the fact that you <strong>cannot pass arrays</strong> in C, but the language allows a syntax that makes it look like you could.</p>\n\n<p>So, as you can't pass an array to a function, what you do instead is pass it a pointer to the first array element and, if needed, the size of the array. Inside the function, you can use that pointer for accessing the array, and the syntax looks the same as if it would be an actual array. This also needs some explanation:</p>\n\n<ul>\n<li><code>[]</code>, the indexing operator, works by adding the index to a given pointer and dereferencing the resulting pointer. Therefore, writing <code>a[5]</code> is exactly the same as <code>*(a+5)</code>.</li>\n<li>This even works if <code>a</code> is an actual array (and not a pointer), because an array evaluates to a pointer to the first element <em>in most contexts</em> (there are exceptions like the <code>sizeof</code> operator).</li>\n</ul>\n\n<p>To make things more complicated, C allows to declare functions that look as if they were taking arrays, e.g. you can write:</p>\n\n<pre><code>void foo(int bar[]);\n</code></pre>\n\n<p>There's a rule in the C standard that says function parameter types are subject to \"<em>type adjustment</em>\": Any parameter of an array type is automatically adjusted to the corresponding pointer type. So, the function above is actually the same as</p>\n\n<pre><code>void foo(int *bar);\n</code></pre>\n\n<p>Therefore, better forget about passing arrays (I'd even recommend to <strong>not</strong> use the array syntax in function parameters, but that's subject to debate) -- you always pass pointers.</p>\n\n<hr>\n\n<p>With this knowledge, you can easily construct correct examples for all your cases:</p>\n\n<p>(1) <strong>\"Normal\" array</strong>:</p>\n\n<pre><code>void foo(int bar[], size_t n); // with type adjustment\nvoid foo(int *bar, size_t n);  // what it really means\n\n// call like\nint a[5];\nfoo(a, 5);\n</code></pre>\n\n<p>(2) <strong>2D array</strong>:</p>\n\n<p>A 2D array is an array of arrays, so it's first element is itself an array -> you would pass a pointer to an array</p>\n\n<pre><code>void foo(int bar[][10], int n);  // with type adjustment, 2d array of n x 10\nvoid foo(int (*bar)[10], int n); // what it really means\n\n// call like:\nint a[5][10];\nfoo(a, 5);\n</code></pre>\n\n<p>(3) <strong>Array of pointers</strong>:</p>\n\n<p>An array of pointers is often used as an alternative to a 2d array -- as the elements are just pointers, they can point to single values or arrays of different lengths, but the drawback is that you don't have the whole data as a single block in memory, as would be the case with a real 2d array. As this is just an array of pointers, it looks very much like a \"normal\" array in use:</p>\n\n<pre><code>void foo(int *bar[], int n); // with type adjustment\nvoid foo(int **bar, int n);  // what it really means\n\n// call like:\nint *a[5];\nfoo(a, 5);\n</code></pre>\n\n<hr>\n\n<p>Final note: You will often read that arrays \"decay as pointers\" in C. That's no official wording, but very widespread. If you combine the rule that an array identifier <em>evaluates to a pointer</em> in most contexts (e.g. when passing it to a function) with the rule of type adjustment for function parameters, the result is that you write array syntax everywhere, but get pointers, so that's the meaning of \"decaying\".</p>\n"}, {"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1530698455, "post_id": 51170369, "comment_id": 89324490, "body": "<a href=\"https://stackoverflow.com/questions/42094465/correctly-allocating-multi-dimensional-arrays\">Correctly allocating multi-dimensional arrays</a> for the correct method."}], "tags": [], "owner": {"reputation": 427, "user_id": 8834967, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Xrf_YCVb2Vw/AAAAAAAAAAI/AAAAAAAAAAc/K52j8i_sYWw/photo.jpg?sz=128", "display_name": "Joy Allen", "link": "https://stackoverflow.com/users/8834967/joy-allen"}, "is_accepted": false, "score": 1, "last_activity_date": 1530696675, "creation_date": 1530696675, "answer_id": 51170369, "question_id": 51168890, "link": "https://stackoverflow.com/questions/51168890/passing-1d-array-2d-arrays-and-pointer-arrays/51170369#51170369", "title": "Passing 1D array, 2D arrays and pointer Arrays", "body": "<p>There is actually no differences among 1-D array, 2-D array, X-D array and pointer array. All of them are just consequent memory area.</p>\n\n<p>1-D array: </p>\n\n<pre><code>int arr[8];\nint *addr = arr;\n\n| arr[0] | ...*6... | arr[7] |\n^                   ^\n|                   |\naddr                 addr+7\n</code></pre>\n\n<p>2-D array: </p>\n\n<pre><code>int arr[4][2]\nint *addr = arr[0];\n\n| arr[0][0] | ...*6... | arr[3][1] |\n^                      ^\n|                      |\naddr                   addr+7 \n</code></pre>\n\n<p>3-D array:</p>\n\n<pre><code>int arr[2][2][2];\nint *addr = arr[0][0];\n\n| arr[0][0][0] | ...*6... | arr[1][1][1] |\n^                         ^\n|                         |\naddr                      addr+7\n</code></pre>\n\n<p>pointer array:</p>\n\n<pre><code>typedef pointer int*;\n...\n\nint a0[8] = {0, 1, 2, 3, 4, 5, 6, 7};\nint a1[7] = {0, 1, 2, 3, 4, 5, 6};\n...\nint a7[1] = {0};\n\npointer arr[8] = {a0, a1, a2, a3, a4, a5, a6, a7};\npointer *addr = arr;\n\n| arr[0] = a1 | ...*6... | arr[7] = a7 |\n^                        ^\n|                        |\naddr                     addr+7\n</code></pre>\n\n<p>Defining an X-D array can be implemented as following:</p>\n\n<pre><code>typedef data_type int;\n\ntypedef struct X-Array\n{\n    int d1;\n    int d2;\n    ...\n    int dx;\n    data_type *data;\n} X-Array;\n\nX-Array *create_X_Array(int d1, int d1, ..., int dx)\n{\n    X-Array *arr;\n    if ((arr = malloc(sizeof(X-Array))) == NULL)\n        return NULL;\n\n    if ((arr-&gt;data = malloc(sizeof(data_type * d1 * d2 * ... * dx))) == NULL)\n    {\n        free(arr);\n        return NULL;\n    }\n\n    arr-&gt;d1 = d1;\n    arr-&gt;d2 = d2;\n    ...\n    arr-&gt;dx = dx;\n\n    return arr;\n}\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 8015586, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Lh0akGax-6s/AAAAAAAAAAI/AAAAAAAACGk/qBU4wnm2qNg/photo.jpg?sz=128", "display_name": "Rohit Bajaj", "link": "https://stackoverflow.com/users/8015586/rohit-bajaj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1038, "favorite_count": 0, "accepted_answer_id": 51169040, "answer_count": 3, "score": 2, "last_activity_date": 1530701228, "creation_date": 1530692120, "last_edit_date": 1530694220, "question_id": 51168890, "link": "https://stackoverflow.com/questions/51168890/passing-1d-array-2d-arrays-and-pointer-arrays", "title": "Passing 1D array, 2D arrays and pointer Arrays", "body": "<p>To pass a 1D array to a function, we do this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nvoid func(int *arr, int n)\n{\n    // code here\n\n}\n\nint main()\n{\n    int arr[] = {......};                   // declare array\n    int n = sizeof(arr)/sizeof(arr[0]);\n    func(arr);                              // calling function func\n\n    return 0;\n}\n</code></pre>\n\n<p>To pass a 2D array to a function, we do this: </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nvoid func(int arr[][2])\n{\n    // code here\n    }\n\nint main()\n{\n    int arr[3][2];  // declare 2D array\n    func(arr);      // calling function func\n\n    return 0;\n}\n</code></pre>\n\n<p>So while passing a pointer array to a function, can we do something like this?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nvoid func(int **arr, int n)\n{\n    // code here\n\n}\n\nint main()\n{\n    int *arr[] = {......};                // declare array of pointers\n    int n = sizeof(arr)/sizeof(arr[0]);\n    func(arr, n);                           // calling function func\n\n    return 0;\n}\n</code></pre>\n\n<p>I am confused with pointers and arrays to be honest. It took me a long time to figure out how to pass a 2D array. I tried searching other similar questions, but to no avail. Please help me with: Passing a pointer array to a function. Also, any links where I can clear the confusion will be really appreciated.</p>\n"}, {"tags": ["c", "linux-kernel"], "answers": [{"tags": [], "owner": {"reputation": 3435, "user_id": 2699113, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/94940a425c39618d108ce74cde4d3931?s=128&d=identicon&r=PG&f=1", "display_name": "user2699113", "link": "https://stackoverflow.com/users/2699113/user2699113"}, "is_accepted": true, "score": 3, "last_activity_date": 1530764481, "last_edit_date": 1530764481, "creation_date": 1530703569, "answer_id": 51172556, "question_id": 51168780, "link": "https://stackoverflow.com/questions/51168780/linux-kernel-sleeping-in-driver-read-function/51172556#51172556", "title": "Linux kernel sleeping in driver read function", "body": "<p>When you are waiting for the data you should add your process to waiting queue (add_wait_queue()) then use set_current_state(TASK_INTERRUPTIBLE) and invoke schedule(). When the data comes in - it should be somehow recognized - for example using some interrupt and then wake up the sleeping task (wake_up()). There are plenty examples in kernel sources.</p>\n\n<p>In other words - in read function you need to go to sleep when there is no data and in some other path (interrupt) you need to wake up this read function. Better don't do the busy waiting in read function.</p>\n"}], "owner": {"reputation": 480, "user_id": 2893203, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/53ad66ab27bccec72ccd949e70645f26?s=128&d=identicon&r=PG&f=1", "display_name": "Sergey Kolesov", "link": "https://stackoverflow.com/users/2893203/sergey-kolesov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 237, "favorite_count": 1, "accepted_answer_id": 51172556, "answer_count": 1, "score": 1, "last_activity_date": 1530764481, "creation_date": 1530691760, "question_id": 51168780, "link": "https://stackoverflow.com/questions/51168780/linux-kernel-sleeping-in-driver-read-function", "title": "Linux kernel sleeping in driver read function", "body": "<p>I'm developing Linux kernel character driver and in read function I sleep in a loop until I get a data from the hardware. If I kill an user application while it is blocked in read syscall, the application is still working before I return from read syscall. Is there a possibility to determinate in the driver that the application is terminated, so I can return from the loop?</p>\n"}, {"tags": ["c", "gcc", "assembly", "x86", "loop-unrolling"], "comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 1, "creation_date": 1530692487, "post_id": 51168719, "comment_id": 89320783, "body": "Do you expect to be able to understand assembly code produced by an optimising compiler? Long ago I gave that up as futile."}, {"owner": {"reputation": 151, "user_id": 5701631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd4416b47b386a7e776f9a2e1596d6fb?s=128&d=identicon&r=PG&f=1", "display_name": "Nova Ardent", "link": "https://stackoverflow.com/users/5701631/nova-ardent"}, "edited": false, "score": 2, "creation_date": 1530693105, "post_id": 51168719, "comment_id": 89321125, "body": "you tend to see weird things happening with compiler optimization, because compiler optimization does weird things to optimize code. These things could include loop rollouts, ordering things for better caching etc."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 151, "user_id": 5701631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd4416b47b386a7e776f9a2e1596d6fb?s=128&d=identicon&r=PG&f=1", "display_name": "Nova Ardent", "link": "https://stackoverflow.com/users/5701631/nova-ardent"}, "edited": false, "score": 3, "creation_date": 1530695444, "post_id": 51168719, "comment_id": 89322498, "body": "@NovaArdent: but none of those things are happening here; it&#39;s not auto-vectorizing or unrolling (because <code>-O2</code> doesn&#39;t include <code>-ftree-vectorize</code> or <code>-funroll-loops</code>, and the memcpy pattern detector can&#39;t work because they didn&#39;t use <code>restrict</code>), so what the asm is doing is pretty close to the C source.  The question isn&#39;t about scheduling instructions either, just about why <code>n -= (n&amp;1)</code> compiles the way it does."}, {"owner": {"reputation": 151, "user_id": 5701631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd4416b47b386a7e776f9a2e1596d6fb?s=128&d=identicon&r=PG&f=1", "display_name": "Nova Ardent", "link": "https://stackoverflow.com/users/5701631/nova-ardent"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1530695537, "post_id": 51168719, "comment_id": 89322558, "body": "@PeterCordes I never said those specific things were happening in this instance. IIRC though -gX in gcc will enable some of these flags will it not?"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 151, "user_id": 5701631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd4416b47b386a7e776f9a2e1596d6fb?s=128&d=identicon&r=PG&f=1", "display_name": "Nova Ardent", "link": "https://stackoverflow.com/users/5701631/nova-ardent"}, "edited": false, "score": 0, "creation_date": 1530695605, "post_id": 51168719, "comment_id": 89322606, "body": "@NovaArdent: no, <code>-g</code> options don&#39;t affect code-gen, only debug metadata."}, {"owner": {"reputation": 151, "user_id": 5701631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd4416b47b386a7e776f9a2e1596d6fb?s=128&d=identicon&r=PG&f=1", "display_name": "Nova Ardent", "link": "https://stackoverflow.com/users/5701631/nova-ardent"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1530695729, "post_id": 51168719, "comment_id": 89322688, "body": "@PeterCordes Alright, well learning is what this site is about, so I&#39;ll leave my comments here so yours make sense, and so the small conversation can be a learning moment"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 151, "user_id": 5701631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd4416b47b386a7e776f9a2e1596d6fb?s=128&d=identicon&r=PG&f=1", "display_name": "Nova Ardent", "link": "https://stackoverflow.com/users/5701631/nova-ardent"}, "edited": false, "score": 3, "creation_date": 1530696006, "post_id": 51168719, "comment_id": 89322889, "body": "@NovaArdent: yup that&#39;s fine.  I just get annoyed when people ask interesting detailed compiler / performance questions and the first responses are &quot;it&#39;s too complicated for mortals&quot;, and your comment was along those lines, too.  (The question could use a better summary of what the instructions in question are doing,  and a link to Godbolt, though.  i.e. a good title might be &quot;why does gcc&#39;s code-gen for my unrolled loop epilogue look over-complicated?&quot;)"}, {"owner": {"reputation": 545, "user_id": 9266860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef5206d6fd79c294c934bf07fd5e2ed4?s=128&d=identicon&r=PG&f=1", "display_name": "Gunther Schulz", "link": "https://stackoverflow.com/users/9266860/gunther-schulz"}, "edited": false, "score": 0, "creation_date": 1530700951, "post_id": 51168719, "comment_id": 89326019, "body": "Now with the updated question, the answer is in the first case, the value of nr has to be remembered until after the loop, and the extra calculation takes place. In the second case, nr is dispensed with permanently as soon as possible (and no tail calculation), allowing analysis of a less complex situation, thus likely better assembly."}], "answers": [{"comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 2, "creation_date": 1530695047, "post_id": 51169265, "comment_id": 89322248, "body": "It doesn&#39;t auto-vectorize because the OP didn&#39;t enable auto-vectorization (<code>-O2</code>).  The question was about the address calc for the cleanup epilogue outside the loop, not the main loop anyway.  Your first sentence is the answer to the question, though, for the unsigned part."}], "tags": [], "owner": {"reputation": 545, "user_id": 9266860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef5206d6fd79c294c934bf07fd5e2ed4?s=128&d=identicon&r=PG&f=1", "display_name": "Gunther Schulz", "link": "https://stackoverflow.com/users/9266860/gunther-schulz"}, "is_accepted": false, "score": 0, "last_activity_date": 1530693384, "creation_date": 1530693384, "answer_id": 51169265, "question_id": 51168719, "link": "https://stackoverflow.com/questions/51168719/why-does-gccs-code-gen-for-my-unrolled-loop-epilogue-look-over-complicated/51169265#51169265", "title": "Why does gcc&#39;s code-gen for my unrolled loop epilogue look over-complicated?", "body": "<p>If you're asking why the assembly is relatively large, its because the compiler can't assume what you may know.</p>\n\n<p>For example, if you know the source array will not be modified during the copy, tell the compiler so by adding a <code>const</code> qualifier to the pointed at source data. </p>\n\n<pre><code>void foo (ptrdiff_t n, double *a, double const *b)\n</code></pre>\n\n<p>Further, if you know the two memory ranges will never overlap, add a <code>restrict</code> qualifier to each of the two pointers.</p>\n\n<pre><code>void foo (ptrdiff_t n, double *restrict a, double const *restrict b)\n</code></pre>\n\n<p>Ultimately, if you want the most optimized copy (compiler vendors spend a LOT of time on this), use <code>memcpy</code> for non-overlapping ranges, and <code>memmove</code> for overlapping ranges.</p>\n"}, {"comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 2, "creation_date": 1530695783, "post_id": 51169972, "comment_id": 89322735, "body": "This is mostly academic / curiousity, right?  If you actually want it to run fast, you&#39;d use <code>restrict</code> so it can recognize it as <code>memcpy</code> and inline an optimized copy, or call the library function.  And/or compile with full optimization (<code>-O3</code>) instead of only partial optimization (<code>-O2</code>).  <code>O3 -march=native</code> is good if you want something tuned for the computer it&#39;s compiled on, using whatever SSE/AVX versions it supports."}, {"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 0, "creation_date": 1530695797, "post_id": 51169972, "comment_id": 89322748, "body": "The goal for optimized code is not to be &quot;neat&quot;, it is to be <i>optimized</i>."}, {"owner": {"reputation": 58770, "user_id": 4891738, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/kE2lh.jpg?s=128&g=1", "display_name": "\u674e\u54f2\u6e90", "link": "https://stackoverflow.com/users/4891738/%e6%9d%8e%e5%93%b2%e6%ba%90"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1530695981, "post_id": 51169972, "comment_id": 89322873, "body": "@PeterCordes Yes, just want a reasonable explanation. In fact, this kind of loop is memory-bound, so loop unrolling and SIMD would not be beneficial at all."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 0, "creation_date": 1530696152, "post_id": 51169972, "comment_id": 89323007, "body": "@usr2564301:  this code does look better optimized than the code-gen in the question, if the branch predicts well.  If not, then maybe it would be best to have the final-iteration check after the loop, where a mispredict can resolve while a bunch of copies are still in flight."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1530696519, "post_id": 51169972, "comment_id": 89323260, "body": "@\u674e\u54f2\u6e90: memory is fast these days, especially if any of your data is hot in L3.  If it&#39;s not, and you&#39;re purely tuning this for gigantic copies, you should be using NT stores to bypass the cache instead of trigger RFO for the output.  Copying in 8-byte chunks is also needlessly unfriendly for hyperthreading, filling up the pipeline with more uops to slow down the other logical core sharing the same physical core.  Smaller chunks means out-of-order execution doesn&#39;t run as far ahead, so you aren&#39;t triggering page-walks as far ahead of where you&#39;re reading when close to a page boundary."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1530696593, "post_id": 51169972, "comment_id": 89323301, "body": "See also <a href=\"https://stackoverflow.com/q/43343231\">Enhanced REP MOVSB for memcpy</a> for more about x86 memory bandwidth."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1530698265, "post_id": 51169972, "comment_id": 89324357, "body": "I just tried your <code>foo</code> vs. glibc <code>memcpy</code>  for large copies, on my Skylake i7-6700k (8MiB cache) with dual channel DDR4-2400.  For 100000000  bytes (100MB) copied 1k times, your version takes 9.77+-0.5% sec, while memcpy takes 6.68+-0.4% seconds.  (The CPU only clocked at ~3.3GHz for memcpy, but 3.7GHz for yours, because I didn&#39;t force it to max clock speed like it would if there was real work on other cores.)  actual test code:  <a href=\"https://godbolt.org/g/DYtKTR\" rel=\"nofollow noreferrer\">godbolt.org/g/DYtKTR</a>.  Strangely, for copy sizes around 5M (fits in L3 cache), the difference is much smaller. But for 500kB * 10k iter, it&#39;s 0.24 vs. 0.15"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1530700226, "post_id": 51169972, "comment_id": 89325556, "body": "Cool, yeah, I thought it was interesting even though the loop being unrolled in this case was just memcpy.  Hopefully your edit makes that clear to more readers."}], "tags": [], "owner": {"reputation": 58770, "user_id": 4891738, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/kE2lh.jpg?s=128&g=1", "display_name": "\u674e\u54f2\u6e90", "link": "https://stackoverflow.com/users/4891738/%e6%9d%8e%e5%93%b2%e6%ba%90"}, "is_accepted": true, "score": 1, "last_activity_date": 1530695497, "creation_date": 1530695497, "answer_id": 51169972, "question_id": 51168719, "link": "https://stackoverflow.com/questions/51168719/why-does-gccs-code-gen-for-my-unrolled-loop-epilogue-look-over-complicated/51169972#51169972", "title": "Why does gcc&#39;s code-gen for my unrolled loop epilogue look over-complicated?", "body": "<p>Looks like if I unroll the loop in the following manner, a compiler can generate neater code.</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stddef.h&gt;\n\nvoid foo (ptrdiff_t n, double *a, double *b) {\n  ptrdiff_t i = n &amp; 1;\n  if (i) b[0] = a[0];\n  while (i &lt; n) {\n    b[i] = a[i];\n    b[i + 1] = a[i + 1];\n    i += 2;\n    }\n  }\n\nvoid bar (size_t n, double *a, double *b) {\n  size_t i = n &amp; 1;\n  if (i) b[0] = a[0];\n  while (i &lt; n) {\n    b[i] = a[i];\n    b[i + 1] = a[i + 1];\n    i += 2;\n    }\n  }\n\nvoid baz (size_t n, double *a, double *b) {\n  size_t nr = n &amp; 1;\n  double *b_end = b + n;\n  if (nr) b[0] = a[0];\n  b += nr;\n  while (b &lt; b_end) {\n    b[0] = a[0];\n    b[1] = a[1];\n    a += 2;\n    b += 2;\n    }\n  }\n</code></pre>\n\n<hr>\n\n<pre><code>foo:\n  movq %rdi, %rax\n  andl $1, %eax\n  je .L9\n  movsd (%rsi), %xmm0\n  movsd %xmm0, (%rdx)\n  cmpq %rax, %rdi\n  jle .L11\n.L4:\n  movsd (%rsi,%rax,8), %xmm0\n  movsd %xmm0, (%rdx,%rax,8)\n  movsd 8(%rsi,%rax,8), %xmm0\n  movsd %xmm0, 8(%rdx,%rax,8)\n  addq $2, %rax\n.L9:\n  cmpq %rax, %rdi\n  jg .L4\n.L11:\n  ret\n</code></pre>\n\n<hr>\n\n<pre><code>bar:\n  movq %rdi, %rax\n  andl $1, %eax\n  je .L20\n  movsd (%rsi), %xmm0\n  movsd %xmm0, (%rdx)\n  cmpq %rax, %rdi\n  jbe .L21\n.L15:\n  movsd (%rsi,%rax,8), %xmm0\n  movsd %xmm0, (%rdx,%rax,8)\n  movsd 8(%rsi,%rax,8), %xmm0\n  movsd %xmm0, 8(%rdx,%rax,8)\n  addq $2, %rax\n.L20:\n  cmpq %rax, %rdi\n  ja .L15\n.L21:\n  ret\n</code></pre>\n\n<hr>\n\n<pre><code>baz:\n  leaq (%rdx,%rdi,8), %rcx\n  andl $1, %edi\n  je .L23\n  movsd (%rsi), %xmm0\n  movsd %xmm0, (%rdx)\n.L23:\n  leaq (%rdx,%rdi,8), %rax\n  cmpq %rax, %rcx\n  jbe .L22\n.L25:\n  movsd (%rsi), %xmm0\n  addq $16, %rax\n  addq $16, %rsi\n  movsd %xmm0, -16(%rax)\n  movsd -8(%rsi), %xmm0\n  movsd %xmm0, -8(%rax)\n  cmpq %rax, %rcx\n  ja .L25\n.L22:\n  ret\n</code></pre>\n"}], "owner": {"reputation": 58770, "user_id": 4891738, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/kE2lh.jpg?s=128&g=1", "display_name": "\u674e\u54f2\u6e90", "link": "https://stackoverflow.com/users/4891738/%e6%9d%8e%e5%93%b2%e6%ba%90"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2535, "favorite_count": 0, "accepted_answer_id": 51169972, "answer_count": 2, "score": 1, "last_activity_date": 1530699600, "creation_date": 1530691558, "last_edit_date": 1530699600, "question_id": 51168719, "link": "https://stackoverflow.com/questions/51168719/why-does-gccs-code-gen-for-my-unrolled-loop-epilogue-look-over-complicated", "title": "Why does gcc&#39;s code-gen for my unrolled loop epilogue look over-complicated?", "body": "<p>Thanks for all the comments so far. I am sorry that I have used a bad example in my original question, that almost everyone would say: <em>\"Oh, you should use <code>memcopy</code>!\"</em> But that is not what my question is about.</p>\n\n<p>My question is more <strong>generic</strong> about how manual loop unrolling should be done. Consider this example this time, by summing all elements in an array:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n\ndouble sum (size_t n, double *x) {\n  size_t nr = n &amp; 1;\n  double *end = x + (n - nr);\n  double sum_x = 0.0;\n  for (; x &lt; end; x++) sum_x += *x;\n  if (nr) sum_x += *x;\n  return sum_x;\n  }\n</code></pre>\n\n<p>The compiler generated assembly admits a similar behaviour (to what is shown by the array-copying example in my original question)</p>\n\n<pre><code>sum:\n  movq %rdi, %rcx\n  andl $1, %ecx\n  subq %rcx, %rdi\n  leaq (%rsi,%rdi,8), %rdx\n  cmpq %rdx, %rsi\n  jnb .L5\n  movq %rsi, %rax\n  pxor %xmm0, %xmm0\n.L3:\n  addsd (%rax), %xmm0\n  addq $8, %rax\n  cmpq %rax, %rdx\n  ja .L3\n  movq %rsi, %rax\n  notq %rax\n  addq %rax, %rdx\n  shrq $3, %rdx\n  leaq 8(%rsi,%rdx,8), %rsi\n.L2:\n  testq %rcx, %rcx\n  je .L1\n  addsd (%rsi), %xmm0\n.L1:\n  ret\n.L5:\n  pxor %xmm0, %xmm0\n  jmp .L2\n</code></pre>\n\n<p>However, if I now schedule the \"fractional\" part ahead of the main loop (as I later dig out in an answer I posted), the compiler does much better job.</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n\ndouble sum (size_t n, double *x) {\n  size_t nr = n &amp; 1;\n  double *end = x + n;\n  double sum_x = 0.0;\n  if (nr) sum_x += *x;\n  for (x += nr; x &lt; end; x++) sum_x += *x;\n  return sum_x;\n  }\n\nsum:\n  leaq (%rsi,%rdi,8), %rdx\n  pxor %xmm0, %xmm0\n  andl $1, %edi\n  je .L2\n  addsd (%rsi), %xmm0\n.L2:\n  leaq (%rsi,%rdi,8), %rax\n  cmpq %rax, %rdx\n  jbe .L1\n.L4:\n  addsd (%rax), %xmm0\n  addq $8, %rax\n  cmpq %rax, %rdx\n  ja .L4\n.L1:\n  ret\n</code></pre>\n\n<p>I have only used a compiler flag <code>-O2</code>. So as Peter said, the compiler generated assembly should be close to C source code. Then the question is, why does a compiler do better in the latter case?</p>\n\n<p>This is not really a performance-related question. It is just something I unconsciously found (and can't explain) when checking compiler's assembly output for C code from a C project I have been writing. Thanks again. Thank Peter for proposing a better title for the question.</p>\n\n<hr>\n\n<p><strong>Original question:</strong></p>\n\n<p>The following small C function copies <code>a</code>, a vector of <code>n</code> entries to <code>b</code>. A manual loop unrolling of depth 2 is applied.</p>\n\n<pre><code>#include &lt;stddef.h&gt;\n\nvoid foo (ptrdiff_t n, double *a, double *b) {\n  ptrdiff_t i = 0;\n  ptrdiff_t nr = n &amp; 1;\n  n -= nr;                  // `n` is an even integer\n  while (i &lt; n) {\n    b[i] = a[i];\n    b[i + 1] = a[i + 1];\n    i += 2;\n    }                       // `i = n` when the loop ends\n  if (nr) b[i] = a[i];\n  }\n</code></pre>\n\n<p>It gives the x64 assembly under <code>gcc -O2</code> (any <code>gcc</code> version 5.4+). However, I find the part of the output as commented weird. Why does the compiler ever generate them?</p>\n\n<pre><code>foo:\n  movq %rdi, %rcx\n  xorl %eax, %eax\n  andl $1, %ecx\n  subq %rcx, %rdi\n  testq %rdi, %rdi\n  jle .L11\n.L12:\n  movsd (%rsi,%rax,8), %xmm0\n  movsd %xmm0, (%rdx,%rax,8)\n  movsd 8(%rsi,%rax,8), %xmm0\n  movsd %xmm0, 8(%rdx,%rax,8)\n  addq $2, %rax\n  cmpq %rax, %rdi           // `i` in %rax, `n` in %rdi\n  jg .L12                   // the loop ends, with `i = n`, BELOW IS WEIRD\n  subq $1, %rdi             // n = n - 1;\n  shrq %rdi                 // n = n / 2;\n  leaq 2(%rdi,%rdi), %rax   // i = 2 * n + 2;  (this is just `i = n`, isn't it?)\n.L11:\n  testq %rcx, %rcx\n  je .L10\n  movsd (%rsi,%rax,8), %xmm0\n  movsd %xmm0, (%rdx,%rax,8)\n.L10:\n  ret\n</code></pre>\n\n<p>A similar version using <code>size_t</code> instead of <code>ptrdiff_t</code> gives something similar:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n\nvoid bar (size_t n, double *a, double *b) {\n  size_t i = 0;\n  size_t nr = n &amp; 1;\n  n -= nr;                  // `n` is an even integer\n  while (i &lt; n) {\n    b[i] = a[i];\n    b[i + 1] = a[i + 1];\n    i += 2;\n    }                       // `i = n` when the loop ends\n  if (nr) b[i] = a[i];\n  }\n\nbar:\n  movq %rdi, %rcx\n  andl $1, %ecx\n  subq %rcx, %rdi\n  je .L20\n  xorl %eax, %eax\n.L21:\n  movsd (%rsi,%rax,8), %xmm0\n  movsd %xmm0, (%rdx,%rax,8)\n  movsd 8(%rsi,%rax,8), %xmm0\n  movsd %xmm0, 8(%rdx,%rax,8)\n  addq $2, %rax\n  cmpq %rax, %rdi           // `i` in %rax, `n` in %rdi\n  ja .L21                   // the loop ends, with `i = n`, BUT BELOW IS WEIRD\n  subq $1, %rdi             // n = n - 1;\n  andq $-2, %rdi            // n = n &amp; (-2);\n  addq $2, %rdi             // n = n + 2;  (this is just `i = n`, isn't it?)\n.L20:\n  testq %rcx, %rcx\n  je .L19\n  movsd (%rsi,%rdi,8), %xmm0\n  movsd %xmm0, (%rdx,%rdi,8)\n.L19:\n  ret\n</code></pre>\n\n<p>And here is another equivalence,</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n\nvoid baz (size_t n, double *a, double *b) {\n  size_t nr = n &amp; 1;\n  n -= nr;\n  double *b_end = b + n;\n  while (b &lt; b_end) {\n    b[0] = a[0];\n    b[1] = a[1];\n    a += 2;\n    b += 2;\n    }                       // `b = b_end` when the loop ends\n  if (nr) b[0] = a[0];\n  }\n</code></pre>\n\n<p>but the following assembly looks more odd (though produced under <code>-O2</code>). Now <code>n</code>, <code>a</code> and <code>b</code> are all copied, and when the loop ends, we take 5 lines of code just to end up with <code>b_copy = 0</code>?!</p>\n\n<pre><code>baz:                        // initially, `n` in %rdi, `a` in %rsi, `b` in %rdx\n  movq %rdi, %r8            // n_copy = n;\n  andl $1, %r8d             // nr = n_copy &amp; 1;\n  subq %r8, %rdi            // n_copy -= nr;\n  leaq (%rdx,%rdi,8), %rdi  // b_end = b + n;\n  cmpq %rdi, %rdx           // if (b &gt;= b_end) jump to .L31\n  jnb .L31\n  movq %rdx, %rax           // b_copy = b;\n  movq %rsi, %rcx           // a_copy = a;\n.L32:\n  movsd (%rcx), %xmm0\n  addq $16, %rax\n  addq $16, %rcx\n  movsd %xmm0, -16(%rax)\n  movsd -8(%rcx), %xmm0\n  movsd %xmm0, -8(%rax)\n  cmpq %rax, %rdi           // `b_copy` in %rax, `b_end` in %rdi\n  ja .L32                   // the loop ends, with `b_copy = b_end`\n  movq %rdx, %rax           // b_copy = b;\n  notq %rax                 // b_copy = ~b_copy;\n  addq %rax, %rdi           // b_end = b_end + b_copy;\n  andq $-16, %rdi           // b_end = b_end &amp; (-16);\n  leaq 16(%rdi), %rax       // b_copy = b_end + 16;\n  addq %rax, %rsi           // a += b_copy;   (isn't `b_copy` just 0?)\n  addq %rax, %rdx           // b += b_copy;\n.L31:\n  testq %r8, %r8            // if (nr == 0) jump to .L30\n  je .L30\n  movsd (%rsi), %xmm0       // xmm0 = a[0];\n  movsd %xmm0, (%rdx)       // b[0] = xmm0;\n.L30:\n  ret\n</code></pre>\n\n<p>Can anyone explain what the compiler has in mind in all three cases?</p>\n"}, {"tags": ["c", "memory", "struct", "malloc", "realloc"], "comments": [{"owner": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "edited": false, "score": 0, "creation_date": 1530693486, "post_id": 51168561, "comment_id": 89321310, "body": "You cannot realloc static arrays. If you are going to resize the array, the simplest way is to copy the &quot;preset&quot; portion into the dynamic array during init."}, {"owner": {"reputation": 51, "user_id": 2572065, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c3b0337d83b2795197b5c579098c442e?s=128&d=identicon&r=PG", "display_name": "JohnnyKing94", "link": "https://stackoverflow.com/users/2572065/johnnyking94"}, "reply_to_user": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "edited": false, "score": 0, "creation_date": 1530694269, "post_id": 51168561, "comment_id": 89321745, "body": "@Groo how do i copy the preset portion into the dynamic array during runtime? thx for the reply btw"}, {"owner": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "edited": false, "score": 0, "creation_date": 1530694435, "post_id": 51168561, "comment_id": 89321850, "body": "Inside init, you would have (after doing the correct malloc&#39;ing) something like <code>memcpy(rec_data-&gt;u_user, preset_users, sizeof preset_users);</code>."}, {"owner": {"reputation": 51, "user_id": 2572065, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c3b0337d83b2795197b5c579098c442e?s=128&d=identicon&r=PG", "display_name": "JohnnyKing94", "link": "https://stackoverflow.com/users/2572065/johnnyking94"}, "reply_to_user": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "edited": false, "score": 0, "creation_date": 1530696480, "post_id": 51168561, "comment_id": 89323235, "body": "I&#39;m trying to use the union struct since a pointer on user is already declared in that union struct without creating a new pointer to <code>record_user</code>... but still it&#39;s not working... what am i doing wrong? Is it also correct my way of thinking?   <code>data_user.u_user = (user *)malloc(size * sizeof(user));</code> <code>memcpy(data_user.u_user, record_user, size);</code>"}, {"owner": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "edited": false, "score": 0, "creation_date": 1530701335, "post_id": 51168561, "comment_id": 89326271, "body": "<i>&quot;but still it&#39;s not working&quot;</i> - what is not working?"}], "owner": {"reputation": 51, "user_id": 2572065, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c3b0337d83b2795197b5c579098c442e?s=128&d=identicon&r=PG", "display_name": "JohnnyKing94", "link": "https://stackoverflow.com/users/2572065/johnnyking94"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 334, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1530690952, "creation_date": 1530690952, "question_id": 51168561, "link": "https://stackoverflow.com/questions/51168561/malloc-and-realloc-for-union-of-structs-linked-to-array-of-structs", "title": "Malloc and realloc for union of structs linked to array of structs", "body": "<p>What's the best way to dinamically allocate memory to an array of structs with union included? I should <code>malloc</code> and then <code>realloc</code> to <code>record_user</code> or to <code>data_user</code>? Below I explain more of it, this is the sample code:</p>\n\n<h1>core.h</h1>\n\n<pre><code>#define MAX_USER sizeof(record_user) / sizeof(record_user[0])\n#define MAX_ARTIST sizeof(record_artist) / sizeof(record_artist[0])\n/* all my other defines here */\n\ntypedef enum {\n    admin = 1,\n    basic = 0\n} type;\n\ntypedef struct {\n    int hour;\n    int minute;\n    int second;\n} tm;\n\ntypedef struct {\n    int day;\n    int month;\n    int year;\n} date;\n\ntypedef struct {\n    short id;\n    char name[MAX_USER_NAME];\n    char surname[MAX_USER_SURNAME];\n    char email[MAX_USER_EMAIL];\n    char password[MAX_PASSWORD_LENGTH];\n    date birthday;\n    date subscription_date;\n    tm subscription_time;\n    type role;\n} user;\n\ntypedef struct {\n    short id;\n    char name[MAX_ARTIST_NAME];\n    char genre[MAX_GENRE][MAX_GENRE_NAME];\n    char producer[MAX_PRODUCER_NAME];\n    char nationality[MAX_NATIONALITY_NAME];\n    int starting_year;\n} artist;\n\n/* and other structs */\n\ntypedef struct {\n    enum { USER, ARTIST } type;\n    union {\n        user *u_user;\n        artist *u_artist;\n    };\n    int size;\n} data;\n</code></pre>\n\n<h1>data.h</h1>\n\n<pre><code>#ifndef DATA_H\n#define DATA_H\n\n#include \"core.h\"\n\nextern user record_user[];\nextern artist record_artist[];\n\nextern data data_user;\nextern data data_artist;\n/* etc */\n\n#endif\n</code></pre>\n\n<h1>data.c</h1>\n\n<pre><code>#include \"data.h\"\n\n// SOME PRESET DATA\nuser record_user[] = {\n{ 1, \"Name 1\", \"Surname 1\", \"name1.surname1@email.com\", \",+o[oS\", { 29, 9, 1996 }, { 7, 3, 2011 }, { 18, 25, 58 }, 0 },\n/** The list goes on **/\n}\n\nartist record_artist[] = {\n{ 1, \"Coldplay\", { \"Pop\", \"Britpop\", \"Alternative Rock\" }, \"Parlophone\", \"United Kingdom\", 1997 },\n/** The list goes on **/\n}\n\ndata data_user = { .type = USER,.u_user = record_user,.size = MAX_USER };\ndata data_artist = { .type = ARTIST,.u_artist = record_artist,.size = MAX_ARTIST };\n</code></pre>\n\n<p>As you can see, there is a union struct for <code>artist</code> and <code>user</code>. I decided to create a union struct <em>in order to pass multiple array of structs to a generic function</em>. In the full code, I have more unions, but that's not the point to list them all. I just really need to understand what's I'm going to further explain below.</p>\n\n<p><code>record_user</code> like <code>record_artist</code> has some preset data that I link to <code>data_user</code> and <code>data_artist</code> respectively in <code>data.c</code>. Now this data needs to be increased during the runtime. I mean if <code>record_user</code> has 100 preset data rows (same thing for <code>record_artist</code>) in it, I'd like to add more rows or even remove them. For that I know there's <code>malloc</code> and <code>realloc</code>. I tried to play with it, making some tests and I don't know what's the best way of doing that.</p>\n\n<p>I tried to declare in my <code>main.c</code> file the following:</p>\n\n<pre><code>int main() {    \n    data_user.u_user = (user *)malloc(size * sizeof(user));\n    /***/\n}\n</code></pre>\n\n<p>but I also tried with this</p>\n\n<pre><code>int main() {\n    record_user = (user *)malloc(size * sizeof(user));\n    /***/\n}\n</code></pre>\n\n<p>but as I already imagined I lose all the preset data delcared in <code>data.c</code> file.</p>\n\n<h3>MY GOAL</h3>\n\n<p>What I'd like to achieve is to <code>malloc</code> <strong>a temp size</strong> for my data (for starting <strong>100</strong>) and then <strong>to link the array of structs (or the union struct), <em>with the starting temp size</em>, to my preset data</strong> in order for using them. Naturally, during runtime, I will add more rows, and for that I'll use <code>realloc</code> (or even remove them).\nThis is the sample code of my add function:</p>\n\n<pre><code>data *add_data(data *record_data) {\n    date record_date;\n    tm record_time;\n\n    switch (record_data-&gt;type) {\n    case USER:\n    {\n        /* SOMEWHERE HERE I should use realloc to my record_data */\n        int ID = record_data-&gt;size;\n        record_data-&gt;u_user[ID].id = ID;\n        printf(\"\\n\\n\\tNEW USER\");\n        printf(\"\\n\\tEnter name: \");\n        strcpy(record_data-&gt;u_user[ID].name, inputString(MIN_USER_NAME, MAX_USER_NAME));\n        printf(\"\\tEnter surname: \");\n        strcpy(record_data-&gt;u_user[ID].surname, inputString(MIN_USER_SURNAME, MAX_USER_SURNAME));\n        printf(\"\\tEnter email: \");\n        strcpy(record_data-&gt;u_user[ID].email, inputString(MIN_USER_EMAIL, MAX_USER_EMAIL));\n        printf(\"\\tEnter password: \");\n        strcpy(record_data-&gt;u_user[ID].password, inputString(MIN_PASSWORD_LENGTH, MAX_PASSWORD_LENGTH));\n        /* etc for birthday, subscription date */\n\n        record_data-&gt;size += 1;\n\n        printf(\"\\n\\tUser added!\");\n        return record_data;\n    }\n    case ARTIST:\n        /* asking for input data */\n\n        return record_data;\n    }\n}\n</code></pre>\n\n<p>this is how I call the function instead in the <code>main.c</code> file</p>\n\n<pre><code>int main() {\n    /***/\n    data_user = *add_data(&amp;data_user);\n    /***/\n}\n</code></pre>\n\n<p>I don't know how to move here, if I should work with the <em>struct</em> <code>record_user</code> or the <em>union struct</em> <code>data_user</code>. If it's the same or not... if I work with the original struct (allocating memory), is the union capable of <strong>reading the new memory size or not</strong>? Or is it best to work with the union struct leaving the original struct untouched?</p>\n\n<p>I hope someone clear my mind!</p>\n"}, {"tags": ["c", "image", "algorithm"], "comments": [{"owner": {"reputation": 2045, "user_id": 56688, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ee1220e0ff47d2ad071d6c377ada7965?s=128&d=identicon&r=PG", "display_name": "pritaeas", "link": "https://stackoverflow.com/users/56688/pritaeas"}, "edited": false, "score": 0, "creation_date": 1530691101, "post_id": 51168548, "comment_id": 89320049, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/9120065/best-way-to-compare-two-int-arrays-of-the-same-length\">Best way to compare two int arrays of the same length?</a>"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 1, "creation_date": 1530691509, "post_id": 51168548, "comment_id": 89320232, "body": "If the entire screen is black shouldn&#39;t <code>black_count</code> be equal to <code>100</code>. And why can&#39;t you just check every pixel?"}, {"owner": {"reputation": 3405, "user_id": 4001581, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wbDB6.jpg?s=128&g=1", "display_name": "Patrice Gahide", "link": "https://stackoverflow.com/users/4001581/patrice-gahide"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1530692084, "post_id": 51168548, "comment_id": 89320545, "body": "If you can&#39;t afford to check all the pixels and you have no other information regarding the possible entries, then randomization is your best bet. As it is, your algorithm will miss some patterns (and is wrong, as @AjayBrahmakshatriya pointed out). Moreover, you can improve it by exiting the loop as soon as a non-black pixel is found."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1530692699, "post_id": 51168548, "comment_id": 89320902, "body": "Do not loop 1000 times and then only do something every 10th step. Loop 100 times and multiply counter by 10 to get the index."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1530692776, "post_id": 51168548, "comment_id": 89320944, "body": "How many false positives or false negatives are you willing to tolerate. If the answer is &quot;none&quot; you cannot skip any pixel."}, {"owner": {"reputation": 144819, "user_id": 2836621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/suHg4.jpg?s=128&g=1", "display_name": "Mark Setchell", "link": "https://stackoverflow.com/users/2836621/mark-setchell"}, "edited": false, "score": 0, "creation_date": 1530695796, "post_id": 51168548, "comment_id": 89322747, "body": "If you are only checking for non-zero, you could probably use a wider (say 64 bit integer) datatype and check 8 pixels in one operation of same time duration..."}], "answers": [{"tags": [], "owner": {"reputation": 9079, "user_id": 73299, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/ae887ea49a5c212e2ab407d90eba4c8c?s=128&d=identicon&r=PG", "display_name": "tstenner", "link": "https://stackoverflow.com/users/73299/tstenner"}, "is_accepted": false, "score": 0, "last_activity_date": 1530695089, "creation_date": 1530695089, "answer_id": 51169823, "question_id": 51168548, "link": "https://stackoverflow.com/questions/51168548/i-want-check-black-screen-algorithm/51169823#51169823", "title": "I want check black screen algorithm", "body": "<p>You can view the <code>char[1000]</code> array as a <code>uint_fast8_t[1000 / sizeof(uint_fast8_t)]</code> array because if one of the char values is nonzero, any bigger data type will also be nonzero.</p>\n\n<p>If checking regular intervals works for you, you could try something like this:</p>\n\n<pre><code>#include &lt;stdint.h&gt;\n#include &lt;stdbool.h&gt;\n\nchar pixel[1000];\n\nint granularity = 10; // Lower: more pixels checked\nuint_fast8_t *start = (uint_fast8_t*) pixel;\nuint_fast8_t *end = start + (1000 / sizeof(uint_fast8_t) );\n\nbool black = true;\n\nfor(; start &lt; end; start += granularity) {\n    if(*start) {\n        black = false;\n        break;\n    }\n}</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7806207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e015d8d8e7d948bcbe91d598daa5f8d?s=128&d=identicon&r=PG&f=1", "display_name": "youngmin kang", "link": "https://stackoverflow.com/users/7806207/youngmin-kang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 92, "favorite_count": 1, "answer_count": 1, "score": -1, "last_activity_date": 1530754841, "creation_date": 1530690911, "last_edit_date": 1530754841, "question_id": 51168548, "link": "https://stackoverflow.com/questions/51168548/i-want-check-black-screen-algorithm", "title": "I want check black screen algorithm", "body": "<p><strong>Edited</strong> </p>\n\n<p>Dear Everyone.</p>\n\n<p>My code seems that making you confused.</p>\n\n<p>My question is, is it best to compare at regular intervals to check that the entire screen is black?</p>\n\n<p>I wonder there is another algorithm to check black-screen or there is not?</p>\n\n<p>Another questions, what will be the accuracy of my idea(granularity is 10)?</p>\n\n<p>SUPER Thanks!!</p>\n\n<p>===========================================================================</p>\n\n<p>I am a C language programmer.</p>\n\n<p>I want check black screen algorithm</p>\n\n<p>There is a screen.</p>\n\n<p>The screen consists of a total of 1000 pixels.\nIf the pixel is black, the pixel has a value of zero (0).</p>\n\n<p>The probability that a pixel is black is unknown.\nThis is because I don't know what screen will appear on the screen.</p>\n\n<p>I want to check only a few pixels to confirm if the entire screen is black or not</p>\n\n<p>I think I can get a rough idea of whether the entire screen is black or not.\nChoose one out of ten to see if it is black or not.\nRepeat the above.</p>\n\n<pre><code>char pixel[1000];\n\nfor (idx = 0; idx &lt; 1000; idx++) {\n  if (idx % 10 ==0) {\n    if (pixel[idx] == black)\n      black_count++;\n  }\n} \n\nif (black_count &gt; 0)\n  print(\"This screen black maybe\");\n</code></pre>\n\n<p>I think there is no other way.</p>\n\n<p>If you have any other comments, please answer them.</p>\n\n<p>Thanks.</p>\n\n<hr>\n\n<p>Dear pritaeas</p>\n\n<p>You say that Possible duplicate of Best way to compare two int arrays of the same length? </p>\n\n<p>But This question is in a different area.</p>\n\n<p>I use only one array.</p>\n\n<p>You are wrong.</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["c", "assembly", "instructions", "eflags"], "comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1530689763, "post_id": 51168010, "comment_id": 89319344, "body": "If you use <code>unsigned int</code>, you don&#39;t need <code>&amp; 1</code> after a shift.  (And as a bonus, it would avoid C signed-overflow undefined behaviour in <code>+</code>: <a href=\"http://blog.llvm.org/2011/05/what-every-c-programmer-should-know.html\" rel=\"nofollow noreferrer\">blog.llvm.org/2011/05/what-every-c-programmer-should-know.ht&zwnj;&#8203;ml</a>).  Or you can use <code>&amp; 0x80000000</code> to leave the high bits in place (and I guess left shift your <code>!</code> result).  Anyway, those are just ways to more efficiently do what you&#39;re already doing."}, {"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 0, "creation_date": 1530689860, "post_id": 51168010, "comment_id": 89319400, "body": "assuming two&#39;s complement, <code>INT_MIN</code>&#39;s absolute value isn&#39;t representable as an <code>int</code>. So, <code>yComplement == y</code> (ie. still negative), and <code>ySign</code> is <code>1</code> instead of <code>0</code>."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1530689969, "post_id": 51168010, "comment_id": 89319466, "body": "<b>You&#39;re detecting overflow in the addition <code>x + yComplement</code>, rather than in the overall subtraction</b>   <code>-INT_MIN</code> itself overflows, on a 2&#39;s complement system.   writing a full answer, will post soon."}, {"owner": {"reputation": 693, "user_id": 8510613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2f16dd862c8e1016f5ae3db1b224043?s=128&d=identicon&r=PG&f=1", "display_name": "user8510613", "link": "https://stackoverflow.com/users/8510613/user8510613"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1530691140, "post_id": 51168010, "comment_id": 89320062, "body": "@PeterCordes It&#39;s just the lab&#39;s restriction, you can&#39;t use unsigned or any constant larger than 0xff(255)"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1530691218, "post_id": 51168010, "comment_id": 89320104, "body": "lol, that&#39;s amusing that they force you to write it non-portably.  I guess you&#39;re supposed to assume that right shift of <code>int</code> is an arithmetic right shift?  So they deny you access to logical right shift?"}, {"owner": {"reputation": 693, "user_id": 8510613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2f16dd862c8e1016f5ae3db1b224043?s=128&d=identicon&r=PG&f=1", "display_name": "user8510613", "link": "https://stackoverflow.com/users/8510613/user8510613"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1530691589, "post_id": 51168010, "comment_id": 89320264, "body": "@PeterCordes exactly"}], "answers": [{"comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1530692597, "post_id": 51169010, "comment_id": 89320852, "body": "heh, just as a finished typing up my answer.  I got wrapped up in optimizing my own version of the function :P"}, {"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1530692680, "post_id": 51169010, "comment_id": 89320893, "body": "@PeterCordes : sorry - I assumed you got side tracked, but I wasn&#39;t counting on you coming up with the mother of all answers ;)"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1530692926, "post_id": 51169010, "comment_id": 89321011, "body": "Yeah, no worries.  And BTW, my answer is nowhere <i>near</i> the &quot;mother of all answers&quot;.  That would be <a href=\"https://stackoverflow.com/a/40355466\">Why is this C++ code faster than my hand-written assembly for testing the Collatz conjecture?</a> (which links to a bunch of other answer I&#39;ve written, so you could literally say it&#39;s the mother :P).  I also hit the 30k char limit on <a href=\"https://stackoverflow.com/a/32537772\">Memory-constrained external sorting of strings, with duplicates combined&amp;counted, on a critical server (billions of filenames)</a>, without any big code blocks or giant Godbolt links."}], "tags": [], "owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "is_accepted": false, "score": 3, "last_activity_date": 1530693376, "last_edit_date": 1530693376, "creation_date": 1530692530, "answer_id": 51169010, "question_id": 51168010, "link": "https://stackoverflow.com/questions/51168010/simulate-jg-instructiondatalabs-isgreater/51169010#51169010", "title": "simulate jg instruction(datalab&#39;s isGreater)", "body": "<p>Assuming two's complement, <code>INT_MIN</code>'s absolute value isn't representable as an <code>int</code>. So, <code>yComplement == y</code> (ie. still negative), and <code>ySign</code> is <code>1</code> instead of the desired <code>0</code>.</p>\n\n<p>You could instead calculate the sign of <code>y</code> like this (changing as little as possible in your code) :</p>\n\n<pre><code>int ySign = !((y &gt;&gt; 31) &amp; 0x1);\n</code></pre>\n\n<p>For a more detailed analysis, and a more optimal alternative, check <a href=\"https://stackoverflow.com/a/51169016/822669\">Peter Cordes' answer</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "is_accepted": true, "score": 4, "last_activity_date": 1530694382, "last_edit_date": 1592644375, "creation_date": 1530692552, "answer_id": 51169016, "question_id": 51168010, "link": "https://stackoverflow.com/questions/51168010/simulate-jg-instructiondatalabs-isgreater/51169016#51169016", "title": "simulate jg instruction(datalab&#39;s isGreater)", "body": "<p><strong>You're detecting overflow in the addition <code>x + yComplement</code>, rather than in the overall subtraction</strong></p>\n<p><code>-INT_MIN</code> itself overflows in 2's complement; <code>INT_MIN == -INT_MIN</code>.  This is <a href=\"https://en.wikipedia.org/wiki/Two%27s_complement#Most_negative_number\" rel=\"nofollow noreferrer\">the 2's complement anomaly</a><sup>1</sup>.</p>\n<p>You should be getting fast-positive overflow detection for any negative number (other than <code>INT_MIN</code>) minus <code>INT_MIN</code>.  The resulting addition will have signed overflow.  e.g. <code>-10 + INT_MIN</code> overflows.</p>\n<p><a href=\"http://teaching.idallen.com/dat2343/10f/notes/040_overflow.txt\" rel=\"nofollow noreferrer\">http://teaching.idallen.com/dat2343/10f/notes/040_overflow.txt</a> has a table of input/output signs for add and subtraction.  The cases that overflow are where the inputs signs are opposite but the result sign matches <code>y</code>.</p>\n<pre><code>      SUBTRACTION SIGN BITS  (for num1 - num2 = sum)\n    num1sign num2sign sumsign\n   ---------------------------\n        0 0 0\n        0 0 1\n        0 1 0\n *OVER* 0 1 1 (subtracting a negative is the same as adding a positive)\n *OVER* 1 0 0 (subtracting a positive is the same as adding a negative)\n        1 0 1\n        1 1 0\n        1 1 1\n</code></pre>\n<p>You could use this directly with the original <code>x</code> and <code>y</code>, and only use <code>yComplement</code> as part of getting the <code>minusResult</code>.  Adjust your logic to match this truth table.</p>\n<p><strong>Or you could use <code>int ySign = (~y) &gt;&gt; 31;</code> and leave the rest of your code unmodified</strong>.  (Use a tmp to hold <code>~y</code> so you only do the operation once, for this and <code>yComplement</code>).  The one's complement inverse (<code>~</code>) does not suffer from the 2's complement anomaly.</p>\n<hr />\n<p><strong>Footnote 1</strong>: sign/magnitude and one's complement have two redundant ways to represent 0, instead of an value with no inverse.</p>\n<p>Fun fact: if you make an integer absolute-value function, you should consider the result <code>unsigned</code> to avoid this problem.  <code>int</code> can't represent the absolute value of <code>INT_MIN</code>.</p>\n<hr />\n<h1>Efficiency improvements:</h1>\n<p>If you use <code>unsigned int</code>, you don't need <code>&amp; 1</code> after a shift because logical shifts don't sign-extend.  (And as a bonus, it would avoid C signed-overflow undefined behaviour in <code>+</code>: <a href=\"http://blog.llvm.org/2011/05/what-every-c-programmer-should-know.html\" rel=\"nofollow noreferrer\">http://blog.llvm.org/2011/05/what-every-c-programmer-should-know.html</a>).</p>\n<p>Then (if you used <code>uint32_t</code>, or <code>sizeof(unsigned) * CHAR_BIT</code> instead of 31) you'd have a safe and portable implementation of 2's complement comparison.  (signed shift semantics for negative numbers are implementation-defined in C.)  I think you're using C as a sort of pseudo-code for bit operations, and aren't interested in actually writing a portable implementation, and that's fine.  The way you're doing things will work on normal compilers on normal CPUs.</p>\n<p>Or you can use <code>&amp; 0x80000000</code> to leave the high bits in place (but then you'd have to left shift your <code>!</code> result).</p>\n<blockquote>\n<p>It's just the lab's restriction, you can't use unsigned or any constant larger than 0xff(255)</p>\n</blockquote>\n<p>Ok, so you don't have access to logical right shift.  Still, you need at most one <code>&amp;1</code>.  It's ok to work with numbers where all you care about is the low bit, but where the rest hold garbage.</p>\n<p>You eventually do <code>&amp; !ZF</code>, which is either <code>&amp;0</code> or &amp;1<code>.  Thus, any high garbage in </code>OF` is wiped away.</p>\n<p>You can also delay the <code>&gt;&gt; 31</code> until after XORing together two numbers.</p>\n<hr />\n<h3>This is a fun problem that I want to optimize myself:</h3>\n<pre><code>// untested, 13 operations\nint isGreater_optimized(int x, int y)\n{\n    int not_y = ~y;\n    \n    int minus_y = not_y + 1;\n    int sum = x + minus_y;\n\n    int x_vs_y = x ^ y;       // high bit = 1 if they were opposite signs: OF is possible\n    int x_vs_sum = x ^ sum;   // high bit = 1 if they were opposite signs: OF is possible\n\n    int OF = (x_vs_y &amp; x_vs_sum) &gt;&gt; 31;   // high bits hold garbage\n    int SF = sum &gt;&gt; 31;\n\n    int non_zero = !!sum;              // 0 or 1\n    return (~(OF ^ SF)) &amp; non_zero;      // high garbage is nuked by `&amp; 1`\n}\n</code></pre>\n<p>Note the use of <code>~</code> instead of <code>!</code> to invert a value that has high garbage.</p>\n<p>It looks like there's still some redundancy in calculating OF separately from SF, but actually the XORing of sum twice doesn't cancel out.  <code>x ^ sum</code> is an input for <code>&amp;</code>, and we XOR with sum after that.</p>\n<p>We can delay the shifts even later, though, and I found some more optimizations by avoiding an extra inversion.  <strong>This is 11 operations</strong></p>\n<pre><code>// replace 31 with  sizeof(int) * CHAR_BIT  if you want.  #include &lt;limit.h&gt;\n// or use int32_t\n\nint isGreater_optimized2(int x, int y)\n{\n    int not_y = ~y;\n\n    int minus_y = not_y + 1;\n    int sum = x + minus_y;\n    int SF = sum;             // value in the high bit, rest are garbage\n\n    int x_vs_y = x ^ y;       // high bit = 1 if they were opposite signs: OF is possible\n    int x_vs_sum = x ^ sum;   // high bit = 1 if they were opposite signs: OF is possible\n    int OF = x_vs_y &amp; x_vs_sum;   // low bits hold garbage\n\n    int less = (OF ^ SF);\n    int ZF   = !sum;               // 0 or 1\n    int le   = (less &gt;&gt; 31) &amp; ZF;  // clears high garbage\n    return  !le;                   // jg == jnle\n}\n</code></pre>\n<p>I wondered if any compilers might see through this manual compare and optimize it into <code>cmp edi, esi</code>/ <code>setg al</code>, but no such luck :/  I guess that's not a pattern that they look for, because code that could have been written as <code>x &gt; y</code> tends to <em>be</em> written that way :P</p>\n<p>But anyway, here's <a href=\"https://gcc.godbolt.org/#z:OYLghAFBqd5QCxAYwPYBMCmBRdBLAF1QCcAaPECAKxAEZSAbAQwDtRkBSAJgCFufSAZ1QBXYskwgA5HhYEA1HkEBxYpiYFMxAPqoADgTwBbPAC9M6CLIUAPUornyAngEoOABgCCHAOx8v8oEOCiyoBNpO8hwAzAAi8gB%2BTjH%2B3gFB1vImLCKCEVFx8qHhkfzytCkenkHB8oIiRgXxNlG8WbK5EZVeVTWZNtoAbnmlhS0cAKzYzik1QQD08/IIeMAI8gBGhE3ligBm8gQImJEA7lqY8vp6qIKEl3fALIIg8gDyAGKKgvI3gncbBiYXoZRwDYbaeqNGLNKJTOoNWaBRbLVbrLYKGG7PAHI4neTnNRXPR/e51VbPV6fb6/W4AoFVEGBTLUrEQcEjVoANnkHMhDRcBWwMWm0Qq0R4CyWKzWm0IPwQqAY6HkwCYxA2TGAwPSzMcAGUvlioUKRfIxd00tVQSFUCxtOZiKgdmBXWAoUi5l75Cj3FdiOUmfI1AQxCx5BAEhBWfDDS5BdweaF7Y7UJ6pajZWqNVrLkoiiIANYWTalLnuROB8uMnyxRleTJKVTqTQ6fSGEzmdBcKxg%2ByZVw11J9RzFfJYpKWoOZbKdUbxMelNri4c2hHQsatSWzkaWkcKQ07D0S71elGDJgMER58N4zPowj2NSCBTqy7ZzXa%2BvWvW2IacrFxnhZITzPaU0TlTFClofZDmOM4LmJUlNHJJ4XneL58z%2BekdR/Wo%2BRNQC4WmY9JWRcDZQxHYYJxOD8UJS5rluMlHkpDCaWwvBAVw/d2MA/9xy4HkCMRUCfSWBhUFOSCFSVFUP1zb9eKBf4dmjI1Yw%2BNwJWnRwAC0vkCLFXVI09vV9f1A11WogSCNkVJ%2BEUzTFBMhPkAykRRZAgXVBUIIUr9rJDMNAldBkxLM8ylioYAmixKgWAZHpayqKQXEYaQJikUgWGkdxstQaQAGF%2BDKYQxAkVoxWygg8rS9LCxAaIfAAOloLgJncaJoncABOAAWLr%2Btofr%2BoyqR%2Buyow6Hcdwcrq0hCqkbKXjm2qpHy9K4FgJA0CMPQ8CBMgKAgPaDqOlBmDYcs5r2Q7WxeCANgWrYWHVJxpFobK9qMTA5DeRKPo27KsCMVhgCBBb8DUZBDEGTAXmB0hMBsTBkBETRPuy6xMAYBaCGIYwsfSq72FK3hGC4l5IHS9s8DtRGAFoAHVLwYeRGbeaIVtEcRJFoEnMuy3KkaWmwAA4uUZrl%2BvkbzwfkLkWvcZWI1wQgSCq%2Bh5CK1B9sOrQtcFEreH4Gq6vjUhGq4XqWq4Hx2t6mWevLfquH6iZxsm0hptoWb5tF6QVpANaLdIbbEBQPXzq0chKDOg3iBAYBxfoO6GAeyhnqR173qx0gfr%2BggAYYIH8tIUHwchpHobRuGEYWlG0YxyQpC%2B8g5Fx/HCemtu0sYcGUHJgQGCp%2BBaYMenKSkTnuaEXmJDoQWpCygPy7FyXpdl4BkGQeRxbatX8CIANuDFexdf1o6qq4Y3h/N4HLeOJgsCTiAGqa6IWvLaIuR8dx%2Bo%2BAmL/WgXJ6B4wmsLBaS1g6h0fsvLgUDA7LVIOtTa6V4bEDuHaEA/UgA%3D\" rel=\"nofollow noreferrer\">the x86 asm output from gcc and clang on the Godbolt compiler explorer.</a></p>\n"}], "owner": {"reputation": 693, "user_id": 8510613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2f16dd862c8e1016f5ae3db1b224043?s=128&d=identicon&r=PG&f=1", "display_name": "user8510613", "link": "https://stackoverflow.com/users/8510613/user8510613"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 340, "favorite_count": 0, "accepted_answer_id": 51169016, "answer_count": 2, "score": 5, "last_activity_date": 1530694382, "creation_date": 1530689012, "question_id": 51168010, "link": "https://stackoverflow.com/questions/51168010/simulate-jg-instructiondatalabs-isgreater", "title": "simulate jg instruction(datalab&#39;s isGreater)", "body": "<p>I am doing CSAPP's datalab, the isGreater function.\n<br>\nHere's the description</p>\n\n<pre><code>isGreater - if x &gt; y  then return 1, else return 0\n   Example: isGreater(4,5) = 0, isGreater(5,4) = 1\n   Legal ops: ! ~ &amp; ^ | + &lt;&lt; &gt;&gt;\n   Max ops: 24\n   Rating: 3\n</code></pre>\n\n<p>x and y are both int type.\n<br>\nSo i consider to simulate the jg instruction to implement it.Here's my code</p>\n\n<pre><code>int isGreater(int x, int y)\n{\n    int yComplement = ~y + 1;\n    int minusResult = x + yComplement;  // 0xffffffff\n    int SF = (minusResult &gt;&gt; 31) &amp; 0x1; // 1\n    int ZF = !minusResult; // 0\n    int xSign = (x &gt;&gt; 31) &amp; 0x1; // 0 \n    int ySign = (yComplement &gt;&gt; 31) &amp; 0x1; // 1\n    int OF = !(xSign ^ ySign) &amp; (xSign ^ SF); // 0\n    return !(OF ^ SF) &amp; !ZF;\n}\n</code></pre>\n\n<p>The jg instruction need SF == OF and ZF == 0.\n<br>\nBut it can't pass a special case, that is, x = 0x7fffffff(INT_MAX), y = 0x80000000(INT_MIN).\n<br>\nI deduce it like this:\n<br>\nx + yComplement = 0xffffffff,  so SF = 1, ZF = 0, since xSign != ySign, the OF is set to 0.\n<br>\nSo, what's wrong with my code, is my OF setting operation wrong?</p>\n"}, {"tags": ["c", "multidimensional-array", "segmentation-fault"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1530682061, "post_id": 51166274, "comment_id": 89315707, "body": "If you have an array of <code>A</code> elements, what is the maximum valid index of that array? Please try to use some <a href=\"https://en.wikipedia.org/wiki/Rubber_duck_debugging\" rel=\"nofollow noreferrer\">ruibber duck debugging</a> with your code (or <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">learn how to debug your progrma in general</a>), and think about that that loop where you &quot;clear&quot; all elements. Is e.g. <code>p[A][B][B]</code> valid?"}], "answers": [{"comments": [{"owner": {"reputation": 855, "user_id": 3659239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3b6ed436c73d42ba39748209936b7e7?s=128&d=identicon&r=PG&f=1", "display_name": "Sandy", "link": "https://stackoverflow.com/users/3659239/sandy"}, "reply_to_user": {"reputation": 1, "user_id": 10027634, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216600900724827/picture?type=large", "display_name": "Gn Pal", "link": "https://stackoverflow.com/users/10027634/gn-pal"}, "edited": false, "score": 0, "creation_date": 1531114158, "post_id": 51166512, "comment_id": 89456200, "body": "@GnPal you can share it, maybe we can help."}], "tags": [], "owner": {"reputation": 855, "user_id": 3659239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3b6ed436c73d42ba39748209936b7e7?s=128&d=identicon&r=PG&f=1", "display_name": "Sandy", "link": "https://stackoverflow.com/users/3659239/sandy"}, "is_accepted": false, "score": 0, "last_activity_date": 1530683075, "creation_date": 1530683075, "answer_id": 51166512, "question_id": 51166274, "link": "https://stackoverflow.com/questions/51166274/why-segmentation-fault-and-program-finished-with-exit-code-139/51166512#51166512", "title": "Why segmentation fault and Program finished with exit code 139?", "body": "<p>You are trying to access memory which has not been allocated to you.</p>\n\n<p>At line 17: Space allocated to m is <code>C*sizeof(double*)</code></p>\n\n<pre><code>double ** m = (double **)malloc(C*sizeof(double*));\n</code></pre>\n\n<p>but later line 46 you are trying to access:</p>\n\n<pre><code>m[C][B] = 0;\n</code></pre>\n\n<p>which is a problem since you can access only till <code>m[C-1]</code></p>\n"}], "owner": {"reputation": 1, "user_id": 10027634, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216600900724827/picture?type=large", "display_name": "Gn Pal", "link": "https://stackoverflow.com/users/10027634/gn-pal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2516, "favorite_count": 0, "answer_count": 1, "score": -6, "last_activity_date": 1530689366, "creation_date": 1530681789, "last_edit_date": 1530689366, "question_id": 51166274, "link": "https://stackoverflow.com/questions/51166274/why-segmentation-fault-and-program-finished-with-exit-code-139", "title": "Why segmentation fault and Program finished with exit code 139?", "body": "<p>I try to calculate retrospectively functions about possibilities with c language and write the result to a text. The result running my program with code blocks 17.12 is:</p>\n\n<pre><code>\"Linking stage skipped (build target has no object files to link\" and\n\"Nothing to be done (all items are up-to-date)\"\n</code></pre>\n\n<p>Also, i try running this code with online compiler(<a href=\"https://www.onlinegdb.com/online_c_compiler\" rel=\"nofollow noreferrer\">https://www.onlinegdb.com/online_c_compiler</a>) and the result was:\n\"Segmentation fault\" and \"Program finished with exit code 139\"</p>\n\n<p>I believe that my problem is about memory allocate with 3D and 2D Multidimensional arrays.</p>\n\n<p>Please help me!!</p>\n\n<p>The code is:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;math.h&gt;\n\nint main()\n{\n    double z[7] = { 0, 19.08, 16.86, 11.72, 14.49, 10.87, 11.63 };\n    int N, k, i, j, l, fptr;\n    int A = 6, B = 544, C = 7;\n\n    double *** p = (double ***) malloc(A * sizeof(double**));\n    double *** X = (double ***) malloc(A * sizeof(double**));\n    double *** R = (double ***) malloc(A * sizeof(double**));\n    double ** sum = (double **) malloc(A * sizeof(double*));\n    double ** sum2 = (double **) malloc(A * sizeof(double*));\n    double ** m = (double **) malloc(C * sizeof(double*));\n\n    for (i = 0; i &lt; A; i++)\n    {\n        p[i] = (double **) malloc(B * sizeof(double *));\n        X[i] = (double **) malloc(B * sizeof(double *));\n        R[i] = (double **) malloc(B * sizeof(double *));\n\n        for (j = 0; j &lt; B; j++)\n        {\n            p[i][j] = (double *) malloc(B * sizeof(double));\n            X[i][j] = (double *) malloc(B * sizeof(double));\n            R[i][j] = (double *) malloc(B * sizeof(double));\n            sum[i] = (double *) malloc(B * sizeof(double));\n            sum2[i] = (double *) malloc(B * sizeof(double));\n        }\n    }\n\n    for (i = 0; i &lt; C; i++)\n    {\n        m[i] = (double *) malloc(B * sizeof(double));\n    }\n    for (i = 1; i &lt; 7; ++i)\n    {\n        for (N = 1; N &lt; 545; ++N)\n        {\n            for (k = 0; k &lt; N + 1; ++k)\n            {\n                m[C][B] = 0;\n                p[A][B][B] = 0;\n                X[A][B][B] = 0;\n                R[A][B][B] = 0;\n                sum2[A][B] = 0;\n                sum[A][B] = 0;\n            }\n        }\n    }\n    for (i = 1; i &lt; 7; ++i)\n    {\n        p[i][0][0] = 1;\n        for (N = 1; N &lt; 545; ++N)\n        {\n            for (k = 0; k &lt; N + 1; ++k)\n            {\n                if (k == 0)\n                {\n                    for (l = 1; l &lt; N + 1; ++l)\n                    {\n                        p[i][l][N] = pow(0.5 * N / 544, l);\n                        sum[i][N] += p[i][l][N];\n                    }\n                    p[i][k][N] = 1 - sum[i][N];\n                }\n                if (k != 0)\n                {\n                    p[i][k - 1][N - 1] = pow(0.5 * (N) / 544, k - 1);\n                    m[i][k] = k * z[i];\n                    X[i][k][N] = p[i][k][N] * m[i][k] / p[i][k - 1][N - 1];\n                    // m[i][k] = X[i][N] * p[i][k-1][N-1] / p[i][k][N];\n                    printf(\"X = %.2lf\", X[i][k][N]);\n                    sum2[i][N] += k * p[i][k - 1][N - 1] / m[i][k];\n                }\n                if (k == N)\n                {\n                    R[i][k][N] = m[i][k] * sum2[i][N];\n                    printf(\"R = %.2lf\", R[i][k][N]);\n                }\n            }\n        }\n    }\n    for (i = 1; i &lt; 7; ++i)\n    {\n        for (N = 1; N &lt; 545; ++N)\n        {\n            for (k = 0; k &lt; N + 1; ++k)\n            {\n                FILE *fptr;\n                fptr = fopen(\"C:\\\\program.txt\", \"w\");\n\n                if (fptr == NULL)\n                {\n                    printf(\"Error!\");\n                    exit(1);\n                }\n                fprintf(fptr, \"%.21f\", X[i][k][N]);\n                fprintf(fptr, \"%.21f\", R[i][k][N]);\n\n                fclose(fptr);\n            }\n        }\n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "windows", "visual-studio", "dll"], "comments": [{"owner": {"reputation": 469, "user_id": 6697909, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-bTsdnRIJmcs/AAAAAAAAAAI/AAAAAAAAAoM/L5MXTaZ02S0/photo.jpg?sz=128", "display_name": "Jeong Yo Han", "link": "https://stackoverflow.com/users/6697909/jeong-yo-han"}, "edited": false, "score": 0, "creation_date": 1530679735, "post_id": 51165906, "comment_id": 89314986, "body": "why I wrote my post&#39;s title with &quot;20MB&quot; word is It usually stops after 2000~ 8000 array size allocation . 5000 * 4BYTE = 20,000BYTE = 20MB approximately. Sorry for ambiguity"}], "answers": [{"comments": [{"owner": {"reputation": 469, "user_id": 6697909, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-bTsdnRIJmcs/AAAAAAAAAAI/AAAAAAAAAoM/L5MXTaZ02S0/photo.jpg?sz=128", "display_name": "Jeong Yo Han", "link": "https://stackoverflow.com/users/6697909/jeong-yo-han"}, "edited": false, "score": 0, "creation_date": 1530680321, "post_id": 51165979, "comment_id": 89315171, "body": "Real thanks!! . I made what a fool mistake... with out your comment , i would spend lots of time on this problem real thankx"}], "tags": [], "owner": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "is_accepted": true, "score": 4, "last_activity_date": 1530680004, "creation_date": 1530680004, "answer_id": 51165979, "question_id": 51165906, "link": "https://stackoverflow.com/questions/51165906/memory-allocation-size-upper-bound-20mb-in-my-dll/51165979#51165979", "title": "memory allocation size upper bound 20MB in my dll", "body": "<p><code>Mmalloc</code> is allocating 4 or 8 ints (depending on the value of <code>sizeof(n)</code> on your system), not <code>n</code> ints. Your program then exhibits undefined behavior by way of a buffer overrun.</p>\n"}], "owner": {"reputation": 469, "user_id": 6697909, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-bTsdnRIJmcs/AAAAAAAAAAI/AAAAAAAAAoM/L5MXTaZ02S0/photo.jpg?sz=128", "display_name": "Jeong Yo Han", "link": "https://stackoverflow.com/users/6697909/jeong-yo-han"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 1, "accepted_answer_id": 51165979, "answer_count": 1, "score": 0, "last_activity_date": 1530680065, "creation_date": 1530679521, "last_edit_date": 1530680065, "question_id": 51165906, "link": "https://stackoverflow.com/questions/51165906/memory-allocation-size-upper-bound-20mb-in-my-dll", "title": "memory allocation size upper bound 20MB in my dll", "body": "<p>I'm Having trouble with creating my own DLL (for academic..).</p>\n\n<p>In DLL project's header(compile option is \"C\"),\nI declared three function to export </p>\n\n<pre><code>// in dll1 header\n\n#pragma once\n\n#ifdef MYDLL\n#define MYDLL_API __declspec(dllexport)\n#else\n#define MYDLL_API __declspec(dllimport)\n#endif\n\n\nMYDLL_API int Mmalloc(int**, int);\nMYDLL_API int Mfree(int**);\nMYDLL_API int Arrsum(int*, int);\n</code></pre>\n\n<p>they are just easy function.</p>\n\n<p>and in DLL .C</p>\n\n<pre><code> //in dll.c \n\n#include \"dll1.h\"\n#include &lt;stdlib.h&gt;\n\nint Mmalloc(int** mem, int n) // just memory Allocation\n{\n    *mem = (int*)malloc(sizeof(n)*sizeof(int));\n    if (*mem) return 1; // if succeed return 1\n    return 0;           // or return zero\n};\n\nint Mfree(int** mem) // just memory Free\n{\n    free(*mem);\n    return 1;\n}\n\nint Arrsum(int* arr, int n) // just some operate\n{\n    int sum = 0;\n    for (int i = 0; i &lt; n; i++)\n    {\n        sum += arr[i];\n    }\n    return sum;\n}\n</code></pre>\n\n<p>with \"Preprocess Define\"-> \"MYDLL\" and also \"Runtime Library\"->\"/MD\"\nI build it.</p>\n\n<p>and I create another project (compile Option \"default (c++)\")\nadd add header from DLL header add extern \"C\"</p>\n\n<pre><code>#pragma once\n\n#ifdef MYDLL\n#define MYDLL_API __declspec(dllexport)\n#else\n#define MYDLL_API __declspec(dllimport)\n#endif\n\n\nextern \"C\"\n{\n    MYDLL_API int Mmalloc(int**, int);\n    MYDLL_API int Mfree(int**);\n    MYDLL_API int Arrsum(int*, int);\n}\n</code></pre>\n\n<p>and I also made main.cpp</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include \"dll1.h\"\n\n#define SZ 1000\n\nint main()\n{\n    int* arr=0;\n    int cnt = 0;\n    while (1)\n    {\n        int ret = Mmalloc(&amp;arr, SZ);\n        printf(ret ? \"YES\\n\" : \"NO\\n\");\n\n        for (int i = 1; i &lt;= SZ; i++)\n        {\n            arr[i - 1] = i;\n            printf(\"%d\\n\", arr[i - 1]);\n        }\n\n        printf(\"%d\\n\", Arrsum(arr, SZ));\n\n        printf(\"cnt : %d\\n\", ++cnt);\n        Mfree(&amp;arr);\n    }\n};\n</code></pre>\n\n<p>and I place *.dll, *.lib file place in a right folder.\nIt seems work well for me just moment, but i found huge error.</p>\n\n<p>I used <code>while(1)</code> syntax in main.cpp.\nso my program should work as long as It could, but It stops at some points.</p>\n\n<p>I couldn't figure out what is a real problem.</p>\n\n<p>I changed heaps reserve size in .dll project, and also in main.cpp project</p>\n\n<p>but my main program always stops. </p>\n\n<p>In debug mode, It stops \n<img src=\"https://i.stack.imgur.com/wiXtj.png\" alt=\".dll, break point trigger\"></p>\n\n<p>or with more size (SZ 10000~100000) I have an access violation\n<img src=\"https://i.stack.imgur.com/53irb.png\" alt=\"access violation\"></p>\n\n<p>Please help me.. I can't even imagine what the real problem is.</p>\n\n<p>Is there some syntax error  in dll? (memory allocation in function?)\nor \na Compiler Issue? , Windows? or what?... </p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 9286, "user_id": 425756, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Jsf1p.jpg?s=128&g=1", "display_name": "Justin Meiners", "link": "https://stackoverflow.com/users/425756/justin-meiners"}, "edited": false, "score": 1, "creation_date": 1530674708, "post_id": 51165296, "comment_id": 89313877, "body": "A counter, like you mentioned could be a good solution. This is what databases use. Just save the state between sessions."}, {"owner": {"reputation": 325, "user_id": 9900875, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-rhxM-SVSbsQ/AAAAAAAAAAI/AAAAAAAAAFo/n1-jj0Xou34/photo.jpg?sz=128", "display_name": "OregonJim", "link": "https://stackoverflow.com/users/9900875/oregonjim"}, "edited": false, "score": 2, "creation_date": 1530678685, "post_id": 51165296, "comment_id": 89314696, "body": "&quot;smallest number of characters&quot; depends on the size of your character set - numbers only [0-9]? Alphanumeric [0-9][a-z][A-Z]?  Something else?"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "reply_to_user": {"reputation": 325, "user_id": 9900875, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-rhxM-SVSbsQ/AAAAAAAAAAI/AAAAAAAAAFo/n1-jj0Xou34/photo.jpg?sz=128", "display_name": "OregonJim", "link": "https://stackoverflow.com/users/9900875/oregonjim"}, "edited": false, "score": 0, "creation_date": 1530691798, "post_id": 51165296, "comment_id": 89320380, "body": "^^ what @OregonJim says.  Once you have defined your character set, you can count the number of chars and just use a calculator to multiply up until you reach your &#39;100 billion&#39; limit.  The [number of mults]+1 gives the number of chars needed to uniquely identify those users."}], "answers": [{"tags": [], "owner": {"reputation": 2476, "user_id": 5931673, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/aTpXN.jpg?s=128&g=1", "display_name": "ajxs", "link": "https://stackoverflow.com/users/5931673/ajxs"}, "is_accepted": false, "score": 3, "last_activity_date": 1530674977, "creation_date": 1530674977, "answer_id": 51165350, "question_id": 51165296, "link": "https://stackoverflow.com/questions/51165296/how-to-generate-unique-ids-in-c/51165350#51165350", "title": "How to generate unique ids in C", "body": "<p>This depends entirely on what kind of functionality you expect from this id, do you intend for these id's to correlate with persisted data, such as a database? If this is the case, it might be more prudent to let the database handle the unique ID generation for you. Otherwise, using sequential values such as 1,2,3... etc would probably be ideal. <code>unsigned long</code> will keep you covered for the first 2 billion users... If you somehow go beyond that, you can rethink your data storage then.\nThe question is very broad.</p>\n"}], "owner": {"reputation": 9, "user_id": 9542882, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56f6ea0c58471d295a251fa80321491a?s=128&d=identicon&r=PG&f=1", "display_name": "Adou", "link": "https://stackoverflow.com/users/9542882/adou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 608, "favorite_count": 0, "closed_date": 1530687685, "answer_count": 1, "score": -8, "last_activity_date": 1530674977, "creation_date": 1530674470, "question_id": 51165296, "link": "https://stackoverflow.com/questions/51165296/how-to-generate-unique-ids-in-c", "closed_reason": "Needs more focus", "title": "How to generate unique ids in C", "body": "<p>I am developing an app which requires to generate an id for new users I want to do it with the smallest number of characters that allows me to create 100 billion diferent possible ids so how should I do that and how to avoid giving two users the same it? Should I look if that id exists? Should I use a random id generator or give ids in order like 001 002 and so on?</p>\n"}, {"tags": ["python", "c", "python-2.7", "typeerror", "ctypes"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1530677122, "post_id": 51164980, "comment_id": 89314324, "body": "Ruven Guna,  Review <a href=\"https://stackoverflow.com/help/someone-answers\">stackoverflow.com/help/someone-answers</a>  Post rolled back"}], "answers": [{"comments": [{"owner": {"reputation": 404, "user_id": 9966212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97d3d5fa55149a03b87c7c42a5f5ccb5?s=128&d=identicon&r=PG&f=1", "display_name": "Ruven Guna", "link": "https://stackoverflow.com/users/9966212/ruven-guna"}, "edited": false, "score": 0, "creation_date": 1530676597, "post_id": 51165271, "comment_id": 89314196, "body": "I just realized that there is an issue with my computer and that it was not saving the C files. I have managed to solve that and I am now able to run the program. I cannot delete this question as stackoverflow has given me a warning about deleting answered questions. Thank you for taking the time to answer my question."}], "tags": [], "owner": {"reputation": 14947, "user_id": 900078, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/83stK.jpg?s=128&g=1", "display_name": "pynexj", "link": "https://stackoverflow.com/users/900078/pynexj"}, "is_accepted": true, "score": 0, "last_activity_date": 1530674214, "creation_date": 1530674214, "answer_id": 51165271, "question_id": 51164980, "link": "https://stackoverflow.com/questions/51164980/ctypes-pass-float-into-function-returns-random-numbers/51165271#51165271", "title": "Ctypes pass float into function returns random numbers", "body": "<p>Using <code>c_float</code> for <code>argtypes</code> and <code>c_int</code> for <code>restype</code> works for me:</p>\n\n<p><strong>foo.c:</strong></p>\n\n<pre><code>int\nfoo(const char* dir, float a, float b, float c, float d )\n{\n    printf(\"%s\\n\", dir);\n    printf(\"%f\\n\", a);\n    printf(\"%f\\n\", b);\n    printf(\"%f\\n\", c);\n    printf(\"%f\\n\", d);\n\n    return 0;\n}\n</code></pre>\n\n<p>With Python 2.7:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>&gt;&gt;&gt; f = ctypes.CDLL('./foo.so')\n&gt;&gt;&gt; f.foo.argtypes = [ctypes.c_char_p, ctypes.c_float, ctypes.c_float, ctypes.c_float, ctypes.c_float]\n&gt;&gt;&gt; f.foo.restype = ctypes.c_int\n&gt;&gt;&gt; f.foo('hello', 1.0, 1.1, 1.2, 1.3)\nhello\n1.000000\n1.100000\n1.200000\n1.300000\n0\n&gt;&gt;&gt;\n</code></pre>\n"}], "owner": {"reputation": 404, "user_id": 9966212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97d3d5fa55149a03b87c7c42a5f5ccb5?s=128&d=identicon&r=PG&f=1", "display_name": "Ruven Guna", "link": "https://stackoverflow.com/users/9966212/ruven-guna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 996, "favorite_count": 0, "accepted_answer_id": 51165271, "answer_count": 1, "score": 1, "last_activity_date": 1530677040, "creation_date": 1530671078, "last_edit_date": 1530677040, "question_id": 51164980, "link": "https://stackoverflow.com/questions/51164980/ctypes-pass-float-into-function-returns-random-numbers", "title": "Ctypes pass float into function returns random numbers", "body": "<p>To give some background, I am using linux and I have a C code as follows:</p>\n\n<pre><code>int c_func(const char* dir, float a, float b, float c, float d )\n{\n    printf(\"%s\\n\", dir);\n    printf(\"%f\\n\",a);\n    printf(\"%f\\n\",b);\n    printf(\"%f\\n\",c);\n    printf(\"%f\\n\",d);\n\n    return 0;\n}\n</code></pre>\n\n<p>This is a simple function that takes in a string and 4 floats as arguments and prints them out as I am trying to test my phython/C interface. My python code is as follows:</p>\n\n<pre><code>calling_function = ctypes.CDLL(\"/home/ruven/Documents/Sonar/C interface/Interface.so\")\ncalling_function.c_func.argtypes = [ctypes.c_char_p, ctypes.c_float, ctypes.c_float, ctypes.c_float, ctypes.c_float]\ncalling_function.c_func.restype =  ctypes.c_float\n\nfor _fv in _testFV:\n                _predOut = calling_function.c_func(\"hello\",_fv[0], _fv[1], _fv[2], _fv[3])\n                exit(1)\n</code></pre>\n\n<p>To clarify, <code>_fv[0], _fv[1], _fv[2], _fv[3]</code> are <code>[1.969591, 112.7779, 1.8701470000000002, 111.7575]</code> respectively. And _testFV is a list of 117 other lists. I am just looking to extract the first list from _testFV.</p>\n\n<p>After running this code, I am able to correctly print the string but the floats seem to be large random numbers (1849375168, 3, 4805786, 9397952) instead of the actual values of <code>_fv[0], _fv[1], _fv[2], _fv[3]</code>. So to check if I am passing the right values into the <code>calling_function.c_func</code> function,I included a print statement to print the value of <code>_fv[0], _fv[1], _fv[2], _fv[3]</code> and their types. I checked and the values are floats and the correct numbers are being inputted into the function but random numbers are being printed out. I thought that I might have declared restype wrongly, but I thought that restype should be declared as int as the C code returns 0.</p>\n\n<p>Question 1: Why does the function print out random numbers instead of the floats that I input into the function.</p>\n\n<p>Question 2: The function is supposed to print out 1 string and 4 floats so am I supposed to declare restype as 1 string and 4 floats?</p>\n\n<p>Things I have tried:</p>\n\n<ol>\n<li><p>Changing all the float variables to doubles.</p></li>\n<li><p>Changing restype to int and double. </p></li>\n<li><p>Changing the arguments of <code>calling_function.c_func</code> in python to <code>(\"hello\",1,2,3,4)</code> and the function in python is able to print out the correct values. When I change the arguments to (\"hello\",1.2,2.3,3.4,4.3), it gives me random numbers again. I believe that there is some type declaration that I have done wrongly but I am not sure what. </p></li>\n<li><p>Changing restype line to <code>calling_function.c_func.restype = [ctypes.c_char_p, ctypes.c_float, ctypes.c_float, ctypes.c_float, ctypes.c_float]</code> but this gives the following error: TypeError: restype must be a type, a callable, or None.</p></li>\n</ol>\n\n<p>I am not really sure what is going on. Any help would be much appreciated. Thanks!</p>\n"}, {"tags": ["c", "function", "matrix"], "comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 2, "creation_date": 1530670127, "post_id": 51164733, "comment_id": 89313026, "body": "You cannot return a pointer to a an array declared local to a function with <i>automatic</i> storage. (the function stack is destroyed [memory released for reuse] on function return -- along with all local variables). Instead, you must allocate storage for the array in your function and return a pointer to the newly allocated block of memory (memory with <i>allocated</i> storage duration remains valid until it is <code>free</code>d -- or the program ends)."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1530701937, "post_id": 51164733, "comment_id": 89326663, "body": "See <a href=\"https://stackoverflow.com/questions/42094465/correctly-allocating-multi-dimensional-arrays\">Correctly allocating multi-dimensional arrays</a> for how to do it proper. There&#39;s a complete example at the bottom."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1530829622, "post_id": 51164733, "comment_id": 89382926, "body": "OT: the function: <code>srand()</code> should ONLY be called once in the whole program.  Usually very near the beginning of the <code>main()</code> function"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1530829862, "post_id": 51164733, "comment_id": 89382989, "body": "OT:  for ease of readability and understanding: 1) follow the axiom:  <i>only one statement per line and (at most) one variable declaration per statement.</i> 2) variable (and function parameter) names should indicate <code>content</code> or <code>usage</code> (or better, both) 3) insert a reasonable space: inside parens, inside braces, inside brackets, after semicolons, after commas, around C operators"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1530829952, "post_id": 51164733, "comment_id": 89383010, "body": "the header file <code>conio.h</code> (and related library) are not portable.  Strongly suggest not using any of the functionality in <code>conio.h</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1530830070, "post_id": 51164733, "comment_id": 89383047, "body": "the functions: <code>declaration()</code> and <code>printing()</code> are missing the needed prototypes before they are called.  So the C compiler will make the assumption that the returned type and the parameters are <code>int</code>  which is an error"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1530830145, "post_id": 51164733, "comment_id": 89383065, "body": "OT: when calling any of the <code>scanf()</code> family of functions, always check the returned value (not the parameter values) to assure the operation was successful"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1530830469, "post_id": 51164733, "comment_id": 89383157, "body": "regarding: <code>void printing(int c[100][100],int a,int b) {</code>  how did the matrix[][] variable suddenly become a 100x100 array?  Strongly suggest the function signature be written as: <code>void printing( int rows, int columns, int matrix[ rows ][ columns ]) {</code>  and the statement calling the function be modified accordingly and the parameter names be updated within the function: <code>printing()</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1530830649, "post_id": 51164733, "comment_id": 89383209, "body": "regarding: <code>int i,j;     for(i=0;i&lt;a;i++){         for(j=0;j&lt;b;j++){</code>  The &#39;scope&#39; of variables should be limited as much as possible.  So this would be much better written as:      for( int i=0; i&lt;a; i++ ) {         for( int j=0; j&lt;b; j++ ) {`"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1530830913, "post_id": 51164733, "comment_id": 89383269, "body": "regarding: <code>printing(matrix,m,n);</code>  the <code>matrix</code>, declared in <code>declaration()</code> is not visible in the <code>main()</code> function.  Suggest returning a <code>int</code> pointer that points to the allocated memory for <code>matrix[][]</code>  Then passing that returned pointer to <code>printing()</code>"}], "answers": [{"tags": [], "owner": {"reputation": 427, "user_id": 8834967, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Xrf_YCVb2Vw/AAAAAAAAAAI/AAAAAAAAAAc/K52j8i_sYWw/photo.jpg?sz=128", "display_name": "Joy Allen", "link": "https://stackoverflow.com/users/8834967/joy-allen"}, "is_accepted": false, "score": 2, "last_activity_date": 1530669779, "creation_date": 1530669779, "answer_id": 51164852, "question_id": 51164733, "link": "https://stackoverflow.com/questions/51164733/how-do-returns-a-matrix-in-c-include-code/51164852#51164852", "title": "how do returns a matrix in C (include code)", "body": "<p>Define it like:</p>\n\n<pre><code>typedef struct {\n    int rows;\n    int cols;\n    int *data;\n} int_matrix_entity, *int_matrix;\n\nint_matrix int_matrix_create(int rows, int cols, bool rand)\n{\n    int_matrix mt;\n    int i;\n    if ((mt = malloc(sizeof(int_matrix_entity))) == NULL)\n    {\n        return NULL;\n    }\n\n    if ((mt-&gt;data = malloc(sizeof(int) * cols * rows)) == NULL)\n    {\n        free(mt);\n        return NULL;\n    }\n\n    if (rand)\n    {\n        srand(time(NULL));\n        for (i = 0; i &lt; cols * rows; i++)\n        {\n            mt-&gt;data[i] = 1 + rand() % 7;\n        }   \n    }\n    else\n    {\n        memset(mt-&gt;data, 0, sizeof(int) * cols * rows);\n    }\n\n    return mt;\n}\n\nvoid int_matrix_printf(int_matrix mt)\n{\n    int i;\n    int j;\n    for (i = 0; i &lt; mt-&gt;rows; i++)\n    {\n        for (j = 0; j &lt; mt-&gt;cols; j++)\n        {\n            printf(\"%5d \", mt[i * cols + j]);\n        }\n        printf(\"\\n\");\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1079, "user_id": 1884351, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/0ccc73c4be038f1bb08243adc61f5550?s=128&d=identicon&r=PG&f=1", "display_name": "fnisi", "link": "https://stackoverflow.com/users/1884351/fnisi"}, "is_accepted": false, "score": 2, "last_activity_date": 1530677493, "creation_date": 1530677493, "answer_id": 51165641, "question_id": 51164733, "link": "https://stackoverflow.com/questions/51164733/how-do-returns-a-matrix-in-c-include-code/51165641#51165641", "title": "how do returns a matrix in C (include code)", "body": "<p>You have a few points that require a bit more attention;</p>\n\n<p>1 ) read warning and error messages given by your compiler</p>\n\n<p>2 ) again, read warning messages given by your compiler</p>\n\n<p>3 ) use indentation to make your code more readable.</p>\n\n<p>4 ) Always return from <code>main()</code>, that's a good practice</p>\n\n<p>The code below does what you want to achieve; have a look at it and keep on reading...</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;time.h&gt;\n#include &lt;stdlib.h&gt;\n\n// You either have to declare your functions \n// or implement them before main()\nvoid declaration(int a,int b, int m[a][b]);\nvoid printing(int a,int b,  int m[a][b]);\n\nint main(){ // always return from main()\n  int m,n;\n  printf(\"type 2 numbers:\");\n  scanf(\"%i %i\",&amp;m,&amp;n);\n  int matrix[m][n];\n\n  declaration(m, n, matrix);\n  printing(m, n, matrix);\n\n  return 0;\n}\n\nvoid declaration(int a,int b, int m[a][b]){\n  srand(time(NULL));\n  int i,j;\n\n  for(i=0;i&lt;a;i++){\n    for(j=0;j&lt;b;j++){\n        m[i][j]=1+rand()%7;\n    }\n  }\n}\n\nvoid printing(int a,int b, int m[a][b]){\n  int i,j;\n  for(i=0;i&lt;a;i++){\n    for(j=0;j&lt;b;j++){\n        printf(\"%i\\t\",m[i][j]);\n    }\n    printf(\"\\n\");\n  }\n} \n</code></pre>\n\n<p>You need a way to transfer data from one function to another. You cannot simply declare an <code>auto</code> variable in one function and pass it to another as you did in the code below</p>\n\n<pre><code>declaration(m,n);\nprinting(matrix,m,n); /* where does matrix[][] come from? */\n</code></pre>\n\n<p>remember, C is a strongly typed language which means you have to declare your variables before using them. This applies to your functions as well. You either have to give your function declarations before <code>main()</code> (or more specifically, before using them), or implement them.</p>\n\n<p>Look into your header files (i.e. .h files) and you will see lots of function declarations.</p>\n\n<p>Since you use variable length arrays, make sure your compiler is at least capable of compiling code confirming C99 standard.</p>\n\n<p>Some extras;</p>\n\n<p>Normally, C passes arguments by value and you have to use a pointer if you want the value of your variable get changed within the function. If you have a close look at the code snippet I gave, I simply used an <code>int m[a][b]</code>.In C, the name of an array is a pointer to its first element, hence you can change the value of array elements when actually array's name is passed to your function as an argument.</p>\n\n<p>For further reading, you may want to look at</p>\n\n<ul>\n<li>variable scope</li>\n<li>global variables (you can define matrix[][] as a global variable and change the value of matrix elements)</li>\n<li>declaration vs definition in C</li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1530701791, "post_id": 51167409, "comment_id": 89326561, "body": "I&#39;d hardly call this keep it simple. Keeping it simple would be to allocate a 2D array instead of a look-up table. <a href=\"https://stackoverflow.com/questions/42094465/correctly-allocating-multi-dimensional-arrays\">Correctly allocating multi-dimensional arrays</a>."}], "tags": [], "owner": {"reputation": 679, "user_id": 7314871, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K3EKh.jpg?s=128&g=1", "display_name": "Srikanth Chekuri", "link": "https://stackoverflow.com/users/7314871/srikanth-chekuri"}, "is_accepted": false, "score": 0, "last_activity_date": 1530686899, "creation_date": 1530686899, "answer_id": 51167409, "question_id": 51164733, "link": "https://stackoverflow.com/questions/51164733/how-do-returns-a-matrix-in-c-include-code/51167409#51167409", "title": "how do returns a matrix in C (include code)", "body": "<p>Another simple way to do it is use double pointer to create 2-dimensional array. Keep it simple.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint** create_matrix(int rows, int cols) {\n    int **matrix = malloc(rows*(sizeof(int *)));\n    for(int i = 0; i &lt; rows; i++) {\n        matrix[i] = malloc(cols*sizeof(int));\n    }\n    for(int i = 0; i &lt; rows; i++) {\n        for(int j = 0; j &lt; cols; j++) {\n            matrix[i][j] = 1 + rand()%7;\n        }\n    }\n    return matrix;\n}\n\nvoid printing(int** matrix, int rows, int cols) {\n    for(int i = 0; i &lt; rows; i++) {\n        for(int j = 0; j &lt; cols; j++) {\n            printf(\"%d \", matrix[i][j]);\n        }\n        printf(\"\\n\");\n    }\n}\n\nint main(void) {\n    int rows, cols;\n    rows = 3, cols = 3;\n    int** matrix = create_matrix(rows, cols);\n    printing(matrix, rows, cols);\n    free(matrix);\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10029380, "user_type": "registered", "profile_image": "https://graph.facebook.com/2146422822056836/picture?type=large", "display_name": "Andr&#233;s HM", "link": "https://stackoverflow.com/users/10029380/andr%c3%a9s-hm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1530686899, "creation_date": 1530668465, "last_edit_date": 1530675991, "question_id": 51164733, "link": "https://stackoverflow.com/questions/51164733/how-do-returns-a-matrix-in-c-include-code", "title": "how do returns a matrix in C (include code)", "body": "<p>i defined a matrix into a function. how do i return that matrix for print it when i call it with another function. i mean...</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;conio.h&gt;\n#include&lt;time.h&gt;\n\nvoid main() {\n    int m,n;\n    printf(\"type 2 numbers:\");\n    scanf(\"%i %i\",&amp;m,&amp;n);\n    declaration(m,n);\\\\HERE IS THE PROBLEM\n    printing(matrix,m,n);\n    getch();\n}\n\nvoid declaration(int a,int b) {\n    srand(time(NULL));\n    int i,j,matrix[a][b];\n    for(i=0;i&lt;a;i++){\n        for(j=0;j&lt;b;j++){\n            matrix[i][j]=1+rand()%7;\n        }\n    }\n}\n\nvoid printing(int c[100][100],int a,int b) {\n    int i,j;\n    for(i=0;i&lt;a;i++){\n        for(j=0;j&lt;b;j++){\n            printf(\"%i\\t\",c[i][j]);\n        }\n        printf(\"\\n\");\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 3, "creation_date": 1530661952, "post_id": 51164151, "comment_id": 89311533, "body": "<code>string[i]</code> is equivalent to <code>*(string + i)</code>."}, {"owner": {"reputation": 1220, "user_id": 5878272, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/14e96159153b67fab5222b7c5fa18c71?s=128&d=identicon&r=PG&f=1", "display_name": "Fredrik", "link": "https://stackoverflow.com/users/5878272/fredrik"}, "edited": false, "score": 2, "creation_date": 1530662150, "post_id": 51164151, "comment_id": 89311571, "body": "This code is already using pointers."}, {"owner": {"reputation": 11711, "user_id": 1361787, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/XR9JP.png?s=128&g=1", "display_name": "ChiefTwoPencils", "link": "https://stackoverflow.com/users/1361787/chieftwopencils"}, "edited": false, "score": 0, "creation_date": 1530662161, "post_id": 51164151, "comment_id": 89311576, "body": "It&#39;s already using a pointer."}, {"owner": {"reputation": 7, "user_id": 9996944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd40fa127dc03fd537ed9462bbd23333?s=128&d=identicon&r=PG&f=1", "display_name": "CECE", "link": "https://stackoverflow.com/users/9996944/cece"}, "edited": false, "score": 0, "creation_date": 1530662206, "post_id": 51164151, "comment_id": 89311591, "body": "I turned this in to my teacher and she said i need to use pointers so I&#39;m just confused."}, {"owner": {"reputation": 11711, "user_id": 1361787, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/XR9JP.png?s=128&g=1", "display_name": "ChiefTwoPencils", "link": "https://stackoverflow.com/users/1361787/chieftwopencils"}, "edited": false, "score": 0, "creation_date": 1530662228, "post_id": 51164151, "comment_id": 89311596, "body": "<code>char*</code> is a pointer, and you&#39;re using it.... They probably meant to use pointer arithmetic which the first comment shows an example."}, {"owner": {"reputation": 7, "user_id": 9996944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd40fa127dc03fd537ed9462bbd23333?s=128&d=identicon&r=PG&f=1", "display_name": "CECE", "link": "https://stackoverflow.com/users/9996944/cece"}, "edited": false, "score": 0, "creation_date": 1530662314, "post_id": 51164151, "comment_id": 89311621, "body": "But the entire code needs to be written using pointers"}, {"owner": {"reputation": 11711, "user_id": 1361787, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/XR9JP.png?s=128&g=1", "display_name": "ChiefTwoPencils", "link": "https://stackoverflow.com/users/1361787/chieftwopencils"}, "edited": false, "score": 1, "creation_date": 1530662355, "post_id": 51164151, "comment_id": 89311625, "body": "I think you should&#39;ve asked your teacher for clarification."}, {"owner": {"reputation": 7, "user_id": 9996944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd40fa127dc03fd537ed9462bbd23333?s=128&d=identicon&r=PG&f=1", "display_name": "CECE", "link": "https://stackoverflow.com/users/9996944/cece"}, "reply_to_user": {"reputation": 11711, "user_id": 1361787, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/XR9JP.png?s=128&g=1", "display_name": "ChiefTwoPencils", "link": "https://stackoverflow.com/users/1361787/chieftwopencils"}, "edited": false, "score": 0, "creation_date": 1530662359, "post_id": 51164151, "comment_id": 89311626, "body": "@ChiefTwoPencils Yes thats what she meant"}, {"owner": {"reputation": 1220, "user_id": 5878272, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/14e96159153b67fab5222b7c5fa18c71?s=128&d=identicon&r=PG&f=1", "display_name": "Fredrik", "link": "https://stackoverflow.com/users/5878272/fredrik"}, "reply_to_user": {"reputation": 11711, "user_id": 1361787, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/XR9JP.png?s=128&g=1", "display_name": "ChiefTwoPencils", "link": "https://stackoverflow.com/users/1361787/chieftwopencils"}, "edited": false, "score": 1, "creation_date": 1530663189, "post_id": 51164151, "comment_id": 89311815, "body": "@Chief Using the *(q+1) and q[1] are both considerd pointer arithmetics when used on pointers. So it sounds like your teacher is incompetent."}, {"owner": {"reputation": 11711, "user_id": 1361787, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/XR9JP.png?s=128&g=1", "display_name": "ChiefTwoPencils", "link": "https://stackoverflow.com/users/1361787/chieftwopencils"}, "reply_to_user": {"reputation": 1220, "user_id": 5878272, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/14e96159153b67fab5222b7c5fa18c71?s=128&d=identicon&r=PG&f=1", "display_name": "Fredrik", "link": "https://stackoverflow.com/users/5878272/fredrik"}, "edited": false, "score": 0, "creation_date": 1530663578, "post_id": 51164151, "comment_id": 89311886, "body": "@Fredrik, it&#39;s not my teacher. I&#39;m not a C language lawyer but I would call that equivalent but not the same. It&#39;s a shorthand that gets compiled, IIRC, into explicit pointer arithmetic. So, as is usual when learning programming, you have to do it the hard and/or inconvenient way before you use a mechanism that hides stuff."}, {"owner": {"reputation": 7061, "user_id": 5389107, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/769c1f4253eca239d400ce3226d801b4?s=128&d=identicon&r=PG&f=1", "display_name": "user308386", "link": "https://stackoverflow.com/users/5389107/user308386"}, "edited": false, "score": 0, "creation_date": 1530685505, "post_id": 51164151, "comment_id": 89317141, "body": "I&#39;m voting to close this question as off-topic because stack overflow is not a service to write entire modules of code, but for pointed questions of when you&#39;ve gotten stuck after attempting on your own."}], "answers": [{"comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1530662550, "post_id": 51164197, "comment_id": 89311660, "body": "And <code>*p != &#39;\\0&#39;</code> written customarily as <code>*p</code>"}, {"owner": {"reputation": 47115, "user_id": 235354, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/097d761861529df52a6800744f1074d2?s=128&d=identicon&r=PG", "display_name": "jspcal", "link": "https://stackoverflow.com/users/235354/jspcal"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1530662641, "post_id": 51164197, "comment_id": 89311684, "body": "@AnttiHaapala: absolutely!"}, {"owner": {"reputation": 2558, "user_id": 527088, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5859af3feb3e6929ff46501982fa812e?s=128&d=identicon&r=PG", "display_name": "Hack Saw", "link": "https://stackoverflow.com/users/527088/hack-saw"}, "edited": false, "score": 0, "creation_date": 1530662674, "post_id": 51164197, "comment_id": 89311691, "body": "I hate that custom. Hate it, hate it, hate it. I want my conditions to look like conditions."}, {"owner": {"reputation": 1220, "user_id": 5878272, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/14e96159153b67fab5222b7c5fa18c71?s=128&d=identicon&r=PG&f=1", "display_name": "Fredrik", "link": "https://stackoverflow.com/users/5878272/fredrik"}, "edited": false, "score": 0, "creation_date": 1530663103, "post_id": 51164197, "comment_id": 89311785, "body": "Using the *(q+1) and q[1] are both considerd pointer arithmetics when used on a pointer."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "reply_to_user": {"reputation": 2558, "user_id": 527088, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5859af3feb3e6929ff46501982fa812e?s=128&d=identicon&r=PG", "display_name": "Hack Saw", "link": "https://stackoverflow.com/users/527088/hack-saw"}, "edited": false, "score": 0, "creation_date": 1530663120, "post_id": 51164197, "comment_id": 89311789, "body": "@HackSaw well, you&#39;re entitled to your opinion as well. I checked K&amp;R and the example code there does seem to use <code>!= </code>\\0`&#39;"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "reply_to_user": {"reputation": 1220, "user_id": 5878272, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/14e96159153b67fab5222b7c5fa18c71?s=128&d=identicon&r=PG&f=1", "display_name": "Fredrik", "link": "https://stackoverflow.com/users/5878272/fredrik"}, "edited": false, "score": 0, "creation_date": 1530663189, "post_id": 51164197, "comment_id": 89311814, "body": "@Fredrik ... well considering that you can use them <i>only</i> on a pointer..."}, {"owner": {"reputation": 2558, "user_id": 527088, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5859af3feb3e6929ff46501982fa812e?s=128&d=identicon&r=PG", "display_name": "Hack Saw", "link": "https://stackoverflow.com/users/527088/hack-saw"}, "edited": false, "score": 0, "creation_date": 1530663248, "post_id": 51164197, "comment_id": 89311829, "body": "@ Antti Haapala: Yeah, I know I&#39;m tilting at windmills. I&#39;ve been burned by a surprise -1."}, {"owner": {"reputation": 1220, "user_id": 5878272, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/14e96159153b67fab5222b7c5fa18c71?s=128&d=identicon&r=PG&f=1", "display_name": "Fredrik", "link": "https://stackoverflow.com/users/5878272/fredrik"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1530663279, "post_id": 51164197, "comment_id": 89311836, "body": "@Antti q[1] can be used on arrays aswell.."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "reply_to_user": {"reputation": 1220, "user_id": 5878272, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/14e96159153b67fab5222b7c5fa18c71?s=128&d=identicon&r=PG&f=1", "display_name": "Fredrik", "link": "https://stackoverflow.com/users/5878272/fredrik"}, "edited": false, "score": 0, "creation_date": 1530663420, "post_id": 51164197, "comment_id": 89311860, "body": "@Fredrik no, the array always decays to a pointer, the <code>[]</code> can only used on values of pointer type. Same with function calls - you can <i>only</i> apply the function call operator to a value of type pointer-to-function, which is why dereferencing a function pointer to call it always looks funny to me."}, {"owner": {"reputation": 1220, "user_id": 5878272, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/14e96159153b67fab5222b7c5fa18c71?s=128&d=identicon&r=PG&f=1", "display_name": "Fredrik", "link": "https://stackoverflow.com/users/5878272/fredrik"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1530663653, "post_id": 51164197, "comment_id": 89311903, "body": "@Antti arrays do decay to pointers in many contexts but NOT ALL. And [] can be used in those contexts to access array elements."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "reply_to_user": {"reputation": 1220, "user_id": 5878272, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/14e96159153b67fab5222b7c5fa18c71?s=128&d=identicon&r=PG&f=1", "display_name": "Fredrik", "link": "https://stackoverflow.com/users/5878272/fredrik"}, "edited": false, "score": 0, "creation_date": 1530664121, "post_id": 51164197, "comment_id": 89311978, "body": "@Fredrik Arrays decay in <i>all</i> contexts except when they&#39;re directly the target of <code>&amp;</code> or <code>sizeof</code>. <code>[]</code> requires <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.5.2.1\" rel=\"nofollow noreferrer\">one of the operands to be a pointer</a>. For arrays this happens through pointer decay."}], "tags": [], "owner": {"reputation": 47115, "user_id": 235354, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/097d761861529df52a6800744f1074d2?s=128&d=identicon&r=PG", "display_name": "jspcal", "link": "https://stackoverflow.com/users/235354/jspcal"}, "is_accepted": false, "score": 3, "last_activity_date": 1530662567, "last_edit_date": 1530662567, "creation_date": 1530662414, "answer_id": 51164197, "question_id": 51164151, "link": "https://stackoverflow.com/questions/51164151/rewriting-code-using-pointers/51164197#51164197", "title": "Rewriting code using pointers", "body": "<p>You can iterate by incrementing a pointer (rather than using array lookups). In many cases however, the compiler will be able to optimize both versions to attain similar performance.</p>\n\n<pre><code>for (char *p = string; *p; ++p) {\n    if (*p == ch) {\n        for (char *q = p; *q; ++q) {\n            *q = *(q + 1);\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 9996944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd40fa127dc03fd537ed9462bbd23333?s=128&d=identicon&r=PG&f=1", "display_name": "CECE", "link": "https://stackoverflow.com/users/9996944/cece"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "closed_date": 1530691198, "answer_count": 1, "score": -2, "last_activity_date": 1530662567, "creation_date": 1530661884, "last_edit_date": 1530662446, "question_id": 51164151, "link": "https://stackoverflow.com/questions/51164151/rewriting-code-using-pointers", "closed_reason": "Not suitable for this site", "title": "Rewriting code using pointers", "body": "<pre><code>void rmchr(char*string, char ch) //string function\n{\n   int i; //position in string variable\n   int j; //updated variable of i to the end of string\n   for(i=0; string[i] != '\\0'; i++) // i iterates through the string\n   {\n      if(string[i] == ch) //checks if given character is equal to char at ith position\n      {\n         for(j=i; string[j] != '\\0'; j++) //loop from i to end of string\n         {\n            string[j] = string[j + 1]; //swaps value of next char so matching char is placed at end of string\n         }\n         string[j] = '\\0';\n         i--; //decrease i by 1\n      }\n   }\n}\n</code></pre>\n\n<blockquote>\n  <p>I need this code to be rewritten using pointers. Please help.\n  The program takes a string and a character and removes all occurrences of the character from the string. I haven't included all code as this is the only code that needs to be rewritten using pointer arithmetic.</p>\n</blockquote>\n"}, {"tags": ["c", "string", "function", "pointers"], "comments": [{"owner": {"reputation": 937, "user_id": 9242445, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2IaxD.jpg?s=128&g=1", "display_name": "Marker", "link": "https://stackoverflow.com/users/9242445/marker"}, "edited": false, "score": 4, "creation_date": 1530661336, "post_id": 51164082, "comment_id": 89311436, "body": "You can&#39;t return name like you are doing.  It is a local variable which is created on the stack and &quot;disappears&quot; when the function exits."}, {"owner": {"reputation": 937, "user_id": 9242445, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2IaxD.jpg?s=128&g=1", "display_name": "Marker", "link": "https://stackoverflow.com/users/9242445/marker"}, "edited": false, "score": 0, "creation_date": 1530663152, "post_id": 51164082, "comment_id": 89311802, "body": "Trying to return a local character array from within a function is a common mistake.  Many of the basic types (char, int, float, double, etc) and even structs can be returned because the compiler returns a copy.   A local character array variable is a pointer to an &quot;array&quot; (consecutive) characters on the stack.  The value of the pointer is returned correctly, but the stack is rolled back when the function exits so the array of characters that the result points to is no longer valid.  The same goes for local arrays of any type."}], "answers": [{"comments": [{"owner": {"reputation": 2558, "user_id": 527088, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5859af3feb3e6929ff46501982fa812e?s=128&d=identicon&r=PG", "display_name": "Hack Saw", "link": "https://stackoverflow.com/users/527088/hack-saw"}, "edited": false, "score": 0, "creation_date": 1530662198, "post_id": 51164100, "comment_id": 89311590, "body": "I was just going to suggest that last part. :)"}], "tags": [], "owner": {"reputation": 47115, "user_id": 235354, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/097d761861529df52a6800744f1074d2?s=128&d=identicon&r=PG", "display_name": "jspcal", "link": "https://stackoverflow.com/users/235354/jspcal"}, "is_accepted": false, "score": 2, "last_activity_date": 1530662043, "last_edit_date": 1530662043, "creation_date": 1530661427, "answer_id": 51164100, "question_id": 51164082, "link": "https://stackoverflow.com/questions/51164082/how-to-access-a-string-from-a-pointer-returned-by-a-function-in-c/51164100#51164100", "title": "How to access a string from a pointer returned by a function in C", "body": "<p>It's not necessary to create a new string. You can output a string right-padded to a certain length using the format specifier below (e.g.: <code>%-30s</code> to right-pad to 30 characters):</p>\n\n<pre><code>printf(\"[%-10s]\", name);\n\n/* [Name      ] */\n</code></pre>\n\n<p>If you do create a new string, you'd want to return a valid memory location. Rather than returning a pointer to the local stack, use <code>malloc</code> to allocate the memory and remember to <code>free</code> it when done with it (alternatively pass in an array allocated on the stack by the caller).</p>\n"}, {"tags": [], "owner": {"reputation": 4598, "user_id": 9264702, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mHczh.jpg?s=128&g=1", "display_name": "Stephen Docy", "link": "https://stackoverflow.com/users/9264702/stephen-docy"}, "is_accepted": false, "score": 0, "last_activity_date": 1530661434, "creation_date": 1530661434, "answer_id": 51164101, "question_id": 51164082, "link": "https://stackoverflow.com/questions/51164082/how-to-access-a-string-from-a-pointer-returned-by-a-function-in-c/51164101#51164101", "title": "How to access a string from a pointer returned by a function in C", "body": "<p>You need to dynamically allocate <code>name</code> in <code>padstring()</code> if you wish to return that memory to the caller.</p>\n\n<pre><code>char *name = malloc(30);\nif (name == NULL) {\n    return NULL;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 162, "user_id": 6841200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0ee3fbb31ed128f84ac6b61df829ca4?s=128&d=identicon&r=PG&f=1", "display_name": "kaineub", "link": "https://stackoverflow.com/users/6841200/kaineub"}, "is_accepted": false, "score": 0, "last_activity_date": 1530661609, "creation_date": 1530661609, "answer_id": 51164118, "question_id": 51164082, "link": "https://stackoverflow.com/questions/51164082/how-to-access-a-string-from-a-pointer-returned-by-a-function-in-c/51164118#51164118", "title": "How to access a string from a pointer returned by a function in C", "body": "<p>First off, you need to null terminate your strings. Second, you need to create the array on the heap using malloc (make sure to free the memory when you are done with it).</p>\n"}, {"tags": [], "owner": {"reputation": 937, "user_id": 9242445, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2IaxD.jpg?s=128&g=1", "display_name": "Marker", "link": "https://stackoverflow.com/users/9242445/marker"}, "is_accepted": false, "score": 0, "last_activity_date": 1530662639, "creation_date": 1530662639, "answer_id": 51164216, "question_id": 51164082, "link": "https://stackoverflow.com/questions/51164082/how-to-access-a-string-from-a-pointer-returned-by-a-function-in-c/51164216#51164216", "title": "How to access a string from a pointer returned by a function in C", "body": "<p>I generally prefer to do the padding in the same string.  Of course you have to make sure there is enough space which you can do by passing the maximum size.  I pass the pad length to make it more flexible.  It can be further improved by passing the character that you want to pad with in case it isn't always a space.</p>\n\n<p>This is a quick example.</p>\n\n<pre><code>#include &lt;string.h&gt;\n#include &lt;stdio.h&gt;\n\nchar* padstring(char *s, int maxlen, int padlen)\n{\n    int len = strlen(s);\n\n    if (len &lt; padlen)\n    {\n        char *p = s + len;\n        while ((len &lt; maxlen) &amp;&amp; (len &lt; padlen))\n        {\n            *p++ = ' '; // Add a space\n            *p = 0;     // Null terminate\n            len++;\n        }\n    }\n\n    return s;\n}\n\nint main(int argc, char *argv[])\n{\n    char s[50] = \"Hello\";\n\n    printf(\"'%s'\\n\", padstring(s, sizeof(s), 30));\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 427, "user_id": 8834967, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Xrf_YCVb2Vw/AAAAAAAAAAI/AAAAAAAAAAc/K52j8i_sYWw/photo.jpg?sz=128", "display_name": "Joy Allen", "link": "https://stackoverflow.com/users/8834967/joy-allen"}, "is_accepted": false, "score": 0, "last_activity_date": 1530668687, "creation_date": 1530668687, "answer_id": 51164753, "question_id": 51164082, "link": "https://stackoverflow.com/questions/51164082/how-to-access-a-string-from-a-pointer-returned-by-a-function-in-c/51164753#51164753", "title": "How to access a string from a pointer returned by a function in C", "body": "<p>There is no need to define a new function in your case.\nJust use <code>sprintf()</code> to fill string with spaces.</p>\n\n<pre><code>void myFunction(void) {\n\n    // Declare max length of name\n    const int MAX_LEN = 29;\n\n    pStudent = pHead;\n    char paddedName[MAX_LEN + 1];\n    long nameLength = 0 ;\n\n    while(pStudent-&gt;pNext != NULL){\n        // Record origin length\n        nameLength = strlen(pStudent-&gt;name);\n        // Just write spaces after pStudent-&gt;name\n        sprintf(pStudent-&gt;name + nameLength, \"%-*s\", MAX_LEN - nameLength, \"\");\n\n        nameLength = strlen(pStudent-&gt;name);\n        printf(\"%lu | %s | %s \\n\", nameLength, paddedName, pStudent-&gt;name);\n        pStudent = pStudent-&gt;pNext;\n    }\n    printf(\"\\n\");\n\n}\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 8772434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a1c8335910fb94b3a8789f01d47d7e6?s=128&d=identicon&r=PG&f=1", "display_name": "KontinuousKode", "link": "https://stackoverflow.com/users/8772434/kontinuouskode"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "answer_count": 5, "score": 0, "last_activity_date": 1530668687, "creation_date": 1530661158, "question_id": 51164082, "link": "https://stackoverflow.com/questions/51164082/how-to-access-a-string-from-a-pointer-returned-by-a-function-in-c", "title": "How to access a string from a pointer returned by a function in C", "body": "<p>I've a function returning a pointer to a string in C and I'm trying to access the entirety of the string but I'm not sure how to. </p>\n\n<p>I've a function that loops threw a linked list of structs containing student data and gets the student's names. I want to pad spaces onto the ends of each string so they are all the same size. So I wrote a function for padding the strings. The function returns a pointer to the string but I don't know how to access the whole string from the pointer. I know I can put *pstring to get the first character of the string but I'm a little lost on how to get the rest. </p>\n\n<p>This loops through the linked list:</p>\n\n<pre><code>void myFunction(void) {\n\n    pStudent = pHead;\n    char paddedName[30];\n    long nameLength = 0 ;\n\n    while(pStudent-&gt;pNext != NULL){\n        printf(\"%c,\\n\", *padstring(pStudent-&gt;name));\n        strcpy(paddedName, padstring(pStudent-&gt;name));\n        nameLength = strlen(paddedName);\n        printf(\"%lu | %s | %s \\n\", nameLength, paddedName, pStudent-&gt;name);\n        pStudent = pStudent-&gt;pNext;\n    }\n    printf(\"\\n\");\n\n}\n</code></pre>\n\n<p>This pads and returns the string:</p>\n\n<pre><code>char *padstring(char* string){\n\n    char name[30];\n    int i = 0;\n\n    while(i &lt; 30){\n        if(i &lt; strlen(string)){\n            name[i] = string[i];\n                    }\n        else{\n            name[i] = ' ';\n        }\n        i++;\n    }\n    printf(\"%s,\\n\", name);\n    return name;\n\n}\n</code></pre>\n"}, {"tags": ["c", "linux-kernel", "linux-device-driver", "pci", "pci-e"], "comments": [{"owner": {"reputation": 3561, "user_id": 2511795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30c869f55cbcf82a7bc4536d563daa0a?s=128&d=identicon&r=PG", "display_name": "0andriy", "link": "https://stackoverflow.com/users/2511795/0andriy"}, "edited": false, "score": 2, "creation_date": 1530746610, "post_id": 51163832, "comment_id": 89345705, "body": "I guess the author either know something which no-one else does, or brought some stupid comment to the code."}, {"owner": {"reputation": 5875, "user_id": 2702398, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/87402651ed56717034035915b95c1ae0?s=128&d=identicon&r=PG&f=1", "display_name": "oakad", "link": "https://stackoverflow.com/users/2702398/oakad"}, "edited": false, "score": 1, "creation_date": 1530845458, "post_id": 51163832, "comment_id": 89385990, "body": "One way to think about this is that pci regions and pci device status are not really that connected. The system will discover the &quot;regions&quot; via the PCI ID mechanics and can reserve them even if device is disabled. On the other hand, device can be enabled (have power) but with pci bridge not properly configured to handle it&#39;s &quot;regions&quot;  it won&#39;t be able to communicate with the system, thus sitting there useless (or doing something on it&#39;s own, for all we know :-)."}, {"owner": {"reputation": 3561, "user_id": 2511795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30c869f55cbcf82a7bc4536d563daa0a?s=128&d=identicon&r=PG", "display_name": "0andriy", "link": "https://stackoverflow.com/users/2511795/0andriy"}, "edited": false, "score": 1, "creation_date": 1532342264, "post_id": 51163832, "comment_id": 89921855, "body": "I have notified PCI subsystem maintainer, I think we would clarify this soon in upstream."}], "answers": [{"tags": [], "owner": {"reputation": 583, "user_id": 4912037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc8ad5a96e60d4a5086e0c5b3cfb19ce?s=128&d=identicon&r=PG&f=1", "display_name": "yashC", "link": "https://stackoverflow.com/users/4912037/yashc"}, "is_accepted": false, "score": 2, "last_activity_date": 1530705045, "last_edit_date": 1592644375, "creation_date": 1530705045, "answer_id": 51173006, "question_id": 51163832, "link": "https://stackoverflow.com/questions/51163832/linux-pci-driver-setup-and-teardown/51173006#51173006", "title": "Linux PCI Driver Setup and Teardown", "body": "<p>The statement that gives a final say is as follows :</p>\n<blockquote>\n<p>o wake up the device if it was in suspended state,</p>\n<p>o <strong>allocate I/O and memory regions of the device</strong> (if BIOS did not),</p>\n<p>o allocate an IRQ (if BIOS did not).</p>\n</blockquote>\n<p>So, it makes no sense to ask kernel to reserve resource if there is none. In most cases when we do not need to allocate the resource because it has been done by bios, in those cases we can keep either function first but do only if you are absolutely sure.</p>\n"}], "owner": {"reputation": 4728, "user_id": 2457733, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/LG30R.png?s=128&g=1", "display_name": "It&#39;sPete", "link": "https://stackoverflow.com/users/2457733/itspete"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 597, "favorite_count": 1, "answer_count": 1, "score": 9, "last_activity_date": 1530833280, "creation_date": 1530658925, "question_id": 51163832, "link": "https://stackoverflow.com/questions/51163832/linux-pci-driver-setup-and-teardown", "title": "Linux PCI Driver Setup and Teardown", "body": "<p>After looking at the kernel docs here: <a href=\"https://www.kernel.org/doc/Documentation/PCI/pci.txt\" rel=\"noreferrer\">https://www.kernel.org/doc/Documentation/PCI/pci.txt</a> I am lost as to the ordering of function calls to set up and tear down a PCI driver.</p>\n\n<p>I have two questions:</p>\n\n<ol>\n<li><p>For setup, does <code>pci_enable_device()</code> always come before\n<code>pci_request_regions()</code>?  The documentation seems to point to this\nfact, but does state:</p>\n\n<blockquote>\n  <p>OS BUG: we don't check resource allocations before enabling those\n  resources. The sequence would make more sense if we called\n  <code>pci_request_resources()</code> before calling <code>pci_enable_device()</code>.\n  Currently, the device drivers can't detect the bug when when two\n  devices have been allocated the same range. This is not a common\n  problem and unlikely to get fixed soon. This has been discussed before but not changed as of 2.6.19: <a href=\"http://lkml.org/lkml/2006/3/2/194\" rel=\"noreferrer\">http://lkml.org/lkml/2006/3/2/194</a></p>\n</blockquote>\n\n<p>However, after doing a quick look through of the source code of several\ndrivers, the consensus is that <code>pci_enable_device()</code> always comes\nfirst.  Which one of these calls is supposed to come first and why?</p></li>\n<li><p>For tearing down the driver, I get even more confused.  Assuming <code>pci_enable_device()</code> comes first, I would expect that you first call <code>pci_release_regions()</code> prior to calling <code>pci_disable_device()</code> (i.e., following some symmetry).  However, the kernel docs say that <code>pci_release_regions()</code> should come last.  What makes matters more complicated is that I looked at many drivers and almost all of them had <code>pci_release_regions()</code> before <code>pci_disable_device()</code>, like I would expect.  However, I then stumbled across this driver: <a href=\"https://elixir.bootlin.com/linux/v4.12/source/drivers/infiniband/hw/hfi1/pcie.c\" rel=\"noreferrer\">https://elixir.bootlin.com/linux/v4.12/source/drivers/infiniband/hw/hfi1/pcie.c</a> (code is reproduced below).</p>\n\n<pre><code>void hfi1_pcie_cleanup(struct pci_dev *pdev)\n{\n    pci_disable_device(pdev);\n    /*\n     * Release regions should be called after the disable. OK to\n     * call if request regions has not been called or failed.\n     */\n    pci_release_regions(pdev);\n}\n</code></pre>\n\n<p>Which function is supposed to come first when tearing down the driver? It seems that drivers in the kernel itself can't agree.</p></li>\n</ol>\n"}, {"tags": ["c", "loops", "time-complexity", "big-o", "complexity-theory"], "comments": [{"owner": {"reputation": 151, "user_id": 5701631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd4416b47b386a7e776f9a2e1596d6fb?s=128&d=identicon&r=PG&f=1", "display_name": "Nova Ardent", "link": "https://stackoverflow.com/users/5701631/nova-ardent"}, "edited": false, "score": 1, "creation_date": 1530657533, "post_id": 51163614, "comment_id": 89310521, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/51162446/why-is-the-time-complexity-on2-in-this-code\">Why is the time complexity O(n^2) in this code?</a>"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 9, "creation_date": 1530658006, "post_id": 51163614, "comment_id": 89310642, "body": "Because 1/2 + 1/4 + 1/8 + ... = 1"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 12, "creation_date": 1530658603, "post_id": 51163614, "comment_id": 89310809, "body": "Or, more accurately, because N + N/2 + N/4 + N/8 + \u2026 = 2N."}], "answers": [{"tags": [], "owner": {"reputation": 1808, "user_id": 7724939, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/89dd0b319756f1e0dc1d7bff5d223d88?s=128&d=identicon&r=PG&f=1", "display_name": "nglee", "link": "https://stackoverflow.com/users/7724939/nglee"}, "is_accepted": true, "score": 6, "last_activity_date": 1530666953, "creation_date": 1530666953, "answer_id": 51164604, "question_id": 51163614, "link": "https://stackoverflow.com/questions/51163614/why-is-the-time-complexity-on-instead-of-on2-in-this-code/51164604#51164604", "title": "Why is the time complexity O(n) instead of O(n^2) in this code?", "body": "<blockquote>\n  <p>Isn't the first loop is <code>n</code> times, &amp; the same is the second one, so it becomes <code>O(n*n)</code>.</p>\n</blockquote>\n\n<p>Above statement is false, since:</p>\n\n<ol>\n<li>The outer loop does not run <code>n</code> times. (The outer loop runs <code>O(log n)</code> times, but it does not matter in this case.)</li>\n<li>For the inner loop, the number of loops differs as the value of <code>n</code> changes.</li>\n</ol>\n\n<p>To get the time complexity of this code, we should count the total number of times the body of the inner loop is executed.</p>\n\n<ol>\n<li>Clearly, the body of the inner loop is executed <code>n</code> times, for each value of <code>n</code>.</li>\n<li>The value of <code>n</code> is determined by the <code>for</code> statement of the outer loop. It starts from the value given as the argument to the function, and is halved each time the body of outer loop is executed.</li>\n</ol>\n\n<p>So as already stated by the comments, since <code>n + n/2 + n/4 + n/8 + ... = 2n</code>, the time complexity for this algorithm is <code>O(n)</code>.</p>\n\n<hr>\n\n<p>For some more concrete mathematical proof on this:</p>\n\n<p>Find an integer <code>k</code> such that <code>2^(k-1) &lt; n &lt;= 2^k</code>. For this <code>k</code>:</p>\n\n<ol>\n<li>A lower bound for the total number of inner loops is <code>1 + 2 + 4 + ... + 2^(k-1) = 2^k - 1 &gt;= n - 1 \u2208 \u03a9(n)</code>.</li>\n<li>An upper bound for the total number of inner loops is <code>1 + 2 + 4 + ... + 2^k = 2^(k+1) - 1 &lt; 4n - 1 \u2208 O(n)</code>.</li>\n</ol>\n\n<p>Therefore the total number of inner loops is <code>\u0398(n)</code>, as well as <code>O(n)</code>.</p>\n"}], "owner": {"reputation": 393, "user_id": 6399127, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/284c279ef66682bb64409ea3e0d89d18?s=128&d=identicon&r=PG&f=1", "display_name": "sam0101", "link": "https://stackoverflow.com/users/6399127/sam0101"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 182, "favorite_count": 1, "accepted_answer_id": 51164604, "answer_count": 1, "score": 0, "last_activity_date": 1530666953, "creation_date": 1530657326, "last_edit_date": 1530665871, "question_id": 51163614, "link": "https://stackoverflow.com/questions/51163614/why-is-the-time-complexity-on-instead-of-on2-in-this-code", "title": "Why is the time complexity O(n) instead of O(n^2) in this code?", "body": "<p>Why isn't the time complexity here O(n^2) and instead it is O(n)? \nIsn't the first loop is <code>n</code> times, &amp; the same is the second one, so it becomes <code>O(n*n)</code>, what is wrong here?</p>\n\n<pre><code>void f(int n){\n\n     for( ; n&gt;0; n/=2){\n         int i;\n         for(i=0; i&lt;n; i++){\n             printf(\"hey\");\n         }\n     }\n}\n</code></pre>\n"}, {"tags": ["c", "pointers", "memcpy", "strcpy"], "comments": [{"owner": {"reputation": 826, "user_id": 1402389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/599c4eaaff0f5d2c3fe5feca6560173b?s=128&d=identicon&r=PG", "display_name": "FBergo", "link": "https://stackoverflow.com/users/1402389/fbergo"}, "edited": false, "score": 1, "creation_date": 1530658206, "post_id": 51163612, "comment_id": 89310695, "body": "That wall of text is unreadable and the very first line of code is already incorrect, if you are allocating a <code>char **</code>, the element size is <code>sizeof(char *)</code>, not <code>sizeof(char)</code>."}, {"owner": {"reputation": 5010, "user_id": 3150445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bfca2588483eadf6695a120cbcef1f8?s=128&d=identicon&r=PG&f=1", "display_name": "jwdonahue", "link": "https://stackoverflow.com/users/3150445/jwdonahue"}, "edited": false, "score": 0, "creation_date": 1530658223, "post_id": 51163612, "comment_id": 89310702, "body": "If you&#39;re looking for help debugging your program, you must post an <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. Also, what exactly is the problem? Your post has one really long paragraph that is difficult to read, please try applying some punctuation and maybe break it up into multiple paragraphs."}, {"owner": {"reputation": 3, "user_id": 9621603, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e71e8a10580e97ebaed9261a3edf3f0?s=128&d=identicon&r=PG&f=1", "display_name": "Eli", "link": "https://stackoverflow.com/users/9621603/eli"}, "reply_to_user": {"reputation": 826, "user_id": 1402389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/599c4eaaff0f5d2c3fe5feca6560173b?s=128&d=identicon&r=PG", "display_name": "FBergo", "link": "https://stackoverflow.com/users/1402389/fbergo"}, "edited": false, "score": 0, "creation_date": 1530658562, "post_id": 51163612, "comment_id": 89310796, "body": "@FBergo I tried to describe the situation as I could, I will resize the text and give paragraphs. That was a misspell, sorry about that, I&#39;ll fix it now."}, {"owner": {"reputation": 3, "user_id": 9621603, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e71e8a10580e97ebaed9261a3edf3f0?s=128&d=identicon&r=PG&f=1", "display_name": "Eli", "link": "https://stackoverflow.com/users/9621603/eli"}, "reply_to_user": {"reputation": 5010, "user_id": 3150445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bfca2588483eadf6695a120cbcef1f8?s=128&d=identicon&r=PG&f=1", "display_name": "jwdonahue", "link": "https://stackoverflow.com/users/3150445/jwdonahue"}, "edited": false, "score": 0, "creation_date": 1530658627, "post_id": 51163612, "comment_id": 89310817, "body": "@jwdonahue the problem is written after the bold word &quot;problem&quot;. Tell me if the question is still unclear. I will provide paragraphs now."}, {"owner": {"reputation": 5010, "user_id": 3150445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bfca2588483eadf6695a120cbcef1f8?s=128&d=identicon&r=PG&f=1", "display_name": "jwdonahue", "link": "https://stackoverflow.com/users/3150445/jwdonahue"}, "edited": false, "score": 1, "creation_date": 1530658913, "post_id": 51163612, "comment_id": 89310893, "body": "Post code that compiles and demonstrates the problem. By the time you strip it down to an MCVE you&#39;ll probably have found the defect on your own."}, {"owner": {"reputation": 3, "user_id": 9621603, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e71e8a10580e97ebaed9261a3edf3f0?s=128&d=identicon&r=PG&f=1", "display_name": "Eli", "link": "https://stackoverflow.com/users/9621603/eli"}, "reply_to_user": {"reputation": 5010, "user_id": 3150445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bfca2588483eadf6695a120cbcef1f8?s=128&d=identicon&r=PG&f=1", "display_name": "jwdonahue", "link": "https://stackoverflow.com/users/3150445/jwdonahue"}, "edited": false, "score": 0, "creation_date": 1530659121, "post_id": 51163612, "comment_id": 89310969, "body": "@jwdonahue I will provide it soon, thanks."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9621603, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e71e8a10580e97ebaed9261a3edf3f0?s=128&d=identicon&r=PG&f=1", "display_name": "Eli", "link": "https://stackoverflow.com/users/9621603/eli"}, "edited": false, "score": 0, "creation_date": 1530689138, "post_id": 51166975, "comment_id": 89319045, "body": "Uhm, I see, thanks a lot. I tried to realloc right after I enter the if but the process crashes. I&#39;ll debug and find some solution.  Thanks again."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "reply_to_user": {"reputation": 3, "user_id": 9621603, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e71e8a10580e97ebaed9261a3edf3f0?s=128&d=identicon&r=PG&f=1", "display_name": "Eli", "link": "https://stackoverflow.com/users/9621603/eli"}, "edited": false, "score": 0, "creation_date": 1530689202, "post_id": 51166975, "comment_id": 89319084, "body": "Thanks for (already) accepting. I was actually expecting you to provide more information, ideally an MCVE."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "reply_to_user": {"reputation": 3, "user_id": 9621603, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e71e8a10580e97ebaed9261a3edf3f0?s=128&d=identicon&r=PG&f=1", "display_name": "Eli", "link": "https://stackoverflow.com/users/9621603/eli"}, "edited": false, "score": 0, "creation_date": 1530689379, "post_id": 51166975, "comment_id": 89319169, "body": "Doing some debugging is an excellent idea. If you find something out and add it to the question it might get more, possibly more detailed, help. For some help with debugging, because I really want to help, have a look at these texts: <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">ericlippert.com/2014/03/05/how-to-debug-small-programs</a> and <a href=\"https://ericlippert.com/2014/03/21/find-a-simpler-problem/\" rel=\"nofollow noreferrer\">ericlippert.com/2014/03/21/find-a-simpler-problem</a> (which I also consider  debugging advice)."}, {"owner": {"reputation": 3, "user_id": 9621603, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e71e8a10580e97ebaed9261a3edf3f0?s=128&d=identicon&r=PG&f=1", "display_name": "Eli", "link": "https://stackoverflow.com/users/9621603/eli"}, "edited": false, "score": 0, "creation_date": 1530689517, "post_id": 51166975, "comment_id": 89319238, "body": "I accepted because you provided me the correct information to proceed with working on the solution. I&#39;m working on a MCVE but, as others pointed out, I may be able to find out the solution while creating it so.. I will edit my question as soon as I will have a MCVE though."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "reply_to_user": {"reputation": 3, "user_id": 9621603, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e71e8a10580e97ebaed9261a3edf3f0?s=128&d=identicon&r=PG&f=1", "display_name": "Eli", "link": "https://stackoverflow.com/users/9621603/eli"}, "edited": false, "score": 0, "creation_date": 1530689579, "post_id": 51166975, "comment_id": 89319263, "body": "True. Making an MCVE often turns out to be an excellent debugging method. ;-) Good luck."}, {"owner": {"reputation": 3, "user_id": 9621603, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e71e8a10580e97ebaed9261a3edf3f0?s=128&d=identicon&r=PG&f=1", "display_name": "Eli", "link": "https://stackoverflow.com/users/9621603/eli"}, "edited": false, "score": 0, "creation_date": 1530689614, "post_id": 51166975, "comment_id": 89319275, "body": "@Yunnosh I really appreciate your help, I&#39;m really sorry I couldn&#39;t provide an MCVE or a well written description of the problem. I&#39;ll read carefully that link, thanks again."}], "tags": [], "owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "is_accepted": true, "score": 0, "last_activity_date": 1530685238, "creation_date": 1530685238, "answer_id": 51166975, "question_id": 51163612, "link": "https://stackoverflow.com/questions/51163612/c-pointer-to-pointer-overwriting-last-one-saved/51166975#51166975", "title": "C pointer to pointer overwriting last one saved", "body": "<p>If you copy addresses (stored in pointers) to several entries in an array, but they all point to the same piece of memory (i.e. the addresses are same) then using the different entries in that array will always result in the same piece of memory being overwritten.</p>\n\n<p>Debug by comparing/printing the addresses you store in the different entries in your array. The bug is where two array entries contain the same address.</p>\n\n<p>To fix, make sure that the entries in the array receive different addresses, i.e. refer to separatly malloced pieces of memory.<br>\nThis implies that each time you change the index used to access your array you also need to malloc a new piece of memory to use along with that different array entry.</p>\n"}], "owner": {"reputation": 3, "user_id": 9621603, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e71e8a10580e97ebaed9261a3edf3f0?s=128&d=identicon&r=PG&f=1", "display_name": "Eli", "link": "https://stackoverflow.com/users/9621603/eli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "accepted_answer_id": 51166975, "answer_count": 1, "score": -4, "last_activity_date": 1530781408, "creation_date": 1530657316, "last_edit_date": 1530698886, "question_id": 51163612, "link": "https://stackoverflow.com/questions/51163612/c-pointer-to-pointer-overwriting-last-one-saved", "title": "C pointer to pointer overwriting last one saved", "body": "<p>What I want to do is take the string, save it into an array of strings and then modify each copy based on index. </p>\n\n<p>I edited the question and code, it was messy and unclear. As the question is almost the same (I think now it's more precise), I thought I could edit it entirely here without creating a new question, but let me know if I have to do differently.</p>\n\n<p><strong>PROBLEM (EDIT)</strong>: after reading the answer given, creating an MVCE, and reading <a href=\"https://stackoverflow.com/questions/6686727/how-to-change-a-character-in-a-string-using-pointers\">this</a> and some tips to debug, I think I am doing a mess with pointers and strcpy... Why does the following code (edited to be MVCE) gives this output?</p>\n\n<pre><code>abc\nx \nx\ny\n</code></pre>\n\n<p>It compiles and gives no debug errors, but I want the code to change the first char of the string in line_ret to \"x\" if index==0, and to \"y\" if index==1.\nI read <a href=\"https://stackoverflow.com/questions/4331439/how-to-replace-a-char-in-char\">here</a> it's not possible to change a single char in what a pointer points to, but what if I don't know how many times I have to copy line_read into line_ret, thus don't know the maximum index size to declare the array line_ret?</p>\n\n<p><strong>Code (EDIT)</strong>:</p>\n\n<pre><code>#include&lt;string.h&gt;\n#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n\nsize_t len = 10;\n\nint main(void){\n    char *line_read = malloc(5);\n    strcpy(line_read, \"abc\");\n    char **line_ret = malloc(5 * sizeof(char*));\n    int index = 0;\n\n    while(index &lt; 2){\n        line_ret[index] = realloc(line_ret, 1*len);\n\n        memcpy(&amp;line_ret[index], &amp;line_read, len);\n        printf(\"%s\\n\", line_ret[index]);\n\n        if(index == 0){\n            strcpy(&amp;line_ret[index][0], \"x\");\n        } else if(index == 1){\n            strcpy(&amp;line_ret[index][0], \"y\");\n        }\n        printf(\"%s\\n\", line_ret[index]);\n\n        index++;\n    }\n\n    free(line_read);\n    free(line_ret);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "bit"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1530658455, "post_id": 51163578, "comment_id": 89310766, "body": "&quot;starting at position 4&quot; --&gt; is that goal 4 from the left (MSBit) or from the right (LSBits)?"}, {"owner": {"reputation": 909, "user_id": 3420060, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/lrXwx.png?s=128&g=1", "display_name": "Crizly", "link": "https://stackoverflow.com/users/3420060/crizly"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1530658599, "post_id": 51163578, "comment_id": 89310807, "body": "Yep, I didn&#39;t realise cause i&#39;m working with network data and i need to read the data in chunks from left to right :P"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1530658668, "post_id": 51163578, "comment_id": 89310832, "body": "Tip: also use <i>unsigned</i> types and avoid <i>signed</i> shifting and mask issues."}], "answers": [{"comments": [{"owner": {"reputation": 909, "user_id": 3420060, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/lrXwx.png?s=128&g=1", "display_name": "Crizly", "link": "https://stackoverflow.com/users/3420060/crizly"}, "edited": false, "score": 0, "creation_date": 1530657647, "post_id": 51163646, "comment_id": 89310549, "body": "I&#39;m an idiot..."}, {"owner": {"reputation": 325, "user_id": 9900875, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-rhxM-SVSbsQ/AAAAAAAAAAI/AAAAAAAAAFo/n1-jj0Xou34/photo.jpg?sz=128", "display_name": "OregonJim", "link": "https://stackoverflow.com/users/9900875/oregonjim"}, "reply_to_user": {"reputation": 909, "user_id": 3420060, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/lrXwx.png?s=128&g=1", "display_name": "Crizly", "link": "https://stackoverflow.com/users/3420060/crizly"}, "edited": false, "score": 0, "creation_date": 1530657887, "post_id": 51163646, "comment_id": 89310611, "body": "Nah, just a human... :)"}, {"owner": {"reputation": 614, "user_id": 3979762, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf5839527eaffda8a0389209f724cc87?s=128&d=identicon&r=PG&f=1", "display_name": "braindf", "link": "https://stackoverflow.com/users/3979762/braindf"}, "edited": false, "score": 1, "creation_date": 1530658625, "post_id": 51163646, "comment_id": 89310815, "body": "The good and old confusion about big endian  and little endian representation"}, {"owner": {"reputation": 200780, "user_id": 116908, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/54d38793d7a407446999b33b81d607fd?s=128&d=identicon&r=PG", "display_name": "Carl Norum", "link": "https://stackoverflow.com/users/116908/carl-norum"}, "reply_to_user": {"reputation": 614, "user_id": 3979762, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf5839527eaffda8a0389209f724cc87?s=128&d=identicon&r=PG&f=1", "display_name": "braindf", "link": "https://stackoverflow.com/users/3979762/braindf"}, "edited": false, "score": 0, "creation_date": 1530670751, "post_id": 51163646, "comment_id": 89313154, "body": "@braindf - endianness has nothing to do with bit order. It refers to the ordering of bytes in a word."}], "tags": [], "owner": {"reputation": 325, "user_id": 9900875, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-rhxM-SVSbsQ/AAAAAAAAAAI/AAAAAAAAAFo/n1-jj0Xou34/photo.jpg?sz=128", "display_name": "OregonJim", "link": "https://stackoverflow.com/users/9900875/oregonjim"}, "is_accepted": false, "score": 2, "last_activity_date": 1530657532, "creation_date": 1530657532, "answer_id": 51163646, "question_id": 51163578, "link": "https://stackoverflow.com/questions/51163578/select-a-range-of-bits-from-bytes/51163646#51163646", "title": "Select a range of bits from bytes", "body": "<p>The position parameter starts from the least significant bit.  In other words, count from the right, not the left.</p>\n"}, {"comments": [{"owner": {"reputation": 909, "user_id": 3420060, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/lrXwx.png?s=128&g=1", "display_name": "Crizly", "link": "https://stackoverflow.com/users/3420060/crizly"}, "edited": false, "score": 0, "creation_date": 1530657755, "post_id": 51163651, "comment_id": 89310576, "body": "Just realised I&#39;m counting from the wrong side ... it&#39;s been a long day"}], "tags": [], "owner": {"reputation": 200780, "user_id": 116908, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/54d38793d7a407446999b33b81d607fd?s=128&d=identicon&r=PG", "display_name": "Carl Norum", "link": "https://stackoverflow.com/users/116908/carl-norum"}, "is_accepted": false, "score": 2, "last_activity_date": 1530657558, "creation_date": 1530657558, "answer_id": 51163651, "question_id": 51163578, "link": "https://stackoverflow.com/questions/51163578/select-a-range-of-bits-from-bytes/51163651#51163651", "title": "Select a range of bits from bytes", "body": "<p>The four bits at position 4 (what most people would call \"bit 3\") of your number are <code>1111</code>, so you're getting the expected output:</p>\n\n<pre><code>0000100011111111\n         ^^^^ these ones\n</code></pre>\n\n<p>It looks like you wanted:</p>\n\n<pre><code>getBits(2303, 4, 9)\n</code></pre>\n"}], "owner": {"reputation": 909, "user_id": 3420060, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/lrXwx.png?s=128&g=1", "display_name": "Crizly", "link": "https://stackoverflow.com/users/3420060/crizly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "closed_date": 1530692656, "answer_count": 2, "score": 0, "last_activity_date": 1530657782, "creation_date": 1530657076, "last_edit_date": 1530657782, "question_id": 51163578, "link": "https://stackoverflow.com/questions/51163578/select-a-range-of-bits-from-bytes", "closed_reason": "Not suitable for this site", "title": "Select a range of bits from bytes", "body": "<p>[edit] Please close/delete, I was just counting from the wrong side. </p>\n\n<p>I'm working with this function with the hopes of extracting some number of bits from a starting position in a value.</p>\n\n<pre><code>// Extract K bits from position P in the value\nint getBits(int value, int k, int p)\n{\n   return (((1 &lt;&lt; k) - 1) &amp; (value &gt;&gt; (p - 1)));\n}\n</code></pre>\n\n<p>When I test it with the int 2303 (0000100011111111) I get an output of 15. </p>\n\n<pre><code>printf(\"%d\\n\", getBits(2303,4,4));\n</code></pre>\n\n<p>I'm trying to grab the 4 bits starting at position 4 to make it print out 8. Where am I going wrong? </p>\n"}, {"tags": ["c", "pointers", "data-structures"], "comments": [{"owner": {"reputation": 1273, "user_id": 2287427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b12dacf80e8ab397c3fdcd4f0d49c32d?s=128&d=identicon&r=PG", "display_name": "Dave S", "link": "https://stackoverflow.com/users/2287427/dave-s"}, "edited": false, "score": 0, "creation_date": 1530654137, "post_id": 51163142, "comment_id": 89309599, "body": "You&#39;re passing by value.  By ref is foo&amp;  (notice the &quot;&amp;&quot;) in the declaration."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "reply_to_user": {"reputation": 1273, "user_id": 2287427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b12dacf80e8ab397c3fdcd4f0d49c32d?s=128&d=identicon&r=PG", "display_name": "Dave S", "link": "https://stackoverflow.com/users/2287427/dave-s"}, "edited": false, "score": 7, "creation_date": 1530654240, "post_id": 51163142, "comment_id": 89309635, "body": "@DaveS C doesn&#39;t have references."}, {"owner": {"reputation": 151, "user_id": 5701631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd4416b47b386a7e776f9a2e1596d6fb?s=128&d=identicon&r=PG&f=1", "display_name": "Nova Ardent", "link": "https://stackoverflow.com/users/5701631/nova-ardent"}, "edited": false, "score": 1, "creation_date": 1530654351, "post_id": 51163142, "comment_id": 89309674, "body": "melpomene is correct. If you wanted to use &#39;references&#39; you&#39;d have to make the function void func(struct type * s), then pass it your struct using &amp;, to pass it the pointer"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1530654631, "post_id": 51163142, "comment_id": 89309758, "body": "<code>scanf</code> <code>%s</code> is fundamentally unsafe (you&#39;re reading unlimited input into a fixed-size buffer). Also, using <code>scanf</code> for user input is a bad idea in general. Consider using <code>fgets</code> instead."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1530654888, "post_id": 51163142, "comment_id": 89309835, "body": "The fact that the functions don&#39;t return anything does not bear directly on the problem."}, {"owner": {"reputation": 1273, "user_id": 2287427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b12dacf80e8ab397c3fdcd4f0d49c32d?s=128&d=identicon&r=PG", "display_name": "Dave S", "link": "https://stackoverflow.com/users/2287427/dave-s"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1530655068, "post_id": 51163142, "comment_id": 89309894, "body": "@melpomene - d&#39;oh!  It&#39;s been a few years since I&#39;ve worked with &quot;real&quot; C instead of C code compiled in C++.  I assumed the question made sense in newer versions of C  :)"}], "answers": [{"comments": [{"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 3, "creation_date": 1530654580, "post_id": 51163217, "comment_id": 89309740, "body": "More importantly, a similar change needs to be made in <b>get</b>ContactInfo()."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1530654821, "post_id": 51163217, "comment_id": 89309814, "body": "Indeed, the primary reason to make that change to <b>show</b>ContactInfo() is for consistency.  It already works as it is, because it&#39;s not trying to modify the structure."}, {"owner": {"reputation": 3, "user_id": 10029022, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ShFOcK7_2gg/AAAAAAAAAAI/AAAAAAAAAHA/UspBkg13Wps/photo.jpg?sz=128", "display_name": "Robert Trapp", "link": "https://stackoverflow.com/users/10029022/robert-trapp"}, "edited": false, "score": 0, "creation_date": 1530655230, "post_id": 51163217, "comment_id": 89309936, "body": "Thank you guys.  I made the changes.  I def need to understand pointers.This may sound like a dumb question. How would I call the functions in main now?"}], "tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": false, "score": 2, "last_activity_date": 1530654505, "creation_date": 1530654505, "answer_id": 51163217, "question_id": 51163142, "link": "https://stackoverflow.com/questions/51163142/passing-a-struct-by-reference-instead-of-value-within-void-functions/51163217#51163217", "title": "Passing a struct by reference instead of value within void functions", "body": "<p>The C way for doing this is just plain old pointers:</p>\n\n<pre><code>void showContactInfo(struct ContactInfo* gc)\n{\n    printf(\"* First Name: %s \\n\", gc-&gt;fname);\n\n    printf(\"* Last Name: %s \\n\", gc-&gt;lname);\n}\n</code></pre>\n\n<p>Other than having to use the arrow operator <code>-&gt;</code> to access properties it's basically the same.</p>\n\n<p>C itself does not have references like C++ does.</p>\n"}, {"comments": [{"owner": {"reputation": 1273, "user_id": 2287427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b12dacf80e8ab397c3fdcd4f0d49c32d?s=128&d=identicon&r=PG", "display_name": "Dave S", "link": "https://stackoverflow.com/users/2287427/dave-s"}, "edited": false, "score": 0, "creation_date": 1530823270, "post_id": 51163355, "comment_id": 89380791, "body": "This approach requires allocating 2 structs and copying between them, which is fine if it&#39;s only done once but it would be faster and use only one allocation (and no copying) to either pass a pointer, or to have the function malloc the struct and return a pointer."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 1273, "user_id": 2287427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b12dacf80e8ab397c3fdcd4f0d49c32d?s=128&d=identicon&r=PG", "display_name": "Dave S", "link": "https://stackoverflow.com/users/2287427/dave-s"}, "edited": false, "score": 0, "creation_date": 1530825293, "post_id": 51163355, "comment_id": 89381644, "body": "@DaveS Please post a benchmark showing the alleged speed difference.  A stack allocation is a single instruction so it would be interesting if you can measure this. Also I doubt there is a copy associated with the return value (e.g. x64 ABI in fact mandates that there is not a copy). My guess would be that <code>malloc</code> is orders of magnitude slower than this."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 1273, "user_id": 2287427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b12dacf80e8ab397c3fdcd4f0d49c32d?s=128&d=identicon&r=PG", "display_name": "Dave S", "link": "https://stackoverflow.com/users/2287427/dave-s"}, "edited": false, "score": 0, "creation_date": 1530825354, "post_id": 51163355, "comment_id": 89381663, "body": "The <code>showContactInfo</code> could perhaps be hand-optimized to pass by pointer"}, {"owner": {"reputation": 1273, "user_id": 2287427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b12dacf80e8ab397c3fdcd4f0d49c32d?s=128&d=identicon&r=PG", "display_name": "Dave S", "link": "https://stackoverflow.com/users/2287427/dave-s"}, "edited": false, "score": 0, "creation_date": 1530830315, "post_id": 51163355, "comment_id": 89383116, "body": "You&#39;re correct for this example.  Sorry if my comment was too brief to be clear.  I meant in general, not for this specific simple case.  In general alloc-create-alloc-copy is going to be worse than just alloc-create especially for larger more complicated structs and such structs might not even fit comfortably on the stack."}], "tags": [], "owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "is_accepted": false, "score": 1, "last_activity_date": 1530655358, "creation_date": 1530655358, "answer_id": 51163355, "question_id": 51163142, "link": "https://stackoverflow.com/questions/51163142/passing-a-struct-by-reference-instead-of-value-within-void-functions/51163355#51163355", "title": "Passing a struct by reference instead of value within void functions", "body": "<p>The <code>getContactInfo</code> function is supposed to return values, but you pass values in instead.</p>\n\n<p>The most natural  way to get data out of a function is to use the return value. Also you should not use global variables for passing data.  The code could look like:</p>\n\n<pre><code>struct ContactInfo getContactInfo(void)\n{\n    struct ContactInfo g = { 0 };  // ensure no garbage in case input fails\n\n    printf(\"First Name: \");\n    scanf(\"%49s\", g.fname);\n\n    printf(\"Last Name: \");\n    scanf(\"%49s\", g.lname);\n\n    return g;\n}\n</code></pre>\n\n<p>with the code in <code>main</code> being:</p>\n\n<pre><code>struct ContactInfo gc = getContactInfo();\nshowContactInfo(gc);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": true, "score": 1, "last_activity_date": 1530656205, "creation_date": 1530656205, "answer_id": 51163447, "question_id": 51163142, "link": "https://stackoverflow.com/questions/51163142/passing-a-struct-by-reference-instead-of-value-within-void-functions/51163447#51163447", "title": "Passing a struct by reference instead of value within void functions", "body": "<p>For <code>getContactInfo</code>, you need to pass a pointer to the struct:</p>\n\n<pre><code>void getContactInfo( struct ContactInfo *gcptr )\n{\n  printf(\"First Name: \");\n  scanf(\"%s\", gcptr-&gt;fname);\n\n  printf(\"\\nLast Name: \");\n  scanf(\"%s\", gcptr-&gt;lname);\n}\n</code></pre>\n\n<p>Since you're trying to modify the contents <code>gc</code>, you need to pass a pointer to it to the function.  Remember that C passes all arguments by value, so the called function creates a separate, duplicate object that receives the value of the parameter.  Your code is modifying that duplicate object, which has no effect on the actual parameter.  </p>\n\n<p>The <code>-&gt;</code> operator is used when the operand is a pointer to a <code>struct</code> or <code>union</code> type - it implicitly dereferences the pointer before accessing the particular member.  It's equivalent to writing <code>(*gcptr).fname</code> and <code>(*gcptr).lname</code>, while being a little easier on the eyes.  </p>\n\n<p>You'd call this function as</p>\n\n<pre><code>getContactInfo( &amp;gc );\n</code></pre>\n\n<p>For <code>showContactInfo</code>, you can leave it as it is since you're not trying to modify the parameter.  However, a lot of people like to pass pointers to <code>struct</code>s to save memory (you're not building a copy of the <code>struct</code> in the called function).  If you want to use a pointer, I would recommend using the <code>const</code> keyword like so:</p>\n\n<pre><code>void showContactInfo( const struct ContactInfo *gcptr )\n{\n  printf(\"* First Name: %s \\n\", gcptr-&gt;fname);\n  printf(\"* Last Name: %s \\n\", gcptr-&gt;lname);\n}\n</code></pre>\n\n<p>The <code>const</code> keyword tells the compiler to yell at me if I try to modify the contents of the object <code>gcptr</code> points to in the <code>showContactInfo</code> function.  Like <code>getContactInfo</code> above, you'd call it as</p>\n\n<pre><code>showContactInfo( &amp;gc );\n</code></pre>\n\n<p>Note that I changed the argument names to <code>gcptr</code> just to help distinguish between the formal argument in the function definition and the actual argument in the function call.  I normally don't like putting any kind of type information in a variable or argument name, but you can use whatever naming convention you like.  </p>\n"}], "owner": {"reputation": 3, "user_id": 10029022, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ShFOcK7_2gg/AAAAAAAAAAI/AAAAAAAAAHA/UspBkg13Wps/photo.jpg?sz=128", "display_name": "Robert Trapp", "link": "https://stackoverflow.com/users/10029022/robert-trapp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 51163447, "answer_count": 3, "score": -1, "last_activity_date": 1530656205, "creation_date": 1530654035, "last_edit_date": 1530654899, "question_id": 51163142, "link": "https://stackoverflow.com/questions/51163142/passing-a-struct-by-reference-instead-of-value-within-void-functions", "title": "Passing a struct by reference instead of value within void functions", "body": "<p>I am trying to create a contact list using structures and functions. Currently my code compiles but the members of the struct are not being modified outside of the function like I am trying to do. Here is my code(removed some lines for length)</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nstruct ContactInfo\n{\n    char fname[50];\n    char lname[50];\n};\n\nstruct ContactInfo gc;\n\nvoid getContactInfo(struct ContactInfo gc)\n{\n    printf(\"First Name: \");\n    scanf(\"%s\", gc.fname);\n\n    printf(\"\\nLast Name: \");\n    scanf(\"%s\", gc.lname);\n}\n\nvoid showContactInfo(struct ContactInfo gc)\n{\n    printf(\"* First Name: %s \\n\", gc.fname);\n\n    printf(\"* Last Name: %s \\n\", gc.lname);\n}\n\nint main()\n{\n    getContactInfo(gc);\n\n    showContactInfo(gc);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 8, "creation_date": 1530652232, "post_id": 51162821, "comment_id": 89308996, "body": "If you have never coded in C before, you&#39;re probably in over you head, and the teacher gave you bad advice. The Python solution might be <i>good enough</i>, which really is good enough. If you want to be able to produce an optimized and well-working C version of your Python program, you need to really know C and have experience programming in it."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 3, "creation_date": 1530652289, "post_id": 51162821, "comment_id": 89309018, "body": "First comment is not to mix <code>double </code>with <code>float</code>. If you can use <code>double</code>: use it for all. Second comment is that <code>double deltaT = time_window&#47;num_points;</code> performs <i>integer division</i> because both operands are <code>int</code> type so <code>90 &#47; 1000</code> will be <code>0</code>. Cast it like <code>double deltaT = (double)time_window&#47;num_points;</code>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1530652491, "post_id": 51162821, "comment_id": 89309082, "body": "<code>double v[num_points][num_neurons]; memset(v, 0, num_points * num_neurons * sizeof(long));</code> is suspicious.  Suggest <code>double v[num_points][num_neurons] = {0};</code>.  Or zero fill with <code>memset(v, 0, sizeof v);</code> is you really want to use <code>memset();</code>"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1530652663, "post_id": 51162821, "comment_id": 89309136, "body": "To add to @Someprogrammerdude - if Python is not &quot;good enough&quot;, you can go Java or some other memory/type/otherwise safe compiled languages, which will save you a lot of headache you are going to have with C."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1530652676, "post_id": 51162821, "comment_id": 89309143, "body": "<code>compteur[pos_1] += 1 &#47; deltaT &#47; num_neurons;</code> is unclear with its FP math incrementing an integer.  Perhaps that is always  <code>compteur[pos_1] += something_less_than_1;</code>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1530652759, "post_id": 51162821, "comment_id": 89309176, "body": "Tip: the above 2 concerns quickly identified with all warnings enabled.  Save time and enable all compiler warnings."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1530652994, "post_id": 51162821, "comment_id": 89309257, "body": "@chux a VLA can&#39;t be initialised with <code>{ 0 }</code>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1530653542, "post_id": 51162821, "comment_id": 89309420, "body": "@WeatherVane True - IIRC, a VLA cannot be initialized with anything.  <code>memset(v, 0, sizeof v);</code> can do the job - or make an explicit loop."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1530653718, "post_id": 51162821, "comment_id": 89309472, "body": "@chux similarly for <code>long  compteur[num_points];</code>"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1530654184, "post_id": 51162821, "comment_id": 89309617, "body": "To add to @chux first comment <code>memset(v, 0, num_points *num_neurons* sizeof(long) );</code> is using the <b><i>wrong type</i></b>. It should be <code>memset(v, 0, num_points*num_neurons*sizeof(double) );</code> or to be even safer, <code>memset(v, 0, num_points*num_neurons*sizeof(v[0][0]) );</code>"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1530655140, "post_id": 51162821, "comment_id": 89309915, "body": "You do not need to provide your own declarations of <code>fopen</code> and <code>fclose</code>, and in fact you should avoid doing so.  Including header file <code>stdio.h</code> provides these for you."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1530656142, "post_id": 51162821, "comment_id": 89310191, "body": "If you use <code>rand()</code> and want to produce a different series of (pseudo-)random numbers from run to run, then you need to <i>seed</i> the random number generator, via <code>srand()</code>, with a number that varies from run to run."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1530656533, "post_id": 51162821, "comment_id": 89310284, "body": "@JohnBollinger good point. During the debugging phase I prefer to comment that out, so each run produces the same sequence of &quot;random&quot; numbers."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1530657884, "post_id": 51162821, "comment_id": 89310608, "body": "Your Python code assigns a value to <code>compteur</code> from <code>np.zeroes()</code>.  As used, that will produce 64-bit <i>floating point</i> zeroes, but your C code declares the analogous array to have an integer element type (<code>long</code>).  That probably explains the anomalous use of that array."}], "answers": [{"comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1530656039, "post_id": 51163218, "comment_id": 89310160, "body": "Since <code>sizeof compteur</code> must be known at compile time can that work with a VLA whose size is not known until run time? The code does state <code>int num_points = 1000;</code> but that is not <code>const</code> and might change at run time."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1530657952, "post_id": 51163218, "comment_id": 89310629, "body": "@WeatherVane &quot;<code>sizeof compteur</code> must be known at compile time&quot; --&gt; No.  6.5.3.4 goes into details, yet <code>sizeof some_vla</code> is well defined. See <a href=\"https://stackoverflow.com/q/14995870/2410359\">stackoverflow.com/q/14995870/2410359</a>"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1530658307, "post_id": 51163218, "comment_id": 89310730, "body": "Thanks subsection 2 says &quot;If the type of the operand is a variable length array type, the operand is evaluated; otherwise, the operand is not evaluated and the result is an integer constant.&quot; Sadly I don&#39;t have (optional) VLAs so can&#39;t compile."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1530658653, "post_id": 51163218, "comment_id": 89310827, "body": "I&#39;d suggest just getting rid of the VLAs by changing <code>num_points</code> and <code>num_neurons</code> into macros.  Then you can dump the <code>memset()</code> calls in favor of initializers, too."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1530658888, "post_id": 51163218, "comment_id": 89310888, "body": "@JohnBollinger Perhaps.  I suspect OP, at a later time, will want to assign <code>num_points, num_neurons</code> at run-time.  Given their sample values of 1000, allocated memory may be most wise."}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": true, "score": 1, "last_activity_date": 1530660061, "last_edit_date": 1530660061, "creation_date": 1530654511, "answer_id": 51163218, "question_id": 51162821, "link": "https://stackoverflow.com/questions/51162821/eulers-method-for-neuroscience-in-c/51163218#51163218", "title": "Euler&#39;s method for neuroscience in C", "body": "<p>Code repaired as able with old code commented out.  See comments for change details.</p>\n\n<p>Need to see <code>challala.txt</code> for a definitive test.</p>\n\n<pre><code>#include &lt;math.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\n// Why use a coarse approximation?\n//#define PI 3.1415926536\n#define PI 3.1415926535897932384626433832795\n\n// Let us stick to double only.\n//float s(float x, float);\ndouble s(double x, double);\n\n// Add void, else declaration does not check the parameters.\n//double AWGN_generator();\ndouble AWGN_generator(void);\n\n// These should have already been declared in &lt;stdio.h&gt;\n// FILE* fopen(const char* nomDuFichier, const char* modeOuverture);\n// int fclose(FILE* pointeurSurFichier);\n\nint main(int argc, char *argv[]) {\n  //parameters\n  double eps = 0.05;\n  // float f = 0.215;\n  double f = 0.215;\n  double mu = 1.1;\n  double D = 0.001;\n  int time_window = 90;\n\n  // Unclear why `int/long` used here.  size_t would be idiomatic for array sizing.\n  int num_points = 1000;\n  long num_neurons = 1000;\n\n  // Avoid integer division when a FP quotinet is desired\n  // double deltaT = time_window / num_points;\n  double deltaT = 1.0*time_window / num_points;\n  int i;\n\n  //time\n  double Time[num_points];\n\n  Time[0] = 0.0;\n\n  for (i = 1; i &lt; num_points; i++)     \n  {\n    Time[i] = Time[i - 1] + deltaT;\n  }\n\n  //opening file for saving data\n  FILE* fichier = NULL;\n  fichier = fopen(\"challala.txt\", \"w\");\n  if (fichier != NULL) {\n    double v[num_points][num_neurons];\n    // zero fill use wrong type in sizeof.  \n    // Avoid type in sizeof, better to use sizeof object\n    // memset(v, 0, num_points * num_neurons * sizeof(long));\n    memset(v, 0, sizeof v);\n\n    // Let us use FP here.\n    //long compteur[num_points];\n    double compteur[num_points];\n    memset(compteur, 0, sizeof compteur);\n\n    int pos_1;\n    int pos_2;\n    //Euler's method\n    for (pos_1 = 1; pos_1 &lt; num_points; pos_1++)\n    {\n      for (pos_2 = 0; pos_2 &lt; num_neurons; pos_2++) {\n        // float t = Time[pos_1 - 1];\n        double t = Time[pos_1 - 1];\n        v[pos_1][pos_2] = v[pos_1 - 1][pos_2]\n            + deltaT * (-v[pos_1 - 1][pos_2] + mu + eps * s(t, f))\n            + sqrt(2 * D * deltaT) * AWGN_generator();\n\n        if (v[pos_1][pos_2] &gt; 1) {\n          v[pos_1][pos_2] = 0;\n          compteur[pos_1] += 1 / deltaT / num_neurons;\n        }\n      }\n      // Change of type\n      // fprintf(fichier, \"%ld\", compteur[pos_1]);\n      fprintf(fichier, \" %g\", compteur[pos_1]);\n    }\n\n    fclose(fichier);\n    printf(\"ca a marche test.txt\");\n\n  } else {\n\n    // Was not the file another name?\n    // printf(\"Impossible d'ouvrir le fichier test.txt\");\n    printf(\"Impossible d'ouvrir le fichier \\\"%s\\\"\\n\", challala.txt);\n  }\n\n  return 0;\n}\n\n//float s(float x, float f) {\ndouble s(double x, double f) {\n  // M_PI is not defined in the standard C library, although common in extensions.\n  //return sin(2 * M_PI * f * x);\n  return sin(2 * PI * f * x);\n}\n\ndouble AWGN_generator() {    \n  double temp1;\n  double temp2;\n  double result;\n\n  int p;\n  p = 1;\n  while (p &gt; 0) {\n    temp2 = (rand() / ((double) RAND_MAX));\n    if (temp2 == 0) {  // temp2 is &gt;= (RAND_MAX / 2)\n      p = 1;\n    }  // end if\n    else {  // temp2 is &lt; (RAND_MAX / 2)\n      p = -1;\n    }  // end else\n  }  // end while()\n\n  temp1 = cos((2.0 * (double) PI) * rand() / ((double) RAND_MAX));\n  result = sqrt(-2.0 * log(temp2)) * temp1;\n  return result;    // return the generated random sample to the caller\n}\n</code></pre>\n\n<hr>\n\n<p>Minor and advanced numeric issue:</p>\n\n<p>Realize that quotient <code>1.0*time_window / num_points</code> maybe be a little different than mathematical expected due to finite precision of <code>double</code>.  This is, at worst, expected to be a very small amount, maybe about 0.5 parts in 2<sup>53</sup>.  </p>\n\n<p>Yet the repetitive additions accumulate the error.  </p>\n\n<pre><code>  double deltaT = 1.0*time_window / num_points;\n  int i;\n  double Time[num_points];\n  Time[0] = 0.0;\n  for (i = 1; i &lt; num_points; i++) {\n    Time[i] = Time[i - 1] + deltaT;\n  }\n</code></pre>\n\n<p>To avoid that accumulated error, code can re-calculate <code>Time[i]</code> anew on each iteration.</p>\n\n<pre><code>  double deltaT = 1.0*time_window / num_points;\n  double Time[num_points];\n  for (int i = 0; i &lt; num_points; i++) {\n    Time[i] = deltaT*i;\n  }\n</code></pre>\n\n<p>Of course, such small errors are often ignorable, but mayne not when <code>num_points</code> is large enough.  This happens when your good code is applied to ever larger tasks.</p>\n"}, {"tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": false, "score": 0, "last_activity_date": 1530658344, "last_edit_date": 1530658344, "creation_date": 1530657773, "answer_id": 51163678, "question_id": 51162821, "link": "https://stackoverflow.com/questions/51162821/eulers-method-for-neuroscience-in-c/51163678#51163678", "title": "Euler&#39;s method for neuroscience in C", "body": "<p>regarding the following 3 statements</p>\n\n<pre><code>int time_window = 90;\nint num_points = 1000;\n\ndouble deltaT = time_window/num_points;\n</code></pre>\n\n<p>Since <code>time_window</code> and <code>num_points</code> are integers, the division is performed as an integer divide.</p>\n\n<p>In an integer divide, all fractions are truncated.</p>\n\n<p>the expression: <code>time_window/num_points</code> is actually:</p>\n\n<pre><code>90 / 1000\n</code></pre>\n\n<p>the resulting fraction has everything right of the decimal point truncated, so the result is 0</p>\n\n<p>so: Time[0] + 0 results in 0.0.  </p>\n\n<p>The same (calculated) value: 0.0 is then propagated thorough the whole array</p>\n\n<p>suggest changing:</p>\n\n<pre><code>int time_window = 90;\nint num_points = 1000;\n</code></pre>\n\n<p>to</p>\n\n<pre><code>double time_window = 90.0;\ndouble num_points  = 1000.0;\n</code></pre>\n\n<p>regarding:</p>\n\n<pre><code>memset(v, 0, num_points*num_neurons*sizeof(long) );\n</code></pre>\n\n<p>this statement may (or may not) perform the desired functionality.  It depends on if the size of <code>double</code> is the same as the size of <code>long</code></p>\n\n<p>Suggest using:</p>\n\n<pre><code>memset( v, 0, sizeof( v ) );\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 10028830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d378e26a7c486fb7afdce2ba78b91dc?s=128&d=identicon&r=PG&f=1", "display_name": "MarcM", "link": "https://stackoverflow.com/users/10028830/marcm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "closed_date": 1530693883, "accepted_answer_id": 51163218, "answer_count": 2, "score": -2, "last_activity_date": 1530664350, "creation_date": 1530651998, "last_edit_date": 1530664350, "question_id": 51162821, "link": "https://stackoverflow.com/questions/51162821/eulers-method-for-neuroscience-in-c", "closed_reason": "Needs more focus", "title": "Euler&#39;s method for neuroscience in C", "body": "<p>I need to estimate for my internship the firing rate of neurons that follows an ODE. I code at first in python and it goes pretty well but for better performance, my supervisor told to write the same code in C. However, I never coded in C so I am a very beginner and the file in which i want to have the values for the firing rate is full of zero... Can someone help me ?</p>\n\n<p>Thank you very much</p>\n\n<p>So here is my python code  : </p>\n\n<pre><code>import numpy as np\nimport matplotlib.pyplot as plt\nfrom math import cos, sin, sqrt, pi, exp as cos, sin, sqrt, pi, exp\n#parameters\neps = 0.05\nf = 0.215\nmu = 1.1\nD = 0.001\nDeltaT = 0.01\ntimewindow = 40\nnum_points = int(timewindow/DeltaT)\nT = np.linspace(0, timewindow, num_points)\n#signal\ns = [sin(2*3.14*f*t) for t in T]\nN=30000\ncompteur=np.zeros(num_points)\nv = np.zeros((num_points,N))\nsamples = np.random.normal(0, 1, (num_points,N))\nfor i in range(1,num_points):\n     for j in range(N):\n        v[i,j] = v[i-1,j] + DeltaT *(-v[i-1,j]+ mu + eps*s[i-1]) + \\\n                sqrt(2*D*DeltaT)*samples[i,j]\n        if v[i,j]&gt;1:\n            v[i,j]=0\n            compteur[i]+=1/DeltaT/N\n\n\nplt.plot(T,compteur)\nplt.show()\n</code></pre>\n\n<p>and here is my \"translation\" in C : </p>\n\n<pre><code>#include &lt;math.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#define PI 3.1415926536\nfloat s(float x, float);\ndouble AWGN_generator();\nFILE* fopen(const char* nomDuFichier, const char* modeOuverture);\nint fclose(FILE* pointeurSurFichier);\n\nint main(int argc, char *argv[])\n{\n   //parameters\n   double eps = 0.05;\n   float f = 0.215 ;\n   double mu = 1.1 ;\n   double D = 0.001 ;\n   int time_window = 90;\n   int num_points = 1000;\n   long num_neurons = 1000;\n   double deltaT = time_window/num_points;\n   int i ;\n\n  //time \n   double Time[num_points] ;\n\n   Time[0]= 0.0;\n\n   for (i = 1 ;  i &lt; num_points ; i++ )\n\n      {   Time[i] = Time[i-1] + deltaT;\n      }\n\n   //opening file for saving data\n   FILE* fichier = NULL;\n\n   fichier = fopen(\"challala.txt\", \"w\");\n\n    if (fichier != NULL)\n   {\n       double v[num_points][num_neurons] ;\n       memset(v, 0, num_points*num_neurons*sizeof(long) );\n       long  compteur[num_points];\n       memset( compteur, 0, num_points*sizeof(long) );\n\n       int pos_1 ;\n       int  pos_2 ;\n     //Euler's method\n       for (pos_1 = 1 ; pos_1 &lt; num_points ; pos_1 ++)\n\n      {\n           for (pos_2 = 0 ; pos_2&lt;num_neurons ; pos_2 ++)\n          {\n               float t = Time[pos_1-1] ;\n               v[pos_1][pos_2] = v[pos_1-1][pos_2] + deltaT *(-v[pos_1-1] \n            [pos_2]+ mu + eps*s(t, f))+ sqrt(2*D*deltaT)*AWGN_generator();\n\n                if (v[pos_1][pos_2]&gt;1)\n                   {\n                      v[pos_1][pos_2]=0 ;\n                      compteur[pos_1]+=1/deltaT/num_neurons ;\n                   }\n           }\n           fprintf(fichier, \"%ld\",compteur[pos_1]);\n\n      }\n\n   fclose(fichier);\n   printf(\"ca a marche test.txt\");\n\n  }\n  else\n    {\n        // On affiche un message d'erreur si on veut\n        printf(\"Impossible d'ouvrir le fichier test.txt\");\n    }\n\n    return 0;\n }\n\n  float s(float x, float f)\n {\n  return sin(2*M_PI*f*x);\n }\n\n\n\n double AWGN_generator()\n {/* Generates additive white Gaussian Noise samples with zero mean and a \n  standard deviation of 1. */\n\n  double temp1;\n  double temp2;\n  double result;\n  int p;\n\n  p = 1;\n\n  while( p &gt; 0 )\n  {\n    temp2 = ( rand() / ( (double)RAND_MAX ) ); /*  rand() function generates an\n                                                   integer between 0 and  \n                                                                 RAND_MAX,\n                                                   which is defined in \n                                                     stdlib.h.\n                                               */\n\n   if ( temp2 == 0 )\n    {// temp2 is &gt;= (RAND_MAX / 2)\n     p = 1;\n    }// end if\n   else\n   {// temp2 is &lt; (RAND_MAX / 2)\n      p = -1;\n    }// end else\n\n  }// end while()\n\n  temp1 = cos( ( 2.0 * (double)PI ) * rand() / ( (double)RAND_MAX ) );\n  result = sqrt( -2.0 * log( temp2 ) ) * temp1;\n\n  return result;    // return the generated random sample to the caller\n\n }\n</code></pre>\n"}, {"tags": ["c++", "c", "pthreads", "glibc", "condition-variable"], "comments": [{"owner": {"reputation": 10487, "user_id": 840960, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c79d55b76b6994dec3fb96bd1c7803bf?s=128&d=identicon&r=PG", "display_name": "Shlublu", "link": "https://stackoverflow.com/users/840960/shlublu"}, "edited": false, "score": 0, "creation_date": 1530652286, "post_id": 51162723, "comment_id": 89309016, "body": "I think we&#39;ll have to investigate in this to get why: <a href=\"https://code.woboq.org/userspace/glibc/nptl/pthread_cond_wait.c.html\" rel=\"nofollow noreferrer\">code.woboq.org/userspace/glibc/nptl/pthread_cond_wait.c.html</a>"}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1530652909, "post_id": 51162723, "comment_id": 89309226, "body": "This is C++, not C."}, {"owner": {"reputation": 558, "user_id": 4207183, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-FlaU_rcEFmQ/AAAAAAAAAAI/AAAAAAAAF-Y/UVEWfvV4tKE/photo.jpg?sz=128", "display_name": "Alejandro Visiedo Garc&#237;a", "link": "https://stackoverflow.com/users/4207183/alejandro-visiedo-garc%c3%ada"}, "edited": false, "score": 0, "creation_date": 1530653371, "post_id": 51162723, "comment_id": 89309368, "body": "launch with &quot;strace -f ./a.out&quot; and see what happened, or debug with gdb."}, {"owner": {"reputation": 10487, "user_id": 840960, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c79d55b76b6994dec3fb96bd1c7803bf?s=128&d=identicon&r=PG", "display_name": "Shlublu", "link": "https://stackoverflow.com/users/840960/shlublu"}, "reply_to_user": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 1, "creation_date": 1530686606, "post_id": 51162723, "comment_id": 89317715, "body": "@ChristianGibbons The question is related to a C function. The example code that uses this C function is written in C++ but this is not the question."}], "answers": [{"comments": [{"owner": {"reputation": 952, "user_id": 756120, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/d6dd959f2244e7078d7fe2f824c34f39?s=128&d=identicon&r=PG", "display_name": "Abhishek Sagar", "link": "https://stackoverflow.com/users/756120/abhishek-sagar"}, "edited": false, "score": 0, "creation_date": 1603265048, "post_id": 51163244, "comment_id": 113978498, "body": "Wao ! stucked with the same problem, this saved my life !"}], "tags": [], "owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "is_accepted": true, "score": 9, "last_activity_date": 1530654668, "creation_date": 1530654668, "answer_id": 51163244, "question_id": 51162723, "link": "https://stackoverflow.com/questions/51162723/why-does-pthread-cond-wait-not-block-when-not-linked-with-lpthread/51163244#51163244", "title": "Why does pthread_cond_wait() not block when not linked with &quot;-lpthread&quot;?", "body": "<p>Some glibc functions need locking when your process is multithreaded.\nTo avoid dragging in the libpthread dependency everytime because of that, glibc uses weakrefs to refer to a bunch of pthread functionality. If it detects the functionality is not available (which won't cause a linker error because of the weakref solution) it will default those ops to no-ops (which is just fine because if you don't have pthreads, you can't be multithreaded and locking isn't needed).\nThe upshot of this solution is the behavior you're getting.</p>\n"}], "owner": {"reputation": 3787, "user_id": 5437543, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/ad76496c936d384dac2888bae0126dde?s=128&d=identicon&r=PG&f=1", "display_name": "StoneThrow", "link": "https://stackoverflow.com/users/5437543/stonethrow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 359, "favorite_count": 0, "accepted_answer_id": 51163244, "answer_count": 1, "score": 3, "last_activity_date": 1530723598, "creation_date": 1530651476, "last_edit_date": 1530723598, "question_id": 51162723, "link": "https://stackoverflow.com/questions/51162723/why-does-pthread-cond-wait-not-block-when-not-linked-with-lpthread", "title": "Why does pthread_cond_wait() not block when not linked with &quot;-lpthread&quot;?", "body": "<p>I'm learning about <code>pthread_cond_t</code> and wrote the following code intended to block forever at the <code>pthread_cond_wait()</code>:</p>\n\n<pre><code>// main.cpp\n// Intentionally blocks forever.\n\n#include &lt;iostream&gt;\n#include &lt;cstring&gt;\n#include &lt;cerrno&gt;\n#include &lt;pthread.h&gt;\n\nint main( int argc, char* argv[] )\n{\n  pthread_cond_t cond;\n\n  if ( pthread_cond_init( &amp;cond, NULL ) )\n  {\n    std::cout &lt;&lt; \"pthread_cond_init() failed: \" &lt;&lt; errno &lt;&lt; \"(\" &lt;&lt; strerror( errno ) &lt;&lt; \")\" &lt;&lt; std::endl;\n  }\n\n  pthread_mutex_t mutex;\n\n  if ( pthread_mutex_init( &amp;mutex, NULL ) )\n  {\n    std::cout &lt;&lt; \"pthread_mutex_init() failed: \" &lt;&lt; errno &lt;&lt; \"(\" &lt;&lt; strerror( errno ) &lt;&lt; \")\" &lt;&lt; std::endl;\n  }\n\n  pthread_mutex_lock( &amp;mutex );\n  pthread_cond_wait( &amp;cond, &amp;mutex );\n\n  pthread_cond_destroy( &amp;cond );\n  return 0;\n}\n</code></pre>\n\n<p>When I first compiled/executed this program, the executable <em>did not</em> hang - it exited:</p>\n\n<pre><code>&gt;g++ --version\ng++ (GCC) 4.8.3 20140911 (Red Hat 4.8.3-7)\nCopyright (C) 2013 Free Software Foundation, Inc.\nThis is free software; see the source for copying conditions.  There is NO\nwarranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n\n&gt;g++ -g main.cpp &amp;&amp; ./a.out \n&gt; // &lt;-- Note: returned to bash prompt\n</code></pre>\n\n<p>Next I tried linking against <code>libpthread</code> - and <em>now</em> the executable hung, as expected:</p>\n\n<pre><code>&gt;g++ -g main.cpp -lpthread &amp;&amp; ./a.out \n^C\n&gt; // &lt;-- Needed to send SIGINT to terminate process\n</code></pre>\n\n<p>I was actually expecting to hit a link error for the required <code>pthread</code> functions; why did I not encounter one when I did not explicitly link against <code>libpthread</code>?</p>\n\n<p>This question may be rendered moot by the answer to the above, but when compiling without the explicit link the <code>libpthread</code>, why did the resulting binary \"skip over\" or ignore the <code>pthead_cond_wait()</code>? Is there some default do-nothing implementation for pthread functions in glibc or somewhere?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1530650867, "post_id": 51162573, "comment_id": 89308559, "body": "You are most likely overwriting memory somewhere else in some code you didn&#39;t show here. Show especiually the code that calls <code>WriteArrayForCheck</code>. Read this: <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 3023, "user_id": 5587393, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/1d83bf6603c6c7a002ab8e18e418e2e5?s=128&d=identicon&r=PG&f=1", "display_name": "Marco Luzzara", "link": "https://stackoverflow.com/users/5587393/marco-luzzara"}, "edited": false, "score": 0, "creation_date": 1530650872, "post_id": 51162573, "comment_id": 89308561, "body": "&quot;and a whole bunch of other stuff that doesn&#39;t make sense&quot;: maybe they do not make sense to you, but they could help us understanding the problem."}, {"owner": {"reputation": 109324, "user_id": 21926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6e61d47f9a6ec0a7a286835e51f3332?s=128&d=identicon&r=PG", "display_name": "Sean Bright", "link": "https://stackoverflow.com/users/21926/sean-bright"}, "edited": false, "score": 4, "creation_date": 1530650876, "post_id": 51162573, "comment_id": 89308563, "body": "Two things: that isn&#39;t irony, and <i>and a whole bunch of other stuff that doesn&#39;t make sense</i> - please include that."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1530651085, "post_id": 51162573, "comment_id": 89308632, "body": "Not directly related to your problem, but you can simply write:: <code>outputFile2 = fopen(&quot;OutputArray.txt&quot;, &quot;w&quot;);</code> and drop the first line of your function alltogether."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 2, "creation_date": 1530651531, "post_id": 51162573, "comment_id": 89308756, "body": "Try running your code through valgrind.  If you&#39;re not handling memory correctly (which is what the error suggests) it should tell you where."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 3, "creation_date": 1530652040, "post_id": 51162573, "comment_id": 89308929, "body": "Indexes 1,2,3 are suspicious.  I&#39;d expect 0,1,2."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1530654297, "post_id": 51162573, "comment_id": 89309657, "body": "printf %p out the file pointer just after you open the file and again just before the close.  Are the values the same?  (no, &#39;cos your code in between splatted the pointer:)"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 2, "creation_date": 1530654459, "post_id": 51162573, "comment_id": 89309703, "body": "How are you <i>calling</i> this function?  Especially, how do you declare and initialize the second argument?"}, {"owner": {"reputation": 1079, "user_id": 1884351, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/0ccc73c4be038f1bb08243adc61f5550?s=128&d=identicon&r=PG&f=1", "display_name": "fnisi", "link": "https://stackoverflow.com/users/1884351/fnisi"}, "edited": false, "score": 1, "creation_date": 1530654999, "post_id": 51162573, "comment_id": 89309875, "body": "I haven&#39;t spotted an obvious issue that would cause <code>fclose()</code> to fail. However, you should always check the return value of <code>fopen()</code> before attempting any operation on the file pointer returned by <code>fopen()</code>."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1530656932, "post_id": 51162573, "comment_id": 89310389, "body": "You caused heap corruption earlier in the program and it is showing up at this point"}], "answers": [{"tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 2, "last_activity_date": 1530652777, "last_edit_date": 1530652777, "creation_date": 1530651863, "answer_id": 51162790, "question_id": 51162573, "link": "https://stackoverflow.com/questions/51162573/errors-using-fclose/51162790#51162790", "title": "Errors using fclose()", "body": "<p>The code as posted does not seem to have an obvious problem.</p>\n\n<p>Note however that:</p>\n\n<ul>\n<li>You should always check the return value of <code>fopen()</code> and report failure instead of risking undefined behavior by passing <code>NULL</code> to <code>fprintf</code> and/or <code>fclose</code>.</li>\n<li>You should simplify the first few statements as <code>FILE *outputFile2 = fopen(\"OutputArray.txt\", \"w\");</code></li>\n<li>If you do something more complicated to compute the filename, post it as the problem may lie in seemingly harmless code that you omitted.</li>\n<li>The <code>fprintf</code> conversion specifier for <code>double</code> is <code>%f</code>, the <code>l</code> modifier is useless and ignored in this context. It is required in <code>fscanf()</code> to distinguish between <code>float</code> and <code>double</code>, but not needed in <code>fprintf</code> because <code>float</code> values are always passed as <code>double</code> to variable argument functions.</li>\n<li>The index values <code>1</code>, <code>2</code> and <code>3</code> might be incorrect, arrays are <code>0</code> based in C.</li>\n<li>Stopping the loop at <code>incRow &lt; numLines - 1</code> is unexpected too, why omit the last row of the matrix? If you really mean it, a comment would be helpful to clarify why.</li>\n</ul>\n"}], "owner": {"reputation": 17, "user_id": 10028797, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/281ec912001fc9dad17112d860ea6700?s=128&d=identicon&r=PG&f=1", "display_name": "Mary", "link": "https://stackoverflow.com/users/10028797/mary"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "closed_date": 1530693418, "answer_count": 1, "score": 0, "last_activity_date": 1530652777, "creation_date": 1530650566, "last_edit_date": 1530651576, "question_id": 51162573, "link": "https://stackoverflow.com/questions/51162573/errors-using-fclose", "closed_reason": "Not suitable for this site", "title": "Errors using fclose()", "body": "<p>I have a section of code that fails when I try to use <code>fclose</code> to close an output file.  The code looks as follows:</p>\n\n<pre><code>void WriteArrayForCheck(int numLines, double **Array) {\n    char outFile2[300];\n    sprintf(outFile2, \"OutputArray.txt\");\n    FILE *outputFile2;\n    outputFile2 = fopen(outFile2, \"w\");\n    int incRow;\n    for (incRow = 0; incRow &lt; numLines - 1; incRow++) {\n         fprintf(outputFile2, \"%lf,%lf,%lf\\n\",\n                 Array[incRow][1], Array[incRow][2], Array[incRow][3]);\n    }\n    fclose(outputFile2);\n}\n</code></pre>\n\n<p>I end up with an error related to my executable that says:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>free(): invalid next size (normal): 0x0000000001ce1710 ***\n</code></pre>\n\n<p>and a whole bunch of other stuff that doesn't make sense...  The ironic thing is if I comment out the line related to <code>fclose</code>, then the program does not crash and runs perfectly fine...  I have not had this issue before.  I am sure that my matrices are incremented properly as well.  PLease let me know what you think.</p>\n"}, {"tags": ["c", "loops", "time-complexity", "big-o", "complexity-theory"], "comments": [{"owner": {"reputation": 39159, "user_id": 1541563, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/U4EOh.png?s=128&g=1", "display_name": "Patrick Roberts", "link": "https://stackoverflow.com/users/1541563/patrick-roberts"}, "edited": false, "score": 2, "creation_date": 1530650143, "post_id": 51162446, "comment_id": 89308306, "body": "If you were <i>multiplying</i> by two on each iteration, it would be O(n log n). Maybe that&#39;s what you were confusing it with?"}, {"owner": {"reputation": 393, "user_id": 6399127, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/284c279ef66682bb64409ea3e0d89d18?s=128&d=identicon&r=PG&f=1", "display_name": "sam0101", "link": "https://stackoverflow.com/users/6399127/sam0101"}, "reply_to_user": {"reputation": 39159, "user_id": 1541563, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/U4EOh.png?s=128&g=1", "display_name": "Patrick Roberts", "link": "https://stackoverflow.com/users/1541563/patrick-roberts"}, "edited": false, "score": 0, "creation_date": 1530650565, "post_id": 51162446, "comment_id": 89308453, "body": "@PatrickRoberts No, I know the defference"}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 1, "creation_date": 1530654273, "post_id": 51162446, "comment_id": 89309651, "body": "O-notation ignores constant multipliers. N*N/2 is still O(N*N). N*N/1000 is still O(N*N). You only get N*log(N) if the inner loop only runs (log(N)) times; for example, if it runs twice for N of 100, 3 times for N of 1000, and so on."}], "answers": [{"tags": [], "owner": {"reputation": 1806, "user_id": 4146351, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-2WTdU1bWVaQ/AAAAAAAAAAI/AAAAAAAABeg/yvJBsxf1slM/photo.jpg?sz=128", "display_name": "Eric Yang", "link": "https://stackoverflow.com/users/4146351/eric-yang"}, "is_accepted": true, "score": 9, "last_activity_date": 1530650277, "last_edit_date": 1530650277, "creation_date": 1530650017, "answer_id": 51162470, "question_id": 51162446, "link": "https://stackoverflow.com/questions/51162446/why-is-the-time-complexity-on2-in-this-code/51162470#51162470", "title": "Why is the time complexity O(n^2) in this code?", "body": "<p>By incrementing by two, rather than one, you're doing the following <code>N*N*(1/2)</code>. With big(O) notation, you don't care about the constant, so it's still N*N. This is because big(O) notation reference the complexity of the growth of an algorithm. </p>\n"}, {"tags": [], "owner": {"reputation": 455, "user_id": 3738751, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IWssd.png?s=128&g=1", "display_name": "Pankaj Singh", "link": "https://stackoverflow.com/users/3738751/pankaj-singh"}, "is_accepted": false, "score": 0, "last_activity_date": 1530650776, "last_edit_date": 1530650776, "creation_date": 1530650397, "answer_id": 51162539, "question_id": 51162446, "link": "https://stackoverflow.com/questions/51162446/why-is-the-time-complexity-on2-in-this-code/51162539#51162539", "title": "Why is the time complexity O(n^2) in this code?", "body": "<p>Outer loop will execute for n times and for each outer loop iteration inner loop will execute for n/2 times because j +=2</p>\n\n<p>Order = n\u00d7n/2 = n^2/2 =O(n^2) because constant doesn't affect run time for large n</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 10028911, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DftS3Ov5IOg/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq2mM95_gEw5kXX3QylrBHF4REKMLA/mo/photo.jpg?sz=128", "display_name": "nikhil kumar", "link": "https://stackoverflow.com/users/10028911/nikhil-kumar"}, "is_accepted": false, "score": -1, "last_activity_date": 1530652682, "creation_date": 1530652682, "answer_id": 51162926, "question_id": 51162446, "link": "https://stackoverflow.com/questions/51162446/why-is-the-time-complexity-on2-in-this-code/51162926#51162926", "title": "Why is the time complexity O(n^2) in this code?", "body": "<p>there is an increment of 2 so loop will runs for n/2.So the complexity will be n*n/2.\nif increament happened in GP like 2 </p>\n"}], "owner": {"reputation": 393, "user_id": 6399127, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/284c279ef66682bb64409ea3e0d89d18?s=128&d=identicon&r=PG&f=1", "display_name": "sam0101", "link": "https://stackoverflow.com/users/6399127/sam0101"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1238, "favorite_count": 0, "accepted_answer_id": 51162470, "answer_count": 3, "score": 2, "last_activity_date": 1530652682, "creation_date": 1530649879, "question_id": 51162446, "link": "https://stackoverflow.com/questions/51162446/why-is-the-time-complexity-on2-in-this-code", "title": "Why is the time complexity O(n^2) in this code?", "body": "<p>I just didn't get it, why the time complexity is O(n^2) instead of O(n*logn)?\nThe second loop is incrementing 2 each time so isn't it O(logn)?</p>\n\n<pre><code>void f3(int n){\n  int i,j,s=100;\n  int* ar = (int*)malloc(s*sizeof(int));\n\n  for(i=0; i&lt;n; i++){\n    s=0;\n    for(j=0; j&lt;n; j+=2){\n      s+=j;\n      printf(\"%d\\n\", s);\n  }\n  free(ar);\n}\n</code></pre>\n"}, {"tags": ["c", "gstreamer", "nvidia-jetson"], "answers": [{"tags": [], "owner": {"reputation": 166, "user_id": 10695702, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-L3_2UThWOE8/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-h7qQUqHr5Q9Odt46Jq-Xuxd_p9Qg/mo/photo.jpg?sz=128", "display_name": "Anchal Gupta", "link": "https://stackoverflow.com/users/10695702/anchal-gupta"}, "is_accepted": true, "score": 0, "last_activity_date": 1569927234, "last_edit_date": 1569927234, "creation_date": 1569927066, "answer_id": 58183283, "question_id": 51162083, "link": "https://stackoverflow.com/questions/51162083/caps-negotiation-problems-running-gstreamer-on-a-nvidia-jetson-tx2/58183283#58183283", "title": "Caps negotiation problems running GStreamer on a NVIDIA Jetson TX2", "body": "<p>Use this stream:</p>\n\n<pre><code>uri = 'rtsp://admin:123456@192.168.0.123:554/mpeg4cif'\n\ngst_str = (\"rtspsrc location={} latency={} ! rtph264depay ! h264parse ! omxh264dec ! nvvidconv ! video/x-raw, width=(int){}, height=(int){}, format=(string)BGRx ! videoconvert ! appsink sync=false\").format(uri, 200, 3072, 2048)\n\n#3072,2048 is frame size \n\n\ncap= cv2.VideoCapture(gst_str,cv2.CAP_GSTREAMER)\n</code></pre>\n\n<p>Now, you can use it simple like any video reading with <code>_,frame=cap.read()</code></p>\n"}], "owner": {"reputation": 2032, "user_id": 4805357, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/muA8J.jpg?s=128&g=1", "display_name": "SDG", "link": "https://stackoverflow.com/users/4805357/sdg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 436, "favorite_count": 0, "accepted_answer_id": 58183283, "answer_count": 1, "score": 2, "last_activity_date": 1569929811, "creation_date": 1530648077, "last_edit_date": 1569929811, "question_id": 51162083, "link": "https://stackoverflow.com/questions/51162083/caps-negotiation-problems-running-gstreamer-on-a-nvidia-jetson-tx2", "title": "Caps negotiation problems running GStreamer on a NVIDIA Jetson TX2", "body": "<p>I have a simple program where I am trying to get video out of the camera and run it through a <code>omxh264enc</code>. The element linking is shown below: </p>\n\n<pre><code>  gst_element_link (source, cFilter0);\n  gst_element_link (cFilter0, encoder);\n  gst_element_link (encoder, cFilter1); \n  gst_element_link (cFilter1, autovs);\n</code></pre>\n\n<p>However I get the errors as shown below: </p>\n\n<pre><code>Framerate set to : 30 at NvxVideoEncoderSetParameter0:00:00.609624260  3087       0x683850 ERROR             omxh264enc gstomxh264enc.c:280:gst_omx_h264_enc_set_format:&lt;264encoder&gt; Empty caps\n0:00:00.609644260  3087       0x683850 ERROR            omxvideoenc gstomxvideoenc.c:1815:gst_omx_video_enc_set_format:&lt;264encoder&gt; Subclass failed to set the new format\n0:00:00.609656996  3087       0x683850 WARN            videoencoder gstvideoencoder.c:623:gst_video_encoder_setcaps:&lt;264encoder&gt; rejected caps video/x-raw(memory:NVMM), width=(int)640, height=(int)480, format=(string)I420, framerate=(fraction)30/1\n0:00:00.609696708  3087       0x683850 INFO                 basesrc gstbasesrc.c:2843:gst_base_src_loop:&lt;camerasrc&gt; marking pending DISCONT\n0:00:00.609804004  3087       0x683850 FIXME           videoencoder gstvideoencoder.c:606:gst_video_encoder_setcaps:&lt;264encoder&gt; GstVideoEncoder::reset() is deprecated\nFramerate set to : 30 at NvxVideoEncoderSetParameter0:00:00.609876579  3087       0x683850 ERROR             omxh264enc gstomxh264enc.c:280:gst_omx_h264_enc_set_format:&lt;264encoder&gt; Empty caps\n0:00:00.609890819  3087       0x683850 ERROR            omxvideoenc gstomxvideoenc.c:1815:gst_omx_video_enc_set_format:&lt;264encoder&gt; Subclass failed to set the new format\n0:00:00.609903779  3087       0x683850 WARN            videoencoder gstvideoencoder.c:623:gst_video_encoder_setcaps:&lt;264encoder&gt; rejected caps video/x-raw(memory:NVMM), width=(int)640, height=(int)480, format=(string)I420, framerate=(fraction)30/1\n0:00:00.609955843  3087       0x683850 WARN                 basesrc gstbasesrc.c:2948:gst_base_src_loop:&lt;camerasrc&gt; error: Internal data flow error.\n0:00:00.609971683  3087       0x683850 WARN                 basesrc gstbasesrc.c:2948:gst_base_src_loop:&lt;camerasrc&gt; error: streaming task paused, reason not-negotiated (-4)\n0:00:00.610001219  3087       0x683850 INFO        GST_ERROR_SYSTEM gstelement.c:1879:gst_element_message_full:&lt;camerasrc&gt; posting message: Internal data flow error.\n0:00:00.610046498  3087       0x683850 INFO        GST_ERROR_SYSTEM gstelement.c:1902:gst_element_message_full:&lt;camerasrc&gt; posted error message: Internal data flow error.\n0:00:00.610141602  3087       0x683850 FIXME           videoencoder gstvideoencoder.c:606:gst_video_encoder_setcaps:&lt;264encoder&gt; GstVideoEncoder::reset() is deprecated\n0:00:00.610159906  3087       0x683850 ERROR                    omx gstomx.c:256:gst_omx_component_handle_messages:&lt;264encoder&gt; encoder port 0 was not flushing\n0:00:00.610175682  3087       0x683850 ERROR                    omx gstomx.c:256:gst_omx_component_handle_messages:&lt;264encoder&gt; encoder port 1 was not flushing\nFramerate set to : 30 at NvxVideoEncoderSetParameter0:00:00.610238113  3087       0x683850 ERROR             omxh264enc gstomxh264enc.c:280:gst_omx_h264_enc_set_format:&lt;264encoder&gt; Empty caps\n0:00:00.610250977  3087       0x683850 ERROR            omxvideoenc gstomxvideoenc.c:1815:gst_omx_video_enc_set_format:&lt;264encoder&gt; Subclass failed to set the new format\n0:00:00.610262593  3087       0x683850 WARN            videoencoder gstvideoencoder.c:623:gst_video_encoder_setcaps:&lt;264encoder&gt; rejected caps video/x-raw(memory:NVMM), width=(int)640, height=(int)480, format=(string)I420, framerate=(fraction)30/1\n0:00:00.610340385  3087       0x683850 FIXME           videoencoder gstvideoencoder.c:606:gst_video_encoder_setcaps:&lt;264encoder&gt; GstVideoEncoder::reset() is deprecated\n0:00:00.610353953  3087       0x683850 ERROR                    omx gstomx.c:256:gst_omx_component_handle_messages:&lt;264encoder&gt; encoder port 0 was not flushing\n0:00:00.610367521  3087       0x683850 ERROR                    omx gstomx.c:256:gst_omx_component_handle_messages:&lt;264encoder&gt; encoder port 1 was not flushing\nFramerate set to : 30 at NvxVideoEncoderSetParameter0:00:00.610422529  3087       0x683850 ERROR             omxh264enc gstomxh264enc.c:280:gst_omx_h264_enc_set_format:&lt;264encoder&gt; Empty caps\n0:00:00.610434753  3087       0x683850 ERROR            omxvideoenc gstomxvideoenc.c:1815:gst_omx_video_enc_set_format:&lt;264encoder&gt; Subclass failed to set the new format\n0:00:00.610447360  3087       0x683850 WARN            videoencoder gstvideoencoder.c:623:gst_video_encoder_setcaps:&lt;264encoder&gt; rejected caps video/x-raw(memory:NVMM), width=(int)640, height=(int)480, format=(string)I420, framerate=(fraction)30/1\n0:00:00.610519680  3087       0x683850 INFO              GST_STATES gstbin.c:3238:bin_handle_async_done:&lt;avs&gt; committing state from READY to PAUSED, old pending PAUSED\n0:00:00.610551008  3087       0x683850 INFO              GST_STATES gstbin.c:3258:bin_handle_async_done:&lt;avs&gt; completed state change, pending VOID\n0:00:00.610564192  3087       0x683850 INFO              GST_STATES gstelement.c:2277:_priv_gst_element_state_changed:&lt;avs&gt; notifying about state-changed READY to PAUSED (VOID_PENDING pending)\n0:00:00.610609216  3087       0x683ed0 INFO                    task gsttask.c:318:gst_task_func:&lt;264encoder:src&gt; Task resume from paused\n0:00:00.610625792  3087       0x683ed0 ERROR                    omx gstomx.c:256:gst_omx_component_handle_messages:&lt;264encoder&gt; encoder port 0 was not flushing\n0:00:00.610641536  3087       0x683ed0 ERROR                    omx gstomx.c:256:gst_omx_component_handle_messages:&lt;264encoder&gt; encoder port 1 was not flushing\n</code></pre>\n\n<p>After extensively observing the caps, and using <code>gst-inspect-1.0</code>, it looks like the caps between the source and the encoder should be accepted, especially since I have set up a caps filter too. However, this isn't happening, and I have no idea as to why this is the case. </p>\n"}, {"tags": ["c", "function", "struct", "enums"], "comments": [{"owner": {"reputation": 370, "user_id": 9769810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XAI8c.jpg?s=128&g=1", "display_name": "Killian G.", "link": "https://stackoverflow.com/users/9769810/killian-g"}, "edited": false, "score": 2, "creation_date": 1530647134, "post_id": 51161856, "comment_id": 89307116, "body": "Your newgame is a pointer to a structure, to use member use <code>-&gt;</code> instead of <code>.</code> <code>newgame-&gt;board = bd</code>"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1530651401, "post_id": 51161856, "comment_id": 89308718, "body": "Where does <code>bd</code> come from?"}], "answers": [{"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 3, "last_activity_date": 1530647329, "creation_date": 1530647329, "answer_id": 51161943, "question_id": 51161856, "link": "https://stackoverflow.com/questions/51161856/passing-arrays-to-c-functions-to-update-structs/51161943#51161943", "title": "passing arrays to C functions to update structs", "body": "<p>First, <code>newgame</code> is a pointer to a struct, not a struct, so you can't use the member access operator <code>.</code> on it.  You instead need the pointer to member operator <code>-&gt;</code> to access the members.  </p>\n\n<p>Second, because the <code>gameboard</code> member is an array, you can't assign to it directly.  Instead, pass <code>newgame-&gt;gameboard</code> to the function that initializes the board.</p>\n"}], "owner": {"reputation": 337, "user_id": 1719216, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/b2ea36f880dd879ce9663f47c36499f0?s=128&d=identicon&r=PG", "display_name": "Chris", "link": "https://stackoverflow.com/users/1719216/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1530647329, "creation_date": 1530646957, "question_id": 51161856, "link": "https://stackoverflow.com/questions/51161856/passing-arrays-to-c-functions-to-update-structs", "title": "passing arrays to C functions to update structs", "body": "<p>I'm doing an assignment at uni based on the gomoku game.</p>\n\n<p>As part of the process I initialise a gameboard, then I initialise a game, these are structs defined in header files and we have to use defined calls and not use global variables (or lose marks), but I'm a bit confused about the process:</p>\n\n<p>The header file:</p>\n\n<pre><code>struct game\n{\n struct player players[NUM_PLAYERS];\n board gameboard;\n struct player* current, *other;\n};\n\nenum input_result init_game(struct game*);\n\nvoid play_game(void);\n</code></pre>\n\n<p>board header file</p>\n\n<pre><code>enum cell\n{\n  C_EMPTY,\n  etc...\n};\n\ntypedef enum cell board[BOARDHEIGHT][BOARDWIDTH];\n\nvoid init_board(board);\n</code></pre>\n\n<p>in main</p>\n\n<p>I've created the board (2d array) called bd, initialised it fine and then added values to each cell in a separate c file</p>\n\n<p>in game.c file\nI've initialised the game structure and called the function, \npassing the address of the game struct</p>\n\n<pre><code>struct game curgame;\ninit_game(&amp;curgame);\n</code></pre>\n\n<p>the issue I'm having is passing the board to the struct:</p>\n\n<pre><code>enum input_results init_game(struct game* newgame)\n{\n  newgame.board = bd;\n\n}\n</code></pre>\n\n<p>This is incorrect and I'm getting errors saying:</p>\n\n<p>newgame is undeclared (first use in this function)\nbd is undeclared (first use in this function)</p>\n\n<p>Could someone explain to me like I'm a five year old, how to pass the values to the function so I can add them to a struct, without editing the call to the function?</p>\n\n<p>any help would be appreciated</p>\n"}, {"tags": ["c", "struct", "extern"], "answers": [{"comments": [{"owner": {"reputation": 170, "user_id": 7534825, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh3.googleusercontent.com/-kh6IplmZuL8/AAAAAAAAAAI/AAAAAAAACps/YSrmIhozjPg/photo.jpg?sz=128", "display_name": "Devjeet Mandal", "link": "https://stackoverflow.com/users/7534825/devjeet-mandal"}, "edited": false, "score": 0, "creation_date": 1530647973, "post_id": 51161878, "comment_id": 89307476, "body": "Throws an error <code>Symbol rx multiply defined</code>"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1530648016, "post_id": 51161878, "comment_id": 89307491, "body": "On which line in which file and how often do you have that line in your code files?"}, {"owner": {"reputation": 170, "user_id": 7534825, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh3.googleusercontent.com/-kh6IplmZuL8/AAAAAAAAAAI/AAAAAAAACps/YSrmIhozjPg/photo.jpg?sz=128", "display_name": "Devjeet Mandal", "link": "https://stackoverflow.com/users/7534825/devjeet-mandal"}, "edited": false, "score": 0, "creation_date": 1530648259, "post_id": 51161878, "comment_id": 89307590, "body": "gives error in object file. The files where i have included the header file"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1530648415, "post_id": 51161878, "comment_id": 89307649, "body": "Can you count the number of times you define the variable <code>rx</code>? To do that look for lines which do NOT have an <code>extern</code>. There must be only one such line in all code files together, i.e. only one in only one of the code files. The lines with <code>extern</code> can be as many as you like, as long as they are identical. That includes lines which include the header."}, {"owner": {"reputation": 170, "user_id": 7534825, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh3.googleusercontent.com/-kh6IplmZuL8/AAAAAAAAAAI/AAAAAAAACps/YSrmIhozjPg/photo.jpg?sz=128", "display_name": "Devjeet Mandal", "link": "https://stackoverflow.com/users/7534825/devjeet-mandal"}, "edited": false, "score": 0, "creation_date": 1530648535, "post_id": 51161878, "comment_id": 89307698, "body": "There are exactly two files where i have defined the variable rx without extern. and included the header file in both of those files."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "reply_to_user": {"reputation": 170, "user_id": 7534825, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh3.googleusercontent.com/-kh6IplmZuL8/AAAAAAAAAAI/AAAAAAAACps/YSrmIhozjPg/photo.jpg?sz=128", "display_name": "Devjeet Mandal", "link": "https://stackoverflow.com/users/7534825/devjeet-mandal"}, "edited": false, "score": 0, "creation_date": 1530648555, "post_id": 51161878, "comment_id": 89307708, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/174290/discussion-between-yunnosch-and-devjeet-mandal\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "is_accepted": true, "score": 2, "last_activity_date": 1530648150, "last_edit_date": 1530648150, "creation_date": 1530647066, "answer_id": 51161878, "question_id": 51161807, "link": "https://stackoverflow.com/questions/51161807/declaring-struct-as-extern-and-using-same-variable-in-different-file/51161878#51161878", "title": "declaring struct as extern and using same variable in different file", "body": "<p>Introduce a header, e.g. myheader.h.<br>\nInside declare the data type and declare the external variables.</p>\n\n<pre><code>#ifndef MYHEADER_H\n#define MYHEADER_H\n\nstruct my_struct{\n    char *buf;\n    int size;\n    int read;\n    int write;\n};\n\nextern struct my_struct rx;\nextern struct my_struct tx;\n#endif\n</code></pre>\n\n<p>Inside both/all of your code files include the header</p>\n\n<pre><code>#include \"myheader.h\"\n</code></pre>\n\n<p>Do not forget to still define the variables in exactly one of the code files,<br>\nbut do not use the \"shorthand\" combination of type declaration and variable definition from your shown code.<br>\nJust use the type as declared in the header, note the absence of <code>extern</code>.<br>\nI.e. replace this inside cfile.c</p>\n\n<pre><code>volatile struct my_struct{\n    char *buf;\n    int size;\n    int read;\n    int write;\n}rx,tx;    \n</code></pre>\n\n<p>by this, but only in this one .c file.</p>\n\n<pre><code>struct my_struct rx;\nstruct my_struct tx;\n</code></pre>\n"}], "owner": {"reputation": 170, "user_id": 7534825, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh3.googleusercontent.com/-kh6IplmZuL8/AAAAAAAAAAI/AAAAAAAACps/YSrmIhozjPg/photo.jpg?sz=128", "display_name": "Devjeet Mandal", "link": "https://stackoverflow.com/users/7534825/devjeet-mandal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 246, "favorite_count": 0, "closed_date": 1530648257, "accepted_answer_id": 51161878, "answer_count": 1, "score": 0, "last_activity_date": 1530648150, "creation_date": 1530646634, "question_id": 51161807, "link": "https://stackoverflow.com/questions/51161807/declaring-struct-as-extern-and-using-same-variable-in-different-file", "closed_reason": "Duplicate", "title": "declaring struct as extern and using same variable in different file", "body": "<p>I need some clarification about using structure and externs. My code is like this.</p>\n\n<p><code>cfile.c</code></p>\n\n<pre><code>volatile struct my_struct{\n        char *buf;\n        int size;\n        int read;\n        int write;\n    }rx,tx;\n\nvoid foo1()\n{\n    rx.size = 256;\n    rx.buf = (char *)malloc(rx.size * sizeof(char));\n    rx.read = 0;\n    rx.write = 0;\n    tx.size = 256;\n    tx.buf = (char *)malloc(tx.size * sizeof(char));\n    tx.read = 0;\n    tx.write = 0;\n}\n</code></pre>\n\n<p><code>xyzFile.c</code></p>\n\n<pre><code>//extern the structure\n</code></pre>\n\n<p>Use structure variable in this function</p>\n\n<pre><code>void foo2(void)\n{\n        int next;\n\n        next = (rx.write + 1)%rx.size;\n        rx.buf[rx.write] = data;\n        if (next != rx.read)\n            rx.write = next;\n}\n</code></pre>\n\n<p>In this function foo i'm getting this data <code>rx.buf</code> and wanted to use this data in <code>cfile.c</code>. How can i do that?</p>\n\n<p>Thanks in advance. </p>\n"}, {"tags": ["c", "fft", "fftw"], "comments": [{"owner": {"reputation": 8727, "user_id": 2999346, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dQ1wB.png?s=128&g=1", "display_name": "francis", "link": "https://stackoverflow.com/users/2999346/francis"}, "edited": false, "score": 1, "creation_date": 1530670655, "post_id": 51161695, "comment_id": 89313133, "body": "On the one hand, the Discrete Fourier Transform handles the frame as a period of a periodic signal. Indeed, it ensures that its Fourier frequencies are also discrete and equally spaced in the frequency space, and periodic (+2k*pi =&gt; equal coefficient). <a href=\"https://en.wikipedia.org/wiki/Discrete_Fourier_transform\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Discrete_Fourier_transform</a> On the other hand, the O(n2) correlation seems to correspond to cross correlation of function featuring a compact support <a href=\"https://en.wikipedia.org/wiki/Cross-correlation\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Cross-correlation</a>.  The results can be different!"}], "owner": {"reputation": 121, "user_id": 10028517, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3c8eae3fe2c3449434e4c80e0bfcf10?s=128&d=identicon&r=PG", "display_name": "N. A.", "link": "https://stackoverflow.com/users/10028517/n-a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1530646071, "creation_date": 1530646071, "question_id": 51161695, "link": "https://stackoverflow.com/questions/51161695/alternating-error-in-fftw-correlation", "title": "Alternating error in FFTW correlation", "body": "<pre><code>// Initialize variables, ZALLOC allocates and fills with zeroes\nZALLOC(z0q, numqbins, double) ;  \nZALLOC(z1q, numqbins, double) ;  \nZALLOC(z2q, numqbins, double) ;  \n\nz_in = (double*)fftw_malloc(sizeof(double) * numqbins * 2) ;\nz_out = (fftw_complex*)fftw_malloc(sizeof(fftw_complex) * numqbins * 2) ;\n\nr2c_plan = fftw_plan_dft_r2c_1d(2 * numqbins, z_in, z_out, FFTW_ESTIMATE) ;\nc2r_plan = fftw_plan_dft_c2r_1d(2 * numqbins, z_out, z_in, FFTW_ESTIMATE) ;\n\n\n... (ddbins is initialized to all 0s, z0q, z1q, and z2q are filled with values) ...\n\n\nfor (k1=0; k1&lt;numx; ++k1) { \n    if (snpmarkers[xindex[k1]] -&gt; ignore) {\n        continue ;\n    } else {\n        s = snpmarkers[xindex[k1]] -&gt; tagnumber ;\n    }\n    y = res[k1] * wt[k1] ; \n\n    z0q[s] += 1 ; \n    z1q[s] += y ; \n    z2q[s] += y*y ; \n  }\n// Perform convolution.\nfft_ddadd(ddbins, z0q, z1q, z2q, numqbins, diffmax, z_in, z_out, r2c_plan, c2r_plan) ;\n\nvoid fft_ddadd(double **ddbins, double *z0q, double *z1q, double *z2q, int numqbins, \n            int diffmax, double *z_in, fftw_complex *z_out, fftw_plan r2c_plan, fftw_plan c2r_plan) \n{\n    double *dd00, *dd01, *dd10, *dd11, *dd02, *dd20 ; \n    int i;\n    fftw_complex *ft_z0q, *ft_z1q, *ft_z2q ;    \n\n    dd00 = ddbins[0] ;\n    dd01 = ddbins[1] ; \n    dd10 = ddbins[3] ; \n    dd11 = ddbins[4] ; \n    dd02 = ddbins[2] ; \n    dd20 = ddbins[6] ;     \n\n    ft_z0q = (fftw_complex*)fftw_malloc(sizeof(fftw_complex) * numqbins * 2) ;\n    ft_z1q = (fftw_complex*)fftw_malloc(sizeof(fftw_complex) * numqbins * 2) ;\n    ft_z2q = (fftw_complex*)fftw_malloc(sizeof(fftw_complex) * numqbins * 2) ;    \n\n\n    // Copy arrays into z_in and transform, copy complex results out into ft_z's\n    for (i = 0; i &lt; numqbins; ++i) {\n        z_in[i] = z0q[i] ;\n        z_in[i + numqbins] = 0 ;\n    }    \n\n    fftw_execute(r2c_plan) ;    \n\n    for (i = 0; i &lt; numqbins; ++i) {\n        z_in[i] = z1q[i] ;\n        ft_z0q[i][0] = z_out[i][0] ;\n        ft_z0q[i][1] = z_out[i][1] ;\n    }    \n\n    fftw_execute(r2c_plan) ;    \n\n    for (i = 0; i &lt; numqbins; ++i) {\n        z_in[i] = z2q[i] ;\n        ft_z1q[i][0] = z_out[i][0] ;\n        ft_z1q[i][1] = z_out[i][1] ;\n    }    \n\n    fftw_execute(r2c_plan) ;    \n\n    for (i = 0; i &lt; numqbins; ++i) {\n        ft_z2q[i][0] = z_out[i][0] ;\n        ft_z2q[i][1] = z_out[i][1] ;\n    }    \n\n    // Do correlations\n    fft_singledd(dd00, ft_z0q, ft_z0q, numqbins, diffmax, z_in, z_out, c2r_plan);\n    fft_singledd(dd01, ft_z0q, ft_z1q, numqbins, diffmax, z_in, z_out, c2r_plan);\n    fft_singledd(dd10, ft_z1q, ft_z0q, numqbins, diffmax, z_in, z_out, c2r_plan);\n    fft_singledd(dd11, ft_z1q, ft_z1q, numqbins, diffmax, z_in, z_out, c2r_plan);\n    fft_singledd(dd02, ft_z0q, ft_z2q, numqbins, diffmax, z_in, z_out, c2r_plan);\n    fft_singledd(dd20, ft_z2q, ft_z0q, numqbins, diffmax, z_in, z_out, c2r_plan);    \n\n\n}    \n\nvoid fft_singledd(double* ddbin, fftw_complex* ftz_0, fftw_complex* ftz_1, int numqbins, \n            int diffmax, double *z_in, fftw_complex *z_out, fftw_plan c2r_plan) {\n\n    int i ;\n    // Correlate ftz_0 and ftz_1 together and copy into z_out\n    for (i = 0; i &lt; numqbins * 2; ++i) {\n        z_out[i][0] =   ftz_0[i][0] * ftz_1[i][0] + ftz_0[i][1] * ftz_1[i][1] ;\n        z_out[i][1] = - ftz_0[i][0] * ftz_1[i][1] + ftz_0[i][1] * ftz_1[i][0] ;\n    }    \n    // Transform back\n    fftw_execute(c2r_plan) ;    \n    // Copy the desired results out\n    for (i = 1; i &lt; diffmax; ++i) {\n        ddbin[i] += (z_in[2 * numqbins - i] / (2 * numqbins)) ;\n    }    \n}\n\nvoid ddadd(double **ddbins, double *z0q, double *z1q, double *z2q, int numqbins, int diffmax) {\n    double *dd00, *dd01, *dd10, *dd11, *dd02, *dd20 ; \n    double a0, a1, a2, b0, b1, b2 ; \n    int i, s, t, tmax, d ;    \n\n    dd00 = ddbins[0] ;\n    dd01 = ddbins[1] ; \n    dd10 = ddbins[3] ; \n    dd11 = ddbins[4] ; \n    dd02 = ddbins[2] ; \n    dd20 = ddbins[6] ;     \n\n    for (s=0; s&lt;numqbins; ++s) { \n        a0 = z0q[s] ; \n        a1 = z1q[s] ;\n        a2 = z2q[s] ;\n        tmax = MIN(numqbins-1, s + diffmax) ; \n        for (t=s+1; t&lt;=tmax; ++t) { \n            b0 = z0q[t] ;\n            b1 = z1q[t] ;\n            b2 = z2q[t] ;\n            d = t - s ; \n            dd00[d] += a0*b0 ;\n            dd01[d] += a0*b1 ;\n            dd10[d] += a1*b0 ;\n            dd11[d] += a1*b1 ;\n            dd02[d] += a0*b2 ;\n            dd20[d] += a2*b0 ;\n        }\n    }\n}\n</code></pre>\n\n<p>When running the above code, I encounter a problem in the results. When comparing the outputs into <code>ddbins</code> from <code>ddadd</code> (non Fourier transform, computed by an O(n^2) correlation) against the output from <code>fft_ddadd</code>, the errors are nearly constant and alternating:</p>\n\n<p><code>ddbins[0] - fft_ddbins[0] = [0.000000000000, -0.016764512518, 0.016764511936, -0.016764512286, 0.016764512053, -0.016764512286, 0.016764512053, -0.016764512169, 0.016764511995, -0.016764512227, 0.016764512053, -0.016764512344, 0.016764512053, -0.016764512227, 0.016764511995, -0.016764512227, 0.016764512053, -0.016764512344, 0.016764512053, -0.016764512227, 0.016764512053, -0.016764512344, 0.016764511995, -0.016764512227, 0.016764512053, -0.016764512227, 0.016764512053, -0.016764512344 ...]</code></p>\n\n<p>Which, as you can see, is roughly the same error in every place, with alternating sign, plus or minus some error attributable to machine precision. </p>\n\n<p>A possible issue which has been raised is that there is a Fourier transform component which is, in real space, corresponds to the array <code>[+1, -1, +1, -1 ...]</code>, which would, if excluded, explain the alternating error. However, I do not see how this element could be excluded. The arrays z*q are copied in fully (length <code>numqbins</code>) into the plans and executed, while the output arrays (length <code>2*numqbins</code>) are also copied directly, and the error is introduced before the outputs are copied into their desired location.</p>\n\n<p>This is my first time asking a question on this site, so please tell me if more information (or less!) is required, or if this isn't quite the right place to ask. Thanks in advance.</p>\n"}, {"tags": ["c", "memory", "memory-management", "memory-leaks"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1530645511, "post_id": 51161500, "comment_id": 89306533, "body": "The <code>realloc</code> is using the size of the <code>struct</code> <b><i>pointer</i></b> not the size of the <code>struct</code> as in the original <code>malloc</code>. The only thing known in a function about a pointer is its own size - nothing about how much data it points to unless you pass that information to the function too."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1530645516, "post_id": 51161500, "comment_id": 89306534, "body": "Your <code>realloc</code> call doesn&#39;t really make any sense."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1530645639, "post_id": 51161500, "comment_id": 89306568, "body": "@WeatherVane And even if it was getting the sizeof the type being pointed to, it is pointing to a different type."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 1, "creation_date": 1530645680, "post_id": 51161500, "comment_id": 89306578, "body": "<code>bow</code> isn&#39;t changed outside the function, thus it retains the old value .As soon as the memory is moved, you get segfault because old memory pointer isn&#39;t valid"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1530645740, "post_id": 51161500, "comment_id": 89306602, "body": "<code>void add_word( struct bag_struct *bow, char *word );</code> =&gt; <code>struct bag_struct *add_word( struct bag_struct *bow, char *word );</code> and <i>return</i> <code>bow</code> (and yes, the size is wrong too)"}], "owner": {"reputation": 337, "user_id": 9781768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed70d0c2ec5a7a9b51c4bc892703ecbe?s=128&d=identicon&r=PG&f=1", "display_name": "User9123", "link": "https://stackoverflow.com/users/9781768/user9123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 21, "favorite_count": 0, "closed_date": 1530645636, "answer_count": 0, "score": 0, "last_activity_date": 1530645065, "creation_date": 1530645065, "question_id": 51161500, "link": "https://stackoverflow.com/questions/51161500/memory-allocation-with-dynamically-allocated-struct-realloc-in-c", "closed_reason": "Duplicate", "title": "Memory Allocation with Dynamically Allocated Struct (Realloc) in C", "body": "<p>Hi I have been working on a C assignment, and I have been stuck on one portion of the assignment for a few days now. My problem comes with some memory allocation.</p>\n\n<p>I have the following struct definitions.</p>\n\n<pre><code>    struct word_count_struct {\n      char *word;\n      int   count;\n    };\n\n    struct bag_struct {\n      struct word_count_struct *bag;\n      int bag_size;\n      int total_words;\n    };\n</code></pre>\n\n<p>In this function I have to;</p>\n\n<pre><code>    void add_word( struct bag_struct *bow, char *word );\n</code></pre>\n\n<ol>\n<li><p>Define a word_count_struct pointer, and use the new_word_count function to make it point to a new word_count structure for the provided word. (The new_word_count function is another function in the assignment, I will show it below)</p></li>\n<li><p>I need to make the bow bigger to accommodate the new word_count struct. Using realloc. By setting the bow pointer to be equal to the value returned by realloc and also use it as the first argument. Then set the amount of memory in the realloc function to be the \"sizeof\" a word_count_structure multiplied by the bag->size (after adding 1 to it).</p></li>\n<li><p>Use memcpy to copy the contents of the word_count_struct pointer's data into bow (at the last index).  Watch out for the order of the pointers in the memcpy command (the destination comes before the source).</p></li>\n</ol>\n\n<p>Currently, I am having problems using realloc. I seem to be getting a segmentation fault. </p>\n\n<p>My code thus far is.</p>\n\n<pre><code>    void add_word( struct bag_struct *bow, char *word ){\n\n        struct word_count_struct *aPtr;\n\n        aPtr = new_word_count(word);\n\n        bow = realloc( bow, (sizeof(aPtr) * bow-&gt;bag_size) + 1);\n    }\n</code></pre>\n\n<p>My code will run with no errors, however I will be automatically hit with a segmentation fault. If I comment out the realloc line, there will be no segmentation fault, however it is part of the assignment instruction so I have no choice.</p>\n\n<p>I am also having trouble understanding what it means to put the memory contents of the word_count_struct pointer's data into the bow (at the last index). Particularly where it says the last index.</p>\n\n<p>Here is the new_word_count I said I would include above. ( I don't know if this would help ).</p>\n\n<pre><code>    struct word_count_struct *new_word_count( char *word ){\n\n        struct word_count_struct *new;\n\n        new = malloc(sizeof(struct word_count_struct));\n\n        new -&gt; count = 1;\n        new -&gt; word = word;\n\n        return new;\n    }\n</code></pre>\n\n<p>If you have any tips or ideas on what I could do to solve this it would be very appreciated. </p>\n"}, {"tags": ["python", "c", "python-3.x", "python-3.5", "python-c-api"], "comments": [{"owner": {"reputation": 4837, "user_id": 9769953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f14a586643a20c8d68010f7a329f5a04?s=128&d=identicon&r=PG", "display_name": "0 0", "link": "https://stackoverflow.com/users/9769953/0-0"}, "edited": false, "score": 0, "creation_date": 1530642778, "post_id": 51160830, "comment_id": 89305387, "body": "Use Cython as glue; see the documtation there."}], "answers": [{"comments": [{"owner": {"reputation": 530, "user_id": 6683107, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b2d9da9434026f7673c213f5ab9eef6?s=128&d=identicon&r=PG&f=1", "display_name": "questionable_code", "link": "https://stackoverflow.com/users/6683107/questionable-code"}, "edited": false, "score": 0, "creation_date": 1530643633, "post_id": 51160991, "comment_id": 89305755, "body": "Is this still a good idea if these C functions are very large and computationally intensive?"}, {"owner": {"reputation": 192011, "user_id": 17160, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/81cb50f5fe868629a680c16a56781f01?s=128&d=identicon&r=PG", "display_name": "nosklo", "link": "https://stackoverflow.com/users/17160/nosklo"}, "reply_to_user": {"reputation": 530, "user_id": 6683107, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b2d9da9434026f7673c213f5ab9eef6?s=128&d=identicon&r=PG&f=1", "display_name": "questionable_code", "link": "https://stackoverflow.com/users/6683107/questionable-code"}, "edited": false, "score": 0, "creation_date": 1530643714, "post_id": 51160991, "comment_id": 89305802, "body": "I don&#39;t see why not? You will be calling your C code as it is... Who cares if it is intensive or not? I don&#39;t understand your concern at all @questionable_code"}, {"owner": {"reputation": 530, "user_id": 6683107, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b2d9da9434026f7673c213f5ab9eef6?s=128&d=identicon&r=PG&f=1", "display_name": "questionable_code", "link": "https://stackoverflow.com/users/6683107/questionable-code"}, "edited": false, "score": 0, "creation_date": 1530644291, "post_id": 51160991, "comment_id": 89306057, "body": "I apologize. I was trying to infer which of the two routes (cython or ctypes) I should try with more confidence, as the latter was suggested below."}, {"owner": {"reputation": 192011, "user_id": 17160, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/81cb50f5fe868629a680c16a56781f01?s=128&d=identicon&r=PG", "display_name": "nosklo", "link": "https://stackoverflow.com/users/17160/nosklo"}, "reply_to_user": {"reputation": 530, "user_id": 6683107, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b2d9da9434026f7673c213f5ab9eef6?s=128&d=identicon&r=PG&f=1", "display_name": "questionable_code", "link": "https://stackoverflow.com/users/6683107/questionable-code"}, "edited": false, "score": 0, "creation_date": 1530644786, "post_id": 51160991, "comment_id": 89306269, "body": "Cython code is maintainable high level code that when compiled gets converted to C and linked as a binary extension to python - it is the most polite solution and very performant. ctypes feels like a hack next to cython, which will produce a full enterprise-quality python extension. @questionable_code"}, {"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "reply_to_user": {"reputation": 530, "user_id": 6683107, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b2d9da9434026f7673c213f5ab9eef6?s=128&d=identicon&r=PG&f=1", "display_name": "questionable_code", "link": "https://stackoverflow.com/users/6683107/questionable-code"}, "edited": false, "score": 0, "creation_date": 1530645346, "post_id": 51160991, "comment_id": 89306473, "body": "@questionable_code: If done right, Cython does the same job as a raw C extension, with a lot less work. You can inspect the generated C/C++ code to see if it&#39;s being done mostly sanely (the generated code tends to be quite verbose, but in ways that the compiler&#39;s optimizer cleans it up in the final extension)."}, {"owner": {"reputation": 530, "user_id": 6683107, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b2d9da9434026f7673c213f5ab9eef6?s=128&d=identicon&r=PG&f=1", "display_name": "questionable_code", "link": "https://stackoverflow.com/users/6683107/questionable-code"}, "edited": false, "score": 0, "creation_date": 1530647439, "post_id": 51160991, "comment_id": 89307243, "body": "Will update with an &quot;accept&quot; if this works out for what I&#39;m dealing with. Thanks everyone!"}], "tags": [], "owner": {"reputation": 192011, "user_id": 17160, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/81cb50f5fe868629a680c16a56781f01?s=128&d=identicon&r=PG", "display_name": "nosklo", "link": "https://stackoverflow.com/users/17160/nosklo"}, "is_accepted": true, "score": 1, "last_activity_date": 1530642812, "creation_date": 1530642812, "answer_id": 51160991, "question_id": 51160830, "link": "https://stackoverflow.com/questions/51160830/calling-custom-c-subroutines-in-a-python-application/51160991#51160991", "title": "Calling custom C subroutines in a Python application", "body": "<p>Use cython to wrap your C code. In other words, create a CPython extension using Cython, that calls your C code.</p>\n"}, {"comments": [{"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "edited": false, "score": 0, "creation_date": 1530643397, "post_id": 51161001, "comment_id": 89305655, "body": "Note that this works best when a <i>single</i> call via <code>ctypes</code> does most of the work, <i>and</i> the work is significant; if you&#39;re making lots of small calls doing very little work, <code>ctypes</code> introduces non-trivial overhead that true C extensions can avoid."}, {"owner": {"reputation": 530, "user_id": 6683107, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b2d9da9434026f7673c213f5ab9eef6?s=128&d=identicon&r=PG&f=1", "display_name": "questionable_code", "link": "https://stackoverflow.com/users/6683107/questionable-code"}, "reply_to_user": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "edited": false, "score": 0, "creation_date": 1530643689, "post_id": 51161001, "comment_id": 89305789, "body": "@ShadowRanger so is this a decent path if my routines are very computationally intensive and large?"}, {"owner": {"reputation": 2915, "user_id": 3591014, "user_type": "registered", "profile_image": "https://graph.facebook.com/575197264/picture?type=large", "display_name": "eatmeimadanish", "link": "https://stackoverflow.com/users/3591014/eatmeimadanish"}, "edited": false, "score": 0, "creation_date": 1530644150, "post_id": 51161001, "comment_id": 89305986, "body": "If the work isn&#39;t complicated you are better off just writing it in Python in the first place rendering this question moot.  I inferred that the c code was complex and heavy, ctypes is the best way to go in that regard."}, {"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "reply_to_user": {"reputation": 530, "user_id": 6683107, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b2d9da9434026f7673c213f5ab9eef6?s=128&d=identicon&r=PG&f=1", "display_name": "questionable_code", "link": "https://stackoverflow.com/users/6683107/questionable-code"}, "edited": false, "score": 0, "creation_date": 1530645214, "post_id": 51161001, "comment_id": 89306415, "body": "@questionable_code: Yeah, <code>ctypes</code> overhead is typically in the hundreds of nanoseconds to single digit microseconds at worst; if you&#39;re doing even a millisecond&#39;s worth of work at the C layer per call, the <code>ctypes</code> overhead is pretty meaningless. The trick is with libraries that expose lots of small calls that are useful to Python, but not easy to reimplement in Python efficiently. Stuff like the simple GMP math functions; a pain to reimplement, but trivial work relative to <code>ctypes</code> overhead (in this particular case, <code>gmpy2</code> is the way to go, but similar libs without wrappers exist)."}], "tags": [], "owner": {"reputation": 2915, "user_id": 3591014, "user_type": "registered", "profile_image": "https://graph.facebook.com/575197264/picture?type=large", "display_name": "eatmeimadanish", "link": "https://stackoverflow.com/users/3591014/eatmeimadanish"}, "is_accepted": false, "score": 0, "last_activity_date": 1530642856, "creation_date": 1530642856, "answer_id": 51161001, "question_id": 51160830, "link": "https://stackoverflow.com/questions/51160830/calling-custom-c-subroutines-in-a-python-application/51161001#51161001", "title": "Calling custom C subroutines in a Python application", "body": "<p>You can call C directly from python. Example pulled from here: <a href=\"https://www.csestack.org/calling-c-functions-from-python/\" rel=\"nofollow noreferrer\">https://www.csestack.org/calling-c-functions-from-python/</a></p>\n\n<pre><code>from ctypes import *\nlibCalc = CDLL(\"./libcalci.so\")\n\n#call C function to check connection\nlibCalc.connect() \n\n#calling randNum() C function\n#it returns random number\nvarRand = libCalc.randNum()\nprint \"Random Number:\", varRand, type(varRand)\n\n#calling addNum() C function\n#it returns addition of two numbers\nvarAdd = libCalc.addNum(20,30)\nprint \"Addition : \", varAdd\n</code></pre>\n"}], "owner": {"reputation": 530, "user_id": 6683107, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b2d9da9434026f7673c213f5ab9eef6?s=128&d=identicon&r=PG&f=1", "display_name": "questionable_code", "link": "https://stackoverflow.com/users/6683107/questionable-code"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 136, "favorite_count": 0, "accepted_answer_id": 51160991, "answer_count": 2, "score": 0, "last_activity_date": 1530644199, "creation_date": 1530642104, "last_edit_date": 1530644199, "question_id": 51160830, "link": "https://stackoverflow.com/questions/51160830/calling-custom-c-subroutines-in-a-python-application", "title": "Calling custom C subroutines in a Python application", "body": "<p>I have two custom-written C routines that I would like to use as a part of a large Python application. I would prefer not to rewrite the C code in pure Python (or Cython, etc.), especially to maintain speed.</p>\n\n<p>What is the cleanest, easiest way that I can use my C code from my Python code? Or, what is the cleanest, easiest way for me to wrap my C code for use in my Python source?</p>\n\n<p>I know \"cleanest\" and \"easiest\" will attract opinions, but I really just need some good options for using <strong>custom pre-written code</strong>, versus many of the other answers/tutorials which describe how to use full-on C libraries as CPython extensions.</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>Cython and ctypes have both been suggested. Which is a better choice in my case? Each of the two routines I mentioned originally are very computationally intensive. They are used for image calculations and reconstructions, so my plan is to build a Python application around their use (with other functionality in mind that I already have in Python) with the C code run as needed for processing.</p>\n"}, {"tags": ["c", "fopen"], "comments": [{"owner": {"reputation": 5010, "user_id": 3150445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bfca2588483eadf6695a120cbcef1f8?s=128&d=identicon&r=PG&f=1", "display_name": "jwdonahue", "link": "https://stackoverflow.com/users/3150445/jwdonahue"}, "edited": false, "score": 0, "creation_date": 1530642451, "post_id": 51160746, "comment_id": 89305236, "body": "Is it printing &quot;Failed to open the file&quot; ?"}, {"owner": {"reputation": 11619, "user_id": 5346306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BsACH.jpg?s=128&g=1", "display_name": "Achal", "link": "https://stackoverflow.com/users/5346306/achal"}, "edited": false, "score": 0, "creation_date": 1530642487, "post_id": 51160746, "comment_id": 89305252, "body": "Are you sure about use of <code>O_EXCL</code> here ? It will let <code>open()</code> fail in cases like mentioned in <code>man 2 open</code> --&gt; Ensure  that  this call creates the file: if this flag is speci\u2010               fied in conjunction with O_CREAT, and pathname  already  exists,               <b>then open() will fail</b>."}, {"owner": {"reputation": 301, "user_id": 9962552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0621a071527c22af36d881c60036d8f7?s=128&d=identicon&r=PG&f=1", "display_name": "ElsaInSpirit", "link": "https://stackoverflow.com/users/9962552/elsainspirit"}, "edited": false, "score": 0, "creation_date": 1530642541, "post_id": 51160746, "comment_id": 89305283, "body": "no. nothing prints."}, {"owner": {"reputation": 5010, "user_id": 3150445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bfca2588483eadf6695a120cbcef1f8?s=128&d=identicon&r=PG&f=1", "display_name": "jwdonahue", "link": "https://stackoverflow.com/users/3150445/jwdonahue"}, "edited": false, "score": 0, "creation_date": 1530642574, "post_id": 51160746, "comment_id": 89305298, "body": "Have you bothered to step through it with a debugger?"}, {"owner": {"reputation": 301, "user_id": 9962552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0621a071527c22af36d881c60036d8f7?s=128&d=identicon&r=PG&f=1", "display_name": "ElsaInSpirit", "link": "https://stackoverflow.com/users/9962552/elsainspirit"}, "edited": false, "score": 0, "creation_date": 1530642606, "post_id": 51160746, "comment_id": 89305315, "body": "given the behavior of O_EXCL when used in conjunction with O_CREAT is there an alternative way to securely open a file?"}, {"owner": {"reputation": 301, "user_id": 9962552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0621a071527c22af36d881c60036d8f7?s=128&d=identicon&r=PG&f=1", "display_name": "ElsaInSpirit", "link": "https://stackoverflow.com/users/9962552/elsainspirit"}, "reply_to_user": {"reputation": 5010, "user_id": 3150445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bfca2588483eadf6695a120cbcef1f8?s=128&d=identicon&r=PG&f=1", "display_name": "jwdonahue", "link": "https://stackoverflow.com/users/3150445/jwdonahue"}, "edited": false, "score": 0, "creation_date": 1530642865, "post_id": 51160746, "comment_id": 89305412, "body": "@jwdonahue I&#39;m new to C so I haven&#39;t used a debugger yet"}, {"owner": {"reputation": 5010, "user_id": 3150445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bfca2588483eadf6695a120cbcef1f8?s=128&d=identicon&r=PG&f=1", "display_name": "jwdonahue", "link": "https://stackoverflow.com/users/3150445/jwdonahue"}, "edited": false, "score": 0, "creation_date": 1530642883, "post_id": 51160746, "comment_id": 89305422, "body": "That code attempts to delete the specified file without checking the return from <code>unlink</code>, but that kind of makes sense; because it doesn&#39;t check whether the file exists first. There&#39;s only two ways out of the function that could return NULL, both of them print an error message. Step through the code in a debugger."}, {"owner": {"reputation": 301, "user_id": 9962552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0621a071527c22af36d881c60036d8f7?s=128&d=identicon&r=PG&f=1", "display_name": "ElsaInSpirit", "link": "https://stackoverflow.com/users/9962552/elsainspirit"}, "reply_to_user": {"reputation": 5010, "user_id": 3150445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bfca2588483eadf6695a120cbcef1f8?s=128&d=identicon&r=PG&f=1", "display_name": "jwdonahue", "link": "https://stackoverflow.com/users/3150445/jwdonahue"}, "edited": false, "score": 0, "creation_date": 1530643351, "post_id": 51160746, "comment_id": 89305634, "body": "@jwdonahue where in the code does it attempt to delete the file? My intention is only to open the file in read or write mode and return the file pointer."}, {"owner": {"reputation": 5010, "user_id": 3150445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bfca2588483eadf6695a120cbcef1f8?s=128&d=identicon&r=PG&f=1", "display_name": "jwdonahue", "link": "https://stackoverflow.com/users/3150445/jwdonahue"}, "edited": false, "score": 3, "creation_date": 1530643457, "post_id": 51160746, "comment_id": 89305686, "body": "When you read a piece of code that calls functions you are not familiar with, you should look them up with a google search. What do you think <code>unlink(filename)</code> does?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1530644688, "post_id": 51160746, "comment_id": 89306235, "body": "... or I often find checking my local manual page to be more convenient.  But one way or another, you need to understand what the functions you&#39;re calling actually do."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1530646552, "post_id": 51160746, "comment_id": 89306898, "body": "Note that the problem the code you drew from is intended to mitigate is, from the linked site, &quot;It is a good idea to check whether a file exists or not before <b><i>creating</i></b> it&quot;  (emphasis added).  Note, too, that the original source contains comments that, had they been retained, might have clued you in to the nature of the problem."}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 0, "creation_date": 1530651697, "post_id": 51160746, "comment_id": 89308806, "body": "For standard C and POSIX.1 C functions such as these, the <a href=\"http://man7.org/linux/man-pages/dir_all_alphabetic.html\" rel=\"nofollow noreferrer\">Linux man pages project</a> is the most up to date source I know. Each page has a <i>Conforming to</i> section you can check to see which standards/systems support each function."}], "answers": [{"tags": [], "owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "is_accepted": false, "score": 2, "last_activity_date": 1530651441, "creation_date": 1530651441, "answer_id": 51162716, "question_id": 51160746, "link": "https://stackoverflow.com/questions/51160746/cs-open-overwriting-file-to-be-opened-and-fdopen-returning-null/51162716#51162716", "title": "C&#39;s open overwriting file to be opened and fdopen returning NULL", "body": "<p>First, <code>O_CREAT</code> creates a file if it does not exist, and <code>O_CREAT|O_EXCL</code> creates the file and fails if it already exists.</p>\n\n<p>Second, <code>(strncmp(mode, \"w\", 1) == 0)</code> is equivalent to <code>(mode[0] == 'w')</code>, which is probably not what you intended. You probably meant <code>(strchr(mode, \"w\"))</code> instead.</p>\n\n<p>Consider the following implementation (a full example program):</p>\n\n<pre><code>#define _POSIX_C_SOURCE 200809L\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/stat.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;errno.h&gt;\n\n/* Internal flags used by custom_fopen(): */\n#define  FM_R        (1&lt;&lt;0)  /* r, w+: For reading */\n#define  FM_W        (1&lt;&lt;1)  /* w, r+: For writing */\n#define  FM_TRUNC    (1&lt;&lt;2)  /* w, w+: Truncate */\n#define  FM_CREAT    (1&lt;&lt;3)  /* w, r+: Create if necessary */\n#define  FM_EXCL     (1&lt;&lt;4)  /* x: Fail if already exists */\n#define  FM_APPEND   (1&lt;&lt;5)  /* a: Append */\n#define  FM_CLOEXEC  (1&lt;&lt;6)  /* e: Close-on-exec() */\n#define  FM_SYMLINK  (1&lt;&lt;7)  /* s: Fail if last path component is a symlink */\n#define  FM_RW       (FM_R | FM_W) /* r+, w+ */\n\nFILE *custom_fopen(const char *path, const char *mode)\n{\n    const char *fdmode;\n    int         fm, flags, fd, saved_errno;\n    FILE       *ret;\n\n    if (!path || !*path || !mode) {\n        errno = EINVAL;\n        return NULL;\n    }\n\n    switch ((strchr(mode, 'r') ? 1 : 0) +\n            (strchr(mode, 'w') ? 2 : 0) +\n            (strchr(mode, 'a') ? 4 : 0) +\n            (strchr(mode, '+') ? 8 : 0)) {\n    case 1:  fdmode = \"r\";  fm = FM_R;                         break;\n    case 2:  fdmode = \"w\";  fm = FM_W  | FM_CREAT | FM_TRUNC;  break;\n    case 4:  fdmode = \"a\";  fm = FM_W  | FM_CREAT | FM_APPEND; break;\n    case 9:  fdmode = \"r+\"; fm = FM_RW | FM_CREAT;             break;\n    case 10: fdmode = \"w+\"; fm = FM_RW | FM_CREAT | FM_TRUNC;  break;\n    case 12: fdmode = \"a+\"; fm = FM_RW | FM_CREAT | FM_APPEND; break;\n    default:\n        /* Invalid combination of 'r', 'w', 'a', and '+'. */\n        errno = EINVAL;\n        return NULL;\n    }\n\n    if (strchr(mode, 'x')) {\n        if (fm &amp; FM_CREAT)\n            fm |= FM_EXCL;\n        else {\n            /* 'rx' does not make sense, and would not work anyway. */\n            errno = EINVAL;\n            return NULL;\n        }\n    }\n\n    if (strchr(mode, 'e'))\n        fm |= FM_CLOEXEC;\n\n    if (strchr(mode, 's'))\n        fm |= FM_SYMLINK;\n\n    /* Verify 'mode' consists of supported characters only. */\n    if (strlen(mode) != strspn(mode, \"rwa+xesb\")) {\n        errno = EINVAL;\n        return NULL;\n    }\n\n    /* Map 'fm' to 'flags' for open(). */\n    switch (fm &amp; FM_RW) {\n    case FM_R:  flags = O_RDONLY; break;\n    case FM_W:  flags = O_WRONLY; break;\n    case FM_RW: flags = O_RDWR;   break;\n    default:\n        errno = EINVAL;\n        return NULL;\n    }\n    if (fm &amp; FM_TRUNC)   flags |= O_TRUNC;\n    if (fm &amp; FM_CREAT)   flags |= O_CREAT;\n    if (fm &amp; FM_EXCL)    flags |= O_EXCL;\n    if (fm &amp; FM_APPEND)  flags |= O_APPEND;\n    if (fm &amp; FM_CLOEXEC) flags |= O_CLOEXEC;\n    if (fm &amp; FM_SYMLINK) flags |= O_NOFOLLOW;\n\n    /* Open the file. If we might create it, use mode 0666 like fopen() does. */\n    if (fm &amp; FM_CREAT)\n        fd = open(path, flags, 0666);\n    else\n        fd = open(path, flags);\n\n    /* Failed? */\n    if (fd == -1)\n        return NULL; /* errno set by open() */\n\n    /* Convert the file descriptor to a file handle. */\n    ret = fdopen(fd, fdmode);\n    if (ret)\n        return ret;\n\n    /* Failed. Remember the reason for the failure. */\n    saved_errno = errno;\n\n    /* If we created or truncated the file, unlink it. */\n    if (fm &amp; (FM_EXCL | FM_TRUNC))\n        unlink(path);\n\n    /* Close the file descriptor. */\n    close(fd);\n\n    /* Return, recalling the reason for the failure. */\n    errno = saved_errno;\n    return NULL;\n}\n\nint main(int argc, char *argv[])\n{\n    FILE *handle;\n\n    if (argc != 3 || !strcmp(argv[1], \"-h\") || !strcmp(argv[1], \"--help\")) {\n        fprintf(stderr, \"\\n\");\n        fprintf(stderr, \"Usage: %s [ -h | --help ]\\n\", argv[0]);\n        fprintf(stderr, \"       %s PATH MODE\\n\", argv[0]);\n        fprintf(stderr, \"\\n\");\n        return EXIT_FAILURE;\n    }\n\n    handle = custom_fopen(argv[1], argv[2]);\n    if (!handle) {\n        const int err = errno;\n        fprintf(stderr, \"custom_fopen(\\\"%s\\\", \\\"%s\\\") == NULL, errno = %d: %s.\\n\",\n                        argv[1], argv[2], err, strerror(err));\n        return EXIT_FAILURE;\n    }\n\n    if (fclose(handle)) {\n        const int err = errno;\n        fprintf(stderr, \"fclose(custom_fopen(\\\"%s\\\", \\\"%s\\\")) failed, errno = %d: %s.\\n\",\n                        argv[1], argv[2], err, strerror(err));\n        return EXIT_FAILURE;\n    }\n\n    printf(\"custom_fopen(\\\"%s\\\", \\\"%s\\\"): Success.\\n\", argv[1], argv[2]);\n    return EXIT_SUCCESS;\n}\n</code></pre>\n\n<p>The <code>#define _POSIX_C_SOURCE 200809L</code> tells your C library (at least those compatible to GNU C) to expose POSIX.1-2008 features (like <a href=\"http://man7.org/linux/man-pages/man2/open.2.html\" rel=\"nofollow noreferrer\"><code>open()</code></a>).</p>\n\n<p>The behaviour of <code>r</code>, <code>w</code>, <code>a</code>, <code>r+</code>, <code>w+</code>, and <code>a+</code> modes are as described in <a href=\"http://man7.org/linux/man-pages/man3/fopen.3.html\" rel=\"nofollow noreferrer\"><code>man 3 fopen</code></a>. At least one of these must be in <code>mode</code>. (The <code>+</code> does not need to immediately follow the letter, though.)</p>\n\n<p>The above implementation additionally supports <code>b</code> (does nothing, per POSIX), <code>x</code> (fail if creating a new file but it already exists), <code>s</code> (fail if the filename part of the path is a symlink), and <code>e</code> (close the descriptor at exec, not leaking it to child processes).</p>\n\n<p>The first <code>switch</code> statement handles the primary mode, ignoring the order of the characters. It essentially checks which of the four characters <code>rwa+</code> exist in <code>mode</code>, and only accepts the sane combinations. The <a href=\"http://man7.org/linux/man-pages/man3/strchr.3.html\" rel=\"nofollow noreferrer\"><code>strchr(mode, 'c')</code></a> calls return a nonzero pointer (logical true) if and only if <code>mode</code> contains <code>'c'</code>.</p>\n\n<p>The <code>if</code> clause following it detects <code>x</code> in the mode. The combination of <code>x</code> and <code>r</code> is not allowed, because it makes no sense. (POSIX.1 says the behaviour with <code>open()</code> with <code>O_RDONLY | O_EXCL</code> is undefined.)</p>\n\n<p>The <code>(strlen(mode) == strspn(mode, \"rwa+xesb\"))</code> verifies that <code>mode</code> consists only of letters <code>r</code>, <code>w</code>, <code>a</code>, <code>+</code>, <code>x</code>, <code>e</code>, <code>s</code>, and <code>b</code>; they can be repeated, or in any order.  This check rejects unsupported characters.</p>\n\n<p>The second <code>switch</code> statement and <code>if</code> clauses map <code>fm</code> to <code>flags</code>. We do this, because the <code>O_</code> constants may not be single bits, which means tests like <code>(flags &amp; O_RDONLY)</code>, <code>(flags &amp; O_WRONLY)</code>, and <code>(flags &amp; O_RDWR)</code> are not reliable, and in fact will not work the way one might expect.  Instead, we use <code>fm</code> and our own single-bit <code>FM_</code> constants that we can treat as masks, and just map them to corresponding values of <code>flags</code> later on.  (Simply put, <code>fm</code> tracks the features we want, and we only assign the corresponding set of flags to <code>flags</code>, and never <em>examine</em> <code>flags</code>.)</p>\n\n<p>If we might create the file, we use mode <code>0666</code> (<code>rw-rw-rw-</code>), as modified by user's <code>umask</code>. (Typically, normal users have an umask of <code>002</code>, <code>007</code>, <code>022</code>, or <code>077</code>, which result in new files getting modes <code>0664</code> (<code>rw-rw-r--</code>), <code>0660</code> (<code>rw-rw----</code>), <code>0644</code> (<code>rw-r--r--</code>), or <code>0600</code> (<code>rw-------</code>), respectively.)\nThis is exactly what <code>fopen()</code> does, too.</p>\n\n<p>When we have the open file descriptor, we must still associate it with a stream handle. We do that using <a href=\"http://man7.org/linux/man-pages/man3/fdopen.3.html\" rel=\"nofollow noreferrer\"><code>fdopen()</code></a>. Note that we decided on the correct <code>mode</code> for this call in the first <code>switch</code> statement.  If this call succeeds, the stream will \"own\" the file descriptor, and all we need to do is to return the stream handle <code>fdopen()</code> returned.</p>\n\n<p>If <code>fdopen()</code> fails, we need to close the file descriptor. We may also decide to remove/unlink the file. The above code removes the file if we are sure it did not exist previously (<code>e</code>), or if we truncated it (<code>w</code>, <code>w+</code>) as then the data it might have contained would be lost anyway.</p>\n\n<p>The test program takes two command-line parameters: a path or a file name, and the mode string. The program does a <code>custom_fopen(pathorfilename, modestring)</code> call, and reports the results. (If the <code>custom_fopen()</code> call succeeds, it also checks that the corresponding <code>fclose()</code> call succeeds, because sometimes issues related to the file descriptor (or incompatible mode flags for the <code>open()</code>/<code>fdopen()</code> calls) may only be observed at the first operation done, or at stream close fime. </p>\n\n<p>I've only lightly tested the above function and program, and bugs are always a possibility.  If you find a bug or have an issue with the code, let me know in a comment, so I can verify and fix if necessary.</p>\n"}], "owner": {"reputation": 301, "user_id": 9962552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0621a071527c22af36d881c60036d8f7?s=128&d=identicon&r=PG&f=1", "display_name": "ElsaInSpirit", "link": "https://stackoverflow.com/users/9962552/elsainspirit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 553, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1530651441, "creation_date": 1530641738, "question_id": 51160746, "link": "https://stackoverflow.com/questions/51160746/cs-open-overwriting-file-to-be-opened-and-fdopen-returning-null", "title": "C&#39;s open overwriting file to be opened and fdopen returning NULL", "body": "<p>I'm trying to write a secure version of fopen that prevents the opening of symbolically linked files. Below is my code taken from <a href=\"https://security.web.cern.ch/security/recommendations/en/codetools/c.shtml\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<pre><code>/* \n    Secure fopen \n*/\nenum { FILE_MODE = 0600 };\n\nFILE *secure_fopen(char *filename, char* mode)\n{\n    int fd;\n    FILE *f;\n\n    unlink(filename);\n\n    if (strncmp(mode, \"w\", 1) == 0) {\n        fd = open(filename, O_WRONLY|O_CREAT|O_EXCL, FILE_MODE);\n    }\n    else if (strncmp(mode, \"r\", 1) == 0) {\n        fd = open(filename, O_RDONLY|O_CREAT|O_EXCL);\n    }\n    else {\n        fd = open(filename, O_RDWR|O_CREAT|O_EXCL, FILE_MODE);\n    }\n\n    if (fd == -1) {\n        perror(\"Failed to open the file\");\n        return NULL; \n    }\n    /* Get a FILE*, as they are easier and more efficient than file descriptors */\n    f = fdopen(fd, mode);\n    if (f == NULL) {\n        perror(\"Failed to associate file descriptor with a stream\");\n        return NULL; \n    }\n    return f;\n}\n</code></pre>\n\n<p>There are two issues with this code: one - it's overwriting the file pointed to by filename and two - it's returning NULL, but the NULL file pointer doesn't get caught in the final check: </p>\n\n<pre><code>if (f == NULL) {\n    perror(\"Failed to associate file descriptor with a stream\");\n    return NULL; \n}\n</code></pre>\n\n<p>Does anybody have any insight into way these two things are happening?</p>\n"}, {"tags": ["c", "macros", "concatenation"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1530640421, "post_id": 51160412, "comment_id": 89304241, "body": "Does a solution that invokes the preprocessor twice count?"}, {"owner": {"reputation": 4060, "user_id": 4784683, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/baa572872b7ec1fc6c1a52d1230c4872?s=128&d=identicon&r=PG&f=1", "display_name": "Bob", "link": "https://stackoverflow.com/users/4784683/bob"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1530640519, "post_id": 51160412, "comment_id": 89304289, "body": "@melpomene this is related to micropython. I doubt they&#39;re going to allow a commit which changes the build-system like that."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1530641666, "post_id": 51160412, "comment_id": 89304844, "body": "No way you can do this."}, {"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 0, "creation_date": 1530642284, "post_id": 51160412, "comment_id": 89305157, "body": "Obligatory general advice: don&#39;t do stuff like this with CPP macros, unless it&#39;s for fun, or for being evil, or because others were evil already and you must suffer the consequences..."}, {"owner": {"reputation": 4060, "user_id": 4784683, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/baa572872b7ec1fc6c1a52d1230c4872?s=128&d=identicon&r=PG&f=1", "display_name": "Bob", "link": "https://stackoverflow.com/users/4784683/bob"}, "reply_to_user": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 0, "creation_date": 1530642578, "post_id": 51160412, "comment_id": 89305300, "body": "@hyde if it&#39;s not possible, that&#39;s not relevant. If it is possible, I&#39;d like to know because it will be useful to devs."}], "answers": [{"comments": [{"owner": {"reputation": 4060, "user_id": 4784683, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/baa572872b7ec1fc6c1a52d1230c4872?s=128&d=identicon&r=PG&f=1", "display_name": "Bob", "link": "https://stackoverflow.com/users/4784683/bob"}, "edited": false, "score": 0, "creation_date": 1530644213, "post_id": 51161267, "comment_id": 89306028, "body": "But this work for macros? Can I create a macro name like this without doing multiple invocations of the preprocessor?"}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "reply_to_user": {"reputation": 4060, "user_id": 4784683, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/baa572872b7ec1fc6c1a52d1230c4872?s=128&d=identicon&r=PG&f=1", "display_name": "Bob", "link": "https://stackoverflow.com/users/4784683/bob"}, "edited": false, "score": 2, "creation_date": 1530644434, "post_id": 51161267, "comment_id": 89306121, "body": "@Adrian: Read the first line again. <b>The macro name is always a single token</b>. You cannot use <code>#define</code> to create a macro whose name is anything other than a single token. You cannot paste or join tokens to form the name of the macro to be defined: those only work in the value part."}, {"owner": {"reputation": 4060, "user_id": 4784683, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/baa572872b7ec1fc6c1a52d1230c4872?s=128&d=identicon&r=PG&f=1", "display_name": "Bob", "link": "https://stackoverflow.com/users/4784683/bob"}, "edited": false, "score": 0, "creation_date": 1530644470, "post_id": 51161267, "comment_id": 89306137, "body": "K. I didn&#39;t understand what that implied."}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "reply_to_user": {"reputation": 4060, "user_id": 4784683, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/baa572872b7ec1fc6c1a52d1230c4872?s=128&d=identicon&r=PG&f=1", "display_name": "Bob", "link": "https://stackoverflow.com/users/4784683/bob"}, "edited": false, "score": 1, "creation_date": 1530644526, "post_id": 51161267, "comment_id": 89306159, "body": "@Adrian: Oh, okay. I don&#39;t know how to put it clearer than that. The point of my answer is to show that you don&#39;t need to do that. You can use function-like macros, that expand to the desired combined value, based on the macro parameters."}], "tags": [], "owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "is_accepted": true, "score": 1, "last_activity_date": 1530643989, "creation_date": 1530643989, "answer_id": 51161267, "question_id": 51160412, "link": "https://stackoverflow.com/questions/51160412/c-macro-how-to-set-a-macro-name-as-the-output-of-another-macro/51161267#51161267", "title": "c macro - how to set a macro name as the output of another macro", "body": "<p>In a macro definition, the name part is always a single preprocessor token. However, you can use function-like macros, with parameters, that expand to a single token.</p>\n\n<p>Consider the following macros:</p>\n\n<pre><code>#define  JOIN(a,b)       a ## b\n\n#define  FOO(suffix)     JOIN(FOO_, suffix)\n#define  FOOBAZ          JOIN(FOO_, BAZ)\n#define  FOOBAAZ         JOIN(foo_, baaz)\n\n#define  FOO_BAR         first\n#define  FOO_BAZ         second\n</code></pre>\n\n<p>With the above definitions, declaring</p>\n\n<pre><code>int FOO(BAR) = 1;\nint FOOBAZ = 2;\nint FOOBAAZ = 3;\n</code></pre>\n\n<p>is equivalent to (i.e., gets preprocessed to)</p>\n\n<pre><code>int first = 1;\nint second = 2;\nint foo_baaz = 3;\n</code></pre>\n\n<hr>\n\n<p>There are cases (especially when exploring various algorithms) when templates or polymorphic code is useful. Consider for example the following <strong>ops.h</strong>:</p>\n\n<pre><code>#if defined(TYPE) &amp;&amp; defined(PREFIX)\n#undef   JOIN2\n#define  JOIN2_(a,b)  a ## b\n#define  JOIN2(a,b)   JOIN2_(a, b)\n#define  NAME(end)    JOIN2(PREFIX, end)\n\nstatic inline TYPE NAME(_add)(const TYPE val1, const TYPE val2)\n{\n    return val1 + val2;\n}\n\nstatic inline TYPE NAME(_sub)(const TYPE val1, const TYPE val2)\n{\n    return val1 - val2;\n}\n\nstatic inline TYPE NAME(_neg)(const TYPE val)\n{\n    return -val;\n}\n\nstatic inline TYPE NAME(_mul)(const TYPE val1, const TYPE val2)\n{\n    return val1 * val2;\n}\n\nstatic inline TYPE NAME(_div)(const TYPE val1, const TYPE val2)\n{\n    return val1 / val2;\n}\n\n#endif\n\n#undef   NAME\n#undef   JOIN2\n#undef   PREFIX\n#undef   TYPE\n</code></pre>\n\n<p>The macro <code>NAME(suffix)</code> expands to a single token consisting of the expansion of <code>PREFIX</code> immediately followed by the expansion of <code>suffix</code>. (If they are not preprocessor macros, they are used as-is.)  This allows the same header file to be included multiple times, assuming <code>PREFIX</code> is defined to a new value each time.</p>\n\n<p>Note that it is common to have a space between e.g. <code>NAME(_add)</code> and the following <code>(const TYPE val1, const TYPE val2)</code>.  I omitted it, in the hopes that it makes the function definitions more familiar-looking.</p>\n\n<p>Let's look at an example program using such a header file:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;inttypes.h&gt;\n#include &lt;stdio.h&gt;\n\n#define  TYPE    uint32_t\n#define  PREFIX  u32\n#include \"ops.h\"\n\n#define  TYPE    float\n#define  PREFIX  float\n#include \"ops.h\"\n\n#define  TYPE    double\n#define  PREFIX  dbl\n#include \"ops.h\"\n\nint main(void)\n{\n    printf(\"dbl_div(217.0, 31.0) = %.1f\\n\", dbl_div(217.0, 31.0));\n    printf(\"u32_sub(4, 2) = %\" PRIu32 \"\\n\", u32_sub(4, 2));\n    printf(\"float_mul(1.25f, 72.00f) = %.2ff\\n\", float_mul(1.25f, 72.00f));\n    return EXIT_SUCCESS;\n}\n</code></pre>\n\n<p>The first <code>#include \"ops.h\"</code> defines functions <code>u32_add()</code>, <code>u32_sub()</code>, <code>u32_neg()</code>, <code>u32_mul()</code>, and <code>u32_div()</code>.  The second defines functions <code>float_add()</code> and so on, and the third <code>dbl_add()</code> and so on.</p>\n\n<p>The above files are valid C99, and when compiled and run, it outputs</p>\n\n<pre><code>dbl_div(217.0, 31.0) = 7.0\nu32_sub(4, 2) = 2\nfloat_mul(1.25f, 72.00f) = 90.00f\n</code></pre>\n\n<p>If you combine the above with suitable macros using C11 <code>_Generic</code>, you can make \"functions\" that call different implementations based on the type of their argument.</p>\n"}], "owner": {"reputation": 4060, "user_id": 4784683, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/baa572872b7ec1fc6c1a52d1230c4872?s=128&d=identicon&r=PG&f=1", "display_name": "Bob", "link": "https://stackoverflow.com/users/4784683/bob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 877, "favorite_count": 0, "accepted_answer_id": 51161267, "answer_count": 1, "score": -1, "last_activity_date": 1530643989, "creation_date": 1530640303, "question_id": 51160412, "link": "https://stackoverflow.com/questions/51160412/c-macro-how-to-set-a-macro-name-as-the-output-of-another-macro", "title": "c macro - how to set a macro name as the output of another macro", "body": "<p>I want to do create a macro whose name is a concatenation of two things i.e.</p>\n\n<pre><code>#define name ## _body(a) \\\n    a\n</code></pre>\n\n<p>but <code>gcc -E</code> gives the error</p>\n\n<blockquote>\n  <p>macros.c:9:18: error: '##' cannot appear at either end of a macro expansion\n   #define typename ## _body(body) \\</p>\n</blockquote>\n\n<p><strong>QUESTION</strong></p>\n\n<p>Is it possible to do this <em>using only C preprocessor</em>?</p>\n"}, {"tags": ["c", "integer", "unsigned-integer"], "comments": [{"owner": {"reputation": 1220, "user_id": 5878272, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/14e96159153b67fab5222b7c5fa18c71?s=128&d=identicon&r=PG&f=1", "display_name": "Fredrik", "link": "https://stackoverflow.com/users/5878272/fredrik"}, "edited": false, "score": 0, "creation_date": 1530639975, "post_id": 51160300, "comment_id": 89304025, "body": "Because that is a valid int value."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 5, "creation_date": 1530639980, "post_id": 51160300, "comment_id": 89304026, "body": "<code>0xFFFFFFFF</code> is not a signed or unsigned value, but the hexadecimal representation of a bit pattern, which is meaningful in its context."}, {"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 0, "creation_date": 1530640096, "post_id": 51160300, "comment_id": 89304080, "body": "The value is not too high, <code>0XFFFFFFFF</code> is filling all the bits of the <code>int</code>"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 3, "creation_date": 1530640132, "post_id": 51160300, "comment_id": 89304100, "body": "@WeatherVane <code>0xFFFFFFFF</code> has a type..."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1530640182, "post_id": 51160300, "comment_id": 89304122, "body": "@EugeneSh. go on..."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1530640302, "post_id": 51160300, "comment_id": 89304184, "body": "@WeatherVane It is an integer constant. Signed or unsigned depending on the implementation"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1530640750, "post_id": 51160300, "comment_id": 89304414, "body": "@EugeneSh. conversely using the <code>printf</code> format specifier <code>%X</code> does not output any sign, only the hex representation of the bits in the value passed."}, {"owner": {"reputation": 937, "user_id": 9242445, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2IaxD.jpg?s=128&g=1", "display_name": "Marker", "link": "https://stackoverflow.com/users/9242445/marker"}, "edited": false, "score": 1, "creation_date": 1530640830, "post_id": 51160300, "comment_id": 89304456, "body": "For a signed 32-bit integer, the value 0xFFFFFFFF is a -1 (2&#39;s complement) which is valid.   Even if it was out of range, C doesn&#39;t do any range checking (that I know of); values are just truncated.   This makes compiled C code fast.  The burden is put on the developer to write correct code or range check when needed."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 3, "creation_date": 1530640889, "post_id": 51160300, "comment_id": 89304476, "body": "The actual value of <code>n</code> here is implementation defined. If <code>int</code> is 32-bit long, then the type of <code>0xFFFFFFFF</code> is <code>unsigned int</code> (see <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.4.4.1p4\" rel=\"nofollow noreferrer\">here</a>). Then converted to <code>int</code> the result is <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.3.1.3p3\" rel=\"nofollow noreferrer\">implementation defined</a>. Printing <code>int</code> as <code>%x</code> or <code>%u</code> is undefined behavior."}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 1, "creation_date": 1530641663, "post_id": 51160300, "comment_id": 89304841, "body": "There&#39;s no meaningful answer to the main question. This is a genuine case for a warning. The compilers should warn."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 3, "creation_date": 1530663367, "post_id": 51160300, "comment_id": 89311852, "body": "Per C 2011 (N1570) 6.4.4.1 paragraph 5, the type of a hexadecimal constant without a suffix is the first of the following that can represent its value: <code>int</code>, <code>unsigned int</code>, <code>long int</code>, <code>unsigned long int</code>, <code>long long int</code>, and <code>unsigned long long int</code>. Thus, in a C implementation in which <code>int</code> has 32 value bits, <code>0xFFFFFFFF</code> is an <code>unsigned int</code>. In a C implementation in which <code>int</code> has 64 value bits, <code>0xFFFFFFFF</code> is an <code>int</code>."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "reply_to_user": {"reputation": 937, "user_id": 9242445, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2IaxD.jpg?s=128&g=1", "display_name": "Marker", "link": "https://stackoverflow.com/users/9242445/marker"}, "edited": false, "score": 1, "creation_date": 1530665878, "post_id": 51160300, "comment_id": 89312258, "body": "@Marker incorrect-o. The standard doesn&#39;t specify truncation, 2&#39;s complement or anything such. The last sentence is mostly true."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1530666572, "post_id": 51160300, "comment_id": 89312367, "body": "@WeatherVane <code>0xFFFFFFFF</code> is an unsigned integer constant. C assignment has value semantics, the representation does not matter."}], "answers": [{"tags": [], "owner": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "is_accepted": false, "score": 4, "last_activity_date": 1530641279, "last_edit_date": 1530641279, "creation_date": 1530640990, "answer_id": 51160588, "question_id": 51160300, "link": "https://stackoverflow.com/questions/51160300/why-do-c-compilers-not-warn-when-assigning-integer-value-too-high-for-signed-typ/51160588#51160588", "title": "Why do C compilers not warn when assigning integer value too high for signed type?", "body": "<p><code>0xFFFFFFFF</code>, on a platform where <code>unsigned</code> has a maximum value of 2<sup>32</sup>-1, will have the type <code>unsigned</code> according to \"6.4.4.1 Integer Constants\" of the Standard.</p>\n\n<p>And then we get to the conversion:</p>\n\n<blockquote>\n  <h3>6.3.1.3 Signed and unsigned integers</h3>\n  \n  <p>1 When a value with integer type is converted to another integer type other than _Bool, if the value can be represented by the new type, it is unchanged.<br>\n  2 Otherwise, if the new type is unsigned, the value is converted by repeatedly adding or subtracting one more than the maximum value that can be represented in the new type until the value is in the range of the new type.60)<br>\n  3 Otherwise, the new type is signed and the value cannot be represented in it; either the result is implementation-de\ufb01ned or an implementation-de\ufb01ned signal is raised.</p>\n</blockquote>\n\n<p>So, the result is implementation-defined or raises an implementation-defined signal.</p>\n\n<p>Now, you print your <code>int</code> with the format <code>%u</code>, which is just plain mismatched. And while that is strictly speaking UB, you will likely get the original constant, assuming you have 2s-complement and the original assignment used wrap-around.</p>\n"}, {"comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1530667929, "post_id": 51164559, "comment_id": 89312613, "body": "<code>unsigned char c = &#39;\\x80&#39;;</code> also invokes implementation-defined behaviour. <code>128</code> is out of range of the execution character set on this system which is -128 through +127.  (C11 6.4.4.4/10). So I would consider that example to be in the same category as the original one: implementation-defined , but always works as expected, for a suitable definition of &quot;always&quot;."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1530669185, "post_id": 51164559, "comment_id": 89312860, "body": "@M.M it is 5AM here, I guess what I meant that the conversion from <code>int</code> is well-defined"}], "tags": [], "owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "is_accepted": false, "score": 4, "last_activity_date": 1530666899, "last_edit_date": 1530666899, "creation_date": 1530666439, "answer_id": 51164559, "question_id": 51160300, "link": "https://stackoverflow.com/questions/51160300/why-do-c-compilers-not-warn-when-assigning-integer-value-too-high-for-signed-typ/51164559#51164559", "title": "Why do C compilers not warn when assigning integer value too high for signed type?", "body": "<p>The C standard doesn't specify the behaviour but requires that the implementation specifies it. <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Integers-implementation.html\" rel=\"nofollow noreferrer\"><em>GCC</em> always uses 2's complement representation and converts via truncation</a>, therefore <code>int32_t i = 0xFFFFFFFF;</code> will result in <code>i</code> being set to -1 when compiled with GCC. On other compilers YMMV.</p>\n\n<hr>\n\n<p>To get the warning from GCC you need to give the <a href=\"https://gcc.gnu.org/wiki/NewWconversion\" rel=\"nofollow noreferrer\"><code>-Wsign-conversion</code> flag</a>:</p>\n\n<pre><code>% gcc 0xfffffff.c -c -Wsign-conversion                         \n0xfffffff.c:1:9: warning: conversion of unsigned constant value to negative integer\n        [-Wsign-conversion]\n int i = 0xFFFFFFFF;\n         ^~t ~~~~~~~~\n</code></pre>\n\n<p>In general C compilers by default produce warnings only about very blatant errors and of constraint violations. The <code>-Wsign-conversion</code> would make many compilations very noisy - even those that are well-defined, like:</p>\n\n<pre><code>unsigned char c = '\\x80';\n</code></pre>\n\n<p>which produces</p>\n\n<pre><code>unsignedchar.c:1:19: warning: negative integer implicitly converted to unsigned type\n         [-Wsign-conversion]\n unsigned char c = '\\x80';\n                   ^~~~~~\n</code></pre>\n\n<p>on implementations where <code>char</code> is signed.</p>\n"}, {"tags": [], "owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "is_accepted": true, "score": 3, "last_activity_date": 1542660699, "last_edit_date": 1542660699, "creation_date": 1530667811, "answer_id": 51164679, "question_id": 51160300, "link": "https://stackoverflow.com/questions/51160300/why-do-c-compilers-not-warn-when-assigning-integer-value-too-high-for-signed-typ/51164679#51164679", "title": "Why do C compilers not warn when assigning integer value too high for signed type?", "body": "<p>Assume that <code>int</code> and <code>unsigned int</code> are 32 bits, which is the case on most platforms you're likely to be using (both 32-bit and 64-bit systems). Then the constant <code>0xFFFFFFFF</code> is of type <code>unsigned int</code>, and has the value 4294967295.</p>\n\n<p>This:</p>\n\n<pre><code>int n = 0xFFFFFFFF;\n</code></pre>\n\n<p>implicitly converts that value from <code>unsigned int</code> to <code>int</code>. The result of the conversion is implementation-defined; there is no undefined behavior. (In principle, it can also cause an implementation-defined signal to be raised, but I know of no implementations that do that).</p>\n\n<p>Most likely the value stored in <code>n</code> will be <code>-1</code>.</p>\n\n<pre><code>printf(\"%u\\n\", n);\n</code></pre>\n\n<p>Here you use a <code>%u</code> format specifier, which requires an argument of type <code>unsigned int</code>, but you pass it an argument of type <code>int</code>. The standard says that values of corresponding signed and unsigned type are interchangeable as function arguments, but <em>only</em> for values that are within the range of both types, which is not the case here.</p>\n\n<p>This call does not perform a conversion from <code>int</code> to <code>unsigned int</code>. Rather, an <code>int</code> value is passed to <code>printf</code>, which <em>assumes</em> that the value it received is of type <code>unsigned int</code>. The behavior is undefined. (Again, this would be a reasonable thing to warn about.)</p>\n\n<p>The most likely result is that the <code>int</code> value of <code>-1</code>, which (assuming 2's-complement) has the same representation as <code>0xFFFFFFFF</code>, will be treated as if it were an <code>unsigned int</code> value of <code>0xFFFFFFFF</code>, which is printed in decimal as <code>4294967295</code>.</p>\n\n<p>You can get a warning on <code>int n = 0xFFFFFFFF;</code> by using the <code>-Wconversion</code> or <code>-Wsign-conversion</code> option. These option are not included in <code>-Wextra</code> or <code>-Wall</code>. (You'd have to ask the gcc maintainers why.)</p>\n\n<p>I don't know of an option that will cause a warning on the <code>printf</code> call.</p>\n\n<p>(Of course the fix is to define <code>n</code> as an <code>unsigned int</code>, which makes everything correct and consistent.)</p>\n"}], "owner": {"reputation": 1519, "user_id": 5447136, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/bpy5K.jpg?s=128&g=1", "display_name": "bool3max", "link": "https://stackoverflow.com/users/5447136/bool3max"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 258, "favorite_count": 1, "accepted_answer_id": 51164679, "answer_count": 3, "score": 0, "last_activity_date": 1542660699, "creation_date": 1530639805, "question_id": 51160300, "link": "https://stackoverflow.com/questions/51160300/why-do-c-compilers-not-warn-when-assigning-integer-value-too-high-for-signed-typ", "title": "Why do C compilers not warn when assigning integer value too high for signed type?", "body": "<p>(assuming 64bit machine)</p>\n\n<p>e.g.</p>\n\n<pre><code>int n = 0xFFFFFFFF; //max 32bit unsigned number\nprintf(\"%u\\n\", n);\n</code></pre>\n\n<p>The maximum positive number that a regular signed integer (32bit) can store is <code>0x7FFFFFFF</code>. </p>\n\n<p>In the above example I'm assigning the maximum <em>unsigned</em> integer value to a regular signed integer, I'm receiving no warnings or error from GCC, and the result is printed without problems (with <code>-Wall -Wextra</code>). </p>\n\n<p>Appending <code>U</code> or <code>L</code> to the hex constant changes nothing.</p>\n\n<p>Why is that?</p>\n"}, {"tags": ["c", "language-lawyer", "function-parameter", "memory-layout"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1530639880, "post_id": 51160276, "comment_id": 89303984, "body": "You are mixing up the storage of the different storage classes and the storage layout of different types. The former is not defined for any, only the lifetime is defined."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1530640195, "post_id": 51160276, "comment_id": 89304130, "body": "What&#39;s more interesting, that statement seems to be the only instance of the word &quot;layout&quot; in the standard, so I&#39;m not even sure what it&#39;s talking about here."}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 2, "creation_date": 1530640786, "post_id": 51160276, "comment_id": 89304433, "body": "Many architectures have ABIs where first function parameters are passed in registers. However, one is still allowed to take the address of a function parameter. To avoid unnecessary overhead, compilers can do all sorts of optimizations, like copying the registers to stack in some random order (possibly even differing from one invocation to the next). I do believe the purpose of <a href=\"https://port70.net/~nsz/c/c11/n1570.html#6.9.1\" rel=\"nofollow noreferrer\">C11 6.9.1p9</a> is to explicitly state that sort of approach is expected and allowed; that the addresses of the function parameters are essentially unpredictable."}, {"owner": {"reputation": 5010, "user_id": 3150445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bfca2588483eadf6695a120cbcef1f8?s=128&d=identicon&r=PG&f=1", "display_name": "jwdonahue", "link": "https://stackoverflow.com/users/3150445/jwdonahue"}, "edited": false, "score": 0, "creation_date": 1530643326, "post_id": 51160276, "comment_id": 89305620, "body": "See my <a href=\"https://stackoverflow.com/questions/51088152/redundant-code-in-hard-fault-handling-of-arm-cortex-m-processor/51110090#51110090\">recent answer, regarding ABI&#39;s</a>, to a related question."}], "answers": [{"comments": [{"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1530653189, "post_id": 51162221, "comment_id": 89309314, "body": "ITYM &quot; not even allowed to do comparison with the <code>&lt;</code> operator on two pointers that do not point into the same array&quot;?"}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1530723937, "post_id": 51162221, "comment_id": 89339179, "body": "@SteveSummit: The Standard expressly indicates that it is possible to convert an object&#39;s address to a character pointer and use that to access the bytes therein.  Because the Standard&#39;s sloppy and inconsistent usage of the term &quot;object&quot;, it can&#39;t describe the pointer as identifying a character-array object (if the character-array object is created when the parent object is created, any access to non-character parts of the the object would also access the character-array object using a non-character type, thus invoking ub by 6.5p7, but the Standard fails to offer..."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1530724101, "post_id": 51162221, "comment_id": 89339238, "body": "...any other description of the object&#39;s lifetime).  I don&#39;t think the authors of the Standard worried about such things because they expected that compiler writers would recognize how quality implementations should behave in what should be obvious cases, regardless of whether the Standard mandated such behavior."}], "tags": [], "owner": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "is_accepted": true, "score": 1, "last_activity_date": 1530648757, "creation_date": 1530648757, "answer_id": 51162221, "question_id": 51160276, "link": "https://stackoverflow.com/questions/51160276/storage-layout-of-c-objects/51162221#51162221", "title": "Storage layout of C objects", "body": "<p>No, I don't think that there is an explicit mention of the fact that we can't know anything about relative object layout. In fact, the C standard is even more radical than that, you are not even allowed to do comparison with the <code>&lt;</code> operator on two variables that are not elements of the same array, nor may you do arithmetic between pointers to objects that are not part of the same array.</p>\n\n<p>So the whole question of \"layout\" cannot even be formulate with the terminology that the C standard provides.</p>\n"}], "owner": {"reputation": 739, "user_id": 2359990, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1f7130d72f637bce50544029ccd6998a?s=128&d=identicon&r=PG", "display_name": "Max Maier", "link": "https://stackoverflow.com/users/2359990/max-maier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "accepted_answer_id": 51162221, "answer_count": 1, "score": 1, "last_activity_date": 1530648757, "creation_date": 1530639697, "last_edit_date": 1530643439, "question_id": 51160276, "link": "https://stackoverflow.com/questions/51160276/storage-layout-of-c-objects", "title": "Storage layout of C objects", "body": "<p>The storage layout of C objects is mostly not defined. As far as I know only for <code>struct</code> members and array elements, the layout is defined.</p>\n\n<p>Interestingly for function parameters the C11 standard explicitly mentions that the layout is not defined:</p>\n\n<blockquote>\n  <p>The layout of the storage for parameters is unspecified. (C11 \u00a7 6.9.1 P 9)</p>\n</blockquote>\n\n<p>I was wondering if the standard also explicitly defines that for other objects, e.g., objects with automatic storage duration, the layout is undefined. Is someone aware of this? I couldn't find anything about this in the standard.</p>\n\n<p>What about objects with internal or external linkage?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 13530, "user_id": 593382, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/f7326fd554e09edf21ca727d6854e22e?s=128&d=identicon&r=PG", "display_name": "Grady Player", "link": "https://stackoverflow.com/users/593382/grady-player"}, "edited": false, "score": 10, "creation_date": 1530638317, "post_id": 51159932, "comment_id": 89303196, "body": "dude curly braced don&#39;t cost you anything"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 4, "creation_date": 1530638341, "post_id": 51159932, "comment_id": 89303214, "body": "<code>chartline = &#39;-&#39;*chartlen; &#47;*create a line with the length of chartlen and then print it*&#47;</code> - NO. It is C, not Python."}, {"owner": {"reputation": 13530, "user_id": 593382, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/f7326fd554e09edf21ca727d6854e22e?s=128&d=identicon&r=PG", "display_name": "Grady Player", "link": "https://stackoverflow.com/users/593382/grady-player"}, "edited": false, "score": 1, "creation_date": 1530638496, "post_id": 51159932, "comment_id": 89303305, "body": "to add to the comment above &#39;-&#39; is a char which is just like a 1 byte int... int * int is int... not a string of chartlen length... see  man memset and also malloc"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1530638548, "post_id": 51159932, "comment_id": 89303328, "body": "Aside - with or without braces, <code>else continue;</code> is redundant as the last line in a <code>for</code> loop."}, {"owner": {"reputation": 31, "user_id": 8508575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af079199078d6a524aa3f8511ba95afd?s=128&d=identicon&r=PG&f=1", "display_name": "Tpurdy", "link": "https://stackoverflow.com/users/8508575/tpurdy"}, "edited": false, "score": 0, "creation_date": 1530638637, "post_id": 51159932, "comment_id": 89303372, "body": "I&#39;m exceedingly new to C, so curly braces are still something I need to remember. Also, I had looked up how to do this in C and &quot;chartline = &#39; - &#39;*chartlen&quot; was what I ended up finding, which obviously doesn&#39;t work and is part of why I&#39;m posting here"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1530638743, "post_id": 51159932, "comment_id": 89303417, "body": "If you are looking for a maximum I suggest <code>chartlen = 10;</code> should be <code>chartlen = 0;</code> unless you never want the chart to be smaller than <code>10</code>."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1530638928, "post_id": 51159932, "comment_id": 89303503, "body": "<code>*</code> is an arithmetic operator and works for numbers only. To create a string - you need a space for it and a way to give a value to <i>each</i> character. you can use <code>memset</code> as suggested, but you have to take care of null-termination as well. Anyway, since you are working through the book, you will eventually come by the chapter about strings. It is not a trivial topic."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1530639262, "post_id": 51159932, "comment_id": 89303670, "body": "To print N <code>&#39;-&#39;</code>, code can use a loop <code>for(int i=0;i&lt;N;i++) putchar(&#39;-&#39;);</code>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1530639352, "post_id": 51159932, "comment_id": 89303715, "body": "Posting a simple sample input and your output would add clarity to this post.  More useful than &quot;no longer count properly&quot;."}, {"owner": {"reputation": 31, "user_id": 8508575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af079199078d6a524aa3f8511ba95afd?s=128&d=identicon&r=PG&f=1", "display_name": "Tpurdy", "link": "https://stackoverflow.com/users/8508575/tpurdy"}, "edited": false, "score": 0, "creation_date": 1530639378, "post_id": 51159932, "comment_id": 89303727, "body": "yeah, chux, that&#39;s what I wound up doing a moment ago. I now just need to have it so it won&#39;t print less than 10 &#39;-&#39;. I thought the for loop I had set up above it would work but doesn&#39;t seem so"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1530639445, "post_id": 51159932, "comment_id": 89303756, "body": "@Tpurdy Re-read <a href=\"https://stackoverflow.com/questions/51159932/learning-c-ran-into-issue-with-program-to-count-characters-and-create-a-histogr#comment89303417_51159932\">Weather Vane</a> comment."}, {"owner": {"reputation": 31, "user_id": 8508575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af079199078d6a524aa3f8511ba95afd?s=128&d=identicon&r=PG&f=1", "display_name": "Tpurdy", "link": "https://stackoverflow.com/users/8508575/tpurdy"}, "edited": false, "score": 0, "creation_date": 1530639459, "post_id": 51159932, "comment_id": 89303765, "body": "that&#39;s also true.Though, now that I&#39;ve changed the final section to a for loop I no longer seem to be running into the issue."}, {"owner": {"reputation": 2633, "user_id": 27898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84028aac31ee14ca90aa08c2442e3a1e?s=128&d=identicon&r=PG", "display_name": "mpez0", "link": "https://stackoverflow.com/users/27898/mpez0"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1530642565, "post_id": 51159932, "comment_id": 89305295, "body": "A couple of comments have implicitly recognized this, but I want to make it explicit for the OP: chartline is declared as an int, so you shouldn&#39;t expect it to work as a string (ignoring the * operator issue). Use @chux&#39;s loop, and you don&#39;t need chartline at all."}, {"owner": {"reputation": 5010, "user_id": 3150445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bfca2588483eadf6695a120cbcef1f8?s=128&d=identicon&r=PG&f=1", "display_name": "jwdonahue", "link": "https://stackoverflow.com/users/3150445/jwdonahue"}, "edited": false, "score": 0, "creation_date": 1530644282, "post_id": 51159932, "comment_id": 89306052, "body": "Also please keep in mind that K&amp;R&#39;s coding style is partly what it is to save space on the page and not clutter their examples with extraneous symbols while showing off some features. It&#39;s not exactly what most of us use today. There are some style habits that will help you avoid making common programming errors which the K&amp;R book doesn&#39;t go into. One of them is avoid using declaration lists of the form <code>int c, i, nwhite, nother, ...</code> except maybe in cases where it makes sense, like <code>int x, y, z; &#47;&#47; current location in universal coordinate frame</code>."}, {"owner": {"reputation": 5010, "user_id": 3150445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bfca2588483eadf6695a120cbcef1f8?s=128&d=identicon&r=PG&f=1", "display_name": "jwdonahue", "link": "https://stackoverflow.com/users/3150445/jwdonahue"}, "edited": false, "score": 0, "creation_date": 1530644365, "post_id": 51159932, "comment_id": 89306088, "body": "Using braces is mandatory at many companies."}, {"owner": {"reputation": 31, "user_id": 8508575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af079199078d6a524aa3f8511ba95afd?s=128&d=identicon&r=PG&f=1", "display_name": "Tpurdy", "link": "https://stackoverflow.com/users/8508575/tpurdy"}, "reply_to_user": {"reputation": 5010, "user_id": 3150445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bfca2588483eadf6695a120cbcef1f8?s=128&d=identicon&r=PG&f=1", "display_name": "jwdonahue", "link": "https://stackoverflow.com/users/3150445/jwdonahue"}, "edited": false, "score": 0, "creation_date": 1530645956, "post_id": 51159932, "comment_id": 89306693, "body": "@jwdonahue do you know of a better resource that I can look into after running through K&amp;R?"}, {"owner": {"reputation": 5010, "user_id": 3150445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bfca2588483eadf6695a120cbcef1f8?s=128&d=identicon&r=PG&f=1", "display_name": "jwdonahue", "link": "https://stackoverflow.com/users/3150445/jwdonahue"}, "edited": false, "score": 0, "creation_date": 1530646467, "post_id": 51159932, "comment_id": 89306865, "body": "Best I can offer is <a href=\"https://www.google.com/search?source=hp&amp;ei=jM47W8_LMPDB0PEP0_abiAI&amp;q=c+books+for+beginners&amp;oq=C+books&amp;gs_l=psy-ab.1.1.0l7j0i22i30k1l3.395.7024.0.10248.7.7.0.0.0.0.113.382.6j1.7.0....0...1c.1.64.psy-ab..0.7.381...0i131k1.0.6_E3krAfE4A\" rel=\"nofollow noreferrer\">a google search result</a>. All of my old reference material has been in boxes for over a decade. When you&#39;ve been immersed in it for decades, you tend to just absorb stuff from exposure and experience."}], "answers": [{"tags": [], "owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "is_accepted": false, "score": 0, "last_activity_date": 1530657140, "creation_date": 1530657140, "answer_id": 51163586, "question_id": 51159932, "link": "https://stackoverflow.com/questions/51159932/learning-c-ran-into-issue-with-program-to-count-characters-and-create-a-histogr/51163586#51163586", "title": "Learning C, ran into issue with program to count characters and create a histogram", "body": "<p>That <code>else continue;</code> is only confusing and <code>chartline = '-' * chartlen;</code> is just <code>chartline = 45 * chartlen;</code> is way more confusing. <code>printf(\"%d\\n\", chartline);</code> will just print a number: count of the most frequent number in the input multiplied by 45.<br>\nFind the height of the histogram and save it in <code>chartlen</code>, that's ok. Then for each column for each number print the char for histogram or space.  </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main() {\n    int c;\n    int i;\n    int nwhite;\n    int nother;\n    int chartlen;\n    int ndigit[10];\n\n    nwhite = 0;\n    nother = 0;\n    for (i = 0; i &lt; 10; ++i) {\n        ndigit[i] = 0; \n    }\n\n    while ((c = getchar()) != EOF) {\n        if (c &gt;= '0' &amp;&amp; c &lt;= '9') {\n            ++ndigit[c - '0'];\n        } else if (c == ' ' || c == '\\n' || c == '\\t') {\n            ++nwhite;\n        } else {\n            ++nother;\n        }\n    }\n\n    printf(\"digits =\");\n    for (i = 0; i &lt; 10; ++i) {\n        printf(\" %d\", ndigit[i]);\n    }\n    printf(\", white space = %d, other = %d\\n\", nwhite, nother);\n\n    printf(\"\\n\");\n    printf(\"Histogram horizontally:\\n\");\n    for (i = 0; i &lt; 10; ++i) {\n        int j;\n        printf(\"%2d \", i);\n        for (j = 0; j &lt; ndigit[i]; ++j) {\n            printf(\"*\");\n        }\n        printf(\"\\n\");\n    }\n    printf(\"\\n\");\n    printf(\"Histogram vertically:\\n\");\n    for (chartlen = 0, i = 0; i &lt; 10; ++i) {\n        if (chartlen &lt; ndigit[i])\n            chartlen = ndigit[i];\n    }\n    for (i = 0; i &lt; chartlen; ++i) {\n        int j;\n        printf(\" \");\n        for (j = 0; j &lt; 10; ++j) {\n            if (ndigit[j] &gt;= chartlen - i) {\n                printf(\"*\");\n            } else {\n                printf(\" \");\n            }\n            printf(\" \");\n            /* or shorter: printf(\"%c \", ndigit[j] &gt;= chartlen - i ? '*' : ' '); */\n        }\n        printf(\"\\n\");\n    }\n    printf(\" 0 1 2 3 4 5 6 7 8 9\");\n}\n</code></pre>\n\n<p>This program for the stdin:</p>\n\n<p><code>1234567899876352681543681254169234659237856427895653848467567846545438555463480000000329190328cfasvfhd adk af</code></p>\n\n<p>will print:</p>\n\n<pre><code>digits = 8 5 8 10 12 14 12 6 12 7, white space = 2, other = 1\n\nHistogram horizontally:\n 0 ********\n 1 *****\n 2 ********\n 3 **********\n 4 ************\n 5 **************\n 6 ************\n 7 ******\n 8 ************\n 9 *******\n\nHistogram vertically:\n           *         \n           *         \n         * * *   *   \n         * * *   *   \n       * * * *   *   \n       * * * *   *   \n *   * * * * *   *   \n *   * * * * *   * * \n *   * * * * * * * * \n * * * * * * * * * * \n * * * * * * * * * * \n * * * * * * * * * * \n * * * * * * * * * * \n * * * * * * * * * * \n 0 1 2 3 4 5 6 7 8 9\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 8508575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af079199078d6a524aa3f8511ba95afd?s=128&d=identicon&r=PG&f=1", "display_name": "Tpurdy", "link": "https://stackoverflow.com/users/8508575/tpurdy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 93, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1530657140, "creation_date": 1530638201, "last_edit_date": 1530641640, "question_id": 51159932, "link": "https://stackoverflow.com/questions/51159932/learning-c-ran-into-issue-with-program-to-count-characters-and-create-a-histogr", "title": "Learning C, ran into issue with program to count characters and create a histogram", "body": "<p>I've been starting to go through the process of learning C using the K&amp;R book, and I ran into a exercise that has me attempt to take a character integer/counting program and get it to print out a histogram of the data, however while I was setting up the initial border for the histogram, I ran into a few issues.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main() {\n    int c, i, nwhite, nother, chartlen,\n        chartline;  /* create variables for getchar, index number, whitespace\n                       count, other char count, and establish variables for use\n                       creating histogram*/\n    int ndigit[10]; /* create list */\n    nwhite = nother = 0;\n    chartlen = 10;\n    for (i = 0; i &lt; 10; ++i) /* iterate through each item */\n        ndigit[i] = 0;       /* Set each item to its initial count, 0 */\n\n    while ((c = getchar()) != EOF)\n        if (c &gt;= '0' &amp;&amp; c &lt;= '9')\n            ++ndigit[c - '0']; /* ASCII hex code subtraction to result in\n                                  appropriate decimal interpretation */\n        else if (c == ' ' || c == '\\n' || c == '\\t')\n            ++nwhite; /*checks for white space chars and then adds one to the\n                         count */\n        else\n            ++nother; /* if neither a number or white space is found, add to\n                         other count */\n    printf(\"digits =\");\n    for (i = 0; i &lt; 10; ++i) printf(\" %d\", ndigit[i]);\n    printf(\", white space = %d, other = %d\", nwhite, nother);\n\n    for (i = 0; i &lt; 10; ++i)\n        if (ndigit[i] &gt;\n            chartlen) /*iterated through items from ndigit and check to see if\n                         they're greater than the val of chartlen, if they are,\n                         set chartlen to new value*/\n            chartlen = ndigit[i];\n        else\n            continue;\n    chartline = '-' * chartlen; /*create a line with the length of chartlen and\n                                   then print it*/\n    printf(\"%d\\n\", chartline);\n}\n</code></pre>\n\n<p>The issue I've been running into starts right when I first use <code>chartlen</code>. With the section from</p>\n\n<pre><code>for (i=0; i&lt;10; ++i) \n    if (ndigit[i] &gt; chartlen )\n</code></pre>\n\n<p>and on, if it's commented out, the program runs fine. However, if the new section is left in \"nother\" seems to no longer count properly and prints values that seem arbitrary to me, and for some reason I can't figure out how to get the line for the histogram to print. What did I do wrong?</p>\n"}, {"tags": ["python", "c", "fortran", "gfortran", "f2py"], "comments": [{"owner": {"reputation": 3350, "user_id": 7805917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b243ed32e287056172d2b122c410af9d?s=128&d=identicon&r=PG&f=1", "display_name": "Inder", "link": "https://stackoverflow.com/users/7805917/inder"}, "edited": false, "score": 0, "creation_date": 1530638034, "post_id": 51159849, "comment_id": 89303035, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/4376397/executing-a-c-program-in-python\">Executing a C program in python?</a>"}, {"owner": {"reputation": 695058, "user_id": 20862, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2343ae368d3241278581ce6c87f62a25?s=128&d=identicon&r=PG", "display_name": "Ignacio Vazquez-Abrams", "link": "https://stackoverflow.com/users/20862/ignacio-vazquez-abrams"}, "edited": false, "score": 0, "creation_date": 1530638037, "post_id": 51159849, "comment_id": 89303036, "body": "<a href=\"https://docs.python.org/3/extending/index.html\" rel=\"nofollow noreferrer\">docs.python.org/3/extending/index.html</a>"}, {"owner": {"reputation": 1, "user_id": 9931856, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-jHR0L8KEIhM/AAAAAAAAAAI/AAAAAAAAAAA/IiyO7QLdrMk/photo.jpg?sz=128", "display_name": "jibeiz amec", "link": "https://stackoverflow.com/users/9931856/jibeiz-amec"}, "edited": false, "score": 0, "creation_date": 1530640461, "post_id": 51159849, "comment_id": 89304260, "body": "well, they might both work, but i need to compile it as a library, so i could  call it from other apps, and it seems .pyd is the best choice."}], "owner": {"reputation": 1, "user_id": 9931856, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-jHR0L8KEIhM/AAAAAAAAAAI/AAAAAAAAAAA/IiyO7QLdrMk/photo.jpg?sz=128", "display_name": "jibeiz amec", "link": "https://stackoverflow.com/users/9931856/jibeiz-amec"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 214, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1530637913, "creation_date": 1530637913, "question_id": 51159849, "link": "https://stackoverflow.com/questions/51159849/how-to-compile-c-file-and-f-fortran-file-into-pyd", "title": "How to compile .c file and .f (fortran) file into .pyd", "body": "<p>I have an old c and fortran application i need to convert to a python library that we could use on windows.</p>\n\n<p>i could use gcc and gfortran to compile the .c and .f files to .o files and then compile all of them to a .so file which works as a charm.</p>\n\n<pre><code>gcc -c -fPIC 1.c $PYTHON_INCLUDE\ngfortran -Wall -Wsurprising -W -c -fPIC 2.f 3.f 4.f\ngfortran -shared 1.o 2.o 3.o 4.o -lc -o mylib\n</code></pre>\n\n<p>But i now to need to convert them to a .pyd file.\nI tried to use the f2py from numpy.\nBut <code>f2py -c 1.c 2.f 3.f 4.f -m mylib</code>\ncould not compile them correctly.</p>\n\n<p>There are a lot of \"undeclared\" errors.\nAny recommends? </p>\n"}, {"tags": ["c", "loops", "linked-list"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1530637851, "post_id": 51159806, "comment_id": 89302944, "body": "Are lines like <code>scanf(&quot;%c&quot;,&amp;ch);while(getchar()!=&#39;\\n&#39;);</code> to confuse the enemy?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1530637868, "post_id": 51159806, "comment_id": 89302955, "body": "The <code>Enter</code> key you pressed to end the input for the value <code>2</code> is also put into the input buffer, as a newline <code>&#39;\\n&#39;</code>. This is read by the next <code>scanf</code> call. If you <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">learned how to debug your program</a> it would have been extremely obvious. And now when you know what the problem is, you can more easily search for it and for solutions (which is much more simple than you seem to think)."}, {"owner": {"reputation": 23, "user_id": 9492905, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qq9Vb.jpg?s=128&g=1", "display_name": "S.Sharma", "link": "https://stackoverflow.com/users/9492905/s-sharma"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1530637930, "post_id": 51159806, "comment_id": 89302980, "body": "@Eugene Sh. it basically works like fflush(stdin) id do not prefer fflush(stdin) because it is not preferred as a good technique in some books and may invoke improper actions."}, {"owner": {"reputation": 23, "user_id": 9492905, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qq9Vb.jpg?s=128&g=1", "display_name": "S.Sharma", "link": "https://stackoverflow.com/users/9492905/s-sharma"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1530638027, "post_id": 51159806, "comment_id": 89303029, "body": "@Someprogrammerdude this piece of code starts to work when i use a do-while loop instead of the while loop"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 1, "creation_date": 1530638134, "post_id": 51159806, "comment_id": 89303096, "body": "Please describe the symptoms of &quot;the while loop does not work&quot;, maybe by comparing what happens to what you expect/desire to happen."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1530638153, "post_id": 51159806, "comment_id": 89303106, "body": "@S.Sharma Except that <code>fflush</code> on an input-only stream (like <code>stdin</code>) is explicitly mentioned in the C specification as <i>undefined behavior</i>."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1530638198, "post_id": 51159806, "comment_id": 89303132, "body": "Hint: Try <code>scanf(&quot; %c&quot;, &amp;ch);</code> instead. Note the leading space. Now go and search for <i>why</i> it helps."}, {"owner": {"reputation": 23, "user_id": 9492905, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qq9Vb.jpg?s=128&g=1", "display_name": "S.Sharma", "link": "https://stackoverflow.com/users/9492905/s-sharma"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1530638262, "post_id": 51159806, "comment_id": 89303166, "body": "@Yunnosch well I want the while loop to invoke a **Give Data: ** to the user till the user enters &#39;n&#39; in **Enter more data(y/n): **"}, {"owner": {"reputation": 23, "user_id": 9492905, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qq9Vb.jpg?s=128&g=1", "display_name": "S.Sharma", "link": "https://stackoverflow.com/users/9492905/s-sharma"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1530638452, "post_id": 51159806, "comment_id": 89303277, "body": "@Someprogrammerdude well i now get the problem. Thanks for pointing out the obvious mistake. Because i added a space in the printf(&quot;Enter more data(y/n): &quot;); and the space screws it up i guess. Thanks"}], "answers": [{"tags": [], "owner": {"reputation": 2465, "user_id": 5462988, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9i3ex.jpg?s=128&g=1", "display_name": "anoopknr", "link": "https://stackoverflow.com/users/5462988/anoopknr"}, "is_accepted": true, "score": 0, "last_activity_date": 1530653554, "creation_date": 1530653554, "answer_id": 51163058, "question_id": 51159806, "link": "https://stackoverflow.com/questions/51159806/why-does-the-while-loop-not-work-for-this-link-list-program/51163058#51163058", "title": "Why does the while loop not work for this link-list program?", "body": "<p>You Don't Need to use <code>while(getchar()!='\\n');</code> everywhere before <code>scanf()</code>. This has lead to termination of your program. You could use <code>scanf(\"\\n%c\", &amp;ch);</code> instead.Also it is recommended to write <code>new-&gt;next = NULL;</code> after <code>new = (list)malloc(sizeof(node));</code>.\nAdditionally you miss <code>traverse()</code> function.</p>\n\n<p>Try this modified code :-</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\ntypedef struct node_type\n{\n        int data;\n        struct node_type *next;\n} node;\n\ntypedef node *list;\nlist head;\n\nvoid traverse(node *head) // This is simple traverse function just to demonstrate code.\n{\n        while (head != NULL)\n        {\n                printf(\"%d  \", head-&gt;data);\n                head = head-&gt;next;\n        }\n}\nvoid main()\n{\n        list temp, new;\n        head = NULL;\n        int n;\n        char ch;\n        temp = (list)malloc(sizeof(node));\n        temp-&gt;next = NULL;\n        printf(\"\\nGive data: \");\n        scanf(\"%d\", &amp;temp-&gt;data);\n        head = temp;\n        printf(\"\\n\");\n        printf(\"Enter Data? (y/n): \");\n        scanf(\"\\n%c\", &amp;ch);\n        while (ch == 'y' || ch == 'Y')\n        {\n                new = (list)malloc(sizeof(node));\n                new-&gt;next = NULL;\n                printf(\"Give data: \");\n                scanf(\"%d\", &amp;new-&gt;data);\n                new-&gt;next = NULL;\n                temp-&gt;next = new;\n                temp = new;\n                printf(\"\\nEnter more data(y/n): \");\n                scanf(\"\\n%c\", &amp;ch);\n        }\n        temp-&gt;next = NULL;\n        traverse(head);\n}\n</code></pre>\n\n<p><strong>Output :-</strong></p>\n\n<pre><code>Give data: 2\n\nEnter Data? (y/n): y\nGive data: 22\n\nEnter more data(y/n): y\nGive data: 32\n\nEnter more data(y/n): n\n\n List is :  2  22  32  \n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 9492905, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qq9Vb.jpg?s=128&g=1", "display_name": "S.Sharma", "link": "https://stackoverflow.com/users/9492905/s-sharma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 51163058, "answer_count": 1, "score": -1, "last_activity_date": 1530653554, "creation_date": 1530637715, "question_id": 51159806, "link": "https://stackoverflow.com/questions/51159806/why-does-the-while-loop-not-work-for-this-link-list-program", "title": "Why does the while loop not work for this link-list program?", "body": "<p>Can you please help me to understand why the while loop does not work in the following code:</p>\n\n<pre><code>     #include&lt;stdio.h&gt;\n     #include&lt;stdlib.h&gt;\n     typedef struct node_type{\n                int data;\n                struct node_type *next;\n    }node;\n\n    typedef node *list;\n    list head;\n\n    void main()\n    {\n            list temp,new;\n            head=NULL;\n            int n;\n            char ch;\n            temp=(list) malloc(sizeof(node));\n            printf(\"\\nGive data: \");\n            scanf(\"%d\",&amp;temp-&gt;data);\n            head=temp;\n            printf(\"\\n\");\n            printf(\"Enter Data? (y/n): \");\n            scanf(\"%c\",&amp;ch);while(getchar()!='\\n');\n            while(ch=='y'||ch=='Y')\n            {\n                    new=(list) malloc(sizeof(node));\n                    printf(\"Give data: \");\n                    scanf(\"%d\",&amp;new-&gt;data);while(getchar()!='\\n');\n                    temp-&gt;next=new;\n                    temp=new;\n                    printf(\"\\nEnter more data(y/n): \");\n                    scanf(\"%c\",&amp;ch);while(getchar()!='\\n');\n            }\n            temp-&gt;next=NULL;\n            traverse(head);\n}\n</code></pre>\n\n<p><strong>Output is as follows:</strong>\nGive data: 2</p>\n\n<p>Enter more data(y/n): y</p>\n\n<p>2</p>\n\n<p><strong>and the program terminates here.</strong></p>\n"}, {"tags": ["c", "gcc", "c-preprocessor", "preprocessor-directive"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1530636906, "post_id": 51159476, "comment_id": 89302468, "body": "I have read the question twice. Could not understand what you are asking."}, {"owner": {"reputation": 811, "user_id": 9493582, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bfI3b.jpg?s=128&g=1", "display_name": "Arndt Jonasson", "link": "https://stackoverflow.com/users/9493582/arndt-jonasson"}, "edited": false, "score": 0, "creation_date": 1530637020, "post_id": 51159476, "comment_id": 89302522, "body": "Isn&#39;t (1+10) the final value? What output do you want?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1530637073, "post_id": 51159476, "comment_id": 89302544, "body": "Is something like <code>printf(&quot;&#39;%s&quot; %d\\n&quot;, #CCC, CCC);</code> OK to report the macro name and expansion?"}, {"owner": {"reputation": 695058, "user_id": 20862, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2343ae368d3241278581ce6c87f62a25?s=128&d=identicon&r=PG", "display_name": "Ignacio Vazquez-Abrams", "link": "https://stackoverflow.com/users/20862/ignacio-vazquez-abrams"}, "edited": false, "score": 1, "creation_date": 1530637099, "post_id": 51159476, "comment_id": 89302557, "body": "Macro processing is an all-or-nothing deal."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1530637169, "post_id": 51159476, "comment_id": 89302592, "body": "Code could use <code>_Static_assert()</code> to test the value at compile time to perhaps meet a higher level compliance objective <code>_Static_assert(CCC &gt; 0 &amp;&amp; CCC &lt; 20, &quot;CCC out of expected range&quot;); </code>"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1530637506, "post_id": 51159476, "comment_id": 89302756, "body": "So you want to see an incomplete expansion? It can be done using special tools. Eclipse CDT has a step-by-step expansion tool."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1530637827, "post_id": 51159476, "comment_id": 89302934, "body": "Can somebody name the duplicate? I know that there is one but admit that I can&#39;t pinpoint it."}, {"owner": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "edited": false, "score": 0, "creation_date": 1530638578, "post_id": 51159476, "comment_id": 89303348, "body": "<a href=\"https://stackoverflow.com/questions/28932534/expand-c-c-function-macros-without-preprocessor\" title=\"expand c c function macros without preprocessor\">stackoverflow.com/questions/28932534/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "is_accepted": false, "score": 1, "last_activity_date": 1530638034, "last_edit_date": 1530638034, "creation_date": 1530637148, "answer_id": 51159678, "question_id": 51159476, "link": "https://stackoverflow.com/questions/51159476/determine-the-expansion-of-a-c-macro/51159678#51159678", "title": "Determine the expansion of a C macro", "body": "<pre><code>#include &lt;stdio.h&gt;\n\n#define AAA 1\n#define BBB 2\n#define CCC (AAA+BBB)\n\n#define STRINGIFY(x) #x\n#define PASTE(x) STRINGIFY(x)\n\n\nint main(void)\n{\n  printf(\"CCC = '%s'\\n\", PASTE(CCC));\n}\n</code></pre>\n\n<p>prints</p>\n\n<pre><code>CCC = '(1+10)'\n</code></pre>\n\n<p>An alternative version printing the same:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#define AAA 1\n#define BBB 2\n#define CCC (AAA+BBB)\n\n#define STRINGIFY(x) #x\n#define INTERMEDIATE(x) #x \" = '\" STRINGIFY(x) \"'\"\n\nint main(void)\n{\n  printf(\"%s\\n\", INTERMEDIATE(CCC));\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "is_accepted": true, "score": 2, "last_activity_date": 1530639884, "creation_date": 1530639884, "answer_id": 51160311, "question_id": 51159476, "link": "https://stackoverflow.com/questions/51159476/determine-the-expansion-of-a-c-macro/51160311#51160311", "title": "Determine the expansion of a C macro", "body": "<p>At no point will the preprocessor ever create</p>\n\n<pre><code>#define CCC (1+10)\n</code></pre>\n\n<p>The expansion of <code>CCC</code> is always <code>(AAA+BBB)</code>; it's just that the result of macro expansion is rescanned for more macros to expand, at which point <code>AAA</code> and <code>BBB</code> turn into <code>1</code> and <code>10</code>, respectively.</p>\n\n<p>Perhaps a clearer example of this is</p>\n\n<pre><code>#define AAA 1\n#define CCC AAA\n#define AAA \"hello\"\n\nsize_t x = sizeof CCC;\n</code></pre>\n\n<p>This code will expand to <code>\"hello\"</code>, not <code>1</code>. <code>CCC</code> always has a value of <code>AAA</code>; it's just that by the time <code>size_t x = sizeof CCC;</code> is processed, <code>AAA</code> itself will turn into <code>\"hello\"</code>.</p>\n\n<p>This example also demonstrates that macros can be redefined, so there may not even be a single answer to \"what is the value of <code>CCC</code>?\".</p>\n\n<p>That's why there's no simple compiler invocation or switch; what you want simply doesn't exist.</p>\n\n<p>That said, if you can use custom code, you can just run e.g.</p>\n\n<pre><code>#define AAA 1\n#define BBB 10\n#define CCC (AAA+BBB)\nCCC\n</code></pre>\n\n<p>through <code>gcc -P -E</code> and the result will be just <code>(1+10)</code>.</p>\n"}], "owner": {"reputation": 504, "user_id": 2270574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d23d0070cf83f1fe56fdb33c89807e93?s=128&d=identicon&r=PG", "display_name": "Rob", "link": "https://stackoverflow.com/users/2270574/rob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 836, "favorite_count": 0, "accepted_answer_id": 51160311, "answer_count": 2, "score": 1, "last_activity_date": 1530676666, "creation_date": 1530636286, "last_edit_date": 1530676666, "question_id": 51159476, "link": "https://stackoverflow.com/questions/51159476/determine-the-expansion-of-a-c-macro", "title": "Determine the expansion of a C macro", "body": "<p>Is there a way to determine the \"final value\" of a expanded C macro by inspecting the compiled object or by running some form of gcc -E on the .c or .h file?</p>\n\n<p>test.h</p>\n\n<pre><code>#define AAA 1\n#define BBB 10\n#define CCC (AAA+BBB)\n</code></pre>\n\n<p>test.c</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include \"test.h\"\n\nint main(){\n   printf(\"%d\\n\", CCC);\n   return 0;\n}\n</code></pre>\n\n<p>Thus is there someway to get the expanded value either:</p>\n\n<pre><code>#define CCC 11\n</code></pre>\n\n<p>or</p>\n\n<pre><code>#define CCC (1+10)\n</code></pre>\n\n<p>If compiled with</p>\n\n<pre><code>gcc -dM -E test.c | grep CCC \n</code></pre>\n\n<p>or </p>\n\n<pre><code>gcc -dD -E test.c | grep CCC\n</code></pre>\n\n<p>outputs</p>\n\n<pre><code>#define CCC (AAA+BBB)\n</code></pre>\n\n<p>which requires me to still know what <code>AAA</code> and <code>BBB</code> are.</p>\n\n<p>Compiled with:</p>\n\n<pre><code>gcc -E test.c\n</code></pre>\n\n<p>Gives (skipping the boilerplate):</p>\n\n<pre><code># 4 \"test.c\"\nint main(){\nprintf(\"%d\\n\", (1+10));\nreturn 0;\n}   \n</code></pre>\n\n<p>While its expanded <code>CCC</code> I've now lost the mapping back to <code>CCC</code>. </p>\n\n<p>Edit:\nAs it was unclear, what i'd like is someway to determine what CCC is (either 11 or 1+10 (as the gcc -E example showed it only inserted (1+10) not 11), preferably without altering the code itself. Printf was a bad idea to use in the MRE, what i actually had in mind was code like:</p>\n\n<pre><code>struct my_struct {\n    int my_array[CCC]\n    ... other stuff ...\n}\n</code></pre>\n\n<p>The question is how big is my_array, so i can make a struct in another language (python via ctypes) and know how much space i need. I know for structs i can use pahole but was hoping to do this with only gcc and in the more general case (say a global array not in a struct).</p>\n"}, {"tags": ["c", "casting", "linux-kernel", "kernel-module"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1530632562, "post_id": 51158326, "comment_id": 89300310, "body": "@chux I&#39;d be surprised to see an UB-free rootkit... (as for the question: Seriously, start learning C, by following a book, and coding your own simple programs, step by step. You will eventually reach a point that enables you to read such code as well)"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1530632665, "post_id": 51158326, "comment_id": 89300371, "body": "First consult the <a href=\"https://en.cppreference.com/w/c/language/operator_precedence\" rel=\"nofollow noreferrer\">operator precedence table</a> and understand the order the operations are taking place here."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1530636373, "post_id": 51158326, "comment_id": 89302218, "body": "The follow up question would be why this <code>*(void **)&amp;</code>?"}, {"owner": {"reputation": 11, "user_id": 10027659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d082ce25b5baf518470d7286e1d2f99?s=128&d=identicon&r=PG&f=1", "display_name": "Juan", "link": "https://stackoverflow.com/users/10027659/juan"}, "edited": false, "score": 0, "creation_date": 1530639426, "post_id": 51158326, "comment_id": 89303745, "body": "@FelixPalmen I learn C in University, and recently i worked with OpenMPI  for another matter, and i also made an small change in the kernel to add a systemcall for operating system matter, but anyway, lines of code like this are hard to understand for my, and it seems to me that this is the time to learn how to read comprex lines like this, by justly analyzing pieces of codes like this. Now that I went back to review the operator tables precedence, the lines begins to be clearer and i can still reading the rest of rootkit code."}, {"owner": {"reputation": 11, "user_id": 10027659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d082ce25b5baf518470d7286e1d2f99?s=128&d=identicon&r=PG&f=1", "display_name": "Juan", "link": "https://stackoverflow.com/users/10027659/juan"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1530639567, "post_id": 51158326, "comment_id": 89303825, "body": "@EugeneSh. Thanks for make me remember to query the operator precedence table! That helped me to better understand the code line"}, {"owner": {"reputation": 11, "user_id": 10027659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d082ce25b5baf518470d7286e1d2f99?s=128&d=identicon&r=PG&f=1", "display_name": "Juan", "link": "https://stackoverflow.com/users/10027659/juan"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1530639704, "post_id": 51158326, "comment_id": 89303895, "body": "@chux Sorry, alk added it!"}], "answers": [{"comments": [{"owner": {"reputation": 2531, "user_id": 6084317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4295c9b1ada748080d7a123f7263ae69?s=128&d=identicon&r=PG&f=1", "display_name": "Edward Minnix", "link": "https://stackoverflow.com/users/6084317/edward-minnix"}, "edited": false, "score": 0, "creation_date": 1530632996, "post_id": 51158540, "comment_id": 89300549, "body": "This approach is referred to as <a href=\"http://c-faq.com/decl/spiral.anderson.html\" rel=\"nofollow noreferrer\">the Spiral Rule</a>"}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "reply_to_user": {"reputation": 2531, "user_id": 6084317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4295c9b1ada748080d7a123f7263ae69?s=128&d=identicon&r=PG&f=1", "display_name": "Edward Minnix", "link": "https://stackoverflow.com/users/6084317/edward-minnix"}, "edited": false, "score": 0, "creation_date": 1530633073, "post_id": 51158540, "comment_id": 89300586, "body": "@EdwardMinnix, thanks, didn&#39;t know it had that name."}], "tags": [], "owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "is_accepted": false, "score": 1, "last_activity_date": 1530632720, "creation_date": 1530632720, "answer_id": 51158540, "question_id": 51158326, "link": "https://stackoverflow.com/questions/51158326/complex-casting/51158540#51158540", "title": "Complex casting", "body": "<p>If I am not mistaken: you start at the innermost part, which is </p>\n\n<pre><code>h-&gt;original_function\n</code></pre>\n\n<p>Then we see a brace at the right so now we scan left for the matching brace. But wait a second, we see a cast to <code>(char *)</code> so it is a pointer to a char and now the brace closes.</p>\n\n<p>On the right we now see an array indexing to take element <code>[ASM_HOOK_CODE_OFFSET]</code> and on the left we now see <code>&amp;</code> to take its address. So we now have the address of a char.</p>\n\n<p>Now we can only go the the left and see <code>*(void **)</code>, which casts this address to be a pointer-to-a-pointer-to-void and then dereference it and assign the right part to the address.</p>\n"}], "owner": {"reputation": 11, "user_id": 10027659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d082ce25b5baf518470d7286e1d2f99?s=128&d=identicon&r=PG&f=1", "display_name": "Juan", "link": "https://stackoverflow.com/users/10027659/juan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1530635960, "creation_date": 1530631977, "last_edit_date": 1530635960, "question_id": 51158326, "link": "https://stackoverflow.com/questions/51158326/complex-casting", "title": "Complex casting", "body": "<p>After learn C and theorical stuffs of operatives systems, i decided to analyze one kernel rootkit for linux, but i can't understand one line of code, i don't know how to read that line:</p>\n\n<pre><code>*(void **)&amp;((char *)h-&gt;original_function)[ASM_HOOK_CODE_OFFSET] = h-&gt;modified_function;\n</code></pre>\n\n<p>Full context:</p>\n\n<pre><code>#if defined __i386__\n    // push 0x00000000, ret\n    #define ASM_HOOK_CODE \"\\x68\\x00\\x00\\x00\\x00\\xc3\"\n    #define ASM_HOOK_CODE_OFFSET 1\n    // alternativly we could do `mov eax 0x00000000, jmp eax`, but it's a byte longer\n    //#define ASM_HOOK_CODE \"\\xb8\\x00\\x00\\x00\\x00\\xff\\xe0\"\n#elif defined __x86_64__\n    // there is no push that pushes a 64-bit immidiate in x86_64,\n    // so we do things a bit differently:\n    // mov rax 0x0000000000000000, jmp rax\n    #define ASM_HOOK_CODE \"\\x48\\xb8\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\xff\\xe0\"\n    #define ASM_HOOK_CODE_OFFSET 2\n#else\n    #error ARCH_ERROR_MESSAGE\n#endif\n\nstruct asm_hook {\n    void *original_function;\n    void *modified_function;\n    char original_asm[sizeof(ASM_HOOK_CODE)-1];\n    struct list_head list;\n};\n\n\n/**\n * Patches machine code of the original function to call another function.\n * This function should not be called directly.\n */\nvoid _asm_hook_patch(struct asm_hook *h)\n{\n    DISABLE_W_PROTECTED_MEMORY\n    memcpy(h-&gt;original_function, ASM_HOOK_CODE, sizeof(ASM_HOOK_CODE)-1);\n    *(void **)&amp;((char *)h-&gt;original_function)[ASM_HOOK_CODE_OFFSET] = h-&gt;modified_function;\n    ENABLE_W_PROTECTED_MEMORY\n}\n</code></pre>\n\n<p>Rootkit link:\n<a href=\"https://github.com/nurupo/rootkit/blob/master/rootkit.c\" rel=\"nofollow noreferrer\">https://github.com/nurupo/rootkit/blob/master/rootkit.c</a>\n(line 314 of rootkit.c)</p>\n\n<p>I don't want to be explained how the rootkit, only want to understand how to read that line of code, the first part of the line makes me dizzy.</p>\n"}, {"tags": ["c", "linked-list", "segmentation-fault"], "comments": [{"owner": {"reputation": 503, "user_id": 8830528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78bc39faaf914ac3f42353f2e37f0311?s=128&d=identicon&r=PG&f=1", "display_name": "rbf", "link": "https://stackoverflow.com/users/8830528/rbf"}, "edited": false, "score": 1, "creation_date": 1530630127, "post_id": 51157642, "comment_id": 89298796, "body": "Time to learn how to debug your program <a href=\"https://stackoverflow.com/questions/25385173/what-is-a-debugger-and-how-can-it-help-me-diagnose-problems\" title=\"what is a debugger and how can it help me diagnose problems\">stackoverflow.com/questions/25385173/&hellip;</a>"}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1530630843, "post_id": 51157642, "comment_id": 89299275, "body": "what does your <code>struct list</code> look like anyway?"}, {"owner": {"reputation": 13, "user_id": 10027426, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-4qCTCriv9j0/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq3DVcYHrMbi4Wnac3nwDdsLdXeJkg/mo/photo.jpg?sz=128", "display_name": "Emanuele", "link": "https://stackoverflow.com/users/10027426/emanuele"}, "edited": false, "score": 0, "creation_date": 1530630937, "post_id": 51157642, "comment_id": 89299339, "body": "I&#39;ve already debugged the program, otherwise I couldn&#39;t have known that it crashes at the while. Anyway thanks for the solution."}, {"owner": {"reputation": 13, "user_id": 10027426, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-4qCTCriv9j0/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq3DVcYHrMbi4Wnac3nwDdsLdXeJkg/mo/photo.jpg?sz=128", "display_name": "Emanuele", "link": "https://stackoverflow.com/users/10027426/emanuele"}, "edited": false, "score": 0, "creation_date": 1530631024, "post_id": 51157642, "comment_id": 89299384, "body": "And yes, I want to destroy it ;)"}], "answers": [{"tags": [], "owner": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "is_accepted": true, "score": 1, "last_activity_date": 1530630738, "creation_date": 1530630738, "answer_id": 51157900, "question_id": 51157642, "link": "https://stackoverflow.com/questions/51157642/c-segmentation-fault-in-linked-list/51157900#51157900", "title": "C, Segmentation Fault in linked list", "body": "<p><code>ptr=&amp;(*ptr)-&gt;next;</code> saves a pointer to the member <code>next</code> of an object, which is freed in the next line. Trying to dereference <code>ptr</code> in the next iteration will lead to undefined behaviour.</p>\n\n<p><code>*ptr = (*ptr)-&gt;next;</code> should be correct. This will advance the list to the next item, while the previous one will be freed in the next line.</p>\n"}], "owner": {"reputation": 13, "user_id": 10027426, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-4qCTCriv9j0/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq3DVcYHrMbi4Wnac3nwDdsLdXeJkg/mo/photo.jpg?sz=128", "display_name": "Emanuele", "link": "https://stackoverflow.com/users/10027426/emanuele"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 51157900, "answer_count": 1, "score": 1, "last_activity_date": 1530630738, "creation_date": 1530629853, "last_edit_date": 1530629949, "question_id": 51157642, "link": "https://stackoverflow.com/questions/51157642/c-segmentation-fault-in-linked-list", "title": "C, Segmentation Fault in linked list", "body": "<p>I have a problem with the function below, when <code>(*ptr)</code> is NULL instead of ending the while loop the function crashes. I've tried to use <code>if((*ptr)-&gt;next==NULL) break;</code> but it fails anyway. </p>\n\n<pre><code>boolean search_times(struct list ** ptr, float *V, int n, struct list_times ** new ){\n\n    struct list * tmp_ptr=NULL;\n\n    if( V!=NULL &amp;&amp; n&gt;=0 ) {\n        while((*ptr)!=NULL) {\n\n            int times=0;\n\n            for (int i = 0; i &lt; n; i++) {\n                if (isequal((*ptr)-&gt;value, V[i]))\n                    times++;\n            }\n\n            if((suf_insert_times(new, (*ptr)-&gt;value, times))==FALSE)\n                return FALSE;\n\n            tmp_ptr=*ptr;\n            ptr=&amp;(*ptr)-&gt;next;\n            free(tmp_ptr);\n        }\n        return TRUE;\n    }\n    else\n        return FALSE;\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 705, "user_id": 8359764, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZZGPy.jpg?s=128&g=1", "display_name": "hat", "link": "https://stackoverflow.com/users/8359764/hat"}, "edited": false, "score": 0, "creation_date": 1530629905, "post_id": 51157609, "comment_id": 89298635, "body": "See <a href=\"https://stackoverflow.com/questions/5431941/why-is-while-feof-file-always-wrong?s=1|227.2797\" title=\"why is while feof file always wrong\">stackoverflow.com/questions/5431941/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 317, "user_id": 9965330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98aa2785e28665f32e5e04a0c8a274c4?s=128&d=identicon&r=PG&f=1", "display_name": "Thuan Nguyen", "link": "https://stackoverflow.com/users/9965330/thuan-nguyen"}, "edited": false, "score": 0, "creation_date": 1530630049, "post_id": 51157664, "comment_id": 89298737, "body": "I have tried this but it doesn&#39;t work. It didn&#39;t go into an infinite loop but i didn&#39;t print out anything"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 317, "user_id": 9965330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98aa2785e28665f32e5e04a0c8a274c4?s=128&d=identicon&r=PG&f=1", "display_name": "Thuan Nguyen", "link": "https://stackoverflow.com/users/9965330/thuan-nguyen"}, "edited": false, "score": 1, "creation_date": 1530630338, "post_id": 51157664, "comment_id": 89298946, "body": "@ThuanNguyen that would be a different question, but is close to impossible. Only &quot;close to&quot; because you might start this from an IDE and just not see the output, or your text file could be empty. Note the solution in this answer will add extra newlines."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 317, "user_id": 9965330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98aa2785e28665f32e5e04a0c8a274c4?s=128&d=identicon&r=PG&f=1", "display_name": "Thuan Nguyen", "link": "https://stackoverflow.com/users/9965330/thuan-nguyen"}, "edited": false, "score": 1, "creation_date": 1530630465, "post_id": 51157664, "comment_id": 89299035, "body": "@ThuanNguyen probably the file could not be opened, I edited my answer, try now."}, {"owner": {"reputation": 317, "user_id": 9965330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98aa2785e28665f32e5e04a0c8a274c4?s=128&d=identicon&r=PG&f=1", "display_name": "Thuan Nguyen", "link": "https://stackoverflow.com/users/9965330/thuan-nguyen"}, "edited": false, "score": 0, "creation_date": 1530630559, "post_id": 51157664, "comment_id": 89299087, "body": "The file can&#39;t be opened. Thank  you very much. I understand it now"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1530630577, "post_id": 51157664, "comment_id": 89299104, "body": "@FelixPalmen it&#39;s probably not a dupe of <a href=\"https://stackoverflow.com/questions/5431941/why-is-while-feof-file-always-wrong\">this</a> but a dupe of the question: &quot;File X exists but fopen cannot open it&quot; or something like this."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 317, "user_id": 9965330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98aa2785e28665f32e5e04a0c8a274c4?s=128&d=identicon&r=PG&f=1", "display_name": "Thuan Nguyen", "link": "https://stackoverflow.com/users/9965330/thuan-nguyen"}, "edited": false, "score": 0, "creation_date": 1530630678, "post_id": 51157664, "comment_id": 89299164, "body": "@ThuanNguyen but <a href=\"https://stackoverflow.com/questions/5431941/why-is-while-feof-file-always-wrong\">Why is \u201cwhile ( !feof (file) )\u201d always wrong?</a> still stands"}, {"owner": {"reputation": 317, "user_id": 9965330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98aa2785e28665f32e5e04a0c8a274c4?s=128&d=identicon&r=PG&f=1", "display_name": "Thuan Nguyen", "link": "https://stackoverflow.com/users/9965330/thuan-nguyen"}, "edited": false, "score": 0, "creation_date": 1530630765, "post_id": 51157664, "comment_id": 89299215, "body": "@Jabberwocky what do you mean? I am new to stackoverflow, did i do something wrong? I know that this is a duplicate question, what can i do to solve this?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1530630801, "post_id": 51157664, "comment_id": 89299243, "body": "@Jabberwocky indeed, &quot;infinite loop&quot; with the code shown indicates a different problem ... is there a dupe for &quot;why does this code without any error checking not work?&quot; ;)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 317, "user_id": 9965330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98aa2785e28665f32e5e04a0c8a274c4?s=128&d=identicon&r=PG&f=1", "display_name": "Thuan Nguyen", "link": "https://stackoverflow.com/users/9965330/thuan-nguyen"}, "edited": false, "score": 1, "creation_date": 1530630870, "post_id": 51157664, "comment_id": 89299294, "body": "@ThuanNguyen it&#39;s all fine, the dupe just doesn&#39;t explain what you experience, but still applies to the question. Your code is broken because of the wrong use of <code>feof()</code> <b>and</b> because of not checking for <b>any</b> errors."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 317, "user_id": 9965330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98aa2785e28665f32e5e04a0c8a274c4?s=128&d=identicon&r=PG&f=1", "display_name": "Thuan Nguyen", "link": "https://stackoverflow.com/users/9965330/thuan-nguyen"}, "edited": false, "score": 1, "creation_date": 1530630883, "post_id": 51157664, "comment_id": 89299307, "body": "@ThuanNguyen no you did nothing wrong while asking your question. And it&#39;s not really a duplicate of the question mentioned. What I mean is that checking for end of file as you did it is wrong."}], "tags": [], "owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "is_accepted": true, "score": 3, "last_activity_date": 1530631028, "last_edit_date": 1530631028, "creation_date": 1530629903, "answer_id": 51157664, "question_id": 51157609, "link": "https://stackoverflow.com/questions/51157609/c-infinite-loop-when-reading-a-file/51157664#51157664", "title": "C - Infinite loop when reading a file", "body": "<p>You need this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n  FILE *p = fopen(\"data.txt11\", \"r\");\n  if (p == NULL)\n  {\n    printf(\"File could not be opened.\\n\");\n    return 1;\n  }\n\n  char ar[150];\n\n  while (fgets(ar, 150, p) != NULL)\n  {\n    puts(ar);\n  }\n\n  fclose(p);\n  return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11619, "user_id": 5346306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BsACH.jpg?s=128&g=1", "display_name": "Achal", "link": "https://stackoverflow.com/users/5346306/achal"}, "is_accepted": false, "score": 2, "last_activity_date": 1530632635, "last_edit_date": 1530632635, "creation_date": 1530630019, "answer_id": 51157694, "question_id": 51157609, "link": "https://stackoverflow.com/questions/51157609/c-infinite-loop-when-reading-a-file/51157694#51157694", "title": "C - Infinite loop when reading a file", "body": "<p>Don't use <code>feof()</code>, see <a href=\"https://stackoverflow.com/questions/5431941/why-is-while-feof-file-always-wrong\">Why is \u201cwhile ( !feof (file) )\u201d always wrong?</a> .</p>\n\n<p>Check the return value of <code>fopen()</code> whether <code>fopen()</code> was success or failed, if <code>fopen()</code> returns <code>NULL</code> then don't proceed further or don't do any operation with <code>p</code>. for e.g</p>\n\n<pre><code>FILE *p = fopen(\"data.txt11\", \"r\");\nif (p == NULL) {\n    fprintf(stderr,\"file doesn't exist\\n\");\n    return 0;\n}\n</code></pre>\n\n<p>And check the return value of <code>fgets()</code>. From the manual page of <code>fgets()</code></p>\n\n<blockquote>\n  <p><strong>RETURN VALUE</strong>\n         <code>fgets()</code> return <code>s</code> on success, and <code>NULL</code> on error or when end\n         of file occurs while no characters have been read.</p>\n</blockquote>\n\n<p>for e.g</p>\n\n<pre><code>char *ptr = NULL;\nwhile( (ptr = fgets(ar,sizeof(ar), p)) != NULL) {  \n   printf(\"%s\",ptr);\n   /* fgets() copies \\n t the end of buffer, if you don't want remove it by some logic */ \n}\n</code></pre>\n\n<p>About what <code>fgets()</code> will read, from the manual page</p>\n\n<blockquote>\n  <p><code>fgets()</code> reads in at most <code>one less than size</code> characters from stream\n  and\n         stores  them  into  the <code>buffer</code> pointed to by s.  Reading stops after an\n         <code>EOF</code> or a <code>newline</code>.  If a newline is read, it is <code>stored</code> into the  buffer.</p>\n</blockquote>\n"}], "owner": {"reputation": 317, "user_id": 9965330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98aa2785e28665f32e5e04a0c8a274c4?s=128&d=identicon&r=PG&f=1", "display_name": "Thuan Nguyen", "link": "https://stackoverflow.com/users/9965330/thuan-nguyen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1085, "favorite_count": 0, "closed_date": 1530629916, "accepted_answer_id": 51157664, "answer_count": 2, "score": 0, "last_activity_date": 1530632635, "creation_date": 1530629744, "question_id": 51157609, "link": "https://stackoverflow.com/questions/51157609/c-infinite-loop-when-reading-a-file", "closed_reason": "Duplicate", "title": "C - Infinite loop when reading a file", "body": "<p>I know this is an easy problem but i can't figure out how to solve this. I was learning about file and when i tried to read a file, it went on in an infinite loop. Here is my code:</p>\n\n<pre><code>int main()\n{\n\n    FILE *p;\n\n    p = fopen(\"123.txt\", \"r\");\n\n    char ar[150];   \n\n    while(!feof(p))\n    { \n        fgets(ar, 150, p); \n        puts(ar);\n    }\n\n    fclose(p);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "daemon", "popen", "pclose"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 1, "creation_date": 1530633565, "post_id": 51157476, "comment_id": 89300866, "body": "I don&#39;t get why you use <code>popen()</code> at all, if you don&#39;t actually read from the pipe, and why you call a script instead of launching your &quot;daemon&quot; directly (which would be very simple if you make it a real daemon detaching itself and starting a new session) -- but anyways, try checking <code>errno</code> and use the <a href=\"https://linux.die.net/man/2/waitpid\" rel=\"nofollow noreferrer\"><code>WIFEXITED</code>, <code>WEXITSTATUS</code> etc. macros</a> to get more information about how the child exited."}, {"owner": {"reputation": 773, "user_id": 7991581, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/f0ffccced69419766694f1774f275a3a?s=128&d=identicon&r=PG&f=1", "display_name": "Arkaik", "link": "https://stackoverflow.com/users/7991581/arkaik"}, "edited": false, "score": 0, "creation_date": 1530634896, "post_id": 51157476, "comment_id": 89301510, "body": "I&#39;m doing so because I shall not modify the daemon&#39;s code. I can&#39;t get it&#39;s pid without using <code>start-stop-daemon</code> except by reimplementing <code>fork</code> + <code>exec</code> to have its pid returned. Moreover it allows me to manage the daemon from command line if the controlling app is stopped (which may happen, in that case the daemon shall still run). And it&#39;s more complient with what is already present on the BSP"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1530636206, "post_id": 51157476, "comment_id": 89302145, "body": "You don&#39;t need to &quot;reimplement&quot; fork/exec, just <b>use</b> them. What you do instead looks like a Rube Goldberg machine. A <b>real</b> daemon would detach itself and write the pid file, btw."}, {"owner": {"reputation": 773, "user_id": 7991581, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/f0ffccced69419766694f1774f275a3a?s=128&d=identicon&r=PG&f=1", "display_name": "Arkaik", "link": "https://stackoverflow.com/users/7991581/arkaik"}, "edited": false, "score": 0, "creation_date": 1530636449, "post_id": 51157476, "comment_id": 89302260, "body": "I meant reimplementing popen with <code>fork</code> + <code>exec</code>"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1530636872, "post_id": 51157476, "comment_id": 89302452, "body": "Are the commented out blocks of code ones which you make active when you use <code>pclose()</code>?  Why don&#39;t you have the code able to choose at runtime whether to execute the <code>pclose()</code>?  Then we wouldn&#39;t have to guess \u2014 you&#39;d say &quot;when I run the command with no arguments, <code>pclose()</code> is not executed, and the output is this; when I run it with any arguments, <code>pclose()</code> <i>is</i> executed, and the output is this&quot;.  And you&#39;d be able to test both variants without having to recompile."}, {"owner": {"reputation": 773, "user_id": 7991581, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/f0ffccced69419766694f1774f275a3a?s=128&d=identicon&r=PG&f=1", "display_name": "Arkaik", "link": "https://stackoverflow.com/users/7991581/arkaik"}, "edited": false, "score": 0, "creation_date": 1530636914, "post_id": 51157476, "comment_id": 89302471, "body": "And alright a &quot;real&quot; daemon would detach itself, but as I said I shall not modify the daemon&#39;s code (which is not the one in my example). Moreover, it&#39;s more simple (at least from my point of view) to centralize daemons management using a service management system (i.e. systemV)"}, {"owner": {"reputation": 773, "user_id": 7991581, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/f0ffccced69419766694f1774f275a3a?s=128&d=identicon&r=PG&f=1", "display_name": "Arkaik", "link": "https://stackoverflow.com/users/7991581/arkaik"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1530637313, "post_id": 51157476, "comment_id": 89302659, "body": "@JonathanLeffler I could have done that you&#39;re right, however I though that specifying &quot;Here are the logs with and without the pclose block commented&quot; would be sufficient for my issue to be understood."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1530637413, "post_id": 51157476, "comment_id": 89302707, "body": "Comments in code on SO are usually ignored \u2014 they&#39;re mainly irrelevant when trying to understand the operation of code, and when dealing with people&#39;s problems, the first thing I do is strip out the comments.  Now I&#39;ve got to hack at your code so it can be run both ways.  It would have been better to use <code>#ifdef CALL_PCLOSE</code> / <code>#endif</code> around the code, so it can be compiled both ways without needing to be edited.  It all comes under the heading of making it easy for people to help you."}], "answers": [{"comments": [{"owner": {"reputation": 773, "user_id": 7991581, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/f0ffccced69419766694f1774f275a3a?s=128&d=identicon&r=PG&f=1", "display_name": "Arkaik", "link": "https://stackoverflow.com/users/7991581/arkaik"}, "edited": false, "score": 0, "creation_date": 1530710517, "post_id": 51159901, "comment_id": 89332206, "body": "Thanks for those informations, I have been able to find more documentation about <code>popen</code> and <code>SIGPIPE</code>. So I think you&#39;re right and <code>popen</code> doesn&#39;t seem to be the good solution, I&#39;ll just make a try with <code>fork</code> and <code>exec</code>"}, {"owner": {"reputation": 773, "user_id": 7991581, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/f0ffccced69419766694f1774f275a3a?s=128&d=identicon&r=PG&f=1", "display_name": "Arkaik", "link": "https://stackoverflow.com/users/7991581/arkaik"}, "edited": false, "score": 0, "creation_date": 1530780789, "post_id": 51159901, "comment_id": 89355890, "body": "I have finally reimplemented it using <code>fork</code>, <code>execl</code> and <code>waitpid</code> and it works like a charm. The problem was indeed coming from the pipe beeing unread. Thx"}], "tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": true, "score": 1, "last_activity_date": 1530638525, "last_edit_date": 1530638525, "creation_date": 1530638106, "answer_id": 51159901, "question_id": 51157476, "link": "https://stackoverflow.com/questions/51157476/pclose-seems-to-make-process-fail/51159901#51159901", "title": "Pclose seems to make process fail", "body": "<p>You use <code>popen(DAEMON_START_CMD, \"r\")</code>.  That means your 'daemon watcher' is reading the standard output of your 'daemon starter' script.  If you <code>pclose()</code> that pipe, the script writes to standard output and gets a SIGPIPE because the read end of the pipe is closed.  Whether that happens before the actual daemon is started or not is open to debate \u2014 and timing issues.</p>\n\n<p>Don't <code>pclose()</code> the pipe until you know the daemon starter has exited, by some means or other.  Personally, I'd use <code>pipe()</code>, <code>fork()</code> and <code>execv()</code> (or some other variant of the <code>exec</code> family of functions directly.  I don't think <code>popen()</code> is the right tool for the job. But if you're going to use <code>popen()</code>, then read the input until you get no more (EOF), then use <code>pclose()</code> safely.  You don't have to print what you read, though it would be conventional and sensible to do so \u2014 the 'daemon starter' script is telling you useful information.</p>\n\n<p>The classic way to check whether a process ID is still running is to use <code>kill(daemon_pid, 0)</code>.  If the process executing that is appropriately privileged (same UID as the process, or <code>root</code> privileges), this works.  It won't help if you can't send an active signal to the PID.</p>\n\n<p>(I assume <code>start-stop-daemon</code> is a program, probably a C program rather than a shell script, that launches another program as a daemon.  I have a similar program that I call <code>daemonize</code> \u2014 and it too is intended for convert programs not specifically designed as daemons into a program running as a daemon.  Many programs don't work well as daemons \u2014 consider what daemonizing <code>ls</code>, <code>grep</code>, <code>ps</code>, or <code>sort</code> would mean.  Other programs can more sensibly be run as daemons.)</p>\n"}], "owner": {"reputation": 773, "user_id": 7991581, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/f0ffccced69419766694f1774f275a3a?s=128&d=identicon&r=PG&f=1", "display_name": "Arkaik", "link": "https://stackoverflow.com/users/7991581/arkaik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 717, "favorite_count": 0, "accepted_answer_id": 51159901, "answer_count": 1, "score": 0, "last_activity_date": 1530709494, "creation_date": 1530629358, "last_edit_date": 1530709494, "question_id": 51157476, "link": "https://stackoverflow.com/questions/51157476/pclose-seems-to-make-process-fail", "title": "Pclose seems to make process fail", "body": "<p>This question is a follow up of this question : <a href=\"https://stackoverflow.com/questions/51024183/controlling-a-c-daemon-from-another-program\">Controlling a C daemon from another program</a></p>\n\n<p>My goal is to control daemon process execution from another program.<br/> The daemon's code is really simple.</p>\n\n<pre><code>int main()\n{\n  printf(\"Daemon starting ...\\n\");\n  openlog(\"daemon-test\", LOG_PID, LOG_DAEMON);\n\n  syslog(LOG_INFO, \"Daemon started !\\n\");\n\n  while(1)\n  {\n    syslog(LOG_INFO, \"Daemon alive - pid=%d, pgid=%d\\n\", getpid(), getpgrp());\n    sleep(1);\n  }\n\n  return EXIT_SUCCESS;\n}\n</code></pre>\n\n<p>I have implemented a SystemV init script for this daemon as follow</p>\n\n<pre><code>#!/bin/sh\n\nNAME=daemon-test\nDAEMON=/usr/bin/${NAME}\nSCRIPTNAME=/etc/init.d/${NAME}\nUSER=root\nRUN_LEVEL=99\nPID_FILE=/var/run/${NAME}.pid\nRETRY=3\n\nstart_daemon()\n{\n    start-stop-daemon --start --background --name ${NAME} --chuid ${USER} --nicelevel ${RUN_LEVEL} --make-pidfile --pidfile ${PID_FILE} --exec ${DAEMON}\n    ret=$?\n\n    if [ \"$ret\" -eq 0 ]; then\n        echo \"'${NAME}' started\"\n    elif [ \"$ret\" -eq 1 ]; then\n        echo \"'${NAME}' is already running\"\n    else\n        echo \"An error occured starting '${NAME}'\"\n    fi\n    return ${ret}\n}\n\nstop_daemon()\n{\n    start-stop-daemon --stop --retry ${RETRY} --remove-pidfile --pidfile ${PID_FILE} --name ${NAME} --signal 9\n    ret=$?\n\n    if [ \"$ret\" -eq 0 ]; then\n        echo \"'${NAME}' stopped\"\n    elif [ \"$ret\" -eq 1 ]; then\n        echo \"'${NAME}' is already stopped\"\n    elif [ \"$ret\" -eq 2 ]; then\n        echo \"'${NAME}' not stopped after ${RETRY} tries\"\n    else\n        echo \"An error occured stopping '${NAME}'\"\n    fi\n    return ${ret}\n}\n\nstatus_daemon()\n{\n    start-stop-daemon --status --pidfile ${PID_FILE} --name ${NAME}\n    ret=$?\n\n    if [ \"$ret\" -eq 0 ]; then\n        echo \"'${NAME}' is running\"\n    elif [ \"$ret\" -eq 1 ]; then\n        echo \"'${NAME}' stopped but pid file exits\"\n    elif [ \"$ret\" -eq 3 ]; then\n        echo \"'${NAME}' stopped\"\n    elif [ \"$ret\" -eq 4 ]; then\n        echo \"Unable to get '${NAME}' status\"\n    else\n        echo \"Unknown status : ${ret}\"\n    fi\n    return ${ret}\n}\n\ncase \"$1\" in\n  start)\n    echo \"Starting '${NAME}' deamon :\"\n    start_daemon\n    ;;\n  stop)\n    echo \"Stopping '${NAME}' deamon :\"\n    stop_daemon\n    ;;\n  status)\n    echo \"Getting '${NAME}' deamon status :\"\n    status_daemon\n    ;;\n  restart|reload)\n    \"$0\" stop\n    \"$0\" start\n    ;;\n  *)\n    echo \"Usage: $0 {start|stop|status|restart}\"\n    exit 1\nesac\n\nexit $?\n</code></pre>\n\n<p>Using this script from command line to control the daemon execution works well. <br/></p>\n\n<hr>\n\n<p>So the aim now is to use this script from another c program to launch the daemon and to control its execution from this program.</p>\n\n<p>I have implemented a simple C program which:</p>\n\n<ol>\n<li>Launch the script with 'start' argument</li>\n<li>Wait for pid file creation</li>\n<li>Read daemon's pid from pid file</li>\n<li>Periodically check that daemon is alive by checking existence of file <code>/proc/&lt;daemon_pid&gt;/exec</code></li>\n<li>If daemon is killed, relaunch it</li>\n</ol>\n\n<p>And here is the issue I'm facing. The program works well only if I don't call <code>pclose</code>.</p>\n\n<p>Here is the code of the program</p>\n\n<pre><code>#define DAEMON_NAME       \"daemon-test\"\n#define DAEMON_START_CMD  \"/etc/init.d/\" DAEMON_NAME \" start\"\n#define DAEMON_STOP_CMD   \"/etc/init.d/\" DAEMON_NAME \" stop\"\n#define DAEMON_PID_FILE   \"/var/run/\" DAEMON_NAME \".pid\"\n\nint main()\n{\n    char daemon_proc_path[256];\n    FILE* daemon_pipe = NULL;\n    int daemon_pid = 0;\n    FILE* fp = NULL;\n    int ret = 0;\n    int i = 0;\n\n    printf(\"Launching '%s' program\\n\", DAEMON_NAME);\n    if(NULL == (daemon_pipe = popen(DAEMON_START_CMD, \"r\")))\n    {\n        printf(\"An error occured launching '%s': %m\\n\", DAEMON_START_CMD);\n        return EXIT_FAILURE;\n    }\n    #ifdef USE_PCLOSE\n    else if(-1 == (ret = pclose(daemon_pipe)))\n    {\n        printf(\"An error occured waiting for '%s': %m\\n\", DAEMON_START_CMD);\n        return EXIT_FAILURE;\n    }\n    #endif\n    else\n    {\n        printf(\"Script exit status : %d\\n\", ret);\n\n        while(0 != access(DAEMON_PID_FILE, F_OK))\n        {\n            printf(\"Waiting for pid file creation\\n\");\n            sleep(1);\n        }\n        if(NULL == (fp = fopen(DAEMON_PID_FILE, \"r\")))\n        {\n            printf(\"Unable to open '%s'\\n\", DAEMON_PID_FILE);\n            return EXIT_FAILURE;\n        }\n        fscanf(fp, \"%d\", &amp;daemon_pid);\n        fclose(fp);\n        printf(\"Daemon has pid=%d\\n\", daemon_pid);\n        sprintf(daemon_proc_path, \"/proc/%d/exe\", daemon_pid);\n    }\n\n    while(1)\n    {\n        if(0 != access(daemon_proc_path, F_OK))\n        {\n            printf(\"\\n--- Daemon (pid=%d) has been killed ---\\n\", daemon_pid);\n            printf(\"Relaunching new daemon instance...\\n\");\n            if(NULL == (daemon_pipe = popen(DAEMON_START_CMD, \"r\")))\n            {\n                printf(\"An error occured launching '%s': %m\\n\", DAEMON_START_CMD);\n                return EXIT_FAILURE;\n            }\n            #ifdef USE_PCLOSE\n            else if(-1 == (ret = pclose(daemon_pipe)))\n            {\n                printf(\"An error occured waiting for '%s': %m\\n\", DAEMON_START_CMD);\n                return EXIT_FAILURE;\n            }\n            #endif\n            else\n            {\n                printf(\"Script exit status : %d\\n\", ret);\n\n                while(0 != access(DAEMON_PID_FILE, F_OK))\n                {\n                    printf(\"Waiting for pid file creation\\n\");\n                    sleep(1);\n                }\n                if(NULL == (fp = fopen(DAEMON_PID_FILE, \"r\")))\n                {\n                    printf(\"Unable to open '%s'\\n\", DAEMON_PID_FILE);\n                    return EXIT_FAILURE;\n                }\n                fscanf(fp, \"%d\", &amp;daemon_pid);\n                fclose(fp);\n                printf(\"Daemon has pid=%d\\n\", daemon_pid);\n                sprintf(daemon_proc_path, \"/proc/%d/exe\", daemon_pid);\n            }\n        }\n        else\n        {\n            printf(\"Daemon alive (pid=%d)\\n\", daemon_pid);\n        }\n        sleep(1);\n    }\n\n    return EXIT_SUCCESS;\n}\n</code></pre>\n\n<p>From what I understood <code>pclose</code> is supposed to wait for child process termination and only when the child process has returned, it closes the pipe.</p>\n\n<p>So I don't understand why my implementation with <code>pclose</code> doesn't work when it works without calling it.</p>\n\n<p>Here are the logs with and without the <code>pclose</code> block commented</p>\n\n<p>Without <code>pclose</code> calling:</p>\n\n<pre><code># ./popenTest \nLaunching 'daemon-test' program\nScript exit status : 0\nWaiting for pid file creation\nDaemon has pid=435\nDaemon alive (pid=435)\nDaemon alive (pid=435)\nDaemon alive (pid=435)\nDaemon alive (pid=435)\n</code></pre>\n\n<p>With <code>pclose</code> calling:</p>\n\n<pre><code># ./popenTest \nLaunching 'daemon-test' program\nScript exit status : 36096\nWaiting for pid file creation\nWaiting for pid file creation\nWaiting for pid file creation\nWaiting for pid file creation\n</code></pre>\n\n<p>As you can see, the daemon is never launched and the pid file is never created neither.</p>\n\n<p>Even if my program works without <code>pclose</code> I would like to understand the underlying issue with the call to <code>pclose</code>.</p>\n\n<p><strong>Why using <code>pclose</code> makes the program fail when the behaviour is good without calling it ?</strong></p>\n\n<hr>\n\n<p><strong><em>EDIT:</em></strong></p>\n\n<p>Here are some more information for the error case</p>\n\n<p>errno is <code>Success</code><br/>\nWIFEXITED macro returns true<br/>\nWEXITSTATUS macro returns 141<br/></p>\n\n<p>By going further into debugging, I have remarqued that modifying the init script to log output to a file makes it work... <strong>why ?</strong></p>\n"}, {"tags": ["android", "ios", "c", "multithreading", "thread-safety"], "answers": [{"tags": [], "owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "is_accepted": false, "score": 2, "last_activity_date": 1530628078, "creation_date": 1530628078, "answer_id": 51157087, "question_id": 51156660, "link": "https://stackoverflow.com/questions/51156660/is-memcpy-mktime-thread-safe-on-ios-android/51157087#51157087", "title": "Is memcpy() / mktime() thread-safe on iOS &amp; Android?", "body": "<p>The question if <code>memcpy()</code> is thread-safe might be discussible.</p>\n\n<p>I would say that <code>memcpy()</code> is indeed thread-safe. It doesn't rely on a (global) state, which could be mangled up by multiple instances of <code>memcpy()</code> running. This, however, <strong>doesn't</strong> mean, that there is some magic preventing a memory area, which is <em>concurrently</em> the copy destination of multiple threads doing <code>memcpy()</code> gets badly mangled up, i.e. the copy process as a whole is <em>not atomic</em>. You would have to care yourself using <em>mutexes</em> to ensure atomicity.</p>\n\n<p><code>mktime()</code> is trivially threadsafe, since it doesn't use static buffers, use a global state or similar. The manpage mentions a few functions from that family being <em>not</em> threadsafe (those have corresponding *_r functions), but <code>mktime()</code> is not amongst those.</p>\n"}, {"comments": [{"owner": {"reputation": 28117, "user_id": 777265, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/BNXHx.jpg?s=128&g=1", "display_name": "DaveAlden", "link": "https://stackoverflow.com/users/777265/davealden"}, "edited": false, "score": 0, "creation_date": 1530634712, "post_id": 51157155, "comment_id": 89301429, "body": "Great, this is useful (as is the answer from @Ctx). I&#39;m reading this to mean, so long as I don&#39;t do anything stupid with these functions or run them across multiple threads (the implementation I have only operates on a single thread) then I should be OK. I guess Crashlytics data will tell me otherwise once it goes live :-)"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 28117, "user_id": 777265, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/BNXHx.jpg?s=128&g=1", "display_name": "DaveAlden", "link": "https://stackoverflow.com/users/777265/davealden"}, "edited": false, "score": 0, "creation_date": 1530644368, "post_id": 51157155, "comment_id": 89306092, "body": "@DaveAlden, what&#39;s &quot;stupid&quot; may be subjective, but basically, yes.  In particular, as long as the destinations of all your <code>memcpy()</code>s and <code>mktime()</code>s are local variables, you should have nothing to worry about.  And to the extent that the destinations are provided by your library&#39;s callers, it is mostly not your problem.  It&#39;s also not an issue when your library is used concurrently by different apps."}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 4, "last_activity_date": 1530628302, "creation_date": 1530628302, "answer_id": 51157155, "question_id": 51156660, "link": "https://stackoverflow.com/questions/51156660/is-memcpy-mktime-thread-safe-on-ios-android/51157155#51157155", "title": "Is memcpy() / mktime() thread-safe on iOS &amp; Android?", "body": "<p>POSIX requires of conforming implementations that all functions it standardizes be thread safe, with the exception of a relatively short list of functions.  <code>memcpy()</code> and <code>mktime()</code> are both covered by POSIX, and neither is on the list of exceptions, so POSIX requires them to be thread safe (but read on).</p>\n\n<p>Note well, however, that this is not a matter of the compiler used, but rather of the C library that supports your application.  I recall Apple's C libraries being non-conforming in some areas.  Nevertheless, there's nothing in particular about <code>memcpy()</code> and <code>mktime()</code> that makes them inherently risky from a thread safety perspective.  That is, there's no reason to expect that they access any shared data, <em>except any provided to them via their arguments</em>.</p>\n\n<p>And there's the rub.  You can rely on <code>memcpy()</code> and <code>mktime()</code> not to, say, rely internally on static data, but POSIX's requirement for thread safety does not extend to working as documented in the face of data races you create through choice of arguments.  Thus, for example, if two different threads call <code>memcpy()</code>, and the target region of one call overlaps either the source or target region of the other, then you need some flavor of synchronization between the threads.</p>\n"}], "owner": {"reputation": 28117, "user_id": 777265, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/BNXHx.jpg?s=128&g=1", "display_name": "DaveAlden", "link": "https://stackoverflow.com/users/777265/davealden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 176, "favorite_count": 0, "accepted_answer_id": 51157155, "answer_count": 2, "score": 1, "last_activity_date": 1530628302, "creation_date": 1530626781, "question_id": 51156660, "link": "https://stackoverflow.com/questions/51156660/is-memcpy-mktime-thread-safe-on-ios-android", "title": "Is memcpy() / mktime() thread-safe on iOS &amp; Android?", "body": "<p>I have a C library which I'm cross-compiling to use in Android &amp; iOS apps.</p>\n\n<p>It makes use of <code>memcpy()</code> and <code>mktime()</code> so I want to know if these functions are implicitly thread-safe when used in multi-threaded environments. </p>\n\n<p>iOS apps compiled with modern Xcode and Android libraries compiled with modern Android NDK use a clang compiler which is LLVM-based.</p>\n\n<p>I've reviewed the following questions, but have been unable to find a definitive answer:</p>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/questions/15145152/is-memcpy-process-safe\">Is memcpy process-safe?</a></li>\n<li><a href=\"https://stackoverflow.com/questions/19974548/are-functions-in-the-c-standard-library-thread-safe\">Are functions in the C standard library thread safe?</a></li>\n</ul>\n"}, {"tags": ["python", "c", "go"], "comments": [{"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1530627868, "post_id": 51156221, "comment_id": 89297347, "body": "Please include the exact command used to build the library (from Go source)."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1530628257, "post_id": 51156221, "comment_id": 89297625, "body": "A reality check: to create a module for CPython, you&#39;re supposed to build your Go code in a way to provide a C-compatible &quot;archive&quot; or a library\u2014that is, you&#39;re supposed to use the <a href=\"https://golang.org/pkg/cmd/go/internal/help/\" rel=\"nofollow noreferrer\"><code>-buildmode</code></a> option with one of <code>c-archive</code> or <code>c-shared</code> values. The further build process (which would use that archive/library) is supposed to act in accordance with the type of the produced artefact."}, {"owner": {"reputation": 109, "user_id": 1892636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1a8658a9de51235a672df0b3682a3d7?s=128&d=identicon&r=PG", "display_name": "Ratmil", "link": "https://stackoverflow.com/users/1892636/ratmil"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1530636202, "post_id": 51156221, "comment_id": 89302142, "body": "This is the command to compile the library from Go:                              go build -buildmode=c-archive -o $(BUILDLIB_DIR)/mylib.a  $(LIB_FILES)"}, {"owner": {"reputation": 109, "user_id": 1892636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1a8658a9de51235a672df0b3682a3d7?s=128&d=identicon&r=PG", "display_name": "Ratmil", "link": "https://stackoverflow.com/users/1892636/ratmil"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1530636313, "post_id": 51156221, "comment_id": 89302188, "body": "It works well on Linux. The problem is with Mac OS and setting the install name."}, {"owner": {"reputation": 109, "user_id": 1892636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1a8658a9de51235a672df0b3682a3d7?s=128&d=identicon&r=PG", "display_name": "Ratmil", "link": "https://stackoverflow.com/users/1892636/ratmil"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1530636492, "post_id": 51156221, "comment_id": 89302290, "body": "I have found something that may help me. Adding arguments to Go c compiler."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1530686173, "post_id": 51156221, "comment_id": 89317508, "body": "Then please answer your own question and then mark it as accepted. This is normal practice on SO."}, {"owner": {"reputation": 109, "user_id": 1892636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1a8658a9de51235a672df0b3682a3d7?s=128&d=identicon&r=PG", "display_name": "Ratmil", "link": "https://stackoverflow.com/users/1892636/ratmil"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1530717720, "post_id": 51156221, "comment_id": 89336422, "body": "Sorry, I haven&#39;t solved this problem yet."}, {"owner": {"reputation": 109, "user_id": 1892636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1a8658a9de51235a672df0b3682a3d7?s=128&d=identicon&r=PG", "display_name": "Ratmil", "link": "https://stackoverflow.com/users/1892636/ratmil"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1530723844, "post_id": 51156221, "comment_id": 89339143, "body": "Sorry. I just thought I had found the answer but I haven&#39;t. My idea is to add an argument to go builder like this: go build -gcflags=&quot;-install_name @rpath/mylib.a&quot;, but that didn&#39;t work."}], "answers": [{"tags": [], "owner": {"reputation": 109, "user_id": 1892636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1a8658a9de51235a672df0b3682a3d7?s=128&d=identicon&r=PG", "display_name": "Ratmil", "link": "https://stackoverflow.com/users/1892636/ratmil"}, "is_accepted": false, "score": 0, "last_activity_date": 1530836340, "creation_date": 1530836340, "answer_id": 51201529, "question_id": 51156221, "link": "https://stackoverflow.com/questions/51156221/compiling-and-linking-python-module-in-mac-os/51201529#51201529", "title": "Compiling and linking Python module in Mac Os", "body": "<p>OK. This is what I previously had:</p>\n\n<pre><code>ext_modules = [Extension(\"_mypymod\", [\"mymod.c\"],\n                         extra_link_args=[],\n                         depends=[],\n                         libraries = [':mylib.a'],\n                         library_dirs = [\n                             lib_path\n                         ],\n                   )],\n</code></pre>\n\n<p>That didn't work in MacOS. This is how it should be:</p>\n\n<pre><code>ext_modules = [Extension(\"_mypymod\", [\"mymod.c\"],\n                             extra_link_args=[lib_path + '/mylib.a'], #full path to the library\n                             depends=[],\n                       )],\n</code></pre>\n\n<p>That works in linux and Mac.</p>\n"}], "owner": {"reputation": 109, "user_id": 1892636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1a8658a9de51235a672df0b3682a3d7?s=128&d=identicon&r=PG", "display_name": "Ratmil", "link": "https://stackoverflow.com/users/1892636/ratmil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 189, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1530836340, "creation_date": 1530625545, "question_id": 51156221, "link": "https://stackoverflow.com/questions/51156221/compiling-and-linking-python-module-in-mac-os", "title": "Compiling and linking Python module in Mac Os", "body": "<p>I am working on a Python module. I have C source file and a compiled library. I was having problems when linking in Mac Os, so I followed the instructions provided at <a href=\"https://stackoverflow.com/questions/19123623/python-runtime-library-dirs-doesnt-work-on-mac\">Python runtime_library_dirs doesn&#39;t work on Mac</a>.</p>\n\n<p>This post says that add extra link arguments should be added when linking in Mac Os. It also says that install_name_tool should be used to change the install name of the library.</p>\n\n<p>However, I am getting this error message when using install_name_tool:</p>\n\n<pre><code>string table not at the end of the file (can't be processed) in file:\n</code></pre>\n\n<p>The library is compiled from Go source.</p>\n"}, {"tags": ["c", "list", "hashtable"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1530623300, "post_id": 51155374, "comment_id": 89294127, "body": "Easiest way to find the bug is probably just to single-step it through your debugger."}, {"owner": {"reputation": 4328, "user_id": 920069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd39f0db1f22e1314746491df063602a?s=128&d=identicon&r=PG", "display_name": "Retired Ninja", "link": "https://stackoverflow.com/users/920069/retired-ninja"}, "edited": false, "score": 1, "creation_date": 1530623305, "post_id": 51155374, "comment_id": 89294132, "body": "Have you run the code in a debugger so you can step through and see what&#39;s happening and where the crash happens? You appear to have a typo in the code that keeps it from compiling, and extra <code>}</code>, but if that is fixed it still won&#39;t compile since the <code>hash1</code> function is missing."}, {"owner": {"reputation": 1722, "user_id": 5151792, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/463805ba3eae4866f5b40151249db4e4?s=128&d=identicon&r=PG&f=1", "display_name": "aicastell", "link": "https://stackoverflow.com/users/5151792/aicastell"}, "edited": false, "score": 0, "creation_date": 1530623354, "post_id": 51155374, "comment_id": 89294177, "body": "Pasted code simply don&#39;t compiles fine  code.c:94:5: error: expected identifier or \u2018(\u2019 before \u2018if\u2019      if(tabela[pos].vetor==NULL){"}, {"owner": {"reputation": 1632, "user_id": 2429333, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5eb897104dc190de7ea7da0ac29a59ae?s=128&d=identicon&r=PG", "display_name": "pbn", "link": "https://stackoverflow.com/users/2429333/pbn"}, "edited": false, "score": 1, "creation_date": 1530623628, "post_id": 51155374, "comment_id": 89294394, "body": "Please read <a href=\"https://stackoverflow.com/editing-help\">How to create a Minimal, Complete, and Verifiable example</a>. Except for fixing some compilation errors still the hash1 function is missing in your code."}, {"owner": {"reputation": 9095, "user_id": 8542346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11b206b49cec657d28a5876f8330780e?s=128&d=identicon&r=PG&f=1", "display_name": "H.S.", "link": "https://stackoverflow.com/users/8542346/h-s"}, "edited": false, "score": 0, "creation_date": 1530623710, "post_id": 51155374, "comment_id": 89294452, "body": "<code>nodo *no; &#47;&#47;&lt;&lt;&lt;&lt;&lt;Possible error location&gt;&gt;&gt;&gt;&gt;</code> .. Yes you are correct here because you have missed initializing <code>no</code> and accessing unintialized pointer in the <code>for</code> loop. Initialize <code>no</code> with <code>lista-&gt;inicio</code> before accessing it."}, {"owner": {"reputation": 1, "user_id": 10023982, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-nkOHbROVebo/AAAAAAAAAAI/AAAAAAAAABM/jcfsWb75f8E/photo.jpg?sz=128", "display_name": "Everton Almeida", "link": "https://stackoverflow.com/users/10023982/everton-almeida"}, "edited": false, "score": 0, "creation_date": 1530624799, "post_id": 51155374, "comment_id": 89295223, "body": "Thanks H.S I did what you informed me and it worked out I&#39;m editing the code for the correct one"}, {"owner": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "edited": false, "score": 0, "creation_date": 1530625734, "post_id": 51155374, "comment_id": 89295875, "body": "If you edit the code to a working state, this question becomes no longer a question. (You can always delete it if that&#39;s what you want.)"}, {"owner": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "reply_to_user": {"reputation": 9095, "user_id": 8542346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11b206b49cec657d28a5876f8330780e?s=128&d=identicon&r=PG&f=1", "display_name": "H.S.", "link": "https://stackoverflow.com/users/8542346/h-s"}, "edited": false, "score": 0, "creation_date": 1530625752, "post_id": 51155374, "comment_id": 89295890, "body": "@H.S. Please answer in the answer section, not in the comments."}, {"owner": {"reputation": 1, "user_id": 10023982, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-nkOHbROVebo/AAAAAAAAAAI/AAAAAAAAABM/jcfsWb75f8E/photo.jpg?sz=128", "display_name": "Everton Almeida", "link": "https://stackoverflow.com/users/10023982/everton-almeida"}, "edited": false, "score": 0, "creation_date": 1530626119, "post_id": 51155374, "comment_id": 89296155, "body": "Sorry, I think I&#39;m right now I&#39;m new here. If you can help with the accent issue, thank you too."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1530626273, "post_id": 51155374, "comment_id": 89296276, "body": "@EvertonAlmeida which <i>accent issue</i>? This is another question, post another question please."}], "answers": [{"comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1530626326, "post_id": 51156397, "comment_id": 89296321, "body": "This code is incorrect and yields in undefined behaviour, see my answer."}], "tags": [], "owner": {"reputation": 1, "user_id": 10023982, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-nkOHbROVebo/AAAAAAAAAAI/AAAAAAAAABM/jcfsWb75f8E/photo.jpg?sz=128", "display_name": "Everton Almeida", "link": "https://stackoverflow.com/users/10023982/everton-almeida"}, "is_accepted": false, "score": 0, "last_activity_date": 1530626678, "last_edit_date": 1530626678, "creation_date": 1530626032, "answer_id": 51156397, "question_id": 51155374, "link": "https://stackoverflow.com/questions/51155374/list-vector-print-does-not-work/51156397#51156397", "title": "List vector print does not work", "body": "<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;locale.h&gt;\nenum erro {\n     semErro = 0, posInv = 1, listaCheia = 2, listaVazia = 3, existe         = 4, naoExiste = 5\n};\n\ntypedef struct no{       \n    char nome[100];\n    char telefone[20];\n    struct no *prox;\n} nodo;\n\ntypedef struct{\n    int tamanho;\n    nodo *inicio;\n} lista;\n\ntypedef struct { \n    int tamanhoTabelaHash;\n    int colisoes;\n    lista* vetor;\n} tabela;\n\n///////////////////Chamada de Fun\u00e7\u00f5es///////////////////\nlista *novaLista();\ntabela *criaTabela(int tam);\nint insereTabela(tabela *tabela, char *entraNome, char *entraTelefone);\nint insereNoInicioI(lista *lista,char *entraNome, char *entraTelefone);\nint hash1(char *entraNome, int tam);\nvoid imprime(lista *lista);\nvoid imprimeTabela(tabela *tabela);\n///////////////////Fun\u00e7\u00f5es Lista///////////////////\n\nvoid imprime(lista *lista){        \n     int i;\n     nodo *no = lista-&gt; inicio; \n     puts(\"Lista: \\n\");\n     for (i = 0; i &lt; lista-&gt;tamanho; i++) {  \n          printf(\"Nome: %s Telefone: %s\\n\",no-&gt;nome,no-&gt;telefone);\n          no=no-&gt;prox;\n     }\n}\n\nlista *novaLista(){ \n\n     lista *l = (lista*)malloc(sizeof(lista));\n     l-&gt;tamanho=0;\n     l-&gt;inicio=NULL;\n     return l;\n}\n\nint insereNoInicioI(lista *lista,char *entraNome, char *entraTelefone){ \n\n     nodo *novo=(nodo *)malloc(sizeof(nodo));    \n     strcpy(novo-&gt;nome,entraNome);\n     strcpy(novo-&gt;telefone,entraTelefone);\n     novo-&gt;prox = lista-&gt;inicio;\n     lista-&gt;inicio = novo;        \n     lista-&gt;tamanho++;\n     return semErro;\n}\n\ntabela *criaTabela(int tam) {\n\n    if( tam &lt; 1 ) return NULL;\n    tabela *table = (tabela *)malloc(sizeof(tabela)*10);\n    table-&gt;tamanhoTabelaHash = tam;\n    table-&gt;colisoes = 0;\n    for (int i = 0; i &lt; 10; i++) {   \n        table[i].vetor = NULL;\n    }\n    return table;   \n}\n\nvoid imprimeTabela(tabela *tabela) {\n\n    int i;\n    printf(\"\\nTabela: \\n\");\n    for (i = 0; i &lt; tabela-&gt;tamanhoTabelaHash ; i++) {\n        printf(\"\\nindice[%d]:\", i);\n            if(tabela[i].vetor!=NULL){\n               imprime(tabela[i].vetor);\n            }  \n    }\n}\nint hash1(char *string, int tam) {\n\n    int tamanho = strlen(string);\n    unsigned soma = 0;\n    for (int i = 0; i &lt; tamanho; i++) {\n        soma = soma * 251 + string[i];\n    }\n    return soma % tam;\n}\n\nint insereTabela(tabela *tabela, char *entraNome, char *entraTelefone){\n\n    int pos = 0;\n        pos = hash1(entraNome,10);\n    if(tabela[pos].vetor==NULL){\n        lista *list = novaLista();\n        tabela[pos].vetor = list;\n    }\n    nodo *novo=(nodo *)malloc(sizeof(nodo));\n    insereNoInicioI(tabela[pos].vetor, entraNome, entraTelefone);\n    return semErro;\n} \n\nint main(){\n   setlocale(LC_ALL, \"Portuguese\");\n   tabela *table = criaTabela(10);\n\n   char nome[100] = \"Maria Cl\u00e1udia Feliz\";\n   char telefone[20] = \"(53)98401-8583\";\n   char nome1[100] = \"Everton Almeida\";\n   char telefone1[20] = \"(53)90000-8583\";\n   char nome2[100] = \"Everton Almeida\";\n   char telefone2[20] = \"(53)90000-8583\";\n\n   insereTabela(table,nome,telefone);\n   insereTabela(table,nome1,telefone1);\n   insereTabela(table,nome2,telefone2);\n   imprimeTabela(table);\nreturn semErro;\n} \nResultado:\nindice[0]:\nindice[1]:\nindice[2]:Lista: \nNome: Everton Almeida Telefone: (53)90000-8583\nindice[3]:\nindice[4]:\nindice[5]:Lista: \nNome: Everton Telefone: (53)90000-8583\nindice[6]:\nindice[7]:\nindice[8]:Lista: \nNome: Maria Cl\u00c3\u00a1udia Feliz Telefone: (53)98401-8583\nindice[9]:\n</code></pre>\n\n<p>Thanks to all comments THIS IS THE CODE WORKING, but I have one more doubt, because the name clause goes wrong if the setlocale (LC_ALL, \"Portuguese\");</p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 10023982, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-nkOHbROVebo/AAAAAAAAAAI/AAAAAAAAABM/jcfsWb75f8E/photo.jpg?sz=128", "display_name": "Everton Almeida", "link": "https://stackoverflow.com/users/10023982/everton-almeida"}, "edited": false, "score": 0, "creation_date": 1530626644, "post_id": 51156439, "comment_id": 89296525, "body": "Thank you, I did what you told me and it worked perfectly well with 10 but if you put more than 100 for example 100 it error."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 1, "user_id": 10023982, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-nkOHbROVebo/AAAAAAAAAAI/AAAAAAAAABM/jcfsWb75f8E/photo.jpg?sz=128", "display_name": "Everton Almeida", "link": "https://stackoverflow.com/users/10023982/everton-almeida"}, "edited": false, "score": 0, "creation_date": 1530626777, "post_id": 51156439, "comment_id": 89296615, "body": "It only <i>appeard</i> to work with 10. You are overwiting memory that you have never allocated. Your program yields in undefined behaviour (google that term). Undefined behaviour includes &quot;apparently working fine&quot;.  For example on my computer it crashes even with 10"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 1, "user_id": 10023982, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-nkOHbROVebo/AAAAAAAAAAI/AAAAAAAAABM/jcfsWb75f8E/photo.jpg?sz=128", "display_name": "Everton Almeida", "link": "https://stackoverflow.com/users/10023982/everton-almeida"}, "edited": false, "score": 0, "creation_date": 1530626876, "post_id": 51156439, "comment_id": 89296682, "body": "I&#39;m not sure if I understood your comment correctlky, but if you have <code>for (int i = 0; i &lt; 100; i++)</code>, the you need to allocate space for 100: <code>tabela *table = (tabela *)malloc(sizeof(tabela) * 100);</code>"}, {"owner": {"reputation": 1, "user_id": 10023982, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-nkOHbROVebo/AAAAAAAAAAI/AAAAAAAAABM/jcfsWb75f8E/photo.jpg?sz=128", "display_name": "Everton Almeida", "link": "https://stackoverflow.com/users/10023982/everton-almeida"}, "edited": false, "score": 0, "creation_date": 1530627104, "post_id": 51156439, "comment_id": 89296838, "body": "Thank you, I did what you told me and it worked perfectly. I was forgetting to change the value in the IF. But now it&#39;s working."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 1, "user_id": 10023982, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-nkOHbROVebo/AAAAAAAAAAI/AAAAAAAAABM/jcfsWb75f8E/photo.jpg?sz=128", "display_name": "Everton Almeida", "link": "https://stackoverflow.com/users/10023982/everton-almeida"}, "edited": false, "score": 1, "creation_date": 1530627182, "post_id": 51156439, "comment_id": 89296891, "body": "@EvertonAlmeida if this answer was helpful, you are supposed to upvote and/or <a href=\"https://meta.stackexchange.com/questions/5234/how-does-accepting-an-answer-work\"><b>accept</b></a> it so other users will see that the answer was useful."}], "tags": [], "owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "is_accepted": false, "score": 1, "last_activity_date": 1530626466, "last_edit_date": 1530626466, "creation_date": 1530626137, "answer_id": 51156439, "question_id": 51155374, "link": "https://stackoverflow.com/questions/51155374/list-vector-print-does-not-work/51156439#51156439", "title": "List vector print does not work", "body": "<p>You have at least one serious problem here:</p>\n\n<pre><code>tabela *criaTabela(int tam) {\n  if (tam &lt; 1) return NULL;\n\n  // you allocate space for 1 tabela\n  tabela *table = (tabela *)malloc(sizeof(tabela));\n  table-&gt;tamanhoTabelaHash = tam;\n  table-&gt;colisoes = 0;\n\n  // but here you write to 10 tabelas ....\n  for (int i = 0; i &lt; 10; i++) {\n    table[i].vetor = NULL;\n  }\n  return table;\n}\n</code></pre>\n\n<p>You if you write to 10 tabelas, you should allocate space for 10 tabelas:</p>\n\n<pre><code>  tabela *table = (tabela *)malloc(sizeof(tabela) * 10);\n</code></pre>\n\n<p>The code in your answer yields in undefined bahaviour. In other works it may <em>appear</em> to work. Google <em>\"undefined bahaviour\"</em>.</p>\n\n<p>There may be more problems elsewhere in your code.</p>\n"}], "owner": {"reputation": 1, "user_id": 10023982, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-nkOHbROVebo/AAAAAAAAAAI/AAAAAAAAABM/jcfsWb75f8E/photo.jpg?sz=128", "display_name": "Everton Almeida", "link": "https://stackoverflow.com/users/10023982/everton-almeida"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1530645123, "creation_date": 1530623051, "last_edit_date": 1530645123, "question_id": 51155374, "link": "https://stackoverflow.com/questions/51155374/list-vector-print-does-not-work", "title": "List vector print does not work", "body": "<p>I'm doing a hash table, where I have a one vector with a list inside each node of it. But when I go to print it does not appear the items that are within the list, and if I try to put more than one element in the list, it gives segmentation failure in the second. Below is the code and the result:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;locale.h&gt;\nenum erro {\n     semErro = 0, posInv = 1, listaCheia = 2, listaVazia = 3, existe         = 4, naoExiste = 5\n};\n\ntypedef struct no{       \n    char nome[100];\n    char telefone[20];\n    struct no *prox;\n} nodo;\n\ntypedef struct{\n    int tamanho;\n    nodo *inicio;\n} lista;\n\ntypedef struct { \n    int tamanhoTabelaHash;\n    int colisoes;\n    lista* vetor;\n} tabela;\n\n///////////////////Chamada de Fun\u00e7\u00f5es///////////////////\nlista *novaLista();\ntabela *criaTabela(int tam);\nint insereTabela(tabela *tabela, char *entraNome, char *entraTelefone);\nint insereNoInicioI(lista *lista,char *entraNome, char *entraTelefone);\nint hash1(char *entraNome, int tam);\nvoid imprime(lista *lista);\nvoid imprimeTabela(tabela *tabela);\n///////////////////Fun\u00e7\u00f5es Lista///////////////////\n\nvoid imprime(lista *lista){        \n     int i;\n     nodo *no; //&lt;&lt;&lt;&lt;&lt;Poss\u00edvel local do erro&gt;&gt;&gt;&gt;&gt;\n     puts(\"Lista: \\n\");\n     for (i = 0; i &lt; lista-&gt;tamanho; i++) {  \n          printf(\"Nome: %s Telefone: %s\\n\",no-&gt;nome,no-&gt;telefone);\n          no=no-&gt;prox;\n     }\n}\n\nlista *novaLista(){ \n\n     lista *l = (lista*)malloc(sizeof(lista));\n     l-&gt;tamanho=0;\n     l-&gt;inicio=NULL;\n     return l;\n}\n\nint insereNoInicioI(lista *lista,char *entraNome, char *entraTelefone){ \n\n     nodo *novo=(nodo *)malloc(sizeof(nodo));    \n     strcpy(novo-&gt;nome,entraNome);\n     strcpy(novo-&gt;telefone,entraTelefone);\n     novo-&gt;prox = lista-&gt;inicio;\n     lista-&gt;inicio = novo;        \n     lista-&gt;tamanho++;\n     return semErro;\n}\n\ntabela *criaTabela(int tam) {\n\n    if( tam &lt; 1 ) return NULL;\n    tabela *table = (tabela *)malloc(sizeof(tabela));\n    table-&gt;tamanhoTabelaHash = tam;\n    table-&gt;colisoes = 0;\n    for (int i = 0; i &lt; 10; i++) {   \n        table[i].vetor = NULL;\n    }\n    return table;   \n}\n\nvoid imprimeTabela(tabela *tabela) {\n\n    int i;\n    printf(\"\\nTabela: \\n\");\n    for (i = 0; i &lt; tabela-&gt;tamanhoTabelaHash ; i++) {\n        printf(\"\\nindice[%d]:\", i);\n            if(tabela[i].vetor!=NULL){\n               imprime(tabela[i].vetor);\n            }  \n    }\n}\n\nint insereTabela(tabela *tabela, char *entraNome, char *entraTelefone){\n\n    int pos = 0;\n        pos = hash1(entraNome,10000);//Fun\u00e7\u00e3o que retorna uma posi\u00e7\u00e3o( no caso 8 para o primeiro nome e 6 para o segundo e terceiro\n    }\n    if(tabela[pos].vetor==NULL){\n        lista *list = novaLista();\n        tabela[pos].vetor = list;\n    }\n    nodo *novo=(nodo *)malloc(sizeof(nodo));\n    insereNoInicioI(tabela[pos].vetor, entraNome, entraTelefone);\n    return semErro;\n} \n\nint main(){\n   setlocale(LC_ALL, \"Portuguese\");\n   tabela *table = criaTabela(10);\n\n   char nome[100] = \"Maria Cl\u00e1udia Feliz\";\n   char telefone[20] = \"(53)98401-8583\";\n   char nome1[100] = \"Everton Almeida\";\n   char telefone1[20] = \"(53)90000-8583\";\n   char nome2[100] = \"Everton Almeida\";\n   char telefone2[20] = \"(53)90000-8583\";\n\n   insereTabela(table,nome,telefone);\n   insereTabela(table,nome1,telefone1);\n   insereTabela(table,nome2,telefone2);\n   imprimeTabela(table);\nreturn semErro;\n} \nResultado:\nTabela: \nindice[0]: \nindice[1]:\nindice[2]: \nindice[3]: \nindice[4]: \nindice[5]: \nindice[6]:Lista: \nNome:  Telefone:  //&lt;&lt;&lt;&lt;Deveria imprimir o nome e telefone&gt;&gt;&gt;&gt;\nNome:  Telefone:  //&lt;&lt;&lt;&lt;Deveria imprimir o nome e telefone&gt;&gt;&gt;&gt;\nindice[7]: \nindice[8]:Lista:\n                  //&lt;&lt;&lt;&lt;Deveria imprimir o nome e telefone&gt;&gt;&gt;&gt;\nFalha de segmenta\u00e7\u00e3o(imagem do n\u00facleo gravada)\n</code></pre>\n\n<p>If you can help, thank you. </p>\n"}, {"tags": ["c", "serial-port", "uart", "vxworks"], "comments": [{"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1530629809, "post_id": 51153629, "comment_id": 89298573, "body": "Move this question more to the terse end of the spectrum.  Then, ask a question about something that is not working.  If you are interested in a code review, then post it <i><a href=\"https://codereview.stackexchange.com/\">HERE</a></i>"}, {"owner": {"reputation": 886, "user_id": 1794617, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/001cd3dded16718597e6861de86d8041?s=128&d=identicon&r=PG", "display_name": "HighOnMeat", "link": "https://stackoverflow.com/users/1794617/highonmeat"}, "reply_to_user": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1530668789, "post_id": 51153629, "comment_id": 89312787, "body": "It isn&#39;t working per se. I cannot ever switch to my consumer (per the board&#39;s perspective) thread in any meaningful way. Let me edit my question to make it more specific"}, {"owner": {"reputation": 81, "user_id": 4641732, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-XizCd-zGQ64/AAAAAAAAAAI/AAAAAAAACKI/J9HZOqRqUmY/photo.jpg?sz=128", "display_name": "Vikash Jain", "link": "https://stackoverflow.com/users/4641732/vikash-jain"}, "edited": false, "score": 0, "creation_date": 1532017091, "post_id": 51153629, "comment_id": 89826224, "body": "See if terminal setting help, you can explore OPT_ECHO option so that any input will echoed back to console port (UART)."}], "answers": [{"tags": [], "owner": {"reputation": 61, "user_id": 848122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86acfaa3f07ad1eecad317747db7b08e?s=128&d=identicon&r=PG", "display_name": "David Holloway", "link": "https://stackoverflow.com/users/848122/david-holloway"}, "is_accepted": false, "score": 0, "last_activity_date": 1531070712, "creation_date": 1531070712, "answer_id": 51234411, "question_id": 51153629, "link": "https://stackoverflow.com/questions/51153629/creating-a-serial-loopback-under-vxworks/51234411#51234411", "title": "creating a serial loopback under VxWorks", "body": "<p>I don't have 50 rep points for commenting, but without a loopback cable attached, the only way you can arrive at testing serial loopback behavior is to switch the uart into loopback mode.  This often means making changes to the  specific hardware part driver.</p>\n"}], "owner": {"reputation": 886, "user_id": 1794617, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/001cd3dded16718597e6861de86d8041?s=128&d=identicon&r=PG", "display_name": "HighOnMeat", "link": "https://stackoverflow.com/users/1794617/highonmeat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 499, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1531070712, "creation_date": 1530617746, "last_edit_date": 1530619580, "question_id": 51153629, "link": "https://stackoverflow.com/questions/51153629/creating-a-serial-loopback-under-vxworks", "title": "creating a serial loopback under VxWorks", "body": "<p>I'm fairly new to VxWorks OS and hence wouldn't mind explanations in case I differ in my understanding of things under the hood when they differ from more <em>traditional</em> OSes like Linux and the likes. With that out of the way, let me begin  my actual question.</p>\n\n<p>I am trying to create a loop-back test for testing changes I made to the serial UART driver on the board. Since I do not want to use a cross cable to actually short two UART ports externally, I've connected both of those ports to my dev machine. One configured as an output port from the dev machine's perspective (and consequently as an Input port on the board) and the other an input port (an output port on the board). I am actually doing the loopback using a shared memory buffer which I am protecting using a mutex. So there are two threads on the board, one of which reads from the input port, copies data to the shared memory and the other reads from the memory and sends it over the output port.</p>\n\n<p>And I am using <em>regular</em> open, read and write calls in my VxWorks application (by the way I <em>think</em> it is part of the application code as I call the functions from <code>usrAppInit.c</code> not withstanding the fact that I can even call driver routines from here! (Is it because of a <em>flat</em> memory model vis-a-vis Linux?? Anyhow).</p>\n\n<p>Now I these ports on VxWorks have been opened in a non blocking mode and here's the code snippet which configures one of the ports:</p>\n\n<pre><code>if( (fdIn = open(portstrIn, O_RDONLY | O_NOCTTY, 0) ) == ERROR) {\n    return 1;\n}\n\nif(((status = ioctl(fdIn, FIOSETOPTIONS, OPT_RAW))) == ERROR)\n{\n    return 1;\n}\n\n/* set the baud rate to 115200\n */\n\nif((status = ioctl(fdIn, FIOBAUDRATE, 115200)) == ERROR)\n{\n   return 1;\n}\n\n/* set the HW options\n */\n\nif((status = ioctl(fdIn, SIO_HW_OPTS_SET, (CS8 | 0 | 0))) == ERROR)\n{\n    return 1;\n}\n</code></pre>\n\n<p>And similarly the output port is also configured. These two are part of two separate tasks spawned using <code>taskSpawn</code> and have the same priority of 100. However what I am annoyed by, is that when I write to the in port from my dev machine (using a python script), the read call on the board get's sort of <em>staggered</em> (I wonder if that's the right way to refer to it). It is most likely due to the short availability of hardware buffer space on the UART input buffer (or some such). This is <strong>usually</strong> not much of a problem if that is all I am doing. </p>\n\n<p>However, as explained earlier, I am trying to copy the whole received character stream into a common memory buffer (guarded by a mutex of course) which is then read by another task and then re-transmitted over another serial port (sort of an in memory loopback if you will)</p>\n\n<p>In lieu of that aforementioned staggering of the read calls, I thought of holding the mutex as long as there are characters to be read from the Inport and once there are no chars to be read, release the mutex and since this is VxWorks, do an explicit <code>taskDelay(0)</code> to schedule the next ready task (my other task). However since this is a blocking read, I am (as expected) stuck on the read call due to which my other thread never gets a chance to execute.</p>\n\n<p>I did think of checking if the buffer was full and then doing the explicit task switch however if any of you have a better idea, I'm all ears.</p>\n\n<p>Also just to see how this <strong>staggered</strong> read thing works from the perspective of the kernel, I timed it using a <code>time(NULL)</code> call just before and right after the read. So surprisingly, the very first chunk shows up a number, every other chunk after that (if it's a part of the same data block coming from the outside) shows 0. Could anyone explain that as well?</p>\n\n<p>Keen to hear</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 2, "creation_date": 1530616964, "post_id": 51153305, "comment_id": 89289922, "body": "You know in C, we can do that <code>int x = 1;</code> ;)"}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1530617203, "post_id": 51153305, "comment_id": 89290083, "body": "What is the difference between else if ((i &gt; 3) &amp;&amp; (i &lt; 5) and if ( x == 4 ) ?"}, {"owner": {"reputation": 45, "user_id": 9824556, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46128f962296cf3fd09ed14081363e59?s=128&d=identicon&r=PG&f=1", "display_name": "Marco ", "link": "https://stackoverflow.com/users/9824556/marco"}, "reply_to_user": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1530617495, "post_id": 51153305, "comment_id": 89290249, "body": "@Stargateur I know that ofc, I just copy pasted from the exam."}, {"owner": {"reputation": 45, "user_id": 9824556, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46128f962296cf3fd09ed14081363e59?s=128&d=identicon&r=PG&f=1", "display_name": "Marco ", "link": "https://stackoverflow.com/users/9824556/marco"}, "reply_to_user": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1530617556, "post_id": 51153305, "comment_id": 89290289, "body": "@Michi I don&#39;t think there is one, just copied it from the exam paper. My teacher is outdated, he likes to complicate things"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 10, "creation_date": 1530617741, "post_id": 51153305, "comment_id": 89290393, "body": "Yikes. Looks like a class in &quot;how to not program in C&quot;."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1530630867, "post_id": 51153305, "comment_id": 89299290, "body": "@Lundin As an exam question, the weak code does have merit: This is code that is not how to program in C, but an assessment of how to improve it. Re-factoring and faithfully maintaining functionality of prior poorly written code is a challenging skill worthy of assessment. Many a new C programmer today will be obliged to improve exiting code bases - and not break them."}], "answers": [{"comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 1, "creation_date": 1530617444, "post_id": 51153371, "comment_id": 89290217, "body": "It would have been a truly evil question if in the OP <code>x += 2;</code> was instead a <code>break;</code>."}, {"owner": {"reputation": 45, "user_id": 9824556, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46128f962296cf3fd09ed14081363e59?s=128&d=identicon&r=PG&f=1", "display_name": "Marco ", "link": "https://stackoverflow.com/users/9824556/marco"}, "edited": false, "score": 0, "creation_date": 1530617455, "post_id": 51153371, "comment_id": 89290223, "body": "Yeah the output is the same, I did not change the behaviour of if (x&gt;=4) break;"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 1, "creation_date": 1530617461, "post_id": 51153371, "comment_id": 89290229, "body": "@StoryTeller: I was thinking exactly the same thing."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "edited": false, "score": 0, "creation_date": 1530623306, "post_id": 51153371, "comment_id": 89294133, "body": "@GemTaylor: U wot? <code>continue</code> has no direct use in a <code>switch</code>."}, {"owner": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "edited": false, "score": 0, "creation_date": 1530623759, "post_id": 51153371, "comment_id": 89294484, "body": "You are right... you unlearn something every day. I had it in my mind that continue  was equivalent to break. Perhaps in a different language."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "edited": false, "score": 0, "creation_date": 1530623889, "post_id": 51153371, "comment_id": 89294581, "body": "@GemTaylor: <code>continue</code> is the same as a <code>break</code> in PHP. Nice."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1530629451, "post_id": 51153371, "comment_id": 89298360, "body": "May be useful to note: the <code>continue</code> is for the <code>for()</code> loop and not the <code>switch</code>."}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": true, "score": 5, "last_activity_date": 1530630622, "last_edit_date": 1530630622, "creation_date": 1530616961, "answer_id": 51153371, "question_id": 51153305, "link": "https://stackoverflow.com/questions/51153305/switch-vs-if-else-if-else/51153371#51153371", "title": "Switch vs if ... else if ... else", "body": "<p>Of course you can. A <code>for</code> loop controls the execution of a <em>statement</em> and a <code>switch</code> block <em>is</em> a statement.</p>\n\n<p>Given that <code>i</code> is in the inclusive range of 1 to 9, you can replace the <code>if</code> block with</p>\n\n<pre><code>switch (i){\ncase 1: case 2: case 3:\n    // that replaces 'if (i &lt;= 3)'\n    // ToDo - the code here\n    break; // to obviate follow-through.\ncase 4:\n    // that replaces 'if ((i &gt; 3) &amp;&amp; (i &lt; 5))'\n    // ToDo - the code here\n    break;\ndefault:\n    // that replaces 'else'\n    continue; // note that this is for the for loop, not the switch\n}\n</code></pre>\n\n<p>Note that the behaviour of <code>if (x &gt;= 4) break;</code> is <strong>not</strong> changed by this refactoring.</p>\n\n<p>I'm not convinced however that replacing the <code>if</code> block with a <code>switch</code> is the right thing to do here: the boundaries <code>i &lt;= 3</code> and <code>i &gt;= 5</code> are less naturally handled with a <code>switch</code>; perhaps changing the type of <code>i</code> to <code>unsigned</code> and handling <code>case 0:</code> explicitly would alleviate this somewhat.</p>\n"}, {"comments": [{"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 1, "creation_date": 1530617577, "post_id": 51153506, "comment_id": 89290309, "body": "&quot;Performance is almost the same.&quot; - what do you mean by this? That&#39;s a can of worms right there; I&#39;d be inclined to drop that statement if I were you."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1530617685, "post_id": 51153506, "comment_id": 89290366, "body": "I mean that the long if sequences are often compiled to the lookup tables - very similar to the switch statements."}, {"owner": {"reputation": 823, "user_id": 8219383, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-skKjxh6jxds/AAAAAAAAAAI/AAAAAAAAtPU/vVIFbedVzvo/photo.jpg?sz=128", "display_name": "Michael Beer", "link": "https://stackoverflow.com/users/8219383/michael-beer"}, "edited": false, "score": 0, "creation_date": 1530622614, "post_id": 51153506, "comment_id": 89293604, "body": "I&#39;d never advise to use non-portable features, never ever."}], "tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": 0, "last_activity_date": 1530617390, "creation_date": 1530617390, "answer_id": 51153506, "question_id": 51153305, "link": "https://stackoverflow.com/questions/51153305/switch-vs-if-else-if-else/51153506#51153506", "title": "Switch vs if ... else if ... else", "body": "<p>You can have the switch statement inside the loops.</p>\n\n<p>IMO the <code>switch</code> is more readable than the long <code>if else</code> sequences. Performance is almost the same.</p>\n\n<p>Some compilers (gcc for example) have switch extensions making the range checks in the switch statements shorter.</p>\n\n<pre><code>switch(age)\n{\n    case 0 ... 12:\n    printf(\"Child\\n\");\n    break;\n    case 13 ... 19:\n    printf(\"Teenager\\n\");\n    break;\n    case 20 ... 200:\n    printf(\"Adult\\n\");\n    break;\n    default:\n    printf(\"Immortal\\n\");\n    break;\n} \n</code></pre>\n\n<p>It is not portable of course.</p>\n"}, {"comments": [{"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 1, "creation_date": 1530618102, "post_id": 51153583, "comment_id": 89290595, "body": "Ha. Let&#39;s publish jointly! +1."}, {"owner": {"reputation": 3478, "user_id": 9061264, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TPing.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/9061264/mike"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1530618346, "post_id": 51153583, "comment_id": 89290751, "body": "@Bathsheba ok +1 too!"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1530629235, "post_id": 51153583, "comment_id": 89298224, "body": "Interesting use of <code>continue;                 break;</code>  <code>continue;</code> should be sufficient.  Even leaving the <code>default:</code> case out would not change functionality - but may look too different."}], "tags": [], "owner": {"reputation": 3478, "user_id": 9061264, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TPing.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/9061264/mike"}, "is_accepted": false, "score": 2, "last_activity_date": 1530617726, "last_edit_date": 1530617726, "creation_date": 1530617599, "answer_id": 51153583, "question_id": 51153305, "link": "https://stackoverflow.com/questions/51153305/switch-vs-if-else-if-else/51153583#51153583", "title": "Switch vs if ... else if ... else", "body": "<p>Something like this should work</p>\n\n<pre><code>void main()\n{\n    int x;\n    x = 1;\n    for (int i = 1; i &lt; 10; ++i) {\n        switch (i) {\n            case 1:\n            case 2:\n            case 3:\n                 do {\n                     x += i;\n                     if (x &gt;= 4)\n                         break;\n                 } while (i % 2 == 0);\n                 break;\n            case 4:\n                 x += 2;\n                 break;\n            default:\n                continue;\n                break;\n         }\n    }\n    while (x &gt; 0) {\n        printf(\" x=%d \", x);\n        x -= 1;\n    }\n    system(\"pause\");\n}\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 9824556, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46128f962296cf3fd09ed14081363e59?s=128&d=identicon&r=PG&f=1", "display_name": "Marco ", "link": "https://stackoverflow.com/users/9824556/marco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 226, "favorite_count": 0, "accepted_answer_id": 51153371, "answer_count": 3, "score": 3, "last_activity_date": 1530630622, "creation_date": 1530616744, "last_edit_date": 1530616897, "question_id": 51153305, "link": "https://stackoverflow.com/questions/51153305/switch-vs-if-else-if-else", "title": "Switch vs if ... else if ... else", "body": "<p>I have a question. I'm studying for my exam and I don't know how to do answer this. Basically I have to change the instructions if...else if... else, to a instruction switch in order that the output of the program stays the same.</p>\n\n<pre><code>void main()\n{\n    int x;\n    x = 1;\n    for (int i = 1; i &lt; 10; ++i) {\n        if (i &lt;= 3)\n            do {\n                x += i;\n                if (x &gt;= 4)\n                    break;\n            } while (i % 2 == 0);\n        else if ((i &gt; 3) &amp;&amp; (i &lt; 5))\n            x += 2;\n        else\n            continue;\n    }\n    while (x &gt; 0) {\n        printf(\" x=%d \", x);\n        x -= 1;\n    }\n    system(\"pause\");\n}\n</code></pre>\n\n<p>Am I allowed to do a switch inside of the for loop? </p>\n"}, {"tags": ["c", "arrays", "pointers"], "comments": [{"owner": {"reputation": 3972, "user_id": 9020340, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8stf0.png?s=128&g=1", "display_name": "ArunPratap", "link": "https://stackoverflow.com/users/9020340/arunpratap"}, "edited": false, "score": 1, "creation_date": 1530616263, "post_id": 51153119, "comment_id": 89289527, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/29486269/how-to-store-a-string-into-a-char-pointer\">How to store a string into a char pointer?</a>"}, {"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1530616477, "post_id": 51153119, "comment_id": 89289657, "body": "<code>string</code> contains the address of &quot;good&quot;.  The <code>%s</code> expects a pointer."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1530616678, "post_id": 51153119, "comment_id": 89289764, "body": "Dennis was drunk and, after the tenth tequila, decided that arrays would be treated totally differently to other types, so spawning billions of bugs over the decades:("}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1530616997, "post_id": 51153119, "comment_id": 89289946, "body": "Tl;dr: strings are treated as a bit of a special case in C."}, {"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "reply_to_user": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1530624480, "post_id": 51153119, "comment_id": 89294998, "body": "@MartinJames: Remember that C didn&#39;t spring fully formed from Ritchie&#39;s head - he derived it largely from B, and wanted to retain B&#39;s array semantics without materializing the pointer those semantics required (see <a href=\"https://heim.ifi.uio.no/inf2270/programmer/historien-om-C.pdf\" rel=\"nofollow noreferrer\">this paper</a> for details).  Honestly, a lot of C&#39;s weirdness can be traced back to B."}, {"owner": {"reputation": 198, "user_id": 9317706, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd96f97c58b306523bb8defb014daab6?s=128&d=identicon&r=PG&f=1", "display_name": "purec", "link": "https://stackoverflow.com/users/9317706/purec"}, "edited": false, "score": 0, "creation_date": 1530630751, "post_id": 51153119, "comment_id": 89299207, "body": "Try python, broh."}], "answers": [{"tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": false, "score": 3, "last_activity_date": 1530616418, "creation_date": 1530616418, "answer_id": 51153202, "question_id": 51153119, "link": "https://stackoverflow.com/questions/51153119/use-of-pointers-to-store-character-strings/51153202#51153202", "title": "Use of pointers to store character strings", "body": "<p>A literal string like <code>\"good\"</code> is really stored as a (read-only) <em>array</em> of characters. Also, all strings in C must be <em>terminated</em> with a special \"null\" character <code>'\\0'</code>.</p>\n\n<p>When you do the assingment</p>\n\n<pre><code>string = \"good\";\n</code></pre>\n\n<p>what is really happening is that you make <code>string</code> point to the <em>first</em> character in that array.</p>\n\n<p>Functions handling strings knows how to deal with pointers like that, and know how to loop over such arrays using the pointer to find all the characters in the string until it finds the terminator.</p>\n\n<hr>\n\n<p>Looking at it a little differently, the compile creates its array</p>\n\n<pre><code>char internal_array[] = { 'g', 'o', 'o', 'd', '\\0' };\n</code></pre>\n\n<p>then you make <code>string</code> point to the first element in the array</p>\n\n<pre><code>string = &amp;internal_array[0];\n</code></pre>\n\n<p>Note that <code>&amp;internal_array[0]</code> is actually equal to <code>internal_array</code>, since arrays naturally decays to pointers to their first element.</p>\n"}, {"tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": 1, "last_activity_date": 1530616584, "creation_date": 1530616584, "answer_id": 51153253, "question_id": 51153119, "link": "https://stackoverflow.com/questions/51153119/use-of-pointers-to-store-character-strings/51153253#51153253", "title": "Use of pointers to store character strings", "body": "<p><code>\"cccccc\"</code> is a string literal which is actually the char array stored in the ReadOnly memory. You assign the pointer to the address of the first character of this literal.</p>\n\n<p>if you want to copy string literal to the RAM you need to:</p>\n\n<pre><code>char string[] = \"fgdfdfgdfgf\";\n</code></pre>\n\n<p>Bare in mind that the array initialization (when you declare it) is the only place where you can use the <code>=</code> to copy the string literal to the char array (string).</p>\n\n<p>In any other circumstances you need to use the appropriate library function for example.</p>\n\n<pre><code> strcpy(string, \"asdf\");\n</code></pre>\n\n<p>(the <code>string</code> has to have enough space to accommodate the new string)</p>\n"}, {"tags": [], "owner": {"reputation": 9095, "user_id": 8542346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11b206b49cec657d28a5876f8330780e?s=128&d=identicon&r=PG&f=1", "display_name": "H.S.", "link": "https://stackoverflow.com/users/8542346/h-s"}, "is_accepted": false, "score": 0, "last_activity_date": 1530687067, "last_edit_date": 1530687067, "creation_date": 1530620747, "answer_id": 51154622, "question_id": 51153119, "link": "https://stackoverflow.com/questions/51153119/use-of-pointers-to-store-character-strings/51154622#51154622", "title": "Use of pointers to store character strings", "body": "<p>Your <strong>first</strong> question:<br>\n<em><code>What I don't understand is how are we able to assign a character string directly to the pointer? That too without address operator?</code></em></p>\n\n<p>A character string literal is a sequence of zero or more multibyte characters enclosed in double-quotes, for e.g. \"good\".</p>\n\n<p>From C Standard#6.4.5 [String literals]:</p>\n\n<blockquote>\n  <p>...The multibyte character sequence is then used to initialize an <strong><em>array of static storage duration</em></strong> and length just sufficient to contain the sequence. For character string literals, <strong><em>the array elements have type char</em></strong>, and are initialized with the individual bytes of the multibyte character sequence.....</p>\n</blockquote>\n\n<p>In C, an expression that has type <strong><em>array of type</em></strong> is converted to an expression with type <strong><em>pointer to type</em></strong> that points to the initial element of the array object <em>[there are few exceptions]</em>. Hence, the string literal which is an array decays into pointer which can be assigned to the type <code>char *</code>.</p>\n\n<p>In the statement:</p>\n\n<pre><code>string = \"good\";\n</code></pre>\n\n<p><code>string</code> will point to the initial character in the array where <code>\"good\"</code> is stored.</p>\n\n<p>Your <strong>second</strong> question:<br>\n<em><code>Also, how are we able to print the string without the indirection operator (*) ?</code></em></p>\n\n<p>From <strong><a href=\"https://en.cppreference.com/w/c/io/fprintf\" rel=\"nofollow noreferrer\">printf()</a></strong>:</p>\n\n<blockquote>\n  <p>s<br>\n  writes a character string<br>\n  The argument must be a <strong><em>pointer to the initial element of an array of characters</em></strong>... </p>\n</blockquote>\n\n<p>So, format specifier <code>%s</code> expect pointer to initial element which is what the variable <code>string</code> is - a pointer to initial character of <code>\"good\"</code>. Hence, you don't need indirection operator (*).</p>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 1, "last_activity_date": 1530631128, "last_edit_date": 1530631128, "creation_date": 1530630733, "answer_id": 51157897, "question_id": 51153119, "link": "https://stackoverflow.com/questions/51153119/use-of-pointers-to-store-character-strings/51157897#51157897", "title": "Use of pointers to store character strings", "body": "<blockquote>\n  <p>What I don't understand is how are we able to assign a character string directly to the pointer? That too without address operator?</p>\n</blockquote>\n\n<p>When an array is assigned to something, the array is converted to a pointer.</p>\n\n<p><code>\"good\"</code> is a <em>string literal</em>.  It has a <em>array 5 of char</em> which includes a trailing <em>null character</em>.  It exists in memory where write attempts should not be attempted.  Attempting to write is <em>undefined behavior</em>  (UB).  It might \"work\", it might not.  Code may die, etc.</p>\n\n<p><code>char *string;</code> <a href=\"https://cdecl.org/?q=char+*string\" rel=\"nofollow noreferrer\">declare string as pointer to char</a>.</p>\n\n<p><code>string = \"good\";</code> causes an assignment.  The operation takes <code>\"good\"</code> and converts that array to the address and type (<code>char*</code>) of its first element <code>'g'</code>.   Then assigns that <code>char *</code> to <code>string</code>.</p>\n\n<blockquote>\n  <p>Also, how are we able to print the string without the indirection operator (*) ?</p>\n</blockquote>\n\n<p><code>printf()</code> expects a <code>char *</code> - which matches the type of <code>string</code>.</p>\n\n<p><code>printf (\"%s\", string);</code> passes <code>string</code> to <code>printf()</code> as a <code>char *</code> - no conversion is made.  <code>printf (\"%s\",...</code> expects to see a  \"... the argument shall be a pointer to the initial element of an array of character type.\"  then \"Characters from the array are written up to (but not including) the terminating null character.\"  C11 \u00a77.21.6.1 8.</p>\n"}], "owner": {"reputation": 55, "user_id": 9363137, "user_type": "registered", "profile_image": "https://graph.facebook.com/1550365815080950/picture?type=large", "display_name": "Abhijit Singh", "link": "https://stackoverflow.com/users/9363137/abhijit-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1065, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1530687067, "creation_date": 1530616161, "question_id": 51153119, "link": "https://stackoverflow.com/questions/51153119/use-of-pointers-to-store-character-strings", "title": "Use of pointers to store character strings", "body": "<p>I started learning pointers in C. I understood it fine untill I came across the topic \"Using Pointers to store character arrays\".\nA sample program to highlight my doubt is as follows</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nmain()\n{\n  char *string;\n  string = \"good\"; \n  printf (\"%s\", string);\n}\n</code></pre>\n\n<p>This prints the character string, i.e, good.</p>\n\n<p>Pointers are supposed to store memory addresses, or in other words, we assign the adress of a variable (using the address operator) to a pointer variable.\nWhat I don't understand is how are we able to assign a character string directly to the pointer? That too without address operator?\nAlso, how are we able to print the string without the indirection operator (*) ? </p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1530616470, "post_id": 51153099, "comment_id": 89289653, "body": "When looking at a group of 4 teams, using qsort() might be a bit overkill. 3 manual comparisons should suffice (or maybe up to 5 in the worst case)"}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 10026142, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Yc8a8n6W_l8/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq3flnk3P5j3uYxYwlIuW-YqDtXL4w/mo/photo.jpg?sz=128", "display_name": "Jaclyn", "link": "https://stackoverflow.com/users/10026142/jaclyn"}, "edited": false, "score": 0, "creation_date": 1530690239, "post_id": 51156343, "comment_id": 89319608, "body": "I&#39;m actually a total beginner and at my university, we begin learning with C language. I&#39;m always looking to improve myself. Thank you for your suggestions. If you don&#39;t mind, could you please tell me what structs are? Thanks in advance!"}, {"owner": {"reputation": 1632, "user_id": 2429333, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5eb897104dc190de7ea7da0ac29a59ae?s=128&d=identicon&r=PG", "display_name": "pbn", "link": "https://stackoverflow.com/users/2429333/pbn"}, "reply_to_user": {"reputation": 29, "user_id": 10026142, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Yc8a8n6W_l8/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq3flnk3P5j3uYxYwlIuW-YqDtXL4w/mo/photo.jpg?sz=128", "display_name": "Jaclyn", "link": "https://stackoverflow.com/users/10026142/jaclyn"}, "edited": false, "score": 0, "creation_date": 1530704290, "post_id": 51156343, "comment_id": 89328194, "body": "There is a great book, frequently mentioned here, called The C Programming Language (sometimes called K&amp;R) from Brian Kernighan and Dennis Ritchie.  You can find a lot of information there about C (including structs)."}], "tags": [], "owner": {"reputation": 1632, "user_id": 2429333, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5eb897104dc190de7ea7da0ac29a59ae?s=128&d=identicon&r=PG", "display_name": "pbn", "link": "https://stackoverflow.com/users/2429333/pbn"}, "is_accepted": true, "score": 0, "last_activity_date": 1530625874, "creation_date": 1530625874, "answer_id": 51156343, "question_id": 51153099, "link": "https://stackoverflow.com/questions/51153099/arranging-strings-names-of-teams-in-order-of-points-obtained-by-team/51156343#51156343", "title": "Arranging strings names of teams in order of points obtained by team", "body": "<p>You should compare teams by amount of points earned. I initialized state by assigning that the first and the second team are candidates for next stage. After that all you have to do is to compare whether there is some other team with higher score. If you have found new highest score you need to reassign both first and second team. If you have found a new 2nd place candidate you need to reassign only the second place. </p>\n\n<pre><code>void advance(char team[][20], int group[][7])\n{ /*Identify top 2 teams to advance and print name of teams */\n\n  int i, j;\n  int max;\n\n  int max_id = 0;\n  int max_id_prev = 1;\n\n  puts(\"\\tAdvance\");\n\n  for(i = 1; i &lt; NUMBER; i++) {\n    if (group[max_id][5] &lt; group[i][5]) {\n       max_id_prev = max_id;\n       max_id = i;\n       continue;\n    }\n    if (group[max_id_prev][5] &lt; group[i][5]) {\n       max_id_prev = i;\n    }\n   }\n  printf(\"%s\", team[max_id]);\n  printf(\"%s\", team[max_id_prev]);\n}\n</code></pre>\n\n<p>Please consider doing a peer review of your code or post your code on <a href=\"https://codereview.stackexchange.com/\">Code review</a>. Also consider organizing your code with structs as representations of the data you have. It will improve readability. There are many books on how to write clean, readable code. </p>\n"}], "owner": {"reputation": 29, "user_id": 10026142, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Yc8a8n6W_l8/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq3flnk3P5j3uYxYwlIuW-YqDtXL4w/mo/photo.jpg?sz=128", "display_name": "Jaclyn", "link": "https://stackoverflow.com/users/10026142/jaclyn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 51156343, "answer_count": 1, "score": 0, "last_activity_date": 1530625874, "creation_date": 1530616116, "question_id": 51153099, "link": "https://stackoverflow.com/questions/51153099/arranging-strings-names-of-teams-in-order-of-points-obtained-by-team", "title": "Arranging strings names of teams in order of points obtained by team", "body": "<p>I have this project where I am supposed to write a code whereby we enter the names of the country competing in the world cup (1 group, 4 countries) and what each country scored. Then, the program has to print the scores and which two teams are to advance to the next stage like \"1st team to advance is %s.\" and it prints the name of the team with the highest score followed by \"2nd team to advance is %s.\" , printing the country with the 2nd highest score. I can't for the life of me figure out how to write the part where the program prints which country advances to the next stage.</p>\n\n<pre><code>#include &lt;stdio.h&gt; \n#include &lt;stdlib.h&gt; \n\n#define NUMBER 4 \n\nvoid setTeam(char team[NUMBER][20]) /*Names of team in particular group*/\n{ \n\n setvbuf(stdout, NULL, _IONBF, 0); \n\n int i;\n for(i=0;i&lt;NUMBER;i++){ \n  printf(\"Enter name of team %d: \", i); \n  scanf(\"%s\", &amp;team[i]); \n } \n\n for(i=0;i&lt;NUMBER;i++){  /*print name of teams entered*/\n      printf(\"team[%d]=\\\" %s\\\"\\n\", i, team[i]); \n } \n} \n\nvoid input(char team[NUMBER][20],int group[NUMBER][7]){  /*Enter goals scored \nto calculate Wins, Draws, Loss, GF, GA, GD and PTS */\n\n  int score_i, score_j;\n  int i, j; \n  for(i=0;i&lt;NUMBER-1;i++){ \n      for(j=i+1;j&lt;NUMBER;j++){ \n          printf(\"%s vs %s\\n\",team[i],team[j]); \n\n          printf(\"%s :\",team[i]); scanf(\"%d\", &amp;score_i); \n\n          group[i][3] += score_i;\n\n          printf(\"%s :\",team[j]); scanf(\"%d\", &amp;score_j); \n\n          group[j][3] += score_j;\n\n          group[i][4] += score_j;\n          group[j][4] += score_i;\n\n          if (score_i == score_j)\n          {\n                group[i][1] += 1;\n                group[j][1] += 1;\n          } else if (score_i &gt; score_j) {\n               group[i][0] += 1;\n               group[j][2] += 1;\n          } else {\n               group[j][0] += 1;\n               group[i][2] += 1;\n          }\n\n          group[i][5] += judge(score_i, score_j);\n          group[j][5] += judge(score_j, score_i);\n          group[i][6] = group[i][3] - group[i][4];\n          group[j][6] = group[j][3] - group[j][4];\n      } \n  }\n} \n\nint judge(int gain, int loss)\n{\n\n   if (gain == loss || loss == gain)\n        return 1;\n   else if (gain &gt; loss)\n        return 3;\n   else\n       return 0;\n } \n\nint display(char team[NUMBER][20], int group[NUMBER][7])\n{ /*Print results*/\n\n  puts(\"\\n\\tTeam, \\t\\tWin,    Draws,   Loss,    GF,    GA,     GD,    PTS\");  \n\n  int i, j;  \n\n  for(i=0;i &lt; NUMBER;i++){  \n\n      printf(\"\\t%-10s,\\t%3d,\\t%8d,\\t%d,\\t%2d,\\t%3d,\\t%5d,\\t%9d\\n\", \n      team[i],group[i][0],group[i][1],group[i][2],group[i][3],group[i] \n      [4],group[i][5],group[i][6]); \n  } \n  putchar('\\n');\n} \n\nvoid advance(char team[][20], int group[][7])\n{ /*Identify top 2 teams to advance and print name of teams */\n\n  int i, j;\n  int max;\n  char temp[NUMBER][20];\n\n  puts(\"\\tAdvance\");\n\n  for(i = 0; i &lt; NUMBER; i++) {\n        for(j = i + 1; j &lt; NUMBER; j++) {\n                if (group[i][3] &lt; group[j][3]) {\n                     max = group[i][3];\n                     group[i][3] = group[j][3];\n                     group[j][3] = max;\n\n                 }\n        }\n   }\n\n\n}\n\n\n\nint main(void)\n{ \n\n int group[NUMBER][7] = {0}; \n int i,j; \n char team[NUMBER][20]; \n\n setTeam(team); \n input(team, group); \n display(team, group); \n advance(team, group);\n\n return 0; \n} \n</code></pre>\n"}, {"tags": ["c", "gcc", "openmp", "simd", "auto-vectorization"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1530616131, "post_id": 51152215, "comment_id": 89289440, "body": "Suggestion: if you are to invent yet another home-brewn macro language for defining functions, then at least use &quot;X macros&quot; that&#39;s a somewhat well-known technique."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1530623868, "post_id": 51152215, "comment_id": 89294560, "body": "@\u674e\u54f2\u6e90 Basically you could use it to define a list of all things that need to be changed and only maintain it from a single place. The down-side is that the code turns harder to read, but that&#39;s also true for any other form of macro-magic."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1530623900, "post_id": 51152215, "comment_id": 89294587, "body": "Btw all pragmas are non-portable. Some just have wider compiler support than others."}, {"owner": {"reputation": 29002, "user_id": 2542702, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fW5ka.jpg?s=128&g=1", "display_name": "Z boson", "link": "https://stackoverflow.com/users/2542702/z-boson"}, "edited": false, "score": 0, "creation_date": 1530625060, "post_id": 51152215, "comment_id": 89295394, "body": "@\u674e\u54f2\u6e90 Just use auto-vectorization (<code>-O3</code> for GCC, ICC, and Clang) and don&#39;t worry about <code>omp simd</code>. I would only use <code>omp simd</code> if I found it was better than auto-vectorization."}, {"owner": {"reputation": 530, "user_id": 2394541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f9b9b9399b329591f7be92da1c5e442?s=128&d=identicon&r=PG", "display_name": "tim18", "link": "https://stackoverflow.com/users/2394541/tim18"}, "edited": false, "score": 0, "creation_date": 1530635529, "post_id": 51152215, "comment_id": 89301818, "body": "omp simd aligned should be portable.   Gcc will still require ffast-math to enable simd reduction so it&#39;s not portable in the sense that gcc doesn&#39;t have an option to enable fast-math for a loop simply by setting omp simd.  Without aligned, the effect of omp simd in gcc is much the same as local restrict qualifiers which aren&#39;t needed for reduction.  There may be a limit on how many reductions are optimized in a single for().."}, {"owner": {"reputation": 29002, "user_id": 2542702, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fW5ka.jpg?s=128&g=1", "display_name": "Z boson", "link": "https://stackoverflow.com/users/2542702/z-boson"}, "edited": false, "score": 0, "creation_date": 1530693687, "post_id": 51152215, "comment_id": 89321422, "body": "@\u674e\u54f2\u6e90 I would not worry about data alignment. It&#39;s not really an issue since <a href=\"https://en.wikipedia.org/wiki/Nehalem_(microarchitecture)\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Nehalem_(microarchitecture)</a>. I don&#39;t remember when it stopped being an issue for AMD.  Clang and ICC will generated the unaligned instructions now anyway. GCC still creates more code than it needs to but unless you have evidence that that has an impact I would not worry about it."}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1536382566, "post_id": 51152215, "comment_id": 91413595, "body": "I thought dead code elimination was engaged with <code>-ffunction-sections, -fdata-sections</code> compiler options and <code>-Wl,--gc-sections</code> linker option (Apple linkers use <code>-Wl,-dead_code</code>)."}], "answers": [{"comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1536440751, "post_id": 52230374, "comment_id": 91427364, "body": "<i>I only do SIMD when the operation is hot on L1 cache (i.e., it is CPU-bound not memory-bound)</i>  That&#39;s exactly when <code>-mavx256-split-unaligned-load</code> does matter most, because it uses more instructions to get the same work done.  (But at least it doesn&#39;t bottleneck on the shuffle port, because <code>vinsertf128 ymm, m128, imm8</code> is 2 uops for any ALU port + a load port.  <a href=\"https://agner.org/optimize/\" rel=\"nofollow noreferrer\">agner.org/optimize</a>).  Anyway, if your code actually will be running mostly on Haswell and later, <code>-mtune=haswell</code> is a good idea.  (Or <code>-march=native</code> for people building on their own computer)."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1536440976, "post_id": 52230374, "comment_id": 91427415, "body": "But if all the important loops over aligned data tell the compiler about that alignment (with OpenMP or <code>p = __builtin_assume_aligned(p, 64);</code>, or <code>_mm256_load_ps</code>)  then your code-gen will be fine.  Still, your unaligned loops may suffer slightly from using 3 uops instead of 1 to load a vector, especially if their inputs sometimes do happen to be aligned."}, {"owner": {"reputation": 58770, "user_id": 4891738, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/kE2lh.jpg?s=128&g=1", "display_name": "\u674e\u54f2\u6e90", "link": "https://stackoverflow.com/users/4891738/%e6%9d%8e%e5%93%b2%e6%ba%90"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1536441608, "post_id": 52230374, "comment_id": 91427579, "body": "@PeterCordes Thanks Peter. I don&#39;t have full control on compiler flags. I could only write a vignette or something suggesting users to customize their personal Makevar if they want the best performance. I could advise them to turn on <code>-mavx256-split-unaligned-load</code> if they use GCC. Actually, I don&#39;t like split load, either. More instructions to read when inspecting ASM; annoying."}], "tags": [], "owner": {"reputation": 58770, "user_id": 4891738, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/kE2lh.jpg?s=128&g=1", "display_name": "\u674e\u54f2\u6e90", "link": "https://stackoverflow.com/users/4891738/%e6%9d%8e%e5%93%b2%e6%ba%90"}, "is_accepted": true, "score": 2, "last_activity_date": 1536428545, "last_edit_date": 1536428545, "creation_date": 1536359911, "answer_id": 52230374, "question_id": 51152215, "link": "https://stackoverflow.com/questions/51152215/256-bit-vectorization-via-openmp-simd-prevents-compilers-optimization-say-func/52230374#52230374", "title": "256-bit vectorization via OpenMP SIMD prevents compiler&#39;s optimization (say function inlining)?", "body": "<p>I desperately needed to resolve this issue, because in my real C project, if no template trick were used for auto generation of different function versions (simply called \"versioning\" hereafter), I would need to write a total of 1400 lines of code for 9 different versions, instead of just 200 lines for a single template.</p>\n\n<p>I was able to find a way out, and am now posting a solution using the toy example in the question.</p>\n\n<hr>\n\n<p>I planed to utilize an <em>inline</em> function <code>sum_template</code> for versioning. If successful, it occurs at compile time when a compiler performs optimization. However, OpenMP pragma turns out to fail this compile time versioning. The option is then to do versioning at the pre-processing stage using <em>macros</em> only.</p>\n\n<p>To get rid of the <em>inline</em> function <code>sum_template</code>, I manually inline it in the macro <code>macro_define_sum</code>:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n\n// j can be 0 or 1\n#define macro_define_sum(FUN, j)                            \\\nvoid FUN (size_t n, double *A, double *c) {                 \\\n  if (n == 0) return;                                       \\\n  size_t i;                                                 \\\n  double *a = A, * b = A + n;                               \\\n  double c0 = 0.0, c1 = 0.0;                                \\\n  #pragma omp simd reduction (+: c0, c1) aligned (a, b: 32) \\\n  for (i = 0; i &lt; n; i++) {                                 \\\n    c0 += a[i];                                             \\\n    if (j &gt; 0) c1 += b[i];                                  \\\n    }                                                       \\\n  c[0] = c0;                                                \\\n  if (j &gt; 0) c[1] = c1;                                     \\\n  }\n\nmacro_define_sum(sum_0, 0)\nmacro_define_sum(sum_1, 1)\n</code></pre>\n\n<p>In this <em>macro</em>-only version, <code>j</code> is directly substituted by 0 or 1 at during macro expansion. Whereas in the <em>inline</em> function + <em>macro</em> approach in the question, I only have <code>sum_template(0, n, a, b, c)</code> or <code>sum_template(1, n, a, b, c)</code> at pre-processing stage, and <code>j</code> in the body of <code>sum_template</code> is only propagated at the later compile time.</p>\n\n<p>Unfortunately, the above <em>macro</em> gives error. I can not define or test a macro inside another (see <a href=\"https://stackoverflow.com/q/10074520/4891738\">1</a>, <a href=\"https://stackoverflow.com/q/48431325/4891738\">2</a>, <a href=\"https://stackoverflow.com/q/32774678/4891738\">3</a>). The OpenMP pragma starting with <code>#</code> is causing problem here. So I have to split this template into two parts: the part before the pragma and the part after.</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n\n#define macro_before_pragma   \\\n  if (n == 0) return;         \\\n  size_t i;                   \\\n  double *a = A, * b = A + n; \\\n  double c0 = 0.0, c1 = 0.0;\n\n#define macro_after_pragma(j) \\\n  for (i = 0; i &lt; n; i++) {   \\\n    c0 += a[i];               \\\n    if (j &gt; 0) c1 += b[i];    \\\n    }                         \\\n  c[0] = c0;                  \\\n  if (j &gt; 0) c[1] = c1;\n\nvoid sum_0 (size_t n, double *A, double *c) {\n  macro_before_pragma\n  #pragma omp simd reduction (+: c0) aligned (a: 32)\n  macro_after_pragma(0)\n  }\n\nvoid sum_1 (size_t n, double *A, double *c) {\n  macro_before_pragma\n  #pragma omp simd reduction (+: c0, c1) aligned (a, b: 32)\n  macro_after_pragma(1)\n  }\n</code></pre>\n\n<p>I no long need <code>macro_define_sum</code>. I can define <code>sum_0</code> and <code>sum_1</code> straightaway using the defined two macros. I can also adjust the pragma appropriately. Here instead of having a template function, I have templates for code blocks of a function and can reuse them with ease.</p>\n\n<p>The compiler output is as expected in this case (<a href=\"https://gcc.godbolt.org/z/csj5-t\" rel=\"nofollow noreferrer\">Check it on Godbolt</a>).</p>\n\n<hr>\n\n<h3>Update</h3>\n\n<p>Thanks for the various feedback; they are all very constructive (this is why I love Stack Overflow).</p>\n\n<p>Thanks <a href=\"https://stackoverflow.com/users/1918193/marc-glisse\">Marc Glisse</a> for point me to <a href=\"https://stackoverflow.com/q/6627462/4891738\">Using an openmp pragma inside #define</a>. Yeah, it was my bad to not have searched this issue. <code>#pragma</code> is an directive, not a real macro, so there must be some way to put it inside a macro. Here is the neat version using the <code>_Pragma</code> operator:</p>\n\n<pre><code>/* \"neat.c\" */\n#include &lt;stdlib.h&gt;\n\n// stringizing: https://gcc.gnu.org/onlinedocs/cpp/Stringizing.html\n#define str(s) #s\n\n// j can be 0 or 1\n#define macro_define_sum(j, alignment)                                   \\\nvoid sum_ ## j (size_t n, double *A, double *c) {                        \\\n  if (n == 0) return;                                                    \\\n  size_t i;                                                              \\\n  double *a = A, * b = A + n;                                            \\\n  double c0 = 0.0, c1 = 0.0;                                             \\\n  _Pragma(str(omp simd reduction (+: c0, c1) aligned (a, b: alignment))) \\\n  for (i = 0; i &lt; n; i++) {                                              \\\n    c0 += a[i];                                                          \\\n    if (j &gt; 0) c1 += b[i];                                               \\\n    }                                                                    \\\n  c[0] = c0;                                                             \\\n  if (j &gt; 0) c[1] = c1;                                                  \\\n  }\n\nmacro_define_sum(0, 32)\nmacro_define_sum(1, 32)\n</code></pre>\n\n<p>Other changes include:</p>\n\n<ul>\n<li>I used <a href=\"https://gcc.gnu.org/onlinedocs/cpp/Concatenation.html#Concatenation\" rel=\"nofollow noreferrer\">token concatenation</a> to generate function name;</li>\n<li><code>alignment</code> is made a macro argument. For AVX, a value of 32 means good alignment, while a value of 8 (<code>sizeof(double)</code>) essentially implies no alignment. <a href=\"https://gcc.gnu.org/onlinedocs/cpp/Stringizing.html\" rel=\"nofollow noreferrer\">Stringizing</a> is required to parse those tokens into strings that <code>_Pragma</code> requires.</li>\n</ul>\n\n<p>Use <code>gcc -E neat.c</code> to inspect pre-processing result. Compilation gives desired assembly output (<a href=\"https://gcc.godbolt.org/z/9Vle-Y\" rel=\"nofollow noreferrer\">Check it on Godbolt</a>).</p>\n\n<hr>\n\n<h3>A few comments on Peter Cordes informative answer</h3>\n\n<p><strong>Using complier's function attributes.</strong> I am not a professional C programmer. My experiences with C come merely from writing R extensions. The development environment determines that I am not very familiar with compiler attributes. I know some, but don't really use them.</p>\n\n<p><code>-mavx256-split-unaligned-load</code> is not an issue in my application, because I will allocate aligned memory and apply padding to ensure alignment. I just need to promise compiler of the alignment so that it can generate aligned load / store instructions. I do need to do some vectorization on unaligned data, but that contributes to a very limited part of the whole computation. Even if I get a performance penalty on split unaligned load it won't be noticed in reality. I also don't compiler every C file with auto vectorization. I only do SIMD when the operation is hot on L1 cache (i.e., it is CPU-bound not memory-bound). By the way, <code>-mavx256-split-unaligned-load</code> is for <em>GCC</em>; what is it for other compilers?</p>\n\n<p>I am aware of the difference between <code>static inline</code> and <code>inline</code>. If an <code>inline</code> function is only accessed by one file, I will declare it as <code>static</code> so that compiler does not generate a copy of it.</p>\n\n<p>OpenMP SIMD can do reduction efficiently even without <em>GCC</em>'s <code>-ffast-math</code>. However, it does not use horizontal addition to aggregate results inside the accumulator register in the end of the reduction; it runs a scalar loop to add up each double word (see code block .L5 and .L27 in <a href=\"https://gcc.godbolt.org/z/9Vle-Y\" rel=\"nofollow noreferrer\">Godbolt output</a>).</p>\n\n<p>Throughput is a good point (especially for floating-point arithmetics which has relatively big latency but high throughput). My real C code where SIMD is applied is a triple loop nest. I unroll outer two loops to enlarge the code block in the innermost loop to enhance throughput. Vectorization of the innermost one is then sufficient. With the toy example in this Q &amp; A where I just sum an array, I can use <code>-funroll-loops</code> to ask <em>GCC</em> for loop unrolling, using several accumulators to enhance throughput.</p>\n\n<hr>\n\n<h3>On this Q &amp; A</h3>\n\n<p>I think most people would treat this Q &amp; A in a more technical way than me. They might be interested in using compiler attributes or tweaking compiler flags / parameters to force function inlining. Therefore, Peter's answer as well as Marc's comment under the answer is still very valuable. Thanks again.</p>\n"}, {"comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 58770, "user_id": 4891738, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/kE2lh.jpg?s=128&g=1", "display_name": "\u674e\u54f2\u6e90", "link": "https://stackoverflow.com/users/4891738/%e6%9d%8e%e5%93%b2%e6%ba%90"}, "edited": false, "score": 0, "creation_date": 1536369725, "post_id": 52231174, "comment_id": 91411925, "body": "@\u674e\u54f2\u6e90: IDK if I missed this when it was first posted, or if I just didn&#39;t have time to read it and think of the <code>__attribute__</code>.  Anyway, my answer already includes the <code>#ifdef</code> block that portably defines <code>ALWAYS_INLINE</code> for GNU compilers (gcc/clang/icc) and MSVC, which covers most of the mainstream.  Other compilers are on their own, and the regular <code>inline</code> keyword hopefully helps them enough."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 58770, "user_id": 4891738, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/kE2lh.jpg?s=128&g=1", "display_name": "\u674e\u54f2\u6e90", "link": "https://stackoverflow.com/users/4891738/%e6%9d%8e%e5%93%b2%e6%ba%90"}, "edited": false, "score": 1, "creation_date": 1536370517, "post_id": 52231174, "comment_id": 91412001, "body": "@\u674e\u54f2\u6e90: <code>-mavx256-split-unaligned-load</code> is always worse if the data is aligned at runtime.  It&#39;s a win on Sandybridge/IvyBridge (and maybe some AMD) if the data is misaligned at runtime, but it&#39;s always a loss on Haswell and later (which are increasingly more common).  This is one reason why it can help to promise alignment at compile time in cases where it&#39;s true.  But a function that <i>normally</i> sees aligned data, but should still work with unaligned at a small speed penalty, shouldn&#39;t be compiled with this tuning option."}, {"owner": {"reputation": 6533, "user_id": 1918193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b70a14318e0f417ecac47809f38fafc?s=128&d=identicon&r=PG", "display_name": "Marc Glisse", "link": "https://stackoverflow.com/users/1918193/marc-glisse"}, "edited": false, "score": 1, "creation_date": 1536406133, "post_id": 52231174, "comment_id": 91418298, "body": "<code>--param large-stack-frame=512</code> lets it inline, but that&#39;s cheating. Otherwise, if you add some (hot) callers, the compiler will notice that sum_0 and sum_1 are worth spending some space on, and it will clone sum_template based on the constant parameters passed as arguments (IPA-CP)."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 6533, "user_id": 1918193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b70a14318e0f417ecac47809f38fafc?s=128&d=identicon&r=PG", "display_name": "Marc Glisse", "link": "https://stackoverflow.com/users/1918193/marc-glisse"}, "edited": false, "score": 0, "creation_date": 1536406514, "post_id": 52231174, "comment_id": 91418394, "body": "@MarcGlisse: hot as in <code>-fprofile-use</code>?  Thanks for the tip about which other heuristic is making it not inline."}, {"owner": {"reputation": 6533, "user_id": 1918193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b70a14318e0f417ecac47809f38fafc?s=128&d=identicon&r=PG", "display_name": "Marc Glisse", "link": "https://stackoverflow.com/users/1918193/marc-glisse"}, "edited": false, "score": 1, "creation_date": 1536406648, "post_id": 52231174, "comment_id": 91418422, "body": "<code>--param ipa-cp-eval-threshold=100</code> is a way to play with the IPA-CP heuristics. But really you want to increase what gcc thinks of as &quot;frequency&quot;. I am using <code>-fdump-ipa-all-all</code> to see more information. <code>-fprofile-use</code> could be one way, but even just adding a function that calls sum_0 in a loop is sufficient."}, {"owner": {"reputation": 6533, "user_id": 1918193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b70a14318e0f417ecac47809f38fafc?s=128&d=identicon&r=PG", "display_name": "Marc Glisse", "link": "https://stackoverflow.com/users/1918193/marc-glisse"}, "edited": false, "score": 0, "creation_date": 1536407003, "post_id": 52231174, "comment_id": 91418525, "body": "Playing with the parameters, I sometimes get into the silly situation where gcc clones the static function, but then refuses to inline those clones into their unique caller..."}, {"owner": {"reputation": 530, "user_id": 2394541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f9b9b9399b329591f7be92da1c5e442?s=128&d=identicon&r=PG", "display_name": "tim18", "link": "https://stackoverflow.com/users/2394541/tim18"}, "edited": false, "score": 1, "creation_date": 1536409016, "post_id": 52231174, "comment_id": 91419016, "body": "Ivy Bridge designers made a specific effort to reduce the penalty for unaligned 256-bit loads, so the splitting isn&#39;t generally recommended unless your full performance support requirements go back to Sandy Bridge."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 530, "user_id": 2394541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f9b9b9399b329591f7be92da1c5e442?s=128&d=identicon&r=PG", "display_name": "tim18", "link": "https://stackoverflow.com/users/2394541/tim18"}, "edited": false, "score": 0, "creation_date": 1536439008, "post_id": 52231174, "comment_id": 91426984, "body": "@tim18: IMO gcc should really not enable that as a default tuning.  And/or have <code>-mavx2</code> affect tuning options as well as instruction-sets.  Unless it&#39;s a huge deal on AMD, it&#39;s just hurting modern CPUs for little benefit, or no benefit when code does align arrays at runtime but neglects to tell the compiler about it.  (Although <code>malloc</code> for large buffers does give <code>4096+16</code> alignment, keeping the first 16 bytes of a new page for bookkeeping, so always misaligned by 32 and 64 is common in software that doesn&#39;t try to align buffers.)"}, {"owner": {"reputation": 530, "user_id": 2394541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f9b9b9399b329591f7be92da1c5e442?s=128&d=identicon&r=PG", "display_name": "tim18", "link": "https://stackoverflow.com/users/2394541/tim18"}, "edited": false, "score": 0, "creation_date": 1536533031, "post_id": 52231174, "comment_id": 91446531, "body": "I&#39;m not aware of current thinking on whether -mavx2 should be equivalent to -march=haswell.  It seems the latter should do as well as the combination -mtune=haswell -mavx2.  Certainly, the Intel compilers combine the dropping of split loads with the enabling of avx2.  You could create a missed optimization bugzilla with a self-contained benchmark which people would be welcome to try on the CPUs of their choice."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 530, "user_id": 2394541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f9b9b9399b329591f7be92da1c5e442?s=128&d=identicon&r=PG", "display_name": "tim18", "link": "https://stackoverflow.com/users/2394541/tim18"}, "edited": false, "score": 0, "creation_date": 1536533702, "post_id": 52231174, "comment_id": 91446635, "body": "@tim18: it shouldn&#39;t imply <code>-march=haswell</code>.  Ideally it should optimize for Haswell/Skylake and Ryzen.  (And maybe Excavator).  But it should not care about Silvermont, or earlier Bulldozer or K10 (so no rep ret), or Sandybridge.  And it should definitely assume macro-fusion for keeping cmp/jcc together, unlike tune=generic.  Along with the actual AVX-related tuning stuff, such as shuffles being only 1 per clock on Intel, and lane-crossing shuffles with elements smaller than 128-bit being expensive for throughput (on Ryzen).   <a href=\"https://gcc.gnu.org/bugzilla/show_bug.cgi?id=80568\" rel=\"nofollow noreferrer\">gcc.gnu.org/bugzilla/show_bug.cgi?id=80568</a>"}], "tags": [], "owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "is_accepted": false, "score": 2, "last_activity_date": 1536369182, "creation_date": 1536369182, "answer_id": 52231174, "question_id": 51152215, "link": "https://stackoverflow.com/questions/51152215/256-bit-vectorization-via-openmp-simd-prevents-compilers-optimization-say-func/52231174#52231174", "title": "256-bit vectorization via OpenMP SIMD prevents compiler&#39;s optimization (say function inlining)?", "body": "<p><strong>The simplest way to solve this problem is with <code>__attribute__((always_inline))</code></strong>, or other compiler-specific overrides.</p>\n\n<pre><code>#ifdef __GNUC__\n#define ALWAYS_INLINE __attribute__((always_inline)) inline\n#elif defined(_MSC_VER)\n#define ALWAYS_INLINE __forceinline inline\n#else\n#define ALWAYS_INLINE  inline  // cross your fingers\n#endif\n\n\nALWAYS_INLINE\nstatic inline void sum_template (size_t j, size_t n, double *A, double *c) {\n ...\n}\n</code></pre>\n\n<p><a href=\"https://gcc.godbolt.org/#g:!((g:!((g:!((h:codeEditor,i:(j:1,lang:___c,source:&#39;/*+%22test.c%22+*/%0A%23include+%3Cstdlib.h%3E%0A%0A%23ifdef+__GNUC__%0A%23define+ALWAYS_INLINE+__attribute__((always_inline))+inline%0A%23elif+defined(_MSC_VER)%0A%23define+ALWAYS_INLINE+__forceinline+inline%0A%23else%0A%23define+ALWAYS_INLINE++inline++//+cross+your+fingers%0A%23endif%0A%0A//+j+can+be+0+or+1%0AALWAYS_INLINE%0Astatic+void+sum_template+(size_t+j,+size_t+n,+double+*A,+double+*c)+%7B%0A++if+(n+%3D%3D+0)+return%3B%0A%0A++double+*a+%3D+A,+*b+%3D+A+%2B+n%3B%0A++double+c0+%3D+0.0,+c1+%3D+0.0%3B%0A%0A++%23pragma+omp+simd+reduction+(%2B:+c0,+c1)+aligned+(a,+b:+32)%0A++for+(size_t+i+%3D+0%3B+i+%3C+n%3B+i%2B%2B)+%7B%0A++++c0+%2B%3D+a%5Bi%5D%3B%0A++++if+(j+%3E+0)+%0A++++++c1+%2B%3D+b%5Bi%5D%3B%0A++%7D%0A%0A++c%5B0%5D+%3D+c0%3B%0A++if+(j+%3E+0)+++++c%5B1%5D+%3D+c1%3B%0A%7D%0A%0A%23define+macro_define_sum(FUN,+j)++++++++++++%5C%0Avoid+FUN+(size_t+n,+double+*A,+double+*c)+%7B+%5C%0A++sum_template(j,+n,+A,+c)%3B+++++++++++++++++%5C%0A++%7D%0A%0Amacro_define_sum(sum_0,+0)%0Amacro_define_sum(sum_1,+1)%0A&#39;),l:&#39;5&#39;,n:&#39;0&#39;,o:&#39;C+source+%231&#39;,t:&#39;0&#39;)),k:50,l:&#39;4&#39;,n:&#39;0&#39;,o:&#39;&#39;,s:0,t:&#39;0&#39;),(g:!((h:compiler,i:(compiler:cg82,filters:(b:&#39;0&#39;,binary:&#39;1&#39;,commentOnly:&#39;0&#39;,demangle:&#39;0&#39;,directives:&#39;0&#39;,execute:&#39;1&#39;,intel:&#39;1&#39;,trim:&#39;1&#39;),lang:___c,libs:!(),options:&#39;-xc+-O3+-mavx+-fopenmp+-mtune%3Dhaswell+-finline-limit%3D90000&#39;,source:1),l:&#39;5&#39;,n:&#39;0&#39;,o:&#39;x86-64+gcc+8.2+(Editor+%231,+Compiler+%231)+C&#39;,t:&#39;0&#39;)),k:50,l:&#39;4&#39;,n:&#39;0&#39;,o:&#39;&#39;,s:0,t:&#39;0&#39;)),l:&#39;2&#39;,n:&#39;0&#39;,o:&#39;&#39;,t:&#39;0&#39;)),version:4\" rel=\"nofollow noreferrer\">Godbolt proof that it works.</a></p>\n\n<p>Also, don't forget to use <code>-mtune=haswell</code>, not just <code>-mavx</code>.  It's usually a good idea.  (However, promising aligned data will stop gcc's default <code>-mavx256-split-unaligned-load</code> tuning from splitting 256-bit loads into 128-bit <code>vmovupd</code> + <code>vinsertf128</code>, so code gen for <em>this</em> function is fine with tune=haswell.  But normally you want this for gcc to auto-vectorize any other functions.</p>\n\n<p>You don't really need <code>static</code> along with <code>inline</code>; if a compiler decides not to inline it, it can at least share the same definition across compilation units.</p>\n\n<hr>\n\n<p>Normally gcc decides to inline or not according to function-size heuristics.  But even setting <code>-finline-limit=90000</code> doesn't get gcc to inline with your <code>#pragma omp</code> (<a href=\"https://stackoverflow.com/questions/8381293/how-do-i-force-gcc-to-inline-a-function/8464470#8464470\">How do I force gcc to inline a function?</a>).  I had been guessing that gcc didn't realize that constant-propagation after inlining would simplify the conditional, but 90000 \"pseudo-instructions\" seems plenty big.  There could be other heuristics.</p>\n\n<p>Possibly OpenMP sets some per-function stuff differently in ways that could break the optimizer if it let them inline into other functions.  Using <code>__attribute__((target(\"avx\")))</code> stops that function from inlining into functions compiled without AVX (so you can do runtime dispatching safely, without inlining \"infecting\" other functions with AVX instructions across <code>if(avx)</code> conditions.)</p>\n\n<p>One thing OpenMP does that you don't get with regular auto-vectorization is that reductions can be vectorized without enabling <code>-ffast-math</code>.</p>\n\n<p>Unfortunately OpenMP still doesn't bother to unroll with multiple accumulators or anything to hide FP latency.  <code>#pragma omp</code> is a pretty good hint that a loop is actually hot and worth spending code-size on, so gcc should really do that, even without <code>-fprofile-use</code>.</p>\n\n<p>So especially if this ever runs on data that's hot in L2 or L1 cache (or maybe L3), you should do something to get better throughput.</p>\n\n<p>And BTW, alignment isn't usually a huge deal for AVX on Haswell.  But 64-byte alignment does matter a lot more in practice for AVX512 on SKX.  Like maybe 20% slowdown for misaligned data, instead of a couple %.</p>\n\n<p>(But promising alignment at compile time is a separate issue from actually having your data aligned at runtime.  Both are helpful, but promising alignment at compile time makes tighter code with gcc7 and earlier, or on any compiler without AVX.)</p>\n"}], "owner": {"reputation": 58770, "user_id": 4891738, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/kE2lh.jpg?s=128&g=1", "display_name": "\u674e\u54f2\u6e90", "link": "https://stackoverflow.com/users/4891738/%e6%9d%8e%e5%93%b2%e6%ba%90"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2964, "favorite_count": 1, "accepted_answer_id": 52230374, "answer_count": 2, "score": 6, "last_activity_date": 1536428545, "creation_date": 1530613448, "last_edit_date": 1536359906, "question_id": 51152215, "link": "https://stackoverflow.com/questions/51152215/256-bit-vectorization-via-openmp-simd-prevents-compilers-optimization-say-func", "title": "256-bit vectorization via OpenMP SIMD prevents compiler&#39;s optimization (say function inlining)?", "body": "<p>Consider the following toy example, where <code>A</code> is an <code>n x 2</code> matrix stored in column-major order and I want to compute its column sum. <code>sum_0</code> only computes sum of the 1st column, while <code>sum_1</code> does the 2nd column as well. This is really an artificial example, as there is essentially no need to define two functions for this task (I can write a single function with a double loop nest where the outer loop iterates from <code>0</code> to <code>j</code>). It is constructed to demonstrate the template problem I have in reality.</p>\n\n<pre><code>/* \"test.c\" */\n#include &lt;stdlib.h&gt;\n\n// j can be 0 or 1\nstatic inline void sum_template (size_t j, size_t n, double *A, double *c) {\n\n  if (n == 0) return;\n  size_t i;\n  double *a = A, *b = A + n;\n  double c0 = 0.0, c1 = 0.0;\n\n  #pragma omp simd reduction (+: c0, c1) aligned (a, b: 32)\n  for (i = 0; i &lt; n; i++) {\n    c0 += a[i];\n    if (j &gt; 0) c1 += b[i];\n    }\n\n  c[0] = c0;\n  if (j &gt; 0) c[1] = c1;\n\n  }\n\n#define macro_define_sum(FUN, j)            \\\nvoid FUN (size_t n, double *A, double *c) { \\\n  sum_template(j, n, A, c);                 \\\n  }\n\nmacro_define_sum(sum_0, 0)\nmacro_define_sum(sum_1, 1)\n</code></pre>\n\n<p>If I compile it with</p>\n\n<pre><code>gcc -O2 -mavx test.c\n</code></pre>\n\n<p>GCC (say the latest 8.2), after inlining, constant propagation and dead code elimination, would optimize out code involving <code>c1</code> for function <code>sum_0</code> (<a href=\"https://gcc.godbolt.org/z/IC896j\" rel=\"nofollow noreferrer\">Check it on Godbolt</a>).</p>\n\n<p>I like this trick. By writing a single template function and passing in different configuration parameters, an optimizing compiler can generate different versions. It is much cleaner than copying-and-pasting a big proportion of the code and manually define different function versions.</p>\n\n<p>However, such convenience is lost if I activate OpenMP 4.0+ with</p>\n\n<pre><code>gcc -O2 -mavx -fopenmp test.c\n</code></pre>\n\n<p><code>sum_template</code> is inlined no more and no dead code elimination is applied (<a href=\"https://gcc.godbolt.org/z/72SHoa\" rel=\"nofollow noreferrer\">Check it on Godbolt</a>). But if I remove flag <code>-mavx</code> to work with 128-bit SIMD, compiler optimization works as I expect (<a href=\"https://gcc.godbolt.org/z/Lr1hj7\" rel=\"nofollow noreferrer\">Check it on Godbolt</a>). So is this a bug? I am on an x86-64 (Sandybridge).</p>\n\n<hr>\n\n<p><strong>Remark</strong></p>\n\n<p>Using GCC's auto-vectorization <code>-ftree-vectorize -ffast-math</code> would not have this issue (<a href=\"https://gcc.godbolt.org/z/NveFNN\" rel=\"nofollow noreferrer\">Check it on Godbolt</a>). But I wish to use OpenMP because it allows portable alignment pragma across different compilers.</p>\n\n<p><strong>Background</strong></p>\n\n<p>I write modules for an R package, which needs be portable across platforms and compilers. Writing R extension requires no Makefile. When R is built on a platform, it knows what the default compiler is on that platform, and configures a set of default compilation flags. R does not have auto-vectorization flag but it has OpenMP flag. This means that using OpenMP SIMD is the ideal way to utilize SIMD in an R package. See <a href=\"https://stackoverflow.com/a/37214261/4891738\">1</a> and <a href=\"https://stackoverflow.com/a/51682265/4891738\">2</a> for a bit more elaboration.</p>\n"}, {"tags": ["c", "arrays", "pointers", "function-pointers", "extern"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 3, "creation_date": 1530611534, "post_id": 51151480, "comment_id": 89286459, "body": "You define <code>func_ptr_t</code> as an <i>array</i> (of unknown size) of pointers to functions. Probably not what you really want."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1530611590, "post_id": 51151480, "comment_id": 89286495, "body": "And as usual, you can&#39;t have general statements outside of functions (like your assignment), only declarations and definitions."}, {"owner": {"reputation": 185, "user_id": 9929801, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/90yR8.png?s=128&g=1", "display_name": "Paul Ankman", "link": "https://stackoverflow.com/users/9929801/paul-ankman"}, "edited": false, "score": 1, "creation_date": 1530611795, "post_id": 51151480, "comment_id": 89286625, "body": "The <code>type specifier missing</code> is caused by <code>(argument)</code> which is not a correct arguments definition. All the functions in the array must have the same signature."}], "answers": [{"tags": [], "owner": {"reputation": 545, "user_id": 9266860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef5206d6fd79c294c934bf07fd5e2ed4?s=128&d=identicon&r=PG&f=1", "display_name": "Gunther Schulz", "link": "https://stackoverflow.com/users/9266860/gunther-schulz"}, "is_accepted": false, "score": 0, "last_activity_date": 1530612061, "last_edit_date": 1530612061, "creation_date": 1530611560, "answer_id": 51151571, "question_id": 51151480, "link": "https://stackoverflow.com/questions/51151480/fill-function-pointer-array-in-external-files-c/51151571#51151571", "title": "Fill function pointer array in external files (C)", "body": "<p>Putting the above comments together, you probably wanted</p>\n\n<pre><code>typedef void (*func_ptr_t)(arg_type_list);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 185, "user_id": 9929801, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/90yR8.png?s=128&g=1", "display_name": "Paul Ankman", "link": "https://stackoverflow.com/users/9929801/paul-ankman"}, "is_accepted": true, "score": 0, "last_activity_date": 1530612302, "creation_date": 1530612302, "answer_id": 51151805, "question_id": 51151480, "link": "https://stackoverflow.com/questions/51151480/fill-function-pointer-array-in-external-files-c/51151805#51151805", "title": "Fill function pointer array in external files (C)", "body": "<p>For an example about functions of the type <code>int f(int);</code>, you can check :</p>\n\n<pre><code>/* function definition */\nint functionName(int arg)\n{\n    /* do things */\n    return arg * 2;\n}\n\n/* create the type \"function pointer int-&gt;int\" */\ntypedef int (*func_ptr_t)(int);\n\n/* create the array */\nfunc_ptr_t devFunctions[3];\n\nint main(void)\n{   \n    /* associate the good function */\n    devFunctions[0] = &amp;functionName;\n\n    /* call it with an arg */\n    return devFunctions[0](42);\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 592, "user_id": 4264155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00606b6f44e3bb6dcce12d100b01f3a6?s=128&d=identicon&r=PG", "display_name": "Shrikanth N", "link": "https://stackoverflow.com/users/4264155/shrikanth-n"}, "edited": false, "score": 0, "creation_date": 1530615980, "post_id": 51152082, "comment_id": 89289349, "body": "Can you share the final code as an edit at the end of your post. Will help the next person who has a similar question."}], "tags": [], "owner": {"reputation": 23, "user_id": 10025813, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8052c42a1ef6edb999d4e6c5338dc0d?s=128&d=identicon&r=PG&f=1", "display_name": "Andres Smithuis", "link": "https://stackoverflow.com/users/10025813/andres-smithuis"}, "is_accepted": false, "score": 1, "last_activity_date": 1530613094, "creation_date": 1530613094, "answer_id": 51152082, "question_id": 51151480, "link": "https://stackoverflow.com/questions/51151480/fill-function-pointer-array-in-external-files-c/51152082#51152082", "title": "Fill function pointer array in external files (C)", "body": "<p>As most of you pointed out, filling the array is a statement which can't be put outside a function (duh...). So what I wanted is not really going to work in this case. I rewritten my application to update a function pointer (not an array anymore) on every run with the function I need. Saves a lot of trouble :)</p>\n\n<p>Thanks guys!</p>\n"}], "owner": {"reputation": 23, "user_id": 10025813, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8052c42a1ef6edb999d4e6c5338dc0d?s=128&d=identicon&r=PG&f=1", "display_name": "Andres Smithuis", "link": "https://stackoverflow.com/users/10025813/andres-smithuis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 654, "favorite_count": 0, "accepted_answer_id": 51151805, "answer_count": 3, "score": 1, "last_activity_date": 1530617571, "creation_date": 1530611315, "last_edit_date": 1530617571, "question_id": 51151480, "link": "https://stackoverflow.com/questions/51151480/fill-function-pointer-array-in-external-files-c", "title": "Fill function pointer array in external files (C)", "body": "<p>I have been struggling with function pointers for some time now. Maybe you guys can help me out.</p>\n\n<p>In my project I have multiple functionalities for the same device and each functionality is written in its own .c file. The generic functionalities (which apply to all device functions) are written in generic.c.</p>\n\n<p>I would like to create a function pointer array in the generic c file and fill that array in the other function files. So I can call the right function based on a device function identifier in the generic file.</p>\n\n<p>What I have right now:</p>\n\n<pre><code>// in generic.h:\ntypedef void (*func_ptr_t[])(arguments);\nextern func_ptr_t devFunctions[3];\n</code></pre>\n\n<p>And I would like to:</p>\n\n<pre><code>// in function1.c:\n#include \"generic.h\"\n\ndevFunctions[1] = &amp;functionName;\n</code></pre>\n\n<p>But then it complains about a type specifier missing AND the array initializer must be a list. If I add the type like</p>\n\n<pre><code>func_ptr_t devFunctions[1] = &amp;functionName;\n</code></pre>\n\n<p>I get an error about an incomplete element type 'func_ptr_t'.</p>\n\n<p>I can't initialize the entire array list from one file since it is filled from multiple files.</p>\n\n<p>Anybody got an idea on how to tackle this?</p>\n\n<p>Thanks!</p>\n\n<p><em>-edit-</em></p>\n\n<p>Because you can't use statements outside of functions I've changed my application. Now it does not use an array anymore and it updates the function pointer in the generic.c upon calling the specific function file.</p>\n\n<p>So the end result:</p>\n\n<p>In generic.h:</p>\n\n<pre><code>typedef void (*func_ptr_t)(&lt;function arguments&gt;)\n</code></pre>\n\n<p>In generic.c:</p>\n\n<pre><code>func_ptr_t devFunction;\n</code></pre>\n\n<p>In function1.c:</p>\n\n<pre><code>#include \"generic.h\"\nextern func_ptr_t devFunction;\n\nvoid functionToBeCalledFromMain( void ){\n    devFunction = functionName;\n}\n\nvoid functionName (void ){\n    // Function to be called from generic.c via function pointer\n}\n</code></pre>\n"}, {"tags": ["c", "memory-management", "shared-memory"], "comments": [{"owner": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 1, "creation_date": 1530610682, "post_id": 51151188, "comment_id": 89285911, "body": "What is your output and what do you expect? I expect a garbage value for <code>buffer</code> and that is what I get: <a href=\"https://ideone.com/ESqx1I\" rel=\"nofollow noreferrer\">ideone.com/ESqx1I</a>"}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 2, "creation_date": 1530610720, "post_id": 51151188, "comment_id": 89285948, "body": "You have to familiarize yourself with the difference between physical and virtual memory addresses"}, {"owner": {"reputation": 179, "user_id": 8524379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a324306a2482a3424a5f9a92f6beac1?s=128&d=identicon&r=PG&f=1", "display_name": "Guillermo. D. S.", "link": "https://stackoverflow.com/users/8524379/guillermo-d-s"}, "reply_to_user": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 0, "creation_date": 1530611056, "post_id": 51151188, "comment_id": 89286193, "body": "@mch That&#39;s what I get as well, it just feels weird to read something like: Memory adrress X stores 27, and memory address X stores 0 (I mean, provided X=X...)"}, {"owner": {"reputation": 179, "user_id": 8524379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a324306a2482a3424a5f9a92f6beac1?s=128&d=identicon&r=PG&f=1", "display_name": "Guillermo. D. S.", "link": "https://stackoverflow.com/users/8524379/guillermo-d-s"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1530611364, "post_id": 51151188, "comment_id": 89286382, "body": "@Ctx it looks like I&#39;m thinking of virtual memory as though it was physical. Is there a way to force a proces to write in a specific physical address anyway?"}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 2, "creation_date": 1530611650, "post_id": 51151188, "comment_id": 89286534, "body": "@Guillermo.D.S. There is no portable way to write to a specific physical address but I do not see a good reason for this anyway. There are other mechanisms for sharing memory between processes for example (threads, posix shared memory, etc)."}], "answers": [{"comments": [{"owner": {"reputation": 179, "user_id": 8524379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a324306a2482a3424a5f9a92f6beac1?s=128&d=identicon&r=PG&f=1", "display_name": "Guillermo. D. S.", "link": "https://stackoverflow.com/users/8524379/guillermo-d-s"}, "edited": false, "score": 0, "creation_date": 1530611645, "post_id": 51151325, "comment_id": 89286530, "body": "Thx @Felix Palmen. So it&#39;s all up to the OS? isn&#39;t there any trick to force a process to write within a specific physical address?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 179, "user_id": 8524379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a324306a2482a3424a5f9a92f6beac1?s=128&d=identicon&r=PG&f=1", "display_name": "Guillermo. D. S.", "link": "https://stackoverflow.com/users/8524379/guillermo-d-s"}, "edited": false, "score": 2, "creation_date": 1530611768, "post_id": 51151325, "comment_id": 89286611, "body": "@Guillermo.D.S. also look up MMU (memory management unit) .. the translation of addresses is done <i>in hardware</i>, so, no, there isn&#39;t a way around for a process that doesn&#39;t have kernel privileges, at least not without a hardware flaw or some exploitable hole in the OS itself. Only the kernel can set up the page tables used by the MMU."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 2, "creation_date": 1530611833, "post_id": 51151325, "comment_id": 89286656, "body": "Indeed there <i>are</i> sometimes OS-specific ways (under intel linux, for example, you can map /dev/mem). But this is higly platform and architecture specific."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1530611988, "post_id": 51151325, "comment_id": 89286770, "body": "@Ctx yes, but if there are such mechanisms, they are typically reserved to some &quot;privileged&quot; processes. And it&#39;s still the kernel actually accessing the physical memory."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1530612055, "post_id": 51151325, "comment_id": 89286829, "body": "@FelixPalmen Yes, of course, you have to be root (or change the permissions of /dev/mem). But no, it is not the kernel then, but the pages are mapped directly into the processes virtual memory"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1530612224, "post_id": 51151325, "comment_id": 89286947, "body": "@Ctx <code>&#47;dev&#47;mem</code> provides a character device as an &quot;image&quot; of the physical memory. Of course, you can request a mapping on it, but that&#39;s still something the kernel has to do..."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1530612302, "post_id": 51151325, "comment_id": 89286987, "body": "@FelixPalmen It is <i>always</i> the kernel mapping the memory, but it is not the kernel proxying access to the pages. There is not much technical difference between mmapping /dev/mem or doing a brk() to increment the heap."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1530612373, "post_id": 51151325, "comment_id": 89287036, "body": "@Ctx and still you can also just read from /dev/mem, without mapping it. And when you get it mapped, the access again goes through the MMU ... well, I guess the point got through ;)"}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1530612451, "post_id": 51151325, "comment_id": 89287080, "body": "@FelixPalmen Yes, you are correct, all read/write operations are still translated by the mmu. In that sense, it is not <i>direct</i> physical memory access."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "is_accepted": true, "score": 4, "last_activity_date": 1530610864, "creation_date": 1530610864, "answer_id": 51151325, "question_id": 51151188, "link": "https://stackoverflow.com/questions/51151188/same-memory-address-for-different-processes/51151325#51151325", "title": "Same memory address for different processes", "body": "<p>This isn't really a C question, it's about the behavior of (modern) operating systems.</p>\n\n<p>In short: A userspace program on a modern OS runs in some private <strong>virtual</strong> address space. When accessing memory, the virtual address is translated to a physical address. The mapping between actual memory and virtual address space is set up by the operating system -- the memory is split into pages and a page can be \"mapped\" into the address space of a process.</p>\n\n<p><code>fork()</code> typically just maps the same memory to the second process it creates, but as soon as this memory is written to, the page is copied and the copy is mapped (\"copy on write\"). A user space program will never see memory that is private to a different user space program.</p>\n\n<p>I'm sure you can easily find more details searching for the key words given in this answer.</p>\n"}, {"tags": [], "owner": {"reputation": 690, "user_id": 4532332, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/73a889f290c7f4926c7fa49e832d3465?s=128&d=identicon&r=PG&f=1", "display_name": "AndreiM", "link": "https://stackoverflow.com/users/4532332/andreim"}, "is_accepted": false, "score": 1, "last_activity_date": 1530611166, "creation_date": 1530611166, "answer_id": 51151422, "question_id": 51151188, "link": "https://stackoverflow.com/questions/51151188/same-memory-address-for-different-processes/51151422#51151422", "title": "Same memory address for different processes", "body": "<p>From <a href=\"https://en.wikipedia.org/wiki/Fork_(system_call)\" rel=\"nofollow noreferrer\">wikipedia</a>: The fork operation creates a separate address space for the child. The child process has an exact copy of all the memory segments of the parent process.</p>\n\n<p>So basically you create a new process with a different COPY of your original process memory.\nYou change something on the duplicate process's memory, which is identical but a copy and expect to see it in the original.\nNormally, processes don't share memory directly.</p>\n"}], "owner": {"reputation": 179, "user_id": 8524379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a324306a2482a3424a5f9a92f6beac1?s=128&d=identicon&r=PG&f=1", "display_name": "Guillermo. D. S.", "link": "https://stackoverflow.com/users/8524379/guillermo-d-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 827, "favorite_count": 0, "accepted_answer_id": 51151325, "answer_count": 2, "score": 1, "last_activity_date": 1530611166, "creation_date": 1530610452, "question_id": 51151188, "link": "https://stackoverflow.com/questions/51151188/same-memory-address-for-different-processes", "title": "Same memory address for different processes", "body": "<p>I just can't figure out why this code works the way it does (rather than I'd expect):</p>\n\n<pre><code> #include &lt;stdio.h&gt;\n #include &lt;stdlib.h&gt;\n #include &lt;unistd.h&gt;\n #include &lt;sys/wait.h&gt;\n #include &lt;sys/types.h&gt;\n\n int main()\n {\n     int buffer;\n     int* address;\n\n     address=&amp;buffer;\n\n\n     if(fork()==0)\n     {\n         *address=27;\n         printf(\"Address %ld stores %d\\n\",(long)address,*address);\n         exit(0);\n     }\n     wait(NULL);\n\n     printf(\"Address %ld stores %d\\n\",(long)(&amp;buffer),buffer);    \n     return 0;\n }\n</code></pre>\n\n<p>Why does the system store different variables even if they're pointed to the same memory address?</p>\n\n<p>NOTE: I never really expected this code to work, since otherwise the whole bunch of pipes and stuff wouldn't make any sense; I'd just like to understand what's going on here.</p>\n"}, {"tags": ["c", "bit-shift"], "comments": [{"owner": {"reputation": 2354, "user_id": 9428851, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-MBhDff_bdY0/AAAAAAAAAAI/AAAAAAAACAY/lx7DUTjS350/photo.jpg?sz=128", "display_name": "Victor Gubin", "link": "https://stackoverflow.com/users/9428851/victor-gubin"}, "edited": false, "score": 0, "creation_date": 1530610916, "post_id": 51151166, "comment_id": 89286092, "body": "What about  <code>__int128 rx; memmove(&amp;rx,Rx_Table, 16); rx &lt;&lt;= 10; memmove(Rx_Table,&amp;rx, 16); </code>"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1530614873, "post_id": 51151166, "comment_id": 89288658, "body": "Nobody can answer the question without knowing the type of Rx_Table."}, {"owner": {"reputation": 528, "user_id": 2184331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c59f93339e2cf87731ed5d709f275d5?s=128&d=identicon&r=PG", "display_name": "William J Bagshaw", "link": "https://stackoverflow.com/users/2184331/william-j-bagshaw"}, "edited": false, "score": 0, "creation_date": 1530617105, "post_id": 51151166, "comment_id": 89290022, "body": "Have you tried to replace every occurrence of &quot;4&quot; with a variable? You should be able to get an example that works with shifts up to 8. The overflow calculation is using a mask 0xF0 that needs to be calculated. Some of the shifts are the not the amount you want to shift but the remaining number of bits in the byte. Unfortunately for 4 bits both of these are 4.I would start with a test pattern with the last byte set as 0xFF and debug that. Get the last byte correct. Then, with the same test pattern, get the second byte correct. Stick with 0-8 shifts until it is working before doing higher."}, {"owner": {"reputation": 528, "user_id": 2184331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c59f93339e2cf87731ed5d709f275d5?s=128&d=identicon&r=PG", "display_name": "William J Bagshaw", "link": "https://stackoverflow.com/users/2184331/william-j-bagshaw"}, "edited": false, "score": 0, "creation_date": 1530617593, "post_id": 51151166, "comment_id": 89290316, "body": "Actually I&#39;m not convinced you need the 0xF0 mask. A common gotcha (not fixed by adding the mask) is using signed values. Shifting a negative number may keep it negative. It could be &quot;sign extended&quot;. Make sure the type you use for the array is unsigned."}, {"owner": {"reputation": 937, "user_id": 9242445, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2IaxD.jpg?s=128&g=1", "display_name": "Marker", "link": "https://stackoverflow.com/users/9242445/marker"}, "edited": false, "score": 0, "creation_date": 1530621104, "post_id": 51151166, "comment_id": 89292504, "body": "You defined Rx_Table[16], but only initialized 10 entries.  By shift left, do you mean Rx_Table[0]-&gt;Rx_Table[16] or Rx_Table[16]-&gt;Rx_Table[0]?"}], "owner": {"reputation": 21, "user_id": 9411091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6d4be01ae413bbc968f6fd61590e94a?s=128&d=identicon&r=PG&f=1", "display_name": "kooda", "link": "https://stackoverflow.com/users/9411091/kooda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 300, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1530645014, "creation_date": 1530610404, "last_edit_date": 1530645014, "question_id": 51151166, "link": "https://stackoverflow.com/questions/51151166/how-to-shift-left-n-bits-from-16-bytes-array", "title": "How to shift left n bits from 16 bytes array?", "body": "<p>I have a 16-byte array, and am trying to left-shift the number of bits - where the number to shift can vary from 1 to 10. I tried the code below, but it only works with a 4 bit shift:</p>\n\n<pre><code>Rx_Table[16] = {0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0A, 0xBC};\nif (byteezy == 0x00 &amp;&amp; byteezy1 == 0x10) {\n    int i;\n    uint8_t shifted = 0x00;\n    uint8_t overflow = (0xF0 &amp; RxTable[0]) &gt;&gt; 4;\n\n    for (i = (16 - 1); i &gt;= 0; i--) {\n        shifted = (RxTable[i] &lt;&lt; 4) | overflow;\n        overflow = (0xF0 &amp; RxTable[i]) &gt;&gt; 4;\n        RxTable1[i] = shifted;\n    }\n</code></pre>\n\n<p>I am stuck: how to make this work when the number of bits to shift is variable?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 3, "creation_date": 1530610438, "post_id": 51151146, "comment_id": 89285748, "body": "Your problem isn&#39;t a linked list but incorrect use of <code>scanf()</code>. <code>%c</code> consumes a single character <b>only</b> and doesn&#39;t skip any whitespace (like newline). OTOH, <code>%d</code> <b>does</b> skip whitespace characters. See also my <a href=\"http://sekrit.de/webdocs/c/beginners-guide-away-from-scanf.html\" rel=\"nofollow noreferrer\">beginners&#39; guide away from <code>scanf()</code></a>"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1530610481, "post_id": 51151146, "comment_id": 89285780, "body": "When you end the first input, do you not use the <code>Enter</code> key? That key will be put into the input buffer as a newline <code>&#39;\\n&#39;</code> to be read by the next character input function."}, {"owner": {"reputation": 3, "user_id": 9147773, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-DiEQeUzEhy8/AAAAAAAAAAI/AAAAAAAAAAs/_7vdJi-FBLg/photo.jpg?sz=128", "display_name": "Riju Mukherjee", "link": "https://stackoverflow.com/users/9147773/riju-mukherjee"}, "edited": false, "score": 0, "creation_date": 1530637400, "post_id": 51151146, "comment_id": 89302701, "body": "Thanks a lot now i replaced char with char[N] and used %s instead it is working fine"}], "answers": [{"tags": [], "owner": {"reputation": 3071, "user_id": 7992142, "user_type": "registered", "profile_image": "https://graph.facebook.com/1605532469479504/picture?type=large", "display_name": "Nipun Sampath", "link": "https://stackoverflow.com/users/7992142/nipun-sampath"}, "is_accepted": true, "score": 0, "last_activity_date": 1530637602, "creation_date": 1530637602, "answer_id": 51159784, "question_id": 51151146, "link": "https://stackoverflow.com/questions/51151146/c-programming-linked-list-implementation-with-characters/51159784#51159784", "title": "C Programming -Linked List Implementation with characters", "body": "<p>As stated in the comments your problem lies not in the linked list implementation, but in the code lines here. </p>\n\n<pre><code>scanf(\"%c\",&amp;ptr-&gt;data);    //line number 14\n\nscanf(\"%c\",&amp;ptr-&gt;data);    //line number 22\n\nscanf(\"%c\",&amp;A);            //line number 26\n</code></pre>\n\n<p>in all these lines %c consumes the new line character(\\n) instead of the users input.</p>\n\n<p>To correct the issue, you can place a whitespace in front of the %c like this, </p>\n\n<pre><code>scanf(\" %c\",&amp;ptr-&gt;data);    //line number 14\n\nscanf(\" %c\",&amp;ptr-&gt;data);    //line number 22\n\nscanf(\" %c\",&amp;A);            //line number 26\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9147773, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-DiEQeUzEhy8/AAAAAAAAAAI/AAAAAAAAAAs/_7vdJi-FBLg/photo.jpg?sz=128", "display_name": "Riju Mukherjee", "link": "https://stackoverflow.com/users/9147773/riju-mukherjee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 51159784, "answer_count": 1, "score": -2, "last_activity_date": 1530637602, "creation_date": 1530610332, "question_id": 51151146, "link": "https://stackoverflow.com/questions/51151146/c-programming-linked-list-implementation-with-characters", "title": "C Programming -Linked List Implementation with characters", "body": "<p>MY CODE:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n\nstruct node{\n char data;\n struct node *next;\n};\n\nvoid main()\n{   char A;\nstruct node *head,*ptr;\nptr=(struct node *)malloc(sizeof(struct node));\nprintf(\"Enter data for node 1 \\n\");\nscanf(\"%c\",&amp;ptr-&gt;data);\nhead=ptr;\nint i=2;\nwhile(1)\n{\n    ptr-&gt;next=(struct node*)malloc(sizeof(struct node));\n    ptr=ptr-&gt;next;\n    printf(\"\\nEnter data for node %d:::\\n\",i);\n    scanf(\"%c\",&amp;ptr-&gt;data);\n    ptr-&gt;next=NULL;\n    i=i+1;\n    printf(\"Do you want to continue Y OR N\");\n    scanf(\"%c\",&amp;A);\n    if(A=='Y')\n        continue;\n    else\n        break;\n\n}\n\nstruct node *temp;\n\ntemp=head;\nwhile(temp!=NULL)\n{\n    printf(\"%c=&gt;\",temp-&gt;data);\n    temp=temp-&gt;next;\n}\nprintf(\"NULL\");\n\n\n\n\n\n}\n</code></pre>\n\n<p>For this code I can only enter the first character data after that it is skipping the scanf portion within the while loop.\nBut when I am doing the same code with integer it is giving me the right output.\nHere if I replace the same code instead of having characters I replace it by integers it works fine. \nI couldnt find a way to fix it.\nPlz help.</p>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 2287, "user_id": 5267751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd62e8fd8fbb37abc7e2a39d23828047?s=128&d=identicon&r=PG&f=1", "display_name": "user202729", "link": "https://stackoverflow.com/users/5267751/user202729"}, "edited": false, "score": 6, "creation_date": 1530608849, "post_id": 51150625, "comment_id": 89284800, "body": "Do you know the different meanings of the symbol <code>*</code>?"}, {"owner": {"reputation": 97, "user_id": 9952716, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad79e1db0bdb469c7ddea18746cbdd0f?s=128&d=identicon&r=PG&f=1", "display_name": "sharkbites", "link": "https://stackoverflow.com/users/9952716/sharkbites"}, "reply_to_user": {"reputation": 2287, "user_id": 5267751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd62e8fd8fbb37abc7e2a39d23828047?s=128&d=identicon&r=PG&f=1", "display_name": "user202729", "link": "https://stackoverflow.com/users/5267751/user202729"}, "edited": false, "score": 0, "creation_date": 1530608967, "post_id": 51150625, "comment_id": 89284863, "body": "Yep. Dereference. Meaning, get the value associated with the memory address. For a string, dereferencing char * would give me the first character."}, {"owner": {"reputation": 185, "user_id": 9929801, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/90yR8.png?s=128&g=1", "display_name": "Paul Ankman", "link": "https://stackoverflow.com/users/9929801/paul-ankman"}, "edited": false, "score": 1, "creation_date": 1530612603, "post_id": 51150625, "comment_id": 89287177, "body": "In <code>c = *c + 2;</code>, you deference the value of <code>c</code> ie the letter <code>&#39;t&#39;</code>, add it <code>2</code> which means the value of the expression is the letter <code>&#39;v&#39;</code> (118), and then assign it to c. So when you do <code>*c</code> in the last line, you want to access to the address <code>118</code>."}, {"owner": {"reputation": 97, "user_id": 9952716, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad79e1db0bdb469c7ddea18746cbdd0f?s=128&d=identicon&r=PG&f=1", "display_name": "sharkbites", "link": "https://stackoverflow.com/users/9952716/sharkbites"}, "reply_to_user": {"reputation": 185, "user_id": 9929801, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/90yR8.png?s=128&g=1", "display_name": "Paul Ankman", "link": "https://stackoverflow.com/users/9929801/paul-ankman"}, "edited": false, "score": 0, "creation_date": 1530612778, "post_id": 51150625, "comment_id": 89287299, "body": "@PaulAnkman that makes a lot of sense! Thanks"}], "answers": [{"comments": [{"owner": {"reputation": 19499, "user_id": 3883560, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/ndXdL.jpg?s=128&g=1", "display_name": "Gopi", "link": "https://stackoverflow.com/users/3883560/gopi"}, "reply_to_user": {"reputation": 97, "user_id": 9952716, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad79e1db0bdb469c7ddea18746cbdd0f?s=128&d=identicon&r=PG&f=1", "display_name": "sharkbites", "link": "https://stackoverflow.com/users/9952716/sharkbites"}, "edited": false, "score": 2, "creation_date": 1530609245, "post_id": 51150673, "comment_id": 89285017, "body": "I hope you know what operator precedence is. <code>++</code> has higher precdence then <code>*</code> so <code>*c++</code> will be treated as <code>c++</code> and later <code>*c</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 3, "creation_date": 1530609256, "post_id": 51150673, "comment_id": 89285023, "body": "There&#39;s an <a href=\"https://en.cppreference.com/w/c/language/operator_precedence\" rel=\"nofollow noreferrer\">effective precedence of operators</a> in C, described by the grammar in the standard. <code>++</code> &quot;binds stronger&quot; than <code>*</code>, so happens first here. If you just write <code>*c++;</code>, you effectively ignore the result of the dereference, but the side effect (incrementing <code>c</code>) still happens. IOW, the <code>*</code> in your <code>*c++;</code> is nonsensical here, but doesn&#39;t hurt..."}, {"owner": {"reputation": 11619, "user_id": 5346306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BsACH.jpg?s=128&g=1", "display_name": "Achal", "link": "https://stackoverflow.com/users/5346306/achal"}, "edited": false, "score": 0, "creation_date": 1530609489, "post_id": 51150673, "comment_id": 89285169, "body": "Why it shouldn&#39;t ? In <code>*c++</code> first <code>c++</code> performed which means you are  trying to change <code>c</code> i.e address, which you can. Note that you can&#39;t  do like <code>(*c)++</code> or <code>++*c</code> here."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 97, "user_id": 9952716, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad79e1db0bdb469c7ddea18746cbdd0f?s=128&d=identicon&r=PG&f=1", "display_name": "sharkbites", "link": "https://stackoverflow.com/users/9952716/sharkbites"}, "edited": false, "score": 0, "creation_date": 1530609657, "post_id": 51150673, "comment_id": 89285259, "body": "@sharkbites side note: you really shouldn&#39;t change the code in the question after you received answers. In this case, it doesn&#39;t make the answer appear wrong, so we can leave it, but please keep that in mind for the future :)"}, {"owner": {"reputation": 97, "user_id": 9952716, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad79e1db0bdb469c7ddea18746cbdd0f?s=128&d=identicon&r=PG&f=1", "display_name": "sharkbites", "link": "https://stackoverflow.com/users/9952716/sharkbites"}, "edited": false, "score": 0, "creation_date": 1530611843, "post_id": 51150673, "comment_id": 89286664, "body": "@FelixPalmen I read the comments first and realised that I could put it in without it making any difference. But thanks for the heads up :)"}], "tags": [], "owner": {"reputation": 19499, "user_id": 3883560, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/ndXdL.jpg?s=128&g=1", "display_name": "Gopi", "link": "https://stackoverflow.com/users/3883560/gopi"}, "is_accepted": false, "score": 5, "last_activity_date": 1530608911, "creation_date": 1530608911, "answer_id": 51150673, "question_id": 51150625, "link": "https://stackoverflow.com/questions/51150625/why-does-pointer-arithmetic-need-to-be-cast/51150673#51150673", "title": "Why does pointer arithmetic need to be cast?", "body": "<p><code>c</code> here is a pointer which holds the address of a memory location.</p>\n\n<p><code>*c</code> is called de-referencing the pointer which will give the value stored in the memory location pointed by <code>c</code>.</p>\n\n<p>So</p>\n\n<pre><code>c = *c + 2\n</code></pre>\n\n<p>will be</p>\n\n<pre><code>c = (value stored at c) + 2;\n</code></pre>\n\n<p>which will not give the memory location like</p>\n\n<pre><code>c = c + 2;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4598, "user_id": 9264702, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mHczh.jpg?s=128&g=1", "display_name": "Stephen Docy", "link": "https://stackoverflow.com/users/9264702/stephen-docy"}, "is_accepted": false, "score": 3, "last_activity_date": 1530608944, "creation_date": 1530608944, "answer_id": 51150679, "question_id": 51150625, "link": "https://stackoverflow.com/questions/51150625/why-does-pointer-arithmetic-need-to-be-cast/51150679#51150679", "title": "Why does pointer arithmetic need to be cast?", "body": "<p>In your first example, <code>c++;</code> simply adds one to <code>c</code>, no dereferencing, so why are you trying to dereference when adding 2?  Simply add 2 to the pointer value:</p>\n\n<pre><code>char * c = \"test\";\nc = c + 2; //*c = *c + 2; also doesn't work\nputchar(*c);//Exception thrown: write access violation.\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 97, "user_id": 9952716, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad79e1db0bdb469c7ddea18746cbdd0f?s=128&d=identicon&r=PG&f=1", "display_name": "sharkbites", "link": "https://stackoverflow.com/users/9952716/sharkbites"}, "edited": false, "score": 0, "creation_date": 1530613266, "post_id": 51151045, "comment_id": 89287617, "body": "I still dont get what you mean by &quot; you have to keep clear in your mind the very important distinction between the value of the pointer versus the value pointed to by the pointer&quot;. In the example <code>char * c = &quot;test&quot;;</code> , the pointer to the first character of the string is equal to &#39;t&#39;, so isn&#39;t the &quot;value of the pointer&quot; and &quot;value pointed to by the pointer&quot; the same thing?"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "reply_to_user": {"reputation": 97, "user_id": 9952716, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad79e1db0bdb469c7ddea18746cbdd0f?s=128&d=identicon&r=PG&f=1", "display_name": "sharkbites", "link": "https://stackoverflow.com/users/9952716/sharkbites"}, "edited": false, "score": 0, "creation_date": 1530614109, "post_id": 51151045, "comment_id": 89288166, "body": "@sharkbites Perhaps this explanation will help: <a href=\"https://www.eskimo.com/~scs/cclass/notes/sx10.html\" rel=\"nofollow noreferrer\">eskimo.com/~scs/cclass/notes/sx10.html</a>"}], "tags": [], "owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "is_accepted": false, "score": 2, "last_activity_date": 1530610590, "last_edit_date": 1530610590, "creation_date": 1530610065, "answer_id": 51151045, "question_id": 51150625, "link": "https://stackoverflow.com/questions/51150625/why-does-pointer-arithmetic-need-to-be-cast/51151045#51151045", "title": "Why does pointer arithmetic need to be cast?", "body": "<p>Your first code fragment was</p>\n\n<pre><code>char * c = \"test\";\n*c++;\nputchar(*c);\n</code></pre>\n\n<p>and as you noted, it prints <code>e</code>.  But it's important to note that in the second line, the <code>*</code> is completely superfluous.  You've incremented <code>c</code>, <em>and</em> fetched the pointed-to-character -- and then thrown the pointed-to character away.</p>\n\n<p>It would have worked exactly the same -- and been more clear, with no confusing, extra operators -- if you had instead said</p>\n\n<pre><code>char * c = \"test\";\nc++;\nputchar(*c);\n</code></pre>\n\n<p>Next you wondered why you couldn't increment the pointer by 2.  But of course you <em>can</em> increment the pointer by two -- you could either say</p>\n\n<pre><code>char * c = \"test\";\nc++;\nc++;\nputchar(*c);\n</code></pre>\n\n<p>or</p>\n\n<pre><code>char * c = \"test\";\nc += 2;\nputchar(*c);\n</code></pre>\n\n<p>or</p>\n\n<pre><code>char * c = \"test\";\nc = c + 2;\nputchar(*c);\n</code></pre>\n\n<p>But you wrote</p>\n\n<pre><code>c = *c + 2;\n</code></pre>\n\n<p>That didn't work, and no surprise -- again, you have an unnecessary <code>*</code>, and here, it's not so harmless.  Here, you unnecessarily fetch the character that <code>c</code> points to, but instead of throwing it away, you add 2 to it, <em>and then you try to assign the character to your original pointer variable</em>.  Your compiler probably complained about this -- assigning a character to a pointer is meaningless.  It's as if you had said</p>\n\n<pre><code>c = 'x';\n</code></pre>\n\n<p>It looks like you may be unsure about what <code>*</code> means in C.  It is <em>not</em> just a marker that says \"this variable is a pointer\".  It is an operator that actively fetches the value pointed to by the pointer.</p>\n\n<p>Whenever you're working with pointers, you have to keep clear in your mind the very important distinction between <em>the value of the pointer</em> versus <em>the value pointed to by the pointer</em>.</p>\n\n<p>Going back to your original example, when you said</p>\n\n<pre><code>char * c = \"test\";\n</code></pre>\n\n<p>the value of the pointer <code>c</code> is \"pointer to the first character of the string\", and the value pointed to by the pointer is \"the character <code>t</code>\".</p>\n\n<p>If you say</p>\n\n<pre><code>c++\n</code></pre>\n\n<p>you increment the value  of the pointer.  Now it points at the second character of the string, and the value pointed to is the character <code>e</code>.</p>\n\n<p>If <code>c</code> is a pointer, then any time I mention <code>c</code> by itself in an expression, I am referring to the value of the pointer.  But any time I stick the operator <code>*</code> in front of it, I am referring to the value pointed to by the pointer.</p>\n"}, {"tags": [], "owner": {"reputation": 592, "user_id": 4264155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00606b6f44e3bb6dcce12d100b01f3a6?s=128&d=identicon&r=PG", "display_name": "Shrikanth N", "link": "https://stackoverflow.com/users/4264155/shrikanth-n"}, "is_accepted": false, "score": 0, "last_activity_date": 1530614272, "creation_date": 1530614272, "answer_id": 51152458, "question_id": 51150625, "link": "https://stackoverflow.com/questions/51150625/why-does-pointer-arithmetic-need-to-be-cast/51152458#51152458", "title": "Why does pointer arithmetic need to be cast?", "body": "<p>Lets understand the code below:</p>\n\n<pre><code>char * c = \"test\";\nc = *c + 2; //*c = *c + 2; also doesn't work\nputchar(*c);//Exception thrown: write access violation.\n</code></pre>\n\n<p>First statement says that you have an character array whose starting address is stored in variable c. Char are stored as ASCII value in memory.</p>\n\n<p>Second statement says take value at address in location pointed to by c (ASCII of 'e' is 0x65) add 2 to it and save it as new address. Variable c now contains 0x67.</p>\n\n<p>Third statement says print value as address stored in c (which is now 0x67). As we do not have access to this memory location an exception is thrown.</p>\n\n<p>You would want to increment memory location pointed to by c and print the content. For that you would need to do:</p>\n\n<pre><code>char * c = \"test\";\nc = c + 2; //Moves the pointer by 2 bytes\nputchar(*c); //Print the character at that memory location\n</code></pre>\n"}], "owner": {"reputation": 97, "user_id": 9952716, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad79e1db0bdb469c7ddea18746cbdd0f?s=128&d=identicon&r=PG&f=1", "display_name": "sharkbites", "link": "https://stackoverflow.com/users/9952716/sharkbites"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 165, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1530614336, "creation_date": 1530608736, "last_edit_date": 1530614336, "question_id": 51150625, "link": "https://stackoverflow.com/questions/51150625/why-does-pointer-arithmetic-need-to-be-cast", "title": "Why does pointer arithmetic need to be cast?", "body": "<p>If I wanted to iterate over a string, in this case 'test', I could use pointer arithmetic like so to get to the next character: </p>\n\n<pre><code>char *c = \"test\";\n*c++;\nputchar(*c);\n</code></pre>\n\n<p>This would print the second letter 'e'.</p>\n\n<p>But, if I wanted to go to the third character, why can't I say:</p>\n\n<pre><code>char *c = \"test\";\nc = *c + 2;        //*c = *c + 2; also doesn't work\nputchar(*c);       //Exception thrown: write access violation.\n</code></pre>\n\n<p>?</p>\n\n<p>To my knowledge, the only way to get to the third character using pointer arithmetic is to cast it like so:</p>\n\n<pre><code>char *c = \"test\";\nc = (char *) c + 2;\nputchar(*c);\n</code></pre>\n\n<p>Can someone please explain to me why that is?</p>\n"}, {"tags": ["android", "c", "tcp", "android-ndk"], "comments": [{"owner": {"reputation": 1051, "user_id": 9988657, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/017a7b50d49261a60b1b3bbcc26ba076?s=128&d=identicon&r=PG&f=1", "display_name": "jc1850", "link": "https://stackoverflow.com/users/9988657/jc1850"}, "reply_to_user": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1530613257, "post_id": 51150532, "comment_id": 89287610, "body": "That code is just for trying to work out whats going wrong. The server is not running so cannot accept the connection, I have literally unplugged the ethernet cable to the server and it still &quot;connects&quot; to it."}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1530665134, "post_id": 51150532, "comment_id": 89312127, "body": "What is <code>server ip</code>? I have occasionally seen <code>connect()</code> wrongly succeed to <code>127.0.0.1</code> but never to an external IP address."}, {"owner": {"reputation": 1051, "user_id": 9988657, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/017a7b50d49261a60b1b3bbcc26ba076?s=128&d=identicon&r=PG&f=1", "display_name": "jc1850", "link": "https://stackoverflow.com/users/9988657/jc1850"}, "reply_to_user": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1530693785, "post_id": 51150532, "comment_id": 89321466, "body": "It&#39;s an external IP"}], "answers": [{"comments": [{"owner": {"reputation": 1051, "user_id": 9988657, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/017a7b50d49261a60b1b3bbcc26ba076?s=128&d=identicon&r=PG&f=1", "display_name": "jc1850", "link": "https://stackoverflow.com/users/9988657/jc1850"}, "edited": false, "score": 0, "creation_date": 1530610417, "post_id": 51150961, "comment_id": 89285734, "body": "It works fine when connecting to my server however when the server is not running or I try to connect to a port that isnt accepting connections it still returns 0 so I have no way to tell if a connection has been made or not"}, {"owner": {"reputation": 1051, "user_id": 9988657, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/017a7b50d49261a60b1b3bbcc26ba076?s=128&d=identicon&r=PG&f=1", "display_name": "jc1850", "link": "https://stackoverflow.com/users/9988657/jc1850"}, "edited": false, "score": 0, "creation_date": 1530620590, "post_id": 51150961, "comment_id": 89292122, "body": "It&#39;s still returning 0 when the server isn&#39;t running"}], "tags": [], "owner": {"reputation": 1632, "user_id": 2429333, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5eb897104dc190de7ea7da0ac29a59ae?s=128&d=identicon&r=PG", "display_name": "pbn", "link": "https://stackoverflow.com/users/2429333/pbn"}, "is_accepted": false, "score": 0, "last_activity_date": 1530622151, "last_edit_date": 1530622151, "creation_date": 1530609843, "answer_id": 51150961, "question_id": 51150532, "link": "https://stackoverflow.com/questions/51150532/android-ndk-socket-connect-returning-0-when-it-should-fail-whilst-on-3g/51150961#51150961", "title": "Android NDK socket connect() returning 0 when it should fail whilst on 3g", "body": "<p>I removed android specific parts</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;netdb.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;netinet/in.h&gt;\n#include &lt;arpa/inet.h&gt;\n#include &lt;unistd.h&gt;\n\n\nint createSocket() {\n    int sockFD;\n    if ((sockFD = socket(AF_INET, SOCK_STREAM, 0)) &lt; 0) {\n        printf(\"Unable to create socket\");\n        return -1;\n    }\n\n    printf(\"Socket created: %i\", sockFD);\n    return sockFD;\n\n\n}\nint main() {\n    struct sockaddr_in server;\n    int sockFD, new_socket;\n    char * message;\n    if ((sockFD = createSocket()) &lt; 0) {\n        return -1;\n    }\n    server.sin_family = AF_INET;\n    server.sin_addr.s_addr = inet_addr(\"127.0.0.1\");\n    server.sin_port = htons(8888);\n    new_socket = connect(sockFD, (struct sockaddr *)&amp;server, sizeof(server));\n    printf(\"Connect return value: %i\", new_socket);\n\n    int rtn = recv(sockFD, message, sizeof(char), 0);\n    printf(\"Message: %i\", rtn);\n\n    close(sockFD);\n\n    return 1;\n}\n</code></pre>\n\n<p>This works as expected. Try it yourself by connecting to <code>127.0.0.1</code>. If there is no server running on your host machine then it will fail to connect (connect will return -1 and errno will be set appropriately). </p>\n\n<p>Make sure the IP address you are using for connection is really pointing to your server. </p>\n\n<p>Also there is a problem in recv:</p>\n\n<pre><code>int rtn = recv(sockFD, message, sizeof(char), 0);\n</code></pre>\n\n<p>Variable <code>message</code> is a pointer that has not be assigned to any memory (it contains some stack garbage value) and you are overwriting it. See <a href=\"http://man7.org/linux/man-pages/man2/recvmsg.2.html\" rel=\"nofollow noreferrer\" title=\"manual for recv\">manual for recv (2)</a>.</p>\n\n<p>To fix this you should either assign your pointer to some allocated memory:</p>\n\n<pre><code>message = malloc(1); //char is always a single byte\n</code></pre>\n\n<p>or use stack instead of heap for storing the message byte:</p>\n\n<pre><code>char message;\n...\nint rtn = recv(sockFD, &amp;message, sizeof(char), 0);\n</code></pre>\n\n<p>I assumed your message is always a single byte. </p>\n\n<p>Keep in mind that in here:</p>\n\n<pre><code>printf(\"Message: %i\", rtn);\n</code></pre>\n\n<p>you are printing the return code not the actual message.</p>\n"}], "owner": {"reputation": 1051, "user_id": 9988657, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/017a7b50d49261a60b1b3bbcc26ba076?s=128&d=identicon&r=PG&f=1", "display_name": "jc1850", "link": "https://stackoverflow.com/users/9988657/jc1850"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 264, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1531304939, "creation_date": 1530608451, "last_edit_date": 1531304939, "question_id": 51150532, "link": "https://stackoverflow.com/questions/51150532/android-ndk-socket-connect-returning-0-when-it-should-fail-whilst-on-3g", "title": "Android NDK socket connect() returning 0 when it should fail whilst on 3g", "body": "<p>I have written a socket in the android NDK and a server in c. It is able to connect to the server fine. However if the server is down or I try to get it to connect to a different random IP the call to connect still returns 0 when it should return -1.</p>\n\n<p>Here is the code for the client:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;jni.h&gt;\n#include &lt;netdb.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;netinet/in.h&gt;\n#include &lt;arpa/inet.h&gt;\n#include &lt;android/log.h&gt;\n#include &lt;unistd.h&gt;\n\n#define APPNAME \"MyApp\"\n#define logcat(...)  __android_log_print(ANDROID_LOG_VERBOSE, APPNAME, __VA_ARGS__)\n\n\nint createSocket() {\n    int sockFD;\n    if ((sockFD = socket(AF_INET, SOCK_STREAM, 0)) &lt; 0) {\n        logcat(\"Unable to create socket\");\n        return -1;\n    }\n\n    logcat(\"Socket created: %i\", sockFD);\n    return sockFD;\n\n\n}\nJNIEXPORT jint JNICALL\nJava_myapp_client( JNIEnv* env,\n                                      jobject thiz ) {\n    struct sockaddr_in server;\n    int sockFD, new_socket;\n    char * message;\n    if ((sockFD = createSocket()) &lt; 0) {\n        return -1;\n    }\n    server.sin_family = AF_INET;\n    server.sin_addr.s_addr = inet_addr(server ip);\n    server.sin_port = htons(8888);\n    new_socket = connect(sockFD, (struct sockaddr *)&amp;server, sizeof(server));\n    logcat(\"Connect return value: %i\", new_socket);\n\n    int rtn = recv(sockFD, message, sizeof(char), 0);\n    logcat(\"Message: %i\", rtn);\n\n    close(sockFD);\n\n    return 1;\n}\n</code></pre>\n\n<p>A valid descriptor is made for the socket, the return values for connect and recv are zero when I run this without my server running. Might be worth noting the android device is connected to the internet over mobile internet.</p>\n"}, {"tags": ["c", "file", "struct", "record", "binaryfiles"], "comments": [{"owner": {"reputation": 17713, "user_id": 226648, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/3196df423fd95dc4fce7dfadb8ec9953?s=128&d=identicon&r=PG", "display_name": "el.pescado", "link": "https://stackoverflow.com/users/226648/el-pescado"}, "edited": false, "score": 1, "creation_date": 1530607485, "post_id": 51150053, "comment_id": 89283974, "body": "Your handle <code>fba</code> refers to file named by <code>newname</code>, and file handle <code>temp</code> refers to file named by <code>oldname</code>, but those variable names do not suggest any correspondence. You could try using better names (eg. <code>fba</code>/<code>fba_name</code> and <code>temp</code>/<code>temp_name</code>)."}, {"owner": {"reputation": 31, "user_id": 10018348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3de2c963a0fe84b1b93effc23f851523?s=128&d=identicon&r=PG&f=1", "display_name": "Goner", "link": "https://stackoverflow.com/users/10018348/goner"}, "reply_to_user": {"reputation": 17713, "user_id": 226648, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/3196df423fd95dc4fce7dfadb8ec9953?s=128&d=identicon&r=PG", "display_name": "el.pescado", "link": "https://stackoverflow.com/users/226648/el-pescado"}, "edited": false, "score": 0, "creation_date": 1530607600, "post_id": 51150053, "comment_id": 89284042, "body": "@el.pescado I corrected, I deleted the wrong file so of course nothing changed. After changing that, everything works, thank you"}, {"owner": {"reputation": 17713, "user_id": 226648, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/3196df423fd95dc4fce7dfadb8ec9953?s=128&d=identicon&r=PG", "display_name": "el.pescado", "link": "https://stackoverflow.com/users/226648/el-pescado"}, "edited": false, "score": 0, "creation_date": 1530607864, "post_id": 51150053, "comment_id": 89284192, "body": "I mean, if variables relate to same thing, their names should show that relation. That way, if you had <code>remove(temp_name);</code> it would be easier to spot error."}, {"owner": {"reputation": 31, "user_id": 10018348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3de2c963a0fe84b1b93effc23f851523?s=128&d=identicon&r=PG&f=1", "display_name": "Goner", "link": "https://stackoverflow.com/users/10018348/goner"}, "reply_to_user": {"reputation": 17713, "user_id": 226648, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/3196df423fd95dc4fce7dfadb8ec9953?s=128&d=identicon&r=PG", "display_name": "el.pescado", "link": "https://stackoverflow.com/users/226648/el-pescado"}, "edited": false, "score": 0, "creation_date": 1530607944, "post_id": 51150053, "comment_id": 89284251, "body": "@el.pescado I guess you&#39;re right, I&#39;ll modify it thank you"}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 10018348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3de2c963a0fe84b1b93effc23f851523?s=128&d=identicon&r=PG&f=1", "display_name": "Goner", "link": "https://stackoverflow.com/users/10018348/goner"}, "edited": false, "score": 0, "creation_date": 1530607353, "post_id": 51150141, "comment_id": 89283894, "body": "Oh my, thank you! Now it works perfectly! Sorry for this stupid mistake"}], "tags": [], "owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "is_accepted": false, "score": 3, "last_activity_date": 1530607225, "creation_date": 1530607225, "answer_id": 51150141, "question_id": 51150053, "link": "https://stackoverflow.com/questions/51150053/delete-record-binary-file-c/51150141#51150141", "title": "Delete record binary file c", "body": "<p>You are removing the updated file (<em>temp.bin</em>, aka <code>oldname</code>) :</p>\n\n<pre><code>remove(oldname);\n</code></pre>\n\n<p>before you attempt to replace the original file (<em>alimenti.bin</em>, aka <code>newname</code>) with it :</p>\n\n<pre><code>rename(oldname,newname);\n</code></pre>\n\n<p>Did you mean :</p>\n\n<pre><code>remove(newname);\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 10018348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3de2c963a0fe84b1b93effc23f851523?s=128&d=identicon&r=PG&f=1", "display_name": "Goner", "link": "https://stackoverflow.com/users/10018348/goner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2275, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1530607225, "creation_date": 1530606932, "question_id": 51150053, "link": "https://stackoverflow.com/questions/51150053/delete-record-binary-file-c", "title": "Delete record binary file c", "body": "<p>I just made a program to delete a record from a binary file, but the problem is even if the program finds a match with the name, it does't actually delete it from the file when I write the records on a temporary file. Do I get wrong in the else condition perhaps?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\ntypedef struct {\n    int dd;\n    int mm;\n    int yyyy;\n}date;\n\nstruct _food\n{\n    char category[20];\n    char name[30];\n    int amount;\n    data expiry;\n    int calories;\n} food;\nint main()\n{\n    FILE* fba;\n    FILE* temp;\n    int found = 0;\n    char nome_t[30];\n    char newname[] = \"alimenti.bin\";\n    char oldname[] = \"temp.bin\";\n    fba = fopen(\"alimenti.bin\", \"rb\");\n    temp = fopen(\"temp.bin\", \"wb\");\n\n    printf(\"Type the name of the food you want to delete:\\n\");\n    gets(nome_t);\n    while(fread(&amp;food,sizeof(food),1,fba))\n    {\n        if(strcmp(nome_t,food.name) != 0)   \n        {\n            fwrite(&amp;food,sizeof(food),1,temp);\n\n        }\n        else{\n            found = 1;\n            printf(\"Match found. Food deleted.\\n\");\n\n        }\n\n    }\n    if (!found){\n        printf(\"No match.\\n\");\n\n    }\n\n    fclose(fba);\n    fclose(temp);\n    remove(oldname);\n    rename(oldname,newname);\n    system(\"PAUSE\");\n    return 0;\n\n\n}\n</code></pre>\n"}, {"tags": ["c", "gcc", "c-preprocessor", "building"], "comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 4, "creation_date": 1530606427, "post_id": 51149895, "comment_id": 89283337, "body": "Is that capital I or lower case L?"}, {"owner": {"reputation": 1033, "user_id": 3410010, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zFRd3.jpg?s=128&g=1", "display_name": "yadhu", "link": "https://stackoverflow.com/users/3410010/yadhu"}, "edited": false, "score": 3, "creation_date": 1530606607, "post_id": 51149895, "comment_id": 89283452, "body": "or you can try #include &quot;folder/header.h&quot;"}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 2, "creation_date": 1530607968, "post_id": 51149895, "comment_id": 89284262, "body": "The correct option for specifying include directories is a capital I (india), not a lowercase l (ell)."}, {"owner": {"reputation": 11, "user_id": 10022365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oGUnW.png?s=128&g=1", "display_name": "rusty_coin", "link": "https://stackoverflow.com/users/10022365/rusty-coin"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1530608015, "post_id": 51149895, "comment_id": 89284295, "body": "@StoryTeller thank you very much, script that I&#39;ve been reading is using both capital I and lower case L, and I didn&#39;t notice that. That fixed the issue. Thank you!"}, {"owner": {"reputation": 524, "user_id": 8269971, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fd2de9dea620d97bc432ee33df7b9fb?s=128&d=identicon&r=PG&f=1", "display_name": "loudmummer", "link": "https://stackoverflow.com/users/8269971/loudmummer"}, "edited": false, "score": 0, "creation_date": 1530608269, "post_id": 51149895, "comment_id": 89284451, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/12292707/how-can-i-use-gccs-i-command-to-add-recursive-folders\">How can I use gcc&#39;s -I command to add recursive folders</a>"}, {"owner": {"reputation": 1251, "user_id": 2298578, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/saqnG.jpg?s=128&g=1", "display_name": "Matthias", "link": "https://stackoverflow.com/users/2298578/matthias"}, "edited": false, "score": 0, "creation_date": 1531940225, "post_id": 51149895, "comment_id": 89789754, "body": "-l (lowercase ell) is a linker option for linking a library... so is anybody going to post an answer?!?"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "reply_to_user": {"reputation": 1251, "user_id": 2298578, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/saqnG.jpg?s=128&g=1", "display_name": "Matthias", "link": "https://stackoverflow.com/users/2298578/matthias"}, "edited": false, "score": 0, "creation_date": 1532013357, "post_id": 51149895, "comment_id": 89823541, "body": "@Matthias Take the chance. Write an answer, mentioning that you create one from knowhow in comments and give credits to the comment authors. If you can, add something of yourself, maybe a quote from gcc help or just better explanation. Offer to delete the answer yourself if any of the authors don&#39;t like it. With these conditions met you are likely to get some grudge-free rep. Most StackOverflow users appreciate or at least tolerate effort to shorten the list of unanswered questions."}], "owner": {"reputation": 11, "user_id": 10022365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oGUnW.png?s=128&g=1", "display_name": "rusty_coin", "link": "https://stackoverflow.com/users/10022365/rusty-coin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1530606341, "creation_date": 1530606341, "question_id": 51149895, "link": "https://stackoverflow.com/questions/51149895/unable-to-get-preprocessed-source-file-or-object-file-if-i-include-header-from-a", "title": "unable to get preprocessed source file or object file if I include header from a different directory", "body": "<p>my folder/file structure:</p>\n\n<pre><code>testing\n    folder\n        head.h\n    main.c\n\nmain.c\n#include \"head.h\"\nint main(){\nfoo(3);\nreturn 1;\n}\n\nhead.h\nvoid foo(int x){\nx = 5;\n}\n</code></pre>\n\n<p>in cmd I go to \"testing\" folder and type in:</p>\n\n<blockquote>\n  <p>gcc -c -lfolder main.c -o main.o</p>\n</blockquote>\n\n<p>but that gets me an error:</p>\n\n<blockquote>\n  <p>main.c:1:18: fatal error: head.h: No such file or directory<br>\n  #include \"head.h\"</p>\n</blockquote>\n\n<p>From what I understand, flag -ldir_name specifies that compiler should look inside of that folder for any #include files.\nCan you please help me undersand what I am doing wrong. I also tried getting preporcessor's output:</p>\n\n<blockquote>\n  <p>gcc -E -lfolder main.c -o main.i</p>\n</blockquote>\n\n<p>again this should look for head.h in \"folder\", paste its content inside of main.c</p>\n"}, {"tags": ["c++", "c"], "comments": [{"owner": {"reputation": 2071, "user_id": 7478530, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cGr5i.png?s=128&g=1", "display_name": "Dragonthoughts", "link": "https://stackoverflow.com/users/7478530/dragonthoughts"}, "edited": false, "score": 3, "creation_date": 1530606532, "post_id": 51149880, "comment_id": 89283409, "body": "<code>strlen</code> in C Strings needs to read every character, looking for a null. C++ string classes can store a value for the length. This means that <code>strlen</code> in C runs in O(N) time, but for C++ strings it can use a slower, but O(1) operation."}, {"owner": {"reputation": 991, "user_id": 3510424, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a62a33ee186ed8c655492271bca43649?s=128&d=identicon&r=PG&f=1", "display_name": "Ankush", "link": "https://stackoverflow.com/users/3510424/ankush"}, "reply_to_user": {"reputation": 2071, "user_id": 7478530, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cGr5i.png?s=128&g=1", "display_name": "Dragonthoughts", "link": "https://stackoverflow.com/users/7478530/dragonthoughts"}, "edited": false, "score": 0, "creation_date": 1530608235, "post_id": 51149880, "comment_id": 89284426, "body": "In addition to @Dragonthoughts&#39;s comment, keep in mind that <code>cout</code> does not simply get to read the size of the string and then print it - <code>cout</code> needs to deal with string in an object-oriented way (i.e. it has to check if you are printing any <code>int</code>s or <code>float</code>s etc.). <code>[f]puts()</code> does no such thing - it simply iterates over every <code>char</code> in the string until it reaches a null-terminator (`&#39;\\0&#39;). Due to this, it makes sense that for small strings, simply iterating over all 1000 (c string functions) or so characters is faster then doing all the complex object-oriented operator-overloading ..."}, {"owner": {"reputation": 991, "user_id": 3510424, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a62a33ee186ed8c655492271bca43649?s=128&d=identicon&r=PG&f=1", "display_name": "Ankush", "link": "https://stackoverflow.com/users/3510424/ankush"}, "edited": false, "score": 0, "creation_date": 1530608240, "post_id": 51149880, "comment_id": 89284430, "body": "... magic C++ must  perform - but there comes a point where going over 2000 characters is much slower than the background work c++ performs on strings."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 991, "user_id": 3510424, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a62a33ee186ed8c655492271bca43649?s=128&d=identicon&r=PG&f=1", "display_name": "Ankush", "link": "https://stackoverflow.com/users/3510424/ankush"}, "edited": false, "score": 1, "creation_date": 1530608548, "post_id": 51149880, "comment_id": 89284613, "body": "@Ankush there is nothing object-oriented here. It&#39;s all about overloading and compile-time decisions."}, {"owner": {"reputation": 991, "user_id": 3510424, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a62a33ee186ed8c655492271bca43649?s=128&d=identicon&r=PG&f=1", "display_name": "Ankush", "link": "https://stackoverflow.com/users/3510424/ankush"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1530608623, "post_id": 51149880, "comment_id": 89284654, "body": "@n.m I believe the c++ printing functions use inheritance, so they end up passing objects around (may be wrong)."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 991, "user_id": 3510424, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a62a33ee186ed8c655492271bca43649?s=128&d=identicon&r=PG&f=1", "display_name": "Ankush", "link": "https://stackoverflow.com/users/3510424/ankush"}, "edited": false, "score": 2, "creation_date": 1530608753, "post_id": 51149880, "comment_id": 89284747, "body": "@Ankush indeed your belief is wrong."}, {"owner": {"reputation": 96, "user_id": 8122594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ab3cd20b74e39bb8dcc65a2dc8f0785?s=128&d=identicon&r=PG&f=1", "display_name": "Merve Kantarc\u0131", "link": "https://stackoverflow.com/users/8122594/merve-kantarc%c4%b1"}, "reply_to_user": {"reputation": 991, "user_id": 3510424, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a62a33ee186ed8c655492271bca43649?s=128&d=identicon&r=PG&f=1", "display_name": "Ankush", "link": "https://stackoverflow.com/users/3510424/ankush"}, "edited": false, "score": 0, "creation_date": 1530608823, "post_id": 51149880, "comment_id": 89284781, "body": "@Ankush why is finding string length is important? Is it something about allocation space for stream?"}, {"owner": {"reputation": 991, "user_id": 3510424, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a62a33ee186ed8c655492271bca43649?s=128&d=identicon&r=PG&f=1", "display_name": "Ankush", "link": "https://stackoverflow.com/users/3510424/ankush"}, "edited": false, "score": 0, "creation_date": 1530609119, "post_id": 51149880, "comment_id": 89284944, "body": "String length is important because, at least in c, &quot;strings&quot; are nothing more than a contagious array of bytes (<code>char []</code>). This means the characters in the string are all next to each other in memory. In order to output the string, <code>fputs()</code> will assume the <code>char *</code> pointer you pass it points to the first character, and it will print that character, then advance to the next character (byte) in memory. If the function didn&#39;t know the string length, how would it know when to stop advancing in memory!"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 2071, "user_id": 7478530, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cGr5i.png?s=128&g=1", "display_name": "Dragonthoughts", "link": "https://stackoverflow.com/users/7478530/dragonthoughts"}, "edited": false, "score": 1, "creation_date": 1530609451, "post_id": 51149880, "comment_id": 89285149, "body": "@Dragonthoughts in order to print n characters, you need to go through n characters. There&#39;s nothing O(1) in it."}, {"owner": {"reputation": 96, "user_id": 8122594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ab3cd20b74e39bb8dcc65a2dc8f0785?s=128&d=identicon&r=PG&f=1", "display_name": "Merve Kantarc\u0131", "link": "https://stackoverflow.com/users/8122594/merve-kantarc%c4%b1"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1530609574, "post_id": 51149880, "comment_id": 89285215, "body": "@n.m. if it is not the cost of finding length, what is the reason of C becoming worse for larger string compared to C++?"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 2, "creation_date": 1530610594, "post_id": 51149880, "comment_id": 89285850, "body": "I guess it <i>is</i> because of the cost of finding length. You see, in order to copy a C string to a stream buffer, one needs to go byte by byte and check for 0 each time. Whereas with C++ strings, one can use a much more efficient block copying. Essentially it&#39;s <code>strcpy</code> vs <code>memcpy</code> difference. Both operations are O(n) but <code>memcpy</code> can me so more efficient (by a constant factor). But this is just a guess, you need to use a profiler in order to be able to tell for sure."}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 1, "creation_date": 1530613515, "post_id": 51149880, "comment_id": 89287783, "body": "Note that every function in stdio are not design to focus performance, try <code>fwrite(test_str, 1, len, file)</code> I think it&#39;s would kill your stats ;)"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "reply_to_user": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1530616094, "post_id": 51149880, "comment_id": 89289417, "body": "@Stargateur I thought of that, too, but the advantage was not as great as I expected.  See <a href=\"https://stackoverflow.com/questions/51149880/fprintf-fputs-vs-cout-performance-for-large-strings/51152268#51152268\">my answer</a>."}], "answers": [{"comments": [{"owner": {"reputation": 96, "user_id": 8122594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ab3cd20b74e39bb8dcc65a2dc8f0785?s=128&d=identicon&r=PG&f=1", "display_name": "Merve Kantarc\u0131", "link": "https://stackoverflow.com/users/8122594/merve-kantarc%c4%b1"}, "edited": false, "score": 0, "creation_date": 1530614712, "post_id": 51152268, "comment_id": 89288554, "body": "Thanks for restating and the code! Could you give more information about overhead of &lt;&lt; and cout?"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1530614888, "post_id": 51152268, "comment_id": 89288673, "body": "What platform are you using? <code>time</code> works differently on Windows from most Unixes."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "reply_to_user": {"reputation": 96, "user_id": 8122594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ab3cd20b74e39bb8dcc65a2dc8f0785?s=128&d=identicon&r=PG&f=1", "display_name": "Merve Kantarc\u0131", "link": "https://stackoverflow.com/users/8122594/merve-kantarc%c4%b1"}, "edited": false, "score": 0, "creation_date": 1530616001, "post_id": 51152268, "comment_id": 89289356, "body": "@MerveKantarc\u0131 No, I can&#39;t, and that&#39;s the weakest part of my answer.  Blaming &quot;the OOP overhead&quot; is a convenient and popular excuse, and it does sometimes have some merit, but well-written OOP code needn&#39;t be that much more expensive.  I don&#39;t know enough about the internal mechanics of C++ iostreams to know what sorts of unavoidable startup overhead these calls might have."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1530616036, "post_id": 51152268, "comment_id": 89289381, "body": "@n.m. MacOS.  (What&#39;s different about <code>time()</code> on Windows?)"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1530616389, "post_id": 51152268, "comment_id": 89289605, "body": "<code>std::time</code> on Windows measures wall time while on Unixes it&#39;s CPU time. You are measuring CPU time. It doesn&#39;t take into account IO time. Try timing your program with the <code>time</code> shell command (or a stopwatch!) to see the difference. Also, the functions you are comparing are apples and oranges (some are formatted output and some are not). std::ostream::write is very likely to have identical performance to std::write. Also, the overhead of iostreams has nothing to do with object orientation (C stdio is <i>also</i> object-oriented, believe it or not)."}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1530616580, "post_id": 51152268, "comment_id": 89289712, "body": "overhead from OOP is often cause by people who don&#39;t care about perf, or because there just use it badly, <code>cout</code> has a very good design and I think the overhead is zero. It doesn&#39;t surprise me that fwrite have the same perf than cout. (Note: that your test is not precise use <code>clock_gettime</code> would give you an accurate time with monotonic clock.) (for example: <code>.&#47;a.out 10000000 100000 &gt; &#47;dev&#47;null</code> give me <code>cout 1 fprintf 251 fputs 251 fwrite 0</code>)"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1530617510, "post_id": 51152268, "comment_id": 89290263, "body": "@n.m. No, <code>time()</code> under Unix measures wall time as well.  But your point about CPU vs. i/o time is well taken, and I&#39;m addressing it in an update to my answer."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "reply_to_user": {"reputation": 96, "user_id": 8122594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ab3cd20b74e39bb8dcc65a2dc8f0785?s=128&d=identicon&r=PG&f=1", "display_name": "Merve Kantarc\u0131", "link": "https://stackoverflow.com/users/8122594/merve-kantarc%c4%b1"}, "edited": false, "score": 0, "creation_date": 1530618329, "post_id": 51152268, "comment_id": 89290740, "body": "@MerveKantarc\u0131 Don&#39;t miss the update I just added, two paragraphs at the end beginning with &quot;any time we&#39;re examining performance, it&#39;s important to remember&quot;."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "reply_to_user": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1530618496, "post_id": 51152268, "comment_id": 89290850, "body": "@Stargateur Good points abut OOP.  <code>time()</code> should be fine, though, as long as the measured times are substantially greater than 1s, and the clock wasn&#39;t changed (or the system put to sleep) between measurements.  (But, yes, normally I&#39;d use <code>gettimeofday</code> or <code>clock_gettime</code>.  But I was in a hurry here.)"}, {"owner": {"reputation": 26077, "user_id": 8157187, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9dbf5a2e56640eeb14bbe0c32fb3679b?s=128&d=identicon&r=PG&f=1", "display_name": "geza", "link": "https://stackoverflow.com/users/8157187/geza"}, "edited": false, "score": 2, "creation_date": 1530618649, "post_id": 51152268, "comment_id": 89290942, "body": "While your explanation is right about searching for &#39;\\0&#39; takes time, your test is a little bit far from real usage. I mean, the OS needs to process the given data, which usually takes significantly more time than the search for &#39;\\0&#39; (I suppose that you redirected stdout to /dev/null, which means the the OS doesn&#39;t have to do anything with the data). If I measure the fastest possible OS processing, writing to ramdisk, the difference is &quot;just&quot; 20% for 100MB blocks: <code>fwrite</code> is 20% faster than <code>fputs</code> (on a linux machine)."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1530618926, "post_id": 51152268, "comment_id": 89291114, "body": "@SteveSummit Sorry, you are right, I was thinking about <code>clock</code>, not <code>time</code>."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1530620054, "post_id": 51152268, "comment_id": 89291812, "body": "FWIW, 99% of (userland) <b>CPU</b> time your program takes is spent in <code>strlen</code> (as profiled with valgrind/callgrind)."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1530624642, "post_id": 51152268, "comment_id": 89295109, "body": "@n.m. My program, or the OP&#39;s?  (I didn&#39;t call <code>strlen</code> directly, and I wouldn&#39;t expect any indirect calls to it, either.)"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "reply_to_user": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1530624823, "post_id": 51152268, "comment_id": 89295239, "body": "@Stargateur Notwithstanding your points about OOP, we do still have the curious result (as shown in the OP&#39;s timings, and mine) that <code>&lt;&lt;</code> to <code>cout</code> is somehow a little slower for small strings.  That result seems significant, and if it&#39;s not &quot;OOP overhead&quot;, what is it?  (I don&#39;t know.)"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1530625039, "post_id": 51152268, "comment_id": 89295380, "body": "Your program. strlen is called from fputs."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1530625623, "post_id": 51152268, "comment_id": 89295796, "body": "@n.m. So I think you mean, <code>strlen</code> is called from <i>your system&#39;s implementation</i> of <code>fputs</code>.  (I don&#39;t know for sure about mine, but obviously it&#39;s possible to implement <code>fputs</code> without calling <code>strlen</code>.)"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1530626110, "post_id": 51152268, "comment_id": 89296148, "body": "Yes. Obviously not all implementations do that, mine is glibc. But all implementations will have to do something very simiilar."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1530627454, "post_id": 51152268, "comment_id": 89297072, "body": "About the overheads: the main one is probably that of <i><a href=\"https://en.cppreference.com/w/cpp/io/ios_base/sync_with_stdio\" rel=\"nofollow noreferrer\">synchronising with stdio</a></i>. Try disabling it."}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1530632776, "post_id": 51152268, "comment_id": 89300436, "body": "@SteveSummit if the input is small the time will be fast, don&#39;t worried about little differences for these case, just worried about performance for big input."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "reply_to_user": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1530635419, "post_id": 51152268, "comment_id": 89301750, "body": "@Stargateur I&#39;m not worried about it, and in my answer I encouraged the OP not to worry about it.  But you have to admit we do have a discrepancy between the statement &quot;<code>cout</code> is just as fast, there&#39;s no &#39;OOP overhead&#39;&quot;, and the data in front of us."}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1530636296, "post_id": 51152268, "comment_id": 89302181, "body": "@SteveSummit Don&#39;t forget that cout is not an equivalent of fwrite, it&#39;s not possible to compare then as they do not do exactly the same thing."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "reply_to_user": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1530637984, "post_id": 51152268, "comment_id": 89303007, "body": "@Stargateur Sure.  But for small sizes, it looks like <code>fputs</code> and <code>fprintf</code> are faster, too.  I do want to investigate n.m&#39;s observation involving stdio synchronization"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1530682638, "post_id": 51152268, "comment_id": 89315911, "body": "Most significant lines of the answer <i>&quot;it&#39;s important to remember that If you have to perform millions of carefully-controlled trials just to detect a small difference, the difference probably doesn&#39;t matter in practice.&quot;</i> <code>:)</code>"}], "tags": [], "owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "is_accepted": false, "score": 6, "last_activity_date": 1530618154, "last_edit_date": 1530618154, "creation_date": 1530613592, "answer_id": 51152268, "question_id": 51149880, "link": "https://stackoverflow.com/questions/51149880/fprintf-fputs-vs-cout-performance-for-large-strings/51152268#51152268", "title": "fprintf/fputs vs cout performance for large strings", "body": "<p>This is an interesting question.  The question, restated, is: why are <code>fputs</code> and <code>fprintf</code> faster for short strings, while <code>&lt;&lt;</code> to <code>cout</code> is faster for longer strings?</p>\n\n<p>I suspect, as suggested in some of the comments, that <code>&lt;&lt;</code> to <code>cout</code> is faster because C++ strings carry their size up-front and explicitly.  C-style strings, on the other hand, require scanning to find the terminating <code>'\\0'</code>, which is an additional expense.</p>\n\n<p>However, the overhead of <code>&lt;&lt;</code> and <code>cout</code> is greater, so its advantages are not seen for shorter strings.</p>\n\n<p>I wrote another version of your program (attached below) and tried it on various string sizes and numbers of trials, with these results on my machine.  I also threw the stdio function <code>fwrite</code> into the mix.</p>\n\n<pre><code>string length   trials       cout     fprintf  fputs    fwrite\n10              100000000    9        8        8        7\n100             100000000    10       9        8        8\n1000            100000000    14       17       18       12\n10000           10000000     6        10       10       6\n100000          1000000      4        10       9        4\n1000000         1000000     11        72       71       10\n10000000        100000       7        95       94       8\n</code></pre>\n\n<p>Presumably the important distinction is that <code>fprintf</code> and <code>fputs</code> have to print the characters <em>while simultaneously checking each one to see whether it's <code>\\0</code></em>.  <code>cout</code> and <code>&lt;&lt;</code>, on the other hand, like <code>fwrite</code>, know the count of characters up front, and so can blindly write exactly that many.</p>\n\n<p>The power and flexibility of <code>cout</code> and <code>&lt;&lt;</code> come at a (small) price, but it seems to be a one-time cost, per \"call\" rather than per character written.</p>\n\n<p>And then <code>fwrite</code>, which also knows the count up front, does just as well as <code>cout</code>, or better.  It looks like <code>cout</code> somehow ekes out a win on the last, hugest trial, which is a bit of a surprise.  It may just be because every call to <code>fwrite</code> has to pass four arguments, and <code>fwrite</code> has to do an extra multiplication of <code>nels</code> \u00d7 <code>elsize</code>.</p>\n\n<p>But with all of this said, any time we're examining performance, it's important to remember that <em>If you have to perform millions of carefully-controlled trials just to detect a small difference, the difference probably doesn't matter in practice</em>.  Use the style of i/o that's most natural for you, the problem you're solving, and the language you're using.  Unless you're writing a high-performance program that's i/o intensive, it probably won't matter which i/o calls you use.</p>\n\n<p>In particular, I cheated: I ran all of my trials with standard output redirected to /dev/null, to minimize the i/o time, and maximize any actual computational differences between the four methods under test.  If the output had been \"real\" -- to a file, pipe, or network stream -- I suspect it would have dominated the performance, and I would have had to perform many more trials to show any difference between the methods.</p>\n\n<p>Finally, here's the program I used:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;time.h&gt;\n#include &lt;string&gt;\n#include &lt;iostream&gt;\n\nint main(int argc, char *argv[])\n{\n    int n = atoi(argv[1]);\n    int m = atoi(argv[2]);\n    char *p = (char *)malloc(n);\n    memset(p, 'x', n-2);\n    p[n-2] = '\\n';\n    p[n-1] = '\\0';\n    std::string s = p;\n    int i;\n    time_t t1, t2, t3, t4, t5;\n\n    t1 = time(NULL);\n    for(i = 0; i &lt; m; i++)\n        std::cout &lt;&lt; s;\n    t2 = time(NULL);\n    for(i = 0; i &lt; m; i++)\n        fprintf(stdout, \"%s\", p);\n    t3 = time(NULL);\n    for(i = 0; i &lt; m; i++)\n        fputs(p, stdout);\n    t4 = time(NULL);\n    for(i = 0; i &lt; m; i++)\n        fwrite(p, 1, n, stdout);\n    t5 = time(NULL);\n\n    fprintf(stderr, \"cout %ld \",    t2-t1);\n    fprintf(stderr, \"fprintf %ld \", t3-t2);\n    fprintf(stderr, \"fputs %ld \",   t4-t3);\n    fprintf(stderr, \"fwrite %ld\\n\", t5-t4);\n}\n</code></pre>\n"}], "owner": {"reputation": 96, "user_id": 8122594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ab3cd20b74e39bb8dcc65a2dc8f0785?s=128&d=identicon&r=PG&f=1", "display_name": "Merve Kantarc\u0131", "link": "https://stackoverflow.com/users/8122594/merve-kantarc%c4%b1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1309, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1530681776, "creation_date": 1530606290, "last_edit_date": 1530681776, "question_id": 51149880, "link": "https://stackoverflow.com/questions/51149880/fprintf-fputs-vs-cout-performance-for-large-strings", "title": "fprintf/fputs vs cout performance for large strings", "body": "<p>When I made tests on <code>fprintf()</code>, <code>fputs()</code>, and <code>ofstream operator (&lt;&lt;)</code>, I realized C functions(both) offer better run-time performance, but when input strings get larger, both C functions run slower than C++'s operator. </p>\n\n<p>I wonder the reason of bad performance of C++ on small strings, and the reason why it outperforms the C for larger strings.</p>\n\n<p>Appreciate it.</p>\n\n<p>Note: Unfortunately, I couldn't share the strings for size 1000+ chars.</p>\n\n<p><strong>Test Results</strong> </p>\n\n<pre><code>- String Size -&gt; 20 chars, C++(&lt;&lt;): 0,80 C(fprintf): 0,50 C(fputs):\n   0,20\n- String Size -&gt; 50 chars, C++(&lt;&lt;): 1,06 C(fprintf): 0,80 C(fputs):\n   0,35\n- String Size -&gt; 1000 chars, C++(&lt;&lt;): 6,39 C(fprintf): 8,35 C(fputs):\n   5,01\n\n-  String Size -&gt; 2000 chars, C++(&lt;&lt;): 12,33 C(fprintf): 16,84 C(fputs):\n   9,06\n\n-   String Size -&gt; 50000 chars, C++(&lt;&lt;): 0,20 C(fprintf): 0,39 C(fputs):\n   0,27 (1000 runs instead of 1 million runs)\n\n-   String Size -&gt; 100000 chars, C++(&lt;&lt;): 0,40 C(fprintf): 0,45 C(fputs):\n   0,74 (1000 runs instead of 1 million runs)\n</code></pre>\n\n<p><strong>Here is the code</strong></p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;fstream&gt;\n#include &lt;string.h&gt;\n#include \"Stopwatch.h\"\n\nusing namespace std;\n\nvoid testNewline(string test_str,int run){\n    StopWatch timer;\n    ofstream outdata(\"writeToFile-CPP-newline.txt\");\n    timer.start();\n    for (int i = 0 ; i &lt; run ; i++){\n        outdata &lt;&lt; i &lt;&lt; \":\" &lt;&lt; test_str &lt;&lt; \"\\n\";\n    }\n    timer.stop();\n    outdata.close();\n    cout &lt;&lt; \"C++ Time spent:  - \" &lt;&lt; timer.seconds() &lt;&lt; endl;\n}\n\nint main() {\n    int run = 1000000;\n    string test_str(str100);\n    size_t len = test_str.length();\n    cout &lt;&lt; \"Write File - \" &lt;&lt; run &lt;&lt; \" Runs\\n\";\n    cout &lt;&lt; \"Length is \" &lt;&lt; len &lt;&lt; \" chars\\n\";\n\n    testNewline(test_str,run);\n\n    return 0;\n}\n</code></pre>\n\n<p><strong>Stopwatch.h - Cpp</strong></p>\n\n<pre><code>#include &lt;time.h&gt;\n#ifndef STOPWATCH_H_\n#define STOPWATCH_H_\n\n#define str20 \"a very long literal \"\n#define str50 \"a very long literal string a very very long string\"\n#define str100 \"a very long literal string a very very long stringa very long literal string a very very long string\"\n#define str1000 ...\n#define str2000 ...\n#define str50000 ...\n\nclass StopWatch{\nprivate:\n    clock_t start_;\n    clock_t end_;\n    bool isRunning_;\npublic:\n    void start(){\n        start_ = clock();\n        end_ = 0;\n        isRunning_ = true;\n    }\n\n    void stop(){\n        if(isRunning_){\n            end_ = clock();\n            isRunning_ = false;\n        }\n    }\n\n    double seconds() const\n    {\n        return double (end_ - start_) / CLOCKS_PER_SEC;\n    }\n\n    StopWatch(): start_(), end_(), isRunning_() {}\n};    \n#endif /* STOPWATCH_H_ */\n</code></pre>\n\n<p><strong>WriteFile.c</strong></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include \"Stopwatch.h\"\n\nint main(void) {\n\n    const int run = 1000000;\n    int i;\n    size_t len = strlen(str100);\n    char *test_str = (char *) malloc(sizeof(char)*(len+1));\n    strcpy(test_str,str100);\n\n    FILE *file = fopen(\"writeToFile-C.txt\",\"w\");\n    clock_t start_ = start();\n    for (i = 0; i &lt; run ; i++){\n        fputs(test_str,file);\n    }\n    clock_t end_ = stop();\n    fclose(file);\n\n    printf(\"Write File - %d Runs\\nString Length is %d chars\\nC (fputs) Time spent: %.2f seconds\\n\",run,len,seconds(start_,end_));\n\n    FILE *file2 = fopen(\"writeToFile-C-2.txt\",\"w\");\n    clock_t start2_ = start();\n    for (i = 0; i &lt; run ; i++){\n        fprintf(file2,\"%d:%s\\n\",i,test_str);\n    }\n    clock_t end2_ = stop();\n    fclose(file2);\n\n    printf(\"Write File - %d Runs\\nString Length is %d chars\\nC (fprintf) Time spent: %.2f seconds\\n\",run,len,seconds(start2_,end2_));\n\n    return EXIT_SUCCESS;\n}\n</code></pre>\n\n<p><strong>StopWatch.h - C</strong>  </p>\n\n<pre><code>#include &lt;time.h&gt;\n#include &lt;string.h&gt;\n#ifndef STOPWATCH_H_\n#define STOPWATCH_H_\n\n#define str20 \"a very long literal \"\n#define str50 \"a very long literal string a very very long string\"\n#define str100 \"a very long literal string a very very long stringa very long literal string a very very long string\"\n#define str1000 ...\n#define str2000 ...\n#define str50000 ...  \n\nclock_t start(){\n    return clock();\n}\n\nclock_t stop(){\n    return clock();\n}\n\ndouble seconds(clock_t start, clock_t end)\n{\n    return (double) (end - start) / CLOCKS_PER_SEC;\n}\n\n#endif /* STOPWATCH_H_ */\n</code></pre>\n\n<p>I used MinGW Compiler.  </p>\n\n<p>Compile code for C++ : g++ -O3 -Wall -c<br>\nCompile code for C: gcc -O3 -Wall -c  </p>\n\n<p>Edit: I am not worried about the insignificant difference for small strings, but it is an academic curiosity.</p>\n"}, {"tags": ["python", "c"], "comments": [{"owner": {"reputation": 9345, "user_id": 1021920, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/VukgG.jpg?s=128&g=1", "display_name": "hellow", "link": "https://stackoverflow.com/users/1021920/hellow"}, "edited": false, "score": 0, "creation_date": 1530600406, "post_id": 51148129, "comment_id": 89280279, "body": "Why are you not going with the regex option? It should suit your purpose (although if you really want to catch every possible notation, you should go for something bigger like a parser, but I think this is out of this context)"}, {"owner": {"reputation": 2887, "user_id": 2422450, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65c899826b7012b67268ee1899b40419?s=128&d=identicon&r=PG", "display_name": "Lanting", "link": "https://stackoverflow.com/users/2422450/lanting"}, "edited": false, "score": 1, "creation_date": 1530600412, "post_id": 51148129, "comment_id": 89280281, "body": "Would using a library to build a complete AST be too much? <a href=\"https://github.com/eliben/pycparser\" rel=\"nofollow noreferrer\">github.com/eliben/pycparser</a> seems to be able to do this in pure python."}, {"owner": {"reputation": 2887, "user_id": 2422450, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65c899826b7012b67268ee1899b40419?s=128&d=identicon&r=PG", "display_name": "Lanting", "link": "https://stackoverflow.com/users/2422450/lanting"}, "edited": false, "score": 0, "creation_date": 1530600504, "post_id": 51148129, "comment_id": 89280324, "body": "this example from the above library lists all the functions: <a href=\"https://github.com/eliben/pycparser/blob/master/examples/func_defs.py\" rel=\"nofollow noreferrer\">github.com/eliben/pycparser/blob/master/examples/func_defs.p&zwnj;&#8203;y</a>"}, {"owner": {"reputation": 592, "user_id": 4264155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00606b6f44e3bb6dcce12d100b01f3a6?s=128&d=identicon&r=PG", "display_name": "Shrikanth N", "link": "https://stackoverflow.com/users/4264155/shrikanth-n"}, "reply_to_user": {"reputation": 9345, "user_id": 1021920, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/VukgG.jpg?s=128&g=1", "display_name": "hellow", "link": "https://stackoverflow.com/users/1021920/hellow"}, "edited": false, "score": 0, "creation_date": 1530600582, "post_id": 51148129, "comment_id": 89280356, "body": "@hellow - the regex option would help me identify the function name but would need additional code to update something in the function. I was looking at maybe finding the opening and closing braces of a function and add the printf."}, {"owner": {"reputation": 592, "user_id": 4264155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00606b6f44e3bb6dcce12d100b01f3a6?s=128&d=identicon&r=PG", "display_name": "Shrikanth N", "link": "https://stackoverflow.com/users/4264155/shrikanth-n"}, "reply_to_user": {"reputation": 2887, "user_id": 2422450, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65c899826b7012b67268ee1899b40419?s=128&d=identicon&r=PG", "display_name": "Lanting", "link": "https://stackoverflow.com/users/2422450/lanting"}, "edited": false, "score": 0, "creation_date": 1530600667, "post_id": 51148129, "comment_id": 89280407, "body": "@Lanting - thanks, the link you shared looks interesting. Let me check it out."}, {"owner": {"reputation": 695058, "user_id": 20862, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2343ae368d3241278581ce6c87f62a25?s=128&d=identicon&r=PG", "display_name": "Ignacio Vazquez-Abrams", "link": "https://stackoverflow.com/users/20862/ignacio-vazquez-abrams"}, "edited": false, "score": 1, "creation_date": 1530600683, "post_id": 51148129, "comment_id": 89280417, "body": "Why are you not using your C compiler&#39;s option to instrument functions?"}, {"owner": {"reputation": 21326, "user_id": 1679849, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpvxY.png?s=128&g=1", "display_name": "r3mainer", "link": "https://stackoverflow.com/users/1679849/r3mainer"}, "edited": false, "score": 1, "creation_date": 1530600783, "post_id": 51148129, "comment_id": 89280474, "body": "You appear to be adding debugging information to your executable file. If so, you might be better off using the tools already available. Try compiling your code with the <code>-g</code> flag to include information about <a href=\"https://stackoverflow.com/a/89619/1679849\">symbols and line numbers</a>, then run your program inside a debugger like GDB."}, {"owner": {"reputation": 592, "user_id": 4264155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00606b6f44e3bb6dcce12d100b01f3a6?s=128&d=identicon&r=PG", "display_name": "Shrikanth N", "link": "https://stackoverflow.com/users/4264155/shrikanth-n"}, "reply_to_user": {"reputation": 695058, "user_id": 20862, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2343ae368d3241278581ce6c87f62a25?s=128&d=identicon&r=PG", "display_name": "Ignacio Vazquez-Abrams", "link": "https://stackoverflow.com/users/20862/ignacio-vazquez-abrams"}, "edited": false, "score": 0, "creation_date": 1530600834, "post_id": 51148129, "comment_id": 89280499, "body": "@IgnacioVazquez-Abrams - I am aware of some code instrumentation tools but not sure about the C compiler option. Could you please, elaborate or maybe share some links?"}, {"owner": {"reputation": 592, "user_id": 4264155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00606b6f44e3bb6dcce12d100b01f3a6?s=128&d=identicon&r=PG", "display_name": "Shrikanth N", "link": "https://stackoverflow.com/users/4264155/shrikanth-n"}, "reply_to_user": {"reputation": 21326, "user_id": 1679849, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpvxY.png?s=128&g=1", "display_name": "r3mainer", "link": "https://stackoverflow.com/users/1679849/r3mainer"}, "edited": false, "score": 0, "creation_date": 1530601013, "post_id": 51148129, "comment_id": 89280594, "body": "@squeamishossifrage - sorry for not adding more details. I am not using Linux and I am running this on a microcontroller. Only output available for me is the printf on debugger with limited capabilities."}, {"owner": {"reputation": 198, "user_id": 9317706, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd96f97c58b306523bb8defb014daab6?s=128&d=identicon&r=PG&f=1", "display_name": "purec", "link": "https://stackoverflow.com/users/9317706/purec"}, "edited": false, "score": 0, "creation_date": 1530602576, "post_id": 51148129, "comment_id": 89281361, "body": "1)search for open  curly bracket 2)search back for &#39;(&#39; 3)skip spaces backward 4) for (i; isalnum(buf[i]) || buf[i] == &#39;_&#39;; i--); 5)i++; and buf[i] now is first letter of the func. name  6)Insert after next &#39;\\n&#39;."}, {"owner": {"reputation": 1101, "user_id": 3936601, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/3b55dba01070e7c3a4ee30b401d084d8?s=128&d=identicon&r=PG", "display_name": "Evan Benn", "link": "https://stackoverflow.com/users/3936601/evan-benn"}, "reply_to_user": {"reputation": 695058, "user_id": 20862, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2343ae368d3241278581ce6c87f62a25?s=128&d=identicon&r=PG", "display_name": "Ignacio Vazquez-Abrams", "link": "https://stackoverflow.com/users/20862/ignacio-vazquez-abrams"}, "edited": false, "score": 1, "creation_date": 1530603019, "post_id": 51148129, "comment_id": 89281579, "body": "@IgnacioVazquez-Abrams following on : gcc -finstrument-functions (since you are on embedded, you are probably on gcc). <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Instrumentation-Options.html\" rel=\"nofollow noreferrer\">gcc.gnu.org/onlinedocs/gcc/Instrumentation-Options.html</a>"}, {"owner": {"reputation": 6899, "user_id": 1212012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gmBY7.png?s=128&g=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1212012/mathieu"}, "edited": false, "score": 1, "creation_date": 1530603120, "post_id": 51148129, "comment_id": 89281625, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/8884335/print-the-file-name-line-number-and-function-name-of-a-calling-function-c-pro\">Print the file name, line number and function name of a calling function - C Prog</a>"}], "answers": [{"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1530602027, "post_id": 51148212, "comment_id": 89281100, "body": "The names are case sensitive; file and line should be upper-case."}, {"owner": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 1, "creation_date": 1530602488, "post_id": 51148212, "comment_id": 89281331, "body": "<code>__LINE__</code> requires a <code>%d</code> instead of the <code>%s</code>."}], "tags": [], "owner": {"reputation": 855, "user_id": 3659239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3b6ed436c73d42ba39748209936b7e7?s=128&d=identicon&r=PG&f=1", "display_name": "Sandy", "link": "https://stackoverflow.com/users/3659239/sandy"}, "is_accepted": false, "score": 2, "last_activity_date": 1530603579, "last_edit_date": 1530603579, "creation_date": 1530600573, "answer_id": 51148212, "question_id": 51148129, "link": "https://stackoverflow.com/questions/51148129/identify-c-functions-opening-and-closing-braces-in-a-file/51148212#51148212", "title": "Identify C functions (opening and closing braces) in a file", "body": "<p>You can use predefined macros such as __file__, __func__ and __line__. This would result in a common printf statement:</p>\n\n<pre><code>printf(\"%s, %s, %d\\n\", __FILE__, __func__, __LINE__)\n</code></pre>\n\n<p>which you need to add to each function.</p>\n\n<p>This question has already be similarly answered here: \n<a href=\"https://stackoverflow.com/questions/8884335/print-the-file-name-line-number-and-function-name-of-a-calling-function-c-pro\">Print the file name, line number and function name of a calling function - C Prog</a></p>\n"}], "owner": {"reputation": 592, "user_id": 4264155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00606b6f44e3bb6dcce12d100b01f3a6?s=128&d=identicon&r=PG", "display_name": "Shrikanth N", "link": "https://stackoverflow.com/users/4264155/shrikanth-n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 192, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1530607493, "creation_date": 1530600274, "last_edit_date": 1530607493, "question_id": 51148129, "link": "https://stackoverflow.com/questions/51148129/identify-c-functions-opening-and-closing-braces-in-a-file", "title": "Identify C functions (opening and closing braces) in a file", "body": "<p>I have a C file in which I would like to add a print at the beginning and end of each function that includes file name, function name and line number.\nI am trying to automate this for an entire folder of C files using python.</p>\n\n<p>Example: For function add in math.c file </p>\n\n<pre><code>int add(int a, int b){\n   sum = a +b;\n   return sum;\n}\n</code></pre>\n\n<p>I would want the result file to look something like this:</p>\n\n<pre><code>int add(int a, int b){\n   printf(\"Math.c, add, 12\");\n   sum = a +b;\n   return sum;     \n}\n</code></pre>\n\n<p>I am looking at the regex as suggested in this link <a href=\"https://stackoverflow.com/questions/13781941/using-python-regex-to-find-c-function-in-file\">Using Python Regex to Find C function in File</a></p>\n\n<p>Any other suggestions? Ctags is the other option I am exploring, but I prefer using python libraries if any for this purpose.</p>\n\n<p>Edit:</p>\n\n<ul>\n<li>Running the code on a microcontroller</li>\n<li>Not using Linux</li>\n<li>Debugger with limited capabilities (can get printf only)</li>\n</ul>\n"}, {"tags": ["c", "sizeof"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1530599291, "post_id": 51147839, "comment_id": 89279726, "body": "Why would there need to be a variable? <code>sizeof 42</code> is valid code, too."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 1, "creation_date": 1530599339, "post_id": 51147839, "comment_id": 89279758, "body": "Values (like an address) don&#39;t just exist in the ether. They have types too."}, {"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "edited": false, "score": 0, "creation_date": 1530602185, "post_id": 51147839, "comment_id": 89281180, "body": "Since <code>sizeof</code> is an operator, the <code>()</code>s are not needed unless the argument is a type, in which case it&#39;s formatted as a cast expression to that type. Compare <code>sizeof (int)</code> and <code>(int) 1.2</code>, the <code>(int)</code> in both expressions is a cast."}, {"owner": {"reputation": 803, "user_id": 9121710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a26c73e3b497ece31c07048738ee689?s=128&d=identicon&r=PG", "display_name": "LocalHost", "link": "https://stackoverflow.com/users/9121710/localhost"}, "reply_to_user": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "edited": false, "score": 0, "creation_date": 1530602640, "post_id": 51147839, "comment_id": 89281393, "body": "@unwind can you explain in more detail,i don&#39;t understand"}, {"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "edited": false, "score": 0, "creation_date": 1530603731, "post_id": 51147839, "comment_id": 89281946, "body": "@user9121710 I was just trying to correct the way you put it in the title, the operator is <code>sizeof</code>, not <code>sizeof()</code>. Your code could (should, in my opinion) be written <code>sizeof &amp;a</code>, since it&#39;s not a function call and there&#39;s no point in making it look like one."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 1, "creation_date": 1530611435, "post_id": 51147839, "comment_id": 89286407, "body": "@user9121710 The point made by unwind, though significant, was unnecessary and confusing, and has no bearing on the question you asked.  There&#39;s nothing wrong (in my opinion) with writing <code>sizeof(&amp;a)</code>, even though the parentheses may be considered superfluous in this case."}], "answers": [{"tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 4, "last_activity_date": 1530599414, "last_edit_date": 1530599414, "creation_date": 1530599028, "answer_id": 51147855, "question_id": 51147839, "link": "https://stackoverflow.com/questions/51147839/address-as-a-operand-in-sizeof-operator/51147855#51147855", "title": "Address as a operand in sizeof() operator", "body": "<p><code>sizeof</code> operator works on the <em>type</em> of the operand.</p>\n\n<p>Quoting <code>C11</code>, chapter \u00a76.5.3.4 (<em>emphasis mine</em>)</p>\n\n<blockquote>\n  <p>The sizeof operator yields the size (in bytes) of its operand, which may be an\n  expression or the parenthesized name of a type. <strong>The size is determined from the type of\n  the operand.</strong> [....]</p>\n</blockquote>\n\n<p><code>&amp;a</code> is of type <code>int *</code>, so your statement is the same as <code>sizeof(int *)</code>. The result, is the size of a pointer (to integer), in your platform.</p>\n\n<p>That said, <code>sizeof</code> produces a type of <code>size_t</code> as result, </p>\n\n<ul>\n<li>use a variable of type <code>size_t</code></li>\n<li>use <code>%zu</code> to print the result.</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 767708, "user_id": 14860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vXG1F.png?s=128&g=1", "display_name": "paxdiablo", "link": "https://stackoverflow.com/users/14860/paxdiablo"}, "is_accepted": true, "score": 7, "last_activity_date": 1530599461, "creation_date": 1530599461, "answer_id": 51147956, "question_id": 51147839, "link": "https://stackoverflow.com/questions/51147839/address-as-a-operand-in-sizeof-operator/51147956#51147956", "title": "Address as a operand in sizeof() operator", "body": "<p>It's because <code>sizeof</code> returns the size of a <em>type,</em> as per <code>C11 6.5.3.4 The sizeof and _Alignof operators /2</code> (my emphasis):</p>\n\n<blockquote>\n  <p>The sizeof operator yields the size (in bytes) of its operand, which may be an expression or the parenthesized name of a type. The size is determined from the <strong><em>type</em></strong> of the operand.</p>\n</blockquote>\n\n<p>The type of <code>&amp;a</code> where <code>a</code> is an <code>int</code> is covered by <code>6.5.3.2 Address and indirection operators /3</code> in the same standard:</p>\n\n<blockquote>\n  <p>The unary <code>&amp;</code> operator yields the address of its operand. <strong><em>If the operand has type \"type\", the result has type \"pointer to type\".</em></strong></p>\n</blockquote>\n\n<p>In other words, <code>int a; sizeof(&amp;a)</code> is functionally equivalent to <code>sizeof(int *)</code>.</p>\n"}], "owner": {"reputation": 803, "user_id": 9121710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a26c73e3b497ece31c07048738ee689?s=128&d=identicon&r=PG", "display_name": "LocalHost", "link": "https://stackoverflow.com/users/9121710/localhost"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 51147956, "answer_count": 2, "score": 1, "last_activity_date": 1530599461, "creation_date": 1530598955, "last_edit_date": 1530599345, "question_id": 51147839, "link": "https://stackoverflow.com/questions/51147839/address-as-a-operand-in-sizeof-operator", "title": "Address as a operand in sizeof() operator", "body": "<p>I was just trying an example and i tried to check the output when an address is passed as an argument in the <code>sizeof</code>\noperator and i got output of 4. Now my question is when you pass a pointer in <code>sizeof</code> operator why is it showing 4 bytes of memory when actually there is no pointer variable, it's just only an address?</p>\n\n<pre><code>#include&lt;stdio.h&gt;\nint main()\n{\n  int a=1;\n  int c;\n  c=sizeof(&amp;a);\n  printf(\"%d\\n\",c);\n  return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "linux"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1530598614, "post_id": 51147640, "comment_id": 89279421, "body": "Did you check <a href=\"http://man7.org/linux/man-pages/man3/posix_spawn.3.html#RETURN_VALUE\" rel=\"nofollow noreferrer\">the documentation for <code>posix_spawn</code></a>?"}], "answers": [{"tags": [], "owner": {"reputation": 61409, "user_id": 485343, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e18b024a122df74275dd2c4486e8a2b4?s=128&d=identicon&r=PG", "display_name": "rustyx", "link": "https://stackoverflow.com/users/485343/rustyx"}, "is_accepted": true, "score": 2, "last_activity_date": 1530598851, "creation_date": 1530598851, "answer_id": 51147813, "question_id": 51147640, "link": "https://stackoverflow.com/questions/51147640/handling-errors-of-posix-spawn/51147813#51147813", "title": "Handling errors of posix_spawn()", "body": "<p>Yes, <code>posix_spawn()</code> returns <code>0</code> on success and <code>errno</code> on failure. So it's OK to pass its result to <code>strerror</code>.</p>\n\n<p>According to the <a href=\"http://man7.org/linux/man-pages/man3/posix_spawn.3.html#ERRORS\" rel=\"nofollow noreferrer\">documentation</a>:</p>\n\n<blockquote>\n  <p>The <code>posix_spawn()</code> and <code>posix_spawnp()</code> functions fail only in the case\n         where the underlying <code>fork(2)</code> or <code>vfork(2)</code> call fails;  in these cases,\n         these functions return an error number, which will be one of the\n         errors described for <code>fork(2)</code> or <code>vfork(2)</code>.</p>\n  \n  <p>In addition, these functions fail if:</p>\n  \n  <p><code>ENOSYS</code> Function not supported on this system.</p>\n</blockquote>\n\n<p>Also from the source you can see that it simply returns <a href=\"https://code.woboq.org/userspace/glibc/sysdeps/unix/sysv/linux/spawni.c.html#331\" rel=\"nofollow noreferrer\"><code>errno</code></a>.</p>\n"}], "owner": {"reputation": 340, "user_id": 7066872, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DIBIAsbq4Tk/AAAAAAAAAAI/AAAAAAAAHzM/F-_1T8MeBdc/photo.jpg?sz=128", "display_name": "H. Jang", "link": "https://stackoverflow.com/users/7066872/h-jang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 607, "favorite_count": 0, "accepted_answer_id": 51147813, "answer_count": 1, "score": 1, "last_activity_date": 1530598851, "creation_date": 1530598054, "question_id": 51147640, "link": "https://stackoverflow.com/questions/51147640/handling-errors-of-posix-spawn", "title": "Handling errors of posix_spawn()", "body": "<p>I've found an example code using <code>posix_spaw()</code> from <a href=\"https://www.systutorials.com/37124/a-posix_spawn-example-in-c-to-create-child-process-on-linux/\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>In that page, <code>run_cmd()</code> is defined like below.</p>\n\n<pre><code>void run_cmd(char *cmd) {\n    ...\n    status = posix_spawn(&amp;pid, \"/bin/sh\", NULL, NULL, argv, environ);\n    if (status == 0) {\n        printf(\"Child pid: %i\\n\", pid);\n    } else {\n        printf(\"posix_spawn: %s\\n\", strerror(status));\n    }\n}\n</code></pre>\n\n<p>My question is \"Is it okay to give return value of <code>posix_spawn()</code> to <code>strerror()</code> as an argument\".</p>\n\n<p>If it is not okay, what would be the best way to handle errors of <code>posix_spawn()</code>?</p>\n"}, {"tags": ["c", "terminal"], "comments": [{"owner": {"reputation": 37256, "user_id": 736308, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/o5EqQ.jpg?s=128&g=1", "display_name": "cdarke", "link": "https://stackoverflow.com/users/736308/cdarke"}, "edited": false, "score": 1, "creation_date": 1530596260, "post_id": 51147246, "comment_id": 89278563, "body": "It is not the terminal that requires a password but some program you are running.  Some programs just read <code>stdin</code> but some use low-level terminal IO to ensure that passwords have to be entered manually.  You will have to look at each program to find which method they use."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1530596426, "post_id": 51147246, "comment_id": 89278623, "body": "I think you would be better off with an existing single-sign-on tool. You are not asking for such a tool (which would be off-topic), I know. But it would be worth the effort of searching."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10010796"}, "edited": false, "score": 0, "creation_date": 1530596800, "post_id": 51147246, "comment_id": 89278767, "body": "I&#39;m actually looking to input the computer admin password and not a program password. I also would like to know how to detect when bash requires a password"}, {"owner": {"reputation": 37256, "user_id": 736308, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/o5EqQ.jpg?s=128&g=1", "display_name": "cdarke", "link": "https://stackoverflow.com/users/736308/cdarke"}, "edited": false, "score": 0, "creation_date": 1530597174, "post_id": 51147246, "comment_id": 89278896, "body": "<code>bash</code> does not require a password, but the login process might, or the <code>sudo</code> program (which has nothing to do with <code>bash</code>).  Under what circumstances are you requiring a password?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10010796"}, "edited": false, "score": 0, "creation_date": 1530597590, "post_id": 51147246, "comment_id": 89279021, "body": "I meant sudo bash"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1530604970, "post_id": 51147246, "comment_id": 89282553, "body": "@F3nrir that is what every one is trying to explain to you. The terminal does not require your password. It is one of the program that actually needs the password and the terminal just takes it from you and passes it on to the program through some &quot;means&quot;. If you are trying to execute a command, with <code>sudo</code>, then it is the program named <code>sudo</code> that is asking for the password."}, {"owner": {"reputation": 927, "user_id": 466932, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/424347075f5b5405bfb7ca79a9aa264b?s=128&d=identicon&r=PG", "display_name": "Unmanned Player", "link": "https://stackoverflow.com/users/466932/unmanned-player"}, "edited": false, "score": 0, "creation_date": 1530756666, "post_id": 51147246, "comment_id": 89347262, "body": "@F3nrir You can use <code>expect</code>, <code>sshpass</code> and few others to deal with these cases. But you really need to know what your program is like Yunnosch and cdrake mentioned."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user10010796"}, "edited": false, "score": 0, "creation_date": 1530596878, "post_id": 51147314, "comment_id": 89278796, "body": "I already knew this and I would still like to know how to insert passwords into terminal through c though"}, {"owner": {"reputation": 151, "user_id": 5701631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd4416b47b386a7e776f9a2e1596d6fb?s=128&d=identicon&r=PG&f=1", "display_name": "Nova Ardent", "link": "https://stackoverflow.com/users/5701631/nova-ardent"}, "edited": false, "score": 0, "creation_date": 1530597119, "post_id": 51147314, "comment_id": 89278877, "body": "Would this solve your problem?  <a href=\"https://stackoverflow.com/questions/29456701/execute-sudo-command-in-c-with-system\" title=\"execute sudo command in c with system\">stackoverflow.com/questions/29456701/&hellip;</a>"}], "tags": [], "owner": {"reputation": 151, "user_id": 5701631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd4416b47b386a7e776f9a2e1596d6fb?s=128&d=identicon&r=PG&f=1", "display_name": "Nova Ardent", "link": "https://stackoverflow.com/users/5701631/nova-ardent"}, "is_accepted": false, "score": 0, "last_activity_date": 1530596388, "creation_date": 1530596388, "answer_id": 51147314, "question_id": 51147246, "link": "https://stackoverflow.com/questions/51147246/entering-password-into-terminal-through-c/51147314#51147314", "title": "Entering password into terminal through c", "body": "<p>If you have access to the terminal, why not use bash for these setups? In both instances of C, or bash, if you're accessing high privilege level areas, you'll need privilege access. The thing you'd be looking for would be a sudo command. It'll prompt you for the password prior to running it, and is just ran as follows:</p>\n\n<pre><code>sudo someExecutable\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7193, "user_id": 765971, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2f390fb2ccc9321e41ca5bcd09cb9a9a?s=128&d=identicon&r=PG", "display_name": "SKi", "link": "https://stackoverflow.com/users/765971/ski"}, "is_accepted": false, "score": 0, "last_activity_date": 1530781882, "creation_date": 1530781882, "answer_id": 51187469, "question_id": 51147246, "link": "https://stackoverflow.com/questions/51147246/entering-password-into-terminal-through-c/51187469#51187469", "title": "Entering password into terminal through c", "body": "<p>Some programs (that prompts for password) use <code>isatty(STDIN_FILENO)</code> call for ensuring that password is typed via terminal.</p>\n\n<p>In that case it not possible use normal pipes for sending password to the program.</p>\n\n<p>For those programs, you can create a pseudo terminal, that is used instead of a pipe. Example:</p>\n\n<pre><code>void test(void)\n{\n    const int fdm = posix_openpt(O_RDWR | O_NOCTTY);\n    if (fdm != -1)\n    {\n        char name[100];\n        unlockpt(fdm);\n        ptsname_r(fdm, name, sizeof(name));\n\n        const int fds = open(name, O_RDWR | O_NOCTTY);\n        if (fds != -1)\n        {\n            const pid_t child_pid = fork();\n\n            if (child_pid == -1)\n            {\n                // TODO: Error handling\n            }\n            else if (child_pid == 0)\n            {\n                dup2(fds, STDIN_FILENO);\n                dup2(fds, STDOUT_FILENO);\n                close(fds);\n                close(fdm);\n                execl(\"/sbin/program_that_requires_password_from_terminal\", \"blabla\", (char*) NULL);\n            }\n            else\n            {\n                const char password[] = \"mypassword\\n\";\n                int status;\n                close(fds);\n                // TODO: wait prompt from the program by reading fdm\n                write(fdm, password, strlen(password));\n                waitpid(-1, &amp;status, 0);\n                close(fdm);\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>In that way <code>isatty(STDIN_FILENO)</code> in the target program returns 'true'. </p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10010796"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 149, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1530781882, "creation_date": 1530595961, "last_edit_date": 1530768983, "question_id": 51147246, "link": "https://stackoverflow.com/questions/51147246/entering-password-into-terminal-through-c", "title": "Entering password into terminal through c", "body": "<p>I searched for this question and could only find python variants. If this is a duplicate apologies upfront.</p>\n\n<p>I'm trying to write a script in c that auto setup systems so that I don't have too manually do it on heaps of computers. For part of the script I need to enter a password.</p>\n"}, {"tags": ["c", "parsing", "key-value", "keyvaluepair"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 6, "creation_date": 1530594228, "post_id": 51146959, "comment_id": 89277903, "body": "No. Welcome to C."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1530594383, "post_id": 51146959, "comment_id": 89277940, "body": "There are (non-standard) ways to achieve more or less the result, but not using the notation you suggest.  The string should be in double quotes, and you&#39;d need to use a function call to do the lookup, and you&#39;d use a structure behind the scenes, and you&#39;d have other functions to create the array of key-value pairs, and to add key-value pairs, and to remove them, and so on.  It would be done using functions all the way around."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1530594412, "post_id": 51146959, "comment_id": 89277952, "body": "will <code>find(dict, &quot;SERVERID&quot;)</code> do?"}, {"owner": {"reputation": 1692, "user_id": 5063151, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Sd8xZ.jpg?s=128&g=1", "display_name": "Jabari Dash", "link": "https://stackoverflow.com/users/5063151/jabari-dash"}, "edited": false, "score": 0, "creation_date": 1530594484, "post_id": 51146959, "comment_id": 89277988, "body": "You need to write your own data structure for that in C. If you can write it in C++ i would use that and use a map that&#39;s built in"}, {"owner": {"reputation": 73, "user_id": 9682801, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Shantanu Mhapankar", "link": "https://stackoverflow.com/users/9682801/shantanu-mhapankar"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1530594647, "post_id": 51146959, "comment_id": 89278038, "body": "@JonathanLeffler Is there an example code of such an implementation?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1530595003, "post_id": 51146959, "comment_id": 89278156, "body": "I&#39;m thinking of the code in &quot;C Interfaces and Implementations: Techniques for Creating Reusable Software&quot; by D R Hanson (Addison-Wesley Professional Computing Series, 1997, ISBN 0-201-49841-3).  Source etc available from GitHub (<a href=\"https://github.com/drh/cii\" rel=\"nofollow noreferrer\">github.com/drh/cii</a>)."}, {"owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "edited": false, "score": 0, "creation_date": 1530595581, "post_id": 51146959, "comment_id": 89278327, "body": "Depending on your implementation, your could try the functions <code>hsearch</code> or <code>lsearch</code>. They are not standard C but exist on most posix systems."}], "answers": [{"comments": [{"owner": {"reputation": 6676, "user_id": 3716664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fN14n.png?s=128&g=1", "display_name": "tilz0R", "link": "https://stackoverflow.com/users/3716664/tilz0r"}, "edited": false, "score": 2, "creation_date": 1530600428, "post_id": 51147010, "comment_id": 89280286, "body": "This looks more as a comment instead of answer."}, {"owner": {"reputation": 151, "user_id": 5701631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd4416b47b386a7e776f9a2e1596d6fb?s=128&d=identicon&r=PG&f=1", "display_name": "Nova Ardent", "link": "https://stackoverflow.com/users/5701631/nova-ardent"}, "reply_to_user": {"reputation": 6676, "user_id": 3716664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fN14n.png?s=128&g=1", "display_name": "tilz0R", "link": "https://stackoverflow.com/users/3716664/tilz0r"}, "edited": false, "score": 0, "creation_date": 1530600550, "post_id": 51147010, "comment_id": 89280340, "body": "I don&#39;t have commenting privileges yet, but would have liked to answer this question anyways. Do you recommend I delete it? if so, could I have a further explanation as not to make the same mistake down the road?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1530610284, "post_id": 51147010, "comment_id": 89285640, "body": "I&#39;d say it&#39;s not a good answer, still the link and short explanation could be helpful, so, it&#39;s not a <i>bad</i> one either -&gt; keep it."}], "tags": [], "owner": {"reputation": 151, "user_id": 5701631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd4416b47b386a7e776f9a2e1596d6fb?s=128&d=identicon&r=PG&f=1", "display_name": "Nova Ardent", "link": "https://stackoverflow.com/users/5701631/nova-ardent"}, "is_accepted": false, "score": 0, "last_activity_date": 1530594402, "creation_date": 1530594402, "answer_id": 51147010, "question_id": 51146959, "link": "https://stackoverflow.com/questions/51146959/key-value-pair-in-c/51147010#51147010", "title": "Key-Value pair in C?", "body": "<p>What you're looking for here would be a form of a dictionary. Typically, but not always, these use hashtables. There are many ways of creating a hashtable in C</p>\n\n<p>You can find your answer here:\n<a href=\"https://stackoverflow.com/questions/31930046/what-is-a-hash-table-and-how-do-you-make-it-in-c\">What is a hash table and how do you make it in C?</a></p>\n\n<p>You could also see other implementations such as a combined data structures, like a dictionary-linked list, and more. Just find a way to convert your string (char *) into a number, and find a way to use that number as an index.</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "is_accepted": false, "score": 1, "last_activity_date": 1530608832, "creation_date": 1530608832, "answer_id": 51150654, "question_id": 51146959, "link": "https://stackoverflow.com/questions/51146959/key-value-pair-in-c/51150654#51150654", "title": "Key-Value pair in C?", "body": "<p>Standard C doesn't give you any \"container types\" like the one you're looking for. Still you have several options to solve your problem:</p>\n\n<ol>\n<li><p>Might sound silly, but you could switch to a different language. It's at least something to think about. For example, C++ comes to mind, offering the <a href=\"http://www.cplusplus.com/reference/map/map/\" rel=\"nofollow noreferrer\"><code>std::map</code></a> type.</p></li>\n<li><p>Use some third-party library. A popular choice is <a href=\"https://developer.gnome.org/glib/\" rel=\"nofollow noreferrer\">GLib</a>, it offers a <a href=\"https://developer.gnome.org/glib/stable/glib-Hash-Tables.html\" rel=\"nofollow noreferrer\">hash table</a> you could use.</p></li>\n<li><p>There's always the option to implement it yourself. A very simple idea would be to use an array of a struct, e.g.</p>\n\n<pre><code>struct stringpair {\n    char *key;\n    char *value;\n};\n\nstruct stringpair *table;\n\n// ...\nsize_t entries = 42; // number of entries you found\ntable = malloc(entries * sizeof *table); // check for NULL after this\n\n// look for an entry:\nchar *value = 0;\nfor (size_t i = 0; i &lt; entries; ++i)\n{\n    if (!strcmp(table[i].key, \"SERVERID\"))\n    {\n        value = table[i].value;\n        break;\n    }\n}\n</code></pre>\n\n<p>This is of course a <strong>very</strong> basic solution and doesn't perform well with a lot of entries. I also didn't test this code, it's just to give you a rough idea. If you need fast lookups, you will need to implement a hashtable instead, or use option 1 or 2.</p></li>\n</ol>\n"}], "owner": {"reputation": 73, "user_id": 9682801, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Shantanu Mhapankar", "link": "https://stackoverflow.com/users/9682801/shantanu-mhapankar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2954, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1530608832, "creation_date": 1530594097, "last_edit_date": 1530594280, "question_id": 51146959, "link": "https://stackoverflow.com/questions/51146959/key-value-pair-in-c", "title": "Key-Value pair in C?", "body": "<p>I have a string in the format of </p>\n\n<pre><code>\"SERVERID=12345\\nSERVERKEY=asdasw\\nSERVERAPPID=123213\\n\"\n</code></pre>\n\n<p>I've parsed this line by line using <code>strtok()</code>.\nIs there a way to make a key-value pair of each line? Like maybe store them in some sort of an array? What I mean is, if I want <code>SERVERID</code>, I just say <code>Array['SERVERID']</code> and it'll return <code>12345</code> as the value. Is there a way to do it in C?  </p>\n"}, {"tags": ["c", "arrays", "memcpy"], "comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1530592900, "post_id": 51146749, "comment_id": 89277539, "body": "Are you asking why the address of the variable of type array-of-char is not identical to the address of the string literal you copy to it?"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1530593960, "post_id": 51146749, "comment_id": 89277822, "body": "I had to rescan five times to discover the definition of <code>search()</code>. Your formatting almost seems designed to hide that function... ;-) My mistake, but I will fix your indentation to make it eaiser for others."}, {"owner": {"reputation": 383, "user_id": 7477557, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b433af7158235c950e9967f925776dc7?s=128&d=identicon&r=PG", "display_name": "xdrm-brackets", "link": "https://stackoverflow.com/users/7477557/xdrm-brackets"}, "edited": false, "score": 0, "creation_date": 1530594416, "post_id": 51146749, "comment_id": 89277956, "body": "isn&#39;t <code>*arr != point</code> comparing &quot;pointers&quot; and not strings it points to ? shouldn&#39;t you use a string comparison instead ? e.g. <code>strcmp()</code>"}, {"owner": {"reputation": 383, "user_id": 7477557, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b433af7158235c950e9967f925776dc7?s=128&d=identicon&r=PG", "display_name": "xdrm-brackets", "link": "https://stackoverflow.com/users/7477557/xdrm-brackets"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1530595228, "post_id": 51146749, "comment_id": 89278212, "body": "@Yunnosch An answer already exists : <a href=\"https://stackoverflow.com/a/8004250/7477557\">stackoverflow.com/a/8004250/7477557</a> but I am pretty new to StackOverflow and don&#39;t know how to mark this thread as already answered. I let you do it if you don&#39;t mind. Thanks."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "reply_to_user": {"reputation": 383, "user_id": 7477557, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b433af7158235c950e9967f925776dc7?s=128&d=identicon&r=PG", "display_name": "xdrm-brackets", "link": "https://stackoverflow.com/users/7477557/xdrm-brackets"}, "edited": false, "score": 0, "creation_date": 1530595352, "post_id": 51146749, "comment_id": 89278249, "body": "@xdrm-brackets Try the lgrey word &quot;flag&quot; beneath the question. It should say something like &quot;duplicate of ...&quot; and if you click there allow you to give a link to the question which asks the same and has an accepted or upvoted answer. Feel free to do that now. I am however not convinced that the link you provided can serve as original of this as a dupe."}, {"owner": {"reputation": 383, "user_id": 7477557, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b433af7158235c950e9967f925776dc7?s=128&d=identicon&r=PG", "display_name": "xdrm-brackets", "link": "https://stackoverflow.com/users/7477557/xdrm-brackets"}, "edited": false, "score": 0, "creation_date": 1530595445, "post_id": 51146749, "comment_id": 89278281, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/8004237/how-do-i-properly-compare-strings\">How do I properly compare strings?</a>"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1530600622, "post_id": 51146749, "comment_id": 89280377, "body": "The issue isn&#39;t so much comparing strings, as using memcpy to copy a partial string and thereby not getting a null terminator. <code>point = memcpy(toSearch, original, 10);</code> needs a <code>point[10] = &#39;\\0&#39;;</code> after it."}], "answers": [{"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1530600733, "post_id": 51146880, "comment_id": 89280447, "body": "You fail to mention that <code>memcpy(toSearch1, original, 10);</code> cuts off a sub-string but adds no null terminator, which is one of the biggest bugs in the original code."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1530618774, "post_id": 51146880, "comment_id": 89291016, "body": "@Lundin Good point, I used that in the side note in  my answer, assuming your permission. Thanks."}], "tags": [], "owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "is_accepted": false, "score": 2, "last_activity_date": 1530618698, "last_edit_date": 1530618698, "creation_date": 1530593577, "answer_id": 51146880, "question_id": 51146749, "link": "https://stackoverflow.com/questions/51146749/why-does-memcpy-return-string-is-never-equal-to-the-same-string-present-in-an-ar/51146880#51146880", "title": "Why does memcpy return string is never equal to the same string present in an array?", "body": "<p>I assume that you are asking why the address of the variable of type array-of-char is not identical to the address of the string literal you copy to it.</p>\n\n<p>This is a tricky question, because, excuse me for saying so, it is unclear what could make you expect the address of any variable be different after copying something to it.</p>\n\n<p>Consider the example of not one but two different arrays of char being filled with the same string literal.</p>\n\n<pre><code>char toSearch1[50];\nchar toSearch2[50];\nchar *point1;\nchar *point2;\n\npoint1 = memcpy(toSearch1, original, 10);\npoint2 = memcpy(toSearch2, original, 10);\n/* or, depending on what to you is more convincingly copying the same literal */\npoint2 = memcpy(toSearch2, toSearch1, 10);\n</code></pre>\n\n<p>Afterwards, the two arrays are still two different variables of type array-of-char and memcpy returns the address of the destination, i.e. of the two different arrays.<br>\nPlease imagine how those two arrays could have identical address now.</p>\n\n<p>If you follow up with</p>\n\n<pre><code>strcpy(original1, \"is this in one or both arrays?\");\n</code></pre>\n\n<p>Would you then expect the two arrays to have different addresses again?</p>\n\n<p>If this does not answer your question, you have a fundamentally different understanding of pointers and addresses of variables than most programmers and I recommend to revise it by finding a tutorial on pointers and addresses.</p>\n\n<p>(Note, for this explanation of what you are asking about I am skipping the discussion of checking lengths in relation to array sizes, using safer versions of string copying, memcpy not correctly null terminating copied strings. All of that is however important for making reliable code, as e.g. Lundin correctly reminds us.)</p>\n"}, {"tags": [], "owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "is_accepted": false, "score": 1, "last_activity_date": 1530594559, "creation_date": 1530594559, "answer_id": 51147030, "question_id": 51146749, "link": "https://stackoverflow.com/questions/51146749/why-does-memcpy-return-string-is-never-equal-to-the-same-string-present-in-an-ar/51147030#51147030", "title": "Why does memcpy return string is never equal to the same string present in an array?", "body": "<p>In C, string are just null terminated char arrays. As ordinary arrays, they decay to pointers when directly used in expression. So when you write <code>str1 == str2</code> you are just comparing the pointers to their first element.</p>\n\n<p>And two pointers are only equal if they point to the very same object (same address). That is the reason why standard library offers <code>strcmp</code> to compare null terminated strings, and <code>memcmp</code> to compare arbitrary buffers of known size.</p>\n"}], "owner": {"reputation": 29, "user_id": 10024422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3387ab11d95bf933497f303f957ffafc?s=128&d=identicon&r=PG&f=1", "display_name": "user10024422", "link": "https://stackoverflow.com/users/10024422/user10024422"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 242, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1530618698, "creation_date": 1530592591, "last_edit_date": 1530594251, "question_id": 51146749, "link": "https://stackoverflow.com/questions/51146749/why-does-memcpy-return-string-is-never-equal-to-the-same-string-present-in-an-ar", "title": "Why does memcpy return string is never equal to the same string present in an array?", "body": "<p>I am using a simple string matching and searching.\nWhy does <code>*arr</code> is never equal to <code>point</code> though their values(why does I) are same? I am confused what is the cause of this?Is it related to strings or is there any other reason? Any help would be appreciated. I am sorry if the question is not clear. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint search(char ** arr, int size, char *point);\n\nint main()\n{\n    char *array[5]={0};\n    char original[50];\n    char toSearch[50];\n    char *point;     \n    int size=5,  searchIndex,i;\n\n    /* Copy a string into the original array */\n    strcpy(original, \"why this is not equal\");\n\n    /* Copy the first 10 characters of the original array into the newcopy    array*/\n    point = memcpy(toSearch, original, 10);\n\n    /*string to search*/     \n    array[2]=\"why this i\";\n\n    searchIndex = search(array, size, point);\n\n    if(searchIndex == -1)\n    {\n        printf(\"%s does not exists in array \\n\", point);\n    } else\n    printf(\"%s is found at %d position.\", toSearch, searchIndex + 1);\n\n    return 0;\n}\n\nint search(char ** arr, int size, char *point)\n{\n    int index = 0;\n    // Pointer to last array element arr[size - 1]\n    char ** arrEnd = (arr + size - 1);\n\n    /* Why *arr!=point is never false,\n       even when both are giving out same values (why this I)?\n    */\n    while(arr &lt;= arrEnd &amp;&amp; *arr!=point)\n    {\n        printf(\"%s == %s\", *arr,point);\n        arr++;\n        index++;\n    }\n\n    if(arr &lt;= arrEnd)\n    {\n        printf(\"%s after found \\n\",*arr);\n        return index;\n    }\n\n    return -1;\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>(null) == why this i \n(null) == why this i   \nwhy this i == why this i  \n(null) == why this i   \n(null) == why this i \nwhy this i does not exists in array\n</code></pre>\n\n<p>Thank You</p>\n"}, {"tags": ["c", "language-lawyer", "strftime"], "comments": [{"owner": {"reputation": 4328, "user_id": 920069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd39f0db1f22e1314746491df063602a?s=128&d=identicon&r=PG", "display_name": "Retired Ninja", "link": "https://stackoverflow.com/users/920069/retired-ninja"}, "edited": false, "score": 0, "creation_date": 1530584149, "post_id": 51145727, "comment_id": 89275837, "body": "Did values over 99 work?"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "reply_to_user": {"reputation": 4328, "user_id": 920069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd39f0db1f22e1314746491df063602a?s=128&d=identicon&r=PG", "display_name": "Retired Ninja", "link": "https://stackoverflow.com/users/920069/retired-ninja"}, "edited": false, "score": 0, "creation_date": 1530584296, "post_id": 51145727, "comment_id": 89275853, "body": "@RetiredNinja Yes."}], "answers": [{"comments": [{"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 1, "creation_date": 1530585945, "post_id": 51145785, "comment_id": 89276134, "body": "Thanks for checking.  I&#39;m mildly disappointed, but not surprised. At least it&#39;s not undefined."}], "tags": [], "owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "is_accepted": true, "score": 4, "last_activity_date": 1530584140, "creation_date": 1530584140, "answer_id": 51145785, "question_id": 51145727, "link": "https://stackoverflow.com/questions/51145727/strftime-and-nonnormalized-dates-times/51145785#51145785", "title": "strftime and nonnormalized dates/times", "body": "<p>The C11 standard 7.27.3.5/3 says:</p>\n\n<blockquote>\n  <p>If any of the specified values is outside the normal range, the characters stored are unspecified.</p>\n</blockquote>\n\n<p>Which I take to mean that the input must be normalized for the function to behave correctly; and a conforming implementation of <code>strftime</code> might operate by naively reading and displaying the values stored in the struct without performing any analysis on them.</p>\n"}], "owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 1, "accepted_answer_id": 51145785, "answer_count": 1, "score": 4, "last_activity_date": 1530584539, "creation_date": 1530583564, "last_edit_date": 1530584539, "question_id": 51145727, "link": "https://stackoverflow.com/questions/51145727/strftime-and-nonnormalized-dates-times", "title": "strftime and nonnormalized dates/times", "body": "<p>Most definitions of <code>strftime</code>'s <code>%H</code>, <code>%M</code>, and <code>%S</code> specifiers (including those in the ANSI/ISO C Standards) contain language like</p>\n\n<blockquote>\n  <p><code>%H</code>&nbsp;&nbsp;&nbsp;is replaced by the hour (24-hour clock) as a decimal number (00-23).</p>\n</blockquote>\n\n<p>Now, that little notation \"(00-23)\" at the end tells you the\nrange of numbers you're going to see <em>if the <code>struct tm</code> you're\nprinting was just created by <code>localtime</code> or <code>gmtime</code></em>.</p>\n\n<p>My question concerns the presence or absence of a requirement\nthat the <code>struct tm</code> being referenced by <code>strftime</code> <em>must</em> have been\none just generated by <code>localtime</code> or <code>gmtime</code>.  I don't think there's\nsuch a requirement, but if there isn't, those notations \"(00-23)\"\nand \"(00-59)\" don't really have any normative implications for\nstrftime -- they're more of a misplaced requirement on the values\ngenerated by <code>localtime</code> and <code>gmtime</code>.</p>\n\n<p>But if <code>strftime</code> doesn't restrict the ranges of the various <code>struct tm</code>\nfields to their \"normal\" values, it makes me wonder how much\nlatitude a push-the-boundaries programmer actually has when\ncalling <code>strftime</code>.  Are the values as unlimited as they are when\ncalling, say, <code>mktime</code>?</p>\n\n<p>To make the question more concrete, it came to me when I found\nmyself writing this code:</p>\n\n<pre><code>time_t dt = t2 - t1;\nstruct tm *tmp = gmtime(&amp;dt);\nif(dt &gt; 86400)\n    tmp-&gt;tm_hour += dt / 86400 * 24;\nstrftime(etbuf, sizeof(etbuf), \"elapsed: %H:%M:%S\", tmp);\n</code></pre>\n\n<p>That is, I'm subtracting two times, and letting <code>gmtime</code> and\n<code>strftime</code> convert the difference to HH:MM:SS format for me.\nBut if the time delta was more than a day, I'm not printing it\nas days; I'm just lumping it in with the hours (which, it's true,\nmight end up being a very large number if there were months or\nyears between <code>t1</code> and <code>t2</code>).</p>\n\n<p>So, language lawyer question: Is this legal and portable?\nWhen calling <code>strftime</code>, are <code>tm_hour</code>, <code>tm_min</code>, and the rest\nlimited to their normal ranges, or not?  (Yes, I've tried it,\nand nonnormalized values work -- not at all surprisingly --\nas expected under the popular implementations, but that's not\nthe question.)</p>\n\n<p>[Full disclosure: I am posting the <a href=\"https://mm.icann.org/pipermail/tz/2018-July/026572.html\" rel=\"nofollow noreferrer\">same question</a> to the <a href=\"https://mm.icann.org/listinfo/tz\" rel=\"nofollow noreferrer\">tz mailing list</a>.]</p>\n"}, {"tags": ["c", "undefined-behavior", "bit-shift"], "comments": [{"owner": {"reputation": 4598, "user_id": 9264702, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mHczh.jpg?s=128&g=1", "display_name": "Stephen Docy", "link": "https://stackoverflow.com/users/9264702/stephen-docy"}, "edited": false, "score": 1, "creation_date": 1530582963, "post_id": 51145636, "comment_id": 89275578, "body": "Well, I can&#39;t speak to what the language specs say should happen, but I always think about shifting as removing a bit from one side and inserting a <code>0</code> at the other side.  So, using this logic, shifting by a number of bits greater than or equal to the width of your variable would certainly end up producing all zeroes.  The questions you link state the behavior is undefined, so all bets are off."}, {"owner": {"reputation": 7668, "user_id": 2554472, "user_type": "registered", "profile_image": "https://graph.facebook.com/1119155584/picture?type=large", "display_name": "Mark Plotnick", "link": "https://stackoverflow.com/users/2554472/mark-plotnick"}, "edited": false, "score": 3, "creation_date": 1530583035, "post_id": 51145636, "comment_id": 89275597, "body": "The question you linked to cites the standard: The behavior is undefined if the right operand is negative, or greater than or equal to the length in bits of the promoted left operand."}, {"owner": {"reputation": 1810, "user_id": 5500589, "user_type": "registered", "accept_rate": 35, "profile_image": "https://i.stack.imgur.com/IldVR.jpg?s=128&g=1", "display_name": "Galaxy", "link": "https://stackoverflow.com/users/5500589/galaxy"}, "edited": false, "score": 0, "creation_date": 1530583071, "post_id": 51145636, "comment_id": 89275605, "body": "Well, if 36 % 32 == 4, then it should shift the variable by 4 bytes, coming nowhere close to zeroing out the variable."}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1530583099, "post_id": 51145636, "comment_id": 89275614, "body": "This is undefined behavior, everything can happen. Now <a href=\"https://c9x.me/x86/html/file_module_x86_id_285.html\" rel=\"nofollow noreferrer\">bitshift</a> on x86 are divisions, so you will end up with 0s."}, {"owner": {"reputation": 4598, "user_id": 9264702, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mHczh.jpg?s=128&g=1", "display_name": "Stephen Docy", "link": "https://stackoverflow.com/users/9264702/stephen-docy"}, "edited": false, "score": 1, "creation_date": 1530583272, "post_id": 51145636, "comment_id": 89275653, "body": "Where are you getting the idea of reducing the number of positions shifted via modulo?  I don&#39;t see that in either of the accepted answers you reference."}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1530583602, "post_id": 51145636, "comment_id": 89275729, "body": "&quot;it is obvious that if we attempt to shift a number by k bits that are &gt;= the bit width of the variable, only the least-significant log2k bits are taken&quot;... No, it is not &quot;obvious&quot;. On the contrary, it is simply incorrect. Read the linked answers carefully. There&#39;s no <code>log2</code> there and there&#39;s no <code>36 % 32</code> there. The behavior is simply undefined. End of story."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1530585294, "post_id": 51145636, "comment_id": 89276026, "body": "@KamilCuk: Hardware instructions do not define C implementations. The C implementation may use other instructions and combinations thereof to achieve different effects. And the page you link to does not say that shifting by more than the width will yield zero. It says \u201cThe count is masked to 5 bits, which limits the count range to 0 to 31.\u201d"}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1530587812, "post_id": 51145636, "comment_id": 89276515, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/11270492/what-does-the-c-standard-say-about-bitshifting-more-bits-than-the-width-of-type\">What does the C standard say about bitshifting more bits than the width of type?</a>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1530588131, "post_id": 51145636, "comment_id": 89276567, "body": "Using <code>%x</code> to print an <code>int</code> adds an unnecessary compilation."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1530588331, "post_id": 51145636, "comment_id": 89276607, "body": "&quot;For a 32-bit int, the least significant 5 bits are masked and taken to be the shift amount.&quot; --&gt; C does not specify that a mask must occur.  That is part of the UB about this. C11 &#167;6.5.7 3"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1530600291, "post_id": 51145636, "comment_id": 89280221, "body": "What does Java have to do with anything? The last part of the question just seems to derail the topic."}], "answers": [{"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 2, "last_activity_date": 1530583285, "creation_date": 1530583285, "answer_id": 51145701, "question_id": 51145636, "link": "https://stackoverflow.com/questions/51145636/why-does-shifting-a-variable-by-more-than-its-width-in-bits-zeroes-out/51145701#51145701", "title": "Why does shifting a variable by more than its width in bits zeroes out?", "body": "<p>The linked questions specifically state that shifting by an amount greater than the bit width of the type being shifted invokes <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behavior</a>, which the standard defines as \"behavior, upon use of a nonportable or erroneous program construct or of erroneous data, for which this International Standard imposes no requirements\"</p>\n\n<p>When you invoke undefined behavior, anything can happen.  The program may crash, it may output strange results, or it may appear to work properly.  Also, how undefined behavior manifests itself can change if you use a different compiler or different optimization settings on the same compiler.</p>\n\n<p>The C standard states the following regarding the bitwise shift operators in section 6.5.7p3:</p>\n\n<blockquote>\n  <p>The integer promotions are performed on each of the operands.  The\n  type of the result is that  of  the  promoted  left  operand.   <strong>If \n  the  value  of  the  right  operand  is  negative  or  is greater than\n  or equal to the width of the promoted left operand, the behavior is\n  undefined.</strong></p>\n</blockquote>\n\n<p>In this case it's possible that the compiler could reduce the amount to shift modulo the bit width, as you suggested, or it could treat it as mathematically shifting by that amount resulting in all bits being 0.  Either is a valid result because the standard does not specify the behavior.</p>\n"}, {"comments": [{"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1530629671, "post_id": 51155312, "comment_id": 89298492, "body": "For the 80386 to have been analogous to the 80286, it should have looked at the bottom <i>six</i> bits when shifting a 32-bit value, since shifting by precisely the word size is sometimes a useful corner case."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1530651807, "post_id": 51155312, "comment_id": 89308841, "body": "IIRC, The x186 did mask the shift count and the x86 did not.  One way to detect the difference at run time."}], "tags": [], "owner": {"reputation": 85822, "user_id": 597607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jCzJi.png?s=128&g=1", "display_name": "Bo Persson", "link": "https://stackoverflow.com/users/597607/bo-persson"}, "is_accepted": false, "score": 1, "last_activity_date": 1530622864, "creation_date": 1530622864, "answer_id": 51155312, "question_id": 51145636, "link": "https://stackoverflow.com/questions/51145636/why-does-shifting-a-variable-by-more-than-its-width-in-bits-zeroes-out/51155312#51155312", "title": "Why does shifting a variable by more than its width in bits zeroes out?", "body": "<p>One reason for the undefined-ness is that the 8086, the original x86, did <strong>not</strong> mask any bits off the shift count. It instead literally performed the shifts, using one clock tick per position.</p>\n\n<p>Intel then realized that allowing 255+ clock ticks for a shift instruction perhaps wasn't such a good idea. They probably considered maximum interrupt response time, for example.</p>\n\n<p>From my old 80286-manual:</p>\n\n<blockquote>\n  <p>To reduce the maximum execution time, the iAPX 286 does not allow shift counts greater than 31. If a shift count greater than 31 is attempted, only the bottom five bits of the shift count are used. The iAPX 86 uses all 8 bits of the shift count.</p>\n</blockquote>\n\n<p>That gave you different results for the exact same program on a PC/XT and a PC/AT.</p>\n\n<p>So what should the language standard say?</p>\n\n<p>Java solved this by not using the underlying hardware. C instead chose to say that the effect is unclear.</p>\n"}], "owner": {"reputation": 1810, "user_id": 5500589, "user_type": "registered", "accept_rate": 35, "profile_image": "https://i.stack.imgur.com/IldVR.jpg?s=128&g=1", "display_name": "Galaxy", "link": "https://stackoverflow.com/users/5500589/galaxy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1334, "favorite_count": 0, "accepted_answer_id": 51145701, "answer_count": 2, "score": 1, "last_activity_date": 1530622864, "creation_date": 1530582688, "last_edit_date": 1530594860, "question_id": 51145636, "link": "https://stackoverflow.com/questions/51145636/why-does-shifting-a-variable-by-more-than-its-width-in-bits-zeroes-out", "title": "Why does shifting a variable by more than its width in bits zeroes out?", "body": "<p>This question is inspired by other questions from StackOverflow. Today, while browsing StackOverflow, I've come across an issue of bitshifting a variable by a value k that is >= the width of that variable in bits. This means shifting a 32-bit int by 32 or more bit positions.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/33058340/left-shift-an-integer-by-32-bits\">Left shift an integer by 32 bits</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/9860538/unexpected-c-c-bitwise-shift-operators-outcome?noredirect=1&amp;lq=1\">Unexpected C/C++ bitwise shift operators outcome</a></p>\n\n<p>From these questions, it is obvious that if we attempt to shift a number by k bits that are >= the bit width of the variable, only the least-significant log2k bits are taken. For a 32-bit int, the least significant 5 bits are masked and taken to be the shift amount.</p>\n\n<p>So in general, if w = width of the variable in bits,\n<code>x &gt;&gt; k</code> becomes <code>x &gt;&gt; (k % w)</code>\nFor an <code>int</code>, this is <code>x &gt;&gt; (k % 32)</code>.</p>\n\n<blockquote>\n  <p>The count is masked to five bits, which limits the count range to 0 to 31.</p>\n</blockquote>\n\n<p>So I've written a small little program to observe the behavior that should theoretically be produced. I've written in comments the resulting shift amount % 32.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n#define PRINT_INT_HEX(x) printf(\"%s\\t%#.8x\\n\", #x, x);\n\nint main(void)\n{\n    printf(\"==============================\\n\");\n    printf(\"Testing x &lt;&lt; k, x &gt;&gt; k, where k &gt;= w\\n\");\n\n    int      lval = 0xFEDCBA98 &lt;&lt; 32;\n    //int      lval = 0xFEDCBA98 &lt;&lt; 0;\n\n    int      aval = 0xFEDCBA89 &gt;&gt; 36;\n    //int      aval = 0xFEDCBA89 &gt;&gt; 4;\n\n    unsigned uval = 0xFEDCBA89 &gt;&gt; 40;\n    //unsigned uval = 0xFEDCBA89 &gt;&gt; 8;\n\n    PRINT_INT_HEX(lval)\n    PRINT_INT_HEX(aval)\n    PRINT_INT_HEX(uval)\n\n    putchar('\\n');\n\n    return EXIT_SUCCESS;\n}\n</code></pre>\n\n<p>And the output does not match the expected behavior of the shift instructions!</p>\n\n<pre><code>==============================\nTesting x &lt;&lt; k, x &gt;&gt; k, where k &gt;= w\nlval    00000000 \naval    00000000\nuval    00000000\n</code></pre>\n\n<p>=====================================================================</p>\n\n<p>Actually I was a bit confused with Java. In C/C++, shifting an int by a number of bits greater than the bit width, could possibly be reduced k % w, but this is not guaranteed by the C standard. There is no rule which says that this kind of behavior should happen all the time. It is undefined behavior.</p>\n\n<p>However, this is the case in Java. This is a rule of the Java programming language.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/45075616/bitshift-operators-description-in-java-language-specification?rq=1\">Bitshift operators description in Java language specification</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/34193787/weird-result-of-java-integer-left-shift\">Weird result of Java Integer left shift</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/35032073/java-shift-distance-for-int-restricted-to-31-bits\">java : shift distance for int restricted to 31 bits</a></p>\n"}]