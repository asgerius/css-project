[{"tags": ["c", "windows", "newline", "carriage-return"], "comments": [{"owner": {"reputation": 613, "user_id": 3112926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b33809c5d0f78b110e8613c9e5972dd5?s=128&d=identicon&r=PG&f=1", "display_name": "JGroven", "link": "https://stackoverflow.com/users/3112926/jgroven"}, "edited": false, "score": 0, "creation_date": 1557358857, "post_id": 56050349, "comment_id": 98741976, "body": "&quot;\\r\\n&quot; is two characters."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1557358865, "post_id": 56050349, "comment_id": 98741978, "body": "A Windows line terminator is <i>two</i> characters, not one.  (And <code>&#39;\\r\\n&#39;</code> is <i>one</i> integer that is probably unequal to both of the two characters in question.)"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 613, "user_id": 3112926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b33809c5d0f78b110e8613c9e5972dd5?s=128&d=identicon&r=PG&f=1", "display_name": "JGroven", "link": "https://stackoverflow.com/users/3112926/jgroven"}, "edited": false, "score": 0, "creation_date": 1557358935, "post_id": 56050349, "comment_id": 98741994, "body": "@JGroven, <code>&quot;\\r\\n&quot;</code> is one array containing three characters, including the terminator.  But that&#39;s not what the OP says they used."}, {"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 2, "creation_date": 1557359732, "post_id": 56050349, "comment_id": 98742149, "body": "I suggest doing <code>temp &gt;= &#39;A&#39;</code> and similarly for the rest. This will make the intent of your code much more clear when others look at it, including you at some future date."}, {"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 1, "creation_date": 1557359793, "post_id": 56050349, "comment_id": 98742162, "body": "How do the windows line endings affect the result of your code? In most cases, it shouldn&#39;t matter."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1557387016, "post_id": 56050349, "comment_id": 98749304, "body": "Hint: don&#39;t use magic numbers: <code>65</code> -&gt; <code>&#39;A&#39;</code>, <code>90</code> -&gt; <code>&#39;Z&#39;</code> etc."}], "answers": [{"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 5, "last_activity_date": 1557359497, "creation_date": 1557359497, "answer_id": 56050415, "question_id": 56050349, "link": "https://stackoverflow.com/questions/56050349/how-can-i-determine-if-a-char-is-a-windows-line-ending/56050415#56050415", "title": "How can I determine if a char* is a windows line ending?", "body": "<p>Windows line endings consist of two separate characters, a carriage return (<code>'\\r'</code>) immediately followed by a newline (<code>'\\n'</code>).  Because they are a combination of two characters, you cannot detect them by looking at only one character at a time.</p>\n\n<p>If your code is running <em>on</em> Windows and the file is supposed to be interpreted as text, then open it in text mode (for instance, <code>\"r\"</code> instead of <code>\"rb\"</code>), and the line terminators should be automatically translated to single newlines.  If you're running on a system that uses single newlines as line terminators (most anything <em>but</em> Windows these days) then no such translation will be performed.  In that case, to detect Windows-style line terminators you need to keep track of whether the immediately previous character was a <code>'\\r'</code>.  When that is so, and the next character read is a <code>'\\n'</code>, then you've detected a line terminator.</p>\n\n<p>But if it should be considered erroneous for Windows-style terminators to be in the file, then consider instead just fixing the file via <code>dos2unix</code> or a similar utility.</p>\n"}], "owner": {"reputation": 1, "user_id": 11133715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/758e60529b128a7efbf5d7ed7a150269?s=128&d=identicon&r=PG&f=1", "display_name": "jackattack8251", "link": "https://stackoverflow.com/users/11133715/jackattack8251"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1557359497, "creation_date": 1557358706, "question_id": 56050349, "link": "https://stackoverflow.com/questions/56050349/how-can-i-determine-if-a-char-is-a-windows-line-ending", "title": "How can I determine if a char* is a windows line ending?", "body": "<p>In my C program, I am looking through a file character by character for info. For some reason my data is getting windows line ending characters even though my code looks like it does below.</p>\n\n<p>I have tried a couple of things like temp[0]=='\\r\\n'</p>\n\n<pre><code>while((temp = fgetc(file)) != EOF)\n    {\n    if((temp&gt;=65 &amp;&amp; temp&lt;=90) || (temp&gt;=97 &amp;&amp; temp&lt;=122) || (temp&gt;=48 &amp;&amp; temp&lt;=57) || temp==39){\n      c[count]=temp;\n      count++;\n    }\nelse\n      break;\n</code></pre>\n"}, {"tags": ["compression", "c", "winrar"], "comments": [{"owner": {"reputation": 582, "user_id": 1672723, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27393b956c2c767aa5d271d3972c0086?s=128&d=identicon&r=PG", "display_name": "Scott", "link": "https://stackoverflow.com/users/1672723/scott"}, "edited": false, "score": 0, "creation_date": 1557386479, "post_id": 56089026, "comment_id": 98814937, "body": "Please do not use the word \u201cscript\u201d to refer to a C program."}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1557504138, "post_id": 56089026, "comment_id": 98814938, "body": "this is off topic. Anyway your code has so many redundant <code>strcpy</code>s. Shouldn&#39;t it be easier and faster to do <code>sprintf(data, &quot;%d_%d_%d&quot;, now-&gt;tm_year+1900, now-&gt;tm_mon+1, now-&gt;tm_mday);</code>. Then what&#39;s the point of <code>strcpy(comando,&quot;&quot;);</code>?"}, {"owner": {"reputation": 15, "user_id": 10259591, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-tFQDIQ9Keo4/AAAAAAAAAAI/AAAAAAAAA3Q/QJM0c9QWzfI/photo.jpg?sz=128", "display_name": "CESAR MURILO DA SILVA JUNIOR", "link": "https://stackoverflow.com/users/10259591/cesar-murilo-da-silva-junior"}, "reply_to_user": {"reputation": 582, "user_id": 1672723, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27393b956c2c767aa5d271d3972c0086?s=128&d=identicon&r=PG", "display_name": "Scott", "link": "https://stackoverflow.com/users/1672723/scott"}, "edited": false, "score": 0, "creation_date": 1578185843, "post_id": 56089026, "comment_id": 105357230, "body": "@Scott You&#39;re right, I was wrong."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 10259591, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-tFQDIQ9Keo4/AAAAAAAAAAI/AAAAAAAAA3Q/QJM0c9QWzfI/photo.jpg?sz=128", "display_name": "CESAR MURILO DA SILVA JUNIOR", "link": "https://stackoverflow.com/users/10259591/cesar-murilo-da-silva-junior"}, "edited": false, "score": 0, "creation_date": 1578182042, "post_id": 56089027, "comment_id": 105356698, "body": "None of rar.exe v5.71&#39;s options appear to change the temporary compression directory. This <a href=\"http://www.winrarrepair.net/winrar-temp-folder-windows-10.html\" rel=\"nofollow noreferrer\">link</a> tells how to change the user&#39;s temporary directory. While performing a computer test at home I didn&#39;t notice my user&#39;s tmp folder increase in compression process. It may not be the compression process that is increasing C: \\ during script execution."}], "tags": [], "owner": {"reputation": 653, "user_id": 658762, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0833cea067fac2f5f71a00193c06ebfb?s=128&d=identicon&r=PG", "display_name": "Tonny", "link": "https://stackoverflow.com/users/658762/tonny"}, "is_accepted": false, "score": 1, "last_activity_date": 1561054269, "last_edit_date": 1561054269, "creation_date": 1557356815, "answer_id": 56089027, "question_id": 56089026, "link": "https://stackoverflow.com/questions/56089026/why-is-this-c-program-filling-drive-c/56089027#56089027", "title": "Why is this C program filling drive C:\\?", "body": "<p>The command line <code>RAR.EXE</code> that is called by the <code>C</code> program doesn't use the <code>temp-files</code> setting from the <code>WinRAR.EXE</code> GUI program.<br>\nYou need to specify the temp-folder for RAR.EXE using a command-line parameter.<br>\nI don't have a copy of WinRAR at my disposal but <code>RAR -h</code> or <code>RAR -?</code> should give you the information which parameter to use.</p>\n"}], "migrated_from": {"other_site": {"markdown_extensions": ["Prettify"], "launch_date": 1250553600, "open_beta_date": 1247529600, "site_state": "normal", "high_resolution_icon_url": "https://cdn.sstatic.net/Sites/superuser/Img/apple-touch-icon@2.png", "twitter_account": "super_user", "favicon_url": "https://cdn.sstatic.net/Sites/superuser/Img/favicon.ico", "icon_url": "https://cdn.sstatic.net/Sites/superuser/Img/apple-touch-icon.png", "audience": "computer enthusiasts and power users", "site_url": "https://superuser.com", "api_site_parameter": "superuser", "logo_url": "https://cdn.sstatic.net/Sites/superuser/Img/logo.png", "name": "Super User", "site_type": "main_site"}, "on_date": 1557567321, "question_id": 1434622}, "owner": {"reputation": 15, "user_id": 10259591, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-tFQDIQ9Keo4/AAAAAAAAAAI/AAAAAAAAA3Q/QJM0c9QWzfI/photo.jpg?sz=128", "display_name": "CESAR MURILO DA SILVA JUNIOR", "link": "https://stackoverflow.com/users/10259591/cesar-murilo-da-silva-junior"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1578203951, "creation_date": 1557356226, "last_edit_date": 1578203951, "question_id": 56089026, "link": "https://stackoverflow.com/questions/56089026/why-is-this-c-program-filling-drive-c", "title": "Why is this C program filling drive C:\\?", "body": "<p>The code below is a C program that compresses some. They are sharing folders, and some have around 6G. But the C: / drive has only 4G free, today, and every time the script runs it loads, I believe it's because of temporary files.</p>\n\n<p>But I've already changed the folder for temporary files in Winrar to Options> Settings> Path> Folder for temporary files: \"E: \\ temp\".</p>\n\n<p>What could be happening? See, the code is basically this (some snippets, where you just change the directory to be compressed, removed to be summarized):</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;ctime&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;cstdlib&gt;\n\nusing namespace std;\n\nint main(){\n\n    char comando [150]={\"\"};\n\n    char ano [3];\n    char mes [3];\n    char dia[3];\n    char data[15] ={\"\"};\n    char pasta[15] = {\"\"};\n    char *Pont_Pasta = pasta;\n\n    unsigned long tempo_Espera = 100000;\n\n    time_t t = time(0);\n    struct tm * now = localtime (&amp; t);\n    sprintf(ano,\"%i\",now-&gt;tm_year+1900);\n    sprintf(mes,\"%i\",now-&gt;tm_mon+1);\n    sprintf(dia,\"%i\",now-&gt;tm_mday);\n\n    strcat(data,\"_\");\n    strcat(data,ano);\n    strcat(data,\"_\");\n    strcat(data,mes);\n    strcat(data,\"_\");\n    strcat(data,dia);\n\n strcat(comando,\"start c:\\\\arquiv~1\\\\winrar\\\\rar a E:\\\\backup\\\\aquisicao\\\\aquisicao\");strcat(comando,data);strcat(comando,\".rar E:\\\\aquisicao\");\n    system(comando);\n    strcpy(comando,\"\");\n    _sleep(tempo_Espera);\n\n (...)\n\n return 0;    \n}\n</code></pre>\n\n<hr>\n\n<p>@phuclv I didn't create this code, but I understand that strcp is for clearing the string command. As for the date lines, I left it like this:</p>\n\n<pre><code>time_t rawtime;\nstruct tm * timeinfo;\nchar data[30];\n\ntime (&amp;rawtime);\ntimeinfo = localtime(&amp;rawtime);\n\nstrftime(data,30,\"_%Y%m%d\",timeinfo);\n</code></pre>\n"}, {"tags": ["c", "makefile", "x86", "gnu-make", "osdev"], "answers": [{"tags": [], "owner": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "is_accepted": true, "score": 7, "last_activity_date": 1557445426, "last_edit_date": 1557445426, "creation_date": 1557354050, "answer_id": 56049780, "question_id": 56049339, "link": "https://stackoverflow.com/questions/56049339/gnu-make-and-meaning/56049780#56049780", "title": "Gnu Make &gt;$* and $* meaning", "body": "<p><code>.s.o:</code> is a suffix rule that exists for compatibility with old versions of make. It is the same as the pattern rule <code>%.o : %.s</code> . <code>$*</code> is an automatic make variable  containing the base of the source file name (in this case the filename without the extension <code>.o</code>). </p>\n\n<p>The command generated for processing <code>boot.s</code> to <code>boot.o</code> would be:</p>\n\n<pre><code>as -32 -Iinclude -a boot.s -o boot.o &gt;boot.map \n</code></pre>\n\n<p>GNU Assembler(AS) option <code>-a</code> generates a listing file to standard output. Standard output is being redirected by the *nix shell (via <code>&gt;</code>) to a file name ending in <code>.map</code>. The end result in this example is that <code>boot.s</code> will be assembled to an object file called <code>boot.o</code> and standard output will be written to the file <code>boot.map</code></p>\n\n<p><strong>Note:</strong> I personally would have redirected standard output to a file name with the extension <code>.lst</code> rather than the <code>.map</code> extension.</p>\n"}], "owner": {"reputation": 2687, "user_id": 5104016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2tHXG.jpg?s=128&g=1", "display_name": "zerocool", "link": "https://stackoverflow.com/users/5104016/zerocool"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 56049780, "answer_count": 1, "score": 2, "last_activity_date": 1568951528, "creation_date": 1557351146, "last_edit_date": 1568951528, "question_id": 56049339, "link": "https://stackoverflow.com/questions/56049339/gnu-make-and-meaning", "title": "Gnu Make &gt;$* and $* meaning", "body": "<p>i stumbled upon a Makefile that look weird i couldn't understand it </p>\n\n<p>here is the that Makefile </p>\n\n<pre><code>AS=as -32 -Iinclude\nLD=ld -m elf_i386\nCC=gcc -m32 -fno-pie -fno-stack-protector\nCPP=gcc -E -nostdinc -Iinclude\nCFLAGS=-W -nostdlib -Wno-long-long -I include -fomit-frame-pointer\n\n.s.o:\n    ${AS} -a $&lt; -o $*.o &gt;$*.map\n\nall: boot setup\n\nboot: boot.o\n    ${LD} --oformat binary -N -e start -Ttext 0x0000 -o boot $&lt;\n\nsetup: setup.o\n    ${LD} --oformat binary -N -e start -Ttext 0x0000 -o setup $&lt;\n\nclean:\n    rm -f boot setup *.o *.map\n</code></pre>\n\n<p>the part that i didn't understand is this </p>\n\n<pre><code>.s.o:\n    ${AS} -a $&lt; -o $*.o &gt;$*.map\n</code></pre>\n\n<p>what is the significance of <code>.s.o</code> in this case \nand what this <code>$*.o &gt;$*.map</code> trying to do.</p>\n"}, {"tags": ["c", "gcc", "header", "intel", "intrinsics"], "comments": [{"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 2, "creation_date": 1557350057, "post_id": 56049110, "comment_id": 98739684, "body": "I just include the specific ones for the intrinsics I&#39;m using. Intel&#39;s reference guide includes (hah!) them in the notes."}], "answers": [{"comments": [{"owner": {"reputation": 11454, "user_id": 646947, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/3f954319b2491c00532c2f40ca984e5d?s=128&d=identicon&r=PG", "display_name": "Cyan", "link": "https://stackoverflow.com/users/646947/cyan"}, "edited": false, "score": 0, "creation_date": 1557448012, "post_id": 56049645, "comment_id": 98777837, "body": "Thanks @Peter, that&#39;s excellent stuff, accurate and complete."}], "tags": [], "owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "is_accepted": true, "score": 4, "last_activity_date": 1557353735, "last_edit_date": 1557353735, "creation_date": 1557353140, "answer_id": 56049645, "question_id": 56049110, "link": "https://stackoverflow.com/questions/56049110/including-the-correct-intrinsic-header/56049645#56049645", "title": "Including the correct intrinsic header", "body": "<p>(posting an answer here because <a href=\"https://stackoverflow.com/questions/11228855/header-files-for-x86-simd-intrinsics\">Header files for x86 SIMD intrinsics</a> has out of date answers that suggest including individual header files).</p>\n\n<hr>\n\n<p><strong><code>immintrin.h</code> is portable across all compilers, and includes all <em>Intel</em> SIMD intrinsics</strong>, and some scalar extensions like BMI2 <code>_pdep_u32</code>.  (For AMD SSE4a and XOP (Bulldozer-family only, dropped for Zen), you need to include a different header as well.)</p>\n\n<p>The only reason I can think of for including <code>&lt;emmintrin.h&gt;</code> specifically would be if you're using MSVC and want to leave intrinsics undefined for ISA extensions you don't want to depend on.</p>\n\n<p>GCC's model of requiring you to enable extensions before you can use intrinsics for them means the compiler does this checking for you, so you can just <code>#include &lt;immintrin.h&gt;</code> but still get an error if you try to use <code>_mm_shuffle_epi8</code> (<code>pshufb</code>) without <code>-mssse3</code>.</p>\n\n<p><strong>Don't use compilers older than gcc4.4.</strong>  They're obsolete and will typically generate slower code, especially for modern CPUs that didn't exist when their tuning settings were being decided.</p>\n\n<hr>\n\n<p>gcc/clang's <code>x86intrin.h</code> vs. MSVC <code>intrin.h</code> are only useful if you need some extra non-SIMD intrinsics like MSVC's <code>_BitScanReverse()</code> that aren't always portable across compilers.  Stuff like integer rotate / bit-scan intrinsics that are baseline (unlike BMI1 <code>lzcnt</code>/<code>tzcnt</code> or BMI2 <code>rorx</code>) but hard or impossible to express in C in a way that compilers will recognize and turn a loop back into a single instruction.</p>\n\n<p>Intel documents some of those as being available in immintrin.h in <a href=\"https://software.intel.com/sites/landingpage/IntrinsicsGuide/#text=bsf\" rel=\"nofollow noreferrer\">their intrinsics guide</a>, but gcc/clang and MSVC actually have them in their <code>x86intrin.h</code> or <code>intrin.h</code> headers, respectively.</p>\n\n<p>See <a href=\"https://stackoverflow.com/questions/13772567/get-cpu-cycle-count/51907627#51907627\">Get CPU cycle count?</a> for an example of <strong>using <code>#ifdef _MSC_VER</code> to choose the right header</strong> to define <code>uint64_t __rdtsc(void)</code> and <code>__rdtscp()</code>.</p>\n"}], "owner": {"reputation": 11454, "user_id": 646947, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/3f954319b2491c00532c2f40ca984e5d?s=128&d=identicon&r=PG", "display_name": "Cyan", "link": "https://stackoverflow.com/users/646947/cyan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1178, "favorite_count": 0, "accepted_answer_id": 56049645, "answer_count": 1, "score": 2, "last_activity_date": 1557353735, "creation_date": 1557349898, "last_edit_date": 1557350384, "question_id": 56049110, "link": "https://stackoverflow.com/questions/56049110/including-the-correct-intrinsic-header", "title": "Including the correct intrinsic header", "body": "<p>I keep reading opinions on which header file is better to include to access Intel's intrinsics : <code>x86intrin.h</code> or <code>immintrin.h</code> .</p>\n\n<p>Both seem to achieve an identical outcome, but I'm sure there must some subtle differences, with regards to code portability. Maybe one is more common, or more complete, than the other ?</p>\n\n<p>I couldn't find an explanation on any of them. If anyone knows why there are 2 files, and what differences they have, this would be a welcomed SO answer.</p>\n\n<p>Speaking of portability, for older compilers (like <code>gcc</code> &lt; v4.4.0), of course things become more complex, and neither is available. One has to consider including <em>another</em> intrinsic header (likely <code>emmintrin.h</code> for SSE support).</p>\n"}, {"tags": ["c", "arrays", "string", "pointers"], "comments": [{"owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "edited": false, "score": 0, "creation_date": 1557349608, "post_id": 56048871, "comment_id": 98739542, "body": "There is a difference between returning an &quot;array of strings&quot; aka &#39;array of array of char&#39; (<code>char x[][]</code>) (which is not possible in C), returning a &quot;pointer to an array of strings&quot; aka &#39;pointer to array of array of char&#39; (<code>char (*x)[][]</code>), and a &quot;pointer to the first of many strings&quot; aka &#39;pointer to array of char&#39; (<code>char (*x)[]</code>). There&#39;s also the possibility that your strings may be not arrays but pointers to char. Clarify, please"}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1557350332, "post_id": 56048871, "comment_id": 98739779, "body": "Or to simplify CF&#39;s attempt at explanation, there&#39;s no such thing as a &quot;string&quot; in C at all. There are characters (which are just individual bytes), pointers, and arrays. What you want to return is a pointer to pointer to char (i.e. char **)."}], "answers": [{"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 5, "last_activity_date": 1557349187, "last_edit_date": 1557349187, "creation_date": 1557348853, "answer_id": 56048915, "question_id": 56048871, "link": "https://stackoverflow.com/questions/56048871/how-to-return-pointer-to-an-array-of-strings-in-c/56048915#56048915", "title": "How to return pointer to an array of strings in C", "body": "<p>You have a type mismatch.  </p>\n\n<p>Your function is defined to return a <code>char *</code> but you return a <code>char *[]</code> which decays into a <code>char **</code>.  This is what the warning means.  </p>\n\n<p>Change the return type to <code>char **</code> along with the value you assign the return value to.  Also, you can't return a pointer to a local variable, so you need to allocate the array dynamically as you stated you did in the code comment.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nchar **myFunc(){\n    char **result = malloc(2 * sizeof(*result));\n\n    result[0] = \"abc\";\n    result[1] = \"def\";\n    return result;   \n}\n\nint main(void){\n    char **result = myFunc();\n    printf(\"%s\\n%s\\n\", result[0], result[1]);\n    return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1557349376, "post_id": 56048944, "comment_id": 98739467, "body": "And <code>malloc(2 * sizeof(*result);</code> should be <code>malloc(2 * sizeof(*result));</code>"}], "tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": 2, "last_activity_date": 1557356602, "last_edit_date": 1557356602, "creation_date": 1557348961, "answer_id": 56048944, "question_id": 56048871, "link": "https://stackoverflow.com/questions/56048871/how-to-return-pointer-to-an-array-of-strings-in-c/56048944#56048944", "title": "How to return pointer to an array of strings in C", "body": "<pre><code>char** result = myFunc();\n</code></pre>\n\n<p>but yout variable in function is automatic and it does not exist outside the function scope</p>\n\n<pre><code>char** myFunc(){\n    char** result = malloc(2 * sizeof(*result));\n    result[0] = something;\n    result[1] = something_else;\n    return result;   \n}\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 8116529, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ef0c688175f16a58e18a120afe8ca22?s=128&d=identicon&r=PG&f=1", "display_name": "Kallahan C", "link": "https://stackoverflow.com/users/8116529/kallahan-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 0, "accepted_answer_id": 56048915, "answer_count": 2, "score": -1, "last_activity_date": 1557356602, "creation_date": 1557348642, "last_edit_date": 1557356551, "question_id": 56048871, "link": "https://stackoverflow.com/questions/56048871/how-to-return-pointer-to-an-array-of-strings-in-c", "title": "How to return pointer to an array of strings in C", "body": "<p>How can a function return a pointer to an array of strings?</p>\n\n<p>I have to do this without using the C's <code>string.h</code> library. This is what I have so far:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nchar* myFunc(){\n    char* result[2];\n\n    // the strings are originally dynamically allocated with some\n    // function parameters which i've omitted to simplifiy the question.\n\n    result[0] = \"abc\";\n    result[1] = \"def\";\n    return result;   \n}\n\nint main(void){\n    char* result = myFunc();\n    printf(\"%s\\n%s\\n\", result[0], result[1]);\n    return 0;\n}\n</code></pre>\n\n<p>I expect two strings, but the compiler returns this:</p>\n\n<pre><code>error: return from incompatible pointer type [-Wincompatible-pointer-types]\n     return result;\n</code></pre>\n"}, {"tags": ["c", "algorithm", "math", "atan2"], "comments": [{"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 1, "creation_date": 1557348337, "post_id": 56048754, "comment_id": 98739070, "body": "Is this a correct restatement of the problem: Given y0 and y1 that are sin(x) and sin(x+phase), where phase is a constant, return x modulo 2\u03c0?"}, {"owner": {"reputation": 1942, "user_id": 3127336, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/6c56a0083546e0dc8182f729b83a8b73?s=128&d=identicon&r=PG&f=1", "display_name": "George Kourtis", "link": "https://stackoverflow.com/users/3127336/george-kourtis"}, "edited": false, "score": 1, "creation_date": 1557349001, "post_id": 56048754, "comment_id": 98739334, "body": "Please restate exactly the problem as it is not clear. atan2(y,x) works on an y and an x and calculates the angle of the line passing from (0,0) and (x,y) with respect to the positive axis of x giving a result from -\u03c0 excluded to +\u03c0 included."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1557366826, "post_id": 56048754, "comment_id": 98743473, "body": "Note: <code>-\u03c0 &lt;= atan2() &lt;= +\u03c0</code>, not the same range as [0...2\u03c0), nor <code>fmod(a, 2*M_PI)</code>."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1557369111, "post_id": 56048754, "comment_id": 98743923, "body": "This seems like a math question more than a programming question."}], "answers": [{"tags": [], "owner": {"reputation": 60686, "user_id": 277176, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2678da280c230bccef9781b8e5fbaf80?s=128&d=identicon&r=PG", "display_name": "Yakov Galka", "link": "https://stackoverflow.com/users/277176/yakov-galka"}, "is_accepted": true, "score": 9, "last_activity_date": 1557639127, "last_edit_date": 1557639127, "creation_date": 1557351920, "answer_id": 56049463, "question_id": 56048754, "link": "https://stackoverflow.com/questions/56048754/atan2-for-two-sinusoids-of-arbitrary-phase-shift/56049463#56049463", "title": "atan2 for two sinusoids of arbitrary phase shift?", "body": "<p><code>atan2</code> returns the angle of a 2d vector. Your code does not handle such scaling properly. But no worries, it's actually very easy to reduce your problem to an <code>atan2</code> that would handle everything nicely.</p>\n\n<p>Notice that calculating <code>sin(x)</code> and <code>sin(x + phase)</code> is the same as projecting a point <code>(cos(x), sin(x))</code> onto the axes <code>(0, 1)</code> and <code>(sin(phase), cos(phase))</code>. This is the same as taking dot products with those axes, or transforming the coordinate system from the standard orthogonal basis into the skewed one. This suggests a simple solution: inverse the transformation to get the coordinates in the orthogonal basis and then use <code>atan2</code>.</p>\n\n<p>Here's a code that does that:</p>\n\n<pre><code>double super_atan2(double x0, double x1, double a0, double a1) {\n    double det = sin(a0 - a1);\n    double u = (x1*sin(a0) - x0*sin(a1))/det;\n    double v = (x0*cos(a1) - x1*cos(a0))/det;\n    return atan2(v, u);\n}\n\ndouble duper_atan2(double y0, double y1, double phase) {\n    const double tau = 6.28318530717958647692; // https://tauday.com/\n    return super_atan2(y0, y1, tau/4, tau/4 - phase);\n}\n</code></pre>\n\n<p><code>super_atan2</code> gets the angles of the two projection axes, <code>duper_atan2</code> solves the problem exactly as you stated.</p>\n\n<p>Also notice that the calculation of <code>det</code> is not strictly necessary. It is possible to replace it by <code>fmod</code> and <code>copysign</code> (we still need the correct sign of <code>u</code> and <code>v</code>).</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user1157391"}, "is_accepted": false, "score": 1, "last_activity_date": 1566548089, "last_edit_date": 1566548089, "creation_date": 1557356286, "answer_id": 56050090, "question_id": 56048754, "link": "https://stackoverflow.com/questions/56048754/atan2-for-two-sinusoids-of-arbitrary-phase-shift/56050090#56050090", "title": "atan2 for two sinusoids of arbitrary phase shift?", "body": "<p><strong>Derivation:</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/KsmuP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/KsmuP.png\" alt=\"derivation\"></a></p>\n\n<p><strong>In code:</strong></p>\n\n<pre><code>// assume phase != k * pi, for any integer k\ndouble f (double y0, double y1, double phase)\n{\n    double u = (- y0 * cos(phase) + y1) / sin(phase);\n    double v = y0;\n\n    double x = atan2 (v, u);\n    return (x &lt; 0) ? (x + 2 * M_PI) : x;\n}\n</code></pre>\n"}], "owner": {"reputation": 14214, "user_id": 476410, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a2eca89d3f5a16ae846f501d0596116c?s=128&d=identicon&r=PG", "display_name": "tarabyte", "link": "https://stackoverflow.com/users/476410/tarabyte"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 458, "favorite_count": 1, "accepted_answer_id": 56049463, "answer_count": 2, "score": 4, "last_activity_date": 1566548089, "creation_date": 1557348100, "last_edit_date": 1557420962, "question_id": 56048754, "link": "https://stackoverflow.com/questions/56048754/atan2-for-two-sinusoids-of-arbitrary-phase-shift", "title": "atan2 for two sinusoids of arbitrary phase shift?", "body": "<p>I'm trying to implement an atan2-like function to map two input sinusoidal signals of arbitrary relative phase shift to a single output signal that linearly goes from <code>0</code> to <code>2\u03c0</code>.  <code>atan2</code> normally assumes two signals with a 90 deg phase shift.</p>\n\n<h3>Given <code>y0(x) = sin(x)</code> and <code>y1 = sin(x + phase)</code>, where <code>phase</code> is a fixed non-zero value, how can I implement a way to return <code>x</code> modulo <code>2\u03c0</code>?</h3>\n"}, {"tags": ["c", "pointers", "memory", "heap-memory"], "comments": [{"owner": {"reputation": 113, "user_id": 7903641, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KBkoO.jpg?s=128&g=1", "display_name": "Faizan Shah", "link": "https://stackoverflow.com/users/7903641/faizan-shah"}, "reply_to_user": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1557347944, "post_id": 56048688, "comment_id": 98738907, "body": "using double pointer its very simple like this: v-&gt;e_array[v-&gt;no_e]=new_val;"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 2, "creation_date": 1557348160, "post_id": 56048688, "comment_id": 98738989, "body": "Unless you show us how each variable is declared, allocated and passed as a parameter, all anyone can do is guess. Your <code>v-&gt;e_array[v-&gt;no_e]=new_val;</code> may very well need to be <code>(v-&gt;e_array)[v-&gt;no_e]=new_val;</code>, but there is no way to tell with what you posted."}, {"owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1557348596, "post_id": 56048688, "comment_id": 98739159, "body": "@DavidC.Rankin <code>-&gt;</code> and <code>[]</code> have the same precedence, and left-to-right associativity, so the parentheses are not needed, right?"}, {"owner": {"reputation": 113, "user_id": 7903641, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KBkoO.jpg?s=128&g=1", "display_name": "Faizan Shah", "link": "https://stackoverflow.com/users/7903641/faizan-shah"}, "edited": false, "score": 0, "creation_date": 1557348764, "post_id": 56048688, "comment_id": 98739231, "body": "yeah but the thing is I am not allowed to used double pointer"}, {"owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "edited": false, "score": 0, "creation_date": 1557348846, "post_id": 56048688, "comment_id": 98739267, "body": "But what are you using? We don&#39;t know because you didn&#39;t show us.  You just said pointer array, which is not clear at all"}], "answers": [{"tags": [], "owner": {"reputation": 588, "user_id": 7067224, "user_type": "registered", "profile_image": "https://graph.facebook.com/1307022785978070/picture?type=large", "display_name": "Gabriel Pellegrino", "link": "https://stackoverflow.com/users/7067224/gabriel-pellegrino"}, "is_accepted": true, "score": 0, "last_activity_date": 1557349243, "last_edit_date": 1557349243, "creation_date": 1557348054, "answer_id": 56048744, "question_id": 56048688, "link": "https://stackoverflow.com/questions/56048688/copying-data-to-an-integer-pointer-array-through-loop/56048744#56048744", "title": "Copying data to an integer pointer array through loop?", "body": "<p>If you have something like this:</p>\n\n<pre><code>int *x = malloc(sizeof(int)*4);\n</code></pre>\n\n<p>You can put values in it with pointer arithmetic: </p>\n\n<pre><code>for(int i = 0; i &lt; 4; i++) {\n    *(x+i) = i; // or *(x+1) = 0; for example\n}\n</code></pre>\n\n<p>Or simply: </p>\n\n<pre><code>for(int i = 0; i &lt; 4; i++) {\n    x[i] = i;\n}\n</code></pre>\n"}], "owner": {"reputation": 113, "user_id": 7903641, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KBkoO.jpg?s=128&g=1", "display_name": "Faizan Shah", "link": "https://stackoverflow.com/users/7903641/faizan-shah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "closed_date": 1557387179, "accepted_answer_id": 56048744, "answer_count": 1, "score": -3, "last_activity_date": 1557349243, "creation_date": 1557347818, "question_id": 56048688, "link": "https://stackoverflow.com/questions/56048688/copying-data-to-an-integer-pointer-array-through-loop", "closed_reason": "Not suitable for this site", "title": "Copying data to an integer pointer array through loop?", "body": "<p>I am facing issue copying data to void pointer array through for loop. I am not allowed to use double pointer.</p>\n\n<p>I am trying someting like this:</p>\n\n<pre><code>for(i=0;i&lt;9;i++){\n   array + i = i;\n}\n</code></pre>\n\n<p>but I cant just do this, and I know that,</p>\n\n<p>I am trying to do it like this</p>\n\n<pre><code>memcpy(\n  array+i,\n  i,\n  s\n);\n</code></pre>\n\n<p>I have already allocated memory:\nMy actual code is some thing like this:</p>\n\n<pre><code>if(v-&gt;e_type==V_INT){\n  //  printf(\"%p \",v-&gt;e_array+v-&gt;no_e);\n        memcpy(\n               v-&gt;e_array+v-&gt;no_e,\n               new_val,\n               v-&gt;e_sz\n               );\n}\n</code></pre>\n"}, {"tags": ["python", "c", "arrays", "uint32-t"], "comments": [{"owner": {"reputation": 24610, "user_id": 270986, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c49652c88a43a35bbf0095abfdae3515?s=128&d=identicon&r=PG", "display_name": "Mark Dickinson", "link": "https://stackoverflow.com/users/270986/mark-dickinson"}, "edited": false, "score": 1, "creation_date": 1557347041, "post_id": 56048461, "comment_id": 98738513, "body": "The <code>to_bytes</code> answer to the question you identify seems to fit: <code>0x240918.to_bytes(4, &quot;big&quot;) == b&quot;\\000$\\t\\030&quot;</code> gives me <code>True</code> on Python 3.7. <code>struct.pack(&#39;&gt;I&#39;, 0x240918)</code> also works."}, {"owner": {"reputation": 1326, "user_id": 3180006, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EiLOs.jpg?s=128&g=1", "display_name": "Filip Dimitrovski", "link": "https://stackoverflow.com/users/3180006/filip-dimitrovski"}, "edited": false, "score": 1, "creation_date": 1557347238, "post_id": 56048461, "comment_id": 98738599, "body": "The solution you linked is exactly the same code. <code>bytes((0x00240918 &gt;&gt; i &amp; 0xff) for i in (24,16,8,0)) == b&quot;\\000$\\t\\030&quot;</code> is True."}, {"owner": {"reputation": 24610, "user_id": 270986, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c49652c88a43a35bbf0095abfdae3515?s=128&d=identicon&r=PG", "display_name": "Mark Dickinson", "link": "https://stackoverflow.com/users/270986/mark-dickinson"}, "edited": false, "score": 1, "creation_date": 1557347331, "post_id": 56048461, "comment_id": 98738642, "body": "Note that <code>b&#39;\\x00$\\t\\x18&#39;</code> and <code>b&quot;\\000$\\t\\030&quot;</code> are different representations of the same string."}, {"owner": {"reputation": 9246, "user_id": 1041868, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/6d476b07acb3919c356015e11ad97608?s=128&d=identicon&r=PG", "display_name": "bph", "link": "https://stackoverflow.com/users/1041868/bph"}, "edited": false, "score": 0, "creation_date": 1557347374, "post_id": 56048461, "comment_id": 98738663, "body": "bingo! how can I switch from one to the other? i.e. get my system to print b&quot;\\000$\\t\\030&quot; rather than b&#39;\\x00$\\t\\x18&#39;?"}], "answers": [{"tags": [], "owner": {"reputation": 1326, "user_id": 3180006, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EiLOs.jpg?s=128&g=1", "display_name": "Filip Dimitrovski", "link": "https://stackoverflow.com/users/3180006/filip-dimitrovski"}, "is_accepted": true, "score": 3, "last_activity_date": 1557350001, "last_edit_date": 1557350001, "creation_date": 1557347432, "answer_id": 56048614, "question_id": 56048461, "link": "https://stackoverflow.com/questions/56048461/how-to-convert-uint32-t-to-unsigned-char-array/56048614#56048614", "title": "How to convert uint32_t to unsigned char array?", "body": "<blockquote>\n  <p>hmmm a bit different - i'm sure the answer is staring me in the face here but can't see what it is?</p>\n</blockquote>\n\n<p>30 octal i.e. <code>\"\\030\"</code> is the same as 18 hexadecimal i.e. <code>\"\\x18\"</code>. Both of them represent a single byte in your byte sequence with a decimal value of 24. </p>\n\n<p>You can compare the exact values in the REPL:</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>bytes((0x00240918 &gt;&gt; i &amp; 0xff) for i in (24,16,8,0)) == b\"\\000$\\t\\030\"\nTrue\n</code></pre>\n\n<p><a href=\"https://docs.python.org/3/reference/lexical_analysis.html#string-and-bytes-literals\" rel=\"nofollow noreferrer\">Check the Python documentation on string and byte literals</a>:</p>\n\n<ul>\n<li><code>\\ooo</code>    Character with octal value ooo</li>\n<li><code>\\xhh</code>    Character with hex value hh</li>\n</ul>\n\n<p>These can be used in byte literals as well as strings (keep in mind that strings are byte sequences in Python 2).</p>\n\n<p>I don't think <code>bytes</code> support an octal representation by default (the ascii codec always uses hex), but you can code your own:</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>import re\nmy_b = b'\\x00$\\t\\x18'\nprint(re.sub(r'\\\\x([0-9a-f]{2})', lambda a: \"\\\\%03o\" % int(a.groups()[0], 16),\n  str(my_b)))\n# Console result: b'\\000$\\t\\030'\n</code></pre>\n\n<p>Keep in mind that the string contains verbatim quotes and the <code>b'</code> prefix, and it may accept escaped slashes as a hex sequence. If you really want a good octal <code>__repr__</code> the best way would be to create a loop and check for non-printable characters, convert them to 3 digit octal and join everything into a string.</p>\n"}], "owner": {"reputation": 9246, "user_id": 1041868, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/6d476b07acb3919c356015e11ad97608?s=128&d=identicon&r=PG", "display_name": "bph", "link": "https://stackoverflow.com/users/1041868/bph"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1088, "favorite_count": 0, "accepted_answer_id": 56048614, "answer_count": 1, "score": 3, "last_activity_date": 1557354768, "creation_date": 1557346706, "last_edit_date": 1557354768, "question_id": 56048461, "link": "https://stackoverflow.com/questions/56048461/how-to-convert-uint32-t-to-unsigned-char-array", "title": "How to convert uint32_t to unsigned char array?", "body": "<p>I'm trying to replicate conversion <code>uint32_t</code> values to <code>unsigned char</code> arrays in python (I've already done it in C)</p>\n\n<p>This is my existing C function:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>unsigned char *uint32_to_char_array(const uint32_t n)\n{\n    unsigned char *a;\n\n    a = wrap_calloc(4, sizeof(unsigned char));\n\n    a[0] = (n &gt;&gt; 24) &amp; 0xff;  /* high-order (leftmost) byte: bits 24-31 */\n    a[1] = (n &gt;&gt; 16) &amp; 0xff;  /* next byte, counting from left: bits 16-23 */\n    a[2] = (n &gt;&gt;  8) &amp; 0xff;  /* next byte, bits 8-15 */\n    a[3] = n         &amp; 0xff;  /* low-order byte: bits 0-7 */\n\n    return a;\n}\n</code></pre>\n\n<p>If I were to do the following in gdb:</p>\n\n<pre><code>(gdb) p uint32_to_char_array(0x00240918)[0]@4  = \"\\000$\\t\\030\"\n</code></pre>\n\n<p>And it's that string I'm trying to generate in python.</p>\n\n<p>i.e. for a <code>uint32_t</code> input value of <code>0x240918</code> I want an output string of <code>\"\\000$\\t\\030\"</code></p>\n\n<p>I've scoured SO but to no avail thus far, particularly this -> <a href=\"https://stackoverflow.com/questions/6187699/how-to-convert-integer-value-to-array-of-four-bytes-in-python\">How to convert integer value to array of four bytes in python</a> but none of the answers seem to yield the input/output combination stated above</p>\n\n<p>I'm using 2.7, but could use > 3.0 if required.</p>\n\n<p>Update:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>Python 3.5.2 (default, Nov 12 2018, 13:43:14) \n[GCC 5.4.0 20160609] on linux\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\n&gt;&gt;&gt; 0x240918.to_bytes(4, \"big\")\nb'\\x00$\\t\\x18'\n</code></pre>\n\n<p>Hmmm a bit different \u2014 I'm sure the answer is staring me in the face here but I can't see what it is?</p>\n\n<p>So I can see:</p>\n\n<pre><code>&gt;&gt;&gt; b\"\\000$\\t\\030\"\nb'\\x00$\\t\\x18'\n</code></pre>\n\n<p>But how might one achieve the reverse? i.e.</p>\n\n<pre><code>&gt;&gt;&gt; b'\\x00$\\t\\x18'\nb\"\\000$\\t\\030\"\n</code></pre>\n\n<p>Maybe the question is how I can print a bytes-literal in octal rather than hexadecimal?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 4, "creation_date": 1557346349, "post_id": 56048309, "comment_id": 98738210, "body": "This memory has an <i>automatic</i> storage class. Such a storage class does not get initialized. So it can have any values in the beginning (including the ones that were there in the previous iteration). Why? Because it is defined this way and it gives the compiler (and the compiled code) the freedom of not doing some work which might be unnecessary."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1557346360, "post_id": 56048309, "comment_id": 98738214, "body": "If you do not like it - use Java. It is just coincidence that newly allocated on the stack variable share the same memory location."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 3, "creation_date": 1557346391, "post_id": 56048309, "comment_id": 98738226, "body": "It&#39;s a waste of CPU cycles to force every variable to be initialized to zero when it isn&#39;t needed."}, {"owner": {"reputation": 6674, "user_id": 3114742, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/Mtrh6.jpg?s=128&g=1", "display_name": "Zach Smith", "link": "https://stackoverflow.com/users/3114742/zach-smith"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1557346523, "post_id": 56048309, "comment_id": 98738272, "body": "Perhaps I should have worded that in a slightly less judgmental way @P__J__. Edited"}, {"owner": {"reputation": 6674, "user_id": 3114742, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/Mtrh6.jpg?s=128&g=1", "display_name": "Zach Smith", "link": "https://stackoverflow.com/users/3114742/zach-smith"}, "edited": false, "score": 0, "creation_date": 1557346869, "post_id": 56048309, "comment_id": 98738425, "body": "@P__J__- you might be interested to know that there is an error on your webpage (diymat.co.uk): &quot;Warning: Parameter 2 to wp_hide_post_Public::query_posts_join() expected to be a reference, value given in /var/www/vhosts/diymat.co.uk/httpdocs/wp-includes/class-wp-h&zwnj;&#8203;ook.php on line 286&quot;"}, {"owner": {"reputation": 6674, "user_id": 3114742, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/Mtrh6.jpg?s=128&g=1", "display_name": "Zach Smith", "link": "https://stackoverflow.com/users/3114742/zach-smith"}, "edited": false, "score": 0, "creation_date": 1557346981, "post_id": 56048309, "comment_id": 98738481, "body": "fair enough &#175;_(\u30c4)_/&#175;"}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 2, "creation_date": 1557347087, "post_id": 56048309, "comment_id": 98738530, "body": "If you&#39;re always going to use <code>responseData</code> as a <i>string</i> you can keep 7999 bytes uninitialized and simply assign <code>&#39;\\0&#39;</code> to the first one: <code>char responseData[8000]; *responseData = 0;</code>"}, {"owner": {"reputation": 6674, "user_id": 3114742, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/Mtrh6.jpg?s=128&g=1", "display_name": "Zach Smith", "link": "https://stackoverflow.com/users/3114742/zach-smith"}, "reply_to_user": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1557347160, "post_id": 56048309, "comment_id": 98738558, "body": "Why would that result in the memory being cleared/reinitialized @pmg?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1557347241, "post_id": 56048309, "comment_id": 98738600, "body": ".. or if you want to initialize it (like with initializer) you can do <code>char responseData[8000] = {0};</code>. Under the hood it will get compiled into something equivalent to <code>memset</code>."}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 2, "creation_date": 1557347246, "post_id": 56048309, "comment_id": 98738605, "body": "With <code>*responseData = 0;</code> only the first byte (of the 8000 uncleared) is written to. That makes the object a proper string with length zero. Subsequent string operations (<code>strcat()</code> especially) will do the right thing."}, {"owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "reply_to_user": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1557350537, "post_id": 56048309, "comment_id": 98739862, "body": "@pmg Maybe <code>responseData[0] = &#39;\\0&#39;;</code> would have been more clear."}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "reply_to_user": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "edited": false, "score": 0, "creation_date": 1557389012, "post_id": 56048309, "comment_id": 98750354, "body": "@CacahueteFrito: I agree about <code>a[0]</code> vs <code>*a</code> (and I&#39;ll try and remember to use the array form in the future); I&#39;m not so sure about <code>&#39;\\0&#39;</code> vs <code>0</code> -- thanks for the heads up :)"}], "answers": [{"comments": [{"owner": {"reputation": 67968, "user_id": 584192, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YBSIc.png?s=128&g=1", "display_name": "Samuel Liew", "link": "https://stackoverflow.com/users/584192/samuel-liew"}, "edited": false, "score": 1, "creation_date": 1557359011, "post_id": 56048423, "comment_id": 98742020, "body": "Comments are not for extended discussion; this conversation has been <a href=\"https://chat.stackoverflow.com/rooms/193066/discussion-on-answer-by-gabriel-pellegrino-why-do-variables-declared-with-the-sa\">moved to chat</a>."}], "tags": [], "owner": {"reputation": 588, "user_id": 7067224, "user_type": "registered", "profile_image": "https://graph.facebook.com/1307022785978070/picture?type=large", "display_name": "Gabriel Pellegrino", "link": "https://stackoverflow.com/users/7067224/gabriel-pellegrino"}, "is_accepted": false, "score": 6, "last_activity_date": 1557347442, "last_edit_date": 1557347442, "creation_date": 1557346543, "answer_id": 56048423, "question_id": 56048309, "link": "https://stackoverflow.com/questions/56048309/why-do-variables-declared-with-the-same-name-in-different-scopes-get-assigned-th/56048423#56048423", "title": "Why do variables declared with the same name in different scopes get assigned the same memory addresses?", "body": "<p>With this line:</p>\n\n<pre><code>char responseData[8000];\n</code></pre>\n\n<p>You are saying to your compiler: Hey big C, give me a 8000 bytes chunk and name it responseData.</p>\n\n<p>In runtime, if you don't specify, no one will ever clean or give you a \"brand-new\" chunk of memory. That means that the 8000 bytes chunk you get in every single execution can hold all the possible permutations of bits in this 8000 bytes. Something extraordinary that can happens, is that you're getting in every execution the same memory region and thus, the same bits in this 8000 bytes your big C gave to you in the first time. So, if you don't clean, you have the impression that you're using the same variable, but you're not! You're just using the same (never cleaned) memory region.</p>\n\n<p>I'd add that it's part of the programmer's responsibilities to clean, if you need to, the memory you're allocating, in dynamic or static way.</p>\n"}, {"comments": [{"owner": {"reputation": 588, "user_id": 7067224, "user_type": "registered", "profile_image": "https://graph.facebook.com/1307022785978070/picture?type=large", "display_name": "Gabriel Pellegrino", "link": "https://stackoverflow.com/users/7067224/gabriel-pellegrino"}, "edited": false, "score": 2, "creation_date": 1557348747, "post_id": 56048617, "comment_id": 98739222, "body": "For idiomatic use, change to responseData[0] = &#39;\\0&#39;;"}, {"owner": {"reputation": 588, "user_id": 7067224, "user_type": "registered", "profile_image": "https://graph.facebook.com/1307022785978070/picture?type=large", "display_name": "Gabriel Pellegrino", "link": "https://stackoverflow.com/users/7067224/gabriel-pellegrino"}, "edited": false, "score": 0, "creation_date": 1557348846, "post_id": 56048617, "comment_id": 98739266, "body": "Also, the answer is OK if you&#39;re not dealing with char arrays as strings? I mean, what if this char arrays contains images, when &#39;\\0&#39; isn&#39;t meaning the end of it?"}, {"owner": {"reputation": 8087, "user_id": 733637, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/444bbb295cc6185a5464e2250c1a35de?s=128&d=identicon&r=PG&f=1", "display_name": "CiaPan", "link": "https://stackoverflow.com/users/733637/ciapan"}, "reply_to_user": {"reputation": 588, "user_id": 7067224, "user_type": "registered", "profile_image": "https://graph.facebook.com/1307022785978070/picture?type=large", "display_name": "Gabriel Pellegrino", "link": "https://stackoverflow.com/users/7067224/gabriel-pellegrino"}, "edited": false, "score": 0, "creation_date": 1557386465, "post_id": 56048617, "comment_id": 98749039, "body": "@GabrielPellegrino Thank you for your comments. As for the first one: yes, you&#39;re right; <code>&#39;\\0&#39;</code> is more explicit. I fixed it. For the latter: generally, <code>char[]</code> is an array of <i>characters</i>. Of course you can store other kind of data in it, we can <code>memcpy</code> any block of arbitrary data into a character array. Anyway, <code>strcpy</code> and <code>strcat</code> operate on <i>NUL-terminated strings</i> of chars."}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 1, "creation_date": 1557389109, "post_id": 56048617, "comment_id": 98750414, "body": "<code>&#39;\\0&#39;</code> is an <code>int</code> absolutely 100% equal to <code>0</code>."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1557390222, "post_id": 56048617, "comment_id": 98751024, "body": "<code>char responseData[8000] = { 0 };</code> would be more idiomatic"}, {"owner": {"reputation": 8087, "user_id": 733637, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/444bbb295cc6185a5464e2250c1a35de?s=128&d=identicon&r=PG&f=1", "display_name": "CiaPan", "link": "https://stackoverflow.com/users/733637/ciapan"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1557395442, "post_id": 56048617, "comment_id": 98754063, "body": "@M.M Yes, but that unnecessarily initializes all the 8000 items of the array whilst it&#39;s actually needed to initialize just the first character."}, {"owner": {"reputation": 8087, "user_id": 733637, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/444bbb295cc6185a5464e2250c1a35de?s=128&d=identicon&r=PG&f=1", "display_name": "CiaPan", "link": "https://stackoverflow.com/users/733637/ciapan"}, "reply_to_user": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1557396698, "post_id": 56048617, "comment_id": 98754779, "body": "@pmg Right. Fixed. Thank you!"}], "tags": [], "owner": {"reputation": 8087, "user_id": 733637, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/444bbb295cc6185a5464e2250c1a35de?s=128&d=identicon&r=PG&f=1", "display_name": "CiaPan", "link": "https://stackoverflow.com/users/733637/ciapan"}, "is_accepted": true, "score": 8, "last_activity_date": 1566077922, "last_edit_date": 1566077922, "creation_date": 1557347463, "answer_id": 56048617, "question_id": 56048309, "link": "https://stackoverflow.com/questions/56048309/why-do-variables-declared-with-the-same-name-in-different-scopes-get-assigned-th/56048617#56048617", "title": "Why do variables declared with the same name in different scopes get assigned the same memory addresses?", "body": "<p>Not completely correct. You don't need to clear the whole <code>responseData</code> array - clearing its first byte is just enough:</p>\n\n<pre><code> responseData[0] = 0;\n</code></pre>\n\n<p>As Gabriel Pellegrino notes in <a href=\"https://stackoverflow.com/questions/56048309/why-do-variables-declared-with-the-same-name-in-different-scopes-get-assigned-th/56048617#comment98739222_56048617\">the comment</a>, a more idiomatic expression is</p>\n\n<pre><code> responseData[0] = '\\0';\n</code></pre>\n\n<p>It explicitly defines a character via its code point of zero value, while the former uses an <code>int</code> constant zero. In both cases the right-side argument has type <code>int</code> which is implicitly converted (truncated) to <code>char</code> type for assignment. (Paragraph fixed thx to the pmg's <a href=\"https://stackoverflow.com/questions/56048309/why-do-variables-declared-with-the-same-name-in-different-scopes-get-assigned-th/56048617#comment98750414_56048617\">comment</a>.)</p>\n\n<p>You could know that from the <code>strcat</code> documentation:  the function <strong>appends</strong> its second argument string to the first one. If you need the very first chunk to get <strong>stored</strong> into the buffer, you want to append it to an empty string, so you need to ensure the string in the buffer is empty. That is, it consists of the terminating NUL character only. <code>memset</code>-ting the whole array is an overkill,  hence a waste of time.</p>\n\n<p>Additionally, using a <code>strlen</code> on the array is asking for troubles. You can't know what the actual contents of the memory block allocated for the array is. If it was not used yet or was overwritten with some other data since your last use, it <em>may</em> contain <em>no</em> NUL character. Then <code>strlen</code> will run out of the array causing Undefined Behavior. And even if it returns successfuly, it will give you the string's length bigger than the size of the array. As a result <code>memset</code> will run out of the array, possibly overwriting some vital data!</p>\n\n<p>Use <strong>sizeof</strong> whenever you <code>memset</code> an array!</p>\n\n<pre><code>memset(responseData, 0, sizeof(responseData));\n</code></pre>\n\n<p><strong>EDIT</strong></p>\n\n<p>In the above I tried to explain how to fix the issue with your code, but I didn't answer your questions. Here they are:</p>\n\n<ol>\n<li><strong>Why do variables (...) in different scopes get assigned the same memory addresses?</strong></li>\n</ol>\n\n<p>In regard of execution each iteration of the <code>while(1) { ... }</code> loop indeed creates a new scope. However, each scope terminates before the new one is created, so the compiler reserves appropriate block of memory on the stack and the loop re-uses it in every iteration. That also simplifies a compiled code: every iteration is executed by exactly the same code, which simply jumps at the end to the beginning. All instructions within the loop that access local variables use exactly the same addressing (relative to the stack) in each iteration. So, each variable in the next iteration has precisely the same location in memory as in all previous iterations.</p>\n\n<ol start=\"2\">\n<li><strong>I'm finding that I have to manually clear memory</strong></li>\n</ol>\n\n<p>Yes, automatic variables, allocated on the stack, are <em>not initialized</em> in C by default. We always need to explicitly assign an initial value before we use it \u2013 otherwise the value is undefined and may be incorrect (for example, a floating-point variable can appear not-a-number, a character array may appear not terminated, an <code>enum</code> variable may have a value out of the enum's definition, a pointer variable may not point at a valid, accessible location, etc.).</p>\n\n<ol start=\"3\">\n<li><strong>otherwise the contents (...) are just continuously appended</strong></li>\n</ol>\n\n<p>This one was answered above.</p>\n\n<ol start=\"4\">\n<li><strong>Coming from JavaScript, this was surprising</strong></li>\n</ol>\n\n<p>Yes, JavaScript apparently <em>creates</em> new variables at the new scope, hence each time you get a brand new array \u2013 and it is empty. In C you just get the same area of a previously allocated memory for an automatic variable, and it's your responsibility to initialize it.</p>\n\n<p>Additionally, consider two consecutive loops:</p>\n\n<pre><code>void test()\n{\n    int i;\n\n    for (i=0; i&lt;5; i++) {\n        char buf1[10];\n        sprintf(buf1, \"%d\", i);\n    }\n\n    for (i=0; i&lt;1; i++) {\n        char buf2[10];\n        printf(\"%s\\n\", buf2);\n    }\n}\n</code></pre>\n\n<p>The first one prints a single-digit, character representation of five numbers into the character array, overwriting it each time - hence the last value of <code>buf1[]</code> (as a string) is <code>\"4\"</code>.</p>\n\n<p>What output do you expect from the second loop? Generally speaking, we can't know what <code>buf2[]</code> will contain, and <code>printf</code>-ing it causes UB. However we <em>may suppose</em> the same set of variables (namely a single 10-items character array) from both disjoint scopes will get allocated the same way in the same part of a stack. If this is the case, we'll get a digit <code>4</code> as an output from a (formally uninitialized) array.</p>\n\n<p>This result depends on the compiler construction and should be considered a coincidence. Do not rely on it as this is UB!</p>\n\n<ol start=\"5\">\n<li><strong>Why wouldn't C just reset that memory behind the scenes?</strong></li>\n</ol>\n\n<p>Because it's not told to. The language was created to compile to effective, compact code. It does as little 'behind the scenes' as possible. Among others things it does <em>not</em> do is <em>not</em> initializing automatic variables unless it's told to. Which means you need to add an explicit initializer to a local variable declaration or add an initializing instruction (e.g. an assignment) before the first use. (This does not apply to global, module-scope variables; those are initialized to zeros by default.)</p>\n\n<p>In higher-level languages some or all variables are initialized on creation, but not in C. That's its feature and we must live with it \u2013 or just not use this language.</p>\n"}, {"comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1557390271, "post_id": 56048750, "comment_id": 98751047, "body": "&quot; space for all block-scope objects within a function is allocated on function entry, and released on function exit.&quot;  - VLAs aren&#39;t allocated until execution reaches their definition"}], "tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": false, "score": 3, "last_activity_date": 1557409665, "last_edit_date": 1557409665, "creation_date": 1557348079, "answer_id": 56048750, "question_id": 56048309, "link": "https://stackoverflow.com/questions/56048309/why-do-variables-declared-with-the-same-name-in-different-scopes-get-assigned-th/56048750#56048750", "title": "Why do variables declared with the same name in different scopes get assigned the same memory addresses?", "body": "<blockquote>\n  <p>Why would I want to declare a variable and have access to the memory contents of a variable declared in a different scope with the same name? Why wouldn't  C just reset that memory behind the scenes?</p>\n</blockquote>\n\n<p>Objects with <code>auto</code> storage duration (i.e., block-scope variables) are not automatically initialized - their initial contents are <em>indeterminate</em>.  Remember that C is a product of the early 1970s, and errs on the side of runtime speed over convenience.  The C philosophy is that the programmer is in the best position to know whether something should be initialized to a known value or not, and is smart enough to do it themselves if needed.   </p>\n\n<p>While you're <em>logically</em> creating and destroying a new instance of <code>responseData</code> on each loop iteration, it turns out the same memory location is being reused each time through.  We like to think that space is allocated for each block-scope object as we enter the block and released as we leave it, but in practice that's (usually) not the case - space for <em>all</em> block-scope objects within a function is allocated on function entry, and released on function exit<sup>1</sup>.  </p>\n\n<p>Different objects in different scopes <em>may</em> map to the same memory behind the scenes.  Consider something like</p>\n\n<pre><code>void bletch( void )\n{\n  if ( some_condition )\n  {\n    int foo = some_function();\n    printf( \"%d\\n\", foo );\n  } \n  else\n  {\n    int bar = some_other_function();\n    printf( \"%d\\n\", bar );\n  }\n</code></pre>\n\n<p>It's impossible for both <code>foo</code> and <code>bar</code> to exist at the same time, so there's no reason to allocate separate space for both - the compiler will (usually) allocate space for one <code>int</code> object at function entry, and that space gets used for either <code>foo</code> or <code>bar</code> depending on which branch is taken.  </p>\n\n<p>So, what happens with <code>responseData</code> is that space for <em>one</em> 8000-character array is allocated on function entry,\u00a0and that same space gets used for each iteration of the loop.  That's why you need to clear it out on each iteration, either with a <code>memset</code> call or with an initializer like</p>\n\n<pre><code>char responseData[8000] = {0}; \n</code></pre>\n\n<p><hr>\n<sup></p>\n\n<ol>\n<li>As M.M points out in a comment, this isn't true for variable-length arrays (and potentially other variably modified types) - space for those <em>is</em> set aside as needed, although where that space is taken from isn't specified by the language definition.  For all other types, though, the <em>usual</em> practice is to allocate all necessary space on function entry.\n</ol>\n\n<p></sup></p>\n"}], "owner": {"reputation": 6674, "user_id": 3114742, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/Mtrh6.jpg?s=128&g=1", "display_name": "Zach Smith", "link": "https://stackoverflow.com/users/3114742/zach-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 658, "favorite_count": 0, "accepted_answer_id": 56048617, "answer_count": 3, "score": 5, "last_activity_date": 1566077922, "creation_date": 1557346070, "last_edit_date": 1557346559, "question_id": 56048309, "link": "https://stackoverflow.com/questions/56048309/why-do-variables-declared-with-the-same-name-in-different-scopes-get-assigned-th", "title": "Why do variables declared with the same name in different scopes get assigned the same memory addresses?", "body": "<p>I know that declaring a <code>char[]</code> variable in a while loop is scoped, having seen this post: <a href=\"https://stackoverflow.com/questions/41993585/redeclaring-variables-in-c\">Redeclaring variables in C</a>.</p>\n\n<p>Going through a tutorial on creating a simple web server in <code>C</code>, I'm finding that I have to manually clear memory assigned to <code>responseData</code> in the example below, otherwise the contents of <code>index.html</code> are just continuously appended to the response and the response contains duplicated contents from <code>index.html</code>:</p>\n\n<pre><code>while (1)\n{\n  int clientSocket = accept(serverSocket, NULL, NULL);\n  char httpResponse[8000] = \"HTTP/1.1 200 OK\\r\\n\\n\";\n  FILE *htmlData = fopen(\"index.html\", \"r\");\n  char line[100];\n  char responseData[8000];\n  while(fgets(line, 100, htmlData) != 0)\n  {\n      strcat(responseData, line);\n  }\n  strcat(httpResponse, responseData);\n  send(clientSocket, httpResponse, sizeof(httpResponse), 0);\n  close(clientSocket);\n}\n</code></pre>\n\n<p>Correct by:</p>\n\n<pre><code>while (1)\n{\n  ...\n  char responseData[8000];\n  memset(responseData, 0, strlen(responseData));\n  ...\n}\n</code></pre>\n\n<p>Coming from JavaScript, this was surprising. Why would I want to declare a variable and have access to the memory contents of a variable declared in a different scope with the same name? Why wouldn't <code>C</code> just reset that memory behind the scenes?</p>\n\n<p>Also... Why is it that variables of the same name declared in different scopes get assigned the same memory addresses?</p>\n\n<p>According to this question: <a href=\"https://stackoverflow.com/questions/20184202/variable-declared-interchangebly-has-the-same-pattern-of-memory-address\">Variable declared interchangebly has the same pattern of memory address</a> that ISN'T the case. However, I'm finding that this is occurring pretty reliably.</p>\n"}, {"tags": ["c", "gcc", "elf", "disassembly"], "comments": [{"owner": {"reputation": 1872, "user_id": 2104472, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/18805ffb0c3acfbd23cd6c84951afafc?s=128&d=identicon&r=PG&f=1", "display_name": "Vladislav Ivanishin", "link": "https://stackoverflow.com/users/2104472/vladislav-ivanishin"}, "edited": false, "score": 0, "creation_date": 1557349513, "post_id": 56048252, "comment_id": 98739510, "body": "Is the code this ELF file contains position-independent? What is the output of the <code>file</code> command on this binary?"}], "answers": [{"comments": [{"owner": {"reputation": 155, "user_id": 11472054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e187041679a0b6f232b2dfa940b634f?s=128&d=identicon&r=PG", "display_name": "Keystone", "link": "https://stackoverflow.com/users/11472054/keystone"}, "edited": false, "score": 0, "creation_date": 1557429010, "post_id": 56049390, "comment_id": 98772027, "body": "but <code>1.c</code> use <code>lib.c</code> as dinamic. I want compile the function statically"}, {"owner": {"reputation": 1872, "user_id": 2104472, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/18805ffb0c3acfbd23cd6c84951afafc?s=128&d=identicon&r=PG&f=1", "display_name": "Vladislav Ivanishin", "link": "https://stackoverflow.com/users/2104472/vladislav-ivanishin"}, "reply_to_user": {"reputation": 155, "user_id": 11472054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e187041679a0b6f232b2dfa940b634f?s=128&d=identicon&r=PG", "display_name": "Keystone", "link": "https://stackoverflow.com/users/11472054/keystone"}, "edited": false, "score": 0, "creation_date": 1557434386, "post_id": 56049390, "comment_id": 98774271, "body": "Well, that&#39;s a hard task in the general case, in particular because the function can reference data via <code>rip</code>-relative addressing, and call other functions, etc -- so you&#39;ll need to extract all dependencies. I think you need to disassemble the thing, replace all relative and absolute jumps and references with symbolic values and then assemble and link as usual."}, {"owner": {"reputation": 155, "user_id": 11472054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e187041679a0b6f232b2dfa940b634f?s=128&d=identicon&r=PG", "display_name": "Keystone", "link": "https://stackoverflow.com/users/11472054/keystone"}, "edited": false, "score": 0, "creation_date": 1557472067, "post_id": 56049390, "comment_id": 98783636, "body": "if the function was exported in <code>lib.c</code> is tgat was easy to call? and when I compiled it ,it was statically?"}, {"owner": {"reputation": 1872, "user_id": 2104472, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/18805ffb0c3acfbd23cd6c84951afafc?s=128&d=identicon&r=PG&f=1", "display_name": "Vladislav Ivanishin", "link": "https://stackoverflow.com/users/2104472/vladislav-ivanishin"}, "reply_to_user": {"reputation": 155, "user_id": 11472054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e187041679a0b6f232b2dfa940b634f?s=128&d=identicon&r=PG", "display_name": "Keystone", "link": "https://stackoverflow.com/users/11472054/keystone"}, "edited": false, "score": 0, "creation_date": 1557477862, "post_id": 56049390, "comment_id": 98786292, "body": "@Keystone it would be somewhat <i>easier</i>, but not <i>easy</i>. There&#39;s more information on exported symbols in libraries: address, size, and relocations would be helpful. Still, you&#39;ll face the same fundamental problem: you need to extract already compiled code and recompile (reassemble, actually) without the rest of the library. And that is hard, because the toolchain is not meant for that."}, {"owner": {"reputation": 155, "user_id": 11472054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e187041679a0b6f232b2dfa940b634f?s=128&d=identicon&r=PG", "display_name": "Keystone", "link": "https://stackoverflow.com/users/11472054/keystone"}, "edited": false, "score": 0, "creation_date": 1559594587, "post_id": 56049390, "comment_id": 99462910, "body": "in your example you show how to call function from binary that you complied as ` -shared`.  Is there any way to call to function in binary that I know the offset ,but this binary didn&#39;t compile as shared??"}, {"owner": {"reputation": 1872, "user_id": 2104472, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/18805ffb0c3acfbd23cd6c84951afafc?s=128&d=identicon&r=PG&f=1", "display_name": "Vladislav Ivanishin", "link": "https://stackoverflow.com/users/2104472/vladislav-ivanishin"}, "reply_to_user": {"reputation": 155, "user_id": 11472054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e187041679a0b6f232b2dfa940b634f?s=128&d=identicon&r=PG", "display_name": "Keystone", "link": "https://stackoverflow.com/users/11472054/keystone"}, "edited": false, "score": 0, "creation_date": 1559668222, "post_id": 56049390, "comment_id": 99490390, "body": "Is it a position independent execucable? What is the output of the <code>file</code> command?"}], "tags": [], "owner": {"reputation": 1872, "user_id": 2104472, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/18805ffb0c3acfbd23cd6c84951afafc?s=128&d=identicon&r=PG&f=1", "display_name": "Vladislav Ivanishin", "link": "https://stackoverflow.com/users/2104472/vladislav-ivanishin"}, "is_accepted": false, "score": 3, "last_activity_date": 1557352003, "last_edit_date": 1557352003, "creation_date": 1557351426, "answer_id": 56049390, "question_id": 56048252, "link": "https://stackoverflow.com/questions/56048252/how-call-and-compile-function-from-elf-to-my-binary/56049390#56049390", "title": "How call and compile function from elf to my binary?", "body": "<p>I am going to answer the </p>\n\n<blockquote>\n  <p>call to this function from my c code that I write</p>\n</blockquote>\n\n<p>part.</p>\n\n<p>The below works under certain assumptions, like dynamic linking and position independent code.  I haven't thought for too long about what happens if they are broken (let's experiment/discuss, if there's interest).</p>\n\n<pre><code>$ cat lib.c\nint data = 42;\nstatic int foo () { return data; }\n</code></pre>\n\n<p><code>gcc -fpic -shared lib.c -o lib.so</code></p>\n\n<pre><code>$ nm lib.so  | grep foo\n00000000000010e9 t foo\n</code></pre>\n\n<p>The above reproduces having the address that you know. The address we know now is <code>0x10e9</code>. It is the virtual address of <code>foo</code> before relocation. We'll model the relocation the dynamic loader does by hand by simply adding the base address at which <code>lib.so</code> gets loaded.</p>\n\n<pre><code>$ cat 1.c\n#define _GNU_SOURCE\n#include &lt;stdio.h&gt;\n#include &lt;link.h&gt;\n#include &lt;string.h&gt;\n#include &lt;elf.h&gt;\n\n#define FOO_VADDR 0x10e9\n\ntypedef int(*func_t)();\n\nint callback(struct dl_phdr_info *info, size_t size, void *data)\n{\n    if (!(strstr(info-&gt;dlpi_name, \"lib.so\")))\n        return 0;\n    Elf64_Addr addr = info-&gt;dlpi_addr + FOO_VADDR;\n    func_t f = (func_t)addr;\n    int res = f();\n    printf(\"res = %d\\n\", res);\n    return 0;\n}\n\nint main()\n{\n    void *handle = dlopen(\"./lib.so\", RTLD_LAZY);\n    if (!handle) {\n        puts(\"failed to load\");\n        return 1;\n    }\n    dl_iterate_phdr(&amp;callback, NULL);\n    dlclose(handle);\n    return 0;\n}\n</code></pre>\n\n<p>And now...</p>\n\n<pre><code>$ gcc 1.c -ldl  &amp;&amp; ./a.out\nres = 42\n</code></pre>\n\n<p>Voila -- it worked! That was fun.</p>\n\n<p>Credit: <a href=\"https://stackoverflow.com/a/17390514/2104472\">this</a> was helpful.</p>\n\n<p>If you have questions, feel free to read the man and ask in the comments.</p>\n\n<p>As for </p>\n\n<blockquote>\n  <p>compile this function statically in my binary </p>\n</blockquote>\n\n<p>I don't know off the bat. This would be trickier. Why do you want that? Also, do you know whether the function depends on some data (or maybe it calls other functions) in the original ELF file, like in the example above? </p>\n"}], "owner": {"reputation": 155, "user_id": 11472054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e187041679a0b6f232b2dfa940b634f?s=128&d=identicon&r=PG", "display_name": "Keystone", "link": "https://stackoverflow.com/users/11472054/keystone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 230, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1557452671, "creation_date": 1557345803, "last_edit_date": 1557452671, "question_id": 56048252, "link": "https://stackoverflow.com/questions/56048252/how-call-and-compile-function-from-elf-to-my-binary", "title": "How call and compile function from elf to my binary?", "body": "<p>I have a binary file (ELF) that I don't write, but I want to use 1 function from this binary (I know the address/offset of the function), that function not exported from the binary.</p>\n\n<p>My goal is to call this function from my C code that I write and compile this function statically in my binary (I compile with gcc).  </p>\n\n<p>How can I do that please?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 3, "creation_date": 1557345617, "post_id": 56048179, "comment_id": 98737911, "body": "<code>toDelete = queue-&gt;head-&gt;next;</code> immediately overwrites the pointer to memory which was allocated by <code>malloc</code> in the line above. So when you later <code>free(toDelete)</code> this wasn&#39;t the pointer returned by <code>malloc</code> earlier."}, {"owner": {"reputation": 30558, "user_id": 1013719, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/U8X0A.jpg?s=128&g=1", "display_name": "Ryan Haining", "link": "https://stackoverflow.com/users/1013719/ryan-haining"}, "edited": false, "score": 1, "creation_date": 1557345803, "post_id": 56048179, "comment_id": 98737990, "body": "<a href=\"https://medium.com/@ryanhaining/how-to-malloc-the-right-way-c-476375d53745\" rel=\"nofollow noreferrer\">don&#39;t cast malloc()</a>"}, {"owner": {"reputation": 3, "user_id": 9768414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5368a45e1a4d257f03770beb560731e?s=128&d=identicon&r=PG&f=1", "display_name": "Zedrimar", "link": "https://stackoverflow.com/users/9768414/zedrimar"}, "edited": false, "score": 0, "creation_date": 1557346012, "post_id": 56048179, "comment_id": 98738071, "body": "malloc removed, still last test case fails :/ tried also on <a href=\"https://www.onlinegdb.com/online_c_compiler\" rel=\"nofollow noreferrer\">onlinegdb.com/online_c_compiler</a> since that is a Unix based online compiler, but it also failed. Good to know about that pointer though!"}, {"owner": {"reputation": 3, "user_id": 9768414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5368a45e1a4d257f03770beb560731e?s=128&d=identicon&r=PG&f=1", "display_name": "Zedrimar", "link": "https://stackoverflow.com/users/9768414/zedrimar"}, "edited": false, "score": 0, "creation_date": 1557346305, "post_id": 56048179, "comment_id": 98738188, "body": "Also, thanks for the malloc article, I&#39;ll look into it"}], "answers": [{"tags": [], "owner": {"reputation": 3, "user_id": 9768414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5368a45e1a4d257f03770beb560731e?s=128&d=identicon&r=PG&f=1", "display_name": "Zedrimar", "link": "https://stackoverflow.com/users/9768414/zedrimar"}, "is_accepted": false, "score": 0, "last_activity_date": 1557353796, "creation_date": 1557353796, "answer_id": 56049739, "question_id": 56048179, "link": "https://stackoverflow.com/questions/56048179/popping-stack-doesnt-work-right-stack-from-two-queues/56049739#56049739", "title": "Popping stack doesn&#39;t work right? (Stack from two queues)", "body": "<p>Never mind, I simply needed to move <code>queue-&gt;head-&gt;next = toDelete-&gt;next;</code> outside of the else block, and remove the else block entirely.</p>\n"}], "owner": {"reputation": 3, "user_id": 9768414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5368a45e1a4d257f03770beb560731e?s=128&d=identicon&r=PG&f=1", "display_name": "Zedrimar", "link": "https://stackoverflow.com/users/9768414/zedrimar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1557353890, "creation_date": 1557345497, "last_edit_date": 1557353890, "question_id": 56048179, "link": "https://stackoverflow.com/questions/56048179/popping-stack-doesnt-work-right-stack-from-two-queues", "title": "Popping stack doesn&#39;t work right? (Stack from two queues)", "body": "<p>I've been stewing over this one for a while, and I can't quite seem to figure out why at execution, when once the following function executes, and the test code in main calls to see if the stack is empty, for some reason it isn't. I can't seem to figure out the exact cause, though I have a feeling it has something to do with the \"remove\" function not deleting the last node, but for some reason, I can't figure out how to fix it.</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>TYPE listStackPop (struct Stack* stack)\n{\n    /* FIXME: You will write this function */\n    assert (stack != NULL);\n    assert (!listQueueIsEmpty (stack-&gt;q1));\n    return listQueueRemoveFront (stack-&gt;q1);\n}\n\n---later calls to listQueueRemoveFront---\n\nTYPE listQueueRemoveFront (struct Queue* queue)\n{\n    /* FIXME: You will write this function */\n    assert (queue != 0);\n    assert (!listQueueIsEmpty (queue));\n    struct Link* toDelete;\n    toDelete = queue-&gt;head-&gt;next;\n    if (toDelete == queue-&gt;tail) {\n        queue-&gt;tail = queue-&gt;head;\n    }\n    else {\n        queue-&gt;head-&gt;next = toDelete-&gt;next;\n    }\n    int retVal = toDelete-&gt;value;\n    return retVal;\n}\n\n--For clarity, TYPE is defined as int--\n</code></pre>\n\n<p>I've tried going from simply <code>return toDelete-&gt;value</code> to copying toDelete's value to an int, and passing that int to be returned, as I thought maybe toDelete was being removed prematurely or something, but that isn't the case.\nUnfortunately, google doesn't really have much info on this either. So far anyway.</p>\n\n<p>Here is the full code on pastebin, in case anyone is interested to read it in full: <a href=\"https://pastebin.com/cDvdHmTu\" rel=\"nofollow noreferrer\">https://pastebin.com/cDvdHmTu</a></p>\n\n<p>I had expected it to pass, but for some reason, it failed even though all the other test cases passed.</p>\n\n<p>results:</p>\n\n<pre><code>-------------------------------------------------\n---- Testing stack from queue implementation ----\n-------------------------------------------------\nstack init...\nstackIsEmpty == 1:      PASSED\n\npushing 4, 5, -300...\nstackIsEmpty == 0:      PASSED\n\npopping; val == -300:   PASSED\npopping; val == 5:      PASSED\ntop val == 4    :       PASSED\npopping; val == 4:      PASSED\nstackIsEmpty == 1:      FAILED\n\npushing 0-9...\ntop val == 9    :       PASSED\n\nC:\\Users\\Zedri\\source\\repos\\Stack From Queues\\Debug\\Stack From Queues.exe (process 8928) exited with code 0.\nPress any key to close this window . . .\n</code></pre>\n\n<p>Compiler/IDE Used: Visual Studio 2019</p>\n\n<p>-~-~-~Edit 1~-~-~-</p>\n\n<p>removed malloc call to the toDelete pointer</p>\n\n<p>~-~-~-Edit 2-~-~-~</p>\n\n<p>Fixed code on pastebin. Issue resolved.</p>\n"}, {"tags": ["c++", "c", "language-lawyer", "signed", "integer-overflow"], "comments": [{"owner": {"reputation": 67968, "user_id": 584192, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YBSIc.png?s=128&g=1", "display_name": "Samuel Liew", "link": "https://stackoverflow.com/users/584192/samuel-liew"}, "edited": false, "score": 0, "creation_date": 1557359009, "post_id": 56047702, "comment_id": 98742015, "body": "Comments are not for extended discussion; this conversation has been <a href=\"https://chat.stackoverflow.com/rooms/193060/discussion-on-question-by-chqrlie-is-there-some-meaningful-statistical-data-to-j\">moved to chat</a>."}, {"owner": {"reputation": 25733, "user_id": 559737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5de249db6565b87a2699e131974268a?s=128&d=identicon&r=PG", "display_name": "Brendan", "link": "https://stackoverflow.com/users/559737/brendan"}, "edited": false, "score": 3, "creation_date": 1557359609, "post_id": 56047702, "comment_id": 98742118, "body": "The reason C says signed integer overflow is undefined is that some CPUs use &quot;2&#39;s complement&quot;, some use &quot;1&#39;s compliment&quot;, some use &quot;sign and magnitude&quot;; and for all the cases overflow could cause anything (e.g. CPUs like MIPS have &quot;trap on overflow&quot;). In other words it&#39;s about portability and not optimisation."}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 1, "creation_date": 1557366654, "post_id": 56047702, "comment_id": 98743445, "body": "Exactly. The only &#39;meaningful statistic&#39; anybody needs is that ones-complement and sign-magnitude computers exist."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 1, "creation_date": 1557378995, "post_id": 56047702, "comment_id": 98746063, "body": "@user207421: Yes, that&#39;s a good question, to which the answer seems to be <i>no longer</i>. Hence the current proposal to remove support for non two&#39;s complement representations: <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n2330.pdf\" rel=\"nofollow noreferrer\">open-std.org/jtc1/sc22/wg14/www/docs/n2330.pdf</a>"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 25733, "user_id": 559737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5de249db6565b87a2699e131974268a?s=128&d=identicon&r=PG", "display_name": "Brendan", "link": "https://stackoverflow.com/users/559737/brendan"}, "edited": false, "score": 0, "creation_date": 1557379170, "post_id": 56047702, "comment_id": 98746107, "body": "@Brendan: ones&#39; complement architecture are a thing of the past. MIPS&#39; trap on overflow is selectable."}, {"owner": {"reputation": 25733, "user_id": 559737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5de249db6565b87a2699e131974268a?s=128&d=identicon&r=PG", "display_name": "Brendan", "link": "https://stackoverflow.com/users/559737/brendan"}, "edited": false, "score": 1, "creation_date": 1557434484, "post_id": 56047702, "comment_id": 98774308, "body": "@chqrlie: C is also a thing from the past (47 years old now). There&#39;s a lot of design decisions that made sense back then that don&#39;t make sense anymore but continue to exist because change would break too much existing software."}], "answers": [{"comments": [{"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 0, "creation_date": 1557732648, "post_id": 56048480, "comment_id": 98848806, "body": "Yes. Producing an incorrectly value is a serious issue, and a correct looking value is more problematic. In many cases there is no expectation on the result so any printed value might be taken seriously. That could even cause security vulnerabilities."}], "tags": [], "owner": {"reputation": 22818, "user_id": 509868, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/83450238b4ee0eddbf54d7ce5a3a64e4?s=128&d=identicon&r=PG", "display_name": "anatolyg", "link": "https://stackoverflow.com/users/509868/anatolyg"}, "is_accepted": false, "score": 7, "last_activity_date": 1557346806, "creation_date": 1557346806, "answer_id": 56048480, "question_id": 56047702, "link": "https://stackoverflow.com/questions/56047702/is-there-some-meaningful-statistical-data-to-justify-keeping-signed-integer-arit/56048480#56048480", "title": "Is there some meaningful statistical data to justify keeping signed integer arithmetic overflow undefined?", "body": "<p>Not quite an example of optimization, but one useful consequence of undefined behaviour is <code>-ftrapv</code> command line switch of GCC/clang. It inserts code which crashes your program on integer overflow.</p>\n\n<p>It won't work on unsigned integers, in accordance with the idea that unsigned overflow is intentional.</p>\n\n<p>The Standard's wording on signed integer overflow ensures that people won't write overflowing code on purpose, so <code>ftrapv</code> is a useful tool to discover unintentional overflow.</p>\n"}, {"comments": [{"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1557379487, "post_id": 56050559, "comment_id": 98746199, "body": "Your 2&#39;s complement specific way has different semantics: it will return <code>INT_MAX</code> for negative values of <code>a</code> less than <code>-b</code>."}, {"owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "reply_to_user": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1557381825, "post_id": 56050559, "comment_id": 98747014, "body": "@chqrlie I must have misunderstood the function&#39;s requirements. I assumed as we were clamping to positive numbers that in input would guaranteed to be positive."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1557382125, "post_id": 56050559, "comment_id": 98747124, "body": "The silly example function only tests for positive overflow because <code>b</code> is intrinsically positive, but <code>a</code> can have a negative value. It is just an example, and your <code>sum_max</code> version is a correct way to achieve the goal in a portable manner, but I have seen legacy code use the test I posted, which was never correct but <i>just worked</i> until about 10 years ago."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1557382229, "post_id": 56050559, "comment_id": 98747177, "body": "As a side note, C++ just recently removed the alternative representations of signed integers. two&#39;s complement is now the only supported one."}, {"owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "reply_to_user": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 3, "creation_date": 1557382834, "post_id": 56050559, "comment_id": 98747408, "body": "@chqrlie That is true as of c++20, but I didn&#39;t mention it because overflowing signed integers remains UB for all the previously mentioned reasons around optimisation. I didn&#39;t want to give the wrong impression that the legacy code will become OK. It won&#39;t."}], "tags": [], "owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "is_accepted": false, "score": 2, "last_activity_date": 1557360932, "creation_date": 1557360932, "answer_id": 56050559, "question_id": 56047702, "link": "https://stackoverflow.com/questions/56047702/is-there-some-meaningful-statistical-data-to-justify-keeping-signed-integer-arit/56050559#56050559", "title": "Is there some meaningful statistical data to justify keeping signed integer arithmetic overflow undefined?", "body": "<p>The answer is actually in your question:</p>\n\n<blockquote>\n  <p>Yet most CPUs implement signed arithmetics with defined semantics</p>\n</blockquote>\n\n<p>I can't think of a CPU that you can buy today that does not use twos-compliment arithmetic for signed integers, but that wasn't always the case.</p>\n\n<p>The C language was invented in 1972. Back then, IBM 7090 mainframes still existed. Not all computers were twos-compliment.</p>\n\n<p>To have defined the language (and overflow behaviour) around 2s-compliment would have been prejudicial to code generation on machines that weren't.</p>\n\n<p>Furthermore, as it has already been said, specifying that signed overflow is to be UB allows the compiler to produce better code, because it can discount code paths that result from signed overflow, assuming that this will never happen.</p>\n\n<p>If I understand correctly that it's intended to clamp the sum of a and b to 0....INT_MAX without wraparound, I can think of two ways to write this function in a compliant way.</p>\n\n<p>First, the inefficient general case that will work on all cpus:</p>\n\n<pre><code>int sum_max(int a, unsigned char b) {\n    if (a &gt; std::numeric_limits&lt;int&gt;::max() - b)\n        return std::numeric_limits&lt;int&gt;::max();\n    else\n        return a + b;\n}\n</code></pre>\n\n<p>Second, the surprisingly efficient 2s-compliment specific way:</p>\n\n<pre><code>int sum_max2(int a, unsigned char b) {\n    unsigned int buffer;\n    std::memcpy(&amp;buffer, &amp;a, sizeof(a));\n    buffer += b;\n    if (buffer &gt; std::numeric_limits&lt;int&gt;::max())\n        buffer = std::numeric_limits&lt;int&gt;::max();\n    std::memcpy(&amp;a, &amp;buffer, sizeof(a));\n    return a;\n}\n</code></pre>\n\n<p>Resulting assembler can be seen here: <a href=\"https://godbolt.org/z/F42IXV\" rel=\"nofollow noreferrer\">https://godbolt.org/z/F42IXV</a></p>\n"}, {"comments": [{"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1557369213, "post_id": 56051070, "comment_id": 98743940, "body": "&quot;x + 10 &gt; x holds true now&quot; - no it doesn&#39;t. It could format your hard disk if x happens to equal INT_MAX-5."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 1, "creation_date": 1557381055, "post_id": 56051070, "comment_id": 98746718, "body": "Very informative answer (the blog is a good read indeed). Since all these optimisations are only possible for signed operands, the conclusion is counter-intuitive: using <code>size_t</code> index values for many computations should lead to less efficient code because of modulo arithmetics semantics. This is a good argument to include <code>ssize_t</code> in the C Standard, or some unsigned type without modulo arithmetics."}, {"owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "edited": false, "score": 0, "creation_date": 1557382723, "post_id": 56051070, "comment_id": 98747365, "body": "fascinating. nice find."}, {"owner": {"reputation": 57967, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "reply_to_user": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 4, "creation_date": 1557394895, "post_id": 56051070, "comment_id": 98753718, "body": "@immibis I meant it holds true for all valid code. UB is not valid code."}, {"owner": {"reputation": 57967, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "reply_to_user": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 1, "creation_date": 1557395154, "post_id": 56051070, "comment_id": 98753870, "body": "@chqrlie I&#39;ve heard on cppcon prominent members of the standard committee acknowledging that unsigned size was a mistake in hindsight. The same thing about the wraparound behavior of unsigned (I would have been better for normal types to have UB on overflow and to have separate types with wraparound behavior for when you explicitly need that)"}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1557438392, "post_id": 56051070, "comment_id": 98775746, "body": "@bolov The compiler is allowed to assume it&#39;s true, but it&#39;s not required to, so you can&#39;t."}, {"owner": {"reputation": 57967, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "reply_to_user": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 1, "creation_date": 1557442125, "post_id": 56051070, "comment_id": 98776675, "body": "@immibis no, it is required by the standard. Just like it is required by the standard to assume a pointer that is dereferenced is not null."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1557444662, "post_id": 56051070, "comment_id": 98777164, "body": "@bolov Really? The compiler is <i>required</i> to assume that <code>i + 10 &gt; i</code> is true? So <code>int i = INT_MAX; if(i + 10 &gt; i) printf(&quot;hello!\\n&quot;);</code> is <i>required</i> to print &quot;hello!\\n&quot; and is not allowed to format my hard disk?"}, {"owner": {"reputation": 57967, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "reply_to_user": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 1, "creation_date": 1557446854, "post_id": 56051070, "comment_id": 98777623, "body": "@immibis you are not getting it. Yes!! the compiler is required to assume that <code>i + 10 &gt; i</code> so it will generate code that is valid only when <code>i &lt; INT_MAX  - 10</code>. For then <code>i &gt;= INT_MAX</code> the code is not valid, the standard does not mandate any behavior, and the compiler can generate code making the assumption <code>i &lt; INT_MAX</code>. For invalid code - undefined behavior anything can happen because the compiler isn&#39;t required to generate any kind of behavior."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1557447075, "post_id": 56051070, "comment_id": 98777659, "body": "@bolov It is also allowed to generate code where <code>i + 10 &gt; i</code> evaluates to false in this case."}, {"owner": {"reputation": 57967, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "reply_to_user": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1557447158, "post_id": 56051070, "comment_id": 98777681, "body": "@immibis honestly it&#39;s like talking to a wall"}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1557447218, "post_id": 56051070, "comment_id": 98777693, "body": "I know right? &quot;With UB you get C/C++ signed integers to behave arithmetically as you would expect mathematically.&quot; is pretty clearly defining UB."}, {"owner": {"reputation": 57967, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "reply_to_user": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 2, "creation_date": 1557447977, "post_id": 56051070, "comment_id": 98777823, "body": "@immibis do you see how the compiler transforms <code>x + 10 &gt;= x;</code> into <code>mov     eax, 1</code>? That&#39;s precisely because it can assume <code>x + 10 &gt;= x</code> will always be true (and I say it again for the last time: <b>for valid code</b>)"}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 1, "creation_date": 1557448279, "post_id": 56051070, "comment_id": 98777884, "body": "The compiler can assume that. The programmer can&#39;t."}, {"owner": {"reputation": 57967, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "reply_to_user": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1557448585, "post_id": 56051070, "comment_id": 98777941, "body": "@immibis ... are you trolling? 1st: when were we talking about the programmer? All the discussion, the entire post and comments are about what the compiler can assume (and what can optimize in consequence). 2nd also the programmer can assume that on valid code <code>x + 10 &gt;= x</code>. ........."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1557448854, "post_id": 56051070, "comment_id": 98777980, "body": "@bolov The programmer has to know whether <code>x + 10 &gt;= x</code> would be true on a compiler that had defined overflow behaviour, in order to know whether the code is valid. They can&#39;t reason &quot;this code is valid therefore I know <code>x &lt;= INT_MAX+10</code>&quot;. They have to reason &quot;<code>x &lt;= INT_MAX+10</code> because of something else, therefore this code is valid.&quot;"}, {"owner": {"reputation": 57967, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "reply_to_user": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 2, "creation_date": 1557449204, "post_id": 56051070, "comment_id": 98778036, "body": "@immibis you are doing this on purpose at this point. You are moving the discussion away from the original problem. My statement is &quot;the compiler will assume that, for valid code, <code>x + 10 &gt;= x</code> will always be true - this is mandated by the standard - so the compiler can optimize the expression to <code>true</code>&quot;. That was always my statement. That&#39;s what I am debating (and what you contested initially). You want to talk now about how the programmer must make sure he doesn&#39;t write code that has UB and therefore is invalid, that&#39;s another discussion."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 1, "creation_date": 1557450114, "post_id": 56051070, "comment_id": 98778184, "body": "You did not say &quot;the compiler will assume that ...&quot; - you simply said &quot;...&quot; which is a statement of fact, not a statement of an assumption that if not true will break things."}, {"owner": {"reputation": 57967, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "edited": false, "score": 0, "creation_date": 1557450894, "post_id": 56051070, "comment_id": 98778302, "body": "I think I finally see your point. Yes, I did not say &quot;the compiler&quot; and initially didn&#39;t say &quot;for valid code&quot;. I thought however that it is understood, as we are talking exclusively about what the compiler can do with given code. It looks to me now that you took &quot;x + 1 &gt;= 1 will always be true&quot; as a statement meaning &quot;whenever you see <code>x + 1 &gt;= 1</code> in a C code you, the programmer, can rest assure that it will always be true&quot;. That was never my intention and I think that from the context of the post is clear what I am talking about. I apologise from assuming malicious intent."}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 0, "creation_date": 1557586443, "post_id": 56051070, "comment_id": 98819209, "body": "&quot;Trolling&quot; and talking past each others are often horribly like the other."}], "tags": [], "owner": {"reputation": 57967, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "is_accepted": true, "score": 22, "last_activity_date": 1607158354, "last_edit_date": 1607158354, "creation_date": 1557366059, "answer_id": 56051070, "question_id": 56047702, "link": "https://stackoverflow.com/questions/56047702/is-there-some-meaningful-statistical-data-to-justify-keeping-signed-integer-arit/56051070#56051070", "title": "Is there some meaningful statistical data to justify keeping signed integer arithmetic overflow undefined?", "body": "<p>I don't know about studies and statistics, but yes, there are definitely optimizations taking this into account that compilers actually do. And yes, they are very important (tldr loop vectorization for example).</p>\n<p>Besides the compiler optimizations, there is another aspect to be taken into account. With UB you get C/C++ signed integers to behave arithmetically as you would expect mathematically. For instance <code>x + 10 &gt; x</code> holds true now (for valid code of course), but would not on a wrap-around behavior.</p>\n<p>I've found an excellent article <a href=\"https://kristerw.blogspot.com/2016/02/how-undefined-signed-overflow-enables.html\" rel=\"nofollow noreferrer\">How undefined signed overflow enables optimizations in GCC</a> from Krister Walfridsson\u2019s blog listing some optimizations that take signed overflow UB into account. The following examples are from it. I am adding c++ and assembly examples to them.</p>\n<p>If the optimizations look too simple, uninteresting or unimpactful, remember that these optimization are just steps in a much much larger chain of optimizations. And the butterfly effect does happen as a seemingly unimportant optimization at an earlier step can trigger a much more impactful optimization at a later step.</p>\n<p>If the examples look nonsensical (who would write <code>x * 10 &gt; 0</code>) keep in mind that you can very easily get to this kind of examples in C and C++ with constants, macros, templates. Besides the compiler can get to this kind of examples when applying transformations and optimizations in its IR.</p>\n<h1>Signed integer expression simplification</h1>\n<ul>\n<li><p>Eliminate multiplication in comparison with 0</p>\n<blockquote>\n<pre><code>(x * c) cmp 0   -&gt;   x cmp 0 \n</code></pre>\n</blockquote>\n<pre><code>bool foo(int x) { return x * 10 &gt; 0 }\n</code></pre>\n<pre><code>foo(int):\n        test    edi, edi\n        setg    al\n        ret\n</code></pre>\n</li>\n<li><p>Eliminate division after multiplication</p>\n<blockquote>\n<p>(x * c1) / c2   -&gt;   x * (c1 / c2) if c1 is divisible by c2</p>\n</blockquote>\n<pre><code>int foo(int x) { return (x * 20) / 10; }\n</code></pre>\n<pre><code>foo(int):\n        lea     eax, [rdi+rdi]\n        ret\n</code></pre>\n</li>\n</ul>\n<ul>\n<li><p>Eliminate negation</p>\n<blockquote>\n<p>(-x) / (-y)     -&gt;   x / y</p>\n</blockquote>\n<pre class=\"lang-cpp prettyprint-override\"><code>int foo(int x, int y) { return (-x) / (-y); }\n</code></pre>\n<pre><code>foo(int, int):\n        mov     eax, edi\n        cdq\n        idiv    esi\n        ret\n</code></pre>\n</li>\n</ul>\n<ul>\n<li><p>Simplify comparisons that are always true or false</p>\n<blockquote>\n<pre><code>x + c &lt; x       -&gt;   false\nx + c &lt;= x      -&gt;   false\nx + c &gt; x       -&gt;   true\nx + c &gt;= x      -&gt;   true\n</code></pre>\n</blockquote>\n<pre class=\"lang-cpp prettyprint-override\"><code>bool foo(int x) { return x + 10 &gt;= x; }\n</code></pre>\n<pre><code>foo(int):\n        mov     eax, 1\n        ret\n</code></pre>\n</li>\n<li><p>Eliminate negation in comparisons</p>\n<pre><code>(-x) cmp (-y)   -&gt;   y cmp x\n</code></pre>\n<pre class=\"lang-cpp prettyprint-override\"><code>bool foo(int x, int y) { return -x &lt; -y; }\n</code></pre>\n<pre><code>foo(int, int):\n        cmp     edi, esi\n        setg    al\n        ret\n</code></pre>\n</li>\n<li><p>Reduce magnitude of constants</p>\n<blockquote>\n<pre><code>x + c &gt; y       -&gt;   x + (c - 1) &gt;= y\nx + c &lt;= y      -&gt;   x + (c - 1) &lt; y\n</code></pre>\n</blockquote>\n<pre><code>bool foo(int x, int y) { return x + 10 &lt;= y; }\n</code></pre>\n<pre><code>foo(int, int):\n        add     edi, 9\n        cmp     edi, esi\n        setl    al\n        ret\n</code></pre>\n</li>\n</ul>\n<ul>\n<li><p>Eliminate constants in comparisons</p>\n<blockquote>\n<pre><code>(x + c1) cmp c2         -&gt;   x cmp (c2 - c1)\n(x + c1) cmp (y + c2)   -&gt;   x cmp (y + (c2 - c1)) if c1 &lt;= c2\n</code></pre>\n</blockquote>\n<blockquote>\n<p>The second transformation is only valid if c1 &lt;= c2, as it would\notherwise introduce an overflow when y has the value INT_MIN.</p>\n</blockquote>\n<pre class=\"lang-cpp prettyprint-override\"><code>bool foo(int x) { return x + 42 &lt;= 11; }\n</code></pre>\n<pre><code>foo(int):\n        cmp     edi, -30\n        setl    al\n        ret\n</code></pre>\n</li>\n</ul>\n<h1>Pointer arithmetic and type promotion</h1>\n<blockquote>\n<p>If an operation does not overflow, then we will get the same result if\nwe do the operation in a wider type. This is often useful when doing\nthings like array indexing on 64-bit architectures \u2014 the index\ncalculations are typically done using 32-bit int, but the pointers are\n64-bit, and the compiler may generate more efficient code when signed\noverflow is undefined by promoting the 32-bit integers to 64-bit\noperations instead of generating type extensions.</p>\n<p>One other aspect of this is that undefined overflow ensures that a[i]\nand a[i+1] are adjacent. This improves analysis of memory accesses for\nvectorization etc.</p>\n</blockquote>\n<p>This is a very important optimization as loop vectorization one of the most efficient and effective optimization algorithms.</p>\n<p>This is an example when changing an index from an unsigned index to a signed improves the generated assembly:</p>\n<h2>Unsigned version</h2>\n<pre><code>#include &lt;cstddef&gt;\n\nauto foo(int* v, std::size_t start)\n{\n    int sum = 0;\n\n    for (std::size_t i = start; i &lt; start + 4; ++i)\n        sum += v[i];\n\n    return sum;\n}\n</code></pre>\n<p>With unsigned the case where <code>start + 4</code> wraps around must be taken into account and a branch is generated to deal with this case (branches are bad for performance):</p>\n<pre class=\"lang-asm prettyprint-override\"><code>; gcc on x64 with -march=skylake\n\nfoo1(int*, unsigned long):\n        cmp     rsi, -5\n        ja      .L3\n        vmovdqu xmm0, XMMWORD PTR [rdi+rsi*4]\n        vpsrldq xmm1, xmm0, 8\n        vpaddd  xmm0, xmm0, xmm1\n        vpsrldq xmm1, xmm0, 4\n        vpaddd  xmm0, xmm0, xmm1\n        vmovd   eax, xmm0\n        ret\n.L3:\n        xor     eax, eax\n        ret\n</code></pre>\n<pre class=\"lang-asm prettyprint-override\"><code>; clang on x64 with -march=skylake\n\nfoo1(int*, unsigned long):                             # @foo1(int*, unsigned long)\n        xor     eax, eax\n        cmp     rsi, -4\n        jae     .LBB0_2\n        vpbroadcastq    xmm0, qword ptr [rdi + 4*rsi + 8]\n        vpaddd  xmm0, xmm0, xmmword ptr [rdi + 4*rsi]\n        vpshufd xmm1, xmm0, 85                  # xmm1 = xmm0[1,1,1,1]\n        vpaddd  xmm0, xmm0, xmm1\n        vmovd   eax, xmm0\n.LBB0_2:\n        ret\n</code></pre>\n<p>As a side note, using a narrower type would result in even worst assembly, inhibiting the use of SSE vectorized instructions:</p>\n<pre><code>#include &lt;cstddef&gt;\n\nauto foo(int* v, unsigned start)\n{\n    int sum = 0;\n\n    for (unsigned i = start; i &lt; start + 4; ++i)\n        sum += v[i];\n\n    return sum;\n}\n</code></pre>\n<pre class=\"lang-asm prettyprint-override\"><code>; gcc on x64 with -march=skylake\n\nfoo(int*, unsigned int):\n        cmp     esi, -5\n        ja      .L3\n        mov     eax, esi\n        mov     eax, DWORD PTR [rdi+rax*4]\n        lea     edx, [rsi+1]\n        add     eax, DWORD PTR [rdi+rdx*4]\n        lea     edx, [rsi+2]\n        add     eax, DWORD PTR [rdi+rdx*4]\n        lea     edx, [rsi+3]\n        add     eax, DWORD PTR [rdi+rdx*4]\n        ret\n.L3:\n        xor     eax, eax\n        ret\n</code></pre>\n<pre class=\"lang-asm prettyprint-override\"><code>; clang on x64 with -march=skylake\n\nfoo(int*, unsigned int):                              # @foo(int*, unsigned int)\n        xor     eax, eax\n        cmp     esi, -5\n        ja      .LBB0_3\n        mov     ecx, esi\n        add     esi, 4\n        mov     eax, dword ptr [rdi + 4*rcx]\n        lea     rdx, [rcx + 1]\n        cmp     rdx, rsi\n        jae     .LBB0_3\n        add     eax, dword ptr [rdi + 4*rcx + 4]\n        add     eax, dword ptr [rdi + 4*rcx + 8]\n        add     eax, dword ptr [rdi + 4*rcx + 12]\n.LBB0_3:\n        ret\n</code></pre>\n<h2>Signed version</h2>\n<p>Using a signed index however results in nice vectorized branchless code:</p>\n<pre><code>#include &lt;cstddef&gt;\n\nauto foo(int* v, std::ptrdiff_t start)\n{\n    int sum = 0;\n\n    for (std::ptrdiff_t i = start; i &lt; start + 4; ++i)\n        sum += v[i];\n\n    return sum;\n}\n</code></pre>\n<pre class=\"lang-asm prettyprint-override\"><code>; gcc on x64 with -march=skylake\n\nfoo(int*, long):\n        vmovdqu xmm0, XMMWORD PTR [rdi+rsi*4]\n        vpsrldq xmm1, xmm0, 8\n        vpaddd  xmm0, xmm0, xmm1\n        vpsrldq xmm1, xmm0, 4\n        vpaddd  xmm0, xmm0, xmm1\n        vmovd   eax, xmm0\n        ret\n</code></pre>\n<pre class=\"lang-asm prettyprint-override\"><code>; clang on x64 with -march=skylake\n\nfoo(int*, long):                              # @foo(int*, long)\n        vpbroadcastq    xmm0, qword ptr [rdi + 4*rsi + 8]\n        vpaddd  xmm0, xmm0, xmmword ptr [rdi + 4*rsi]\n        vpshufd xmm1, xmm0, 85                  # xmm1 = xmm0[1,1,1,1]\n        vpaddd  xmm0, xmm0, xmm1\n        vmovd   eax, xmm0\n        ret\n</code></pre>\n<p>Vectorized instruction are still used when using a narrower signed type:</p>\n<pre><code>#include &lt;cstddef&gt;\n\nauto foo(int* v, int start)\n{\n    int sum = 0;\n\n    for (int i = start; i &lt; start + 4; ++i)\n        sum += v[i];\n\n    return sum;\n}\n</code></pre>\n<pre class=\"lang-asm prettyprint-override\"><code>; gcc on x64 with -march=skylake\n\nfoo(int*, int):\n        movsx   rsi, esi\n        vmovdqu xmm0, XMMWORD PTR [rdi+rsi*4]\n        vpsrldq xmm1, xmm0, 8\n        vpaddd  xmm0, xmm0, xmm1\n        vpsrldq xmm1, xmm0, 4\n        vpaddd  xmm0, xmm0, xmm1\n        vmovd   eax, xmm0\n        ret\n</code></pre>\n<pre class=\"lang-asm prettyprint-override\"><code>; clang on x64 with -march=skylake\n\nfoo(int*, int):                              # @foo(int*, int)\n        movsxd  rax, esi\n        vpbroadcastq    xmm0, qword ptr [rdi + 4*rax + 8]\n        vpaddd  xmm0, xmm0, xmmword ptr [rdi + 4*rax]\n        vpshufd xmm1, xmm0, 85                  # xmm1 = xmm0[1,1,1,1]\n        vpaddd  xmm0, xmm0, xmm1\n        vmovd   eax, xmm0\n        ret\n</code></pre>\n<h1>Value range calculations</h1>\n<blockquote>\n<p>The compiler keeps track of the variables' range of possible values at\neach point in the program, i.e. for code such as</p>\n<pre><code>int x = foo();\nif (x &gt; 0) {\n  int y = x + 5;\n  int z = y / 4;\n</code></pre>\n<p>it determines that x has the range <code>[1, INT_MAX]</code> after the\nif-statement, and can thus determine that y has the range <code>[6, INT_MAX]</code> as overflow is not allowed. And the next line can be\noptimized to <code>int z = y &gt;&gt; 2;</code> as the compiler knows that y is\nnon-negative.</p>\n</blockquote>\n<pre><code>auto foo(int x)\n{\n    if (x &lt;= 0)\n        __builtin_unreachable();\n    \n    return (x + 5) / 4;\n}\n</code></pre>\n<pre><code>foo(int):\n        lea     eax, [rdi+5]\n        sar     eax, 2\n        ret\n</code></pre>\n<blockquote>\n<p>The undefined overflow helps optimizations that need to compare two\nvalues (as the wrapping case would give possible values of the form\n<code>[INT_MIN, (INT_MIN+4)]</code> or <code>[6, INT_MAX]</code> that prevents all useful\ncomparisons with <code>&lt;</code> or <code>&gt;</code>), such as</p>\n<ul>\n<li>Changing comparisons <code>x&lt;y</code> to true or false if the ranges for <code>x</code> and <code>y</code> does not overlap</li>\n<li>Changing <code>min(x,y)</code> or <code>max(x,y)</code> to <code>x</code> or <code>y</code> if the ranges do not overlap</li>\n<li>Changing <code>abs(x)</code> to <code>x</code> or <code>-x</code> if the range does not cross <code>0</code></li>\n<li>Changing <code>x/c</code> to <code>x&gt;&gt;log2(c)</code> if <code>x&gt;0</code> and the constant <code>c</code> is a power of <code>2</code></li>\n<li>Changing <code>x%c</code> to <code>x&amp;(c-1)</code> if <code>x&gt;0</code> and the constant <code>c</code> is a power of <code>2</code></li>\n</ul>\n</blockquote>\n<h1>Loop analysis and optimization</h1>\n<blockquote>\n<p>The canonical example of why undefined signed overflow helps loop\noptimizations is that loops like</p>\n<pre><code>for (int i = 0; i &lt;= m; i++)\n</code></pre>\n<p>are guaranteed to terminate for undefined overflow. This helps\narchitectures that have specific loop instructions, as they do in\ngeneral not handle infinite loops.</p>\n<p>But undefined signed overflow helps many more loop optimizations. All\nanalysis such as determining number of iteration, transforming\ninduction variables, and keeping track of memory accesses are using\neverything in the previous sections in order to do its work. In\nparticular, <strong>the set of loops that can be vectorized are severely\nreduced when signed overflow is allowed</strong>.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 26077, "user_id": 8157187, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9dbf5a2e56640eeb14bbe0c32fb3679b?s=128&d=identicon&r=PG&f=1", "display_name": "geza", "link": "https://stackoverflow.com/users/8157187/geza"}, "is_accepted": false, "score": 5, "last_activity_date": 1557423090, "creation_date": 1557423090, "answer_id": 56064692, "question_id": 56047702, "link": "https://stackoverflow.com/questions/56047702/is-there-some-meaningful-statistical-data-to-justify-keeping-signed-integer-arit/56064692#56064692", "title": "Is there some meaningful statistical data to justify keeping signed integer arithmetic overflow undefined?", "body": "<p>Here's an actual little benchmark, bubble sort. I've compared timings without/with <code>-fwrapv</code> (which means the overflow is UB/not UB). Here are the results (seconds):</p>\n\n<pre><code>                   -O3     -O3 -fwrapv    -O1     -O1 -fwrapv\nMachine1, clang    5.2     6.3            6.8     7.7\nMachine2, clang-8  4.2     7.8            6.4     6.7\nMachine2, gcc-8    6.6     7.4            6.5     6.5\n</code></pre>\n\n<p>As you can see, the not-UB (<code>-fwrapv</code>) version is almost always slower, the largest difference is pretty big, 1.85x.</p>\n\n<p>Here's the code. Note, that I intentionally chose an implementation, which should produce a larger difference for this test.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nvoid bubbleSort(int *a, long n) {\n        bool swapped;\n        for (int i = 0; i &lt; n-1; i++) {\n                swapped = false;\n                for (int j = 0; j &lt; n-i-1; j++) {\n                        if (a[j] &gt; a[j+1]) {\n                                int t = a[j];\n                                a[j] = a[j+1];\n                                a[j+1] = t;\n                                swapped = true;\n                        }\n                }\n\n                if (!swapped) break;\n        }\n}\n\nint main() {\n        int a[8192];\n\n        for (int j=0; j&lt;100; j++) {\n                for (int i=0; i&lt;8192; i++) {\n                        a[i] = rand();\n                }\n\n                bubbleSort(a, 8192);\n        }\n}\n</code></pre>\n"}], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 868, "favorite_count": 6, "accepted_answer_id": 56051070, "answer_count": 4, "score": 37, "last_activity_date": 1607158354, "creation_date": 1557343350, "last_edit_date": 1557343879, "question_id": 56047702, "link": "https://stackoverflow.com/questions/56047702/is-there-some-meaningful-statistical-data-to-justify-keeping-signed-integer-arit", "title": "Is there some meaningful statistical data to justify keeping signed integer arithmetic overflow undefined?", "body": "<p>The C Standard explicitly specifies signed integer overflow as having <strong>undefined behavior</strong>. Yet most CPUs implement signed arithmetics with defined semantics for overflow (except maybe for division overflow: <code>x / 0</code> and <code>INT_MIN / -1</code>).</p>\n\n<p>Compilers writers have been taking advantage of the <em>undefinedness</em> of such overflows to add more aggressive optimisations that tend to break legacy code in very subtle ways. For example this code may have worked on older compilers but does not anymore on current versions of <code>gcc</code> and <code>clang</code>:</p>\n\n<pre><code>/* Tncrement a by a value in 0..255, clamp a to positive integers.\n   The code relies on 32-bit wrap-around, but the C Standard makes\n   signed integer overflow undefined behavior, so sum_max can now \n   return values less than a. There are Standard compliant ways to\n   implement this, but legacy code is what it is... */\nint sum_max(int a, unsigned char b) {\n    int res = a + b;\n    return (res &gt;= a) ? res : INT_MAX;\n}\n</code></pre>\n\n<p>Is there hard evidence that these optimisations are worthwhile? Are there comparative studies documenting the actual improvements on real life examples or even on classical benchmarks?</p>\n\n<p>I came up with this question as I was watching this: <a href=\"https://www.youtube.com/watch?v=AeEwxtEOgH0\" rel=\"noreferrer\">C++Now 2018: John Regehr \u201cClosing Keynote: Undefined Behavior and Compiler Optimizations\u201d</a></p>\n\n<p>I am tagging <strong>c</strong> and <strong>c++</strong> as the problem is similar in both languages but the answers might be different.</p>\n"}, {"tags": ["c", "file", "structure"], "comments": [{"owner": {"reputation": 5109, "user_id": 213489, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/39d7766c4d7d117128fa47487cf30a72?s=128&d=identicon&r=PG&f=1", "display_name": "Nathan S.", "link": "https://stackoverflow.com/users/213489/nathan-s"}, "edited": false, "score": 1, "creation_date": 1557342079, "post_id": 56047356, "comment_id": 98736430, "body": "What have you tried? Have you tried a minimal example without the loops to get the necessary functionality? Have you tried <code>fscanf</code>?"}, {"owner": {"reputation": 26583, "user_id": 1441, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fb7f1cd450084fdb4bfc9376c7dba2a7?s=128&d=identicon&r=PG", "display_name": "crashmstr", "link": "https://stackoverflow.com/users/1441/crashmstr"}, "edited": false, "score": 1, "creation_date": 1557342255, "post_id": 56047356, "comment_id": 98736508, "body": "You seem to be reading only one line and into an <code>x</code> (which is not shown). The only loop you show  loops over <code>classNum</code>, but the loop variant <code>i</code> is not used in the <code>for</code> block and the code would only print one record <code>classNum</code> times."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1557342430, "post_id": 56047356, "comment_id": 98736569, "body": "What is <code>x</code>? Please create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> to show us. Also please take some time to read <a href=\"http://stackoverflow.com/help\">the help pages</a>, take <a href=\"http://stackoverflow.com/tour\">the SO tour</a>, read about <a href=\"http://stackoverflow.com/help/how-to-ask\">how to ask good questions</a>, as well as <a href=\"https://codeblog.jonskeet.uk/2012/11/24/stack-overflow-question-checklist/\" rel=\"nofollow noreferrer\">this question checklist</a>."}, {"owner": {"reputation": 1, "user_id": 11301964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11f93ab29e38c78d2075c2a4073dd690?s=128&d=identicon&r=PG&f=1", "display_name": "Exciless", "link": "https://stackoverflow.com/users/11301964/exciless"}, "reply_to_user": {"reputation": 26583, "user_id": 1441, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fb7f1cd450084fdb4bfc9376c7dba2a7?s=128&d=identicon&r=PG", "display_name": "crashmstr", "link": "https://stackoverflow.com/users/1441/crashmstr"}, "edited": false, "score": 0, "creation_date": 1557342466, "post_id": 56047356, "comment_id": 98736581, "body": "@crashmstr What should I use and how do I replace the for loop?"}, {"owner": {"reputation": 1, "user_id": 11301964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11f93ab29e38c78d2075c2a4073dd690?s=128&d=identicon&r=PG&f=1", "display_name": "Exciless", "link": "https://stackoverflow.com/users/11301964/exciless"}, "reply_to_user": {"reputation": 5109, "user_id": 213489, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/39d7766c4d7d117128fa47487cf30a72?s=128&d=identicon&r=PG&f=1", "display_name": "Nathan S.", "link": "https://stackoverflow.com/users/213489/nathan-s"}, "edited": false, "score": 0, "creation_date": 1557342506, "post_id": 56047356, "comment_id": 98736599, "body": "@NathanS. Are you sure do you look to the my code ?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1557342518, "post_id": 56047356, "comment_id": 98736604, "body": "You might also want to do some <a href=\"https://en.wikipedia.org/wiki/Rubber_duck_debugging\" rel=\"nofollow noreferrer\">rubber duck debugging</a> on your reading program. What are you really doing in that loop?"}, {"owner": {"reputation": 1, "user_id": 11301964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11f93ab29e38c78d2075c2a4073dd690?s=128&d=identicon&r=PG&f=1", "display_name": "Exciless", "link": "https://stackoverflow.com/users/11301964/exciless"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1557342568, "post_id": 56047356, "comment_id": 98736624, "body": "@Someprogrammerdude x is struct student x;"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1557342677, "post_id": 56047356, "comment_id": 98736656, "body": "Then what is <code>struct student</code>? Again <b><i>please</i></b> create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> to show us."}, {"owner": {"reputation": 1, "user_id": 11301964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11f93ab29e38c78d2075c2a4073dd690?s=128&d=identicon&r=PG&f=1", "display_name": "Exciless", "link": "https://stackoverflow.com/users/11301964/exciless"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1557342900, "post_id": 56047356, "comment_id": 98736760, "body": "@Someprogrammerdude I edit my code."}, {"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 0, "creation_date": 1557343891, "post_id": 56047356, "comment_id": 98737236, "body": "Step 1: add code to check for errors, including checking return values of all <code>scanf</code> calls. Trying to debug issues with possibly uninitialized or otherwise invalid values is pointless."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1557369808, "post_id": 56047356, "comment_id": 98744058, "body": "Because you told the computer to print the same thing over and over..."}], "answers": [{"tags": [], "owner": {"reputation": 106, "user_id": 4409108, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HlfZM.jpg?s=128&g=1", "display_name": "rallen911", "link": "https://stackoverflow.com/users/4409108/rallen911"}, "is_accepted": false, "score": 0, "last_activity_date": 1557343635, "creation_date": 1557343635, "answer_id": 56047774, "question_id": 56047356, "link": "https://stackoverflow.com/questions/56047356/how-can-i-read-datas-from-txt-file-in-c/56047774#56047774", "title": "How can I read data&#39;s from .txt file in C?", "body": "<p>Here are the problems that I see upon first look:</p>\n\n<ol>\n<li><p>You only call fscanf() one time in the reading process.  If you want to read in data for multiple students, like it appears you're doing in the writing process, you need to call it once for each student to read that student's line from the file.</p></li>\n<li><p>In your reading/printing process, you are printing the same data x.classNum times.</p></li>\n</ol>\n"}], "owner": {"reputation": 1, "user_id": 11301964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11f93ab29e38c78d2075c2a4073dd690?s=128&d=identicon&r=PG&f=1", "display_name": "Exciless", "link": "https://stackoverflow.com/users/11301964/exciless"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 128, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1557343635, "creation_date": 1557341846, "last_edit_date": 1557342878, "question_id": 56047356, "link": "https://stackoverflow.com/questions/56047356/how-can-i-read-datas-from-txt-file-in-c", "title": "How can I read data&#39;s from .txt file in C?", "body": "<p>I want to read the information that I saved in txt file in the program I created. but when I want to do the reading process only the first line of student information by reading, for example, class 10 people are writing the same student information 10 times within the program. I'm doing the read operation in the for loop.</p>\n\n<pre><code>struct student{\n\nchar Name[30];\nchar Surname[30];\nint StudentNumber;\nint MathematicScore;\nint EnglishScore;\nint HistoryScore;\nint BiologyScore;\nint LiteratureScore;\nint PhysicsScore;\nint classNum;\nint total;\nfloat average;\n</code></pre>\n\n<p>};</p>\n\n<p>/* Printing process */</p>\n\n<pre><code>FILE *fout;\nfout = fopen(\"Mathematic Class.txt\",\"w\"); \n\nprintf(\"Please enter student number of class : \");\nscanf(\"%d\", &amp;x.classNum);\n\nfprintf(fout, \"Class Number : %d\\n\",x.classNum);\n\nfor(i=0; i&lt;x.classNum; i++){\n\n    printf(\"Please Enter %d.Student Name : \",i+1);\n    scanf(\"%s\",&amp;x.Name);\n\n    printf(\"Please Enter %d.Student Surname : \",i+1);\n    scanf(\"%s\",&amp;x.Surname);\n\n    printf(\"Please Enter %d.Student Number : \",i+1);\n    scanf(\"%d\",&amp;x.StudentNumber);\n\n    printf(\"Please Enter %d.Student Score : \",i+1);\n    scanf(\"%d\",&amp;x.MathematicScore);\n\n    x.total = x.total + x.MathematicScore;\n\n    fprintf(fout, \"\\nStudent Name : %s %s Student Number : %d Student Score : %d\\n\", x.Name, x.Surname, x.StudentNumber, x.MathematicScore);\n}   \n\nx.average = x.total / x.classNum;\n\nfprintf(fout, \"\\n\\nClass Average is : %f\", x.average);\n\nfclose(fout);\n\n\n\n/* Reading process */\n\n\n\n        FILE *fin;\n    fin = fopen(\"Mathematic Class.txt\",\"r\");\n\n\n    fscanf(fin, \"Class Number : %d\\n\\n%s %s %d %d\\n\",&amp;x.classNum, &amp;x.Name, &amp;x.Surname, &amp;x.StudentNumber, &amp;x.MathematicScore, &amp;x.average);\n    fclose(fin);            \n\n\n    printf(\"Class Number : %d\\n\", x.classNum);\n\n    for(i=0; i&lt;x.classNum; i++){\n\n        printf(\"Student Name : %s %s Student Number : %d Student Score : %d\\n\", x.Name, x.Surname, x.StudentNumber, x.MathematicScore); \n\n    }\n\n    printf(\"\\n\\nClass Average is : %f\", x.average);\n</code></pre>\n"}, {"tags": ["c", "arrays", "string", "memory"], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 8227264, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a672d92c875921b21b9d8e862c7f0212?s=128&d=identicon&r=PG&f=1", "display_name": "mmajdalani", "link": "https://stackoverflow.com/users/8227264/mmajdalani"}, "edited": false, "score": 0, "creation_date": 1557341682, "post_id": 56047267, "comment_id": 98736263, "body": "Okay, I\u2019ll check it out once I\u2019m back at my desk and send an update."}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1557342854, "post_id": 56047267, "comment_id": 98736736, "body": "<i>I don&#39;t know about any interface of the sprintf function that would allow ...</i> \u2013 I do ;p"}, {"owner": {"reputation": 27, "user_id": 8227264, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a672d92c875921b21b9d8e862c7f0212?s=128&d=identicon&r=PG&f=1", "display_name": "mmajdalani", "link": "https://stackoverflow.com/users/8227264/mmajdalani"}, "edited": false, "score": 0, "creation_date": 1557343543, "post_id": 56047267, "comment_id": 98737071, "body": "This kind of works, I&#39;m getting some random values at the end of the strings though. Output:  0xxxxxxxxxxxxx00, 000000xxxx0000008G, 00000xxxxxx00000PG"}, {"owner": {"reputation": 314, "user_id": 11416840, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Hznq9S4EUTk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfCK_I2VdTFc4lGwGCqD9ygP7ezsg/mo/photo.jpg?sz=128", "display_name": "Omri Sarig", "link": "https://stackoverflow.com/users/11416840/omri-sarig"}, "edited": false, "score": 0, "creation_date": 1557343935, "post_id": 56047267, "comment_id": 98737256, "body": "I can&#39;t reproduce it. Are you runnig my main function or your code? It seems that something is running over the NULL terminator at the end (it would happen if the length you gave the string is 16 and not 17, for example)."}, {"owner": {"reputation": 27, "user_id": 8227264, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a672d92c875921b21b9d8e862c7f0212?s=128&d=identicon&r=PG&f=1", "display_name": "mmajdalani", "link": "https://stackoverflow.com/users/8227264/mmajdalani"}, "edited": false, "score": 0, "creation_date": 1557344311, "post_id": 56047267, "comment_id": 98737392, "body": "Let me try again with 17"}, {"owner": {"reputation": 27, "user_id": 8227264, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a672d92c875921b21b9d8e862c7f0212?s=128&d=identicon&r=PG&f=1", "display_name": "mmajdalani", "link": "https://stackoverflow.com/users/8227264/mmajdalani"}, "edited": false, "score": 0, "creation_date": 1557344592, "post_id": 56047267, "comment_id": 98737512, "body": "17 makes it worse, index 1 overwrites index 3,4,5 and adds random characters"}, {"owner": {"reputation": 27, "user_id": 8227264, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a672d92c875921b21b9d8e862c7f0212?s=128&d=identicon&r=PG&f=1", "display_name": "mmajdalani", "link": "https://stackoverflow.com/users/8227264/mmajdalani"}, "edited": false, "score": 0, "creation_date": 1557345063, "post_id": 56047267, "comment_id": 98737720, "body": "My code, it seems as if the strings coming from PQGetValue are not acting as regular strings. Here is a description of what PQGetvalue returns: &quot;For data in text format, the value returned by PQgetvalue is a null-terminated character string representation of the field value.&quot;"}, {"owner": {"reputation": 314, "user_id": 11416840, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Hznq9S4EUTk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfCK_I2VdTFc4lGwGCqD9ygP7ezsg/mo/photo.jpg?sz=128", "display_name": "Omri Sarig", "link": "https://stackoverflow.com/users/11416840/omri-sarig"}, "edited": false, "score": 0, "creation_date": 1557345414, "post_id": 56047267, "comment_id": 98737846, "body": "I think you should change your code to work as my last example, since it seems to be a problem connected to the return value of PQGetValue and not the centralazing code. If you can reproduce the problem in the main function, that it is connected to the centralization code, but if not, it is a problem more connected to the intreface you are using (and PQGetValue) function, and I currently don&#39;t have enough data (from your question) to solve this problem."}], "tags": [], "owner": {"reputation": 314, "user_id": 11416840, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Hznq9S4EUTk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfCK_I2VdTFc4lGwGCqD9ygP7ezsg/mo/photo.jpg?sz=128", "display_name": "Omri Sarig", "link": "https://stackoverflow.com/users/11416840/omri-sarig"}, "is_accepted": false, "score": 0, "last_activity_date": 1557345274, "last_edit_date": 1557345274, "creation_date": 1557341483, "answer_id": 56047267, "question_id": 56047009, "link": "https://stackoverflow.com/questions/56047009/how-to-dynamically-center-align-text-in-a-char-string-to-fit-in-a-total-of-16/56047267#56047267", "title": "How to dynamically center align text in a char * string to fit in a total of 16 spaces in C?", "body": "<p>You can do it in another way (without using the sprintf function).\nI don't know about any interface of the sprintf function that would allow you to do it, but you can solve the problem using simple strcpy of variables.</p>\n\n<p>This is a main program that would solve your problem, it is documented in itself, so you should be able to understand how to apply this to your code:</p>\n\n<pre><code>\n#include &lt;stdio.h&gt;                                                                                                                                                                             \n#include &lt;string.h&gt;                                                                                                                                                                            \n\n/* This simple program would transfer the original string that is in the                                                                                                                       \n * out_value to be centralized in this variable. */                                                                                                                                            \nint main(void) {                                                                                                                                                                               \n    char out_value[17] = \"1234567891\";                                                                                                                                                         \n    char temp[20] = {0};                                                                                                                                                                       \n    int first_index = 0;                                                                                                                                                                       \n    int string_length = 0;                                                                                                                                                                     \n\n    /* Copy the string to the temp variable, to modify the chars in                                                                                                                            \n     * out_value. */                                                                                                                                                                           \n    strcpy(temp, out_value);                                                                                                                                                                   \n\n    /* Find out the index for the first char to be placed in the centralized                                                                                                                   \n     * string. */                                                                                                                                                                              \n    string_length = strlen(temp);                                                                                                                                                              \n    first_index = (16 - string_length) / 2;                                                                                                                                                    \n\n    /* Set all the values of the out_value to be the wanted value of space (here                                                                                                               \n     * it is 0 for visualizing, it can be space to not be present). */                                                                                                                         \n    memset(out_value, '0', 16);                                                                                                                                                                \n\n    /* Copy the original string back, moving the start of it, so it would be                                                                                                                   \n     * centralized. */                                                                                                                                                                         \n    strncpy(&amp;(out_value[first_index]), temp, string_length);                                                                                                                                   \n\n    /* Print the string. */                                                                                                                                                                    \n    printf(\"%s\", out_value);                                                                                                                                                                   \n}         \n</code></pre>\n\n<p>When modifying your code to work with this, the code would look something like this:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>char * systemInfoValues[5] = {NULL}                                                                                                                                                            \nfor(int i=0; i&lt; 5; i++){                                                                                                                                                                       \n     systemInfoValues[i] = PQgetvalue(res,i,0); //get the value from db;                                                                                                                       \n     int len = strlen(systemInfoValues[i]);                                                                                                                                                    \n     char tmp[20];                                                                                                                                                                             \n     int first_index = 0;                                                                                                                                                                      \n\n     strcpy(tmp, systemInfoValues[i]);                                                                                                                                                         \n     first_index = (16 - len) / 2;                                                                                                                                                             \n\n     memset(systemInfoValues[i], ' ', 16);                                                                                                                                                               \n     strncpy(&amp;(systemInfoValues[i][first_index]), tmp, len);                                                                                                                                   \n}     \n</code></pre>\n\n<hr>\n\n<p>Note that I changed the initializing of the value of systemInfoValues. When you initialized it, you put empty strings there. Note that this is a bad habit. Putting empty strings there (or strings with a single space) would allocate the memory for this string (which you will never use).</p>\n\n<p>You didn't include the definition to the function of PQgetvalue, but assuming that it would return a char pointer, this should work.\nBut, this code would change the global value as well. If you don't want to change it, you shoudn't put the result there, but copy the result to the string before doing any changes to it.\nAfter modifying the code, it should look like this:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>char systemInfoValues[5][17] = {{0}}                                                                                                                                                           \nfor(int i=0; i&lt; 5; i++){                                                                                                                                                                       \n     char *global_reference = PQgetvalue(res,i,0); //get the value from db;                                                                                                                    \n     int len = strlen(systemInfoValues[i]);                                                                                                                                                    \n     char tmp[20];                                                                                                                                                                             \n     int first_index = 0;                                                                                                                                                                      \n\n     strcpy(tmp, global_reference);                                                                                                                                                            \n     first_index = (16 - len) / 2;                                                                                                                                                             \n\n     memset(systemInfoValues[i], ' ', 16);                                                                                                                                                               \n     strncpy(&amp;(systemInfoValues[i][first_index]), tmp, len);                                                                                                                                   \n}        \n</code></pre>\n\n<p><strong>edit:</strong> apperently there is an interface for the sprintf function to work (as you originally wanted). To see it, refer to the answer of <strong>Swordfish</strong></p>\n"}, {"comments": [{"owner": {"reputation": 27, "user_id": 8227264, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a672d92c875921b21b9d8e862c7f0212?s=128&d=identicon&r=PG&f=1", "display_name": "mmajdalani", "link": "https://stackoverflow.com/users/8227264/mmajdalani"}, "edited": false, "score": 0, "creation_date": 1557343730, "post_id": 56047299, "comment_id": 98737165, "body": "What is the symmetry option?"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 27, "user_id": 8227264, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a672d92c875921b21b9d8e862c7f0212?s=128&d=identicon&r=PG&f=1", "display_name": "mmajdalani", "link": "https://stackoverflow.com/users/8227264/mmajdalani"}, "edited": false, "score": 0, "creation_date": 1557343826, "post_id": 56047299, "comment_id": 98737202, "body": "if not even you can have this one additional space on the right or left"}, {"owner": {"reputation": 27, "user_id": 8227264, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a672d92c875921b21b9d8e862c7f0212?s=128&d=identicon&r=PG&f=1", "display_name": "mmajdalani", "link": "https://stackoverflow.com/users/8227264/mmajdalani"}, "edited": false, "score": 0, "creation_date": 1557343895, "post_id": 56047299, "comment_id": 98737237, "body": "Okay, buff here is the database value, and str is a temp? or other way around?"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 27, "user_id": 8227264, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a672d92c875921b21b9d8e862c7f0212?s=128&d=identicon&r=PG&f=1", "display_name": "mmajdalani", "link": "https://stackoverflow.com/users/8227264/mmajdalani"}, "edited": false, "score": 0, "creation_date": 1557344074, "post_id": 56047299, "comment_id": 98737303, "body": "it does not matter"}, {"owner": {"reputation": 27, "user_id": 8227264, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a672d92c875921b21b9d8e862c7f0212?s=128&d=identicon&r=PG&f=1", "display_name": "mmajdalani", "link": "https://stackoverflow.com/users/8227264/mmajdalani"}, "edited": false, "score": 0, "creation_date": 1557344229, "post_id": 56047299, "comment_id": 98737357, "body": "``` char tmp[20]; memset(tmp, &#39; &#39;,len); tmp[len] = 0; memmove(tmp+pos,systemInfoValues[i],strl); strcpy(systemInfoValues[i],tmp); ``` Results in seg fault"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 27, "user_id": 8227264, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a672d92c875921b21b9d8e862c7f0212?s=128&d=identicon&r=PG&f=1", "display_name": "mmajdalani", "link": "https://stackoverflow.com/users/8227264/mmajdalani"}, "edited": false, "score": 0, "creation_date": 1557344491, "post_id": 56047299, "comment_id": 98737470, "body": "use function as given."}, {"owner": {"reputation": 27, "user_id": 8227264, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a672d92c875921b21b9d8e862c7f0212?s=128&d=identicon&r=PG&f=1", "display_name": "mmajdalani", "link": "https://stackoverflow.com/users/8227264/mmajdalani"}, "edited": false, "score": 0, "creation_date": 1557344922, "post_id": 56047299, "comment_id": 98737656, "body": "Function works with &quot;1234567&quot; but not with my strings. Here is a description of what is returned from PQGetValue: &quot;For data in text format, the value returned by PQgetvalue is a null-terminated character string representation of the field value.&quot;"}], "tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": true, "score": 3, "last_activity_date": 1557349617, "last_edit_date": 1557349617, "creation_date": 1557341620, "answer_id": 56047299, "question_id": 56047009, "link": "https://stackoverflow.com/questions/56047009/how-to-dynamically-center-align-text-in-a-char-string-to-fit-in-a-total-of-16/56047299#56047299", "title": "How to dynamically center align text in a char * string to fit in a total of 16 spaces in C?", "body": "<p>It is simple 6 line function. symetry is giving you the option </p>\n\n<pre><code>char *centerinstring(char *buff, size_t len, const char *str, int symetry)\n{\n    size_t strl = strlen(str);\n    size_t pos = (len - strl) / 2 + (strl &amp; 1) * !!symetry;\n\n    memset(buff,' ', len);\n    buff[len] = 0;\n\n    memmove(buff + pos, str, strl);\n    return buff;\n}\n\nint main()\n{\n    char buff[11];\n\n    printf(\"|%s|\\n\", centerinstring(buff, 10, \"1234567\", 1));\n    printf(\"|%s|\\n\", centerinstring(buff, 10, \"1234567\", 0));\n\n    return 0;\n}\n</code></pre>\n\n<p>or with the option to allocate memory for the buff (if you pass NULL</p>\n\n<pre><code>char *centerinstring(char *buff, size_t len, const char *str, int symetry)\n{\n    size_t strl = strlen(str);\n    size_t pos = strl / 2 + (strl &amp; 1) * !!symetry;\n\n    buff = buff ? malloc(len + 1) : buff;\n\n    if(buff)\n    {\n        memset(buff,' ', len);\n        buff[len] = 0;\n\n        memmove(buff + pos, str, strl);\n    }\nreturn buff;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 27, "user_id": 8227264, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a672d92c875921b21b9d8e862c7f0212?s=128&d=identicon&r=PG&f=1", "display_name": "mmajdalani", "link": "https://stackoverflow.com/users/8227264/mmajdalani"}, "edited": false, "score": 0, "creation_date": 1557343633, "post_id": 56047540, "comment_id": 98737119, "body": "Where can I find assert.h?"}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "reply_to_user": {"reputation": 27, "user_id": 8227264, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a672d92c875921b21b9d8e862c7f0212?s=128&d=identicon&r=PG&f=1", "display_name": "mmajdalani", "link": "https://stackoverflow.com/users/8227264/mmajdalani"}, "edited": false, "score": 0, "creation_date": 1557343678, "post_id": 56047540, "comment_id": 98737136, "body": "@mmajdalani It should be part of your compilers standard library?"}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "reply_to_user": {"reputation": 27, "user_id": 8227264, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a672d92c875921b21b9d8e862c7f0212?s=128&d=identicon&r=PG&f=1", "display_name": "mmajdalani", "link": "https://stackoverflow.com/users/8227264/mmajdalani"}, "edited": false, "score": 0, "creation_date": 1557348840, "post_id": 56047540, "comment_id": 98739264, "body": "@mmajdalani if not you can remove the <code>assert()</code> from the function. Just make sure you don&#39;t pass it NULL pointer."}], "tags": [], "owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "is_accepted": false, "score": 0, "last_activity_date": 1557343654, "last_edit_date": 1557343654, "creation_date": 1557342709, "answer_id": 56047540, "question_id": 56047009, "link": "https://stackoverflow.com/questions/56047009/how-to-dynamically-center-align-text-in-a-char-string-to-fit-in-a-total-of-16/56047540#56047540", "title": "How to dynamically center align text in a char * string to fit in a total of 16 spaces in C?", "body": "<p><code>sprintf()</code>-comfort:</p>\n\n<pre><code>#include &lt;assert.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdio.h&gt;\n\nvoid center(char *dst, char *src, size_t width)\n{\n    assert(dst &amp;&amp; src &amp;&amp; width);\n\n    size_t src_len = strlen(src);\n\n    if (src_len &gt;= width) {\n        *dst = '\\0';\n        return;\n    }\n\n    int right = (int)(width - src_len) / 2;\n    int left = right + (int)src_len;\n    right -= (src_len &amp; 1);\n\n    sprintf(dst, \"%*s%*s\", left, src, right, \"\");\n}\n\nint main(void)\n{\n    char destination[17];\n\n    center(destination, \"12345678901234\", sizeof(destination));\n    printf(\"\\\"%s\\\"\\n\", destination);\n}\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 8227264, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a672d92c875921b21b9d8e862c7f0212?s=128&d=identicon&r=PG&f=1", "display_name": "mmajdalani", "link": "https://stackoverflow.com/users/8227264/mmajdalani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "accepted_answer_id": 56047299, "answer_count": 3, "score": 0, "last_activity_date": 1557349617, "creation_date": 1557340252, "last_edit_date": 1557340707, "question_id": 56047009, "link": "https://stackoverflow.com/questions/56047009/how-to-dynamically-center-align-text-in-a-char-string-to-fit-in-a-total-of-16", "title": "How to dynamically center align text in a char * string to fit in a total of 16 spaces in C?", "body": "<p>I am trying to center align strings in a total of 16 spaces to eventually print them on a 16x2 LCD Display. The values are grabbed from a database, and put in a global variable that is constantly being updated.</p>\n\n<p>The values in the database are already in string format.</p>\n\n<p>What I'd like to do is after getting the value from the DB, update the global variable to contain a string centered in 16 spaces.</p>\n\n<p>I understand using global variables may not be best practice but ignoring that is there a way to do this?</p>\n\n<pre><code>char * systemInfoValues[5] = {\" \",\" \",\" \",\" \",\" \"}\nfor(int i=0; i&lt; 5; i++){\n     systemInfoValues[i] = PQgetvalue(res,i,0); //get the value from db;\n     int len = strlen(systemInfoValues[i]);\n     char tmp[20];\n\n     sprintf(tmp,\"%*s\", (17-len)/2 + len, systemInfoValues[i]);\n     strcpy(systemInfoValues[i],tmp);\n}\n</code></pre>\n\n<p>0 = a blank space\nxxxxx = string from db</p>\n\n<p>If the length of the string is odd \nI expect the output to be [00xxxxxxxxxxxxx0]</p>\n\n<p>if the length of the string is even\nI expect the output to be [00xxxxxxxxxxxx00]</p>\n"}, {"tags": ["python", "c", "constants", "python-c-api"], "comments": [{"owner": {"reputation": 23048, "user_id": 4657412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4915a27d01efa79d81d322511ee517a9?s=128&d=identicon&r=PG&f=1", "display_name": "DavidW", "link": "https://stackoverflow.com/users/4657412/davidw"}, "edited": false, "score": 1, "creation_date": 1557343590, "post_id": 56046949, "comment_id": 98737093, "body": "This is kind of tangential to your question, but <code>PyObject_GetAttrString</code> (on the module object) avoids having to get the dictionary."}], "answers": [{"comments": [{"owner": {"reputation": 3029, "user_id": 1239685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57e2117ca06179184f05d9c385b1823b?s=128&d=identicon&r=PG", "display_name": "Dominick Pastore", "link": "https://stackoverflow.com/users/1239685/dominick-pastore"}, "edited": false, "score": 0, "creation_date": 1557345114, "post_id": 56047374, "comment_id": 98737741, "body": "This is perfect. One question about this: Any idea what <code>PyState_AddModule()</code> returns? The docs say an <code>int</code> but not what that <code>int</code> means. Not sure whether that&#39;s supposed to be for errors, reserved future use, or what."}, {"owner": {"reputation": 1326, "user_id": 3180006, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EiLOs.jpg?s=128&g=1", "display_name": "Filip Dimitrovski", "link": "https://stackoverflow.com/users/3180006/filip-dimitrovski"}, "reply_to_user": {"reputation": 3029, "user_id": 1239685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57e2117ca06179184f05d9c385b1823b?s=128&d=identicon&r=PG", "display_name": "Dominick Pastore", "link": "https://stackoverflow.com/users/1239685/dominick-pastore"}, "edited": false, "score": 0, "creation_date": 1557345239, "post_id": 56047374, "comment_id": 98737788, "body": "@Nick Zero on success or -1 on failure."}], "tags": [], "owner": {"reputation": 1326, "user_id": 3180006, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EiLOs.jpg?s=128&g=1", "display_name": "Filip Dimitrovski", "link": "https://stackoverflow.com/users/3180006/filip-dimitrovski"}, "is_accepted": true, "score": 2, "last_activity_date": 1557342307, "last_edit_date": 1557342307, "creation_date": 1557341939, "answer_id": 56047374, "question_id": 56046949, "link": "https://stackoverflow.com/questions/56046949/how-to-access-constants-from-objects-methods-with-the-python-c-api/56047374#56047374", "title": "How to access constants from objects&#39; methods with the Python C API?", "body": "<p>If you have a module definition (<code>struct PyModuleDef</code>) you can just call <code>PyState_FindModule</code>. I am asuming your struct is named <code>Module</code> as in your example, so it will look like this:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>PyObject * your_function() {\n    PyObject *module = PyState_FindModule(&amp;Module);\n    PyObject* module_dict = PyModule_GetDict(module);\n    ...\n}\n</code></pre>\n\n<p>The <a href=\"https://docs.python.org/3/c-api/module.html#c.PyState_AddModule\" rel=\"nofollow noreferrer\">FindModule documentation</a> says that you need to add the module to the interpreter state as follows:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>PyMODINIT_FUNC\nPyInit_mymodule(void)\n{\n    PyObject* module = PyModule_Create(&amp;Module);\n    PyState_AddModule(module, &amp;Module);\n    ...\n</code></pre>\n"}], "owner": {"reputation": 3029, "user_id": 1239685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57e2117ca06179184f05d9c385b1823b?s=128&d=identicon&r=PG", "display_name": "Dominick Pastore", "link": "https://stackoverflow.com/users/1239685/dominick-pastore"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 205, "favorite_count": 0, "accepted_answer_id": 56047374, "answer_count": 1, "score": 2, "last_activity_date": 1557342307, "creation_date": 1557339988, "last_edit_date": 1557340343, "question_id": 56046949, "link": "https://stackoverflow.com/questions/56046949/how-to-access-constants-from-objects-methods-with-the-python-c-api", "title": "How to access constants from objects&#39; methods with the Python C API?", "body": "<p>I have a follow up for <a href=\"https://stackoverflow.com/questions/30606273/python-c-api-access-string-constants\">another question</a>. That question is about how to access constants added to a C extension module for Python.</p>\n\n<p>To paraphrase that question and answer, if you added constants <code>RED</code> and <code>BLUE</code> to your module in the initialization function like this:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>PyMODINIT_FUNC\nPyInit_mymodule(void)\n{\n    PyObject* module = PyModule_Create(&amp;Module);\n\n    // ...\n\n    PyModule_AddStringConstant(module, \"BLUE\", \"blue\");\n    PyModule_AddStringConstant(module, \"RED\", \"red\");\n\n    return module;\n}\n</code></pre>\n\n<p>then you can access them, e.g. to return them from a function, like this (bearing in mind that you must increment reference counts if necessary):</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>// Get module dict. This is a borrowed reference.\nPyObject* module_dict = PyModule_GetDict(module);\n\n// Get BLUE constant. This is a borrowed reference.\nPyObject* BLUE = PyDict_GetItemString(module_dict, \"BLUE\");\n\n// Get RED constant. This is a borrowed reference.\nPyObject* RED = PyDict_GetItemString(module_dict, \"RED\");\n</code></pre>\n\n<p>That works great if you have a pointer to the module object, which was the case in the linked question.</p>\n\n<p><strong>My question is,</strong> how do you do this if you don't have a pointer to the module object? For example, if the current function is an object's method, the <code>self</code> pointer you have is for that object, not the module (and I haven't been able to find a way to get the module from the object):</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>static PyObject * Foo_get_color(FooObject *self) {\n    // How do I get the module object here?\n    PyObject *module_dict = PyModule_GetDict(/* ??? */);\n\n    PyObject *color = NULL;\n    if (self-&gt;color == RED) {\n        color = PyDict_GetItemString(module_dict, \"RED\");\n        Py_INCREF(color);\n    } else if (self-&gt;color == BLUE) {\n        color = PyDict_GetItemString(module_dict, \"BLUE\");\n        Py_INCREF(color);\n    }\n\n    return color;\n}\n</code></pre>\n"}, {"tags": ["c", "constants"], "comments": [{"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 3, "creation_date": 1557339686, "post_id": 56046844, "comment_id": 98735375, "body": "But the malloced array never was const. Only the pointer had this type . There is no UB here as you derefernence another pointer."}, {"owner": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1557339734, "post_id": 56046844, "comment_id": 98735390, "body": "@P__J__ but the <code>char arr[]</code> in the <code>main</code> function is not <code>malloc</code>ed."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 1, "creation_date": 1557339793, "post_id": 56046844, "comment_id": 98735422, "body": "<code>char arr[]</code> isn&#39;t really important here.  It&#39;s your <code>ns_test_ptr-&gt;str</code> that is being aliased."}, {"owner": {"reputation": 8087, "user_id": 733637, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/444bbb295cc6185a5464e2250c1a35de?s=128&d=identicon&r=PG&f=1", "display_name": "CiaPan", "link": "https://stackoverflow.com/users/733637/ciapan"}, "edited": false, "score": 0, "creation_date": 1557339831, "post_id": 56046844, "comment_id": 98735440, "body": "And your question is...?"}, {"owner": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "reply_to_user": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1557340063, "post_id": 56046844, "comment_id": 98735536, "body": "@ChristianGibbons So the only thing that matters is the declared type of the object. In this case <code>ns_test_ptr-&gt;str</code> reffers to the object with declared type <code>char[]</code> as <code>char arr[]</code> was declared. So there is no problem."}, {"owner": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1557340133, "post_id": 56046844, "comment_id": 98735579, "body": "As @P__J__ mentioned it meant it was always ok in case the array was malloced."}], "answers": [{"comments": [{"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1557345797, "post_id": 56047049, "comment_id": 98737985, "body": "It should be pointed out that this is a <code>C</code> question.  I understand C and C++ can treat <code>const</code> rather differently."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user3458"}, "is_accepted": false, "score": 2, "last_activity_date": 1557406253, "last_edit_date": 1557406253, "creation_date": 1557340408, "answer_id": 56047049, "question_id": 56046844, "link": "https://stackoverflow.com/questions/56046844/modifying-non-const-char-array-that-is-referred-to-by-const-char-array/56047049#56047049", "title": "Modifying non-const char array that is referred to by const char array", "body": "<p>The key here is \"an object defined with a const-qualified type\". What matters is how you define (IOW, \"allocate memory for\") the object being pointed at. If the \"object\" was not \"created\" as <code>const</code>, then it does not matter how many const or non-const pointers and references you use - you can still modify it.</p>\n\n<p>So,</p>\n\n<pre><code>const int i = 0;\nint *p = (int*)&amp;i;\n*p = 1;\n</code></pre>\n\n<p>is UB.</p>\n\n<p>While </p>\n\n<pre><code>int i = 0;\nconst int *cp = &amp;i;\nint *p = (int*) cp;\n*p = 1;\n</code></pre>\n\n<p>is fine.</p>\n\n<p>I suspect this would even work with <code>new</code>:</p>\n\n<pre><code>const int *cp = new const int(0);\nint *p = (int*) cp;\n*p = 1;\n</code></pre>\n\n<p>is technically UB.</p>\n\n<p>It does compile w/o warning on cpp.sh, but that does not mean much.</p>\n\n<p>Update: as  Christian Gibbons pointed out, the language in the question is C, so the part about <code>new</code> operator does not apply. <code>malloc()</code> and friends are never <code>const</code>.</p>\n\n<p>To expand this a little - one possible reason for writing the standard this way is to give the compiler freedom to use read-only memory for const values. In that case, writing to such locations becomes a crash or a noop. In other words, UB.</p>\n"}], "owner": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1557406253, "creation_date": 1557339479, "last_edit_date": 1557339875, "question_id": 56046844, "link": "https://stackoverflow.com/questions/56046844/modifying-non-const-char-array-that-is-referred-to-by-const-char-array", "title": "Modifying non-const char array that is referred to by const char array", "body": "<p>Consider the following code:</p>\n\n<pre><code>struct ns_test{\n    char *str;\n};\n\nstruct ns_test *ns_test_alloc(char *str){\n    struct ns_test *nt = malloc(sizeof(*nt));\n    nt-&gt;str = str;\n    return nt;\n}\n\nconst char *ns_test_get_str(struct ns_test *tst){\n    return tst-&gt;str;\n}\n\nvoid ns_test_release(struct ns_test* tst){\n    free(tst);\n}\n\nvoid ns_test_set_char(struct ns_test *tst, size_t i, char c){\n    tst-&gt;str[i] = c;\n}\n\nint main(void){\n    char arr[] = \"1234567890\";\n    struct ns_test *ns_test_ptr = ns_test_alloc(arr);\n    const char *str = ns_test_get_str(ns_test_ptr);\n    printf(\"%s\\n\", str); //1234567890\n    ns_test_set_char(ns_test_ptr, 4, 'a');\n    printf(\"%s\\n\", str); //1234a67890\n}\n</code></pre>\n\n<p><strong><em>The question is</em></strong>: Is the behavior of the code undefined? </p>\n\n<p>I think it is.</p>\n\n<p>The Standard specifies at <code>6.7.3(p6)</code>:</p>\n\n<blockquote>\n  <p>If an attempt is made to modify an object defined with a\n  const-qualified type through use of an lvalue with non-const-qualified\n  type, the behavior is undefined.</p>\n</blockquote>\n\n<p>So to avoid this sort of UB we need <code>const char *ns_test_get_str(struct ns_test *tst)</code> to copy the <code>char *str</code> instead. But the main point was to avoid the copying and restrict the modification to the only <code>void ns_test_set_char(struct ns_test *tst, size_t i, char c)</code> which may do some sanity checks or something else prior.</p>\n"}, {"tags": ["c", "pipe", "fork"], "comments": [{"owner": {"reputation": 1324, "user_id": 7231449, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K4GZN.jpg?s=128&g=1", "display_name": "acarlstein", "link": "https://stackoverflow.com/users/7231449/acarlstein"}, "edited": false, "score": 0, "creation_date": 1557339415, "post_id": 56046782, "comment_id": 98735244, "body": "I got an old example I made on how to use Fork and Pipe in Linux with and without recursion if you are interested: <a href=\"http://www.acarlstein.com/?p=990\" rel=\"nofollow noreferrer\">acarlstein.com/?p=990</a>. I will check your code in the meanwhile to see if its an easy fix."}, {"owner": {"reputation": 1, "user_id": 11471616, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8dc03eb97e1f8fe03c95e81bfc91a90?s=128&d=identicon&r=PG", "display_name": "Amir Moradi", "link": "https://stackoverflow.com/users/11471616/amir-moradi"}, "reply_to_user": {"reputation": 1324, "user_id": 7231449, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K4GZN.jpg?s=128&g=1", "display_name": "acarlstein", "link": "https://stackoverflow.com/users/7231449/acarlstein"}, "edited": false, "score": 0, "creation_date": 1557339479, "post_id": 56046782, "comment_id": 98735276, "body": "I will check it out, thanks"}, {"owner": {"reputation": 1324, "user_id": 7231449, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K4GZN.jpg?s=128&g=1", "display_name": "acarlstein", "link": "https://stackoverflow.com/users/7231449/acarlstein"}, "edited": false, "score": 0, "creation_date": 1557339864, "post_id": 56046782, "comment_id": 98735455, "body": "In the code, you are closing <code>mypipefd[1]</code> which is correct when reading from the pipe; however, after reading, you are closing <code>mypipefd[0]</code> which should be only closed when you are thinking to write to the pipe.  I would advice to separate in method when you write and when you read the pipe. Its going to make your code easier to debug and reduce the chances to makes mistakes when working with pipes."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11471616, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8dc03eb97e1f8fe03c95e81bfc91a90?s=128&d=identicon&r=PG", "display_name": "Amir Moradi", "link": "https://stackoverflow.com/users/11471616/amir-moradi"}, "edited": false, "score": 0, "creation_date": 1557340376, "post_id": 56046855, "comment_id": 98735677, "body": "Thank you, it didn&#39;t even cross my mind that the problem is from there"}], "tags": [], "owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "is_accepted": false, "score": 3, "last_activity_date": 1557339517, "creation_date": 1557339517, "answer_id": 56046855, "question_id": 56046782, "link": "https://stackoverflow.com/questions/56046782/does-anyone-see-any-mistakes-here-i-am-trying-to-get-a-message-via-a-pipe-from/56046855#56046855", "title": "Does anyone see any mistakes here? I am trying to get a message via a pipe, from my parent to child", "body": "<p>Without examining the rest of your code, you need to call <code>pipe()</code> before you call <code>fork()</code> so the pipe can be used by both the parent and the child process.  If you call <code>pipe()</code> after you call <code>fork()</code>, the pipe is only usable by that one process.</p>\n\n<p>More like this:</p>\n\n<pre><code>int main(int argc, char const *argv[])\n{\n    int mypipefd[2];\n\n    if ( pipe( mypipefd ) == -1 )\n    {\n        perror(\"Pipe failed\\n\");\n        exit(EXIT_FAILURE);\n    }\n\n    pid_t pid = fork();\n    if (pid &gt; 0)\n    {\n        storeEngine(mypipefd);\n    } \n    .\n    .\n    .\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 11471616, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8dc03eb97e1f8fe03c95e81bfc91a90?s=128&d=identicon&r=PG", "display_name": "Amir Moradi", "link": "https://stackoverflow.com/users/11471616/amir-moradi"}, "is_accepted": false, "score": 0, "last_activity_date": 1557346006, "creation_date": 1557346006, "answer_id": 56048295, "question_id": 56046782, "link": "https://stackoverflow.com/questions/56046782/does-anyone-see-any-mistakes-here-i-am-trying-to-get-a-message-via-a-pipe-from/56048295#56048295", "title": "Does anyone see any mistakes here? I am trying to get a message via a pipe, from my parent to child", "body": "<p>No, pipes used to communicate between processes should be created before the fork() (otherwise, you have no easy way to send thru them, since the reading and the writing ends should be used by different processes).</p>\n"}], "owner": {"reputation": 1, "user_id": 11471616, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8dc03eb97e1f8fe03c95e81bfc91a90?s=128&d=identicon&r=PG", "display_name": "Amir Moradi", "link": "https://stackoverflow.com/users/11471616/amir-moradi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1557346006, "creation_date": 1557339193, "last_edit_date": 1557342028, "question_id": 56046782, "link": "https://stackoverflow.com/questions/56046782/does-anyone-see-any-mistakes-here-i-am-trying-to-get-a-message-via-a-pipe-from", "title": "Does anyone see any mistakes here? I am trying to get a message via a pipe, from my parent to child", "body": "<p>The problem here is that the child process does not wait for the message to arrive from the function <code>startWorking()</code>, and because of that I am getting a random char as output or sometimes nothing.</p>\n\n<p>I am sending a char array from <code>startWorking()</code> to the pipe and I am making sure only the parent does this job. </p>\n\n<p>One solution would be, sending a signal from <code>startWorking()</code> to the child processor, after writing into the pipe.\nBut the <code>read()</code> function behavior is waiting for the pipe to receive the message and only then read the message, but somehow it's not doing that, or maybe there is a problem in writing the message.</p>\n\n<pre><code>int main(int argc, char const *argv[])\n{\n    pid_t pid;\n    pid = fork();\n    int mypipefd[2];\n    if (pid &gt; 0)\n    {\n        if (pipe(mypipefd) == -1) \n        {\n        perror(\"Pipe failed\\n\");\n        exit(EXIT_FAILURE);\n        }\n        storeEngine(mypipefd);\n    } \n    else if(pid &lt; 0) \n    {\n        perror(\"fork call failed \\n\");\n        exit(EXIT_FAILURE);\n    }\n    else \n    {\n        printf(\"I am the child \\n\");\n        printf(\"child: %d \\n\", getpid());\n\n        char message[6];\n        close(mypipefd[1]);\n        read(mypipefd[0], &amp;message, 6);\n        close(mypipefd[0]);\n        printf(\"child read value:\\n \");\n        printf(\"%s \\n\", message);\n    }\n    return 0;\n}\n</code></pre>\n\n<pre><code>void startWorking(int *mypipefd)\n{   \n    printf(\"%d \\n\" ,getpid());\n    //close(*mypipefd);\n    write(*(mypipefd+1), \"hello\", 6);\n    close(*(mypipefd+1));\n}\n</code></pre>\n\n<p>Notice that if I remove the two slash behind <code>close(*mypipefd)</code> the program will never finish, and it will get stuck there.</p>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 1101, "user_id": 3958521, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GorZx.jpg?s=128&g=1", "display_name": "bigwillydos", "link": "https://stackoverflow.com/users/3958521/bigwillydos"}, "edited": false, "score": 0, "creation_date": 1557338400, "post_id": 56046578, "comment_id": 98734755, "body": "Where&#39;s the <code>typedef</code> for <code>char8</code>? Or perhaps that&#39;s a typo..."}, {"owner": {"reputation": 771, "user_id": 602117, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/f23193ab39941eb3e57a738161d316f5?s=128&d=identicon&r=PG", "display_name": "mr_js", "link": "https://stackoverflow.com/users/602117/mr-js"}, "reply_to_user": {"reputation": 1101, "user_id": 3958521, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GorZx.jpg?s=128&g=1", "display_name": "bigwillydos", "link": "https://stackoverflow.com/users/3958521/bigwillydos"}, "edited": false, "score": 0, "creation_date": 1557338720, "post_id": 56046578, "comment_id": 98734901, "body": "typedef          char   char8;"}, {"owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "edited": false, "score": 1, "creation_date": 1557338997, "post_id": 56046578, "comment_id": 98735043, "body": "Arrays don&#39;t point. Pointers do point. Although this is a decayed array, which is actually a pointer, you should treat it as an array. Its contents need to be accessed this way: <code>string[i]</code>. Do you mean that <code>string[0] == &#39;\\0&#39;</code> always?  Maybe <code>(total &gt;&gt; 24 &amp; 0xFF) == 0</code> always."}, {"owner": {"reputation": 1101, "user_id": 3958521, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GorZx.jpg?s=128&g=1", "display_name": "bigwillydos", "link": "https://stackoverflow.com/users/3958521/bigwillydos"}, "edited": false, "score": 0, "creation_date": 1557339023, "post_id": 56046578, "comment_id": 98735062, "body": "change it to <code>void UART_1_PutString(const char * string)</code>"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "reply_to_user": {"reputation": 1101, "user_id": 3958521, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GorZx.jpg?s=128&g=1", "display_name": "bigwillydos", "link": "https://stackoverflow.com/users/3958521/bigwillydos"}, "edited": false, "score": 2, "creation_date": 1557339056, "post_id": 56046578, "comment_id": 98735077, "body": "@bigwillydos That&#39;s the same thing."}, {"owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "edited": false, "score": 2, "creation_date": 1557339384, "post_id": 56046578, "comment_id": 98735226, "body": "I would advise not to use any ugly <code>typedef</code>s such as <code>char8</code> if they mean <code>char</code>.  Also, maybe <code>unsigned char</code> would be more suited for this task (unless you are forced to use <code>char</code> because of some library)."}, {"owner": {"reputation": 771, "user_id": 602117, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/f23193ab39941eb3e57a738161d316f5?s=128&d=identicon&r=PG", "display_name": "mr_js", "link": "https://stackoverflow.com/users/602117/mr-js"}, "reply_to_user": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "edited": false, "score": 1, "creation_date": 1557339409, "post_id": 56046578, "comment_id": 98735241, "body": "@CacahueteFrito - Your comment helped me solve the problem! uartBuf[0] was 0 under many conditions. :-/"}], "answers": [{"tags": [], "owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "is_accepted": true, "score": 1, "last_activity_date": 1557347079, "last_edit_date": 1557347079, "creation_date": 1557339625, "answer_id": 56046880, "question_id": 56046578, "link": "https://stackoverflow.com/questions/56046578/correct-way-of-calling-a-c-function-that-expects-const-char8-string-as-paramet/56046880#56046880", "title": "Correct way of calling a c function that expects const char8 string[] as parameter", "body": "<p>The code seems correct</p>\n\n<p>Do you mean that <code>string[0] == '\\0'</code>?</p>\n\n<p>Maybe <code>(total &gt;&gt; 24 &amp; 0xFF) == 0</code> always (or most of the times).</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>The function should be</p>\n\n<pre><code>void UART_1_PutString(const volatile unsigned char buff[]);\n</code></pre>\n\n<p>It shouldn't be called string, because it's not text, it's just a buffer (it looks like it at least).</p>\n\n<p><code>unsigned</code> because the \"string\", comes from some unsigned bit manipulation after some maths, which could cause an invalid signed value (unlikely to fail, but the rule should be: <code>char</code> for text, <code>unsigned char</code> for unknown data (everything else)).</p>\n\n<p><code>volatile</code> because if not, you are discarding the <code>volatile</code> qualifier.  A compiler with high enough flags (in GCC: <code>-Wall -Wextra -Werror</code> will highlight almost everything as errors) will warn you about that.  The compiler could think that the contents of the function can be simplified even before knowing that you will call it with <code>volatile</code> data, and therefore will optimize something which shouldn't be optimized.</p>\n\n<p>You could also add the <code>restrict</code> keyword (C11) if no other function will access that buffer at the same time, so that you help the compiler produce better code:</p>\n\n<pre><code>void UART_1_PutString(const volatile unsigned char buff[restrict]);\n</code></pre>\n\n<p><strong>EDIT2:</strong></p>\n\n<p>You should state the size of the buffer if it is only going to be called with that buffer, or also pass the size of the buffer to the function if not:</p>\n\n<pre><code>void UART_1_PutString(const volatile unsigned char buff[restrict 6]);\n</code></pre>\n\n<p>(6 should probably be replaced by some macro) or</p>\n\n<pre><code>void UART_1_PutString(size_t size, const volatile unsigned char buff[restrict size]);\n</code></pre>\n"}], "owner": {"reputation": 771, "user_id": 602117, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/f23193ab39941eb3e57a738161d316f5?s=128&d=identicon&r=PG", "display_name": "mr_js", "link": "https://stackoverflow.com/users/602117/mr-js"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 56046880, "answer_count": 1, "score": 0, "last_activity_date": 1557347079, "creation_date": 1557338300, "question_id": 56046578, "link": "https://stackoverflow.com/questions/56046578/correct-way-of-calling-a-c-function-that-expects-const-char8-string-as-paramet", "title": "Correct way of calling a c function that expects const char8 string[] as parameter", "body": "<p>Inside an ISR of a microcontroller I am attempting to call a function as follows:</p>\n\n<pre><code>//adc.c\nstatic volatile char uartBuf[6]={0};\n\nCY_ISR(ISR_ADC)\n{\n\nfor (uint8_t i=0; i &lt; NS; i++)\n  total += adc2_buffer0[i];\n\nuartBuf[0] = total &gt;&gt; 24 &amp; 0xFF;\nuartBuf[1] = total &gt;&gt; 16 &amp; 0xFF;\nuartBuf[2] = total &gt;&gt; 8 &amp; 0xFF;\nuartBuf[3] = total &amp; 0xFF; \nuartBuf[4] = '\\n';\nUART_1_PutString(uartBuf); //doesn't work\n}\n\n//uart.c\nvoid UART_1_PutString(const char8 string[]) \n{\n...\n}\n</code></pre>\n\n<p>However in the function UART_1_PutString, string always points to '\\0' rather than uartBuf?\nWhat could be the problem? Theoretically the variable uartBuf shouldn't be optimized out by the compiler.</p>\n"}, {"tags": ["c", "gettimeofday"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1557336778, "post_id": 56046095, "comment_id": 98733934, "body": "You have <code>while(c&lt;nsamples){ c++; </code> so perhaps <code>samples[c]</code> breaks the array. I suggest starting with <code>c = 1</code> and incrementing at the <i>end</i> of the loop, or some similar adjustment."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 4, "creation_date": 1557336886, "post_id": 56046095, "comment_id": 98733983, "body": "<code>samples = malloc(nsamples)</code> --&gt; <code>samples = malloc(nsamples * sizeof(*samples))</code>"}, {"owner": {"reputation": 75, "user_id": 8378816, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/X8dD6.png?s=128&g=1", "display_name": "Giannis", "link": "https://stackoverflow.com/users/8378816/giannis"}, "reply_to_user": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1557337040, "post_id": 56046095, "comment_id": 98734068, "body": "@dbush thank you very much. it worked. could you explain why?"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1557337458, "post_id": 56046095, "comment_id": 98734281, "body": "@GiannisGonidelis I&#39;ve added an answer detailing this."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1557356248, "post_id": 56046095, "comment_id": 98741450, "body": "The time that gets printed is correct, so the problem is apparently not related to gettimeofday."}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1557658529, "post_id": 56046095, "comment_id": 98832074, "body": "Sorry, why do you mix <code>float</code> with <code>double</code> floating point values?  Do you fear of running out of stack space on declaring two <code>float</code> variables instead of declaring them <code>double</code>?  If you are trying to save stack space, probably you have not got that you are making the compiler to consider a large amount of automatic conversions from <code>double</code> to <code>float</code> and viceversa.  And worse, loss of precision when truncating values."}], "answers": [{"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 3, "last_activity_date": 1557337233, "creation_date": 1557337233, "answer_id": 56046324, "question_id": 56046095, "link": "https://stackoverflow.com/questions/56046095/strange-stamp-on-gettimeofday/56046324#56046324", "title": "Strange stamp on gettimeofday()", "body": "<p>You haven't allocated enough space for <code>samples</code>:</p>\n\n<pre><code>samples = malloc(nsamples);\n</code></pre>\n\n<p>The <code>malloc</code> function allocates space for the specified number of <strong>bytes</strong>, not the number of array elements.  So your array is much shorter that you think it is.  This means you'll eventually write past the end of the array, invoking <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behavior</a>.</p>\n\n<p>You need to multiply the number of elements by the element size to allocate the correct amount of space:</p>\n\n<pre><code>samples = malloc(nsamples * sizeof(*samples));\n</code></pre>\n\n<p>You also have an off-by-one error when accessing the array:</p>\n\n<pre><code>int c = 0;\n...\nwhile(c&lt;nsamples){\n  c++;\n  ...\n  samples[c] = time;\n  ...\n}\n</code></pre>\n\n<p>This will also write past the end of the array, specifically one array element too many.  </p>\n\n<p>Change the loop to start with the value 1 and increment at the end.</p>\n\n<pre><code>int c = 0;\n...\nc = 1;\nwhile(c&lt;nsamples){\n  ...\n  samples[c] = time;\n  ...\n  c++;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "is_accepted": false, "score": 0, "last_activity_date": 1557658841, "creation_date": 1557658841, "answer_id": 56098549, "question_id": 56046095, "link": "https://stackoverflow.com/questions/56046095/strange-stamp-on-gettimeofday/56098549#56098549", "title": "Strange stamp on gettimeofday()", "body": "<p>The parameter to <code>malloc(3)</code> mus be the number of <strong>bytes</strong> to allocate, not the number of samples.  If you plan to allocate an array of <code>float</code> or <code>double</code> samples, you had better to multiply that number by the <code>sizeof (float)</code> (or <code>sizeof (double)</code>) before passing the parameter to <code>malloc(3)</code>.  As <code>samples</code> is defined as a pointer to <code>double</code>, then you should use:</p>\n\n<pre><code>samples = malloc(nsamples * sizeof(double));\n</code></pre>\n\n<p>or better (if you happen to change the declaration of <code>samples</code>):</p>\n\n<pre><code>samples = malloc(nsamples * sizeof *samples);\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 8378816, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/X8dD6.png?s=128&g=1", "display_name": "Giannis", "link": "https://stackoverflow.com/users/8378816/giannis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 56046324, "answer_count": 2, "score": 0, "last_activity_date": 1557658841, "creation_date": 1557336323, "question_id": 56046095, "link": "https://stackoverflow.com/questions/56046095/strange-stamp-on-gettimeofday", "title": "Strange stamp on gettimeofday()", "body": "<p>I have written this code for a sampling assignment at my university.</p>\n\n<pre><code>#include &lt;sys/time.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main(int argc, char **argv){\n    struct timeval tv;\n\n    float t = atoi(argv[1]);  //sampling time period in sec's\n    float dt = atoi(argv[2]);   //sampling rate in msec's\n    double time;\n    int nsamples = t/dt * 1000; //number of samples floored\n\n    //samples storage array\n    double *samples;\n    samples = malloc(nsamples);\n\n    printf(\"%d\\n\\n\",nsamples);\n\n    int c = 0;  //array index\n    double divergance;\n\n    gettimeofday(&amp;tv, NULL);\n    time =(double) tv.tv_sec + tv.tv_usec / 1000000.0f;\n    samples[c] = time;\n    printf(\"time: %f\\n\", samples[c]);\n\n    usleep(dt * 1000);\n\n    while(c&lt;nsamples){\n      c++;\n\n      gettimeofday(&amp;tv, NULL);\n      time = (double) tv.tv_sec + tv.tv_usec / 1000000.0f;\n      samples[c] = time;\n\n      //divergance calculated in msec's\n      divergance = (samples[c] - samples[c-1]);\n      if (c==9){\n        printf(\"%f \\n \\n%f\", samples[c-1], samples[c]);\n      }\n      printf(\"time: %f\\ndivergance: %f ms\\n\\n\", samples[c], divergance*1000);\n\n      usleep(dt *1000);\n    }\n\n}\n</code></pre>\n\n<p>and this is my output </p>\n\n<blockquote>\n  <p>time: 1557335682.435666 divergance: 200.127125 ms</p>\n  \n  <p>time: 1557335682.635813 divergance: 200.146914 ms</p>\n  \n  <p>time: 1557335682.835952 divergance: 200.139046 ms</p>\n  \n  <p>time: 1557335683.036075 divergance: 200.123072 ms</p>\n  \n  <p>time: 1557335683.236192 divergance:\n  -50328976507548121002151598324465532616014103321089770750300716493231241208217866953937760599346823570331739493744117764925654540012842402655523878795775819489233146901362588461216017208320541658368563434403808909221817741213696.000000 ms</p>\n  \n  <p>time: 1557335683.436400 divergance: 1557335683436.399902 ms</p>\n  \n  <p>time: 1557335683.636521 divergance: 1557335683636.520752 ms</p>\n  \n  <p>time: 1557335683.836647 divergance: 1557335683836.646973 ms</p>\n</blockquote>\n\n<p>Does anyone understand what's that weird output there on the fifth calculation. I can not imagine any logical explanation as I have not encountered any similar \"bug\" before. Does it have to do with some certain feature of <code>gettimeofday()</code> function?</p>\n\n<p>\u039dote: the input is <code>10</code> and <code>200</code> </p>\n"}, {"tags": ["c", "linked-list", "valgrind", "singly-linked-list"], "comments": [{"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 2, "creation_date": 1557336006, "post_id": 56045962, "comment_id": 98733528, "body": "don&#39;t forget that <code>strdup</code> also allocates memory on the heap that needs to be freed."}, {"owner": {"reputation": 1134, "user_id": 6608222, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/rO2Iu.png?s=128&g=1", "display_name": "th3g3ntl3man", "link": "https://stackoverflow.com/users/6608222/th3g3ntl3man"}, "reply_to_user": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1557336224, "post_id": 56045962, "comment_id": 98733646, "body": "@ChristianGibbons Do I have to call the <code>free</code> function on the` p` variable before scrolling <code>node</code>?"}, {"owner": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "edited": false, "score": 0, "creation_date": 1557336484, "post_id": 56045962, "comment_id": 98733780, "body": "No. Unless you are deleting the node from your list. Otherwise your list will contain pointers to nodes which are invalid."}, {"owner": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "edited": false, "score": 1, "creation_date": 1557336496, "post_id": 56045962, "comment_id": 98733788, "body": "An <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> would be helpful"}, {"owner": {"reputation": 1134, "user_id": 6608222, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/rO2Iu.png?s=128&g=1", "display_name": "th3g3ntl3man", "link": "https://stackoverflow.com/users/6608222/th3g3ntl3man"}, "reply_to_user": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "edited": false, "score": 0, "creation_date": 1557338084, "post_id": 56045962, "comment_id": 98734603, "body": "@MFisherKDX Sorry, I forgot to put the function to destroy the list. I just edit the question."}, {"owner": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "edited": false, "score": 0, "creation_date": 1557338903, "post_id": 56045962, "comment_id": 98735002, "body": "<code>current = key_list; free(current-&gt;key); free(current); key_list = key_list-&gt;next;</code> --&gt; change to <code>next = key_list-&gt;next; free(key_list-&gt;key); free(key_list); key_list = next;</code>"}, {"owner": {"reputation": 1134, "user_id": 6608222, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/rO2Iu.png?s=128&g=1", "display_name": "th3g3ntl3man", "link": "https://stackoverflow.com/users/6608222/th3g3ntl3man"}, "reply_to_user": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "edited": false, "score": 0, "creation_date": 1557340898, "post_id": 56045962, "comment_id": 98735890, "body": "@MFisherKDX I don&#39;t know why, but the problem persist"}, {"owner": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "edited": false, "score": 0, "creation_date": 1557341317, "post_id": 56045962, "comment_id": 98736107, "body": "It&#39;s a very low chance this free issue is causing the problem you describe. Unfortunately you haven&#39;t provided a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> so it&#39;s impossible to diagnose."}, {"owner": {"reputation": 1134, "user_id": 6608222, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/rO2Iu.png?s=128&g=1", "display_name": "th3g3ntl3man", "link": "https://stackoverflow.com/users/6608222/th3g3ntl3man"}, "reply_to_user": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "edited": false, "score": 0, "creation_date": 1557342924, "post_id": 56045962, "comment_id": 98736769, "body": "@MFisherKDX I just update the question. I add a link to the source code."}, {"owner": {"reputation": 1149, "user_id": 2472827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t5rYY.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/2472827/neil"}, "edited": false, "score": 0, "creation_date": 1557350581, "post_id": 56045962, "comment_id": 98739879, "body": "If you remove the <code>typedef</code>s, I think it will be clearer to read. You could replace <code>struct hash_table_key_list_node_s; typedef struct hash_table_key_list_node_s hash_table_key_list_node_t; typedef hash_table_key_list_node_t* hash_table_key_list_t;</code> with something like <code>struct hash_node</code>."}], "answers": [{"comments": [{"owner": {"reputation": 1134, "user_id": 6608222, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/rO2Iu.png?s=128&g=1", "display_name": "th3g3ntl3man", "link": "https://stackoverflow.com/users/6608222/th3g3ntl3man"}, "edited": false, "score": 0, "creation_date": 1557346218, "post_id": 56046572, "comment_id": 98738163, "body": "The error persist... Reading the valgrind error I suppose that one problem is the malloc in the function for create list"}], "tags": [], "owner": {"reputation": 26552, "user_id": 448932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QgLLl.png?s=128&g=1", "display_name": "500 - Internal Server Error", "link": "https://stackoverflow.com/users/448932/500-internal-server-error"}, "is_accepted": false, "score": 2, "last_activity_date": 1557345802, "last_edit_date": 1557345802, "creation_date": 1557338287, "answer_id": 56046572, "question_id": 56045962, "link": "https://stackoverflow.com/questions/56045962/memory-leak-singly-linked-list-in-c/56046572#56046572", "title": "Memory Leak - Singly linked list in C", "body": "<p>Careful here:</p>\n\n<pre><code>while ( key_list != NULL ) {\n    current = key_list; // current is now a copy of key_list (a copy of the pointer)\n    free(current-&gt;key);\n    free(current);      // here you free current and hence key_list\n\n    key_list = key_list-&gt;next; // here you are referring to key_list, just freed above\n  }\n</code></pre>\n\n<p>Try this instead:</p>\n\n<pre><code>while ( key_list != NULL ) {\n    current = key_list; \n    key_list = key_list-&gt;next; \n    free(current-&gt;key);\n    free(current);      \n  }\n</code></pre>\n\n<p>There may be other errors in your code, but this was one.</p>\n"}], "owner": {"reputation": 1134, "user_id": 6608222, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/rO2Iu.png?s=128&g=1", "display_name": "th3g3ntl3man", "link": "https://stackoverflow.com/users/6608222/th3g3ntl3man"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1557346037, "creation_date": 1557335832, "last_edit_date": 1557346037, "question_id": 56045962, "link": "https://stackoverflow.com/questions/56045962/memory-leak-singly-linked-list-in-c", "title": "Memory Leak - Singly linked list in C", "body": "<p>I implement this simple code for implement a Singly linked list in C. I just post another question for this code (<a href=\"https://stackoverflow.com/questions/55973317/c-linked-list-of-hash-table-keys\">link</a>). \nI put the code the same so that you can see it without having to change pages. This is the code:</p>\n\n<h3>struct of a list node:</h3>\n\n<pre><code>struct hash_table_key_list_node_s {\n  char *key;\n  struct hash_table_key_list_node_s* next;\n};\n\ntypedef struct hash_table_key_list_node_s hash_table_key_list_node_t;\ntypedef hash_table_key_list_node_t* hash_table_key_list_t;\n</code></pre>\n\n<h3>code of the function:</h3>\n\n<pre><code>hash_table_key_list_t hash_table_keys(hash_table_t hash_table) {\n\n  hash_table_key_list_t list, tail, p;\n  list = tail = NULL;\n\n  if ( hash_table != NULL &amp;&amp; hash_table-&gt;slots != NULL ) {\n\n    size_t index = 0;\n    while ( index &lt; hash_table-&gt;capacity ) {\n\n      hash_table_list_node_t *node = hash_table-&gt;slots[index].head;\n      while ( node != NULL ) {\n\n        p = malloc(sizeof(hash_table_key_list_node_t));\n        p-&gt;key = malloc((strlen(node-&gt;key) + 2) * sizeof(char));\n        if ( p-&gt;key == NULL ) {\n          perror(\"Unable to allocate a key\\n\");\n          abort();  \n        }\n\n        strcpy(p-&gt;key, node-&gt;key);\n\n        if ( node != NULL ) {\n          list = tail = p;\n        }\n        else { \n          tail-&gt;next = p;\n          tail = p;\n        }\n\n        node = node-&gt;next;\n      }\n\n      index++;\n    }\n  }\n\n  return list; \n}\n</code></pre>\n\n<h3>function for destroy list</h3>\n\n<pre><code>void destroy_key_list(hash_table_key_list_t key_list) {\n\n  hash_table_key_list_node_t *current = NULL;\n\n  if ( key_list == NULL ) return;\n\n  while ( key_list != NULL ) {\n    current = key_list;\n    free(current-&gt;key);\n    free(current);\n\n    key_list = key_list-&gt;next;\n  }\n\n  free(key_list);\n}\n</code></pre>\n\n<p>I have two problem that I don't understand:</p>\n\n<ul>\n<li>Why does the list no longer contain nodes once the list that returns to the function is used? Is it for the type of list?</li>\n<li>Why does it generate me memery loss? I tried calling the <code>free</code> function on the<code>node</code> variable before incrementing the <code>index</code> variable but nothing changes.</li>\n</ul>\n\n<p>This is the output of valgrind after one calling of the function:</p>\n\n<pre><code>==10757== HEAP SUMMARY:\n==10757==     in use at exit: 15,840 bytes in 660 blocks\n==10757==   total heap usage: 1,329 allocs, 669 frees, 123,642 bytes allocated\n==10757== \n==10757== 5,264 bytes in 329 blocks are indirectly lost in loss record 1 of 3\n==10757==    at 0x4C2FB0F: malloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)\n==10757==    by 0x10B93E: hash_table_keys (in /media/psf/bioinformatics-assignment-1/app/main)\n==10757==    by 0x109B27: main (in /media/psf/bioinformatics-assignment-1/app/main)\n==10757== \n==10757== 10,560 bytes in 330 blocks are indirectly lost in loss record 2 of 3\n==10757==    at 0x4C2FB0F: malloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)\n==10757==    by 0x10B975: hash_table_keys (in /media/psf/bioinformatics-assignment-1/app/main)\n==10757==    by 0x109B27: main (in /media/psf/bioinformatics-assignment-1/app/main)\n==10757== \n==10757== 15,840 (16 direct, 15,824 indirect) bytes in 1 blocks are definitely lost in loss record 3 of 3\n==10757==    at 0x4C2FB0F: malloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)\n==10757==    by 0x10B93E: hash_table_keys (in /media/psf/bioinformatics-assignment-1/app/main)\n==10757==    by 0x109B27: main (in /media/psf/bioinformatics-assignment-1/app/main)\n</code></pre>\n\n<p>Here you can find all the sources and headers file:</p>\n\n<ul>\n<li><a href=\"https://pastebin.com/4b9zbZ1g\" rel=\"nofollow noreferrer\">hash_table.c</a> (there are the implementation of all function)</li>\n<li><a href=\"https://pastebin.com/k6u53tzC\" rel=\"nofollow noreferrer\">hash_table_private.h</a> (private header, where are the struct definition)</li>\n<li><a href=\"https://pastebin.com/TCvJRw3R\" rel=\"nofollow noreferrer\">hash_table.h</a> (public header, where are the function prototipe) </li>\n</ul>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 2, "creation_date": 1557334292, "post_id": 56045436, "comment_id": 98732686, "body": "You never initialized the contents of <code>result</code>, so <code>strcat(result, &quot;1&quot;);</code> causes undefined behavior."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 2, "creation_date": 1557334323, "post_id": 56045436, "comment_id": 98732699, "body": "Why is your loop only up to <code>size-1</code>? You&#39;re ignoring the last character of the input string."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 2, "creation_date": 1557334403, "post_id": 56045436, "comment_id": 98732737, "body": "There&#39;s no need for <code>strcat(result, &quot;\\0&quot;);</code>. All the previous calls to <code>strcat()</code> will add a null terminator."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 2, "creation_date": 1557334450, "post_id": 56045436, "comment_id": 98732764, "body": "Why do you have a special case for <code>temp == &#39;a&#39;</code>? Your general calculation <code>temp - &#39;a&#39; + 1</code> will work for it."}, {"owner": {"reputation": 465, "user_id": 9344206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/276d8ee7cb60f203223a407ad4a0f6e0?s=128&d=identicon&r=PG&f=1", "display_name": "RobotMan", "link": "https://stackoverflow.com/users/9344206/robotman"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1557334647, "post_id": 56045436, "comment_id": 98732864, "body": "@Barmar Thanks for pointing all that out. I don&#39;t really know why I did the size-1, I think I was trying to fix an earlier problem and forgot to take it back out. As far as the strcat function, I did not know it null terminated it automatically. And the temp==&#39;a&#39;, your right about that too. Thank you!"}, {"owner": {"reputation": 465, "user_id": 9344206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/276d8ee7cb60f203223a407ad4a0f6e0?s=128&d=identicon&r=PG&f=1", "display_name": "RobotMan", "link": "https://stackoverflow.com/users/9344206/robotman"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1557334770, "post_id": 56045436, "comment_id": 98732929, "body": "@Barmar I thought when I used malloc in the result declaration that was initializing it? I&#39;m fairly new at C"}, {"owner": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "edited": false, "score": 0, "creation_date": 1557334824, "post_id": 56045436, "comment_id": 98732955, "body": "This is an odd way to allocate memory for your result: <code>char *result = malloc(sizeof(int)*size + 1)</code>.  --&gt; You are using <code>sizeof(int)</code> but the result is a <code>char</code> buffer.  It &quot;works&quot; because <code>sizeof(int)</code> &gt;= <code>3*sizeof(char)</code> on your system.  Every character gets replaced with up to 3 characters: ie: <code>z</code> -&gt; <code>26 </code> (characters 2, 6, and a space)."}, {"owner": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "edited": false, "score": 1, "creation_date": 1557335045, "post_id": 56045436, "comment_id": 98733060, "body": "set <code>result[0] = 0</code> after the malloc.  This will make it a null terminated empty string that you can then pass to &#39;strcat&#39;"}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 1, "creation_date": 1557335050, "post_id": 56045436, "comment_id": 98733062, "body": "<code>malloc(sizeof(int)*size + 1)</code> this is just wrong. You don&#39;t want to allocate a buffer for array of <code>size</code> variable of <code>int</code> type and one byte more. You need to allocate as many bytes you need for the output. Not for <code>int</code> array."}, {"owner": {"reputation": 465, "user_id": 9344206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/276d8ee7cb60f203223a407ad4a0f6e0?s=128&d=identicon&r=PG&f=1", "display_name": "RobotMan", "link": "https://stackoverflow.com/users/9344206/robotman"}, "reply_to_user": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "edited": false, "score": 0, "creation_date": 1557335263, "post_id": 56045436, "comment_id": 98733164, "body": "@MFisherKDX I wasn&#39;t really sure the right way to do it because it was a char array, but when I was trying to put integers in it to return the result I was getting a buffer overflow. I was trying to make it where every spot had enough space to store an integer."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1557340690, "post_id": 56045436, "comment_id": 98735806, "body": "The posted code does not implement the terms of the challenge, so everything would fail.  Please post the code you actually used -or- post the actual text of the challenge"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1557340963, "post_id": 56045436, "comment_id": 98735934, "body": "the posted code does not cleanly compile.  besides the problems with the logic (as documented else where) this statement: <code>for (i=0; i&lt;size-1; i++)</code> and this statement: `if (i!=size-2) each result in the compiler outputting a message similar to: <i>:34:22: warning: comparison between signed and unsigned integer expressions [-Wsign-compare]</i>"}], "answers": [{"comments": [{"owner": {"reputation": 465, "user_id": 9344206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/276d8ee7cb60f203223a407ad4a0f6e0?s=128&d=identicon&r=PG&f=1", "display_name": "RobotMan", "link": "https://stackoverflow.com/users/9344206/robotman"}, "edited": false, "score": 0, "creation_date": 1557335767, "post_id": 56045756, "comment_id": 98733402, "body": "Thank you for taking the time to help, you cleared up some of the confusion I was having about initializing char arrays as well as some of the other unnecessary code that was in there. I had no idea strcat added a null terminator either lol."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1557336860, "post_id": 56045756, "comment_id": 98733967, "body": "I think this introduces a subtle bug when the input doesn&#39;t end with a letter. There will be an extra space at the end of the output string."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 2, "creation_date": 1557341309, "post_id": 56045756, "comment_id": 98736103, "body": "Yeah. A simpler solution would be to put space after every number, and at the end overwrite the last space with a null byte."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1557341340, "post_id": 56045756, "comment_id": 98736119, "body": "Another method would be to write the space <i>before</i> each number, unless it&#39;s the first number being printed."}, {"owner": {"reputation": 10217, "user_id": 471930, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tds8p.png?s=128&g=1", "display_name": "Jasen", "link": "https://stackoverflow.com/users/471930/jasen"}, "edited": false, "score": 0, "creation_date": 1557363807, "post_id": 56045756, "comment_id": 98742884, "body": "<code>Your allocation works because sizeof(int) is generally at least 4, so you&#39;re allocating more than enough space.</code>, actually that explains why it fails on an empty string."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 10217, "user_id": 471930, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tds8p.png?s=128&g=1", "display_name": "Jasen", "link": "https://stackoverflow.com/users/471930/jasen"}, "edited": false, "score": 0, "creation_date": 1557379360, "post_id": 56045756, "comment_id": 98746157, "body": "@Jasen That will fail the same way no matter what you multiply by."}], "tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": true, "score": 4, "last_activity_date": 1557335438, "last_edit_date": 1557335438, "creation_date": 1557335063, "answer_id": 56045756, "question_id": 56045436, "link": "https://stackoverflow.com/questions/56045436/c-character-array-comparison/56045756#56045756", "title": "C character array comparison", "body": "<p>You have two serious problems.</p>\n\n<p>First, you're not initializing the contents of the <code>result</code> array to an empty string. After you call <code>malloc()</code>, add:</p>\n\n<pre><code>result[0] = '\\0';\n</code></pre>\n\n<p><code>malloc()</code> doesn't initialize the memory it allocates. There's another function <code>calloc()</code> that takes slightly different arguments and initializes the memory to zeroes. But you only need the first character to be zero, so there's no need for that.</p>\n\n<p>Second, the <code>for</code> loop is not processing the last character of <code>text</code>. It should be:</p>\n\n<pre><code>for (i = 0; i &lt; size; i++)\n</code></pre>\n\n<p>Similarly, the test for whether to add a space should be <code>if (i != size-1)</code>. Did you think <code>strlen()</code> counts the null character at the end?</p>\n\n<p>The amount of space you specify in <code>malloc()</code> is not correct, but in practice it won't cause a problem. <code>sizeof(int)</code> has nothing to do with the number of characters it takes to show the value of an integer. Since you're just printing the alphabetical position, it will be at most <code>26</code>, so you need 3 characters for every input character. Therefore, it should be:</p>\n\n<pre><code>char *result = malloc(3 * size + 1);\n</code></pre>\n\n<p>Your allocation works because <code>sizeof(int)</code> is generally at least 4, so you're allocating more than enough space.</p>\n\n<p>There are other minor problems that don't affect the correctness of the result:</p>\n\n<p>You don't need the <code>if</code> statement that treats <code>'a'</code> specially, the code you have in <code>else</code> will work for all letters.</p>\n\n<p>You don't need <code>strcat(result, \"\\0\")</code> at the end. <code>result</code> has to already be null-terminated in order for you to use it as an argument to <code>strcat()</code>, so there's no point in using <code>strcat()</code> to add a null terminator.</p>\n"}], "owner": {"reputation": 465, "user_id": 9344206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/276d8ee7cb60f203223a407ad4a0f6e0?s=128&d=identicon&r=PG&f=1", "display_name": "RobotMan", "link": "https://stackoverflow.com/users/9344206/robotman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 56045756, "answer_count": 1, "score": 1, "last_activity_date": 1557335438, "creation_date": 1557333881, "question_id": 56045436, "link": "https://stackoverflow.com/questions/56045436/c-character-array-comparison", "title": "C character array comparison", "body": "<p>Ok so I was doing a coding challenge on codewars.com and the challenge was to take a string as input and return a string where in place of the letters are instead the number of the alphabet that matches the letter.</p>\n\n<p>Everything except letters are to be ignored.</p>\n\n<p>ex: \"aab\" would return \"1 1 2\"</p>\n\n<p>There should be a space between each number that represents a letter in the alphabet.</p>\n\n<p>So, when I run this code on my IDE (which is xcode using c99) Everything looks good and the <code>strcmp()</code> function says the 2 strings are equal.\nThe website I'm on uses C11 I believe but I don't see that causing the error.</p>\n\n<p>When I run this code on the challenge website it passes a couple of tests but then fails a couple also. It fails when the input string is \"\", and it also fails on the string that I have used in the code below, but again it does not fail when I run it on my ide.</p>\n\n<p>My questions are:</p>\n\n<p>1) Any idea what is causing this bug?</p>\n\n<p>2) What would you have done differently as far as the code is concerned</p>\n\n<p>Thanks</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;ctype.h&gt;\n\nchar *alphabet_position(char *text)\n{\n    int i,letter_position;\n    unsigned long int size = strlen(text);\n\n    char *result = malloc(sizeof(int)*size + 1);\n\n    char int_string[10];\n    char temp = ' ';\n\n    //If String wasn't blank\n    if (strcmp(text, \"\")!=0)\n    {\n        for (i=0; i&lt;size-1; i++)\n        {\n            //If it is a letter\n            if (isalpha(text[i]))\n            {\n                temp = tolower(text[i]);\n                if (temp == 'a')\n                    strcat(result, \"1\");\n                else\n                {\n                    letter_position = temp - 'a' + 1;\n                    sprintf(int_string,\"%d\",letter_position);\n                    strcat(result, int_string);\n                }\n                //Print space after letter until the last letter\n                if (i!=size-2)\n                    strcat(result, \" \");\n            }\n        }\n        strcat(result, \"\\0\");\n        return result;\n    }\n    else\n    {\n        strcat(result, \"\\0\");\n        return result;\n    }\n\n}\n\n\nint main(void)\n{\n\n    char *string = alphabet_position(\"The narwhal bacons at midnight.\");\n    char *expected_output = \"20 8 5 14 1 18 23 8 1 12 2 1 3 15 14 19 1 20 13 9 4 14 9 7 8 20\";\n\n    printf(\"Your output %s\\n\", alphabet_position(\"The narwhal bacons at midnight.\"));\n    printf(\"Expt output %s\\n\", \"20 8 5 14 1 18 23 8 1 12 2 1 3 15 14 19 1 20 13 9 4 14 9 7 8 20\");\n\n    printf(\"\\n\");\n\n    printf(\"your len %lu\\n\", strlen(alphabet_position(\"The narwhal bacons at midnight.\")));\n    printf(\"Expt len %lu\\n\", strlen(expected_output));\n\n    if (strcmp(string, expected_output)==0)\n        printf(\"Equal\\n\");\n    else\n        printf(\"Not equal\\n\");\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "string"], "comments": [{"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 0, "creation_date": 1557333253, "post_id": 56045259, "comment_id": 98732202, "body": "<code>&#39;%7C&#39;</code> isn&#39;t a valid character as far as I know. It is a string of three characters."}, {"owner": {"reputation": 293, "user_id": 7177271, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-8EkKHDl-kgU/AAAAAAAAAAI/AAAAAAAAABY/x2USaUE1k-o/photo.jpg?sz=128", "display_name": "Bret Hasel", "link": "https://stackoverflow.com/users/7177271/bret-hasel"}, "reply_to_user": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 0, "creation_date": 1557333301, "post_id": 56045259, "comment_id": 98732228, "body": "The reasoning for it is i&#39;m implementing an HTTP server and when the user types in <code>|</code> it goes back to the <code>%7C</code>"}, {"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 2, "creation_date": 1557333379, "post_id": 56045259, "comment_id": 98732274, "body": "That is completely understandable. The <code>&quot;%7C&quot;</code> is the URL encoded version of the <code>&#39;|&#39;</code> character. However, you need to realize that you are replacing a <b>substring</b> with a <b>single character</b>. The logic to do this will be more complicated than a simple assignment."}, {"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "edited": false, "score": 0, "creation_date": 1557333393, "post_id": 56045259, "comment_id": 98732282, "body": "Aside::You are unnecessarily allocating memory and overwriting it next line causing memory leaks.."}, {"owner": {"reputation": 293, "user_id": 7177271, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-8EkKHDl-kgU/AAAAAAAAAAI/AAAAAAAAABY/x2USaUE1k-o/photo.jpg?sz=128", "display_name": "Bret Hasel", "link": "https://stackoverflow.com/users/7177271/bret-hasel"}, "reply_to_user": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 0, "creation_date": 1557333524, "post_id": 56045259, "comment_id": 98732337, "body": "the memory isnt the issue here and this code is a piece of something larger so the memory allocation is needed i thought. Regardless, @Code-Apprentice is there a way to do this then that will work to maintain the string? such as <code>ls+-l+%7C+wc+-l</code> becoming <code>ls -l | wc -l</code> atm it become <code>ls -l %7C wc -l</code>"}, {"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 1, "creation_date": 1557334425, "post_id": 56045259, "comment_id": 98732750, "body": "@BretHasel Yes, there is a way to do this. It is called unencoding. If you are implementing this yourself, you need to write an algorithm that replaces a substring of your input with a character. Are you only concerned about the | character or do you need general unencoding for all possible characters?"}, {"owner": {"reputation": 293, "user_id": 7177271, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-8EkKHDl-kgU/AAAAAAAAAAI/AAAAAAAAABY/x2USaUE1k-o/photo.jpg?sz=128", "display_name": "Bret Hasel", "link": "https://stackoverflow.com/users/7177271/bret-hasel"}, "edited": false, "score": 0, "creation_date": 1557343578, "post_id": 56045259, "comment_id": 98737086, "body": "only the | character"}], "answers": [{"tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": true, "score": 2, "last_activity_date": 1557334509, "last_edit_date": 1557334509, "creation_date": 1557334095, "answer_id": 56045496, "question_id": 56045259, "link": "https://stackoverflow.com/questions/56045259/how-to-replace-a-multi-character-character-constant-with-one-character/56045496#56045496", "title": "How to replace a multi-character character constant with one character", "body": "<p>Multi-character constants are not portable and should generally be avoided.  Your code comes under the 'general' category.</p>\n\n<p>Part of the solution to your problem is to do a string comparison (with <code>strncmp</code>):</p>\n\n<pre><code>if (strncmp(&amp;newCommand[i], \"%7C\", 3) == 0)\n{\n    newCommand[i] = '|';\n}\n</code></pre>\n\n<p>However, you also need to remove the <code>7C</code>.  That requires more surgery on the loop:</p>\n\n<pre><code>int tgt = 0;\nint len = strlen(newCommand);\nfor (int src = 0; src &lt; len; src++)\n{\n    if (newCommand[src] == '+')\n    {\n        newCommand[tgt++] = ' ';\n    }\n    else if (strncmp(newCommand[i], \"%7C\", 3) == 0)\n    {\n        newCommand[tgt++] = '|';\n        src += 2;\n    }\n    else\n        newCommand[tgt++] = newCommand[src];\n }\n newCommand[tgt] = '\\0';\n</code></pre>\n\n<p>This maintains two indexes into the <code>newCommand</code> array, one from which you're reading (<code>src</code>) and one to which you're writing (<code>tgt</code> \u2014 <code>dst</code> would be an alternative name).  The <code>src += 2;</code> skips over the <code>7C</code> after replacing <code>%</code> with <code>|</code>.</p>\n\n<p><sup><em>Uncompiled code!</em></sup></p>\n\n<p>Also, in your function you have:</p>\n\n<pre><code>char *newCommand = (char *)malloc(sizeof(char)*35);\nnewCommand = strtok(command, \" \");\n</code></pre>\n\n<p>This immediately leaks the allocated memory.  Maybe you need to use <code>strdup()</code> or:</p>\n\n<pre><code>char *newCommand = malloc(strlen(command) + 1);\nif (newCommand == NULL) \u2026report error and bail out\u2026\nstrcpy(newCommand, command);\n</code></pre>\n\n<p>And the next line:</p>\n\n<pre><code>newCommand = strtok(NULL, \"/run?command= \");\n</code></pre>\n\n<p>splits on any sequence of any of the characters in the constant string; it does not look for that string.  If you want to look for the string, then you need <code>strstr()</code> instead, and you need to run <code>strtok()</code> first, perhaps, to get the right starting point (maybe <code>newCommand = strtok(NULL, \"\")</code>, then <code>char *end = strstr(newCommand, \"/run?command= \");</code> \u2014 and check for null pointers returned.</p>\n\n<p>With the revised allocation, you need a new symbol to record the pointers returned by <code>strtok()</code> \u2014 such as <code>char *token;</code>.</p>\n\n<p>All in all, there's a lot of work needed on your code.</p>\n"}], "owner": {"reputation": 293, "user_id": 7177271, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-8EkKHDl-kgU/AAAAAAAAAAI/AAAAAAAAABY/x2USaUE1k-o/photo.jpg?sz=128", "display_name": "Bret Hasel", "link": "https://stackoverflow.com/users/7177271/bret-hasel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 0, "closed_date": 1557370645, "accepted_answer_id": 56045496, "answer_count": 1, "score": -4, "last_activity_date": 1557334509, "creation_date": 1557333176, "question_id": 56045259, "link": "https://stackoverflow.com/questions/56045259/how-to-replace-a-multi-character-character-constant-with-one-character", "closed_reason": "Needs details or clarity", "title": "How to replace a multi-character character constant with one character", "body": "<p>I'm attempting to replace <code>'%7C'</code> with a <code>'|'</code> in C but i'm getting a multi-character character constant warning. I was wondering if it was possible to do this and if so how? I was attempting using the code below but it gave this warning.</p>\n\n<p><strong>Parse.c</strong></p>\n\n<pre><code>char *parse(char *command){\n char * newCommand = (char *)malloc(sizeof(char)*35);\n     newCommand = strtok(command, \" \");\n     newCommand = strtok(NULL, \"/run?command= \");\n     for(int i = 0; i&lt;strlen(newCommand); i++){\n          if(newCommand[i] == '+')\n          {\n              newCommand[i] = ' ';\n          }\n          if(newCommand[i] == '%7C')\n          {\n               newCommand[i] = '|';\n          }\n     }\n    return newCommand;\n  }\n</code></pre>\n"}, {"tags": ["c", "d"], "comments": [{"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1557333334, "post_id": 56045239, "comment_id": 98732245, "body": "I supose you mean <code>alias</code> with only one l ... (if not revert my editing)"}, {"owner": {"reputation": 24524, "user_id": 1457000, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u3irT.jpg?s=128&g=1", "display_name": "Adam D. Ruppe", "link": "https://stackoverflow.com/users/1457000/adam-d-ruppe"}, "edited": false, "score": 0, "creation_date": 1557333403, "post_id": 56045239, "comment_id": 98732285, "body": "I&#39;m in a rush so don&#39;t have time for a full answer, but a <code>Vec</code> there in C is being typed <code>double</code>, so your first step will be just <code>alias Vec = double;</code>. But then that <code>__attribute__</code> stuff is for simd optimizations and I don&#39;t know how to express that in D. Maybe someone else will answer while I&#39;m gone though. I kinda suspect the code will work without it for at least basic stuff though."}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1557334902, "post_id": 56045239, "comment_id": 98732995, "body": "Do something along <code>import gcc.attribute;  @attribute(&quot;vector_size(16)&quot;)</code>. Note that <code>__attribute__</code> is GCC specific, compiler specific, it might be impossible to translate it to other compiler. The GNU D compiler <code>GDC</code> maybe supports the same attributes that GCC, I wonder."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1557343127, "post_id": 56045239, "comment_id": 98736869, "body": "<a href=\"https://stackoverflow.com/questions/7843597/what-is-the-meaning-of-the-attribute-vector-size16\" title=\"what is the meaning of the attribute vector size16\">stackoverflow.com/questions/7843597/&hellip;</a> &quot;It&#39;s for use with SIMD vectorization. (No, it doesn&#39;t make foo an array.)&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 2095, "user_id": 359297, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4ee6acc437934205447a5f31babcd3f?s=128&d=identicon&r=PG", "display_name": "BioTronic", "link": "https://stackoverflow.com/users/359297/biotronic"}, "is_accepted": false, "score": 3, "last_activity_date": 1557389241, "creation_date": 1557389241, "answer_id": 56054907, "question_id": 56045239, "link": "https://stackoverflow.com/questions/56045239/trouble-with-translation-of-typedef-between-c-to-d/56054907#56054907", "title": "Trouble with translation of typedef between C to D", "body": "<p>There's <a href=\"https://dlang.org/library/core/simd/vector.html\" rel=\"nofollow noreferrer\"><code>core.simd.Vector</code></a> which does something similar. I'm not sure exactly what the differences are, but I'm sure there are some.</p>\n\n<p>The one I know about is <code>Vector</code> takes the number of elements instead of the size in bytes, so</p>\n\n<pre><code>typedef double Vec __attribute__ ((vector_size(16))); \n</code></pre>\n\n<p>becomes</p>\n\n<pre><code>import core.simd : Vector;\nalias Vec = Vector!(double[2]);\n</code></pre>\n\n<p>However, DMD only supports this for x64. It works in LDC for both 32-bit and 64-bit architectures, and I believe the same is true for GDC.</p>\n"}], "owner": {"reputation": 1, "user_id": 11471321, "user_type": "registered", "profile_image": "https://graph.facebook.com/1717873841648616/picture?type=large", "display_name": "EduardoFerrari", "link": "https://stackoverflow.com/users/11471321/eduardoferrari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1557389241, "creation_date": 1557333126, "last_edit_date": 1557333263, "question_id": 56045239, "link": "https://stackoverflow.com/questions/56045239/trouble-with-translation-of-typedef-between-c-to-d", "title": "Trouble with translation of typedef between C to D", "body": "<p>I'm new on D programming and I am trying to translate a code from C to D, the actual line that I am having trouble is </p>\n\n<pre><code>typedef double Vec __attribute__ ((vector_size(16))); \n</code></pre>\n\n<p>... I tried on:</p>\n\n<pre><code>alias Vez = double[16];\n</code></pre>\n\n<p>but it didnt work probably ... any help ?</p>\n"}, {"tags": ["c", "sleep", "kill"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 2, "creation_date": 1557333040, "post_id": 56045143, "comment_id": 98732114, "body": "Try running with <code>strace</code> to see what&#39;s happening."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1557334734, "post_id": 56045143, "comment_id": 98732913, "body": "Two potential issues.  First, you can&#39;t safely call <code>printf()</code> in a signal handler as it&#39;s not async-signal-safe.  See <a href=\"https://stackoverflow.com/questions/34467694/why-only-async-signal-safe-functions-can-be-called-from-signal-handlers-safely\" title=\"why only async signal safe functions can be called from signal handlers safely\">stackoverflow.com/questions/34467694/&hellip;</a> for one example question. Second, you might want to <a href=\"https://stackoverflow.com/questions/231912/what-is-the-difference-between-sigaction-and-signal\">use <code>sigaction()</code> instead of <code>signal()</code></a>."}], "answers": [{"comments": [{"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 1, "creation_date": 1557377779, "post_id": 56045505, "comment_id": 98745713, "body": "Doing <code>{ int t = 20; while (0 &lt;= (t = sleep(t))); }</code> instead of just <code>sleep(20);</code> might help as well."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1557379805, "post_id": 56045505, "comment_id": 98746286, "body": "<code>t</code> above should be <code>unsigned int</code>."}], "tags": [], "owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "is_accepted": false, "score": 2, "last_activity_date": 1557357340, "last_edit_date": 1557357340, "creation_date": 1557334118, "answer_id": 56045505, "question_id": 56045143, "link": "https://stackoverflow.com/questions/56045143/why-does-sigint-stop-sleep-more-than-one-time/56045505#56045505", "title": "Why does SIGINT stop sleep more than one time?", "body": "<p>The <code>SIGCHLD</code> from the previous child-death-causing <code>kill</code> is arriving just when you're in the next <code>sleep</code>.</p>\n\n<p>Sleep is an interruptible function. If a signal handler runs while your thread is in it, the <code>sleep</code> is going to abort. So then you proceed to the next <code>kill</code>, which is going to indirectly cause another <code>SIGCHLD</code> which will most likely happen when your next iteration's sleep, resulting in several skipped sleeps.</p>\n\n<p>If you insert <code>sleep(1)</code> before <code>fork()</code>, it should (practically) shift the timing just right so that next <code>sleep(20);</code> is uninterrupted.</p>\n\n<p>(I'm treating this as a quick-and-dirty experiment. In no way is it a good idea to rely on \"adjustments\" like this in production code (or to use <code>printf</code> in signal handlers for that matter).)</p>\n"}], "owner": {"reputation": 31, "user_id": 669794, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/00052f76e66326ef3f8509f303385614?s=128&d=identicon&r=PG", "display_name": "Antonio", "link": "https://stackoverflow.com/users/669794/antonio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 155, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1557357340, "creation_date": 1557332693, "last_edit_date": 1557332871, "question_id": 56045143, "link": "https://stackoverflow.com/questions/56045143/why-does-sigint-stop-sleep-more-than-one-time", "title": "Why does SIGINT stop sleep more than one time?", "body": "<p>I don't understand why after the first execution of kill function the sleep function doesn't pause the parent process.\nAfter the SIGINT has been delivered, many processes are generated. Furthermore, it seems that a variable number of processes is generated.\nIs a handler for SIGINT required for cleaning the first SIGINT from the pending signals?</p>\n\n<pre><code>void handler(int s) {\n    int status;\n    wait(&amp;status);\n    printf(\"\\n in the handler\");\n    if (WIFSIGNALED(status)) {\n        int sig=WTERMSIG(status);\n        printf(\"\\n child stopped by signal %d\\n\",sig);\n    }\n    if (WIFEXITED(status)) {\n        int ex=WEXITSTATUS(status);\n        printf(\"\\n child stopped with exist status %d\\n\",ex);\n    }\n}\n\nint main() {\n    int pid,len, count, ret;\n    char s[1024];\n    signal(SIGCHLD,handler);\n    while(1) {\n        pid=fork();\n        if (pid==0) {\n            printf(\"\\n Write something \");\n            scanf(\"%s\",s);\n            len=strlen(s);\n            printf(\"\\n Characters: %d\",len);\n            return 1;\n        }\n        else {\n            sleep(20);\n            kill(pid,SIGINT);\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "winapi"], "comments": [{"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1557335026, "post_id": 56044529, "comment_id": 98733053, "body": "No pause option, you can only stop it and start it back up.  That does require measuring how much time has elapsed at the moment you pause it.  Use GetTickCount64() when you start it, again when you pause it.  Do beware it is fundamentally racy, you might discover that it has already expired but not made its callback yet.  In which case it is best to do nothing.  Now you know why it doesn&#39;t have a pause option :)"}], "answers": [{"comments": [{"owner": {"reputation": 2323, "user_id": 8350647, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zJNHD.png?s=128&g=1", "display_name": "Nina", "link": "https://stackoverflow.com/users/8350647/nina"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 1, "creation_date": 1557332184, "post_id": 56044927, "comment_id": 98731767, "body": "<code>DueTime</code> is just delaying the initial execution. &quot;DueTime [in] The amount of time in milliseconds relative to the current time that must elapse before the timer is signaled for the first time.&quot; There could be instances where a person wants to activate the timer instantly then pause at any random time in the future."}, {"owner": {"reputation": 183, "user_id": 966717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86cef05e2701f8801e21e769b24033b6?s=128&d=identicon&r=PG", "display_name": "CMorgan", "link": "https://stackoverflow.com/users/966717/cmorgan"}, "edited": false, "score": 1, "creation_date": 1557384403, "post_id": 56044927, "comment_id": 98748047, "body": "Thanks a lot!!!. It&#39;s a good approach I think I can add an intermediate callback just to avoid to call user&#39;s callback when the timer is paused."}, {"owner": {"reputation": 2323, "user_id": 8350647, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zJNHD.png?s=128&g=1", "display_name": "Nina", "link": "https://stackoverflow.com/users/8350647/nina"}, "reply_to_user": {"reputation": 183, "user_id": 966717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86cef05e2701f8801e21e769b24033b6?s=128&d=identicon&r=PG", "display_name": "CMorgan", "link": "https://stackoverflow.com/users/966717/cmorgan"}, "edited": false, "score": 0, "creation_date": 1557406105, "post_id": 56044927, "comment_id": 98759974, "body": "Ah yes! Good idea I didn&#39;t consider using another callback for &quot;Pausing&quot;."}], "tags": [], "owner": {"reputation": 2323, "user_id": 8350647, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zJNHD.png?s=128&g=1", "display_name": "Nina", "link": "https://stackoverflow.com/users/8350647/nina"}, "is_accepted": false, "score": 5, "last_activity_date": 1557332386, "last_edit_date": 1557332386, "creation_date": 1557331899, "answer_id": 56044927, "question_id": 56044529, "link": "https://stackoverflow.com/questions/56044529/how-to-pause-a-timer-created-with-createtimerqueuetimer/56044927#56044927", "title": "How to pause a timer created with CreateTimerQueueTimer", "body": "<p>I believe you can call <a href=\"https://msdn.microsoft.com/en-us/library/ms682004(v=VS.85).aspx\" rel=\"nofollow noreferrer\">ChangeTimerQueueTimer</a> and set the <code>_In_     ULONG  Period</code> to 0. Where the <code>_In_opt_ HANDLE TimerQueue</code> argument will be <code>NULL</code> and the <code>_Inout_  HANDLE Timer</code> will be the HANDLE retrieved from <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms682485(v=vs.85).aspx\" rel=\"nofollow noreferrer\">CreateTimerQueueTimer</a>. This will execute the callback in the timer just once and stop. If you want to reactivate the timer you can <code>ChangeTimerQueueTimer</code> again with the same handle providing a period greater than 0 to run periodically. There isn't specifically an API to suspend the timer but preventing it from running periodically should be the equivalent in your case. Just note that your callback will get hit once after calling <code>ChangeTimerQueueTimer</code> before \"suspending\".</p>\n"}], "owner": {"reputation": 183, "user_id": 966717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86cef05e2701f8801e21e769b24033b6?s=128&d=identicon&r=PG", "display_name": "CMorgan", "link": "https://stackoverflow.com/users/966717/cmorgan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 207, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1557332386, "creation_date": 1557330516, "question_id": 56044529, "link": "https://stackoverflow.com/questions/56044529/how-to-pause-a-timer-created-with-createtimerqueuetimer", "title": "How to pause a timer created with CreateTimerQueueTimer", "body": "<p>I need to pause a timer created using CreateTimerQueueTimer function of win32 API but I can't find a way to pause the timer.\nDoes anybody knows if it is possible?</p>\n"}, {"tags": ["c", "file", "structure"], "comments": [{"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1557329579, "post_id": 56044210, "comment_id": 98730511, "body": "The <code>*scanf()</code> functions return a value indicating the number of assignments. Use that value for error checking: <code>if (fscanf(...) != EXPECTED_ASSIGNMENTS) &#47;* report error or maybe... *&#47; exit(EXIT_FAILURE);</code>"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1557329580, "post_id": 56044210, "comment_id": 98730512, "body": "Please show a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> as well as a minimal sample of the file you read. You can <a href=\"https://stackoverflow.com/posts/56044210/edit\">edit</a> your question."}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1557330598, "post_id": 56044210, "comment_id": 98731053, "body": "Questions seeking debugging help (&quot;why isn&#39;t this code working?&quot;) must include the desired behavior, a specific problem or error and the shortest code necessary <b>to reproduce it, that includes input files</b>, in the question itself. Questions without a clear problem statement are not useful to other readers. See: How to create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}], "answers": [{"comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1557329598, "post_id": 56044268, "comment_id": 98730527, "body": "There may be more bugs though...."}, {"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1557329752, "post_id": 56044268, "comment_id": 98730612, "body": "@Jabberwocky I agree, this bug I thought should be highlighted without <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}], "tags": [], "owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "is_accepted": false, "score": 3, "last_activity_date": 1557329628, "last_edit_date": 1557329628, "creation_date": 1557329576, "answer_id": 56044268, "question_id": 56044210, "link": "https://stackoverflow.com/questions/56044210/how-can-i-read-data-from-file-i-cant-fix-it/56044268#56044268", "title": "How can I read data from file ? I can&#39;t fix it", "body": "<p>As of now you are closing the <code>file</code> immediately after reading each time.</p>\n\n<pre><code>    fscanf(fin, \"Class Number : %d\\nStudent Name : %s %s Student Number : %d Student Score : %d\\n\\nClass Average is : %f\",&amp;x.classNum, &amp;x.Name, &amp;x.Surname, &amp;x.StudentNumber, &amp;x.EnglishScore, &amp;x.average);\n\n   fclose(fin)\n</code></pre>\n\n<p>Then you try to use same <code>FILE</code> pointer to read in causing undefined behavior.</p>\n\n<hr>\n\n<p>Close the File only after you finished your processing.</p>\n"}], "owner": {"reputation": 11, "user_id": 11426167, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2232225960cb86b033db06f7676a6cf0?s=128&d=identicon&r=PG&f=1", "display_name": "Cansu Dursun", "link": "https://stackoverflow.com/users/11426167/cansu-dursun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "closed_date": 1557330677, "answer_count": 1, "score": -2, "last_activity_date": 1557329628, "creation_date": 1557329381, "question_id": 56044210, "link": "https://stackoverflow.com/questions/56044210/how-can-i-read-data-from-file-i-cant-fix-it", "closed_reason": "Not suitable for this site", "title": "How can I read data from file ? I can&#39;t fix it", "body": "<p>I record students informations to txt file but when I want to read data's from file \njust read information's in the first row. Also I calculate the average of the students but when \u0131 want to read average it's not working.</p>\n\n<pre><code>    FILE *fout;\nfout = fopen(\"English Class.txt\",\"w\"); \n\nprintf(\"Please enter student number of class : \");\nscanf(\"%d\", &amp;x.classNum);\n\nfprintf(fout, \"Class Number : %d\\n\",x.classNum);\n\nfor(i=0; i&lt;x.classNum; i++){\n\n    printf(\"Please Enter %d.Student Name : \",i+1);\n    scanf(\"%s\",&amp;x.Name);\n\n    printf(\"Please Enter %d.Student Surname : \",i+1);\n    scanf(\"%s\",&amp;x.Surname);\n\n    printf(\"Please Enter %d.Student Number : \",i+1);\n    scanf(\"%d\",&amp;x.StudentNumber);\n\n    printf(\"Please Enter %d.Student Score : \",i+1);\n    scanf(\"%d\",&amp;x.EnglishScore);\n\n    x.total = x.total + x.EnglishScore;\n\n    fprintf(fout, \"\\nStudent Name : %s %s Student Number : %d Student Score : %d\\n\", x.Name, x.Surname, x.StudentNumber, x.EnglishScore);\n }\n\nx.average = x.total / x.classNum;\n\nfprintf(fout, \"\\n\\nClass Average is : %f\", x.average);\n\nfclose(fout);   \n</code></pre>\n\n<p>I get students records from top code</p>\n\n<pre><code>        FILE *fin;\n    fin = fopen(\"English Class.txt\",\"r\");\n\n\n    fscanf(fin, \"Class Number : %d\\nStudent Name : %s %s Student Number : %d Student Score : %d\\n\\nClass Average is : %f\",&amp;x.classNum, &amp;x.Name, &amp;x.Surname, &amp;x.StudentNumber, &amp;x.EnglishScore, &amp;x.average);\n    fclose(fin);            \n\n\n    printf(\"Class Number : %d\\n\", x.classNum);\n\n    for(i=0; i&lt;x.classNum; i++){\n\n    fscanf(fin, \"\\nStudent Name : %s %s Student Number : %d Student Score : %d\\n\\nClass Average is : %f\", &amp;x.Name, &amp;x.Surname, &amp;x.StudentNumber, &amp;x.EnglishScore);\n    fclose(fin);    \n\n    printf(\"\\nStudent Name : %s %s Student Number : %d Student Score : %d\\n\", x.Name, x.Surname, x.StudentNumber, x.EnglishScore);  \n\n    }\n\n    printf(\"\\n\\nClass Average is : %f\", x.average);\n</code></pre>\n"}, {"tags": ["c", "assembly", "x86"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1557328698, "post_id": 56043897, "comment_id": 98730004, "body": "Because that&#39;s the way the processor works. In assembly you cannot move anything anywhere, there are strict rules. Every processor typo has different rules."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 2, "creation_date": 1557328988, "post_id": 56043897, "comment_id": 98730174, "body": "Ironic, @Jabberwocky: I think you mean &quot;Every processor <i>type</i> has different rules.&quot;"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1557329064, "post_id": 56043897, "comment_id": 98730226, "body": "@JohnBollinger too late for editing. indeed the <i>o</i>  in <i>typo</i>  is a typo ;-)"}, {"owner": {"reputation": 35113, "user_id": 3826372, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P0peM.png?s=128&g=1", "display_name": "Ross Ridge", "link": "https://stackoverflow.com/users/3826372/ross-ridge"}, "edited": false, "score": 3, "creation_date": 1557334791, "post_id": 56043897, "comment_id": 98732935, "body": "Just use the <code>GetCurrentProcessId</code> function. There&#39;s no need to use inline assembly or to play around with undocumented Windows internal structures."}], "answers": [{"comments": [{"owner": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 1, "creation_date": 1557330383, "post_id": 56044262, "comment_id": 98730947, "body": "If you write conforming (and this is harder than it appears) inline assembly with GCC what kind of bugs are you referring to? Generally speaking the bugs are almost exclusively a misuse of inline assembly that lead to undefined behavior. Undefined behavior can manifest itself differently across compilers and compiler options. If you properly understand all the rules (and there are a lot) for GCC inline assembly it does work as expected."}, {"owner": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 0, "creation_date": 1557330470, "post_id": 56044262, "comment_id": 98730986, "body": "I do prefer compiler intrinsics over external assembly or inline assembly when available. with MSVC I&#39;d consider utilizing intrinsics like __readfsbyte, __readfsdword, __readfsqword, __readfsword if needing to reference data through the FS segment"}, {"owner": {"reputation": 119, "user_id": 6554099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d42061f322b29fb0ac74e30d8f7ed0f?s=128&d=identicon&r=PG&f=1", "display_name": "DNS_Jeezus", "link": "https://stackoverflow.com/users/6554099/dns-jeezus"}, "edited": false, "score": 0, "creation_date": 1557331058, "post_id": 56044262, "comment_id": 98731274, "body": "Thanks for the heads up on ebx and the other tips. i didnt know that. im gonna read up more on x86"}, {"owner": {"reputation": 8402, "user_id": 4664415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hsfxj.jpg?s=128&g=1", "display_name": "mevets", "link": "https://stackoverflow.com/users/4664415/mevets"}, "edited": false, "score": 0, "creation_date": 1557409418, "post_id": 56044262, "comment_id": 98761904, "body": "The rules for GCC inline assembly have changed over the years, particularly in pinning down what volatile means.   That isn&#39;t a slight against GCC, more against the standards group.  With LTO now inspecting the opcodes to determine the critical ordering, there could be another coming.   I recall some version of the ppc code generator requiring a fake 256 byte local variable to get it to believe that &quot;memory&quot; actually meant &quot;memory&quot;."}], "tags": [], "owner": {"reputation": 8402, "user_id": 4664415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hsfxj.jpg?s=128&g=1", "display_name": "mevets", "link": "https://stackoverflow.com/users/4664415/mevets"}, "is_accepted": false, "score": 2, "last_activity_date": 1557329566, "creation_date": 1557329566, "answer_id": 56044262, "question_id": 56043897, "link": "https://stackoverflow.com/questions/56043897/why-cant-i-assign-the-value-of-the-pid-chunk-of-the-fs-register-to-an-unsigned/56044262#56044262", "title": "Why can&#39;t I assign the value of the PID chunk of the FS register to an unsigned int?", "body": "<p>but not this?   Because the register is being used to trampoline the value; without this trampoline, the opcode may be something like: movl -4[ebp], fs:[0x20].   You aren\u2019t out of the woods yet -- ebx is a callee-preserved register in most implementations, so by corrupting it, you would trigger an error somewhere up the call stack.   Those are particularly nasty to debug, because all traces of GetPID may be gone (stack rewritten) before the corruption is detectable.</p>\n\n<p>ok to write a function?:   my opinion is that all C or all assembly is the best: it is clearer and more maintainable.  Even with the gcc-constraints specification, inlining is a crapshoot between compiler versions and bugs within various versions.  Who wants that baked into your source?   An assembly module need only conform to the relevant ABI [ usually well published ], and provides a nice spot to say \u201c this is the machine dependent stuff \u201c.</p>\n"}, {"tags": [], "owner": {"reputation": 55767, "user_id": 219159, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/cxM6H.jpg?s=128&g=1", "display_name": "Seva Alekseyev", "link": "https://stackoverflow.com/users/219159/seva-alekseyev"}, "is_accepted": true, "score": 5, "last_activity_date": 1557330414, "creation_date": 1557330414, "answer_id": 56044505, "question_id": 56043897, "link": "https://stackoverflow.com/questions/56043897/why-cant-i-assign-the-value-of-the-pid-chunk-of-the-fs-register-to-an-unsigned/56044505#56044505", "title": "Why can&#39;t I assign the value of the PID chunk of the FS register to an unsigned int?", "body": "<p>The Intel assembly doesn't support <code>MOV</code> from memory to memory. <code>id</code> is a memory location. You can only MOV from memory to a register or vice versa.</p>\n\n<p>That said, check out the <code>__readfsdword</code> compiler intrinsic.</p>\n"}, {"tags": [], "owner": {"reputation": 33990, "user_id": 14768, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/b6aMa.png?s=128&g=1", "display_name": "Joshua", "link": "https://stackoverflow.com/users/14768/joshua"}, "is_accepted": false, "score": 0, "last_activity_date": 1557330527, "creation_date": 1557330527, "answer_id": 56044531, "question_id": 56043897, "link": "https://stackoverflow.com/questions/56043897/why-cant-i-assign-the-value-of-the-pid-chunk-of-the-fs-register-to-an-unsigned/56044531#56044531", "title": "Why can&#39;t I assign the value of the PID chunk of the FS register to an unsigned int?", "body": "<p>I found a long time ago that writing inline assmebly in <code>.c</code> files was essentially always a mistake. Rather than having a short list of obvious places you have to change when porting to a new processor, you end up with them scattered everywhere. I took the liberty of rewriting your function in a <code>.asm</code> file for you:</p>\n\n<pre><code>.486\n.MODEL FLAT\n.CODE\nPUBLIC _GetPID\n_GetPID PROC\n    mov eax, fs:[0x20]\n    ret\n_GetPID ENDP\nEND\n</code></pre>\n"}], "owner": {"reputation": 119, "user_id": 6554099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d42061f322b29fb0ac74e30d8f7ed0f?s=128&d=identicon&r=PG&f=1", "display_name": "DNS_Jeezus", "link": "https://stackoverflow.com/users/6554099/dns-jeezus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 56044505, "answer_count": 3, "score": 0, "last_activity_date": 1557330527, "creation_date": 1557328420, "last_edit_date": 1557329911, "question_id": 56043897, "link": "https://stackoverflow.com/questions/56043897/why-cant-i-assign-the-value-of-the-pid-chunk-of-the-fs-register-to-an-unsigned", "title": "Why can&#39;t I assign the value of the PID chunk of the FS register to an unsigned int?", "body": "<p>Short description (32 bit build)</p>\n\n<p>Why does this throw an improper operand error?</p>\n\n<pre><code>unsigned int GetPID() {\n\n    unsigned int id;\n    __asm {\n        mov id, fs:[0x20];\n    }\n    return id;\n</code></pre>\n\n<p>but not this?</p>\n\n<pre><code>unsigned int GetPID() {\n\n    unsigned int id;\n    __asm {\n        mov ebx, fs:[0x20];\n        mov id, ebx;\n    }\n    return id;\n}\n</code></pre>\n\n<p>I'm new to using assembly within C and I'd like some explanations on how things work when I use it. </p>\n\n<p>Note. I know using this function to get the current process id is bad. This is just an experiment, im also learning about operating systems.</p>\n\n<p>Side question: is it ok to write half of a function in assembly brackets? and then finish the function with C? or should every function be either all C or all assembly?</p>\n"}, {"tags": ["ios", "c", "executable"], "comments": [{"owner": {"reputation": 297030, "user_id": 1226963, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/yjY1E.png?s=128&g=1", "display_name": "rmaddy", "link": "https://stackoverflow.com/users/1226963/rmaddy"}, "edited": false, "score": 0, "creation_date": 1557328602, "post_id": 56043829, "comment_id": 98729942, "body": "If the .o was built for the appropriate ARM processors you might be able to link the .o into the final executable. But iOS apps can&#39;t normally launch other executables due to sandboxing restrictions."}, {"owner": {"reputation": 156, "user_id": 6747276, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8489d82b10b645b84bca2d84fd1cc375?s=128&d=identicon&r=PG&f=1", "display_name": "ppablo", "link": "https://stackoverflow.com/users/6747276/ppablo"}, "reply_to_user": {"reputation": 297030, "user_id": 1226963, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/yjY1E.png?s=128&g=1", "display_name": "rmaddy", "link": "https://stackoverflow.com/users/1226963/rmaddy"}, "edited": false, "score": 0, "creation_date": 1557329275, "post_id": 56043829, "comment_id": 98730337, "body": "Thanks for the reply @rmaddy. I guess that the simplest way to make it work is to include the c code in the app project"}], "answers": [{"tags": [], "owner": {"reputation": 424, "user_id": 1255271, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e89a1954bc8b308a8d4dd329c6b4562c?s=128&d=identicon&r=PG", "display_name": "stewartmcgown", "link": "https://stackoverflow.com/users/1255271/stewartmcgown"}, "is_accepted": false, "score": 0, "last_activity_date": 1557330985, "creation_date": 1557330985, "answer_id": 56044682, "question_id": 56043829, "link": "https://stackoverflow.com/questions/56043829/running-a-compiled-c-program-or-o-in-an-ios-app/56044682#56044682", "title": "Running a compiled c program (or .o) in an iOS app?", "body": "<p>You have to include a header file with the function declaration and link the .c file. ie, <code>#include headerfile.h</code> in the class you need.</p>\n"}], "owner": {"reputation": 156, "user_id": 6747276, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8489d82b10b645b84bca2d84fd1cc375?s=128&d=identicon&r=PG&f=1", "display_name": "ppablo", "link": "https://stackoverflow.com/users/6747276/ppablo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1557330985, "creation_date": 1557328201, "last_edit_date": 1557328609, "question_id": 56043829, "link": "https://stackoverflow.com/questions/56043829/running-a-compiled-c-program-or-o-in-an-ios-app", "title": "Running a compiled c program (or .o) in an iOS app?", "body": "<p>I have a program written in c that I want to run in an iOS app. The program takes as parameters a path to an image, processes it and outputs another image in a provided location. I have the .o file and the compiled executable. Is it possible to include one of those in the app? If yes, how?</p>\n"}, {"tags": ["c", "windows", "console"], "comments": [{"owner": {"reputation": 252, "user_id": 5364211, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ixqyo.jpg?s=128&g=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/5364211/tom"}, "edited": false, "score": 0, "creation_date": 1557328233, "post_id": 56043805, "comment_id": 98729699, "body": "You haven&#39;t included the picture"}, {"owner": {"reputation": 65, "user_id": 6421599, "user_type": "registered", "profile_image": "https://graph.facebook.com/1088458847859121/picture?type=large", "display_name": "Bugale Bugalit", "link": "https://stackoverflow.com/users/6421599/bugale-bugalit"}, "reply_to_user": {"reputation": 252, "user_id": 5364211, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ixqyo.jpg?s=128&g=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/5364211/tom"}, "edited": false, "score": 0, "creation_date": 1557330059, "post_id": 56043805, "comment_id": 98730772, "body": "Both pictures are inside the post"}, {"owner": {"reputation": 149, "user_id": 11175208, "user_type": "registered", "profile_image": "https://graph.facebook.com/2283141461942567/picture?type=large", "display_name": "Ilya  Pakhmutov", "link": "https://stackoverflow.com/users/11175208/ilya-pakhmutov"}, "edited": false, "score": 0, "creation_date": 1557336277, "post_id": 56043805, "comment_id": 98733673, "body": "Do you create a console buffer for that? Or is it a separate program from cmd?"}, {"owner": {"reputation": 65, "user_id": 6421599, "user_type": "registered", "profile_image": "https://graph.facebook.com/1088458847859121/picture?type=large", "display_name": "Bugale Bugalit", "link": "https://stackoverflow.com/users/6421599/bugale-bugalit"}, "edited": false, "score": 0, "creation_date": 1557418473, "post_id": 56043805, "comment_id": 98767295, "body": "Just a simple console application in visual studio"}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 1, "creation_date": 1557658077, "post_id": 56043805, "comment_id": 98831952, "body": "Please, you don&#39;t include any code, and the question is not about programming at all (just on how the windows console application works)  Please, edit the question to reflect what you are doing, the expected response and the actual received response.  See <a href=\"https://stackoverflow.com/help/mcve\">How to create a Minimal, Complete, and Verifiable example</a> for details."}, {"owner": {"reputation": 65, "user_id": 6421599, "user_type": "registered", "profile_image": "https://graph.facebook.com/1088458847859121/picture?type=large", "display_name": "Bugale Bugalit", "link": "https://stackoverflow.com/users/6421599/bugale-bugalit"}, "edited": false, "score": 0, "creation_date": 1557745712, "post_id": 56043805, "comment_id": 98855759, "body": "I added a code example."}], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 6421599, "user_type": "registered", "profile_image": "https://graph.facebook.com/1088458847859121/picture?type=large", "display_name": "Bugale Bugalit", "link": "https://stackoverflow.com/users/6421599/bugale-bugalit"}, "edited": false, "score": 0, "creation_date": 1557418518, "post_id": 56047257, "comment_id": 98767321, "body": "The data is not static of course, it is coming from another application. I just want the cursor to always be after the current character. To output newline, I would have to count characters and write it at the end of the line, which is even worse than just adding &quot; \\b&quot; after every printf."}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1557658264, "post_id": 56047257, "comment_id": 98832004, "body": "Many windows libraries automatically insert the <code>\\r</code> before a <code>\\n</code> if you mark the <code>FILE *</code> pointer as text, just to ensure portability with UNIX environments.  Your recommendation is useless anyway, as the question is not about C programming as tagged.  We have seen no code at all."}], "tags": [], "owner": {"reputation": 1247, "user_id": 388398, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9bd10eedb6c17c1604a7cadefed6b02?s=128&d=identicon&r=PG", "display_name": "Jon Guiton", "link": "https://stackoverflow.com/users/388398/jon-guiton"}, "is_accepted": false, "score": 0, "last_activity_date": 1557341434, "creation_date": 1557341434, "answer_id": 56047257, "question_id": 56043805, "link": "https://stackoverflow.com/questions/56043805/how-to-make-windows-console-cursor-jump-to-next-line-at-the-end-of-the-line/56047257#56047257", "title": "How to make Windows console cursor jump to next line at the end of the line", "body": "<p>In windows the end of line is represented as \"\\r\\n\" not (as in unix) \"\\n\". The \\r is a carriage return and the \\n is a newline. So emitting \"\\r\\n\" for a newline should solve your problem. </p>\n\n<p><a href=\"https://en.wikipedia.org/wiki/Newline\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/Newline</a></p>\n"}, {"tags": [], "owner": {"reputation": 65, "user_id": 6421599, "user_type": "registered", "profile_image": "https://graph.facebook.com/1088458847859121/picture?type=large", "display_name": "Bugale Bugalit", "link": "https://stackoverflow.com/users/6421599/bugale-bugalit"}, "is_accepted": true, "score": 1, "last_activity_date": 1557927771, "creation_date": 1557927771, "answer_id": 56150880, "question_id": 56043805, "link": "https://stackoverflow.com/questions/56043805/how-to-make-windows-console-cursor-jump-to-next-line-at-the-end-of-the-line/56150880#56150880", "title": "How to make Windows console cursor jump to next line at the end of the line", "body": "<p>I found the solution:\n<a href=\"https://docs.microsoft.com/en-us/windows/console/setconsolemode\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/windows/console/setconsolemode</a></p>\n\n<p>The flag DISABLE_NEWLINE_AUTO_RETURN seems to be enabled by default in VS.</p>\n"}], "owner": {"reputation": 65, "user_id": 6421599, "user_type": "registered", "profile_image": "https://graph.facebook.com/1088458847859121/picture?type=large", "display_name": "Bugale Bugalit", "link": "https://stackoverflow.com/users/6421599/bugale-bugalit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 637, "favorite_count": 0, "accepted_answer_id": 56150880, "answer_count": 2, "score": 2, "last_activity_date": 1557927771, "creation_date": 1557328136, "last_edit_date": 1557746186, "question_id": 56043805, "link": "https://stackoverflow.com/questions/56043805/how-to-make-windows-console-cursor-jump-to-next-line-at-the-end-of-the-line", "title": "How to make Windows console cursor jump to next line at the end of the line", "body": "<p>I am having problems with a terminal emulator I am working on, and I have managed to narrow down the problem to a weird cursor behavior in the Windows console.\nIn a regular cmd, when you write character exactly to the end of the line, the cursor jumps to the next line. (See below picture)\n<img src=\"https://i.imgur.com/4RL3iBs.png\" alt=\"cmd cursor behavior\"></p>\n\n<p>When I try to achieve the same with printf in a program I write, the cursor stays on the same character. (See below picture)\n<img src=\"https://i.imgur.com/wJbuOhP.png\" alt=\"cmd cursor behavior\"></p>\n\n<p>I have managed to achieve the \"cmd-like\" result by printing the hacky <code>\" \\b\"</code>, but I am trying to find a better way to do that (i.e., the first character at the next line might be meaningful, and I don't want to erase it. Reading that character would of course not be elegant).</p>\n\n<p>I am looking for a way to make that happen automatically. Some configuration of the console maybe?\nDoes anybody here have any idea how to do that?</p>\n\n<p>A code example (assuming the console has a default size of 80):</p>\n\n<pre><code>int main() {\n    printf(\"12345678901234567890123456789012345678901234567890123456789012345678901234567890\");\n    fflush(stdout);\n    getc();\n    return 0;\n} \n</code></pre>\n\n<p>If you run this code, after the print, the cursor will stay on the character 0 at the end of the line. \nMy question is how to make the cursor appear on the beginning of the next line, without changing the hard coded string. </p>\n"}, {"tags": ["html", "c", "server", "output"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1557328044, "post_id": 56043688, "comment_id": 98729565, "body": "libcurl provides an API for making HTTP requests and receiving the corresponding responses.  You can implement what you need of that directly, instead, but if you&#39;re asking for details then that&#39;s far too broad a question."}, {"owner": {"reputation": 293, "user_id": 7177271, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-8EkKHDl-kgU/AAAAAAAAAAI/AAAAAAAAABY/x2USaUE1k-o/photo.jpg?sz=128", "display_name": "Bret Hasel", "link": "https://stackoverflow.com/users/7177271/bret-hasel"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1557328201, "post_id": 56043688, "comment_id": 98729680, "body": "I&#39;m asking to do this without libcurl. All im asking really is how to pull that URL out and place it into a variable to be able to tokenize it for use."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1557328840, "post_id": 56043688, "comment_id": 98730077, "body": "I&#39;m sorry, but I&#39;m having a lot of difficulty following what you&#39;re asking.  libcurl provides an HTTP <i>client</i>.  I understand that you don&#39;t want to use it, but inasmuch as you&#39;ve asked for an alternative to libcurl, the answer is some variation on &quot;implement your own HTTP client&quot;.  On the other hand, you have presented code for an HTTP <i>server</i>.  It&#39;s unclear how that factors in at all.  Overall, what are you trying to parse, and where?  An HTTP request, on the server (for which libcurl isn&#39;t relevant anyway)?  An HTTP response, on the client?  Something else?"}, {"owner": {"reputation": 293, "user_id": 7177271, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-8EkKHDl-kgU/AAAAAAAAAAI/AAAAAAAAABY/x2USaUE1k-o/photo.jpg?sz=128", "display_name": "Bret Hasel", "link": "https://stackoverflow.com/users/7177271/bret-hasel"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1557329028, "post_id": 56043688, "comment_id": 98730200, "body": "I apologize for the confusing question i suppose i just made sense in my head but perhaps thats a piece of my problem. What i am trying to do with my HTTP server which runs strictly on localhost:3838 and when run has a text box, when you type in this text box a command like ls it then brings you to a URL of <code>localhost:3838&#47;run?command=ls</code> what i am asking is how can i pull that URL out and place it into a variable. The rest i can figure out and do myself But in essence i am then going to pull the <code>ls</code> portion out and plug it into execvp and then plug that output back into the server to display"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1557329374, "post_id": 56043688, "comment_id": 98730396, "body": "The lack of clarity seems to arise at least in part because you are not clearly distinguishing between the role of the server and the role of its clients.  I will see what I can do to clear that up."}, {"owner": {"reputation": 293, "user_id": 7177271, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-8EkKHDl-kgU/AAAAAAAAAAI/AAAAAAAAABY/x2USaUE1k-o/photo.jpg?sz=128", "display_name": "Bret Hasel", "link": "https://stackoverflow.com/users/7177271/bret-hasel"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1557329479, "post_id": 56043688, "comment_id": 98730457, "body": "thank you! i appreciate the help!"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1557330004, "post_id": 56043688, "comment_id": 98730735, "body": "Ok, have a look at that and make sure I have captured your question accurately."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1557330035, "post_id": 56043688, "comment_id": 98730756, "body": "I already pointed out in your <a href=\"https://stackoverflow.com/questions/56022754/server-displaying-text-instead-of-html?noredirect=1#comment98690433_56022754\">previous question</a> that sending a fixed size that is longer than your content does not make much sense. Now you still send a size unrelated to the length and on top you also send some uninitialized memory content. Also as John Bollinger already mentioned, please clearly distinguish server from client."}, {"owner": {"reputation": 293, "user_id": 7177271, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-8EkKHDl-kgU/AAAAAAAAAAI/AAAAAAAAABY/x2USaUE1k-o/photo.jpg?sz=128", "display_name": "Bret Hasel", "link": "https://stackoverflow.com/users/7177271/bret-hasel"}, "edited": false, "score": 0, "creation_date": 1557330194, "post_id": 56043688, "comment_id": 98730856, "body": "Yes it correctly captures my question. and the uninitalized memory content was a placeholder i was hoping i could change to send in the commands information once i had done the parsing before hand."}, {"owner": {"reputation": 293, "user_id": 7177271, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-8EkKHDl-kgU/AAAAAAAAAAI/AAAAAAAAABY/x2USaUE1k-o/photo.jpg?sz=128", "display_name": "Bret Hasel", "link": "https://stackoverflow.com/users/7177271/bret-hasel"}, "edited": false, "score": 0, "creation_date": 1557330283, "post_id": 56043688, "comment_id": 98730902, "body": "The issue of memory can be fixed and doesnt exactly pertain to my question or issue though does it ?"}, {"owner": {"reputation": 293, "user_id": 7177271, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-8EkKHDl-kgU/AAAAAAAAAAI/AAAAAAAAABY/x2USaUE1k-o/photo.jpg?sz=128", "display_name": "Bret Hasel", "link": "https://stackoverflow.com/users/7177271/bret-hasel"}, "edited": false, "score": 0, "creation_date": 1557331235, "post_id": 56043688, "comment_id": 98731358, "body": "Turns out the answer was as simple as making a recv, placing that into a variable and now i need to figure out the tokenizing and parsing it out but that shouldnt be too bad."}], "answers": [{"comments": [{"owner": {"reputation": 293, "user_id": 7177271, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-8EkKHDl-kgU/AAAAAAAAAAI/AAAAAAAAABY/x2USaUE1k-o/photo.jpg?sz=128", "display_name": "Bret Hasel", "link": "https://stackoverflow.com/users/7177271/bret-hasel"}, "edited": false, "score": 0, "creation_date": 1557331852, "post_id": 56044776, "comment_id": 98731618, "body": "thank you! Very informative. Im currently on the step where i have <code>run?command=ls</code> separated so now its just separating the last portion and then parsing the command and then its just sending the command to display, thank you!"}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 2, "last_activity_date": 1557331301, "creation_date": 1557331301, "answer_id": 56044776, "question_id": 56043688, "link": "https://stackoverflow.com/questions/56043688/how-to-get-the-url-from-a-localhost-server-without-using-libcurl/56044776#56044776", "title": "How to get the URL from a localhost server without using libcurl", "body": "<p>Web servers and clients communicate via the HTTP protocol.  That's what makes them <em>web</em> servers as opposed to some other kind.  HTTP is a request / response protocol: the client sends a request to the server <em>that contains information about what it's requesting</em>, and the server processes that request to determine how to respond.</p>\n\n<p>Your particular server seems to intend to implement <a href=\"https://www.w3.org/Protocols/rfc2616/rfc2616.html\" rel=\"nofollow noreferrer\">HTTP 1.1</a>. This is not the most recent version of the protocol, but that's ok.  Pretty much every HTTP client in the world understands that dialect.  But yours is a pretty minimally-functioning server, responding to every established connection with the same HTTP response, even if the client does not actually send an HTTP request.</p>\n\n<p>Your question is how to get the request URI.  The answer is to <em>read</em> it from the client, via the connected socket returned by <code>accept()</code>.  The <code>read()</code> or <code>recv()</code> function would be appropos for that.  The format you should expect the client to use is described in the HTTP specifications I linked above, but in <em>very</em> brief, you should expect the request to start with the request method name (<code>GET</code>), at least one space, the request URI, and a carriage-return / linefeed pair.  You will need to parse the request URI to distinguish between an initial request for the form and a form submission, and in the latter case you will be able to parse the query parameters as well.</p>\n\n<p>DO NOTE, however, that although HTTP is a comparatively simple protocol, it is still much more complicated than I've just described.</p>\n"}], "owner": {"reputation": 293, "user_id": 7177271, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-8EkKHDl-kgU/AAAAAAAAAAI/AAAAAAAAABY/x2USaUE1k-o/photo.jpg?sz=128", "display_name": "Bret Hasel", "link": "https://stackoverflow.com/users/7177271/bret-hasel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 56044776, "answer_count": 1, "score": 0, "last_activity_date": 1557331301, "creation_date": 1557327764, "last_edit_date": 1557329975, "question_id": 56043688, "link": "https://stackoverflow.com/questions/56043688/how-to-get-the-url-from-a-localhost-server-without-using-libcurl", "title": "How to get the URL from a localhost server without using libcurl", "body": "<p>I've made a custom HTTP server that serves an HTML page with some text, an input text box for entering a command, and a submit button.  Upon receiving a form submission, the server is supposed to run the given command and serve a response containing the results.</p>\n\n<p>The issue I cant quite figure out is how to get the URLs of form submission requests so as to parse out the command to run.  As presently implemented, the server runs on localhost:3838, and when the client browses to that URL the server responds correctly with the form.  When the user enters (say) the command <code>ls</code> in the text box and clicks the \"run\" submission button, a request is issued to <code>localhost:3838/run?command=ls</code>. How can I obtain that URL in the server, so as to parse out and execute the command?</p>\n\n<p>Here's the present server code:</p>\n\n<p><strong>CwebServer.c</strong></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;string.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;netinet/in.h&gt;\n#include &lt;netdb.h&gt;\n#include &lt;arpa/inet.h&gt;\n#include &lt;sys/wait.h&gt;\n#include &lt;signal.h&gt;\n\n#define PORT \"3838\" //port being connected to \n#define MAXLEN 800\n#define BACKLOG 10 //number of pending connections to be held in queue\n\n//format of html page \n\nchar header []= \n\"HTTP/1.1 200 Ok\\r\\n\"\n\"Content-Type: text/html; charset=UTF-8\\r\\n\\r\\n\"\n\"&lt;!DOCTYPE html&gt;\\r\\n\"\n\"&lt;html&gt;\\n\"\n\"&lt;head&gt;\\n\"\n\"&lt;title&gt;Web-Based Remote Command Server&lt;/title&gt;\\r\\n\"\n\"&lt;/head&gt;\\n\"\n\"&lt;body&gt;\\n\\n\";\nchar input []=\n\"&lt;form action= \\\"/run\\\" method= \\\"GET\\\"&gt; \\n\"\n\"Command: &lt;input type=\\\"text\\\" size=\\\"100\\\" name=\\\"command\\\"&gt;\\n\"\n\"&lt;input type=\\\"submit\\\" value=\\\"Run\\\"&gt;\\n\"\n\"&lt;/form&gt;\";\nchar output []=\n\"&lt;p&gt;Command that was run and testing this:&lt;/p&gt;\\n\"\n\"&lt;pre&gt;Your server will include the command that was just run here.&lt;/pre&gt;\\n\\n\"\n\"&lt;p&gt;Standard Output:&lt;/p&gt;\\n\"\"&lt;pre&gt;Your server will include the stdout results here.&lt;/pre&gt;\\n\\n\"\n\"&lt;p&gt;Standard Error:&lt;/p&gt;\\n\"\n\"&lt;pre&gt;Your server will include the stderr results here.&lt;/pre&gt;\\r\\n\\r\\n\"\n\"&lt;/body&gt;\\r\\n\"\"&lt;/html&gt;\\r\\n\";\n\nchar *buff = header; \n\nvoid sigchld_handler(int s)\n{\n    (void)s; // quiet unused variable warning\n\n    // waitpid() might overwrite errno, so we save and restore it:\n    int saved_errno = errno;\n\n    while(waitpid(-1, NULL, WNOHANG) &gt; 0);\n\n    errno = saved_errno;\n}\n\n\nvoid *get_in_addr(struct sockaddr *sa)\n{\n    if (sa-&gt;sa_family == AF_INET) {\n        return &amp;(((struct sockaddr_in*)sa)-&gt;sin_addr);\n    }\n\n    return &amp;(((struct sockaddr_in6*)sa)-&gt;sin6_addr);\n}\n\n\nint main (void){\n    int sockfd;\n    int new_fd; \n    struct addrinfo hints;\n    struct addrinfo *serverinfo; \n    struct addrinfo *p;\n    struct sockaddr_storage client_addr;\n    socklen_t addrsize;\n    struct sigaction sa;\n    int yes = 1;\n    char s[INET6_ADDRSTRLEN];\n    int status;\n\n    memset(&amp;hints, 0, sizeof hints); //makes struct empty \n    hints.ai_family = AF_UNSPEC; //IPv4 or v6 \n    hints.ai_socktype = SOCK_STREAM; //TCP type need \n    hints.ai_flags = AI_PASSIVE; //Fill in IP for us \n\n\n    //if can't get address info print error \n    if((status = getaddrinfo(NULL, PORT, &amp;hints, &amp;serverinfo)) != 0){\n        fprintf(stderr, \"getaddrinfo: %s\\n\", gai_strerror(status));\n        return 1;\n    }\n\n\n    for(p = serverinfo; p != NULL; p = p-&gt;ai_next){\n        if((sockfd = socket(p-&gt;ai_family, p-&gt;ai_socktype, p-&gt;ai_protocol)) == -1){\n            perror(\"server: socket\");\n            continue;\n        }\n\n        if(setsockopt(sockfd, SOL_SOCKET, SO_REUSEADDR, &amp;yes, sizeof(int)) == -1){\n            perror(\"setsockopt\");\n            exit(1);\n        }\n\n        if(bind(sockfd, p-&gt;ai_addr, p-&gt;ai_addrlen) == -1){\n            close(sockfd);\n            perror(\"server: bind\");\n            continue;\n        }\n\n        break;\n    }\n\n    freeaddrinfo(serverinfo);\n\n    if(p == NULL){\n        fprintf(stderr, \"server: failed to bind\\n\");\n        exit(1);\n    }\n\n    if(listen(sockfd, BACKLOG) == -1){\n        perror(\"listen\");\n        exit(1);\n    }\n\n    sa.sa_handler = sigchld_handler; // reap all dead processes\n    sigemptyset(&amp;sa.sa_mask);\n    sa.sa_flags = SA_RESTART;\n    if (sigaction(SIGCHLD, &amp;sa, NULL) == -1) {\n        perror(\"sigaction\");\n        exit(1);\n    }\n\n    printf(\"server: waiting for connections....\\n\");\n\n    while(1){\n        addrsize = sizeof client_addr;\n        new_fd = accept(sockfd, (struct sockaddr *)&amp;client_addr, &amp;addrsize);\n        if(new_fd == -1){\n            perror(\"Did not accept\");\n            continue;\n        }\n\n        inet_ntop(client_addr.ss_family, get_in_addr((struct sockaddr *)&amp;client_addr), s, sizeof s);\n        printf(\"server: got connection from %s\\n\", s);\n\n        if(!fork()){\n            close(sockfd);\n            int bufsize = 1024;\n            char *buffer = malloc(bufsize);\n            send(new_fd, header, bufsize, 0);\n            //write(new_fd, \"HTTP/1.1 200 OK\\n\", 16);\n            //write(new_fd, \"Content-length: 46\\n\", 19);\n            //write(new_fd, \"Content-type: text/html\\n\\n\", 25);\n            //write(new_fd, \"&lt;html&gt;&lt;head&gt;\\n&lt;head&gt;\\n&lt;title&gt;The CAvengers Web Page&lt;/title&gt;\\n&lt;/head&gt;\\n&lt;/html&gt;\", 46);\n\n            if(send(new_fd, buffer, MAXLEN, 0) == -1)\n                perror(\"send\");\n            close(new_fd);\n            exit(0);\n        }\n        close(new_fd);\n    }\n\n    return 0;\n\n\n}\n</code></pre>\n"}, {"tags": ["c", "string", "scanf", "ascii"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "is_accepted": false, "score": 3, "last_activity_date": 1557332698, "last_edit_date": 1557332698, "creation_date": 1557329874, "answer_id": 56044347, "question_id": 56043682, "link": "https://stackoverflow.com/questions/56043682/scanf-in-visual-studio-not-accepting-multiple-cases-of-characters/56044347#56044347", "title": "Scanf in visual studio not accepting multiple cases of characters", "body": "<p>I'm not sure what confuses you.</p>\n\n<p>Use</p>\n\n<pre><code>char foo;\nscanf(\" %c\", &amp;foo);\n</code></pre>\n\n<p>for single characters, eg. letters and</p>\n\n<pre><code>int bar;\nscanf(\"%d\", &amp;bar);\n</code></pre>\n\n<p>for numbers, integers. If you type a letter instead, <code>scanf()</code> will fail.</p>\n\n<p><code>%[...]</code> is for strings.</p>\n\n<p><code>scanf()</code> returns the number of successful conversions (or <code>EOF</code>), so for</p>\n\n<pre><code>int height;\nint width;\nscanf(\"%d %d\", &amp;height, &amp;width);\n</code></pre>\n\n<p>it returns <code>2</code> if successful. It might return <code>1</code> if only <code>height</code> could be read.</p>\n\n<p>So to check for errors on user input you should do:</p>\n\n<pre><code>int height;\nint width;\nif (scanf(\"%d %d\", &amp;height, &amp;width) != 2) {\n    // handle the error, maybe exit the program.\n}\n</code></pre>\n\n<p>Your code could look like that (without error handling):</p>\n\n<pre><code>#define _CRT_SECURE_NO_WARNINGS  // you said Visual Studio? Without it you should get\n                                 // warnings about some functions being insecure.\n\n#include &lt;ctype.h&gt;   // isalpha()  returns true if the value is a letter\n#include &lt;stdlib.h&gt;  // EXIT_SUCCESS\n#include &lt;stdio.h&gt;   // puts(), printf(), scanf()\n\nint main(void)\n{\n    for(;;) {  // for-ever ... endless loop since the user exits by answering\n               // 'n' or 'N' two times\n\n        puts(\"Would you like to convert a number today?\\nPlease press Y or N:\");\n        char input;\n        if (scanf(\" %c\", &amp;input) != 1)  // We reached EOF ... end of file\n            break;                      // that's improbable for stdin,\n                                        // but input could be redirected to\n                                        // read from a file instead.\n\n        if (input == 'y' || input == 'Y') {\n            puts(\"\\nThank you!\\nWhat number?\");\n            int number;\n            scanf(\"%d\", &amp;number);\n\n            if (isalpha((char unsigned)number))  // *)\n                printf(\"\\nYour Number \\t ASCII letter\\n%d\\t %c\\n\\n\", number, number);\n            else\n                puts(\"Sorry, but that's not the ASCII code of a letter :(\\n\");\n        }\n        else if (input == 'n' || input == 'N') {\n            puts(\"\\nWould you like to convert a letter instead?\\nPlease press Y or N:\");\n            scanf(\" %c\", &amp;input);\n\n            if (input == 'y' || input == 'Y') {\n                puts(\"\\nGreat choice adventurer!\\nWhat letter will it be today?\");\n                char letter;\n                scanf(\" %c\", &amp;letter);\n\n                if (isalpha(letter))\n                    printf(\"\\nYour letter \\t ASCII code\\n%d\\t %c\\n\\n\", letter, letter);\n                else\n                    puts(\"Sorry, but that's not a letter :(\\n\");\n            }\n            else if (input == 'n' || input == 'N') {\n                puts(\"\\nDifficult to please, I see...\\n\\nI suggest you move on with that attitude!\\n\");\n                puts(\"Bye bye then.\");\n                return EXIT_SUCCESS;\n            }\n        }\n        else {\n            puts(\"Sorry I did not recognize your command... Please retry.\");\n            puts(\"Press Y or N next time!\\n\");\n        }\n    }\n}\n</code></pre>\n\n<p>*) <code>isalpha()</code> (and the other functions in <a href=\"https://en.cppreference.com/w/cpp/header/cctype\" rel=\"nofollow noreferrer\"><code>&lt;ctype.h&gt;</code></a>) expects a value that fits in a <code>unsigned char</code> or the value <code>EOF</code>. It has undefined behaviour for other values. Since we read user input into an <code>int</code> we cannot be sure that's the case so we have to cast the value to <code>unsigned char</code> before passing it to <code>isalpha()</code> (and friends).</p>\n\n<p>Next time you ask a question please include your full code, including variable declarations, functions like <code>test()</code> and <code>conversion()</code> and <code>#include</code>s. But please, post an example that focuses on your problem at hand. All that dialog you included would not have been necessary.</p>\n"}], "owner": {"reputation": 9, "user_id": 11470780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf0532315e6c1115eab37a17f35f5e1d?s=128&d=identicon&r=PG&f=1", "display_name": "idkhowtocodeplshelp", "link": "https://stackoverflow.com/users/11470780/idkhowtocodeplshelp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 197, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1557332698, "creation_date": 1557327747, "last_edit_date": 1557330678, "question_id": 56043682, "link": "https://stackoverflow.com/questions/56043682/scanf-in-visual-studio-not-accepting-multiple-cases-of-characters", "title": "Scanf in visual studio not accepting multiple cases of characters", "body": "<p>I'm creating a conversion project for letters/numbers ASCII table. My code is supposed to be 'interactive', so the user would type 'y' or 'n' to answer questions on the screen. However, it doesn't want to do this twice...</p>\n\n<p>I have tried:</p>\n\n<ol>\n<li>Just trying numbers instead of characters, but it's not exactly what I want </li>\n<li>The <code>%[\\n]*c</code>, and <code>%[\\n]c</code>, and <code>%[\\n]*s</code> ... technique but it doesn't help ;-;</li>\n<li>Testing in a different project, but the only way I am able to do it is for multiple <code>scanf()</code>s to be in a row.</li>\n</ol>\n\n<p>Here is the code:</p>\n\n<pre><code>printf(\"Would you like to convert a number today? \\n\");\nprintf(\"Please press Y or N \\n\");\nscanf(\"%c\", &amp;input);\n\nif (input == 'y' || input == 'Y') { //compare input if they said 'yes'\n    printf(\"\\nThank you! \\nWhat number?\\n\");\n    scanf(\"%d\", &amp;number);\n    flag = test(number);\n    if (flag == 0) { //if there is an equivalent letter\n        letter = conversion(number); //find the equivalent letter\n        printf(\"\\nYour Number \\t ASCII letter\\n\");\n        printf(\"%d\\t %c\\n\", number, letter);\n    }\n}\nelse if (input == 'n' || input == 'N') {\n    printf(\"\\nWould you like to convert a letter instead? This time enter 0 or 1\\!\\n\\n\"); //problem here!!\n    printf(\"I wish I could say it was to \\' Spice things up \\' ...but it\\'s not ;-; \\n\\n\");\n    scanf(\"%d\", &amp;input2);\n\n    if (input2 == 0) { //this needs to be checking whether the user input Y/y\n        printf(\"Great choice adventurer!\\n\");\n        printf(\"What letter will it be today?\\n\\n\");\n\n        //..I would go to a different funtion here ie: test2(letter)...\n\n        scanf(\"%d\", &amp;number); //I showed that it worked with multiple numbers, but I can't get this to work with multiple letters\n        printf(\"%d\", number);\n    }\n\n    if (input2 == 1) { //this needs to be checking whether the user input N/n\n        printf(\"Difficult to please, I see...\\n\\n\");\n        printf(\"I suggest you move on with that attitude!\\n\\n\");\n        printf(\"Bye bye then\\n\");\n    }\n}\nelse { //if they tried to break the code\n    printf(\"Sorry I did not recognise your command...please retry\\n\");\n    printf(\"Press Y or N next time!\\n\");\n}\n</code></pre>\n\n<p>The first check works perfectly, I just want the second check to be like the first! \nSome 'solutions' caused a overflow, which I don't want <em>if possible</em> \nEven if someone could explain why this isn't working the way I intended would be very helpful! </p>\n"}, {"tags": ["c", "function"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 10, "creation_date": 1557327676, "post_id": 56043634, "comment_id": 98729361, "body": "You have a bunch of <i>nested</i> function <i>definitions</i> without a single call. Let&#39;s start from the fact that nesting functions is not allowed in standard C."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1557328143, "post_id": 56043634, "comment_id": 98729632, "body": "@EugeneSh. and, maybe that point to the need for OP to go back to a good book."}, {"owner": {"reputation": 16676, "user_id": 10147399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a6d433902192f8bb03857ae1b849d4f?s=128&d=identicon&r=PG&f=1", "display_name": "Ayxan Haqverdili", "link": "https://stackoverflow.com/users/10147399/ayxan-haqverdili"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1557328174, "post_id": 56043634, "comment_id": 98729659, "body": "@EugeneSh. How does this even <a href=\"https://gcc.godbolt.org/z/eDv0vB\" rel=\"nofollow noreferrer\">compile</a>?"}, {"owner": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "edited": false, "score": 0, "creation_date": 1557328909, "post_id": 56043634, "comment_id": 98730127, "body": "Hi Patrick.  Looks like you have the syntax down and can write functions, but you are struggling with some fairly fundamental concepts in calling functions.  I would recommend a <a href=\"https://stackoverflow.com/questions/562303/the-definitive-c-book-guide-and-list\">good book</a>"}, {"owner": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "edited": false, "score": 1, "creation_date": 1557329076, "post_id": 56043634, "comment_id": 98730232, "body": "Also, can I ask what book or tutorial told you to write this: <code>while(!feof(fpointer)) {  fgets(Worker, 150, fpointer); }</code>?  If you got this from a book, please do yourself a favor, throw the book away, read this: <a href=\"https://stackoverflow.com/questions/5431941/why-is-while-feoffile-always-wrong\" title=\"why is while feoffile always wrong\">stackoverflow.com/questions/5431941/&hellip;</a>"}, {"owner": {"reputation": 1, "user_id": 11470806, "user_type": "registered", "profile_image": "https://graph.facebook.com/2316241015132164/picture?type=large", "display_name": "Patrick Kelleher", "link": "https://stackoverflow.com/users/11470806/patrick-kelleher"}, "reply_to_user": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "edited": false, "score": 0, "creation_date": 1557332051, "post_id": 56043634, "comment_id": 98731700, "body": "@MFisherKDX, thanks for the comments. It was just a self test too see if I could do a few random tasks. I took elements from my universities past exam papers. It seems to be a deeply rooted problem. Ill have a look at the book and start from basics again and build it up again. Its only a small part of my engineering degree so ill revisit this problem after my exams."}, {"owner": {"reputation": 1149, "user_id": 2472827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t5rYY.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/2472827/neil"}, "edited": false, "score": 0, "creation_date": 1557349831, "post_id": 56043634, "comment_id": 98739625, "body": "You also shadow <code>Worker</code> and <code>Benefits</code> in a way that&#39;s certainly not what you want."}], "answers": [{"tags": [], "owner": {"reputation": 1247, "user_id": 388398, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9bd10eedb6c17c1604a7cadefed6b02?s=128&d=identicon&r=PG", "display_name": "Jon Guiton", "link": "https://stackoverflow.com/users/388398/jon-guiton"}, "is_accepted": false, "score": 1, "last_activity_date": 1557342334, "creation_date": 1557342334, "answer_id": 56047461, "question_id": 56043634, "link": "https://stackoverflow.com/questions/56043634/why-do-the-functions-get-skipped-over-without-being-read/56047461#56047461", "title": "Why do the functions get skipped over without being read?", "body": "<p>The functions should be outside the main function. In your main function you call the functions as required. </p>\n\n<pre><code>int main()\n{\n   welcome();\n   readfile();\n\netc.\n\n   return 0;\n}\n</code></pre>\n\n<p>To be really useful functions can take parameters. If you define readfile like this you declare a parameter called <em>filename</em> that contains the name of the file. You can\nuse this inside your function instead of writing the exact name of the file.</p>\n\n<pre><code>int readfile (char *filename)\n{\n  ...\n  fpointer = fopen(filename,\"r\");\n  ...\n}\n</code></pre>\n\n<p>Now in main you can use</p>\n\n<pre><code>int main()\n{\n   welcome();\n   readfile(\"Workers.txt\");\n   ...\n}\n</code></pre>\n\n<p>This is what makes functions useful. You can now reuse the function for another file\nwith a different name. This isn't a solution for you but I hope it helps, even if just with your understanding. </p>\n"}], "owner": {"reputation": 1, "user_id": 11470806, "user_type": "registered", "profile_image": "https://graph.facebook.com/2316241015132164/picture?type=large", "display_name": "Patrick Kelleher", "link": "https://stackoverflow.com/users/11470806/patrick-kelleher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1557342334, "creation_date": 1557327590, "last_edit_date": 1557328015, "question_id": 56043634, "link": "https://stackoverflow.com/questions/56043634/why-do-the-functions-get-skipped-over-without-being-read", "title": "Why do the functions get skipped over without being read?", "body": "<p>Im trying to write code so that it will open a file (worker and benefits) and then display them when asked at the start. I can do this but I would like to use functions. When I run my program it ends as soon as it starts. How do I set up functions so that they will run.</p>\n\n<p>Ive tried renaming the functions to no sucess. Ive also found no help throught Youtube tutorials.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint ans;\nchar Benefits[150];\nchar Worker[150];\n\nint readfile();\nint end();\nint welcome();\n\nint main()\n{\n\n\n\n  int welcome()\n  {\n    puts(\"Hi, Welcome to whatever this is!!\\n\");\n  }\n\n  int readfile()\n  {\n\n\n\n    FILE*fpointer;\n    fpointer = fopen(\"Worker.txt\",\"r\");\n    char Worker[150];\n\n    while(!feof(fpointer))\n    {\n      fgets(Worker, 150, fpointer);\n\n    }\n    FILE*fpointer1;\n    fpointer = fopen(\"Benefits.txt\",\"r\");\n    char Benefits[150];\n\n    while(!feof(fpointer))\n    {\n      fgets(Benefits, 150, fpointer1);\n\n    }\n    fclose(fpointer);\n  }\n\n  int menu(char Benefits)\n  {\n    {\n      printf(\"1 - For option 1\\n\");\n      printf(\"2 - For option 2\\n\");\n      printf(\"3 - For option 3\\n\");\n      printf(\"4 - For option 4\\n\");\n      printf(\"5 - exit\\n\");\n\n      scanf(\"%1d\", &amp;ans);\n    }\n\n    {\n      if (ans==1)\n        puts(Benefits);\n\n      if (ans==2)\n        puts(Worker);\n\n      if (ans==3)\n        puts(\"This is option3\");\n\n      if (ans==4)\n        puts(\"This is option4\");\n    }\n  }\n\n  return 0;\n}\n</code></pre>\n\n<p>I expect the output to print either of the files or exit. As of now It skips functions and ends the program.</p>\n"}, {"tags": ["c", "string.h"], "answers": [{"tags": [], "owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "is_accepted": false, "score": 2, "last_activity_date": 1557328899, "last_edit_date": 1557328899, "creation_date": 1557327828, "answer_id": 56043707, "question_id": 56043612, "link": "https://stackoverflow.com/questions/56043612/how-to-replace-a-part-of-a-string-with-another-substring/56043707#56043707", "title": "How to replace a part of a string with another substring", "body": "<p>There are a few problems with this approach.  First, off, <code>m</code> is pointing to read-only memory, so attempting to overwrite the memory there it is undefined behavior.</p>\n\n<p>Second, the line: <code>strstr(m, \"on\") = \"in\"</code> is not going to change the pointed-to string, but instead reassign the pointer.</p>\n\n<p>Solution:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main(void)\n{\n    char m[] = \"cat on couch\";\n    memcpy(strstr(m, \"on\"), \"in\", 2);\n    printf(\"%s\\n\", m);\n}\n</code></pre>\n\n<p>Note that if you had just used plain <code>strcpy</code> it would null-terminate after <code>\"cat in\"</code>, so <code>memcpy</code> is necessary here. <code>strncpy</code> will also work, but you should read <a href=\"https://stackoverflow.com/questions/1258550/why-should-you-use-strncpy-instead-of-strcpy\">this discussion</a> before using it.</p>\n\n<p>It should also be known that if you are dealing with strings that are not hard-coded constants in your program, you should always check the return value of <code>strstr</code>, <code>strchr</code>, and related functions for <code>NULL</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": true, "score": 5, "last_activity_date": 1557329356, "last_edit_date": 1557329356, "creation_date": 1557328255, "answer_id": 56043847, "question_id": 56043612, "link": "https://stackoverflow.com/questions/56043612/how-to-replace-a-part-of-a-string-with-another-substring/56043847#56043847", "title": "How to replace a part of a string with another substring", "body": "<p>Replacing a substring with another is easy if both substrings have the same length:</p>\n\n<ul>\n<li>locate the position of the substring with <code>strstr</code></li>\n<li>if it is present, use <code>memcpy</code> to overwrite it with the new substring.</li>\n<li>assigning the pointer with <code>*strstr(m, \"on\") = \"in\";</code> is incorrect and should generate a compiler warning. You would avoid such mistakes with <code>gcc -Wall -Werror</code>.</li>\n<li>note however that you cannot modify a string literal, you need to define an initialized array of <code>char</code> so you can modify it.</li>\n</ul>\n\n<p>Here is a corrected version:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main(void) {\n    char m[] = \"cat on couch\";\n    char *p = strstr(m, \"on\");\n    if (p != NULL) {\n        memcpy(p, \"in\", 2);\n    }\n    printf(\"%s\\n\", m);\n    return 0;\n}\n</code></pre>\n\n<p>If the replacement is shorter, the code is a little more complicated:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main(void) {\n    char m[] = \"cat is out roaming\";\n    char *p = strstr(m, \"out\");\n    if (p != NULL) {\n        memcpy(p, \"in\", 2);\n        memmove(p + 2, p + 3, strlen(p + 3) + 1);\n    }\n    printf(\"%s\\n\", m);\n    return 0;\n}\n</code></pre>\n\n<p>In the generic case, it is even more complicated and the array must be large enough to accommodate for the length difference:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main(void) {\n    char m[30] = \"cat is inside the barn\";\n    char *p = strstr(m, \"inside\");\n    if (p != NULL) {\n        memmove(p + 7, p + 6, strlen(p + 6) + 1);\n        memcpy(p, \"outside\", 7);\n    }\n    printf(\"%s\\n\", m);\n    return 0;\n}\n</code></pre>\n\n<p>Here is a generic function that handles all cases:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nchar *strreplace(char *s, const char *s1, const char *s2) {\n    char *p = strstr(s, s1);\n    if (p != NULL) {\n        size_t len1 = strlen(s1);\n        size_t len2 = strlen(s2);\n        if (len1 != len2)\n            memmove(p + len2, p + len1, strlen(p + len1) + 1);\n        memcpy(p, s2, len2);\n    }\n    return s;\n}\n\nint main(void) {\n    char m[30] = \"cat is inside the barn\";\n\n    printf(\"%s\\n\", m);\n    printf(\"%s\\n\", strreplace(m, \"inside\", \"in\"));\n    printf(\"%s\\n\", strreplace(m, \"in\", \"on\"));\n    printf(\"%s\\n\", strreplace(m, \"on\", \"outside\"));\n    return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 1, "creation_date": 1557513013, "post_id": 56045299, "comment_id": 98804396, "body": "All calls to <code>strcat</code> should be calls to <code>strcpy</code>, or better <code>memcpy</code> :)"}, {"owner": {"reputation": 1247, "user_id": 388398, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9bd10eedb6c17c1604a7cadefed6b02?s=128&d=identicon&r=PG", "display_name": "Jon Guiton", "link": "https://stackoverflow.com/users/388398/jon-guiton"}, "reply_to_user": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1557738030, "post_id": 56045299, "comment_id": 98851520, "body": "Improved to use memcpy where possible; improved comments."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1557744381, "post_id": 56045299, "comment_id": 98855107, "body": "Here are ideas for further simplification: <code>for (ip = input; (ip = strstr(ip, substring)) != NULL; ip += substring_size) { number_of_matches++; }</code>, the first <code>memcpy (bp, replace, replace_size+1);</code> does not need to copy the null byte.  It would probably make sense to have a separate loop for the case <code>substring_size == 0</code>, leading to simpler code."}], "tags": [], "owner": {"reputation": 1247, "user_id": 388398, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9bd10eedb6c17c1604a7cadefed6b02?s=128&d=identicon&r=PG", "display_name": "Jon Guiton", "link": "https://stackoverflow.com/users/388398/jon-guiton"}, "is_accepted": false, "score": 1, "last_activity_date": 1557737915, "last_edit_date": 1557737915, "creation_date": 1557333328, "answer_id": 56045299, "question_id": 56043612, "link": "https://stackoverflow.com/questions/56043612/how-to-replace-a-part-of-a-string-with-another-substring/56045299#56045299", "title": "How to replace a part of a string with another substring", "body": "<p>This function performs a generic pattern replace for all instances of a substring with a replacement string. It allocates a buffer of the correct size for the result. Behaviour is well defined for the case of the empty substring corresponding to the javascript replace() semantics. Where possible memcpy is used in place of strcpy.</p>\n\n<pre><code>/*\n * strsub : substring and replace substring in strings.\n *\n * Function to replace a substring with a replacement string. Returns a\n * buffer of the correct size containing the input string with all instances\n * of the substring replaced by the replacement string.\n *\n * If the substring is empty the replace string is written before each character\n * and at the end of the string.\n *\n * Returns NULL on error after setting the error number.\n *\n */\n\nchar * strsub (char *input, char *substring, char *replace)\n{\n    int     number_of_matches = 0;\n    size_t  substring_size = strlen(substring), replace_size = strlen(replace), buffer_size;\n    char    *buffer, *bp, *ip;\n\n/*\n * Count the number of non overlapping substring occurences in the input string. This\n * information is used to calculate the correct buffer size.\n */\n    if (substring_size)\n    {\n        ip = strstr(input, substring);\n        while (ip != NULL)\n        {\n            number_of_matches++;\n            ip = strstr(ip+substring_size, substring);\n        }\n    }\n    else\n        number_of_matches = strlen (input) + 1;\n\n/*\n * Allocate a buffer of the correct size for the output.\n */\n    buffer_size = strlen(input) + number_of_matches*(replace_size - substring_size) + 1;\n\n    if ((buffer = ((char *) malloc(buffer_size))) == NULL)\n    {\n        errno=ENOMEM;\n        return NULL;\n    }\n\n/*\n * Rescan the string replacing each occurence of a match with the replacement string.\n * Take care to copy buffer content between matches or in the case of an empty find\n * string one character.\n */\n    bp = buffer;\n    ip = strstr(input, substring);\n    while ((ip != NULL) &amp;&amp; (*input != '\\0'))\n    {\n        if (ip == input)\n        {\n            memcpy (bp, replace, replace_size+1);\n            bp += replace_size;\n            if (substring_size)\n                input += substring_size;\n            else\n                *(bp++) = *(input++);\n            ip = strstr(input, substring);\n        }\n        else \n            while (input != ip)\n                *(bp++) = *(input++);\n\n    }\n\n/*\n * Write any remaining suffix to the buffer, or in the case of an empty find string\n * append the replacement pattern.\n */\n    if (substring_size)\n        strcpy (bp, input);\n    else\n        memcpy (bp, replace, replace_size+1);\n\n    return buffer;\n}\n</code></pre>\n\n<p>For testing purposes I include a main program that uses the replacement function.</p>\n\n<pre><code>    #define BUFSIZE 1024\n\n    char * read_string (const char * prompt)\n    {\n        char *buf, *bp;\n\n        if ((buf=(char *)malloc(BUFSIZE))==NULL)\n        {\n            error (0, ENOMEM, \"Memory allocation failure in read_string\");\n            return NULL;\n        }\n        else\n            bp=buf;\n\n        printf (\"%s\\n&gt; \", prompt);\n\n        while ((*bp=getchar()) != '\\n')bp++;\n        *bp = '\\0';\n\n        return buf;\n    }\n\n    int main ()\n    {\n        char * input_string = read_string (\"Please enter the input string\");\n        char * pattern_string = read_string (\"Please enter the test string\");\n        char * replace_string = read_string (\"Please enter the replacement string\");\n\n        char * output_string = strsub (input_string, pattern_string, replace_string);\n\n        printf (\"Result       :\\n&gt; %s\\n\", output_string);\n\n        free (input_string);\n        free (pattern_string);\n        free (replace_string);\n        free (output_string); \n        exit(0);\n    }\n</code></pre>\n"}], "owner": {"reputation": 115, "user_id": 11197186, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cca31f2e3508d3a18ebcbd084bc99be9?s=128&d=identicon&r=PG&f=1", "display_name": "jacobay43", "link": "https://stackoverflow.com/users/11197186/jacobay43"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1031, "favorite_count": 0, "accepted_answer_id": 56043847, "answer_count": 3, "score": 2, "last_activity_date": 1557737915, "creation_date": 1557327504, "last_edit_date": 1557328286, "question_id": 56043612, "link": "https://stackoverflow.com/questions/56043612/how-to-replace-a-part-of-a-string-with-another-substring", "title": "How to replace a part of a string with another substring", "body": "<p>I need the string \"on\" to be replaced with \"in\", strstr() function returns a pointer to a string so i figured assigning the new value to that pointer would work but it didn't</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main(void) {\n    char *m = \"cat on couch\";\n    *strstr(m, \"on\") = \"in\";\n    printf(\"%s\\n\", m);\n}\n</code></pre>\n"}, {"tags": ["c", "loops", "for-loop", "while-loop"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1557327479, "post_id": 56043580, "comment_id": 98729241, "body": "You;&#39;re running the loop....twice."}, {"owner": {"reputation": 13596, "user_id": 551045, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/d3cf04e39bcaab5592938990ea158d51?s=128&d=identicon&r=PG", "display_name": "RedX", "link": "https://stackoverflow.com/users/551045/redx"}, "edited": false, "score": 0, "creation_date": 1557327510, "post_id": 56043580, "comment_id": 98729261, "body": "Here is a good start: <a href=\"https://stackoverflow.com/help/how-to-ask\">stackoverflow.com/help/how-to-ask</a>. Just a small pointer, your question does not contain a question or a problem that you have with the code."}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1557327621, "post_id": 56043580, "comment_id": 98729325, "body": "@Dominik Sklyarov The for loop does not make sense."}], "answers": [{"tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 0, "last_activity_date": 1557327695, "creation_date": 1557327695, "answer_id": 56043663, "question_id": 56043580, "link": "https://stackoverflow.com/questions/56043580/scanning-numbers-and-adding-them-to-list-scanning-answer-and-adding-it-to-vari/56043663#56043663", "title": "Scanning numbers and adding them to list &amp; scanning answer and adding it to variable", "body": "<p>You need to have only one loop. Change your code to</p>\n\n<pre><code>while (answer == 'y' &amp;&amp; n &lt; 99)    //check also for the array bound.\n    {\n            printf(\"Insert a number: \");\n            scanf(\"%d\", &amp;numbers1[n++]);  //use 'n' as counter and increment it\n            printf(\"Would you like to add more numbers? [Y/N]\");\n            scanf(\" %c\", &amp;answer);\n    }\n</code></pre>\n\n<p>Note: Error checking is left for the user to implement.</p>\n"}, {"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": true, "score": 0, "last_activity_date": 1557329018, "last_edit_date": 1557329018, "creation_date": 1557328656, "answer_id": 56043987, "question_id": 56043580, "link": "https://stackoverflow.com/questions/56043580/scanning-numbers-and-adding-them-to-list-scanning-answer-and-adding-it-to-vari/56043987#56043987", "title": "Scanning numbers and adding them to list &amp; scanning answer and adding it to variable", "body": "<p>One of the loops is redundant.  That is the <code>for</code> loop does not make sense in the context of the <code>while</code> loop.</p>\n\n<p>Take into account that you ask the user to enter either <code>'Y'</code> or <code>'N'</code> in the prompt but compare the variable <code>answer</code> with the character <code>'y'</code>.</p>\n\n<p>I could suggest the following solution.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;ctype.h&gt;\n\nint main( void )\n{\n    enum { N = 99 };\n    int numbers1[N];\n\n    int n = 0;\n\n    for ( char answer = 'Y'; n &lt; N &amp;&amp; answer == 'Y'; n++ )\n    {\n        printf(\"Insert a number: \");\n        scanf(\"%d\", &amp;numbers1[n]);\n\n        printf(\"Would you like to add more numbers? [Y/N] \");\n        if ( scanf( \" %c\", &amp;answer ) != 1 ) answer = 'N';\n        answer = toupper( ( unsigned char )answer );\n    }\n\n    printf( \"\\nNumbers are following: \" );\n\n    for ( int i = 0; i &lt; n; i++ )\n    {\n        if ( i != 0 ) printf( \", \" );\n        printf( \"%d\", numbers1[i] );\n    }\n    putchar( '\\n' );\n}\n</code></pre>\n\n<p>The program output might look like</p>\n\n<pre><code>Insert a number: 0\nWould you like to add more numbers? [Y/N] y\nInsert a number: 1\nWould you like to add more numbers? [Y/N] 1\nInsert a number: 2\nWould you like to add more numbers? [Y/N] y\nInsert a number: 3\nWould you like to add more numbers? [Y/N] y\nInsert a number: 4\nWould you like to add more numbers? [Y/N] y\nInsert a number: 5\nWould you like to add more numbers? [Y/N] y\nInsert a number: 6\nWould you like to add more numbers? [Y/N] y\nInsert a number: 7\nWould you like to add more numbers? [Y/N] y\nInsert a number: 8\nWould you like to add more numbers? [Y/N] y\nInsert a number: 9\nWould you like to add more numbers? [Y/N] n\n\nNumbers are following: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 4175258, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001578041289/picture?type=large", "display_name": "Dominik Sklyarov", "link": "https://stackoverflow.com/users/4175258/dominik-sklyarov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "accepted_answer_id": 56043987, "answer_count": 2, "score": 1, "last_activity_date": 1557329018, "creation_date": 1557327384, "last_edit_date": 1557328825, "question_id": 56043580, "link": "https://stackoverflow.com/questions/56043580/scanning-numbers-and-adding-them-to-list-scanning-answer-and-adding-it-to-vari", "title": "Scanning numbers and adding them to list &amp; scanning answer and adding it to variable", "body": "<p>The main point is that I want to add numbers to array while the answer is \"y\". When I input 1 2 3 4 5 6, it only adds last 3 digits to array (so, it's 4 5 6) and sometimes it even skips the character scanning.</p>\n\n<p>The code is following:</p>\n\n<pre><code>int numbers1[99];\nint i;\nint n = 0; \nchar answer = 'y'\n\nwhile (answer == 'y')\n    {\n        n += 1;\n        for (i = 0; i &lt; n; i++)\n        {\n            printf(\"Insert a number: \");\n            scanf(\"%d\", &amp;numbers1[i]);\n            printf(\"Would you like to add more numbers? [Y/N]\");\n            scanf(\" %c\", &amp;answer);\n        }\n    }\n\n    printf(\"Numbers are following: \");\n\n    for (i = 0; i &lt; n; i++)\n    {\n        printf(\"%d, \", numbers1[i]);\n    }\n</code></pre>\n\n<p>any help would be appreciated. Thanks!</p>\n"}, {"tags": ["c++", "c", "qt", "embedded"], "answers": [{"tags": [], "owner": {"reputation": 2568, "user_id": 8548828, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/C4qkl.png?s=128&g=1", "display_name": "Tarick Welling", "link": "https://stackoverflow.com/users/8548828/tarick-welling"}, "is_accepted": false, "score": 0, "last_activity_date": 1557823531, "creation_date": 1557823531, "answer_id": 56126334, "question_id": 56043157, "link": "https://stackoverflow.com/questions/56043157/send-data-lwip-stm32-pc/56126334#56126334", "title": "send data lwip STM32 PC", "body": "<p>What is the value you put in the <code>tcp_bind</code> function call? This should be the port you are listening on. It would be best if you would use a port over 1024 because of the privileged access needed on normal systems with operating systems.</p>\n"}], "owner": {"reputation": 11, "user_id": 9158272, "user_type": "registered", "profile_image": "https://graph.facebook.com/1868442600133062/picture?type=large", "display_name": "Emrah Duatepe", "link": "https://stackoverflow.com/users/9158272/emrah-duatepe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 146, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1557823531, "creation_date": 1557325982, "last_edit_date": 1557328600, "question_id": 56043157, "link": "https://stackoverflow.com/questions/56043157/send-data-lwip-stm32-pc", "title": "send data lwip STM32 PC", "body": "<p>I am trying to send or receive data from STM32f(via raw lwip) to computer.\nI connected stm32f device to modem and send \"ping\" and it is ok.dhcp in lwip have got the ip number from modem.And I would like to use QT Creature to send data to STM32 via lwip(connected modem).I dont know what my port number is.What will I write in this codes as port number.</p>\n\n<p>Could you offer me a way,what will I do.\nAlso, is it possible if I connect the stm32f device directly to computer and communication?</p>\n\n<pre><code>tcpSocket-&gt;connectToHost(QHostAddress(\"192.168.1.30\"),portnumber);\n</code></pre>\n"}, {"tags": ["c", "compiler-errors"], "comments": [{"owner": {"reputation": 688, "user_id": 3633525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b533ea49b2c4aa86ca86faba37af9d01?s=128&d=identicon&r=PG&f=1", "display_name": "ChocolateAndCheese", "link": "https://stackoverflow.com/users/3633525/chocolateandcheese"}, "edited": false, "score": 2, "creation_date": 1557326163, "post_id": 56043134, "comment_id": 98728440, "body": "You can put your <code>gcc</code> command into a script so that you don&#39;t have to type it every time.  Also, for larger projects, there are build tools that help with this.  Check out CMake for example."}, {"owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 0, "creation_date": 1557326163, "post_id": 56043134, "comment_id": 98728443, "body": "That&#39;s not the way the compiler works. It doesn&#39;t choose what files you need to compile, you do that. If you need it handled for you, you could use an IDE that handles building, or use some build system (make, cmake, etc.) to help you out."}], "answers": [{"tags": [], "owner": {"reputation": 156300, "user_id": 1782465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b45d92faaf9d122bfed585490e0bafc5?s=128&d=identicon&r=PG", "display_name": "Angew is no longer proud of SO", "link": "https://stackoverflow.com/users/1782465/angew-is-no-longer-proud-of-so"}, "is_accepted": true, "score": 6, "last_activity_date": 1557326607, "last_edit_date": 1557326607, "creation_date": 1557326189, "answer_id": 56043228, "question_id": 56043134, "link": "https://stackoverflow.com/questions/56043134/compile-all-necessary-files-with-gcc/56043228#56043228", "title": "Compile all necessary files with gcc", "body": "<p>You're mixing up included files (<code>.h</code> files, header files) and source files (<code>.c</code> files). You don't have to do anything about header files, the compiler will process them automatically<sup>(1)</sup>.</p>\n\n<p>You <em>do</em> have to list all source files which you want to compile.They are what defines your project. Based on your source tree organisation, you might get away with using shell pattern expansion (e.g. <code>*.c</code>) to get them, though.</p>\n\n<p>For larger projects, you normally don't type the compilation command by hand, but use some project management tool, such as an IDE, a Makefile, or a buildsystem generator such as CMake.</p>\n\n<p>Also note that the error you're actually getting is not a <em>compiler</em> error, it's a <em>linker</em> error. Linking is a separate step that comes after compiling. The compilation reads source files and produces object files. Linking then reads object files and produces a binary (executable or shared library) out of them.</p>\n\n<p>You should also note that there is not always a 1:1 correspondence between header and source files. The classic example are libraries: you can include one or more header files which are shipped with an external library; these will provide declarations for functions implemented inside that library. This allows you to call the functions in your code. To then make these functions available to the linker (so that they can become part of your program), instruct the linker to link the library into your binary (normally via the <code>-l</code> command-line option).</p>\n\n<hr>\n\n<p><sup>(1)</sup> You may still need to point your compiler at directories where these header files reside, which is usually done using the <code>-I</code> command-line option.</p>\n"}], "owner": {"reputation": 139, "user_id": 8875445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb4d91368247731ebcd1bac107430c46?s=128&d=identicon&r=PG&f=1", "display_name": "Introser", "link": "https://stackoverflow.com/users/8875445/introser"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 195, "favorite_count": 1, "accepted_answer_id": 56043228, "answer_count": 1, "score": 2, "last_activity_date": 1557363424, "creation_date": 1557325922, "last_edit_date": 1557363424, "question_id": 56043134, "link": "https://stackoverflow.com/questions/56043134/compile-all-necessary-files-with-gcc", "title": "Compile all necessary files with gcc", "body": "<p>I\u2019m quite new to C and the gcc compiler. I have a project where I include some other .h files. In that files there are include from more own .h files. And so on. Its a decent amount of includes.\nMy problem is, when I try to compile the main file with:</p>\n\n<pre><code>gcc -o test tests_main.c\n</code></pre>\n\n<p>I get the following error: </p>\n\n<pre><code>Undefined symbols for architecture x86_64:\n \"_waves_secure_hash_test\", referenced from:\n     _crypto_tests in tests_main-d1ae56.o\nld: symbol(s) not found for architecture x86_64\nclang: error: linker command failed with exit code 1 (use -v to see invocation)\n</code></pre>\n\n<p>Thats because the compiler cant find the method \"waves_secure_hash_test\", but its in the included file:</p>\n\n<pre><code>#include \"crypto_tests.h\" \n</code></pre>\n\n<p>So, I searched a little bit and found a solution, just compile it with:</p>\n\n<pre><code>gcc -o test tests_main.c crypto_tets.c\n</code></pre>\n\n<p>Okay, that work for me with that two test file, where the functions are only some test prints.\nFor my complete project with a decent amount of includes, I can\u2019t write down all that c files to compile... Is there a way to tell the compiler that he has to compile all needed and included files?</p>\n"}, {"tags": ["c", "linux", "networking", "linux-kernel", "interrupt"], "answers": [{"comments": [{"owner": {"reputation": 619, "user_id": 1666733, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d588c62cff899e45a7d9fe926b1a0c63?s=128&d=identicon&r=PG", "display_name": "arduic", "link": "https://stackoverflow.com/users/1666733/arduic"}, "edited": false, "score": 0, "creation_date": 1557326364, "post_id": 56043167, "comment_id": 98728576, "body": "The area inbetween lock and unlock is not small. It basically does all the work to cleanup my DMAs and ensure they are ready for the next ndo_start_xmit call. As for the work_handler since I am using schedule_work I should be using the global workqueue. Does that mean NAPI can lock the global workqueue? As for the link, thank you it seems useful. However, I have triple checked and the second spin_lock comes from another ndo_start_xmit call which is not tied to the IRQ. Although I guess ndo_start_xmit could have higher priority then the workqueue?"}, {"owner": {"reputation": 8402, "user_id": 4664415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hsfxj.jpg?s=128&g=1", "display_name": "mevets", "link": "https://stackoverflow.com/users/4664415/mevets"}, "reply_to_user": {"reputation": 619, "user_id": 1666733, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d588c62cff899e45a7d9fe926b1a0c63?s=128&d=identicon&r=PG", "display_name": "arduic", "link": "https://stackoverflow.com/users/1666733/arduic"}, "edited": false, "score": 0, "creation_date": 1557326764, "post_id": 56043167, "comment_id": 98728816, "body": "It would have an effective higher priority; part of the motivation behind work queues is to reduce system interrupt latency.  If the irqsave doesn\u2019t alleviate the problem, then it is elsewhere.   If it does, you have to look at changing the big lock into a set of smaller transactions.   It can be fun."}, {"owner": {"reputation": 619, "user_id": 1666733, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d588c62cff899e45a7d9fe926b1a0c63?s=128&d=identicon&r=PG", "display_name": "arduic", "link": "https://stackoverflow.com/users/1666733/arduic"}, "edited": false, "score": 0, "creation_date": 1557326953, "post_id": 56043167, "comment_id": 98728919, "body": "Alright yep that was where I thought you answer was heading haha. Out of curiosity do you think it would help if I replace workqueue with NAPI and have napi differentiate who caused it? That is easy to do in my program. I&#39;ll be testing irqsave in a few minutes can&#39;t get to computer while on lunch."}, {"owner": {"reputation": 8402, "user_id": 4664415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hsfxj.jpg?s=128&g=1", "display_name": "mevets", "link": "https://stackoverflow.com/users/4664415/mevets"}, "reply_to_user": {"reputation": 619, "user_id": 1666733, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d588c62cff899e45a7d9fe926b1a0c63?s=128&d=identicon&r=PG", "display_name": "arduic", "link": "https://stackoverflow.com/users/1666733/arduic"}, "edited": false, "score": 0, "creation_date": 1557327296, "post_id": 56043167, "comment_id": 98729111, "body": "It is likely worth exploring; in the old days, device status registers were often volatile -- reading them cleared status bits -- you had to commit inside the first level ISR.   Modern device are more amenable to interleaving."}], "tags": [], "owner": {"reputation": 8402, "user_id": 4664415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hsfxj.jpg?s=128&g=1", "display_name": "mevets", "link": "https://stackoverflow.com/users/4664415/mevets"}, "is_accepted": true, "score": 2, "last_activity_date": 1557326014, "creation_date": 1557326014, "answer_id": 56043167, "question_id": 56042961, "link": "https://stackoverflow.com/questions/56042961/workqueue-starts-interrupted-and-never-finished-causing-cpu-stall/56043167#56043167", "title": "Workqueue starts, interrupted, and never finished causing CPU stall", "body": "<p>If the area between spin_lock..spin_unlock is pretty short, spin_lock_irqsave may be applicable.   At the very least, try it to see if it makes your problem go away.  My suspicion is NAPI has pinned your work_handler context.</p>\n\n<p>While _irqsave may happen to work, you should do a proper lock ordering analysis.</p>\n\n<p>Have a look at <a href=\"https://www.kernel.org/doc/Documentation/locking/spinlocks.txt\" rel=\"nofollow noreferrer\">https://www.kernel.org/doc/Documentation/locking/spinlocks.txt</a>; particularly the bottom bit with:</p>\n\n<pre><code>spin_lock(&amp;lock);\n...\n    &lt;- interrupt comes in:\n        spin_lock(&amp;lock);\n</code></pre>\n"}], "owner": {"reputation": 619, "user_id": 1666733, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d588c62cff899e45a7d9fe926b1a0c63?s=128&d=identicon&r=PG", "display_name": "arduic", "link": "https://stackoverflow.com/users/1666733/arduic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 218, "favorite_count": 0, "accepted_answer_id": 56043167, "answer_count": 1, "score": 0, "last_activity_date": 1557400099, "creation_date": 1557325357, "last_edit_date": 1557400099, "question_id": 56042961, "link": "https://stackoverflow.com/questions/56042961/workqueue-starts-interrupted-and-never-finished-causing-cpu-stall", "title": "Workqueue starts, interrupted, and never finished causing CPU stall", "body": "<p>Providing a minimal code example will be difficult but I'll provide some sudo code to hopefully get the point/question across.</p>\n\n<p>TL;DR: My workqueue starts, is interrupted, and then never finishes causing a CPU stall.</p>\n\n<p>I am creating a network driver for a PCIe device. For language, Tx=host out, Rx=host in. For the Tx side of things I'm using work queues (work_struct). So.</p>\n\n<pre><code>ndo_start_xmit(){\n//Perform some operations and load a DMA.\n}\n\nrequest_irq(irq_handler);\nINIT_WORK(work,work_handler);\n\nirq_handler(){\n//Check what caused the IRQ\nif(ndo_xmit_dma caused irq){\nschedule_work(work);\n}\n}\n\nwork_handler(){\nif(xmit_called){\nspin_lock()\n//Do some stuff\nspin_unlock()\n}\n}\n</code></pre>\n\n<p>Then for the Rx side of things it's similar but now uses NAPI instead of workqueue because I'm learning and honestly could likely move all work to napi (please state if that would solve the problem).</p>\n\n<pre><code>irq_handler(){\nif(Rx caused the irq){\nnapi_schedule();\n}\n}\n\n//Do a bunch of napi releated stuff (never try to grab the spin_lock).\n</code></pre>\n\n<p>So what's the problem? Well mid way through my work_handler for Tx and Rx IRQ happens (no big deal so far). The IRQ obviously bounces me out of the workqueue at which point NAPI is scheduled. Now instead of going back to the workqueue it handles the NAPI function (again not a huge deal to my program I assume this is a priority thing sure). Then my kernel calls ndo_start_xmit again gets to the spin_lock at which point the CPU stalls. At no point does the program ever go back to the scheduled but interrupted work from work_handler. In testing it actually was interrupted right between 2 print statements so I know it never even did a partial return.</p>\n\n<p>So why does workqueue never return? Is there a way to solve this? My initial guess is flush_work but that feels more like a patch to the problem and not solving the root of it. Would it be better to move my Tx schedule_work to be a part of the NAPI handler instead? </p>\n\n<p>Thank you for the insight. </p>\n\n<p>UPDATE:\nThis is after I accepted a perfectly good answer. In the discussion that followed I proposed multiple NAPI instances. Simply put, 1 NAPI per netdev otherwise lot's of problems show up. I wasn't able to distinguish what caused napi with just the napi struct (maybe someone sees a way I don't except abusing the budget number). As for my problem I found it was kind of a 3 step issue. The workqueue was interrupted by the RX irq/napi. The Rx napi then got blocked by a call to ndo_start_xmit. ndo_start_xmit trys to grab the same spinlock that the workqueue was using so I got stuck in a position where nothing can move hence the CPU stall. </p>\n"}, {"tags": ["c", "alsa", "pcm", "libalsa"], "comments": [{"owner": {"reputation": 157205, "user_id": 11654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/586424ca0847070dc1868aa58077003e?s=128&d=identicon&r=PG", "display_name": "CL.", "link": "https://stackoverflow.com/users/11654/cl"}, "edited": false, "score": 0, "creation_date": 1557329741, "post_id": 56042919, "comment_id": 98730603, "body": "The sample format is whatever you have configured the device for."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "is_accepted": true, "score": 4, "last_activity_date": 1557335381, "last_edit_date": 1557335381, "creation_date": 1557325851, "answer_id": 56043108, "question_id": 56042919, "link": "https://stackoverflow.com/questions/56042919/c-print-an-integer-array-as-binary-data/56043108#56043108", "title": "C: print an integer array as binary data", "body": "<p>Better use an array of <code>char</code> to record raw data. But to answer your question:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;limits.h&gt;\n#include &lt;stdio.h&gt;\n\nvoid print_binary(int value)\n{\n    unsigned mask = ~(~0u &gt;&gt; 1);  // set highest bit\n\n    // iterate over all bits:\n    for (size_t i = 0; i &lt; sizeof(value) * CHAR_BIT; ++i) {\n        putchar('0' + !!(value &amp; mask));  // !! converts to bool 0 or 1\n        mask &gt;&gt;= 1;  // shift to next lower bit\n    }\n}\n\nint main(void)\n{\n    int x = 9;\n    print_binary(x);\n    putchar('\\n');\n}\n</code></pre>\n\n<h3>Output:</h3>\n\n<pre class=\"lang-none prettyprint-override\"><code>00000000000000000000000000001001\n</code></pre>\n\n<h3>Shorter:</h3>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdio.h&gt;\n\nvoid print_binary(int value)\n{\n    for (unsigned mask = ~(~0u &gt;&gt; 1); mask; mask &gt;&gt;= 1)\n        putchar('0' + !!(value &amp; mask));\n}\n</code></pre>\n\n<p><br />\nPS: Just to clarify <code>~(~0u &gt;&gt; 1)</code> (8 bits for simplicity):</p>\n\n<p><code>~0u</code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;negate all bits&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<code>1111 1111</code><br />\n<code>~0u &gt;&gt; 1</code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;shift to right 1 bit and fill up with 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<code>0111 1111</code><br />\n<code>~(~0u &gt;&gt; 1)</code>&nbsp;&nbsp;&nbsp;&nbsp;negate that&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<code>1000 0000</code><br /></p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 1, "creation_date": 1557326853, "post_id": 56043296, "comment_id": 98728869, "body": "Right shift of negative signed integers is implementation-defined."}, {"owner": {"reputation": 80, "user_id": 3411690, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0e887c5af27d3153b0fe580c6b3c9d90?s=128&d=identicon&r=PG&f=1", "display_name": "Nitin Jadhav", "link": "https://stackoverflow.com/users/3411690/nitin-jadhav"}, "reply_to_user": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1557327079, "post_id": 56043296, "comment_id": 98728996, "body": "I am not clear with your statement. Do you mean considering the signed integer bit I should modify the <code>for</code> loop as <code>for(bit_size=30; bit_size&gt;=0; bit_size--)</code> ?"}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1557327141, "post_id": 56043296, "comment_id": 98729030, "body": "No. \u2013 <i><code>data[i] &gt;&gt; bit_size;</code></i> \u2013 is implementation-defined and not guaranteed to be the same on all platforms."}, {"owner": {"reputation": 80, "user_id": 3411690, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0e887c5af27d3153b0fe580c6b3c9d90?s=128&d=identicon&r=PG&f=1", "display_name": "Nitin Jadhav", "link": "https://stackoverflow.com/users/3411690/nitin-jadhav"}, "reply_to_user": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1557327958, "post_id": 56043296, "comment_id": 98729521, "body": "Yet I am not clear what&#39;s wrong in that. In question as mentioned, he is referring 32bit integer, so I am using a variable <code>bit_size</code> whose value is set using <code>for</code> loop and used to right shift the data. Request you please elaborate or help with a web-link explaining this. Thanks in advance."}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1557328071, "post_id": 56043296, "comment_id": 98729587, "body": "<i>and used to right shift the data.</i> \u2013 <a href=\"https://stackoverflow.com/a/4009954/3975177\">stackoverflow.com/a/4009954/3975177</a>"}], "tags": [], "owner": {"reputation": 80, "user_id": 3411690, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0e887c5af27d3153b0fe580c6b3c9d90?s=128&d=identicon&r=PG&f=1", "display_name": "Nitin Jadhav", "link": "https://stackoverflow.com/users/3411690/nitin-jadhav"}, "is_accepted": false, "score": -1, "last_activity_date": 1557326433, "creation_date": 1557326433, "answer_id": 56043296, "question_id": 56042919, "link": "https://stackoverflow.com/questions/56042919/c-print-an-integer-array-as-binary-data/56043296#56043296", "title": "C: print an integer array as binary data", "body": "<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n#include&lt;stdint.h&gt;\n\nint main(void) \n{\n  int32_t data[5]= {2,1,1,1,1}; /*Example array with small value for easy recognition of binary value */\n  int i,array_size,bit_size,bit_print;\n\n  array_size=sizeof(data)/sizeof(data[0]);\n\n  for(i=0;i&lt;array_size;i++)\n  {\n    for(bit_size=31; bit_size&gt;=0; bit_size--)\n    {\n        bit_print = data[i] &gt;&gt; bit_size;\n\n        if (bit_print &amp; 1)\n          printf(\"1\");\n        else\n          printf(\"0\");\n    }\n    printf(\"\\n\"); /*this new line is optional if you want to view each value on new line.*/\n  }  \n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 4, "creation_date": 1557327354, "post_id": 56043421, "comment_id": 98729156, "body": "That only works when you tell your compiler to ignore the standard."}, {"owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "reply_to_user": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1557334785, "post_id": 56043421, "comment_id": 98732934, "body": "@Swordfish I don&#39;t know of any compiler that follows the standard by default. I would say that it works as long as you don&#39;t tell your compiler to follow the standard :)"}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 2, "creation_date": 1557334883, "post_id": 56043421, "comment_id": 98732983, "body": "I won&#39;t answer such &amp;%$!&amp;!"}], "tags": [], "owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "is_accepted": false, "score": 1, "last_activity_date": 1557527065, "last_edit_date": 1557527065, "creation_date": 1557326825, "answer_id": 56043421, "question_id": 56042919, "link": "https://stackoverflow.com/questions/56042919/c-print-an-integer-array-as-binary-data/56043421#56043421", "title": "C: print an integer array as binary data", "body": "<p>You could write your own conversion specifier for printing in binary with <code>printf</code>.</p>\n\n<p>Here's a SO answer on how to do that: <a href=\"https://stackoverflow.com/a/112947\">https://stackoverflow.com/a/112947</a></p>\n\n<p>After you code that, you should be able to do:</p>\n\n<pre><code>printf(\"%b\", 5); /* prints 101 */\n</code></pre>\n\n<p><strong>EDIT:</strong></p>\n\n<p>The good point about this is you can then (if you code it, obviously, which btw is a little tedious) use modifiers:</p>\n\n<pre><code>printf(\"%'#b\", 0x15);\n</code></pre>\n\n<p>The way I programmed that (I still haven't had the opportunity to test it though), it should print:</p>\n\n<pre><code>0b1'0101\n</code></pre>\n\n<p><strong>EDIT 2:</strong></p>\n\n<p>That link above explains an old deprecated way of doing it.  However, it is very similar to the new one, and from reading it, I could do an implementation using the new method.</p>\n\n<p>I posted my implementation here: <a href=\"https://codereview.stackexchange.com/q/219994/200418\">https://codereview.stackexchange.com/q/219994/200418</a></p>\n"}], "owner": {"reputation": 521, "user_id": 7218182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dccc64192134bc30b5456f88347a792f?s=128&d=identicon&r=PG&f=1", "display_name": "relot", "link": "https://stackoverflow.com/users/7218182/relot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 574, "favorite_count": 1, "accepted_answer_id": 56043108, "answer_count": 3, "score": 0, "last_activity_date": 1557527065, "creation_date": 1557325201, "question_id": 56042919, "link": "https://stackoverflow.com/questions/56042919/c-print-an-integer-array-as-binary-data", "title": "C: print an integer array as binary data", "body": "<p>I want to record data from a microphone using alsa.\nThis command:</p>\n\n<pre><code>int buf[4096];\nmemset(buf, 0, sizeof(buf));\nsnd_pcm_readi(capture_handle, buf, avail);\n</code></pre>\n\n<p>writes the microphone data into the integer buffer buf. ( I am not sure if the data that is written by ..._readi is even integer values, the documentation does'nt tell.)</p>\n\n<p>But if I iterate through the buffer the numbers make no sense.\nAs an example I get that buf[60] == -2,600,000,000 so its smaller than the minimum integer if integer is 32 bit. ( as a note this is not my code but I have to work on it).\nI want to get the binary values of this whole buffer array and make sense of the values and look up in which way they are saved into the buffer so I can recreate the soundwave with this data.</p>\n"}, {"tags": ["c", "flex-lexer"], "comments": [{"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1557325760, "post_id": 56042773, "comment_id": 98728188, "body": "What about a generator producing the flex definitions from the file ? See my answer"}], "answers": [{"tags": [], "owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "is_accepted": false, "score": 1, "last_activity_date": 1557326710, "last_edit_date": 1557326710, "creation_date": 1557324922, "answer_id": 56042854, "question_id": 56042773, "link": "https://stackoverflow.com/questions/56042773/how-to-read-rulesdefinitions-from-files-in-flex/56042854#56042854", "title": "How to read rules(definitions) from files in flex?", "body": "<p><em>flex</em> generates code, so you cannot read <code>noun.txt</code> at execution time and have them managed directly by <em>flex</em> if this is what you expect</p>\n\n<p>Of course you can use <em>flex</em> to read an identifier/word (sequence of alpha) and manages the nouns known thanks to <code>noun.txt</code> (already read and its content memorized to be used) in a special way into the body part ({...}) associated to the identifier. But in that case the interest to use <em>flex</em> is very limited, and you have a problem with the case of \"Los Angeles\" having a space inside (but may be it is \"Los-Angeles\" ?)  </p>\n\n<p>You can also write a generator producing the flex file from <code>noun.txt</code> to have them directly managed by <em>flex</em>. This is probably the best way to do if the nous do not have to change at any time. Your <em>flex</em> definitions are very simple and easy to generate.</p>\n"}, {"tags": [], "owner": {"reputation": 1247, "user_id": 388398, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9bd10eedb6c17c1604a7cadefed6b02?s=128&d=identicon&r=PG", "display_name": "Jon Guiton", "link": "https://stackoverflow.com/users/388398/jon-guiton"}, "is_accepted": false, "score": 0, "last_activity_date": 1557343606, "creation_date": 1557343606, "answer_id": 56047767, "question_id": 56042773, "link": "https://stackoverflow.com/questions/56042773/how-to-read-rulesdefinitions-from-files-in-flex/56047767#56047767", "title": "How to read rules(definitions) from files in flex?", "body": "<p>You might find the command</p>\n\n<pre><code>sed 's/^/\"/; s/$/\"|/' noun.txt &gt;&gt; nounrule.txt\n</code></pre>\n\n<p>useful. This basically writes the bulk of the rule for you, you will just have to add the action part at the end.</p>\n"}], "owner": {"reputation": 13, "user_id": 7119422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f15163d69a25e60531cbbf5d93efd350?s=128&d=identicon&r=PG&f=1", "display_name": "magoo", "link": "https://stackoverflow.com/users/7119422/magoo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1557343606, "creation_date": 1557324636, "last_edit_date": 1557325312, "question_id": 56042773, "link": "https://stackoverflow.com/questions/56042773/how-to-read-rulesdefinitions-from-files-in-flex", "title": "How to read rules(definitions) from files in flex?", "body": "<p>I have been creating token definitions in my .l file. Due to large amount to dataset, it is getting little tedious.\nIs there any way to <strong>read all words from file</strong> e.g. noun.txt containing all nouns and give all of them a single token.</p>\n\n<p>Basically, I want to automate this part:</p>\n\n<pre><code>%%\n\n[\\r\\n]                  {;return T_QUIT;}\n\"morning\"|\"flight\"      {return NOUN;}\n\"I\"|\"him\"                       {return PRO;}\n\"a\"                     {return DET;}\n\"prefer\"|\"play\"|\"love\"              {return VERB;}\n\"Los Angeles\"|\"ali\"|\"home\"  {return PNOUN;}\n\"on\"|\"at\"                   {return PRE;}\n\"exit\"      {return T_QUIT;}\n\"quit\"      {return T_QUIT;}\n\n%%\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 9215, "user_id": 5212827, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7e9f9b0d7e2d571c9f8886dd54bd50f9?s=128&d=identicon&r=PG&f=1", "display_name": "DeiDei", "link": "https://stackoverflow.com/users/5212827/deidei"}, "edited": false, "score": 5, "creation_date": 1557324375, "post_id": 56042667, "comment_id": 98727286, "body": "<code>Windows executable have a different structure</code> Yeah, and the compiler knows that. What&#39;s the problem?"}, {"owner": {"reputation": 1536, "user_id": 283561, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/91bcdcd7ac6867149e0da7fee38f4050?s=128&d=identicon&r=PG", "display_name": "Simon", "link": "https://stackoverflow.com/users/283561/simon"}, "edited": false, "score": 1, "creation_date": 1557324485, "post_id": 56042667, "comment_id": 98727365, "body": "It&#39;s not necessarily the same compiler for all OS. It&#39;s a compiler for Linux/Unix, a compiler for Windows, etc."}, {"owner": {"reputation": 13, "user_id": 10974135, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-SNp5ABrIjsM/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcZPEqejzb0MwcMMsIaE3ejkcYtRyw/mo/photo.jpg?sz=128", "display_name": "Tinu Tom", "link": "https://stackoverflow.com/users/10974135/tinu-tom"}, "edited": false, "score": 0, "creation_date": 1557324823, "post_id": 56042667, "comment_id": 98727593, "body": "So my question is that , if different os have different compilers , why they call it c . you have stated that different os have different compiler so that they have to remake the whole compiler"}, {"owner": {"reputation": 58292, "user_id": 34824, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/ri8DI.jpg?s=128&g=1", "display_name": "abelenky", "link": "https://stackoverflow.com/users/34824/abelenky"}, "edited": false, "score": 5, "creation_date": 1557324933, "post_id": 56042667, "comment_id": 98727647, "body": "&quot;C&quot; describes the language that is input into the compiler.   The output (compiled executable) differs from one OS to another, from platform to platform, but the input is consistent."}, {"owner": {"reputation": 13, "user_id": 10974135, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-SNp5ABrIjsM/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcZPEqejzb0MwcMMsIaE3ejkcYtRyw/mo/photo.jpg?sz=128", "display_name": "Tinu Tom", "link": "https://stackoverflow.com/users/10974135/tinu-tom"}, "edited": false, "score": 0, "creation_date": 1557325129, "post_id": 56042667, "comment_id": 98727779, "body": "So , do you mean that only the mnuemonic constants change and not everything"}, {"owner": {"reputation": 26680, "user_id": 1806780, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/NCB41.jpg?s=128&g=1", "display_name": "Sami Kuhmonen", "link": "https://stackoverflow.com/users/1806780/sami-kuhmonen"}, "edited": false, "score": 1, "creation_date": 1557325405, "post_id": 56042667, "comment_id": 98727976, "body": "What do you mean by mnemonic constants? And they don\u2019t have to remake the whole compiler. The language doesn\u2019t change, the hardware may be the same..."}, {"owner": {"reputation": 1536, "user_id": 283561, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/91bcdcd7ac6867149e0da7fee38f4050?s=128&d=identicon&r=PG", "display_name": "Simon", "link": "https://stackoverflow.com/users/283561/simon"}, "edited": false, "score": 1, "creation_date": 1557327648, "post_id": 56042667, "comment_id": 98729347, "body": "The C language is a formal specification (on paper). A C compiler is an implementation (i.e a program) of this specification specific for a OS."}, {"owner": {"reputation": 233489, "user_id": 14122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5e2861b08f37fa306fbf5384994af688?s=128&d=identicon&r=PG", "display_name": "Charles Duffy", "link": "https://stackoverflow.com/users/14122/charles-duffy"}, "edited": false, "score": 0, "creation_date": 1557358891, "post_id": 56042667, "comment_id": 98741984, "body": "Remember that GCC is the &quot;GNU Compiler Collection&quot; -- one codebase, but with lots of different language frontends and lots of different backends able to generate executables for different operating systems&#39; ABIs. Building software with optional pieces that can be mixed-and-matched at runtime is a matter of <i>engineering</i>; a question of &quot;but how do they do that?&quot; is far too broad to be topical on SO -- there literally <i>are</i> books about the design of GCC (and other compilers)."}, {"owner": {"reputation": 233489, "user_id": 14122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5e2861b08f37fa306fbf5384994af688?s=128&d=identicon&r=PG", "display_name": "Charles Duffy", "link": "https://stackoverflow.com/users/14122/charles-duffy"}, "edited": false, "score": 0, "creation_date": 1557359384, "post_id": 56042667, "comment_id": 98742084, "body": "From <a href=\"https://stackoverflow.com/help/dont-ask\">What type of questions should I avoid asking?</a>, note the guidance that &quot;if you can imagine a book that answers your question, you&#39;re asking too much&quot;. And if imagining a book is tricky, you can take inspiration from <a href=\"https://gcc.gnu.org/wiki/ListOfCompilerBooks\" rel=\"nofollow noreferrer\">the GCC project&#39;s list of compiler books</a>."}, {"owner": {"reputation": 13, "user_id": 10974135, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-SNp5ABrIjsM/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcZPEqejzb0MwcMMsIaE3ejkcYtRyw/mo/photo.jpg?sz=128", "display_name": "Tinu Tom", "link": "https://stackoverflow.com/users/10974135/tinu-tom"}, "edited": false, "score": 0, "creation_date": 1557413621, "post_id": 56042667, "comment_id": 98764376, "body": "What is the purpose of down voting a question , I have asked it here because i can quickly get the answer. If there&#39;s an easy way , why should i use a hard way to find the answer."}], "answers": [{"comments": [{"owner": {"reputation": 233489, "user_id": 14122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5e2861b08f37fa306fbf5384994af688?s=128&d=identicon&r=PG", "display_name": "Charles Duffy", "link": "https://stackoverflow.com/users/14122/charles-duffy"}, "edited": false, "score": 0, "creation_date": 1557358750, "post_id": 56050219, "comment_id": 98741955, "body": "The compiler doesn&#39;t need to know about how the standard libraries differ (so long as that library is described with a header that&#39;s compilable with the standard C language), so that&#39;s neither here nor there. Differing ABIs and executable formats are a slightly bigger deal, but even then, it&#39;s isolated subsystems involved."}, {"owner": {"reputation": 233489, "user_id": 14122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5e2861b08f37fa306fbf5384994af688?s=128&d=identicon&r=PG", "display_name": "Charles Duffy", "link": "https://stackoverflow.com/users/14122/charles-duffy"}, "edited": false, "score": 0, "creation_date": 1557359035, "post_id": 56050219, "comment_id": 98742029, "body": "(...an illustrative example: If I <code>#include</code> a header that defines an implementation of <code>gettimeofday()</code> on Windows, am I suddenly running a different compiler? Of course not! Thus, whether headers defining functions you need and libraries implementing them are locally available is an unrelated concern)."}], "tags": [], "owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "is_accepted": false, "score": 1, "last_activity_date": 1557357418, "creation_date": 1557357418, "answer_id": 56050219, "question_id": 56042667, "link": "https://stackoverflow.com/questions/56042667/how-c-compiler-works-the-same-everywhere/56050219#56050219", "title": "How c compiler works the same everywhere", "body": "<p>It's not the same compiler. You use a Linux C compiler to compile programs for Linux (such as gcc or clang). You use a Windows C compiler to compile programs for Windows (such as Microsoft Visual Studio, but also the Windows versions of gcc or clang). </p>\n\n<p>There are a lot of standard C functions that you can call that work on Windows and Linux (for example <code>fopen</code> or <code>printf</code>), but if you call any Windows-specific or Linux-specific functions (such as <code>CreateWindow</code> or <code>gettimeofday</code>) then your program won't compile on other operating systems.</p>\n"}], "owner": {"reputation": 13, "user_id": 10974135, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-SNp5ABrIjsM/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcZPEqejzb0MwcMMsIaE3ejkcYtRyw/mo/photo.jpg?sz=128", "display_name": "Tinu Tom", "link": "https://stackoverflow.com/users/10974135/tinu-tom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1557357418, "creation_date": 1557324303, "question_id": 56042667, "link": "https://stackoverflow.com/questions/56042667/how-c-compiler-works-the-same-everywhere", "title": "How c compiler works the same everywhere", "body": "<p>I have read that c was made to build the unix os.\nBut now the same c can be used to make programs in windows , linux and almost every operating systems\nHow is this possible.\nWindows executable have a different structure with linux and vise versa\nThey may use different mnuemonics to define the program but how will this same c compiler compile programs for different systems</p>\n"}, {"tags": ["c", "fopen"], "comments": [{"owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 2, "creation_date": 1557324228, "post_id": 56042625, "comment_id": 98727186, "body": "I&#39;m not able to understand the actual issue you have. Can you clarify?"}, {"owner": {"reputation": 157, "user_id": 10058141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/177fccf7bd5516320cb7965cc29ff669?s=128&d=identicon&r=PG&f=1", "display_name": "Yang", "link": "https://stackoverflow.com/users/10058141/yang"}, "reply_to_user": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 0, "creation_date": 1557324248, "post_id": 56042625, "comment_id": 98727196, "body": "using gcc version : gcc (Ubuntu 7.4.0-1ubuntu1~18.04) 7.4.0 Copyright (C) 2017 Free Software Foundation, Inc. This is free software; see the source for copying conditions.  There is NO warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1557324325, "post_id": 56042625, "comment_id": 98727241, "body": "@yang What this comment is supposed to clarify?"}, {"owner": {"reputation": 157, "user_id": 10058141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/177fccf7bd5516320cb7965cc29ff669?s=128&d=identicon&r=PG&f=1", "display_name": "Yang", "link": "https://stackoverflow.com/users/10058141/yang"}, "edited": false, "score": 0, "creation_date": 1557324335, "post_id": 56042625, "comment_id": 98727249, "body": "&#39;system(&quot;clear&quot;);&#39; is not act when function ended, act &#39;fclose()&#39;;"}, {"owner": {"reputation": 157, "user_id": 10058141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/177fccf7bd5516320cb7965cc29ff669?s=128&d=identicon&r=PG&f=1", "display_name": "Yang", "link": "https://stackoverflow.com/users/10058141/yang"}, "edited": false, "score": 0, "creation_date": 1557324383, "post_id": 56042625, "comment_id": 98727292, "body": "sorry, i will fix comment"}, {"owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "edited": false, "score": 1, "creation_date": 1557324391, "post_id": 56042625, "comment_id": 98727299, "body": "You should check the return value of <code>fopen</code>"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1557324436, "post_id": 56042625, "comment_id": 98727332, "body": "Are you saying that <code>system(&quot;clear&quot;)</code> does not seem to work?"}, {"owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "edited": false, "score": 1, "creation_date": 1557324547, "post_id": 56042625, "comment_id": 98727416, "body": "You should use <code>strscpy</code> (you may have to code it yourself) unless you know for sure a lot of things about the strings being used by <code>strcpy</code>. If you don&#39;t want to use <code>strscpy</code>, think at least of using <code>strlcpy</code> (from libbsd) or <code>strncpy</code> (standard)"}, {"owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "edited": false, "score": 1, "creation_date": 1557324658, "post_id": 56042625, "comment_id": 98727492, "body": "The same with <code>strcat</code> as with <code>strcpy</code>."}, {"owner": {"reputation": 157, "user_id": 10058141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/177fccf7bd5516320cb7965cc29ff669?s=128&d=identicon&r=PG&f=1", "display_name": "Yang", "link": "https://stackoverflow.com/users/10058141/yang"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1557324685, "post_id": 56042625, "comment_id": 98727509, "body": "@EugeneSh. yes. It looks like not working well"}, {"owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "edited": false, "score": 1, "creation_date": 1557324939, "post_id": 56042625, "comment_id": 98727654, "body": "There&#39;s a macro in <code>&lt;stdio.h&gt;</code> called <code>FILENAME_MAX</code>. You should use that instead of the magic number <code>100</code>"}, {"owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "edited": false, "score": 1, "creation_date": 1557325116, "post_id": 56042625, "comment_id": 98727769, "body": "In <code>malloc</code>, you should use <code>sizeof(*text)</code> instead of <code>sizeof(char)</code> for the (unlikely) case that you change the data type of <code>text</code>."}, {"owner": {"reputation": 157, "user_id": 10058141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/177fccf7bd5516320cb7965cc29ff669?s=128&d=identicon&r=PG&f=1", "display_name": "Yang", "link": "https://stackoverflow.com/users/10058141/yang"}, "reply_to_user": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "edited": false, "score": 0, "creation_date": 1557325475, "post_id": 56042625, "comment_id": 98728014, "body": "@CacahueteFrito yes, that was prototype for the whole code. After fix <code>system(&quot;clear&quot;);</code> error, then I will fix it. thanks."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 2, "creation_date": 1557325507, "post_id": 56042625, "comment_id": 98728038, "body": "That&#39;s probably just buffering. Do <code>fflush(stdout);</code> before you sleep."}, {"owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "edited": false, "score": 1, "creation_date": 1557325648, "post_id": 56042625, "comment_id": 98728117, "body": "I&#39;m almost sure you&#39;re overflowing <code>text</code>. Use a larger buffer (<code>BUFSIZ</code> should be your standard always, unless you specifically need something bigger, or have specific low memory requirements), and check the functions I told you to check for buffer overflow"}, {"owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "edited": false, "score": 1, "creation_date": 1557325795, "post_id": 56042625, "comment_id": 98728209, "body": "@Yang <code>system(&quot;clear&quot;)</code> can not fail (unless some weird conditions).  Probably there is a buffer overflow causing undefined behaviour, and that can manifest as anything, making you think <code>clear</code> is failing."}, {"owner": {"reputation": 157, "user_id": 10058141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/177fccf7bd5516320cb7965cc29ff669?s=128&d=identicon&r=PG&f=1", "display_name": "Yang", "link": "https://stackoverflow.com/users/10058141/yang"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1557325801, "post_id": 56042625, "comment_id": 98728220, "body": "@melpomene Thanks for your help. answer was erase buffer after printf();"}, {"owner": {"reputation": 157, "user_id": 10058141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/177fccf7bd5516320cb7965cc29ff669?s=128&d=identicon&r=PG&f=1", "display_name": "Yang", "link": "https://stackoverflow.com/users/10058141/yang"}, "edited": false, "score": 0, "creation_date": 1557325900, "post_id": 56042625, "comment_id": 98728272, "body": "Thanks for everyone.  The answer is make code like <code>while(EOF!=fscanf(f,&quot;%s&quot;,text)){     &#47;&#47;fscanf(f,&quot;%s&quot;, text);     printf(&quot;%s &quot;,text);     fflush(stdout);     usleep(80000);   }</code>"}, {"owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "edited": false, "score": 1, "creation_date": 1557326026, "post_id": 56042625, "comment_id": 98728360, "body": "@Yang You should post your answer as an answer. BTW, that&#39;s not &quot;erasing&quot; the buffer, but flushing it."}], "answers": [{"tags": [], "owner": {"reputation": 157, "user_id": 10058141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/177fccf7bd5516320cb7965cc29ff669?s=128&d=identicon&r=PG&f=1", "display_name": "Yang", "link": "https://stackoverflow.com/users/10058141/yang"}, "is_accepted": true, "score": 1, "last_activity_date": 1557326636, "creation_date": 1557326636, "answer_id": 56043355, "question_id": 56042625, "link": "https://stackoverflow.com/questions/56042625/c-does-not-follow-the-program-operation-procedure/56043355#56043355", "title": "c does not follow the program operation procedure", "body": "<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n\nvoid printFiles(char *file1,char *file2,char *change1, char *change2){\n  FILE *f;\n  char *text = malloc(sizeof(char)*100);\n  f=fopen(file1,\"r\");\n\n  system(\"clear\");\n  //while(!feof(f)){\n  while(EOF!=fscanf(f,\"%s\",text)){\n    //fscanf(f,\"%s\", text);\n    printf(\"%s \",text);\n    fflush(stdout);\n    //usleep(20000);\n  }\n  //sleep(3);\n\n  fclose(f);\n  printf(\"\\n\");\n  //all comment problems are appear here. and if I give delay, such as usleep() or sleep, delay also appear here. Not appear each wrote part.\n\n  f=fopen(file2,\"r\");\n  //while(!feof(f)){\n  while(EOF!=fscanf(f,\"%s\",text)){\n    if(strcmp(text,\"**,\")==0){\n      strcpy(text,change1);\n      strcat(text,\",\");\n    }\n\n    else if(strcmp(text,\"**\")==0){\n      strcpy(text,change1);\n    }\n    else if(strcmp(text,\"##.\")==0){\n      strcpy(text,change2);\n      strcat(text,\".\");\n    }\n    else if(strcmp(text,\"##,\")==0){\n      strcpy(text,change2);\n      strcat(text,\",\");\n    }\n    printf(\"%s \",text);\n    fflush(stdout);// The answer. \n    //usleep(200000);\n  }\n  fclose(f);\n  free(text);\n  sleep(3); //here is problem. This part works in the above commented part \"//all comment problems are appear here.\"\n  system(\"clear\"); //here is problem. This part works in the above commented part \"//all comment problems are appear here.\"\n}\n\n\nint main(){\n  char file1[100] = \"./file1.txt\";\n  char file2[100] = \"./file2.txt\";\n  char change1[100]=\"text1\";\n  char change2[100]=\"text2\";\n  printFiles(file1,file2,change1,change2);\n  return 0;\n}\n</code></pre>\n\n<p>Hint for \n<code>That's probably just buffering. Do fflush(stdout); before you sleep. \u2013 melpomene</code>\nThanks.</p>\n"}, {"tags": [], "owner": {"reputation": 2034, "user_id": 621883, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/H9fKc.jpg?s=128&g=1", "display_name": "Ito", "link": "https://stackoverflow.com/users/621883/ito"}, "is_accepted": false, "score": 0, "last_activity_date": 1557327736, "creation_date": 1557327736, "answer_id": 56043675, "question_id": 56042625, "link": "https://stackoverflow.com/questions/56042625/c-does-not-follow-the-program-operation-procedure/56043675#56043675", "title": "c does not follow the program operation procedure", "body": "<p>You can try this solution for <strong>delay</strong>.</p>\n\n<pre><code>#include &lt;time.h&gt;\n#include &lt;stdio.h&gt;\n\nvoid delay(double seconds)\n{\n    const time_t start = time(NULL);\n    time_t current;\n\n    do\n    {\n        time(&amp;current);\n    } while(difftime(current, start) &lt; seconds);\n}\n\nint main(void)\n{\n    printf(\"Just waiting...\\n\");\n    delay(3);\n    printf(\"...oh man, waiting for so long...\\n\");\n    return 0;\n}\n</code></pre>\n\n<p>Following solution is pretty quite the same of previous one but with a <strong>clear terminal</strong> solution.</p>\n\n<pre><code>#include &lt;time.h&gt;\n#include &lt;stdio.h&gt;\n\n#ifdef _WIN32\n    #define CLEAR_SCREEN system (\"cls\");\n#else\n    #define CLEAR_SCREEN puts(\"\\x1b[H\\x1b[2J\");\n#endif\n\nvoid delay(double seconds)\n{\n    const time_t start = time(NULL);\n    time_t current;\n\n    do\n    {\n        time(&amp;current);\n    } while(difftime(current, start) &lt; seconds);\n}\n\nint main(void)\n{\n    printf(\"Just waiting...\\n\");\n    delay(2); //seconds\n    printf(\"...oh man, waiting for so long...\\n\");\n    delay(1);\n    CLEAR_SCREEN\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 157, "user_id": 10058141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/177fccf7bd5516320cb7965cc29ff669?s=128&d=identicon&r=PG&f=1", "display_name": "Yang", "link": "https://stackoverflow.com/users/10058141/yang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 56043355, "answer_count": 2, "score": 0, "last_activity_date": 1557327736, "creation_date": 1557324165, "last_edit_date": 1557324755, "question_id": 56042625, "link": "https://stackoverflow.com/questions/56042625/c-does-not-follow-the-program-operation-procedure", "title": "c does not follow the program operation procedure", "body": "<p>summary : system(\"clear\"); isn't working well.</p>\n\n<p>I'm using gcc, ubuntu 18.04 LTS version for c programming.</p>\n\n<p>what I intended was \"read each words and print from two text files. After finish read file, delay 3 seconds and erase terminal\"</p>\n\n<p>so I was make two text files, and using system(\"clear\"); to erase terminal.</p>\n\n<p>here is whole code.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n\nvoid printFiles(char *file1,char *file2,char *change1, char *change2){\n  FILE *f;\n  char *text = malloc(sizeof(char)*100);\n  f=fopen(file1,\"r\");\n\n  system(\"clear\");\n  //while(!feof(f)){\n  while(EOF!=fscanf(f,\"%s\",text)){\n    //fscanf(f,\"%s\", text);\n    printf(\"%s \",text);\n    //usleep(20000);\n  }\n  //sleep(3);\n\n  fclose(f);\n  printf(\"\\n\");\n  //all comment problems are appear here. and if I give delay, such as usleep() or sleep, delay also appear here. Not appear each wrote part.\n\n  f=fopen(file2,\"r\");\n  //while(!feof(f)){\n  while(EOF!=fscanf(f,\"%s\",text)){\n    if(strcmp(text,\"**,\")==0){\n      strcpy(text,change1);\n      strcat(text,\",\");\n    }\n\n    else if(strcmp(text,\"**\")==0){\n      strcpy(text,change1);\n    }\n    else if(strcmp(text,\"##.\")==0){\n      strcpy(text,change2);\n      strcat(text,\".\");\n    }\n    else if(strcmp(text,\"##,\")==0){\n      strcpy(text,change2);\n      strcat(text,\",\");\n    }\n    printf(\"%s \",text);\n    //usleep(200000);\n  }\n  fclose(f);\n  free(text);\n  sleep(3); //here is problem. This part works in the above commented part \"//all comment problems are appear here.\"\n  system(\"clear\"); //here is problem. This part works in the above commented part \"//all comment problems are appear here.\"\n}\n\n\nint main(){\n  char file1[100] = \"./file1.txt\";\n  char file2[100] = \"./file2.txt\";\n  char change1[100]=\"text1\";\n  char change2[100]=\"text2\";\n  printFiles(file1,file2,change1,change2);\n  return 0;\n}\n</code></pre>\n\n<p>I'm very sorry, files and variables names are changed because of policy. Also, file contents also can not upload.</p>\n\n<p>I can't find which part makes break Procedure-oriented programming. I think that was compiler error, because using one file read and <code>system(clear);</code> works well.</p>\n\n<p>I also make two point variables, such as 'FILE *f1; FILE *f2;  f1=fopen(file1); f2=fopen(file2)...`, but same result occur.</p>\n\n<p>Is it compiler error? If it is, what should I do for fix these problem? Thanks.</p>\n"}, {"tags": ["c", "multidimensional-array", "enums"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1557323773, "post_id": 56042422, "comment_id": 98726879, "body": "I don&#39;t know what &quot;dynamic&quot; means in this context, but <code>enum</code> values are numerical and suitable enough for indexing arrays."}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1557323869, "post_id": 56042422, "comment_id": 98726927, "body": "No, you can&#39;t &quot;dynamically&quot; add values/names to an <code>enum</code>."}, {"owner": {"reputation": 16676, "user_id": 10147399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a6d433902192f8bb03857ae1b849d4f?s=128&d=identicon&r=PG&f=1", "display_name": "Ayxan Haqverdili", "link": "https://stackoverflow.com/users/10147399/ayxan-haqverdili"}, "edited": false, "score": 0, "creation_date": 1557323879, "post_id": 56042422, "comment_id": 98726934, "body": "Looks like a flat array would be good enough, no?"}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1557324190, "post_id": 56042422, "comment_id": 98727159, "body": "<i>the enum values could be apple, bear, or apple, bear, teddy etc.</i> \u2013 and where should those values come from at runtime? At compiletime: <code>enum { apple, bear } foo;</code> ... that&#39;s it. You cannot add any values to that <code>enum foo</code> at runtime. And the names don&#39;t exist at runtime either."}, {"owner": {"reputation": 33, "user_id": 11453961, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-BwsmFymXVS8/AAAAAAAAAAI/AAAAAAAAANY/cw2vL3247SA/photo.jpg?sz=128", "display_name": "Aevitas", "link": "https://stackoverflow.com/users/11453961/aevitas"}, "reply_to_user": {"reputation": 16676, "user_id": 10147399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a6d433902192f8bb03857ae1b849d4f?s=128&d=identicon&r=PG&f=1", "display_name": "Ayxan Haqverdili", "link": "https://stackoverflow.com/users/10147399/ayxan-haqverdili"}, "edited": false, "score": 0, "creation_date": 1557324308, "post_id": 56042422, "comment_id": 98727230, "body": "Well. That ruins my plans. @Ayxan a flat array?  I&#39;m assuming that&#39;s a 1D array? No, I need a 2D array as this is meant to be a correlation matrix."}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1557324438, "post_id": 56042422, "comment_id": 98727334, "body": "A 1d array can be a projection of a 2d array: <code>int foo[16]; size_t x = 3; size_t y = 2; &#47;* let width be 4 *&#47; foo[y * 4 + x];</code> When you allocate an &quot;2d array&quot; with <code>malloc()</code> you have an array of pointers. These point to memory regions that represent the rows. That&#39;s not an array. Something like that is called &quot;jagged array&quot; at best. The main characteristic of an array is that all its elements are consecutive in memory. Such &quot;jagged arrays&quot; only hurt performance."}, {"owner": {"reputation": 33, "user_id": 11453961, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-BwsmFymXVS8/AAAAAAAAAAI/AAAAAAAAANY/cw2vL3247SA/photo.jpg?sz=128", "display_name": "Aevitas", "link": "https://stackoverflow.com/users/11453961/aevitas"}, "reply_to_user": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1557324660, "post_id": 56042422, "comment_id": 98727497, "body": "@Swordfish I think I have to do something like that anyway as the array needs to be variable."}], "answers": [{"tags": [], "owner": {"reputation": 16676, "user_id": 10147399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a6d433902192f8bb03857ae1b849d4f?s=128&d=identicon&r=PG&f=1", "display_name": "Ayxan Haqverdili", "link": "https://stackoverflow.com/users/10147399/ayxan-haqverdili"}, "is_accepted": true, "score": 3, "last_activity_date": 1557324313, "last_edit_date": 1557324313, "creation_date": 1557324010, "answer_id": 56042574, "question_id": 56042422, "link": "https://stackoverflow.com/questions/56042422/using-enums-to-access-2d-array-indices/56042574#56042574", "title": "Using enums to access 2D array indices", "body": "<p>C is <a href=\"https://stackoverflow.com/a/1517670/10147399\">a statically typed language</a> and you cannot add variable names to your program at runtime. This includes enums too. A hash table like <code>std::map</code> may be used for your purposes, but C does not provide such a type, so you have to implement it yourself.</p>\n"}, {"tags": [], "owner": {"reputation": 598, "user_id": 2412316, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/wPWyb.png?s=128&g=1", "display_name": "Bastien", "link": "https://stackoverflow.com/users/2412316/bastien"}, "is_accepted": false, "score": 1, "last_activity_date": 1557324260, "creation_date": 1557324260, "answer_id": 56042652, "question_id": 56042422, "link": "https://stackoverflow.com/questions/56042422/using-enums-to-access-2d-array-indices/56042652#56042652", "title": "Using enums to access 2D array indices", "body": "<p>Enum in C are nothing more than a mapping between names and integers. So you could do something like</p>\n\n<pre><code>enum Fruit{apple, orange, banana};\narray[apple][banana] = 1;\n\n</code></pre>\n\n<p>But like its name points, you must enumerate it, BEFORE you use it. So it's impossible to add one at runtime.\nSome kind of map structure might work though.</p>\n"}, {"comments": [{"owner": {"reputation": 33, "user_id": 11453961, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-BwsmFymXVS8/AAAAAAAAAAI/AAAAAAAAANY/cw2vL3247SA/photo.jpg?sz=128", "display_name": "Aevitas", "link": "https://stackoverflow.com/users/11453961/aevitas"}, "edited": false, "score": 0, "creation_date": 1557325718, "post_id": 56042693, "comment_id": 98728161, "body": "Thanks for taking the time to write that. But sadly, that won&#39;t work for me. I need to find another way to solve the problem."}], "tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": false, "score": 3, "last_activity_date": 1557325136, "last_edit_date": 1557325136, "creation_date": 1557324388, "answer_id": 56042693, "question_id": 56042422, "link": "https://stackoverflow.com/questions/56042422/using-enums-to-access-2d-array-indices/56042693#56042693", "title": "Using enums to access 2D array indices", "body": "<p>Yes, you can use enumerations to create symbolic constants for each index:</p>\n\n<pre><code>enum { apples, carrot, bread, dinosaur };\n</code></pre>\n\n<p>You can also use regular variables:</p>\n\n<pre><code>const int apples   = 0;\nconst int carrot   = 1;\nconst int bread    = 2;\nconst int dinosaur = 3;\n</code></pre>\n\n<p>You can also use the preprocessor:</p>\n\n<pre><code>#define APPLES   0\n#define CARROT   1\n#define BREAD    2\n#define DINOSAUR 3\n</code></pre>\n\n<p>What you <em>can't</em> do is create any of these things <strong>at runtime</strong>.  If you decide <em>at runtime</em> to create a 5x5 array, you cannot also create a new symbolic constant (via an <code>enum</code> or variable or macro).  That can only be done at compile time.  </p>\n\n<p><strong>EDIT</strong></p>\n\n<p>What you <em>can</em> do is create some kind of associative data structure (map or lookup table) that associates a string with an integer value, and then you can do something like...</p>\n\n<pre><code>Some_Map_Type map;\n...\naddIndex( map, \"apples\", 0 );\naddIndex( map, \"carrot\", 1 );\naddIndex( map, \"bread\", 2 );\naddIndex( map, \"dinosaur\", 3 );\n...\ndo_something_with( matrix[getIndex(map, \"apples\")][getIndex(map, \"bread\")] );\n</code></pre>\n\n<p>and then at runtime prompt for a new index name and value, like:</p>\n\n<pre><code>printf( \"Gimme a new index: \" );\nscanf( \"%s %d\", name, &amp;value ); // doing it this way *just* for brevity - don't actually do it like this\naddIndex( map, name, value );\n...\ndo_something_with( matrix[getIndex(map, name)][getIndex(map, \"bread\")] );\n</code></pre>\n\n<p>That may or may not be worth the effort for you.  </p>\n"}], "owner": {"reputation": 33, "user_id": 11453961, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-BwsmFymXVS8/AAAAAAAAAAI/AAAAAAAAANY/cw2vL3247SA/photo.jpg?sz=128", "display_name": "Aevitas", "link": "https://stackoverflow.com/users/11453961/aevitas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 770, "favorite_count": 0, "accepted_answer_id": 56042574, "answer_count": 3, "score": 0, "last_activity_date": 1557325136, "creation_date": 1557323616, "last_edit_date": 1557324082, "question_id": 56042422, "link": "https://stackoverflow.com/questions/56042422/using-enums-to-access-2d-array-indices", "title": "Using enums to access 2D array indices", "body": "<p>I haven't had a chance to try this and my understanding of C is amateur at best. The closest I found to this question was for c++ but dealt with fixed enum values.</p>\n\n<p>Say you have a 2D integer array dynamically allocated like this:</p>\n\n<p>4x4</p>\n\n<pre><code>0 0 0 0\n0 0 0 0         \n0 0 0 0   \n0 0 0 0\n</code></pre>\n\n<p>would it be possible to use enum to assign dynamic names to each column and row and then access those rows and columns by their name?</p>\n\n<p>Like:</p>\n\n<pre><code>        apples   bread   carrot   dinosaur  \napples    0        0       0         0  \nbread     0        0       0         0  \ncarrot    0        0       0         0   \ndinosaur  0        0       0         0 \n</code></pre>\n\n<p>Allowing me to do something like this:</p>\n\n<pre><code>matrix[apples][bread] += 1;\n</code></pre>\n\n<p><strong>EDIT</strong>\nWhen I say \"dynamic\" what I mean is when a value is compiled at run time with no fixed size. So on one run the matrix may be 2x2 or 82x82 and the <code>enum</code> values could be apple, bear, or apple, bear, teddy etc. </p>\n"}, {"tags": ["c", "division", "inf"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1557322056, "post_id": 56041910, "comment_id": 98725752, "body": "What&#39;s the input?"}, {"owner": {"reputation": 75, "user_id": 8378816, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/X8dD6.png?s=128&g=1", "display_name": "Giannis", "link": "https://stackoverflow.com/users/8378816/giannis"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1557322230, "post_id": 56041910, "comment_id": 98725878, "body": "let&#39;s say 10 and 200 or 2000"}], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 8378816, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/X8dD6.png?s=128&g=1", "display_name": "Giannis", "link": "https://stackoverflow.com/users/8378816/giannis"}, "edited": false, "score": 2, "creation_date": 1557322129, "post_id": 56041944, "comment_id": 98725807, "body": "silly mistake. thanks a lot. it worked."}, {"owner": {"reputation": 75, "user_id": 8378816, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/X8dD6.png?s=128&g=1", "display_name": "Giannis", "link": "https://stackoverflow.com/users/8378816/giannis"}, "edited": false, "score": 0, "creation_date": 1557322176, "post_id": 56041944, "comment_id": 98725844, "body": "do I need that f at the end of the line? if so, what for?"}, {"owner": {"reputation": 1248, "user_id": 1791872, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/6nnz7.png?s=128&g=1", "display_name": "flau", "link": "https://stackoverflow.com/users/1791872/flau"}, "edited": false, "score": 1, "creation_date": 1557322245, "post_id": 56041944, "comment_id": 98725890, "body": "<code>1000.0</code> is a double, <code>1000.0f</code> is a float. See <a href=\"https://en.cppreference.com/w/cpp/language/floating_literal\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/language/floating_literal</a>"}, {"owner": {"reputation": 16676, "user_id": 10147399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a6d433902192f8bb03857ae1b849d4f?s=128&d=identicon&r=PG&f=1", "display_name": "Ayxan Haqverdili", "link": "https://stackoverflow.com/users/10147399/ayxan-haqverdili"}, "reply_to_user": {"reputation": 75, "user_id": 8378816, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/X8dD6.png?s=128&g=1", "display_name": "Giannis", "link": "https://stackoverflow.com/users/8378816/giannis"}, "edited": false, "score": 1, "creation_date": 1557322281, "post_id": 56041944, "comment_id": 98725913, "body": "@GiannisGonidelis 1000.0 is also fine"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 16676, "user_id": 10147399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a6d433902192f8bb03857ae1b849d4f?s=128&d=identicon&r=PG&f=1", "display_name": "Ayxan Haqverdili", "link": "https://stackoverflow.com/users/10147399/ayxan-haqverdili"}, "edited": false, "score": 3, "creation_date": 1557322439, "post_id": 56041944, "comment_id": 98726011, "body": "@Ayxan: <code>1000.0f</code> and <code>1000.0</code> are equal, but this is not true for floating-point constants in general. Programmers should be aware of the difference in types and values that result\u2014please do not recommend that people use casually <code>double</code> constants with <code>float</code> operations."}, {"owner": {"reputation": 16676, "user_id": 10147399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a6d433902192f8bb03857ae1b849d4f?s=128&d=identicon&r=PG&f=1", "display_name": "Ayxan Haqverdili", "link": "https://stackoverflow.com/users/10147399/ayxan-haqverdili"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 1, "creation_date": 1557322785, "post_id": 56041944, "comment_id": 98726235, "body": "@EricPostpischil your point is valid, but programmers should generally prefer  <code>double</code> over <code>float</code> anyway."}], "tags": [], "owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "is_accepted": true, "score": 1, "last_activity_date": 1557322052, "creation_date": 1557322052, "answer_id": 56041944, "question_id": 56041910, "link": "https://stackoverflow.com/questions/56041910/whats-the-case-of-float-division-returning-inf-and-finite-value/56041944#56041944", "title": "What&#39;s the case of float division returning inf and finite value?", "body": "<p>You're just getting tripped up by integer division (200 / 1000 = 0).</p>\n\n<p>Change <code>float dt = atoi(args[2])/1000;</code> -> <code>float dt = atoi(args[2])/1000.0f;</code></p>\n"}], "owner": {"reputation": 75, "user_id": 8378816, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/X8dD6.png?s=128&g=1", "display_name": "Giannis", "link": "https://stackoverflow.com/users/8378816/giannis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 258, "favorite_count": 0, "closed_date": 1557322201, "accepted_answer_id": 56041944, "answer_count": 1, "score": 0, "last_activity_date": 1557324685, "creation_date": 1557321930, "last_edit_date": 1557324685, "question_id": 56041910, "link": "https://stackoverflow.com/questions/56041910/whats-the-case-of-float-division-returning-inf-and-finite-value", "closed_reason": "Duplicate", "title": "What&#39;s the case of float division returning inf and finite value?", "body": "<p>I have written this snippet of code and I cannot understand why this float division returns <code>inf</code> when <code>args[2] = 200</code> and <code>5.0</code> when <code>args[2] = 2000</code>. Is this caused because I am exceeding some decimal position boundary?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;stdlib.h&gt;\nint main(int nargs, char **args) {\n\n    float t = atoi(args[1]);   \n    float dt = atoi(args[2])/1000;\n\n    float nsamples = (t/dt);\n    printf(\"%f\\n\", nsamples);\n    return(0);\n}\n</code></pre>\n"}, {"tags": ["android", "c", "android-ndk", "adb"], "comments": [{"owner": {"reputation": 3693, "user_id": 5494721, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WHK5j.png?s=128&g=1", "display_name": "OznOg", "link": "https://stackoverflow.com/users/5494721/oznog"}, "edited": false, "score": 0, "creation_date": 1557321781, "post_id": 56041658, "comment_id": 98725575, "body": "There are quite a lot of constraints on native applications on android, opening sockets needs special rigths. Is your phone rooted (or are you using a custom image)? With a vanilla android, there are little chances that you manage to do that, IMHO (that said, itdepends on the android version, a gingerbread may not be that securized)"}, {"owner": {"reputation": 129, "user_id": 9392630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a6cf2504cb25184a357c8d54d42523f?s=128&d=identicon&r=PG&f=1", "display_name": "SayMyName", "link": "https://stackoverflow.com/users/9392630/saymyname"}, "reply_to_user": {"reputation": 3693, "user_id": 5494721, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WHK5j.png?s=128&g=1", "display_name": "OznOg", "link": "https://stackoverflow.com/users/5494721/oznog"}, "edited": false, "score": 0, "creation_date": 1557322920, "post_id": 56041658, "comment_id": 98726328, "body": "I am using custom image(not rooted) and I have Android version 9. Is there any way to run this file on my mobile phone without any setup change."}, {"owner": {"reputation": 3693, "user_id": 5494721, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WHK5j.png?s=128&g=1", "display_name": "OznOg", "link": "https://stackoverflow.com/users/5494721/oznog"}, "edited": false, "score": 0, "creation_date": 1557326688, "post_id": 56041658, "comment_id": 98728765, "body": "if you have strace installed on your image, try running <code>strace &#47;path&#47;to&#47;test</code> and look at the output where the EPERM comes; may be a start for your investigations, but I must say, Android&#39;s permissions (especially if you have selinux acivated) is a full time job..."}, {"owner": {"reputation": 52300, "user_id": 192373, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/83a45711c4c32eeeb3826d279e50f8ab?s=128&d=identicon&r=PG", "display_name": "Alex Cohn", "link": "https://stackoverflow.com/users/192373/alex-cohn"}, "edited": false, "score": 2, "creation_date": 1557351409, "post_id": 56041658, "comment_id": 98740174, "body": "Many locations on the device are banned from execution for security concerns. <code>&#47;storage</code> is one of them. The one that is usually available for <b>adb shell</b> is <code>&#47;data&#47;local&#47;tmp</code>."}, {"owner": {"reputation": 129, "user_id": 9392630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a6cf2504cb25184a357c8d54d42523f?s=128&d=identicon&r=PG&f=1", "display_name": "SayMyName", "link": "https://stackoverflow.com/users/9392630/saymyname"}, "reply_to_user": {"reputation": 52300, "user_id": 192373, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/83a45711c4c32eeeb3826d279e50f8ab?s=128&d=identicon&r=PG", "display_name": "Alex Cohn", "link": "https://stackoverflow.com/users/192373/alex-cohn"}, "edited": false, "score": 0, "creation_date": 1557380995, "post_id": 56041658, "comment_id": 98746690, "body": "@AlexCohn It is not working ` adb: error: failed to copy &#39;test&#39; to &#39;/data/local/test&#39;: remote couldn&#39;t create file: Permission denied`"}, {"owner": {"reputation": 55767, "user_id": 219159, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/cxM6H.jpg?s=128&g=1", "display_name": "Seva Alekseyev", "link": "https://stackoverflow.com/users/219159/seva-alekseyev"}, "edited": false, "score": 0, "creation_date": 1557431347, "post_id": 56041658, "comment_id": 98773074, "body": "Why do you need it as a standalone executable? Can you re-engineer it as a regular JNI library?"}, {"owner": {"reputation": 8554, "user_id": 632035, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8ed69ad748c440a055502c1b213757e5?s=128&d=identicon&r=PG", "display_name": "Dan Albert", "link": "https://stackoverflow.com/users/632035/dan-albert"}, "edited": false, "score": 0, "creation_date": 1558386638, "post_id": 56041658, "comment_id": 99076658, "body": "<code>&#47;data&#47;local&#47;tmp&#47;test</code>, not <code>&#47;data&#47;local&#47;test</code>"}, {"owner": {"reputation": 15397, "user_id": 3290339, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CMy5l.jpg?s=128&g=1", "display_name": "Onik", "link": "https://stackoverflow.com/users/3290339/onik"}, "edited": false, "score": 0, "creation_date": 1564431557, "post_id": 56041658, "comment_id": 101020877, "body": "<a href=\"https://stackoverflow.com/q/35231168/3290339\">How to build an executable for Android shell</a>"}], "owner": {"reputation": 129, "user_id": 9392630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a6cf2504cb25184a357c8d54d42523f?s=128&d=identicon&r=PG&f=1", "display_name": "SayMyName", "link": "https://stackoverflow.com/users/9392630/saymyname"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 306, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1557321475, "creation_date": 1557321106, "last_edit_date": 1557321475, "question_id": 56041658, "link": "https://stackoverflow.com/questions/56041658/running-c-c-executable-file-in-android-platform", "title": "Running c/c++ executable file in Android platform", "body": "<p>I am trying to run a simple c++ code on my mobile phone. My application idea is to run a local server on my android phone and connect to this server with a browser or an android application.</p>\n\n<p>To do this, I have compiled a simple main.c code to see if I run a c code on the Android platform with using NDK. I think it has compiled correctly and it is ready to run on my mobile phone.\nThen to send the executable file to my mobile phone I have used <code>adb</code> command on my Linux shell like;</p>\n\n<pre><code>adb push test /storage/self/primary/Android/data\nadb shell chmod 777 /storage/self/primary/Android/data/test\n</code></pre>\n\n<p>Then when I connect to my phone I am using <code>adb shell /storage/self/primary/Android/data/test</code> command, it returns me <code>can't execute: Permission denied</code> output.</p>\n\n<p>Actually, I have a few steps to finish my project. For example, I want to run this executable file without using the terminal.</p>\n\n<p>Anyway, How can I run this executable file on my mobile phone?</p>\n"}, {"tags": ["c", "arrays", "bit-fields"], "comments": [{"owner": {"reputation": 9846, "user_id": 1745544, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/92a0f69d86d214e0cffceb76c6e3f09f?s=128&d=identicon&r=PG", "display_name": "OldProgrammer", "link": "https://stackoverflow.com/users/1745544/oldprogrammer"}, "edited": false, "score": 3, "creation_date": 1557319967, "post_id": 56041232, "comment_id": 98724384, "body": "Did you look at memcpy() function?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1557320347, "post_id": 56041232, "comment_id": 98724617, "body": "By the way, your printing functions won&#39;t seem to work, no matter what data you have in your buffers. You could also simplify it by using a single function to print from both buffers, by passing a pointer to the first element as argument (and the size too preferably)."}, {"owner": {"reputation": 15569, "user_id": 2302862, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e264db339bb96e343770fa38018e00f1?s=128&d=identicon&r=PG", "display_name": "Siguza", "link": "https://stackoverflow.com/users/2302862/siguza"}, "edited": false, "score": 0, "creation_date": 1557320435, "post_id": 56041232, "comment_id": 98724676, "body": "Why without bitfields though? This sounds like <i>made</i> for bitfields. <code>struct { uint64_t cmd1 : 8, cmd2: 8, addr : 16, data : 32; } buffer;</code> But I mean, you can always just unroll the loops since the amount of iterations is constant..."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 15569, "user_id": 2302862, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e264db339bb96e343770fa38018e00f1?s=128&d=identicon&r=PG", "display_name": "Siguza", "link": "https://stackoverflow.com/users/2302862/siguza"}, "edited": false, "score": 2, "creation_date": 1557320727, "post_id": 56041232, "comment_id": 98724887, "body": "@Siguza Perfect way to trash up straight-forward EEPROM programming with endianess, aliasing and alignment bugs. And that just 3 reasons out of many why we don&#39;t use bit-fields. And I&#39;m curious to know which 64 bit computer that comes with on-chip EEPROM."}, {"owner": {"reputation": 31, "user_id": 9969946, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-9M9fOBRvkhM/AAAAAAAAAAI/AAAAAAAAAG0/BbqO45ISu2E/photo.jpg?sz=128", "display_name": "Markus Herzberg", "link": "https://stackoverflow.com/users/9969946/markus-herzberg"}, "reply_to_user": {"reputation": 9846, "user_id": 1745544, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/92a0f69d86d214e0cffceb76c6e3f09f?s=128&d=identicon&r=PG", "display_name": "OldProgrammer", "link": "https://stackoverflow.com/users/1745544/oldprogrammer"}, "edited": false, "score": 0, "creation_date": 1557321089, "post_id": 56041232, "comment_id": 98725128, "body": "@OldProgrammer memcpy is exactly what i searched for! Thanks. I just need to know how i increment my pointer by 3. So far i am having this: memcpy(&amp;local_transmit_buffer + 3, &amp;MSQ_Buffer_data, 4); But it only prints zeros.  Edit: nvm Got it! memcpy(&amp;local_transmit_buffer[4], &amp;MSQ_Buffer_data, 4); Thanks for your help!"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1557321737, "post_id": 56041232, "comment_id": 98725544, "body": "You can&#39;t use <code>memcpy</code> like this together with <code>uint_fast8_t</code>, or there is not a reason to use <code>uint_fast8_t</code> in the first place. You&#39;d need to copy <code>4*sizeof(uint_fast8_t)</code> bytes. But in this case, it is plain wrong to use  <code>uint_fast8_t</code> since this is data used for NVM programming. See my answer."}], "answers": [{"tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 4, "last_activity_date": 1557321615, "creation_date": 1557321615, "answer_id": 56041817, "question_id": 56041232, "link": "https://stackoverflow.com/questions/56041232/fill-an-array-at-index-n-with-m-times-data-without-bit-fields/56041817#56041817", "title": "Fill an array at index n with m times data without bit-fields", "body": "<ul>\n<li><p>Either just unroll the loop manually by typing out each line, or simply use <code>memcpy</code>. In this case there's no reason why you need abstraction layers, so I'd write the sanest possible code, which is just manual unrolling (and get rid of icky macros):</p>\n\n<pre><code>uint8_t local_transmit_buffer [8];\n...\nlocal_transmit_buffer[0] = EEPROM_CMD_WREN;\nlocal_transmit_buffer[1] = EEPROM_CMD_WRITE;\nlocal_transmit_buffer[2] = (uint8_t) ((MSQ_Buffer.address &gt;&gt; 8) &amp; 0xFFu);\nlocal_transmit_buffer[3] = (uint8_t) (MSQ_Buffer.address &amp; 0xFFu);\nlocal_transmit_buffer[4] = MSQ_Buffer.dataPointer[0];\nlocal_transmit_buffer[5] = MSQ_Buffer.dataPointer[1];\nlocal_transmit_buffer[6] = MSQ_Buffer.dataPointer[2];\nlocal_transmit_buffer[7] = MSQ_Buffer.dataPointer[3];\n</code></pre></li>\n<li><p>It is not obvious why you can't use a loop though, this doesn't look like the actual EEPROM programming (where overhead code might cause hiccups), but just preparations for it. Start to question such requirements.</p></li>\n<li><p>Also note that you should <em>not</em> use <code>__UINT_FAST8_TYPE__</code> but <code>uint8_t</code>. Never use homebrewed types but always <code>stdint.h</code>. But you should not be using <code>fast</code> types for a RAM buffer used for EEPROM programming, because it cannot be allowed to contain padding, ever. This is a bug.</p></li>\n</ul>\n"}], "owner": {"reputation": 31, "user_id": 9969946, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-9M9fOBRvkhM/AAAAAAAAAAI/AAAAAAAAAG0/BbqO45ISu2E/photo.jpg?sz=128", "display_name": "Markus Herzberg", "link": "https://stackoverflow.com/users/9969946/markus-herzberg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1557323100, "creation_date": 1557319840, "last_edit_date": 1557323100, "question_id": 56041232, "link": "https://stackoverflow.com/questions/56041232/fill-an-array-at-index-n-with-m-times-data-without-bit-fields", "title": "Fill an array at index n with m times data without bit-fields", "body": "<p>I try to send a maximum of 8 bytes of data. The first 4 bytes are always the same and involve defined commands and an address. The last 4 bytes should be variable.</p>\n\n<p>So far I'm using this approach. Unfortunatly I was told to not use any for loops in this case.</p>\n\n<pre><code>// Construct data\nlocal_transmit_buffer[0] = EEPROM_CMD_WREN;\nlocal_transmit_buffer[1] = EEPROM_CMD_WRITE;\nlocal_transmit_buffer[2] = High(MSQ_Buffer.address);\nlocal_transmit_buffer[3] = Low(MSQ_Buffer.address);\n\nuint_fast8_t i = 0;\nfor(i = 0; i &lt; MSQ_Buffer.byte_lenght || i &lt; 4; i++){ // assign data\n    local_transmit_buffer[i + 4] = MSQ_Buffer.dataPointer[i];\n} \n</code></pre>\n\n<p>This is some test code I'm trying to solve my problem:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n__UINT_FAST8_TYPE__ local_transmit_buffer[8];\n__UINT_FAST8_TYPE__ MSQ_Buffer_data[8];\n\n\nvoid print_local(){\nfor (int i = 0; i &lt; 8; i++)\n    {\n        printf(\"%d \", local_transmit_buffer[i]);\n    }\n    printf(\"\\n\");\n}\n\nvoid print_msg(){\nfor (int i = 0; i &lt; 8; i++)\n    {\n        printf(\"%d \", MSQ_Buffer_data[i]);\n    }\n    printf(\"\\n\");\n}\n\nint main(){\n    // assign all local values to 0\n    for (int i = 0; i &lt; 8; i++)\n    {\n        local_transmit_buffer[i] = 0;\n    } print_local();\n\n    // assign all msg values to 1\n    for (int i = 0; i &lt; 8; i++)\n    {\n        MSQ_Buffer_data[i] = i + 1;\n    } print_msg();\n\n    *(local_transmit_buffer + 3) = (__UINT_FAST32_TYPE__)MSQ_Buffer_data;\n\n    printf(\"\\n\");\n    print_local();\n\n    return 0;\n}\n</code></pre>\n\n<p>The first loops fills up the local_transmit_buffer with 0's and the MSQ_Buffer with 0,1,2,...\nlocal_transmit_buffer -> 0 0 0 0 0 0 0 0\nMSQ_Buffer_data       -> 1 2 3 4 5 6 7 8</p>\n\n<p>Now i want to assign the first 4 values of MSQ_Buffer_data to local_transmit_buffer like this:\nlocal_transmit_buffer -> 0 0 0 0 1 2 3 4</p>\n\n<p>Is there another way of solving this problem without using for loops or a bit_field?</p>\n\n<p><strong>Solved:</strong>\nI used the memcpy function to solve my problem</p>\n\n<pre><code>// uint_fast8_t i = 0;\n// for(i = 0; i &lt; MSQ_Buffer.byte_lenght || i &lt; 4; i++){ // assign data\n//     local_transmit_buffer[i + 4] = MSQ_Buffer.dataPointer[i];\n// } \n\n// copy a defined number data from the message to the local buffer to send\nmemcpy(&amp;local_transmit_buffer[4], &amp;MSQ_Buffer.dataPointer, local_save_data_length);\n</code></pre>\n"}, {"tags": ["c", "geometry"], "comments": [{"owner": {"reputation": 1082, "user_id": 9091276, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/05cFn.png?s=128&g=1", "display_name": "Frontear", "link": "https://stackoverflow.com/users/9091276/frontear"}, "edited": false, "score": 0, "creation_date": 1557318762, "post_id": 56040717, "comment_id": 98723630, "body": "It would be helpful if you could make clear what the issue is. As it stands, you&#39;ve just given us code and &quot;how?&quot;. Please attach the errors or unexpected behaviour you are facing"}], "answers": [{"tags": [], "owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "is_accepted": true, "score": 2, "last_activity_date": 1557322076, "last_edit_date": 1557322076, "creation_date": 1557318631, "answer_id": 56040848, "question_id": 56040717, "link": "https://stackoverflow.com/questions/56040717/how-to-display-the-total-sum-and-calculations-from-an-input-in-c/56040848#56040848", "title": "How to display the total sum and calculations from an input in C", "body": "<p>First some remarks on the current code</p>\n\n<p>Having</p>\n\n<blockquote>\n<pre><code> char choice;\n ...\n scanf (\"%s\", &amp;choice);\n</code></pre>\n</blockquote>\n\n<p>you write at least one character out of <em>choice</em> to put the null character, the behavior is undefined</p>\n\n<p>You want to enter a character do</p>\n\n<pre><code>scanf (\" %c\", &amp;choice);\n</code></pre>\n\n<p>the space before <code>%s</code> allowing to bypass the separators (newline / space)</p>\n\n<p>Why the <code>return 0;</code> if you want to loop up to 'Q' ? Remove it.</p>\n\n<p>Add newline at the end of all the prints giving a result to separate it with the question after (or of course replace \"Please enter a shape...\" by \"\\nPlease enter a shape...\" to not have it on the same line of the previous print)</p>\n\n<p>I encourage you to check something valid is enter through the <em>scanf</em>, else you cannot know if for instance an integer was enter for <code>scanf(\"%d\", &amp;radius);</code>, so check <em>scanf</em> returns 1</p>\n\n<blockquote>\n  <p>I expect that this is done through an array, but I'm unsure how arrays work.</p>\n</blockquote>\n\n<p>You do not need array(s), for 'a' 'b' 'c' and 'd' the sums can be updated each time, for 'e' update the product each time then at the end do the <em>square</em></p>\n\n<p>Anyway if you prefer to memorize you need several arrays, one for each topic, you have two solutions :</p>\n\n<ul>\n<li>you use statically sized arrays, and in that case you have to limit the number of inputs to not go out of it</li>\n<li>you use dynamic array using <em>malloc</em> then <em>realloc</em> to increase their size</li>\n</ul>\n\n<p>then at the end ('Q') you compute the needed value from the arrays content</p>\n\n<hr>\n\n<p>For instance managing 'a' and 'e' in the two ways depending on the preprocessor identifier ARRAYS :</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;math.h&gt;\n\n#ifdef ARRAYS\ntypedef struct Vector {\n  float * values;\n  size_t nValues;\n} Vector;\n\n// initialize the array, must be called because to add values\nvoid init(Vector * v)\n{\n  v-&gt;values = malloc(0);\n  v-&gt;nValues = 0;\n}\n\n// a a new value into the vector\nvoid add(Vector * v, float f)\n{\n  v-&gt;values = realloc(v-&gt;values, (++v-&gt;nValues) * sizeof(float));\n  v-&gt;values[v-&gt;nValues - 1] = f;\n}\n\n// print the content of the array\nvoid pr(Vector * v, const char * what)\n{\n  printf(\"there are %d %s :\", v-&gt;nValues, what);\n  for (size_t i = 0; i != v-&gt;nValues; ++i)\n    printf(\" %.02f\", v-&gt;values[i]);\n  putchar('\\n');\n}\n#endif\n\nint main ()\n{\n  float PI = 3.1415;\n  char choice;\n  float area, parameter;\n  int radius, side, length, width;\n#ifdef ARRAYS\n  Vector calculations, areas;\n\n  init(&amp;calculations);\n  init(&amp;areas);\n#else\n  int calcNumber = 0;\n  float prodAreas = 1;\n#endif\n\n  do {\n    printf(\"Please enter a shape(C:Circle, S:Square, R:Rectangle, Q:Quit&gt; \");\n    scanf (\" %c\", &amp;choice);\n\n    switch (choice) {\n    case 'C':\n      printf (\"Enter a radius of the circle: \");\n      if (scanf (\"%d\", &amp;radius) != 1) {\n        puts(\"invalid value\");\n        return -1;\n      }\n      area = (2 * radius) * PI;\n      parameter = 2 * PI * radius;\n      printf (\"The area of the circle is %.02f and parameter is %.02f\\n\",\n              area, parameter);\n#ifdef ARRAYS\n      add(&amp;calculations, area);\n      add(&amp;areas, area);\n      add(&amp;calculations, parameter);\n#else\n      calcNumber += 2;\n      prodAreas *= area;\n#endif\n      break;\n\n    case 'S':\n      printf (\"Enter the side of the square: \");\n      if (scanf (\"%d\", &amp;side) != 1) {\n        puts(\"invalid value\");\n        return -1;\n      }\n      area = side * side;\n      parameter = 4 * side;\n      printf (\"The area of the circle is %.02f and parameter is %.02f\\n\",\n              area, parameter);\n#ifdef ARRAYS\n      add(&amp;calculations, area);\n      add(&amp;areas, area);\n      add(&amp;calculations, parameter);\n#else\n      calcNumber += 2;\n      prodAreas *= area;\n#endif\n      break;\n\n    case 'R':\n      printf (\"Enter the width of the rectangle: \");\n     if ( scanf (\"%d\", &amp;width) != 1) {\n        puts(\"invalid value\");\n        return -1;\n      }\n      printf (\"Enter the length of the rectangle: \");\n      if (scanf (\"%d\", &amp;length) != 1) {\n        puts(\"invalid value\");\n        return -1;\n      }\n      area = length * width;\n      parameter = (2 * length) + (2 * width);\n      printf (\"The area of the circle is %.02f and parameter is %.02f\\n\",\n              area, parameter);\n#ifdef ARRAYS\n      add(&amp;calculations, area);\n      add(&amp;areas, area);\n      add(&amp;calculations, parameter);\n#else\n      calcNumber += 2;\n      prodAreas *= area;\n#endif\n      break;\n\n    case 'Q':\n      puts (\"Thank and bye\");\n      break;\n\n    default:\n      puts (\"Invalid input\");\n    }\n  } while (choice != 'Q');\n\n#ifdef ARRAYS\n  pr(&amp;calculations, \"calculations\");\n\n  pr(&amp;areas, \"areas\");\n\n  float e = 1;\n\n  for (size_t i = 0; i != areas.nValues; ++i)\n    e *= areas.values[i];\n  printf(\"square root of the product of all areas : %.02f\\n\", sqrt(e));\n#else\n  printf(\"there are %d calculations\\n\", calcNumber);\n  printf(\"square root of the product of all areas : %.02f\\n\", sqrt(prodAreas));\n#endif\n\n  return 0;\n}\n</code></pre>\n\n<p>Compilation and execution using arrays :</p>\n\n<pre><code>pi@raspberrypi:/tmp $ gcc -DARRAYS -pedantic -Wall  -Wextra c.c -lm\npi@raspberrypi:/tmp $ ./a.out\nPlease enter a shape(C:Circle, S:Square, R:Rectangle, Q:Quit&gt; C\nEnter a radius of the circle: 1\nThe area of the circle is 6.28 and parameter is 6.28\nPlease enter a shape(C:Circle, S:Square, R:Rectangle, Q:Quit&gt; S\nEnter the side of the square: 1\nThe area of the circle is 1.00 and parameter is 4.00\nPlease enter a shape(C:Circle, S:Square, R:Rectangle, Q:Quit&gt; Q\nThank and bye\nthere are 4 calculations : 6.28 6.28 1.00 4.00\nthere are 2 areas : 6.28 1.00\nsquare root of the product of all areas : 2.51\npi@raspberrypi:/tmp $ \n</code></pre>\n\n<p>Compilation and execution without arrays :</p>\n\n<pre><code>pi@raspberrypi:/tmp $ gcc -pedantic -Wall  -Wextra c.c -lm\npi@raspberrypi:/tmp $ ./a.out\nPlease enter a shape(C:Circle, S:Square, R:Rectangle, Q:Quit&gt; C\nEnter a radius of the circle: 1\nThe area of the circle is 6.28 and parameter is 6.28\nPlease enter a shape(C:Circle, S:Square, R:Rectangle, Q:Quit&gt; S\nEnter the side of the square: 1\nThe area of the circle is 1.00 and parameter is 4.00\nPlease enter a shape(C:Circle, S:Square, R:Rectangle, Q:Quit&gt; Q\nThank and bye\nthere are 4 calculations\nsquare root of the product of all areas : 2.51\n</code></pre>\n\n<p>I let you doing for 'b' 'c' and 'd'</p>\n"}], "owner": {"reputation": 23, "user_id": 11469875, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156924651556251/picture?type=large", "display_name": "Shaun Bedford", "link": "https://stackoverflow.com/users/11469875/shaun-bedford"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "accepted_answer_id": 56040848, "answer_count": 1, "score": 0, "last_activity_date": 1557322076, "creation_date": 1557318163, "last_edit_date": 1557321715, "question_id": 56040717, "link": "https://stackoverflow.com/questions/56040717/how-to-display-the-total-sum-and-calculations-from-an-input-in-c", "title": "How to display the total sum and calculations from an input in C", "body": "<p>I'm doing an assessment and have to write a short program in C to enter vertices and side size to display perimeter and area of a polygon. \nWhen the program is terminated, I have to display:</p>\n\n<ul>\n<li>a. total number of calculations performed</li>\n<li>b. sum of all vertices</li>\n<li>c. sum of all sides sizes</li>\n<li>d. sum of all perimeters</li>\n<li>e. square root of the product of all areas</li>\n</ul>\n\n<p>How is this this done in C? Thanks</p>\n\n<p>I tried storing these in an array and then display them</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main() {\n    float PI = 3.1415;\n    char choice;\n    float area, parameter;\n    int radius, side, length, width;\n\n    do {\n        printf(\"Please enter a shape(C:Circle, S:Square, R:Rectangle, Q:Quiit&gt; \");\n        scanf(\"%s\", &amp;choice);\n\n        switch (choice) {\n          case 'C':\n            printf(\"Enter a radius of the circle: \");\n            scanf(\"%d\", &amp;radius);\n            area = (2 * radius) * PI;\n            parameter = 2 * PI * radius;\n            printf(\"The area of the circle is %.02f and parameter is %.02f\",\n                   area, parameter);\n            break;\n\n          case 'S':\n            printf(\"Enter the side of the square: \");\n            scanf(\"%d\", &amp;side);\n            area = side * side;\n            parameter = 4 * side;\n            printf(\"The area of the circle is %.02f and parameter is %.02f\",\n                   area, parameter);\n            break;\n\n          case 'R':\n            printf(\"Enter the width of the rectangle: \");\n            scanf(\"%d\", &amp;width);\n            printf(\"Enter the length of the rectangle: \");\n            scanf(\"%d\", &amp;length);\n            area = length * width;\n            parameter = (2 * length) + (2 * width);\n            printf(\"The area of the circle is %.02f and parameter is %.02f\",\n                   area, parameter);\n            break;\n\n          case 'Q':\n            printf (\"Thank and bye\");\n            break;\n\n          default:\n            printf (\"Invalid input\");\n        }\n        return 0;\n    } while (choice != 'Q');\n}\n</code></pre>\n\n<p>I expect that this is done through an array, but I'm unsure how arrays work.</p>\n"}, {"tags": ["c", "sockets", "recv"], "comments": [{"owner": {"reputation": 22777, "user_id": 133203, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Fp3hB.jpg?s=128&g=1", "display_name": "Federico klez Culloca", "link": "https://stackoverflow.com/users/133203/federico-klez-culloca"}, "edited": false, "score": 0, "creation_date": 1557317834, "post_id": 56040596, "comment_id": 98723086, "body": "Yes you can, but you should show your code. Otherwise we&#39;re just shooting in the dark."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 3, "creation_date": 1557317942, "post_id": 56040596, "comment_id": 98723150, "body": "Sockets send and receive bytes. How are you encoding your text into bytes?"}, {"owner": {"reputation": 594, "user_id": 1056380, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/rA1Uv.jpg?s=128&g=1", "display_name": "ManKeer", "link": "https://stackoverflow.com/users/1056380/mankeer"}, "reply_to_user": {"reputation": 22777, "user_id": 133203, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Fp3hB.jpg?s=128&g=1", "display_name": "Federico klez Culloca", "link": "https://stackoverflow.com/users/133203/federico-klez-culloca"}, "edited": false, "score": 0, "creation_date": 1557318293, "post_id": 56040596, "comment_id": 98723362, "body": "@FedericoklezCulloca, I have modified the question and I have added the piece of code which is responsible for receiving the data."}, {"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 0, "creation_date": 1557318347, "post_id": 56040596, "comment_id": 98723391, "body": "If you print the bytes you\u2019re receiving as numbers (e.g. <code>%02x</code>), what shows up? That\u2019ll be helpful in determining whether the encoding problem is with the sender or receiver."}, {"owner": {"reputation": 594, "user_id": 1056380, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/rA1Uv.jpg?s=128&g=1", "display_name": "ManKeer", "link": "https://stackoverflow.com/users/1056380/mankeer"}, "reply_to_user": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 0, "creation_date": 1557318899, "post_id": 56040596, "comment_id": 98723712, "body": "@Ry-, Any arabic character appears as 3F as hexa decimal value."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1557318928, "post_id": 56040596, "comment_id": 98723733, "body": "OK, now do the same thing on the sender side."}, {"owner": {"reputation": 594, "user_id": 1056380, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/rA1Uv.jpg?s=128&g=1", "display_name": "ManKeer", "link": "https://stackoverflow.com/users/1056380/mankeer"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1557319017, "post_id": 56040596, "comment_id": 98723784, "body": "@melpomene, unfortunately I can&#39;t, the sender is another application that I don&#39;t have any access to its code......."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 2, "creation_date": 1557319101, "post_id": 56040596, "comment_id": 98723836, "body": "But that&#39;s where your problem is, because the sender is literally sending you <code>?</code> characters."}, {"owner": {"reputation": 2149, "user_id": 2096401, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uVjii.jpg?s=128&g=1", "display_name": "TripeHound", "link": "https://stackoverflow.com/users/2096401/tripehound"}, "edited": false, "score": 1, "creation_date": 1557319144, "post_id": 56040596, "comment_id": 98723870, "body": "@ManKeer If you&#39;re <i>receiving</i> a stream of bytes (which is what <code>recv()</code> does), and printing them as a stream of bytes (code not shown) and seeing <code>?</code>/<code>0x3F</code> then it is the <i>other side</i> that has already mangled the characters."}, {"owner": {"reputation": 594, "user_id": 1056380, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/rA1Uv.jpg?s=128&g=1", "display_name": "ManKeer", "link": "https://stackoverflow.com/users/1056380/mankeer"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1557319210, "post_id": 56040596, "comment_id": 98723913, "body": "@melpomene, I agree with you, but when I visit the logs of that application, I see the message is written correctly without any mistaken character."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 2, "creation_date": 1557319689, "post_id": 56040596, "comment_id": 98724220, "body": "@ManKeer What the other app writes to its logs is not necessarily the same as what it sent on the network."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1557344098, "post_id": 56040596, "comment_id": 98737317, "body": "@ManKeer what the app writes to its log file, and what it transmits over the socket connection, are two completely different and unrelated things. Just because the characters appear correctly in the log file does not guarantee they are being sent over the socket correctly. And from the sounds of it, the app is NOT transmitting the characters correctly."}], "owner": {"reputation": 594, "user_id": 1056380, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/rA1Uv.jpg?s=128&g=1", "display_name": "ManKeer", "link": "https://stackoverflow.com/users/1056380/mankeer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1557318205, "creation_date": 1557317763, "last_edit_date": 1557318205, "question_id": 56040596, "link": "https://stackoverflow.com/questions/56040596/receiving-arabic-character-from-socket-in-c", "title": "receiving arabic character from socket in C", "body": "<p>I have an application written in ANSI C, the application is receiving messages through a socket, messages contains mixed arabic and english characters, all arabic characters received as \"?\", I'm using the recv function, which stores the received data in a char*, I have tried to change it to wchar_t* but unfortunately, it doesn't work.</p>\n\n<p>here's a code snippet that receive the message:</p>\n\n<pre><code>iReceiveLen = recv( g_iFIXSock, pszMsgData + iUsedLen, 1, 0 );\nif( iReceiveLen &gt; 0)\n{\n     // I do some extra coding here \n}\n</code></pre>\n\n<p>it's clear that I'm receiving character by character, however, I have changed the code to receive a block of 100 characters at a time, but still it doesn't work....</p>\n\n<p>How can I receive the message correctly?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 5, "creation_date": 1557316714, "post_id": 56040278, "comment_id": 98722468, "body": "The address that is shown is indetermined. It may be the same on each run or not. It totally depends on the underlying system. And it&#39;s most likely a virtual address, but once again it depends on the underlying system."}, {"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 0, "creation_date": 1557316842, "post_id": 56040278, "comment_id": 98722546, "body": "<i>Is it in the virtual memory or physical memory?</i> also totally depends on the underlying system"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 2, "creation_date": 1557322293, "post_id": 56040278, "comment_id": 98725925, "body": "Incidentally, when printing pointers with <code>%p</code>, convert them to <code>void *</code>: <code>printf(&quot;a&#39;s address is %p\\n&quot;, (void *) &amp;a);</code>. That is the proper way as defined in the C standard."}], "answers": [{"tags": [], "owner": {"reputation": 6751, "user_id": 1417063, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mwy5e.jpg?s=128&g=1", "display_name": "Davide Spataro", "link": "https://stackoverflow.com/users/1417063/davide-spataro"}, "is_accepted": false, "score": 3, "last_activity_date": 1557317001, "creation_date": 1557317001, "answer_id": 56040388, "question_id": 56040278, "link": "https://stackoverflow.com/questions/56040278/is-the-first-variable-address-fixed-in-main-function/56040388#56040388", "title": "Is the first variable address fixed in main function?", "body": "<h2><strong>No</strong> the address is not fixed.</h2>\n\n<p>It is up to your OS to decide where the program is loaded and consequently to which address the variable is assigned.</p>\n\n<p>If the address is physical of virtual, it depends on your OS as well. It decides how to manage memory.</p>\n"}, {"tags": [], "owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "is_accepted": true, "score": 5, "last_activity_date": 1557317313, "creation_date": 1557317313, "answer_id": 56040469, "question_id": 56040278, "link": "https://stackoverflow.com/questions/56040278/is-the-first-variable-address-fixed-in-main-function/56040469#56040469", "title": "Is the first variable address fixed in main function?", "body": "<p>On some systems, <a href=\"https://en.wikipedia.org/wiki/Address_space_layout_randomization\" rel=\"noreferrer\">ASLR</a> is enabled, and for good reasons.</p>\n\n<p>For example, on my Linux/Debian/Sid x86-64 your program gives each time different addresses:</p>\n\n<pre><code>repeat 10 tmp/sange\na's address is 0x7fff2768303c\na's address is 0x7ffc5d26a57c\na's address is 0x7ffcc0a4b2ac\na's address is 0x7ffeec95fd7c\na's address is 0x7ffefd5318dc\na's address is 0x7ffc544497bc\na's address is 0x7fff232f7dac\na's address is 0x7fff9dd3b65c\na's address is 0x7fff9e6858dc\na's address is 0x7ffc2876d4bc\n</code></pre>\n\n<p>To learn more, read about <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"noreferrer\">undefined behavior</a> (e.g. <a href=\"http://blog.llvm.org/2011/05/what-every-c-programmer-should-know.html\" rel=\"noreferrer\">Lattner's blog</a>), <a href=\"https://en.wikipedia.org/wiki/Unspecified_behavior\" rel=\"noreferrer\">unspecified behavior</a>, and read a good textbook about operating systems, e.g. <a href=\"http://pages.cs.wisc.edu/~remzi/OSTEP/\" rel=\"noreferrer\"><em>Operating Systems: Three Easy Pieces</em></a> (freely downloadable)</p>\n\n<p>Read also about <a href=\"https://en.wikipedia.org/wiki/Virtual_address_space\" rel=\"noreferrer\">virtual address space</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": false, "score": 2, "last_activity_date": 1557317373, "creation_date": 1557317373, "answer_id": 56040485, "question_id": 56040278, "link": "https://stackoverflow.com/questions/56040278/is-the-first-variable-address-fixed-in-main-function/56040485#56040485", "title": "Is the first variable address fixed in main function?", "body": "<p>In any normal multi-user operating system, the addresses in your process will be virtual addresses. This is because, in normal multi-user operating systems, the operating system uses virtual address spaces to keep programs independent of each other.</p>\n\n<p>The address space of your program is set up in part by a process called the loader, which loads the initial data and code of your program into memory. A simple loader will start the stack of a new program at a fixed location\u2014it will use the same starting location every time it loads a program. Then, when your program runs, <code>a</code> will always be at the same address. Loaders operated this way for many years.</p>\n\n<p>Because malicious people can sometimes take advantage of known stack addresses to attack and subvert software, some loaders now use random addresses when loading programs. This is called address space layout randomization (ASLR). When your program is loaded with a loader using ASLR, the address of <code>a</code> will vary from run to run.</p>\n"}], "owner": {"reputation": 39, "user_id": 10379237, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-BdzUtXkecK8/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaP-F6KKkVaK74CmpUljgKeKqtkDHA/mo/photo.jpg?sz=128", "display_name": "s ange", "link": "https://stackoverflow.com/users/10379237/s-ange"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 56040469, "answer_count": 3, "score": 0, "last_activity_date": 1557317373, "creation_date": 1557316665, "question_id": 56040278, "link": "https://stackoverflow.com/questions/56040278/is-the-first-variable-address-fixed-in-main-function", "title": "Is the first variable address fixed in main function?", "body": "<p>When I was trying to print the address of the first variable in main function, I found that the result is always same after running few times. Why? Is it in the virtual memory or physical memory?</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n    int a;\n\n    printf(\"a's address is %p\\n\", &amp;a);\n\n    return 0;\n}\n\n</code></pre>\n\n<p>I expect the output will be different every time, but the actual output is always 0028FF3C</p>\n"}, {"tags": ["javascript", "c", "emscripten", "webassembly", "openh264"], "answers": [{"comments": [{"owner": {"reputation": 98, "user_id": 4117270, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/000c959050f333ebdd48d4a9868bc25d?s=128&d=identicon&r=PG&f=1", "display_name": "Kuldeep More", "link": "https://stackoverflow.com/users/4117270/kuldeep-more"}, "edited": false, "score": 0, "creation_date": 1557388727, "post_id": 56053382, "comment_id": 98750192, "body": "I done some R&amp;D on this issue and I think that the issue is not at the java script side. I think the make file command for emscripten having some issue. The make file command is like  &quot;em++ -O1 $(TOTALMEMORY) -o $@ $^ -s EXPORTED_FUNCTIONS=$(h264symbols) -s  -Iopenh264/codec/api/svc/ &quot;. So after some R&amp;D on this I found out that you need to add &quot;EXTRA_EXPORTED_RUNTIME_METHODS=&#39;[&quot;cwrap&quot;]&#39; option. I have edited cmd with this option and now am getting error like TypeError: Module.asm._open_decoder is undefined."}, {"owner": {"reputation": 5580, "user_id": 662345, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/39d2ea0a36d1740e5f544076955a4b30?s=128&d=identicon&r=PG", "display_name": "Antonis Christofides", "link": "https://stackoverflow.com/users/662345/antonis-christofides"}, "edited": false, "score": 0, "creation_date": 1612372248, "post_id": 56053382, "comment_id": 116748522, "body": "From the emscripten docs: cwrap does not actually call compiled code (only calling the wrapper it returns does that). That means that it is safe to call cwrap early, before the runtime is fully initialized (but calling the returned wrapped function must wait for the runtime, of course, like calling compiled code in general). <a href=\"https://emscripten.org/docs/api_reference/preamble.js.html?highlight=cwrap#cwrap\" rel=\"nofollow noreferrer\">emscripten.org/docs/api_reference/&hellip;</a>"}], "tags": [], "owner": {"reputation": 4858, "user_id": 5739035, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-RQUt7m42pBk/AAAAAAAAAAI/AAAAAAAAAyw/mLHBtE-PQic/photo.jpg?sz=128", "display_name": "Adi Levin", "link": "https://stackoverflow.com/users/5739035/adi-levin"}, "is_accepted": false, "score": 1, "last_activity_date": 1557383235, "creation_date": 1557383235, "answer_id": 56053382, "question_id": 56040210, "link": "https://stackoverflow.com/questions/56040210/uncaught-typeerror-module-cwrap-is-not-a-function/56053382#56053382", "title": "Uncaught TypeError: Module.cwrap is not a function", "body": "<p>Probably you are trying to use <code>Module</code> before the Emscripten runtime has been initialized, so <code>Module.cwrap</code> is undefined.</p>\n\n<p>To make sure the runtime is ready, place your code inside of <code>Module.onRuntimeInitialized</code>, as in the following example:</p>\n\n<pre><code>&lt;!doctype html&gt;\n&lt;html&gt;\n&lt;body&gt;\n    &lt;script&gt;\n        var Module = {\n          onRuntimeInitialized: function() {\n            my_add = Module.cwrap('my_add', 'number', ['number', 'number'])\n            alert('1 + 2 = ' + my_add(1, 2));\n          },\n        };\n    &lt;/script&gt;\n    &lt;script async type=\"text/javascript\" src=\"index.js\"&gt;&lt;/script&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>See full example in <a href=\"https://github.com/adilevin/wasm/blob/master/ccall-add/src/index.html\" rel=\"nofollow noreferrer\">this github repo</a></p>\n"}, {"tags": [], "owner": {"reputation": 1959, "user_id": 3659387, "user_type": "registered", "accept_rate": 3, "profile_image": "https://i.stack.imgur.com/swdXW.jpg?s=128&g=1", "display_name": "Anil8753", "link": "https://stackoverflow.com/users/3659387/anil8753"}, "is_accepted": false, "score": 4, "last_activity_date": 1576429100, "creation_date": 1576429100, "answer_id": 59346087, "question_id": 56040210, "link": "https://stackoverflow.com/questions/56040210/uncaught-typeerror-module-cwrap-is-not-a-function/59346087#59346087", "title": "Uncaught TypeError: Module.cwrap is not a function", "body": "<pre><code>-s EXTRA_EXPORTED_RUNTIME_METHODS=[\"cwrap\"]\n</code></pre>\n\n<p>Include above in command line while compiling your source</p>\n\n<pre><code>emcc source.c -s EXPORTED_FUNCTIONS=['_my_add'] -s EXTRA_EXPORTED_RUNTIME_METHODS=[\"cwrap\"]\n</code></pre>\n"}], "owner": {"reputation": 98, "user_id": 4117270, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/000c959050f333ebdd48d4a9868bc25d?s=128&d=identicon&r=PG&f=1", "display_name": "Kuldeep More", "link": "https://stackoverflow.com/users/4117270/kuldeep-more"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1852, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1576429100, "creation_date": 1557316397, "question_id": 56040210, "link": "https://stackoverflow.com/questions/56040210/uncaught-typeerror-module-cwrap-is-not-a-function", "title": "Uncaught TypeError: Module.cwrap is not a function", "body": "<p>I need to decode h264 data at browser side for that I am using openh264 library build in web Assembly using emscripten.\nI have build it successfully and tried to use it in java script to decode the h264 data. But I am getting one error for following line,</p>\n\n<pre><code>var open_decoder = Module.cwrap('open_decoder', 'number', null);\n</code></pre>\n\n<p>Error is: Uncaught TypeError: Module.cwrap is not a function</p>\n\n<p>If anyone has has build openh264 with emscripten please help me to figure out issue.</p>\n\n<p>Following steps I have used to build openh264 with emscripten.</p>\n\n<ol>\n<li>$ source emsdk_env.sh</li>\n<li>$./emsdk activate latest  </li>\n<li>cd openh264-js-master</li>\n<li>make</li>\n</ol>\n\n<p>Note : The code for openh264 has been downloaded from github( ttyridal) and already has make file with emscripten competent.</p>\n"}, {"tags": ["c", "linux", "tty", "ioctl"], "comments": [{"owner": {"reputation": 154, "user_id": 6846456, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xj3rK.png?s=128&g=1", "display_name": "Filius Patris", "link": "https://stackoverflow.com/users/6846456/filius-patris"}, "edited": false, "score": 0, "creation_date": 1557316428, "post_id": 56040168, "comment_id": 98722320, "body": "Note: I tried it with 1 and 0 as argument; both fail."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1557357515, "post_id": 56040168, "comment_id": 98741744, "body": "Note: I suggest not assuming that all the terminals are in /dev if possible; it should take /dev/ttyWhatever as a parameter instead of just ttyWhatever."}], "owner": {"reputation": 154, "user_id": 6846456, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xj3rK.png?s=128&g=1", "display_name": "Filius Patris", "link": "https://stackoverflow.com/users/6846456/filius-patris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 128, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1557316263, "creation_date": 1557316263, "question_id": 56040168, "link": "https://stackoverflow.com/questions/56040168/linux-ioctl-for-tty-gives-eperm", "title": "Linux ioctl for tty gives EPERM", "body": "<p>I try to implement a <a href=\"https://en.wikipedia.org/wiki/Getty_(Unix)\" rel=\"nofollow noreferrer\">getty</a> program (the program, which acquires a specific tty, sets it to stdin, stdout and stderr and executes the login process normally; The typical implementation is <code>agetty</code>).</p>\n\n<p>My problem is, it always gives me an EPERM error in the line with the <code>ioctl</code> call, which should change the controlling terminal.</p>\n\n<p>The manpage about <code>ioctl_tty(2)</code> says:</p>\n\n<blockquote>\n<pre><code>   TIOCSCTTY int arg\n          Make the given terminal the controlling terminal of the calling process.  The calling  process  must  be  a  session\n          leader and not have a controlling terminal already.  For this case, arg should be specified as zero.\n\n          If  this terminal is already the controlling terminal of a different session group, then the ioctl fails with EPERM,\n          unless the caller has the CAP_SYS_ADMIN capability and arg equals 1, in which case the terminal is stolen,  and  all\n          processes that had it as controlling terminal lose it.\n</code></pre>\n</blockquote>\n\n<p>Now, if I just for test run it with superuser privileges (that means GID and UID = 0) theoretically the kernel should just skip the capabilities checks, according to the manpage <code>capabilities(7)</code>.</p>\n\n<p>So what's wrong with the following code, when run as root:</p>\n\n<pre><code>#include &lt;termios.h&gt;\n#include &lt;stropts.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;string.h&gt;\n#include &lt;sys/ioctl.h&gt;\n\nint main (int argc, char **argv) {\n    char path[50] = \"/dev/\";\n    if (argc &gt; 1) strcat (path, argv[1]);\n            /* First argument is tty device name */\n    else return 1;\n\n    int fd = open (path, O_RDWR, 0);\n    if (fd == -1) return 1;\n\n    ioctl (fd, TIOCSCTTY, 1); /* Here is the error */\n}\n</code></pre>\n"}, {"tags": ["c", "ruby", "ruby-c-extension"], "answers": [{"tags": [], "owner": {"reputation": 4052, "user_id": 476979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e55df1cc7d5fdb4ae9bc2afcb9afe7e4?s=128&d=identicon&r=PG", "display_name": "matthewd", "link": "https://stackoverflow.com/users/476979/matthewd"}, "is_accepted": true, "score": 3, "last_activity_date": 1557330791, "creation_date": 1557330791, "answer_id": 56044615, "question_id": 56040163, "link": "https://stackoverflow.com/questions/56040163/is-memory-freed-after-using-stringvaluecstr/56044615#56044615", "title": "Is memory freed after using StringValueCStr?", "body": "<p><code>StringValueCStr</code> returns the same pointer that <code>StringValuePtr</code> does -- which is the internal string buffer of the object.</p>\n\n<p>That buffer could change or be invalidated by any subsequent mutation of the String instance (or, of course, a garbage collection), so yes you should copy it if you need to keep it around.</p>\n"}], "owner": {"reputation": 1490, "user_id": 450651, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/9c17b51b0d1e779c2e9b0d41a9d0e888?s=128&d=identicon&r=PG", "display_name": "bigoldbrute", "link": "https://stackoverflow.com/users/450651/bigoldbrute"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "accepted_answer_id": 56044615, "answer_count": 1, "score": 1, "last_activity_date": 1557330791, "creation_date": 1557316251, "question_id": 56040163, "link": "https://stackoverflow.com/questions/56040163/is-memory-freed-after-using-stringvaluecstr", "title": "Is memory freed after using StringValueCStr?", "body": "<p>I use StringValueCStr to convert ruby String to char*. Do i need to free memory when this new C string is no longer needed?</p>\n\n<p>If this new C string is freed automatically, does this mean i should copy it if i plan on saving it in my C structures for later use?</p>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1557314632, "post_id": 56039568, "comment_id": 98721354, "body": "&quot;<i>if the values stored in the array are:</i>&quot; Yes. <b>If</b>. But that&#39;s not what&#39;s stored in your array."}], "answers": [{"tags": [], "owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "is_accepted": false, "score": 4, "last_activity_date": 1557315024, "last_edit_date": 1557315024, "creation_date": 1557314788, "answer_id": 56039712, "question_id": 56039568, "link": "https://stackoverflow.com/questions/56039568/why-dont-the-values-i-type-in-the-terminal-match-the-values-ive-already-stored/56039712#56039712", "title": "Why don&#39;t the values I type in the terminal match the values I&#39;ve already stored in the array?", "body": "<p>This here is wrong:</p>\n\n<pre><code>scanf(\"%d\", array);\n</code></pre>\n\n<p>It stores the read in value in the first element. Since it stores them all there, it just overwrites it all the time, resulting with your last value in <code>array[0]</code> and the rest is uninitialized. Do this instead:</p>\n\n<pre><code>scanf(\"%d\", &amp;array[i]);\n</code></pre>\n\n<p>The same goes for the debugging print, it should be:</p>\n\n<pre><code>printf(\"%i weighs %dg\\n\", i, array[i]);\n</code></pre>\n\n<p>Also, there's a problem here:</p>\n\n<pre><code>printf(\"The weight of this ingredient is: %d\\n\", ingredient[array]);\n</code></pre>\n\n<p><code>ingredient[array]</code> is <code>array[ingredient]</code> (<a href=\"https://stackoverflow.com/a/381549/10411602\">explanation here</a>), but <code>ingredient</code> is always <code>0</code> because you don't change it. Hence it's always reading that first element of the array (the element that you set last, due to the other issue). Do <code>array[store]</code> instead. You can remove the <code>ingredient</code> variable, it's unneeded.</p>\n"}], "owner": {"reputation": 25, "user_id": 11405083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c32183190a604852c9140e5a10ad77f?s=128&d=identicon&r=PG&f=1", "display_name": "llleyylllla", "link": "https://stackoverflow.com/users/11405083/llleyylllla"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1557315024, "creation_date": 1557314348, "last_edit_date": 1557314681, "question_id": 56039568, "link": "https://stackoverflow.com/questions/56039568/why-dont-the-values-i-type-in-the-terminal-match-the-values-ive-already-stored", "title": "Why don&#39;t the values I type in the terminal match the values I&#39;ve already stored in the array?", "body": "<p>I'm making a program that will let me read an integer entered at the terminal via the <code>scanf</code> function, and generate its assigned value from the array that has been created already. Here is the program's description: </p>\n\n<blockquote>\n  <p>Your program must read 10 integers (the quantities needed for each of the ingredients, in order) and store them in an array. It should then read an integer which represents an ingredient's ID number (between 0 and 9), and output the corresponding quantity.</p>\n</blockquote>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main () {\n    int array[10];\n    int store = 0;\n    int i = 0;\n    printf(\"write how much the ingredients weigh in grams\\n\");\n    for (i=0; i&lt;10; i++) {\n        scanf(\"%d\", array);\n        printf(\"%i weighs %dg\\n\", i, array[store]);\n    } \n    printf(\"Which ingredient ID do you want to check the weight of? \");\n    int ingredient = 0;\n    scanf(\"%d\", &amp;store);\n    printf(\"The weight of this ingredient is: %d\\n\", ingredient[array]);\n}\n</code></pre>\n\n<p>For example, if the values stored in the array are: 23, 54, 12, 51, 11, 10, 99, 32, 9, 14 \nthen I would expect the program to print '12' when I type '2' after being prompted with the question \"Which ingredient id do you want to check the weight of?\"\nHowever, at the moment when I type the number '6' for example, it will generate the value assigned to the number '8'. So it will generate '9' instead of '99'.</p>\n\n<p>How can I fix this?</p>\n"}, {"tags": ["c", "arrays", "loops"], "comments": [{"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 5, "creation_date": 1557313843, "post_id": 56039324, "comment_id": 98720943, "body": "Maybe it would be an idea if you explained the rules..."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 2, "creation_date": 1557313990, "post_id": 56039324, "comment_id": 98721007, "body": "OT: <code>... roll_die(donkeyvalue);</code> seems strange when you have <code>int roll_die(void);</code>"}, {"owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "edited": false, "score": 0, "creation_date": 1557314061, "post_id": 56039324, "comment_id": 98721056, "body": "It is usually a good idea to separate variable declarations (place them on the first lines of a function) from the rest of the function body"}, {"owner": {"reputation": 11, "user_id": 11455551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff518702c5fd1873beeda9546cb69f24?s=128&d=identicon&r=PG&f=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/11455551/barry"}, "edited": false, "score": 0, "creation_date": 1557314232, "post_id": 56039324, "comment_id": 98721134, "body": "it took me an embarrassingly large amount of time to get the random number function to work, but it does. I have functions that display and varify this (not included above)."}, {"owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "edited": false, "score": 0, "creation_date": 1557314320, "post_id": 56039324, "comment_id": 98721180, "body": "Compile with a high level of warnings, and it will stop working :) <code>-Wall -Wextra -Werror</code>"}, {"owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "reply_to_user": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1557320567, "post_id": 56039324, "comment_id": 98724769, "body": "@chqrlie semantics didn&#39;t change. Offensive language?  Ok, anyway"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "edited": false, "score": 1, "creation_date": 1557320909, "post_id": 56039324, "comment_id": 98725014, "body": "@CacahueteFrito: sorry for implying that you changed the question in an offensive way, you actually restored the original text first edited out by <i>jonrsharpe</i>, probably because you had started the edit a while ago. However, changing the code to parenthesise macros, reorder declarations, and similar edits are not OK, you can provide such improvements in your answer, but the code in the question should not be amended this as it makes the discussion, comments and other answers inconsistent."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1557322094, "post_id": 56039324, "comment_id": 98725781, "body": "Wikipedia article: <a href=\"https://en.wikipedia.org/wiki/Poker_dice\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Poker_dice</a>"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1557382752, "post_id": 56039324, "comment_id": 98747378, "body": "@Barry: you can accept the answer by clicking on the grey checkmark below its score"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 11455551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff518702c5fd1873beeda9546cb69f24?s=128&d=identicon&r=PG&f=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/11455551/barry"}, "edited": false, "score": 0, "creation_date": 1557314966, "post_id": 56039662, "comment_id": 98721534, "body": "that&#39;s very helpful. thankyou. Previously, my thought pattern was to assign a direct result instead of ranking with an arbitary value."}, {"owner": {"reputation": 11, "user_id": 11455551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff518702c5fd1873beeda9546cb69f24?s=128&d=identicon&r=PG&f=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/11455551/barry"}, "edited": false, "score": 0, "creation_date": 1557315154, "post_id": 56039662, "comment_id": 98721640, "body": "there are no &quot;straights&quot; in this game, only looking for 5, 4 of a kind, two pair etc. I will have  look at that though."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 11, "user_id": 11455551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff518702c5fd1873beeda9546cb69f24?s=128&d=identicon&r=PG&f=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/11455551/barry"}, "edited": false, "score": 0, "creation_date": 1557315313, "post_id": 56039662, "comment_id": 98721740, "body": "@Barry: the tricky part is the relative ranking of similar hands."}, {"owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "edited": false, "score": 1, "creation_date": 1557315560, "post_id": 56039662, "comment_id": 98721877, "body": "Why <code>*</code>/<code>+</code> to do the job of <code>&amp;&amp;</code>/<code>||</code>? It works, but it&#39;s weird. Maths for maths; logic for logic"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "edited": false, "score": 1, "creation_date": 1557315952, "post_id": 56039662, "comment_id": 98722062, "body": "@CacahueteFrito: just for fun: you have a straight if you have exactly one of each of these: <code>2</code> <code>3</code> <code>4</code> and <code>5</code>. I modified the answer with both approaches :)"}], "tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 1, "last_activity_date": 1557320240, "last_edit_date": 1557320240, "creation_date": 1557314686, "answer_id": 56039662, "question_id": 56039324, "link": "https://stackoverflow.com/questions/56039324/using-loops-to-compute-dice-poker-outcome/56039662#56039662", "title": "Using loops to compute dice poker outcome", "body": "<p>From the array <code>player_die_count</code>, using loops, you can determine:</p>\n\n<ul>\n<li>the number of <em>five of a kind</em></li>\n<li>the number of <em>four of a kind</em></li>\n<li>the number of <em>three of a kind</em></li>\n<li>the number of pairs</li>\n</ul>\n\n<p>And using a simple formula, you can determine if you have a straight:</p>\n\n<pre><code>has_straight = (player_die_count[1] == 1 &amp;&amp; player_die_count[2] == 1 &amp;&amp;\n                player_die_count[3] == 1 &amp;&amp; player_die_count[4] == 1 &amp;&amp; \n                player_die_count[5] == 1) ||\n               (player_die_count[2] == 1 &amp;&amp; player_die_count[3] == 1 &amp;&amp;\n                player_die_count[4] == 1 &amp;&amp; player_die_count[5] == 1 &amp;&amp;\n                player_die_count[6] == 1);\n</code></pre>\n\n<p>Which can be simplified into:</p>\n\n<pre><code>has_straight = (player_die_count[2] * player_die_count[3] *\n                player_die_count[4] * player_die_count[5]) == 1;\n</code></pre>\n\n<p>Then you can compute the payer's hand value from <code>0</code> to <code>7</code>:</p>\n\n<ul>\n<li><em>Five of a kind</em>: 7 points</li>\n<li><em>Four of a kind</em>: 6 points</li>\n<li><em>Full house</em>: <em>three of a kind</em> plus a pair: 5 points</li>\n<li><em>Straight</em>: 4 points</li>\n<li><em>Three of a kind</em> : 3 points</li>\n<li><em>Two pairs</em> : 2 points</li>\n<li><em>One pair</em> : 1 point</li>\n<li><em>Bust</em>: 0 point</li>\n</ul>\n\n<p>You can refine the score by ranking the different combinations according to the values of the highest die. <em>five of a kind</em> of <code>6</code> beats <em>five of a kind</em> of <code>5</code>, etc.</p>\n\n<p>Here is a complete program that outputs the score and the draw for a number of draws either using <code>rand()</code> or using a sequential distribution of all combinations:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt;\n\n#define handsz 5\n#define diesz  6     // All dice played will have 6 sides, numbered 1 to 6\n\nstatic int roll_die(void) {\n    return 1 + rand() % 6;\n}\n\nint main(int argc, char *argv[]) {\n    int iter = 1;\n    int use_random = 1;\n\n    if (argc &gt; 1) {\n        iter = strtol(argv[1], NULL, 0);\n        if (iter &lt; 0) {\n            use_random = 0;\n            iter = -iter;\n        }\n    }\n\n    srand(clock());\n\n    for (int n = 0; n &lt; iter; n++) {\n        int player_hand[handsz];\n\n        if (use_random) {\n            for (int i = 0; i &lt; handsz; i++)\n                player_hand[i] = roll_die();\n        } else {\n            for (int i = 0, mm = n; i &lt; handsz; i++, mm /= 6)\n                player_hand[i] = 1 + mm % 6;\n        }\n\n        int player_die_count[7] = { 0 };\n        for (int i = 0; i &lt; handsz; i++) {\n            player_die_count[player_hand[i]] += 1;\n        }\n\n        int pairs, threes, fours, fives, score;\n        pairs = threes = fours = fives = score = 0;\n        for (int i = diesz; i &gt; 0; i--) {\n            switch (player_die_count[i]) {\n            case 5:\n                fives = i * 11111;\n                break;\n            case 4:\n                fours = i * 1111;\n                break;\n            case 3:\n                threes = i * 111;\n                break;\n            case 2:\n                pairs = pairs * 100 + i * 11;\n                break;\n            case 1:\n                score = score * 10 + i;\n                break;\n            }\n        }\n        if (fives)\n            score += 700000 + fives;\n        else\n        if (fours)\n            score += 600000 + fours * 10;\n        else\n        if (threes &amp;&amp; pairs)\n            score += 500000 + threes * 100 + pairs;\n        else\n#ifndef NO_STRAIGHTS\n        if (score == 54321 || score == 65432)\n            score += 400000;\n        else\n#endif\n        if (threes)\n            score += 300000 + threes * 100;\n        else\n        if (pairs &gt;= 100)\n            score += 200000 + pairs * 10;\n        else\n        if (pairs)\n            score += 100000 + pairs * 1000;\n\n        printf(\"%d: %d %d %d %d %d\\n\",\n               score, player_hand[0], player_hand[1],\n               player_hand[2], player_hand[3], player_hand[4]);\n    }\n    return 0;\n}\n</code></pre>\n\n<p>It is very interesting to run the program with an argument of <code>7776</code> to check the actual distribution provided by the simplistic <code>roll_die</code> function. On my system, the pseudo-random distribution sometimes gives surprising results:</p>\n\n<pre>\nchqrlie$ ./pokerdice 7776 | sort -nr | head -10\n755555: 5 5 5 5 5\n744444: 4 4 4 4 4\n744444: 4 4 4 4 4\n722222: 2 2 2 2 2\n711111: 1 1 1 1 1\n711111: 1 1 1 1 1\n711111: 1 1 1 1 1\n711111: 1 1 1 1 1\n666665: 6 6 6 5 6\n666665: 6 6 5 6 6\n</pre>\n"}], "owner": {"reputation": 11, "user_id": 11455551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff518702c5fd1873beeda9546cb69f24?s=128&d=identicon&r=PG&f=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/11455551/barry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "closed_date": 1557330291, "answer_count": 1, "score": 0, "last_activity_date": 1557330253, "creation_date": 1557313540, "last_edit_date": 1557330253, "question_id": 56039324, "link": "https://stackoverflow.com/questions/56039324/using-loops-to-compute-dice-poker-outcome", "closed_reason": "Needs details or clarity", "title": "Using loops to compute dice poker outcome", "body": "<p>I have a <a href=\"https://en.wikipedia.org/wiki/Poker_dice\" rel=\"nofollow noreferrer\"><em>Dice poker</em></a> assignment. I have managed to generate an array that holds the frequencies of values rolled, but I can't write a loop to determine what the value of the hand is. </p>\n\n<p>Hoping to get some advice on what combination of loops to use to determine what hand I'm holding. From there, I should be able to transpose this into a function, and write a function to compare this hand against others. </p>\n\n<pre><code>#define _CRT_SECURE_NO_WARNINGS\n#define handsz 5    //NO ACES IN THE POCKET WITH THIS GUY!\n#define diesz 6     //All dice played will have 6 sides\n#define ranks 7     //Seven ranks to hold\n\n#include &lt;stdio.h&gt;  \n#include &lt;stdlib.h&gt; \n#include &lt;time.h&gt;   \n\nint roll_die(void); \n\nint main() {\n    srand(time(NULL));\n\n    int i;\n    int player_hand[handsz] = { 0 };\n    int donkeyvalue = 0;    \n    int RandomNo;       \n\n    for (i = 0; i &lt; handsz; i++) {\n        RandomNo = roll_die(donkeyvalue);  \n        player_hand[i] = RandomNo;\n    }\n\n    int player_die_count[7] = { 0 }; \n    for (i = 0; i &lt; handsz; i++) {\n        player_die_count[player_hand[i]] = player_die_count[player_hand[i]] + 1;\n    }\n    return 0;\n}\n\nint roll_die(void) {\n    return (1 + rand() % 6);\n}\n</code></pre>\n"}, {"tags": ["c", "warnings", "built-in", "microchip", "mplab"], "comments": [{"owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "edited": false, "score": 0, "creation_date": 1557313517, "post_id": 56038359, "comment_id": 98720742, "body": "That compiler is really really bad. My suggestion: try another compiler if you can"}, {"owner": {"reputation": 454, "user_id": 5719079, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/g0gYz.jpg?s=128&g=1", "display_name": "Mercury", "link": "https://stackoverflow.com/users/5719079/mercury"}, "reply_to_user": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "edited": false, "score": 0, "creation_date": 1557314860, "post_id": 56038359, "comment_id": 98721477, "body": "Thanks, I\u2019ll try that, do you have any suggestions for which compiler might be good ?"}, {"owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "edited": false, "score": 0, "creation_date": 1557315157, "post_id": 56038359, "comment_id": 98721643, "body": "No idea on that, I wouldn&#39;t even use a PIC. STM32 or AVR are great. But you can Google that. Anything you find will be better than MPLAB/XC"}], "answers": [{"comments": [{"owner": {"reputation": 454, "user_id": 5719079, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/g0gYz.jpg?s=128&g=1", "display_name": "Mercury", "link": "https://stackoverflow.com/users/5719079/mercury"}, "edited": false, "score": 0, "creation_date": 1557315984, "post_id": 56039884, "comment_id": 98722082, "body": "Your code still gives me the exact same error: <code>Unable to resolve built-in identifier __builtin_dmaoffset</code>"}, {"owner": {"reputation": 80, "user_id": 3411690, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0e887c5af27d3153b0fe580c6b3c9d90?s=128&d=identicon&r=PG&f=1", "display_name": "Nitin Jadhav", "link": "https://stackoverflow.com/users/3411690/nitin-jadhav"}, "reply_to_user": {"reputation": 454, "user_id": 5719079, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/g0gYz.jpg?s=128&g=1", "display_name": "Mercury", "link": "https://stackoverflow.com/users/5719079/mercury"}, "edited": false, "score": 1, "creation_date": 1557317044, "post_id": 56039884, "comment_id": 98722660, "body": "Can you try modifying as <code>DMA1STA=__builtin_dmaoffset(&amp;ecan1MsgBuf);</code>"}, {"owner": {"reputation": 454, "user_id": 5719079, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/g0gYz.jpg?s=128&g=1", "display_name": "Mercury", "link": "https://stackoverflow.com/users/5719079/mercury"}, "edited": false, "score": 0, "creation_date": 1557317526, "post_id": 56039884, "comment_id": 98722930, "body": "Still nothing changing. But maybe this helps, when I try to compile which the error it tells me <code>Argument to __builtin_dmaoffset()  is not the address</code>"}, {"owner": {"reputation": 454, "user_id": 5719079, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/g0gYz.jpg?s=128&g=1", "display_name": "Mercury", "link": "https://stackoverflow.com/users/5719079/mercury"}, "edited": false, "score": 0, "creation_date": 1557318249, "post_id": 56039884, "comment_id": 98723337, "body": "Oh I just saw that before the error that we are discussing is thrown the compiler tells me <code>warning: ignoring space attribute applied to automatic ecan1MsgBuf</code>, and its showing this warning on this line of code <code>unsigned int ecan1MsgBuf[32][8] __attribute__((space(dma),aligned(MSG_BUF_LENGTH*16)));</code> maybe that is helpful"}], "tags": [], "owner": {"reputation": 80, "user_id": 3411690, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0e887c5af27d3153b0fe580c6b3c9d90?s=128&d=identicon&r=PG&f=1", "display_name": "Nitin Jadhav", "link": "https://stackoverflow.com/users/3411690/nitin-jadhav"}, "is_accepted": false, "score": 2, "last_activity_date": 1557315338, "creation_date": 1557315338, "answer_id": 56039884, "question_id": 56038359, "link": "https://stackoverflow.com/questions/56038359/mplabx-xc16-unable-to-resolve-built-in-identifier-builtin-dmaoffset/56039884#56039884", "title": "MPLABX XC16 unable to resolve built-in identifier __builtin_dmaoffset", "body": "<p>__builtin_dmaoffset() need to know the real address in order to calculate the DMA offset value.\nTry as follows-</p>\n\n<pre><code>#define MSG_BUF_LENGTH 32\n\nint main(void) {\n    ....\n\n    unsigned int ecan1MsgBuf[32][8] __attribute__((space(dma),aligned(MSG_BUF_LENGTH*16)));\n    DMA1STA=__builtin_dmaoffset(ecan1MsgBuf);\n\n    ....\n    }\n\n\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 657, "user_id": 3401601, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/NkaeT.jpg?s=128&g=1", "display_name": "EBlake", "link": "https://stackoverflow.com/users/3401601/eblake"}, "is_accepted": false, "score": 0, "last_activity_date": 1557360574, "creation_date": 1557360574, "answer_id": 56050519, "question_id": 56038359, "link": "https://stackoverflow.com/questions/56038359/mplabx-xc16-unable-to-resolve-built-in-identifier-builtin-dmaoffset/56050519#56050519", "title": "MPLABX XC16 unable to resolve built-in identifier __builtin_dmaoffset", "body": "<p>I think the problem might be that you are trying to pass a 2-array as the argument. Try creating a union that includes your array and sending this to the builtin. I believe that the builtin is implemented as a macro that extracts the address of the parameter and this could cause problems if it's not a simple scalar variable.</p>\n\n<p>I've also used the eds attribute with success on a dsPIC33E processor.</p>\n\n<pre><code>typedef union\n{\n   uint16_t   u16Dummy;\n   uint16_t   ecan1MsgBuf[32][8];\n} CAN_TYPE;\n\nCAN_TYPE   __attribute__((eds, space(dma), aligned(MSG_BUF_LENGTH*16))) Data;\n\nDMA1STA = __builtin_dmaoffset(Data.u16Dummy);\n</code></pre>\n"}], "owner": {"reputation": 454, "user_id": 5719079, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/g0gYz.jpg?s=128&g=1", "display_name": "Mercury", "link": "https://stackoverflow.com/users/5719079/mercury"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 450, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1557360574, "creation_date": 1557310489, "question_id": 56038359, "link": "https://stackoverflow.com/questions/56038359/mplabx-xc16-unable-to-resolve-built-in-identifier-builtin-dmaoffset", "title": "MPLABX XC16 unable to resolve built-in identifier __builtin_dmaoffset", "body": "<p>Im trying to do some basic ECAN sending using a dsPIC33FJ128GP802 and its built in DMA. The problem that im facing is that all the code examples in the documentation use the built in function <code>__builtin_dmaoffset()</code> to set the DMA onset buffer register <code>DMA1STA</code> but my compiler keeps telling me:</p>\n\n<pre><code>unable to resolve built-in identifier __builtin_dmaoffse\n</code></pre>\n\n<p>The code im using is:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;xc.h&gt;\n\n#include &lt;ADCConfig.h&gt;\n#include &lt;ECANConfig.h&gt;\n\nint main(void) {\n\n    oscConfig();\n\n    initADC1();\n    initDMA0();\n\n    initECAN1();\n    initDMA1();\n    initDMA2();\n\n    ... \n\n    unsigned int ecan1MsgBuf[32][8] __attribute__((space(dma)));\n    DMA1STA=__builtin_dmaoffset(ecan1MsgBuf);\n\n    ...\n}\n</code></pre>\n\n<p>How do I get the built in function to work?</p>\n"}, {"tags": ["c", "server", "client", "polling", "unix-socket"], "comments": [{"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1557316471, "post_id": 56038224, "comment_id": 98722347, "body": "Run your program through <code>strace</code>?"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1557345499, "post_id": 56038224, "comment_id": 98737879, "body": "Why are you using <code>goto</code> instead of a normal <code>do&#47;while</code> loop?"}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1557657815, "post_id": 56038224, "comment_id": 98831881, "body": "Please, read <a href=\"https://stackoverflow.com/help/mcve\">How to create a Minimal, Complete, and Verifiable example</a> as you post only a snippet of code and it is difficult to follow the sample code (no declaration of <code>sock</code> is given only a <code>while</code> loop without the exact test expression and no complete error checking is done for <code>poll</code> system call.)"}], "answers": [{"comments": [{"owner": {"reputation": 1400, "user_id": 7305745, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fep6r.jpg?s=128&g=1", "display_name": "Daniele Cappuccio", "link": "https://stackoverflow.com/users/7305745/daniele-cappuccio"}, "edited": false, "score": 0, "creation_date": 1557405789, "post_id": 56048171, "comment_id": 98759799, "body": "Thanks a lot, man! I was assuming that setting the <code>POLLIN</code> flag in <code>fds.events</code>, the return value of <code>recv</code> couldn&#39;t be 0 because there&#39;s always data to be read."}], "tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": true, "score": 2, "last_activity_date": 1557412138, "last_edit_date": 1557412138, "creation_date": 1557345450, "answer_id": 56048171, "question_id": 56038224, "link": "https://stackoverflow.com/questions/56038224/poll-waits-indefinitely-although-timeout-is-specified/56048171#56048171", "title": "poll() waits indefinitely although timeout is specified", "body": "<p>Your code is unconditionally calling <code>recv()</code> even when there is no data to read. In fact, you are completely ignoring the <code>fds.revents</code> field altogether if <code>poll()</code> does not return an error/timeout.</p>\n\n<p>Your loop should look more like this:</p>\n\n<pre><code>struct pollfd fds;\nfds.fd = sock;\nfds.events = POLLIN;\n\ndo {\n  r = poll(&amp;fds, 1, TIMEOUT*1000);\n  if (r == -1) {\n    if (errno == EINTR) continue;\n    perror(\"poll() failed\");\n    break;\n  }\n  else if (r == 0) {\n    printf(\"timeout expired\");\n    break;\n  }\n  else if (fds.revents &amp; POLLIN) {\n    r = recv(...);\n    if (r &lt; 0) {\n      perror(\"recv() failed\");\n      break;\n    }\n    else if (r == 0) {\n      printf(\"socket disconnected\\n\");\n      break;\n    }\n    else {\n      // process data as needed...\n    }\n  }\n  else if (fds.revents &amp; (POLLERR | POLLNVAL)) {\n    printf(\"socket error\\n\");\n    break;\n  }\n}\nwhile (1);\n\nclose(sock);\n</code></pre>\n"}], "owner": {"reputation": 1400, "user_id": 7305745, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fep6r.jpg?s=128&g=1", "display_name": "Daniele Cappuccio", "link": "https://stackoverflow.com/users/7305745/daniele-cappuccio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1681, "favorite_count": 0, "accepted_answer_id": 56048171, "answer_count": 1, "score": 1, "last_activity_date": 1557412138, "creation_date": 1557310047, "question_id": 56038224, "link": "https://stackoverflow.com/questions/56038224/poll-waits-indefinitely-although-timeout-is-specified", "title": "poll() waits indefinitely although timeout is specified", "body": "<p>I'm writing a C client-server program, in which the client has to receive a large amount of data from the server. Since I want my client not to wait indefinitely on a <code>recv()</code> if something goes wrong with the server (e.g., it's stopped when data is being sent), I opted to use the <code>poll()</code> function as specified in the <a href=\"http://man7.org/linux/man-pages/man2/poll.2.html\" rel=\"nofollow noreferrer\">linux man page</a>.</p>\n\n<p>My code is something like the following:</p>\n\n<pre><code>while (...)\n{\n  struct pollfd fds;\n  fds.fd = sock;\n  fds.events = POLLIN;\n\nretry:\n  r = poll(&amp;fds, 1, TIMEOUT*1000);\n  if (r == -1 &amp;&amp; errno == EINTR)\n    goto retry;\n  else if (r == -1)\n    err_sys(\"poll() failed\");\n  else if (r == 0)\n    err_sys(\"timeout expired\");\n\n  recv(...)\n}\n</code></pre>\n\n<p>where <code>sock</code> is the file descriptor associated with the socket, <code>TIMEOUT</code> is set to 5 seconds and I specify <code>POLLIN</code> as the event since I'm interested in reading data.</p>\n\n<p><strong>Problem</strong></p>\n\n<p>According to man:</p>\n\n<blockquote>\n  <p>The timeout argument specifies the number of milliseconds that poll()\n         should block waiting for a file descriptor to become ready.  The call\n         will block until either:</p>\n\n<pre><code>   (1)  a file descriptor becomes ready;\n\n   (2)  the call is interrupted by a signal handler; or\n\n   (3)  the timeout expires.\n</code></pre>\n</blockquote>\n\n<p>However, the program blocks indefinitely on the <code>poll()</code> function even though the timeout expires (I used valgrind) as soon as I stop the server. I also tried to set the events to <code>POLLIN | POLLPRI</code> (in order to catch some exceptional conditions) but it didn't work. I read the documentation multiple times and I couldn't figure out what's causing this problem.</p>\n\n<p><strong>Other info</strong></p>\n\n<p>I'm using Xubuntu 18.04, gcc version 7.4.0, target x86_64</p>\n"}, {"tags": ["c", "preprocessor"], "comments": [{"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 1, "creation_date": 1557309190, "post_id": 56037899, "comment_id": 98718209, "body": "The <code>do{}while()</code> trick is to force the use of a semicolon to complete the statement."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1557309219, "post_id": 56037899, "comment_id": 98718232, "body": "Also read this: <a href=\"https://stackoverflow.com/questions/1067226/c-multi-line-macro-do-while0-vs-scope-block\" title=\"c multi line macro do while0 vs scope block\">stackoverflow.com/questions/1067226/&hellip;</a>"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1557309494, "post_id": 56037899, "comment_id": 98718402, "body": "If you can guarantee that the format specifier provided by the caller is a string literal then you can use string literal concatenation within the macro to reduce the number of <code>fprintf</code> calls to 1."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1557310448, "post_id": 56037899, "comment_id": 98718926, "body": "The duplicate only answers the explicit part of the question about use of <code>do{}while()</code>, not the implicit part about reducing the <code>fprintf</code> call overhead."}], "owner": {"reputation": 11, "user_id": 9492316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ad649c6852647a97dde8c41df0317a7?s=128&d=identicon&r=PG&f=1", "display_name": "Matthias Waelti", "link": "https://stackoverflow.com/users/9492316/matthias-waelti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 20, "favorite_count": 0, "closed_date": 1557309257, "answer_count": 0, "score": 0, "last_activity_date": 1557309100, "creation_date": 1557309002, "last_edit_date": 1557309100, "question_id": 56037899, "link": "https://stackoverflow.com/questions/56037899/c-preprocessor-macros-with-variable-arguments-logger", "closed_reason": "Duplicate", "title": "C preprocessor macros with variable arguments, logger", "body": "<p>I would like to develop a simple set of logger macros for debugging and program flow control.\nThe first approach is working quiet well, but there are some small issues which bothers me.</p>\n\n<p><strong>logger.h</strong></p>\n\n<pre><code>#ifndef LOGGER_H\n#define LOGGER_H\n\n#include &lt;stdio.h&gt;\n#include &lt;stdint.h&gt;\n\n#ifdef DEBUG\n#define DEFAULT_STREAM (stdout)\n#define MESSAGE_IDENTIFIER_LENGTH ((uint8_t) 10)\n#define FUNCTION_NAME_LENGTH ((uint8_t) 20)\n#define FILE_PATH_LENGTH ((uint8_t) 40)\n\n#define LOG_MESSAGE(STREAM, MESSAGE_IDENTIFIER, ...) \\\n    do { \\\n    fprintf(STREAM,\"[ %*.*s ] [ %*.*s ] [ %*.*s:%04d ]: \", \\\n                    MESSAGE_IDENTIFIER_LENGTH, MESSAGE_IDENTIFIER_LENGTH, MESSAGE_IDENTIFIER, \\\n                    FUNCTION_NAME_LENGTH, FUNCTION_NAME_LENGTH, __FUNCTION__, \\\n                    FILE_PATH_LENGTH, FILE_PATH_LENGTH, __FILE__, __LINE__ \\\n                    ); \\\n    fprintf(STREAM, __VA_ARGS__ ); \\\n    fputs(\"\\n\", STREAM); \\\n    } while (0)\n\n#define LOG_INFO(ARGS...) LOG_MESSAGE(DEFAULT_STREAM, \"INFO\", ARGS)\n#define LOG_ERROR(ARGS...) LOG_MESSAGE(DEFAULT_STREAM, \"ERROR\", ARGS)\n#define LOG_WARNING(ARGS...) LOG_MESSAGE(DEFAULT_STREAM, \"WARNING\", ARGS)\n\n#else\n#define LOG_MESSAGE(STREAM, MESSAGE_IDENTIFIER, ...) ((void) 0)\n#define LOG_INFO(ARGS...) ((void) 0)\n#define LOG_ERROR(ARGS...) ((void) 0)\n#define LOG_WARNING(ARGS...) ((void) 0)\n\n#endif\n\n#endif // LOGGER_H\n</code></pre>\n\n<p>I'm using two times fprintf and one time fputs within the macro. But i would rather use fprintf just one time. Because i would expect an overhead if calling fprintf three times.</p>\n\n<p>I have seen that many developers wrap statements like printf within a do{}while() clause. Even if it's just one statement. Can someone tell me the reason for this.</p>\n\n<p>I am also happy about any other suggestions for improvement.</p>\n"}, {"tags": ["c", "network-programming", "coding-style"], "comments": [{"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1557308040, "post_id": 56037558, "comment_id": 98717606, "body": "you mean <i>A pointer to hostent is the <b>value</b> returned by gethostbyname<b>2</b></i> : <i>gethostbyname</i> does not return a pointer to an <i>hostent</i> and <i>gethostbyname2</i> does not return a struct but a pointer to"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1557308344, "post_id": 56037558, "comment_id": 98717772, "body": "I  suppose &quot;ent&quot; is shorthand for &quot;entry&quot;."}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1557308412, "post_id": 56037558, "comment_id": 98717813, "body": "@Jabberwocky or <i>entity</i> ? Out of that note <i>gethostbyname2</i> is obsolete"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 3, "creation_date": 1557308559, "post_id": 56037558, "comment_id": 98717890, "body": "<i>I get very forgetful when I try to memorize</i>  You don&#39;t memorize interfaces like this - because you will get them wrong.  You look them up when you need to - and that&#39;s why <code>man</code> pages exist.  When you need to use <code>gethostbyname()</code>, unless you&#39;ve used it so much recently that you think you know it exactly, you either look at another usage and copy that, or read the <code>man gethostbyname</code> entry.  Because even if you do think you know it completely, you will often get compiler warnings and errors when you compile - because you <b>will</b> get it wrong many times when you don&#39;t look it up."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1557309732, "post_id": 56037558, "comment_id": 98718563, "body": "It means something the developer thought about but forgot to document."}, {"owner": {"reputation": 59, "user_id": 5842056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2a83a94ea7081a015d5b48f38295571?s=128&d=identicon&r=PG&f=1", "display_name": "pitachips", "link": "https://stackoverflow.com/users/5842056/pitachips"}, "edited": false, "score": 0, "creation_date": 1557376343, "post_id": 56037558, "comment_id": 98745341, "body": "Entity seem very plausible to me. Thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1564677321, "post_id": 57313156, "comment_id": 101118964, "body": "Also relevant:  <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/basedefs/netdb.h.html#tag_13_31\" rel=\"nofollow noreferrer\">pubs.opengroup.org/onlinepubs/9699919799/basedefs/&hellip;</a>"}, {"owner": {"reputation": 1034907, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1564690964, "post_id": 57313156, "comment_id": 101124589, "body": "@AndrewHenle I agree. It is relevant. Also, it is the second link in my answer."}], "tags": [], "owner": {"reputation": 1034907, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 1, "last_activity_date": 1564676058, "creation_date": 1564676058, "answer_id": 57313156, "question_id": 56037558, "link": "https://stackoverflow.com/questions/56037558/what-does-struct-hostent-stands-for/57313156#57313156", "title": "What does struct hostent stands for?", "body": "<p>A quick <a href=\"https://github.com/search?q=%22hostent%2A%20gethostbyname%22&amp;type=Commits\" rel=\"nofollow noreferrer\">search on GitHub</a> points to <a href=\"https://pubs.opengroup.org/onlinepubs/009695399/basedefs/netdb.h.html\" rel=\"nofollow noreferrer\"><code>basedefs/netdb.h</code></a> (definitions for network database operations)</p>\n\n<blockquote>\n  <p>The <code>&lt;netdb.h&gt;</code> header shall define the <code>hostent</code> structure that includes at least the following members:</p>\n</blockquote>\n\n<pre><code>char   *h_name       Official name of the host. \nchar  **h_aliases    A pointer to an array of pointers to \n                     alternative host names, terminated by a \n                     null pointer. \nint     h_addrtype   Address type. \nint     h_length     The length, in bytes, of the address. \nchar  **h_addr_list  A pointer to an array of pointers to network \n                     addresses (in network byte order) for the host, \n                     terminated by a null pointer. \n</code></pre>\n\n<p>From there, the <a href=\"http://pubs.opengroup.org/onlinepubs/009695399/functions/gethostbyaddr.html\" rel=\"nofollow noreferrer\">official documentation for <code>gethostbyaddr()</code></a> includes:</p>\n\n<blockquote>\n  <p><strong>Entries</strong> shall be returned in hostent structures.</p>\n  \n  <p>The <code>gethostbyaddr()</code> function shall return an <strong>entry</strong> containing addresses of address family type for the host with address <code>addr</code>.<br>\n  The <code>len</code> argument contains the length of the address pointed to by <code>addr</code>.<br>\n  The <code>gethostbyaddr()</code> function need not be reentrant. A function that is not required to be reentrant is not required to be thread-safe.</p>\n  \n  <p>Entries shall be returned in hostent structures.</p>\n  \n  <p>Upon successful completion, these functions shall return a pointer to a <code>hostent</code> structure if the requested <strong>entry</strong> was found, and a null pointer if the end of the database was reached or the requested <strong>entry</strong> was not found.</p>\n</blockquote>\n\n<p>So there you have it: <strong><code>ent</code></strong> for <strong><code>entry</code></strong>. Not entity.</p>\n"}], "owner": {"reputation": 59, "user_id": 5842056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2a83a94ea7081a015d5b48f38295571?s=128&d=identicon&r=PG&f=1", "display_name": "pitachips", "link": "https://stackoverflow.com/users/5842056/pitachips"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1265, "favorite_count": 1, "accepted_answer_id": 57313156, "answer_count": 1, "score": 1, "last_activity_date": 1564676058, "creation_date": 1557307803, "last_edit_date": 1557308082, "question_id": 56037558, "link": "https://stackoverflow.com/questions/56037558/what-does-struct-hostent-stands-for", "title": "What does struct hostent stands for?", "body": "<p>A pointer to hostent is the struct returned by gethostbyname(). </p>\n\n<p>Exact function signature : <code>struct hostent* gethostbyname(const char*)</code></p>\n\n<p>And I have no idea what the 'ent' part means here at the end of hostent.</p>\n\n<p>I get very forgetful when I try to memorize that I don't understand, so please help me out.</p>\n"}, {"tags": ["c", "makefile"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1557306972, "post_id": 56037263, "comment_id": 98717004, "body": "3. Automatically generate dependency information from the compiler and include it in the Makefile."}, {"owner": {"reputation": 45838, "user_id": 1362568, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/EAFi0.jpg?s=128&g=1", "display_name": "Mike Kinghan", "link": "https://stackoverflow.com/users/1362568/mike-kinghan"}, "edited": false, "score": 0, "creation_date": 1557308069, "post_id": 56037263, "comment_id": 98717633, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/8025766/makefile-auto-dependency-generation\">Makefile (Auto-Dependency Generation)</a>"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1557308441, "post_id": 56037263, "comment_id": 98717828, "body": "(Or you could step into the 21th century and start using an IDE with automatic project management, then focus on programming instead...)"}, {"owner": {"reputation": 388, "user_id": 7327855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c86effa5599d1be976fbd2ce27a93945?s=128&d=identicon&r=PG", "display_name": "apadana", "link": "https://stackoverflow.com/users/7327855/apadana"}, "reply_to_user": {"reputation": 45838, "user_id": 1362568, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/EAFi0.jpg?s=128&g=1", "display_name": "Mike Kinghan", "link": "https://stackoverflow.com/users/1362568/mike-kinghan"}, "edited": false, "score": 0, "creation_date": 1557309122, "post_id": 56037263, "comment_id": 98718173, "body": "@MikeKinghan, that question is more about the abilities of GCC. I haven&#39;t mentioned any particular compiler."}, {"owner": {"reputation": 45838, "user_id": 1362568, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/EAFi0.jpg?s=128&g=1", "display_name": "Mike Kinghan", "link": "https://stackoverflow.com/users/1362568/mike-kinghan"}, "edited": false, "score": 1, "creation_date": 1557309527, "post_id": 56037263, "comment_id": 98718430, "body": "In that case you will need to specify your compiler as the only way in which Make can discover all the header dependencies of your source files unless you code them manually (which is impractical) is to exploit the auto-dependency generation capabiliity of the compiler."}, {"owner": {"reputation": 388, "user_id": 7327855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c86effa5599d1be976fbd2ce27a93945?s=128&d=identicon&r=PG", "display_name": "apadana", "link": "https://stackoverflow.com/users/7327855/apadana"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1557309659, "post_id": 56037263, "comment_id": 98718517, "body": "@Lundin, makefiles are still very common, although powered by tools like GNU Autotools."}], "answers": [{"comments": [{"owner": {"reputation": 388, "user_id": 7327855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c86effa5599d1be976fbd2ce27a93945?s=128&d=identicon&r=PG", "display_name": "apadana", "link": "https://stackoverflow.com/users/7327855/apadana"}, "edited": false, "score": 0, "creation_date": 1557309259, "post_id": 56037728, "comment_id": 98718258, "body": "Good. But what if I&#39;m not using GCC? My question is more about the makefile system&#39;s own capacities."}, {"owner": {"reputation": 45838, "user_id": 1362568, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/EAFi0.jpg?s=128&g=1", "display_name": "Mike Kinghan", "link": "https://stackoverflow.com/users/1362568/mike-kinghan"}, "reply_to_user": {"reputation": 388, "user_id": 7327855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c86effa5599d1be976fbd2ce27a93945?s=128&d=identicon&r=PG", "display_name": "apadana", "link": "https://stackoverflow.com/users/7327855/apadana"}, "edited": false, "score": 1, "creation_date": 1557310503, "post_id": 56037728, "comment_id": 98718957, "body": "@Arham Make is not a C language processor in any sense. It has no ability to parse C source files as the C preprocessor does, which it would have to do to discover the header file dependencies of a C source file."}, {"owner": {"reputation": 69991, "user_id": 939557, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/3VPea.png?s=128&g=1", "display_name": "MadScientist", "link": "https://stackoverflow.com/users/939557/madscientist"}, "edited": false, "score": 1, "creation_date": 1557349018, "post_id": 56037728, "comment_id": 98739338, "body": "Put another way, make is a tool that can take any kind of &quot;source&quot; file, check its timestamp against a &quot;target&quot; file, and run some command (the &quot;recipe&quot;) if they are out of date.  That&#39;s it, that&#39;s all it does.  It&#39;s completely generic and has no special capabilities to parse any type of source code."}], "tags": [], "owner": {"reputation": 1618, "user_id": 2131957, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Rh43j.png?s=128&g=1", "display_name": "Yuri Feldman", "link": "https://stackoverflow.com/users/2131957/yuri-feldman"}, "is_accepted": true, "score": 2, "last_activity_date": 1557308462, "creation_date": 1557308462, "answer_id": 56037728, "question_id": 56037263, "link": "https://stackoverflow.com/questions/56037263/makefile-for-a-project-that-has-nested-h-files/56037728#56037728", "title": "makefile for a project that has nested .h files", "body": "<p><code>gcc -MM *.c</code> would output the dependencies as required. </p>\n\n<pre><code>a1.o: a1.c a.h b.h\na2.o: a2.c a.h b.h\n</code></pre>\n\n<p>This in turn can be used as is, as built-in rules (specifying CC and CFLAGS macros). </p>\n\n<p>To avoid manually re-generating the makefile after each change, consider using CMake, and/or an IDE. </p>\n"}], "owner": {"reputation": 388, "user_id": 7327855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c86effa5599d1be976fbd2ce27a93945?s=128&d=identicon&r=PG", "display_name": "apadana", "link": "https://stackoverflow.com/users/7327855/apadana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 180, "favorite_count": 0, "accepted_answer_id": 56037728, "answer_count": 1, "score": 0, "last_activity_date": 1557308971, "creation_date": 1557306756, "last_edit_date": 1557308971, "question_id": 56037263, "link": "https://stackoverflow.com/questions/56037263/makefile-for-a-project-that-has-nested-h-files", "title": "makefile for a project that has nested .h files", "body": "<p>Assume that <code>a1.c</code> and <code>a2.c</code> include <code>a.h</code> which itself, in turn, includes <code>b.h</code>. So <code>a1.c</code> and <code>a2.c</code> are dependent on <code>b.h</code> indirectly.</p>\n\n<p>Now I'd like the makefile to compile both of the .c files if <code>b.h</code> gets modified. One way is adding <code>b.h</code> to the dependency list of each rule along with <code>a.h</code>. But I feel this may make things somewhat complicated when the project grows bigger and more complex. Another way may be adding a rule for <code>touch</code>ing <code>a.h</code> whenever <code>b.h</code> changes. (I haven't tried the latter)</p>\n\n<p>What is the best way to deal with nested dependencies in a makefile?</p>\n\n<p>What I mean by the \"best way\":</p>\n\n<ol>\n<li><p>the makefile is as compact and simple as possible</p></li>\n<li><p>each .c file gets compiled only when at least one of its related .h files change</p></li>\n<li><p>doesn't depend on the capabilities or tools of a specific compiler or OS</p></li>\n</ol>\n"}, {"tags": ["c", "symlink"], "comments": [{"owner": {"reputation": 9347, "user_id": 2214693, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/9O4uT.jpg?s=128&g=1", "display_name": "Claudio", "link": "https://stackoverflow.com/users/2214693/claudio"}, "edited": false, "score": 0, "creation_date": 1557306182, "post_id": 56037049, "comment_id": 98716562, "body": "Wouldn&#39;t be more efficient invoking a shell command through <code>system</code> or <code>execl</code> ?"}, {"owner": {"reputation": 856, "user_id": 1722492, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/66a1e7876d18c8b419246a9e12eb04f9?s=128&d=identicon&r=PG", "display_name": "Duxa", "link": "https://stackoverflow.com/users/1722492/duxa"}, "reply_to_user": {"reputation": 9347, "user_id": 2214693, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/9O4uT.jpg?s=128&g=1", "display_name": "Claudio", "link": "https://stackoverflow.com/users/2214693/claudio"}, "edited": false, "score": 0, "creation_date": 1557306219, "post_id": 56037049, "comment_id": 98716583, "body": "Yes, but the idea is to implement mv in C. So any kind of system()/exec call would be cheating :)"}, {"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 0, "creation_date": 1557306407, "post_id": 56037049, "comment_id": 98716683, "body": "Just a general hint, it&#39;d be good if you provided actual valid C code, a compilable program which you have tested to actually reproduce the problem, if at all possible. This is called MCVE, check it out."}], "answers": [{"comments": [{"owner": {"reputation": 856, "user_id": 1722492, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/66a1e7876d18c8b419246a9e12eb04f9?s=128&d=identicon&r=PG", "display_name": "Duxa", "link": "https://stackoverflow.com/users/1722492/duxa"}, "edited": false, "score": 0, "creation_date": 1557306394, "post_id": 56037124, "comment_id": 98716671, "body": "excellent. Ill give this a shot... I knew about lstat, but not about symlink(). Ill need to look into that to see how it works. Thanks! If this solves it Ill come back and mark this as accepted answer."}, {"owner": {"reputation": 856, "user_id": 1722492, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/66a1e7876d18c8b419246a9e12eb04f9?s=128&d=identicon&r=PG", "display_name": "Duxa", "link": "https://stackoverflow.com/users/1722492/duxa"}, "edited": false, "score": 1, "creation_date": 1557308200, "post_id": 56037124, "comment_id": 98717699, "body": "Beautiful! This made it easier than I thought it would be. Just needed to be pointed in the right direction. Thank you!"}], "tags": [], "owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "is_accepted": true, "score": 5, "last_activity_date": 1557306218, "creation_date": 1557306218, "answer_id": 56037124, "question_id": 56037049, "link": "https://stackoverflow.com/questions/56037049/how-to-programatically-move-a-linux-symlink-to-a-different-file-system-copy-in/56037124#56037124", "title": "How to programatically move a Linux symlink to a different file system (copy) in C?", "body": "<p>Once you have determined that you're dealing with a symlink (which can be done e.g. by using <a href=\"http://man7.org/linux/man-pages/man2/lstat.2.html\" rel=\"noreferrer\"><code>lstat()</code></a>), you can read its contents with <a href=\"http://man7.org/linux/man-pages/man2/readlink.2.html\" rel=\"noreferrer\"><code>readlink()</code></a> and recreate it at the target location by calling <a href=\"http://man7.org/linux/man-pages/man2/symlink.2.html\" rel=\"noreferrer\"><code>symlink()</code></a>.</p>\n\n<p>See also <a href=\"http://man7.org/linux/man-pages/man7/symlink.7.html\" rel=\"noreferrer\"><code>man 7 symlink</code></a>.</p>\n"}, {"tags": [], "owner": {"reputation": 149158, "user_id": 524368, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/oZ8Up.png?s=128&g=1", "display_name": "datenwolf", "link": "https://stackoverflow.com/users/524368/datenwolf"}, "is_accepted": false, "score": 0, "last_activity_date": 1557306437, "creation_date": 1557306437, "answer_id": 56037185, "question_id": 56037049, "link": "https://stackoverflow.com/questions/56037049/how-to-programatically-move-a-linux-symlink-to-a-different-file-system-copy-in/56037185#56037185", "title": "How to programatically move a Linux symlink to a different file system (copy) in C?", "body": "<p>When you <code>open</code> a symlink without the <code>O_NOFOLLOW</code> flag, it will dereference the symlink (or symlink chain, if it's a symlink to a symlink). If the destination does not exist, open will fail. The <code>O_NOFOLLOW</code> flag makes sure, that if you attempt to open a symlink you will realiably get an error.</p>\n\n<p>To \"copy\" a symlink, you'll have to read it with <code>readlink</code> and create a new symlink at the destination. However you may have to adjust the path it points to.</p>\n\n<p><em>However</em> if a program of yours has the need to copy directory trees on a *nix system, the correct way to implement this is not to reinvent the wheel, but to follow the Unix way and just execute the <code>cp</code> program with the right arguments.</p>\n"}], "owner": {"reputation": 856, "user_id": 1722492, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/66a1e7876d18c8b419246a9e12eb04f9?s=128&d=identicon&r=PG", "display_name": "Duxa", "link": "https://stackoverflow.com/users/1722492/duxa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 56037124, "answer_count": 2, "score": 0, "last_activity_date": 1557306437, "creation_date": 1557305919, "last_edit_date": 1557306281, "question_id": 56037049, "link": "https://stackoverflow.com/questions/56037049/how-to-programatically-move-a-linux-symlink-to-a-different-file-system-copy-in", "title": "How to programatically move a Linux symlink to a different file system (copy) in C?", "body": "<p>rename() C function does not work across file systems. So I can move files via a copy by opening them, reading them and writing them to a new copy and then unlinking. But I have a hard time getting this to work with symlinks. (The idea is to move a folder with a bunch of other files/folders/symlinks etc inside of it). Basically implementing a mv command in C.</p>\n\n<pre><code>open(file, O_RDONLY)\nwhile ((c = read(source_descriptor, buf, SIZE)) &gt; 0){\n        write(d, buf, c);\n}\nunlink file;\n</code></pre>\n\n<p>Works good for normal files (and I have another function handling directories without issues). But whenever it hits a symlink I get <strong>perror</strong> spitting out <em>No such file or directory</em>.</p>\n\n<p>I can detect if its a symlink via <strong>d_type</strong> but am not sure how to read/copy it once I have one since the normal file copy doesnt seem to work with symlinks because open() refuses to open them.</p>\n"}, {"tags": ["c", "gstreamer", "basic-authentication"], "comments": [{"owner": {"reputation": 4392, "user_id": 5215131, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-2C8rv6T-3m8/AAAAAAAAAAI/AAAAAAAAAP0/ALwPPtWwxac/photo.jpg?sz=128", "display_name": "Florian Zwoch", "link": "https://stackoverflow.com/users/5215131/florian-zwoch"}, "edited": false, "score": 0, "creation_date": 1557474027, "post_id": 56036937, "comment_id": 98784580, "body": "What exactly are you trying to accomplish? Can&#39;t you just set your auth in the uri in the form of <code>http:&#47;&#47;username:password@streamsoruce</code> and you are done?"}, {"owner": {"reputation": 7938, "user_id": 1511332, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/E2WEq.jpg?s=128&g=1", "display_name": "Pablo Jomer", "link": "https://stackoverflow.com/users/1511332/pablo-jomer"}, "reply_to_user": {"reputation": 4392, "user_id": 5215131, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-2C8rv6T-3m8/AAAAAAAAAAI/AAAAAAAAAP0/ALwPPtWwxac/photo.jpg?sz=128", "display_name": "Florian Zwoch", "link": "https://stackoverflow.com/users/5215131/florian-zwoch"}, "edited": false, "score": 0, "creation_date": 1557474402, "post_id": 56036937, "comment_id": 98784749, "body": "We actually managed to fix this. I will post an answer myself soon. Thank you."}], "owner": {"reputation": 7938, "user_id": 1511332, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/E2WEq.jpg?s=128&g=1", "display_name": "Pablo Jomer", "link": "https://stackoverflow.com/users/1511332/pablo-jomer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 291, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1557305903, "creation_date": 1557305541, "last_edit_date": 1557305903, "question_id": 56036937, "link": "https://stackoverflow.com/questions/56036937/using-basic-auth-with-gstreamer-souphttpsrc", "title": "Using basic auth with gstreamer souphttpsrc", "body": "<p>We are using the gstreamer souphttpsrc in a gstreamer pipeline to access and forward at http stream. To access the httpstream we have to use BasicAuth. We know how to format the basic auth header but we have trouble passing the header via the souphttpsrc extra-headers parameter as a GstStructure.</p>\n\n<p>Currently we are using the command below</p>\n\n<pre><code>gst-launch-1.0 spuphttsrc location=\"http://streamsource\" extra-headers=\"Authorization: Basic base64hash\" ! ...\n</code></pre>\n\n<p>The rest of the pipeline has been left out as it has been tested previously and is working. </p>\n\n<p>The error we receive: <code>canot set property extra-headers</code></p>\n\n<p>The source code for gstreamer can be found here: <a href=\"https://github.com/GStreamer/gst-plugins-good\" rel=\"nofollow noreferrer\">https://github.com/GStreamer/gst-plugins-good</a></p>\n\n<p>The GstStructure docs can be found here: <a href=\"http://web.mit.edu/ghudson/dev/nokrb/third/gstreamer/docs/gst/html/gstreamer-GstStructure.html\" rel=\"nofollow noreferrer\">http://web.mit.edu/ghudson/dev/nokrb/third/gstreamer/docs/gst/html/gstreamer-GstStructure.html</a></p>\n\n<p>Any help would be appreciated.</p>\n"}, {"tags": ["c", "assembly", "visual-c++", "calling-convention"], "comments": [{"owner": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 11, "creation_date": 1557302616, "post_id": 56036066, "comment_id": 98714747, "body": "It is a table of jmp thunks to support incremental linking (patching). <a href=\"https://docs.microsoft.com/en-us/cpp/build/reference/incremental-link-incrementally?view=vs-2019\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/cpp/build/reference/&hellip;</a>"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1557302619, "post_id": 56036066, "comment_id": 98714753, "body": "Is that debug-mode with incremental build or something?  Also, you should label your screenshots, e.g. that the first one is the call to <code>f1()</code> <i>from main</i>.  And more importantly, copy/paste text not pictures of text.  You&#39;re not including raw machine code so I had to work out from the address that it was a 5-byte <code>jmp</code> and thus a <code>jmp rel32</code> direct jump, rather than a memory-indirect <code>jmp [rel function_pointer]</code> or something as a DLL wrapper stub."}, {"owner": {"reputation": 52264, "user_id": 264052, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/8ccbe08a132ba61eae9ff8984ca44e81?s=128&d=identicon&r=PG", "display_name": "smwikipedia", "link": "https://stackoverflow.com/users/264052/smwikipedia"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1557304614, "post_id": 56036066, "comment_id": 98715655, "body": "@PeterCordes Thanks for the reminding. I post it in a haste and thought it is not very obscure. Updated now."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "reply_to_user": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 1, "creation_date": 1557304933, "post_id": 56036066, "comment_id": 98715824, "body": "@MichaelPetch, please turn your comment into a solution so it can better be searched for and archived."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1557305553, "post_id": 56036066, "comment_id": 98716203, "body": "@PaulOgilvie: Or you could have googled <code>jmp thunks to support incremental linking</code> and found one of the duplicates like I did, using Michael&#39;s phrasing for a google search :P"}, {"owner": {"reputation": 22874, "user_id": 3282056, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/IXonK.jpg?s=128&g=1", "display_name": "rcgldr", "link": "https://stackoverflow.com/users/3282056/rcgldr"}, "edited": false, "score": 1, "creation_date": 1557320407, "post_id": 56036066, "comment_id": 98724661, "body": "With VS 2005 through VS 2015, taking the defaults for a release build eliminates the jumps. I don&#39;t know about VS 2017 or VS 2019."}], "owner": {"reputation": 52264, "user_id": 264052, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/8ccbe08a132ba61eae9ff8984ca44e81?s=128&d=identicon&r=PG", "display_name": "smwikipedia", "link": "https://stackoverflow.com/users/264052/smwikipedia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 142, "favorite_count": 1, "closed_date": 1557305403, "answer_count": 0, "score": 6, "last_activity_date": 1557323907, "creation_date": 1557302327, "last_edit_date": 1557323907, "question_id": 56036066, "link": "https://stackoverflow.com/questions/56036066/why-is-an-extra-jmp-used-for-a-function-call", "closed_reason": "Duplicate", "title": "Why is an extra jmp used for a function call?", "body": "<p>I have the below program for an x64 build:</p>\n\n<pre><code>void f1()\n{\n    printf_s(\"in f1()\\n\");\n}\n\nvoid main(int argc, char** argv)\n{\n\n    f1();\n}\n</code></pre>\n\n<p>I run it in Visual Studio 2015 with F5 debug run. And check the disassembly code:</p>\n\n<p><a href=\"https://i.stack.imgur.com/906HX.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/906HX.png\" alt=\"extra jmp in red rectangle\"></a></p>\n\n<p>Why is there an unconditional <code>jmp</code> in the red rectangle?</p>\n\n<p>Is it possible to disable it?</p>\n"}, {"tags": ["c", "file"], "comments": [{"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 2, "creation_date": 1557300916, "post_id": 56035603, "comment_id": 98713922, "body": "<code>malloc</code> a buffer, then read one character at a time into the buffer. If you find a period or newline, the buffer contains a sentence. If the buffer fills up, use <code>realloc</code> to make it bigger, and then keep reading. The <code>fgets</code> solution won&#39;t work because of the <i>&quot;no assumed maximum lengths&quot;</i> constraint."}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 1, "creation_date": 1557300944, "post_id": 56035603, "comment_id": 98713942, "body": "I recommend you look at the string examination functions in <a href=\"https://en.cppreference.com/w/c/string/byte\" rel=\"nofollow noreferrer\">en.cppreference.com/w/c/string/byte</a>, <code>strrchr</code> in particular."}, {"owner": {"reputation": 2019, "user_id": 10035556, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86cea073655558939d961937095efc80?s=128&d=identicon&r=PG&f=1", "display_name": "Mayur", "link": "https://stackoverflow.com/users/10035556/mayur"}, "edited": false, "score": 0, "creation_date": 1557301576, "post_id": 56035603, "comment_id": 98714246, "body": "How about traversing <code>charLine</code> and replacing <code>.</code> with <code>NULL</code> then you can get separate string by remembering position next to <code>NULL</code>"}, {"owner": {"reputation": 33, "user_id": 11453961, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-BwsmFymXVS8/AAAAAAAAAAI/AAAAAAAAANY/cw2vL3247SA/photo.jpg?sz=128", "display_name": "Aevitas", "link": "https://stackoverflow.com/users/11453961/aevitas"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1557301932, "post_id": 56035603, "comment_id": 98714422, "body": "@user3386109 So use <code>fgetc</code> instead of <code>fgets</code>? The maximum length constraint isn&#39;t  a problem with <code>fgets</code> because I&#39;ve already done as you suggested with a buffer; <code>realloc</code> when it fills."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1557302187, "post_id": 56035603, "comment_id": 98714538, "body": "Ok, then you can use <code>strtok</code> with <code>&quot;.\\n&quot;</code> as the delimiter to break the line into sentences."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1557303489, "post_id": 56035603, "comment_id": 98715131, "body": "Do you need to store all sentences in memory for later use, or do you simply want to read the raw text file and write the sentences out one-by-one? To write the sentences out, you need nothing more than <code>fgetc()</code> and a couple of <code>if</code> statements. To store everything without limit, you will need to allocate and reallocate a pointer for each sentence, and then storage for each sentence."}, {"owner": {"reputation": 33, "user_id": 11453961, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-BwsmFymXVS8/AAAAAAAAAAI/AAAAAAAAANY/cw2vL3247SA/photo.jpg?sz=128", "display_name": "Aevitas", "link": "https://stackoverflow.com/users/11453961/aevitas"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1557305285, "post_id": 56035603, "comment_id": 98716048, "body": "@DavidC.Rankin I&#39;m using it to construct a correlation matrix. which takes the words that start with capital letters and counts how many times that words occurs in the same sentence with another. So, I shouldn&#39;t need the sentences again."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1557307368, "post_id": 56035603, "comment_id": 98717229, "body": "Then you don&#39;t need to dynamically allocate anything. The longest word in the unabridged non-medical dictionary is 29-chars. Just use a fixed buffer for 128-char to store each word (don&#39;t skimp on buffer size), and test and add to your correlation matrix as you read each sentence. You need 2-flags. (1) an <code>insent</code> to indicate in-a-sentence, and (2) <code>inword</code>. Just set to 1 if in either, or 0 otherwise. This allows you to skip whitespace between sentences and words. Then it&#39;s just a matter of reading each char until <code>EOF</code> and 4-5 tests for sentence/word start end (<i>nul-terminate</i> each word)"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1557341478, "post_id": 56035603, "comment_id": 98736178, "body": "Regarding: <code>&quot;%[^.]s&quot;</code>  This is NOT a valid format string.  Because it is VERY UNLIKELY that a sentence ending with a &#39;.&#39; will have the very next character be a &#39;s&#39;.  Suggest using: <code>&quot;%[^.\\n]&quot;</code> so it will catch either a period or a newline"}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 11453961, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-BwsmFymXVS8/AAAAAAAAAAI/AAAAAAAAANY/cw2vL3247SA/photo.jpg?sz=128", "display_name": "Aevitas", "link": "https://stackoverflow.com/users/11453961/aevitas"}, "edited": false, "score": 0, "creation_date": 1557307836, "post_id": 56036362, "comment_id": 98717492, "body": "Would this go through the entire file? For example if I had  en.wikipedia.org would it assign <code>dest</code> as en, then wikipedia, then org?"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1557308811, "post_id": 56036362, "comment_id": 98718002, "body": "A &quot;sentence&quot; and splitting a host.domain.tld are two separate things. If you had a sentence like <code>&quot;Sites like en.wikipedia.org are references.&quot;</code>, you would get <code>&quot;Sites like en&quot;</code> then <code>&quot;wikipedia&quot;</code> finally <code>&quot;org are references&quot;</code> -- Is that what you want?"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1557308900, "post_id": 56036362, "comment_id": 98718046, "body": "@DavidC.Rankin: interesting point. I guess the function would check if <code>.</code> is followed by some white space."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1557309044, "post_id": 56036362, "comment_id": 98718125, "body": "I&#39;m just really confused as to exactly what is being asked. It seems to cover everything from read any length of sentence without limitation, to parsing the host and domain components of a site to running correlations on the number of times the same word appears capitalized in each sentence -- so he may be asking for 3-4 different things as one."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1557309476, "post_id": 56036362, "comment_id": 98718395, "body": "@DavidC.Rankin: The OP&#39;s sentence <i>The problem with this, is that if there is more than one period (.) it will stop at the first and not start again at that period (.) to collect the others.</i> refers to <code>fgets()</code>: extracting a sentence from the line read by <code>fgets()</code> is not enough, the remainder of the line being ignored in his attempts."}, {"owner": {"reputation": 33, "user_id": 11453961, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-BwsmFymXVS8/AAAAAAAAAAI/AAAAAAAAANY/cw2vL3247SA/photo.jpg?sz=128", "display_name": "Aevitas", "link": "https://stackoverflow.com/users/11453961/aevitas"}, "edited": false, "score": 0, "creation_date": 1557309922, "post_id": 56036362, "comment_id": 98718667, "body": "My question was simply how it deals with characters that follow a <code>.</code> without white space. I&#39;m getting confused because I&#39;m using an unformatted txt file as a reference that doesn&#39;t show formatting, making it seem as if AustraliaA is one word not separated when it&#39;s actually 2 words seperated by a newline."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 33, "user_id": 11453961, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-BwsmFymXVS8/AAAAAAAAAAI/AAAAAAAAANY/cw2vL3247SA/photo.jpg?sz=128", "display_name": "Aevitas", "link": "https://stackoverflow.com/users/11453961/aevitas"}, "edited": false, "score": 0, "creation_date": 1557310109, "post_id": 56036362, "comment_id": 98718752, "body": "@Aevitas: if you remove the newline from the input, and not separate different input lines in your output, you will effectively glue the last word of a line with the first word of the next line. Replace the newline with a space instead of removing it."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1557310217, "post_id": 56036362, "comment_id": 98718806, "body": "If you want to read an entire wikipedia article this way, you would need to parse the html format to handle the tags specifically and you probably want a lage array or a reallocation method."}, {"owner": {"reputation": 33, "user_id": 11453961, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-BwsmFymXVS8/AAAAAAAAAAI/AAAAAAAAANY/cw2vL3247SA/photo.jpg?sz=128", "display_name": "Aevitas", "link": "https://stackoverflow.com/users/11453961/aevitas"}, "edited": false, "score": 0, "creation_date": 1557320598, "post_id": 56036362, "comment_id": 98724799, "body": "@chqrlie How exactly would I realloc this?"}], "tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": true, "score": 3, "last_activity_date": 1557309672, "last_edit_date": 1557309672, "creation_date": 1557303486, "answer_id": 56036362, "question_id": 56035603, "link": "https://stackoverflow.com/questions/56035603/is-there-a-way-to-read-a-filestream-until-a-period-is-found-then-repeat/56036362#56036362", "title": "Is there a way to read a filestream until a period (.) is found. Then repeat?", "body": "<p>You can write a function that reads the stream until a <code>.</code> or a newline is found. David C.Rankin suggested that just scanning for a <code>.</code> might be too restrictive, causing embedded periods in www.google.com to act as sentence break. One can stop on <code>.</code> if followed by white space:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;ctype.h&gt;\n#include &lt;stdio.h&gt;\n\n/* alternative to fgets to stop at `.` and newline */\nchar *fgetsentence(char *dest, size_t size, FILE *fp) {\n    size_t i = 0;\n    while (i + 2 &lt; size) {\n        int c = getc(fp);\n        if (c == EOF)\n            break;\n        dest[i++] = (char)c;\n        if (c == '\\n')\n            break;\n        if (c == '.') {\n            int d = getc(fp);\n            if (d == EOF)\n                break;\n            if (isspace(d)) {\n                dest[i++] = (char)d;\n                break;\n            }\n            ungetc(d, fp);\n        }\n    }\n    if (i == 0)\n        return NULL;\n    dest[i] = '\\0';\n    return dest;\n}\n</code></pre>\n\n<p>If you want to handle arbitrary long sentences, you would take pointers to <code>dest</code> and <code>size</code> and reallocate the array if required.</p>\n\n<p>Note that it would be very impractical to use <code>fscanf(fp, \"%[^.\\n]\", dest)</code> because it is not possible to pass the maximum number of bytes to store into <code>dest</code> as an evaluated argument and one would need to special case empty lines and sentences.</p>\n\n<p>Note too that stopping on <code>.</code>, even with the above restriction that it must be followed by white space still causes false positives: sentences can contain embedded periods followed by white space that are not the end of the sentence. Example: <em>Thanks to David C. Rankin for his comments on my answer.</em></p>\n"}], "owner": {"reputation": 33, "user_id": 11453961, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-BwsmFymXVS8/AAAAAAAAAAI/AAAAAAAAANY/cw2vL3247SA/photo.jpg?sz=128", "display_name": "Aevitas", "link": "https://stackoverflow.com/users/11453961/aevitas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 56036362, "answer_count": 1, "score": 1, "last_activity_date": 1557309672, "creation_date": 1557300439, "question_id": 56035603, "link": "https://stackoverflow.com/questions/56035603/is-there-a-way-to-read-a-filestream-until-a-period-is-found-then-repeat", "title": "Is there a way to read a filestream until a period (.) is found. Then repeat?", "body": "<p>I'm fairly new to C and not sure how I would do this. I've found similar questions, but nothing exactly like I want. </p>\n\n<p>What I want to do is read a raw txt file \"sentence by sentence\" with the end of a sentence being considered a period (.) or a newline (\\n). With no assumed maximum lengths for any data structures.</p>\n\n<p>My first thought was <code>getline()</code>, but the version of C I'm required to use does not seem to have such a function. So I've tried to use <code>fgets()</code> and then parse the data onto a <code>sscanf()</code> with a scanset. <code>sscanf(charLine, \"%[^.]s\", sentence);</code></p>\n\n<p>The problem with this, is that if there is more than one period (.) it will stop at the first and not start again at that period (.) to collect the others.</p>\n\n<p>I feel like I'm on the right track but just don't how to expand on this.   </p>\n\n<pre><code>    while(fgets (charLine, size, readFile) == NULL)\n    {\n         sscanf(charLine, \"%[^.]s\", sentence);\n         // something here...\n    }\n</code></pre>\n"}, {"tags": ["c", "gcc", "binary", "linker", "elf"], "comments": [{"owner": {"reputation": 1872, "user_id": 2104472, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/18805ffb0c3acfbd23cd6c84951afafc?s=128&d=identicon&r=PG&f=1", "display_name": "Vladislav Ivanishin", "link": "https://stackoverflow.com/users/2104472/vladislav-ivanishin"}, "edited": false, "score": 0, "creation_date": 1557321430, "post_id": 56035556, "comment_id": 98725329, "body": "<code>&#47;a.out 0x556e06629eef</code> -- good observation. I am also curious; looking into it now I&#39;ve found out 2 things so far. 1) the different results you get are the result of ASLR done by the kernel. 2) If you link the program statically (<code>gcc -static ...</code>), you&#39;ll see <code>0xbeef</code> unmodified in the output. So ISTM the dynamic loader still shifts everything by a base address, including absolute symbols..."}], "answers": [{"comments": [{"owner": {"reputation": 107, "user_id": 6716847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27425a74961d438ff9d5a147695f0184?s=128&d=identicon&r=PG&f=1", "display_name": "whuala", "link": "https://stackoverflow.com/users/6716847/whuala"}, "edited": false, "score": 0, "creation_date": 1557318592, "post_id": 56039479, "comment_id": 98723530, "body": "Thanks! But I&#39;m still confused about the addresses of absolute symbols. Since it&#39;s hard to fit into comments I edited the question."}], "tags": [], "owner": {"reputation": 1872, "user_id": 2104472, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/18805ffb0c3acfbd23cd6c84951afafc?s=128&d=identicon&r=PG&f=1", "display_name": "Vladislav Ivanishin", "link": "https://stackoverflow.com/users/2104472/vladislav-ivanishin"}, "is_accepted": true, "score": 2, "last_activity_date": 1557351852, "last_edit_date": 1557351852, "creation_date": 1557314107, "answer_id": 56039479, "question_id": 56035556, "link": "https://stackoverflow.com/questions/56035556/what-is-abs-section-and-when-to-use/56039479#56039479", "title": "What is *ABS* section and when to use?", "body": "<p>If you look at other symbols you might find an index (or section name if the reader does the mapping for you) in place of <code>*ABS*</code>.  This is a section index in the section headers table.  It points to the section header of a section the symbol is defined in (or <code>SHN_UNDEF</code> (zero) if it is undefined in the object you are looking at). So the value (virtual address) of a symbol will be adjusted by the same value its containing section is adjusted during loading. (This process is called <em>relocation</em>.) Not so for absolute symbols (having special value <code>SHN_ABS</code> as their <code>st_shndx</code>). Absolute symbols don't get relocated, their virtual addresses (<code>0000000000000000</code> in the example you gave) are fixed.</p>\n\n<p>Such absolute symbols are sometimes used to store some meta information. In particular, the compiler can create symbols with symbol names equivalent to the names of translation units it compiles. Such symbols aren't needed for linking or running the program, they are just for humans and binary processing tools.</p>\n\n<p>As for your question w.r.t the reason this isn't stored in <code>.debug_info</code> section (and why this info is emitted even though no debug switches were specified), the answer is that it is a separate thing; it is just the symbol table (<code>.symtab</code>). It is also needed for debugging, sure, but it's primary purpose is linking of object (<code>.o</code>) files. By default it is preserved in linked executables/libraries. You can get rid of it with <code>strip</code>.</p>\n\n<p>Much of what I wrote here is in <code>man 5 elf</code>.</p>\n\n<hr>\n\n<p>I don't think doing what you are doing (with <code>--defsym</code>) is supported/supposed to work with dynamic linking. Looking at the compiler output (<code>gcc -S -masm=intel</code>), I see this</p>\n\n<pre><code>lea     rsi, foo[rip]\n</code></pre>\n\n<p>Or, if we look at <code>objdump -M  intel -rD a.out</code> (linking with <code>-q</code> to preserve relocations), we see the same thing: <code>rip</code>-relative addressing is used to get the address of <code>foo</code>.</p>\n\n<pre><code>113d:       48 8d 35 ab ad 00 00    lea    rsi,[rip+0xadab]        # beef &lt;foo&gt;\n                    1140: R_X86_64_PC32     foo-0x4\n</code></pre>\n\n<p>The compiler doesn't know that it's going to be an absolute symbol, so it produces the code it does (as for a normal symbol). <code>rip</code> is the instruction pointer, so it depends on the base address of the segment containing <code>.text</code> after the program is mapped into memory by <code>ld.so</code>.</p>\n\n<p>I found this <a href=\"https://stackoverflow.com/a/33324663/2104472\">answer</a> shedding light on the proper use-case for absolute symbols.</p>\n"}], "owner": {"reputation": 107, "user_id": 6716847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27425a74961d438ff9d5a147695f0184?s=128&d=identicon&r=PG&f=1", "display_name": "whuala", "link": "https://stackoverflow.com/users/6716847/whuala"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1161, "favorite_count": 0, "accepted_answer_id": 56039479, "answer_count": 1, "score": 5, "last_activity_date": 1557351852, "creation_date": 1557300209, "last_edit_date": 1557318505, "question_id": 56035556, "link": "https://stackoverflow.com/questions/56035556/what-is-abs-section-and-when-to-use", "title": "What is *ABS* section and when to use?", "body": "<pre class=\"lang-c prettyprint-override\"><code>// foo.c\nint main() { return 0; }\n</code></pre>\n\n<p>When I compiled the code above I noticed some symbols located in <code>*ABS*</code>:</p>\n\n<pre><code>$ gcc foo.c\n$ objdump -t a.out | grep ABS\n0000000000000000 l    df *ABS*  0000000000000000              crtstuff.c\n0000000000000000 l    df *ABS*  0000000000000000              foo.c\n0000000000000000 l    df *ABS*  0000000000000000              crtstuff.c\n0000000000000000 l    df *ABS*  0000000000000000              \n</code></pre>\n\n<p>Looks like they're some debug symbols but isn't debug info are stored in somewhere like <code>.debug_info</code> section? </p>\n\n<p>According to <code>man objdump</code>:</p>\n\n<blockquote>\n  <p>*ABS* if the section is absolute (ie not connected with any section)</p>\n</blockquote>\n\n<p>I don't understand it since no example is given here.</p>\n\n<p>Question <a href=\"https://stackoverflow.com/questions/53270723/how-does-the-defsym-linker-flag-work-to-pass-values-to-source-code\">here</a> shows an interesting way to pass some extra symbols in <code>*ABS*</code> by <code>--defsym</code>. But I think it could be easier by passing macros.</p>\n\n<p>So what is this <code>*ABS*</code> section and when would someone use it?</p>\n\n<p><em>EDIT</em>:</p>\n\n<blockquote>\n  <p>Absolute symbols don't get relocated, their virtual addresses (0000000000000000 in the example you gave) are fixed.</p>\n</blockquote>\n\n<p>I wrote a demo but it seems that the addresses of absolute symbols can be modified.</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>// foo.c\n\n#include &lt;stdio.h&gt;\n\nextern char foo;\n\nint main()\n{\n  printf(\"%p\\n\", &amp;foo);\n  return 0;\n}\n</code></pre>\n\n<pre class=\"lang-sh prettyprint-override\"><code>$ gcc foo.c -Wl,--defsym,foo=0xbeef -g\n\n$ objdump -t a.out | grep ABS\n0000000000000000 l    df *ABS*  0000000000000000              crtstuff.c\n0000000000000000 l    df *ABS*  0000000000000000              foo.c\n0000000000000000 l    df *ABS*  0000000000000000              crtstuff.c\n0000000000000000 l    df *ABS*  0000000000000000\n000000000000beef g       *ABS*  0000000000000000              foo\n\n# the addresses are not fixed\n$ ./a.out\n0x556e06629eef\n$ ./a.out\n0x564f0d7aeeef\n$ ./a.out\n0x55c2608dceef\n\n# gdb shows that before entering main(), &amp;foo == 0xbeef\n$ gdb a.out\n(gdb) p &amp;foo\n$1 = 0xbeef &lt;error: Cannot access memory at address 0xbeef&gt;\n(gdb) br main\nBreakpoint 1 at 0x6b4: file foo.c, line 7.\n(gdb) r\nStarting program: /home/user/a.out\n\nBreakpoint 1, main () at foo.c:7\n7         printf(\"%p\", &amp;foo);\n(gdb) p &amp;foo\n$2 = 0x55555555feef &lt;error: Cannot access memory at address 0x55555555feef&gt;\n</code></pre>\n"}, {"tags": ["c", "arm", "microcontroller"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1557300528, "post_id": 56035318, "comment_id": 98713732, "body": "What reads what from where? The ISR reads a variable shared with background program, or...? I don&#39;t understand the question, please make a simple pseudo code example to illustrate."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 3, "creation_date": 1557300713, "post_id": 56035318, "comment_id": 98713819, "body": "Here&#39;s some info regarding use of volatile with ISRs, also addressing the separate problem of race conditions: <a href=\"https://electronics.stackexchange.com/a/409570/6102\">electronics.stackexchange.com/a/409570/6102</a>"}, {"owner": {"reputation": 18888, "user_id": 1880339, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/0PkGx.png?s=128&g=1", "display_name": "artless noise", "link": "https://stackoverflow.com/users/1880339/artless-noise"}, "edited": false, "score": 0, "creation_date": 1557319271, "post_id": 56035318, "comment_id": 98723951, "body": "There are specific arm documents on this.  For instance an aligned 32 bit is always ok.  However, 64 bits could take several bus cycles and be interrupted mid-cycle as a hypothetical;  consult your arm arm for real details."}, {"owner": {"reputation": 18888, "user_id": 1880339, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/0PkGx.png?s=128&g=1", "display_name": "artless noise", "link": "https://stackoverflow.com/users/1880339/artless-noise"}, "edited": false, "score": 0, "creation_date": 1557321375, "post_id": 56035318, "comment_id": 98725295, "body": "A similar question and answers on <a href=\"https://stackoverflow.com/questions/18088873/how-to-protect-a-global-variable-shared-by-isr-and-regular-function\">how to protect a global variable shared by isr and regular function</a>.   <a href=\"https://stackoverflow.com/questions/24931456/how-does-sig-atomic-t-actually-work\">sig_atomic_t</a> is some what related."}], "answers": [{"tags": [], "owner": {"reputation": 174, "user_id": 5793303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca3f5c1b60217f34afd5233750e4cff6?s=128&d=identicon&r=PG&f=1", "display_name": "Babajan", "link": "https://stackoverflow.com/users/5793303/babajan"}, "is_accepted": false, "score": 0, "last_activity_date": 1558355477, "creation_date": 1558355477, "answer_id": 56221095, "question_id": 56035318, "link": "https://stackoverflow.com/questions/56035318/reading-a-value-via-an-interrupt-protection/56221095#56221095", "title": "Reading a value via an interrupt protection", "body": "<p>Here is my approach:</p>\n\n<pre><code>do\n{\n   Read_Flag = 0;\n   //Read operation\n} while (Read_Flag);\n</code></pre>\n\n<p>Read_Flag  to be set at ISR where value of a variable being read is modified.</p>\n"}], "owner": {"reputation": 563, "user_id": 7864336, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/8a2d64bf3ba8d5d7bc5d961075241343?s=128&d=identicon&r=PG&f=1", "display_name": "schanti schul", "link": "https://stackoverflow.com/users/7864336/schanti-schul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 70, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1558355477, "creation_date": 1557299372, "question_id": 56035318, "link": "https://stackoverflow.com/questions/56035318/reading-a-value-via-an-interrupt-protection", "title": "Reading a value via an interrupt protection", "body": "<p>I am familiar with the race condition and the famous counter++ example.\nMy question is not about read-write protection, but only about read protection.\nIs it possible I read a corrupt value via an interrupt? incase another interrupt/main code was just in the process of changing its value?\nDo I need to protect my reads of let's say volatile components?\nI am using C and an ARM microcontroller.</p>\n\n<p>Furthermore, if only one task is doing read-write manipulation on some variable, and all other tasks are only reading it, do I need to protect it?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 8251, "user_id": 2912665, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/XrRhd.jpg?s=128&g=1", "display_name": "CinCout", "link": "https://stackoverflow.com/users/2912665/cincout"}, "edited": false, "score": 0, "creation_date": 1557299339, "post_id": 56035207, "comment_id": 98713155, "body": "not reproducible: <a href=\"https://ideone.com/UzHvTo\" rel=\"nofollow noreferrer\">ideone.com/UzHvTo</a>"}, {"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 2, "creation_date": 1557299416, "post_id": 56035207, "comment_id": 98713204, "body": "You probably typed A and then RETURN, so you get 1 then A then 1 then \\n."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1557300362, "post_id": 56035207, "comment_id": 98713654, "body": "Instead of writing weird code that makes it hard to understand what&#39;s going on, write code that makes it easy. Namely <code>printf(&quot;%d\\n&quot;, c)</code>. After which you&#39;ll see something like 65 13 and then you can probably answer the question yourself."}], "answers": [{"comments": [{"owner": {"reputation": 13191, "user_id": 4990642, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/xY0PD.jpg?s=128&g=1", "display_name": "snr", "link": "https://stackoverflow.com/users/4990642/snr"}, "edited": false, "score": 1, "creation_date": 1557299572, "post_id": 56035353, "comment_id": 98713284, "body": "my wrong, thanks +1"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1557308151, "post_id": 56035353, "comment_id": 98717673, "body": "On a Unix TTY in canonical input mode, Ctrl+D (<code>VEOF</code>) only causes EOF when the line buffer is empty. So you&#39;d need to type it twice: <code>1</code> <code>Ctrl+D</code> <code>Ctrl+D</code> for the desired effect. The first Ctrl+D makes the incomplete line available to the waiting program. The second Ctrl+D makes a subsequent read on the now empty buffer return 0, which is seen as EOF."}], "tags": [], "owner": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "is_accepted": false, "score": 9, "last_activity_date": 1557299614, "last_edit_date": 1557299614, "creation_date": 1557299472, "answer_id": 56035353, "question_id": 56035207, "link": "https://stackoverflow.com/questions/56035207/output-for-the-following-c-code-is-confusing-me/56035353#56035353", "title": "Output for the following C code is confusing me", "body": "<p>It is because you entered <code>A</code> and <code>&lt;enter&gt;</code>. The <code>&lt;enter&gt;</code> produces the second <code>1</code>.</p>\n\n<p>You can press <code>CTRL</code> + <code>D</code> on unix or <code>CTRL</code> + <code>Z</code> on Windows to close the stdin of the program instead of pressing <code>&lt;enter&gt;</code>. This will give you the expected output.</p>\n\n<p>With the <code>&lt;enter&gt;</code>: <a href=\"https://ideone.com/lWJ3Xz\" rel=\"noreferrer\">https://ideone.com/lWJ3Xz</a></p>\n\n<p>and without: <a href=\"https://ideone.com/QsXiYz\" rel=\"noreferrer\">https://ideone.com/QsXiYz</a></p>\n"}, {"tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": 3, "last_activity_date": 1557299950, "creation_date": 1557299950, "answer_id": 56035494, "question_id": 56035207, "link": "https://stackoverflow.com/questions/56035207/output-for-the-following-c-code-is-confusing-me/56035494#56035494", "title": "Output for the following C code is confusing me", "body": "<p>a minimum debug effort and you will know yourself. </p>\n\n<p><code>printf(\"FEOF=%d, C=0x%x\\n\",x,c);</code></p>\n"}], "owner": {"reputation": 51, "user_id": 11468470, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-3uoinkECqOw/AAAAAAAAAAI/AAAAAAAAEz0/L3Jr3rZ5MwE/photo.jpg?sz=128", "display_name": "Ritvik Sinha", "link": "https://stackoverflow.com/users/11468470/ritvik-sinha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 138, "favorite_count": 0, "closed_date": 1557306178, "answer_count": 2, "score": 4, "last_activity_date": 1557305574, "creation_date": 1557298968, "last_edit_date": 1557299212, "question_id": 56035207, "link": "https://stackoverflow.com/questions/56035207/output-for-the-following-c-code-is-confusing-me", "closed_reason": "Not suitable for this site", "title": "Output for the following C code is confusing me", "body": "<p>This is my code</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nmain()\n{\n    int c;\n    c=getchar();\n    while(c!=EOF)\n    {\n        int x;\n        x=(c!=EOF);\n        printf(\"%d\",x);\n        putchar(c);\n        c=getchar();\n    }\n}\n</code></pre>\n\n<p>Output (When I enter <code>A</code>):</p>\n\n<pre><code>A\n1A1\n</code></pre>\n\n<p>Why is it not <code>1A</code> only. Why is it repeating <code>1</code>.Like first the program will take the value of c from getchar. Then it will go inside the loop. When condition will be true it will print the value of x and then value of c. Then again it should ask me for an input. Instead it is displaying another 1 then asking for the input. Kindly help.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 134, "user_id": 11131523, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-3O9ngZPKFGo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdeFi7656jSqPOfPxvSdL-OboBLdg/mo/photo.jpg?sz=128", "display_name": "Igor Galczak", "link": "https://stackoverflow.com/users/11131523/igor-galczak"}, "edited": false, "score": 1, "creation_date": 1557298700, "post_id": 56034969, "comment_id": 98712824, "body": "<code>queue != NULL</code> instead of <code>queue != 0</code> and check <code>queue-&gt;tail != NULL</code>"}, {"owner": {"reputation": 4593, "user_id": 105104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02b23920ac852e946b333d3f9d0d95c1?s=128&d=identicon&r=PG", "display_name": "dvhh", "link": "https://stackoverflow.com/users/105104/dvhh"}, "edited": false, "score": 0, "creation_date": 1557299248, "post_id": 56034969, "comment_id": 98713111, "body": "please note that <code>assert</code> in most case only work if your code has been compile with the debug flag, without it <code>assert</code> generate no code ( see <a href=\"http://man7.org/linux/man-pages/man3/assert.3.html\" rel=\"nofollow noreferrer\">man7.org/linux/man-pages/man3/assert.3.html</a> ), I would recommend adding some additional code to deal with compilation without the debug flag"}, {"owner": {"reputation": 623, "user_id": 2491350, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/21b00afe3f3ab6235649f62a35132ac7?s=128&d=identicon&r=PG", "display_name": "SilverTear", "link": "https://stackoverflow.com/users/2491350/silvertear"}, "edited": false, "score": 0, "creation_date": 1557300362, "post_id": 56034969, "comment_id": 98713653, "body": "The code you gave doesn&#39;t compile for me."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1557303018, "post_id": 56034969, "comment_id": 98714927, "body": "Hint: google <code>0xCDCDCDCD</code>."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1557303246, "post_id": 56034969, "comment_id": 98715014, "body": "Other hint: compile with all warnings enabled and treat warning as errors. <code>listQueueRemoveFront</code> doesn&#39;t return anything. And you use <code>listQueueIsEmpty</code> without it being defined."}, {"owner": {"reputation": 3, "user_id": 9768414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5368a45e1a4d257f03770beb560731e?s=128&d=identicon&r=PG&f=1", "display_name": "Zedrimar", "link": "https://stackoverflow.com/users/9768414/zedrimar"}, "edited": false, "score": 0, "creation_date": 1557304230, "post_id": 56034969, "comment_id": 98715467, "body": "I was using Visual Studio 2019 to compile, it worked up until the part where it crashes. Assert worked fine for me so far, and the instructor included a few other assert statements that worked (other questions, already done).  Also, thanks for catching the lack of return on that function, I guess I must have deleted the return in the mayhem of trying to fix my bugs"}, {"owner": {"reputation": 3, "user_id": 9768414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5368a45e1a4d257f03770beb560731e?s=128&d=identicon&r=PG&f=1", "display_name": "Zedrimar", "link": "https://stackoverflow.com/users/9768414/zedrimar"}, "edited": false, "score": 0, "creation_date": 1557304760, "post_id": 56034969, "comment_id": 98715733, "body": "Did changes suggested as far as the checks, sadly, nothing :/  Same error comes back up. The only other thing VS tells me is a warning about <code>stack</code> in <code>struct Stack* listStackFromQueuesCreate()</code>. It was a warning about dereferencing a null pointer, though the code still runs the required init.  For those who this code does not compile for, I found this online compiler to compile the code (it&#39;ll still crash in the current state of that code though, but a few of the outputs will still print before that happens) <a href=\"https://www.onlinegdb.com/online_c_compiler\" rel=\"nofollow noreferrer\">onlinegdb.com/online_c_compiler</a>"}, {"owner": {"reputation": 623, "user_id": 2491350, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/21b00afe3f3ab6235649f62a35132ac7?s=128&d=identicon&r=PG", "display_name": "SilverTear", "link": "https://stackoverflow.com/users/2491350/silvertear"}, "edited": false, "score": 0, "creation_date": 1557305447, "post_id": 56034969, "comment_id": 98716144, "body": "Using assert is fine if you don&#39;t expect the condition to <i>ever</i> happen and you are surprised if it does. If you expect it to happen, then you should use an if statement to check and handle accordingly."}, {"owner": {"reputation": 623, "user_id": 2491350, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/21b00afe3f3ab6235649f62a35132ac7?s=128&d=identicon&r=PG", "display_name": "SilverTear", "link": "https://stackoverflow.com/users/2491350/silvertear"}, "edited": false, "score": 0, "creation_date": 1557305592, "post_id": 56034969, "comment_id": 98716219, "body": "Can you update your post with the updated code? If you did any?"}, {"owner": {"reputation": 3, "user_id": 9768414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5368a45e1a4d257f03770beb560731e?s=128&d=identicon&r=PG&f=1", "display_name": "Zedrimar", "link": "https://stackoverflow.com/users/9768414/zedrimar"}, "edited": false, "score": 0, "creation_date": 1557305623, "post_id": 56034969, "comment_id": 98716238, "body": "ah... Yeah, I&#39;m just using it because the commented instructions say for me to :/"}, {"owner": {"reputation": 3, "user_id": 9768414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5368a45e1a4d257f03770beb560731e?s=128&d=identicon&r=PG&f=1", "display_name": "Zedrimar", "link": "https://stackoverflow.com/users/9768414/zedrimar"}, "edited": false, "score": 0, "creation_date": 1557306037, "post_id": 56034969, "comment_id": 98716482, "body": "Added edit to the code block showing current state of my code"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9768414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5368a45e1a4d257f03770beb560731e?s=128&d=identicon&r=PG&f=1", "display_name": "Zedrimar", "link": "https://stackoverflow.com/users/9768414/zedrimar"}, "edited": false, "score": 0, "creation_date": 1557305908, "post_id": 56036316, "comment_id": 98716403, "body": "I actually do use visual studio :P  Just made an edit on the main question saying that, I should have been more clear about that from the beginning  Also, thanks for the suggestion about pointer swap, I was actually curious about that, so I just did the first thing that came to mind. I guess I was just over thinking it again (not surprising)"}, {"owner": {"reputation": 623, "user_id": 2491350, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/21b00afe3f3ab6235649f62a35132ac7?s=128&d=identicon&r=PG", "display_name": "SilverTear", "link": "https://stackoverflow.com/users/2491350/silvertear"}, "reply_to_user": {"reputation": 3, "user_id": 9768414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5368a45e1a4d257f03770beb560731e?s=128&d=identicon&r=PG&f=1", "display_name": "Zedrimar", "link": "https://stackoverflow.com/users/9768414/zedrimar"}, "edited": false, "score": 0, "creation_date": 1557306037, "post_id": 56036316, "comment_id": 98716484, "body": "Did changing this change anything about the error or where it happens?"}, {"owner": {"reputation": 3, "user_id": 9768414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5368a45e1a4d257f03770beb560731e?s=128&d=identicon&r=PG&f=1", "display_name": "Zedrimar", "link": "https://stackoverflow.com/users/9768414/zedrimar"}, "edited": false, "score": 0, "creation_date": 1557306095, "post_id": 56036316, "comment_id": 98716516, "body": "Could that sentinel be causing issues? I am still trying to understand how it interacts with the head and tail nodes. And no, sadly none of the edits changed a thing. As soon as a call is made to the first add to front command, it goes to the write access violation.  I&#39;ve always been using VS, though I only just recently went from 2017 version to the latest (2019)"}, {"owner": {"reputation": 623, "user_id": 2491350, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/21b00afe3f3ab6235649f62a35132ac7?s=128&d=identicon&r=PG", "display_name": "SilverTear", "link": "https://stackoverflow.com/users/2491350/silvertear"}, "reply_to_user": {"reputation": 3, "user_id": 9768414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5368a45e1a4d257f03770beb560731e?s=128&d=identicon&r=PG&f=1", "display_name": "Zedrimar", "link": "https://stackoverflow.com/users/9768414/zedrimar"}, "edited": false, "score": 0, "creation_date": 1557306293, "post_id": 56036316, "comment_id": 98716627, "body": "Still your previous code was incorrect. Hopefully you understand why it was."}, {"owner": {"reputation": 623, "user_id": 2491350, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/21b00afe3f3ab6235649f62a35132ac7?s=128&d=identicon&r=PG", "display_name": "SilverTear", "link": "https://stackoverflow.com/users/2491350/silvertear"}, "reply_to_user": {"reputation": 3, "user_id": 9768414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5368a45e1a4d257f03770beb560731e?s=128&d=identicon&r=PG&f=1", "display_name": "Zedrimar", "link": "https://stackoverflow.com/users/9768414/zedrimar"}, "edited": false, "score": 0, "creation_date": 1557306857, "post_id": 56036316, "comment_id": 98716940, "body": "Not sure why this code compiles for you under VS. It really should not with a missing return value and mismatching types."}, {"owner": {"reputation": 3, "user_id": 9768414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5368a45e1a4d257f03770beb560731e?s=128&d=identicon&r=PG&f=1", "display_name": "Zedrimar", "link": "https://stackoverflow.com/users/9768414/zedrimar"}, "edited": false, "score": 0, "creation_date": 1557307728, "post_id": 56036316, "comment_id": 98717430, "body": "I&#39;m just as curious as you are, normally VS screams about it, but not that time for some reason, so I totally forgot about it after I accidentally removed it. And uhhh... sorry, I really am a rookie when it comes to the whole coding thing... I also kinda didn&#39;t do any C coding for about 6 months because of the order I had to take some classes back in junior college, so that also kinda kicked me real hard right in the butt. I learn by example, so sometimes I need to see a completed program (or several for that matter), in order for me to understand different situations, like pointer swaps, etc."}, {"owner": {"reputation": 3, "user_id": 9768414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5368a45e1a4d257f03770beb560731e?s=128&d=identicon&r=PG&f=1", "display_name": "Zedrimar", "link": "https://stackoverflow.com/users/9768414/zedrimar"}, "edited": false, "score": 0, "creation_date": 1557308345, "post_id": 56036316, "comment_id": 98717773, "body": "Well dang, guess that one lack of initialization is what sent that whole read/write thing, thanks! Now time for me to go skitter off into my little corner again and figure out the rest of the stack bugs... Everything compiles now (for now at least)."}], "tags": [], "owner": {"reputation": 623, "user_id": 2491350, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/21b00afe3f3ab6235649f62a35132ac7?s=128&d=identicon&r=PG", "display_name": "SilverTear", "link": "https://stackoverflow.com/users/2491350/silvertear"}, "is_accepted": true, "score": 0, "last_activity_date": 1557307554, "last_edit_date": 1557307554, "creation_date": 1557303287, "answer_id": 56036316, "question_id": 56034969, "link": "https://stackoverflow.com/questions/56034969/write-access-violation-0xcdcdcdcd-when-pushing-values-to-front-of-queue-lin/56036316#56036316", "title": "Write Access Violation (@ 0xCDCDCDCD) When Pushing Values To Front Of Queue (Linked List)", "body": "<p>Your code has more than 1 problem. But your particular problem is being caused by <code>listSwapStackQueues</code>. </p>\n\n<p>You are allocating some memory for a temp Queue, then you assign the pointer to that memory to <code>q2</code>. Then you use free to deallocate the memory, leaving q2 pointing to something that is no longer there. </p>\n\n<p>In fact, you don't need to allocate any memory here at all, since probably all you want is to swap the pointers. All you need to do in this case is:</p>\n\n<pre><code>struct Queue *temp = stack-&gt;q1;    \nstack-&gt;q1 = stack-&gt;q2;\nstack-&gt;q2 = temp;\n</code></pre>\n\n<p>Are you using a debugger to debug your program? If you don't, you should familiarize yourself with one. Finding memory errors like these can be difficult without a proper debugger.</p>\n\n<p>You will run into more issues like these, so having a good debugger is important. If you are on Windows, I would recommend just getting Visual Studio, since it is free and pretty powerful. </p>\n\n<p>EDIT:</p>\n\n<p>Next to the answers given by the others, there is also the following:\nWhen you add new nodes to the list, initialize next as NULL. i.e., in your function <code>listQueueAddBack</code>:</p>\n\n<pre><code>    struct Link* newLink = (struct Link*) malloc (sizeof (struct Link));\n    assert (newLink != NULL);\n    newLink-&gt;value = value;\n    // Initialize next. \n    newLink-&gt;next = NULL;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 9768414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5368a45e1a4d257f03770beb560731e?s=128&d=identicon&r=PG&f=1", "display_name": "Zedrimar", "link": "https://stackoverflow.com/users/9768414/zedrimar"}, "edited": false, "score": 0, "creation_date": 1557307480, "post_id": 56036608, "comment_id": 98717289, "body": "Added a return now, will update again. Thanks for the pointer swap suggestion too, I just put that in! I was a bit curious how the whole swap thing would go for structs, so I thought to do the memory allocation (probably because of something else totally irrelevant)."}], "tags": [], "owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "is_accepted": false, "score": 0, "last_activity_date": 1557306251, "last_edit_date": 1557306251, "creation_date": 1557304338, "answer_id": 56036608, "question_id": 56034969, "link": "https://stackoverflow.com/questions/56034969/write-access-violation-0xcdcdcdcd-when-pushing-values-to-front-of-queue-lin/56036608#56036608", "title": "Write Access Violation (@ 0xCDCDCDCD) When Pushing Values To Front Of Queue (Linked List)", "body": "<ol>\n<li><p>There is one problem in swapping queues:</p>\n\n<p>void listSwapStackQueues(struct Stack* stack)\n{\n    /* FIXME: You will write this function <em>/\n    assert (stack != 0);\n    struct Queue</em> temp = (struct Queue*) malloc (sizeof(struct Queue));\n    temp = stack->q1;\n    stack->q1 = stack->q2;\n    stack->q2 = temp;\n    free (temp);\n}</p></li>\n</ol>\n\n<p>This is freeing the <code>stack-&gt;q1</code> pointer, so invalidating list head and straight up leaks memory. Doing:</p>\n\n<pre><code>type *pnt = malloc(...); \npnt = ...\n</code></pre>\n\n<p>is always wrong and leaks memory. Just swap the pointers, without doing any malloc and free:</p>\n\n<pre><code>void listSwapStackQueues(struct Stack* stack)\n{\n    assert (stack != 0);\n    struct Queue* temp;\n    temp = stack-&gt;q1;\n    stack-&gt;q1 = stack-&gt;q2;\n    stack-&gt;q2 = temp;\n}\n</code></pre>\n\n<ol start=\"2\">\n<li><p>The type of pointer passed to <code>listQueueIsEmpty</code> inside <code>listQueueRemoveFront</code> inside assertion is invalid:</p>\n\n<p>TYPE listQueueRemoveFront(struct Queue* queue)\n{\n    assert (listQueueIsEmpty(queue->head)); // invalid</p></li>\n</ol>\n\n<p>You want to pass the queue, ie. <code>listQueueIsEmpty(queue)</code>, to the function. Also list queue should <em>not</em> be empty when removing, so you want to probably negate the expression:</p>\n\n<pre><code>TYPE listQueueRemoveFront(struct Queue* queue)\n{\n    assert (!listQueueIsEmpty(queue));\n</code></pre>\n\n<p>Also remember to forward declare the function, so that compiler can warn you:</p>\n\n<pre><code>int listQueueIsEmpty(struct Queue* queue);\nTYPE listQueueRemoveFront(struct Queue* queue)\n{\n    assert (!listQueueIsEmpty(queue));\n</code></pre>\n\n<ol start=\"3\">\n<li><p>There is no <code>return</code> statement in your <code>listQueueRemoveFront</code> function. The code is thus invalid and invokes undefined behavior:</p>\n\n<p>TYPE listQueueRemoveFront(struct Queue* queue)\n{\n    // no return here\n}</p>\n\n<p>.. later in Push ... \n    TYPE valueTemp = listQueueRemoveFront (stack->q1);</p></li>\n</ol>\n\n<p>Remember to always compile with warnings enabled (with <code>gcc</code> use <code>-Wall -Wextra -Werror</code>) and to fix all warnings. When compiling with warnings enabled the issue is made clear by the compiler:</p>\n\n<pre><code>1.c: In function \u2018listQueueFront\u2019:\n1.c:98:13: warning: implicit declaration of function \u2018listQueueIsEmpty\u2019; did you mean \u2018listQueueInit\u2019? [-Wimplicit-function-declaration]\n     assert (listQueueIsEmpty(queue) != 1);\n             ^~~~~~~~~~~~~~~~\n1.c: In function \u2018listQueueRemoveFront\u2019:\n1.c:123:1: warning: control reaches end of non-void function [-Wreturn-type]\n }\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9768414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5368a45e1a4d257f03770beb560731e?s=128&d=identicon&r=PG&f=1", "display_name": "Zedrimar", "link": "https://stackoverflow.com/users/9768414/zedrimar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 203, "favorite_count": 0, "accepted_answer_id": 56036316, "answer_count": 2, "score": 0, "last_activity_date": 1557307972, "creation_date": 1557297878, "last_edit_date": 1557307972, "question_id": 56034969, "link": "https://stackoverflow.com/questions/56034969/write-access-violation-0xcdcdcdcd-when-pushing-values-to-front-of-queue-lin", "title": "Write Access Violation (@ 0xCDCDCDCD) When Pushing Values To Front Of Queue (Linked List)", "body": "<p>I am not sure why, but when the code gets to <code>queue-&gt;tail-&gt;next = newLink;</code> in</p>\n\n<pre><code>void listQueueAddBack (struct Queue* queue, TYPE value) {\n    /* FIXME: You will write this function */\n    assert (queue != 0);\n    struct Link* newLink = (struct Link*) malloc (sizeof (struct Link));\n    assert (newLink != NULL);\n    newLink-&gt;value = value;\n    queue-&gt;tail-&gt;next = newLink;\n    queue-&gt;tail = newLink;\n}\n</code></pre>\n\n<p>I get a write access violation (address 0xCDCDCDCD). Did I accidentally pass a null pointer? I'm still a bit new to C, so this is a learning experience for me.</p>\n\n<p>I also tinkered with the <code>listQueueIsEmpty</code>, as it had a read access violation, but I seem to have gotten past that. Now I am at the actual push part.</p>\n\n<p>I'm not sure if this is too much, but I don't really know much about what is causing it, so here is all the useful bits of the code file. I don't want others to do my homework for me, but if there are any super big code errors, please do let me know as it helps me learn when dealing with future C projects. I tried to collapse this a bit so no one has to do the 100 meter scroll to get to the bottom (it's not too long, but still)</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;assert.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n\n#ifndef TYPE\n#define TYPE int\n#endif\n\n// Single link\nstruct Link {\n    TYPE value;\n    struct Link* next;\n};\n\n// Single linked list with head and tail pointers\nstruct Queue {\n    struct Link* head;\n    struct Link* tail;\n};\n\n// Stack with two Queue instances\nstruct Stack {\n    struct Queue* q1;\n    struct Queue* q2;\n};\n\n/**\n    Internal func allocates the queue's sentinel. Sets sentinels' next to null,\n    and queue's head and tail to the sentinel.\n    param:  queue   struct LinkedList ptr\n    pre:    queue is not null\n    post:   queue sentinel not null\n            sentinel next points to null\n            head points to sentinel (always)\n            tail points to sentinel (always point to last link unless empty)\n */\nvoid listQueueInit(struct Queue* queue) \n{\n    /* FIXME: You will write this function */\n    assert(queue != 0);\n\n    struct Link* sentinel = (struct Link*)malloc (sizeof (struct Link));\n    assert (sentinel != 0);\n\n    sentinel-&gt;next = 0;\n    queue-&gt;head = sentinel;\n    queue-&gt;tail = sentinel;\n}\n\n/**\n    Allocates and initializes a queue.\n    pre:    none\n    post:   memory allocated for new struct Queue ptr\n            queue init (call to _initQueue func)\n    return: queue\n */\nstruct Queue* listQueueCreate() \n{\n\n     /* FIXME: You will write this function */\n    struct Queue* queue = (struct Queue*) malloc (sizeof (struct Queue));\n    listQueueInit (queue);\n    return queue;\n}\n\n/**\n    Adds a new link with the given value to the back of the queue.\n    param:  queue   struct Queue ptr\n    param:  value   TYPE\n    pre:    queue is not null\n    post:   link is created with given value \n            link is added after the current last link (pointed to by queue tail)\n */\n\nvoid listQueueAddBack (struct Queue* queue, TYPE value) \n{\n    /* FIXME: You will write this function */\n    assert (queue != NULL);\n    assert (queue-&gt;tail != NULL);\n    struct Link* newLink = (struct Link*) malloc (sizeof (struct Link));\n    assert (newLink != NULL);\n    newLink-&gt;value = value;\n    newLink-&gt;next = NULL;\n    queue-&gt;tail-&gt;next = newLink;\n    queue-&gt;tail = newLink;\n}\n\n/**\n    Returns the value of the link at the front of the queue.\n    param:  queue   struct Queue ptr\n    pre:    queue is not null\n    pre:    queue is not empty (i.e., queue's head next pointer is not null)\n    post:   none\n    ret:    first link's value \n */\nTYPE listQueueFront(struct Queue* queue) \n{\n\n   /* FIXME: You will write this function */\n    assert (queue != NULL);\n    assert (listQueueIsEmpty(queue) != 1);\n    return ((queue-&gt;head)-&gt;next)-&gt;value;\n}\n\n/**\n    Removes the link at the front of the queue and returns the value\n    of the removed link.\n    param:  queue   struct Queue ptr\n    pre:    queue is not null\n    pre:    queue is not empty (i.e., queue's head next pointer is not null)\n    post:   first link is removed and freed (call to removeLink)\n */\nint listQueueIsEmpty (struct Queue* queue);\nTYPE listQueueRemoveFront(struct Queue* queue) \n{\n    /* FIXME: You will write this function */\n    assert (queue != 0);\n    assert (!listQueueIsEmpty(queue));\n    struct Link* toDelete = queue-&gt;head-&gt;next;\n    if (toDelete == queue-&gt;tail) {\n        queue-&gt;tail = queue-&gt;head;\n    }\n    else {\n        queue-&gt;head-&gt;next = toDelete-&gt;next;\n    }\n    return toDelete;\n    free (toDelete);\n}\n\n/**\n    Returns 1 if the queue is empty and 0 otherwise.\n    param:  queue   struct Queue ptr\n    pre:    queue is not null\n    post:   none\n    ret:    1 if queue head next pointer is null (empty); \n            otherwise 0 (not null; not empty)\n */\nint listQueueIsEmpty(struct Queue* queue) \n{\n    /* FIXME: You will write this function */\n    assert (queue != NULL);\n    assert (queue-&gt;tail != NULL);\n    if ((queue-&gt;head)-&gt;next == NULL) {\n        return 1;\n    }\n    else {\n        return 0;\n    }\n}\n\n/**\n    Deallocates every link in the queue including the sentinel,\n    and frees the queue itself.\n    param:  queue   struct Queue ptr\n    pre:    queue is not null\n    post:   memory allocated to each link is freed\n            \" \" sentinel \" \"\n            \" \" queue \" \"\n */\nvoid listQueueDestroy(struct Queue* queue) \n{\n\n        assert(queue != NULL);\n    while(!listQueueIsEmpty(queue)) {\n        listQueueRemoveFront(queue);\n    }\n    free(queue-&gt;head);\n    free(queue);\n    queue = NULL;\n\n}\n\n/**\n    Allocates and initializes a stack that is comprised of two \n    instances of Queue data structures.\n    pre:    none\n    post:   memory allocated for new struct Stack ptr\n            stack q1 Queue instance init (call to queueCreate func)\n            stack q2 Queue instance init (call to queueCreate func)\n    return: stack\n */\nstruct Stack* listStackFromQueuesCreate() \n{\n     /* FIXME: You will write this function */\n    struct Stack* stack = (struct Stack*) malloc (sizeof (struct Stack));\n    stack-&gt;q1 = listQueueCreate();\n    stack-&gt;q2 = listQueueCreate();\n    return (stack);\n};\n\n/**\n    Deallocates every link in both queues contained in the stack,\n    (inc.the sentinel), the queues themselves and the stack itself.\n    param:  stack   struct Stack ptr\n    pre:    stack is not null\n    pre:    queues are not null\n    post:   memory allocated to each link is freed along with the \n            two queues and stack themselves\n\n    Note that I checked that q1 and q2 are not null in this function\n    also when I could have just left the assertion to fail in queueDestroy\n    if either were pointing to null, but I thought it best to be explicit,\n    albeit slightly repetitive.\n */\nvoid listStackDestroy(struct Stack* stack)\n{\n    assert(stack != NULL);\n    assert(stack-&gt;q1 != NULL &amp;&amp; stack-&gt;q2 != NULL);\n    listQueueDestroy(stack-&gt;q1);\n    listQueueDestroy(stack-&gt;q2);\n    free(stack);\n    stack = NULL;\n}\n\n/**\n    Returns 1 if the stack is empty and 0 otherwise.\n    param:  stack   struct Stack ptr\n    pre:    stack is not null\n    post:   none\n    ret:    1 if q1 is empty; else, 0\n */\nint listStackIsEmpty(struct Stack* stack)\n{\n\n    /* FIXME: You will write this function */\n    assert (stack != NULL);\n    if (listQueueIsEmpty (stack-&gt;q1)) {\n        return 1;\n    }\n    else {\n        return 0;\n    }\n}\n\n/**\n    This internal function swaps what q1 and q2 pointers, such that\n    q1 points to q2 and q2 points to q1.\n    param:  stack   struct LinkedList ptr\n    param:  value   TYPE\n    pre:    stack is not null\n    post:   q1 points to the actual 'stack' with links\n */\nvoid listSwapStackQueues(struct Stack* stack)\n{\n    /* FIXME: You will write this function */\n    assert (stack != 0);\n    struct Queue* temp = stack-&gt;q1;\n    stack-&gt;q1 = stack-&gt;q2;\n    stack-&gt;q2 = temp;\n}\n\n/**\n    Adds a new link with the given value to the back of the Queue q2.\n    Then while Queue q1 isn't empty, the first link of the queue is \n    dequeued/removed and added to the back of Queue q2, so that in\n    the end, Queue q2 has the new order to represent the stack properly\n    with the new value at the front of the queue.\n    param:  stack   struct LinkedList ptr\n    param:  value   TYPE\n    pre:    stack is not null\n    post:   new link is created w/ given value and added to end of q2\n            the first link of q1 is removed and added to end of q2 until\n            it's empty\n            q1 and q2 are swapped\n */\nvoid listStackPush(struct Stack* stack, TYPE value) \n{\n    /* FIXME: You will write this function */\n    assert (stack != NULL);\n    listQueueAddBack (stack-&gt;q2, value);\n    while (!listQueueIsEmpty(stack-&gt;q1))\n    {\n        TYPE valueTemp = listQueueRemoveFront (stack-&gt;q1);\n        listQueueAddBack (stack-&gt;q2, valueTemp);\n    }\n    listSwapStackQueues (stack);\n}\n\n/**\n    Removes the link at the top of the stack and returns its value.\n    param:  stack   struct Stack ptr\n    pre:    stack is not null\n    pre:    stack is not empty\n    post:   first link is removed and freed (call to removeLink)\n    ret:    value of the removed link\n */\nTYPE listStackPop(struct Stack* stack) \n{\n    /* FIXME: You will write this function */\n    assert (stack != 0);\n    assert (!listQueueIsEmpty (stack-&gt;q1));\n    return listQueueRemoveFront (stack-&gt;q1);\n}\n\n/**\n    Returns the value of the link at the top of the stack.\n    param:  stack   struct Stack ptr\n    pre:    stack is not null\n    pre:    stack is not empty\n    post:   none\n    ret:    first link's value \n */\nTYPE listStackTop(struct Stack* stack) \n{\n    /* FIXME: You will write this function */\n    assert (!listQueueIsEmpty (stack-&gt;q1));\n    assert (stack != 0);\n    return listQueueFront (stack-&gt;q1);\n}\n\n/**\n    Used for testing the stack from queue implementation.\n */\n\nvoid assertTrue(int pred, char* msg) \n{\n    printf(\"%s: \", msg);\n    if(pred)\n        printf(\"\\tPASSED\\n\");\n    else\n        printf(\"\\tFAILED\\n\");\n}\n\nint main() \n{\n    struct Stack* s = listStackFromQueuesCreate();\n    assert(s);\n    printf(\"\\n-------------------------------------------------\\n\"); \n    printf(\"---- Testing stack from queue implementation ----\\n\");\n    printf(\"-------------------------------------------------\\n\"); \n    printf(\"stack init...\\n\");\n    assertTrue(listStackIsEmpty(s) == 1, \"stackIsEmpty == 1\");\n\n    printf(\"\\npushing 4, 5, -300...\\n\");\n    listStackPush(s, 4);\n    listStackPush(s, 5);\n    listStackPush(s, -300);\n\n    assertTrue(listStackIsEmpty(s) == 0, \"stackIsEmpty == 0\");\n    assertTrue(listStackPop(s) == -300, \"\\npopping; val == -300\");\n    assertTrue(listStackPop(s) == 5, \"popping; val == 5\");\n    assertTrue(listStackTop(s) == 4, \"top val == 4\\t\");\n    assertTrue(listStackPop(s) == 4, \"popping; val == 4\");\n    assertTrue(listStackIsEmpty(s) == 1, \"stackIsEmpty == 1\");\n    // listStackPop(s);     // should fail assert\n    // listStackTop(s);     // should fail assert\n\n    printf(\"\\npushing 0-9...\\n\");\n    for(int i = 0; i &lt; 10; i++) {\n        listStackPush(s, i);\n    }\n    assertTrue(listStackTop(s) == 9, \"top val == 9\\t\");\n\n    listStackDestroy(s);\n\n    return 0;\n}\n</code></pre>\n\n<p>~-~-~-Edit 1-~-~-~</p>\n\n<p>Updated code thing above, should have return now. </p>\n\n<p>Also, I currently use Visual Studio 2019 for my compiler. My university has a Unix compiler, but I haven't tested it yet because of having to VPN into it first and what not. I will eventually test it, I just didn't as of doing this code.</p>\n\n<p>~-~-~-Edit 2-~-~-~\nadded code edits again (this time with return derp fixed)</p>\n\n<p>sorry for the amount of errors, I just now got back into C coding since I had to take some classes in junior college in a really weird order, mostly due to availability of classes, since my data structures normally wouldn't be available until fall of next year. I just happened to get lucky and transfer to Uni and got into it there</p>\n"}, {"tags": ["c", "windows"], "comments": [{"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 1, "creation_date": 1557296163, "post_id": 56034339, "comment_id": 98711764, "body": "Use <a href=\"https://docs.microsoft.com/en-us/windows/desktop/api/psapi/nf-psapi-enumprocesses\" rel=\"nofollow noreferrer\"><code>EnumProcesses()</code></a>?"}, {"owner": {"reputation": 82917, "user_id": 3501, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/1fd5f5cc203c393634379a3b3b7e7a87?s=128&d=identicon&r=PG", "display_name": "Anders", "link": "https://stackoverflow.com/users/3501/anders"}, "reply_to_user": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1557309793, "post_id": 56034339, "comment_id": 98718595, "body": "@alk EnumProcesses uses the same list as the toolhelp API"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1557310096, "post_id": 56034339, "comment_id": 98718742, "body": "So is your question about speed or completeness?"}, {"owner": {"reputation": 3, "user_id": 4002795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6eb987d33f36479077fc6bbbfff536a5?s=128&d=identicon&r=PG&f=1", "display_name": "Gwak", "link": "https://stackoverflow.com/users/4002795/gwak"}, "reply_to_user": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1557360260, "post_id": 56034339, "comment_id": 98742246, "body": "@alk  Yes, it&#39;s a faster way."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 4002795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6eb987d33f36479077fc6bbbfff536a5?s=128&d=identicon&r=PG&f=1", "display_name": "Gwak", "link": "https://stackoverflow.com/users/4002795/gwak"}, "edited": false, "score": 0, "creation_date": 1557393498, "post_id": 56038297, "comment_id": 98752890, "body": "Hello anders.  I agree with you.  I do not think the above method is always right.  However, I have used SSDT hooking to find hidden processes.  So I&#39;m looking for a better way (Fast).   Thank you for your valuable feedback."}], "tags": [], "owner": {"reputation": 82917, "user_id": 3501, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/1fd5f5cc203c393634379a3b3b7e7a87?s=128&d=identicon&r=PG", "display_name": "Anders", "link": "https://stackoverflow.com/users/3501/anders"}, "is_accepted": true, "score": 0, "last_activity_date": 1557310276, "creation_date": 1557310276, "answer_id": 56038297, "question_id": 56034339, "link": "https://stackoverflow.com/questions/56034339/is-there-a-way-to-quickly-find-hidden-processes-in-the-windows-os/56038297#56038297", "title": "Is there a way to quickly find hidden processes in the Windows OS?", "body": "<p>A rootkit hidden process will probably use a driver and unhook itself from the list of processes. I doubt <code>OpenProcess</code> will work even if you know the pid. Fighting a kernel-rootkit from usermode is nearly impossible.</p>\n"}], "owner": {"reputation": 3, "user_id": 4002795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6eb987d33f36479077fc6bbbfff536a5?s=128&d=identicon&r=PG&f=1", "display_name": "Gwak", "link": "https://stackoverflow.com/users/4002795/gwak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "closed_date": 1557402694, "accepted_answer_id": 56038297, "answer_count": 1, "score": -1, "last_activity_date": 1557310276, "creation_date": 1557294774, "last_edit_date": 1557296418, "question_id": 56034339, "link": "https://stackoverflow.com/questions/56034339/is-there-a-way-to-quickly-find-hidden-processes-in-the-windows-os", "closed_reason": "Needs details or clarity", "title": "Is there a way to quickly find hidden processes in the Windows OS?", "body": "<p>I want to know how to quickly find hidden processes in the Windows OS.</p>\n\n<p>How to find hidden processes that are currently in use.</p>\n\n<ol>\n<li><p>Find the PID in multiples of 4 using the BroutForce method. </p></li>\n<li><p>Compare with the list found with CreateToolHelp32Snapshot API.</p></li>\n</ol>\n\n<p>Is there a way to find it faster than the current use?</p>\n"}, {"tags": ["c", "winapi", "screenshot"], "comments": [{"owner": {"reputation": 8766, "user_id": 451321, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/7Sdao.jpg?s=128&g=1", "display_name": "Michael Chourdakis", "link": "https://stackoverflow.com/users/451321/michael-chourdakis"}, "edited": false, "score": 0, "creation_date": 1557327297, "post_id": 56034052, "comment_id": 98729112, "body": "Why not using WindowFromPoint function in a loop?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10715362"}, "reply_to_user": {"reputation": 8766, "user_id": 451321, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/7Sdao.jpg?s=128&g=1", "display_name": "Michael Chourdakis", "link": "https://stackoverflow.com/users/451321/michael-chourdakis"}, "edited": false, "score": 0, "creation_date": 1557340298, "post_id": 56034052, "comment_id": 98735652, "body": "Since I can&#39;t always predict the position that this window will appear."}, {"owner": {"reputation": 8766, "user_id": 451321, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/7Sdao.jpg?s=128&g=1", "display_name": "Michael Chourdakis", "link": "https://stackoverflow.com/users/451321/michael-chourdakis"}, "edited": false, "score": 0, "creation_date": 1557340414, "post_id": 56034052, "comment_id": 98735686, "body": "Get the rect with GetWindowRect()."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10715362"}, "reply_to_user": {"reputation": 8766, "user_id": 451321, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/7Sdao.jpg?s=128&g=1", "display_name": "Michael Chourdakis", "link": "https://stackoverflow.com/users/451321/michael-chourdakis"}, "edited": false, "score": 0, "creation_date": 1557340645, "post_id": 56034052, "comment_id": 98735785, "body": "For this I need hWnd and in the case of GetWindowRect I don&#39;t have it."}, {"owner": {"reputation": 1173, "user_id": 7419215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23f878af1dc4fa9fde5cacde882e85dd?s=128&d=identicon&r=PG&f=1", "display_name": "montonero", "link": "https://stackoverflow.com/users/7419215/montonero"}, "edited": false, "score": 0, "creation_date": 1557356577, "post_id": 56034052, "comment_id": 98741530, "body": "As a side measure you could try to level up a priority of the application&#39;s process."}, {"owner": {"reputation": 4915, "user_id": 11128312, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ufn85.jpg?s=128&g=1", "display_name": "Strive Sun", "link": "https://stackoverflow.com/users/11128312/strive-sun"}, "edited": false, "score": 0, "creation_date": 1557389213, "post_id": 56034052, "comment_id": 98750477, "body": "In any case, you need a handle to a particular window, no matter what API you call to detect whether the window is redrawn or not."}], "answers": [{"comments": [{"owner": {"reputation": 3035, "user_id": 1413244, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/BaB5H.png?s=128&g=1", "display_name": "jwezorek", "link": "https://stackoverflow.com/users/1413244/jwezorek"}, "edited": false, "score": 1, "creation_date": 1557431946, "post_id": 56034846, "comment_id": 98773311, "body": "generic Win32 windows are not automatically backed by bitmaps or something like that so &quot;copying from its context&quot; is not magically going to work for a window that is invisible or occluded. The OP could try sending the window the WM_PRINT message which tells Windows to paint the target window into a given HDC but in my experience this message tends to not work."}], "tags": [], "owner": {"reputation": 10774, "user_id": 4419802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d0f1bd19b8b8481b6b3e812691c1ccb?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/4419802/matt"}, "is_accepted": false, "score": 2, "last_activity_date": 1557297949, "last_edit_date": 1557297949, "creation_date": 1557297354, "answer_id": 56034846, "question_id": 56034052, "link": "https://stackoverflow.com/questions/56034052/determine-if-window-is-visible-with-high-cpu/56034846#56034846", "title": "Determine if window is visible with High CPU", "body": "<blockquote>\n  <p>if the window was fully drawn and visible to the human eye?</p>\n</blockquote>\n\n<p>To take screenshot you don't need the window to be visible. You only have to copy from its context. So just do <code>GetWindowDC()</code> and use it.</p>\n\n<p>If you really need to check if it's \"visible to human eye\", you must also ensure that the window is at the top of Z-order. Otherwise, it could be overlayed by some other window.</p>\n\n<p>If you want to check if window was fully repainted, you can test its <code>GetUpdateRect()</code> value.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10715362"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1557301837, "creation_date": 1557293155, "last_edit_date": 1557293246, "question_id": 56034052, "link": "https://stackoverflow.com/questions/56034052/determine-if-window-is-visible-with-high-cpu", "title": "Determine if window is visible with High CPU", "body": "<p><strong>Background</strong></p>\n\n<p>I am trying to screenshot a specific window, however the OS where I need to accomplish this has very high CPU usage and sometimes my application determines this window as visible however in the screenshot it is either not shown or half drawn.</p>\n\n<p><strong>My Understanding</strong></p>\n\n<p>Since the CPU usage is very high it will not be able to provide enough resources to the process which opens this specific window. Therefore the check for window visibility succeeds it may just mean that the window was initiated for creation but not drawn yet (given the lack of resources).</p>\n\n<p><strong>My Code</strong></p>\n\n<pre><code>HWND hWnd = FindWindowExA(0, 0, NULL, programdata-&gt;caption);\nif (hWnd)\n{\n    if (IsWindowVisible(hWnd))\n    {\n        RECT rect = { 0 };\n        GetWindowRect(hWnd, &amp;rect);\n\n        // if window size also matches requirement then\n        TakeScreenshot();\n</code></pre>\n\n<p><strong>Question</strong></p>\n\n<p>Is there any better way that I can determine if the window was fully drawn and visible to the human eye?</p>\n"}, {"tags": ["c", "file-io", "fwrite"], "comments": [{"owner": {"reputation": 5538, "user_id": 5980430, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e941fd748178dc871ae6a9974d5099d4?s=128&d=identicon&r=PG&f=1", "display_name": "apple apple", "link": "https://stackoverflow.com/users/5980430/apple-apple"}, "edited": false, "score": 0, "creation_date": 1557292873, "post_id": 56033937, "comment_id": 98710721, "body": "this looks like <code>c</code>, did you tag it wrong? (the only c++ part is <code>#include&lt;fstream&gt;</code> and not used at all)"}], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 6926649, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-qnaRPo5LM9I/AAAAAAAAAAI/AAAAAAAAHCY/3BEsVx0HJjg/photo.jpg?sz=128", "display_name": "Umair Assad", "link": "https://stackoverflow.com/users/6926649/umair-assad"}, "edited": false, "score": 0, "creation_date": 1557293004, "post_id": 56033999, "comment_id": 98710769, "body": "even the value of x is not written exactly as entered, and can you please tell how to write the value of Y?"}, {"owner": {"reputation": 155, "user_id": 10035855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0086ebeb9ce251f4a9f010131ad39cc3?s=128&d=identicon&r=PG&f=1", "display_name": "Z.Amir", "link": "https://stackoverflow.com/users/10035855/z-amir"}, "reply_to_user": {"reputation": 53, "user_id": 6926649, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-qnaRPo5LM9I/AAAAAAAAAAI/AAAAAAAAHCY/3BEsVx0HJjg/photo.jpg?sz=128", "display_name": "Umair Assad", "link": "https://stackoverflow.com/users/6926649/umair-assad"}, "edited": false, "score": 0, "creation_date": 1557293154, "post_id": 56033999, "comment_id": 98710816, "body": "@UmairAssad this post here answers your question: <a href=\"https://stackoverflow.com/questions/30565659/fwrite-not-working-to-write-integer-in-binary-file\" title=\"fwrite not working to write integer in binary file\">stackoverflow.com/questions/30565659/&hellip;</a>"}, {"owner": {"reputation": 155, "user_id": 10035855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0086ebeb9ce251f4a9f010131ad39cc3?s=128&d=identicon&r=PG&f=1", "display_name": "Z.Amir", "link": "https://stackoverflow.com/users/10035855/z-amir"}, "reply_to_user": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1557293231, "post_id": 56033999, "comment_id": 98710842, "body": "@Swordfish sorry I don&#39;t have the rights to post comment right now"}], "tags": [], "owner": {"reputation": 155, "user_id": 10035855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0086ebeb9ce251f4a9f010131ad39cc3?s=128&d=identicon&r=PG&f=1", "display_name": "Z.Amir", "link": "https://stackoverflow.com/users/10035855/z-amir"}, "is_accepted": false, "score": 2, "last_activity_date": 1557293508, "last_edit_date": 1557293508, "creation_date": 1557292822, "answer_id": 56033999, "question_id": 56033937, "link": "https://stackoverflow.com/questions/56033937/writing-a-file-by-taking-input-from-user-only-saves-value-for-x-only/56033999#56033999", "title": "Writing a file by taking input from user only saves value for &quot;x&quot; only", "body": "<p>Where are you writing the value of y? I can see that you write the value of <em>x</em> to the file</p>\n\n<pre><code> fwrite((char *)x, sizeof(double), 1, fp);\n</code></pre>\n\n<p>Edit:\nExample to correctly write integer to binary file\n<a href=\"https://stackoverflow.com/questions/30565659/fwrite-not-working-to-write-integer-in-binary-file\">fwrite() not working to write integer in binary file</a></p>\n"}, {"tags": [], "owner": {"reputation": 53, "user_id": 6926649, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-qnaRPo5LM9I/AAAAAAAAAAI/AAAAAAAAHCY/3BEsVx0HJjg/photo.jpg?sz=128", "display_name": "Umair Assad", "link": "https://stackoverflow.com/users/6926649/umair-assad"}, "is_accepted": false, "score": 1, "last_activity_date": 1557293638, "creation_date": 1557293638, "answer_id": 56034136, "question_id": 56033937, "link": "https://stackoverflow.com/questions/56033937/writing-a-file-by-taking-input-from-user-only-saves-value-for-x-only/56034136#56034136", "title": "Writing a file by taking input from user only saves value for &quot;x&quot; only", "body": "<pre><code>fwrite((char *)y, sizeof(double), 1, fp);\n</code></pre>\n\n<p>This was needed to write the value for y, sorry for the wrong Tag!</p>\n"}], "owner": {"reputation": 53, "user_id": 6926649, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-qnaRPo5LM9I/AAAAAAAAAAI/AAAAAAAAHCY/3BEsVx0HJjg/photo.jpg?sz=128", "display_name": "Umair Assad", "link": "https://stackoverflow.com/users/6926649/umair-assad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "closed_date": 1557293703, "answer_count": 2, "score": 0, "last_activity_date": 1557293638, "creation_date": 1557292424, "last_edit_date": 1557293121, "question_id": 56033937, "link": "https://stackoverflow.com/questions/56033937/writing-a-file-by-taking-input-from-user-only-saves-value-for-x-only", "closed_reason": "Duplicate", "title": "Writing a file by taking input from user only saves value for &quot;x&quot; only", "body": "<p>I'm implementing <strong>Lagrange Interpolation to calculate square root of \"y\"</strong>.Taking input from user and writing it to a file <em>\"xyz.dat\"</em> (binary) in order to plot/display the graphs using Matlab.</p>\n\n<p>Values are calculated correctly but the file written do not have both the values for <em>x</em> and <em>y</em> when graph is displayed.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;fstream&gt;\n\nint main(void)\n{\n    float x[100],y[100],a,s=1,t=1,k=0;\n\n    int n,i,j,d=1;\n\n    printf(\"\\n\\n Enter the number of the terms of the table: \");\n    scanf(\"%d\",&amp;n);\n\n    printf(\"\\n\\n Enter the respective values of the variables x and y: \\n\");\n    for(i=0; i&lt;n; i++)\n    {\n        scanf (\"%f\",&amp;x[i]);\n        scanf(\"%f\",&amp;y[i]);\n    }\n\n    printf(\"\\n\\n The table you entered is as follows :\\n\\n\");\n    for(i=0; i&lt;n; i++)\n    {\n        printf(\"%0.3f\\t%0.3f\",x[i],y[i]);\n        printf(\"\\n\");\n    }\n    while(d==1)\n    {\n        printf(\" \\n\\n\\n Enter the value of the x to find the respective value of y\\n\\n\\n\");\n        scanf(\"%f\",&amp;a);\n        for(i=0; i&lt;n; i++)\n        {\n            s=1;\n            t=1;\n            for(j=0; j&lt;n; j++)\n            {\n                if(j!=i)\n                {\n                    s=s*(a-x[j]);\n                    t=t*(x[i]-x[j]);\n                }\n            }\n            k=k+((s/t)*y[i]);\n        }\n        printf(\"\\n\\n The respective value of the variable y is: %f\",k);\n\n        FILE *fp;\n        fp = fopen(\"xyz.dat\", \"wb\");\n        fwrite((char *)x, sizeof(double), 1, fp);\n        fclose(fp);\n\n        printf(\"\\n\\n Do you want to continue?\\n\\n Press 1 to continue and any other key to exit\");\n        scanf(\"%d\",&amp;d);\n    }\n}\n\n</code></pre>\n\n<p>The Expected output should be stored in the file \"xyz.dat\" but when I plot the graph in Matlab it shows just some random values and only for \"X\" not for \"Y\"</p>\n"}, {"tags": ["c", "memory-management", "command-line-arguments", "filestream", "dynamic-memory-allocation"], "comments": [{"owner": {"reputation": 27279, "user_id": 857132, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4fd51ed5980999c7c6ce3729d6cb2184?s=128&d=identicon&r=PG", "display_name": "John3136", "link": "https://stackoverflow.com/users/857132/john3136"}, "edited": false, "score": 0, "creation_date": 1557290727, "post_id": 56033522, "comment_id": 98710161, "body": "<code>numArray = malloc(fileSize * sizeof(int));</code> is allocating space for one integer for every byte in the file. i.e. you are allocating far more memory than you actually need. This in turn means your <code>arraySize</code> will be bigger than the actual number of ints in the file and so your read loop won&#39;t work as expected."}, {"owner": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "edited": false, "score": 1, "creation_date": 1557290903, "post_id": 56033522, "comment_id": 98710206, "body": "<i>I have used ftell() to find the size of the file in bytes so I can allocate memory accordingly however I am pretty sure its not the correct way.</i> --&gt; your intuition is correct. You are opening the file in text mode (ie: seem to have a text file) so the size of the file won&#39;t give you a way to determine the number of integers. You&#39;ll need to either count them first, allocate memory, rewind the file, and fill the array. Or you&#39;ll need to use realloc to keep resizing your array as you run out of storage."}, {"owner": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "edited": false, "score": 0, "creation_date": 1557290972, "post_id": 56033522, "comment_id": 98710222, "body": "I feel like there must be a duplicate for this question."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1557295498, "post_id": 56033522, "comment_id": 98711560, "body": "The only way <code>fseek(inputFile, 0, SEEK_END);</code> makes sense is if the file is a <b>binary</b> file. If the file contains text with any whitespace or delimiters, then the length of the file is irrelevant to the read of values from it and the initial sizing of storage. Simply allocate storage for <code>2, 4, 8 or 16</code> integers to begin with. Keep a count of the number read. <code>realloc</code> when you reach your limit, rinse, repeat until you hit <code>EOF</code>."}], "answers": [{"comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1557295676, "post_id": 56034051, "comment_id": 98711616, "body": "I&#39;d also add to that, better to check <code>argc &lt; 2</code> and handle the error for <i>too few</i> arguments, rather than throw an error for <i>too many</i>. Simply ignore the extraneous arguments (or warn and keep going)."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1557299489, "post_id": 56034051, "comment_id": 98713249, "body": "@DavidC.Rankin: indeed a diagnostic for the missing argument is more important."}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1557320719, "post_id": 56034051, "comment_id": 98724881, "body": "Why <code>exit()</code> from <code>main()</code>? C++-programmers see it, copy it and baaam."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1557321243, "post_id": 56034051, "comment_id": 98725221, "body": "@Swordfish: OK for that, I prefer <code>return</code> from <code>main</code> anyway. Yet why would <code>exit(1)</code> from <code>main()</code> cause a problem for c++ programmers apart from destructors not being called? and why would they naively copy code from a C topic?"}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1557322499, "post_id": 56034051, "comment_id": 98726052, "body": "<i>apart from destructors not being called?</i> \u2013 that! \u2013 <i>and why would they naively copy code from a C topic?</i> \u2013 cause we are lazier than C programmers ;)"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1557322662, "post_id": 56034051, "comment_id": 98726147, "body": "@Swordfish: very funny! I guess laziness get punished sometimes... I&#39;m lazy too but I prefer C."}, {"owner": {"reputation": 29, "user_id": 8762084, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/baff9b1b16b65ca97581aeb2b176c3a4?s=128&d=identicon&r=PG&f=1", "display_name": "Alistair Alva", "link": "https://stackoverflow.com/users/8762084/alistair-alva"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1557364403, "post_id": 56034051, "comment_id": 98742997, "body": "@DavidC.Rankin thanks! The full assignment states that I have to take user input if only one argument is passed."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 29, "user_id": 8762084, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/baff9b1b16b65ca97581aeb2b176c3a4?s=128&d=identicon&r=PG&f=1", "display_name": "Alistair Alva", "link": "https://stackoverflow.com/users/8762084/alistair-alva"}, "edited": false, "score": 0, "creation_date": 1557378827, "post_id": 56034051, "comment_id": 98746023, "body": "@AlistairAlva: if this answer helped you, you can accept it by clicking on the grey checkmark below its score."}], "tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 2, "last_activity_date": 1557321023, "last_edit_date": 1557321023, "creation_date": 1557293154, "answer_id": 56034051, "question_id": 56033522, "link": "https://stackoverflow.com/questions/56033522/how-should-i-fill-an-array-of-ints-from-a-file-using-command-line-args-the-size/56034051#56034051", "title": "How should I fill an array of ints from a file using command line args? The size of the file and the no. of elements may vary", "body": "<p>There are multiple problems in the code:</p>\n\n<ul>\n<li><code>&lt;fstream&gt;</code> is a C++ header, do not mix C and C++.</li>\n<li><code>printf(stderr, \"Error, too many arguments supplied.\");</code> should produce a warning about the type mismatch on its first argument. use <code>fprintf</code> to print to <code>stderr</code>.</li>\n<li>The file is open in text mode, not binary mode, so <code>ftell()</code> might not return the number of bytes in the file.</li>\n<li>file open failure is not tested.</li>\n<li>Allocating <code>fileSize * sizeof(int)</code> is overkill. The numbers are in text format, so at most <code>fileSize / 2</code> numbers can by found in the file, and likely much less than that.</li>\n<li>failure to allocate bytes does not mean the file is empty.</li>\n<li>You should reallocate the array as you read more numbers from the file. This allows also for reading from devices that are not seekable such as terminals and named pipes.</li>\n<li><code>arraySize = sizeof(numArray) / sizeof(numArray[0])</code> does not compute the number of elements in the array because <code>numArray</code> is a pointer to an array, not an array. Furthermore you should just keep the number of actual numbers read, which is the final value of <code>i</code> in the <code>for</code> loop.</li>\n<li>you should test the return value of <code>fscanf()</code>: 1 means the conversion succeeded, 0 means invalid input is present, that cannot be converted to an integer, <code>EOF</code> means end of file, or possibly I/O error.</li>\n</ul>\n\n<p>Here is a modified version:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;errno.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main(int argc, char *argv[]) {\n\n    if (argc != 2) {\n        fprintf(stderr, \"The program expects a single command line argument\\n\");\n        return 1;\n    } else {\n        int *numArray = NULL;\n        size_t arraySize = 0;\n        size_t arrayCount = 0;\n        FILE *inputFile = fopen(argv[1], \"r\");\n        int res, num;\n\n        if (inputFile == NULL) {\n            fprintf(stderr, \"Cannot open file %s: %s\\n\", strerror(errno));\n            return 1;\n        }\n        while ((res = fscanf(inputFile, \"%d\", &amp;num)) == 1) {\n            if (arrayCount &gt;= ArraySize) {\n                size_t newSize = arraySize ? arraySize * 2 : 32;\n                int *newArray = realloc(numArray, newSize * sizeof(int));\n                if (newArray == NULL) {\n                    fprintf(stderr, \"Out of memory for %zu elements\\n\", newSize);\n                    exit(1);\n                }\n                numArray = newArray;\n                arraySize = newSize;\n            }\n            numArray[arrayCount++] = num;\n        }\n        if (res != EOF) {\n            fprintf(stderr, \"Invalid input for element %zu\\n\", arrayCount);\n        }\n        if (arrayCount == 0) {\n            if (res == EOF) {\n                fprintf(stderr, \"File %s is empty\\n\", argv[1]);\n            }\n            fclose(inputFile);\n            return 1;\n        }\n        ...  // do something with the arrayCount elements in numArray\n        free(numArray);\n        fclose(inputFile);\n    }\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 8762084, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/baff9b1b16b65ca97581aeb2b176c3a4?s=128&d=identicon&r=PG&f=1", "display_name": "Alistair Alva", "link": "https://stackoverflow.com/users/8762084/alistair-alva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1557321023, "creation_date": 1557289456, "last_edit_date": 1557298095, "question_id": 56033522, "link": "https://stackoverflow.com/questions/56033522/how-should-i-fill-an-array-of-ints-from-a-file-using-command-line-args-the-size", "title": "How should I fill an array of ints from a file using command line args? The size of the file and the no. of elements may vary", "body": "<p>I am really new to programming in C. I have an assignment where I have to fill an array of integers from a text file using command line arguments. The array should be able to take in all the numbers from the file. \nThis is the segment of code that is supposed to do the above, but it fails. I still have to add error checking but I just need to know where I am going wrong, and if I am on the right path. </p>\n\n<p>From what I know so far, I will have to use memory allocation to make my array dynamic. I have used ftell() to find the size of the file in bytes so I can allocate memory accordingly.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\n#include &lt;stdbool.h&gt;\n#include &lt;fstream&gt;\n#include &lt;stdlib.h&gt;\n\nint main(int argc, char *argv[]) {\n\n    if (argc &gt; 2) {\n        printf(stderr, \"Error, too many arguments supplied.\");\n        exit(1);\n    }\n\n    if (argc == 2) {\n        int *numArray = NULL; //pointer to integer\n\n        FILE* inputFile = fopen(argv[1], \"r\");\n\n        fseek(inputFile, 0, SEEK_END);\n\n        // calculating the size of the file \n        int fileSize = ftell(inputFile);\n\n        numArray = malloc(fileSize * sizeof(int));\n\n        if (numArray == NULL) {\n            printf(stderr, \"Error: File is empty.\");\n            exit(1);\n        }\n\n        int num;\n        int arraySize = sizeof(numArray) / sizeof(numArray[0]);\n\n        for (int i = 0; i &lt; arraySize; i++) {\n            fscanf(inputFile, \"%d\", &amp;num);\n            numArray[i] = num;\n        }\n\n        fclose(inputFile);\n    }\n\n}\n</code></pre>\n\n<p>If file contains: 67, 66, 353, 789, 2342, \nNumArray = {67, 66, 353, 789, 2342}</p>\n"}, {"tags": ["c", "pointers", "malloc"], "comments": [{"owner": {"reputation": 4328, "user_id": 920069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd39f0db1f22e1314746491df063602a?s=128&d=identicon&r=PG", "display_name": "Retired Ninja", "link": "https://stackoverflow.com/users/920069/retired-ninja"}, "edited": false, "score": 1, "creation_date": 1557289959, "post_id": 56033366, "comment_id": 98709979, "body": "Consider expanding this into a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> and formatting it so it is readable."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1557291063, "post_id": 56033366, "comment_id": 98710242, "body": "<code>c</code> is a <i>pointer to pointer to <code>int</code></i>, <code>malloc</code> allocates storage for <code>b[1]</code> (e.g. <code>4</code>) pointers. See: <a href=\"http://stackoverflow.com/q/605845/995714\">Do I cast the result of malloc?</a>. <i>&quot;<code>c[0]</code> has the address of array <code>a</code>&#39;s second index&quot;</i> -- yes."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1557293992, "post_id": 56033366, "comment_id": 98711102, "body": "Could this be a homework assignment or exam question? I get the impression because of the typical non-commented, almost obfuscated, coding style, which is typically accompanied by a &quot;Describe the effect of this code.&quot; instruction. In that case please consider the compromise described here <a href=\"https://meta.stackoverflow.com/questions/334822/how-do-i-ask-and-answer-homework-questions\" title=\"how do i ask and answer homework questions\">meta.stackoverflow.com/questions/334822/&hellip;</a> Even if not, please let us know your level of knowledge, by explaining as much of the code yourself as possible. Then the gaps can be filled in by an answer more efficiently."}], "answers": [{"comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1557297117, "post_id": 56034528, "comment_id": 98712141, "body": "No UB. <code>d[1][0][0]</code> is 1st element in <code>b</code>, <code>d[0][1][0]</code> is next address after <code>6</code> in <code>a</code> (e.g. the address of <code>9</code>)."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1557297569, "post_id": 56034528, "comment_id": 98712321, "body": "@DavidC.Rankin: Yes, my mistake, such a waste of time and energy!"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1557297693, "post_id": 56034528, "comment_id": 98712380, "body": "It&#39;s good to dust off the cobwebs. You did a good thing. The only reason I caught was I stepped through it with a debugger <code>:)</code>. <code>b</code> is <code>{ 2, 4, 9, 8, 2 };</code> at the end due to <code>d[0][3][1] = d[1][0][0];</code> -- <code>:)</code> (ducking)  Here is what I did <a href=\"http://susepaste.org/84146148\" rel=\"nofollow noreferrer\">ptrfun.c</a> - expires 7 days."}], "tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": true, "score": 4, "last_activity_date": 1557298796, "last_edit_date": 1557298796, "creation_date": 1557295867, "answer_id": 56034528, "question_id": 56033366, "link": "https://stackoverflow.com/questions/56033366/i-am-confused-how-to-understand-this-code-contains-double-pointers/56034528#56034528", "title": "I am confused how to understand this code. contains double pointers", "body": "<p>The code contains actual statements, therefore it must be part of a function body, hence all declarations herein have automatic storage. It is highly convoluted, with purposely contrived double indirections... Lets analyse it one line at a time:</p>\n\n<ul>\n<li><p><code>int a[] = { 3, 6, 9 };</code> -- <code>a</code> is an array of 3 ints initialized with some explicit values.</p></li>\n<li><p><code>int b[] = { 2, 4, 6, 8, 10 };</code> -- likewise, <code>b</code> is an array of 3 ints initialized with some explicit values.</p></li>\n<li><p><code>int **c;</code> -- <code>c</code> is an uninitialized pointer to a pointer to <code>int</code>, that can be made to point to an array of pointers to <code>int</code>.</p></li>\n<li><p><code>int **d[2];</code> -- <code>d</code> is an uninitialized array of 2 pointers to pointers to <code>int</code>, each of which can be made to point to an array of pointers to <code>int</code>.</p></li>\n<li><p><code>c = (int **)malloc(b[1] * sizeof(int *));</code> -- <code>c</code> is set to point to a block of uninitialized memory with a size of <code>4</code> pointers to <code>int</code>. In short, <code>c</code> now points to an uninitialized array of <code>4</code> pointers to <code>int</code>.</p></li>\n<li><p><code>*c = &amp;a[1];</code> -- The element pointed to by <code>c</code> (aka <code>A[0]</code>) is set to point to the second element of <code>a</code> (aka <code>a[1]</code>, with a value of <code>6</code>). The value of <code>A[0]</code> is <code>&amp;a[1]</code>.</p></li>\n<li><p><code>c[1] = c[0] + 1;</code> -- The second element in the array pointed to by <code>c</code> (aka <code>A[1]</code>) is set to point to the element after the one pointed to by <code>c[0]</code>, hence it points to the third element of <code>a</code> (aka <code>a[2]</code> with a value of <code>9</code>). The value of <code>A[1] is</code>&amp;a[2]`.</p></li>\n<li><p><code>*d = c;</code> -- The first element of <code>d</code> is set to the value of pointer <code>c</code>, which is the address of <code>A[0]</code>. The value of <code>d[0]</code> is <code>&amp;A[0]</code>.</p></li>\n<li><p><code>c = c + 2;</code> -- The pointer <code>c</code> is incremented by <code>2</code>, it now points to the third element of the array <code>A</code> allocated with <code>malloc()</code>, <code>A[2]</code>.</p></li>\n<li><p><code>*c = b;</code> -- The element pointed to by <code>c</code>, <code>A[2]</code>, which is itself a pointer, is set to point to the first element of <code>b</code>, <code>b[0]</code>. The value of <code>A[2]</code> is <code>&amp;b[0]</code>.</p></li>\n<li><p><code>c[1] = &amp;c[0][3];</code> -- The element after that, A[3], the 4th element of the array allocated by <code>malloc</code>, is set to point to the 4th element of the array pointed to by the element <code>c</code> points to. <code>&amp;c[0][3]</code> is equivalent to <code>c[0] + 3</code> or <code>&amp;(*c)[3]</code> or simply <code>*c + 3</code>. This element is <code>b[3]</code> which has the value <code>8</code>. The value of <code>A[3] is</code>&amp;b[3]`.</p></li>\n<li><p><code>*(d + 1) = c;</code> -- This is equivalent to <code>d[1] = c;</code> which sets the second element of <code>d</code> to the value of the pointer <code>c</code>, which is the address of the 3rd element of the array allocated wth <code>malloc()</code>, <code>A[2]</code>, which points to <code>b[0]</code>. The value of <code>d[1]</code> is <code>&amp;A[2]</code>.</p></li>\n<li><p><code>d[0][3][1] = d[1][0][0];</code> -- Let's rewrite these terms:</p>\n\n<ul>\n<li><p><code>d[0][3][1]</code> => (&amp;A[0])[3][1] => <code>A[3][1]</code> => <code>(&amp;b[3])[1]</code> => <code>*((b + 3) + 1)</code> => <code>b[4]</code></p></li>\n<li><p><code>d[1][0][0]</code> => <code>(&amp;A[2])[0][0]</code> => <code>(*&amp;A[2])[0]</code> => <code>A[2][0]</code> => <code>(&amp;b[0])[0]</code> => <code>b[0]</code> which is the value <code>2</code>.</p></li>\n<li><p>Hence <code>b[4] = 2;</code>.</p></li>\n</ul></li>\n<li><p><code>d[1][0][2] = d[0][1][0];</code> -- Let's rewrite these:</p>\n\n<ul>\n<li><code>d[1][0][2]</code> => <code>(&amp;A[2])[0][2]</code> => <code>(*&amp;A[2])[2]</code> => <code>A[2][2]</code> => <code>(&amp;b[0])[2]</code> => <code>(b + 0)[2]</code> => <code>b[2]</code>.</li>\n<li><code>d[0][1][0]</code> => <code>(&amp;A[0])[1][0]</code>, ie <code>A[1][0]</code> => <code>(&amp;a[2])[0]</code> => <code>*&amp;a[2]</code> => <code>a[2]</code> that has a value of <code>9</code>.</li>\n<li>Hence <code>b[2] = 9;</code></li>\n</ul></li>\n</ul>\n\n<p>As a consequence, the array <code>b</code> now has elements <code>{ 2, 4, 9, 8, 2 }</code>.</p>\n\n<p>You can run the program:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main() {\n    int a[] = { 3, 6, 9 };\n    int b[] = { 2, 4, 6, 8, 10 };\n    int **c;\n    int **d[2];\n    c = (int **)malloc (b[1] * sizeof(int *));\n    *c = &amp;a[1];\n    c[1] = c[0] + 1;\n    *d = c;\n    c = c + 2;\n    *c = b;\n    c[1] = &amp;c[0][3];\n    *(d + 1) = c;\n    d[0][3][1] = d[1][0][0];\n    d[1][0][2] = d[0][1][0];\n\n    printf(\"a = { \");\n    for (size_t i = 0; i &lt; sizeof a / sizeof *a; i++)\n        printf(\"%d, \", a[i]);\n    printf(\"};\\n\");\n\n    printf(\"b = { \");\n    for (size_t i = 0; i &lt; sizeof b / sizeof *b; i++)\n        printf(\"%d, \", b[i]);\n    printf(\"};\\n\");\n\n    return 0;\n}\n\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 9593333, "user_type": "registered", "profile_image": "https://graph.facebook.com/2317267438500058/picture?type=large", "display_name": "Muhammad Saqib Nawaz", "link": "https://stackoverflow.com/users/9593333/muhammad-saqib-nawaz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 56034528, "answer_count": 1, "score": 0, "last_activity_date": 1557343578, "creation_date": 1557288225, "last_edit_date": 1557306311, "question_id": 56033366, "link": "https://stackoverflow.com/questions/56033366/i-am-confused-how-to-understand-this-code-contains-double-pointers", "title": "I am confused how to understand this code. contains double pointers", "body": "<p>I don't understand why the code below changes the array <code>b</code>:</p>\n\n<pre><code>int a[] = { 3, 6, 9 };\nint b[] = { 2, 4, 6, 8, 10 };\nint **c;\nint **d[2];\nc = (int **)malloc (b[1] * sizeof(int *));\n*c = &amp;a[1];\nc[1] = c[0] + 1;\n*d = c;\nc = c + 2;\n*c = b;\nc[1] = &amp;c[0][3];\n*(d + 1) = c;\nd[0][3][1] = d[1][0][0];\nd[1][0][2] = d[0][1][0];\n</code></pre>\n\n<p>I have run this code and found the values of array <code>a</code> and array <code>b</code> but I am unable to understand how these values come.</p>\n\n<p>Array <code>a</code> remains unchanged while <code>b</code> becomes <code>2, 4, 9, 8, 2</code>. How does this happen?  </p>\n\n<pre><code>c = (int**)malloc(b[1] * sizeof(int*));  //int **c[4] ???\n</code></pre>\n\n<p><code>c</code> is an array of double pointers <code>*c = &amp;a[1]</code> this means that <code>c[0]</code> has the address of array a's second index. I am not getting the way to interpret this.</p>\n"}, {"tags": ["c", "file", "byte"], "comments": [{"owner": {"reputation": 86085, "user_id": 128940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d35101b4060dc3af0d5c1b7c42c4935?s=128&d=identicon&r=PG&f=1", "display_name": "Beta", "link": "https://stackoverflow.com/users/128940/beta"}, "edited": false, "score": 1, "creation_date": 1557287338, "post_id": 56033225, "comment_id": 98709414, "body": "Welcome to Stack Overflow. You neglected to allocate memory to read the byte into. I recommend <code>name = (char*)malloc(1);</code>."}, {"owner": {"reputation": 1337, "user_id": 903766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94253e3b2045fbf75c05e81a92035e37?s=128&d=identicon&r=PG", "display_name": "ctt", "link": "https://stackoverflow.com/users/903766/ctt"}, "reply_to_user": {"reputation": 86085, "user_id": 128940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d35101b4060dc3af0d5c1b7c42c4935?s=128&d=identicon&r=PG&f=1", "display_name": "Beta", "link": "https://stackoverflow.com/users/128940/beta"}, "edited": false, "score": 0, "creation_date": 1557287423, "post_id": 56033225, "comment_id": 98709431, "body": "@Beta that would make a splendid answer."}, {"owner": {"reputation": 3, "user_id": 11467836, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Qf8q-fEn5Do/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf1-3atl9kMht96XQxu5xt8Q-RyQA/mo/photo.jpg?sz=128", "display_name": "lagoon__themoon", "link": "https://stackoverflow.com/users/11467836/lagoon-themoon"}, "edited": false, "score": 0, "creation_date": 1557288412, "post_id": 56033225, "comment_id": 98709638, "body": "oh man. thanks for that. I thought there was something wrong with my use of strtol, I&#39;ve never actually used it before. Although the segmentation fault is gone now, when i try to print c, it seems to be empty. Any ideas on why that is?"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11467836, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Qf8q-fEn5Do/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf1-3atl9kMht96XQxu5xt8Q-RyQA/mo/photo.jpg?sz=128", "display_name": "lagoon__themoon", "link": "https://stackoverflow.com/users/11467836/lagoon-themoon"}, "edited": false, "score": 0, "creation_date": 1557289918, "post_id": 56033517, "comment_id": 98709969, "body": "Thanks. I was under the impression I had to use strtol to convert the contents of name to a string using strtol. I didn&#39;t know I could simply read it as a character. Thanks for that!"}], "tags": [], "owner": {"reputation": 86085, "user_id": 128940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d35101b4060dc3af0d5c1b7c42c4935?s=128&d=identicon&r=PG&f=1", "display_name": "Beta", "link": "https://stackoverflow.com/users/128940/beta"}, "is_accepted": true, "score": 2, "last_activity_date": 1557289429, "creation_date": 1557289429, "answer_id": 56033517, "question_id": 56033225, "link": "https://stackoverflow.com/questions/56033225/trying-to-read-bytes-using-fread-but-getting-segmentation-fault-11/56033517#56033517", "title": "Trying to read bytes using fread but getting Segmentation Fault 11", "body": "<p>First, you neglected to allocate memory to read the byte into. I recommend:</p>\n\n<pre><code>name = (char*)malloc(1);\n</code></pre>\n\n<p>Second, your use of <code>strtol</code> makes no sense. You have a byte containing 'n'. Thi is <em>not</em> a null-terminated string, so I think that calling <code>strtol</code> on it will cause Undefined Behavior. But in any case 'n' is not a numeral, so <code>strtol</code> will return 0. You then cast the <code>long int</code> 0 to a <code>char</code>. Without looking it up, I don't know what character (if any) corresponds to the <code>long int</code> value 0, but it sure ain't 'n'. Do it this way:</p>\n\n<pre><code>printf(\"c: %c\\n\", *name);\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11467836, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Qf8q-fEn5Do/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf1-3atl9kMht96XQxu5xt8Q-RyQA/mo/photo.jpg?sz=128", "display_name": "lagoon__themoon", "link": "https://stackoverflow.com/users/11467836/lagoon-themoon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 56033517, "answer_count": 1, "score": 0, "last_activity_date": 1557289429, "creation_date": 1557286954, "question_id": 56033225, "link": "https://stackoverflow.com/questions/56033225/trying-to-read-bytes-using-fread-but-getting-segmentation-fault-11", "title": "Trying to read bytes using fread but getting Segmentation Fault 11", "body": "<p>Im writing a string as bytes to a file and then want to read the binary code back as a string using strtol. I checked the the binary file and it contained the binary of the letter i included using xxd -b filename. However when i try to read it back and convert it to a string it gives a segmentation fault 11. Not sure what I'm doing wrong.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main() {\n\n    FILE* fr = fopen(\"kot.bin\", \"wb+\");\n    size_t written = fwrite(\"n\", 1, 1, fr);\n    printf(\"written is: %zu\\n\", written);\n    fclose(fr);\n\n    FILE* fw = fopen(\"kot.bin\", \"rb\");\n    char * name;\n    size_t red = 0;\n    red = fread(name, 1, 1, fw);\n    if (red==0) {\n        printf(\"ur wrong\\n\");\n    }\n    printf(\"red: %zu\\n\", red);\n    char c = (char) strtol(name, NULL, 2);\n    printf(\"c: %c\\n\", c);\n\n    return 0;\n}\n</code></pre>\n\n<p>I simply want to store one byte in buffer, use strtol to make it into a a character and print it.</p>\n"}, {"tags": ["c", "function"], "comments": [{"owner": {"reputation": 26680, "user_id": 1806780, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/NCB41.jpg?s=128&g=1", "display_name": "Sami Kuhmonen", "link": "https://stackoverflow.com/users/1806780/sami-kuhmonen"}, "edited": false, "score": 5, "creation_date": 1557286008, "post_id": 56032802, "comment_id": 98709180, "body": "You need to assign the return value to the variable. Now you\u2019re changing it and returning it from the function but the return value is not used anywhere."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1557291058, "post_id": 56032802, "comment_id": 98710240, "body": "Please consider to expand your code to a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. Also in <code>makeChange</code> you return <code>total</code> which is a <code>double</code>, but the return type of <code>makeChange</code> is <code>int</code>."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1557327081, "post_id": 56032802, "comment_id": 98728999, "body": "Please show both versions, each as an MCVE, the working one before and the failing one after using functions."}], "owner": {"reputation": 25, "user_id": 10982416, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-okTV88ph-So/AAAAAAAAAAI/AAAAAAAAARQ/0034dnvDpR4/photo.jpg?sz=128", "display_name": "Hass", "link": "https://stackoverflow.com/users/10982416/hass"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1557283241, "creation_date": 1557283241, "question_id": 56032802, "link": "https://stackoverflow.com/questions/56032802/how-would-i-keep-totalcalc-from-resetting", "title": "How would I keep totalCalc from resetting?", "body": "<p>I am making a program to calculate the most efficient amount of change to give when the user inputs a certain dollar value.</p>\n\n<p>The program worked before I tried to make it into functions, and when I tried to make my program more robust by using functions, the program isn't working as desired.</p>\n\n<pre><code>double getValueofCoins(int totalCalc, int coinValue, char* coinName) {\n\n    double coinType;\n\n    coinType = totalCalc / coinValue;\n    totalCalc = totalCalc % coinValue; \n    printf(\"\\n%s: %.0lf\", coinName, coinType);\n\n    return totalCalc;\n\n}\n\n\n\nint makeChange(int totalCalc) {\n\n    double total;\n\n    // calculate the most efficient amount of change\n\n    getValueofCoins(totalCalc, 200, \"Toonies\");\n    getValueofCoins(totalCalc, 100, \"Loonies\");\n    getValueofCoins(totalCalc, 25, \"Quarters\");\n    getValueofCoins(totalCalc, 10, \"Dimes\");\n    getValueofCoins(totalCalc, 5, \"Nickels\");\n    getValueofCoins(totalCalc, 1, \"Pennies\");\n\n    return total;    \n}\n</code></pre>\n\n<p>What I want the code to do is give the most efficient amount of change (eg: if the user enters $20, it would say 10 toonies), but what it does is print the amount of each type of coin that would make up the value (eg: if the user enters $20, it would say 10 toonies, 20 loonies, 80 quarters, etc.)</p>\n\n<p>I think this is because the totalCalc variable is resetting to what the user inputted originally every time I call getValueofCoins(). How would I fix this?</p>\n"}, {"tags": ["c", "printf", "restrict-qualifier"], "answers": [{"comments": [{"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1557286908, "post_id": 56032913, "comment_id": 98709354, "body": "Maybe post this answer on the duplicate, which only has wrong answers right now..."}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "reply_to_user": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1557287545, "post_id": 56032913, "comment_id": 98709453, "body": "@R.. Huh, must have posted this at the same time it was closed. I&#39;ll think about it."}], "tags": [], "owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "is_accepted": false, "score": 1, "last_activity_date": 1557284267, "creation_date": 1557284267, "answer_id": 56032913, "question_id": 56032767, "link": "https://stackoverflow.com/questions/56032767/why-does-the-prototype-of-printf-have-restrict/56032913#56032913", "title": "Why does the prototype of `printf` have `restrict`?", "body": "<p>Basically, the format string shouldn't overlap with any of its arguments or the results are undefined. The <code>restrict</code> makes that clear beyond just mentioning it the documentation.</p>\n\n<p>As for why...</p>\n\n<p>In the case of <code>snprintf()</code> and <code>sprintf()</code> it should be obvious why the format shouldn't overlap with especially the destination buffer, but it's a bit murkier for the variations that output to a file.</p>\n\n<p>I <em>suspect</em> it's because of the <code>%hhn</code> specifier, which sets its argument, a <code>signed char *</code>, to the number of characters written so far. If you pass a pointer to an element of the format string, this would modify the string and thus possibly introduce undefined behavior - what if the number corresponds to the value of the character <code>'%'</code>?</p>\n"}], "owner": {"reputation": 467, "user_id": 4019495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KYh5a.png?s=128&g=1", "display_name": "extremeaxe5", "link": "https://stackoverflow.com/users/4019495/extremeaxe5"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "closed_date": 1557284258, "answer_count": 1, "score": 4, "last_activity_date": 1557284267, "creation_date": 1557282958, "question_id": 56032767, "link": "https://stackoverflow.com/questions/56032767/why-does-the-prototype-of-printf-have-restrict", "closed_reason": "Duplicate", "title": "Why does the prototype of `printf` have `restrict`?", "body": "<p>The prototype of <code>printf</code>, according to my <code>stdio.h</code>, is </p>\n\n<pre><code>extern int printf (const char *__restrict __format, ...);\n</code></pre>\n\n<p>On the page explaining <a href=\"https://en.wikipedia.org/wiki/Restrict\" rel=\"nofollow noreferrer\">Restrict</a>, it says that it is a keyword used to indicate that pointers are unique. However, I don't understand why one would need that for <code>printf</code>. </p>\n\n<p><strong>Why does <code>printf</code> have a \"restrict\" keyword?</strong></p>\n\n<p>If it's necessary to explain further what \"restrict\" means, please do. </p>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 66964, "user_id": 73297, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/GhFGC.jpg?s=128&g=1", "display_name": "Ben Zotto", "link": "https://stackoverflow.com/users/73297/ben-zotto"}, "edited": false, "score": 0, "creation_date": 1557283090, "post_id": 56032765, "comment_id": 98708604, "body": "Not sure what you mean by &quot;stopped working&quot;-- you should include more explicit inputs and outputs and errors/etc."}, {"owner": {"reputation": 66964, "user_id": 73297, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/GhFGC.jpg?s=128&g=1", "display_name": "Ben Zotto", "link": "https://stackoverflow.com/users/73297/ben-zotto"}, "edited": false, "score": 5, "creation_date": 1557283142, "post_id": 56032765, "comment_id": 98708624, "body": "Worth noting here that your destination string (<code>ms</code>) is a pointer to apparently unallocated memory, so you&#39;re copying bytes into.. somewhere. (Which isn&#39;t what you want to be doing.)"}, {"owner": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "edited": false, "score": 5, "creation_date": 1557283180, "post_id": 56032765, "comment_id": 98708633, "body": "You didn&#39;t allocate any memory for <code>ms</code> and it is uninitialized. So this is undefined behavior."}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 2, "creation_date": 1557285511, "post_id": 56032765, "comment_id": 98709057, "body": "After you fix that problem, consider this version: <code>void strcpys(char *dest, char *src) { while (*dest++ = *src++){} }</code>. It&#39;s one of the classic examples of how concise C can be, for better or worse."}, {"owner": {"reputation": 22777, "user_id": 133203, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Fp3hB.jpg?s=128&g=1", "display_name": "Federico klez Culloca", "link": "https://stackoverflow.com/users/133203/federico-klez-culloca"}, "reply_to_user": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1558362131, "post_id": 56032765, "comment_id": 99066358, "body": "@Shawn even more concise <code>void strcpys(char *dest, char *src) { while (*dest++ = *src++); }</code> one byte shorter :)"}], "answers": [{"comments": [{"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1557328745, "post_id": 56038730, "comment_id": 98730023, "body": "@bruno: this explicit <code>continue;</code> statement is my style. I <b>definitely</b> do <b>not</b> want to use an empty statement as in <code>while ((*p++ = *src++) != &#39;\\0&#39;);</code> and I don&#39;t particularly like the empty block <code>{}</code> either, especially with the K&amp;R bracing style. The explicit <code>continue;</code> tells the reader unambiguously that the body is purposely empty. Of course all three generate the same code."}, {"owner": {"reputation": 16020, "user_id": 9716597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f97c613dca0b157b40551a0d756abeb?s=128&d=identicon&r=PG&f=1", "display_name": "L. F.", "link": "https://stackoverflow.com/users/9716597/l-f"}, "edited": false, "score": 0, "creation_date": 1558228538, "post_id": 56038730, "comment_id": 99030229, "body": "You can simplify further into <code>for (char* p = dest; *p++ = *src++;); return dest;</code>."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 16020, "user_id": 9716597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f97c613dca0b157b40551a0d756abeb?s=128&d=identicon&r=PG&f=1", "display_name": "L. F.", "link": "https://stackoverflow.com/users/9716597/l-f"}, "edited": false, "score": 0, "creation_date": 1558309835, "post_id": 56038730, "comment_id": 99046902, "body": "@L.F.: indeed, even more characters can be removed from the source code: <code>char*strcpys(char*a,const char*b){for(char*c=a;*c++=*b++;);return a;}</code> generates the same code, but is much less readable :)"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1558313752, "post_id": 56038730, "comment_id": 99047426, "body": "With the caveat that the strings cannot overlap, otherwise you would need to get the length and copy from the end to the beginning (as with <code>memmove</code>)."}], "tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": true, "score": 3, "last_activity_date": 1558361622, "last_edit_date": 1558361622, "creation_date": 1557311694, "answer_id": 56038730, "question_id": 56032765, "link": "https://stackoverflow.com/questions/56032765/trying-to-recreate-the-strcpy-function-using-pointers/56038730#56038730", "title": "Trying to recreate the strcpy function using pointers", "body": "<p>Your <code>strcpys</code> function is OK, but the <code>main</code> function a problem:</p>\n\n<ul>\n<li>the destination argument passed to <code>strcpys</code> is an uninitialized pointer. This has undefined behavior, quite likely a segmentation fault. You should instead pass a pinter to a <code>char</code> large enough to hold all characters from the source plus a null byte terminator.</li>\n</ul>\n\n<p>Here are some possible improvements too:</p>\n\n<ul>\n<li><code>strcpys</code> should return the destination pointer</li>\n<li>the source pointer should be declared as <code>const char *</code></li>\n<li>the argument names should be less confusing</li>\n</ul>\n\n<p>Here is a corrected version:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdio.h&gt;\n\nchar *strcpys(char *dest, const char *src);\n\nint main() {\n    char ms[32];\n    const char *mt = \"ABCDEFGAAA,AAAAA\";\n    strcpys(ms, mt);\n    printf(\"%s\\n\", ms);\n    printf(\"%s\\n\", mt);\n    return 0;\n}\n\nchar *strcpys(char *dest, const char *src) {\n    char *p = dest;\n    while ((*p = *src) != '\\0') {\n        p++;\n        src++;\n    }\n    return dest;\n}\n</code></pre>\n\n<p>Note that you can combine the increments into the assignment:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>char *strcpys(char *dest, const char *src) {\n    char *p = dest;\n    while ((*p++ = *src++) != '\\0')\n        continue;\n    return dest;\n}\n</code></pre>\n\n<p>Note that both versions have undefined behavior if the destination pointer points inside the source string. The functions behave as expected if the destination array and source do not overlap or if the destination is at a lower address than the source string. The standard <code>strcpy</code> function has undefined behavior if the source and destination arrays overlap.</p>\n"}], "owner": {"reputation": 23, "user_id": 11467655, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ebd161254ee721844b40559918d4bcd?s=128&d=identicon&r=PG&f=1", "display_name": "Joe_Z37", "link": "https://stackoverflow.com/users/11467655/joe-z37"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 285, "favorite_count": 0, "accepted_answer_id": 56038730, "answer_count": 1, "score": 1, "last_activity_date": 1558361622, "creation_date": 1557282946, "last_edit_date": 1557330161, "question_id": 56032765, "link": "https://stackoverflow.com/questions/56032765/trying-to-recreate-the-strcpy-function-using-pointers", "title": "Trying to recreate the strcpy function using pointers", "body": "<p>I am trying to learn pointer by recreating the <code>strcpy</code> function in C. It stopped working whenever I have space, tab in my input string (anything other than an English character).</p>\n\n<p>Could anyone explain to be why?\nAll answers are appreciated</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid strcpys(char *s, char *t);\nint main() {\n    char *ms;\n    char *mt;\n\n    mt = \"ABCDEFGAAA,AAAAA\";\n    strcpys(ms, mt);\n    printf(\"%s\\n\", ms);\n    printf(\"%s\\n\", mt);\n    return 0;\n}\n\nvoid strcpys(char *s, char *t) {\n    while ((*s = *t) != '\\0') {\n        s++;\n        t++;\n    }\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 4260, "user_id": 1706864, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/87rp9.jpg?s=128&g=1", "display_name": "Anup Buchke", "link": "https://stackoverflow.com/users/1706864/anup-buchke"}, "reply_to_user": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 0, "creation_date": 1557282523, "post_id": 56032699, "comment_id": 98708489, "body": "Can you please elaborate more? does this violate any C standard?"}, {"owner": {"reputation": 200780, "user_id": 116908, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/54d38793d7a407446999b33b81d607fd?s=128&d=identicon&r=PG", "display_name": "Carl Norum", "link": "https://stackoverflow.com/users/116908/carl-norum"}, "edited": false, "score": 6, "creation_date": 1557282599, "post_id": 56032699, "comment_id": 98708507, "body": "Comparing pointers that are not pointing to elements of the same array (or one past the end of it) is undefined. Check your output assembly code for what&#39;s going on specifically in your case."}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1557282599, "post_id": 56032699, "comment_id": 98708508, "body": "<i>undefined behavior</i> means <i>behavior that is not defined</i>, which means there is no standard for what will happen. In addition, you&#39;re using two uninitialized variables (<code>int i, j</code>)."}, {"owner": {"reputation": 4260, "user_id": 1706864, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/87rp9.jpg?s=128&g=1", "display_name": "Anup Buchke", "link": "https://stackoverflow.com/users/1706864/anup-buchke"}, "edited": false, "score": 0, "creation_date": 1557282867, "post_id": 56032699, "comment_id": 98708563, "body": "this doesn&#39;t work with initialized variables as well. But works when I make a and b as normal variables. Is this strict aliasing issue?"}, {"owner": {"reputation": 15105, "user_id": 3768871, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/Wxgi0.jpg?s=128&g=1", "display_name": "OmG", "link": "https://stackoverflow.com/users/3768871/omg"}, "edited": false, "score": 0, "creation_date": 1557282978, "post_id": 56032699, "comment_id": 98708587, "body": "The last version of the code works for me!"}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1557282987, "post_id": 56032699, "comment_id": 98708589, "body": "It doesn&#39;t matter if <code>i</code> and <code>j</code> are initialized or not. It is guaranteed that they exist because their addresses are taken."}, {"owner": {"reputation": 15105, "user_id": 3768871, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/Wxgi0.jpg?s=128&g=1", "display_name": "OmG", "link": "https://stackoverflow.com/users/3768871/omg"}, "edited": false, "score": 0, "creation_date": 1557283073, "post_id": 56032699, "comment_id": 98708602, "body": "The result is <code>140725649638612  140725649638612 yo</code>."}, {"owner": {"reputation": 4260, "user_id": 1706864, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/87rp9.jpg?s=128&g=1", "display_name": "Anup Buchke", "link": "https://stackoverflow.com/users/1706864/anup-buchke"}, "edited": false, "score": 1, "creation_date": 1557283115, "post_id": 56032699, "comment_id": 98708613, "body": "I think compiler is doing a compile time optimization and removing this piece of code."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 1, "creation_date": 1557285988, "post_id": 56032699, "comment_id": 98709175, "body": "@tkausl No it isn&#39;t.  Any valid pointers (which includes one-past-the-end) may be equality-compared. That is true in both C and C++. There is no rule that they should point to the same object (Carl Norum is confusing the rules for relational comparison with the rules for equality comparison)"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1557286420, "post_id": 56032699, "comment_id": 98709267, "body": "In my opinion, gcc is behaving inconsistently, and is violating the standard. The gcc maintainers disagree. Follow the link to the duplicate question, and from there to the two GCC Bugzilla tickets. <a href=\"https://gcc.gnu.org/bugzilla/show_bug.cgi?id=63611\" rel=\"nofollow noreferrer\">gcc.gnu.org/bugzilla/show_bug.cgi?id=63611</a> <a href=\"https://gcc.gnu.org/bugzilla/show_bug.cgi?id=61502\" rel=\"nofollow noreferrer\">gcc.gnu.org/bugzilla/show_bug.cgi?id=61502</a>"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 0, "creation_date": 1557287424, "post_id": 56032699, "comment_id": 98709432, "body": "@tkausl There&#39;s no such rule. In C++ you can also compare arbitrary pointers for equality, but the result is unspecified for the case in this question"}], "answers": [{"comments": [{"owner": {"reputation": 4260, "user_id": 1706864, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/87rp9.jpg?s=128&g=1", "display_name": "Anup Buchke", "link": "https://stackoverflow.com/users/1706864/anup-buchke"}, "edited": false, "score": 0, "creation_date": 1557284210, "post_id": 56032809, "comment_id": 98708817, "body": "<a href=\"https://godbolt.org/z/HcQjI-\" rel=\"nofollow noreferrer\">godbolt.org/z/HcQjI-</a>"}, {"owner": {"reputation": 4260, "user_id": 1706864, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/87rp9.jpg?s=128&g=1", "display_name": "Anup Buchke", "link": "https://stackoverflow.com/users/1706864/anup-buchke"}, "edited": false, "score": 0, "creation_date": 1557284264, "post_id": 56032809, "comment_id": 98708826, "body": "Same code as your without -O3 flag. It compiles in the &quot;yo&quot; printf. So GCC optimizations implement this?"}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "reply_to_user": {"reputation": 4260, "user_id": 1706864, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/87rp9.jpg?s=128&g=1", "display_name": "Anup Buchke", "link": "https://stackoverflow.com/users/1706864/anup-buchke"}, "edited": false, "score": 0, "creation_date": 1557288680, "post_id": 56032809, "comment_id": 98709691, "body": "@AnupBuchke Please have a look at the duplicate of this question."}], "tags": [], "owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "is_accepted": true, "score": 4, "last_activity_date": 1557287311, "last_edit_date": 1557287311, "creation_date": 1557283303, "answer_id": 56032809, "question_id": 56032699, "link": "https://stackoverflow.com/questions/56032699/whats-happening-here-pointer-math-messing-up/56032809#56032809", "title": "What&#39;s happening here? Pointer math messing up?", "body": "<p><a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1548.pdf\" rel=\"nofollow noreferrer\">ISO/IEC 9899:201x</a></p>\n\n<p>\u00a76.5.6 Equality operators:</p>\n\n<blockquote>\n  <ol start=\"7\">\n  <li><strong>Two pointers compare equal if and only if</strong> both are null pointers, <strong>both are pointers to the same object</strong> (including a pointer to an object and a subobject at its beginning) or function, both are pointers to one past the last element of the same array object, <strong>or one is a pointer to one past the end of one array object and the other is a pointer to the start of a different array object that happens to immediately follow the first array object in the address space</strong>.</li>\n  </ol>\n</blockquote>\n\n<p>but then again:</p>\n\n<blockquote>\n  <ol start=\"8\">\n  <li>For the purposes of these operators, a pointer to an object that is not an element of an array behaves the same as a pointer to the first element of an array of length one with the type of the object as its element type.</li>\n  </ol>\n</blockquote>\n\n<p>So ... <code>a</code> and <code>b</code> should behave the same as a pointer to an array and <code>i</code> and <code>j</code> happen to be next to each other in memory ... then <code>&amp;i + 1</code> <em>could</em> point to the beginning of the first \"array element\" of <code>j</code> (<code>b</code>). Well, that's a big if. I wouldn't rely on that. Maybe in packed structs.</p>\n\n<p><br /></p>\n\n<p><a href=\"https://stackoverflow.com/users/3768871/omg\">@OmG</a></p>\n\n<blockquote>\n  <p>The last version of the code works for me! [with initialized <code>i</code> and <code>j</code>]</p>\n</blockquote>\n\n<p>gcc 9.1 -O3, 2 x <code>printf()</code> then <code>ret</code>.</p>\n\n<pre><code>        sub     rsp, 24\n        mov     edi, OFFSET FLAT:.LC0\n        xor     eax, eax\n        lea     rsi, [rsp+12]\n        mov     DWORD PTR [rsp+8], 0\n        mov     DWORD PTR [rsp+12], 0\n        call    printf                       ; &lt;----------\n        lea     rsi, [rsp+12]\n        mov     edi, OFFSET FLAT:.LC0\n        xor     eax, eax\n        call    printf                       ; &lt;----------\n        xor     eax, eax\n        add     rsp, 24\n        ret                                  ; &lt;----------\n</code></pre>\n\n<p><a href=\"https://godbolt.org/z/voIQKh\" rel=\"nofollow noreferrer\">godbolt Compiler Explorer, gcc 9.1</a></p>\n"}], "owner": {"reputation": 4260, "user_id": 1706864, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/87rp9.jpg?s=128&g=1", "display_name": "Anup Buchke", "link": "https://stackoverflow.com/users/1706864/anup-buchke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 2, "closed_date": 1557286006, "accepted_answer_id": 56032809, "answer_count": 1, "score": 3, "last_activity_date": 1557287311, "creation_date": 1557282248, "last_edit_date": 1557282799, "question_id": 56032699, "link": "https://stackoverflow.com/questions/56032699/whats-happening-here-pointer-math-messing-up", "closed_reason": "Duplicate", "title": "What&#39;s happening here? Pointer math messing up?", "body": "<pre><code>    int i = 0, j = 0;\n\nint *a , *b;\n\na = &amp;i + 1;\nb = &amp;j;\n\nprintf(\" %p \\n \",a);\nprintf(\" %p \\n \",b);\n\nif(a==b)\nprintf(\" yo \\n\");\n</code></pre>\n\n<p>Output:</p>\n\n<p>0x7ffda8e133a4</p>\n\n<p>0x7ffda8e133a4 </p>\n\n<p>a is same as b, still printf does not execute.</p>\n\n<p><a href=\"https://ideone.com/cnl2BG\" rel=\"nofollow noreferrer\">ideone link to this code</a></p>\n\n<p>This works well, when I make a and b as normal variables. (int a, b;)</p>\n"}, {"tags": ["c", "thread-safety", "locking", "pthreads"], "comments": [{"owner": {"reputation": 19267, "user_id": 801894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67f2ccd17aa6fd622152ad88fc2ae784?s=128&d=identicon&r=PG", "display_name": "Solomon Slow", "link": "https://stackoverflow.com/users/801894/solomon-slow"}, "edited": false, "score": 1, "creation_date": 1557322840, "post_id": 56039611, "comment_id": 98726275, "body": "Re, &quot;I cannot use <code>sleep()</code>...because I need the frequency to be constant.&quot; Sure you can use <code>sleep()</code> (or, more likely, <a href=\"http://man7.org/linux/man-pages/man2/nanosleep.2.html\" rel=\"nofollow noreferrer\"><code>nanosleep()</code></a>). The trick is, don&#39;t just <i>blindly</i> sleep. <a href=\"http://man7.org/linux/man-pages/man3/clock_gettime.3.html\" rel=\"nofollow noreferrer\">Look at the clock</a>, compute how much time until the next time your thread is due to wake up, and then sleep for that amount of time."}, {"owner": {"reputation": 431, "user_id": 4160025, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f790d69a7eea176600e2a8666f49c10a?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/4160025/david"}, "reply_to_user": {"reputation": 19267, "user_id": 801894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67f2ccd17aa6fd622152ad88fc2ae784?s=128&d=identicon&r=PG", "display_name": "Solomon Slow", "link": "https://stackoverflow.com/users/801894/solomon-slow"}, "edited": false, "score": 0, "creation_date": 1557329748, "post_id": 56039611, "comment_id": 98730610, "body": "@SolomonSlow, wouldn&#39;t this be a problem if I need to change the way <code>main</code> processes data? Each time I change the data processing I would need to recompute how long this takes."}, {"owner": {"reputation": 19267, "user_id": 801894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67f2ccd17aa6fd622152ad88fc2ae784?s=128&d=identicon&r=PG", "display_name": "Solomon Slow", "link": "https://stackoverflow.com/users/801894/solomon-slow"}, "edited": false, "score": 0, "creation_date": 1557330408, "post_id": 56039611, "comment_id": 98730962, "body": "Not &quot;each time [you] change the data processing,&quot; but <i>every time around the main loop</i>. At the bottom of the main loop, you look at what time it is now, you look at what time you need to perform the next iteration, you take the difference, and then you sleep for that many nanos."}, {"owner": {"reputation": 431, "user_id": 4160025, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f790d69a7eea176600e2a8666f49c10a?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/4160025/david"}, "reply_to_user": {"reputation": 19267, "user_id": 801894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67f2ccd17aa6fd622152ad88fc2ae784?s=128&d=identicon&r=PG", "display_name": "Solomon Slow", "link": "https://stackoverflow.com/users/801894/solomon-slow"}, "edited": false, "score": 0, "creation_date": 1557330477, "post_id": 56039611, "comment_id": 98730991, "body": "@SolomonSlow, I see, I misunderstood. That seems like a good solution; thank you."}, {"owner": {"reputation": 215710, "user_id": 134633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc6be45ddcfd038ba5e1e5fca319c7fa?s=128&d=identicon&r=PG", "display_name": "caf", "link": "https://stackoverflow.com/users/134633/caf"}, "reply_to_user": {"reputation": 19267, "user_id": 801894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67f2ccd17aa6fd622152ad88fc2ae784?s=128&d=identicon&r=PG", "display_name": "Solomon Slow", "link": "https://stackoverflow.com/users/801894/solomon-slow"}, "edited": false, "score": 0, "creation_date": 1557372762, "post_id": 56039611, "comment_id": 98744621, "body": "@SolomonSlow: If you use <code>clock_nanosleep()</code> with the <code>TIMER_ABSTIME</code> flag, you don&#39;t even have to calculate the time difference - just directly sleep until the time you need to perform the next iteration."}], "answers": [{"comments": [{"owner": {"reputation": 2019, "user_id": 10035556, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86cea073655558939d961937095efc80?s=128&d=identicon&r=PG&f=1", "display_name": "Mayur", "link": "https://stackoverflow.com/users/10035556/mayur"}, "edited": false, "score": 0, "creation_date": 1557316279, "post_id": 56039823, "comment_id": 98722224, "body": "How about using the critical section? Will there be the same outcome?"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1557324465, "post_id": 56039823, "comment_id": 98727348, "body": "<i>The sane thread-safe solution is a condition variable</i>  I disagree.  Proper use of a condition variable requires a predicate condition shared across threads along with the condition variable and mutex themselves.  <code>pthread_cond_wait()</code> is also subject to spurious wakeups without any call to <code>pthread_cond_signal()</code> or <code>pthread_cond_broadcast()</code> nor any error indication, so code to robustly and properly use condition variables has to be much more complex.  A single semaphore can often replace all of that."}], "tags": [], "owner": {"reputation": 44714, "user_id": 731620, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6e2168c4647a4f096a14c254bd3d3f68?s=128&d=identicon&r=PG", "display_name": "ratchet freak", "link": "https://stackoverflow.com/users/731620/ratchet-freak"}, "is_accepted": false, "score": 2, "last_activity_date": 1557315147, "creation_date": 1557315147, "answer_id": 56039823, "question_id": 56039611, "link": "https://stackoverflow.com/questions/56039611/does-this-implementation-of-mutex-locks-result-in-undefined-behavior/56039823#56039823", "title": "Does this implementation of mutex locks result in undefined behavior?", "body": "<p>The sane thread-safe solution is a condition variable:</p>\n\n<pre><code>//main thread\nwhile(1) {\n    x += 1;\n    printf(\"%d\\n\", x);\n\n    pthread_mutex_lock(&amp;lock);\n    pthread_cond_wait(&amp;cond, &amp;lock);\n    pthread_mutex_unlock(&amp;lock);\n}\n</code></pre>\n\n<p>then in the sleeper thread you do:</p>\n\n<pre><code>//sleeper thread\nwhile(1) {\n    pthread_cond_signal(&amp;cond);\n    sleep(2);\n}\n</code></pre>\n\n<p>However you can also read the current time from the operating system and the sleep for the remaining time until next epoch using the high resolution sleep and time.</p>\n\n<p>The next option is using a timerfd to wake you up in a fixed interval. And it can let you know if you missed a wake up.</p>\n"}, {"tags": [], "owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "is_accepted": true, "score": 5, "last_activity_date": 1557322264, "last_edit_date": 1557322264, "creation_date": 1557321952, "answer_id": 56041914, "question_id": 56039611, "link": "https://stackoverflow.com/questions/56039611/does-this-implementation-of-mutex-locks-result-in-undefined-behavior/56041914#56041914", "title": "Does this implementation of mutex locks result in undefined behavior?", "body": "<p>Answering your questions,</p>\n\n<blockquote>\n  <ol>\n  <li>If <code>main</code> tries to lock <code>lock[0]</code> twice it should deadlock.</li>\n  </ol>\n</blockquote>\n\n<p>Yes, it would.  Unless you use recursive mutexes, but then your child thread would never be able to lock the mutex as <code>main</code> would always have it locked.</p>\n\n<blockquote>\n  <ol start=\"2\">\n  <li><code>extra</code> unlocking <code>lock[0]</code>, which was locked by main, should be undefined behavior.</li>\n  </ol>\n</blockquote>\n\n<p>Per the <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/pthread_mutex_unlock.html\" rel=\"noreferrer\">POSIX documentation for <code>pthread_mutex_unlock()</code></a>, this is undefined behavior for a <code>NORMAL</code> <strong>and</strong> non-robust mutex.  However, the <code>DEFAULT</code> mutex does not have to be <code>NORMAL</code> and non-robust so there is this caveat:</p>\n\n<blockquote>\n  <p>If the mutex type is <code>PTHREAD_MUTEX_DEFAULT</code>, the behavior of <code>pthread_mutex_lock()</code> [and <code>pthread_mutex_unlock()</code>] may correspond to one of the three other standard mutex types as described in the table above. If it does not correspond to one of those three, the behavior is undefined for the cases marked.</p>\n</blockquote>\n\n<p>(Note my addition of <code>pthread_mutex_unlock()</code>.  The table of mutex behavior clearly shows that unlock behavior for a non-owner varies between different types of mutexes and even uses the same \"dagger\" mark in the \"Unlock When Not Owner\" column as used in the \"Relock\" column, and the \"dagger\" mark refers to the footnote I quoted.)</p>\n\n<p>A robust <code>NORMAL</code>, <code>ERRORCHECK</code>, or <code>RECURSIVE</code> mutex will return an error if a non-owning thread attempts to unlock it, and the mutex remains locked.</p>\n\n<p>A simpler solution is to use a pair of semaphores (the following code is deliberately missing error checking along with empty lines that would otherwise increase readability in order to eliminate/reduce any vertical scroll bar):</p>\n\n<pre><code>#include &lt;semaphore.h&gt;\n#include &lt;pthread.h&gt;\n#include &lt;stdio.h&gt;\nsem_t main_sem;\nsem_t child_sem;\nvoid *child( void *arg )\n{\n    for ( ;; )\n    {\n        sem_wait( &amp;child_sem );\n        sleep( 2 );\n        sem_post( &amp;main_sem );\n    }\n    return( NULL );\n}\nint main( int argc, char **argv )\n{\n    pthread_t child_tid;\n    sem_init( &amp;main_sem, 0, 0 );\n    sem_init( &amp;child_sem, 0, 0 );\n    pthread_create( &amp;child_tid, NULL, child, NULL );\n    int x = 0;\n    for ( ;; )\n    {\n        // tell the child thread to go\n        sem_post( &amp;child_sem );\n        // wait for the child thread to finish one iteration\n        sem_wait( &amp;main_sem );\n        x++;\n        printf(\"%d\\n\", x);\n    }\n    pthread_join( child_tid, NULL );\n}\n</code></pre>\n"}], "migrated_from": {"other_site": {"markdown_extensions": ["MathJax", "Prettify"], "launch_date": 1436881020, "open_beta_date": 1296068400, "closed_beta_date": 1295463600, "site_state": "normal", "high_resolution_icon_url": "https://cdn.sstatic.net/Sites/codereview/Img/apple-touch-icon@2.png", "twitter_account": "StackCodeReview", "favicon_url": "https://cdn.sstatic.net/Sites/codereview/Img/favicon.ico", "icon_url": "https://cdn.sstatic.net/Sites/codereview/Img/apple-touch-icon.png", "audience": "peer programmer code reviews", "site_url": "https://codereview.stackexchange.com", "api_site_parameter": "codereview", "logo_url": "https://cdn.sstatic.net/Sites/codereview/Img/logo.png", "name": "Code Review", "site_type": "main_site"}, "on_date": 1557314456, "question_id": 219903}, "owner": {"reputation": 431, "user_id": 4160025, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f790d69a7eea176600e2a8666f49c10a?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/4160025/david"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 319, "favorite_count": 0, "accepted_answer_id": 56041914, "answer_count": 2, "score": 7, "last_activity_date": 1557322264, "creation_date": 1557281639, "question_id": 56039611, "link": "https://stackoverflow.com/questions/56039611/does-this-implementation-of-mutex-locks-result-in-undefined-behavior", "title": "Does this implementation of mutex locks result in undefined behavior?", "body": "<p>I need to control the frequency at which <code>main</code> processes data. In the example, it just increases the value of a variable. I cannot use <code>sleep</code> inside of <code>main</code> because I need the frequency to be constant (and I don't know exactly how long does it take to process all the data). I just know for a fact that whatever processing I need to do takes less than 2 seconds, so I just need to prevent <code>main</code> from increasing <code>x</code> more than once every two seconds.</p>\n\n<p>The solution I've found involves using two mutexes: locking one in <code>main</code> and unlocking it in an <code>extra</code> thread, and locking the other in <code>extra</code> and unlocking it in <code>main</code>. This <code>extra</code> thread sleeps for 2 seconds per cycle.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;pthread.h&gt;\n\nvoid  *extra(void *arg)\n{\n    pthread_mutex_t *lock = (pthread_mutex_t *) arg;\n    while(1) {\n        pthread_mutex_unlock(&amp;lock[0]);\n        pthread_mutex_lock(&amp;lock[1]);\n        sleep(2);\n    }\n}\n\nint main()\n{\n    int x = 0;\n\n    pthread_mutex_t lock[2];\n    pthread_mutex_init(&amp;lock[0], NULL);\n    pthread_mutex_init(&amp;lock[1], NULL);\n\n    pthread_mutex_lock(&amp;lock[1]);\n\n    pthread_t extra_thread;\n    pthread_create(&amp;extra_thread, NULL, &amp;extra, lock);\n\n    while(1) {\n        x += 1;\n        printf(\"%d\\n\", x);\n\n        pthread_mutex_lock(&amp;lock[0]);\n        pthread_mutex_unlock(&amp;lock[1]);\n    }\n}\n</code></pre>\n\n<h1>The Problem</h1>\n\n<p>The reason why this works is that <code>main</code> cannot lock <code>lock[0]</code> twice; it has to wait until <code>extra</code> unlocks it. However, according to <a href=\"https://pubs.opengroup.org/onlinepubs/009695399/functions/pthread_mutex_lock.html\" rel=\"noreferrer\">The Open Group</a></p>\n\n<blockquote>\n  <p>Attempting to relock the mutex causes deadlock. If a thread attempts\n  to unlock a mutex that it has not locked or a mutex which is unlocked,\n  undefined behavior results.</p>\n</blockquote>\n\n<h1>The Question</h1>\n\n<p>Based on this, I see two issues here:</p>\n\n<ol>\n<li>If <code>main</code> tries to lock <code>lock[0]</code> twice it should deadlock.</li>\n<li><code>extra</code> unlocking <code>lock[0]</code>, which was locked by <code>main</code>, should be undefined behavior.</li>\n</ol>\n\n<p>Is my analysis correct?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "edited": false, "score": 5, "creation_date": 1557278887, "post_id": 56032329, "comment_id": 98707859, "body": "Use <code>unsigned char</code>. When you are using <code>char</code> the value is negative."}, {"owner": {"reputation": 31, "user_id": 10253421, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SmECY.jpg?s=128&g=1", "display_name": "Leon", "link": "https://stackoverflow.com/users/10253421/leon"}, "reply_to_user": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "edited": false, "score": 1, "creation_date": 1557279503, "post_id": 56032329, "comment_id": 98707949, "body": "Thanks, that seems to do it even skipping the &amp; operation."}], "answers": [{"tags": [], "owner": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "is_accepted": true, "score": 3, "last_activity_date": 1557280067, "last_edit_date": 1557280067, "creation_date": 1557279397, "answer_id": 56032404, "question_id": 56032329, "link": "https://stackoverflow.com/questions/56032329/is-there-way-to-get-the-last-byte-of-data-of-off-a-short-and-save-it-into-a-char/56032404#56032404", "title": "Is there way to get the last byte of data of off a short and save it into a char", "body": "<p>When you write <code>printf(\"%02X \\n\", mychar);</code> <code>mychar</code> is promoted to an integer and that integer is then printed. In your case <code>mychar</code> is signed and is in fact negative, so the value is promoted to a negative integer and you are getting the output <code>FFFFFFFA</code>. If instead you use <code>unsigned char</code> then you will get the expected output.</p>\n\n<p>Your question seems like a duplicate of <a href=\"https://stackoverflow.com/questions/3555791/why-does-printf-not-print-out-just-one-byte-when-printing-hex\">this question</a> and <a href=\"https://stackoverflow.com/a/3555936/8767209\">this answer</a> is better than mine. </p>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 9587979, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HkMQe.png?s=128&g=1", "display_name": "Jordan Powell", "link": "https://stackoverflow.com/users/9587979/jordan-powell"}, "is_accepted": false, "score": 1, "last_activity_date": 1557318808, "last_edit_date": 1557318808, "creation_date": 1557279705, "answer_id": 56032439, "question_id": 56032329, "link": "https://stackoverflow.com/questions/56032329/is-there-way-to-get-the-last-byte-of-data-of-off-a-short-and-save-it-into-a-char/56032439#56032439", "title": "Is there way to get the last byte of data of off a short and save it into a char", "body": "<p>You need to cast to a char to truncate the short into a char. Casting converts the binary value into the correct length. </p>\n\n<p>short = 5; --> 0000 0000 0000 0101 \nWhen casting it becomes --> 0000 0101\nTruncating the short to a char. </p>\n\n<pre><code>unsigned char opcode = (char)(opcode &amp; 0x00ff)\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 10253421, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SmECY.jpg?s=128&g=1", "display_name": "Leon", "link": "https://stackoverflow.com/users/10253421/leon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 149, "favorite_count": 0, "closed_date": 1557279944, "accepted_answer_id": 56032404, "answer_count": 2, "score": 2, "last_activity_date": 1557318808, "creation_date": 1557278699, "last_edit_date": 1557279384, "question_id": 56032329, "link": "https://stackoverflow.com/questions/56032329/is-there-way-to-get-the-last-byte-of-data-of-off-a-short-and-save-it-into-a-char", "closed_reason": "Duplicate", "title": "Is there way to get the last byte of data of off a short and save it into a char", "body": "<p>I'm following a tutorial to write an emulator for the Chip8.\nOpcodes are 2 bytes long and in HEX. They are stored in unsigned short data types (which is 2 bytes).</p>\n\n<p>I want to get the last byte off of one of these shorts and save it on a char (1 byte).</p>\n\n<p>I have tried using the &amp; operation to filter out the first byte and then assign to a char variable.</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>unsigned short opcode = 0x56FA; //sample opcode\nchar mychar = opcode &amp; 0x00FF;  //&amp; operation to make 1st byte zeros\nprintf(\"%02X \\n\", mychar);      //should print last byte FA\n</code></pre>\n\n<p>I expect for it to print FA.\nbut instead prints out FFFFFFFA.</p>\n"}, {"tags": ["c", "swift", "pointers", "struct", "unsafemutablepointer"], "comments": [{"owner": {"reputation": 47412, "user_id": 3141234, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/78b45a835031f4ce03a6653b3262b5d3?s=128&d=identicon&r=PG", "display_name": "Alexander", "link": "https://stackoverflow.com/users/3141234/alexander"}, "edited": false, "score": 0, "creation_date": 1557279199, "post_id": 56032236, "comment_id": 98707906, "body": "<code>UnsafeMutablePointer.allocate(capacity)</code> returns a non-optional, so your forward declaration of <code>buffer</code> as optional, the check against <code>nil</code> and the force wrapping thereafter don&#39;t do anything."}, {"owner": {"reputation": 19, "user_id": 11453665, "user_type": "registered", "profile_image": "https://graph.facebook.com/2176917472416255/picture?type=large", "display_name": "Michel Turcotte", "link": "https://stackoverflow.com/users/11453665/michel-turcotte"}, "reply_to_user": {"reputation": 47412, "user_id": 3141234, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/78b45a835031f4ce03a6653b3262b5d3?s=128&d=identicon&r=PG", "display_name": "Alexander", "link": "https://stackoverflow.com/users/3141234/alexander"}, "edited": false, "score": 0, "creation_date": 1557281590, "post_id": 56032236, "comment_id": 98708307, "body": "Sorry, I do not understand.  If I remove the &quot;!&quot; from the buffer! the compilers complains a lot (presumingly because it is an optional; isn&#39;t it?).  Or perhaps I do not understand the usage of the word optional.  Any way, without a code sample from you, I do not know what you mean in and how to find a solution.  Thank you for trying to help me.  I am still looking to understand and fix my code..."}, {"owner": {"reputation": 47412, "user_id": 3141234, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/78b45a835031f4ce03a6653b3262b5d3?s=128&d=identicon&r=PG", "display_name": "Alexander", "link": "https://stackoverflow.com/users/3141234/alexander"}, "edited": false, "score": 0, "creation_date": 1557282845, "post_id": 56032236, "comment_id": 98708557, "body": "My comment wasn&#39;t a solution (hence why I didn&#39;t put it below as an answer), it&#39;s merely a comment on the unnecessary complexity introduced by declaring <code>buffer</code> as <code>UnsafeMutablePointer&lt;UInt8&gt;?</code>. Given that you made <code>buffer</code> optional, some form of unwrapping is necessary (force unwrapping with <code>!</code> being one of the options, although usually the worst choice), but that could be completely circumvented if buffer was just made non-optional <code>var buffer = UnsafeMutablePointer&lt;UInt8&gt;.allocate(capacity: 1024)</code>"}, {"owner": {"reputation": 47412, "user_id": 3141234, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/78b45a835031f4ce03a6653b3262b5d3?s=128&d=identicon&r=PG", "display_name": "Alexander", "link": "https://stackoverflow.com/users/3141234/alexander"}, "edited": false, "score": 0, "creation_date": 1557282989, "post_id": 56032236, "comment_id": 98708590, "body": "What&#39;s the ownership model behind the data you get from C land? Who&#39;s responsible for deallocating it? (e.g. is it loaned out to you with the guarantee that it&#39;ll be valid for the duration of your use, and then automatically cleaned up on the C side, or are you given ownership and the responsibility to <code>free</code> it whenever is appropriate for you?)"}, {"owner": {"reputation": 19, "user_id": 11453665, "user_type": "registered", "profile_image": "https://graph.facebook.com/2176917472416255/picture?type=large", "display_name": "Michel Turcotte", "link": "https://stackoverflow.com/users/11453665/michel-turcotte"}, "reply_to_user": {"reputation": 47412, "user_id": 3141234, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/78b45a835031f4ce03a6653b3262b5d3?s=128&d=identicon&r=PG", "display_name": "Alexander", "link": "https://stackoverflow.com/users/3141234/alexander"}, "edited": false, "score": 0, "creation_date": 1557287245, "post_id": 56032236, "comment_id": 98709408, "body": "Thank you Alexander for your additional comments.  The code I provided is not my real code, but it has the same structure.  I need to have a buffer that can be reallocated and grow as needed by the data coming from tcpip, and I need to deallocate it if the device runs low in memory. =&gt; What I need is help to understanding how to give the pointer of the buffer to Swift to access that generated memory using Swift struct.  I still don&#39;t know how to do that."}, {"owner": {"reputation": 47412, "user_id": 3141234, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/78b45a835031f4ce03a6653b3262b5d3?s=128&d=identicon&r=PG", "display_name": "Alexander", "link": "https://stackoverflow.com/users/3141234/alexander"}, "edited": false, "score": 0, "creation_date": 1557288751, "post_id": 56032236, "comment_id": 98709707, "body": "You can dereference a <code>UnsafeMutablePointer&lt;MyStruct1&gt;</code> to get a <code>MyStruct1</code> using the <code>pointee</code> field, but then you&#39;re dealing with Swift struct land, where every assignment and passing as a parameter can cause a copy. It&#39;s possible to work with this, but I would advise against it. Is there a particular reason you&#39;re doing your networking with C code, rather than just using Swift&#39;s own NIO?"}, {"owner": {"reputation": 47412, "user_id": 3141234, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/78b45a835031f4ce03a6653b3262b5d3?s=128&d=identicon&r=PG", "display_name": "Alexander", "link": "https://stackoverflow.com/users/3141234/alexander"}, "edited": false, "score": 0, "creation_date": 1557288835, "post_id": 56032236, "comment_id": 98709729, "body": "You could conceviably make a <code>MyStruct1Ptr</code> struct, which wraps a <code>UnsafeMutablePointer&lt;MyStruct1&gt;</code>, and exposes the same properties as <code>MyStruct1Ptr</code>, but as computed properties. E.g. <code>myStruct1Ptr.foo</code> is a computed property that calls <code>self.ptr.pointee.foo</code>. It&#39;d be a pain though."}, {"owner": {"reputation": 47412, "user_id": 3141234, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/78b45a835031f4ce03a6653b3262b5d3?s=128&d=identicon&r=PG", "display_name": "Alexander", "link": "https://stackoverflow.com/users/3141234/alexander"}, "edited": false, "score": 0, "creation_date": 1557290205, "post_id": 56032236, "comment_id": 98710029, "body": "Also, what exactly is the bulk of this data? I suspect that your struct is some kind of header/metadata, and some kind of array that contains the bulk of the data. In that case, copy the struct isn&#39;t an issue, it&#39;s just the buffer that you need to reuse, which is possible with Unsafe(Raw)(Mutable)Buffer"}, {"owner": {"reputation": 19, "user_id": 11453665, "user_type": "registered", "profile_image": "https://graph.facebook.com/2176917472416255/picture?type=large", "display_name": "Michel Turcotte", "link": "https://stackoverflow.com/users/11453665/michel-turcotte"}, "reply_to_user": {"reputation": 47412, "user_id": 3141234, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/78b45a835031f4ce03a6653b3262b5d3?s=128&d=identicon&r=PG", "display_name": "Alexander", "link": "https://stackoverflow.com/users/3141234/alexander"}, "edited": false, "score": 0, "creation_date": 1557291160, "post_id": 56032236, "comment_id": 98710268, "body": "I do not know how to use pointee.  I will look into this."}, {"owner": {"reputation": 19, "user_id": 11453665, "user_type": "registered", "profile_image": "https://graph.facebook.com/2176917472416255/picture?type=large", "display_name": "Michel Turcotte", "link": "https://stackoverflow.com/users/11453665/michel-turcotte"}, "reply_to_user": {"reputation": 47412, "user_id": 3141234, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/78b45a835031f4ce03a6653b3262b5d3?s=128&d=identicon&r=PG", "display_name": "Alexander", "link": "https://stackoverflow.com/users/3141234/alexander"}, "edited": false, "score": 0, "creation_date": 1557291402, "post_id": 56032236, "comment_id": 98710324, "body": "The real structure I get from tcpip can be of practically any length from 3 bytes and above.  I was able to have Swift read my C structures (through the magic of Bridging-Header.h).  The C code is shared with a a Windows server.  Let me learn about pointee..."}, {"owner": {"reputation": 47412, "user_id": 3141234, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/78b45a835031f4ce03a6653b3262b5d3?s=128&d=identicon&r=PG", "display_name": "Alexander", "link": "https://stackoverflow.com/users/3141234/alexander"}, "edited": false, "score": 0, "creation_date": 1557291666, "post_id": 56032236, "comment_id": 98710388, "body": "&quot;The real structure I get from tcpip can be of practically any length from 3 bytes and above.&quot; The only way to create C structs of varying runtime size is to use a <a href=\"https://en.wikipedia.org/wiki/Flexible_array_member\" rel=\"nofollow noreferrer\">flexible array member</a>, which can&#39;t possibly be the case here, because Swift doesn&#39;t support such types. Thus, these structs are a constant size, and contain their payload indirectly, as some buffer elsewhere in memory. In such a case, copying the structs themselves isn&#39;t an issue for copying (they&#39;d be some constant-sized overhead), but rather, the payload."}, {"owner": {"reputation": 19, "user_id": 11453665, "user_type": "registered", "profile_image": "https://graph.facebook.com/2176917472416255/picture?type=large", "display_name": "Michel Turcotte", "link": "https://stackoverflow.com/users/11453665/michel-turcotte"}, "reply_to_user": {"reputation": 47412, "user_id": 3141234, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/78b45a835031f4ce03a6653b3262b5d3?s=128&d=identicon&r=PG", "display_name": "Alexander", "link": "https://stackoverflow.com/users/3141234/alexander"}, "edited": false, "score": 0, "creation_date": 1557292124, "post_id": 56032236, "comment_id": 98710507, "body": "I learned (again) about pointee and it seems to only return the numerical value of a pointer which is not my problem.  I seems to get the pointer, my problem seems to have swift assign that pointer to a pointer of a typed structure in swift."}, {"owner": {"reputation": 19, "user_id": 11453665, "user_type": "registered", "profile_image": "https://graph.facebook.com/2176917472416255/picture?type=large", "display_name": "Michel Turcotte", "link": "https://stackoverflow.com/users/11453665/michel-turcotte"}, "reply_to_user": {"reputation": 47412, "user_id": 3141234, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/78b45a835031f4ce03a6653b3262b5d3?s=128&d=identicon&r=PG", "display_name": "Alexander", "link": "https://stackoverflow.com/users/3141234/alexander"}, "edited": false, "score": 0, "creation_date": 1557292348, "post_id": 56032236, "comment_id": 98710568, "body": "Hi Alexander.  Remember I get my data from tcpip?  For example, I may get a &#39;here is a filename&#39; packet.  I will map the header into a struct and deal with the variable filename another way.  I would like to focus on my problem now:  assigning a memory to a swift struct pointer.  Good night."}, {"owner": {"reputation": 47412, "user_id": 3141234, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/78b45a835031f4ce03a6653b3262b5d3?s=128&d=identicon&r=PG", "display_name": "Alexander", "link": "https://stackoverflow.com/users/3141234/alexander"}, "edited": false, "score": 0, "creation_date": 1557294843, "post_id": 56032236, "comment_id": 98711370, "body": "&quot;it seems to only return the numerical value of a pointer which is not my problem.&quot; No it doesn&#39;t, it derefences a given pointer, akin to <code>*p</code> in C. <code>UnsafePointer&lt;T&gt;.pointee</code> gives you the referenced <code>T</code>."}, {"owner": {"reputation": 47412, "user_id": 3141234, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/78b45a835031f4ce03a6653b3262b5d3?s=128&d=identicon&r=PG", "display_name": "Alexander", "link": "https://stackoverflow.com/users/3141234/alexander"}, "edited": false, "score": 0, "creation_date": 1557295046, "post_id": 56032236, "comment_id": 98711422, "body": "<code>Remember I get my data from tcpip?</code> Well you mention it abstractly, TCP/IP is a networking protocol stack, so telling someone you get your data from it is like saying you got your data by pen and paper. It doesn&#39;t explain much about the details of what&#39;s going on or how it&#39;s done. <code>I will map the header into a struct</code> -&gt; Is this the struct you&#39;re trying to access in Swift land? If it&#39;s just a header, why is copying it such a concern? <code>deal with the variable filename another way.</code> and I presume this isn&#39;t part of the problem?"}], "answers": [{"tags": [], "owner": {"reputation": 67889, "user_id": 341750, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/JgAmt.png?s=128&g=1", "display_name": "hotpaw2", "link": "https://stackoverflow.com/users/341750/hotpaw2"}, "is_accepted": false, "score": 1, "last_activity_date": 1557342790, "last_edit_date": 1557342790, "creation_date": 1557342489, "answer_id": 56047495, "question_id": 56032236, "link": "https://stackoverflow.com/questions/56032236/how-can-i-access-a-memory-buffer-mapped-into-a-swift-structure/56047495#56047495", "title": "How can I access a memory buffer mapped into a swift structure?", "body": "<p>You cannot map a buffer allocated as an unsafe raw pointer into a Swift structure variable without copying.</p>\n\n<p>A Swift structure variable has other language properties such that you can only access the contents of a Swift structure variable via a pointer if that variable has been allocated by Swift as that same structure type (e.g. not as an unsafe pointer handed to it by C).</p>\n\n<p>Instead, you might be able to write accessor functions that use the offset and size of each Swift structure element to read and write bytes from an offset raw pointer bound to a variable of the required type.</p>\n\n<p>Or just use the C structure via a bridging header.</p>\n"}], "owner": {"reputation": 19, "user_id": 11453665, "user_type": "registered", "profile_image": "https://graph.facebook.com/2176917472416255/picture?type=large", "display_name": "Michel Turcotte", "link": "https://stackoverflow.com/users/11453665/michel-turcotte"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 266, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1557342790, "creation_date": 1557277694, "question_id": 56032236, "link": "https://stackoverflow.com/questions/56032236/how-can-i-access-a-memory-buffer-mapped-into-a-swift-structure", "title": "How can I access a memory buffer mapped into a swift structure?", "body": "<p>This is probably trivial for you, but I am new in Swift and I can't find the answer.  I use C code to convert data from TCP/IP, that all works fine.  But when I try to send the data back to Swift, I get the error:\nValue of type 'UnsafeMutablePointer' has no member 'x'\n(at compile time).</p>\n\n<p>Put simply, my C code generates a structure that I want my swift code to read and use a structure to access the fields.\nNote: I DO NOT WANT TO COPY THE DATA (the example here is simple but I deal with MBs (GB).</p>\n\n<pre><code>override func viewDidLoad()\n{\n  struct MyStruct1\n  {\n    var x   : UInt32        \n    var y   : UInt32\n  }\n  var buffer : UnsafeMutablePointer&lt;UInt8&gt;?\n  //...\n  buffer = UnsafeMutablePointer&lt;UInt8&gt;.allocate( capacity: Int(1024) )\n  if (buffer != nil)\n  {\n     defer { buffer!.deallocate() }\n     // CCode_That_Initializes_Buffer( buffer ) with An array of MyStruct\n     var myStructP : UnsafeMutablePointer&lt;MyStruct1&gt;\n     myStructP = UnsafeMutableRawPointer(buffer!).assumingMemoryBound(to: MyStruct1.self)\n     // Value of type 'UnsafeMutablePointer&lt;MyStruct1&gt;' has no member 'x'\n     print( myStructP.x ) // &lt;= This does not compile\n  }\n}\n</code></pre>\n"}, {"tags": ["c", "error-handling"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1557270827, "post_id": 56031462, "comment_id": 98706520, "body": "Is C a hard requirement here? The reason I mention this is C++ has exceptions which are basically what you&#39;re looking for. C has no such system, so you need to roll your own. It&#39;s worth looking at successful C code bases to see what approaches they use, if any. Normally functions just return error codes, not complete structures like this, and you look up the code manually if necessary, or through a function if desired."}, {"owner": {"reputation": 106, "user_id": 11290735, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-rDSVw08K7EQ/AAAAAAAAAAI/AAAAAAAAANg/Yn5drYjDAe4/photo.jpg?sz=128", "display_name": "David Lehnsherr", "link": "https://stackoverflow.com/users/11290735/david-lehnsherr"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1557272985, "post_id": 56031462, "comment_id": 98706925, "body": "C is, unfortunately, a hard requirement. Return codes are not suitable for disambiguation. They make the same problems as magic numbers do. At least, we should use enum approach. I agree, it\u2019s worth looking at successful C code bases, but I believe I can find answer much faster with stackoverflow community :)"}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 1, "creation_date": 1557273447, "post_id": 56031462, "comment_id": 98707001, "body": "There are a some libraries that mimic C++ exceptions using setjmp/longjmp. But I can&#39;t recommend one because I didn&#39;t use them."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 3, "creation_date": 1557273609, "post_id": 56031462, "comment_id": 98707023, "body": "Older C code bases, which I&#39;m more familiar with, use an errno-style system where these numbers are reserved in a header file to avoid conflict. The approach differs wildly, mind you, as BSD and GNU, two very influential coding styles, have different philosophies here. The predominant convention is to return <code>0</code> on success, anything else on error, sometimes consistently positive, sometimes consistently negative. How you generate the lookup table is where the deal differences lie, as those can be automatically generated if necessary with scripting."}], "owner": {"reputation": 106, "user_id": 11290735, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-rDSVw08K7EQ/AAAAAAAAAAI/AAAAAAAAANg/Yn5drYjDAe4/photo.jpg?sz=128", "display_name": "David Lehnsherr", "link": "https://stackoverflow.com/users/11290735/david-lehnsherr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1557270235, "creation_date": 1557269888, "last_edit_date": 1557270235, "question_id": 56031462, "link": "https://stackoverflow.com/questions/56031462/how-to-provide-context-while-handing-errors-in-c", "title": "How to provide context while handing errors in C?", "body": "<p>Standard library functions set errno to provide context. We use it for disambiguation.</p>\n\n<p>But what can I do with functions in my program? I want to write something like that:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>void some_func(struct error *e, ...);\n</code></pre>\n\n<p>Pointer to a local variable is passed to a function that may fail with error. If it fails, it sets error context to variable passed by pointer.</p>\n\n<p>What matters is the ability to provide context when error occurs.</p>\n\n<p>How can I do that?</p>\n\n<p>The main goal is to write resilient software.</p>\n\n<p>Below I briefly describe my research on finding something suitable.</p>\n\n<p>I already tried to implement structure:</p>\n\n<pre><code>struct error {\n        enum error_type type;\n        char *msg;\n};\n</code></pre>\n\n<p>There\u2019s something I\u2019m not sure about \u2014 registrating new enumeration items <code>error_type</code>. I\u2019m not sure whether the following flow does not has any risks:</p>\n\n<ol>\n<li>Register new error type in error.h</li>\n<li>Return error with that type from a function</li>\n</ol>\n\n<p>Are there any risks in this flow and what are they? Can they be eliminated?</p>\n"}, {"tags": ["c", "linux", "ipc", "embedded-linux", "tty"], "comments": [{"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1557270625, "post_id": 56031413, "comment_id": 98706473, "body": "In short:a signal is not a keystroke.  They are unrelated."}, {"owner": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "edited": false, "score": 0, "creation_date": 1557277453, "post_id": 56031413, "comment_id": 98707636, "body": "You want <b>tcsetattr</b> (<code>man 3 termios</code>) to set the terminal into raw mode."}], "answers": [{"tags": [], "owner": {"reputation": 100758, "user_id": 1899640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47374ccb28e4b0d2454b64f7b975bc66?s=128&d=identicon&r=PG", "display_name": "that other guy", "link": "https://stackoverflow.com/users/1899640/that-other-guy"}, "is_accepted": true, "score": 3, "last_activity_date": 1557270667, "last_edit_date": 1557270667, "creation_date": 1557270063, "answer_id": 56031486, "question_id": 56031413, "link": "https://stackoverflow.com/questions/56031413/how-and-when-are-interrupt-key-combination-such-as-ctrl-c-translated-to-signals/56031486#56031486", "title": "How and when are interrupt key combination,such as CTRL-C, translated to signals?", "body": "<ol>\n<li>The key combo is turned into a signal by the terminal's <em>line discipline</em>, a layer in the TTY subsystem. Here's the description <a href=\"https://en.wikipedia.org/wiki/Line_discipline\" rel=\"nofollow noreferrer\">from Wikipedia</a>:</li>\n</ol>\n\n<blockquote>\n  <p>For example, the standard line discipline processes the data it receives from the hardware driver and from applications writing to the device according to the requirements of a terminal on a Unix-like system. On input, it handles special characters such as the interrupt character (typically Control-C) and the erase and kill characters (typically backspace or delete, and Control-U, respectively) and, on output, it replaces all the LF characters with a CR/LF sequence.</p>\n</blockquote>\n\n<ol start=\"2\">\n<li><p>The keypress is not passed, it's suppressed when the signal is raised. If the process has no SIGINT handler, the kernel will terminate it.</p></li>\n<li><p>You can obviously override this: that's how tools like <code>ssh</code> work. You can easily do this by setting the terminal to \"raw\" mode, e.g. with the shell command <code>stty raw</code>. If you then run <code>cat -vE</code> you can hit any keys you want and see them printed in caret notation. Make sure to plan on a way to close the terminal because you can obviously not Ctrl-C/Z/D out of it anymore.</p></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 170455, "user_id": 149341, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/omfTQ.png?s=128&g=1", "display_name": "duskwuff -inactive-", "link": "https://stackoverflow.com/users/149341/duskwuff-inactive"}, "is_accepted": false, "score": 1, "last_activity_date": 1557270110, "creation_date": 1557270110, "answer_id": 56031490, "question_id": 56031413, "link": "https://stackoverflow.com/questions/56031413/how-and-when-are-interrupt-key-combination-such-as-ctrl-c-translated-to-signals/56031490#56031490", "title": "How and when are interrupt key combination,such as CTRL-C, translated to signals?", "body": "<blockquote>\n  <p>How does the keycombo become a Signal (in the kernel, client application, runtime)?</p>\n</blockquote>\n\n<p>This translation is performed as part of <a href=\"https://www.kernel.org/doc/Documentation/serial/tty.txt\" rel=\"nofollow noreferrer\">the kernel's TTY line discipline</a>. There are a number of other translations performed as part of this process, like end-of-file (^D), stop signalling (^Z), character echo, basic line editing (backspace, ^U, etc), and DEL/BS and CR/CRLF translation.</p>\n\n<blockquote>\n  <p>Is the keystroke still passed? If CTRL-C has a null handler, does STDIN still get CTRL-C?</p>\n</blockquote>\n\n<p>No. Control characters which are handled by the line discipline are not passed to the foreground process.</p>\n\n<blockquote>\n  <p>What is the best way to not interpret any keystroke as a signal combination? Can this be done in TTY or Environment settings?</p>\n</blockquote>\n\n<p>Use <a href=\"https://linux.die.net/man/3/tcsetattr\" rel=\"nofollow noreferrer\"><code>tcgetattr()</code> and <code>tcsetattr()</code></a> to change the terminal attributes. The <code>c_cc</code> element of <code>struct termios</code> contains settings for control characters; you can disable some or all elements by setting them to <code>_POSIX_VDISABLE</code>.</p>\n\n<p>(You can also use <code>cfmakeraw()</code> -- documented at the same page as above -- to clear most elements of a <code>struct termios</code>, giving you a mostly \"raw\" terminal. However, this may disable more terminal behaviors than you expect.)</p>\n"}], "owner": {"reputation": 2776, "user_id": 1987437, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/508e14a7e9414311eff04b2fd8d20ed6?s=128&d=identicon&r=PG", "display_name": "Liam Kelly", "link": "https://stackoverflow.com/users/1987437/liam-kelly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 650, "favorite_count": 0, "accepted_answer_id": 56031486, "answer_count": 2, "score": 0, "last_activity_date": 1557270667, "creation_date": 1557269378, "question_id": 56031413, "link": "https://stackoverflow.com/questions/56031413/how-and-when-are-interrupt-key-combination-such-as-ctrl-c-translated-to-signals", "title": "How and when are interrupt key combination,such as CTRL-C, translated to signals?", "body": "<p>Using a Linux OS, I need to transparently pass all keystrokes from remote connections to local hardware connections. This is fairly straight forward for everything but signals. I know I can register handlers for each signal that capture and pass the keystroke, but this seems like a hack that might not work for edge cases (what if someone changes the interrupt key combo mapping, would I be double passing the keystrokes, etc.).</p>\n\n<p>In order to come up with a better solution, I really need to know more about how the key combos, IE: CTRL-C, become signals, IE: SIGINT.</p>\n\n<ol>\n<li>How does the keycombo become a Signal (in the kernel, client application, runtime)?</li>\n<li>Is the keystroke still passed? If CTRL-C has a null handler, does STDIN still get CTRL-C?</li>\n<li>What is the best way to not interpret any keystroke as a signal combination? Can this be done in TTY or Environment settings?  </li>\n</ol>\n"}, {"tags": ["c", "linux", "cd"], "comments": [{"owner": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "edited": false, "score": 5, "creation_date": 1557267478, "post_id": 56031104, "comment_id": 98705749, "body": "How do you determine that &quot;your directories aren&#39;t changing&quot;?"}, {"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 3, "creation_date": 1557267482, "post_id": 56031104, "comment_id": 98705751, "body": "Are you expecting it to change the directory of the shell you&#39;re in? If so, searching the web will help you out."}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 5, "creation_date": 1557267503, "post_id": 56031104, "comment_id": 98705755, "body": "How do you check that the cwd isn&#39;t changed? You realize that <code>chdir()</code> &quot;only&quot; changes the cwd for the process that calls it?"}, {"owner": {"reputation": 100758, "user_id": 1899640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47374ccb28e4b0d2454b64f7b975bc66?s=128&d=identicon&r=PG", "display_name": "that other guy", "link": "https://stackoverflow.com/users/1899640/that-other-guy"}, "edited": false, "score": 3, "creation_date": 1557267546, "post_id": 56031104, "comment_id": 98705766, "body": "You cannot write <code>cd</code> as an external utility. If you are writing a whole shell, you must avoid <code>fork()</code>ing first"}, {"owner": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "reply_to_user": {"reputation": 100758, "user_id": 1899640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47374ccb28e4b0d2454b64f7b975bc66?s=128&d=identicon&r=PG", "display_name": "that other guy", "link": "https://stackoverflow.com/users/1899640/that-other-guy"}, "edited": false, "score": 2, "creation_date": 1557267736, "post_id": 56031104, "comment_id": 98705813, "body": "@thatotherguy <i>technically</i> you can ... <i>if</i> the moved shell is aware of that (which is probably none): <a href=\"https://unix.stackexchange.com/a/94365/23529\">unix.stackexchange.com/a/94365/23529</a>"}, {"owner": {"reputation": 79, "user_id": 11178540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dc6c0a17f6433eaec24eb682134bf68?s=128&d=identicon&r=PG&f=1", "display_name": "poppinMartinellis", "link": "https://stackoverflow.com/users/11178540/poppinmartinellis"}, "reply_to_user": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1557267816, "post_id": 56031104, "comment_id": 98705833, "body": "@Swordfish wouldn&#39;t the process that calls <code>chdir()</code> be the process that changes to the specified directory?"}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 1, "creation_date": 1557267911, "post_id": 56031104, "comment_id": 98705858, "body": "Each process has its own current working directory. The shell is a process, your program is a process. When your program calls <code>chdir()</code> that changes the cwd of your program, but not the cwd of the shell."}, {"owner": {"reputation": 79, "user_id": 11178540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dc6c0a17f6433eaec24eb682134bf68?s=128&d=identicon&r=PG&f=1", "display_name": "poppinMartinellis", "link": "https://stackoverflow.com/users/11178540/poppinmartinellis"}, "reply_to_user": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "edited": false, "score": 0, "creation_date": 1557267946, "post_id": 56031104, "comment_id": 98705867, "body": "@DanielJour that&#39;s a good question. My program is essentially an infinite loop that asks for the user&#39;s input. if they write <code>cd</code>, I just use CTRL + C to exit the program and check if my directory was changed. Is this an incorrect way to check? Shouldn&#39;t the directory just be changed?"}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1557268005, "post_id": 56031104, "comment_id": 98705883, "body": "@poppinMartinellis please read my previous comment."}, {"owner": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "edited": false, "score": 2, "creation_date": 1557268018, "post_id": 56031104, "comment_id": 98705889, "body": "<code>CTRL + C</code> means you exit your program (which is the process which changed working directory) and &quot;return&quot; to the shell process (which <i>didn&#39;t</i> change working directory)"}, {"owner": {"reputation": 79, "user_id": 11178540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dc6c0a17f6433eaec24eb682134bf68?s=128&d=identicon&r=PG&f=1", "display_name": "poppinMartinellis", "link": "https://stackoverflow.com/users/11178540/poppinmartinellis"}, "reply_to_user": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1557268069, "post_id": 56031104, "comment_id": 98705902, "body": "@Swordfish Ah I see! That&#39;s good to know, thanks a bunch. If the goal is to change the directory of the user (based on input in a program), how can we avoid changing the process&#39; directory and instead change the shell&#39;s directory?"}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 2, "creation_date": 1557268121, "post_id": 56031104, "comment_id": 98705921, "body": "<i>I&#39;m tasked with programming the linux cd command in C.</i> \u2013 Are you sure you understood correctly what&#39;s asked of you? Could it be that you&#39;re asked to implement a simple shell that has the ability to change its own working direktory and show that to the user with a prompt?"}, {"owner": {"reputation": 79, "user_id": 11178540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dc6c0a17f6433eaec24eb682134bf68?s=128&d=identicon&r=PG&f=1", "display_name": "poppinMartinellis", "link": "https://stackoverflow.com/users/11178540/poppinmartinellis"}, "reply_to_user": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "edited": false, "score": 0, "creation_date": 1557268158, "post_id": 56031104, "comment_id": 98705927, "body": "@DanielJour Gotcha, Swordfish just informed me about the difference between the shell&#39;s process and the program&#39;s process. That makes more sense as to why nothing is changing lol"}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 2, "creation_date": 1557268338, "post_id": 56031104, "comment_id": 98705969, "body": "have a look at <a href=\"http://www.man7.org/linux/man-pages/man3/getcwd.3.html\" rel=\"nofollow noreferrer\"><code>getcwd()</code></a>"}, {"owner": {"reputation": 79, "user_id": 11178540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dc6c0a17f6433eaec24eb682134bf68?s=128&d=identicon&r=PG&f=1", "display_name": "poppinMartinellis", "link": "https://stackoverflow.com/users/11178540/poppinmartinellis"}, "reply_to_user": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1557268445, "post_id": 56031104, "comment_id": 98705988, "body": "@Swordfish That would make more sense. I am asked to implement a shell, but the ladder part of your question was not specified. If the program&#39;s process&#39; directory is changed, I think that would really be all that can be done. Also, thanks for the tip on <code>getccwd()</code>, I&#39;m using that already and can see how I can solve this by using that."}], "answers": [{"comments": [{"owner": {"reputation": 79, "user_id": 11178540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dc6c0a17f6433eaec24eb682134bf68?s=128&d=identicon&r=PG&f=1", "display_name": "poppinMartinellis", "link": "https://stackoverflow.com/users/11178540/poppinmartinellis"}, "edited": false, "score": 0, "creation_date": 1557268645, "post_id": 56031268, "comment_id": 98706037, "body": "Gotcha, thanks for spelling this out. @Swordfish helped me realize that I was confused on processes."}], "tags": [], "owner": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "is_accepted": true, "score": 6, "last_activity_date": 1557268461, "creation_date": 1557268461, "answer_id": 56031268, "question_id": 56031104, "link": "https://stackoverflow.com/questions/56031104/the-cd-command-in-c-and-use-of-chdir/56031268#56031268", "title": "The cd command in C and use of chdir()", "body": "<p><strong><code>chdir()</code> changes the working directory of the calling process only.</strong></p>\n\n<p>So when you have code like ...</p>\n\n<pre><code>int main() {\n  // 1\n  chdir(\"/\"); // error handling omitted for clarity\n  // 2\n}\n</code></pre>\n\n<p>... and compile that to a program <code>example</code> and then run it in a shell:</p>\n\n<pre><code>$ pwd # 3\n/home/sweet\n$ ./example # 4\n$ pwd # 5\n/home/sweet\n</code></pre>\n\n<p>Then you have two processes in play,</p>\n\n<ol>\n<li><p>the shell, which is where you entered <code>pwd</code> and <code>./example</code></p></li>\n<li><p><code>./example</code>, the process launched (by the shell) with your compile program.</p></li>\n</ol>\n\n<p><code>chdir()</code> is part of your compiled program, not the shell, thus it affects only the process with your program, <strong>not</strong> the shell.</p>\n\n<p>So, at <code>// 1</code> the working directory of your program (in above example run) is <code>/home/sweet</code>, but at <code>// 2</code> it is <code>/</code> as specified in the <code>chdir()</code> call above.  This doesn't affect the shell and the output of <code>pwd # 5</code> though!</p>\n"}], "owner": {"reputation": 79, "user_id": 11178540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dc6c0a17f6433eaec24eb682134bf68?s=128&d=identicon&r=PG&f=1", "display_name": "poppinMartinellis", "link": "https://stackoverflow.com/users/11178540/poppinmartinellis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4609, "favorite_count": 0, "accepted_answer_id": 56031268, "answer_count": 1, "score": 1, "last_activity_date": 1557868205, "creation_date": 1557267221, "last_edit_date": 1557868205, "question_id": 56031104, "link": "https://stackoverflow.com/questions/56031104/the-cd-command-in-c-and-use-of-chdir", "title": "The cd command in C and use of chdir()", "body": "<p>I'm tasked with programming the linux <code>cd</code> command in C. I thought this would be fairly trivial by using the <code>chdir()</code> method, but my directories aren't changing. What's interesting is that the return status of chdir() is 0, not -1, meaning chdir() has not failed. Here are the two cases where I'm using <code>chdir()</code>:</p>\n\n<p>1.</p>\n\n<pre><code>    char *dir = getenv(\"HOME\");   // Here dir equals the home environment.\n    int ret = chdir(dir);\n\n    printf(\"chdir returned %d.\\n\", ret);\n</code></pre>\n\n<p><code>ret</code> returns 1.</p>\n\n<p>2.</p>\n\n<pre><code>    int ret = chdir(dir);   // Here dir equals the user's input.\n\n    printf(\"chdir returned %d.\\n\", ret);\n</code></pre>\n\n<p><code>ret</code> returns 1 if the directory exists in my path. </p>\n\n<p>Am I using <code>chdir()</code> wrong? I can't seem to find an answer for this anywhere. Any help would be much appreciated.</p>\n"}, {"tags": ["c", "segmentation-fault"], "comments": [{"owner": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "edited": false, "score": 6, "creation_date": 1557265494, "post_id": 56030786, "comment_id": 98705234, "body": "Check the return values of <code>fopen</code>, <code>fseek</code>"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1557265770, "post_id": 56030786, "comment_id": 98705319, "body": "Seems like a good time to <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">learn how to debug your programs</a>. Especially how to use a debugger to catch crashes &quot;in action&quot; to see where in <i>your</i> code they happen, and then examine relevant variables and their values."}, {"owner": {"reputation": 1931, "user_id": 3696914, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/oLaiN.png?s=128&g=1", "display_name": "Edenia", "link": "https://stackoverflow.com/users/3696914/edenia"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1557266053, "post_id": 56030786, "comment_id": 98705402, "body": "@Someprogrammerdude or, the simpler way, printf counter (possibly with some delay) before and after every line that could cause a crash and see the last value printed."}, {"owner": {"reputation": 1931, "user_id": 3696914, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/oLaiN.png?s=128&g=1", "display_name": "Edenia", "link": "https://stackoverflow.com/users/3696914/edenia"}, "edited": false, "score": 0, "creation_date": 1557266141, "post_id": 56030786, "comment_id": 98705426, "body": "OP: <code>long num_students = size &#47; sizeof(struct student);</code> what the hell?"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "reply_to_user": {"reputation": 1931, "user_id": 3696914, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/oLaiN.png?s=128&g=1", "display_name": "Edenia", "link": "https://stackoverflow.com/users/3696914/edenia"}, "edited": false, "score": 3, "creation_date": 1557266203, "post_id": 56030786, "comment_id": 98705435, "body": "@Edenia What about it? But the file should be opened in binary mode."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 1931, "user_id": 3696914, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/oLaiN.png?s=128&g=1", "display_name": "Edenia", "link": "https://stackoverflow.com/users/3696914/edenia"}, "edited": false, "score": 0, "creation_date": 1557266241, "post_id": 56030786, "comment_id": 98705444, "body": "@Edenia In the shown code, the only reasonable possibility of a crash is <code>fopen</code> failing and then passing a null pointer to <code>fseek</code>. We can&#39;t tell for <i>certain</i> (which is why debugging is needed) but since there&#39;s no actual reading of the file that can&#39;t be a cause."}, {"owner": {"reputation": 1931, "user_id": 3696914, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/oLaiN.png?s=128&g=1", "display_name": "Edenia", "link": "https://stackoverflow.com/users/3696914/edenia"}, "edited": false, "score": 1, "creation_date": 1557266294, "post_id": 56030786, "comment_id": 98705454, "body": "It has already been said. Many times: Check return values of all functions, especially <code>fopen</code>. Here every function can return error."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "reply_to_user": {"reputation": 1931, "user_id": 3696914, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/oLaiN.png?s=128&g=1", "display_name": "Edenia", "link": "https://stackoverflow.com/users/3696914/edenia"}, "edited": false, "score": 0, "creation_date": 1557266307, "post_id": 56030786, "comment_id": 98705460, "body": "@Edenia How is that simpler when you can literally just look at the stack trace of a crash and see exactly what happened?"}, {"owner": {"reputation": 1931, "user_id": 3696914, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/oLaiN.png?s=128&g=1", "display_name": "Edenia", "link": "https://stackoverflow.com/users/3696914/edenia"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1557266346, "post_id": 56030786, "comment_id": 98705474, "body": "@melpomene Not everyone likes to use debugger and read stack traces. Use whatever suits you."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1557266349, "post_id": 56030786, "comment_id": 98705476, "body": "Are there platforms that don&#39;t support <code>stat()</code> but do support <code>SEEK_END</code> in binary mode (which C doesn&#39;t require)?"}, {"owner": {"reputation": 1931, "user_id": 3696914, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/oLaiN.png?s=128&g=1", "display_name": "Edenia", "link": "https://stackoverflow.com/users/3696914/edenia"}, "edited": false, "score": 0, "creation_date": 1557266490, "post_id": 56030786, "comment_id": 98705514, "body": "Setting the file position indicator to end-of-file, as with <code>fseek(file, 0, SEEK_END)</code>, has undefined behavior for a binary stream (because of possible trailing null characters) or for any stream with state-dependent encoding that does not assuredly end in the initial shift state."}, {"owner": {"reputation": 1931, "user_id": 3696914, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/oLaiN.png?s=128&g=1", "display_name": "Edenia", "link": "https://stackoverflow.com/users/3696914/edenia"}, "edited": false, "score": 0, "creation_date": 1557266521, "post_id": 56030786, "comment_id": 98705520, "body": "-quoted from C11 standard n1517"}, {"owner": {"reputation": 1931, "user_id": 3696914, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/oLaiN.png?s=128&g=1", "display_name": "Edenia", "link": "https://stackoverflow.com/users/3696914/edenia"}, "edited": false, "score": 0, "creation_date": 1557266679, "post_id": 56030786, "comment_id": 98705551, "body": "It also depends on the contents of the file, which are not presented here. I&#39;d also check value of <code>size</code>"}, {"owner": {"reputation": 21, "user_id": 11466936, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab618c358fa0433daedf06cc34275c73?s=128&d=identicon&r=PG&f=1", "display_name": "lstanford53", "link": "https://stackoverflow.com/users/11466936/lstanford53"}, "edited": false, "score": 0, "creation_date": 1557267037, "post_id": 56030786, "comment_id": 98705633, "body": "I changed the &quot;r&quot; to a &quot;a&quot; and it works fine now. Guess I&#39;ll just go with that."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1557267148, "post_id": 56030786, "comment_id": 98705663, "body": "That&#39;s a <i>bad</i> solution. Read e.g. <a href=\"https://en.cppreference.com/w/c/io/fopen\" rel=\"nofollow noreferrer\">this <code>fopen</code> reference</a>, especially about the difference between the <code>&quot;r&quot;</code> and <code>&quot;a&quot;</code> options, and what happens if the file doesn&#39;t exist. That should help you understand why using the <i>append</i> option make it seem to work."}, {"owner": {"reputation": 21, "user_id": 11466936, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab618c358fa0433daedf06cc34275c73?s=128&d=identicon&r=PG&f=1", "display_name": "lstanford53", "link": "https://stackoverflow.com/users/11466936/lstanford53"}, "edited": false, "score": 0, "creation_date": 1557267380, "post_id": 56030786, "comment_id": 98705718, "body": "Gotcha, I&#39;ll be sure to check that out. Thanks for the info."}, {"owner": {"reputation": 1439, "user_id": 5196093, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ovj7.png?s=128&g=1", "display_name": "Ray", "link": "https://stackoverflow.com/users/5196093/ray"}, "reply_to_user": {"reputation": 1931, "user_id": 3696914, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/oLaiN.png?s=128&g=1", "display_name": "Edenia", "link": "https://stackoverflow.com/users/3696914/edenia"}, "edited": false, "score": 0, "creation_date": 1557281851, "post_id": 56030786, "comment_id": 98708356, "body": "@Edenia printf debugging is fine if that&#39;s your preference, but be sure you always put an explicit fflush call after each line, or the program might crash while the last successful line of output is still in the buffer, thus making it seem as though it crashed earlier than it did."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1566081857, "post_id": 56030786, "comment_id": 101545078, "body": "@Istanford53: you can accept one of the answers by clicking on the grey checkmark below its score"}], "answers": [{"tags": [], "owner": {"reputation": 1931, "user_id": 3696914, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/oLaiN.png?s=128&g=1", "display_name": "Edenia", "link": "https://stackoverflow.com/users/3696914/edenia"}, "is_accepted": false, "score": 1, "last_activity_date": 1557330352, "last_edit_date": 1557330352, "creation_date": 1557319109, "answer_id": 56041020, "question_id": 56030786, "link": "https://stackoverflow.com/questions/56030786/segmentation-fault-while-reading-file-in-c/56041020#56041020", "title": "Segmentation Fault While Reading File in C", "body": "<p>You don't have to mark my answer as accepted, just want to inspire people to write code so that it is readable and safe. Don't be lazy to write code like this where quality is a factor.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n\n#include &lt;sys/stat.h&gt;\n\nstruct student /* Magic numbers everywhere */\n{\n    char first[30];\n    char last[30];\n    char ssn[9];\n\n};\n\n\n\n\nvoid* handle_nullptr_error (void* ptr, char *action, int code)\n{\n    if(ptr == NULL)\n    {\n        fprintf(stderr, \"Failed to %s\\n\", action);\n\n        exit(code);\n    }\n\n    printf(\"Succeeded to %s\\n\", action);\n\n    return ptr;\n}\n\nint handle_nonzero_error (int val, char *action, int code)\n{\n    if(val != 0)\n    {\n        fprintf(stderr, \"Failed to %s\\n\", action);\n\n        exit(code);\n    }\n\n    printf(\"Succeeded to %s\\n\", action);\n\n    return val;\n}\n\nint handle_negval_error (int val, char *action, int code)\n{\n    if(val &lt; 0)\n    {\n        fprintf(stderr, \"Failed to %s\\n\", action);\n\n        exit(code);\n    }\n\n    printf(\"Succeeded to %s\\n\", action);\n\n    return val;\n}\n\n\n\n\n/** This function is not guaranteed to be portable and work (but it will at least fail properly),\n * because not all systems and/or library implementations support `SEEK_END` in files\n * opened in text mode, as specified by @mode\n * Moreover, in binary mode it will behave in an undefined manner, because different systems\n * may store files data completely differently. In most cases it will succeed, just don't\n * write code that crashes if not.\n */\nlong int get_file_charcount (const char *filename, char* mode)\n{\n    FILE*       fp      = NULL;\n    long int    fpSize  = 0L;\n\n    /* Alignment for complicated function calls (for e.g where functions are passed as arguments) */\n    fp = handle_nullptr_error       (fopen(filename, mode),     \"open file.\",           1);\n\n    (void)handle_nonzero_error      (fseek(fp, 0, SEEK_END),    \"seek end position.\",   2);\n\n    fpSize = handle_negval_error    (ftell(fp),                 \"tell position.\",       3);\n\n    fclose(fp); /* - May fail, as well */\n\n    return fpSize;\n}\n\n/** This function depends on POSIX headers and it is unix-conformant, although there are still\n * some exceptions.\n *\n * Note that the value returned is the length of the contents of the symbolic link,\n * and does not count any trailing null pads. The value is ought to be system-specific.\n */\n_off64_t get_file_size (const char *filename)\n{\n    struct stat st = {0};\n\n    (void)handle_negval_error(stat(filename, &amp;st), \"get file size.\", (-1));\n\n    return st.st_size;\n}\n\n/** A validation function should first determine whether file's size is\n * actually dividable by `sizeof(struct STUDENT_DESCRIPTION);`.\n *\n * Further more you can use `get_file_size()` as an alternative to\n * `get_file_charcount()`. In the latter case, make sure you to specify the\n * appropriate mode, \"r\" for text files and \"rb\" for binary files.\n */\nvoid make_arrays ()\n{\n    long int    size            = get_file_charcount(\"myfile.txt\", \"r\");\n    long int    num_students    = size / sizeof(struct STUDENT_DESCRIPTION);\n\n    printf(\"size of file: %ld\\n\", size);\n\n    printf(\"There are %ld students in the file\", num_students);\n}\n\n\n\n\nint main (void)\n{\n    make_arrays();\n\n    return EXIT_SUCCESS;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 2, "last_activity_date": 1560075160, "last_edit_date": 1560075160, "creation_date": 1557320425, "answer_id": 56041416, "question_id": 56030786, "link": "https://stackoverflow.com/questions/56030786/segmentation-fault-while-reading-file-in-c/56041416#56041416", "title": "Segmentation Fault While Reading File in C", "body": "<p>The segmentation fault might be caused by <code>fopen</code> failing to open the file.</p>\n\n<p>You should always test for such failures and exit with an informative message.</p>\n\n<p>Also note that, if the file is indeed binary, it should be open in binary mode to avoid end of line translation:</p>\n\n<pre><code>FILE *fp = fopen(\"students.db\", \"rb\");\n</code></pre>\n\n<p>Also change the prototype for <code>main</code> to <code>int main(int argc, char *argv[])</code> or simply <code>int main()</code>. There are too many stars in <code>char **argv[]</code>.</p>\n"}], "owner": {"reputation": 21, "user_id": 11466936, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab618c358fa0433daedf06cc34275c73?s=128&d=identicon&r=PG&f=1", "display_name": "lstanford53", "link": "https://stackoverflow.com/users/11466936/lstanford53"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 222, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1560075160, "creation_date": 1557265018, "last_edit_date": 1557320483, "question_id": 56030786, "link": "https://stackoverflow.com/questions/56030786/segmentation-fault-while-reading-file-in-c", "title": "Segmentation Fault While Reading File in C", "body": "<p>I am still very new to the c language and I am playing with reading files for the first time.  I had similar code to this code which used to run perfectly fine but now I am running into issues.  I  keep getting the error <code>Segmentation fault (core dumped)</code> every time I try to run this program. </p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n\nstruct student {\n    char first[30];\n    char last[30];\n    char ssn[9];\n};\n\nvoid make_arrays() {\n    FILE *fp = fopen(\"students.db\", \"r\");\n    fseek(fp, 0, SEEK_END);\n    long size = ftell(fp);\n    fseek(fp, 0, SEEK_SET);\n\n    long num_students = size / sizeof(struct student);\n    printf(\"There are %ld students in the file\", num_students);\n    fclose(fp);\n}\n\nint main(int argc, char **argv[]) {\n    make_arrays();\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "multithreading", "sockets", "tcp"], "comments": [{"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 2, "creation_date": 1557265107, "post_id": 56030716, "comment_id": 98705126, "body": "Allow each thread to operate independently of each other. The sensor reading thread should not need to interact with the client request thread."}, {"owner": {"reputation": 1931, "user_id": 3696914, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/oLaiN.png?s=128&g=1", "display_name": "Edenia", "link": "https://stackoverflow.com/users/3696914/edenia"}, "edited": false, "score": 2, "creation_date": 1557265375, "post_id": 56030716, "comment_id": 98705192, "body": "Are you sure it needs to &quot;immediately&quot; make the transmission? Because everything up to 100ms can be considered &quot;immediate&quot; for the human eye. <code>while(1)</code> is a bad practice, make an obvious exit-condition, cover all the ugliness in higher level utilities so that the problem &quot;pops up&quot;. Generally you can use <code>select()</code>-like functions to query as to whether there is data available. In my recent applications I actually used get_available_bytes sort of function. Consider your networking architecture very carefully."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1557265379, "post_id": 56030716, "comment_id": 98705194, "body": "Note that a bad network connection could lead to round-trip times longer than 10ms. Do you really need to deliver <i>all</i> sensor packets? Is it okay if some are dropped or delayed or out of order (and can be dropped by the receiver)? Then consider using UDP instead of TCP, as then you can just send the sensor packet and don&#39;t have to wait for replies."}, {"owner": {"reputation": 1931, "user_id": 3696914, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/oLaiN.png?s=128&g=1", "display_name": "Edenia", "link": "https://stackoverflow.com/users/3696914/edenia"}, "edited": false, "score": 0, "creation_date": 1557265735, "post_id": 56030716, "comment_id": 98705308, "body": "The socket input queue IS a buffer, you can queue data there and receive in a thread, immediately when data is available (or delayed). Just make sure you header your packets so that the receiver knows what to expect."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 2, "creation_date": 1557267151, "post_id": 56030716, "comment_id": 98705664, "body": "<code>write( newsockfd, buffer, strlen(buffer) )</code> is also problematic, as TCP connections are streams, with no preservation of packet boundaries.  If you&#39;re sending every 10 ms, and something happens over the connection, packets could get coalesced before they&#39;re read by the receiver and the data from multiple packets merged into one <code>read()</code>.  Packets can be merged if nothing bad happens.  And the string can be split into multiple packets, too."}, {"owner": {"reputation": 1931, "user_id": 3696914, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/oLaiN.png?s=128&g=1", "display_name": "Edenia", "link": "https://stackoverflow.com/users/3696914/edenia"}, "edited": false, "score": 1, "creation_date": 1557267410, "post_id": 56030716, "comment_id": 98705728, "body": "Generally some of the best practices are to never send more frequent than you receive, always check send and receive values, always receive fixed-size packet that tells you at least two things ID and size of data to expect and perhaps use a queue that schedules sender&#39;s data in a predictable manner. You can have blocking receive (note timeouts) in thread or thread that calls async recv command when there is data available (see for e.g <code>select()</code>)"}, {"owner": {"reputation": 19267, "user_id": 801894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67f2ccd17aa6fd622152ad88fc2ae784?s=128&d=identicon&r=PG", "display_name": "Solomon Slow", "link": "https://stackoverflow.com/users/801894/solomon-slow"}, "edited": false, "score": 1, "creation_date": 1557267663, "post_id": 56030716, "comment_id": 98705798, "body": "I can understand reasons why it might be important to sample a sensor at precise, 10ms intervals; but I would never attempt to <i>send</i> the data over an internet connection on such a tight schedule. I would have one thread add a new sensor reading to a circular buffer every 10ms, and I would have another thread that maybe waits for some minimum number of readings to accumulate, then takes all the readings that are available in the buffer, then blasts them out together in a single message."}, {"owner": {"reputation": 19267, "user_id": 801894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67f2ccd17aa6fd622152ad88fc2ae784?s=128&d=identicon&r=PG", "display_name": "Solomon Slow", "link": "https://stackoverflow.com/users/801894/solomon-slow"}, "edited": false, "score": 0, "creation_date": 1557267737, "post_id": 56030716, "comment_id": 98705814, "body": "If my client told me, &quot;No, you must transmit one reading every 10ms,&quot; then I would respond, &quot;OK, that means we won&#39;t be using the internet. What other means of communication did you have in mind?&quot;"}, {"owner": {"reputation": 1931, "user_id": 3696914, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/oLaiN.png?s=128&g=1", "display_name": "Edenia", "link": "https://stackoverflow.com/users/3696914/edenia"}, "reply_to_user": {"reputation": 19267, "user_id": 801894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67f2ccd17aa6fd622152ad88fc2ae784?s=128&d=identicon&r=PG", "display_name": "Solomon Slow", "link": "https://stackoverflow.com/users/801894/solomon-slow"}, "edited": false, "score": 0, "creation_date": 1557267789, "post_id": 56030716, "comment_id": 98705825, "body": "@SolomonSlow That being said if he is looking for something close to real time data streaming, maybe check up RTMP. If it is something that requires immediate response I would never relay on internet too. In most cases a well-designed TCP protocol will do, but I don&#39;t know his target use case."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 19267, "user_id": 801894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67f2ccd17aa6fd622152ad88fc2ae784?s=128&d=identicon&r=PG", "display_name": "Solomon Slow", "link": "https://stackoverflow.com/users/801894/solomon-slow"}, "edited": false, "score": 0, "creation_date": 1557268026, "post_id": 56030716, "comment_id": 98705891, "body": "@SolomonSlow Easiest solution was mentioned above:  fire off UDP packets, with a one-up counter to ensure the latest packet is known.  An unsigned 64-bit counter should work - I&#39;d love to be around to fix the bug should it ever roll over.  Have the receiver set an alarm that goes off if no packets are received in whatever time deemed &quot;too long&quot;, and use QoS settings on the network to help prioritize packet delivery.  Because if it&#39;s that important, you&#39;d better control the entire data path."}, {"owner": {"reputation": 1931, "user_id": 3696914, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/oLaiN.png?s=128&g=1", "display_name": "Edenia", "link": "https://stackoverflow.com/users/3696914/edenia"}, "edited": false, "score": 0, "creation_date": 1557268283, "post_id": 56030716, "comment_id": 98705953, "body": "An example implementation of QoS is an async atomic singly-linked list with a sort function, counter and priority integer, alongside recursive threaded send and recursive threaded receive. I personally use GAsyncQueue and threaded polling."}, {"owner": {"reputation": 201, "user_id": 10830052, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-M3ArCplGG9U/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcbd3zblfWbQUwf0cxmH9SpiW8hLaA/mo/photo.jpg?sz=128", "display_name": "Ting Wang", "link": "https://stackoverflow.com/users/10830052/ting-wang"}, "reply_to_user": {"reputation": 1931, "user_id": 3696914, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/oLaiN.png?s=128&g=1", "display_name": "Edenia", "link": "https://stackoverflow.com/users/3696914/edenia"}, "edited": false, "score": 0, "creation_date": 1557320931, "post_id": 56030716, "comment_id": 98725023, "body": "@Edenia Yeah, I&#39;m doing the realtime plotting. I use c/c++ to read sensor data and plot it with python.  All these codes are on the same raspberry Pi. The reason I used TCP socket is that I need to send data from c file to python. I&#39;m not sure if there are better ways to do it rather than send data by the socket."}, {"owner": {"reputation": 1931, "user_id": 3696914, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/oLaiN.png?s=128&g=1", "display_name": "Edenia", "link": "https://stackoverflow.com/users/3696914/edenia"}, "edited": false, "score": 0, "creation_date": 1557321760, "post_id": 56030716, "comment_id": 98725557, "body": "@TingWang Is there any particular reason you want to use Python and not just C for everything, which would have been better for performance and portability? I&#39;ve only programmed on Arduino, which is much more lacking in processing power than the Raspberry Pi, but from what I understood you want to achieve IPC between two processes. If I did not understand you correctly you want to use C code alongside Python or the opposite. If that&#39;s the case check out Python extension modules, which can be used to include C code. I have no clue about Python development on Raspberry Pi though."}, {"owner": {"reputation": 1931, "user_id": 3696914, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/oLaiN.png?s=128&g=1", "display_name": "Edenia", "link": "https://stackoverflow.com/users/3696914/edenia"}, "edited": false, "score": 0, "creation_date": 1557322191, "post_id": 56030716, "comment_id": 98725852, "body": "For IPC, using sockets on the LAN is one way to do it. However there is much more going on, than what is needed. Let alone the packet&#39;s protocol header overhead, the kernel resources involved, the subsystem which manages the transport layer interface. A binary file direct I/O is another easy way to achieve IPC. In most cases it may be slower than socket io, but not always. If file already exists on disk, is not large, is binary it is fairly competitive even faster."}, {"owner": {"reputation": 201, "user_id": 10830052, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-M3ArCplGG9U/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcbd3zblfWbQUwf0cxmH9SpiW8hLaA/mo/photo.jpg?sz=128", "display_name": "Ting Wang", "link": "https://stackoverflow.com/users/10830052/ting-wang"}, "reply_to_user": {"reputation": 1931, "user_id": 3696914, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/oLaiN.png?s=128&g=1", "display_name": "Edenia", "link": "https://stackoverflow.com/users/3696914/edenia"}, "edited": false, "score": 0, "creation_date": 1557322459, "post_id": 56030716, "comment_id": 98726023, "body": "@Edenia  The reason I used python is that I designed a GUI with PyQt4 for real time plotting. But you know python cannot do very fast and precise sampling (e.g.   &gt; 200 Hz), so, I used c/c++ to do it. Then I send data from c to python by tcp socket. I know it&#39;s not a good way to do it. But I don&#39;t know a better solution. The client wants everything in a raspberry Pi."}, {"owner": {"reputation": 1931, "user_id": 3696914, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/oLaiN.png?s=128&g=1", "display_name": "Edenia", "link": "https://stackoverflow.com/users/3696914/edenia"}, "edited": false, "score": 0, "creation_date": 1557322732, "post_id": 56030716, "comment_id": 98726202, "body": "@TingWang I suspected it must be the GUI. Python has very rich GUI toolkits. But you could&#39;ve done that in C with GTK+ as well or with C++ Qt. Anyway 3rd IPC method I can think of is message queuing if supported by system API and of course pipes."}, {"owner": {"reputation": 201, "user_id": 10830052, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-M3ArCplGG9U/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcbd3zblfWbQUwf0cxmH9SpiW8hLaA/mo/photo.jpg?sz=128", "display_name": "Ting Wang", "link": "https://stackoverflow.com/users/10830052/ting-wang"}, "reply_to_user": {"reputation": 1931, "user_id": 3696914, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/oLaiN.png?s=128&g=1", "display_name": "Edenia", "link": "https://stackoverflow.com/users/3696914/edenia"}, "edited": false, "score": 0, "creation_date": 1557322984, "post_id": 56030716, "comment_id": 98726371, "body": "@Edenia I&#39;ll look into it, thank you!"}, {"owner": {"reputation": 201, "user_id": 10830052, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-M3ArCplGG9U/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcbd3zblfWbQUwf0cxmH9SpiW8hLaA/mo/photo.jpg?sz=128", "display_name": "Ting Wang", "link": "https://stackoverflow.com/users/10830052/ting-wang"}, "reply_to_user": {"reputation": 1931, "user_id": 3696914, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/oLaiN.png?s=128&g=1", "display_name": "Edenia", "link": "https://stackoverflow.com/users/3696914/edenia"}, "edited": false, "score": 0, "creation_date": 1557361243, "post_id": 56030716, "comment_id": 98742412, "body": "@Edenia Hi Edenia, I tried select and poll, then I realised that if there is a tcp socket connection, both these 2 functions will stop timing. Unless I close the socket connection. That&#39;s not good. Because I cannot open and close a connection each time the client wants to send request to the server. Because the request frequency is 20 Hz. The open and close operation will decrease the frequency. Maybe I should try binary file direct I/O you mentioned above."}, {"owner": {"reputation": 1931, "user_id": 3696914, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/oLaiN.png?s=128&g=1", "display_name": "Edenia", "link": "https://stackoverflow.com/users/3696914/edenia"}, "edited": false, "score": 0, "creation_date": 1557362667, "post_id": 56030716, "comment_id": 98742663, "body": "@TingWang It seems to me that you misunderstand how those functions work. Did you read their man pages? Sometimes I have trouble understanding even though I read it, because of language barriers and stuff (I am not english myself). Now I don&#39;t use much winsock (or unisock) - I use GSocket and other higher level APIs. The GSocket wrapper to <code>select()</code> will block until timeout is reached or input/output (whatever I specify) streams are readable/writable (videlicet if there is data). I find it for much more convenient to query pending bytes (see <code>ioctl</code>), because of the nature of my protocol."}, {"owner": {"reputation": 1931, "user_id": 3696914, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/oLaiN.png?s=128&g=1", "display_name": "Edenia", "link": "https://stackoverflow.com/users/3696914/edenia"}, "edited": false, "score": 0, "creation_date": 1557362971, "post_id": 56030716, "comment_id": 98742720, "body": "Just get pending bytes in your receiver thread and if there are &gt; 0 bytes recv data. If you are sending fixed-size packets every time it&#39;s easy just check if pending bytes <code>== sizeof(struct packet)</code> and recv that many bytes."}, {"owner": {"reputation": 1931, "user_id": 3696914, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/oLaiN.png?s=128&g=1", "display_name": "Edenia", "link": "https://stackoverflow.com/users/3696914/edenia"}, "edited": false, "score": 0, "creation_date": 1557363443, "post_id": 56030716, "comment_id": 98742822, "body": "I would say neither methods are absolutely 100% reliable. They will work, but every system is prone to errors such as race conditions,kernel panics and so on. Some operations predisposes OS to fail more than other. It is really of essence that you design your program in such a way that this is avoided as much as possible and that if something fails, it is expected and it can recover. The latter is especially important for file io, where checking return values is mandatory and proper handling may prevent race conditions."}, {"owner": {"reputation": 1931, "user_id": 3696914, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/oLaiN.png?s=128&g=1", "display_name": "Edenia", "link": "https://stackoverflow.com/users/3696914/edenia"}, "edited": false, "score": 0, "creation_date": 1557363896, "post_id": 56030716, "comment_id": 98742899, "body": "Alternatively see named pipes, D-BUS and this: <a href=\"https://www.engineersgarage.com/embedded/raspberry-pi/how-to-send-message-between-processes-using-signal-in-raspberry-pi\" rel=\"nofollow noreferrer\">engineersgarage.com/embedded/raspberry-pi/&hellip;</a> because there may be easier and more reliable ways to achieve this. Although I wouldn&#39;t use C(++) and Python for something like this or for everything for that matter anyway."}, {"owner": {"reputation": 201, "user_id": 10830052, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-M3ArCplGG9U/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcbd3zblfWbQUwf0cxmH9SpiW8hLaA/mo/photo.jpg?sz=128", "display_name": "Ting Wang", "link": "https://stackoverflow.com/users/10830052/ting-wang"}, "edited": false, "score": 0, "creation_date": 1557521142, "post_id": 56030716, "comment_id": 98807512, "body": "@Edinia Thank you so much for all these helps. I really appreciate it."}], "answers": [{"comments": [{"owner": {"reputation": 201, "user_id": 10830052, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-M3ArCplGG9U/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcbd3zblfWbQUwf0cxmH9SpiW8hLaA/mo/photo.jpg?sz=128", "display_name": "Ting Wang", "link": "https://stackoverflow.com/users/10830052/ting-wang"}, "edited": false, "score": 0, "creation_date": 1557328559, "post_id": 56031563, "comment_id": 98729911, "body": "Hi immibis, quick question- if the socket gets the data before the 5 milliseconds is out, will the poll() continue until it reaches 5 milliseconds or start a new counting?"}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "reply_to_user": {"reputation": 201, "user_id": 10830052, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-M3ArCplGG9U/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcbd3zblfWbQUwf0cxmH9SpiW8hLaA/mo/photo.jpg?sz=128", "display_name": "Ting Wang", "link": "https://stackoverflow.com/users/10830052/ting-wang"}, "edited": false, "score": 0, "creation_date": 1557352081, "post_id": 56031563, "comment_id": 98740392, "body": "Neither, it returns. You can also use ppoll if you need a more precise timeout."}], "tags": [], "owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "is_accepted": true, "score": 2, "last_activity_date": 1557270891, "creation_date": 1557270891, "answer_id": 56031563, "question_id": 56030716, "link": "https://stackoverflow.com/questions/56030716/how-can-i-make-the-program-read-sensors-every-10-milliseconds-while-the-tcp-serv/56031563#56031563", "title": "How can I make the program read sensors every 10 milliseconds while the tcp server is waiting for data", "body": "<p>You can use <a href=\"https://linux.die.net/man/2/select\" rel=\"nofollow noreferrer\"><code>select</code></a> or <a href=\"https://linux.die.net/man/2/poll\" rel=\"nofollow noreferrer\"><code>poll</code></a> to wait for data to arrive, with a timeout.</p>\n\n<p>For instance, if you need to read the sensor 5 milliseconds from now, you can call <code>poll</code> or <code>select</code> with a 5 millisecond timeout. If the socket receives data, it will return immediately and tell you. Otherwise, it will return after 5 milliseconds and you'll know there is no data.</p>\n\n<p>Example with <code>poll</code>:</p>\n\n<pre><code>struct pollfd pollfd = {.fd = socket_fd, .events = POLLIN};\nint err = poll(&amp;pollfd, 1, milliseconds_timeout);\n// error check here; if err is negative then the error code is in errno\nif (pollfd.revents &amp; POLLIN) {\n    // Socket received data\n}\n// Otherwise it didn't.\n// Note that if data was received, it might not be time to read the sensors yet.\n// You should keep poll()ing until it's the right time to read the sensors, using clock_gettime to check the time.\n</code></pre>\n"}], "owner": {"reputation": 201, "user_id": 10830052, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-M3ArCplGG9U/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcbd3zblfWbQUwf0cxmH9SpiW8hLaA/mo/photo.jpg?sz=128", "display_name": "Ting Wang", "link": "https://stackoverflow.com/users/10830052/ting-wang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 304, "favorite_count": 0, "accepted_answer_id": 56031563, "answer_count": 1, "score": 0, "last_activity_date": 1557270891, "creation_date": 1557264638, "question_id": 56030716, "link": "https://stackoverflow.com/questions/56030716/how-can-i-make-the-program-read-sensors-every-10-milliseconds-while-the-tcp-serv", "title": "How can I make the program read sensors every 10 milliseconds while the tcp server is waiting for data", "body": "<p>My program need to read sensor data every 10 milliseconds, and send it to client by TCP socket. The program is written in C language. The tcp server and sensor reading codes are in the same c file. The server doesn't send data periodically. Instead, it waits for the data request (every 50 milliseconds) from the client. Once the server receives the request, it sends data to client. </p>\n\n<p>My problem is that I need to read sensors every 10 milliseconds and save it in a buffer. Once the server get the request, send the sensor data in the buffer to client. But when tcp server is waiting for the request, the whole program stuck at the read function:</p>\n\n<pre><code>n = read(newsockfd,buffer,31)\n</code></pre>\n\n<p>Then, I can't read sensors.</p>\n\n<p>I tried to use threading for sensor reading and tcp server. It works for reading sensors. But, if I add any usleep(), for example, 5 milliseconds in tcp server thread, it will take 5 milliseconds before sending data to the client. </p>\n\n<p>My program need the tcp server send data to client immediately after it receives the request. Meanwhile, read sensors every 10 milliseconds. Anyone has a better solution?</p>\n\n<p>The codes for tcp server and sensor reading are as follows:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;sys/types.h&gt; \n#include &lt;sys/socket.h&gt;\n#include &lt;netinet/in.h&gt;\n#include &lt;netdb.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;time.h&gt;\n\n#define MAX_SIZE 256\n#define SAMPLE_RATE \n\n\n\nvoid read_sensor(void) {\n    printf(\"read sensors\\n\");\n}\n\n\nint main() {\n\n     int sockfd, newsockfd, portno = 10000, clilen;\n     char buffer[MAX_SIZE];\n     struct sockaddr_in serv_addr, cli_addr;\n     int n;\n     int data;\n\n     printf( \"using port #%d\\n\", portno );\n\n     sockfd = socket(AF_INET, SOCK_STREAM, 0);\n     if (sockfd &lt; 0) \n         printf(\"ERROR opening socket\\n\");\n     bzero((char *) &amp;serv_addr, sizeof(serv_addr));\n\n     serv_addr.sin_family = AF_INET;\n     serv_addr.sin_addr.s_addr = INADDR_ANY;\n     serv_addr.sin_port = htons( portno );\n     if (bind(sockfd, (struct sockaddr *) &amp;serv_addr, sizeof(serv_addr)) &lt; 0) \n       error( const_cast&lt;char *&gt;( \"ERROR on binding\" ) );\n     listen(sockfd,5);\n     clilen = sizeof(cli_addr);\n\n     while (1) {\n        printf( \"waiting for new client...\\n\" );\n        if ( ( newsockfd = accept( sockfd, (struct sockaddr *) &amp;cli_addr, (socklen_t*) &amp;clilen) ) &lt; 0 )\n            printf(\"ERROR on accept\");\n        printf( \"opened new communication with client\\n\" );\n\n        clock_gettime(CLOCK_REALTIME, &amp;gettime_now);\n        start_time = gettime_now.tv_nsec;       //Get nS value\n        while (1) {\n             int n = 0;\n             if ( (n = read(newsockfd,buffer,31) ) &lt; 0 ) //read data\n                printf(\"ERROR reading from socket\");\n             buffer[n] = '\\0';\n\n             if (n &gt; 0)\n                printf(\"%s\\n\", buffer);\n             else {\n                break;             \n             }\n\n             if ( (n = write( newsockfd, buffer, strlen(buffer) ) ) &lt; 0 ) //send data\n                printf( \"ERROR writing to socket\\n\");\n             buffer[n] = '\\0';\n\n        }\n        close( newsockfd );\n     }\n\n\n     return 0; \n}\n</code></pre>\n"}, {"tags": ["mysql", "c", "user-defined-functions"], "comments": [{"owner": {"reputation": 149, "user_id": 11175208, "user_type": "registered", "profile_image": "https://graph.facebook.com/2283141461942567/picture?type=large", "display_name": "Ilya  Pakhmutov", "link": "https://stackoverflow.com/users/11175208/ilya-pakhmutov"}, "edited": false, "score": 0, "creation_date": 1557265327, "post_id": 56030546, "comment_id": 98705180, "body": "key = args-&gt;args[0];     value = args-&gt;args[1]; try using <code>strcpy</code> on those, as char* is not working that way, and string must be copied to the pointer"}, {"owner": {"reputation": 2255, "user_id": 3760899, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/6rmhM.jpg?s=128&g=1", "display_name": "Aditya Singh", "link": "https://stackoverflow.com/users/3760899/aditya-singh"}, "reply_to_user": {"reputation": 149, "user_id": 11175208, "user_type": "registered", "profile_image": "https://graph.facebook.com/2283141461942567/picture?type=large", "display_name": "Ilya  Pakhmutov", "link": "https://stackoverflow.com/users/11175208/ilya-pakhmutov"}, "edited": false, "score": 0, "creation_date": 1557299484, "post_id": 56030546, "comment_id": 98713244, "body": "Nope. Still doesn&#39;t work. Infact now adds more garbage values"}, {"owner": {"reputation": 149, "user_id": 11175208, "user_type": "registered", "profile_image": "https://graph.facebook.com/2283141461942567/picture?type=large", "display_name": "Ilya  Pakhmutov", "link": "https://stackoverflow.com/users/11175208/ilya-pakhmutov"}, "edited": false, "score": 0, "creation_date": 1557308933, "post_id": 56030546, "comment_id": 98718056, "body": "C function seems to work fine, except for memory leaks(that first two callocs provide), no garbage values are added in this function. Can you somehow look at what <code>res</code> is at the return point?"}, {"owner": {"reputation": 2255, "user_id": 3760899, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/6rmhM.jpg?s=128&g=1", "display_name": "Aditya Singh", "link": "https://stackoverflow.com/users/3760899/aditya-singh"}, "reply_to_user": {"reputation": 149, "user_id": 11175208, "user_type": "registered", "profile_image": "https://graph.facebook.com/2283141461942567/picture?type=large", "display_name": "Ilya  Pakhmutov", "link": "https://stackoverflow.com/users/11175208/ilya-pakhmutov"}, "edited": false, "score": 0, "creation_date": 1557310511, "post_id": 56030546, "comment_id": 98718965, "body": "I am not sure if I can do that. Maybe log it in a file."}, {"owner": {"reputation": 105038, "user_id": 1766831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ee974306d2def46eb69534fbcf95cc5?s=128&d=identicon&r=PG", "display_name": "Rick James", "link": "https://stackoverflow.com/users/1766831/rick-james"}, "edited": false, "score": 1, "creation_date": 1557543717, "post_id": 56030546, "comment_id": 98811317, "body": "Provide <code>SELECT HEX(concat_kv(...));</code>  That might help us see what the unprintables are."}], "answers": [{"comments": [{"owner": {"reputation": 105038, "user_id": 1766831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ee974306d2def46eb69534fbcf95cc5?s=128&d=identicon&r=PG", "display_name": "Rick James", "link": "https://stackoverflow.com/users/1766831/rick-james"}, "edited": false, "score": 0, "creation_date": 1557543849, "post_id": 56082967, "comment_id": 98811332, "body": "But how much space is allocated for <code>result</code>?  Might there be a buffer overrun?"}, {"owner": {"reputation": 18527, "user_id": 2331445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94bfb49e156193c0509c3a18e0f8923f?s=128&d=identicon&r=PG", "display_name": "Stephan Schlecht", "link": "https://stackoverflow.com/users/2331445/stephan-schlecht"}, "reply_to_user": {"reputation": 105038, "user_id": 1766831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ee974306d2def46eb69534fbcf95cc5?s=128&d=identicon&r=PG", "display_name": "Rick James", "link": "https://stackoverflow.com/users/1766831/rick-james"}, "edited": false, "score": 0, "creation_date": 1557560235, "post_id": 56082967, "comment_id": 98813488, "body": "Very good hint! As with any preallocated buffer, there is of course the danger of buffer overflows. MySQL reserves space for a maximum of 255 characters. I updated the answer. Also added a hint regarding the risk of memory leaks."}, {"owner": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "edited": false, "score": 0, "creation_date": 1557877709, "post_id": 56082967, "comment_id": 98910597, "body": "<a href=\"https://stackoverflow.com/a/6904517/8767209\">Use snprintf</a> instead of strcat.  You have an exploitable buffer overrun using strcat."}, {"owner": {"reputation": 18527, "user_id": 2331445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94bfb49e156193c0509c3a18e0f8923f?s=128&d=identicon&r=PG", "display_name": "Stephan Schlecht", "link": "https://stackoverflow.com/users/2331445/stephan-schlecht"}, "edited": false, "score": 0, "creation_date": 1557898825, "post_id": 56082967, "comment_id": 98914742, "body": "Take a look at the Example with Dynamic Memory Allocation. The MySQL call sequence is: concat_kv_init, concat_kv, concat_kv_deinit. In concat_kv_init the needed amount of data is allocated (<code>strlen(args-&gt;args[0]) + strlen(args-&gt;args[1]) + 2;</code>)."}], "tags": [], "owner": {"reputation": 18527, "user_id": 2331445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94bfb49e156193c0509c3a18e0f8923f?s=128&d=identicon&r=PG", "display_name": "Stephan Schlecht", "link": "https://stackoverflow.com/users/2331445/stephan-schlecht"}, "is_accepted": true, "score": 6, "last_activity_date": 1557560078, "last_edit_date": 1592644375, "creation_date": 1557512467, "answer_id": 56082967, "question_id": 56030546, "link": "https://stackoverflow.com/questions/56030546/mysql-udf-responds-with-garbage-characters-appended-to-returned-string/56082967#56082967", "title": "MySQL UDF responds with garbage characters appended to returned string", "body": "<p>Your concat_kv function should look more like so:</p>\n<pre><code>char *concat_kv(UDF_INIT *initid, UDF_ARGS *args, char *result, ulong *length, char *is_null, char *error) {\n    char *key = args-&gt;args[0];\n    char *value = args-&gt;args[1];\n    strcpy(result, key);\n    strcat(result, &quot; &quot;);\n    strcat(result, value);\n    *length = strlen(result);\n    return result;\n}\n</code></pre>\n<p>Some remarks:</p>\n<ul>\n<li><p>the result param should be used for the result</p>\n</li>\n<li><p>the length should be returned</p>\n</li>\n<li><p>the length should be <em>without</em> terminating null character, see here: <a href=\"https://dev.mysql.com/doc/refman/8.0/en/udf-return-values.html\" rel=\"noreferrer\">https://dev.mysql.com/doc/refman/8.0/en/udf-return-values.html</a></p>\n</li>\n<li><p>key and value are just used from args and copied via strcpy/strcat into result</p>\n</li>\n</ul>\n<p><strong>Demo</strong></p>\n<p><a href=\"https://i.stack.imgur.com/hPf96.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/hPf96.png\" alt=\"concat_kv in MySQL on Ubuntu\" /></a></p>\n<p><strong>Dynamic Memory Allocation</strong></p>\n<p>As already pointed out in the comments, there is a danger of a buffer overrun if the size of the preallocated buffer is exceeded.</p>\n<p><strong>Memory Leak</strong></p>\n<p>If we were to dynamically allocate memory in concat_kv(), we would introduce a memory leak, since memory is requested every time the user-defined function is called, and is never released again.</p>\n<p>The solution is to use the concat_kv_init() and concat_kv_deinit() functions, which are called by MySQL directly before and after the concat_kv() call.</p>\n<p>Here a quote from the MySQL documentation:</p>\n<blockquote>\n<p>MySQL passes a buffer to the xxx() function using the result parameter. This buffer is sufficiently long to hold 255 characters, which can be multibyte characters. The xxx() function can store the result in this buffer if it fits, in which case the return value should be a pointer to the buffer. If the function stores the result in a different buffer, it should return a pointer to that buffer.</p>\n<p>If your string function does not use the supplied buffer (for example, if it needs to return a string longer than 255 characters), you must allocate the space for your own buffer with malloc() in your xxx_init() function or your xxx() function and free it in your xxx_deinit() function.</p>\n</blockquote>\n<p>see <a href=\"https://dev.mysql.com/doc/refman/8.0/en/udf-return-values.html\" rel=\"noreferrer\">https://dev.mysql.com/doc/refman/8.0/en/udf-return-values.html</a></p>\n<p><strong>Example with Dynamic Memory Allocation</strong></p>\n<p>So if we can't guarantee that the size of the result is large then the preallocated buffer, we need to allocate the memory in concat_kv_init() and free it in concat_kv_deinit().</p>\n<pre><code>my_bool concat_kv_init(UDF_INIT *initid, UDF_ARGS *args, char *message) {\n    if(args-&gt;arg_count != 2 || args-&gt;arg_type[0] != STRING_RESULT || args-&gt;arg_type[1] != STRING_RESULT) {\n        strcpy(message, &quot;concat_kv(): Requires 2 string parameters: Key - Value.&quot;);\n        return 1;\n    }\n    ulong length = strlen(args-&gt;args[0]) + strlen(args-&gt;args[1]) + 2;\n    initid-&gt;ptr = (char *)malloc(length);\n    return 0;\n}\n\nchar *concat_kv(UDF_INIT *initid, UDF_ARGS *args, char *result, ulong *length, char *is_null, char *error) {\n    char *key = args-&gt;args[0];\n    char *value = args-&gt;args[1];\n    strcpy(initid-&gt;ptr, key);\n    strcat(initid-&gt;ptr, &quot; &quot;);\n    strcat(initid-&gt;ptr, value);\n    *length = strlen(initid-&gt;ptr);\n    return initid-&gt;ptr;\n}\n\nvoid concat_kv_deinit(UDF_INIT *initid) {\n    free(initid-&gt;ptr);\n    initid-&gt;ptr = NULL;\n}\n</code></pre>\n"}], "owner": {"reputation": 2255, "user_id": 3760899, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/6rmhM.jpg?s=128&g=1", "display_name": "Aditya Singh", "link": "https://stackoverflow.com/users/3760899/aditya-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 187, "favorite_count": 0, "accepted_answer_id": 56082967, "answer_count": 1, "score": 5, "last_activity_date": 1557560078, "creation_date": 1557263564, "question_id": 56030546, "link": "https://stackoverflow.com/questions/56030546/mysql-udf-responds-with-garbage-characters-appended-to-returned-string", "title": "MySQL UDF responds with garbage characters appended to returned string", "body": "<p>So I created a UDF that accepts 2 strings and concats them.</p>\n\n<p>My UDF: // concat_kv.c  </p>\n\n<pre><code>#include &lt;my_global.h&gt;\n#include &lt;my_sys.h&gt;\n#include &lt;mysql.h&gt;\n#include &lt;ctype.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n\ntypedef unsigned long ulong;\n\nmy_bool concat_kv_init(UDF_INIT *initid, UDF_ARGS *args, char *message) {\n    if(args-&gt;arg_count != 2 || args-&gt;arg_type[0] != STRING_RESULT || args-&gt;arg_type[1] != STRING_RESULT) {\n        strcpy(message, \"concat_kv(): Requires 2 string parameters: Key - Value.\");\n        return 1;\n    }\n    return 0;\n}\n\nchar *concat_kv(UDF_INIT *initid, UDF_ARGS *args, char *result, ulong *length, char *is_null, char *error) {\n    char *key = (char*)calloc(strlen(args-&gt;args[0]), sizeof(char));\n    char *value = (char*)calloc(strlen(args-&gt;args[1]), sizeof(char));\n    char *res = (char *)calloc(strlen(args-&gt;args[0]) + strlen(args-&gt;args[1]) + 2, sizeof(char));\n    int len = strlen(args-&gt;args[0]) + strlen(args-&gt;args[1]) + 2;\n    key = args-&gt;args[0];\n    value = args-&gt;args[1];\n    strcat(res, key);\n    strcat(res, \" \");\n    strcat(res, value);\n    res[len-1] = '\\0'; // Terminating character...\n    return res;\n}\n\nvoid concat_kv_deinit(UDF_INIT *initid) {\n}\n</code></pre>\n\n<p>Compiled the file as:  </p>\n\n<pre><code>gcc $(mysql_config --cflags) -shared concat_kv.c -o concat_kv.so  \n</code></pre>\n\n<p>Moved the <code>concat_kv.so</code> file to <code>/usr/lib/mysql/plugins/</code>.  </p>\n\n<p>Created the function in mysql as:  </p>\n\n<pre><code>CREATE FUNCTION concat_kv RETURNS STRING SONAME 'concat_kv.so';  \n</code></pre>\n\n<p>Then doing:  </p>\n\n<pre><code>SELECT concat_kv(\"Aditya\", \"Singh\") as conc;\n</code></pre>\n\n<p>Expected output:  </p>\n\n<pre><code>| conc |\n--------\n| \"Aditya Singh\" |\n</code></pre>\n\n<p>But getting unexpected output as: </p>\n\n<pre><code>mysql&gt; SELECT concat_kv(\"Aditya\", \"Singh\") as conc;\n+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n| conc \n|\n+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n| Aditya Singh            \ufffdT \n|+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n1 row in set (0.01 sec)\n</code></pre>\n\n<p>I am getting something unprintable after the concatinated string. Some garbage values are appended after the string.</p>\n"}, {"tags": ["c", "printf"], "comments": [{"owner": {"reputation": 480272, "user_id": 1968, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd630f72eef3790bfb4ef38d08c7f85?s=128&d=identicon&r=PG", "display_name": "Konrad Rudolph", "link": "https://stackoverflow.com/users/1968/konrad-rudolph"}, "edited": false, "score": 0, "creation_date": 1557262933, "post_id": 56030400, "comment_id": 98704405, "body": "What outputs did you expect?"}, {"owner": {"reputation": 22751, "user_id": 2399879, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UxMS5.jpg?s=128&g=1", "display_name": "Crowman", "link": "https://stackoverflow.com/users/2399879/crowman"}, "edited": false, "score": 2, "creation_date": 1557262966, "post_id": 56030400, "comment_id": 98704415, "body": "<code>sizeof</code> needs a <code>%zu</code> format specifier."}, {"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1557263186, "post_id": 56030400, "comment_id": 98704496, "body": "If you pass an argument of the wrong type to printf, then following args may not be aligned correctly."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1557263257, "post_id": 56030400, "comment_id": 98704530, "body": "Explain what output you expected instead and why."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1557263269, "post_id": 56030400, "comment_id": 98704536, "body": "Please correct the compiler warnings. Also, <code>sizeof(a+d)</code> will give the size of the intermediate computation type. In all your examples, the first argument will need <code>%f</code> and the second will need <code>%zu</code>."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 2, "creation_date": 1557263405, "post_id": 56030400, "comment_id": 98704584, "body": "You are producing undefined behavior by passing arguments to <code>printf()</code> that are mismatched with their corresponding formatting directives.  There is nothing to understand here, beyond that C makes no guarantees about what the program will do."}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1557263898, "post_id": 56030400, "comment_id": 98704748, "body": "@Weather Vane: <code>%lf</code> is perfectly acceptable for the <i>first</i> argument, and I&#39;d say <code>%lf</code> is even more appropriate here than <code>%f</code> (yes, I know that they are equivalent here)."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1557263951, "post_id": 56030400, "comment_id": 98704762, "body": "@AnT but it was not, it was <code>%d</code> in the answer as first posted. FFS."}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1557264027, "post_id": 56030400, "comment_id": 98704785, "body": "@Weather Vane: <code>%d</code> makes no sense, of course. I&#39;m just nothing that there&#39;s no need to replace <code>%lf</code> with <code>%f</code>."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1557264091, "post_id": 56030400, "comment_id": 98704808, "body": "@AnT sorry, I thought your comment was under the first (unedited) post of an answer, but anyway, the <code>%d</code> in the question is wrong."}], "answers": [{"comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1557263519, "post_id": 56030529, "comment_id": 98704624, "body": "It&#39;s undefined behaviour if the specifier is incorrect, regardless of the sizes of types"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1557263560, "post_id": 56030529, "comment_id": 98704645, "body": "The first format specifier to match <code>a + d</code> must be <code>%f</code>."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1557263646, "post_id": 56030529, "comment_id": 98704671, "body": "@WeatherVane it can be <code>%lf</code> or <code>%f</code> (both have the same definition)"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1557263666, "post_id": 56030529, "comment_id": 98704679, "body": "@M.M Yes, but not <code>%d</code> in the answer."}], "tags": [], "owner": {"reputation": 47115, "user_id": 235354, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/097d761861529df52a6800744f1074d2?s=128&d=identicon&r=PG", "display_name": "jspcal", "link": "https://stackoverflow.com/users/235354/jspcal"}, "is_accepted": false, "score": 1, "last_activity_date": 1557263700, "last_edit_date": 1557263700, "creation_date": 1557263492, "answer_id": 56030529, "question_id": 56030400, "link": "https://stackoverflow.com/questions/56030400/c-printf-int-and-double-same-resault-diffrent-assumes/56030529#56030529", "title": "C printf int and double same resault diffrent assumes", "body": "<p><code>printf</code> reads a certain number of bytes off the stack for each of the format specifiers you provide. The format specifiers must match the actual arguments or you can end up with arguments being partially read or reads going past the boundaries of the argument.</p>\n\n<p>In your first statement, the first argument is a <code>double</code> so <code>%f</code> is the correct format specifier. Using <code>%d</code> may result in <code>printf</code> attempting to read more bytes than were provided for that argument, leading to undefined behavior. The second argument is of type <code>size_t</code> which requires <code>%zu</code> or another valid specifier for that type.</p>\n"}], "owner": {"reputation": 9, "user_id": 9920741, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-i5PeUXkz8so/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq0eqpjW_A3tfEqrEkFiOdxxsMwWrw/mo/photo.jpg?sz=128", "display_name": "booda", "link": "https://stackoverflow.com/users/9920741/booda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "closed_date": 1557280525, "answer_count": 1, "score": -1, "last_activity_date": 1557280574, "creation_date": 1557262793, "last_edit_date": 1557262920, "question_id": 56030400, "link": "https://stackoverflow.com/questions/56030400/c-printf-int-and-double-same-resault-diffrent-assumes", "closed_reason": "Duplicate", "title": "C printf int and double same resault diffrent assumes", "body": "<p>I'm trying to understand how it's working.</p>\n\n<pre><code>#include&lt;stdio.h&gt; \nint main() \n{ \n    int a = 110; \n    double d = 10.21; \n    printf(\"sum  d: %d  \\t\\t size  d: %d \\n\", a+d, sizeof(a+d)); \n    printf(\"sum lf: %lf \\t size lf: %lf \\n\", a+d, sizeof(a+d)); \n    printf(\"sum lf: %lf\\t size  d: %d \\n\", a+d, sizeof(a+d)); \n    printf(\"sum  d: %d \\t\\t size lf: %lf \\n\", a+d, sizeof(a+d)); \n    return 0; \n}  \n</code></pre>\n\n<p>The output is:</p>\n\n<pre><code>sum  d: 8        size  d: 1343288280 \nsum lf: 120.210000   size lf: 0.000000 \nsum lf: 120.210000   size  d: 8 \nsum  d: 8        size lf: 120.210000\n</code></pre>\n"}, {"tags": ["c", "linker", "pragma"], "comments": [{"owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 0, "creation_date": 1557260587, "post_id": 56029951, "comment_id": 98703497, "body": "The first things that comes to mind is having global variables with the same name, and getting multiple definition errors."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 1, "creation_date": 1557260854, "post_id": 56029951, "comment_id": 98703612, "body": "I do not see any logic in it. It does not add any sanity, but it definitely ads a huge disorder. Just link what you are supposed to link. To be mo dynamic in that use autoconf or cmake on the project generation level."}, {"owner": {"reputation": 30170, "user_id": 5231607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QzGsq.jpg?s=128&g=1", "display_name": "1201ProgramAlarm", "link": "https://stackoverflow.com/users/5231607/1201programalarm"}, "edited": false, "score": 0, "creation_date": 1557262430, "post_id": 56029951, "comment_id": 98704232, "body": "Are these libraries unused in the binary that the linker is making?  They&#39;re (mostly) harmless.  Linkers routinely ignore .lib files that don&#39;t have any symbols declared in them that the program needs."}, {"owner": {"reputation": 21, "user_id": 11466653, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/800445717f68ac6b59f804a26b30ffb1?s=128&d=identicon&r=PG&f=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/11466653/tim"}, "edited": false, "score": 0, "creation_date": 1557273133, "post_id": 56029951, "comment_id": 98706946, "body": "- Thomas Jager, that is pretty close to the best idea I&#39;ve come up with, so if it&#39;s generally accepted then that will be the route I take"}, {"owner": {"reputation": 21, "user_id": 11466653, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/800445717f68ac6b59f804a26b30ffb1?s=128&d=identicon&r=PG&f=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/11466653/tim"}, "edited": false, "score": 0, "creation_date": 1557273351, "post_id": 56029951, "comment_id": 98706983, "body": "- P__J__, I know it seems rather unreasonable, which I presume is why I haven&#39;t had much luck on Google.  But for reasons I&#39;m not at liberty to discuss, one way or another it has to happen.  There are specific guarantees I need to provide, some of which necessitate restricting the libraries that are linked.  Moreover, this is less a tool to prevent it from happening and more a tool support the guarantees I&#39;m claiming the system to provide."}, {"owner": {"reputation": 21, "user_id": 11466653, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/800445717f68ac6b59f804a26b30ffb1?s=128&d=identicon&r=PG&f=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/11466653/tim"}, "edited": false, "score": 0, "creation_date": 1557273441, "post_id": 56029951, "comment_id": 98706999, "body": "- 1201ProgramAlarm, my previous comment is also probably relevant as a response to yours, which is that while the compiler and linker are optimized to eliminate unused code, it&#39;s not a guarantee provided by the specific toolchain I&#39;m using, which means I need to find a way to do it."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 11466653, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/800445717f68ac6b59f804a26b30ffb1?s=128&d=identicon&r=PG&f=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/11466653/tim"}, "edited": false, "score": 0, "creation_date": 1557273586, "post_id": 56030449, "comment_id": 98707022, "body": "Right so the C language doesn&#39;t know anything about them, but the linkers might.  So maybe &quot;modify source&quot; was misleading.  What I mean to ask is if I can modify the source files to specifically target the linker.  For example, I believe if <code>poison</code> were an option, I could <code>poison</code> a specific symbol that is defined only in the libraries that should never be linked."}, {"owner": {"reputation": 21, "user_id": 11466653, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/800445717f68ac6b59f804a26b30ffb1?s=128&d=identicon&r=PG&f=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/11466653/tim"}, "edited": false, "score": 0, "creation_date": 1557274384, "post_id": 56030449, "comment_id": 98707159, "body": "Maybe a better way to think of this is <code>broccoli.a</code> in some way causes <code>fruits.c</code> to work improperly.  I want a way to enforce that not happening without auditing code or chancing shipping faulty <code>fruits.c</code>."}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 0, "last_activity_date": 1557263059, "creation_date": 1557263059, "answer_id": 56030449, "question_id": 56029951, "link": "https://stackoverflow.com/questions/56029951/how-do-i-force-the-linker-to-reject-particular-libraries-without-the-libraries-t/56030449#56030449", "title": "How do I force the linker to reject particular libraries without the libraries themselves conflicting?", "body": "<blockquote>\n  <p>Some programs are limited to the set of libraries allowed to be linked while others are not.</p>\n</blockquote>\n\n<p>That doesn't make much sense.</p>\n\n<blockquote>\n  <p>Is there a way I can modify my source and the libraries' source such\n  that the linker will allow me to link both <code>apple.a</code> and <code>broccoli.a</code> into\n  <code>food.c</code>, and will allow me to link <code>apple.a</code> into <code>fruits.c</code>, but will\n  produce a linker error when I try to load <code>apple.a</code> and <code>broccoli.a</code> (or\n  just <code>broccoli.a</code>) into <code>fruits.c</code>?</p>\n</blockquote>\n\n<p>No, because the C language doesn't know anything about libraries.  Its specifications are written in a way that allows implementations to provide and use them, but there is no way in the C language to refer to a library itself.  It is not a C concept.</p>\n\n<p>And anyway, it doesn't make much sense.  Static library names have no inherent significance.  They are meaningful only to the extent that they identify their contents.  Nothing is gained by disallowing <code>fruits.c</code> linking against <code>broccoli.a</code>, because it would be easy to work around, and it is conceivable that it would even be accidentally worked around through errors in build-system maintenance -- <em>i.e.</em> objects intended for <code>broccoly.a</code> are put in <code>apple.a</code> additionally or instead.</p>\n\n<p>Moreover, most linkers are smart -- they will omit unreferenced functions and objects when they build an executable, so including unneeded (static) libraries in the link is generally harmless.</p>\n"}, {"comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1557312711, "post_id": 56032223, "comment_id": 98720255, "body": "It seems like this would interfere with other sources being able to include both libraries, as the OP specified some should be able to do."}, {"owner": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1557315275, "post_id": 56032223, "comment_id": 98721719, "body": "@JohnBollinger No, the &quot;marks&quot; should only be placed in a library (e.g. a mark for broccoli in the broccoli library, a mark for apple in the apple library) and in applications which are <i>not</i> compatible with that library. (<code>fruit.c</code> is not a library and thus not intended to be included; <code>food.c</code> can without issues link against both broccoli and apple libraries)"}, {"owner": {"reputation": 21, "user_id": 11466653, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/800445717f68ac6b59f804a26b30ffb1?s=128&d=identicon&r=PG&f=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/11466653/tim"}, "edited": false, "score": 0, "creation_date": 1557322465, "post_id": 56032223, "comment_id": 98726028, "body": "@DanielJour okay I think this I can work with and massage to fit my use case, thank you! As far as it feeling hacky, it very well might be but it serves a purpose.  Sacrificing properties of static libraries isn&#39;t not much of a concern because (and while this will sound like a waste of time and money, I promise it isn&#39;t) part of the QA process will essentially be to analyze every line of code and either there will be a way to cover it under MCDC testing (to be later considered whether it is required) or it will be removed entirely from source."}], "tags": [], "owner": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "is_accepted": false, "score": 0, "last_activity_date": 1557277618, "creation_date": 1557277618, "answer_id": 56032223, "question_id": 56029951, "link": "https://stackoverflow.com/questions/56029951/how-do-i-force-the-linker-to-reject-particular-libraries-without-the-libraries-t/56032223#56032223", "title": "How do I force the linker to reject particular libraries without the libraries themselves conflicting?", "body": "<p>Ok, first things first:  <strong>This smells <em>extremely</em> like a BIG, BAD <em>hack</em> around a problem that can be solved easier!</strong></p>\n\n<p>Now one possible way would be to enforce a \"multiple definition error\".  For my example there are the following files:</p>\n\n<ul>\n<li><code>broccoli_mark.c</code> which is used to \"mark\" (see below) the broccoli library.</li>\n<li><code>broccoli_fn.c</code> which contains the functionality of the broccoli library.</li>\n<li><code>fruits.c</code> which is the program which should not link against the broccoli library.  This is \"marked\" to not allow linking against broccoli.</li>\n</ul>\n\n<p><strong>\"marking\"</strong>: This can be implemented by simply defining a global symbol with some known name in these files.  For example:</p>\n\n<pre><code>int broccoli_mark; // a global variable\n</code></pre>\n\n<p>Put only that into <code>broccoli_mark.c</code> and add it somewhere to <code>fruit.c</code>.</p>\n\n<p>Now linking ...</p>\n\n<pre><code># Compile and ar the library\n$ gcc -c broccoli_mark.c\n$ gcc -c broccoli_fn.c\n$ ar rcs broccoli.a broccoli_mark.o broccoli_fn.o\n# Compile and link program\n$ gcc -c fruits.c\n$ gcc fruits.o broccoli.a\n</code></pre>\n\n<p>... <em>works</em> .. <strong>but</strong> only because of how linking with a static library works:  Basically the linker only picks out (whole) object files which define a symbol which is undefined in the current linking set (initially the program, then also added object files from the library).</p>\n\n<p>So in order to <em>fail</em> linking we must ensure that <code>broccoli_mark.o</code> (or more specifically its contained symbol <code>broccoli_mark</code>) is included.  Approaches:</p>\n\n<ul>\n<li><p>\"Merge\" multiple object files into a single one:</p>\n\n<pre><code># Merge two object files into a single broccoli.o\n$ ld -r -o broccoli.o broccoli_fn.o broccoli_mark.o\n# create the library or not ..\n$ gcc fruits.o broccoli.o\nld: broccoli.o:(.data+0x0): multiple definition of `broccoli_mark'; fruits.o:(.data+0x0): first defined here\ncollect2: error: ld returned 1 exit status\n</code></pre>\n\n<p>Yeah!</p>\n\n<p>Note that you can do this for all <code>.o</code> files of the broccoli library ... but then you defeat the useful property of static libraries to only include what's necessary.</p>\n\n<p>Also note that there are <a href=\"https://stackoverflow.com/q/4274804/1116364\">options</a> which could probably break this.</p>\n\n<p>(Similar alternative: <a href=\"https://stackoverflow.com/q/805555/1116364\"><code>--whole-archive</code> option</a>)</p></li>\n<li><p>Just include the \"mark\" in a source file which will be surely included (e.g. one which contains the \"main\" function of the library).</p></li>\n</ul>\n\n<p>Of course all that \"marking\" etc can be hidden behind descriptive macro names ... still feels like a pretty bad hack, though!</p>\n"}], "owner": {"reputation": 21, "user_id": 11466653, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/800445717f68ac6b59f804a26b30ffb1?s=128&d=identicon&r=PG&f=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/11466653/tim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1557277618, "creation_date": 1557260450, "question_id": 56029951, "link": "https://stackoverflow.com/questions/56029951/how-do-i-force-the-linker-to-reject-particular-libraries-without-the-libraries-t", "title": "How do I force the linker to reject particular libraries without the libraries themselves conflicting?", "body": "<p>I'm trying to add a sanity check at the link stage.  Specifically, I have programs that are statically linking libraries.  Some programs are limited to the set of libraries allowed to be linked while others are not.  So say for example I have two programs respectively from <code>food.c</code> and <code>fruits.c</code>, and I have two libraries (for which I have source) <code>apple.a</code> and <code>broccoli.a</code>.  There is no dependency between <code>apple.a</code> and <code>broccoli.a</code>.</p>\n\n<p>Is there a way I can modify my source and the libraries' source such that the linker will allow me to link both <code>apple.a</code> and <code>broccoli.a</code> into <code>food.c</code>, and will allow me to link <code>apple.a</code> into <code>fruits.c</code>, but will produce a linker error when I try to load <code>apple.a</code> and <code>broccoli.a</code> (or just <code>broccoli.a</code>) into <code>fruits.c</code>?  Assume that my source does not <code>#include</code> any headers in the libraries they link, as they are linked in by mistake, are left over from deleted code, function prototypes are manually declared, and so on.</p>\n\n<p>What would be nice is if I could somehow tag these libraries in such a way that my program can reject a particular tag.</p>\n\n<p>The specific compiler I'm using does not implement <code>#pragma poison</code>, which was really the only helpful tool I've found in my search.  My hunch tells me there might be something clever I can do with weak symbols, but I'm not exactly sure what or how.</p>\n\n<p>I also don't believe using <code>#define</code> will help me, as my understanding is that would only prevent me from <code>#include</code>ing specific files, but if I'm mistaken in that, then that could also be a fine solution.</p>\n"}, {"tags": ["c", "wireshark", "libpcap", "packet-capture", "wifi"], "comments": [{"owner": {"reputation": 10217, "user_id": 471930, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tds8p.png?s=128&g=1", "display_name": "Jasen", "link": "https://stackoverflow.com/users/471930/jasen"}, "edited": false, "score": 0, "creation_date": 1557260989, "post_id": 56029800, "comment_id": 98703675, "body": "does &quot;network byte order&quot; mean anything to you?  <code>ntohs()</code> and all that"}, {"owner": {"reputation": 92307, "user_id": 167735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5deb8de031f80c23f19e9b6d389e5afe?s=128&d=identicon&r=PG", "display_name": "slebetman", "link": "https://stackoverflow.com/users/167735/slebetman"}, "edited": false, "score": 0, "creation_date": 1557262357, "post_id": 56029800, "comment_id": 98704208, "body": "It&#39;s not just wireshark. Standard network packets encode data in network byte order. Your interpretation of the specification is wrong. It is big edian (network byte order), not little endian"}, {"owner": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "reply_to_user": {"reputation": 92307, "user_id": 167735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5deb8de031f80c23f19e9b6d389e5afe?s=128&d=identicon&r=PG", "display_name": "slebetman", "link": "https://stackoverflow.com/users/167735/slebetman"}, "edited": false, "score": 1, "creation_date": 1557268659, "post_id": 56029800, "comment_id": 98706043, "body": "@slebetman The linked specification page actually says &quot;all data fields ... in the radiotap header are to be specified in little endian byte-order&quot;. (Maybe a strange design choice, but you have to follow the docs.)"}, {"owner": {"reputation": 13306, "user_id": 162698, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HnjBG.png?s=128&g=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/162698/rob"}, "edited": false, "score": 0, "creation_date": 1557280724, "post_id": 56029800, "comment_id": 98708178, "body": "Do not post images. Always post everything in text."}], "answers": [{"comments": [{"owner": {"reputation": 909, "user_id": 3420060, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/lrXwx.png?s=128&g=1", "display_name": "Crizly", "link": "https://stackoverflow.com/users/3420060/crizly"}, "edited": false, "score": 0, "creation_date": 1557261586, "post_id": 56030050, "comment_id": 98703931, "body": "It&#39;s coming back to me now, doing this in java, forgot about the net byte order... what&#39;s the rule for when to apply it? MAC addresses are already in the correct order, aren&#39;t they?"}, {"owner": {"reputation": 43, "user_id": 11449083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e12fb3cdda3fe5b9dddbe01263119367?s=128&d=identicon&r=PG&f=1", "display_name": "atanas", "link": "https://stackoverflow.com/users/11449083/atanas"}, "reply_to_user": {"reputation": 909, "user_id": 3420060, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/lrXwx.png?s=128&g=1", "display_name": "Crizly", "link": "https://stackoverflow.com/users/3420060/crizly"}, "edited": false, "score": 0, "creation_date": 1557261908, "post_id": 56030050, "comment_id": 98704053, "body": "Sorry, can&#39;t help you with that, it&#39;s not my field, i just know some basis. Ask another queston if you can&#39;t figure it out on your own. Good luck !"}, {"owner": {"reputation": 92307, "user_id": 167735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5deb8de031f80c23f19e9b6d389e5afe?s=128&d=identicon&r=PG", "display_name": "slebetman", "link": "https://stackoverflow.com/users/167735/slebetman"}, "reply_to_user": {"reputation": 909, "user_id": 3420060, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/lrXwx.png?s=128&g=1", "display_name": "Crizly", "link": "https://stackoverflow.com/users/3420060/crizly"}, "edited": false, "score": 0, "creation_date": 1557262671, "post_id": 56030050, "comment_id": 98704313, "body": "@Crizly The general rule is apply network byte order to everything. All IEEE and IETF standards use network byte order. The rare exceptions are proprietary protocols (usually developed by amateurs that don&#39;t know about network byte order or deliberately ignore network byte order in favour of premature &quot;optimisation&quot;). So if it&#39;s things like TCP, IP, ARP, MAC etc use network byte order. If it&#39;s things like bencoding (bittorrent), protobuf (google) refer to their respective documentation"}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 1, "creation_date": 1557271080, "post_id": 56030050, "comment_id": 98706572, "body": "... however this header is clearly stored in <b>little-endian</b>."}, {"owner": {"reputation": 14469, "user_id": 2191105, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/tPiCW.png?s=128&g=1", "display_name": "David Hoelzer", "link": "https://stackoverflow.com/users/2191105/david-hoelzer"}, "edited": false, "score": 0, "creation_date": 1557280681, "post_id": 56030050, "comment_id": 98708169, "body": "The documentation for Radiotap tells us that this answer is incorrect, @atanas"}], "tags": [], "owner": {"reputation": 43, "user_id": 11449083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e12fb3cdda3fe5b9dddbe01263119367?s=128&d=identicon&r=PG&f=1", "display_name": "atanas", "link": "https://stackoverflow.com/users/11449083/atanas"}, "is_accepted": false, "score": 1, "last_activity_date": 1557261373, "last_edit_date": 1557261373, "creation_date": 1557260918, "answer_id": 56030050, "question_id": 56029800, "link": "https://stackoverflow.com/questions/56029800/how-does-wireshark-interpret-the-order-of-bytes/56030050#56030050", "title": "How does wireshark interpret the order of bytes?", "body": "<p>From <a href=\"https://en.wikipedia.org/wiki/Endianness\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/Endianness</a></p>\n\n<p>\"<strong>Big-endian</strong> is the most common format in data networking; fields in the protocols of the Internet protocol suite, such as IPv4, IPv6, TCP, and UDP, are transmitted in big-endian order. For this reason, big-endian byte order is also referred to as <strong>network byte order</strong>\"</p>\n"}, {"tags": [], "owner": {"reputation": 13960, "user_id": 8574934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/131cee6fb081f9edbccdd36a76b69eee?s=128&d=identicon&r=PG", "display_name": "Mika Sundland", "link": "https://stackoverflow.com/users/8574934/mika-sundland"}, "is_accepted": true, "score": 5, "last_activity_date": 1557323894, "last_edit_date": 1557323894, "creation_date": 1557267432, "answer_id": 56031138, "question_id": 56029800, "link": "https://stackoverflow.com/questions/56029800/how-does-wireshark-interpret-the-order-of-bytes/56031138#56031138", "title": "How does wireshark interpret the order of bytes?", "body": "<p>How Wireshark interpret the endianess is up to the dissector developers to decide. They choose to either read the buffer as little endian or big endian. There are different parsing functions for each type. The endianess to use is usually found in the protocol's documentation.</p>\n\n<p>The protocol you are looking at is little endian. I'm not sure why the (<a href=\"https://stackoverflow.com/a/56030050/8574934\">original</a>) accepted answer and the comments suggest otherwise. <code>19 00</code> is 25 in decimal, when using little endian. It might be a bit confusing, but the little end comes first. You can read about it <a href=\"https://betterexplained.com/articles/understanding-big-and-little-endian-byte-order/\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "is_accepted": false, "score": 0, "last_activity_date": 1557271218, "creation_date": 1557271218, "answer_id": 56031605, "question_id": 56029800, "link": "https://stackoverflow.com/questions/56029800/how-does-wireshark-interpret-the-order-of-bytes/56031605#56031605", "title": "How does wireshark interpret the order of bytes?", "body": "<p>\"little-endian\" means that the low byte is stored before the high byte.</p>\n\n<p>The two bytes that are stored are 19 00 (hex). The low byte is 19 (hex) and the high byte is 00 (hex). So the overall number is 0019 (hex) or 25 (decimal).</p>\n\n<p>If you are running this on a little-endian system, you do not need to do any endian conversion. If you are writing a program that you want to also work on big-endian systems, you will need to be careful with endian-ness.</p>\n"}, {"tags": [], "owner": {"reputation": 14469, "user_id": 2191105, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/tPiCW.png?s=128&g=1", "display_name": "David Hoelzer", "link": "https://stackoverflow.com/users/2191105/david-hoelzer"}, "is_accepted": false, "score": 2, "last_activity_date": 1557319609, "last_edit_date": 1557319609, "creation_date": 1557280527, "answer_id": 56032523, "question_id": 56029800, "link": "https://stackoverflow.com/questions/56029800/how-does-wireshark-interpret-the-order-of-bytes/56032523#56032523", "title": "How does wireshark interpret the order of bytes?", "body": "<p>I'm afraid that the (original) accepted answer, which would normally be correct, is not correct for the Radiotap header.</p>\n\n<p>Big-endian is the standard for network byte order, however the <a href=\"https://www.radiotap.org/\" rel=\"nofollow noreferrer\">Radiotap documentation</a> specifically states:</p>\n\n<blockquote>\n  <p>Data is specified in little endian byte-order, all data fields including the it_version, it_len and it_present fields in the radiotap header are to be specified in little endian byte-order.</p>\n</blockquote>\n"}], "owner": {"reputation": 909, "user_id": 3420060, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/lrXwx.png?s=128&g=1", "display_name": "Crizly", "link": "https://stackoverflow.com/users/3420060/crizly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 698, "favorite_count": 0, "accepted_answer_id": 56031138, "answer_count": 4, "score": 1, "last_activity_date": 1557323894, "creation_date": 1557259739, "last_edit_date": 1557260912, "question_id": 56029800, "link": "https://stackoverflow.com/questions/56029800/how-does-wireshark-interpret-the-order-of-bytes", "title": "How does wireshark interpret the order of bytes?", "body": "<p>I'm working with the 802.11 <a href=\"https://www.radiotap.org\" rel=\"nofollow noreferrer\">radiotap header</a> making my own parser and it states the packet format is this where the length is 2 bytes long:</p>\n\n<p><a href=\"https://i.stack.imgur.com/cYYGY.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cYYGY.png\" alt=\"enter image description here\"></a></p>\n\n<p>In wireshark the hex of the header is this where the 2 bytes <code>19 00</code> are the length field, but wireshark ignores the trailing 00 and interprets it as legnth 25 (decimal) instead of length 6400 (decimal):</p>\n\n<p><a href=\"https://i.stack.imgur.com/n0Xdz.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/n0Xdz.png\" alt=\"enter image description here\"></a></p>\n\n<p>How does wireshark (correctly) know to interpret the number correctly?</p>\n\n<p>The link above says the length is stored in little endian and my system is little endian so I'm not sure what's happening on that front? </p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 5, "creation_date": 1557257990, "post_id": 56029394, "comment_id": 98702389, "body": "Read up on what strlen() does."}, {"owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "edited": false, "score": 1, "creation_date": 1557258284, "post_id": 56029394, "comment_id": 98702483, "body": "From <code>man bzero</code>: <i>CONFORMING TO         top  The bzero() function is deprecated (marked as LEGACY in POSIX.1-2001); use memset(3) in new programs. POSIX.1-2008 removes the specification of bzero(). The bzero() function first appeared in 4.3BSD.</i>"}, {"owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "edited": false, "score": 1, "creation_date": 1557258395, "post_id": 56029394, "comment_id": 98702535, "body": "This code has a mismatch in braces. Fix it until it compiles at least, and then we can have a look at your problem. <code>-Wall -Wextra -Werror</code> can be helpful."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 2, "creation_date": 1557258538, "post_id": 56029394, "comment_id": 98702606, "body": "buffer[161] is out-of-bounds."}, {"owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "edited": false, "score": 0, "creation_date": 1557258665, "post_id": 56029394, "comment_id": 98702657, "body": "If you don&#39;t use <code>argc</code> and <code>argv</code> you can just use <code>int main(void)</code>"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 2, "creation_date": 1557258748, "post_id": 56029394, "comment_id": 98702699, "body": "..and, anyway, you loaded the required offset into &#39;bytes&#39; on the line above and then.......just forgot/ignored it:("}, {"owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "edited": false, "score": 2, "creation_date": 1557258774, "post_id": 56029394, "comment_id": 98702711, "body": "Why would you <code>fork</code> just to do this? Show us a minimal complete code that reproduces your problem."}, {"owner": {"reputation": 11, "user_id": 11466550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5ab2c1eb8af5f5416061c0c26cc3c69?s=128&d=identicon&r=PG&f=1", "display_name": "dinushki", "link": "https://stackoverflow.com/users/11466550/dinushki"}, "edited": false, "score": 0, "creation_date": 1557312608, "post_id": 56029394, "comment_id": 98720181, "body": "i just edited the code"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1557313439, "post_id": 56029394, "comment_id": 98720684, "body": "Don&#39;t redeclare <code>errno</code> manually."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1557313470, "post_id": 56029394, "comment_id": 98720709, "body": "Your second call to <code>open</code> is missing the mode argument (required for <code>O_CREAT</code>)."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1557313536, "post_id": 56029394, "comment_id": 98720757, "body": "<code>while (read(fdr, &amp;c, 1))</code> is wrong. <code>read</code> returns non-zero on error."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1557313582, "post_id": 56029394, "comment_id": 98720795, "body": "<code>c != EOF</code> makes no sense. <code>c</code> is a <code>char</code>; <code>EOF</code> is not. Either this will never be true, or it will treat a valid character as EOF by mistake."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1557313621, "post_id": 56029394, "comment_id": 98720822, "body": "<code>buffer</code> is unused."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1557327684, "post_id": 56029394, "comment_id": 98729366, "body": "@dinushki: please do not correct the code in the question as it makes the comments, discussion and answers inconsistent. You can add <b>EDIT</b> sections at the end of the question for further information or trials."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 11466550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5ab2c1eb8af5f5416061c0c26cc3c69?s=128&d=identicon&r=PG&f=1", "display_name": "dinushki", "link": "https://stackoverflow.com/users/11466550/dinushki"}, "edited": false, "score": 0, "creation_date": 1557325941, "post_id": 56039343, "comment_id": 98728298, "body": "I have changed the code again .i&#39;m getting this error of the writing &quot;write() failed: Success &quot;"}, {"owner": {"reputation": 11, "user_id": 11466550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5ab2c1eb8af5f5416061c0c26cc3c69?s=128&d=identicon&r=PG&f=1", "display_name": "dinushki", "link": "https://stackoverflow.com/users/11466550/dinushki"}, "edited": false, "score": 0, "creation_date": 1557326595, "post_id": 56039343, "comment_id": 98728711, "body": "the -1 was the problem.but hey,can you explain the 0666?"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 11, "user_id": 11466550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5ab2c1eb8af5f5416061c0c26cc3c69?s=128&d=identicon&r=PG&f=1", "display_name": "dinushki", "link": "https://stackoverflow.com/users/11466550/dinushki"}, "edited": false, "score": 0, "creation_date": 1557326937, "post_id": 56039343, "comment_id": 98728910, "body": "<code>0666</code>, which should really be <code>0644</code> is the permission mask documented in <a href=\"http://man7.org/linux/man-pages/man2/open.2.html\" rel=\"nofollow noreferrer\">man7.org/linux/man-pages/man2/open.2.html</a>"}, {"owner": {"reputation": 11, "user_id": 11466550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5ab2c1eb8af5f5416061c0c26cc3c69?s=128&d=identicon&r=PG&f=1", "display_name": "dinushki", "link": "https://stackoverflow.com/users/11466550/dinushki"}, "edited": false, "score": 0, "creation_date": 1557327154, "post_id": 56039343, "comment_id": 98729039, "body": "for some reason when im trying to open the file it takes a minute and it seems like it write empty char or something.the size is approx 300 MB now"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 11, "user_id": 11466550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5ab2c1eb8af5f5416061c0c26cc3c69?s=128&d=identicon&r=PG&f=1", "display_name": "dinushki", "link": "https://stackoverflow.com/users/11466550/dinushki"}, "edited": false, "score": 0, "creation_date": 1557327619, "post_id": 56039343, "comment_id": 98729321, "body": "@dinushki:  I posted a corrected version. Verify that you test for read success correctly:` while (read(fdr, &amp;c, 1) == 1)` If you test <code>!= -1</code>, you will have an endless loop writing the last byte again repeatedly at the end of <code>gg.txt</code>."}], "tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": true, "score": 1, "last_activity_date": 1557327527, "last_edit_date": 1557327527, "creation_date": 1557313593, "answer_id": 56039343, "question_id": 56029394, "link": "https://stackoverflow.com/questions/56029394/reading-a-line-and-removing-spaces-from-matrix-in-a-file/56039343#56039343", "title": "Reading a line and removing Spaces from matrix in a file", "body": "<p>There are multiple problems in the code:</p>\n\n<ul>\n<li>you do not test for <code>read</code> errors, <code>read</code> can return <code>-1</code> for error, which would not stop the <code>while</code> loop.</li>\n<li>testing <code>c != EOF</code> is meaningless. <code>EOF</code> is returned by <code>getc()</code> to indicate end of stream or input error, <code>read</code> indicates these conditions in its return value, <code>c</code> is always a byte value if <code>read</code> succeeded and returned <code>1</code>.</li>\n<li><p><code>gg.txt</code> is not truncated by <code>open</code> with the given flags. Chances are you are overwriting the beginning of the file and for some reason the file is longer from previous attempts and still contains previously written data. You must also pass the mode bits for the file creation as the third argument to <code>open</code>. Use this:</p>\n\n<pre><code>// open the file for writing, truncate if it exists or create with\n// read/write permission for user, read permission for group and others\nfdw = open(\"gg.txt\", O_WRONLY | O_CREAT | O_TRUNC, 0644);\n</code></pre></li>\n<li><p>the comment <code>// echo char to stdout</code> does not seem to refer to any code.</p></li>\n</ul>\n\n<p>Here is a corrected version:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;errno.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;unistd.h&gt;\n\nint main(int argc, char *argv[]) {\n    int fdr, fdw;   // file descriptors\n    char c;\n\n    fdr = open(argv[1],  O_RDONLY);   // open files\n    if (fdr &lt; 0) {\n        fprintf(stderr, \"failed to open input file %s: %s\\n\", argv[1], strerror(errno));\n        return EXIT_FAILURE;\n    }\n    // open the output file for writing, truncate if it exists or create with\n    // read/write permission for user, read permission for group and others\n    fdw = open(\"gg.txt\", O_WRONLY | O_CREAT | O_TRUNC, 0644);\n    if (fdw &lt; 0) {\n        fprintf(stderr, \"failed to open output file %s: %s\\n\", \"gg.txt\", strerror(errno));\n        return EXIT_FAILURE;\n    }\n\n    // read/write a single char from/to the files\n    while (read(fdr, &amp;c, 1) == 1) {\n        if (c != ' ') {\n            if (write(fdw, &amp;c, 1) != 1) {\n                perror(\"write() failed\");\n                return EXIT_FAILURE;\n            }\n        }\n    }\n    close(fdr);   // close the files\n    close(fdw);\n    return EXIT_SUCCESS;\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11466550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5ab2c1eb8af5f5416061c0c26cc3c69?s=128&d=identicon&r=PG&f=1", "display_name": "dinushki", "link": "https://stackoverflow.com/users/11466550/dinushki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 56039343, "answer_count": 1, "score": -2, "last_activity_date": 1557416873, "creation_date": 1557257795, "last_edit_date": 1557416873, "question_id": 56029394, "link": "https://stackoverflow.com/questions/56029394/reading-a-line-and-removing-spaces-from-matrix-in-a-file", "title": "Reading a line and removing Spaces from matrix in a file", "body": "<p>OK so I manage to write to the file <code>char</code> by <code>char</code> but it writes twice the numbers and it it still write it with spaces. Any advice and solution?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;ctype.h&gt;\n#include &lt;fcntl.h&gt;\n\nextern int errno;\n#define MAX_LEN 18\n\nint main(int argc, char *argv[]) {\n    int fd[2], des, bytes, target;\n    char buffer[161];\n    int fdr, fdw;   // file descriptors\n    char c;\n\n    fdr = open(argv[1],  O_RDONLY);   // open files\n    fdw = open(\"gg.txt\", O_WRONLY | O_CREAT);\n    if (fdr &lt; 0 || fdw &lt; 0) {\n        perror(\"failed to open input or output files\");\n        exit(EXIT_FAILURE);\n    }\n\n    while (read(fdr, &amp;c, 1)) { // read/write a single char from/to the files\n        if (c != ' ' &amp;&amp; c != EOF) {\n            if (write(fdw, &amp;c, 1) != 1) {\n                perror(\"write() failed\");\n                exit(EXIT_FAILURE);\n            }\n        }    // echo char to stdout\n    }\n\n    close(fdr);   // close the files\n    close(fdw);\n    exit(EXIT_SUCCESS);\n}\n</code></pre>\n\n<p>EDIT SECTION</p>\n\n<p>hey again,</p>\n\n<p>i managed to read the file and write it to new one without spaces but i'm trying to insert the values to matrix but im getting an error trying to open the new file.</p>\n\n<p>i have changed the permissions </p>\n\n<pre><code>fdw = open(\"gg.txt\", O_RDWR | O_CREAT | O_TRUNC, 0644);\n</code></pre>\n\n<p>the function </p>\n\n<pre><code>void removeSpaces(int matrix[SIZE][SIZE],int fdr, int fdw) {\n\n    char c;\n    char matBuffer={0};\n    while (read(fdr, &amp;c, 1))          // read/write a single char\n    {                                  // from/to the files\n        if (c != ' ') {\n            if (write(fdw, &amp;c, 1) != 1) {\n                perror(\"write() failed\");\n                exit(EXIT_FAILURE);\n            }\n        }\n    }\n    int i;\n    int j;\n    int k=0;\n    while(read(fdw, &amp;matBuffer, 1))\n    {\n        for(i=0;i&lt;SIZE;i++)\n        {\n            for(j=0;j&lt;SIZE;j++)\n                    {\n                        matrix[i][j]=matBuffer-'0';\n                        k++;\n                    }\n            k=0;\n        }\n\n    }\n\n}\n</code></pre>\n\n<p>The whole program</p>\n\n<pre><code>// C program to illustrate\n// open system call\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;ctype.h&gt;\n#include &lt;fcntl.h&gt;\n#define MAX_LEN 18\n#define SIZE 9\nvoid removeSpaces(int matrix[SIZE][SIZE],int fdr, int fdw) {\n\n    char c;\n    char matBuffer={0};\n    while (read(fdr, &amp;c, 1))          // read/write a single char\n    {                                  // from/to the files\n        if (c != ' ') {\n            if (write(fdw, &amp;c, 1) != 1) {\n                perror(\"write() failed\");\n                exit(EXIT_FAILURE);\n            }\n        }\n    }\n    int i;\n    int j;\n    int k=0;\n    while(read(fdw, &amp;matBuffer, 1))\n    {\n        for(i=0;i&lt;SIZE;i++)\n        {\n            for(j=0;j&lt;SIZE;j++)\n                    {\n                        matrix[i][j]=matBuffer-'0';\n                        k++;\n                    }\n            k=0;\n        }\n\n    }\n\n}\nint is_safe(int matrix[9][9],int n, int r, int c)\n{\n    int i,j;\n    //checking in row\n    for(i=0;i&lt;9;i++)\n    {\n        //there is a cell with same value\n        if(matrix[r][i] == n)\n            return 0;\n    }\n    //checking column\n    for(i=0;i&lt;SIZE;i++)\n    {\n        //there is a cell with the value equal to i\n        if(matrix[i][c] == n)\n            return 0;\n    }\n    //checking sub matrix\n    int row_start = (r/3)*3;\n    int col_start = (c/3)*3;\n    for(i=row_start;i&lt;row_start+3;i++)\n    {\n        for(j=col_start;j&lt;col_start+3;j++)\n        {\n            if(matrix[i][j]==n)\n                return 0;\n        }\n    }\n    return 1;\n}\nint main(int argc, char * argv[]) {\n    int pipe_descs[2];\n    int matrix[SIZE][SIZE];\n    int fdr, fdw;   // file descriptors\n    int i,j;\n/*  if (pipe(pipe_descs) == -1) {\n        fprintf(stderr, \"cannot open\");\n        exit(1);\n    }\n    pid_t status = fork();\n    if(status ==0 )\n    {\n\n    }*/\n    fdr = open(argv[1], O_RDONLY);   // open files\n    fdw = open(\"gg.txt\", O_RDWR | O_CREAT | O_TRUNC, 0644);\n    if (fdr &lt; 0 || fdw &lt; 0) { //validation for error\n        perror(\"failed to open input or output files\");\n        exit(EXIT_FAILURE);\n    }\n    removeSpaces(matrix,fdr, fdw);\n    for(i=0; i&lt;9; i++){    /* Iterate of each row */\n        for(j=0; j&lt;9; j++){    /* In each row, go over each col element  */\n          printf(\"%c \",matrix[i][j]); /* Print each row element */\n        }\n        printf(\"\\n\");        /* Finish a row, start a new line */\n      }\n    close(fdr);   // close the files\n    close(fdw);\n\n    exit(EXIT_SUCCESS);\n}\n</code></pre>\n"}, {"tags": ["c", "macos", "uefi"], "comments": [{"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1557254978, "post_id": 56028607, "comment_id": 98701138, "body": "<a href=\"http://x86asm.net/articles/others/index.html\" rel=\"nofollow noreferrer\">x86asm.net/articles/others/index.html</a>"}, {"owner": {"reputation": 622, "user_id": 9569505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fba2ddf29906984c1747142dbee51f7?s=128&d=identicon&r=PG&f=1", "display_name": "MiSimon", "link": "https://stackoverflow.com/users/9569505/misimon"}, "edited": false, "score": 0, "creation_date": 1557324839, "post_id": 56028607, "comment_id": 98727598, "body": "Are you talking about EFI (v1.x) or UEFI (v2.x)? When built with EDK2 (UEFI) your code works fine."}, {"owner": {"reputation": 43, "user_id": 10045701, "user_type": "registered", "profile_image": "https://graph.facebook.com/2213742801999277/picture?type=large", "display_name": "Josef Alexander", "link": "https://stackoverflow.com/users/10045701/josef-alexander"}, "reply_to_user": {"reputation": 622, "user_id": 9569505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fba2ddf29906984c1747142dbee51f7?s=128&d=identicon&r=PG&f=1", "display_name": "MiSimon", "link": "https://stackoverflow.com/users/9569505/misimon"}, "edited": false, "score": 0, "creation_date": 1557325083, "post_id": 56028607, "comment_id": 98727748, "body": "@MiSimon I tried both, it works in an emulator but not to boot from on a mac :/ that is the problem!"}, {"owner": {"reputation": 622, "user_id": 9569505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fba2ddf29906984c1747142dbee51f7?s=128&d=identicon&r=PG&f=1", "display_name": "MiSimon", "link": "https://stackoverflow.com/users/9569505/misimon"}, "edited": false, "score": 0, "creation_date": 1557325308, "post_id": 56028607, "comment_id": 98727905, "body": "There may be more then one SIMPLE_TEXT_OUTPUT_INTERFACE instances available on your system, use bs-&gt;LocateHandleBuffer to get all available handles with SIMPLE_TEXT_OUTPUT_INTERFACE installed and try call OutputString on all instances (use bs-&gt;OpenProtocol to get the instance from the handle)."}, {"owner": {"reputation": 43, "user_id": 10045701, "user_type": "registered", "profile_image": "https://graph.facebook.com/2213742801999277/picture?type=large", "display_name": "Josef Alexander", "link": "https://stackoverflow.com/users/10045701/josef-alexander"}, "edited": false, "score": 0, "creation_date": 1557328090, "post_id": 56028607, "comment_id": 98729596, "body": "so I figured out that if I only show text on the mac, I see it, but only very shortly - like a quick flicker and then I it continues to boot into macos... on pc it works fine"}, {"owner": {"reputation": 622, "user_id": 9569505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fba2ddf29906984c1747142dbee51f7?s=128&d=identicon&r=PG&f=1", "display_name": "MiSimon", "link": "https://stackoverflow.com/users/9569505/misimon"}, "edited": false, "score": 0, "creation_date": 1557382077, "post_id": 56028607, "comment_id": 98747108, "body": "Are you still calling conOut-&gt;OutputString in the loop?"}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 10045701, "user_type": "registered", "profile_image": "https://graph.facebook.com/2213742801999277/picture?type=large", "display_name": "Josef Alexander", "link": "https://stackoverflow.com/users/10045701/josef-alexander"}, "edited": false, "score": 0, "creation_date": 1557392372, "post_id": 56051804, "comment_id": 98752234, "body": "Thanks @CodeRush, I tried, but i am not sure on how to implement it correctly (sorry I am quite new to this), do you know how to implement it on the above example?"}, {"owner": {"reputation": 43, "user_id": 10045701, "user_type": "registered", "profile_image": "https://graph.facebook.com/2213742801999277/picture?type=large", "display_name": "Josef Alexander", "link": "https://stackoverflow.com/users/10045701/josef-alexander"}, "edited": false, "score": 0, "creation_date": 1557400149, "post_id": 56051804, "comment_id": 98756567, "body": "especially with a colored background, I don&#39;t know how to make that work"}, {"owner": {"reputation": 744, "user_id": 4180477, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d9c8a517fe4c12162d355d287c66544?s=128&d=identicon&r=PG", "display_name": "CodeRush", "link": "https://stackoverflow.com/users/4180477/coderush"}, "reply_to_user": {"reputation": 43, "user_id": 10045701, "user_type": "registered", "profile_image": "https://graph.facebook.com/2213742801999277/picture?type=large", "display_name": "Josef Alexander", "link": "https://stackoverflow.com/users/10045701/josef-alexander"}, "edited": false, "score": 0, "creation_date": 1557430500, "post_id": 56051804, "comment_id": 98772696, "body": "It&#39;s currently unclear what are you trying to achieve at the end, i.e. why do you need a text rendered on background? Graphics in EFI is not easy to do, but there are some project that do it fairly well on both PC and MacOS, like <a href=\"http://refit.sourceforge.net\" rel=\"nofollow noreferrer\">rEFIt</a> or <a href=\"https://sourceforge.net/projects/cloverefiboot\" rel=\"nofollow noreferrer\">Clover</a>."}, {"owner": {"reputation": 43, "user_id": 10045701, "user_type": "registered", "profile_image": "https://graph.facebook.com/2213742801999277/picture?type=large", "display_name": "Josef Alexander", "link": "https://stackoverflow.com/users/10045701/josef-alexander"}, "edited": false, "score": 0, "creation_date": 1557468674, "post_id": 56051804, "comment_id": 98782162, "body": "Thanks for your answer! What I am trying to do is: Some text on a colored background"}], "tags": [], "owner": {"reputation": 744, "user_id": 4180477, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d9c8a517fe4c12162d355d287c66544?s=128&d=identicon&r=PG", "display_name": "CodeRush", "link": "https://stackoverflow.com/users/4180477/coderush"}, "is_accepted": false, "score": 0, "last_activity_date": 1557372941, "creation_date": 1557372941, "answer_id": 56051804, "question_id": 56028607, "link": "https://stackoverflow.com/questions/56028607/how-to-use-text-in-efi-graphic-mode/56051804#56051804", "title": "How to use text in EFI graphic mode?", "body": "<p>If you target MacEFI specifically, you'll need an additional protocol call to force the console into text mode, <a href=\"https://github.com/acidanthera/OpenCoreShell/blob/master/Patches/legacy-switch-to-text.diff\" rel=\"nofollow noreferrer\">like this</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 622, "user_id": 9569505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fba2ddf29906984c1747142dbee51f7?s=128&d=identicon&r=PG&f=1", "display_name": "MiSimon", "link": "https://stackoverflow.com/users/9569505/misimon"}, "edited": false, "score": 1, "creation_date": 1557408297, "post_id": 56058622, "comment_id": 98761238, "body": "On most systems that i have seen the SIMPLE_TEXT_OUTPUT_PROTOCOL is installed at the same handle as the GRAPHICS_OUTPUT_PROTOCOL if it is a graphical console and on some other handle if it is a serial, network, etc. console"}, {"owner": {"reputation": 5065, "user_id": 563188, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z1wGD.png?s=128&g=1", "display_name": "unixsmurf", "link": "https://stackoverflow.com/users/563188/unixsmurf"}, "reply_to_user": {"reputation": 622, "user_id": 9569505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fba2ddf29906984c1747142dbee51f7?s=128&d=identicon&r=PG&f=1", "display_name": "MiSimon", "link": "https://stackoverflow.com/users/9569505/misimon"}, "edited": false, "score": 0, "creation_date": 1557428316, "post_id": 56058622, "comment_id": 98771736, "body": "@MiSimon: sure, the text console will likely use the graphical console to render, but that makes it more, not less, complicated to interact."}], "tags": [], "owner": {"reputation": 5065, "user_id": 563188, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z1wGD.png?s=128&g=1", "display_name": "unixsmurf", "link": "https://stackoverflow.com/users/563188/unixsmurf"}, "is_accepted": false, "score": 1, "last_activity_date": 1557402059, "creation_date": 1557402059, "answer_id": 56058622, "question_id": 56028607, "link": "https://stackoverflow.com/questions/56028607/how-to-use-text-in-efi-graphic-mode/56058622#56058622", "title": "How to use text in EFI graphic mode?", "body": "<p>UEFI supports graphics output. It also supports text output (which can mean either output to a serial console, or text rendered to a graphical console, or both). But there is no defined way to interact between these in a controlled manner.</p>\n\n<p>Applications that provide a graphical environment with text elements (BIOS configuration menu, GRUB) generally do this using their own frameworks to draw text on the graphical console using GRAPHICS_OUTPUT_PROTOCOL.</p>\n"}, {"tags": [], "owner": {"reputation": 622, "user_id": 9569505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fba2ddf29906984c1747142dbee51f7?s=128&d=identicon&r=PG&f=1", "display_name": "MiSimon", "link": "https://stackoverflow.com/users/9569505/misimon"}, "is_accepted": false, "score": 0, "last_activity_date": 1557487599, "creation_date": 1557487599, "answer_id": 56076747, "question_id": 56028607, "link": "https://stackoverflow.com/questions/56028607/how-to-use-text-in-efi-graphic-mode/56076747#56076747", "title": "How to use text in EFI graphic mode?", "body": "<p>This is a short example of a text renderer using the font module from <a href=\"https://github.com/littlevgl/lvgl/tree/v5.1/lv_misc\" rel=\"nofollow noreferrer\">LVGL</a> (which can be used standalone, replace <em>#include \"../../lv_conf.h\"</em> in the lv_font.h file with <em>#define USE_LV_FONT_DEJAVU_20 8</em>) and the Blt method from the GRAPHICS_OUTPUT_PROTOCOL</p>\n\n<pre><code>#include &lt;Uefi.h&gt;\n#include &lt;Library\\UefiLib.h&gt;\n#include &lt;Protocol\\GraphicsOutput.h&gt;\n#include \"lv_font.h\"\n\n#define LETTER_SPACE 2\n#define WAIT_SECONDS 10\n#define FONT &amp;lv_font_dejavu_20\n\nstatic EFI_BOOT_SERVICES *gBS;\nstatic EFI_RUNTIME_SERVICES *gRT;\nstatic EFI_GRAPHICS_OUTPUT_PROTOCOL *gGOP = (EFI_GRAPHICS_OUTPUT_PROTOCOL *)NULL;\nstatic EFI_GRAPHICS_OUTPUT_BLT_PIXEL gWhite = { 255,255,255,0 };\n\nstatic void _util_render_glyph(UINT32 x, UINT32 y, CHAR8 letter)\n{\n    UINT32        height;\n    UINT32        width;\n    UINT32        pm_x;\n    UINT32        pm_y;\n    UINT32        index;\n    const UINT8*  bitmap;\n    EFI_GRAPHICS_OUTPUT_BLT_PIXEL *pixelmap;\n\n    if (gGOP == NULL) {\n        return;\n    }\n\n    height = lv_font_get_height(FONT);\n    width = lv_font_get_width(FONT, letter);\n\n    // glyph is not defined in this font\n    if (width == 0) {\n        return;\n    }\n\n    bitmap = lv_font_get_bitmap(FONT, letter);\n\n    // using 8 bpp for simplicity\n    if (EFI_ERROR(gBS-&gt;AllocatePool(EfiLoaderData, height * width * sizeof(*pixelmap), (VOID**)&amp;pixelmap))) {\n        return;\n    }\n\n    gBS-&gt;SetMem((VOID*)pixelmap, height * width * sizeof(*pixelmap), 0);\n\n    // get the current content of the framebuffer to allow 'transparent' blt operations\n    gGOP-&gt;Blt(gGOP, pixelmap, EfiBltVideoToBltBuffer, x, y, 0, 0, width, height, 0);\n\n    for (pm_y = 0; pm_y &lt; height; pm_y++) {\n        for (pm_x = 0; pm_x &lt; width; pm_x++) {\n            index = width * pm_y + pm_x;\n\n            if (bitmap[index] &gt; 200) {\n                pixelmap[index].Red = 0;\n                pixelmap[index].Blue = 0;\n                pixelmap[index].Green = 0;\n                pixelmap[index].Reserved = 0;\n            }\n            else if (bitmap[index] &gt; 100) {\n                pixelmap[index].Red = 105;\n                pixelmap[index].Blue = 105;\n                pixelmap[index].Green = 105;\n                pixelmap[index].Reserved = 0;\n            }\n        }\n    }\n\n    gGOP-&gt;Blt(gGOP, pixelmap, EfiBltBufferToVideo, 0, 0, x, y, width, height, 0);\n    gBS-&gt;FreePool(pixelmap);\n}\n\nstatic void _util_render_text(UINT32 x, UINT32 y, const CHAR8 *string)\n{\n    UINT32 index;\n    UINTN length;\n    UINT32 scr_w;\n    UINT32 scr_h;\n\n    UINT32 str_x;\n\n    UINT32 gly_w;\n    UINT32 gly_h;\n\n    if (string == NULL) {\n        return;\n    }\n\n    if (gGOP == NULL) {\n        return;\n    }\n\n    scr_w = gGOP-&gt;Mode-&gt;Info-&gt;HorizontalResolution;\n    scr_h = gGOP-&gt;Mode-&gt;Info-&gt;VerticalResolution;\n\n    length = AsciiStrnLenS(string, 32);\n\n    gly_h = lv_font_get_height(FONT);\n\n    // check if the string can be printed \n    if ((y + gly_h) &gt; scr_h) {\n        return;\n    }\n\n    if (x &gt; scr_w) {\n        return;\n    }\n\n    // print the string glyph by glyph\n    str_x = x;\n    for (index = 0; index &lt; length; index++) {\n        // check if the glyph can be printed\n        gly_w = lv_font_get_width(FONT, string[index]);\n        if ((str_x + gly_w) &gt; scr_w) {\n            break;\n        }\n\n        // print the glyph\n        _util_render_glyph(str_x, y, string[index]);\n\n        // calculate the position of the next glyph\n        str_x += gly_w + LETTER_SPACE;\n    }\n}\n\nstatic void _util_fill_screen(EFI_GRAPHICS_OUTPUT_BLT_PIXEL *color)\n{\n    if (gGOP == NULL) {\n        return;\n    }\n\n    gGOP-&gt;Blt(gGOP, color, EfiBltVideoFill, 0, 0, 0, 0, gGOP-&gt;Mode-&gt;Info-&gt;HorizontalResolution, gGOP-&gt;Mode-&gt;Info-&gt;VerticalResolution, 0);\n}\n\n\nstatic void _util_wait(UINT32 seconds)\n{\n    EFI_TIME    time;\n    UINT8       current_second = 255;\n    UINT32      elapsed_seconds = 0;\n\n    //wait for some seconds\n    while (elapsed_seconds &lt;= WAIT_SECONDS) {\n        if (!EFI_ERROR(gRT-&gt;GetTime(&amp;time, (EFI_TIME_CAPABILITIES*)NULL))) {\n            if (current_second != time.Second) {\n                elapsed_seconds++;\n                current_second = time.Second;\n            }\n        }\n        else {\n            break;\n        }\n        CpuPause();\n    }\n}\n\nEFI_STATUS\nEFIAPI\nUefiMain(\n    IN EFI_HANDLE        ImageHandle,\n    IN EFI_SYSTEM_TABLE  *SystemTable)\n{\n    EFI_STATUS  eRc;\n\n    gBS = SystemTable-&gt;BootServices;\n    gRT = SystemTable-&gt;RuntimeServices;\n\n    eRc = gBS-&gt;LocateProtocol(\n        &amp;gEfiGraphicsOutputProtocolGuid,\n        NULL,\n        (VOID**)&amp;gGOP);\n\n    if (EFI_ERROR(eRc) || gGOP == NULL) {\n        return EFI_SUCCESS;\n    }\n\n    _util_fill_screen(&amp;gWhite);\n    _util_render_text(0, 0, \"HELLO WORLD!\");\n\n    _util_wait(WAIT_SECONDS);\n\n    return EFI_SUCCESS;\n}\n</code></pre>\n\n<p>I tested it on a pc and on a mac it runs on both. Using the tools provided by LVGL on their website you can use any font you want.</p>\n"}], "owner": {"reputation": 43, "user_id": 10045701, "user_type": "registered", "profile_image": "https://graph.facebook.com/2213742801999277/picture?type=large", "display_name": "Josef Alexander", "link": "https://stackoverflow.com/users/10045701/josef-alexander"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1252, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1557487599, "creation_date": 1557254022, "question_id": 56028607, "link": "https://stackoverflow.com/questions/56028607/how-to-use-text-in-efi-graphic-mode", "title": "How to use text in EFI graphic mode?", "body": "<p>I am super new to creating efi application. My aim is to create a small application in efi, that displays some text on a background. But I am stuck with trying to display text on the display (Great would be to have a custom font, but that is not necessary at this stage). I want the app (also) to run on apple systems (to boot from a usb)</p>\n\n<ol>\n<li><p>How do I find good documentation on the EFI functions? It seems super hard to find good examples etc.</p></li>\n<li><p>How can I display a text on a background with EFI?</p></li>\n</ol>\n\n<p>This is what I got so far. I change the background to a color using the graphics protocol. How do I display a text on it. The Output String doesn't seem to work.</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include \"efibind.h\"\n#include \"efidef.h\"\n#include \"efidevp.h\"\n#include \"eficon.h\"\n#include \"efiapi.h\"\n#include \"efierr.h\"\n#include \"efiprot.h\"\n\nstatic EFI_GUID GraphicsOutputProtocolGUID = EFI_GRAPHICS_OUTPUT_PROTOCOL_GUID;\n\n/**\n * efi_main - The entry point for the EFI application\n * @image: firmware-allocated handle that identifies the image\n * @SystemTable: EFI system table\n */\nEFI_STATUS efi_main(EFI_HANDLE image, EFI_SYSTEM_TABLE *systemTable) {\n        EFI_BOOT_SERVICES *bs = systemTable-&gt;BootServices;\n        EFI_STATUS status;\n        EFI_GRAPHICS_OUTPUT_PROTOCOL *graphicsProtocol;\n        SIMPLE_TEXT_OUTPUT_INTERFACE *conOut = systemTable-&gt;ConOut;\n        EFI_GRAPHICS_OUTPUT_MODE_INFORMATION *info;\n        UINTN SizeOfInfo, sWidth, sHeight;\n\n        status = bs-&gt;LocateProtocol(&amp;GraphicsOutputProtocolGUID, NULL, \n                (void**)&amp;graphicsProtocol);\n\n        if (EFI_ERROR(status) || graphicsProtocol == NULL) {\n                conOut-&gt;OutputString(conOut, L\"Failed to init gfx!\\r\\n\");\n                return status;\n        }\n\n        conOut-&gt;ClearScreen(conOut);\n\n        //Switch to current mode so gfx is started.\n        status = graphicsProtocol-&gt;SetMode(graphicsProtocol, graphicsProtocol-&gt;Mode-&gt;Mode);\n        if (EFI_ERROR(status)) {\n                conOut-&gt;OutputString(conOut, L\"Failed to set default mode!\\r\\n\");\n                return status;\n        }\n\n        EFI_GRAPHICS_OUTPUT_BLT_PIXEL p;\n        p.Red = 200;\n        p.Green = 77;\n        p.Blue = 13;\n        graphicsProtocol-&gt;QueryMode(graphicsProtocol, graphicsProtocol-&gt;Mode-&gt;Mode, &amp;SizeOfInfo, &amp;info);\n        sWidth = info-&gt;HorizontalResolution;\n        sHeight = info-&gt;VerticalResolution;\n        status = graphicsProtocol-&gt;Blt(graphicsProtocol, &amp;p, EfiBltVideoFill, 0, 0, 0, 0, sWidth, sHeight, 0);\n\n\nwhile (1) {\nconOut-&gt;OutputString(conOut, L\"Some text that I want to display\\r\\n\");\nbs-&gt;Stall(500000);\n}\n\n\n\n        return EFI_SUCCESS;\n}\n\n</code></pre>\n"}, {"tags": ["c", "bash", "ubuntu", "io", "main"], "comments": [{"owner": {"reputation": 95060, "user_id": 89817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df253c3b6533949ea94f31f328f3e769?s=128&d=identicon&r=PG", "display_name": "Gordon Davisson", "link": "https://stackoverflow.com/users/89817/gordon-davisson"}, "edited": false, "score": 1, "creation_date": 1557258796, "post_id": 56028459, "comment_id": 98702724, "body": "A shell command <i>must be in valid shell syntax</i>. There&#39;s not really any way around this; if you want to use English on the command line, you need to represent it in a shell-compatible form (i.e. use appropriate quotes, escapes, etc). If you want your program to accept plain English text, you can have it read input from the terminal after starting, rather than taking it as argument(s)."}], "answers": [{"tags": [], "owner": {"reputation": 1338, "user_id": 4360353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16f921d78049db0195bb3fc3cda8e0f0?s=128&d=identicon&r=PG&f=1", "display_name": "Basya", "link": "https://stackoverflow.com/users/4360353/basya"}, "is_accepted": false, "score": 1, "last_activity_date": 1557253648, "creation_date": 1557253648, "answer_id": 56028533, "question_id": 56028459, "link": "https://stackoverflow.com/questions/56028459/passing-punctuaton-marks-through-command-line-in-c/56028533#56028533", "title": "Passing punctuaton marks through command line in C", "body": "<p>The issue here is not with C.  This is how the command line works.  there are characters with special meaning.  Quotation marks allow you to override that.  That is the 'fix'.  </p>\n"}, {"comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1557254526, "post_id": 56028537, "comment_id": 98700936, "body": "I&#39;d actually have said &quot;single- or (in some cases) double-quotes.&quot;  Single-quoting is stronger quoting in most shells.  In bash and other Bourne-family shells, for instance, the only thing single-quoting doesn&#39;t quote is single quotes, whereas certain characters are still special inside double quotes.  But +1, regardless."}, {"owner": {"reputation": 1337, "user_id": 903766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94253e3b2045fbf75c05e81a92035e37?s=128&d=identicon&r=PG", "display_name": "ctt", "link": "https://stackoverflow.com/users/903766/ctt"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1557254736, "post_id": 56028537, "comment_id": 98701033, "body": "Yeah; this was my original wording and is actually my preference (single quotes first, then double quotes if necessary).  Since this wording implies that single quotes are less effective, I&#39;ll revert."}], "tags": [], "owner": {"reputation": 1337, "user_id": 903766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94253e3b2045fbf75c05e81a92035e37?s=128&d=identicon&r=PG", "display_name": "ctt", "link": "https://stackoverflow.com/users/903766/ctt"}, "is_accepted": true, "score": 5, "last_activity_date": 1557254768, "last_edit_date": 1557254768, "creation_date": 1557253685, "answer_id": 56028537, "question_id": 56028459, "link": "https://stackoverflow.com/questions/56028459/passing-punctuaton-marks-through-command-line-in-c/56028537#56028537", "title": "Passing punctuaton marks through command line in C", "body": "<p>The problem here is less to do with your program and more to do with what is invoking it.  </p>\n\n<p>When invoking your program from a shell (like <code>bash</code>), the shell will try to do you a favor and split the command line arguments on whitespace.  It'll also interpret special characters like <code>&gt;</code>, <code>;</code> and <code>(</code> for redirection, splitting commands, and starting subshells.</p>\n\n<p>In order to turn this behavior off, these special characters must be escaped by preceding them with a <code>\\</code> or by enclosing command line arguments in single- or (only in most cases) double-quotes.</p>\n\n<p>This is only a requirement if your program is executed by a shell.  If it's executed by a program you control, you will have direct control over the list of arguments passed to your program (the <code>argv</code> in your program's <code>main()</code> function).</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 11466075, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-9zvKBSI7bCc/AAAAAAAAAAI/AAAAAAAAACY/cjcFHTtRkCA/photo.jpg?sz=128", "display_name": "Mkedher", "link": "https://stackoverflow.com/users/11466075/mkedher"}, "is_accepted": false, "score": 0, "last_activity_date": 1557254704, "creation_date": 1557254704, "answer_id": 56028754, "question_id": 56028459, "link": "https://stackoverflow.com/questions/56028459/passing-punctuaton-marks-through-command-line-in-c/56028754#56028754", "title": "Passing punctuaton marks through command line in C", "body": "<p>you can skip the input by <code>\\</code>.\nSo, the script does not interpret the caracter. Instead of that, it will consider it litteraly.</p>\n"}], "owner": {"reputation": 111, "user_id": 8836731, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b1496b07acdeecab382cee42222b3700?s=128&d=identicon&r=PG&f=1", "display_name": "Nicola Amadio", "link": "https://stackoverflow.com/users/8836731/nicola-amadio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 252, "favorite_count": 0, "closed_date": 1557280788, "accepted_answer_id": 56028537, "answer_count": 3, "score": 0, "last_activity_date": 1557280900, "creation_date": 1557253295, "question_id": 56028459, "link": "https://stackoverflow.com/questions/56028459/passing-punctuaton-marks-through-command-line-in-c", "closed_reason": "Duplicate", "title": "Passing punctuaton marks through command line in C", "body": "<p>I have a program that reads a natural language sentence from command line and does something with it.</p>\n\n<p>Some punctuation marks are not accepted: either I get a specific error message (like when I use parenthesis), or I get <code>&gt;</code>(for example when I type <code>'</code>), as if the terminal is still waiting for something.</p>\n\n<p>A quick fix is to include the single \"problematic\" words in quotation marks, but it doesn't seem like a great fix to me.</p>\n\n<p>Isn't there a way to prepare the command line to take any character as a valid input, without having the 'user' to think about what to include in quotation marks or not?</p>\n\n<p>For the sake of completeness, that's how I coded the command line thing: <code>int main(int argc , char ** argv){</code>, I guess it's the standard way.</p>\n\n<p>I'm using the last Ubuntu, don't know if that's relevant.</p>\n"}, {"tags": ["c", "openssl", "cryptography", "elgamal"], "comments": [{"owner": {"reputation": 36469, "user_id": 238704, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VgOZI.png?s=128&g=1", "display_name": "President James K. Polk", "link": "https://stackoverflow.com/users/238704/president-james-k-polk"}, "edited": false, "score": 0, "creation_date": 1557277615, "post_id": 56028294, "comment_id": 98707667, "body": "I did not find any such function in my perusal."}, {"owner": {"reputation": 3791, "user_id": 1820553, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-NZb6uZzo4Gg/AAAAAAAAAAI/AAAAAAAAAo0/xTr6RvgMTRw/photo.jpg?sz=128", "display_name": "kelalaka", "link": "https://stackoverflow.com/users/1820553/kelalaka"}, "edited": false, "score": 0, "creation_date": 1557300696, "post_id": 56028294, "comment_id": 98713810, "body": "You can use <a href=\"https://www.shoup.net/ntl/\" rel=\"nofollow noreferrer\">NTL</a> library, <a href=\"https://saadquader.wordpress.com/2017/08/25/finding-primitive-roots-of-unity-in-a-finite-field-c-code-using-ntl/\" rel=\"nofollow noreferrer\">here</a> example."}, {"owner": {"reputation": 79299, "user_id": 589259, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vJbKg.jpg?s=128&g=1", "display_name": "Maarten Bodewes", "link": "https://stackoverflow.com/users/589259/maarten-bodewes"}, "edited": false, "score": 0, "creation_date": 1557335433, "post_id": 56028294, "comment_id": 98733257, "body": "There is <code>BN_mod_sqrt</code> which takes the <i>square</i> root, but I guess that&#39;s not what you are looking for."}], "owner": {"reputation": 37, "user_id": 10239095, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Nabla", "link": "https://stackoverflow.com/users/10239095/nabla"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 83, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1557252546, "creation_date": 1557252546, "question_id": 56028294, "link": "https://stackoverflow.com/questions/56028294/how-to-generate-primitive-root-modulo-n-using-openssl", "title": "How to generate primitive root modulo n using OpenSSL?", "body": "<p>I need to generate primitive root modulo n for ElGamal cryptosystem, where n - is big prime number. How can I generate it using OpenSSL?</p>\n\n<p>Is there special function like primitive_root(...)? I didn't found enything like this.</p>\n"}, {"tags": ["c", "struct"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1557251685, "post_id": 56028081, "comment_id": 98699673, "body": "There&#39;s no way to make it 13. It has to be padded based on the biggest alignment requirement."}, {"owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 0, "creation_date": 1557251752, "post_id": 56028081, "comment_id": 98699708, "body": "The compiler does what it thinks is more efficient. Some compilers may offer extensions that allow the struct to be packed (free space eliminated), but this is non-standard."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1557251802, "post_id": 56028081, "comment_id": 98699733, "body": "@Barmar: It can be made 13 by requesting that the structure be packed, a feature of common compilers."}, {"owner": {"reputation": 1, "user_id": 11466075, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-9zvKBSI7bCc/AAAAAAAAAAI/AAAAAAAAACY/cjcFHTtRkCA/photo.jpg?sz=128", "display_name": "Mkedher", "link": "https://stackoverflow.com/users/11466075/mkedher"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1557252407, "post_id": 56028081, "comment_id": 98700024, "body": "@Eric Postpischil thank you for the link. I am using  IAR to program a microcontroller and I have many structures. so, RAM memory spcace matter for me.."}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1557254457, "post_id": 56028081, "comment_id": 98700901, "body": "For compactness, order the elements of your struct by size, largest first."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1557256185, "post_id": 56028081, "comment_id": 98701649, "body": "@LeeDanielCrocker: Largest first would put large arrays (e.g., <code>char [351]</code>) or structures before some types with stricter alignment requirements. The proper criterion is to sort by alignment requirement, strictest first."}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1557259575, "post_id": 56028081, "comment_id": 98703071, "body": "True; I was simplifying for the audience."}], "owner": {"reputation": 1, "user_id": 11466075, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-9zvKBSI7bCc/AAAAAAAAAAI/AAAAAAAAACY/cjcFHTtRkCA/photo.jpg?sz=128", "display_name": "Mkedher", "link": "https://stackoverflow.com/users/11466075/mkedher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 24, "favorite_count": 0, "closed_date": 1557251759, "answer_count": 0, "score": 0, "last_activity_date": 1557251701, "creation_date": 1557251613, "last_edit_date": 1557251701, "question_id": 56028081, "link": "https://stackoverflow.com/questions/56028081/haw-to-optimize-structure-mapping-on-the-memory", "closed_reason": "Duplicate", "title": "haw to optimize structure mapping on the memory", "body": "<p>i have a structure declared like th following :</p>\n\n<pre><code>struct myStruct\n{\n    char c;\n    int i;\n    float f[2];\n};\n</code></pre>\n\n<p>the sizeof gives 16, where the sizes of types are 4, 4, 1.\nmy question is why the sizeof does not give 13?.. should I modify somthing to have the right size?</p>\n"}, {"tags": ["c", "dwarf", "readelf"], "comments": [{"owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 0, "creation_date": 1557251102, "post_id": 56027823, "comment_id": 98699416, "body": "Looks like DW_AT_ is related to the Abbreviation Table for <a href=\"https://en.wikipedia.org/wiki/DWARF\" rel=\"nofollow noreferrer\">DWARF</a>, from the manual at <a href=\"https://gcc-renesas.com/gnu-tools-manuals/gnu-sh-user-manual/\" rel=\"nofollow noreferrer\">gcc-renesas.com/gnu-tools-manuals/gnu-sh-user-manual</a>"}, {"owner": {"reputation": 67, "user_id": 1426923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfa7f036bf30f75ce66f550a57184e67?s=128&d=identicon&r=PG", "display_name": "user1426923", "link": "https://stackoverflow.com/users/1426923/user1426923"}, "reply_to_user": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 0, "creation_date": 1557258860, "post_id": 56027823, "comment_id": 98702748, "body": "I looked, and didn&#39;t find anything that popped out that explained why some local variables have a location specified and others do not, got any insights?"}], "owner": {"reputation": 67, "user_id": 1426923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfa7f036bf30f75ce66f550a57184e67?s=128&d=identicon&r=PG", "display_name": "user1426923", "link": "https://stackoverflow.com/users/1426923/user1426923"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 89, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1557250521, "creation_date": 1557250521, "question_id": 56027823, "link": "https://stackoverflow.com/questions/56027823/reading-the-output-of-readelf-wi-why-do-some-local-variables-have-a-dw-at-loca", "title": "reading the output of readelf -wi, why do some local variables have a DW_AT_location value, but others do not?", "body": "<p>I am running readelf -wi file.elf, and looking at the output. I am looking at some of the debug info for local variables, I can find all the variables listed (they all have DW_AT_name), but some do not have</p>\n\n<pre><code>DW_AT_location : stuff\n</code></pre>\n\n<p>why?</p>\n\n<p>Is there a way to get the location of local variables that don't have this line? No I cannot recompile the code, I have the source, but cannot edit it or recompile it with more gcc flags or anything. I have the dissasembly and elf file (obviously).</p>\n"}, {"tags": ["c", "sockets", "send"], "comments": [{"owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 0, "creation_date": 1557250186, "post_id": 56027703, "comment_id": 98698962, "body": "What type is <code>sent</code>? <code>send</code> returns a value of type <code>ssize_t</code>"}, {"owner": {"reputation": 1360, "user_id": 9850902, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WooeI.png?s=128&g=1", "display_name": "GJCode", "link": "https://stackoverflow.com/users/9850902/gjcode"}, "reply_to_user": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 0, "creation_date": 1557250238, "post_id": 56027703, "comment_id": 98698984, "body": "I have ssize_t sent"}, {"owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 1, "creation_date": 1557250320, "post_id": 56027703, "comment_id": 98699026, "body": "You don&#39;t seem to check that the return value of <code>send</code> is not less than 0. How do you know it was successful?"}, {"owner": {"reputation": 1360, "user_id": 9850902, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WooeI.png?s=128&g=1", "display_name": "GJCode", "link": "https://stackoverflow.com/users/9850902/gjcode"}, "reply_to_user": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 0, "creation_date": 1557250403, "post_id": 56027703, "comment_id": 98699058, "body": "I&#39;m building this method step by step, for now I have a printf to check and on small files everything is ok"}, {"owner": {"reputation": 507, "user_id": 2654727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c319a24a493153df59e86b43ff78fde0?s=128&d=identicon&r=PG", "display_name": "Tom Drake", "link": "https://stackoverflow.com/users/2654727/tom-drake"}, "edited": false, "score": 1, "creation_date": 1557250712, "post_id": 56027703, "comment_id": 98699205, "body": "It&#39;s usually best to read the file in chunks (e.g. 8192 bytes) and send write each chunk back to the socket. That way you don&#39;t have to allocate a huge amount of memory to handle this request. Besides, your data will be split up into chunks at the tcp/ip level anyway. So, you gain no advantage by trying to send it all in a single call."}], "answers": [{"comments": [{"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 2, "creation_date": 1557251300, "post_id": 56027812, "comment_id": 98699502, "body": "There is no need for a branch. OP should first to_send to the size of the buffer, and than decrease it by the value by the number of sent bytes, and use it as a size argument to <code>send</code> function."}], "tags": [], "owner": {"reputation": 15724, "user_id": 5754656, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/7jfX3.png?s=128&g=1", "display_name": "Artyer", "link": "https://stackoverflow.com/users/5754656/artyer"}, "is_accepted": true, "score": 3, "last_activity_date": 1557250476, "creation_date": 1557250476, "answer_id": 56027812, "question_id": 56027703, "link": "https://stackoverflow.com/questions/56027703/max-size-t-value-on-send-in-c/56027812#56027812", "title": "max size_t value on send() in C", "body": "<p>The problem is that you send <code>buf_size</code> bytes every time, even if there aren't that many left.</p>\n\n<p>For example, pretend <code>buf_size</code> is 8 and you are sending 10 bytes (So initially, <code>to_send</code> is also 10). The first <code>send</code> sends 8 bytes, so you need to send 2 more. The second time, you also send 8 bytes (Which probably reads out of bounds). Then, <code>to_send</code> will be will be -6, which is the same as <code>SIZE_MAX - 5</code>.</p>\n\n<p>Simple fix is to send <code>to_send</code> if it is smaller:</p>\n\n<pre><code>sent = send(socket, sbuf, to_send &lt; buf_size ? to_send : buf_size, 0);\n</code></pre>\n\n<p>Also, <code>send</code> returns <code>-1</code> if it is unsuccessful. This is the same as <code>SIZE_MAX</code> when it is assigned to a <code>size_t</code>. You would need some error handling to fix this.</p>\n"}, {"comments": [{"owner": {"reputation": 1360, "user_id": 9850902, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WooeI.png?s=128&g=1", "display_name": "GJCode", "link": "https://stackoverflow.com/users/9850902/gjcode"}, "edited": false, "score": 0, "creation_date": 1557251568, "post_id": 56027899, "comment_id": 98699630, "body": "my file size will fit in ssize, I have an errno=32 -&gt; SIGPIPE"}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 0, "last_activity_date": 1557250827, "creation_date": 1557250827, "answer_id": 56027899, "question_id": 56027703, "link": "https://stackoverflow.com/questions/56027703/max-size-t-value-on-send-in-c/56027899#56027899", "title": "max size_t value on send() in C", "body": "<blockquote>\n  <p>On huge files sent becomes equals to the max value of size_t, I think\n  that I have a buffer overflow.</p>\n</blockquote>\n\n<p>Since <code>sent</code> gets its value as the return value of <code>send()</code>, and <code>send()</code> returns <code>ssize_t</code>, which is a signed type unlikely to be wider than <code>size_t</code>, it is virtually certain that what is actually happening is that <code>send()</code> is indicating an error by returning -1.  In that case, it will also be setting <code>errno</code> to a value indicative of the error.  It cannot return the maximum value of <code>size_t</code> on any system I've ever had my hands on.</p>\n\n<blockquote>\n  <p>How can I prevent this?</p>\n</blockquote>\n\n<p>In the first place, before you worry about <em>preventing</em> it, you should be sure to <em>detect</em> it by</p>\n\n<ol>\n<li>declaring <code>sent</code> as a <code>ssize_t</code> to match the return type of <code>send()</code>, not a <code>size_t</code>, and</li>\n<li>checking the value returned into <code>sent</code> for such error conditions.</li>\n</ol>\n\n<p>Second, if you are really dealing with files longer than can be represented by a <code>ssize_t</code> (much less a <code>size_t</code>), then it is a poor idea to load the whole thing into memory before sending any of it.  Instead, load it in (much) smaller blocks, and send the data one such block at a time.  Not only will this tend to have lower perceived latency, but it will also avoid any risk associated with approaching the limits of the data types involved.</p>\n\n<p>Additionally, when you do so, be careful to do it right.  You have done well to wrap your <code>send()</code> call in a loop to account for short writes, but as @Artyer describes in his answer, you don't quite get that right because you do not reduce the number of bytes you try to send on the second and subsequent calls.</p>\n\n<blockquote>\n  <p>What is the\n  best practice to read from a file and send it back?</p>\n</blockquote>\n\n<p>As above.</p>\n"}], "owner": {"reputation": 1360, "user_id": 9850902, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WooeI.png?s=128&g=1", "display_name": "GJCode", "link": "https://stackoverflow.com/users/9850902/gjcode"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 56027812, "answer_count": 2, "score": -1, "last_activity_date": 1557250827, "creation_date": 1557249984, "question_id": 56027703, "link": "https://stackoverflow.com/questions/56027703/max-size-t-value-on-send-in-c", "title": "max size_t value on send() in C", "body": "<p>I'm writing a tcp server in C but I'm facing problems on send. I read local file and send data back to the client, when the file is small I have no problems, but when it becomes bigger I have this strange situation:</p>\n\n<p>server tcp:</p>\n\n<pre><code> // create socket, bind, listen accept\n\n// read file\nfseek(fptr, 0, SEEK_SET);\n// malloc for the sending buffer\nssize_t read = fread(sbuf, 1, file_size, fptr);\n\nwhile(to_send&gt;0) {\n  sent = send(socket, sbuf, buf_size, 0);\n  sbuf += sent;\n  to_send -= sent;\n}\n</code></pre>\n\n<p>On huge files sent becomes equals to the max value of size_t, I think that I have a buffer overflow. How can I prevent this? What is the best practice to read from a file and send it back?</p>\n"}, {"tags": ["c", "assembly", "embedded", "disassembly", "stm8"], "comments": [{"owner": {"reputation": 587, "user_id": 6012693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5be83dfa8bf9e72bec3204f60fee1dbd?s=128&d=identicon&r=PG&f=1", "display_name": "tum_", "link": "https://stackoverflow.com/users/6012693/tum"}, "edited": false, "score": 0, "creation_date": 1557250444, "post_id": 56027678, "comment_id": 98699081, "body": "Not familiar with your tools but it&#39;s probably a library function. Adds the content of A to a 32-bit variable. You might want to examine the map file to see where this symbol comes from."}], "answers": [{"comments": [{"owner": {"reputation": 1167, "user_id": 932786, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/49bf3465e918ef75eb511f089b833bb1?s=128&d=identicon&r=PG", "display_name": "Salahuddin", "link": "https://stackoverflow.com/users/932786/salahuddin"}, "edited": false, "score": 0, "creation_date": 1557251083, "post_id": 56027776, "comment_id": 98699406, "body": "Thanks for the explanation. I now know what <code>c_lgadc</code> is or can be. Could you please tell me how can I prevent it from increasing my variable unexpectedly? Or how can I know what part of my C code can cause this <code>c_lgadc</code> increase this variable?"}, {"owner": {"reputation": 53754, "user_id": 198536, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9edaf4c1c1b89b5d39c40528d0017509?s=128&d=identicon&r=PG", "display_name": "wallyk", "link": "https://stackoverflow.com/users/198536/wallyk"}, "reply_to_user": {"reputation": 1167, "user_id": 932786, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/49bf3465e918ef75eb511f089b833bb1?s=128&d=identicon&r=PG", "display_name": "Salahuddin", "link": "https://stackoverflow.com/users/932786/salahuddin"}, "edited": false, "score": 0, "creation_date": 1557251834, "post_id": 56027776, "comment_id": 98699747, "body": "@Salahuddin:  If you can run the code under a debugger, you could breakpoint in the function and then single step until it returns.  But since you are using a disassembly, it is much more difficult.  Probably there are lots of places where this function is called like multi-word extended arithmetic and <i>creative</i> boolean logic evaluation.  You&#39;d have to look at every reference to it and somehow determine (I don&#39;t know how) whether that call is a candidate suspect."}, {"owner": {"reputation": 1167, "user_id": 932786, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/49bf3465e918ef75eb511f089b833bb1?s=128&d=identicon&r=PG", "display_name": "Salahuddin", "link": "https://stackoverflow.com/users/932786/salahuddin"}, "edited": false, "score": 0, "creation_date": 1557301628, "post_id": 56027776, "comment_id": 98714275, "body": "I do run the code under an ST-LINK debugger. I defined a breakpoint to occur if the memory location (where my variable is saved) is modified. When running the code, a breakpoint occur but not in my C code. Therefore, I opened the disassembly window and there was the breakpoint."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1557306267, "post_id": 56027776, "comment_id": 98716609, "body": "Specifically, JRNC = jump if carry not set. JRNE = jump if not equal (zero)."}], "tags": [], "owner": {"reputation": 53754, "user_id": 198536, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9edaf4c1c1b89b5d39c40528d0017509?s=128&d=identicon&r=PG", "display_name": "wallyk", "link": "https://stackoverflow.com/users/198536/wallyk"}, "is_accepted": false, "score": 1, "last_activity_date": 1557250313, "creation_date": 1557250313, "answer_id": 56027776, "question_id": 56027678, "link": "https://stackoverflow.com/questions/56027678/understanding-functions-in-stm8s-disassembly/56027776#56027776", "title": "Understanding functions in stm8s disassembly?", "body": "<p>The function <code>c_lgadc</code> looks like part of a runtime library.  Suggested by context, it is probably an <em>add carry flag</em> function because it is between the <em>compare</em> and <em>unsigned right shift</em> functions.</p>\n\n<p>The <code>c_l</code> and <code>c_lg</code> prefixes for these functions are probably some part of a scheme indicate the types of the operands or their result.</p>\n\n<p>As to your question, <code>adc</code> occurs in the instruction set of several CPU architectures, namely the intel x86 and motorola 680x.  It means:</p>\n\n<ul>\n<li>If the carry flag (unsigned arithmetic overflow  or  shift through carrry flag) is zero, return the operand as the result.</li>\n<li>If the carry flag is set, return the result as one added to the operand.   </li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 13767, "user_id": 2413201, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/rxfuw.jpg?s=128&g=1", "display_name": "Armali", "link": "https://stackoverflow.com/users/2413201/armali"}, "is_accepted": false, "score": 2, "last_activity_date": 1557316632, "creation_date": 1557316632, "answer_id": 56040272, "question_id": 56027678, "link": "https://stackoverflow.com/questions/56027678/understanding-functions-in-stm8s-disassembly/56040272#56040272", "title": "Understanding functions in stm8s disassembly?", "body": "<blockquote>\n  <p>I've noticed that when I step over or into in the debugger, it comes to the last line of a specific timer ISR.</p>\n</blockquote>\n\n<p>So, this timer ISR increments a 4-byte integer variable, and this variable overlaps with your variable. How such overlapping occurs might be revealed by inspecting that ISR or the link map, or it may be that the index register X is not correctly set in the ISR.</p>\n"}], "owner": {"reputation": 1167, "user_id": 932786, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/49bf3465e918ef75eb511f089b833bb1?s=128&d=identicon&r=PG", "display_name": "Salahuddin", "link": "https://stackoverflow.com/users/932786/salahuddin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 291, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1557316632, "creation_date": 1557249861, "last_edit_date": 1557310241, "question_id": 56027678, "link": "https://stackoverflow.com/questions/56027678/understanding-functions-in-stm8s-disassembly", "title": "Understanding functions in stm8s disassembly?", "body": "<p>I'm programming an STM8S microcontroller using STVD IDE. It uses the COSMIC compiler.</p>\n\n<p>I found that there is a veriable that is increased unexpectedly. When debugging I found that there is a line in the assembly code that causes this variable to increase its value. It's a function named <code>c_lgadc</code>. Sometimes this assembly line is called while there is no <code>ADC</code> related function is shown in the call stack. </p>\n\n<p>I don't understand where this code comes from and what is this <code>c_lgadc</code>? I have no function in my C code named <code>c_lgadc</code></p>\n\n<p>Here is a screenshot of the disassembly.\n<a href=\"https://i.stack.imgur.com/qPYUX.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qPYUX.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>UPDATE:</strong></p>\n\n<ul>\n<li>I don't know what C code should I examine as the call stack is\ndifferent every time this disassembly line is called.</li>\n<li>I've noticed that when I step over or into in the debugger, it comes\nto the last line of a specific timer ISR. </li>\n<li>I've also noticed that the line with the second breakpoint is the one that   causes addition to my variable.\nThe line with first breakpoint is called always 5 times then the line\nwith second breakpoint is called once and so on.</li>\n<li>I'd like to know how should I debug this further to prevent the unexpected addition to my variable.</li>\n</ul>\n\n<p><strong>UPDATE2:</strong></p>\n\n<p>I found the following in the <code>map file</code>:</p>\n\n<pre><code>c_lgadc 0000f39c defined in (C:\\Users\\xxxxxxxx\\CXSTM8\\Lib\\libm0.sm8)lgadc.o section .text\n                 used in Debug\\stm8s_it.o\n</code></pre>\n\n<p>I'm not sure if this would help in clarifying the problem?</p>\n"}, {"tags": ["c", "uart", "atmega"], "comments": [{"owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 0, "creation_date": 1557249886, "post_id": 56027648, "comment_id": 98698850, "body": "Those values are typically macros contained in device-specific header files. They expand to the index of the bits used."}, {"owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 2, "creation_date": 1557250252, "post_id": 56027648, "comment_id": 98698993, "body": "Please do not post code as images. It didn&#39;t appear in your question because it wasn&#39;t formatted as code."}, {"owner": {"reputation": 17, "user_id": 11097585, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-r_yFmgZ3ozc/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQPfsoNJ7yKg_-AVVM_-qDG1oHbYFQ/mo/photo.jpg?sz=128", "display_name": "PRASH", "link": "https://stackoverflow.com/users/11097585/prash"}, "reply_to_user": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 0, "creation_date": 1557250351, "post_id": 56027648, "comment_id": 98699037, "body": "when i use &lt;&lt; operator contents after that are not appearing"}, {"owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 0, "creation_date": 1557250407, "post_id": 56027648, "comment_id": 98699059, "body": "See this page for information on how to format questions: <a href=\"https://stackoverflow.com/editing-help\">stackoverflow.com/editing-help</a>."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1557251328, "post_id": 56027648, "comment_id": 98699517, "body": "Do not post code as image."}, {"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1557252077, "post_id": 56027648, "comment_id": 98699864, "body": "Please select your code and mark it as code; it&#39;s currently illegible."}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 11097585, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-r_yFmgZ3ozc/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQPfsoNJ7yKg_-AVVM_-qDG1oHbYFQ/mo/photo.jpg?sz=128", "display_name": "PRASH", "link": "https://stackoverflow.com/users/11097585/prash"}, "edited": false, "score": 0, "creation_date": 1557251373, "post_id": 56027888, "comment_id": 98699532, "body": "U mean 1 &lt;&lt; D4 or 1&lt;&lt; 4and 1&lt;&lt; D3 or 1&lt;&lt;3 is what 1&lt;&lt; Rxen and 1&lt;&lt;txen means"}, {"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1557252143, "post_id": 56027888, "comment_id": 98699887, "body": "From now on I will call you 458654."}, {"owner": {"reputation": 17, "user_id": 11097585, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-r_yFmgZ3ozc/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQPfsoNJ7yKg_-AVVM_-qDG1oHbYFQ/mo/photo.jpg?sz=128", "display_name": "PRASH", "link": "https://stackoverflow.com/users/11097585/prash"}, "edited": false, "score": 0, "creation_date": 1557252250, "post_id": 56027888, "comment_id": 98699947, "body": "What is that 458654, I dint get what ur telling,I want the answer"}, {"owner": {"reputation": 17, "user_id": 11097585, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-r_yFmgZ3ozc/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQPfsoNJ7yKg_-AVVM_-qDG1oHbYFQ/mo/photo.jpg?sz=128", "display_name": "PRASH", "link": "https://stackoverflow.com/users/11097585/prash"}, "edited": false, "score": 0, "creation_date": 1557333373, "post_id": 56027888, "comment_id": 98732270, "body": "@P__J__ I understood now"}], "tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": 0, "last_activity_date": 1557250791, "creation_date": 1557250791, "answer_id": 56027888, "question_id": 56027648, "link": "https://stackoverflow.com/questions/56027648/how-does-bitwise-operator-work-the-avr-atmega-register/56027888#56027888", "title": "How does bitwise operator work the avr atmega register?", "body": "<p>there are definitions  of the bit numbers of the corresponding  bits in the hardware registers. it is easier for humans to remember names not numbers </p>\n"}], "owner": {"reputation": 17, "user_id": 11097585, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-r_yFmgZ3ozc/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQPfsoNJ7yKg_-AVVM_-qDG1oHbYFQ/mo/photo.jpg?sz=128", "display_name": "PRASH", "link": "https://stackoverflow.com/users/11097585/prash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1557252129, "creation_date": 1557249703, "last_edit_date": 1557252129, "question_id": 56027648, "link": "https://stackoverflow.com/questions/56027648/how-does-bitwise-operator-work-the-avr-atmega-register", "title": "How does bitwise operator work the avr atmega register?", "body": "<p>In the below code image bitwise left shift operator is used with the register for uart initialization,How does that left shift operator (1(left shift)RXEN),(1(left shift)) work when register bit(RXEN,TXEN) is not initialised</p>\n\n<p><a href=\"https://i.stack.imgur.com/6R3KE.png\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n\n<p>Here is the link for Register description and code\n<a href=\"https://exploreembedded.com/wiki/UART_Programming_with_Atmega128\" rel=\"nofollow noreferrer\">https://exploreembedded.com/wiki/UART_Programming_with_Atmega128</a></p>\n"}, {"tags": ["c", "x86-64", "addition", "integer-overflow", "extended-precision"], "comments": [{"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 4, "creation_date": 1557249277, "post_id": 56027411, "comment_id": 98698600, "body": "Can you use GCC or Clang built-ins? <code>carry = __builtin_add_overflow(a, b, &amp;res)</code> stores the low bits of the result in <code>res</code> and sets <code>carry</code> to if overflow occurred. (The function actually returns a <code>bool</code> that is <code>true</code> or <code>false</code>, so assigning it to <code>carry</code> will produce 1 or 0.)"}, {"owner": {"reputation": 6093, "user_id": 2189500, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/109f747845a9ce762a1fff72eb8cf6f3?s=128&d=identicon&r=PG", "display_name": "David Wohlferd", "link": "https://stackoverflow.com/users/2189500/david-wohlferd"}, "edited": false, "score": 1, "creation_date": 1557258898, "post_id": 56027411, "comment_id": 98702762, "body": "Note that msvc (if that&#39;s what you are using) also has a builtin for efficiently handling overflow (<a href=\"https://docs.microsoft.com/en-us/cpp/intrinsics/x64-amd64-intrinsics-list?view=vs-2019\" rel=\"nofollow noreferrer\">_addcarry_u64</a>)."}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1557400200, "post_id": 56027411, "comment_id": 98756588, "body": "Why do you assing <code>-1</code> to an unsigned int number?  That is Undefined Behaviour and you can get anything from that, even a program crash."}], "answers": [{"comments": [{"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 2, "creation_date": 1557249484, "post_id": 56027540, "comment_id": 98698687, "body": "The <code>? 1 : 0</code> is superfluous."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1557249527, "post_id": 56027540, "comment_id": 98698705, "body": "@jxh This is depending on the style dictated by the house rules."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1557249752, "post_id": 56027540, "comment_id": 98698800, "body": "@EugeneSh. What do you mean?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1557249893, "post_id": 56027540, "comment_id": 98698859, "body": "@Broman By what? Some style guides tell to explicitly state the <i>integer</i> values resulting from conditional. Some may even require to have an <code>if&#47;else</code> construct here. You are free to pick one."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1557250355, "post_id": 56027540, "comment_id": 98699038, "body": "@EugeneSh. I get it. Thanks."}], "tags": [], "owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "is_accepted": false, "score": 7, "last_activity_date": 1557249241, "creation_date": 1557249241, "answer_id": 56027540, "question_id": 56027411, "link": "https://stackoverflow.com/questions/56027411/get-unsigned-long-long-addition-carry/56027540#56027540", "title": "get unsigned long long addition carry", "body": "<p>Carry can be only <code>0</code> or <code>1</code>. <code>1</code> if there was a wrapping-around and <code>0</code> otherwise. \nThe wrapping-around is happening in case <code>a + b &gt; ULONG_LONG_MAX</code> is true . Note, this is in mathematical terms, not in terms of C, as if <code>a + b</code> is actually overflowing, then this will not work. Instead you want to rearrange it to be <code>a &gt; ULONG_LONG_MAX - b</code>. So the value of carry will be:</p>\n\n<pre><code>carry = a &gt; ULONG_LONG_MAX - b ? 1 : 0;\n</code></pre>\n\n<p>or any preferred style equivalent.</p>\n\n<ul>\n<li>Don't forget to include <code>limits.h</code>.</li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 3, "creation_date": 1557261701, "post_id": 56027633, "comment_id": 98703977, "body": "Warning: extending this to <code>carry_out = (a + b + carry_in) &lt; a</code> <i>doesn&#39;t</i> work, because for example <code>b = 0xFFFF...</code> and <code>carry_in = 1</code> has already produced a carry that you won&#39;t detect with <code>a + 0 &lt; a</code> being false.  But yes, for add with carry-out but not carry-in, this works great.  And modern compilers often can optimize <code>c+d + carry</code> into an <code>adc</code> instruction.  You only run into big problems getting compilers to emit a chain of add/adc/adc/adc where you need to use the carry-out from an <code>adc</code>, not <code>add</code>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1557279603, "post_id": 56027633, "comment_id": 98707961, "body": "&quot;As long as both have unsigned types ...&quot; + &quot; and at least one type at least <code>unsigned</code>&quot;.  <code>(a + b) &lt; a</code> insufficient for <code>unsigned char</code>"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1557312361, "post_id": 56027633, "comment_id": 98720039, "body": "@chux, &quot;[...]  reports correctly on whether the sum overflows the wider of their types <b><i>or unsigned int</i></b> (whichever is wider).&quot;"}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 10, "last_activity_date": 1557249950, "last_edit_date": 1557249950, "creation_date": 1557249638, "answer_id": 56027633, "question_id": 56027411, "link": "https://stackoverflow.com/questions/56027411/get-unsigned-long-long-addition-carry/56027633#56027633", "title": "get unsigned long long addition carry", "body": "<p>As @EugeneSh. observes, the carry is either 0 or 1.  Moreover, given that <code>a</code> and <code>b</code> both have the same <em>unsigned</em> type, their sum is well defined even if the arithmetic result exceeds the range of their type.  Moreover, the (C) result of the sum will be less than both <code>a</code> and <code>b</code> when overflow occurs, and greater otherwise, so we can use the fact that C relational operations evaluate to either 0 or 1 to express the carry bit as</p>\n\n<pre><code>carry = (a + b) &lt; a;\n</code></pre>\n\n<p>That does not require any headers, nor does it depend on a specific upper bound, or even on <code>a</code> and <code>b</code> having the same type.  As long as both have unsigned types, it reports correctly on whether the sum overflows the wider of their types or <code>unsigned int</code> (whichever is wider), which is the same as their sum setting the carry bit.  As a bonus, it is expressed in terms of the sum itself, which I think makes it clear what's being tested.</p>\n"}], "owner": {"reputation": 131, "user_id": 10259993, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-mxiwaamNdk4/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaOtBoAFO_Qb51VT6bEuCbqR4pfYWw/mo/photo.jpg?sz=128", "display_name": "neo5003", "link": "https://stackoverflow.com/users/10259993/neo5003"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 607, "favorite_count": 1, "accepted_answer_id": 56027633, "answer_count": 2, "score": 12, "last_activity_date": 1557261922, "creation_date": 1557248718, "last_edit_date": 1557261922, "question_id": 56027411, "link": "https://stackoverflow.com/questions/56027411/get-unsigned-long-long-addition-carry", "title": "get unsigned long long addition carry", "body": "<p>I want to get the carry bit of adding two unsigned 64-bit integers in c.\nI can use x86-64 asm if needed.\ncode:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\ntypedef unsigned long long llu;\n\nint main(void){\n  llu a = -1, b = -1;\n  int carry = /*carry of a+b*/;\n  llu res = a+b;\n  printf(\"a+b = %llu (because addition overflowed), carry bit = %d\\n\", res, carry);\n  return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "azure", "http", "azure-iot-hub"], "comments": [{"owner": {"reputation": 6258, "user_id": 8084828, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ad0Yr.jpg?s=128&g=1", "display_name": "Roman Kiss", "link": "https://stackoverflow.com/users/8084828/roman-kiss"}, "edited": false, "score": 0, "creation_date": 1557249542, "post_id": 56027387, "comment_id": 98698711, "body": "have a look at <a href=\"https://docs.microsoft.com/en-us/rest/api/iothub/\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/rest/api/iothub</a>"}, {"owner": {"reputation": 288, "user_id": 8876218, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-l6Yf2GsEdyo/AAAAAAAAAAI/AAAAAAAAAAw/_4lZB5uyM0s/photo.jpg?sz=128", "display_name": "Yi Zhong - MSFT", "link": "https://stackoverflow.com/users/8876218/yi-zhong-msft"}, "edited": false, "score": 0, "creation_date": 1557257947, "post_id": 56027387, "comment_id": 98707716, "body": "We&#39;d absolutely love to help you enable the SDK on your device. Can you help us by elaborating on the specific specs of your device and your requirements (only D2C?)? If you can file an issue <a href=\"https://github.com/Azure/azure-iot-sdk-c\" rel=\"nofollow noreferrer\">here</a>, that&#39;d be great. We are collecting feedback regarding SDK footprint and want to optimize it further for constrained devices."}, {"owner": {"reputation": 12794, "user_id": 686985, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nE56D.jpg?s=128&g=1", "display_name": "Stefan Wick  MSFT", "link": "https://stackoverflow.com/users/686985/stefan-wick-msft"}, "edited": false, "score": 1, "creation_date": 1557258088, "post_id": 56027387, "comment_id": 98707718, "body": "This document has guidance on how to use the MQTT protocol directly with IoTHub without using the Azure IoT device SDK: <a href=\"https://docs.microsoft.com/en-us/azure/iot-hub/iot-hub-mqtt-support#using-the-mqtt-protocol-directly-as-a-device\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/azure/iot-hub/&hellip;</a> If you see anything missing or areas for improvement, please log an issue on the documentation page."}, {"owner": {"reputation": 8769, "user_id": 1537195, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/xRBvI.jpg?s=128&g=1", "display_name": "silent", "link": "https://stackoverflow.com/users/1537195/silent"}, "edited": false, "score": 0, "creation_date": 1557299193, "post_id": 56027387, "comment_id": 98713083, "body": "You need to generate the SAS token (based on your device key), but it&#39;s not the device key itself. See <a href=\"https://github.com/Microsoft/vscode-azure-iot-toolkit/wiki/Generate-SAS-Token-for-IoT-Hub\" rel=\"nofollow noreferrer\">github.com/Microsoft/vscode-azure-iot-toolkit/wiki/&hellip;</a> and here for ways to do it: <a href=\"https://github.com/kvaes/TasmanianTraders-IoT-ConnectedVehicle-Functions/blob/master/getSASTokenByDeviceID-Secured/index.js\" rel=\"nofollow noreferrer\">github.com/kvaes/&hellip;</a>"}, {"owner": {"reputation": 337, "user_id": 6621126, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3522f3663b523beaa0e7a51168a99f3f?s=128&d=identicon&r=PG&f=1", "display_name": "bevenson", "link": "https://stackoverflow.com/users/6621126/bevenson"}, "edited": false, "score": 0, "creation_date": 1557323946, "post_id": 56027387, "comment_id": 98726981, "body": "Are the SAS tokens required for authentication?  I followed the steps in the link above and, using Postman, I was able to successfully send a D2C message with the SAS token I generated on my Azure portal using the Azure CLI.  I don&#39;t think my microcontroller is capable of calculating a SAS token."}], "answers": [{"tags": [], "owner": {"reputation": 337, "user_id": 6621126, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3522f3663b523beaa0e7a51168a99f3f?s=128&d=identicon&r=PG&f=1", "display_name": "bevenson", "link": "https://stackoverflow.com/users/6621126/bevenson"}, "is_accepted": true, "score": 1, "last_activity_date": 1557939421, "creation_date": 1557939421, "answer_id": 56154277, "question_id": 56027387, "link": "https://stackoverflow.com/questions/56027387/azure-iot-hub-http-device-to-cloud-messages-without-sdk/56154277#56154277", "title": "Azure IoT Hub: HTTP Device-to-Cloud Messages without SDK?", "body": "<p>After some trial and error, we found out it's much easier than we thought.  If you are using X.509 certificates for client authentication, you don't need to include anything in the HTTP message content to specify your authentication.  The minimum required for an Azure device-to-cloud message using X.509 certificates for authentication is:</p>\n\n<pre><code>POST /devices/&lt;id&gt;/messages/events?api-version=2018-06-30 HTTP/1.1\nHost:&lt;fully-qualified-iothubname&gt;.azure-devices.net\nContent-Length:&lt;number-of-bytes-in-the-JSON-body&gt;\n\n{\"deviceID\":\"&lt;id&gt;\",&lt;your-JSON-formatted-custom-d2c-message-data&gt;}\n</code></pre>\n\n<p>where <code>&lt;id&gt;</code> is the device ID as listed on the Azure IoT Hub and <code>&lt;fully-qualified-iothubname&gt;</code> is the IoT Hub name.  I believe Azure supports chunked encoding if you want to do that instead of using the <code>Content-Length</code> header.</p>\n"}], "owner": {"reputation": 337, "user_id": 6621126, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3522f3663b523beaa0e7a51168a99f3f?s=128&d=identicon&r=PG&f=1", "display_name": "bevenson", "link": "https://stackoverflow.com/users/6621126/bevenson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1520, "favorite_count": 1, "accepted_answer_id": 56154277, "answer_count": 1, "score": 2, "last_activity_date": 1595843101, "creation_date": 1557248592, "last_edit_date": 1557258911, "question_id": 56027387, "link": "https://stackoverflow.com/questions/56027387/azure-iot-hub-http-device-to-cloud-messages-without-sdk", "title": "Azure IoT Hub: HTTP Device-to-Cloud Messages without SDK?", "body": "<p>I'm using a 32-bit microcontroller (program code written in C) with very limited flash space that is communicating with a cellular module.  I have an Azure account setup with an IoT Hub and I would like to send some device-to-cloud messages to my IoT Hub.  I have tested and confirmed both HTTP and HTTPS communication to other servers.  However, I can't find anywhere that specifies what the required HTTP headers are for sending a device-to-cloud message.  Can anyone provide a description of the required HTTP message format (the HTTP start line, required HTTP headers and the HTTP header values)?</p>\n\n<p>I found the Azure SDK for C, but even with all the optimization options turned on it takes up too much codespace for my microcontroller.  I've tried following the code in the SDK for how the HTTP message is built, but I seem to be missing some pieces.  I only have two or three device-to-cloud messages that I am sending, so I assume that if I know what the headers are it won't take much code to generate the device-to-cloud messages.</p>\n\n<p>The cellular module I have is handling the X.509 certificates for mutual TLS authentication.  Assume that is working.  For this question I'm only concerned with finding the required HTTP message formatting for a Azure IoT device-to-cloud message.</p>\n\n<p><strong>EDIT</strong>:\nFollowing a suggestion from a comment, I was eventually led to this page:\n<a href=\"https://docs.microsoft.com/en-us/rest/api/iothub/device/senddeviceevent\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/rest/api/iothub/device/senddeviceevent</a></p>\n\n<p>Using the suggested HTTP POST (with my device specifics replaced), I am now getting a 401 error (IotHubUnauthorizedAccess).  I thought I understood how the authentication was supposed to work, but I guess I was wrong.</p>\n\n<p>My IoT device has a symmetric key. I thought I was supposed to include a header formatted as:</p>\n\n<pre><code>Authorization:SharedAccessKey=&lt;my_primary_key&gt;\n</code></pre>\n\n<p>but that doesn't work.  My HTTP body is simply:</p>\n\n<pre><code>{\"deviceID\":&lt;my_IoT_Device_ID&gt;}\n</code></pre>\n\n<p>Where am I supposed to include the symmetric key information, and what is its format?</p>\n"}, {"tags": ["c", "codeblocks", "auto-versioning"], "comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1557247579, "post_id": 56026918, "comment_id": 98697892, "body": "I am torn between being happy that you did not make an answer there which is actually just a &quot;Me too.&quot; and on the other side wondering whether this is really 100% the same question. In which case I am sorry to say that duplicates are off-topic. If you do not highlight anything which makes this different then you will also have no real chance that anyone answers. Why should they?. I am not close-voting or downvoting now, because I really want to give you a chance of being a good example of using StackOveflow the way it is meant. Please point out at leat one special detail."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1557247706, "post_id": 56026918, "comment_id": 98697953, "body": "Well duplicates are strictly speaking not technically off-topic, they are usually kept as different points of view on the same and to serve as a &quot;look there&quot; pointers. But the point is that they get closed and then cannot be answered, so for you it probably is the same as &quot;off-topic&quot;."}, {"owner": {"reputation": 177, "user_id": 6346499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b306473ed6b4d8dd2fd7536e9778970a?s=128&d=identicon&r=PG&f=1", "display_name": "MidnightRover", "link": "https://stackoverflow.com/users/6346499/midnightrover"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1557262106, "post_id": 56026918, "comment_id": 98704117, "body": "@Yunnosch Thanks for your input but I&#39;m not sure I follow your concerns exactly.  The question I referencing is asking for the same base question.  However despite being marked as answered, the answer given for that question doesn&#39;t work for me or the original poster (I&#39;m not even sure why it was marked as answered).  I mentioned it just so people don&#39;t point me to it.  In your opinion what is the correct way to approach asking this question the way StackOverflow is meant?  Thanks for any clarity you can give."}, {"owner": {"reputation": 177, "user_id": 6346499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b306473ed6b4d8dd2fd7536e9778970a?s=128&d=identicon&r=PG&f=1", "display_name": "MidnightRover", "link": "https://stackoverflow.com/users/6346499/midnightrover"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1557262257, "post_id": 56026918, "comment_id": 98704176, "body": "Edited to put less emphasis on the fact there is a similar question out there."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1557262478, "post_id": 56026918, "comment_id": 98704247, "body": "If you cannot point out a difference or at least give a fresh angle to the question, then you should comment on the original question. Maybe pointing out your doubts about the accepted answer can provoke the answerer to improve. Or the asker can explain why/how the accepted answer helped them. An expensive way would be to put a bounty on the other question, with an explanation why the existing answer cannot earn the bounty."}, {"owner": {"reputation": 177, "user_id": 6346499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b306473ed6b4d8dd2fd7536e9778970a?s=128&d=identicon&r=PG&f=1", "display_name": "MidnightRover", "link": "https://stackoverflow.com/users/6346499/midnightrover"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1557263041, "post_id": 56026918, "comment_id": 98704447, "body": "Okay, so even if it&#39;s 5 years old I should try to resurrect it by commenting on it as a first step.  Okay I will try that.  Thanks."}], "owner": {"reputation": 177, "user_id": 6346499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b306473ed6b4d8dd2fd7536e9778970a?s=128&d=identicon&r=PG&f=1", "display_name": "MidnightRover", "link": "https://stackoverflow.com/users/6346499/midnightrover"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 119, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1557262220, "creation_date": 1557246641, "last_edit_date": 1557262220, "question_id": 56026918, "link": "https://stackoverflow.com/questions/56026918/software-version-in-output-file-from-codeblocks-ide", "title": "Software Version in output file from Code::Blocks IDE", "body": "<p>I would like my output file to include the version number.  I am using the auto-versioning feature in Code::Blocks so I have version.h which includes a couple of defines and variables that relate to the current version/build of the software.</p>\n\n<p>I can see that there is the custom variables tab in build options or global compiler setting where I setup a variable named \"version\" that I can then use in the output filename.  What I can't figure out is how to have that variable equal any of the defines or variables found in version.h that represent the current version of the software.</p>\n\n<p>If someone can help me with this it would be very appreciated.</p>\n\n<p>I do realize I could also do this with a post build script but if there is a way of doing it with functionality in the IDE it seems easier to me at this point.</p>\n\n<p>This is admittedly a direct duplicate of this questions (<a href=\"https://stackoverflow.com/questions/20612106/project-version-in-exe-filename\">project version in .exe-filename</a>) but it is 5 years old and doesn't seem to work for me (or even the original poster for that matter) so I'm asking it as a new question.</p>\n\n<p>With the answer given in the question above, I get the same results as listed by the original asker in the comments:  when compiling it says no such file or directory.</p>\n\n<p>Thanks</p>\n"}]