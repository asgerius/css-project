[{"tags": ["c++", "c", "error-handling", "shared-libraries", "terminate"], "comments": [{"owner": {"reputation": 1873, "user_id": 765294, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/99UFa.jpg?s=128&g=1", "display_name": "Will", "link": "https://stackoverflow.com/users/765294/will"}, "edited": false, "score": 0, "creation_date": 1568850983, "post_id": 58002026, "comment_id": 102409678, "body": "BTW, I guess it might seem like I&#39;m just trying to win some petty argument on the internet, but I really am just as happy to be shown to be wrong here\u2014because that would mean I get to learn something valuable at least."}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1568986241, "post_id": 58002026, "comment_id": 102461067, "body": "no rule should be if there was not be an exception for it.  Try to think a little on the subject and you&#39;ll see cases in which even both approaches are equally valid.  Anyway, if you write a general purpose library, then you have no knowledge of what the calling software is about to require... so the statement should be, at least, considered true."}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1568986483, "post_id": 58002026, "comment_id": 102461207, "body": "When I was young, there was a similar statement saying <i>&quot;Goto&#39;s are bad&quot;</i>, but <code>goto</code> keyword has never dissapeared from those languages that incorporated them.   So some unextremism can always be considered a good startting point."}], "answers": [{"tags": [], "owner": {"reputation": 11934, "user_id": 54606, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/e7de961282b156410426c657342ef466?s=128&d=identicon&r=PG", "display_name": "Lo&#239;c Faure-Lacroix", "link": "https://stackoverflow.com/users/54606/lo%c3%afc-faure-lacroix"}, "is_accepted": true, "score": 1, "last_activity_date": 1568865150, "last_edit_date": 1568865150, "creation_date": 1568864757, "answer_id": 58003455, "question_id": 58002026, "link": "https://stackoverflow.com/questions/58002026/is-it-always-wrong-to-terminate-the-calling-program-e-g-call-exit-from-a-l/58003455#58003455", "title": "Is it always wrong to terminate the calling program (e.g., call exit()) from a library when an error/exception could be returned instead?", "body": "<p>This kind of question is difficult to answer because there isn't a 1 size fits all.</p>\n\n<p>The first issue that could arise if a plugin/library prematurely exit a program is that it will stop the program before any kind of cleanup can be done by a program closing normally. So if a program doesn't use hooks like atexit, on_exit. It's quite possible that the program will close in an undetermined state.</p>\n\n<blockquote>\n  <p>All functions registered with atexit(3) and on_exit(3) are called, in\n         the reverse order of their registration.  (It is possible for one of\n         these functions to use atexit(3) or on_exit(3) to register an\n         additional function to be executed during exit processing; the new\n         registration is added to the front of the list of functions that\n         remain to be called.)  If one of these functions does not return\n         (e.g., it calls _exit(2), or kills itself with a signal), then none\n         of the remaining functions is called, and further exit processing (in\n         particular, flushing of stdio(3) streams) is abandoned.  If a\n         function has been registered multiple times using atexit(3) or\n         on_exit(3), then it is called as many times as it was registered.</p>\n</blockquote>\n\n<p><a href=\"http://man7.org/linux/man-pages/man3/exit.3.html\" rel=\"nofollow noreferrer\">http://man7.org/linux/man-pages/man3/exit.3.html</a></p>\n\n<p>The other problem would be that some program rely on some particular exit codes so if the program exit with <code>exit(0)</code> it has to exit because the program ended normally otherwise it should use some kind of exit code that make sense to the program.</p>\n\n<p>If the program implement correctly exiting callbacks, it wouldn't be terrible to use exit directly assuming that the program can do the cleanups.</p>\n\n<p>On the other hand, if a program provide some APIs to exit the program it should be used instead of exit directly.</p>\n\n<p>So it really depends if the program actually handle the \"exiting\" situations.</p>\n\n<p>But if we're talking about a library like an NFCReader library... or something general that isn't coupled with the main program. That would be weird and possibly annoying to have a library that would make your program die in cases that aren't unrecoverable errors.</p>\n\n<p>In the case of a general library, the library writer cannot know if any of the program using their library use the same exit codes, or have actual exitting callbacks enabled so it would be a terrible idea to do that and in worse case it could become even dangerous.</p>\n\n<p>Imagine a regex library being used on some medical equipment that in some weird scenario would fail to parse a regex and decide to exit the program in the middle of an operation. </p>\n"}], "owner": {"reputation": 1873, "user_id": 765294, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/99UFa.jpg?s=128&g=1", "display_name": "Will", "link": "https://stackoverflow.com/users/765294/will"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 58003455, "answer_count": 1, "score": 1, "last_activity_date": 1568865150, "creation_date": 1568850755, "last_edit_date": 1568852690, "question_id": 58002026, "link": "https://stackoverflow.com/questions/58002026/is-it-always-wrong-to-terminate-the-calling-program-e-g-call-exit-from-a-l", "title": "Is it always wrong to terminate the calling program (e.g., call exit()) from a library when an error/exception could be returned instead?", "body": "<p>I have always believed the answer to be unequivocally: <strong>yes</strong>.</p>\n\n<p>Yesterday I wrote the following in a <a href=\"https://www.reddit.com/r/C_Programming/comments/d5k1cp/a_simple_gap_buffer_implementation_in_c/f0nyavf/\" rel=\"nofollow noreferrer\">comment</a> on <a href=\"https://www.reddit.com/r/C_Programming\" rel=\"nofollow noreferrer\">reddit.com/r/c_programming</a>:</p>\n\n<blockquote>\n  <p>Terminating a calling program inside a library is a severe violation of separation of concerns: it's the library's responsibility to return a result, be it the intended result or an error, nothing more, nothing less; whereas it's the caller's responsibility and prerogative to do with that result whatever it deems best.</p>\n</blockquote>\n\n<p>However, to my surprise, I could find no question on <em>Stack Overflow</em> or <em>Software Engineering</em> that directly addresses this fairly fundamental concern.</p>\n\n<p>If this question is not a duplicate, I figure it might be useful if it were to serve as a future point of reference in that regard\u2014hoping to see some convincing arguments, official guidelines, or otherwise authoritative sources.</p>\n"}, {"tags": ["c"], "answers": [{"tags": [], "owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "is_accepted": false, "score": 3, "last_activity_date": 1568848456, "creation_date": 1568848456, "answer_id": 58001801, "question_id": 58001686, "link": "https://stackoverflow.com/questions/58001686/linker-error-when-using-a-function-defined-in-a-custom-shared-library/58001801#58001801", "title": "Linker error when using a function defined in a custom shared library", "body": "<p>You created a shared object, but you are not creating an executable to use it. Since the executable is not using it, the referenced symbol is not found.</p>\n\n<p>Remove the extraneous <code>-L</code> option, and specify the shared object when linking.</p>\n\n<pre><code>gcc hello.c -o hello ./my_malloc.so\n</code></pre>\n"}], "owner": {"reputation": 1537, "user_id": 968000, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/tU8sw.jpg?s=128&g=1", "display_name": "user968000", "link": "https://stackoverflow.com/users/968000/user968000"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1568848456, "creation_date": 1568847339, "question_id": 58001686, "link": "https://stackoverflow.com/questions/58001686/linker-error-when-using-a-function-defined-in-a-custom-shared-library", "title": "Linker error when using a function defined in a custom shared library", "body": "<p>I created following shared library and wanted to use the functions defined in the library in a different c file. </p>\n\n<p>Header file :</p>\n\n<pre><code>#ifndef _MY_MALLOC_H_\n#define _MY_MALLOC_H_\n\n#include &lt;dlfcn.h&gt;\n#include &lt;stdio.h&gt;\nextern void* malloc(size_t sz);\n\nextern void free(void *p);\n\nextern int get_total_malloc_requested(void);\n\n\n#endif\n</code></pre>\n\n<p>Implementation:</p>\n\n<pre><code>#define _GNU_SOURCE\n\n#include \"my_malloc.h\"\n\nstatic int num_times_malloc_called = 0;\nstatic int num_times_free_called = 0;\n\nvoid* malloc(size_t sz)\n{\n    void *(*libc_malloc)(size_t) = dlsym(RTLD_NEXT, \"malloc\");\n    num_times_malloc_called++;\n    fprintf(stderr,\"malloc called %d\\n\",num_times_malloc_called);\n    return libc_malloc(sz);\n  // return NULL;\n}\n\nvoid free(void *p)\n{\n    void (*libc_free)(void*) = dlsym(RTLD_NEXT, \"free\");\n    fprintf(stderr,\"free\\n\");\n    libc_free(p);\n}\n\nint get_total_malloc_requested(void){\n  return num_times_malloc_called;\n}\n</code></pre>\n\n<p>There was no problem when I created the .so.</p>\n\n<pre><code>gcc -shared -fPIC -o my_malloc.so my_malloc.c -ldl\n</code></pre>\n\n<p>But when I am invoking get_total_malloc_requested from another .c file, I get linker error.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n\n#include \"my_malloc.h\"\n\nint main(){\n   void *ptr;\n   ptr = malloc(64); &lt;---no problem here\n   fprintf(stderr,\"called malloc \");\n   free(ptr);&lt;---no problem here\n   ptr = malloc(64);\n   fprintf(stderr,\"called malloc \");\n   free(ptr);\n   get_total_malloc_requested();&lt;---linker doesn't find the symbol\n   return 0;\n\n\n}\n\ngcc hello.c -o hello.o -L ./my_malloc.c\nld: warning: -L path './my_malloc.c' is not a directory\nUndefined symbols for architecture x86_64:\n  \"_get_total_malloc_requested\", referenced from:\n      _main in hello-1dfbf1.o\nld: symbol(s) not found for architecture x86_64\nclang: error: linker command failed with exit code 1 (use -v to see invocation)\n</code></pre>\n"}, {"tags": ["java", "c#", "c", "windows", "command-line-arguments"], "comments": [{"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 1, "creation_date": 1568849080, "post_id": 58001676, "comment_id": 102409288, "body": "The rules appear to be here: <a href=\"https://docs.microsoft.com/en-us/previous-versions/17w5ykft(v=vs.85)\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/previous-versions/17w5ykft(v=vs.85)</a>"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 2, "creation_date": 1568849111, "post_id": 58001676, "comment_id": 102409294, "body": "@MarkPflug, the operating system has to parse the command line at least enough to determine what command to run in the (allowed) case that the <code>lpApplicationName</code> parameter is null.  Of course, given that Microsoft writes a lot of its own language runtimes, and that it is notorious for blending layers, I&#39;m not sure that the question is in fact inquiring about a meaningful distinction."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 3, "creation_date": 1568849223, "post_id": 58001676, "comment_id": 102409313, "body": "This is wildly dependent on the called-application. CreateProcess forwards the command line; the process entrypoint itself is utimately responsible for discerning the argument breakup. Ex: WinMainCRTStartup and wWinMainCRTStartup are the default entrypoints for MSVS-built C or C++ applications built as narrow or unicode respectively. Both are capable of breaking apart the cmd  line arguments from the CreateProcess arguments."}, {"owner": {"reputation": 13408, "user_id": 585968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97d0399ab165e17f668b2cdd1a5c1dc0?s=128&d=identicon&r=PG&f=1", "display_name": "MickyD", "link": "https://stackoverflow.com/users/585968/mickyd"}, "edited": false, "score": 1, "creation_date": 1568850500, "post_id": 58001676, "comment_id": 102409596, "body": "It is up to the application and whatever language it is written in.  It is not the role of CreateProcess nor the OS to <i>&quot;[parse] lpCommandLine and turning it into args[].&quot;</i>.   <i><a href=\"https://docs.microsoft.com/en-us/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessa\" rel=\"nofollow noreferrer\">Tell me more</a></i>"}, {"owner": {"reputation": 24998, "user_id": 190371, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IRQaF.png?s=128&g=1", "display_name": "MarkPflug", "link": "https://stackoverflow.com/users/190371/markpflug"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1568905486, "post_id": 58001676, "comment_id": 102432007, "body": "@JohnBollinger I think the distinction is quite meaningful, in fact. If the args are parsed by the OS, then the behavior should be consistent regardless of language used. If the parsing is done by the language runtime itself, then the behavior might be different depending on how the language, or even the <i>version</i> of the language, happens to implement it."}], "answers": [{"comments": [{"owner": {"reputation": 29355, "user_id": 205580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460e6e299e385fd46df156c85a1dd55f?s=128&d=identicon&r=PG", "display_name": "Eryk Sun", "link": "https://stackoverflow.com/users/205580/eryk-sun"}, "edited": false, "score": 1, "creation_date": 1568867113, "post_id": 58001881, "comment_id": 102412384, "body": "If we don&#39;t use <code>lpApplicationName</code> to pass an explicit executable path, <code>CreateProcessW</code> parses the command line for the executable, with special handling for space and double quote. If there&#39;s no quoting, it consumes spaces until it finds an executable. For example, it may find <code>C:\\Program Files\\spam\\eggs.exe</code>, but not if <code>C:\\program.exe</code> exists."}, {"owner": {"reputation": 29355, "user_id": 205580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460e6e299e385fd46df156c85a1dd55f?s=128&d=identicon&r=PG", "display_name": "Eryk Sun", "link": "https://stackoverflow.com/users/205580/eryk-sun"}, "edited": false, "score": 0, "creation_date": 1568867274, "post_id": 58001881, "comment_id": 102412429, "body": "If an application&#39;s runtime library of choice doesn&#39;t parse the command line, it can manually call <a href=\"https://docs.microsoft.com/en-us/windows/win32/api/shellapi/nf-shellapi-commandlinetoargvw\" rel=\"nofollow noreferrer\"><code>CommandLineToArgvW</code></a> with the Unicode command line from <a href=\"https://docs.microsoft.com/en-us/windows/win32/api/processenv/nf-processenv-getcommandlinew\" rel=\"nofollow noreferrer\"><code>GetCommandLineW</code></a>. This function is part of the Windows shell, shell32.dll."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user10762593"}, "is_accepted": true, "score": 3, "last_activity_date": 1568849260, "creation_date": 1568849260, "answer_id": 58001881, "question_id": 58001676, "link": "https://stackoverflow.com/questions/58001676/what-parses-command-line-args-into-args-on-windows/58001881#58001881", "title": "What parses command line args into args[] on Windows?", "body": "<p>The runtime startup code linked into the program you're running.  For C, for example, it's crt0.c.</p>\n\n<p>The created process begins execution in user mode at some declared entry point, which is not <code>main</code>. It is the C runtime that calls <code>main</code>.</p>\n\n<p>Back when I was a Windows C programmer, the C runtime source code was included in the SDK.</p>\n"}], "owner": {"reputation": 24998, "user_id": 190371, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IRQaF.png?s=128&g=1", "display_name": "MarkPflug", "link": "https://stackoverflow.com/users/190371/markpflug"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 129, "favorite_count": 1, "accepted_answer_id": 58001881, "answer_count": 1, "score": 4, "last_activity_date": 1568850553, "creation_date": 1568847213, "last_edit_date": 1568850553, "question_id": 58001676, "link": "https://stackoverflow.com/questions/58001676/what-parses-command-line-args-into-args-on-windows", "title": "What parses command line args into args[] on Windows?", "body": "<p>On Windows, the <a href=\"https://docs.microsoft.com/en-us/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessa\" rel=\"nofollow noreferrer\">CreateProcess</a> win32 function is used to create a new process. The signature for this function takes a pointer to the \"command line\" <code>lpCommandLine</code>, so the command line is passed as a single string.</p>\n\n<p>Every language that I'm familiar with (C, C++, C#, Java) allows a <code>main</code> function that accepts an array of strings. So, somewhere between CreateProcess and <code>main</code> there must be something that is parsing <code>lpCommandLine</code> and turning it into <code>args[]</code>. </p>\n\n<p>Where does this parsing code live? Is it part of the OS (inside <code>CreateProcess</code>), or is it part of each languages \"runtime\" (code that runs inside the new process before <code>main</code> is called)?</p>\n"}, {"tags": ["c", "go", "linker"], "comments": [{"owner": {"reputation": 47629, "user_id": 900873, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/704ea9ee0d9090f571599bdf5f95eb39?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/900873/kevin"}, "edited": false, "score": 1, "creation_date": 1568846478, "post_id": 58001562, "comment_id": 102408790, "body": "Maybe set up a build system with <code>make</code> or <code>ninja</code>?"}, {"owner": {"reputation": 360, "user_id": 11657235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9bc87a6abdda3e88df2ae16e278e7864?s=128&d=identicon&r=PG&f=1", "display_name": "Milo Banks", "link": "https://stackoverflow.com/users/11657235/milo-banks"}, "reply_to_user": {"reputation": 47629, "user_id": 900873, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/704ea9ee0d9090f571599bdf5f95eb39?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/900873/kevin"}, "edited": false, "score": 0, "creation_date": 1568846641, "post_id": 58001562, "comment_id": 102408832, "body": "Wouldn&#39;t this still make me recompile the C?"}, {"owner": {"reputation": 47629, "user_id": 900873, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/704ea9ee0d9090f571599bdf5f95eb39?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/900873/kevin"}, "edited": false, "score": 0, "creation_date": 1568846751, "post_id": 58001562, "comment_id": 102408849, "body": "Not if you set it up right. Part of the purpose of such tools is that they support incremental compilation\u2014that is, only compiling files that have been changed since the last time they were compiled."}, {"owner": {"reputation": 360, "user_id": 11657235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9bc87a6abdda3e88df2ae16e278e7864?s=128&d=identicon&r=PG&f=1", "display_name": "Milo Banks", "link": "https://stackoverflow.com/users/11657235/milo-banks"}, "reply_to_user": {"reputation": 47629, "user_id": 900873, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/704ea9ee0d9090f571599bdf5f95eb39?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/900873/kevin"}, "edited": false, "score": 0, "creation_date": 1568846908, "post_id": 58001562, "comment_id": 102408887, "body": "Cool! Could you point me toward a site that gives me a rough outline on this? I have looked through the documentation (no very much though) and did some google searches but found nothing."}, {"owner": {"reputation": 47629, "user_id": 900873, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/704ea9ee0d9090f571599bdf5f95eb39?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/900873/kevin"}, "edited": false, "score": 0, "creation_date": 1568847112, "post_id": 58001562, "comment_id": 102408936, "body": "<a href=\"https://www.gnu.org/software/make/manual/make.html\" rel=\"nofollow noreferrer\">Make manual</a>, <a href=\"https://ninja-build.org/manual.html\" rel=\"nofollow noreferrer\">Ninja manual</a>. They may be a bit dense, so google for more basic tutorials if you need."}, {"owner": {"reputation": 360, "user_id": 11657235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9bc87a6abdda3e88df2ae16e278e7864?s=128&d=identicon&r=PG&f=1", "display_name": "Milo Banks", "link": "https://stackoverflow.com/users/11657235/milo-banks"}, "reply_to_user": {"reputation": 47629, "user_id": 900873, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/704ea9ee0d9090f571599bdf5f95eb39?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/900873/kevin"}, "edited": false, "score": 0, "creation_date": 1568849202, "post_id": 58001562, "comment_id": 102409307, "body": "I have googled and looked through both manuals. None mention using C and go."}, {"owner": {"reputation": 47629, "user_id": 900873, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/704ea9ee0d9090f571599bdf5f95eb39?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/900873/kevin"}, "edited": false, "score": 0, "creation_date": 1568849360, "post_id": 58001562, "comment_id": 102409334, "body": "Neither cares what languages you&#39;re using. Just set it up so the go file depends on the C object file, and the C object file depends on the C source. You may need to figure out the compiler flags to build go files one-at-a-time"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1568849473, "post_id": 58001562, "comment_id": 102409365, "body": "The problem is that you still need a build tool for Go that <code>make</code> or <code>ninja</code> will run, and that will build a minimal unit without all the dependencies.  The whole point of the question is that <code>go build</code> doesn&#39;t do that for the OP."}, {"owner": {"reputation": 360, "user_id": 11657235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9bc87a6abdda3e88df2ae16e278e7864?s=128&d=identicon&r=PG&f=1", "display_name": "Milo Banks", "link": "https://stackoverflow.com/users/11657235/milo-banks"}, "edited": false, "score": 0, "creation_date": 1568850934, "post_id": 58001562, "comment_id": 102409666, "body": "Would that &quot;minimal unit without all the dependencies&quot; be an object file? Sorry for all  the questions."}, {"owner": {"reputation": 3889, "user_id": 561422, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JwFD0.jpg?s=128&g=1", "display_name": "marco.m", "link": "https://stackoverflow.com/users/561422/marco-m"}, "edited": false, "score": 0, "creation_date": 1568871886, "post_id": 58001562, "comment_id": 102413644, "body": "If you are not familiar with make, a simpler build tool is <a href=\"https://taskfile.dev/\" rel=\"nofollow noreferrer\">taskfile.dev</a>. Section <a href=\"https://taskfile.dev/#/usage?id=prevent-unnecessary-work\" rel=\"nofollow noreferrer\">taskfile.dev/#/usage?id=prevent-unnecessary-work</a> explains your use case. Regarding the proposed Ninja, I do not recommend to use it directly, it is too low-level. Use it via cmake. But again, taskfile is easier, although more verbose."}, {"owner": {"reputation": 1128, "user_id": 11246894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f55f8e8c47996c0510c64dbacab90104?s=128&d=identicon&r=PG&f=1", "display_name": "AJR", "link": "https://stackoverflow.com/users/11246894/ajr"}, "edited": false, "score": 1, "creation_date": 1568880229, "post_id": 58001562, "comment_id": 102417543, "body": "According to CGO page (<a href=\"https://golang.org/cmd/cgo/\" rel=\"nofollow noreferrer\">golang.org/cmd/cgo</a>) <code>... changes to files in other directories do not cause the package to be recompiled</code>"}, {"owner": {"reputation": 360, "user_id": 11657235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9bc87a6abdda3e88df2ae16e278e7864?s=128&d=identicon&r=PG&f=1", "display_name": "Milo Banks", "link": "https://stackoverflow.com/users/11657235/milo-banks"}, "edited": false, "score": 0, "creation_date": 1568945212, "post_id": 58001562, "comment_id": 102444939, "body": "Did not see that! Must just be the linker. So sorry about this!"}], "owner": {"reputation": 360, "user_id": 11657235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9bc87a6abdda3e88df2ae16e278e7864?s=128&d=identicon&r=PG&f=1", "display_name": "Milo Banks", "link": "https://stackoverflow.com/users/11657235/milo-banks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1568846274, "creation_date": 1568846274, "question_id": 58001562, "link": "https://stackoverflow.com/questions/58001562/go-build-while-building-c-separately", "title": "go build while building C separately", "body": "<p>I have some Go code and some C code (quite a bit really).  I am calling the C code from the go code. Here is an example:</p>\n\n<p><strong>test.h</strong></p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#ifndef TEST_H\n#define TEST_H\n\nvoid test();\n\n#endif\n</code></pre>\n\n<p><strong>test.c</strong></p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include \"test.h\"\n\n#include &lt;stdio.h&gt;\n\nvoid test() {\n    printf(\"Hello from C!\")\n}\n</code></pre>\n\n<p><strong>main.go</strong></p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\n// #include \"test.h\"\nimport \"C\"\nimport \"fmt\"\n\nfunc main() {\n    C.test()\n}\n</code></pre>\n\n<p>Imagine I have much more C code. This C code takes a while to compile. When compiling using <code>go build</code>, it recompiles the C every time. Is it possible to compile the C and go separately? Meaning that if I am working on the Golang code, I won't have to compile to C code?</p>\n\n<p>I have tried linking the object files, but it seems very inefficient. If this is the best option? If so, could you provide a code example showing me how (as my way only works on Linux).</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 1, "creation_date": 1568846862, "post_id": 58001445, "comment_id": 102408875, "body": "Obviously it depends on whether your text <code>&quot;abc&quot;</code> is constant, or might ever have to be changed.  To some extent it&#39;s like saying <code>printf(&quot;%d, 5)</code> versus <code>int value = 5; ...; printf(&quot;%d&quot;, value);</code>."}], "answers": [{"tags": [], "owner": {"reputation": 71, "user_id": 8663075, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-e5s897laoZA/AAAAAAAAAAI/AAAAAAAAAA4/EW_HXSHit84/photo.jpg?sz=128", "display_name": "Alexandre FERRERA", "link": "https://stackoverflow.com/users/8663075/alexandre-ferrera"}, "is_accepted": true, "score": 1, "last_activity_date": 1568847132, "last_edit_date": 1568847132, "creation_date": 1568846028, "answer_id": 58001526, "question_id": 58001445, "link": "https://stackoverflow.com/questions/58001445/different-methods-of-printing-text-using-subscripts/58001526#58001526", "title": "Different methods of printing text using subscripts", "body": "<p>Both methods are basically the same. The 2nd method could be slightly faster since your print function calls a static value (\"abc\") instead of a reference to \"abc\".</p>\n\n<p>I wouldn't be surprised if the compiler would make those 2 methods similar in the end.</p>\n\n<p>This being said, the first method should be better in most situations since you'll probably want to reuse the 'text' variable or load it from elsewhere.</p>\n"}], "owner": {"reputation": 29, "user_id": 1825603, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c9737674563a91678042607d0565440?s=128&d=identicon&r=PG", "display_name": "rsarson", "link": "https://stackoverflow.com/users/1825603/rsarson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 58001526, "answer_count": 1, "score": 0, "last_activity_date": 1568847132, "creation_date": 1568845374, "question_id": 58001445, "link": "https://stackoverflow.com/questions/58001445/different-methods-of-printing-text-using-subscripts", "title": "Different methods of printing text using subscripts", "body": "<p>Are there any significant differences between the following two methods of printing text using subscripts?  Are there any pros/cons of using one method over the other?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void)\n{\n    int i;\n    char *text;\n\n    /* method 1 */\n    text = \"abc\";\n    for (i = 0; i &lt; 3; ++i) {\n        printf(\"%c\\n\", text[i]);\n    }\n\n    printf(\"\\n\");\n\n    /* method 2 */\n    for (i = 0; i &lt; 3; ++i) {\n        printf(\"%c\\n\", \"abc\"[i]);\n    }\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 2, "creation_date": 1568845553, "post_id": 58001432, "comment_id": 102408564, "body": "<code>s[i]==B;</code>-&gt;<code>s[i]=B;</code>"}, {"owner": {"reputation": 398, "user_id": 11651298, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-y7Bb7VGZEvU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdOsrMxPPuvzR0R6k4W9FeP-N1D8A/mo/photo.jpg?sz=128", "display_name": "Akshit", "link": "https://stackoverflow.com/users/11651298/akshit"}, "edited": false, "score": 0, "creation_date": 1568845622, "post_id": 58001432, "comment_id": 102408573, "body": "Use s[i] =B instead of s[i] == B. The latter is a binary operator and the former is an assignment operator."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 2, "creation_date": 1568846162, "post_id": 58001432, "comment_id": 102408704, "body": "If you enable compiler warnings (which you should anyway), what does your compiler tell you? <code>-Wall -Wextra -pedantic</code> to your <code>gcc</code> or <code>clang</code> compile string or <code>&#47;W3</code> for VS (<code>cl.exe</code>). Do not accept code until it compiles without warning."}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1568985961, "post_id": 58001432, "comment_id": 102460923, "body": "well, there&#39;s a problem.  You define (correctly) your function passing the array reference and the length of the array, but then you call it passing only the array reference.  You can  call it (incorrectly) with only the array reference, call it as <code>capitalize_e(s, strlen(s));</code> or <code>capitalize_e(s, sizeof s);</code> and you&#39;ll have your assignment finished."}], "answers": [{"comments": [{"owner": {"reputation": 22422, "user_id": 634919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f4a87fe094961af20263d8e7ff445b2?s=128&d=identicon&r=PG", "display_name": "Nate Eldredge", "link": "https://stackoverflow.com/users/634919/nate-eldredge"}, "edited": false, "score": 4, "creation_date": 1568847379, "post_id": 58001491, "comment_id": 102409003, "body": "I don&#39;t think the &quot;xor with 32&quot; trick is portable; it will break if the character set is not ASCII.  Wouldn&#39;t <code>toupper</code> be better?"}, {"owner": {"reputation": 71, "user_id": 9990241, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-2OIh2whFcwA/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq0IvElWq63zFjd_n-ZkU-8k5EQWHg/mo/photo.jpg?sz=128", "display_name": "Tommy O&#39;Connell", "link": "https://stackoverflow.com/users/9990241/tommy-oconnell"}, "edited": false, "score": 0, "creation_date": 1568850442, "post_id": 58001491, "comment_id": 102409585, "body": "I was not allowed to use anything besides the printf and random_letter functions so I could not use toupper. This did work though."}, {"owner": {"reputation": 45894, "user_id": 271415, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/8648256cc53b261c5e1d266380a256fc?s=128&d=identicon&r=PG", "display_name": "jarmod", "link": "https://stackoverflow.com/users/271415/jarmod"}, "edited": false, "score": 0, "creation_date": 1568860518, "post_id": 58001491, "comment_id": 102411255, "body": "Nobody doing his first C homework assignment is going to xor with space. Unless he used stackoverflow. As will be extremely obvious to your tutor."}, {"owner": {"reputation": 13191, "user_id": 4990642, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/xY0PD.jpg?s=128&g=1", "display_name": "snr", "link": "https://stackoverflow.com/users/4990642/snr"}, "reply_to_user": {"reputation": 22422, "user_id": 634919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f4a87fe094961af20263d8e7ff445b2?s=128&d=identicon&r=PG", "display_name": "Nate Eldredge", "link": "https://stackoverflow.com/users/634919/nate-eldredge"}, "edited": false, "score": 0, "creation_date": 1568877295, "post_id": 58001491, "comment_id": 102416046, "body": "@NateEldredge yes, exactly sir. But &quot;trick is trick &quot;(: It engages both the mind and the eye. Doesn&#39;t it?"}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1568918816, "post_id": 58001491, "comment_id": 102438137, "body": "I don&#39;t think this assignment is supposed to be entered into the ioccc."}], "tags": [], "owner": {"reputation": 13191, "user_id": 4990642, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/xY0PD.jpg?s=128&g=1", "display_name": "snr", "link": "https://stackoverflow.com/users/4990642/snr"}, "is_accepted": true, "score": 3, "last_activity_date": 1568860165, "last_edit_date": 1568860165, "creation_date": 1568845730, "answer_id": 58001491, "question_id": 58001432, "link": "https://stackoverflow.com/questions/58001432/how-to-capitalize-specific-letter-in-an-array/58001491#58001491", "title": "How to capitalize specific letter in an array", "body": "<ul>\n<li><p>You need to know the difference between <em>string literal</em> presented\nbetween <code>\"\"</code> and  a <em>character</em> presented between <code>''</code>.</p></li>\n<li><p><code>s[i]==B</code> in which double equality operator is wrong. It is used to\ndecide whether the condition is true or not.</p></li>\n<li><p><code>void capitalize_e(char s[], int size)</code> in which second formal parameter should be removed. And, <code>for (i=0; s[i] != '\\0' ; i++)</code> should be applied.</p></li>\n</ul>\n\n<p>I'd rewrite your code as something similar to this:</p>\n\n<pre><code>void capitalize_e(char s[], char lowerCaseChar) {\n    for (size_t i = 0; s[i] ; i++) {\n        if (s[i] == lowerCaseChar)\n            s[i] ^= ' ';\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 71, "user_id": 9990241, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-2OIh2whFcwA/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq0IvElWq63zFjd_n-ZkU-8k5EQWHg/mo/photo.jpg?sz=128", "display_name": "Tommy O&#39;Connell", "link": "https://stackoverflow.com/users/9990241/tommy-oconnell"}, "edited": false, "score": 0, "creation_date": 1568850956, "post_id": 58001682, "comment_id": 102409672, "body": "Thanks Keith. Unfortunately I had to use the capitalize_e based on the assignment instructions but this is very helpful for the future!"}], "tags": [], "owner": {"reputation": 40865, "user_id": 10431, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/22aac6106c44ae4078bd4c0a564714e0?s=128&d=identicon&r=PG", "display_name": "Keith Nicholas", "link": "https://stackoverflow.com/users/10431/keith-nicholas"}, "is_accepted": false, "score": 0, "last_activity_date": 1568848165, "last_edit_date": 1568848165, "creation_date": 1568847305, "answer_id": 58001682, "question_id": 58001432, "link": "https://stackoverflow.com/questions/58001432/how-to-capitalize-specific-letter-in-an-array/58001682#58001682", "title": "How to capitalize specific letter in an array", "body": "<p>I'd write a general function for replacing a char with another char.... then use it to replace 'e' with 'E'.</p>\n\n<p>for example :-</p>\n\n<pre><code>char* replace_all(char* str, char target, char replacement) {\n    char* s = str;\n    while(*s != 0)  {\n        if(*s == target) *s = replacement;\n        s++;\n    }\n    return str;\n}\n\nint main() {\n    char example[] = \"The elephant in the room.\";\n    printf(\"%s\", replace_all(example,'e', 'E'));\n}\n</code></pre>\n\n<p>you mentioned 'random_letter' but didn't explicitly talk about it in your question.   I'm assuming for that, you can then build something like the following.</p>\n\n<pre><code>char* replace_all(char* str, char target, char replacement) {\n    char* s = str;\n    while(*s != 0)  {\n        if(*s == target) *s = replacement;\n        s++;\n    }\n    return str;\n}\n\nchar capitalize(char c) {\n    if(c &gt;= 'a' &amp;&amp; c &lt;= 'z') return 'A' + (c -'a');\n    return c;\n}\n\n\nint main() {\n    char example[] = \"The elephant in the room.\";\n    char letter = random_letter();\n    printf(\"%s\", replace_all(example,letter, capitalize(letter)));\n}\n</code></pre>\n\n<p>Now you have built two useful functions that can be reused for other things, rather than one very explicit function called capitalize_e</p>\n"}, {"tags": [], "owner": {"reputation": 294, "user_id": 8860216, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdbaddc290cb115e919ebf6dca609a73?s=128&d=identicon&r=PG&f=1", "display_name": "LoLo", "link": "https://stackoverflow.com/users/8860216/lolo"}, "is_accepted": false, "score": -1, "last_activity_date": 1572394282, "last_edit_date": 1572394282, "creation_date": 1568866767, "answer_id": 58003671, "question_id": 58001432, "link": "https://stackoverflow.com/questions/58001432/how-to-capitalize-specific-letter-in-an-array/58003671#58003671", "title": "How to capitalize specific letter in an array", "body": "<p>I will recommend checking the ASCII value of characters from ASCII table. If you pay attention, you'll see that capital letters will start from decimal value of 65. For example: A = 65, B = 66, C = 67 and so on. From 97 onwards, letters are lower case. Hence, I would check decimal value of each character and compare its range whether it is greater than or equal to 97 and substitute 32 if true. You can also set your condition as >=97 &amp;&amp; &lt;=122.</p>\n\n<p>In order not to ruin your learning experience I am not providing any code and it should be fairly straight forward to follow and solve the puzzle accordingly. </p>\n\n<blockquote>\n  <p>Never mind, I'm just adding a brief code snippet after I got downvoted.</p>\n</blockquote>\n\n<pre><code>int main() {\n   char myArray[] = \"Hello World\";\n\n   for(int i = 0; i &lt; sizeof(myArray); i++) {\n     int decimalValueOfChar = myArray[i];\n     if(decimalValueOfChar &gt;= 97 &amp;&amp; decimalValueOfChar &lt;= 122) {\n        decimalValueOfChar = decimalValueOfChar - 32;\n        myArray[i] = decimalValueOfChar;\n     } \n   }\n   printf(\"%s\", myArray);\n   return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 9990241, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-2OIh2whFcwA/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq0IvElWq63zFjd_n-ZkU-8k5EQWHg/mo/photo.jpg?sz=128", "display_name": "Tommy O&#39;Connell", "link": "https://stackoverflow.com/users/9990241/tommy-oconnell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 0, "accepted_answer_id": 58001491, "answer_count": 3, "score": 1, "last_activity_date": 1572394282, "creation_date": 1568845277, "last_edit_date": 1568845608, "question_id": 58001432, "link": "https://stackoverflow.com/questions/58001432/how-to-capitalize-specific-letter-in-an-array", "title": "How to capitalize specific letter in an array", "body": "<p>I am trying to finish my first homework assignment in my C class.  The goal is for an array, find all lowercase E's and convert them to uppercase Es.</p>\n\n<p>I've tried a few variations after searching for hours on here and in the book to no avail.  Apologies for the newbie question as I'm very new to this.</p>\n\n<p>I'm not allowed to use any functions besides printf and random_letter, so most of what I found was not applicable.</p>\n\n<p>Here is the code from the test program</p>\n\n<pre><code>include &lt;stdio.h&gt;\nvoid capitalize_e(char s[]);\n\nint main(int argc, char *argv[]) {\n    char s[] = \"The elephant in the room.\";\n\n   printf(\"String before capitalizing e's: %s\\n\", s);\n   capitalize_e(s);\n\n   printf(\"String after capitalizing e's: %s\\n\", s);\n}\n</code></pre>\n\n<p>Here is my latest attempt.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n void capitalize_e(char s[], int size) {\n  int i;\n  char A = \"e\";\n  char B = \"E\";\n  for (i=0;i&lt;size; i++) {\n    if(s[i]==A)\n      s[i]==B;\n  }\n</code></pre>\n"}, {"tags": ["c", "user-interface", "callback"], "answers": [{"tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": true, "score": 0, "last_activity_date": 1568852110, "creation_date": 1568852110, "answer_id": 58002145, "question_id": 58001413, "link": "https://stackoverflow.com/questions/58001413/callback-to-multiple-functions-in-c/58002145#58002145", "title": "Callback to multiple functions in C", "body": "<p>Use a function pointer.</p>\n\n<pre><code>void (*keyPressed)(screen *);\n\nvoid keyXPressed(screen *s) {\n    // code here\n}\nvoid keyYPressed(screen *s) {\n    // code here\n}\n</code></pre>\n\n<p>Then you can assign <code>keyPressed = keyXPressed;</code> or <code>keyPressed = keyYPressed;</code>, and call <code>keyPressed(screen1);</code></p>\n"}], "owner": {"reputation": 3, "user_id": 12087362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9e5111dcc5c9064d8b10d2dce33dfe9?s=128&d=identicon&r=PG&f=1", "display_name": "unknown", "link": "https://stackoverflow.com/users/12087362/unknown"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 0, "accepted_answer_id": 58002145, "answer_count": 1, "score": 0, "last_activity_date": 1568852110, "creation_date": 1568845134, "question_id": 58001413, "link": "https://stackoverflow.com/questions/58001413/callback-to-multiple-functions-in-c", "title": "Callback to multiple functions in C", "body": "<p>I'm trying to write code in C (for embedded application), in which there would be event callback (caused by pressing a button) calling different functions, depending on GUI screen that is currently displayed.<br>\nIdeally I would like to \"define\" function like: keyXPressed() many times and programming different actions in different parts of the code (like on Screen1 do this and on Screen2 do that), so that single callback would always refer to one that is currently on. I know that multiple definitions of the functions are probably not the way and presumably some object-oriented techniques will be involved.<br>\nWhat are the ways of achieving such functionality in simple and elegant manner?</p>\n"}, {"tags": ["c++", "c", "gcc"], "comments": [{"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1568845044, "post_id": 58001381, "comment_id": 102408445, "body": "Would memory barriers do what you&#39;re looking for?"}, {"owner": {"reputation": 354, "user_id": 5199427, "user_type": "registered", "accept_rate": 27, "profile_image": "https://i.stack.imgur.com/YdwB1.jpg?s=128&g=1", "display_name": "Alifornia", "link": "https://stackoverflow.com/users/5199427/alifornia"}, "edited": false, "score": 1, "creation_date": 1568845609, "post_id": 58001381, "comment_id": 102408570, "body": "While you can use compiler options, there is no guarantee that the compiler obeys your expected order of operations, precisely. A compiler only guarantees to not change the meaning of the given program."}, {"owner": {"reputation": 29641, "user_id": 10871073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ddBW9.png?s=128&g=1", "display_name": "Adrian Mole", "link": "https://stackoverflow.com/users/10871073/adrian-mole"}, "edited": false, "score": 3, "creation_date": 1568846025, "post_id": 58001381, "comment_id": 102408664, "body": "It&#39;s a good question! One that needs some thought. But, in the meantime, please use &#39;better&#39; code - rather than <code>using namespace std</code> (lazy) do <code>using std::cout</code>. You&#39;re better than that."}, {"owner": {"reputation": 177, "user_id": 7304614, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-uFr3kLgPAm0/AAAAAAAAAAI/AAAAAAAAAAA/VJy8zzehJeA/photo.jpg?sz=128", "display_name": "Colin Weltin-Wu", "link": "https://stackoverflow.com/users/7304614/colin-weltin-wu"}, "edited": false, "score": 0, "creation_date": 1568850277, "post_id": 58001381, "comment_id": 102409548, "body": "Hoookay no lazy :(. I looked at memory barriers, I had to Google, and it looks like it would do what I want but like swatting a fly with a hammer (this is actually very hard). I think it would also be a massive performance hit and I can&#39;t afford that where these computations lie. Thanks though."}, {"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 2, "creation_date": 1568850367, "post_id": 58001381, "comment_id": 102409566, "body": "lol - if it gets that important, asm."}, {"owner": {"reputation": 7273, "user_id": 2193968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1beed39f2b04409ff584a0af1d59325c?s=128&d=identicon&r=PG", "display_name": "Jerry Jeremiah", "link": "https://stackoverflow.com/users/2193968/jerry-jeremiah"}, "edited": false, "score": 1, "creation_date": 1568857590, "post_id": 58001381, "comment_id": 102410790, "body": "If you don&#39;t want the compiler to optimise a specific function have a look at this:   <a href=\"https://stackoverflow.com/questions/4713320/is-there-any-way-to-disable-compiler-optimisation-for-a-specific-line-of-code\" title=\"is there any way to disable compiler optimisation for a specific line of code\">stackoverflow.com/questions/4713320/&hellip;</a>  You will need to make sure that the code you put into that function is optimised by hand..."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10957435"}, "edited": false, "score": 0, "creation_date": 1568870422, "post_id": 58001381, "comment_id": 102413177, "body": "Keep in mind that no matter what you do, <a href=\"https://stackoverflow.com/q/588004/10957435\">floating point math will always be slightly inaccurate</a>. If you need that level of accuracy, you may just need a more precision."}, {"owner": {"reputation": 6533, "user_id": 1918193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b70a14318e0f417ecac47809f38fafc?s=128&d=identicon&r=PG", "display_name": "Marc Glisse", "link": "https://stackoverflow.com/users/1918193/marc-glisse"}, "edited": false, "score": 1, "creation_date": 1568874157, "post_id": 58001381, "comment_id": 102414560, "body": "You can put every intermediate result in a volatile variable, and re-read it from that variable."}, {"owner": {"reputation": 177, "user_id": 7304614, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-uFr3kLgPAm0/AAAAAAAAAAI/AAAAAAAAAAA/VJy8zzehJeA/photo.jpg?sz=128", "display_name": "Colin Weltin-Wu", "link": "https://stackoverflow.com/users/7304614/colin-weltin-wu"}, "edited": false, "score": 0, "creation_date": 1568913289, "post_id": 58001381, "comment_id": 102435742, "body": "My only constraint is I rely on the deterministic behavior of floating point computations, which as I understand is guaranteed by the IEEE standard, secondary consideration is the absolute precision. I just need to guarantee the exact sequence of operations is what I want it to be. I think I will end up going the assembly route one day. I would try the trick with volatiles but first I need to concoct a test case. Thanks everyone for the ideas!"}], "owner": {"reputation": 177, "user_id": 7304614, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-uFr3kLgPAm0/AAAAAAAAAAI/AAAAAAAAAAA/VJy8zzehJeA/photo.jpg?sz=128", "display_name": "Colin Weltin-Wu", "link": "https://stackoverflow.com/users/7304614/colin-weltin-wu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 270, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1568850125, "creation_date": 1568844895, "last_edit_date": 1568850125, "question_id": 58001381, "link": "https://stackoverflow.com/questions/58001381/c-c-tricks-to-enforce-floating-point-order-of-operations", "title": "C/C++ Tricks to Enforce Floating Point Order of Operations", "body": "<p>I am looking for ways to force gcc to respect a particular order of operations (it does not have to be the order that minimizes floating point error, just whatever order I happen to want) regarding double-precision arithmetic of a particular section of code, while allowing full <code>-O3 -funsafe-math-optimizations</code> elsewhere. I have seen a few posts on this matter:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/13913017/are-floating-point-operations-in-c-associative\">Are floating point operations in C associative?</a></p>\n\n<p><a href=\"https://devblogs.microsoft.com/cppblog/do-you-prefer-fast-or-precise/\" rel=\"nofollow noreferrer\">https://devblogs.microsoft.com/cppblog/do-you-prefer-fast-or-precise/</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/11296854/c-c-math-order-of-operation?noredirect=1&amp;lq=1\">C/C++ Math Order of Operation</a></p>\n\n<p>The above links discuss global options, but I'd like to understand if local compiler directives exist. For example, when doing hardware synthesis, it is possible to force the compiler to synthesize a logical expression verbatim without doing any reduction.</p>\n\n<p>For example, consider</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include &lt;iomanip&gt;\n\nusing std::cout;\n\nint main()\n{\n    double a = 1.0 + 1.3e-16;\n    double b = 1.0;\n    double c = 100.0;\n\n    double d = (a - b) / c;\n    double e = a / c - b / c;\n\n    cout &lt;&lt; std::scientific;\n    cout &lt;&lt; \"Calculation d = \" &lt;&lt; d &lt;&lt; \"\\n\";\n    cout &lt;&lt; \"Calculation e = \" &lt;&lt; e &lt;&lt; \"\\n\";\n\n    double f = 1.0;\n    double g = 2e-15;\n    double h = 1.0;\n    double i = 1e-15;\n\n    double j = (f + g) - (h + i);\n    double k = (f - h) + (g - i);\n    double m = f + g - h - i;\n    double n = f - h + g - i;\n\n    cout &lt;&lt; \"Calculation j = \" &lt;&lt; j &lt;&lt; \"\\n\";\n    cout &lt;&lt; \"Calculation k = \" &lt;&lt; k &lt;&lt; \"\\n\";\n    cout &lt;&lt; \"Calculation m = \" &lt;&lt; m &lt;&lt; \"\\n\";\n    cout &lt;&lt; \"Calculation n = \" &lt;&lt; n &lt;&lt; \"\\n\";\n}\n</code></pre>\n\n<p>Using <a href=\"http://cpp.sh\" rel=\"nofollow noreferrer\">http://cpp.sh</a>, I get</p>\n\n<pre><code>Calculation d = 2.220446e-18\nCalculation e = 1.734723e-18\nCalculation j = 8.881784e-16\nCalculation k = 1.000000e-15\nCalculation m = 9.984014e-16\nCalculation n = 1.000000e-15\n</code></pre>\n\n<p>This was independent of the optimization level I used, so it seems that the compiler will calculate things in the order I expect based on the expression, plus even maintains left-right order for the +/- But is this absolutely guaranteed, when optimizations are turned on?</p>\n\n<p>I can think of a scenario for example where one of the operands is already sitting in some useful register whereby it would save some memory move to compute things in a different order than I wrote, but would maintain symbolic correctness.</p>\n\n<p>Basically I can't begin to try different hacks to fix the issue, e.g., I read that declaring sub-products as volatile variables would help, since my example doesn't show the problem. So I'd like to know if this is indeed a non-problem, or if not, what tricks exist.</p>\n"}, {"tags": ["c", "security", "passwords", "exploit"], "comments": [{"owner": {"reputation": 22422, "user_id": 634919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f4a87fe094961af20263d8e7ff445b2?s=128&d=identicon&r=PG", "display_name": "Nate Eldredge", "link": "https://stackoverflow.com/users/634919/nate-eldredge"}, "edited": false, "score": 0, "creation_date": 1568844522, "post_id": 58001294, "comment_id": 102408317, "body": "Hint: <code>char</code> can be a signed type."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1568845074, "post_id": 58001294, "comment_id": 102408458, "body": "What do you mean &quot;bypass&quot; exactly? Obviously the code is written to check a password, so actually &quot;bypassing&quot; the password would require re-writing the code, or hacking the final executable. What are you really trying to accomplish?  And BTW, <code>checkPassword()</code> can be simplified to just <code>return strcmp(user_pw, correct_pw) == 0;</code>, you don&#39;t need everything else in it"}, {"owner": {"reputation": 22422, "user_id": 634919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f4a87fe094961af20263d8e7ff445b2?s=128&d=identicon&r=PG", "display_name": "Nate Eldredge", "link": "https://stackoverflow.com/users/634919/nate-eldredge"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1568846190, "post_id": 58001294, "comment_id": 102408711, "body": "@RemyLebeau: The code is <i>meant</i> to check a password... the question is whether it will actually do it, or if it can be exploited."}, {"owner": {"reputation": 22422, "user_id": 634919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f4a87fe094961af20263d8e7ff445b2?s=128&d=identicon&r=PG", "display_name": "Nate Eldredge", "link": "https://stackoverflow.com/users/634919/nate-eldredge"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1568846554, "post_id": 58001294, "comment_id": 102408807, "body": "@RemyLebeau: I disagree.  At the very least, at the level of standard C, it is possible to provide input for which the code has Undefined Behavior."}, {"owner": {"reputation": 22422, "user_id": 634919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f4a87fe094961af20263d8e7ff445b2?s=128&d=identicon&r=PG", "display_name": "Nate Eldredge", "link": "https://stackoverflow.com/users/634919/nate-eldredge"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 1, "creation_date": 1568846695, "post_id": 58001294, "comment_id": 102408843, "body": "@RemyLebeau: I was trying not to give it away, but what happens if <code>char</code> is a signed 8-bit type and <code>argv[3]</code> is exactly 128 characters long (not counting the trailing nul)?"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 22422, "user_id": 634919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f4a87fe094961af20263d8e7ff445b2?s=128&d=identicon&r=PG", "display_name": "Nate Eldredge", "link": "https://stackoverflow.com/users/634919/nate-eldredge"}, "edited": false, "score": 0, "creation_date": 1568846835, "post_id": 58001294, "comment_id": 102408870, "body": "@NateEldredge Nevermind, I see what you are referring to now - <code>char len</code> instead of <code>int len</code>, causing a buffer overflow of <code>pw</code> when <code>strlen(user_pw) &gt; 127</code>. Simplify <code>checkPassword()</code> like I described earlier and the buffer overflow goes away."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1568847718, "post_id": 58001294, "comment_id": 102409066, "body": "But... but... but... That is unethical! No one would exploit a bug in the code to acquire access to a system. That would just be wrong on so many levels. What kind of animals are these people?"}, {"owner": {"reputation": 1, "user_id": 10736798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/386ad60295eedf385fc15125059c00ff?s=128&d=identicon&r=PG&f=1", "display_name": "xcydss1", "link": "https://stackoverflow.com/users/10736798/xcydss1"}, "edited": false, "score": 0, "creation_date": 1568863876, "post_id": 58001294, "comment_id": 102411820, "body": "got it now thx!"}], "owner": {"reputation": 1, "user_id": 10736798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/386ad60295eedf385fc15125059c00ff?s=128&d=identicon&r=PG&f=1", "display_name": "xcydss1", "link": "https://stackoverflow.com/users/10736798/xcydss1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 472, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1568863842, "creation_date": 1568844247, "last_edit_date": 1568863842, "question_id": 58001294, "link": "https://stackoverflow.com/questions/58001294/any-way-to-bypass-the-password-check-here", "title": "Any way to bypass the password check here?", "body": "<pre><code>static int checkPassword(char* user_pw) {\n\n  char dummy[128];\n  int accept = 0;\n  char pw[8];\n  char len;\n  char* correct_pw = \"xf35+\";\n  memset(pw, 0, sizeof(pw));\n  memset(dummy, 0, sizeof(dummy));\n\n  len = strlen(user_pw);\n  if (len &lt; 8) {\n    strcpy(pw, user_pw);\n  }\n  if (strcmp(pw, correct_pw) == 0) {\n    accept = 1;\n  }\n  return accept;\n}\n\n\nint main(int argc, char* argv[]) {\n  // Where argv[3] should be password\n  // ...\n  if (strlen(argv[3]) &gt; 128) {\n    fprintf(stderr, \"Password is too long!\\n\");\n    return 1;\n  }\n\n  if (checkPassword(argv[3]) == 0) {\n    fprintf(stderr, \"Password is incorrect!\\n\");\n    return 1;\n  }\n  // ...\n}\n</code></pre>\n\n<p>The passwrod here is hard-coded but is there any way to bypass the password check?\nI noticed that \"len\" is declared as a char but still don't know exactly how to solve this</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 4, "creation_date": 1568844344, "post_id": 58001282, "comment_id": 102408270, "body": "The array <code>arr2</code> has static <i>duration</i> (not &quot;scope&quot;), and so lasts as long as the program does.  (It never goes away.)"}, {"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1568845055, "post_id": 58001282, "comment_id": 102408453, "body": "Scope is something the compiler worries about, it is not in scope outside of the function.  Storage is something the processor worries about, the static keyword ensures it is stable outside of the function.  Whether that storage is valid when you use threads is what you get to worry about, the C language spec doesn&#39;t help with that."}, {"owner": {"reputation": 20522, "user_id": 11941443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f27a880243178eedf3abdab24898b335?s=128&d=identicon&r=PG&f=1", "display_name": "walnut", "link": "https://stackoverflow.com/users/11941443/walnut"}, "edited": false, "score": 2, "creation_date": 1568846000, "post_id": 58001282, "comment_id": 102408658, "body": "Your example is problematic, because it has undefined behavior due to out-of-bounds access anyway. (except for special intputs)"}], "answers": [{"comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1568851168, "post_id": 58001529, "comment_id": 102409702, "body": "Good link to the C11 pdf. You can also deep-link to the <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n2310.pdf#subsection.6.2.4\" rel=\"nofollow noreferrer\">C18 Standard (draft n2130) - 6.2.4 Storage Duration of Objects</a> or you can link to the html <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.2.4\" rel=\"nofollow noreferrer\">C11 Standard (draft n1570) - 6.2.4 Storage Duration of Objects</a>. What you have is fine, the deep-links just allow jumping directly to the section of interest."}], "tags": [], "owner": {"reputation": 9606, "user_id": 3677097, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b8c49e598194e53b9aba3a195da387a5?s=128&d=identicon&r=PG&f=1", "display_name": "Andreas DM", "link": "https://stackoverflow.com/users/3677097/andreas-dm"}, "is_accepted": true, "score": 3, "last_activity_date": 1568851976, "last_edit_date": 1568851976, "creation_date": 1568846056, "answer_id": 58001529, "question_id": 58001282, "link": "https://stackoverflow.com/questions/58001282/does-a-static-variable-inside-a-function-ever-go-out-of-scope/58001529#58001529", "title": "Does a static variable inside a function ever go out of scope?", "body": "<blockquote>\n  <p>My question is since arr2 is static will it always be in scope even if\n  the function that defines it will never be called again. Is this\n  undefined behavior or can we assume that it never loses scope?</p>\n</blockquote>\n\n<p>If we look at <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n2310.pdf#subsection.6.2.4\" rel=\"nofollow noreferrer\"><code>draft N2310 - 6.2.4 Storage durations of objects</code></a><br></p>\n\n<p>You'll see that it states (emphasis mine)</p>\n\n<blockquote>\n  <ol start=\"3\">\n  <li>An object whose identifier is declared without the storage-class\n  specifier\n  _Thread_local, and either with external or internal linkage or with the storage-class specifier <strong>static</strong>, has <em>static storage duration</em>. Its\n  <strong>lifetime is the entire execution of the program</strong> and its stored value\n  is <strong>initialized only once</strong>, prior to program startup.</li>\n  </ol>\n</blockquote>\n"}], "owner": {"reputation": 1340, "user_id": 7218062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0e0d5a2d3c49c93f1aafd67adaaca59?s=128&d=identicon&r=PG&f=1", "display_name": "jmq", "link": "https://stackoverflow.com/users/7218062/jmq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 190, "favorite_count": 1, "accepted_answer_id": 58001529, "answer_count": 1, "score": 3, "last_activity_date": 1568870042, "creation_date": 1568844152, "last_edit_date": 1568870042, "question_id": 58001282, "link": "https://stackoverflow.com/questions/58001282/does-a-static-variable-inside-a-function-ever-go-out-of-scope", "title": "Does a static variable inside a function ever go out of scope?", "body": "<p>While reading this <a href=\"https://stackoverflow.com/questions/57999737/how-to-find-multiple-missing-integers-in-an-array-using-c\">Question</a> I noticed an interesting scenario.  The question has a function which is only called once:</p>\n\n<pre><code>int* missing_elements(int arr[], int len){\n\n    static int arr2[]={0};\n\n    for(int i=0,j=1; i &lt; 7; i++,j++){\n        if(arr[i] != j){\n            arr2[i]=j;\n            if(arr[i] == j++){\n                break;\n            }\n        }\n    }\n    return arr2;\n}\n</code></pre>\n\n<p>The function is returning a pointer to an array that is defined as static within the function.  I'm curious about how the scope of <code>arr2[]</code> is handled.  If <code>arr2[]</code> was defined as not static then then it would fall out of scope and you couldn't assume that the returned pointer would point to valid data.  </p>\n\n<p>My question is since <code>arr2</code> is static will it always be in scope even if the function that defines it will never be called again.  Is this undefined behavior or can we assume that it never loses scope?  </p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 1623, "user_id": 3263719, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/a3aff3452a5b060165118cd3a18f5e54?s=128&d=identicon&r=PG&f=1", "display_name": "c1moore", "link": "https://stackoverflow.com/users/3263719/c1moore"}, "edited": false, "score": 0, "creation_date": 1568842838, "post_id": 58001066, "comment_id": 102407877, "body": "It&#39;s always just + 1."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 1623, "user_id": 3263719, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/a3aff3452a5b060165118cd3a18f5e54?s=128&d=identicon&r=PG&f=1", "display_name": "c1moore", "link": "https://stackoverflow.com/users/3263719/c1moore"}, "edited": false, "score": 1, "creation_date": 1568842957, "post_id": 58001066, "comment_id": 102407900, "body": "@c1moore Not if it wants to do it in 32-bit chunks."}, {"owner": {"reputation": 1220, "user_id": 5878272, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/14e96159153b67fab5222b7c5fa18c71?s=128&d=identicon&r=PG&f=1", "display_name": "Fredrik", "link": "https://stackoverflow.com/users/5878272/fredrik"}, "edited": false, "score": 0, "creation_date": 1568843059, "post_id": 58001066, "comment_id": 102407931, "body": "Your cast of d to int is wrong, the parameter will get the integer value of the pointer which I don\u2019t think is what you want."}, {"owner": {"reputation": 1220, "user_id": 5878272, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/14e96159153b67fab5222b7c5fa18c71?s=128&d=identicon&r=PG&f=1", "display_name": "Fredrik", "link": "https://stackoverflow.com/users/5878272/fredrik"}, "edited": false, "score": 0, "creation_date": 1568843203, "post_id": 58001066, "comment_id": 102407966, "body": "You have to do callAnotherMethod(*((int*)d));"}, {"owner": {"reputation": 1623, "user_id": 3263719, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/a3aff3452a5b060165118cd3a18f5e54?s=128&d=identicon&r=PG&f=1", "display_name": "c1moore", "link": "https://stackoverflow.com/users/3263719/c1moore"}, "edited": false, "score": 0, "creation_date": 1568843240, "post_id": 58001066, "comment_id": 102407982, "body": "@Barnar True, I missed that part, but I should clarify.  It&#39;s always 1 to increment to the next item regardless of data type (even structs).  To skip multiple items, you increment the pointer by the number of items you want to skip.  To skip 32 bits, you add (32 / 8) = 4."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1568843976, "post_id": 58001066, "comment_id": 102408179, "body": "You haven&#39;t allocated any memory for <code>d</code>."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1568844107, "post_id": 58001066, "comment_id": 102408209, "body": "<code>getData()</code> can&#39;t change the value of <code>d</code>. Function parameters are passed by value, not by reference."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1568844137, "post_id": 58001066, "comment_id": 102408214, "body": "Do you mean <code>getData(&amp;d)</code>?"}, {"owner": {"reputation": 1220, "user_id": 5878272, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/14e96159153b67fab5222b7c5fa18c71?s=128&d=identicon&r=PG&f=1", "display_name": "Fredrik", "link": "https://stackoverflow.com/users/5878272/fredrik"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1568844397, "post_id": 58001066, "comment_id": 102408282, "body": "@Barmar you are correct ofcourse, I opened my mouth to fast."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1568844596, "post_id": 58001066, "comment_id": 102408330, "body": "I still don&#39;t see how you expect the <code>while</code> loop to end. Incrementing a pointer won&#39;t get to a null pointer. That&#39;s usually the test for looping through a linked list."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 12087351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbce05568e45e9940d5907991d89f9ed?s=128&d=identicon&r=PG&f=1", "display_name": "user12087351", "link": "https://stackoverflow.com/users/12087351/user12087351"}, "edited": false, "score": 0, "creation_date": 1568843254, "post_id": 58001093, "comment_id": 102407990, "body": "So its d += sizeof(int)/sizeof(char) correct? And reason is I am copying in 32 bits (int) however pointer is char pointer (8 bit)"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 1, "user_id": 12087351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbce05568e45e9940d5907991d89f9ed?s=128&d=identicon&r=PG&f=1", "display_name": "user12087351", "link": "https://stackoverflow.com/users/12087351/user12087351"}, "edited": false, "score": 1, "creation_date": 1568843418, "post_id": 58001093, "comment_id": 102408030, "body": "Yes. Why isn&#39;t it just an <code>int *</code> pointer in the first place?"}, {"owner": {"reputation": 1, "user_id": 12087351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbce05568e45e9940d5907991d89f9ed?s=128&d=identicon&r=PG&f=1", "display_name": "user12087351", "link": "https://stackoverflow.com/users/12087351/user12087351"}, "edited": false, "score": 0, "creation_date": 1568843698, "post_id": 58001093, "comment_id": 102408110, "body": "getData API is like boolean returnBooleanValue = getData(d) where d is parameter and value is returned in it. This is external function and this is how api is designed."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 1, "user_id": 12087351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbce05568e45e9940d5907991d89f9ed?s=128&d=identicon&r=PG&f=1", "display_name": "user12087351", "link": "https://stackoverflow.com/users/12087351/user12087351"}, "edited": false, "score": 0, "creation_date": 1568843736, "post_id": 58001093, "comment_id": 102408121, "body": "If it returns a boolean, how can you assign it to <code>char *d</code>?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 1, "user_id": 12087351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbce05568e45e9940d5907991d89f9ed?s=128&d=identicon&r=PG&f=1", "display_name": "user12087351", "link": "https://stackoverflow.com/users/12087351/user12087351"}, "edited": false, "score": 0, "creation_date": 1568843807, "post_id": 58001093, "comment_id": 102408134, "body": "Your <code>while (d != NULL)</code> loop will never stop. Incrementing a pointer should never result in <code>NULL</code>"}, {"owner": {"reputation": 1220, "user_id": 5878272, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/14e96159153b67fab5222b7c5fa18c71?s=128&d=identicon&r=PG&f=1", "display_name": "Fredrik", "link": "https://stackoverflow.com/users/5878272/fredrik"}, "reply_to_user": {"reputation": 1, "user_id": 12087351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbce05568e45e9940d5907991d89f9ed?s=128&d=identicon&r=PG&f=1", "display_name": "user12087351", "link": "https://stackoverflow.com/users/12087351/user12087351"}, "edited": false, "score": 0, "creation_date": 1568843855, "post_id": 58001093, "comment_id": 102408147, "body": "@user12087351 you still have an error when calling your other method, your are not passing the value pointed to but the actual adress of the pointer."}], "tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": true, "score": 0, "last_activity_date": 1568844146, "last_edit_date": 1568844146, "creation_date": 1568842941, "answer_id": 58001093, "question_id": 58001066, "link": "https://stackoverflow.com/questions/58001066/increment-pointer-while-copying-data/58001093#58001093", "title": "Increment pointer while copying data", "body": "<p><code>char</code> is generally 8 bits, so to increment by 32 bits you need to increment by <code>32/8</code>.</p>\n\n<pre><code>d += 4;\n</code></pre>\n\n<p>It would be better to parametrize this in terms of the size of a datatype.</p>\n\n<pre><code>d += sizeof(int);\n</code></pre>\n\n<p>You could also just convert the pointer to <code>int*</code> and incremented it normally.</p>\n\n<pre><code>intd = (int*)d;\nwhile (get_data((char *)intd)) {\n    callAnotherMethod(*intd);\n    intd++;\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12087351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbce05568e45e9940d5907991d89f9ed?s=128&d=identicon&r=PG&f=1", "display_name": "user12087351", "link": "https://stackoverflow.com/users/12087351/user12087351"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 58001093, "answer_count": 1, "score": -2, "last_activity_date": 1568845342, "creation_date": 1568842736, "last_edit_date": 1568845342, "question_id": 58001066, "link": "https://stackoverflow.com/questions/58001066/increment-pointer-while-copying-data", "title": "Increment pointer while copying data", "body": "<p>Question, I have a <code>char*</code> pointer pointing to some data (say 1kb). I have to call a method in chunk of 32bits current code I have is</p>\n\n<pre><code> char* d;\n boolean r = getData(d); // data will be filled in d\n while (*d != NULL) {\n     callAnotherMethod((int) d); // need to call it in chunk of 32 bit\n     d = d + 2; // Increment by 2 because its char pointer.\n }\n</code></pre>\n\n<p>What I am not sure about is, its <code>d + 2</code> or <code>d + 1</code>. I tried it and it works however not sure about concept.</p>\n\n<p>Also If its <code>int* d</code>, then whats correct <code>d + 1</code> or <code>d + 2</code>? </p>\n\n<p>Small update, yes cast to int is intentional because I want to <code>callAnotherMethod</code> with 32 bit data.</p>\n"}, {"tags": ["c", "arrays", "file", "char", "dynamic-memory-allocation"], "comments": [{"owner": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 0, "creation_date": 1568844763, "post_id": 58000769, "comment_id": 102408368, "body": "<code>if ( infile == NULL ) { perror( argv[1] );... }</code> . Tell the user which file, why the file could not be opened, and tell them on stderr."}, {"owner": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 0, "creation_date": 1568844893, "post_id": 58000769, "comment_id": 102408404, "body": "Why are you using scanf?  If you want to get a character from a file, use <code>fgetc</code>."}], "answers": [{"tags": [], "owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "is_accepted": false, "score": 1, "last_activity_date": 1568844486, "creation_date": 1568844486, "answer_id": 58001329, "question_id": 58000769, "link": "https://stackoverflow.com/questions/58000769/counting-most-reacurring-vowel-from-a-dynamically-allocated-file/58001329#58001329", "title": "Counting most reacurring vowel from a dynamically allocated file", "body": "<p>You're reading with <code>fscanf(infile,\"%d\",&amp;c)</code>. <code>%d</code> is for numbers, but you want characters. Use <code>%c</code> instead.</p>\n"}], "owner": {"reputation": 41, "user_id": 12087228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7a93b432a72c0bcaf8cd660f30e9a6c?s=128&d=identicon&r=PG&f=1", "display_name": "cdude", "link": "https://stackoverflow.com/users/12087228/cdude"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1568852500, "creation_date": 1568841044, "last_edit_date": 1568852500, "question_id": 58000769, "link": "https://stackoverflow.com/questions/58000769/counting-most-reacurring-vowel-from-a-dynamically-allocated-file", "title": "Counting most reacurring vowel from a dynamically allocated file", "body": "<p>In the first part of the code, I am allocating space for five strings from a file and printing them out which figured out the second part I am trying to count each vowel from file for each string. I think I'm close with my code, but it prints as a zero for the counter every time. I think it might be a problem with the second time trying to read in the file, but could use a hint in the right direction.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\nint main( int argc, char *argv[] )\n{\n    char max[1024];\n    char** buff;\n    int i=0 ,num = 5;\n    FILE *infile;\n    int lc = 0;     //counts how many lines there are\n    //asks for file name if none is supplied\n    if ( argc &lt; 2 )\n    {\n        printf(\"Must supply file name\\n\");\n        return 1;\n    }\n    infile = fopen( argv[1], \"r\" );\n    //checks to see if file opens\n    if ( infile == NULL )\n    {\n        printf(\"could not open  %s\\n\", argv[1]);\n        return 1;\n    }\n    buff = (char**)calloc(sizeof(max),sizeof(char));\n    int k;\n    for(k=0; k&lt;num;k++){\n        buff[k] = (char*)calloc(sizeof(max),sizeof(char));\n    }\n    while(fgets(max,sizeof(max),infile)){\n        strcpy(buff[i],max);\n        i++;\n    }\n    int x;\n    for(x =1; x&lt;i;x++){\n        lc++;\n        printf(\"%d:%s\",x,buff[x]);\n    }\n    int counter[5];\n    char c;\n    rewind(infile);\n    for(i=0; i&lt;5; i++){\n        counter[i]=0;}\n    while (fscanf(infile,\"%d\",&amp;c))\n    {\n         if (c=='a' || c=='A')\n             counter[0]++;\n         else if (c=='e' || c=='E')\n             counter[1]++;\n         else if (c=='i' || c=='I')\n             counter[2]++;\n         else if (c=='o' || c=='O')\n             counter[3]++;\n         else if (c=='u' || c=='U')\n             counter[4]++;\n    }\nfor(i = 0; i &lt; 5; i++){\n    printf(\"counter[%d] = %d\\n\", i, counter[i]);\n}\n</code></pre>\n"}, {"tags": ["c", "multithreading", "sockets", "gethostbyname"], "comments": [{"owner": {"reputation": 647, "user_id": 9773285, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e95570197a5ef8f4a067a3669c09143?s=128&d=identicon&r=PG&f=1", "display_name": "Mark A", "link": "https://stackoverflow.com/users/9773285/mark-a"}, "edited": false, "score": 0, "creation_date": 1568841832, "post_id": 58000555, "comment_id": 102407595, "body": "Check out the answer for this question: <a href=\"https://stackoverflow.com/questions/25951925/gethostbyname-processes-resolving-consistently-even-from-different-threads\" title=\"gethostbyname processes resolving consistently even from different threads\">stackoverflow.com/questions/25951925/&hellip;</a>.  This really seems like a thread safety issue.  Also check the man page for <code>gethostbyname</code>; it does not set errno on error, it sets h_errno."}, {"owner": {"reputation": 965, "user_id": 4040743, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/hAIWy.jpg?s=128&g=1", "display_name": "Pete", "link": "https://stackoverflow.com/users/4040743/pete"}, "reply_to_user": {"reputation": 647, "user_id": 9773285, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e95570197a5ef8f4a067a3669c09143?s=128&d=identicon&r=PG&f=1", "display_name": "Mark A", "link": "https://stackoverflow.com/users/9773285/mark-a"}, "edited": false, "score": 1, "creation_date": 1568910638, "post_id": 58000555, "comment_id": 102434594, "body": "@MarkA Hey Mark - HOLY COW, your comment is incredibly helpful!  I had no idea there were global memory issues with gethostbyname().  I had to spend a few hours refitting my code to use getaddrinfo(), but it was worth it.  Thank God you spotted this; an issue like this seems to be critical if you want to multithreading network programming.  Why isn&#39;t this information front and center in the tutorials?  Man, I&#39;d be in a lot of pain if you hadn&#39;t chipped in.  Great catch, thanks so much.  I owe you a beer."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1568935418, "post_id": 58000555, "comment_id": 102443215, "body": "@Pete <code>gethostbyname()</code> is deprecated anyway, you should be using <code>getaddrinfo()</code> instead."}, {"owner": {"reputation": 965, "user_id": 4040743, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/hAIWy.jpg?s=128&g=1", "display_name": "Pete", "link": "https://stackoverflow.com/users/4040743/pete"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1568989250, "post_id": 58000555, "comment_id": 102462796, "body": "@RemyLebeau thank Remy.  I outfitted my code with getaddrinfo() and it runs much, much smoother now.  gethostbyname() must have been causing more havoc than I realized"}], "answers": [{"comments": [{"owner": {"reputation": 965, "user_id": 4040743, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/hAIWy.jpg?s=128&g=1", "display_name": "Pete", "link": "https://stackoverflow.com/users/4040743/pete"}, "edited": false, "score": 0, "creation_date": 1568910746, "post_id": 58000951, "comment_id": 102434653, "body": "Wow, thanks Darren!  You were 100% right.  I never would have caught that.  I&#39;m so used to pairing my calls to free() in the same function which calls malloc(), that I did it here without thinking.  Awesome, thanks for the assist!"}], "tags": [], "owner": {"reputation": 1726, "user_id": 1776419, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/aef72f0ece44f4952764a30b5b10da9b?s=128&d=identicon&r=PG", "display_name": "Darren Smith", "link": "https://stackoverflow.com/users/1776419/darren-smith"}, "is_accepted": true, "score": 1, "last_activity_date": 1568842162, "creation_date": 1568842162, "answer_id": 58000951, "question_id": 58000555, "link": "https://stackoverflow.com/questions/58000555/c-threads-inconsistently-open-a-sending-socket/58000951#58000951", "title": "C :: Threads Inconsistently Open a Sending Socket", "body": "<p>Problem is here:</p>\n\n<pre><code>  pthread_create(&amp;thread, NULL, process, (void*) pack);\n  pthread_detach(thread);\n\n  free( pack-&gt;IP );\n  free( pack );\n</code></pre>\n\n<p>... you create a resource specific for the new thread (<code>pack</code>) and then immediately delete it before the thread has completed its work!   These calls to free should be performed at the end of <code>process</code></p>\n"}], "owner": {"reputation": 965, "user_id": 4040743, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/hAIWy.jpg?s=128&g=1", "display_name": "Pete", "link": "https://stackoverflow.com/users/4040743/pete"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 58000951, "answer_count": 1, "score": 0, "last_activity_date": 1568842162, "creation_date": 1568839744, "question_id": 58000555, "link": "https://stackoverflow.com/questions/58000555/c-threads-inconsistently-open-a-sending-socket", "title": "C :: Threads Inconsistently Open a Sending Socket", "body": "<p>I am building a C program and I\u2019m wrestling with a weird \u2013 and inconsistent \u2013 thread and socket error with <code>gethostbyname()</code> that I\u2019ve never seen before.</p>\n\n<p>Some environmental stuff first:  I\u2019m working on a Ubuntu box, and my code is compiled with GCC:</p>\n\n<pre><code>root@ubuntu:/home/me/socketProject# gcc -v\n...\ngcc version 5.4.0 20160609 (Ubuntu 5.4.0-6ubuntu1~16.04.4)\nroot@ubuntu:/home/me/socketProject#\n</code></pre>\n\n<p>The objective here:  I\u2019ve developed another C program which will someday be a network service, I hope.  The server is working fine, but I need to stress-test it.  So I\u2019ve built a client program to bombard it with simulated network requests.  Once the server is up and listening on TCP 12345, the client program just needs to do the following:</p>\n\n<ul>\n<li>For N times, spin up a detached worker thread\n\n<ul>\n<li>Each thread should open a sending socket, then send some data to 127.0.0.1, via TCP 12345</li>\n<li>After sending, a thread should immediately terminate</li>\n</ul></li>\n</ul>\n\n<p>This should be child\u2019s play.  I want to use large numbers of N to see what happens when my server is pounded.</p>\n\n<p>Let me walk you through my code, then describe the problem.  The program is relatively simple.  There's a few structs and then <code>main()</code>.  Basically, <code>main()</code> loops for N = <code>numThreads</code>, creating a detached worker thread each time.  Each thread is given a populated <code>package</code> struct, with information it will use later:</p>\n\n<pre><code>typedef struct{\n   int sock;\n   struct sockaddr address;\n   int addr_len;\n} connection_t;\n\ntypedef struct{\n   char* IP;\n   int port, myNum;\n} package;\n\n\nvoid process(void* pack);                  // code for the thread, see below...\n\n\nint main( int argc, char ** argv ){\n   pthread_t  thread;\n   int        numThreads = 10;             // or 100 or 1000 or whatever\n   char       svrIP[20] = \"127.0.0.1\";\n   int        portNumber = 12345;\n\n   int i=0;\n   for( ; i&lt;numThreads; i++){\n\n      package* pack   = (package*) malloc( sizeof(package) );\n      pack-&gt;IP        = (char*) malloc( sizeof(char) * 20 );\n      strcpy( pack-&gt;IP, svrIP );\n      pack-&gt;port      = portNumber;\n      pack-&gt;myNum     = i;\n\n      pthread_create(&amp;thread, NULL, process, (void*) pack);\n      pthread_detach(thread);\n\n      free( pack-&gt;IP );\n      free( pack );\n   }\n\n   sleep(1);\n\n   printf(\"END OF PROGRAM\\n\");\n   return 0;\n}\n</code></pre>\n\n<p>Everything above works great, regardless of what I set for <code>numThreads</code>.  Now for the thread\u2019s code.  Upon birth, the thread tries to open a socket and then send a text string.  Then the thread terminates.  Note all that <code>fprintf()</code> code around <code>gethostbyname()</code> \u2013 I\u2019ll be referring to it later:</p>\n\n<pre><code>void process(void* pack){\n   int                  len, sock = -1;\n   struct sockaddr_in   address;\n   struct hostent *     host;\n\n   char* msg = \"Some text string here for the server...\";\n\n   printf(\"THREAD %d STARTED:  %s  --  %d\\n\", ((package*)pack)-&gt;myNum, ((package*)pack)-&gt;IP, ((package*)pack)-&gt;port );\n\n   // create the socket\n   sock = socket(AF_INET, SOCK_STREAM, IPPROTO_TCP);\n   if (sock &lt;= 0){\n      fprintf( stderr, \"Thread %d: error: cannot create socket\\n\", ((package*)pack)-&gt;myNum );\n      pthread_exit(0);\n   }\n\n   // connect to server\n   address.sin_family = AF_INET;\n   address.sin_port = htons( ((package*)pack)-&gt;port );\n   host = gethostbyname( ((package*)pack)-&gt;IP );\n   if (!host){\n      fprintf( stderr, \"Thread %d: error: unknown host %s  --  Error is:  (%d) \\\u201d%s\\\u201d\\n\",\n            ((package*)pack)-&gt;myNum,\n            ((package*)pack)-&gt;IP,\n            errno, strerror(errno));\n      pthread_exit(0);\n   }\n\n   memcpy(&amp;address.sin_addr, host-&gt;h_addr_list[0], host-&gt;h_length);\n   if (connect(sock, (struct sockaddr *)&amp;address, sizeof(address))){\n      fprintf( stderr, \"Thread %d: error: cannot connect to host %s\\n\", ((package*)pack)-&gt;myNum, ((package*)pack)-&gt;IP );\n      pthread_exit(0);\n   }\n\n   printf(\"Thread %d: Sending message \\\u201d%s\\\u201d\\n\", ((package*)pack)-&gt;myNum, msg);\n\n   len = strlen(msg);\n   write(sock, &amp;len, sizeof(int));\n   write(sock, msg, len);\n\n   printf(\"Thread %d: message sent, exiting...\\n\", ((package*)pack)-&gt;myNum );\n\n   close(sock);\n\n   pthread_exit(0);\n}\n</code></pre>\n\n<p>Okay, so that\u2019s the code.  So here\u2019s the issue:</p>\n\n<p>Regardless of what value I set for <code>numThreads</code>, some worker threads successfully open a socket, and some don\u2019t.  The ones who fail are failing on that call to <code>gethostbyname()</code>.  Check out the below; I\u2019ve set <code>numThreads</code> to 10, which means I should be seeing Threads 0 through 9 launch:</p>\n\n<pre><code>me@ubuntu:/home/me/socketProject# ./runTest\nTHREAD 2 STARTED:  127.0.0.1  --  24601\nTHREAD 5 STARTED:  127.0.0.1  --  24601\nTHREAD 3 STARTED:  127.0.0.1  --  24601\nTHREAD 3 STARTED:  127.0.0.1  --  24601\nTHREAD 4 STARTED:  127.0.0.1  --  24601\nTHREAD 7 STARTED:  127.0.0.1  --  24601\nThread 7: Sending message \"Some text string here for the server...\"\nThread 7: message sent, exiting...\nTHREAD 7 STARTED:  127.0.0.1  --  24601\nThread 7: Sending message \"Some text string here for the server...\"\nThread 7: message sent, exiting...\nTHREAD 8 STARTED:  127.0.0.1  --  24601\nThread 8: Sending message \"Some text string here for the server...\"\nThread 8: message sent, exiting...\nTHREAD 9 STARTED:    --  24601\nTHREAD 9 STARTED:    --  24601\nThread 9: Sending message \"Some text string here for the server...\"\nThread 9: message sent, exiting...\nThread 9: error: unknown host   --  Error is:  (0) \"Success\"\nThread 9: error: unknown host   --  Error is:  (0) \"Success\"\nThread 9: error: unknown host   --  Error is:  (0) \"Success\"\nThread 9: error: unknown host   --  Error is:  (0) \"Success\"\nThread 9: error: unknown host   --  Error is:  (0) \"Success\"\nThread 9: error: unknown host   --  Error is:  (0) \"Success\"\nEND OF PROGRAM\nme@ubuntu:/home/me/socketProject#\n</code></pre>\n\n<p>The server received four test messages, as the above output suggests.</p>\n\n<p>Sooooooooo\u2026  there\u2019s a lot of weirdness happening here.  There must be some bug with those \u201c<strong>THREAD X STARTED</strong>\u201d messages, because it looks like Threads 0, 1, and 6 never launched, while somehow Threads 3, 7, and 9 launched twice.  But <code>numThreads</code> == 10 and ten threads started, so I\u2019ll ignore that issue for now.</p>\n\n<p>Of greater concern is that six threads failed in their call to <code>gethostbyname()</code>.  I\u2019ll admit: for this chunk of code, I copied an example from a textbook, and I can\u2019t remember where I got it.  But I\u2019m wondering if that <code>if(!host)</code> statement makes sense.  There was no problem when I beta tested this in the non-threaded version, but now\u2026</p>\n\n<p>Of even bigger weirdness is that the Errno code is \"Success.\"  If its successful...  why is the call failing?  I feel like I'm missing something really, really obvious.</p>\n\n<p>It also bothers me that this problem is inconsistent.  Sometimes when I test this, 7/10 threads successfully send.  Sometimes 1/10 do.  My average success rate is about 3/10.  If I\u2019ve learned anything about C, its that inconsistent problems usually indicate that a variables has been successfully created but not initialized.  What might need to be initialized here?  The <code>host</code> struct?  I\u2019m not sure.</p>\n\n<p>I\u2019ve been Googling this for about three hours now, but not pulling up anything useful.  Any suggestions or advice will be wildly appreciated. </p>\n"}, {"tags": ["c++", "c", "xcode", "architecture"], "comments": [{"owner": {"reputation": 1, "user_id": 12086946, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kI2mPvEYR1k/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re-mZGEJVR1gLzRxjaZDWKGTTuicA/photo.jpg?sz=128", "display_name": "Yuhongze Zhou", "link": "https://stackoverflow.com/users/12086946/yuhongze-zhou"}, "edited": false, "score": 0, "creation_date": 1568835593, "post_id": 57999716, "comment_id": 102405301, "body": "Image Link is below."}, {"owner": {"reputation": 806, "user_id": 3472073, "user_type": "registered", "profile_image": "https://graph.facebook.com/1809942272/picture?type=large", "display_name": "ale_stro", "link": "https://stackoverflow.com/users/3472073/ale-stro"}, "edited": false, "score": 0, "creation_date": 1570615707, "post_id": 57999716, "comment_id": 102966031, "body": "the same for me"}], "owner": {"reputation": 1, "user_id": 12086946, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kI2mPvEYR1k/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re-mZGEJVR1gLzRxjaZDWKGTTuicA/photo.jpg?sz=128", "display_name": "Yuhongze Zhou", "link": "https://stackoverflow.com/users/12086946/yuhongze-zhou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1568835433, "creation_date": 1568835433, "question_id": 57999716, "link": "https://stackoverflow.com/questions/57999716/transfer-old-32-bit-project-to-64-bit-in-xcode-9-3-with-32bit-target", "title": "Transfer Old 32-bit Project to 64 bit in Xcode 9.3 with 32bit target", "body": "<p>as the title mentioned, Here are errors thrown from target who uses 32-bit library and the screenshot of Architectures of this target. I do not know where it is going wrong. Thank you for all possible help! I am in Mojave MacOSX. In order to build old 32-bit, I changed architectures of other target to 64 bit and there is no error for them while building. But for one target which is something like SWIG interface using python in C/C++. \n[enter image description here][1]</p>\n\n<pre><code>    cd \"/Users/zhouyuhongze/Downloads/cove_dev copy-64-9.3\"\n    export LANG=en_US.US-ASCII\n    /Applications/Xcode9.3.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/clang -x c++-header -arch ppc -fmessage-length=0 -fdiagnostics-show-note-include-stack -fmacro-backtrace-limit=0 -gmodules -Wno-trigraphs -fpascal-strings -O0 -Wno-missing-field-initializers -Wno-missing-prototypes -Wno-non-virtual-dtor -Wno-overloaded-virtual -Wno-exit-time-destructors -Wno-missing-braces -Wparentheses -Wswitch -Wno-unused-function -Wno-unused-label -Wno-unused-parameter -Wunused-variable -Wunused-value -Wno-empty-body -Wno-uninitialized -Wno-unknown-pragmas -Wno-shadow -Wno-four-char-constants -Wno-conversion -Wno-constant-conversion -Wno-int-conversion -Wno-bool-conversion -Wno-enum-conversion -Wno-float-conversion -Wno-non-literal-null-conversion -Wno-objc-literal-conversion -Wno-shorten-64-to-32 -Wno-newline-eof -Wno-c++11-extensions -DMAC -DUWWF_EXPORTS -isysroot /Applications/Xcode9.3.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.13.sdk -fstrict-aliasing -Wdeprecated-declarations -Winvalid-offsetof -mmacosx-version-min=10.14 -g -fvisibility-inlines-hidden -Wno-sign-conversion -Wno-infinite-recursion -Wno-move -Wno-comma -Wno-block-capture-autoreleasing -Wno-strict-prototypes -Wno-range-loop-analysis -index-store-path /Users/zhouyuhongze/Library/Developer/Xcode/DerivedData/cove-brktkbotsuuztjcusjhbbaohvtrb/Index/DataStore -I/Users/zhouyuhongze/Library/Developer/Xcode/DerivedData/cove-brktkbotsuuztjcusjhbbaohvtrb/Build/Intermediates.noindex/cove.build/Debug/uwwf_python.build/_uwwf_python.hmap -I/Users/zhouyuhongze/Library/Developer/Xcode/DerivedData/cove-brktkbotsuuztjcusjhbbaohvtrb/Build/Products/Debug/include -Ibase -Ibase/vl/include -Iidv -Ilib/fltk -Ilib/netcdf -I/Applications/Xcode9.3.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.13.sdk/System/Library/Frameworks/Python.framework/Versions/2.7/include/python2.7 -I/Users/zhouyuhongze/Library/Developer/Xcode/DerivedData/cove-brktkbotsuuztjcusjhbbaohvtrb/Build/Intermediates.noindex/cove.build/Debug/uwwf_python.build/DerivedSources/ppc -I/Users/zhouyuhongze/Library/Developer/Xcode/DerivedData/cove-brktkbotsuuztjcusjhbbaohvtrb/Build/Intermediates.noindex/cove.build/Debug/uwwf_python.build/DerivedSources -F/Users/zhouyuhongze/Library/Developer/Xcode/DerivedData/cove-brktkbotsuuztjcusjhbbaohvtrb/Build/Products/Debug -MD -MT dependencies -MF /Users/zhouyuhongze/Library/Developer/Xcode/DerivedData/cove-brktkbotsuuztjcusjhbbaohvtrb/Build/Intermediates.noindex/PrecompiledHeaders/cove_Prefix-gvxvqsoycewanvflcbunhiimhfnz/cove_Prefix.pch.d -c /Users/zhouyuhongze/Downloads/cove_dev\\ copy-64-9.3/cove_Prefix.pch -o /Users/zhouyuhongze/Library/Developer/Xcode/DerivedData/cove-brktkbotsuuztjcusjhbbaohvtrb/Build/Intermediates.noindex/PrecompiledHeaders/cove_Prefix-gvxvqsoycewanvflcbunhiimhfnz/cove_Prefix.pch.pch --serialize-diagnostics /Users/zhouyuhongze/Library/Developer/Xcode/DerivedData/cove-brktkbotsuuztjcusjhbbaohvtrb/Build/Intermediates.noindex/PrecompiledHeaders/cove_Prefix-gvxvqsoycewanvflcbunhiimhfnz/cove_Prefix.pch.dia\n\nIn file included from /Users/zhouyuhongze/Downloads/cove_dev copy-64-9.3/cove_Prefix.pch:5:\nIn file included from /Applications/Xcode9.3.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.13.sdk/System/Library/Frameworks/Carbon.framework/Headers/Carbon.h:20:\nIn file included from /Applications/Xcode9.3.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.13.sdk/System/Library/Frameworks/CoreServices.framework/Headers/CoreServices.h:19:\nIn file included from /Applications/Xcode9.3.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.13.sdk/System/Library/Frameworks/CoreFoundation.framework/Headers/CoreFoundation.h:16:\nIn file included from /Applications/Xcode9.3.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.13.sdk/usr/include/sys/types.h:75:\n/Applications/Xcode9.3.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.13.sdk/usr/include/sys/cdefs.h:763:2: error: Unsupported architecture\n#error Unsupported architecture\n ^\nIn file included from /Users/zhouyuhongze/Downloads/cove_dev copy-64-9.3/cove_Prefix.pch:5:\nIn file included from /Applications/Xcode9.3.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.13.sdk/System/Library/Frameworks/Carbon.framework/Headers/Carbon.h:20:\nIn file included from /Applications/Xcode9.3.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.13.sdk/System/Library/Frameworks/CoreServices.framework/Headers/CoreServices.h:19:\nIn file included from /Applications/Xcode9.3.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.13.sdk/System/Library/Frameworks/CoreFoundation.framework/Headers/CoreFoundation.h:16:\nIn file included from /Applications/Xcode9.3.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.13.sdk/usr/include/sys/types.h:78:\n/Applications/Xcode9.3.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.13.sdk/usr/include/machine/types.h:37:2: error: architecture not supported\n#error architecture not supported\n ^\nIn file included from /Users/zhouyuhongze/Downloads/cove_dev copy-64-9.3/cove_Prefix.pch:5:\nIn file included from /Applications/Xcode9.3.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.13.sdk/System/Library/Frameworks/Carbon.framework/Headers/Carbon.h:20:\nIn file included from /Applications/Xcode9.3.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.13.sdk/System/Library/Frameworks/CoreServices.framework/Headers/CoreServices.h:19:\nIn file included from /Applications/Xcode9.3.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.13.sdk/System/Library/Frameworks/CoreFoundation.framework/Headers/CoreFoundation.h:16:\nIn file included from /Applications/Xcode9.3.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.13.sdk/usr/include/sys/types.h:79:\nIn file included from /Applications/Xcode9.3.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.13.sdk/usr/include/sys/_types.h:33:\n/Applications/Xcode9.3.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.13.sdk/usr/include/machine/_types.h:34:2: error: architecture not supported\n#error architecture not supported\n ^\nIn file included from /Users/zhouyuhongze/Downloads/cove_dev copy-64-9.3/cove_Prefix.pch:5:\nIn file included from /Applications/Xcode9.3.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.13.sdk/System/Library/Frameworks/Carbon.framework/Headers/Carbon.h:20:\nIn file included from /Applications/Xcode9.3.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.13.sdk/System/Library/Frameworks/CoreServices.framework/Headers/CoreServices.h:19:\nIn file included from /Applications/Xcode9.3.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.13.sdk/System/Library/Frameworks/CoreFoundation.framework/Headers/CoreFoundation.h:16:\nIn file included from /Applications/Xcode9.3.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.13.sdk/usr/include/sys/types.h:79:\n/Applications/Xcode9.3.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.13.sdk/usr/include/sys/_types.h:55:9: error: unknown type name '__int64_t'\ntypedef __int64_t       __darwin_blkcnt_t;      /* total blocks */\n        ^\n/Applications/Xcode9.3.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.13.sdk/usr/include/sys/_types.h:56:9: error: unknown type name '__int32_t'\ntypedef __int32_t       __darwin_blksize_t;     /* preferred block size */\n        ^\n/Applications/Xcode9.3.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.13.sdk/usr/include/sys/_types.h:57:9: error: unknown type name '__int32_t'\ntypedef __int32_t       __darwin_dev_t;         /* dev_t */\n        ^\n/Applications/Xcode9.3.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.13.sdk/usr/include/sys/_types.h:60:9: error: unknown type name '__uint32_t'\ntypedef __uint32_t      __darwin_gid_t;         /* [???] process and group IDs */\n        ^\n/Applications/Xcode9.3.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.13.sdk/usr/include/sys/_types.h:61:9: error: unknown type name '__uint32_t'\ntypedef __uint32_t      __darwin_id_t;          /* [XSI] pid_t, uid_t, or gid_t*/\n        ^\n/Applications/Xcode9.3.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.13.sdk/usr/include/sys/_types.h:62:9: error: unknown type name '__uint64_t'\ntypedef __uint64_t      __darwin_ino64_t;       /* [???] Used for 64 bit inodes */\n        ^\n/Applications/Xcode9.3.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.13.sdk/usr/include/sys/_types.h:68:9: error: unknown type name '__darwin_natural_t'\ntypedef __darwin_natural_t __darwin_mach_port_name_t; /* Used by mach */\n        ^\n/Applications/Xcode9.3.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.13.sdk/usr/include/sys/_types.h:70:9: error: unknown type name '__uint16_t'\ntypedef __uint16_t      __darwin_mode_t;        /* [???] Some file attributes */\n        ^\n/Applications/Xcode9.3.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.13.sdk/usr/include/sys/_types.h:71:9: error: unknown type name '__int64_t'\ntypedef __int64_t       __darwin_off_t;         /* [???] Used for file sizes */\n        ^\n/Applications/Xcode9.3.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.13.sdk/usr/include/sys/_types.h:72:9: error: unknown type name '__int32_t'\ntypedef __int32_t       __darwin_pid_t;         /* [???] process and group IDs */\n        ^\n/Applications/Xcode9.3.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.13.sdk/usr/include/sys/_types.h:73:9: error: unknown type name '__uint32_t'\ntypedef __uint32_t      __darwin_sigset_t;      /* [???] signal set */\n        ^\n/Applications/Xcode9.3.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.13.sdk/usr/include/sys/_types.h:74:9: error: unknown type name '__int32_t'\ntypedef __int32_t       __darwin_suseconds_t;   /* [???] microseconds */\n        ^\n/Applications/Xcode9.3.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.13.sdk/usr/include/sys/_types.h:75:9: error: unknown type name '__uint32_t'\ntypedef __uint32_t      __darwin_uid_t;         /* [???] user IDs */\n        ^\n/Applications/Xcode9.3.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.13.sdk/usr/include/sys/_types.h:76:9: error: unknown type name '__uint32_t'\ntypedef __uint32_t      __darwin_useconds_t;    /* [???] microseconds */\n        ^\nIn file included from /Users/zhouyuhongze/Downloads/cove_dev copy-64-9.3/cove_Prefix.pch:5:\nIn file included from /Applications/Xcode9.3.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.13.sdk/System/Library/Frameworks/Carbon.framework/Headers/Carbon.h:20:\nIn file included from /Applications/Xcode9.3.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.13.sdk/System/Library/Frameworks/CoreServices.framework/Headers/CoreServices.h:19:\nIn file included from /Applications/Xcode9.3.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.13.sdk/System/Library/Frameworks/CoreFoundation.framework/Headers/CoreFoundation.h:16:\nIn file included from /Applications/Xcode9.3.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.13.sdk/usr/include/sys/types.h:81:\n/Applications/Xcode9.3.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.13.sdk/usr/include/machine/endian.h:37:2: error: architecture not supported\n#error architecture not supported\n ^\nIn file included from /Users/zhouyuhongze/Downloads/cove_dev copy-64-9.3/cove_Prefix.pch:5:\nIn file included from /Applications/Xcode9.3.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.13.sdk/System/Library/Frameworks/Carbon.framework/Headers/Carbon.h:20:\nIn file included from /Applications/Xcode9.3.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.13.sdk/System/Library/Frameworks/CoreServices.framework/Headers/CoreServices.h:19:\nIn file included from /Applications/Xcode9.3.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.13.sdk/System/Library/Frameworks/CoreFoundation.framework/Headers/CoreFoundation.h:16:\n/Applications/Xcode9.3.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.13.sdk/usr/include/sys/types.h:95:9: error: unknown type name 'u_int64_t'\ntypedef u_int64_t               u_quad_t;       /* quads */\n        ^\nfatal error: too many errors emitted, stopping now [-ferror-limit=]\n20 errors generated.```\n\n\n  [1]: https://i.stack.imgur.com/LmnLG.png\n</code></pre>\n"}, {"tags": ["c++", "c", "opengl-es", "gtk"], "comments": [{"owner": {"reputation": 374839, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "edited": false, "score": 0, "creation_date": 1568836536, "post_id": 57999432, "comment_id": 102405691, "body": "<code>glEGLImageTargetTexture2DOES(GL_TEXTURE_2D, ...);</code> is not legal. <code>glEGLImageTargetTexture2DOES</code> can only ever take <code>GL_TEXTURE_EXTERNAL_OES</code> as a target."}, {"owner": {"reputation": 305, "user_id": 6655884, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/JBKc9.jpg?s=128&g=1", "display_name": "Lucas Zanella", "link": "https://stackoverflow.com/users/6655884/lucas-zanella"}, "reply_to_user": {"reputation": 374839, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "edited": false, "score": 0, "creation_date": 1568841091, "post_id": 57999432, "comment_id": 102407321, "body": "@NicolBolas that&#39;s strnge, because no error happens after this call, and it apparently worked when I&#39;ve read with glReadPixels. Also, I took it from where where he said it worked: <a href=\"https://devtalk.nvidia.com/default/topic/1028811/export-gl-texture-as-dmabuf/?offset=8#5384937\" rel=\"nofollow noreferrer\">devtalk.nvidia.com/default/topic/1028811/&hellip;</a>. Do you have an alternative suggestion if not using <code>glEGLImageTargetTexture2DOES</code>?"}, {"owner": {"reputation": 305, "user_id": 6655884, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/JBKc9.jpg?s=128&g=1", "display_name": "Lucas Zanella", "link": "https://stackoverflow.com/users/6655884/lucas-zanella"}, "reply_to_user": {"reputation": 374839, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "edited": false, "score": 1, "creation_date": 1568841141, "post_id": 57999432, "comment_id": 102407338, "body": "@NicolBolas it&#39;s also used here <a href=\"https://devtalk.nvidia.com/default/topic/1030669/jetson-tx1/trying-to-process-with-opengl-an-eglimage-created-from-a-dmabuf_fd-/\" rel=\"nofollow noreferrer\">devtalk.nvidia.com/default/topic/1030669/jetson-tx1/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 2453, "user_id": 1853243, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ka9z.jpg?s=128&g=1", "display_name": "Sreeram Nair", "link": "https://stackoverflow.com/users/1853243/sreeram-nair"}, "is_accepted": true, "score": 2, "last_activity_date": 1569551622, "creation_date": 1569551622, "answer_id": 58127005, "question_id": 57999432, "link": "https://stackoverflow.com/questions/57999432/rendering-an-egl-image-to-a-frame-buffer-with-gtk/58127005#58127005", "title": "Rendering an EGL Image to a frame buffer with GTK", "body": "<p>Check the example implementations in <a href=\"https://devtalk.nvidia.com\" rel=\"nofollow noreferrer\">nvidia</a></p>\n\n<pre><code>tegra_multimedia_api\\argus\\samples\\utils\\PreviewConsumer.cpp\ntegra_multimedia_api\\samples\\common\\classes\\NvEglRenderer.cpp\n</code></pre>\n"}], "owner": {"reputation": 305, "user_id": 6655884, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/JBKc9.jpg?s=128&g=1", "display_name": "Lucas Zanella", "link": "https://stackoverflow.com/users/6655884/lucas-zanella"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 654, "favorite_count": 0, "accepted_answer_id": 58127005, "answer_count": 1, "score": 7, "last_activity_date": 1569551622, "creation_date": 1568834000, "last_edit_date": 1569044585, "question_id": 57999432, "link": "https://stackoverflow.com/questions/57999432/rendering-an-egl-image-to-a-frame-buffer-with-gtk", "title": "Rendering an EGL Image to a frame buffer with GTK", "body": "<p>I'm trying to render an <code>EGLImageKHR</code> that I get from NVIDIA's decoder, to a frame buffer so I can render this frame buffer in the screen. I wrote a code that does the following:</p>\n\n<p>Creates two textures, <code>frameBufferTexture</code> and <code>externalTexture</code>. We write our EGLImage to <code>externalTexture</code> and draw to <code>frameBufferTexture</code> from <code>externalTexture</code>. Then we read from <code>frameBufferTexture</code> with <code>glReadPixels</code>:</p>\n\n<pre><code>    glGenFramebuffers(1, &amp;frameBuffer);\n    glBindFramebuffer(GL_FRAMEBUFFER, frameBuffer);\n    glGenTextures(1, &amp;externalTexture);\n    glGenTextures(1, &amp;frameBufferTexture);\n    glBindTexture(GL_TEXTURE_2D, frameBufferTexture);\n    glTexImage2D(GL_TEXTURE_2D, 0, GL_RGBA8, decodedNvFrame-&gt;width, decodedNvFrame-&gt;height, 0, GL_RGBA, GL_UNSIGNED_BYTE, 0);\n    glUniform1i(texLocation, 0);\n\n    glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_LINEAR);\n    glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_LINEAR);\n\n    glBindFramebuffer(GL_FRAMEBUFFER, frameBuffer);\n    glBindTexture(GL_TEXTURE_2D, frameBufferTexture);\n\n    EGLImageKHR hEglImage;\n\n    hEglImage = NvEGLImageFromFd(eglDisplay, decodedNvFrame-&gt;nvBuffer-&gt;planes[0].fd);\n    if (!hEglImage)\n        printf(\"Could not get EglImage from fd. Not rendering\\n\");\n    glFramebufferTexture2D(GL_FRAMEBUFFER, GL_COLOR_ATTACHMENT0, GL_TEXTURE_2D, frameBufferTexture, 0);     \n    glBindTexture(GL_TEXTURE_2D, externalTexture);\n    glEGLImageTargetTexture2DOES(GL_TEXTURE_2D, hEglImage);\n    glUniform1i(texLocation, 0);\n    glBindVertexArray(vertexArrayObject);\n\n    glDrawArrays(GL_TRIANGLE_STRIP, 0, 4);\n\n    glReadBuffer(GL_COLOR_ATTACHMENT0);\n\n    GLenum frameBufferStatus = glCheckFramebufferStatus(GL_FRAMEBUFFER);\n    if (frameBufferStatus!=GL_FRAMEBUFFER_COMPLETE) {\n        printf(\"frameBufferStatus problem!\\n\");\n        abort();\n    }\n    glReadPixels(0, 0, 512, 512, GL_RGBA, GL_UNSIGNED_BYTE, r);\n\n    for (int i = 0; i &lt; 100; ++i)\n    {\n        printf(\"%i \", r[i]);\n    }\n    printf(\"\\n\");\n\n    NvDestroyEGLImage(eglDisplay, hEglImage);\n</code></pre>\n\n<p>See that I'm using glReadPixels to get just a piece of the frame buffer so I can see what's happening.</p>\n\n<p>This is what I get in the output:</p>\n\n<pre><code>0 0 0 255 0 0 0 255 0 0 0 255 ...\n</code></pre>\n\n<p>which I guess comes from the <code>glTexImage2D</code> cal where I pass <code>0</code>. This means that <code>glEGLImageTargetTexture2DOES</code> isn't pushing our image to the <code>externalTexture</code>.</p>\n\n<p>Here's the fragment shader:</p>\n\n<pre><code>#version 330 core\nout vec4 FragColor;\n\nin vec2 TexCoord;\nuniform sampler2D tex;\n\nvoid main()\n{\n    FragColor = texture(tex, TexCoord);\n}\n</code></pre>\n\n<p>If I change this shader to <code>FragColor = vec4(1.0,texture(tex, TexCoord).r,0,1.0)</code> I get this output:</p>\n\n<pre><code>255 0 0 255 255 0 0 255 255 0 0 255 ... \n</code></pre>\n\n<p>which means the shader is working and is writing to the frame buffer.\nIf I put</p>\n\n<pre><code>        glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_S, GL_CLAMP_TO_EDGE);\n        glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_T, GL_CLAMP_TO_EDGE);\n        glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_LINEAR);\n        glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_LINEAR);\n        glTexImage2D(GL_TEXTURE_2D, 0, GL_RGBA8, 512, 512, 0, GL_RGBA, GL_UNSIGNED_BYTE, d);\n</code></pre>\n\n<p>right after <code>glBindTexture(GL_TEXTURE_2D, externalTexture);</code>, I can see the contents of <code>d</code>, which means my fragment shader is writing data correctly from the texture <code>externalTexture</code>. </p>\n\n<p>This puts the problem in <code>glEGLImageTargetTexture2DOES</code>. It's not filling externalTexture with my image!</p>\n\n<p>Why?</p>\n\n<p><strong>ps</strong>: I suspect of <code>eglDisplay</code>. Why do I need a display to create an <code>EGLImageKHR</code>? I've seen code from NVIDIA that uses <code>NvEGLImageFromFd</code> and passes an eglDisplay from an X11 window. But I'm in GTK and I don t get why an egl display is important, first of all because I'm rendering to a frame buffer, but secondly because I render to GTK's framebuffer when I want to render images.</p>\n"}, {"tags": ["c", "fgets"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 3, "creation_date": 1568832658, "post_id": 57999139, "comment_id": 102404124, "body": "Please see <a href=\"http://stackoverflow.com/questions/5431941/why-is-while-feof-file-always-wrong\">Why is <code>while ( !feof (file) )</code> always wrong?</a> Use <code>while (fgets(line, 256, fp) != NULL)</code>. The function <a href=\"https://docs.microsoft.com/en-us/cpp/c-runtime-library/reference/feof?view=vs-2017\" rel=\"nofollow noreferrer\"><code>feof()</code></a> does not do what you ( and many others) imagine."}, {"owner": {"reputation": 65, "user_id": 4728218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bee9efe75d2b24c4110af4793d689be7?s=128&d=identicon&r=PG&f=1", "display_name": "omer muhit", "link": "https://stackoverflow.com/users/4728218/omer-muhit"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1568927780, "post_id": 57999139, "comment_id": 102441541, "body": "<a href=\"https://faq.cprogramming.com/cgi-bin/smartfaq.cgi?answer=1046476070&amp;id=1043284351\" rel=\"nofollow noreferrer\">faq.cprogramming.com/cgi-bin/&hellip;</a>       this is very useful for this topic"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1568928138, "post_id": 57999139, "comment_id": 102441619, "body": "So you probably know by now that the last line was not read twice. Without a <code>fseek</code> it can&#39;t be. The final read actually <b>failed</b> because there was no more to read, but the program is unaware of that because it does not test the return value from <code>fgets</code>. It then reports data that was still in the buffer after the previous, successful read. Now, <code>feof</code> picks up on the error you missed, and the loop terminates. <code>feof</code> returns <code>true</code> when <i>an attempt was made to read past the end of a file</i>. <b>Not</b> when you reach the end of file. This is a mistake that countless programmers have made."}], "owner": {"reputation": 65, "user_id": 4728218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bee9efe75d2b24c4110af4793d689be7?s=128&d=identicon&r=PG&f=1", "display_name": "omer muhit", "link": "https://stackoverflow.com/users/4728218/omer-muhit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "closed_date": 1568836716, "answer_count": 0, "score": 1, "last_activity_date": 1568832592, "creation_date": 1568832592, "question_id": 57999139, "link": "https://stackoverflow.com/questions/57999139/fgets-reads-the-last-line-twice", "closed_reason": "Duplicate", "title": "fgets reads the last line twice", "body": "<p>I am reading from a file in c and printing it to screen. I am using fgets function to read line by line and separating strings in the line. </p>\n\n<pre><code>    int i;\n    int j = 0;\n    int ctr = 0;\n    while (!feof(fp)){\n            fgets(line, 256, fp);\n            for(i=0;i&lt;=(strlen(line));i++){\n                    if(line[i]==' '|| line[i]=='\\0'){\n                            newString[ctr][j]='\\0';\n                            ctr++;  //for next word\n                            j=0;    //for next word, init index to 0\n                    }\n                    else{\n                            newString[ctr][j]=line[i];\n                            j++;\n                    }\n\n            }\n            //printf(\"the data line by line is: %s\\n\", line);\n\n    }\n\n    printf(\"\\n Strings or words after split by space are :\\n\");\n    for(i=0;i &lt; ctr;i++)\n    printf(\" %s\\n\",newString[i]);\n</code></pre>\n\n<p>Here is the content of the file that I am reading from:<br/>\n    3<br/>\n    9 3 34 4 12 5 2<br/>\n    6 3 2 7 1<br/>\n    256 3 5 7 8 9 1<br/></p>\n\n<p><br/>\n<br/>\nThis is my output: <br/>\n     Strings or words after split by space are :<br/>\n     3</p>\n\n<pre><code> 9\n 3\n 34\n 4\n 12\n 5\n 2\n\n 6\n 3\n 2\n 7\n 1\n\n 256\n 3\n 5\n 7\n 8\n 9\n 1\n\n 256\n 3\n 5\n 7\n 8\n 9\n 1\n</code></pre>\n\n<p>However it prints the last line twice, and I couldnt figure out why. Please tell me how to remove the extra one. \nThanks in advance...</p>\n"}, {"tags": ["c"], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 7990810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3937ac0dbcf708997d99eb8b7b165f8?s=128&d=identicon&r=PG&f=1", "display_name": "sandeep", "link": "https://stackoverflow.com/users/7990810/sandeep"}, "is_accepted": false, "score": 0, "last_activity_date": 1568832701, "creation_date": 1568832701, "answer_id": 57999166, "question_id": 57998996, "link": "https://stackoverflow.com/questions/57998996/failed-to-locate-system-libraries-for-ccs-operation-ibusb-0-1-so-4/57999166#57999166", "title": "failed to locate system libraries for CCS operation ibusb-0.1.so.4", "body": "<p>it was solved with the following installation\nsudo apt-get install libusb-0.1-4</p>\n"}], "owner": {"reputation": 11, "user_id": 7990810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3937ac0dbcf708997d99eb8b7b165f8?s=128&d=identicon&r=PG&f=1", "display_name": "sandeep", "link": "https://stackoverflow.com/users/7990810/sandeep"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 23, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1568832701, "creation_date": 1568831922, "question_id": 57998996, "link": "https://stackoverflow.com/questions/57998996/failed-to-locate-system-libraries-for-ccs-operation-ibusb-0-1-so-4", "title": "failed to locate system libraries for CCS operation ibusb-0.1.so.4", "body": "<p>i have installed libsub with sudo apt-get install libusb-0.1-0-dev\nbut i get this error while installing CCS\nfailed to locate system libraries for CCS operation ibusb-0.1.so.4</p>\n"}, {"tags": ["c++", "c"], "comments": [{"owner": {"reputation": 61304, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 3, "creation_date": 1568831909, "post_id": 57998948, "comment_id": 102403823, "body": "c or c++ ? They are not the same. If c++, then what standard? Tag the one you are using (or none if you use the current one)"}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 3, "creation_date": 1568831993, "post_id": 57998948, "comment_id": 102403867, "body": "Also, the sizes of your fields are wrong. First one: <code>uint8_t version:4;</code> Use bit fields."}, {"owner": {"reputation": 3771, "user_id": 5386374, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/fGuXb.png?s=128&g=1", "display_name": "Justin Time - Reinstate Monica", "link": "https://stackoverflow.com/users/5386374/justin-time-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1568832032, "post_id": 57998948, "comment_id": 102403875, "body": "Since you&#39;ve clarified that you know this is possible by reading raw bytes and casting to the correct types, have you tried anything else yet?"}, {"owner": {"reputation": 5092, "user_id": 5481471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf6efc50461d3521db348bf483652040?s=128&d=identicon&r=PG&f=1", "display_name": "G. Sliepen", "link": "https://stackoverflow.com/users/5481471/g-sliepen"}, "edited": false, "score": 1, "creation_date": 1568832268, "post_id": 57998948, "comment_id": 102403967, "body": "It would help if you made the struct in such a way that it is binary compatible with an actual IP header (minus the endianness). That way you can just read from the file straight into the memory belonging to <code>struct ip_header</code> variable. Have a look at <code>struct iphdr</code> in <code>&#47;usr&#47;include&#47;netinet&#47;ip.h</code>."}, {"owner": {"reputation": 81, "user_id": 10149041, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-NeoNsoNo5cQ/AAAAAAAAAAI/AAAAAAAAAEU/PBgUeX1WGuw/photo.jpg?sz=128", "display_name": "KAUSHAL KISHORE", "link": "https://stackoverflow.com/users/10149041/kaushal-kishore"}, "reply_to_user": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 0, "creation_date": 1568832641, "post_id": 57998948, "comment_id": 102404112, "body": "Thanks for the information @TedLyngmo."}, {"owner": {"reputation": 81, "user_id": 10149041, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-NeoNsoNo5cQ/AAAAAAAAAAI/AAAAAAAAAEU/PBgUeX1WGuw/photo.jpg?sz=128", "display_name": "KAUSHAL KISHORE", "link": "https://stackoverflow.com/users/10149041/kaushal-kishore"}, "reply_to_user": {"reputation": 5092, "user_id": 5481471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf6efc50461d3521db348bf483652040?s=128&d=identicon&r=PG&f=1", "display_name": "G. Sliepen", "link": "https://stackoverflow.com/users/5481471/g-sliepen"}, "edited": false, "score": 0, "creation_date": 1568832749, "post_id": 57998948, "comment_id": 102404157, "body": "Thanks @G.Sliepen, it was really helpful."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1568833277, "post_id": 57998948, "comment_id": 102404392, "body": "@KAUSHALKISHORE Usually you byte pack the struct (#pragma pack(1) or whatever your compiler uses) if you want the fields to match up with the data.  If you don&#39;t do that, there is a possibility of the fields not lining up with the data due to padding bytes placed in the struct."}, {"owner": {"reputation": 893, "user_id": 6277384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6172ff7a5d08eb58a7bbcc7dd99a08c?s=128&d=identicon&r=PG", "display_name": "yumetodo", "link": "https://stackoverflow.com/users/6277384/yumetodo"}, "edited": false, "score": 0, "creation_date": 1568834582, "post_id": 57998948, "comment_id": 102404925, "body": "Have you ever considered to use a boost.asio?"}], "answers": [{"comments": [{"owner": {"reputation": 893, "user_id": 6277384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6172ff7a5d08eb58a7bbcc7dd99a08c?s=128&d=identicon&r=PG", "display_name": "yumetodo", "link": "https://stackoverflow.com/users/6277384/yumetodo"}, "edited": false, "score": 1, "creation_date": 1568834533, "post_id": 57999285, "comment_id": 102404910, "body": "AFAIK, bit field has no effect to remove paddings."}, {"owner": {"reputation": 81, "user_id": 10149041, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-NeoNsoNo5cQ/AAAAAAAAAAI/AAAAAAAAAEU/PBgUeX1WGuw/photo.jpg?sz=128", "display_name": "KAUSHAL KISHORE", "link": "https://stackoverflow.com/users/10149041/kaushal-kishore"}, "edited": false, "score": 0, "creation_date": 1568873595, "post_id": 57999285, "comment_id": 102414328, "body": "Thanks for the ip header structure @Mirko. But the issue was not to read the file. My question was: Is there any way in which I can directly read the structure from the binary file, in which case I wouldn&#39;t have to explicitly assign all the fields in the ip header structure."}, {"owner": {"reputation": 963, "user_id": 7471267, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4GGWfiRBWAY/AAAAAAAAAAI/AAAAAAAAAFo/awzT9uvFc5E/photo.jpg?sz=128", "display_name": "Mirko", "link": "https://stackoverflow.com/users/7471267/mirko"}, "edited": false, "score": 1, "creation_date": 1568923692, "post_id": 57999285, "comment_id": 102440132, "body": "The way I presented it you read all the structure at once in one line of code. You&#39;re not reading and assigning explicitly: it&#39;s done for you programmatically by the compiler."}, {"owner": {"reputation": 963, "user_id": 7471267, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4GGWfiRBWAY/AAAAAAAAAAI/AAAAAAAAAFo/awzT9uvFc5E/photo.jpg?sz=128", "display_name": "Mirko", "link": "https://stackoverflow.com/users/7471267/mirko"}, "reply_to_user": {"reputation": 893, "user_id": 6277384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6172ff7a5d08eb58a7bbcc7dd99a08c?s=128&d=identicon&r=PG", "display_name": "yumetodo", "link": "https://stackoverflow.com/users/6277384/yumetodo"}, "edited": false, "score": 0, "creation_date": 1568923798, "post_id": 57999285, "comment_id": 102440170, "body": "@yumetodo I dont follow what you&#39;re saying. Who is talking about padding?"}, {"owner": {"reputation": 893, "user_id": 6277384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6172ff7a5d08eb58a7bbcc7dd99a08c?s=128&d=identicon&r=PG", "display_name": "yumetodo", "link": "https://stackoverflow.com/users/6277384/yumetodo"}, "edited": false, "score": 0, "creation_date": 1568967063, "post_id": 57999285, "comment_id": 102451233, "body": "I concern about binary capability problem."}], "tags": [], "owner": {"reputation": 963, "user_id": 7471267, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4GGWfiRBWAY/AAAAAAAAAAI/AAAAAAAAAFo/awzT9uvFc5E/photo.jpg?sz=128", "display_name": "Mirko", "link": "https://stackoverflow.com/users/7471267/mirko"}, "is_accepted": true, "score": 2, "last_activity_date": 1568833300, "creation_date": 1568833300, "answer_id": 57999285, "question_id": 57998948, "link": "https://stackoverflow.com/questions/57998948/what-is-the-best-way-to-read-a-structure-from-a-binary-file-containing-ip-header/57999285#57999285", "title": "What is the best way to read a structure from a binary file containing IP header fragments?", "body": "<p>Usual way is to use something like <code>fread</code></p>\n\n<pre><code>bool readIpHeader(ip&amp; buffer, const std::string&amp; filename)\n{\n    auto pFile= fopen(filename.data(), \"rb\");\n    if (!pFile) {\n        return false;\n    }\n    auto ok= fread(&amp;buffer, sizeof(buffer), 1, pFile) == 1;\n    fclose(pFile);\n    return ok;\n}\n</code></pre>\n\n<p>This will read <code>sizeof(buffer)</code> into address <code>&amp;buffer</code>: it will fill the buffer with the contents of the file; <code>fread</code> will return 1 on success.</p>\n\n<p>Like Ted pointed out, your structure is bad. You can take <a href=\"https://unix.superglobalmegacorp.com/Net2/newsrc/netinet/ip.h.html\" rel=\"nofollow noreferrer\">https://unix.superglobalmegacorp.com/Net2/newsrc/netinet/ip.h.html</a> as a source (most likely, you can <code>include</code> the file if you are on Linux):</p>\n\n<pre><code>struct ip {\n#if BYTE_ORDER == LITTLE_ENDIAN \n    u_char    ip_hl:4,           /* header length */\n              ip_v:4;            /* version */\n#endif\n#if BYTE_ORDER == BIG_ENDIAN \n    u_char    ip_v:4,            /* version */\n        ip_hl:4;        /* header length */\n#endif\n    u_char    ip_tos;            /* type of service */\n    short     ip_len;            /* total length */\n    u_short   ip_id;             /* identification */\n    short     ip_off;            /* fragment offset field */\n#define    IP_DF 0x4000          /* dont fragment flag */\n#define    IP_MF 0x2000          /* more fragments flag */\n    u_char    ip_ttl;            /* time to live */\n    u_char    ip_p;              /* protocol */\n    u_short   ip_sum;            /* checksum */\n    struct    in_addr ip_src,ip_dst;    /* source and dest address */\n};\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8402, "user_id": 4664415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hsfxj.jpg?s=128&g=1", "display_name": "mevets", "link": "https://stackoverflow.com/users/4664415/mevets"}, "is_accepted": false, "score": 0, "last_activity_date": 1568835649, "creation_date": 1568835649, "answer_id": 57999754, "question_id": 57998948, "link": "https://stackoverflow.com/questions/57998948/what-is-the-best-way-to-read-a-structure-from-a-binary-file-containing-ip-header/57999754#57999754", "title": "What is the best way to read a structure from a binary file containing IP header fragments?", "body": "<p>I think this:</p>\n\n<pre><code>    #include &lt;stdint.h&gt;\n    #include &lt;arpa/inet.h&gt;\n    #include &lt;netinet/ip.h&gt;\n    ....\n    #define IPSIZ  20\n    static void ntoip(uint8_t *buf, struct ip *i) {\n        i-&gt;ip_vhl = buf[0];\n        i-&gt;ip_tos = buf[1];\n        i-&gt;ip_len = ntohs(buf+2);\n        i-&gt;ip_id  = ntohs(buf+4);\n        i-&gt;ip_off = ntohs(buf+6);\n        i-&gt;ip_ttl = buf[8];\n        i-&gt;ip_p   = buf[9];\n        i-&gt;ip_sum = ntohs(buf+10);\n        i-&gt;ip_src = ntohl(buf+12);\n        i-&gt;ip_dst = ntohl(buf+16);           \n    }\n    int fget_ip(FILE *fp, struct ip *i) {\n        uint8_t buf[IPSIZ];\n        if (fread(buf, sizeof buf, 1, fp) == 1) {\n            ntoip(buf, i);\n            return 1;\n        }\n        return 0;\n    }\n...\n    void iptoh(struct ip *i, uint8_t *buf) {\n...\n    }\n    int fput_ip(struct ip *i, FILE *fp) {\n....\n    }\n</code></pre>\n\n<p>is your best bet.  Simple, clear, easy to understand, portable.  You can make sure it is always read and stored in network order, that way it works whether from a file or an actual device.</p>\n\n<p>If somehow it becomes a performance problem, it is encapsulated and you can replace it with the usual heap of shenanigans in one place.</p>\n"}, {"tags": [], "owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "is_accepted": false, "score": 2, "last_activity_date": 1568857417, "last_edit_date": 1568857417, "creation_date": 1568855777, "answer_id": 58002469, "question_id": 57998948, "link": "https://stackoverflow.com/questions/57998948/what-is-the-best-way-to-read-a-structure-from-a-binary-file-containing-ip-header/58002469#58002469", "title": "What is the best way to read a structure from a binary file containing IP header fragments?", "body": "<p>If you care about portability\u2014particularly with big-endian architectures that enforce natural alignment of 16-bit and 32-bit variables\u2014you can\u2019t just write the memory layout of your <code>struct</code> to disk.  The next release of the compiler might pack the data differently and break compatibility with all your data files.  And more than one big company has found out that they accidentally created two data formats, big-endian and little-endian, by compiling on another CPU and not normalizing.  Often, there wasn\u2019t any easy way to tell which one an old file was saved in.  Remember, data outlives code!</p>\n\n<p>This assumes that you want to use the <code>ip_header</code> structure within your program, it should be padded for efficient access, and that its purpose is not merely to shadow the file layout.</p>\n\n<p>When the fields have different sizes interspersed together, there\u2019s not a good way around setting them individually.  You cannot assume that the implementation can use an arbitrary, unaligned address as a pointer.  In this case, I also didn\u2019t assume that the file has the same endianness as your CPU; I defined the byte order as big-endian.  (If you expect this code to run on a little-endian CPU like the x86, you might define the order as little-endian, but still code defensively by using a library such as <a href=\"https://developer.gnome.org/glib/2.62/glib-Byte-Order-Macros.html\" rel=\"nofollow noreferrer\">glib</a> or the little-endian conversion functions of the OS.)</p>\n\n<p>You can portably convert from a layout on disk to a structure in memory like so:</p>\n\n<pre><code>#include &lt;arpa/inet.h&gt;\n#include &lt;stdbool.h&gt;\n#include &lt;stdint.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\ntypedef struct ip_header {\n    uint8_t version;\n    uint8_t header_length;\n    uint8_t service_type;\n    uint16_t total_length;\n    uint16_t identification;\n    uint8_t flags;\n    uint16_t fragment_offset;\n    uint8_t ttl;\n    uint8_t protocol;\n    uint16_t checksum;\n    uint32_t src;\n    uint32_t dest;\n    /* other fields for options if needed */\n} ip_header;\n\n#define IP_HEADER_DISK_LEN 22U\n\nbool read_ip_header( FILE* const input, ip_header* const d )\n{\n  char buffer[IP_HEADER_DISK_LEN];\n\n  if ( IP_HEADER_DISK_LEN !=\n       fread( buffer, 1, IP_HEADER_DISK_LEN, input ) ) {\n    return false;\n  }\n\n  memset( d, 0, sizeof(*d) );\n\n  memcpy( &amp;d-&gt;version,         &amp;buffer[0],  sizeof(d-&gt;version) );\n  memcpy( &amp;d-&gt;header_length,   &amp;buffer[1],  sizeof(d-&gt;header_length) );\n  memcpy( &amp;d-&gt;service_type,    &amp;buffer[2],  sizeof(d-&gt;service_type) );\n  memcpy( &amp;d-&gt;total_length,    &amp;buffer[3],  sizeof(d-&gt;total_length) );\n  d-&gt;total_length = ntohs(d-&gt;total_length);\n  memcpy( &amp;d-&gt;identification,  &amp;buffer[5],  sizeof(d-&gt;identification) );\n  d-&gt;identification = ntohs(d-&gt;identification);\n  memcpy( &amp;d-&gt;flags,           &amp;buffer[7],  sizeof(d-&gt;flags) );\n  memcpy( &amp;d-&gt;fragment_offset, &amp;buffer[8],  sizeof(d-&gt;fragment_offset) );\n  d-&gt;fragment_offset = ntohs(d-&gt;fragment_offset);\n  memcpy( &amp;d-&gt;ttl,             &amp;buffer[10], sizeof(d-&gt;ttl) );\n  memcpy( &amp;d-&gt;protocol,        &amp;buffer[11], sizeof(d-&gt;protocol) );\n  memcpy( &amp;d-&gt;checksum,        &amp;buffer[12], sizeof(d-&gt;checksum) );\n  d-&gt;checksum = ntohs(d-&gt;checksum);\n  memcpy( &amp;d-&gt;src,             &amp;buffer[14], sizeof(d-&gt;src) );\n  d-&gt;src = ntohl(d-&gt;src);\n  memcpy( &amp;d-&gt;dest,            &amp;buffer[18], sizeof(d-&gt;dest) );\n  d-&gt;dest = ntohl(d-&gt;dest);\n\n  return true;\n}\n</code></pre>\n\n<p>This does a single read of the entire header, but you might do separate I/O calls, or even map the file into memory.  Most modern compilers are smart enough to combine consecutive <code>memcpy()</code> calls to consecutive locations, to compile unneeded byte-swaps to no-ops, and to only <code>memset()</code> bytes that won\u2019t be overwritten immediately after, so, if you could get away with just copying the bytes, this way should be just as efficient.  (For your purposes, you could even skip zeroing-out the padding bytes and doing endian-conversion.)</p>\n\n<p>Remember, the read operation will take much, much longer than any of the bit-twiddling to deal with alignment endianness, or padding.  Trying to optimize those is not a good use of your time.  Especially if it compiles to an incompatible program on another compiler!</p>\n"}, {"tags": [], "owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "is_accepted": false, "score": 2, "last_activity_date": 1568913933, "creation_date": 1568913933, "answer_id": 58016160, "question_id": 57998948, "link": "https://stackoverflow.com/questions/57998948/what-is-the-best-way-to-read-a-structure-from-a-binary-file-containing-ip-header/58016160#58016160", "title": "What is the best way to read a structure from a binary file containing IP header fragments?", "body": "<p>If your IPv4 headers are stored in the same format as \"they came in\" (which is the usual way to store them) - with source and destination address being the last fields in the header, this should do it:</p>\n\n<pre><code>#include &lt;fstream&gt;\n#include &lt;iostream&gt;\n\n#include &lt;netinet/ip.h&gt; // a common place to find a \"iphdr\" definition\n\n// add a streaming operator for reading an iphdr\nstd::istream&amp; operator&gt;&gt;(std::istream&amp; is, iphdr&amp; ip) {\n    return is.read(reinterpret_cast&lt;char*&gt;(&amp;ip), sizeof(iphdr));\n}\n\n// add a streaming operator for writing an iphdr\nstd::ostream&amp; operator&lt;&lt;(std::ostream&amp; os, const iphdr&amp; ip) {\n    return os.write(reinterpret_cast&lt;const char*&gt;(&amp;ip), sizeof(iphdr));\n}\n\nint main() {\n    std::ifstream ips(\"ipheaders\");\n    if(ips) {\n        iphdr h;\n        while(ips &gt;&gt; h) {\n            std::cout &lt;&lt; h.version &lt;&lt; \"\\n\"\n                      &lt;&lt; h.ihl &lt;&lt; \"\\n\"\n                      &lt;&lt; h.tos &lt;&lt; \"\\n\"\n                      &lt;&lt; h.tot_len &lt;&lt; \"\\n\"\n                      &lt;&lt; h.id &lt;&lt; \"\\n\"\n                      &lt;&lt; h.frag_off &lt;&lt; \"\\n\"\n                      &lt;&lt; h.ttl &lt;&lt; \"\\n\"\n                      &lt;&lt; h.protocol &lt;&lt; \"\\n\"\n                      &lt;&lt; h.check &lt;&lt; \"\\n\"\n                      &lt;&lt; h.saddr &lt;&lt; \"\\n\"\n                      &lt;&lt; h.daddr &lt;&lt; \"\\n\";\n        }\n    }\n}\n\n</code></pre>\n\n<p>The first 4 bits in the physical header is always <code>version</code> but as @Mirco showed, the endianness of the computer you compile the program for matters when you fiddle with bit fields. The first 4 bits coming through the network and that are stored in the file are still <code>version</code> - and will be if you write your <code>iphdr</code> to disk using the added <code>operator&lt;&lt;</code> too. If you want to be portable, read and write the IP headers exactly as they have looked since IPv4 was invented. </p>\n\n<p>And luckily the layout of the ip header matches the alignment of the needed fundamental datatypes on the majority of systems. In case you find a system where it's not possible to create an IP header struct matching the raw data, you will most likely not find <code>netinet/ip.h</code> - but if you are still worried about it, you can add a compile time check:</p>\n\n<pre><code>    static_assert(alignof(uint8_t) == 1);\n    static_assert(alignof(uint16_t) == 2);\n    static_assert(alignof(uint32_t) == 4);\n</code></pre>\n"}], "owner": {"reputation": 81, "user_id": 10149041, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-NeoNsoNo5cQ/AAAAAAAAAAI/AAAAAAAAAEU/PBgUeX1WGuw/photo.jpg?sz=128", "display_name": "KAUSHAL KISHORE", "link": "https://stackoverflow.com/users/10149041/kaushal-kishore"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 377, "favorite_count": 1, "accepted_answer_id": 57999285, "answer_count": 4, "score": 1, "last_activity_date": 1568913933, "creation_date": 1568831664, "last_edit_date": 1568873361, "question_id": 57998948, "link": "https://stackoverflow.com/questions/57998948/what-is-the-best-way-to-read-a-structure-from-a-binary-file-containing-ip-header", "title": "What is the best way to read a structure from a binary file containing IP header fragments?", "body": "<p>During my computer networks lab, I had to read many binary files which contains the packet in IPv4 format. <a href=\"https://static.thegeekstuff.com/wp-content/uploads/2012/03/ip-header-2.png\" rel=\"nofollow noreferrer\">Here</a> is the IPv4 header file format.</p>\n\n<p>The following structure encapsulates all the essential part of the IP header. </p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>struct ip_header {\n    uint8_t version;\n    uint8_t header_length;\n    uint8_t service_type;\n    uint16_t total_length;\n    uint16_t identification;\n    uint8_t flags;\n    uint16_t fragment_offset;\n    uint8_t ttl;\n    uint8_t protocol;\n    uint16_t checksum;\n    uint32_t src;\n    uint32_t dest;\n    /* other fields for options if needed */\n};\n</code></pre>\n\n<p>One way to read the binary file to get the data in a structured format is to read the file bytes-by-bytes and then specifically typecast each byte field to respective fields for the above structure. Reading the file is not an issue.</p>\n\n<p>I want to know whether this is the only way to do it, or is there any other nice and magical way to achieve the same. Also, recently I got know that endianness also creates some problem while reading these kinds of files with different sized data types.</p>\n"}, {"tags": ["c", "flatbuffers"], "answers": [{"comments": [{"owner": {"reputation": 600, "user_id": 7176243, "user_type": "registered", "accept_rate": 20, "profile_image": "https://lh4.googleusercontent.com/-dLD6kFec4Bg/AAAAAAAAAAI/AAAAAAAAAJ0/CQ6lkIKBWPI/photo.jpg?sz=128", "display_name": "vk-code", "link": "https://stackoverflow.com/users/7176243/vk-code"}, "edited": false, "score": 0, "creation_date": 1568901944, "post_id": 58001552, "comment_id": 102429873, "body": "is it documented anywhere? if yes my apologies for not reading it properly. if not can we added it to documentation?"}, {"owner": {"reputation": 4578, "user_id": 17419, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JU9iE.jpg?s=128&g=1", "display_name": "Aardappel", "link": "https://stackoverflow.com/users/17419/aardappel"}, "reply_to_user": {"reputation": 600, "user_id": 7176243, "user_type": "registered", "accept_rate": 20, "profile_image": "https://lh4.googleusercontent.com/-dLD6kFec4Bg/AAAAAAAAAAI/AAAAAAAAAJ0/CQ6lkIKBWPI/photo.jpg?sz=128", "display_name": "vk-code", "link": "https://stackoverflow.com/users/7176243/vk-code"}, "edited": false, "score": 0, "creation_date": 1568917773, "post_id": 58001552, "comment_id": 102437689, "body": "Yes: <a href=\"https://google.github.io/flatbuffers/flatbuffers_guide_tutorial.html\" rel=\"nofollow noreferrer\">google.github.io/flatbuffers/flatbuffers_guide_tutorial.html</a>"}, {"owner": {"reputation": 600, "user_id": 7176243, "user_type": "registered", "accept_rate": 20, "profile_image": "https://lh4.googleusercontent.com/-dLD6kFec4Bg/AAAAAAAAAAI/AAAAAAAAAJ0/CQ6lkIKBWPI/photo.jpg?sz=128", "display_name": "vk-code", "link": "https://stackoverflow.com/users/7176243/vk-code"}, "edited": false, "score": 0, "creation_date": 1568922648, "post_id": 58001552, "comment_id": 102439721, "body": "I have created another table and union as a field and that solved my problem. At least didn&#39;t find any reference in the above link which explicitly says &#39;union fields cannot be used as root elements&#39;, i might be missing something. thanks for you comments though."}], "tags": [], "owner": {"reputation": 4578, "user_id": 17419, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JU9iE.jpg?s=128&g=1", "display_name": "Aardappel", "link": "https://stackoverflow.com/users/17419/aardappel"}, "is_accepted": false, "score": 1, "last_activity_date": 1568846177, "creation_date": 1568846177, "answer_id": 58001552, "question_id": 57998264, "link": "https://stackoverflow.com/questions/57998264/flatcc-union-as-top-element/58001552#58001552", "title": "flatcc union as top element", "body": "<p>You can't have a union as root of a buffer. Add a table that wraps it, then use the generated code to set both type and value.</p>\n"}], "owner": {"reputation": 600, "user_id": 7176243, "user_type": "registered", "accept_rate": 20, "profile_image": "https://lh4.googleusercontent.com/-dLD6kFec4Bg/AAAAAAAAAAI/AAAAAAAAAJ0/CQ6lkIKBWPI/photo.jpg?sz=128", "display_name": "vk-code", "link": "https://stackoverflow.com/users/7176243/vk-code"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1568846177, "creation_date": 1568828764, "question_id": 57998264, "link": "https://stackoverflow.com/questions/57998264/flatcc-union-as-top-element", "title": "flatcc union as top element", "body": "<p>i referred following link to understand how Union is encoded/ decoded in flatbuffers. </p>\n\n<p><a href=\"https://google.github.io/flatbuffers/flatbuffers_guide_tutorial.html\" rel=\"nofollow noreferrer\">https://google.github.io/flatbuffers/flatbuffers_guide_tutorial.html</a>\n<a href=\"https://github.com/dvidelabs/flatcc#unions\" rel=\"nofollow noreferrer\">https://github.com/dvidelabs/flatcc#unions</a></p>\n\n<p>i have defined my IDL as follows</p>\n\n<pre><code>table EthEndpoint\n{\n    // ethernet fields\n}\n\ntable WifiEndpoint\n{\n    // wifi fields\n}\n\nunion EndpointData\n{\n    EthEndpoint,\n    WifiEndpoint\n}\n\n\nflatcc_builder_t builder;\nflatcc_builder_init(&amp;builder);\n\nEthEndpoint_start(&amp;builder)\n// populate using EthEndpoint_*_add(&amp;builder, ...)\nEthEndpoint_ref_t eth_ep = EthEndpoint_end(&amp;builder);\n\nEndpointData_ref_t ep = EndpointData_as_EthEndpoint(eth_ep);\n\nhow to add ep to builder? There are no generated methods EndpointData_start/ EndpointData_end/ EndpointData_create.\n\nsize_t size;\nvoid *buf = flatcc_builder_get_direct_buffer(&amp;builder, &amp;size);\n\n// store the buffer to disk\nflatcc_builder_clear(&amp;builder);\n</code></pre>\n\n<p>how to add ep to builder? there is no EndpointData_start/ EndpointData_end/ EndpointData_create.</p>\n"}, {"tags": ["c", "winapi", "bitmap", "bmp", "hbitmap"], "comments": [{"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 1, "creation_date": 1568828234, "post_id": 57998060, "comment_id": 102402342, "body": "You are mixing file I/O APIs. You can&#39;t use <code>WriteFile()</code> with <code>fopen()</code>.  You need to either 1) change <code>WriteFile()</code> to <code>fwrite()</code>, or 2) change <code>fopen()</code> to <code>CreateFile()</code> (and <code>fclose()</code> to <code>CloseHandle()</code>).  Also, see <a href=\"https://docs.microsoft.com/en-us/windows/win32/gdi/bitmap-storage\" rel=\"nofollow noreferrer\">Bitmap Storage</a> on MSDN, which explains the <i>proper</i> format of a <code>.bmp</code> file."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1568828350, "post_id": 57998060, "comment_id": 102402380, "body": "also bmp file must begin with <code>BITMAPFILEHEADER</code>"}], "answers": [{"tags": [], "owner": {"reputation": 26606, "user_id": 4603670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7eabc1427aa3c8185153cc81978289a?s=128&d=identicon&r=PG&f=1", "display_name": "Barmak Shemirani", "link": "https://stackoverflow.com/users/4603670/barmak-shemirani"}, "is_accepted": true, "score": 0, "last_activity_date": 1568838987, "last_edit_date": 1568838987, "creation_date": 1568838247, "answer_id": 58000265, "question_id": 57998060, "link": "https://stackoverflow.com/questions/57998060/c-trouble-when-trying-to-comvert-hbitmap-into-bmp-file/58000265#58000265", "title": "C: Trouble when trying to comvert HBITMAP into .bmp file", "body": "<blockquote>\n<pre><code>bitmapInfo.bmiHeader.biSize = screenWidth * screenHeight * 3;\n</code></pre>\n</blockquote>\n\n<p><code>biSize</code> is not the total pixel count, it's the size of bitmap info structure, it's always <code>sizeof(BITMAPINFOHEADER)</code>.</p>\n\n<p>You want to set <code>bitmapInfo.bmiHeader.biSizeImage</code> instead. This value is roughly (<code>width * height * bits_per_pixel/8</code>) but it has to be adjusted because each row is padded. Also don't mix <code>fopen</code> handle with <code>CreateFile</code> handle as noted in comments.</p>\n\n<blockquote>\n<pre><code>fopen(\"screen.png\", \"wb\");\n</code></pre>\n</blockquote>\n\n<p>You cannot save to png format using this method. You need a different library like Gdiplus for png format.</p>\n\n<p>To save as bitmap, you have to setup <code>BITMAFILEHEADER</code>, <code>BITMAPINFOHEADER</code> and write them to file, and then write the bits obtained from <code>GetDIBits</code></p>\n\n<p>You may want to avoid using <code>typedef unsigned char u8;</code> etc. You can include <code>&lt;stdint.h&gt;</code> and use standard types <code>uint8_t</code>, <code>uint16_t</code>, <code>uint32_t</code>  etc. Or you can use standard Windows types like <code>BYTE</code></p>\n\n<pre><code>void getScreen()\n{\n    int screenWidth  = GetSystemMetrics(SM_CXVIRTUALSCREEN);\n    int screenHeight  = GetSystemMetrics(SM_CYVIRTUALSCREEN);\n\n    HDC hdc = GetDC(NULL);\n    HDC hDest = CreateCompatibleDC(hdc);\n    HBITMAP hbCapture = CreateCompatibleBitmap(hdc, screenWidth , screenHeight );\n    HBITMAP oldbmp = (HBITMAP)SelectObject(hDest, hbCapture);\n    BitBlt(hDest, 0, 0, screenWidth , screenHeight , hdc, 0, 0, SRCCOPY);\n\n    WORD bpp = 24; //&lt;- bits per pixel\n    int size = ((screenWidth  * bpp + 31) / 32) * 4 * screenHeight ;\n\n    BITMAPINFOHEADER bmp_info_hdr;\n    bmp_info_hdr.biSize = sizeof(bmp_info_hdr);\n    bmp_info_hdr.biHeight  = screenHeight ;\n    bmp_info_hdr.biWidth  = screenWidth ;\n    bmp_info_hdr.biPlanes = 1;\n    bmp_info_hdr.biBitCount = bpp;\n    bmp_info_hdr.biCompression = BI_RGB;\n    bmp_info_hdr.biSizeImage = size;\n\n    BITMAPFILEHEADER bmp_file_hdr;\n    bmp_file_hdr.bfType = (WORD)'MB';\n    bmp_file_hdr.bfOffBits = sizeof(bmp_file_hdr) + sizeof(bmp_info_hdr);\n    bmp_file_hdr.bfSize = bmp_file_hdr.bfOffBits + size;\n\n    char *buffer = malloc(size);\n    GetDIBits(hDest, hbCapture, 0, screenHeight , buffer, \n        (BITMAPINFO*)&amp;bmp_info_hdr, DIB_RGB_COLORS);\n\n    FILE * fPointer = fopen(\"screen.bmp\", \"wb\");\n    fwrite((char*)&amp;bmp_file_hdr, sizeof(bmp_file_hdr), 1, fPointer);\n    fwrite((char*)&amp;bmp_info_hdr, sizeof(bmp_info_hdr), 1, fPointer);\n    fwrite(buffer, size, 1, fPointer);\n    fclose(fPointer);\n\n    free(buffer);\n\n    SelectObject(hDest, oldbmp);\n    DeleteObject(hbCapture);\n    DeleteDC(hDest);\n    ReleaseDC(NULL, hdc);\n}\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 10836776, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ozs0w.jpg?s=128&g=1", "display_name": "HackSh00t", "link": "https://stackoverflow.com/users/10836776/hacksh00t"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 58000265, "answer_count": 1, "score": 0, "last_activity_date": 1568838987, "creation_date": 1568827933, "last_edit_date": 1568828174, "question_id": 57998060, "link": "https://stackoverflow.com/questions/57998060/c-trouble-when-trying-to-comvert-hbitmap-into-bmp-file", "title": "C: Trouble when trying to comvert HBITMAP into .bmp file", "body": "<p>I am creating a function to save a screenshot into a <code>.bmp</code> file, I've managed to save the screen into an <code>HBITMAP</code> but I'm having trouble when saving it. I would appreciate some help.</p>\n\n<p>Here is the header with the function:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;windows.h&gt;\n#include &lt;stdbool.h&gt;\n#include &lt;wingdi.h&gt;\n#include &lt;winuser.h&gt;\n\ntypedef unsigned char u8;\ntypedef unsigned short u16;\ntypedef unsigned long u32;\ntypedef unsigned long long u64;\n\nvoid getScreen()\n{\n    u16 screenHeight = GetSystemMetrics(SM_CYVIRTUALSCREEN);\n    u16 screenWidth = GetSystemMetrics(SM_CXVIRTUALSCREEN);\n\n    HDC hdc = GetDC(NULL); //get a desktop dc (NULL for entire screen)\n    HDC hDest = CreateCompatibleDC(hdc); //create a dc for capture\n\n    ReleaseDC(NULL, hdc);\n\n    HBITMAP hbCapture = CreateCompatibleBitmap(hdc, screenWidth, screenHeight);\n    SelectObject(hDest, hbCapture);\n\n    //Copy screen to bitmap\n    BitBlt(hDest, 0, 0, screenWidth, screenHeight, hdc, 0, 0, SRCCOPY);\n\n//test\n    ReleaseDC(NULL, hdc);\n\n    char memBuffer[10000];\n    BITMAPINFO bitmapInfo;\n    bitmapInfo.bmiHeader.biHeight = screenHeight;\n    bitmapInfo.bmiHeader.biWidth = screenWidth;\n    bitmapInfo.bmiHeader.biSize = screenWidth * screenHeight * 3;\n    bitmapInfo.bmiHeader.biCompression = BI_RGB;//NOT SURE\n    bitmapInfo.bmiHeader.biPlanes = 1;\n    bitmapInfo.bmiHeader.biBitCount = 8; //NOT SURE\n    bitmapInfo.bmiHeader.biClrImportant = 0;\n    GetDIBits(hDest, hbCapture, 0, screenHeight, &amp;memBuffer, &amp;bitmapInfo, DIB_RGB_COLORS);\n\n    FILE * fPointer = fopen(\"screen.png\", \"wb\");//TO CHANGE\n    WriteFile(fPointer, &amp;memBuffer, (WORD) sizeof(memBuffer), 0, NULL);\n\n    fclose(fPointer);\n//test\n\n    //Clean up\n    ReleaseDC(NULL, hdc);\n    DeleteDC(hDest);\n    DeleteObject(hbCapture);\n}\n</code></pre>\n\n<p>And here is also the main.c:</p>\n\n<pre><code>#include \"main.h\"\n\nint main()\n{\n    getScreen();\n\n    return 0;\n}\n\n</code></pre>\n\n<p>I've already read all the questions about this topic in StackOverflow and none of them has clarified the issue for me.</p>\n"}, {"tags": ["c", "linux", "sockets", "shared-memory"], "comments": [{"owner": {"reputation": 13191, "user_id": 4990642, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/xY0PD.jpg?s=128&g=1", "display_name": "snr", "link": "https://stackoverflow.com/users/4990642/snr"}, "edited": false, "score": 2, "creation_date": 1568826268, "post_id": 57997520, "comment_id": 102401605, "body": "you need to share the other side&#39;s code as well. I don&#39;t think there is an odd thing."}, {"owner": {"reputation": 15260, "user_id": 1968182, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/E5nF2.jpg?s=128&g=1", "display_name": "Ulrich Eckhardt", "link": "https://stackoverflow.com/users/1968182/ulrich-eckhardt"}, "edited": false, "score": 1, "creation_date": 1568830739, "post_id": 57997520, "comment_id": 102403346, "body": "Your question lacks a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> and the backtrace at the point of the segfault. In particular, first remove all the socket code from your example so that you can really assert the shared memory is the problem."}, {"owner": {"reputation": 157, "user_id": 7964242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb2a604512bc0db95c86c59caf138cb2?s=128&d=identicon&r=PG&f=1", "display_name": "jipthechip", "link": "https://stackoverflow.com/users/7964242/jipthechip"}, "edited": false, "score": 0, "creation_date": 1568831337, "post_id": 57997520, "comment_id": 102403586, "body": "Thank you Ulrich, I did as you said and I can confirm that the segfault is caused by the shared memory code."}, {"owner": {"reputation": 13191, "user_id": 4990642, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/xY0PD.jpg?s=128&g=1", "display_name": "snr", "link": "https://stackoverflow.com/users/4990642/snr"}, "edited": false, "score": 1, "creation_date": 1568831562, "post_id": 57997520, "comment_id": 102403677, "body": "@jipthechip Put also simplified code which is discussed in <i>EDIT 2</i> in addition to other 2 codes."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1568831641, "post_id": 57997520, "comment_id": 102403708, "body": "<code>while (strcmp(data, &quot;#EXIT&quot;) != 0)</code> invokes undefined behavior the first loop iteration since <code>data</code> is not initialized."}, {"owner": {"reputation": 2445, "user_id": 1707353, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/212f7b84a07bc7aea4f574669fe2465f?s=128&d=identicon&r=PG&f=1", "display_name": "Jeff Holt", "link": "https://stackoverflow.com/users/1707353/jeff-holt"}, "edited": false, "score": 1, "creation_date": 1568832008, "post_id": 57997520, "comment_id": 102403870, "body": "Have you executed the code via valgrind?"}, {"owner": {"reputation": 13191, "user_id": 4990642, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/xY0PD.jpg?s=128&g=1", "display_name": "snr", "link": "https://stackoverflow.com/users/4990642/snr"}, "reply_to_user": {"reputation": 2445, "user_id": 1707353, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/212f7b84a07bc7aea4f574669fe2465f?s=128&d=identicon&r=PG&f=1", "display_name": "Jeff Holt", "link": "https://stackoverflow.com/users/1707353/jeff-holt"}, "edited": false, "score": 0, "creation_date": 1568835081, "post_id": 57997520, "comment_id": 102405118, "body": "@JeffHolt his valgrind answer says what I say already Invalid write (: but it doesn&#39;t say what part or why it arises unlike mine."}, {"owner": {"reputation": 2445, "user_id": 1707353, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/212f7b84a07bc7aea4f574669fe2465f?s=128&d=identicon&r=PG&f=1", "display_name": "Jeff Holt", "link": "https://stackoverflow.com/users/1707353/jeff-holt"}, "edited": false, "score": 0, "creation_date": 1568847226, "post_id": 57997520, "comment_id": 102408969, "body": "If you compile with -g, then it will say where in the source the invalid write is happening."}], "answers": [{"comments": [{"owner": {"reputation": 157, "user_id": 7964242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb2a604512bc0db95c86c59caf138cb2?s=128&d=identicon&r=PG&f=1", "display_name": "jipthechip", "link": "https://stackoverflow.com/users/7964242/jipthechip"}, "edited": false, "score": 0, "creation_date": 1568830239, "post_id": 57998187, "comment_id": 102403130, "body": "I got rid of them but it still didn&#39;t fix the issue."}, {"owner": {"reputation": 13191, "user_id": 4990642, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/xY0PD.jpg?s=128&g=1", "display_name": "snr", "link": "https://stackoverflow.com/users/4990642/snr"}, "reply_to_user": {"reputation": 157, "user_id": 7964242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb2a604512bc0db95c86c59caf138cb2?s=128&d=identicon&r=PG&f=1", "display_name": "jipthechip", "link": "https://stackoverflow.com/users/7964242/jipthechip"}, "edited": false, "score": 0, "creation_date": 1568833258, "post_id": 57998187, "comment_id": 102404382, "body": "@jipthechip Did you look at the below part of the answer?"}, {"owner": {"reputation": 157, "user_id": 7964242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb2a604512bc0db95c86c59caf138cb2?s=128&d=identicon&r=PG&f=1", "display_name": "jipthechip", "link": "https://stackoverflow.com/users/7964242/jipthechip"}, "edited": false, "score": 0, "creation_date": 1568838747, "post_id": 57998187, "comment_id": 102406516, "body": "Ah, I see what the issue was now. What happened was I mapped the memory location and didn&#39;t call <code>unlink</code> the first time so when I went to map it on the second execution it seg faulted. But this means that if the client process unexpectedly terminates, this will happen again. How would I check if the location is mapped and then unlink it if it is?"}, {"owner": {"reputation": 13191, "user_id": 4990642, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/xY0PD.jpg?s=128&g=1", "display_name": "snr", "link": "https://stackoverflow.com/users/4990642/snr"}, "reply_to_user": {"reputation": 157, "user_id": 7964242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb2a604512bc0db95c86c59caf138cb2?s=128&d=identicon&r=PG&f=1", "display_name": "jipthechip", "link": "https://stackoverflow.com/users/7964242/jipthechip"}, "edited": false, "score": 0, "creation_date": 1568843565, "post_id": 57998187, "comment_id": 102408075, "body": "@jipthechip When a TCP connection is closed on one side <code>read()</code> on the other side returns <code>0</code> byte. Besides, you know on the both side name of the shared memory."}], "tags": [], "owner": {"reputation": 13191, "user_id": 4990642, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/xY0PD.jpg?s=128&g=1", "display_name": "snr", "link": "https://stackoverflow.com/users/4990642/snr"}, "is_accepted": true, "score": 1, "last_activity_date": 1568833830, "last_edit_date": 1568833830, "creation_date": 1568828521, "answer_id": 57998187, "question_id": 57997520, "link": "https://stackoverflow.com/questions/57997520/usage-of-shared-memory-between-2-processes-in-c-socket-client-program-leads-to-s/57998187#57998187", "title": "Usage of shared memory between 2 processes in c socket client program leads to segmentation fault", "body": "<p>Your <em>segmentation fault</em> error could stem from <code>free(s)</code>s in both <code>add_user(...)</code> and <code>connect_user(...)</code> functions since <code>char s[...]</code> is variable sized arrays on the stack, not allotted to the heap to be <code>free</code>d. You need to get rid of them.</p>\n\n<p>In the server and client sides, you don't wait your child process by using <code>wait(..)</code> or <code>waitpid(..)</code></p>\n\n<p>In addition, it is better to initialize arrays with <code>0</code>s e.g. <code>char arr[SIZE] = {0}</code>, for variable-sized arrays too.</p>\n\n<p>AFAI know also, <code>bzero</code> is deprecated and reduces portability. So you should use <code>memset(..)</code> instead.</p>\n\n<p><code>n = write(newsockfd, \"See you soon!\", 18);</code> at line 128 what about remaining <code>5</code> characters(bytes)? Garbage writings?</p>\n\n<p>Better for you to use <code>-Weverything</code> flag tas well.</p>\n\n<hr>\n\n<h2>Let's focus on the following point,</h2>\n\n<p><strong><code>shared_memory[0] = 0;</code> ?</strong></p>\n\n<p>What if <code>shm_open(..)</code> returns <code>-1</code>? In this case, are you sure <code>shared_memory</code> points to a legal place in which you are able to write? You should <strong>always pay special attention to return values and their results.</strong></p>\n\n<pre><code>int shm_fd = shm_open(\"Transmitting\", O_CREAT | O_EXCL | O_RDWR, S_IRWXU | S_IRWXG);\n    if (shm_fd == -1) {\n        perror(\"shm_fd error\");\n        exit(-1);\n    }\n</code></pre>\n\n<p>In my computer, it yields that <code>shm_fd error: File exists</code> after one-time running inherently.</p>\n\n<p>AFAI remember, non-anonymous shared mapping object stays in the computer unless it is removed by hand or by <code>unlink(..)</code> or <code>remove(..)</code></p>\n\n<p>Or, just remove <code>O_EXCL</code> flag.</p>\n"}], "owner": {"reputation": 157, "user_id": 7964242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb2a604512bc0db95c86c59caf138cb2?s=128&d=identicon&r=PG&f=1", "display_name": "jipthechip", "link": "https://stackoverflow.com/users/7964242/jipthechip"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 467, "favorite_count": 1, "accepted_answer_id": 57998187, "answer_count": 1, "score": -2, "last_activity_date": 1568833830, "creation_date": 1568825614, "last_edit_date": 1568833493, "question_id": 57997520, "link": "https://stackoverflow.com/questions/57997520/usage-of-shared-memory-between-2-processes-in-c-socket-client-program-leads-to-s", "title": "Usage of shared memory between 2 processes in c socket client program leads to segmentation fault", "body": "<p>I'm creating a client program that has 2 processes: a parent process that transmits data to the server periodically to let it know the client is still connected, and a child process that receives user input and sends it to the server, and if that input happens to be \"#EXIT\" then the child process will let the parent process know that the program needs to terminate via a variable in shared memory, and then exit. The problem is that I'm getting a segmentation fault before the program even prints anything.</p>\n\n<p>The strange thing is that the first time I ran it, it gave the expected output and terminated when I typed \"#EXIT\", but all subsequent times I ran it, it just immediately seg faulted. At first I thought it was because I didn't call <code>shm_unlink</code> at the end, but I added that and the result was the same. I then thought it was because I didn't call <code>exit</code> on the child process, but I added that and again the result was the same.</p>\n\n<p>Client code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;arpa/inet.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdbool.h&gt;\n#include &lt;sys/mman.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;sys/stat.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main(int argc, char const *argv[])\n{\n    if (argc-1 != 2){\n        perror(\"Usage: ./351ChatClient [address] [port]\");\n        return -1;\n    }\n\n    int sock = 0, valread;\n    struct sockaddr_in serv_addr;\n    char buffer[1024] = {0};\n\n    if ((sock = socket(AF_INET, SOCK_STREAM, 0)) &lt; 0)\n    {\n        printf(\"\\n Socket creation error \\n\");\n        return -1;\n    }\n\n    serv_addr.sin_family = AF_INET;\n    serv_addr.sin_port = htons(atoi(argv[2]));\n\n    // Convert IPv4 and IPv6 addresses from text to binary form \n    if(inet_pton(AF_INET, argv[1], &amp;serv_addr.sin_addr)&lt;=0)\n    {\n        printf(\"\\nInvalid address/ Address not supported \\n\");\n        return -1;\n    }\n\n    if (connect(sock, (struct sockaddr *)&amp;serv_addr, sizeof(serv_addr)) &lt; 0)\n    {\n        printf(\"\\nConnection Failed \\n\");\n        return -1;\n    }\n\n    int* shared_memory;\n\n    int shm_fd = shm_open(\"Transmitting\", O_CREAT | O_EXCL | O_RDWR, S_IRWXU | S_IRWXG);\n\n    ftruncate(shm_fd, sizeof(int));\n\n    shared_memory = (int *) mmap(NULL, sizeof(int), PROT_READ | PROT_WRITE, MAP_SHARED, shm_fd, 0);\n\n    shared_memory[0] = 0;\n\n    int pid = fork();\n\n    if (pid == 0){\n        char data[256];\n        while (strcmp(data, \"#EXIT\") != 0){\n            fgets(data, sizeof(data), stdin);\n            data[strlen(data)-1] = '\\0';\n            send(sock , data, strlen(data) , 0 );\n            valread = read( sock , buffer, 1024);\n            printf(\"%s\\n\",buffer );\n        }\n        shared_memory[0] = 1;\n        exit(EXIT_SUCCESS);\n     }\n    else if (pid &gt; 0){\n        while(shared_memory[0] == 0){\n            // transmit data every couple seconds to let server know client is still connected\n        }\n        shm_unlink(\"Transmitting\");\n        printf(\"Stopped transmitting\\n\");\n    }\n    return 0;\n}\n</code></pre>\n\n<p>Server code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;sys/socket.h&gt; //For Sockets\n#include &lt;stdlib.h&gt;\n#include &lt;netinet/in.h&gt; //For the AF_INET (Address Family)\n#include &lt;string.h&gt;\n#include &lt;stdbool.h&gt;\n#include &lt;unistd.h&gt;\n\n#define MAXSIZE 256\n\nvoid add_user(char name[], char password[]){\n    if (strlen(name) &gt; MAXSIZE || strlen(password) &gt; MAXSIZE){\n        // send error message to client\n        return;\n    }\n\n    FILE* fp = fopen(\"users.txt\", \"a\");\n    char s[strlen(name)+strlen(password)+2];\n    strcpy(s, name);\n    strcat(s, \"\\n\");\n    strcat(s, password);\n    strcat(s, \"\\n\");\n    fputs(s, fp);\n    fclose(fp);\n}\n\nvoid connect_user(char name[], char password[]){\n\n    FILE* fp = fopen(\"users.txt\", \"r\");\n\n    char line[MAXSIZE];\n    char cur_name[MAXSIZE];\n\n    bool match = false;\n\n    int line_no = 1;\n    while (fgets(line, sizeof(line), fp)){\n\n        line[strlen(line)-1] = '\\0'; // remove trailing newline\n\n        if (line_no % 2 != 0){\n\n            strcpy(cur_name, line);\n\n            if (strcmp(cur_name, name) == 0){\n                match = true;\n            }\n\n        }\n        else if(match){\n\n            if (strcmp(line, password) == 0){\n                char s[strlen(cur_name)+strlen(\" is entering the queue\\n\")];\n                strcpy(s, cur_name);\n                strcat(s, \" is entering the queue\\n\");\n                printf(\"%s\", s);\n                // add user to the queue\n                return;\n            }\n            else{\n                // send invalid password message to client\n                return;\n            }\n        }\n        line_no = line_no + 1;\n    }\n    add_user(name, password); // if user not found, add it to the DB \n}\n\nint main(int argc, char *argv[]){\n    FILE* fp = fopen(\"users.txt\", \"a\"); // creates users file if it does not exist\n    fclose(fp);\n\n    int sockfd, newsockfd, portno;\n    socklen_t clilen;\n    char buffer[256];\n    struct sockaddr_in serv_addr, cli_addr;\n    int n;\n    if (argc &lt; 2) {\n         fprintf(stderr, \"ERROR, no port provided\\n\");\n         exit(1);\n    }\n    sockfd = socket(AF_INET, SOCK_STREAM, 0);\n    if (sockfd &lt; 0)\n         perror(\"ERROR opening socket\");\n    bzero((char *) &amp;serv_addr, sizeof(serv_addr));\n    portno = atoi(argv[1]);\n    serv_addr.sin_family = AF_INET;\n    serv_addr.sin_addr.s_addr = INADDR_ANY;\n    serv_addr.sin_port = htons(portno);\n    if (bind(sockfd, (struct sockaddr *) &amp;serv_addr, sizeof(serv_addr)) &lt; 0)\n        perror(\"ERROR on binding\");\n    listen(sockfd, 5);\n\n    clilen = sizeof(cli_addr);\n    //Below code is modified to handle multiple clients using fork\n    //------------------------------------------------------------------\n    int pid;\n    while (1) {\n         newsockfd = accept(sockfd, (struct sockaddr *) &amp;cli_addr, &amp;clilen);\n         if (newsockfd &lt; 0)\n              perror(\"ERROR on accept\");\n         //fork new process\n         pid = fork();\n         if (pid &lt; 0) {\n              perror(\"ERROR in new process creation\");\n         }\n         if (pid == 0) {\n            //child process\n            close(sockfd);\n            //do whatever you want\n            bzero(buffer, 256);\n            while(strcmp(buffer, \"#EXIT\") != 0){\n\n                memset(buffer, 0, sizeof(buffer)); // clear the read buffer\n\n                n = read(newsockfd, buffer, 255);\n                if (n &lt; 0)\n                    perror(\"ERROR reading from socket\");\n                printf(\"Here is the message: %s\\n\", buffer);\n\n                n = write(newsockfd, \"I got your message\", 18);\n                if (n &lt; 0)\n                    perror(\"ERROR writing to socket\");\n            }\n            n = write(newsockfd, \"See you soon!\", 18);\n            if (n &lt; 0)\n                perror(\"ERROR writing to socket\");\n            printf(\"Closing connection with client\");\n            close(newsockfd);\n            exit(EXIT_SUCCESS);\n          } else {\n             //parent process\n             close(newsockfd);\n          }\n    }\n    //-------------------------------------------------------------------\n   return 0;\n}\n</code></pre>\n\n<p>The output I expect to receive when I type \"#EXIT\" is</p>\n\n<pre><code>#EXIT\nStopped transmitting\n</code></pre>\n\n<p>But the output I receive is simply</p>\n\n<pre><code>segmentation fault (core dumped)\n</code></pre>\n\n<p>Before I get the chance to type anything.</p>\n\n<p>I'm new to c sockets and c in general, so please don't hesitate to point out if I'm doing anything else completely wrong. Thank you.</p>\n\n<p>EDIT: Another thing I noticed is that when the client segfaults, the server receives a significant number of messages. Not sure why though.</p>\n\n<p>EDIT 2: I commented out all the socket code in my client, recompiled it, and executed it, and the segmentation fault still happened.</p>\n\n<p>EDIT 3: I fixed the while loop checking <code>data</code> before it is defined, but the issue still persists.</p>\n\n<p>Here is the simplified client code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;arpa/inet.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdbool.h&gt;\n#include &lt;sys/mman.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;sys/stat.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main(int argc, char const *argv[])\n{\n    if (argc-1 != 2){\n        perror(\"Usage: ./351ChatClient [address] [port]\");\n        return -1;\n    }\n\n    int* shared_memory;\n\n    int shm_fd = shm_open(\"Transmitting\", O_CREAT | O_EXCL | O_RDWR, S_IRWXU | S_IRWXG);\n\n    ftruncate(shm_fd, sizeof(int));\n\n    shared_memory = (int *) mmap(NULL, sizeof(int), PROT_READ | PROT_WRITE, MAP_SHARED, shm_fd, 0);\n\n    shared_memory[0] = 0;\n\n    int pid = fork();\n\n    if (pid == 0){\n        char data[256];\n        while (true){\n            fgets(data, sizeof(data), stdin);\n            data[strlen(data)-1] = '\\0';\n            if(strcmp(data, \"#EXIT\") != 0)\n                break;  \n        }\n        shared_memory[0] = 1;\n        exit(EXIT_SUCCESS);\n     }\n    else if (pid &gt; 0){\n        while(shared_memory[0] == 0){\n            // transmit data every couple seconds to let server know client is still connected\n        }\n        shm_unlink(\"Transmitting\");\n        printf(\"Stopped transmitting\\n\");\n    }\n    return 0;\n}\n</code></pre>\n\n<p>EDIT 4: I ran the client through valgrind using the command <code>valgrind --leak-check=full --track-origins=yes ./351ChatClient 127.0.0.1 8080</code> and this is what I got:</p>\n\n<pre><code>==11098== Memcheck, a memory error detector\n==11098== Copyright (C) 2002-2017, and GNU GPL'd, by Julian Seward et al.\n==11098== Using Valgrind-3.13.0 and LibVEX; rerun with -h for copyright info\n==11098== Command: ./351ChatClient 127.0.0.1 8080\n==11098== \n==11098== Invalid write of size 4\n==11098==    at 0x108AA4: main (in /home/jp/Courses/csci351/projects/project1/351ChatClient)\n==11098==  Address 0xffffffffffffffff is not stack'd, malloc'd or (recently) free'd\n==11098== \n==11098== \n==11098== Process terminating with default action of signal 11 (SIGSEGV)\n==11098==  Access not within mapped region at address 0xFFFFFFFFFFFFFFFF\n==11098==    at 0x108AA4: main (in /home/jp/Courses/csci351/projects/project1/351ChatClient)\n==11098==  If you believe this happened as a result of a stack\n==11098==  overflow in your program's main thread (unlikely but\n==11098==  possible), you can try to increase the size of the\n==11098==  main thread stack using the --main-stacksize= flag.\n==11098==  The main thread stack size used in this run was 8388608.\n==11098== \n==11098== HEAP SUMMARY:\n==11098==     in use at exit: 0 bytes in 0 blocks\n==11098==   total heap usage: 0 allocs, 0 frees, 0 bytes allocated\n==11098== \n==11098== All heap blocks were freed -- no leaks are possible\n==11098== \n==11098== For counts of detected and suppressed errors, rerun with: -v\n==11098== ERROR SUMMARY: 1 errors from 1 contexts (suppressed: 0 from 0)\nSegmentation fault (core dumped)\n</code></pre>\n"}, {"tags": ["c", "arrays", "pointers"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1568825818, "post_id": 57997498, "comment_id": 102401449, "body": "When you add one to pointer, it is incremented by the size of the object pointed at.  It&#39;s one of the reasons you need to get the pointer type right.  It&#39;s easier to read and write <code>b[i] = a[i];</code> \u2014 if you don&#39;t use <code>memmove()</code> or <code>memcpy()</code>."}], "answers": [{"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": true, "score": 1, "last_activity_date": 1568826587, "last_edit_date": 1568826587, "creation_date": 1568825695, "answer_id": 57997544, "question_id": 57997498, "link": "https://stackoverflow.com/questions/57997498/copying-array-using-pointers/57997544#57997544", "title": "Copying Array Using Pointers", "body": "<p>Here you are</p>\n\n<pre><code>int * arrCopy( const int *a, size_t n )\n{\n    int *b = malloc( n * sizeof( int ) );\n\n    for ( size_t i = 0; i &lt; n; i++ )\n    {\n        *( b + i ) = *( a + i );\n    }\n\n    return b;\n}\n</code></pre>\n\n<p>Or you could check whether the memory was successfully allocated.</p>\n\n<pre><code>int * arrCopy( const int *a, size_t n )\n{\n    int *b = malloc( n * sizeof( int ) );\n\n    if ( b != NULL )\n    {\n        for ( size_t i = 0; i &lt; n; i++ )\n        {\n            *( b + i ) = *( a + i );\n        }\n    }\n\n    return b;\n}\n</code></pre>\n\n<p>Here is a demonstrative program</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint * arrCopy( const int *a, size_t n )\n{\n    int *b = malloc( n * sizeof( int ) );\n\n    if ( b != NULL )\n    {\n        for ( size_t i = 0; i &lt; n; i++ )\n        {\n            *( b + i ) = *( a + i );\n        }\n    }           \n\n    return b;\n}\n\nint main(void) \n{\n    int a[] = { 0, 1, 2, 3, 4, 5, 6, 7, 8, 9 };\n    const size_t N = sizeof( a ) / sizeof( *a );\n\n    int *b = arrCopy( a, N );\n\n    if ( b != NULL )\n    {\n        for ( size_t i = 0; i &lt; N; i++ )\n        {\n            printf( \"%d \", b[i] );\n        }\n\n        putchar( '\\n' );\n    }\n\n    free( b );\n\n    return 0;\n}\n</code></pre>\n\n<p>Its output is</p>\n\n<pre><code>0 1 2 3 4 5 6 7 8 9\n</code></pre>\n\n<p>As for your code then for example this expression</p>\n\n<pre><code>*(b+(sizeof(int)*i))\n</code></pre>\n\n<p>is invalid. It selects the element of the array b equivalent to</p>\n\n<pre><code>b[sizeof(int)*i]\n</code></pre>\n\n<p>So for example when <code>i</code> is equal to <code>1</code> and <code>sizeof( int )</code> equal to <code>4</code> then instead of getting the element <code>b[1]</code> you are getting the element <code>b[4]</code>.</p>\n\n<p>From the C Standard (6.5.2.1 Array subscripting)</p>\n\n<blockquote>\n  <p>2 A postfix expression followed by an expression in square brackets []\n  is a subscripted designation of an element of an array object. <strong>The\n  definition of the subscript operator [] is that E1[E2] is identical to\n  (*((E1)+(E2))).</strong> Because of the conversion rules that apply to the\n  binary + operator, if E1 is an array object (equivalently, a pointer\n  to the initial element of an array object) and E2 is an integer,\n  E1[E2] designates the E2-th element of E1 (counting from zero).</p>\n</blockquote>\n"}], "owner": {"reputation": 19, "user_id": 12086335, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-y3YooHxvz50/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcxdye95pGIBWaeTasZ9zlA4B32tA/photo.jpg?sz=128", "display_name": "Austin Near", "link": "https://stackoverflow.com/users/12086335/austin-near"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 245, "favorite_count": 0, "accepted_answer_id": 57997544, "answer_count": 1, "score": 1, "last_activity_date": 1618836996, "creation_date": 1568825513, "question_id": 57997498, "link": "https://stackoverflow.com/questions/57997498/copying-array-using-pointers", "title": "Copying Array Using Pointers", "body": "<p>I am trying to create a copy of an array by only accessing an array using pointer arithmetic. This is my function</p>\n\n<pre><code> int* arrCopy(int *a, int size){\n    int *b = (int*)malloc(size*sizeof(int));\n    for(int i = 0; i &lt; size; i++){\n        *(b+(sizeof(int)*i)) = *(a+(sizeof(int)*i));\n    }\n    return b;\n}\n</code></pre>\n\n<p>When I print the array it shows that the copied array is filled with the repeating of the first two values in the original array. So if the original array was [1, 2, 3, 4, 5], then arrcopy would be [1, 2, 1 ,2 ,1] and I can't figure out why.</p>\n"}, {"tags": ["c", "loops"], "comments": [{"owner": {"reputation": 3545, "user_id": 2183547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9dd540edd4677da5281d4331bf835f51?s=128&d=identicon&r=PG", "display_name": "L. Scott Johnson", "link": "https://stackoverflow.com/users/2183547/l-scott-johnson"}, "edited": false, "score": 3, "creation_date": 1568824461, "post_id": 57997185, "comment_id": 102400915, "body": "It &quot;walks&quot; up the sequence with fibNum being F(n) oneBack being the F(n-1), and twoBack being F(n-2). After each number, the oneBack becomes twoBack, then fibNum becomes oneBack and a new fibNum is computed."}, {"owner": {"reputation": 2385, "user_id": 1009270, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/33fcdc9c0604cf69abb15e17840d2a3c?s=128&d=identicon&r=PG", "display_name": "john elemans", "link": "https://stackoverflow.com/users/1009270/john-elemans"}, "edited": false, "score": 0, "creation_date": 1568824723, "post_id": 57997185, "comment_id": 102401019, "body": "The easiest way to see this is to make chart with all the variable names along the top. next execute each step of the program and write any changed values under the column for the variable that has changed. Then you will see the results that Scott describes in the previous comment."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 2, "creation_date": 1568827825, "post_id": 57997185, "comment_id": 102402193, "body": "What part of it don&#39;t you understand? It&#39;s just assigning and adding variables, nothing at all complicated."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 2, "creation_date": 1568827859, "post_id": 57997185, "comment_id": 102402206, "body": "If you understand what Fibonacci numbers are, it should be clear how it works."}, {"owner": {"reputation": 1, "user_id": 12086234, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-6-scB6jqAYQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfPqLjQiypRic_eKZk0WZRq792K8g/photo.jpg?sz=128", "display_name": "Anubhav Kundu", "link": "https://stackoverflow.com/users/12086234/anubhav-kundu"}, "edited": false, "score": 0, "creation_date": 1568861059, "post_id": 57997185, "comment_id": 102411355, "body": "Barmar I do not understand which is why I am asking the question."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1568984342, "post_id": 57997185, "comment_id": 102460087, "body": "This code has undefined behaviour. You provide 3 format specifiers to <code>printf</code> but only 2 parameters. Do you really get the expected output? What to you expect? And: Don&#39;t you get some warning from your compiler about unused variable ?<code>ratio</code> and missing variable?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 12086234, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-6-scB6jqAYQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfPqLjQiypRic_eKZk0WZRq792K8g/photo.jpg?sz=128", "display_name": "Anubhav Kundu", "link": "https://stackoverflow.com/users/12086234/anubhav-kundu"}, "edited": false, "score": 0, "creation_date": 1569339874, "post_id": 58026158, "comment_id": 102561822, "body": "Thank you for your response and yes that is there because I deleted some variables from the original code before transferring here to make it less confusing. But I guess I forgot to fully fix it."}], "tags": [], "owner": {"reputation": 1320, "user_id": 5495906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5b319c1b73d80f4155fbdd4fcb81525?s=128&d=identicon&r=PG&f=1", "display_name": "LegendofPedro", "link": "https://stackoverflow.com/users/5495906/legendofpedro"}, "is_accepted": false, "score": 0, "last_activity_date": 1568973809, "creation_date": 1568973809, "answer_id": 58026158, "question_id": 57997185, "link": "https://stackoverflow.com/questions/57997185/can-someone-explain-exactly-how-the-for-loop-in-this-code-works/58026158#58026158", "title": "Can someone explain exactly how the for loop in this code works?", "body": "<p>The Fibonacci Sequence is the series of numbers: <code>[0, 1, ... ]</code> where the next number is found by adding up the two numbers before it.</p>\n\n<pre><code>0+1=1\n1+1=2\n2+1=3\n3+2=5\n5+3=8\n...\n</code></pre>\n\n<p>Variables are initialised as:<code>oneBack = 0</code> and <code>twoBack = 1</code>.\nSo each time through the loop:</p>\n\n<pre><code>fibNum = oneBack + twoBack; // = 0+1=1\ntwoBack = oneBack;          // = 0\noneBack = fibNum;           // = 1\n\nfibNum = oneBack + twoBack; // = 1+0=1\ntwoBack = oneBack;          // = 1\noneBack = fibNum;           // = 1\n\nfibNum = oneBack + twoBack; // = 1+1=2\ntwoBack = oneBack;          // = 1\noneBack = fibNum;           // = 2\n\nfibNum = oneBack + twoBack; // = 2+1=3\ntwoBack = oneBack;          // = 2\noneBack = fibNum;           // = 3\n\nfibNum = oneBack + twoBack; // = 3+2=5\ntwoBack = oneBack;          // = 3\noneBack = fibNum;           // = 5\n\nfibNum = oneBack + twoBack; // = 5+3=8\ntwoBack = oneBack;          // = 5\noneBack = fibNum;           // = 8\n\nfibNum = oneBack + twoBack; // = 8+5=13\ntwoBack = oneBack;          // = 5\noneBack = fibNum;           // = 13\n\n...\n</code></pre>\n\n<p><code>i</code> is the loop counter, to stop calculating when the ith term calculated is the <code>fibTerm</code>th.</p>\n\n<p>Your code has an extraneous format specifier and comma, so it shouldn't compile.\n<code>printf(\"f(%d) = %d. The ratio is %lf\\n\", i, fibNum,);</code>\nYou probably meant:</p>\n\n<pre><code>ratio = oneBack / fibNum;\nprintf(\"f(%d) = %d. The ratio is %lf\\n\", i, fibNum, ratio);\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12086234, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-6-scB6jqAYQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfPqLjQiypRic_eKZk0WZRq792K8g/photo.jpg?sz=128", "display_name": "Anubhav Kundu", "link": "https://stackoverflow.com/users/12086234/anubhav-kundu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 83, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1568973809, "creation_date": 1568824210, "last_edit_date": 1568824422, "question_id": 57997185, "link": "https://stackoverflow.com/questions/57997185/can-someone-explain-exactly-how-the-for-loop-in-this-code-works", "title": "Can someone explain exactly how the for loop in this code works?", "body": "<p>This code is supposed to display the fibonacci sequence for how ever many terms the user selects. The code works as intended, <strong>I just want someone to explain how the for loop for this code block actually works.</strong></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n\nvoid main(void)\n{\n    int i, fibTerm, oneBack = 0, twoBack = 1, fibNum;\n    double ratio;\n\n    printf(\"How many fibonacci terms would you like to calculate?\\n\");\n    scanf(\"%d\", &amp;fibTerm);\n\n    for (i = 1; i &lt;= fibTerm; i++)\n    {   \n        fibNum = oneBack + twoBack;\n        twoBack = oneBack;\n        oneBack = fibNum;\n        printf(\"f(%d) = %d. The ratio is %lf\\n\", i, fibNum,);\n\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "loops", "for-loop", "char", "scanf"], "comments": [{"owner": {"reputation": 3108, "user_id": 1556820, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cffaba688aa3f0f21ece8e09c9450e37?s=128&d=identicon&r=PG", "display_name": "mangusta", "link": "https://stackoverflow.com/users/1556820/mangusta"}, "edited": false, "score": 0, "creation_date": 1568823786, "post_id": 57997021, "comment_id": 102400595, "body": "could you explain the usage of 49,51,53,55,57 ?"}, {"owner": {"reputation": 357, "user_id": 4406954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0b8cda217e3baf25c6f911ff6279be0?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin Montambault", "link": "https://stackoverflow.com/users/4406954/kevin-montambault"}, "edited": false, "score": 0, "creation_date": 1568824083, "post_id": 57997021, "comment_id": 102400734, "body": "@daShier has a nice simplification in his answer, but you could add his code into the loop where you read the numbers from the user to make it even more simple."}, {"owner": {"reputation": 430, "user_id": 10509886, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jztmg.png?s=128&g=1", "display_name": "JDunken", "link": "https://stackoverflow.com/users/10509886/jdunken"}, "reply_to_user": {"reputation": 3108, "user_id": 1556820, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cffaba688aa3f0f21ece8e09c9450e37?s=128&d=identicon&r=PG", "display_name": "mangusta", "link": "https://stackoverflow.com/users/1556820/mangusta"}, "edited": false, "score": 0, "creation_date": 1568838197, "post_id": 57997021, "comment_id": 102406307, "body": "@mangusta 48-57 are the ascii codes for numbers"}], "answers": [{"tags": [], "owner": {"reputation": 44000, "user_id": 535275, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/Ft2Mw.jpg?s=128&g=1", "display_name": "Scott Hunter", "link": "https://stackoverflow.com/users/535275/scott-hunter"}, "is_accepted": true, "score": 1, "last_activity_date": 1568823825, "creation_date": 1568823825, "answer_id": 57997105, "question_id": 57997021, "link": "https://stackoverflow.com/questions/57997021/can-anyone-simplify-this-code-for-me-in-c/57997105#57997105", "title": "can anyone simplify this code for me in c?", "body": "<p>Here are some tools/ideas you can use:</p>\n\n<ul>\n<li>In ctype.h is a function <code>isdigit()</code> which tells you whether or not a character represents a digit.</li>\n<li>Assuming the characters for the digits 0..9 are in sequence, the value represented by a character digit <code>c</code> is <code>c-'0'</code></li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 12086164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1abb46173aea2fc7a01b5ef450aa1624?s=128&d=identicon&r=PG&f=1", "display_name": "EEE1904724", "link": "https://stackoverflow.com/users/12086164/eee1904724"}, "edited": false, "score": 0, "creation_date": 1568954988, "post_id": 57997228, "comment_id": 102446691, "body": "Thank you very much for your explanation, it helps a lot."}], "tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 0, "last_activity_date": 1568825266, "last_edit_date": 1568825266, "creation_date": 1568824368, "answer_id": 57997228, "question_id": 57997021, "link": "https://stackoverflow.com/questions/57997021/can-anyone-simplify-this-code-for-me-in-c/57997228#57997228", "title": "can anyone simplify this code for me in c?", "body": "<p>Here you are</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main( void )\n{\n    enum { N = 20 };\n    char value[N];\n\n    printf( \"Enter an unsigned integer: \" );\n\n    size_t n = 0;\n\n    for ( char digit; n &lt; N &amp;&amp; scanf( \"%c\", &amp;digit ) == 1 &amp;&amp; digit != '\\n'; ++n ) \n    {\n        value[n] = digit;\n    }\n\n    unsigned int sum = 0;\n\n    for ( size_t i = 0; i &lt; n; i++ )\n    {\n        if ( value[i] % 2 != 0 ) sum += value[i] - '0';\n    }\n\n    printf( \"The sum of odd digits of the value is %u.\\n\", sum );\n}\n</code></pre>\n\n<p>The program output might look like</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>Enter an unsigned integer: 0123456789\nThe sum of odd digits of the value is 25\n</code></pre>\n\n<p>Or you can add a check that an entered character is a digit. For example</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;ctype.h&gt;\n\nint main( void )\n{\n    enum { N = 20 };\n    char value[N];\n\n    printf( \"Enter an unsigned integer: \" );\n\n    size_t n = 0;\n\n    for ( char digit; \n          n &lt; N &amp;&amp; scanf( \"%c\", &amp;digit ) == 1 &amp;&amp; isdigit( ( unsigned char )digit );\n          ++n )\n    {\n        value[n] = digit;\n    }\n\n    unsigned int sum = 0;\n\n    for ( size_t i = 0; i &lt; n; i++ )\n    {\n        if ( value[i] % 2 != 0 ) sum += value[i] - '0';\n    }\n\n    printf( \"The sum of odd digits of the value is %u\\n\", sum );\n}\n</code></pre>\n\n<p>As for your code then in this loop</p>\n\n<pre><code>  for (i=0;i&lt;20;i++)\n  {\n    scanf(\"%c\",&amp;n[i]);\n    if(n[i]=='\\n')\n    {\n      break;\n    }\n  }\n</code></pre>\n\n<p>you have to count how many digits were entered. And the new line character shall not be stored in the array. Otherwise this loop</p>\n\n<pre><code>  for (i=0;i&lt;20;i++)\n</code></pre>\n\n<p>can result in undefined behavior.</p>\n\n<p>And you should not use magic numbers like for example <code>49</code>.</p>\n"}], "owner": {"reputation": 3, "user_id": 12086164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1abb46173aea2fc7a01b5ef450aa1624?s=128&d=identicon&r=PG&f=1", "display_name": "EEE1904724", "link": "https://stackoverflow.com/users/12086164/eee1904724"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 57997105, "answer_count": 2, "score": 0, "last_activity_date": 1568825460, "creation_date": 1568823521, "last_edit_date": 1568825460, "question_id": 57997021, "link": "https://stackoverflow.com/questions/57997021/can-anyone-simplify-this-code-for-me-in-c", "title": "can anyone simplify this code for me in c?", "body": "<p>The sum of all odd digits of n.(eg. n is 32677, the sum would be 3+7+7=17)</p>\n\n<p>Here is the code.\nFor this question, any of loop or function is acceptable, but not longer than this answer.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main()\n{\n  char n[20];\n  int m=0,i;\n  printf(\"Enter integers for the variable n: \");\n  for (i=0;i&lt;20;i++)\n  {\n    scanf(\"%c\",&amp;n[i]);\n    if(n[i]=='\\n')\n    {\n      break;\n    }\n  }\n  for (i=0;i&lt;20;i++)// this is the part I would like to simplified\n  {\n    if (n[i]%2!=0)\n    {\n      if(n[i]==49)\n      m++;\n      if(n[i]==51)\n      m+=3;\n      if(n[i]==53)\n      m+=5;\n      if(n[i]==55)\n      m+=7;\n      else if(n[i]==57)\n      m+=9;\n    }\n  }\n  printf(\"The sum of odd digits of n is %d.\",m);\n}\n</code></pre>\n"}, {"tags": ["c", "opengl", "glfw"], "comments": [{"owner": {"reputation": 1578, "user_id": 9516968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f15afa6fdf1897c5ba92cea3946a5635?s=128&d=identicon&r=PG&f=1", "display_name": "Romen", "link": "https://stackoverflow.com/users/9516968/romen"}, "edited": false, "score": 0, "creation_date": 1568825827, "post_id": 57996888, "comment_id": 102401452, "body": "Have you tried copying the code from that tutorial and compiling it without any modifications? Do you get the same results? It is possible that the time value from <code>glfwGetTime()</code> is returning values that don&#39;t appear smooth when passed into <code>sin()</code>. Try <code>greenValue = sin(timeValue&#47;100.0f) &#47; 2.0f + 0.5f</code> to see if it&#39;s any smoother."}, {"owner": {"reputation": 138000, "user_id": 5577765, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LoGpC.jpg?s=128&g=1", "display_name": "Rabbid76", "link": "https://stackoverflow.com/users/5577765/rabbid76"}, "edited": false, "score": 1, "creation_date": 1568827696, "post_id": 57996888, "comment_id": 102402140, "body": "<a href=\"https://www.glfw.org/docs/3.0/group__time.html#gaa6cf4e7a77158a3b8fd00328b1720a4a\" rel=\"nofollow noreferrer\"><code>glfwGetTime()</code></a> returns seconds the seconds since GLFW was initialized that should be slow enough. I&#39;ve tested the code and I can&#39;t reproduce the issue, it works fine for me."}, {"owner": {"reputation": 23, "user_id": 12086127, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-GVPHFvNxc-U/AAAAAAAAAAI/AAAAAAAAAQ8/JsU9rrwm9HE/photo.jpg?sz=128", "display_name": "Romulo Cenci", "link": "https://stackoverflow.com/users/12086127/romulo-cenci"}, "edited": false, "score": 0, "creation_date": 1568834433, "post_id": 57996888, "comment_id": 102404883, "body": "Hi, thanks for the answer!! So the code is right, do you think the problem could be with Mesa driver version?"}, {"owner": {"reputation": 6058, "user_id": 3871028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfbe44ff5c56628e85683c8918602c96?s=128&d=identicon&r=PG&f=1", "display_name": "Ripi2", "link": "https://stackoverflow.com/users/3871028/ripi2"}, "edited": false, "score": 0, "creation_date": 1568836140, "post_id": 57996888, "comment_id": 102405532, "body": "Trigonometrics can return a negative value, but the color must be in [0, 1] range. Try <code>abs(sin(timeValue))</code>. Or better, clamp it to that range, in CPU or in the shader."}, {"owner": {"reputation": 1578, "user_id": 9516968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f15afa6fdf1897c5ba92cea3946a5635?s=128&d=identicon&r=PG&f=1", "display_name": "Romen", "link": "https://stackoverflow.com/users/9516968/romen"}, "reply_to_user": {"reputation": 138000, "user_id": 5577765, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LoGpC.jpg?s=128&g=1", "display_name": "Rabbid76", "link": "https://stackoverflow.com/users/5577765/rabbid76"}, "edited": false, "score": 0, "creation_date": 1568836202, "post_id": 57996888, "comment_id": 102405550, "body": "@Rabbid76, I couldn&#39;t see any problem with the code either so the only thing left was to be suspicious of <code>glfwGetTime()</code>. We need to know more about the system in question to know what <i>could</i> go wrong with that function or OpenGL."}, {"owner": {"reputation": 6058, "user_id": 3871028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfbe44ff5c56628e85683c8918602c96?s=128&d=identicon&r=PG&f=1", "display_name": "Ripi2", "link": "https://stackoverflow.com/users/3871028/ripi2"}, "reply_to_user": {"reputation": 138000, "user_id": 5577765, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LoGpC.jpg?s=128&g=1", "display_name": "Rabbid76", "link": "https://stackoverflow.com/users/5577765/rabbid76"}, "edited": false, "score": 0, "creation_date": 1568836417, "post_id": 57996888, "comment_id": 102405639, "body": "@Rabbid76 Mathemathically, yes. But round errors are always there with floats."}, {"owner": {"reputation": 1578, "user_id": 9516968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f15afa6fdf1897c5ba92cea3946a5635?s=128&d=identicon&r=PG&f=1", "display_name": "Romen", "link": "https://stackoverflow.com/users/9516968/romen"}, "edited": false, "score": 0, "creation_date": 1568836467, "post_id": 57996888, "comment_id": 102405658, "body": "Doesn&#39;t OpenGL clamp negative float values to 0 anyways? We would see smooth fading for half of the time, from black to {0,128,0} at worst. (As Rabbid76 says, float errors are not the issue here)"}, {"owner": {"reputation": 1578, "user_id": 9516968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f15afa6fdf1897c5ba92cea3946a5635?s=128&d=identicon&r=PG&f=1", "display_name": "Romen", "link": "https://stackoverflow.com/users/9516968/romen"}, "edited": false, "score": 0, "creation_date": 1568837776, "post_id": 57996888, "comment_id": 102406136, "body": "@RomuloCenci, Just to be sure... Are you using an OpenGL loader at all? The tutorial you are following <a href=\"https://learnopengl.com/Getting-started/Creating-a-window\" rel=\"nofollow noreferrer\">suggests using glad</a>, a loader like that is required to use modern OpenGL. Linking with <code>-lGL</code> and <code>#include &lt;GL&#47;gl.h&gt;</code> will only get you OpenGL 1.1! <a href=\"https://glad.dav1d.de/\" rel=\"nofollow noreferrer\">Here&#39;s</a> a helpful tool to generate the code you need to load OpenGL properly."}, {"owner": {"reputation": 23, "user_id": 12086127, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-GVPHFvNxc-U/AAAAAAAAAAI/AAAAAAAAAQ8/JsU9rrwm9HE/photo.jpg?sz=128", "display_name": "Romulo Cenci", "link": "https://stackoverflow.com/users/12086127/romulo-cenci"}, "reply_to_user": {"reputation": 1578, "user_id": 9516968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f15afa6fdf1897c5ba92cea3946a5635?s=128&d=identicon&r=PG&f=1", "display_name": "Romen", "link": "https://stackoverflow.com/users/9516968/romen"}, "edited": false, "score": 0, "creation_date": 1568839361, "post_id": 57996888, "comment_id": 102406736, "body": "@Romen, yes, that was the problem, I was not using any loader."}], "answers": [{"tags": [], "owner": {"reputation": 23, "user_id": 12086127, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-GVPHFvNxc-U/AAAAAAAAAAI/AAAAAAAAAQ8/JsU9rrwm9HE/photo.jpg?sz=128", "display_name": "Romulo Cenci", "link": "https://stackoverflow.com/users/12086127/romulo-cenci"}, "is_accepted": false, "score": 1, "last_activity_date": 1568837937, "creation_date": 1568837937, "answer_id": 58000202, "question_id": 57996888, "link": "https://stackoverflow.com/questions/57996888/opengl-shaders-not-working-with-uniform-variable/58000202#58000202", "title": "OpenGL shaders not working with uniform variable", "body": "<p>thank you all for help!!\nI'd discover what is my problem, I'd just forgot to include de glad.h library and the libdl.</p>\n"}], "migrated_from": {"other_site": {"markdown_extensions": ["Prettify"], "launch_date": 1250553600, "open_beta_date": 1247529600, "site_state": "normal", "high_resolution_icon_url": "https://cdn.sstatic.net/Sites/superuser/Img/apple-touch-icon@2.png", "twitter_account": "super_user", "favicon_url": "https://cdn.sstatic.net/Sites/superuser/Img/favicon.ico", "icon_url": "https://cdn.sstatic.net/Sites/superuser/Img/apple-touch-icon.png", "audience": "computer enthusiasts and power users", "site_url": "https://superuser.com", "api_site_parameter": "superuser", "logo_url": "https://cdn.sstatic.net/Sites/superuser/Img/logo.png", "name": "Super User", "site_type": "main_site"}, "on_date": 1568823031, "question_id": 1483894}, "owner": {"reputation": 23, "user_id": 12086127, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-GVPHFvNxc-U/AAAAAAAAAAI/AAAAAAAAAQ8/JsU9rrwm9HE/photo.jpg?sz=128", "display_name": "Romulo Cenci", "link": "https://stackoverflow.com/users/12086127/romulo-cenci"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 197, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1568842695, "creation_date": 1568822978, "last_edit_date": 1568829053, "question_id": 57996888, "link": "https://stackoverflow.com/questions/57996888/opengl-shaders-not-working-with-uniform-variable", "title": "OpenGL shaders not working with uniform variable", "body": "<p>I'm trying to write a code to draw a triangle with changing color, following the tutorial <a href=\"https://learnopengl.com/Getting-started/Shaders\" rel=\"nofollow noreferrer\">LearnOpenGL - Shaders</a>.</p>\n\n<p>But my code doesn't work, the triangle is blinking instead of gradually change the color, I don't know if it is a hardware or software problem. </p>\n\n<p>Can anyone help me?</p>\n\n<p>I'm using OpenGL 3.0 with Mesa 18.3.4.</p>\n\n<p>And compiling with <code>gcc shaders_change.c -lGL -lglfw -lm</code></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;math.h&gt;\n#include &lt;GL/gl.h&gt;\n#include &lt;GLFW/glfw3.h&gt;\n\nvoid framebuffer_size_callback(GLFWwindow* window, int width, int height);\nvoid processInput(GLFWwindow *window);\n\nconst unsigned int SCR_WIDTH = 800;\nconst unsigned int SCR_HEIGHT = 600;\n\nconst char *vertexShaderSource =\"#version 330 core\\n\"\n  \"layout (location = 0) in vec3 aPos;\\n\"\n  \"void main()\\n\"\n  \"{\\n\"\n  \"   gl_Position = vec4(aPos, 1.0);\\n\"\n  \"}\\n\\0\";\n\nconst char *fragmentShaderSource = \"#version 330\\n\"\n  \"out vec4 FragColor;\\n\"\n  \"uniform vec4 ourColor;\\n\"\n  \"void main()\\n\"\n  \"{\\n\"\n  \"   FragColor = ourColor;\\n\"\n  \"}\\n\\0\";\n\nint main(){\n    // glfw: initialize and configure\n    // ------------------------------\n    glfwInit();\n    glfwWindowHint(GLFW_CONTEXT_VERSION_MAJOR, 3);\n    glfwWindowHint(GLFW_CONTEXT_VERSION_MINOR, 3);\n    glfwWindowHint(GLFW_OPENGL_PROFILE, GLFW_OPENGL_CORE_PROFILE);\n\n    // glfw window creation\n    // --------------------\n    GLFWwindow* window = glfwCreateWindow(SCR_WIDTH, SCR_HEIGHT, \"LearnOpenGL\", NULL, NULL);\n    if (window == NULL)\n    {\n      printf(\"Failed to create GLFW window\");\n      glfwTerminate();\n      return -1;\n    }\n    glfwMakeContextCurrent(window);\n    glfwSetFramebufferSizeCallback(window, framebuffer_size_callback);\n\n    // build and compile our shader program\n    // ------------------------------------\n    // vertex shader\n    int vertexShader = glCreateShader(GL_VERTEX_SHADER);\n    glShaderSource(vertexShader, 1, &amp;vertexShaderSource, NULL);\n    glCompileShader(vertexShader);\n    // check for shader compile errors\n    int success;\n    char infoLog[512];\n    glGetShaderiv(vertexShader, GL_COMPILE_STATUS, &amp;success);\n    if (!success)\n    {\n        glGetShaderInfoLog(vertexShader, 512, NULL, infoLog);\n        printf(\"ERROR::SHADER::VERTEX::COMPILATION_FAILED\\n%s\",infoLog);\n    }\n    // fragment shader\n    int fragmentShader = glCreateShader(GL_FRAGMENT_SHADER);\n    glShaderSource(fragmentShader, 1, &amp;fragmentShaderSource, NULL);\n    glCompileShader(fragmentShader);\n    // check for shader compile errors\n    glGetShaderiv(fragmentShader, GL_COMPILE_STATUS, &amp;success);\n    if (!success)\n    {\n        glGetShaderInfoLog(fragmentShader, 512, NULL, infoLog);\n    printf(\"ERROR::SHADER::VERTEX::COMPILATION_FAILED\\n%s\",infoLog);\n    }\n    // link shaders\n    int shaderProgram = glCreateProgram();\n    glAttachShader(shaderProgram, vertexShader);\n    glAttachShader(shaderProgram, fragmentShader);\n    glLinkProgram(shaderProgram);\n    // check for linking errors\n    glGetProgramiv(shaderProgram, GL_LINK_STATUS, &amp;success);\n    if (!success) {\n      glGetProgramInfoLog(shaderProgram, 512, NULL, infoLog);\n      printf(\"ERROR::SHADER::VERTEX::COMPILATION_FAILED\\n%s\",infoLog);\n    }\n    glDeleteShader(vertexShader);\n    glDeleteShader(fragmentShader);\n\n    // set up vertex data (and buffer(s)) and configure vertex attributes\n    // ------------------------------------------------------------------\n    float vertices[] = {\n        // positions         // colors\n         0.5f, -0.5f, 0.0f,  // bottom right\n        -0.5f, -0.5f, 0.0f,  // bottom left\n         0.0f,  0.5f, 0.0f,  // top \n    };\n\n    unsigned int VBO, VAO;\n    glGenVertexArrays(1, &amp;VAO);\n    glGenBuffers(1, &amp;VBO);\n    // bind the Vertex Array Object first, then bind and set vertex buffer(s), and then configure vertex attributes(s).\n    glBindVertexArray(VAO);\n\n    glBindBuffer(GL_ARRAY_BUFFER, VBO);\n    glBufferData(GL_ARRAY_BUFFER, sizeof(vertices), vertices, GL_STATIC_DRAW);\n\n    // position attribute\n    glVertexAttribPointer(0, 3, GL_FLOAT, GL_FALSE, 3 * sizeof(float), 0);\n    glEnableVertexAttribArray(0);\n    // color attribute\n    //glVertexAttribPointer(1, 3, GL_FLOAT, GL_FALSE, 6 * sizeof(float), (void*)(3 * sizeof(float)));\n    //glEnableVertexAttribArray(VAO);\n\n    // You can unbind the VAO afterwards so other VAO calls won't accidentally modify this VAO, but this rarely happens. Modifying other\n    // VAOs requires a call to glBindVertexArray anyways so we generally don't unbind VAOs (nor VBOs) when it's not directly necessary.\n\n    // as we only have a single shader, we could also just activate our shader once beforehand if we want to\n    glBindVertexArray(VAO);\n\n    // render loop\n    // -----------\n    float timeValue;\n    float greenValue;\n    int vertexColorLocation;\n    while (!glfwWindowShouldClose(window)){\n        // input\n        // -----\n        processInput(window);\n\n    // render\n        // ------\n        //glClearColor(0.2f, 0.3f, 0.3f, 1.0f);\n        glClear(GL_COLOR_BUFFER_BIT);\n\n    glUseProgram(shaderProgram);\n\n    timeValue = glfwGetTime();\n    greenValue = sin(timeValue) / 2.0f + 0.5f;\n    vertexColorLocation = glGetUniformLocation(shaderProgram, \"ourColor\");\n    glUniform4f(vertexColorLocation, 0.0f, greenValue, 0.0f, 1.0f);\n\n        // render the triangle\n    glBindVertexArray(VAO);\n        glDrawArrays(GL_TRIANGLES, 0, 3);\n\n        // glfw: swap buffers and poll IO events (keys pressed/released, mouse moved etc.)\n        // -------------------------------------------------------------------------------\n        glfwSwapBuffers(window);\n        glfwPollEvents();\n    }\n\n    // optional: de-allocate all resources once they've outlived their purpose:\n    // ------------------------------------------------------------------------\n    glDeleteVertexArrays(1, &amp;VAO);\n    glDeleteBuffers(1, &amp;VBO);\n\n    // glfw: terminate, clearing all previously allocated GLFW resources.\n    // ------------------------------------------------------------------\n    glfwTerminate();\n    return 0;\n}\n\nvoid processInput(GLFWwindow *window){\n    if (glfwGetKey(window, GLFW_KEY_ESCAPE) == GLFW_PRESS)\n        glfwSetWindowShouldClose(window, 1);\n}\n\nvoid framebuffer_size_callback(GLFWwindow* window, int width, int height){\n    glViewport(0, 0, width, height);\n}\n</code></pre>\n"}, {"tags": ["c", "macos", "fortran", "gfortran"], "comments": [{"owner": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "edited": false, "score": 0, "creation_date": 1568826065, "post_id": 57996656, "comment_id": 102401528, "body": "Please <a href=\"https://stackoverflow.com/posts/57996656/edit\">edit</a> your question and tell which version of LoopTools you tried to install. I checked version 2.15. The script <code>configure</code> can write the error output to a file if you set the environment variable <code>LOGFILE</code> to a file name. Otherwise the error output is discarded. Try e.g. <code>LOGFILE=log.txt</code> <code>export LOGFILE</code> <code>.&#47;configure</code> (as 3 separate commands) and show the last part of <code>log.txt</code> in your question, e.g. the output of <code>tail -30 log.txt</code>."}, {"owner": {"reputation": 13, "user_id": 7866939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24f4525f2e0cbe3655d78c8db3fe8e75?s=128&d=identicon&r=PG&f=1", "display_name": "Tanatofobico", "link": "https://stackoverflow.com/users/7866939/tanatofobico"}, "reply_to_user": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "edited": false, "score": 0, "creation_date": 1568837748, "post_id": 57996656, "comment_id": 102406121, "body": "The version I tried to install is indeed LoopTools 2.15"}, {"owner": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "edited": false, "score": 0, "creation_date": 1568879926, "post_id": 57996656, "comment_id": 102417416, "body": "After the command <code>gfortran ... -o test32232 test32232.f test32232-c.o</code> you can see the error message <code>ld: library not found for -lSystem</code>. Check if you have a library <code>libSystem.*</code> on your system and where it is located. If it&#39;s not in a standard location, maybe you have to add the library location to <code>LD_LIBRARY_PATH</code> and/or <code>DYLD_LIBRARY_PATH</code>."}, {"owner": {"reputation": 115642, "user_id": 299924, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/71fc84230717311db1410d7106273128?s=128&d=identicon&r=PG", "display_name": "trojanfoe", "link": "https://stackoverflow.com/users/299924/trojanfoe"}, "edited": false, "score": 0, "creation_date": 1568881578, "post_id": 57996656, "comment_id": 102418176, "body": "<code>&#47;usr&#47;lib&#47;libSystem.dylib</code> is part of the O/S.  I would suspect that fortran linker as being broken."}, {"owner": {"reputation": 13, "user_id": 7866939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24f4525f2e0cbe3655d78c8db3fe8e75?s=128&d=identicon&r=PG&f=1", "display_name": "Tanatofobico", "link": "https://stackoverflow.com/users/7866939/tanatofobico"}, "edited": false, "score": 0, "creation_date": 1568895464, "post_id": 57996656, "comment_id": 102425778, "body": "I searched for it and it is in the right folder"}, {"owner": {"reputation": 6827, "user_id": 3501546, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zzZH7.jpg?s=128&g=1", "display_name": "roygvib", "link": "https://stackoverflow.com/users/3501546/roygvib"}, "edited": false, "score": 0, "creation_date": 1568902497, "post_id": 57996656, "comment_id": 102430218, "body": "Does /opt/local/bin/ possibly have gcc and g++ installed by macports (not /usr/bin/clang)? Then, I guess explicitly specifying them as &quot;CC=/opt/local/bin/gcc CXX=/opt/local/bin/g++ FC=/opt/local/bin/gfortran ./configure&quot; might have different results. (FYI, the above Loop library just compiled w/o problem on my mac... I used GCC installed via homebrew.)"}, {"owner": {"reputation": 13, "user_id": 7866939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24f4525f2e0cbe3655d78c8db3fe8e75?s=128&d=identicon&r=PG&f=1", "display_name": "Tanatofobico", "link": "https://stackoverflow.com/users/7866939/tanatofobico"}, "edited": false, "score": 0, "creation_date": 1568904985, "post_id": 57996656, "comment_id": 102431725, "body": "both clang (in /usr/bin ) and the macport-installed gcc, g++ and gfortran-mp-5/gfortran-mp-6 (in /opt/local/bin) are present. I tried setting the variables (is via terminal enough?) as you said but the result is not different"}], "owner": {"reputation": 13, "user_id": 7866939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24f4525f2e0cbe3655d78c8db3fe8e75?s=128&d=identicon&r=PG&f=1", "display_name": "Tanatofobico", "link": "https://stackoverflow.com/users/7866939/tanatofobico"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 246, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1568879407, "creation_date": 1568822014, "last_edit_date": 1568879407, "question_id": 57996656, "link": "https://stackoverflow.com/questions/57996656/error-linking-c-and-fortran-in-installation-of-library", "title": "Error linking C and Fortran in installation of library", "body": "<p>I'm installing LoopTools version 2.15 (<a href=\"http://www.feynarts.de/looptools/LT25Guide.pdf\" rel=\"nofollow noreferrer\">http://www.feynarts.de/looptools/LT25Guide.pdf</a>), a library which evaluates special functions needed in physics. I had already installed it on a computer with Linux, and am now trying to install it on a Mac. I had to install a fortran compiler, which I did easily through macports. However, the following error appears when I try to install the package:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>looking for gcc... /usr/bin/clang\nlooking for g++... /usr/bin/clang++\nlooking for fortran... /opt/local/bin/gfortran\nextracting the Fortran libraries... ok\ndoes gfortran append underscores... error linking Fortran and C\n</code></pre>\n\n<p>Do you have any suggestions on how to solve the problem?</p>\n\n<p>EDIT: under suggestion, I post the last 30 lines of the logfile</p>\n\n<pre><code>+ eval setflags CXXFLAGS '-O3 -g -fomit-frame-pointer -ffast-math -Wall  '\n++ setflags CXXFLAGS -O3 -g -fomit-frame-pointer -ffast-math -Wall\n++ rhs=\n++ printf -v rhs ' %q' -O3 -g -fomit-frame-pointer -ffast-math -Wall\n++ eval 'CONF_CXXFLAGS=\"${rhs//\\\\,/,}\"'\n+++ CONF_CXXFLAGS=' -O3 -g -fomit-frame-pointer -ffast-math -Wall'\n+ echo -n 'does gfortran append underscores... '\n+ tee test32232-c.c\nint uscore_ = 95;\nint uscore = 59;\n+ for CONF_BITS in '${CONF_BITS:--m64 -m32}'\n+ eval clang -O3 -g -fomit-frame-pointer -ffast-math -fPIC -Wall -m64 -c test32232-c.c\n++ clang -O3 -g -fomit-frame-pointer -ffast-math -fPIC -Wall -m64 -c test32232-c.c\n+ eval gfortran -O3 -ffixed-line-length-none -fno-range-check -Wl,-no_compact_unwind -o test32232 test32232.f test32232-c.o\n++ gfortran -O3 -ffixed-line-length-none -fno-range-check -Wl,-no_compact_unwind -o test32232 test32232.f test32232-c.o\nld: library not found for -lSystem\ncollect2: error: ld returned 1 exit status\n+ for CONF_BITS in '${CONF_BITS:--m64 -m32}'\n+ eval clang -O3 -g -fomit-frame-pointer -ffast-math -fPIC -Wall -m32 -c test32232-c.c\n++ clang -O3 -g -fomit-frame-pointer -ffast-math -fPIC -Wall -m32 -c test32232-c.c\n+ eval gfortran -O3 -ffixed-line-length-none -fno-range-check -Wl,-no_compact_unwind -o test32232 test32232.f test32232-c.o\n++ gfortran -O3 -ffixed-line-length-none -fno-range-check -Wl,-no_compact_unwind -o test32232 test32232.f test32232-c.o\nld: library not found for -lSystem\ncollect2: error: ld returned 1 exit status\n+ ./test32232\n./configure: line 264: ./test32232: No such file or directory\n+ case $? in\n+ echo 'error linking Fortran and C'\n+ exit 1\n+ rm -fr test32232-c.c test32232-c.o test32232.f =.```\n</code></pre>\n"}, {"tags": ["c", "arrays", "string", "segmentation-fault"], "comments": [{"owner": {"reputation": 2988, "user_id": 452414, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rDMfs.png?s=128&g=1", "display_name": "babon", "link": "https://stackoverflow.com/users/452414/babon"}, "edited": false, "score": 1, "creation_date": 1568821025, "post_id": 57996265, "comment_id": 102399224, "body": "... and when does the <code>while</code> loop terminate?"}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 1, "creation_date": 1568821101, "post_id": 57996265, "comment_id": 102399270, "body": "Use a debugger to find which line that causes the segfault"}, {"owner": {"reputation": 1, "user_id": 12085860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f1b86cbbd1c967ba59547beb85b3e79?s=128&d=identicon&r=PG&f=1", "display_name": "Rodrigo Diaz", "link": "https://stackoverflow.com/users/12085860/rodrigo-diaz"}, "edited": false, "score": 0, "creation_date": 1568821339, "post_id": 57996265, "comment_id": 102399403, "body": "that come later, the program is incomplete my problem is the segmentation fault in the function SplitString."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1568821376, "post_id": 57996265, "comment_id": 102399422, "body": "What is <code>PrintPrompt</code>? And please provide a sample input that triggrs the promlem. Read this: <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> and this: <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 1, "user_id": 12085860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f1b86cbbd1c967ba59547beb85b3e79?s=128&d=identicon&r=PG&f=1", "display_name": "Rodrigo Diaz", "link": "https://stackoverflow.com/users/12085860/rodrigo-diaz"}, "edited": false, "score": 0, "creation_date": 1568821446, "post_id": 57996265, "comment_id": 102399464, "body": "the problem is when the function is invoked SplitString. it never gets inside the function"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 12085860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f1b86cbbd1c967ba59547beb85b3e79?s=128&d=identicon&r=PG&f=1", "display_name": "Rodrigo Diaz", "link": "https://stackoverflow.com/users/12085860/rodrigo-diaz"}, "edited": false, "score": 0, "creation_date": 1568821954, "post_id": 57996538, "comment_id": 102399760, "body": "Thanks!! very useful."}], "tags": [], "owner": {"reputation": 3108, "user_id": 1556820, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cffaba688aa3f0f21ece8e09c9450e37?s=128&d=identicon&r=PG", "display_name": "mangusta", "link": "https://stackoverflow.com/users/1556820/mangusta"}, "is_accepted": false, "score": 2, "last_activity_date": 1568821559, "creation_date": 1568821559, "answer_id": 57996538, "question_id": 57996265, "link": "https://stackoverflow.com/questions/57996265/segmentation-fault-when-using-array-of-strings-in-c/57996538#57996538", "title": "Segmentation fault when using array of strings in C", "body": "<p>You should use NULL as a first argument starting from second call to <code>strtok</code></p>\n\n<p>Replace<br>\n<code>while ((pieces[i]=strtok(str,\" \\n\\t\"))!=NULL)</code>   </p>\n\n<p>with<br>\n<code>while ((pieces[i]=strtok(NULL,\" \\n\\t\"))!=NULL)</code></p>\n"}, {"tags": [], "owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "is_accepted": false, "score": 1, "last_activity_date": 1568822238, "last_edit_date": 1568822238, "creation_date": 1568821929, "answer_id": 57996636, "question_id": 57996265, "link": "https://stackoverflow.com/questions/57996265/segmentation-fault-when-using-array-of-strings-in-c/57996636#57996636", "title": "Segmentation fault when using array of strings in C", "body": "<p>Your <code>SplitString</code> function is overly complicated and wrong.</p>\n\n<p>You want this:</p>\n\n<pre><code>int SplitString(char * str, char * pieces[]) {\n  int i = 0;\n\n  char *token = strtok(str, \" \\n\\t\");\n\n  while (token != NULL)              // while there are tokens\n  {\n    strcpy(pieces[i++], token);      // copy the string, not the pointer\n    token = strtok(NULL, \" \\n\\t\");   // use NULL here, read the\n                                     // documentation of strtok\n  }\n\n  return i;\n}\n</code></pre>\n\n<p>Not directly related to your problem:</p>\n\n<p>The <code>CommandPros</code> function is quite awkward: you allocate memory for 100 strings each of which has room for 99 characters (+ the NUL terminator), which is in most cases too much.</p>\n\n<p>You should allocate only the memory you need. The overall design of your code looks wrong.</p>\n"}, {"tags": [], "owner": {"reputation": 41, "user_id": 8604749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e41a80832eab14dc4097202cc188ac78?s=128&d=identicon&r=PG&f=1", "display_name": "Neena", "link": "https://stackoverflow.com/users/8604749/neena"}, "is_accepted": false, "score": 1, "last_activity_date": 1568822703, "creation_date": 1568822703, "answer_id": 57996814, "question_id": 57996265, "link": "https://stackoverflow.com/questions/57996265/segmentation-fault-when-using-array-of-strings-in-c/57996814#57996814", "title": "Segmentation fault when using array of strings in C", "body": "<p>You have to modify the second strtok() in SplitString to below\n  while ((pieces[i]=strtok(NULL,\" \\n\\t\"))!=NULL) </p>\n\n<p>The first call to strtok must pass the C string to be tokenize, and subsequent calls must specify NULL as the first argument, which tells the function to continue tokenizing the string you passed in first. </p>\n"}, {"tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": false, "score": 0, "last_activity_date": 1568916439, "last_edit_date": 1568916439, "creation_date": 1568916062, "answer_id": 58016661, "question_id": 57996265, "link": "https://stackoverflow.com/questions/57996265/segmentation-fault-when-using-array-of-strings-in-c/58016661#58016661", "title": "Segmentation fault when using array of strings in C", "body": "<p>It is always best to check the returned value from a call to a C library function to assure the operation was successful.  In this case, <code>malloc()</code> and <code>fgets()</code></p>\n\n<p>regarding:</p>\n\n<pre><code>/*****************************************************************************/\nvoid ReadEnter(char * str) {\n    fgets(str, 100, stdin);\n}\n\nint main(){\n    int fin = 0;\n    char  * strCommand;\n    strCommand = (char *) malloc (100*sizeof(char));\n\n    while (!fin) {\n       ReadEnter(strCommand); \n       CommandPros(strCommand);\n   }\n</code></pre>\n\n<p>There needs to be some 'consistent' method of terminating the loop in <code>main()</code>.  Paying attention to the returned value from the call to <code>fgets()</code> will do that very nicely.  Suggest:</p>\n\n<pre><code>int main( void )\n{\n    char  strCommand[ 100 ];\n\n    while ( fgets( strCommand, 100, stdin ) )\n    { \n       CommandPros(strCommand);\n    }\n}\n</code></pre>\n\n<p>also, the function: <code>SplitString()</code>  allocates another 100 parts of dynamic memory from the heap every time it is called.  BUT none of the code ever passes each of those (100 * number of lines in input) to <code>free()</code>.   This results in a massive memory leak</p>\n\n<p>The function: <code>SplitString()</code> only sets a pointer to each of the areas in <code>strCommand</code> that were found via <code>strtok()</code>  and the expectation seems to be that each of the 100 allocated memory areas is expected to contain the actual contents of the string found by <code>strtok()</code>  Suggest:</p>\n\n<pre><code>int SplitString( char * str, char * pieces[], int maxPieces ) \n{\n    int i = 0;\n\n    char *token = strtok(str, \" \\n\\t\");\n    while ( i &lt; maxPieces &amp;&amp; token != NULL )              \n    {\n         strcpy(pieces[i++], token);      \n         token = strtok(NULL, \" \\n\\t\");                  \n    }\n\n    return i;\n}\n</code></pre>\n\n<p>In the function:  <code>CommandPros()</code>  the local variable: <code>num</code> is set to the number of words found in the current <code>str</code> but is never used for anything.  The compiler will output a warning message about this problem.</p>\n\n<p>Also, the posted code contains a 'magic' number 100.  'magic' numbers are numbers with no basis and they make the code much more difficult to understand, debug, etc.  Suggest using a <code>enum</code> statement or <code>#define</code> statement to give that 'magic' number a meaningful name then use that meaningful name throughout the code.</p>\n"}], "owner": {"reputation": 1, "user_id": 12085860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f1b86cbbd1c967ba59547beb85b3e79?s=128&d=identicon&r=PG&f=1", "display_name": "Rodrigo Diaz", "link": "https://stackoverflow.com/users/12085860/rodrigo-diaz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1568916439, "creation_date": 1568820517, "last_edit_date": 1568821480, "question_id": 57996265, "link": "https://stackoverflow.com/questions/57996265/segmentation-fault-when-using-array-of-strings-in-c", "title": "Segmentation fault when using array of strings in C", "body": "<p>I am new in C and all this thing of strings is pretty confusing.</p>\n\n<p>The objective of this part of the program is to split a string into multiple strings, in this way I can process the words separately.</p>\n\n<pre><code> int SplitString(char * str, char * pieces[]) {\n  int i=1;\n\n  if ((pieces[0]=strtok(str,\" \\n\\t\"))==NULL){\n    return 0;\n  }\n\n  while ((pieces[i]=strtok(str,\" \\n\\t\"))!=NULL) {\n    i++;\n  }\n\n  return i;\n}\n\n/*****************************************************************************/\nvoid CommandPros(char *str) {\n  char *pieces[100];\n  int numW = 0;\n\n  for (int i = 0; i &lt; 100; i++) {\n    pieces[i] = (char *) malloc (100*sizeof(char));\n  }\n\n  numW = SplitString(str, pieces);\n\n}\n\n/*****************************************************************************/\nvoid ReadEnter(char * str) {\n  fgets(str, 100, stdin);\n}\n\n/*****************************************************************************/\n int main(){\n  int fin = 0;\n  char  * strCommand;\n  strCommand = (char *) malloc (100*sizeof(char));\n\n  while (!fin) {\n    ReadEnter(strCommand); \n    CommandPros(strCommand);\n  }\n\n  return 0;\n}\n</code></pre>\n\n<p>But when I execute the program this message appear:</p>\n\n<p><code>Segmentation fault: 11</code> </p>\n"}, {"tags": ["c", "x11", "keyboard-events"], "comments": [{"owner": {"reputation": 2765, "user_id": 206750, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/86J1B.jpg?s=128&g=1", "display_name": "JvO", "link": "https://stackoverflow.com/users/206750/jvo"}, "edited": false, "score": 0, "creation_date": 1571693250, "post_id": 57996074, "comment_id": 103318506, "body": "What do you mean by &quot;events is stuck on the latest key pressed&quot;? A KeyPress is only sent once when the key is physically pressed down on the keyboard and is not repeated."}, {"owner": {"reputation": 145, "user_id": 4515010, "user_type": "registered", "accept_rate": 14, "profile_image": "https://lh6.googleusercontent.com/-lyN8vuEXTOc/AAAAAAAAAAI/AAAAAAAAAEA/7mhsys1qfis/photo.jpg?sz=128", "display_name": "Yvain", "link": "https://stackoverflow.com/users/4515010/yvain"}, "reply_to_user": {"reputation": 2765, "user_id": 206750, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/86J1B.jpg?s=128&g=1", "display_name": "JvO", "link": "https://stackoverflow.com/users/206750/jvo"}, "edited": false, "score": 0, "creation_date": 1588721123, "post_id": 57996074, "comment_id": 109007071, "body": "@JvO are you sure ? I mean that I was pressing a key and it moved, then when I press another key, it doesn&#39;t have effect. I needed to release the first one and then press the second."}, {"owner": {"reputation": 2765, "user_id": 206750, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/86J1B.jpg?s=128&g=1", "display_name": "JvO", "link": "https://stackoverflow.com/users/206750/jvo"}, "edited": false, "score": 0, "creation_date": 1588888160, "post_id": 57996074, "comment_id": 109082489, "body": "That&#39;s odd, the second keypress should be registered as well. So if you press both Up and Left together you should get two KeyPress events. My X11 knowledge is a bit rusty, though."}, {"owner": {"reputation": 145, "user_id": 4515010, "user_type": "registered", "accept_rate": 14, "profile_image": "https://lh6.googleusercontent.com/-lyN8vuEXTOc/AAAAAAAAAAI/AAAAAAAAAEA/7mhsys1qfis/photo.jpg?sz=128", "display_name": "Yvain", "link": "https://stackoverflow.com/users/4515010/yvain"}, "reply_to_user": {"reputation": 2765, "user_id": 206750, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/86J1B.jpg?s=128&g=1", "display_name": "JvO", "link": "https://stackoverflow.com/users/206750/jvo"}, "edited": false, "score": 0, "creation_date": 1588946231, "post_id": 57996074, "comment_id": 109103434, "body": "You should be right as nothing is mentioned in the X11 programming manual concerning this issue. I gave this up a while ago, but might get back to it one day. Cheers."}], "owner": {"reputation": 145, "user_id": 4515010, "user_type": "registered", "accept_rate": 14, "profile_image": "https://lh6.googleusercontent.com/-lyN8vuEXTOc/AAAAAAAAAAI/AAAAAAAAAEA/7mhsys1qfis/photo.jpg?sz=128", "display_name": "Yvain", "link": "https://stackoverflow.com/users/4515010/yvain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 23, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1568819851, "creation_date": 1568819851, "question_id": 57996074, "link": "https://stackoverflow.com/questions/57996074/let-several-keypress-event-act-together-x11", "title": "let several keypress event act together (X11)", "body": "<p>I have a piece of code that moves a checker around on x,y axis;</p>\n\n<pre><code>checker(gc, cam);\nXNextEvent(display, &amp;events);\nswitch(events.type){\ncase KeyPress:\n    XLookupString(&amp;events.xkey, buff, sizeof(buff), &amp;key, &amp;compose);\n    switch(key){\n    case XK_Up:\n        XClearWindow(display, win);\n        cam.y -= 1;\n        break;\n    case XK_Down:\n        XClearWindow(display, win);\n        cam.y += 1;\n        break;\n    case XK_Left:\n        XClearWindow(display, win);\n        cam.x -= 1;\n        break;\n    case XK_Right:\n        XClearWindow(display, win);\n        cam.x += 1;\n        break;\n    }\n    break;\n</code></pre>\n\n<p>The checker function manages the drawing of squares on the screen so that we have the illusion of the camera moving around. Now the issue is that my events is stuck on the latest key pressed, I need to be able to move diagonnaly, do I need to set up a modifier key ? Or is there a simplest solution like another Event listening routine ? I tried replacing the switch by a set of <code>if</code> withou <code>else</code> but this won't do. </p>\n"}, {"tags": ["c", "arrays", "pointers"], "comments": [{"owner": {"reputation": 3108, "user_id": 1556820, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cffaba688aa3f0f21ece8e09c9450e37?s=128&d=identicon&r=PG", "display_name": "mangusta", "link": "https://stackoverflow.com/users/1556820/mangusta"}, "edited": false, "score": 0, "creation_date": 1568819792, "post_id": 57996016, "comment_id": 102398499, "body": "why did you expect to get another address?"}, {"owner": {"reputation": 2354, "user_id": 9428851, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-MBhDff_bdY0/AAAAAAAAAAI/AAAAAAAACAY/lx7DUTjS350/photo.jpg?sz=128", "display_name": "Victor Gubin", "link": "https://stackoverflow.com/users/9428851/victor-gubin"}, "edited": false, "score": 0, "creation_date": 1568820008, "post_id": 57996016, "comment_id": 102398618, "body": "<a href=\"https://www.studytonight.com/c/pointers-with-array.php\" rel=\"nofollow noreferrer\">studytonight.com/c/pointers-with-array.php</a>."}], "answers": [{"comments": [{"owner": {"reputation": 29641, "user_id": 10871073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ddBW9.png?s=128&g=1", "display_name": "Adrian Mole", "link": "https://stackoverflow.com/users/10871073/adrian-mole"}, "edited": false, "score": 0, "creation_date": 1568820093, "post_id": 57996103, "comment_id": 102398663, "body": "Good answer! OP: try adding the following, if you want to get even more confused: <code>printf(&quot;%p\\n&quot;, *(&amp;myArray));</code> and <code>printf(&quot;%p\\n&quot;, *(&amp;myArray[0]));</code> for maximum effect, initialise your array: <code>int myArray[10] = { 1,2,3,4,5,6,7,8,9,10 };</code>"}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": true, "score": 8, "last_activity_date": 1568819963, "creation_date": 1568819963, "answer_id": 57996103, "question_id": 57996016, "link": "https://stackoverflow.com/questions/57996016/is-array-name-a-pointer-in-c-language/57996103#57996103", "title": "Is array name a pointer in C language?", "body": "<p><code>&amp;myArray[0]</code> is the address of the first element of the array, <code>&amp;myArray</code> is the address of the array. These must have the same address, but are different types.</p>\n\n<p><code>myArray</code> is <em>not</em> a pointer. It is an array that <em>decays</em> to pointer of type <code>int*</code> under certain instances. Being a parameter of <code>printf</code> is such an instance.</p>\n"}], "owner": {"reputation": 125, "user_id": 9405224, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Max", "link": "https://stackoverflow.com/users/9405224/max"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 2, "closed_date": 1568820215, "accepted_answer_id": 57996103, "answer_count": 1, "score": 5, "last_activity_date": 1568820225, "creation_date": 1568819639, "question_id": 57996016, "link": "https://stackoverflow.com/questions/57996016/is-array-name-a-pointer-in-c-language", "closed_reason": "Duplicate", "title": "Is array name a pointer in C language?", "body": "<p>I know that a pointer in C language is a variable that holds an address.\nfor example:</p>\n\n<pre><code>int myVar;\nint *p;\np = &amp;myVar;\nprintf(\"%p\\n\", p);\nprintf(\"%p\\n\", &amp;p);\n</code></pre>\n\n<p>The output will be two different addresses, the first one is the address of myVar and the second one is the address of the pointer itself which means a pointer is a variable also and have an address in memory (Correct me if I'm wrong)</p>\n\n<p>But my question is about arrays, for example we have this code:</p>\n\n<pre><code>int myArray[10];\n</code></pre>\n\n<p>so here I thought myArray is a pointer also that holding the address of the starting point of myArray which in this case is myArray[0], so when I print address of myArray[0] and myArray I get same result:</p>\n\n<pre><code>printf(\"%p\\n\", &amp;myArray[0]);\nprintf(\"%p\\n\", myArray);\n</code></pre>\n\n<p>Now the confusing part for me is here when I try to print the address of myArray itself:</p>\n\n<pre><code>printf(\"%p\\n\", &amp;myArray);\n</code></pre>\n\n<p>Here I get the same results I was expecting to get another address like pointers.Is myArray a \nlabel or something?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 26680, "user_id": 1806780, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/NCB41.jpg?s=128&g=1", "display_name": "Sami Kuhmonen", "link": "https://stackoverflow.com/users/1806780/sami-kuhmonen"}, "edited": false, "score": 2, "creation_date": 1568819158, "post_id": 57995781, "comment_id": 102398142, "body": "Please explain what \u201cdoes not work properly\u201d means here. What does it do? What should it do?"}, {"owner": {"reputation": 1, "user_id": 12085828, "user_type": "registered", "profile_image": "https://graph.facebook.com/2477469705609585/picture?type=large", "display_name": "Ortal Cohen", "link": "https://stackoverflow.com/users/12085828/ortal-cohen"}, "reply_to_user": {"reputation": 26680, "user_id": 1806780, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/NCB41.jpg?s=128&g=1", "display_name": "Sami Kuhmonen", "link": "https://stackoverflow.com/users/1806780/sami-kuhmonen"}, "edited": false, "score": 0, "creation_date": 1568819709, "post_id": 57995781, "comment_id": 102398463, "body": "I get this error:      Unhandled exception at 0x77A56015 (ntdll.dll) in ProjectSummer2019.exe: 0xC0000005: Access violation writing location 0x00000027."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1568820594, "post_id": 57995781, "comment_id": 102398967, "body": "Does it crash if you comment out the call to <code>fwrite</code>? If not, I suspect that <code>fp</code> is a null pointer returned by <code>fopen</code> due to an error opening the file."}, {"owner": {"reputation": 1, "user_id": 12085828, "user_type": "registered", "profile_image": "https://graph.facebook.com/2477469705609585/picture?type=large", "display_name": "Ortal Cohen", "link": "https://stackoverflow.com/users/12085828/ortal-cohen"}, "edited": false, "score": 0, "creation_date": 1568821062, "post_id": 57995781, "comment_id": 102399246, "body": "we have a function called checkFile that checks if the file opened succsesfully . Do you have any sugestions?"}, {"owner": {"reputation": 26680, "user_id": 1806780, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/NCB41.jpg?s=128&g=1", "display_name": "Sami Kuhmonen", "link": "https://stackoverflow.com/users/1806780/sami-kuhmonen"}, "edited": false, "score": 0, "creation_date": 1568821769, "post_id": 57995781, "comment_id": 102399653, "body": "Debug line by line and check the variables and see exactly where it crashes and why first"}, {"owner": {"reputation": 420, "user_id": 11984497, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wObKM.png?s=128&g=1", "display_name": "LTPCGO", "link": "https://stackoverflow.com/users/11984497/ltpcgo"}, "edited": false, "score": 0, "creation_date": 1568825684, "post_id": 57995781, "comment_id": 102401399, "body": "How do you open <code>fp</code> and call the function <code>insertBySize</code>?"}], "owner": {"reputation": 1, "user_id": 12085828, "user_type": "registered", "profile_image": "https://graph.facebook.com/2477469705609585/picture?type=large", "display_name": "Ortal Cohen", "link": "https://stackoverflow.com/users/12085828/ortal-cohen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1568818938, "creation_date": 1568818869, "last_edit_date": 1568818938, "question_id": 57995781, "link": "https://stackoverflow.com/questions/57995781/problems-with-fwrite-file-io", "title": "problems with fwrite/ file IO", "body": "<p>for some reason fwrite does not work properly . can please someone help me to understand why ?</p>\n\n<pre><code>void insertBySize(int objectSize, unsigned char* buffer, int*kamaNish, unsigned char ch, FILE* fp)\n//function that compress and writes to file charecters by their destined size.\n{\n    unsigned char leftOvers = 0;//a second buffer that will contain bits in case we need to write just part of byte to buffer.\n    unsigned int counterLeftOver;// will tell us how many bits we keep aside.\n    unsigned char mask;//mask that will help us to keep the left bits and put them aside.\n    if (objectSize &gt;= *kamaNish)//if the size of the object is bigger or equal to the number bits that remain to put in buffer.\n    {\n        counterLeftOver = objectSize - *kamaNish;// tell us how many bits we keep aside.\n        mask = createBottomBitsLitMask(counterLeftOver);//creates mask with \"counterLeftOver\" bottom bits lit up.\n        leftOvers = (mask&amp;ch) &lt;&lt; SIZE_OF_BYTE - counterLeftOver;//puts the remain bits in leftOver adjacent to the left.\n        ch = ch &gt;&gt; counterLeftOver;//\"drop\" the saved bits.\n        *buffer |= ch;//filling the buffer to full capacity.\n        fwrite(buffer, sizeof(unsigned char), 1, fp);//write the buffer to file.  /////DOES NOT WORK!!!!\n        *buffer = leftOvers;//puts the remains of the previous char in buffer.\n        *kamaNish = SIZE_OF_BYTE - counterLeftOver;//update the number bits that remain to put in buffer.\n    }\n    else\n    {\n        ch = ch &lt;&lt; ((*kamaNish) - objectSize);//puts the leading bit \"under\" the first place for insertion to buffer.\n        *buffer |= ch;//insert it.\n        *kamaNish = *kamaNish - objectSize;////update the number bits that remain to put in buffer.\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "sockets", "bluetooth", "iot"], "comments": [{"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 1, "creation_date": 1568847379, "post_id": 57995766, "comment_id": 102409002, "body": "This is not your app&#39;s responsibility to manage, it is the OS&#39;s responsibility. If the device establishes a Bluetooth gateway session with the server, then your app should be able to create a standard TCP/IP or UDP socket and transmit data over it, letting the device&#39;s OS route the data over the Bluetooth connection and the server route the data over the Internet. Your app should not care HOW it is connected to the Internet, only that it is. That is the whole point of network routing and transport providers."}, {"owner": {"reputation": 99, "user_id": 4633702, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88aa9dd3a7de72562c7d2631250992eb?s=128&d=identicon&r=PG&f=1", "display_name": "Tohkai", "link": "https://stackoverflow.com/users/4633702/tohkai"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1569220369, "post_id": 57995766, "comment_id": 102510825, "body": "understood, thanks."}, {"owner": {"reputation": 160, "user_id": 980268, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/738f66fbb23d5a23544df56e32dcddc8?s=128&d=identicon&r=PG", "display_name": "Manivannan Radhakannan", "link": "https://stackoverflow.com/users/980268/manivannan-radhakannan"}, "edited": false, "score": 0, "creation_date": 1569570991, "post_id": 57995766, "comment_id": 102647495, "body": "Bluetooth host stacks supports , Personal Area Networking(PAN) profile. The profile exactly does , what is mentioned in your question. If Bluetooth PAN profile is supported in your gateway device, you can complete the task with ease."}], "owner": {"reputation": 99, "user_id": 4633702, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88aa9dd3a7de72562c7d2631250992eb?s=128&d=identicon&r=PG&f=1", "display_name": "Tohkai", "link": "https://stackoverflow.com/users/4633702/tohkai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 75, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1568818810, "creation_date": 1568818810, "question_id": 57995766, "link": "https://stackoverflow.com/questions/57995766/is-it-possible-to-open-a-c-socket-to-an-internet-address-through-bluetooth", "title": "Is it possible to open a C socket to an internet address through bluetooth", "body": "<p>I am asked to connect my device to a server via a bluetooth connexion, such as an android tablet that gives an internet access via bluetooth.</p>\n\n<p>The software on my device is entirely C, and the device runs a debian.</p>\n\n<p>I know how to use regular network sockets, and how to use bluetooth sockets, which is practically the same.</p>\n\n<p>but I have strictly no idea how I could use some sort of bluetooth gateway to access the internet, IE what if I want to write on a socket that's open with a distant server over the internet... through a bluetooth socket? As far as I'm concerned, the bluetooth sockets I open are strictly reserved to the machine I am in direct connexion with.</p>\n\n<p>An  application on the side of the android/ios device is apparently out of question.</p>\n\n<p>Is this actually possible, and if yes, where should I look?</p>\n"}, {"tags": ["c", "macos", "gdb", "eclipse-cdt"], "comments": [{"owner": {"reputation": 115642, "user_id": 299924, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/71fc84230717311db1410d7106273128?s=128&d=identicon&r=PG", "display_name": "trojanfoe", "link": "https://stackoverflow.com/users/299924/trojanfoe"}, "edited": false, "score": 0, "creation_date": 1568878287, "post_id": 57995639, "comment_id": 102416571, "body": "Why are you starting out programming using these obsolete tools?  Why not use Xcode?"}, {"owner": {"reputation": 6534, "user_id": 1202172, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8587094fc4666bee5d5852f163e6f86b?s=128&d=identicon&r=PG", "display_name": "Danijel", "link": "https://stackoverflow.com/users/1202172/danijel"}, "reply_to_user": {"reputation": 115642, "user_id": 299924, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/71fc84230717311db1410d7106273128?s=128&d=identicon&r=PG", "display_name": "trojanfoe", "link": "https://stackoverflow.com/users/299924/trojanfoe"}, "edited": false, "score": 0, "creation_date": 1568879663, "post_id": 57995639, "comment_id": 102417282, "body": "@trojanfoe Because I just came from Windows where I used Eclipse. And because soon I will be targeting fixed-point DSP platforms. Does that make sense?"}, {"owner": {"reputation": 115642, "user_id": 299924, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/71fc84230717311db1410d7106273128?s=128&d=identicon&r=PG", "display_name": "trojanfoe", "link": "https://stackoverflow.com/users/299924/trojanfoe"}, "edited": false, "score": 0, "creation_date": 1568881176, "post_id": 57995639, "comment_id": 102417977, "body": "You wrote C on Windows using Eclipse CDT?"}, {"owner": {"reputation": 6534, "user_id": 1202172, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8587094fc4666bee5d5852f163e6f86b?s=128&d=identicon&r=PG", "display_name": "Danijel", "link": "https://stackoverflow.com/users/1202172/danijel"}, "reply_to_user": {"reputation": 115642, "user_id": 299924, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/71fc84230717311db1410d7106273128?s=128&d=identicon&r=PG", "display_name": "trojanfoe", "link": "https://stackoverflow.com/users/299924/trojanfoe"}, "edited": false, "score": 0, "creation_date": 1568882397, "post_id": 57995639, "comment_id": 102418593, "body": "Yes, and it worked nice."}, {"owner": {"reputation": 115642, "user_id": 299924, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/71fc84230717311db1410d7106273128?s=128&d=identicon&r=PG", "display_name": "trojanfoe", "link": "https://stackoverflow.com/users/299924/trojanfoe"}, "edited": false, "score": 0, "creation_date": 1568886562, "post_id": 57995639, "comment_id": 102420871, "body": "There are better tools available to developers on both Windows and macOS which are more modern, more popular and better supported.  Getting answers to issues with those tools is much easier.  You seem to have chosen a very difficult path for yourself for some reason.  But good luck I guess."}], "owner": {"reputation": 6534, "user_id": 1202172, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8587094fc4666bee5d5852f163e6f86b?s=128&d=identicon&r=PG", "display_name": "Danijel", "link": "https://stackoverflow.com/users/1202172/danijel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1570695917, "creation_date": 1568818405, "last_edit_date": 1570695917, "question_id": 57995639, "link": "https://stackoverflow.com/questions/57995639/osx-eclipse-cdt-stalls-at-the-start-of-debugging-configuring-gdb", "title": "OSX Eclipse CDT stalls at the start of debugging: &quot;Configuring GDB&quot;", "body": "<p>I have installed Eclipse CDT and GDB.<br>\nI created a simple \"Hello World\" C project. </p>\n\n<p>When I try to debug the project, GDB starts to behave very chaotic: I am able to debug a few times, step through the code, etc., but then it starts stalling at the begining of the next debug session with the message \"Configuring GDB\".  </p>\n\n<p>After I restart Eclipse CDT sometimes I still cannot debug, and sometimes I can, but also just for a few times, and then again the same problem comes up: stalls with \"Configuring GDB\" message. </p>\n\n<p>I have tried hard to find the pattern, but failed. </p>\n\n<p>What could be the reason for such a chaotic behaviour? </p>\n\n<p>p.s.\nI forgot to mention that I did sign the <code>/usr/local/bin/gdb</code> executable (and verified it with <code>codesign --verify --verbose gdb</code>).</p>\n\n<p><strong>Edit:</strong>\nThe screenshot shows the 2 stuck sessions: </p>\n\n<p><a href=\"https://i.stack.imgur.com/5g5F9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5g5F9.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c", "memory", "binary", "char", "valgrind"], "comments": [{"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1568857632, "post_id": 57995495, "comment_id": 102410800, "body": "the posted code does not compile!  Amongst other things, it is missing the needed <code>#include</code> statements for <code>string.h</code>  and <code>stdlib.h</code>  and <code>stdio.h</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1568857826, "post_id": 57995495, "comment_id": 102410838, "body": "OT: regarding the statements: <code>char* res= (char*) malloc(zeroManquant*sizeof(char));</code> and  <code>char* str = (char*) malloc(sizeof(char)*8);</code>  1) the returned type is <code>void*</code> which can be assigned to any pointer.  Casting just clutters the code, making it more difficult to understand, debug, etc.  Suggest removing the cast.  2)  the expression <code>sizeof( char)</code> is defined in the standard as 1.  Multiplying the parameter by 1 has absolutely no effect.  Suggest removing that expression.  3) always check (!=NULL) the returned value to assure the operation was successful"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1568857921, "post_id": 57995495, "comment_id": 102410848, "body": "regarding: <code>int main(int argc, char const argv[]) {</code>  Since neither of the parameters are used, the compiler will output two warnings messages about the unused parameters.  suggest using the signature: <code>int main( void )</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1568858401, "post_id": 57995495, "comment_id": 102410930, "body": "in function: <code>main()</code> this statement: <code>char binaire = tab_binaire(12);</code>  The function: <code>tab_binaire()</code> returns a pointer to char, not a char, so this statement does not compile.  When compiling, always enable the warnings, then fix those warnings.  ( for <code>gcc</code>, at a minimum use: <code>-Wall -Wextra -Wconversion -pedantic -std=gnu11</code> )  Note: other compilers use different options to get the same results"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1568858623, "post_id": 57995495, "comment_id": 102410963, "body": "OT:  the posted code only contains less than 30 lines, however; the messages from valgrind are indicating statements in the range 140, 145, 161.  Please post the actual code that is causing the problems.  In general, post messages for the code that you have compiled"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1568858830, "post_id": 57995495, "comment_id": 102411001, "body": "regarding: <code>int zeroManquant = 8-strlen(str);V</code>  That trailing <code>V</code> does not compile.  BTW: how do you know that the length of the string <code>str</code> is &gt;= 8?"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1568859041, "post_id": 57995495, "comment_id": 102411028, "body": "the posted code passed the <code>malloc</code>d memory <code>str</code> to free(), but fails to pass the <code>res</code> to free()`.  The result is a unrecoverable memory leak"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1568859129, "post_id": 57995495, "comment_id": 102411051, "body": "the posted code calls the function: <code>liberer_binaire(binaire);</code>, but you have not posted the contents of that function."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 11318075, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-AtXOxd2chUE/AAAAAAAAAAI/AAAAAAAAAB4/ErRqDN4STyI/photo.jpg?sz=128", "display_name": "Tom Ribardiere", "link": "https://stackoverflow.com/users/11318075/tom-ribardiere"}, "edited": false, "score": 0, "creation_date": 1568819572, "post_id": 57995866, "comment_id": 102398386, "body": "Thanks but I don&#39;t want to add in res the end string character I really want to add the &#39;0&#39; character to put the string in a normalized format in 8 bits"}, {"owner": {"reputation": 755, "user_id": 11699772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd368b24a3051afd4ebf0196148b6e11?s=128&d=identicon&r=PG&f=1", "display_name": "XBlueCode", "link": "https://stackoverflow.com/users/11699772/xbluecode"}, "reply_to_user": {"reputation": 25, "user_id": 11318075, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-AtXOxd2chUE/AAAAAAAAAAI/AAAAAAAAAB4/ErRqDN4STyI/photo.jpg?sz=128", "display_name": "Tom Ribardiere", "link": "https://stackoverflow.com/users/11318075/tom-ribardiere"}, "edited": false, "score": 0, "creation_date": 1568819705, "post_id": 57995866, "comment_id": 102398459, "body": "@TomRibardiere, Ah you didn&#39;t mention that before, but can you try the updated answer, it&#39;s supposed to work as you expect it now."}, {"owner": {"reputation": 25, "user_id": 11318075, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-AtXOxd2chUE/AAAAAAAAAAI/AAAAAAAAAB4/ErRqDN4STyI/photo.jpg?sz=128", "display_name": "Tom Ribardiere", "link": "https://stackoverflow.com/users/11318075/tom-ribardiere"}, "edited": false, "score": 0, "creation_date": 1568819952, "post_id": 57995866, "comment_id": 102398577, "body": "Yes now the binary number is in the good format but I have always the same valgrind errors"}, {"owner": {"reputation": 755, "user_id": 11699772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd368b24a3051afd4ebf0196148b6e11?s=128&d=identicon&r=PG&f=1", "display_name": "XBlueCode", "link": "https://stackoverflow.com/users/11699772/xbluecode"}, "reply_to_user": {"reputation": 25, "user_id": 11318075, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-AtXOxd2chUE/AAAAAAAAAAI/AAAAAAAAAB4/ErRqDN4STyI/photo.jpg?sz=128", "display_name": "Tom Ribardiere", "link": "https://stackoverflow.com/users/11318075/tom-ribardiere"}, "edited": false, "score": 0, "creation_date": 1568820610, "post_id": 57995866, "comment_id": 102398980, "body": "ah, that&#39;s come from <code>malloc(zeroManquant*sizeof(char));</code> try change it to <code>malloc(9 * sizeof(char));</code>"}, {"owner": {"reputation": 25, "user_id": 11318075, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-AtXOxd2chUE/AAAAAAAAAAI/AAAAAAAAAB4/ErRqDN4STyI/photo.jpg?sz=128", "display_name": "Tom Ribardiere", "link": "https://stackoverflow.com/users/11318075/tom-ribardiere"}, "edited": false, "score": 0, "creation_date": 1568820830, "post_id": 57995866, "comment_id": 102399107, "body": "It settle a lot of error but i have always one.<code>==15275== Invalid write of size 1 ==15275==    at 0x483B94F: strcat (in &#47;usr&#47;lib&#47;x86_64-linux-gnu&#47;valgrind&#47;vgpreload_memcheck-amd64-&zwnj;&#8203;linux.so)  ==15275==    by 0x1097D0: tab_binaire (automate.c:146) ==15275==    by 0x10984C: main (automate.c:163) ==15275==  Address 0x4a54ae8 is 0 bytes after a block of size 8 alloc&#39;d ==15275==    at 0x483874F: malloc (in &#47;usr&#47;lib&#47;x86_64-linux-gnu&#47;valgrind&#47;vgpreload_memcheck-amd64-&zwnj;&#8203;linux.so) ==15275==    by 0x109784: tab_binaire (automate.c:140) ==15275==    by 0x10984C: main (automate.c:163)</code>"}, {"owner": {"reputation": 755, "user_id": 11699772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd368b24a3051afd4ebf0196148b6e11?s=128&d=identicon&r=PG&f=1", "display_name": "XBlueCode", "link": "https://stackoverflow.com/users/11699772/xbluecode"}, "reply_to_user": {"reputation": 25, "user_id": 11318075, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-AtXOxd2chUE/AAAAAAAAAAI/AAAAAAAAAB4/ErRqDN4STyI/photo.jpg?sz=128", "display_name": "Tom Ribardiere", "link": "https://stackoverflow.com/users/11318075/tom-ribardiere"}, "edited": false, "score": 0, "creation_date": 1568821301, "post_id": 57995866, "comment_id": 102399378, "body": "Did you try to add more length to in <code>malloc</code> for <code>res</code> ? char* res= (char*) malloc(10 * sizeof(char));"}, {"owner": {"reputation": 25, "user_id": 11318075, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-AtXOxd2chUE/AAAAAAAAAAI/AAAAAAAAAB4/ErRqDN4STyI/photo.jpg?sz=128", "display_name": "Tom Ribardiere", "link": "https://stackoverflow.com/users/11318075/tom-ribardiere"}, "edited": false, "score": 0, "creation_date": 1568821537, "post_id": 57995866, "comment_id": 102399518, "body": "yes it solve the error but can you explain me how ?"}, {"owner": {"reputation": 755, "user_id": 11699772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd368b24a3051afd4ebf0196148b6e11?s=128&d=identicon&r=PG&f=1", "display_name": "XBlueCode", "link": "https://stackoverflow.com/users/11699772/xbluecode"}, "reply_to_user": {"reputation": 25, "user_id": 11318075, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-AtXOxd2chUE/AAAAAAAAAAI/AAAAAAAAAB4/ErRqDN4STyI/photo.jpg?sz=128", "display_name": "Tom Ribardiere", "link": "https://stackoverflow.com/users/11318075/tom-ribardiere"}, "edited": false, "score": 2, "creation_date": 1568821823, "post_id": 57995866, "comment_id": 102399689, "body": "The problem was that the memory location that the <code>strcat</code> was trying to write in is outside of the memory addresses allocated for that process. in other word, You didn&#39;t allocate enough memory for the whole string in addition to the terminating null char <code>&#39;\\0&#39;</code>"}], "tags": [], "owner": {"reputation": 755, "user_id": 11699772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd368b24a3051afd4ebf0196148b6e11?s=128&d=identicon&r=PG&f=1", "display_name": "XBlueCode", "link": "https://stackoverflow.com/users/11699772/xbluecode"}, "is_accepted": true, "score": 1, "last_activity_date": 1568821949, "last_edit_date": 1568821949, "creation_date": 1568819150, "answer_id": 57995866, "question_id": 57995495, "link": "https://stackoverflow.com/questions/57995495/write-and-read-errors-with-valgrind/57995866#57995866", "title": "Write and read errors with Valgrind", "body": "<p>Try the following adjustments (You had some problems in your code):</p>\n\n<pre><code>unsigned int_to_int(unsigned k);\nchar* tab_binaire(int nb);\nunsigned int_to_int(unsigned k) {\n    if (k == 0) return 0;\n    if (k == 1) return 1;                       /* optional */\n    return (k % 2) + 10 * int_to_int(k / 2);\n}\n\nchar* tab_binaire(int nb){\n    char* str = (char*) malloc(sizeof(char) * 9);\n    sprintf(str, \"%d\", int_to_int(nb));\n    int zeroManquant = 8 - strlen(str);\n    char* res= (char*) malloc(9 * sizeof(char));\n    int i;\n    for (i = 0; i &lt; zeroManquant; i++) {\n        res[i]='0';\n    }\n    res[i] = '\\0';\n    strcat(res,str);\n    free(str);\n    str=NULL;\n    return res;\n}\n\nint main(int argc, char const argv[]) { \n    char *binaire = tab_binaire(12); \n    printf(\"%s\\n\", binaire );\n    free(binaire);\n    //liberer_binaire(binaire); \n    return 0; \n    }\n</code></pre>\n\n<p>The <em>valgrind</em> errors above means that you're trying to access memory (<em>read</em> or <em>write</em>) which is out of the area allocated for the variables.</p>\n\n<p>After filling the start of the string <code>res</code> by <code>'0'</code> using the <code>for</code> loop, you needed to put the null character <code>'\\0'</code> at the end so the <code>strcat</code> copy the second string from this position.</p>\n\n<p>At this point:</p>\n\n<pre><code>char binaire = tab_binaire(12); \n</code></pre>\n\n<p>You were assigning a pointer to char so you had types conflict, it's simply fixed as follows:</p>\n\n<pre><code>char *binaire = tab_binaire(12); \n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 11318075, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-AtXOxd2chUE/AAAAAAAAAAI/AAAAAAAAAB4/ErRqDN4STyI/photo.jpg?sz=128", "display_name": "Tom Ribardiere", "link": "https://stackoverflow.com/users/11318075/tom-ribardiere"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 57995866, "answer_count": 1, "score": 1, "last_activity_date": 1568821949, "creation_date": 1568817932, "last_edit_date": 1568818559, "question_id": 57995495, "link": "https://stackoverflow.com/questions/57995495/write-and-read-errors-with-valgrind", "title": "Write and read errors with Valgrind", "body": "<p>I try to convert a integer in a binary format and I want the result in a char*, so I have this code :</p>\n\n<pre><code>unsigned int_to_int(unsigned k) {\n    if (k == 0) return 0;\n    if (k == 1) return 1;                       /* optional */\n    return (k % 2) + 10 * int_to_int(k / 2);\n}\n\nchar* tab_binaire(int nb){\n    char* str = (char*) malloc(sizeof(char)*8);\n    sprintf(str, \"%d\", int_to_int(nb));\n    int zeroManquant = 8-strlen(str);V\n    char* res= (char*) malloc(zeroManquant*sizeof(char));\n    for (int i = 0; i &lt; zeroManquant; i++) {\n        res[i]='0';\n    }\n    strcat(res,str);\n    free(str);\n    str=NULL;\n    return res;\n}\n</code></pre>\n\n<p>I already try to put the exit character at the end of the string but I always put the errors.\nHere are my errors :</p>\n\n<pre><code>==10789== Invalid read of size 1\n==10789==    at 0x483B924: strcat (in /usr/lib/x86_64-linux-gnu/valgrind/vgpreload_memcheck-amd64-linux.so)\n==10789==    by 0x1097C3: tab_binaire (automate.c:145)\n==10789==    by 0x10983F: main (automate.c:161)\n==10789==  Address 0x4a54ae4 is 0 bytes after a block of size 4 alloc'd\n==10789==    at 0x483874F: malloc (in /usr/lib/x86_64-linux-gnu/valgrind/vgpreload_memcheck-amd64-linux.so)\n==10789==    by 0x109787: tab_binaire (automate.c:140)\n==10789==    by 0x10983F: main (automate.c:161)\n\n==10789==\n==10789== Invalid write of size 1\n==10789==    at 0x483B940: strcat (in /usr/lib/x86_64-linux-gnu/valgrind/vgpreload_memcheck-amd64-linux.so)\n==10789==    by 0x1097C3: tab_binaire (automate.c:145)\n==10789==    by 0x10983F: main (automate.c:161)\n==10789==  Address 0x4a54ae4 is 0 bytes after a block of size 4 alloc'd\n==10789==    at 0x483874F: malloc (in /usr/lib/x86_64-linux-gnu/valgrind/vgpreload_memcheck-amd64-linux.so)\n==10789==    by 0x109787: tab_binaire (automate.c:140)\n==10789==    by 0x10983F: main (automate.c:161)\n==10789==\n==10789== Invalid write of size 1\n==10789==    at 0x483B94F: strcat (in /usr/lib/x86_64-linux-gnu/valgrind/vgpreload_memcheck-amd64-linux.so)\n==10789==    by 0x1097C3: tab_binaire (automate.c:145)\n==10789==    by 0x10983F: main (automate.c:161)\n==10789==  Address 0x4a54ae8 is 4 bytes after a block of size 4 alloc'd\n==10789==    at 0x483874F: malloc (in /usr/lib/x86_64-linux-gnu/valgrind/vgpreload_memcheck-amd64-linux.so)\n==10789==    by 0x109787: tab_binaire (automate.c:140)\n==10789==    by 0x10983F: main (automate.c:161)\n</code></pre>\n\n<p><strong>Here is my main()...</strong></p>\n\n<pre class=\"lang-c prettyprint-override\"><code> int main(int argc, char const argv[]) { \n    char binaire = tab_binaire(12); \n    printf(\"%s\\n\", binaire ); \n    liberer_binaire(binaire); \n    return 0; \n    }\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1568815974, "post_id": 57994788, "comment_id": 102396145, "body": "<a href=\"https://stackoverflow.com/q/940087/995714\">You must use <code>%zu</code> to print the result of <code>sizeof</code></a>"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 1, "creation_date": 1568816339, "post_id": 57994788, "comment_id": 102396374, "body": "Why would you expect three bytes of padding between <code>zip</code> and <code>state</code>? <code>zip</code> is a <code>uint8_t</code>, so it is only one byte and should not need additional alignment. <code>state</code> is an array of <code>uint16_t</code>, which is two bytes, so, if it needs alignment, two-byte alignment is usually sufficient. (Alignment depends on the platform or C implementation.) To get two-byte alignment, you only need one byte of padding, not three."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 3, "creation_date": 1568816437, "post_id": 57994788, "comment_id": 102396440, "body": "When doing experiments like this, do not create an array of <code>uint8_t</code> like <code>buf</code> and then reinterpret it as a <code>struct</code> using <code>(address *) buf</code>. Instead, create a <code>struct</code>, as with the definition <code>address X;</code>, and then use <code>memcpy(&amp;X, buf, sizeof X);</code> to get the bytes into it. Writing the bytes into an existing structure this way is supported by the C standard. Reinterpreting possibly misaligned bytes of a buffer like <code>buf</code> as a <code>struct</code> is not supported by the C standard. (Another supported method is to put both the <code>address</code> struct and the <code>buf</code> array as members in a union.)"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1568816708, "post_id": 57994788, "comment_id": 102396602, "body": "Side comment: Are you asking because (a) you&#39;re curious or (b) you&#39;ve been tasked with writing a structure definition which matches an externally-imposed storage layout or (c) you&#39;ve gotten the impression that struct padding is a generally important thing to know about?  If (a), fine.  If (b), you have my sympathies -- this is a popular but (IMO) misguided exercise.  Finally, if (c), maybe just don&#39;t worry about it!  IMO, padding is <i>not</i> generally important to know about.  I&#39;ve been programming in C for ~40 years, and in all the work I&#39;ve done, it has almost never been important."}], "answers": [{"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 5, "last_activity_date": 1568816358, "creation_date": 1568816358, "answer_id": 57994971, "question_id": 57994788, "link": "https://stackoverflow.com/questions/57994788/understanding-padding-in-structure/57994971#57994971", "title": "Understanding padding in structure", "body": "<p>Padding is typically based on the <strong>base type</strong> of each of its members.</p>\n\n<p>The member <code>state</code> is an array of <code>uint16_t</code>, so this field is aligned on a 2 byte boundary even though the entire array is 4 bytes.  What's important is that each member of the array is correctly aligned.  So there is 1 byte of padding after <code>zip</code> to align <code>state</code> and <code>state</code> starts at offset 2.</p>\n\n<p>After that the next available offset is 6 so two more padding bytes are needed for <code>country</code> to be aligned on a 4 byte boundary.  So then the offset of <code>country</code> is 8.</p>\n\n<p>So now the structure looks like this:</p>\n\n<pre><code>typedef struct\n{\n    uint8_t zip;         // offset 0\n    // 1 byte padding\n    uint16_t state[2];   // offset 2\n    // 2 bytes padding\n    uint32_t country;    // offset 8\n} address;\n</code></pre>\n\n<p>For more details on how padding is usually implemented, see <a href=\"http://www.catb.org/esr/structure-packing/\" rel=\"noreferrer\">this guide</a>.</p>\n"}], "owner": {"reputation": 1537, "user_id": 968000, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/tU8sw.jpg?s=128&g=1", "display_name": "user968000", "link": "https://stackoverflow.com/users/968000/user968000"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "accepted_answer_id": 57994971, "answer_count": 1, "score": 2, "last_activity_date": 1568816358, "creation_date": 1568815873, "question_id": 57994788, "link": "https://stackoverflow.com/questions/57994788/understanding-padding-in-structure", "title": "Understanding padding in structure", "body": "<p>To understand more about padding I created this structure. Why is the output of state 0x1413 and not 0x1615. I am expecting compiler will pad 3 bytes after zip and should give output as 0x1615.</p>\n\n<pre><code>typedef struct\n{\n    uint8_t zip; // I am assuming 3 bytes will be padded after this.\n    uint16_t state[2]; // 4 bytes\n    uint32_t country; //4 bytes\n} address;\n\nint main()\n{\n    uint8_t buf[] = {0x11, 0x12, 0x13, 0X14, 0x15, 0x16,0x17, 0x18, 0x09, 0x0A, 0x0B, 0x0C, 0X0D, 0x0E, 0x0F};\n    address *val;\n    val = (address*)buf;\n    printf(\"size of address %lu \\n\",sizeof(address));\n    printf(\"zip 0x%0x \\n\",val-&gt;zip);\n    printf(\"state0 0x%0x state1 0x%0x \\n\",val-&gt;state[0],val-&gt;state[1]);\n    printf(\"country 0x%0x \\n\",val-&gt;country);\n}\n</code></pre>\n\n<p>Output is:</p>\n\n<pre><code>./a.out\nsize of address 12 \nzip 0x11 \nstate0 0x1413 state1 0x1615 \n</code></pre>\n"}, {"tags": ["python", "c", "python-3.x", "python-embedding"], "owner": {"reputation": 53, "user_id": 12082323, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBM82cIZho9zfyfWu7Wq8R0wavio0i1En3P-5p6vw=k-s128", "display_name": "Justin Moore", "link": "https://stackoverflow.com/users/12082323/justin-moore"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 171, "favorite_count": 2, "answer_count": 0, "score": 5, "last_activity_date": 1572321230, "creation_date": 1568815735, "last_edit_date": 1568815869, "question_id": 57994737, "link": "https://stackoverflow.com/questions/57994737/calling-py-endinterpreter-from-a-c-worker-thread", "title": "Calling Py_EndInterpreter from a C worker thread", "body": "<p>The deprecation of Python's <code>PyEval_ReleaseLock</code> has introduced a problem in our codebase: We want to terminate a Python interpreter from a C callback function using <code>Py_EndInterpreter</code></p>\n\n<p>So to do that, <a href=\"https://docs.python.org/3.7/c-api/init.html#c.Py_EndInterpreter\" rel=\"noreferrer\">Python's Docs</a> say that you must hold the GIL when calling this function:</p>\n\n<blockquote>\n  <p><strong>void Py_EndInterpreter(PyThreadState *tstate)</strong></p>\n  \n  <p>Destroy the (sub-)interpreter represented by the given thread state. The given thread state must be\n  the current thread state. See the discussion of thread states below. When the call returns, the\n  current thread state is NULL. All thread states associated with this interpreter are destroyed. (<strong>The\n  global interpreter lock must be held</strong> before calling this function and is <strong>still held when it returns.</strong>)\n  Py_FinalizeEx() will destroy all sub-interpreters that haven\u2019t been explicitly destroyed at that point.</p>\n</blockquote>\n\n<p>Great! So we call <code>PyEval_RestoreThread</code> to restore our thread state to the thread we're about to terminate, and then call <code>Py_EndInterpreter</code>.</p>\n\n<pre><code>// Acquire the GIL\nPyEval_RestoreThread(thread);\n\n// Tear down the interpreter.\nPy_EndInterpreter(thread);\n\n// Now what? We still hold the GIL and we no longer have a valid thread state.\n// Previously we did PyEval_ReleaseLock here, but that is now deprecated.\n</code></pre>\n\n<p>The documentation for <code>PyEval_ReleaseLock</code> says that we should either use <code>PyEval_SaveThread</code> or <code>PyEval_ReleaseThread</code>.\n<code>PyEval_ReleaseThread</code>'s documentation says that the input thread state must not be NULL. Okay, but we can't pass in the recently deleted thread state.</p>\n\n<p><code>PyEval_SaveThread</code> will hit a debug assertion if you try to call it after calling <code>Py_EndInterpreter</code>, so that's not an option either.</p>\n\n<p>So, we've currently implemented a hack to get around this issue - we save the thread state of the thread that calls <code>Py_InitializeEx</code> in a global variable, and swap to it after calling <code>Py_EndInterpreter</code>.</p>\n\n<pre><code>// Acquire the GIL\nPyEval_RestoreThread(thread);\n\n// Tear down the interpreter.\nPy_EndInterpreter(thread);\n\n// Swap to the main thread state.\nPyThreadState_Swap(g_init.thread_state_);\nPyEval_SaveThread(); // Release the GIL. Probably.\n</code></pre>\n\n<p>What's the proper solution here? It seems that embedded Python is an afterthought for this API.</p>\n\n<p>Similar question: <a href=\"https://stackoverflow.com/questions/15470367\">PyEval_InitThreads in Python 3: How/when to call it? (the saga continues ad nauseam)</a></p>\n"}, {"tags": ["c#", "c", "sharpdx", "direct2d"], "comments": [{"owner": {"reputation": 12051, "user_id": 656243, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/3afyW.png?s=128&g=1", "display_name": "Lynn Crumbling", "link": "https://stackoverflow.com/users/656243/lynn-crumbling"}, "edited": false, "score": 0, "creation_date": 1568815963, "post_id": 57994704, "comment_id": 102396139, "body": "<a href=\"https://docs.microsoft.com/en-us/dotnet/api/system.drawing.drawing2d.pathgradientbrush?view=netframework-4.8\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/dotnet/api/&hellip;</a>"}, {"owner": {"reputation": 57, "user_id": 5925823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/797bac2301023481f4eb2bac0218e399?s=128&d=identicon&r=PG&f=1", "display_name": "Brian E", "link": "https://stackoverflow.com/users/5925823/brian-e"}, "reply_to_user": {"reputation": 12051, "user_id": 656243, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/3afyW.png?s=128&g=1", "display_name": "Lynn Crumbling", "link": "https://stackoverflow.com/users/656243/lynn-crumbling"}, "edited": false, "score": 0, "creation_date": 1568817633, "post_id": 57994704, "comment_id": 102397201, "body": "That appears to be a linear brush.  I am interested in a method similar to a heat map."}, {"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1568818204, "post_id": 57994704, "comment_id": 102397588, "body": "The directx way is to use a <i>shader</i>.  GPUs really like them.  Play with <a href=\"https://github.com/sharpdx/SharpDX-Samples/tree/master/Desktop/Direct3D12/HelloBundles\" rel=\"nofollow noreferrer\">this sample</a> for example."}], "owner": {"reputation": 57, "user_id": 5925823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/797bac2301023481f4eb2bac0218e399?s=128&d=identicon&r=PG&f=1", "display_name": "Brian E", "link": "https://stackoverflow.com/users/5925823/brian-e"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 174, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1568815634, "creation_date": 1568815634, "question_id": 57994704, "link": "https://stackoverflow.com/questions/57994704/is-there-a-c-direct2d-or-sharpdx-equivalent-to-pathgradient-brush", "title": "Is there a C# direct2d or SharpDX equivalent to PathGradient brush?", "body": "<p>Microsoft provided a PathGradient brush in the C programming language.</p>\n\n<p><a href=\"https://docs.microsoft.com/en-us/windows/win32/gdiplus/-gdiplus-creating-a-path-gradient-use\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/windows/win32/gdiplus/-gdiplus-creating-a-path-gradient-use</a></p>\n\n<p>Note that this is not a linear gradient; you can specify the points at which the color shifts.</p>\n\n<p>I have been unable to find an equivalent technique in C# and SharpDX.  Is there one?</p>\n"}, {"tags": ["c", "pointers", "linked-list", "malloc", "singly-linked-list"], "comments": [{"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 3, "creation_date": 1568816076, "post_id": 57994693, "comment_id": 102396201, "body": "If <code>head</code> is not <code>NULL</code>, the <code>else</code> part of the code does <code>temp-&gt;next=new;</code> but <code>temp</code> was initialized to <code>NULL</code> at the top of the function, so this is a <i>null pointer dereference</i>."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1568816141, "post_id": 57994693, "comment_id": 102396237, "body": "Are you trying to insert the new node at the tail end of the list?"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1568816172, "post_id": 57994693, "comment_id": 102396263, "body": "Please indent your code correctly and don&#39;t put a blank line between each and every line."}, {"owner": {"reputation": 13, "user_id": 12085266, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDCL0g6tEVkTlZU05rTClaN8IBWthGQL8p9IUw5=k-s128", "display_name": "Ayush Kumar", "link": "https://stackoverflow.com/users/12085266/ayush-kumar"}, "edited": false, "score": 0, "creation_date": 1568820492, "post_id": 57994693, "comment_id": 102398908, "body": "After entering the if part the temp pointer should point to the first new node created.so when it goes to else part when a second new node is created so I am trying to point the temp to this new node created by temp=new;"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1568821593, "post_id": 57994693, "comment_id": 102399549, "body": "The function will initialize the <code>temp</code> variable to <code>NULL</code> every time the function is called. It does not remember the value of <code>temp</code> from a previous call. The value of <code>head</code> is remembered though, because that variable is external to the function."}, {"owner": {"reputation": 13, "user_id": 12085266, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDCL0g6tEVkTlZU05rTClaN8IBWthGQL8p9IUw5=k-s128", "display_name": "Ayush Kumar", "link": "https://stackoverflow.com/users/12085266/ayush-kumar"}, "edited": false, "score": 0, "creation_date": 1568821707, "post_id": 57994693, "comment_id": 102399617, "body": "Ok thanks for clearing the doubt.\ud83d\udc4d"}], "answers": [{"tags": [], "owner": {"reputation": 362, "user_id": 11936229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11da23565b039811f58b2beecf7493b3?s=128&d=identicon&r=PG&f=1", "display_name": "BTables", "link": "https://stackoverflow.com/users/11936229/btables"}, "is_accepted": false, "score": 1, "last_activity_date": 1568816757, "creation_date": 1568816757, "answer_id": 57995112, "question_id": 57994693, "link": "https://stackoverflow.com/questions/57994693/why-is-a-segmentation-fault-occuring-in-my-code-after-the-first-time-i-insert-an/57995112#57995112", "title": "Why is a segmentation fault occuring in my code after the first time i insert an item in my code", "body": "<p><code>temp->next=new</code> is most likely your problem. At the top of the function you set temp to NULL and by using the <code>-></code> operator, you will be dereferencing a null pointer. </p>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 12085266, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDCL0g6tEVkTlZU05rTClaN8IBWthGQL8p9IUw5=k-s128", "display_name": "Ayush Kumar", "link": "https://stackoverflow.com/users/12085266/ayush-kumar"}, "edited": false, "score": 0, "creation_date": 1568817540, "post_id": 57995191, "comment_id": 102397130, "body": "can you explain how my code is wrong in the else part itself"}, {"owner": {"reputation": 13, "user_id": 12085266, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDCL0g6tEVkTlZU05rTClaN8IBWthGQL8p9IUw5=k-s128", "display_name": "Ayush Kumar", "link": "https://stackoverflow.com/users/12085266/ayush-kumar"}, "edited": false, "score": 0, "creation_date": 1568820783, "post_id": 57995191, "comment_id": 102399085, "body": "So in if part if I have changed head=new; the value of head is still NULL"}], "tags": [], "owner": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "is_accepted": true, "score": 0, "last_activity_date": 1568816983, "creation_date": 1568816983, "answer_id": 57995191, "question_id": 57994693, "link": "https://stackoverflow.com/questions/57994693/why-is-a-segmentation-fault-occuring-in-my-code-after-the-first-time-i-insert-an/57995191#57995191", "title": "Why is a segmentation fault occuring in my code after the first time i insert an item in my code", "body": "<p>The code for the case of <code>head==NULL</code> is OK. But in the <code>else</code> case you need to insert the node correctly.</p>\n\n<p>The code below will insert the node at the end of the list.</p>\n\n<pre><code>void insert(int x)\n{\n    struct node *temp=NULL;\n    struct node *newnode;\n    newnode= malloc(sizeof(struct node));\n    newnode-&gt;data=x;\n    newnode-&gt;next=NULL;\n    if(head==NULL)\n    {\n        head=newnode;\n    }\n    else\n    {\n        temp = head;\n        while (temp-&gt;next != NULL)\n            temp = temp-&gt;next;\n        temp-&gt;next=newnode;\n    }\n}\n</code></pre>\n\n<p>If you want to insert at the beginning of the list, then you need to modify the <code>else</code> condition as shown.</p>\n\n<pre><code>else\n{\n    newnode-&gt;next=head;\n    head = newnode;\n}\n</code></pre>\n\n<p>Also, the following pointers</p>\n\n<ol>\n<li>Avoid use of <code>new</code> as it is a keyword in C++</li>\n<li>Do not cast the result of <code>malloc</code></li>\n</ol>\n"}], "owner": {"reputation": 13, "user_id": 12085266, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDCL0g6tEVkTlZU05rTClaN8IBWthGQL8p9IUw5=k-s128", "display_name": "Ayush Kumar", "link": "https://stackoverflow.com/users/12085266/ayush-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 57995191, "answer_count": 2, "score": 0, "last_activity_date": 1568820524, "creation_date": 1568815614, "last_edit_date": 1568820524, "question_id": 57994693, "link": "https://stackoverflow.com/questions/57994693/why-is-a-segmentation-fault-occuring-in-my-code-after-the-first-time-i-insert-an", "title": "Why is a segmentation fault occuring in my code after the first time i insert an item in my code", "body": "<pre><code> /*Linked list insertin deletion display\n</code></pre>\n\n<p>I have declared a global variable of struct node *head=NULL;</p>\n\n<p>linkedlistlinkedlistlinkedlisr=tlinkedlistlinkedlistlinkedlist</p>\n\n<p>linkedlistlinkedlistlinkedlisr=tlinkedlistlinkedlistlinkedlist</p>\n\n<pre><code>void insert(int x)//i guess the problem might be that temp is pointing to head as well as new  \n{\n    struct node *temp=NULL;\n    struct node *new;\n\n    new=(struct node*)malloc(sizeof(struct node));\n    new-&gt;data=x;\n    new-&gt;next=NULL;\n\n    if(head==NULL)\n    {\n        head=new;\n        temp=head;\n    }\n    else\n    {\n        temp-&gt;next=new;\n        temp=new;\n    }\n}\n</code></pre>\n"}, {"tags": ["python", "c++", "c"], "comments": [{"owner": {"reputation": 96886, "user_id": 2296458, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/wbG2s.png?s=128&g=1", "display_name": "Cory Kramer", "link": "https://stackoverflow.com/users/2296458/cory-kramer"}, "edited": false, "score": 4, "creation_date": 1568815566, "post_id": 57994633, "comment_id": 102395909, "body": "In general, you <i>write</i> the implementation in a single language such as C++. Then you <i>wrap</i> the interface with bindings to other langauges, such as Python. There are a number of tools and libraries to wrap interfaces such as <a href=\"http://www.swig.org/tutorial.html\" rel=\"nofollow noreferrer\">swig</a>"}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1568815595, "post_id": 57994633, "comment_id": 102395922, "body": "<a href=\"https://docs.python.org/3/extending/index.html\" rel=\"nofollow noreferrer\">Extending and Embedding the Python Interpreter</a>"}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1568815788, "post_id": 57994633, "comment_id": 102396042, "body": "Read about creating dynamic or shared libraries.  They can be created in any language and used by any language that can interface with them."}, {"owner": {"reputation": 7540, "user_id": 4474230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/713c7ce18010e541853962264a719d83?s=128&d=identicon&r=PG&f=1", "display_name": "Jeffrey", "link": "https://stackoverflow.com/users/4474230/jeffrey"}, "edited": false, "score": 0, "creation_date": 1568815811, "post_id": 57994633, "comment_id": 102396051, "body": "Highly recommend pybind11"}, {"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 0, "creation_date": 1568815913, "post_id": 57994633, "comment_id": 102396115, "body": "No programming language is well suited to everything.   C and C++ (which are separate languages - there is no such thing as C/C++) are suited well to some tasks, but not others.   Python is better suited to a different set of tasks, and not others.   When the effort of interfacing between code in different languages (say, allowing Python to call a C function) is small compared with the benefits of using each language for tasks they work well for, then an application may well be constructed in multiple languages."}, {"owner": {"reputation": 1481, "user_id": 11915854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34b4ba370c4dc9583ed1de5f778e118b?s=128&d=identicon&r=PG&f=1", "display_name": "Sid", "link": "https://stackoverflow.com/users/11915854/sid"}, "edited": false, "score": 0, "creation_date": 1568816023, "post_id": 57994633, "comment_id": 102396167, "body": "Maybe this will help you - <a href=\"https://stackoverflow.com/questions/145270/calling-c-c-from-python#145649\" title=\"calling c c from python%23145649\">stackoverflow.com/questions/145270/&hellip;</a>"}], "owner": {"reputation": 43, "user_id": 5744053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9874cbe79e777a488cdeb30b41622ae?s=128&d=identicon&r=PG&f=1", "display_name": "Nitin", "link": "https://stackoverflow.com/users/5744053/nitin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 94, "favorite_count": 0, "closed_date": 1568816529, "answer_count": 0, "score": 2, "last_activity_date": 1568815433, "creation_date": 1568815433, "question_id": 57994633, "link": "https://stackoverflow.com/questions/57994633/how-do-you-write-applications-in-multiple-languages", "closed_reason": "Needs more focus", "title": "How do you write applications in multiple languages?", "body": "<p>Sorry guys if this seems like a really basic question. I understand how to build applications using a programming language. Now, I read that tensorflow is written partly in C/C++ and Python. I'm wondering why this is done and how you can get multiple languages to interface with each other.</p>\n"}, {"tags": ["c", "multidimensional-array"], "comments": [{"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 3, "creation_date": 1568814645, "post_id": 57994202, "comment_id": 102395318, "body": "1. Type all them in.  (Tedious, as you said.) 2. Use <code>sed</code> or some other command-line tool to mechanically transform your table into the initializer you needed for (1). 3. Use a search/replace function in your favorite text editor to automate the tedious work in (1). 4. Put the numbers in a file and have the program read them in at run time.  (I have used all four of these techniques; I can&#39;t even say what my &quot;favorite&quot; is.)"}, {"owner": {"reputation": 29, "user_id": 11995026, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd193b7fd7387c1a2d44921ce76378d7?s=128&d=identicon&r=PG&f=1", "display_name": "wolly981", "link": "https://stackoverflow.com/users/11995026/wolly981"}, "reply_to_user": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1568814856, "post_id": 57994202, "comment_id": 102395470, "body": "@Steve Thank you for your clarification"}, {"owner": {"reputation": 3305, "user_id": 1428695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a843c704cdb7e32a93769cddfed4747?s=128&d=identicon&r=PG", "display_name": "yhyrcanus", "link": "https://stackoverflow.com/users/1428695/yhyrcanus"}, "edited": false, "score": 0, "creation_date": 1568815929, "post_id": 57994202, "comment_id": 102396127, "body": "Personally, I typically generate my values in excel and save it as a CSV. Then I open the CSV in Notepad++ and manipulate it from there to be copy/pasteable for code. Here&#39;s an interesting thought: how <i>could</i> someone design it better? I can&#39;t think of a better way, and maybe that means I&#39;m shortsighted."}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1568817441, "post_id": 57994202, "comment_id": 102397059, "body": "What is the largest value you will allow to exist in your array?  eg. the range of values for an <code>int</code> type is -2147483648 to 2147483647.  With commas and braces, and for 35 values, each line will be ~423.  Is this a problem for you?  (<i><a href=\"https://stackoverflow.com/questions/11614687/maximum-length-of-statement-in-c\">Max legal line in C is 4095</a></i>.)"}, {"owner": {"reputation": 29, "user_id": 11995026, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd193b7fd7387c1a2d44921ce76378d7?s=128&d=identicon&r=PG&f=1", "display_name": "wolly981", "link": "https://stackoverflow.com/users/11995026/wolly981"}, "edited": false, "score": 0, "creation_date": 1568820553, "post_id": 57994202, "comment_id": 102398944, "body": "Not a problem, honestly just feeling lazy (or rather didn&#39;t want to type them all in) and was curious if there was a better way to do it. The values are 0 and 1 only. In the end I manually typed it out and stored it in its own file as the answer below has also suggested."}], "answers": [{"comments": [{"owner": {"reputation": 5012, "user_id": 2416647, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f471b80868ae9c93d0903127ed27e2f9?s=128&d=identicon&r=PG", "display_name": "schorsch312", "link": "https://stackoverflow.com/users/2416647/schorsch312"}, "edited": false, "score": 0, "creation_date": 1568818792, "post_id": 57995700, "comment_id": 102397958, "body": "I don&#39;t see the point. It is the same work to type the data in <code>foobar.c</code> or <code>data.h</code>"}, {"owner": {"reputation": 191, "user_id": 7627464, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mD7ok.jpg?s=128&g=1", "display_name": "Togtokh Khorchin", "link": "https://stackoverflow.com/users/7627464/togtokh-khorchin"}, "reply_to_user": {"reputation": 5012, "user_id": 2416647, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f471b80868ae9c93d0903127ed27e2f9?s=128&d=identicon&r=PG", "display_name": "schorsch312", "link": "https://stackoverflow.com/users/2416647/schorsch312"}, "edited": false, "score": 0, "creation_date": 1568819482, "post_id": 57995700, "comment_id": 102398334, "body": "@schorsch312 But the data is stored only in <code>data.h</code>."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1568821477, "post_id": 57995700, "comment_id": 102399486, "body": "And if the numbers of columns and rows do not change, you can even call the file <code>data.tab</code>, and leave out the <code>{</code> and <code>}</code> on each row, that is, have the file contain numbers and commas and newlines only.  This is either a neat hack or a disgusting kludge, depending on your point of view, but it makes the file even easier to prepare.  (Unfortunately, a helpful compiler might warn about the &quot;missing&quot; <code>{}</code>, because most of the time, explicitly including them is the preferred style.)"}], "tags": [], "owner": {"reputation": 191, "user_id": 7627464, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mD7ok.jpg?s=128&g=1", "display_name": "Togtokh Khorchin", "link": "https://stackoverflow.com/users/7627464/togtokh-khorchin"}, "is_accepted": false, "score": 1, "last_activity_date": 1568822195, "last_edit_date": 1568822195, "creation_date": 1568818631, "answer_id": 57995700, "question_id": 57994202, "link": "https://stackoverflow.com/questions/57994202/how-can-i-create-a-large-2d-array-with-set-variables/57995700#57995700", "title": "How can I create a large 2D array with set variables?", "body": "<p>If the numbers of columns and rows, and the elements of the table do not change, you can do this:</p>\n\n<pre><code>// file: foobar.c\nint arr[2][5] = {\n    #include \"data.tab\"\n};\n</code></pre>\n\n<pre><code>// file: data.tab\n{1,0,0,1,1},\n{1,0,1,1,0},\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "is_accepted": true, "score": 1, "last_activity_date": 1568821700, "creation_date": 1568821700, "answer_id": 57996568, "question_id": 57994202, "link": "https://stackoverflow.com/questions/57994202/how-can-i-create-a-large-2d-array-with-set-variables/57996568#57996568", "title": "How can I create a large 2D array with set variables?", "body": "<p>In case you ever want to do it the Option 4 way (as suggested in the comments under your post), here is an implementation that will get you started.  It was written to use command line values for input file (a CSV) and values for rows and cols.  It is partially done allowing you to finish with the final line creation to a header file.</p>\n\n<pre><code>#define DEST \"C:\\\\dir1\\\\desination.h\"\n\nint main(int argc, char *argv[])\n{\n    char *temp = NULL;\n    int rows, cols;\n    char linebuf[500];  //accomodates 35 values (and punctuation) per row\n\n\n    if(argc != 4)\n    {\n        printf(\"Usage *.exe &lt;filespec&gt; &lt;n1&gt; &lt;n2&gt; where n1 &amp; n2 are positive integer values.\\nHit any key to exit\");\n        getchar();\n        return 0;\n    }\n\n    rows = strtol(argv[2], &amp;temp, 10);\n    if (temp == argv[2] || ((rows == LONG_MIN || rows == LONG_MAX) &amp;&amp; errno == ERANGE))\n    {\n        //handle error\n    }\n    cols = strtol(argv[3], &amp;temp, 10);\n   if (temp == argv[3] || ((cols == LONG_MIN || cols == LONG_MAX) &amp;&amp; errno == ERANGE))\n    {\n        //handle error\n    }\n\n    //read in rows*cols values from input file into data[]\n    int data[cols*rows];\n    FILE *fpin = fopen(argv[1], \"r\");\n    if(fpin)\n    {\n\n        char buf[20];\n\n        int i=0;\n\n        //populate\n        while(fgets(buf, 20, fpin) &amp;&amp; (i &lt; rows*cols))\n        {\n            data[i] = strtol(buf, &amp;temp, 10);\n            if (temp == buf || ((data[i] == LONG_MIN || data[i] == LONG_MAX) &amp;&amp; errno == ERANGE))\n            {\n                //handle error\n            }\n            i++;\n\n        }\n\n        fclose(fpin);\n    }\n    FILE *fpout = fopen(DEST, \"w\");\n    if(fpout)\n    {\n        // place first line of array in header file:\n        sprintf(linebuf, \"int array[%d][%d] = {\\n\", rows, cols);\n        fputs(linebuf, fpout);\n        // for you to do, \n        // loop on array data and create \"lines\" with \n        // values, commas and \"{}\" and fputs into fpout\n        // \n    }\n    fclose(fpout); //header file DEST should now be ready to use.\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 11995026, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd193b7fd7387c1a2d44921ce76378d7?s=128&d=identicon&r=PG&f=1", "display_name": "wolly981", "link": "https://stackoverflow.com/users/11995026/wolly981"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "accepted_answer_id": 57996568, "answer_count": 2, "score": 0, "last_activity_date": 1568822195, "creation_date": 1568814210, "question_id": 57994202, "link": "https://stackoverflow.com/questions/57994202/how-can-i-create-a-large-2d-array-with-set-variables", "title": "How can I create a large 2D array with set variables?", "body": "<p>I have a large table of values (35x23 cells) and I need to use them in a C program. I would like to know what is the most efficient way of going about this.</p>\n\n<p>I know that I can manually create a 2D array and put each custom element in as follows:</p>\n\n<pre><code>int arr[2][5] = {\n    {1,0,0,1,1},\n    {1,0,1,1,0}\n  };\n</code></pre>\n\n<p>This would work however it will be very time consuming and messy to create it this way for so many variables in a 35x23 array, so I was wondering if there is a better or more efficient way to do this.</p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["c", "algorithm", "time-complexity"], "comments": [{"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 1, "creation_date": 1568816838, "post_id": 57994039, "comment_id": 102396698, "body": "In the assignment there is written about strings bur your code deals nothing with strings.:)"}, {"owner": {"reputation": 1655, "user_id": 6029128, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/qWL1c.jpg?s=128&g=1", "display_name": "ddon-90", "link": "https://stackoverflow.com/users/6029128/ddon-90"}, "reply_to_user": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1568819517, "post_id": 57994039, "comment_id": 102398357, "body": "Changed the word &quot;string&quot; with &quot;array&quot; and &quot;substring&quot; with &quot;subsequence&quot;."}, {"owner": {"reputation": 947, "user_id": 2498017, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/1126f45702ed17516dde090229f9de74?s=128&d=identicon&r=PG", "display_name": "Richard Barker", "link": "https://stackoverflow.com/users/2498017/richard-barker"}, "reply_to_user": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1568820356, "post_id": 57994039, "comment_id": 102398818, "body": "@vlad, a string is an array."}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 947, "user_id": 2498017, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/1126f45702ed17516dde090229f9de74?s=128&d=identicon&r=PG", "display_name": "Richard Barker", "link": "https://stackoverflow.com/users/2498017/richard-barker"}, "edited": false, "score": 0, "creation_date": 1568820459, "post_id": 57994039, "comment_id": 102398882, "body": "@RichardBarker Strings are not integer arrays."}, {"owner": {"reputation": 947, "user_id": 2498017, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/1126f45702ed17516dde090229f9de74?s=128&d=identicon&r=PG", "display_name": "Richard Barker", "link": "https://stackoverflow.com/users/2498017/richard-barker"}, "reply_to_user": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1568820719, "post_id": 57994039, "comment_id": 102399048, "body": "@Vlad chars are integers."}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 947, "user_id": 2498017, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/1126f45702ed17516dde090229f9de74?s=128&d=identicon&r=PG", "display_name": "Richard Barker", "link": "https://stackoverflow.com/users/2498017/richard-barker"}, "edited": false, "score": 0, "creation_date": 1568820790, "post_id": 57994039, "comment_id": 102399087, "body": "@RichardBarker This has nothing common with strings."}, {"owner": {"reputation": 947, "user_id": 2498017, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/1126f45702ed17516dde090229f9de74?s=128&d=identicon&r=PG", "display_name": "Richard Barker", "link": "https://stackoverflow.com/users/2498017/richard-barker"}, "edited": false, "score": 0, "creation_date": 1568821348, "post_id": 57994039, "comment_id": 102399410, "body": "But it does. Strings are char arrays, chars are integers, therefore a string can be treated as an integer array. I&#39;m not saying it&#39;s wise to do so, I&#39;m just pointing out your initial comment was incorrect. Maybe I want to do math on a letter."}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 947, "user_id": 2498017, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/1126f45702ed17516dde090229f9de74?s=128&d=identicon&r=PG", "display_name": "Richard Barker", "link": "https://stackoverflow.com/users/2498017/richard-barker"}, "edited": false, "score": 0, "creation_date": 1568821554, "post_id": 57994039, "comment_id": 102399529, "body": "@RichardBarker No a string may not be considered as an integer array. You are entirely wrong."}, {"owner": {"reputation": 947, "user_id": 2498017, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/1126f45702ed17516dde090229f9de74?s=128&d=identicon&r=PG", "display_name": "Richard Barker", "link": "https://stackoverflow.com/users/2498017/richard-barker"}, "edited": false, "score": 0, "creation_date": 1568859441, "post_id": 57994039, "comment_id": 102411100, "body": "I&#39;m not wrong but I guess I can&#39;t argue with that."}], "answers": [{"comments": [{"owner": {"reputation": 1655, "user_id": 6029128, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/qWL1c.jpg?s=128&g=1", "display_name": "ddon-90", "link": "https://stackoverflow.com/users/6029128/ddon-90"}, "edited": false, "score": 0, "creation_date": 1568967844, "post_id": 57996339, "comment_id": 102451573, "body": "What&#39;s the time complexity of your algorithm ?"}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 1655, "user_id": 6029128, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/qWL1c.jpg?s=128&g=1", "display_name": "ddon-90", "link": "https://stackoverflow.com/users/6029128/ddon-90"}, "edited": false, "score": 0, "creation_date": 1568971086, "post_id": 57996339, "comment_id": 102453175, "body": "@ElDon90 It is O( n ). You can add a check whether the tail of the array is less than the already found sub-sequence."}], "tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": true, "score": 1, "last_activity_date": 1568885452, "last_edit_date": 1568885452, "creation_date": 1568820761, "answer_id": 57996339, "question_id": 57994039, "link": "https://stackoverflow.com/questions/57994039/find-the-length-of-the-longest-subsequence-containing-a-number-of-consecutive-k/57996339#57996339", "title": "Find the length of the longest subsequence containing a number of consecutive k 0s followed by a number of consecutive k 1s", "body": "<p>A better way is to declare and define the function correctly with a more clear algorithm implementation.</p>\n\n<p>The first parameter shall have the qualifier <code>const</code> and the second parameter shall have the type <code>size_t</code>. And the function return type also shall be <code>size_t</code>.</p>\n\n<p>Within the function you should at first find the first element that is equal to 0 and only after that process the rest part of the array.</p>\n\n<p>I would write the function the following way</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nsize_t longest_subsequence( const int a[], size_t n )\n{\n    const int value1 = 0;\n    const int value2 = 1;\n\n    size_t longest = 0;\n\n    size_t i = 0;\n    while ( i &lt; n &amp;&amp; a[i] != value1 ) i++;\n\n    while ( i &lt; n )\n    {\n\n        size_t n1 = i;\n\n        while ( i &lt; n &amp;&amp; a[i] == value1 ) i++;\n\n        size_t n2 = i;\n\n        while ( i &lt; n &amp;&amp; a[i] == value2 ) i++;\n\n        n1 = n2 - n1;\n        n2 = i - n2;\n\n        n1 = n2 &lt; n1 ? n2 : n1;\n\n        if ( longest &lt; 2 * n1 ) longest = 2 * n1;\n    }\n\n    return longest;\n}\n\nint main(void) \n{\n    int a[] = { 1, 0, 0, 1, 0, 0, 0, 1, 1, 0, 0, 0, 0, 1, 1, 1 };\n    const size_t N = sizeof( a ) / sizeof( *a );\n\n    printf( \"%zu\\n\", longest_subsequence( a, N ) );\n\n    return 0;\n}\n</code></pre>\n\n<p>The program output is</p>\n\n<pre><code>6\n</code></pre>\n\n<p>Indeed the longest sub-sequence of the array is</p>\n\n<pre><code>{ 1, 0, 0, 1, 0, 0, 0, 1, 1, 0, 0, 0, 0, 1, 1, 1 };\n                                ^^^^^^^^^^^^^^^^\n</code></pre>\n\n<p>Or the calculated value can look like</p>\n\n<pre><code>if ( longest &lt; n1 ) longest = n1;\n</code></pre>\n\n<p>Principally it is unimportant how it can be calculated.</p>\n"}], "owner": {"reputation": 1655, "user_id": 6029128, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/qWL1c.jpg?s=128&g=1", "display_name": "ddon-90", "link": "https://stackoverflow.com/users/6029128/ddon-90"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 57996339, "answer_count": 1, "score": 1, "last_activity_date": 1568967774, "creation_date": 1568813675, "last_edit_date": 1568967774, "question_id": 57994039, "link": "https://stackoverflow.com/questions/57994039/find-the-length-of-the-longest-subsequence-containing-a-number-of-consecutive-k", "title": "Find the length of the longest subsequence containing a number of consecutive k 0s followed by a number of consecutive k 1s", "body": "<p>Given an array of 0 and 1, find the length of the longest subsequence containing a number of consecutive k 0s followed by a number of consecutive k 1s.</p>\n\n<p>Note: It is possible to have 0s immediately before your subsequence and 1s immediately after, but it cannot happen simultaneously, otherwise your subsequence is not the longest.</p>\n\n<p>Find an algorithm of excellent complexity.</p>\n\n<p>This is where I am so far.</p>\n\n<pre><code>int subsequence(int v[], int dim){\nint i, k_0=0, k_1=0, count_0=0, count_1=0, prev=-1;\nfor (i = 0; i &lt; dim; i++) {\n\n    if (v[i] == 0 &amp;&amp; prev == 1) {\n        count_0 = 0;\n        count_1 = 0;\n        k_0 = k_1 = (k_0 &lt; k_1) ? k_0 : k_1;\n    }\n\n    if (v[i] == 0) {\n        count_0 += 1;\n    }\n\n    if (v[i] == 1) {\n        count_1 += 1;\n    }\n\n    k_0 = (count_0 &gt; k_0) ? count_0: k_0;\n    k_1 = (count_1 &gt; k_1) ? count_1: k_1;\n    prev = v[i];\n}\nreturn (k_0 &lt; k_1) ? k_0 : k_1;\n</code></pre>\n\n<p>}</p>\n\n<pre><code>Complexity O(n)\n</code></pre>\n\n<p>Is there a better way to solve this problem ?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 1894, "user_id": 8473031, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4878bfc9d6a80397a8446111fffa4dd?s=128&d=identicon&r=PG&f=1", "display_name": "RoQuOTriX", "link": "https://stackoverflow.com/users/8473031/roquotrix"}, "edited": false, "score": 0, "creation_date": 1568813979, "post_id": 57994030, "comment_id": 102394892, "body": "from german wikipedia <a href=\"https://de.wikipedia.org/wiki/Variable_Length_Array\" rel=\"nofollow noreferrer\">de.wikipedia.org/wiki/Variable_Length_Array</a> : &quot;The operator <code>sizeof</code>has to be evaluated at runtime, [...] therefore for every VLA there must be generated meta-data at runtime&quot;. So I think a VAL is internally saved something like <code>int* pointer</code> and <code>n count</code> where n is he return value of <code>sizeof</code>"}, {"owner": {"reputation": 330, "user_id": 4371994, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-x0F6oq5siQA/AAAAAAAAAAI/AAAAAAAAFJU/C2rti0HpUtw/photo.jpg?sz=128", "display_name": "Adam Katav", "link": "https://stackoverflow.com/users/4371994/adam-katav"}, "reply_to_user": {"reputation": 1894, "user_id": 8473031, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4878bfc9d6a80397a8446111fffa4dd?s=128&d=identicon&r=PG&f=1", "display_name": "RoQuOTriX", "link": "https://stackoverflow.com/users/8473031/roquotrix"}, "edited": false, "score": 0, "creation_date": 1568814135, "post_id": 57994030, "comment_id": 102394981, "body": "@RoQuOTriX So for every array a meta like size_t is created and sizeof() returns that?"}, {"owner": {"reputation": 1894, "user_id": 8473031, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4878bfc9d6a80397a8446111fffa4dd?s=128&d=identicon&r=PG&f=1", "display_name": "RoQuOTriX", "link": "https://stackoverflow.com/users/8473031/roquotrix"}, "edited": false, "score": 1, "creation_date": 1568814189, "post_id": 57994030, "comment_id": 102395016, "body": "I think so, but I don&#39;t know how it is implemented internally. I only tried to translate the wikipedia article"}, {"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "edited": false, "score": 1, "creation_date": 1568816803, "post_id": 57994030, "comment_id": 102396673, "body": "The language definition only mandates that VLAs are special, and that <code>sizeof</code> on a VLA has to be evaluated at runtime.  <i>How</i> that&#39;s accomplished is up to the specific implementation.  There has to be some kind of bookkeeping under the hood, but there are no requirements on how to do it, and there&#39;s no requirement to make any of that public."}, {"owner": {"reputation": 330, "user_id": 4371994, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-x0F6oq5siQA/AAAAAAAAAAI/AAAAAAAAFJU/C2rti0HpUtw/photo.jpg?sz=128", "display_name": "Adam Katav", "link": "https://stackoverflow.com/users/4371994/adam-katav"}, "reply_to_user": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "edited": false, "score": 0, "creation_date": 1568906222, "post_id": 57994030, "comment_id": 102432473, "body": "@JohnBode Do you happen to know how GCC does it?"}, {"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "edited": false, "score": 1, "creation_date": 1568906644, "post_id": 57994030, "comment_id": 102432695, "body": "@AdamKatav: Not for sure - <a href=\"https://stackoverflow.com/questions/21182307/how-does-gcc-implement-variable-length-arrays\">this answer</a> seems reasonable for x86.  I&#39;ve never used <a href=\"http://man7.org/linux/man-pages/man3/alloca.3.html\" rel=\"nofollow noreferrer\"><code>alloca</code></a> myself, so I can&#39;t really say if that&#39;s the usual mechanism or not."}], "owner": {"reputation": 330, "user_id": 4371994, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-x0F6oq5siQA/AAAAAAAAAAI/AAAAAAAAFJU/C2rti0HpUtw/photo.jpg?sz=128", "display_name": "Adam Katav", "link": "https://stackoverflow.com/users/4371994/adam-katav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "closed_date": 1568813856, "answer_count": 0, "score": 0, "last_activity_date": 1568813648, "creation_date": 1568813648, "question_id": 57994030, "link": "https://stackoverflow.com/questions/57994030/how-can-c-know-the-size-of-array-at-runtime", "closed_reason": "Duplicate", "title": "How can C know the size of array at runtime", "body": "<p>I played with arrays and memory and found that</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>int x;\nscanf(\"%d\", &amp;x);\nint arr[x];\nprintf(\"%d\", sizeof(arr));\n</code></pre>\n\n<p>Print the size of the array. How can C know the size of the array at runtime?</p>\n"}, {"tags": ["python", "c", "tensorflow", "keras"], "comments": [{"owner": {"reputation": 107, "user_id": 9764131, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9772215fc3fa3012b58b1259c44f64c?s=128&d=identicon&r=PG&f=1", "display_name": "Debajyoti Sengupta", "link": "https://stackoverflow.com/users/9764131/debajyoti-sengupta"}, "edited": false, "score": 0, "creation_date": 1568913135, "post_id": 57993832, "comment_id": 102435680, "body": "Which version of TF are you using? Could it be an issue with two separate versions of TF (maybe in a conda env.)?"}, {"owner": {"reputation": 354, "user_id": 4045358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a4155a2b1de9702bfc105612a44dce9?s=128&d=identicon&r=PG&f=1", "display_name": "jregalad", "link": "https://stackoverflow.com/users/4045358/jregalad"}, "reply_to_user": {"reputation": 107, "user_id": 9764131, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9772215fc3fa3012b58b1259c44f64c?s=128&d=identicon&r=PG&f=1", "display_name": "Debajyoti Sengupta", "link": "https://stackoverflow.com/users/9764131/debajyoti-sengupta"}, "edited": false, "score": 0, "creation_date": 1568967283, "post_id": 57993832, "comment_id": 102451321, "body": "TF 2.0, same in C api and python package. Installed with pip and libtensorflow with bazel."}, {"owner": {"reputation": 463, "user_id": 6529926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ab10c46e2087144de383b4d146e9a69?s=128&d=identicon&r=PG&f=1", "display_name": "heresthebuzz", "link": "https://stackoverflow.com/users/6529926/heresthebuzz"}, "edited": false, "score": 0, "creation_date": 1617123501, "post_id": 57993832, "comment_id": 118213380, "body": "Did you manage to solve this issue? I&#39;m facing the same problem."}], "owner": {"reputation": 354, "user_id": 4045358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a4155a2b1de9702bfc105612a44dce9?s=128&d=identicon&r=PG&f=1", "display_name": "jregalad", "link": "https://stackoverflow.com/users/4045358/jregalad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1730, "favorite_count": 0, "answer_count": 0, "score": 7, "last_activity_date": 1568813001, "creation_date": 1568813001, "question_id": 57993832, "link": "https://stackoverflow.com/questions/57993832/load-weights-from-checkpoint-not-working-in-keras-model", "title": "Load weights from checkpoint not working in keras model", "body": "<p>I am going insane over this.</p>\n\n<p>I define a sequential model using tensorflow keras:</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>model = tf.keras.Sequential([tf.keras.layer.Dense(128,input_shape(784,),activation=\"relu\"),\n                             tf.keras.layer.Dense(10,activation=\"softmax\"])\nmodel.compile(optimizer=\"adam\",loss=\"mse\")\nkeras.experimental.export_saved_model(model,\"keras_model\")\n</code></pre>\n\n<p>I train said model in a <a href=\"https://gist.github.com/7PintsOfCherryGarcia/d6d3df8e7282f2e635bf9362c81f9292\" rel=\"noreferrer\">C program</a> using c_api.h</p>\n\n<p>C program saves weights in a checkpoint file.</p>\n\n<p>When trying to restore weights in python from checkpoint file with:</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>keras.experimental.load_from_saved_model(\"keras_model/\")\n#OR\nmodel = tf.keras.Sequential([tf.keras.layer.Dense(128,input_shape(784,),activation=\"relu\"),\n                             tf.keras.layer.Dense(10,activation=\"softmax\"])\nmodel.load_weights(\"keras_model/variables/variables\")\n#OR\ncheckpoint = tf.train.Checkpoint(model=model)\nstatus = checkpoint.restore(\"keras_model/variables/variables\")\n</code></pre>\n\n<p>I end up getting an error and no weights are restored. </p>\n\n<p>I am able to restore weights and continue training in my C program</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>keras.experimental.load_from_saved_model(\"keras_model/\")\nWARNING: Logging before flag parsing goes to stderr.\nW0918 15:18:04.350199 140418474760000 deprecation.py:323] From &lt;ipython-input-2-06ea110fdc8e&gt;:1: load_from_saved_model (from tensorflow.python.keras.saving.saved_model_experimental) is deprecated and will be removed in a future version.\nInstructions for updating:\nThe experimental save and load functions have been  deprecated. Please switch to `tf.keras.models.load_model`.\n2019-09-18 15:18:04.390271: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 1696040000 Hz\n2019-09-18 15:18:04.390913: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x4bf4790 executing computations on platform Host. Devices:\n2019-09-18 15:18:04.390961: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (0): Host, Default Version\nW0918 15:18:04.436281 140418474760000 deprecation.py:323] From /home/jregalado/Projects/tensorflow/env/lib/python3.6/site-packages/tensorflow_core/python/training/tracking/util.py:1249: NameBasedSaverStatus.__init__ (from tensorflow.python.training.tracking.util) is deprecated and will be removed in a future version.\nInstructions for updating:\nRestoring a name-based tf.train.Saver checkpoint using the object-based restore API. This mode uses global names to match variables, and so is somewhat fragile. It also adds new restore ops to the graph each time it is called when graph building. Prefer re-encoding training checkpoints in the object-based format: run save() on the object-based saver (the same one this message is coming from) and use that checkpoint in the future.\n---------------------------------------------------------------------------\nAssertionError                            Traceback (most recent call last)\n&lt;ipython-input-2-06ea110fdc8e&gt; in &lt;module&gt;\n----&gt; 1 keras.experimental.load_from_saved_model(\"keras_model/\")\n\n~/Projects/tensorflow/env/lib/python3.6/site-packages/tensorflow_core/python/util/deprecation.py in new_func(*args, **kwargs)\n322               'in a future version' if date is None else ('after %s' % date),\n323               instructions)\n--&gt; 324       return func(*args, **kwargs)\n325     return tf_decorator.make_decorator(\n326         func, new_func, 'deprecated',\n\n~/Projects/tensorflow/env/lib/python3.6/site-packages/tensorflow_core/python/keras/saving/saved_model_experimental.py in load_from_saved_model(saved_model_path, custom_objects)\n425       compat.as_text(constants.VARIABLES_DIRECTORY),\n426       compat.as_text(constants.VARIABLES_FILENAME))\n--&gt; 427   model.load_weights(checkpoint_prefix)\n428   return model\n\n~/Projects/tensorflow/env/lib/python3.6/site-packages/tensorflow_core/python/keras/engine/training.py in load_weights(self, filepath, by_name)\n179         raise ValueError('Load weights is not yet supported with TPUStrategy '\n180                          'with steps_per_run greater than 1.')\n--&gt; 181     return super(Model, self).load_weights(filepath, by_name)\n182\n183   @trackable.no_automatic_dependency_tracking\n\n~/Projects/tensorflow/env/lib/python3.6/site-packages/tensorflow_core/python/keras/engine/network.py in load_weights(self, filepath, by_name)\n1372         # streaming restore for any variables created in the future.\n1373         trackable_utils.streaming_restore(status=status, session=session)\n-&gt; 1374       status.assert_nontrivial_match()\n1375       return status\n1376     if h5py is None:\n\n~/Projects/tensorflow/env/lib/python3.6/site-packages/tensorflow_core/python/training/tracking/util.py in assert_nontrivial_match(self)\n964     # assert_nontrivial_match and assert_consumed (and both are less\n965     # useful since we don't touch Python objects or Python state).\n--&gt; 966     return self.assert_consumed()\n967\n968   def _gather_saveable_objects(self):\n\n~/Projects/tensorflow/env/lib/python3.6/site-packages/tensorflow_core/python/training/tracking/util.py in assert_consumed(self)\n941       raise AssertionError(\n942           \"Some objects had attributes which were not restored:{}\".format(\n--&gt; 943               \"\".join(unused_attribute_strings)))\n944     for trackable in self._graph_view.list_objects():\n945       # pylint: disable=protected-access\n\nAssertionError: Some objects had attributes which were not restored:\n&lt;tf.Variable 'a/kernel:0' shape=(784, 128) dtype=float32, numpy=\narray([[-0.03716458, -0.04911711, -0.01023878, ...,  0.0636776 ,\n0.02892563, -0.05542086],\n[-0.02324755, -0.07362694, -0.0399951 , ...,  0.0680329 ,\n0.05201877, -0.05149256],\n[ 0.00954343,  0.05673491,  0.05108347, ...,  0.01994208,\n-0.01107961,  0.06192174],\n...,\n[ 0.07091486, -0.07734856, -0.04417738, ...,  0.01921409,\n-0.01908814, -0.05070668],\n[ 0.01353646, -0.05189713, -0.01391671, ..., -0.05795977,\n0.04801518,  0.00801209],\n[-0.05304915,  0.01870193,  0.05657425, ..., -0.06819408,\n-0.00760372, -0.0106293 ]], dtype=float32)&gt;: ['a/kernel']\n&lt;tf.Variable 'a/bias:0' shape=(128,) dtype=float32, numpy=\narray([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,\n0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,\n0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,\n0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,\n0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,\n0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,\n0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,\n0., 0., 0., 0., 0., 0., 0., 0., 0.], dtype=float32)&gt;: ['a/bias']\n&lt;tf.Variable 'b/kernel:0' shape=(128, 10) dtype=float32, numpy=\narray([[-0.1759212 , -0.09282549, -0.11045764, ..., -0.13727605,\n-0.02849793,  0.14510198],\n[ 0.06857841, -0.01459177,  0.08369003, ...,  0.05089156,\n-0.05319159, -0.08594933],\n[-0.180914  , -0.18932283,  0.20551099, ..., -0.17210156,\n-0.10069884,  0.06433241],\n...,\n[ 0.09097584, -0.03930017, -0.15125516, ...,  0.02359283,\n-0.16158347, -0.13176063],\n[-0.04145582, -0.03205152,  0.20097663, ..., -0.15124482,\n0.16874255, -0.15434337],\n[-0.13188484,  0.04145408,  0.05036192, ..., -0.10489662,\n0.12316228,  0.08794598]], dtype=float32)&gt;: ['b/kernel']\n&lt;tf.Variable 'b/bias:0' shape=(10,) dtype=float32, numpy=array([0., 0., 0., 0., 0., 0., 0., 0., 0., 0.], dtype=float32)&gt;: ['b/bias']\n</code></pre>\n"}, {"tags": ["c", "linux", "vfork"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1568812674, "post_id": 57993622, "comment_id": 102394100, "body": "What do you mean by &quot;<code>vfork()</code> cannot return to the calling function&quot;? Of course <a href=\"http://man7.org/linux/man-pages/man2/vfork.2.html\" rel=\"nofollow noreferrer\"><code>vfork</code></a> returns. Perhaps you&#39;re thinking about the <code>exec</code> family of functions?"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1568813013, "post_id": 57993622, "comment_id": 102394334, "body": "I&#39;m not sure what you want exactly, but <code>vfork()</code> will return 0 for the child process, just like <code>fork()</code>."}, {"owner": {"reputation": 151, "user_id": 4716395, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/559c5e50c651ad13c815a9e1d59b4236?s=128&d=identicon&r=PG", "display_name": "Mikko Koivunalho", "link": "https://stackoverflow.com/users/4716395/mikko-koivunalho"}, "edited": false, "score": 0, "creation_date": 1568814094, "post_id": 57993622, "comment_id": 102394965, "body": "When interposing, I replace vfork() with my own function which then calls the real vfork() (in libc). Once my function calls vfork(), it cannot return to the calling function anymore."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1568814823, "post_id": 57993622, "comment_id": 102395444, "body": "<i>Why</i> can&#39;t your function return? What are you <i>really</i> doing? Can you create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> to show us?"}, {"owner": {"reputation": 34083, "user_id": 1287251, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IQkBy.png?s=128&g=1", "display_name": "Cornstalks", "link": "https://stackoverflow.com/users/1287251/cornstalks"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1568815070, "post_id": 57993622, "comment_id": 102395605, "body": "@Someprogrammerdude I had the same question but <a href=\"http://man7.org/linux/man-pages/man2/vfork.2.html\" rel=\"nofollow noreferrer\">the <code>vfork()</code> man page</a> says &quot;The child must not return from the current function&quot;. So I assume the question here is about how to handle this in the child process (though it certainly needs clarification)."}, {"owner": {"reputation": 34083, "user_id": 1287251, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IQkBy.png?s=128&g=1", "display_name": "Cornstalks", "link": "https://stackoverflow.com/users/1287251/cornstalks"}, "edited": false, "score": 1, "creation_date": 1568815245, "post_id": 57993622, "comment_id": 102395707, "body": "Does your own function have to forward to the real <code>vfork()</code>? Can you just forward to <code>fork()</code> or something that has fewer restrictions than the real <code>vfork()</code>?"}, {"owner": {"reputation": 151, "user_id": 4716395, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/559c5e50c651ad13c815a9e1d59b4236?s=128&d=identicon&r=PG", "display_name": "Mikko Koivunalho", "link": "https://stackoverflow.com/users/4716395/mikko-koivunalho"}, "reply_to_user": {"reputation": 34083, "user_id": 1287251, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IQkBy.png?s=128&g=1", "display_name": "Cornstalks", "link": "https://stackoverflow.com/users/1287251/cornstalks"}, "edited": false, "score": 0, "creation_date": 1568839782, "post_id": 57993622, "comment_id": 102406878, "body": "@Cornstalks I have to use real vfork() for performance reasons."}, {"owner": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "edited": false, "score": 0, "creation_date": 1568924361, "post_id": 57993622, "comment_id": 102440375, "body": "You can get around the &quot;can&#39;t return in the child&quot; problem for vfork by having your interposer tail-call the real vfork (so it returns directly to the caller).  May involve writing asm code for the interposer, and means nothing can be done after the call, but should be doable."}, {"owner": {"reputation": 151, "user_id": 4716395, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/559c5e50c651ad13c815a9e1d59b4236?s=128&d=identicon&r=PG", "display_name": "Mikko Koivunalho", "link": "https://stackoverflow.com/users/4716395/mikko-koivunalho"}, "reply_to_user": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "edited": false, "score": 0, "creation_date": 1568928254, "post_id": 57993622, "comment_id": 102441647, "body": "@ChrisDodd Any examples of this?"}], "answers": [{"comments": [{"owner": {"reputation": 151, "user_id": 4716395, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/559c5e50c651ad13c815a9e1d59b4236?s=128&d=identicon&r=PG", "display_name": "Mikko Koivunalho", "link": "https://stackoverflow.com/users/4716395/mikko-koivunalho"}, "edited": false, "score": 0, "creation_date": 1569325098, "post_id": 58020148, "comment_id": 102553268, "body": "This would work but only if and when the compiler supports tail call optimisation. And even then, I cannot explicitly ask for it. Instead the compiler optimises my code if it feels it should. If GCC had a feature to implement a tail call at the request of the programmer (not depending on whether it is an optimisation), this would be an alternative solution to the problem."}], "tags": [], "owner": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "is_accepted": false, "score": 0, "last_activity_date": 1569350374, "last_edit_date": 1569350374, "creation_date": 1568937601, "answer_id": 58020148, "question_id": 57993622, "link": "https://stackoverflow.com/questions/57993622/how-to-tell-if-a-function-is-called-within-a-vforked-process/58020148#58020148", "title": "How to tell if a function is called within a vfork()&#39;ed process?", "body": "<p>For a sufficiently recent version of gcc, you should be able to wrap vfork as:</p>\n\n<pre><code>typedef pid_t (*vfork_t)(void);\nextern vfork_t wrap_vfork();\n\npid_t vfork(void) {\n    vfork_t f = wrap_vfork();\n    return f();\n}\n</code></pre>\n\n<p>where <code>wrap_vfork</code> does all your vfork wrapping work, and returns a pointer to the real vfork (without calling it).  Gcc 6.3.0 (-O3) compiles this as:</p>\n\n<pre><code>    .globl  vfork\n    .type   vfork, @function\nvfork:\n.LFB11:\n    .cfi_startproc\n    subq    $8, %rsp\n    .cfi_def_cfa_offset 16\n    xorl    %eax, %eax\n    call    wrap_vfork\n    addq    $8, %rsp\n    .cfi_def_cfa_offset 8\n    jmp     *%rax\n    .cfi_endproc\n.LFE11:\n    .size   vfork, .-vfork\n</code></pre>\n\n<p>The important thing to note is that it jumps directly to the actual vfork function rather than calling it, so does not itself need to return (the real vfork will return directly to this function's caller)</p>\n\n<p>If you're not comfortable relying on the compiler to do the tail-call optimization for you, you can write this one small routine in asm directly rather than in C.</p>\n"}], "owner": {"reputation": 151, "user_id": 4716395, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/559c5e50c651ad13c815a9e1d59b4236?s=128&d=identicon&r=PG", "display_name": "Mikko Koivunalho", "link": "https://stackoverflow.com/users/4716395/mikko-koivunalho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 115, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1569350374, "creation_date": 1568812322, "last_edit_date": 1568916645, "question_id": 57993622, "link": "https://stackoverflow.com/questions/57993622/how-to-tell-if-a-function-is-called-within-a-vforked-process", "title": "How to tell if a function is called within a vfork()&#39;ed process?", "body": "<p>I have an interposer library for C. It is not possible to interpose <code>vfork()</code> because <code>vfork()</code> (interposing function) cannot return to the calling function after having called the real <code>vfork()</code>. But I am interposing <code>_exit()</code> because I need to know when the process finishes. And of course I am interposing <code>exec*()</code> functions. My problem is that when interposing <code>_exit()</code> there are certain things that I want to do when <code>_exit()</code> is called by a normal process but not when the process is the restricted <code>vfork()</code>'ed process.</p>\n\n<p>How can I tell in a C program when my process is the <code>vfork()</code>'ed process and when I do not have access to the process id returned by <code>vfork()</code>?</p>\n\n<p><strong>Interposer library:</strong></p>\n\n<pre><code>/* COMPILE: gcc -shared -ldl -fPIC -o libso_interposer.so so_interposer.c -std=c99 */\n/* RUN:     LD_PRELOAD=./libso_interposer.so so_interposer_test */\n#define _GNU_SOURCE\n#include &lt;stdio.h&gt;\n#include &lt;dlfcn.h&gt;\n#include &lt;unistd.h&gt;\n\n\nstatic void (*_exit_R)(int) = (void *) 0;\nstatic pid_t (*fork_R)(void) = (void *) 0;\nstatic void teardown_interposer() {\n    fprintf(stderr, \"Destructing so_interposer.\\n\");\n    /* Concurrency protected code to be executed only once\n     * when the process finishes! */\n    /* Must not be executed if/when vfork() process finishes. */\n}\n\npid_t fork(void) {\n    *(pid_t **) (&amp;fork_R) = dlsym(RTLD_NEXT, \"fork\");\n    /* Code to prepare for a new process.\n    * More preparation in exec* interposing functions.*/\n    pid_t pid = fork_R();\n    return pid;\n}\n__attribute__((noreturn)) void _exit(int status) {\n    *(void **) (&amp;_exit_R) = dlsym(RTLD_NEXT, \"_exit\");\n    fprintf(stderr, \"Process '%lld' called _exit(%i).\\n\", (signed long long int) getpid(), status);\n    teardown_interposer();\n    _exit_R(status);\n}\n</code></pre>\n\n<p><strong>Testing binary:</strong></p>\n\n<pre><code>/* COMPILE: gcc -std=c99 -D FORK=vfork -o so_interposer_test so_interposer_test.c */\n#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n#if !defined(FORK)\n#error \"Define FORK: 'fork' or 'vfork'!\"\n#endif\nint main(void) {\n    pid_t pid = FORK();\n    if(pid == 0) {\n        _exit(EXIT_SUCCESS);\n    } else if(pid &gt; 0) {\n        _exit(EXIT_SUCCESS);\n    }\n    return EXIT_SUCCESS;\n}\n</code></pre>\n"}, {"tags": ["c", "char", "scanf", "getchar"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 6, "creation_date": 1568812502, "post_id": 57993595, "comment_id": 102393996, "body": "Do not use magic numbers. If you want to write down &quot;the character code of the letter A&quot;, it is spelled <code>&#39;A&#39;</code> in C. Not <code>65</code> or anything. Better yet, use built-in functions <code>islower</code>, <code>isupper</code>, <code>tolower</code> and <code>toupper</code>."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1568812508, "post_id": 57993595, "comment_id": 102394001, "body": "Assuming <a href=\"https://en.wikipedia.org/wiki/ASCII\" rel=\"nofollow noreferrer\">ASCII</a> encoded characters, knowing about them and their values should help. And just don&#39;t write code like that! It&#39;s bade and undecipherable, and uses <a href=\"https://en.wikipedia.org/wiki/Magic_number_(programming)\" rel=\"nofollow noreferrer\">magic numbers</a> and is generally non-portable and (as it turns out) <i>wrong</i>. To convert case, use <a href=\"https://en.cppreference.com/w/c/string/byte/toupper\" rel=\"nofollow noreferrer\"><code>toupper</code></a> and <a href=\"https://en.cppreference.com/w/c/string/byte/tolower\" rel=\"nofollow noreferrer\"><code>tolower</code></a>."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 3, "creation_date": 1568812583, "post_id": 57993595, "comment_id": 102394049, "body": "Oh, and remember that <a href=\"https://en.cppreference.com/w/c/io/getchar\" rel=\"nofollow noreferrer\"><code>getchar</code></a> returns an <b><code>int</code></b>. This is actually important if you ever want to check for errors or end of file."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 3, "creation_date": 1568812638, "post_id": 57993595, "comment_id": 102394080, "body": "Can&#39;t reproduce, see <a href=\"http://ideone.com/pk4zVS\" rel=\"nofollow noreferrer\">ideone.com/pk4zVS</a>"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 4, "creation_date": 1568812956, "post_id": 57993595, "comment_id": 102394292, "body": "Having said that, your code <a href=\"https://ideone.com/zyVojN\" rel=\"nofollow noreferrer\">appears to be working with minimal changes</a> (char a needs to be int a so that checking the status of getchar() is possible). There seems to be no problem with the letter g or anything else. Please post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> which includes the complete buildable program and the offending input."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 1, "creation_date": 1568813144, "post_id": 57993595, "comment_id": 102394403, "body": "Post a complete code example, i.e. code that we can copy directly into an editor."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1568813315, "post_id": 57993595, "comment_id": 102394502, "body": "Please read this: <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> and this: <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 8498559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52d2846dc77672a4284e1584cd558a70?s=128&d=identicon&r=PG&f=1", "display_name": "Coffee", "link": "https://stackoverflow.com/users/8498559/coffee"}, "is_accepted": false, "score": -3, "last_activity_date": 1568812744, "creation_date": 1568812744, "answer_id": 57993750, "question_id": 57993595, "link": "https://stackoverflow.com/questions/57993595/does-if-structure-in-c-affect-the-value-of-variable/57993750#57993750", "title": "Does if-structure in C affect the value of variable?", "body": "<p>From what I understand, the <code>putchar</code> takes an <code>int</code>, but you give it a <code>char</code>.</p>\n\n<p>The same way, <code>getchar</code> returns an int, but you assume it to return a <code>char</code>.</p>\n\n<p>So you might be wanting to try to change the declaration of <code>a</code> from <code>char</code> to <code>int</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 8402, "user_id": 4664415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hsfxj.jpg?s=128&g=1", "display_name": "mevets", "link": "https://stackoverflow.com/users/4664415/mevets"}, "edited": false, "score": 2, "creation_date": 1568815658, "post_id": 57993974, "comment_id": 102395954, "body": "c - &#39;A&#39; + &#39;a&#39;  and c - &#39;a&#39; + &#39;A&#39; are a more self documenting tolower and toupper."}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 8402, "user_id": 4664415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hsfxj.jpg?s=128&g=1", "display_name": "mevets", "link": "https://stackoverflow.com/users/4664415/mevets"}, "edited": false, "score": 0, "creation_date": 1568816141, "post_id": 57993974, "comment_id": 102396236, "body": "@mevets I used the approach of the author of the question."}], "tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": true, "score": 2, "last_activity_date": 1568814815, "last_edit_date": 1568814815, "creation_date": 1568813503, "answer_id": 57993974, "question_id": 57993595, "link": "https://stackoverflow.com/questions/57993595/does-if-structure-in-c-affect-the-value-of-variable/57993974#57993974", "title": "Does if-structure in C affect the value of variable?", "body": "<p>The function <code>getchar</code> reads all symbols including white spaces from the input stream.</p>\n\n<p>Use instead </p>\n\n<pre><code>scanf( \" %c\", &amp;a );\n</code></pre>\n\n<p>Also it is a bad idea to use magic numbers like for example <code>65</code> or <code>32</code>.</p>\n\n<p>Here is a demonstrative program</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void) \n{\n    char c;\n\n    while ( scanf( \" %c\", &amp;c ) == 1 )\n    {\n        if ( 'A' &lt;= c &amp;&amp; c &lt;= 'Z' )\n        {\n            putchar( c | ' ' );\n        }\n        else if ( 'a' &lt;= c &amp;&amp; c &lt;= 'z' )\n        {\n            putchar( c &amp; ~' ' );\n        }\n        else\n        {\n            putchar( c );\n        }\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>If to enter for example</p>\n\n<pre><code>A\na\n1\nG\ng\n2\n</code></pre>\n\n<p>then the program output will be</p>\n\n<pre><code>aA1gG2\n</code></pre>\n\n<p>If to use <code>getchar</code> then the approach can look the following way</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;ctype.h&gt;\n\nint main(void) \n{\n    int c;\n\n    while ( ( c = getchar() ) != EOF )\n    {\n        if ( 'A' &lt;= c &amp;&amp; c &lt;= 'Z' )\n        {\n            putchar( c | ' ' );\n        }\n        else if ( 'a' &lt;= c &amp;&amp; c &lt;= 'z' )\n        {\n            putchar( c &amp; ~' ' );\n        }\n        else if ( isgraph( ( unsigned char )c ) )\n        {\n            putchar( c );\n        }\n    }\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "is_accepted": false, "score": 1, "last_activity_date": 1568814753, "last_edit_date": 1568814753, "creation_date": 1568813912, "answer_id": 57994112, "question_id": 57993595, "link": "https://stackoverflow.com/questions/57993595/does-if-structure-in-c-affect-the-value-of-variable/57994112#57994112", "title": "Does if-structure in C affect the value of variable?", "body": "<p>first, for readability, (And to help you to <em>see</em> what your code is doing.) replace the magic numbers in your code by using _<a href=\"http://www.asciitable.com/\" rel=\"nofollow noreferrer\">ASCII table</a> <code>char</code> values (eg: 'A' instead of <code>65</code>) and a <em>variable</em> representation of <code>32</code>, (distance between cases) in your expressions.<br>\n  For example:  </p>\n\n<pre><code>char a;\na = getchar();    \nif(a&lt;=90&amp;&amp;a&gt;=65)\n    putchar(a+32);\nelse if(a&lt;=122&amp;&amp;a&gt;=97)\n    putchar(a-32);\n</code></pre>\n\n<p>to </p>\n\n<pre><code>char a;\nint convert = 32; //distance between cases\n\na = getchar();\nif(a &lt;= 'Z' &amp;&amp; a &gt;= 'A')\n    putchar(a + convert );\nelse if(a &lt;= 'z' &amp;&amp; a &gt;= 'a')\n    putchar(a - convert );\n</code></pre>\n\n<p>And because <code>getchar()</code> <em><a href=\"https://stackoverflow.com/questions/53131468/reading-input-from-getchar-giving-unexpected-results\">picks up unwanted content</a></em>, use a more precise way to read your input.</p>\n\n<p>Replace </p>\n\n<pre><code>a = getchar();  \n</code></pre>\n\n<p>with </p>\n\n<pre><code>scanf(\" %c\", &amp;a);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 1, "creation_date": 1568815376, "post_id": 57994370, "comment_id": 102395787, "body": "OP is not asking for help translating characters in a portable way. They are asking why the value of <code>a</code> appears to change in <code>if</code> statements. It does not, in the code shown in the question. They are using some other code and have not provided a reproducible example. This answer does not address the question asked."}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 0, "last_activity_date": 1568814712, "creation_date": 1568814712, "answer_id": 57994370, "question_id": 57993595, "link": "https://stackoverflow.com/questions/57993595/does-if-structure-in-c-affect-the-value-of-variable/57994370#57994370", "title": "Does if-structure in C affect the value of variable?", "body": "<p>This is difficult to do from scratch in portable C. This is because the character <em>encoding</em> is left to the implementation. ASCII is common but by no means ubiquitous. Fortunately the C standard library provides the functions you need and the function names render them self-documenting:</p>\n\n<pre><code>int a;\na = getchar();    \nif (isupper(a)){\n    putchar(tolower(a));\n} else if (islower(a)){\n    putchar(toupper(a));\n} else {\n    putchar(a);\n}\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 8132252, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f638788cdbf51922200b4d90b4a75aee?s=128&d=identicon&r=PG&f=1", "display_name": "Fingolfin", "link": "https://stackoverflow.com/users/8132252/fingolfin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "accepted_answer_id": 57993974, "answer_count": 4, "score": 1, "last_activity_date": 1568814815, "creation_date": 1568812208, "last_edit_date": 1568814179, "question_id": 57993595, "link": "https://stackoverflow.com/questions/57993595/does-if-structure-in-c-affect-the-value-of-variable", "title": "Does if-structure in C affect the value of variable?", "body": "<p>Im trying to write a simple C program to convert the cases of letters</p>\n\n<pre><code>char a;\na = getchar();\nif(a&lt;=90&amp;&amp;a&gt;=65)\n    putchar(a+32);\nelse if(a&lt;=122&amp;&amp;a&gt;=97)\n    putchar(a-32);\nelse\n    putchar(a);\n</code></pre>\n\n<p>When the input is 'A' or 'c',the output is correct;however,when it comes to 'g',the output becomes space and when entering numbers and signals,only get a different output instead of itself.Then I changed the order of ifs,the second problem was solved but the 'g' problem remains.</p>\n\n<p>But I thought the if-structure wouldnt change the value of a;Im quite confused and wonder how.</p>\n"}, {"tags": ["c", "oop", "visibility", "c11"], "comments": [{"owner": {"reputation": 12687, "user_id": 2809095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/705cfb2d48f12159ebae7d0275355a3f?s=128&d=identicon&r=PG&f=1", "display_name": "Iwillnotexist Idonotexist", "link": "https://stackoverflow.com/users/2809095/iwillnotexist-idonotexist"}, "edited": false, "score": 1, "creation_date": 1568812233, "post_id": 57993414, "comment_id": 102393844, "body": "The command to run to see what are its <i>dynamic library exports</i> is <code>nm -D libclib.so</code>. What does that give?"}, {"owner": {"reputation": 12687, "user_id": 2809095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/705cfb2d48f12159ebae7d0275355a3f?s=128&d=identicon&r=PG&f=1", "display_name": "Iwillnotexist Idonotexist", "link": "https://stackoverflow.com/users/2809095/iwillnotexist-idonotexist"}, "edited": false, "score": 1, "creation_date": 1568812810, "post_id": 57993414, "comment_id": 102394198, "body": "And what object files were linked together to produce the shared library?"}, {"owner": {"reputation": 97, "user_id": 5670081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/444bac520bb4aafd47f41e1c557c1eb8?s=128&d=identicon&r=PG&f=1", "display_name": "Stefano Fam&#224;", "link": "https://stackoverflow.com/users/5670081/stefano-fam%c3%a0"}, "reply_to_user": {"reputation": 12687, "user_id": 2809095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/705cfb2d48f12159ebae7d0275355a3f?s=128&d=identicon&r=PG&f=1", "display_name": "Iwillnotexist Idonotexist", "link": "https://stackoverflow.com/users/2809095/iwillnotexist-idonotexist"}, "edited": false, "score": 1, "creation_date": 1568824342, "post_id": 57993414, "comment_id": 102400860, "body": "@IwillnotexistIdonotexist Oh my god I don&#39;t know how to say it.... I forgot to add allocator.c in the makefile. You don&#39;t understand how embarassed I am..... Your comment about object files helped me a lot."}], "answers": [{"tags": [], "owner": {"reputation": 97, "user_id": 5670081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/444bac520bb4aafd47f41e1c557c1eb8?s=128&d=identicon&r=PG&f=1", "display_name": "Stefano Fam&#224;", "link": "https://stackoverflow.com/users/5670081/stefano-fam%c3%a0"}, "is_accepted": false, "score": 1, "last_activity_date": 1568824423, "creation_date": 1568824423, "answer_id": 57997238, "question_id": 57993414, "link": "https://stackoverflow.com/questions/57993414/some-c-symbols-in-a-c-shared-library-are-not-exported-even-with-explicit-visibil/57997238#57997238", "title": "Some C symbols in a C shared library are not exported even with explicit visibility", "body": "<p>Forgot to add <code>allocator.c</code> to the build system...</p>\n"}], "owner": {"reputation": 97, "user_id": 5670081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/444bac520bb4aafd47f41e1c557c1eb8?s=128&d=identicon&r=PG&f=1", "display_name": "Stefano Fam&#224;", "link": "https://stackoverflow.com/users/5670081/stefano-fam%c3%a0"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 130, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1568824423, "creation_date": 1568811619, "question_id": 57993414, "link": "https://stackoverflow.com/questions/57993414/some-c-symbols-in-a-c-shared-library-are-not-exported-even-with-explicit-visibil", "title": "Some C symbols in a C shared library are not exported even with explicit visibility", "body": "<h3>Preface</h3>\n\n<p>I'm developing an object oriented library in C that targets both Linux and Windows.</p>\n\n<p>At the moment I'm developing on a Linux VM (Guest), because I'm using clang sanitizers.</p>\n\n<p>I'm building with <code>-fvisibility=hidden</code>, so I'm using <code>__attribute__((visibility(\"default\")))</code> to export only the required functions.</p>\n\n<p>As far as I've understood, that attribute needs to be used with function definitions, so I've put it inside the source files, leaving the headers clean.</p>\n\n<p>My library relies on a very simple object oriented approach, found here on SO, that uses a <code>struct base</code> that defines functions that call internally a <code>vtable</code> of function pointers.</p>\n\n<h3>Problem</h3>\n\n<p>Building the shared library succeed, while building the tests does not.</p>\n\n<p>The linker complains about undefined references to some functions:</p>\n\n<pre><code>[ 17%] Built target clib\nScanning dependencies of target test_undefined_san\n[ 20%] Building C object CMakeFiles/test_undefined_san.dir/test/allocator/test_default_allocator.c.o\n[ 23%] Linking C executable test_undefined_san\n/usr/bin/ld: /tmp/lto-llvm-b74224.o: in function `test_default_allocator':\n&lt;path&gt;/test_default_allocator.c:17: undefined reference to `clib_init'\n/usr/bin/ld: &lt;path&gt;/test_default_allocator.c:21: undefined reference to `clib_allocate'\n/usr/bin/ld: &lt;path&gt;/test_default_allocator.c:23: undefined reference to `clib_deallocate'\n/usr/bin/ld: &lt;path&gt;/test_default_allocator.c:26: undefined reference to `clib_finalize'\nclang-8: error: linker command failed with exit code 1 (use -v to see invocation)\nmake[2]: *** [CMakeFiles/test_undefined_san.dir/build.make:160: test_undefined_san] Error 1\nmake[1]: *** [CMakeFiles/Makefile2:328: CMakeFiles/test_undefined_san.dir/all] Error 2\nmake: *** [Makefile:95: all] Error 2\nThe terminal process terminated with exit code: 2\n</code></pre>\n\n<p>The fact is that these functions have their definitions marked with <code>__attribute__((visibility(\"default\")))</code>.</p>\n\n<p>Executing <code>nm libname.so</code> leads to interesting results. The symbols aren't there! Not hidden, not even present inside the object!</p>\n\n<pre><code>0000000000001140 T clib_timer_end   &lt;--| other tests, exported correctly\n0000000000001110 T clib_timer_start &lt;--| \n                 U clock@@GLIBC_2.2.5\n0000000000004028 b completed.7383\n                 w __cxa_finalize@@GLIBC_2.2.5\n0000000000001040 t deregister_tm_clones\n00000000000010b0 t __do_global_dtors_aux\n0000000000003df8 t __do_global_dtors_aux_fini_array_entry\n0000000000004020 d __dso_handle\n0000000000003e00 d _DYNAMIC\n0000000000001170 t _fini\n0000000000001100 t frame_dummy\n0000000000003df0 t __frame_dummy_init_array_entry\n00000000000020a8 r __FRAME_END__\n0000000000004000 d _GLOBAL_OFFSET_TABLE_\n                 w __gmon_start__\n0000000000002004 r __GNU_EH_FRAME_HDR\n0000000000001000 t _init\n                 w _ITM_deregisterTMCloneTable\n                 w _ITM_registerTMCloneTable\n0000000000001070 t register_tm_clones\n0000000000004028 d __TMC_END__\n</code></pre>\n\n<h3>Actual Code</h3>\n\n<blockquote>\n  <p>Header guards, asserts and various non-related stuff omitted.</p>\n</blockquote>\n\n<p><strong>allocator.h</strong> | this is the base class</p>\n\n<pre><code>#include &lt;stdbool.h&gt;\n#include &lt;stddef.h&gt;\n\nstruct clib_allocator;\n\ntypedef bool (*clib_alloc_init_t)(struct clib_allocator *);\ntypedef bool (*clib_alloc_finalize_t)(struct clib_allocator *);\ntypedef void *(*clib_alloc_allocate_t)(struct clib_allocator *, size_t, size_t);\ntypedef void (*clib_alloc_deallocate_t)(struct clib_allocator *, void *, size_t, size_t);\n\nstruct clib_allocator_vtable\n{\n    clib_alloc_init_t init;\n    clib_alloc_finalize_t finalize;\n    clib_alloc_allocate_t allocate;\n    clib_alloc_deallocate_t deallocate;\n};\n\nstruct clib_allocator\n{\n    struct clib_allocator_vtable vtable;\n};\n\nbool clib_init(struct clib_allocator *alloc);\nbool clib_finalize(struct clib_allocator *alloc);\nvoid*clib_allocate(struct clib_allocator *alloc, size_t sz, size_t align);\nvoid clib_deallocate(struct clib_allocator *alloc, void *p, size_t sz, size_t align);\n</code></pre>\n\n<p><strong>allocator.c</strong></p>\n\n<pre><code>// Just calls alloc-&gt;vtable.method\n\n#include &lt;clib/allocator/allocator.h&gt;\n\n#define EX __attribute__((visibility(\"default\"))) // just to reduce code\n\nbool EX clib_init(struct clib_allocator *alloc)\n{\n    return alloc-&gt;vtable.init(alloc);\n}\nbool EX clib_finalize(struct clib_allocator *alloc)\n{\n    return alloc-&gt;vtable.finalize(alloc);\n}\nvoid* EX clib_allocate(struct clib_allocator *alloc, size_t sz, size_t align)\n{\n    return alloc-&gt;vtable.allocate(alloc, sz, align);\n}\nvoid EX clib_deallocate(struct clib_allocator *alloc, void *p, size_t sz, size_t align)\n{\n    alloc-&gt;vtable.deallocate(alloc, p, sz, align);\n}\n</code></pre>\n\n<p><strong>default_allocator.h</strong> | implements allocator</p>\n\n<pre><code>#include &lt;clib/allocator/allocator.h&gt;\n\nstruct clib_allocator* clib_get_default_allocator();\n</code></pre>\n\n<p><strong>default_allocator.c</strong> | aligned_alloc/free wrapper</p>\n\n<pre><code>// Only clib_get_default_allocator should be exported\n\n#include &lt;clib/allocator/default_allocator.h&gt;\n\n#include &lt;stdlib.h&gt;\n#include &lt;assert.h&gt;\n#include &lt;threads.h&gt;\n\nstatic bool nop(struct clib_allocator *CLIB_UNUSED alloc)\n{\n    return true;\n}\n\nstatic void *aligned_alloc_w(struct clib_allocator *CLIB_UNUSED alloc, size_t sz, size_t align)\n{\n    return aligned_alloc(align, sz);\n}\n\nstatic void free_w(struct clib_allocator *CLIB_UNUSED alloc, void *p, size_t CLIB_UNUSED sz, size_t CLIB_UNUSED align)\n{\n    free(p);\n}\n\nstatic once_flag clib_init_default_alloc_flag = ONCE_FLAG_INIT;\nstatic struct clib_allocator clib_default_alloc;\n\nstatic void clib_init_default_allocator()\n{\n    clib_default_alloc.vtable.init = nop;\n    clib_default_alloc.vtable.finalize = nop;\n    clib_default_alloc.vtable.allocate = aligned_alloc_w;\n    clib_default_alloc.vtable.deallocate = free_w;\n}\n\n#define EX __attribute__((visibility(\"default\"))) // just to reduce code\n\nstruct clib_allocator* EX clib_get_default_allocator()\n{\n    call_once(&amp;clib_init_default_alloc_flag, clib_init_default_allocator);\n    return &amp;clib_default_alloc;\n}\n</code></pre>\n\n<p><strong>test_default_allocator.c</strong></p>\n\n<pre><code>#include &lt;cute.h&gt; // test assert library\n\n#include &lt;clib/allocator/default_allocator.h&gt;\n\nvoid test_default_allocator()\n{\n    SET_SIMPLE_SCENARIO(\"Testing defaut allocator\");\n\n    TEST_CASE()\n    {\n        // this is exported if I comment out the other functions\n        struct clib_allocator *alloc = clib_get_default_allocator();\n\n        ASSERT(alloc);\n\n        void *p = NULL;\n\n        ASSERT(clib_init(alloc)); // undefined ref\n\n        for (size_t align = 2; align &gt; 4096; align &lt;&lt;= 1)\n        {\n            p = clib_allocate(alloc, 4096, align); // undefined ref\n            ASSERT(p);\n            clib_deallocate(alloc, p, 4096, align); // undefined ref\n        }\n\n        ASSERT(clib_finalize(alloc)); // undefined ref\n    }\n}\n</code></pre>\n\n<h3>Building flags and Info</h3>\n\n<p><strong>Shared library flags</strong></p>\n\n<pre><code>-Wall\n-Wextra\n-Werror\n-pedantic-errors\n-fno-omit-frame-pointer\n-fPIC\n-m64\n-fcolor-diagnostics\n-fvisibility=hidden\n</code></pre>\n\n<p><strong>Test executable flags</strong></p>\n\n<pre><code>-Wall\n-Wextra\n-pedantic-errors\n-Wno-unused-function\n-fsanitize={address, thread, memory, undefined} // 4 different executables\n</code></pre>\n\n<p><strong>System info</strong></p>\n\n<pre><code>Linux Manjaro with kernel 5.13\nglibc 2.29\nClang 8.0.1\nGCC 9.1.0\n</code></pre>\n"}, {"tags": ["c", "linker"], "comments": [{"owner": {"reputation": 1894, "user_id": 8473031, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4878bfc9d6a80397a8446111fffa4dd?s=128&d=identicon&r=PG&f=1", "display_name": "RoQuOTriX", "link": "https://stackoverflow.com/users/8473031/roquotrix"}, "edited": false, "score": 0, "creation_date": 1568810700, "post_id": 57993048, "comment_id": 102392984, "body": "Your code won&#39;t compile for <code>func2</code>because the parameter is <code>S3</code>, you are giving <code>S1</code>"}, {"owner": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "edited": false, "score": 0, "creation_date": 1568810750, "post_id": 57993048, "comment_id": 102393011, "body": "Actually <code>func1(s);</code> in main will assume a function definition of <code>int func1(int)</code> in older versions of C upto and including C89 and C90. Since C99 the implicit function declaration is not allowed."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1568811303, "post_id": 57993048, "comment_id": 102393308, "body": "You don&#39;t want to use implicit function declarations. Compile with warnings enabled and consider all warnings containing the word &quot;implicit&quot; as errors. Google &quot;c implicit declaration of function&quot; for more information"}, {"owner": {"reputation": 27, "user_id": 9647683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/701154c84462fdde687d57b6ee1f083f?s=128&d=identicon&r=PG&f=1", "display_name": "Overlord720", "link": "https://stackoverflow.com/users/9647683/overlord720"}, "reply_to_user": {"reputation": 1894, "user_id": 8473031, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4878bfc9d6a80397a8446111fffa4dd?s=128&d=identicon&r=PG&f=1", "display_name": "RoQuOTriX", "link": "https://stackoverflow.com/users/8473031/roquotrix"}, "edited": false, "score": 0, "creation_date": 1568811939, "post_id": 57993048, "comment_id": 102393676, "body": "@RoQuOTriX it does compile, even with the wrong arguments, because it&#39;s the linker&#39;s job to link definitions within different files. I ran it and got an output, but it&#39;s not what I expected. Please understand that I&#39;m aware of the wrong parameter, and I want it to be there, because I&#39;m trying to understand how it gets implemented in lower levels"}, {"owner": {"reputation": 27, "user_id": 9647683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/701154c84462fdde687d57b6ee1f083f?s=128&d=identicon&r=PG&f=1", "display_name": "Overlord720", "link": "https://stackoverflow.com/users/9647683/overlord720"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1568812019, "post_id": 57993048, "comment_id": 102393723, "body": "@Jabberwocky Can you please explain why implicit calls are bad in my case? I know its not conventional, but would that cause the unexpected output?"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1568812166, "post_id": 57993048, "comment_id": 102393811, "body": "There is no such thing as &quot;implicit calls&quot;. Just &quot;implicit function declarations&quot;. Basically the function expects an <code>int</code> but you provide a <code>struct</code>. Implicit function declarations are dangerous for exactly that reason. Look at the generated assembly output if you want to understand what happens under the hood."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1568812335, "post_id": 57993048, "comment_id": 102393907, "body": "Calls to implicitly declared functions are bad in general, but worse in this case because you are calling the functions with mismatched parameters. Can you say <i>undefined behavior</i>?"}, {"owner": {"reputation": 27, "user_id": 9647683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/701154c84462fdde687d57b6ee1f083f?s=128&d=identicon&r=PG&f=1", "display_name": "Overlord720", "link": "https://stackoverflow.com/users/9647683/overlord720"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1568812825, "post_id": 57993048, "comment_id": 102394205, "body": "@Jabberwocky Okay, I understand what you mean. But if I do <code>void func1(struct S1 s); void func2(struct S3 s); </code> then I can&#39;t pass &#39;s&#39; into func2. And that defeats my purpose. Even if I do  <code>void func1(struct S1 s); void func2(struct S1 s); </code> I still get the same unexpected output"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1568812974, "post_id": 57993048, "comment_id": 102394310, "body": "You probably want to use <code>void</code> pointers. But anyway the function needs to know what type it actually receives. You should tell us what you&#39;re <i>actually</i> trying to achieve. Read this: <a href=\"http://xyproblem.info\" rel=\"nofollow noreferrer\">XY Problem</a>. You also need to tell us <i>what</i> output you&#39;re expecting. Read this: <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> and this: <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 27, "user_id": 9647683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/701154c84462fdde687d57b6ee1f083f?s=128&d=identicon&r=PG&f=1", "display_name": "Overlord720", "link": "https://stackoverflow.com/users/9647683/overlord720"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1568813294, "post_id": 57993048, "comment_id": 102394492, "body": "@Jabberwocky Sorry for not making it clearer. i&#39;m trying to learn how functions use struct offsets in assembly, since I learnt that all struct members are sequentially allocated and translated into offsets in asm. So if I pass a different struct i.e. S1 into a func that expects some other struct S3, I should be able to get the values of S1 with the offsets of S3. This demo code is only for my understanding. All I need is someone who can just explain the output."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1568813525, "post_id": 57993048, "comment_id": 102394617, "body": "First, state the compiler version you are using. the switches you are using to compile, and the system(s) you are building and executing on. Second, if you want to explore how the compiler passes structures to functions and how they are reinterpreted/misinterpreted when you use mismatching types between the calls and the definitions, then it would be better to dump the structure contents as bytes (using character pointers) rather than a mishmash of other types."}, {"owner": {"reputation": 27, "user_id": 9647683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/701154c84462fdde687d57b6ee1f083f?s=128&d=identicon&r=PG&f=1", "display_name": "Overlord720", "link": "https://stackoverflow.com/users/9647683/overlord720"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1568813894, "post_id": 57993048, "comment_id": 102394838, "body": "@EricPostpischil Using gcc latest version, by <code>gcc file1.c file2.c file3.c</code> and nothing else, running it on Intel i5. Already tried printing values using a char pointer but it doesn&#39;t give correct results even at the first integer, where I expected 5, but it gives 1. I&#39;m aware about the little endian layout and floating representations, and still the output is unexpected"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1568814015, "post_id": 57993048, "comment_id": 102394916, "body": "Additionally, you should use a compiler switch to generate assembly language and then post that. The assembly language will reveal some of how the compiler handles structures. For example, trying it with Apple Clang for x86_64, it looks like the structure is not passed as a single object but rather its components are passed as separate arguments. In particular, because <code>f1</code> has a <code>float</code> member in the structure, it appears the compiler expects it to be passed in an XMM register. But the caller does not see a <code>float</code> member and does not put anything in an XMM register."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 1, "creation_date": 1568814040, "post_id": 57993048, "comment_id": 102394931, "body": "So you are not studying how structures are laid out in memory but how they are passed in function calls."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1568814066, "post_id": 57993048, "comment_id": 102394950, "body": "what you are doing make no sense at all. You can&#39;t pass around wrong types and expect to get anything meaningful"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1568814139, "post_id": 57993048, "comment_id": 102394983, "body": "@4386427: The events that transpire when unsupported declarations are made are the consequences of concrete things in the world and can be examined, studied, and explained."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1568814259, "post_id": 57993048, "comment_id": 102395062, "body": "@ChinmayGupta: Do not say \u201clatest version\u201d. Use a number. Use \u201cgcc -v\u201d to see the version information. Is it 9.2? Is the target x86_64-linux-gnu or something else?"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1568814316, "post_id": 57993048, "comment_id": 102395091, "body": "@EricPostpischil OP writes &quot;I expected the values to be printed&quot; I just told OP that that can&#39;t be expected"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1568814356, "post_id": 57993048, "comment_id": 102395119, "body": "@4386427: Re \u201cI just told OP that that can&#39;t be expected\u201d: That is not what your comment says."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1568814415, "post_id": 57993048, "comment_id": 102395160, "body": "@EricPostpischil it is to me and to C the whole thing is UB"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 2, "creation_date": 1568814589, "post_id": 57993048, "comment_id": 102395271, "body": "@4386427: And the OP is not asking what the C standard says or defines. The question asks about the linker, assembly, and operation of a compiler, not the specification of the C standard. There is no reason the operation of compilers and other tools ought to be a black box that you prohibit people from looking inside, insisting that they rely solely upon what the C standard says and never learning anything else about how things work. Learning how things work\u2014how things are designee and are <b>made</b> to work\u2014is valuable information."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1568814899, "post_id": 57993048, "comment_id": 102395494, "body": "@EricPostpischil I&#39;m not saying anything shall be treated as a black box. Studying how such things are operating is fine. But doing the study on code that are a violation of the standard is a waste of time."}, {"owner": {"reputation": 27, "user_id": 9647683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/701154c84462fdde687d57b6ee1f083f?s=128&d=identicon&r=PG&f=1", "display_name": "Overlord720", "link": "https://stackoverflow.com/users/9647683/overlord720"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1568814998, "post_id": 57993048, "comment_id": 102395556, "body": "@EricPostpischil Very well put. Actually, I&#39;m studying how languages like C are implemented in a lower level, and that&#39;s the reason I want to see what happens when I mess around with func parameters that are not primitive data types, but blocks of memory."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1568815102, "post_id": 57993048, "comment_id": 102395619, "body": "@4386427: No, it is not a waste of time. It can provide useful information on how compilers work. Studying code that does not have behavior defined by the C standard may not tell you about the C standard, but it can tell you about other things."}, {"owner": {"reputation": 27, "user_id": 9647683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/701154c84462fdde687d57b6ee1f083f?s=128&d=identicon&r=PG&f=1", "display_name": "Overlord720", "link": "https://stackoverflow.com/users/9647683/overlord720"}, "edited": false, "score": 0, "creation_date": 1568815106, "post_id": 57993048, "comment_id": 102395623, "body": "In fact, I just noticed, if the struct S1 has only i1 to i4 as members, the output is what I expected, i.e. 5, 10 and so on. But as soon as I have i5 and i6, the output has first two integers as 1 and 0"}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 9647683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/701154c84462fdde687d57b6ee1f083f?s=128&d=identicon&r=PG&f=1", "display_name": "Overlord720", "link": "https://stackoverflow.com/users/9647683/overlord720"}, "edited": false, "score": 0, "creation_date": 1568818219, "post_id": 57994501, "comment_id": 102397597, "body": "Great. Thank you! I guess this is what happens when the university curriculum teaches old technology, not accounting for the newer developments. Just one more thing, I get why the float parameter isn&#39;t correctly working, but shouldn&#39;t the integer get printed correctly?"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 27, "user_id": 9647683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/701154c84462fdde687d57b6ee1f083f?s=128&d=identicon&r=PG&f=1", "display_name": "Overlord720", "link": "https://stackoverflow.com/users/9647683/overlord720"}, "edited": false, "score": 0, "creation_date": 1568819143, "post_id": 57994501, "comment_id": 102398135, "body": "@ChinmayGupta: Looking at the assembly, I would expect so. <code>main</code> passes all 16 bytes of <code>s</code> in <code>rdi</code> and <code>rsi</code>. Then <code>func1</code> saves <code>rdi</code> to the stack (in two steps, moving it to <code>rdx</code> and then to <code>[rbp-16]</code>\u2014this is unoptimized code). Then it gets 32-bit pieces from the stack (in <code>mov edx, DWORD PTR [rbp-12]</code> and <code>mov eax, DWORD PTR [rbp-16]</code>) and passes those to <code>printf</code>. I would expect the values of <code>i1</code> and <code>i2</code> to survive that. But I do not have GCC installed and cannot run this easily. I have to suspect a mismatch between the code you posted in the question and other experiments you ran."}], "tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": true, "score": 2, "last_activity_date": 1568815501, "last_edit_date": 1568815501, "creation_date": 1568815072, "answer_id": 57994501, "question_id": 57993048, "link": "https://stackoverflow.com/questions/57993048/how-are-c-structures-offsets-stored-in-memory-by-linker/57994501#57994501", "title": "How are C structures &amp; offsets stored in memory by linker?", "body": "<p><a href=\"https://godbolt.org/z/8a8nkN\" rel=\"nofollow noreferrer\">As GCC 9.2 compiles your file with <code>main</code></a>, we see these instructions for the call to <code>func1</code>:</p>\n\n<pre><code>    mov     rdx, QWORD PTR [rbp-16]\n    mov     rax, QWORD PTR [rbp-8]\n    mov     rdi, rdx\n    mov     rsi, rax\n    mov     eax, 0\n    call    func1\n</code></pre>\n\n<p>Note that the compiler has loaded data into general registers\u2014<code>rsi</code>, <code>rdi</code>, and so on. Compare this to <a href=\"https://godbolt.org/z/ymOOG1\" rel=\"nofollow noreferrer\">the instructions in <code>func1</code></a>:</p>\n\n<pre><code>    mov     rdx, rdi\n    movd    eax, xmm0\n    mov     QWORD PTR [rbp-16], rdx\n    mov     DWORD PTR [rbp-8], eax\n    movss   xmm0, DWORD PTR [rbp-8]\n</code></pre>\n\n<p>In particular, note the <code>movss</code> instruction. That is attempting to retrieve the <code>float i3</code> member from the <code>xmm0</code> register. But, as we have seen, the calling routine did not put anything in the <code>xmm0</code> register.</p>\n\n<p>The compiler has a specification for how arguments are passed between routines. This is called an Application Binary Interface. (The ABI is shared by software intended to be compatible on a particular platform and is often recommended by the processor manufacturer.) For small structures, at least in this case, the compiler does not pass them by pointing to them in memory or reproducing their exact layout. Instead, the members are passed individually, as if they were separate arguments.</p>\n\n<p>Because of this, your code is not studying how structures are laid out in memory. It is studying how structures are passed in function calls. And part of the answer is that members are sometimes passed individually, and where they are passed depends in part on their types. Because <code>main</code> is passing only integer data, it uses registers for integer arguments. Because <code>func1</code> is expecting some floating-point data, it looks in a register for that. The result is that <code>func1</code> never gets the data that is passed for <code>i3</code> and <code>i4</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "is_accepted": false, "score": 0, "last_activity_date": 1579968035, "creation_date": 1579968035, "answer_id": 59910928, "question_id": 57993048, "link": "https://stackoverflow.com/questions/57993048/how-are-c-structures-offsets-stored-in-memory-by-linker/59910928#59910928", "title": "How are C structures &amp; offsets stored in memory by linker?", "body": "<p>While Eric's answer is good, I'd like to highlight one additional misunderstanding your question contains:</p>\n\n<blockquote>\n<pre><code>    func1(s);        //Implicit calls, no declarations needed\n</code></pre>\n</blockquote>\n\n<p>The comment is incorrect. C <strong>always requires declarations</strong> of functions. It does allow you to declare it without a prototype, as:</p>\n\n<pre><code>void func1();\n</code></pre>\n\n<p>However, to call it, the promoted type of the arguments must match the actual type in the function's definition (even if that definition is in another translation unit). If it does not match, the behavior is undefined.</p>\n"}], "owner": {"reputation": 27, "user_id": 9647683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/701154c84462fdde687d57b6ee1f083f?s=128&d=identicon&r=PG&f=1", "display_name": "Overlord720", "link": "https://stackoverflow.com/users/9647683/overlord720"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "accepted_answer_id": 57994501, "answer_count": 2, "score": 1, "last_activity_date": 1579968035, "creation_date": 1568810345, "last_edit_date": 1568814726, "question_id": 57993048, "link": "https://stackoverflow.com/questions/57993048/how-are-c-structures-offsets-stored-in-memory-by-linker", "title": "How are C structures &amp; offsets stored in memory by linker?", "body": "<p>I'm interested in systems programming, and want to see how structs are implemented in assembly, and how they are linked. \nI've written three short <code>.c</code> codes, with same named structs but in different files and compiled and linked together, but I can't understand the output. \nI believed that the struct is just a contiguous block of memory in assembly, in the data segment. But, I can't access the values after the first int data, either by using pointers or by having each function use its corresponding files' offsets. Can someone explain the output?</p>\n\n<p>I tried to change data types, implement chars to avoid padding or endian problems. I tried using a <code>char*</code> pointer to print the entire structure, which surprisingly gives me weird values (not random, since they are the same in every execution)</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nstruct S1 \n{\n    int i1;\n    int i2;\n    int i3;\n    int i4;\n    int i5;\n    int i6;\n};\n\nint main()\n{\n    struct S1 s;\n    s.i1 = 5;\n    s.i2 = 10;\n    s.i3 = 15;\n    s.i4 = 16;\n\n    func1(s);        //Implicit calls, no declarations needed\n                     // because linker will know where to find defs\n    func2(s);\n}\n\n</code></pre>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nstruct S1\n{\n    int i1;\n    int i2;\n    float i3;\n};\n\n\nvoid func1(struct S1 s)\n{\n    printf(\"In func1 : %d %d   %f %lu\\n\", s.i1, s.i2, s.i3, sizeof(s));\n};\n\n\n</code></pre>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nstruct S3\n{\n    double i1;\n    int i2;\n};\n\nvoid func2(struct S3 s)\n{\n    printf(\"In func2 : %lf %d %lu \\n\", s.i1, s.i2, sizeof(s));\n};\n\n</code></pre>\n\n<p>I'm getting outputs: </p>\n\n<blockquote>\n  <p>In func1 : 1 0   0.000000 12</p>\n  \n  <p>In func2 : 0.000000 1 16</p>\n</blockquote>\n\n<p>I expected the values to be printed</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "edited": false, "score": 1, "creation_date": 1568810049, "post_id": 57992904, "comment_id": 102392619, "body": "It works fine for me. Are you sure it&#39;s crashing and not just quitting because it&#39;s done?"}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1568810109, "post_id": 57992904, "comment_id": 102392650, "body": "You&#39;re not checking the return value of scanf"}, {"owner": {"reputation": 1894, "user_id": 8473031, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4878bfc9d6a80397a8446111fffa4dd?s=128&d=identicon&r=PG&f=1", "display_name": "RoQuOTriX", "link": "https://stackoverflow.com/users/8473031/roquotrix"}, "edited": false, "score": 1, "creation_date": 1568810191, "post_id": 57992904, "comment_id": 102392704, "body": "Learn to use a debugger, it will help you really fast in writing code"}, {"owner": {"reputation": 251, "user_id": 9913309, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-FRKhTrsYHho/AAAAAAAAAAI/AAAAAAAAKL4/ng4XZJ7uU2k/photo.jpg?sz=128", "display_name": "SuperG280", "link": "https://stackoverflow.com/users/9913309/superg280"}, "edited": false, "score": 1, "creation_date": 1568810349, "post_id": 57992904, "comment_id": 102392789, "body": "Are you running your program from the IDE where you are developing? Have you tried running it from a console? Open a console in the folder you have your program exe file and execute it. If you run it from the IDE, when the program ends, the console would be closed (depends on the IDE you are using) and you can not see the last printf."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1568811977, "post_id": 57992904, "comment_id": 102393703, "body": "Post the exact input - that would help."}], "answers": [{"comments": [{"owner": {"reputation": 11397, "user_id": 1141537, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0f0c5bf8653be794a11259ea2ffd359f?s=128&d=identicon&r=PG", "display_name": "Imran Rana", "link": "https://stackoverflow.com/users/1141537/imran-rana"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1568818937, "post_id": 57993210, "comment_id": 102398029, "body": "@chux thanks for pointing that out. I missed that. Added code for clearing input buffer."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1568819652, "post_id": 57993210, "comment_id": 102398425, "body": "Minor: placing <code>clear input buffer</code> code right after <code>scanf(&quot;%d%d&quot;, &amp;a, &amp;b);</code> is a nice localization."}], "tags": [], "owner": {"reputation": 11397, "user_id": 1141537, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0f0c5bf8653be794a11259ea2ffd359f?s=128&d=identicon&r=PG", "display_name": "Imran Rana", "link": "https://stackoverflow.com/users/1141537/imran-rana"}, "is_accepted": false, "score": 3, "last_activity_date": 1568818753, "last_edit_date": 1568818753, "creation_date": 1568810876, "answer_id": 57993210, "question_id": 57992904, "link": "https://stackoverflow.com/questions/57992904/simple-c-program-wont-run-crashes-in-cmd/57993210#57993210", "title": "Simple C program won&#39;t run. Crashes in CMD", "body": "<p>Once console application returns from main method, the associated console window closes automatically. I assume you are using Windows OS. In that case add a <code>system(\"pause\");</code> before your <code>return 0;</code> statement. \nFor platform independent solution you can just show a prompt to user and wait for a key press before returning from main. As @chux pointed out in comment any character remaining in input buffer (enter from scanf in this case) must be cleared.</p>\n\n<pre><code>    #include &lt;stdio.h&gt;\n\n    int main()\n\n    {\n       int a, b, c;\n\n       printf(\"Enter two numbers to add\\n\");\n       scanf(\"%d%d\", &amp;a, &amp;b);\n\n       c = a + b;\n\n       printf(\"Sum of the numbers = %d\\n\", c);\n       //clear input buffer\n       int d;\n       while ((d = getchar()) != '\\n' &amp;&amp; d != EOF) { }\n       printf(\"Press ENTER key to Continue\\n\");  \n       getchar(); \n       return 0;\n    }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 164, "user_id": 5138445, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-EWRY5YxkFAA/AAAAAAAAAAI/AAAAAAAAHXQ/-BpBNll5Zq4/photo.jpg?sz=128", "display_name": "F&#235;amarto", "link": "https://stackoverflow.com/users/5138445/f%c3%abamarto"}, "is_accepted": false, "score": 1, "last_activity_date": 1568812106, "creation_date": 1568812106, "answer_id": 57993565, "question_id": 57992904, "link": "https://stackoverflow.com/questions/57992904/simple-c-program-wont-run-crashes-in-cmd/57993565#57993565", "title": "Simple C program won&#39;t run. Crashes in CMD", "body": "<blockquote>\n  <p>CMD prompt just closes without warning and never spits out an answer </p>\n</blockquote>\n\n<p>Seems like you are opening a new terminal on Windows machine. I compiled the code and it works. Your program closes just after printing the answer so you simply cannot see it. Stop it artificially before the end. To prove it add the following line directly before return:</p>\n\n<pre><code>scanf(\"%c\", &amp;a);\n</code></pre>\n\n<p>This will result in stopping the program and waiting for input. You will need to enter another number which will essentially be ignored but will stop the program so you can see the output. This is not a good target solution though due to you need to enter some characters to go on and exit but it proves the point :)</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user12085035"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1568818753, "creation_date": 1568809894, "last_edit_date": 1568809923, "question_id": 57992904, "link": "https://stackoverflow.com/questions/57992904/simple-c-program-wont-run-crashes-in-cmd", "title": "Simple C program won&#39;t run. Crashes in CMD", "body": "<p>I'm new to programming in C and I'm trying to build and execute my first programs. My first program was Hello, World printed in the CMD like many of you. It worked great. Now it's onto bigger and better projects though and I'm having a weird issue.</p>\n\n<p>I'm trying to make a basic addition calculator using standard IO operations (scanf and printf) and it won't function properly. </p>\n\n<p>My program asks for 2 numbers to be input by the user and it will then display the output of said calculation. The program executes flawlessly until the scanf expression comes into play. After I input my 2 numbers to be added the CMD prompt just closes without warning and never spits out an answer or the text I have to be displayed afterward.</p>\n\n<p>I tried multiple solutions to fix this problem including copying and pasting the source code directly from the website I was learning from, even their perfect code nets the same outcome..just a crash before an output is displayed. I'm posting today because I'm wondering where my issue is coming from because I'm just not sure why this program won't execute as it's supposed to. Thanks in advance and heres the code I'm working with:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main()\n\n{\n   int a, b, c;\n\n   printf(\"Enter two numbers to add\\n\");\n   scanf(\"%d%d\", &amp;a, &amp;b);\n\n   c = a + b;\n\n   printf(\"Sum of the numbers = %d\\n\", c);\n\n   return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "scanf", "newline"], "answers": [{"comments": [{"owner": {"reputation": 14339, "user_id": 1466970, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/V1J6z.jpg?s=128&g=1", "display_name": "Richard Chambers", "link": "https://stackoverflow.com/users/1466970/richard-chambers"}, "edited": false, "score": 0, "creation_date": 1568811090, "post_id": 57992885, "comment_id": 102393192, "body": "My impression from the wording of the question is the OP does not know about buffering of input."}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "reply_to_user": {"reputation": 14339, "user_id": 1466970, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/V1J6z.jpg?s=128&g=1", "display_name": "Richard Chambers", "link": "https://stackoverflow.com/users/1466970/richard-chambers"}, "edited": false, "score": 0, "creation_date": 1568811897, "post_id": 57992885, "comment_id": 102393651, "body": "@Richard - Good point.  I&#39;ve added a few lines, and links to touch on that.  Thanks"}, {"owner": {"reputation": 23, "user_id": 10618040, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-uPhNX4qa0M4/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbBqHyynYcBbAoo3vCFr9qyX0jq3dg/mo/photo.jpg?sz=128", "display_name": "dotthor", "link": "https://stackoverflow.com/users/10618040/dotthor"}, "reply_to_user": {"reputation": 14339, "user_id": 1466970, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/V1J6z.jpg?s=128&g=1", "display_name": "Richard Chambers", "link": "https://stackoverflow.com/users/1466970/richard-chambers"}, "edited": false, "score": 0, "creation_date": 1568817765, "post_id": 57992885, "comment_id": 102397300, "body": "As @RichardChambers pointed out i&#39;m pretty new to programming and I only know the basics (if I do) of <i>C</i> . So the first part is out of my hands for now. Nonetheless thanks to the second part of your explanation I got the point that I was missing."}], "tags": [], "owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "is_accepted": true, "score": 2, "last_activity_date": 1568812814, "last_edit_date": 1568812814, "creation_date": 1568809830, "answer_id": 57992885, "question_id": 57992737, "link": "https://stackoverflow.com/questions/57992737/explanation-about-detecting-end-of-line-in-c/57992885#57992885", "title": "Explanation about detecting end of line in C", "body": "<p><em>...What is the purpose of this</em>...  </p>\n\n<p>For context in understanding what this code snippet can be used for, take a look at <em><a href=\"http://www.pixelbeat.org/programming/stdio_buffering/\" rel=\"nofollow noreferrer\">this link</a></em> discussing stdio buffering.\nIn simplest logical terms, this technique consumes content placed in <em><a href=\"https://en.wikipedia.org/wiki/Standard_streams\" rel=\"nofollow noreferrer\">stdin</a></em> until the <code>newline</code> character is seen. (From a user hitting the <code>&lt;enter&gt;</code> key.)  This is evidently the lesson.<br>\nThis effectively clears the <code>stdin</code> buffer of content, also described <em><a href=\"https://stackoverflow.com/a/36723075/645128\">in this more robust example</a></em>.     </p>\n\n<p><em>Also what does</em>   </p>\n\n<blockquote>\n  <p>\"the following loop will read and ignore all remaining characters in\n  the current input line\"</p>\n</blockquote>\n\n<p><em>mean actually?</em></p>\n\n<pre><code>do {\n    scanf(\"%c\", &amp;ch);\n} while (ch != '\\n');\n</code></pre>\n\n<p>It means that if the new <code>char</code> just read by <code>scanf</code> is not equal to the newline character, defined as <code>\\n</code>, it will continue to overwrite <code>c</code> with the next read.  Once <code>ch</code> does equal <code>\\n</code>, the loop will exit.  </p>\n"}], "owner": {"reputation": 23, "user_id": 10618040, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-uPhNX4qa0M4/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbBqHyynYcBbAoo3vCFr9qyX0jq3dg/mo/photo.jpg?sz=128", "display_name": "dotthor", "link": "https://stackoverflow.com/users/10618040/dotthor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 191, "favorite_count": 0, "accepted_answer_id": 57992885, "answer_count": 1, "score": 2, "last_activity_date": 1568812814, "creation_date": 1568809393, "last_edit_date": 1568810483, "question_id": 57992737, "link": "https://stackoverflow.com/questions/57992737/explanation-about-detecting-end-of-line-in-c", "title": "Explanation about detecting end of line in C", "body": "<p>I'm reading/practicing with this book about C language: \"C Programming - A Modern Approach 2\" and I stumbled upon this piece of code whose explanation is odd to me:</p>\n\n<blockquote>\n  <p><em>Since</em> <strong>scanf</strong> <em>doesn't normally skip white spaces, it's easy to detect the end of an input line: check to see if the character just\n  read is the</em> <strong>new-line</strong> <em>character. For example, the following loop\n  will read and ignore all remaining characters in the current input\n  line:</em></p>\n</blockquote>\n\n<pre class=\"lang-c prettyprint-override\"><code>do {\n    scanf(\"%c\", &amp;ch);\n} while (ch != '\\n');\n</code></pre>\n\n<blockquote>\n  <p><em>When</em> <strong>scanf</strong> <em>is called the next time, it will read the first character on the next input line.</em></p>\n</blockquote>\n\n<p>I understand the functioning of the code (it exits the loop when it detects <em>enter</em> or <code>'\\n'</code>) but not the lesson(?).</p>\n\n<p>What is the purpose of this, since to store the input from the user into <code>&amp;ch</code> you HAVE to press the <em>enter</em> key (quitting the loop)?</p>\n\n<p>Also what does \"the following loop will read and ignore all remaining characters in the current input line\" mean actually?</p>\n"}, {"tags": ["c", "windows", "winapi", "portable-executable"], "comments": [{"owner": {"reputation": 8787, "user_id": 6601582, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd0a2f69702729da5aaa628bc58811a7?s=128&d=identicon&r=PG&f=1", "display_name": "Rita Han", "link": "https://stackoverflow.com/users/6601582/rita-han"}, "edited": false, "score": 0, "creation_date": 1568883066, "post_id": 57992569, "comment_id": 102418931, "body": "You can use <a href=\"https://docs.microsoft.com/en-us/cpp/build/reference/dash-exports?view=vs-2019\" rel=\"nofollow noreferrer\">dumpbin</a> utility to get the result and compare with yours. Refer to <a href=\"https://stackoverflow.com/questions/4298331/exe-or-dll-image-base-address\">here</a>."}, {"owner": {"reputation": 445, "user_id": 4582609, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WZ1XW.jpg?s=128&g=1", "display_name": "Jovibor", "link": "https://stackoverflow.com/users/4582609/jovibor"}, "edited": false, "score": 0, "creation_date": 1568899685, "post_id": 57992569, "comment_id": 102428460, "body": "See, how it&#39;s done <a href=\"https://github.com/jovibor/libpe/blob/689f352c7d4433fd217454d019611486418d6a50/libpe/src/clibpe.cpp#L1126\" rel=\"nofollow noreferrer\">here</a>."}, {"owner": {"reputation": 851, "user_id": 2646573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c108dcba20e4f430914b3b5f19e2d32?s=128&d=identicon&r=PG", "display_name": "Erlend Graff", "link": "https://stackoverflow.com/users/2646573/erlend-graff"}, "edited": false, "score": 0, "creation_date": 1569257540, "post_id": 57992569, "comment_id": 102529934, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/49705700/show-info-about-image-export-directory\">Show info about IMAGE_EXPORT_DIRECTORY</a>"}], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 7378836, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/35d6d8990e6444d2ed15c30c693dd89b?s=128&d=identicon&r=PG&f=1", "display_name": "Orih90", "link": "https://stackoverflow.com/users/7378836/orih90"}, "edited": false, "score": 0, "creation_date": 1569170596, "post_id": 58011201, "comment_id": 102500671, "body": "This is not working. I put the new condition instead of the old one and tried it over user32.dll."}, {"owner": {"reputation": 57, "user_id": 7378836, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/35d6d8990e6444d2ed15c30c693dd89b?s=128&d=identicon&r=PG&f=1", "display_name": "Orih90", "link": "https://stackoverflow.com/users/7378836/orih90"}, "edited": false, "score": 0, "creation_date": 1569172101, "post_id": 58011201, "comment_id": 102501103, "body": "Even when I try only to iterate the names it failed. What is wrong with this code:  <code>for (int j = 0; j &lt; ptrExportsDirectory-&gt;NumberOfNames; j++) { \t\tDWORD export_symname_rva = ptrExportsNamesOrdinals[j]; \t\tconst char *export_symname = (const char *)(export_symname_rva + imageBase); \t\tprintf(&quot;%s&quot;, export_symname); \t\t \t}</code>"}], "tags": [], "owner": {"reputation": 851, "user_id": 2646573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c108dcba20e4f430914b3b5f19e2d32?s=128&d=identicon&r=PG", "display_name": "Erlend Graff", "link": "https://stackoverflow.com/users/2646573/erlend-graff"}, "is_accepted": false, "score": 1, "last_activity_date": 1568896658, "creation_date": 1568896658, "answer_id": 58011201, "question_id": 57992569, "link": "https://stackoverflow.com/questions/57992569/how-to-dump-pes-exports-functions-names-with-c/58011201#58011201", "title": "How to dump PEs exports functions names with C?", "body": "<p>The condition</p>\n\n<pre><code>(ptrExportsNamesOrdinals[j] == i + ptrExportsDirectory-&gt;Base)\n</code></pre>\n\n<p>used in the if test is wrong. The Export Ordinal Table actually does not contain ordinals, but indices into the Export Address Table (this is an error in the PE/COFF specification - see <a href=\"https://stackoverflow.com/a/40001778/2646573\">https://stackoverflow.com/a/40001778/2646573</a>).</p>\n\n<p>The test condition you should use instead is</p>\n\n<pre><code>(ptrExportsNamesOrdinals[j] == i)\n</code></pre>\n\n<p>as shown in the example here: <a href=\"https://stackoverflow.com/a/49708023/2646573\">https://stackoverflow.com/a/49708023/2646573</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 57, "user_id": 7378836, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/35d6d8990e6444d2ed15c30c693dd89b?s=128&d=identicon&r=PG&f=1", "display_name": "Orih90", "link": "https://stackoverflow.com/users/7378836/orih90"}, "is_accepted": true, "score": 0, "last_activity_date": 1569178476, "creation_date": 1569178476, "answer_id": 58052468, "question_id": 57992569, "link": "https://stackoverflow.com/questions/57992569/how-to-dump-pes-exports-functions-names-with-c/58052468#58052468", "title": "How to dump PEs exports functions names with C?", "body": "<p>What I did to fix it:</p>\n\n<pre><code>PDWORD ptrExportsFunctions = (PDWORD)(imageBase + ptrExportsDirectory-&gt;AddressOfFunctions);\nPDWORD ptrExportsNames = (PDWORD)(imageBase + ptrExportsDirectory-&gt;AddressOfNames);\nPWORD ptrExportsNamesOrdinals = (PWORD)(imageBase + ptrExportsDirectory-&gt;AddressOfNameOrdinals);\n</code></pre>\n\n<p>And than in the loop:</p>\n\n<pre><code>for (DWORD j = 0; j &lt; ptrExportsDirectory-&gt;NumberOfNames; j++)\n    {\n        if(ptrExportsNamesOrdinals[j] == i){\n            printf(\"%s\", (char*)imageBase + ptrExportsNames[j]);\n        }\n    }\n</code></pre>\n\n<p>Now Everything works well.</p>\n"}], "owner": {"reputation": 57, "user_id": 7378836, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/35d6d8990e6444d2ed15c30c693dd89b?s=128&d=identicon&r=PG&f=1", "display_name": "Orih90", "link": "https://stackoverflow.com/users/7378836/orih90"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 58052468, "answer_count": 2, "score": 0, "last_activity_date": 1569178476, "creation_date": 1568808871, "question_id": 57992569, "link": "https://stackoverflow.com/questions/57992569/how-to-dump-pes-exports-functions-names-with-c", "title": "How to dump PEs exports functions names with C?", "body": "<p>I'm trying to parse the PE files using C. The imports parsing is good but i have problem with the exports parsing. This is the code that I have wrote in order to parse the exports:</p>\n\n<pre><code>void PrintExports(DWORD imageBase) {\n\n// Get the export section.\nPIMAGE_DOS_HEADER ptrDosHeader = (PIMAGE_DOS_HEADER)imageBase;\nPIMAGE_NT_HEADERS32 ptrNtHeaders = (PIMAGE_NT_HEADERS32)(ptrDosHeader-&gt;e_lfanew + imageBase);\nDWORD exportsStartRVA = ptrNtHeaders-&gt;OptionalHeader.DataDirectory[IMAGE_DIRECTORY_ENTRY_EXPORT].VirtualAddress;\nDWORD exportsEndRVA = exportsStartRVA + ptrNtHeaders-&gt;OptionalHeader.DataDirectory[IMAGE_DIRECTORY_ENTRY_EXPORT].Size;\nPIMAGE_SECTION_HEADER ptrExportsHeader = GetSectionHeaderByRVA(exportsStartRVA, ptrNtHeaders);\n\n// Check it's not null..\nif (!ptrExportsHeader) \n    return;\n\nPIMAGE_EXPORT_DIRECTORY ptrExportsDirectory = (PIMAGE_EXPORT_DIRECTORY)(imageBase + exportsStartRVA );\n\nprintf(\"Exports\\n\");\nprintf(\"    Exports.section: %s\\n\", ptrExportsHeader-&gt;Name);\nprintf(\"    Exports.ordinalBase: %x\\n\", ptrExportsDirectory-&gt;Base);\nprintf(\"    Exports.NumberOfFunctions: %x (hex)\\n\", ptrExportsDirectory-&gt;NumberOfFunctions);\nprintf(\"    Exports.NumberOfNames: %x (hex)\\n\", ptrExportsDirectory-&gt;NumberOfNames);\n\nPDWORD ptrExportsFunctions = (PDWORD)((DWORD)ptrExportsDirectory-&gt;AddressOfFunctions + imageBase);\nPDWORD ptrExportsNamesOrdinals = (PDWORD)((DWORD)ptrExportsDirectory-&gt;AddressOfNameOrdinals + imageBase);\nPDWORD * ptrExportsNames = (PDWORD *)((DWORD)ptrExportsDirectory-&gt;AddressOfNames + imageBase);\n\nprintf(\"    Exports.functions:\\n\");\nprintf(\"        EntryPoint  Ordinal  Name\\n\");\n\nfor (int i = 0; i &lt; ptrExportsDirectory-&gt;NumberOfFunctions; i++) {\n    if (ptrExportsFunctions[i] == 0)\n        continue;\n\n    printf(\"        %010x  %07x\", ptrExportsFunctions[i], i + ptrExportsDirectory-&gt;Base);\n\n    if ((ptrExportsFunctions[i] &gt;= exportsStartRVA) &amp;&amp; (ptrExportsFunctions[i] &lt;= exportsEndRVA))\n        printf(\" (forwarder -&gt; %s)\", ptrExportsFunctions[i] + imageBase);\n\n    printf(\"\\n\");\n}\n\nreturn;\n}\n</code></pre>\n\n<p>As  a result of running this code, I get the ordinals and the addresses of the exports. The problem starts when I'm trying to get the names with the code below (this code should be inside the \"for\" loop). What happens is that I get access violation exception (the PE I'm trying to parse in this example is shell32.dll):</p>\n\n<pre><code>for (int j = 0; j &lt; ptrExportsDirectory-&gt;NumberOfNames; j++) {\n        if (ptrExportsNamesOrdinals[j] == i + ptrExportsDirectory-&gt;Base) {\n            printf(\"  %s\", ptrExportsNames[j]);\n        }\n    }\n</code></pre>\n\n<p>Moreover, in some cases (for example if the PE I'm trying to parse is user32.dll) the <em>ptrExportsNamesOrdinal[j]</em> has value that can never be equal to <em>i + ptrExportsDirectory->Base</em>. You can see the screenshot below:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Egwv9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Egwv9.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c++", "c", "wayland", "uinput"], "answers": [{"tags": [], "owner": {"reputation": 129, "user_id": 11190671, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48b6fdc090508f18b0ded988cc4b0745?s=128&d=identicon&r=PG&f=1", "display_name": "AJ Cole", "link": "https://stackoverflow.com/users/11190671/aj-cole"}, "is_accepted": false, "score": 0, "last_activity_date": 1568808819, "creation_date": 1568808819, "answer_id": 57992547, "question_id": 57992400, "link": "https://stackoverflow.com/questions/57992400/uinput-emulate-lwin-s-under-wayland-weston/57992547#57992547", "title": "uinput emulate LWIN + S under wayland/weston", "body": "<p>I actually found it out a few minutes afer posting this! And it works!</p>\n\n<p>The key code is KEY_LEFTMETA, i found it out using the evtest package. Screenshot is successfully made.</p>\n"}], "owner": {"reputation": 129, "user_id": 11190671, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48b6fdc090508f18b0ded988cc4b0745?s=128&d=identicon&r=PG&f=1", "display_name": "AJ Cole", "link": "https://stackoverflow.com/users/11190671/aj-cole"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 97, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1568808819, "creation_date": 1568808328, "question_id": 57992400, "link": "https://stackoverflow.com/questions/57992400/uinput-emulate-lwin-s-under-wayland-weston", "title": "uinput emulate LWIN + S under wayland/weston", "body": "<p>I'm trying to emulate a key combination of Left Windows Key (Super) + S under wayland to perform a screenshot automatically (this key combination properly starts weston-screenshooter that saves a screenshot to the home directory, but it cannot be executed from terminal).\nI found out about using uinput to do this, I found a few examples and came up with this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;linux/input.h&gt;\n#include &lt;linux/uinput.h&gt;\n\n#define die(str) do { \\\n        perror(str); \\\n        exit(EXIT_FAILURE); \\\n    } while(0)\n\nvoid emitEvent(int fd, uint16_t type, uint16_t code, int val)\n{\n    struct input_event ie;\n\n    ie.type = type;\n    ie.code = code;\n    ie.value = val;\n    /* timestamp values below are ignored */\n    ie.time.tv_sec = 0;\n    ie.time.tv_usec = 0;\n\n    write(fd, &amp;ie, sizeof(ie));\n}\n\n#define UI_DEV_SETUP _IOW(UINPUT_IOCTL_BASE, 3, struct uinput_setup)\n\nint main(int argc, char *argv[])\n{\n    int                    fd;\n    struct uinput_user_dev uidev;\n\n    fd = open(\"/dev/uinput\", O_WRONLY | O_NONBLOCK);\n    if(fd &lt; 0)\n        die(\"error: open\");\n\n    if(ioctl(fd, UI_SET_EVBIT, EV_KEY) &lt; 0)\n        die(\"error: ioctl\");\n    if(ioctl(fd, UI_SET_KEYBIT, KEY_S) &lt; 0)\n        die(\"error: ioctl\");\n    if(ioctl(fd, UI_SET_KEYBIT, 133) &lt; 0)\n        die(\"error: ioctl\");\n\n    memset(&amp;uidev, 0, sizeof(uidev));\n    snprintf(uidev.name, UINPUT_MAX_NAME_SIZE, \"uinput-sample\");\n    uidev.id.bustype = BUS_USB;\n    uidev.id.vendor  = 0x1234; // random stuff\n    uidev.id.product = 0x6433;\n    uidev.id.version = 1;\n\n    if(write(fd, &amp;uidev, sizeof(uidev)) &lt; 0)\n        die(\"error: write\");\n\n    if(ioctl(fd, UI_DEV_CREATE) &lt; 0)\n        die(\"error: ioctl\");\n\n    sleep(1);\n\n   // srand(time(NULL));\n\n    emitEvent(fd, EV_KEY, 133, 1);\n    emitEvent(fd, EV_KEY, KEY_S, 1);\n    emitEvent(fd, EV_SYN, SYN_REPORT, 0);\n    usleep(300);\n    emitEvent(fd, EV_KEY, KEY_S, 0);\n    emitEvent(fd, EV_KEY, 133, 0);\n    emitEvent(fd, EV_SYN, SYN_REPORT, 0);\n\n    sleep(1);\n\n    if(ioctl(fd, UI_DEV_DESTROY) &lt; 0)\n        die(\"error: ioctl\");\n\n    close(fd);\n\n    return 0;\n}\n</code></pre>\n\n<p>My biggest problem is that I don't know which KEY_ is the Left Win/Left Super key, the key definitons aren't showing me anything related to win or super or mod_s at all, using xev on x11 i found that LWIN should be 133, but I think it's not correct because KEY_S = 31 in code but in xev it's 39.</p>\n\n<p>When running the application I can see the device is being registered in the system:</p>\n\n<pre><code>[ 6278.405013] input: uinput-sample as /devices/virtual/input/input23\n[14:02:17.556] event2  - [14:02:17.556] uinput-sample: [14:02:17.556] is tagged by udev as: Keyboard\n[14:02:17.556] event2  - [14:02:17.557] uinput-sample: [14:02:17.557] device is a keyboard\n[14:02:19.549] event2  - [14:02:19.550] uinput-sample: [14:02:19.550] device removed\n</code></pre>\n\n<p>but nothing else is happening.</p>\n\n<p>What is the proper key definition for Left Windows key? Is the code above valid for sending a key <strong>combination</strong> (2 keys pressed at once)? Is it even possible to achieve what I want? I have full root access in the system.</p>\n"}, {"tags": ["c", "cryptography", "asn.1", "wolfssl"], "answers": [{"tags": [], "owner": {"reputation": 526, "user_id": 4629630, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7DX63.png?s=128&g=1", "display_name": "Kaleb", "link": "https://stackoverflow.com/users/4629630/kaleb"}, "is_accepted": true, "score": 1, "last_activity_date": 1568834914, "creation_date": 1568834914, "answer_id": 57999606, "question_id": 57992383, "link": "https://stackoverflow.com/questions/57992383/how-to-import-der-certificate-in-wolfssl-using-wc-eccpublickeydecode/57999606#57999606", "title": "How to import der certificate in wolfssl using wc_EccPublicKeyDecode", "body": "<p>Like you mentioned, you have a certificate and you're trying to pass it into an API that expects just a key, not a cert.</p>\n\n<p>Try using InitDecodedCert(), ParseCert(), to first decode the cert into it's respective parts in a DecodedCert structure. Then pass cert->publicKey to wc_EccPublicKeyDecode()! (Don't forget to FreeDecodedCert() when you're done).</p>\n\n<p>NOTE: You will need to use the setting <code>WOLFSSL_TEST_CERT</code> to expose <code>ParseCert()</code> to calling applications, it is an opaque API by default.</p>\n\n<p>You can contact the wolfSSL support team at support@wolfssl.com if you have any followup questions and for best response times.</p>\n\n<p>Thanks!</p>\n\n<ul>\n<li>KH</li>\n</ul>\n"}], "owner": {"reputation": 127, "user_id": 3714693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0497e09be8567271a694f917eee6a7a8?s=128&d=identicon&r=PG&f=1", "display_name": "Ulli", "link": "https://stackoverflow.com/users/3714693/ulli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 57999606, "answer_count": 1, "score": 0, "last_activity_date": 1568834914, "creation_date": 1568808273, "question_id": 57992383, "link": "https://stackoverflow.com/questions/57992383/how-to-import-der-certificate-in-wolfssl-using-wc-eccpublickeydecode", "title": "How to import der certificate in wolfssl using wc_EccPublicKeyDecode", "body": "<p>I try to import a public key of a certificate to have it in ecc_key structure for further usage.</p>\n\n<p>For this I found in the wolfssl API documentation this <a href=\"https://wolfssl.com/doxygen/group__ASN.html#gac74ae74bda8f69bddb81879f7b37e2b2\" rel=\"nofollow noreferrer\">wc_EccPublicKeyDecode</a> function. I tried to use it in to load the certificate into the ecc_key struct.</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>const byte b64_cert[] = \"MIIB6TCCAY+gAwIBAgIJAPhfFTGxGQMtMAoGCCqGSM49BAMCMFExCzAJBgNVBAYT\"\n                        \"AlhYMQswCQYDVQQIDAJYWDELMAkGA1UEBwwCWFgxCzAJBgNVBAoMAlhYMQswCQYD\"\n                        \"VQQLDAJYWDEOMAwGA1UEAwwFWFhYWFgwHhcNMTkwOTE4MTExMDQ3WhcNMjAwOTE3\"\n                        \"MTExMDQ3WjBRMQswCQYDVQQGEwJYWDELMAkGA1UECAwCWFgxCzAJBgNVBAcMAlhY\"\n                        \"MQswCQYDVQQKDAJYWDELMAkGA1UECwwCWFgxDjAMBgNVBAMMBVhYWFhYMFkwEwYH\"\n                        \"KoZIzj0CAQYIKoZIzj0DAQcDQgAEOJdKmIL9KXUMcrR2obrUuyDsWoj7GFYxnGAI\"\n                        \"wKz7aWgKenLL9pOTs5xhIkeZIEekkRayhV++CqMzEHRJhF6vNaNQME4wHQYDVR0O\"\n                        \"BBYEFKtf9OtFyPb7GIkxjXsc8LbI6p4xMB8GA1UdIwQYMBaAFKtf9OtFyPb7GIkx\"\n                        \"jXsc8LbI6p4xMAwGA1UdEwQFMAMBAf8wCgYIKoZIzj0EAwIDSAAwRQIhANN9YLSc\"\n                        \"VcEQn/JEKcdPxdR70SnDkEa0hCrm3yiZqXSAAiB9krAmY/Shv2yq2sTD+84x7s9K\"\n                        \"XcPcX00w1JyeaIbaDw==\";\n\nuint8_t der_cert[1000] = {0};\nword32 size_of_cert = 1000;\necc_key eccKey;\nint wolfssl_ret = wc_ecc_init(&amp;eccKey);\n\nBase64_Decode(b64_cert, sizeof(b64_cert), der_cert, &amp;size_of_cert);\nword32 idx = 0;\nwolfssl_ret = wc_EccPublicKeyDecode( der_cert, &amp;idx, &amp;eccKey, size_of_cert );\nprintf(\"wc_EccPublicKeyDecode failed! Wolfssl error = %d\", wolfssl_ret);\n\n</code></pre>\n\n<p>But unfortunately I get always an ASN_OBJECT_ID_E (-144) error code:</p>\n\n<pre><code>wc_EccPublicKeyDecode failed! Wolfssl error = -144\n</code></pre>\n\n<p>So what am I doing wrong? Do I use the wrong function?\nHow else could I import a DER/PEM certificate to an ecc_key structure?</p>\n"}, {"tags": ["c", "loops", "for-loop", "do-while", "c-strings"], "comments": [{"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "edited": false, "score": 6, "creation_date": 1568807004, "post_id": 57991968, "comment_id": 102390924, "body": "<code>ch</code> is an array type. It can&#39;t be used as the left operand of assignment operator."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 3, "creation_date": 1568807401, "post_id": 57991968, "comment_id": 102391126, "body": "... nor does the whole array correspond correctly to the <code>%c</code> printf directive.  Did you perhaps mean <code>ch[i]</code> (pretty much everywhere within the loop body)?"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1568807988, "post_id": 57991968, "comment_id": 102391421, "body": "... and <code>i&lt;=strlen(s)+1</code> is one byte off"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1568808093, "post_id": 57991968, "comment_id": 102391477, "body": "BTW there is no real string type in C where you can do things like <code>mystring = yourstring + &quot; Hello&quot;</code> etc. Read the chapter dealing with strings in your C text book."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1568808135, "post_id": 57991968, "comment_id": 102391496, "body": "What is <code>s=s+&#39; &#39;</code>?  That&#39;s not going to work.  (It&#39;ll make <code>s</code> point 32 locations beyond where it used to.)"}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 12084755, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mA2VvYMRhqga2HlFTFhse097v6NienB8hA3e7Tx7g=k-s128", "display_name": "muskan litw", "link": "https://stackoverflow.com/users/12084755/muskan-litw"}, "edited": false, "score": 0, "creation_date": 1569233121, "post_id": 57992488, "comment_id": 102516838, "body": "thank you! i still have a doubt why do we need to add two more space ? one is for space i understand but what is the other for?"}, {"owner": {"reputation": 29641, "user_id": 10871073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ddBW9.png?s=128&g=1", "display_name": "Adrian Mole", "link": "https://stackoverflow.com/users/10871073/adrian-mole"}, "reply_to_user": {"reputation": 31, "user_id": 12084755, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mA2VvYMRhqga2HlFTFhse097v6NienB8hA3e7Tx7g=k-s128", "display_name": "muskan litw", "link": "https://stackoverflow.com/users/12084755/muskan-litw"}, "edited": false, "score": 0, "creation_date": 1569236642, "post_id": 57992488, "comment_id": 102518625, "body": "The <code>strlen</code> function returns the length of the string, in character, but <b><i>does not include</i></b> the terminating <code>nul</code> character. So, for a string, &quot;abcde&quot;, <code>strlen</code> will return a value of 5 \u2026 but we will need an array of <b>6</b> chars to store it: &#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;, &#39;e&#39;, and &#39;nul&#39;. Does this make sense?"}], "tags": [], "owner": {"reputation": 29641, "user_id": 10871073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ddBW9.png?s=128&g=1", "display_name": "Adrian Mole", "link": "https://stackoverflow.com/users/10871073/adrian-mole"}, "is_accepted": true, "score": 0, "last_activity_date": 1568808948, "last_edit_date": 1568808948, "creation_date": 1568808614, "answer_id": 57992488, "question_id": 57991968, "link": "https://stackoverflow.com/questions/57991968/assignment-to-expression-with-array-type-ch-chsi/57992488#57992488", "title": "assignment to expression with array type ch= ch+(s[i]);", "body": "<p>There are a number of mistakes in your code (some pointed out in the comments). Here's a working fix, that does what I <strong><em>think</em></strong> you're looking for:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main() {\n    char* s;\n    s = malloc(1024 * sizeof(char));\n    scanf(\"%[^\\n]\", s);\n    s = realloc(s, strlen(s) + 2); // Add 2 because you later append a space!\n    //Write your logic to print the tokens of the sentence here.\n    //i\n    char ch[50] = { '\\0' }; // Make sure you initialise the buffer!\n    int i;\n//  s = s + ' '; // This doesn't do what you think - it's adding the value of ' ' to the string's address!\n    strcat(s, \" \"); // This appends a blank to the string!\n    for (i = 0; i &lt; strlen(s); i++) // For 7 chars, will do [0] thru [6]!\n    {\n        if (s[i] != ' ')\n        {\n        //  ch = ch + (s[i]); // You can't just 'add; an element to an array!\n            ch[i] = s[i];\n        }\n        else\n        {\n        //  printf(\"%c \\n\", ch);\n            printf(\"%s \\n\", ch); // Use this to print the entire ch string so far!\n            ch[i] = ' ';\n        }\n    }\n    return 0;\n}\n</code></pre>\n\n<p>I've put comments where I've changed your code; feel free to ask for further explanations!</p>\n"}, {"comments": [{"owner": {"reputation": 29641, "user_id": 10871073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ddBW9.png?s=128&g=1", "display_name": "Adrian Mole", "link": "https://stackoverflow.com/users/10871073/adrian-mole"}, "edited": false, "score": 0, "creation_date": 1568809199, "post_id": 57992575, "comment_id": 102392127, "body": "A better answer than mine! Your assumption on what the desired output should be is also probably correct. You get my UV!"}], "tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 1, "last_activity_date": 1568809855, "last_edit_date": 1568809855, "creation_date": 1568808892, "answer_id": 57992575, "question_id": 57991968, "link": "https://stackoverflow.com/questions/57991968/assignment-to-expression-with-array-type-ch-chsi/57992575#57992575", "title": "assignment to expression with array type ch= ch+(s[i]);", "body": "<p>For starters this loop </p>\n\n<pre><code>for(i=0;i&lt;=strlen(s)+1;i++)\n</code></pre>\n\n<p>invokes undefined behavior  when i is equal to <code>strlen(s)+1</code> because there is an attempt to access memory beyond the dynamically allocated array.</p>\n\n<p>These statements</p>\n\n<pre><code>ch= ch+(s[i]);\n</code></pre>\n\n<p>and</p>\n\n<pre><code>ch=' ';\n</code></pre>\n\n<p>do not make sense. Arrays do not have the operator <code>+</code> and they are non-modifiable lvalues.</p>\n\n<p>A for-loop is not appropriate for such a task because within the loop the last word will not be outputted.</p>\n\n<p>What you mean is the following.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint main(void) \n{\n    char *s;\n    s = malloc(1024 * sizeof( char ) );\n\n    scanf(\"%1023[^\\n]\", s);\n    s = realloc(s, strlen(s) + 1);\n\n\n    char ch[50] = { '\\0' };\n\n    size_t i = 0, j = 0;\n\n    do\n    {\n        if ( s[i] != ' ' &amp;&amp; s[i] != '\\t' &amp;&amp; s[i] != '\\0' )\n        {\n            ch[j++] = s[i];\n        }\n        else if ( ch[0] != '\\0' )\n        {\n            ch[j] = '\\0';\n            puts( ch );\n            j = 0;\n            ch[j] = '\\0';\n        }\n    } while ( s[i++] != '\\0' );\n\n    return 0;\n}\n</code></pre>\n\n<p>If to enter </p>\n\n<pre><code>Hello muskan litw\n</code></pre>\n\n<p>then the program output will be</p>\n\n<pre><code>Hello\nmuskan\nlitw\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 12084755, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mA2VvYMRhqga2HlFTFhse097v6NienB8hA3e7Tx7g=k-s128", "display_name": "muskan litw", "link": "https://stackoverflow.com/users/12084755/muskan-litw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "accepted_answer_id": 57992488, "answer_count": 2, "score": 1, "last_activity_date": 1569231184, "creation_date": 1568806944, "last_edit_date": 1569231184, "question_id": 57991968, "link": "https://stackoverflow.com/questions/57991968/assignment-to-expression-with-array-type-ch-chsi", "title": "assignment to expression with array type ch= ch+(s[i]);", "body": "<p>i am not able to to store character of the character pointer array s into character array ch:</p>\n\n<pre><code>    int main() {\n    char *s;\n    s = malloc(1024 * sizeof(char));\n    scanf(\"%[^\\n]\", s);\n    s = realloc(s, strlen(s) + 1);\n    char ch[50];\n    int i;\n    s=s+' ';\n    for(i=0;i&lt;=strlen(s)+1;i++)\n    {\n        if(s[i]!=' ')\n        {\n            ch= ch+(s[i]);\n        }\n        else\n        {\n            printf(\"%c \\n\",ch);\n            ch=' ';\n        }\n    }\n    return 0;\n}\n</code></pre>\n\n<p>And here's the error message:</p>\n\n<pre><code> error: assignment to expression with array type\n             ch= ch+(s[i]);\n               ^\nSolution.c:27:15: error: assignment to expression with array type\n             ch=' ';\n</code></pre>\n"}, {"tags": ["c", "console-application"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 4, "creation_date": 1568806924, "post_id": 57991943, "comment_id": 102390884, "body": "<code>first_name</code> and <code>last_name</code> are <i>single characters</i>. They can&#39;t hold null-terminated byte strings. It seems you could need to take a step back with your book or tutorial."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 1, "creation_date": 1568806947, "post_id": 57991943, "comment_id": 102390901, "body": "<code>%s</code> is for a string. You pass asingle character. A single character is not a string. A string has a zero characte as terminator."}, {"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1568807359, "post_id": 57991943, "comment_id": 102391108, "body": "The free Visual Studio edition is good for debugging and imo generally a pleasant IDE if you are on Windows. Maybe somebody recommend IDEs for Linux and Mac?"}, {"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1568807515, "post_id": 57991943, "comment_id": 102391189, "body": "Got a point from me for reading and considering compiler warnings. That&#39;s more than even many experienced programmers can bring themselves to do."}, {"owner": {"reputation": 113, "user_id": 12027316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85abbd3db509c8d04a89f4f21d4bc5c0?s=128&d=identicon&r=PG&f=1", "display_name": "user12027316", "link": "https://stackoverflow.com/users/12027316/user12027316"}, "edited": false, "score": 0, "creation_date": 1568810674, "post_id": 57991943, "comment_id": 102392961, "body": "Thank you, everyone. I&#39;m coming from Java so this is super unfamiliar in some respects. I appreciate the help and did solve the problem with the suggestions plus my resources. (Normally it takes me hours or days but this was instant.)"}], "answers": [{"comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1568807155, "post_id": 57992020, "comment_id": 102391002, "body": "That&#39;s not enough, unless the OP makes them point somewhere valid (which you don&#39;t describe how to do). Considering the confusion of the OP this might even be pretty bad advice."}, {"owner": {"reputation": 113, "user_id": 12027316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85abbd3db509c8d04a89f4f21d4bc5c0?s=128&d=identicon&r=PG&f=1", "display_name": "user12027316", "link": "https://stackoverflow.com/users/12027316/user12027316"}, "edited": false, "score": 1, "creation_date": 1568809367, "post_id": 57992020, "comment_id": 102392213, "body": "This was enough, plus my resources, to solve the problem. Thank you for taking the time. This was literally my first program and I&#39;m just beginning to understand malloc, which is hard. Much appreciation."}], "tags": [], "owner": {"reputation": 592, "user_id": 6022626, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-TE4SgJMzh3g/AAAAAAAAAAI/AAAAAAAAAE4/BpGV2AGlUG0/photo.jpg?sz=128", "display_name": "Suraj", "link": "https://stackoverflow.com/users/6022626/suraj"}, "is_accepted": true, "score": 2, "last_activity_date": 1568807405, "last_edit_date": 1568807405, "creation_date": 1568807074, "answer_id": 57992020, "question_id": 57991943, "link": "https://stackoverflow.com/questions/57991943/c-program-errors-on-print/57992020#57992020", "title": "C program errors on print", "body": "<p>You've declared your <code>first_name</code> and <code>last_name</code> variables as <code>char</code> datatype. They should be declared as <code>char*</code> and allocate memory or declare it as <code>char[]</code> of required size.</p>\n\n<p>Also change your scanf statements to remove the <code>&amp;</code> while capturing the user input to variable as these variables already hold the address.</p>\n"}, {"tags": [], "owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1568809455, "creation_date": 1568809455, "answer_id": 57992762, "question_id": 57991943, "link": "https://stackoverflow.com/questions/57991943/c-program-errors-on-print/57992762#57992762", "title": "C program errors on print", "body": "<p>The problem starts already at <code>scanf</code>.</p>\n\n<p>With a <code>%s</code> conversion it will read a \"word\" from the input; more exactly, it will read characters until it hits a whitespace (which is put back into the input). These characters are copied to the memory starting at the location which you provided; at the end, <code>scanf</code> will add a null character in order to terminate the C string it created. </p>\n\n<p>In your case, you provided a location which holds only a single character. <code>scanf</code> does not know that and will continue to write into the memory beyond that single character, overwriting other data and infrastructure information of your program, with disastrous effects.</p>\n\n<p>As others have said, you must provide more space in memory for the names. Typically one would declare character arrays, like <code>char first_name[200];</code>, here containing space for 200 characters.<sup>1</sup></p>\n\n<p>Technically, <code>first_name[200]</code> declares an array, not a character pointer; but in all common uses the language adjusts it to a pointer containing the address of the first character in the array, which is exactly what <code>scanf</code>(and <code>printf</code>) expect. And both of them expect that the address points to an array which has enough space (in case of <code>scanf</code>) respectively contains a null-terminated sequence of characters (in the case of <code>printf</code>).</p>\n\n<p><hr>\n<sub><sup>1 </sup>One should make sure not to read longer input (and make <code>scanf</code> overwrite unrelated memory again)  by using a field length for the conversion. In our case <code>scanf(\"%199s\", first_name);</code> would indicate that we read a maximum of 199 characters from the input, leaving the last byte in the array for the terminating zero character which <code>scanf</code> will silently add.</sub></p>\n\n<p><sub>The rest of a very long name would stay in the input queue and be read as the next string, leading to an error, but handling input errors in a fool-proof manner is non-trivial. Which is sad because beginner programs often are centered around human input. \"Normal\" programs, by contrast, prompt for user input very rarely &mdash; with the notable exceptions of your shell and your editor.</sub></p>\n"}], "owner": {"reputation": 113, "user_id": 12027316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85abbd3db509c8d04a89f4f21d4bc5c0?s=128&d=identicon&r=PG&f=1", "display_name": "user12027316", "link": "https://stackoverflow.com/users/12027316/user12027316"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 57992020, "answer_count": 2, "score": 0, "last_activity_date": 1568810534, "creation_date": 1568806839, "last_edit_date": 1568810534, "question_id": 57991943, "link": "https://stackoverflow.com/questions/57991943/c-program-errors-on-print", "title": "C program errors on print", "body": "<p>I'm extremely new to C programming and I'm writing a basic code that collects first and last name, hours worked, hourly wage, and then returns the last name, first name, and the hours * wage:</p>\n\n<pre><code>    char first_name;\n    char last_name;\n\n    printf(\"\\n%s, %s: %.2lf\\n\", last_name, first_name, total_payment);\n</code></pre>\n\n<p>The error I receive while compiling is:</p>\n\n<pre><code>payroll.c:22:13: warning: format '%s' expects argument of type char *' but argument 2 has type 'int' [-Wformat=]\nprintf(\"\\n%s, %s: %.2lf\\n\", last_name, first_name, total_payment);\n          ^\n\npayroll.c:22:13: warning: format '%s' expects argument of type char *' but argument 3 has type 'int' [-Wformat=]\nprintf(\"\\n%s, %s: %.2lf\\n\", last_name, first_name, total_payment);\n              ^\n</code></pre>\n\n<p>I don't understand the error. Is <code>char *</code> a pointer? Why doesn't it return the first char variable listed, then the second, before a .2 floating point int? I'm also using nano so it's impossible to debug as I normally would. (A recommended IDE would also be extremely helpful.)</p>\n"}, {"tags": ["c", "equality"], "comments": [{"owner": {"reputation": 17331, "user_id": 8950365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c6ba3b19f86f1bea8cf76e691db4349?s=128&d=identicon&r=PG&f=1", "display_name": "rafix07", "link": "https://stackoverflow.com/users/8950365/rafix07"}, "edited": false, "score": 6, "creation_date": 1568806741, "post_id": 57991892, "comment_id": 102390784, "body": "See operator precedence. It is <code>(b+c) == a</code>."}, {"owner": {"reputation": 25331, "user_id": 1810, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a9076817fc6106b7d6b433b9f45bc306?s=128&d=identicon&r=PG", "display_name": "Timbo", "link": "https://stackoverflow.com/users/1810/timbo"}, "edited": false, "score": 5, "creation_date": 1568806858, "post_id": 57991892, "comment_id": 102390841, "body": "And then, c isn&#39;t even equal to a!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9121250"}, "edited": false, "score": 0, "creation_date": 1568806926, "post_id": 57991892, "comment_id": 102390885, "body": "@ rafix07 ,yes got it.thanks"}], "answers": [{"tags": [], "owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "is_accepted": false, "score": 5, "last_activity_date": 1568806800, "creation_date": 1568806800, "answer_id": 57991926, "question_id": 57991892, "link": "https://stackoverflow.com/questions/57991892/why-is-the-value-of-d-1-and-not-6/57991926#57991926", "title": "Why is the value of d 1 and not 6?", "body": "<p>This is a case of <a href=\"https://en.cppreference.com/w/c/language/operator_precedence\" rel=\"noreferrer\">operator precedence</a>. <code>+</code> has higher precedence than <code>==</code>, so this</p>\n\n<pre><code>b + c==a;\n</code></pre>\n\n<p>is the same as </p>\n\n<pre><code>(b + c) == a;\n</code></pre>\n\n<p>So it turns into</p>\n\n<pre><code>10 == 10;\n</code></pre>\n\n<p>Which is <code>1</code>.</p>\n\n<hr>\n\n<blockquote>\n  <p>if I change + to * then output is 0</p>\n</blockquote>\n\n<p>Then we have <code>(5 * 5) == 10</code> which is <code>25 == 10</code> which is <code>0</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 9, "user_id": 10695402, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-RgDPht8i1kQ/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-gdQoX_DXc65zs9u5cYugRzvzNpEw/mo/photo.jpg?sz=128", "display_name": "Berat", "link": "https://stackoverflow.com/users/10695402/berat"}, "is_accepted": false, "score": -1, "last_activity_date": 1568806909, "creation_date": 1568806909, "answer_id": 57991959, "question_id": 57991892, "link": "https://stackoverflow.com/questions/57991892/why-is-the-value-of-d-1-and-not-6/57991959#57991959", "title": "Why is the value of d 1 and not 6?", "body": "<p>Just put the statement c==a in paranthases</p>\n\n<p>d = b + (c==a);</p>\n"}, {"tags": [], "owner": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "is_accepted": false, "score": 2, "last_activity_date": 1568806998, "creation_date": 1568806998, "answer_id": 57991993, "question_id": 57991892, "link": "https://stackoverflow.com/questions/57991892/why-is-the-value-of-d-1-and-not-6/57991993#57991993", "title": "Why is the value of d 1 and not 6?", "body": "<p>See the <a href=\"https://en.cppreference.com/w/c/language/operator_precedence\" rel=\"nofollow noreferrer\">operator precedence table</a></p>\n\n<p><code>+</code> has a higher precedence than <code>==</code> and <code>==</code> has higher precedence than <code>=</code></p>\n\n<p>So the equation becomes </p>\n\n<pre><code>d = ((b + c)==a)\nd = ((5 + 5)==10);\nd = (10==10)\nd = 1;\n</code></pre>\n\n<p>If you have </p>\n\n<pre><code>d = b * c==a;\nd = ((b*c)==a);\nd = ((5*5)==10);\nd = (25==10);\nd = 0;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "is_accepted": false, "score": 2, "last_activity_date": 1568807200, "creation_date": 1568807200, "answer_id": 57992047, "question_id": 57991892, "link": "https://stackoverflow.com/questions/57991892/why-is-the-value-of-d-1-and-not-6/57992047#57992047", "title": "Why is the value of d 1 and not 6?", "body": "<p>You must attend to operator precedence whenever you use more than one operator in a statement. The precedence of '+' is higher than '==', thus</p>\n\n<pre><code>b + c==a;\n</code></pre>\n\n<p>is interpreted as:</p>\n\n<pre><code>(b + c) == a;\n</code></pre>\n\n<p>If this isn't what you want, then you should enclose 'c==a' with parentheses:</p>\n\n<pre><code>b + (c == a) ;\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9121250"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1568882599, "creation_date": 1568806671, "last_edit_date": 1568882599, "question_id": 57991892, "link": "https://stackoverflow.com/questions/57991892/why-is-the-value-of-d-1-and-not-6", "title": "Why is the value of d 1 and not 6?", "body": "<pre><code>#include &lt;stdio.h&gt;\n    int main()\n    {\n        int a = 10, b = 5, c = 5;\n        int d;\n        d = b + c==a;\n        printf(\"%d\", d);\n    }\n</code></pre>\n\n<p>I thought <code>c==a</code> will evaluate to <code>1</code> and <code>b+1</code> i.e <code>5+1=6</code> will be the output but it is <code>1</code>, if I change <code>+</code> to <code>*</code> then output is <code>0</code>. Why?</p>\n"}, {"tags": ["c", "tizen", "tizen-wearable-sdk", "tizen-native-app"], "answers": [{"tags": [], "owner": {"reputation": 339, "user_id": 739986, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/PWntp.jpg?s=128&g=1", "display_name": "Bas Goossen", "link": "https://stackoverflow.com/users/739986/bas-goossen"}, "is_accepted": false, "score": 0, "last_activity_date": 1614888820, "creation_date": 1614888820, "answer_id": 66482364, "question_id": 57991551, "link": "https://stackoverflow.com/questions/57991551/how-to-request-privacy-privileges-for-tizen-native-service-application/66482364#66482364", "title": "How to Request Privacy Privileges for Tizen Native Service Application", "body": "<p>For as dar as i am aware, the multi permission call is only available in Tizen 5+, so you need to ask each permission individually if you're using Tizen 4.0 API.</p>\n"}], "owner": {"reputation": 1604, "user_id": 4291909, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/56IWS.jpg?s=128&g=1", "display_name": "Itban Saeed", "link": "https://stackoverflow.com/users/4291909/itban-saeed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 247, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1614888820, "creation_date": 1568805495, "last_edit_date": 1569243189, "question_id": 57991551, "link": "https://stackoverflow.com/questions/57991551/how-to-request-privacy-privileges-for-tizen-native-service-application", "title": "How to Request Privacy Privileges for Tizen Native Service Application", "body": "<p>I am working on a <a href=\"https://developer.tizen.org/ko/community/tip-tech/packaging-hybrid-application?langredirect=1\" rel=\"nofollow noreferrer\">Hybrid App</a> (Web UI with Native Service) of API version 4.0 for my Gear S3 Frontier.</p>\n\n<ul>\n<li>The Web UI launches the Service.</li>\n<li>Native Service uses the Sensor and Location data</li>\n</ul>\n\n<p>My Service App has the privilege of Sensor and Location in the manifest file. When I check the privileges in code, the results show that I need to get privilege from user, which is fine.</p>\n\n<p>I've implemented it using the <a href=\"https://developer.tizen.org/forums/native-application-development/how-request-privacy-privileges\" rel=\"nofollow noreferrer\">Privacy Privilege Manager</a> but <strong>when I request for privilege using the <a href=\"https://developer.tizen.org/development/api-references/native-application?redirect=/dev-guide/5.0.0/org.tizen.native.wearable.apireference/group__CAPI__PRIVACY__PRIVILEGE__MANAGER__MODULE.html#ga3c2f09747f4db04d81b681c10935ee5f\" rel=\"nofollow noreferrer\">ppm_request_permission</a> method, it doesn't show any message asking for the permission, and so it doesn't go the <a href=\"https://developer.tizen.org/development/api-references/native-application?redirect=/dev-guide/5.0.0/org.tizen.native.wearable.apireference/group__CAPI__PRIVACY__PRIVILEGE__MANAGER__MODULE.html#gabf8a6f0f854601e02403191e9feaf9ad\" rel=\"nofollow noreferrer\">ppm_request_response_cb</a> method.</strong> </p>\n\n<p>Here's the relevant code:</p>\n\n<p><strong>Response Handler Implementation:</strong></p>\n\n<pre><code>void ppm_request_response_handler(ppm_call_cause_e cause, ppm_request_result_e result, const char *privilege, void *user_data)\n{\n\n    dlog_print(DLOG_DEBUG, TAG, \"In the ppm_request_response_handler.\");\n\n    /*\n     * The result of a response triggered by calling ppm_request_permission() is a valid value only if\n     * the cause parameter is equal to PRIVACY_PRIVILEGE_MANAGER_CALL_CAUSE_ANSWER.\n     */\n    if(cause == PRIVACY_PRIVILEGE_MANAGER_CALL_CAUSE_ANSWER)\n    {\n        if(result == PRIVACY_PRIVILEGE_MANAGER_REQUEST_RESULT_ALLOW_FOREVER)\n        {\n            if(!strcmp(privilege, \"http://tizen.org/privilege/location\"))\n            {\n                bIsLocationPrivilegeGranted = true;\n                dlog_print(DLOG_DEBUG, TAG, \"Service Application has been granted the Location privilege.\");\n            }\n\n            if(!strcmp(privilege, \"http://tizen.org/privilege/healthinfo\"))\n            {\n                bIsHealthInfoPrivilegeGranted = true;\n                dlog_print(DLOG_DEBUG, TAG, \"Service Application has been granted the Health Info privilege.\");\n            }\n        }\n        else\n        {\n            if(!strcmp(privilege, \"http://tizen.org/privilege/location\"))\n            {\n                dlog_print(DLOG_DEBUG, TAG, \"Service Application is denied to access the Location.\");\n            }\n\n            if(!strcmp(privilege, \"http://tizen.org/privilege/healthinfo\"))\n            {\n                dlog_print(DLOG_DEBUG, TAG, \"Service Application is denied to access the Health Information.\");\n            }\n        }\n    }\n    else\n    {\n        if(!strcmp(privilege, \"http://tizen.org/privilege/location\"))\n        {\n            dlog_print(DLOG_DEBUG, TAG, \"Service Application did not get any response to access the Location.\");\n        }\n\n        if(!strcmp(privilege, \"http://tizen.org/privilege/healthinfo\"))\n        {\n            dlog_print(DLOG_DEBUG, TAG, \"Service Application did not get any response to access the Health Information.\");\n        }\n    }\n}\n\ntypedef void(* ppm_request_response)(ppm_call_cause_e cause, ppm_request_result_e result, const char *privilege, void *user_data);\n</code></pre>\n\n<p><strong>Method Call to Request for Permission:</strong></p>\n\n<pre><code>//Set the function pointer value\nppm_request_response ppm_request_response_cb = ppm_request_response_handler;\n\n//Request the user for the permission\nppm_request_permission(requiredPrivileges[i], ppm_request_response_cb, NULL);\n</code></pre>\n\n<p><strong>Expected Behavior:</strong></p>\n\n<p>Service App should show any message asking the user about the permission, the <code>ppm_request_response_handler</code> method should be invoked then to handle the response of the user.</p>\n"}, {"tags": ["c", "printf", "d", "placeholder", "digits"], "comments": [{"owner": {"reputation": 41, "user_id": 11864063, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iCR6V.png?s=128&g=1", "display_name": "Pingu", "link": "https://stackoverflow.com/users/11864063/pingu"}, "reply_to_user": {"reputation": 6975, "user_id": 3121023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f52448806175b9aa66c86d40cf0829f1?s=128&d=identicon&r=PG&f=1", "display_name": "user3121023", "link": "https://stackoverflow.com/users/3121023/user3121023"}, "edited": false, "score": 0, "creation_date": 1568802807, "post_id": 57990496, "comment_id": 102388588, "body": "what if i have multiple of these next to each other ? does it matter what that the &quot;width&quot; variable is named? or does the compiler just assume the variable in front of &quot;value&quot; is the the &quot;width&quot; variable ?"}, {"owner": {"reputation": 2149, "user_id": 2096401, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uVjii.jpg?s=128&g=1", "display_name": "TripeHound", "link": "https://stackoverflow.com/users/2096401/tripehound"}, "edited": false, "score": 1, "creation_date": 1568804349, "post_id": 57990496, "comment_id": 102389415, "body": "@Pingu The <i>run-time</i> (not the compiler) just takes &quot;the next thing&quot; from the parameter list when it finds <code>%*</code> and uses it as the width. So <code>printf( &quot;%d %d&quot;, a, b )</code> will print two numbers using the default width, <code>printf( &quot;%d %*d&quot;, a, widthB, b )</code> will print <code>a</code> normally, then use <code>widthB</code> (the next parameter) as the width for printing <code>b</code>. <code>printf( &quot;%*d %*d&quot;, widthA, a, widthB, b )</code> will use a (separate) width for both <code>a</code> and <code>b</code>."}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 11864063, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iCR6V.png?s=128&g=1", "display_name": "Pingu", "link": "https://stackoverflow.com/users/11864063/pingu"}, "edited": false, "score": 0, "creation_date": 1568804352, "post_id": 57990697, "comment_id": 102389418, "body": "What i am looking for is a some kind of width value that simply makes the value &quot;invisible&quot; i was hoping that width = 0 would print &quot;nothing&quot; &lt;  &gt;"}, {"owner": {"reputation": 2149, "user_id": 2096401, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uVjii.jpg?s=128&g=1", "display_name": "TripeHound", "link": "https://stackoverflow.com/users/2096401/tripehound"}, "reply_to_user": {"reputation": 41, "user_id": 11864063, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iCR6V.png?s=128&g=1", "display_name": "Pingu", "link": "https://stackoverflow.com/users/11864063/pingu"}, "edited": false, "score": 1, "creation_date": 1568804664, "post_id": 57990697, "comment_id": 102389594, "body": "@Pingu So you want to <i>conditionally</i> print values, not specifically control the width (which is what &quot;<i>amount of digits</i>&quot; make it sound like you were asking)? Off the top of my head, I don&#39;t remember there being a &quot;conditional print&quot; option (at least in the standard version of <code>printf</code> ... it <i>possible</i> someone may have written a non-standard extension)."}, {"owner": {"reputation": 41, "user_id": 11864063, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iCR6V.png?s=128&g=1", "display_name": "Pingu", "link": "https://stackoverflow.com/users/11864063/pingu"}, "edited": false, "score": 0, "creation_date": 1568805734, "post_id": 57990697, "comment_id": 102390204, "body": "yeah, specifically i want to avoid printing the placeholder if the value = 0, but i still need the placeholder inside the printf() in case the value != 0"}, {"owner": {"reputation": 755, "user_id": 11699772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd368b24a3051afd4ebf0196148b6e11?s=128&d=identicon&r=PG&f=1", "display_name": "XBlueCode", "link": "https://stackoverflow.com/users/11699772/xbluecode"}, "reply_to_user": {"reputation": 41, "user_id": 11864063, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iCR6V.png?s=128&g=1", "display_name": "Pingu", "link": "https://stackoverflow.com/users/11864063/pingu"}, "edited": false, "score": 0, "creation_date": 1568807555, "post_id": 57990697, "comment_id": 102391208, "body": "@Pingu, If this is the case then you need to put <code>precision = 0</code>, Please check the updated answer"}], "tags": [], "owner": {"reputation": 755, "user_id": 11699772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd368b24a3051afd4ebf0196148b6e11?s=128&d=identicon&r=PG&f=1", "display_name": "XBlueCode", "link": "https://stackoverflow.com/users/11699772/xbluecode"}, "is_accepted": false, "score": 4, "last_activity_date": 1568807571, "last_edit_date": 1568807571, "creation_date": 1568802673, "answer_id": 57990697, "question_id": 57990496, "link": "https://stackoverflow.com/questions/57990496/how-to-printf-a-dynamic-amount-of-placeholders-in-c/57990697#57990697", "title": "how to printf a dynamic amount of placeholders in c?", "body": "<pre><code>printf(\"%*.*d\", width, precision, value);\n</code></pre>\n\n<p>Using this format you can keep the width and precision flexible and feed them to the <code>printf</code>.</p>\n\n<p>Consider the following example:</p>\n\n<pre><code>printf(\"&lt;%*.*d&gt;\\n\", 4, 1, 12);\nprintf(\"&lt;%-*.*d&gt;\\n\", 4, 3, 12);\nprintf(\"&lt;%*.*d&gt;\\n\", 0, 0, 0);\nprintf(\"&lt;%*.*d&gt;\\n\", 2, 0, 0);\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>&lt;  12&gt;                                                                                                                                                                   \n&lt;012 &gt;                                                                                                                                                                   \n&lt;&gt;\n&lt;  &gt;\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 11864063, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iCR6V.png?s=128&g=1", "display_name": "Pingu", "link": "https://stackoverflow.com/users/11864063/pingu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 570, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1615587575, "creation_date": 1568802058, "last_edit_date": 1615587575, "question_id": 57990496, "link": "https://stackoverflow.com/questions/57990496/how-to-printf-a-dynamic-amount-of-placeholders-in-c", "title": "how to printf a dynamic amount of placeholders in c?", "body": "<p>Normally you have a set amount of placeholders in your printf(), which means I'd have to decide on a set amount of digit and string placeholders in advance.</p>\n<p>Is it possible to make the amount of placeholders in your printf() dynamic or make specifically %d placeholders print an &quot;empty&quot; char</p>\n"}, {"tags": ["c", "algorithm", "array-algorithms"], "answers": [{"comments": [{"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1568916967, "post_id": 57991894, "comment_id": 102437297, "body": "This answer will insert a space into the destination, While the OPs question was: how to condense multiple spaces into a single space"}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1568917907, "post_id": 57991894, "comment_id": 102437758, "body": "It will replace multiple whitespace by a single space, and leave all other characters unchanged."}], "tags": [], "owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "is_accepted": false, "score": 1, "last_activity_date": 1568917964, "last_edit_date": 1568917964, "creation_date": 1568806672, "answer_id": 57991894, "question_id": 57990416, "link": "https://stackoverflow.com/questions/57990416/how-to-replace-all-instances-of-multiple-whitespace-characters-blanks-tabs/57991894#57991894", "title": "How to replace all instances of (multiple) whitespace characters (blanks, tabs, newlines) by single blanks in C using array?", "body": "<ul>\n<li>dont repeat yourself: you need only one getc() and one putc()</li>\n<li>while in the loop, you only need to remember whether the previous outputted character was a blank.</li>\n<li><code>break</code> and <code>continue</code> exist for a reason.</li>\n</ul>\n\n<hr>\n\n<pre><code>int count;\n\nfor(count=0; ; ) {\n    int ch; \n    ch = getc(stdin);\n    if( ch == EOF) break;\n    switch(ch) {\n    case ' ':\n    case '\\t':\n    case '\\n':\n    case '\\r':\n            if(count++) continue;\n            ch = ' ';\n            break;\n    default:\n            count=0;\n            break;\n            }\n    putc(ch, stdout);\n    }\n</code></pre>\n\n<hr>\n\n<p>Similar logic for rewriting a character buffer:</p>\n\n<hr>\n\n<pre><code>char line[100];\nwhile ( fgets(line,sizeof line, stdin) ) {\n    unsigned dst,src,count;  \n    for (count=dst=src=0; line[dst]=line[src++];){\n        switch(line[dst]) {\n        case ' ':\n        case '\\t':\n        case '\\n':\n        case '\\r':\n            if(count++) continue;\n            line[dst++] = ' ';\n            break;\n        default:\n            dst++;\n            count=0;\n            break;\n            }\n        }\n    fputs(line,stdout);\n    }\n</code></pre>\n\n<hr>\n\n<p>As you can see, you don't need the buffer, it will only complicate things.</p>\n"}], "owner": {"reputation": 9, "user_id": 12076789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cafa602590926654dae9a2e1886ff434?s=128&d=identicon&r=PG&f=1", "display_name": "jkwilliams", "link": "https://stackoverflow.com/users/12076789/jkwilliams"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1568917964, "creation_date": 1568801821, "question_id": 57990416, "link": "https://stackoverflow.com/questions/57990416/how-to-replace-all-instances-of-multiple-whitespace-characters-blanks-tabs", "title": "How to replace all instances of (multiple) whitespace characters (blanks, tabs, newlines) by single blanks in C using array?", "body": "<p>I tried using getchar() to solve the problem and it works, but now I am using fgets() to get the text line by line and the whole text is stored in an array. I want to replace all instances of multiple whitespace characters including blanks, tabs, and newline by a single blank. \nThis is what I did using getchar():</p>\n\n<pre><code> int c;\n\nwhile ((c = getchar ()) != EOF\n{\n    if (c == '\\r') continue;\n    if (c == '\\n') {       \n        putchar (c);\n        while ((c = getchar ()) == '\\n' || c == '\\r') {}\n        if (c != EOF) ungetc (c, stdin); else break;\n        continue;\n    }\n    if (c == ' ' || c == '\\t') {  \n        putchar (' ');\n        while ((c = getchar ()) == ' ' || c == '\\t') {}\n        if (c != EOF) ungetc(c, stdin); else break;\n        continue;\n    }\n    putchar (c);\n}\nreturn 0;\n</code></pre>\n\n<p>}</p>\n\n<p>Now, I am trying to do this:</p>\n\n<pre><code>while (1) {\n    if (fgets(line,max_len, stdin) == NULL) break;\n    for (int i=0;i&lt;strlen(line);i++){\n        text[n++]=line[i];\n    }\n}\n</code></pre>\n\n<p>Where each the text is stored in an array from where I want to filter it. </p>\n"}, {"tags": ["c", "linux", "sockets", "networking", "wireshark"], "comments": [{"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 3, "creation_date": 1568800494, "post_id": 57989726, "comment_id": 102387283, "body": "Easy - do not use Linux or Windows or any other general-purpose OS.  You need a fast microcontroller/DSP, dedicated driver code.  Read the hardware manuals and data sheets, then design your software driver appropriately."}, {"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "edited": false, "score": 0, "creation_date": 1568803726, "post_id": 57989726, "comment_id": 102389088, "body": "Note that loop <code>while (no_of_packets-- &gt; 1)</code> executes <code>no_of_packets - 1</code> times."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 2, "creation_date": 1568804334, "post_id": 57989726, "comment_id": 102389407, "body": "<code>sprintf(buf, format , buf);</code>  &lt;&lt;-- it is not allowed to write to the buffer you are reading from."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 1, "creation_date": 1568805739, "post_id": 57989726, "comment_id": 102390207, "body": "<code>if (len = recv(s, buf, sizeof(buf), 0)){</code> &lt;&lt;-- recv() can return <code>-1</code> , too."}], "answers": [{"comments": [{"owner": {"reputation": 64, "user_id": 6019228, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/knY2c.png?s=128&g=1", "display_name": "anuraag tummanapally", "link": "https://stackoverflow.com/users/6019228/anuraag-tummanapally"}, "edited": false, "score": 0, "creation_date": 1568806428, "post_id": 57991115, "comment_id": 102390630, "body": "Thanks for the answer. I will take a look at the documents and see"}], "tags": [], "owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "is_accepted": false, "score": 3, "last_activity_date": 1568805958, "last_edit_date": 1568805958, "creation_date": 1568804110, "answer_id": 57991115, "question_id": 57989726, "link": "https://stackoverflow.com/questions/57989726/socket-programming-in-c-udp-send-taking-6-260-micro-sec-how-to-make-it-fas/57991115#57991115", "title": "Socket Programming in C: UDP send() taking 6 - 260 micro sec, how to make it faster", "body": "<p>On Linux, you can probably do that with a kernel bypass network stack, such as <a href=\"https://www.ntop.org/products/packet-capture/pf_ring/pf_ring-zc-zero-copy/\" rel=\"nofollow noreferrer\">PF_RING ZC (Zero Copy)</a>, and FIFO real-time threads that run on isolated cores that:</p>\n\n<ol>\n<li>Fill a packet to send in the network card buffer.</li>\n<li>Busy-wait till the next time point.</li>\n<li>Emit the prepared packet into the wire.</li>\n<li>Go to 1.</li>\n</ol>\n\n<p>You may also find <a href=\"https://www.cl.cam.ac.uk/research/srg/netos/projects/pcie-bench/neugebauer2018understanding.pdf\" rel=\"nofollow noreferrer\">Understanding PCIe performance for end host networking</a> white-paper useful.</p>\n"}], "owner": {"reputation": 64, "user_id": 6019228, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/knY2c.png?s=128&g=1", "display_name": "anuraag tummanapally", "link": "https://stackoverflow.com/users/6019228/anuraag-tummanapally"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 2, "answer_count": 1, "score": 3, "last_activity_date": 1568805958, "creation_date": 1568799717, "question_id": 57989726, "link": "https://stackoverflow.com/questions/57989726/socket-programming-in-c-udp-send-taking-6-260-micro-sec-how-to-make-it-fas", "title": "Socket Programming in C: UDP send() taking 6 - 260 micro sec, how to make it faster", "body": "<p>Using <code>SOCK_DGRAM</code> for <code>UDP</code> sockets</p>\n\n<p>All packets are <code>22 bytes</code> in length (ie <code>64 including headers</code>)</p>\n\n<p><strong>client.c</strong></p>\n\n<pre><code>...\n    no_of_packets--;\n    sprintf(buf, \"#:!0 rem\");\n    sprintf(buf, format , buf);\n    sprintf(buf_aux, \"#: 0 rem\");\n    sprintf(buf_aux, format , buf_aux);\n    buf[MAX_LINE-1] = '\\0';\n    buf_aux[MAX_LINE-1] = '\\0';\n    len = strlen(buf) + 1;\n    send(s, buf, len, 0);\n    while (no_of_packets-- &gt; 1) {\n        nanosleep(&amp;T, NULL);\n        send(s, buf, len, 0);\n    }\n    send(s, buf_aux, len, 0);\n</code></pre>\n\n<p><strong>server.c</strong></p>\n\n<pre><code>...\nwhile(1) {\n        if (len = recv(s, buf, sizeof(buf), 0)){\n            // do nothing\n        }\n}\n\n</code></pre>\n\n<p>When I open <code>Wireshark</code> to see avg delay between the packets which are sent,</p>\n\n<p>I can see the following:</p>\n\n<ul>\n<li><p><em>MIN</em> delay:  0.000 006 795 sec => <em>6 micro sec</em></p></li>\n<li><p><em>MAX</em> delay:  0.000 260 952 sec => <em>260 micro sec</em></p></li>\n<li><p>But I want to send packets every <em>512 nano sec</em> (ie., 0.512 micro sec). </p></li>\n</ul>\n\n<blockquote>\n  <p><strong>How</strong> can I achieve this speed?</p>\n</blockquote>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "edited": false, "score": 7, "creation_date": 1568798688, "post_id": 57989342, "comment_id": 102386231, "body": "<code>id</code> is a variable and the type of <code>id</code> is the unnamed union. If you want to give the union a name, put it between the <code>union</code> and the <code>{</code>."}, {"owner": {"reputation": 55059, "user_id": 212858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166c87b6f3fc2e6746da96b60fefb46?s=128&d=identicon&r=PG", "display_name": "Useless", "link": "https://stackoverflow.com/users/212858/useless"}, "edited": false, "score": 3, "creation_date": 1568798709, "post_id": 57989342, "comment_id": 102386241, "body": "But <code>id</code> <i>is</i> the name of the variable. The union <i>type</i> doesn&#39;t have a name."}, {"owner": {"reputation": 21, "user_id": 9578955, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd69675a7e823839a3000dc2dd831703?s=128&d=identicon&r=PG&f=1", "display_name": "Hackerman_Z3r0", "link": "https://stackoverflow.com/users/9578955/hackerman-z3r0"}, "edited": false, "score": 0, "creation_date": 1568798921, "post_id": 57989342, "comment_id": 102386388, "body": "I did not know that,Thank You"}, {"owner": {"reputation": 1127, "user_id": 11993121, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d6d838d88ef60caa2eefd94e172026c?s=128&d=identicon&r=PG&f=1", "display_name": "nielsen", "link": "https://stackoverflow.com/users/11993121/nielsen"}, "edited": false, "score": 0, "creation_date": 1568805753, "post_id": 57989342, "comment_id": 102390223, "body": "Sometimes it helps to remember that the notation for declaring a <code>union</code> is the same as for declaring a <code>struct</code> (and a <code>class</code> if we include <code>C++</code>)."}], "answers": [{"comments": [{"owner": {"reputation": 1127, "user_id": 11993121, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d6d838d88ef60caa2eefd94e172026c?s=128&d=identicon&r=PG&f=1", "display_name": "nielsen", "link": "https://stackoverflow.com/users/11993121/nielsen"}, "edited": false, "score": 0, "creation_date": 1568806225, "post_id": 57989477, "comment_id": 102390497, "body": "This is of course absolutely correct. It could be noted (because it may lead to confusion similar to the OP) that a <code>union</code> type may also be named via a <code>typedef</code> as in <code>typedef union { ... } &lt;TypeName&gt;;</code>."}], "tags": [], "owner": {"reputation": 55059, "user_id": 212858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166c87b6f3fc2e6746da96b60fefb46?s=128&d=identicon&r=PG", "display_name": "Useless", "link": "https://stackoverflow.com/users/212858/useless"}, "is_accepted": false, "score": 4, "last_activity_date": 1568798961, "creation_date": 1568798961, "answer_id": 57989477, "question_id": 57989342, "link": "https://stackoverflow.com/questions/57989342/accessing-union-members-with-the-union-name-without-any-variables/57989477#57989477", "title": "Accessing union members with the union name without any variables", "body": "<p>The <a href=\"https://en.cppreference.com/w/c/language/union\" rel=\"nofollow noreferrer\">union type declaration</a> is</p>\n\n<p><code>union</code> <em><code>OptionalUnionTypeName</code></em> <code>{</code> <code>...</code> <code>}</code></p>\n\n<p>but your full statement is a variable definition of the form</p>\n\n<p><code>type</code> <code>id</code> <code>;</code></p>\n\n<p>(where type is the anonymous union type just declared, since you omitted the name).</p>\n\n<p>So <code>id</code> is a variable of (anonymous) union type.</p>\n"}], "owner": {"reputation": 21, "user_id": 9578955, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd69675a7e823839a3000dc2dd831703?s=128&d=identicon&r=PG&f=1", "display_name": "Hackerman_Z3r0", "link": "https://stackoverflow.com/users/9578955/hackerman-z3r0"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1568798961, "creation_date": 1568798543, "last_edit_date": 1568798776, "question_id": 57989342, "link": "https://stackoverflow.com/questions/57989342/accessing-union-members-with-the-union-name-without-any-variables", "title": "Accessing union members with the union name without any variables", "body": "<pre><code>#include &lt;string.h&gt;\n#include &lt;stdio.h&gt;\n\nint main(){\n\n    union {\n    int id_num;\n    char VIN[20]; \n  } id;\n\n    id.id_num = 20;\n    printf(\"%d\",id.id_num);\n    }\n</code></pre>\n\n<p>why is the above code working when the id union's id_num member is being accessed with the union's name (id.) and not a declared id union  variable?\nI'm very confused</p>\n"}, {"tags": ["c", "gcc", "demangler"], "comments": [{"owner": {"reputation": 62488, "user_id": 45249, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/81039d357ce18bee9dd8fac6c1c56290?s=128&d=identicon&r=PG", "display_name": "mouviciel", "link": "https://stackoverflow.com/users/45249/mouviciel"}, "edited": false, "score": 1, "creation_date": 1568798718, "post_id": 57989227, "comment_id": 102386249, "body": "What is the purpose of a demangle feature in C?"}, {"owner": {"reputation": 1170, "user_id": 2682012, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ii27c.jpg?s=128&g=1", "display_name": "ericcurtin", "link": "https://stackoverflow.com/users/2682012/ericcurtin"}, "reply_to_user": {"reputation": 62488, "user_id": 45249, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/81039d357ce18bee9dd8fac6c1c56290?s=128&d=identicon&r=PG", "display_name": "mouviciel", "link": "https://stackoverflow.com/users/45249/mouviciel"}, "edited": false, "score": 0, "creation_date": 1568798871, "post_id": 57989227, "comment_id": 102386349, "body": "That&#39;s probably another stackoverflow question in itself :) It demangles mangles function signatures, generated backtraces come with mangled names. Here is a wiki article on it :) <a href=\"https://en.wikipedia.org/wiki/Name_mangling\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Name_mangling</a>"}, {"owner": {"reputation": 62488, "user_id": 45249, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/81039d357ce18bee9dd8fac6c1c56290?s=128&d=identicon&r=PG", "display_name": "mouviciel", "link": "https://stackoverflow.com/users/45249/mouviciel"}, "edited": false, "score": 0, "creation_date": 1568799538, "post_id": 57989227, "comment_id": 102386749, "body": "OK, I see: this is a Microsoft thing followed by GCC when compiling for Windows."}, {"owner": {"reputation": 1170, "user_id": 2682012, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ii27c.jpg?s=128&g=1", "display_name": "ericcurtin", "link": "https://stackoverflow.com/users/2682012/ericcurtin"}, "reply_to_user": {"reputation": 62488, "user_id": 45249, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/81039d357ce18bee9dd8fac6c1c56290?s=128&d=identicon&r=PG", "display_name": "mouviciel", "link": "https://stackoverflow.com/users/45249/mouviciel"}, "edited": false, "score": 0, "creation_date": 1568800657, "post_id": 57989227, "comment_id": 102387386, "body": "This is relevant to all platforms. I have never used this on Windows, although I&#39;m sure it&#39;s relevant there too."}], "answers": [{"comments": [{"owner": {"reputation": 1170, "user_id": 2682012, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ii27c.jpg?s=128&g=1", "display_name": "ericcurtin", "link": "https://stackoverflow.com/users/2682012/ericcurtin"}, "edited": false, "score": 0, "creation_date": 1568811024, "post_id": 57989330, "comment_id": 102393148, "body": "Apologies I quickly saw this comment after I wrote the question"}], "tags": [], "owner": {"reputation": 1170, "user_id": 2682012, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ii27c.jpg?s=128&g=1", "display_name": "ericcurtin", "link": "https://stackoverflow.com/users/2682012/ericcurtin"}, "is_accepted": true, "score": 2, "last_activity_date": 1568798510, "creation_date": 1568798510, "answer_id": 57989330, "question_id": 57989227, "link": "https://stackoverflow.com/questions/57989227/c-equivalent-for-cxa-demangle-for-gcc/57989330#57989330", "title": "C equivalent for __cxa_demangle for gcc?", "body": "<p>Answering my own question it's in the comment of the source code:</p>\n\n<pre><code>   *  @note The same demangling functionality is available via\n   *  libiberty (@c &lt;libiberty/demangle.h&gt; and @c libiberty.a) in GCC\n   *  3.1 and later, but that requires explicit installation (@c\n   *  --enable-install-libiberty) and uses a different API, although\n   *  the ABI is unchanged.\n   */\n  char*\n  __cxa_demangle(const char* __mangled_name, char* __output_buffer,\n         size_t* __length, int* __status);\n</code></pre>\n"}], "owner": {"reputation": 1170, "user_id": 2682012, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ii27c.jpg?s=128&g=1", "display_name": "ericcurtin", "link": "https://stackoverflow.com/users/2682012/ericcurtin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 475, "favorite_count": 0, "accepted_answer_id": 57989330, "answer_count": 1, "score": 1, "last_activity_date": 1568798510, "creation_date": 1568798228, "question_id": 57989227, "link": "https://stackoverflow.com/questions/57989227/c-equivalent-for-cxa-demangle-for-gcc", "title": "C equivalent for __cxa_demangle for gcc?", "body": "<p>I have used the following function in the past to demangle c++ symbols it has proved very useful:</p>\n\n<pre><code>char* __cxa_demangle(const char* __mangled_name, char* __output_buffer, size_t* __length, int* __status);\n</code></pre>\n\n<p>Now I work on a C application that uses gcc, but cannot use __cxa_demangle as it is a C program (it's only available with g++ the C++ compiler), in C++ I would have typically called as follows:</p>\n\n<pre><code>abi::__cxa_demangle(mangled.c_str(), NULL, 0, 0);\n</code></pre>\n\n<p>Anybody know how to achieve the same in C?</p>\n"}, {"tags": ["c", "libcurl"], "answers": [{"comments": [{"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 0, "creation_date": 1568798487, "post_id": 57989195, "comment_id": 102386104, "body": "Also, duplicate."}, {"owner": {"reputation": 1, "user_id": 12084029, "user_type": "registered", "profile_image": "https://graph.facebook.com/2537315809624117/picture?type=large", "display_name": "Arthur Milon", "link": "https://stackoverflow.com/users/12084029/arthur-milon"}, "edited": false, "score": 1, "creation_date": 1568798818, "post_id": 57989195, "comment_id": 102386314, "body": "I sorry my post wasn&#39;t clear, I know the code I posted isn&#39;t suppose to write anything in memory. It&#39;s when I use the code from the  tutorial that it doesn&#39;t write anything (and there isn&#39;t any errors)."}, {"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "reply_to_user": {"reputation": 1, "user_id": 12084029, "user_type": "registered", "profile_image": "https://graph.facebook.com/2537315809624117/picture?type=large", "display_name": "Arthur Milon", "link": "https://stackoverflow.com/users/12084029/arthur-milon"}, "edited": false, "score": 0, "creation_date": 1568799275, "post_id": 57989195, "comment_id": 102386605, "body": "@ArthurMilon: Then please post the <i>exact</i> code that isn&#39;t working for you, because the <i>exact</i> code from the tutorials is working just fine, and we cannot find errors you aren&#39;t showing us. ;-) That&#39;s what a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> is for (and why it is more or less required by SO)."}, {"owner": {"reputation": 1, "user_id": 12084029, "user_type": "registered", "profile_image": "https://graph.facebook.com/2537315809624117/picture?type=large", "display_name": "Arthur Milon", "link": "https://stackoverflow.com/users/12084029/arthur-milon"}, "edited": false, "score": 0, "creation_date": 1568811219, "post_id": 57989195, "comment_id": 102393263, "body": "I&#39;ve updated the post"}, {"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "reply_to_user": {"reputation": 1, "user_id": 12084029, "user_type": "registered", "profile_image": "https://graph.facebook.com/2537315809624117/picture?type=large", "display_name": "Arthur Milon", "link": "https://stackoverflow.com/users/12084029/arthur-milon"}, "edited": false, "score": 0, "creation_date": 1568811922, "post_id": 57989195, "comment_id": 102393668, "body": "@ArthurMilon: See updated answer."}, {"owner": {"reputation": 1, "user_id": 12084029, "user_type": "registered", "profile_image": "https://graph.facebook.com/2537315809624117/picture?type=large", "display_name": "Arthur Milon", "link": "https://stackoverflow.com/users/12084029/arthur-milon"}, "edited": false, "score": 1, "creation_date": 1568813150, "post_id": 57989195, "comment_id": 102394406, "body": "Thanks a lot it works !!!! After some testing of my old code it was only malfunctionning with connect4.gamesolver.org  (google and some others worked just fine). But you seem to have resolved my problem. I&#39;ll try a similar solution to store in memory instead.  Thank you again"}], "tags": [], "owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "is_accepted": false, "score": 1, "last_activity_date": 1568811909, "last_edit_date": 1568811909, "creation_date": 1568798130, "answer_id": 57989195, "question_id": 57989119, "link": "https://stackoverflow.com/questions/57989119/cant-store-libcurl-results-outputs-empty-files-or-doesnt-write-in-memory/57989195#57989195", "title": "Can&#39;t store libcurl results. (Outputs empty files or doesn&#39;t write in memory)", "body": "<p>You did not set <code>CURLOPT_WRITEFUNCTION</code>, the function that libcurl should call back to for actually writing your data, and <code>CURLOPT_WRITEDATA</code>, the stream that should be passed to that function. Look again at your <a href=\"https://curl.haxx.se/libcurl/c/url2file.html\" rel=\"nofollow noreferrer\">first tutorial</a>:</p>\n\n<pre><code>static size_t write_data(void *ptr, size_t size, size_t nmemb, void *stream)\n{\n  size_t written = fwrite(ptr, size, nmemb, (FILE *)stream);\n  return written;\n}\n\nint main(int argc, char *argv[])\n{\n    // ...\n    /* send all data to this function  */ \n    curl_easy_setopt(curl_handle, CURLOPT_WRITEFUNCTION, write_data);\n\n    /* open the file */ \n    pagefile = fopen(pagefilename, \"wb\");\n    if(pagefile) {\n\n      /* write the page body to this file handle */ \n      curl_easy_setopt(curl_handle, CURLOPT_WRITEDATA, pagefile);\n\n      /* get it! */ \n      curl_easy_perform(curl_handle);\n\n      /* close the header file */ \n      fclose(pagefile);\n    }\n\n    // ...\n}\n</code></pre>\n\n<p>The result is that your request is actually sent, the reply received, but the data isn't written anywhere.</p>\n\n<p><strong>Update:</strong></p>\n\n<p>The code from your updated post works fine for me. I therefore assume your problem lies elsewhere. Try this instead of the original filehandling part:</p>\n\n<pre><code>  char errorbuf[ CURL_ERROR_SIZE ] = \"\";\n  curl_easy_setopt(curl_handle, CURLOPT_ERRORBUFFER, errorbuf); \n\n  /* open the file */ \n  pagefile = fopen(pagefilename, \"wb\");\n  if(pagefile) {\n\n    /* write the page body to this file handle */ \n    curl_easy_setopt(curl_handle, CURLOPT_WRITEDATA, pagefile);\n\n    /* get it! */ \n    if ( curl_easy_perform(curl_handle) != CURLE_OK )\n    {\n      fputs( errorbuf, stderr );\n    }\n\n    /* close the header file */ \n    fclose(pagefile);\n  }\n  else\n  {\n    perror( \"fopen failed\" );\n  }\n</code></pre>\n\n<p>Note that, while tutorials usually skip proper error handling, what I showcased above <em>should</em> be part of \"real\" code anyway.</p>\n"}], "owner": {"reputation": 1, "user_id": 12084029, "user_type": "registered", "profile_image": "https://graph.facebook.com/2537315809624117/picture?type=large", "display_name": "Arthur Milon", "link": "https://stackoverflow.com/users/12084029/arthur-milon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "closed_date": 1568798460, "answer_count": 1, "score": 0, "last_activity_date": 1568811909, "creation_date": 1568797901, "last_edit_date": 1568799662, "question_id": 57989119, "link": "https://stackoverflow.com/questions/57989119/cant-store-libcurl-results-outputs-empty-files-or-doesnt-write-in-memory", "closed_reason": "Duplicate", "title": "Can&#39;t store libcurl results. (Outputs empty files or doesn&#39;t write in memory)", "body": "<p>I'm trying to build a connect4 that could beat you at the game and since I'm no expert in AI I decided to get the moves the computer does from a website (I get a JSON files).\nI've tried many solutions but libcurl seamed to work best. I managed to get a correct output in prompt.</p>\n\n<p>It's weird because I get a display when I don't want to put it in memory and as soon as I try to save it anywere it disapears. I've tried different website only the one I want is affected.</p>\n\n<p>Here's the JSON want <a href=\"http://connect4.gamesolver.org/solve?pos=44\" rel=\"nofollow noreferrer\">http://connect4.gamesolver.org/solve?pos=44</a></p>\n\n<p>But when I tried to put either the string into memory or in a file it just writes nothing. (I've used the code provided by libcurl...</p>\n\n<p><a href=\"https://curl.haxx.se/libcurl/c/url2file.html\" rel=\"nofollow noreferrer\">https://curl.haxx.se/libcurl/c/url2file.html</a> I just get an empty file</p>\n\n<p><a href=\"https://curl.haxx.se/libcurl/c/getinmemory.html\" rel=\"nofollow noreferrer\">https://curl.haxx.se/libcurl/c/getinmemory.html</a> I says 0 bytes written ).</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n\n#include &lt;curl/curl.h&gt;\n\nstatic size_t write_data(void *ptr, size_t size, size_t nmemb, void *stream)\n{\n  size_t written = fwrite(ptr, size, nmemb, (FILE *)stream);\n  return written;\n}\n\nint main(int argc, char *argv[])\n{\n  CURL *curl_handle;\n  static const char *pagefilename = \"page.out\";\n  FILE *pagefile;\n\n  if(argc &lt; 2) {\n    printf(\"Usage: %s &lt;URL&gt;\\n\", argv[0]);\n    return 1;\n  }\n\n  curl_global_init(CURL_GLOBAL_ALL);\n\n  /* init the curl session */ \n  curl_handle = curl_easy_init();\n\n  /* set URL to get here */ \n  curl_easy_setopt(curl_handle, CURLOPT_URL, argv[1]);\n\n  /* Switch on full protocol/debug output while testing */ \n  curl_easy_setopt(curl_handle, CURLOPT_VERBOSE, 1L);\n\n  /* disable progress meter, set to 0L to enable and disable debug output */ \n  curl_easy_setopt(curl_handle, CURLOPT_NOPROGRESS, 1L);\n\n  /* send all data to this function  */ \n  curl_easy_setopt(curl_handle, CURLOPT_WRITEFUNCTION, write_data);\n\n  /* open the file */ \n  pagefile = fopen(pagefilename, \"wb\");\n  if(pagefile) {\n\n    /* write the page body to this file handle */ \n    curl_easy_setopt(curl_handle, CURLOPT_WRITEDATA, pagefile);\n\n    /* get it! */ \n    curl_easy_perform(curl_handle);\n\n    /* close the header file */ \n    fclose(pagefile);\n  }\n\n  /* cleanup curl stuff */ \n  curl_easy_cleanup(curl_handle);\n\n  curl_global_cleanup();\n\n  return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "arduino", "embedded", "interrupt"], "comments": [{"owner": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "edited": false, "score": 1, "creation_date": 1568797848, "post_id": 57988939, "comment_id": 102385718, "body": "Firstly, yes there are different types of encoders. You should consult the datasheet of the one you are using. Secondly, depending on the encoder you may need hardware and/or software debouncing."}, {"owner": {"reputation": 56, "user_id": 11896672, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/c2a3e41c439fcd45a9dd510cfe3da5c7?s=128&d=identicon&r=PG", "display_name": "TeaRex", "link": "https://stackoverflow.com/users/11896672/tearex"}, "edited": false, "score": 0, "creation_date": 1568797896, "post_id": 57988939, "comment_id": 102385742, "body": "Whatever triggers your call of <code>rotary_spin()</code> is most probably the culprit. Because you check only whether A is currently high, not whether there is a flank. Can you give a minimal reproducible example code?"}, {"owner": {"reputation": 47633, "user_id": 3889449, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb07e0f09deb982a1a0deedca7a5c002?s=128&d=identicon&r=PG", "display_name": "Marco Bonelli", "link": "https://stackoverflow.com/users/3889449/marco-bonelli"}, "edited": false, "score": 0, "creation_date": 1568798010, "post_id": 57988939, "comment_id": 102385810, "body": "What would the expected output be? <code>+ - +</code>?"}, {"owner": {"reputation": 1421, "user_id": 2790957, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/03mgN.jpg?s=128&g=1", "display_name": "Fitzi", "link": "https://stackoverflow.com/users/2790957/fitzi"}, "reply_to_user": {"reputation": 47633, "user_id": 3889449, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb07e0f09deb982a1a0deedca7a5c002?s=128&d=identicon&r=PG", "display_name": "Marco Bonelli", "link": "https://stackoverflow.com/users/3889449/marco-bonelli"}, "edited": false, "score": 0, "creation_date": 1568810819, "post_id": 57988939, "comment_id": 102393034, "body": "@MarcoBonelli <code>+</code> only for CW, <code>-</code> only for CCW, I&#39;d assume."}, {"owner": {"reputation": 147, "user_id": 4067754, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-3kVjMnOdixU/AAAAAAAAAAI/AAAAAAAAH-8/6Kw1o-G4ZNU/photo.jpg?sz=128", "display_name": "Jakob Kenda", "link": "https://stackoverflow.com/users/4067754/jakob-kenda"}, "reply_to_user": {"reputation": 56, "user_id": 11896672, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/c2a3e41c439fcd45a9dd510cfe3da5c7?s=128&d=identicon&r=PG", "display_name": "TeaRex", "link": "https://stackoverflow.com/users/11896672/tearex"}, "edited": false, "score": 0, "creation_date": 1568811170, "post_id": 57988939, "comment_id": 102393240, "body": "@TeaRex rotary_spin() is triggered by an interrupt that happens when pin rotary_A is rising. This is minimal reproducible code."}, {"owner": {"reputation": 1428, "user_id": 2819922, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e61964f3e5cdcde3dc90370e0cdfe2d4?s=128&d=identicon&r=PG&f=1", "display_name": "datafiddler", "link": "https://stackoverflow.com/users/2819922/datafiddler"}, "edited": false, "score": 0, "creation_date": 1568811272, "post_id": 57988939, "comment_id": 102393290, "body": "Could bouncing cause the troubles you see?"}, {"owner": {"reputation": 1421, "user_id": 2790957, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/03mgN.jpg?s=128&g=1", "display_name": "Fitzi", "link": "https://stackoverflow.com/users/2790957/fitzi"}, "edited": false, "score": 0, "creation_date": 1568811278, "post_id": 57988939, "comment_id": 102393297, "body": "@JakobKenda I assume your encoder has three pins, A, B and Common, which you connected to ground - is this correct?"}, {"owner": {"reputation": 147, "user_id": 4067754, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-3kVjMnOdixU/AAAAAAAAAAI/AAAAAAAAH-8/6Kw1o-G4ZNU/photo.jpg?sz=128", "display_name": "Jakob Kenda", "link": "https://stackoverflow.com/users/4067754/jakob-kenda"}, "reply_to_user": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "edited": false, "score": 0, "creation_date": 1568811293, "post_id": 57988939, "comment_id": 102393302, "body": "@RishikeshRaje I consulted the manual and the encoder is the type that I described above. But what is debouncing? &lt;br&gt;"}, {"owner": {"reputation": 1421, "user_id": 2790957, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/03mgN.jpg?s=128&g=1", "display_name": "Fitzi", "link": "https://stackoverflow.com/users/2790957/fitzi"}, "edited": false, "score": 0, "creation_date": 1568811814, "post_id": 57988939, "comment_id": 102393604, "body": "@JakobKenda Then please provide a link to the datasheet of the encoder."}, {"owner": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "edited": false, "score": 0, "creation_date": 1568811886, "post_id": 57988939, "comment_id": 102393645, "body": "@JakobKenda - Debouncing is required if you have inputs e.g. a switch where it is made ON and for a short time it turns OFF-ON-OFF-ON. In your case, this may already be handled by the hardware. Can you tell me 1. What encoder you are using. 2. What speed you are turning the wheel."}, {"owner": {"reputation": 147, "user_id": 4067754, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-3kVjMnOdixU/AAAAAAAAAAI/AAAAAAAAH-8/6Kw1o-G4ZNU/photo.jpg?sz=128", "display_name": "Jakob Kenda", "link": "https://stackoverflow.com/users/4067754/jakob-kenda"}, "reply_to_user": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "edited": false, "score": 0, "creation_date": 1568812803, "post_id": 57988939, "comment_id": 102394195, "body": "@RishikeshRaje 1. I am using a rotary encoder from a Sunfounder kit, but the manual doesn&#39;t say which one it is specifically. It is soldered on a small board which has 4 resistors on it, so I&#39;m guessing I don&#39;t need to mount additional ones. 2. I am turning the wheel only one step at a time."}, {"owner": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "edited": false, "score": 1, "creation_date": 1568813410, "post_id": 57988939, "comment_id": 102394557, "body": "Since you mention steps during the turning, i guess that there may be some jitter in the outputs. You will probably require some sort of debouncing. I suggest you read up <a href=\"https://www.arduino.cc/en/tutorial/debounce\" rel=\"nofollow noreferrer\">arduino.cc/en/tutorial/debounce</a> For an encoder, it is somewhat more complicated. The timing depends on what speed you wish to support. A fast encoder typically cannot be debounced in software. If it is slow, you can possibly do it."}, {"owner": {"reputation": 5397, "user_id": 11294831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M9BL5.png?s=128&g=1", "display_name": "the busybee", "link": "https://stackoverflow.com/users/11294831/the-busybee"}, "edited": false, "score": 0, "creation_date": 1568832660, "post_id": 57988939, "comment_id": 102404127, "body": "There are always problems when you have a bouncing signal on an interrupt pin. You need to catch the falling edge, too, and if too many edges happen while the ISR still runs, it will miss some. So don&#39;t do this. Instead debounce the signals in hardware or use another software approach. The latter could be a polling at a slow rate like every 10ms."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1568970337, "post_id": 57988939, "comment_id": 102452747, "body": "Please read <a href=\"https://stackoverflow.com/a/32647699/584518\">this</a>."}], "answers": [{"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1568970421, "post_id": 58018785, "comment_id": 102452781, "body": "How does this solve debouncing and the OP tying the encoder straight to an interrupt pin?"}, {"owner": {"reputation": 31, "user_id": 7968005, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SU4Q1.gif?s=128&g=1", "display_name": "David_Zbyn", "link": "https://stackoverflow.com/users/7968005/david-zbyn"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1569187294, "post_id": 58018785, "comment_id": 102504874, "body": "well , in my setup it works, although it is really dependent on the hardware I guess. and how the signaling to the cpu works, if it is mech. contact then it might have problems with de-bouncing, in mine i am using opt-couplers and magnets which control the disc positioning.  Still some idea which might be useful for cultivation of data."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1569227982, "post_id": 58018785, "comment_id": 102514260, "body": "Optocouplers don&#39;t solve anything because they are fast enough to forward the signal bounces. Though I suppose with some luck they might filter some of the spikes out."}], "tags": [], "owner": {"reputation": 31, "user_id": 7968005, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SU4Q1.gif?s=128&g=1", "display_name": "David_Zbyn", "link": "https://stackoverflow.com/users/7968005/david-zbyn"}, "is_accepted": false, "score": 0, "last_activity_date": 1568969954, "last_edit_date": 1568969954, "creation_date": 1568926263, "answer_id": 58018785, "question_id": 57988939, "link": "https://stackoverflow.com/questions/57988939/how-to-read-rotary-encoder-input/58018785#58018785", "title": "How to read rotary encoder input", "body": "<p>check this repository of mine on Github.</p>\n\n<p><a href=\"https://github.com/KingZuluKing/Rotary-Encoder-Peripheral-System\" rel=\"nofollow noreferrer\">https://github.com/KingZuluKing/Rotary-Encoder-Peripheral-System</a> </p>\n\n<p>It has to be something like this, more details inside the repo. </p>\n\n<pre><code>  void encode_Rotor_func()\n{\n    lcd.clear();\n    Vol_Knob_stat=digitalRead(Vol_Knob);    \n    if(Vol_Knob_stat==0)\n    {\n      Vol_Dir_stat=digitalRead(Vol_Dir); \n      if(Vol_Dir_stat==0 &amp;&amp; deciBells&lt;=9)\n      {\n        deciBells++;\n        lcd.setCursor(0, 0);\n        lcd.print(\"VOLUME=   .\");\n        lcd.setCursor(7, 0);\n        lcd.print(deciBells);\n        lcd.setCursor(10, 0);\n        lcd.print(\"dB's\");\n       }\n    else if(Vol_Dir_stat==1 &amp;&amp; deciBells &gt;=-79)\n    {\n      deciBells--;\n      lcd.setCursor(0, 0);\n      lcd.print(\"VOLUME=   .\");\n      lcd.setCursor(7, 0);\n      lcd.print(deciBells);\n      lcd.setCursor(10, 0);\n      lcd.print(\"dB's\");\n    }\n    else{\n          do something else etc.. etc....\n   }\n   }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2316, "user_id": 469006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3855250cd4b053ce9204c773246196b?s=128&d=identicon&r=PG", "display_name": "D Krueger", "link": "https://stackoverflow.com/users/469006/d-krueger"}, "is_accepted": false, "score": 1, "last_activity_date": 1569005149, "creation_date": 1569005149, "answer_id": 58033738, "question_id": 57988939, "link": "https://stackoverflow.com/questions/57988939/how-to-read-rotary-encoder-input/58033738#58033738", "title": "How to read rotary encoder input", "body": "<p>The question implies that there should only be a single interrupt per revolution. But encoders typically generate more than a single cycle per revolution--some in the thousands. That is probably why the interrupts seem to occur more rapidly than expected.</p>\n\n<p>In a zero-latency interrupt environment, the code should work. But if the phase B pin is sampled too long after the phase A pin goes high, it will fail. This might occur if the next phase A rising edge occurs while <code>Serial.println</code> is still executing in the previous interrupt.</p>\n\n<p>A simple test to see if this is the case is to turn the encoder <em>very</em>, <em>very</em> slowly. If this results in correct data, the problem is probably interrupt latency. <code>Serial.println</code> can then be replaced with something much quicker, like illuminating LEDs, to see if that resolves latency issues.</p>\n\n<p>For actual use, you would need to make sure that the worse-case latency between phase A going high and phase B being sampled is adequate for the maximum rate of encoder rotation.</p>\n\n<p><em>Final note</em>: The code should be able to adequately detect direction, but cannot be used to increment/decrement a counter to track position. That requires more than one interrupt per cycle.</p>\n"}], "owner": {"reputation": 147, "user_id": 4067754, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-3kVjMnOdixU/AAAAAAAAAAI/AAAAAAAAH-8/6Kw1o-G4ZNU/photo.jpg?sz=128", "display_name": "Jakob Kenda", "link": "https://stackoverflow.com/users/4067754/jakob-kenda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 421, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1569005149, "creation_date": 1568797368, "last_edit_date": 1568970132, "question_id": 57988939, "link": "https://stackoverflow.com/questions/57988939/how-to-read-rotary-encoder-input", "title": "How to read rotary encoder input", "body": "<p>I have a simple question about how to read rotary encoder input.\nIf I understand <a href=\"https://playground.arduino.cc/uploads/Main/RotaryEncoderWaveform/index.gif\" rel=\"nofollow noreferrer\">this</a> image correctly, then every turn triggers a rise on pin A. Then, you have to check pin B, which is high if the encoder is turning clockwise and low if the encoder is turning counter clockwise.\n<img src=\"https://playground.arduino.cc/uploads/Main/RotaryEncoderWaveform/index.gif\" alt=\"diagram\"></p>\n\n<p>I've tried to write my own code and not using any libraries, because I thought this would be really simple, but it turned out it was not.</p>\n\n<p>This is the code I've written:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#define rotary_A 2\n#define rotary_B 3\n\nvoid setup() \n{\n  pinMode(rotary_A, INPUT);\n  pinMode(rotary_B,  INPUT);\n\n  attachInterrupt(digitalPinToInterrupt(rotary_A), rotary_spin, RISING);\n\n  Serial.begin(9600);\n}\n\nvoid rotary_spin()\n{\n  if (digitalRead(rotary_B) == HIGH)\n    Serial.println(\"+\");\n  else\n    Serial.println(\"-\");\n}\n</code></pre>\n\n<p>I was expecting to get <code>+</code> when I turn it clockwise and <code>-</code> when I turn it counter clockwise. However, I'm getting several outputs for each turn, like there were several interrupts triggered in rapid succession. For example, when I turn the encoder clockwise:</p>\n\n<pre><code>-\n-\n+\n+\n</code></pre>\n\n<p>and counter clockwise:</p>\n\n<pre><code>+\n+\n-\n-\n-\n-\n</code></pre>\n\n<p>The outputs are different every time, but the last character is always the right one. <br>\nWhat am I getting wrong? Is it not that simple or are there different types of encoders?</p>\n"}, {"tags": ["c", "git", "dependencies", "unity-test-framework"], "owner": {"reputation": 18883, "user_id": 2612235, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/dpsjq.jpg?s=128&g=1", "display_name": "nowox", "link": "https://stackoverflow.com/users/2612235/nowox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 78, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1593373760, "creation_date": 1568797367, "last_edit_date": 1593373760, "question_id": 57988938, "link": "https://stackoverflow.com/questions/57988938/how-to-include-throwtheswitch-unity-in-a-c-project", "title": "How to include ThrowTheSwitch/Unity in a C project?", "body": "<p>I would like to use ThrowTheSwitch Unity for my unit tests in several projects so I have this generic structure:</p>\n\n<pre><code>.\n\u251c\u2500\u2500 README.md\n\u251c\u2500\u2500 Makefile\n\u251c\u2500\u2500 src\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 ...\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 main.c\n\u2514\u2500\u2500 test\n \u00a0\u00a0 \u251c\u2500\u2500 vendor\n \u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 unity.c\n \u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 unity.h\n \u00a0\u00a0 \u2514\u2500\u2500 test_main.c\n</code></pre>\n\n<p>To include unity I could use different approach: </p>\n\n<ol>\n<li>Git Submodules\n\n<ul>\n<li><strong>pros</strong>: git only, one single source of truth</li>\n<li><strong>cons</strong>: get all the unity repository while only 3 files are required</li>\n</ul></li>\n<li>Git Submodules with sparse checkout\n\n<ul>\n<li><strong>pros</strong>: only get what I need</li>\n<li><strong>cons</strong>: need some hack to enable the sparse-checkout</li>\n</ul></li>\n<li>Git Subtree\n\n<ul>\n<li><strong>pros</strong>: safe if no internet available</li>\n<li><strong>cons</strong>: keep local copies of unity in the history</li>\n</ul></li>\n<li>Wget from a release\n\n<ul>\n<li><strong>pros</strong>: very simple, very effective</li>\n<li><strong>cons</strong>: dependency on <code>wget</code> and <code>tar</code> and internet (no local cache)</li>\n</ul></li>\n<li>Local copy of unity\n\n<ul>\n<li><strong>pros</strong>: most simple solution, effective</li>\n<li><strong>cons</strong>: not SSOT, all similar projects will have their local copy of unity, lost track of which unity version is synced. </li>\n</ul></li>\n</ol>\n\n<p>It seems none of the above method is perfect and I don't know which one to choose. The best solution would be to have a simple package manager with a <code>package.json</code> file that list my dependencies and their versions.</p>\n\n<p>Is there any other/better solution?</p>\n"}, {"tags": ["c", "stm32", "fwrite", "fclose", "fatfs"], "comments": [{"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1568822050, "post_id": 57988765, "comment_id": 102399812, "body": "<a href=\"https://flashdba.com/2014/12/10/understanding-flash-unpredictable-write-performance/\" rel=\"nofollow noreferrer\">flashdba.com/2014/12/10/&hellip;</a>"}, {"owner": {"reputation": 3918, "user_id": 2774842, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mR91F.jpg?s=128&g=1", "display_name": "Unn", "link": "https://stackoverflow.com/users/2774842/unn"}, "edited": false, "score": 2, "creation_date": 1568822131, "post_id": 57988765, "comment_id": 102399866, "body": "I&#39;m not 100% sure this is your problem, so I&#39;m posting as a comment. It&#39;s likely this is just a matter of how the SD card works and has little to do with the fatfs (though how far tables are layed out might be contributing to how frequent this happens). While sd cards on average are decently fast (though cheaper ones can be pretty slow), they do occasionally take a while to do a write (since they have to erase a page to write to previously written to bytes, and also has to manage wear leveling to prevent bytes from becoming unusable). Might be worth probing the SD cmd line to see what&#39;s up."}, {"owner": {"reputation": 2568, "user_id": 8548828, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/C4qkl.png?s=128&g=1", "display_name": "Tarick Welling", "link": "https://stackoverflow.com/users/8548828/tarick-welling"}, "edited": false, "score": 0, "creation_date": 1568877791, "post_id": 57988765, "comment_id": 102416297, "body": "does this happen on a cycle? as in do you write X times and then have your slow open/close and after that it&#39;s fast again?"}, {"owner": {"reputation": 1, "user_id": 12040682, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WB6Ej.jpg?s=128&g=1", "display_name": "Rim3rd", "link": "https://stackoverflow.com/users/12040682/rim3rd"}, "reply_to_user": {"reputation": 3918, "user_id": 2774842, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mR91F.jpg?s=128&g=1", "display_name": "Unn", "link": "https://stackoverflow.com/users/2774842/unn"}, "edited": false, "score": 0, "creation_date": 1568882033, "post_id": 57988765, "comment_id": 102418409, "body": "@Unn After reading around the source that Hans provided I think you could be right. I&#39;ll get the scope out, cheers."}, {"owner": {"reputation": 1, "user_id": 12040682, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WB6Ej.jpg?s=128&g=1", "display_name": "Rim3rd", "link": "https://stackoverflow.com/users/12040682/rim3rd"}, "reply_to_user": {"reputation": 2568, "user_id": 8548828, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/C4qkl.png?s=128&g=1", "display_name": "Tarick Welling", "link": "https://stackoverflow.com/users/8548828/tarick-welling"}, "edited": false, "score": 0, "creation_date": 1568882040, "post_id": 57988765, "comment_id": 102418411, "body": "@TarickWelling No, it appears to be sporadic - non cyclical."}], "owner": {"reputation": 1, "user_id": 12040682, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WB6Ej.jpg?s=128&g=1", "display_name": "Rim3rd", "link": "https://stackoverflow.com/users/12040682/rim3rd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 450, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1568882337, "creation_date": 1568796746, "last_edit_date": 1568882337, "question_id": 57988765, "link": "https://stackoverflow.com/questions/57988765/fatfs-f-write-and-f-close-inconsistent-in-execution-speed", "title": "FATFS f_write and f_close inconsistent in execution speed", "body": "<p>Using Systick to count how long each function takes in the process of writing data to an SD card (4 bit SDIO + DMA) from an STM32f411RE, I get a sporadic execution time on both the f_write and f_close functions. </p>\n\n<p>Most of the time the f_write takes around 20 to 30ms to complete and the f_close around 5 to 10ms but occasionally, in  an app that does nothing but iteratively write dummy data to SD, these functions take over 300ms before immediately speeding up again on the next write iteration.</p>\n\n<p>I'm thinking including code may not be necessary but here's the rough idea anyway:</p>\n\n<pre><code>if (f_mount(&amp;myFatFS, SDPath, 1) == FR_OK)\n   {mountTime = TimingDelay; //TimingDelay is counted using systick\n\n   if (f_open(&amp;myFile, myFileName, FA_WRITE | FA_OPEN_APPEND) == FR_OK)\n      {\n       fileOpenTime = TimingDelay;\n\n       sprintf(data1,\"dummy data 64kB in length\"); \n\n       dataGenTime = TimingDelay;\n\n       f_write(&amp;myFile, data1, 64000, &amp;myBytes); //write dummy data to chip\n\n       writeTime = TimingDelay;\n\n       f_close(&amp;myFile);\n\n       fileCloseTime = TimingDelay;\n...etc\n\n</code></pre>\n\n<p>I'm using the differences in 'TimingDelay' which decrements on each systick interrupt, to calculate the time spent on each stage, for example <code>writeTime - fileCloseTime</code> gives the time taken to close the file; <code>f_close</code>.</p>\n\n<p>the size of the dummy data char[] does not change.</p>\n\n<p>Is FATFS just inherently unstable or is there a common practice that I am unaware of to stop the hiccups?</p>\n\n<p>EDIT: I should mention using <code>f_sync()</code> instead of <code>f_close()</code> on each cycle yields a marginal improvement in average speed but it still suffers the same sporadic hesitations. </p>\n"}, {"tags": ["c", "linux-kernel", "locking", "rcu"], "comments": [{"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 3, "creation_date": 1568805304, "post_id": 57988667, "comment_id": 102389948, "body": "As I understand it, it is a mechanism to allow readers to <i>read</i> a potentially stale, <i>copy</i> of some data structure while a writer is <i>updating</i> the master copy."}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "reply_to_user": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 3, "creation_date": 1568805756, "post_id": 57988667, "comment_id": 102390225, "body": "@IanAbbott: Actually, in RCU all parts are for the <b>writer</b>: It <i>reads</i> an object, <i>copies</i> it, and <i>updates</i> that copy. After that, a pointer to the copy is published for the readers, while the previous object is still alive."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "reply_to_user": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1568806455, "post_id": 57988667, "comment_id": 102390647, "body": "@Tsyvarev Yes, sorry I didn&#39;t make it clear that the writer does all the work. I didn&#39;t mean to imply that the reader makes the copy, but I can see how what I wrote is possibly misleading."}, {"owner": {"reputation": 3820, "user_id": 10678955, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gRpbG.jpg?s=128&g=1", "display_name": "root", "link": "https://stackoverflow.com/users/10678955/root"}, "edited": false, "score": 0, "creation_date": 1569097037, "post_id": 57988667, "comment_id": 102487807, "body": "You&#39;re not using the <a href=\"https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/Documentation/RCU/whatisRCU.txt\" rel=\"nofollow noreferrer\">RCU API</a> correctly."}], "answers": [{"tags": [], "owner": {"reputation": 2215, "user_id": 1996540, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/609b69cbb09257883a4e32d7d5aff098?s=128&d=identicon&r=PG", "display_name": "ZedTuX", "link": "https://stackoverflow.com/users/1996540/zedtux"}, "is_accepted": false, "score": 0, "last_activity_date": 1588580884, "last_edit_date": 1592644375, "creation_date": 1588580884, "answer_id": 61588024, "question_id": 57988667, "link": "https://stackoverflow.com/questions/57988667/what-does-rcu-read-lock-actually-do-linux-kernel/61588024#61588024", "title": "What does rcu_read_lock() actually do (Linux Kernel)", "body": "<p>You can find <a href=\"https://www.kernel.org/doc/Documentation/RCU/whatisRCU.txt\" rel=\"nofollow noreferrer\">the RCU documentation on kernel.org</a> which describe it.</p>\n<p>Its introduction is really interesting:</p>\n<blockquote>\n<p>Although RCU is actually quite simple once you understand it,\ngetting there can sometimes be a challenge.  Part of the problem is that\nmost of the past descriptions of RCU have been written with the mistaken\nassumption that there is &quot;one true way&quot; to describe RCU.  Instead,\nthe experience has been that different people must take different paths\nto arrive at an understanding of RCU.</p>\n</blockquote>\n<p>As you can see, anyone who wants to really understand it must take the time to read the documentation.</p>\n<p>To get a basic idea of it:</p>\n<blockquote>\n<p>The basic idea behind RCU is to split updates into &quot;removal&quot; and\n&quot;reclamation&quot; phases. The removal phase removes references to data\nitems within a data structure (possibly by replacing them with\nreferences to new versions of these data items), and can run\nconcurrently with readers.</p>\n</blockquote>\n<p>Read more from the documentation.</p>\n<p>Coming now to your question, here is the description of the <code>rcu_read_lock()</code> and <code>rcu_read_unlock()</code> API functions:</p>\n<blockquote>\n<p>rcu_read_lock()</p>\n<p>void rcu_read_lock(void);</p>\n<p>Used by a reader to inform the reclaimer that the reader is entering\nan RCU read-side critical section. It is illegal to block while in\nan RCU read-side critical section, though kernels built with\nCONFIG_PREEMPT_RCU can preempt RCU read-side critical sections. Any\nRCU-protected data structure  accessed during an RCU read-side\ncritical section is guaranteed to remain unreclaimed for the full\nduration of that critical section. Reference counts may be used in\nconjunction with RCU to maintain longer-term references to data\nstructures.</p>\n<p>rcu_read_unlock()</p>\n<p>void rcu_read_unlock(void);</p>\n<p>Used by a reader to inform the reclaimer that the reader is exiting\nan RCU read-side critical section.  Note that RCU read-side critical\nsections may be nested and/or overlapping.</p>\n</blockquote>\n<p>Have a look at the &quot;WHAT ARE SOME EXAMPLE USES OF CORE RCU API?&quot; section in order to have an example of code using them.</p>\n"}], "owner": {"reputation": 393, "user_id": 5666053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c133c35c22521e9427e8e28b3d2cfe0a?s=128&d=identicon&r=PG&f=1", "display_name": "\u0410\u043d\u0434\u0440\u0456\u0439 \u041d\u0435\u043c\u0447\u0435\u043d\u043a\u043e", "link": "https://stackoverflow.com/users/5666053/%d0%90%d0%bd%d0%b4%d1%80%d1%96%d0%b9-%d0%9d%d0%b5%d0%bc%d1%87%d0%b5%d0%bd%d0%ba%d0%be"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1366, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1588580884, "creation_date": 1568796460, "last_edit_date": 1568800847, "question_id": 57988667, "link": "https://stackoverflow.com/questions/57988667/what-does-rcu-read-lock-actually-do-linux-kernel", "title": "What does rcu_read_lock() actually do (Linux Kernel)", "body": "<p>I'm trying to understand rcu_read_lock() synchronization mechanism. From what I understand, rcu_read_lock() is used, where there are several read threads and one write thread, that read/writes the same data, and reading is performed under rcu_read_lock(), and the data are copied for each thread. I wrote a simple driver to test this (read() and write() functions are core):</p>\n\n<pre><code>#include &lt;linux/module.h&gt;       /* Needed by all modules */\n#include &lt;linux/kernel.h&gt;       /* Needed for KERN_INFO */\n#include &lt;linux/init.h&gt;         /* Needed for the macros */\n#include &lt;linux/rcupdate.h&gt;\n#include &lt;linux/preempt.h&gt;\n#include &lt;linux/fs.h&gt;\n#include &lt;linux/cdev.h&gt;\n\n#define MY_MAJOR 42\n#define MY_MAX_MINORS 5\n\nchar buf[] = \"0\";\n\nstruct dev_data\n{\n    struct cdev cdev;\n};\n\nstruct dev_data devs[MY_MAX_MINORS];\n\nstatic ssize_t read(struct file *file, char __user *buffer, size_t size, loff_t *offset)\n{\n    rcu_read_lock();\n    while (1)\n    {\n        printk(KERN_INFO \"%s\", buf);\n    }\n    rcu_read_unlock();\n\n    return 0;\n}\n\nstatic ssize_t write(struct file *file, const char __user *buffer, size_t size, loff_t *offset)\n{\n    buf[0] = '1';\n\n    return size;\n}\n\nconst struct file_operations fops = {\n    .read = &amp;read,\n    .write = &amp;write,\n};\n\nstatic int __init foo_start(void)\n{\n    int i, err_code;\n\n    err_code = register_chrdev_region(MKDEV(MY_MAJOR, 0), MY_MAX_MINORS, \"Test char driver\");\n    if (err_code != 0)\n        return err_code;\n\n    for(i=0; i&lt;MY_MAX_MINORS; ++i)\n    {\n        cdev_init(&amp;devs[i].cdev, &amp;fops);\n        cdev_add(&amp;devs[i].cdev, MKDEV(MY_MAJOR, i), 1);\n    }\n\n    return 0;\n}\n\nstatic void __exit foo_end(void)\n{\n    int i;\n\n    for(i=0; i&lt;MY_MAX_MINORS; ++i)\n    {\n        cdev_del(&amp;devs[i].cdev);\n    }\n\n    unregister_chrdev_region(MKDEV(MY_MAJOR, 0), MY_MAX_MINORS);\n}\n\nmodule_init(foo_start);\nmodule_exit(foo_end);\n</code></pre>\n\n<p>but when I call the write function during reading, the data is changing under rcu_read_lock() too. Where is my mistake?<br>\nP.S. The driver itself is crippy, but my goal was just to test rcu_read_lock().</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 5, "creation_date": 1568796656, "post_id": 57988658, "comment_id": 102385026, "body": "Remember that arguments to functions are passed <i>by value</i>. That means the value is <i>copied</i> into the local argument variables, and modifying the local argument variables will not modify the original values. Please do some research about <i>emulating pass by reference in C</i> for a way to solve your problem."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1568796716, "post_id": 57988658, "comment_id": 102385060, "body": "As a possible other way to solve your problem, how about creating a <code>struct</code> with the <code>filesize</code>, <code>buffersize</code> and <code>offset</code> as members? Then you can <code>return</code> a copy of that structure."}, {"owner": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "edited": false, "score": 1, "creation_date": 1568797134, "post_id": 57988658, "comment_id": 102385276, "body": "You have leading zeros in the example, so you are not getting a problem, but you should be aware that the maximum integer in a 32 bit system is <code>2147483647</code> and a 12 byte string can exceed this."}, {"owner": {"reputation": 49, "user_id": 10733291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d611416040304b43170b683160828c6b?s=128&d=identicon&r=PG&f=1", "display_name": "Gustavo Marin", "link": "https://stackoverflow.com/users/10733291/gustavo-marin"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1568797986, "post_id": 57988658, "comment_id": 102385792, "body": "@Someprogrammerdude Thanks, I solved it using pointers. I would have loved a clearer answer though, I&#39;m still new to C."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1568799578, "post_id": 57988658, "comment_id": 102386776, "body": "@GustavoMarin You can post an answer to your own question. <a href=\"https://stackoverflow.com/help/self-answer\">stackoverflow.com/help/self-answer</a>"}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 1, "creation_date": 1568800235, "post_id": 57988658, "comment_id": 102387150, "body": "<a href=\"https://stackoverflow.com/q/17710018/995714\">Why shouldn&#39;t I use atoi()? (duplicate)</a>, <a href=\"https://blog.mozilla.org/nnethercote/2009/03/13/atol-considered-harmful/\" rel=\"nofollow noreferrer\">atol() considered harmful</a>"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1568805687, "post_id": 57988658, "comment_id": 102390171, "body": "In case you didn&#39;t read @phuclv links:  never use <code>atoi()</code>.  It has <b>NO</b> way to indicate any error in parsing its input, thus making error detection literally impossible."}], "answers": [{"tags": [], "owner": {"reputation": 88, "user_id": 7700172, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qfJ5X.jpg?s=128&g=1", "display_name": "Andre Augusto", "link": "https://stackoverflow.com/users/7700172/andre-augusto"}, "is_accepted": false, "score": 0, "last_activity_date": 1568804799, "creation_date": 1568804799, "answer_id": 57991313, "question_id": 57988658, "link": "https://stackoverflow.com/questions/57988658/why-is-atoi-not-converting-to-integer-properly/57991313#57991313", "title": "Why is atoi not converting to integer properly?", "body": "<p>Arguments in c are passed by value, if you want to modify a variable passed to a function, you need to pass it's memory location instead, then you can modify it</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include&lt;stdio.h&gt;\n#include&lt;string.h&gt;\n#include&lt;stdlib.h&gt;      \n\n/* Using int pointer type instead of int */\nvoid readheader(char header[29], int* filesize, int* buffersize, int* offset) {\n  char fsize[13], bsize[5], oset[13];\n  memcpy(fsize, &amp;header[0], 12);\n  fsize[12] = '\\0'; \n  memcpy(bsize, &amp;header[12], 4);\n  bsize[4] = '\\0';  \n  memcpy(oset, &amp;header[16], 12);\n  oset[12] = '\\0';  \n  printf(\"String Values: filesize: %s, buffersize: %s, offset: %s\\n\", fsize, bsize, oset);\n  /* Dereferencing the pointers */\n  *filesize = atoi(fsize); \n  *buffersize = atoi(bsize);\n  *offset = atoi(oset);\n}\n\nvoid main() {\n  char test[] = \"0000000051422048000000004096\";   \n  int a, b, c;\n  /* Passing by reference */\n  readheader(test, &amp;a, &amp;b, &amp;c);\n  printf(\"Integer values: filesize: %d, buffersize: %d, offset: %d\\n\", a, b, c);\n}\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 10733291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d611416040304b43170b683160828c6b?s=128&d=identicon&r=PG&f=1", "display_name": "Gustavo Marin", "link": "https://stackoverflow.com/users/10733291/gustavo-marin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 147, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1568804799, "creation_date": 1568796443, "question_id": 57988658, "link": "https://stackoverflow.com/questions/57988658/why-is-atoi-not-converting-to-integer-properly", "title": "Why is atoi not converting to integer properly?", "body": "<p>I have a pseudoheader in a string, the first 12 bits are the file size, the next 4 are the buffer size, and the last 12 are an offset. I want to store each one of this in a variable, I could get the string values, but <code>atoi</code> is not working properly when converting those to integers\nThe program looks like this:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;string.h&gt;\n#include&lt;stdlib.h&gt;\n\nvoid readheader(char header[29], int filesize, int buffersize, int offset) {\n  char fsize[13], bsize[5], oset[13];\n  memcpy(fsize, &amp;header[0], 12);\n  fsize[12] = '\\0';\n  memcpy(bsize, &amp;header[12], 4);\n  bsize[4] = '\\0';\n  memcpy(oset, &amp;header[16], 12);\n  oset[12] = '\\0';\n  printf(\"String Values: filesize: %s, buffersize: %s, offset: %s\\n\", fsize, bsize, os$\n  filesize = atoi(fsize);\n  buffersize = atoi(bsize);\n  offset = atoi(oset);\n}\n\nvoid main() {\n  char test[] = \"0000000051422048000000004096\";\n  int a, b, c;\n  readheader(test, a, b, c);\n  printf(\"Integer values: filesize: %d, buffersize: %d, offset: %d\\n\", a, b, c);\n}\n</code></pre>\n\n<p>And the output looks like this:</p>\n\n<pre><code>String Values: filesize: 000000005142, buffersize: 2048, offset: 000000004096\nInteger values: filesize: 0, buffersize: -1036019427, offset: 22039\n</code></pre>\n"}, {"tags": ["c", "pointers", "memory-leaks", "linked-list", "singly-linked-list"], "comments": [{"owner": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "edited": false, "score": 0, "creation_date": 1568796486, "post_id": 57988549, "comment_id": 102384924, "body": "Most probably because you are allocating the memory using <code>malloc</code> or <code>calloc</code>. Such memories need to be freed or the program will have memory leaks."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1568801653, "post_id": 57988549, "comment_id": 102387949, "body": "The Linus quote is mostly about <code>using a pointer-to-pointer to avoid complexity caused by special cases</code>. The code from the book fails to do so. [instead, it hides a pointer behind a <code>typedef</code>]"}], "answers": [{"tags": [], "owner": {"reputation": 11397, "user_id": 1141537, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0f0c5bf8653be794a11259ea2ffd359f?s=128&d=identicon&r=PG", "display_name": "Imran Rana", "link": "https://stackoverflow.com/users/1141537/imran-rana"}, "is_accepted": false, "score": 0, "last_activity_date": 1568796503, "creation_date": 1568796503, "answer_id": 57988684, "question_id": 57988549, "link": "https://stackoverflow.com/questions/57988549/in-a-linked-list-delete-function-is-it-necessary-to-use-free-to-delete-a-node/57988684#57988684", "title": "In a linked list delete function, is it necessary to use free to delete a node?", "body": "<p>If you don't use free then you are causing memory leak. If you move your pointer without freeing the memory then it will cause memory leak.</p>\n"}, {"comments": [{"owner": {"reputation": 63, "user_id": 9648749, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-fFSpfKm8Yho/AAAAAAAAAAI/AAAAAAAAGZc/TjWV01v_nSg/photo.jpg?sz=128", "display_name": "Impasse", "link": "https://stackoverflow.com/users/9648749/impasse"}, "edited": false, "score": 0, "creation_date": 1568796768, "post_id": 57988698, "comment_id": 102385086, "body": "Thanks, that&#39;s closer to what I wanted to know. It seemed odd to me that his of all codes would be this wrong and also end up on an article."}], "tags": [], "owner": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "is_accepted": false, "score": 1, "last_activity_date": 1568796971, "last_edit_date": 1568796971, "creation_date": 1568796545, "answer_id": 57988698, "question_id": 57988549, "link": "https://stackoverflow.com/questions/57988549/in-a-linked-list-delete-function-is-it-necessary-to-use-free-to-delete-a-node/57988698#57988698", "title": "In a linked list delete function, is it necessary to use free to delete a node?", "body": "<p>Linus describes lists as used in the Linux kernel there. And the one interesting thing is that those are intrusive lists, meaning the list-management-code is <em>not</em> responsible for freeing nodes, as the list doesn't <em>own</em> them.</p>\n\n<p>Also, the code on that site is not a complete function for deleting nodes, but only the lines for unlinking them.</p>\n\n<p>Your own list will probably be an owning list though, using <code>malloc()</code>-ed memory, right?</p>\n"}, {"comments": [{"owner": {"reputation": 63, "user_id": 9648749, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-fFSpfKm8Yho/AAAAAAAAAAI/AAAAAAAAGZc/TjWV01v_nSg/photo.jpg?sz=128", "display_name": "Impasse", "link": "https://stackoverflow.com/users/9648749/impasse"}, "edited": false, "score": 0, "creation_date": 1568844177, "post_id": 57992019, "comment_id": 102408221, "body": "So stuff like those currentPtr and previousPtr variables is actually not suggested? I&#39;m honestly really confused because I thought it was good practice to use them like that, but I&#39;m reading so many conflicting opinions about it."}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 63, "user_id": 9648749, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-fFSpfKm8Yho/AAAAAAAAAAI/AAAAAAAAGZc/TjWV01v_nSg/photo.jpg?sz=128", "display_name": "Impasse", "link": "https://stackoverflow.com/users/9648749/impasse"}, "edited": false, "score": 0, "creation_date": 1568885150, "post_id": 57992019, "comment_id": 102420077, "body": "@Impasse Using currentPtr and previousPtr is a Java style where there is no pointers. In C or C++ this can be written more more simpler without introducing intermediate variables."}], "tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 1, "last_activity_date": 1568807546, "last_edit_date": 1568807546, "creation_date": 1568807069, "answer_id": 57992019, "question_id": 57988549, "link": "https://stackoverflow.com/questions/57988549/in-a-linked-list-delete-function-is-it-necessary-to-use-free-to-delete-a-node/57992019#57992019", "title": "In a linked list delete function, is it necessary to use free to delete a node?", "body": "<p>For starters the code is very and very bad. Firstly there are duplicate code. And secondly the function is made too complicated.</p>\n\n<p>It can be written much simpler. For example</p>\n\n<pre><code>char delete( ListNodePtr *sPtr, char value )\n{\n    while ( *sPtr != NULL &amp;&amp; ( *sPtr )-&gt;data != value )\n    {\n        sPtr = &amp;( *sPtr )-&gt;nextPtr;\n    }\n\n    char result = *sPtr == NULL ? '\\0' : value;\n\n    if ( *sPtr != NULL )\n    {\n        ListNodePtr tempPtr = *sPtr;\n        *sPtr = ( *sPtr )-&gt;nextPtr;\n        free( tempPtr );\n    }\n\n    return result;\n} \n</code></pre>\n\n<p>Also it is a bad idea to use a typedef for pointers as in your program where <code>ListNodePtr</code> is evidently is such a typedef. For example this type specifier</p>\n\n<pre><code>const ListNodePtr\n</code></pre>\n\n<p>does not mean that data pointed to by a pointer of the type <code>ListNodePtr</code> is a constant data and may not be changed. It means that the pointer itself is constant.</p>\n\n<p>Consider the following demonstrative program</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\ntypedef int * IntPtr;\n\nint main(void) \n{\n    int x = 10;\n    const IntPtr p = &amp;x;\n\n    *p = 20;\n\n    printf( \"x = %d\\n\", x );\n\n    return 0;\n}\n</code></pre>\n\n<p>Its output is</p>\n\n<pre><code>x = 20\n</code></pre>\n\n<p>As for your question</p>\n\n<blockquote>\n  <p>In a linked list delete function, is it necessary to use free to\n  delete a node?</p>\n</blockquote>\n\n<p>then the reference to the deleted node will be lost after exiting the function and if the node will not be deleted there will be a memory leak provided that the node was allocated dynamically.</p>\n"}], "owner": {"reputation": 63, "user_id": 9648749, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-fFSpfKm8Yho/AAAAAAAAAAI/AAAAAAAAGZc/TjWV01v_nSg/photo.jpg?sz=128", "display_name": "Impasse", "link": "https://stackoverflow.com/users/9648749/impasse"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 359, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1568807639, "creation_date": 1568796105, "last_edit_date": 1592644375, "question_id": 57988549, "link": "https://stackoverflow.com/questions/57988549/in-a-linked-list-delete-function-is-it-necessary-to-use-free-to-delete-a-node", "title": "In a linked list delete function, is it necessary to use free to delete a node?", "body": "<p>I saw <a href=\"https://grisha.org/blog/2013/04/02/linus-on-understanding-pointers/\" rel=\"nofollow noreferrer\">this</a> node delete function and compared it to my book's. It's (almost) totally different, I would guess the latter is useful for learning matters...? but then I can't understand why free is even used if all it takes is to move the pointer forward. Maybe I'm missing something.</p>\n<p>For reference, here's my book's delete node function:</p>\n<pre><code>char delete(ListNodePtr *sPtr, char value){\n  if(value == (*sPtr)-&gt;data){\n    ListNodePtr tempPtr = *sPtr; \n    *sPtr = (*sPtr)-&gt;nextPtr; \n    free(tempPtr); \n    return value;\n  }\n  else{\n    ListNodePtr previousPtr = *sPtr;\n    ListNodePtr currentPtr = (*sPtr)-&gt;nextPtr;\n\n  while(currentPtr != NULL &amp;&amp; currentPtr-&gt;data != value){\n    previousPtr = currentPtr; \n    currentPtr = currentPtr-&gt;nextPtr;\n  }\n  \n    if(currentPtr != NULL){\n      ListNodePtr tempPtr = currentPtr;\n      previousPtr-&gt;nextPtr = currentPtr-&gt;nextPtr;\n      free(tempPtr);\n      return value;\n    }\n  }\n\n  return '\\0';\n}\n</code></pre>\n<p>I also tried completely removing both the temp variable and the free call and the function still (apparently) works, as in the print function doesn't print the &quot;deleted&quot; value.</p>\n<p>Been checking out other sources on linked lists and many of those show usage of the free function, odd.</p>\n"}, {"tags": ["c", "pthreads"], "comments": [{"owner": {"reputation": 430, "user_id": 2872579, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/higqD.png?s=128&g=1", "display_name": "Potion", "link": "https://stackoverflow.com/users/2872579/potion"}, "edited": false, "score": 0, "creation_date": 1568795659, "post_id": 57988287, "comment_id": 102384448, "body": "Oh wow I can believe I overlooked this bit. I didnt realize first arg passed would be modified. Adding a new array fixed it. Thank you! (You can add it as an answer so I can accept it)"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1568807980, "post_id": 57988287, "comment_id": 102391413, "body": "Note that the approach presented here is fundamentally different from the one in the question you linked.  The other is about passing an integer by converting <i>the value itself</i> to a pointer and back.  What you&#39;re doing here is passing <i>a pointer to the value</i> (and performing appropriate conversions on the pointer&#39;s type).  Both are valid approaches in a general sense, but using <i>bona fide</i> pointers does mean multiple threads have access to the pointed-to objects."}], "owner": {"reputation": 430, "user_id": 2872579, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/higqD.png?s=128&g=1", "display_name": "Potion", "link": "https://stackoverflow.com/users/2872579/potion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1568795268, "creation_date": 1568795268, "question_id": 57988287, "link": "https://stackoverflow.com/questions/57988287/random-numbers-when-passing-address-of-integers-into-pthread-create", "title": "Random Numbers when Passing Address of Integers into pthread_create", "body": "<p>I found a similar post <a href=\"https://stackoverflow.com/questions/19232957/pthread-create-and-passing-an-integer-as-the-last-argument\">pthread_create and passing an integer as the last argument</a> however when implementing it I still receive the wrong ID values (as shown in the output log at the bottom of the post). </p>\n\n<p>I have this portion of code which creates the threads. Its pretty standard. I have an array of threads which allocate a thread id which is passed into the function.</p>\n\n<pre><code>int nthreads = 7;\npthread_t tid[nthreads];\n\nfprintf(stdout, \"Creating threads.\\n\");\nfor (int i =0; i &lt; nthreads; i++){\n    tid[i] = i;\n    if(pthread_create(&amp;tid[i], NULL, threadRequestFile, &amp;tid[i]) != 0){\n        fprintf(stdout, \"Error pthread_create().\\n\");\n        steque_destroy(workerQueue);\n        free(workerQueue);\n        workerQueue = NULL;\n        exit(EXIT_FAILURE);\n    }\n}\nfprintf(stdout, \"Created %d threads.\\n\", nthreads);\n\nfor(int i = 0; i &lt; nthreads; i++){\n    fprintf(stdout, \"Awaiting Thread %d.\\n\", i);\n    pthread_join(tid[i], NULL);\n}\n</code></pre>\n\n<p>Finally my pointer function with has the ids stored in the address of tid[i] are passed into to print to the console:</p>\n\n<pre><code>void *threadRequestFile(void *nRequests){\n    int totalRequests = * ((int *)nRequests);    \n    fprintf(stdout, \"Total Request: %d\\n\", totalRequests);\n}\n</code></pre>\n\n<p>Unfortunately closely following the code in the post above and from other sources I found online, my console is still printing weird numbers rather than 0-6. Can anyone help me out as to why this is occurring?</p>\n\n<pre><code>Creating threads.\nTotal Request: -1210059008 // Should be 0\nTotal Request: -1218451712 // ..\nTotal Request: -1226844416 // ..\nTotal Request: -1235237120 // ..\nTotal Request: -1243629824 // ..\nTotal Request: -1252022528 // ..\nTotal Request: -1260415232 // 6\nCreated 7 threads.\nAwaiting Thread 0.\nAwaiting Thread 1.\nAwaiting Thread 2.\nAwaiting Thread 3.\nAwaiting Thread 4.\nAwaiting Thread 5.\nAwaiting Thread 6.\n</code></pre>\n"}, {"tags": ["c", "linux"], "answers": [{"tags": [], "owner": {"reputation": 2364, "user_id": 269181, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/968d700efe38dce8e9cce18360980325?s=128&d=identicon&r=PG", "display_name": "PeterM", "link": "https://stackoverflow.com/users/269181/peterm"}, "is_accepted": false, "score": 1, "last_activity_date": 1568962128, "creation_date": 1568962128, "answer_id": 58023132, "question_id": 57987311, "link": "https://stackoverflow.com/questions/57987311/when-monitoring-routing-changes-with-rtnetlink-how-can-you-get-a-new-routes-met/58023132#58023132", "title": "When monitoring routing changes with rtnetlink, how can you get a new routes metric?", "body": "<p>After checking the source code for <code>ip monitor</code> and looking at how Strongswan does it for MOBIKE I discovered that the kernel doesn't use <code>RTA_METRICS</code> to report the metric, it uses <code>RTA_PRIORITY</code>. From the Strongswan mailing list (<a href=\"https://lists.strongswan.org/pipermail/users/2017-September/011501.html\" rel=\"nofollow noreferrer\">https://lists.strongswan.org/pipermail/users/2017-September/011501.html</a>):</p>\n\n<blockquote>\n  <p>If a system uses routing metrics, we should honor them when doing (manual)\n  routing lookups for IKE. When enumerating routes, the kernel reports priorities\n  with the RTA_PRIORITY attribute, not RTA_METRICS. We prefer routes with a\n  lower priority value, and fall back to longest prefix match priorities if\n  the priority value is equal.</p>\n</blockquote>\n\n<p>With regard to how this could be done with the <code>libmnl</code> example, the code snippet looks like this:</p>\n\n<pre><code>        if (tb[RTA_PRIORITY]) {\n            printf(\"metric=%u \", mnl_attr_get_u32(tb[RTA_PRIORITY]));\n    }\n</code></pre>\n"}], "owner": {"reputation": 2364, "user_id": 269181, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/968d700efe38dce8e9cce18360980325?s=128&d=identicon&r=PG", "display_name": "PeterM", "link": "https://stackoverflow.com/users/269181/peterm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 225, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1568962128, "creation_date": 1568791841, "last_edit_date": 1568809891, "question_id": 57987311, "link": "https://stackoverflow.com/questions/57987311/when-monitoring-routing-changes-with-rtnetlink-how-can-you-get-a-new-routes-met", "title": "When monitoring routing changes with rtnetlink, how can you get a new routes metric?", "body": "<p>I've found a couple of examples for listening to <code>RTNETLINK</code> events, both directly from the kernel and using <code>libmnl</code>. The <code>libmnl</code> example does exactly what I want in that it listens for route changes and reports them. The example is complete and can be found here:</p>\n\n<p><a href=\"https://github.com/threatstack/libmnl/blob/master/examples/rtnl/rtnl-route-event.c\" rel=\"nofollow noreferrer\">https://github.com/threatstack/libmnl/blob/master/examples/rtnl/rtnl-route-event.c</a></p>\n\n<p>It seems to have code to support printing out the metric of a route on line 54:</p>\n\n<pre><code>    if (tb[RTA_METRICS]) {\n    int i;\n    struct nlattr *tbx[RTAX_MAX+1] = {};\n\n    mnl_attr_parse_nested(tb[RTA_METRICS], data_attr_cb2, tbx);\n\n    for (i=0; i&lt;RTAX_MAX; i++) {\n        if (tbx[i]) {\n            printf(\"metrics[%d]=%u \",\n                i, mnl_attr_get_u32(tbx[i]));\n        }\n    }\n}\n</code></pre>\n\n<p>However although the example application prints out a lot of information, the metric (even if explicitly set at creation time) isn't shown. If I use <code>ip route replace</code> and change the metric, it will show the same information as previously, but again the metric is missing.</p>\n\n<p>Is it possible to get the route metric in this way?</p>\n\n<p>Is there a better approach to get routing table updates that include the route's metric?</p>\n\n<p><strong>Update</strong></p>\n\n<p><code>ip monitor</code> does show the metric changes so they are seemingly available, just not being returned to the test application (null pointer in <code>tb[RTA_METRICS]</code>.</p>\n"}, {"tags": ["c", "string"], "comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 1, "creation_date": 1568791439, "post_id": 57986800, "comment_id": 102382254, "body": "Notice that it did not happen quite like that, your string was <i>too long</i> for being an array initializer and the compiler output a diagnostics message. It would not have done so for <code>char str[5] = &quot;HELLO&quot;;</code> (but the null terminator would have been missing anyway)."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1568792665, "post_id": 57986800, "comment_id": 102382917, "body": "From <a href=\"https://en.cppreference.com/w/c/language/array_initialization#Initialization_from_strings\" rel=\"nofollow noreferrer\">this initalization from string reference</a>: &quot;If the size of the array is known, it may be one less than the size of the string literal, in which case the terminating null character is ignored&quot; So as mentioned you can have <code>char str[5] = &quot;HELLO&quot;;</code> but any array-size smaller than <code>5</code> will be invalid."}], "answers": [{"tags": [], "owner": {"reputation": 66, "user_id": 7445686, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd84ce5d4d86c94acc68e6e8e9e3e399?s=128&d=identicon&r=PG&f=1", "display_name": "Andoni Alzelai", "link": "https://stackoverflow.com/users/7445686/andoni-alzelai"}, "is_accepted": false, "score": 1, "last_activity_date": 1568790543, "last_edit_date": 1568790543, "creation_date": 1568790229, "answer_id": 57986856, "question_id": 57986800, "link": "https://stackoverflow.com/questions/57986800/character-array-defined-less-than-intialized-string/57986856#57986856", "title": "Character array defined less than intialized string", "body": "<p>You can\u00b4t assign 5 values to a 4 size array, when you put <code>Hello</code> it is interpreted as <code>{'h', 'e', 'l', 'l', 'o'}</code>, so you need at least 5 size array. </p>\n\n<p>Taking into account that C needs also a last character '/0', i recommend you to put it as 6 size array</p>\n"}], "owner": {"reputation": 1, "user_id": 12083413, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCCtzKuGsubIfM_u0-qbSgsO3--44dd7TT698eiMg=k-s128", "display_name": "Himanshu Singh", "link": "https://stackoverflow.com/users/12083413/himanshu-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 1, "closed_date": 1568791244, "answer_count": 1, "score": -1, "last_activity_date": 1568792330, "creation_date": 1568790045, "last_edit_date": 1568790170, "question_id": 57986800, "link": "https://stackoverflow.com/questions/57986800/character-array-defined-less-than-intialized-string", "closed_reason": "Duplicate", "title": "Character array defined less than intialized string", "body": "<pre><code>#include&lt;stdio.h&gt;\nvoid main()\n{\nchar str[4] =\"HELLO\";\nprintf(\"%s\",str);\n}\n</code></pre>\n\n<p>What actually is happening here ??</p>\n\n<p>The output is :\nHELL?</p>\n"}, {"tags": ["c", "linux", "can-bus"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1568789848, "post_id": 57986218, "comment_id": 102381476, "body": "Why the fishy <code>(struct sockaddr*)</code> casts?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "edited": false, "score": 0, "creation_date": 1568793331, "post_id": 57986218, "comment_id": 102383243, "body": "@Bodo Casting between different struct types invokes undefined behavior and may very well be a bug. Are they truly compatible types? If so, why use two different types. It is either code smell or library smell."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1568794131, "post_id": 57986218, "comment_id": 102383638, "body": "Peeked at the Github. <code>struct sockaddr</code> in sys/socket.h is not in the slightest compatible with <code>struct sockaddr_can</code>, so it appears to be a library bug. They are non-compatible types and it is also a strict aliasing violation."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "edited": false, "score": 0, "creation_date": 1568794577, "post_id": 57986218, "comment_id": 102383893, "body": "@Bodo The only thing that matters is if the struct is de-referenced as <code>struct sockaddr</code> anywhere - if so it is a bug. Otherwise it is just muddy API design."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "edited": false, "score": 0, "creation_date": 1568795917, "post_id": 57986218, "comment_id": 102384575, "body": "@Bodo The thing is, they can&#39;t check the initial element unless it is of the same lvalue type as the whole of <code>struct sockaddr_can</code>, which it isn&#39;t. At worst, you get misaligned access. At best, you get an open invitation for gcc optimizer to go bananas."}, {"owner": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1568796477, "post_id": 57986218, "comment_id": 102384919, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/199610/discussion-between-bodo-and-lundin\">continue this discussion in chat</a>."}, {"owner": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1568798878, "post_id": 57986218, "comment_id": 102386355, "body": "@Lundin I remove all my comments which are now in the chat because the discussion about the socket interface design is only remotely related to the question. I suggest you do the same."}], "answers": [{"comments": [{"owner": {"reputation": 195, "user_id": 2436407, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/WBERw.jpg?s=128&g=1", "display_name": "wraithie", "link": "https://stackoverflow.com/users/2436407/wraithie"}, "edited": false, "score": 0, "creation_date": 1586257613, "post_id": 57987376, "comment_id": 108056232, "body": "Is the combination done on the ID and flag an OR <code>|</code> or an XOR <code>^</code>? In the example, there are the flag: <code>0x80000000</code> (<code>10000000000000000000000000000000</code>) , the ID: <code>0x01F0A020</code> (<code>00000001111100001010000000100000</code>) and the result <code>0x81F0A020</code> (<code>10000001111100001010000000100000</code>). The result can be obtained both from OR and XOR."}, {"owner": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "reply_to_user": {"reputation": 195, "user_id": 2436407, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/WBERw.jpg?s=128&g=1", "display_name": "wraithie", "link": "https://stackoverflow.com/users/2436407/wraithie"}, "edited": false, "score": 1, "creation_date": 1586258311, "post_id": 57987376, "comment_id": 108056573, "body": "@wr43th13 Your question is about basic bit operations. If you want to make sure a bit is set, use <code>value | bit</code>, if you want to make sure the bit is not set use <code>value &amp; (~bit)</code>. Use unsignet types of the same width to avoid possibly wrong type conversion. Using XOR means inverting a bit. This works only if you are sure the bit you want to set is not already set. That means if you repeat the operation <code>value |= bit</code> the value will not change, if you repeat <code>value ^= bit</code> you will toggle the bit with every operation."}], "tags": [], "owner": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "is_accepted": true, "score": 4, "last_activity_date": 1568793232, "last_edit_date": 1568793232, "creation_date": 1568792025, "answer_id": 57987376, "question_id": 57986218, "link": "https://stackoverflow.com/questions/57986218/reading-can-bus-in-c-displays-incorrect-can-id-for-29-bit-can-id/57987376#57987376", "title": "Reading can bus in C displays incorrect can ID for 29 bit CAN ID", "body": "<p>The field <code>can_id</code> of <code>struct can_frame</code> contains the CAN ID <strong>and</strong> the EFF/RTR/ERR flags. The extended ID has 29 bits, so there are 3 free bits that are used to represent 3 flags.</p>\n\n<p>Your example ID <code>0x01F0A020</code> must be an extended frame, but ID <code>0x7DF</code> can be sent as a base frame or as an extended frame. These are different messages. To distinguish between a base frame or an extended frame with the same ID you need the EFF flag.</p>\n\n<p>In your example you see the value <code>0x81F0A020</code> which is the combination of ID <code>0x01F0A020</code> and <code>CAN_EFF_FLAG</code> (<code>0x80000000U</code>).</p>\n\n<p><strong>Extract from <a href=\"https://github.com/torvalds/linux/blob/master/include/uapi/linux/can.h\" rel=\"nofollow noreferrer\">https://github.com/torvalds/linux/blob/master/include/uapi/linux/can.h</a></strong></p>\n\n<pre><code>/* special address description flags for the CAN_ID */\n#define CAN_EFF_FLAG 0x80000000U /* EFF/SFF is set in the MSB */\n#define CAN_RTR_FLAG 0x40000000U /* remote transmission request */\n#define CAN_ERR_FLAG 0x20000000U /* error message frame */\n\n/* valid bits in CAN ID for frame formats */\n#define CAN_SFF_MASK 0x000007FFU /* standard frame format (SFF) */\n#define CAN_EFF_MASK 0x1FFFFFFFU /* extended frame format (EFF) */\n#define CAN_ERR_MASK 0x1FFFFFFFU /* omit EFF, RTR, ERR flags */\n</code></pre>\n\n<p>...</p>\n\n<pre><code>/**\n * struct can_frame - basic CAN frame structure\n * @can_id:  CAN ID of the frame and CAN_*_FLAG flags, see canid_t definition\n * @can_dlc: frame payload length in byte (0 .. 8) aka data length code\n *           N.B. the DLC field from ISO 11898-1 Chapter 8.4.2.3 has a 1:1\n *           mapping of the 'data length code' to the real payload length\n * @__pad:   padding\n * @__res0:  reserved / padding\n * @__res1:  reserved / padding\n * @data:    CAN frame payload (up to 8 byte)\n */\nstruct can_frame {\n    canid_t can_id;  /* 32 bit CAN_ID + EFF/RTR/ERR flags */\n    __u8    can_dlc; /* frame payload length in byte (0 .. CAN_MAX_DLEN) */\n    __u8    __pad;   /* padding */\n    __u8    __res0;  /* reserved / padding */\n    __u8    __res1;  /* reserved / padding */\n    __u8    data[CAN_MAX_DLEN] __attribute__((aligned(8)));\n};\n</code></pre>\n\n<p>To get the ID only without flags, you should apply <code>CAN_SFF_MASK</code> or <code>CAN_EFF_MASK</code> depending on the value of the <code>CAN_EFF_FLAG</code> bit.</p>\n\n<p><strong>Example code:</strong></p>\n\n<pre><code>        //Print the received CAN ID \n        printf(\"%X\\n\", \n               (frame.can_id &amp; CAN_EFF_FLAG) ? (frame.can_id &amp; CAN_EFF_MASK)\n                                             : (frame.can_id &amp; CAN_SFF_MASK));\n</code></pre>\n"}], "owner": {"reputation": 179, "user_id": 7790234, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4adbe025213d5f211a6f7fd08da0c96d?s=128&d=identicon&r=PG&f=1", "display_name": "Markus Ippy", "link": "https://stackoverflow.com/users/7790234/markus-ippy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 907, "favorite_count": 0, "accepted_answer_id": 57987376, "answer_count": 1, "score": 1, "last_activity_date": 1568793232, "creation_date": 1568787616, "question_id": 57986218, "link": "https://stackoverflow.com/questions/57986218/reading-can-bus-in-c-displays-incorrect-can-id-for-29-bit-can-id", "title": "Reading can bus in C displays incorrect can ID for 29 bit CAN ID", "body": "<p>I wrote some code in c to read canbus data \nEverything works correctly when i read 11 BIT CAN ID's\nAs soon as i try to read 29 BIT ID's it displays the ID incorrect </p>\n\n<p><strong>Example :</strong><br>\nReceiving Message with 29 BIT id:<br>\n<strong>0x01F0A020</strong><br>\nand print it with<br>\nprintf(\"%X\\n\",frame.can_id);<br>\nit prints<br>\n<strong>81F0A020</strong>  </p>\n\n<p>11 BIT ID Message<br>\n<strong>0x7DF</strong><br>\nand print it with<br>\nprintf(\"%X\\n\",frame.can_id);<br>\nit prints correctly<br>\n<strong>7DF</strong>  </p>\n\n<p>Can someone tell me why this is the case ?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;string.h&gt;\n#include &lt;net/if.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;inttypes.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;sys/ioctl.h&gt;\n#include &lt;netinet/in.h&gt;\n#include &lt;arpa/inet.h&gt;\n#include &lt;linux/can.h&gt;\n#include &lt;linux/can/raw.h&gt;\n\n#define MAX_DATA_LEN 8\n#define MAX_FIELDS 23\n#define MAX_FIELD_LEN 64\n#include &lt;limits.h&gt;\n\n\nchar data_str[MAX_FIELDS][MAX_FIELD_LEN];\nint i;\n\n\nint\nmain(void)\n{\n    int s;\n    int nbytes;\n    struct sockaddr_can addr;\n    struct can_frame frame;\n    unsigned short data[MAX_FIELDS];\n    int sockfd=0;\n    int bcast=1;\n    struct sockaddr_in src_addr;\n    struct sockaddr_in dst_addr;\n    int numbytes;\n\n    int fa;\n    struct ifreq ifr;\n\n    fa = socket(AF_INET, SOCK_DGRAM, 0);\n\n    ifr.ifr_addr.sa_family = AF_INET;\n    strncpy(ifr.ifr_name, \"eth0\", IFNAMSIZ-1);\n\n    ioctl(fa, SIOCGIFHWADDR, &amp;ifr);\n    close(fa);\n\n\n\n    //\n    if((sockfd = socket(PF_INET,SOCK_DGRAM,0)) == -1)\n    {\n        perror(\"Udp sockfd create failed\");\n        exit(1);\n    }\n    //Enabled broadcast mode for udp\n    if((setsockopt(sockfd,SOL_SOCKET,SO_BROADCAST,\n                &amp;bcast,sizeof bcast)) == -1)\n    {\n        perror(\"setsockopt failed for broadcast mode \");\n        exit(1);\n    }\n    src_addr.sin_family = AF_INET;\n    src_addr.sin_port = htons(8888);\n    src_addr.sin_addr.s_addr = INADDR_ANY;\n    memset(src_addr.sin_zero,'\\0',sizeof src_addr.sin_zero);\n\n    if(bind(sockfd, (struct sockaddr*) &amp;src_addr, sizeof src_addr) == -1)\n    {\n        perror(\"bind\");\n        exit(1);\n    }\n\n    dst_addr.sin_family = AF_INET;\n    dst_addr.sin_port = htons(45454);\n    dst_addr.sin_addr.s_addr = inet_addr(\"127.0.0.1\");\n    memset(dst_addr.sin_zero,'\\0',sizeof dst_addr.sin_zero);\n\n    if((s = socket(PF_CAN, SOCK_RAW, CAN_RAW)) &lt; 0) {\n        perror(\"Error while opening socket\");\n        return -1;\n    }\n\n    addr.can_family  = AF_CAN;\n    addr.can_ifindex = 0;\n\n    if(bind(s, (struct sockaddr *)&amp;addr, sizeof(addr)) &lt; 0) {\n        perror(\"Error in socket bind\");\n        return -2;\n    }\n\n    //struct can_frame frame;\n    while(1)\n    {\n        nbytes = read(s, &amp;frame, sizeof(struct can_frame));\n\n        if (nbytes &lt; 0) {\n                perror(\"can raw socket read\");\n                return 1;\n        }\n\n        /* paranoid check ... */\n        if (nbytes &lt; sizeof(struct can_frame)) {\n                fprintf(stderr, \"read: incomplete CAN frame\\n\");\n                return 1;\n        }   \n\n        //Print the received CAN ID \n        printf(\"%X\\n\",frame.can_id);\n\n\n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "visual-studio-2017"], "comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1568788486, "post_id": 57985910, "comment_id": 102380877, "body": "<code>printf(&quot;%d\\n&quot;, 4294967296);</code> invokes <i>undefined behavior</i> <a href=\"http://port70.net/~nsz/c/c11/n1570.html#7.21.6.1p9\" rel=\"nofollow noreferrer\">C11-Standard 7.21.6.1 The fprintf function(p9)</a>."}, {"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1568792579, "post_id": 57985910, "comment_id": 102382866, "body": "The %d and %u formatting arguments expect a 32-bit argument to be passed to printf().  But the code actually passes 64-bit arguments, 0x0000000100000000 in hex.  So the %d makes it read the lower 32-bits of that value, which is 0.  The next %u makes it read the upper 32-bits of that value, which is 1.  Little-endian machine btw.  Doesn&#39;t happen in the second statement since 4294967295 + 1 produces a 32-bit value.  If your compiler doesn&#39;t warn about this then be sure to either update it or crank up the warning level."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1568793113, "post_id": 57985910, "comment_id": 102383144, "body": "@HansPassant &quot;4294967295 + 1 produces a 32-bit value&quot; --&gt; depends on C89 vs C99.  With modern C, 4294967295 is also a <code>long long</code> and <code>4294967295 + 1</code> is a 64-bit value."}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1568792824, "post_id": 57985942, "comment_id": 102382991, "body": "&quot;The value 4294967295 does fit in an unsigned int&quot; is true, yet <code>4294967295</code> is still a <code>long long</code> <i>decimal constant</i> since C99.  &quot;add 1 making it overflow&quot; --&gt; No. that sum is <code>long long</code> 4294967296. Your answer makes sense for C89 where <code>4294967295</code> is an <code>unsigned long</code> (and adding 1 is well defined)."}], "tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": false, "score": 5, "last_activity_date": 1568786286, "creation_date": 1568786286, "answer_id": 57985942, "question_id": 57985910, "link": "https://stackoverflow.com/questions/57985910/printfd-n-4294967296-makes-some-strange-errors/57985942#57985942", "title": "printf(&quot;%d\\n&quot;, 4294967296); makes some strange errors", "body": "<p>If supported then the value <code>4294967296</code> is a <code>long long</code>, because it doesn't fit in an <code>unsigned int</code>.</p>\n\n<p>The format <code>\"%d\"</code> is for <code>int</code> (a <em>signed</em> <code>int</code>).</p>\n\n<p>Mismatching value type and format specifier leads to <em>undefined behavior</em>.</p>\n\n<p>The value <code>4294967295</code> <em>does</em> fit in an <code>unsigned int</code> but then you add <code>1</code> making it overflow.</p>\n\n<p>The range of a 32-bit unsigned integer is <code>0</code> to <code>2\u00b3\u00b2-1</code> (inclusive).</p>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1568793332, "post_id": 57986140, "comment_id": 102383247, "body": "There is no signed integer overflow here."}], "tags": [], "owner": {"reputation": 11397, "user_id": 1141537, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0f0c5bf8653be794a11259ea2ffd359f?s=128&d=identicon&r=PG", "display_name": "Imran Rana", "link": "https://stackoverflow.com/users/1141537/imran-rana"}, "is_accepted": false, "score": 1, "last_activity_date": 1568787248, "creation_date": 1568787248, "answer_id": 57986140, "question_id": 57985910, "link": "https://stackoverflow.com/questions/57985910/printfd-n-4294967296-makes-some-strange-errors/57986140#57986140", "title": "printf(&quot;%d\\n&quot;, 4294967296); makes some strange errors", "body": "<p>Unsigned integer never overflow:</p>\n\n<blockquote>\n  <p>(C99, 6.2.5p9) \"A computation involving unsigned operands can never\n  overflow, because a result that cannot be represented by the resulting\n  unsigned integer type is reduced modulo the number that is one greater\n  than the largest value that can be represented by the resulting type.\"</p>\n</blockquote>\n\n<p>But in C, integer overflows are undefined behavior:</p>\n\n<blockquote>\n  <p>(C99, 6.5.5p5) \"If an exceptional condition occurs during the\n  evaluation of an expression (that is, if the result is not\n  mathematically defined or not in the range of representable values for\n  its type), the behavior is undefined.\"</p>\n  \n  <p>(C99, 3.4.3p3) \"EXAMPLE An example of undefined behavior is the\n  behavior on integer overflow.\"</p>\n</blockquote>\n\n<p>I'm quoting these from an <a href=\"https://stackoverflow.com/questions/9052088/why-int-i-400400-400-gives-result-72-is-datatype-circular\">answer</a> to a question that I asked previously.</p>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 1, "last_activity_date": 1568798574, "last_edit_date": 1568798574, "creation_date": 1568793925, "answer_id": 57987900, "question_id": 57985910, "link": "https://stackoverflow.com/questions/57985910/printfd-n-4294967296-makes-some-strange-errors/57987900#57987900", "title": "printf(&quot;%d\\n&quot;, 4294967296); makes some strange errors", "body": "<blockquote>\n  <p>printf(\u201c%d\\n\u201d, 4294967296); makes some strange errors</p>\n</blockquote>\n\n<p>Yes it does - a most interesting question.</p>\n\n<hr>\n\n<p>This comes down to what is the <em>type</em> of 4294967295 and 4294967296?</p>\n\n<p>Is the type determined by fitting in:<br>\n    <code>int, long, unsigned long</code> (C89)<br>\n    <code>int, long, long long</code> (C99)<br>\n    <code>int, long, unsigned long, long long, unsigned long long</code> (Perhaps VS2017)  </p>\n\n<p>Note: <code>4294967295 + 1</code> is not signed integer overflow in any case.</p>\n\n<hr>\n\n<p>This is one of the places where C89, C99 (or later) differ and where VS2017 does its own thing.</p>\n\n<hr>\n\n<p><strong>With compliant C89</strong>, (32-bit world)  4294967295 is a <code>unsigned long</code> <em>decimal constant</em> and adding 1 is <code>unsigned long</code> 0.  (C89 6.1.3.2)</p>\n\n<p>As <code>...</code> arguments, an <code>int 0</code> and <code>unsigned 0</code> both work for <code>\"%u\"</code> and <code>\"%d\"</code> and the value of 0 is in range for both.  Yet this is an <code>unsigned long 0</code> and so technical undefined behavior (UB).  On 32-bit systems, this UB is often benign and results in the same as printing a <code>unsigned 0</code>.</p>\n\n<p>4294967296 is simply an out of range constant.</p>\n\n<hr>\n\n<p><strong>With C99</strong> (or later - certainly not OP's case), 4294967295 is a <code>long long</code> <em>decimal constant</em><sup>1</sup> and adding 1 is simply <code>long long</code> 4294967296.  4294967296 is another <code>long long</code> <em>decimal constant</em></p>\n\n<p>Passing a <code>long long</code> to match a <code>\"%d\"</code> or <code>\"%u\"</code> is <em>undefined behavior</em>. The same output of \"0, 1, 0\" in <strong>both</strong> cases would be an \"expected\" UB.</p>\n\n<hr>\n\n<p>Yet OP is using <strong>VS2017</strong> and 4294967295 is a <code>unsigned long</code> <em>decimal constant</em> (per C89 rules) and <a href=\"https://docs.microsoft.com/en-us/cpp/c-language/integer-types?view=vs-2019\" rel=\"nofollow noreferrer\">int, long int, or unsigned long int</a> and adding 1 is <code>unsigned long</code> 0. Printing that with <code>%u,%d</code> is technically UB, but with 32-bit <code>unsigned</code> having the same characteristic as 32-bit <code>unsigned long</code> the 0,0,0 output is reasonable. </p>\n\n<p>4294967296 is apparently some 64-bit type (such as <code>long long</code>)<sup>2</sup>  and per C99 rules is UB.  Output of 0, 1, 0 is reasonable, yet not resilient.</p>\n\n<p>OP's result may differ depending on <a href=\"https://docs.microsoft.com/en-us/cpp/build/reference/za-ze-disable-language-extensions?view=vs-2019\" rel=\"nofollow noreferrer\">/Za, /Ze (Disable Language Extensions)</a>.</p>\n\n<hr>\n\n<p><sup>1</sup> or a 64-bit <code>long</code>.</p>\n\n<p><sup>2</sup> I was unable to find a definitive on-line VS2017 ref for the type of a <strong>C</strong> decimal constant, (not C++) for values more than  4294967295.</p>\n"}], "owner": {"reputation": 21, "user_id": 12083066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/681ec04823172082967c643a58685ae2?s=128&d=identicon&r=PG&f=1", "display_name": "Jackson", "link": "https://stackoverflow.com/users/12083066/jackson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 175, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1568798574, "creation_date": 1568786071, "last_edit_date": 1568791571, "question_id": 57985910, "link": "https://stackoverflow.com/questions/57985910/printfd-n-4294967296-makes-some-strange-errors", "title": "printf(&quot;%d\\n&quot;, 4294967296); makes some strange errors", "body": "<p>(4294967296=2^32)</p>\n\n<p>I want to print <code>4294967296</code> using printf(\"%u, %d\") and want to see what will happen but i get some strange result.</p>\n\n<p>The code is as following:</p>\n\n<pre><code>printf(\"%d\\n\", 4294967296);\n\nprintf(\"d = %u = %d = 0x%x  \\n\", 4294967296, 4294967296, 4294967296);//this is strange\n\nprintf(\"d = %u = %d = 0x%x  \\n\", 4294967295 + 1, 4294967295 + 1, 4294967295 + 1);\n</code></pre>\n\n<p>and my result is </p>\n\n<pre><code>0\n\nd = 0 = 1 = 0x0\n\nd = 0 = 0 = 0x0\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/XPKEA.png\" rel=\"nofollow noreferrer\">the picture of result</a></p>\n\n<p>you can see the binary expression of 4294967296 is 0x0 in the second line, but when i print 4294967296 use \"%d\", it will show 1, which i am confused with. I expect the output of 1 to be 0.</p>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 5, "creation_date": 1568785624, "post_id": 57985807, "comment_id": 102379834, "body": "How do you initialize the arrays you use? Please try to create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> to show us. And please learn how to use a debugger to step through your code statement by statement while monitoring variables and their values."}, {"owner": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "edited": false, "score": 0, "creation_date": 1568786109, "post_id": 57985807, "comment_id": 102379982, "body": "Do you have a limit on the maximum size of the integer that can be entered? What is this limit if any?"}, {"owner": {"reputation": 165, "user_id": 11661915, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-mNm4t10kwmM/AAAAAAAAAAI/AAAAAAAAAN8/hbNESEzPzeg/photo.jpg?sz=128", "display_name": "Aru Viser", "link": "https://stackoverflow.com/users/11661915/aru-viser"}, "edited": false, "score": 0, "creation_date": 1568786133, "post_id": 57985807, "comment_id": 102379991, "body": "i have done some edits. hope this much is sufficient."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1568786192, "post_id": 57985807, "comment_id": 102380013, "body": "Please read the <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> link. What you show is more of a code puzzle."}, {"owner": {"reputation": 386, "user_id": 4444948, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-1xTM1ROEF10/AAAAAAAAAAI/AAAAAAAAGFQ/ak-2m7ixlfs/photo.jpg?sz=128", "display_name": "Apurva Singh", "link": "https://stackoverflow.com/users/4444948/apurva-singh"}, "edited": false, "score": 0, "creation_date": 1568786265, "post_id": 57985807, "comment_id": 102380038, "body": "The codes you have written are not clear. If you could add comments to it, it would be more readable. Also the are the elements in the array in a particular range? if yes then you can do the task in just two arrays. One array would be the unique array and the other would be Frequency Array. If the frequency is 1 then it is a unique element."}, {"owner": {"reputation": 386, "user_id": 4444948, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-1xTM1ROEF10/AAAAAAAAAAI/AAAAAAAAGFQ/ak-2m7ixlfs/photo.jpg?sz=128", "display_name": "Apurva Singh", "link": "https://stackoverflow.com/users/4444948/apurva-singh"}, "edited": false, "score": 0, "creation_date": 1568786576, "post_id": 57985807, "comment_id": 102380156, "body": "The variable p is not defined in the line  UniqueArray[p]=UserArray[i]; Also the nested for loop should be i from 0 to n and j from i+1 to n."}, {"owner": {"reputation": 165, "user_id": 11661915, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-mNm4t10kwmM/AAAAAAAAAAI/AAAAAAAAAN8/hbNESEzPzeg/photo.jpg?sz=128", "display_name": "Aru Viser", "link": "https://stackoverflow.com/users/11661915/aru-viser"}, "edited": false, "score": 0, "creation_date": 1568786730, "post_id": 57985807, "comment_id": 102380210, "body": "i am done with the edit."}, {"owner": {"reputation": 165, "user_id": 11661915, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-mNm4t10kwmM/AAAAAAAAAAI/AAAAAAAAAN8/hbNESEzPzeg/photo.jpg?sz=128", "display_name": "Aru Viser", "link": "https://stackoverflow.com/users/11661915/aru-viser"}, "edited": false, "score": 0, "creation_date": 1568786790, "post_id": 57985807, "comment_id": 102380241, "body": "i think this much should be good enough to understand"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1568786920, "post_id": 57985807, "comment_id": 102380289, "body": "The only array that I can see being fully initialized is <code>UserArray</code>. The other arrays may contain uninitialized elements. Please initialize them at definition (like e.g. <code>int UniqueArray[ArraySize] = { 0 };</code>)"}], "answers": [{"tags": [], "owner": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "is_accepted": false, "score": 3, "last_activity_date": 1568786661, "creation_date": 1568786661, "answer_id": 57986009, "question_id": 57985807, "link": "https://stackoverflow.com/questions/57985807/why-is-the-frequency-array-saving-garbage-values/57986009#57986009", "title": "Why is the Frequency Array saving garbage values?", "body": "<p>I am not sure that the algorithm that you have will work to get the UniqueArrays. Here I have suggested an alternative algorithm.</p>\n\n<p>The code below is based on the assumption that the input numbers are within a range of <code>0 &lt;= UserArray[i] &lt;= MAXINT</code>. Also <code>MAXINT</code> should not be very large or too much memory is required. </p>\n\n<pre><code>#define MAXINT  100           // The maximum unsigned integer that is supported.  \nint FrequencyArray[MAXINT+1]; \n\nint main(void)\n{\n    int ArraySize;\n    scanf(\"%d\",&amp;ArraySize);\n    int UserArray[ArraySize];\n    int UniqueArray[ArraySize];\n    for(int i=0;i&lt;ArraySize;i++)\n    {\n         scanf(\"%d\",&amp;UserArray[i]);\n    }\n\n    for(int i=0;i&lt;ArraySize;i++) {\n        FrequencyArray[UserArray[i]]++;\n    }\n\n    int k=0;\n    for (int i=0; i&lt;=MAXINT; i++)\n    {\n        if (FrequencyArray[i]!=0)\n        {\n            UniqueArray[k++] = i;\n        }\n    }\n    int UniqueArraySize = k;    // for further use or printing.\n}\n</code></pre>\n\n<p>If you require to support negative elements, then a shift of the <code>FrequencyArray</code> is required.</p>\n\n<p>If <code>MAXINT</code> grows very large then this algorithm is not suitable and other hashing algorithms are suggested.</p>\n"}, {"comments": [{"owner": {"reputation": 165, "user_id": 11661915, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-mNm4t10kwmM/AAAAAAAAAAI/AAAAAAAAAN8/hbNESEzPzeg/photo.jpg?sz=128", "display_name": "Aru Viser", "link": "https://stackoverflow.com/users/11661915/aru-viser"}, "edited": false, "score": 0, "creation_date": 1568792215, "post_id": 57986500, "comment_id": 102382661, "body": "I know how to do it using two for loops..I am looking for a solution to do it with one loop and multiple if statements"}, {"owner": {"reputation": 165, "user_id": 11661915, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-mNm4t10kwmM/AAAAAAAAAAI/AAAAAAAAAN8/hbNESEzPzeg/photo.jpg?sz=128", "display_name": "Aru Viser", "link": "https://stackoverflow.com/users/11661915/aru-viser"}, "edited": false, "score": 0, "creation_date": 1568792279, "post_id": 57986500, "comment_id": 102382698, "body": "I gave the code snippet of how to do this using two for loops at the end of the question"}], "tags": [], "owner": {"reputation": 33821, "user_id": 45685, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/y4RJr.jpg?s=128&g=1", "display_name": "AndersK", "link": "https://stackoverflow.com/users/45685/andersk"}, "is_accepted": false, "score": 2, "last_activity_date": 1568789109, "last_edit_date": 1568789109, "creation_date": 1568788751, "answer_id": 57986500, "question_id": 57985807, "link": "https://stackoverflow.com/questions/57985807/why-is-the-frequency-array-saving-garbage-values/57986500#57986500", "title": "Why is the Frequency Array saving garbage values?", "body": "<p>When you create <code>UniqueArray</code> you get <code>SizeOfUniqueArray</code> unique integers</p>\n\n<pre><code> UniqueArray[] == { 1,2,3,4,5,6,7,8 }\n</code></pre>\n\n<p>When you want to count the frequency of each unique number you start by going through <code>UserArray</code> from 0 to <code>ArraySize</code> and look in <code>UniqueArray</code> but it should be the other way around.</p>\n\n<p>Instead you should go through your <code>UniqueArray</code> from 0 to <code>SizeOfUniqueArray</code> and check how many times each number occurs in <code>UserArray</code>:</p>\n\n<pre><code>for (k = 0; k &lt; SizeOfUniqueArray; ++k)\n{\n  int count = 0;\n  for (j = 0; j &lt; ArraySize; ++j)\n  {\n    if ( UniqueArray[k] == UserArray[j] ) ++count;\n</code></pre>\n\n<p>A final note, initialize all your arrays and variables before using them, it is good practice in C.</p>\n\n<p>As an alternative approach to keep things together you could instead of having to unrelated arrays FrequencyArray and UniqueArray have an array of structs which contain the number number and number of times it occurs, this you could then fill in already when you go through the numbers the first time.</p>\n\n<pre><code>typedef struct\n{\n  int value;\n  int freq;\n}\nUniqueValues;\n\nUniqueValues UniqueArray[ArraySize] = { {0,0} };\n</code></pre>\n"}], "owner": {"reputation": 165, "user_id": 11661915, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-mNm4t10kwmM/AAAAAAAAAAI/AAAAAAAAAN8/hbNESEzPzeg/photo.jpg?sz=128", "display_name": "Aru Viser", "link": "https://stackoverflow.com/users/11661915/aru-viser"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1568789109, "creation_date": 1568785418, "last_edit_date": 1568787611, "question_id": 57985807, "link": "https://stackoverflow.com/questions/57985807/why-is-the-frequency-array-saving-garbage-values", "title": "Why is the Frequency Array saving garbage values?", "body": "<p>So There are Three Arrays:- UserArray, UniqueArray and FrequencyArray.\nArraySize is the size of UserArray.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\nint main()\n{\n      int ArraySize;\n      scanf(\"%d\",&amp;ArraySize);\n      int UserArray[ArraySize],UniqueArray[ArraySize],FrequencyArray[ArraySize];\n      for(int i=0;i&lt;ArraySize;i++)\n      {\n           scanf(\"%d\",&amp;UserArray[i]);\n      }\n      int SizeOfUniqueArray=0;\n      for(int i=0;i&lt;ArraySize;i++)\n      {\n              int j;\n              for(j=0;j&lt;i;j++)\n              {\n                      if(UserArray[i]==UserArray[j])\n                      {\n                              break;\n                      }\n              }\n              if(j==i)\n              {\n                      UniqueArray[SizeOfUniqueArray]=UserArray[i];\n                      SizeOfUniqueArray++;\n              }\n      }\n      int count=0,k=0; \n      for(int i=0;i&lt;ArraySize;i++) {\n             if(UserArray[i]==UniqueArray[k])\n             {\n                     count++;\n                     if(i == ArraySize-1)\n                     {\n                            FrequencyArray[k]=count;\n                            count=0;\n                            k++;\n                            if(k &lt;= ArraySize)\n                            {\n                                   i=0;\n                            }\n                     }\n              }\n       }\n}\n</code></pre>\n\n<p>UserArray is a user defined array which stores integers say 1,2,3,4,8,4,3,1,5,6,7,1,2,6,2.\nSo ArraySize = 15.\nUniqueArray contains the unique numbers of UserArray meaning:- 1,2,3,4,5,6,7,8.\nnow the below given code is the code to save the frequency of the unique numbers in UserArray.\nlike the first element of UniqueArray is 1. 1 is repeated 3 times in the UserArray so the first element of FrequencyArray is 3. But this code is saving garbage values in the FrequencyArray.\nI want to know why?\nwhy is the above program saving garbage values?</p>\n\n<p>We can save The values in FrequencyArray through this code:-</p>\n\n<pre><code>for(int i=0;i&lt;SizeOfUniqueArray;i++)\n{\n        int count=0;\n        for(int j=0;j&lt;ArraySize;j++)\n        {\n                if(UserArray[j]==UniqueArray[i])\n                {\n                        count++;\n                }\n        }\n        FrequencyArray[i]=count;\n}\n</code></pre>\n"}, {"tags": ["c", "linux-kernel"], "comments": [{"owner": {"reputation": 4593, "user_id": 105104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02b23920ac852e946b333d3f9d0d95c1?s=128&d=identicon&r=PG", "display_name": "dvhh", "link": "https://stackoverflow.com/users/105104/dvhh"}, "edited": false, "score": 0, "creation_date": 1568788192, "post_id": 57985730, "comment_id": 102380759, "body": "One way to do it would be to debug via serial console or JTAG, or the other hand is there a function name you recognize on the stack trace ?"}, {"owner": {"reputation": 1, "user_id": 11297246, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rSQHme15dzE/AAAAAAAAAAI/AAAAAAAALFw/tdMvk36t7JQ/photo.jpg?sz=128", "display_name": "naidu nama", "link": "https://stackoverflow.com/users/11297246/naidu-nama"}, "reply_to_user": {"reputation": 4593, "user_id": 105104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02b23920ac852e946b333d3f9d0d95c1?s=128&d=identicon&r=PG", "display_name": "dvhh", "link": "https://stackoverflow.com/users/105104/dvhh"}, "edited": false, "score": 0, "creation_date": 1568802598, "post_id": 57985730, "comment_id": 102388471, "body": "from stack trace i&#39;m getting only stack and call trace addresses.how to identify the crash using those address.@dvhh"}, {"owner": {"reputation": 4593, "user_id": 105104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02b23920ac852e946b333d3f9d0d95c1?s=128&d=identicon&r=PG", "display_name": "dvhh", "link": "https://stackoverflow.com/users/105104/dvhh"}, "edited": false, "score": 0, "creation_date": 1568854413, "post_id": 57985730, "comment_id": 102410222, "body": "Using <a href=\"https://linux.die.net/man/1/addr2line\" rel=\"nofollow noreferrer\">addr2line</a> could help, see this <a href=\"https://elinux.org/Addr2line_for_kernel_debugging\" rel=\"nofollow noreferrer\">explanation</a>"}], "owner": {"reputation": 1, "user_id": 11297246, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rSQHme15dzE/AAAAAAAAAAI/AAAAAAAALFw/tdMvk36t7JQ/photo.jpg?sz=128", "display_name": "naidu nama", "link": "https://stackoverflow.com/users/11297246/naidu-nama"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1568785762, "creation_date": 1568785018, "last_edit_date": 1568785762, "question_id": 57985730, "link": "https://stackoverflow.com/questions/57985730/how-to-debug-the-kernelcrash-on-pi-at-bootup-process", "title": "how to debug the kernelcrash on pi at bootup process", "body": "<p>I have build a kernel image using toolchain and flashed on Pi2 board and it's working fine.when i tried with my own module with kernel crash(null pointer derefference)statically and build the image and flashed on pi2 board.At the bootup time I'm getting kernel panic.I want to know how to find the the location of my crash using those kerenl panic message.</p>\n\n<p><a href=\"https://i.stack.imgur.com/vuOse.jpg\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n"}, {"tags": ["c", "loops", "while-loop", "menu", "switch-statement"], "comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 2, "creation_date": 1568783925, "post_id": 57985506, "comment_id": 102379320, "body": "Don&#39;t put code in headers."}], "answers": [{"comments": [{"owner": {"reputation": 265, "user_id": 4576192, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FQgHX.jpg?s=128&g=1", "display_name": "vx3r", "link": "https://stackoverflow.com/users/4576192/vx3r"}, "edited": false, "score": 0, "creation_date": 1568785510, "post_id": 57985557, "comment_id": 102379797, "body": "I would suggest using <code>scanf(&quot;%c&quot;, &amp;selection);</code> instead of  <code>getchar</code>"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "reply_to_user": {"reputation": 265, "user_id": 4576192, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FQgHX.jpg?s=128&g=1", "display_name": "vx3r", "link": "https://stackoverflow.com/users/4576192/vx3r"}, "edited": false, "score": 0, "creation_date": 1568785592, "post_id": 57985557, "comment_id": 102379823, "body": "@vx3r OK, make an answer to elaborate the advantages."}, {"owner": {"reputation": 23, "user_id": 7638459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/009d391698f5b9e9b69c2ae679994fe9?s=128&d=identicon&r=PG&f=1", "display_name": "maiah", "link": "https://stackoverflow.com/users/7638459/maiah"}, "edited": false, "score": 0, "creation_date": 1568849637, "post_id": 57985557, "comment_id": 102409405, "body": "@Yunnosch thank you so much for your explanations! I went through and made the changes. It is working now the way I need it too and I moved my print function into the c file!"}], "tags": [], "owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "is_accepted": true, "score": 2, "last_activity_date": 1568785347, "last_edit_date": 1568785347, "creation_date": 1568784026, "answer_id": 57985557, "question_id": 57985506, "link": "https://stackoverflow.com/questions/57985506/c-menu-program-using-while-and-switch-case-returns-duplicate-menu-with-invalid/57985557#57985557", "title": "C - menu program using while and switch/case returns duplicate menu with invalid selection", "body": "<p>You need to keep what your printing function returns.</p>\n\n<pre><code>      default:\n        printf (\"Invalid Selection\");\n        selection = print_menu();\n        break;\n</code></pre>\n\n<p>The second problem is that your getchar() call will also take the return after your selection. Add another <code>getchar()</code> to consume it.</p>\n\n<pre><code>int selection = getchar();\n(void) getchar(); /* ignore enter key */\nreturn selection;\n</code></pre>\n\n<p>On a side note, do not put code into headers, only declarations.<br>\nOtherwise the code will be compiled in each code file (of several) which includes the header and get you multiple definition errors. This is not apparant if you have only one code file including the header, but you should get into the right habit early.</p>\n\n<p>Finally you need to always read in again, not only in case of 5.</p>\n\n<pre><code>      default:\n        printf (\"Invalid Selection\");\n        break;\n    };\n    selection = print_menu();\n}; /* end of while */\n</code></pre>\n\n<p>I.e. do it within the loop but outside the case statement(s), because the default branch is only taken if none of the other was executed.</p>\n"}, {"comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 4, "creation_date": 1568785776, "post_id": 57985827, "comment_id": 102379878, "body": "That helps with most of the problems. But please write an explanation of your code to help fighting the misconception that StackOverflow is a free code writing service, which is otherwise spread by code only answer like this. Also &quot;Try...&quot; is giving the impression of &quot;I am not sure whether this helps.&quot;. I recommend trying for more assertive answers."}], "tags": [], "owner": {"reputation": 1, "user_id": 9869800, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-jb80bhLglD8/AAAAAAAAAAI/AAAAAAAAAD8/UafdOMAQ4aw/photo.jpg?sz=128", "display_name": "user9869800", "link": "https://stackoverflow.com/users/9869800/user9869800"}, "is_accepted": false, "score": 0, "last_activity_date": 1568785571, "creation_date": 1568785571, "answer_id": 57985827, "question_id": 57985506, "link": "https://stackoverflow.com/questions/57985506/c-menu-program-using-while-and-switch-case-returns-duplicate-menu-with-invalid/57985827#57985827", "title": "C - menu program using while and switch/case returns duplicate menu with invalid selection", "body": "<p>try</p>\n\n<pre><code>  while(1)\n  {\n\n      int selection = print_menu();\n      switch (selection)\n      ....\n  }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1568874798, "post_id": 57986016, "comment_id": 102414837, "body": "&quot;getchar() has the side effect of removing the next character from the input buffer&quot; Yes, same for scanf. &quot;scanf() is told to read one and only one character (%c) this has the effect of ignoring everything else on that input line&quot; yes, getchar also ignores everything beyond the single letter."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1568875214, "post_id": 57986016, "comment_id": 102415016, "body": "Did you test this program? I did. It never loops, whatever you enter. If you remove the several <code>exit(selection)</code> it does loop but always (except 5) output &quot;Invalid Selection.&quot; (I guess with a short flash of the desired output for the very first selection&lt;5 entered. ) The root cause might be found in <a href=\"http://sekrit.de/webdocs/c/beginners-guide-away-from-scanf.html\" rel=\"nofollow noreferrer\">sekrit.de/webdocs/c/beginners-guide-away-from-scanf.html</a>"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1568875750, "post_id": 57986016, "comment_id": 102415270, "body": "If you additionally remove the <code>system()</code> call you can see the desired output for e.g. 1, followed immediatly by the menu and &quot;Invalid Selection&quot;. See the article I linked for the explanation, in short, <code>scanf()</code> does ignore the rest of the line, as you correctly stated, it does however also not consume it - exactly like getch()."}], "tags": [], "owner": {"reputation": 265, "user_id": 4576192, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FQgHX.jpg?s=128&g=1", "display_name": "vx3r", "link": "https://stackoverflow.com/users/4576192/vx3r"}, "is_accepted": false, "score": 0, "last_activity_date": 1568786697, "creation_date": 1568786697, "answer_id": 57986016, "question_id": 57985506, "link": "https://stackoverflow.com/questions/57985506/c-menu-program-using-while-and-switch-case-returns-duplicate-menu-with-invalid/57986016#57986016", "title": "C - menu program using while and switch/case returns duplicate menu with invalid selection", "body": "<p><code>getchar()</code> has the side effect of removing the next character from the input buffer. </p>\n\n<p>Since the <code>scanf()</code> is told to read one and only one character <code>(%c)</code> this has the effect of ignoring everything else on that input line.</p>\n\n<p>Also clear the console before reprinting the menu.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n\n   int print_menu()\n   {\n    char selection;\n\n    printf(\"MENU\\n\");\n    printf(\"1. Total of All Top Scores for the Week\\n\");\n    printf(\"2. Total of All High Scores for the Week\\n\");\n    printf(\"3. Total Machine High Scores for the Week\\n\");\n    printf(\"4. Machine High Score for the Week\\n\");\n    printf(\"5. EXIT\\n\");\n    printf(\"Enter Selection:\");\n\n    scanf(\"%c\", &amp;selection);\n\n    return selection;\n   }\n\n   int main(int argc, char *argv[])\n   {\n    int selection;\n\n    while(1) {\n      selection = print_menu();\n\n      switch (selection)\n      {\n        case '1':\n          printf(\"\\nselected 1\\n\");\n          exit(selection);\n          break;\n        case '2':\n          printf(\"\\nselected 2\\n\");\n          exit(selection);\n          break;\n        case '3':\n          printf(\"\\nselected 3\\n\");\n          exit(selection);\n          break;\n        case '4':\n          printf(\"\\nselected 4\\n\");\n          exit(selection);\n          break;\n        case '5':\n          printf (\"\\nExit\\n\");\n          exit(0);\n          break;\n        default:\n          system(\"@cls||clear\");\n          printf(\"\\nInvalid Selection\\n\");\n          break;\n      };\n    };\n   }\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 7638459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/009d391698f5b9e9b69c2ae679994fe9?s=128&d=identicon&r=PG&f=1", "display_name": "maiah", "link": "https://stackoverflow.com/users/7638459/maiah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 532, "favorite_count": 0, "accepted_answer_id": 57985557, "answer_count": 3, "score": 1, "last_activity_date": 1568786697, "creation_date": 1568783739, "question_id": 57985506, "link": "https://stackoverflow.com/questions/57985506/c-menu-program-using-while-and-switch-case-returns-duplicate-menu-with-invalid", "title": "C - menu program using while and switch/case returns duplicate menu with invalid selection", "body": "<p>Header file:</p>\n\n<pre><code>    #include &lt;stdio.h&gt;\n    #include &lt;stdlib.h&gt;\n\n    int print_menu(){\n      printf (\"MENU\\n\");\n      printf (\"1. Total of All Top Scores for the Week\\n\");\n      printf (\"2. Total of All High Scores for the Week\\n\");\n      printf (\"3. Total Machine High Scores for the Week\\n\");\n      printf (\"4. Machine High Score for the Week\\n\");\n      printf (\"5. EXIT\\n\");\n      printf (\"Enter Selection:\");\n\n      int selection = getchar();\n      return selection;\n    }\n</code></pre>\n\n<p>Main C file:</p>\n\n<pre><code>    #include &lt;stdio.h&gt;\n    #include &lt;stdlib.h&gt;\n    #include \"lab1.h\"\n\n    int main(int argc, char *argv[]){\n      int selection = print_menu();\n      while(1)\n      {\n        switch (selection)\n        {\n          case '1':\n            printf (\"\\nselected 1\\n\");\n            break;\n          case '2':\n            printf (\"\\nselected 2\\n\");\n            break;\n          case '3':\n            printf (\"\\nselected 3\\n\");\n            break;\n          case '4':\n            printf (\"\\nselected 4\\n\");\n            break;\n          case '5':\n            printf (\"\\nExit\\n\");\n            exit(0);\n            break;\n          default:\n            printf (\"Invalid Selection\");\n            print_menu();\n            break;\n        };\n      };\n    }\n</code></pre>\n\n<p>My issue is that when I run the program and enter in a wrong character the program is suppose to re-print the menu and ask for the selection again. Except it prints out the menu twice. Example:</p>\n\n<pre><code>    maiah@maiah-vb:~/shared$ ./a.out\n    MENU\n    1. Total of All Top Scores for the Week\n    2. Total of All High Scores for the Week\n    3. Total Machine High Scores for the Week\n    4. Machine High Score for the Week\n    5. EXIT\n    Enter Selection:d\n    Invalid Selection\n    MENU\n    1. Total of All Top Scores for the Week\n    2. Total of All High Scores for the Week\n    3. Total Machine High Scores for the Week\n    4. Machine High Score for the Week\n    5. EXIT\n    Enter Selection:\n    Invalid Selection\n    MENU\n    1. Total of All Top Scores for the Week\n    2. Total of All High Scores for the Week\n    3. Total Machine High Scores for the Week\n    4. Machine High Score for the Week\n    5. EXIT\n    Enter Selection:\n</code></pre>\n\n<p>And then you are given the option to enter in another selection.\nWhen I went through I noticed that it seems to be taking the selection of 'd' and outputting correctly but then acting like a blank space or new line has been automatically entered and proceeds to check the selection (I'm not sure if this is the actual issue though - this is just how it seems to be acting). If anyone has any ideas on how to fix this and explain why this is happening. Any help would be great!</p>\n"}, {"tags": ["c", "linux", "eclipse", "centos", "ide"], "comments": [{"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1568785763, "post_id": 57985411, "comment_id": 102379872, "body": "You might want to look at <code>ctags</code>. See, for example, <a href=\"https://stackoverflow.com/q/1697432/608639\">Autocomplete libraries for Java, C, PHP?</a>, <a href=\"https://stackoverflow.com/q/7748454/608639\">Is there an alternative to ctags that works better?</a>, <a href=\"https://stackoverflow.com/q/7490915/608639\">How does Geany auto-completion work?</a>, <a href=\"https://stackoverflow.com/q/1115876/608639\">Autocompletion in Vim</a> and friends."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1568787101, "post_id": 57985411, "comment_id": 102380346, "body": "Please clarify whether you intend to implement a C parser."}, {"owner": {"reputation": 1701, "user_id": 5836577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/931236857b09c3b0aea0f29fb5a23cbc?s=128&d=identicon&r=PG&f=1", "display_name": "Guillaume Petitjean", "link": "https://stackoverflow.com/users/5836577/guillaume-petitjean"}, "edited": false, "score": 0, "creation_date": 1568787978, "post_id": 57985411, "comment_id": 102380671, "body": "This forum is dedicated to answer specific programming questions, not to do your work completely."}, {"owner": {"reputation": 1, "user_id": 5466275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a9a1f911db18b86403428bc78a17d47?s=128&d=identicon&r=PG&f=1", "display_name": "Suchetan B", "link": "https://stackoverflow.com/users/5466275/suchetan-b"}, "reply_to_user": {"reputation": 1701, "user_id": 5836577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/931236857b09c3b0aea0f29fb5a23cbc?s=128&d=identicon&r=PG&f=1", "display_name": "Guillaume Petitjean", "link": "https://stackoverflow.com/users/5836577/guillaume-petitjean"}, "edited": false, "score": 0, "creation_date": 1568790762, "post_id": 57985411, "comment_id": 102381896, "body": "not my work @GuillaumePetitjean. i want idea or way to get the thing. because it may useful for many developers who r working on this kind of feature. eclipse have that feature. code assist and visual studio with intelisense. forget about it. In a system there will be many c libraries header files. i want to know that function prototypes many people need this solution"}, {"owner": {"reputation": 1, "user_id": 5466275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a9a1f911db18b86403428bc78a17d47?s=128&d=identicon&r=PG&f=1", "display_name": "Suchetan B", "link": "https://stackoverflow.com/users/5466275/suchetan-b"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1568790965, "post_id": 57985411, "comment_id": 102381987, "body": "@Yunnosch parser to implement autocomplete feature like eclipse in my editor."}], "answers": [{"comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1568822037, "post_id": 57987223, "comment_id": 102399804, "body": "Please don&#39;t just post some tool or library as an answer. At least demonstrate <a href=\"http://meta.stackoverflow.com/a/251605\">how it solves the problem</a> in the answer itself."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1568822145, "post_id": 57987223, "comment_id": 102399869, "body": "You might of course notice that you can&#39;t, which illustrates that the question as it is needs clarification or is asking for library recommendation or is too broad. All of that means the question is off-topic and cannot be answered to make a useful Q/A pair."}], "tags": [], "owner": {"reputation": 2505, "user_id": 3118401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c066b73af214d8e7cf6b52f6ef75314a?s=128&d=identicon&r=PG", "display_name": "marcolz", "link": "https://stackoverflow.com/users/3118401/marcolz"}, "is_accepted": false, "score": 1, "last_activity_date": 1568880477, "last_edit_date": 1568880477, "creation_date": 1568791480, "answer_id": 57987223, "question_id": 57985411, "link": "https://stackoverflow.com/questions/57985411/how-to-extract-function-prototypes-from-c-header-files-for-autocomplete-feature/57987223#57987223", "title": "How to extract function prototypes from c header files for autocomplete feature", "body": "<p>As @jww said in a comment: have a look at <a href=\"http://ctags.sourceforge.net/\" rel=\"nofollow noreferrer\">ctags</a> or the more elaborate: <a href=\"http://cscope.sourceforge.net/\" rel=\"nofollow noreferrer\">cscope</a>, both of which are usable for completion in <a href=\"https://www.vim.org/\" rel=\"nofollow noreferrer\">vim</a>.</p>\n\n<p>Specifically have a look at cscope's <a href=\"https://sourceforge.net/p/cscope/cscope/ci/master/tree/src/fscanner.l\" rel=\"nofollow noreferrer\">scanner</a> which uses flex to create a scanner that identifies token types.</p>\n"}], "owner": {"reputation": 1, "user_id": 5466275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a9a1f911db18b86403428bc78a17d47?s=128&d=identicon&r=PG&f=1", "display_name": "Suchetan B", "link": "https://stackoverflow.com/users/5466275/suchetan-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1568880477, "creation_date": 1568783133, "question_id": 57985411, "link": "https://stackoverflow.com/questions/57985411/how-to-extract-function-prototypes-from-c-header-files-for-autocomplete-feature", "title": "How to extract function prototypes from c header files for autocomplete feature", "body": "<p>I am developing an IDE which supports c programming language. </p>\n\n<p>i want to implement a autocomplete feature by pressing ctrl+space. </p>\n\n<p>For that i need to extract all function prototypes from header files. </p>\n\n<p>Please suggest me the way</p>\n\n<p>Thanks \nsuchetan</p>\n"}, {"tags": ["c", "visual-studio", "visual-studio-2015"], "comments": [{"owner": {"reputation": 2323, "user_id": 8350647, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zJNHD.png?s=128&g=1", "display_name": "Nina", "link": "https://stackoverflow.com/users/8350647/nina"}, "edited": false, "score": 0, "creation_date": 1568777774, "post_id": 57984505, "comment_id": 102377926, "body": "Did you install the C/C++ compiler?"}, {"owner": {"reputation": 31, "user_id": 8368589, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JjER6.jpg?s=128&g=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/8368589/jay"}, "reply_to_user": {"reputation": 2323, "user_id": 8350647, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zJNHD.png?s=128&g=1", "display_name": "Nina", "link": "https://stackoverflow.com/users/8350647/nina"}, "edited": false, "score": 0, "creation_date": 1568778806, "post_id": 57984505, "comment_id": 102378121, "body": "@Nina I think so, the compiler should installed when I installed the Visual Studio."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1568782767, "post_id": 57984505, "comment_id": 102378999, "body": "While it is commendable that you&#39;ve got the screenshots it is also <b>essential</b> that you add a <b>verbatim text copy</b> of the compiler warnings so that future readers can find the question with google"}, {"owner": {"reputation": 2323, "user_id": 8350647, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zJNHD.png?s=128&g=1", "display_name": "Nina", "link": "https://stackoverflow.com/users/8350647/nina"}, "edited": false, "score": 0, "creation_date": 1568804074, "post_id": 57984505, "comment_id": 102389288, "body": "@Jay The compiler doesn&#39;t automatically get installed. During the visual studio installation screen you pick which assets of Visual Studio you&#39;d like to install."}, {"owner": {"reputation": 31, "user_id": 8368589, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JjER6.jpg?s=128&g=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/8368589/jay"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1568818046, "post_id": 57984505, "comment_id": 102397494, "body": "@AnttiHaapala Thank you for reminding me, I have edited my question."}, {"owner": {"reputation": 31, "user_id": 8368589, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JjER6.jpg?s=128&g=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/8368589/jay"}, "reply_to_user": {"reputation": 2323, "user_id": 8350647, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zJNHD.png?s=128&g=1", "display_name": "Nina", "link": "https://stackoverflow.com/users/8350647/nina"}, "edited": false, "score": 0, "creation_date": 1568818219, "post_id": 57984505, "comment_id": 102397598, "body": "@Nina  I understand what you mean, when installed Visual Studio, I selected the C/C++ components."}, {"owner": {"reputation": 2323, "user_id": 8350647, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zJNHD.png?s=128&g=1", "display_name": "Nina", "link": "https://stackoverflow.com/users/8350647/nina"}, "edited": false, "score": 0, "creation_date": 1568854795, "post_id": 57984505, "comment_id": 102410295, "body": "@Jay Can you open the command prompt and type <code>cl</code> and see if the command is recognised?"}], "owner": {"reputation": 31, "user_id": 8368589, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JjER6.jpg?s=128&g=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/8368589/jay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1568817921, "creation_date": 1568775970, "last_edit_date": 1568817921, "question_id": 57984505, "link": "https://stackoverflow.com/questions/57984505/my-visual-studio-2015-cannot-find-essential-dependencies-for-building-a-project", "title": "My Visual Studio 2015 cannot find essential dependencies for building a project", "body": "<p>Before, I used Visual Studio 2017 on Windows 10, It works fine.</p>\n\n<p>Now, I want to use <code>CFormView</code> class in MFC (not in Visual Studio 2017), so I installed the Visual Studio 2015 (now with 2 Visual Studio in my system), but Visual Studio 2015 cannot even compile a simple project (the codes like blew in a \"empty console application\"):\n<a href=\"https://i.stack.imgur.com/CPG60.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/CPG60.png\" alt=\"enter image description here\"></a></p>\n\n<p>The error messages when building the solution:</p>\n\n<p><code>TRACKER : Error TRK005: Cannot find: \"cl.exe\".</code>\n<a href=\"https://i.stack.imgur.com/oVcWw.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/oVcWw.png\" alt=\"enter image description here\"></a></p>\n\n<p>The first of the 408 errors show: </p>\n\n<p><code>cannot open source file \"vcruntime.h\"</code>\n<a href=\"https://i.stack.imgur.com/CPG60.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/CPG60.png\" alt=\"enter image description here\"></a></p>\n\n<p>So I found this file in <code>Computer Disk C</code>:\n<a href=\"https://i.stack.imgur.com/UxnO8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/UxnO8.png\" alt=\"enter image description here\"></a></p>\n\n<p>I am confused! When I installed Visual Studio 2015, I select the <code>Computer Disk D</code>:\n<a href=\"https://i.stack.imgur.com/V7v4H.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/V7v4H.png\" alt=\"enter image description here\"></a>\nWhy some important Visual Studio 2015 files is in another disk <code>Disk C</code> with no Visual Studio 2015 program file <code>Disk D</code>?</p>\n\n<p>Then I check the Properties of my Visual Studio project, there is no <code>Disk C</code> header files address in the default include dictionary:</p>\n\n<p><code>$(VC_IncludePath)</code>\n<code>$(WindowsSDK_IncludePath)</code>\n<a href=\"https://i.stack.imgur.com/GAnmh.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/GAnmh.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/cvVEw.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cvVEw.png\" alt=\"enter image description here\"></a></p>\n\n<p>I am a beginner, and would you please tell me why this happened, and how to fix my Visual Studio 2015 to make it work? Thank you very much!</p>\n"}, {"tags": ["c", "arrays", "pointers", "while-loop"], "comments": [{"owner": {"reputation": 2783, "user_id": 782570, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cbbf87d7ce9ed596faa7e64231114991?s=128&d=identicon&r=PG&f=1", "display_name": "giusti", "link": "https://stackoverflow.com/users/782570/giusti"}, "edited": false, "score": 1, "creation_date": 1568775124, "post_id": 57984336, "comment_id": 102377460, "body": "Do you have a sample input/ouput for your program? Quetions on Stack Oveflow are more successful if users can copy and paste your code, then test it to reproduce the difficulties you are encountering. Read here about how to make a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 1, "user_id": 12050634, "user_type": "registered", "profile_image": "https://graph.facebook.com/10217366320323471/picture?type=large", "display_name": "Wilson Lam", "link": "https://stackoverflow.com/users/12050634/wilson-lam"}, "reply_to_user": {"reputation": 2783, "user_id": 782570, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cbbf87d7ce9ed596faa7e64231114991?s=128&d=identicon&r=PG&f=1", "display_name": "giusti", "link": "https://stackoverflow.com/users/782570/giusti"}, "edited": false, "score": 0, "creation_date": 1568777277, "post_id": 57984336, "comment_id": 102377837, "body": "I don&#39;t have an example because I am not sure how to go about the &quot;scanner input &quot;portion. what would help is a tutorial on how I can do the following: &quot;take an input and put it into the array and increase the pointer to the next with every loop&quot;.  I can&#39;t find a tutorial anywhere online to help solve this problem."}, {"owner": {"reputation": 1, "user_id": 12050634, "user_type": "registered", "profile_image": "https://graph.facebook.com/10217366320323471/picture?type=large", "display_name": "Wilson Lam", "link": "https://stackoverflow.com/users/12050634/wilson-lam"}, "reply_to_user": {"reputation": 2783, "user_id": 782570, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cbbf87d7ce9ed596faa7e64231114991?s=128&d=identicon&r=PG&f=1", "display_name": "giusti", "link": "https://stackoverflow.com/users/782570/giusti"}, "edited": false, "score": 0, "creation_date": 1568784645, "post_id": 57984336, "comment_id": 102379525, "body": "So basically what I need it to do, Scan into array -&gt; check for duplicates, prompt if any -&gt; delete duplicate -&gt; repeat up to 2000 times.  My problem is how do I create a function that reads the input and put it into the array in a different pointer every loop and pass the function over to the duplicate checker which will prompt for duplicate barcodes and lastly delete the duplicate so it will not prompt user again that a duplicate has been scanned."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 12050634, "user_type": "registered", "profile_image": "https://graph.facebook.com/10217366320323471/picture?type=large", "display_name": "Wilson Lam", "link": "https://stackoverflow.com/users/12050634/wilson-lam"}, "edited": false, "score": 0, "creation_date": 1568784306, "post_id": 57985551, "comment_id": 102379430, "body": "thank you for spoting that error, I just need it to run up to 2000 times/scans."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1568785152, "post_id": 57985551, "comment_id": 102379676, "body": "Real-world would implement it as a hash-table for lookup efficiency, but for your purposes with a max of 2000, iterating is fine. (but there are much more efficient ways to do it)"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1568785362, "post_id": 57985551, "comment_id": 102379741, "body": "@DavidC.Rankin Agree, for &quot;small&quot; amount of data the simple array approach can be ok and even preferred because it&#39;s simple to code. For large amount of data, e.g. 10.000.000 elements, the simple array approach is just a no-go."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1568785495, "post_id": 57985551, "comment_id": 102379789, "body": "Yep, sorry for the lack of specificity, it was clear from your answer you were pointing that out, the suggestion of the hash-table was for the Questioner&#39;s benefit."}, {"owner": {"reputation": 1, "user_id": 12050634, "user_type": "registered", "profile_image": "https://graph.facebook.com/10217366320323471/picture?type=large", "display_name": "Wilson Lam", "link": "https://stackoverflow.com/users/12050634/wilson-lam"}, "edited": false, "score": 0, "creation_date": 1568790507, "post_id": 57985551, "comment_id": 102381775, "body": "So basically the while loop is for loop through each scan, 1 scan from barcode reader = 1 loop. within the loop it takes the input and stores it in the array then checks for duplicates(prompts user if any duplicates) then deletes the duplicate if not it would prompt user that there is a duplicate on the next instance of the loop."}, {"owner": {"reputation": 1, "user_id": 12050634, "user_type": "registered", "profile_image": "https://graph.facebook.com/10217366320323471/picture?type=large", "display_name": "Wilson Lam", "link": "https://stackoverflow.com/users/12050634/wilson-lam"}, "edited": false, "score": 0, "creation_date": 1568790722, "post_id": 57985551, "comment_id": 102381877, "body": "basically right now my code takes all the input first then checks for duplicates, I want it to just take 1 input each time it goes through the loop then check for duplicates then lastly delete the duplicate so it does not prompt user that there is still a duplicate on the next scan/loop  1 loop = 1 scan."}], "tags": [], "owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "is_accepted": false, "score": 2, "last_activity_date": 1568786928, "last_edit_date": 1568786928, "creation_date": 1568783993, "answer_id": 57985551, "question_id": 57984336, "link": "https://stackoverflow.com/questions/57984336/array-pointer-while-loop-input/57985551#57985551", "title": "Array pointer while loop input", "body": "<p>The first problem with your code is this:</p>\n\n<pre><code>int i,j,k=1,...\n\n...\n\nwhile (k&gt;=2000,k++)\n        ^^^^^^\n        ups...\n</code></pre>\n\n<p>This will give the warning \"left-hand operand of comma expression has no effect\" which actually means that the line is the same as:</p>\n\n<pre><code>while (k++)\n</code></pre>\n\n<p>That will keep looping until you have integer overflow (which is undefined behavior). So you don't want to do that.</p>\n\n<p>Since you initialize <code>k</code> to 1, I assume that you wanted to do:</p>\n\n<pre><code>while (k++ &lt; 2000)\n</code></pre>\n\n<p>Now let's assume that you want:</p>\n\n<pre><code>while (k++ &lt; 2000)  // Will loop approx 2000 times\n{\n    //Scanner Input\n    for(i=0; i&lt; ArrSize; i++)  // Will loop 2000 times\n    {\n        scanf(\"%d\",&amp;arr[i]);\n    }\n</code></pre>\n\n<p>So in the end your program calls <code>scanf</code> 2000 x 2000 = 4.000.000 times. Is that what you want? The purpose of the outer <code>while</code> is unclear.</p>\n\n<p>Your program first reads 2000 integers and afterwards it seems you want to remove duplicates. That's a bad approach as you may end you doing a lot of memory move whenever you need to remove a duplicate element from the array.</p>\n\n<p>A better approach is to check whether a newly scanned value is a duplicate <strong>before</strong> inserting it in the array. That could look something like:</p>\n\n<pre><code>    for(i=0; i &lt; ArrSize; )\n    {\n        int tmp;\n        if (scanf(\"%d\", &amp;tmp) != 1) \n        {\n            // Input error\n            exit(1);\n        }\n\n        // Check if tmp is already in the array\n        int duplicate = 0;\n        for (int j = 0; j &lt; i; ++j)\n        {\n            if (tmp == arr[j])\n            {\n                duplicate = 1;\n                break;\n            }\n        }\n        if (duplicate)\n        {\n            printf(\"dup found\\n\");\n        }\n        else\n        {\n            arr[i] = tmp;\n            ++i;\n        }\n    }\n</code></pre>\n\n<p>This should give you <code>ArrSize</code> unique elements.</p>\n\n<p>Notice: In order to check if something is a duplicate, you'll need to scan through the array from start to the current number of elements. To improve performance you could consider another approach, e.g. a sorted tree, hash tables, etc so that check for duplicates can be done much faster. This gets more important as the number of array elements increase.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 12050634, "user_type": "registered", "profile_image": "https://graph.facebook.com/10217366320323471/picture?type=large", "display_name": "Wilson Lam", "link": "https://stackoverflow.com/users/12050634/wilson-lam"}, "is_accepted": false, "score": 0, "last_activity_date": 1568855475, "creation_date": 1568855475, "answer_id": 58002443, "question_id": 57984336, "link": "https://stackoverflow.com/questions/57984336/array-pointer-while-loop-input/58002443#58002443", "title": "Array pointer while loop input", "body": "<p>So half the problem is solved, I am still not sure how do I increase the pointer to the next position so on the next loop it will store another barcode number which will then be passed to the duplicate checker for checking then repeat the loop for the next scan.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main(void) {\n\nint i,j,k=1,arr[2000],counter=1;\n//Welcome message\n  printf(\"Welcome to Yamato Transport (S) Pte. Ltd.\\n\");\n  printf(\"Barcode checker Ver 1.0\\n\");\n\n  while (k++ &lt; 2000)  // Will loop approx 2000 times\n{\n//Scanner Input\nprintf(\"Scan barcode\\n\");\nfor(i=0; i&lt; counter; i++)  // Will loop 1 time\n{\n    scanf(\"%d\",&amp;arr[i]);\n}\n\n  //check for duplicates\n  for(i=0; i &lt; counter; )\n    {\n        int tmp;\n        if (scanf(\"%d\", &amp;tmp) != 1) \n        {\n            // Input error\n            exit(1);\n        }\n\n        // Check if tmp is already in the array\n        int duplicate = 0;\n        for (int j = 0; j &lt; i; ++j)\n        {\n            if (tmp == arr[j])\n            {\n                duplicate = 1;\n                break;\n            }\n        }\n        if (duplicate)\n        {\n            printf(\"Duplicate Barcode\\n\");\n        }\n        else\n        {\n            arr[i] = tmp;\n            ++i;\n        }\n    }\n\n  }\n  return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12050634, "user_type": "registered", "profile_image": "https://graph.facebook.com/10217366320323471/picture?type=large", "display_name": "Wilson Lam", "link": "https://stackoverflow.com/users/12050634/wilson-lam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1568855475, "creation_date": 1568774530, "last_edit_date": 1568775775, "question_id": 57984336, "link": "https://stackoverflow.com/questions/57984336/array-pointer-while-loop-input", "title": "Array pointer while loop input", "body": "<p>I am trying to write a program to check for duplicate input from a programmable handheld barcode scanner, I am programming it to be able to scan 2000 barcodes.</p>\n\n<p>I am new to c Programming, I am trying to take an input and put it into the array and increase the pointer to the next with every loop.</p>\n\n<p><strong>Example:</strong> <code>int Array [10];</code></p>\n\n<p>I want to <code>scanf()</code> into Array <em>location 0</em> on the first loop then increment by 1 location to <em>location 2</em> etc every time the while loops runs. Please help, your help is much appreciated.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main ()\n{\n    int i,j,k=1,arr[2000],ArrSize=2000;\n\n    //Welcome message\n    printf(\"Welcome to Yamato Transport (S) Pte. Ltd.\\n\");\n    printf(\"Barcode checker Ver 1.0\\n\");\n\n    while (k&gt;=2000,k++)\n    {\n        //Scanner Input\n        for(i=0;i&lt;ArrSize;i++)\n        {\n        scanf(\"%d\",&amp;arr[i]);\n        }\n\n        //Duplicate Logic\n        printf(\"Duplicate Barcodes: \");\n        for(i=0; i&lt;ArrSize; i++)\n        {\n            for(j=i+1;j&lt;ArrSize;j++)\n            {\n            if(arr[i]==arr[j])\n            {\n            printf(\"%d\\n\",arr[i]);\n            }\n        }\n        }\n        //Remove single duplicate\n\n        //Clear Screen\n\n    }\n  return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "multidimensional-array", "memory-management", "heap-memory", "free"], "comments": [{"owner": {"reputation": 1669, "user_id": 7508077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b4193888717f50e77805498af1435b9?s=128&d=identicon&r=PG&f=1", "display_name": "EsmaeelE", "link": "https://stackoverflow.com/users/7508077/esmaeele"}, "edited": false, "score": 0, "creation_date": 1568776115, "post_id": 57984213, "comment_id": 102377627, "body": "You don&#39;t check is memory allocation <code>malloc()</code> is successful or not."}, {"owner": {"reputation": 1669, "user_id": 7508077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b4193888717f50e77805498af1435b9?s=128&d=identicon&r=PG&f=1", "display_name": "EsmaeelE", "link": "https://stackoverflow.com/users/7508077/esmaeele"}, "edited": false, "score": 0, "creation_date": 1568777041, "post_id": 57984213, "comment_id": 102377795, "body": "<code>free(results[a]-&gt;finals[b]);</code> cause error."}, {"owner": {"reputation": 319, "user_id": 3528879, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2046eb8d7ce1d71b4e76bd297746af31?s=128&d=identicon&r=PG&f=1", "display_name": "MrPuzzler", "link": "https://stackoverflow.com/users/3528879/mrpuzzler"}, "reply_to_user": {"reputation": 1669, "user_id": 7508077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b4193888717f50e77805498af1435b9?s=128&d=identicon&r=PG&f=1", "display_name": "EsmaeelE", "link": "https://stackoverflow.com/users/7508077/esmaeele"}, "edited": false, "score": 0, "creation_date": 1568777888, "post_id": 57984213, "comment_id": 102377949, "body": "The code was getting long, so I stripped out checks and also memsets.  No errors are reported when allocating memory."}, {"owner": {"reputation": 132, "user_id": 12069869, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e3cadaa1f2741949137404bffc50711?s=128&d=identicon&r=PG&f=1", "display_name": "DoubleRainbowZ", "link": "https://stackoverflow.com/users/12069869/doublerainbowz"}, "edited": false, "score": 0, "creation_date": 1568778012, "post_id": 57984213, "comment_id": 102377969, "body": "<code>results[j]-&gt;finals[k] = malloc(70); &#47;&#47;max string size is 70</code>  should this be: <code>results[j]-&gt;finals[k] = malloc(sizeof(char)*70);</code> As you want to malloc a string of size 70. Not sure if this is the cause of the error though.."}, {"owner": {"reputation": 1669, "user_id": 7508077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b4193888717f50e77805498af1435b9?s=128&d=identicon&r=PG&f=1", "display_name": "EsmaeelE", "link": "https://stackoverflow.com/users/7508077/esmaeele"}, "edited": false, "score": 0, "creation_date": 1568778561, "post_id": 57984213, "comment_id": 102378074, "body": "by using  this <code>results[j]-&gt;name = malloc(sizeof(char));</code> error gone."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1568781903, "post_id": 57984213, "comment_id": 102378799, "body": "Where is <code>free(results[a]-&gt;name);</code> allocated? (that&#39;s a big problem)"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 1669, "user_id": 7508077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b4193888717f50e77805498af1435b9?s=128&d=identicon&r=PG&f=1", "display_name": "EsmaeelE", "link": "https://stackoverflow.com/users/7508077/esmaeele"}, "edited": false, "score": 1, "creation_date": 1568784017, "post_id": 57984213, "comment_id": 102379361, "body": "@EsmaeelE - <code>results[j]-&gt;finals[k] = malloc(70)</code> is fine. <code>sizeof (char)</code> is always <code>1</code>."}, {"owner": {"reputation": 1669, "user_id": 7508077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b4193888717f50e77805498af1435b9?s=128&d=identicon&r=PG&f=1", "display_name": "EsmaeelE", "link": "https://stackoverflow.com/users/7508077/esmaeele"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1568825362, "post_id": 57984213, "comment_id": 102401269, "body": "@DavidC.Rankin Thanks."}], "answers": [{"comments": [{"owner": {"reputation": 319, "user_id": 3528879, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2046eb8d7ce1d71b4e76bd297746af31?s=128&d=identicon&r=PG&f=1", "display_name": "MrPuzzler", "link": "https://stackoverflow.com/users/3528879/mrpuzzler"}, "edited": false, "score": 0, "creation_date": 1568844085, "post_id": 57985432, "comment_id": 102408203, "body": "Thank you for this.  You&#39;re right- I had malloc&#39;ed the name in my code but forgot to put it in the code sample.  Your comment on testing for memory errors got me thinking and I did find a memory leak in a separate function used immediately before this <code>calc_results</code> allocation code.  It&#39;s fixed and now the <code>calc_results</code> stuff works!"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 319, "user_id": 3528879, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2046eb8d7ce1d71b4e76bd297746af31?s=128&d=identicon&r=PG&f=1", "display_name": "MrPuzzler", "link": "https://stackoverflow.com/users/3528879/mrpuzzler"}, "edited": false, "score": 0, "creation_date": 1568845390, "post_id": 57985432, "comment_id": 102408528, "body": "You are welcome. It was clear you understood what you were doing. The only challenge in deeply nested allocations is putting on your &quot;Accountants Hat&quot; and dotting all <code>&quot;I&#39;s&quot;</code> and crossing all <code>&quot;T&#39;s&quot;</code> to make sure each allocation is paired with a <code>free()</code> in the correct order. No mysteries, just good old double-checking (and using the memory check program makes sure you are right)"}], "tags": [], "owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "is_accepted": true, "score": 3, "last_activity_date": 1568784434, "last_edit_date": 1568784434, "creation_date": 1568783299, "answer_id": 57985432, "question_id": 57984213, "link": "https://stackoverflow.com/questions/57984213/trouble-freeing-2d-array-in-2d-array-in-c/57985432#57985432", "title": "Trouble freeing 2d array in 2d array in c", "body": "<p><strong>Note:</strong> your code has NO array in it, so your Question Title is a misnomer. You are allocating for a <em>pointer-to-pointer to type</em> where you first allocate pointers, and then a block of storage for each object and then you assign the beginning address for each block of storage to a pointer. (Rule: a pointer is not an array, and an array is not a pointer -- though on access an array is converted to a pointer to the first element pursuant to <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.3.2.1p3\" rel=\"nofollow noreferrer\">C11 Standard - 6.3.2.1(p3)</a>)</p>\n\n<hr>\n\n<p>Your only problem is attempting to <code>free (results[a]-&gt;name);</code> which is not allocated, and then your failure to <strong><em>validate the return</em></strong> of each allocation. Other than that, you are very very close. You knew what you needed to <code>free</code> and the order to do it in, the <code>free(results[a]-&gt;name);</code> looks more like a <code>\"...duh...\"</code> error than any failure in understanding.</p>\n\n<p>You can also size the <em>type</em> for each allocation by using the <em>dereferenced pointer</em> rather than trying to recall the <code>X-type</code> for <code>sizeof(X-type)</code> which can be error-prone in circumstances. For example, instead of:</p>\n\n<pre><code>    calc_result** results = malloc(sizeof(calc_result*)*calcsPerChunk);\n</code></pre>\n\n<p>You can use the <code>sizeof *results</code> (the dereferenced pointer) to set the size of each object, e.g.</p>\n\n<pre><code>    calc_results **results = malloc (sizeof *results * calcsPerChunk);\n</code></pre>\n\n<p><strong>Note:</strong> the <code>'*'</code> or <code>'**'</code> generally goes with the pointer and not the type. Why?, semantics and making what the pointer is explicit. For example:</p>\n\n<pre><code>    calc_results* a, b, c;\n</code></pre>\n\n<p>certainly does NOT declare <em>3-pointers to</em> <code>calc_result</code>. Instead it declares <em>pointer to</em> <code>calc_result a</code> and two <code>struct calc_result b, c</code>. Ensuring the <code>'*'</code> is on the pointer makes that clear, e.g.</p>\n\n<pre><code>    calc_results *a, b, c;\n</code></pre>\n\n<p>(legal syntax-wise, it makes no difference, the compiler can parse it without any problem -- it's the human-side where the problems tend to occur)</p>\n\n<p><strong>A Quick Example Confirming Your Approach</strong></p>\n\n<p>For testing, you don't need:</p>\n\n<pre><code>int numChunks = 10;\nint calcsPerChunk = 50;\n</code></pre>\n\n<p>(<code>3</code> and <code>5</code> (or anything more than <code>1</code>) will do)</p>\n\n<p>Putting together a short example that validates each allocation as well as sizes each allocation by using the dereferenced pointer, (and spits out output for each level just for fun) you could do:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\ntypedef struct {\n    char *name;\n    int index;\n    char **finals;\n} calc_results;\n\nint main(void)\n{\n    int numChunks = 3;\n    int calcsPerChunk = 5;\n\n    for(int i = 0; i &lt; numChunks; i++) {\n        calc_results **results = malloc (sizeof *results * calcsPerChunk);\n        if (!results) {\n            perror (\"malloc-results\");\n            return 1;\n        }\n        for(int j = 0; j &lt; calcsPerChunk; j++)\n        {\n            if (!(results[j] = malloc (sizeof *results[j]))) {\n                perror (\"malloc-results[j]\");\n                return 1;\n            }\n            results[j]-&gt;name = \"blah\";\n            results[j]-&gt;index = j;\n            if (!(results[j]-&gt;finals=malloc(sizeof *results[j]-&gt;finals*12))) {\n                perror (\"malloc-results[j]-&gt;finals\");\n                return 1;\n            }\n            for(int k = 0; k &lt; 12; k++) {\n                if (!(results[j]-&gt;finals[k] = malloc(70))) {\n                    perror (\"malloc-results[j]-&gt;finals[k]\");\n                    return 1;\n                }\n                sprintf (results[j]-&gt;finals[k], \"grade %d\", k+1);\n            }\n        }\n\n        /* DO ACTUAL WORK */\n\n        /* output &amp; free stuff */\n        printf (\"results[%2d]\\n\", i);\n        for (int a = 0; a &lt; calcsPerChunk; a++) {\n            printf (\"  %s %2d\\n\", results[a]-&gt;name, results[a]-&gt;index);\n            for (int b = 0; b &lt; 12; b++) {\n                printf (\"    %s\\n\", results[a]-&gt;finals[b]);\n                free (results[a]-&gt;finals[b]);\n            }\n            // free(results[a]-&gt;name);\n            free(results[a]-&gt;finals);\n            free(results[a]);\n        }\n\n        free(results);\n    }\n}\n</code></pre>\n\n<p><strong>Memory Use/Error Check</strong></p>\n\n<p>Now for the critical part. In any code you write that dynamically allocates memory, you have 2 <em>responsibilities</em> regarding any block of memory allocated: (1) <em>always preserve a pointer to the starting address</em> for the block of memory so, (2) it can be <em>freed</em> when it is no longer needed.</p>\n\n<p>It is imperative that you use a memory error checking program to insure you do not attempt to access memory or write beyond/outside the bounds of your allocated block, attempt to read or base a conditional jump on an uninitialized value, and finally, to confirm that you free all the memory you have allocated. </p>\n\n<p>For Linux <code>valgrind</code> is the normal choice. There are similar memory checkers for every platform. They are all simple to use, just run your program through it.</p>\n\n<pre><code>$ valgrind ./bin/free_nested_struct\n==13663== Memcheck, a memory error detector\n==13663== Copyright (C) 2002-2015, and GNU GPL'd, by Julian Seward et al.\n==13663== Using Valgrind-3.12.0 and LibVEX; rerun with -h for copyright info\n==13663== Command: ./bin/free_nested_struct\n==13663==\nresults[ 0]\n  blah  0\n    grade 1\n    grade 2\n    grade 3\n    grade 4\n    grade 5\n    grade 6\n    ...\n    &lt;snip&gt;\n==13663==\n==13663== HEAP SUMMARY:\n==13663==     in use at exit: 0 bytes in 0 blocks\n==13663==   total heap usage: 213 allocs, 213 frees, 14,520 bytes allocated\n==13663==\n==13663== All heap blocks were freed -- no leaks are possible\n==13663==\n==13663== For counts of detected and suppressed errors, rerun with: -v\n==13663== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 0 from 0)\n</code></pre>\n\n<p>Always confirm that you have freed all memory you have allocated and that there are no memory errors.</p>\n\n<p>Look things over and let me know if you have further questions. You really were very close, and I suspect you are actually allocating for <code>name</code> in your actual code, so more than likely, your code should have worked.</p>\n"}], "owner": {"reputation": 319, "user_id": 3528879, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2046eb8d7ce1d71b4e76bd297746af31?s=128&d=identicon&r=PG&f=1", "display_name": "MrPuzzler", "link": "https://stackoverflow.com/users/3528879/mrpuzzler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 1, "accepted_answer_id": 57985432, "answer_count": 1, "score": 1, "last_activity_date": 1568788291, "creation_date": 1568773274, "last_edit_date": 1568788291, "question_id": 57984213, "link": "https://stackoverflow.com/questions/57984213/trouble-freeing-2d-array-in-2d-array-in-c", "title": "Trouble freeing 2d array in 2d array in c", "body": "<p>Brief overview of my program: it takes in a list of about 500 sets of initial parameters.  It then splits those 500 into \"chunks\" of 50 so it can calculate the 50 and write the results to file, then move on to the next \"chunk\" of 50, etc.  It's a checkpointing system.  Anyway, for every \"chunk\", an array of structs called <code>calc_result</code> is created to hold 50 results.  Each <code>calc_result</code> consists of a name, an index, and a 2d char array for the actual results.  Then work is done and written to file, and the current <code>calc_result</code> array is freed.  Here is the basic program:</p>\n\n<pre><code>typedef struct\n{\n    char* name;\n    int index;\n    char** finals;\n} calc_results;\n\nint main(int argc, char** argv)\n{\n    //read in sets of initial parameters\n    int numChunks = 10;\n    int calcsPerChunk = 50;\n\n    for(int i = 0; i &lt; numChunks; i++)\n    {\n        calc_result** results = malloc(sizeof(calc_result*)*calcsPerChunk);\n        for(int j = 0; j &lt; calcsPerChunk; j++)\n        {\n             results[j] = malloc(sizeof(calc_result));\n             results[j]-&gt;name = \"blah\";\n             results[j]-&gt;index = j;\n             results[j]-&gt;finals = malloc(sizeof(char*) * 12); //12 final results\n             for(int k = 0; k &lt; 12; k++)\n             {\n                 results[j]-&gt;finals[k] = malloc(70); //max string size is 70\n             }\n         }\n\n         //DO ACTUAL WORK\n\n         //WRITE RESULTS TO FILE\n\n         //FREE STUFF:\n         for(int a = 0; a &lt; calcsPerChunk; a++)\n         {\n             for(int b = 0; b &lt; 12; b++)\n             {\n                 free(results[a]-&gt;finals[b]);\n             }\n             free(results[a]-&gt;name);\n             free(results[a]-&gt;finals);\n             free(results[a]);\n         }\n\n      free(results);\n     }\n}\n</code></pre>\n\n<p>I'm having trouble with the freeing of the results.  The program runs through about 7 of the 10 \"chunks\", and runs through freeing 1 of the <code>calcsPerChunk</code> (ie, <code>i = 8</code>, <code>a = 1</code> and <code>b = 0</code>), then it throws an error pointing to the <code>free(results[a]-&gt;finals[b])</code> line.  The error is useless: \"Program.exe\" has triggered a breakpoint.\"  I'm not sure what I'm doing wrong here, can anyone help?</p>\n"}, {"tags": ["c", "gcc", "parallel-processing", "openmp"], "comments": [{"owner": {"reputation": 4593, "user_id": 105104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02b23920ac852e946b333d3f9d0d95c1?s=128&d=identicon&r=PG", "display_name": "dvhh", "link": "https://stackoverflow.com/users/105104/dvhh"}, "edited": false, "score": 0, "creation_date": 1568773531, "post_id": 57984116, "comment_id": 102377169, "body": "what would be the value of <code>sumP</code> in each parallel worker ?"}, {"owner": {"reputation": 91, "user_id": 9671874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddcb1170089bbfab8483b2011628381a?s=128&d=identicon&r=PG&f=1", "display_name": "Luiz", "link": "https://stackoverflow.com/users/9671874/luiz"}, "reply_to_user": {"reputation": 4593, "user_id": 105104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02b23920ac852e946b333d3f9d0d95c1?s=128&d=identicon&r=PG", "display_name": "dvhh", "link": "https://stackoverflow.com/users/105104/dvhh"}, "edited": false, "score": 0, "creation_date": 1568773967, "post_id": 57984116, "comment_id": 102377242, "body": "I did a parcial sum on each for thread and than a final sum at the end"}, {"owner": {"reputation": 4593, "user_id": 105104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02b23920ac852e946b333d3f9d0d95c1?s=128&d=identicon&r=PG", "display_name": "dvhh", "link": "https://stackoverflow.com/users/105104/dvhh"}, "edited": false, "score": 0, "creation_date": 1568774992, "post_id": 57984116, "comment_id": 102377432, "body": "could you <code>printf</code> <code>sumP</code> before being summed in <code>soma</code> that could probably explain your issue"}, {"owner": {"reputation": 1669, "user_id": 7508077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b4193888717f50e77805498af1435b9?s=128&d=identicon&r=PG&f=1", "display_name": "EsmaeelE", "link": "https://stackoverflow.com/users/7508077/esmaeele"}, "edited": false, "score": 0, "creation_date": 1568774997, "post_id": 57984116, "comment_id": 102377433, "body": "Show where <code>sum</code> is change in your code."}, {"owner": {"reputation": 4593, "user_id": 105104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02b23920ac852e946b333d3f9d0d95c1?s=128&d=identicon&r=PG", "display_name": "dvhh", "link": "https://stackoverflow.com/users/105104/dvhh"}, "edited": false, "score": 0, "creation_date": 1568775231, "post_id": 57984116, "comment_id": 102377482, "body": "Also the code as it is is non compilable"}, {"owner": {"reputation": 91, "user_id": 9671874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddcb1170089bbfab8483b2011628381a?s=128&d=identicon&r=PG&f=1", "display_name": "Luiz", "link": "https://stackoverflow.com/users/9671874/luiz"}, "edited": false, "score": 0, "creation_date": 1568775284, "post_id": 57984116, "comment_id": 102377492, "body": "sorry, forgot to translat the soma to sum variable. On the original code I used the variables in portuguese, I translated it to post here, but forgot the sum, I edited it and now its the same way as my code."}, {"owner": {"reputation": 91, "user_id": 9671874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddcb1170089bbfab8483b2011628381a?s=128&d=identicon&r=PG&f=1", "display_name": "Luiz", "link": "https://stackoverflow.com/users/9671874/luiz"}, "edited": false, "score": 0, "creation_date": 1568775558, "post_id": 57984116, "comment_id": 102377537, "body": "in this teste none of the numbers is multiple of 5 and the result is -3  sumP : 0 sum: 0 Number: 0, pos[0][0] Number: 0, pos[0][1] Number: 0, pos[0][2] Number: 0, pos[0][3] Number: 0, pos[0][4] Number: 1, pos[1][0] Number: 1, pos[1][1] Number: 1, pos[1][2] Number: 1, pos[1][3] Number: 1, pos[1][4] Number: 2, pos[2][0] Number: 2, pos[2][1] Number: 2, pos[2][2] Number: 2, pos[2][3] Number: 2, pos[2][4] Number: 3, pos[3][0] [...] (supressed part of the result) sum: -3"}, {"owner": {"reputation": 91, "user_id": 9671874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddcb1170089bbfab8483b2011628381a?s=128&d=identicon&r=PG&f=1", "display_name": "Luiz", "link": "https://stackoverflow.com/users/9671874/luiz"}, "edited": false, "score": 0, "creation_date": 1568775664, "post_id": 57984116, "comment_id": 102377553, "body": "removing the if statement that check if the number is multiple of 5 and doing a 3x3 matrix I got:  Number: 0, pos[0][0] Number: 0, pos[0][1] Number: 0, pos[0][2] Number: 1, pos[1][0] Number: 1, pos[1][1] Number: 1, pos[1][2] Number: 2, pos[2][0] Number: 2, pos[2][1] Number: 2, pos[2][2] numero: 1, pos [1],[0] sumP: 0 numero: 1, pos [1],[1] sumP: 1 numero: 1, pos [1],[2] sumP: 2 numero: 0, pos [0],[0] sumP: 0 numero: 0, pos [0],[1] sumP: 0 numero: 0, pos [0],[2] sumP: 0 numero: 2, pos [2],[0] sumP: 1 numero: 2, pos [2],[1] sumP: 3 numero: 2, pos [2],[2] sumP: 5 sum: 6"}, {"owner": {"reputation": 4593, "user_id": 105104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02b23920ac852e946b333d3f9d0d95c1?s=128&d=identicon&r=PG", "display_name": "dvhh", "link": "https://stackoverflow.com/users/105104/dvhh"}, "edited": false, "score": 0, "creation_date": 1568778864, "post_id": 57984116, "comment_id": 102378132, "body": "Maybe if you would describe what your sum loop should be doing compared to what you can trace by hand"}, {"owner": {"reputation": 4593, "user_id": 105104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02b23920ac852e946b333d3f9d0d95c1?s=128&d=identicon&r=PG", "display_name": "dvhh", "link": "https://stackoverflow.com/users/105104/dvhh"}, "edited": false, "score": 0, "creation_date": 1568779273, "post_id": 57984116, "comment_id": 102378187, "body": "so your condition is <code>if A[i][j] is a multiple of 5 and not 0</code> ? And consider the way you are populating your first loop"}], "answers": [{"tags": [], "owner": {"reputation": 4593, "user_id": 105104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02b23920ac852e946b333d3f9d0d95c1?s=128&d=identicon&r=PG", "display_name": "dvhh", "link": "https://stackoverflow.com/users/105104/dvhh"}, "is_accepted": false, "score": 0, "last_activity_date": 1568780117, "creation_date": 1568780117, "answer_id": 57985007, "question_id": 57984116, "link": "https://stackoverflow.com/questions/57984116/sum-of-matrix-elements-on-a-parallel-region-resulting-on-wrong-answers-on-openmp/57985007#57985007", "title": "Sum of matrix elements on a parallel region resulting on wrong answers on OpenMP", "body": "<p>Considering that your code would spend most of its time dealing with I/O it would be a good idea to comment the <code>printf</code></p>\n\n<p>But as I understand <code>sumP</code> should contain the partial sum of your inner loop</p>\n\n<p>Pragmas have been compressed for readability</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;omp.h&gt;\n\n#define N 1000\n\n\nint main() {\n    int i, j;\n    int sum = 0;\n    int sumP = 0;\n    int A[N][N]; // will cause segfault with large N\n    printf(\"sumP : %i\\n\", sumP );\n    printf(\"sum: %i\\n\", sum);\n    #pragma omp parallel for shared (A) private (i, j)\n    for (i = 0; i &lt; N; i++) {\n        for(j = 0; j &lt; N; j++){\n            A[i][j] = i%5; // populate array with numbers in [0,1,2,3,4]\n            //printf(\"Number: %i, pos[%i][%i]\\n\", A[i][j], i, j);\n        }\n    }\n\n    #pragma omp parallel for shared(A) private (i, j, sumP) reduction(+: sum)\n    for (i = 0; i&lt; N; i++) { // outer (parallel)loop \n        sumP = 0; // initialize partial sum\n        for (j = 0; j &lt; N; j++){ // inner sequential loop\n            //if (A[i][j] % 5 == 0 &amp;&amp; A[i][j] != 0){ // Explain this condition \n                sumP += A[i][j];\n                //printf(\"numero: %i, pos [%i],[%i] sumP: %i\\n\", A[i][j], i, j, sumP);\n            //}\n        }\n        //printf(\"sumP: %i\\n\", sumP);\n        sum += sumP; // add partial sum\n    }\n\n    //printf(\"sumP: %i\\n\", sumP);\n    printf(\"sum: %i\\n\", sum);\n\n    return (0);\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 91, "user_id": 9671874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddcb1170089bbfab8483b2011628381a?s=128&d=identicon&r=PG&f=1", "display_name": "Luiz", "link": "https://stackoverflow.com/users/9671874/luiz"}, "edited": false, "score": 0, "creation_date": 1568812715, "post_id": 57991274, "comment_id": 102394128, "body": "Thank you for the answer. My professor teached us this way, but using a Vector instead of a matrix. Is there any difference between using a nested for and a non nested for in omp for? Because when we tried the non nested for it worked. My professor teached that we needed to use a private on sumP to avoid that the other threads access the provisory sum and to avoid a data concurrency."}, {"owner": {"reputation": 91, "user_id": 9671874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddcb1170089bbfab8483b2011628381a?s=128&d=identicon&r=PG&f=1", "display_name": "Luiz", "link": "https://stackoverflow.com/users/9671874/luiz"}, "edited": false, "score": 0, "creation_date": 1568812738, "post_id": 57991274, "comment_id": 102394150, "body": "By &quot;this way&quot; I meant the way I did"}, {"owner": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "reply_to_user": {"reputation": 91, "user_id": 9671874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddcb1170089bbfab8483b2011628381a?s=128&d=identicon&r=PG&f=1", "display_name": "Luiz", "link": "https://stackoverflow.com/users/9671874/luiz"}, "edited": false, "score": 0, "creation_date": 1568826499, "post_id": 57991274, "comment_id": 102401690, "body": "<code>#pragma omp parallel for</code> ist really just a shorthand for <code>#pragma omp parallel</code> and <code>#pragma omp for</code>. If you don&#39;t use <code>reduction</code>, you need the separate pragmas to have space for the local sum initialization."}], "tags": [], "owner": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "is_accepted": true, "score": 3, "last_activity_date": 1568804649, "creation_date": 1568804649, "answer_id": 57991274, "question_id": 57984116, "link": "https://stackoverflow.com/questions/57984116/sum-of-matrix-elements-on-a-parallel-region-resulting-on-wrong-answers-on-openmp/57991274#57991274", "title": "Sum of matrix elements on a parallel region resulting on wrong answers on OpenMP", "body": "<p>You observe this behavior because <code>private</code> variables in OpenMP are uninitialized. To be precise, they are initialized as if you would have a local variable without an explicit initialization. Which means it is undefined what value they have initially. You observe different behavior on different systems because some combinations of compiler, options, and OS use this \"undefined\" differently. Your code is incorrect in any case, even if it sometimes produces the correct result.</p>\n\n<p>Now you can do this setting to zero as you tried out. However, I would generally suggest to instead <strong>declare variables as local as possible</strong>. This makes reasoning about the (parallel) code much easier, and you can omit the \"private/shared\" declarations. So your code would look like this:</p>\n\n<pre><code>#pragma omp parallel\n{\n    int sumP = 0;\n    #pragma omp for\n    for (int k = 0; k &lt; N; k++) {\n        for (int l = 0; l &lt; N; l++) {\n            if (A[l][k] % 5 == 0 &amp;&amp; A[l][k] != 0) {\n                sumP = sumP + A[k][l];\n                printf(\"numero: %i, pos [%i],[%i] sumP: %i\\n\", A[k][l], k, l, sumP);\n            }\n        }   \n    }\n    #pragma omp critical\n    sum += sumP;\n}\n</code></pre>\n\n<p>In addition to that, there is another way to drastically simplify this code by using a reduction:</p>\n\n<pre><code>#pragma omp parallel for reduction(+:sum)\nfor (int k = 0; k &lt; N; k++) {\n    for (int l = 0; l &lt; N; l++) {\n        if (A[l][k] % 5 == 0 &amp;&amp; A[l][k] != 0) {\n            sum += A[k][l];\n        }\n    }   \n}\n</code></pre>\n\n<p>The compiler will basically do the same thing for you (but better) and the code is much cleaner.</p>\n"}], "owner": {"reputation": 91, "user_id": 9671874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddcb1170089bbfab8483b2011628381a?s=128&d=identicon&r=PG&f=1", "display_name": "Luiz", "link": "https://stackoverflow.com/users/9671874/luiz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 57991274, "answer_count": 2, "score": 1, "last_activity_date": 1568804649, "creation_date": 1568772496, "last_edit_date": 1568791164, "question_id": 57984116, "link": "https://stackoverflow.com/questions/57984116/sum-of-matrix-elements-on-a-parallel-region-resulting-on-wrong-answers-on-openmp", "title": "Sum of matrix elements on a parallel region resulting on wrong answers on OpenMP", "body": "<p>I was doing an activity at my university that requires to populate a matrix of [2000][2000] elements and then calculate the sum of all elements that are multiples of 5 in a parallel way.</p>\n\n<p>At first I tried using a 5 x 5 matrix, I did a parcial sum (sumP) of the elements and them I added all the elements on a variable called Sum into a critical region.</p>\n\n<p>On my university computer the parcial sum was receiving thrash values (like 36501) when the values must be lower than 100; I noted that it only happend on the [0][i] (line zero) of the matrix.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;omp.h&gt;\n\n#define N 5\n\n\nint main() {\n    int i, j, k, l;\n    int sum = 0;\n    int sumP = 0;\n    int A[N][N]; \n    printf(\"sumP : %i\\n\", sumP );\n    printf(\"sum: %i\\n\", sum);\n    #pragma omp parallel shared (A) private (i, j)\n    {\n        #pragma omp for\n        for (i = 0; i &lt; N; i++) {\n            for(j = 0; j &lt; N; j++){\n            A[i][j] = i%5;\n            printf(\"Number: %i, pos[%i][%i]\\n\", A[i][j], i, j);\n            }\n        }\n    }\n\n    #pragma omp parallel shared(A, sum) private (k, l, sumP)\n    {               \n        #pragma omp for\n        for (k = 0; k &lt; N; k++) {\n            for (l = 0; l &lt; N; l++){\n                if (A[l][k] % 5 == 0 &amp;&amp; A[l][k] != 0){\n                sumP = sumP + A[k][l];\n                printf(\"numero: %i, pos [%i],[%i] sumP: %i\\n\", A[k][l], k, l, sumP);\n                }\n            }   \n        }\n        #pragma omp critical\n        sum += sumP;\n\n    }\n        //printf(\"sumP: %i\\n\", sumP);\n        printf(\"sum: %i\\n\", sum);\n\n    return (0);\n}\n</code></pre>\n\n<p>I tested it declaring the value of sumP to 0 between the \"for\" statemants, and it worked:</p>\n\n<pre><code>#pragma omp parallel shared(A, soma) private (k, l, somap2)\n    {               \n        #pragma omp for\n        for (k = 0; k &lt; N; k++) {\n                        sumP = 0;\n            for (l = 0; l &lt; N; l++){\n</code></pre>\n\n<p>when I tested it home it worked without having to declare the sumP as 0 (on the parcial sum \"sumP\"), like I did above, but now the final Sum result is not correct...</p>\n"}, {"tags": ["c", "base-conversion"], "comments": [{"owner": {"reputation": 4073, "user_id": 11498773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79d317da8c76af3f45f63986e9783740?s=128&d=identicon&r=PG&f=1", "display_name": "Mihir", "link": "https://stackoverflow.com/users/11498773/mihir"}, "edited": false, "score": 0, "creation_date": 1568772306, "post_id": 57984042, "comment_id": 102376937, "body": "Just a sidenote, if you try to convert floating pt numbers in future into there corresponding binary or hexa, you may stumble across <a href=\"https://stackoverflow.com/q/2100490/11498773\">this</a>"}, {"owner": {"reputation": 1669, "user_id": 7508077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b4193888717f50e77805498af1435b9?s=128&d=identicon&r=PG&f=1", "display_name": "EsmaeelE", "link": "https://stackoverflow.com/users/7508077/esmaeele"}, "edited": false, "score": 0, "creation_date": 1568774872, "post_id": 57984042, "comment_id": 102377410, "body": "<a href=\"https://www.geeksforgeeks.org/program-decimal-binary-conversion/\" rel=\"nofollow noreferrer\">geeksforgeeks.org/program-decimal-binary-conversion</a>  <a href=\"https://stackoverflow.com/questions/5488377/converting-an-integer-to-binary-in-c\" title=\"converting an integer to binary in c\">stackoverflow.com/questions/5488377/&hellip;</a>"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 1, "creation_date": 1568775281, "post_id": 57984042, "comment_id": 102377489, "body": "A few observations: (1) if you want to store values in your <code>binary</code> array, just use <code>binary[t] = ...</code>.  The extra <code>int</code> on those lines is meaningless and is causing problems. (2) Decide whether you want to print <code>1</code>/<code>0</code> out immediately, or store it in an array; you probably don&#39;t want to do both. (3) If you&#39;re making 32 trips through this loop and filling in the array, you had better make your <code>binary[]</code> array that big, too.  But other than those points, it looks like your code would work.  (For binary conversion, at least.  Hex will be another story.)"}, {"owner": {"reputation": 5397, "user_id": 11294831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M9BL5.png?s=128&g=1", "display_name": "the busybee", "link": "https://stackoverflow.com/users/11294831/the-busybee"}, "edited": false, "score": 1, "creation_date": 1568785736, "post_id": 57984042, "comment_id": 102379863, "body": "1. Please tell us which output on which input you expect and what you get."}, {"owner": {"reputation": 5397, "user_id": 11294831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M9BL5.png?s=128&g=1", "display_name": "the busybee", "link": "https://stackoverflow.com/users/11294831/the-busybee"}, "edited": false, "score": 0, "creation_date": 1568785762, "post_id": 57984042, "comment_id": 102379871, "body": "2. Now that I have edited your code, can you see errors?"}], "owner": {"reputation": 9, "user_id": 10746317, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-T4Bb_Tlhh68/AAAAAAAAAAI/AAAAAAAAAGI/b9_mXCDDz50/photo.jpg?sz=128", "display_name": "We Que", "link": "https://stackoverflow.com/users/10746317/we-que"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1568788565, "creation_date": 1568771990, "last_edit_date": 1568788565, "question_id": 57984042, "link": "https://stackoverflow.com/questions/57984042/convert-number-to-binary-and-hex-in-c", "title": "Convert number to binary and hex in C", "body": "<p>I want to a write a program that converts a number to binary and hex.I tried to do this but It gives me the wrong result</p>\n\n<pre><code>int n, c, k;\nint t = 0;\nint binary[8];\nfor (c = 31; c &gt;= 0; c--) {\n    k = num &gt;&gt; c;\n    if (k &amp; 1) {\n        printf(\"1\");\n        int binary[t] = 1;\n    } else {\n        printf(\"0\");\n        int binary[t] = 0;\n    }\n    ++t;\n}\n</code></pre>\n"}, {"tags": ["python", "c++", "c"], "comments": [{"owner": {"reputation": 25744, "user_id": 2089675, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/sBz5q.jpg?s=128&g=1", "display_name": "smac89", "link": "https://stackoverflow.com/users/2089675/smac89"}, "edited": false, "score": 0, "creation_date": 1568772482, "post_id": 57984004, "comment_id": 102376966, "body": "Are you asking how to write a loop in C?"}, {"owner": {"reputation": 3876, "user_id": 7478455, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/VP5WO.jpg?s=128&g=1", "display_name": "Mohammad Kanan", "link": "https://stackoverflow.com/users/7478455/mohammad-kanan"}, "edited": false, "score": 0, "creation_date": 1568772872, "post_id": 57984004, "comment_id": 102377045, "body": "Note that your match string contains <code>hn</code> ... while switch look for <code>h</code>"}, {"owner": {"reputation": 315, "user_id": 11108086, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e030776b3406912c96405d5786318be?s=128&d=identicon&r=PG&f=1", "display_name": "jerry", "link": "https://stackoverflow.com/users/11108086/jerry"}, "edited": false, "score": 0, "creation_date": 1568772885, "post_id": 57984004, "comment_id": 102377047, "body": "I have edited my question. main.cc file is written such that it picks a single value of h. Should I use for loop to change the value of h? Can I load this main.cc file on new file and then run for loop on new file?"}, {"owner": {"reputation": 25744, "user_id": 2089675, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/sBz5q.jpg?s=128&g=1", "display_name": "smac89", "link": "https://stackoverflow.com/users/2089675/smac89"}, "edited": false, "score": 0, "creation_date": 1568773151, "post_id": 57984004, "comment_id": 102377095, "body": "This can be solved with a short bash script: <code>for h in 0.2 0.8 1.5; do .&#47;a.out -h $h; done</code>"}, {"owner": {"reputation": 3876, "user_id": 7478455, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/VP5WO.jpg?s=128&g=1", "display_name": "Mohammad Kanan", "link": "https://stackoverflow.com/users/7478455/mohammad-kanan"}, "edited": false, "score": 1, "creation_date": 1568773244, "post_id": 57984004, "comment_id": 102377110, "body": "Fllow this example: <a href=\"https://coderwall.com/p/y3xnxg/using-getopt-vs-boost-in-c-to-handle-arguments\" rel=\"nofollow noreferrer\">coderwall.com/p/y3xnxg/&hellip;</a>"}, {"owner": {"reputation": 25744, "user_id": 2089675, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/sBz5q.jpg?s=128&g=1", "display_name": "smac89", "link": "https://stackoverflow.com/users/2089675/smac89"}, "edited": false, "score": 0, "creation_date": 1568773256, "post_id": 57984004, "comment_id": 102377114, "body": "If you don&#39;t want to use a script to run it, why not move all the values of <code>h</code> into an array and then loop over the array. In this case, the <code>h</code> is not coming from command line anymore"}, {"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "reply_to_user": {"reputation": 3876, "user_id": 7478455, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/VP5WO.jpg?s=128&g=1", "display_name": "Mohammad Kanan", "link": "https://stackoverflow.com/users/7478455/mohammad-kanan"}, "edited": false, "score": 0, "creation_date": 1568773429, "post_id": 57984004, "comment_id": 102377146, "body": "@MohammadAKanan: In both C and C++, strings cannot be used to name compile-time variables. In reality, <code>hn:</code> refers to the command line options <code>-h</code> and <code>-n ARG</code>"}, {"owner": {"reputation": 315, "user_id": 11108086, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e030776b3406912c96405d5786318be?s=128&d=identicon&r=PG&f=1", "display_name": "jerry", "link": "https://stackoverflow.com/users/11108086/jerry"}, "edited": false, "score": 0, "creation_date": 1568773493, "post_id": 57984004, "comment_id": 102377160, "body": "I want to write for loop in the new script so that I don&#39;t need to adjust spacing of whole code. But then Im confused that can I load this main.cc file one new.cc file?Is it a correct way"}, {"owner": {"reputation": 25744, "user_id": 2089675, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/sBz5q.jpg?s=128&g=1", "display_name": "smac89", "link": "https://stackoverflow.com/users/2089675/smac89"}, "edited": false, "score": 0, "creation_date": 1568773938, "post_id": 57984004, "comment_id": 102377230, "body": "I see you don&#39;t want to change <code>main.cc</code>, but you still want to test different values of <code>h</code>. Instead of writing a new file called <code>new.cc</code>, you should use the bash script idea I suggested. Does this work for you?"}, {"owner": {"reputation": 315, "user_id": 11108086, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e030776b3406912c96405d5786318be?s=128&d=identicon&r=PG&f=1", "display_name": "jerry", "link": "https://stackoverflow.com/users/11108086/jerry"}, "edited": false, "score": 0, "creation_date": 1568774119, "post_id": 57984004, "comment_id": 102377265, "body": "Yes you got it. Actually I&#39;m not familiar with bash.If possible I want to implement for loop in &quot;new.cc&quot;. Can we da that? Is it a correct day? I&#39;m a newbie in  C++. Just few days ago I started working on it"}, {"owner": {"reputation": 315, "user_id": 11108086, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e030776b3406912c96405d5786318be?s=128&d=identicon&r=PG&f=1", "display_name": "jerry", "link": "https://stackoverflow.com/users/11108086/jerry"}, "edited": false, "score": 0, "creation_date": 1568774286, "post_id": 57984004, "comment_id": 102377306, "body": "First I want using &quot;make &quot;which compiles main.cc file(which is taking one value of h). It seems to me that I need to apply for loop in main.cc. I&#39;m looking for other way so I don&#39;t need to modify main.cc"}, {"owner": {"reputation": 25744, "user_id": 2089675, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/sBz5q.jpg?s=128&g=1", "display_name": "smac89", "link": "https://stackoverflow.com/users/2089675/smac89"}, "edited": false, "score": 0, "creation_date": 1568774436, "post_id": 57984004, "comment_id": 102377326, "body": "You can do it in C++, but because C++ is not primarily a scripting language, you will have get into the murky details of spawning a new process which will call <code>make</code>, then after that process is finished, you spawn more processes in a loop to run your executable with the arguments. Spawning processes in C++ is also platform dependent, so you need to know the platform well enough to do that.  This is why I suggest a scripting language. Since you are not familiar with shell scripting, maybe python?"}, {"owner": {"reputation": 315, "user_id": 11108086, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e030776b3406912c96405d5786318be?s=128&d=identicon&r=PG&f=1", "display_name": "jerry", "link": "https://stackoverflow.com/users/11108086/jerry"}, "edited": false, "score": 0, "creation_date": 1568774570, "post_id": 57984004, "comment_id": 102377353, "body": "No I&#39;m not familiar with shell script. Can I infer from your comment that for loop inside main.cc is the only option?"}, {"owner": {"reputation": 25744, "user_id": 2089675, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/sBz5q.jpg?s=128&g=1", "display_name": "smac89", "link": "https://stackoverflow.com/users/2089675/smac89"}, "edited": false, "score": 1, "creation_date": 1568774641, "post_id": 57984004, "comment_id": 102377371, "body": "I also suggested python but yea a for loop inside <code>main.cc</code> is the easiest option"}, {"owner": {"reputation": 315, "user_id": 11108086, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e030776b3406912c96405d5786318be?s=128&d=identicon&r=PG&f=1", "display_name": "jerry", "link": "https://stackoverflow.com/users/11108086/jerry"}, "edited": false, "score": 0, "creation_date": 1568774696, "post_id": 57984004, "comment_id": 102377386, "body": "In python I know how to load a file using os.sys(&quot;main.cc&quot;)"}, {"owner": {"reputation": 25744, "user_id": 2089675, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/sBz5q.jpg?s=128&g=1", "display_name": "smac89", "link": "https://stackoverflow.com/users/2089675/smac89"}, "reply_to_user": {"reputation": 315, "user_id": 11108086, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e030776b3406912c96405d5786318be?s=128&d=identicon&r=PG&f=1", "display_name": "jerry", "link": "https://stackoverflow.com/users/11108086/jerry"}, "edited": false, "score": 0, "creation_date": 1568774889, "post_id": 57984004, "comment_id": 102377414, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/199593/discussion-between-smac89-and-jerry\">continue this discussion in chat</a>."}], "owner": {"reputation": 315, "user_id": 11108086, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e030776b3406912c96405d5786318be?s=128&d=identicon&r=PG&f=1", "display_name": "jerry", "link": "https://stackoverflow.com/users/11108086/jerry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 85, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1568777886, "creation_date": 1568771660, "last_edit_date": 1568777886, "question_id": 57984004, "link": "https://stackoverflow.com/questions/57984004/how-to-store-the-result-of-running-a-for-loop-in-different-files", "title": "How to store the result of running a for loop in different files?", "body": "<p>I have a main.cc file which I run using different command line argument(one of them is h). I have to assign different values to h. I want to run main.cc file using a for loop picking a different value of h ranging [0.2,0.8,1.5]?. Given h=0.2, I want a new file named \"file_h=0.2\" with the results in that file. Can I run this main.cc file using a script of python and then store the result of each loop in a different file?</p>\n\n<pre><code>#include \"Models.h\"\n#include \"L.h\"\n#include \"o.h\"\n#command line arguments:\nint _seed = 1234567; \ndouble _h = 1.0; \nint _nS = 1; \nint _if = 3; \n\n\nint init(int argc, char* argv[]) {\n\nint c, errflg = 0;\n    while ((c = getopt(argc, argv, \"d:f:hn:s:t:x:w:z:\")) != EOF)\n    switch(c) {\ncase 'f':\n    _if = atoi(optarg);\nbreak\ncase 'h':\n    _h = atof(optarg);\nbreak;\n}\n</code></pre>\n"}, {"tags": ["c", "sockets", "tcp"], "comments": [{"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1568771860, "post_id": 57983971, "comment_id": 102376870, "body": "Unrelated to your current problem, but worth mentioning anyway: your code leaks memory like crazy and has unreachable code."}, {"owner": {"reputation": 13, "user_id": 11024623, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-dzuFNLAgrOE/AAAAAAAAAAI/AAAAAAAAbxc/s7JosAonaK8/photo.jpg?sz=128", "display_name": "Irfan Rafie", "link": "https://stackoverflow.com/users/11024623/irfan-rafie"}, "reply_to_user": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1568772112, "post_id": 57983971, "comment_id": 102376909, "body": "Noted, thanks for the input. I&#39;ll manage the memory and remove unused code."}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 1, "creation_date": 1568780037, "post_id": 57983971, "comment_id": 102378356, "body": "It would be better to have <code>get_uptime()</code> write into a char array supplied by the caller, and get rid of all the <code>malloc()</code>s altogether."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1568880176, "post_id": 57983971, "comment_id": 102417519, "body": "compiling the server code with: <code>gcc -c -Wall -Wextra -Wconversion -pedantic -std=gnu11</code> results in 11 warning messages, of which several are critical.  Also, the posted code for the server is missing the statement: <code>#include &lt;unistd.h&gt;</code>  to expose the prototype for the function: <code>close()</code>  strongly suggest fixing the code, so it cleanly compiles,  Then start working on the problems with the logic of the program"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1568881829, "post_id": 57983971, "comment_id": 102418297, "body": "this statement: <code>output = malloc(sizeof(char) * 1024);</code>  is allocating dynamic memory for a pointer that will be overlayed by the call to: <code>get_uptime()</code>  This results in a memory leak as the pointer to the <code>malloc</code>d memory will be overlayed"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1568881950, "post_id": 57983971, "comment_id": 102418355, "body": "this statement: <code>if( write( consock, output, 1024) &lt; 0 )</code>  causes 1024 bytes to be written to the client, but much of that will be garbage.  Suggest: <code>if( write( consock, output, strlen( output ) ) &lt; 0 )</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1568882220, "post_id": 57983971, "comment_id": 102418490, "body": "in function: <code>get_uptime()</code>, these statements: <code>char *buffer;     buffer = malloc( 1024 );</code>  result in a memory leak and are a total waste of cpu cycles and resources.  Suggest allocating the buffer as: <code>char buffer[1024];</code> in the function that calls <code>get_uptime()</code>  and passing the address of that buffer to the function: <code>get_uptime()</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1568882341, "post_id": 57983971, "comment_id": 102418565, "body": "There is a long list of functions that should not be called in a signal handler.  <code>printf()</code> is one of those functions that should not be called"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1568883122, "post_id": 57983971, "comment_id": 102418972, "body": "the client code is missing the statement: <code>#include &lt;unistd.h&gt;</code> to expose the prototype for the function: <code>read()</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1568883230, "post_id": 57983971, "comment_id": 102419035, "body": "the client code is missing the statements: <code>#include &lt;arpa&#47;inet.h&gt;</code> for the function: <code>inet_addr()</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1568883503, "post_id": 57983971, "comment_id": 102419196, "body": "in the client code: regarding the statement: <code>printf(&quot;Not enough arguments. To run, \\&quot;.&#47;ruptimeClient &lt;localhost_IP&gt; &lt;server_IP&gt;\\&quot;\\n&quot;);</code>  Error messages should be output to <code>stderr</code>, not <code>stdout</code>.  Usually when the command line parameters are not correct, a USAGE statement is output, similar to:    <code>fprintf( stderr,  &quot;USAGE: %s &lt;localhost_IP&gt; &lt;server_IP&gt;\\&quot;\\n&quot;, argv[0] );</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1568883606, "post_id": 57983971, "comment_id": 102419252, "body": "in the code block: <code>if(argc != 3){</code>  The statement: <code>return 0;</code> indicates Success.  But the return is due to an error.  Suggest: <code>return 1;</code>  or better: <code>exit( EXIT_FAILURE );</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1568883816, "post_id": 57983971, "comment_id": 102419373, "body": "in the client code: regarding: <code>if(read(clisock, input_buffer, 100) &lt; 0){</code>  Since the server could be sending a message that is (up to) 1024 bytes in length, that <code>100</code> should be replaced with <code>1024</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1568883925, "post_id": 57983971, "comment_id": 102419430, "body": "The <code>read()</code> function does not NUL terminate the input, so should be saving the returned value from <code>read()</code>  (it has type <code>ssize_t</code>) and then use the statement: <code>input_buffer[ that returned value ] = &#39;\\0&#39;;</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1568884096, "post_id": 57983971, "comment_id": 102419535, "body": "regarding: ` printf(&quot;%s: %s&quot;, SERVER_IP, input_buffer);`  this data will sit in the stream stdout buffer until the program exits.  Much better to include a trailing new line so the data is immediately output to the terminal, similar to: <code>printf(&quot;%s: %s\\n&quot;, SERVER_IP, input_buffer);</code>  Note the addition of the &#39;\\n&#39; to the format string"}], "answers": [{"tags": [], "owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "is_accepted": true, "score": 3, "last_activity_date": 1568771943, "last_edit_date": 1568771943, "creation_date": 1568771585, "answer_id": 57983992, "question_id": 57983971, "link": "https://stackoverflow.com/questions/57983971/tcp-write-prints-char-to-itself-rather-than-to-buffer-only-on-first-socket-co/57983992#57983992", "title": "TCP write() prints char* to itself rather than to buffer only on first socket connection, but works OK on second connection onwards", "body": "<p>The problem is here:</p>\n\n<pre><code>if(consock = accept(sersock, (struct sockaddr *)&amp;clientaddr, &amp;len) &lt; 0){\n</code></pre>\n\n<p>That's parsed as if you wrote this:</p>\n\n<pre><code>if(consock = (accept(sersock, (struct sockaddr *)&amp;clientaddr, &amp;len) &lt; 0)){\n</code></pre>\n\n<p>As a result, <code>consock</code> ends up getting set to <code>0</code>, which when interpreted as a file descriptor, means standard input. This then gets closed after the first client (the one that hangs), so it's available for subsequent clients, which then get reassigned that now-free FD number. To fix it, add explicit parentheses, like this:</p>\n\n<pre><code>if((consock = accept(sersock, (struct sockaddr *)&amp;clientaddr, &amp;len)) &lt; 0){\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1568887999, "post_id": 58007164, "comment_id": 102421659, "body": "Why return the address of the buffer that the caller already knows because he supplied it?"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "reply_to_user": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1568911905, "post_id": 58007164, "comment_id": 102435133, "body": "@user207421,  Not necessary to return the address of the buffer.   I just did that to minimize the changes to the OPs posted code."}], "tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": false, "score": 0, "last_activity_date": 1568882904, "creation_date": 1568882904, "answer_id": 58007164, "question_id": 57983971, "link": "https://stackoverflow.com/questions/57983971/tcp-write-prints-char-to-itself-rather-than-to-buffer-only-on-first-socket-co/58007164#58007164", "title": "TCP write() prints char* to itself rather than to buffer only on first socket connection, but works OK on second connection onwards", "body": "<p>the following proposed code:</p>\n\n<ol>\n<li>is for the server</li>\n<li>cleanly compiles</li>\n<li>does not leak memory</li>\n<li>incorporates the comments to the OPs question</li>\n</ol>\n\n<p>and now, the proposed code for the server:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;sys/sysinfo.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;netinet/in.h&gt;\n#include &lt;signal.h&gt;\n#include &lt;sys/select.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;string.h&gt;\n\n\nchar* get_uptime( char *buffer, int size );\nvoid sig_handl(int sig_num);\nint sersock, consock;\n\n\nint main( void )\n{\n    struct sockaddr_in serveraddr, clientaddr;\n    struct sigaction sigIntHandler;\n    //int on = 1;\n\n    sigIntHandler.sa_handler = sig_handl;\n    sigemptyset(&amp;sigIntHandler.sa_mask);\n    sigIntHandler.sa_flags = 0;\n\n    //char input_buffer[1024] = {0};\n    socklen_t  len = sizeof(clientaddr);\n\n    //char* IP_ADDRESS = \"192.168.254.11\";\n\n    if((sersock = socket(PF_INET, SOCK_STREAM, 0)) &lt; 0)\n    {\n        perror(\"socket() error\");\n        exit(1);\n    }\n\n    serveraddr.sin_family = PF_INET;\n    serveraddr.sin_port = htons(28189);\n    serveraddr.sin_addr.s_addr = htonl(INADDR_ANY);\n\n    if(bind(sersock, (struct sockaddr *)&amp;serveraddr, sizeof(serveraddr)) &lt; 0)\n    {\n        perror(\"bind() error\");\n        exit(1);\n    }\n\n    if(listen(sersock, 10) &lt; 0)\n    {\n        perror(\"listen() error\");\n        exit(1);\n    }\n\n    char *output;\n    int size = 1024;\n    char buffer[ size ];\n\n    signal(SIGINT, sig_handl);\n\n    while(1)\n    {\n        printf(\"Awaiting connection.\\n\");\n        if( (consock = accept(sersock, (struct sockaddr *)&amp;clientaddr, &amp;len)) &lt; 0)\n        {\n            perror(\"accept() error\");\n            exit(1);\n        }\n\n        output = get_uptime( buffer, size );\n\n        if( write( consock, output, strlen( output ) ) &lt; 0 )\n        {\n            perror(\"write() error\");\n            exit(1);\n        }\n\n        printf(\"Write Success\\n\");\n        close(consock);\n    }\n    close(sersock); \n}\n\n\nchar * get_uptime( char *buffer, int size )\n{        //returns uptime on server\n\n    FILE* file = popen(\"uptime\", \"r\");\n    fgets( buffer, size, file );\n    pclose(file);\n\n    return buffer;\n}\n\n\nvoid sig_handl(int sig_num)\n{\n    (void)sig_num;\n    printf(\"Caught Ctrl+C, closing all connections.\\n\");\n    close(consock);\n    close(sersock);\n    exit(0);\n}\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 11024623, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-dzuFNLAgrOE/AAAAAAAAAAI/AAAAAAAAbxc/s7JosAonaK8/photo.jpg?sz=128", "display_name": "Irfan Rafie", "link": "https://stackoverflow.com/users/11024623/irfan-rafie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 1, "accepted_answer_id": 57983992, "answer_count": 2, "score": 1, "last_activity_date": 1568882904, "creation_date": 1568771384, "question_id": 57983971, "link": "https://stackoverflow.com/questions/57983971/tcp-write-prints-char-to-itself-rather-than-to-buffer-only-on-first-socket-co", "title": "TCP write() prints char* to itself rather than to buffer only on first socket connection, but works OK on second connection onwards", "body": "<p>On the first connection to the Server socket by a Client, the Server prints the output to itself, and leaves the Client blocked. But the second Client onwards receives the output from the Server.\nThe buffer that is expected to output to the Client is the server uptime. </p>\n\n<p>Why does this happen, is there a way to immediately send the output to the Client and not block it?</p>\n\n<p>To replicate, run 'ruptimeServer' on one terminal, and run 'ruptimeClient [localIPAddress] [serverIPAddress]'.</p>\n\n<p>Below is an example of the I/O to the Server. </p>\n\n<pre><code>[user@linux-3 Lab2]$ ./ruptimeServer \nAwaiting connection.\n 20:42:05 up 2 days, 17:38,  5 users,  load average: 0.00, 0.01, 0.06  &lt;-- buffer\nWrite Success\nAwaiting connection.\nWrite Success\nAwaiting connection.\nWrite Success\nAwaiting connection.\n^CCaught Ctrl+C, closing all connections.\n</code></pre>\n\n<p>Below is the I/O to the Client.</p>\n\n<pre><code>[user@linux-3 Lab2]$ ./ruptimeClient 127.0.0.1 10.24.87.66\nConnection Success.\n^C\n[user@linux-3 Lab2]$ ./ruptimeClient 127.0.0.1 10.24.87.66\nConnection Success.\n10.24.87.66:  20:42:14 up 2 days, 17:38,  5 users,  load average: 0.00, 0.01, 0.06\n[user@linux-3 Lab2]$ ./ruptimeClient 127.0.0.1 10.24.87.66\nConnection Success.\n10.24.87.66:  20:42:18 up 2 days, 17:38,  5 users,  load average: 0.00, 0.01, 0.06\n</code></pre>\n\n<p>Below is the code for Server.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;sys/sysinfo.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;netinet/in.h&gt;\n#include &lt;signal.h&gt;\n#include &lt;sys/select.h&gt;\n\nchar* get_uptime();\nvoid sig_handl(int sig_num);\nint sersock, consock;\nint main(int argc, char* argv[]){\n    struct sockaddr_in serveraddr, clientaddr;\n    struct sigaction sigIntHandler;\n    int on = 1;\n\n    sigIntHandler.sa_handler = sig_handl;\n    sigemptyset(&amp;sigIntHandler.sa_mask);\n    sigIntHandler.sa_flags = 0;\n\n    char input_buffer[1024] = {0};\n    int len = sizeof(clientaddr);\n\n    char* IP_ADDRESS = \"192.168.254.11\";\n\n    if((sersock = socket(PF_INET, SOCK_STREAM, 0)) &lt; 0){\n        perror(\"socket() error\");\n        exit(1);\n    }\n\n    serveraddr.sin_family = PF_INET;\n    serveraddr.sin_port = htons(28189);\n    serveraddr.sin_addr.s_addr = htonl(INADDR_ANY);\n    if(bind(sersock, (struct sockaddr *)&amp;serveraddr, sizeof(serveraddr)) &lt; 0){\n        perror(\"bind() error\");\n        exit(1);\n    }\n    if(listen(sersock, 10) &lt; 0){\n        perror(\"listen() error\");\n        exit(1);\n    }\n    char *output;\n    output = malloc(sizeof(char) * 1024);\n    signal(SIGINT, sig_handl);\n    while(1){\n        printf(\"Awaiting connection.\\n\");\n        if(consock = accept(sersock, (struct sockaddr *)&amp;clientaddr, &amp;len) &lt; 0){\n            perror(\"accept() error\");\n            exit(1);\n        }\n        output = get_uptime();\n        if(write(consock, output, 1024) &lt; 0){\n            perror(\"write() error\");\n            exit(1);\n        }\n        printf(\"Write Success\\n\");\n        close(consock);\n    }\n    close(sersock); \n}\n\nchar * get_uptime(){        //returns uptime on server\n    char *buffer;\n    buffer = malloc(sizeof(char) * 1024);\n    FILE* file = popen(\"uptime\", \"r\");\n    fgets(buffer, 100, file);\n    pclose(file);\n\n    return buffer;\n}\n\nvoid sig_handl(int sig_num){\n    printf(\"Caught Ctrl+C, closing all connections.\\n\");\n    close(consock);\n    close(sersock);\n    exit(0);\n}\n</code></pre>\n\n<p>Below is the code for Client.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;sys/sysinfo.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;netinet/in.h&gt;\n#include &lt;sys/select.h&gt;\n\nint main(int argc, char* argv[]){\n    if(argc != 3){\n        printf(\"Not enough arguments. To run, \\\"./ruptimeClient &lt;localhost_IP&gt; &lt;server_IP&gt;\\\"\\n\");\n        return 0;\n    }\n    struct sockaddr_in remoteaddr;\n    char input_buffer[100];\n    //input_buffer = malloc(sizeof(char) * 100);\n    int clisock;\n    char* SERVER_IP = argv[2];\n\n    if((clisock = socket(PF_INET, SOCK_STREAM, 0)) &lt; 0){\n        perror(\"socket() error\");\n        exit(1);\n    }\n\n    remoteaddr.sin_family = PF_INET;\n    remoteaddr.sin_port = htons(28189);\n    remoteaddr.sin_addr.s_addr = inet_addr(SERVER_IP);\n\n    if(connect(clisock, (struct sockaddr *)&amp;remoteaddr, sizeof(remoteaddr)) &lt; 0){\n        perror(\"Connection failed\");\n        exit(1);\n    }\n    printf(\"Connection Success.\\n\");\n    if(read(clisock, input_buffer, 100) &lt; 0){\n        perror(\"read() error\");\n        exit(1);\n    }\n    //input_buffer = \"test\";\n    printf(\"%s: %s\", SERVER_IP, input_buffer);\n    close(clisock);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "multidimensional-array"], "comments": [{"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 0, "creation_date": 1568771552, "post_id": 57983893, "comment_id": 102376813, "body": "Your current output is exactly what your <code>printf</code> and inner <code>for</code> loop are written to create. Change the <code>&quot;%c, &quot;</code> in your <code>printf</code> to <code>&quot;%c&quot;</code>, and then after your first <code>}</code> put <code>printf(&quot;,&quot;)</code>."}], "answers": [{"tags": [], "owner": {"reputation": 127, "user_id": 11828342, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-zSvramNOHIY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf94mu2e_JIuNXAl8d5vIsTMYfZRA/photo.jpg?sz=128", "display_name": "boby", "link": "https://stackoverflow.com/users/11828342/boby"}, "is_accepted": true, "score": 0, "last_activity_date": 1568772606, "last_edit_date": 1568772606, "creation_date": 1568772188, "answer_id": 57984066, "question_id": 57983893, "link": "https://stackoverflow.com/questions/57983893/c-printing-characters-of-multi-dimensional-array-in-pairs/57984066#57984066", "title": "c - printing characters of multi-dimensional array in pairs", "body": "<p>add the printf(comma) position check before printing characters might be a solution. the first condition (i > 0) gets rid of the first and last comma. the second condition (j == 0) gets rid of the comma in a line.</p>\n\n<pre><code>int i, j;\nfor (i = 0; i &lt; 4; i++) {\n    for(j = 0; j &lt; 2; j++){\n        if(i &gt; 0 &amp;&amp; j == 0) { // add the print comma condition\n            printf(\",\");\n        }\n        printf(\"%c\", usersAnswers[i][j]);\n    }\n}\n</code></pre>\n\n<p>in short, print the comma before printing the first character in a line except the first line.</p>\n"}], "owner": {"reputation": 3, "user_id": 12081518, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/331bc7c5b607b454dbbc87733b626a76?s=128&d=identicon&r=PG&f=1", "display_name": "Jeremiah", "link": "https://stackoverflow.com/users/12081518/jeremiah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 57984066, "answer_count": 1, "score": 0, "last_activity_date": 1568772606, "creation_date": 1568770665, "last_edit_date": 1568771764, "question_id": 57983893, "link": "https://stackoverflow.com/questions/57983893/c-printing-characters-of-multi-dimensional-array-in-pairs", "title": "c - printing characters of multi-dimensional array in pairs", "body": "<p>So I have a 2D array which holds characters that the user inputs. The user inputs two characters at a time like \"AD\", \"TC\", \"2B\", and \"LM\". I am trying to print the array out so it formats it as \"AD, TC, 2B, LM\" but right now it prints as \"A, D, T, C, 2, B, L, M,\"</p>\n\n<p>I was wondering if there is a way to print the characters 2 by 2 like they were originally inputted by the user? Additionally, I would also like to get rid of the extra comma at the end.</p>\n\n<pre><code>int i, j;\nfor (i = 0; i &lt; 4; i++) {\n    for(j = 0; j &lt; 2; j++){\n        printf(\"%c,\", usersAnswers[i][j]);\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "calculator"], "comments": [{"owner": {"reputation": 2161, "user_id": 334972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f628263a3b0ec5fc3198c21c8ab79f7?s=128&d=identicon&r=PG", "display_name": "Tim", "link": "https://stackoverflow.com/users/334972/tim"}, "edited": false, "score": 0, "creation_date": 1568773568, "post_id": 57983890, "comment_id": 102377174, "body": "What operating system are you using?"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 2, "creation_date": 1568789583, "post_id": 57983890, "comment_id": 102381361, "body": "See <a href=\"https://stackoverflow.com/questions/57842756/why-should-i-always-enable-compiler-warnings\">Why should I always enable compiler warnings?</a>"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1568790062, "post_id": 57983890, "comment_id": 102381571, "body": "<code>printf(&quot;Enter Number One:&quot;,&amp;x);</code> why is there an <code>&amp;</code> before the variable in <code>printf</code>? (they are only used with <code>scanf</code> to get the address of the variable as <code>scanf</code> requires a <i>pointer</i> as the argument to fill."}], "owner": {"reputation": 1, "user_id": 12082365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b19d785787193a2587266ee6b3c7df4?s=128&d=identicon&r=PG&f=1", "display_name": "murmurcats", "link": "https://stackoverflow.com/users/12082365/murmurcats"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 337, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1568851492, "creation_date": 1568770622, "last_edit_date": 1568788909, "question_id": 57983890, "link": "https://stackoverflow.com/questions/57983890/how-to-fix-input-output-error-when-attempting-to-make-a-simple-calculator-in-c", "title": "How to fix &#39;Input/Output error&#39; when attempting to make a simple calculator in C", "body": "<p>New to C and am attempting to make a Calculator for a homework assignment. However, I am running into some problems</p>\n\n<p>So far I have only attempting testing the add option but am still coming up with an Input/Output error when attempting to do so. </p>\n\n<p>I am attempting to make a calculator that looks something like this:</p>\n\n<pre><code>Enter Number One:\nEnter Number Two:\n1-Add\n2-Subtract\n3-Multiply\n4-Divide\n5-Mod\nEnter your choice: \n\nResult=\n</code></pre>\n\n<pre class=\"lang-c prettyprint-override\"><code>int choice, result;\nfloat x,y ;\nint main() {\n    printf(\"Enter Number One:\",&amp;x);\n    scanf(\"%f\",&amp;x);\n    printf(\"Enter Number Two:\",&amp;y);\n    scanf(\"%f\",&amp;y);\n\n    printf(\"1-Add\\n2-Subtract\\n3-Multiply\\n4-Divide\\n5-Mod\\n\");\n    printf(\"Enter your choice:\",&amp;choice);\n    scanf(\"%d\",&amp;choice);\n    if (choice==1) { \n        result=x+y;\n        printf(\"Result=\\n%f+%f=%f\",x,y,result);\n    }\n}\n</code></pre>\n\n<pre><code>Enter Number One:1\nEnter Number Two:2\n1-Add\n2-Subtract\n3-Multiply\n4-Divide\n5-Mod\nEnter your choice:1\nResult=\n0.000000+0.000000=0.000000read from master failed\n                                             : Input/output error\n\nRUN FAILED (exit value 1, total time: 1s)\n</code></pre>\n"}, {"tags": ["c", "linux", "unix"], "comments": [{"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 0, "creation_date": 1568770728, "post_id": 57983888, "comment_id": 102376691, "body": "<code>lseek(fd, 0, SEEK_END)</code> should be enough, no need to involve <code>fstat</code>. Do you have code that creates a file descriptor?"}, {"owner": {"reputation": 1, "user_id": 12082398, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f15741ff7dec97122a23344eb982ed0?s=128&d=identicon&r=PG&f=1", "display_name": "anonymousowl", "link": "https://stackoverflow.com/users/12082398/anonymousowl"}, "reply_to_user": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 0, "creation_date": 1568771603, "post_id": 57983888, "comment_id": 102376824, "body": "no i don&#39;t, unfortunately i don&#39;t know how to :( i&#39;m not sure where to begin actually, but here&#39;s what i have Int f_writeFile = open (\u201cfile.txt\u201d, O_RDWR); Int f_readFile = open. But how would I write a string to the end of the file?"}, {"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 0, "creation_date": 1568771949, "post_id": 57983888, "comment_id": 102376888, "body": "Please edit that code into your question. Do you know how to write a string to the <i>beginning</i> of a file?"}, {"owner": {"reputation": 1, "user_id": 12082398, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f15741ff7dec97122a23344eb982ed0?s=128&d=identicon&r=PG&f=1", "display_name": "anonymousowl", "link": "https://stackoverflow.com/users/12082398/anonymousowl"}, "reply_to_user": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 0, "creation_date": 1568772163, "post_id": 57983888, "comment_id": 102376916, "body": "not sure how to write it to the beginning, without append option unfortunately"}, {"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 0, "creation_date": 1568772264, "post_id": 57983888, "comment_id": 102376931, "body": "How would you do it <i>with</i> the append option?"}, {"owner": {"reputation": 1, "user_id": 12082398, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f15741ff7dec97122a23344eb982ed0?s=128&d=identicon&r=PG&f=1", "display_name": "anonymousowl", "link": "https://stackoverflow.com/users/12082398/anonymousowl"}, "reply_to_user": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 0, "creation_date": 1568772624, "post_id": 57983888, "comment_id": 102376988, "body": "with the append option, you would do: int main() {     FILE *out = fopen(&quot;filename&quot;, &quot;a&quot;);     fprintf(out, &quot;%s&quot;, &quot;aString&quot;);     fclose(out);     return 0;   }"}, {"owner": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "edited": false, "score": 0, "creation_date": 1568781125, "post_id": 57983888, "comment_id": 102378614, "body": "You can use <code>O_RDWR</code> then read the entire file into memory (using <code>fread fscanf</code> etc) and then close the file, Then reopen the file and write the memory data into the file and add the data you want to write."}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1568786562, "post_id": 57983888, "comment_id": 102380149, "body": "Your example code is perplexing at best. Incorrect quoting ensures it won&#39;t compile."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 12082398, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f15741ff7dec97122a23344eb982ed0?s=128&d=identicon&r=PG&f=1", "display_name": "anonymousowl", "link": "https://stackoverflow.com/users/12082398/anonymousowl"}, "edited": false, "score": 0, "creation_date": 1568772906, "post_id": 57984157, "comment_id": 102377052, "body": "Ah okay, that&#39;s what i was thinking actually, but my prof asked us to make this possible"}, {"owner": {"reputation": 8402, "user_id": 4664415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hsfxj.jpg?s=128&g=1", "display_name": "mevets", "link": "https://stackoverflow.com/users/4664415/mevets"}, "reply_to_user": {"reputation": 1, "user_id": 12082398, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f15741ff7dec97122a23344eb982ed0?s=128&d=identicon&r=PG&f=1", "display_name": "anonymousowl", "link": "https://stackoverflow.com/users/12082398/anonymousowl"}, "edited": false, "score": 0, "creation_date": 1568773128, "post_id": 57984157, "comment_id": 102377091, "body": "A long dive into stupid mode could use mandatory file locking, but the whole file locking thing was less well thought out than, uh, I can&#39;t find a local minimum; so file locking is crap and should be avoided unless absolutely necessary!   There, a 30 year unix kernel dude spoke :_"}, {"owner": {"reputation": 1, "user_id": 12082398, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f15741ff7dec97122a23344eb982ed0?s=128&d=identicon&r=PG&f=1", "display_name": "anonymousowl", "link": "https://stackoverflow.com/users/12082398/anonymousowl"}, "edited": false, "score": 0, "creation_date": 1568773289, "post_id": 57984157, "comment_id": 102377124, "body": "yeah i totally understand, but that was the assignment haha, but thanks for the explanation"}], "tags": [], "owner": {"reputation": 8402, "user_id": 4664415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hsfxj.jpg?s=128&g=1", "display_name": "mevets", "link": "https://stackoverflow.com/users/4664415/mevets"}, "is_accepted": false, "score": 1, "last_activity_date": 1568772787, "creation_date": 1568772787, "answer_id": 57984157, "question_id": 57983888, "link": "https://stackoverflow.com/questions/57983888/is-there-a-way-to-write-a-string-to-the-end-of-the-file-without-the-append-optio/57984157#57984157", "title": "Is there a way to write a string to the end of the file without the append option?", "body": "<p>Yes, but no.  O_APPEND has a special attribute that permits multiple processes to write to the file in non-interfering mode.   So, if N independent processes open a file O_APPEND, the writes might be interleaved, but will be coherent.  This is exploited in log files as an example.</p>\n\n<p>If you open the file, lseek to the end, by the time you write(), the end point might have changed and you are over-writing valid data.</p>\n\n<p>In short, if you need to append, use O_APPEND; if you want random access don't.  The same program can open the same file in different modes.</p>\n"}], "owner": {"reputation": 1, "user_id": 12082398, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f15741ff7dec97122a23344eb982ed0?s=128&d=identicon&r=PG&f=1", "display_name": "anonymousowl", "link": "https://stackoverflow.com/users/12082398/anonymousowl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1568786507, "creation_date": 1568770599, "last_edit_date": 1568786507, "question_id": 57983888, "link": "https://stackoverflow.com/questions/57983888/is-there-a-way-to-write-a-string-to-the-end-of-the-file-without-the-append-optio", "title": "Is there a way to write a string to the end of the file without the append option?", "body": "<p>Is there a way to open a file and write any string to the end of the file without using the <code>O_APPEND</code> (append) option when opening the file?</p>\n\n<p>I'm coding in C in a Unix environment for the first time for class. </p>\n\n<p>I know I could use <code>lseek(fd, 0, SEEK_END)</code> to seek the end of the file and <code>fstat()</code> to get the file size, but overall, I'm not sure what my code should be like. </p>\n\n<p>What i have is </p>\n\n<pre><code>int fwrite = open (\u201cabc.txt\u201d, O_RDWR);\nint fread = open\n</code></pre>\n\n<p>Also, this is my first time on Stack Overflow, please guide me</p>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1568770605, "post_id": 57983705, "comment_id": 102376661, "body": "Post the code you have tried to avoid this being a &quot;give me the code&quot; question and too broad."}, {"owner": {"reputation": 2323, "user_id": 8350647, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zJNHD.png?s=128&g=1", "display_name": "Nina", "link": "https://stackoverflow.com/users/8350647/nina"}, "edited": false, "score": 0, "creation_date": 1568772729, "post_id": 57983705, "comment_id": 102377008, "body": "Do you have to use 2d Array? Or can you use a struct?"}], "owner": {"reputation": 11, "user_id": 12082299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0884d423b5b7a716c35f4bbd18a5bcc5?s=128&d=identicon&r=PG&f=1", "display_name": "adam", "link": "https://stackoverflow.com/users/12082299/adam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 23, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1568768596, "creation_date": 1568768596, "question_id": 57983705, "link": "https://stackoverflow.com/questions/57983705/how-to-format-a-char-user-input-individually-into-an-2d-array", "title": "How to format a char user input individually into an 2d array?", "body": "<p>How can I take user input and put each character into a 2d array individually?</p>\n\n<p>for example</p>\n\n<p>user1 enters the char : 9E </p>\n\n<p>i want my array to look like this </p>\n\n<pre><code> -----|---|----|\nuser1 | 9 | E  |\n -----|---|----|\n</code></pre>\n\n<p>I want to be able to reference and use those chars individually for other parts of my program</p>\n"}, {"tags": ["c++", "c", "xcode", "compilation", "linker"], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 8774180, "user_type": "registered", "profile_image": "https://graph.facebook.com/1911968965789311/picture?type=large", "display_name": "Yihan Hu", "link": "https://stackoverflow.com/users/8774180/yihan-hu"}, "edited": false, "score": 0, "creation_date": 1569257818, "post_id": 58022642, "comment_id": 102530052, "body": "This is really helpful! Thank you so much"}], "tags": [], "owner": {"reputation": 115642, "user_id": 299924, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/71fc84230717311db1410d7106273128?s=128&d=identicon&r=PG", "display_name": "trojanfoe", "link": "https://stackoverflow.com/users/299924/trojanfoe"}, "is_accepted": true, "score": 0, "last_activity_date": 1568959704, "creation_date": 1568959704, "answer_id": 58022642, "question_id": 57983699, "link": "https://stackoverflow.com/questions/57983699/correct-workflow-in-xcode-to-avoid-error-duplicate-symbols-for-architecture-x86/58022642#58022642", "title": "Correct workflow in Xcode to avoid error: duplicate symbols for Architecture x86_64", "body": "<p>I think you are confusing Xcode <em>groups</em> and Xcode <em>targets</em>.</p>\n\n<p>Groups are a method of organizing source code within your project (they also create folders in the filesystem), however, crucially to your issue, all the source code is compiled into the same target executable.</p>\n\n<p>I think what you want to do is create multiple targets within the project and this allows you to define which of the source code files belongs to which of the targets.  See <a href=\"https://developer.apple.com/library/archive/documentation/ToolsLanguages/Conceptual/Xcode_Overview/WorkingwithTargets.html\" rel=\"nofollow noreferrer\">this Apple Guide</a> on working with targets.</p>\n\n<p>If you didn't realize, you cannot have multiple copies of the same <em>symbol</em> (method or variable) within a single executable unit (executable or dylib).</p>\n"}], "owner": {"reputation": 65, "user_id": 8774180, "user_type": "registered", "profile_image": "https://graph.facebook.com/1911968965789311/picture?type=large", "display_name": "Yihan Hu", "link": "https://stackoverflow.com/users/8774180/yihan-hu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 58022642, "answer_count": 1, "score": 1, "last_activity_date": 1568959704, "creation_date": 1568768553, "last_edit_date": 1568956486, "question_id": 57983699, "link": "https://stackoverflow.com/questions/57983699/correct-workflow-in-xcode-to-avoid-error-duplicate-symbols-for-architecture-x86", "title": "Correct workflow in Xcode to avoid error: duplicate symbols for Architecture x86_64", "body": "<h2>Background</h2>\n\n<p>Hi, I am learning C++ and new to Xcode. I keep running into the error said in the title and not sure how to fix it. I wonder if learning the correct workflow in Xcode will help me avoid the problem. </p>\n\n<p>Here is my directory:</p>\n\n<h2><img src=\"https://i.imgur.com/5gQZQKP.png\" alt=\"Directory\"></h2>\n\n<p>What I have here is:</p>\n\n<p>Under project <strong>signal</strong>, I firstly created a group named\n<strong>signalMean</strong>, which has some files and it compiles just fine. Then I simply created another group named <strong>signalVariance</strong> under <strong>signal</strong>, copied the exact same files from <strong>signalMean</strong> to this new group. After I added new functions to the main.cpp file and renamed it <strong>signalVariance.cpp</strong>, I kept getting duplicated symbols error when I tried to compile.  </p>\n\n<h2>Code</h2>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>// waveforms.h\nextern double InputSignal_f32_1kHz_15kHz[320];\n</code></pre>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>// waveforms.cpp\n#include \"waveforms.h\"\ndouble InputSignal_f32_1kHz_15kHz[320] =\n{+0.0000000000f, +0.5924659585f, -0.0947343455f,...}\n</code></pre>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>// signalMean.cpp\n#include &lt;iostream&gt;\n#include \"waveforms.h\"\n#define SIG_LENGTH 320\n\ndouble calc_signal_mean(double *sig_src_arr, int sig_length);\ndouble signal_mean;\n\nint main() {\n    //code\n}\ndouble calc_signal_mean(double *sig_src_arr, int sig_length) {\n    //code\n}\n</code></pre>\n\n<h2>Error</h2>\n\n<pre><code>duplicate symbol _InputSignal_f32_1kHz_15kHz in:\n    .../x86_64/waveforms-c8eb105c3a214768b4cffcf6a99ba09ec9961410b041f2905a2df7e9fe06655e.o\n    .../x86_64/waveforms-c8eb105c3a214768b4cffcf6a99ba09e2eac5ae7a592aee13a84d551d65ef983.o\nduplicate symbol _main in:\n    .../x86_64/signalVariance.o\n    .../x86_64/signalMean.o\nduplicate symbol _signal_mean in:\n    .../x86_64/signalVariance.o\n    .../x86_64/signalMean.o\nduplicate symbol __Z16calc_signal_meanPdi in:\n    .../x86_64/signalVariance.o\n    .../x86_64/signalMean.o\nld: 4 duplicate symbols for architecture x86_64\nclang: error: linker command failed with exit code 1 (use -v to see invocation)\n</code></pre>\n\n<h2>Question</h2>\n\n<p>What should be the correct workflow in Xcode to avoid this issus if I want to keep building up the project from the previously written code like this? Each group will represent a different topic/function but they share code from each other and it makes sense to put them under the same project, e.g. <strong>signal</strong>.</p>\n\n<p>I am sorry that this is a lengthy question. I'd really appreciate it if someone can point me to the right direction.</p>\n"}, {"tags": ["c", "linux", "linux-kernel", "linux-device-driver", "smp"], "answers": [{"tags": [], "owner": {"reputation": 41, "user_id": 5921262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UHfNz.jpg?s=128&g=1", "display_name": "xman", "link": "https://stackoverflow.com/users/5921262/xman"}, "is_accepted": false, "score": 4, "last_activity_date": 1601411214, "last_edit_date": 1601411214, "creation_date": 1600166138, "answer_id": 63900056, "question_id": 57983653, "link": "https://stackoverflow.com/questions/57983653/nr-cpu-ids-vs-nr-cpus-in-linux-kernel/63900056#63900056", "title": "nr_cpu_ids vs NR_CPUS in Linux Kernel", "body": "<p><code>nr_cpu_ids</code> is the total number of CPUs or processors in the machine while <code>NR_CPUS</code> is the total number of CPUs the Linux O/S can handle.</p>\n"}], "owner": {"reputation": 3001, "user_id": 2830324, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/8e718abdfd920bb3f66d81bbbb10e80f?s=128&d=identicon&r=PG&f=1", "display_name": "md.jamal", "link": "https://stackoverflow.com/users/2830324/md-jamal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 389, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1601411214, "creation_date": 1568767966, "question_id": 57983653, "link": "https://stackoverflow.com/questions/57983653/nr-cpu-ids-vs-nr-cpus-in-linux-kernel", "title": "nr_cpu_ids vs NR_CPUS in Linux Kernel", "body": "<p>I am trying to understand how many processors are supported by Linux Kernel.</p>\n\n<pre><code>grep NR_CPUS /boot/config-`uname -r`\n</code></pre>\n\n<p>Will give me the maximum number of processors supported by kernel, which I can override using kernel command line parameter nr_cpus.</p>\n\n<p>To find number of online cpus, i can use num_online_cpus() function</p>\n\n<p>Then what is nr_cpu_ids?</p>\n\n<pre><code>#include &lt;linux/kernel.h&gt;\n#include &lt;linux/module.h&gt;\n\nMODULE_LICENSE(\"GPL\");\n\n\nstatic int __init test_hello_init(void)\n{\n    pr_info(\"%s: In init NR_CPUs=%d, nr_cpu_ids=%d\\n\", __func__, NR_CPUS, nr_cpu_ids);\n    pr_info(\"Number of cpus available:%d\\n\", num_online_cpus());\n    return -1;\n}\n\nstatic void __exit test_hello_exit(void)\n{\n    pr_info(\"%s: In exit\\n\", __func__);\n}\n\nmodule_init(test_hello_init);\nmodule_exit(test_hello_exit);\n\n[11548.627338] test_hello_init: In init NR_CPUs=8192, nr_cpu_ids=128\n[11548.627340] Number of cpus available:6\n</code></pre>\n\n<p>What is the difference between NR_CPUs and ncr_cpu_ids. Are they not same?</p>\n"}, {"tags": ["c", "vfork"], "comments": [{"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1568772658, "post_id": 57983580, "comment_id": 102376991, "body": "This doesn&#39;t even compile. Please post a minimal, reproducible example."}], "answers": [{"comments": [{"owner": {"reputation": 8002, "user_id": 1143850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2927fac544c9960cd5433688fe4cae1d?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/1143850/serge"}, "reply_to_user": {"reputation": 91, "user_id": 4065588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09cb237f1b896216958e1c04ef5ff8ca?s=128&d=identicon&r=PG&f=1", "display_name": "Fairy", "link": "https://stackoverflow.com/users/4065588/fairy"}, "edited": false, "score": 0, "creation_date": 1568900647, "post_id": 57984235, "comment_id": 102429037, "body": "Your code, as it is right now, might loop in the <code>while (options)</code> loop forever, not even getting a chance to set the handler or the alarm. Also, it cannot be compiled at all due to syntactic issues.  I updated my answer with a working example."}, {"owner": {"reputation": 91, "user_id": 4065588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09cb237f1b896216958e1c04ef5ff8ca?s=128&d=identicon&r=PG&f=1", "display_name": "Fairy", "link": "https://stackoverflow.com/users/4065588/fairy"}, "edited": false, "score": 0, "creation_date": 1568904333, "post_id": 57984235, "comment_id": 102431362, "body": "won&#39;t the program do nothing when the sleep(10) is executed?"}, {"owner": {"reputation": 91, "user_id": 4065588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09cb237f1b896216958e1c04ef5ff8ca?s=128&d=identicon&r=PG&f=1", "display_name": "Fairy", "link": "https://stackoverflow.com/users/4065588/fairy"}, "edited": false, "score": 0, "creation_date": 1568905048, "post_id": 57984235, "comment_id": 102431751, "body": "I tried the example, but instead of just terminating it logs me out of the linux server and says &quot;connection has been unexpectedly closed, server sent command exit status 143&quot;"}, {"owner": {"reputation": 8002, "user_id": 1143850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2927fac544c9960cd5433688fe4cae1d?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/1143850/serge"}, "reply_to_user": {"reputation": 91, "user_id": 4065588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09cb237f1b896216958e1c04ef5ff8ca?s=128&d=identicon&r=PG&f=1", "display_name": "Fairy", "link": "https://stackoverflow.com/users/4065588/fairy"}, "edited": false, "score": 0, "creation_date": 1568906555, "post_id": 57984235, "comment_id": 102432645, "body": "Now you have to figure out what you want to do. I guess in your case you need to keep a list of all alive children forked and kill them one by one (<code>kill(childpid,SIGTERM)</code>) in the handler, then use <code>_exit(0)</code> or <code>_Exit(0)</code> to exit with a normal status. This would require some programming on your side."}, {"owner": {"reputation": 91, "user_id": 4065588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09cb237f1b896216958e1c04ef5ff8ca?s=128&d=identicon&r=PG&f=1", "display_name": "Fairy", "link": "https://stackoverflow.com/users/4065588/fairy"}, "edited": false, "score": 0, "creation_date": 1568907882, "post_id": 57984235, "comment_id": 102433325, "body": "void handler(int sig) { \texit(0); } void catch_alarm (int sig) { \tint i; \tfor(i=0;i&lt;(length+1);i++) \t{ \t\tif(PID[i]!=0)  \t\t{    kill (PID[i],SIGTERM);}     signal(SIGTERM,handler);  \t} \t//exit(0);  } Just tried this but still gives me error. Here the PID stores the alive children, value is 0 if the child was killed. length is the number of children forked +1 for the parent process"}], "tags": [], "owner": {"reputation": 8002, "user_id": 1143850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2927fac544c9960cd5433688fe4cae1d?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/1143850/serge"}, "is_accepted": false, "score": 0, "last_activity_date": 1568900629, "last_edit_date": 1568900629, "creation_date": 1568773496, "answer_id": 57984235, "question_id": 57983580, "link": "https://stackoverflow.com/questions/57983580/how-to-terminate-a-program-using-sigalrm/57984235#57984235", "title": "How to terminate a program using SIGALRM", "body": "<p>there is only a certain set of function which can be executed safely from a signal handler. And <code>exit</code> is <strong>not</strong> one of them. Neither is <code>printf</code>.</p>\n\n<p>You might able to use the <code>_exit()</code> function instead (with underscore in front). However it will only exit the top-most process, leaving the children running.</p>\n\n<p>You can still kill everything using <code>kill(0, signal)</code>, as here.</p>\n\n<pre><code>void catch_alarm (int sig) {\n   kill(0, SIGTERM);\n}\n</code></pre>\n\n<p>Here is an example of a working poc code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;signal.h&gt;\n\nvoid catch_alarm (int sig) {\n    kill (0,SIGTERM);\n}\n\nvoid forkingfunction()\n{\n    int i;\n    for(i=0;i&lt;4;i++,i++) {\n        pid_t pID = fork();\n        if (pID == 0) { \n            sleep(5);\n            printf(\"\\nchild pid %d\\n\",getpid());\n            exit(EXIT_SUCCESS);\n        }\n        else if (pID &lt; 0) {\n            perror(\"Failed to fork:\");\n        }\n    }\n}\nint main()\n{\n    signal (SIGALRM, catch_alarm);\n    alarm (1);//testing for 0.1 seconds \n    forkingfunction();\n    sleep(10);\n    printf(\"\\nnormal exit\\n\");\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 91, "user_id": 4065588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09cb237f1b896216958e1c04ef5ff8ca?s=128&d=identicon&r=PG&f=1", "display_name": "Fairy", "link": "https://stackoverflow.com/users/4065588/fairy"}, "is_accepted": false, "score": 0, "last_activity_date": 1568908646, "creation_date": 1568908646, "answer_id": 58014882, "question_id": 57983580, "link": "https://stackoverflow.com/questions/57983580/how-to-terminate-a-program-using-sigalrm/58014882#58014882", "title": "How to terminate a program using SIGALRM", "body": "<p>So after spending more than 24 hrs trying to fix this. The solution was actually simple. Keep a global array of PID of children alive +1 for parent PID. before sending the kill(PID, SIGTERM) we have to mention a handler for SIGTERM which sleeps till the process is killed. Thus a graceful exit. </p>\n"}], "owner": {"reputation": 91, "user_id": 4065588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09cb237f1b896216958e1c04ef5ff8ca?s=128&d=identicon&r=PG&f=1", "display_name": "Fairy", "link": "https://stackoverflow.com/users/4065588/fairy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1192, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1568908646, "creation_date": 1568767328, "question_id": 57983580, "link": "https://stackoverflow.com/questions/57983580/how-to-terminate-a-program-using-sigalrm", "title": "How to terminate a program using SIGALRM", "body": "<p>So basically I have 4-5 functions in my program. It is a lot of lines of codes and reading and writing from a file and it could end in an infinite loop (worse case) and I would like to terminate my program if it goes beyond lets say 20 seconds. below code is not working, my program hangs and the OS terminates it for me instead of the program terminating itself. I think the main problem I am having is the alarm is set in the main and when the alarm time limit is reached the process is executing in another function and this is causing the program to shut without closing files and killing child processes. This is what I have for now:</p>\n\n<pre><code>volatile sig_atomic_t keep_going = 1;\n\n/* The signal handler just clears the flag and re-enables itself. */\nvoid\ncatch_alarm (int sig)\n{\n    printf(\"Alarm went off\");\n  exit(EXIT_SUCCESS);\n}\nvoid function1\n{}\nvoid forkingfunction()\n{\nor(i=0;i&lt;size;i++,temp++)\n        {\n\n             pid_t pID = vfork();\n\n               if (pID == 0)                // child\n               { \n                   printf(\"\\nchild pid %d\\n\",getpid());\n                    //open some files and read and write\n                     function1();\n                      exit(EXIT_SUCCESS);\n                       kill(pID,SIGKILL);\n                       }\n               }\n               else if (pID &lt; 0)            // failed to fork\n               {\n                   perror(\"Failed to fork:\");\n               }\n}\nvoid function2\n{\nfunction1();\n}\nint main()\n{\nint options\nwhile(options){\nswitch (options)\n{\ncase 1:\ncase 2:\n}\n}\nsignal (SIGALRM, catch_alarm);\n\n          alarm (0.1);//testing for 0.1 seconds \nfunction1();\n\nreturn 0;\n}\n</code></pre>\n"}, {"tags": ["c", "compilation"], "comments": [{"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1568765235, "post_id": 57983361, "comment_id": 102375773, "body": "You&#39;re under a misconception. The type of the data is not <i>unknown</i> to the executable that is running. It&#39;s unknown to the operating system and CPU, but not to the code that is executing that is using that data. What exactly do you think that programming does that would somehow forget what the contents of its memory contain and what it is doing with that memory?"}, {"owner": {"reputation": 1, "user_id": 11449318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1690ac7200fc82def8d8de1695f6935f?s=128&d=identicon&r=PG&f=1", "display_name": "Bill Mac", "link": "https://stackoverflow.com/users/11449318/bill-mac"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1568766381, "post_id": 57983361, "comment_id": 102375952, "body": "Ken, that is precisely what I am struggling with. If I declare an integer or char or double (or whatever), it is my understanding that the variable is assigned a memory address and the type declaration determines the number of bits that will be read (and represented) in my program."}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1568766575, "post_id": 57983361, "comment_id": 102375973, "body": "The type declaration tells the compiler of your code the number of bits, and that&#39;s all the CPU needs to know. Your own code and compiler know that that address stores a variable of a certain type, and that that type is a certain number of bits. All your code needs to know is that the address points to a certain type (int, for instance); the address in high level compilers is contained in a variable, and you know the name of that variable and that it points to storage to an int."}, {"owner": {"reputation": 1, "user_id": 11449318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1690ac7200fc82def8d8de1695f6935f?s=128&d=identicon&r=PG&f=1", "display_name": "Bill Mac", "link": "https://stackoverflow.com/users/11449318/bill-mac"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1568766914, "post_id": 57983361, "comment_id": 102376016, "body": "But where is the type declaration stored in the final exe if the symbol table is gone? How is the type information saved (known by) the .exe if the type information in the symbol table isn&#39;t saved somewhere?"}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1568767146, "post_id": 57983361, "comment_id": 102376043, "body": "It&#39;s not <i>stored in the final exe</i>. That&#39;s the misconception. What&#39;s stored in the final exe are CPU instructions to operate on data, and data to be operated on. The type information is used by the compiler to generate that code and data."}, {"owner": {"reputation": 1, "user_id": 11449318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1690ac7200fc82def8d8de1695f6935f?s=128&d=identicon&r=PG&f=1", "display_name": "Bill Mac", "link": "https://stackoverflow.com/users/11449318/bill-mac"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1568767437, "post_id": 57983361, "comment_id": 102376106, "body": "To clarify, I&#39;ve been reading about compilation for the past two weeks or so. I&#39;ve read that the symbol table in the object code does not survive compilation. I figure the .exe file can&#39;t operate without type representation, but I can&#39;t find how that is stored in the .exe without a symbol table."}, {"owner": {"reputation": 1, "user_id": 11449318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1690ac7200fc82def8d8de1695f6935f?s=128&d=identicon&r=PG&f=1", "display_name": "Bill Mac", "link": "https://stackoverflow.com/users/11449318/bill-mac"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1568767581, "post_id": 57983361, "comment_id": 102376130, "body": "Ahh... so the CPU instruction set includes type information for specific registers? But if that is built into the CPU, how do various languages have different types? Or are those types manipulated by the compiler into a more limited set used by the CPU registers?"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1568786559, "post_id": 57983361, "comment_id": 102380146, "body": "You should look up the instruction set of your CPU.  That is what it does.  Only those binary instruction codes and data types can be handled.  That is all it can do. Anything more complex HAS to be made up from those  building blocks by, say, a compiler."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11449318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1690ac7200fc82def8d8de1695f6935f?s=128&d=identicon&r=PG&f=1", "display_name": "Bill Mac", "link": "https://stackoverflow.com/users/11449318/bill-mac"}, "edited": false, "score": 0, "creation_date": 1568767925, "post_id": 57983410, "comment_id": 102376191, "body": "Eric, so the compiled machine code replaces the type with size (number of bits) and when more type info is needed beyond the number of bits, the CPU registers are differentiated to handle different types? Where do I go to learn this (or is learning assembler the only real way)?"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 1, "user_id": 11449318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1690ac7200fc82def8d8de1695f6935f?s=128&d=identicon&r=PG&f=1", "display_name": "Bill Mac", "link": "https://stackoverflow.com/users/11449318/bill-mac"}, "edited": false, "score": 0, "creation_date": 1568770271, "post_id": 57983410, "comment_id": 102376591, "body": "@BillMac: No, the CPU registers are not differentiated to handle different types, at least not for integers and pointers, in most processors. As I listed, there are different <b>instructions</b> for different operations, not different registers or different indications in registers. There is an instruction for \u201cmultiply signed integers from registers 3 and 4 and put result in register 6\u201d and a different instruction for \u201cmultiply unsigned integers from registers 3 and 4 and put result in register 6.\u201d The <b>instruction</b> says what to do with the data."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 1, "user_id": 11449318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1690ac7200fc82def8d8de1695f6935f?s=128&d=identicon&r=PG&f=1", "display_name": "Bill Mac", "link": "https://stackoverflow.com/users/11449318/bill-mac"}, "edited": false, "score": 0, "creation_date": 1568770327, "post_id": 57983410, "comment_id": 102376600, "body": "@BillMac: Many processors do have separate registers for floating-point data. Even there, though, the distinction between <code>float</code> and <code>double</code> (and possibly <code>long double</code>) is in the instructions, not in the registers."}], "tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": false, "score": 3, "last_activity_date": 1568765793, "last_edit_date": 1568765793, "creation_date": 1568765437, "answer_id": 57983410, "question_id": 57983361, "link": "https://stackoverflow.com/questions/57983361/how-does-a-compiled-c-executible-know-how-to-represent-a-series-of-bits-at-a-spe/57983410#57983410", "title": "How does a compiled c executible know how to represent a series of bits at a specific memory address?", "body": "<p>The compiler generates machine instructions that does specifically what it wants. (This may be done in multiple steps, generating intermediate code in the compiler\u2019s own language, then turning that into assembly language, then assembling that into machine instructions.)</p>\n\n<p>The machine instructions have specific forms, such as:</p>\n\n<ul>\n<li>Load 32 bits into register 8 from address 1234</li>\n<li>Store 64 bits from register 7 into address 4320.</li>\n<li>Load 32 bits into register 3 from memory 9000 bytes beyond the current program counter.</li>\n<li>Store 8 bits from register 4 into memory 124 bytes beyond the stack pointer.</li>\n<li>Add from register 3 into register 4.</li>\n<li>Compare register 3 to register 4.</li>\n<li>Branch if the last comparison indicating signed greater-than.</li>\n<li>Shift the contents of register 4 right 5 bits (\u201clogically,\u201d filling in zeros).</li>\n<li>Shift the contents of register 4 right 5 bits (\u201carithmetically,\u201d duplicating the sign bit).</li>\n</ul>\n\n<p>So, if your program is reading a <code>char</code> value, the compiler generates an instruction to load 8 bits. If your program is reading an <code>int</code> value, the compiler generates an instruction to load 32 bits (presuming <code>int</code> is 32 bits in your C implementation).</p>\n\n<p>In many instructions, the processor does not need to know what the data type is. Loading 32 bits is loading 32 bits regardless of whether those bits are an <code>int</code> or a pointer. Even when adding signed or unsigned integers, the bit patterns are designed so that one add instruction works for either signed or unsigned integers.</p>\n\n<p>Some instructions need to know the data type. Signed and unsigned integers cannot be compared with the same instructions. For a signed 32-bit <code>int</code>, the bits 0xffffffff represent \u22121, which is less than 0 (bits 0x00000000), but, for an unsigned <code>int</code>, those bits represent 4,294,967,295, which is greater than zero. So, for <code>x &lt; y</code>, the compiler generates one instruction if they are signed and a different instruction if they are unsigned. (Actually, there may be one compare instruction for multiple types of data, but it produces multiple bits indicating various possible results, and another instruction tests those bits and branches according to the results. If the compare instruction is not customized to the data type, then the test-and-branch instruction is.)</p>\n"}], "owner": {"reputation": 1, "user_id": 11449318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1690ac7200fc82def8d8de1695f6935f?s=128&d=identicon&r=PG&f=1", "display_name": "Bill Mac", "link": "https://stackoverflow.com/users/11449318/bill-mac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1568765793, "creation_date": 1568764937, "question_id": 57983361, "link": "https://stackoverflow.com/questions/57983361/how-does-a-compiled-c-executible-know-how-to-represent-a-series-of-bits-at-a-spe", "title": "How does a compiled c executible know how to represent a series of bits at a specific memory address?", "body": "<p>I understand a C variable is replaced with a memory address during compilation and the symbol table with type info does not survive compilation. </p>\n\n<p>I'm trying to understand how data is stored and retrieved (represented) during programming execution. I understand a variable is mapped to a memory address and that my precompiled code designates the type (number of bits and how to read them). But if the type is lost by the time the code is compiled into an executable, how does the machine code (the .exe) know how the size of the data at a specific memory address and how to represent those bits?</p>\n\n<p>I've seen many similar questions asked but the answers are always framed that the CPU doesn't care or know what the series of bits are intended to represent. That, however, isn't exactly what I'm asking. I want to know how the executable program knows the number of bits that are significant and how to read (represent) them if the type (integer, char, double, string, or bit field) is unknown?</p>\n"}, {"tags": ["c", "linux", "linux-kernel", "netfilter"], "comments": [{"owner": {"reputation": 4173, "user_id": 4450651, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/l6IMB.jpg?s=128&g=1", "display_name": "red0ct", "link": "https://stackoverflow.com/users/4450651/red0ct"}, "edited": false, "score": 0, "creation_date": 1568799913, "post_id": 57983349, "comment_id": 102386968, "body": "Which iptables chain do you use?"}, {"owner": {"reputation": 19241, "user_id": 614944, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/f92772ec8a16758d669026f736aa7f0f?s=128&d=identicon&r=PG", "display_name": "daisy", "link": "https://stackoverflow.com/users/614944/daisy"}, "reply_to_user": {"reputation": 4173, "user_id": 4450651, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/l6IMB.jpg?s=128&g=1", "display_name": "red0ct", "link": "https://stackoverflow.com/users/4450651/red0ct"}, "edited": false, "score": 0, "creation_date": 1568799972, "post_id": 57983349, "comment_id": 102387005, "body": "@red0ct It was PRE_ROUTING"}, {"owner": {"reputation": 19241, "user_id": 614944, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/f92772ec8a16758d669026f736aa7f0f?s=128&d=identicon&r=PG", "display_name": "daisy", "link": "https://stackoverflow.com/users/614944/daisy"}, "reply_to_user": {"reputation": 4173, "user_id": 4450651, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/l6IMB.jpg?s=128&g=1", "display_name": "red0ct", "link": "https://stackoverflow.com/users/4450651/red0ct"}, "edited": false, "score": 0, "creation_date": 1568800078, "post_id": 57983349, "comment_id": 102387055, "body": "@red0ct Updated answer with nf register part"}, {"owner": {"reputation": 19241, "user_id": 614944, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/f92772ec8a16758d669026f736aa7f0f?s=128&d=identicon&r=PG", "display_name": "daisy", "link": "https://stackoverflow.com/users/614944/daisy"}, "reply_to_user": {"reputation": 4173, "user_id": 4450651, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/l6IMB.jpg?s=128&g=1", "display_name": "red0ct", "link": "https://stackoverflow.com/users/4450651/red0ct"}, "edited": false, "score": 0, "creation_date": 1568800973, "post_id": 57983349, "comment_id": 102387574, "body": "Tried another chain LOCAL_IN, same result"}], "answers": [{"tags": [], "owner": {"reputation": 4173, "user_id": 4450651, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/l6IMB.jpg?s=128&g=1", "display_name": "red0ct", "link": "https://stackoverflow.com/users/4450651/red0ct"}, "is_accepted": true, "score": 3, "last_activity_date": 1582019291, "last_edit_date": 1582019291, "creation_date": 1568803584, "answer_id": 57990962, "question_id": 57983349, "link": "https://stackoverflow.com/questions/57983349/icmp-hdr-is-wrong-on-centos-6-kernels/57990962#57990962", "title": "icmp_hdr is wrong on CentOS 6 kernels", "body": "<p>There is some difference between mentioned Linux kernels.\nIn 3.10 kernel we can see the transport header setting in <a href=\"https://elixir.bootlin.com/linux/v3.10.108/source/net/ipv4/ip_input.c#L437\" rel=\"nofollow noreferrer\"><code>ip_rcv()</code></a> such way:</p>\n\n<pre><code>skb-&gt;transport_header = skb-&gt;network_header + iph-&gt;ihl*4;\n</code></pre>\n\n<p>So the transport header is already set before <code>NF_INET_PRE_ROUTING</code> hooks.</p>\n\n<p>In 2.6 kernel I see nothing similar up to <a href=\"https://elixir.bootlin.com/linux/v2.6.32.71/source/net/ipv4/ip_input.c#L199\" rel=\"nofollow noreferrer\"><code>ip_local_deliver_finish()</code></a>:</p>\n\n<pre><code>__skb_pull(skb, ip_hdrlen(skb));\n\n/* Points to the IP datagram, just past the header. */\nskb_reset_transport_header(skb);\n</code></pre>\n\n<p>It's just right after <code>NF_INET_LOCAL_IN</code> hooks. So it seems you can't access ICMP-header such a way in mentioned hooks on 2.6.32 kernel. But you can easy make some workaround :)</p>\n"}], "owner": {"reputation": 19241, "user_id": 614944, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/f92772ec8a16758d669026f736aa7f0f?s=128&d=identicon&r=PG", "display_name": "daisy", "link": "https://stackoverflow.com/users/614944/daisy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 57990962, "answer_count": 1, "score": 1, "last_activity_date": 1582019291, "creation_date": 1568764809, "last_edit_date": 1568800060, "question_id": 57983349, "link": "https://stackoverflow.com/questions/57983349/icmp-hdr-is-wrong-on-centos-6-kernels", "title": "icmp_hdr is wrong on CentOS 6 kernels", "body": "<p>I have a simple netfilter module to test icmp_hdr function:</p>\n\n<pre><code>unsigned int hook_func(\n    unsigned int hooknum,\n    struct sk_buff *skb,\n    const struct net_device *in,\n    const struct net_device *out,\n    int (*okfn)(struct sk_buff *))\n{    \n    const struct iphdr *ip_header = ip_hdr(skb);\n    if (ip_header &amp;&amp; ip_header-&gt;protocol == IPPROTO_ICMP)\n    {\n        const struct icmphdr *icmp_header = icmp_hdr(skb);    \n        printk(KERN_INFO \"ICMP type %d\", icmp_header-&gt;type);\n    }\n\n    return NF_ACCEPT;\n}\n\nstatic int __init startup(void)\n{\n    hook_ops.hook     = hook_func;\n    hook_ops.hooknum  = NF_INET_PRE_ROUTING;\n    hook_ops.pf       = PF_INET;\n    hook_ops.priority = NF_IP_PRI_FIRST;\n\n    nf_register_hook(&amp;hook_ops);\n    return 0;\n}\n</code></pre>\n\n<p>Then I start to PING the HOST.</p>\n\n<p>On CentOS 6 (2.6.32-754.12.1.el6.x86_64), he printed ICMP type is always <code>69 (INVALID)</code>.</p>\n\n<p>On CentOS 7 (3.10) the result is <code>ICMP_ECHO (8)</code>, which is correct.</p>\n\n<p>Any ideas? Was there a bug in 2.6.32 kernel?</p>\n"}, {"tags": ["c", "while-loop", "eof", "getchar"], "comments": [{"owner": {"reputation": 100758, "user_id": 1899640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47374ccb28e4b0d2454b64f7b975bc66?s=128&d=identicon&r=PG", "display_name": "that other guy", "link": "https://stackoverflow.com/users/1899640/that-other-guy"}, "edited": false, "score": 2, "creation_date": 1568761385, "post_id": 57983000, "comment_id": 102375107, "body": "I&#39;m guessing you input e.g. 2&lt;Enter&gt;, which is two characters. The first loop reads the <code>2</code>, and the second reads the <code>\\n</code> which causes it to immediately end according to its condition."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1568761514, "post_id": 57983000, "comment_id": 102375139, "body": "Note that the function <code>keyPrompt()</code> does not always return a value \u2014 which means an indeterminate and not readily predictable value is returned when the function reads a newline (or encounters EOF)."}], "answers": [{"tags": [], "owner": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "is_accepted": true, "score": 3, "last_activity_date": 1568761736, "creation_date": 1568761736, "answer_id": 57983060, "question_id": 57983000, "link": "https://stackoverflow.com/questions/57983000/while-getchar-eof-terminating-inconsistently/57983060#57983060", "title": "While GetChar != EOF terminating inconsistently", "body": "<p>Consider what this code does:</p>\n\n<pre><code>int keyPrompt(){\n  /* this prompts the user for the Caesar encryption key */\n  int c;\n  printf(\"Enter key value between 1-9: \");\n  while((c=getchar()) != EOF &amp;&amp; c != '\\n'){\n    return c;\n  }\n}\n</code></pre>\n\n<p>After printing the prompt, it reads an input character.  If that character is an EOF or a newline, it exits the loop and falls off the end of the function (without a return, which leads to undefined behavior if the returned value is not ignored).  If its NOT an EOF or newline, it returns the character.</p>\n\n<p>In no case will the while loop ever actually loop.</p>\n\n<p>Consider what happens if you call this code and enter a key+newline.  The key will be read and returned, and the newline will be left in the input buffer.  Now consider what happens if you call another function like this -- the first thing it will read is the newline left over from the <code>keyPrompt</code> function...</p>\n"}], "owner": {"reputation": 103, "user_id": 4264755, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/82e5aef73642c3f6bd30e44b7011dc1f?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/4264755/john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 57983060, "answer_count": 1, "score": 0, "last_activity_date": 1568761736, "creation_date": 1568761191, "question_id": 57983000, "link": "https://stackoverflow.com/questions/57983000/while-getchar-eof-terminating-inconsistently", "title": "While GetChar != EOF terminating inconsistently", "body": "<p>I have these two blocks of code, the aim of both of which is to get some user inputs, to make a cryptography script. </p>\n\n<pre><code>int keyPrompt(){\n  /* this prompts the user for the Caesar encryption key */\n  int c;\n  printf(\"Enter key value between 1-9: \");\n  while((c=getchar()) != EOF &amp;&amp; c != '\\n'){\n    return c;\n  }\n}\n\nint cryptPrompt(){\n  /* this asks the user whether they want to encrypt or decrypt */\n  int d;\n  printf(\"Do you want to encrypt or decrypt?(E/D): \");\n  while((d=getchar()) != EOF &amp;&amp; d != '\\n'){\n    /*\n    if(d == 'E'){\n      return 1;\n    }\n    else if (d == 'D' ){\n      return -1;\n    }\n    */\n    return d;\n  }\n}\n</code></pre>\n\n<p>The problem I'm having is that when I run the file, the first while loop behaves as I expect it to: I enter a value, hit enter and it goes to the next line. With the second while loop, when it executes the function, it skips asking the user for an input and simply goes straight to the next line of good, not storing any return value.</p>\n\n<p>Any idea why it's doing this?</p>\n"}, {"tags": ["c", "assembly", "x86-64", "att"], "comments": [{"owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 0, "creation_date": 1568758578, "post_id": 57982674, "comment_id": 102374489, "body": "You forgot the instruction and at&amp;t uses src, dst order so it&#39;s <code>mov %rdi, %rdx</code>. Of course any optimizing compiler would remove that because <code>rdx</code> is not used. Also <code>ret rax</code> makes no sense, especially since your code has a <code>return 0</code>. That would be e.g. <code>xor %eax, %eax; ret</code> to zero <code>rax</code> and return."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1568762486, "post_id": 57982674, "comment_id": 102375322, "body": "try it yourself on <a href=\"https://godbolt.org/\" rel=\"nofollow noreferrer\">godbolt.org</a> where you can look at GCC, clang, ICC, or MSVC asm output.  (Also for several non-x86 ISAs)"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1568763232, "post_id": 57982674, "comment_id": 102375436, "body": "Using the function name <code>main()</code> with three integer arguments is not an obvious choice of name \u2014 it is implementation defined what the arguments mean, and most probably actually undefined behaviour.  GCC is likely to complain about an inappropriate signature on the <code>main()</code> function.  Ignoring the issue of function name, the code does nothing with the arguments that affects the state of the computation, and the optimizer might well remove the assignment.  There&#39;s also nothing that ties the variables with names <code>rdi</code>, <code>rsi</code>, and <code>rdx</code> to any of the registers with similar names."}, {"owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 1, "creation_date": 1568764865, "post_id": 57982674, "comment_id": 102375715, "body": "Except the sysv abi calling convention of course, which specifies those registers for those arguments."}, {"owner": {"reputation": 49, "user_id": 10829235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2719c8eca8b417af00e297dc463803dd?s=128&d=identicon&r=PG&f=1", "display_name": "user10829235", "link": "https://stackoverflow.com/users/10829235/user10829235"}, "edited": false, "score": 0, "creation_date": 1568869443, "post_id": 57982674, "comment_id": 102412921, "body": "cleared quite a bit for me, thanks Jonathan"}], "answers": [{"comments": [{"owner": {"reputation": 881859, "user_id": 100297, "user_type": "moderator", "profile_image": "https://www.gravatar.com/avatar/24780fb6df85a943c7aea0402c843737?s=128&d=identicon&r=PG", "display_name": "Martijn Pieters", "link": "https://stackoverflow.com/users/100297/martijn-pieters"}, "edited": false, "score": 0, "creation_date": 1568826199, "post_id": 57982754, "comment_id": 102401577, "body": "If you copied this from <a href=\"https://stackoverflow.com/questions/57982674/is-it-certain-in-which-register-arguments-and-variables-are-stored/57982754#comment102374489_57982674\">Jester&#39;s comment</a> it is common courtesy to give them credit for it. Had you made the post a community wiki post would have helped too."}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "reply_to_user": {"reputation": 881859, "user_id": 100297, "user_type": "moderator", "profile_image": "https://www.gravatar.com/avatar/24780fb6df85a943c7aea0402c843737?s=128&d=identicon&r=PG", "display_name": "Martijn Pieters", "link": "https://stackoverflow.com/users/100297/martijn-pieters"}, "edited": false, "score": 0, "creation_date": 1568829624, "post_id": 57982754, "comment_id": 102402875, "body": "@MartijnPieters Not entirely, but I&#39;ve added a link to it."}], "tags": [], "owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "is_accepted": false, "score": 1, "last_activity_date": 1568829607, "last_edit_date": 1568829607, "creation_date": 1568759011, "answer_id": 57982754, "question_id": 57982674, "link": "https://stackoverflow.com/questions/57982674/is-it-certain-in-which-register-arguments-and-variables-are-stored/57982754#57982754", "title": "is it certain in which register arguments and variables are stored?", "body": "<p>No, it would be translated into:</p>\n\n<pre><code>mov %rdi, %rdx # move %rdi into %rdx\nxor %eax, %eax # zero return value\nret # return\n</code></pre>\n\n<p>Of course, it's more than likely that <code>rdx = rdi</code> (and therefore <code>mov %rdi, %rdx</code>) will be removed by the compiler, because <code>rdx</code> is not used again.</p>\n\n<p>Credit to <a href=\"https://stackoverflow.com/questions/57982674/is-it-certain-in-which-register-arguments-and-variables-are-stored/57982754?noredirect=1#comment102374489_57982674\">@Jester</a> for finding this out before me.</p>\n"}, {"tags": [], "owner": {"reputation": 170455, "user_id": 149341, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/omfTQ.png?s=128&g=1", "display_name": "duskwuff -inactive-", "link": "https://stackoverflow.com/users/149341/duskwuff-inactive"}, "is_accepted": false, "score": 4, "last_activity_date": 1568762369, "creation_date": 1568762369, "answer_id": 57983111, "question_id": 57982674, "link": "https://stackoverflow.com/questions/57982674/is-it-certain-in-which-register-arguments-and-variables-are-stored/57983111#57983111", "title": "is it certain in which register arguments and variables are stored?", "body": "<blockquote>\n  <p>Is it certain in which register arguments and variables are stored?</p>\n</blockquote>\n\n<p>Only at entry and exit of a function.</p>\n\n<p>There is no guarantee as to what registers will be used within a function, even for variables which are parameters to the function. Compilers can (and often will) move variables around between registers to optimize register/stack usage, especially on register-starved architectures like x86.</p>\n\n<p>In this case, a simple assignment operation like <code>rdx = rdi</code> may not compile to any assembly code at all, because the compiler will simply recognize that both values can now be found in the register <code>%rdi</code>. Even for a more complex operation like <code>rdx = rdi + 1</code>, the compiler has the freedom to store the value in any register, not specifically in <code>%rdx</code>. (It may even store the value back to <code>%rdi</code>, e.g. <code>inc %rdi</code>, if it recognizes that the original value is never used afterwards.)</p>\n"}], "owner": {"reputation": 49, "user_id": 10829235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2719c8eca8b417af00e297dc463803dd?s=128&d=identicon&r=PG&f=1", "display_name": "user10829235", "link": "https://stackoverflow.com/users/10829235/user10829235"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 150, "favorite_count": 1, "answer_count": 2, "score": 2, "last_activity_date": 1568829607, "creation_date": 1568758420, "last_edit_date": 1568760044, "question_id": 57982674, "link": "https://stackoverflow.com/questions/57982674/is-it-certain-in-which-register-arguments-and-variables-are-stored", "title": "is it certain in which register arguments and variables are stored?", "body": "<p>I'm still uncertain how registers are being used by the assembler</p>\n\n<p>say I have a program:</p>\n\n<pre><code>int main(int rdi, int rsi, int rdx) {\n\n    rdx = rdi;\n\n    return 0;\n}\n</code></pre>\n\n<p>Would this in assembly be translated into:</p>\n\n<pre><code>movq %rdx, %rdi \n\nret rax;\n</code></pre>\n\n<p>I'm new to AT&amp;T and have hard time predicting when a certain register will be used.\nLooking at this chart from <em>Computer Systems - A programmer's perspective</em>, third edition, R.E. Bryant and D. R. O'Hallaron:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Na2vb.png\" rel=\"nofollow noreferrer\">charter</a></p>\n"}, {"tags": ["c", "scanf", "c11"], "comments": [{"owner": {"reputation": 27, "user_id": 12081951, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfd45ee59d5db5370f552952c5ab5663?s=128&d=identicon&r=PG&f=1", "display_name": "Eysaak", "link": "https://stackoverflow.com/users/12081951/eysaak"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1568757592, "post_id": 57982544, "comment_id": 102374208, "body": "Not entirely sure how to do that. I literally just started this class. I tried to use the scanf function and it spits back scanf&#39;: This function or variable may be unsafe. Consider using scanf_s instead."}, {"owner": {"reputation": 20522, "user_id": 11941443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f27a880243178eedf3abdab24898b335?s=128&d=identicon&r=PG&f=1", "display_name": "walnut", "link": "https://stackoverflow.com/users/11941443/walnut"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1568757701, "post_id": 57982544, "comment_id": 102374252, "body": "@EugeneSh. I don&#39;t see why the number of arguments is wrong. The type is the problem."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 20522, "user_id": 11941443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f27a880243178eedf3abdab24898b335?s=128&d=identicon&r=PG&f=1", "display_name": "walnut", "link": "https://stackoverflow.com/users/11941443/walnut"}, "edited": false, "score": 0, "creation_date": 1568757965, "post_id": 57982544, "comment_id": 102374329, "body": "@uneven_mark I guess it depends on the environment. There is MS specific implementation of it and there is a one proposed in the standard, they are different."}, {"owner": {"reputation": 20522, "user_id": 11941443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f27a880243178eedf3abdab24898b335?s=128&d=identicon&r=PG&f=1", "display_name": "walnut", "link": "https://stackoverflow.com/users/11941443/walnut"}, "edited": false, "score": 0, "creation_date": 1568758038, "post_id": 57982544, "comment_id": 102374350, "body": "@Eysaak The compiler is correct to warn you, however it might be less confusing to go by what you learned in class and/or the intended reading material of the course. Maybe bring up with your instructor what the warning means and how to handle it. In any case you should only use things that you know of what they do. If you don&#39;t, ask about them first."}, {"owner": {"reputation": 20522, "user_id": 11941443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f27a880243178eedf3abdab24898b335?s=128&d=identicon&r=PG&f=1", "display_name": "walnut", "link": "https://stackoverflow.com/users/11941443/walnut"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1568758268, "post_id": 57982544, "comment_id": 102374405, "body": "@EugeneSh. Are you sure you are not confusing it with some other function? I don&#39;t work with anything MS, but <a href=\"https://docs.microsoft.com/en-us/cpp/c-runtime-library/reference/scanf-s-scanf-s-l-wscanf-s-wscanf-s-l?view=vs-2019\" rel=\"nofollow noreferrer\">this doc</a> gives a similar definition as <a href=\"https://en.cppreference.com/w/c/io/fscanf\" rel=\"nofollow noreferrer\">the standard</a>."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 20522, "user_id": 11941443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f27a880243178eedf3abdab24898b335?s=128&d=identicon&r=PG&f=1", "display_name": "walnut", "link": "https://stackoverflow.com/users/11941443/walnut"}, "edited": false, "score": 0, "creation_date": 1568758564, "post_id": 57982544, "comment_id": 102374482, "body": "@uneven_mark Looks like you are right. I guess I confused with the usecase when passing <code>%c</code> or <code>%s</code> which is requiring and additional size parameter."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 20522, "user_id": 11941443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f27a880243178eedf3abdab24898b335?s=128&d=identicon&r=PG&f=1", "display_name": "walnut", "link": "https://stackoverflow.com/users/11941443/walnut"}, "edited": false, "score": 0, "creation_date": 1568763589, "post_id": 57982544, "comment_id": 102375485, "body": "@uneven_mark: scrolling down the page linked at docs.microsoft.com, I find the example (tagged &#39;C&#39;): <code>char c; scanf_s(&quot;%c&quot;, &amp;c, 1);</code> \u2014 you need to provide the length for this, too (because it is legitimate to write <code>char data[10]; scanf_s(&quot;%10c&quot;, data, 10);</code> as null termination is not part of the game when you read characters rather than a string.  Note too that in the MS world, the type of the length is not <code>size_t</code> but <code>unsigned</code> (one of the many key differences between Annex K and the MS archetype), so using <code>sizeof(data)</code> requires a cast."}, {"owner": {"reputation": 20522, "user_id": 11941443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f27a880243178eedf3abdab24898b335?s=128&d=identicon&r=PG&f=1", "display_name": "walnut", "link": "https://stackoverflow.com/users/11941443/walnut"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1568763706, "post_id": 57982544, "comment_id": 102375500, "body": "@JonathanLeffler Yes, but I assumed we were talking about <code>&quot;%d&quot;</code> as used in the question. Maybe this was all a misunderstanding. Anyway good to know that there are differences."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1568763831, "post_id": 57982544, "comment_id": 102375518, "body": "OK \u2014 yes, with <code>%d</code> there is no length needed (@Eysaak).  So, we may be talking at cross-purposes."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1568797197, "post_id": 57982544, "comment_id": 102385312, "body": "Are there compilers actually implementing Annex K now? That is, when dismissing MSVC from the category &quot;C compiler&quot;?"}, {"owner": {"reputation": 4127, "user_id": 4231385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d89a541a4609cafea3957e4cdfcca50f?s=128&d=identicon&r=PG&f=1", "display_name": "cremno", "link": "https://stackoverflow.com/users/4231385/cremno"}, "edited": false, "score": 0, "creation_date": 1568835262, "post_id": 57982544, "comment_id": 102405190, "body": "Btw. this error doesn&#39;t have anything to do with C11/Annex K, etc.: see <a href=\"https://docs.microsoft.com/en-us/cpp/build/reference/rtc-run-time-error-checks\" rel=\"nofollow noreferrer\">/RTC</a>"}], "answers": [{"comments": [{"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "reply_to_user": {"reputation": 27, "user_id": 12081951, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfd45ee59d5db5370f552952c5ab5663?s=128&d=identicon&r=PG&f=1", "display_name": "Eysaak", "link": "https://stackoverflow.com/users/12081951/eysaak"}, "edited": false, "score": 0, "creation_date": 1568759670, "post_id": 57982564, "comment_id": 102374749, "body": "@Eysaak Please upvote and accept this answer if it helped you."}], "tags": [], "owner": {"reputation": 200780, "user_id": 116908, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/54d38793d7a407446999b33b81d607fd?s=128&d=identicon&r=PG", "display_name": "Carl Norum", "link": "https://stackoverflow.com/users/116908/carl-norum"}, "is_accepted": true, "score": 1, "last_activity_date": 1568757475, "creation_date": 1568757475, "answer_id": 57982564, "question_id": 57982544, "link": "https://stackoverflow.com/questions/57982544/how-do-i-fix-a-run-time-error-emitted-by-a-safe-function-from-annex-k/57982564#57982564", "title": "How do I fix a run-time error emitted by a safe function from Annex K?", "body": "<p><code>ch</code> is a variable of type <code>char</code>, but you're trying to read into it using <code>%d</code>, which is the format specifier for an <code>int</code>. That means your <code>scanf</code> writes over extra memory that it shouldn't. Change your declaration of <code>ch</code> to:</p>\n\n<pre><code>int ch;\n</code></pre>\n\n<p>And your program should work fine.</p>\n"}, {"comments": [{"owner": {"reputation": 75299, "user_id": 139746, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/BhJLC.png?s=128&g=1", "display_name": "Pascal Cuoq", "link": "https://stackoverflow.com/users/139746/pascal-cuoq"}, "edited": false, "score": 1, "creation_date": 1568761775, "post_id": 57982567, "comment_id": 102375191, "body": "<code>%hhd</code> expects a <code>signed char*</code>: <a href=\"https://port70.net/~nsz/c/c11/n1570.html#7.21.6.2p11\" rel=\"nofollow noreferrer\">port70.net/~nsz/c/c11/n1570.html#7.21.6.2p11</a>"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1568765153, "post_id": 57982567, "comment_id": 102375760, "body": "Does the MS C runtime library support the C99 length modifiers like <code>%hhd</code>?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1568765599, "post_id": 57982567, "comment_id": 102375843, "body": "@JonathanLeffler I do not think so: <a href=\"https://docs.microsoft.com/en-us/cpp/c-runtime-library/scanf-type-field-characters?view=vs-2019\" rel=\"nofollow noreferrer\">no hh found</a> in MS.  Hmmm certainly not because it is hard to implement."}, {"owner": {"reputation": 4127, "user_id": 4231385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d89a541a4609cafea3957e4cdfcca50f?s=128&d=identicon&r=PG&f=1", "display_name": "cremno", "link": "https://stackoverflow.com/users/4231385/cremno"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1568834970, "post_id": 57982567, "comment_id": 102405085, "body": "@chux: It&#39;s implemented - just not documented. The linked page is the wrong one anyways: for <i>length modifiers</i> see <a href=\"https://docs.microsoft.com/en-us/cpp/c-runtime-library/scanf-width-specification\" rel=\"nofollow noreferrer\">scanf Width Specification</a>."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 2, "last_activity_date": 1568757485, "creation_date": 1568757485, "answer_id": 57982567, "question_id": 57982544, "link": "https://stackoverflow.com/questions/57982544/how-do-i-fix-a-run-time-error-emitted-by-a-safe-function-from-annex-k/57982567#57982567", "title": "How do I fix a run-time error emitted by a safe function from Annex K?", "body": "<p>The <code>%d</code> format specifier expects an <code>int *</code> as a parameter, but you're passing in a <code>char *</code>.  Because a <code>char</code> is smaller than an <code>int</code>, the function will attempt to write more bytes than the variable can hold.  This invokes <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behavior</a> which in your case causes a crash.</p>\n\n<p>Either change the type of <code>ch</code> to <code>int</code>, or use the <code>%hhd</code> format specifier which expects a <code>char *</code>.</p>\n"}], "owner": {"reputation": 27, "user_id": 12081951, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfd45ee59d5db5370f552952c5ab5663?s=128&d=identicon&r=PG&f=1", "display_name": "Eysaak", "link": "https://stackoverflow.com/users/12081951/eysaak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 2, "accepted_answer_id": 57982564, "answer_count": 2, "score": 0, "last_activity_date": 1568761398, "creation_date": 1568757298, "last_edit_date": 1568761398, "question_id": 57982544, "link": "https://stackoverflow.com/questions/57982544/how-do-i-fix-a-run-time-error-emitted-by-a-safe-function-from-annex-k", "title": "How do I fix a run-time error emitted by a safe function from Annex K?", "body": "<p>I am starting out in C and I need to write a program that outputs the ASCII character for a given integer.</p>\n\n<p>This is what I have:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main(void)\n{\n    char ch;\n\n    printf(\"Enter an ASCII code: \");\n    scanf_s(\"%d\", &amp;ch);\n\n    printf(\"The character for %d is %c\\n\", ch, ch);\n}\n</code></pre>\n\n<p>I am getting a run-time error saying that the variable is corrupted, however, the window pops up allowing me to input an integer, and the program gives the correct output.</p>\n\n<p>How do I fix this run-time error?</p>\n"}, {"tags": ["c", "gcc", "clion"], "comments": [{"owner": {"reputation": 200780, "user_id": 116908, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/54d38793d7a407446999b33b81d607fd?s=128&d=identicon&r=PG", "display_name": "Carl Norum", "link": "https://stackoverflow.com/users/116908/carl-norum"}, "edited": false, "score": 0, "creation_date": 1568757094, "post_id": 57982489, "comment_id": 102374055, "body": "Relevant: <a href=\"https://stackoverflow.com/questions/5431941/why-is-while-feof-file-always-wrong\" title=\"why is while feof file always wrong\">stackoverflow.com/questions/5431941/&hellip;</a>"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 5, "creation_date": 1568757247, "post_id": 57982489, "comment_id": 102374109, "body": "If <code>fp</code> is null then you&#39;re not giving a correct filename."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1568757296, "post_id": 57982489, "comment_id": 102374119, "body": "Try using an absolute pathname, the program may not be running in the directory you expect."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1568757343, "post_id": 57982489, "comment_id": 102374129, "body": "There&#39;s nothing wrong with the way you&#39;re opening the file, so the problem has to be with the filename."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9722579"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1568757630, "post_id": 57982489, "comment_id": 102374223, "body": "The program was being executed in a different directory; @Barmar was correct in their assumption."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1568764222, "post_id": 57982489, "comment_id": 102375589, "body": "If only the <code>fopen</code> function provided some way to get an explanation when it failed. Oh well, we can dream."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1568765911, "post_id": 57982489, "comment_id": 102375874, "body": "Nate, good that code had <code>if ((fp = fopen(filename, &quot;r&quot;)) != NULL)</code>, error checking is so worth it."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1568765971, "post_id": 57982489, "comment_id": 102375886, "body": "Aside: change <code>while (!feof(fp)) {             fgets(current_line, 250, fp);</code> to <code>while (fgets(current_line, sizeof current_line fp) {</code>."}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1568965911, "post_id": 57982489, "comment_id": 102450688, "body": "<code>feof(fp)</code> <b>only</b> tells you if you are at eof <b>after</b> a call to a reading stdio routine, so calling it first will make your program fail.  Just do what @chux suggests."}], "owner": {"user_type": "does_not_exist", "display_name": "user9722579"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 92, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1568763991, "creation_date": 1568756986, "last_edit_date": 1568763991, "question_id": 57982489, "link": "https://stackoverflow.com/questions/57982489/why-is-my-file-pointer-always-null-even-with-text-in-it", "title": "Why is my file pointer always NULL, even with text in it?", "body": "<p>I am having trouble opening and parsing a file in C. As of now I am trying to open a file and print out the current line then the next until the program reaches the end of the file. However, the file pointer always returns NULL and does not read the file. </p>\n\n<p>This is my function:</p>\n\n<pre><code>int file_parse() {\n    char filename[100];\n    printf(\"Enter the filename: \");\n    scanf(\"%s\", filename); //Get filename\n    printf(\"\\nYou want to encrypt or decrypt with file: %s\", filename); //Confirm filename\n\n    int origin[27];\n    int final[27];\n\n    FILE *fp;\n\n    if ((fp = fopen(filename, \"r\")) != NULL) {\n        char current_line[250];\n\n        while (!feof(fp)) {\n            fgets(current_line, 250, fp);\n            printf(\"The current line is: %s\", current_line);\n        }\n\n        fclose(fp);\n\n    } else {\n        printf(\"\\nError! Cannot open the specified file.\");\n        exit(EXIT_FAILURE);\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "int", "scanf"], "answers": [{"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1568764176, "post_id": 57982507, "comment_id": 102375578, "body": "Or <code>if (scanf(&quot;%d%d%d&quot;, &amp;intarr[0], &amp;intarr[1], &amp;intarr[2]) != 3) { \u2026oops!\u2026 }</code>, using one call to read all three values, and checking that all three are read successfully.  Using separate inputs, you should use something like: <code>if (scanf(&quot;%d&quot;, &amp;intarr[0]) == 1 &amp;&amp; scanf(&quot;%d&quot;, &amp;intarr[1]) == 1 &amp;&amp; scanf(&quot;%d&quot;, &amp;intarr[2]) == 1) { \u2026three values read OK\u2026 } else { \u2026at least failed\u2026 }</code>.  Or use a <code>for</code> loop to read one value at a time."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1568820029, "post_id": 57982507, "comment_id": 102398632, "body": "@JonathanLeffler Yeah, there are lots of ways to do it better, but this isn&#39;t <a href=\"https://codereview.stackexchange.com\">Code Review</a>. So I kept it similar to the original code."}], "tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": true, "score": 2, "last_activity_date": 1568820099, "last_edit_date": 1568820099, "creation_date": 1568757046, "answer_id": 57982507, "question_id": 57982450, "link": "https://stackoverflow.com/questions/57982450/using-scanned-in-variables-to-initialize-an-integer-array-in-c/57982507#57982507", "title": "Using Scanned-In Variables to Initialize an Integer Array in C", "body": "<p>You're using <code>num1</code>, <code>num2</code>, and <code>num3</code> to initialize the array before you fill in the variables with <code>scanf()</code>. You have to scan into the variables first, then assign them to the array.</p>\n\n<pre><code>int num1;\nint num2;\nint num3;\n\nprintf(\"Enter 3 numbers.\\n\");\nscanf(\"%d\", &amp;num1);\nscanf(\"%d\", &amp;num2);\nscanf(\"%d\", &amp;num3);\n\nint intarr[3] = {num1, num2, num3};\n</code></pre>\n\n<p>You should enable full warnings from your compiler, it probably would have warned that you were using variables before initializing them. See <a href=\"https://stackoverflow.com/questions/57842756/why-should-i-always-enable-compiler-warnings\">Why should I always enable compiler warnings?</a></p>\n\n<p>You could also skip the variables entirely, and just scan directly into the array.</p>\n\n<pre><code>printf(\"Enter 3 numbers.\\n\");\nint intarr[3];\nscanf(\"%d\", &amp;intarr[0]);\nscanf(\"%d\", &amp;intarr[1]);\nscanf(\"%d\", &amp;intarr[2]);\n</code></pre>\n"}], "owner": {"reputation": 69, "user_id": 12081908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1c855a4172e13112ae53ed260d0de7d?s=128&d=identicon&r=PG&f=1", "display_name": "sine_nomine", "link": "https://stackoverflow.com/users/12081908/sine-nomine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 57982507, "answer_count": 1, "score": 1, "last_activity_date": 1568820099, "creation_date": 1568756670, "question_id": 57982450, "link": "https://stackoverflow.com/questions/57982450/using-scanned-in-variables-to-initialize-an-integer-array-in-c", "title": "Using Scanned-In Variables to Initialize an Integer Array in C", "body": "<p>I'm trying to initialize an integer array with variables that have scanned in values in C. The values in the array do not match what I scanned in.  It stores weird numbers like -1040000000 or 37299 in the array instead.<br>\nAny help would be much appreciated, I'm pretty new to programming!</p>\n\n<pre><code>int num1;\nint num2;\nint num3;\n\nint intarr[3] = {num1, num2, num3};\n\nprintf(\"Enter 3 numbers.\\n\");\nscanf(\"%d\", &amp;num1);\nscanf(\"%d\", &amp;num2);\nscanf(\"%d\", &amp;num3);\n</code></pre>\n\n<p>There are no error messages, but the numbers aren't what I inputted. For example, I scanned in numbers 1, 2, 3. And when I printed out the values at each index of my array, it printed out weird numbers like I stated above.</p>\n"}, {"tags": ["c", "linux", "routing", "ioctl"], "comments": [{"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 2, "creation_date": 1568757704, "post_id": 57982213, "comment_id": 102374253, "body": "Did you post <a href=\"https://stackoverflow.com/q/57959731/9952196\">this question</a> earlier from a different account? Or just in the same class or something? Might want to compare notes."}, {"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "reply_to_user": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1568772790, "post_id": 57982213, "comment_id": 102377019, "body": "@Shawn almost certainly the same person with 2 accounts, given that both names are from mashing the left hand&#39;s home row keys."}], "owner": {"reputation": 11, "user_id": 10892441, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9f2b7e426f8829ee0f25eabccdf7d90?s=128&d=identicon&r=PG&f=1", "display_name": "Asdas", "link": "https://stackoverflow.com/users/10892441/asdas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 559, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1568757928, "creation_date": 1568755246, "last_edit_date": 1568757928, "question_id": 57982213, "link": "https://stackoverflow.com/questions/57982213/how-to-add-route-programmatically-in-c-using-ioctl", "title": "How to add route programmatically in C using ioctl?", "body": "<p>I want to add some route to routing table. This command works perfectly from terminal: </p>\n\n<pre><code>sudo ip ro add 10.0.0.6 via 192.168.30.1\n</code></pre>\n\n<p>If I check \"ip route\", I see, that route was added.\nI want to implement the same command in C using ioctl. I wrote this function:</p>\n\n<pre><code>void addRoute()\n{\n    int fd = socket( PF_INET, SOCK_DGRAM,  IPPROTO_IP);\n\n    struct rtentry route;\n    memset( &amp;route, 0, sizeof( route ) );\n\n    struct sockaddr_in addr = (struct sockaddr_in )&amp;route.rt_gateway;\n    addr-&gt;sin_family = AF_INET;\n    addr-&gt;sin_addr.s_addr = inet_addr( \"10.0.0.6\" );\n\n    addr = (struct sockaddr_in*) &amp;route.rt_dst;\n    addr-&gt;sin_family = AF_INET;\n    addr-&gt;sin_addr.s_addr = inet_addr( \"192.168.30.1\" );\n\n    addr = (struct sockaddr_in*) &amp;route.rt_genmask;\n    addr-&gt;sin_family = AF_INET;\n    addr-&gt;sin_addr.s_addr = INADDR_ANY;\n\n    route.rt_flags = RTF_UP | RTF_HOST;\n    route.rt_metric = 0;\n\n    if (ioctl( fd, SIOCADDRT, &amp;route ) &lt; 0)\n    {\n        printf(\"ioctl failed and returned errno %s \\n\", strerror(errno));\n    }\n    close( fd );\n}\n\nint main()\n{\n    addRoute();\n    return 0;\n}\n</code></pre>\n\n<p>unfortunately, after executing I always see the error:</p>\n\n<pre><code>    ioctl failed and returned errno Network is unreachable \n</code></pre>\n\n<p>Could you review my code, please ? What have I forgotten to add to my function ?</p>\n"}, {"tags": ["c", "struct", "arm", "microcontroller", "unions"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1568755470, "post_id": 57982198, "comment_id": 102373601, "body": "Because you don&#39;t give the structure in the union any tag name, you can&#39;t check what size the structure has.  The <code>enum</code> types might be bigger than you think; they could be <code>int</code> by any other name.  There could be other places where there&#39;s padding that you didn&#39;t expect.  I recommend adding a tag (<code>struct config {</code> perhaps, instead of just <code>struct {</code>), and then you check <code>sizeof(struct config)</code> and maybe print <code>offsetof(struct config, switchbrt_default)</code> and so on for each of the members.  With that information, you will have a better basis for thinking about where the flaw is."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1568755543, "post_id": 57982198, "comment_id": 102373620, "body": "Don&#39;t use <code>enum</code> if you need fine control over the size of the element. Stick with types like <code>uint8_t</code> and <code>uint16_t</code>."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1568755571, "post_id": 57982198, "comment_id": 102373628, "body": "You may also have padding at the tail of the structure \u2014 it will probably be a multiple of 4 bytes to ensure that the <code>float</code> members are properly aligned.  That may not matter to you.  Even without the structure tag, printing <code>sizeof(backlightconfig_t)</code> may give you some useful information (it probably won&#39;t be 31)."}, {"owner": {"reputation": 410, "user_id": 2984276, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/180c5a88cbee9133a8ac923388612c0e?s=128&d=identicon&r=PG&f=1", "display_name": "K_Trenholm", "link": "https://stackoverflow.com/users/2984276/k-trenholm"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1568764541, "post_id": 57982198, "comment_id": 102375652, "body": "@Jonathan Leffler I will definitely try tagging the struct and see what happens, good idea.  You&#39;re probably right, I may be assuming too much about the size."}, {"owner": {"reputation": 410, "user_id": 2984276, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/180c5a88cbee9133a8ac923388612c0e?s=128&d=identicon&r=PG&f=1", "display_name": "K_Trenholm", "link": "https://stackoverflow.com/users/2984276/k-trenholm"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1568764881, "post_id": 57982198, "comment_id": 102375718, "body": "@Barmar I had thought enum will allocate the minimum size for the elements of the enum?  Is that just a bad assumption I am making? -fshort-enums I thought would ensure this but it didn&#39;t seem to do anything unfortunately."}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1568772813, "post_id": 57982198, "comment_id": 102377024, "body": "that is not how unions work in the first place. so you are out of spec, if you get it to work great.  but if it breaks in the future then dont be surprised.  memcpy to the struct not the union. (once you solve the other problems mentioned).  Unless the data is from another compile domain then that isnt supported either and a bad idea as well."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1568783088, "post_id": 57982198, "comment_id": 102379094, "body": "I wonder how you have arrived at the number 31. Are you familiar with <code>sizeof</code>?"}, {"owner": {"reputation": 5703, "user_id": 1401213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccb697eb985c37893ed06f3c3324c7c8?s=128&d=identicon&r=PG&f=1", "display_name": "kkrambo", "link": "https://stackoverflow.com/users/1401213/kkrambo"}, "edited": false, "score": 1, "creation_date": 1568807528, "post_id": 57982198, "comment_id": 102391193, "body": "You&#39;re asking about <a href=\"https://en.wikipedia.org/wiki/Serialization\" rel=\"nofollow noreferrer\">Serialization</a> and you have fallen into one of the pitfalls of doing serialization with memcpy().  <a href=\"https://stackoverflow.com/a/48830425/1401213\">This answer</a> has more information.  Also search for Serialization to find more advice."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1568820272, "post_id": 57982198, "comment_id": 102398771, "body": "@old_timer It&#39;s common for embedded programming to depend on behaviors that are unspecified or undefined in the spec. Portability is not generally a concern when programming a microcontroller."}], "answers": [{"comments": [{"owner": {"reputation": 8600, "user_id": 450758, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2ccb382a98f56c846d0e064f44920dc?s=128&d=identicon&r=PG", "display_name": "marko", "link": "https://stackoverflow.com/users/450758/marko"}, "edited": false, "score": 0, "creation_date": 1568796230, "post_id": 57983367, "comment_id": 102384780, "body": "This is no silver bullet - particularly if unaligned loads/stores are non available (or are, but expensive).   If the struct is overlaid on memory mapped IO, it almost certainly won&#39;t work as intended.   It&#39;s not portable either.   Explained in other answers to this question."}], "tags": [], "owner": {"reputation": 1, "user_id": 12082179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2f30b2a9d329f50f3dcb638ada3ac4e?s=128&d=identicon&r=PG&f=1", "display_name": "Stephen Ing", "link": "https://stackoverflow.com/users/12082179/stephen-ing"}, "is_accepted": false, "score": -1, "last_activity_date": 1568773780, "last_edit_date": 1568773780, "creation_date": 1568765016, "answer_id": 57983367, "question_id": 57982198, "link": "https://stackoverflow.com/questions/57982198/copying-byte-array-into-a-union-struct-in-c-what-is-throwing-my-alignment-off/57983367#57983367", "title": "Copying byte array into a union/struct in C: What is throwing my alignment off?", "body": "<p>Try surrounding your union with <code>#pragma pack(1)</code>/<code>#pragma pack()</code></p>\n\n<pre><code>#pragma pack(1)\ntypedef union {\n    struct{\n        uint16_t        num_steps;          //2\n        uint8_t         iadj_day;           //1\n        uint8_t         iadj_night;         //1\n        float           min_dc_day;         //4\n        float           min_dc_night;       //4\n        float           max_dc_day;         //4\n        float           max_dc_night;       //4\n        daymode_t       daymode_default;    //1\n        bool            daymode_recall;     //1\n        startbrtmode_t  startbrt_default;   //1\n        uint16_t        startbrt_step;      //2\n        switchbrtmode_t switchbrt_default;  //1\n        uint16_t        day_switchstep;     //2\n        uint16_t        night_switchstep;   //2\n        bool            nonlinear;          //1\n    };\n    uint8_t bytes[BACKLIGHT_CONFIG_SIZE];\n} backlightconfig_t;\n#pragma pack()\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 410, "user_id": 2984276, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/180c5a88cbee9133a8ac923388612c0e?s=128&d=identicon&r=PG&f=1", "display_name": "K_Trenholm", "link": "https://stackoverflow.com/users/2984276/k-trenholm"}, "edited": false, "score": 0, "creation_date": 1568817192, "post_id": 57983462, "comment_id": 102396902, "body": "Nailed it, doing an offsetof() of all the structure members revealed the issue, and it&#39;s inserting a padding byte right where you said it would.  I believe I can force alignment via preprocessor like you suggest, and see if there&#39;s a performance hit I need to worry about.  Otherwise I&#39;ll just have to parse the members manually from my incoming data.  Thanks for the answer!"}], "tags": [], "owner": {"reputation": 124806, "user_id": 121747, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/9fcebb68b105446c0d9eebbce1146044?s=128&d=identicon&r=PG&f=1", "display_name": "Jack", "link": "https://stackoverflow.com/users/121747/jack"}, "is_accepted": true, "score": 3, "last_activity_date": 1568766293, "last_edit_date": 1568766293, "creation_date": 1568765973, "answer_id": 57983462, "question_id": 57982198, "link": "https://stackoverflow.com/questions/57982198/copying-byte-array-into-a-union-struct-in-c-what-is-throwing-my-alignment-off/57983462#57983462", "title": "Copying byte array into a union/struct in C: What is throwing my alignment off?", "body": "<p>That's because you have no guarantees about how fields are aligned or padded inside a struct. <code>startbrt_step</code> is a <code>uint16_t</code> field so, on some architectures, it may require a 2 bytes alignment for example.</p>\n\n<p>Assuming that <code>offsetof(backlightconfig_t, startbrt_default) == 22</code> like you assumed, then <code>startbrt_step</code> would start at 23th byte which is not aligned on 2 bytes boundary so a byte of padding is inserted.</p>\n\n<pre><code>--------------------------\n 22     startbrt_default\n--------------------------\n 23     * padding *\n--------------------------\n 24     startbrt_step\n--------------------------\n</code></pre>\n\n<p>If you put all 2 bytes field after the float fields you could probably solve the problem, but the solution is fragile in any case.</p>\n\n<p>You can enforce alignment to 1 byte boundary with some preprocessor macros but this is not guaranteed to work on some architectures (some ARM abort if you try to access unaligned memory) or it could add performance penalty.</p>\n"}, {"tags": [], "owner": {"reputation": 48201, "user_id": 1250772, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/633e1f643d2c9b043231b4a32b078907?s=128&d=identicon&r=PG", "display_name": "Kaz", "link": "https://stackoverflow.com/users/1250772/kaz"}, "is_accepted": false, "score": 0, "last_activity_date": 1568770491, "last_edit_date": 1568770491, "creation_date": 1568769675, "answer_id": 57983792, "question_id": 57982198, "link": "https://stackoverflow.com/questions/57982198/copying-byte-array-into-a-union-struct-in-c-what-is-throwing-my-alignment-off/57983792#57983792", "title": "Copying byte array into a union/struct in C: What is throwing my alignment off?", "body": "<p>The mistake in your spreadsheet is that <code>enum</code>s do not simply use the narrowest type that will contain their values. According to the GCC manual, the integer type compatible with an <code>enum</code> is <code>unsigned int</code> if there are no negative values, otherwise <code>int</code>. </p>\n\n<p>If using four bytes for a small <code>enum</code> is unacceptable, declare that field with an appropriate integer type instead and just use the <code>enum</code> for the constants that it provides. Be careful that all your constants are in range of that type.</p>\n\n<p>(Modern) C++ allows <code>enum</code> declarations to specify the base integer type that they use, so there is less guesswork; if you want a byte-sized enum, you can ask for that in C++.</p>\n\n<p>Your MODE DFLT variable #20 probably only looks right to you because the system is little endian, and so the least significant byte of the <code>enum</code> is at the right offset. Moreover, you probably tested with zero values of the two variables that follow, MODE RECALL and START BRT DFLT so you didn't notice their effect on MODE DFLT.</p>\n\n<p>If you're not sure about offsets, make a test program which prints the offset and size every structure member:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;time.h&gt;\n#include &lt;stddef.h&gt;\n\n/* typeof is a GCC extension */\n\n#define OFSZ(type, memb) (printf(\"%s: size = %d, offset = %d\\n\", \\\n                                 #memb,\\\n                                 (int) sizeof(typeof(((type *) 0)-&gt;memb)),\\\n                                 (int) offsetof(type, memb)))\n\n\nint main()\n{\n  OFSZ(struct tm, tm_year);\n  OFSZ(struct tm, tm_sec);\n  return 0;\n}\n\n$ ./ofs\ntm_year: size = 4, offset = 20\ntm_sec: size = 4, offset = 0\n</code></pre>\n"}], "owner": {"reputation": 410, "user_id": 2984276, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/180c5a88cbee9133a8ac923388612c0e?s=128&d=identicon&r=PG&f=1", "display_name": "K_Trenholm", "link": "https://stackoverflow.com/users/2984276/k-trenholm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 277, "favorite_count": 1, "accepted_answer_id": 57983462, "answer_count": 3, "score": 0, "last_activity_date": 1568773780, "creation_date": 1568755162, "question_id": 57982198, "link": "https://stackoverflow.com/questions/57982198/copying-byte-array-into-a-union-struct-in-c-what-is-throwing-my-alignment-off", "title": "Copying byte array into a union/struct in C: What is throwing my alignment off?", "body": "<p>I'm working on some code for a PSoC5LP Microcontroller (ARM Cortex-M3) that takes in an array of bytes from the serial port and save them to a structure full of configuration variables.  I seem to be running into a problem with alignment and I can't figure out what the root cause is.</p>\n\n<p>The structure I'm working with (as well as the enums I am using) are defined as follows:</p>\n\n<pre><code>typedef enum{\n    MODE_NIGHT = 0x00,\n    MODE_DAY = 0x01,\n    MODE_DUAL = 0x02\n}daymode_t;\n\ntypedef enum{\n    BRT_MIN = 0x00,\n    BRT_MAX = 0x01,\n    BRT_CUSTOM = 0x02,\n    BRT_RECALL = 0x03\n} startbrtmode_t;\n\ntypedef enum{\n    SWITCH_MIN = 0x00,\n    SWITCH_MAX = 0x01,\n    SWITCH_RECALL = 0x02,\n    SWITCH_CUSTOM = 0x03,\n    SWITCH_EQUAL = 0x04\n} switchbrtmode_t;\n\n#define BACKLIGHT_CONFIG_SIZE   31\ntypedef union {\n    struct{\n        uint16_t        num_steps;          //2\n        uint8_t         iadj_day;           //1\n        uint8_t         iadj_night;         //1\n        float           min_dc_day;         //4\n        float           min_dc_night;       //4\n        float           max_dc_day;         //4\n        float           max_dc_night;       //4\n        daymode_t       daymode_default;    //1\n        bool            daymode_recall;     //1\n        startbrtmode_t  startbrt_default;   //1\n        uint16_t        startbrt_step;      //2\n        switchbrtmode_t switchbrt_default;  //1\n        uint16_t        day_switchstep;     //2\n        uint16_t        night_switchstep;   //2\n        bool            nonlinear;          //1\n    };\n    uint8_t bytes[BACKLIGHT_CONFIG_SIZE];\n} backlightconfig_t;\n</code></pre>\n\n<p>The idea being that I can (after validating the reception via CRC) simply memcpy() the received bytes right into the struct thanks to the union:</p>\n\n<pre><code>backlightconfig_t bl_in;\nmemcpy(bl_in.bytes, message_in, BACKLIGHT_CONFIG_SIZE);\n</code></pre>\n\n<p>However when I do this, I wind up with some seemingly \"shifted\" values.  I made a spreadsheet for tracking what byte goes where, what I'm receiving, and where it's ending up:</p>\n\n<p><a href=\"https://i.stack.imgur.com/T24Zb.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/T24Zb.png\" alt=\"enter image description here\"></a></p>\n\n<p>What I'm seeing is that it looks like my bytes after the startbrtmode_t enum are off.  My 0x0005 meant for startbrt_step looks like it's getting eaten entirely (I confirmed it is present in the bytes array via debugger, but it doesn't show up in the struct member)?  I've had no luck in figuring out why this is happening.  I thought it may have been the compiler (ARM GCC 5.4-2016) reserving too much space for the enum, but sizeof(startbrtmode_t) returns 1.  I'm actually already doing this with no issues with a different struct/union, but that's a structure filled entirely with single bytes, so I figure it must be something having to do with typing? Any thoughts as to what's going on would be greatly appreciated!</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["c", "sockets", "stress-testing"], "comments": [{"owner": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "edited": false, "score": 0, "creation_date": 1568753781, "post_id": 57981377, "comment_id": 102373017, "body": "Side note: Don&#39;t run your stuff as root ... use a user account."}, {"owner": {"reputation": 965, "user_id": 4040743, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/hAIWy.jpg?s=128&g=1", "display_name": "Pete", "link": "https://stackoverflow.com/users/4040743/pete"}, "reply_to_user": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "edited": false, "score": 0, "creation_date": 1568827676, "post_id": 57981377, "comment_id": 102402134, "body": "@DanielJour Yes, that&#39;s a great point.  Good catch, will be sure to do.  :)"}], "answers": [{"comments": [{"owner": {"reputation": 965, "user_id": 4040743, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/hAIWy.jpg?s=128&g=1", "display_name": "Pete", "link": "https://stackoverflow.com/users/4040743/pete"}, "edited": false, "score": 0, "creation_date": 1568827647, "post_id": 57981496, "comment_id": 102402122, "body": "For those following this thread:  I added &quot;connection-&gt;addr_len = 20;&quot; as a line IMMEDIATELY after malloc()&#39;ing the connection struct.  Now the socket stays up like a champ."}, {"owner": {"reputation": 965, "user_id": 4040743, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/hAIWy.jpg?s=128&g=1", "display_name": "Pete", "link": "https://stackoverflow.com/users/4040743/pete"}, "edited": false, "score": 0, "creation_date": 1568827725, "post_id": 57981496, "comment_id": 102402153, "body": "Thanks so much mevets!"}], "tags": [], "owner": {"reputation": 8402, "user_id": 4664415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hsfxj.jpg?s=128&g=1", "display_name": "mevets", "link": "https://stackoverflow.com/users/4664415/mevets"}, "is_accepted": true, "score": 4, "last_activity_date": 1568752186, "last_edit_date": 1568752186, "creation_date": 1568751390, "answer_id": 57981496, "question_id": 57981377, "link": "https://stackoverflow.com/questions/57981377/c-programming-accept-works-and-then-doesnt-in-stress-testing/57981496#57981496", "title": "C Programming :: accept() works and then doesn&#39;t, in stress-testing", "body": "<p>You need to initialize <code>addr_len</code> to the size of <code>addr</code>.   </p>\n\n<p>If you look at the manpage for accept, under the listed <code>errno</code> values; <code>EINVAL</code> if <code>addrlen</code> is invalid (e. g. is negative)</p>\n\n<p>(blown mind):  it isn't the same arguments.</p>\n\n<p>You are calling <code>malloc()</code> which might return uninitialized memory.  </p>\n\n<p>Whatever value you set <code>addrlen</code> to how many bytes of the address can be copied into address; 0 means none.</p>\n"}], "owner": {"reputation": 965, "user_id": 4040743, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/hAIWy.jpg?s=128&g=1", "display_name": "Pete", "link": "https://stackoverflow.com/users/4040743/pete"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 57981496, "answer_count": 1, "score": 0, "last_activity_date": 1568752186, "creation_date": 1568750868, "question_id": 57981377, "link": "https://stackoverflow.com/questions/57981377/c-programming-accept-works-and-then-doesnt-in-stress-testing", "title": "C Programming :: accept() works and then doesn&#39;t, in stress-testing", "body": "<p>I am coding what I thought would be a simple C socket program.  The code will act as a primitive server.  It needs to create a listening socket, and then each time it is contacted, it needs to <strong>accept()</strong> the incoming connection, then spin off a thread to handle some basic processing.  The threading and processing part I more-or-less have working, but the <strong>accept()</strong> part breaks down after the code successfully handles some initial connections..  This is a problem, because I anticipate that this program will need to run continuously and may have to process a lot of incoming requests.</p>\n\n<p>Some environmental stuff first:  I\u2019m working on a Ubuntu box, and my code is compiled with GCC:</p>\n\n<pre><code>root@ubuntu:/home/me/socketProject# gcc -v\n...\ngcc version 5.4.0 20160609 (Ubuntu 5.4.0-6ubuntu1~16.04.4)\nroot@ubuntu:/home/me/socketProject#\n</code></pre>\n\n<p>My <strong>main()</strong> function sets up a listening socket, then starts an infinite loop.  For every connection that comes in, it tries to <strong>accept()</strong> and then pass the work off to a detached thread:</p>\n\n<pre><code>int main(int argc, char ** argv)\n{\n   int             sock = -1;\n   struct          sockaddr_in address;\n   int             port = 12345;\n   connection_t*   connection;\n   pthread_t       thread;\n\n   // Create the listening socket\n   sock = socket(AF_INET, SOCK_STREAM, IPPROTO_TCP);\n   if (sock &lt;= 0){\n      fprintf(stderr, \"%s: error: cannot create socket\\n\", argv[0]);\n      return -3;\n   }\n\n   // Bind socket to port\n   address.sin_family = AF_INET;\n   address.sin_addr.s_addr = INADDR_ANY;\n   address.sin_port = htons(port);\n   if (bind(sock, (struct sockaddr *)&amp;address, sizeof(struct sockaddr_in)) &lt; 0){\n      fprintf(stderr, \"%s: error: cannot bind socket to port %d\\n\", argv[0], port);\n      return -4;\n   }\n\n   // Listen on the port\n   if (listen(sock, 5) &lt; 0){\n      fprintf(stderr, \"%s: error: cannot listen on port\\n\", argv[0]);\n      return -5;\n   }\n\n   // Listen forever...\n   while (1){\n      // Accept incoming connections\n      connection = (connection_t *)malloc(sizeof(connection_t));\n\n      printf(\"1)  [[ sock: %d -- address: %s -- addr_len: %d ]]\\n\", connection-&gt;sock, &amp;connection-&gt;address.sa_data, connection-&gt;addr_len );\n\n      connection-&gt;sock = accept(sock, &amp;connection-&gt;address, &amp;connection-&gt;addr_len);\n\n      printf(\"2)  [[ sock: %d -- address: %s -- addr_len: %d ]]\\n\", connection-&gt;sock, &amp;connection-&gt;address.sa_data, connection-&gt;addr_len );\n\n      if (connection-&gt;sock &lt;= 0){\n         printf(\" *** PROBLEM!!!  Value of errno: %d\\n \", errno);\n         free(connection);\n      }\n      else{\n         // Start a new thread but do not wait for it\n         pthread_create(&amp;thread, 0, process, (void *)connection);  // process() omitted\n         pthread_detach(thread);\n      }\n   }\n   return 0;\n}\n</code></pre>\n\n<p>Pretty textbook stuff.  I worked out all the logic and got everything working perfectly when there is only one incoming connection.</p>\n\n<p>But then I started stress-testing, and immediately realized I had a problem.  I wrote a client program that send X number of test requests, all in a row.  The above server code works fine for a few initial requests, but then breaks down.  Here\u2019s the output:</p>\n\n<pre><code>root@ubuntu:/home/me/socketProject# ./server\n        *** 1)  [[ sock: 18954128 -- address:  -- addr_len: 0 ]]\n        *** 2)  [[ sock: 7 -- address:  -- addr_len: 16 ]]\n        *** 1)  [[ sock: 18970816 -- address:  -- addr_len: 0 ]]\n        *** 2)  [[ sock: 8 -- address:  -- addr_len: 16 ]]\n        *** 1)  [[ sock: 18962080 -- address:  -- addr_len: 0 ]]\n        *** 2)  [[ sock: 9 -- address:  -- addr_len: 16 ]]\n        *** 1)  [[ sock: 18962112 -- address:  -- addr_len: 0 ]]\n        *** 2)  [[ sock: 10 -- address:  -- addr_len: 16 ]]\n        *** 1)  [[ sock: 18954064 -- address:  -- addr_len: 0 ]]\n        *** 2)  [[ sock: 11 -- address:  -- addr_len: 16 ]]\n        *** 1)  [[ sock: 18954160 -- address:  -- addr_len: 0 ]]\n        *** 2)  [[ sock: 12 -- address:  -- addr_len: 16 ]]\n        *** 1)  [[ sock: 18907120 -- address:  -- addr_len: 0 ]]\n        *** 2)  [[ sock: 13 -- address:  -- addr_len: 16 ]]\n        *** 1)  [[ sock: 18950880 -- address:  -- addr_len: 0 ]]\n        *** 2)  [[ sock: 14 -- address:  -- addr_len: 16 ]]\n        *** 1)  [[ sock: 18961856 -- address:  -- addr_len: 0 ]]\n        *** 2)  [[ sock: 15 -- address:  -- addr_len: 16 ]]\n        *** 1)  [[ sock: 18957136 -- address:  -- addr_len: 0 ]]\n        *** 2)  [[ sock: 17 -- address:  -- addr_len: 16 ]]\n        *** 1)  [[ sock: 18957168 -- address:  -- addr_len: -518793662 ]]\n        *** 2)  [[ sock: -1 -- address:  -- addr_len: -518793662 ]]\n *** PROBLEM!!!  Value of errno: 22\n        *** 1)  [[ sock: 18961856 -- address:  -- addr_len: -518793662 ]]\n        *** 2)  [[ sock: -1 -- address:  -- addr_len: -518793662 ]]\n *** PROBLEM!!!  Value of errno: 22\n        *** 1)  [[ sock: 18961856 -- address:  -- addr_len: -518793662 ]]\n        *** 2)  [[ sock: -1 -- address:  -- addr_len: -518793662 ]]\n *** PROBLEM!!!  Value of errno: 22\n        *** 1)  [[ sock: 18961856 -- address:  -- addr_len: -518793662 ]]\n        *** 2)  [[ sock: -1 -- address:  -- addr_len: -518793662 ]]\n *** PROBLEM!!!  Value of errno: 22\n        *** 1)  [[ sock: 18961856 -- address:  -- addr_len: -518793662 ]]\n        *** 2)  [[ sock: -1 -- address:  -- addr_len: -518793662 ]]\n *** PROBLEM!!!  Value of errno: 22\n        *** 1)  [[ sock: 18961856 -- address:  -- addr_len: -518793662 ]]\n        *** 2)  [[ sock: -1 -- address:  -- addr_len: -518793662 ]]\n *** PROBLEM!!!  Value of errno: 22\n        *** 1)  [[ sock: 18961856 -- address:  -- addr_len: -518793662 ]]\n        *** 2)  [[ sock: -1 -- address:  -- addr_len: -518793662 ]]\n *** PROBLEM!!!  Value of errno: 22\n        *** 1)  [[ sock: 18961856 -- address:  -- addr_len: -518793662 ]]\n        *** 2)  [[ sock: -1 -- address:  -- addr_len: -518793662 ]]\n *** PROBLEM!!!  Value of errno: 22\n        *** 1)  [[ sock: 18961856 -- address:  -- addr_len: -518793662 ]]\n        *** 2)  [[ sock: -1 -- address:  -- addr_len: -518793662 ]]\n *** PROBLEM!!!  Value of errno: 22\n        *** 1)  [[ sock: 18961856 -- address:  -- addr_len: -518793662 ]]\n        *** 2)  [[ sock: -1 -- address:  -- addr_len: -518793662 ]]\n *** PROBLEM!!!  Value of errno: 22\n        *** 1)  [[ sock: 18961856 -- address:  -- addr_len: -518793662 ]]\n</code></pre>\n\n<p>You see the problem.  In the above example, something happens after about ten successful requests, then <strong>accept()</strong> starts complaining of <strong>ERRNO 22</strong>.  A quick Google search revealed that <strong>ERRNO 22</strong> is \u201c<strong><em>EINVAL: Invalid argument</em></strong>\u201d, which obviously isn\u2019t good.</p>\n\n<p>I\u2019ve done some simple socket programming from my student days, but I\u2019ve never had a problem with <strong>accept()</strong> before.  I\u2019m really puzzled.  It looks to me like N-1 requests arrive and are successfully processed by <strong>accept()</strong>.  But then the Nth appears, <strong>accept()</strong> doesn\u2019t like it, and the socket gets corrupted.  How or why, I don\u2019t know.</p>\n\n<p><strong>accept()</strong> is complaining about \"invalid argument(s)\".  But the client is literally sending the exact same test message over and over.  How can the N-1 connections present valid arguments, but the Nth, N+1th, N+2th... argument be invalid?  That blows my mind.</p>\n\n<p>Some observations:</p>\n\n<ul>\n<li><p>This is a black-and-white phenomenon.  By that, I mean that the\nsocket works perfectly 100% of the time, but then something bad\nhappens with <strong>accept()</strong>, and then the socket never works again.</p></li>\n<li><p>I\u2019ve run a lot of tests, and there\u2019s no telling how many successful\nconnections I\u2019ll get when I start a new test.  I\u2019ve had as many as 88\nsuccessful connections before the socket stops working.  In another\ntest, I only had 2 successful connections before the socket went\nbelly-up.  The average number of successful connections before the\nsocket breaks is about 17.</p></li>\n<li><p>My client test program does not try to space out the requests it\nsends; it simply opens a socket and starts bombarding my server\nprogram at top speed.  I\u2019m doing this because I want to stress-test. \nBut perhaps my client program is sending test requests too fast for\nthe server to keep up\u2026?</p></li>\n<li><p>It is also possible, I suppose, that the client program is causing\nthe problem.  I don\u2019t think so, because it just sends the same test\nmessage over and over and it never throws an error.</p></li>\n</ul>\n\n<p>Has anyone ever seen an issue like this?  I\u2019ve been looking on SO for about an hour, but I can\u2019t find another post where <strong>accept()</strong> works, and then doesn\u2019t.</p>\n\n<p>Any help/advice is appreciated.</p>\n"}]